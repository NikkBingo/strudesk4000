const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/strudel-web-vUJZkE4C.js","assets/strudel-core-cY4HxVpV.js","assets/index-CUU9O0BO.js","assets/index-DgT90eBX.js","assets/index-Dx0fBmh0.js","assets/index-DwrY4rFz-3V9t-Qji.js","assets/index-4tJ7gvaE-l2o3c6l-.js","assets/hydra-CQk8qs5I-DwYIHJ7N.js","assets/index-C0UtYFVu-DuAxcpcw.js","assets/index--jEhV1EM-Dp2XHzWu.js"])))=>i.map(i=>d[i]);
var VJ=Object.defineProperty;var jJ=(n,e,t)=>e in n?VJ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var la=(n,e,t)=>jJ(n,typeof e!="symbol"?e+"":e,t);import{f as Yl,i as G5,v as Bf,P as ZJ,l as Lc,z as xh,a as zJ,p as LC,F as GJ,n as XJ,q as IC,E as QC,B as mf,b as Bh,h as hp,c as WJ,G as qJ,W as TN,g as UJ,L as FN,d as g0,e as HJ}from"./strudel-core-cY4HxVpV.js";import{o as YJ,a as KJ,B as NN}from"./strudel-web-vUJZkE4C.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=t(a);fetch(a.href,r)}})();const JJ="modulepreload",eee=function(n){return"/"+n},X5={},gs=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let o=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=o(t.map(c=>{if(c=eee(c),c in X5)return;X5[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":JJ,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((f,v)=>{m.addEventListener("load",f),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return a.then(o=>{for(const i of o||[])i.status==="rejected"&&r(i.reason);return e().catch(r)})},fs={elements:[{id:"element-1",selector:'[data-sound-id="element-1"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-2",selector:'[data-sound-id="element-2"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-3",selector:'[data-sound-id="element-3"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-4",selector:'[data-sound-id="element-4"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-5",selector:'[data-sound-id="element-5"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-6",selector:'[data-sound-id="element-6"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-7",selector:'[data-sound-id="element-7"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-8",selector:'[data-sound-id="element-8"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-9",selector:'[data-sound-id="element-9"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-10",selector:'[data-sound-id="element-10"]',type:"strudel",pattern:"",description:"No sound assigned"}],defaults:{proximityThreshold:100,hoverEnabled:!0,proximityEnabled:!0,volume:.5,fadeInTime:.1,fadeOutTime:.2},controls:{"proximity-threshold":{type:"synthesized",pattern:'sound("cp cp ~ cp")',description:"Threshold tick"},volume:{type:"synthesized",pattern:'sound("~ cp cp cp")',description:"Volume tick"}},getElementConfig(n){return this.elements.find(e=>e.id===n)},getSynthesizedElements(){return this.elements.filter(n=>n.type==="synthesized")},getAudioElements(){return this.elements.filter(n=>n.type==="audio")},getControlConfig(n){return this.controls[n]}};function tee(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function nee(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var BN=[0,2,4,-1,1,3,5],$N=BN.map(n=>Math.floor(n*7/12));function see(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=BN[e]+7*t;if(s===void 0)return[a*r];const o=s-$N[e]-4*t;return[a*r,a*o]}var aee=[3,0,4,1,5,2,6];function ree(n){const[e,t,s]=n,a=aee[oee(e)],r=Math.floor((e+1)/7);if(t===void 0)return{step:a,alt:r,dir:s};const o=t+4*r+$N[a];return{step:a,alt:r,oct:o,dir:s}}function oee(n){const e=(n+1)%7;return e<0?7+e:e}var W5=(n,e)=>Array(Math.abs(e)+1).join(n),hP=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),iee="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",lee="(AA|A|P|M|m|d|dd)([-+]?\\d+)",cee=new RegExp("^"+iee+"|"+lee+"$");function uee(n){const e=cee.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var q5={};function A1(n){return typeof n=="string"?q5[n]||(q5[n]=hee(n)):nee(n)?A1(pee(n)):tee(n)?A1(n.name):hP}var U5=[0,2,4,5,7,9,11],RN="PMMPPMM";function hee(n){const e=uee(n);if(e[0]==="")return hP;const t=+e[0],s=e[1],a=(Math.abs(t)-1)%7,r=RN[a];if(r==="M"&&s==="P")return hP;const o=r==="M"?"majorable":"perfectable",i=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(a+1),u=mee(o,s),h=Math.floor((Math.abs(t)-1)/7),m=l*(U5[a]+u+12*h),f=(l*(U5[a]+u)%12+12)%12,v=see({step:a,alt:u,oct:h,dir:l});return{empty:!1,name:i,num:t,q:s,step:a,alt:u,dir:l,type:o,simple:c,semitones:m,chroma:f,coord:v,oct:h}}function dee(n,e){const[t,s=0]=n,a=t*7+s*12<0,r=e||a?[-t,-s,-1]:[t,s,1];return A1(ree(r))}function mee(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function pee(n){const{step:e,alt:t,oct:s=0,dir:a}=n;if(!a)return"";const r=e+1+7*s,o=r===0?e+1:r,i=a<0?"-":"",l=RN[e]==="M"?"majorable":"perfectable";return i+o+fee(l,t)}function fee(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?W5("A",e):W5("d",n==="perfectable"?e:e+1)}function gee(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function bee(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var _N=[0,2,4,-1,1,3,5],LN=_N.map(n=>Math.floor(n*7/12));function yee(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=_N[e]+7*t;if(s===void 0)return[a*r];const o=s-LN[e]-4*t;return[a*r,a*o]}var vee=[3,0,4,1,5,2,6];function wee(n){const[e,t,s]=n,a=vee[Oee(e)],r=Math.floor((e+1)/7);if(t===void 0)return{step:a,alt:r,dir:s};const o=t+4*r+LN[a];return{step:a,alt:r,oct:o,dir:s}}function Oee(n){const e=(n+1)%7;return e<0?7+e:e}var H5=(n,e)=>Array(Math.abs(e)+1).join(n),IN=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),Y5=new Map,xee=n=>"CDEFGAB".charAt(n),Ev=n=>n<0?H5("b",-n):H5("#",n),VC=n=>n[0]==="b"?-n.length:n.length;function is(n){const e=JSON.stringify(n),t=Y5.get(e);if(t)return t;const s=typeof n=="string"?Cee(n):bee(n)?is(Mee(n)):gee(n)?is(n.name):IN;return Y5.set(e,s),s}var kee=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function jC(n){const e=kee.exec(n);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function Pee(n){return is(wee(n))}var See=(n,e)=>(n%e+e)%e,CO=[0,2,4,5,7,9,11];function Cee(n){const e=jC(n);if(e[0]===""||e[3]!=="")return IN;const t=e[0],s=e[1],a=e[2],r=(t.charCodeAt(0)+3)%7,o=VC(s),i=a.length?+a:void 0,l=yee({step:r,alt:o,oct:i}),c=t+s+a,u=t+s,h=(CO[r]+o+120)%12,m=i===void 0?See(CO[r]+o,12)-1188:CO[r]+o+12*(i+1),f=m>=0&&m<=127?m:null,v=i===void 0?null:Math.pow(2,(m-69)/12)*440;return{empty:!1,acc:s,alt:o,chroma:h,coord:l,freq:v,height:m,letter:t,midi:f,name:c,oct:i,pc:u,step:r}}function Mee(n){const{step:e,alt:t,oct:s}=n,a=xee(e);if(!a)return"";const r=a+Ev(t);return s||s===0?r+s:r}function qi(n,e){const t=is(n),s=Array.isArray(e)?e:A1(e).coord;if(t.empty||!s||s.length<2)return"";const a=t.coord,r=a.length===1?[a[0]+s[0]]:[a[0]+s[0],a[1]+s[1]];return Pee(r).name}function QN(n,e){const t=n.length;return s=>{if(!e)return"";const a=s<0?(t- -s%t)%t:s%t,r=Math.floor(s/t),o=qi(e,[0,r]);return qi(o,n[a])}}function Dv(n,e){const t=is(n),s=is(e);if(t.empty||s.empty)return"";const a=t.coord,r=s.coord,o=r[0]-a[0],i=a.length===2&&r.length===2?r[1]-a[1]:-Math.floor(o*7/12),l=s.height===t.height&&s.midi!==null&&t.oct===s.oct&&t.step>s.step;return dee([o,i],l).name}var K5=(n,e)=>Array(e+1).join(n),Aee=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function VN(n){const e=Aee.exec(n);return e?[e[1],e[2],e[3]]:["","",""]}function E1(n){const[e,t,s]=VN(n);if(t==="")return"";let a=4;for(let o=0;o<s.length;o++)a+=s.charAt(o)===","?-1:1;const r=e[0]==="_"?e.replace(/_/g,"b"):e[0]==="^"?e.replace(/\^/g,"#"):"";return t.charCodeAt(0)>96?t.toUpperCase()+r+(a+1):t+r+a}function jN(n){const e=is(n);if(e.empty||!e.oct&&e.oct!==0)return"";const{letter:t,acc:s,oct:a}=e,r=s[0]==="b"?s.replace(/b/g,"_"):s.replace(/#/g,"^"),o=a>4?t.toLowerCase():t,i=a===5?"":a>4?K5("'",a-5):K5(",",4-a);return r+o+i}function Eee(n,e){return jN(qi(E1(n),e))}function Dee(n,e){return Dv(E1(n),E1(e))}var Tee={abcToScientificNotation:E1,scientificToAbcNotation:jN,tokenize:VN,transpose:Eee,distance:Dee};function Fee(n,e){const t=[];for(;e--;t[e]=e+n);return t}function Nee(n,e){const t=[];for(;e--;t[e]=n-e);return t}function Bee(n,e){return n<e?Fee(n,e-n+1):Nee(n,n-e+1)}function $ee(n,e){const t=e.length,s=(n%t+t)%t;return e.slice(s,t).concat(e.slice(0,s))}function Ree(n){return n.filter(e=>e===0||e)}function ZN(n){return n.map(t=>is(t)).filter(t=>!t.empty).sort((t,s)=>t.height-s.height).map(t=>t.name)}function _ee(n){return ZN(n).filter((e,t,s)=>t===0||e!==s[t-1])}function Lee(n,e=Math.random){let t,s,a=n.length;for(;a;)t=Math.floor(e()*a--),s=n[a],n[a]=n[t],n[t]=s;return n}function zN(n){return n.length===0?[[]]:zN(n.slice(1)).reduce((e,t)=>e.concat(n.map((s,a)=>{const r=t.slice();return r.splice(a,0,n[0]),r})),[])}const Iee=Object.freeze(Object.defineProperty({__proto__:null,compact:Ree,permutations:zN,range:Bee,rotate:$ee,shuffle:Lee,sortedNoteNames:ZN,sortedUniqNoteNames:_ee},Symbol.toStringTag,{value:"Module"}));function Qee(n,e){const t=[];for(;e--;t[e]=e+n);return t}function Vee(n,e){const t=[];for(;e--;t[e]=n-e);return t}function Tv(n,e){return n<e?Qee(n,e-n+1):Vee(n,n-e+1)}function Dm(n,e){const t=e.length,s=(n%t+t)%t;return e.slice(s,t).concat(e.slice(0,s))}function ZC(n){return n.filter(e=>e===0||e)}function jee(n,e=Math.random){let t,s,a=n.length;for(;a;)t=Math.floor(e()*a--),s=n[a],n[a]=n[t],n[t]=s;return n}function GN(n){return n.length===0?[[]]:GN(n.slice(1)).reduce((e,t)=>e.concat(n.map((s,a)=>{const r=t.slice();return r.splice(a,0,n[0]),r})),[])}var Zee={compact:ZC,permutations:GN,range:Tv,rotate:Dm,shuffle:jee};function zee(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function Gee(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var XN=[0,2,4,-1,1,3,5],Xee=XN.map(n=>Math.floor(n*7/12));function Wee(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=XN[e]+7*t;if(s===void 0)return[a*r];const o=s-Xee[e]-4*t;return[a*r,a*o]}var J5=(n,e)=>Array(Math.abs(e)+1).join(n),dP=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),qee="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",Uee="(AA|A|P|M|m|d|dd)([-+]?\\d+)",Hee=new RegExp("^"+qee+"|"+Uee+"$");function Yee(n){const e=Hee.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var eE={};function mP(n){return typeof n=="string"?eE[n]||(eE[n]=Kee(n)):Gee(n)?mP(ete(n)):zee(n)?mP(n.name):dP}var tE=[0,2,4,5,7,9,11],WN="PMMPPMM";function Kee(n){const e=Yee(n);if(e[0]==="")return dP;const t=+e[0],s=e[1],a=(Math.abs(t)-1)%7,r=WN[a];if(r==="M"&&s==="P")return dP;const o=r==="M"?"majorable":"perfectable",i=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(a+1),u=Jee(o,s),h=Math.floor((Math.abs(t)-1)/7),m=l*(tE[a]+u+12*h),f=(l*(tE[a]+u)%12+12)%12,v=Wee({step:a,alt:u,oct:h,dir:l});return{empty:!1,name:i,num:t,q:s,step:a,alt:u,dir:l,type:o,simple:c,semitones:m,chroma:f,coord:v,oct:h}}function Jee(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function ete(n){const{step:e,alt:t,oct:s=0,dir:a}=n;if(!a)return"";const r=e+1+7*s,o=r===0?e+1:r,i=a<0?"-":"",l=WN[e]==="M"?"majorable":"perfectable";return i+o+tte(l,t)}function tte(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?J5("A",e):J5("d",n==="perfectable"?e:e+1)}var Ql={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},zC=n=>Number(n).toString(2).padStart(12,"0"),nE=n=>parseInt(n,2),nte=/^[01]{12}$/;function GC(n){return nte.test(n)}var ste=n=>typeof n=="number"&&n>=0&&n<=4095,ate=n=>n&&GC(n.chroma),sE={[Ql.chroma]:Ql};function Aa(n){const e=GC(n)?n:ste(n)?zC(n):Array.isArray(n)?gte(n):ate(n)?n.chroma:Ql.chroma;return sE[e]=sE[e]||fte(e)}var rte=Aa,qN=n=>Aa(n).chroma,ote=n=>Aa(n).intervals,ite=n=>Aa(n).setNum,lte=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function cte(n){const e=[];for(let t=0;t<12;t++)n.charAt(t)==="1"&&e.push(lte[t]);return e}function ute(n){return Aa(n).intervals.map(e=>qi("C",e))}function hte(){return Tv(2048,4095).map(zC)}function XC(n,e=!0){const s=Aa(n).chroma.split("");return ZC(s.map((a,r)=>{const o=Dm(r,s);return e&&o[0]==="0"?null:o.join("")}))}function dte(n,e){return Aa(n).setNum===Aa(e).setNum}function Fv(n){const e=Aa(n).setNum;return t=>{const s=Aa(t).setNum;return e&&e!==s&&(s&e)===s}}function Nv(n){const e=Aa(n).setNum;return t=>{const s=Aa(t).setNum;return e&&e!==s&&(s|e)===s}}function UN(n){const e=Aa(n);return t=>{const s=is(t);return e&&!s.empty&&e.chroma.charAt(s.chroma)==="1"}}function mte(n){const e=UN(n);return t=>t.filter(e)}var HN={get:Aa,chroma:qN,num:ite,intervals:ote,chromas:hte,isSupersetOf:Nv,isSubsetOf:Fv,isNoteIncludedIn:UN,isEqual:dte,filter:mte,modes:XC,notes:ute,pcset:rte};function pte(n){const e=n.split("");return e.map((t,s)=>Dm(s,e).join(""))}function fte(n){const e=nE(n),t=pte(n).map(nE).filter(r=>r>=2048).sort()[0],s=zC(t),a=cte(n);return{empty:!1,name:"",setNum:e,chroma:n,normalized:s,intervals:a}}function gte(n){if(n.length===0)return Ql.chroma;let e;const t=[0,0,0,0,0,0,0,0,0,0,0,0];for(let s=0;s<n.length;s++)e=is(n[s]),e.empty&&(e=mP(n[s])),e.empty||(t[e.chroma]=1);return t.join("")}var bte=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],yte=bte;({...Ql});var WC=[],Rb={};function vte(){return WC.slice()}function wte(n,e,t){const s=xte(n),a={...Aa(n),name:t||"",quality:s,intervals:n,aliases:e};WC.push(a),a.name&&(Rb[a.name]=a),Rb[a.setNum]=a,Rb[a.chroma]=a,a.aliases.forEach(r=>Ote(a,r))}function Ote(n,e){Rb[e]=n}function xte(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}yte.forEach(([n,e,t])=>wte(n.split(" "),t.split(" "),e));WC.sort((n,e)=>n.setNum-e.setNum);var kte=n=>{const e=n.reduce((t,s)=>{const a=is(s).chroma;return a!==void 0&&(t[a]=t[a]||is(s).name),t},{});return t=>e[t]};function Pte(n,e={}){const t=n.map(a=>is(a).pc).filter(a=>a);return is.length===0?[]:Tte(t,1,e).filter(a=>a.weight).sort((a,r)=>r.weight-a.weight).map(a=>a.name)}var Bv={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},$v=n=>e=>!!(e&n),Ste=$v(Bv.anyThirds),Cte=$v(Bv.perfectFifth),Mte=$v(Bv.anySeventh),Ate=$v(Bv.nonPerfectFifths);function Ete(n){const e=parseInt(n.chroma,2);return Ste(e)&&Cte(e)&&Mte(e)}function Dte(n){const e=parseInt(n,2);return Ate(e)?n:(e|16).toString(2)}function Tte(n,e,t){const s=n[0],a=is(s).chroma,r=kte(n),o=XC(n,!1),i=[];return o.forEach((l,c)=>{const u=t.assumePerfectFifth&&Dte(l);vte().filter(m=>t.assumePerfectFifth&&Ete(m)?m.chroma===u:m.chroma===l).forEach(m=>{const f=m.aliases[0],v=r(c);c!==a?i.push({weight:.5*e,name:`${v}${f}/${s}`}):i.push({weight:1*e,name:`${v}${f}`})})}),i}function Fg(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}var YN=[0,2,4,5,7,9,11],KN=({step:n,alt:e})=>(YN[n]+e+120)%12,qC=({step:n,alt:e,oct:t,dir:s=1})=>s*(YN[n]+e+12*(t===void 0?-100:t)),JN=n=>{const e=qC(n);return n.oct!==void 0&&e>=-12&&e<=115?e+12:null};function Rv(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"}var e8=[0,2,4,-1,1,3,5],t8=e8.map(n=>Math.floor(n*7/12));function _v(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=e8[e]+7*t;if(s===void 0)return[a*r];const o=s-t8[e]-4*t;return[a*r,a*o]}var Fte=[3,0,4,1,5,2,6];function Lv(n){const[e,t,s]=n,a=Fte[Nte(e)],r=Math.floor((e+1)/7);if(t===void 0)return{step:a,alt:r,dir:s};const o=t+4*r+t8[a];return{step:a,alt:r,oct:o,dir:s}}function Nte(n){const e=(n+1)%7;return e<0?7+e:e}var aE=(n,e)=>Array(Math.abs(e)+1).join(n),pP={empty:!0,name:"",acc:""},Bte="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",$te="(AA|A|P|M|m|d|dd)([-+]?\\d+)",Rte=new RegExp("^"+Bte+"|"+$te+"$");function UC(n){const e=Rte.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var rE={};function dr(n){return typeof n=="string"?rE[n]||(rE[n]=_te(n)):Rv(n)?dr(Ite(n)):Fg(n)?dr(n.name):pP}var oE=[0,2,4,5,7,9,11],n8="PMMPPMM";function _te(n){const e=UC(n);if(e[0]==="")return pP;const t=+e[0],s=e[1],a=(Math.abs(t)-1)%7,r=n8[a];if(r==="M"&&s==="P")return pP;const o=r==="M"?"majorable":"perfectable",i=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(a+1),u=Lte(o,s),h=Math.floor((Math.abs(t)-1)/7),m=l*(oE[a]+u+12*h),f=(l*(oE[a]+u)%12+12)%12,v=_v({step:a,alt:u,oct:h,dir:l});return{empty:!1,name:i,num:t,q:s,step:a,alt:u,dir:l,type:o,simple:c,semitones:m,chroma:f,coord:v,oct:h}}function Ng(n,e){const[t,s=0]=n,a=t*7+s*12<0,r=e||a?[-t,-s,-1]:[t,s,1];return dr(Lv(r))}function Lte(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function Ite(n){const{step:e,alt:t,oct:s=0,dir:a}=n;if(!a)return"";const r=e+1+7*s,o=r===0?e+1:r,i=a<0?"-":"",l=n8[e]==="M"?"majorable":"perfectable";return i+o+Qte(l,t)}function Qte(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?aE("A",e):aE("d",n==="perfectable"?e:e+1)}var iE=(n,e)=>Array(Math.abs(e)+1).join(n),s8={empty:!0,name:"",pc:"",acc:""},lE=new Map,HC=n=>"CDEFGAB".charAt(n),YC=n=>n<0?iE("b",-n):iE("#",n),KC=n=>n[0]==="b"?-n.length:n.length;function Vl(n){const e=JSON.stringify(n),t=lE.get(e);if(t)return t;const s=typeof n=="string"?Zte(n):Rv(n)?Vl(zte(n)):Fg(n)?Vl(n.name):s8;return lE.set(e,s),s}var Vte=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Iv(n){const e=Vte.exec(n);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function JC(n){return Vl(Lv(n))}var jte=(n,e)=>(n%e+e)%e,MO=[0,2,4,5,7,9,11];function Zte(n){const e=Iv(n);if(e[0]===""||e[3]!=="")return s8;const t=e[0],s=e[1],a=e[2],r=(t.charCodeAt(0)+3)%7,o=KC(s),i=a.length?+a:void 0,l=_v({step:r,alt:o,oct:i}),c=t+s+a,u=t+s,h=(MO[r]+o+120)%12,m=i===void 0?jte(MO[r]+o,12)-1188:MO[r]+o+12*(i+1),f=m>=0&&m<=127?m:null,v=i===void 0?null:Math.pow(2,(m-69)/12)*440;return{empty:!1,acc:s,alt:o,chroma:h,coord:l,freq:v,height:m,letter:t,midi:f,name:c,oct:i,pc:u,step:r}}function zte(n){const{step:e,alt:t,oct:s}=n,a=HC(e);if(!a)return"";const r=a+YC(t);return s||s===0?r+s:r}function tm(n,e){const t=Vl(n),s=Array.isArray(e)?e:dr(e).coord;if(t.empty||!s||s.length<2)return"";const a=t.coord,r=a.length===1?[a[0]+s[0]]:[a[0]+s[0],a[1]+s[1]];return JC(r).name}function Qv(n,e){const t=n.length;return s=>{if(!e)return"";const a=s<0?(t- -s%t)%t:s%t,r=Math.floor(s/t),o=tm(e,[0,r]);return tm(o,n[a])}}function eM(n,e){const t=Vl(n),s=Vl(e);if(t.empty||s.empty)return"";const a=t.coord,r=s.coord,o=r[0]-a[0],i=a.length===2&&r.length===2?r[1]-a[1]:-Math.floor(o*7/12),l=s.height===t.height&&s.midi!==null&&t.midi!==null&&t.step>s.step;return Ng([o,i],l).name}var a8=(n,e)=>Array(Math.abs(e)+1).join(n);function Tm(n,e,t){return function(...s){return console.warn(`${n} is deprecated. Use ${e}.`),t.apply(this,s)}}var r8=Tm("isNamed","isNamedPitch",Fg);const o8=Object.freeze(Object.defineProperty({__proto__:null,accToAlt:KC,altToAcc:YC,chroma:KN,coordToInterval:Ng,coordToNote:JC,coordinates:_v,deprecate:Tm,distance:eM,fillStr:a8,height:qC,interval:dr,isNamed:r8,isNamedPitch:Fg,isPitch:Rv,midi:JN,note:Vl,pitch:Lv,stepToLetter:HC,tokenizeInterval:UC,tokenizeNote:Iv,tonicIntervalsTransposer:Qv,transpose:tm},Symbol.toStringTag,{value:"Module"}));var Gte=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],Xte=Gte,Wte={...Ql,name:"",quality:"Unknown",intervals:[],aliases:[]},Fm=[],kh={};function tM(n){return kh[n]||Wte}var qte=Tm("ChordType.chordType","ChordType.get",tM);function Ute(){return Fm.map(n=>n.name).filter(n=>n)}function Hte(){return Fm.map(n=>n.aliases[0]).filter(n=>n)}function Yte(){return Object.keys(kh)}function Vv(){return Fm.slice()}var Kte=Tm("ChordType.entries","ChordType.all",Vv);function Jte(){Fm=[],kh={}}function i8(n,e,t){const s=tne(n),a={...Aa(n),name:t||"",quality:s,intervals:n,aliases:e};Fm.push(a),a.name&&(kh[a.name]=a),kh[a.setNum]=a,kh[a.chroma]=a,a.aliases.forEach(r=>ene(a,r))}function ene(n,e){kh[e]=n}function tne(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}Xte.forEach(([n,e,t])=>i8(n.split(" "),t.split(" "),e));Fm.sort((n,e)=>n.setNum-e.setNum);var l8={names:Ute,symbols:Hte,get:tM,all:Vv,add:i8,removeAll:Jte,keys:Yte,entries:Kte,chordType:qte},nne=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],sne=nne,ane={...Ql,intervals:[],aliases:[]},jv=[],Ph={};function c8(){return jv.map(n=>n.name)}function Zv(n){return Ph[n]||ane}var rne=Zv;function Nm(){return jv.slice()}var one=Nm;function ine(){return Object.keys(Ph)}function lne(){jv=[],Ph={}}function u8(n,e,t=[]){const s={...Aa(n),name:e,intervals:n,aliases:t};return jv.push(s),Ph[s.name]=s,Ph[s.setNum]=s,Ph[s.chroma]=s,s.aliases.forEach(a=>cne(s,a)),s}function cne(n,e){Ph[e]=n}sne.forEach(([n,e,...t])=>u8(n.split(" "),e,t));var h8={names:c8,get:Zv,all:Nm,add:u8,removeAll:lne,keys:ine,entries:one,scaleType:rne},fP={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function nM(n){const[e,t,s,a]=Iv(n);return e===""?["",n]:e==="A"&&a==="ug"?["","aug"]:[e+t,s+a]}function Uh(n){if(n==="")return fP;if(Array.isArray(n)&&n.length===2)return _b(n[1],n[0]);{const[e,t]=nM(n),s=_b(t,e);return s.empty?_b(n):s}}function _b(n,e,t){const s=tM(n),a=Vl(e||""),r=Vl(t||"");if(s.empty||e&&a.empty||t&&r.empty)return fP;const o=eM(a.pc,r.pc),i=s.intervals.indexOf(o)+1;if(!r.empty&&!i)return fP;const l=Array.from(s.intervals);for(let m=1;m<i;m++){const f=l[0][0],v=l[0][1],O=parseInt(f,10)+7;l.push(`${O}${v}`),l.shift()}const c=a.empty?[]:l.map(m=>tm(a,m));n=s.aliases.indexOf(n)!==-1?n:s.aliases[0];const u=`${a.empty?"":a.pc}${n}${r.empty||i<=1?"":"/"+r.pc}`,h=`${e?a.pc+" ":""}${s.name}${i>1&&t?" over "+r.pc:""}`;return{...s,name:h,symbol:u,type:s.name,root:r.name,intervals:l,rootDegree:i,tonic:a.name,notes:c}}var une=Tm("Chord.chord","Chord.get",Uh);function hne(n,e){const[t,s]=nM(n);return t?tm(t,e)+s:n}function dne(n){const e=Uh(n),t=Nv(e.chroma);return Nm().filter(s=>t(s.chroma)).map(s=>s.name)}function mne(n){const e=Uh(n),t=Nv(e.chroma);return Vv().filter(s=>t(s.chroma)).map(s=>e.tonic+s.aliases[0])}function pne(n){const e=Uh(n),t=Fv(e.chroma);return Vv().filter(s=>t(s.chroma)).map(s=>e.tonic+s.aliases[0])}function fne(n){const{intervals:e,tonic:t}=Uh(n),s=Qv(e,t);return a=>a?s(a>0?a-1:a):""}function gne(n){const{intervals:e,tonic:t}=Uh(n);return Qv(e,t)}var bne={getChord:_b,get:Uh,detect:Pte,chordScales:dne,extended:mne,reduced:pne,tokenize:nM,transpose:hne,degrees:fne,steps:gne,chord:une},yne=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],vne=yne,zv=[];vne.forEach(([n,e,t])=>Mne(n,e,t));var wne={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]};function One(){return zv.reduce((n,e)=>(e.names.forEach(t=>n.push(t)),n),[])}function xne(){return zv.map(n=>n.shorthand)}var kne=/^([^.]+)(\.*)$/;function sM(n){const[e,t,s]=kne.exec(n)||[],a=zv.find(i=>i.shorthand===t||i.names.includes(t));if(!a)return wne;const r=Ane(a.fraction,s.length),o=r[0]/r[1];return{...a,name:n,dots:s,value:o,fraction:r}}var Pne=n=>sM(n).value,Sne=n=>sM(n).fraction,Cne={names:One,shorthands:xne,get:sM,value:Pne,fraction:Sne};function Mne(n,e,t){zv.push({empty:!1,dots:"",name:"",value:1/n,fraction:n<1?[1/n,1]:[1,n],shorthand:e,names:t})}function Ane(n,e){const t=Math.pow(2,e);let s=n[0]*t,a=n[1]*t;const r=s;for(let o=0;o<e;o++)s+=r/Math.pow(2,o+1);for(;s%2===0&&a%2===0;)s/=2,a/=2;return[s,a]}function Ene(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")}var d8=dr,Dne=n=>dr(n).name,Tne=n=>dr(n).semitones,Fne=n=>dr(n).q,Nne=n=>dr(n).num;function Bne(n){const e=dr(n);return e.empty?"":e.simple+e.q}function $ne(n){const e=dr(n);if(e.empty)return"";const t=(7-e.step)%7,s=e.type==="perfectable"?-e.alt:-(e.alt+1);return dr({step:t,alt:s,oct:e.oct,dir:e.dir}).name}var Rne=[1,2,2,3,3,4,5,5,6,6,7,7],_ne="P m M m M P d P m M m M".split(" ");function Lne(n){const e=n<0?-1:1,t=Math.abs(n),s=t%12,a=Math.floor(t/12);return e*(Rne[s]+7*a)+_ne[s]}var Ine=Dv,m8=p8((n,e)=>[n[0]+e[0],n[1]+e[1]]),Qne=n=>e=>m8(n,e),Vne=p8((n,e)=>[n[0]-e[0],n[1]-e[1]]);function jne(n,e){const t=d8(n);if(t.empty)return"";const[s,a,r]=t.coord;return Ng([s+e,a,r]).name}var Ou={names:Ene,get:d8,name:Dne,num:Nne,semitones:Tne,quality:Fne,fromSemitones:Lne,distance:Ine,invert:$ne,simplify:Bne,add:m8,addTo:Qne,substract:Vne,transposeFifths:jne};function p8(n){return(e,t)=>{const s=dr(e).coord,a=dr(t).coord;if(s&&a){const r=n(s,a);return Ng(r).name}}}function f8(n){return+n>=0&&+n<=127}function g8(n){if(f8(n))return+n;const e=is(n);return e.empty?null:e.midi}function Zne(n,e=440){return Math.pow(2,(n-69)/12)*e}var zne=Math.log(2),Gne=Math.log(440);function aM(n){const e=12*(Math.log(n)-Gne)/zne+69;return Math.round(e*100)/100}var Xne="C C# D D# E F F# G G# A A# B".split(" "),Wne="C Db D Eb E F Gb G Ab A Bb B".split(" ");function Vu(n,e={}){if(isNaN(n)||n===-1/0||n===1/0)return"";n=Math.round(n);const s=(e.sharps===!0?Xne:Wne)[n%12];if(e.pitchClass)return s;const a=Math.floor(n/12)-1;return s+a}function rM(n){return n%12}function qne(n){return n.split("").reduce((e,t,s)=>(s<12&&t==="1"&&e.push(s),e),[])}function Une(n){return n.map(rM).sort((e,t)=>e-t).filter((e,t,s)=>t===0||e!==s[t-1])}function oM(n){return Array.isArray(n)?Une(n):qne(n)}function Hne(n){const e=oM(n);return t=>{const s=rM(t);for(let a=0;a<12;a++){if(e.includes(s+a))return t+a;if(e.includes(s-a))return t-a}}}function b8(n,e){const t=oM(n),s=t.length;return a=>{const r=a<0?(s- -a%s)%s:a%s,o=Math.floor(a/s);return t[r]+o*12+e}}function Yne(n,e){const t=b8(n,e);return s=>{if(s!==0)return t(s>0?s-1:s)}}var Kne={chroma:rM,freqToMidi:aM,isMidi:f8,midiToFreq:Zne,midiToNoteName:Vu,pcsetNearest:Hne,pcset:oM,pcsetDegrees:Yne,pcsetSteps:b8,toMidi:g8},Jne=["C","D","E","F","G","A","B"],y8=n=>n.name,v8=n=>n.map(is).filter(e=>!e.empty);function ese(n){return n===void 0?Jne.slice():Array.isArray(n)?v8(n).map(y8):[]}var Ui=is,tse=n=>Ui(n).name,nse=n=>Ui(n).pc,sse=n=>Ui(n).acc,ase=n=>Ui(n).oct,rse=n=>Ui(n).midi,ose=n=>Ui(n).freq,ise=n=>Ui(n).chroma;function w8(n){return Vu(n)}function lse(n){return Vu(aM(n))}function cse(n){return Vu(aM(n),{sharps:!0})}function use(n){return Vu(n,{sharps:!0})}var hse=Dv,Gi=qi,dse=qi,O8=n=>e=>Gi(e,n),mse=O8,x8=n=>e=>Gi(n,e),pse=x8;function D1(n,e){return Gi(n,[e,0])}var fse=D1;function gse(n,e){return Gi(n,[0,e])}var iM=(n,e)=>n.height-e.height,bse=(n,e)=>e.height-n.height;function k8(n,e){return e=e||iM,v8(n).sort(e).map(y8)}function P8(n){return k8(n,iM).filter((e,t,s)=>t===0||e!==s[t-1])}var yse=n=>{const e=Ui(n);return e.empty?"":Vu(e.midi||e.chroma,{sharps:e.alt>0,pitchClass:e.midi===null})};function S8(n,e){const t=Ui(n);if(t.empty)return"";const s=Ui(e||Vu(t.midi||t.chroma,{sharps:t.alt<0,pitchClass:!0}));if(s.empty||s.chroma!==t.chroma)return"";if(t.oct===void 0)return s.pc;const a=t.chroma-t.alt,r=s.chroma-s.alt,o=a>11||r<0?-1:a<0||r>11?1:0,i=t.oct+o;return s.pc+i}var hr={names:ese,get:Ui,name:tse,pitchClass:nse,accidentals:sse,octave:ase,midi:rse,ascending:iM,descending:bse,distance:hse,sortedNames:k8,sortedUniqNames:P8,fromMidi:w8,fromMidiSharps:use,freq:ose,fromFreq:lse,fromFreqSharps:cse,chroma:ise,transpose:Gi,tr:dse,transposeBy:O8,trBy:mse,transposeFrom:x8,trFrom:pse,transposeFifths:D1,transposeOctaves:gse,trFifths:fse,simplify:yse,enharmonic:S8};function C8(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function M8(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var A8=[0,2,4,-1,1,3,5],vse=A8.map(n=>Math.floor(n*7/12));function wse(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=A8[e]+7*t;if(s===void 0)return[a*r];const o=s-vse[e]-4*t;return[a*r,a*o]}var cE=(n,e)=>Array(Math.abs(e)+1).join(n),gP=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),Ose="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",xse="(AA|A|P|M|m|d|dd)([-+]?\\d+)",kse=new RegExp("^"+Ose+"|"+xse+"$");function Pse(n){const e=kse.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var uE={};function bP(n){return typeof n=="string"?uE[n]||(uE[n]=Sse(n)):M8(n)?bP(Mse(n)):C8(n)?bP(n.name):gP}var hE=[0,2,4,5,7,9,11],E8="PMMPPMM";function Sse(n){const e=Pse(n);if(e[0]==="")return gP;const t=+e[0],s=e[1],a=(Math.abs(t)-1)%7,r=E8[a];if(r==="M"&&s==="P")return gP;const o=r==="M"?"majorable":"perfectable",i=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(a+1),u=Cse(o,s),h=Math.floor((Math.abs(t)-1)/7),m=l*(hE[a]+u+12*h),f=(l*(hE[a]+u)%12+12)%12,v=wse({step:a,alt:u,oct:h,dir:l});return{empty:!1,name:i,num:t,q:s,step:a,alt:u,dir:l,type:o,simple:c,semitones:m,chroma:f,coord:v,oct:h}}function Cse(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function Mse(n){const{step:e,alt:t,oct:s=0,dir:a}=n;if(!a)return"";const r=e+1+7*s,o=r===0?e+1:r,i=a<0?"-":"",l=E8[e]==="M"?"majorable":"perfectable";return i+o+Ase(l,t)}function Ase(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?cE("A",e):cE("d",n==="perfectable"?e:e+1)}var D8={empty:!0,name:"",chordType:""},dE={};function xu(n){return typeof n=="string"?dE[n]||(dE[n]=$se(n)):typeof n=="number"?xu(Gv[n]||""):M8(n)?Tse(n):C8(n)?xu(n.name):D8}var Ese=xu;function Dse(n=!0){return(n?Gv:Bse).slice()}function Tse(n){return xu(Ev(n.alt)+Gv[n.step])}var Fse=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function Nse(n){return Fse.exec(n)||["","","",""]}var T8="I II III IV V VI VII",Gv=T8.split(" "),Bse=T8.toLowerCase().split(" ");function $se(n){const[e,t,s,a]=Nse(n);if(!s)return D8;const r=s.toUpperCase(),o=Gv.indexOf(r),i=VC(t),l=1;return{empty:!1,name:e,roman:s,interval:bP({step:o,alt:i,dir:l}).name,acc:t,chordType:a,alt:i,step:o,major:s===r,oct:0,dir:l}}var Rse={names:Dse,get:xu,romanNumeral:Ese},za=Object.freeze([]),F8={type:"major",tonic:"",alteration:0,keySignature:""},Lb={tonic:"",grades:za,intervals:za,scale:za,triads:za,chords:za,chordsHarmonicFunction:za,chordScales:za,secondaryDominants:za,secondaryDominantSupertonics:za,substituteDominantsMinorRelative:za,substituteDominants:za,substituteDominantSupertonics:za,secondaryDominantsMinorRelative:za},_se={...F8,...Lb,type:"major",minorRelative:"",scale:za,substituteDominants:za,secondaryDominantSupertonics:za,substituteDominantsMinorRelative:za},Lse={...F8,type:"minor",relativeMajor:"",natural:Lb,harmonic:Lb,melodic:Lb},AO=(n,e,t="")=>e.map((s,a)=>`${n[a]}${t}${s}`);function Xv(n,e,t,s,a){return r=>{const o=n.map(f=>xu(f).interval||""),i=o.map(f=>Gi(r,f)),l=AO(i,t),c=i.map(f=>Gi(f,"5P")).map(f=>i.includes(f)&&!l.includes(f+"7")?f+"7":""),u=mE(c,e),h=c.map(f=>{if(!f)return"";const v=f.slice(0,-1);return Gi(v,"5d")+"7"}),m=mE(h,e);return{tonic:r,grades:n,intervals:o,scale:i,triads:AO(i,e),chords:l,chordsHarmonicFunction:s.slice(),chordScales:AO(i,a," "),secondaryDominants:c,secondaryDominantSupertonics:u,substituteDominants:h,substituteDominantSupertonics:m,secondaryDominantsMinorRelative:u,substituteDominantsMinorRelative:m}}}var mE=(n,e)=>n.map((t,s)=>{if(!t)return"";const a=t.slice(0,-1),r=Gi(a,"5P");return e[s].endsWith("m")?r+"m7":r+"m7b5"}),N8=(n,e)=>{const t=is(n),s=is(e);return t.empty||s.empty?0:s.coord[0]-t.coord[0]},Ise=Xv("I II III IV V VI VII".split(" ")," m m   m dim".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),Qse=Xv("I II bIII IV V bVI bVII".split(" "),"m dim  m m  ".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),Vse=Xv("I II bIII IV V bVI VII".split(" "),"m dim aug m   dim".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),jse=Xv("I II bIII IV V VI VII".split(" "),"m m aug   dim dim".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));function Zse(n){const e=is(n).pc;if(!e)return _se;const t=Ise(e),s=N8("C",e);return{...t,type:"major",minorRelative:Gi(e,"-3m"),alteration:s,keySignature:Ev(s)}}function zse(n){const e=is(n).pc;if(!e)return Lse;const t=N8("C",e)-3;return{type:"minor",tonic:e,relativeMajor:Gi(e,"3m"),alteration:t,keySignature:Ev(t),natural:Qse(e),harmonic:Vse(e),melodic:jse(e)}}function Gse(n){return typeof n=="number"?D1("C",n):typeof n=="string"&&/^b+|#+$/.test(n)?D1("C",VC(n)):null}var Xse={majorKey:Zse,majorTonicFromKeySignature:Gse,minorKey:zse};function Wse(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function qse(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var B8=[0,2,4,-1,1,3,5],$8=B8.map(n=>Math.floor(n*7/12));function Use(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=B8[e]+7*t;if(s===void 0)return[a*r];const o=s-$8[e]-4*t;return[a*r,a*o]}var Hse=[3,0,4,1,5,2,6];function Yse(n){const[e,t,s]=n,a=Hse[Kse(e)],r=Math.floor((e+1)/7);if(t===void 0)return{step:a,alt:r,dir:s};const o=t+4*r+$8[a];return{step:a,alt:r,oct:o,dir:s}}function Kse(n){const e=(n+1)%7;return e<0?7+e:e}var pE=(n,e)=>Array(Math.abs(e)+1).join(n),yP=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),Jse="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",eae="(AA|A|P|M|m|d|dd)([-+]?\\d+)",tae=new RegExp("^"+Jse+"|"+eae+"$");function nae(n){const e=tae.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var fE={};function $f(n){return typeof n=="string"?fE[n]||(fE[n]=sae(n)):qse(n)?$f(oae(n)):Wse(n)?$f(n.name):yP}var gE=[0,2,4,5,7,9,11],R8="PMMPPMM";function sae(n){const e=nae(n);if(e[0]==="")return yP;const t=+e[0],s=e[1],a=(Math.abs(t)-1)%7,r=R8[a];if(r==="M"&&s==="P")return yP;const o=r==="M"?"majorable":"perfectable",i=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(a+1),u=rae(o,s),h=Math.floor((Math.abs(t)-1)/7),m=l*(gE[a]+u+12*h),f=(l*(gE[a]+u)%12+12)%12,v=Use({step:a,alt:u,oct:h,dir:l});return{empty:!1,name:i,num:t,q:s,step:a,alt:u,dir:l,type:o,simple:c,semitones:m,chroma:f,coord:v,oct:h}}function aae(n,e){const[t,s=0]=n,r=t*7+s*12<0?[-t,-s,-1]:[t,s,1];return $f(Yse(r))}function rae(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function oae(n){const{step:e,alt:t,oct:s=0,dir:a}=n;if(!a)return"";const r=e+1+7*s,o=r===0?e+1:r,i=a<0?"-":"",l=R8[e]==="M"?"majorable":"perfectable";return i+o+iae(l,t)}function iae(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?pE("A",e):pE("d",n==="perfectable"?e:e+1)}var lae=$f;function cae(n){const e=$f(n);return e.empty?"":e.simple+e.q}function uae(n,e){const t=lae(n);if(t.empty)return"";const[s,a,r]=t.coord;return aae([s+e,a,r]).name}var lM=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],bE={...Ql,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},cM=lM.map(pae),vP={};cM.forEach(n=>{vP[n.name]=n,n.aliases.forEach(e=>{vP[e]=n})});function $h(n){return typeof n=="string"?vP[n.toLowerCase()]||bE:n&&n.name?$h(n.name):bE}var hae=$h;function _8(){return cM.slice()}var dae=_8;function mae(){return cM.map(n=>n.name)}function pae(n){const[e,t,s,a,r,o,i]=n,l=i?[i]:[],c=Number(t).toString(2);return{empty:!1,intervals:Zv(a).intervals,modeNum:e,chroma:c,normalized:c,name:a,setNum:t,alt:s,triad:r,seventh:o,aliases:l}}function fae(n,e){return $h(n).intervals.map(t=>qi(e,t))}function L8(n){return(e,t)=>{const s=$h(e);if(s.empty)return[];const a=Dm(s.modeNum,n),r=s.intervals.map(o=>qi(t,o));return a.map((o,i)=>r[i]+o)}}var gae=L8(lM.map(n=>n[4])),bae=L8(lM.map(n=>n[5]));function I8(n,e){const t=$h(e),s=$h(n);return t.empty||s.empty?"":cae(uae("1P",s.alt-t.alt))}function yae(n,e,t){return qi(t,I8(n,e))}var vae={get:$h,names:mae,all:_8,distance:I8,relativeTonic:yae,notes:fae,triads:gae,seventhChords:bae,entries:dae,mode:hae},wae=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],Oae=wae;({...Ql});var Q8=[],Ib={};function xae(n,e,t){const s=Pae(n),a={...Aa(n),name:t||"",quality:s,intervals:n,aliases:e};Q8.push(a),a.name&&(Ib[a.name]=a),Ib[a.setNum]=a,Ib[a.chroma]=a,a.aliases.forEach(r=>kae(a,r))}function kae(n,e){Ib[e]=n}function Pae(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}Oae.forEach(([n,e,t])=>xae(n.split(" "),t.split(" "),e));Q8.sort((n,e)=>n.setNum-e.setNum);function Sae(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function Cae(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var V8=[0,2,4,-1,1,3,5],Mae=V8.map(n=>Math.floor(n*7/12));function Aae(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=V8[e]+7*t;if(s===void 0)return[a*r];const o=s-Mae[e]-4*t;return[a*r,a*o]}var yE=(n,e)=>Array(Math.abs(e)+1).join(n),wP=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),Eae="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",Dae="(AA|A|P|M|m|d|dd)([-+]?\\d+)",Tae=new RegExp("^"+Eae+"|"+Dae+"$");function Fae(n){const e=Tae.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var vE={};function T1(n){return typeof n=="string"?vE[n]||(vE[n]=Nae(n)):Cae(n)?T1($ae(n)):Sae(n)?T1(n.name):wP}var wE=[0,2,4,5,7,9,11],j8="PMMPPMM";function Nae(n){const e=Fae(n);if(e[0]==="")return wP;const t=+e[0],s=e[1],a=(Math.abs(t)-1)%7,r=j8[a];if(r==="M"&&s==="P")return wP;const o=r==="M"?"majorable":"perfectable",i=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(a+1),u=Bae(o,s),h=Math.floor((Math.abs(t)-1)/7),m=l*(wE[a]+u+12*h),f=(l*(wE[a]+u)%12+12)%12,v=Aae({step:a,alt:u,oct:h,dir:l});return{empty:!1,name:i,num:t,q:s,step:a,alt:u,dir:l,type:o,simple:c,semitones:m,chroma:f,coord:v,oct:h}}function Bae(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function $ae(n){const{step:e,alt:t,oct:s=0,dir:a}=n;if(!a)return"";const r=e+1+7*s,o=r===0?e+1:r,i=a<0?"-":"",l=j8[e]==="M"?"majorable":"perfectable";return i+o+Rae(l,t)}function Rae(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?yE("A",e):yE("d",n==="perfectable"?e:e+1)}function _ae(n){const[e,t,s,a]=jC(n);return e===""?EO("",n):e==="A"&&a==="ug"?EO("","aug"):EO(e+t,s+a)}function EO(n,e){const t=e.split("/");if(t.length===1)return[n,t[0],""];const[s,a,r,o]=jC(t[1]);return s!==""&&r===""&&o===""?[n,t[0],s+a]:[n,e,""]}function Lae(n,e){return e.map(xu).map(s=>qi(n,T1(s))+s.chordType)}function Iae(n,e){return e.map(t=>{const[s,a]=_ae(t),r=Dv(n,s);return xu(T1(r)).name+a})}var Z8={fromRomanNumerals:Lae,toRomanNumerals:Iae};function z8(n){const e=ZC(n.map(t=>typeof t=="number"?t:g8(t)));return!n.length||e.length!==n.length?[]:e.reduce((t,s)=>{const a=t[t.length-1];return t.concat(Tv(a,s).slice(1))},[e[0]])}function Qae(n,e){return z8(n).map(t=>Vu(t,e))}var Vae={numeric:z8,chromatic:Qae},jae=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],Zae=jae;({...Ql});var uM=[],Qb={};function zae(){return uM.slice()}function Gae(n,e,t){const s=Wae(n),a={...Aa(n),name:t||"",quality:s,intervals:n,aliases:e};uM.push(a),a.name&&(Qb[a.name]=a),Qb[a.setNum]=a,Qb[a.chroma]=a,a.aliases.forEach(r=>Xae(a,r))}function Xae(n,e){Qb[e]=n}function Wae(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}Zae.forEach(([n,e,t])=>Gae(n.split(" "),t.split(" "),e));uM.sort((n,e)=>n.setNum-e.setNum);var qae={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function G8(n){if(typeof n!="string")return["",""];const e=n.indexOf(" "),t=is(n.substring(0,e));if(t.empty){const a=is(n);return a.empty?["",n.toLowerCase()]:[a.name,""]}const s=n.substring(t.name.length+1).toLowerCase();return[t.name,s.length?s:""]}var Uae=c8;function jl(n){const e=Array.isArray(n)?n:G8(n),t=is(e[0]).name,s=Zv(e[1]);if(s.empty)return qae;const a=s.name,r=t?s.intervals.map(i=>qi(t,i)):[],o=t?t+" "+a:a;return{...s,name:o,type:a,tonic:t,notes:r}}var Hae=jl;function Yae(n,e={}){const t=qN(n),s=is(e.tonic??n[0]??""),a=s.chroma;if(a===void 0)return[];const r=t.split("");r[a]="1";const o=Dm(a,r).join(""),i=Nm().find(c=>c.chroma===o),l=[];return i&&l.push(s.name+" "+i.name),e.match==="exact"||X8(o).forEach(c=>{l.push(s.name+" "+c)}),l}function Kae(n){const e=jl(n),t=Fv(e.chroma);return zae().filter(s=>t(s.chroma)).map(s=>s.aliases[0])}function X8(n){const e=GC(n)?n:jl(n).chroma,t=Nv(e);return Nm().filter(s=>t(s.chroma)).map(s=>s.name)}function Jae(n){const e=Fv(jl(n).chroma);return Nm().filter(t=>e(t.chroma)).map(t=>t.name)}function W8(n){const e=n.map(a=>is(a).pc).filter(a=>a),t=e[0],s=P8(e);return Dm(s.indexOf(t),s)}function ere(n){const e=jl(n);if(e.empty)return[];const t=e.tonic?e.notes:e.intervals;return XC(e.chroma).map((s,a)=>{const r=jl(s).name;return r?[t[a],r]:["",""]}).filter(s=>s[0])}function tre(n){const e=Array.isArray(n)?W8(n):jl(n).notes,t=e.map(s=>is(s).chroma);return s=>{const a=is(typeof s=="number"?w8(s):s),r=a.height;if(r===void 0)return;const o=r%12,i=t.indexOf(o);if(i!==-1)return S8(a.name,e[i])}}function nre(n){const e=tre(n);return(t,s)=>{const a=is(t).height,r=is(s).height;return a===void 0||r===void 0?[]:Tv(a,r).map(e).filter(o=>o)}}function sre(n){const{intervals:e,tonic:t}=jl(n),s=QN(e,t);return a=>a?s(a>0?a-1:a):""}function are(n){const{intervals:e,tonic:t}=jl(n);return QN(e,t)}var ji={degrees:sre,detect:Yae,extended:X8,get:jl,modeNames:ere,names:Uae,rangeOf:nre,reduced:Jae,scaleChords:Kae,scaleNotes:W8,steps:are,tokenize:G8,scale:Hae},rre={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},ore=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"];function ire(){return ore.slice()}var lre=/^(\d*\d(?:\+\d)*)\/(\d+)$/,OE=new Map;function cre(n){const e=JSON.stringify(n),t=OE.get(e);if(t)return t;const s=dre(hM(n));return OE.set(e,s),s}function hM(n){if(typeof n=="string"){const[r,o,i]=lre.exec(n)||[];return hM([o,i])}const[e,t]=n,s=+t;if(typeof e=="number")return[e,s];const a=e.split("+").map(r=>+r);return a.length===1?[a[0],s]:[a,s]}var ure={names:ire,parse:hM,get:cre},hre=n=>Math.log(n)/Math.log(2)%1===0;function dre([n,e]){const t=Array.isArray(n)?n.reduce((i,l)=>i+l,0):n,s=e;if(t===0||s===0)return rre;const a=Array.isArray(n)?`${n.join("+")}/${e}`:`${n}/${e}`,r=Array.isArray(n)?n:[],o=s===4||s===2?"simple":s===8&&t%3===0?"compound":hre(s)?"irregular":"irrational";return{empty:!1,name:a,type:o,upper:t,lower:s,additive:r}}var mre=o8,pre=HN,fre=l8,gre=h8;const bre=Object.freeze(Object.defineProperty({__proto__:null,AbcNotation:Tee,Array:Iee,Chord:bne,ChordDictionary:fre,ChordType:l8,Collection:Zee,Core:o8,DurationValue:Cne,Interval:Ou,Key:Xse,Midi:Kne,Mode:vae,Note:hr,PcSet:pre,Pcset:HN,Progression:Z8,Range:Vae,RomanNumeral:Rse,Scale:ji,ScaleDictionary:gre,ScaleType:h8,TimeSignature:ure,Tonal:mre,accToAlt:KC,altToAcc:YC,chroma:KN,coordToInterval:Ng,coordToNote:JC,coordinates:_v,deprecate:Tm,distance:eM,fillStr:a8,height:qC,interval:dr,isNamed:r8,isNamedPitch:Fg,isPitch:Rv,midi:JN,note:Vl,pitch:Lv,stepToLetter:HC,tokenizeInterval:UC,tokenizeNote:Iv,tonicIntervalsTransposer:Qv,transpose:tm},Symbol.toStringTag,{value:"Module"}));class Zi{constructor(e=!1){this.eventMap={},this.eventsSuspended=e==!0}addListener(e,t,s={}){if(typeof e=="string"&&e.length<1||e instanceof String&&e.length<1||typeof e!="string"&&!(e instanceof String)&&e!==Zi.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof t!="function")throw new TypeError("The callback must be a function.");const a=new xE(e,this,t,s);return this.eventMap[e]||(this.eventMap[e]=[]),s.prepend?this.eventMap[e].unshift(a):this.eventMap[e].push(a),a}addOneTimeListener(e,t,s={}){s.remaining=1,this.addListener(e,t,s)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(e,t){return e===void 0?this.eventMap[Zi.ANY_EVENT]&&this.eventMap[Zi.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,s])=>s.length>0):this.eventMap[e]&&this.eventMap[e].length>0?t instanceof xE?this.eventMap[e].filter(a=>a===t).length>0:typeof t=="function"?this.eventMap[e].filter(a=>a.callback===t).length>0:t==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(e){return this.eventMap[e]||[]}suspendEvent(e){this.getListeners(e).forEach(t=>{t.suspended=!0})}unsuspendEvent(e){this.getListeners(e).forEach(t=>{t.suspended=!1})}getListenerCount(e){return this.getListeners(e).length}emit(e,...t){if(typeof e!="string"&&!(e instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let s=[],a=this.eventMap[Zi.ANY_EVENT]||[];return this.eventMap[e]&&(a=a.concat(this.eventMap[e])),a.forEach(r=>{if(r.suspended)return;let o=[...t];Array.isArray(r.arguments)&&(o=o.concat(r.arguments)),r.remaining>0&&(s.push(r.callback.apply(r.context,o)),r.count++),--r.remaining<1&&r.remove()}),s}removeListener(e,t,s={}){if(e===void 0){this.eventMap={};return}else if(!this.eventMap[e])return;let a=this.eventMap[e].filter(r=>t&&r.callback!==t||s.remaining&&s.remaining!==r.remaining||s.context&&s.context!==r.context);a.length?this.eventMap[e]=a:delete this.eventMap[e]}async waitFor(e,t={}){return t.duration=parseInt(t.duration),(isNaN(t.duration)||t.duration<=0)&&(t.duration=1/0),new Promise((s,a)=>{let r,o=this.addListener(e,()=>{clearTimeout(r),s()},{remaining:1});t.duration!==1/0&&(r=setTimeout(()=>{o.remove(),a("The duration expired before the event was emitted.")},t.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class xE{constructor(e,t,s,a={}){if(typeof e!="string"&&!(e instanceof String)&&e!==Zi.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!t)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof s!="function")throw new TypeError("The 'callback' must be a function.");a.arguments!==void 0&&!Array.isArray(a.arguments)&&(a.arguments=[a.arguments]),a=Object.assign({context:t,remaining:1/0,arguments:void 0,duration:1/0},a),a.duration!==1/0&&setTimeout(()=>this.remove(),a.duration),this.arguments=a.arguments,this.callback=s,this.context=a.context,this.count=0,this.event=e,this.remaining=parseInt(a.remaining)>=1?parseInt(a.remaining):1/0,this.suspended=!1,this.target=t}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}/**
 * The `Enumerations` class contains enumerations and arrays of elements used throughout the
 * library. All its properties are static and should be referenced using the class name. For
 * example: `Enumerations.CHANNEL_MESSAGES`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class Xe{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),Xe.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),Xe.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),Xe.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),Xe.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}/**
 * The `Note` class represents a single musical note such as `"D3"`, `"G#4"`, `"F-1"`, `"Gb7"`, etc.
 *
 * `Note` objects can be played back on a single channel by calling
 * [`OutputChannel.playNote()`]{@link OutputChannel#playNote} or, on multiple channels of the same
 * output, by calling [`Output.playNote()`]{@link Output#playNote}.
 *
 * The note has [`attack`](#attack) and [`release`](#release) velocities set at `0.5` by default.
 * These can be changed by passing in the appropriate option. It is also possible to set a
 * system-wide default for attack and release velocities by using the
 * [`WebMidi.defaults`](WebMidi#defaults) property.
 *
 * If you prefer to work with raw MIDI values (`0` to `127`), you can use [`rawAttack`](#rawAttack) and
 * [`rawRelease`](#rawRelease) to both get and set the values.
 *
 * The note may have a [`duration`](#duration). If it does, playback will be automatically stopped
 * when the duration has elapsed by sending a `"noteoff"` event. By default, the duration is set to
 * `Infinity`. In this case, it will never stop playing unless explicitly stopped by calling a
 * method such as [`OutputChannel.stopNote()`]{@link OutputChannel#stopNote},
 * [`Output.stopNote()`]{@link Output#stopNote} or similar.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class mh{constructor(e,t={}){this.duration=gt.defaults.note.duration,this.attack=gt.defaults.note.attack,this.release=gt.defaults.note.release,t.duration!=null&&(this.duration=t.duration),t.attack!=null&&(this.attack=t.attack),t.rawAttack!=null&&(this.attack=bt.from7bitToFloat(t.rawAttack)),t.release!=null&&(this.release=t.release),t.rawRelease!=null&&(this.release=bt.from7bitToFloat(t.rawRelease)),Number.isInteger(e)?this.identifier=bt.toNoteIdentifier(e):this.identifier=e}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(e){const t=bt.getNoteDetails(e);if(gt.validation&&!e)throw new Error("Invalid note identifier");this._name=t.name,this._accidental=t.accidental,this._octave=t.octave}get name(){return this._name}set name(e){if(gt.validation&&(e=e.toUpperCase(),!["C","D","E","F","G","A","B"].includes(e)))throw new Error("Invalid name value");this._name=e}get accidental(){return this._accidental}set accidental(e){if(gt.validation&&(e=e.toLowerCase(),!["#","##","b","bb"].includes(e)))throw new Error("Invalid accidental value");this._accidental=e}get octave(){return this._octave}set octave(e){if(gt.validation&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid octave value");this._octave=e}get duration(){return this._duration}set duration(e){if(gt.validation&&(e=parseFloat(e),isNaN(e)||e===null||e<0))throw new RangeError("Invalid duration value.");this._duration=e}get attack(){return this._attack}set attack(e){if(gt.validation&&(e=parseFloat(e),isNaN(e)||!(e>=0&&e<=1)))throw new RangeError("Invalid attack value.");this._attack=e}get release(){return this._release}set release(e){if(gt.validation&&(e=parseFloat(e),isNaN(e)||!(e>=0&&e<=1)))throw new RangeError("Invalid release value.");this._release=e}get rawAttack(){return bt.fromFloatTo7Bit(this._attack)}set rawAttack(e){this._attack=bt.from7bitToFloat(e)}get rawRelease(){return bt.fromFloatTo7Bit(this._release)}set rawRelease(e){this._release=bt.from7bitToFloat(e)}get number(){return bt.toNoteNumber(this.identifier)}getOffsetNumber(e=0,t=0){return gt.validation&&(e=parseInt(e)||0,t=parseInt(t)||0),Math.min(Math.max(this.number+e*12+t,0),127)}}/**
 * The `Utilities` class contains general-purpose utility methods. All methods are static and
 * should be called using the class name. For example: `Utilities.getNoteDetails("C4")`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class bt{static toNoteNumber(e,t=0){if(t=t==null?0:parseInt(t),isNaN(t))throw new RangeError("Invalid 'octaveOffset' value");typeof e!="string"&&(e="");const s=this.getNoteDetails(e);if(!s)throw new TypeError("Invalid note identifier");const a={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let r=(s.octave+1+t)*12;if(r+=a[s.name],s.accidental&&(s.accidental.startsWith("b")?r-=s.accidental.length:r+=s.accidental.length),r<0||r>127)throw new RangeError("Invalid octaveOffset value");return r}static getNoteDetails(e){Number.isInteger(e)&&(e=this.toNoteIdentifier(e));const t=e.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!t)throw new TypeError("Invalid note identifier");const s=t[1].toUpperCase(),a=parseInt(t[3]);let r=t[2].toLowerCase();return r=r===""?void 0:r,{accidental:r,identifier:s+(r||"")+a,name:s,octave:a}}static sanitizeChannels(e){let t;if(gt.validation){if(e==="all")t=["all"];else if(e==="none")return[]}return Array.isArray(e)?t=e:t=[e],t.indexOf("all")>-1&&(t=Xe.MIDI_CHANNEL_NUMBERS),t.map(function(s){return parseInt(s)}).filter(function(s){return s>=1&&s<=16})}static toTimestamp(e){let t=!1;const s=parseFloat(e);return isNaN(s)?!1:(typeof e=="string"&&e.substring(0,1)==="+"?s>=0&&(t=gt.time+s):s>=0&&(t=s),t)}static guessNoteNumber(e,t){t=parseInt(t)||0;let s=!1;if(Number.isInteger(e)&&e>=0&&e<=127)s=parseInt(e);else if(parseInt(e)>=0&&parseInt(e)<=127)s=parseInt(e);else if(typeof e=="string"||e instanceof String)try{s=this.toNoteNumber(e.trim(),t)}catch{return!1}return s}static toNoteIdentifier(e,t){if(e=parseInt(e),isNaN(e)||e<0||e>127)throw new RangeError("Invalid note number");if(t=t==null?0:parseInt(t),isNaN(t))throw new RangeError("Invalid octaveOffset value");const s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],a=Math.floor(e/12-1)+t;return s[e%12]+a.toString()}static buildNote(e,t={}){if(t.octaveOffset=parseInt(t.octaveOffset)||0,e instanceof mh)return e;let s=this.guessNoteNumber(e,t.octaveOffset);if(s===!1)throw new TypeError(`The input could not be parsed as a note (${e})`);return t.octaveOffset=void 0,new mh(s,t)}static buildNoteArray(e,t={}){let s=[];return Array.isArray(e)||(e=[e]),e.forEach(a=>{s.push(this.buildNote(a,t))}),s}static from7bitToFloat(e){return e===1/0&&(e=127),e=parseInt(e)||0,Math.min(Math.max(e/127,0),1)}static fromFloatTo7Bit(e){return e===1/0&&(e=1),e=parseFloat(e)||0,Math.min(Math.max(Math.round(e*127),0),127)}static fromMsbLsbToFloat(e,t=0){gt.validation&&(e=Math.min(Math.max(parseInt(e)||0,0),127),t=Math.min(Math.max(parseInt(t)||0,0),127));const s=((e<<7)+t)/16383;return Math.min(Math.max(s,0),1)}static fromFloatToMsbLsb(e){gt.validation&&(e=Math.min(Math.max(parseFloat(e)||0,0),1));const t=Math.round(e*16383);return{msb:t>>7,lsb:t&127}}static offsetNumber(e,t=0,s=0){if(gt.validation){if(e=parseInt(e),isNaN(e))throw new Error("Invalid note number");t=parseInt(t)||0,s=parseInt(s)||0}return Math.min(Math.max(e+t*12+s,0),127)}static getPropertyByValue(e,t){return Object.keys(e).find(s=>e[s]===t)}static getCcNameByNumber(e){if(!(gt.validation&&(e=parseInt(e),!(e>=0&&e<=127))))return Xe.CONTROL_CHANGE_MESSAGES[e].name}static getCcNumberByName(e){let t=Xe.CONTROL_CHANGE_MESSAGES.find(s=>s.name===e);return t?t.number:Xe.MIDI_CONTROL_CHANGE_MESSAGES[e]}static getChannelModeByNumber(e){if(!(e>=120&&e<=127))return!1;for(let t in Xe.CHANNEL_MODE_MESSAGES)if(Xe.CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===Xe.CHANNEL_MODE_MESSAGES[t])return t;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}/**
 * The `OutputChannel` class represents a single output MIDI channel. `OutputChannel` objects are
 * provided by an [`Output`](Output) port which, itself, is made available by a device. The
 * `OutputChannel` object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `OutputChannel` objects can be found inside the parent output's
 * [`channels`]{@link Output#channels} property.
 *
 * @param {Output} output The [`Output`](Output) this channel belongs to.
 * @param {number} number The MIDI channel number (`1` - `16`).
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class q8 extends Zi{constructor(e,t){super(),this._output=e,this._number=t,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(e,t={time:0}){return this.output.send(e,t),this}sendKeyAftertouch(e,t,s={}){if(gt.validation){if(s.useRawValue&&(s.rawValue=s.useRawValue),isNaN(parseFloat(t)))throw new RangeError("Invalid key aftertouch value.");if(s.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}s.rawValue||(t=bt.fromFloatTo7Bit(t));const a=gt.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(e)||(e=[e]),bt.buildNoteArray(e).forEach(r=>{this.send([(Xe.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),r.getOffsetNumber(a),t],{time:bt.toTimestamp(s.time)})}),this}sendControlChange(e,t,s={}){if(typeof e=="string"&&(e=bt.getCcNumberByName(e)),Array.isArray(t)||(t=[t]),gt.validation){if(e===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(t=t.map(a=>{const r=Math.min(Math.max(parseInt(a),0),127);if(isNaN(r))throw new TypeError("Values must be integers between 0 and 127");return r}),t.length===2&&e>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return t.forEach((a,r)=>{this.send([(Xe.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),e+r*32,t[r]],{time:bt.toTimestamp(s.time)})}),this}_selectNonRegisteredParameter(e,t={}){return this.sendControlChange(99,e[0],t),this.sendControlChange(98,e[1],t),this}_deselectRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_deselectNonRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_selectRegisteredParameter(e,t={}){return this.sendControlChange(101,e[0],t),this.sendControlChange(100,e[1],t),this}_setCurrentParameter(e,t={}){return e=[].concat(e),this.sendControlChange(6,e[0],t),e.length<2?this:(this.sendControlChange(38,e[1],t),this)}sendRpnDecrement(e,t={}){if(Array.isArray(e)||(e=Xe.REGISTERED_PARAMETERS[e]),gt.validation){if(e===void 0)throw new TypeError("The specified registered parameter is invalid.");let s=!1;if(Object.getOwnPropertyNames(Xe.REGISTERED_PARAMETERS).forEach(a=>{Xe.REGISTERED_PARAMETERS[a][0]===e[0]&&Xe.REGISTERED_PARAMETERS[a][1]===e[1]&&(s=!0)}),!s)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(97,0,t),this._deselectRegisteredParameter(t),this}sendRpnIncrement(e,t={}){if(Array.isArray(e)||(e=Xe.REGISTERED_PARAMETERS[e]),gt.validation){if(e===void 0)throw new TypeError("The specified registered parameter is invalid.");let s=!1;if(Object.getOwnPropertyNames(Xe.REGISTERED_PARAMETERS).forEach(a=>{Xe.REGISTERED_PARAMETERS[a][0]===e[0]&&Xe.REGISTERED_PARAMETERS[a][1]===e[1]&&(s=!0)}),!s)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(96,0,t),this._deselectRegisteredParameter(t),this}playNote(e,t={}){this.sendNoteOn(e,t);const s=Array.isArray(e)?e:[e];for(let a of s)if(parseInt(a.duration)>0){const r={time:(bt.toTimestamp(t.time)||gt.time)+parseInt(a.duration),release:a.release,rawRelease:a.rawRelease};this.sendNoteOff(a,r)}else if(parseInt(t.duration)>0){const r={time:(bt.toTimestamp(t.time)||gt.time)+parseInt(t.duration),release:t.release,rawRelease:t.rawRelease};this.sendNoteOff(a,r)}return this}sendNoteOff(e,t={}){if(gt.validation){if(t.rawRelease!=null&&!(t.rawRelease>=0&&t.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(t.release!=null&&!(t.release>=0&&t.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");t.rawVelocity&&(t.rawRelease=t.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),t.velocity&&(t.release=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let s=64;t.rawRelease!=null?s=t.rawRelease:isNaN(t.release)||(s=Math.round(t.release*127));const a=gt.octaveOffset+this.output.octaveOffset+this.octaveOffset;return bt.buildNoteArray(e,{rawRelease:parseInt(s)}).forEach(r=>{this.send([(Xe.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),r.getOffsetNumber(a),r.rawRelease],{time:bt.toTimestamp(t.time)})}),this}stopNote(e,t={}){return this.sendNoteOff(e,t)}sendNoteOn(e,t={}){if(gt.validation){if(t.rawAttack!=null&&!(t.rawAttack>=0&&t.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(t.attack!=null&&!(t.attack>=0&&t.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");t.rawVelocity&&(t.rawAttack=t.velocity,t.rawRelease=t.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),t.velocity&&(t.attack=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let s=64;t.rawAttack!=null?s=t.rawAttack:isNaN(t.attack)||(s=Math.round(t.attack*127));const a=gt.octaveOffset+this.output.octaveOffset+this.octaveOffset;return bt.buildNoteArray(e,{rawAttack:s}).forEach(r=>{this.send([(Xe.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),r.getOffsetNumber(a),r.rawAttack],{time:bt.toTimestamp(t.time)})}),this}sendChannelMode(e,t=0,s={}){if(typeof e=="string"&&(e=Xe.CHANNEL_MODE_MESSAGES[e]),gt.validation){if(e===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(e)||!(e>=120&&e<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(t))||t<0||t>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(Xe.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),e,t],{time:bt.toTimestamp(s.time)}),this}sendOmniMode(e,t={}){return e===void 0||e?this.sendChannelMode("omnimodeon",0,t):this.sendChannelMode("omnimodeoff",0,t),this}sendChannelAftertouch(e,t={}){if(gt.validation){if(isNaN(parseFloat(e)))throw new RangeError("Invalid channel aftertouch value.");if(t.rawValue){if(!(e>=0&&e<=127&&Number.isInteger(e)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(e>=0&&e<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return t.rawValue||(e=bt.fromFloatTo7Bit(e)),this.send([(Xe.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(e)],{time:bt.toTimestamp(t.time)}),this}sendMasterTuning(e,t={}){if(e=parseFloat(e)||0,gt.validation&&!(e>-65&&e<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let s=Math.floor(e)+64,a=e-Math.floor(e);a=Math.round((a+1)/2*16383);let r=a>>7&127,o=a&127;return this.sendRpnValue("channelcoarsetuning",s,t),this.sendRpnValue("channelfinetuning",[r,o],t),this}sendModulationRange(e,t,s={}){if(gt.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(t!=null&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return t>=0&&t<=127||(t=0),this.sendRpnValue("modulationrange",[e,t],s),this}sendNrpnValue(e,t,s={}){if(t=[].concat(t),gt.validation){if(!Array.isArray(e)||!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");t.forEach(a=>{if(!(a>=0&&a<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(e,s),this._setCurrentParameter(t,s),this._deselectNonRegisteredParameter(s),this}sendPitchBend(e,t={}){if(gt.validation)if(t.rawValue&&Array.isArray(e)){if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(t.rawValue&&!Array.isArray(e)){if(!(e>=0&&e<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(e)||e===null)throw new RangeError("Invalid pitch bend value.");if(!(e>=-1&&e<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let s=0,a=0;if(t.rawValue&&Array.isArray(e))s=e[0],a=e[1];else if(t.rawValue&&!Array.isArray(e))s=e;else{const r=bt.fromFloatToMsbLsb((e+1)/2);s=r.msb,a=r.lsb}return this.send([(Xe.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),a,s],{time:bt.toTimestamp(t.time)}),this}sendPitchBendRange(e,t,s={}){if(gt.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[e,t],s),this}sendProgramChange(e,t={}){if(e=parseInt(e)||0,gt.validation&&!(e>=0&&e<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(Xe.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),e],{time:bt.toTimestamp(t.time)}),this}sendRpnValue(e,t,s={}){if(Array.isArray(e)||(e=Xe.REGISTERED_PARAMETERS[e]),gt.validation){if(!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(t).forEach(a=>{if(!(a>=0&&a<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(e,s),this._setCurrentParameter(t,s),this._deselectRegisteredParameter(s),this}sendTuningBank(e,t={}){if(gt.validation&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",e,t),this}sendTuningProgram(e,t={}){if(gt.validation&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",e,t),this}sendLocalControl(e,t={}){return e?this.sendChannelMode("localcontrol",127,t):this.sendChannelMode("localcontrol",0,t)}sendAllNotesOff(e={}){return this.sendChannelMode("allnotesoff",0,e)}sendAllSoundOff(e={}){return this.sendChannelMode("allsoundoff",0,e)}sendResetAllControllers(e={}){return this.sendChannelMode("resetallcontrollers",0,e)}sendPolyphonicMode(e,t={}){return e==="mono"?this.sendChannelMode("monomodeon",0,t):this.sendChannelMode("polymodeon",0,t)}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get output(){return this._output}get number(){return this._number}}/**
 * The `Output` class represents a single MIDI output port (not to be confused with a MIDI channel).
 * A port is made available by a MIDI device. A MIDI device can advertise several input and output
 * ports. Each port has 16 MIDI channels which can be accessed via the [`channels`](#channels)
 * property.
 *
 * The `Output` object is automatically instantiated by the library according to the host's MIDI
 * subsystem and should not be directly instantiated.
 *
 * You can access all available `Output` objects by referring to the
 * [`WebMidi.outputs`](WebMidi#outputs) array or by using methods such as
 * [`WebMidi.getOutputByName()`](WebMidi#getOutputByName) or
 * [`WebMidi.getOutputById()`](WebMidi#getOutputById).
 *
 * @fires Output#opened
 * @fires Output#disconnected
 * @fires Output#closed
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class F1 extends Zi{constructor(e){super(),this._midiOutput=e,this._octaveOffset=0,this.channels=[];for(let t=1;t<=16;t++)this.channels[t]=new q8(this,t);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(e){let t={timestamp:gt.time};e.port.connection==="open"?(t.type="opened",t.target=this,t.port=t.target,this.emit("opened",t)):e.port.connection==="closed"&&e.port.state==="connected"?(t.type="closed",t.target=this,t.port=t.target,this.emit("closed",t)):e.port.connection==="closed"&&e.port.state==="disconnected"?(t.type="disconnected",t.port={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):e.port.connection==="pending"&&e.port.state==="disconnected"||console.warn("This statechange event was not caught:",e.port.connection,e.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(e){return Promise.reject(e)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(e,t={time:0},s=0){if(e instanceof dM&&(e=bt.isNode?e.data:e.rawData),e instanceof Uint8Array&&bt.isNode&&(e=Array.from(e)),gt.validation){if(!Array.isArray(e)&&!(e instanceof Uint8Array)&&(e=[e],Array.isArray(t)&&(e=e.concat(t)),t=isNaN(s)?{time:0}:{time:s}),!(parseInt(e[0])>=128&&parseInt(e[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");e.slice(1).forEach(a=>{if(a=parseInt(a),!(a>=0&&a<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),t||(t={time:0})}return this._midiOutput.send(e,bt.toTimestamp(t.time)),this}sendSysex(e,t=[],s={}){if(e=[].concat(e),t instanceof Uint8Array){const a=new Uint8Array(1+e.length+t.length+1);a[0]=Xe.SYSTEM_MESSAGES.sysex,a.set(Uint8Array.from(e),1),a.set(t,1+e.length),a[a.length-1]=Xe.SYSTEM_MESSAGES.sysexend,this.send(a,{time:s.time})}else{const a=e.concat(t,Xe.SYSTEM_MESSAGES.sysexend);this.send([Xe.SYSTEM_MESSAGES.sysex].concat(a),{time:s.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():gt.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(e,t={}){if(gt.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([Xe.SYSTEM_MESSAGES.timecode,e],{time:t.time}),this}sendSongPosition(e=0,t={}){e=Math.floor(e)||0;var s=e>>7&127,a=e&127;return this.send([Xe.SYSTEM_MESSAGES.songposition,s,a],{time:t.time}),this}sendSongSelect(e=0,t={}){if(gt.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([Xe.SYSTEM_MESSAGES.songselect,e],{time:t.time}),this}sendTuneRequest(e={}){return this.send([Xe.SYSTEM_MESSAGES.tunerequest],{time:e.time}),this}sendClock(e={}){return this.send([Xe.SYSTEM_MESSAGES.clock],{time:e.time}),this}sendStart(e={}){return this.send([Xe.SYSTEM_MESSAGES.start],{time:e.time}),this}sendContinue(e={}){return this.send([Xe.SYSTEM_MESSAGES.continue],{time:e.time}),this}sendStop(e={}){return this.send([Xe.SYSTEM_MESSAGES.stop],{time:e.time}),this}sendActiveSensing(e={}){return this.send([Xe.SYSTEM_MESSAGES.activesensing],{time:e.time}),this}sendReset(e={}){return this.send([Xe.SYSTEM_MESSAGES.reset],{time:e.time}),this}sendTuningRequest(e={}){return gt.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(e)}sendKeyAftertouch(e,t,s={}){return s.channels==null&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a].sendKeyAftertouch(e,t,s)}),this}sendControlChange(e,t,s={},a={}){if(gt.validation&&(Array.isArray(s)||Number.isInteger(s)||s==="all")){const r=s;s=a,s.channels=r,s.channels==="all"&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS)}return s.channels==null&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r].sendControlChange(e,t,s)}),this}sendPitchBendRange(e=0,t=0,s={}){return s.channels==null&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a].sendPitchBendRange(e,t,s)}),this}setPitchBendRange(e=0,t=0,s="all",a={}){return gt.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),a.channels=s,a.channels==="all"&&(a.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(e,t,a)}sendRpnValue(e,t,s={}){return s.channels==null&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a].sendRpnValue(e,t,s)}),this}setRegisteredParameter(e,t=[],s="all",a={}){return gt.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),a.channels=s,a.channels==="all"&&(a.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(e,t,a)}sendChannelAftertouch(e,t={},s={}){if(gt.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendChannelAftertouch(e,t)}),this}sendPitchBend(e,t={},s={}){if(gt.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendPitchBend(e,t)}),this}sendProgramChange(e=0,t={},s={}){if(gt.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendProgramChange(e,t)}),this}sendModulationRange(e,t,s={}){return s.channels==null&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a].sendModulationRange(e,t,s)}),this}setModulationRange(e=0,t=0,s="all",a={}){return gt.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),a.channels=s,a.channels==="all"&&(a.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(e,t,a)}sendMasterTuning(e,t={}){return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendMasterTuning(e,t)}),this}setMasterTuning(e,t={},s={}){return gt.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),s.channels=t,s.channels==="all"&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(e,s)}sendTuningProgram(e,t={}){return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendTuningProgram(e,t)}),this}setTuningProgram(e,t="all",s={}){return gt.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),s.channels=t,s.channels==="all"&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(e,s)}sendTuningBank(e=0,t={}){return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendTuningBank(e,t)}),this}setTuningBank(e,t="all",s={}){return gt.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),s.channels=t,s.channels==="all"&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(e,s)}sendChannelMode(e,t=0,s={},a={}){if(gt.validation&&(Array.isArray(s)||Number.isInteger(s)||s==="all")){const r=s;s=a,s.channels=r,s.channels==="all"&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS)}return s.channels==null&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r].sendChannelMode(e,t,s)}),this}sendAllSoundOff(e={}){return e.channels==null&&(e.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].sendAllSoundOff(e)}),this}sendAllNotesOff(e={}){return e.channels==null&&(e.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].sendAllNotesOff(e)}),this}sendResetAllControllers(e={},t={}){if(gt.validation&&(Array.isArray(e)||Number.isInteger(e)||e==="all")){const s=e;e=t,e.channels=s,e.channels==="all"&&(e.channels=Xe.MIDI_CHANNEL_NUMBERS)}return e.channels==null&&(e.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(e.channels).forEach(s=>{this.channels[s].sendResetAllControllers(e)}),this}sendPolyphonicMode(e,t={},s={}){if(gt.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendPolyphonicMode(e,t)}),this}sendLocalControl(e,t={},s={}){if(gt.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendLocalControl(e,t)}),this}sendOmniMode(e,t={},s={}){if(gt.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendOmniMode(e,t)}),this}sendNrpnValue(e,t,s={}){return s.channels==null&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a].sendNrpnValue(e,t,s)}),this}setNonRegisteredParameter(e,t=[],s="all",a={}){return gt.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),a.channels=s,a.channels==="all"&&(a.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(e,t,a)}sendRpnIncrement(e,t={}){return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendRpnIncrement(e,t)}),this}incrementRegisteredParameter(e,t="all",s={}){return gt.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),s.channels=t,s.channels==="all"&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(e,s)}sendRpnDecrement(e,t={}){return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendRpnDecrement(e,t)}),this}decrementRegisteredParameter(e,t="all",s={}){return gt.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),s.channels=t,s.channels==="all"&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(e,s)}sendNoteOff(e,t={},s={}){if(gt.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendNoteOff(e,t)}),this}stopNote(e,t){return this.sendNoteOff(e,t)}playNote(e,t={},s={}){if(gt.validation&&(t.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),t.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].playNote(e,t)}),this}sendNoteOn(e,t={},s={}){if(gt.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const a=t;t=s,t.channels=a,t.channels==="all"&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(t.channels).forEach(a=>{this.channels[a].sendNoteOn(e,t)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}}/**
 * The `Forwarder` class allows the forwarding of MIDI messages to predetermined outputs. When you
 * call its [`forward()`](#forward) method, it will send the specified [`Message`](Message) object
 * to all the outputs listed in its [`destinations`](#destinations) property.
 *
 * If specific channels or message types have been defined in the [`channels`](#channels) or
 * [`types`](#types) properties, only messages matching the channels/types will be forwarded.
 *
 * While it can be manually instantiated, you are more likely to come across a `Forwarder` object as
 * the return value of the [`Input.addForwarder()`](Input#addForwarder) method.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class OP{constructor(e=[],t={}){this.destinations=[],this.types=[...Object.keys(Xe.SYSTEM_MESSAGES),...Object.keys(Xe.CHANNEL_MESSAGES)],this.channels=Xe.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(e)||(e=[e]),t.types&&!Array.isArray(t.types)&&(t.types=[t.types]),t.channels&&!Array.isArray(t.channels)&&(t.channels=[t.channels]),gt.validation&&(e.forEach(s=>{if(!(s instanceof F1))throw new TypeError("Destinations must be of type 'Output'.")}),t.types!==void 0&&t.types.forEach(s=>{if(!Xe.SYSTEM_MESSAGES.hasOwnProperty(s)&&!Xe.CHANNEL_MESSAGES.hasOwnProperty(s))throw new TypeError("Type must be a valid message type.")}),t.channels!==void 0&&t.channels.forEach(s=>{if(!Xe.MIDI_CHANNEL_NUMBERS.includes(s))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=e,t.types&&(this.types=t.types),t.channels&&(this.channels=t.channels)}forward(e){this.suspended||this.types.includes(e.type)&&(e.channel&&!this.channels.includes(e.channel)||this.destinations.forEach(t=>{gt.validation&&!(t instanceof F1)||t.send(e)}))}}/**
 * The `InputChannel` class represents a single MIDI input channel (1-16) from a single input
 * device. This object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `InputChannel` objects can be found inside the input's [`channels`](Input#channels)
 * property.
 *
 * @fires InputChannel#midimessage
 * @fires InputChannel#unknownmessage
 *
 * @fires InputChannel#noteoff
 * @fires InputChannel#noteon
 * @fires InputChannel#keyaftertouch
 * @fires InputChannel#programchange
 * @fires InputChannel#channelaftertouch
 * @fires InputChannel#pitchbend
 *
 * @fires InputChannel#allnotesoff
 * @fires InputChannel#allsoundoff
 * @fires InputChannel#localcontrol
 * @fires InputChannel#monomode
 * @fires InputChannel#omnimode
 * @fires InputChannel#resetallcontrollers
 *
 * @fires InputChannel#event:nrpn
 * @fires InputChannel#event:nrpn-dataentrycoarse
 * @fires InputChannel#event:nrpn-dataentryfine
 * @fires InputChannel#event:nrpn-dataincrement
 * @fires InputChannel#event:nrpn-datadecrement
 * @fires InputChannel#event:rpn
 * @fires InputChannel#event:rpn-dataentrycoarse
 * @fires InputChannel#event:rpn-dataentryfine
 * @fires InputChannel#event:rpn-dataincrement
 * @fires InputChannel#event:rpn-datadecrement
 *
 * @fires InputChannel#controlchange
 * @fires InputChannel#event:controlchange-controllerxxx
 * @fires InputChannel#event:controlchange-bankselectcoarse
 * @fires InputChannel#event:controlchange-modulationwheelcoarse
 * @fires InputChannel#event:controlchange-breathcontrollercoarse
 * @fires InputChannel#event:controlchange-footcontrollercoarse
 * @fires InputChannel#event:controlchange-portamentotimecoarse
 * @fires InputChannel#event:controlchange-dataentrycoarse
 * @fires InputChannel#event:controlchange-volumecoarse
 * @fires InputChannel#event:controlchange-balancecoarse
 * @fires InputChannel#event:controlchange-pancoarse
 * @fires InputChannel#event:controlchange-expressioncoarse
 * @fires InputChannel#event:controlchange-effectcontrol1coarse
 * @fires InputChannel#event:controlchange-effectcontrol2coarse
 * @fires InputChannel#event:controlchange-generalpurposecontroller1
 * @fires InputChannel#event:controlchange-generalpurposecontroller2
 * @fires InputChannel#event:controlchange-generalpurposecontroller3
 * @fires InputChannel#event:controlchange-generalpurposecontroller4
 * @fires InputChannel#event:controlchange-bankselectfine
 * @fires InputChannel#event:controlchange-modulationwheelfine
 * @fires InputChannel#event:controlchange-breathcontrollerfine
 * @fires InputChannel#event:controlchange-footcontrollerfine
 * @fires InputChannel#event:controlchange-portamentotimefine
 * @fires InputChannel#event:controlchange-dataentryfine
 * @fires InputChannel#event:controlchange-channelvolumefine
 * @fires InputChannel#event:controlchange-balancefine
 * @fires InputChannel#event:controlchange-panfine
 * @fires InputChannel#event:controlchange-expressionfine
 * @fires InputChannel#event:controlchange-effectcontrol1fine
 * @fires InputChannel#event:controlchange-effectcontrol2fine
 * @fires InputChannel#event:controlchange-damperpedal
 * @fires InputChannel#event:controlchange-portamento
 * @fires InputChannel#event:controlchange-sostenuto
 * @fires InputChannel#event:controlchange-softpedal
 * @fires InputChannel#event:controlchange-legatopedal
 * @fires InputChannel#event:controlchange-hold2
 * @fires InputChannel#event:controlchange-soundvariation
 * @fires InputChannel#event:controlchange-resonance
 * @fires InputChannel#event:controlchange-releasetime
 * @fires InputChannel#event:controlchange-attacktime
 * @fires InputChannel#event:controlchange-brightness
 * @fires InputChannel#event:controlchange-decaytime
 * @fires InputChannel#event:controlchange-vibratorate
 * @fires InputChannel#event:controlchange-vibratodepth
 * @fires InputChannel#event:controlchange-vibratodelay
 * @fires InputChannel#event:controlchange-generalpurposecontroller5
 * @fires InputChannel#event:controlchange-generalpurposecontroller6
 * @fires InputChannel#event:controlchange-generalpurposecontroller7
 * @fires InputChannel#event:controlchange-generalpurposecontroller8
 * @fires InputChannel#event:controlchange-portamentocontrol
 * @fires InputChannel#event:controlchange-highresolutionvelocityprefix
 * @fires InputChannel#event:controlchange-effect1depth
 * @fires InputChannel#event:controlchange-effect2depth
 * @fires InputChannel#event:controlchange-effect3depth
 * @fires InputChannel#event:controlchange-effect4depth
 * @fires InputChannel#event:controlchange-effect5depth
 * @fires InputChannel#event:controlchange-dataincrement
 * @fires InputChannel#event:controlchange-datadecrement
 * @fires InputChannel#event:controlchange-nonregisteredparameterfine
 * @fires InputChannel#event:controlchange-nonregisteredparametercoarse
 * @fires InputChannel#event:controlchange-registeredparameterfine
 * @fires InputChannel#event:controlchange-registeredparametercoarse
 * @fires InputChannel#event:controlchange-allsoundoff
 * @fires InputChannel#event:controlchange-resetallcontrollers
 * @fires InputChannel#event:controlchange-localcontrol
 * @fires InputChannel#event:controlchange-allnotesoff
 * @fires InputChannel#event:controlchange-omnimodeoff
 * @fires InputChannel#event:controlchange-omnimodeon
 * @fires InputChannel#event:controlchange-monomodeon
 * @fires InputChannel#event:controlchange-polymodeon
 * @fires InputChannel#event:
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class U8 extends Zi{constructor(e,t){super(),this._input=e,this._number=t,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(e){const t=Object.assign({},e);t.port=this.input,t.target=this,t.type="midimessage",this.emit(t.type,t),this._parseEventForStandardMessages(t)}_parseEventForStandardMessages(e){const t=Object.assign({},e);t.type=t.message.type||"unknownmessage";const s=e.message.dataBytes[0],a=e.message.dataBytes[1];if(t.type==="noteoff"||t.type==="noteon"&&a===0)this.notesState[s]=!1,t.type="noteoff",t.note=new mh(bt.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+gt.octaveOffset),{rawAttack:0,rawRelease:a}),t.value=bt.from7bitToFloat(a),t.rawValue=a,t.velocity=t.note.release,t.rawVelocity=t.note.rawRelease;else if(t.type==="noteon")this.notesState[s]=!0,t.note=new mh(bt.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+gt.octaveOffset),{rawAttack:a}),t.value=bt.from7bitToFloat(a),t.rawValue=a,t.velocity=t.note.attack,t.rawVelocity=t.note.rawAttack;else if(t.type==="keyaftertouch")t.note=new mh(bt.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+gt.octaveOffset)),t.value=bt.from7bitToFloat(a),t.rawValue=a,t.identifier=t.note.identifier,t.key=t.note.number,t.rawKey=s;else if(t.type==="controlchange"){t.controller={number:s,name:Xe.CONTROL_CHANGE_MESSAGES[s].name,description:Xe.CONTROL_CHANGE_MESSAGES[s].description,position:Xe.CONTROL_CHANGE_MESSAGES[s].position},t.subtype=t.controller.name||"controller"+s,t.value=bt.from7bitToFloat(a),t.rawValue=a;const r=Object.assign({},t);r.type=`${t.type}-controller${s}`,delete r.subtype,this.emit(r.type,r);const o=Object.assign({},t);o.type=`${t.type}-`+Xe.CONTROL_CHANGE_MESSAGES[s].name,delete o.subtype,o.type.indexOf("controller")!==0&&this.emit(o.type,o),t.message.dataBytes[0]>=120&&this._parseChannelModeMessage(t),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(t.message.dataBytes[0])&&this._parseEventForParameterNumber(t)}else t.type==="programchange"?(t.value=s,t.rawValue=t.value):t.type==="channelaftertouch"?(t.value=bt.from7bitToFloat(s),t.rawValue=s):t.type==="pitchbend"?(t.value=((a<<7)+s-8192)/8192,t.rawValue=(a<<7)+s):t.type="unknownmessage";this.emit(t.type,t)}_parseChannelModeMessage(e){const t=Object.assign({},e);t.type=t.controller.name,t.type==="localcontrol"&&(t.value=t.message.data[2]===127,t.rawValue=t.message.data[2]),t.type==="omnimodeon"?(t.type="omnimode",t.value=!0,t.rawValue=t.message.data[2]):t.type==="omnimodeoff"&&(t.type="omnimode",t.value=!1,t.rawValue=t.message.data[2]),t.type==="monomodeon"?(t.type="monomode",t.value=!0,t.rawValue=t.message.data[2]):t.type==="polymodeon"&&(t.type="monomode",t.value=!1,t.rawValue=t.message.data[2]),this.emit(t.type,t)}_parseEventForParameterNumber(e){const t=e.message.dataBytes[0],s=e.message.dataBytes[1];t===99||t===101?(this._nrpnBuffer=[],this._rpnBuffer=[],t===99?this._nrpnBuffer=[e.message]:s!==127&&(this._rpnBuffer=[e.message])):t===98||t===100?t===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(e.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&s!==127?this._rpnBuffer.push(e.message):this._rpnBuffer=[]):(t===6||t===38||t===96||t===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],e):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],e):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(e){return e===6||e===38||e===96||e===97||e===98||e===99||e===100||e===101}_dispatchParameterNumberEvent(e,t,s,a){e=e==="nrpn"?"nrpn":"rpn";const r={target:a.target,timestamp:a.timestamp,message:a.message,parameterMsb:t,parameterLsb:s,value:bt.from7bitToFloat(a.message.dataBytes[1]),rawValue:a.message.dataBytes[1]};e==="rpn"?r.parameter=Object.keys(Xe.REGISTERED_PARAMETERS).find(l=>Xe.REGISTERED_PARAMETERS[l][0]===t&&Xe.REGISTERED_PARAMETERS[l][1]===s):r.parameter=(t<<7)+s;const o=Xe.CONTROL_CHANGE_MESSAGES[a.message.dataBytes[0]].name;r.type=`${e}-${o}`,this.emit(r.type,r);const i=Object.assign({},r);i.type==="nrpn-dataincrement"?i.type="nrpn-databuttonincrement":i.type==="nrpn-datadecrement"?i.type="nrpn-databuttondecrement":i.type==="rpn-dataincrement"?i.type="rpn-databuttonincrement":i.type==="rpn-datadecrement"&&(i.type="rpn-databuttondecrement"),this.emit(i.type,i),r.type=e,r.subtype=o,this.emit(r.type,r)}getChannelModeByNumber(e){return gt.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),e=Math.floor(e)),bt.getChannelModeByNumber(e)}getCcNameByNumber(e){if(gt.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),e=parseInt(e),!(e>=0&&e<=127)))throw new RangeError("Invalid control change number.");return bt.getCcNameByNumber(e)}getNoteState(e){e instanceof mh&&(e=e.identifier);const t=bt.guessNoteNumber(e,gt.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[t]}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(e){this.validation&&(e=!!e),this.parameterNumberEventsEnabled=e}}/**
 * The `Message` class represents a single MIDI message. It has several properties that make it
 * easy to make sense of the binary data it contains.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class dM{constructor(e){this.rawData=e,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=bt.getPropertyByValue(Xe.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=bt.getPropertyByValue(Xe.SYSTEM_MESSAGES,this.command)),this.statusByte===Xe.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}/**
 * The `Input` class represents a single MIDI input port. This object is automatically instantiated
 * by the library according to the host's MIDI subsystem and does not need to be directly
 * instantiated. Instead, you can access all `Input` objects by referring to the
 * [`WebMidi.inputs`](WebMidi#inputs) array. You can also retrieve inputs by using methods such as
 * [`WebMidi.getInputByName()`](WebMidi#getInputByName) and
 * [`WebMidi.getInputById()`](WebMidi#getInputById).
 *
 * Note that a single MIDI device may expose several inputs and/or outputs.
 *
 * **Important**: the `Input` class does not directly fire channel-specific MIDI messages
 * (such as [`noteon`](InputChannel#event:noteon) or
 * [`controlchange`](InputChannel#event:controlchange), etc.). The [`InputChannel`](InputChannel)
 * object does that. However, you can still use the
 * [`Input.addListener()`](#addListener) method to listen to channel-specific events on multiple
 * [`InputChannel`](InputChannel) objects at once.
 *
 * @fires Input#opened
 * @fires Input#disconnected
 * @fires Input#closed
 * @fires Input#midimessage
 *
 * @fires Input#sysex
 * @fires Input#timecode
 * @fires Input#songposition
 * @fires Input#songselect
 * @fires Input#tunerequest
 * @fires Input#clock
 * @fires Input#start
 * @fires Input#continue
 * @fires Input#stop
 * @fires Input#activesensing
 * @fires Input#reset
 *
 * @fires Input#unknownmidimessage
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class H8 extends Zi{constructor(e){super(),this._midiInput=e,this._octaveOffset=0,this.channels=[];for(let t=1;t<=16;t++)this.channels[t]=new U8(this,t);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(e){let t={timestamp:gt.time,target:this,port:this};e.port.connection==="open"?(t.type="opened",this.emit("opened",t)):e.port.connection==="closed"&&e.port.state==="connected"?(t.type="closed",this.emit("closed",t)):e.port.connection==="closed"&&e.port.state==="disconnected"?(t.type="disconnected",t.port={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):e.port.connection==="pending"&&e.port.state==="disconnected"||console.warn("This statechange event was not caught: ",e.port.connection,e.port.state)}_onMidiMessage(e){const t=new dM(e.data),s={port:this,target:this,message:t,timestamp:e.timeStamp,type:"midimessage",data:t.data,rawData:t.data,statusByte:t.data[0],dataBytes:t.dataBytes};this.emit("midimessage",s),t.isSystemMessage?this._parseEvent(s):t.isChannelMessage&&this.channels[t.channel]._processMidiMessageEvent(s),this._forwarders.forEach(a=>a.forward(t))}_parseEvent(e){const t=Object.assign({},e);t.type=t.message.type||"unknownmidimessage",t.type==="songselect"&&(t.song=e.data[1]+1,t.value=e.data[1],t.rawValue=t.value),this.emit(t.type,t)}async open(){try{await this._midiInput.open()}catch(e){return Promise.reject(e)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(e){return Promise.reject(e)}return Promise.resolve(this)}getChannelModeByNumber(){gt.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(e,t,s={}){if(gt.validation&&typeof s=="function"){let a=t!=null?[].concat(t):void 0;t=s,s={channels:a}}if(Xe.CHANNEL_EVENTS.includes(e)){s.channels===void 0&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS);let a=[];return bt.sanitizeChannels(s.channels).forEach(r=>{a.push(this.channels[r].addListener(e,t,s))}),a}else return super.addListener(e,t,s)}addOneTimeListener(e,t,s={}){return s.remaining=1,this.addListener(e,t,s)}on(e,t,s,a){return this.addListener(e,t,s,a)}hasListener(e,t,s={}){if(gt.validation&&typeof s=="function"){let a=[].concat(t);t=s,s={channels:a}}return Xe.CHANNEL_EVENTS.includes(e)?(s.channels===void 0&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),bt.sanitizeChannels(s.channels).every(a=>this.channels[a].hasListener(e,t))):super.hasListener(e,t)}removeListener(e,t,s={}){if(gt.validation&&typeof s=="function"){let a=[].concat(t);t=s,s={channels:a}}if(s.channels===void 0&&(s.channels=Xe.MIDI_CHANNEL_NUMBERS),e==null)return bt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a]&&this.channels[a].removeListener()}),super.removeListener();Xe.CHANNEL_EVENTS.includes(e)?bt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a].removeListener(e,t,s)}):super.removeListener(e,t,s)}addForwarder(e,t={}){let s;return e instanceof OP?s=e:s=new OP(e,t),this._forwarders.push(s),s}removeForwarder(e){this._forwarders=this._forwarders.filter(t=>t!==e)}hasForwarder(e){return this._forwarders.includes(e)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return gt.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}/**
 * The `WebMidi` object makes it easier to work with the low-level Web MIDI API. Basically, it
 * simplifies sending outgoing MIDI messages and reacting to incoming MIDI messages.
 *
 * When using the WebMidi.js library, you should know that the `WebMidi` class has already been
 * instantiated. You cannot instantiate it yourself. If you use the **IIFE** version, you should
 * simply use the global object called `WebMidi`. If you use the **CJS** (CommonJS) or **ESM** (ES6
 * module) version, you get an already-instantiated object when you import the module.
 *
 * @fires WebMidi#connected
 * @fires WebMidi#disabled
 * @fires WebMidi#disconnected
 * @fires WebMidi#enabled
 * @fires WebMidi#error
 * @fires WebMidi#midiaccessgranted
 * @fires WebMidi#portschanged
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class yre extends Zi{constructor(){super(),this.defaults={note:{attack:bt.from7bitToFloat(64),release:bt.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(e={},t=!1){if(bt.isNode)try{window.navigator}catch{let i=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,i)}if(this.validation=e.validation!==!1,this.validation&&(typeof e=="function"&&(e={callback:e,sysex:t}),t&&(e.sysex=!0)),this.enabled)return typeof e.callback=="function"&&e.callback(),Promise.resolve();const s={timestamp:this.time,target:this,type:"error",error:void 0},a={timestamp:this.time,target:this,type:"midiaccessgranted"},r={timestamp:this.time,target:this,type:"enabled"};try{typeof e.requestMIDIAccessFunction=="function"?this.interface=await e.requestMIDIAccessFunction({sysex:e.sysex,software:e.software}):this.interface=await navigator.requestMIDIAccess({sysex:e.sysex,software:e.software})}catch(o){return s.error=o,this.emit("error",s),typeof e.callback=="function"&&e.callback(o),Promise.reject(o)}this.emit("midiaccessgranted",a),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(o){return s.error=o,this.emit("error",s),typeof e.callback=="function"&&e.callback(o),Promise.reject(o)}return this.emit("enabled",r),typeof e.callback=="function"&&e.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let e={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",e),this.removeListener()})}getInputById(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return}if(t.disconnected){for(let s=0;s<this._disconnectedInputs.length;s++)if(this._disconnectedInputs[s]._midiInput&&this._disconnectedInputs[s].id===e.toString())return this._disconnectedInputs[s]}else for(let s=0;s<this.inputs.length;s++)if(this.inputs[s]._midiInput&&this.inputs[s].id===e.toString())return this.inputs[s]}getInputByName(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return;e=e.toString()}if(t.disconnected){for(let s=0;s<this._disconnectedInputs.length;s++)if(~this._disconnectedInputs[s].name.indexOf(e))return this._disconnectedInputs[s]}else for(let s=0;s<this.inputs.length;s++)if(~this.inputs[s].name.indexOf(e))return this.inputs[s]}getOutputByName(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return;e=e.toString()}if(t.disconnected){for(let s=0;s<this._disconnectedOutputs.length;s++)if(~this._disconnectedOutputs[s].name.indexOf(e))return this._disconnectedOutputs[s]}else for(let s=0;s<this.outputs.length;s++)if(~this.outputs[s].name.indexOf(e))return this.outputs[s]}getOutputById(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return}if(t.disconnected){for(let s=0;s<this._disconnectedOutputs.length;s++)if(this._disconnectedOutputs[s]._midiOutput&&this._disconnectedOutputs[s].id===e.toString())return this._disconnectedOutputs[s]}else for(let s=0;s<this.outputs.length;s++)if(this.outputs[s]._midiOutput&&this.outputs[s].id===e.toString())return this.outputs[s]}noteNameToNumber(e){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),bt.toNoteNumber(e,this.octaveOffset)}getOctave(e){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),e=parseInt(e)),!isNaN(e)&&e>=0&&e<=127?bt.getNoteDetails(bt.offsetNumber(e,this.octaveOffset)).octave:!1}sanitizeChannels(e){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),bt.sanitizeChannels(e)}toMIDIChannels(e){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),bt.sanitizeChannels(e)}guessNoteNumber(e){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),bt.guessNoteNumber(e,this.octaveOffset)}getValidNoteArray(e,t={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),bt.buildNoteArray(e,t)}convertToTimestamp(e){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),bt.toTimestamp(e)}async _destroyInputsAndOutputs(){let e=[];return this.inputs.forEach(t=>e.push(t.destroy())),this.outputs.forEach(t=>e.push(t.destroy())),Promise.all(e).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(e){this._updateInputsAndOutputs();let t={timestamp:e.timeStamp,type:e.port.state,target:this};if(e.port.state==="connected"&&e.port.connection==="open"){e.port.type==="output"?t.port=this.getOutputById(e.port.id):e.port.type==="input"&&(t.port=this.getInputById(e.port.id)),this.emit(e.port.state,t);const s=Object.assign({},t);s.type="portschanged",this.emit(s.type,s)}else if(e.port.state==="disconnected"&&e.port.connection==="pending"){e.port.type==="input"?t.port=this.getInputById(e.port.id,{disconnected:!0}):e.port.type==="output"&&(t.port=this.getOutputById(e.port.id,{disconnected:!0})),this.emit(e.port.state,t);const s=Object.assign({},t);s.type="portschanged",this.emit(s.type,s)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let t=this._inputs.length-1;t>=0;t--){const s=this._inputs[t];Array.from(this.interface.inputs.values()).find(r=>r===s._midiInput)||(this._disconnectedInputs.push(s),this._inputs.splice(t,1))}let e=[];return this.interface.inputs.forEach(t=>{if(!this._inputs.find(s=>s._midiInput===t)){let s=this._disconnectedInputs.find(a=>a._midiInput===t);s||(s=new H8(t)),this._inputs.push(s),e.push(s.open())}}),Promise.all(e)}async _updateOutputs(){if(!this.interface)return;for(let t=this._outputs.length-1;t>=0;t--){const s=this._outputs[t];Array.from(this.interface.outputs.values()).find(r=>r===s._midiOutput)||(this._disconnectedOutputs.push(s),this._outputs.splice(t,1))}let e=[];return this.interface.outputs.forEach(t=>{if(!this._outputs.find(s=>s._midiOutput===t)){let s=this._disconnectedOutputs.find(a=>a._midiOutput===t);s||(s=new F1(t)),this._outputs.push(s),e.push(s.open())}}),Promise.all(e)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),bt.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),bt.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.14"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),Xe.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),Xe.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),Xe.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),Xe.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),Xe.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const gt=new yre;gt.constructor=null;const o6e=Object.freeze(Object.defineProperty({__proto__:null,Enumerations:Xe,Forwarder:OP,Input:H8,InputChannel:U8,Message:dM,Note:mh,Output:F1,OutputChannel:q8,Utilities:bt,WebMidi:gt},Symbol.toStringTag,{value:"Module"}));let xP=[],Y8=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?Y8:xP).push(t=t+n[e])})();function vre(n){if(n<768)return!1;for(let e=0,t=xP.length;;){let s=e+t>>1;if(n<xP[s])t=s;else if(n>=Y8[s])e=s+1;else return!0;if(e==t)return!1}}function kE(n){return n>=127462&&n<=127487}const PE=8205;function wre(n,e,t=!0,s=!0){return(t?K8:Ore)(n,e,s)}function K8(n,e,t){if(e==n.length)return e;e&&J8(n.charCodeAt(e))&&eB(n.charCodeAt(e-1))&&e--;let s=DO(n,e);for(e+=SE(s);e<n.length;){let a=DO(n,e);if(s==PE||a==PE||t&&vre(a))e+=SE(a),s=a;else if(kE(a)){let r=0,o=e-2;for(;o>=0&&kE(DO(n,o));)r++,o-=2;if(r%2==0)break;e+=2}else break}return e}function Ore(n,e,t){for(;e>0;){let s=K8(n,e-2,t);if(s<e)return s;e--}return 0}function DO(n,e){let t=n.charCodeAt(e);if(!eB(t)||e+1==n.length)return t;let s=n.charCodeAt(e+1);return J8(s)?(t-55296<<10)+(s-56320)+65536:t}function J8(n){return n>=56320&&n<57344}function eB(n){return n>=55296&&n<56320}function SE(n){return n<65536?1:2}let rs=class tB{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,s){[e,t]=nm(this,e,t);let a=[];return this.decompose(0,e,a,2),s.length&&s.decompose(0,s.length,a,3),this.decompose(t,this.length,a,1),Pl.from(a,this.length-(t-e)+s.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=nm(this,e,t);let s=[];return this.decompose(e,t,s,0),Pl.from(s,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),s=this.length-this.scanIdentical(e,-1),a=new pf(this),r=new pf(e);for(let o=t,i=t;;){if(a.next(o),r.next(o),o=0,a.lineBreak!=r.lineBreak||a.done!=r.done||a.value!=r.value)return!1;if(i+=a.value.length,a.done||i>=s)return!0}}iter(e=1){return new pf(this,e)}iterRange(e,t=this.length){return new nB(this,e,t)}iterLines(e,t){let s;if(e==null)s=this.iter();else{t==null&&(t=this.lines+1);let a=this.line(e).from;s=this.iterRange(a,Math.max(a,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new sB(s)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?tB.empty:e.length<=32?new ua(e):Pl.from(ua.split(e,[]))}};class ua extends rs{constructor(e,t=xre(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,s,a){for(let r=0;;r++){let o=this.text[r],i=a+o.length;if((t?s:i)>=e)return new kre(a,i,s,o);a=i+1,s++}}decompose(e,t,s,a){let r=e<=0&&t>=this.length?this:new ua(CE(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(a&1){let o=s.pop(),i=Vb(r.text,o.text.slice(),0,r.length);if(i.length<=32)s.push(new ua(i,o.length+r.length));else{let l=i.length>>1;s.push(new ua(i.slice(0,l)),new ua(i.slice(l)))}}else s.push(r)}replace(e,t,s){if(!(s instanceof ua))return super.replace(e,t,s);[e,t]=nm(this,e,t);let a=Vb(this.text,Vb(s.text,CE(this.text,0,e)),t),r=this.length+s.length-(t-e);return a.length<=32?new ua(a,r):Pl.from(ua.split(a,[]),r)}sliceString(e,t=this.length,s=`
`){[e,t]=nm(this,e,t);let a="";for(let r=0,o=0;r<=t&&o<this.text.length;o++){let i=this.text[o],l=r+i.length;r>e&&o&&(a+=s),e<l&&t>r&&(a+=i.slice(Math.max(0,e-r),t-r)),r=l+1}return a}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let s=[],a=-1;for(let r of e)s.push(r),a+=r.length+1,s.length==32&&(t.push(new ua(s,a)),s=[],a=-1);return a>-1&&t.push(new ua(s,a)),t}}class Pl extends rs{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let s of e)this.lines+=s.lines}lineInner(e,t,s,a){for(let r=0;;r++){let o=this.children[r],i=a+o.length,l=s+o.lines-1;if((t?l:i)>=e)return o.lineInner(e,t,s,a);a=i+1,s=l+1}}decompose(e,t,s,a){for(let r=0,o=0;o<=t&&r<this.children.length;r++){let i=this.children[r],l=o+i.length;if(e<=l&&t>=o){let c=a&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!c?s.push(i):i.decompose(e-o,t-o,s,c)}o=l+1}}replace(e,t,s){if([e,t]=nm(this,e,t),s.lines<this.lines)for(let a=0,r=0;a<this.children.length;a++){let o=this.children[a],i=r+o.length;if(e>=r&&t<=i){let l=o.replace(e-r,t-r,s),c=this.lines-o.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[a]=l,new Pl(u,this.length-(t-e)+s.length)}return super.replace(r,i,l)}r=i+1}return super.replace(e,t,s)}sliceString(e,t=this.length,s=`
`){[e,t]=nm(this,e,t);let a="";for(let r=0,o=0;r<this.children.length&&o<=t;r++){let i=this.children[r],l=o+i.length;o>e&&r&&(a+=s),e<l&&t>o&&(a+=i.sliceString(e-o,t-o,s)),o=l+1}return a}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Pl))return 0;let s=0,[a,r,o,i]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;a+=t,r+=t){if(a==o||r==i)return s;let l=this.children[a],c=e.children[r];if(l!=c)return s+l.scanIdentical(c,t);s+=l.length+1}}static from(e,t=e.reduce((s,a)=>s+a.length+1,-1)){let s=0;for(let f of e)s+=f.lines;if(s<32){let f=[];for(let v of e)v.flatten(f);return new ua(f,t)}let a=Math.max(32,s>>5),r=a<<1,o=a>>1,i=[],l=0,c=-1,u=[];function h(f){let v;if(f.lines>r&&f instanceof Pl)for(let O of f.children)h(O);else f.lines>o&&(l>o||!l)?(m(),i.push(f)):f instanceof ua&&l&&(v=u[u.length-1])instanceof ua&&f.lines+v.lines<=32?(l+=f.lines,c+=f.length+1,u[u.length-1]=new ua(v.text.concat(f.text),v.length+1+f.length)):(l+f.lines>a&&m(),l+=f.lines,c+=f.length+1,u.push(f))}function m(){l!=0&&(i.push(u.length==1?u[0]:Pl.from(u,c)),c=-1,l=u.length=0)}for(let f of e)h(f);return m(),i.length==1?i[0]:new Pl(i,t)}}rs.empty=new ua([""],0);function xre(n){let e=-1;for(let t of n)e+=t.length+1;return e}function Vb(n,e,t=0,s=1e9){for(let a=0,r=0,o=!0;r<n.length&&a<=s;r++){let i=n[r],l=a+i.length;l>=t&&(l>s&&(i=i.slice(0,s-a)),a<t&&(i=i.slice(t-a)),o?(e[e.length-1]+=i,o=!1):e.push(i)),a=l+1}return e}function CE(n,e,t){return Vb(n,[""],e,t)}class pf{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof ua?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let s=this.nodes.length-1,a=this.nodes[s],r=this.offsets[s],o=r>>1,i=a instanceof ua?a.text.length:a.children.length;if(o==(t>0?i:0)){if(s==0)return this.done=!0,this.value="",this;t>0&&this.offsets[s-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(t>0?0:1)){if(this.offsets[s]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(a instanceof ua){let l=a.text[o+(t<0?-1:0)];if(this.offsets[s]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=a.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[s]+=t):(t<0&&this.offsets[s]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof ua?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class nB{constructor(e,t,s){this.value="",this.done=!1,this.cursor=new pf(e,t>s?-1:1),this.pos=t>s?e.length:0,this.from=Math.min(t,s),this.to=Math.max(t,s)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let s=t<0?this.pos-this.from:this.to-this.pos;e>s&&(e=s),s-=e;let{value:a}=this.cursor.next(e);return this.pos+=(a.length+e)*t,this.value=a.length<=s?a:t<0?a.slice(a.length-s):a.slice(0,s),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class sB{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:s,value:a}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):s?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=a,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(rs.prototype[Symbol.iterator]=function(){return this.iter()},pf.prototype[Symbol.iterator]=nB.prototype[Symbol.iterator]=sB.prototype[Symbol.iterator]=function(){return this});class kre{constructor(e,t,s,a){this.from=e,this.to=t,this.number=s,this.text=a}get length(){return this.to-this.from}}function nm(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Ha(n,e,t=!0,s=!0){return wre(n,e,t,s)}function Pre(n){return n>=56320&&n<57344}function Sre(n){return n>=55296&&n<56320}function so(n,e){let t=n.charCodeAt(e);if(!Sre(t)||e+1==n.length)return t;let s=n.charCodeAt(e+1);return Pre(s)?(t-55296<<10)+(s-56320)+65536:t}function mM(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Sl(n){return n<65536?1:2}const kP=/\r\n?|\n/;var fa=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(fa||(fa={}));class Rl{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let s=this.sections[t+1];e+=s<0?this.sections[t]:s}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,s=0,a=0;t<this.sections.length;){let r=this.sections[t++],o=this.sections[t++];o<0?(e(s,a,r),a+=r):a+=o,s+=r}}iterChangedRanges(e,t=!1){PP(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let s=this.sections[t++],a=this.sections[t++];a<0?e.push(s,a):e.push(a,s)}return new Rl(e)}composeDesc(e){return this.empty?e:e.empty?this:aB(this,e)}mapDesc(e,t=!1){return e.empty?this:SP(this,e,t)}mapPos(e,t=-1,s=fa.Simple){let a=0,r=0;for(let o=0;o<this.sections.length;){let i=this.sections[o++],l=this.sections[o++],c=a+i;if(l<0){if(c>e)return r+(e-a);r+=i}else{if(s!=fa.Simple&&c>=e&&(s==fa.TrackDel&&a<e&&c>e||s==fa.TrackBefore&&a<e||s==fa.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!i)return e==a||t<0?r:r+l;r+=l}a=c}if(e>a)throw new RangeError(`Position ${e} is out of range for changeset of length ${a}`);return r}touchesRange(e,t=e){for(let s=0,a=0;s<this.sections.length&&a<=t;){let r=this.sections[s++],o=this.sections[s++],i=a+r;if(o>=0&&a<=t&&i>=e)return a<e&&i>t?"cover":!0;a=i}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let s=this.sections[t++],a=this.sections[t++];e+=(e?" ":"")+s+(a>=0?":"+a:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Rl(e)}static create(e){return new Rl(e)}}class ka extends Rl{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return PP(this,(t,s,a,r,o)=>e=e.replace(a,a+(s-t),o),!1),e}mapDesc(e,t=!1){return SP(this,e,t,!0)}invert(e){let t=this.sections.slice(),s=[];for(let a=0,r=0;a<t.length;a+=2){let o=t[a],i=t[a+1];if(i>=0){t[a]=i,t[a+1]=o;let l=a>>1;for(;s.length<l;)s.push(rs.empty);s.push(o?e.slice(r,r+o):rs.empty)}r+=o}return new ka(t,s)}compose(e){return this.empty?e:e.empty?this:aB(this,e,!0)}map(e,t=!1){return e.empty?this:SP(this,e,t,!0)}iterChanges(e,t=!1){PP(this,e,t)}get desc(){return Rl.create(this.sections)}filter(e){let t=[],s=[],a=[],r=new Rf(this);e:for(let o=0,i=0;;){let l=o==e.length?1e9:e[o++];for(;i<l||i==l&&r.len==0;){if(r.done)break e;let u=Math.min(r.len,l-i);or(a,u,-1);let h=r.ins==-1?-1:r.off==0?r.ins:0;or(t,u,h),h>0&&su(s,t,r.text),r.forward(u),i+=u}let c=e[o++];for(;i<c;){if(r.done)break e;let u=Math.min(r.len,c-i);or(t,u,-1),or(a,u,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(u),i+=u}}return{changes:new ka(t,s),filtered:Rl.create(a)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let s=this.sections[t],a=this.sections[t+1];a<0?e.push(s):a==0?e.push([s]):e.push([s].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,s){let a=[],r=[],o=0,i=null;function l(u=!1){if(!u&&!a.length)return;o<t&&or(a,t-o,-1);let h=new ka(a,r);i=i?i.compose(h.map(i)):h,a=[],r=[],o=0}function c(u){if(Array.isArray(u))for(let h of u)c(h);else if(u instanceof ka){if(u.length!=t)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${t})`);l(),i=i?i.compose(u.map(i)):u}else{let{from:h,to:m=h,insert:f}=u;if(h>m||h<0||m>t)throw new RangeError(`Invalid change range ${h} to ${m} (in doc of length ${t})`);let v=f?typeof f=="string"?rs.of(f.split(s||kP)):f:rs.empty,O=v.length;if(h==m&&O==0)return;h<o&&l(),h>o&&or(a,h-o,-1),or(a,m-h,O),su(r,a,v),o=m}}return c(e),l(!i),i}static empty(e){return new ka(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],s=[];for(let a=0;a<e.length;a++){let r=e[a];if(typeof r=="number")t.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,i)=>i&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)t.push(r[0],0);else{for(;s.length<a;)s.push(rs.empty);s[a]=rs.of(r.slice(1)),t.push(r[0],s[a].length)}}}return new ka(t,s)}static createSet(e,t){return new ka(e,t)}}function or(n,e,t,s=!1){if(e==0&&t<=0)return;let a=n.length-2;a>=0&&t<=0&&t==n[a+1]?n[a]+=e:a>=0&&e==0&&n[a]==0?n[a+1]+=t:s?(n[a]+=e,n[a+1]+=t):n.push(e,t)}function su(n,e,t){if(t.length==0)return;let s=e.length-2>>1;if(s<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<s;)n.push(rs.empty);n.push(t)}}function PP(n,e,t){let s=n.inserted;for(let a=0,r=0,o=0;o<n.sections.length;){let i=n.sections[o++],l=n.sections[o++];if(l<0)a+=i,r+=i;else{let c=a,u=r,h=rs.empty;for(;c+=i,u+=l,l&&s&&(h=h.append(s[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)i=n.sections[o++],l=n.sections[o++];e(a,c,r,u,h),a=c,r=u}}}function SP(n,e,t,s=!1){let a=[],r=s?[]:null,o=new Rf(n),i=new Rf(e);for(let l=-1;;){if(o.done&&i.len||i.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&i.ins==-1){let c=Math.min(o.len,i.len);or(a,c,-1),o.forward(c),i.forward(c)}else if(i.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(i.len<o.len||i.len==o.len&&!t))){let c=i.len;for(or(a,i.ins,-1);c;){let u=Math.min(o.len,c);o.ins>=0&&l<o.i&&o.len<=u&&(or(a,0,o.ins),r&&su(r,a,o.text),l=o.i),o.forward(u),c-=u}i.next()}else if(o.ins>=0){let c=0,u=o.len;for(;u;)if(i.ins==-1){let h=Math.min(u,i.len);c+=h,u-=h,i.forward(h)}else if(i.ins==0&&i.len<u)u-=i.len,i.next();else break;or(a,c,l<o.i?o.ins:0),r&&l<o.i&&su(r,a,o.text),l=o.i,o.forward(o.len-u)}else{if(o.done&&i.done)return r?ka.createSet(a,r):Rl.create(a);throw new Error("Mismatched change set lengths")}}}function aB(n,e,t=!1){let s=[],a=t?[]:null,r=new Rf(n),o=new Rf(e);for(let i=!1;;){if(r.done&&o.done)return a?ka.createSet(s,a):Rl.create(s);if(r.ins==0)or(s,r.len,0,i),r.next();else if(o.len==0&&!o.done)or(s,0,o.ins,i),a&&su(a,s,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(r.len2,o.len),c=s.length;if(r.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;or(s,l,u,i),a&&u&&su(a,s,o.text)}else o.ins==-1?(or(s,r.off?0:r.len,l,i),a&&su(a,s,r.textBit(l))):(or(s,r.off?0:r.len,o.off?0:o.ins,i),a&&!o.off&&su(a,s,o.text));i=(r.ins>l||o.ins>=0&&o.len>l)&&(i||s.length>c),r.forward2(l),o.forward(l)}}}}class Rf{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?rs.empty:e[t]}textBit(e){let{inserted:t}=this.set,s=this.i-2>>1;return s>=t.length&&!e?rs.empty:t[s].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class ph{constructor(e,t,s){this.from=e,this.to=t,this.flags=s}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let s,a;return this.empty?s=a=e.mapPos(this.from,t):(s=e.mapPos(this.from,1),a=e.mapPos(this.to,-1)),s==this.from&&a==this.to?this:new ph(s,a,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return Ve.range(e,t);let s=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Ve.range(this.anchor,s)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Ve.range(e.anchor,e.head)}static create(e,t,s){return new ph(e,t,s)}}class Ve{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:Ve.create(this.ranges.map(s=>s.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let s=0;s<this.ranges.length;s++)if(!this.ranges[s].eq(e.ranges[s],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Ve([this.main],0)}addRange(e,t=!0){return Ve.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let s=this.ranges.slice();return s[t]=e,Ve.create(s,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Ve(e.ranges.map(t=>ph.fromJSON(t)),e.main)}static single(e,t=e){return new Ve([Ve.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let s=0,a=0;a<e.length;a++){let r=e[a];if(r.empty?r.from<=s:r.from<s)return Ve.normalized(e.slice(),t);s=r.to}return new Ve(e,t)}static cursor(e,t=0,s,a){return ph.create(e,e,(t==0?0:t<0?8:16)|(s==null?7:Math.min(6,s))|(a??16777215)<<6)}static range(e,t,s,a){let r=(s??16777215)<<6|(a==null?7:Math.min(6,a));return t<e?ph.create(t,e,48|r):ph.create(e,t,(t>e?8:0)|r)}static normalized(e,t=0){let s=e[t];e.sort((a,r)=>a.from-r.from),t=e.indexOf(s);for(let a=1;a<e.length;a++){let r=e[a],o=e[a-1];if(r.empty?r.from<=o.to:r.from<o.to){let i=o.from,l=Math.max(r.to,o.to);a<=t&&t--,e.splice(--a,2,r.anchor>r.head?Ve.range(l,i):Ve.range(i,l))}}return new Ve(e,t)}}function rB(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let pM=0;class Lt{constructor(e,t,s,a,r){this.combine=e,this.compareInput=t,this.compare=s,this.isStatic=a,this.id=pM++,this.default=e([]),this.extensions=typeof r=="function"?r(this):r}get reader(){return this}static define(e={}){return new Lt(e.combine||(t=>t),e.compareInput||((t,s)=>t===s),e.compare||(e.combine?(t,s)=>t===s:fM),!!e.static,e.enables)}of(e){return new jb([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new jb(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new jb(e,this,2,t)}from(e,t){return t||(t=s=>s),this.compute([e],s=>t(s.field(e)))}}function fM(n,e){return n==e||n.length==e.length&&n.every((t,s)=>t===e[s])}class jb{constructor(e,t,s,a){this.dependencies=e,this.facet=t,this.type=s,this.value=a,this.id=pM++}dynamicSlot(e){var t;let s=this.value,a=this.facet.compareInput,r=this.id,o=e[r]>>1,i=this.type==2,l=!1,c=!1,u=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?c=!0:(((t=e[h.id])!==null&&t!==void 0?t:1)&1)==0&&u.push(e[h.id]);return{create(h){return h.values[o]=s(h),1},update(h,m){if(l&&m.docChanged||c&&(m.docChanged||m.selection)||CP(h,u)){let f=s(h);if(i?!ME(f,h.values[o],a):!a(f,h.values[o]))return h.values[o]=f,1}return 0},reconfigure:(h,m)=>{let f,v=m.config.address[r];if(v!=null){let O=B1(m,v);if(this.dependencies.every(k=>k instanceof Lt?m.facet(k)===h.facet(k):k instanceof zs?m.field(k,!1)==h.field(k,!1):!0)||(i?ME(f=s(h),O,a):a(f=s(h),O)))return h.values[o]=O,0}else f=s(h);return h.values[o]=f,1}}}}function ME(n,e,t){if(n.length!=e.length)return!1;for(let s=0;s<n.length;s++)if(!t(n[s],e[s]))return!1;return!0}function CP(n,e){let t=!1;for(let s of e)ff(n,s)&1&&(t=!0);return t}function Cre(n,e,t){let s=t.map(l=>n[l.id]),a=t.map(l=>l.type),r=s.filter(l=>!(l&1)),o=n[e.id]>>1;function i(l){let c=[];for(let u=0;u<s.length;u++){let h=B1(l,s[u]);if(a[u]==2)for(let m of h)c.push(m);else c.push(h)}return e.combine(c)}return{create(l){for(let c of s)ff(l,c);return l.values[o]=i(l),1},update(l,c){if(!CP(l,r))return 0;let u=i(l);return e.compare(u,l.values[o])?0:(l.values[o]=u,1)},reconfigure(l,c){let u=CP(l,s),h=c.config.facets[e.id],m=c.facet(e);if(h&&!u&&fM(t,h))return l.values[o]=m,0;let f=i(l);return e.compare(f,m)?(l.values[o]=m,0):(l.values[o]=f,1)}}}const b0=Lt.define({static:!0});class zs{constructor(e,t,s,a,r){this.id=e,this.createF=t,this.updateF=s,this.compareF=a,this.spec=r,this.provides=void 0}static define(e){let t=new zs(pM++,e.create,e.update,e.compare||((s,a)=>s===a),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(b0).find(s=>s.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:s=>(s.values[t]=this.create(s),1),update:(s,a)=>{let r=s.values[t],o=this.updateF(r,a);return this.compareF(r,o)?0:(s.values[t]=o,1)},reconfigure:(s,a)=>{let r=s.facet(b0),o=a.facet(b0),i;return(i=r.find(l=>l.field==this))&&i!=o.find(l=>l.field==this)?(s.values[t]=i.create(s),1):a.config.address[this.id]!=null?(s.values[t]=a.field(this),0):(s.values[t]=this.create(s),1)}}}init(e){return[this,b0.of({field:this,create:e})]}get extension(){return this}}const oh={lowest:4,low:3,default:2,high:1,highest:0};function dp(n){return e=>new oB(e,n)}const jo={highest:dp(oh.highest),high:dp(oh.high),default:dp(oh.default),low:dp(oh.low),lowest:dp(oh.lowest)};class oB{constructor(e,t){this.inner=e,this.prec=t}}class Bg{of(e){return new MP(this,e)}reconfigure(e){return Bg.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class MP{constructor(e,t){this.compartment=e,this.inner=t}}class N1{constructor(e,t,s,a,r,o){for(this.base=e,this.compartments=t,this.dynamicSlots=s,this.address=a,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<s.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,s){let a=[],r=Object.create(null),o=new Map;for(let m of Mre(e,t,o))m instanceof zs?a.push(m):(r[m.facet.id]||(r[m.facet.id]=[])).push(m);let i=Object.create(null),l=[],c=[];for(let m of a)i[m.id]=c.length<<1,c.push(f=>m.slot(f));let u=s==null?void 0:s.config.facets;for(let m in r){let f=r[m],v=f[0].facet,O=u&&u[m]||[];if(f.every(k=>k.type==0))if(i[v.id]=l.length<<1|1,fM(O,f))l.push(s.facet(v));else{let k=v.combine(f.map(M=>M.value));l.push(s&&v.compare(k,s.facet(v))?s.facet(v):k)}else{for(let k of f)k.type==0?(i[k.id]=l.length<<1|1,l.push(k.value)):(i[k.id]=c.length<<1,c.push(M=>k.dynamicSlot(M)));i[v.id]=c.length<<1,c.push(k=>Cre(k,v,f))}}let h=c.map(m=>m(i));return new N1(e,o,h,i,l,r)}}function Mre(n,e,t){let s=[[],[],[],[],[]],a=new Map;function r(o,i){let l=a.get(o);if(l!=null){if(l<=i)return;let c=s[l].indexOf(o);c>-1&&s[l].splice(c,1),o instanceof MP&&t.delete(o.compartment)}if(a.set(o,i),Array.isArray(o))for(let c of o)r(c,i);else if(o instanceof MP){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;t.set(o.compartment,c),r(c,i)}else if(o instanceof oB)r(o.inner,o.prec);else if(o instanceof zs)s[i].push(o),o.provides&&r(o.provides,i);else if(o instanceof jb)s[i].push(o),o.facet.extensions&&r(o.facet.extensions,oh.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(c,i)}}return r(n,oh.default),s.reduce((o,i)=>o.concat(i))}function ff(n,e){if(e&1)return 2;let t=e>>1,s=n.status[t];if(s==4)throw new Error("Cyclic dependency between fields and/or facets");if(s&2)return s;n.status[t]=4;let a=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|a}function B1(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const iB=Lt.define(),AP=Lt.define({combine:n=>n.some(e=>e),static:!0}),lB=Lt.define({combine:n=>n.length?n[0]:void 0,static:!0}),cB=Lt.define(),uB=Lt.define(),hB=Lt.define(),dB=Lt.define({combine:n=>n.length?n[0]:!1});class Ic{constructor(e,t){this.type=e,this.value=t}static define(){return new Are}}class Are{of(e){return new Ic(this,e)}}class Ere{constructor(e){this.map=e}of(e){return new cn(this,e)}}class cn{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new cn(this.type,t)}is(e){return this.type==e}static define(e={}){return new Ere(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let s=[];for(let a of e){let r=a.map(t);r&&s.push(r)}return s}}cn.reconfigure=cn.define();cn.appendConfig=cn.define();class ba{constructor(e,t,s,a,r,o){this.startState=e,this.changes=t,this.selection=s,this.effects=a,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,s&&rB(s,t.newLength),r.some(i=>i.type==ba.time)||(this.annotations=r.concat(ba.time.of(Date.now())))}static create(e,t,s,a,r,o){return new ba(e,t,s,a,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(ba.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}ba.time=Ic.define();ba.userEvent=Ic.define();ba.addToHistory=Ic.define();ba.remote=Ic.define();function Dre(n,e){let t=[];for(let s=0,a=0;;){let r,o;if(s<n.length&&(a==e.length||e[a]>=n[s]))r=n[s++],o=n[s++];else if(a<e.length)r=e[a++],o=e[a++];else return t;!t.length||t[t.length-1]<r?t.push(r,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function mB(n,e,t){var s;let a,r,o;return t?(a=e.changes,r=ka.empty(e.changes.length),o=n.changes.compose(e.changes)):(a=e.changes.map(n.changes),r=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(a)),{changes:o,selection:e.selection?e.selection.map(r):(s=n.selection)===null||s===void 0?void 0:s.map(a),effects:cn.mapEffects(n.effects,a).concat(cn.mapEffects(e.effects,r)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function EP(n,e,t){let s=e.selection,a=Ed(e.annotations);return e.userEvent&&(a=a.concat(ba.userEvent.of(e.userEvent))),{changes:e.changes instanceof ka?e.changes:ka.of(e.changes||[],t,n.facet(lB)),selection:s&&(s instanceof Ve?s:Ve.single(s.anchor,s.head)),effects:Ed(e.effects),annotations:a,scrollIntoView:!!e.scrollIntoView}}function pB(n,e,t){let s=EP(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let r=1;r<e.length;r++){e[r].filter===!1&&(t=!1);let o=!!e[r].sequential;s=mB(s,EP(n,e[r],o?s.changes.newLength:n.doc.length),o)}let a=ba.create(n,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return Fre(t?Tre(a):a)}function Tre(n){let e=n.startState,t=!0;for(let a of e.facet(cB)){let r=a(n);if(r===!1){t=!1;break}Array.isArray(r)&&(t=t===!0?r:Dre(t,r))}if(t!==!0){let a,r;if(t===!1)r=n.changes.invertedDesc,a=ka.empty(e.doc.length);else{let o=n.changes.filter(t);a=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}n=ba.create(e,a,n.selection&&n.selection.map(r),cn.mapEffects(n.effects,r),n.annotations,n.scrollIntoView)}let s=e.facet(uB);for(let a=s.length-1;a>=0;a--){let r=s[a](n);r instanceof ba?n=r:Array.isArray(r)&&r.length==1&&r[0]instanceof ba?n=r[0]:n=pB(e,Ed(r),!1)}return n}function Fre(n){let e=n.startState,t=e.facet(hB),s=n;for(let a=t.length-1;a>=0;a--){let r=t[a](n);r&&Object.keys(r).length&&(s=mB(s,EP(e,r,n.changes.newLength),!0))}return s==n?n:ba.create(e,n.changes,n.selection,s.effects,s.annotations,s.scrollIntoView)}const Nre=[];function Ed(n){return n==null?Nre:Array.isArray(n)?n:[n]}var Hs=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(Hs||(Hs={}));const Bre=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let DP;try{DP=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function $re(n){if(DP)return DP.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||Bre.test(t)))return!0}return!1}function Rre(n){return e=>{if(!/\S/.test(e))return Hs.Space;if($re(e))return Hs.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return Hs.Word;return Hs.Other}}class cs{constructor(e,t,s,a,r,o){this.config=e,this.doc=t,this.selection=s,this.values=a,this.status=e.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let i=0;i<this.config.dynamicSlots.length;i++)ff(this,i<<1);this.computeSlot=null}field(e,t=!0){let s=this.config.address[e.id];if(s==null){if(t)throw new RangeError("Field is not present in this state");return}return ff(this,s),B1(this,s)}update(...e){return pB(this,e,!0)}applyTransaction(e){let t=this.config,{base:s,compartments:a}=t;for(let i of e.effects)i.is(Bg.reconfigure)?(t&&(a=new Map,t.compartments.forEach((l,c)=>a.set(c,l)),t=null),a.set(i.value.compartment,i.value.extension)):i.is(cn.reconfigure)?(t=null,s=i.value):i.is(cn.appendConfig)&&(t=null,s=Ed(s).concat(i.value));let r;t?r=e.startState.values.slice():(t=N1.resolve(s,a,this),r=new cs(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let o=e.startState.facet(AP)?e.newSelection:e.newSelection.asSingle();new cs(t,e.newDoc,o,r,(i,l)=>l.update(i,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:Ve.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,s=e(t.ranges[0]),a=this.changes(s.changes),r=[s.range],o=Ed(s.effects);for(let i=1;i<t.ranges.length;i++){let l=e(t.ranges[i]),c=this.changes(l.changes),u=c.map(a);for(let m=0;m<i;m++)r[m]=r[m].map(u);let h=a.mapDesc(c,!0);r.push(l.range.map(h)),a=a.compose(u),o=cn.mapEffects(o,u).concat(cn.mapEffects(Ed(l.effects),h))}return{changes:a,selection:Ve.create(r,t.mainIndex),effects:o}}changes(e=[]){return e instanceof ka?e:ka.of(e,this.doc.length,this.facet(cs.lineSeparator))}toText(e){return rs.of(e.split(this.facet(cs.lineSeparator)||kP))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(ff(this,t),B1(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let s in e){let a=e[s];a instanceof zs&&this.config.address[a.id]!=null&&(t[s]=a.spec.toJSON(this.field(e[s]),this))}return t}static fromJSON(e,t={},s){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let a=[];if(s){for(let r in s)if(Object.prototype.hasOwnProperty.call(e,r)){let o=s[r],i=e[r];a.push(o.init(l=>o.spec.fromJSON(i,l)))}}return cs.create({doc:e.doc,selection:Ve.fromJSON(e.selection),extensions:t.extensions?a.concat([t.extensions]):a})}static create(e={}){let t=N1.resolve(e.extensions||[],new Map),s=e.doc instanceof rs?e.doc:rs.of((e.doc||"").split(t.staticFacet(cs.lineSeparator)||kP)),a=e.selection?e.selection instanceof Ve?e.selection:Ve.single(e.selection.anchor,e.selection.head):Ve.single(0);return rB(a,s.length),t.staticFacet(AP)||(a=a.asSingle()),new cs(t,s,a,t.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(cs.tabSize)}get lineBreak(){return this.facet(cs.lineSeparator)||`
`}get readOnly(){return this.facet(dB)}phrase(e,...t){for(let s of this.facet(cs.phrases))if(Object.prototype.hasOwnProperty.call(s,e)){e=s[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(s,a)=>{if(a=="$")return"$";let r=+(a||1);return!r||r>t.length?s:t[r-1]})),e}languageDataAt(e,t,s=-1){let a=[];for(let r of this.facet(iB))for(let o of r(this,t,s))Object.prototype.hasOwnProperty.call(o,e)&&a.push(o[e]);return a}charCategorizer(e){return Rre(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:s,length:a}=this.doc.lineAt(e),r=this.charCategorizer(e),o=e-s,i=e-s;for(;o>0;){let l=Ha(t,o,!1);if(r(t.slice(l,o))!=Hs.Word)break;o=l}for(;i<a;){let l=Ha(t,i);if(r(t.slice(i,l))!=Hs.Word)break;i=l}return o==i?null:Ve.range(o+s,i+s)}}cs.allowMultipleSelections=AP;cs.tabSize=Lt.define({combine:n=>n.length?n[0]:4});cs.lineSeparator=lB;cs.readOnly=dB;cs.phrases=Lt.define({compare(n,e){let t=Object.keys(n),s=Object.keys(e);return t.length==s.length&&t.every(a=>n[a]==e[a])}});cs.languageData=iB;cs.changeFilter=cB;cs.transactionFilter=uB;cs.transactionExtender=hB;Bg.reconfigure=cn.define();function Kl(n,e,t={}){let s={};for(let a of n)for(let r of Object.keys(a)){let o=a[r],i=s[r];if(i===void 0)s[r]=o;else if(!(i===o||o===void 0))if(Object.hasOwnProperty.call(t,r))s[r]=t[r](i,o);else throw new Error("Config merge conflict for field "+r)}for(let a in e)s[a]===void 0&&(s[a]=e[a]);return s}class Rh{eq(e){return this==e}range(e,t=e){return TP.create(e,t,this)}}Rh.prototype.startSide=Rh.prototype.endSide=0;Rh.prototype.point=!1;Rh.prototype.mapMode=fa.TrackDel;let TP=class fB{constructor(e,t,s){this.from=e,this.to=t,this.value=s}static create(e,t,s){return new fB(e,t,s)}};function FP(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class gM{constructor(e,t,s,a){this.from=e,this.to=t,this.value=s,this.maxPoint=a}get length(){return this.to[this.to.length-1]}findIndex(e,t,s,a=0){let r=s?this.to:this.from;for(let o=a,i=r.length;;){if(o==i)return o;let l=o+i>>1,c=r[l]-e||(s?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return c>=0?o:i;c>=0?i=l:o=l+1}}between(e,t,s,a){for(let r=this.findIndex(t,-1e9,!0),o=this.findIndex(s,1e9,!1,r);r<o;r++)if(a(this.from[r]+e,this.to[r]+e,this.value[r])===!1)return!1}map(e,t){let s=[],a=[],r=[],o=-1,i=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+e,h=this.to[l]+e,m,f;if(u==h){let v=t.mapPos(u,c.startSide,c.mapMode);if(v==null||(m=f=v,c.startSide!=c.endSide&&(f=t.mapPos(u,c.endSide),f<m)))continue}else if(m=t.mapPos(u,c.startSide),f=t.mapPos(h,c.endSide),m>f||m==f&&c.startSide>0&&c.endSide<=0)continue;(f-m||c.endSide-c.startSide)<0||(o<0&&(o=m),c.point&&(i=Math.max(i,f-m)),s.push(c),a.push(m-o),r.push(f-o))}return{mapped:s.length?new gM(a,r,s,i):null,pos:o}}}class ss{constructor(e,t,s,a){this.chunkPos=e,this.chunk=t,this.nextLayer=s,this.maxPoint=a}static create(e,t,s,a){return new ss(e,t,s,a)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:s=!1,filterFrom:a=0,filterTo:r=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(s&&(t=t.slice().sort(FP)),this.isEmpty)return t.length?ss.of(t):this;let i=new gB(this,null,-1).goto(0),l=0,c=[],u=new Hi;for(;i.value||l<t.length;)if(l<t.length&&(i.from-t[l].from||i.startSide-t[l].value.startSide)>=0){let h=t[l++];u.addInner(h.from,h.to,h.value)||c.push(h)}else i.rangeIndex==1&&i.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(i.chunkIndex)<t[l].from)&&(!o||a>this.chunkEnd(i.chunkIndex)||r<this.chunkPos[i.chunkIndex])&&u.addChunk(this.chunkPos[i.chunkIndex],this.chunk[i.chunkIndex])?i.nextChunk():((!o||a>i.to||r<i.from||o(i.from,i.to,i.value))&&(u.addInner(i.from,i.to,i.value)||c.push(TP.create(i.from,i.to,i.value))),i.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?ss.empty:this.nextLayer.update({add:c,filter:o,filterFrom:a,filterTo:r}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],s=[],a=-1;for(let o=0;o<this.chunk.length;o++){let i=this.chunkPos[o],l=this.chunk[o],c=e.touchesRange(i,i+l.length);if(c===!1)a=Math.max(a,l.maxPoint),t.push(l),s.push(e.mapPos(i));else if(c===!0){let{mapped:u,pos:h}=l.map(i,e);u&&(a=Math.max(a,u.maxPoint),t.push(u),s.push(h))}}let r=this.nextLayer.map(e);return t.length==0?r:new ss(s,t,r||ss.empty,a)}between(e,t,s){if(!this.isEmpty){for(let a=0;a<this.chunk.length;a++){let r=this.chunkPos[a],o=this.chunk[a];if(t>=r&&e<=r+o.length&&o.between(r,e-r,t-r,s)===!1)return}this.nextLayer.between(e,t,s)}}iter(e=0){return _f.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return _f.from(e).goto(t)}static compare(e,t,s,a,r=-1){let o=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=r),i=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=r),l=AE(o,i,s),c=new mp(o,l,r),u=new mp(i,l,r);s.iterGaps((h,m,f)=>EE(c,h,u,m,f,a)),s.empty&&s.length==0&&EE(c,0,u,0,0,a)}static eq(e,t,s=0,a){a==null&&(a=999999999);let r=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0),o=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let i=AE(r,o),l=new mp(r,i,0).goto(s),c=new mp(o,i,0).goto(s);for(;;){if(l.to!=c.to||!NP(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>a)return!0;l.next(),c.next()}}static spans(e,t,s,a,r=-1){let o=new mp(e,null,r).goto(t),i=t,l=o.openStart;for(;;){let c=Math.min(o.to,s);if(o.point){let u=o.activeForPoint(o.to),h=o.pointFrom<t?u.length+1:o.point.startSide<0?u.length:Math.min(u.length,l);a.point(i,c,o.point,u,h,o.pointRank),l=Math.min(o.openEnd(c),u.length)}else c>i&&(a.span(i,c,o.active,l),l=o.openEnd(c));if(o.to>s)return l+(o.point&&o.to>s?1:0);i=o.to,o.next()}}static of(e,t=!1){let s=new Hi;for(let a of e instanceof TP?[e]:t?_re(e):e)s.add(a.from,a.to,a.value);return s.finish()}static join(e){if(!e.length)return ss.empty;let t=e[e.length-1];for(let s=e.length-2;s>=0;s--)for(let a=e[s];a!=ss.empty;a=a.nextLayer)t=new ss(a.chunkPos,a.chunk,t,Math.max(a.maxPoint,t.maxPoint));return t}}ss.empty=new ss([],[],null,-1);function _re(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let s=n[t];if(FP(e,s)>0)return n.slice().sort(FP);e=s}return n}ss.empty.nextLayer=ss.empty;class Hi{finishChunk(e){this.chunks.push(new gM(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,s){this.addInner(e,t,s)||(this.nextLayer||(this.nextLayer=new Hi)).add(e,t,s)}addInner(e,t,s){let a=e-this.lastTo||s.startSide-this.last.endSide;if(a<=0&&(e-this.lastFrom||s.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return a<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=s,this.lastFrom=e,this.lastTo=t,this.value.push(s),s.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let s=t.value.length-1;return this.last=t.value[s],this.lastFrom=t.from[s]+e,this.lastTo=t.to[s]+e,!0}finish(){return this.finishInner(ss.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=ss.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function AE(n,e,t){let s=new Map;for(let r of n)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&s.set(r.chunk[o],r.chunkPos[o]);let a=new Set;for(let r of e)for(let o=0;o<r.chunk.length;o++){let i=s.get(r.chunk[o]);i!=null&&(t?t.mapPos(i):i)==r.chunkPos[o]&&!(t!=null&&t.touchesRange(i,i+r.chunk[o].length))&&a.add(r.chunk[o])}return a}class gB{constructor(e,t,s,a=0){this.layer=e,this.skip=t,this.minPoint=s,this.rank=a}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,s){for(;this.chunkIndex<this.layer.chunk.length;){let a=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(a)||this.layer.chunkEnd(this.chunkIndex)<e||a.maxPoint<this.minPoint))break;this.chunkIndex++,s=!1}if(this.chunkIndex<this.layer.chunk.length){let a=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!s||this.rangeIndex<a)&&this.setRangeIndex(a)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],s=e+t.from[this.rangeIndex];if(this.from=s,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class _f{constructor(e){this.heap=e}static from(e,t=null,s=-1){let a=[];for(let r=0;r<e.length;r++)for(let o=e[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=s&&a.push(new gB(o,t,s,r));return a.length==1?a[0]:new _f(a)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let s of this.heap)s.goto(e,t);for(let s=this.heap.length>>1;s>=0;s--)TO(this.heap,s);return this.next(),this}forward(e,t){for(let s of this.heap)s.forward(e,t);for(let s=this.heap.length>>1;s>=0;s--)TO(this.heap,s);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),TO(this.heap,0)}}}function TO(n,e){for(let t=n[e];;){let s=(e<<1)+1;if(s>=n.length)break;let a=n[s];if(s+1<n.length&&a.compare(n[s+1])>=0&&(a=n[s+1],s++),t.compare(a)<0)break;n[s]=t,n[e]=a,e=s}}class mp{constructor(e,t,s){this.minPoint=s,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=_f.from(e,t,s)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){y0(this.active,e),y0(this.activeTo,e),y0(this.activeRank,e),this.minActive=DE(this.active,this.activeTo)}addActive(e){let t=0,{value:s,to:a,rank:r}=this.cursor;for(;t<this.activeRank.length&&(r-this.activeRank[t]||a-this.activeTo[t])>0;)t++;v0(this.active,t,s),v0(this.activeTo,t,a),v0(this.activeRank,t,r),e&&v0(e,t,this.cursor.from),this.minActive=DE(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let s=this.openStart<0?[]:null;for(;;){let a=this.minActive;if(a>-1&&(this.activeTo[a]-this.cursor.from||this.active[a].endSide-this.cursor.startSide)<0){if(this.activeTo[a]>e){this.to=this.activeTo[a],this.endSide=this.active[a].endSide;break}this.removeActive(a),s&&y0(s,a)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(s),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(s){this.openStart=0;for(let a=s.length-1;a>=0&&s[a]<e;a--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let s=this.active.length-1;s>=0&&!(this.activeRank[s]<this.pointRank);s--)(this.activeTo[s]>e||this.activeTo[s]==e&&this.active[s].endSide>=this.point.endSide)&&t.push(this.active[s]);return t.reverse()}openEnd(e){let t=0;for(let s=this.activeTo.length-1;s>=0&&this.activeTo[s]>e;s--)t++;return t}}function EE(n,e,t,s,a,r){n.goto(e),t.goto(s);let o=s+a,i=s,l=s-e;for(;;){let c=n.to+l-t.to,u=c||n.endSide-t.endSide,h=u<0?n.to+l:t.to,m=Math.min(h,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&NP(n.activeForPoint(n.to),t.activeForPoint(t.to))||r.comparePoint(i,m,n.point,t.point):m>i&&!NP(n.active,t.active)&&r.compareRange(i,m,n.active,t.active),h>o)break;(c||n.openEnd!=t.openEnd)&&r.boundChange&&r.boundChange(h),i=h,u<=0&&n.next(),u>=0&&t.next()}}function NP(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function y0(n,e){for(let t=e,s=n.length-1;t<s;t++)n[t]=n[t+1];n.pop()}function v0(n,e,t){for(let s=n.length-1;s>=e;s--)n[s+1]=n[s];n[e]=t}function DE(n,e){let t=-1,s=1e9;for(let a=0;a<e.length;a++)(e[a]-s||n[a].endSide-n[t].endSide)<0&&(t=a,s=e[a]);return t}function Bm(n,e,t=n.length){let s=0;for(let a=0;a<t&&a<n.length;)n.charCodeAt(a)==9?(s+=e-s%e,a++):(s++,a=Ha(n,a));return s}function BP(n,e,t,s){for(let a=0,r=0;;){if(r>=e)return a;if(a==n.length)break;r+=n.charCodeAt(a)==9?t-r%t:1,a=Ha(n,a)}return s===!0?-1:n.length}const $P="ͼ",TE=typeof Symbol>"u"?"__"+$P:Symbol.for($P),RP=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),FE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class ku{constructor(e,t){this.rules=[];let{finish:s}=t||{};function a(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function r(o,i,l,c){let u=[],h=/^@(\w+)\b/.exec(o[0]),m=h&&h[1]=="keyframes";if(h&&i==null)return l.push(o[0]+";");for(let f in i){let v=i[f];if(/&/.test(f))r(f.split(/,\s*/).map(O=>o.map(k=>O.replace(/&/,k))).reduce((O,k)=>O.concat(k)),v,l);else if(v&&typeof v=="object"){if(!h)throw new RangeError("The value of a property ("+f+") should be a primitive value.");r(a(f),v,u,m)}else v!=null&&u.push(f.replace(/_.*/,"").replace(/[A-Z]/g,O=>"-"+O.toLowerCase())+": "+v+";")}(u.length||m)&&l.push((s&&!h&&!c?o.map(s):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)r(a(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=FE[TE]||1;return FE[TE]=e+1,$P+e.toString(36)}static mount(e,t,s){let a=e[RP],r=s&&s.nonce;a?r&&a.setNonce(r):a=new Lre(e,r),a.mount(Array.isArray(t)?t:[t],e)}}let NE=new Map;class Lre{constructor(e,t){let s=e.ownerDocument||e,a=s.defaultView;if(!e.head&&e.adoptedStyleSheets&&a.CSSStyleSheet){let r=NE.get(s);if(r)return e[RP]=r;this.sheet=new a.CSSStyleSheet,NE.set(s,this)}else this.styleTag=s.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[RP]=this}mount(e,t){let s=this.sheet,a=0,r=0;for(let o=0;o<e.length;o++){let i=e[o],l=this.modules.indexOf(i);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,i),s)for(let c=0;c<i.rules.length;c++)s.insertRule(i.rules[c],a++)}else{for(;r<l;)a+=this.modules[r++].rules.length;a+=i.rules.length,r++}}if(s)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let i=t.head||t;this.styleTag.parentNode!=i&&i.insertBefore(this.styleTag,i.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Pu={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Lf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ire=typeof navigator<"u"&&/Mac/.test(navigator.platform),Qre=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var qa=0;qa<10;qa++)Pu[48+qa]=Pu[96+qa]=String(qa);for(var qa=1;qa<=24;qa++)Pu[qa+111]="F"+qa;for(var qa=65;qa<=90;qa++)Pu[qa]=String.fromCharCode(qa+32),Lf[qa]=String.fromCharCode(qa);for(var FO in Pu)Lf.hasOwnProperty(FO)||(Lf[FO]=Pu[FO]);function Vre(n){var e=Ire&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Qre&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Lf:Pu)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Ss(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=t[s];typeof a=="string"?n.setAttribute(s,a):a!=null&&(n[s]=a)}e++}for(;e<arguments.length;e++)bB(n,arguments[e]);return n}function bB(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)bB(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let kr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},_P=typeof document<"u"?document:{documentElement:{style:{}}};const LP=/Edge\/(\d+)/.exec(kr.userAgent),yB=/MSIE \d/.test(kr.userAgent),IP=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(kr.userAgent),Wv=!!(yB||IP||LP),BE=!Wv&&/gecko\/(\d+)/i.test(kr.userAgent),NO=!Wv&&/Chrome\/(\d+)/.exec(kr.userAgent),jre="webkitFontSmoothing"in _P.documentElement.style,QP=!Wv&&/Apple Computer/.test(kr.vendor),$E=QP&&(/Mobile\/\w+/.test(kr.userAgent)||kr.maxTouchPoints>2);var At={mac:$E||/Mac/.test(kr.platform),windows:/Win/.test(kr.platform),linux:/Linux|X11/.test(kr.platform),ie:Wv,ie_version:yB?_P.documentMode||6:IP?+IP[1]:LP?+LP[1]:0,gecko:BE,gecko_version:BE?+(/Firefox\/(\d+)/.exec(kr.userAgent)||[0,0])[1]:0,chrome:!!NO,chrome_version:NO?+NO[1]:0,ios:$E,android:/Android\b/.test(kr.userAgent),webkit_version:jre?+(/\bAppleWebKit\/(\d+)/.exec(kr.userAgent)||[0,0])[1]:0,safari:QP,safari_version:QP?+(/\bVersion\/(\d+(\.\d+)?)/.exec(kr.userAgent)||[0,0])[1]:0,tabSize:_P.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function If(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function VP(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function Zb(n,e){if(!e.anchorNode)return!1;try{return VP(n,e.anchorNode)}catch{return!1}}function Qf(n){return n.nodeType==3?Lh(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function gf(n,e,t,s){return t?RE(n,e,t,s,-1)||RE(n,e,t,s,1):!1}function _h(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function $1(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function RE(n,e,t,s,a){for(;;){if(n==t&&e==s)return!0;if(e==(a<0?0:Zl(n))){if(n.nodeName=="DIV")return!1;let r=n.parentNode;if(!r||r.nodeType!=1)return!1;e=_h(n)+(a<0?0:1),n=r}else if(n.nodeType==1){if(n=n.childNodes[e+(a<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=a<0?Zl(n):0}else return!1}}function Zl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function qv(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function Zre(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function vB(n,e){let t=e.width/n.offsetWidth,s=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(s>.995&&s<1.005||!isFinite(s)||Math.abs(e.height-n.offsetHeight)<1)&&(s=1),{scaleX:t,scaleY:s}}function zre(n,e,t,s,a,r,o,i){let l=n.ownerDocument,c=l.defaultView||window;for(let u=n,h=!1;u&&!h;)if(u.nodeType==1){let m,f=u==l.body,v=1,O=1;if(f)m=Zre(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(h=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let E=u.getBoundingClientRect();({scaleX:v,scaleY:O}=vB(u,E)),m={left:E.left,right:E.left+u.clientWidth*v,top:E.top,bottom:E.top+u.clientHeight*O}}let k=0,M=0;if(a=="nearest")e.top<m.top?(M=e.top-(m.top+o),t>0&&e.bottom>m.bottom+M&&(M=e.bottom-m.bottom+o)):e.bottom>m.bottom&&(M=e.bottom-m.bottom+o,t<0&&e.top-M<m.top&&(M=e.top-(m.top+o)));else{let E=e.bottom-e.top,I=m.bottom-m.top;M=(a=="center"&&E<=I?e.top+E/2-I/2:a=="start"||a=="center"&&t<0?e.top-o:e.bottom-I+o)-m.top}if(s=="nearest"?e.left<m.left?(k=e.left-(m.left+r),t>0&&e.right>m.right+k&&(k=e.right-m.right+r)):e.right>m.right&&(k=e.right-m.right+r,t<0&&e.left<m.left+k&&(k=e.left-(m.left+r))):k=(s=="center"?e.left+(e.right-e.left)/2-(m.right-m.left)/2:s=="start"==i?e.left-r:e.right-(m.right-m.left)+r)-m.left,k||M)if(f)c.scrollBy(k,M);else{let E=0,I=0;if(M){let D=u.scrollTop;u.scrollTop+=M/O,I=(u.scrollTop-D)*O}if(k){let D=u.scrollLeft;u.scrollLeft+=k/v,E=(u.scrollLeft-D)*v}e={left:e.left-E,top:e.top-I,right:e.right-E,bottom:e.bottom-I},E&&Math.abs(E-k)<1&&(s="nearest"),I&&Math.abs(I-M)<1&&(a="nearest")}if(f)break;(e.top<m.top||e.bottom>m.bottom||e.left<m.left||e.right>m.right)&&(e={left:Math.max(e.left,m.left),right:Math.min(e.right,m.right),top:Math.max(e.top,m.top),bottom:Math.min(e.bottom,m.bottom)}),u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function Gre(n){let e=n.ownerDocument,t,s;for(let a=n.parentNode;a&&!(a==e.body||t&&s);)if(a.nodeType==1)!s&&a.scrollHeight>a.clientHeight&&(s=a),!t&&a.scrollWidth>a.clientWidth&&(t=a),a=a.assignedSlot||a.parentNode;else if(a.nodeType==11)a=a.host;else break;return{x:t,y:s}}class Xre{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:s}=e;this.set(t,Math.min(e.anchorOffset,t?Zl(t):0),s,Math.min(e.focusOffset,s?Zl(s):0))}set(e,t,s,a){this.anchorNode=e,this.anchorOffset=t,this.focusNode=s,this.focusOffset=a}}let nh=null;At.safari&&At.safari_version>=26&&(nh=!1);function wB(n){if(n.setActive)return n.setActive();if(nh)return n.focus(nh);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(nh==null?{get preventScroll(){return nh={preventScroll:!0},!0}}:void 0),!nh){nh=!1;for(let t=0;t<e.length;){let s=e[t++],a=e[t++],r=e[t++];s.scrollTop!=a&&(s.scrollTop=a),s.scrollLeft!=r&&(s.scrollLeft=r)}}}let _E;function Lh(n,e,t=e){let s=_E||(_E=document.createRange());return s.setEnd(n,t),s.setStart(n,e),s}function Dd(n,e,t,s){let a={key:e,code:e,keyCode:t,which:t,cancelable:!0};s&&({altKey:a.altKey,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,metaKey:a.metaKey}=s);let r=new KeyboardEvent("keydown",a);r.synthetic=!0,n.dispatchEvent(r);let o=new KeyboardEvent("keyup",a);return o.synthetic=!0,n.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function Wre(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function OB(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function qre(n,e){let t=e.focusNode,s=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=s)return!1;for(s=Math.min(s,Zl(t));;)if(s){if(t.nodeType!=1)return!1;let a=t.childNodes[s-1];a.contentEditable=="false"?s--:(t=a,s=Zl(t))}else{if(t==n)return!0;s=_h(t),t=t.parentNode}}function xB(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function kB(n,e){for(let t=n,s=e;;){if(t.nodeType==3&&s>0)return{node:t,offset:s};if(t.nodeType==1&&s>0){if(t.contentEditable=="false")return null;t=t.childNodes[s-1],s=Zl(t)}else if(t.parentNode&&!$1(t))s=_h(t),t=t.parentNode;else return null}}function PB(n,e){for(let t=n,s=e;;){if(t.nodeType==3&&s<t.nodeValue.length)return{node:t,offset:s};if(t.nodeType==1&&s<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[s],s=0}else if(t.parentNode&&!$1(t))s=_h(t)+1,t=t.parentNode;else return null}}class cr{constructor(e,t,s=!0){this.node=e,this.offset=t,this.precise=s}static before(e,t){return new cr(e.parentNode,_h(e),t)}static after(e,t){return new cr(e.parentNode,_h(e)+1,t)}}const bM=[];class ks{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let s of this.children){if(s==e)return t;t+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let s=this.dom,a=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=a?a.nextSibling:s.firstChild)){let i=ks.get(r);(!i||!i.parent&&i.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(e,t),o.flags&=-8}if(r=a?a.nextSibling:s.firstChild,t&&!t.written&&t.node==s&&r!=o.dom&&(t.written=!0),o.dom.parentNode==s)for(;r&&r!=o.dom;)r=LE(r);else s.insertBefore(o.dom,r);a=o.dom}for(r=a?a.nextSibling:s.firstChild,r&&t&&t.node==s&&(t.written=!0);r;)r=LE(r)}else if(this.flags&1)for(let s of this.children)s.flags&7&&(s.sync(e,t),s.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let s;if(e==this.dom)s=this.dom.childNodes[t];else{let a=Zl(e)==0?0:t==0?-1:1;for(;;){let r=e.parentNode;if(r==this.dom)break;a==0&&r.firstChild!=r.lastChild&&(e==r.firstChild?a=-1:a=1),e=r}a<0?s=e:s=e.nextSibling}if(s==this.dom.firstChild)return 0;for(;s&&!ks.get(s);)s=s.nextSibling;if(!s)return this.length;for(let a=0,r=0;;a++){let o=this.children[a];if(o.dom==s)return r;r+=o.length+o.breakAfter}}domBoundsAround(e,t,s=0){let a=-1,r=-1,o=-1,i=-1;for(let l=0,c=s,u=s;l<this.children.length;l++){let h=this.children[l],m=c+h.length;if(c<e&&m>t)return h.domBoundsAround(e,t,c);if(m>=e&&a==-1&&(a=l,r=c),c>t&&h.dom.parentNode==this.dom){o=l,i=u;break}u=m,c=m+h.breakAfter}return{from:r,to:i<0?s+this.length:i,startDOM:(a?this.children[a-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,s=bM){this.markDirty();for(let a=e;a<t;a++){let r=this.children[a];r.parent==this&&s.indexOf(r)<0&&r.destroy()}s.length<250?this.children.splice(e,t-e,...s):this.children=[].concat(this.children.slice(0,e),s,this.children.slice(t));for(let a=0;a<s.length;a++)s[a].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new SB(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,s,a,r,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}ks.prototype.breakAfter=0;function LE(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class SB{constructor(e,t,s){this.children=e,this.pos=t,this.i=s,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let s=this.children[--this.i];this.pos-=s.length+s.breakAfter}}}function CB(n,e,t,s,a,r,o,i,l){let{children:c}=n,u=c.length?c[e]:null,h=r.length?r[r.length-1]:null,m=h?h.breakAfter:o;if(!(e==s&&u&&!o&&!m&&r.length<2&&u.merge(t,a,r.length?h:null,t==0,i,l))){if(s<c.length){let f=c[s];f&&(a<f.length||f.breakAfter&&(h!=null&&h.breakAfter))?(e==s&&(f=f.split(a),a=0),!m&&h&&f.merge(0,a,h,!0,0,l)?r[r.length-1]=f:((a||f.children.length&&!f.children[0].length)&&f.merge(0,a,null,!1,0,l),r.push(f))):f!=null&&f.breakAfter&&(h?h.breakAfter=1:o=1),s++}for(u&&(u.breakAfter=o,t>0&&(!o&&r.length&&u.merge(t,u.length,r[0],!1,i,0)?u.breakAfter=r.shift().breakAfter:(t<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(t,u.length,null,!1,i,0),e++));e<s&&r.length;)if(c[s-1].become(r[r.length-1]))s--,r.pop(),l=r.length?0:i;else if(c[e].become(r[0]))e++,r.shift(),i=r.length?0:l;else break;!r.length&&e&&s<c.length&&!c[e-1].breakAfter&&c[s].merge(0,0,c[e-1],!1,i,l)&&e--,(e<s||r.length)&&n.replaceChildren(e,s,r)}}function MB(n,e,t,s,a,r){let o=n.childCursor(),{i,off:l}=o.findPos(t,1),{i:c,off:u}=o.findPos(e,-1),h=e-t;for(let m of s)h+=m.length;n.length+=h,CB(n,c,u,i,l,s,0,a,r)}const Ure=256;class Yi extends ks{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,s){return this.flags&8||s&&(!(s instanceof Yi)||this.length-(t-e)+s.length>Ure||s.flags&8)?!1:(this.text=this.text.slice(0,e)+(s?s.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Yi(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new cr(this.dom,e)}domBoundsAround(e,t,s){return{from:s,to:s+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return Hre(this.dom,e,t)}}class Dc extends ks{constructor(e,t=[],s=0){super(),this.mark=e,this.children=t,this.length=s;for(let a of t)a.setParent(this)}setAttrs(e){if(OB(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,s,a,r,o){return s&&(!(s instanceof Dc&&s.mark.eq(this.mark))||e&&r<=0||t<this.length&&o<=0)?!1:(MB(this,e,t,s?s.children.slice():[],r-1,o-1),this.markDirty(),!0)}split(e){let t=[],s=0,a=-1,r=0;for(let i of this.children){let l=s+i.length;l>e&&t.push(s<e?i.split(e-s):i),a<0&&s>=e&&(a=r),s=l,r++}let o=this.length-e;return this.length=e,a>-1&&(this.children.length=a,this.markDirty()),new Dc(this.mark,t,o)}domAtPos(e){return AB(this,e)}coordsAt(e,t){return DB(this,e,t)}}function Hre(n,e,t){let s=n.nodeValue.length;e>s&&(e=s);let a=e,r=e,o=0;e==0&&t<0||e==s&&t>=0?At.chrome||At.gecko||(e?(a--,o=1):r<s&&(r++,o=-1)):t<0?a--:r<s&&r++;let i=Lh(n,a,r).getClientRects();if(!i.length)return null;let l=i[(o?o<0:t>=0)?0:i.length-1];return At.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(i,c=>c.width)||l),o?qv(l,o<0):l||null}class au extends ks{static create(e,t,s){return new au(e,t,s)}constructor(e,t,s){super(),this.widget=e,this.length=t,this.side=s,this.prevWidget=null}split(e){let t=au.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,s,a,r,o){return s&&(!(s instanceof au)||!this.widget.compare(s.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-t),!0)}become(e){return e instanceof au&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return rs.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,s=t&&t.state.doc,a=this.posAtStart;return s?s.slice(a,a+this.length):rs.empty}domAtPos(e){return(this.length?e==0:this.side>0)?cr.before(this.dom):cr.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let s=this.widget.coordsAt(this.dom,e,t);if(s)return s;let a=this.dom.getClientRects(),r=null;if(!a.length)return null;let o=this.side?this.side<0:e>0;for(let i=o?a.length-1:0;r=a[i],!(e>0?i==0:i==a.length-1||r.top<r.bottom);i+=o?-1:1);return qv(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class sm extends ks{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof sm&&e.side==this.side}split(){return new sm(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?cr.before(this.dom):cr.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return rs.empty}get isHidden(){return!0}}Yi.prototype.children=au.prototype.children=sm.prototype.children=bM;function AB(n,e){let t=n.dom,{children:s}=n,a=0;for(let r=0;a<s.length;a++){let o=s[a],i=r+o.length;if(!(i==r&&o.getSide()<=0)){if(e>r&&e<i&&o.dom.parentNode==t)return o.domAtPos(e-r);if(e<=r)break;r=i}}for(let r=a;r>0;r--){let o=s[r-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let r=a;r<s.length;r++){let o=s[r];if(o.dom.parentNode==t)return o.domAtPos(0)}return new cr(t,0)}function EB(n,e,t){let s,{children:a}=n;t>0&&e instanceof Dc&&a.length&&(s=a[a.length-1])instanceof Dc&&s.mark.eq(e.mark)?EB(s,e.children[0],t-1):(a.push(e),e.setParent(n)),n.length+=e.length}function DB(n,e,t){let s=null,a=-1,r=null,o=-1;function i(c,u){for(let h=0,m=0;h<c.children.length&&m<=u;h++){let f=c.children[h],v=m+f.length;v>=u&&(f.children.length?i(f,u-m):(!r||r.isHidden&&(t>0||Kre(r,f)))&&(v>u||m==v&&f.getSide()>0)?(r=f,o=u-m):(m<u||m==v&&f.getSide()<0&&!f.isHidden)&&(s=f,a=u-m)),m=v}}i(n,e);let l=(t<0?s:r)||s||r;return l?l.coordsAt(Math.max(0,l==s?a:o),t):Yre(n)}function Yre(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=Qf(e);return t[t.length-1]||null}function Kre(n,e){let t=n.coordsAt(0,1),s=e.coordsAt(0,1);return t&&s&&s.top<t.bottom}function jP(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const IE=Object.create(null);function R1(n,e,t){if(n==e)return!0;n||(n=IE),e||(e=IE);let s=Object.keys(n),a=Object.keys(e);if(s.length-(t&&s.indexOf(t)>-1?1:0)!=a.length-(t&&a.indexOf(t)>-1?1:0))return!1;for(let r of s)if(r!=t&&(a.indexOf(r)==-1||n[r]!==e[r]))return!1;return!0}function ZP(n,e,t){let s=!1;if(e)for(let a in e)t&&a in t||(s=!0,a=="style"?n.style.cssText="":n.removeAttribute(a));if(t)for(let a in t)e&&e[a]==t[a]||(s=!0,a=="style"?n.style.cssText=t[a]:n.setAttribute(a,t[a]));return s}function Jre(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let s=n.attributes[t];e[s.name]=s.value}return e}class ol{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,s){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Ar=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(Ar||(Ar={}));class Et extends Rh{constructor(e,t,s,a){super(),this.startSide=e,this.endSide=t,this.widget=s,this.spec=a}get heightRelevant(){return!1}static mark(e){return new $g(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),s=!!e.block;return t+=s&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Su(e,t,t,s,e.widget||null,!1)}static replace(e){let t=!!e.block,s,a;if(e.isBlockGap)s=-5e8,a=4e8;else{let{start:r,end:o}=TB(e,t);s=(r?t?-3e8:-1:5e8)-1,a=(o?t?2e8:1:-6e8)+1}return new Su(e,s,a,t,e.widget||null,!0)}static line(e){return new Rg(e)}static set(e,t=!1){return ss.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Et.none=ss.empty;class $g extends Et{constructor(e){let{start:t,end:s}=TB(e);super(t?-1:5e8,s?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,s;return this==e||e instanceof $g&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((s=e.attrs)===null||s===void 0?void 0:s.class))&&R1(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}$g.prototype.point=!1;class Rg extends Et{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Rg&&this.spec.class==e.spec.class&&R1(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Rg.prototype.mapMode=fa.TrackBefore;Rg.prototype.point=!0;class Su extends Et{constructor(e,t,s,a,r,o){super(t,s,r,e),this.block=a,this.isReplace=o,this.mapMode=a?t<=0?fa.TrackBefore:fa.TrackAfter:fa.TrackDel}get type(){return this.startSide!=this.endSide?Ar.WidgetRange:this.startSide<=0?Ar.WidgetBefore:Ar.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Su&&eoe(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Su.prototype.point=!0;function TB(n,e=!1){let{inclusiveStart:t,inclusiveEnd:s}=n;return t==null&&(t=n.inclusive),s==null&&(s=n.inclusive),{start:t??e,end:s??e}}function eoe(n,e){return n==e||!!(n&&e&&n.compare(e))}function zb(n,e,t,s=0){let a=t.length-1;a>=0&&t[a]+s>=n?t[a]=Math.max(t[a],e):t.push(n,e)}class ma extends ks{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,s,a,r,o){if(s){if(!(s instanceof ma))return!1;this.dom||s.transferDOM(this)}return a&&this.setDeco(s?s.attrs:null),MB(this,e,t,s?s.children.slice():[],r,o),!0}split(e){let t=new ma;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:s,off:a}=this.childPos(e);a&&(t.append(this.children[s].split(a),0),this.children[s].merge(a,this.children[s].length,null,!1,0,0),s++);for(let r=s;r<this.children.length;r++)t.append(this.children[r],0);for(;s>0&&this.children[s-1].length==0;)this.children[--s].destroy();return this.children.length=s,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){R1(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){EB(this,e,t)}addLineDeco(e){let t=e.spec.attributes,s=e.spec.class;t&&(this.attrs=jP(t,this.attrs||{})),s&&(this.attrs=jP({class:s},this.attrs||{}))}domAtPos(e){return AB(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var s;this.dom?this.flags&4&&(OB(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(ZP(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let a=this.dom.lastChild;for(;a&&ks.get(a)instanceof Dc;)a=a.lastChild;if(!a||!this.length||a.nodeName!="BR"&&((s=ks.get(a))===null||s===void 0?void 0:s.isEditable)==!1&&(!At.ios||!this.children.some(r=>r instanceof Yi))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let s of this.children){if(!(s instanceof Yi)||/[^ -~]/.test(s.text))return null;let a=Qf(s.dom);if(a.length!=1)return null;e+=a[0].width,t=a[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let s=DB(this,e,t);if(!this.children.length&&s&&this.parent){let{heightOracle:a}=this.parent.view.viewState,r=s.bottom-s.top;if(Math.abs(r-a.lineHeight)<2&&a.textHeight<r){let o=(r-a.textHeight)/2;return{top:s.top+o,bottom:s.bottom-o,left:s.left,right:s.left}}}return s}become(e){return e instanceof ma&&this.children.length==0&&e.children.length==0&&R1(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let s=0,a=0;s<e.children.length;s++){let r=e.children[s],o=a+r.length;if(o>=t){if(r instanceof ma)return r;if(o>t)break}a=o+r.breakAfter}return null}}class Mc extends ks{constructor(e,t,s){super(),this.widget=e,this.length=t,this.deco=s,this.breakAfter=0,this.prevWidget=null}merge(e,t,s,a,r,o){return s&&(!(s instanceof Mc)||!this.widget.compare(s.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?cr.before(this.dom):cr.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let s=new Mc(this.widget,t,this.deco);return s.breakAfter=this.breakAfter,s}get children(){return bM}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):rs.empty}domBoundsAround(){return null}become(e){return e instanceof Mc&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let s=this.widget.coordsAt(this.dom,e,t);return s||(this.widget instanceof zP?null:qv(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:s}=this.deco;return t==s?!1:e<0?t<0:s>0}}class zP extends ol{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class bf{constructor(e,t,s,a){this.doc=e,this.pos=t,this.end=s,this.disallowBlockEffectsFor=a,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Mc&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new ma),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(w0(new sm(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Mc)&&this.getLine()}buildText(e,t,s){for(;e>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:i,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=o,this.textOff=0}let a=Math.min(this.text.length-this.textOff,e),r=Math.min(a,512);this.flushBuffer(t.slice(t.length-s)),this.getLine().append(w0(new Yi(this.text.slice(this.textOff,this.textOff+r)),t),s),this.atCursorPos=!0,this.textOff+=r,e-=r,s=a<=r?0:t.length}}span(e,t,s,a){this.buildText(t-e,s,a),this.pos=t,this.openStart<0&&(this.openStart=a)}point(e,t,s,a,r,o){if(this.disallowBlockEffectsFor[o]&&s instanceof Su){if(s.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let i=t-e;if(s instanceof Su)if(s.block)s.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Mc(s.widget||am.block,i,s));else{let l=au.create(s.widget||am.inline,i,i?0:s.startSide),c=this.atCursorPos&&!l.isEditable&&r<=a.length&&(e<t||s.startSide>0),u=!l.isEditable&&(e<t||r>a.length||s.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(a),c&&(h.append(w0(new sm(1),a),r),r=a.length+Math.max(0,r-a.length)),h.append(w0(l,a),r),this.atCursorPos=u,this.pendingBuffer=u?e<t||r>a.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=a.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(s);i&&(this.textOff+i<=this.text.length?this.textOff+=i:(this.skip+=i-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=r)}static build(e,t,s,a,r){let o=new bf(e,t,s,r);return o.openEnd=ss.spans(a,t,s,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function w0(n,e){for(let t of e)n=new Dc(t,[n],n.length);return n}class am extends ol{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}am.inline=new am("span");am.block=new am("div");var Es=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(Es||(Es={}));const Ih=Es.LTR,yM=Es.RTL;function FB(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const toe=FB("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),noe=FB("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),GP=Object.create(null),dl=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);GP[e]=t,GP[t]=-e}function NB(n){return n<=247?toe[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?noe[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const soe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ru{get dir(){return this.level%2?yM:Ih}constructor(e,t,s){this.from=e,this.to=t,this.level=s}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,s,a){let r=-1;for(let o=0;o<e.length;o++){let i=e[o];if(i.from<=t&&i.to>=t){if(i.level==s)return o;(r<0||(a!=0?a<0?i.from<t:i.to>t:e[r].level>i.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}function BB(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let s=n[t],a=e[t];if(s.from!=a.from||s.to!=a.to||s.direction!=a.direction||!BB(s.inner,a.inner))return!1}return!0}const Cs=[];function aoe(n,e,t,s,a){for(let r=0;r<=s.length;r++){let o=r?s[r-1].to:e,i=r<s.length?s[r].from:t,l=r?256:a;for(let c=o,u=l,h=l;c<i;c++){let m=NB(n.charCodeAt(c));m==512?m=u:m==8&&h==4&&(m=16),Cs[c]=m==4?2:m,m&7&&(h=m),u=m}for(let c=o,u=l,h=l;c<i;c++){let m=Cs[c];if(m==128)c<i-1&&u==Cs[c+1]&&u&24?m=Cs[c]=u:Cs[c]=256;else if(m==64){let f=c+1;for(;f<i&&Cs[f]==64;)f++;let v=c&&u==8||f<t&&Cs[f]==8?h==1?1:8:256;for(let O=c;O<f;O++)Cs[O]=v;c=f-1}else m==8&&h==1&&(Cs[c]=1);u=m,m&7&&(h=m)}}}function roe(n,e,t,s,a){let r=a==1?2:1;for(let o=0,i=0,l=0;o<=s.length;o++){let c=o?s[o-1].to:e,u=o<s.length?s[o].from:t;for(let h=c,m,f,v;h<u;h++)if(f=GP[m=n.charCodeAt(h)])if(f<0){for(let O=i-3;O>=0;O-=3)if(dl[O+1]==-f){let k=dl[O+2],M=k&2?a:k&4?k&1?r:a:0;M&&(Cs[h]=Cs[dl[O]]=M),i=O;break}}else{if(dl.length==189)break;dl[i++]=h,dl[i++]=m,dl[i++]=l}else if((v=Cs[h])==2||v==1){let O=v==a;l=O?0:1;for(let k=i-3;k>=0;k-=3){let M=dl[k+2];if(M&2)break;if(O)dl[k+2]|=2;else{if(M&4)break;dl[k+2]|=4}}}}}function ooe(n,e,t,s){for(let a=0,r=s;a<=t.length;a++){let o=a?t[a-1].to:n,i=a<t.length?t[a].from:e;for(let l=o;l<i;){let c=Cs[l];if(c==256){let u=l+1;for(;;)if(u==i){if(a==t.length)break;u=t[a++].to,i=a<t.length?t[a].from:e}else if(Cs[u]==256)u++;else break;let h=r==1,m=(u<e?Cs[u]:s)==1,f=h==m?h?1:2:s;for(let v=u,O=a,k=O?t[O-1].to:n;v>l;)v==k&&(v=t[--O].from,k=O?t[O-1].to:n),Cs[--v]=f;l=u}else r=c,l++}}}function XP(n,e,t,s,a,r,o){let i=s%2?2:1;if(s%2==a%2)for(let l=e,c=0;l<t;){let u=!0,h=!1;if(c==r.length||l<r[c].from){let O=Cs[l];O!=i&&(u=!1,h=O==16)}let m=!u&&i==1?[]:null,f=u?s:s+1,v=l;e:for(;;)if(c<r.length&&v==r[c].from){if(h)break e;let O=r[c];if(!u)for(let k=O.to,M=c+1;;){if(k==t)break e;if(M<r.length&&r[M].from==k)k=r[M++].to;else{if(Cs[k]==i)break e;break}}if(c++,m)m.push(O);else{O.from>l&&o.push(new ru(l,O.from,f));let k=O.direction==Ih!=!(f%2);WP(n,k?s+1:s,a,O.inner,O.from,O.to,o),l=O.to}v=O.to}else{if(v==t||(u?Cs[v]!=i:Cs[v]==i))break;v++}m?XP(n,l,v,s+1,a,m,o):l<v&&o.push(new ru(l,v,f)),l=v}else for(let l=t,c=r.length;l>e;){let u=!0,h=!1;if(!c||l>r[c-1].to){let O=Cs[l-1];O!=i&&(u=!1,h=O==16)}let m=!u&&i==1?[]:null,f=u?s:s+1,v=l;e:for(;;)if(c&&v==r[c-1].to){if(h)break e;let O=r[--c];if(!u)for(let k=O.from,M=c;;){if(k==e)break e;if(M&&r[M-1].to==k)k=r[--M].from;else{if(Cs[k-1]==i)break e;break}}if(m)m.push(O);else{O.to<l&&o.push(new ru(O.to,l,f));let k=O.direction==Ih!=!(f%2);WP(n,k?s+1:s,a,O.inner,O.from,O.to,o),l=O.from}v=O.from}else{if(v==e||(u?Cs[v-1]!=i:Cs[v-1]==i))break;v--}m?XP(n,v,l,s+1,a,m,o):v<l&&o.push(new ru(v,l,f)),l=v}}function WP(n,e,t,s,a,r,o){let i=e%2?2:1;aoe(n,a,r,s,i),roe(n,a,r,s,i),ooe(a,r,s,i),XP(n,a,r,e,t,s,o)}function ioe(n,e,t){if(!n)return[new ru(0,0,e==yM?1:0)];if(e==Ih&&!t.length&&!soe.test(n))return $B(n.length);if(t.length)for(;n.length>Cs.length;)Cs[Cs.length]=256;let s=[],a=e==Ih?0:1;return WP(n,a,a,t,0,n.length,s),s}function $B(n){return[new ru(0,n,0)]}let RB="";function loe(n,e,t,s,a){var r;let o=s.head-n.from,i=ru.find(e,o,(r=s.bidiLevel)!==null&&r!==void 0?r:-1,s.assoc),l=e[i],c=l.side(a,t);if(o==c){let m=i+=a?1:-1;if(m<0||m>=e.length)return null;l=e[i=m],o=l.side(!a,t),c=l.side(a,t)}let u=Ha(n.text,o,l.forward(a,t));(u<l.from||u>l.to)&&(u=c),RB=n.text.slice(Math.min(o,u),Math.max(o,u));let h=i==(a?e.length-1:0)?null:e[i+(a?1:-1)];return h&&u==c&&h.level+(a?0:1)<l.level?Ve.cursor(h.side(!a,t)+n.from,h.forward(a,t)?1:-1,h.level):Ve.cursor(u+n.from,l.forward(a,t)?-1:1,l.level)}function coe(n,e,t){for(let s=e;s<t;s++){let a=NB(n.charCodeAt(s));if(a==1)return Ih;if(a==2||a==4)return yM}return Ih}const _B=Lt.define(),LB=Lt.define(),IB=Lt.define(),QB=Lt.define(),qP=Lt.define(),VB=Lt.define(),jB=Lt.define(),vM=Lt.define(),wM=Lt.define(),ZB=Lt.define({combine:n=>n.some(e=>e)}),zB=Lt.define({combine:n=>n.some(e=>e)}),GB=Lt.define();class Td{constructor(e,t="nearest",s="nearest",a=5,r=5,o=!1){this.range=e,this.y=t,this.x=s,this.yMargin=a,this.xMargin=r,this.isSnapshot=o}map(e){return e.empty?this:new Td(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Td(Ve.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const O0=cn.define({map:(n,e)=>n.map(e)}),XB=cn.define();function oo(n,e,t){let s=n.facet(QB);s.length?s[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const Oc=Lt.define({combine:n=>n.length?n[0]:!0});let uoe=0;const gd=Lt.define({combine(n){return n.filter((e,t)=>{for(let s=0;s<t;s++)if(n[s].plugin==e.plugin)return!1;return!0})}});class Ks{constructor(e,t,s,a,r){this.id=e,this.create=t,this.domEventHandlers=s,this.domEventObservers=a,this.baseExtensions=r(this),this.extension=this.baseExtensions.concat(gd.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(gd.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:s,eventObservers:a,provide:r,decorations:o}=t||{};return new Ks(uoe++,e,s,a,i=>{let l=[];return o&&l.push(Vf.of(c=>{let u=c.plugin(i);return u?o(u):Et.none})),r&&l.push(r(i)),l})}static fromClass(e,t){return Ks.define((s,a)=>new e(s,a),t)}}class BO{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(s){if(oo(t.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){oo(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(s){oo(e.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const WB=Lt.define(),OM=Lt.define(),Vf=Lt.define(),qB=Lt.define(),_g=Lt.define(),UB=Lt.define();function QE(n,e){let t=n.state.facet(UB);if(!t.length)return t;let s=t.map(r=>r instanceof Function?r(n):r),a=[];return ss.spans(s,e.from,e.to,{point(){},span(r,o,i,l){let c=r-e.from,u=o-e.from,h=a;for(let m=i.length-1;m>=0;m--,l--){let f=i[m].spec.bidiIsolate,v;if(f==null&&(f=coe(e.text,c,u)),l>0&&h.length&&(v=h[h.length-1]).to==c&&v.direction==f)v.to=u,h=v.inner;else{let O={from:c,to:u,direction:f,inner:[]};h.push(O),h=O.inner}}}}),a}const HB=Lt.define();function xM(n){let e=0,t=0,s=0,a=0;for(let r of n.state.facet(HB)){let o=r(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(s=Math.max(s,o.top)),o.bottom!=null&&(a=Math.max(a,o.bottom)))}return{left:e,right:t,top:s,bottom:a}}const Up=Lt.define();class gi{constructor(e,t,s,a){this.fromA=e,this.toA=t,this.fromB=s,this.toB=a}join(e){return new gi(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,s=this;for(;t>0;t--){let a=e[t-1];if(!(a.fromA>s.toA)){if(a.toA<s.fromA)break;s=s.join(a),e.splice(t-1,1)}}return e.splice(t,0,s),e}static extendWithRanges(e,t){if(t.length==0)return e;let s=[];for(let a=0,r=0,o=0,i=0;;a++){let l=a==e.length?null:e[a],c=o-i,u=l?l.fromB:1e9;for(;r<t.length&&t[r]<u;){let h=t[r],m=t[r+1],f=Math.max(i,h),v=Math.min(u,m);if(f<=v&&new gi(f+c,v+c,f,v).addToSet(s),m>u)break;r+=2}if(!l)return s;new gi(l.fromA,l.toA,l.fromB,l.toB).addToSet(s),o=l.toA,i=l.toB}}}class _1{constructor(e,t,s){this.view=e,this.state=t,this.transactions=s,this.flags=0,this.startState=e.state,this.changes=ka.empty(this.startState.doc.length);for(let r of s)this.changes=this.changes.compose(r.changes);let a=[];this.changes.iterChangedRanges((r,o,i,l)=>a.push(new gi(r,o,i,l))),this.changedRanges=a}static create(e,t,s){return new _1(e,t,s)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class VE extends ks{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Et.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new ma],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new gi(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let s=e.changedRanges;this.minWidth>0&&s.length&&(s.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let a=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?a=this.domChanged.newSel.head:!boe(e.changes,this.hasComposition)&&!e.selectionSet&&(a=e.state.selection.main.head));let r=a>-1?doe(this.view,e.changes,a):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;s=new gi(c,u,e.changes.mapPos(c,-1),e.changes.mapPos(u,1)).addToSet(s.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(At.ie||At.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,i=this.updateDeco(),l=foe(o,i,e.changes);return s=gi.extendWithRanges(s,l),!(this.flags&7)&&s.length==0?!1:(this.updateInner(s,e.startState.doc.length,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,s){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,s);let{observer:a}=this.view;a.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=At.chrome||At.ios?{node:a.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||a.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Mc&&o.widget instanceof zP&&r.push(o.dom);a.updateGaps(r)}updateChildren(e,t,s){let a=s?s.range.addToSet(e.slice()):e,r=this.childCursor(t);for(let o=a.length-1;;o--){let i=o>=0?a[o]:null;if(!i)break;let{fromA:l,toA:c,fromB:u,toB:h}=i,m,f,v,O;if(s&&s.range.fromB<h&&s.range.toB>u){let D=bf.build(this.view.state.doc,u,s.range.fromB,this.decorations,this.dynamicDecorationMap),F=bf.build(this.view.state.doc,s.range.toB,h,this.decorations,this.dynamicDecorationMap);f=D.breakAtStart,v=D.openStart,O=F.openEnd;let _=this.compositionView(s);F.breakAtStart?_.breakAfter=1:F.content.length&&_.merge(_.length,_.length,F.content[0],!1,F.openStart,0)&&(_.breakAfter=F.content[0].breakAfter,F.content.shift()),D.content.length&&_.merge(0,0,D.content[D.content.length-1],!0,0,D.openEnd)&&D.content.pop(),m=D.content.concat(_).concat(F.content)}else({content:m,breakAtStart:f,openStart:v,openEnd:O}=bf.build(this.view.state.doc,u,h,this.decorations,this.dynamicDecorationMap));let{i:k,off:M}=r.findPos(c,1),{i:E,off:I}=r.findPos(l,-1);CB(this,E,I,k,M,m,f,v,O)}s&&this.fixCompositionDOM(s)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let s of t.effects)s.is(XB)&&(this.editContextFormatting=s.value)}compositionView(e){let t=new Yi(e.text.nodeValue);t.flags|=8;for(let{deco:a}of e.marks)t=new Dc(a,[t],t.length);let s=new ma;return s.append(t,0),s}fixCompositionDOM(e){let t=(r,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let i=ks.get(r);i&&i!=o&&(i.dom=null),o.setDOM(r)},s=this.childPos(e.range.fromB,1),a=this.children[s.i];t(e.line,a);for(let r=e.marks.length-1;r>=-1;r--)s=a.childPos(s.off,1),a=a.children[s.i],t(r>=0?e.marks[r].node:e.text,a)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let s=this.view.root.activeElement,a=s==this.dom,r=!a&&!(this.view.state.facet(Oc)||this.dom.tabIndex>-1)&&Zb(this.dom,this.view.observer.selectionRange)&&!(s&&this.dom.contains(s));if(!(a||t||r))return;let o=this.forceSelection;this.forceSelection=!1;let i=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(i.anchor)),c=i.empty?l:this.moveToLine(this.domAtPos(i.head));if(At.gecko&&i.empty&&!this.hasComposition&&hoe(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=c=new cr(h,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||(!gf(l.node,l.offset,u.anchorNode,u.anchorOffset)||!gf(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,i))&&(this.view.observer.ignore(()=>{At.android&&At.chrome&&this.dom.contains(u.focusNode)&&goe(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=If(this.view.root);if(h)if(i.empty){if(At.gecko){let m=moe(l.node,l.offset);if(m&&m!=3){let f=(m==1?kB:PB)(l.node,l.offset);f&&(l=new cr(f.node,f.offset))}}h.collapse(l.node,l.offset),i.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=i.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(c.node,c.offset)}catch{}}else{let m=document.createRange();i.anchor>i.head&&([l,c]=[c,l]),m.setEnd(c.node,c.offset),m.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(m)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new cr(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new cr(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&gf(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,s=If(e.root),{anchorNode:a,anchorOffset:r}=e.observer.selectionRange;if(!s||!t.empty||!t.assoc||!s.modify)return;let o=ma.find(this,t.head);if(!o)return;let i=o.posAtStart;if(t.head==i||t.head==i+o.length)return;let l=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(t.head+t.assoc);s.collapse(u.node,u.offset),s.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&s.collapse(a,r)}moveToLine(e){let t=this.dom,s;if(e.node!=t)return e;for(let a=e.offset;!s&&a<t.childNodes.length;a++){let r=ks.get(t.childNodes[a]);r instanceof ma&&(s=r.domAtPos(0))}for(let a=e.offset-1;!s&&a>=0;a--){let r=ks.get(t.childNodes[a]);r instanceof ma&&(s=r.domAtPos(r.length))}return s?new cr(s.node,s.offset,!0):e}nearest(e){for(let t=e;t;){let s=ks.get(t);if(s&&s.rootView==this)return s;t=t.parentNode}return null}posFromDOM(e,t){let s=this.nearest(e);if(!s)throw new RangeError("Trying to find position for a DOM position outside of the document");return s.localPosFromDOM(e,t)+s.posAtStart}domAtPos(e){let{i:t,off:s}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let a=this.children[t];if(s<a.length||a instanceof ma)break;t++,s=0}return this.children[t].domAtPos(s)}coordsAt(e,t){let s=null,a=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let i=this.children[o],l=r-i.breakAfter,c=l-i.length;if(l<e)break;if(c<=e&&(c<e||i.covers(-1))&&(l>e||i.covers(1))&&(!s||i instanceof ma&&!(s instanceof ma&&t>=0)))s=i,a=c;else if(s&&c==e&&l==e&&i instanceof Mc&&Math.abs(t)<2){if(i.deco.startSide<0)break;o&&(s=null)}r=c}return s?s.coordsAt(e-a,t):null}coordsForChar(e){let{i:t,off:s}=this.childPos(e,1),a=this.children[t];if(!(a instanceof ma))return null;for(;a.children.length;){let{i,off:l}=a.childPos(s,1);for(;;i++){if(i==a.children.length)return null;if((a=a.children[i]).length)break}s=l}if(!(a instanceof Yi))return null;let r=Ha(a.text,s);if(r==s)return null;let o=Lh(a.dom,s,r).getClientRects();for(let i=0;i<o.length;i++){let l=o[i];if(i==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:s,to:a}=e,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,i=-1,l=this.view.textDirection==Es.LTR;for(let c=0,u=0;u<this.children.length;u++){let h=this.children[u],m=c+h.length;if(m>a)break;if(c>=s){let f=h.dom.getBoundingClientRect();if(t.push(f.height),o){let v=h.dom.lastChild,O=v?Qf(v):[];if(O.length){let k=O[O.length-1],M=l?k.right-f.left:f.right-k.left;M>i&&(i=M,this.minWidth=r,this.minWidthFrom=c,this.minWidthTo=m)}}}c=m+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Es.RTL:Es.LTR}measureTextSize(){for(let r of this.children)if(r instanceof ma){let o=r.measureTextSize();if(o)return o}let e=document.createElement("div"),t,s,a;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let r=Qf(e.firstChild)[0];t=e.getBoundingClientRect().height,s=r?r.width/27:7,a=r?r.height:t,e.remove()}),{lineHeight:t,charWidth:s,textHeight:a}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new SB(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let s=0,a=0;;a++){let r=a==t.viewports.length?null:t.viewports[a],o=r?r.from-1:this.length;if(o>s){let i=(t.lineBlockAt(o).bottom-t.lineBlockAt(s).top)/this.view.scaleY;e.push(Et.replace({widget:new zP(i),block:!0,inclusive:!0,isBlockGap:!0}).range(s,o))}if(!r)break;s=r.to+1}return Et.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Vf).map(r=>(this.dynamicDecorationMap[e++]=typeof r=="function")?r(this.view):r),s=!1,a=this.view.state.facet(qB).map((r,o)=>{let i=typeof r=="function";return i&&(s=!0),i?r(this.view):r});for(a.length&&(this.dynamicDecorationMap[e++]=s,t.push(ss.join(a))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(GB))try{if(c(this.view,e.range,e))return!0}catch(u){oo(this.view.state,u,"scroll handler")}let{range:t}=e,s=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),a;if(!s)return;!t.empty&&(a=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(s={left:Math.min(s.left,a.left),top:Math.min(s.top,a.top),right:Math.max(s.right,a.right),bottom:Math.max(s.bottom,a.bottom)});let r=xM(this.view),o={left:s.left-r.left,top:s.top-r.top,right:s.right+r.right,bottom:s.bottom+r.bottom},{offsetWidth:i,offsetHeight:l}=this.view.scrollDOM;zre(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,i),-i),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Es.LTR)}}function hoe(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function YB(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let s=kB(t.focusNode,t.focusOffset),a=PB(t.focusNode,t.focusOffset),r=s||a;if(a&&s&&a.node!=s.node){let i=ks.get(a.node);if(!i||i instanceof Yi&&i.text!=a.node.nodeValue)r=a;else if(n.docView.lastCompositionAfterCursor){let l=ks.get(s.node);!l||l instanceof Yi&&l.text!=s.node.nodeValue||(r=a)}}if(n.docView.lastCompositionAfterCursor=r!=s,!r)return null;let o=e-r.offset;return{from:o,to:o+r.node.nodeValue.length,node:r.node}}function doe(n,e,t){let s=YB(n,t);if(!s)return null;let{node:a,from:r,to:o}=s,i=a.nodeValue;if(/[\n\r]/.test(i)||n.state.doc.sliceString(s.from,s.to)!=i)return null;let l=e.invertedDesc,c=new gi(l.mapPos(r),l.mapPos(o),r,o),u=[];for(let h=a.parentNode;;h=h.parentNode){let m=ks.get(h);if(m instanceof Dc)u.push({node:h,deco:m.mark});else{if(m instanceof ma||h.nodeName=="DIV"&&h.parentNode==n.contentDOM)return{range:c,text:a,marks:u,line:h};if(h!=n.contentDOM)u.push({node:h,deco:new $g({inclusive:!0,attributes:Jre(h),tagName:h.tagName.toLowerCase()})});else return null}}}function moe(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let poe=class{constructor(){this.changes=[]}compareRange(e,t){zb(e,t,this.changes)}comparePoint(e,t){zb(e,t,this.changes)}boundChange(e){zb(e,e,this.changes)}};function foe(n,e,t){let s=new poe;return ss.compare(n,e,t,s),s.changes}function goe(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function boe(n,e){let t=!1;return e&&n.iterChangedRanges((s,a)=>{s<e.to&&a>e.from&&(t=!0)}),t}function yoe(n,e,t=1){let s=n.charCategorizer(e),a=n.doc.lineAt(e),r=e-a.from;if(a.length==0)return Ve.cursor(e);r==0?t=1:r==a.length&&(t=-1);let o=r,i=r;t<0?o=Ha(a.text,r,!1):i=Ha(a.text,r);let l=s(a.text.slice(o,i));for(;o>0;){let c=Ha(a.text,o,!1);if(s(a.text.slice(c,o))!=l)break;o=c}for(;i<a.length;){let c=Ha(a.text,i);if(s(a.text.slice(i,c))!=l)break;i=c}return Ve.range(o+a.from,i+a.from)}function voe(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function woe(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function $O(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function jE(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function ZE(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function UP(n,e,t){let s,a,r,o,i=!1,l,c,u,h;for(let v=n.firstChild;v;v=v.nextSibling){let O=Qf(v);for(let k=0;k<O.length;k++){let M=O[k];a&&$O(a,M)&&(M=jE(ZE(M,a.bottom),a.top));let E=voe(e,M),I=woe(t,M);if(E==0&&I==0)return v.nodeType==3?zE(v,e,t):UP(v,e,t);(!s||o>I||o==I&&r>E)&&(s=v,a=M,r=E,o=I,i=E?e<M.left?k>0:k<O.length-1:!0),E==0?t>M.bottom&&(!u||u.bottom<M.bottom)?(l=v,u=M):t<M.top&&(!h||h.top>M.top)&&(c=v,h=M):u&&$O(u,M)?u=ZE(u,M.bottom):h&&$O(h,M)&&(h=jE(h,M.top))}}if(u&&u.bottom>=t?(s=l,a=u):h&&h.top<=t&&(s=c,a=h),!s)return{node:n,offset:0};let m=Math.max(a.left,Math.min(a.right,e));if(s.nodeType==3)return zE(s,m,t);if(i&&s.contentEditable!="false")return UP(s,m,t);let f=Array.prototype.indexOf.call(n.childNodes,s)+(e>=(a.left+a.right)/2?1:0);return{node:n,offset:f}}function zE(n,e,t){let s=n.nodeValue.length,a=-1,r=1e9,o=0;for(let i=0;i<s;i++){let l=Lh(n,i,i+1).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(u.top==u.bottom)continue;o||(o=e-u.left);let h=(u.top>t?u.top-t:t-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&h<r){let m=e>=(u.left+u.right)/2,f=m;if((At.chrome||At.gecko)&&Lh(n,i).getBoundingClientRect().left==u.right&&(f=!m),h<=0)return{node:n,offset:i+(f?1:0)};a=i+(f?1:0),r=h}}}return{node:n,offset:a>-1?a:o>0?n.nodeValue.length:0}}function KB(n,e,t,s=-1){var a,r;let o=n.contentDOM.getBoundingClientRect(),i=o.top+n.viewState.paddingTop,l,{docHeight:c}=n.viewState,{x:u,y:h}=e,m=h-i;if(m<0)return 0;if(m>c)return n.state.doc.length;for(let D=n.viewState.heightOracle.textHeight/2,F=!1;l=n.elementAtHeight(m),l.type!=Ar.Text;)for(;m=s>0?l.bottom+D:l.top-D,!(m>=0&&m<=c);){if(F)return t?null:0;F=!0,s=-s}h=i+m;let f=l.from;if(f<n.viewport.from)return n.viewport.from==0?0:t?null:GE(n,o,l,u,h);if(f>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:GE(n,o,l,u,h);let v=n.dom.ownerDocument,O=n.root.elementFromPoint?n.root:v,k=O.elementFromPoint(u,h);k&&!n.contentDOM.contains(k)&&(k=null),k||(u=Math.max(o.left+1,Math.min(o.right-1,u)),k=O.elementFromPoint(u,h),k&&!n.contentDOM.contains(k)&&(k=null));let M,E=-1;if(k&&((a=n.docView.nearest(k))===null||a===void 0?void 0:a.isEditable)!=!1){if(v.caretPositionFromPoint){let D=v.caretPositionFromPoint(u,h);D&&({offsetNode:M,offset:E}=D)}else if(v.caretRangeFromPoint){let D=v.caretRangeFromPoint(u,h);D&&({startContainer:M,startOffset:E}=D)}M&&(!n.contentDOM.contains(M)||At.safari&&Ooe(M,E,u)||At.chrome&&xoe(M,E,u))&&(M=void 0),M&&(E=Math.min(Zl(M),E))}if(!M||!n.docView.dom.contains(M)){let D=ma.find(n.docView,f);if(!D)return m>l.top+l.height/2?l.to:l.from;({node:M,offset:E}=UP(D.dom,u,h))}let I=n.docView.nearest(M);if(!I)return null;if(I.isWidget&&((r=I.dom)===null||r===void 0?void 0:r.nodeType)==1){let D=I.dom.getBoundingClientRect();return e.y<D.top||e.y<=D.bottom&&e.x<=(D.left+D.right)/2?I.posAtStart:I.posAtEnd}else return I.localPosFromDOM(M,E)+I.posAtStart}function GE(n,e,t,s,a){let r=Math.round((s-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let i=n.viewState.heightOracle.textHeight,l=Math.floor((a-t.top-(n.defaultLineHeight-i)*.5)/i);r+=l*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+BP(o,r,n.state.tabSize)}function JB(n,e,t){let s,a=n;if(n.nodeType!=3||e!=(s=n.nodeValue.length))return!1;for(;;){let r=a.nextSibling;if(r){if(r.nodeName=="BR")break;return!1}else{let o=a.parentNode;if(!o||o.nodeName=="DIV")break;a=o}}return Lh(n,s-1,s).getBoundingClientRect().right>t}function Ooe(n,e,t){return JB(n,e,t)}function xoe(n,e,t){if(e!=0)return JB(n,e,t);for(let a=n;;){let r=a.parentNode;if(!r||r.nodeType!=1||r.firstChild!=a)return!1;if(r.classList.contains("cm-line"))break;a=r}let s=n.nodeType==1?n.getBoundingClientRect():Lh(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-s.left>5}function HP(n,e,t){let s=n.lineBlockAt(e);if(Array.isArray(s.type)){let a;for(let r of s.type){if(r.from>e)break;if(!(r.to<e)){if(r.from<e&&r.to>e)return r;(!a||r.type==Ar.Text&&(a.type!=r.type||(t<0?r.from<e:r.to>e)))&&(a=r)}}return a||s}return s}function koe(n,e,t,s){let a=HP(n,e.head,e.assoc||-1),r=!s||a.type!=Ar.Text||!(n.lineWrapping||a.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>a.from?e.head-1:e.head);if(r){let o=n.dom.getBoundingClientRect(),i=n.textDirectionAt(a.from),l=n.posAtCoords({x:t==(i==Es.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(l!=null)return Ve.cursor(l,t?-1:1)}return Ve.cursor(t?a.to:a.from,t?-1:1)}function XE(n,e,t,s){let a=n.state.doc.lineAt(e.head),r=n.bidiSpans(a),o=n.textDirectionAt(a.from);for(let i=e,l=null;;){let c=loe(a,r,o,i,t),u=RB;if(!c){if(a.number==(t?n.state.doc.lines:1))return i;u=`
`,a=n.state.doc.line(a.number+(t?1:-1)),r=n.bidiSpans(a),c=n.visualLineSide(a,!t)}if(l){if(!l(u))return i}else{if(!s)return c;l=s(u)}i=c}}function Poe(n,e,t){let s=n.state.charCategorizer(e),a=s(t);return r=>{let o=s(r);return a==Hs.Space&&(a=o),a==o}}function Soe(n,e,t,s){let a=e.head,r=t?1:-1;if(a==(t?n.state.doc.length:0))return Ve.cursor(a,e.assoc);let o=e.goalColumn,i,l=n.contentDOM.getBoundingClientRect(),c=n.coordsAtPos(a,e.assoc||-1),u=n.documentTop;if(c)o==null&&(o=c.left-l.left),i=r<0?c.top:c.bottom;else{let f=n.viewState.lineBlockAt(a);o==null&&(o=Math.min(l.right-l.left,n.defaultCharacterWidth*(a-f.from))),i=(r<0?f.top:f.bottom)+u}let h=l.left+o,m=s??n.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let v=i+(m+f)*r,O=KB(n,{x:h,y:v},!1,r);if(v<l.top||v>l.bottom||(r<0?O<a:O>a)){let k=n.docView.coordsForChar(O),M=!k||v<k.top?-1:1;return Ve.cursor(O,M,void 0,o)}}}function yf(n,e,t){for(;;){let s=0;for(let a of n)a.between(e-1,e+1,(r,o,i)=>{if(e>r&&e<o){let l=s||t||(e-r<o-e?-1:1);e=l<0?r:o,s=l}});if(!s)return e}}function e6(n,e){let t=null;for(let s=0;s<e.ranges.length;s++){let a=e.ranges[s],r=null;if(a.empty){let o=yf(n,a.from,0);o!=a.from&&(r=Ve.cursor(o,-1))}else{let o=yf(n,a.from,-1),i=yf(n,a.to,1);(o!=a.from||i!=a.to)&&(r=Ve.range(a.from==a.anchor?o:i,a.from==a.head?o:i))}r&&(t||(t=e.ranges.slice()),t[s]=r)}return t?Ve.create(t,e.mainIndex):e}function RO(n,e,t){let s=yf(n.state.facet(_g).map(a=>a(n)),t.from,e.head>t.from?-1:1);return s==t.from?t:Ve.cursor(s,s<t.from?1:-1)}const Hp="￿";class Coe{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(cs.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Hp}readRange(e,t){if(!e)return this;let s=e.parentNode;for(let a=e;;){this.findPointBefore(s,a);let r=this.text.length;this.readNode(a);let o=a.nextSibling;if(o==t)break;let i=ks.get(a),l=ks.get(o);(i&&l?i.breakAfter:(i?i.breakAfter:$1(a))||$1(o)&&(a.nodeName!="BR"||a.cmIgnore)&&this.text.length>r)&&!Aoe(o,t)&&this.lineBreak(),a=o}return this.findPointBefore(s,t),this}readTextNode(e){let t=e.nodeValue;for(let s of this.points)s.node==e&&(s.pos=this.text.length+Math.min(s.offset,t.length));for(let s=0,a=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,i;if(this.lineSeparator?(r=t.indexOf(this.lineSeparator,s),o=this.lineSeparator.length):(i=a.exec(t))&&(r=i.index,o=i[0].length),this.append(t.slice(s,r<0?t.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);s=r+o}}readNode(e){if(e.cmIgnore)return;let t=ks.get(e),s=t&&t.overrideDOMText;if(s!=null){this.findPointInside(e,s.length);for(let a=s.iter();!a.next().done;)a.lineBreak?this.lineBreak():this.append(a.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let s of this.points)s.node==e&&e.childNodes[s.offset]==t&&(s.pos=this.text.length)}findPointInside(e,t){for(let s of this.points)(e.nodeType==3?s.node==e:e.contains(s.node))&&(s.pos=this.text.length+(Moe(e,s.node,s.offset)?t:0))}}function Moe(n,e,t){for(;;){if(!e||t<Zl(e))return!1;if(e==n)return!0;t=_h(e)+1,e=e.parentNode}}function Aoe(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let s=ks.get(n);if(!(s!=null&&s.isWidget||n.cmIgnore))return!1;s&&(t||(t=[])).push(s)}if(t)for(let s of t){let a=s.overrideDOMText;if(a!=null&&a.length)return!1}return!0}class WE{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Eoe{constructor(e,t,s,a){this.typeOver=a,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:r,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,s,0))){let i=r||o?[]:Toe(e),l=new Coe(i,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=Foe(i,this.bounds.from)}else{let i=e.observer.selectionRange,l=r&&r.node==i.focusNode&&r.offset==i.focusOffset||!VP(e.contentDOM,i.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(i.focusNode,i.focusOffset),c=o&&o.node==i.anchorNode&&o.offset==i.anchorOffset||!VP(e.contentDOM,i.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(i.anchorNode,i.anchorOffset),u=e.viewport;if((At.ios||At.chrome)&&e.state.selection.main.empty&&l!=c&&(u.from>0||u.to<e.state.doc.length)){let h=Math.min(l,c),m=Math.max(l,c),f=u.from-h,v=u.to-m;(f==0||f==1||h==0)&&(v==0||v==-1||m==e.state.doc.length)&&(l=0,c=e.state.doc.length)}this.newSel=Ve.single(c,l)}}}function t6(n,e){let t,{newSel:s}=e,a=n.state.selection.main,r=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:i}=e.bounds,l=a.from,c=null;(r===8||At.android&&e.text.length<i-o)&&(l=a.to,c="end");let u=n6(n.state.doc.sliceString(o,i,Hp),e.text,l-o,c);u&&(At.chrome&&r==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==Hp+Hp&&u.toB--,t={from:o+u.from,to:o+u.toA,insert:rs.of(e.text.slice(u.from,u.toB).split(Hp))})}else s&&(!n.hasFocus&&n.state.facet(Oc)||s.main.eq(a))&&(s=null);if(!t&&!s)return!1;if(!t&&e.typeOver&&!a.empty&&s&&s.main.empty?t={from:a.from,to:a.to,insert:n.state.doc.slice(a.from,a.to)}:(At.mac||At.android)&&t&&t.from==t.to&&t.from==a.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(s&&t.insert.length==2&&(s=Ve.single(s.main.anchor-1,s.main.head-1)),t={from:t.from,to:t.to,insert:rs.of([t.insert.toString().replace("."," ")])}):t&&t.from>=a.from&&t.to<=a.to&&(t.from!=a.from||t.to!=a.to)&&a.to-a.from-(t.to-t.from)<=4?t={from:a.from,to:a.to,insert:n.state.doc.slice(a.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,a.to))}:At.chrome&&t&&t.from==t.to&&t.from==a.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(s&&(s=Ve.single(s.main.anchor-1,s.main.head-1)),t={from:a.from,to:a.to,insert:rs.of([" "])}),t)return kM(n,t,s,r);if(s&&!s.main.eq(a)){let o=!1,i="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),i=n.inputState.lastSelectionOrigin,i=="select.pointer"&&(s=e6(n.state.facet(_g).map(l=>l(n)),s))),n.dispatch({selection:s,scrollIntoView:o,userEvent:i}),!0}else return!1}function kM(n,e,t,s=-1){if(At.ios&&n.inputState.flushIOSKey(e))return!0;let a=n.state.selection.main;if(At.android&&(e.to==a.to&&(e.from==a.from||e.from==a.from-1&&n.state.sliceDoc(e.from,a.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Dd(n.contentDOM,"Enter",13)||(e.from==a.from-1&&e.to==a.to&&e.insert.length==0||s==8&&e.insert.length<e.to-e.from&&e.to>a.head)&&Dd(n.contentDOM,"Backspace",8)||e.from==a.from&&e.to==a.to+1&&e.insert.length==0&&Dd(n.contentDOM,"Delete",46)))return!0;let r=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,i=()=>o||(o=Doe(n,e,t));return n.state.facet(VB).some(l=>l(n,e.from,e.to,r,i))||n.dispatch(i()),!0}function Doe(n,e,t){let s,a=n.state,r=a.selection.main,o=-1;if(e.from==e.to&&e.from<r.from||e.from>r.to){let l=e.from<r.from?-1:1,c=l<0?r.from:r.to,u=yf(a.facet(_g).map(h=>h(n)),c,l);e.from==u&&(o=u)}if(o>-1)s={changes:e,selection:Ve.cursor(e.from+e.insert.length,-1)};else if(e.from>=r.from&&e.to<=r.to&&e.to-e.from>=(r.to-r.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let l=r.from<e.from?a.sliceDoc(r.from,e.from):"",c=r.to>e.to?a.sliceDoc(e.to,r.to):"";s=a.replaceSelection(n.state.toText(l+e.insert.sliceString(0,void 0,n.state.lineBreak)+c))}else{let l=a.changes(e),c=t&&t.main.to<=l.newLength?t.main:void 0;if(a.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=r.to&&e.to>=r.to-10){let u=n.state.sliceDoc(e.from,e.to),h,m=t&&YB(n,t.main.head);if(m){let O=e.insert.length-(e.to-e.from);h={from:m.from,to:m.to-O}}else h=n.state.doc.lineAt(r.head);let f=r.to-e.to,v=r.to-r.from;s=a.changeByRange(O=>{if(O.from==r.from&&O.to==r.to)return{changes:l,range:c||O.map(l)};let k=O.to-f,M=k-u.length;if(O.to-O.from!=v||n.state.sliceDoc(M,k)!=u||O.to>=h.from&&O.from<=h.to)return{range:O};let E=a.changes({from:M,to:k,insert:e.insert}),I=O.to-r.to;return{changes:E,range:c?Ve.range(Math.max(0,c.anchor+I),Math.max(0,c.head+I)):O.map(E)}})}else s={changes:l,selection:c&&a.selection.replaceRange(c)}}let i="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,i+=".compose",n.inputState.compositionFirstChange&&(i+=".start",n.inputState.compositionFirstChange=!1)),a.update(s,{userEvent:i,scrollIntoView:!0})}function n6(n,e,t,s){let a=Math.min(n.length,e.length),r=0;for(;r<a&&n.charCodeAt(r)==e.charCodeAt(r);)r++;if(r==a&&n.length==e.length)return null;let o=n.length,i=e.length;for(;o>0&&i>0&&n.charCodeAt(o-1)==e.charCodeAt(i-1);)o--,i--;if(s=="end"){let l=Math.max(0,r-Math.min(o,i));t-=o+l-r}if(o<r&&n.length<e.length){let l=t<=r&&t>=o?r-t:0;r-=l,i=r+(i-o),o=r}else if(i<r){let l=t<=r&&t>=i?r-t:0;r-=l,o=r+(o-i),i=r}return{from:r,toA:o,toB:i}}function Toe(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:s,focusNode:a,focusOffset:r}=n.observer.selectionRange;return t&&(e.push(new WE(t,s)),(a!=t||r!=s)&&e.push(new WE(a,r))),e}function Foe(n,e){if(n.length==0)return null;let t=n[0].pos,s=n.length==2?n[1].pos:t;return t>-1&&s>-1?Ve.single(t+e,s+e):null}class Noe{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,At.safari&&e.contentDOM.addEventListener("input",()=>null),At.gecko&&Uoe(e.contentDOM.ownerDocument)}handleEvent(e){!Voe(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let s=this.handlers[e];if(s){for(let a of s.observers)a(this.view,t);for(let a of s.handlers){if(t.defaultPrevented)break;if(a(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=Boe(e),s=this.handlers,a=this.view.contentDOM;for(let r in t)if(r!="scroll"){let o=!t[r].handlers.length,i=s[r];i&&o!=!i.handlers.length&&(a.removeEventListener(r,this.handleEvent),i=null),i||a.addEventListener(r,this.handleEvent,{passive:o})}for(let r in s)r!="scroll"&&!t[r]&&a.removeEventListener(r,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&a6.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),At.android&&At.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return At.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=s6.find(s=>s.keyCode==e.keyCode))&&!e.ctrlKey||$oe.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Dd(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:At.safari&&!At.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function qE(n,e){return(t,s)=>{try{return e.call(n,s,t)}catch(a){oo(t.state,a)}}}function Boe(n){let e=Object.create(null);function t(s){return e[s]||(e[s]={observers:[],handlers:[]})}for(let s of n){let a=s.spec,r=a&&a.plugin.domEventHandlers,o=a&&a.plugin.domEventObservers;if(r)for(let i in r){let l=r[i];l&&t(i).handlers.push(qE(s.value,l))}if(o)for(let i in o){let l=o[i];l&&t(i).observers.push(qE(s.value,l))}}for(let s in Ki)t(s).handlers.push(Ki[s]);for(let s in yi)t(s).observers.push(yi[s]);return e}const s6=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],$oe="dthko",a6=[16,17,18,20,91,92,224,225],x0=6;function k0(n){return Math.max(0,n)*.7+8}function Roe(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class _oe{constructor(e,t,s,a){this.view=e,this.startEvent=t,this.style=s,this.mustSelect=a,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=Gre(e.contentDOM),this.atoms=e.state.facet(_g).map(o=>o(e));let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(cs.allowMultipleSelections)&&Loe(e,t),this.dragging=Qoe(e,t)&&i6(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Roe(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,s=0,a=0,r=0,o=this.view.win.innerWidth,i=this.view.win.innerHeight;this.scrollParents.x&&({left:a,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:i}=this.scrollParents.y.getBoundingClientRect());let l=xM(this.view);e.clientX-l.left<=a+x0?t=-k0(a-e.clientX):e.clientX+l.right>=o-x0&&(t=k0(e.clientX-o)),e.clientY-l.top<=r+x0?s=-k0(r-e.clientY):e.clientY+l.bottom>=i-x0&&(s=k0(e.clientY-i)),this.setScrollSpeed(t,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,s=e6(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!s.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:s,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Loe(n,e){let t=n.state.facet(_B);return t.length?t[0](e):At.mac?e.metaKey:e.ctrlKey}function Ioe(n,e){let t=n.state.facet(LB);return t.length?t[0](e):At.mac?!e.altKey:!e.ctrlKey}function Qoe(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let s=If(n.root);if(!s||s.rangeCount==0)return!0;let a=s.getRangeAt(0).getClientRects();for(let r=0;r<a.length;r++){let o=a[r];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function Voe(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,s;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(s=ks.get(t))&&s.ignoreEvent(e))return!1;return!0}const Ki=Object.create(null),yi=Object.create(null),r6=At.ie&&At.ie_version<15||At.ios&&At.webkit_version<604;function joe(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),o6(n,t.value)},50)}function Uv(n,e,t){for(let s of n.facet(e))t=s(t,n);return t}function o6(n,e){e=Uv(n.state,vM,e);let{state:t}=n,s,a=1,r=t.toText(e),o=r.lines==t.selection.ranges.length;if(YP!=null&&t.selection.ranges.every(l=>l.empty)&&YP==r.toString()){let l=-1;s=t.changeByRange(c=>{let u=t.doc.lineAt(c.from);if(u.from==l)return{range:c};l=u.from;let h=t.toText((o?r.line(a++).text:e)+t.lineBreak);return{changes:{from:u.from,insert:h},range:Ve.cursor(c.from+h.length)}})}else o?s=t.changeByRange(l=>{let c=r.line(a++);return{changes:{from:l.from,to:l.to,insert:c.text},range:Ve.cursor(l.from+c.length)}}):s=t.replaceSelection(r);n.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}yi.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Ki.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);yi.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};yi.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Ki.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let s of n.state.facet(IB))if(t=s(n,e),t)break;if(!t&&e.button==0&&(t=Goe(n,e)),t){let s=!n.hasFocus;n.inputState.startMouseSelection(new _oe(n,e,t,s)),s&&n.observer.ignore(()=>{wB(n.contentDOM);let r=n.root.activeElement;r&&!r.contains(n.contentDOM)&&r.blur()});let a=n.inputState.mouseSelection;if(a)return a.start(e),a.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function UE(n,e,t,s){if(s==1)return Ve.cursor(e,t);if(s==2)return yoe(n.state,e,t);{let a=ma.find(n.docView,e),r=n.state.doc.lineAt(a?a.posAtEnd:e),o=a?a.posAtStart:r.from,i=a?a.posAtEnd:r.to;return i<n.state.doc.length&&i==r.to&&i++,Ve.range(o,i)}}let HE=(n,e,t)=>e>=t.top&&e<=t.bottom&&n>=t.left&&n<=t.right;function Zoe(n,e,t,s){let a=ma.find(n.docView,e);if(!a)return 1;let r=e-a.posAtStart;if(r==0)return 1;if(r==a.length)return-1;let o=a.coordsAt(r,-1);if(o&&HE(t,s,o))return-1;let i=a.coordsAt(r,1);return i&&HE(t,s,i)?1:o&&o.bottom>=s?-1:1}function YE(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Zoe(n,t,e.clientX,e.clientY)}}const zoe=At.ie&&At.ie_version<=11;let KE=null,JE=0,eD=0;function i6(n){if(!zoe)return n.detail;let e=KE,t=eD;return KE=n,eD=Date.now(),JE=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(JE+1)%3:1}function Goe(n,e){let t=YE(n,e),s=i6(e),a=n.state.selection;return{update(r){r.docChanged&&(t.pos=r.changes.mapPos(t.pos),a=a.map(r.changes))},get(r,o,i){let l=YE(n,r),c,u=UE(n,l.pos,l.bias,s);if(t.pos!=l.pos&&!o){let h=UE(n,t.pos,t.bias,s),m=Math.min(h.from,u.from),f=Math.max(h.to,u.to);u=m<u.from?Ve.range(m,f):Ve.range(f,m)}return o?a.replaceRange(a.main.extend(u.from,u.to)):i&&s==1&&a.ranges.length>1&&(c=Xoe(a,l.pos))?c:i?a.addRange(u):Ve.create([u])}}}function Xoe(n,e){for(let t=0;t<n.ranges.length;t++){let{from:s,to:a}=n.ranges[t];if(s<=e&&a>=e)return Ve.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}Ki.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let a=n.docView.nearest(e.target);if(a&&a.isWidget){let r=a.posAtStart,o=r+a.length;(r>=t.to||o<=t.from)&&(t=Ve.range(r,o))}}let{inputState:s}=n;return s.mouseSelection&&(s.mouseSelection.dragging=!0),s.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Uv(n.state,wM,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Ki.dragend=n=>(n.inputState.draggedContent=null,!1);function tD(n,e,t,s){if(t=Uv(n.state,vM,t),!t)return;let a=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:r}=n.inputState,o=s&&r&&Ioe(n,e)?{from:r.from,to:r.to}:null,i={from:a,insert:t},l=n.state.changes(o?[o,i]:i);n.focus(),n.dispatch({changes:l,selection:{anchor:l.mapPos(a,-1),head:l.mapPos(a,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Ki.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let s=Array(t.length),a=0,r=()=>{++a==t.length&&tD(n,e,s.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let i=new FileReader;i.onerror=r,i.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(i.result)||(s[o]=i.result),r()},i.readAsText(t[o])}return!0}else{let s=e.dataTransfer.getData("Text");if(s)return tD(n,e,s,!0),!0}return!1};Ki.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=r6?null:e.clipboardData;return t?(o6(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(joe(n),!1)};function Woe(n,e){let t=n.dom.parentNode;if(!t)return;let s=t.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=e,s.focus(),s.selectionEnd=e.length,s.selectionStart=0,setTimeout(()=>{s.remove(),n.focus()},50)}function qoe(n){let e=[],t=[],s=!1;for(let a of n.selection.ranges)a.empty||(e.push(n.sliceDoc(a.from,a.to)),t.push(a));if(!e.length){let a=-1;for(let{from:r}of n.selection.ranges){let o=n.doc.lineAt(r);o.number>a&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),a=o.number}s=!0}return{text:Uv(n,wM,e.join(n.lineBreak)),ranges:t,linewise:s}}let YP=null;Ki.copy=Ki.cut=(n,e)=>{let{text:t,ranges:s,linewise:a}=qoe(n.state);if(!t&&!a)return!1;YP=a?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let r=r6?null:e.clipboardData;return r?(r.clearData(),r.setData("text/plain",t),!0):(Woe(n,t),!1)};const l6=Ic.define();function c6(n,e){let t=[];for(let s of n.facet(jB)){let a=s(n,e);a&&t.push(a)}return t.length?n.update({effects:t,annotations:l6.of(!0)}):null}function u6(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=c6(n.state,e);t?n.dispatch(t):n.update([])}},10)}yi.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),u6(n)};yi.blur=n=>{n.observer.clearSelectionRange(),u6(n)};yi.compositionstart=yi.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};yi.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,At.chrome&&At.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};yi.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Ki.beforeinput=(n,e)=>{var t,s;if(e.inputType=="insertReplacementText"&&n.observer.editContext){let r=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(r&&o.length){let i=o[0],l=n.posAtDOM(i.startContainer,i.startOffset),c=n.posAtDOM(i.endContainer,i.endOffset);return kM(n,{from:l,to:c,insert:n.state.toText(r)},null),!0}}let a;if(At.chrome&&At.android&&(a=s6.find(r=>r.inputType==e.inputType))&&(n.observer.delayAndroidKey(a.key,a.keyCode),a.key=="Backspace"||a.key=="Delete")){let r=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return At.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),At.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>yi.compositionend(n,e),20),!1};const nD=new Set;function Uoe(n){nD.has(n)||(nD.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const sD=["pre-wrap","normal","pre-line","break-spaces"];let rm=!1;function aD(){rm=!1}class Hoe{constructor(e){this.lineWrapping=e,this.doc=rs.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let s=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((t-e-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return sD.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let s=0;s<e.length;s++){let a=e[s];a<0?s++:this.heightSamples[Math.floor(a*10)]||(t=!0,this.heightSamples[Math.floor(a*10)]=!0)}return t}refresh(e,t,s,a,r,o){let i=sD.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=i;if(this.lineWrapping=i,this.lineHeight=t,this.charWidth=s,this.textHeight=a,this.lineLength=r,l){this.heightSamples={};for(let c=0;c<o.length;c++){let u=o[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class Yoe{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Cl{constructor(e,t,s,a,r){this.from=e,this.length=t,this.top=s,this.height=a,this._content=r}get type(){return typeof this._content=="number"?Ar.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Su?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Cl(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Qs=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(Qs||(Qs={}));const Gb=.001;class Er{constructor(e,t,s=2){this.length=e,this.height=t,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Gb&&(rm=!0),this.height=e)}replace(e,t,s){return Er.of(s)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,s,a){let r=this,o=s.doc;for(let i=a.length-1;i>=0;i--){let{fromA:l,toA:c,fromB:u,toB:h}=a[i],m=r.lineAt(l,Qs.ByPosNoHeight,s.setDoc(t),0,0),f=m.to>=c?m:r.lineAt(c,Qs.ByPosNoHeight,s,0,0);for(h+=f.to-c,c=f.to;i>0&&m.from<=a[i-1].toA;)l=a[i-1].fromA,u=a[i-1].fromB,i--,l<m.from&&(m=r.lineAt(l,Qs.ByPosNoHeight,s,0,0));u+=m.from-l,l=m.from;let v=PM.build(s.setDoc(o),e,u,h);r=L1(r,r.replace(l,c,v))}return r.updateHeight(s,0)}static empty(){return new $o(0,0)}static of(e){if(e.length==1)return e[0];let t=0,s=e.length,a=0,r=0;for(;;)if(t==s)if(a>r*2){let i=e[t-1];i.break?e.splice(--t,1,i.left,null,i.right):e.splice(--t,1,i.left,i.right),s+=1+i.break,a-=i.size}else if(r>a*2){let i=e[s];i.break?e.splice(s,1,i.left,null,i.right):e.splice(s,1,i.left,i.right),s+=2+i.break,r-=i.size}else break;else if(a<r){let i=e[t++];i&&(a+=i.size)}else{let i=e[--s];i&&(r+=i.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,s++),new Koe(Er.of(e.slice(0,t)),o,Er.of(e.slice(s)))}}function L1(n,e){return n==e?n:(n.constructor!=e.constructor&&(rm=!0),e)}Er.prototype.size=1;class h6 extends Er{constructor(e,t,s){super(e,t),this.deco=s}blockAt(e,t,s,a){return new Cl(a,this.length,s,this.height,this.deco||0)}lineAt(e,t,s,a,r){return this.blockAt(0,s,a,r)}forEachLine(e,t,s,a,r,o){e<=r+this.length&&t>=r&&o(this.blockAt(0,s,a,r))}updateHeight(e,t=0,s=!1,a){return a&&a.from<=t&&a.more&&this.setHeight(a.heights[a.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class $o extends h6{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,s,a){return new Cl(a,this.length,s,this.height,this.breaks)}replace(e,t,s){let a=s[0];return s.length==1&&(a instanceof $o||a instanceof Xa&&a.flags&4)&&Math.abs(this.length-a.length)<10?(a instanceof Xa?a=new $o(a.length,this.height):a.height=this.height,this.outdated||(a.outdated=!1),a):Er.of(s)}updateHeight(e,t=0,s=!1,a){return a&&a.from<=t&&a.more?this.setHeight(a.heights[a.index++]):(s||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Xa extends Er{constructor(e){super(e,0)}heightMetrics(e,t){let s=e.doc.lineAt(t).number,a=e.doc.lineAt(t+this.length).number,r=a-s+1,o,i=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*r);o=l/r,this.length>r+1&&(i=(this.height-l)/(this.length-r-1))}else o=this.height/r;return{firstLine:s,lastLine:a,perLine:o,perChar:i}}blockAt(e,t,s,a){let{firstLine:r,lastLine:o,perLine:i,perChar:l}=this.heightMetrics(t,a);if(t.lineWrapping){let c=a+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-s)/this.height))*this.length)),u=t.doc.lineAt(c),h=i+u.length*l,m=Math.max(s,e-h/2);return new Cl(u.from,u.length,m,h,0)}else{let c=Math.max(0,Math.min(o-r,Math.floor((e-s)/i))),{from:u,length:h}=t.doc.line(r+c);return new Cl(u,h,s+i*c,i,0)}}lineAt(e,t,s,a,r){if(t==Qs.ByHeight)return this.blockAt(e,s,a,r);if(t==Qs.ByPosNoHeight){let{from:f,to:v}=s.doc.lineAt(e);return new Cl(f,v-f,0,0,0)}let{firstLine:o,perLine:i,perChar:l}=this.heightMetrics(s,r),c=s.doc.lineAt(e),u=i+c.length*l,h=c.number-o,m=a+i*h+l*(c.from-r-h);return new Cl(c.from,c.length,Math.max(a,Math.min(m,a+this.height-u)),u,0)}forEachLine(e,t,s,a,r,o){e=Math.max(e,r),t=Math.min(t,r+this.length);let{firstLine:i,perLine:l,perChar:c}=this.heightMetrics(s,r);for(let u=e,h=a;u<=t;){let m=s.doc.lineAt(u);if(u==e){let v=m.number-i;h+=l*v+c*(e-r-v)}let f=l+c*m.length;o(new Cl(m.from,m.length,h,f,0)),h+=f,u=m.to+1}}replace(e,t,s){let a=this.length-t;if(a>0){let r=s[s.length-1];r instanceof Xa?s[s.length-1]=new Xa(r.length+a):s.push(null,new Xa(a-1))}if(e>0){let r=s[0];r instanceof Xa?s[0]=new Xa(e+r.length):s.unshift(new Xa(e-1),null)}return Er.of(s)}decomposeLeft(e,t){t.push(new Xa(e-1),null)}decomposeRight(e,t){t.push(null,new Xa(this.length-e-1))}updateHeight(e,t=0,s=!1,a){let r=t+this.length;if(a&&a.from<=t+this.length&&a.more){let o=[],i=Math.max(t,a.from),l=-1;for(a.from>t&&o.push(new Xa(a.from-t-1).updateHeight(e,t));i<=r&&a.more;){let u=e.doc.lineAt(i).length;o.length&&o.push(null);let h=a.heights[a.index++];l==-1?l=h:Math.abs(h-l)>=Gb&&(l=-2);let m=new $o(u,h);m.outdated=!1,o.push(m),i+=u+1}i<=r&&o.push(null,new Xa(r-i).updateHeight(e,i));let c=Er.of(o);return(l<0||Math.abs(c.height-this.height)>=Gb||Math.abs(l-this.heightMetrics(e,t).perLine)>=Gb)&&(rm=!0),L1(this,c)}else(s||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Koe extends Er{constructor(e,t,s){super(e.length+t+s.length,e.height+s.height,t|(e.outdated||s.outdated?2:0)),this.left=e,this.right=s,this.size=e.size+s.size}get break(){return this.flags&1}blockAt(e,t,s,a){let r=s+this.left.height;return e<r?this.left.blockAt(e,t,s,a):this.right.blockAt(e,t,r,a+this.left.length+this.break)}lineAt(e,t,s,a,r){let o=a+this.left.height,i=r+this.left.length+this.break,l=t==Qs.ByHeight?e<o:e<i,c=l?this.left.lineAt(e,t,s,a,r):this.right.lineAt(e,t,s,o,i);if(this.break||(l?c.to<i:c.from>i))return c;let u=t==Qs.ByPosNoHeight?Qs.ByPosNoHeight:Qs.ByPos;return l?c.join(this.right.lineAt(i,u,s,o,i)):this.left.lineAt(i,u,s,a,r).join(c)}forEachLine(e,t,s,a,r,o){let i=a+this.left.height,l=r+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,s,a,r,o),t>=l&&this.right.forEachLine(e,t,s,i,l,o);else{let c=this.lineAt(l,Qs.ByPos,s,a,r);e<c.from&&this.left.forEachLine(e,c.from-1,s,a,r,o),c.to>=e&&c.from<=t&&o(c),t>c.to&&this.right.forEachLine(c.to+1,t,s,i,l,o)}}replace(e,t,s){let a=this.left.length+this.break;if(t<a)return this.balanced(this.left.replace(e,t,s),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-a,t-a,s));let r=[];e>0&&this.decomposeLeft(e,r);let o=r.length;for(let i of s)r.push(i);if(e>0&&rD(r,o-1),t<this.length){let i=r.length;this.decomposeRight(t,r),rD(r,i)}return Er.of(r)}decomposeLeft(e,t){let s=this.left.length;if(e<=s)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(s++,e>=s&&t.push(null)),e>s&&this.right.decomposeLeft(e-s,t)}decomposeRight(e,t){let s=this.left.length,a=s+this.break;if(e>=a)return this.right.decomposeRight(e-a,t);e<s&&this.left.decomposeRight(e,t),this.break&&e<a&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Er.of(this.break?[e,null,t]:[e,t]):(this.left=L1(this.left,e),this.right=L1(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,s=!1,a){let{left:r,right:o}=this,i=t+r.length+this.break,l=null;return a&&a.from<=t+r.length&&a.more?l=r=r.updateHeight(e,t,s,a):r.updateHeight(e,t,s),a&&a.from<=i+o.length&&a.more?l=o=o.updateHeight(e,i,s,a):o.updateHeight(e,i,s),l?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function rD(n,e){let t,s;n[e]==null&&(t=n[e-1])instanceof Xa&&(s=n[e+1])instanceof Xa&&n.splice(e-1,3,new Xa(t.length+1+s.length))}const Joe=5;class PM{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let s=Math.min(t,this.lineEnd),a=this.nodes[this.nodes.length-1];a instanceof $o?a.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new $o(s-this.pos,-1)),this.writtenTo=s,t>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,s){if(e<t||s.heightRelevant){let a=s.widget?s.widget.estimatedHeight:0,r=s.widget?s.widget.lineBreaks:0;a<0&&(a=this.oracle.lineHeight);let o=t-e;s.block?this.addBlock(new h6(o,a,s)):(o||r||a>=Joe)&&this.addLineDeco(a,r,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new $o(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let s=new Xa(t-e);return this.oracle.doc.lineAt(e).to==t&&(s.flags|=4),s}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof $o)return e;let t=new $o(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,s){let a=this.ensureLine();a.length+=s,a.collapsed+=s,a.widgetHeight=Math.max(a.widgetHeight,e),a.breaks+=t,this.writtenTo=this.pos=this.pos+s}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof $o)&&!this.isCovered?this.nodes.push(new $o(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=e;for(let a of this.nodes)a instanceof $o&&a.updateHeight(this.oracle,s),s+=a?a.length:1;return this.nodes}static build(e,t,s,a){let r=new PM(s,e);return ss.spans(t,s,a,r,0),r.finish(s)}}function eie(n,e,t){let s=new tie;return ss.compare(n,e,t,s,0),s.changes}class tie{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,s,a){(e<t||s&&s.heightRelevant||a&&a.heightRelevant)&&zb(e,t,this.changes,5)}}function nie(n,e){let t=n.getBoundingClientRect(),s=n.ownerDocument,a=s.defaultView||window,r=Math.max(0,t.left),o=Math.min(a.innerWidth,t.right),i=Math.max(0,t.top),l=Math.min(a.innerHeight,t.bottom);for(let c=n.parentNode;c&&c!=s.body;)if(c.nodeType==1){let u=c,h=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&h.overflow!="visible"){let m=u.getBoundingClientRect();r=Math.max(r,m.left),o=Math.min(o,m.right),i=Math.max(i,m.top),l=Math.min(c==n.parentNode?a.innerHeight:l,m.bottom)}c=h.position=="absolute"||h.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:r-t.left,right:Math.max(r,o)-t.left,top:i-(t.top+e),bottom:Math.max(i,l)-(t.top+e)}}function sie(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function aie(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class _O{constructor(e,t,s,a){this.from=e,this.to=t,this.size=s,this.displaySize=a}static same(e,t){if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++){let a=e[s],r=t[s];if(a.from!=r.from||a.to!=r.to||a.size!=r.size)return!1}return!0}draw(e,t){return Et.replace({widget:new rie(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class rie extends ol{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class oD{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=iD,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Es.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(OM).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new Hoe(t),this.stateDeco=e.facet(Vf).filter(s=>typeof s!="function"),this.heightMap=Er.empty().applyChanges(this.stateDeco,rs.empty,this.heightOracle.setDoc(e.doc),[new gi(0,0,0,e.doc.length)]);for(let s=0;s<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());s++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Et.set(this.lineGaps.map(s=>s.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let s=0;s<=1;s++){let a=s?t.head:t.anchor;if(!e.some(({from:r,to:o})=>a>=r&&a<=o)){let{from:r,to:o}=this.lineBlockAt(a);e.push(new P0(r,o))}}return this.viewports=e.sort((s,a)=>s.from-a.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?iD:new SM(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Yp(e,this.scaler))})}update(e,t=null){this.state=e.state;let s=this.stateDeco;this.stateDeco=this.state.facet(Vf).filter(u=>typeof u!="function");let a=e.changedRanges,r=gi.extendWithRanges(a,eie(s,this.stateDeco,e?e.changes:ka.empty(this.state.doc.length))),o=this.heightMap.height,i=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);aD(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=o||rm)&&(e.flags|=2),i?(this.scrollAnchorPos=e.changes.mapPos(i.from,-1),this.scrollAnchorHeight=i.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(zB)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,s=window.getComputedStyle(t),a=this.heightOracle,r=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?Es.RTL:Es.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),i=t.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=i.height;this.contentDOMHeight=i.height,this.mustMeasureContent=!1;let c=0,u=0;if(i.width&&i.height){let{scaleX:D,scaleY:F}=vB(t,i);(D>.005&&Math.abs(this.scaleX-D)>.005||F>.005&&Math.abs(this.scaleY-F)>.005)&&(this.scaleX=D,this.scaleY=F,c|=16,o=l=!0)}let h=(parseInt(s.paddingTop)||0)*this.scaleY,m=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=m)&&(this.paddingTop=h,this.paddingBottom=m,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(a.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let f=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=f&&(this.scrollAnchorHeight=-1,this.scrollTop=f),this.scrolledToBottom=xB(e.scrollDOM);let v=(this.printing?aie:nie)(t,this.paddingTop),O=v.top-this.pixelViewport.top,k=v.bottom-this.pixelViewport.bottom;this.pixelViewport=v;let M=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(M!=this.inView&&(this.inView=M,M&&(l=!0)),!this.inView&&!this.scrollTarget&&!sie(e.dom))return 0;let E=i.width;if((this.contentDOMWidth!=E||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=i.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let D=e.docView.measureVisibleLineHeights(this.viewport);if(a.mustRefreshForHeights(D)&&(o=!0),o||a.lineWrapping&&Math.abs(E-this.contentDOMWidth)>a.charWidth){let{lineHeight:F,charWidth:_,textHeight:$}=e.docView.measureTextSize();o=F>0&&a.refresh(r,F,_,$,Math.max(5,E/_),D),o&&(e.docView.minWidth=0,c|=16)}O>0&&k>0?u=Math.max(O,k):O<0&&k<0&&(u=Math.min(O,k)),aD();for(let F of this.viewports){let _=F.from==this.viewport.from?D:e.docView.measureVisibleLineHeights(F);this.heightMap=(o?Er.empty().applyChanges(this.stateDeco,rs.empty,this.heightOracle,[new gi(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(a,0,o,new Yoe(F.from,_))}rm&&(c|=2)}let I=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return I&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||I)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let s=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),a=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:i}=this,l=new P0(a.lineAt(o-s*1e3,Qs.ByHeight,r,0,0).from,a.lineAt(i+(1-s)*1e3,Qs.ByHeight,r,0,0).to);if(t){let{head:c}=t.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=a.lineAt(c,Qs.ByPos,r,0,0),m;t.y=="center"?m=(h.top+h.bottom)/2-u/2:t.y=="start"||t.y=="nearest"&&c<l.from?m=h.top:m=h.bottom-u,l=new P0(a.lineAt(m-1e3/2,Qs.ByHeight,r,0,0).from,a.lineAt(m+u+1e3/2,Qs.ByHeight,r,0,0).to)}}return l}mapViewport(e,t){let s=t.mapPos(e.from,-1),a=t.mapPos(e.to,1);return new P0(this.heightMap.lineAt(s,Qs.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(a,Qs.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},s=0){if(!this.inView)return!0;let{top:a}=this.heightMap.lineAt(e,Qs.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(t,Qs.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:i}=this;return(e==0||a<=o-Math.max(10,Math.min(-s,250)))&&(t==this.state.doc.length||r>=i+Math.max(10,Math.min(s,250)))&&a>o-2*1e3&&r<i+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let s=[];for(let a of e)t.touchesRange(a.from,a.to)||s.push(new _O(t.mapPos(a.from),t.mapPos(a.to),a.size,a.displaySize));return s}ensureLineGaps(e,t){let s=this.heightOracle.lineWrapping,a=s?1e4:2e3,r=a>>1,o=a<<1;if(this.defaultTextDirection!=Es.LTR&&!s)return[];let i=[],l=(u,h,m,f)=>{if(h-u<r)return;let v=this.state.selection.main,O=[v.from];v.empty||O.push(v.to);for(let M of O)if(M>u&&M<h){l(u,M-10,m,f),l(M+10,h,m,f);return}let k=iie(e,M=>M.from>=m.from&&M.to<=m.to&&Math.abs(M.from-u)<r&&Math.abs(M.to-h)<r&&!O.some(E=>M.from<E&&M.to>E));if(!k){if(h<m.to&&t&&s&&t.visibleRanges.some(I=>I.from<=h&&I.to>=h)){let I=t.moveToLineBoundary(Ve.cursor(h),!1,!0).head;I>u&&(h=I)}let M=this.gapSize(m,u,h,f),E=s||M<2e6?M:2e6;k=new _O(u,h,M,E)}i.push(k)},c=u=>{if(u.length<o||u.type!=Ar.Text)return;let h=oie(u.from,u.to,this.stateDeco);if(h.total<o)return;let m=this.scrollTarget?this.scrollTarget.range.head:null,f,v;if(s){let O=a/this.heightOracle.lineLength*this.heightOracle.lineHeight,k,M;if(m!=null){let E=C0(h,m),I=((this.visibleBottom-this.visibleTop)/2+O)/u.height;k=E-I,M=E+I}else k=(this.visibleTop-u.top-O)/u.height,M=(this.visibleBottom-u.top+O)/u.height;f=S0(h,k),v=S0(h,M)}else{let O=h.total*this.heightOracle.charWidth,k=a*this.heightOracle.charWidth,M=0;if(O>2e6)for(let _ of e)_.from>=u.from&&_.from<u.to&&_.size!=_.displaySize&&_.from*this.heightOracle.charWidth+M<this.pixelViewport.left&&(M=_.size-_.displaySize);let E=this.pixelViewport.left+M,I=this.pixelViewport.right+M,D,F;if(m!=null){let _=C0(h,m),$=((I-E)/2+k)/O;D=_-$,F=_+$}else D=(E-k)/O,F=(I+k)/O;f=S0(h,D),v=S0(h,F)}f>u.from&&l(u.from,f,u,h),v<u.to&&l(v,u.to,u,h)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return i}gapSize(e,t,s,a){let r=C0(a,s)-C0(a,t);return this.heightOracle.lineWrapping?e.height*r:a.total*this.heightOracle.charWidth*r}updateLineGaps(e){_O.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Et.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let s=[];ss.spans(t,this.viewport.from,this.viewport.to,{span(r,o){s.push({from:r,to:o})},point(){}},20);let a=0;if(s.length!=this.visibleRanges.length)a=12;else for(let r=0;r<s.length&&!(a&8);r++){let o=this.visibleRanges[r],i=s[r];(o.from!=i.from||o.to!=i.to)&&(a|=4,e&&e.mapPos(o.from,-1)==i.from&&e.mapPos(o.to,1)==i.to||(a|=8))}return this.visibleRanges=s,a}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Yp(this.heightMap.lineAt(e,Qs.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Yp(this.heightMap.lineAt(this.scaler.fromDOM(e),Qs.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Yp(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class P0{constructor(e,t){this.from=e,this.to=t}}function oie(n,e,t){let s=[],a=n,r=0;return ss.spans(t,n,e,{span(){},point(o,i){o>a&&(s.push({from:a,to:o}),r+=o-a),a=i}},20),a<e&&(s.push({from:a,to:e}),r+=e-a),{total:r,ranges:s}}function S0({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let s=Math.floor(n*t);for(let a=0;;a++){let{from:r,to:o}=e[a],i=o-r;if(s<=i)return r+s;s-=i}}function C0(n,e){let t=0;for(let{from:s,to:a}of n.ranges){if(e<=a){t+=e-s;break}t+=a-s}return t/n.total}function iie(n,e){for(let t of n)if(e(t))return t}const iD={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};class SM{constructor(e,t,s){let a=0,r=0,o=0;this.viewports=s.map(({from:i,to:l})=>{let c=t.lineAt(i,Qs.ByPos,e,0,0).top,u=t.lineAt(l,Qs.ByPos,e,0,0).bottom;return a+=u-c,{from:i,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-a)/(t.height-a);for(let i of this.viewports)i.domTop=o+(i.top-r)*this.scale,o=i.domBottom=i.domTop+(i.bottom-i.top),r=i.bottom}toDOM(e){for(let t=0,s=0,a=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return a+(e-s)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);s=r.bottom,a=r.domBottom}}fromDOM(e){for(let t=0,s=0,a=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return s+(e-a)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);s=r.bottom,a=r.domBottom}}eq(e){return e instanceof SM?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,s)=>t.from==e.viewports[s].from&&t.to==e.viewports[s].to):!1}}function Yp(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),s=e.toDOM(n.bottom);return new Cl(n.from,n.length,t,s-t,Array.isArray(n._content)?n._content.map(a=>Yp(a,e)):n._content)}const M0=Lt.define({combine:n=>n.join(" ")}),KP=Lt.define({combine:n=>n.indexOf(!0)>-1}),JP=ku.newName(),d6=ku.newName(),m6=ku.newName(),p6={"&light":"."+d6,"&dark":"."+m6};function e2(n,e,t){return new ku(e,{finish(s){return/&/.test(s)?s.replace(/&\w*/,a=>{if(a=="&")return n;if(!t||!t[a])throw new RangeError(`Unsupported selector: ${a}`);return t[a]}):n+" "+s}})}const lie=e2("."+JP,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},p6),cie={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},LO=At.ie&&At.ie_version<=11;class uie{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Xre,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let s of t)this.queue.push(s);(At.ie&&At.ie_version<=11||At.ios&&e.composing)&&t.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&At.android&&e.constructor.EDIT_CONTEXT!==!1&&!(At.chrome&&At.chrome_version<126)&&(this.editContext=new die(e),e.state.facet(Oc)&&(e.contentDOM.editContext=this.editContext.editContext)),LO&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,s)=>t!=e[s]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,a=this.selectionRange;if(s.state.facet(Oc)?s.root.activeElement!=this.dom:!Zb(this.dom,a))return;let r=a.anchorNode&&s.docView.nearest(a.anchorNode);if(r&&r.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(At.ie&&At.ie_version<=11||At.android&&At.chrome)&&!s.state.selection.main.empty&&a.focusNode&&gf(a.focusNode,a.focusOffset,a.anchorNode,a.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=If(e.root);if(!t)return!1;let s=At.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&hie(this.view,t)||t;if(!s||this.selectionRange.eq(s))return!1;let a=Zb(this.dom,s);return a&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&qre(this.dom,s)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(s),a&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let s=this.dom;s;)if(s.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==s?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=t)s.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,cie),LO&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),LO&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var s;if(!this.delayedAndroidKey){let a=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&Dd(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(a)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,s=-1,a=!1;for(let r of e){let o=this.readMutation(r);o&&(o.typeOver&&(a=!0),t==-1?{from:t,to:s}=o:(t=Math.min(o.from,t),s=Math.max(o.to,s)))}return{from:t,to:s,typeOver:a}}readChange(){let{from:e,to:t,typeOver:s}=this.processRecords(),a=this.selectionChanged&&Zb(this.dom,this.selectionRange);if(e<0&&!a)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new Eoe(this.view,e,t,s);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let s=this.view.state,a=t6(this.view,t);return this.view.state==s&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),a}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let s=lD(t,e.previousSibling||e.target.previousSibling,-1),a=lD(t,e.nextSibling||e.target.nextSibling,1);return{from:s?t.posAfter(s):t.posAtStart,to:a?t.posBefore(a):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Oc)!=e.state.facet(Oc)&&(e.view.contentDOM.editContext=e.state.facet(Oc)?this.editContext.editContext:null))}destroy(){var e,t,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect();for(let a of this.scrollTargets)a.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function lD(n,e,t){for(;e;){let s=ks.get(e);if(s&&s.parent==n)return s;let a=e.parentNode;e=a!=n.dom?a:t>0?e.nextSibling:e.previousSibling}return null}function cD(n,e){let t=e.startContainer,s=e.startOffset,a=e.endContainer,r=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return gf(o.node,o.offset,a,r)&&([t,s,a,r]=[a,r,t,s]),{anchorNode:t,anchorOffset:s,focusNode:a,focusOffset:r}}function hie(n,e){if(e.getComposedRanges){let a=e.getComposedRanges(n.root)[0];if(a)return cD(n,a)}let t=null;function s(a){a.preventDefault(),a.stopImmediatePropagation(),t=a.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",s,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",s,!0),t?cD(n,t):null}class die{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=s=>{let a=e.state.selection.main,{anchor:r,head:o}=a,i=this.toEditorPos(s.updateRangeStart),l=this.toEditorPos(s.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:s.updateRangeStart,editorBase:i,drifted:!1});let c=l-i>s.text.length;i==this.from&&r<this.from?i=r:l==this.to&&r>this.to&&(l=r);let u=n6(e.state.sliceDoc(i,l),s.text,(c?a.from:a.to)-i,c?"end":null);if(!u){let m=Ve.single(this.toEditorPos(s.selectionStart),this.toEditorPos(s.selectionEnd));m.main.eq(a)||e.dispatch({selection:m,userEvent:"select"});return}let h={from:u.from+i,to:u.toA+i,insert:rs.of(s.text.slice(u.from,u.toB).split(`
`))};if((At.mac||At.android)&&h.from==o-1&&/^\. ?$/.test(s.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(h={from:i,to:l,insert:rs.of([s.text.replace("."," ")])}),this.pendingContextChange=h,!e.state.readOnly){let m=this.to-this.from+(h.to-h.from+h.insert.length);kM(e,h,Ve.single(this.toEditorPos(s.selectionStart,m),this.toEditorPos(s.selectionEnd,m)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),h.from<h.to&&!h.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,s.updateRangeStart-1),Math.min(t.text.length,s.updateRangeStart+1)))&&this.handlers.compositionend(s)},this.handlers.characterboundsupdate=s=>{let a=[],r=null;for(let o=this.toEditorPos(s.rangeStart),i=this.toEditorPos(s.rangeEnd);o<i;o++){let l=e.coordsForChar(o);r=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||r||new DOMRect,a.push(r)}t.updateCharacterBounds(s.rangeStart,a)},this.handlers.textformatupdate=s=>{let a=[];for(let r of s.getTextFormats()){let o=r.underlineStyle,i=r.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(i)){let l=this.toEditorPos(r.rangeStart),c=this.toEditorPos(r.rangeEnd);if(l<c){let u=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(i)?1:2}px`;a.push(Et.mark({attributes:{style:u}}).range(l,c))}}}e.dispatch({effects:XB.of(Et.set(a))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:s}=this.composing;this.composing=null,s&&this.reset(e.state)}};for(let s in this.handlers)t.addEventListener(s,this.handlers[s]);this.measureReq={read:s=>{this.editContext.updateControlBounds(s.contentDOM.getBoundingClientRect());let a=If(s.root);a&&a.rangeCount&&this.editContext.updateSelectionBounds(a.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,s=!1,a=this.pendingContextChange;return e.changes.iterChanges((r,o,i,l,c)=>{if(s)return;let u=c.length-(o-r);if(a&&o>=a.to)if(a.from==r&&a.to==o&&a.insert.eq(c)){a=this.pendingContextChange=null,t+=u,this.to+=u;return}else a=null,this.revertPending(e.state);if(r+=t,o+=t,o<=this.from)this.from+=u,this.to+=u;else if(r<this.to){if(r<this.from||o>this.to||this.to-this.from+c.length>3e4){s=!0;return}this.editContext.updateText(this.toContextPos(r),this.toContextPos(o),c.toString()),this.to+=u}t+=u}),a&&!s&&this.revertPending(e.state),!s}update(e){let t=this.pendingContextChange,s=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(s.from,s.to)&&e.transactions.some(a=>!a.isUserEvent("input.type")&&a.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,s=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),a=this.toContextPos(t.head);(this.editContext.selectionStart!=s||this.editContext.selectionEnd!=a)&&this.editContext.updateSelection(s,a)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let s=this.composing;return s&&s.drifted?s.editorBase+(e-s.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class ut{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:s}=e;this.dispatchTransactions=e.dispatchTransactions||s&&(a=>a.forEach(r=>s(r,this)))||(a=>this.update(a)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Wre(e.parent)||document,this.viewState=new oD(e.state||cs.create(e)),e.scrollTo&&e.scrollTo.is(O0)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(gd).map(a=>new BO(a));for(let a of this.plugins)a.update(this);this.observer=new uie(this),this.inputState=new Noe(this),this.inputState.ensureHandlers(this.plugins),this.docView=new VE(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof ba?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,s=!1,a,r=this.state;for(let m of e){if(m.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=m.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,i=0,l=null;e.some(m=>m.annotation(l6))?(this.inputState.notifiedFocused=o,i=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=c6(r,o),l||(i=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(u=null)):this.observer.clear(),r.facet(cs.phrases)!=this.state.facet(cs.phrases))return this.setState(r);a=_1.create(this,r,e),a.flags|=i;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let m of e){if(h&&(h=h.map(m.changes)),m.scrollIntoView){let{main:f}=m.state.selection;h=new Td(f.empty?f:Ve.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of m.effects)f.is(O0)&&(h=f.value.clip(this.state))}this.viewState.update(a,h),this.bidiCache=I1.update(this.bidiCache,a.changes),a.empty||(this.updatePlugins(a),this.inputState.update(a)),t=this.docView.update(a),this.state.facet(Up)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(a.startState.facet(M0)!=a.state.facet(M0)&&(this.viewState.mustMeasureContent=!0),(t||s||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!a.empty)for(let m of this.state.facet(qP))try{m(a)}catch(f){oo(this.state,f,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!t6(this,u)&&c.force&&Dd(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new oD(e),this.plugins=e.facet(gd).map(s=>new BO(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView.destroy(),this.docView=new VE(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(gd),s=e.state.facet(gd);if(t!=s){let a=[];for(let r of s){let o=t.indexOf(r);if(o<0)a.push(new BO(r));else{let i=this.plugins[o];i.mustUpdate=e,a.push(i)}}for(let r of this.plugins)r.mustUpdate!=e&&r.destroy(this);this.plugins=a,this.pluginMap.clear()}else for(let a of this.plugins)a.mustUpdate=e;for(let a=0;a<this.plugins.length;a++)this.plugins[a].update(this);t!=s&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(s){oo(this.state,s,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,s=this.scrollDOM,a=s.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(a-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let i=0;;i++){if(o<0)if(xB(s))r=-1,o=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(a);r=f.from,o=f.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(i>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(f=>{try{return f.read(this)}catch(v){return oo(this.state,v),uD}}),h=_1.create(this,this.state,[]),m=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),m=this.docView.update(h),m&&this.docViewUpdate());for(let f=0;f<c.length;f++)if(u[f]!=uD)try{let v=c[f];v.write&&v.write(u[f],this)}catch(v){oo(this.state,v)}if(m&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let v=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(v>1||v<-1){a=a+v,s.scrollTop=a/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let i of this.state.facet(qP))i(t)}get themeClasses(){return JP+" "+(this.state.facet(KP)?m6:d6)+" "+this.state.facet(M0)}updateAttrs(){let e=hD(this,WB,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Oc)?"true":"false",class:"cm-content",style:`${At.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),hD(this,OM,t);let s=this.observer.ignore(()=>{let a=ZP(this.contentDOM,this.contentAttrs,t),r=ZP(this.dom,this.editorAttrs,e);return a||r});return this.editorAttrs=e,this.contentAttrs=t,s}showAnnouncements(e){let t=!0;for(let s of e)for(let a of s.effects)if(a.is(ut.announce)){t&&(this.announceDOM.textContent=""),t=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=a.value}}mountStyles(){this.styleModules=this.state.facet(Up);let e=this.state.facet(ut.cspNonce);ku.mount(this.root,this.styleModules.concat(lie).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(s=>s.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,s){return RO(this,e,XE(this,e,t,s))}moveByGroup(e,t){return RO(this,e,XE(this,e,t,s=>Poe(this,e.head,s)))}visualLineSide(e,t){let s=this.bidiSpans(e),a=this.textDirectionAt(e.from),r=s[t?s.length-1:0];return Ve.cursor(r.side(t,a)+e.from,r.forward(!t,a)?1:-1)}moveToLineBoundary(e,t,s=!0){return koe(this,e,t,s)}moveVertically(e,t,s){return RO(this,e,Soe(this,e,t,s))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),KB(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let s=this.docView.coordsAt(e,t);if(!s||s.left==s.right)return s;let a=this.state.doc.lineAt(e),r=this.bidiSpans(a),o=r[ru.find(r,e-a.from,-1,t)];return qv(s,o.dir==Es.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ZB)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>mie)return $B(e.length);let t=this.textDirectionAt(e.from),s;for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t&&(r.fresh||BB(r.isolates,s=QE(this,e))))return r.order;s||(s=QE(this,e));let a=ioe(e.text,t,s);return this.bidiCache.push(new I1(e.from,e.to,t,s,!0,a)),a}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||At.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{wB(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return O0.of(new Td(typeof e=="number"?Ve.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,s=this.viewState.scrollAnchorAt(e);return O0.of(new Td(Ve.cursor(s.from),"start","start",s.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Ks.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Ks.define(()=>({}),{eventObservers:e})}static theme(e,t){let s=ku.newName(),a=[M0.of(s),Up.of(e2(`.${s}`,e))];return t&&t.dark&&a.push(KP.of(!0)),a}static baseTheme(e){return jo.lowest(Up.of(e2("."+JP,e,p6)))}static findFromDOM(e){var t;let s=e.querySelector(".cm-content"),a=s&&ks.get(s)||ks.get(e);return((t=a==null?void 0:a.rootView)===null||t===void 0?void 0:t.view)||null}}ut.styleModule=Up;ut.inputHandler=VB;ut.clipboardInputFilter=vM;ut.clipboardOutputFilter=wM;ut.scrollHandler=GB;ut.focusChangeEffect=jB;ut.perLineTextDirection=ZB;ut.exceptionSink=QB;ut.updateListener=qP;ut.editable=Oc;ut.mouseSelectionStyle=IB;ut.dragMovesSelection=LB;ut.clickAddsSelectionRange=_B;ut.decorations=Vf;ut.outerDecorations=qB;ut.atomicRanges=_g;ut.bidiIsolatedRanges=UB;ut.scrollMargins=HB;ut.darkTheme=KP;ut.cspNonce=Lt.define({combine:n=>n.length?n[0]:""});ut.contentAttributes=OM;ut.editorAttributes=WB;ut.lineWrapping=ut.contentAttributes.of({class:"cm-lineWrapping"});ut.announce=cn.define();const mie=4096,uD={};class I1{constructor(e,t,s,a,r,o){this.from=e,this.to=t,this.dir=s,this.isolates=a,this.fresh=r,this.order=o}static update(e,t){if(t.empty&&!e.some(r=>r.fresh))return e;let s=[],a=e.length?e[e.length-1].dir:Es.LTR;for(let r=Math.max(0,e.length-10);r<e.length;r++){let o=e[r];o.dir==a&&!t.touchesRange(o.from,o.to)&&s.push(new I1(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return s}}function hD(n,e,t){for(let s=n.state.facet(e),a=s.length-1;a>=0;a--){let r=s[a],o=typeof r=="function"?r(n):r;o&&jP(o,t)}return t}const pie=At.mac?"mac":At.windows?"win":At.linux?"linux":"key";function fie(n,e){const t=n.split(/-(?!$)/);let s=t[t.length-1];s=="Space"&&(s=" ");let a,r,o,i;for(let l=0;l<t.length-1;++l){const c=t[l];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))a=!0;else if(/^(c|ctrl|control)$/i.test(c))r=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?i=!0:r=!0;else throw new Error("Unrecognized modifier name: "+c)}return a&&(s="Alt-"+s),r&&(s="Ctrl-"+s),i&&(s="Meta-"+s),o&&(s="Shift-"+s),s}function A0(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const gie=jo.default(ut.domEventHandlers({keydown(n,e){return g6(f6(e.state),n,e,"editor")}})),Qc=Lt.define({enables:gie}),dD=new WeakMap;function f6(n){let e=n.facet(Qc),t=dD.get(e);return t||dD.set(e,t=yie(e.reduce((s,a)=>s.concat(a),[]))),t}function sh(n,e,t){return g6(f6(n.state),e,n,t)}let tu=null;const bie=4e3;function yie(n,e=pie){let t=Object.create(null),s=Object.create(null),a=(o,i)=>{let l=s[o];if(l==null)s[o]=i;else if(l!=i)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,i,l,c,u)=>{var h,m;let f=t[o]||(t[o]=Object.create(null)),v=i.split(/ (?!$)/).map(M=>fie(M,e));for(let M=1;M<v.length;M++){let E=v.slice(0,M).join(" ");a(E,!0),f[E]||(f[E]={preventDefault:!0,stopPropagation:!1,run:[I=>{let D=tu={view:I,prefix:E,scope:o};return setTimeout(()=>{tu==D&&(tu=null)},bie),!0}]})}let O=v.join(" ");a(O,!1);let k=f[O]||(f[O]={preventDefault:!1,stopPropagation:!1,run:((m=(h=f._any)===null||h===void 0?void 0:h.run)===null||m===void 0?void 0:m.slice())||[]});l&&k.run.push(l),c&&(k.preventDefault=!0),u&&(k.stopPropagation=!0)};for(let o of n){let i=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of i){let u=t[c]||(t[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=o;for(let m in u)u[m].run.push(f=>h(f,t2))}let l=o[e]||o.key;if(l)for(let c of i)r(c,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&r(c,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return t}let t2=null;function g6(n,e,t,s){t2=e;let a=Vre(e),r=so(a,0),o=Sl(r)==a.length&&a!=" ",i="",l=!1,c=!1,u=!1;tu&&tu.view==t&&tu.scope==s&&(i=tu.prefix+" ",a6.indexOf(e.keyCode)<0&&(c=!0,tu=null));let h=new Set,m=k=>{if(k){for(let M of k.run)if(!h.has(M)&&(h.add(M),M(t)))return k.stopPropagation&&(u=!0),!0;k.preventDefault&&(k.stopPropagation&&(u=!0),c=!0)}return!1},f=n[s],v,O;return f&&(m(f[i+A0(a,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(At.windows&&e.ctrlKey&&e.altKey)&&!(At.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(v=Pu[e.keyCode])&&v!=a?(m(f[i+A0(v,e,!0)])||e.shiftKey&&(O=Lf[e.keyCode])!=a&&O!=v&&m(f[i+A0(O,e,!1)]))&&(l=!0):o&&e.shiftKey&&m(f[i+A0(a,e,!0)])&&(l=!0),!l&&m(f._any)&&(l=!0)),c&&(l=!0),l&&u&&e.stopPropagation(),t2=null,l}class Lg{constructor(e,t,s,a,r){this.className=e,this.left=t,this.top=s,this.width=a,this.height=r}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,s){if(s.empty){let a=e.coordsAtPos(s.head,s.assoc||1);if(!a)return[];let r=b6(e);return[new Lg(t,a.left-r.left,a.top-r.top,null,a.bottom-a.top)]}else return vie(e,t,s)}}function b6(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Es.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function mD(n,e,t,s){let a=n.coordsAtPos(e,t*2);if(!a)return s;let r=n.dom.getBoundingClientRect(),o=(a.top+a.bottom)/2,i=n.posAtCoords({x:r.left+1,y:o}),l=n.posAtCoords({x:r.right-1,y:o});return i==null||l==null?s:{from:Math.max(s.from,Math.min(i,l)),to:Math.min(s.to,Math.max(i,l))}}function vie(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let s=Math.max(t.from,n.viewport.from),a=Math.min(t.to,n.viewport.to),r=n.textDirection==Es.LTR,o=n.contentDOM,i=o.getBoundingClientRect(),l=b6(n),c=o.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),h=i.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),m=i.right-(u?parseInt(u.paddingRight):0),f=HP(n,s,1),v=HP(n,a,-1),O=f.type==Ar.Text?f:null,k=v.type==Ar.Text?v:null;if(O&&(n.lineWrapping||f.widgetLineBreaks)&&(O=mD(n,s,1,O)),k&&(n.lineWrapping||v.widgetLineBreaks)&&(k=mD(n,a,-1,k)),O&&k&&O.from==k.from&&O.to==k.to)return E(I(t.from,t.to,O));{let F=O?I(t.from,null,O):D(f,!1),_=k?I(null,t.to,k):D(v,!0),$=[];return(O||f).to<(k||v).from-(O&&k?1:0)||f.widgetLineBreaks>1&&F.bottom+n.defaultLineHeight/2<_.top?$.push(M(h,F.bottom,m,_.top)):F.bottom<_.top&&n.elementAtHeight((F.bottom+_.top)/2).type==Ar.Text&&(F.bottom=_.top=(F.bottom+_.top)/2),E(F).concat($).concat(E(_))}function M(F,_,$,Z){return new Lg(e,F-l.left,_-l.top,$-F,Z-_)}function E({top:F,bottom:_,horizontal:$}){let Z=[];for(let ce=0;ce<$.length;ce+=2)Z.push(M($[ce],F,$[ce+1],_));return Z}function I(F,_,$){let Z=1e9,ce=-1e9,U=[];function ue(be,ke,Ce,Ae,q){let Ne=n.coordsAtPos(be,be==$.to?-2:2),Re=n.coordsAtPos(Ce,Ce==$.from?2:-2);!Ne||!Re||(Z=Math.min(Ne.top,Re.top,Z),ce=Math.max(Ne.bottom,Re.bottom,ce),q==Es.LTR?U.push(r&&ke?h:Ne.left,r&&Ae?m:Re.right):U.push(!r&&Ae?h:Re.left,!r&&ke?m:Ne.right))}let W=F??$.from,de=_??$.to;for(let be of n.visibleRanges)if(be.to>W&&be.from<de)for(let ke=Math.max(be.from,W),Ce=Math.min(be.to,de);;){let Ae=n.state.doc.lineAt(ke);for(let q of n.bidiSpans(Ae)){let Ne=q.from+Ae.from,Re=q.to+Ae.from;if(Ne>=Ce)break;Re>ke&&ue(Math.max(Ne,ke),F==null&&Ne<=W,Math.min(Re,Ce),_==null&&Re>=de,q.dir)}if(ke=Ae.to+1,ke>=Ce)break}return U.length==0&&ue(W,F==null,de,_==null,n.textDirection),{top:Z,bottom:ce,horizontal:U}}function D(F,_){let $=i.top+(_?F.top:F.bottom);return{top:$,bottom:$,horizontal:[]}}}function wie(n,e){return n.constructor==e.constructor&&n.eq(e)}class Oie{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Xb)!=e.state.facet(Xb)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,s=e.facet(Xb);for(;t<s.length&&s[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,s)=>!wie(t,this.drawn[s]))){let t=this.dom.firstChild,s=0;for(let a of e)a.update&&t&&a.constructor&&this.drawn[s].constructor&&a.update(t,this.drawn[s])?(t=t.nextSibling,s++):this.dom.insertBefore(a.draw(),t);for(;t;){let a=t.nextSibling;t.remove(),t=a}this.drawn=e,At.safari&&At.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Xb=Lt.define();function y6(n){return[Ks.define(e=>new Oie(e,n)),Xb.of(n)]}const om=Lt.define({combine(n){return Kl(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function xie(n={}){return[om.of(n),kie,Pie,Sie,zB.of(!0)]}function v6(n){return n.facet(om)}function w6(n){return n.startState.facet(om)!=n.state.facet(om)}const kie=y6({above:!0,markers(n){let{state:e}=n,t=e.facet(om),s=[];for(let a of e.selection.ranges){let r=a==e.selection.main;if(a.empty||t.drawRangeCursor){let o=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",i=a.empty?a:Ve.cursor(a.head,a.head>a.anchor?-1:1);for(let l of Lg.forRange(n,o,i))s.push(l)}}return s},update(n,e){n.transactions.some(s=>s.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=w6(n);return t&&pD(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){pD(e.state,n)},class:"cm-cursorLayer"});function pD(n,e){e.style.animationDuration=n.facet(om).cursorBlinkRate+"ms"}const Pie=y6({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Lg.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||w6(n)},class:"cm-selectionLayer"}),Sie=jo.highest(ut.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),O6=cn.define({map(n,e){return n==null?null:e.mapPos(n)}}),Kp=zs.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,s)=>s.is(O6)?s.value:t,n)}}),Cie=Ks.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Kp);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Kp)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(Kp),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let s=n.scrollDOM.getBoundingClientRect();return{left:t.left-s.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-s.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Kp)!=n&&this.view.dispatch({effects:O6.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Mie(){return[Kp,Cie]}function fD(n,e,t,s,a){e.lastIndex=0;for(let r=n.iterRange(t,s),o=t,i;!r.next().done;o+=r.value.length)if(!r.lineBreak)for(;i=e.exec(r.value);)a(o+i.index,i)}function Aie(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let s=[];for(let{from:a,to:r}of t)a=Math.max(n.state.doc.lineAt(a).from,a-e),r=Math.min(n.state.doc.lineAt(r).to,r+e),s.length&&s[s.length-1].to>=a?s[s.length-1].to=r:s.push({from:a,to:r});return s}class Eie{constructor(e){const{regexp:t,decoration:s,decorate:a,boundary:r,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,a)this.addMatch=(i,l,c,u)=>a(u,c,c+i[0].length,i,l);else if(typeof s=="function")this.addMatch=(i,l,c,u)=>{let h=s(i,l,c);h&&u(c,c+i[0].length,h)};else if(s)this.addMatch=(i,l,c,u)=>u(c,c+i[0].length,s);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=r,this.maxLength=o}createDeco(e){let t=new Hi,s=t.add.bind(t);for(let{from:a,to:r}of Aie(e,this.maxLength))fD(e.state.doc,this.regexp,a,r,(o,i)=>this.addMatch(i,e,o,s));return t.finish()}updateDeco(e,t){let s=1e9,a=-1;return e.docChanged&&e.changes.iterChanges((r,o,i,l)=>{l>=e.view.viewport.from&&i<=e.view.viewport.to&&(s=Math.min(i,s),a=Math.max(l,a))}),e.viewportMoved||a-s>1e3?this.createDeco(e.view):a>-1?this.updateRange(e.view,t.map(e.changes),s,a):t}updateRange(e,t,s,a){for(let r of e.visibleRanges){let o=Math.max(r.from,s),i=Math.min(r.to,a);if(i>=o){let l=e.state.doc.lineAt(o),c=l.to<i?e.state.doc.lineAt(i):l,u=Math.max(r.from,l.from),h=Math.min(r.to,c.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){u=o;break}for(;i<c.to;i++)if(this.boundary.test(c.text[i-c.from])){h=i;break}}let m=[],f,v=(O,k,M)=>m.push(M.range(O,k));if(l==c)for(this.regexp.lastIndex=u-l.from;(f=this.regexp.exec(l.text))&&f.index<h-l.from;)this.addMatch(f,e,f.index+l.from,v);else fD(e.state.doc,this.regexp,u,h,(O,k)=>this.addMatch(k,e,O,v));t=t.update({filterFrom:u,filterTo:h,filter:(O,k)=>O<u||k>h,add:m})}}return t}}const n2=/x/.unicode!=null?"gu":"g",Die=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,n2),Tie={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let IO=null;function Fie(){var n;if(IO==null&&typeof document<"u"&&document.body){let e=document.body.style;IO=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return IO||!1}const Wb=Lt.define({combine(n){let e=Kl(n,{render:null,specialChars:Die,addSpecialChars:null});return(e.replaceTabs=!Fie())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,n2)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,n2)),e}});function x6(n={}){return[Wb.of(n),Nie()]}let gD=null;function Nie(){return gD||(gD=Ks.fromClass(class{constructor(n){this.view=n,this.decorations=Et.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(Wb)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new Eie({regexp:n.specialChars,decoration:(e,t,s)=>{let{doc:a}=t.state,r=so(e[0],0);if(r==9){let o=a.lineAt(s),i=t.state.tabSize,l=Bm(o.text,i,s-o.from);return Et.replace({widget:new _ie((i-l%i)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[r]||(this.decorationCache[r]=Et.replace({widget:new Rie(n,r)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(Wb);n.startState.facet(Wb)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const Bie="•";function $ie(n){return n>=32?Bie:n==10?"␤":String.fromCharCode(9216+n)}class Rie extends ol{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=$ie(this.code),s=e.state.phrase("Control character")+" "+(Tie[this.code]||"0x"+this.code.toString(16)),a=this.options.render&&this.options.render(this.code,s,t);if(a)return a;let r=document.createElement("span");return r.textContent=t,r.title=s,r.setAttribute("aria-label",s),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class _ie extends ol{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Lie(){return Qie}const Iie=Et.line({class:"cm-activeLine"}),Qie=Ks.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let s of n.state.selection.ranges){let a=n.lineBlockAt(s.head);a.from>e&&(t.push(Iie.range(a.from)),e=a.from)}return Et.set(t)}},{decorations:n=>n.decorations}),s2=2e3;function Vie(n,e,t){let s=Math.min(e.line,t.line),a=Math.max(e.line,t.line),r=[];if(e.off>s2||t.off>s2||e.col<0||t.col<0){let o=Math.min(e.off,t.off),i=Math.max(e.off,t.off);for(let l=s;l<=a;l++){let c=n.doc.line(l);c.length<=i&&r.push(Ve.range(c.from+o,c.to+i))}}else{let o=Math.min(e.col,t.col),i=Math.max(e.col,t.col);for(let l=s;l<=a;l++){let c=n.doc.line(l),u=BP(c.text,o,n.tabSize,!0);if(u<0)r.push(Ve.cursor(c.to));else{let h=BP(c.text,i,n.tabSize);r.push(Ve.range(c.from+u,c.from+h))}}}return r}function jie(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function bD(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),s=n.state.doc.lineAt(t),a=t-s.from,r=a>s2?-1:a==s.length?jie(n,e.clientX):Bm(s.text,n.state.tabSize,t-s.from);return{line:s.number,col:r,off:a}}function Zie(n,e){let t=bD(n,e),s=n.state.selection;return t?{update(a){if(a.docChanged){let r=a.changes.mapPos(a.startState.doc.line(t.line).from),o=a.state.doc.lineAt(r);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},s=s.map(a.changes)}},get(a,r,o){let i=bD(n,a);if(!i)return s;let l=Vie(n.state,t,i);return l.length?o?Ve.create(l.concat(s.ranges)):Ve.create(l):s}}:null}function zie(n){let e=(t=>t.altKey&&t.button==0);return ut.mouseSelectionStyle.of((t,s)=>e(s)?Zie(t,s):null)}const Gie={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},Xie={style:"cursor: crosshair"};function Wie(n={}){let[e,t]=Gie[n.key||"Alt"],s=Ks.fromClass(class{constructor(a){this.view=a,this.isDown=!1}set(a){this.isDown!=a&&(this.isDown=a,this.view.update([]))}},{eventObservers:{keydown(a){this.set(a.keyCode==e||t(a))},keyup(a){(a.keyCode==e||!t(a))&&this.set(!1)},mousemove(a){this.set(t(a))}}});return[s,ut.contentAttributes.of(a=>{var r;return!((r=a.plugin(s))===null||r===void 0)&&r.isDown?Xie:null})]}const pp="-10000px";class k6{constructor(e,t,s,a){this.facet=t,this.createTooltipView=s,this.removeTooltipView=a,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let r=null;this.tooltipViews=this.tooltips.map(o=>r=s(o,r))}update(e,t){var s;let a=e.state.facet(this.facet),r=a.filter(l=>l);if(a===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],i=t?[]:null;for(let l=0;l<r.length;l++){let c=r[l],u=-1;if(c){for(let h=0;h<this.tooltips.length;h++){let m=this.tooltips[h];m&&m.create==c.create&&(u=h)}if(u<0)o[l]=this.createTooltipView(c,l?o[l-1]:null),i&&(i[l]=!!c.above);else{let h=o[l]=this.tooltipViews[u];i&&(i[l]=t[u]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(s=l.destroy)===null||s===void 0||s.call(l));return t&&(i.forEach((l,c)=>t[c]=l),t.length=i.length),this.input=a,this.tooltips=r,this.tooltipViews=o,!0}}function qie(n){let e=n.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const QO=Lt.define({combine:n=>{var e,t,s;return{position:At.ios?"absolute":((e=n.find(a=>a.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(a=>a.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((s=n.find(a=>a.tooltipSpace))===null||s===void 0?void 0:s.tooltipSpace)||qie}}}),yD=new WeakMap,CM=Ks.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(QO);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new k6(n,MM,(t,s)=>this.createTooltip(t,s),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,s=n.state.facet(QO);if(s.position!=this.position&&!this.madeAbsolute){this.position=s.position;for(let a of this.manager.tooltipViews)a.dom.style.position=this.position;t=!0}if(s.parent!=this.parent){this.parent&&this.container.remove(),this.parent=s.parent,this.createContainer();for(let a of this.manager.tooltipViews)this.container.appendChild(a.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),s=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let a=document.createElement("div");a.className="cm-tooltip-arrow",t.dom.appendChild(a)}return t.dom.style.position=this.position,t.dom.style.top=pp,t.dom.style.left="0px",this.container.insertBefore(t.dom,s),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let s of this.manager.tooltipViews)s.dom.remove(),(n=s.destroy)===null||n===void 0||n.call(s);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(At.gecko)t=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==pp&&r.style.left=="0px"){let o=r.getBoundingClientRect();t=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(t||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(n=r.width/this.parent.offsetWidth,e=r.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let s=this.view.scrollDOM.getBoundingClientRect(),a=xM(this.view);return{visible:{left:s.left+a.left,top:s.top+a.top,right:s.right-a.right,bottom:s.bottom-a.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((r,o)=>{let i=this.manager.tooltipViews[o];return i.getCoords?i.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(QO).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let i of this.manager.tooltipViews)i.dom.style.position="absolute"}let{visible:t,space:s,scaleX:a,scaleY:r}=n,o=[];for(let i=0;i<this.manager.tooltips.length;i++){let l=this.manager.tooltips[i],c=this.manager.tooltipViews[i],{dom:u}=c,h=n.pos[i],m=n.size[i];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,s.top)||h.top>=Math.min(t.bottom,s.bottom)||h.right<Math.max(t.left,s.left)-.1||h.left>Math.min(t.right,s.right)+.1)){u.style.top=pp;continue}let f=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,v=f?7:0,O=m.right-m.left,k=(e=yD.get(c))!==null&&e!==void 0?e:m.bottom-m.top,M=c.offset||Hie,E=this.view.textDirection==Es.LTR,I=m.width>s.right-s.left?E?s.left:s.right-m.width:E?Math.max(s.left,Math.min(h.left-(f?14:0)+M.x,s.right-O)):Math.min(Math.max(s.left,h.left-O+(f?14:0)-M.x),s.right-O),D=this.above[i];!l.strictSide&&(D?h.top-k-v-M.y<s.top:h.bottom+k+v+M.y>s.bottom)&&D==s.bottom-h.bottom>h.top-s.top&&(D=this.above[i]=!D);let F=(D?h.top-s.top:s.bottom-h.bottom)-v;if(F<k&&c.resize!==!1){if(F<this.view.defaultLineHeight){u.style.top=pp;continue}yD.set(c,k),u.style.height=(k=F)/r+"px"}else u.style.height&&(u.style.height="");let _=D?h.top-k-v-M.y:h.bottom+v+M.y,$=I+O;if(c.overlap!==!0)for(let Z of o)Z.left<$&&Z.right>I&&Z.top<_+k&&Z.bottom>_&&(_=D?Z.top-k-2-v:Z.bottom+v+2);if(this.position=="absolute"?(u.style.top=(_-n.parent.top)/r+"px",vD(u,(I-n.parent.left)/a)):(u.style.top=_/r+"px",vD(u,I/a)),f){let Z=h.left+(E?M.x:-M.x)-(I+14-7);f.style.left=Z/a+"px"}c.overlap!==!0&&o.push({left:I,top:_,right:$,bottom:_+k}),u.classList.toggle("cm-tooltip-above",D),u.classList.toggle("cm-tooltip-below",!D),c.positioned&&c.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=pp}},{eventObservers:{scroll(){this.maybeMeasure()}}});function vD(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const Uie=ut.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Hie={x:0,y:0},MM=Lt.define({enables:[CM,Uie]}),Q1=Lt.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class Hv{static create(e){return new Hv(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new k6(e,Q1,(t,s)=>this.createHostedView(t,s),t=>t.dom.remove())}createHostedView(e,t){let s=e.create(this.view);return s.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(s.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&s.mount&&s.mount(this.view),s}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let s of this.manager.tooltipViews){let a=s[e];if(a!==void 0){if(t===void 0)t=a;else if(t!==a)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const Yie=MM.compute([Q1],n=>{let e=n.facet(Q1);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var s;return(s=t.end)!==null&&s!==void 0?s:t.pos})),create:Hv.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Kie{constructor(e,t,s,a,r){this.view=e,this.source=t,this.field=s,this.setHover=a,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,s=e.docView.nearest(t.target);if(!s)return;let a,r=1;if(s instanceof au)a=s.posAtStart;else{if(a=e.posAtCoords(t),a==null)return;let i=e.coordsAtPos(a);if(!i||t.y<i.top||t.y>i.bottom||t.x<i.left-e.defaultCharacterWidth||t.x>i.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(a)).find(u=>u.from<=a&&u.to>=a),c=l&&l.dir==Es.RTL?-1:1;r=t.x<i.left?-c:c}let o=this.source(e,a,r);if(o!=null&&o.then){let i=this.pending={pos:a};o.then(l=>{this.pending==i&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>oo(e.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(CM),t=e?e.manager.tooltips.findIndex(s=>s.create==Hv.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,s;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:a,tooltip:r}=this;if(a.length&&r&&!Jie(r.dom,e)||this.pending){let{pos:o}=a[0]||this.pending,i=(s=(t=a[0])===null||t===void 0?void 0:t.end)!==null&&s!==void 0?s:o;(o==i?this.view.posAtCoords(this.lastMove)!=o:!ele(this.view,o,i,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:s}=this;s&&s.dom.contains(e.relatedTarget)?this.watchTooltipLeave(s.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=s=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(s.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const E0=4;function Jie(n,e){let{left:t,right:s,top:a,bottom:r}=n.getBoundingClientRect(),o;if(o=n.querySelector(".cm-tooltip-arrow")){let i=o.getBoundingClientRect();a=Math.min(i.top,a),r=Math.max(i.bottom,r)}return e.clientX>=t-E0&&e.clientX<=s+E0&&e.clientY>=a-E0&&e.clientY<=r+E0}function ele(n,e,t,s,a,r){let o=n.scrollDOM.getBoundingClientRect(),i=n.documentTop+n.documentPadding.top+n.contentHeight;if(o.left>s||o.right<s||o.top>a||Math.min(o.bottom,i)<a)return!1;let l=n.posAtCoords({x:s,y:a},!1);return l>=e&&l<=t}function P6(n,e={}){let t=cn.define(),s=zs.define({create(){return[]},update(a,r){if(a.length&&(e.hideOnChange&&(r.docChanged||r.selection)?a=[]:e.hideOn&&(a=a.filter(o=>!e.hideOn(r,o))),r.docChanged)){let o=[];for(let i of a){let l=r.changes.mapPos(i.pos,-1,fa.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),i);c.pos=l,c.end!=null&&(c.end=r.changes.mapPos(c.end)),o.push(c)}}a=o}for(let o of r.effects)o.is(t)&&(a=o.value),o.is(tle)&&(a=[]);return a},provide:a=>Q1.from(a)});return{active:s,extension:[s,Ks.define(a=>new Kie(a,n,s,t,e.hoverTime||300)),Yie]}}function S6(n,e){let t=n.plugin(CM);if(!t)return null;let s=t.manager.tooltips.indexOf(e);return s<0?null:t.manager.tooltipViews[s]}const tle=cn.define(),wD=Lt.define({combine(n){let e,t;for(let s of n)e=e||s.topContainer,t=t||s.bottomContainer;return{topContainer:e,bottomContainer:t}}});function jf(n,e){let t=n.plugin(C6),s=t?t.specs.indexOf(e):-1;return s>-1?t.panels[s]:null}const C6=Ks.fromClass(class{constructor(n){this.input=n.state.facet(Cu),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(wD);this.top=new D0(n,!0,e.topContainer),this.bottom=new D0(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(wD);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new D0(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new D0(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Cu);if(t!=this.input){let s=t.filter(l=>l),a=[],r=[],o=[],i=[];for(let l of s){let c=this.specs.indexOf(l),u;c<0?(u=l(n.view),i.push(u)):(u=this.panels[c],u.update&&u.update(n)),a.push(u),(u.top?r:o).push(u)}this.specs=s,this.panels=a,this.top.sync(r),this.bottom.sync(o);for(let l of i)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let s of this.panels)s.update&&s.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>ut.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class D0{constructor(e,t,s){this.view=e,this.top=t,this.container=s,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=OD(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=OD(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function OD(n){let e=n.nextSibling;return n.remove(),e}const Cu=Lt.define({enables:C6});class Tc extends Rh{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Tc.prototype.elementClass="";Tc.prototype.toDOM=void 0;Tc.prototype.mapMode=fa.TrackBefore;Tc.prototype.startSide=Tc.prototype.endSide=-1;Tc.prototype.point=!0;const qb=Lt.define(),nle=Lt.define(),sle={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>ss.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},vf=Lt.define();function ale(n){return[M6(),vf.of({...sle,...n})]}const xD=Lt.define({combine:n=>n.some(e=>e)});function M6(n){return[rle]}const rle=Ks.fromClass(class{constructor(n){this.view=n,this.domAfter=null,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(vf).map(e=>new PD(n,e)),this.fixed=!n.state.facet(xD);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,s=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(s<(t.to-t.from)*.8)}if(n.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(xD)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=ss.iter(this.view.state.facet(qb),this.view.viewport.from),s=[],a=this.gutters.map(r=>new ole(r,this.view.viewport,-this.view.documentPadding.top));for(let r of this.view.viewportLineBlocks)if(s.length&&(s=[]),Array.isArray(r.type)){let o=!0;for(let i of r.type)if(i.type==Ar.Text&&o){a2(t,s,i.from);for(let l of a)l.line(this.view,i,s);o=!1}else if(i.widget)for(let l of a)l.widget(this.view,i)}else if(r.type==Ar.Text){a2(t,s,r.from);for(let o of a)o.line(this.view,r,s)}else if(r.widget)for(let o of a)o.widget(this.view,r);for(let r of a)r.finish();n&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(n){let e=n.startState.facet(vf),t=n.state.facet(vf),s=n.docChanged||n.heightChanged||n.viewportChanged||!ss.eq(n.startState.facet(qb),n.state.facet(qb),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let a of this.gutters)a.update(n)&&(s=!0);else{s=!0;let a=[];for(let r of t){let o=e.indexOf(r);o<0?a.push(new PD(this.view,r)):(this.gutters[o].update(n),a.push(this.gutters[o]))}for(let r of this.gutters)r.dom.remove(),a.indexOf(r)<0&&r.destroy();for(let r of a)r.config.side=="after"?this.getDOMAfter().appendChild(r.dom):this.dom.appendChild(r.dom);this.gutters=a}return s}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:n=>ut.scrollMargins.of(e=>{let t=e.plugin(n);if(!t||t.gutters.length==0||!t.fixed)return null;let s=t.dom.offsetWidth*e.scaleX,a=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==Es.LTR?{left:s,right:a}:{right:s,left:a}})});function kD(n){return Array.isArray(n)?n:[n]}function a2(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class ole{constructor(e,t,s){this.gutter=e,this.height=s,this.i=0,this.cursor=ss.iter(e.markers,t.from)}addElement(e,t,s){let{gutter:a}=this,r=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==a.elements.length){let i=new A6(e,o,r,s);a.elements.push(i),a.dom.appendChild(i.dom)}else a.elements[this.i].update(e,o,r,s);this.height=t.bottom,this.i++}line(e,t,s){let a=[];a2(this.cursor,a,t.from),s.length&&(a=a.concat(s));let r=this.gutter.config.lineMarker(e,t,a);r&&a.unshift(r);let o=this.gutter;a.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,a)}widget(e,t){let s=this.gutter.config.widgetMarker(e,t.widget,t),a=s?[s]:null;for(let r of e.state.facet(nle)){let o=r(e,t.widget,t);o&&(a||(a=[])).push(o)}a&&this.addElement(e,t,a)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class PD{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in t.domEventHandlers)this.dom.addEventListener(s,a=>{let r=a.target,o;if(r!=this.dom&&this.dom.contains(r)){for(;r.parentNode!=this.dom;)r=r.parentNode;let l=r.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=a.clientY;let i=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[s](e,i,a)&&a.preventDefault()});this.markers=kD(t.markers(e)),t.initialSpacer&&(this.spacer=new A6(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=kD(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let a=this.config.updateSpacer(this.spacer.markers[0],e);a!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[a])}let s=e.view.viewport;return!ss.eq(this.markers,t,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class A6{constructor(e,t,s,a){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,s,a)}update(e,t,s,a){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),ile(this.markers,a)||this.setMarkers(e,a)}setMarkers(e,t){let s="cm-gutterElement",a=this.dom.firstChild;for(let r=0,o=0;;){let i=o,l=r<t.length?t[r++]:null,c=!1;if(l){let u=l.elementClass;u&&(s+=" "+u);for(let h=o;h<this.markers.length;h++)if(this.markers[h].compare(l)){i=h,c=!0;break}}else i=this.markers.length;for(;o<i;){let u=this.markers[o++];if(u.toDOM){u.destroy(a);let h=a.nextSibling;a.remove(),a=h}}if(!l)break;l.toDOM&&(c?a=a.nextSibling:this.dom.insertBefore(l.toDOM(e),a)),c&&o++}this.dom.className=s,this.markers=t}destroy(){this.setMarkers(null,[])}}function ile(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const lle=Lt.define(),cle=Lt.define(),bd=Lt.define({combine(n){return Kl(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let s=Object.assign({},e);for(let a in t){let r=s[a],o=t[a];s[a]=r?(i,l,c)=>r(i,l,c)||o(i,l,c):o}return s}})}});class VO extends Tc{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function jO(n,e){return n.state.facet(bd).formatNumber(e,n.state)}const ule=vf.compute([bd],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(lle)},lineMarker(e,t,s){return s.some(a=>a.toDOM)?null:new VO(jO(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,s)=>{for(let a of e.state.facet(cle)){let r=a(e,t,s);if(r)return r}return null},lineMarkerChange:e=>e.startState.facet(bd)!=e.state.facet(bd),initialSpacer(e){return new VO(jO(e,SD(e.state.doc.lines)))},updateSpacer(e,t){let s=jO(t.view,SD(t.view.state.doc.lines));return s==e.number?e:new VO(s)},domEventHandlers:n.facet(bd).domEventHandlers,side:"before"}));function r2(n={}){return[bd.of(n),M6(),ule]}function SD(n){let e=9;for(;e<n;)e=e*10+9;return e}const hle=new class extends Tc{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},dle=qb.compute(["selection"],n=>{let e=[],t=-1;for(let s of n.selection.ranges){let a=n.doc.lineAt(s.head).from;a>t&&(t=a,e.push(hle.range(a)))}return ss.of(e)});function mle(){return dle}const E6=1024;let ple=0;class ZO{constructor(e,t){this.from=e,this.to=t}}class jn{constructor(e={}){this.id=ple++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=po.match(e)),t=>{let s=e(t);return s===void 0?null:[this,s]}}}jn.closedBy=new jn({deserialize:n=>n.split(" ")});jn.openedBy=new jn({deserialize:n=>n.split(" ")});jn.group=new jn({deserialize:n=>n.split(" ")});jn.isolate=new jn({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});jn.contextHash=new jn({perNode:!0});jn.lookAhead=new jn({perNode:!0});jn.mounted=new jn({perNode:!0});class V1{constructor(e,t,s){this.tree=e,this.overlay=t,this.parser=s}static get(e){return e&&e.props&&e.props[jn.mounted.id]}}const fle=Object.create(null);class po{constructor(e,t,s,a=0){this.name=e,this.props=t,this.id=s,this.flags=a}static define(e){let t=e.props&&e.props.length?Object.create(null):fle,s=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),a=new po(e.name||"",t,e.id,s);if(e.props){for(let r of e.props)if(Array.isArray(r)||(r=r(a)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}}return a}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(jn.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let s in e)for(let a of s.split(" "))t[a]=e[s];return s=>{for(let a=s.prop(jn.group),r=-1;r<(a?a.length:0);r++){let o=t[r<0?s.name:a[r]];if(o)return o}}}}po.none=new po("",Object.create(null),0,8);class AM{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let s of this.types){let a=null;for(let r of e){let o=r(s);if(o){a||(a=Object.assign({},s.props));let i=o[1],l=o[0];l.combine&&l.id in a&&(i=l.combine(a[l.id],i)),a[l.id]=i}}t.push(a?new po(s.name,a,s.id,s.flags):s)}return new AM(t)}}const T0=new WeakMap,CD=new WeakMap;var Sa;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(Sa||(Sa={}));class ya{constructor(e,t,s,a,r){if(this.type=e,this.children=t,this.positions=s,this.length=a,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,i]of r)this.props[typeof o=="number"?o:o.id]=i}}toString(){let e=V1.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let s of this.children){let a=s.toString();a&&(t&&(t+=","),t+=a)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new i2(this.topNode,e)}cursorAt(e,t=0,s=0){let a=T0.get(this)||this.topNode,r=new i2(a);return r.moveTo(e,t),T0.set(this,r._tree),r}get topNode(){return new ho(this,0,0,null)}resolve(e,t=0){let s=Zf(T0.get(this)||this.topNode,e,t,!1);return T0.set(this,s),s}resolveInner(e,t=0){let s=Zf(CD.get(this)||this.topNode,e,t,!0);return CD.set(this,s),s}resolveStack(e,t=0){return yle(this,e,t)}iterate(e){let{enter:t,leave:s,from:a=0,to:r=this.length}=e,o=e.mode||0,i=(o&Sa.IncludeAnonymous)>0;for(let l=this.cursor(o|Sa.IncludeAnonymous);;){let c=!1;if(l.from<=r&&l.to>=a&&(!i&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&s&&(i||!l.type.isAnonymous)&&s(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:TM(po.none,this.children,this.positions,0,this.children.length,0,this.length,(t,s,a)=>new ya(this.type,t,s,a,this.propValues),e.makeTree||((t,s,a)=>new ya(po.none,t,s,a)))}static build(e){return vle(e)}}ya.empty=new ya(po.none,[],[],0);class EM{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new EM(this.buffer,this.index)}}class Mu{constructor(e,t,s){this.buffer=e,this.length=t,this.set=s}get type(){return po.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],s=this.buffer[e+3],a=this.set.types[t],r=a.name;if(/\W/.test(r)&&!a.isError&&(r=JSON.stringify(r)),e+=4,s==e)return r;let o=[];for(;e<s;)o.push(this.childString(e)),e=this.buffer[e+3];return r+"("+o.join(",")+")"}findChild(e,t,s,a,r){let{buffer:o}=this,i=-1;for(let l=e;l!=t&&!(D6(r,a,o[l+1],o[l+2])&&(i=l,s>0));l=o[l+3]);return i}slice(e,t,s){let a=this.buffer,r=new Uint16Array(t-e),o=0;for(let i=e,l=0;i<t;){r[l++]=a[i++],r[l++]=a[i++]-s;let c=r[l++]=a[i++]-s;r[l++]=a[i++]-e,o=Math.max(o,c)}return new Mu(r,o,this.set)}}function D6(n,e,t,s){switch(n){case-2:return t<e;case-1:return s>=e&&t<e;case 0:return t<e&&s>e;case 1:return t<=e&&s>e;case 2:return s>e;case 4:return!0}}function Zf(n,e,t,s){for(var a;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!s&&n instanceof ho&&n.index<0?null:n.parent;if(!o)return n;n=o}let r=s?0:Sa.IgnoreOverlays;if(s)for(let o=n,i=o.parent;i;o=i,i=o.parent)o instanceof ho&&o.index<0&&((a=i.enter(e,t,r))===null||a===void 0?void 0:a.from)!=o.from&&(n=i);for(;;){let o=n.enter(e,t,r);if(!o)return n;n=o}}class T6{cursor(e=0){return new i2(this,e)}getChild(e,t=null,s=null){let a=MD(this,e,t,s);return a.length?a[0]:null}getChildren(e,t=null,s=null){return MD(this,e,t,s)}resolve(e,t=0){return Zf(this,e,t,!1)}resolveInner(e,t=0){return Zf(this,e,t,!0)}matchContext(e){return o2(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),s=this;for(;t;){let a=t.lastChild;if(!a||a.to!=t.to)break;a.type.isError&&a.from==a.to?(s=t,t=a.prevSibling):t=a}return s}get node(){return this}get next(){return this.parent}}class ho extends T6{constructor(e,t,s,a){super(),this._tree=e,this.from=t,this.index=s,this._parent=a}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,s,a,r=0){for(let o=this;;){for(let{children:i,positions:l}=o._tree,c=t>0?i.length:-1;e!=c;e+=t){let u=i[e],h=l[e]+o.from;if(D6(a,s,h,h+u.length)){if(u instanceof Mu){if(r&Sa.ExcludeBuffers)continue;let m=u.findChild(0,u.buffer.length,t,s-h,a);if(m>-1)return new Dl(new gle(o,u,e,h),null,m)}else if(r&Sa.IncludeAnonymous||!u.type.isAnonymous||DM(u)){let m;if(!(r&Sa.IgnoreMounts)&&(m=V1.get(u))&&!m.overlay)return new ho(m.tree,h,e,o);let f=new ho(u,h,e,o);return r&Sa.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(t<0?u.children.length-1:0,t,s,a)}}}if(r&Sa.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,s=0){let a;if(!(s&Sa.IgnoreOverlays)&&(a=V1.get(this._tree))&&a.overlay){let r=e-this.from;for(let{from:o,to:i}of a.overlay)if((t>0?o<=r:o<r)&&(t<0?i>=r:i>r))return new ho(a.tree,a.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,s)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function MD(n,e,t,s){let a=n.cursor(),r=[];if(!a.firstChild())return r;if(t!=null){for(let o=!1;!o;)if(o=a.type.is(t),!a.nextSibling())return r}for(;;){if(s!=null&&a.type.is(s))return r;if(a.type.is(e)&&r.push(a.node),!a.nextSibling())return s==null?r:[]}}function o2(n,e,t=e.length-1){for(let s=n;t>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(e[t]&&e[t]!=s.name)return!1;t--}}return!0}class gle{constructor(e,t,s,a){this.parent=e,this.buffer=t,this.index=s,this.start=a}}class Dl extends T6{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,s){super(),this.context=e,this._parent=t,this.index=s,this.type=e.buffer.set.types[e.buffer.buffer[s]]}child(e,t,s){let{buffer:a}=this.context,r=a.findChild(this.index+4,a.buffer[this.index+3],e,t-this.context.start,s);return r<0?null:new Dl(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,s=0){if(s&Sa.ExcludeBuffers)return null;let{buffer:a}=this.context,r=a.findChild(this.index+4,a.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return r<0?null:new Dl(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Dl(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Dl(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:s}=this.context,a=this.index+4,r=s.buffer[this.index+3];if(r>a){let o=s.buffer[this.index+1];e.push(s.slice(a,r,o)),t.push(0)}return new ya(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function F6(n){if(!n.length)return null;let e=0,t=n[0];for(let r=1;r<n.length;r++){let o=n[r];(o.from>t.from||o.to<t.to)&&(t=o,e=r)}let s=t instanceof ho&&t.index<0?null:t.parent,a=n.slice();return s?a[e]=s:a.splice(e,1),new ble(a,t)}class ble{constructor(e,t){this.heads=e,this.node=t}get next(){return F6(this.heads)}}function yle(n,e,t){let s=n.resolveInner(e,t),a=null;for(let r=s instanceof ho?s:s.context.parent;r;r=r.parent)if(r.index<0){let o=r.parent;(a||(a=[s])).push(o.resolve(e,t)),r=o}else{let o=V1.get(r.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let i=new ho(o.tree,o.overlay[0].from+r.from,-1,r);(a||(a=[s])).push(Zf(i,e,t,!1))}}return a?F6(a):s}class i2{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof ho)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let s=e._parent;s;s=s._parent)this.stack.unshift(s.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:s,buffer:a}=this.buffer;return this.type=t||a.set.types[a.buffer[e]],this.from=s+a.buffer[e+1],this.to=s+a.buffer[e+2],!0}yield(e){return e?e instanceof ho?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,s){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,s,this.mode));let{buffer:a}=this.buffer,r=a.findChild(this.index+4,a.buffer[this.index+3],e,t-this.buffer.start,s);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,s=this.mode){return this.buffer?s&Sa.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,s))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Sa.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Sa.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,s=this.stack.length-1;if(e<0){let a=s<0?0:this.stack[s]+4;if(this.index!=a)return this.yieldBuf(t.findChild(a,this.index,-1,0,4))}else{let a=t.buffer[this.index+3];if(a<(s<0?t.buffer.length:t.buffer[this.stack[s]+3]))return this.yieldBuf(a)}return s<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,s,{buffer:a}=this;if(a){if(e>0){if(this.index<a.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(a.buffer.buffer[r+3]<this.index)return!1;({index:t,parent:s}=a)}else({index:t,_parent:s}=this._tree);for(;s;{index:t,_parent:s}=s)if(t>-1)for(let r=t+e,o=e<0?-1:s._tree.children.length;r!=o;r+=e){let i=s._tree.children[r];if(this.mode&Sa.IncludeAnonymous||i instanceof Mu||!i.type.isAnonymous||DM(i))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,s=0;if(e&&e.context==this.buffer)e:for(let a=this.index,r=this.stack.length;r>=0;){for(let o=e;o;o=o._parent)if(o.index==a){if(a==this.index)return o;t=o,s=r+1;break e}a=this.stack[--r]}for(let a=s;a<this.stack.length;a++)t=new Dl(this.buffer,t,this.stack[a]);return this.bufferNode=new Dl(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let s=0;;){let a=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){s++;continue}this.type.isAnonymous||(a=!0)}for(;;){if(a&&t&&t(this),a=this.type.isAnonymous,!s)return;if(this.nextSibling())break;this.parent(),s--,a=!0}}}matchContext(e){if(!this.buffer)return o2(this.node.parent,e);let{buffer:t}=this.buffer,{types:s}=t.set;for(let a=e.length-1,r=this.stack.length-1;a>=0;r--){if(r<0)return o2(this._tree,e,a);let o=s[t.buffer[this.stack[r]]];if(!o.isAnonymous){if(e[a]&&e[a]!=o.name)return!1;a--}}return!0}}function DM(n){return n.children.some(e=>e instanceof Mu||!e.type.isAnonymous||DM(e))}function vle(n){var e;let{buffer:t,nodeSet:s,maxBufferLength:a=E6,reused:r=[],minRepeatType:o=s.types.length}=n,i=Array.isArray(t)?new EM(t,t.length):t,l=s.types,c=0,u=0;function h(F,_,$,Z,ce,U){let{id:ue,start:W,end:de,size:be}=i,ke=u,Ce=c;if(be<0)if(i.next(),be==-1){let je=r[ue];$.push(je),Z.push(W-F);return}else if(be==-3){c=ue;return}else if(be==-4){u=ue;return}else throw new RangeError(`Unrecognized record size: ${be}`);let Ae=l[ue],q,Ne,Re=W-F;if(de-W<=a&&(Ne=k(i.pos-_,ce))){let je=new Uint16Array(Ne.size-Ne.skip),me=i.pos-Ne.size,Ye=je.length;for(;i.pos>me;)Ye=M(Ne.start,je,Ye);q=new Mu(je,de-Ne.start,s),Re=Ne.start-F}else{let je=i.pos-be;i.next();let me=[],Ye=[],ft=ue>=o?ue:-1,_e=0,Ge=de;for(;i.pos>je;)ft>=0&&i.id==ft&&i.size>=0?(i.end<=Ge-a&&(v(me,Ye,W,_e,i.end,Ge,ft,ke,Ce),_e=me.length,Ge=i.end),i.next()):U>2500?m(W,je,me,Ye):h(W,je,me,Ye,ft,U+1);if(ft>=0&&_e>0&&_e<me.length&&v(me,Ye,W,_e,W,Ge,ft,ke,Ce),me.reverse(),Ye.reverse(),ft>-1&&_e>0){let pt=f(Ae,Ce);q=TM(Ae,me,Ye,0,me.length,0,de-W,pt,pt)}else q=O(Ae,me,Ye,de-W,ke-de,Ce)}$.push(q),Z.push(Re)}function m(F,_,$,Z){let ce=[],U=0,ue=-1;for(;i.pos>_;){let{id:W,start:de,end:be,size:ke}=i;if(ke>4)i.next();else{if(ue>-1&&de<ue)break;ue<0&&(ue=be-a),ce.push(W,de,be),U++,i.next()}}if(U){let W=new Uint16Array(U*4),de=ce[ce.length-2];for(let be=ce.length-3,ke=0;be>=0;be-=3)W[ke++]=ce[be],W[ke++]=ce[be+1]-de,W[ke++]=ce[be+2]-de,W[ke++]=ke;$.push(new Mu(W,ce[2]-de,s)),Z.push(de-F)}}function f(F,_){return($,Z,ce)=>{let U=0,ue=$.length-1,W,de;if(ue>=0&&(W=$[ue])instanceof ya){if(!ue&&W.type==F&&W.length==ce)return W;(de=W.prop(jn.lookAhead))&&(U=Z[ue]+W.length+de)}return O(F,$,Z,ce,U,_)}}function v(F,_,$,Z,ce,U,ue,W,de){let be=[],ke=[];for(;F.length>Z;)be.push(F.pop()),ke.push(_.pop()+$-ce);F.push(O(s.types[ue],be,ke,U-ce,W-U,de)),_.push(ce-$)}function O(F,_,$,Z,ce,U,ue){if(U){let W=[jn.contextHash,U];ue=ue?[W].concat(ue):[W]}if(ce>25){let W=[jn.lookAhead,ce];ue=ue?[W].concat(ue):[W]}return new ya(F,_,$,Z,ue)}function k(F,_){let $=i.fork(),Z=0,ce=0,U=0,ue=$.end-a,W={size:0,start:0,skip:0};e:for(let de=$.pos-F;$.pos>de;){let be=$.size;if($.id==_&&be>=0){W.size=Z,W.start=ce,W.skip=U,U+=4,Z+=4,$.next();continue}let ke=$.pos-be;if(be<0||ke<de||$.start<ue)break;let Ce=$.id>=o?4:0,Ae=$.start;for($.next();$.pos>ke;){if($.size<0)if($.size==-3)Ce+=4;else break e;else $.id>=o&&(Ce+=4);$.next()}ce=Ae,Z+=be,U+=Ce}return(_<0||Z==F)&&(W.size=Z,W.start=ce,W.skip=U),W.size>4?W:void 0}function M(F,_,$){let{id:Z,start:ce,end:U,size:ue}=i;if(i.next(),ue>=0&&Z<o){let W=$;if(ue>4){let de=i.pos-(ue-4);for(;i.pos>de;)$=M(F,_,$)}_[--$]=W,_[--$]=U-F,_[--$]=ce-F,_[--$]=Z}else ue==-3?c=Z:ue==-4&&(u=Z);return $}let E=[],I=[];for(;i.pos>0;)h(n.start||0,n.bufferStart||0,E,I,-1,0);let D=(e=n.length)!==null&&e!==void 0?e:E.length?I[0]+E[0].length:0;return new ya(l[n.topID],E.reverse(),I.reverse(),D)}const AD=new WeakMap;function Ub(n,e){if(!n.isAnonymous||e instanceof Mu||e.type!=n)return 1;let t=AD.get(e);if(t==null){t=1;for(let s of e.children){if(s.type!=n||!(s instanceof ya)){t=1;break}t+=Ub(n,s)}AD.set(e,t)}return t}function TM(n,e,t,s,a,r,o,i,l){let c=0;for(let v=s;v<a;v++)c+=Ub(n,e[v]);let u=Math.ceil(c*1.5/8),h=[],m=[];function f(v,O,k,M,E){for(let I=k;I<M;){let D=I,F=O[I],_=Ub(n,v[I]);for(I++;I<M;I++){let $=Ub(n,v[I]);if(_+$>=u)break;_+=$}if(I==D+1){if(_>u){let $=v[D];f($.children,$.positions,0,$.children.length,O[D]+E);continue}h.push(v[D])}else{let $=O[I-1]+v[I-1].length-F;h.push(TM(n,v,O,D,I,F,$,null,l))}m.push(F+E-r)}}return f(e,t,s,a,0),(i||l)(h,m,o)}class wle{constructor(){this.map=new WeakMap}setBuffer(e,t,s){let a=this.map.get(e);a||this.map.set(e,a=new Map),a.set(t,s)}getBuffer(e,t){let s=this.map.get(e);return s&&s.get(t)}set(e,t){e instanceof Dl?this.setBuffer(e.context.buffer,e.index,t):e instanceof ho&&this.map.set(e.tree,t)}get(e){return e instanceof Dl?this.getBuffer(e.context.buffer,e.index):e instanceof ho?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class Sh{constructor(e,t,s,a,r=!1,o=!1){this.from=e,this.to=t,this.tree=s,this.offset=a,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],s=!1){let a=[new Sh(0,e.length,e,0,!1,s)];for(let r of t)r.to>e.length&&a.push(r);return a}static applyChanges(e,t,s=128){if(!t.length)return e;let a=[],r=1,o=e.length?e[0]:null;for(let i=0,l=0,c=0;;i++){let u=i<t.length?t[i]:null,h=u?u.fromA:1e9;if(h-l>=s)for(;o&&o.from<h;){let m=o;if(l>=m.from||h<=m.to||c){let f=Math.max(m.from,l)-c,v=Math.min(m.to,h)-c;m=f>=v?null:new Sh(f,v,m.tree,m.offset+c,i>0,!!u)}if(m&&a.push(m),o.to>h)break;o=r<e.length?e[r++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return a}}let N6=class{startParse(e,t,s){return typeof e=="string"&&(e=new Ole(e)),s=s?s.length?s.map(a=>new ZO(a.from,a.to)):[new ZO(0,0)]:[new ZO(0,e.length)],this.createParse(e,t||[],s)}parse(e,t,s){let a=this.startParse(e,t,s);for(;;){let r=a.advance();if(r)return r}}};class Ole{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new jn({perNode:!0});var ED={};class j1{constructor(e,t,s,a,r,o,i,l,c,u=0,h){this.p=e,this.stack=t,this.state=s,this.reducePos=a,this.pos=r,this.score=o,this.buffer=i,this.bufferBase=l,this.curContext=c,this.lookAhead=u,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,s=0){let a=e.parser.context;return new j1(e,[],t,s,s,0,[],0,a?new DD(a,a.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let s=e>>19,a=e&65535,{parser:r}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let i=r.dynamicPrecedence(a);if(i&&(this.score+=i),s==0){this.pushState(r.getGoto(this.state,a,!0),this.reducePos),a<r.minRepeatTerm&&this.storeNode(a,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(a,this.reducePos);return}let l=this.stack.length-(s-1)*3-(e&262144?6:0),c=l?this.stack[l-2]:this.p.ranges[0].from,u=this.reducePos-c;u>=2e3&&!(!((t=this.p.parser.nodeSet.types[a])===null||t===void 0)&&t.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=u):this.p.lastBigReductionSize<u&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=u));let h=l?this.stack[l-1]:0,m=this.bufferBase+this.buffer.length-h;if(a<r.minRepeatTerm||e&131072){let f=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(a,c,f,m+4,!0)}if(e&262144)this.state=this.stack[l];else{let f=this.stack[l-3];this.state=r.getGoto(f,a,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(a,c)}storeNode(e,t,s,a=4,r=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,i=this.buffer.length;if(i==0&&o.parent&&(i=o.bufferBase-o.parent.bufferBase,o=o.parent),i>0&&o.buffer[i-4]==0&&o.buffer[i-1]>-1){if(t==s)return;if(o.buffer[i-2]>=t){o.buffer[i-2]=s;return}}}if(!r||this.pos==s)this.buffer.push(e,t,s,a);else{let o=this.buffer.length;if(o>0&&(this.buffer[o-4]!=0||this.buffer[o-1]<0)){let i=!1;for(let l=o;l>0&&this.buffer[l-2]>s;l-=4)if(this.buffer[l-1]>=0){i=!0;break}if(i)for(;o>0&&this.buffer[o-2]>s;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,a>4&&(a-=4)}this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=s,this.buffer[o+3]=a}}shift(e,t,s,a){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let r=e,{parser:o}=this.p;(a>this.pos||t<=o.maxNode)&&(this.pos=a,o.stateFlag(r,1)||(this.reducePos=a)),this.pushState(r,s),this.shiftContext(t,s),t<=o.maxNode&&this.buffer.push(t,s,a,4)}else this.pos=a,this.shiftContext(t,s),t<=this.p.parser.maxNode&&this.buffer.push(t,s,a,4)}apply(e,t,s,a){e&65536?this.reduce(e):this.shift(e,t,s,a)}useNode(e,t){let s=this.p.reused.length-1;(s<0||this.p.reused[s]!=e)&&(this.p.reused.push(e),s++);let a=this.pos;this.reducePos=this.pos=a+e.length,this.pushState(t,a),this.buffer.push(s,a,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let s=e.buffer.slice(t),a=e.bufferBase+t;for(;e&&a==e.bufferBase;)e=e.parent;return new j1(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,s,a,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let s=e<=this.p.parser.maxNode;s&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,s?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new xle(this);;){let s=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(s==0)return!1;if((s&65536)==0)return!0;t.reduce(s)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let a=[];for(let r=0,o;r<t.length;r+=2)(o=t[r+1])!=this.state&&this.p.parser.hasAction(o,e)&&a.push(t[r],o);if(this.stack.length<120)for(let r=0;a.length<8&&r<t.length;r+=2){let o=t[r+1];a.some((i,l)=>l&1&&i==o)||a.push(t[r],o)}t=a}let s=[];for(let a=0;a<t.length&&s.length<4;a+=2){let r=t[a+1];if(r==this.state)continue;let o=this.split();o.pushState(r,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[a],this.pos),o.reducePos=this.pos,o.score-=200,s.push(o)}return s}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let s=t>>19,a=t&65535,r=this.stack.length-s*3;if(r<0||e.getGoto(this.stack[r],a,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],s=(a,r)=>{if(!t.includes(a))return t.push(a),e.allActions(a,o=>{if(!(o&393216))if(o&65536){let i=(o>>19)-r;if(i>1){let l=o&65535,c=this.stack.length-i*3;if(c>=0&&e.getGoto(this.stack[c],l,!1)>=0)return i<<19|65536|l}}else{let i=s(o,r+1);if(i!=null)return i}})};return s(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new DD(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class DD{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class xle{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,s=e>>19;s==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(s-1)*3;let a=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=a}}class Z1{constructor(e,t,s){this.stack=e,this.pos=t,this.index=s,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Z1(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Z1(this.stack,this.pos,this.index)}}function Jp(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let s=0,a=0;s<n.length;){let r=0;for(;;){let o=n.charCodeAt(s++),i=!1;if(o==126){r=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,i=!0),r+=l,i)break;r*=46}t?t[a++]=r:t=new e(r)}return t}class Hb{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const TD=new Hb;class kle{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=TD,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let s=this.range,a=this.rangeIndex,r=this.pos+e;for(;r<s.from;){if(!a)return null;let o=this.ranges[--a];r-=s.from-o.to,s=o}for(;t<0?r>s.to:r>=s.to;){if(a==this.ranges.length-1)return null;let o=this.ranges[++a];r+=o.from-s.to,s=o}return r}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,s,a;if(t>=0&&t<this.chunk.length)s=this.pos+e,a=this.chunk.charCodeAt(t);else{let r=this.resolveOffset(e,1);if(r==null)return-1;if(s=r,s>=this.chunk2Pos&&s<this.chunk2Pos+this.chunk2.length)a=this.chunk2.charCodeAt(s-this.chunk2Pos);else{let o=this.rangeIndex,i=this.range;for(;i.to<=s;)i=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=s),s+this.chunk2.length>i.to&&(this.chunk2=this.chunk2.slice(0,i.to-s)),a=this.chunk2.charCodeAt(0)}}return s>=this.token.lookAhead&&(this.token.lookAhead=s+1),a}acceptToken(e,t=0){let s=t?this.resolveOffset(t,-1):this.pos;if(s==null||s<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=s}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=TD,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let s="";for(let a of this.ranges){if(a.from>=t)break;a.to>e&&(s+=this.input.read(Math.max(a.from,e),Math.min(a.to,t)))}return s}}class Fd{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:s}=t.p;B6(this.data,e,t,this.id,s.data,s.tokenPrecTable)}}Fd.prototype.contextual=Fd.prototype.fallback=Fd.prototype.extend=!1;class l2{constructor(e,t,s){this.precTable=t,this.elseToken=s,this.data=typeof e=="string"?Jp(e):e}token(e,t){let s=e.pos,a=0;for(;;){let r=e.next<0,o=e.resolveOffset(1,1);if(B6(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(r||a++,o==null)break;e.reset(o,e.token)}a&&(e.reset(s,e.token),e.acceptToken(this.elseToken,a))}}l2.prototype.contextual=Fd.prototype.fallback=Fd.prototype.extend=!1;class Ig{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function B6(n,e,t,s,a,r){let o=0,i=1<<s,{dialect:l}=t.p.parser;e:for(;(i&n[o])!=0;){let c=n[o+1];for(let f=o+3;f<c;f+=2)if((n[f+1]&i)>0){let v=n[f];if(l.allows(v)&&(e.token.value==-1||e.token.value==v||Ple(v,e.token.value,a,r))){e.acceptToken(v);break}}let u=e.next,h=0,m=n[o+2];if(e.next<0&&m>h&&n[c+m*3-3]==65535){o=n[c+m*3-1];continue e}for(;h<m;){let f=h+m>>1,v=c+f+(f<<1),O=n[v],k=n[v+1]||65536;if(u<O)m=f;else if(u>=k)h=f+1;else{o=n[v+2],e.advance();continue e}}break}}function FD(n,e,t){for(let s=e,a;(a=n[s])!=65535;s++)if(a==t)return s-e;return-1}function Ple(n,e,t,s){let a=FD(t,s,e);return a<0||FD(t,s,n)<a}const Po=typeof process<"u"&&ED&&/\bparse\b/.test(ED.LOG);let zO=null;function ND(n,e,t){let s=n.cursor(Sa.IncludeAnonymous);for(s.moveTo(e);;)if(!(t<0?s.childBefore(e):s.childAfter(e)))for(;;){if((t<0?s.to<e:s.from>e)&&!s.type.isError)return t<0?Math.max(0,Math.min(s.to-1,e-25)):Math.min(n.length,Math.max(s.from+1,e+25));if(t<0?s.prevSibling():s.nextSibling())break;if(!s.parent())return t<0?0:n.length}}class Sle{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?ND(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?ND(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let s=this.trees[t],a=this.index[t];if(a==s.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=s.children[a],o=this.start[t]+s.positions[a];if(o>e)return this.nextStart=o,null;if(r instanceof ya){if(o==e){if(o<this.safeFrom)return null;let i=o+r.length;if(i<=this.safeTo){let l=r.prop(jn.lookAhead);if(!l||i+l<this.fragment.to)return r}}this.index[t]++,o+r.length>=Math.max(this.safeFrom,e)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+r.length}}}class Cle{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(s=>new Hb)}getActions(e){let t=0,s=null,{parser:a}=e.p,{tokenizers:r}=a,o=a.stateSlot(e.state,3),i=e.curContext?e.curContext.hash:0,l=0;for(let c=0;c<r.length;c++){if((1<<c&o)==0)continue;let u=r[c],h=this.tokens[c];if(!(s&&!u.fallback)&&((u.contextual||h.start!=e.pos||h.mask!=o||h.context!=i)&&(this.updateCachedToken(h,u,e),h.mask=o,h.context=i),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let m=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!u.extend&&(s=h,t>m))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!s&&e.pos==this.stream.end&&(s=new Hb,s.value=e.p.parser.eofTerm,s.start=s.end=e.pos,t=this.addActions(e,s.value,s.end,t)),this.mainToken=s,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Hb,{pos:s,p:a}=e;return t.start=s,t.end=Math.min(s+1,a.stream.end),t.value=s==a.stream.end?a.parser.eofTerm:0,t}updateCachedToken(e,t,s){let a=this.stream.clipPos(s.pos);if(t.token(this.stream.reset(a,e),s),e.value>-1){let{parser:r}=s.p;for(let o=0;o<r.specialized.length;o++)if(r.specialized[o]==e.value){let i=r.specializers[o](this.stream.read(e.start,e.end),s);if(i>=0&&s.p.parser.dialect.allows(i>>1)){(i&1)==0?e.value=i>>1:e.extended=i>>1;break}}}else e.value=0,e.end=this.stream.clipPos(a+1)}putAction(e,t,s,a){for(let r=0;r<a;r+=3)if(this.actions[r]==e)return a;return this.actions[a++]=e,this.actions[a++]=t,this.actions[a++]=s,a}addActions(e,t,s,a){let{state:r}=e,{parser:o}=e.p,{data:i}=o;for(let l=0;l<2;l++)for(let c=o.stateSlot(r,l?2:1);;c+=3){if(i[c]==65535)if(i[c+1]==1)c=vc(i,c+2);else{a==0&&i[c+1]==2&&(a=this.putAction(vc(i,c+2),t,s,a));break}i[c]==t&&(a=this.putAction(vc(i,c+1),t,s,a))}return a}}class Mle{constructor(e,t,s,a){this.parser=e,this.input=t,this.ranges=a,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new kle(t,a),this.tokens=new Cle(e,this.stream),this.topTerm=e.top[1];let{from:r}=a[0];this.stacks=[j1.start(this,e.top[0],r)],this.fragments=s.length&&this.stream.end-r>e.bufferLength*4?new Sle(s,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,s=this.stacks=[],a,r;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let i=e[o];for(;;){if(this.tokens.mainToken=null,i.pos>t)s.push(i);else{if(this.advanceStack(i,s,e))continue;{a||(a=[],r=[]),a.push(i);let l=this.tokens.getMainToken(i);r.push(l.value,l.end)}}break}}if(!s.length){let o=a&&Dle(a);if(o)return Po&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw Po&&a&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&a){let o=this.stoppedAt!=null&&a[0].pos>this.stoppedAt?a[0]:this.runRecovery(a,r,s);if(o)return Po&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(s.length>o)for(s.sort((i,l)=>l.score-i.score);s.length>o;)s.pop();s.some(i=>i.reducePos>t)&&this.recovering--}else if(s.length>1){e:for(let o=0;o<s.length-1;o++){let i=s[o];for(let l=o+1;l<s.length;l++){let c=s[l];if(i.sameState(c)||i.buffer.length>500&&c.buffer.length>500)if((i.score-c.score||i.buffer.length-c.buffer.length)>0)s.splice(l--,1);else{s.splice(o--,1);continue e}}}s.length>12&&s.splice(12,s.length-12)}this.minStackPos=s[0].pos;for(let o=1;o<s.length;o++)s[o].pos<this.minStackPos&&(this.minStackPos=s[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,s){let a=e.pos,{parser:r}=this,o=Po?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&a>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let c=e.curContext&&e.curContext.tracker.strict,u=c?e.curContext.hash:0;for(let h=this.fragments.nodeAt(a);h;){let m=this.parser.nodeSet.types[h.type.id]==h.type?r.getGoto(e.state,h.type.id):-1;if(m>-1&&h.length&&(!c||(h.prop(jn.contextHash)||0)==u))return e.useNode(h,m),Po&&console.log(o+this.stackID(e)+` (via reuse of ${r.getName(h.type.id)})`),!0;if(!(h instanceof ya)||h.children.length==0||h.positions[0]>0)break;let f=h.children[0];if(f instanceof ya&&h.positions[0]==0)h=f;else break}}let i=r.stateSlot(e.state,4);if(i>0)return e.reduce(i),Po&&console.log(o+this.stackID(e)+` (via always-reduce ${r.getName(i&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let c=0;c<l.length;){let u=l[c++],h=l[c++],m=l[c++],f=c==l.length||!s,v=f?e:e.split(),O=this.tokens.mainToken;if(v.apply(u,h,O?O.start:v.pos,m),Po&&console.log(o+this.stackID(v)+` (via ${(u&65536)==0?"shift":`reduce of ${r.getName(u&65535)}`} for ${r.getName(h)} @ ${a}${v==e?"":", split"})`),f)return!0;v.pos>a?t.push(v):s.push(v)}return!1}advanceFully(e,t){let s=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>s)return BD(e,t),!0}}runRecovery(e,t,s){let a=null,r=!1;for(let o=0;o<e.length;o++){let i=e[o],l=t[o<<1],c=t[(o<<1)+1],u=Po?this.stackID(i)+" -> ":"";if(i.deadEnd&&(r||(r=!0,i.restart(),Po&&console.log(u+this.stackID(i)+" (restarted)"),this.advanceFully(i,s))))continue;let h=i.split(),m=u;for(let f=0;f<10&&h.forceReduce()&&(Po&&console.log(m+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,s));f++)Po&&(m=this.stackID(h)+" -> ");for(let f of i.recoverByInsert(l))Po&&console.log(u+this.stackID(f)+" (via recover-insert)"),this.advanceFully(f,s);this.stream.end>i.pos?(c==i.pos&&(c++,l=0),i.recoverByDelete(l,c),Po&&console.log(u+this.stackID(i)+` (via recover-delete ${this.parser.getName(l)})`),BD(i,s)):(!a||a.score<i.score)&&(a=i)}return a}stackToTree(e){return e.close(),ya.build({buffer:Z1.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(zO||(zO=new WeakMap)).get(e);return t||zO.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function BD(n,e){for(let t=0;t<e.length;t++){let s=e[t];if(s.pos==n.pos&&s.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class Ale{constructor(e,t,s){this.source=e,this.flags=t,this.disabled=s}allows(e){return!this.disabled||this.disabled[e]==0}}const GO=n=>n;class Ele{constructor(e){this.start=e.start,this.shift=e.shift||GO,this.reduce=e.reduce||GO,this.reuse=e.reuse||GO,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class z1 extends N6{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let i=0;i<e.repeatNodeCount;i++)t.push("");let s=Object.keys(e.topRules).map(i=>e.topRules[i][1]),a=[];for(let i=0;i<t.length;i++)a.push([]);function r(i,l,c){a[i].push([l,l.deserialize(String(c))])}if(e.nodeProps)for(let i of e.nodeProps){let l=i[0];typeof l=="string"&&(l=jn[l]);for(let c=1;c<i.length;){let u=i[c++];if(u>=0)r(u,l,i[c++]);else{let h=i[c+-u];for(let m=-u;m>0;m--)r(i[c++],l,h);c++}}}this.nodeSet=new AM(t.map((i,l)=>po.define({name:l>=this.minRepeatTerm?void 0:i,id:l,props:a[l],top:s.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=E6;let o=Jp(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let i=0;i<this.specializerSpecs.length;i++)this.specialized[i]=this.specializerSpecs[i].term;this.specializers=this.specializerSpecs.map($D),this.states=Jp(e.states,Uint32Array),this.data=Jp(e.stateData),this.goto=Jp(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(i=>typeof i=="number"?new Fd(o,i):i),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,s){let a=new Mle(this,e,t,s);for(let r of this.wrappers)a=r(a,e,t,s);return a}getGoto(e,t,s=!1){let a=this.goto;if(t>=a[0])return-1;for(let r=a[t+1];;){let o=a[r++],i=o&1,l=a[r++];if(i&&s)return l;for(let c=r+(o>>1);r<c;r++)if(a[r]==e)return l;if(i)return-1}}hasAction(e,t){let s=this.data;for(let a=0;a<2;a++)for(let r=this.stateSlot(e,a?2:1),o;;r+=3){if((o=s[r])==65535)if(s[r+1]==1)o=s[r=vc(s,r+2)];else{if(s[r+1]==2)return vc(s,r+2);break}if(o==t||o==0)return vc(s,r+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,s=>s==t?!0:null)}allActions(e,t){let s=this.stateSlot(e,4),a=s?t(s):void 0;for(let r=this.stateSlot(e,1);a==null;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=vc(this.data,r+2);else break;a=t(vc(this.data,r+1))}return a}nextStates(e){let t=[];for(let s=this.stateSlot(e,1);;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=vc(this.data,s+2);else break;if((this.data[s+2]&1)==0){let a=this.data[s+1];t.some((r,o)=>o&1&&r==a)||t.push(this.data[s],a)}}return t}configure(e){let t=Object.assign(Object.create(z1.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let s=this.topRules[e.top];if(!s)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=s}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(s=>{let a=e.tokenizers.find(r=>r.from==s);return a?a.to:s})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((s,a)=>{let r=e.specializers.find(i=>i.from==s.external);if(!r)return s;let o=Object.assign(Object.assign({},s),{external:r.to});return t.specializers[a]=$D(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),s=t.map(()=>!1);if(e)for(let r of e.split(" ")){let o=t.indexOf(r);o>=0&&(s[o]=!0)}let a=null;for(let r=0;r<t.length;r++)if(!s[r])for(let o=this.dialects[t[r]],i;(i=this.data[o++])!=65535;)(a||(a=new Uint8Array(this.maxTerm+1)))[i]=1;return new Ale(e,s,a)}static deserialize(e){return new z1(e)}}function vc(n,e){return n[e]|n[e+1]<<16}function Dle(n){let e=null;for(let t of n){let s=t.p.stoppedAt;(t.pos==t.p.stream.end||s!=null&&t.pos>s)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function $D(n){if(n.external){let e=n.extend?1:0;return(t,s)=>n.external(t,s)<<1|e}return n.get}let Tle=0;class ei{constructor(e,t,s,a){this.name=e,this.set=t,this.base=s,this.modified=a,this.id=Tle++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let s=typeof e=="string"?e:"?";if(e instanceof ei&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let a=new ei(s,[],null,[]);if(a.set.push(a),t)for(let r of t.set)a.set.push(r);return a}static defineModifier(e){let t=new G1(e);return s=>s.modified.indexOf(t)>-1?s:G1.get(s.base||s,s.modified.concat(t).sort((a,r)=>a.id-r.id))}}let Fle=0;class G1{constructor(e){this.name=e,this.instances=[],this.id=Fle++}static get(e,t){if(!t.length)return e;let s=t[0].instances.find(i=>i.base==e&&Nle(t,i.modified));if(s)return s;let a=[],r=new ei(e.name,a,e,t);for(let i of t)i.instances.push(r);let o=Ble(t);for(let i of e.set)if(!i.modified.length)for(let l of o)a.push(G1.get(i,l));return r}}function Nle(n,e){return n.length==e.length&&n.every((t,s)=>t==e[s])}function Ble(n){let e=[[]];for(let t=0;t<n.length;t++)for(let s=0,a=e.length;s<a;s++)e.push(e[s].concat(n[t]));return e.sort((t,s)=>s.length-t.length)}function $6(n){let e=Object.create(null);for(let t in n){let s=n[t];Array.isArray(s)||(s=[s]);for(let a of t.split(" "))if(a){let r=[],o=2,i=a;for(let h=0;;){if(i=="..."&&h>0&&h+3==a.length){o=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(i);if(!m)throw new RangeError("Invalid path: "+a);if(r.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),h+=m[0].length,h==a.length)break;let f=a[h++];if(h==a.length&&f=="!"){o=0;break}if(f!="/")throw new RangeError("Invalid path: "+a);i=a.slice(h)}let l=r.length-1,c=r[l];if(!c)throw new RangeError("Invalid path: "+a);let u=new zf(s,o,l>0?r.slice(0,l):null);e[c]=u.sort(e[c])}}return R6.add(e)}const R6=new jn({combine(n,e){let t,s,a;for(;n||e;){if(!n||e&&n.depth>=e.depth?(a=e,e=e.next):(a=n,n=n.next),t&&t.mode==a.mode&&!a.context&&!t.context)continue;let r=new zf(a.tags,a.mode,a.context);t?t.next=r:s=r,t=r}return s}});class zf{constructor(e,t,s,a){this.tags=e,this.mode=t,this.context=s,this.next=a}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}zf.empty=new zf([],2,null);function _6(n,e){let t=Object.create(null);for(let r of n)if(!Array.isArray(r.tag))t[r.tag.id]=r.class;else for(let o of r.tag)t[o.id]=r.class;let{scope:s,all:a=null}=e||{};return{style:r=>{let o=a;for(let i of r)for(let l of i.set){let c=t[l.id];if(c){o=o?o+" "+c:c;break}}return o},scope:s}}function $le(n,e){let t=null;for(let s of n){let a=s.style(e);a&&(t=t?t+" "+a:a)}return t}function Rle(n,e,t,s=0,a=n.length){let r=new _le(s,Array.isArray(e)?e:[e],t);r.highlightRange(n.cursor(),s,a,"",r.highlighters),r.flush(a)}class _le{constructor(e,t,s){this.at=e,this.highlighters=t,this.span=s,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,s,a,r){let{type:o,from:i,to:l}=e;if(i>=s||l<=t)return;o.isTop&&(r=this.highlighters.filter(f=>!f.scope||f.scope(o)));let c=a,u=Lle(e)||zf.empty,h=$le(r,u.tags);if(h&&(c&&(c+=" "),c+=h,u.mode==1&&(a+=(a?" ":"")+h)),this.startSpan(Math.max(t,i),c),u.opaque)return;let m=e.tree&&e.tree.prop(jn.mounted);if(m&&m.overlay){let f=e.node.enter(m.overlay[0].from+i,1),v=this.highlighters.filter(k=>!k.scope||k.scope(m.tree.type)),O=e.firstChild();for(let k=0,M=i;;k++){let E=k<m.overlay.length?m.overlay[k]:null,I=E?E.from+i:l,D=Math.max(t,M),F=Math.min(s,I);if(D<F&&O)for(;e.from<F&&(this.highlightRange(e,D,F,a,r),this.startSpan(Math.min(F,e.to),c),!(e.to>=I||!e.nextSibling())););if(!E||I>s)break;M=E.to+i,M>t&&(this.highlightRange(f.cursor(),Math.max(t,E.from+i),Math.min(s,M),"",v),this.startSpan(Math.min(s,M),c))}O&&e.parent()}else if(e.firstChild()){m&&(a="");do if(!(e.to<=t)){if(e.from>=s)break;this.highlightRange(e,t,s,a,r),this.startSpan(Math.min(s,e.to),c)}while(e.nextSibling());e.parent()}}}function Lle(n){let e=n.type.prop(R6);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const xt=ei.define,F0=xt(),Hc=xt(),RD=xt(Hc),_D=xt(Hc),Yc=xt(),N0=xt(Yc),XO=xt(Yc),yl=xt(),Yu=xt(yl),ml=xt(),pl=xt(),c2=xt(),fp=xt(c2),B0=xt(),y={comment:F0,lineComment:xt(F0),blockComment:xt(F0),docComment:xt(F0),name:Hc,variableName:xt(Hc),typeName:RD,tagName:xt(RD),propertyName:_D,attributeName:xt(_D),className:xt(Hc),labelName:xt(Hc),namespace:xt(Hc),macroName:xt(Hc),literal:Yc,string:N0,docString:xt(N0),character:xt(N0),attributeValue:xt(N0),number:XO,integer:xt(XO),float:xt(XO),bool:xt(Yc),regexp:xt(Yc),escape:xt(Yc),color:xt(Yc),url:xt(Yc),keyword:ml,self:xt(ml),null:xt(ml),atom:xt(ml),unit:xt(ml),modifier:xt(ml),operatorKeyword:xt(ml),controlKeyword:xt(ml),definitionKeyword:xt(ml),moduleKeyword:xt(ml),operator:pl,derefOperator:xt(pl),arithmeticOperator:xt(pl),logicOperator:xt(pl),bitwiseOperator:xt(pl),compareOperator:xt(pl),updateOperator:xt(pl),definitionOperator:xt(pl),typeOperator:xt(pl),controlOperator:xt(pl),punctuation:c2,separator:xt(c2),bracket:fp,angleBracket:xt(fp),squareBracket:xt(fp),paren:xt(fp),brace:xt(fp),content:yl,heading:Yu,heading1:xt(Yu),heading2:xt(Yu),heading3:xt(Yu),heading4:xt(Yu),heading5:xt(Yu),heading6:xt(Yu),contentSeparator:xt(yl),list:xt(yl),quote:xt(yl),emphasis:xt(yl),strong:xt(yl),link:xt(yl),monospace:xt(yl),strikethrough:xt(yl),inserted:xt(),deleted:xt(),changed:xt(),invalid:xt(),meta:B0,documentMeta:xt(B0),annotation:xt(B0),processingInstruction:xt(B0),definition:ei.defineModifier("definition"),constant:ei.defineModifier("constant"),function:ei.defineModifier("function"),standard:ei.defineModifier("standard"),local:ei.defineModifier("local"),special:ei.defineModifier("special")};for(let n in y){let e=y[n];e instanceof ei&&(e.name=n)}_6([{tag:y.link,class:"tok-link"},{tag:y.heading,class:"tok-heading"},{tag:y.emphasis,class:"tok-emphasis"},{tag:y.strong,class:"tok-strong"},{tag:y.keyword,class:"tok-keyword"},{tag:y.atom,class:"tok-atom"},{tag:y.bool,class:"tok-bool"},{tag:y.url,class:"tok-url"},{tag:y.labelName,class:"tok-labelName"},{tag:y.inserted,class:"tok-inserted"},{tag:y.deleted,class:"tok-deleted"},{tag:y.literal,class:"tok-literal"},{tag:y.string,class:"tok-string"},{tag:y.number,class:"tok-number"},{tag:[y.regexp,y.escape,y.special(y.string)],class:"tok-string2"},{tag:y.variableName,class:"tok-variableName"},{tag:y.local(y.variableName),class:"tok-variableName tok-local"},{tag:y.definition(y.variableName),class:"tok-variableName tok-definition"},{tag:y.special(y.variableName),class:"tok-variableName2"},{tag:y.definition(y.propertyName),class:"tok-propertyName tok-definition"},{tag:y.typeName,class:"tok-typeName"},{tag:y.namespace,class:"tok-namespace"},{tag:y.className,class:"tok-className"},{tag:y.macroName,class:"tok-macroName"},{tag:y.propertyName,class:"tok-propertyName"},{tag:y.operator,class:"tok-operator"},{tag:y.comment,class:"tok-comment"},{tag:y.meta,class:"tok-meta"},{tag:y.invalid,class:"tok-invalid"},{tag:y.punctuation,class:"tok-punctuation"}]);const Ile=316,Qle=317,LD=1,Vle=2,jle=3,Zle=4,zle=318,Gle=320,Xle=321,Wle=5,qle=6,Ule=0,u2=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],L6=125,Hle=59,h2=47,Yle=42,Kle=43,Jle=45,ece=60,tce=44,nce=63,sce=46,ace=91,rce=new Ele({start:!1,shift(n,e){return e==Wle||e==qle||e==Gle?n:e==Xle},strict:!1}),oce=new Ig((n,e)=>{let{next:t}=n;(t==L6||t==-1||e.context)&&n.acceptToken(zle)},{contextual:!0,fallback:!0}),ice=new Ig((n,e)=>{let{next:t}=n,s;u2.indexOf(t)>-1||t==h2&&((s=n.peek(1))==h2||s==Yle)||t!=L6&&t!=Hle&&t!=-1&&!e.context&&n.acceptToken(Ile)},{contextual:!0}),lce=new Ig((n,e)=>{n.next==ace&&!e.context&&n.acceptToken(Qle)},{contextual:!0}),cce=new Ig((n,e)=>{let{next:t}=n;if(t==Kle||t==Jle){if(n.advance(),t==n.next){n.advance();let s=!e.context&&e.canShift(LD);n.acceptToken(s?LD:Vle)}}else t==nce&&n.peek(1)==sce&&(n.advance(),n.advance(),(n.next<48||n.next>57)&&n.acceptToken(jle))},{contextual:!0});function WO(n,e){return n>=65&&n<=90||n>=97&&n<=122||n==95||n>=192||!e&&n>=48&&n<=57}const uce=new Ig((n,e)=>{if(n.next!=ece||!e.dialectEnabled(Ule)||(n.advance(),n.next==h2))return;let t=0;for(;u2.indexOf(n.next)>-1;)n.advance(),t++;if(WO(n.next,!0)){for(n.advance(),t++;WO(n.next,!1);)n.advance(),t++;for(;u2.indexOf(n.next)>-1;)n.advance(),t++;if(n.next==tce)return;for(let s=0;;s++){if(s==7){if(!WO(n.next,!0))return;break}if(n.next!="extends".charCodeAt(s))break;n.advance(),t++}}n.acceptToken(Zle,-t)}),hce=$6({"get set async static":y.modifier,"for while do if else switch try catch finally return throw break continue default case defer":y.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":y.operatorKeyword,"let var const using function class extends":y.definitionKeyword,"import export from":y.moduleKeyword,"with debugger new":y.keyword,TemplateString:y.special(y.string),super:y.atom,BooleanLiteral:y.bool,this:y.self,null:y.null,Star:y.modifier,VariableName:y.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":y.function(y.variableName),VariableDefinition:y.definition(y.variableName),Label:y.labelName,PropertyName:y.propertyName,PrivatePropertyName:y.special(y.propertyName),"CallExpression/MemberExpression/PropertyName":y.function(y.propertyName),"FunctionDeclaration/VariableDefinition":y.function(y.definition(y.variableName)),"ClassDeclaration/VariableDefinition":y.definition(y.className),"NewExpression/VariableName":y.className,PropertyDefinition:y.definition(y.propertyName),PrivatePropertyDefinition:y.definition(y.special(y.propertyName)),UpdateOp:y.updateOperator,"LineComment Hashbang":y.lineComment,BlockComment:y.blockComment,Number:y.number,String:y.string,Escape:y.escape,ArithOp:y.arithmeticOperator,LogicOp:y.logicOperator,BitOp:y.bitwiseOperator,CompareOp:y.compareOperator,RegExp:y.regexp,Equals:y.definitionOperator,Arrow:y.function(y.punctuation),": Spread":y.punctuation,"( )":y.paren,"[ ]":y.squareBracket,"{ }":y.brace,"InterpolationStart InterpolationEnd":y.special(y.brace),".":y.derefOperator,", ;":y.separator,"@":y.meta,TypeName:y.typeName,TypeDefinition:y.definition(y.typeName),"type enum interface implements namespace module declare":y.definitionKeyword,"abstract global Privacy readonly override":y.modifier,"is keyof unique infer asserts":y.operatorKeyword,JSXAttributeValue:y.attributeValue,JSXText:y.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":y.angleBracket,"JSXIdentifier JSXNameSpacedName":y.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":y.attributeName,"JSXBuiltin/JSXIdentifier":y.standard(y.tagName)}),dce={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},mce={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},pce={__proto__:null,"<":193},fce=z1.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:rce,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[hce],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[ice,lce,cce,uce,2,3,4,5,6,7,8,9,10,11,12,13,14,oce,new l2("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new l2("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:n=>dce[n]||-1},{term:343,get:n=>mce[n]||-1},{term:95,get:n=>pce[n]||-1}],tokenPrec:15201});var qO;const yd=new jn;function I6(n){return Lt.define({combine:n?e=>e.concat(n):void 0})}const FM=new jn;class li{constructor(e,t,s=[],a=""){this.data=e,this.name=a,cs.prototype.hasOwnProperty("tree")||Object.defineProperty(cs.prototype,"tree",{get(){return Ea(this)}}),this.parser=t,this.extension=[Au.of(this),cs.languageData.of((r,o,i)=>{let l=ID(r,o,i),c=l.type.prop(yd);if(!c)return[];let u=r.facet(c),h=l.type.prop(FM);if(h){let m=l.resolve(o-l.from,i);for(let f of h)if(f.test(m,r)){let v=r.facet(f.facet);return f.type=="replace"?v:v.concat(u)}}return u})].concat(s)}isActiveAt(e,t,s=-1){return ID(e,t,s).type.prop(yd)==this.data}findRegions(e){let t=e.facet(Au);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let s=[],a=(r,o)=>{if(r.prop(yd)==this.data){s.push({from:o,to:o+r.length});return}let i=r.prop(jn.mounted);if(i){if(i.tree.prop(yd)==this.data){if(i.overlay)for(let l of i.overlay)s.push({from:l.from+o,to:l.to+o});else s.push({from:o,to:o+r.length});return}else if(i.overlay){let l=s.length;if(a(i.tree,i.overlay[0].from+o),s.length>l)return}}for(let l=0;l<r.children.length;l++){let c=r.children[l];c instanceof ya&&a(c,r.positions[l]+o)}};return a(Ea(e),0),s}get allowsNesting(){return!0}}li.setState=cn.define();function ID(n,e,t){let s=n.facet(Au),a=Ea(n).topNode;if(!s||s.allowsNesting)for(let r=a;r;r=r.enter(e,t,Sa.ExcludeBuffers))r.type.isTop&&(a=r);return a}class X1 extends li{constructor(e,t,s){super(e,t,[],s),this.parser=t}static define(e){let t=I6(e.languageData);return new X1(t,e.parser.configure({props:[yd.add(s=>s.isTop?t:void 0)]}),e.name)}configure(e,t){return new X1(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ea(n){let e=n.field(li.state,!1);return e?e.tree:ya.empty}function Q6(n,e,t=50){var s;let a=(s=n.field(li.state,!1))===null||s===void 0?void 0:s.context;if(!a)return null;let r=a.viewport;a.updateViewport({from:0,to:e});let o=a.isDone(e)||a.work(t,e)?a.tree:null;return a.updateViewport(r),o}class gce{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let s=this.cursorPos-this.string.length;return e<s||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-s,t-s)}}let gp=null;class W1{constructor(e,t,s=[],a,r,o,i,l){this.parser=e,this.state=t,this.fragments=s,this.tree=a,this.treeLen=r,this.viewport=o,this.skipped=i,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,s){return new W1(e,t,[],ya.empty,0,s,[],null)}startParse(){return this.parser.startParse(new gce(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=ya.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var s;if(typeof e=="number"){let a=Date.now()+e;e=()=>Date.now()>a}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let a=this.parse.advance();if(a)if(this.fragments=this.withoutTempSkipped(Sh.addTree(a,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(s=this.parse.stoppedAt)!==null&&s!==void 0?s:this.state.doc.length,this.tree=a,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Sh.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=gp;gp=this;try{return e()}finally{gp=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=QD(e,t.from,t.to);return e}changes(e,t){let{fragments:s,tree:a,treeLen:r,viewport:o,skipped:i}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,u,h,m)=>l.push({fromA:c,toA:u,fromB:h,toB:m})),s=Sh.applyChanges(s,l),a=ya.empty,r=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){i=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),h=e.mapPos(c.to,-1);u<h&&i.push({from:u,to:h})}}}return new W1(this.parser,t,s,a,r,o,i,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:a,to:r}=this.skipped[s];a<e.to&&r>e.from&&(this.fragments=QD(this.fragments,a,r),this.skipped.splice(s--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends N6{createParse(t,s,a){let r=a[0].from,o=a[a.length-1].to;return{parsedPos:r,advance(){let l=gp;if(l){for(let c of a)l.tempSkipped.push(c);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new ya(po.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return gp}}function QD(n,e,t){return Sh.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class im{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),s=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,s)||t.takeTree(),new im(t)}static init(e){let t=Math.min(3e3,e.doc.length),s=W1.create(e.facet(Au).parser,e,{from:0,to:t});return s.work(20,t)||s.takeTree(),new im(s)}}li.state=zs.define({create:im.init,update(n,e){for(let t of e.effects)if(t.is(li.setState))return t.value;return e.startState.facet(Au)!=e.state.facet(Au)?im.init(e.state):n.apply(e)}});let V6=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(V6=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const UO=typeof navigator<"u"&&(!((qO=navigator.scheduling)===null||qO===void 0)&&qO.isInputPending)?()=>navigator.scheduling.isInputPending():null,bce=Ks.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(li.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(li.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=V6(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:s,viewport:{to:a}}=this.view,r=s.field(li.state);if(r.tree==r.context.tree&&r.context.isDone(a+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!UO?Math.max(25,e.timeRemaining()-5):1e9),i=r.context.treeLen<a&&s.doc.length>a+1e3,l=r.context.work(()=>UO&&UO()||Date.now()>o,a+(i?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:li.setState.of(new im(r.context))})),this.chunkBudget>0&&!(l&&!i)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>oo(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Au=Lt.define({combine(n){return n.length?n[0]:null},enables:n=>[li.state,bce,ut.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class yce{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const vce=Lt.define(),lm=Lt.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function q1(n){let e=n.facet(lm);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function U1(n,e){let t="",s=n.tabSize,a=n.facet(lm)[0];if(a=="	"){for(;e>=s;)t+="	",e-=s;a=" "}for(let r=0;r<e;r++)t+=a;return t}function j6(n,e){n instanceof cs&&(n=new Yv(n));for(let s of n.state.facet(vce)){let a=s(n,e);if(a!==void 0)return a}let t=Ea(n.state);return t.length>=e?wce(n,t,e):null}class Yv{constructor(e,t={}){this.state=e,this.options=t,this.unit=q1(e)}lineAt(e,t=1){let s=this.state.doc.lineAt(e),{simulateBreak:a,simulateDoubleBreak:r}=this.options;return a!=null&&a>=s.from&&a<=s.to?r&&a==e?{text:"",from:e}:(t<0?a<e:a<=e)?{text:s.text.slice(a-s.from),from:a}:{text:s.text.slice(0,a-s.from),from:s.from}:s}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:s,from:a}=this.lineAt(e,t);return s.slice(e-a,Math.min(s.length,e+100-a))}column(e,t=1){let{text:s,from:a}=this.lineAt(e,t),r=this.countColumn(s,e-a),o=this.options.overrideIndentation?this.options.overrideIndentation(a):-1;return o>-1&&(r+=o-this.countColumn(s,s.search(/\S|$/))),r}countColumn(e,t=e.length){return Bm(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:s,from:a}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){let o=r(a);if(o>-1)return o}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Z6=new jn;function wce(n,e,t){let s=e.resolveStack(t),a=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(a!=s.node){let r=[];for(let o=a;o&&!(o.from<s.node.from||o.to>s.node.to||o.from==s.node.from&&o.type==s.node.type);o=o.parent)r.push(o);for(let o=r.length-1;o>=0;o--)s={node:r[o],next:s}}return z6(s,n,t)}function z6(n,e,t){for(let s=n;s;s=s.next){let a=xce(s.node);if(a)return a(NM.create(e,t,s))}return 0}function Oce(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function xce(n){let e=n.type.prop(Z6);if(e)return e;let t=n.firstChild,s;if(t&&(s=t.type.prop(jn.closedBy))){let a=n.lastChild,r=a&&s.indexOf(a.name)>-1;return o=>G6(o,!0,1,void 0,r&&!Oce(o)?a.from:void 0)}return n.parent==null?kce:null}function kce(){return 0}class NM extends Yv{constructor(e,t,s){super(e.state,e.options),this.base=e,this.pos=t,this.context=s}get node(){return this.context.node}static create(e,t,s){return new NM(e,t,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let s=e.resolve(t.from);for(;s.parent&&s.parent.from==s.from;)s=s.parent;if(Pce(s,e))break;t=this.state.doc.lineAt(s.from)}return this.lineIndent(t.from)}continue(){return z6(this.context.next,this.base,this.pos)}}function Pce(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function Sce(n){let e=n.node,t=e.childAfter(e.from),s=e.lastChild;if(!t)return null;let a=n.options.simulateBreak,r=n.state.doc.lineAt(t.from),o=a==null||a<=r.from?r.to:Math.min(r.to,a);for(let i=t.to;;){let l=e.childAfter(i);if(!l||l==s)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let c=/^ */.exec(r.text.slice(t.to-r.from))[0].length;return{from:t.from,to:t.to+c}}i=l.to}}function Cce({closing:n,align:e=!0,units:t=1}){return s=>G6(s,e,t,n)}function G6(n,e,t,s,a){let r=n.textAfter,o=r.match(/^\s*/)[0].length,i=s&&r.slice(o,o+s.length)==s||a==n.pos+o,l=e?Sce(n):null;return l?i?n.column(l.from):n.column(l.to):n.baseIndent+(i?0:n.unit*t)}const Mce=n=>n.baseIndent;function HO({except:n,units:e=1}={}){return t=>{let s=n&&n.test(t.textAfter);return t.baseIndent+(s?0:e*t.unit)}}const Ace=Lt.define(),X6=new jn;function Ece(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function Dce(n,e,t){let s=Ea(n);if(s.length<t)return null;let a=s.resolveStack(t,1),r=null;for(let o=a;o;o=o.next){let i=o.node;if(i.to<=t||i.from>t)continue;if(r&&i.from<e)break;let l=i.type.prop(X6);if(l&&(i.to<s.length-50||s.length==n.doc.length||!Tce(i))){let c=l(i,n);c&&c.from<=t&&c.from>=e&&c.to>t&&(r=c)}}return r}function Tce(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function H1(n,e,t){for(let s of n.facet(Ace)){let a=s(n,e,t);if(a)return a}return Dce(n,e,t)}function W6(n,e){let t=e.mapPos(n.from,1),s=e.mapPos(n.to,-1);return t>=s?void 0:{from:t,to:s}}const Kv=cn.define({map:W6}),Qg=cn.define({map:W6});function q6(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(s=>s.from<=t&&s.to>=t)||e.push(n.lineBlockAt(t));return e}const Qh=zs.define({create(){return Et.none},update(n,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,s)=>n=VD(n,t,s)),n=n.map(e.changes);for(let t of e.effects)if(t.is(Kv)&&!Fce(n,t.value.from,t.value.to)){let{preparePlaceholder:s}=e.state.facet(e$),a=s?Et.replace({widget:new $ce(s(e.state,t.value))}):jD;n=n.update({add:[a.range(t.value.from,t.value.to)]})}else t.is(Qg)&&(n=n.update({filter:(s,a)=>t.value.from!=s||t.value.to!=a,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(n=VD(n,e.selection.main.head)),n},provide:n=>ut.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(s,a)=>{t.push(s,a)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let s=n[t++],a=n[t++];if(typeof s!="number"||typeof a!="number")throw new RangeError("Invalid JSON for fold state");e.push(jD.range(s,a))}return Et.set(e,!0)}});function VD(n,e,t=e){let s=!1;return n.between(e,t,(a,r)=>{a<t&&r>e&&(s=!0)}),s?n.update({filterFrom:e,filterTo:t,filter:(a,r)=>a>=t||r<=e}):n}function Y1(n,e,t){var s;let a=null;return(s=n.field(Qh,!1))===null||s===void 0||s.between(e,t,(r,o)=>{(!a||a.from>r)&&(a={from:r,to:o})}),a}function Fce(n,e,t){let s=!1;return n.between(e,e,(a,r)=>{a==e&&r==t&&(s=!0)}),s}function U6(n,e){return n.field(Qh,!1)?e:e.concat(cn.appendConfig.of(t$()))}const BM=n=>{for(let e of q6(n)){let t=H1(n.state,e.from,e.to);if(t)return n.dispatch({effects:U6(n.state,[Kv.of(t),Y6(n,t)])}),!0}return!1},H6=n=>{if(!n.state.field(Qh,!1))return!1;let e=[];for(let t of q6(n)){let s=Y1(n.state,t.from,t.to);s&&e.push(Qg.of(s),Y6(n,s,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function Y6(n,e,t=!0){let s=n.state.doc.lineAt(e.from).number,a=n.state.doc.lineAt(e.to).number;return ut.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${s} ${n.state.phrase("to")} ${a}.`)}const K6=n=>{let{state:e}=n,t=[];for(let s=0;s<e.doc.length;){let a=n.lineBlockAt(s),r=H1(e,a.from,a.to);r&&t.push(Kv.of(r)),s=(r?n.lineBlockAt(r.to):a).to+1}return t.length&&n.dispatch({effects:U6(n.state,t)}),!!t.length},J6=n=>{let e=n.state.field(Qh,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(s,a)=>{t.push(Qg.of({from:s,to:a}))}),n.dispatch({effects:t}),!0},Nce=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:BM},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:H6},{key:"Ctrl-Alt-[",run:K6},{key:"Ctrl-Alt-]",run:J6}],Bce={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},e$=Lt.define({combine(n){return Kl(n,Bce)}});function t$(n){return[Qh,Lce]}function n$(n,e){let{state:t}=n,s=t.facet(e$),a=o=>{let i=n.lineBlockAt(n.posAtDOM(o.target)),l=Y1(n.state,i.from,i.to);l&&n.dispatch({effects:Qg.of(l)}),o.preventDefault()};if(s.placeholderDOM)return s.placeholderDOM(n,a,e);let r=document.createElement("span");return r.textContent=s.placeholderText,r.setAttribute("aria-label",t.phrase("folded code")),r.title=t.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=a,r}const jD=Et.replace({widget:new class extends ol{toDOM(n){return n$(n,null)}}});class $ce extends ol{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return n$(e,this.value)}}const Rce={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class YO extends Tc{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function _ce(n={}){let e={...Rce,...n},t=new YO(e,!0),s=new YO(e,!1),a=Ks.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Au)!=o.state.facet(Au)||o.startState.field(Qh,!1)!=o.state.field(Qh,!1)||Ea(o.startState)!=Ea(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let i=new Hi;for(let l of o.viewportLineBlocks){let c=Y1(o.state,l.from,l.to)?s:H1(o.state,l.from,l.to)?t:null;c&&i.add(l.from,l.from,c)}return i.finish()}}),{domEventHandlers:r}=e;return[a,ale({class:"cm-foldGutter",markers(o){var i;return((i=o.plugin(a))===null||i===void 0?void 0:i.markers)||ss.empty},initialSpacer(){return new YO(e,!1)},domEventHandlers:{...r,click:(o,i,l)=>{if(r.click&&r.click(o,i,l))return!0;let c=Y1(o.state,i.from,i.to);if(c)return o.dispatch({effects:Qg.of(c)}),!0;let u=H1(o.state,i.from,i.to);return u?(o.dispatch({effects:Kv.of(u)}),!0):!1}}}),t$()]}const Lce=ut.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class $m{constructor(e,t){this.specs=e;let s;function a(i){let l=ku.newName();return(s||(s=Object.create(null)))["."+l]=i,l}const r=typeof t.all=="string"?t.all:t.all?a(t.all):void 0,o=t.scope;this.scope=o instanceof li?i=>i.prop(yd)==o.data:o?i=>i==o:void 0,this.style=_6(e.map(i=>({tag:i.tag,class:i.class||a(Object.assign({},i,{tag:null}))})),{all:r}).style,this.module=s?new ku(s):null,this.themeType=t.themeType}static define(e,t){return new $m(e,t||{})}}const d2=Lt.define(),s$=Lt.define({combine(n){return n.length?[n[0]]:null}});function KO(n){let e=n.facet(d2);return e.length?e:n.facet(s$)}function Jv(n,e){let t=[Qce],s;return n instanceof $m&&(n.module&&t.push(ut.styleModule.of(n.module)),s=n.themeType),e!=null&&e.fallback?t.push(s$.of(n)):s?t.push(d2.computeN([ut.darkTheme],a=>a.facet(ut.darkTheme)==(s=="dark")?[n]:[])):t.push(d2.of(n)),t}class Ice{constructor(e){this.markCache=Object.create(null),this.tree=Ea(e.state),this.decorations=this.buildDeco(e,KO(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Ea(e.state),s=KO(e.state),a=s!=KO(e.startState),{viewport:r}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<r.to&&!a&&t.type==this.tree.type&&o>=r.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||a)&&(this.tree=t,this.decorations=this.buildDeco(e.view,s),this.decoratedTo=r.to)}buildDeco(e,t){if(!t||!this.tree.length)return Et.none;let s=new Hi;for(let{from:a,to:r}of e.visibleRanges)Rle(this.tree,t,(o,i,l)=>{s.add(o,i,this.markCache[l]||(this.markCache[l]=Et.mark({class:l})))},a,r);return s.finish()}}const Qce=jo.high(Ks.fromClass(Ice,{decorations:n=>n.decorations})),a$=$m.define([{tag:y.meta,color:"#404740"},{tag:y.link,textDecoration:"underline"},{tag:y.heading,textDecoration:"underline",fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.strong,fontWeight:"bold"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.keyword,color:"#708"},{tag:[y.atom,y.bool,y.url,y.contentSeparator,y.labelName],color:"#219"},{tag:[y.literal,y.inserted],color:"#164"},{tag:[y.string,y.deleted],color:"#a11"},{tag:[y.regexp,y.escape,y.special(y.string)],color:"#e40"},{tag:y.definition(y.variableName),color:"#00f"},{tag:y.local(y.variableName),color:"#30a"},{tag:[y.typeName,y.namespace],color:"#085"},{tag:y.className,color:"#167"},{tag:[y.special(y.variableName),y.macroName],color:"#256"},{tag:y.definition(y.propertyName),color:"#00c"},{tag:y.comment,color:"#940"},{tag:y.invalid,color:"#f00"}]),Vce=ut.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),r$=1e4,o$="()[]{}",i$=Lt.define({combine(n){return Kl(n,{afterCursor:!0,brackets:o$,maxScanDistance:r$,renderMatch:zce})}}),jce=Et.mark({class:"cm-matchingBracket"}),Zce=Et.mark({class:"cm-nonmatchingBracket"});function zce(n){let e=[],t=n.matched?jce:Zce;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const Gce=zs.define({create(){return Et.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],s=e.state.facet(i$);for(let a of e.state.selection.ranges){if(!a.empty)continue;let r=ci(e.state,a.head,-1,s)||a.head>0&&ci(e.state,a.head-1,1,s)||s.afterCursor&&(ci(e.state,a.head,1,s)||a.head<e.state.doc.length&&ci(e.state,a.head+1,-1,s));r&&(t=t.concat(s.renderMatch(r,e.state)))}return Et.set(t,!0)},provide:n=>ut.decorations.from(n)}),Xce=[Gce,Vce];function l$(n={}){return[i$.of(n),Xce]}const Wce=new jn;function m2(n,e,t){let s=n.prop(e<0?jn.openedBy:jn.closedBy);if(s)return s;if(n.name.length==1){let a=t.indexOf(n.name);if(a>-1&&a%2==(e<0?1:0))return[t[a+e]]}return null}function p2(n){let e=n.type.prop(Wce);return e?e(n.node):n}function ci(n,e,t,s={}){let a=s.maxScanDistance||r$,r=s.brackets||o$,o=Ea(n),i=o.resolveInner(e,t);for(let l=i;l;l=l.parent){let c=m2(l.type,t,r);if(c&&l.from<l.to){let u=p2(l);if(u&&(t>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return qce(n,e,t,l,u,c,r)}}return Uce(n,e,t,o,i.type,a,r)}function qce(n,e,t,s,a,r,o){let i=s.parent,l={from:a.from,to:a.to},c=0,u=i==null?void 0:i.cursor();if(u&&(t<0?u.childBefore(s.from):u.childAfter(s.to)))do if(t<0?u.to<=s.from:u.from>=s.to){if(c==0&&r.indexOf(u.type.name)>-1&&u.from<u.to){let h=p2(u);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(m2(u.type,t,o))c++;else if(m2(u.type,-t,o)){if(c==0){let h=p2(u);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}c--}}while(t<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function Uce(n,e,t,s,a,r,o){let i=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),l=o.indexOf(i);if(l<0||l%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},u=n.doc.iterRange(e,t>0?n.doc.length:0),h=0;for(let m=0;!u.next().done&&m<=r;){let f=u.value;t<0&&(m+=f.length);let v=e+m*t;for(let O=t>0?0:f.length-1,k=t>0?f.length:-1;O!=k;O+=t){let M=o.indexOf(f[O]);if(!(M<0||s.resolveInner(v+O,1).type!=a))if(M%2==0==t>0)h++;else{if(h==1)return{start:c,end:{from:v+O,to:v+O+1},matched:M>>1==l>>1};h--}}t>0&&(m+=f.length)}return u.done?{start:c,matched:!1}:null}function ZD(n,e,t,s=0,a=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let r=a;for(let o=s;o<e;o++)n.charCodeAt(o)==9?r+=t-r%t:r++;return r}class Hce{constructor(e,t,s,a){this.string=e,this.tabSize=t,this.indentUnit=s,this.overrideIndent=a,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),s;if(typeof e=="string"?s=t==e:s=t&&(e instanceof RegExp?e.test(t):e(t)),s)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ZD(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:ZD(this.string,null,this.tabSize)}match(e,t,s){if(typeof e=="string"){let a=o=>s?o.toLowerCase():o,r=this.string.substr(this.pos,e.length);return a(r)==a(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let a=this.string.slice(this.pos).match(e);return a&&a.index>0?null:(a&&t!==!1&&(this.pos+=a[0].length),a)}}current(){return this.string.slice(this.start,this.pos)}}const Yce=Object.create(null),zD=[po.none],GD=[],XD=Object.create(null),Kce=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Kce[n]=Jce(Yce,e);function JO(n,e){GD.indexOf(n)>-1||(GD.push(n),console.warn(e))}function Jce(n,e){let t=[];for(let i of e.split(" ")){let l=[];for(let c of i.split(".")){let u=n[c]||y[c];u?typeof u=="function"?l.length?l=l.map(u):JO(c,`Modifier ${c} used at start of tag`):l.length?JO(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:JO(c,`Unknown highlighting tag ${c}`)}for(let c of l)t.push(c)}if(!t.length)return 0;let s=e.replace(/ /g,"_"),a=s+" "+t.map(i=>i.id),r=XD[a];if(r)return r.id;let o=XD[a]=po.define({id:zD.length,name:s,props:[$6({[s]:t})]});return zD.push(o),o.id}Es.RTL,Es.LTR;class c${constructor(e,t,s,a){this.state=e,this.pos=t,this.explicit=s,this.view=a,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Ea(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),s=Math.max(t.from,this.pos-250),a=t.text.slice(s-t.from,this.pos-t.from),r=a.search(h$(e,!1));return r<0?null:{from:s+r,to:this.pos,text:a.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,s){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),s&&s.onDocChange&&(this.abortOnDocChange=!0))}}function WD(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function eue(n){let e=Object.create(null),t=Object.create(null);for(let{label:a}of n){e[a[0]]=!0;for(let r=1;r<a.length;r++)t[a[r]]=!0}let s=WD(e)+WD(t)+"*$";return[new RegExp("^"+s),new RegExp(s)]}function u$(n){let e=n.map(a=>typeof a=="string"?{label:a}:a),[t,s]=e.every(a=>/^\w+$/.test(a.label))?[/\w*$/,/\w+$/]:eue(e);return a=>{let r=a.matchBefore(s);return r||a.explicit?{from:r?r.from:a.pos,options:e,validFor:t}:null}}function tue(n,e){return t=>{for(let s=Ea(t.state).resolveInner(t.pos,-1);s;s=s.parent){if(n.indexOf(s.name)>-1)return null;if(s.type.isTop)break}return e(t)}}class qD{constructor(e,t,s,a){this.completion=e,this.source=t,this.match=s,this.score=a}}function Ch(n){return n.selection.main.from}function h$(n,e){var t;let{source:s}=n,a=e&&s[0]!="^",r=s[s.length-1]!="$";return!a&&!r?n:new RegExp(`${a?"^":""}(?:${s})${r?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const $M=Ic.define();function nue(n,e,t,s){let{main:a}=n.selection,r=t-a.from,o=s-a.from;return{...n.changeByRange(i=>{if(i!=a&&t!=s&&n.sliceDoc(i.from+r,i.from+o)!=n.sliceDoc(t,s))return{range:i};let l=n.toText(e);return{changes:{from:i.from+r,to:s==a.from?i.to:i.from+o,insert:l},range:Ve.cursor(i.from+r+l.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const UD=new WeakMap;function sue(n){if(!Array.isArray(n))return n;let e=UD.get(n);return e||UD.set(n,e=u$(n)),e}const K1=cn.define(),Gf=cn.define();class aue{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let s=so(e,t),a=Sl(s);this.chars.push(s);let r=e.slice(t,t+a),o=r.toUpperCase();this.folded.push(so(o==r?r.toLowerCase():o,0)),t+=a}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:s,any:a,precise:r,byWord:o}=this;if(t.length==1){let E=so(e,0),I=Sl(E),D=I==e.length?0:-100;if(E!=t[0])if(E==s[0])D+=-200;else return null;return this.ret(D,[0,I])}let i=e.indexOf(this.pattern);if(i==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,c=0;if(i<0){for(let E=0,I=Math.min(e.length,200);E<I&&c<l;){let D=so(e,E);(D==t[c]||D==s[c])&&(a[c++]=E),E+=Sl(D)}if(c<l)return null}let u=0,h=0,m=!1,f=0,v=-1,O=-1,k=/[a-z]/.test(e),M=!0;for(let E=0,I=Math.min(e.length,200),D=0;E<I&&h<l;){let F=so(e,E);i<0&&(u<l&&F==t[u]&&(r[u++]=E),f<l&&(F==t[f]||F==s[f]?(f==0&&(v=E),O=E+1,f++):f=0));let _,$=F<255?F>=48&&F<=57||F>=97&&F<=122?2:F>=65&&F<=90?1:0:(_=mM(F))!=_.toLowerCase()?1:_!=_.toUpperCase()?2:0;(!E||$==1&&k||D==0&&$!=0)&&(t[h]==F||s[h]==F&&(m=!0)?o[h++]=E:o.length&&(M=!1)),D=$,E+=Sl(F)}return h==l&&o[0]==0&&M?this.result(-100+(m?-200:0),o,e):f==l&&v==0?this.ret(-200-e.length+(O==e.length?0:-100),[0,O]):i>-1?this.ret(-700-e.length,[i,i+this.pattern.length]):f==l?this.ret(-900-e.length,[v,O]):h==l?this.result(-100+(m?-200:0)+-700+(M?0:-1100),o,e):t.length==2?null:this.result((a[0]?-700:0)+-200+-1100,a,e)}result(e,t,s){let a=[],r=0;for(let o of t){let i=o+(this.astral?Sl(so(s,o)):1);r&&a[r-1]==o?a[r-1]=i:(a[r++]=o,a[r++]=i)}return this.ret(e-s.length,a)}}class rue{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),s=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return s==null?null:(this.matched=[0,t.length],this.score=s+(e.length==this.pattern.length?0:-100),this)}}const Va=Lt.define({combine(n){return Kl(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:oue,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>s=>HD(e(s),t(s)),optionClass:(e,t)=>s=>HD(e(s),t(s)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function HD(n,e){return n?e?n+" "+e:n:e}function oue(n,e,t,s,a,r){let o=n.textDirection==Es.RTL,i=o,l=!1,c="top",u,h,m=e.left-a.left,f=a.right-e.right,v=s.right-s.left,O=s.bottom-s.top;if(i&&m<Math.min(v,f)?i=!1:!i&&f<Math.min(v,m)&&(i=!0),v<=(i?m:f))u=Math.max(a.top,Math.min(t.top,a.bottom-O))-e.top,h=Math.min(400,i?m:f);else{l=!0,h=Math.min(400,(o?e.right:a.right-e.left)-30);let E=a.bottom-e.bottom;E>=O||E>e.top?u=t.bottom-e.top:(c="bottom",u=e.bottom-t.top)}let k=(e.bottom-e.top)/r.offsetHeight,M=(e.right-e.left)/r.offsetWidth;return{style:`${c}: ${u/k}px; max-width: ${h/M}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":i?"left":"right")}}function iue(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let s=document.createElement("div");return s.classList.add("cm-completionIcon"),t.type&&s.classList.add(...t.type.split(/\s+/g).map(a=>"cm-completionIcon-"+a)),s.setAttribute("aria-hidden","true"),s},position:20}),e.push({render(t,s,a,r){let o=document.createElement("span");o.className="cm-completionLabel";let i=t.displayLabel||t.label,l=0;for(let c=0;c<r.length;){let u=r[c++],h=r[c++];u>l&&o.appendChild(document.createTextNode(i.slice(l,u)));let m=o.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(i.slice(u,h))),m.className="cm-completionMatchedText",l=h}return l<i.length&&o.appendChild(document.createTextNode(i.slice(l))),o},position:50},{render(t){if(!t.detail)return null;let s=document.createElement("span");return s.className="cm-completionDetail",s.textContent=t.detail,s},position:80}),e.sort((t,s)=>t.position-s.position).map(t=>t.render)}function ex(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let a=Math.floor(e/t);return{from:a*t,to:(a+1)*t}}let s=Math.floor((n-e)/t);return{from:n-(s+1)*t,to:n-s*t}}class lue{constructor(e,t,s){this.view=e,this.stateField=t,this.applyCompletion=s,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let a=e.state.field(t),{options:r,selected:o}=a.open,i=e.state.facet(Va);this.optionContent=iue(i),this.optionClass=i.optionClass,this.tooltipClass=i.tooltipClass,this.range=ex(r.length,o,i.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(t).open;for(let u=l.target,h;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(h=/-(\d+)$/.exec(u.id))&&+h[1]<c.length){this.applyCompletion(e,c[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(Va).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Gf.of(null)})}),this.showOptions(r,a.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let s=e.state.field(this.stateField),a=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),s!=a){let{options:r,selected:o,disabled:i}=s.open;(!a.open||a.open.options!=r)&&(this.range=ex(r.length,o,e.state.facet(Va).maxRenderedOptions),this.showOptions(r,s.id)),this.updateSel(),i!=((t=a.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!i)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let s of this.currentClass.split(" "))s&&this.dom.classList.remove(s);for(let s of t.split(" "))s&&this.dom.classList.add(s);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=ex(t.options.length,t.selected,this.view.state.facet(Va).maxRenderedOptions),this.showOptions(t.options,e.id));let s=this.updateSelectedOption(t.selected);if(s){this.destroyInfo();let{completion:a}=t.options[t.selected],{info:r}=a;if(!r)return;let o=typeof r=="string"?document.createTextNode(r):r(a);if(!o)return;"then"in o?o.then(i=>{i&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(i,a)}).catch(i=>oo(this.view.state,i,"completion info")):(this.addInfoPane(o,a),s.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let s=this.info=document.createElement("div");if(s.className="cm-tooltip cm-completionInfo",s.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)s.appendChild(e),this.infoDestroy=null;else{let{dom:a,destroy:r}=e;s.appendChild(a),this.infoDestroy=r||null}this.dom.appendChild(s),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let s=this.list.firstChild,a=this.range.from;s;s=s.nextSibling,a++)s.nodeName!="LI"||!s.id?a--:a==e?s.hasAttribute("aria-selected")||(s.setAttribute("aria-selected","true"),t=s):s.hasAttribute("aria-selected")&&(s.removeAttribute("aria-selected"),s.removeAttribute("aria-describedby"));return t&&uue(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),s=this.info.getBoundingClientRect(),a=e.getBoundingClientRect(),r=this.space;if(!r){let o=this.dom.ownerDocument.documentElement;r={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return a.top>Math.min(r.bottom,t.bottom)-10||a.bottom<Math.max(r.top,t.top)+10?null:this.view.state.facet(Va).positionInfo(this.view,t,a,s,r,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,s){const a=document.createElement("ul");a.id=t,a.setAttribute("role","listbox"),a.setAttribute("aria-expanded","true"),a.setAttribute("aria-label",this.view.state.phrase("Completions")),a.addEventListener("mousedown",o=>{o.target==a&&o.preventDefault()});let r=null;for(let o=s.from;o<s.to;o++){let{completion:i,match:l}=e[o],{section:c}=i;if(c){let m=typeof c=="string"?c:c.name;if(m!=r&&(o>s.from||s.from==0))if(r=m,typeof c!="string"&&c.header)a.appendChild(c.header(c));else{let f=a.appendChild(document.createElement("completion-section"));f.textContent=m}}const u=a.appendChild(document.createElement("li"));u.id=t+"-"+o,u.setAttribute("role","option");let h=this.optionClass(i);h&&(u.className=h);for(let m of this.optionContent){let f=m(i,this.view.state,this.view,l);f&&u.appendChild(f)}}return s.from&&a.classList.add("cm-completionListIncompleteTop"),s.to<e.length&&a.classList.add("cm-completionListIncompleteBottom"),a}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function cue(n,e){return t=>new lue(t,n,e)}function uue(n,e){let t=n.getBoundingClientRect(),s=e.getBoundingClientRect(),a=t.height/n.offsetHeight;s.top<t.top?n.scrollTop-=(t.top-s.top)/a:s.bottom>t.bottom&&(n.scrollTop+=(s.bottom-t.bottom)/a)}function YD(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function hue(n,e){let t=[],s=null,a=null,r=u=>{t.push(u);let{section:h}=u.completion;if(h){s||(s=[]);let m=typeof h=="string"?h:h.name;s.some(f=>f.name==m)||s.push(typeof h=="string"?{name:m}:h)}},o=e.facet(Va);for(let u of n)if(u.hasResult()){let h=u.result.getMatch;if(u.result.filter===!1)for(let m of u.result.options)r(new qD(m,u.source,h?h(m):[],1e9-t.length));else{let m=e.sliceDoc(u.from,u.to),f,v=o.filterStrict?new rue(m):new aue(m);for(let O of u.result.options)if(f=v.match(O.label)){let k=O.displayLabel?h?h(O,f.matched):[]:f.matched,M=f.score+(O.boost||0);if(r(new qD(O,u.source,k,M)),typeof O.section=="object"&&O.section.rank==="dynamic"){let{name:E}=O.section;a||(a=Object.create(null)),a[E]=Math.max(M,a[E]||-1e9)}}}}if(s){let u=Object.create(null),h=0,m=(f,v)=>(f.rank==="dynamic"&&v.rank==="dynamic"?a[v.name]-a[f.name]:0)||(typeof f.rank=="number"?f.rank:1e9)-(typeof v.rank=="number"?v.rank:1e9)||(f.name<v.name?-1:1);for(let f of s.sort(m))h-=1e5,u[f.name]=h;for(let f of t){let{section:v}=f.completion;v&&(f.score+=u[typeof v=="string"?v:v.name])}}let i=[],l=null,c=o.compareCompletions;for(let u of t.sort((h,m)=>m.score-h.score||c(h.completion,m.completion))){let h=u.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?i.push(u):YD(u.completion)>YD(l)&&(i[i.length-1]=u),l=u.completion}return i}class vd{constructor(e,t,s,a,r,o){this.options=e,this.attrs=t,this.tooltip=s,this.timestamp=a,this.selected=r,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new vd(this.options,KD(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,s,a,r,o){if(a&&!o&&e.some(c=>c.isPending))return a.setDisabled();let i=hue(e,t);if(!i.length)return a&&e.some(c=>c.isPending)?a.setDisabled():null;let l=t.facet(Va).selectOnOpen?0:-1;if(a&&a.selected!=l&&a.selected!=-1){let c=a.options[a.selected].completion;for(let u=0;u<i.length;u++)if(i[u].completion==c){l=u;break}}return new vd(i,KD(s,l),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:bue,above:r.aboveCursor},a?a.timestamp:Date.now(),l,!1)}map(e){return new vd(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new vd(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class J1{constructor(e,t,s){this.active=e,this.id=t,this.open=s}static start(){return new J1(fue,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,s=t.facet(Va),r=(s.override||t.languageDataAt("autocomplete",Ch(t)).map(sue)).map(l=>(this.active.find(u=>u.source==l)||new ui(l,this.active.some(u=>u.state!=0)?1:0)).update(e,s));r.length==this.active.length&&r.every((l,c)=>l==this.active[c])&&(r=this.active);let o=this.open,i=e.effects.some(l=>l.is(RM));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||r.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!due(r,this.active)||i?o=vd.build(r,t,this.id,o,s,i):o&&o.disabled&&!r.some(l=>l.isPending)&&(o=null),!o&&r.every(l=>!l.isPending)&&r.some(l=>l.hasResult())&&(r=r.map(l=>l.hasResult()?new ui(l.source,0):l));for(let l of e.effects)l.is(m$)&&(o=o&&o.setSelected(l.value,this.id));return r==this.active&&o==this.open?this:new J1(r,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?mue:pue}}function due(n,e){if(n==e)return!0;for(let t=0,s=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;s<e.length&&!e[s].hasResult();)s++;let a=t==n.length,r=s==e.length;if(a||r)return a==r;if(n[t++].result!=e[s++].result)return!1}}const mue={"aria-autocomplete":"list"},pue={};function KD(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const fue=[];function d$(n,e){if(n.isUserEvent("input.complete")){let s=n.annotation($M);if(s&&e.activateOnCompletion(s))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class ui{constructor(e,t,s=!1){this.source=e,this.state=t,this.explicit=s}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let s=d$(e,t),a=this;(s&8||s&16&&this.touches(e))&&(a=new ui(a.source,0)),s&4&&a.state==0&&(a=new ui(this.source,1)),a=a.updateFor(e,s);for(let r of e.effects)if(r.is(K1))a=new ui(a.source,1,r.value);else if(r.is(Gf))a=new ui(a.source,0);else if(r.is(RM))for(let o of r.value)o.source==a.source&&(a=o);return a}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Ch(e.state))}}class Nd extends ui{constructor(e,t,s,a,r,o){super(e,3,t),this.limit=s,this.result=a,this.from=r,this.to=o}hasResult(){return!0}updateFor(e,t){var s;if(!(t&3))return this.map(e.changes);let a=this.result;a.map&&!e.changes.empty&&(a=a.map(a,e.changes));let r=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),i=Ch(e.state);if(i>o||!a||t&2&&(Ch(e.startState)==this.from||i<this.limit))return new ui(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return gue(a.validFor,e.state,r,o)?new Nd(this.source,this.explicit,l,a,r,o):a.update&&(a=a.update(a,r,o,new c$(e.state,i,!1)))?new Nd(this.source,this.explicit,l,a,a.from,(s=a.to)!==null&&s!==void 0?s:Ch(e.state)):new ui(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Nd(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ui(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function gue(n,e,t,s){if(!n)return!1;let a=e.sliceDoc(t,s);return typeof n=="function"?n(a,t,s,e):h$(n,!0).test(a)}const RM=cn.define({map(n,e){return n.map(t=>t.map(e))}}),m$=cn.define(),Sr=zs.define({create(){return J1.start()},update(n,e){return n.update(e)},provide:n=>[MM.from(n,e=>e.tooltip),ut.contentAttributes.from(n,e=>e.attrs)]});function _M(n,e){const t=e.completion.apply||e.completion.label;let s=n.state.field(Sr).active.find(a=>a.source==e.source);return s instanceof Nd?(typeof t=="string"?n.dispatch({...nue(n.state,t,s.from,s.to),annotations:$M.of(e.completion)}):t(n,e.completion,s.from,s.to),!0):!1}const bue=cue(Sr,_M);function ou(n,e="option"){return t=>{let s=t.state.field(Sr,!1);if(!s||!s.open||s.open.disabled||Date.now()-s.open.timestamp<t.state.facet(Va).interactionDelay)return!1;let a=1,r;e=="page"&&(r=S6(t,s.open.tooltip))&&(a=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=s.open.options,i=s.open.selected>-1?s.open.selected+a*(n?1:-1):n?0:o-1;return i<0?i=e=="page"?0:o-1:i>=o&&(i=e=="page"?o-1:0),t.dispatch({effects:m$.of(i)}),!0}}const f2=n=>{let e=n.state.field(Sr,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(Va).interactionDelay?!1:_M(n,e.open.options[e.open.selected])},Yb=n=>n.state.field(Sr,!1)?(n.dispatch({effects:K1.of(!0)}),!0):!1,p$=n=>{let e=n.state.field(Sr,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:Gf.of(null)}),!0)};class yue{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const vue=50,wue=1e3,Oue=Ks.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(Sr).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(Sr),t=n.state.facet(Va);if(!n.selectionSet&&!n.docChanged&&n.startState.field(Sr)==e)return;let s=n.transactions.some(r=>{let o=d$(r,t);return o&8||(r.selection||r.docChanged)&&!(o&3)});for(let r=0;r<this.running.length;r++){let o=this.running[r];if(s||o.context.abortOnDocChange&&n.docChanged||o.updates.length+n.transactions.length>vue&&Date.now()-o.time>wue){for(let i of o.context.abortListeners)try{i()}catch(l){oo(this.view.state,l)}o.context.abortListeners=null,this.running.splice(r--,1)}else o.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(r=>r.effects.some(o=>o.is(K1)))&&(this.pendingStart=!0);let a=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(r=>r.isPending&&!this.running.some(o=>o.active.source==r.source))?setTimeout(()=>this.startUpdate(),a):-1,this.composing!=0)for(let r of n.transactions)r.isUserEvent("input.type")?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(Sr);for(let t of e.active)t.isPending&&!this.running.some(s=>s.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Va).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=Ch(e),s=new c$(e,t,n.explicit,this.view),a=new yue(n,s);this.running.push(a),Promise.resolve(n.source(s)).then(r=>{a.context.aborted||(a.done=r||null,this.scheduleAccept())},r=>{this.view.dispatch({effects:Gf.of(null)}),oo(this.view.state,r)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Va).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Va),s=this.view.state.field(Sr);for(let a=0;a<this.running.length;a++){let r=this.running[a];if(r.done===void 0)continue;if(this.running.splice(a--,1),r.done){let i=Ch(r.updates.length?r.updates[0].startState:this.view.state),l=Math.min(i,r.done.from+(r.active.explicit?0:1)),c=new Nd(r.active.source,r.active.explicit,l,r.done,r.done.from,(n=r.done.to)!==null&&n!==void 0?n:i);for(let u of r.updates)c=c.update(u,t);if(c.hasResult()){e.push(c);continue}}let o=s.active.find(i=>i.source==r.active.source);if(o&&o.isPending)if(r.done==null){let i=new ui(r.active.source,0);for(let l of r.updates)i=i.update(l,t);i.isPending||e.push(i)}else this.startQuery(o)}(e.length||s.open&&s.open.disabled)&&this.view.dispatch({effects:RM.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(Sr,!1);if(e&&e.tooltip&&this.view.state.facet(Va).closeOnBlur){let t=e.open&&S6(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Gf.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:K1.of(!1)}),20),this.composing=0}}}),xue=typeof navigator=="object"&&/Win/.test(navigator.platform),kue=jo.highest(ut.domEventHandlers({keydown(n,e){let t=e.state.field(Sr,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(xue&&n.altKey)||n.metaKey)return!1;let s=t.open.options[t.open.selected],a=t.active.find(o=>o.source==s.source),r=s.completion.commitCharacters||a.result.commitCharacters;return r&&r.indexOf(n.key)>-1&&_M(e,s),!1}})),f$=ut.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Pue{constructor(e,t,s,a){this.field=e,this.line=t,this.from=s,this.to=a}}class LM{constructor(e,t,s){this.field=e,this.from=t,this.to=s}map(e){let t=e.mapPos(this.from,-1,fa.TrackDel),s=e.mapPos(this.to,1,fa.TrackDel);return t==null||s==null?null:new LM(this.field,t,s)}}class IM{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let s=[],a=[t],r=e.doc.lineAt(t),o=/^\s*/.exec(r.text)[0];for(let l of this.lines){if(s.length){let c=o,u=/^\t*/.exec(l)[0].length;for(let h=0;h<u;h++)c+=e.facet(lm);a.push(t+c.length-u),l=c+l.slice(u)}s.push(l),t+=l.length+1}let i=this.fieldPositions.map(l=>new LM(l.field,a[l.line]+l.from,a[l.line]+l.to));return{text:s,ranges:i}}static parse(e){let t=[],s=[],a=[],r;for(let o of e.split(/\r\n?|\n/)){for(;r=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(o);){let i=r[1]?+r[1]:null,l=r[2]||r[3]||"",c=-1,u=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<t.length;h++)(i!=null?t[h].seq==i:u&&t[h].name==u)&&(c=h);if(c<0){let h=0;for(;h<t.length&&(i==null||t[h].seq!=null&&t[h].seq<i);)h++;t.splice(h,0,{seq:i,name:u}),c=h;for(let m of a)m.field>=c&&m.field++}for(let h of a)if(h.line==s.length&&h.from>r.index){let m=r[2]?3+(r[1]||"").length:2;h.from-=m,h.to-=m}a.push(new Pue(c,s.length,r.index,r.index+u.length)),o=o.slice(0,r.index)+l+o.slice(r.index+r[0].length)}o=o.replace(/\\([{}])/g,(i,l,c)=>{for(let u of a)u.line==s.length&&u.from>c&&(u.from--,u.to--);return l}),s.push(o)}return new IM(s,a)}}let Sue=Et.widget({widget:new class extends ol{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),Cue=Et.mark({class:"cm-snippetField"});class Rm{constructor(e,t){this.ranges=e,this.active=t,this.deco=Et.set(e.map(s=>(s.from==s.to?Sue:Cue).range(s.from,s.to)),!0)}map(e){let t=[];for(let s of this.ranges){let a=s.map(e);if(!a)return null;t.push(a)}return new Rm(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(s=>s.field==this.active&&s.from<=t.from&&s.to>=t.to))}}const Vg=cn.define({map(n,e){return n&&n.map(e)}}),Mue=cn.define(),Xf=zs.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(Vg))return t.value;if(t.is(Mue)&&n)return new Rm(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>ut.decorations.from(n,e=>e?e.deco:Et.none)});function QM(n,e){return Ve.create(n.filter(t=>t.field==e).map(t=>Ve.range(t.from,t.to)))}function Aue(n){let e=IM.parse(n);return(t,s,a,r)=>{let{text:o,ranges:i}=e.instantiate(t.state,a),{main:l}=t.state.selection,c={changes:{from:a,to:r==l.from?l.to:r,insert:rs.of(o)},scrollIntoView:!0,annotations:s?[$M.of(s),ba.userEvent.of("input.complete")]:void 0};if(i.length&&(c.selection=QM(i,0)),i.some(u=>u.field>0)){let u=new Rm(i,0),h=c.effects=[Vg.of(u)];t.state.field(Xf,!1)===void 0&&h.push(cn.appendConfig.of([Xf,Nue,Bue,f$]))}t.dispatch(t.state.update(c))}}function g$(n){return({state:e,dispatch:t})=>{let s=e.field(Xf,!1);if(!s||n<0&&s.active==0)return!1;let a=s.active+n,r=n>0&&!s.ranges.some(o=>o.field==a+n);return t(e.update({selection:QM(s.ranges,a),effects:Vg.of(r?null:new Rm(s.ranges,a)),scrollIntoView:!0})),!0}}const Eue=({state:n,dispatch:e})=>n.field(Xf,!1)?(e(n.update({effects:Vg.of(null)})),!0):!1,Due=g$(1),Tue=g$(-1),Fue=[{key:"Tab",run:Due,shift:Tue},{key:"Escape",run:Eue}],JD=Lt.define({combine(n){return n.length?n[0]:Fue}}),Nue=jo.highest(Qc.compute([JD],n=>n.facet(JD)));function jr(n,e){return{...e,apply:Aue(n)}}const Bue=ut.domEventHandlers({mousedown(n,e){let t=e.state.field(Xf,!1),s;if(!t||(s=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let a=t.ranges.find(r=>r.from<=s&&r.to>=s);return!a||a.field==t.active?!1:(e.dispatch({selection:QM(t.ranges,a.field),effects:Vg.of(t.ranges.some(r=>r.field>a.field)?new Rm(t.ranges,a.field):null),scrollIntoView:!0}),!0)}}),Wf={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},fh=cn.define({map(n,e){let t=e.mapPos(n,-1,fa.TrackAfter);return t??void 0}}),VM=new class extends Rh{};VM.startSide=1;VM.endSide=-1;const b$=zs.define({create(){return ss.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:s=>s>=t.from&&s<=t.to})}for(let t of e.effects)t.is(fh)&&(n=n.update({add:[VM.range(t.value,t.value+1)]}));return n}});function y$(){return[Rue,b$]}const tx="()[]{}<>«»»«［］｛｝";function v$(n){for(let e=0;e<tx.length;e+=2)if(tx.charCodeAt(e)==n)return tx.charAt(e+1);return mM(n<128?n:n+1)}function w$(n,e){return n.languageDataAt("closeBrackets",e)[0]||Wf}const $ue=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Rue=ut.inputHandler.of((n,e,t,s)=>{if(($ue?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let a=n.state.selection.main;if(s.length>2||s.length==2&&Sl(so(s,0))==1||e!=a.from||t!=a.to)return!1;let r=_ue(n.state,s);return r?(n.dispatch(r),!0):!1}),O$=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let s=w$(n,n.selection.main.head).brackets||Wf.brackets,a=null,r=n.changeByRange(o=>{if(o.empty){let i=Lue(n.doc,o.head);for(let l of s)if(l==i&&ew(n.doc,o.head)==v$(so(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:Ve.cursor(o.head-l.length)}}return{range:a=o}});return a||e(n.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!a},x$=[{key:"Backspace",run:O$}];function _ue(n,e){let t=w$(n,n.selection.main.head),s=t.brackets||Wf.brackets;for(let a of s){let r=v$(so(a,0));if(e==a)return r==a?Vue(n,a,s.indexOf(a+a+a)>-1,t):Iue(n,a,r,t.before||Wf.before);if(e==r&&k$(n,n.selection.main.from))return Que(n,a,r)}return null}function k$(n,e){let t=!1;return n.field(b$).between(0,n.doc.length,s=>{s==e&&(t=!0)}),t}function ew(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Sl(so(t,0)))}function Lue(n,e){let t=n.sliceString(e-2,e);return Sl(so(t,0))==t.length?t:t.slice(1)}function Iue(n,e,t,s){let a=null,r=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:fh.of(o.to+e.length),range:Ve.range(o.anchor+e.length,o.head+e.length)};let i=ew(n.doc,o.head);return!i||/\s/.test(i)||s.indexOf(i)>-1?{changes:{insert:e+t,from:o.head},effects:fh.of(o.head+e.length),range:Ve.cursor(o.head+e.length)}:{range:a=o}});return a?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Que(n,e,t){let s=null,a=n.changeByRange(r=>r.empty&&ew(n.doc,r.head)==t?{changes:{from:r.head,to:r.head+t.length,insert:t},range:Ve.cursor(r.head+t.length)}:s={range:r});return s?null:n.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function Vue(n,e,t,s){let a=s.stringPrefixes||Wf.stringPrefixes,r=null,o=n.changeByRange(i=>{if(!i.empty)return{changes:[{insert:e,from:i.from},{insert:e,from:i.to}],effects:fh.of(i.to+e.length),range:Ve.range(i.anchor+e.length,i.head+e.length)};let l=i.head,c=ew(n.doc,l),u;if(c==e){if(e7(n,l))return{changes:{insert:e+e,from:l},effects:fh.of(l+e.length),range:Ve.cursor(l+e.length)};if(k$(n,l)){let m=t&&n.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+m.length,insert:m},range:Ve.cursor(l+m.length)}}}else{if(t&&n.sliceDoc(l-2*e.length,l)==e+e&&(u=t7(n,l-2*e.length,a))>-1&&e7(n,u))return{changes:{insert:e+e+e+e,from:l},effects:fh.of(l+e.length),range:Ve.cursor(l+e.length)};if(n.charCategorizer(l)(c)!=Hs.Word&&t7(n,l,a)>-1&&!jue(n,l,e,a))return{changes:{insert:e+e,from:l},effects:fh.of(l+e.length),range:Ve.cursor(l+e.length)}}return{range:r=i}});return r?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function e7(n,e){let t=Ea(n).resolveInner(e+1);return t.parent&&t.from==e}function jue(n,e,t,s){let a=Ea(n).resolveInner(e,-1),r=s.reduce((o,i)=>Math.max(o,i.length),0);for(let o=0;o<5;o++){let i=n.sliceDoc(a.from,Math.min(a.to,a.from+t.length+r)),l=i.indexOf(t);if(!l||l>-1&&s.indexOf(i.slice(0,l))>-1){let u=a.firstChild;for(;u&&u.from==a.from&&u.to-u.from>t.length+l;){if(n.sliceDoc(u.to-t.length,u.to)==t)return!1;u=u.firstChild}return!0}let c=a.to==e&&a.parent;if(!c)break;a=c}return!1}function t7(n,e,t){let s=n.charCategorizer(e);if(s(n.sliceDoc(e-1,e))!=Hs.Word)return e;for(let a of t){let r=e-a.length;if(n.sliceDoc(r,e)==a&&s(n.sliceDoc(r-1,r))!=Hs.Word)return r}return-1}function Zue(n={}){return[kue,Sr,Va.of(n),Oue,Gue,f$]}const zue=[{key:"Ctrl-Space",run:Yb},{mac:"Alt-`",run:Yb},{mac:"Alt-i",run:Yb},{key:"Escape",run:p$},{key:"ArrowDown",run:ou(!0)},{key:"ArrowUp",run:ou(!1)},{key:"PageDown",run:ou(!0,"page")},{key:"PageUp",run:ou(!1,"page")},{key:"Enter",run:f2}],Gue=jo.highest(Qc.computeN([Va],n=>n.facet(Va).defaultKeymap?[zue]:[]));function Xue(n){let e=n.field(Sr,!1);return e&&e.active.some(t=>t.isPending)?"pending":e&&e.active.some(t=>t.state!=0)?"active":null}const P$=[jr("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),jr("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),jr("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),jr("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),jr("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),jr(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),jr("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),jr(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),jr(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),jr('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),jr('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],Wue=P$.concat([jr("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),jr("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),jr("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),n7=new wle,S$=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function bp(n){return(e,t)=>{let s=e.node.getChild("VariableDefinition");return s&&t(s,n),!0}}const que=["FunctionDeclaration"],Uue={FunctionDeclaration:bp("function"),ClassDeclaration:bp("class"),ClassExpression:()=>!0,EnumDeclaration:bp("constant"),TypeAliasDeclaration:bp("type"),NamespaceDeclaration:bp("namespace"),VariableDefinition(n,e){n.matchContext(que)||e(n,"variable")},TypeDefinition(n,e){e(n,"type")},__proto__:null};function C$(n,e){let t=n7.get(e);if(t)return t;let s=[],a=!0;function r(o,i){let l=n.sliceString(o.from,o.to);s.push({label:l,type:i})}return e.cursor(Sa.IncludeAnonymous).iterate(o=>{if(a)a=!1;else if(o.name){let i=Uue[o.name];if(i&&i(o,r)||S$.has(o.name))return!1}else if(o.to-o.from>8192){for(let i of C$(n,o.node))s.push(i);return!1}}),n7.set(e,s),s}const s7=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,M$=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function Hue(n){let e=Ea(n.state).resolveInner(n.pos,-1);if(M$.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&s7.test(n.state.sliceDoc(e.from,e.to));if(!t&&!n.explicit)return null;let s=[];for(let a=e;a;a=a.parent)S$.has(a.name)&&(s=s.concat(C$(n.state.doc,a)));return{options:s,from:t?e.from:n.pos,validFor:s7}}const pu=X1.define({name:"javascript",parser:fce.configure({props:[Z6.add({IfStatement:HO({except:/^\s*({|else\b)/}),TryStatement:HO({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:Mce,SwitchBody:n=>{let e=n.textAfter,t=/^\s*\}/.test(e),s=/^\s*(case|default)\b/.test(e);return n.baseIndent+(t?0:s?1:2)*n.unit},Block:Cce({closing:"}"}),ArrowFunction:n=>n.baseIndent+n.unit,"TemplateString BlockComment":()=>null,"Statement Property":HO({except:/^\s*{/}),JSXElement(n){let e=/^\s*<\//.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},JSXEscape(n){let e=/\s*\}/.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},"JSXOpenTag JSXSelfClosingTag"(n){return n.column(n.node.from)+n.unit}}),X6.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":Ece,BlockComment(n){return{from:n.from+2,to:n.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),A$={test:n=>/^JSX/.test(n.name),facet:I6({commentTokens:{block:{open:"{/*",close:"*/}"}}})},Yue=pu.configure({dialect:"ts"},"typescript"),Kue=pu.configure({dialect:"jsx",props:[FM.add(n=>n.isTop?[A$]:void 0)]}),Jue=pu.configure({dialect:"jsx ts",props:[FM.add(n=>n.isTop?[A$]:void 0)]},"typescript");let E$=n=>({label:n,type:"keyword"});const D$="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(E$),ehe=D$.concat(["declare","implements","private","protected","public"].map(E$));function the(n={}){let e=n.jsx?n.typescript?Jue:Kue:n.typescript?Yue:pu,t=n.typescript?Wue.concat(ehe):P$.concat(D$);return new yce(e,[pu.data.of({autocomplete:tue(M$,u$(t))}),pu.data.of({autocomplete:Hue}),n.jsx?ahe:[]])}function nhe(n){for(;;){if(n.name=="JSXOpenTag"||n.name=="JSXSelfClosingTag"||n.name=="JSXFragmentTag")return n;if(n.name=="JSXEscape"||!n.parent)return null;n=n.parent}}function a7(n,e,t=n.length){for(let s=e==null?void 0:e.firstChild;s;s=s.nextSibling)if(s.name=="JSXIdentifier"||s.name=="JSXBuiltin"||s.name=="JSXNamespacedName"||s.name=="JSXMemberExpression")return n.sliceString(s.from,Math.min(s.to,t));return""}const she=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),ahe=ut.inputHandler.of((n,e,t,s,a)=>{if((she?n.composing:n.compositionStarted)||n.state.readOnly||e!=t||s!=">"&&s!="/"||!pu.isActiveAt(n.state,e,-1))return!1;let r=a(),{state:o}=r,i=o.changeByRange(l=>{var c;let{head:u}=l,h=Ea(o).resolveInner(u-1,-1),m;if(h.name=="JSXStartTag"&&(h=h.parent),!(o.doc.sliceString(u-1,u)!=s||h.name=="JSXAttributeValue"&&h.to>u)){if(s==">"&&h.name=="JSXFragmentTag")return{range:l,changes:{from:u,insert:"</>"}};if(s=="/"&&h.name=="JSXStartCloseTag"){let f=h.parent,v=f.parent;if(v&&f.from==u-2&&((m=a7(o.doc,v.firstChild,u))||((c=v.firstChild)===null||c===void 0?void 0:c.name)=="JSXFragmentTag")){let O=`${m}>`;return{range:Ve.cursor(u+O.length,-1),changes:{from:u,insert:O}}}}else if(s==">"){let f=nhe(h);if(f&&f.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(o.doc.sliceString(u,u+2))&&(m=a7(o.doc,f,u)))return{range:l,changes:{from:u,insert:`</${m}>`}}}}return{range:l}});return i.changes.empty?!1:(n.dispatch([r,o.update(i,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),rhe="#e5c07b",r7="#e06c75",ohe="#56b6c2",ihe="#ffffff",Kb="#abb2bf",g2="#7d8799",lhe="#61afef",che="#98c379",o7="#d19a66",uhe="#c678dd",hhe="#21252b",i7="#2c313a",l7="#282c34",nx="#353a42",dhe="#3E4451",c7="#528bff",mhe=ut.theme({"&":{color:Kb,backgroundColor:l7},".cm-content":{caretColor:c7},".cm-cursor, .cm-dropCursor":{borderLeftColor:c7},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:dhe},".cm-panels":{backgroundColor:hhe,color:Kb},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:l7,color:g2,border:"none"},".cm-activeLineGutter":{backgroundColor:i7},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:nx},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:nx,borderBottomColor:nx},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:i7,color:Kb}}},{dark:!0}),phe=$m.define([{tag:y.keyword,color:uhe},{tag:[y.name,y.deleted,y.character,y.propertyName,y.macroName],color:r7},{tag:[y.function(y.variableName),y.labelName],color:lhe},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:o7},{tag:[y.definition(y.name),y.separator],color:Kb},{tag:[y.typeName,y.className,y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:rhe},{tag:[y.operator,y.operatorKeyword,y.url,y.escape,y.regexp,y.link,y.special(y.string)],color:ohe},{tag:[y.meta,y.comment],color:g2},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.link,color:g2,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:r7},{tag:[y.atom,y.bool,y.special(y.variableName)],color:o7},{tag:[y.processingInstruction,y.string,y.inserted],color:che},{tag:y.invalid,color:ihe}]),fhe=[mhe,Jv(phe)],jM=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),s=ZM(n.state,t.from);return s.line?ghe(n):s.block?vhe(n):!1};function jg(n,e){return({state:t,dispatch:s})=>{if(t.readOnly)return!1;let a=n(e,t);return a?(s(t.update(a)),!0):!1}}const ghe=jg(zM,0),bhe=jg(zM,1),yhe=jg(zM,2),T$=jg(F$,0),vhe=jg((n,e)=>F$(n,e,Ohe(e)),0);function ZM(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const yp=50;function whe(n,{open:e,close:t},s,a){let r=n.sliceDoc(s-yp,s),o=n.sliceDoc(a,a+yp),i=/\s*$/.exec(r)[0].length,l=/^\s*/.exec(o)[0].length,c=r.length-i;if(r.slice(c-e.length,c)==e&&o.slice(l,l+t.length)==t)return{open:{pos:s-i,margin:i&&1},close:{pos:a+l,margin:l&&1}};let u,h;a-s<=2*yp?u=h=n.sliceDoc(s,a):(u=n.sliceDoc(s,s+yp),h=n.sliceDoc(a-yp,a));let m=/^\s*/.exec(u)[0].length,f=/\s*$/.exec(h)[0].length,v=h.length-f-t.length;return u.slice(m,m+e.length)==e&&h.slice(v,v+t.length)==t?{open:{pos:s+m+e.length,margin:/\s/.test(u.charAt(m+e.length))?1:0},close:{pos:a-f-t.length,margin:/\s/.test(h.charAt(v-1))?1:0}}:null}function Ohe(n){let e=[];for(let t of n.selection.ranges){let s=n.doc.lineAt(t.from),a=t.to<=s.to?s:n.doc.lineAt(t.to);a.from>s.from&&a.from==t.to&&(a=t.to==s.to+1?s:n.doc.lineAt(t.to-1));let r=e.length-1;r>=0&&e[r].to>s.from?e[r].to=a.to:e.push({from:s.from+/^\s*/.exec(s.text)[0].length,to:a.to})}return e}function F$(n,e,t=e.selection.ranges){let s=t.map(r=>ZM(e,r.from).block);if(!s.every(r=>r))return null;let a=t.map((r,o)=>whe(e,s[o],r.from,r.to));if(n!=2&&!a.every(r=>r))return{changes:e.changes(t.map((r,o)=>a[o]?[]:[{from:r.from,insert:s[o].open+" "},{from:r.to,insert:" "+s[o].close}]))};if(n!=1&&a.some(r=>r)){let r=[];for(let o=0,i;o<a.length;o++)if(i=a[o]){let l=s[o],{open:c,close:u}=i;r.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:r}}return null}function zM(n,e,t=e.selection.ranges){let s=[],a=-1;for(let{from:r,to:o}of t){let i=s.length,l=1e9,c=ZM(e,r).line;if(c){for(let u=r;u<=o;){let h=e.doc.lineAt(u);if(h.from>a&&(r==o||o>h.from)){a=h.from;let m=/^\s*/.exec(h.text)[0].length,f=m==h.length,v=h.text.slice(m,m+c.length)==c?m:-1;m<h.text.length&&m<l&&(l=m),s.push({line:h,comment:v,token:c,indent:m,empty:f,single:!1})}u=h.to+1}if(l<1e9)for(let u=i;u<s.length;u++)s[u].indent<s[u].line.text.length&&(s[u].indent=l);s.length==i+1&&(s[i].single=!0)}}if(n!=2&&s.some(r=>r.comment<0&&(!r.empty||r.single))){let r=[];for(let{line:i,token:l,indent:c,empty:u,single:h}of s)(h||!u)&&r.push({from:i.from+c,insert:l+" "});let o=e.changes(r);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&s.some(r=>r.comment>=0)){let r=[];for(let{line:o,comment:i,token:l}of s)if(i>=0){let c=o.from+i,u=c+l.length;o.text[u-o.from]==" "&&u++,r.push({from:c,to:u})}return{changes:r}}return null}const b2=Ic.define(),xhe=Ic.define(),khe=Lt.define(),N$=Lt.define({combine(n){return Kl(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(s,a)=>e(s,a)||t(s,a)})}}),B$=zs.define({create(){return Tl.empty},update(n,e){let t=e.state.facet(N$),s=e.annotation(b2);if(s){let l=io.fromTransaction(e,s.selection),c=s.side,u=c==0?n.undone:n.done;return l?u=ey(u,u.length,t.minDepth,l):u=_$(u,e.startState.selection),new Tl(c==0?s.rest:u,c==0?u:s.rest)}let a=e.annotation(xhe);if((a=="full"||a=="before")&&(n=n.isolate()),e.annotation(ba.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let r=io.fromTransaction(e),o=e.annotation(ba.time),i=e.annotation(ba.userEvent);return r?n=n.addChanges(r,o,i,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,i,t.newGroupDelay)),(a=="full"||a=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Tl(n.done.map(io.fromJSON),n.undone.map(io.fromJSON))}});function GM(n={}){return[B$,N$.of(n),ut.domEventHandlers({beforeinput(e,t){let s=e.inputType=="historyUndo"?nw:e.inputType=="historyRedo"?cm:null;return s?(e.preventDefault(),s(t)):!1}})]}function tw(n,e){return function({state:t,dispatch:s}){if(!e&&t.readOnly)return!1;let a=t.field(B$,!1);if(!a)return!1;let r=a.pop(n,t,e);return r?(s(r),!0):!1}}const nw=tw(0,!1),cm=tw(1,!1),$$=tw(0,!0),Phe=tw(1,!0);class io{constructor(e,t,s,a,r){this.changes=e,this.effects=t,this.mapped=s,this.startSelection=a,this.selectionsAfter=r}setSelAfter(e){return new io(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,s;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(s=this.startSelection)===null||s===void 0?void 0:s.toJSON(),selectionsAfter:this.selectionsAfter.map(a=>a.toJSON())}}static fromJSON(e){return new io(e.changes&&ka.fromJSON(e.changes),[],e.mapped&&Rl.fromJSON(e.mapped),e.startSelection&&Ve.fromJSON(e.startSelection),e.selectionsAfter.map(Ve.fromJSON))}static fromTransaction(e,t){let s=hi;for(let a of e.startState.facet(khe)){let r=a(e);r.length&&(s=s.concat(r))}return!s.length&&e.changes.empty?null:new io(e.changes.invert(e.startState.doc),s,void 0,t||e.startState.selection,hi)}static selection(e){return new io(void 0,hi,void 0,void 0,e)}}function ey(n,e,t,s){let a=e+1>t+20?e-t-1:0,r=n.slice(a,e);return r.push(s),r}function She(n,e){let t=[],s=!1;return n.iterChangedRanges((a,r)=>t.push(a,r)),e.iterChangedRanges((a,r,o,i)=>{for(let l=0;l<t.length;){let c=t[l++],u=t[l++];i>=c&&o<=u&&(s=!0)}}),s}function Che(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,s)=>t.empty!=e.ranges[s].empty).length===0}function R$(n,e){return n.length?e.length?n.concat(e):n:e}const hi=[],Mhe=200;function _$(n,e){if(n.length){let t=n[n.length-1],s=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-Mhe));return s.length&&s[s.length-1].eq(e)?n:(s.push(e),ey(n,n.length-1,1e9,t.setSelAfter(s)))}else return[io.selection([e])]}function Ahe(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function sx(n,e){if(!n.length)return n;let t=n.length,s=hi;for(;t;){let a=Ehe(n[t-1],e,s);if(a.changes&&!a.changes.empty||a.effects.length){let r=n.slice(0,t);return r[t-1]=a,r}else e=a.mapped,t--,s=a.selectionsAfter}return s.length?[io.selection(s)]:hi}function Ehe(n,e,t){let s=R$(n.selectionsAfter.length?n.selectionsAfter.map(i=>i.map(e)):hi,t);if(!n.changes)return io.selection(s);let a=n.changes.map(e),r=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(r):r;return new io(a,cn.mapEffects(n.effects,e),o,n.startSelection.map(r),s)}const Dhe=/^(input\.type|delete)($|\.)/;class Tl{constructor(e,t,s=0,a=void 0){this.done=e,this.undone=t,this.prevTime=s,this.prevUserEvent=a}isolate(){return this.prevTime?new Tl(this.done,this.undone):this}addChanges(e,t,s,a,r){let o=this.done,i=o[o.length-1];return i&&i.changes&&!i.changes.empty&&e.changes&&(!s||Dhe.test(s))&&(!i.selectionsAfter.length&&t-this.prevTime<a.newGroupDelay&&a.joinToEvent(r,She(i.changes,e.changes))||s=="input.type.compose")?o=ey(o,o.length-1,a.minDepth,new io(e.changes.compose(i.changes),R$(cn.mapEffects(e.effects,i.changes),i.effects),i.mapped,i.startSelection,hi)):o=ey(o,o.length,a.minDepth,e),new Tl(o,hi,t,s)}addSelection(e,t,s,a){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:hi;return r.length>0&&t-this.prevTime<a&&s==this.prevUserEvent&&s&&/^select($|\.)/.test(s)&&Che(r[r.length-1],e)?this:new Tl(_$(this.done,e),this.undone,t,s)}addMapping(e){return new Tl(sx(this.done,e),sx(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,s){let a=e==0?this.done:this.undone;if(a.length==0)return null;let r=a[a.length-1],o=r.selectionsAfter[0]||t.selection;if(s&&r.selectionsAfter.length)return t.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:b2.of({side:e,rest:Ahe(a),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let i=a.length==1?hi:a.slice(0,a.length-1);return r.mapped&&(i=sx(i,r.mapped)),t.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:b2.of({side:e,rest:i,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Tl.empty=new Tl(hi,hi);const XM=[{key:"Mod-z",run:nw,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:cm,preventDefault:!0},{linux:"Ctrl-Shift-z",run:cm,preventDefault:!0},{key:"Mod-u",run:$$,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Phe,preventDefault:!0}];function _m(n,e){return Ve.create(n.ranges.map(e),n.mainIndex)}function il(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function ll({state:n,dispatch:e},t){let s=_m(n.selection,t);return s.eq(n.selection,!0)?!1:(e(il(n,s)),!0)}function sw(n,e){return Ve.cursor(e?n.to:n.from)}function WM(n,e){return ll(n,t=>t.empty?n.moveByChar(t,e):sw(t,e))}function pr(n){return n.textDirectionAt(n.state.selection.main.head)==Es.LTR}const qf=n=>WM(n,!pr(n)),ty=n=>WM(n,pr(n)),The=n=>WM(n,!1);function L$(n,e){return ll(n,t=>t.empty?n.moveByGroup(t,e):sw(t,e))}const I$=n=>L$(n,!pr(n)),Q$=n=>L$(n,pr(n));function Fhe(n,e,t){if(e.type.prop(t))return!0;let s=e.to-e.from;return s&&(s>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function aw(n,e,t){let s=Ea(n).resolveInner(e.head),a=t?jn.closedBy:jn.openedBy;for(let l=e.head;;){let c=t?s.childAfter(l):s.childBefore(l);if(!c)break;Fhe(n,c,a)?s=c:l=t?c.to:c.from}let r=s.type.prop(a),o,i;return r&&(o=t?ci(n,s.from,1):ci(n,s.to,-1))&&o.matched?i=t?o.end.to:o.end.from:i=t?s.to:s.from,Ve.cursor(i,t?-1:1)}const Nhe=n=>ll(n,e=>aw(n.state,e,!pr(n))),Bhe=n=>ll(n,e=>aw(n.state,e,pr(n)));function V$(n,e){return ll(n,t=>{if(!t.empty)return sw(t,e);let s=n.moveVertically(t,e);return s.head!=t.head?s:n.moveToLineBoundary(t,e)})}const ny=n=>V$(n,!1),sy=n=>V$(n,!0);function j$(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,s=0,a;if(e){for(let r of n.state.facet(ut.scrollMargins)){let o=r(n);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(s=Math.max(o==null?void 0:o.bottom,s))}a=n.scrollDOM.clientHeight-t-s}else a=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:s,selfScroll:e,height:Math.max(n.defaultLineHeight,a-5)}}function Z$(n,e){let t=j$(n),{state:s}=n,a=_m(s.selection,o=>o.empty?n.moveVertically(o,e,t.height):sw(o,e));if(a.eq(s.selection))return!1;let r;if(t.selfScroll){let o=n.coordsAtPos(s.selection.main.head),i=n.scrollDOM.getBoundingClientRect(),l=i.top+t.marginTop,c=i.bottom-t.marginBottom;o&&o.top>l&&o.bottom<c&&(r=ut.scrollIntoView(a.main.head,{y:"start",yMargin:o.top-l}))}return n.dispatch(il(s,a),{effects:r}),!0}const wf=n=>Z$(n,!1),Bd=n=>Z$(n,!0);function ju(n,e,t){let s=n.lineBlockAt(e.head),a=n.moveToLineBoundary(e,t);if(a.head==e.head&&a.head!=(t?s.to:s.from)&&(a=n.moveToLineBoundary(e,t,!1)),!t&&a.head==s.from&&s.length){let r=/^\s*/.exec(n.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;r&&e.head!=s.from+r&&(a=Ve.cursor(s.from+r))}return a}const ay=n=>ll(n,e=>ju(n,e,!0)),ry=n=>ll(n,e=>ju(n,e,!1)),$he=n=>ll(n,e=>ju(n,e,!pr(n))),Rhe=n=>ll(n,e=>ju(n,e,pr(n))),z$=n=>ll(n,e=>Ve.cursor(n.lineBlockAt(e.head).from,1)),G$=n=>ll(n,e=>Ve.cursor(n.lineBlockAt(e.head).to,-1));function _he(n,e,t){let s=!1,a=_m(n.selection,r=>{let o=ci(n,r.head,-1)||ci(n,r.head,1)||r.head>0&&ci(n,r.head-1,1)||r.head<n.doc.length&&ci(n,r.head+1,-1);if(!o||!o.end)return r;s=!0;let i=o.start.from==r.head?o.end.to:o.end.from;return Ve.cursor(i)});return s?(e(il(n,a)),!0):!1}const X$=({state:n,dispatch:e})=>_he(n,e);function xi(n,e){let t=_m(n.state.selection,s=>{let a=e(s);return Ve.range(s.anchor,a.head,a.goalColumn,a.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(il(n.state,t)),!0)}function W$(n,e){return xi(n,t=>n.moveByChar(t,e))}const oy=n=>W$(n,!pr(n)),iy=n=>W$(n,pr(n));function q$(n,e){return xi(n,t=>n.moveByGroup(t,e))}const U$=n=>q$(n,!pr(n)),H$=n=>q$(n,pr(n)),Lhe=n=>xi(n,e=>aw(n.state,e,!pr(n))),Ihe=n=>xi(n,e=>aw(n.state,e,pr(n)));function Y$(n,e){return xi(n,t=>n.moveVertically(t,e))}const ly=n=>Y$(n,!1),cy=n=>Y$(n,!0);function K$(n,e){return xi(n,t=>n.moveVertically(t,e,j$(n).height))}const uy=n=>K$(n,!1),hy=n=>K$(n,!0),y2=n=>xi(n,e=>ju(n,e,!0)),v2=n=>xi(n,e=>ju(n,e,!1)),Qhe=n=>xi(n,e=>ju(n,e,!pr(n))),Vhe=n=>xi(n,e=>ju(n,e,pr(n))),J$=n=>xi(n,e=>Ve.cursor(n.lineBlockAt(e.head).from)),eR=n=>xi(n,e=>Ve.cursor(n.lineBlockAt(e.head).to)),dy=({state:n,dispatch:e})=>(e(il(n,{anchor:0})),!0),my=({state:n,dispatch:e})=>(e(il(n,{anchor:n.doc.length})),!0),py=({state:n,dispatch:e})=>(e(il(n,{anchor:n.selection.main.anchor,head:0})),!0),fy=({state:n,dispatch:e})=>(e(il(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),tR=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),nR=({state:n,dispatch:e})=>{let t=rw(n).map(({from:s,to:a})=>Ve.range(s,Math.min(a+1,n.doc.length)));return e(n.update({selection:Ve.create(t),userEvent:"select"})),!0},jhe=({state:n,dispatch:e})=>{let t=_m(n.selection,s=>{let a=Ea(n),r=a.resolveStack(s.from,1);if(s.empty){let o=a.resolveStack(s.from,-1);o.node.from>=r.node.from&&o.node.to<=r.node.to&&(r=o)}for(let o=r;o;o=o.next){let{node:i}=o;if((i.from<s.from&&i.to>=s.to||i.to>s.to&&i.from<=s.from)&&o.next)return Ve.range(i.to,i.from)}return s});return t.eq(n.selection)?!1:(e(il(n,t)),!0)};function sR(n,e){let{state:t}=n,s=t.selection,a=t.selection.ranges.slice();for(let r of t.selection.ranges){let o=t.doc.lineAt(r.head);if(e?o.to<n.state.doc.length:o.from>0)for(let i=r;;){let l=n.moveVertically(i,e);if(l.head<o.from||l.head>o.to){a.some(c=>c.head==l.head)||a.push(l);break}else{if(l.head==i.head)break;i=l}}}return a.length==s.ranges.length?!1:(n.dispatch(il(t,Ve.create(a,a.length-1))),!0)}const Zhe=n=>sR(n,!1),zhe=n=>sR(n,!0),Ghe=({state:n,dispatch:e})=>{let t=n.selection,s=null;return t.ranges.length>1?s=Ve.create([t.main]):t.main.empty||(s=Ve.create([Ve.cursor(t.main.head)])),s?(e(il(n,s)),!0):!1};function Lm(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:s}=n,a=s.changeByRange(r=>{let{from:o,to:i}=r;if(o==i){let l=e(r);l<o?(t="delete.backward",l=$0(n,l,!1)):l>o&&(t="delete.forward",l=$0(n,l,!0)),o=Math.min(o,l),i=Math.max(i,l)}else o=$0(n,o,!1),i=$0(n,i,!0);return o==i?{range:r}:{changes:{from:o,to:i},range:Ve.cursor(o,o<r.head?-1:1)}});return a.changes.empty?!1:(n.dispatch(s.update(a,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?ut.announce.of(s.phrase("Selection deleted")):void 0})),!0)}function $0(n,e,t){if(n instanceof ut)for(let s of n.state.facet(ut.atomicRanges).map(a=>a(n)))s.between(e,e,(a,r)=>{a<e&&r>e&&(e=t?r:a)});return e}const aR=(n,e,t)=>Lm(n,s=>{let a=s.from,{state:r}=n,o=r.doc.lineAt(a),i,l;if(t&&!e&&a>o.from&&a<o.from+200&&!/[^ \t]/.test(i=o.text.slice(0,a-o.from))){if(i[i.length-1]=="	")return a-1;let c=Bm(i,r.tabSize),u=c%q1(r)||q1(r);for(let h=0;h<u&&i[i.length-1-h]==" ";h++)a--;l=a}else l=Ha(o.text,a-o.from,e,e)+o.from,l==a&&o.number!=(e?r.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,a-o.from))&&(l=Ha(o.text,l-o.from,!1,!1)+o.from);return l}),$d=n=>aR(n,!1,!0),gy=n=>aR(n,!0,!1),rR=(n,e)=>Lm(n,t=>{let s=t.head,{state:a}=n,r=a.doc.lineAt(s),o=a.charCategorizer(s);for(let i=null;;){if(s==(e?r.to:r.from)){s==t.head&&r.number!=(e?a.doc.lines:1)&&(s+=e?1:-1);break}let l=Ha(r.text,s-r.from,e)+r.from,c=r.text.slice(Math.min(s,l)-r.from,Math.max(s,l)-r.from),u=o(c);if(i!=null&&u!=i)break;(c!=" "||s!=t.head)&&(i=u),s=l}return s}),by=n=>rR(n,!1),oR=n=>rR(n,!0),w2=n=>Lm(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),Xhe=n=>Lm(n,e=>{let t=n.lineBlockAt(e.head).from;return e.head>t?t:Math.max(0,e.head-1)}),Whe=n=>Lm(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),qhe=n=>Lm(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),qM=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:rs.of(["",""])},range:Ve.cursor(s.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},iR=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(s=>{if(!s.empty||s.from==0||s.from==n.doc.length)return{range:s};let a=s.from,r=n.doc.lineAt(a),o=a==r.from?a-1:Ha(r.text,a-r.from,!1)+r.from,i=a==r.to?a+1:Ha(r.text,a-r.from,!0)+r.from;return{changes:{from:o,to:i,insert:n.doc.slice(a,i).append(n.doc.slice(o,a))},range:Ve.cursor(i)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function rw(n){let e=[],t=-1;for(let s of n.selection.ranges){let a=n.doc.lineAt(s.from),r=n.doc.lineAt(s.to);if(!s.empty&&s.to==r.from&&(r=n.doc.lineAt(s.to-1)),t>=a.number){let o=e[e.length-1];o.to=r.to,o.ranges.push(s)}else e.push({from:a.from,to:r.to,ranges:[s]});t=r.number+1}return e}function lR(n,e,t){if(n.readOnly)return!1;let s=[],a=[];for(let r of rw(n)){if(t?r.to==n.doc.length:r.from==0)continue;let o=n.doc.lineAt(t?r.to+1:r.from-1),i=o.length+1;if(t){s.push({from:r.to,to:o.to},{from:r.from,insert:o.text+n.lineBreak});for(let l of r.ranges)a.push(Ve.range(Math.min(n.doc.length,l.anchor+i),Math.min(n.doc.length,l.head+i)))}else{s.push({from:o.from,to:r.from},{from:r.to,insert:n.lineBreak+o.text});for(let l of r.ranges)a.push(Ve.range(l.anchor-i,l.head-i))}}return s.length?(e(n.update({changes:s,scrollIntoView:!0,selection:Ve.create(a,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const cR=({state:n,dispatch:e})=>lR(n,e,!1),uR=({state:n,dispatch:e})=>lR(n,e,!0);function hR(n,e,t){if(n.readOnly)return!1;let s=[];for(let a of rw(n))t?s.push({from:a.from,insert:n.doc.slice(a.from,a.to)+n.lineBreak}):s.push({from:a.to,insert:n.lineBreak+n.doc.slice(a.from,a.to)});return e(n.update({changes:s,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const dR=({state:n,dispatch:e})=>hR(n,e,!1),mR=({state:n,dispatch:e})=>hR(n,e,!0),pR=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(rw(e).map(({from:a,to:r})=>(a>0?a--:r<e.doc.length&&r++,{from:a,to:r}))),s=_m(e.selection,a=>{let r;if(n.lineWrapping){let o=n.lineBlockAt(a.head),i=n.coordsAtPos(a.head,a.assoc||1);i&&(r=o.bottom+n.documentTop-i.bottom+n.defaultLineHeight/2)}return n.moveVertically(a,!0,r)}).map(t);return n.dispatch({changes:t,selection:s,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Uhe(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Ea(n).resolveInner(e),s=t.childBefore(e),a=t.childAfter(e),r;return s&&a&&s.to<=e&&a.from>=e&&(r=s.type.prop(jn.closedBy))&&r.indexOf(a.name)>-1&&n.doc.lineAt(s.to).from==n.doc.lineAt(a.from).from&&!/\S/.test(n.sliceDoc(s.to,a.from))?{from:s.to,to:a.from}:null}const Uf=fR(!1),Hhe=fR(!0);function fR(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let s=e.changeByRange(a=>{let{from:r,to:o}=a,i=e.doc.lineAt(r),l=!n&&r==o&&Uhe(e,r);n&&(r=o=(o<=i.to?i:e.doc.lineAt(o)).to);let c=new Yv(e,{simulateBreak:r,simulateDoubleBreak:!!l}),u=j6(c,r);for(u==null&&(u=Bm(/^\s*/.exec(e.doc.lineAt(r).text)[0],e.tabSize));o<i.to&&/\s/.test(i.text[o-i.from]);)o++;l?{from:r,to:o}=l:r>i.from&&r<i.from+100&&!/\S/.test(i.text.slice(0,r))&&(r=i.from);let h=["",U1(e,u)];return l&&h.push(U1(e,c.lineIndent(i.from,-1))),{changes:{from:r,to:o,insert:rs.of(h)},range:Ve.cursor(r+1+h[1].length)}});return t(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function UM(n,e){let t=-1;return n.changeByRange(s=>{let a=[];for(let o=s.from;o<=s.to;){let i=n.doc.lineAt(o);i.number>t&&(s.empty||s.to>i.from)&&(e(i,a,s),t=i.number),o=i.to+1}let r=n.changes(a);return{changes:a,range:Ve.range(r.mapPos(s.anchor,1),r.mapPos(s.head,1))}})}const gR=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),s=new Yv(n,{overrideIndentation:r=>{let o=t[r];return o??-1}}),a=UM(n,(r,o,i)=>{let l=j6(s,r.from);if(l==null)return;/\S/.test(r.text)||(l=0);let c=/^\s*/.exec(r.text)[0],u=U1(n,l);(c!=u||i.from<r.from+c.length)&&(t[r.from]=l,o.push({from:r.from,to:r.from+c.length,insert:u}))});return a.changes.empty||e(n.update(a,{userEvent:"indent"})),!0},Hf=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(UM(n,(t,s)=>{s.push({from:t.from,insert:n.facet(lm)})}),{userEvent:"input.indent"})),!0),Yf=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(UM(n,(t,s)=>{let a=/^\s*/.exec(t.text)[0];if(!a)return;let r=Bm(a,n.tabSize),o=0,i=U1(n,Math.max(0,r-q1(n)));for(;o<a.length&&o<i.length&&a.charCodeAt(o)==i.charCodeAt(o);)o++;s.push({from:t.from+o,to:t.from+a.length,insert:i.slice(o)})}),{userEvent:"delete.dedent"})),!0),Yhe=n=>(n.setTabFocusMode(),!0),Khe=[{key:"Ctrl-b",run:qf,shift:oy,preventDefault:!0},{key:"Ctrl-f",run:ty,shift:iy},{key:"Ctrl-p",run:ny,shift:ly},{key:"Ctrl-n",run:sy,shift:cy},{key:"Ctrl-a",run:z$,shift:J$},{key:"Ctrl-e",run:G$,shift:eR},{key:"Ctrl-d",run:gy},{key:"Ctrl-h",run:$d},{key:"Ctrl-k",run:w2},{key:"Ctrl-Alt-h",run:by},{key:"Ctrl-o",run:qM},{key:"Ctrl-t",run:iR},{key:"Ctrl-v",run:Bd}],Jhe=[{key:"ArrowLeft",run:qf,shift:oy,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:I$,shift:U$,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:$he,shift:Qhe,preventDefault:!0},{key:"ArrowRight",run:ty,shift:iy,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Q$,shift:H$,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Rhe,shift:Vhe,preventDefault:!0},{key:"ArrowUp",run:ny,shift:ly,preventDefault:!0},{mac:"Cmd-ArrowUp",run:dy,shift:py},{mac:"Ctrl-ArrowUp",run:wf,shift:uy},{key:"ArrowDown",run:sy,shift:cy,preventDefault:!0},{mac:"Cmd-ArrowDown",run:my,shift:fy},{mac:"Ctrl-ArrowDown",run:Bd,shift:hy},{key:"PageUp",run:wf,shift:uy},{key:"PageDown",run:Bd,shift:hy},{key:"Home",run:ry,shift:v2,preventDefault:!0},{key:"Mod-Home",run:dy,shift:py},{key:"End",run:ay,shift:y2,preventDefault:!0},{key:"Mod-End",run:my,shift:fy},{key:"Enter",run:Uf,shift:Uf},{key:"Mod-a",run:tR},{key:"Backspace",run:$d,shift:$d,preventDefault:!0},{key:"Delete",run:gy,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:by,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:oR,preventDefault:!0},{mac:"Mod-Backspace",run:Whe,preventDefault:!0},{mac:"Mod-Delete",run:qhe,preventDefault:!0}].concat(Khe.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),ow=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Nhe,shift:Lhe},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Bhe,shift:Ihe},{key:"Alt-ArrowUp",run:cR},{key:"Shift-Alt-ArrowUp",run:dR},{key:"Alt-ArrowDown",run:uR},{key:"Shift-Alt-ArrowDown",run:mR},{key:"Mod-Alt-ArrowUp",run:Zhe},{key:"Mod-Alt-ArrowDown",run:zhe},{key:"Escape",run:Ghe},{key:"Mod-Enter",run:Hhe},{key:"Alt-l",mac:"Ctrl-l",run:nR},{key:"Mod-i",run:jhe,preventDefault:!0},{key:"Mod-[",run:Yf},{key:"Mod-]",run:Hf},{key:"Mod-Alt-\\",run:gR},{key:"Shift-Mod-k",run:pR},{key:"Shift-Mod-\\",run:X$},{key:"Mod-/",run:jM},{key:"Alt-A",run:T$},{key:"Ctrl-m",mac:"Shift-Alt-m",run:Yhe}].concat(Jhe),ede={key:"Tab",run:Hf,shift:Yf},u7=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class um{constructor(e,t,s=0,a=e.length,r,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(s,a),this.bufferStart=s,this.normalize=r?i=>r(u7(i)):u7,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return so(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=mM(e),s=this.bufferStart+this.bufferPos;this.bufferPos+=Sl(e);let a=this.normalize(t);if(a.length)for(let r=0,o=s;;r++){let i=a.charCodeAt(r),l=this.match(i,o,this.bufferPos+this.bufferStart);if(r==a.length-1){if(l)return this.value=l,this;break}o==s&&r<t.length&&t.charCodeAt(r)==i&&o++}}}match(e,t,s){let a=null;for(let r=0;r<this.matches.length;r+=2){let o=this.matches[r],i=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?a={from:this.matches[r+1],to:s}:(this.matches[r]++,i=!0)),i||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?a={from:t,to:s}:this.matches.push(1,t)),a&&this.test&&!this.test(a.from,a.to,this.buffer,this.bufferStart)&&(a=null),a}}typeof Symbol<"u"&&(um.prototype[Symbol.iterator]=function(){return this});const bR={from:-1,to:-1,match:/.*/.exec("")},HM="gm"+(/x/.unicode==null?"":"u");class YM{constructor(e,t,s,a=0,r=e.length){if(this.text=e,this.to=r,this.curLine="",this.done=!1,this.value=bR,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new yR(e,t,s,a,r);this.re=new RegExp(t,HM+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.iter=e.iter();let o=e.lineAt(a);this.curLineStart=o.from,this.matchPos=yy(e,a),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let s=this.curLineStart+t.index,a=s+t[0].length;if(this.matchPos=yy(this.text,a+(s==a?1:0)),s==this.curLineStart+this.curLine.length&&this.nextLine(),(s<a||s>this.value.to)&&(!this.test||this.test(s,a,t)))return this.value={from:s,to:a,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const ax=new WeakMap;class Rd{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,s){let a=ax.get(e);if(!a||a.from>=s||a.to<=t){let i=new Rd(t,e.sliceString(t,s));return ax.set(e,i),i}if(a.from==t&&a.to==s)return a;let{text:r,from:o}=a;return o>t&&(r=e.sliceString(t,o)+r,o=t),a.to<s&&(r+=e.sliceString(a.to,s)),ax.set(e,new Rd(o,r)),new Rd(t,r.slice(t-o,s-o))}}class yR{constructor(e,t,s,a,r){this.text=e,this.to=r,this.done=!1,this.value=bR,this.matchPos=yy(e,a),this.re=new RegExp(t,HM+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.flat=Rd.get(e,a,this.chunkEnd(a+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let s=this.flat.from+t.index,a=s+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(s,a,t)))return this.value={from:s,to:a,match:t},this.matchPos=yy(this.text,a+(s==a?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Rd.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(YM.prototype[Symbol.iterator]=yR.prototype[Symbol.iterator]=function(){return this});function tde(n){try{return new RegExp(n,HM),!0}catch{return!1}}function yy(n,e){if(e>=n.length)return e;let t=n.lineAt(e),s;for(;e<t.to&&(s=t.text.charCodeAt(e-t.from))>=56320&&s<57344;)e++;return e}function O2(n){let e=String(n.state.doc.lineAt(n.state.selection.main.head).number),t=Ss("input",{class:"cm-textfield",name:"line",value:e}),s=Ss("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),n.dispatch({effects:Of.of(!1)}),n.focus()):r.keyCode==13&&(r.preventDefault(),a())},onsubmit:r=>{r.preventDefault(),a()}},Ss("label",n.state.phrase("Go to line"),": ",t)," ",Ss("button",{class:"cm-button",type:"submit"},n.state.phrase("go")),Ss("button",{name:"close",onclick:()=>{n.dispatch({effects:Of.of(!1)}),n.focus()},"aria-label":n.state.phrase("close"),type:"button"},["×"]));function a(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!r)return;let{state:o}=n,i=o.doc.lineAt(o.selection.main.head),[,l,c,u,h]=r,m=u?+u.slice(1):0,f=c?+c:i.number;if(c&&h){let k=f/100;l&&(k=k*(l=="-"?-1:1)+i.number/o.doc.lines),f=Math.round(o.doc.lines*k)}else c&&l&&(f=f*(l=="-"?-1:1)+i.number);let v=o.doc.line(Math.max(1,Math.min(o.doc.lines,f))),O=Ve.cursor(v.from+Math.max(0,Math.min(m,v.length)));n.dispatch({effects:[Of.of(!1),ut.scrollIntoView(O.from,{y:"center"})],selection:O}),n.focus()}return{dom:s}}const Of=cn.define(),h7=zs.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(Of)&&(n=t.value);return n},provide:n=>Cu.from(n,e=>e?O2:null)}),nde=n=>{let e=jf(n,O2);if(!e){let t=[Of.of(!0)];n.state.field(h7,!1)==null&&t.push(cn.appendConfig.of([h7,sde])),n.dispatch({effects:t}),e=jf(n,O2)}return e&&e.dom.querySelector("input").select(),!0},sde=ut.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),ade={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},rde=Lt.define({combine(n){return Kl(n,ade,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function ode(n){return[hde,ude]}const ide=Et.mark({class:"cm-selectionMatch"}),lde=Et.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function d7(n,e,t,s){return(t==0||n(e.sliceDoc(t-1,t))!=Hs.Word)&&(s==e.doc.length||n(e.sliceDoc(s,s+1))!=Hs.Word)}function cde(n,e,t,s){return n(e.sliceDoc(t,t+1))==Hs.Word&&n(e.sliceDoc(s-1,s))==Hs.Word}const ude=Ks.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(rde),{state:t}=n,s=t.selection;if(s.ranges.length>1)return Et.none;let a=s.main,r,o=null;if(a.empty){if(!e.highlightWordAroundCursor)return Et.none;let l=t.wordAt(a.head);if(!l)return Et.none;o=t.charCategorizer(a.head),r=t.sliceDoc(l.from,l.to)}else{let l=a.to-a.from;if(l<e.minSelectionLength||l>200)return Et.none;if(e.wholeWords){if(r=t.sliceDoc(a.from,a.to),o=t.charCategorizer(a.head),!(d7(o,t,a.from,a.to)&&cde(o,t,a.from,a.to)))return Et.none}else if(r=t.sliceDoc(a.from,a.to),!r)return Et.none}let i=[];for(let l of n.visibleRanges){let c=new um(t.doc,r,l.from,l.to);for(;!c.next().done;){let{from:u,to:h}=c.value;if((!o||d7(o,t,u,h))&&(a.empty&&u<=a.from&&h>=a.to?i.push(lde.range(u,h)):(u>=a.to||h<=a.from)&&i.push(ide.range(u,h)),i.length>e.maxMatches))return Et.none}}return Et.set(i)}},{decorations:n=>n.decorations}),hde=ut.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),dde=({state:n,dispatch:e})=>{let{selection:t}=n,s=Ve.create(t.ranges.map(a=>n.wordAt(a.head)||Ve.cursor(a.head)),t.mainIndex);return s.eq(t)?!1:(e(n.update({selection:s})),!0)};function mde(n,e){let{main:t,ranges:s}=n.selection,a=n.wordAt(t.head),r=a&&a.from==t.from&&a.to==t.to;for(let o=!1,i=new um(n.doc,e,s[s.length-1].to);;)if(i.next(),i.done){if(o)return null;i=new um(n.doc,e,0,Math.max(0,s[s.length-1].from-1)),o=!0}else{if(o&&s.some(l=>l.from==i.value.from))continue;if(r){let l=n.wordAt(i.value.from);if(!l||l.from!=i.value.from||l.to!=i.value.to)continue}return i.value}}const pde=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(r=>r.from===r.to))return dde({state:n,dispatch:e});let s=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(r=>n.sliceDoc(r.from,r.to)!=s))return!1;let a=mde(n,s);return a?(e(n.update({selection:n.selection.addRange(Ve.range(a.from,a.to),!1),effects:ut.scrollIntoView(a.to)})),!0):!1},Im=Lt.define({combine(n){return Kl(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new kde(e),scrollToMatch:e=>ut.scrollIntoView(e)})}});class KM{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||tde(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,s)=>s=="n"?`
`:s=="r"?"\r":s=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new yde(this):new gde(this)}getCursor(e,t=0,s){let a=e.doc?e:cs.create({doc:e});return s==null&&(s=a.doc.length),this.regexp?ld(this,a,t,s):id(this,a,t,s)}}class vR{constructor(e){this.spec=e}}function id(n,e,t,s){return new um(e.doc,n.unquoted,t,s,n.caseSensitive?void 0:a=>a.toLowerCase(),n.wholeWord?fde(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function fde(n,e){return(t,s,a,r)=>((r>t||r+a.length<s)&&(r=Math.max(0,t-2),a=n.sliceString(r,Math.min(n.length,s+2))),(e(vy(a,t-r))!=Hs.Word||e(wy(a,t-r))!=Hs.Word)&&(e(wy(a,s-r))!=Hs.Word||e(vy(a,s-r))!=Hs.Word))}class gde extends vR{constructor(e){super(e)}nextMatch(e,t,s){let a=id(this.spec,e,s,e.doc.length).nextOverlapping();if(a.done){let r=Math.min(e.doc.length,t+this.spec.unquoted.length);a=id(this.spec,e,0,r).nextOverlapping()}return a.done||a.value.from==t&&a.value.to==s?null:a.value}prevMatchInRange(e,t,s){for(let a=s;;){let r=Math.max(t,a-1e4-this.spec.unquoted.length),o=id(this.spec,e,r,a),i=null;for(;!o.nextOverlapping().done;)i=o.value;if(i)return i;if(r==t)return null;a-=1e4}}prevMatch(e,t,s){let a=this.prevMatchInRange(e,0,t);return a||(a=this.prevMatchInRange(e,Math.max(0,s-this.spec.unquoted.length),e.doc.length)),a&&(a.from!=t||a.to!=s)?a:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let s=id(this.spec,e,0,e.doc.length),a=[];for(;!s.next().done;){if(a.length>=t)return null;a.push(s.value)}return a}highlight(e,t,s,a){let r=id(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(s+this.spec.unquoted.length,e.doc.length));for(;!r.next().done;)a(r.value.from,r.value.to)}}function ld(n,e,t,s){return new YM(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?bde(e.charCategorizer(e.selection.main.head)):void 0},t,s)}function vy(n,e){return n.slice(Ha(n,e,!1),e)}function wy(n,e){return n.slice(e,Ha(n,e))}function bde(n){return(e,t,s)=>!s[0].length||(n(vy(s.input,s.index))!=Hs.Word||n(wy(s.input,s.index))!=Hs.Word)&&(n(wy(s.input,s.index+s[0].length))!=Hs.Word||n(vy(s.input,s.index+s[0].length))!=Hs.Word)}class yde extends vR{nextMatch(e,t,s){let a=ld(this.spec,e,s,e.doc.length).next();return a.done&&(a=ld(this.spec,e,0,t).next()),a.done?null:a.value}prevMatchInRange(e,t,s){for(let a=1;;a++){let r=Math.max(t,s-a*1e4),o=ld(this.spec,e,r,s),i=null;for(;!o.next().done;)i=o.value;if(i&&(r==t||i.from>r+10))return i;if(r==t)return null}}prevMatch(e,t,s){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,s,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,s)=>{if(s=="&")return e.match[0];if(s=="$")return"$";for(let a=s.length;a>0;a--){let r=+s.slice(0,a);if(r>0&&r<e.match.length)return e.match[r]+s.slice(a)}return t})}matchAll(e,t){let s=ld(this.spec,e,0,e.doc.length),a=[];for(;!s.next().done;){if(a.length>=t)return null;a.push(s.value)}return a}highlight(e,t,s,a){let r=ld(this.spec,e,Math.max(0,t-250),Math.min(s+250,e.doc.length));for(;!r.next().done;)a(r.value.from,r.value.to)}}const Eu=cn.define(),JM=cn.define(),fu=zs.define({create(n){return new rx(x2(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Eu)?n=new rx(t.value.create(),n.panel):t.is(JM)&&(n=new rx(n.query,t.value?eA:null));return n},provide:n=>Cu.from(n,e=>e.panel)});class rx{constructor(e,t){this.query=e,this.panel=t}}const vde=Et.mark({class:"cm-searchMatch"}),wde=Et.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Ode=Ks.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(fu))}update(n){let e=n.state.field(fu);(e!=n.startState.field(fu)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Et.none;let{view:t}=this,s=new Hi;for(let a=0,r=t.visibleRanges,o=r.length;a<o;a++){let{from:i,to:l}=r[a];for(;a<o-1&&l>r[a+1].from-500;)l=r[++a].to;n.highlight(t.state,i,l,(c,u)=>{let h=t.state.selection.ranges.some(m=>m.from==c&&m.to==u);s.add(c,u,h?wde:vde)})}return s.finish()}},{decorations:n=>n.decorations});function Zg(n){return e=>{let t=e.state.field(fu,!1);return t&&t.query.spec.valid?n(e,t):PR(e)}}const m7=Zg((n,{query:e})=>{let{to:t}=n.state.selection.main,s=e.nextMatch(n.state,t,t);if(!s)return!1;let a=Ve.single(s.from,s.to),r=n.state.facet(Im);return n.dispatch({selection:a,effects:[tA(n,s),r.scrollToMatch(a.main,n)],userEvent:"select.search"}),kR(n),!0}),p7=Zg((n,{query:e})=>{let{state:t}=n,{from:s}=t.selection.main,a=e.prevMatch(t,s,s);if(!a)return!1;let r=Ve.single(a.from,a.to),o=n.state.facet(Im);return n.dispatch({selection:r,effects:[tA(n,a),o.scrollToMatch(r.main,n)],userEvent:"select.search"}),kR(n),!0}),wR=Zg((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:Ve.create(t.map(s=>Ve.range(s.from,s.to))),userEvent:"select.search.matches"}),!0)}),xde=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:s,to:a}=t.main,r=[],o=0;for(let i=new um(n.doc,n.sliceDoc(s,a));!i.next().done;){if(r.length>1e3)return!1;i.value.from==s&&(o=r.length),r.push(Ve.range(i.value.from,i.value.to))}return e(n.update({selection:Ve.create(r,o),userEvent:"select.search.matches"})),!0},f7=Zg((n,{query:e})=>{let{state:t}=n,{from:s,to:a}=t.selection.main;if(t.readOnly)return!1;let r=e.nextMatch(t,s,s);if(!r)return!1;let o=r,i=[],l,c,u=[];o.from==s&&o.to==a&&(c=t.toText(e.getReplacement(o)),i.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(t,o.from,o.to),u.push(ut.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(s).number)+".")));let h=n.state.changes(i);return o&&(l=Ve.single(o.from,o.to).map(h),u.push(tA(n,o)),u.push(t.facet(Im).scrollToMatch(l.main,n))),n.dispatch({changes:h,selection:l,effects:u,userEvent:"input.replace"}),!0}),OR=Zg((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(a=>{let{from:r,to:o}=a;return{from:r,to:o,insert:e.getReplacement(a)}});if(!t.length)return!1;let s=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:ut.announce.of(s),userEvent:"input.replace.all"}),!0});function eA(n){return n.state.facet(Im).createPanel(n)}function x2(n,e){var t,s,a,r,o;let i=n.selection.main,l=i.empty||i.to>i.from+100?"":n.sliceDoc(i.from,i.to);if(e&&!l)return e;let c=n.facet(Im);return new KM({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(s=e==null?void 0:e.caseSensitive)!==null&&s!==void 0?s:c.caseSensitive,literal:(a=e==null?void 0:e.literal)!==null&&a!==void 0?a:c.literal,regexp:(r=e==null?void 0:e.regexp)!==null&&r!==void 0?r:c.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function xR(n){let e=jf(n,eA);return e&&e.dom.querySelector("[main-field]")}function kR(n){let e=xR(n);e&&e==n.root.activeElement&&e.select()}const PR=n=>{let e=n.state.field(fu,!1);if(e&&e.panel){let t=xR(n);if(t&&t!=n.root.activeElement){let s=x2(n.state,e.query.spec);s.valid&&n.dispatch({effects:Eu.of(s)}),t.focus(),t.select()}}else n.dispatch({effects:[JM.of(!0),e?Eu.of(x2(n.state,e.query.spec)):cn.appendConfig.of(Sde)]});return!0},SR=n=>{let e=n.state.field(fu,!1);if(!e||!e.panel)return!1;let t=jf(n,eA);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:JM.of(!1)}),!0};class kde{constructor(e){this.view=e;let t=this.query=e.state.field(fu).query.spec;this.commit=this.commit.bind(this),this.searchField=Ss("input",{value:t.search,placeholder:So(e,"Find"),"aria-label":So(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Ss("input",{value:t.replace,placeholder:So(e,"Replace"),"aria-label":So(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Ss("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Ss("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Ss("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function s(a,r,o){return Ss("button",{class:"cm-button",name:a,onclick:r,type:"button"},o)}this.dom=Ss("div",{onkeydown:a=>this.keydown(a),class:"cm-search"},[this.searchField,s("next",()=>m7(e),[So(e,"next")]),s("prev",()=>p7(e),[So(e,"previous")]),s("select",()=>wR(e),[So(e,"all")]),Ss("label",null,[this.caseField,So(e,"match case")]),Ss("label",null,[this.reField,So(e,"regexp")]),Ss("label",null,[this.wordField,So(e,"by word")]),...e.state.readOnly?[]:[Ss("br"),this.replaceField,s("replace",()=>f7(e),[So(e,"replace")]),s("replaceAll",()=>OR(e),[So(e,"replace all")])],Ss("button",{name:"close",onclick:()=>SR(e),"aria-label":So(e,"close"),type:"button"},["×"])])}commit(){let e=new KM({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Eu.of(e)}))}keydown(e){sh(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?p7:m7)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),f7(this.view))}update(e){for(let t of e.transactions)for(let s of t.effects)s.is(Eu)&&!s.value.eq(this.query)&&this.setQuery(s.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Im).top}}function So(n,e){return n.state.phrase(e)}const R0=30,_0=/[\s\.,:;?!]/;function tA(n,{from:e,to:t}){let s=n.state.doc.lineAt(e),a=n.state.doc.lineAt(t).to,r=Math.max(s.from,e-R0),o=Math.min(a,t+R0),i=n.state.sliceDoc(r,o);if(r!=s.from){for(let l=0;l<R0;l++)if(!_0.test(i[l+1])&&_0.test(i[l])){i=i.slice(l);break}}if(o!=a){for(let l=i.length-1;l>i.length-R0;l--)if(!_0.test(i[l-1])&&_0.test(i[l])){i=i.slice(0,l);break}}return ut.announce.of(`${n.state.phrase("current match")}. ${i} ${n.state.phrase("on line")} ${s.number}.`)}const Pde=ut.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Sde=[fu,jo.low(Ode),Pde],nA=(n="test-canvas",e)=>{let{contextType:t="2d",pixelated:s=!1,pixelRatio:a=window.devicePixelRatio}={},r=document.querySelector("#"+n);if(!r){r=document.createElement("canvas"),r.id=n,r.width=window.innerWidth*a,r.height=window.innerHeight*a,r.style="pointer-events:none;width:100%;height:100%;position:fixed;top:0;left:0",s&&(r.style.imageRendering="pixelated"),document.body.prepend(r);let o;window.addEventListener("resize",()=>{o&&clearTimeout(o),o=setTimeout(()=>{r.width=window.innerWidth*a,r.height=window.innerHeight*a},200)})}return r.getContext(t,{willReadFrequently:!0})};let xf={};function Cde(n){xf[n]!==void 0&&(cancelAnimationFrame(xf[n]),delete xf[n])}let dc={};Yl.prototype.draw=function(n,e){if(typeof window>"u")return this;let{id:t=1,lookbehind:s=0,lookahead:a=0}=e,r=Math.max(G5(),0);Cde(t),s=Math.abs(s),dc[t]=(dc[t]||[]).filter(c=>!c.isInFuture(r));let o=this.queryArc(r,r+a).filter(c=>c.hasOnset());dc[t]=dc[t].concat(o);let i;const l=()=>{const c=G5(),u=c+a;dc[t]=dc[t].filter(f=>f.isInNearPast(s,c));let h=Math.max(i||u,u-1/10);const m=this.queryArc(h,u).filter(f=>f.hasOnset());dc[t]=dc[t].concat(m),i=u,n(dc[t],c,u,this),xf[t]=requestAnimationFrame(l)};return xf[t]=requestAnimationFrame(l),this};Yl.prototype.onPaint=function(n){return this.withState(e=>(e.controls.painters||(e.controls.painters=[]),e.controls.painters.push(n),e))};Yl.prototype.getPainters=function(){let n=[];return this.queryArc(0,0,{painters:n}),n};let Mde={background:"#222",foreground:"#75baff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"};function Mh(){return Mde}let g7="#22222210";Yl.prototype.animate=function({callback:n,sync:e=!1,smear:t=.5}={}){window.frame&&cancelAnimationFrame(window.frame);const s=nA();let{clientWidth:a,clientHeight:r}=s.canvas;a*=window.devicePixelRatio,r*=window.devicePixelRatio;let o=t===0?"99":Number((1-t)*100).toFixed(0);o=o.length===1?`0${o}`:o,g7=`#200010${o}`;const i=l=>{let c;l=Math.round(l),c=this.slow(1e3).queryArc(l,l),s.fillStyle=g7,s.fillRect(0,0,a,r),c.forEach(u=>{let{x:h,y:m,w:f,h:v,s:O,r:k,angle:M=0,fill:E="darkseagreen"}=u.value;if(f*=a,v*=r,k!==void 0&&M!==void 0){const D=M*2*Math.PI,[F,_]=[(a-f)/2,(r-v)/2];h=F+Math.cos(D)*k*F,m=_+Math.sin(D)*k*_}else h*=a-f,m*=r-v;const I={...u.value,x:h,y:m,w:f,h:v};s.fillStyle=E,O==="rect"?s.fillRect(h,m,f,v):O==="ellipse"&&(s.beginPath(),s.ellipse(h+f/2,m+v/2,f/2,v/2,0,0,2*Math.PI),s.fill()),n&&n(s,I,u)}),window.frame=requestAnimationFrame(i)};return window.frame=requestAnimationFrame(i),Bf};const{x:CR,y:u6e,w:h6e,h:d6e,angle:m6e,r:p6e,fill:f6e,smear:g6e}=ZJ("x","y","w","h","angle","r","fill","smear");Lc("rescale",function(n,e){return e.mul(CR(n).w(n).y(n).h(n))});Lc("moveXY",function(n,e,t){return t.add(CR(n).y(e))});Lc("zoomIn",function(n,e){const t=xh(1).sub(n).div(2);return e.rescale(n).move(t,t)});const vp=(n,e,t)=>n*(t-e)+e,b7=n=>{let{value:e}=n;typeof n.value!="object"&&(e={value:e});let{note:t,n:s,freq:a,s:r}=e;if(a)return zJ(a);if(t=t??s,typeof t=="string")try{return LC(t)}catch{return 0}return typeof t=="number"?t:r?"_"+r:e};Yl.prototype.pianoroll=function(n={}){let{cycles:e=4,playhead:t=.5,overscan:s=0,hideNegative:a=!1,ctx:r=nA(),id:o=1}=n,i=-e*t,l=e*(1-t);const c=(u,h)=>(!a||u.whole.begin>=0)&&u.isWithinTime(h+i,h+l);return this.draw((u,h)=>{MR({...n,time:h,ctx:r,haps:u.filter(m=>c(m,h))})},{lookbehind:i-s,lookahead:l+s,id:o}),this};function MR({time:n,haps:e,cycles:t=4,playhead:s=.5,flipTime:a=0,flipValues:r=0,hideNegative:o=!1,inactive:i=Mh().foreground,active:l=Mh().foreground,background:c="transparent",smear:u=0,playheadColor:h=Mh().foreground,minMidi:m=10,maxMidi:f=90,autorange:v=0,timeframe:O,fold:k=1,vertical:M=0,labels:E=!1,fill:I=1,fillActive:D=!1,strokeActive:F=!0,stroke:_,hideInactive:$=0,colorizeInactive:Z=1,fontFamily:ce,ctx:U,id:ue}={}){const W=U.canvas.width,de=U.canvas.height;let be=-t*s,ke=t*(1-s);ue&&(e=e.filter(rt=>rt.hasTag(ue))),O&&(console.warn("timeframe is deprecated! use from/to instead"),be=0,ke=O);const Ce=M?de:W,Ae=M?W:de;let q=M?[Ce,0]:[0,Ce];const Ne=ke-be,Re=M?[0,Ae]:[Ae,0];let je=f-m+1,me=Ae/je,Ye=[];a&&q.reverse(),r&&Re.reverse();const{min:ft,max:_e,values:Ge}=e.reduce(({min:rt,max:tn,values:on},xn)=>{const Gt=b7(xn);return{min:Gt<rt?Gt:rt,max:Gt>tn?Gt:tn,values:on.includes(Gt)?on:[...on,Gt]}},{min:1/0,max:-1/0,values:[]});v&&(m=ft,f=_e,je=f-m+1),Ye=Ge.sort((rt,tn)=>typeof rt=="number"&&typeof tn=="number"?rt-tn:typeof rt=="number"?1:String(rt).localeCompare(String(tn))),me=k?Ae/Ye.length:Ae/je,U.fillStyle=c,U.globalAlpha=1,u||(U.clearRect(0,0,W,de),U.fillRect(0,0,W,de)),e.forEach(rt=>{var En;const tn=rt.whole.begin<=n&&rt.endClipped>n;let on=_??(F&&tn),xn=!tn&&I||tn&&D;if($&&!tn)return;let Gt=(En=rt.value)==null?void 0:En.color;l=Gt||l,i=Z&&Gt||i,Gt=tn?l:i,U.fillStyle=xn?Gt:"transparent",U.strokeStyle=Gt;const{velocity:In=1,gain:Ft=1}=rt.value||{};U.globalAlpha=In*Ft;const jt=(rt.whole.begin-(a?ke:be))/Ne,Gn=vp(jt,...q);let un=vp(rt.duration/Ne,0,Ce);const fn=b7(rt),at=k?Ye.indexOf(fn)/Ye.length:(Number(fn)-m)/je,Un=vp(at,...Re);let nt=0;const Mt=vp(n/Ne,...q);let Vt;if(M?Vt=[Un+1-(r?me:0),Ce-Mt+Gn+nt+1-(a?0:un),me-2,un-2]:Vt=[Gn-Mt+nt+1-(a?un:0),Un+1-(r?0:me),un-2,me-2],on&&U.strokeRect(...Vt),xn&&U.fillRect(...Vt),E){const lt=rt.value.note??rt.value.s+(rt.value.n?`:${rt.value.n}`:""),{label:It,activeLabel:Le}=rt.value,qt=(tn&&Le||It)??lt;let tt=M?un:me*.75;U.font=`${tt}px ${ce||"monospace"}`,U.fillStyle=xn?"black":Gt,U.textBaseline="top",U.fillText(qt,...Vt)}}),U.globalAlpha=1;const pt=vp(-be/Ne,...q);return U.strokeStyle=h,U.beginPath(),M?(U.moveTo(0,pt),U.lineTo(Ae,pt)):(U.moveTo(pt,0),U.lineTo(pt,Ae)),U.stroke(),this}function Ade(n,e={}){let[t,s]=n;t=Math.abs(t);const a=s+t,r=a!==0?t/a:0;return{fold:1,...e,cycles:a,playhead:r}}const Ede=(n={})=>(e,t,s,a)=>MR({ctx:e,time:t,haps:s,...Ade(a,n)});Yl.prototype.punchcard=function(n){return this.onPaint(Ede(n))};Yl.prototype.wordfall=function(n){return this.punchcard({vertical:1,labels:1,stroke:0,fillActive:1,active:"white",...n})};function Dde(n,e,t,s){const a=(n-90)*Math.PI/180;return[t+Math.cos(a)*e,s+Math.sin(a)*e]}const y7=(n,e,t,s,a=0)=>Dde((n+a)*360,e*n,t,s);function v7(n){let{ctx:e,from:t=0,to:s=3,margin:a=50,cx:r=100,cy:o=100,rotate:i=0,thickness:l=a/2,color:c=Mh().foreground,cap:u="round",stretch:h=1,fromOpacity:m=1,toOpacity:f=1}=n;t*=h,s*=h,i*=h,e.lineWidth=l,e.lineCap=u,e.strokeStyle=c,e.globalAlpha=m,e.beginPath();let[v,O]=y7(t,a,r,o,i);e.moveTo(v,O);const k=1/60;let M=t;for(;M<=s;){const[E,I]=y7(M,a,r,o,i);e.globalAlpha=(M-t)/(s-t)*f,e.lineTo(E,I),M+=k}e.stroke()}function Tde(n){let{stretch:e=1,size:t=80,thickness:s=t/2,cap:a="butt",inset:r=3,playheadColor:o="#ffffff",playheadLength:i=.02,playheadThickness:l=s,padding:c=0,steady:u=1,activeColor:h=Mh().foreground,inactiveColor:m=Mh().gutterForeground,colorizeInactive:f=0,fade:v=!0,ctx:O,time:k,haps:M,drawTime:E,id:I}=n;I&&(M=M.filter(W=>W.hasTag(I)));const[D,F]=[O.canvas.width,O.canvas.height];O.clearRect(0,0,D*2,F*2);const[_,$]=[D/2,F/2],Z={margin:t/e,cx:_,cy:$,stretch:e,cap:a,thickness:s},ce={...Z,thickness:l,from:r-i,to:r,color:o},[U]=E,ue=u*k;M.forEach(W=>{var Ne;const de=W.whole.begin<=k&&W.endClipped>k,be=W.whole.begin-k+r,ke=W.endClipped-k+r-c,Ce=((Ne=W.value)==null?void 0:Ne.color)||h,Ae=f||de?Ce:m,q=v?1-Math.abs((W.whole.begin-k)/U):1;v7({ctx:O,...Z,from:be,to:ke,rotate:ue,color:Ae,fromOpacity:q,toOpacity:q})}),v7({ctx:O,...ce,rotate:ue})}Yl.prototype.spiral=function(n={}){return this.onPaint((e,t,s,a)=>Tde({ctx:e,time:t,haps:s,drawTime:a,...n}))};const Fde=XJ(36),w7=(n,e,t,s)=>{s=s*Math.PI*2;const a=Math.sin(s)*t+n,r=Math.cos(s)*t+e;return[a,r]},O7=(n,e)=>.5-Math.log2(n/e)%1;function Nde({haps:n,ctx:e,id:t,hapcircles:s=1,circle:a=0,edo:r=12,root:o=Fde,thickness:i=3,hapRadius:l=6,mode:c="flake",margin:u=10}={}){const h=c==="polygon",m=c==="flake",f=e.canvas.width,v=e.canvas.height;e.clearRect(0,0,f,v);const O=Mh().foreground,k=Math.min(f,v)/2-i/2-l-u,M=f/2,E=v/2;t&&(n=n.filter(D=>D.hasTag(t))),e.strokeStyle=O,e.fillStyle=O,e.globalAlpha=1,e.lineWidth=i,a&&(e.beginPath(),e.arc(M,E,k,0,2*Math.PI),e.stroke()),r&&(Array.from({length:r},(D,F)=>{const _=O7(o*Math.pow(2,F/r),o),[$,Z]=w7(M,E,k,_);e.beginPath(),e.arc($,Z,l,0,2*Math.PI),e.fill()}),e.stroke());let I=[];e.lineWidth=l,n.forEach(D=>{let F;try{F=GJ(D)}catch{return}const _=O7(F,o),[$,Z]=w7(M,E,k,_),ce=D.value.color||O;e.strokeStyle=ce,e.fillStyle=ce;const{velocity:U=1,gain:ue=1}=D.value||{},W=U*ue;e.globalAlpha=W,I.push([$,Z,_,ce,W]),e.beginPath(),s&&(e.moveTo($+l,Z),e.arc($,Z,l,0,2*Math.PI),e.fill()),m&&(e.moveTo(M,E),e.lineTo($,Z)),e.stroke()}),e.strokeStyle=O,e.globalAlpha=1,h&&I.length&&(I=I.sort((D,F)=>D[2]-F[2]),e.beginPath(),e.moveTo(I[0][0],I[0][1]),I.forEach(([D,F,_,$,Z])=>{e.strokeStyle=$,e.globalAlpha=Z,e.lineTo(D,F)}),e.lineTo(I[0][0],I[0][1]),e.stroke())}Yl.prototype.pitchwheel=function(n={}){let{ctx:e=nA(),id:t=1}=n;return this.tag(t).onPaint((s,a,r)=>Nde({...n,ctx:e,haps:r.filter(o=>o.isActive(a)),id:t}))};var Bde=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $de(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var a=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:function(){return n[s]}})}),t}var ox={},Ku={},wp={},x7;function AR(){if(x7)return wp;x7=1,wp.__esModule=!0,wp.getBestVoicing=void 0;function n(e){var t=e.chord,s=e.range,a=e.finder,r=e.picker,o=e.lastVoicing,i=a(t,s);return i.length?r(i,o):[]}return wp.getBestVoicing=n,wp}var Op={};const ER=$de(bre);var xp={},k7;function DR(){if(k7)return xp;k7=1,xp.__esModule=!0,xp.tokenizeChord=void 0;function n(e){var t=(e||"").match(/^([A-G][b#]*)([^\/]*)[\/]?([A-G][b#]*)?$/);return t?t.slice(1):[]}return xp.tokenizeChord=n,xp}var P7;function Rde(){if(P7)return Op;P7=1,Op.__esModule=!0,Op.voicingsInRange=void 0;var n=ER,e=TR(),t=DR();function s(a,r,o){r===void 0&&(r=e.lefthand),o===void 0&&(o=["D3","A4"]);var i=(0,t.tokenizeChord)(a),l=i[0],c=i[1];if(!r[c])return[];var u=r[c].map(function(m){return m.split(" ")}),h=n.Range.chromatic(o);return u.reduce(function(m,f){var v=f.map(function(E){return n.Interval.substract(E,f[0])}),O=n.Note.transpose(l,f[0]),k=h.filter(function(E){return n.Note.chroma(E)===n.Note.chroma(O)}).filter(function(E){return n.Note.midi(n.Note.transpose(E,v[v.length-1]))<=n.Note.midi(o[1])}).map(function(E){return n.Note.enharmonic(E,O)}),M=k.map(function(E){return v.map(function(I){return n.Note.transpose(E,I)})});return m.concat(M)},[])}return Op.voicingsInRange=s,Op}var S7;function TR(){return S7||(S7=1,(function(n){var e=Ku&&Ku.__assign||function(){return e=Object.assign||function(i){for(var l,c=1,u=arguments.length;c<u;c++){l=arguments[c];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(i[h]=l[h])}return i},e.apply(this,arguments)},t=Ku&&Ku.__rest||function(i,l){var c={};for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&l.indexOf(u)<0&&(c[u]=i[u]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,u=Object.getOwnPropertySymbols(i);h<u.length;h++)l.indexOf(u[h])<0&&Object.prototype.propertyIsEnumerable.call(i,u[h])&&(c[u[h]]=i[u[h]]);return c};n.__esModule=!0,n.dictionaryVoicing=n.dictionaryVoicingFinder=n.triads=n.guidetones=n.lefthand=void 0;var s=AR(),a=Rde();n.lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},n.guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},n.triads={M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]};var r=function(i){return function(l,c){return(0,a.voicingsInRange)(l,i,c)}};n.dictionaryVoicingFinder=r;var o=function(i){var l=i.dictionary,c=i.range,u=t(i,["dictionary","range"]);return(0,s.getBestVoicing)(e(e({},u),{range:c,finder:(0,n.dictionaryVoicingFinder)(l)}))};n.dictionaryVoicing=o})(Ku)),Ku}var kp={},C7;function _de(){if(C7)return kp;C7=1,kp.__esModule=!0,kp.minTopNoteDiff=void 0;var n=ER;function e(t,s){if(!s)return t[0];var a=function(r){return Math.abs(n.Note.midi(s[s.length-1])-n.Note.midi(r[r.length-1]))};return t.reduce(function(r,o){return a(o)<a(r)?o:r},t[0])}return kp.minTopNoteDiff=e,kp}var M7;function Lde(){return M7||(M7=1,(function(n){n.__esModule=!0;var e=TR(),t=_de(),s=AR(),a=DR();n.default={tokenizeChord:a.tokenizeChord,getBestVoicing:s.getBestVoicing,dictionaryVoicing:e.dictionaryVoicing,dictionaryVoicingFinder:e.dictionaryVoicingFinder,lefthand:e.lefthand,guidetones:e.guidetones,triads:e.triads,minTopNoteDiff:t.minTopNoteDiff}})(ox)),ox}var A7=Lde();const Ide=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Qde=["c","db","d","eb","e","f","gb","g","ab","a","bb","b"],Vde=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],jde={b:-1,"#":1},Zde=n=>{const[e,...t]=n.split("");return Qde.indexOf(e.toLowerCase())+t.reduce((s,a)=>s+jde[a],0)};function zde(n){const e=(n||"").match(/^([A-G][b#]*)([^/]*)[/]?([A-G][b#]*)?$/);return e?e.slice(1):[]}const k2=n=>n%12,FR=n=>{let e=Number(n);return isNaN(e)?Ou.semitones(n):e},P2=(n,e)=>{if(typeof n=="number")return n;if(typeof n=="string")return LC(n,e)},Gde=(n,e=!1)=>{const t=Math.floor(n/12)-1;return(e?Vde:Ide)[n%12]+t};function Xde(n,e,t=1){n=n.map(a=>typeof a=="string"?LC(a):a);const s=Math.floor(e/n.length)*t*12;return e=Bh(e,n.length),n[e]+s}function NR(n,e,t){let s=0,a=1/0;return e.forEach((r,o)=>{const i=Math.abs(r-n);(!t&&i<a||t&&i<=a)&&(s=o,a=i)}),s}let ix={};function Wde(n,e,t,s){const[a,r]=ji.tokenize(e),o=P2(a),i=k2(o);if(!ix[r]){const{intervals:h}=ji.get(`C ${r}`);ix[r]=h.map(FR)}const l=ix[r];if(!l)return null;let c=o;if(t){t=P2(t,3);const h=k2(t),m=Bh(h-i,12),f=NR(m,l,s);n=n+f,c=t-m}const u=Math.floor(n/l.length)*12;return n=Bh(n,l.length),l[n]+c+u}let E7={below:n=>n.slice(-1)[0],duck:n=>n.slice(-1)[0],above:n=>n[0],root:n=>n[0]};function qde({chord:n,dictionary:e,offset:t=0,n:s,mode:a="below",anchor:r="c5",octaves:o=1}){const[i,l]=zde(n),c=Zde(i);r=P2((r==null?void 0:r.note)||r,4);const u=k2(r),h=e[l].map(_=>(typeof _=="string"?_.split(" "):_).map(FR));let m,f,v=h.map((_,$)=>{const Z=E7[a](_),ce=Bh(u-Z-c,12);return(m===void 0||ce<m)&&(m=ce,f=$),ce});a==="root"&&(f=0);const O=Math.ceil(t/h.length)*12,k=Bh(f+t,h.length),M=h[k],E=E7[a](M),I=r-v[k]+O,D=M.map(_=>I-E+_);let F=D.map(_=>Gde(_));return a==="duck"&&(F=F.filter((_,$)=>D[$]!==r)),s!==void 0?[Xde(F,s,o)]:F}const Ude=n=>{var a;if(typeof n!="string")return[];const[e,t="",s]=((a=n.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/))==null?void 0:a.slice(1))||[];return e?[e,t,s?Number(s):void 0]:[]},Hde={c:0,d:2,e:4,f:5,g:7,a:9,b:11},Yde={"#":1,b:-1,s:1,f:-1},D7=(n,e=3)=>{const[t,s,a=e]=Ude(n);if(!t)throw new Error('not a note: "'+n+'"');const r=Hde[t.toLowerCase()],o=(s==null?void 0:s.split("").reduce((i,l)=>i+Yde[l],0))||0;return(Number(a)+1)*12+r+o},Kde=n=>(n<=0?-1:1)+n*7+"P";function sA(n){n=n.replaceAll(":"," ");const e=ji.get(n),{tonic:t,empty:s}=e;if(s&&IC(n)||s&&!t)throw new Error(`Scale name ${n} is incomplete. Make sure to use ":" instead of spaces, example: .scale("C:major")`);if(s)throw new Error(`Invalid scale name "${n}"`);return e}function Jde(n,e){n=Math.ceil(n);let{intervals:t,tonic:s}=sA(e);s=s||"C";const{pc:a,oct:r=3}=hr.get(s),o=Math.floor(n/t.length),i=Bh(n,t.length),l=Ou.add(t[i],Kde(o));return hr.transpose(a+r,l)}function T7(n,e,t){let{notes:s}=sA(n);if(s=s.map(h=>hr.get(h).pc),e=Number(e),isNaN(e))throw new Error(`scale offset "${e}" not a number`);const{pc:a,oct:r=3}=hr.get(t),o=s.indexOf(a);if(o===-1)throw new Error(`note "${t}" is not in scale "${n}"`);let i=o,l=r,c=a;const u=Math.sign(e);for(;Math.abs(i-o)<Math.abs(e);){i+=u;const h=Bh(i,s.length);u<0&&c[0]==="C"&&(l+=u),c=s[h],u>0&&c[0]==="C"&&(l+=u)}return c+l}const{transpose:b6e,trans:y6e}=Lc(["transpose","trans"],function(n,e){return e.withHap(t=>{const s=t.value.note??t.value;if(typeof s=="number"){let o;typeof n=="number"?o=n:typeof n=="string"&&(o=Ou.semitones(n)||0);const i=s+o;return typeof t.value=="object"?t.withValue(()=>({...t.value,note:i})):t.withValue(()=>i)}if(typeof s!="string"||!IC(s))return QC(`[tonal] transpose: not a note "${s}"`,"warning"),t;const a=isNaN(Number(n))?String(n):Ou.fromSemitones(n),r=hr.transpose(s,a);return typeof t.value=="object"?t.withValue(()=>({...t.value,note:r})):t.withValue(()=>r)})}),{scaleTranspose:v6e,scaleTrans:w6e,strans:O6e}=Lc(["scaleTranspose","scaleTrans","strans"],function(n,e){return e.withHap(t=>{if(!t.context.scale)throw new Error("can only use scaleTranspose after .scale");if(typeof t.value=="object")return t.withValue(()=>({...t.value,note:T7(t.context.scale,Number(n),t.value.note)}));if(typeof t.value!="string")throw new Error("can only use scaleTranspose with notes");return t.withValue(()=>T7(t.context.scale,Number(n),t.value))})});function eme(n){let e=Number(n),t=0;if(isNaN(e)){n=String(n);const s=/^(-?\d+)(#+|b+)?$/.exec(n);if(!s)throw new Error(`invalid scale step "${n}", expected number or integer with optional # b suffixes`);e=Number(s[1]);const a=s[2]||"";t=a[0]==="#"?a.length:-a.length}return[e,t]}let lx={};function tme(n,e,t=!0){let s=typeof e=="string"?D7(e):e;if(lx[n]===void 0){const{intervals:h,tonic:m}=sA(n),{pc:f}=hr.get(m),v=h.concat("8P").map(k=>hr.transpose(f+"0",k)),O=v.map(D7);lx[n]=[O,v]}const[a,r]=lx[n],o=a[0],i=Math.floor((s-o)/12),l=a.map(h=>h+12*i),c=NR(s,l,t),u=r[c];return hr.transpose(u,Ou.fromSemitones(12*i))}Lc("scale",function(n,e){return Array.isArray(n)&&(n=n.flat().join(" ")),e.fmap(t=>{const s=typeof t=="object";if(!s||s&&("n"in t||"value"in t)){const a=s?t.n??t.value:t;if(delete t.n,IC(a))return xh(a);try{const[r,o]=eme(a);let i;s&&t.anchor?i=Wde(r,n,t.anchor):i=Jde(r,n),o!=0&&(i=hr.transpose(i,Ou.fromSemitones(o))),t=xh(s?{...t,note:i}:i)}catch(r){return QC(`[tonal] ${r.message}`,"error"),Bf}return t}else{const a=tme(n,t.note);return xh(s?{...t,note:a}:a)}}).outerJoin().withHap(t=>t.setContext({...t.context,scale:n}))},!0,!0);const wd={2:["1P 5P 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P"],5:["1P 5P 8P 12P","5P 8P 12P 15P"],6:["1P 5P 6M 8P 10M","1P 5P 8P 10M 13M","3M 5P 8P 10M 13M","5P 8P 10M 12P 13M"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M"],9:["1P 5P 7m 9M 10M","1P 7m 9M 10M 12P","3M 7m 8P 9M 12P","7m 9M 10M 14m 15P","3M 7m 8P 12P 16M","7m 10M 12P 15P 16M"],11:["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],13:["1P 6M 7m 9M 10M","1P 7m 9M 10M 13M","3M 7m 8P 9M 13M","7m 8P 9M 10M 13M","7m 9M 10M 13M 15P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 8P 9M 13M","5P 8P 9M 10M 13M"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 12P 17M"],"+":["1P 3M 6m 8P 10M","1P 6m 8P 10M 13m","3M 6m 8P 10M 13m","3M 8P 10M 13m 15P","6m 8P 10M 13m 15P","6m 10M 13m 15P 17M"],o:["1P 5d 8P 10m 12d","3m 8P 10m 12d 15P","5d 8P 10m 12d 15P"],h:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P","1P 4P 5P 8P 11P","5P 8P 11P 12P","5P 8P 11P 12P 15P"],"^":["1P 5P 8P 10M","1P 5P 8P 10M 12P","3M 5P 8P 10M 12P","3M 8P 10M 12P 15P","5P 8P 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 5P 8P 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 5P 7M 10M 12P","1P 10M 12P 14M","3M 8P 10M 12P 14M","5P 8P 10M 12P 14M","5P 8P 10M 14M 17M"],"-7":["1P 3m 5P 7m 10m","1P 5P 7m 10m 12P","3m 7m 8P 10m 12P","3m 7m 8P 10m 14m","5P 7m 8P 10m 14m","7m 10m 12P 14m 15P","5P 8P 10m 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 5P 7m 8P 11P","5P 8P 11P 12P 14m","7m 8P 11P 12P 14m","7m 11P 12P 14m 18P"],h7:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 5P 7M 9M 10M","1P 7M 9M 10M 12P","3M 7M 8P 9M 12P","3M 7M 8P 12P 16M","5P 8P 10M 14M 16M","7M 8P 10M 12P 16M"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 8P 13M 16M","7M 8P 10M 13M 16M"],"^7#11":["1P 5P 7M 10M 12d","3M 7M 8P 10M 12d","1P 7M 10M 12d 14M","3M 7M 8P 12d 14M","5P 8P 10M 12d 14M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 8P 9M 12d","3M 8P 9M 12d 14M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 8P 10M 13m","6m 7M 8P 10M 13m"],"-6":["1P 3m 5P 6M 8P","1P 5P 6M 8P 10m","3m 5P 6M 8P 10m","1P 5P 8P 10m 13M","3m 5P 8P 10m 13M","5P 8P 10m 12P 13M","5P 8P 10m 13M 15P"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 10m","1P 5P 7M 10m 12P","3m 7M 8P 10m 12P","5P 7M 8P 10m 14M","5P 8P 10m 14M 17m"],"-^9":["1P 3m 5P 7M 9M","1P 7M 9M 10m 12P","3m 7M 8P 9M 12P","5P 8P 9M 10m 14M"],"-9":["1P 3m 5P 7m 9M","3m 5P 7m 8P 9M","3m 7m 8P 9M 12P","5P 8P 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 12P 15P 16M"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["1P 3m 7m 9M 11P","3m 7m 8P 9M 11P","1P 4P 7m 10m 12P","5P 8P 11P 14m","3m 7m 9M 11P 15P","5P 8P 11P 14m 16M","7m 10m 12P 15P 18P"],"-7b5":["3m 5d 7m 8P 10m","1P 7m 10m 12d","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["1P 7m 9M 10m 12d","3m 7m 8P 9M 12d","5d 8P 9M 10m 14m","7m 10m 12d 15P 16M"],"-b6":["1P 5P 6m 8P 10m","1P 5P 8P 10m 13m","3m 5P 8P 10m 13m","5P 8P 10m 13m","5P 8P 10m 13m 15P"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 10m 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 8P 10m 14m","7m 10m 10M 14m 15P"],"7#11":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7b5":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"7#9#5":["1P 3M 7m 10m 13m","3M 7m 10m 13m 15P","7m 10M 13m 15P 17m"],"7#9b5":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7#9#11":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7b9#11":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9b5":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 8P 9m 10m","7m 8P 10M 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7alt":["3M 7m 8P 9m 12d","1P 7m 10m 10M 13m","3M 7m 8P 10m 13m","3M 7m 9m 12d 15P","3M 7m 10m 13m 15P","7m 10M 12d 15P 17m","7m 10M 13m 15P 17m"],"13#11":["1P 6M 7m 10M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["1P 3M 6M 7m 9m","1P 6M 7m 9m 10M","3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["1P 3M 6M 7m 10m","3M 7m 8P 10m 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","5P 7m 9M 11P 13M","7m 9M 11P 13M 15P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},_d={2:["1P 5P 6M 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P 13M","5P 8P 9M 12P 15P"],5:["1P 5P 8P 12P","1P 5P 8P 9M 12P","5P 8P 12P 15P","5P 8P 12P 15P 16M"],6:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M","7m 10M 14m 17M 19P"],9:["1P 6M 7m 9M 10M","3M 7m 9M 10M 12P","1P 7m 9M 10M 13M","3M 7m 9M 10M 13M","3M 7m 9M 12P 15P","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],11:["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],13:["3M 7m 9M 10M 13M","3M 7m 9M 13M 15P","3M 7m 10M 13M 16M","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 10M 15P","5P 8P 9M 12P 17M"],"+":["1P 6m 8P 9M 10M","1P 6m 8P 10M 13m","3M 8P 9M 10M 13m","3M 8P 10M 13m 15P","6m 10M 13m 15P 16M","6m 10M 13m 15P 17M"],o:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],h:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P 9M","1P 4P 5P 8P 11P","1P 5P 8P 9M 11P","5P 8P 9M 11P 12P","5P 8P 11P 12P 13M","5P 8P 11P 13M 15P"],"^":["1P 3M 5P 6M 9M","1P 5P 8P 10M 12P","3M 5P 9M 10M 12P","1P 5P 8P 10M 13M","3M 8P 10M 13M 15P","5P 9M 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 3m 5P 9M 11P","3m 5P 8P 9M 11P","5P 8P 9M 10m 11P","1P 5P 9M 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 6M 7M 9M 10M","3M 7M 9M 10M 12P","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"-7":["1P 3m 5P 7m 9M","1P 3m 5P 7m 10m","1P 5P 7m 10m 11P","3m 7m 8P 10m 11P","1P 5P 7m 10m 12P","3m 7m 9M 10m 12P","3m 7m 8P 10m 14m","5P 7m 9M 10m 14m","7m 10m 11P 14m 15P","7m 10m 12P 15P 16M","5P 8P 11P 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],h7:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^7#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 10M 12d 14M","7M 10M 12d 13M 14M","7M 10M 12d 13M 16M","7M 10M 12d 14M 17M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 9M 12d 14M","7M 10M 12d 14M 16M","7M 10M 12d 13M 16M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 9M 10M 13m","3M 7M 10M 13m 14M","7M 10M 13m 14M 16M","7M 10M 13m 14M 17M"],"-6":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","1P 5P 6M 10m 11P","3m 5P 6M 8P 11P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 10m 11P 13M","5P 8P 10m 13M 16M"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-^9":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-9":["1P 3m 5P 7m 9M","1P 3m 7m 9M 11P","3m 7m 9M 10m 11P","3m 7m 9M 10m 12P","3m 7m 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 11P 14m 16M","7m 10m 12P 16M 18P"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["3m 5P 7m 9M 11P","7m 9M 10m 11P","1P 4P 7m 10m 12P","3m 7m 9M 11P 12P","7m 9M 10m 11P 12P","3m 7m 9M 11P 14m","4P 10m 12P 14m","5P 8P 11P 14m","5P 8P 11P 14m 16M","7m 10m 12P 16M 18P","7m 10m 11P 16M 21m"],"-7b5":["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["3m 5d 7m 9M 11P","1P 7m 9M 10m 12d","3m 7m 9M 12d 14m","5d 8P 9M 10m 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 16M"],"-b6":["1P 3m 5P 6m 8P","3m 5P 8P 11P 13m","5P 8P 10m 11P 13m"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 11P 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 10m 10M 12P","3M 7m 10m 12P 14m","7m 10M 12P 14m 17m"],"7#11":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7b5":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"7#9#5":["3M 7m 10m 10M 13m","3M 7m 10m 13m 14m","7m 10M 13m 14m 17m"],"7#9b5":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7#9#11":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7b9#11":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9b5":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 10m 13m 16m","7m 10M 13m 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7alt":["3M 7m 8P 10m 13m","3M 7m 9m 12d 13m","3M 7m 9m 10m 13m","3M 7m 10m 13m 14m","3M 7m 9m 12d 14m","3M 7m 10m 13m 15P","3M 7m 10m 13m 16m","7m 10M 12d 14m 16m","7m 10M 12d 13m 16m","7m 10M 13m 15P 17m","7m 10M 13m 16m 17m","7m 10M 13m 16m 19d"],"13#11":["3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["3M 7m 10m 10M 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","4P 7m 9M 11P 13M","7m 9M 11P 13M 15P","7m 11P 13M 14m 16M","7m 11P 13M 16M 18P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},{dictionaryVoicing:nme,minTopNoteDiff:sme}=A7.default||A7,ame={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},rme={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},ome={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]},ime={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"],m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},aA={lefthand:{dictionary:ame,range:["F3","A4"],mode:"below",anchor:"a4"},triads:{dictionary:ome,mode:"below",anchor:"a4"},guidetones:{dictionary:rme,mode:"above",anchor:"a4"},legacy:{dictionary:ime,mode:"below",anchor:"a4"}};let lme="ireal";const BR=(n,e,t={})=>{Object.assign(aA,{[n]:{dictionary:e,...t}})},cme=(n,e,t)=>{const{dictionary:s,range:a}=aA[e];return nme({chord:n,dictionary:s,range:a,picker:sme,lastVoicing:t})};let cx;Lc("voicings",function(n,e){return e.fmap(t=>(cx=cme(t,n,cx),mf(...cx))).outerJoin()});Lc("rootNotes",function(n,e){return e.fmap(t=>{const s=(t.chord||t).match(/^([a-gA-G][b#]?).*$/)[1]+n;return t.chord?{note:s}:s})});Lc("voicing",function(n){return n.fmap(e=>{e=typeof e=="string"?{chord:e}:e;let{dictionary:t=lme,chord:s,anchor:a,offset:r,mode:o,n:i,octaves:l,...c}=e;t=typeof t=="string"?aA[t]:{dictionary:t,mode:"below",anchor:"c5"};try{let u=qde({...t,chord:s,anchor:a,offset:r,mode:o,n:i,octaves:l});return mf(...u).note().set(c)}catch{return QC(`[voicing]: unknown chord "${s}"`),Bf}}).outerJoin()});function Jb(n,e,t){t=Array.isArray(t)?t:[t],t.forEach(s=>{s[e]=s[n]})}Jb("^","",[wd,_d]);Object.keys(wd).forEach(n=>{if(n.includes("-")){let e=n.replace("-","m");Jb(n,e,[_d,wd])}if(n.includes("^")){let e=n.replace("^","M");Jb(n,e,[_d,wd])}if(n.includes("+")){let e=n.replace("+","aug");Jb(n,e,[_d,wd])}});BR("ireal",wd);BR("ireal-ext",_d);let S2=v6||(function(){let n={cursorBlinkRate:1200};return function(){return n}})(),ume=class{constructor(e,t,s,a,r,o,i,l,c,u){this.left=e,this.top=t,this.height=s,this.fontFamily=a,this.fontSize=r,this.fontWeight=o,this.color=i,this.className=l,this.letter=c,this.partial=u}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.height=this.height+"px",e.style.lineHeight=this.height+"px",e.style.fontFamily=this.fontFamily,e.style.fontSize=this.fontSize,e.style.fontWeight=this.fontWeight,e.style.color=this.partial?"transparent":this.color,e.className=this.className,e.textContent=this.letter}eq(e){return this.left==e.left&&this.top==e.top&&this.height==e.height&&this.fontFamily==e.fontFamily&&this.fontSize==e.fontSize&&this.fontWeight==e.fontWeight&&this.color==e.color&&this.className==e.className&&this.letter==e.letter}},hme=class{constructor(e,t){this.view=e,this.rangePieces=[],this.cursors=[],this.em=t,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let t=S2(this.view.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=t+"ms"}update(e){(e.selectionSet||e.geometryChanged||e.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),dme(e)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:e}=this.view,t=[];for(let s of e.selection.ranges){let a=s==e.selection.main,r=gme(this.em,this.view,s,a);r&&t.push(r)}return{cursors:t}}drawSel({cursors:e}){if(e.length!=this.cursors.length||e.some((t,s)=>!t.eq(this.cursors[s]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const s of e)this.cursorLayer.appendChild(s.draw())}else e.forEach((s,a)=>s.adjust(t[a]));this.cursors=e}}destroy(){this.cursorLayer.remove()}};function dme(n){return S2(n.startState)!=S2(n.state)}const mme={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}},pme=jo.highest(ut.theme(mme));function fme(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Es.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function gme(n,e,t,s){var a,r;let o=t.head,i=1;(n.$data.count||n.$data.keyChain)&&(i=.5);{let c=o<e.state.doc.length&&e.state.sliceDoc(o,o+1);c&&/[\uDC00-\uDFFF]/.test(c)&&o>1&&(o--,c=e.state.sliceDoc(o,o+1));let u=e.coordsAtPos(o,1);if(!u)return null;let h=fme(e),m=e.domAtPos(o),f=m?m.node:e.contentDOM;for(;m&&m.node instanceof HTMLElement;)f=m.node,m={node:m.node.childNodes[m.offset],offset:0};if(!(f instanceof HTMLElement)){if(!f.parentNode)return null;f=f.parentNode}let v=getComputedStyle(f),O=u.left,k=(r=(a=e).coordsForChar)===null||r===void 0?void 0:r.call(a,o);if(k&&(O=k.left),!c||c==`
`||c=="\r")c=" ";else if(c=="	"){c=" ";var l=e.coordsAtPos(o+1,-1);l&&(O=l.left-(l.left-u.left)/parseInt(v.tabSize))}else/[\uD800-\uDBFF]/.test(c)&&o<e.state.doc.length-1&&(c+=e.state.sliceDoc(o+1,o+2));let M=u.bottom-u.top;return new ume(O-h.left,u.top-h.top+M*(1-i),M*i,v.fontFamily,v.fontSize,v.fontWeight,v.color,s?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",c,i!=1)}}const bme=ut.theme({".cm-emacsMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"5px 10px",backgroundColor:"#fffa8f",fontFamily:"monospace"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"#fffa8f"}}),yme=Ks.fromClass(class{constructor(n){this.status="",this.view=n,this.em=new gh(n),this.blockCursor=new hme(n,this.em),this.view.scrollDOM.classList.add("cm-emacsMode")}update(n){n.docChanged&&(this.em.$emacsMark=null,this.em.updateMarksOnChange(n.changes)),this.blockCursor.update(n)}destroy(){this.view.scrollDOM.classList.remove("cm-emacsMode"),this.blockCursor.destroy()}},{eventHandlers:{keydown:function(n,e){var t=this.em.handleKeyboard(n);return t&&this.blockCursor.scheduleRedraw(),!!t},mousedown:function(){this.em.$emacsMark=null}}}),vme=cn.define(),wme=zs.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(vme)&&(n=t.value);return n},provide:n=>Cu.from(n,e=>e?Ome:null)});function Ome(n){let e=document.createElement("div");return e.className="cm-vim-panel",{top:!1,dom:e}}function xme(n={}){return[bme,yme,pme,wme]}var kme={Return:"Return",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Return",Divide:"/",Slash:"/",Multiply:"*",Subtract:"-",Minus:"-",Equal:"="},Pme={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1};const ux={};class gh{constructor(e){this.view=e,this.$data={count:0,keyChain:"",lastCommand:""},this.$emacsMarkRing=[],this.$emacsMark=null}static bindKey(e,t){e.split("|").forEach(function(s){let a="",r=s.split(/\s+/);r.forEach(function(o,i){let l=o.split(/-(?=.)/),c=l.pop();l.length&&(a+=l.sort().join("-")+"-"),a+=c,i===r.length-1?ux[a]=t:(ux[a]="null",a+=" ")})})}static getKey(e){var t=e.code,s=e.key;if(Pme[s])return["","",""];t.length>1&&(t[0]=="N"&&(t=t.replace(/^Numpad/,"")),t[0]=="K"&&(t=t.replace(/^Key/,""))),t=kme[t]||t,t.length==1&&(t=t.toLowerCase());var a="";return e.ctrlKey&&(a+="C-"),e.metaKey&&(a+="CMD-"),e.altKey&&(a+="M-"),e.shiftKey&&(a+="S-"),[t,a,s]}static addCommands(e){Object.keys(e).forEach(function(t){var s=e[t];typeof s=="function"&&(s={exec:s}),gh.commands[t]=s})}static execCommand(e,t,s,a=1){var r=void 0;if(a<0&&(a=-a),typeof e=="function")for(var o=0;o<a;o++)e(t.view);else if(e!=="null")if(e.exec){a>1&&e.handlesCount&&(s||(s={}),typeof s=="object"&&(s.count=a),a=1);for(var o=0;o<a;o++)r=e.exec(t,s||{})}else throw new Error("missformed command");return r}handleKeyboard(e){var t=gh.getKey(e),s=this.findCommand(t);if(!(/Up|Down/.test(t==null?void 0:t[0])&&Xue(this.view.state))){if(s&&s.command){var a=gh.execCommand(s.command,this,s.args,s.count);if(a===!1)return}return s}}findCommand([e,t,s]){if(e){var a=this,r=this.$data;if(!t&&e.length==1&&(a.pushEmacsMark(),r.count)){var o=new Array(r.count+1).join(s);return r.count=null,{command:"insertstring",args:o}}if(t=="C-"||r.count){var c=parseInt(e[e.length-1]);if(typeof c=="number"&&!isNaN(c))return r.count=Math.max(r.count||0,0),r.count=10*r.count+c,{command:"null"}}t&&(e=t+e),r.keyChain&&(e=r.keyChain+=" "+e);var i=ux[e];if(r.keyChain=i=="null"?e:"",!!i){if(i==="null")return{command:"null"};if(i==="universalArgument")return r.count=-4,{command:"null"};var l;if(typeof i!="string"&&(l=i.args,i.command&&(i=i.command)),(i==="insertstring"||i===qM||i===jM)&&a.pushEmacsMark(),!(typeof i=="string"&&(i=gh.commands[i],!i))){!i.readOnly&&!i.keepLastCommand&&(r.lastCommand=null);var c=r.count||1;return r.count&&(r.count=0),{command:i,args:l,count:c}}}}}showCommandLine(e){console.error("TODO")}updateMarksOnChange(e){this.$emacsMark&&(this.$emacsMark=this.updateMark(this.$emacsMark,e)),this.$emacsMarkRing=this.$emacsMarkRing.map(t=>this.updateMark(t,e)).filter(Boolean)}updateMark(e,t){if(e){var s=e.map(function(a){return t.mapPos(a,1,fa.TrackDel)}).filter(a=>a!=null);return s.length==0?null:s}}emacsMark(){return this.$emacsMark}setEmacsMark(e){this.$emacsMark=e}pushEmacsMark(e,t){var s=this.$emacsMark;s&&F7(this.$emacsMarkRing,s),!e||t?this.setEmacsMark(e):F7(this.$emacsMarkRing,e)}popEmacsMark(){var e=this.emacsMark();return e?(this.setEmacsMark(null),e):this.$emacsMarkRing.pop()}getLastEmacsMark(){return this.$emacsMark||this.$emacsMarkRing.slice(-1)[0]}getCopyText(){var e=this.view.state;return e.selection.ranges.map(t=>e.sliceDoc(t.from,t.to)).join(`
`)}clearSelection(){var e=this.view,t=e.state.selection,s=!t.ranges.some(r=>r.from!=r.to);if(s)return!1;var a=t.ranges.map(r=>Ve.range(r.head,r.head));return e.dispatch({selection:Ve.create(a,t.mainIndex)}),!0}onPaste(e){var t=this.view,s=t.state.selection,a;if(s.ranges.length>1){var r=e.split(`
`);r.length==s.ranges.length&&(a=r)}var o=0,i=t.state.changeByRange(l=>{var c=a?a[o]:e;return o++,{changes:{from:l.from,to:l.to,insert:c},range:Ve.cursor(l.from+c.length)}});t.dispatch(i)}selectionToEmacsMark(){var e=this.view.state.selection;return e.ranges.map(t=>t.head)}}gh.commands={};function F7(n,e){n.length&&n[n.length-1]+""==e+""||n.push(e)}function Sme(n){var e=n.Pos;function t(d,p,g){if(p.line===g.line&&p.ch>=g.ch-1){var b=d.getLine(p.line),S=b.charCodeAt(p.ch);55296<=S&&S<=55551&&(g.ch+=1)}return{start:p,end:g}}var s=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"g<Up>",type:"keyToKey",toKeys:"gk"},{keys:"g<Down>",type:"keyToKey",toKeys:"gj"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h"},{keys:"<Del>",type:"keyToKey",toKeys:"x"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"keyToKey",toKeys:"i",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"g$",type:"motion",motion:"moveToEndOfDisplayLine"},{keys:"g^",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"g0",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"gn",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!0}},{keys:"gN",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!1}},{keys:"gq",type:"operator",operator:"hardWrap"},{keys:"gw",type:"operator",operator:"hardWrap",operatorArgs:{keepCursor:!0}},{keys:"g?",type:"operator",operator:"rot13"},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-u>",type:"operatorMotion",operator:"delete",motion:"moveToStartOfLine",context:"insert"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"gi",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"lastEdit"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"gI",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"bol"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"gJ",type:"action",action:"joinLines",actionArgs:{keepSpaces:!0},isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<register>",type:"action",action:"replayMacro"},{keys:"q<register>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0},context:"normal"},{keys:"R",type:"operator",operator:"change",operatorArgs:{linewise:!0,fullLine:!0},context:"visual",exitVisualBlock:!0},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<register>",type:"action",action:"setMark"},{keys:'"<register>',type:"action",action:"setRegister"},{keys:"<C-r><register>",type:"action",action:"insertRegister",context:"insert",isEdit:!0},{keys:"<C-o>",type:"action",action:"oneNormalCommand",context:"insert"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<register>",type:"motion",motion:"textObjectManipulation"},{keys:"i<register>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],a=Object.create(null),r=s.length,o=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"omap",shortName:"om"},{name:"noremap",shortName:"no"},{name:"nnoremap",shortName:"nn"},{name:"vnoremap",shortName:"vn"},{name:"inoremap",shortName:"ino"},{name:"onoremap",shortName:"ono"},{name:"unmap"},{name:"mapclear",shortName:"mapc"},{name:"nmapclear",shortName:"nmapc"},{name:"vmapclear",shortName:"vmapc"},{name:"imapclear",shortName:"imapc"},{name:"omapclear",shortName:"omapc"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"startinsert",shortName:"start"},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"marks",excludeFromCommandHistory:!0},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"vglobal",shortName:"v"},{name:"delete",shortName:"d"},{name:"join",shortName:"j"},{name:"normal",shortName:"norm"},{name:"global",shortName:"g"}],i=In("");function l(d){d.setOption("disableInput",!0),d.setOption("showCursorWhenSelecting",!1),n.signal(d,"vim-mode-change",{mode:"normal"}),d.on("cursorActivity",dn),Ae(d),n.on(d.getInputField(),"paste",u(d))}function c(d){d.setOption("disableInput",!1),d.off("cursorActivity",dn),n.off(d.getInputField(),"paste",u(d)),d.state.vim=null,Ra&&clearTimeout(Ra)}function u(d){var p=d.state.vim;return p.onPasteFn||(p.onPasteFn=function(){p.insertMode||(d.setCursor(mt(d.getCursor(),0,1)),Le.enterInsertMode(d,{},p))}),p.onPasteFn}var h=/[\d]/,m=[n.isWordChar,function(d){return d&&!n.isWordChar(d)&&!/\s/.test(d)}],f=[function(d){return/\S/.test(d)}],v=["<",">"],O=["-",'"',".",":","_","/","+"],k=/^\w$/,M=/^[A-Z]$/;try{M=new RegExp("^[\\p{Lu}]$","u")}catch{}function E(d,p){return p>=d.firstLine()&&p<=d.lastLine()}function I(d){return/^[a-z]$/.test(d)}function D(d){return"()[]{}".indexOf(d)!=-1}function F(d){return h.test(d)}function _(d){return M.test(d)}function $(d){return/^\s*$/.test(d)}function Z(d){return".?!".indexOf(d)!=-1}function ce(d,p){for(var g=0;g<p.length;g++)if(p[g]==d)return!0;return!1}var U={};function ue(d,p,g,b,S){if(p===void 0&&!S)throw Error("defaultValue is required unless callback is provided");if(g||(g="string"),U[d]={type:g,defaultValue:p,callback:S},b)for(var C=0;C<b.length;C++)U[b[C]]=U[d];p&&W(d,p)}function W(d,p,g,b){var S=U[d];b=b||{};var C=b.scope;if(!S)return new Error("Unknown option: "+d);if(S.type=="boolean"){if(p&&p!==!0)return new Error("Invalid argument: "+d+"="+p);p!==!1&&(p=!0)}S.callback?(C!=="local"&&S.callback(p,void 0),C!=="global"&&g&&S.callback(p,g)):(C!=="local"&&(S.value=S.type=="boolean"?!!p:p),C!=="global"&&g&&(g.state.vim.options[d]={value:p}))}function de(d,p,g){var b=U[d];g=g||{};var S=g.scope;if(!b)return new Error("Unknown option: "+d);if(b.callback){let C=p&&b.callback(void 0,p);return S!=="global"&&C!==void 0?C:S!=="local"?b.callback():void 0}else return(S!=="global"&&p&&p.state.vim.options[d]||S!=="local"&&b||{}).value}ue("filetype",void 0,"string",["ft"],function(d,p){if(p!==void 0)if(d===void 0){let g=p.getOption("mode");return g=="null"?"":g}else{let g=d==""?"null":d;p.setOption("mode",g)}}),ue("textwidth",80,"number",["tw"],function(d,p){if(p!==void 0)if(d===void 0){var g=p.getOption("textwidth");return g}else{var b=Math.round(d);b>1&&p.setOption("textwidth",b)}});var be=function(){var d=100,p=-1,g=0,b=0,S=new Array(d);function C(V,z,G){var ie=p%d,le=S[ie];function se(ve){var xe=++p%d,$e=S[xe];$e&&$e.clear(),S[xe]=V.setBookmark(ve)}if(le){var K=le.find();K&&!Sn(K,z)&&se(z)}else se(z);se(G),g=p,b=p-d+1,b<0&&(b=0)}function N(V,z){p+=z,p>g?p=g:p<b&&(p=b);var G=S[(d+p)%d];if(G&&!G.find()){var ie=z>0?1:-1,le,se=V.getCursor();do if(p+=ie,G=S[(d+p)%d],G&&(le=G.find())&&!Sn(se,le))break;while(p<g&&p>b)}return G}function L(V,z){var G=p,ie=N(V,z);return p=G,ie&&ie.find()}return{cachedCursor:void 0,add:C,find:L,move:N}},ke=function(d){return d?{changes:d.changes,expectCursorActivityForChange:d.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};class Ce{constructor(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=ke()}exitMacroRecordMode(){var p=q.macroModeState;p.onRecordingDone&&p.onRecordingDone(),p.onRecordingDone=void 0,p.isRecording=!1}enterMacroRecordMode(p,g){var b=q.registerController.getRegister(g);if(b){if(b.clear(),this.latestRegister=g,p.openDialog){var S=ys("span",{class:"cm-vim-message"},"recording @"+g);this.onRecordingDone=p.openDialog(S,function(){},{bottom:!0})}this.isRecording=!0}}}function Ae(d){return d.state.vim||(d.state.vim={inputState:new Ft,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeReturn:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:void 0,sel:{anchor:new e(0,0),head:new e(0,0)},options:{},expectLiteralNext:!1,status:""}),d.state.vim}var q;function Ne(){q={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:be(),macroModeState:new Ce,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new at({}),searchHistoryController:new Un,exCommandHistoryController:new Un};for(var d in U){var p=U[d];p.value=p.defaultValue}}class Re{constructor(p,g){this.keyName=p,this.key=g.key,this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.metaKey=g.metaKey,this.shiftKey=g.shiftKey}}var je,me={enterVimMode:l,leaveVimMode:c,buildKeyMap:function(){},getRegisterController:function(){return q.registerController},resetVimGlobalState_:Ne,getVimGlobalState_:function(){return q},maybeInitVimState_:Ae,suppressErrorLogging:!1,InsertModeKey:Re,map:function(d,p,g){Qe.map(d,p,g)},unmap:function(d,p){return Qe.unmap(d,p)},noremap:function(d,p,g){Qe.map(d,p,g,!0)},mapclear:function(d){var p=s.length,g=r,b=s.slice(0,p-g);if(s=s.slice(p-g),d)for(var S=b.length-1;S>=0;S--){var C=b[S];if(d!==C.context)if(C.context)this._mapCommand(C);else{var N=["normal","insert","visual"];for(var L in N)if(N[L]!==d){var V=Object.assign({},C);V.context=N[L],this._mapCommand(V)}}}},langmap:Gt,vimKeyFromEvent:xn,setOption:W,getOption:de,defineOption:ue,defineEx:function(d,p,g){if(!p)p=d;else if(d.indexOf(p)!==0)throw new Error('(Vim.defineEx) "'+p+'" is not a prefix of "'+d+'", command not registered');Te[d]=g,Qe.commandMap_[p]={name:d,shortName:p,type:"api"}},handleKey:function(d,p,g){var b=this.findKey(d,p,g);if(typeof b=="function")return b()},multiSelectHandleKey:zt,findKey:function(d,p,g){var b=Ae(d),S=d;function C(){var G=q.macroModeState;if(G.isRecording){if(p=="q")return G.exitMacroRecordMode(),jt(S),!0;g!="mapping"&&Me(G,p)}}function N(){if(p=="<Esc>"){if(b.visualMode)Be(S);else if(b.insertMode)De(S);else return;return jt(S),!0}}function L(){if(N())return!0;b.inputState.keyBuffer.push(p);var G=b.inputState.keyBuffer.join(""),ie=p.length==1,le=nt.matchCommand(G,s,b.inputState,"insert"),se=b.inputState.changeQueue;if(le.type=="none")return jt(S),!1;if(le.type=="partial"){if(le.expectLiteralNext&&(b.expectLiteralNext=!0),je&&window.clearTimeout(je),je=ie&&window.setTimeout(function(){b.insertMode&&b.inputState.keyBuffer.length&&jt(S)},de("insertModeEscKeysTimeout")),ie){var K=S.listSelections();(!se||se.removed.length!=K.length)&&(se=b.inputState.changeQueue=new Gn),se.inserted+=p;for(var ve=0;ve<K.length;ve++){var xe=Tt(K[ve].anchor,K[ve].head),$e=kn(K[ve].anchor,K[ve].head),Pe=S.getRange(xe,S.state.overwrite?mt($e,0,1):$e);se.removed[ve]=(se.removed[ve]||"")+Pe}}return!ie}else le.type=="full"&&(b.inputState.keyBuffer.length=0);if(b.expectLiteralNext=!1,je&&window.clearTimeout(je),le.command&&se){for(var K=S.listSelections(),ve=0;ve<K.length;ve++){var ze=K[ve].head;S.replaceRange(se.removed[ve]||"",mt(ze,0,-se.inserted.length),ze,"+input")}q.macroModeState.lastInsertModeChanges.changes.pop()}return le.command||jt(S),le.command}function V(){if(C()||N())return!0;b.inputState.keyBuffer.push(p);var G=b.inputState.keyBuffer.join("");if(/^[1-9]\d*$/.test(G))return!0;var ie=/^(\d*)(.*)$/.exec(G);if(!ie)return jt(S),!1;var le=b.visualMode?"visual":"normal",se=ie[2]||ie[1];b.inputState.operatorShortcut&&b.inputState.operatorShortcut.slice(-1)==se&&(se=b.inputState.operatorShortcut);var K=nt.matchCommand(se,s,b.inputState,le);return K.type=="none"?(jt(S),!1):K.type=="partial"?(K.expectLiteralNext&&(b.expectLiteralNext=!0),!0):K.type=="clear"?(jt(S),!0):(b.expectLiteralNext=!1,b.inputState.keyBuffer.length=0,ie=/^(\d*)(.*)$/.exec(G),ie&&ie[1]&&ie[1]!="0"&&b.inputState.pushRepeatDigit(ie[1]),K.command)}var z=b.insertMode?L():V();if(z===!1)return!b.insertMode&&(p.length===1||n.isMac&&/<A-.>/.test(p))?function(){return!0}:void 0;if(z===!0)return function(){return!0};if(z)return function(){return S.operation(function(){S.curOp.isVimOp=!0;try{if(typeof z!="object")return;z.type=="keyToKey"?pt(S,z.toKeys,z):nt.processCommand(S,b,z)}catch(G){throw S.state.vim=void 0,Ae(S),me.suppressErrorLogging||console.log(G),G}return!0})}},handleEx:function(d,p){Qe.processCommand(d,p)},defineMotion:Vt,defineAction:qt,defineOperator:It,mapCommand:We,_mapCommand:ot,defineRegister:fn,exitVisualMode:Be,exitInsertMode:De},Ye=[],ft=!1,_e;function Ge(d){if(!_e)throw new Error("No prompt to send key to");if(d[0]=="<"){var p=d.toLowerCase().slice(1,-1),g=p.split("-");if(p=g.pop()||"",p=="lt")d="<";else if(p=="space")d=" ";else if(p=="cr")d=`
`;else if(on[p]){var b=_e.value||"",S={key:on[p],target:{value:b,selectionEnd:b.length,selectionStart:b.length}};_e.onKeyDown&&_e.onKeyDown(S,_e.value,N),_e&&_e.onKeyUp&&_e.onKeyUp(S,_e.value,N);return}}if(d==`
`){var C=_e;_e=null,C.onClose&&C.onClose(C.value)}else _e.value=(_e.value||"")+d;function N(L){_e&&(typeof L=="string"?_e.value=L:_e=null)}}function pt(d,p,g){var b=ft;if(g){if(Ye.indexOf(g)!=-1)return;Ye.push(g),ft=g.noremap!=!1}try{for(var S=Ae(d),C=/<(?:[CSMA]-)*\w+>|./gi,N;N=C.exec(p);){var L=N[0],V=S.insertMode;if(_e){Ge(L);continue}var z=me.handleKey(d,L,"mapping");if(!z&&V&&S.insertMode){if(L[0]=="<"){var G=L.toLowerCase().slice(1,-1),ie=G.split("-");if(G=ie.pop()||"",G=="lt")L="<";else if(G=="space")L=" ";else if(G=="cr")L=`
`;else if(on.hasOwnProperty(G)){L=on[G],Ps(d,L);continue}else L=L[0],C.lastIndex=N.index+1}d.replaceSelection(L)}}}finally{if(Ye.pop(),ft=Ye.length?b:!1,!Ye.length&&_e){var le=_e;_e=null,yr(d,le)}}}var rt={Return:"CR",Backspace:"BS",Delete:"Del",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"CR"," ":"Space"},tn={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1,AltGraph:1,Dead:1,Unidentified:1},on={};"Left|Right|Up|Down|End|Home".split("|").concat(Object.keys(rt)).forEach(function(d){on[(rt[d]||"").toLowerCase()]=on[d.toLowerCase()]=d});function xn(d,p){var C;var g=d.key;if(!tn[g]){g.length>1&&g[0]=="n"&&(g=g.replace("Numpad","")),g=rt[g]||g;var b="";if(d.ctrlKey&&(b+="C-"),d.altKey&&(b+="A-"),d.metaKey&&(b+="M-"),n.isMac&&b=="A-"&&g.length==1&&(b=b.slice(2)),(b||g.length>1)&&d.shiftKey&&(b+="S-"),p&&!p.expectLiteralNext&&g.length==1){if(i.keymap&&g in i.keymap)(i.remapCtrl!=!1||!b)&&(g=i.keymap[g]);else if(g.charCodeAt(0)>128&&!a[g]){var S=((C=d.code)==null?void 0:C.slice(-1))||"";d.shiftKey||(S=S.toLowerCase()),S&&(g=S,!b&&d.altKey&&(b="A-"))}}return b+=g,b.length>1&&(b="<"+b+">"),b}}function Gt(d,p){i.string!==d&&(i=In(d)),i.remapCtrl=p}function In(d){let p={};if(!d)return{keymap:p,string:""};function g(b){return b.split(/\\?(.)/).filter(Boolean)}return d.split(/((?:[^\\,]|\\.)+),/).map(b=>{if(!b)return;const S=b.split(/((?:[^\\;]|\\.)+);/);if(S.length==3){const C=g(S[1]),N=g(S[2]);if(C.length!==N.length)return;for(let L=0;L<C.length;++L)p[C[L]]=N[L]}else if(S.length==1){const C=g(b);if(C.length%2!==0)return;for(let N=0;N<C.length;N+=2)p[C[N]]=C[N+1]}}),{keymap:p,string:d}}ue("langmap",void 0,"string",["lmap"],function(d,p){if(d===void 0)return i.string;Gt(d)});class Ft{constructor(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=void 0,this.changeQueue=null}pushRepeatDigit(p){this.operator?this.motionRepeat=this.motionRepeat.concat(p):this.prefixRepeat=this.prefixRepeat.concat(p)}getRepeat(){var p=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(p=1,this.prefixRepeat.length>0&&(p*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(p*=parseInt(this.motionRepeat.join(""),10))),p}}function jt(d,p){d.state.vim.inputState=new Ft,d.state.vim.expectLiteralNext=!1,n.signal(d,"vim-command-done",p)}function Gn(){this.removed=[],this.inserted=""}class un{constructor(p,g,b){this.clear(),this.keyBuffer=[p||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!g,this.blockwise=!!b}setText(p,g,b){this.keyBuffer=[p||""],this.linewise=!!g,this.blockwise=!!b}pushText(p,g){g&&(this.linewise||this.keyBuffer.push(`
`),this.linewise=!0),this.keyBuffer.push(p)}pushInsertModeChanges(p){this.insertModeChanges.push(ke(p))}pushSearchQuery(p){this.searchQueries.push(p)}clear(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1}toString(){return this.keyBuffer.join("")}}function fn(d,p){var g=q.registerController.registers;if(!d||d.length!=1)throw Error("Register name must be 1 character");if(g[d])throw Error("Register already defined "+d);g[d]=p,O.push(d)}class at{constructor(p){this.registers=p,this.unnamedRegister=p['"']=new un,p["."]=new un,p[":"]=new un,p["/"]=new un,p["+"]=new un}pushText(p,g,b,S,C){if(p!=="_"){S&&b.charAt(b.length-1)!==`
`&&(b+=`
`);var N=this.isValidRegister(p)?this.getRegister(p):null;if(!N||!p){switch(g){case"yank":this.registers[0]=new un(b,S,C);break;case"delete":case"change":b.indexOf(`
`)==-1?this.registers["-"]=new un(b,S):(this.shiftNumericRegisters_(),this.registers[1]=new un(b,S));break}this.unnamedRegister.setText(b,S,C);return}var L=_(p);L?N.pushText(b,S):N.setText(b,S,C),p==="+"&&navigator.clipboard.writeText(b),this.unnamedRegister.setText(N.toString(),S)}}getRegister(p){return this.isValidRegister(p)?(p=p.toLowerCase(),this.registers[p]||(this.registers[p]=new un),this.registers[p]):this.unnamedRegister}isValidRegister(p){return p&&(ce(p,O)||k.test(p))}shiftNumericRegisters_(){for(var p=9;p>=2;p--)this.registers[p]=this.getRegister(""+(p-1))}}class Un{constructor(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}nextMatch(p,g){var b=this.historyBuffer,S=g?-1:1;this.initialPrefix===null&&(this.initialPrefix=p);for(var C=this.iterator+S;g?C>=0:C<b.length;C+=S)for(var N=b[C],L=0;L<=N.length;L++)if(this.initialPrefix==N.substring(0,L))return this.iterator=C,N;if(C>=b.length)return this.iterator=b.length,this.initialPrefix;if(C<0)return p}pushInput(p){var g=this.historyBuffer.indexOf(p);g>-1&&this.historyBuffer.splice(g,1),p.length&&this.historyBuffer.push(p)}reset(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}}var nt={matchCommand:function(d,p,g,b){var S=Fn(d,p,b,g),C=S.full[0];if(!C)return S.partial.length?{type:"partial",expectLiteralNext:S.partial.length==1&&S.partial[0].keys.slice(-11)=="<character>"}:{type:"none"};if(C.keys.slice(-11)=="<character>"||C.keys.slice(-10)=="<register>"){var N=Hn(d);if(!N||N.length>1)return{type:"clear"};g.selectedCharacter=N}return{type:"full",command:C}},processCommand:function(d,p,g){switch(p.inputState.repeatOverride=g.repeatOverride,g.type){case"motion":this.processMotion(d,p,g);break;case"operator":this.processOperator(d,p,g);break;case"operatorMotion":this.processOperatorMotion(d,p,g);break;case"action":this.processAction(d,p,g);break;case"search":this.processSearch(d,p,g);break;case"ex":case"keyToEx":this.processEx(d,p,g);break}},processMotion:function(d,p,g){p.inputState.motion=g.motion,p.inputState.motionArgs=zn(g.motionArgs),this.evalInput(d,p)},processOperator:function(d,p,g){var b=p.inputState;if(b.operator)if(b.operator==g.operator){b.motion="expandToLine",b.motionArgs={linewise:!0,repeat:1},this.evalInput(d,p);return}else jt(d);b.operator=g.operator,b.operatorArgs=zn(g.operatorArgs),g.keys.length>1&&(b.operatorShortcut=g.keys),g.exitVisualBlock&&(p.visualBlock=!1,ne(d)),p.visualMode&&this.evalInput(d,p)},processOperatorMotion:function(d,p,g){var b=p.visualMode,S=zn(g.operatorMotionArgs);S&&b&&S.visualLine&&(p.visualLine=!0),this.processOperator(d,p,g),b||this.processMotion(d,p,g)},processAction:function(d,p,g){var b=p.inputState,S=b.getRepeat(),C=!!S,N=zn(g.actionArgs)||{repeat:1};b.selectedCharacter&&(N.selectedCharacter=b.selectedCharacter),g.operator&&this.processOperator(d,p,g),g.motion&&this.processMotion(d,p,g),(g.motion||g.operator)&&this.evalInput(d,p),N.repeat=S||1,N.repeatIsExplicit=C,N.registerName=b.registerName,jt(d),p.lastMotion=null,g.isEdit&&this.recordLastEdit(p,b,g),Le[g.action](d,N,p)},processSearch:function(d,p,g){if(!d.getSearchCursor)return;var b=g.searchArgs.forward,S=g.searchArgs.wholeWordOnly;Yn(d).setReversed(!b);var C=b?"/":"?",N=Yn(d).getQuery(),L=d.getScrollInfo(),V="";function z(Pe,ze,ct){q.searchHistoryController.pushInput(Pe),q.searchHistoryController.reset();try{$a(d,Pe,ze,ct)}catch{Ct(d,"Invalid regex: "+Pe),jt(d);return}nt.processMotion(d,p,{keys:"",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:g.searchArgs.toJumplist}})}function G(Pe){d.scrollTo(L.left,L.top),z(Pe,!0,!0);var ze=q.macroModeState;ze.isRecording&&Yt(ze,Pe)}function ie(){return de("pcre")?"(JavaScript regexp: set pcre)":"(Vim regexp: set nopcre)"}function le(Pe,ze,ct){var it=xn(Pe),Rt,_t;it=="<Up>"||it=="<Down>"?(Rt=it=="<Up>",_t=Pe.target?Pe.target.selectionEnd:0,ze=q.searchHistoryController.nextMatch(ze,Rt)||"",ct(ze),_t&&Pe.target&&(Pe.target.selectionEnd=Pe.target.selectionStart=Math.min(_t,Pe.target.value.length))):it&&it!="<Left>"&&it!="<Right>"&&q.searchHistoryController.reset(),V=ze,se()}function se(){var Pe;try{Pe=$a(d,V,!0,!0)}catch{}Pe?d.scrollIntoView(J(d,!b,Pe),30):(A(d),d.scrollTo(L.left,L.top))}function K(Pe,ze,ct){var it=xn(Pe);it=="<Esc>"||it=="<C-c>"||it=="<C-[>"||it=="<BS>"&&ze==""?(q.searchHistoryController.pushInput(ze),q.searchHistoryController.reset(),$a(d,(N==null?void 0:N.source)||""),A(d),d.scrollTo(L.left,L.top),n.e_stop(Pe),jt(d),ct(),d.focus()):it=="<Up>"||it=="<Down>"?n.e_stop(Pe):it=="<C-u>"&&(n.e_stop(Pe),ct(""))}switch(g.searchArgs.querySrc){case"prompt":var ve=q.macroModeState;if(ve.isPlaying){let ze=ve.replaySearchQueries.shift();z(ze||"",!0,!1)}else yr(d,{onClose:G,prefix:C,desc:ys("span",{$cursor:"pointer",onmousedown:function(ze){ze.preventDefault(),W("pcre",!de("pcre")),this.textContent=ie(),se()}},ie()),onKeyUp:le,onKeyDown:K});break;case"wordUnderCursor":var xe=ws(d,{noSymbol:!0}),$e=!0;if(xe||(xe=ws(d,{noSymbol:!1}),$e=!1),!xe){Ct(d,"No word under cursor"),jt(d);return}let Pe=d.getLine(xe.start.line).substring(xe.start.ch,xe.end.ch);$e&&S?Pe="\\b"+Pe+"\\b":Pe=na(Pe),q.jumpList.cachedCursor=d.getCursor(),d.setCursor(xe.start),z(Pe,!0,!1);break}},processEx:function(d,p,g){function b(L){q.exCommandHistoryController.pushInput(L),q.exCommandHistoryController.reset(),Qe.processCommand(d,L),d.state.vim&&jt(d),A(d)}function S(L,V,z){var G=xn(L),ie,le;(G=="<Esc>"||G=="<C-c>"||G=="<C-[>"||G=="<BS>"&&V=="")&&(q.exCommandHistoryController.pushInput(V),q.exCommandHistoryController.reset(),n.e_stop(L),jt(d),A(d),z(),d.focus()),G=="<Up>"||G=="<Down>"?(n.e_stop(L),ie=G=="<Up>",le=L.target?L.target.selectionEnd:0,V=q.exCommandHistoryController.nextMatch(V,ie)||"",z(V),le&&L.target&&(L.target.selectionEnd=L.target.selectionStart=Math.min(le,L.target.value.length))):G=="<C-u>"?(n.e_stop(L),z("")):G&&G!="<Left>"&&G!="<Right>"&&q.exCommandHistoryController.reset()}function C(L,V){var z=new n.StringStream(V),G={};try{if(Qe.parseInput_(d,z,G),G.commandName!="s"){A(d);return}var ie=Qe.matchCommand_(G.commandName);if(!ie||(Qe.parseCommandArgs_(z,G,ie),!G.argString))return;var le=Oo(G.argString.slice(1),!0,!0);le&&Y(d,le)}catch{}}if(g.type=="keyToEx")Qe.processCommand(d,g.exArgs.input);else{var N={onClose:b,onKeyDown:S,onKeyUp:C,prefix:":"};p.visualMode&&(N.value="'<,'>",N.selectValueOnOpen=!1),yr(d,N)}},evalInput:function(d,p){var g=p.inputState,b=g.motion,S=g.motionArgs||{repeat:1},C=g.operator,N=g.operatorArgs||{},L=g.registerName,V=p.sel,z=Dt(p.visualMode?tt(d,V.head):d.getCursor("head")),G=Dt(p.visualMode?tt(d,V.anchor):d.getCursor("anchor")),ie=Dt(z),le=Dt(G),se,K,ve;if(C&&this.recordLastEdit(p,g),g.repeatOverride!==void 0?ve=g.repeatOverride:ve=g.getRepeat(),ve>0&&S.explicitRepeat?S.repeatIsExplicit=!0:(S.noRepeat||!S.explicitRepeat&&ve===0)&&(ve=1,S.repeatIsExplicit=!1),g.selectedCharacter&&(S.selectedCharacter=N.selectedCharacter=g.selectedCharacter),S.repeat=ve,jt(d),b){var xe=Mt[b](d,z,S,p,g);if(p.lastMotion=Mt[b],!xe)return;if(S.toJumplist){var $e=q.jumpList,Pe=$e.cachedCursor;Pe?(_s(d,Pe,xe),delete $e.cachedCursor):_s(d,z,xe)}xe instanceof Array?(K=xe[0],se=xe[1]):se=xe,se||(se=Dt(z)),p.visualMode?(p.visualBlock&&se.ch===1/0||(se=tt(d,se,ie)),K&&(K=tt(d,K)),K=K||le,V.anchor=K,V.head=se,ne(d),Ls(d,p,"<",He(K,se)?K:se),Ls(d,p,">",He(K,se)?se:K)):C||(se=tt(d,se,ie),d.setCursor(se.line,se.ch))}if(C){if(N.lastSel){K=le;var ze=N.lastSel,ct=Math.abs(ze.head.line-ze.anchor.line),it=Math.abs(ze.head.ch-ze.anchor.ch);ze.visualLine?se=new e(le.line+ct,le.ch):ze.visualBlock?se=new e(le.line+ct,le.ch+it):ze.head.line==ze.anchor.line?se=new e(le.line,le.ch+it):se=new e(le.line+ct,le.ch),p.visualMode=!0,p.visualLine=ze.visualLine,p.visualBlock=ze.visualBlock,V=p.sel={anchor:K,head:se},ne(d)}else p.visualMode&&(N.lastSel={anchor:Dt(V.anchor),head:Dt(V.head),visualBlock:p.visualBlock,visualLine:p.visualLine});var Rt,_t,Ot,qe,Ut;if(p.visualMode){Rt=Tt(V.head,V.anchor),_t=kn(V.head,V.anchor),Ot=p.visualLine||N.linewise,qe=p.visualBlock?"block":Ot?"line":"char";var Dn=t(d,Rt,_t);if(Ut=ge(d,{anchor:Dn.start,head:Dn.end},qe),Ot){var nn=Ut.ranges;if(qe=="block")for(var bn=0;bn<nn.length;bn++)nn[bn].head.ch=ln(d,nn[bn].head.line);else qe=="line"&&(nn[0].head=new e(nn[0].head.line+1,0))}}else{if(Rt=Dt(K||le),_t=Dt(se||ie),He(_t,Rt)){var ps=Rt;Rt=_t,_t=ps}Ot=S.linewise||N.linewise,Ot?Nt(d,Rt,_t):S.forward&&wt(d,Rt,_t),qe="char";var sa=!S.inclusive||Ot,Dn=t(d,Rt,_t);Ut=ge(d,{anchor:Dn.start,head:Dn.end},qe,sa)}d.setSelections(Ut.ranges,Ut.primary),p.lastMotion=null,N.repeat=ve,N.registerName=L,N.linewise=Ot;var Is=lt[C](d,N,Ut.ranges,le,se);p.visualMode&&Be(d,Is!=null),Is&&d.setCursor(Is)}},recordLastEdit:function(d,p,g){var b=q.macroModeState;b.isPlaying||(d.lastEditInputState=p,d.lastEditActionCommand=g,b.lastInsertModeChanges.changes=[],b.lastInsertModeChanges.expectCursorActivityForChange=!1,b.lastInsertModeChanges.visualBlock=d.visualBlock?d.sel.head.line-d.sel.anchor.line:0)}},Mt={moveToTopLine:function(d,p,g){var b=we(d).top+g.repeat-1;return new e(b,yn(d.getLine(b)))},moveToMiddleLine:function(d){var p=we(d),g=Math.floor((p.top+p.bottom)*.5);return new e(g,yn(d.getLine(g)))},moveToBottomLine:function(d,p,g){var b=we(d).bottom-g.repeat+1;return new e(b,yn(d.getLine(b)))},expandToLine:function(d,p,g){var b=p;return new e(b.line+g.repeat-1,1/0)},findNext:function(d,p,g){var b=Yn(d),S=b.getQuery();if(S){var C=!g.forward;C=b.isReversed()?!C:C,Y(d,S);var N=J(d,C,S,g.repeat);return N||Ct(d,"No match found "+S+(de("pcre")?" (set nopcre to use Vim regexps)":"")),N}},findAndSelectNextInclusive:function(d,p,g,b,S){var C=Yn(d),N=C.getQuery();if(N){var L=!g.forward;L=C.isReversed()?!L:L;var V=te(d,L,N,g.repeat,b);if(V){if(S.operator)return V;var z=V[0],G=new e(V[1].line,V[1].ch-1);if(b.visualMode){(b.visualLine||b.visualBlock)&&(b.visualLine=!1,b.visualBlock=!1,n.signal(d,"vim-mode-change",{mode:"visual",subMode:""}));var ie=b.sel.anchor;if(ie)return C.isReversed()?g.forward?[ie,z]:[ie,G]:g.forward?[ie,G]:[ie,z]}else b.visualMode=!0,b.visualLine=!1,b.visualBlock=!1,n.signal(d,"vim-mode-change",{mode:"visual",subMode:""});return L?[G,z]:[z,G]}}},goToMark:function(d,p,g,b){var S=Oe(d,b,g.selectedCharacter||"");return S?g.linewise?{line:S.line,ch:yn(d.getLine(S.line))}:S:null},moveToOtherHighlightedEnd:function(d,p,g,b){var S=b.sel;return b.visualBlock&&g.sameLine?[tt(d,new e(S.anchor.line,S.head.ch)),tt(d,new e(S.head.line,S.anchor.ch))]:[S.head,S.anchor]},jumpToMark:function(d,p,g,b){for(var S=p,C=0;C<g.repeat;C++){var N=S;for(var L in b.marks)if(I(L)){var V=b.marks[L].find(),z=g.forward?He(V,N):He(N,V);if(!z&&!(g.linewise&&V.line==N.line)){var G=Sn(N,S),ie=g.forward?vs(N,V,S):vs(S,V,N);(G||ie)&&(S=V)}}}return g.linewise&&(S=new e(S.line,yn(d.getLine(S.line)))),S},moveByCharacters:function(d,p,g){var b=p,S=g.repeat,C=g.forward?b.ch+S:b.ch-S;return new e(b.line,C)},moveByLines:function(d,p,g,b){var S=p,C=S.ch;switch(b.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:C=b.lastHPos;break;default:b.lastHPos=C}var N=g.repeat+(g.repeatOffset||0),L=g.forward?S.line+N:S.line-N,V=d.firstLine(),z=d.lastLine(),G=d.findPosV(S,g.forward?N:-N,"line",b.lastHSPos),ie=g.forward?G.line>L:G.line<L;return ie&&(L=G.line,C=G.ch),L<V&&S.line==V?this.moveToStartOfLine(d,p,g,b):L>z&&S.line==z?Rr(d,p,g,b,!0):(g.toFirstChar&&(C=yn(d.getLine(L)),b.lastHPos=C),b.lastHSPos=d.charCoords(new e(L,C),"div").left,new e(L,C))},moveByDisplayLines:function(d,p,g,b){var S=p;switch(b.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:b.lastHSPos=d.charCoords(S,"div").left}var C=g.repeat,N=d.findPosV(S,g.forward?C:-C,"line",b.lastHSPos);if(N.hitSide)if(g.forward){var L=d.charCoords(N,"div"),V={top:L.top+8,left:b.lastHSPos};N=d.coordsChar(V,"div")}else{var z=d.charCoords(new e(d.firstLine(),0),"div");z.left=b.lastHSPos,N=d.coordsChar(z,"div")}return b.lastHPos=N.ch,N},moveByPage:function(d,p,g){var b=p,S=g.repeat;return d.findPosV(b,g.forward?S:-S,"page")},moveByParagraph:function(d,p,g){var b=g.forward?1:-1;return vo(d,p,g.repeat,b).start},moveBySentence:function(d,p,g){var b=g.forward?1:-1;return ic(d,p,g.repeat,b)},moveByScroll:function(d,p,g,b){var S=d.getScrollInfo(),C=null,N=g.repeat;N||(N=S.clientHeight/(2*d.defaultTextHeight()));var L=d.charCoords(p,"local");if(g.repeat=N,C=Mt.moveByDisplayLines(d,p,g,b),!C)return null;var V=d.charCoords(C,"local");return d.scrollTo(null,S.top+V.top-L.top),C},moveByWords:function(d,p,g){return $r(d,p,g.repeat,!!g.forward,!!g.wordEnd,!!g.bigWord)},moveTillCharacter:function(d,p,g){var b=g.repeat,S=Na(d,b,g.forward,g.selectedCharacter,p),C=g.forward?-1:1;return Cn(C,g),S?(S.ch+=C,S):null},moveToCharacter:function(d,p,g){var b=g.repeat;return Cn(0,g),Na(d,b,g.forward,g.selectedCharacter,p)||p},moveToSymbol:function(d,p,g){var b=g.repeat;return g.selectedCharacter&&ls(d,b,g.forward,g.selectedCharacter)||p},moveToColumn:function(d,p,g,b){var S=g.repeat;return b.lastHPos=S-1,b.lastHSPos=d.charCoords(p,"div").left,rc(d,S)},moveToEol:function(d,p,g,b){return Rr(d,p,g,b,!1)},moveToFirstNonWhiteSpaceCharacter:function(d,p){var g=p;return new e(g.line,yn(d.getLine(g.line)))},moveToMatchedSymbol:function(d,p){for(var g=p,b=g.line,S=g.ch,C=d.getLine(b),N;S<C.length;S++)if(N=C.charAt(S),N&&D(N)){var L=d.getTokenTypeAt(new e(b,S+1));if(L!=="string"&&L!=="comment")break}if(S<C.length){var V=N==="<"||N===">"?/[(){}[\]<>]/:/[(){}[\]]/,z=d.findMatchingBracket(new e(b,S),{bracketRegex:V});return z.to}else return g},moveToStartOfLine:function(d,p){return new e(p.line,0)},moveToLineOrEdgeOfDocument:function(d,p,g){var b=g.forward?d.lastLine():d.firstLine();return g.repeatIsExplicit&&(b=g.repeat-d.getOption("firstLineNumber")),new e(b,yn(d.getLine(b)))},moveToStartOfDisplayLine:function(d){return d.execCommand("goLineLeft"),d.getCursor()},moveToEndOfDisplayLine:function(d){d.execCommand("goLineRight");var p=d.getCursor();return p.sticky=="before"&&p.ch--,p},textObjectManipulation:function(d,p,g,b){var S={"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"},C={"'":!0,'"':!0,"`":!0},N=g.selectedCharacter||"";N=="b"?N="(":N=="B"&&(N="{");var L=!g.textObjectInner,V,z;if(S[N]){if(z=!0,V=wo(d,p,N,L),!V){var G=d.getSearchCursor(new RegExp("\\"+N,"g"),p);G.find()&&(V=wo(d,G.from(),N,L))}}else if(C[N])z=!0,V=Zo(d,p,N,L);else if(N==="W"||N==="w")for(var ie=g.repeat||1;ie-- >0;){var le=ws(d,{inclusive:L,innerWord:!L,bigWord:N==="W",noSymbol:N==="W",multiline:!0},V&&V.end);le&&(V||(V=le),V.end=le.end)}else if(N==="p")if(V=vo(d,p,g.repeat,0,L),g.linewise=!0,b.visualMode)b.visualLine||(b.visualLine=!0);else{var se=b.inputState.operatorArgs;se&&(se.linewise=!0),V.end.line--}else if(N==="t")V=gn(d,p,L);else if(N==="s"){var K=d.getLine(p.line);p.ch>0&&Z(K[p.ch])&&(p.ch-=1);var ve=er(d,p,g.repeat,1,L),xe=er(d,p,g.repeat,-1,L);$(d.getLine(xe.line)[xe.ch])&&$(d.getLine(ve.line)[ve.ch-1])&&(xe={line:xe.line,ch:xe.ch+1}),V={start:xe,end:ve}}return V?d.state.vim.visualMode?ee(d,V.start,V.end,z):[V.start,V.end]:null},repeatLastCharacterSearch:function(d,p,g){var b=q.lastCharacterSearch,S=g.repeat,C=g.forward===b.forward,N=(b.increment?1:0)*(C?-1:1);d.moveH(-N,"char"),g.inclusive=!!C;var L=Na(d,S,C,b.selectedCharacter);return L?(L.ch+=N,L):(d.moveH(N,"char"),p)}};function Vt(d,p){Mt[d]=p}function En(d,p){for(var g=[],b=0;b<p;b++)g.push(d);return g}var lt={change:function(d,p,g){var b,S,C=d.state.vim,N=g[0].anchor,L=g[0].head;if(C.visualMode)if(p.fullLine)L.ch=Number.MAX_VALUE,L.line--,d.setSelection(N,L),S=d.getSelection(),d.replaceSelection(""),b=N;else{S=d.getSelection();var G=En("",g.length);d.replaceSelections(G),b=Tt(g[0].head,g[0].anchor)}else{S=d.getRange(N,L);var V=C.lastEditInputState;if((V==null?void 0:V.motion)=="moveByWords"&&!$(S)){var z=/\s+$/.exec(S);z&&V.motionArgs&&V.motionArgs.forward&&(L=mt(L,0,-z[0].length),S=S.slice(0,-z[0].length))}p.linewise&&(N=new e(N.line,yn(d.getLine(N.line))),L.line>N.line&&(L=new e(L.line-1,Number.MAX_VALUE))),d.replaceRange("",N,L),b=N}q.registerController.pushText(p.registerName,"change",S,p.linewise,g.length>1),Le.enterInsertMode(d,{head:b},d.state.vim)},delete:function(d,p,g){var b,S,C=d.state.vim;if(C.visualBlock){S=d.getSelection();var V=En("",g.length);d.replaceSelections(V),b=Tt(g[0].head,g[0].anchor)}else{var N=g[0].anchor,L=g[0].head;p.linewise&&L.line!=d.firstLine()&&N.line==d.lastLine()&&N.line==L.line-1&&(N.line==d.firstLine()?N.ch=0:N=new e(N.line-1,ln(d,N.line-1))),S=d.getRange(N,L),d.replaceRange("",N,L),b=N,p.linewise&&(b=Mt.moveToFirstNonWhiteSpaceCharacter(d,N))}return q.registerController.pushText(p.registerName,"delete",S,p.linewise,C.visualBlock),tt(d,b)},indent:function(d,p,g){var b=d.state.vim,S=b.visualMode&&p.repeat||1;if(b.visualBlock){for(var C=d.getOption("tabSize"),N=d.getOption("indentWithTabs")?"	":" ".repeat(C),L,V=g.length-1;V>=0;V--)if(L=Tt(g[V].anchor,g[V].head),p.indentRight)d.replaceRange(N.repeat(S),L,L);else{for(var z=d.getLine(L.line),G=0,ie=0;ie<S;ie++){var le=z[L.ch+G];if(le=="	")G++;else if(le==" "){G++;for(var se=1;se<N.length&&(le=z[L.ch+G],le===" ");se++)G++}else break}d.replaceRange("",L,mt(L,0,G))}return L}else if(d.indentMore)for(var ie=0;ie<S;ie++)p.indentRight?d.indentMore():d.indentLess();else{var K=g[0].anchor.line,ve=b.visualBlock?g[g.length-1].anchor.line:g[0].head.line;p.linewise&&ve--;for(var V=K;V<=ve;V++)for(var ie=0;ie<S;ie++)d.indentLine(V,p.indentRight)}return Mt.moveToFirstNonWhiteSpaceCharacter(d,g[0].anchor)},indentAuto:function(d,p,g){return d.execCommand("indentAuto"),Mt.moveToFirstNonWhiteSpaceCharacter(d,g[0].anchor)},hardWrap:function(d,p,g,b){if(d.hardWrap){var S=g[0].anchor.line,C=g[0].head.line;p.linewise&&C--;var N=d.hardWrap({from:S,to:C});return N>S&&p.linewise&&N--,p.keepCursor?b:new e(N,0)}},changeCase:function(d,p,g,b,S){for(var C=d.getSelections(),N=[],L=p.toLower,V=0;V<C.length;V++){var z=C[V],G="";if(L===!0)G=z.toLowerCase();else if(L===!1)G=z.toUpperCase();else for(var ie=0;ie<z.length;ie++){var le=z.charAt(ie);G+=_(le)?le.toLowerCase():le.toUpperCase()}N.push(G)}return d.replaceSelections(N),p.shouldMoveCursor?S:!d.state.vim.visualMode&&p.linewise&&g[0].anchor.line+1==g[0].head.line?Mt.moveToFirstNonWhiteSpaceCharacter(d,b):p.linewise?b:Tt(g[0].anchor,g[0].head)},yank:function(d,p,g,b){var S=d.state.vim,C=d.getSelection(),N=S.visualMode?Tt(S.sel.anchor,S.sel.head,g[0].head,g[0].anchor):b;return q.registerController.pushText(p.registerName,"yank",C,p.linewise,S.visualBlock),N},rot13:function(d,p,g,b,S){for(var C=d.getSelections(),N=[],L=0;L<C.length;L++){const V=C[L].split("").map(z=>{const G=z.charCodeAt(0);return G>=65&&G<=90?String.fromCharCode(65+(G-65+13)%26):G>=97&&G<=122?String.fromCharCode(97+(G-97+13)%26):z}).join("");N.push(V)}return d.replaceSelections(N),p.shouldMoveCursor?S:!d.state.vim.visualMode&&p.linewise&&g[0].anchor.line+1==g[0].head.line?Mt.moveToFirstNonWhiteSpaceCharacter(d,b):p.linewise?b:Tt(g[0].anchor,g[0].head)}};function It(d,p){lt[d]=p}var Le={jumpListWalk:function(d,p,g){if(!g.visualMode){var b=p.repeat||1,S=p.forward,C=q.jumpList,N=C.move(d,S?b:-b),L=N?N.find():void 0;L=L||d.getCursor(),d.setCursor(L)}},scroll:function(d,p,g){if(!g.visualMode){var b=p.repeat||1,S=d.defaultTextHeight(),C=d.getScrollInfo().top,N=S*b,L=p.forward?C+N:C-N,V=Dt(d.getCursor()),z=d.charCoords(V,"local");if(p.forward)L>z.top?(V.line+=(L-z.top)/S,V.line=Math.ceil(V.line),d.setCursor(V),z=d.charCoords(V,"local"),d.scrollTo(null,z.top)):d.scrollTo(null,L);else{var G=L+d.getScrollInfo().clientHeight;G<z.bottom?(V.line-=(z.bottom-G)/S,V.line=Math.floor(V.line),d.setCursor(V),z=d.charCoords(V,"local"),d.scrollTo(null,z.bottom-d.getScrollInfo().clientHeight)):d.scrollTo(null,L)}}},scrollToCursor:function(d,p){var g=d.getCursor().line,b=d.charCoords(new e(g,0),"local"),S=d.getScrollInfo().clientHeight,C=b.top;switch(p.position){case"center":C=b.bottom-S/2;break;case"bottom":var N=new e(g,d.getLine(g).length-1),L=d.charCoords(N,"local"),V=L.bottom-C;C=C-S+V;break}d.scrollTo(null,C)},replayMacro:function(d,p,g){var b=p.selectedCharacter||"",S=p.repeat||1,C=q.macroModeState;for(b=="@"?b=C.latestRegister||"":C.latestRegister=b;S--;)et(d,g,C,b)},enterMacroRecordMode:function(d,p){var g=q.macroModeState,b=p.selectedCharacter;q.registerController.isValidRegister(b)&&g.enterMacroRecordMode(d,b)},toggleOverwrite:function(d){d.state.overwrite?(d.toggleOverwrite(!1),d.setOption("keyMap","vim-insert"),n.signal(d,"vim-mode-change",{mode:"insert"})):(d.toggleOverwrite(!0),d.setOption("keyMap","vim-replace"),n.signal(d,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(d,p,g){if(!d.getOption("readOnly")){g.insertMode=!0,g.insertModeRepeat=p&&p.repeat||1;var b=p?p.insertAt:null,S=g.sel,C=p.head||d.getCursor("head"),N=d.listSelections().length;if(b=="eol")C=new e(C.line,ln(d,C.line));else if(b=="bol")C=new e(C.line,0);else if(b=="charAfter"){var L=t(d,C,mt(C,0,1));C=L.end}else if(b=="firstNonBlank"){var L=t(d,C,Mt.moveToFirstNonWhiteSpaceCharacter(d,C));C=L.end}else if(b=="startOfSelectedArea"){if(!g.visualMode)return;g.visualBlock?(C=new e(Math.min(S.head.line,S.anchor.line),Math.min(S.head.ch,S.anchor.ch)),N=Math.abs(S.head.line-S.anchor.line)+1):S.head.line<S.anchor.line?C=S.head:C=new e(S.anchor.line,0)}else if(b=="endOfSelectedArea"){if(!g.visualMode)return;g.visualBlock?(C=new e(Math.min(S.head.line,S.anchor.line),Math.max(S.head.ch,S.anchor.ch)+1),N=Math.abs(S.head.line-S.anchor.line)+1):S.head.line>=S.anchor.line?C=mt(S.head,0,1):C=new e(S.anchor.line,0)}else if(b=="inplace"){if(g.visualMode)return}else b=="lastEdit"&&(C=Se(d)||C);d.setOption("disableInput",!1),p&&p.replace?(d.toggleOverwrite(!0),d.setOption("keyMap","vim-replace"),n.signal(d,"vim-mode-change",{mode:"replace"})):(d.toggleOverwrite(!1),d.setOption("keyMap","vim-insert"),n.signal(d,"vim-mode-change",{mode:"insert"})),q.macroModeState.isPlaying||(d.on("change",$t),g.insertEnd&&g.insertEnd.clear(),g.insertEnd=d.setBookmark(C,{insertLeft:!0}),n.on(d.getInputField(),"keydown",On)),g.visualMode&&Be(d),T(d,C,N)}},toggleVisualMode:function(d,p,g){var b=p.repeat,S=d.getCursor(),C;if(g.visualMode)g.visualLine!=!!p.linewise||g.visualBlock!=!!p.blockwise?(g.visualLine=!!p.linewise,g.visualBlock=!!p.blockwise,n.signal(d,"vim-mode-change",{mode:"visual",subMode:g.visualLine?"linewise":g.visualBlock?"blockwise":""}),ne(d)):Be(d);else{g.visualMode=!0,g.visualLine=!!p.linewise,g.visualBlock=!!p.blockwise,C=tt(d,new e(S.line,S.ch+b-1));var N=t(d,S,C);g.sel={anchor:N.start,head:N.end},n.signal(d,"vim-mode-change",{mode:"visual",subMode:g.visualLine?"linewise":g.visualBlock?"blockwise":""}),ne(d),Ls(d,g,"<",Tt(S,C)),Ls(d,g,">",kn(S,C))}},reselectLastSelection:function(d,p,g){var b=g.lastSelection;if(g.visualMode&&H(d,g),b){var S=b.anchorMark.find(),C=b.headMark.find();if(!S||!C)return;g.sel={anchor:S,head:C},g.visualMode=!0,g.visualLine=b.visualLine,g.visualBlock=b.visualBlock,ne(d),Ls(d,g,"<",Tt(S,C)),Ls(d,g,">",kn(S,C)),n.signal(d,"vim-mode-change",{mode:"visual",subMode:g.visualLine?"linewise":g.visualBlock?"blockwise":""})}},joinLines:function(d,p,g){var b,S;if(g.visualMode){if(b=d.getCursor("anchor"),S=d.getCursor("head"),He(S,b)){var C=S;S=b,b=C}S.ch=ln(d,S.line)-1}else{var N=Math.max(p.repeat,2);b=d.getCursor(),S=tt(d,new e(b.line+N-1,1/0))}for(var L=0,V=b.line;V<S.line;V++){L=ln(d,b.line);var z="",G=0;if(!p.keepSpaces){var ie=d.getLine(b.line+1);G=ie.search(/\S/),G==-1?G=ie.length:z=" "}d.replaceRange(z,new e(b.line,L),new e(b.line+1,G))}var le=tt(d,new e(b.line,L));g.visualMode&&Be(d,!1),d.setCursor(le)},newLineAndEnterInsertMode:function(d,p,g){g.insertMode=!0;var b=Dt(d.getCursor());if(b.line===d.firstLine()&&!p.after)d.replaceRange(`
`,new e(d.firstLine(),0)),d.setCursor(d.firstLine(),0);else{b.line=p.after?b.line:b.line-1,b.ch=ln(d,b.line),d.setCursor(b);var S=n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent;S(d)}this.enterInsertMode(d,{repeat:p.repeat},g)},paste:function(d,p,g){var b=q.registerController.getRegister(p.registerName);if(p.registerName==="+")navigator.clipboard.readText().then(C=>{this.continuePaste(d,p,g,C,b)});else{var S=b.toString();this.continuePaste(d,p,g,S,b)}},continuePaste:function(d,p,g,b,S){var C=Dt(d.getCursor());if(b){if(p.matchIndent){var N=d.getOption("tabSize"),L=function(nn){var bn=nn.split("	").length-1,ps=nn.split(" ").length-1;return bn*N+ps*1},V=d.getLine(d.getCursor().line),z=L(V.match(/^\s*/)[0]),G=b.replace(/\n$/,""),ie=b!==G,le=L(b.match(/^\s*/)[0]),b=G.replace(/^\s*/gm,function(nn){var bn=z+(L(nn)-le);if(bn<0)return"";if(d.getOption("indentWithTabs")){var ps=Math.floor(bn/N);return Array(ps+1).join("	")}else return Array(bn+1).join(" ")});b+=ie?`
`:""}p.repeat>1&&(b=Array(p.repeat+1).join(b));var se=S.linewise,K=S.blockwise,ve=K?b.split(`
`):void 0;if(ve){se&&ve.pop();for(var xe=0;xe<ve.length;xe++)ve[xe]=ve[xe]==""?" ":ve[xe];C.ch+=p.after?1:0,C.ch=Math.min(ln(d,C.line),C.ch)}else se?g.visualMode?b=g.visualLine?b.slice(0,-1):`
`+b.slice(0,b.length-1)+`
`:p.after?(b=`
`+b.slice(0,b.length-1),C.ch=ln(d,C.line)):C.ch=0:C.ch+=p.after?1:0;var $e;if(g.visualMode){g.lastPastedText=b;var Pe,ze=j(d),ct=ze[0],it=ze[1],Rt=d.getSelection(),_t=d.listSelections(),Ot=new Array(_t.length).join("1").split("1");g.lastSelection&&(Pe=g.lastSelection.headMark.find()),q.registerController.unnamedRegister.setText(Rt),K?(d.replaceSelections(Ot),it=new e(ct.line+b.length-1,ct.ch),d.setCursor(ct),B(d,it),d.replaceSelections(b),$e=ct):g.visualBlock?(d.replaceSelections(Ot),d.setCursor(ct),d.replaceRange(b,ct,ct),$e=ct):(d.replaceRange(b,ct,it),$e=d.posFromIndex(d.indexFromPos(ct)+b.length-1)),Pe&&(g.lastSelection.headMark=d.setBookmark(Pe)),se&&($e.ch=0)}else if(K&&ve){d.setCursor(C);for(var xe=0;xe<ve.length;xe++){var qe=C.line+xe;qe>d.lastLine()&&d.replaceRange(`
`,new e(qe,0));var Ut=ln(d,qe);Ut<C.ch&&x(d,qe,C.ch)}d.setCursor(C),B(d,new e(C.line+ve.length-1,C.ch)),d.replaceSelections(ve),$e=C}else if(d.replaceRange(b,C),se){var qe=p.after?C.line+1:C.line;$e=new e(qe,yn(d.getLine(qe)))}else $e=Dt(C),/\n/.test(b)||($e.ch+=b.length-(p.after?1:0));g.visualMode&&Be(d,!1),d.setCursor($e)}},undo:function(d,p){d.operation(function(){Zt(d,n.commands.undo,p.repeat)(),d.setCursor(tt(d,d.getCursor("start")))})},redo:function(d,p){Zt(d,n.commands.redo,p.repeat)()},setRegister:function(d,p,g){g.inputState.registerName=p.selectedCharacter},insertRegister:function(d,p,g){var b=p.selectedCharacter,S=q.registerController.getRegister(b),C=S&&S.toString();C&&d.replaceSelection(C)},oneNormalCommand:function(d,p,g){De(d,!0),g.insertModeReturn=!0,n.on(d,"vim-command-done",function b(){g.visualMode||(g.insertModeReturn&&(g.insertModeReturn=!1,g.insertMode||Le.enterInsertMode(d,{},g)),n.off(d,"vim-command-done",b))})},setMark:function(d,p,g){var b=p.selectedCharacter;b&&Ls(d,g,b,d.getCursor())},replace:function(d,p,g){var b=p.selectedCharacter||"",S=d.getCursor(),C,N,L=d.listSelections();if(g.visualMode)S=d.getCursor("start"),N=d.getCursor("end");else{var V=d.getLine(S.line);C=S.ch+p.repeat,C>V.length&&(C=V.length),N=new e(S.line,C)}var z=t(d,S,N);if(S=z.start,N=z.end,b==`
`)g.visualMode||d.replaceRange("",S,N),(n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent)(d);else{var G=d.getRange(S,N);if(G=G.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b),G=G.replace(/[^\n]/g,b),g.visualBlock){var ie=new Array(d.getOption("tabSize")+1).join(" ");G=d.getSelection(),G=G.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b);var le=G.replace(/\t/g,ie).replace(/[^\n]/g,b).split(`
`);d.replaceSelections(le)}else d.replaceRange(G,S,N);g.visualMode?(S=He(L[0].anchor,L[0].head)?L[0].anchor:L[0].head,d.setCursor(S),Be(d,!1)):d.setCursor(mt(N,0,-1))}},incrementNumberToken:function(d,p){for(var g=d.getCursor(),b=d.getLine(g.line),S=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi,C,N,L,V;(C=S.exec(b))!==null&&(N=C.index,L=N+C[0].length,!(g.ch<L)););if(!(!p.backtrack&&L<=g.ch)){if(C){var z=C[2]||C[4],G=C[3]||C[5],ie=p.increase?1:-1,le={"0b":2,0:8,"":10,"0x":16}[z.toLowerCase()],se=parseInt(C[1]+G,le)+ie*p.repeat;V=se.toString(le);var K=z?new Array(G.length-V.length+1+C[1].length).join("0"):"";V.charAt(0)==="-"?V="-"+z+K+V.substr(1):V=z+K+V;var ve=new e(g.line,N),xe=new e(g.line,L);d.replaceRange(V,ve,xe)}else return;d.setCursor(new e(g.line,N+V.length-1))}},repeatLastEdit:function(d,p,g){var b=g.lastEditInputState;if(b){var S=p.repeat;S&&p.repeatIsExplicit?b.repeatOverride=S:S=b.repeatOverride||S,ms(d,g,S,!1)}},indent:function(d,p){d.indentLine(d.getCursor().line,p.indentRight)},exitInsertMode:function(d,p){De(d)}};function qt(d,p){Le[d]=p}function tt(d,p,g){var b=d.state.vim,S=b.insertMode||b.visualMode,C=Math.min(Math.max(d.firstLine(),p.line),d.lastLine()),N=d.getLine(C),L=N.length-1+ +!!S,V=Math.min(Math.max(0,p.ch),L),z=N.charCodeAt(V);if(56320<=z&&z<=57343){var G=1;g&&g.line==C&&g.ch>V&&(G=-1),V+=G,V>L&&(V-=2)}return new e(C,V)}function zn(d){var p={};for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(p[g]=d[g]);return p}function mt(d,p,g){return typeof p=="object"&&(g=p.ch,p=p.line),new e(d.line+p,d.ch+g)}function Fn(d,p,g,b){b.operator&&(g="operatorPending");for(var S,C=[],N=[],L=ft?p.length-r:0,V=L;V<p.length;V++){var z=p[V];g=="insert"&&z.context!="insert"||z.context&&z.context!=g||b.operator&&z.type=="action"||!(S=ea(d,z.keys))||(S=="partial"&&C.push(z),S=="full"&&N.push(z))}return{partial:C,full:N}}function ea(d,p){const g=p.slice(-11)=="<character>",b=p.slice(-10)=="<register>";if(g||b){var S=p.length-(g?11:10),C=d.slice(0,S),N=p.slice(0,S);return C==N&&d.length>S?"full":N.indexOf(C)==0?"partial":!1}else return d==p?"full":p.indexOf(d)==0?"partial":!1}function Hn(d){var p=/^.*(<[^>]+>)$/.exec(d),g=p?p[1]:d.slice(-1);if(g.length>1)switch(g){case"<CR>":case"<S-CR>":g=`
`;break;case"<Space>":case"<S-Space>":g=" ";break;default:g="";break}return g}function Zt(d,p,g){return function(){for(var b=0;b<g;b++)p(d)}}function Dt(d){return new e(d.line,d.ch)}function Sn(d,p){return d.ch==p.ch&&d.line==p.line}function He(d,p){return d.line<p.line||d.line==p.line&&d.ch<p.ch}function Tt(d,p){return arguments.length>2&&(p=Tt.apply(void 0,Array.prototype.slice.call(arguments,1))),He(d,p)?d:p}function kn(d,p){return arguments.length>2&&(p=kn.apply(void 0,Array.prototype.slice.call(arguments,1))),He(d,p)?p:d}function vs(d,p,g){var b=He(d,p),S=He(p,g);return b&&S}function ln(d,p){return d.getLine(p).length}function Gs(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function na(d){return d.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function x(d,p,g){var b=ln(d,p),S=new Array(g-b+1).join(" ");d.setCursor(new e(p,b)),d.replaceRange(S,d.getCursor())}function B(d,p){var g=[],b=d.listSelections(),S=Dt(d.clipPos(p)),C=!Sn(p,S),N=d.getCursor("head"),L=R(b,N),V=Sn(b[L].head,b[L].anchor),z=b.length-1,G=z-L>L?z:0,ie=b[G].anchor,le=Math.min(ie.line,S.line),se=Math.max(ie.line,S.line),K=ie.ch,ve=S.ch,xe=b[G].head.ch-K,$e=ve-K;xe>0&&$e<=0?(K++,C||ve--):xe<0&&$e>=0?(K--,V||ve++):xe<0&&$e==-1&&(K--,ve++);for(var Pe=le;Pe<=se;Pe++){var ze={anchor:new e(Pe,K),head:new e(Pe,ve)};g.push(ze)}return d.setSelections(g),p.ch=ve,ie.ch=K,ie}function T(d,p,g){for(var b=[],S=0;S<g;S++){var C=mt(p,S,0);b.push({anchor:C,head:C})}d.setSelections(b,0)}function R(d,p,g){for(var b=0;b<d.length;b++){var S=Sn(d[b].anchor,p),C=Sn(d[b].head,p);if(S||C)return b}return-1}function j(d,p){var g=d.listSelections(),b=g[0],S=g[g.length-1],C=He(b.anchor,b.head)?b.anchor:b.head,N=He(S.anchor,S.head)?S.head:S.anchor;return[C,N]}function H(d,p){var g=p.sel.anchor,b=p.sel.head;p.lastPastedText&&(b=d.posFromIndex(d.indexFromPos(g)+p.lastPastedText.length),p.lastPastedText=void 0),p.lastSelection={anchorMark:d.setBookmark(g),headMark:d.setBookmark(b),anchor:Dt(g),head:Dt(b),visualMode:p.visualMode,visualLine:p.visualLine,visualBlock:p.visualBlock}}function ee(d,p,g,b){var S=d.state.vim.sel,C=b?p:S.head,N=b?p:S.anchor,L;return He(g,p)&&(L=g,g=p,p=L),He(C,N)?(C=Tt(p,C),N=kn(N,g)):(N=Tt(p,N),C=kn(C,g),C=mt(C,0,-1),C.ch==-1&&C.line!=d.firstLine()&&(C=new e(C.line-1,ln(d,C.line-1)))),[N,C]}function ne(d,p,g){var b=d.state.vim;p=p||b.sel,g||(g=b.visualLine?"line":b.visualBlock?"block":"char");var S=ge(d,p,g);d.setSelections(S.ranges,S.primary)}function ge(d,p,g,b){var S=Dt(p.head),C=Dt(p.anchor);if(g=="char"){var N=!b&&!He(p.head,p.anchor)?1:0,L=He(p.head,p.anchor)?1:0;return S=mt(p.head,0,N),C=mt(p.anchor,0,L),{ranges:[{anchor:C,head:S}],primary:0}}else if(g=="line"){if(He(p.head,p.anchor))S.ch=0,C.ch=ln(d,C.line);else{C.ch=0;var V=d.lastLine();S.line>V&&(S.line=V),S.ch=ln(d,S.line)}return{ranges:[{anchor:C,head:S}],primary:0}}else if(g=="block"){var z=Math.min(C.line,S.line),G=C.ch,ie=Math.max(C.line,S.line),le=S.ch;G<le?le+=1:G+=1;for(var se=ie-z+1,K=S.line==z?0:se-1,ve=[],xe=0;xe<se;xe++)ve.push({anchor:new e(z+xe,G),head:new e(z+xe,le)});return{ranges:ve,primary:K}}throw"never happens"}function Fe(d){var p=d.getCursor("head");return d.getSelection().length==1&&(p=Tt(p,d.getCursor("anchor"))),p}function Be(d,p){var g=d.state.vim;p!==!1&&d.setCursor(tt(d,g.sel.head)),H(d,g),g.visualMode=!1,g.visualLine=!1,g.visualBlock=!1,g.insertMode||n.signal(d,"vim-mode-change",{mode:"normal"})}function wt(d,p,g){var b=d.getRange(p,g);if(/\n\s*$/.test(b)){var S=b.split(`
`);S.pop();for(var C=S.pop();S.length>0&&C&&$(C);C=S.pop())g.line--,g.ch=0;C?(g.line--,g.ch=ln(d,g.line)):g.ch=0}}function Nt(d,p,g){p.ch=0,g.ch=0,g.line++}function yn(d){if(!d)return 0;var p=d.search(/\S/);return p==-1?d.length:p}function ws(d,{inclusive:p,innerWord:g,bigWord:b,noSymbol:S,multiline:C},N){var L=N||Fe(d),V=d.getLine(L.line),z=V,G=L.line,ie=G,le=L.ch,se,K=S?m[0]:f[0];if(g&&/\s/.test(V.charAt(le)))K=function(ct){return/\s/.test(ct)};else{for(;!K(V.charAt(le));)if(le++,le>=V.length){if(!C)return null;le--,se=Fa(d,L,!0,b,!0);break}b?K=f[0]:(K=m[0],K(V.charAt(le))||(K=m[1]))}for(var ve=le,xe=le;K(V.charAt(xe))&&xe>=0;)xe--;if(xe++,se)ve=se.to,ie=se.line,z=d.getLine(ie),!z&&ve==0&&ve++;else for(;K(V.charAt(ve))&&ve<V.length;)ve++;if(p){var $e=ve,Pe=L.ch<=xe&&/\s/.test(V.charAt(L.ch));if(!Pe)for(;/\s/.test(z.charAt(ve))&&ve<z.length;)ve++;if($e==ve||Pe){for(var ze=xe;/\s/.test(V.charAt(xe-1))&&xe>0;)xe--;!xe&&!Pe&&(xe=ze)}}return{start:new e(G,xe),end:new e(ie,ve)}}function gn(d,p,g){var b=p;if(!n.findMatchingTag||!n.findEnclosingTag)return{start:b,end:b};var S=n.findMatchingTag(d,p)||n.findEnclosingTag(d,p);return!S||!S.open||!S.close?{start:b,end:b}:g?{start:S.open.from,end:S.close.to}:{start:S.open.to,end:S.close.from}}function _s(d,p,g){Sn(p,g)||q.jumpList.add(d,p,g)}function Cn(d,p){q.lastCharacterSearch.increment=d,q.lastCharacterSearch.forward=p.forward,q.lastCharacterSearch.selectedCharacter=p.selectedCharacter}var Pn={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},bs={bracket:{isComplete:function(d){if(d.nextCh===d.symb){if(d.depth++,d.depth>=1)return!0}else d.nextCh===d.reverseSymb&&d.depth--;return!1}},section:{init:function(d){d.curMoveThrough=!0,d.symb=(d.forward?"]":"[")===d.symb?"{":"}"},isComplete:function(d){return d.index===0&&d.nextCh===d.symb}},comment:{isComplete:function(d){var p=d.lastCh==="*"&&d.nextCh==="/";return d.lastCh=d.nextCh,p}},method:{init:function(d){d.symb=d.symb==="m"?"{":"}",d.reverseSymb=d.symb==="{"?"}":"{"},isComplete:function(d){return d.nextCh===d.symb}},preprocess:{init:function(d){d.index=0},isComplete:function(d){var g;if(d.nextCh==="#"){var p=(g=d.lineText.match(/^#(\w+)/))==null?void 0:g[1];if(p==="endif"){if(d.forward&&d.depth===0)return!0;d.depth++}else if(p==="if"){if(!d.forward&&d.depth===0)return!0;d.depth--}if(p==="else"&&d.depth===0)return!0}return!1}}};function ls(d,p,g,b){var S=Dt(d.getCursor()),C=g?1:-1,N=g?d.lineCount():-1,L=S.ch,V=S.line,z=d.getLine(V),G={lineText:z,nextCh:z.charAt(L),lastCh:null,index:L,symb:b,reverseSymb:(g?{")":"(","}":"{"}:{"(":")","{":"}"})[b],forward:g,depth:0,curMoveThrough:!1},ie=Pn[b];if(!ie)return S;var le=bs[ie].init,se=bs[ie].isComplete;for(le&&le(G);V!==N&&p;){if(G.index+=C,G.nextCh=G.lineText.charAt(G.index),!G.nextCh){if(V+=C,G.lineText=d.getLine(V)||"",C>0)G.index=0;else{var K=G.lineText.length;G.index=K>0?K-1:0}G.nextCh=G.lineText.charAt(G.index)}se(G)&&(S.line=V,S.ch=G.index,p--)}return G.nextCh||G.curMoveThrough?new e(V,G.index):S}function Fa(d,p,g,b,S){var C=p.line,N=p.ch,L=d.getLine(C),V=g?1:-1,z=b?f:m;if(S&&L==""){if(C+=V,L=d.getLine(C),!E(d,C))return null;N=g?0:L.length}for(;;){if(S&&L=="")return{from:0,to:0,line:C};for(var G=V>0?L.length:-1,ie=G,le=G;N!=G;){for(var se=!1,K=0;K<z.length&&!se;++K)if(z[K](L.charAt(N))){for(ie=N;N!=G&&z[K](L.charAt(N));)N+=V;if(le=N,se=ie!=le,ie==p.ch&&C==p.line&&le==ie+V)continue;return{from:Math.min(ie,le+1),to:Math.max(ie,le),line:C}}se||(N+=V)}if(C+=V,!E(d,C))return null;L=d.getLine(C),N=V>0?0:L.length}}function $r(d,p,g,b,S,C){var N=Dt(p),L=[];(b&&!S||!b&&S)&&g++;for(var V=!(b&&S),z=0;z<g;z++){var G=Fa(d,p,b,C,V);if(!G){var ie=ln(d,d.lastLine());L.push(b?{line:d.lastLine(),from:ie,to:ie}:{line:0,from:0,to:0});break}L.push(G),p=new e(G.line,b?G.to-1:G.from)}var le=L.length!=g,se=L[0],K=L.pop();return b&&!S?(!le&&(se.from!=N.ch||se.line!=N.line)&&(K=L.pop()),K&&new e(K.line,K.from)):b&&S?K&&new e(K.line,K.to-1):!b&&S?(!le&&(se.to!=N.ch||se.line!=N.line)&&(K=L.pop()),K&&new e(K.line,K.to)):K&&new e(K.line,K.from)}function Rr(d,p,g,b,S){var C=p,N=new e(C.line+g.repeat-1,1/0),L=d.clipPos(N);return L.ch--,S||(b.lastHPos=1/0,b.lastHSPos=d.charCoords(L,"div").left),N}function Na(d,p,g,b,S){if(b){for(var C=S||d.getCursor(),N=C.ch,L,V=0;V<p;V++){var z=d.getLine(C.line);if(L=oc(N,z,b,g),L==-1)return;N=L}if(L!=null)return new e(d.getCursor().line,L)}}function rc(d,p){var g=d.getCursor().line;return tt(d,new e(g,p-1))}function Ls(d,p,g,b){!ce(g,v)&&!k.test(g)||(p.marks[g]&&p.marks[g].clear(),p.marks[g]=d.setBookmark(b))}function oc(d,p,g,b,S){var C;return b?C=p.indexOf(g,d+1):C=p.lastIndexOf(g,d-1),C}function vo(d,p,g,b,S){var C=p.line,N=d.firstLine(),L=d.lastLine(),V,z,G=C;function ie(xe){return!d.getLine(xe)}function le(xe,$e,Pe){return Pe?ie(xe)!=ie(xe+$e):!ie(xe)&&ie(xe+$e)}if(b){for(;N<=G&&G<=L&&g>0;)le(G,b)&&g--,G+=b;return{start:new e(G,0),end:p}}var se=d.state.vim;if(se.visualLine&&le(C,1,!0)){var K=se.sel.anchor;le(K.line,-1,!0)&&(!S||K.line!=C)&&(C+=1)}var ve=ie(C);for(G=C;G<=L&&g;G++)le(G,1,!0)&&(!S||ie(G)!=ve)&&g--;for(z=new e(G,0),G>L&&!ve?ve=!0:S=!1,G=C;G>N&&!((!S||ie(G)==ve||G==C)&&le(G,-1,!0));G--);return V=new e(G,0),{start:V,end:z}}function er(d,p,g,b,S){function C(z){z.line!==null&&(z.pos+z.dir<0||z.pos+z.dir>=z.line.length?z.line=null:z.pos+=z.dir)}function N(z,G,ie,le){var se=z.getLine(G),K={line:se,ln:G,pos:ie,dir:le};if(K.line==="")return{ln:K.ln,pos:K.pos};var ve=K.pos;for(C(K);K.line!==null;){if(ve=K.pos,Z(K.line[K.pos]))if(S){for(C(K);K.line!==null&&$(K.line[K.pos]);)ve=K.pos,C(K);return{ln:K.ln,pos:ve+1}}else return{ln:K.ln,pos:K.pos+1};C(K)}return{ln:K.ln,pos:ve+1}}function L(z,G,ie,le){var se=z.getLine(G),K={line:se,ln:G,pos:ie,dir:le};if(K.line==="")return{ln:K.ln,pos:K.pos};var ve=K.pos;for(C(K);K.line!==null;){if(!$(K.line[K.pos])&&!Z(K.line[K.pos]))ve=K.pos;else if(Z(K.line[K.pos]))return S?$(K.line[K.pos+1])?{ln:K.ln,pos:K.pos+1}:{ln:K.ln,pos:ve}:{ln:K.ln,pos:ve};C(K)}return K.line=se,S&&$(K.line[K.pos])?{ln:K.ln,pos:K.pos}:{ln:K.ln,pos:ve}}for(var V={ln:p.line,pos:p.ch};g>0;)b<0?V=L(d,V.ln,V.pos,b):V=N(d,V.ln,V.pos,b),g--;return new e(V.ln,V.pos)}function ic(d,p,g,b){function S(V,z){if(z.line!==null)if(z.pos+z.dir<0||z.pos+z.dir>=z.line.length){if(z.ln+=z.dir,!E(V,z.ln)){z.line=null;return}z.line=V.getLine(z.ln),z.pos=z.dir>0?0:z.line.length-1}else z.pos+=z.dir}function C(V,z,G,ie){var xe=V.getLine(z),le=xe==="",se={line:xe,ln:z,pos:G,dir:ie},K={ln:se.ln,pos:se.pos},ve=se.line==="";for(S(V,se);se.line!==null;){if(K.ln=se.ln,K.pos=se.pos,se.line===""&&!ve)return{ln:se.ln,pos:se.pos};if(le&&se.line!==""&&!$(se.line[se.pos]))return{ln:se.ln,pos:se.pos};Z(se.line[se.pos])&&!le&&(se.pos===se.line.length-1||$(se.line[se.pos+1]))&&(le=!0),S(V,se)}var xe=V.getLine(K.ln);K.pos=0;for(var $e=xe.length-1;$e>=0;--$e)if(!$(xe[$e])){K.pos=$e;break}return K}function N(V,z,G,ie){var xe=V.getLine(z),le={line:xe,ln:z,pos:G,dir:ie},se=le.ln,K=null,ve=le.line==="";for(S(V,le);le.line!==null;){if(le.line===""&&!ve)return K!==null?{ln:se,pos:K}:{ln:le.ln,pos:le.pos};if(Z(le.line[le.pos])&&K!==null&&!(le.ln===se&&le.pos+1===K))return{ln:se,pos:K};le.line!==""&&!$(le.line[le.pos])&&(ve=!1,se=le.ln,K=le.pos),S(V,le)}var xe=V.getLine(se);K=0;for(var $e=0;$e<xe.length;++$e)if(!$(xe[$e])){K=$e;break}return{ln:se,pos:K}}for(var L={ln:p.line,pos:p.ch};g>0;)b<0?L=N(d,L.ln,L.pos,b):L=C(d,L.ln,L.pos,b),g--;return new e(L.ln,L.pos)}function wo(d,p,g,b){var S=p,C={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[g],N={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"}[g],L=d.getLine(S.line).charAt(S.ch),V=L===N?1:0,z=d.scanForBracket(new e(S.line,S.ch+V),-1,void 0,{bracketRegex:C}),G=d.scanForBracket(new e(S.line,S.ch+V),1,void 0,{bracketRegex:C});if(!z||!G)return null;var ie=z.pos,le=G.pos;if(ie.line==le.line&&ie.ch>le.ch||ie.line>le.line){var se=ie;ie=le,le=se}return b?le.ch+=1:ie.ch+=1,{start:ie,end:le}}function Zo(d,p,g,b){var S=Dt(p),C=d.getLine(S.line),N=C.split(""),L,V,z,G,ie=N.indexOf(g);if(S.ch<ie)S.ch=ie;else if(ie<S.ch&&N[S.ch]==g){var le=/string/.test(d.getTokenTypeAt(mt(p,0,1))),se=/string/.test(d.getTokenTypeAt(p)),K=le&&!se;K||(V=S.ch,--S.ch)}if(N[S.ch]==g&&!V)L=S.ch+1;else for(z=S.ch;z>-1&&!L;z--)N[z]==g&&(L=z+1);if(L&&!V)for(z=L,G=N.length;z<G&&!V;z++)N[z]==g&&(V=z);return!L||!V?{start:S,end:S}:(b&&(--L,++V),{start:new e(S.line,L),end:new e(S.line,V)})}ue("pcre",!0,"boolean");class _r{constructor(){this.highlightTimeout}getQuery(){return q.query}setQuery(p){q.query=p}getOverlay(){return this.searchOverlay}setOverlay(p){this.searchOverlay=p}isReversed(){return q.isReversed}setReversed(p){q.isReversed=p}getScrollbarAnnotate(){return this.annotate}setScrollbarAnnotate(p){this.annotate=p}}function Yn(d){var p=d.state.vim;return p.searchState_||(p.searchState_=new _r)}function oa(d){return br(d,"/")}function Lr(d){return tr(d,"/")}function br(d,p){var g=tr(d,p)||[];if(!g.length)return[];var b=[];if(g[0]===0){for(var S=0;S<g.length;S++)typeof g[S]=="number"&&b.push(d.substring(g[S]+1,g[S+1]));return b}}function tr(d,p){p||(p="/");for(var g=!1,b=[],S=0;S<d.length;S++){var C=d.charAt(S);!g&&C==p&&b.push(S),g=!g&&C=="\\"}return b}function Ir(d){var p={V:"|(){+?*.[$^",M:"|(){+?*.[",m:"|(){+?",v:"<>"},g={">":"(?<=[\\w])(?=[^\\w]|$)","<":"(?<=[^\\w]|^)(?=[\\w])"},b=p.m,S=d.replace(/\\.|[\[|(){+*?.$^<>]/g,function(N){if(N[0]==="\\"){var L=N[1];return L==="}"||b.indexOf(L)!=-1?L:L in p?(b=p[L],""):L in g?g[L]:N}else return b.indexOf(N)!=-1?g[N]||"\\"+N:N}),C=S.indexOf("\\zs");return C!=-1&&(S="(?<="+S.slice(0,C)+")"+S.slice(C+3)),C=S.indexOf("\\ze"),C!=-1&&(S=S.slice(0,C)+"(?="+S.slice(C+3)+")"),S}var nr={"\\n":`
`,"\\r":"\r","\\t":"	"};function lc(d){for(var p=!1,g=[],b=-1;b<d.length;b++){var S=d.charAt(b)||"",C=d.charAt(b+1)||"";nr[S+C]?(g.push(nr[S+C]),b++):p?(g.push(S),p=!1):S==="\\"?(p=!0,F(C)||C==="$"?g.push("$"):C!=="/"&&C!=="\\"&&g.push("\\")):(S==="$"&&g.push("$"),g.push(S),C==="/"&&g.push("\\"))}return g.join("")}var Ba={"\\/":"/","\\\\":"\\","\\n":`
`,"\\r":"\r","\\t":"	","\\&":"&"};function zo(d){for(var p=new n.StringStream(d),g=[];!p.eol();){for(;p.peek()&&p.peek()!="\\";)g.push(p.next());var b=!1;for(var S in Ba)if(p.match(S,!0)){b=!0,g.push(Ba[S]);break}b||g.push(p.next())}return g.join("")}function Oo(d,p,g){var b=q.registerController.getRegister("/");b.setText(d);var S=Lr(d),C,N;if(!S.length)C=d;else{C=d.substring(0,S[0]);var L=d.substring(S[0]);N=L.indexOf("i")!=-1}if(!C)return null;de("pcre")||(C=Ir(C)),g&&(p=/^[^A-Z]*$/.test(C));var V=new RegExp(C,p||N?"im":"m");return V}function ys(d){typeof d=="string"&&(d=document.createElement(d));for(var p=1;p<arguments.length;p++){var g=arguments[p];if(g)if(typeof g!="object"&&(g=document.createTextNode(g)),g.nodeType)d.appendChild(g);else for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(b[0]==="$"?d.style[b.slice(1)]=g[b]:typeof g[b]=="function"?d[b]=g[b]:d.setAttribute(b,g[b]))}return d}function Ct(d,p,g){var b=ys("div",{$color:"red",$whiteSpace:"pre",class:"cm-vim-message"},p);d.openNotification?g?(b=ys("div",{},b,ys("div",{},"Press ENTER or type command to continue")),d.state.closeVimNotification&&d.state.closeVimNotification(),d.state.closeVimNotification=d.openNotification(b,{bottom:!0,duration:0})):d.openNotification(b,{bottom:!0,duration:15e3}):alert(b.innerText)}function Ai(d,p){return ys("div",{$display:"flex",$flex:1},ys("span",{$fontFamily:"monospace",$whiteSpace:"pre",$flex:1,$display:"flex"},d,ys("input",{type:"text",autocorrect:"off",autocapitalize:"off",spellcheck:"false",$flex:1})),p&&ys("span",{$color:"#888"},p))}function yr(d,p){var S;if(Ye.length){p.value||(p.value=""),_e=p;return}var g=Ai(p.prefix,p.desc);if(d.openDialog)d.openDialog(g,p.onClose,{onKeyDown:p.onKeyDown,onKeyUp:p.onKeyUp,bottom:!0,selectValueOnOpen:!1,value:p.value});else{var b="";typeof p.prefix!="string"&&p.prefix&&(b+=p.prefix.textContent),p.desc&&(b+=" "+p.desc),(S=p.onClose)==null||S.call(p,prompt(b,""))}}function cc(d,p){return d instanceof RegExp&&p instanceof RegExp?d.flags==p.flags&&d.source==p.source:!1}function $a(d,p,g,b){if(p){var S=Yn(d),C=Oo(p,!!g,!!b);if(C)return Y(d,C),cc(C,S.getQuery())||S.setQuery(C),C}}function hl(d){if(d.source.charAt(0)=="^")var p=!0;return{token:function(g){if(p&&!g.sol()){g.skipToEnd();return}var b=g.match(d,!1);if(b)return b[0].length==0?(g.next(),"searching"):!g.sol()&&(g.backUp(1),!d.exec(g.next()+b[0]))?(g.next(),null):(g.match(d),"searching");for(;!g.eol()&&(g.next(),!g.match(d,!1)););},query:d}}var Ra=0;function Y(d,p){clearTimeout(Ra);var g=Yn(d);g.highlightTimeout=Ra,Ra=setTimeout(function(){if(d.state.vim){var b=Yn(d);b.highlightTimeout=void 0;var S=b.getOverlay();(!S||p!=S.query)&&(S&&d.removeOverlay(S),S=hl(p),d.addOverlay(S),d.showMatchesOnScrollbar&&(b.getScrollbarAnnotate()&&b.getScrollbarAnnotate().clear(),b.setScrollbarAnnotate(d.showMatchesOnScrollbar(p))),b.setOverlay(S))}},50)}function J(d,p,g,b){return d.operation(function(){b===void 0&&(b=1);for(var S=d.getCursor(),C=d.getSearchCursor(g,S),N=0;N<b;N++){var L=C.find(p);if(N==0&&L&&Sn(C.from(),S)){var V=p?C.from():C.to();L=C.find(p),L&&!L[0]&&Sn(C.from(),V)&&d.getLine(V.line).length==V.ch&&(L=C.find(p))}if(!L&&(C=d.getSearchCursor(g,p?new e(d.lastLine()):new e(d.firstLine(),0)),!C.find(p)))return}return C.from()})}function te(d,p,g,b,S){return d.operation(function(){b===void 0&&(b=1);var C=d.getCursor(),N=d.getSearchCursor(g,C),L=N.find(!p);!S.visualMode&&L&&Sn(N.from(),C)&&N.find(!p);for(var V=0;V<b;V++)if(L=N.find(p),!L&&(N=d.getSearchCursor(g,p?new e(d.lastLine()):new e(d.firstLine(),0)),!N.find(p)))return;var z=N.from(),G=N.to();return z&&G&&[z,G]})}function A(d){var p=Yn(d);p.highlightTimeout&&(clearTimeout(p.highlightTimeout),p.highlightTimeout=void 0),d.removeOverlay(Yn(d).getOverlay()),p.setOverlay(null),p.getScrollbarAnnotate()&&(p.getScrollbarAnnotate().clear(),p.setScrollbarAnnotate(null))}function he(d,p,g){return typeof d!="number"&&(d=d.line),p instanceof Array?ce(d,p):typeof g=="number"?d>=p&&d<=g:d==p}function we(d){var p=d.getScrollInfo(),g=6,b=10,S=d.coordsChar({left:0,top:g+p.top},"local"),C=p.clientHeight-b+p.top,N=d.coordsChar({left:0,top:C},"local");return{top:S.line,bottom:N.line}}function Oe(d,p,g){if(g=="'"||g=="`")return q.jumpList.find(d,-1)||new e(0,0);if(g==".")return Se(d);var b=p.marks[g];return b&&b.find()}function Se(d){if(d.getLastEditEnd)return d.getLastEditEnd();for(var p=d.doc.history.done,g=p.length;g--;)if(p[g].changes)return Dt(p[g].changes[0].to)}class fe{constructor(){this.commandMap_,this.buildCommandMap_()}processCommand(p,g,b){var S=this;p.operation(function(){p.curOp&&(p.curOp.isVimOp=!0),S._processCommand(p,g,b)})}_processCommand(p,g,b){var S=p.state.vim,C=q.registerController.getRegister(":"),N=C.toString(),L=new n.StringStream(g);C.setText(g);var V=b||{};V.input=g;try{this.parseInput_(p,L,V)}catch(ie){throw Ct(p,ie+""),ie}S.visualMode&&Be(p);var z,G;if(!V.commandName)V.line!==void 0&&(G="move");else if(z=this.matchCommand_(V.commandName),z){if(G=z.name,z.excludeFromCommandHistory&&C.setText(N),this.parseCommandArgs_(L,V,z),z.type=="exToKey"){pt(p,z.toKeys||"",z);return}else if(z.type=="exToEx"){this.processCommand(p,z.toInput||"");return}}if(!G){Ct(p,'Not an editor command ":'+g+'"');return}try{Te[G](p,V),(!z||!z.possiblyAsync)&&V.callback&&V.callback()}catch(ie){throw Ct(p,ie+""),ie}}parseInput_(p,g,b){var C,N;g.eatWhile(":"),g.eat("%")?(b.line=p.firstLine(),b.lineEnd=p.lastLine()):(b.line=this.parseLineSpec_(p,g),b.line!==void 0&&g.eat(",")&&(b.lineEnd=this.parseLineSpec_(p,g))),b.line==null?p.state.vim.visualMode?(b.selectionLine=(C=Oe(p,p.state.vim,"<"))==null?void 0:C.line,b.selectionLineEnd=(N=Oe(p,p.state.vim,">"))==null?void 0:N.line):b.selectionLine=p.getCursor().line:(b.selectionLine=b.line,b.selectionLineEnd=b.lineEnd);var S=g.match(/^(\w+|!!|@@|[!#&*<=>@~])/);return S?b.commandName=S[1]:b.commandName=(g.match(/.*/)||[""])[0],b}parseLineSpec_(p,g){var b=g.match(/^(\d+)/);if(b)return parseInt(b[1],10)-1;switch(g.next()){case".":return this.parseLineSpecOffset_(g,p.getCursor().line);case"$":return this.parseLineSpecOffset_(g,p.lastLine());case"'":var S=g.next()||"",C=Oe(p,p.state.vim,S);if(!C)throw new Error("Mark not set");return this.parseLineSpecOffset_(g,C.line);case"-":case"+":return g.backUp(1),this.parseLineSpecOffset_(g,p.getCursor().line);default:g.backUp(1);return}}parseLineSpecOffset_(p,g){var b=p.match(/^([+-])?(\d+)/);if(b){var S=parseInt(b[2],10);b[1]=="-"?g-=S:g+=S}return g}parseCommandArgs_(p,g,b){var N;if(!p.eol()){g.argString=(N=p.match(/.*/))==null?void 0:N[0];var S=b.argDelimiter||/\s+/,C=Gs(g.argString||"").split(S);C.length&&C[0]&&(g.args=C)}}matchCommand_(p){for(var g=p.length;g>0;g--){var b=p.substring(0,g);if(this.commandMap_[b]){var S=this.commandMap_[b];if(S.name.indexOf(p)===0)return S}}}buildCommandMap_(){this.commandMap_={};for(var p=0;p<o.length;p++){var g=o[p],b=g.shortName||g.name;this.commandMap_[b]=g}}map(p,g,b,S){if(p!=":"&&p.charAt(0)==":"){if(b)throw Error("Mode not supported for ex mappings");var C=p.substring(1);g!=":"&&g.charAt(0)==":"?this.commandMap_[C]={name:C,type:"exToEx",toInput:g.substring(1),user:!0}:this.commandMap_[C]={name:C,type:"exToKey",toKeys:g,user:!0}}else{var N={keys:p,type:"keyToKey",toKeys:g,noremap:!!S};b&&(N.context=b),ot(N)}}unmap(p,g){if(p!=":"&&p.charAt(0)==":"){if(g)throw Error("Mode not supported for ex mappings");var b=p.substring(1);if(this.commandMap_[b]&&this.commandMap_[b].user)return delete this.commandMap_[b],!0}else for(var S=p,C=0;C<s.length;C++)if(S==s[C].keys&&s[C].context===g)return s.splice(C,1),Je(S),!0}}var Te={colorscheme:function(d,p){if(!p.args||p.args.length<1){Ct(d,d.getOption("theme"));return}d.setOption("theme",p.args[0])},map:function(d,p,g,b){var S=p.args;if(!S||S.length<2){d&&Ct(d,"Invalid mapping: "+p.input);return}Qe.map(S[0],S[1],g,b)},imap:function(d,p){this.map(d,p,"insert")},nmap:function(d,p){this.map(d,p,"normal")},vmap:function(d,p){this.map(d,p,"visual")},omap:function(d,p){this.map(d,p,"operatorPending")},noremap:function(d,p){this.map(d,p,void 0,!0)},inoremap:function(d,p){this.map(d,p,"insert",!0)},nnoremap:function(d,p){this.map(d,p,"normal",!0)},vnoremap:function(d,p){this.map(d,p,"visual",!0)},onoremap:function(d,p){this.map(d,p,"operatorPending",!0)},unmap:function(d,p,g){var b=p.args;(!b||b.length<1||!Qe.unmap(b[0],g))&&d&&Ct(d,"No such mapping: "+p.input)},mapclear:function(d,p){me.mapclear()},imapclear:function(d,p){me.mapclear("insert")},nmapclear:function(d,p){me.mapclear("normal")},vmapclear:function(d,p){me.mapclear("visual")},omapclear:function(d,p){me.mapclear("operatorPending")},move:function(d,p){nt.processCommand(d,d.state.vim,{keys:"",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:p.line+1})},set:function(d,p){var g=p.args,b=p.setCfg||{};if(!g||g.length<1){d&&Ct(d,"Invalid mapping: "+p.input);return}var S=g[0].split("="),C=S.shift()||"",N=S.length>0?S.join("="):void 0,L=!1,V=!1;if(C.charAt(C.length-1)=="?"){if(N)throw Error("Trailing characters: "+p.argString);C=C.substring(0,C.length-1),L=!0}else C.charAt(C.length-1)=="!"&&(C=C.substring(0,C.length-1),V=!0);N===void 0&&C.substring(0,2)=="no"&&(C=C.substring(2),N=!1);var z=U[C]&&U[C].type=="boolean";if(z&&(V?N=!de(C,d,b):N==null&&(N=!0)),!z&&N===void 0||L){var G=de(C,d,b);G instanceof Error?Ct(d,G.message):G===!0||G===!1?Ct(d," "+(G?"":"no")+C):Ct(d,"  "+C+"="+G)}else{var ie=W(C,N,d,b);ie instanceof Error&&Ct(d,ie.message)}},setlocal:function(d,p){p.setCfg={scope:"local"},this.set(d,p)},setglobal:function(d,p){p.setCfg={scope:"global"},this.set(d,p)},registers:function(d,p){var g=p.args,b=q.registerController.registers,S=`----------Registers----------

`;if(g)for(var L=g.join(""),V=0;V<L.length;V++){var C=L.charAt(V);if(q.registerController.isValidRegister(C)){var z=b[C]||new un;S+='"'+C+"    "+z.toString()+`
`}}else for(var C in b){var N=b[C].toString();N.length&&(S+='"'+C+"    "+N+`
`)}Ct(d,S,!0)},marks:function(d,p){var g=p.args,b=d.state.vim.marks,S=`-----------Marks-----------
mark	line	col

`;if(g)for(var L=g.join(""),V=0;V<L.length;V++){var C=L.charAt(V),N=b[C]&&b[C].find();N&&(S+=C+"	"+N.line+"	"+N.ch+`
`)}else for(var C in b){var N=b[C]&&b[C].find();N&&(S+=C+"	"+N.line+"	"+N.ch+`
`)}Ct(d,S,!0)},sort:function(d,p){var g,b,S,C,N;function L(){if(p.argString){var Ot=new n.StringStream(p.argString);if(Ot.eat("!")&&(g=!0),Ot.eol())return;if(!Ot.eatSpace())return"Invalid arguments";var qe=Ot.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!qe||!Ot.eol())return"Invalid arguments";if(qe[1]){b=qe[1].indexOf("i")!=-1,S=qe[1].indexOf("u")!=-1;var Ut=qe[1].indexOf("d")!=-1||qe[1].indexOf("n")!=-1,Dn=qe[1].indexOf("x")!=-1,nn=qe[1].indexOf("o")!=-1;if(Number(Ut)+Number(Dn)+Number(nn)>1)return"Invalid arguments";C=Ut&&"decimal"||Dn&&"hex"||nn&&"octal"}qe[2]&&(N=new RegExp(qe[2].substr(1,qe[2].length-2),b?"i":""))}}var V=L();if(V){Ct(d,V+": "+p.argString);return}var z=p.line||d.firstLine(),G=p.lineEnd||p.line||d.lastLine();if(z==G)return;var ie=new e(z,0),le=new e(G,ln(d,G)),se=d.getRange(ie,le).split(`
`),K=C=="decimal"?/(-?)([\d]+)/:C=="hex"?/(-?)(?:0x)?([0-9a-f]+)/i:C=="octal"?/([0-7]+)/:null,ve=C=="decimal"?10:C=="hex"?16:C=="octal"?8:void 0,xe=[],$e=[];if(C||N)for(var Pe=0;Pe<se.length;Pe++){var ze=N?se[Pe].match(N):null;ze&&ze[0]!=""?xe.push(ze):K&&K.exec(se[Pe])?xe.push(se[Pe]):$e.push(se[Pe])}else $e=se;function ct(Ot,qe){if(g){var Ut;Ut=Ot,Ot=qe,qe=Ut}b&&(Ot=Ot.toLowerCase(),qe=qe.toLowerCase());var Dn=K&&K.exec(Ot),nn=K&&K.exec(qe);if(!Dn||!nn)return Ot<qe?-1:1;var bn=parseInt((Dn[1]+Dn[2]).toLowerCase(),ve),ps=parseInt((nn[1]+nn[2]).toLowerCase(),ve);return bn-ps}function it(Ot,qe){if(g){var Ut;Ut=Ot,Ot=qe,qe=Ut}return b&&(Ot[0]=Ot[0].toLowerCase(),qe[0]=qe[0].toLowerCase()),Ot[0]<qe[0]?-1:1}if(xe.sort(N?it:ct),N)for(var Pe=0;Pe<xe.length;Pe++)xe[Pe]=xe[Pe].input;else C||$e.sort(ct);if(se=g?xe.concat($e):$e.concat(xe),S){var Rt=se,_t;se=[];for(var Pe=0;Pe<Rt.length;Pe++)Rt[Pe]!=_t&&se.push(Rt[Pe]),_t=Rt[Pe]}d.replaceRange(se.join(`
`),ie,le)},vglobal:function(d,p){this.global(d,p)},normal:function(d,p){var g=!1,b=p.argString;if(b&&b[0]=="!"&&(b=b.slice(1),g=!0),b=b.trimStart(),!b){Ct(d,"Argument is required.");return}var S=p.line;if(typeof S=="number")for(var C=isNaN(p.lineEnd)?S:p.lineEnd,N=S;N<=C;N++)d.setCursor(N,0),pt(d,p.argString.trimStart(),{noremap:g}),d.state.vim.insertMode&&De(d,!0);else pt(d,p.argString.trimStart(),{noremap:g}),d.state.vim.insertMode&&De(d,!0)},global:function(d,p){var g=p.argString;if(!g){Ct(d,"Regular Expression missing from global");return}var b=p.commandName[0]==="v";g[0]==="!"&&p.commandName[0]==="g"&&(b=!0,g=g.slice(1));var S=p.line!==void 0?p.line:d.firstLine(),C=p.lineEnd||p.line||d.lastLine(),N=oa(g),L=g,V="";if(N&&N.length&&(L=N[0],V=N.slice(1,N.length).join("/")),L)try{$a(d,L,!0,!0)}catch{Ct(d,"Invalid regex: "+L);return}for(var z=Yn(d).getQuery(),G=[],ie=S;ie<=C;ie++){var le=d.getLine(ie),se=z.test(le);se!==b&&G.push(V?d.getLineHandle(ie):le)}if(!V){Ct(d,G.join(`
`));return}var K=0,ve=function(){if(K<G.length){var xe=G[K++],$e=d.getLineNumber(xe);if($e==null){ve();return}var Pe=$e+1+V;Qe.processCommand(d,Pe,{callback:ve})}else d.releaseLineHandles&&d.releaseLineHandles()};ve()},substitute:function(d,p){if(!d.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var g=p.argString,b=g?br(g,g[0]):[],S="",C="",N,L,V,z=!1,G=!1;if(b&&b.length)S=b[0],de("pcre")&&S!==""&&(S=new RegExp(S).source),C=b[1],C!==void 0&&(de("pcre")?C=zo(C.replace(/([^\\])&/g,"$1$$&")):C=lc(C),q.lastSubstituteReplacePart=C),N=b[2]?b[2].split(" "):[];else if(g&&g.length){Ct(d,"Substitutions should be of the form :s/pattern/replace/");return}if(N&&(L=N[0],V=parseInt(N[1]),L&&(L.indexOf("c")!=-1&&(z=!0),L.indexOf("g")!=-1&&(G=!0),de("pcre")?S=S+"/"+L:S=S.replace(/\//g,"\\/")+"/"+L)),S)try{$a(d,S,!0,!0)}catch{Ct(d,"Invalid regex: "+S);return}if(C=C||q.lastSubstituteReplacePart,C===void 0){Ct(d,"No previous substitute regular expression");return}var ie=Yn(d),le=ie.getQuery(),se=p.line!==void 0?p.line:d.getCursor().line,K=p.lineEnd||se;se==d.firstLine()&&K==d.lastLine()&&(K=1/0),V&&(se=K,K=se+V-1);var ve=tt(d,new e(se,0)),xe=d.getSearchCursor(le,ve);Ee(d,z,G,se,K,xe,le,C,p.callback)},startinsert:function(d,p){pt(d,p.argString=="!"?"A":"i",{})},redo:n.commands.redo,undo:n.commands.undo,write:function(d){n.commands.save?n.commands.save(d):d.save&&d.save()},nohlsearch:function(d){A(d)},yank:function(d){var p=Dt(d.getCursor()),g=p.line,b=d.getLine(g);q.registerController.pushText("0","yank",b,!0,!0)},delete:function(d,p){var g=p.selectionLine,b=isNaN(p.selectionLineEnd)?g:p.selectionLineEnd;lt.delete(d,{linewise:!0},[{anchor:new e(g,0),head:new e(b+1,0)}])},join:function(d,p){var g=p.selectionLine,b=isNaN(p.selectionLineEnd)?g:p.selectionLineEnd;d.setCursor(new e(g,0)),Le.joinLines(d,{repeat:b-g},d.state.vim)},delmarks:function(d,p){if(!p.argString||!Gs(p.argString)){Ct(d,"Argument required");return}for(var g=d.state.vim,b=new n.StringStream(Gs(p.argString));!b.eol();){b.eatSpace();var S=b.pos;if(!b.match(/[a-zA-Z]/,!1)){Ct(d,"Invalid argument: "+p.argString.substring(S));return}var C=b.next();if(b.match("-",!0)){if(!b.match(/[a-zA-Z]/,!1)){Ct(d,"Invalid argument: "+p.argString.substring(S));return}var N=C,L=b.next();if(N&&L&&I(N)==I(L)){var V=N.charCodeAt(0),z=L.charCodeAt(0);if(V>=z){Ct(d,"Invalid argument: "+p.argString.substring(S));return}for(var G=0;G<=z-V;G++){var ie=String.fromCharCode(V+G);delete g.marks[ie]}}else{Ct(d,"Invalid argument: "+N+"-");return}}else C&&delete g.marks[C]}}},Qe=new fe;me.defineEx("version","ve",d=>{Ct(d,"Codemirror-vim version: 6.3.0")});function Ee(d,p,g,b,S,C,N,L,V){d.state.vim.exMode=!0;var z=!1,G=0,ie,le,se;function K(){d.operation(function(){for(;!z;)ve(),$e();Pe()})}function ve(){var ct="",it=C.match||C.pos&&C.pos.match;if(it)ct=L.replace(/\$(\d{1,3}|[$&])/g,function(Ot,qe){if(qe=="$")return"$";if(qe=="&")return it[0];for(var Ut=qe;parseInt(Ut)>=it.length&&Ut.length>0;)Ut=Ut.slice(0,Ut.length-1);return Ut?it[Ut]+qe.slice(Ut.length,qe.length):Ot});else{var Rt=d.getRange(C.from(),C.to());ct=Rt.replace(N,L)}var _t=C.to().line;C.replace(ct),le=C.to().line,S+=le-_t,se=le<_t}function xe(){var ct=ie&&Dt(C.to()),it=C.findNext();return it&&!it[0]&&ct&&Sn(C.from(),ct)&&(it=C.findNext()),it&&G++,it}function $e(){for(;xe()&&he(C.from(),b,S);)if(!(!g&&C.from().line==le&&!se)){d.scrollIntoView(C.from(),30),d.setSelection(C.from(),C.to()),ie=C.from(),z=!1;return}z=!0}function Pe(ct){if(ct&&ct(),d.focus(),ie){d.setCursor(ie);var it=d.state.vim;it.exMode=!1,it.lastHPos=it.lastHSPos=ie.ch}V?V():z&&Ct(d,(G?"Found "+G+" matches":"No matches found")+" for pattern: "+N+(de("pcre")?" (set nopcre to use Vim regexps)":""))}function ze(ct,it,Rt){n.e_stop(ct);var _t=xn(ct);switch(_t){case"y":ve(),$e();break;case"n":$e();break;case"a":var Ot=V;V=void 0,d.operation(K),V=Ot;break;case"l":ve();case"q":case"<Esc>":case"<C-c>":case"<C-[>":Pe(Rt);break}return z&&Pe(Rt),!0}if($e(),z){Ct(d,"No matches for "+N+(de("pcre")?" (set nopcre to use vim regexps)":""));return}if(!p){K(),V&&V();return}yr(d,{prefix:ys("span","replace with ",ys("strong",L)," (y/n/a/q/l)"),onKeyDown:ze})}function De(d,p){var g=d.state.vim,b=q.macroModeState,S=q.registerController.getRegister("."),C=b.isPlaying,N=b.lastInsertModeChanges;C||(d.off("change",$t),g.insertEnd&&g.insertEnd.clear(),g.insertEnd=void 0,n.off(d.getInputField(),"keydown",On)),!C&&g.insertModeRepeat&&g.insertModeRepeat>1&&(ms(d,g,g.insertModeRepeat-1,!0),g.lastEditInputState.repeatOverride=g.insertModeRepeat),delete g.insertModeRepeat,g.insertMode=!1,p||d.setCursor(d.getCursor().line,d.getCursor().ch-1),d.setOption("keyMap","vim"),d.setOption("disableInput",!0),d.toggleOverwrite(!1),S.setText(N.changes.join("")),n.signal(d,"vim-mode-change",{mode:"normal"}),b.isRecording&&Ke(b)}function ot(d){s.unshift(d),d.keys&&st(d.keys)}function st(d){d.split(/(<(?:[CSMA]-)*\w+>|.)/i).forEach(function(p){p&&(a[p]||(a[p]=0),a[p]++)})}function Je(d){d.split(/(<(?:[CSMA]-)*\w+>|.)/i).forEach(function(p){a[p]&&a[p]--})}function We(d,p,g,b,S){var C={keys:d,type:p};C[p]=g,C[p+"Args"]=b;for(var N in S)C[N]=S[N];ot(C)}ue("insertModeEscKeysTimeout",200,"number");function et(d,p,g,b){var S=q.registerController.getRegister(b);if(b==":"){S.keyBuffer[0]&&Qe.processCommand(d,S.keyBuffer[0]),g.isPlaying=!1;return}var C=S.keyBuffer,N=0;g.isPlaying=!0,g.replaySearchQueries=S.searchQueries.slice(0);for(var L=0;L<C.length;L++)for(var V=C[L],z,G,ie=/<(?:[CSMA]-)*\w+>|./gi;z=ie.exec(V);)if(G=z[0],me.handleKey(d,G,"macro"),p.insertMode){var le=S.insertModeChanges[N++].changes;q.macroModeState.lastInsertModeChanges.changes=le,Jt(d,le,1),De(d)}g.isPlaying=!1}function Me(d,p){if(!d.isPlaying){var g=d.latestRegister,b=q.registerController.getRegister(g);b&&b.pushText(p)}}function Ke(d){if(!d.isPlaying){var p=d.latestRegister,g=q.registerController.getRegister(p);g&&g.pushInsertModeChanges&&g.pushInsertModeChanges(d.lastInsertModeChanges)}}function Yt(d,p){if(!d.isPlaying){var g=d.latestRegister,b=q.registerController.getRegister(g);b&&b.pushSearchQuery&&b.pushSearchQuery(p)}}function $t(d,p){var g=q.macroModeState,b=g.lastInsertModeChanges;if(!g.isPlaying)for(var S=d.state.vim;p;){if(b.expectCursorActivityForChange=!0,b.ignoreCount>1)b.ignoreCount--;else if(p.origin=="+input"||p.origin=="paste"||p.origin===void 0){var C=d.listSelections().length;C>1&&(b.ignoreCount=C);var N=p.text.join(`
`);if(b.maybeReset&&(b.changes=[],b.maybeReset=!1),N)if(d.state.overwrite&&!/\n/.test(N))b.changes.push([N]);else{if(N.length>1){var L=S&&S.insertEnd&&S.insertEnd.find(),V=d.getCursor();if(L&&L.line==V.line){var z=L.ch-V.ch;z>0&&z<N.length&&(b.changes.push([N,z]),N="")}}N&&b.changes.push(N)}}p=p.next}}function dn(d){var S;var p=d.state.vim;if(p.insertMode){var g=q.macroModeState;if(g.isPlaying)return;var b=g.lastInsertModeChanges;b.expectCursorActivityForChange?b.expectCursorActivityForChange=!1:(b.maybeReset=!0,p.insertEnd&&p.insertEnd.clear(),p.insertEnd=d.setBookmark(d.getCursor(),{insertLeft:!0}))}else(S=d.curOp)!=null&&S.isVimOp||Rn(d,p)}function Rn(d,p){var g=d.getCursor("anchor"),b=d.getCursor("head");if(p.visualMode&&!d.somethingSelected()?Be(d,!1):!p.visualMode&&!p.insertMode&&d.somethingSelected()&&(p.visualMode=!0,p.visualLine=!1,n.signal(d,"vim-mode-change",{mode:"visual"})),p.visualMode){var S=He(b,g)?0:-1,C=He(b,g)?-1:0;b=mt(b,0,S),g=mt(g,0,C),p.sel={anchor:g,head:b},Ls(d,p,"<",Tt(b,g)),Ls(d,p,">",kn(b,g))}else p.insertMode||(p.lastHPos=d.getCursor().ch)}function On(d){var p=q.macroModeState,g=p.lastInsertModeChanges,b=n.keyName?n.keyName(d):d.key;b&&(b.indexOf("Delete")!=-1||b.indexOf("Backspace")!=-1)&&(g.maybeReset&&(g.changes=[],g.maybeReset=!1),g.changes.push(new Re(b,d)))}function ms(d,p,g,b){var S=q.macroModeState;S.isPlaying=!0;var C=p.lastEditActionCommand,N=p.inputState;function L(){C?nt.processAction(d,p,C):nt.evalInput(d,p)}function V(G){if(S.lastInsertModeChanges.changes.length>0){G=p.lastEditActionCommand?G:1;var ie=S.lastInsertModeChanges;Jt(d,ie.changes,G)}}if(p.inputState=p.lastEditInputState,C&&C.interlaceInsertRepeat)for(var z=0;z<g;z++)L(),V(1);else b||L(),V(g);p.inputState=N,p.insertMode&&!b&&De(d),S.isPlaying=!1}function Ps(d,p){n.lookupKey(p,"vim-insert",function(b){return typeof b=="string"?n.commands[b](d):b(d),!0})}function Jt(d,p,g){var b=d.getCursor("head"),S=q.macroModeState.lastInsertModeChanges.visualBlock;S&&(T(d,b,S+1),g=d.listSelections().length,d.setCursor(b));for(var C=0;C<g;C++){S&&d.setCursor(mt(b,C,0));for(var N=0;N<p.length;N++){var L=p[N];if(L instanceof Re)Ps(d,L.keyName);else if(typeof L=="string")d.replaceSelection(L);else{var V=d.getCursor(),z=mt(V,0,L[0].length-(L[1]||0));d.replaceRange(L[0],V,L[1]?V:z),d.setCursor(z)}}}S&&d.setCursor(mt(b,0,1))}function pn(d){var p=new d.constructor;return Object.keys(d).forEach(function(g){if(g!="insertEnd"){var b=d[g];Array.isArray(b)?b=b.slice():b&&typeof b=="object"&&b.constructor!=Object&&(b=pn(b)),p[g]=b}}),d.sel&&(p.sel={head:d.sel.head&&Dt(d.sel.head),anchor:d.sel.anchor&&Dt(d.sel.anchor)}),p}function zt(d,p,g){var C=Ae(d),b=d,S=!1,C=me.maybeInitVimState_(b),N=C.visualBlock||C.wasInVisualBlock;if(b.state.closeVimNotification){var L=b.state.closeVimNotification;if(b.state.closeVimNotification=null,L(),p=="<CR>")return jt(b),!0}var V=b.isInMultiSelectMode();if(C.wasInVisualBlock&&!V?C.wasInVisualBlock=!1:V&&C.visualBlock&&(C.wasInVisualBlock=!0),p=="<Esc>"&&!C.insertMode&&!C.visualMode&&V&&C.status=="<Esc>")jt(b);else if(N||!V||b.inVirtualSelectionMode)S=me.handleKey(b,p,g);else{var z=pn(C),G=C.inputState.changeQueueList||[];b.operation(function(){var le;b.curOp&&(b.curOp.isVimOp=!0);var ie=0;b.forEachSelection(function(){b.state.vim.inputState.changeQueue=G[ie];var se=b.getCursor("head"),K=b.getCursor("anchor"),ve=He(se,K)?0:-1,xe=He(se,K)?-1:0;se=mt(se,0,ve),K=mt(K,0,xe),b.state.vim.sel.head=se,b.state.vim.sel.anchor=K,S=me.handleKey(b,p,g),b.virtualSelection&&(G[ie]=b.state.vim.inputState.changeQueue,b.state.vim=pn(z)),ie++}),(le=b.curOp)!=null&&le.cursorActivity&&!S&&(b.curOp.cursorActivity=!1),b.state.vim=C,C.inputState.changeQueueList=G,C.inputState.changeQueue=null},!0)}return S&&!C.visualMode&&!C.insertMode&&C.visualMode!=b.somethingSelected()&&Rn(b,C),S}return Ne(),me}function Co(n,e){var t=e.ch,s=e.line+1;s<1&&(s=1,t=0),s>n.lines&&(s=n.lines,t=Number.MAX_VALUE);var a=n.line(s);return Math.min(a.from+Math.max(0,t),a.to)}function Yo(n,e){let t=n.lineAt(e);return{line:t.number-1,ch:e-t.from}}class wl{constructor(e,t){this.line=e,this.ch=t}}function $R(n,e,t){if(n.addEventListener)n.addEventListener(e,t,!1);else{var s=n._handlers||(n._handlers={});s[e]=(s[e]||[]).concat(t)}}function RR(n,e,t){if(n.removeEventListener)n.removeEventListener(e,t,!1);else{var s=n._handlers,a=s&&s[e];if(a){var r=a.indexOf(t);r>-1&&(s[e]=a.slice(0,r).concat(a.slice(r+1)))}}}function _R(n,e,...t){var s,a=(s=n._handlers)===null||s===void 0?void 0:s[e];if(a)for(var r=0;r<a.length;++r)a[r](...t)}function N7(n,...e){if(n)for(var t=0;t<n.length;++t)n[t](...e)}let C2;try{C2=new RegExp("[\\w\\p{Alphabetic}\\p{Number}_]","u")}catch{C2=/[\w]/}function ef(n,e){var t=n.cm6;if(!t.state.readOnly){var s="input.type.compose";if(n.curOp&&(n.curOp.lastChange||(s="input.type.compose.start")),e.annotations)try{e.annotations.some(function(a){a.value=="input"&&(a.value=s)})}catch(a){console.error(a)}else e.userEvent=s;return t.dispatch(e)}}function B7(n,e){var t;n.curOp&&(n.curOp.$changeStart=void 0),(e?nw:cm)(n.cm6);let s=(t=n.curOp)===null||t===void 0?void 0:t.$changeStart;s!=null&&n.cm6.dispatch({selection:{anchor:s}})}var Cme={Left:n=>sh(n.cm6,{key:"Left"},"editor"),Right:n=>sh(n.cm6,{key:"Right"},"editor"),Up:n=>sh(n.cm6,{key:"Up"},"editor"),Down:n=>sh(n.cm6,{key:"Down"},"editor"),Backspace:n=>sh(n.cm6,{key:"Backspace"},"editor"),Delete:n=>sh(n.cm6,{key:"Delete"},"editor")};class Nn{openDialog(e,t,s){return Ame(this,e,t,s)}openNotification(e,t){return Mme(this,e,t)}constructor(e){this.state={},this.marks=Object.create(null),this.$mid=0,this.options={},this._handlers={},this.$lastChangeEndOffset=0,this.virtualSelection=null,this.cm6=e,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this)}on(e,t){$R(this,e,t)}off(e,t){RR(this,e,t)}signal(e,t,s){_R(this,e,t,s)}indexFromPos(e){return Co(this.cm6.state.doc,e)}posFromIndex(e){return Yo(this.cm6.state.doc,e)}foldCode(e){let t=this.cm6,s=t.state.selection.ranges,a=this.cm6.state.doc,r=Co(a,e),o=Ve.create([Ve.range(r,r)],0).ranges;t.state.selection.ranges=o,BM(t),t.state.selection.ranges=s}firstLine(){return 0}lastLine(){return this.cm6.state.doc.lines-1}lineCount(){return this.cm6.state.doc.lines}setCursor(e,t){typeof e=="object"&&(t=e.ch,e=e.line);var s=Co(this.cm6.state.doc,{line:e,ch:t||0});this.cm6.dispatch({selection:{anchor:s}},{scrollIntoView:!this.curOp}),this.curOp&&!this.curOp.isVimOp&&this.onBeforeEndOperation()}getCursor(e){var t=this.cm6.state.selection.main,s=e=="head"||!e?t.head:e=="anchor"?t.anchor:e=="start"?t.from:e=="end"?t.to:null;if(s==null)throw new Error("Invalid cursor type");return this.posFromIndex(s)}listSelections(){var e=this.cm6.state.doc;return this.cm6.state.selection.ranges.map(t=>({anchor:Yo(e,t.anchor),head:Yo(e,t.head)}))}setSelections(e,t){var s=this.cm6.state.doc,a=e.map(r=>{var o=Co(s,r.head),i=Co(s,r.anchor);return o==i?Ve.cursor(o,1):Ve.range(i,o)});this.cm6.dispatch({selection:Ve.create(a,t)})}setSelection(e,t,s){this.setSelections([{anchor:e,head:t}],0),s&&s.origin=="*mouse"&&this.onBeforeEndOperation()}getLine(e){var t=this.cm6.state.doc;return e<0||e>=t.lines?"":this.cm6.state.doc.line(e+1).text}getLineHandle(e){return this.$lineHandleChanges||(this.$lineHandleChanges=[]),{row:e,index:this.indexFromPos(new wl(e,0))}}getLineNumber(e){var t=this.$lineHandleChanges;if(!t)return null;for(var s=e.index,a=0;a<t.length;a++)if(s=t[a].changes.mapPos(s,1,fa.TrackAfter),s==null)return null;var r=this.posFromIndex(s);return r.ch==0?r.line:null}releaseLineHandles(){this.$lineHandleChanges=void 0}getRange(e,t){var s=this.cm6.state.doc;return this.cm6.state.sliceDoc(Co(s,e),Co(s,t))}replaceRange(e,t,s,a){s||(s=t);var r=this.cm6.state.doc,o=Co(r,t),i=Co(r,s);ef(this,{changes:{from:o,to:i,insert:e}})}replaceSelection(e){ef(this,this.cm6.state.replaceSelection(e))}replaceSelections(e){var t=this.cm6.state.selection.ranges,s=t.map((a,r)=>({from:a.from,to:a.to,insert:e[r]||""}));ef(this,{changes:s})}getSelection(){return this.getSelections().join(`
`)}getSelections(){var e=this.cm6;return e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to))}somethingSelected(){return this.cm6.state.selection.ranges.some(e=>!e.empty)}getInputField(){return this.cm6.contentDOM}clipPos(e){var t=this.cm6.state.doc,s=e.ch,a=e.line+1;a<1&&(a=1,s=0),a>t.lines&&(a=t.lines,s=Number.MAX_VALUE);var r=t.line(a);return s=Math.min(Math.max(0,s),r.to-r.from),new wl(a-1,s)}getValue(){return this.cm6.state.doc.toString()}setValue(e){var t=this.cm6;return t.dispatch({changes:{from:0,to:t.state.doc.length,insert:e},selection:Ve.range(0,0)})}focus(){return this.cm6.focus()}blur(){return this.cm6.contentDOM.blur()}defaultTextHeight(){return this.cm6.defaultLineHeight}findMatchingBracket(e,t){var s=this.cm6.state,a=Co(s.doc,e),r=ci(s,a+1,-1);return r&&r.end?{to:Yo(s.doc,r.end.from)}:(r=ci(s,a,1),r&&r.end?{to:Yo(s.doc,r.end.from)}:{to:void 0})}scanForBracket(e,t,s,a){return Tme(this,e,t,s,a)}indentLine(e,t){t?this.indentMore():this.indentLess()}indentMore(){Hf(this.cm6)}indentLess(){Yf(this.cm6)}execCommand(e){if(e=="indentAuto")Nn.commands.indentAuto(this);else if(e=="goLineLeft")ry(this.cm6);else if(e=="goLineRight"){ay(this.cm6);let t=this.cm6.state,s=t.selection.main.head;s<t.doc.length&&t.sliceDoc(s,s+1)!==`
`&&The(this.cm6)}else console.log(e+" is not implemented")}setBookmark(e,t){var s=t!=null&&t.insertLeft?1:-1,a=this.indexFromPos(e),r=new Bme(this,a,s);return r}addOverlay({query:e}){let t=new KM({regexp:!0,search:e.source,caseSensitive:!/i/.test(e.flags)});if(t.valid){t.forVim=!0,this.cm6Query=t;let s=Eu.of(t);return this.cm6.dispatch({effects:s}),t}}removeOverlay(e){if(!this.cm6Query)return;this.cm6Query.forVim=!1;let t=Eu.of(this.cm6Query);this.cm6.dispatch({effects:t})}getSearchCursor(e,t){var s=this,a=null,r=null,o=!1;t.ch==null&&(t.ch=Number.MAX_VALUE);var i=Co(s.cm6.state.doc,t),l=e.source.replace(/(\\.|{(?:\d+(?:,\d*)?|,\d+)})|[{}]/g,function(f,v){return v||"\\"+f});function c(f,v=0,O=f.length){return new YM(f,l,{ignoreCase:e.ignoreCase},v,O)}function u(f){var v=s.cm6.state.doc;if(f>v.length)return null;let O=c(v,f).next();return O.done?null:O.value}var h=1e4;function m(f,v){var O=s.cm6.state.doc;for(let k=1;;k++){let M=Math.max(f,v-k*h),E=c(O,M,v),I=null;for(;!E.next().done;)I=E.value;if(I&&(M==f||I.from>M+10))return I;if(M==f)return null}}return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(f){var v=s.cm6.state.doc;if(f){let O=a?o?a.to-1:a.from:i;a=m(0,O)}else{let O=a?o?a.to+1:a.to:i;a=u(O)}return r=a&&{from:Yo(v,a.from),to:Yo(v,a.to),match:a.match},o=a?a.from==a.to:!1,a&&a.match},from:function(){return r==null?void 0:r.from},to:function(){return r==null?void 0:r.to},replace:function(f){a&&(ef(s,{changes:{from:a.from,to:a.to,insert:f}}),a.to=a.from+f.length,r&&(r.to=Yo(s.cm6.state.doc,a.to)))},get match(){return r&&r.match}}}findPosV(e,t,s,a){let{cm6:r}=this;const o=r.state.doc;let i=s=="page"?r.dom.clientHeight:0;const l=Co(o,e);let c=Ve.cursor(l,1,void 0,a),u=Math.round(Math.abs(t));for(let m=0;m<u;m++)s=="page"?c=r.moveVertically(c,t>0,i):s=="line"&&(c=r.moveVertically(c,t>0));let h=Yo(o,c.head);return(t<0&&c.head==0&&a!=0&&e.line==0&&e.ch!=0||t>0&&c.head==o.length&&h.ch!=a&&e.line==h.line)&&(h.hitSide=!0),h}charCoords(e,t){var s=this.cm6.contentDOM.getBoundingClientRect(),a=Co(this.cm6.state.doc,e),r=this.cm6.coordsAtPos(a),o=-s.top;return{left:((r==null?void 0:r.left)||0)-s.left,top:((r==null?void 0:r.top)||0)+o,bottom:((r==null?void 0:r.bottom)||0)+o}}coordsChar(e,t){var s=this.cm6.contentDOM.getBoundingClientRect(),a=this.cm6.posAtCoords({x:e.left+s.left,y:e.top+s.top})||0;return Yo(this.cm6.state.doc,a)}getScrollInfo(){var e=this.cm6.scrollDOM;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight,width:e.scrollWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}scrollTo(e,t){e!=null&&(this.cm6.scrollDOM.scrollLeft=e),t!=null&&(this.cm6.scrollDOM.scrollTop=t)}scrollIntoView(e,t){if(e){var s=this.indexFromPos(e);this.cm6.dispatch({effects:ut.scrollIntoView(s)})}else this.cm6.dispatch({scrollIntoView:!0,userEvent:"scroll"})}getWrapperElement(){return this.cm6.dom}getMode(){return{name:this.getOption("mode")}}setSize(e,t){this.cm6.dom.style.width=e+4+"px",this.cm6.dom.style.height=t+"px",this.refresh()}refresh(){this.cm6.measure()}destroy(){this.removeOverlay()}getLastEditEnd(){return this.posFromIndex(this.$lastChangeEndOffset)}onChange(e){this.$lineHandleChanges&&this.$lineHandleChanges.push(e);for(let s in this.marks)this.marks[s].update(e.changes);this.virtualSelection&&(this.virtualSelection.ranges=this.virtualSelection.ranges.map(s=>s.map(e.changes)));var t=this.curOp=this.curOp||{};e.changes.iterChanges((s,a,r,o,i)=>{(t.$changeStart==null||t.$changeStart>r)&&(t.$changeStart=r),this.$lastChangeEndOffset=o;var l={text:i.toJSON()};t.lastChange?t.lastChange.next=t.lastChange=l:t.lastChange=t.change=l},!0),t.changeHandlers||(t.changeHandlers=this._handlers.change&&this._handlers.change.slice())}onSelectionChange(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._handlers.cursorActivity&&this._handlers.cursorActivity.slice()),this.curOp.cursorActivity=!0}operation(e,t){this.curOp||(this.curOp={$d:0}),this.curOp.$d++;try{var s=e()}finally{this.curOp&&(this.curOp.$d--,this.curOp.$d||this.onBeforeEndOperation())}return s}onBeforeEndOperation(){var e=this.curOp,t=!1;e&&(e.change&&N7(e.changeHandlers,this,e.change),e&&e.cursorActivity&&(N7(e.cursorActivityHandlers,this,null),e.isVimOp&&(t=!0)),this.curOp=null),t&&this.scrollIntoView()}moveH(e,t){if(t=="char"){var s=this.getCursor();this.setCursor(s.line,s.ch+e)}}setOption(e,t){switch(e){case"keyMap":this.state.keyMap=t;break;case"textwidth":this.state.textwidth=t;break}}getOption(e){switch(e){case"firstLineNumber":return 1;case"tabSize":return this.cm6.state.tabSize||4;case"readOnly":return this.cm6.state.readOnly;case"indentWithTabs":return this.cm6.state.facet(lm)=="	";case"indentUnit":return this.cm6.state.facet(lm).length||2;case"textwidth":return this.state.textwidth;case"keyMap":return this.state.keyMap||"vim"}}toggleOverwrite(e){this.state.overwrite=e}getTokenTypeAt(e){var t,s=this.indexFromPos(e),a=Q6(this.cm6.state,s),r=a==null?void 0:a.resolve(s),o=((t=r==null?void 0:r.type)===null||t===void 0?void 0:t.name)||"";return/comment/i.test(o)?"comment":/string/i.test(o)?"string":""}overWriteSelection(e){var t=this.cm6.state.doc,s=this.cm6.state.selection,a=s.ranges.map(r=>{if(r.empty){var o=r.to<t.length?t.sliceString(r.from,r.to+1):"";if(o&&!/\n/.test(o))return Ve.range(r.from,r.to+1)}return r});this.cm6.dispatch({selection:Ve.create(a,s.mainIndex)}),this.replaceSelection(e)}isInMultiSelectMode(){return this.cm6.state.selection.ranges.length>1}virtualSelectionMode(){return!!this.virtualSelection}forEachSelection(e){var t=this.cm6.state.selection;this.virtualSelection=Ve.create(t.ranges,t.mainIndex);for(var s=0;s<this.virtualSelection.ranges.length;s++){var a=this.virtualSelection.ranges[s];a&&(this.cm6.dispatch({selection:Ve.create([a])}),e(),this.virtualSelection.ranges[s]=this.cm6.state.selection.ranges[0])}this.cm6.dispatch({selection:this.virtualSelection}),this.virtualSelection=null}hardWrap(e){return $me(this,e)}}Nn.isMac=typeof navigator<"u"&&/Mac/.test(navigator.platform);Nn.Pos=wl;Nn.StringStream=Hce;Nn.commands={cursorCharLeft:function(n){qf(n.cm6)},redo:function(n){B7(n,!1)},undo:function(n){B7(n,!0)},newlineAndIndent:function(n){Uf({state:n.cm6.state,dispatch:e=>ef(n,e)})},indentAuto:function(n){gR(n.cm6)},newlineAndIndentContinueComment:void 0,save:void 0};Nn.isWordChar=function(n){return C2.test(n)};Nn.keys=Cme;Nn.addClass=function(n,e){};Nn.rmClass=function(n,e){};Nn.e_preventDefault=function(n){n.preventDefault()};Nn.e_stop=function(n){var e,t;(e=n==null?void 0:n.stopPropagation)===null||e===void 0||e.call(n),(t=n==null?void 0:n.preventDefault)===null||t===void 0||t.call(n)};Nn.lookupKey=function(e,t,s){var a=Nn.keys[e];!a&&/^Arrow/.test(e)&&(a=Nn.keys[e.slice(5)]),a&&s(a)};Nn.on=$R;Nn.off=RR;Nn.signal=_R;Nn.findMatchingTag=Fme;Nn.findEnclosingTag=Nme;Nn.keyName=void 0;function LR(n,e,t){var s=document.createElement("div");return s.appendChild(e),s}function IR(n,e){n.state.currentNotificationClose&&n.state.currentNotificationClose(),n.state.currentNotificationClose=e}function Mme(n,e,t){IR(n,i);var s=LR(n,e,t&&t.bottom),a=!1,r,o=t&&typeof t.duration<"u"?t.duration:5e3;function i(){a||(a=!0,clearTimeout(r),s.remove(),VR(n,s))}return s.onclick=function(l){l.preventDefault(),i()},QR(n,s),o&&(r=setTimeout(i,o)),i}function QR(n,e){var t=n.state.dialog;n.state.dialog=e,e.style.flex="1",e&&t!==e&&(t&&t.contains(document.activeElement)&&n.focus(),t&&t.parentElement?t.parentElement.replaceChild(e,t):t&&t.remove(),Nn.signal(n,"dialog"))}function VR(n,e){n.state.dialog==e&&(n.state.dialog=null,Nn.signal(n,"dialog"))}function Ame(n,e,t,s){s||(s={}),IR(n,void 0);var a=LR(n,e,s.bottom),r=!1;QR(n,a);function o(l){if(typeof l=="string")i.value=l;else{if(r)return;r=!0,VR(n,a),n.state.dialog||n.focus(),s.onClose&&s.onClose(a)}}var i=a.getElementsByTagName("input")[0];return i&&(s.value&&(i.value=s.value,s.selectValueOnOpen!==!1&&i.select()),s.onInput&&Nn.on(i,"input",function(l){s.onInput(l,i.value,o)}),s.onKeyUp&&Nn.on(i,"keyup",function(l){s.onKeyUp(l,i.value,o)}),Nn.on(i,"keydown",function(l){s&&s.onKeyDown&&s.onKeyDown(l,i.value,o)||(l.keyCode==13&&t&&t(i.value),(l.keyCode==27||s.closeOnEnter!==!1&&l.keyCode==13)&&(i.blur(),Nn.e_stop(l),o()))}),s.closeOnBlur!==!1&&Nn.on(i,"blur",function(){setTimeout(function(){document.activeElement!==i&&o()})}),i.focus()),o}var Eme={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function Dme(n){return n&&n.bracketRegex||/[(){}[\]]/}function Tme(n,e,t,s,a){for(var r=a&&a.maxScanLineLength||1e4,o=a&&a.maxScanLines||1e3,i=[],l=Dme(a),c=t>0?Math.min(e.line+o,n.lastLine()+1):Math.max(n.firstLine()-1,e.line-o),u=e.line;u!=c;u+=t){var h=n.getLine(u);if(h){var m=t>0?0:h.length-1,f=t>0?h.length:-1;if(!(h.length>r))for(u==e.line&&(m=e.ch-(t<0?1:0));m!=f;m+=t){var v=h.charAt(m);if(l.test(v)){var O=Eme[v];if(O&&O.charAt(1)==">"==t>0)i.push(v);else if(i.length)i.pop();else return{pos:new wl(u,m),ch:v}}}}}return u-t==(t>0?n.lastLine():n.firstLine())?!1:null}function Fme(n,e){return null}function Nme(n,e){var t,s,a=n.cm6.state,r=n.indexFromPos(e);if(r<a.doc.length){var o=a.sliceDoc(r,r+1);o=="<"&&r++}for(var i=Q6(a,r),l=(i==null?void 0:i.resolve(r))||null;l;){if(((t=l.firstChild)===null||t===void 0?void 0:t.type.name)=="OpenTag"&&((s=l.lastChild)===null||s===void 0?void 0:s.type.name)=="CloseTag")return{open:$7(a.doc,l.firstChild),close:$7(a.doc,l.lastChild)};l=l.parent}}function $7(n,e){return{from:Yo(n,e.from),to:Yo(n,e.to)}}class Bme{constructor(e,t,s){this.cm=e,this.id=e.$mid++,this.offset=t,this.assoc=s,e.marks[this.id]=this}clear(){delete this.cm.marks[this.id]}find(){return this.offset==null?null:this.cm.posFromIndex(this.offset)}update(e){this.offset!=null&&(this.offset=e.mapPos(this.offset,this.assoc,fa.TrackDel))}}function $me(n,e){for(var t,s=e.column||n.getOption("textwidth")||80,a=e.allowMerge!=!1,r=Math.min(e.from,e.to),o=Math.max(e.from,e.to);r<=o;){var i=n.getLine(r);if(i.length>s){var l=v(i,s,5);if(l){var c=(t=/^\s*/.exec(i))===null||t===void 0?void 0:t[0];n.replaceRange(`
`+c,new wl(r,l.start),new wl(r,l.end))}o++}else if(a&&/\S/.test(i)&&r!=o){var u=n.getLine(r+1);if(u&&/\S/.test(u)){var h=i.replace(/\s+$/,""),m=u.replace(/^\s+/,""),f=h+" "+m,l=v(f,s,5);l&&l.start>h.length||f.length<s?(n.replaceRange(" ",new wl(r,h.length),new wl(r+1,u.length-m.length)),r--,o--):h.length<i.length&&n.replaceRange("",new wl(r,h.length),new wl(r,i.length))}}r++}return r;function v(O,k,M){if(!(O.length<k)){var E=O.slice(0,k),I=O.slice(k),D=/^(?:(\s+)|(\S+)(\s+))/.exec(I),F=/(?:(\s+)|(\s+)(\S+))$/.exec(E),_=0,$=0;if(F&&!F[2]&&(_=k-F[1].length,$=k),D&&!D[2]&&(_||(_=k),$=k+D[1].length),_)return{start:_,end:$};if(F&&F[2]&&F.index>M)return{start:F.index,end:F.index+F[2].length};if(D&&D[2])return _=k+D[2].length,{start:_,end:_+D[3].length}}}}let M2=v6||(function(){let n={cursorBlinkRate:1200};return function(){return n}})();class Rme{constructor(e,t,s,a,r,o,i,l,c,u){this.left=e,this.top=t,this.height=s,this.fontFamily=a,this.fontSize=r,this.fontWeight=o,this.color=i,this.className=l,this.letter=c,this.partial=u}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.height=this.height+"px",e.style.lineHeight=this.height+"px",e.style.fontFamily=this.fontFamily,e.style.fontSize=this.fontSize,e.style.fontWeight=this.fontWeight,e.style.color=this.partial?"transparent":this.color,e.className=this.className,e.textContent=this.letter}eq(e){return this.left==e.left&&this.top==e.top&&this.height==e.height&&this.fontFamily==e.fontFamily&&this.fontSize==e.fontSize&&this.fontWeight==e.fontWeight&&this.color==e.color&&this.className==e.className&&this.letter==e.letter}}class _me{constructor(e,t){this.view=e,this.rangePieces=[],this.cursors=[],this.cm=t,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let t=M2(this.cm.cm6.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=t+"ms"}update(e){(e.selectionSet||e.geometryChanged||e.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),Lme(e)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:e}=this.view,t=[];for(let s of e.selection.ranges){let a=s==e.selection.main,r=jme(this.cm,this.view,s,a);r&&t.push(r)}return{cursors:t}}drawSel({cursors:e}){if(e.length!=this.cursors.length||e.some((t,s)=>!t.eq(this.cursors[s]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const s of e)this.cursorLayer.appendChild(s.draw())}else e.forEach((s,a)=>s.adjust(t[a]));this.cursors=e}}destroy(){this.cursorLayer.remove()}}function Lme(n){return M2(n.startState)!=M2(n.state)}const Ime={".cm-vimMode .cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}},Qme=jo.highest(ut.theme(Ime));function Vme(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Es.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function jme(n,e,t,s){var a,r,o,i;let l=t.head,c=!1,u=1,h=n.state.vim;if(h&&(!h.insertMode||n.state.overwrite)){if(c=!0,h.visualBlock&&!s)return null;t.anchor<t.head&&(l<e.state.doc.length&&e.state.sliceDoc(l,l+1))!=`
`&&l--,n.state.overwrite?u=.2:h.status&&(u=.5)}if(c){let f=l<e.state.doc.length&&e.state.sliceDoc(l,l+1);f&&/[\uDC00-\uDFFF]/.test(f)&&l>1&&(l--,f=e.state.sliceDoc(l,l+1));let v=e.coordsAtPos(l,1);if(!v)return null;let O=Vme(e),k=e.domAtPos(l),M=k?k.node:e.contentDOM;for(M instanceof Text&&k.offset>=M.data.length&&!((a=M.parentElement)===null||a===void 0)&&a.nextSibling&&(M=(r=M.parentElement)===null||r===void 0?void 0:r.nextSibling,k={node:M,offset:0});k&&k.node instanceof HTMLElement;)M=k.node,k={node:k.node.childNodes[k.offset],offset:0};if(!(M instanceof HTMLElement)){if(!M.parentNode)return null;M=M.parentNode}let E=getComputedStyle(M),I=v.left,D=(i=(o=e).coordsForChar)===null||i===void 0?void 0:i.call(o,l);if(D&&(I=D.left),!f||f==`
`||f=="\r")f=" ";else if(f=="	"){f=" ";var m=e.coordsAtPos(l+1,-1);m&&(I=m.left-(m.left-v.left)/parseInt(E.tabSize))}else/[\uD800-\uDBFF]/.test(f)&&l<e.state.doc.length-1&&(f+=e.state.sliceDoc(l+1,l+2));let F=v.bottom-v.top;return new Rme((I-O.left)/e.scaleX,(v.top-O.top+F*(1-u))/e.scaleY,F*u/e.scaleY,E.fontFamily,E.fontSize,E.fontWeight,E.color,s?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",f,u!=1)}else return null}var Zme=typeof navigator<"u"&&/linux/i.test(navigator.platform)&&/ Gecko\/\d+/.exec(navigator.userAgent);const Ju=Sme(Nn),zme=250,Gme=ut.baseTheme({".cm-vimMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"0px 10px",fontFamily:"monospace",minHeight:"1.3em",display:"flex"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"inherit"},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"}}),Xme=Ks.fromClass(class{constructor(n){this.status="",this.query=null,this.decorations=Et.none,this.waitForCopy=!1,this.lastKeydown="",this.useNextTextInput=!1,this.compositionText="",this.view=n;const e=this.cm=new Nn(n);Ju.enterVimMode(this.cm),this.view.cm=this.cm,this.cm.state.vimPlugin=this,this.blockCursor=new _me(n,e),this.updateClass(),this.cm.on("vim-command-done",()=>{e.state.vim&&(e.state.vim.status=""),this.blockCursor.scheduleRedraw(),this.updateStatus()}),this.cm.on("vim-mode-change",t=>{e.state.vim&&(e.state.vim.mode=t.mode,t.subMode&&(e.state.vim.mode+=" block"),e.state.vim.status="",this.blockCursor.scheduleRedraw(),this.updateClass(),this.updateStatus())}),this.cm.on("dialog",()=>{this.cm.state.statusbar?this.updateStatus():n.dispatch({effects:jR.of(!!this.cm.state.dialog)})}),this.dom=document.createElement("span"),this.spacer=document.createElement("span"),this.spacer.style.flex="1",this.statusButton=document.createElement("span"),this.statusButton.onclick=t=>{Ju.handleKey(this.cm,"<Esc>","user"),this.cm.focus()},this.statusButton.style.cssText="cursor: pointer"}update(n){var e;if((n.viewportChanged||n.docChanged)&&this.query&&this.highlight(this.query),n.docChanged&&this.cm.onChange(n),n.selectionSet&&this.cm.onSelectionChange(),n.viewportChanged,this.cm.curOp&&!this.cm.curOp.isVimOp&&this.cm.onBeforeEndOperation(),n.transactions){for(let t of n.transactions)for(let s of t.effects)if(s.is(Eu))if(!((e=s.value)===null||e===void 0?void 0:e.forVim))this.highlight(null);else{let r=s.value.create();this.highlight(r)}}this.blockCursor.update(n)}updateClass(){const n=this.cm.state;!n.vim||n.vim.insertMode&&!n.overwrite?this.view.scrollDOM.classList.remove("cm-vimMode"):this.view.scrollDOM.classList.add("cm-vimMode")}updateStatus(){let n=this.cm.state.statusbar,e=this.cm.state.vim;if(!n||!e)return;let t=this.cm.state.dialog;if(t)t.parentElement!=n&&(n.textContent="",n.appendChild(t));else{n.textContent="";var s=(e.mode||"normal").toUpperCase();e.insertModeReturn&&(s+="(C-O)"),this.statusButton.textContent=`--${s}--`,n.appendChild(this.statusButton),n.appendChild(this.spacer)}this.dom.textContent=e.status,n.appendChild(this.dom)}destroy(){Ju.leaveVimMode(this.cm),this.updateClass(),this.blockCursor.destroy(),delete this.view.cm}highlight(n){if(this.query=n,!n)return this.decorations=Et.none;let{view:e}=this,t=new Hi;for(let s=0,a=e.visibleRanges,r=a.length;s<r;s++){let{from:o,to:i}=a[s];for(;s<r-1&&i>a[s+1].from-2*zme;)i=a[++s].to;n.highlight(e.state,o,i,(l,c)=>{t.add(l,c,qme)})}return this.decorations=t.finish()}handleKey(n,e){const t=this.cm;let s=t.state.vim;if(!s)return;const a=Ju.vimKeyFromEvent(n,s);if(Nn.signal(this.cm,"inputEvent",{type:"handleKey",key:a}),!a)return;if(a=="<Esc>"&&!s.insertMode&&!s.visualMode&&this.query){const i=s.searchState_;i&&(t.removeOverlay(i.getOverlay()),i.setOverlay(null))}if(a==="<C-c>"&&!Nn.isMac&&t.somethingSelected())return this.waitForCopy=!0,!0;s.status=(s.status||"")+a;let o=Ju.multiSelectHandleKey(t,a,"user");return s=Ju.maybeInitVimState_(t),!o&&s.insertMode&&t.state.overwrite&&(n.key&&n.key.length==1&&!/\n/.test(n.key)?(o=!0,t.overWriteSelection(n.key)):n.key=="Backspace"&&(o=!0,Nn.commands.cursorCharLeft(t))),o&&(Nn.signal(this.cm,"vim-keypress",a),n.preventDefault(),n.stopPropagation(),this.blockCursor.scheduleRedraw()),this.updateStatus(),!!o}},{eventHandlers:{copy:function(n,e){this.waitForCopy&&(this.waitForCopy=!1,Promise.resolve().then(()=>{var t=this.cm,s=t.state.vim;s&&(s.insertMode?t.setSelection(t.getCursor(),t.getCursor()):t.operation(()=>{t.curOp&&(t.curOp.isVimOp=!0),Ju.handleKey(t,"<Esc>","user")}))}))},compositionstart:function(n,e){this.useNextTextInput=!0,Nn.signal(this.cm,"inputEvent",n)},compositionupdate:function(n,e){Nn.signal(this.cm,"inputEvent",n)},compositionend:function(n,e){Nn.signal(this.cm,"inputEvent",n)},keypress:function(n,e){Nn.signal(this.cm,"inputEvent",n),this.lastKeydown=="Dead"&&this.handleKey(n,e)},keydown:function(n,e){Nn.signal(this.cm,"inputEvent",n),this.lastKeydown=n.key,this.lastKeydown=="Unidentified"||this.lastKeydown=="Process"||this.lastKeydown=="Dead"?this.useNextTextInput=!0:(this.useNextTextInput=!1,this.handleKey(n,e))}},provide:()=>[ut.inputHandler.of((n,e,t,s)=>{var a,r,o=Jme(n);if(!o)return!1;var i=(a=o.state)===null||a===void 0?void 0:a.vim,l=o.state.vimPlugin;if(i&&!i.insertMode&&!(!((r=o.curOp)===null||r===void 0)&&r.isVimOp)){if(s==="\0\0")return!0;if(Nn.signal(o,"inputEvent",{type:"text",text:s,from:e,to:t}),s.length==1&&l.useNextTextInput){if(i.expectLiteralNext&&n.composing)return l.compositionText=s,!1;if(l.compositionText){var c=l.compositionText;l.compositionText="";var u=n.state.selection.main.head,h=n.state.sliceDoc(u-c.length,u);if(c===h){var m=o.getCursor();o.replaceRange("",o.posFromIndex(u-c.length),m)}}return l.handleKey({key:s,preventDefault:()=>{},stopPropagation:()=>{}}),Wme(n),!0}}return!1})],decorations:n=>n.decorations});function Wme(n){var e=n.scrollDOM.parentElement;if(e){if(Zme){n.contentDOM.textContent="\0\0",n.contentDOM.dispatchEvent(new CustomEvent("compositionend"));return}var t=n.scrollDOM.nextSibling,s=window.getSelection(),a=s&&{anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset};n.scrollDOM.remove(),e.insertBefore(n.scrollDOM,t);try{a&&s&&(s.setPosition(a.anchorNode,a.anchorOffset),a.focusNode&&s.extend(a.focusNode,a.focusOffset))}catch(r){console.error(r)}n.focus(),n.contentDOM.dispatchEvent(new CustomEvent("compositionend"))}}const qme=Et.mark({class:"cm-searchMatch"}),jR=cn.define(),Ume=zs.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(jR)&&(n=t.value);return n},provide:n=>Cu.from(n,e=>e?Hme:null)});function Hme(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.dialog&&e.appendChild(t.state.dialog),{top:!1,dom:e}}function Yme(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.statusbar=e,t.state.vimPlugin.updateStatus(),{dom:e}}function Kme(n={}){return[Gme,Xme,Qme,n.status?Cu.of(Yme):Ume]}function Jme(n){return n.cm||null}class R7{constructor(e,t,s){this.from=e,this.to=t,this.diagnostic=s}}class ih{constructor(e,t,s){this.diagnostics=e,this.panel=t,this.selected=s}static init(e,t,s){let a=s.facet(Kf).markerFilter;a&&(e=a(e,s));let r=e.slice().sort((f,v)=>f.from-v.from||f.to-v.to),o=new Hi,i=[],l=0,c=s.doc.iter(),u=0,h=s.doc.length;for(let f=0;;){let v=f==r.length?null:r[f];if(!v&&!i.length)break;let O,k;if(i.length)O=l,k=i.reduce((I,D)=>Math.min(I,D.to),v&&v.from>O?v.from:1e8);else{if(O=v.from,O>h)break;k=v.to,i.push(v),f++}for(;f<r.length;){let I=r[f];if(I.from==O&&(I.to>I.from||I.to==O))i.push(I),f++,k=Math.min(I.to,k);else{k=Math.min(I.from,k);break}}k=Math.min(k,h);let M=!1;if(i.some(I=>I.from==O&&(I.to==k||k==h))&&(M=O==k,!M&&k-O<10)){let I=O-(u+c.value.length);I>0&&(c.next(I),u=O);for(let D=O;;){if(D>=k){M=!0;break}if(!c.lineBreak&&u+c.value.length>D)break;D=u+c.value.length,u+=c.value.length,c.next()}}let E=hpe(i);if(M)o.add(O,O,Et.widget({widget:new ipe(E),diagnostics:i.slice()}));else{let I=i.reduce((D,F)=>F.markClass?D+" "+F.markClass:D,"");o.add(O,k,Et.mark({class:"cm-lintRange cm-lintRange-"+E+I,diagnostics:i.slice(),inclusiveEnd:i.some(D=>D.to>k)}))}if(l=k,l==h)break;for(let I=0;I<i.length;I++)i[I].to<=l&&i.splice(I--,1)}let m=o.finish();return new ih(m,t,hm(m))}}function hm(n,e=null,t=0){let s=null;return n.between(t,1e9,(a,r,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!s)s=new R7(a,r,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(s.diagnostic)<0)return!1;s=new R7(s.from,r,s.diagnostic)}}),s}function epe(n,e){let t=e.pos,s=e.end||t,a=n.state.facet(Kf).hideOn(n,t,s);if(a!=null)return a;let r=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(o=>o.is(ZR))||n.changes.touchesRange(r.from,Math.max(r.to,s)))}function tpe(n,e){return n.field(_o,!1)?e:e.concat(cn.appendConfig.of(dpe))}const ZR=cn.define(),rA=cn.define(),zR=cn.define(),_o=zs.define({create(){return new ih(Et.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),s=null,a=n.panel;if(n.selected){let r=e.changes.mapPos(n.selected.from,1);s=hm(t,n.selected.diagnostic,r)||hm(t,null,r)}!t.size&&a&&e.state.facet(Kf).autoPanel&&(a=null),n=new ih(t,a,s)}for(let t of e.effects)if(t.is(ZR)){let s=e.state.facet(Kf).autoPanel?t.value.length?Jf.open:null:n.panel;n=ih.init(t.value,s,e.state)}else t.is(rA)?n=new ih(n.diagnostics,t.value?Jf.open:null,n.selected):t.is(zR)&&(n=new ih(n.diagnostics,n.panel,t.value));return n},provide:n=>[Cu.from(n,e=>e.panel),ut.decorations.from(n,e=>e.diagnostics)]}),npe=Et.mark({class:"cm-lintRange cm-lintRange-active"});function spe(n,e,t){let{diagnostics:s}=n.state.field(_o),a,r=-1,o=-1;s.between(e-(t<0?1:0),e+(t>0?1:0),(l,c,{spec:u})=>{if(e>=l&&e<=c&&(l==c||(e>l||t>0)&&(e<c||t<0)))return a=u.diagnostics,r=l,o=c,!1});let i=n.state.facet(Kf).tooltipFilter;return a&&i&&(a=i(a,n.state)),a?{pos:r,end:o,above:n.state.doc.lineAt(r).to<o,create(){return{dom:ape(n,a)}}}:null}function ape(n,e){return Ss("ul",{class:"cm-tooltip-lint"},e.map(t=>XR(n,t,!1)))}const rpe=n=>{let e=n.state.field(_o,!1);(!e||!e.panel)&&n.dispatch({effects:tpe(n.state,[rA.of(!0)])});let t=jf(n,Jf.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},_7=n=>{let e=n.state.field(_o,!1);return!e||!e.panel?!1:(n.dispatch({effects:rA.of(!1)}),!0)},ope=n=>{let e=n.state.field(_o,!1);if(!e)return!1;let t=n.state.selection.main,s=e.diagnostics.iter(t.to+1);return!s.value&&(s=e.diagnostics.iter(0),!s.value||s.from==t.from&&s.to==t.to)?!1:(n.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0}),!0)},Kf=Lt.define({combine(n){return{sources:n.map(e=>e.source).filter(e=>e!=null),...Kl(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:L7,tooltipFilter:L7,needsRefresh:(e,t)=>e?t?s=>e(s)||t(s):e:t,hideOn:(e,t)=>e?t?(s,a,r)=>e(s,a,r)||t(s,a,r):e:t,autoPanel:(e,t)=>e||t})}}});function L7(n,e){return n?e?(t,s)=>e(n(t,s),s):n:e}function GR(n){let e=[];if(n)e:for(let{name:t}of n){for(let s=0;s<t.length;s++){let a=t[s];if(/[a-zA-Z]/.test(a)&&!e.some(r=>r.toLowerCase()==a.toLowerCase())){e.push(a);continue e}}e.push("")}return e}function XR(n,e,t){var s;let a=t?GR(e.actions):[];return Ss("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Ss("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(s=e.actions)===null||s===void 0?void 0:s.map((r,o)=>{let i=!1,l=f=>{if(f.preventDefault(),i)return;i=!0;let v=hm(n.state.field(_o).diagnostics,e);v&&r.apply(n,v.from,v.to)},{name:c}=r,u=a[o]?c.indexOf(a[o]):-1,h=u<0?c:[c.slice(0,u),Ss("u",c.slice(u,u+1)),c.slice(u+1)],m=r.markClass?" "+r.markClass:"";return Ss("button",{type:"button",class:"cm-diagnosticAction"+m,onclick:l,onmousedown:l,"aria-label":` Action: ${c}${u<0?"":` (access key "${a[o]})"`}.`},h)}),e.source&&Ss("div",{class:"cm-diagnosticSource"},e.source))}class ipe extends ol{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Ss("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class I7{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=XR(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Jf{constructor(e){this.view=e,this.items=[];let t=a=>{if(a.keyCode==27)_7(this.view),this.view.focus();else if(a.keyCode==38||a.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(a.keyCode==40||a.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(a.keyCode==36)this.moveSelection(0);else if(a.keyCode==35)this.moveSelection(this.items.length-1);else if(a.keyCode==13)this.view.focus();else if(a.keyCode>=65&&a.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:r}=this.items[this.selectedIndex],o=GR(r.actions);for(let i=0;i<o.length;i++)if(o[i].toUpperCase().charCodeAt(0)==a.keyCode){let l=hm(this.view.state.field(_o).diagnostics,r);l&&r.actions[i].apply(e,l.from,l.to)}}else return;a.preventDefault()},s=a=>{for(let r=0;r<this.items.length;r++)this.items[r].dom.contains(a.target)&&this.moveSelection(r)};this.list=Ss("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:s}),this.dom=Ss("div",{class:"cm-panel-lint"},this.list,Ss("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>_7(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(_o).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(_o),s=0,a=!1,r=null,o=new Set;for(e.between(0,this.view.state.doc.length,(i,l,{spec:c})=>{for(let u of c.diagnostics){if(o.has(u))continue;o.add(u);let h=-1,m;for(let f=s;f<this.items.length;f++)if(this.items[f].diagnostic==u){h=f;break}h<0?(m=new I7(this.view,u),this.items.splice(s,0,m),a=!0):(m=this.items[h],h>s&&(this.items.splice(s,h-s),a=!0)),t&&m.diagnostic==t.diagnostic?m.dom.hasAttribute("aria-selected")||(m.dom.setAttribute("aria-selected","true"),r=m):m.dom.hasAttribute("aria-selected")&&m.dom.removeAttribute("aria-selected"),s++}});s<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)a=!0,this.items.pop();this.items.length==0&&(this.items.push(new I7(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),a=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:i,panel:l})=>{let c=l.height/this.list.offsetHeight;i.top<l.top?this.list.scrollTop-=(l.top-i.top)/c:i.bottom>l.bottom&&(this.list.scrollTop+=(i.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),a&&this.sync()}sync(){let e=this.list.firstChild;function t(){let s=e;e=s.nextSibling,s.remove()}for(let s of this.items)if(s.dom.parentNode==this.list){for(;e!=s.dom;)t();e=s.dom.nextSibling}else this.list.insertBefore(s.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(_o),s=hm(t.diagnostics,this.items[e].diagnostic);s&&this.view.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:zR.of(s)})}static open(e){return new Jf(e)}}function lpe(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function L0(n){return lpe(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const cpe=ut.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:L0("#d11")},".cm-lintRange-warning":{backgroundImage:L0("orange")},".cm-lintRange-info":{backgroundImage:L0("#999")},".cm-lintRange-hint":{backgroundImage:L0("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function upe(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function hpe(n){let e="hint",t=1;for(let s of n){let a=upe(s.severity);a>t&&(t=a,e=s.severity)}return e}const dpe=[_o,ut.decorations.compute([_o],n=>{let{selected:e,panel:t}=n.field(_o);return!e||!t||e.from==e.to?Et.none:Et.set([npe.range(e.from,e.to)])}),P6(spe,{hideOn:epe}),cpe],WR=n=>e=>{const t=n==="down";let s=e.state.selection;for(const a of s.ranges)s=s.addRange(e.moveVertically(a,t));return e.dispatch({selection:s}),!0},mpe=WR("up"),ppe=WR("down"),fpe=n=>{let e=null;for(const t of n.state.selection.ranges)if(!t.empty)for(let s=t.from;s<=t.to;){const a=n.state.doc.lineAt(s),r=Math.min(a.to,t.to);e?e=e.addRange(Ve.range(r,r)):e=Ve.single(r),s=a.to+1}return e?(n.dispatch({selection:e}),!0):!1},gpe=[{key:"Ctrl-Space",run:Yb},{key:"Escape",run:p$},{key:"ArrowDown",run:ou(!0)},{key:"ArrowUp",run:ou(!1)},{key:"PageDown",run:ou(!0,"page")},{key:"PageUp",run:ou(!1,"page")},{key:"Enter",run:f2},{key:"Tab",run:f2},{key:"Mod-f",run:PR,scope:"editor search-panel"},{key:"Escape",run:SR,scope:"editor search-panel"},{key:"Alt-Enter",run:wR,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:OR,scope:"editor search-panel"},{key:"Ctrl-g",run:nde},{key:"Mod-d",run:pde,preventDefault:!0},{key:"Shift-Mod-l",run:xde},{key:"Enter",run:Uf,shift:Uf},{key:"ArrowLeft",run:qf,shift:oy,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:I$,shift:U$},{key:"ArrowRight",run:ty,shift:iy,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Q$,shift:H$},{key:"ArrowUp",run:ny,shift:ly,preventDefault:!0},{key:"ArrowDown",run:sy,shift:cy,preventDefault:!0},{key:"Home",run:ry,shift:v2},{mac:"Cmd-ArrowLeft",run:ry,shift:v2},{key:"Mod-Home",run:dy,shift:py},{mac:"Cmd-ArrowUp",run:dy,shift:py},{key:"PageUp",run:wf,shift:uy},{mac:"Ctrl-ArrowUp",run:wf,shift:uy},{key:"PageDown",run:Bd,shift:hy},{mac:"Ctrl-ArrowDown",run:Bd,shift:hy},{key:"End",run:ay,shift:y2},{mac:"Cmd-ArrowRight",run:ay,shift:y2},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:mpe,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:ppe,preventDefault:!0},{key:"Shift-Alt-i",run:fpe},{key:"Mod-End",run:my,shift:fy},{mac:"Cmd-ArrowDown",run:my,shift:fy},{key:"Mod-a",run:tR},{key:"Backspace",run:O$},{key:"Backspace",run:$d,shift:$d},{key:"Delete",run:gy},{key:"Mod-Backspace",mac:"Alt-Backspace",run:by},{key:"Mod-Delete",mac:"Alt-Delete",run:oR},{mac:"Mod-Backspace",run:Xhe},{mac:"Mod-Delete",run:w2},{mac:"Ctrl-b",run:qf,shift:oy,preventDefault:!0},{mac:"Ctrl-f",run:ty,shift:iy},{mac:"Ctrl-p",run:ny,shift:ly},{mac:"Ctrl-n",run:sy,shift:cy},{mac:"Ctrl-a",run:z$,shift:J$},{mac:"Ctrl-e",run:G$,shift:eR},{mac:"Ctrl-d",run:gy},{mac:"Ctrl-h",run:$d},{mac:"Ctrl-k",run:w2},{mac:"Ctrl-Alt-h",run:by},{mac:"Ctrl-o",run:qM},{mac:"Ctrl-t",run:iR},{mac:"Ctrl-v",run:Bd},{mac:"Alt-v",run:wf},{key:"Shift-Mod-k",run:pR},{key:"Alt-ArrowDown",run:uR},{key:"Alt-ArrowUp",run:cR},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:mR},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:dR},{key:"Mod-l",run:nR,preventDefault:!0},{key:"Shift-Mod-\\",run:X$},{key:"Tab",run:Hf,shift:Yf,preventDefault:!0},{key:"Mod-[",run:Yf},{key:"Mod-]",run:Hf},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:BM},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:H6},{key:"Mod-k Mod-0",run:K6},{key:"Mod-k Mod-j",run:J6},{key:"Mod-k Mod-c",run:bhe},{key:"Mod-k Mod-u",run:yhe},{key:"Mod-/",run:jM},{key:"Shift-Alt-a",run:T$},{key:"Mod-z",run:nw,preventDefault:!0},{key:"Mod-y",run:cm,preventDefault:!0},{key:"Mod-Shift-z",run:cm,preventDefault:!0},{key:"Mod-u",run:$$,preventDefault:!0},{key:"Mod-Shift-m",run:rpe},{key:"F8",run:ope}];function bpe(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function dm(n,e,t,s){var a=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(a,dm.prototype),a.expected=e,a.found=t,a.location=s,a.name="SyntaxError",a}bpe(dm,Error);function hx(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}dm.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,s;for(s=0;s<n.length;s++)if(n[s].source===this.location.source){t=n[s].text.split(/\r\n|\n|\r/g);break}var a=this.location.start,r=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(a):a,o=this.location.source+":"+r.line+":"+r.column;if(t){var i=this.location.end,l=hx("",r.line.toString().length," "),c=t[a.line-1],u=a.line===i.line?i.column:c.length+1,h=u-a.column||1;e+=`
 --> `+o+`
`+l+` |
`+r.line+" | "+c+`
`+l+" | "+hx("",a.column-1," ")+hx("",h,"^")}else e+=`
 at `+o}return e};dm.buildMessage=function(n,e){var t={literal:function(c){return'"'+a(c.text)+'"'},class:function(c){var u=c.parts.map(function(h){return Array.isArray(h)?r(h[0])+"-"+r(h[1]):r(h)});return"["+(c.inverted?"^":"")+u.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(c){return c.description}};function s(c){return c.charCodeAt(0).toString(16).toUpperCase()}function a(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+s(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+s(u)})}function r(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+s(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+s(u)})}function o(c){return t[c.type](c)}function i(c){var u=c.map(o),h,m;if(u.sort(),u.length>0){for(h=1,m=1;h<u.length;h++)u[h-1]!==u[h]&&(u[m]=u[h],m++);u.length=m}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function l(c){return c?'"'+a(c)+'"':"end of input"}return"Expected "+i(n)+" but "+l(e)+" found."};function ype(n,e){e=e!==void 0?e:{};var t={},s=e.grammarSource,a={start:Yt},r=Yt,o=".",i="-",l="0",c=",",u="|",h="[",m="]",f="{",v="}",O="%",k="<",M=">",E="!",I="(",D=")",F="/",_="*",$="?",Z=":",ce="..",U="^",ue="struct",W="target",de="euclid",be="slow",ke="rotL",Ce="rotR",Ae="fast",q="scale",Ne="//",Re="cat",je="$",me="setcps",Ye="setbpm",ft="hush",_e=/^[1-9]/,Ge=/^[eE]/,pt=/^[+\-]/,rt=/^[0-9]/,tn=/^[ \n\r\t\xA0]/,on=/^["']/,xn=/^[#\--.0-9A-Z\^-_a-z~\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u09FC\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD-\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,Gt=/^[@_]/,In=/^[^\n]/,Ft=Je("number"),jt=De(".",!1),Gn=ot([["1","9"]],!1,!1),un=ot(["e","E"],!1,!1),fn=ot(["+","-"],!1,!1),at=De("-",!1),Un=De("0",!1),nt=ot([["0","9"]],!1,!1),Mt=Je("whitespace"),Vt=ot([" ",`
`,"\r","	"," "],!1,!1),En=De(",",!1),lt=De("|",!1),It=ot(['"',"'"],!1,!1),Le=Je('a letter, a number, "-", "#", ".", "^", "_"'),qt=ot(["#",["-","."],["0","9"],["A","Z"],["^","_"],["a","z"],"~","ª","µ","º",["À","Ö"],["Ø","ö"],["ø","ˁ"],["ˆ","ˑ"],["ˠ","ˤ"],"ˬ","ˮ",["Ͱ","ʹ"],["Ͷ","ͷ"],["ͺ","ͽ"],"Ϳ","Ά",["Έ","Ί"],"Ό",["Ύ","Ρ"],["Σ","ϵ"],["Ϸ","ҁ"],["Ҋ","ԯ"],["Ա","Ֆ"],"ՙ",["ՠ","ֈ"],["א","ת"],["ׯ","ײ"],["ؠ","ي"],["ٮ","ٯ"],["ٱ","ۓ"],"ە",["ۥ","ۦ"],["ۮ","ۯ"],["ۺ","ۼ"],"ۿ","ܐ",["ܒ","ܯ"],["ݍ","ޥ"],"ޱ",["ߊ","ߪ"],["ߴ","ߵ"],"ߺ",["ࠀ","ࠕ"],"ࠚ","ࠤ","ࠨ",["ࡀ","ࡘ"],["ࡠ","ࡪ"],["ࢠ","ࢴ"],["ࢶ","ࢽ"],["ऄ","ह"],"ऽ","ॐ",["क़","ॡ"],["ॱ","ঀ"],["অ","ঌ"],["এ","ঐ"],["ও","ন"],["প","র"],"ল",["শ","হ"],"ঽ","ৎ",["ড়","ঢ়"],["য়","ৡ"],["ৰ","ৱ"],"ৼ",["ਅ","ਊ"],["ਏ","ਐ"],["ਓ","ਨ"],["ਪ","ਰ"],["ਲ","ਲ਼"],["ਵ","ਸ਼"],["ਸ","ਹ"],["ਖ਼","ੜ"],"ਫ਼",["ੲ","ੴ"],["અ","ઍ"],["એ","ઑ"],["ઓ","ન"],["પ","ર"],["લ","ળ"],["વ","હ"],"ઽ","ૐ",["ૠ","ૡ"],"ૹ",["ଅ","ଌ"],["ଏ","ଐ"],["ଓ","ନ"],["ପ","ର"],["ଲ","ଳ"],["ଵ","ହ"],"ଽ",["ଡ଼","ଢ଼"],["ୟ","ୡ"],"ୱ","ஃ",["அ","ஊ"],["எ","ஐ"],["ஒ","க"],["ங","ச"],"ஜ",["ஞ","ட"],["ண","த"],["ந","ப"],["ம","ஹ"],"ௐ",["అ","ఌ"],["ఎ","ఐ"],["ఒ","న"],["ప","హ"],"ఽ",["ౘ","ౚ"],["ౠ","ౡ"],"ಀ",["ಅ","ಌ"],["ಎ","ಐ"],["ಒ","ನ"],["ಪ","ಳ"],["ವ","ಹ"],"ಽ","ೞ",["ೠ","ೡ"],["ೱ","ೲ"],["അ","ഌ"],["എ","ഐ"],["ഒ","ഺ"],"ഽ","ൎ",["ൔ","ൖ"],["ൟ","ൡ"],["ൺ","ൿ"],["අ","ඖ"],["ක","න"],["ඳ","ර"],"ල",["ව","ෆ"],["ก","ะ"],["า","ำ"],["เ","ๆ"],["ກ","ຂ"],"ຄ",["ງ","ຈ"],"ຊ","ຍ",["ດ","ທ"],["ນ","ຟ"],["ມ","ຣ"],"ລ","ວ",["ສ","ຫ"],["ອ","ະ"],["າ","ຳ"],"ຽ",["ເ","ໄ"],"ໆ",["ໜ","ໟ"],"ༀ",["ཀ","ཇ"],["ཉ","ཬ"],["ྈ","ྌ"],["က","ဪ"],"ဿ",["ၐ","ၕ"],["ၚ","ၝ"],"ၡ",["ၥ","ၦ"],["ၮ","ၰ"],["ၵ","ႁ"],"ႎ",["Ⴀ","Ⴥ"],"Ⴧ","Ⴭ",["ა","ჺ"],["ჼ","ቈ"],["ቊ","ቍ"],["ቐ","ቖ"],"ቘ",["ቚ","ቝ"],["በ","ኈ"],["ኊ","ኍ"],["ነ","ኰ"],["ኲ","ኵ"],["ኸ","ኾ"],"ዀ",["ዂ","ዅ"],["ወ","ዖ"],["ዘ","ጐ"],["ጒ","ጕ"],["ጘ","ፚ"],["ᎀ","ᎏ"],["Ꭰ","Ᏽ"],["ᏸ","ᏽ"],["ᐁ","ᙬ"],["ᙯ","ᙿ"],["ᚁ","ᚚ"],["ᚠ","ᛪ"],["ᛮ","ᛸ"],["ᜀ","ᜌ"],["ᜎ","ᜑ"],["ᜠ","ᜱ"],["ᝀ","ᝑ"],["ᝠ","ᝬ"],["ᝮ","ᝰ"],["ក","ឳ"],"ៗ","ៜ",["ᠠ","ᡸ"],["ᢀ","ᢄ"],["ᢇ","ᢨ"],"ᢪ",["ᢰ","ᣵ"],["ᤀ","ᤞ"],["ᥐ","ᥭ"],["ᥰ","ᥴ"],["ᦀ","ᦫ"],["ᦰ","ᧉ"],["ᨀ","ᨖ"],["ᨠ","ᩔ"],"ᪧ",["ᬅ","ᬳ"],["ᭅ","ᭋ"],["ᮃ","ᮠ"],["ᮮ","ᮯ"],["ᮺ","ᯥ"],["ᰀ","ᰣ"],["ᱍ","ᱏ"],["ᱚ","ᱽ"],["ᲀ","ᲈ"],["Ა","Ჺ"],["Ჽ","Ჿ"],["ᳩ","ᳬ"],["ᳮ","ᳱ"],["ᳵ","ᳶ"],["ᴀ","ᶿ"],["Ḁ","ἕ"],["Ἐ","Ἕ"],["ἠ","ὅ"],["Ὀ","Ὅ"],["ὐ","ὗ"],"Ὑ","Ὓ","Ὕ",["Ὗ","ώ"],["ᾀ","ᾴ"],["ᾶ","ᾼ"],"ι",["ῂ","ῄ"],["ῆ","ῌ"],["ῐ","ΐ"],["ῖ","Ί"],["ῠ","Ῥ"],["ῲ","ῴ"],["ῶ","ῼ"],"ⁱ","ⁿ",["ₐ","ₜ"],"ℂ","ℇ",["ℊ","ℓ"],"ℕ",["ℙ","ℝ"],"ℤ","Ω","ℨ",["K","ℭ"],["ℯ","ℹ"],["ℼ","ℿ"],["ⅅ","ⅉ"],"ⅎ",["Ⅰ","ↈ"],["Ⰰ","Ⱞ"],["ⰰ","ⱞ"],["Ⱡ","ⳤ"],["Ⳬ","ⳮ"],["Ⳳ","ⳳ"],["ⴀ","ⴥ"],"ⴧ","ⴭ",["ⴰ","ⵧ"],"ⵯ",["ⶀ","ⶖ"],["ⶠ","ⶦ"],["ⶨ","ⶮ"],["ⶰ","ⶶ"],["ⶸ","ⶾ"],["ⷀ","ⷆ"],["ⷈ","ⷎ"],["ⷐ","ⷖ"],["ⷘ","ⷞ"],"ⸯ",["々","〇"],["〡","〩"],["〱","〵"],["〸","〼"],["ぁ","ゖ"],["ゝ","ゟ"],["ァ","ヺ"],["ー","ヿ"],["ㄅ","ㄯ"],["ㄱ","ㆎ"],["ㆠ","ㆺ"],["ㇰ","ㇿ"],["㐀","䶵"],["一","鿯"],["ꀀ","ꒌ"],["ꓐ","ꓽ"],["ꔀ","ꘌ"],["ꘐ","ꘟ"],["ꘪ","ꘫ"],["Ꙁ","ꙮ"],["ꙿ","ꚝ"],["ꚠ","ꛯ"],["ꜗ","ꜟ"],["Ꜣ","ꞈ"],["Ꞌ","ꞹ"],["ꟷ","ꠁ"],["ꠃ","ꠅ"],["ꠇ","ꠊ"],["ꠌ","ꠢ"],["ꡀ","ꡳ"],["ꢂ","ꢳ"],["ꣲ","ꣷ"],"ꣻ",["ꣽ","ꣾ"],["ꤊ","ꤥ"],["ꤰ","ꥆ"],["ꥠ","ꥼ"],["ꦄ","ꦲ"],"ꧏ",["ꧠ","ꧤ"],["ꧦ","ꧯ"],["ꧺ","ꧾ"],["ꨀ","ꨨ"],["ꩀ","ꩂ"],["ꩄ","ꩋ"],["ꩠ","ꩶ"],"ꩺ",["ꩾ","ꪯ"],"ꪱ",["ꪵ","ꪶ"],["ꪹ","ꪽ"],"ꫀ","ꫂ",["ꫛ","ꫝ"],["ꫠ","ꫪ"],["ꫲ","ꫴ"],["ꬁ","ꬆ"],["ꬉ","ꬎ"],["ꬑ","ꬖ"],["ꬠ","ꬦ"],["ꬨ","ꬮ"],["ꬰ","ꭚ"],["ꭜ","ꭥ"],["ꭰ","ꯢ"],["가","힣"],["ힰ","ퟆ"],["ퟋ","ퟻ"],["豈","舘"],["並","龎"],["ﬀ","ﬆ"],["ﬓ","ﬗ"],"יִ",["ײַ","ﬨ"],["שׁ","זּ"],["טּ","לּ"],"מּ",["נּ","סּ"],["ףּ","פּ"],["צּ","ﮱ"],["ﯓ","ﴽ"],["ﵐ","ﶏ"],["ﶒ","ﷇ"],["ﷰ","ﷻ"],["ﹰ","ﹴ"],["ﹶ","ﻼ"],["Ａ","Ｚ"],["ａ","ｚ"],["ｦ","ﾾ"],["ￂ","ￇ"],["ￊ","ￏ"],["ￒ","ￗ"],["ￚ","ￜ"]],!1,!1),tt=De("[",!1),zn=De("]",!1),mt=De("{",!1),Fn=De("}",!1),ea=De("%",!1),Hn=De("<",!1),Zt=De(">",!1),Dt=ot(["@","_"],!1,!1),Sn=De("!",!1),He=De("(",!1),Tt=De(")",!1),kn=De("/",!1),vs=De("*",!1),ln=De("?",!1),Gs=De(":",!1),na=De("..",!1),x=De("^",!1),B=De("struct",!1),T=De("target",!1),R=De("euclid",!1),j=De("slow",!1),H=De("rotL",!1),ee=De("rotR",!1),ne=De("fast",!1),ge=De("scale",!1),Fe=De("//",!1),Be=ot([`
`],!0,!1),wt=De("cat",!1),Nt=De("$",!1),yn=De("setcps",!1),ws=De("setbpm",!1),gn=De("hush",!1),_s=function(){return parseFloat(Qe())},Cn=function(P){const Q=P.join("");return Q==="."||Q==="_"},Pn=function(P){return new kO(P.join(""))},bs=function(P){return P},ls=function(P,Q){return P.arguments_.stepsPerCycle=Q,P},Fa=function(P){return P},$r=function(P){return P.arguments_.alignment="polymeter_slowcat",P},Rr=function(P){return Q=>Q.options_.weight=(Q.options_.weight??1)+(P??2)-1},Na=function(P){return Q=>{const X=(Q.options_.reps??1)+(P??2)-1;Q.options_.reps=X,Q.options_.ops=Q.options_.ops.filter(ye=>ye.type_!=="replicate"),Q.options_.ops.push({type_:"replicate",arguments_:{amount:X}}),Q.options_.weight=X}},rc=function(P,Q,X){return ye=>ye.options_.ops.push({type_:"bjorklund",arguments_:{pulse:P,step:Q,rotation:X}})},Ls=function(P){return Q=>Q.options_.ops.push({type_:"stretch",arguments_:{amount:P,type:"slow"}})},oc=function(P){return Q=>Q.options_.ops.push({type_:"stretch",arguments_:{amount:P,type:"fast"}})},vo=function(P){return Q=>Q.options_.ops.push({type_:"degradeBy",arguments_:{amount:P,seed:Hu++}})},er=function(P){return Q=>Q.options_.ops.push({type_:"tail",arguments_:{element:P}})},ic=function(P){return Q=>Q.options_.ops.push({type_:"range",arguments_:{element:P}})},wo=function(P,Q){const X=new SO(P,{ops:[],weight:1,reps:1});for(const ye of Q)ye(X);return X},Zo=function(P,Q){return new hc(Q,"fastcat",void 0,!!P)},_r=function(P){return{alignment:"stack",list:P}},Yn=function(P){return{alignment:"rand",list:P,seed:Hu++}},oa=function(P){return{alignment:"feet",list:P,seed:Hu++}},Lr=function(P,Q){return Q&&Q.list.length>0?new hc([P,...Q.list],Q.alignment,Q.seed):P},br=function(P,Q){return new hc(Q?[P,...Q.list]:[P],"polymeter")},tr=function(P){return P},Ir=function(P){return{name:"struct",args:{mini:P}}},nr=function(P){return{name:"target",args:{name:P}}},lc=function(P,Q,X){return{name:"bjorklund",args:{pulse:P,step:parseInt(Q)}}},Ba=function(P){return{name:"stretch",args:{amount:P}}},zo=function(P){return{name:"shift",args:{amount:"-"+P}}},Oo=function(P){return{name:"shift",args:{amount:P}}},ys=function(P){return{name:"stretch",args:{amount:"1/"+P}}},Ct=function(P){return{name:"scale",args:{scale:P.join("")}}},Ai=function(P,Q){return Q},yr=function(P,Q){return Q.unshift(P),new hc(Q,"slowcat")},cc=function(P){return P},$a=function(P,Q){return new PO(P.name,P.args,Q)},hl=function(P){return P},Ra=function(P){return P},Y=function(P){return new Uu("setcps",{value:P})},J=function(P){return new Uu("setcps",{value:P/120/2})},te=function(){return new Uu("hush")},A=e.peg$currPos|0,he=A,we=[{line:1,column:1}],Oe=A,Se=e.peg$maxFailExpected||[],fe=e.peg$silentFails|0,Te;if(e.startRule){if(!(e.startRule in a))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');r=a[e.startRule]}function Qe(){return n.substring(he,A)}function Ee(){return et(he,A)}function De(P,Q){return{type:"literal",text:P,ignoreCase:Q}}function ot(P,Q,X){return{type:"class",parts:P,inverted:Q,ignoreCase:X}}function st(){return{type:"end"}}function Je(P){return{type:"other",description:P}}function We(P){var Q=we[P],X;if(Q)return Q;if(P>=we.length)X=we.length-1;else for(X=P;!we[--X];);for(Q=we[X],Q={line:Q.line,column:Q.column};X<P;)n.charCodeAt(X)===10?(Q.line++,Q.column=1):Q.column++,X++;return we[P]=Q,Q}function et(P,Q,X){var ye=We(P),Ue=We(Q),mn={source:s,start:{offset:P,line:ye.line,column:ye.column},end:{offset:Q,line:Ue.line,column:Ue.column}};return mn}function Me(P){A<Oe||(A>Oe&&(Oe=A,Se=[]),Se.push(P))}function Ke(P,Q,X){return new dm(dm.buildMessage(P,Q),P,Q,X)}function Yt(){var P;return P=xO(),P}function $t(){var P,Q;return fe++,P=A,pn(),Q=Jt(),Q!==t?(Ps(),ms(),he=P,P=_s()):(A=P,P=t),fe--,P===t&&fe===0&&Me(Ft),P}function dn(){var P;return n.charCodeAt(A)===46?(P=o,A++):(P=t,fe===0&&Me(jt)),P}function Rn(){var P;return P=n.charAt(A),_e.test(P)?A++:(P=t,fe===0&&Me(Gn)),P}function On(){var P;return P=n.charAt(A),Ge.test(P)?A++:(P=t,fe===0&&Me(un)),P}function ms(){var P,Q,X,ye,Ue;if(P=A,Q=On(),Q!==t){if(X=n.charAt(A),pt.test(X)?A++:(X=t,fe===0&&Me(fn)),X===t&&(X=null),ye=[],Ue=d(),Ue!==t)for(;Ue!==t;)ye.push(Ue),Ue=d();else ye=t;ye!==t?(Q=[Q,X,ye],P=Q):(A=P,P=t)}else A=P,P=t;return P}function Ps(){var P,Q,X,ye;if(P=A,Q=dn(),Q!==t){if(X=[],ye=d(),ye!==t)for(;ye!==t;)X.push(ye),ye=d();else X=t;X!==t?(Q=[Q,X],P=Q):(A=P,P=t)}else A=P,P=t;return P}function Jt(){var P,Q,X,ye;if(P=zt(),P===t)if(P=A,Q=Rn(),Q!==t){for(X=[],ye=d();ye!==t;)X.push(ye),ye=d();Q=[Q,X],P=Q}else A=P,P=t;return P}function pn(){var P;return n.charCodeAt(A)===45?(P=i,A++):(P=t,fe===0&&Me(at)),P}function zt(){var P;return n.charCodeAt(A)===48?(P=l,A++):(P=t,fe===0&&Me(Un)),P}function d(){var P;return P=n.charAt(A),rt.test(P)?A++:(P=t,fe===0&&Me(nt)),P}function p(){var P,Q;for(fe++,P=[],Q=n.charAt(A),tn.test(Q)?A++:(Q=t,fe===0&&Me(Vt));Q!==t;)P.push(Q),Q=n.charAt(A),tn.test(Q)?A++:(Q=t,fe===0&&Me(Vt));return fe--,Q=t,fe===0&&Me(Mt),P}function g(){var P,Q,X,ye;return P=A,Q=p(),n.charCodeAt(A)===44?(X=c,A++):(X=t,fe===0&&Me(En)),X!==t?(ye=p(),Q=[Q,X,ye],P=Q):(A=P,P=t),P}function b(){var P,Q,X,ye;return P=A,Q=p(),n.charCodeAt(A)===124?(X=u,A++):(X=t,fe===0&&Me(lt)),X!==t?(ye=p(),Q=[Q,X,ye],P=Q):(A=P,P=t),P}function S(){var P,Q,X,ye;return P=A,Q=p(),n.charCodeAt(A)===46?(X=o,A++):(X=t,fe===0&&Me(jt)),X!==t?(ye=p(),Q=[Q,X,ye],P=Q):(A=P,P=t),P}function C(){var P;return P=n.charAt(A),on.test(P)?A++:(P=t,fe===0&&Me(It)),P}function N(){var P;return fe++,P=n.charAt(A),xn.test(P)?A++:(P=t,fe===0&&Me(qt)),fe--,P===t&&fe===0&&Me(Le),P}function L(){var P,Q,X,ye;if(P=A,p(),Q=[],X=N(),X!==t)for(;X!==t;)Q.push(X),X=N();else Q=t;return Q!==t?(X=p(),he=A,ye=Cn(Q),ye?ye=t:ye=void 0,ye!==t?(he=P,P=Pn(Q)):(A=P,P=t)):(A=P,P=t),P}function V(){var P,Q,X,ye;return P=A,p(),n.charCodeAt(A)===91?(Q=h,A++):(Q=t,fe===0&&Me(tt)),Q!==t?(p(),X=Dn(),X!==t?(p(),n.charCodeAt(A)===93?(ye=m,A++):(ye=t,fe===0&&Me(zn)),ye!==t?(p(),he=P,P=bs(X)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function z(){var P,Q,X,ye,Ue;return P=A,p(),n.charCodeAt(A)===123?(Q=f,A++):(Q=t,fe===0&&Me(mt)),Q!==t?(p(),X=nn(),X!==t?(p(),n.charCodeAt(A)===125?(ye=v,A++):(ye=t,fe===0&&Me(Fn)),ye!==t?(Ue=G(),Ue===t&&(Ue=null),p(),he=P,P=ls(X,Ue)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function G(){var P,Q,X;return P=A,n.charCodeAt(A)===37?(Q=O,A++):(Q=t,fe===0&&Me(ea)),Q!==t?(X=le(),X!==t?(he=P,P=Fa(X)):(A=P,P=t)):(A=P,P=t),P}function ie(){var P,Q,X,ye;return P=A,p(),n.charCodeAt(A)===60?(Q=k,A++):(Q=t,fe===0&&Me(Hn)),Q!==t?(p(),X=nn(),X!==t?(p(),n.charCodeAt(A)===62?(ye=M,A++):(ye=t,fe===0&&Me(Zt)),ye!==t?(p(),he=P,P=$r(X)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function le(){var P;return P=L(),P===t&&(P=V(),P===t&&(P=z(),P===t&&(P=ie()))),P}function se(){var P;return P=K(),P===t&&(P=xe(),P===t&&(P=$e(),P===t&&(P=Pe(),P===t&&(P=ve(),P===t&&(P=ze(),P===t&&(P=ct(),P===t&&(P=it()))))))),P}function K(){var P,Q,X;return P=A,p(),Q=n.charAt(A),Gt.test(Q)?A++:(Q=t,fe===0&&Me(Dt)),Q!==t?(X=$t(),X===t&&(X=null),he=P,P=Rr(X)):(A=P,P=t),P}function ve(){var P,Q,X;return P=A,p(),n.charCodeAt(A)===33?(Q=E,A++):(Q=t,fe===0&&Me(Sn)),Q!==t?(X=$t(),X===t&&(X=null),he=P,P=Na(X)):(A=P,P=t),P}function xe(){var P,Q,X,ye,Ue,mn,ta;return P=A,n.charCodeAt(A)===40?(Q=I,A++):(Q=t,fe===0&&Me(He)),Q!==t?(p(),X=Rt(),X!==t?(p(),ye=g(),ye!==t?(p(),Ue=Rt(),Ue!==t?(p(),g(),p(),mn=Rt(),mn===t&&(mn=null),p(),n.charCodeAt(A)===41?(ta=D,A++):(ta=t,fe===0&&Me(Tt)),ta!==t?(he=P,P=rc(X,Ue,mn)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function $e(){var P,Q,X;return P=A,n.charCodeAt(A)===47?(Q=F,A++):(Q=t,fe===0&&Me(kn)),Q!==t?(X=le(),X!==t?(he=P,P=Ls(X)):(A=P,P=t)):(A=P,P=t),P}function Pe(){var P,Q,X;return P=A,n.charCodeAt(A)===42?(Q=_,A++):(Q=t,fe===0&&Me(vs)),Q!==t?(X=le(),X!==t?(he=P,P=oc(X)):(A=P,P=t)):(A=P,P=t),P}function ze(){var P,Q,X;return P=A,n.charCodeAt(A)===63?(Q=$,A++):(Q=t,fe===0&&Me(ln)),Q!==t?(X=$t(),X===t&&(X=null),he=P,P=vo(X)):(A=P,P=t),P}function ct(){var P,Q,X;return P=A,n.charCodeAt(A)===58?(Q=Z,A++):(Q=t,fe===0&&Me(Gs)),Q!==t?(X=le(),X!==t?(he=P,P=er(X)):(A=P,P=t)):(A=P,P=t),P}function it(){var P,Q,X;return P=A,n.substr(A,2)===ce?(Q=ce,A+=2):(Q=t,fe===0&&Me(na)),Q!==t?(X=le(),X!==t?(he=P,P=ic(X)):(A=P,P=t)):(A=P,P=t),P}function Rt(){var P,Q,X,ye;if(P=A,Q=le(),Q!==t){for(X=[],ye=se();ye!==t;)X.push(ye),ye=se();he=P,P=wo(Q,X)}else A=P,P=t;return P}function _t(){var P,Q,X,ye;if(P=A,n.charCodeAt(A)===94?(Q=U,A++):(Q=t,fe===0&&Me(x)),Q===t&&(Q=null),X=[],ye=Rt(),ye!==t)for(;ye!==t;)X.push(ye),ye=Rt();else X=t;return X!==t?(he=P,P=Zo(Q,X)):(A=P,P=t),P}function Ot(){var P,Q,X,ye,Ue;if(P=A,Q=[],X=A,ye=g(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t),X!==t)for(;X!==t;)Q.push(X),X=A,ye=g(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t);else Q=t;return Q!==t&&(he=P,Q=_r(Q)),P=Q,P}function qe(){var P,Q,X,ye,Ue;if(P=A,Q=[],X=A,ye=b(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t),X!==t)for(;X!==t;)Q.push(X),X=A,ye=b(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t);else Q=t;return Q!==t&&(he=P,Q=Yn(Q)),P=Q,P}function Ut(){var P,Q,X,ye,Ue;if(P=A,Q=[],X=A,ye=S(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t),X!==t)for(;X!==t;)Q.push(X),X=A,ye=S(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t);else Q=t;return Q!==t&&(he=P,Q=oa(Q)),P=Q,P}function Dn(){var P,Q,X;return P=A,Q=_t(),Q!==t?(X=Ot(),X===t&&(X=qe(),X===t&&(X=Ut())),X===t&&(X=null),he=P,P=Lr(Q,X)):(A=P,P=t),P}function nn(){var P,Q,X;return P=A,Q=_t(),Q!==t?(X=Ot(),X===t&&(X=null),he=P,P=br(Q,X)):(A=P,P=t),P}function bn(){var P,Q,X,ye;return P=A,p(),Q=C(),Q!==t?(p(),X=Dn(),X!==t?(p(),ye=C(),ye!==t?(he=P,P=tr(X)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function ps(){var P;return P=mO(),P===t&&(P=sr(),P===t&&(P=dO(),P===t&&(P=Is(),P===t&&(P=ia(),P===t&&(P=sa(),P===t&&(P=hO(),P===t&&(P=uc()))))))),P}function sa(){var P,Q,X;return P=A,n.substr(A,6)===ue?(Q=ue,A+=6):(Q=t,fe===0&&Me(B)),Q!==t?(p(),X=xo(),X!==t?(he=P,P=Ir(X)):(A=P,P=t)):(A=P,P=t),P}function Is(){var P,Q,X,ye,Ue;return P=A,n.substr(A,6)===W?(Q=W,A+=6):(Q=t,fe===0&&Me(T)),Q!==t?(p(),X=C(),X!==t?(ye=L(),ye!==t?(Ue=C(),Ue!==t?(he=P,P=nr(ye)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function ia(){var P,Q,X,ye;return P=A,n.substr(A,6)===de?(Q=de,A+=6):(Q=t,fe===0&&Me(R)),Q!==t?(p(),X=Jt(),X!==t?(p(),ye=Jt(),ye!==t?(p(),Jt(),he=P,P=lc(X,ye)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function sr(){var P,Q,X;return P=A,n.substr(A,4)===be?(Q=be,A+=4):(Q=t,fe===0&&Me(j)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=Ba(X)):(A=P,P=t)):(A=P,P=t),P}function uc(){var P,Q,X;return P=A,n.substr(A,4)===ke?(Q=ke,A+=4):(Q=t,fe===0&&Me(H)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=zo(X)):(A=P,P=t)):(A=P,P=t),P}function hO(){var P,Q,X;return P=A,n.substr(A,4)===Ce?(Q=Ce,A+=4):(Q=t,fe===0&&Me(ee)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=Oo(X)):(A=P,P=t)):(A=P,P=t),P}function dO(){var P,Q,X;return P=A,n.substr(A,4)===Ae?(Q=Ae,A+=4):(Q=t,fe===0&&Me(ne)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=ys(X)):(A=P,P=t)):(A=P,P=t),P}function mO(){var P,Q,X,ye,Ue;if(P=A,n.substr(A,5)===q?(Q=q,A+=5):(Q=t,fe===0&&Me(ge)),Q!==t)if(p(),X=C(),X!==t){if(ye=[],Ue=N(),Ue!==t)for(;Ue!==t;)ye.push(Ue),Ue=N();else ye=t;ye!==t?(Ue=C(),Ue!==t?(he=P,P=Ct(ye)):(A=P,P=t)):(A=P,P=t)}else A=P,P=t;else A=P,P=t;return P}function qu(){var P,Q,X,ye;if(P=A,n.substr(A,2)===Ne?(Q=Ne,A+=2):(Q=t,fe===0&&Me(Fe)),Q!==t){for(X=[],ye=n.charAt(A),In.test(ye)?A++:(ye=t,fe===0&&Me(Be));ye!==t;)X.push(ye),ye=n.charAt(A),In.test(ye)?A++:(ye=t,fe===0&&Me(Be));Q=[Q,X],P=Q}else A=P,P=t;return P}function pO(){var P,Q,X,ye,Ue,mn,ta,ko;if(P=A,n.substr(A,3)===Re?(Q=Re,A+=3):(Q=t,fe===0&&Me(wt)),Q!==t)if(p(),n.charCodeAt(A)===91?(X=h,A++):(X=t,fe===0&&Me(tt)),X!==t)if(p(),ye=xo(),ye!==t){for(Ue=[],mn=A,ta=g(),ta!==t?(ko=xo(),ko!==t?(he=mn,mn=Ai(ye,ko)):(A=mn,mn=t)):(A=mn,mn=t);mn!==t;)Ue.push(mn),mn=A,ta=g(),ta!==t?(ko=xo(),ko!==t?(he=mn,mn=Ai(ye,ko)):(A=mn,mn=t)):(A=mn,mn=t);mn=p(),n.charCodeAt(A)===93?(ta=m,A++):(ta=t,fe===0&&Me(zn)),ta!==t?(he=P,P=yr(ye,Ue)):(A=P,P=t)}else A=P,P=t;else A=P,P=t;else A=P,P=t;return P}function fO(){var P;return P=pO(),P===t&&(P=bn()),P}function xo(){var P,Q,X,ye,Ue;if(P=A,Q=fO(),Q!==t){for(p(),X=[],ye=qu();ye!==t;)X.push(ye),ye=qu();he=P,P=cc(Q)}else A=P,P=t;return P===t&&(P=A,Q=ps(),Q!==t?(p(),n.charCodeAt(A)===36?(X=je,A++):(X=t,fe===0&&Me(Nt)),X!==t?(ye=p(),Ue=xo(),Ue!==t?(he=P,P=$a(Q,Ue)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t)),P}function gO(){var P,Q;return P=A,Q=xo(),Q!==t&&(he=P,Q=hl(Q)),P=Q,P===t&&(P=qu()),P}function bO(){var P;return P=gO(),P}function yO(){var P,Q;return P=A,p(),Q=vO(),Q===t&&(Q=wO(),Q===t&&(Q=OO())),Q!==t?(p(),he=P,P=Ra(Q)):(A=P,P=t),P}function vO(){var P,Q,X;return P=A,n.substr(A,6)===me?(Q=me,A+=6):(Q=t,fe===0&&Me(yn)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=Y(X)):(A=P,P=t)):(A=P,P=t),P}function wO(){var P,Q,X;return P=A,n.substr(A,6)===Ye?(Q=Ye,A+=6):(Q=t,fe===0&&Me(ws)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=J(X)):(A=P,P=t)):(A=P,P=t),P}function OO(){var P,Q;return P=A,n.substr(A,4)===ft?(Q=ft,A+=4):(Q=t,fe===0&&Me(gn)),Q!==t&&(he=P,Q=te()),P=Q,P}function xO(){var P;return P=bO(),P===t&&(P=yO()),P}var kO=function(P){this.type_="atom",this.source_=P,this.location_=Ee()},hc=function(P,Q,X,ye){this.type_="pattern",this.arguments_={alignment:Q,_steps:ye},X!==void 0&&(this.arguments_.seed=X),this.source_=P},PO=function(P,Q,X){this.type_=P,this.arguments_=Q,this.source_=X},SO=function(P,Q){this.type_="element",this.source_=P,this.options_=Q,this.location_=Ee()},Uu=function(P,Q){this.type_="command",this.name_=P,this.options_=Q},Hu=0;if(Te=r(),e.peg$library)return{peg$result:Te,peg$currPos:A,peg$FAILED:t,peg$maxFailExpected:Se,peg$maxFailPos:Oe};if(Te!==t&&A===n.length)return Te;throw Te!==t&&A<n.length&&Me(st()),Ke(Se,Oe<n.length?n.charAt(Oe):null,Oe<n.length?et(Oe,Oe+1):et(Oe,Oe))}typeof BigInt>"u"&&(BigInt=function(n){if(isNaN(n))throw new Error("");return n});const sn=BigInt(0),Mn=BigInt(1),eg=BigInt(2),A2=BigInt(5),Wr=BigInt(10),vpe=2e3,Pt={s:Mn,n:sn,d:Mn};function mc(n,e){try{n=BigInt(n)}catch{throw qc()}return n*e}function Ei(n){return typeof n=="bigint"?n:Math.floor(n)}function Xs(n,e){if(e===sn)throw oA();const t=Object.create(Zs.prototype);t.s=n<sn?-Mn:Mn,n=n<sn?-n:n;const s=lh(n,e);return t.n=n/s,t.d=e/s,t}function ed(n){const e={};let t=n,s=eg,a=A2-Mn;for(;a<=t;){for(;t%s===sn;)t/=s,e[s]=(e[s]||sn)+Mn;a+=Mn+eg*s++}return t!==n?t>1&&(e[t]=(e[t]||sn)+Mn):e[n]=(e[n]||sn)+Mn,e}const La=function(n,e){let t=sn,s=Mn,a=Mn;if(n!=null)if(e!==void 0){if(typeof n=="bigint")t=n;else{if(isNaN(n))throw qc();if(n%1!==0)throw Q7();t=BigInt(n)}if(typeof e=="bigint")s=e;else{if(isNaN(e))throw qc();if(e%1!==0)throw Q7();s=BigInt(e)}a=t*s}else if(typeof n=="object"){if("d"in n&&"n"in n)t=BigInt(n.n),s=BigInt(n.d),"s"in n&&(t*=BigInt(n.s));else if(0 in n)t=BigInt(n[0]),1 in n&&(s=BigInt(n[1]));else if(typeof n=="bigint")t=n;else throw qc();a=t*s}else if(typeof n=="number"){if(isNaN(n))throw qc();if(n<0&&(a=-Mn,n=-n),n%1===0)t=BigInt(n);else if(n>0){let r=1,o=0,i=1,l=1,c=1,u=1e7;for(n>=1&&(r=10**Math.floor(1+Math.log10(n)),n/=r);i<=u&&c<=u;){let h=(o+l)/(i+c);if(n===h){i+c<=u?(t=o+l,s=i+c):c>i?(t=l,s=c):(t=o,s=i);break}else n>h?(o+=l,i+=c):(l+=o,c+=i),i>u?(t=l,s=c):(t=o,s=i)}t=BigInt(t)*BigInt(r),s=BigInt(s)}}else if(typeof n=="string"){let r=0,o=sn,i=sn,l=sn,c=Mn,u=Mn,h=n.replace(/_/g,"").match(/\d+|./g);if(h===null)throw qc();if(h[r]==="-"?(a=-Mn,r++):h[r]==="+"&&r++,h.length===r+1?i=mc(h[r++],a):h[r+1]==="."||h[r]==="."?(h[r]!=="."&&(o=mc(h[r++],a)),r++,(r+1===h.length||h[r+1]==="("&&h[r+3]===")"||h[r+1]==="'"&&h[r+3]==="'")&&(i=mc(h[r],a),c=Wr**BigInt(h[r].length),r++),(h[r]==="("&&h[r+2]===")"||h[r]==="'"&&h[r+2]==="'")&&(l=mc(h[r+1],a),u=Wr**BigInt(h[r+1].length)-Mn,r+=3)):h[r+1]==="/"||h[r+1]===":"?(i=mc(h[r],a),c=mc(h[r+2],Mn),r+=3):h[r+3]==="/"&&h[r+1]===" "&&(o=mc(h[r],a),i=mc(h[r+2],a),c=mc(h[r+4],Mn),r+=5),h.length<=r)s=c*u,a=t=l+s*o+u*i;else throw qc()}else if(typeof n=="bigint")t=n,a=n,s=Mn;else throw qc();if(s===sn)throw oA();Pt.s=a<sn?-Mn:Mn,Pt.n=t<sn?-t:t,Pt.d=s<sn?-s:s};function wpe(n,e,t){let s=Mn;for(;e>sn;n=n*n%t,e>>=Mn)e&Mn&&(s=s*n%t);return s}function Ope(n,e){for(;e%eg===sn;e/=eg);for(;e%A2===sn;e/=A2);if(e===Mn)return sn;let t=Wr%e,s=1;for(;t!==Mn;s++)if(t=t*Wr%e,s>vpe)return sn;return BigInt(s)}function xpe(n,e,t){let s=Mn,a=wpe(Wr,t,e);for(let r=0;r<300;r++){if(s===a)return BigInt(r);s=s*Wr%e,a=a*Wr%e}return 0}function lh(n,e){if(!n)return e;if(!e)return n;for(;;){if(n%=e,!n)return e;if(e%=n,!e)return n}}function Zs(n,e){if(La(n,e),this instanceof Zs)n=lh(Pt.d,Pt.n),this.s=Pt.s,this.n=Pt.n/n,this.d=Pt.d/n;else return Xs(Pt.s*Pt.n,Pt.d)}var oA=function(){return new Error("Division by Zero")},qc=function(){return new Error("Invalid argument")},Q7=function(){return new Error("Parameters must be integer")};Zs.prototype={s:Mn,n:sn,d:Mn,abs:function(){return Xs(this.n,this.d)},neg:function(){return Xs(-this.s*this.n,this.d)},add:function(n,e){return La(n,e),Xs(this.s*this.n*Pt.d+Pt.s*this.d*Pt.n,this.d*Pt.d)},sub:function(n,e){return La(n,e),Xs(this.s*this.n*Pt.d-Pt.s*this.d*Pt.n,this.d*Pt.d)},mul:function(n,e){return La(n,e),Xs(this.s*Pt.s*this.n*Pt.n,this.d*Pt.d)},div:function(n,e){return La(n,e),Xs(this.s*Pt.s*this.n*Pt.d,this.d*Pt.n)},clone:function(){return Xs(this.s*this.n,this.d)},mod:function(n,e){if(n===void 0)return Xs(this.s*this.n%this.d,Mn);if(La(n,e),sn===Pt.n*this.d)throw oA();return Xs(this.s*(Pt.d*this.n)%(Pt.n*this.d),Pt.d*this.d)},gcd:function(n,e){return La(n,e),Xs(lh(Pt.n,this.n)*lh(Pt.d,this.d),Pt.d*this.d)},lcm:function(n,e){return La(n,e),Pt.n===sn&&this.n===sn?Xs(sn,Mn):Xs(Pt.n*this.n,lh(Pt.n,this.n)*lh(Pt.d,this.d))},inverse:function(){return Xs(this.s*this.d,this.n)},pow:function(n,e){if(La(n,e),Pt.d===Mn)return Pt.s<sn?Xs((this.s*this.d)**Pt.n,this.n**Pt.n):Xs((this.s*this.n)**Pt.n,this.d**Pt.n);if(this.s<sn)return null;let t=ed(this.n),s=ed(this.d),a=Mn,r=Mn;for(let o in t)if(o!=="1"){if(o==="0"){a=sn;break}if(t[o]*=Pt.n,t[o]%Pt.d===sn)t[o]/=Pt.d;else return null;a*=BigInt(o)**t[o]}for(let o in s)if(o!=="1"){if(s[o]*=Pt.n,s[o]%Pt.d===sn)s[o]/=Pt.d;else return null;r*=BigInt(o)**s[o]}return Pt.s<sn?Xs(r,a):Xs(a,r)},log:function(n,e){if(La(n,e),this.s<=sn||Pt.s<=sn)return null;const t={},s=ed(Pt.n),a=ed(Pt.d),r=ed(this.n),o=ed(this.d);for(const c in a)s[c]=(s[c]||sn)-a[c];for(const c in o)r[c]=(r[c]||sn)-o[c];for(const c in s)c!=="1"&&(t[c]=!0);for(const c in r)c!=="1"&&(t[c]=!0);let i=null,l=null;for(const c in t){const u=s[c]||sn,h=r[c]||sn;if(u===sn){if(h!==sn)return null;continue}let m=h,f=u;const v=lh(m,f);if(m/=v,f/=v,i===null&&l===null)i=m,l=f;else if(m*l!==i*f)return null}return i!==null&&l!==null?Xs(i,l):null},equals:function(n,e){return La(n,e),this.s*this.n*Pt.d===Pt.s*Pt.n*this.d},lt:function(n,e){return La(n,e),this.s*this.n*Pt.d<Pt.s*Pt.n*this.d},lte:function(n,e){return La(n,e),this.s*this.n*Pt.d<=Pt.s*Pt.n*this.d},gt:function(n,e){return La(n,e),this.s*this.n*Pt.d>Pt.s*Pt.n*this.d},gte:function(n,e){return La(n,e),this.s*this.n*Pt.d>=Pt.s*Pt.n*this.d},compare:function(n,e){La(n,e);let t=this.s*this.n*Pt.d-Pt.s*Pt.n*this.d;return(sn<t)-(t<sn)},ceil:function(n){return n=Wr**BigInt(n||0),Xs(Ei(this.s*n*this.n/this.d)+(n*this.n%this.d>sn&&this.s>=sn?Mn:sn),n)},floor:function(n){return n=Wr**BigInt(n||0),Xs(Ei(this.s*n*this.n/this.d)-(n*this.n%this.d>sn&&this.s<sn?Mn:sn),n)},round:function(n){return n=Wr**BigInt(n||0),Xs(Ei(this.s*n*this.n/this.d)+this.s*((this.s>=sn?Mn:sn)+eg*(n*this.n%this.d)>this.d?Mn:sn),n)},roundTo:function(n,e){La(n,e);const t=this.n*Pt.d,s=this.d*Pt.n,a=t%s;let r=Ei(t/s);return a+a>=s&&r++,Xs(this.s*r*Pt.n,Pt.d)},divisible:function(n,e){return La(n,e),!(!(Pt.n*this.d)||this.n*Pt.d%(Pt.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(n){let e=this.n,t=this.d;n=n||15;let s=Ope(e,t),a=xpe(e,t,s),r=this.s<sn?"-":"";if(r+=Ei(e/t),e%=t,e*=Wr,e&&(r+="."),s){for(let o=a;o--;)r+=Ei(e/t),e%=t,e*=Wr;r+="(";for(let o=s;o--;)r+=Ei(e/t),e%=t,e*=Wr;r+=")"}else for(let o=n;e&&o--;)r+=Ei(e/t),e%=t,e*=Wr;return r},toFraction:function(n){let e=this.n,t=this.d,s=this.s<sn?"-":"";if(t===Mn)s+=e;else{let a=Ei(e/t);n&&a>sn&&(s+=a,s+=" ",e%=t),s+=e,s+="/",s+=t}return s},toLatex:function(n){let e=this.n,t=this.d,s=this.s<sn?"-":"";if(t===Mn)s+=e;else{let a=Ei(e/t);n&&a>sn&&(s+=a,e%=t),s+="\\frac{",s+=e,s+="}{",s+=t,s+="}"}return s},toContinued:function(){let n=this.n,e=this.d,t=[];do{t.push(Ei(n/e));let s=n%e;n=e,e=s}while(n!==Mn);return t},simplify:function(n){const e=BigInt(1/(n||.001)|0),t=this.abs(),s=t.toContinued();for(let a=1;a<s.length;a++){let r=Xs(s[a-1],Mn);for(let i=a-2;i>=0;i--)r=r.inverse().add(s[i]);let o=r.sub(t);if(o.n*e<o.d)return r.mul(this.s)}return this}};let kpe=class gc{constructor(e,t){this.begin=iu(e),this.end=iu(t)}get spanCycles(){const e=[];var t=this.begin;const s=this.end,a=s.sam();if(t.equals(s))return[new gc(t,s)];for(;s.gt(t);){if(t.sam().equals(a)){e.push(new gc(t,this.end));break}const r=t.nextSam();e.push(new gc(t,r)),t=r}return e}get duration(){return this.end.sub(this.begin)}cycleArc(){const e=this.begin.cyclePos(),t=e.add(this.duration);return new gc(e,t)}withTime(e){return new gc(e(this.begin),e(this.end))}withEnd(e){return new gc(this.begin,e(this.end))}withCycle(e){const t=this.begin.sam(),s=t.add(e(this.begin.sub(t))),a=t.add(e(this.end.sub(t)));return new gc(s,a)}intersection(e){const t=this.begin.max(e.begin),s=this.end.min(e.end);if(!t.gt(s)&&!(t.equals(s)&&(t.equals(this.end)&&this.begin.lt(this.end)||t.equals(e.end)&&e.begin.lt(e.end))))return new gc(t,s)}intersection_e(e){const t=this.intersection(e);if(t==null)throw"TimeSpans do not intersect";return t}midpoint(){return this.begin.add(this.duration.div(iu(2)))}equals(e){return this.begin.equals(e.begin)&&this.end.equals(e.end)}show(){return this.begin.show()+" → "+this.end.show()}};const Ppe=n=>n.filter(e=>e!=null);Zs.prototype.sam=function(){return this.floor()};Zs.prototype.nextSam=function(){return this.sam().add(1)};Zs.prototype.wholeCycle=function(){return new kpe(this.sam(),this.nextSam())};Zs.prototype.cyclePos=function(){return this.sub(this.sam())};Zs.prototype.lt=function(n){return this.compare(n)<0};Zs.prototype.gt=function(n){return this.compare(n)>0};Zs.prototype.lte=function(n){return this.compare(n)<=0};Zs.prototype.gte=function(n){return this.compare(n)>=0};Zs.prototype.eq=function(n){return this.compare(n)==0};Zs.prototype.ne=function(n){return this.compare(n)!=0};Zs.prototype.max=function(n){return this.gt(n)?this:n};Zs.prototype.maximum=function(...n){return n=n.map(e=>new Zs(e)),n.reduce((e,t)=>t.max(e),this)};Zs.prototype.min=function(n){return this.lt(n)?this:n};Zs.prototype.mulmaybe=function(n){return n!==void 0?this.mul(n):void 0};Zs.prototype.divmaybe=function(n){return n!==void 0?this.div(n):void 0};Zs.prototype.addmaybe=function(n){return n!==void 0?this.add(n):void 0};Zs.prototype.submaybe=function(n){return n!==void 0?this.sub(n):void 0};Zs.prototype.show=function(){return this.s*this.n+"/"+this.d};Zs.prototype.or=function(n){return this.eq(0)?n:this};const iu=n=>Zs(n),I0=(...n)=>{if(n=Ppe(n),n.length===0)return;const e=n.pop();return n.reduce((t,s)=>t===void 0||s===void 0?void 0:t.lcm(s),e)};iu._original=Zs;const qR=3e-4,Spe=(n,e)=>(t,s)=>{var o;const a=(o=n.source_[s].options_)==null?void 0:o.ops,r=t.__steps_source;if(a)for(const i of a)switch(i.type_){case"stretch":{const l=["fast","slow"],{type:c,amount:u}=i.arguments_;if(!l.includes(c))throw new Error(`mini: stretch: type must be one of ${l.join("|")} but got ${c}`);t=g0(t)[c](e(u));break}case"replicate":{const{amount:l}=i.arguments_;t=g0(t),t=t._repeatCycles(l)._fast(l);break}case"bjorklund":{i.arguments_.rotation?t=t.euclidRot(e(i.arguments_.pulse),e(i.arguments_.step),e(i.arguments_.rotation)):t=t.euclid(e(i.arguments_.pulse),e(i.arguments_.step));break}case"degradeBy":{t=g0(t)._degradeByWith(FN.early(qR*i.arguments_.seed),i.arguments_.amount??.5);break}case"tail":{const l=e(i.arguments_.element);t=t.fmap(c=>u=>Array.isArray(c)?[...c,u]:[c,u]).appLeft(l);break}case"range":{const l=e(i.arguments_.element);t=g0(t);const c=(u,h,m=1)=>Array.from({length:Math.abs(h-u)/m+1},(f,v)=>u<h?u+v*m:u-v*m);t=((u,h)=>u.squeezeBind(m=>h.bind(f=>TN(...c(m,f)))))(t,l);break}default:console.warn(`operator "${i.type_}" not implemented`)}return t.__steps_source=t.__steps_source||r,t};function UR(n,e,t,s=0){t==null||t(n);const a=r=>UR(r,e,t,s);switch(n.type_){case"pattern":{const r=n.source_.map(c=>a(c)).map(Spe(n,a)),o=n.arguments_.alignment,i=r.filter(c=>c.__steps_source);let l;switch(o){case"stack":{l=mf(...r),i.length&&(l._steps=I0(...i.map(c=>iu(c._steps))));break}case"polymeter_slowcat":{l=mf(...r.map(c=>c._slow(c.__weight))),i.length&&(l._steps=I0(...i.map(c=>iu(c._steps))));break}case"polymeter":{const c=n.arguments_.stepsPerCycle?a(n.arguments_.stepsPerCycle).fmap(h=>hp(h)):xh(hp(r.length>0?r[0].__weight:1)),u=r.map(h=>h.fast(c.fmap(m=>m.div(h.__weight))));l=mf(...u);break}case"rand":{l=UJ(FN.early(qR*n.arguments_.seed).segment(1),r),i.length&&(l._steps=I0(...i.map(c=>iu(c._steps))));break}case"feet":{l=TN(...r);break}default:{if(n.source_.some(c=>{var u;return!!((u=c.options_)!=null&&u.weight)})){const c=n.source_.reduce((u,h)=>{var m;return u.add(((m=h.options_)==null?void 0:m.weight)||hp(1))},hp(0));l=WJ(...n.source_.map((u,h)=>{var m;return[((m=u.options_)==null?void 0:m.weight)||hp(1),r[h]]})),l.__weight=c,l._steps=c,i.length&&(l._steps=l._steps.mul(I0(...i.map(u=>iu(u._steps)))))}else l=qJ(...r),l._steps=r.length;n.arguments_._steps&&(l.__steps_source=!0)}}return i.length&&(l.__steps_source=!0),l}case"element":return a(n.source_);case"atom":{if(n.source_==="~"||n.source_==="-")return Bf;if(!n.location_)return console.warn("no location for",n),n.source_;const r=isNaN(Number(n.source_))?n.source_:Number(n.source_);if(s===-1)return xh(r);const[o,i]=HR(e,n,s);return xh(r).withLoc(o,i)}case"stretch":return a(n.source_).slow(a(n.arguments_.amount));default:return console.warn(`node type "${n.type_}" not implemented -> returning silence`),Bf}}const HR=(n,e,t=0)=>{const{start:s,end:a}=e.location_,r=n==null?void 0:n.split("").slice(s.offset,a.offset).join(""),[o=0,i=0]=r?r.split(e.source_).map(l=>l.split("").filter(c=>c===" ").length):[];return[s.offset+o+t,a.offset-i+t]},Cpe=(n,e=0,t=n)=>{try{return ype(n)}catch(s){const a=[s.location.start.offset+e,s.location.end.offset+e],r=t.slice(0,a[0]).split(`
`).length;throw new Error(`[mini] parse error at line ${r}: ${s.message}`)}},Mpe=(n,e,t)=>{const s=Cpe(n,e,t);let a=[];return UR(s,n,r=>{r.type_==="atom"&&a.push(r)},-1),a},YR=(n,e=0,t)=>Mpe(n,e,t).map(s=>HR(n,s,e));var Ape=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],KR=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],Epe="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",JR="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",dx={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},mx="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Dpe={5:mx,"5module":mx+" export import",6:mx+" const class extends export import super"},Tpe=/^in(stanceof)?$/,Fpe=new RegExp("["+JR+"]"),Npe=new RegExp("["+JR+Epe+"]");function E2(n,e){for(var t=65536,s=0;s<e.length;s+=2){if(t+=e[s],t>n)return!1;if(t+=e[s+1],t>=n)return!0}return!1}function zl(n,e){return n<65?n===36:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&Fpe.test(String.fromCharCode(n)):e===!1?!1:E2(n,KR)}function Du(n,e){return n<48?n===36:n<58?!0:n<65?!1:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&Npe.test(String.fromCharCode(n)):e===!1?!1:E2(n,KR)||E2(n,Ape)}var ts=function(e,t){t===void 0&&(t={}),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function Go(n,e){return new ts(n,{beforeExpr:!0,binop:e})}var Xo={beforeExpr:!0},Qr={startsExpr:!0},iA={};function Kn(n,e){return e===void 0&&(e={}),e.keyword=n,iA[n]=new ts(n,e)}var ae={num:new ts("num",Qr),regexp:new ts("regexp",Qr),string:new ts("string",Qr),name:new ts("name",Qr),privateId:new ts("privateId",Qr),eof:new ts("eof"),bracketL:new ts("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ts("]"),braceL:new ts("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ts("}"),parenL:new ts("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ts(")"),comma:new ts(",",Xo),semi:new ts(";",Xo),colon:new ts(":",Xo),dot:new ts("."),question:new ts("?",Xo),questionDot:new ts("?."),arrow:new ts("=>",Xo),template:new ts("template"),invalidTemplate:new ts("invalidTemplate"),ellipsis:new ts("...",Xo),backQuote:new ts("`",Qr),dollarBraceL:new ts("${",{beforeExpr:!0,startsExpr:!0}),eq:new ts("=",{beforeExpr:!0,isAssign:!0}),assign:new ts("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ts("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ts("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Go("||",1),logicalAND:Go("&&",2),bitwiseOR:Go("|",3),bitwiseXOR:Go("^",4),bitwiseAND:Go("&",5),equality:Go("==/!=/===/!==",6),relational:Go("</>/<=/>=",7),bitShift:Go("<</>>/>>>",8),plusMin:new ts("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Go("%",10),star:Go("*",10),slash:Go("/",10),starstar:new ts("**",{beforeExpr:!0}),coalesce:Go("??",1),_break:Kn("break"),_case:Kn("case",Xo),_catch:Kn("catch"),_continue:Kn("continue"),_debugger:Kn("debugger"),_default:Kn("default",Xo),_do:Kn("do",{isLoop:!0,beforeExpr:!0}),_else:Kn("else",Xo),_finally:Kn("finally"),_for:Kn("for",{isLoop:!0}),_function:Kn("function",Qr),_if:Kn("if"),_return:Kn("return",Xo),_switch:Kn("switch"),_throw:Kn("throw",Xo),_try:Kn("try"),_var:Kn("var"),_const:Kn("const"),_while:Kn("while",{isLoop:!0}),_with:Kn("with"),_new:Kn("new",{beforeExpr:!0,startsExpr:!0}),_this:Kn("this",Qr),_super:Kn("super",Qr),_class:Kn("class",Qr),_extends:Kn("extends",Xo),_export:Kn("export"),_import:Kn("import",Qr),_null:Kn("null",Qr),_true:Kn("true",Qr),_false:Kn("false",Qr),_in:Kn("in",{beforeExpr:!0,binop:7}),_instanceof:Kn("instanceof",{beforeExpr:!0,binop:7}),_typeof:Kn("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Kn("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Kn("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},fo=/\r\n?|\n|\u2028|\u2029/,Bpe=new RegExp(fo.source,"g");function Qm(n){return n===10||n===13||n===8232||n===8233}function e_(n,e,t){t===void 0&&(t=n.length);for(var s=e;s<t;s++){var a=n.charCodeAt(s);if(Qm(a))return s<t-1&&a===13&&n.charCodeAt(s+1)===10?s+2:s+1}return-1}var t_=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,lr=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,n_=Object.prototype,$pe=n_.hasOwnProperty,Rpe=n_.toString,Vm=Object.hasOwn||(function(n,e){return $pe.call(n,e)}),V7=Array.isArray||(function(n){return Rpe.call(n)==="[object Array]"}),j7=Object.create(null);function lu(n){return j7[n]||(j7[n]=new RegExp("^(?:"+n.replace(/ /g,"|")+")$"))}function Fc(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}var _pe=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,tg=function(e,t){this.line=e,this.column=t};tg.prototype.offset=function(e){return new tg(this.line,this.column+e)};var iw=function(e,t,s){this.start=t,this.end=s,e.sourceFile!==null&&(this.source=e.sourceFile)};function s_(n,e){for(var t=1,s=0;;){var a=e_(n,s,e);if(a<0)return new tg(t,e-s);++t,s=a}}var D2={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Z7=!1;function Lpe(n){var e={};for(var t in D2)e[t]=n&&Vm(n,t)?n[t]:D2[t];if(e.ecmaVersion==="latest"?e.ecmaVersion=1e8:e.ecmaVersion==null?(!Z7&&typeof console=="object"&&console.warn&&(Z7=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),e.allowReserved==null&&(e.allowReserved=e.ecmaVersion<5),(!n||n.allowHashBang==null)&&(e.allowHashBang=e.ecmaVersion>=14),V7(e.onToken)){var s=e.onToken;e.onToken=function(a){return s.push(a)}}return V7(e.onComment)&&(e.onComment=Ipe(e,e.onComment)),e}function Ipe(n,e){return function(t,s,a,r,o,i){var l={type:t?"Block":"Line",value:s,start:a,end:r};n.locations&&(l.loc=new iw(this,o,i)),n.ranges&&(l.range=[a,r]),e.push(l)}}var ng=1,jm=2,lA=4,a_=8,cA=16,r_=32,lw=64,o_=128,Hh=256,zg=512,cw=ng|jm|Hh;function uA(n,e){return jm|(n?lA:0)|(e?a_:0)}var Oy=0,hA=1,Vc=2,i_=3,l_=4,c_=5,Da=function(e,t,s){this.options=e=Lpe(e),this.sourceFile=e.sourceFile,this.keywords=lu(Dpe[e.ecmaVersion>=6?6:e.sourceType==="module"?"5module":5]);var a="";e.allowReserved!==!0&&(a=dx[e.ecmaVersion>=6?6:e.ecmaVersion===5?5:3],e.sourceType==="module"&&(a+=" await")),this.reservedWords=lu(a);var r=(a?a+" ":"")+dx.strict;this.reservedWordsStrict=lu(r),this.reservedWordsStrictBind=lu(r+" "+dx.strictBind),this.input=String(t),this.containsEsc=!1,s?(this.pos=s,this.lineStart=this.input.lastIndexOf(`
`,s-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(fo).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=ae.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=e.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&e.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(ng),this.regexpState=null,this.privateNameStack=[]},Jl={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Da.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)};Jl.inFunction.get=function(){return(this.currentVarScope().flags&jm)>0};Jl.inGenerator.get=function(){return(this.currentVarScope().flags&a_)>0};Jl.inAsync.get=function(){return(this.currentVarScope().flags&lA)>0};Jl.canAwait.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var e=this.scopeStack[n],t=e.flags;if(t&(Hh|zg))return!1;if(t&jm)return(t&lA)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};Jl.allowSuper.get=function(){var n=this.currentThisScope(),e=n.flags;return(e&lw)>0||this.options.allowSuperOutsideMethod};Jl.allowDirectSuper.get=function(){return(this.currentThisScope().flags&o_)>0};Jl.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};Jl.allowNewDotTarget.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var e=this.scopeStack[n],t=e.flags;if(t&(Hh|zg)||t&jm&&!(t&cA))return!0}return!1};Jl.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Hh)>0};Da.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var s=this,a=0;a<e.length;a++)s=e[a](s);return s};Da.parse=function(e,t){return new this(t,e).parse()};Da.parseExpressionAt=function(e,t,s){var a=new this(s,e,t);return a.nextToken(),a.parseExpression()};Da.tokenizer=function(e,t){return new this(t,e)};Object.defineProperties(Da.prototype,Jl);var Nr=Da.prototype,Qpe=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Nr.strictDirective=function(n){if(this.options.ecmaVersion<5)return!1;for(;;){lr.lastIndex=n,n+=lr.exec(this.input)[0].length;var e=Qpe.exec(this.input.slice(n));if(!e)return!1;if((e[1]||e[2])==="use strict"){lr.lastIndex=n+e[0].length;var t=lr.exec(this.input),s=t.index+t[0].length,a=this.input.charAt(s);return a===";"||a==="}"||fo.test(t[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(a)||a==="!"&&this.input.charAt(s+1)==="=")}n+=e[0].length,lr.lastIndex=n,n+=lr.exec(this.input)[0].length,this.input[n]===";"&&n++}};Nr.eat=function(n){return this.type===n?(this.next(),!0):!1};Nr.isContextual=function(n){return this.type===ae.name&&this.value===n&&!this.containsEsc};Nr.eatContextual=function(n){return this.isContextual(n)?(this.next(),!0):!1};Nr.expectContextual=function(n){this.eatContextual(n)||this.unexpected()};Nr.canInsertSemicolon=function(){return this.type===ae.eof||this.type===ae.braceR||fo.test(this.input.slice(this.lastTokEnd,this.start))};Nr.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Nr.semicolon=function(){!this.eat(ae.semi)&&!this.insertSemicolon()&&this.unexpected()};Nr.afterTrailingComma=function(n,e){if(this.type===n)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0};Nr.expect=function(n){this.eat(n)||this.unexpected()};Nr.unexpected=function(n){this.raise(n??this.start,"Unexpected token")};var uw=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Nr.checkPatternErrors=function(n,e){if(n){n.trailingComma>-1&&this.raiseRecoverable(n.trailingComma,"Comma is not permitted after the rest element");var t=e?n.parenthesizedAssign:n.parenthesizedBind;t>-1&&this.raiseRecoverable(t,e?"Assigning to rvalue":"Parenthesized pattern")}};Nr.checkExpressionErrors=function(n,e){if(!n)return!1;var t=n.shorthandAssign,s=n.doubleProto;if(!e)return t>=0||s>=0;t>=0&&this.raise(t,"Shorthand property assignments are valid only in destructuring patterns"),s>=0&&this.raiseRecoverable(s,"Redefinition of __proto__ property")};Nr.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Nr.isSimpleAssignTarget=function(n){return n.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(n.expression):n.type==="Identifier"||n.type==="MemberExpression"};var Ht=Da.prototype;Ht.parseTopLevel=function(n){var e=Object.create(null);for(n.body||(n.body=[]);this.type!==ae.eof;){var t=this.parseStatement(null,!0,e);n.body.push(t)}if(this.inModule)for(var s=0,a=Object.keys(this.undefinedExports);s<a.length;s+=1){var r=a[s];this.raiseRecoverable(this.undefinedExports[r].start,"Export '"+r+"' is not defined")}return this.adaptDirectivePrologue(n.body),this.next(),n.sourceType=this.options.sourceType,this.finishNode(n,"Program")};var dA={kind:"loop"},Vpe={kind:"switch"};Ht.isLet=function(n){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;lr.lastIndex=this.pos;var e=lr.exec(this.input),t=this.pos+e[0].length,s=this.input.charCodeAt(t);if(s===91||s===92)return!0;if(n)return!1;if(s===123||s>55295&&s<56320)return!0;if(zl(s,!0)){for(var a=t+1;Du(s=this.input.charCodeAt(a),!0);)++a;if(s===92||s>55295&&s<56320)return!0;var r=this.input.slice(t,a);if(!Tpe.test(r))return!0}return!1};Ht.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;lr.lastIndex=this.pos;var n=lr.exec(this.input),e=this.pos+n[0].length,t;return!fo.test(this.input.slice(this.pos,e))&&this.input.slice(e,e+8)==="function"&&(e+8===this.input.length||!(Du(t=this.input.charCodeAt(e+8))||t>55295&&t<56320))};Ht.isUsingKeyword=function(n,e){if(this.options.ecmaVersion<17||!this.isContextual(n?"await":"using"))return!1;lr.lastIndex=this.pos;var t=lr.exec(this.input),s=this.pos+t[0].length;if(fo.test(this.input.slice(this.pos,s)))return!1;if(n){var a=s+5,r;if(this.input.slice(s,a)!=="using"||a===this.input.length||Du(r=this.input.charCodeAt(a))||r>55295&&r<56320)return!1;lr.lastIndex=a;var o=lr.exec(this.input);if(o&&fo.test(this.input.slice(a,a+o[0].length)))return!1}if(e){var i=s+2,l;if(this.input.slice(s,i)==="of"&&(i===this.input.length||!Du(l=this.input.charCodeAt(i))&&!(l>55295&&l<56320)))return!1}var c=this.input.charCodeAt(s);return zl(c,!0)||c===92};Ht.isAwaitUsing=function(n){return this.isUsingKeyword(!0,n)};Ht.isUsing=function(n){return this.isUsingKeyword(!1,n)};Ht.parseStatement=function(n,e,t){var s=this.type,a=this.startNode(),r;switch(this.isLet(n)&&(s=ae._var,r="let"),s){case ae._break:case ae._continue:return this.parseBreakContinueStatement(a,s.keyword);case ae._debugger:return this.parseDebuggerStatement(a);case ae._do:return this.parseDoStatement(a);case ae._for:return this.parseForStatement(a);case ae._function:return n&&(this.strict||n!=="if"&&n!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(a,!1,!n);case ae._class:return n&&this.unexpected(),this.parseClass(a,!0);case ae._if:return this.parseIfStatement(a);case ae._return:return this.parseReturnStatement(a);case ae._switch:return this.parseSwitchStatement(a);case ae._throw:return this.parseThrowStatement(a);case ae._try:return this.parseTryStatement(a);case ae._const:case ae._var:return r=r||this.value,n&&r!=="var"&&this.unexpected(),this.parseVarStatement(a,r);case ae._while:return this.parseWhileStatement(a);case ae._with:return this.parseWithStatement(a);case ae.braceL:return this.parseBlock(!0,a);case ae.semi:return this.parseEmptyStatement(a);case ae._export:case ae._import:if(this.options.ecmaVersion>10&&s===ae._import){lr.lastIndex=this.pos;var o=lr.exec(this.input),i=this.pos+o[0].length,l=this.input.charCodeAt(i);if(l===40||l===46)return this.parseExpressionStatement(a,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),s===ae._import?this.parseImport(a):this.parseExport(a,t);default:if(this.isAsyncFunction())return n&&this.unexpected(),this.next(),this.parseFunctionStatement(a,!0,!n);var c=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(c)return e&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),c==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(a,!1,c),this.semicolon(),this.finishNode(a,"VariableDeclaration");var u=this.value,h=this.parseExpression();return s===ae.name&&h.type==="Identifier"&&this.eat(ae.colon)?this.parseLabeledStatement(a,u,h,n):this.parseExpressionStatement(a,h)}};Ht.parseBreakContinueStatement=function(n,e){var t=e==="break";this.next(),this.eat(ae.semi)||this.insertSemicolon()?n.label=null:this.type!==ae.name?this.unexpected():(n.label=this.parseIdent(),this.semicolon());for(var s=0;s<this.labels.length;++s){var a=this.labels[s];if((n.label==null||a.name===n.label.name)&&(a.kind!=null&&(t||a.kind==="loop")||n.label&&t))break}return s===this.labels.length&&this.raise(n.start,"Unsyntactic "+e),this.finishNode(n,t?"BreakStatement":"ContinueStatement")};Ht.parseDebuggerStatement=function(n){return this.next(),this.semicolon(),this.finishNode(n,"DebuggerStatement")};Ht.parseDoStatement=function(n){return this.next(),this.labels.push(dA),n.body=this.parseStatement("do"),this.labels.pop(),this.expect(ae._while),n.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(ae.semi):this.semicolon(),this.finishNode(n,"DoWhileStatement")};Ht.parseForStatement=function(n){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(dA),this.enterScope(0),this.expect(ae.parenL),this.type===ae.semi)return e>-1&&this.unexpected(e),this.parseFor(n,null);var t=this.isLet();if(this.type===ae._var||this.type===ae._const||t){var s=this.startNode(),a=t?"let":this.value;return this.next(),this.parseVar(s,!0,a),this.finishNode(s,"VariableDeclaration"),this.parseForAfterInit(n,s,e)}var r=this.isContextual("let"),o=!1,i=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(i){var l=this.startNode();return this.next(),i==="await using"&&this.next(),this.parseVar(l,!0,i),this.finishNode(l,"VariableDeclaration"),this.parseForAfterInit(n,l,e)}var c=this.containsEsc,u=new uw,h=this.start,m=e>-1?this.parseExprSubscripts(u,"await"):this.parseExpression(!0,u);return this.type===ae._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(e>-1?(this.type===ae._in&&this.unexpected(e),n.await=!0):o&&this.options.ecmaVersion>=8&&(m.start===h&&!c&&m.type==="Identifier"&&m.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(n.await=!1)),r&&o&&this.raise(m.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(m,!1,u),this.checkLValPattern(m),this.parseForIn(n,m)):(this.checkExpressionErrors(u,!0),e>-1&&this.unexpected(e),this.parseFor(n,m))};Ht.parseForAfterInit=function(n,e,t){return(this.type===ae._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&e.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===ae._in?t>-1&&this.unexpected(t):n.await=t>-1),this.parseForIn(n,e)):(t>-1&&this.unexpected(t),this.parseFor(n,e))};Ht.parseFunctionStatement=function(n,e,t){return this.next(),this.parseFunction(n,kf|(t?0:T2),!1,e)};Ht.parseIfStatement=function(n){return this.next(),n.test=this.parseParenExpression(),n.consequent=this.parseStatement("if"),n.alternate=this.eat(ae._else)?this.parseStatement("if"):null,this.finishNode(n,"IfStatement")};Ht.parseReturnStatement=function(n){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(ae.semi)||this.insertSemicolon()?n.argument=null:(n.argument=this.parseExpression(),this.semicolon()),this.finishNode(n,"ReturnStatement")};Ht.parseSwitchStatement=function(n){this.next(),n.discriminant=this.parseParenExpression(),n.cases=[],this.expect(ae.braceL),this.labels.push(Vpe),this.enterScope(0);for(var e,t=!1;this.type!==ae.braceR;)if(this.type===ae._case||this.type===ae._default){var s=this.type===ae._case;e&&this.finishNode(e,"SwitchCase"),n.cases.push(e=this.startNode()),e.consequent=[],this.next(),s?e.test=this.parseExpression():(t&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),t=!0,e.test=null),this.expect(ae.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(n,"SwitchStatement")};Ht.parseThrowStatement=function(n){return this.next(),fo.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),n.argument=this.parseExpression(),this.semicolon(),this.finishNode(n,"ThrowStatement")};var jpe=[];Ht.parseCatchClauseParam=function(){var n=this.parseBindingAtom(),e=n.type==="Identifier";return this.enterScope(e?r_:0),this.checkLValPattern(n,e?l_:Vc),this.expect(ae.parenR),n};Ht.parseTryStatement=function(n){if(this.next(),n.block=this.parseBlock(),n.handler=null,this.type===ae._catch){var e=this.startNode();this.next(),this.eat(ae.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),n.handler=this.finishNode(e,"CatchClause")}return n.finalizer=this.eat(ae._finally)?this.parseBlock():null,!n.handler&&!n.finalizer&&this.raise(n.start,"Missing catch or finally clause"),this.finishNode(n,"TryStatement")};Ht.parseVarStatement=function(n,e,t){return this.next(),this.parseVar(n,!1,e,t),this.semicolon(),this.finishNode(n,"VariableDeclaration")};Ht.parseWhileStatement=function(n){return this.next(),n.test=this.parseParenExpression(),this.labels.push(dA),n.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(n,"WhileStatement")};Ht.parseWithStatement=function(n){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),n.object=this.parseParenExpression(),n.body=this.parseStatement("with"),this.finishNode(n,"WithStatement")};Ht.parseEmptyStatement=function(n){return this.next(),this.finishNode(n,"EmptyStatement")};Ht.parseLabeledStatement=function(n,e,t,s){for(var a=0,r=this.labels;a<r.length;a+=1){var o=r[a];o.name===e&&this.raise(t.start,"Label '"+e+"' is already declared")}for(var i=this.type.isLoop?"loop":this.type===ae._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===n.start)c.statementStart=this.start,c.kind=i;else break}return this.labels.push({name:e,kind:i,statementStart:this.start}),n.body=this.parseStatement(s?s.indexOf("label")===-1?s+"label":s:"label"),this.labels.pop(),n.label=t,this.finishNode(n,"LabeledStatement")};Ht.parseExpressionStatement=function(n,e){return n.expression=e,this.semicolon(),this.finishNode(n,"ExpressionStatement")};Ht.parseBlock=function(n,e,t){for(n===void 0&&(n=!0),e===void 0&&(e=this.startNode()),e.body=[],this.expect(ae.braceL),n&&this.enterScope(0);this.type!==ae.braceR;){var s=this.parseStatement(null);e.body.push(s)}return t&&(this.strict=!1),this.next(),n&&this.exitScope(),this.finishNode(e,"BlockStatement")};Ht.parseFor=function(n,e){return n.init=e,this.expect(ae.semi),n.test=this.type===ae.semi?null:this.parseExpression(),this.expect(ae.semi),n.update=this.type===ae.parenR?null:this.parseExpression(),this.expect(ae.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,"ForStatement")};Ht.parseForIn=function(n,e){var t=this.type===ae._in;return this.next(),e.type==="VariableDeclaration"&&e.declarations[0].init!=null&&(!t||this.options.ecmaVersion<8||this.strict||e.kind!=="var"||e.declarations[0].id.type!=="Identifier")&&this.raise(e.start,(t?"for-in":"for-of")+" loop variable declaration may not have an initializer"),n.left=e,n.right=t?this.parseExpression():this.parseMaybeAssign(),this.expect(ae.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,t?"ForInStatement":"ForOfStatement")};Ht.parseVar=function(n,e,t,s){for(n.declarations=[],n.kind=t;;){var a=this.startNode();if(this.parseVarId(a,t),this.eat(ae.eq)?a.init=this.parseMaybeAssign(e):!s&&t==="const"&&!(this.type===ae._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!s&&(t==="using"||t==="await using")&&this.options.ecmaVersion>=17&&this.type!==ae._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+t+" declaration"):!s&&a.id.type!=="Identifier"&&!(e&&(this.type===ae._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):a.init=null,n.declarations.push(this.finishNode(a,"VariableDeclarator")),!this.eat(ae.comma))break}return n};Ht.parseVarId=function(n,e){n.id=e==="using"||e==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(n.id,e==="var"?hA:Vc,!1)};var kf=1,T2=2,u_=4;Ht.parseFunction=function(n,e,t,s,a){this.initFunction(n),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!s)&&(this.type===ae.star&&e&T2&&this.unexpected(),n.generator=this.eat(ae.star)),this.options.ecmaVersion>=8&&(n.async=!!s),e&kf&&(n.id=e&u_&&this.type!==ae.name?null:this.parseIdent(),n.id&&!(e&T2)&&this.checkLValSimple(n.id,this.strict||n.generator||n.async?this.treatFunctionsAsVar?hA:Vc:i_));var r=this.yieldPos,o=this.awaitPos,i=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(uA(n.async,n.generator)),e&kf||(n.id=this.type===ae.name?this.parseIdent():null),this.parseFunctionParams(n),this.parseFunctionBody(n,t,!1,a),this.yieldPos=r,this.awaitPos=o,this.awaitIdentPos=i,this.finishNode(n,e&kf?"FunctionDeclaration":"FunctionExpression")};Ht.parseFunctionParams=function(n){this.expect(ae.parenL),n.params=this.parseBindingList(ae.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Ht.parseClass=function(n,e){this.next();var t=this.strict;this.strict=!0,this.parseClassId(n,e),this.parseClassSuper(n);var s=this.enterClassBody(),a=this.startNode(),r=!1;for(a.body=[],this.expect(ae.braceL);this.type!==ae.braceR;){var o=this.parseClassElement(n.superClass!==null);o&&(a.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(r&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),r=!0):o.key&&o.key.type==="PrivateIdentifier"&&Zpe(s,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=t,this.next(),n.body=this.finishNode(a,"ClassBody"),this.exitClassBody(),this.finishNode(n,e?"ClassDeclaration":"ClassExpression")};Ht.parseClassElement=function(n){if(this.eat(ae.semi))return null;var e=this.options.ecmaVersion,t=this.startNode(),s="",a=!1,r=!1,o="method",i=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(ae.braceL))return this.parseClassStaticBlock(t),t;this.isClassElementNameStart()||this.type===ae.star?i=!0:s="static"}if(t.static=i,!s&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===ae.star)&&!this.canInsertSemicolon()?r=!0:s="async"),!s&&(e>=9||!r)&&this.eat(ae.star)&&(a=!0),!s&&!r&&!a){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:s=l)}if(s?(t.computed=!1,t.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),t.key.name=s,this.finishNode(t.key,"Identifier")):this.parseClassElementName(t),e<13||this.type===ae.parenL||o!=="method"||a||r){var c=!t.static&&xy(t,"constructor"),u=c&&n;c&&o!=="method"&&this.raise(t.key.start,"Constructor can't have get/set modifier"),t.kind=c?"constructor":o,this.parseClassMethod(t,a,r,u)}else this.parseClassField(t);return t};Ht.isClassElementNameStart=function(){return this.type===ae.name||this.type===ae.privateId||this.type===ae.num||this.type===ae.string||this.type===ae.bracketL||this.type.keyword};Ht.parseClassElementName=function(n){this.type===ae.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),n.computed=!1,n.key=this.parsePrivateIdent()):this.parsePropertyName(n)};Ht.parseClassMethod=function(n,e,t,s){var a=n.key;n.kind==="constructor"?(e&&this.raise(a.start,"Constructor can't be a generator"),t&&this.raise(a.start,"Constructor can't be an async method")):n.static&&xy(n,"prototype")&&this.raise(a.start,"Classes may not have a static property named prototype");var r=n.value=this.parseMethod(e,t,s);return n.kind==="get"&&r.params.length!==0&&this.raiseRecoverable(r.start,"getter should have no params"),n.kind==="set"&&r.params.length!==1&&this.raiseRecoverable(r.start,"setter should have exactly one param"),n.kind==="set"&&r.params[0].type==="RestElement"&&this.raiseRecoverable(r.params[0].start,"Setter cannot use rest params"),this.finishNode(n,"MethodDefinition")};Ht.parseClassField=function(n){return xy(n,"constructor")?this.raise(n.key.start,"Classes can't have a field named 'constructor'"):n.static&&xy(n,"prototype")&&this.raise(n.key.start,"Classes can't have a static field named 'prototype'"),this.eat(ae.eq)?(this.enterScope(zg|lw),n.value=this.parseMaybeAssign(),this.exitScope()):n.value=null,this.semicolon(),this.finishNode(n,"PropertyDefinition")};Ht.parseClassStaticBlock=function(n){n.body=[];var e=this.labels;for(this.labels=[],this.enterScope(Hh|lw);this.type!==ae.braceR;){var t=this.parseStatement(null);n.body.push(t)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(n,"StaticBlock")};Ht.parseClassId=function(n,e){this.type===ae.name?(n.id=this.parseIdent(),e&&this.checkLValSimple(n.id,Vc,!1)):(e===!0&&this.unexpected(),n.id=null)};Ht.parseClassSuper=function(n){n.superClass=this.eat(ae._extends)?this.parseExprSubscripts(null,!1):null};Ht.enterClassBody=function(){var n={declared:Object.create(null),used:[]};return this.privateNameStack.push(n),n.declared};Ht.exitClassBody=function(){var n=this.privateNameStack.pop(),e=n.declared,t=n.used;if(this.options.checkPrivateFields)for(var s=this.privateNameStack.length,a=s===0?null:this.privateNameStack[s-1],r=0;r<t.length;++r){var o=t[r];Vm(e,o.name)||(a?a.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function Zpe(n,e){var t=e.key.name,s=n[t],a="true";return e.type==="MethodDefinition"&&(e.kind==="get"||e.kind==="set")&&(a=(e.static?"s":"i")+e.kind),s==="iget"&&a==="iset"||s==="iset"&&a==="iget"||s==="sget"&&a==="sset"||s==="sset"&&a==="sget"?(n[t]="true",!1):s?!0:(n[t]=a,!1)}function xy(n,e){var t=n.computed,s=n.key;return!t&&(s.type==="Identifier"&&s.name===e||s.type==="Literal"&&s.value===e)}Ht.parseExportAllDeclaration=function(n,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(n.exported=this.parseModuleExportName(),this.checkExport(e,n.exported,this.lastTokStart)):n.exported=null),this.expectContextual("from"),this.type!==ae.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ExportAllDeclaration")};Ht.parseExport=function(n,e){if(this.next(),this.eat(ae.star))return this.parseExportAllDeclaration(n,e);if(this.eat(ae._default))return this.checkExport(e,"default",this.lastTokStart),n.declaration=this.parseExportDefaultDeclaration(),this.finishNode(n,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())n.declaration=this.parseExportDeclaration(n),n.declaration.type==="VariableDeclaration"?this.checkVariableExport(e,n.declaration.declarations):this.checkExport(e,n.declaration.id,n.declaration.id.start),n.specifiers=[],n.source=null,this.options.ecmaVersion>=16&&(n.attributes=[]);else{if(n.declaration=null,n.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==ae.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause());else{for(var t=0,s=n.specifiers;t<s.length;t+=1){var a=s[t];this.checkUnreserved(a.local),this.checkLocalExport(a.local),a.local.type==="Literal"&&this.raise(a.local.start,"A string literal cannot be used as an exported binding without `from`.")}n.source=null,this.options.ecmaVersion>=16&&(n.attributes=[])}this.semicolon()}return this.finishNode(n,"ExportNamedDeclaration")};Ht.parseExportDeclaration=function(n){return this.parseStatement(null)};Ht.parseExportDefaultDeclaration=function(){var n;if(this.type===ae._function||(n=this.isAsyncFunction())){var e=this.startNode();return this.next(),n&&this.next(),this.parseFunction(e,kf|u_,!1,n)}else if(this.type===ae._class){var t=this.startNode();return this.parseClass(t,"nullableID")}else{var s=this.parseMaybeAssign();return this.semicolon(),s}};Ht.checkExport=function(n,e,t){n&&(typeof e!="string"&&(e=e.type==="Identifier"?e.name:e.value),Vm(n,e)&&this.raiseRecoverable(t,"Duplicate export '"+e+"'"),n[e]=!0)};Ht.checkPatternExport=function(n,e){var t=e.type;if(t==="Identifier")this.checkExport(n,e,e.start);else if(t==="ObjectPattern")for(var s=0,a=e.properties;s<a.length;s+=1){var r=a[s];this.checkPatternExport(n,r)}else if(t==="ArrayPattern")for(var o=0,i=e.elements;o<i.length;o+=1){var l=i[o];l&&this.checkPatternExport(n,l)}else t==="Property"?this.checkPatternExport(n,e.value):t==="AssignmentPattern"?this.checkPatternExport(n,e.left):t==="RestElement"&&this.checkPatternExport(n,e.argument)};Ht.checkVariableExport=function(n,e){if(n)for(var t=0,s=e;t<s.length;t+=1){var a=s[t];this.checkPatternExport(n,a.id)}};Ht.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Ht.parseExportSpecifier=function(n){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(n,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")};Ht.parseExportSpecifiers=function(n){var e=[],t=!0;for(this.expect(ae.braceL);!this.eat(ae.braceR);){if(t)t=!1;else if(this.expect(ae.comma),this.afterTrailingComma(ae.braceR))break;e.push(this.parseExportSpecifier(n))}return e};Ht.parseImport=function(n){return this.next(),this.type===ae.string?(n.specifiers=jpe,n.source=this.parseExprAtom()):(n.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),n.source=this.type===ae.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ImportDeclaration")};Ht.parseImportSpecifier=function(){var n=this.startNode();return n.imported=this.parseModuleExportName(),this.eatContextual("as")?n.local=this.parseIdent():(this.checkUnreserved(n.imported),n.local=n.imported),this.checkLValSimple(n.local,Vc),this.finishNode(n,"ImportSpecifier")};Ht.parseImportDefaultSpecifier=function(){var n=this.startNode();return n.local=this.parseIdent(),this.checkLValSimple(n.local,Vc),this.finishNode(n,"ImportDefaultSpecifier")};Ht.parseImportNamespaceSpecifier=function(){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLValSimple(n.local,Vc),this.finishNode(n,"ImportNamespaceSpecifier")};Ht.parseImportSpecifiers=function(){var n=[],e=!0;if(this.type===ae.name&&(n.push(this.parseImportDefaultSpecifier()),!this.eat(ae.comma)))return n;if(this.type===ae.star)return n.push(this.parseImportNamespaceSpecifier()),n;for(this.expect(ae.braceL);!this.eat(ae.braceR);){if(e)e=!1;else if(this.expect(ae.comma),this.afterTrailingComma(ae.braceR))break;n.push(this.parseImportSpecifier())}return n};Ht.parseWithClause=function(){var n=[];if(!this.eat(ae._with))return n;this.expect(ae.braceL);for(var e={},t=!0;!this.eat(ae.braceR);){if(t)t=!1;else if(this.expect(ae.comma),this.afterTrailingComma(ae.braceR))break;var s=this.parseImportAttribute(),a=s.key.type==="Identifier"?s.key.name:s.key.value;Vm(e,a)&&this.raiseRecoverable(s.key.start,"Duplicate attribute key '"+a+"'"),e[a]=!0,n.push(s)}return n};Ht.parseImportAttribute=function(){var n=this.startNode();return n.key=this.type===ae.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(ae.colon),this.type!==ae.string&&this.unexpected(),n.value=this.parseExprAtom(),this.finishNode(n,"ImportAttribute")};Ht.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===ae.string){var n=this.parseLiteral(this.value);return _pe.test(n.value)&&this.raise(n.start,"An export name cannot include a lone surrogate."),n}return this.parseIdent(!0)};Ht.adaptDirectivePrologue=function(n){for(var e=0;e<n.length&&this.isDirectiveCandidate(n[e]);++e)n[e].directive=n[e].expression.raw.slice(1,-1)};Ht.isDirectiveCandidate=function(n){return this.options.ecmaVersion>=5&&n.type==="ExpressionStatement"&&n.expression.type==="Literal"&&typeof n.expression.value=="string"&&(this.input[n.start]==='"'||this.input[n.start]==="'")};var ki=Da.prototype;ki.toAssignable=function(n,e,t){if(this.options.ecmaVersion>=6&&n)switch(n.type){case"Identifier":this.inAsync&&n.name==="await"&&this.raise(n.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":n.type="ObjectPattern",t&&this.checkPatternErrors(t,!0);for(var s=0,a=n.properties;s<a.length;s+=1){var r=a[s];this.toAssignable(r,e),r.type==="RestElement"&&(r.argument.type==="ArrayPattern"||r.argument.type==="ObjectPattern")&&this.raise(r.argument.start,"Unexpected token")}break;case"Property":n.kind!=="init"&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,e);break;case"ArrayExpression":n.type="ArrayPattern",t&&this.checkPatternErrors(t,!0),this.toAssignableList(n.elements,e);break;case"SpreadElement":n.type="RestElement",this.toAssignable(n.argument,e),n.argument.type==="AssignmentPattern"&&this.raise(n.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":n.operator!=="="&&this.raise(n.left.end,"Only '=' operator can be used for specifying default value."),n.type="AssignmentPattern",delete n.operator,this.toAssignable(n.left,e);break;case"ParenthesizedExpression":this.toAssignable(n.expression,e,t);break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(n.start,"Assigning to rvalue")}else t&&this.checkPatternErrors(t,!0);return n};ki.toAssignableList=function(n,e){for(var t=n.length,s=0;s<t;s++){var a=n[s];a&&this.toAssignable(a,e)}if(t){var r=n[t-1];this.options.ecmaVersion===6&&e&&r&&r.type==="RestElement"&&r.argument.type!=="Identifier"&&this.unexpected(r.argument.start)}return n};ki.parseSpread=function(n){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,n),this.finishNode(e,"SpreadElement")};ki.parseRestBinding=function(){var n=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==ae.name&&this.unexpected(),n.argument=this.parseBindingAtom(),this.finishNode(n,"RestElement")};ki.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case ae.bracketL:var n=this.startNode();return this.next(),n.elements=this.parseBindingList(ae.bracketR,!0,!0),this.finishNode(n,"ArrayPattern");case ae.braceL:return this.parseObj(!0)}return this.parseIdent()};ki.parseBindingList=function(n,e,t,s){for(var a=[],r=!0;!this.eat(n);)if(r?r=!1:this.expect(ae.comma),e&&this.type===ae.comma)a.push(null);else{if(t&&this.afterTrailingComma(n))break;if(this.type===ae.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),a.push(o),this.type===ae.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(n);break}else a.push(this.parseAssignableListItem(s))}return a};ki.parseAssignableListItem=function(n){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e};ki.parseBindingListItem=function(n){return n};ki.parseMaybeDefault=function(n,e,t){if(t=t||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(ae.eq))return t;var s=this.startNodeAt(n,e);return s.left=t,s.right=this.parseMaybeAssign(),this.finishNode(s,"AssignmentPattern")};ki.checkLValSimple=function(n,e,t){e===void 0&&(e=Oy);var s=e!==Oy;switch(n.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(n.name)&&this.raiseRecoverable(n.start,(s?"Binding ":"Assigning to ")+n.name+" in strict mode"),s&&(e===Vc&&n.name==="let"&&this.raiseRecoverable(n.start,"let is disallowed as a lexically bound name"),t&&(Vm(t,n.name)&&this.raiseRecoverable(n.start,"Argument name clash"),t[n.name]=!0),e!==c_&&this.declareName(n.name,e,n.start));break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":s&&this.raiseRecoverable(n.start,"Binding member expression");break;case"ParenthesizedExpression":return s&&this.raiseRecoverable(n.start,"Binding parenthesized expression"),this.checkLValSimple(n.expression,e,t);default:this.raise(n.start,(s?"Binding":"Assigning to")+" rvalue")}};ki.checkLValPattern=function(n,e,t){switch(e===void 0&&(e=Oy),n.type){case"ObjectPattern":for(var s=0,a=n.properties;s<a.length;s+=1){var r=a[s];this.checkLValInnerPattern(r,e,t)}break;case"ArrayPattern":for(var o=0,i=n.elements;o<i.length;o+=1){var l=i[o];l&&this.checkLValInnerPattern(l,e,t)}break;default:this.checkLValSimple(n,e,t)}};ki.checkLValInnerPattern=function(n,e,t){switch(e===void 0&&(e=Oy),n.type){case"Property":this.checkLValInnerPattern(n.value,e,t);break;case"AssignmentPattern":this.checkLValPattern(n.left,e,t);break;case"RestElement":this.checkLValPattern(n.argument,e,t);break;default:this.checkLValPattern(n,e,t)}};var Bi=function(e,t,s,a,r){this.token=e,this.isExpr=!!t,this.preserveSpace=!!s,this.override=a,this.generator=!!r},qs={b_stat:new Bi("{",!1),b_expr:new Bi("{",!0),b_tmpl:new Bi("${",!1),p_stat:new Bi("(",!1),p_expr:new Bi("(",!0),q_tmpl:new Bi("`",!0,!0,function(n){return n.tryReadTemplateToken()}),f_stat:new Bi("function",!1),f_expr:new Bi("function",!0),f_expr_gen:new Bi("function",!0,!1,null,!0),f_gen:new Bi("function",!1,!1,null,!0)},Zm=Da.prototype;Zm.initialContext=function(){return[qs.b_stat]};Zm.curContext=function(){return this.context[this.context.length-1]};Zm.braceIsBlock=function(n){var e=this.curContext();return e===qs.f_expr||e===qs.f_stat?!0:n===ae.colon&&(e===qs.b_stat||e===qs.b_expr)?!e.isExpr:n===ae._return||n===ae.name&&this.exprAllowed?fo.test(this.input.slice(this.lastTokEnd,this.start)):n===ae._else||n===ae.semi||n===ae.eof||n===ae.parenR||n===ae.arrow?!0:n===ae.braceL?e===qs.b_stat:n===ae._var||n===ae._const||n===ae.name?!1:!this.exprAllowed};Zm.inGeneratorContext=function(){for(var n=this.context.length-1;n>=1;n--){var e=this.context[n];if(e.token==="function")return e.generator}return!1};Zm.updateContext=function(n){var e,t=this.type;t.keyword&&n===ae.dot?this.exprAllowed=!1:(e=t.updateContext)?e.call(this,n):this.exprAllowed=t.beforeExpr};Zm.overrideContext=function(n){this.curContext()!==n&&(this.context[this.context.length-1]=n)};ae.parenR.updateContext=ae.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var n=this.context.pop();n===qs.b_stat&&this.curContext().token==="function"&&(n=this.context.pop()),this.exprAllowed=!n.isExpr};ae.braceL.updateContext=function(n){this.context.push(this.braceIsBlock(n)?qs.b_stat:qs.b_expr),this.exprAllowed=!0};ae.dollarBraceL.updateContext=function(){this.context.push(qs.b_tmpl),this.exprAllowed=!0};ae.parenL.updateContext=function(n){var e=n===ae._if||n===ae._for||n===ae._with||n===ae._while;this.context.push(e?qs.p_stat:qs.p_expr),this.exprAllowed=!0};ae.incDec.updateContext=function(){};ae._function.updateContext=ae._class.updateContext=function(n){n.beforeExpr&&n!==ae._else&&!(n===ae.semi&&this.curContext()!==qs.p_stat)&&!(n===ae._return&&fo.test(this.input.slice(this.lastTokEnd,this.start)))&&!((n===ae.colon||n===ae.braceL)&&this.curContext()===qs.b_stat)?this.context.push(qs.f_expr):this.context.push(qs.f_stat),this.exprAllowed=!1};ae.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};ae.backQuote.updateContext=function(){this.curContext()===qs.q_tmpl?this.context.pop():this.context.push(qs.q_tmpl),this.exprAllowed=!1};ae.star.updateContext=function(n){if(n===ae._function){var e=this.context.length-1;this.context[e]===qs.f_expr?this.context[e]=qs.f_expr_gen:this.context[e]=qs.f_gen}this.exprAllowed=!0};ae.name.updateContext=function(n){var e=!1;this.options.ecmaVersion>=6&&n!==ae.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var vn=Da.prototype;vn.checkPropClash=function(n,e,t){if(!(this.options.ecmaVersion>=9&&n.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(n.computed||n.method||n.shorthand))){var s=n.key,a;switch(s.type){case"Identifier":a=s.name;break;case"Literal":a=String(s.value);break;default:return}var r=n.kind;if(this.options.ecmaVersion>=6){a==="__proto__"&&r==="init"&&(e.proto&&(t?t.doubleProto<0&&(t.doubleProto=s.start):this.raiseRecoverable(s.start,"Redefinition of __proto__ property")),e.proto=!0);return}a="$"+a;var o=e[a];if(o){var i;r==="init"?i=this.strict&&o.init||o.get||o.set:i=o.init||o[r],i&&this.raiseRecoverable(s.start,"Redefinition of property")}else o=e[a]={init:!1,get:!1,set:!1};o[r]=!0}};vn.parseExpression=function(n,e){var t=this.start,s=this.startLoc,a=this.parseMaybeAssign(n,e);if(this.type===ae.comma){var r=this.startNodeAt(t,s);for(r.expressions=[a];this.eat(ae.comma);)r.expressions.push(this.parseMaybeAssign(n,e));return this.finishNode(r,"SequenceExpression")}return a};vn.parseMaybeAssign=function(n,e,t){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(n);this.exprAllowed=!1}var s=!1,a=-1,r=-1,o=-1;e?(a=e.parenthesizedAssign,r=e.trailingComma,o=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new uw,s=!0);var i=this.start,l=this.startLoc;(this.type===ae.parenL||this.type===ae.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=n==="await");var c=this.parseMaybeConditional(n,e);if(t&&(c=t.call(this,c,i,l)),this.type.isAssign){var u=this.startNodeAt(i,l);return u.operator=this.value,this.type===ae.eq&&(c=this.toAssignable(c,!1,e)),s||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=c.start&&(e.shorthandAssign=-1),this.type===ae.eq?this.checkLValPattern(c):this.checkLValSimple(c),u.left=c,this.next(),u.right=this.parseMaybeAssign(n),o>-1&&(e.doubleProto=o),this.finishNode(u,"AssignmentExpression")}else s&&this.checkExpressionErrors(e,!0);return a>-1&&(e.parenthesizedAssign=a),r>-1&&(e.trailingComma=r),c};vn.parseMaybeConditional=function(n,e){var t=this.start,s=this.startLoc,a=this.parseExprOps(n,e);if(this.checkExpressionErrors(e))return a;if(this.eat(ae.question)){var r=this.startNodeAt(t,s);return r.test=a,r.consequent=this.parseMaybeAssign(),this.expect(ae.colon),r.alternate=this.parseMaybeAssign(n),this.finishNode(r,"ConditionalExpression")}return a};vn.parseExprOps=function(n,e){var t=this.start,s=this.startLoc,a=this.parseMaybeUnary(e,!1,!1,n);return this.checkExpressionErrors(e)||a.start===t&&a.type==="ArrowFunctionExpression"?a:this.parseExprOp(a,t,s,-1,n)};vn.parseExprOp=function(n,e,t,s,a){var r=this.type.binop;if(r!=null&&(!a||this.type!==ae._in)&&r>s){var o=this.type===ae.logicalOR||this.type===ae.logicalAND,i=this.type===ae.coalesce;i&&(r=ae.logicalAND.binop);var l=this.value;this.next();var c=this.start,u=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,a),c,u,r,a),m=this.buildBinary(e,t,n,h,l,o||i);return(o&&this.type===ae.coalesce||i&&(this.type===ae.logicalOR||this.type===ae.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(m,e,t,s,a)}return n};vn.buildBinary=function(n,e,t,s,a,r){s.type==="PrivateIdentifier"&&this.raise(s.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(n,e);return o.left=t,o.operator=a,o.right=s,this.finishNode(o,r?"LogicalExpression":"BinaryExpression")};vn.parseMaybeUnary=function(n,e,t,s){var a=this.start,r=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(s),e=!0;else if(this.type.prefix){var i=this.startNode(),l=this.type===ae.incDec;i.operator=this.value,i.prefix=!0,this.next(),i.argument=this.parseMaybeUnary(null,!0,l,s),this.checkExpressionErrors(n,!0),l?this.checkLValSimple(i.argument):this.strict&&i.operator==="delete"&&h_(i.argument)?this.raiseRecoverable(i.start,"Deleting local variable in strict mode"):i.operator==="delete"&&F2(i.argument)?this.raiseRecoverable(i.start,"Private fields can not be deleted"):e=!0,o=this.finishNode(i,l?"UpdateExpression":"UnaryExpression")}else if(!e&&this.type===ae.privateId)(s||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==ae._in&&this.unexpected();else{if(o=this.parseExprSubscripts(n,s),this.checkExpressionErrors(n))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(a,r);c.operator=this.value,c.prefix=!1,c.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(c,"UpdateExpression")}}if(!t&&this.eat(ae.starstar))if(e)this.unexpected(this.lastTokStart);else return this.buildBinary(a,r,o,this.parseMaybeUnary(null,!1,!1,s),"**",!1);else return o};function h_(n){return n.type==="Identifier"||n.type==="ParenthesizedExpression"&&h_(n.expression)}function F2(n){return n.type==="MemberExpression"&&n.property.type==="PrivateIdentifier"||n.type==="ChainExpression"&&F2(n.expression)||n.type==="ParenthesizedExpression"&&F2(n.expression)}vn.parseExprSubscripts=function(n,e){var t=this.start,s=this.startLoc,a=this.parseExprAtom(n,e);if(a.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return a;var r=this.parseSubscripts(a,t,s,!1,e);return n&&r.type==="MemberExpression"&&(n.parenthesizedAssign>=r.start&&(n.parenthesizedAssign=-1),n.parenthesizedBind>=r.start&&(n.parenthesizedBind=-1),n.trailingComma>=r.start&&(n.trailingComma=-1)),r};vn.parseSubscripts=function(n,e,t,s,a){for(var r=this.options.ecmaVersion>=8&&n.type==="Identifier"&&n.name==="async"&&this.lastTokEnd===n.end&&!this.canInsertSemicolon()&&n.end-n.start===5&&this.potentialArrowAt===n.start,o=!1;;){var i=this.parseSubscript(n,e,t,s,r,o,a);if(i.optional&&(o=!0),i===n||i.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(e,t);l.expression=i,i=this.finishNode(l,"ChainExpression")}return i}n=i}};vn.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(ae.arrow)};vn.parseSubscriptAsyncArrow=function(n,e,t,s){return this.parseArrowExpression(this.startNodeAt(n,e),t,!0,s)};vn.parseSubscript=function(n,e,t,s,a,r,o){var i=this.options.ecmaVersion>=11,l=i&&this.eat(ae.questionDot);s&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(ae.bracketL);if(c||l&&this.type!==ae.parenL&&this.type!==ae.backQuote||this.eat(ae.dot)){var u=this.startNodeAt(e,t);u.object=n,c?(u.property=this.parseExpression(),this.expect(ae.bracketR)):this.type===ae.privateId&&n.type!=="Super"?u.property=this.parsePrivateIdent():u.property=this.parseIdent(this.options.allowReserved!=="never"),u.computed=!!c,i&&(u.optional=l),n=this.finishNode(u,"MemberExpression")}else if(!s&&this.eat(ae.parenL)){var h=new uw,m=this.yieldPos,f=this.awaitPos,v=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var O=this.parseExprList(ae.parenR,this.options.ecmaVersion>=8,!1,h);if(a&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=m,this.awaitPos=f,this.awaitIdentPos=v,this.parseSubscriptAsyncArrow(e,t,O,o);this.checkExpressionErrors(h,!0),this.yieldPos=m||this.yieldPos,this.awaitPos=f||this.awaitPos,this.awaitIdentPos=v||this.awaitIdentPos;var k=this.startNodeAt(e,t);k.callee=n,k.arguments=O,i&&(k.optional=l),n=this.finishNode(k,"CallExpression")}else if(this.type===ae.backQuote){(l||r)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var M=this.startNodeAt(e,t);M.tag=n,M.quasi=this.parseTemplate({isTagged:!0}),n=this.finishNode(M,"TaggedTemplateExpression")}return n};vn.parseExprAtom=function(n,e,t){this.type===ae.slash&&this.readRegexp();var s,a=this.potentialArrowAt===this.start;switch(this.type){case ae._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),s=this.startNode(),this.next(),this.type===ae.parenL&&!this.allowDirectSuper&&this.raise(s.start,"super() call outside constructor of a subclass"),this.type!==ae.dot&&this.type!==ae.bracketL&&this.type!==ae.parenL&&this.unexpected(),this.finishNode(s,"Super");case ae._this:return s=this.startNode(),this.next(),this.finishNode(s,"ThisExpression");case ae.name:var r=this.start,o=this.startLoc,i=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!i&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(ae._function))return this.overrideContext(qs.f_expr),this.parseFunction(this.startNodeAt(r,o),0,!1,!0,e);if(a&&!this.canInsertSemicolon()){if(this.eat(ae.arrow))return this.parseArrowExpression(this.startNodeAt(r,o),[l],!1,e);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===ae.name&&!i&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(ae.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,o),[l],!0,e)}return l;case ae.regexp:var c=this.value;return s=this.parseLiteral(c.value),s.regex={pattern:c.pattern,flags:c.flags},s;case ae.num:case ae.string:return this.parseLiteral(this.value);case ae._null:case ae._true:case ae._false:return s=this.startNode(),s.value=this.type===ae._null?null:this.type===ae._true,s.raw=this.type.keyword,this.next(),this.finishNode(s,"Literal");case ae.parenL:var u=this.start,h=this.parseParenAndDistinguishExpression(a,e);return n&&(n.parenthesizedAssign<0&&!this.isSimpleAssignTarget(h)&&(n.parenthesizedAssign=u),n.parenthesizedBind<0&&(n.parenthesizedBind=u)),h;case ae.bracketL:return s=this.startNode(),this.next(),s.elements=this.parseExprList(ae.bracketR,!0,!0,n),this.finishNode(s,"ArrayExpression");case ae.braceL:return this.overrideContext(qs.b_expr),this.parseObj(!1,n);case ae._function:return s=this.startNode(),this.next(),this.parseFunction(s,0);case ae._class:return this.parseClass(this.startNode(),!1);case ae._new:return this.parseNew();case ae.backQuote:return this.parseTemplate();case ae._import:return this.options.ecmaVersion>=11?this.parseExprImport(t):this.unexpected();default:return this.parseExprAtomDefault()}};vn.parseExprAtomDefault=function(){this.unexpected()};vn.parseExprImport=function(n){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===ae.parenL&&!n)return this.parseDynamicImport(e);if(this.type===ae.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);return t.name="import",e.meta=this.finishNode(t,"Identifier"),this.parseImportMeta(e)}else this.unexpected()};vn.parseDynamicImport=function(n){if(this.next(),n.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(ae.parenR)?n.options=null:(this.expect(ae.comma),this.afterTrailingComma(ae.parenR)?n.options=null:(n.options=this.parseMaybeAssign(),this.eat(ae.parenR)||(this.expect(ae.comma),this.afterTrailingComma(ae.parenR)||this.unexpected())));else if(!this.eat(ae.parenR)){var e=this.start;this.eat(ae.comma)&&this.eat(ae.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(n,"ImportExpression")};vn.parseImportMeta=function(n){this.next();var e=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="meta"&&this.raiseRecoverable(n.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(n.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(n.start,"Cannot use 'import.meta' outside a module"),this.finishNode(n,"MetaProperty")};vn.parseLiteral=function(n){var e=this.startNode();return e.value=n,e.raw=this.input.slice(this.start,this.end),e.raw.charCodeAt(e.raw.length-1)===110&&(e.bigint=e.value!=null?e.value.toString():e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")};vn.parseParenExpression=function(){this.expect(ae.parenL);var n=this.parseExpression();return this.expect(ae.parenR),n};vn.shouldParseArrow=function(n){return!this.canInsertSemicolon()};vn.parseParenAndDistinguishExpression=function(n,e){var t=this.start,s=this.startLoc,a,r=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,i=this.startLoc,l=[],c=!0,u=!1,h=new uw,m=this.yieldPos,f=this.awaitPos,v;for(this.yieldPos=0,this.awaitPos=0;this.type!==ae.parenR;)if(c?c=!1:this.expect(ae.comma),r&&this.afterTrailingComma(ae.parenR,!0)){u=!0;break}else if(this.type===ae.ellipsis){v=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===ae.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,h,this.parseParenItem));var O=this.lastTokEnd,k=this.lastTokEndLoc;if(this.expect(ae.parenR),n&&this.shouldParseArrow(l)&&this.eat(ae.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=m,this.awaitPos=f,this.parseParenArrowList(t,s,l,e);(!l.length||u)&&this.unexpected(this.lastTokStart),v&&this.unexpected(v),this.checkExpressionErrors(h,!0),this.yieldPos=m||this.yieldPos,this.awaitPos=f||this.awaitPos,l.length>1?(a=this.startNodeAt(o,i),a.expressions=l,this.finishNodeAt(a,"SequenceExpression",O,k)):a=l[0]}else a=this.parseParenExpression();if(this.options.preserveParens){var M=this.startNodeAt(t,s);return M.expression=a,this.finishNode(M,"ParenthesizedExpression")}else return a};vn.parseParenItem=function(n){return n};vn.parseParenArrowList=function(n,e,t,s){return this.parseArrowExpression(this.startNodeAt(n,e),t,!1,s)};var zpe=[];vn.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var n=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===ae.dot){var e=this.startNodeAt(n.start,n.loc&&n.loc.start);e.name="new",n.meta=this.finishNode(e,"Identifier"),this.next();var t=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="target"&&this.raiseRecoverable(n.property.start,"The only valid meta property for new is 'new.target'"),t&&this.raiseRecoverable(n.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(n.start,"'new.target' can only be used in functions and class static block"),this.finishNode(n,"MetaProperty")}var s=this.start,a=this.startLoc;return n.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),s,a,!0,!1),this.eat(ae.parenL)?n.arguments=this.parseExprList(ae.parenR,this.options.ecmaVersion>=8,!1):n.arguments=zpe,this.finishNode(n,"NewExpression")};vn.parseTemplateElement=function(n){var e=n.isTagged,t=this.startNode();return this.type===ae.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),t.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),t.tail=this.type===ae.backQuote,this.finishNode(t,"TemplateElement")};vn.parseTemplate=function(n){n===void 0&&(n={});var e=n.isTagged;e===void 0&&(e=!1);var t=this.startNode();this.next(),t.expressions=[];var s=this.parseTemplateElement({isTagged:e});for(t.quasis=[s];!s.tail;)this.type===ae.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(ae.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(ae.braceR),t.quasis.push(s=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(t,"TemplateLiteral")};vn.isAsyncProp=function(n){return!n.computed&&n.key.type==="Identifier"&&n.key.name==="async"&&(this.type===ae.name||this.type===ae.num||this.type===ae.string||this.type===ae.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===ae.star)&&!fo.test(this.input.slice(this.lastTokEnd,this.start))};vn.parseObj=function(n,e){var t=this.startNode(),s=!0,a={};for(t.properties=[],this.next();!this.eat(ae.braceR);){if(s)s=!1;else if(this.expect(ae.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(ae.braceR))break;var r=this.parseProperty(n,e);n||this.checkPropClash(r,a,e),t.properties.push(r)}return this.finishNode(t,n?"ObjectPattern":"ObjectExpression")};vn.parseProperty=function(n,e){var t=this.startNode(),s,a,r,o;if(this.options.ecmaVersion>=9&&this.eat(ae.ellipsis))return n?(t.argument=this.parseIdent(!1),this.type===ae.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(t,"RestElement")):(t.argument=this.parseMaybeAssign(!1,e),this.type===ae.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(t,"SpreadElement"));this.options.ecmaVersion>=6&&(t.method=!1,t.shorthand=!1,(n||e)&&(r=this.start,o=this.startLoc),n||(s=this.eat(ae.star)));var i=this.containsEsc;return this.parsePropertyName(t),!n&&!i&&this.options.ecmaVersion>=8&&!s&&this.isAsyncProp(t)?(a=!0,s=this.options.ecmaVersion>=9&&this.eat(ae.star),this.parsePropertyName(t)):a=!1,this.parsePropertyValue(t,n,s,a,r,o,e,i),this.finishNode(t,"Property")};vn.parseGetterSetter=function(n){var e=n.key.name;this.parsePropertyName(n),n.value=this.parseMethod(!1),n.kind=e;var t=n.kind==="get"?0:1;if(n.value.params.length!==t){var s=n.value.start;n.kind==="get"?this.raiseRecoverable(s,"getter should have no params"):this.raiseRecoverable(s,"setter should have exactly one param")}else n.kind==="set"&&n.value.params[0].type==="RestElement"&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params")};vn.parsePropertyValue=function(n,e,t,s,a,r,o,i){(t||s)&&this.type===ae.colon&&this.unexpected(),this.eat(ae.colon)?(n.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),n.kind="init"):this.options.ecmaVersion>=6&&this.type===ae.parenL?(e&&this.unexpected(),n.method=!0,n.value=this.parseMethod(t,s),n.kind="init"):!e&&!i&&this.options.ecmaVersion>=5&&!n.computed&&n.key.type==="Identifier"&&(n.key.name==="get"||n.key.name==="set")&&this.type!==ae.comma&&this.type!==ae.braceR&&this.type!==ae.eq?((t||s)&&this.unexpected(),this.parseGetterSetter(n)):this.options.ecmaVersion>=6&&!n.computed&&n.key.type==="Identifier"?((t||s)&&this.unexpected(),this.checkUnreserved(n.key),n.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=a),e?n.value=this.parseMaybeDefault(a,r,this.copyNode(n.key)):this.type===ae.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),n.value=this.parseMaybeDefault(a,r,this.copyNode(n.key))):n.value=this.copyNode(n.key),n.kind="init",n.shorthand=!0):this.unexpected()};vn.parsePropertyName=function(n){if(this.options.ecmaVersion>=6){if(this.eat(ae.bracketL))return n.computed=!0,n.key=this.parseMaybeAssign(),this.expect(ae.bracketR),n.key;n.computed=!1}return n.key=this.type===ae.num||this.type===ae.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};vn.initFunction=function(n){n.id=null,this.options.ecmaVersion>=6&&(n.generator=n.expression=!1),this.options.ecmaVersion>=8&&(n.async=!1)};vn.parseMethod=function(n,e,t){var s=this.startNode(),a=this.yieldPos,r=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=n),this.options.ecmaVersion>=8&&(s.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(uA(e,s.generator)|lw|(t?o_:0)),this.expect(ae.parenL),s.params=this.parseBindingList(ae.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(s,!1,!0,!1),this.yieldPos=a,this.awaitPos=r,this.awaitIdentPos=o,this.finishNode(s,"FunctionExpression")};vn.parseArrowExpression=function(n,e,t,s){var a=this.yieldPos,r=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(uA(t,!1)|cA),this.initFunction(n),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,n.params=this.toAssignableList(e,!0),this.parseFunctionBody(n,!0,!1,s),this.yieldPos=a,this.awaitPos=r,this.awaitIdentPos=o,this.finishNode(n,"ArrowFunctionExpression")};vn.parseFunctionBody=function(n,e,t,s){var a=e&&this.type!==ae.braceL,r=this.strict,o=!1;if(a)n.body=this.parseMaybeAssign(s),n.expression=!0,this.checkParams(n,!1);else{var i=this.options.ecmaVersion>=7&&!this.isSimpleParamList(n.params);(!r||i)&&(o=this.strictDirective(this.end),o&&i&&this.raiseRecoverable(n.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(n,!r&&!o&&!e&&!t&&this.isSimpleParamList(n.params)),this.strict&&n.id&&this.checkLValSimple(n.id,c_),n.body=this.parseBlock(!1,void 0,o&&!r),n.expression=!1,this.adaptDirectivePrologue(n.body.body),this.labels=l}this.exitScope()};vn.isSimpleParamList=function(n){for(var e=0,t=n;e<t.length;e+=1){var s=t[e];if(s.type!=="Identifier")return!1}return!0};vn.checkParams=function(n,e){for(var t=Object.create(null),s=0,a=n.params;s<a.length;s+=1){var r=a[s];this.checkLValInnerPattern(r,hA,e?null:t)}};vn.parseExprList=function(n,e,t,s){for(var a=[],r=!0;!this.eat(n);){if(r)r=!1;else if(this.expect(ae.comma),e&&this.afterTrailingComma(n))break;var o=void 0;t&&this.type===ae.comma?o=null:this.type===ae.ellipsis?(o=this.parseSpread(s),s&&this.type===ae.comma&&s.trailingComma<0&&(s.trailingComma=this.start)):o=this.parseMaybeAssign(!1,s),a.push(o)}return a};vn.checkUnreserved=function(n){var e=n.start,t=n.end,s=n.name;if(this.inGenerator&&s==="yield"&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&cw)&&s==="arguments"&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(s==="arguments"||s==="await")&&this.raise(e,"Cannot use "+s+" in class static initialization block"),this.keywords.test(s)&&this.raise(e,"Unexpected keyword '"+s+"'"),!(this.options.ecmaVersion<6&&this.input.slice(e,t).indexOf("\\")!==-1)){var a=this.strict?this.reservedWordsStrict:this.reservedWords;a.test(s)&&(!this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+s+"' is reserved"))}};vn.parseIdent=function(n){var e=this.parseIdentNode();return this.next(!!n),this.finishNode(e,"Identifier"),n||(this.checkUnreserved(e),e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=e.start)),e};vn.parseIdentNode=function(){var n=this.startNode();return this.type===ae.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,(n.name==="class"||n.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=ae.name):this.unexpected(),n};vn.parsePrivateIdent=function(){var n=this.startNode();return this.type===ae.privateId?n.name=this.value:this.unexpected(),this.next(),this.finishNode(n,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(n.start,"Private field '#"+n.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(n)),n};vn.parseYield=function(n){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===ae.semi||this.canInsertSemicolon()||this.type!==ae.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(ae.star),e.argument=this.parseMaybeAssign(n)),this.finishNode(e,"YieldExpression")};vn.parseAwait=function(n){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,n),this.finishNode(e,"AwaitExpression")};var ky=Da.prototype;ky.raise=function(n,e){var t=s_(this.input,n);e+=" ("+t.line+":"+t.column+")",this.sourceFile&&(e+=" in "+this.sourceFile);var s=new SyntaxError(e);throw s.pos=n,s.loc=t,s.raisedAt=this.pos,s};ky.raiseRecoverable=ky.raise;ky.curPosition=function(){if(this.options.locations)return new tg(this.curLine,this.pos-this.lineStart)};var Zu=Da.prototype,Gpe=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};Zu.enterScope=function(n){this.scopeStack.push(new Gpe(n))};Zu.exitScope=function(){this.scopeStack.pop()};Zu.treatFunctionsAsVarInScope=function(n){return n.flags&jm||!this.inModule&&n.flags&ng};Zu.declareName=function(n,e,t){var s=!1;if(e===Vc){var a=this.currentScope();s=a.lexical.indexOf(n)>-1||a.functions.indexOf(n)>-1||a.var.indexOf(n)>-1,a.lexical.push(n),this.inModule&&a.flags&ng&&delete this.undefinedExports[n]}else if(e===l_){var r=this.currentScope();r.lexical.push(n)}else if(e===i_){var o=this.currentScope();this.treatFunctionsAsVar?s=o.lexical.indexOf(n)>-1:s=o.lexical.indexOf(n)>-1||o.var.indexOf(n)>-1,o.functions.push(n)}else for(var i=this.scopeStack.length-1;i>=0;--i){var l=this.scopeStack[i];if(l.lexical.indexOf(n)>-1&&!(l.flags&r_&&l.lexical[0]===n)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(n)>-1){s=!0;break}if(l.var.push(n),this.inModule&&l.flags&ng&&delete this.undefinedExports[n],l.flags&cw)break}s&&this.raiseRecoverable(t,"Identifier '"+n+"' has already been declared")};Zu.checkLocalExport=function(n){this.scopeStack[0].lexical.indexOf(n.name)===-1&&this.scopeStack[0].var.indexOf(n.name)===-1&&(this.undefinedExports[n.name]=n)};Zu.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Zu.currentVarScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&(cw|zg|Hh))return e}};Zu.currentThisScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&(cw|zg|Hh)&&!(e.flags&cA))return e}};var hw=function(e,t,s){this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new iw(e,s)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])},Gg=Da.prototype;Gg.startNode=function(){return new hw(this,this.start,this.startLoc)};Gg.startNodeAt=function(n,e){return new hw(this,n,e)};function d_(n,e,t,s){return n.type=e,n.end=t,this.options.locations&&(n.loc.end=s),this.options.ranges&&(n.range[1]=t),n}Gg.finishNode=function(n,e){return d_.call(this,n,e,this.lastTokEnd,this.lastTokEndLoc)};Gg.finishNodeAt=function(n,e,t,s){return d_.call(this,n,e,t,s)};Gg.copyNode=function(n){var e=new hw(this,n.start,this.startLoc);for(var t in n)e[t]=n[t];return e};var Xpe="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",m_="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",p_=m_+" Extended_Pictographic",f_=p_,g_=f_+" EBase EComp EMod EPres ExtPict",b_=g_,Wpe=b_,qpe={9:m_,10:p_,11:f_,12:g_,13:b_,14:Wpe},Upe="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",Hpe={9:"",10:"",11:"",12:"",13:"",14:Upe},z7="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",y_="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",v_=y_+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",w_=v_+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",O_=w_+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",x_=O_+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",Ype=x_+" "+Xpe,Kpe={9:y_,10:v_,11:w_,12:O_,13:x_,14:Ype},k_={};function Jpe(n){var e=k_[n]={binary:lu(qpe[n]+" "+z7),binaryOfStrings:lu(Hpe[n]),nonBinary:{General_Category:lu(z7),Script:lu(Kpe[n])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(var px=0,G7=[9,10,11,12,13,14];px<G7.length;px+=1){var efe=G7[px];Jpe(efe)}var Xt=Da.prototype,Py=function(e,t){this.parent=e,this.base=t||this};Py.prototype.separatedFrom=function(e){for(var t=this;t;t=t.parent)for(var s=e;s;s=s.parent)if(t.base===s.base&&t!==s)return!0;return!1};Py.prototype.sibling=function(){return new Py(this.parent,this.base)};var ec=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":"")+(e.options.ecmaVersion>=13?"d":"")+(e.options.ecmaVersion>=15?"v":""),this.unicodeProperties=k_[e.options.ecmaVersion>=14?14:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};ec.prototype.reset=function(e,t,s){var a=s.indexOf("v")!==-1,r=s.indexOf("u")!==-1;this.start=e|0,this.source=t+"",this.flags=s,a&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=r&&this.parser.options.ecmaVersion>=9)};ec.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)};ec.prototype.at=function(e,t){t===void 0&&(t=!1);var s=this.source,a=s.length;if(e>=a)return-1;var r=s.charCodeAt(e);if(!(t||this.switchU)||r<=55295||r>=57344||e+1>=a)return r;var o=s.charCodeAt(e+1);return o>=56320&&o<=57343?(r<<10)+o-56613888:r};ec.prototype.nextIndex=function(e,t){t===void 0&&(t=!1);var s=this.source,a=s.length;if(e>=a)return a;var r=s.charCodeAt(e),o;return!(t||this.switchU)||r<=55295||r>=57344||e+1>=a||(o=s.charCodeAt(e+1))<56320||o>57343?e+1:e+2};ec.prototype.current=function(e){return e===void 0&&(e=!1),this.at(this.pos,e)};ec.prototype.lookahead=function(e){return e===void 0&&(e=!1),this.at(this.nextIndex(this.pos,e),e)};ec.prototype.advance=function(e){e===void 0&&(e=!1),this.pos=this.nextIndex(this.pos,e)};ec.prototype.eat=function(e,t){return t===void 0&&(t=!1),this.current(t)===e?(this.advance(t),!0):!1};ec.prototype.eatChars=function(e,t){t===void 0&&(t=!1);for(var s=this.pos,a=0,r=e;a<r.length;a+=1){var o=r[a],i=this.at(s,t);if(i===-1||i!==o)return!1;s=this.nextIndex(s,t)}return this.pos=s,!0};Xt.validateRegExpFlags=function(n){for(var e=n.validFlags,t=n.flags,s=!1,a=!1,r=0;r<t.length;r++){var o=t.charAt(r);e.indexOf(o)===-1&&this.raise(n.start,"Invalid regular expression flag"),t.indexOf(o,r+1)>-1&&this.raise(n.start,"Duplicate regular expression flag"),o==="u"&&(s=!0),o==="v"&&(a=!0)}this.options.ecmaVersion>=15&&s&&a&&this.raise(n.start,"Invalid regular expression flag")};function tfe(n){for(var e in n)return!0;return!1}Xt.validateRegExpPattern=function(n){this.regexp_pattern(n),!n.switchN&&this.options.ecmaVersion>=9&&tfe(n.groupNames)&&(n.switchN=!0,this.regexp_pattern(n))};Xt.regexp_pattern=function(n){n.pos=0,n.lastIntValue=0,n.lastStringValue="",n.lastAssertionIsQuantifiable=!1,n.numCapturingParens=0,n.maxBackReference=0,n.groupNames=Object.create(null),n.backReferenceNames.length=0,n.branchID=null,this.regexp_disjunction(n),n.pos!==n.source.length&&(n.eat(41)&&n.raise("Unmatched ')'"),(n.eat(93)||n.eat(125))&&n.raise("Lone quantifier brackets")),n.maxBackReference>n.numCapturingParens&&n.raise("Invalid escape");for(var e=0,t=n.backReferenceNames;e<t.length;e+=1){var s=t[e];n.groupNames[s]||n.raise("Invalid named capture referenced")}};Xt.regexp_disjunction=function(n){var e=this.options.ecmaVersion>=16;for(e&&(n.branchID=new Py(n.branchID,null)),this.regexp_alternative(n);n.eat(124);)e&&(n.branchID=n.branchID.sibling()),this.regexp_alternative(n);e&&(n.branchID=n.branchID.parent),this.regexp_eatQuantifier(n,!0)&&n.raise("Nothing to repeat"),n.eat(123)&&n.raise("Lone quantifier brackets")};Xt.regexp_alternative=function(n){for(;n.pos<n.source.length&&this.regexp_eatTerm(n););};Xt.regexp_eatTerm=function(n){return this.regexp_eatAssertion(n)?(n.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(n)&&n.switchU&&n.raise("Invalid quantifier"),!0):(n.switchU?this.regexp_eatAtom(n):this.regexp_eatExtendedAtom(n))?(this.regexp_eatQuantifier(n),!0):!1};Xt.regexp_eatAssertion=function(n){var e=n.pos;if(n.lastAssertionIsQuantifiable=!1,n.eat(94)||n.eat(36))return!0;if(n.eat(92)){if(n.eat(66)||n.eat(98))return!0;n.pos=e}if(n.eat(40)&&n.eat(63)){var t=!1;if(this.options.ecmaVersion>=9&&(t=n.eat(60)),n.eat(61)||n.eat(33))return this.regexp_disjunction(n),n.eat(41)||n.raise("Unterminated group"),n.lastAssertionIsQuantifiable=!t,!0}return n.pos=e,!1};Xt.regexp_eatQuantifier=function(n,e){return e===void 0&&(e=!1),this.regexp_eatQuantifierPrefix(n,e)?(n.eat(63),!0):!1};Xt.regexp_eatQuantifierPrefix=function(n,e){return n.eat(42)||n.eat(43)||n.eat(63)||this.regexp_eatBracedQuantifier(n,e)};Xt.regexp_eatBracedQuantifier=function(n,e){var t=n.pos;if(n.eat(123)){var s=0,a=-1;if(this.regexp_eatDecimalDigits(n)&&(s=n.lastIntValue,n.eat(44)&&this.regexp_eatDecimalDigits(n)&&(a=n.lastIntValue),n.eat(125)))return a!==-1&&a<s&&!e&&n.raise("numbers out of order in {} quantifier"),!0;n.switchU&&!e&&n.raise("Incomplete quantifier"),n.pos=t}return!1};Xt.regexp_eatAtom=function(n){return this.regexp_eatPatternCharacters(n)||n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)};Xt.regexp_eatReverseSolidusAtomEscape=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatAtomEscape(n))return!0;n.pos=e}return!1};Xt.regexp_eatUncapturingGroup=function(n){var e=n.pos;if(n.eat(40)){if(n.eat(63)){if(this.options.ecmaVersion>=16){var t=this.regexp_eatModifiers(n),s=n.eat(45);if(t||s){for(var a=0;a<t.length;a++){var r=t.charAt(a);t.indexOf(r,a+1)>-1&&n.raise("Duplicate regular expression modifiers")}if(s){var o=this.regexp_eatModifiers(n);!t&&!o&&n.current()===58&&n.raise("Invalid regular expression modifiers");for(var i=0;i<o.length;i++){var l=o.charAt(i);(o.indexOf(l,i+1)>-1||t.indexOf(l)>-1)&&n.raise("Duplicate regular expression modifiers")}}}}if(n.eat(58)){if(this.regexp_disjunction(n),n.eat(41))return!0;n.raise("Unterminated group")}}n.pos=e}return!1};Xt.regexp_eatCapturingGroup=function(n){if(n.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(n):n.current()===63&&n.raise("Invalid group"),this.regexp_disjunction(n),n.eat(41))return n.numCapturingParens+=1,!0;n.raise("Unterminated group")}return!1};Xt.regexp_eatModifiers=function(n){for(var e="",t=0;(t=n.current())!==-1&&nfe(t);)e+=Fc(t),n.advance();return e};function nfe(n){return n===105||n===109||n===115}Xt.regexp_eatExtendedAtom=function(n){return n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)||this.regexp_eatInvalidBracedQuantifier(n)||this.regexp_eatExtendedPatternCharacter(n)};Xt.regexp_eatInvalidBracedQuantifier=function(n){return this.regexp_eatBracedQuantifier(n,!0)&&n.raise("Nothing to repeat"),!1};Xt.regexp_eatSyntaxCharacter=function(n){var e=n.current();return P_(e)?(n.lastIntValue=e,n.advance(),!0):!1};function P_(n){return n===36||n>=40&&n<=43||n===46||n===63||n>=91&&n<=94||n>=123&&n<=125}Xt.regexp_eatPatternCharacters=function(n){for(var e=n.pos,t=0;(t=n.current())!==-1&&!P_(t);)n.advance();return n.pos!==e};Xt.regexp_eatExtendedPatternCharacter=function(n){var e=n.current();return e!==-1&&e!==36&&!(e>=40&&e<=43)&&e!==46&&e!==63&&e!==91&&e!==94&&e!==124?(n.advance(),!0):!1};Xt.regexp_groupSpecifier=function(n){if(n.eat(63)){this.regexp_eatGroupName(n)||n.raise("Invalid group");var e=this.options.ecmaVersion>=16,t=n.groupNames[n.lastStringValue];if(t)if(e)for(var s=0,a=t;s<a.length;s+=1){var r=a[s];r.separatedFrom(n.branchID)||n.raise("Duplicate capture group name")}else n.raise("Duplicate capture group name");e?(t||(n.groupNames[n.lastStringValue]=[])).push(n.branchID):n.groupNames[n.lastStringValue]=!0}};Xt.regexp_eatGroupName=function(n){if(n.lastStringValue="",n.eat(60)){if(this.regexp_eatRegExpIdentifierName(n)&&n.eat(62))return!0;n.raise("Invalid capture group name")}return!1};Xt.regexp_eatRegExpIdentifierName=function(n){if(n.lastStringValue="",this.regexp_eatRegExpIdentifierStart(n)){for(n.lastStringValue+=Fc(n.lastIntValue);this.regexp_eatRegExpIdentifierPart(n);)n.lastStringValue+=Fc(n.lastIntValue);return!0}return!1};Xt.regexp_eatRegExpIdentifierStart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,s=n.current(t);return n.advance(t),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(s=n.lastIntValue),sfe(s)?(n.lastIntValue=s,!0):(n.pos=e,!1)};function sfe(n){return zl(n,!0)||n===36||n===95}Xt.regexp_eatRegExpIdentifierPart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,s=n.current(t);return n.advance(t),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(s=n.lastIntValue),afe(s)?(n.lastIntValue=s,!0):(n.pos=e,!1)};function afe(n){return Du(n,!0)||n===36||n===95||n===8204||n===8205}Xt.regexp_eatAtomEscape=function(n){return this.regexp_eatBackReference(n)||this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)||n.switchN&&this.regexp_eatKGroupName(n)?!0:(n.switchU&&(n.current()===99&&n.raise("Invalid unicode escape"),n.raise("Invalid escape")),!1)};Xt.regexp_eatBackReference=function(n){var e=n.pos;if(this.regexp_eatDecimalEscape(n)){var t=n.lastIntValue;if(n.switchU)return t>n.maxBackReference&&(n.maxBackReference=t),!0;if(t<=n.numCapturingParens)return!0;n.pos=e}return!1};Xt.regexp_eatKGroupName=function(n){if(n.eat(107)){if(this.regexp_eatGroupName(n))return n.backReferenceNames.push(n.lastStringValue),!0;n.raise("Invalid named reference")}return!1};Xt.regexp_eatCharacterEscape=function(n){return this.regexp_eatControlEscape(n)||this.regexp_eatCControlLetter(n)||this.regexp_eatZero(n)||this.regexp_eatHexEscapeSequence(n)||this.regexp_eatRegExpUnicodeEscapeSequence(n,!1)||!n.switchU&&this.regexp_eatLegacyOctalEscapeSequence(n)||this.regexp_eatIdentityEscape(n)};Xt.regexp_eatCControlLetter=function(n){var e=n.pos;if(n.eat(99)){if(this.regexp_eatControlLetter(n))return!0;n.pos=e}return!1};Xt.regexp_eatZero=function(n){return n.current()===48&&!dw(n.lookahead())?(n.lastIntValue=0,n.advance(),!0):!1};Xt.regexp_eatControlEscape=function(n){var e=n.current();return e===116?(n.lastIntValue=9,n.advance(),!0):e===110?(n.lastIntValue=10,n.advance(),!0):e===118?(n.lastIntValue=11,n.advance(),!0):e===102?(n.lastIntValue=12,n.advance(),!0):e===114?(n.lastIntValue=13,n.advance(),!0):!1};Xt.regexp_eatControlLetter=function(n){var e=n.current();return S_(e)?(n.lastIntValue=e%32,n.advance(),!0):!1};function S_(n){return n>=65&&n<=90||n>=97&&n<=122}Xt.regexp_eatRegExpUnicodeEscapeSequence=function(n,e){e===void 0&&(e=!1);var t=n.pos,s=e||n.switchU;if(n.eat(117)){if(this.regexp_eatFixedHexDigits(n,4)){var a=n.lastIntValue;if(s&&a>=55296&&a<=56319){var r=n.pos;if(n.eat(92)&&n.eat(117)&&this.regexp_eatFixedHexDigits(n,4)){var o=n.lastIntValue;if(o>=56320&&o<=57343)return n.lastIntValue=(a-55296)*1024+(o-56320)+65536,!0}n.pos=r,n.lastIntValue=a}return!0}if(s&&n.eat(123)&&this.regexp_eatHexDigits(n)&&n.eat(125)&&rfe(n.lastIntValue))return!0;s&&n.raise("Invalid unicode escape"),n.pos=t}return!1};function rfe(n){return n>=0&&n<=1114111}Xt.regexp_eatIdentityEscape=function(n){if(n.switchU)return this.regexp_eatSyntaxCharacter(n)?!0:n.eat(47)?(n.lastIntValue=47,!0):!1;var e=n.current();return e!==99&&(!n.switchN||e!==107)?(n.lastIntValue=e,n.advance(),!0):!1};Xt.regexp_eatDecimalEscape=function(n){n.lastIntValue=0;var e=n.current();if(e>=49&&e<=57){do n.lastIntValue=10*n.lastIntValue+(e-48),n.advance();while((e=n.current())>=48&&e<=57);return!0}return!1};var C_=0,Nc=1,ai=2;Xt.regexp_eatCharacterClassEscape=function(n){var e=n.current();if(ofe(e))return n.lastIntValue=-1,n.advance(),Nc;var t=!1;if(n.switchU&&this.options.ecmaVersion>=9&&((t=e===80)||e===112)){n.lastIntValue=-1,n.advance();var s;if(n.eat(123)&&(s=this.regexp_eatUnicodePropertyValueExpression(n))&&n.eat(125))return t&&s===ai&&n.raise("Invalid property name"),s;n.raise("Invalid property name")}return C_};function ofe(n){return n===100||n===68||n===115||n===83||n===119||n===87}Xt.regexp_eatUnicodePropertyValueExpression=function(n){var e=n.pos;if(this.regexp_eatUnicodePropertyName(n)&&n.eat(61)){var t=n.lastStringValue;if(this.regexp_eatUnicodePropertyValue(n)){var s=n.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(n,t,s),Nc}}if(n.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(n)){var a=n.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(n,a)}return C_};Xt.regexp_validateUnicodePropertyNameAndValue=function(n,e,t){Vm(n.unicodeProperties.nonBinary,e)||n.raise("Invalid property name"),n.unicodeProperties.nonBinary[e].test(t)||n.raise("Invalid property value")};Xt.regexp_validateUnicodePropertyNameOrValue=function(n,e){if(n.unicodeProperties.binary.test(e))return Nc;if(n.switchV&&n.unicodeProperties.binaryOfStrings.test(e))return ai;n.raise("Invalid property name")};Xt.regexp_eatUnicodePropertyName=function(n){var e=0;for(n.lastStringValue="";M_(e=n.current());)n.lastStringValue+=Fc(e),n.advance();return n.lastStringValue!==""};function M_(n){return S_(n)||n===95}Xt.regexp_eatUnicodePropertyValue=function(n){var e=0;for(n.lastStringValue="";ife(e=n.current());)n.lastStringValue+=Fc(e),n.advance();return n.lastStringValue!==""};function ife(n){return M_(n)||dw(n)}Xt.regexp_eatLoneUnicodePropertyNameOrValue=function(n){return this.regexp_eatUnicodePropertyValue(n)};Xt.regexp_eatCharacterClass=function(n){if(n.eat(91)){var e=n.eat(94),t=this.regexp_classContents(n);return n.eat(93)||n.raise("Unterminated character class"),e&&t===ai&&n.raise("Negated character class may contain strings"),!0}return!1};Xt.regexp_classContents=function(n){return n.current()===93?Nc:n.switchV?this.regexp_classSetExpression(n):(this.regexp_nonEmptyClassRanges(n),Nc)};Xt.regexp_nonEmptyClassRanges=function(n){for(;this.regexp_eatClassAtom(n);){var e=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassAtom(n)){var t=n.lastIntValue;n.switchU&&(e===-1||t===-1)&&n.raise("Invalid character class"),e!==-1&&t!==-1&&e>t&&n.raise("Range out of order in character class")}}};Xt.regexp_eatClassAtom=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatClassEscape(n))return!0;if(n.switchU){var t=n.current();(t===99||D_(t))&&n.raise("Invalid class escape"),n.raise("Invalid escape")}n.pos=e}var s=n.current();return s!==93?(n.lastIntValue=s,n.advance(),!0):!1};Xt.regexp_eatClassEscape=function(n){var e=n.pos;if(n.eat(98))return n.lastIntValue=8,!0;if(n.switchU&&n.eat(45))return n.lastIntValue=45,!0;if(!n.switchU&&n.eat(99)){if(this.regexp_eatClassControlLetter(n))return!0;n.pos=e}return this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)};Xt.regexp_classSetExpression=function(n){var e=Nc,t;if(!this.regexp_eatClassSetRange(n))if(t=this.regexp_eatClassSetOperand(n)){t===ai&&(e=ai);for(var s=n.pos;n.eatChars([38,38]);){if(n.current()!==38&&(t=this.regexp_eatClassSetOperand(n))){t!==ai&&(e=Nc);continue}n.raise("Invalid character in character class")}if(s!==n.pos)return e;for(;n.eatChars([45,45]);)this.regexp_eatClassSetOperand(n)||n.raise("Invalid character in character class");if(s!==n.pos)return e}else n.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(n)){if(t=this.regexp_eatClassSetOperand(n),!t)return e;t===ai&&(e=ai)}};Xt.regexp_eatClassSetRange=function(n){var e=n.pos;if(this.regexp_eatClassSetCharacter(n)){var t=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassSetCharacter(n)){var s=n.lastIntValue;return t!==-1&&s!==-1&&t>s&&n.raise("Range out of order in character class"),!0}n.pos=e}return!1};Xt.regexp_eatClassSetOperand=function(n){return this.regexp_eatClassSetCharacter(n)?Nc:this.regexp_eatClassStringDisjunction(n)||this.regexp_eatNestedClass(n)};Xt.regexp_eatNestedClass=function(n){var e=n.pos;if(n.eat(91)){var t=n.eat(94),s=this.regexp_classContents(n);if(n.eat(93))return t&&s===ai&&n.raise("Negated character class may contain strings"),s;n.pos=e}if(n.eat(92)){var a=this.regexp_eatCharacterClassEscape(n);if(a)return a;n.pos=e}return null};Xt.regexp_eatClassStringDisjunction=function(n){var e=n.pos;if(n.eatChars([92,113])){if(n.eat(123)){var t=this.regexp_classStringDisjunctionContents(n);if(n.eat(125))return t}else n.raise("Invalid escape");n.pos=e}return null};Xt.regexp_classStringDisjunctionContents=function(n){for(var e=this.regexp_classString(n);n.eat(124);)this.regexp_classString(n)===ai&&(e=ai);return e};Xt.regexp_classString=function(n){for(var e=0;this.regexp_eatClassSetCharacter(n);)e++;return e===1?Nc:ai};Xt.regexp_eatClassSetCharacter=function(n){var e=n.pos;if(n.eat(92))return this.regexp_eatCharacterEscape(n)||this.regexp_eatClassSetReservedPunctuator(n)?!0:n.eat(98)?(n.lastIntValue=8,!0):(n.pos=e,!1);var t=n.current();return t<0||t===n.lookahead()&&lfe(t)||cfe(t)?!1:(n.advance(),n.lastIntValue=t,!0)};function lfe(n){return n===33||n>=35&&n<=38||n>=42&&n<=44||n===46||n>=58&&n<=64||n===94||n===96||n===126}function cfe(n){return n===40||n===41||n===45||n===47||n>=91&&n<=93||n>=123&&n<=125}Xt.regexp_eatClassSetReservedPunctuator=function(n){var e=n.current();return ufe(e)?(n.lastIntValue=e,n.advance(),!0):!1};function ufe(n){return n===33||n===35||n===37||n===38||n===44||n===45||n>=58&&n<=62||n===64||n===96||n===126}Xt.regexp_eatClassControlLetter=function(n){var e=n.current();return dw(e)||e===95?(n.lastIntValue=e%32,n.advance(),!0):!1};Xt.regexp_eatHexEscapeSequence=function(n){var e=n.pos;if(n.eat(120)){if(this.regexp_eatFixedHexDigits(n,2))return!0;n.switchU&&n.raise("Invalid escape"),n.pos=e}return!1};Xt.regexp_eatDecimalDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;dw(t=n.current());)n.lastIntValue=10*n.lastIntValue+(t-48),n.advance();return n.pos!==e};function dw(n){return n>=48&&n<=57}Xt.regexp_eatHexDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;A_(t=n.current());)n.lastIntValue=16*n.lastIntValue+E_(t),n.advance();return n.pos!==e};function A_(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function E_(n){return n>=65&&n<=70?10+(n-65):n>=97&&n<=102?10+(n-97):n-48}Xt.regexp_eatLegacyOctalEscapeSequence=function(n){if(this.regexp_eatOctalDigit(n)){var e=n.lastIntValue;if(this.regexp_eatOctalDigit(n)){var t=n.lastIntValue;e<=3&&this.regexp_eatOctalDigit(n)?n.lastIntValue=e*64+t*8+n.lastIntValue:n.lastIntValue=e*8+t}else n.lastIntValue=e;return!0}return!1};Xt.regexp_eatOctalDigit=function(n){var e=n.current();return D_(e)?(n.lastIntValue=e-48,n.advance(),!0):(n.lastIntValue=0,!1)};function D_(n){return n>=48&&n<=55}Xt.regexp_eatFixedHexDigits=function(n,e){var t=n.pos;n.lastIntValue=0;for(var s=0;s<e;++s){var a=n.current();if(!A_(a))return n.pos=t,!1;n.lastIntValue=16*n.lastIntValue+E_(a),n.advance()}return!0};var mA=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new iw(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},Wn=Da.prototype;Wn.next=function(n){!n&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new mA(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};Wn.getToken=function(){return this.next(),new mA(this)};typeof Symbol<"u"&&(Wn[Symbol.iterator]=function(){var n=this;return{next:function(){var e=n.getToken();return{done:e.type===ae.eof,value:e}}}});Wn.nextToken=function(){var n=this.curContext();if((!n||!n.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(ae.eof);if(n.override)return n.override(this);this.readToken(this.fullCharCodeAtPos())};Wn.readToken=function(n){return zl(n,this.options.ecmaVersion>=6)||n===92?this.readWord():this.getTokenFromCode(n)};Wn.fullCharCodeAtPos=function(){var n=this.input.charCodeAt(this.pos);if(n<=55295||n>=56320)return n;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?n:(n<<10)+e-56613888};Wn.skipBlockComment=function(){var n=this.options.onComment&&this.curPosition(),e=this.pos,t=this.input.indexOf("*/",this.pos+=2);if(t===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=t+2,this.options.locations)for(var s=void 0,a=e;(s=e_(this.input,a,this.pos))>-1;)++this.curLine,a=this.lineStart=s;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,t),e,this.pos,n,this.curPosition())};Wn.skipLineComment=function(n){for(var e=this.pos,t=this.options.onComment&&this.curPosition(),s=this.input.charCodeAt(this.pos+=n);this.pos<this.input.length&&!Qm(s);)s=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+n,this.pos),e,this.pos,t,this.curPosition())};Wn.skipSpace=function(){e:for(;this.pos<this.input.length;){var n=this.input.charCodeAt(this.pos);switch(n){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(n>8&&n<14||n>=5760&&t_.test(String.fromCharCode(n)))++this.pos;else break e}}};Wn.finishToken=function(n,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var t=this.type;this.type=n,this.value=e,this.updateContext(t)};Wn.readToken_dot=function(){var n=this.input.charCodeAt(this.pos+1);if(n>=48&&n<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&n===46&&e===46?(this.pos+=3,this.finishToken(ae.ellipsis)):(++this.pos,this.finishToken(ae.dot))};Wn.readToken_slash=function(){var n=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):n===61?this.finishOp(ae.assign,2):this.finishOp(ae.slash,1)};Wn.readToken_mult_modulo_exp=function(n){var e=this.input.charCodeAt(this.pos+1),t=1,s=n===42?ae.star:ae.modulo;return this.options.ecmaVersion>=7&&n===42&&e===42&&(++t,s=ae.starstar,e=this.input.charCodeAt(this.pos+2)),e===61?this.finishOp(ae.assign,t+1):this.finishOp(s,t)};Wn.readToken_pipe_amp=function(n){var e=this.input.charCodeAt(this.pos+1);if(e===n){if(this.options.ecmaVersion>=12){var t=this.input.charCodeAt(this.pos+2);if(t===61)return this.finishOp(ae.assign,3)}return this.finishOp(n===124?ae.logicalOR:ae.logicalAND,2)}return e===61?this.finishOp(ae.assign,2):this.finishOp(n===124?ae.bitwiseOR:ae.bitwiseAND,1)};Wn.readToken_caret=function(){var n=this.input.charCodeAt(this.pos+1);return n===61?this.finishOp(ae.assign,2):this.finishOp(ae.bitwiseXOR,1)};Wn.readToken_plus_min=function(n){var e=this.input.charCodeAt(this.pos+1);return e===n?e===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||fo.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(ae.incDec,2):e===61?this.finishOp(ae.assign,2):this.finishOp(ae.plusMin,1)};Wn.readToken_lt_gt=function(n){var e=this.input.charCodeAt(this.pos+1),t=1;return e===n?(t=n===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+t)===61?this.finishOp(ae.assign,t+1):this.finishOp(ae.bitShift,t)):e===33&&n===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(e===61&&(t=2),this.finishOp(ae.relational,t))};Wn.readToken_eq_excl=function(n){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(ae.equality,this.input.charCodeAt(this.pos+2)===61?3:2):n===61&&e===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(ae.arrow)):this.finishOp(n===61?ae.eq:ae.prefix,1)};Wn.readToken_question=function(){var n=this.options.ecmaVersion;if(n>=11){var e=this.input.charCodeAt(this.pos+1);if(e===46){var t=this.input.charCodeAt(this.pos+2);if(t<48||t>57)return this.finishOp(ae.questionDot,2)}if(e===63){if(n>=12){var s=this.input.charCodeAt(this.pos+2);if(s===61)return this.finishOp(ae.assign,3)}return this.finishOp(ae.coalesce,2)}}return this.finishOp(ae.question,1)};Wn.readToken_numberSign=function(){var n=this.options.ecmaVersion,e=35;if(n>=13&&(++this.pos,e=this.fullCharCodeAtPos(),zl(e,!0)||e===92))return this.finishToken(ae.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Fc(e)+"'")};Wn.getTokenFromCode=function(n){switch(n){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(ae.parenL);case 41:return++this.pos,this.finishToken(ae.parenR);case 59:return++this.pos,this.finishToken(ae.semi);case 44:return++this.pos,this.finishToken(ae.comma);case 91:return++this.pos,this.finishToken(ae.bracketL);case 93:return++this.pos,this.finishToken(ae.bracketR);case 123:return++this.pos,this.finishToken(ae.braceL);case 125:return++this.pos,this.finishToken(ae.braceR);case 58:return++this.pos,this.finishToken(ae.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(ae.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(e===120||e===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(e===111||e===79)return this.readRadixNumber(8);if(e===98||e===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(n);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(n);case 124:case 38:return this.readToken_pipe_amp(n);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(n);case 60:case 62:return this.readToken_lt_gt(n);case 61:case 33:return this.readToken_eq_excl(n);case 63:return this.readToken_question();case 126:return this.finishOp(ae.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Fc(n)+"'")};Wn.finishOp=function(n,e){var t=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(n,t)};Wn.readRegexp=function(){for(var n,e,t=this.pos;;){this.pos>=this.input.length&&this.raise(t,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(fo.test(s)&&this.raise(t,"Unterminated regular expression"),n)n=!1;else{if(s==="[")e=!0;else if(s==="]"&&e)e=!1;else if(s==="/"&&!e)break;n=s==="\\"}++this.pos}var a=this.input.slice(t,this.pos);++this.pos;var r=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(r);var i=this.regexpState||(this.regexpState=new ec(this));i.reset(t,a,o),this.validateRegExpFlags(i),this.validateRegExpPattern(i);var l=null;try{l=new RegExp(a,o)}catch{}return this.finishToken(ae.regexp,{pattern:a,flags:o,value:l})};Wn.readInt=function(n,e,t){for(var s=this.options.ecmaVersion>=12&&e===void 0,a=t&&this.input.charCodeAt(this.pos)===48,r=this.pos,o=0,i=0,l=0,c=e??1/0;l<c;++l,++this.pos){var u=this.input.charCodeAt(this.pos),h=void 0;if(s&&u===95){a&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),i===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),i=u;continue}if(u>=97?h=u-97+10:u>=65?h=u-65+10:u>=48&&u<=57?h=u-48:h=1/0,h>=n)break;i=u,o=o*n+h}return s&&i===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===r||e!=null&&this.pos-r!==e?null:o};function hfe(n,e){return e?parseInt(n,8):parseFloat(n.replace(/_/g,""))}function T_(n){return typeof BigInt!="function"?null:BigInt(n.replace(/_/g,""))}Wn.readRadixNumber=function(n){var e=this.pos;this.pos+=2;var t=this.readInt(n);return t==null&&this.raise(this.start+2,"Expected number in radix "+n),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(t=T_(this.input.slice(e,this.pos)),++this.pos):zl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ae.num,t)};Wn.readNumber=function(n){var e=this.pos;!n&&this.readInt(10,void 0,!0)===null&&this.raise(e,"Invalid number");var t=this.pos-e>=2&&this.input.charCodeAt(e)===48;t&&this.strict&&this.raise(e,"Invalid number");var s=this.input.charCodeAt(this.pos);if(!t&&!n&&this.options.ecmaVersion>=11&&s===110){var a=T_(this.input.slice(e,this.pos));return++this.pos,zl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ae.num,a)}t&&/[89]/.test(this.input.slice(e,this.pos))&&(t=!1),s===46&&!t&&(++this.pos,this.readInt(10),s=this.input.charCodeAt(this.pos)),(s===69||s===101)&&!t&&(s=this.input.charCodeAt(++this.pos),(s===43||s===45)&&++this.pos,this.readInt(10)===null&&this.raise(e,"Invalid number")),zl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var r=hfe(this.input.slice(e,this.pos),t);return this.finishToken(ae.num,r)};Wn.readCodePoint=function(){var n=this.input.charCodeAt(this.pos),e;if(n===123){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e};Wn.readString=function(n){for(var e="",t=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var s=this.input.charCodeAt(this.pos);if(s===n)break;s===92?(e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!1),t=this.pos):s===8232||s===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(Qm(s)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(t,this.pos++),this.finishToken(ae.string,e)};var F_={};Wn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(n){if(n===F_)this.readInvalidTemplateToken();else throw n}this.inTemplateElement=!1};Wn.invalidStringToken=function(n,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw F_;this.raise(n,e)};Wn.readTmplToken=function(){for(var n="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var t=this.input.charCodeAt(this.pos);if(t===96||t===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===ae.template||this.type===ae.invalidTemplate)?t===36?(this.pos+=2,this.finishToken(ae.dollarBraceL)):(++this.pos,this.finishToken(ae.backQuote)):(n+=this.input.slice(e,this.pos),this.finishToken(ae.template,n));if(t===92)n+=this.input.slice(e,this.pos),n+=this.readEscapedChar(!0),e=this.pos;else if(Qm(t)){switch(n+=this.input.slice(e,this.pos),++this.pos,t){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:n+=`
`;break;default:n+=String.fromCharCode(t);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}};Wn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(ae.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};Wn.readEscapedChar=function(n){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Fc(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),n){var t=this.pos-1;this.invalidStringToken(t,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],a=parseInt(s,8);return a>255&&(s=s.slice(0,-1),a=parseInt(s,8)),this.pos+=s.length-1,e=this.input.charCodeAt(this.pos),(s!=="0"||e===56||e===57)&&(this.strict||n)&&this.invalidStringToken(this.pos-1-s.length,n?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(a)}return Qm(e)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(e)}};Wn.readHexChar=function(n){var e=this.pos,t=this.readInt(16,n);return t===null&&this.invalidStringToken(e,"Bad character escape sequence"),t};Wn.readWord1=function(){this.containsEsc=!1;for(var n="",e=!0,t=this.pos,s=this.options.ecmaVersion>=6;this.pos<this.input.length;){var a=this.fullCharCodeAtPos();if(Du(a,s))this.pos+=a<=65535?1:2;else if(a===92){this.containsEsc=!0,n+=this.input.slice(t,this.pos);var r=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(e?zl:Du)(o,s)||this.invalidStringToken(r,"Invalid Unicode escape"),n+=Fc(o),t=this.pos}else break;e=!1}return n+this.input.slice(t,this.pos)};Wn.readWord=function(){var n=this.readWord1(),e=ae.name;return this.keywords.test(n)&&(e=iA[n]),this.finishToken(e,n)};var dfe="8.15.0";Da.acorn={Parser:Da,version:dfe,defaultOptions:D2,Position:tg,SourceLocation:iw,getLineInfo:s_,Node:hw,TokenType:ts,tokTypes:ae,keywordTypes:iA,TokContext:Bi,tokContexts:qs,isIdentifierChar:Du,isIdentifierStart:zl,Token:mA,isNewLine:Qm,lineBreak:fo,lineBreakG:Bpe,nonASCIIwhitespace:t_};function mfe(n,e){return Da.parse(n,e)}var fx={},gx={},X7;function pfe(){return X7||(X7=1,(function(n){(function e(t){var s,a,r,o,i,l;function c(F){var _={},$,Z;for($ in F)F.hasOwnProperty($)&&(Z=F[$],typeof Z=="object"&&Z!==null?_[$]=c(Z):_[$]=Z);return _}function u(F,_){var $,Z,ce,U;for(Z=F.length,ce=0;Z;)$=Z>>>1,U=ce+$,_(F[U])?Z=$:(ce=U+1,Z-=$+1);return ce}s={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},r={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},o={},i={},l={},a={Break:o,Skip:i,Remove:l};function h(F,_){this.parent=F,this.key=_}h.prototype.replace=function(_){this.parent[this.key]=_},h.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function m(F,_,$,Z){this.node=F,this.path=_,this.wrap=$,this.ref=Z}function f(){}f.prototype.path=function(){var _,$,Z,ce,U,ue;function W(de,be){if(Array.isArray(be))for(Z=0,ce=be.length;Z<ce;++Z)de.push(be[Z]);else de.push(be)}if(!this.__current.path)return null;for(U=[],_=2,$=this.__leavelist.length;_<$;++_)ue=this.__leavelist[_],W(U,ue.path);return W(U,this.__current.path),U},f.prototype.type=function(){var F=this.current();return F.type||this.__current.wrap},f.prototype.parents=function(){var _,$,Z;for(Z=[],_=1,$=this.__leavelist.length;_<$;++_)Z.push(this.__leavelist[_].node);return Z},f.prototype.current=function(){return this.__current.node},f.prototype.__execute=function(_,$){var Z,ce;return ce=void 0,Z=this.__current,this.__current=$,this.__state=null,_&&(ce=_.call(this,$.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=Z,ce},f.prototype.notify=function(_){this.__state=_},f.prototype.skip=function(){this.notify(i)},f.prototype.break=function(){this.notify(o)},f.prototype.remove=function(){this.notify(l)},f.prototype.__initialize=function(F,_){this.visitor=_,this.root=F,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,_.fallback==="iteration"?this.__fallback=Object.keys:typeof _.fallback=="function"&&(this.__fallback=_.fallback),this.__keys=r,_.keys&&(this.__keys=Object.assign(Object.create(this.__keys),_.keys))};function v(F){return F==null?!1:typeof F=="object"&&typeof F.type=="string"}function O(F,_){return(F===s.ObjectExpression||F===s.ObjectPattern)&&_==="properties"}function k(F,_){for(var $=F.length-1;$>=0;--$)if(F[$].node===_)return!0;return!1}f.prototype.traverse=function(_,$){var Z,ce,U,ue,W,de,be,ke,Ce,Ae,q,Ne;for(this.__initialize(_,$),Ne={},Z=this.__worklist,ce=this.__leavelist,Z.push(new m(_,null,null,null)),ce.push(new m(null,null,null,null));Z.length;){if(U=Z.pop(),U===Ne){if(U=ce.pop(),de=this.__execute($.leave,U),this.__state===o||de===o)return;continue}if(U.node){if(de=this.__execute($.enter,U),this.__state===o||de===o)return;if(Z.push(Ne),ce.push(U),this.__state===i||de===i)continue;if(ue=U.node,W=ue.type||U.wrap,Ae=this.__keys[W],!Ae)if(this.__fallback)Ae=this.__fallback(ue);else throw new Error("Unknown node type "+W+".");for(ke=Ae.length;(ke-=1)>=0;)if(be=Ae[ke],q=ue[be],!!q){if(Array.isArray(q)){for(Ce=q.length;(Ce-=1)>=0;)if(q[Ce]&&!k(ce,q[Ce])){if(O(W,Ae[ke]))U=new m(q[Ce],[be,Ce],"Property",null);else if(v(q[Ce]))U=new m(q[Ce],[be,Ce],null,null);else continue;Z.push(U)}}else if(v(q)){if(k(ce,q))continue;Z.push(new m(q,be,null,null))}}}}},f.prototype.replace=function(_,$){var Z,ce,U,ue,W,de,be,ke,Ce,Ae,q,Ne,Re;function je(me){var Ye,ft,_e,Ge;if(me.ref.remove()){for(ft=me.ref.key,Ge=me.ref.parent,Ye=Z.length;Ye--;)if(_e=Z[Ye],_e.ref&&_e.ref.parent===Ge){if(_e.ref.key<ft)break;--_e.ref.key}}}for(this.__initialize(_,$),q={},Z=this.__worklist,ce=this.__leavelist,Ne={root:_},de=new m(_,null,null,new h(Ne,"root")),Z.push(de),ce.push(de);Z.length;){if(de=Z.pop(),de===q){if(de=ce.pop(),W=this.__execute($.leave,de),W!==void 0&&W!==o&&W!==i&&W!==l&&de.ref.replace(W),(this.__state===l||W===l)&&je(de),this.__state===o||W===o)return Ne.root;continue}if(W=this.__execute($.enter,de),W!==void 0&&W!==o&&W!==i&&W!==l&&(de.ref.replace(W),de.node=W),(this.__state===l||W===l)&&(je(de),de.node=null),this.__state===o||W===o)return Ne.root;if(U=de.node,!!U&&(Z.push(q),ce.push(de),!(this.__state===i||W===i))){if(ue=U.type||de.wrap,Ce=this.__keys[ue],!Ce)if(this.__fallback)Ce=this.__fallback(U);else throw new Error("Unknown node type "+ue+".");for(be=Ce.length;(be-=1)>=0;)if(Re=Ce[be],Ae=U[Re],!!Ae)if(Array.isArray(Ae)){for(ke=Ae.length;(ke-=1)>=0;)if(Ae[ke]){if(O(ue,Ce[be]))de=new m(Ae[ke],[Re,ke],"Property",new h(Ae,ke));else if(v(Ae[ke]))de=new m(Ae[ke],[Re,ke],null,new h(Ae,ke));else continue;Z.push(de)}}else v(Ae)&&Z.push(new m(Ae,Re,null,new h(U,Re)))}}return Ne.root};function M(F,_){var $=new f;return $.traverse(F,_)}function E(F,_){var $=new f;return $.replace(F,_)}function I(F,_){var $;return $=u(_,function(ce){return ce.range[0]>F.range[0]}),F.extendedRange=[F.range[0],F.range[1]],$!==_.length&&(F.extendedRange[1]=_[$].range[0]),$-=1,$>=0&&(F.extendedRange[0]=_[$].range[1]),F}function D(F,_,$){var Z=[],ce,U,ue,W;if(!F.range)throw new Error("attachComments needs range information");if(!$.length){if(_.length){for(ue=0,U=_.length;ue<U;ue+=1)ce=c(_[ue]),ce.extendedRange=[0,F.range[0]],Z.push(ce);F.leadingComments=Z}return F}for(ue=0,U=_.length;ue<U;ue+=1)Z.push(I(c(_[ue]),$));return W=0,M(F,{enter:function(de){for(var be;W<Z.length&&(be=Z[W],!(be.extendedRange[1]>de.range[0]));)be.extendedRange[1]===de.range[0]?(de.leadingComments||(de.leadingComments=[]),de.leadingComments.push(be),Z.splice(W,1)):W+=1;if(W===Z.length)return a.Break;if(Z[W].extendedRange[0]>de.range[1])return a.Skip}}),W=0,M(F,{leave:function(de){for(var be;W<Z.length&&(be=Z[W],!(de.range[1]<be.extendedRange[0]));)de.range[1]===be.extendedRange[0]?(de.trailingComments||(de.trailingComments=[]),de.trailingComments.push(be),Z.splice(W,1)):W+=1;if(W===Z.length)return a.Break;if(Z[W].extendedRange[0]>de.range[1])return a.Skip}}),F}return t.Syntax=s,t.traverse=M,t.replace=E,t.attachComments=D,t.VisitorKeys=r,t.VisitorOption=a,t.Controller=f,t.cloneEnvironment=function(){return e({})},t})(n)})(gx)),gx}var Pp={},bx={exports:{}},W7;function ffe(){return W7||(W7=1,(function(){function n(o){if(o==null)return!1;switch(o.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function e(o){if(o==null)return!1;switch(o.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function t(o){if(o==null)return!1;switch(o.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function s(o){return t(o)||o!=null&&o.type==="FunctionDeclaration"}function a(o){switch(o.type){case"IfStatement":return o.alternate!=null?o.alternate:o.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return o.body}return null}function r(o){var i;if(o.type!=="IfStatement"||o.alternate==null)return!1;i=o.consequent;do{if(i.type==="IfStatement"&&i.alternate==null)return!0;i=a(i)}while(i);return!1}bx.exports={isExpression:n,isStatement:t,isIterationStatement:e,isSourceElement:s,isProblematicIfStatement:r,trailingStatement:a}})()),bx.exports}var yx={exports:{}},q7;function N_(){return q7||(q7=1,(function(){var n,e,t,s,a,r;e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},n={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function o(k){return 48<=k&&k<=57}function i(k){return 48<=k&&k<=57||97<=k&&k<=102||65<=k&&k<=70}function l(k){return k>=48&&k<=55}t=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function c(k){return k===32||k===9||k===11||k===12||k===160||k>=5760&&t.indexOf(k)>=0}function u(k){return k===10||k===13||k===8232||k===8233}function h(k){if(k<=65535)return String.fromCharCode(k);var M=String.fromCharCode(Math.floor((k-65536)/1024)+55296),E=String.fromCharCode((k-65536)%1024+56320);return M+E}for(s=new Array(128),r=0;r<128;++r)s[r]=r>=97&&r<=122||r>=65&&r<=90||r===36||r===95;for(a=new Array(128),r=0;r<128;++r)a[r]=r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||r===36||r===95;function m(k){return k<128?s[k]:e.NonAsciiIdentifierStart.test(h(k))}function f(k){return k<128?a[k]:e.NonAsciiIdentifierPart.test(h(k))}function v(k){return k<128?s[k]:n.NonAsciiIdentifierStart.test(h(k))}function O(k){return k<128?a[k]:n.NonAsciiIdentifierPart.test(h(k))}yx.exports={isDecimalDigit:o,isHexDigit:i,isOctalDigit:l,isWhiteSpace:c,isLineTerminator:u,isIdentifierStartES5:m,isIdentifierPartES5:f,isIdentifierStartES6:v,isIdentifierPartES6:O}})()),yx.exports}var vx={exports:{}},U7;function gfe(){return U7||(U7=1,(function(){var n=N_();function e(m){switch(m){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function t(m,f){return!f&&m==="yield"?!1:s(m,f)}function s(m,f){if(f&&e(m))return!0;switch(m.length){case 2:return m==="if"||m==="in"||m==="do";case 3:return m==="var"||m==="for"||m==="new"||m==="try";case 4:return m==="this"||m==="else"||m==="case"||m==="void"||m==="with"||m==="enum";case 5:return m==="while"||m==="break"||m==="catch"||m==="throw"||m==="const"||m==="yield"||m==="class"||m==="super";case 6:return m==="return"||m==="typeof"||m==="delete"||m==="switch"||m==="export"||m==="import";case 7:return m==="default"||m==="finally"||m==="extends";case 8:return m==="function"||m==="continue"||m==="debugger";case 10:return m==="instanceof";default:return!1}}function a(m,f){return m==="null"||m==="true"||m==="false"||t(m,f)}function r(m,f){return m==="null"||m==="true"||m==="false"||s(m,f)}function o(m){return m==="eval"||m==="arguments"}function i(m){var f,v,O;if(m.length===0||(O=m.charCodeAt(0),!n.isIdentifierStartES5(O)))return!1;for(f=1,v=m.length;f<v;++f)if(O=m.charCodeAt(f),!n.isIdentifierPartES5(O))return!1;return!0}function l(m,f){return(m-55296)*1024+(f-56320)+65536}function c(m){var f,v,O,k,M;if(m.length===0)return!1;for(M=n.isIdentifierStartES6,f=0,v=m.length;f<v;++f){if(O=m.charCodeAt(f),55296<=O&&O<=56319){if(++f,f>=v||(k=m.charCodeAt(f),!(56320<=k&&k<=57343)))return!1;O=l(O,k)}if(!M(O))return!1;M=n.isIdentifierPartES6}return!0}function u(m,f){return i(m)&&!a(m,f)}function h(m,f){return c(m)&&!r(m,f)}vx.exports={isKeywordES5:t,isKeywordES6:s,isReservedWordES5:a,isReservedWordES6:r,isRestrictedWord:o,isIdentifierNameES5:i,isIdentifierNameES6:c,isIdentifierES5:u,isIdentifierES6:h}})()),vx.exports}var H7;function bfe(){return H7||(H7=1,(function(){Pp.ast=ffe(),Pp.code=N_(),Pp.keyword=gfe()})()),Pp}var Sp={},wx={},Q0={},V0={},Y7;function yfe(){if(Y7)return V0;Y7=1;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return V0.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},V0.decode=function(e){var t=65,s=90,a=97,r=122,o=48,i=57,l=43,c=47,u=26,h=52;return t<=e&&e<=s?e-t:a<=e&&e<=r?e-a+u:o<=e&&e<=i?e-o+h:e==l?62:e==c?63:-1},V0}var K7;function B_(){if(K7)return Q0;K7=1;var n=yfe(),e=5,t=1<<e,s=t-1,a=t;function r(i){return i<0?(-i<<1)+1:(i<<1)+0}function o(i){var l=(i&1)===1,c=i>>1;return l?-c:c}return Q0.encode=function(l){var c="",u,h=r(l);do u=h&s,h>>>=e,h>0&&(u|=a),c+=n.encode(u);while(h>0);return c},Q0.decode=function(l,c,u){var h=l.length,m=0,f=0,v,O;do{if(c>=h)throw new Error("Expected more digits in base 64 VLQ value.");if(O=n.decode(l.charCodeAt(c++)),O===-1)throw new Error("Invalid base64 digit: "+l.charAt(c-1));v=!!(O&a),O&=s,m=m+(O<<f),f+=e}while(v);u.value=o(m),u.rest=c},Q0}var Ox={},J7;function Xg(){return J7||(J7=1,(function(n){function e(D,F,_){if(F in D)return D[F];if(arguments.length===3)return _;throw new Error('"'+F+'" is a required argument.')}n.getArg=e;var t=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,s=/^data:.+\,.+$/;function a(D){var F=D.match(t);return F?{scheme:F[1],auth:F[2],host:F[3],port:F[4],path:F[5]}:null}n.urlParse=a;function r(D){var F="";return D.scheme&&(F+=D.scheme+":"),F+="//",D.auth&&(F+=D.auth+"@"),D.host&&(F+=D.host),D.port&&(F+=":"+D.port),D.path&&(F+=D.path),F}n.urlGenerate=r;function o(D){var F=D,_=a(D);if(_){if(!_.path)return D;F=_.path}for(var $=n.isAbsolute(F),Z=F.split(/\/+/),ce,U=0,ue=Z.length-1;ue>=0;ue--)ce=Z[ue],ce==="."?Z.splice(ue,1):ce===".."?U++:U>0&&(ce===""?(Z.splice(ue+1,U),U=0):(Z.splice(ue,2),U--));return F=Z.join("/"),F===""&&(F=$?"/":"."),_?(_.path=F,r(_)):F}n.normalize=o;function i(D,F){D===""&&(D="."),F===""&&(F=".");var _=a(F),$=a(D);if($&&(D=$.path||"/"),_&&!_.scheme)return $&&(_.scheme=$.scheme),r(_);if(_||F.match(s))return F;if($&&!$.host&&!$.path)return $.host=F,r($);var Z=F.charAt(0)==="/"?F:o(D.replace(/\/+$/,"")+"/"+F);return $?($.path=Z,r($)):Z}n.join=i,n.isAbsolute=function(D){return D.charAt(0)==="/"||t.test(D)};function l(D,F){D===""&&(D="."),D=D.replace(/\/$/,"");for(var _=0;F.indexOf(D+"/")!==0;){var $=D.lastIndexOf("/");if($<0||(D=D.slice(0,$),D.match(/^([^\/]+:\/)?\/*$/)))return F;++_}return Array(_+1).join("../")+F.substr(D.length+1)}n.relative=l;var c=(function(){var D=Object.create(null);return!("__proto__"in D)})();function u(D){return D}function h(D){return f(D)?"$"+D:D}n.toSetString=c?u:h;function m(D){return f(D)?D.slice(1):D}n.fromSetString=c?u:m;function f(D){if(!D)return!1;var F=D.length;if(F<9||D.charCodeAt(F-1)!==95||D.charCodeAt(F-2)!==95||D.charCodeAt(F-3)!==111||D.charCodeAt(F-4)!==116||D.charCodeAt(F-5)!==111||D.charCodeAt(F-6)!==114||D.charCodeAt(F-7)!==112||D.charCodeAt(F-8)!==95||D.charCodeAt(F-9)!==95)return!1;for(var _=F-10;_>=0;_--)if(D.charCodeAt(_)!==36)return!1;return!0}function v(D,F,_){var $=k(D.source,F.source);return $!==0||($=D.originalLine-F.originalLine,$!==0)||($=D.originalColumn-F.originalColumn,$!==0||_)||($=D.generatedColumn-F.generatedColumn,$!==0)||($=D.generatedLine-F.generatedLine,$!==0)?$:k(D.name,F.name)}n.compareByOriginalPositions=v;function O(D,F,_){var $=D.generatedLine-F.generatedLine;return $!==0||($=D.generatedColumn-F.generatedColumn,$!==0||_)||($=k(D.source,F.source),$!==0)||($=D.originalLine-F.originalLine,$!==0)||($=D.originalColumn-F.originalColumn,$!==0)?$:k(D.name,F.name)}n.compareByGeneratedPositionsDeflated=O;function k(D,F){return D===F?0:D===null?1:F===null?-1:D>F?1:-1}function M(D,F){var _=D.generatedLine-F.generatedLine;return _!==0||(_=D.generatedColumn-F.generatedColumn,_!==0)||(_=k(D.source,F.source),_!==0)||(_=D.originalLine-F.originalLine,_!==0)||(_=D.originalColumn-F.originalColumn,_!==0)?_:k(D.name,F.name)}n.compareByGeneratedPositionsInflated=M;function E(D){return JSON.parse(D.replace(/^\)]}'[^\n]*\n/,""))}n.parseSourceMapInput=E;function I(D,F,_){if(F=F||"",D&&(D[D.length-1]!=="/"&&F[0]!=="/"&&(D+="/"),F=D+F),_){var $=a(_);if(!$)throw new Error("sourceMapURL could not be parsed");if($.path){var Z=$.path.lastIndexOf("/");Z>=0&&($.path=$.path.substring(0,Z+1))}F=i(r($),F)}return o(F)}n.computeSourceURL=I})(Ox)),Ox}var xx={},e9;function $_(){if(e9)return xx;e9=1;var n=Xg(),e=Object.prototype.hasOwnProperty,t=typeof Map<"u";function s(){this._array=[],this._set=t?new Map:Object.create(null)}return s.fromArray=function(r,o){for(var i=new s,l=0,c=r.length;l<c;l++)i.add(r[l],o);return i},s.prototype.size=function(){return t?this._set.size:Object.getOwnPropertyNames(this._set).length},s.prototype.add=function(r,o){var i=t?r:n.toSetString(r),l=t?this.has(r):e.call(this._set,i),c=this._array.length;(!l||o)&&this._array.push(r),l||(t?this._set.set(r,c):this._set[i]=c)},s.prototype.has=function(r){if(t)return this._set.has(r);var o=n.toSetString(r);return e.call(this._set,o)},s.prototype.indexOf=function(r){if(t){var o=this._set.get(r);if(o>=0)return o}else{var i=n.toSetString(r);if(e.call(this._set,i))return this._set[i]}throw new Error('"'+r+'" is not in the set.')},s.prototype.at=function(r){if(r>=0&&r<this._array.length)return this._array[r];throw new Error("No element indexed by "+r)},s.prototype.toArray=function(){return this._array.slice()},xx.ArraySet=s,xx}var kx={},t9;function vfe(){if(t9)return kx;t9=1;var n=Xg();function e(s,a){var r=s.generatedLine,o=a.generatedLine,i=s.generatedColumn,l=a.generatedColumn;return o>r||o==r&&l>=i||n.compareByGeneratedPositionsInflated(s,a)<=0}function t(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return t.prototype.unsortedForEach=function(a,r){this._array.forEach(a,r)},t.prototype.add=function(a){e(this._last,a)?(this._last=a,this._array.push(a)):(this._sorted=!1,this._array.push(a))},t.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},kx.MappingList=t,kx}var n9;function R_(){if(n9)return wx;n9=1;var n=B_(),e=Xg(),t=$_().ArraySet,s=vfe().MappingList;function a(r){r||(r={}),this._file=e.getArg(r,"file",null),this._sourceRoot=e.getArg(r,"sourceRoot",null),this._skipValidation=e.getArg(r,"skipValidation",!1),this._sources=new t,this._names=new t,this._mappings=new s,this._sourcesContents=null}return a.prototype._version=3,a.fromSourceMap=function(o){var i=o.sourceRoot,l=new a({file:o.file,sourceRoot:i});return o.eachMapping(function(c){var u={generated:{line:c.generatedLine,column:c.generatedColumn}};c.source!=null&&(u.source=c.source,i!=null&&(u.source=e.relative(i,u.source)),u.original={line:c.originalLine,column:c.originalColumn},c.name!=null&&(u.name=c.name)),l.addMapping(u)}),o.sources.forEach(function(c){var u=c;i!==null&&(u=e.relative(i,c)),l._sources.has(u)||l._sources.add(u);var h=o.sourceContentFor(c);h!=null&&l.setSourceContent(c,h)}),l},a.prototype.addMapping=function(o){var i=e.getArg(o,"generated"),l=e.getArg(o,"original",null),c=e.getArg(o,"source",null),u=e.getArg(o,"name",null);this._skipValidation||this._validateMapping(i,l,c,u),c!=null&&(c=String(c),this._sources.has(c)||this._sources.add(c)),u!=null&&(u=String(u),this._names.has(u)||this._names.add(u)),this._mappings.add({generatedLine:i.line,generatedColumn:i.column,originalLine:l!=null&&l.line,originalColumn:l!=null&&l.column,source:c,name:u})},a.prototype.setSourceContent=function(o,i){var l=o;this._sourceRoot!=null&&(l=e.relative(this._sourceRoot,l)),i!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(l)]=i):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(l)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},a.prototype.applySourceMap=function(o,i,l){var c=i;if(i==null){if(o.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);c=o.file}var u=this._sourceRoot;u!=null&&(c=e.relative(u,c));var h=new t,m=new t;this._mappings.unsortedForEach(function(f){if(f.source===c&&f.originalLine!=null){var v=o.originalPositionFor({line:f.originalLine,column:f.originalColumn});v.source!=null&&(f.source=v.source,l!=null&&(f.source=e.join(l,f.source)),u!=null&&(f.source=e.relative(u,f.source)),f.originalLine=v.line,f.originalColumn=v.column,v.name!=null&&(f.name=v.name))}var O=f.source;O!=null&&!h.has(O)&&h.add(O);var k=f.name;k!=null&&!m.has(k)&&m.add(k)},this),this._sources=h,this._names=m,o.sources.forEach(function(f){var v=o.sourceContentFor(f);v!=null&&(l!=null&&(f=e.join(l,f)),u!=null&&(f=e.relative(u,f)),this.setSourceContent(f,v))},this)},a.prototype._validateMapping=function(o,i,l,c){if(i&&typeof i.line!="number"&&typeof i.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(o&&"line"in o&&"column"in o&&o.line>0&&o.column>=0&&!i&&!l&&!c)){if(o&&"line"in o&&"column"in o&&i&&"line"in i&&"column"in i&&o.line>0&&o.column>=0&&i.line>0&&i.column>=0&&l)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:o,source:l,original:i,name:c}))}},a.prototype._serializeMappings=function(){for(var o=0,i=1,l=0,c=0,u=0,h=0,m="",f,v,O,k,M=this._mappings.toArray(),E=0,I=M.length;E<I;E++){if(v=M[E],f="",v.generatedLine!==i)for(o=0;v.generatedLine!==i;)f+=";",i++;else if(E>0){if(!e.compareByGeneratedPositionsInflated(v,M[E-1]))continue;f+=","}f+=n.encode(v.generatedColumn-o),o=v.generatedColumn,v.source!=null&&(k=this._sources.indexOf(v.source),f+=n.encode(k-h),h=k,f+=n.encode(v.originalLine-1-c),c=v.originalLine-1,f+=n.encode(v.originalColumn-l),l=v.originalColumn,v.name!=null&&(O=this._names.indexOf(v.name),f+=n.encode(O-u),u=O)),m+=f}return m},a.prototype._generateSourcesContent=function(o,i){return o.map(function(l){if(!this._sourcesContents)return null;i!=null&&(l=e.relative(i,l));var c=e.toSetString(l);return Object.prototype.hasOwnProperty.call(this._sourcesContents,c)?this._sourcesContents[c]:null},this)},a.prototype.toJSON=function(){var o={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(o.file=this._file),this._sourceRoot!=null&&(o.sourceRoot=this._sourceRoot),this._sourcesContents&&(o.sourcesContent=this._generateSourcesContent(o.sources,o.sourceRoot)),o},a.prototype.toString=function(){return JSON.stringify(this.toJSON())},wx.SourceMapGenerator=a,wx}var Cp={},Px={},s9;function wfe(){return s9||(s9=1,(function(n){n.GREATEST_LOWER_BOUND=1,n.LEAST_UPPER_BOUND=2;function e(t,s,a,r,o,i){var l=Math.floor((s-t)/2)+t,c=o(a,r[l],!0);return c===0?l:c>0?s-l>1?e(l,s,a,r,o,i):i==n.LEAST_UPPER_BOUND?s<r.length?s:-1:l:l-t>1?e(t,l,a,r,o,i):i==n.LEAST_UPPER_BOUND?l:t<0?-1:t}n.search=function(s,a,r,o){if(a.length===0)return-1;var i=e(-1,a.length,s,a,r,o||n.GREATEST_LOWER_BOUND);if(i<0)return-1;for(;i-1>=0&&r(a[i],a[i-1],!0)===0;)--i;return i}})(Px)),Px}var Sx={},a9;function Ofe(){if(a9)return Sx;a9=1;function n(s,a,r){var o=s[a];s[a]=s[r],s[r]=o}function e(s,a){return Math.round(s+Math.random()*(a-s))}function t(s,a,r,o){if(r<o){var i=e(r,o),l=r-1;n(s,i,o);for(var c=s[o],u=r;u<o;u++)a(s[u],c)<=0&&(l+=1,n(s,l,u));n(s,l+1,u);var h=l+1;t(s,a,r,h-1),t(s,a,h+1,o)}}return Sx.quickSort=function(s,a){t(s,a,0,s.length-1)},Sx}var r9;function xfe(){if(r9)return Cp;r9=1;var n=Xg(),e=wfe(),t=$_().ArraySet,s=B_(),a=Ofe().quickSort;function r(c,u){var h=c;return typeof c=="string"&&(h=n.parseSourceMapInput(c)),h.sections!=null?new l(h,u):new o(h,u)}r.fromSourceMap=function(c,u){return o.fromSourceMap(c,u)},r.prototype._version=3,r.prototype.__generatedMappings=null,Object.defineProperty(r.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),r.prototype.__originalMappings=null,Object.defineProperty(r.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),r.prototype._charIsMappingSeparator=function(u,h){var m=u.charAt(h);return m===";"||m===","},r.prototype._parseMappings=function(u,h){throw new Error("Subclasses must implement _parseMappings")},r.GENERATED_ORDER=1,r.ORIGINAL_ORDER=2,r.GREATEST_LOWER_BOUND=1,r.LEAST_UPPER_BOUND=2,r.prototype.eachMapping=function(u,h,m){var f=h||null,v=m||r.GENERATED_ORDER,O;switch(v){case r.GENERATED_ORDER:O=this._generatedMappings;break;case r.ORIGINAL_ORDER:O=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var k=this.sourceRoot;O.map(function(M){var E=M.source===null?null:this._sources.at(M.source);return E=n.computeSourceURL(k,E,this._sourceMapURL),{source:E,generatedLine:M.generatedLine,generatedColumn:M.generatedColumn,originalLine:M.originalLine,originalColumn:M.originalColumn,name:M.name===null?null:this._names.at(M.name)}},this).forEach(u,f)},r.prototype.allGeneratedPositionsFor=function(u){var h=n.getArg(u,"line"),m={source:n.getArg(u,"source"),originalLine:h,originalColumn:n.getArg(u,"column",0)};if(m.source=this._findSourceIndex(m.source),m.source<0)return[];var f=[],v=this._findMapping(m,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(v>=0){var O=this._originalMappings[v];if(u.column===void 0)for(var k=O.originalLine;O&&O.originalLine===k;)f.push({line:n.getArg(O,"generatedLine",null),column:n.getArg(O,"generatedColumn",null),lastColumn:n.getArg(O,"lastGeneratedColumn",null)}),O=this._originalMappings[++v];else for(var M=O.originalColumn;O&&O.originalLine===h&&O.originalColumn==M;)f.push({line:n.getArg(O,"generatedLine",null),column:n.getArg(O,"generatedColumn",null),lastColumn:n.getArg(O,"lastGeneratedColumn",null)}),O=this._originalMappings[++v]}return f},Cp.SourceMapConsumer=r;function o(c,u){var h=c;typeof c=="string"&&(h=n.parseSourceMapInput(c));var m=n.getArg(h,"version"),f=n.getArg(h,"sources"),v=n.getArg(h,"names",[]),O=n.getArg(h,"sourceRoot",null),k=n.getArg(h,"sourcesContent",null),M=n.getArg(h,"mappings"),E=n.getArg(h,"file",null);if(m!=this._version)throw new Error("Unsupported version: "+m);O&&(O=n.normalize(O)),f=f.map(String).map(n.normalize).map(function(I){return O&&n.isAbsolute(O)&&n.isAbsolute(I)?n.relative(O,I):I}),this._names=t.fromArray(v.map(String),!0),this._sources=t.fromArray(f,!0),this._absoluteSources=this._sources.toArray().map(function(I){return n.computeSourceURL(O,I,u)}),this.sourceRoot=O,this.sourcesContent=k,this._mappings=M,this._sourceMapURL=u,this.file=E}o.prototype=Object.create(r.prototype),o.prototype.consumer=r,o.prototype._findSourceIndex=function(c){var u=c;if(this.sourceRoot!=null&&(u=n.relative(this.sourceRoot,u)),this._sources.has(u))return this._sources.indexOf(u);var h;for(h=0;h<this._absoluteSources.length;++h)if(this._absoluteSources[h]==c)return h;return-1},o.fromSourceMap=function(u,h){var m=Object.create(o.prototype),f=m._names=t.fromArray(u._names.toArray(),!0),v=m._sources=t.fromArray(u._sources.toArray(),!0);m.sourceRoot=u._sourceRoot,m.sourcesContent=u._generateSourcesContent(m._sources.toArray(),m.sourceRoot),m.file=u._file,m._sourceMapURL=h,m._absoluteSources=m._sources.toArray().map(function(_){return n.computeSourceURL(m.sourceRoot,_,h)});for(var O=u._mappings.toArray().slice(),k=m.__generatedMappings=[],M=m.__originalMappings=[],E=0,I=O.length;E<I;E++){var D=O[E],F=new i;F.generatedLine=D.generatedLine,F.generatedColumn=D.generatedColumn,D.source&&(F.source=v.indexOf(D.source),F.originalLine=D.originalLine,F.originalColumn=D.originalColumn,D.name&&(F.name=f.indexOf(D.name)),M.push(F)),k.push(F)}return a(m.__originalMappings,n.compareByOriginalPositions),m},o.prototype._version=3,Object.defineProperty(o.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function i(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}o.prototype._parseMappings=function(u,h){for(var m=1,f=0,v=0,O=0,k=0,M=0,E=u.length,I=0,D={},F={},_=[],$=[],Z,ce,U,ue,W;I<E;)if(u.charAt(I)===";")m++,I++,f=0;else if(u.charAt(I)===",")I++;else{for(Z=new i,Z.generatedLine=m,ue=I;ue<E&&!this._charIsMappingSeparator(u,ue);ue++);if(ce=u.slice(I,ue),U=D[ce],U)I+=ce.length;else{for(U=[];I<ue;)s.decode(u,I,F),W=F.value,I=F.rest,U.push(W);if(U.length===2)throw new Error("Found a source, but no line and column");if(U.length===3)throw new Error("Found a source and line, but no column");D[ce]=U}Z.generatedColumn=f+U[0],f=Z.generatedColumn,U.length>1&&(Z.source=k+U[1],k+=U[1],Z.originalLine=v+U[2],v=Z.originalLine,Z.originalLine+=1,Z.originalColumn=O+U[3],O=Z.originalColumn,U.length>4&&(Z.name=M+U[4],M+=U[4])),$.push(Z),typeof Z.originalLine=="number"&&_.push(Z)}a($,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=$,a(_,n.compareByOriginalPositions),this.__originalMappings=_},o.prototype._findMapping=function(u,h,m,f,v,O){if(u[m]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+u[m]);if(u[f]<0)throw new TypeError("Column must be greater than or equal to 0, got "+u[f]);return e.search(u,h,v,O)},o.prototype.computeColumnSpans=function(){for(var u=0;u<this._generatedMappings.length;++u){var h=this._generatedMappings[u];if(u+1<this._generatedMappings.length){var m=this._generatedMappings[u+1];if(h.generatedLine===m.generatedLine){h.lastGeneratedColumn=m.generatedColumn-1;continue}}h.lastGeneratedColumn=1/0}},o.prototype.originalPositionFor=function(u){var h={generatedLine:n.getArg(u,"line"),generatedColumn:n.getArg(u,"column")},m=this._findMapping(h,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(u,"bias",r.GREATEST_LOWER_BOUND));if(m>=0){var f=this._generatedMappings[m];if(f.generatedLine===h.generatedLine){var v=n.getArg(f,"source",null);v!==null&&(v=this._sources.at(v),v=n.computeSourceURL(this.sourceRoot,v,this._sourceMapURL));var O=n.getArg(f,"name",null);return O!==null&&(O=this._names.at(O)),{source:v,line:n.getArg(f,"originalLine",null),column:n.getArg(f,"originalColumn",null),name:O}}}return{source:null,line:null,column:null,name:null}},o.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(u){return u==null}):!1},o.prototype.sourceContentFor=function(u,h){if(!this.sourcesContent)return null;var m=this._findSourceIndex(u);if(m>=0)return this.sourcesContent[m];var f=u;this.sourceRoot!=null&&(f=n.relative(this.sourceRoot,f));var v;if(this.sourceRoot!=null&&(v=n.urlParse(this.sourceRoot))){var O=f.replace(/^file:\/\//,"");if(v.scheme=="file"&&this._sources.has(O))return this.sourcesContent[this._sources.indexOf(O)];if((!v.path||v.path=="/")&&this._sources.has("/"+f))return this.sourcesContent[this._sources.indexOf("/"+f)]}if(h)return null;throw new Error('"'+f+'" is not in the SourceMap.')},o.prototype.generatedPositionFor=function(u){var h=n.getArg(u,"source");if(h=this._findSourceIndex(h),h<0)return{line:null,column:null,lastColumn:null};var m={source:h,originalLine:n.getArg(u,"line"),originalColumn:n.getArg(u,"column")},f=this._findMapping(m,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(u,"bias",r.GREATEST_LOWER_BOUND));if(f>=0){var v=this._originalMappings[f];if(v.source===m.source)return{line:n.getArg(v,"generatedLine",null),column:n.getArg(v,"generatedColumn",null),lastColumn:n.getArg(v,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},Cp.BasicSourceMapConsumer=o;function l(c,u){var h=c;typeof c=="string"&&(h=n.parseSourceMapInput(c));var m=n.getArg(h,"version"),f=n.getArg(h,"sections");if(m!=this._version)throw new Error("Unsupported version: "+m);this._sources=new t,this._names=new t;var v={line:-1,column:0};this._sections=f.map(function(O){if(O.url)throw new Error("Support for url field in sections not implemented.");var k=n.getArg(O,"offset"),M=n.getArg(k,"line"),E=n.getArg(k,"column");if(M<v.line||M===v.line&&E<v.column)throw new Error("Section offsets must be ordered and non-overlapping.");return v=k,{generatedOffset:{generatedLine:M+1,generatedColumn:E+1},consumer:new r(n.getArg(O,"map"),u)}})}return l.prototype=Object.create(r.prototype),l.prototype.constructor=r,l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){for(var c=[],u=0;u<this._sections.length;u++)for(var h=0;h<this._sections[u].consumer.sources.length;h++)c.push(this._sections[u].consumer.sources[h]);return c}}),l.prototype.originalPositionFor=function(u){var h={generatedLine:n.getArg(u,"line"),generatedColumn:n.getArg(u,"column")},m=e.search(h,this._sections,function(v,O){var k=v.generatedLine-O.generatedOffset.generatedLine;return k||v.generatedColumn-O.generatedOffset.generatedColumn}),f=this._sections[m];return f?f.consumer.originalPositionFor({line:h.generatedLine-(f.generatedOffset.generatedLine-1),column:h.generatedColumn-(f.generatedOffset.generatedLine===h.generatedLine?f.generatedOffset.generatedColumn-1:0),bias:u.bias}):{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(u){return u.consumer.hasContentsOfAllSources()})},l.prototype.sourceContentFor=function(u,h){for(var m=0;m<this._sections.length;m++){var f=this._sections[m],v=f.consumer.sourceContentFor(u,!0);if(v)return v}if(h)return null;throw new Error('"'+u+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(u){for(var h=0;h<this._sections.length;h++){var m=this._sections[h];if(m.consumer._findSourceIndex(n.getArg(u,"source"))!==-1){var f=m.consumer.generatedPositionFor(u);if(f){var v={line:f.line+(m.generatedOffset.generatedLine-1),column:f.column+(m.generatedOffset.generatedLine===f.line?m.generatedOffset.generatedColumn-1:0)};return v}}}return{line:null,column:null}},l.prototype._parseMappings=function(u,h){this.__generatedMappings=[],this.__originalMappings=[];for(var m=0;m<this._sections.length;m++)for(var f=this._sections[m],v=f.consumer._generatedMappings,O=0;O<v.length;O++){var k=v[O],M=f.consumer._sources.at(k.source);M=n.computeSourceURL(f.consumer.sourceRoot,M,this._sourceMapURL),this._sources.add(M),M=this._sources.indexOf(M);var E=null;k.name&&(E=f.consumer._names.at(k.name),this._names.add(E),E=this._names.indexOf(E));var I={source:M,generatedLine:k.generatedLine+(f.generatedOffset.generatedLine-1),generatedColumn:k.generatedColumn+(f.generatedOffset.generatedLine===k.generatedLine?f.generatedOffset.generatedColumn-1:0),originalLine:k.originalLine,originalColumn:k.originalColumn,name:E};this.__generatedMappings.push(I),typeof I.originalLine=="number"&&this.__originalMappings.push(I)}a(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),a(this.__originalMappings,n.compareByOriginalPositions)},Cp.IndexedSourceMapConsumer=l,Cp}var Cx={},o9;function kfe(){if(o9)return Cx;o9=1;var n=R_().SourceMapGenerator,e=Xg(),t=/(\r?\n)/,s=10,a="$$$isSourceNode$$$";function r(o,i,l,c,u){this.children=[],this.sourceContents={},this.line=o??null,this.column=i??null,this.source=l??null,this.name=u??null,this[a]=!0,c!=null&&this.add(c)}return r.fromStringWithSourceMap=function(i,l,c){var u=new r,h=i.split(t),m=0,f=function(){var E=D(),I=D()||"";return E+I;function D(){return m<h.length?h[m++]:void 0}},v=1,O=0,k=null;return l.eachMapping(function(E){if(k!==null)if(v<E.generatedLine)M(k,f()),v++,O=0;else{var I=h[m]||"",D=I.substr(0,E.generatedColumn-O);h[m]=I.substr(E.generatedColumn-O),O=E.generatedColumn,M(k,D),k=E;return}for(;v<E.generatedLine;)u.add(f()),v++;if(O<E.generatedColumn){var I=h[m]||"";u.add(I.substr(0,E.generatedColumn)),h[m]=I.substr(E.generatedColumn),O=E.generatedColumn}k=E},this),m<h.length&&(k&&M(k,f()),u.add(h.splice(m).join(""))),l.sources.forEach(function(E){var I=l.sourceContentFor(E);I!=null&&(c!=null&&(E=e.join(c,E)),u.setSourceContent(E,I))}),u;function M(E,I){if(E===null||E.source===void 0)u.add(I);else{var D=c?e.join(c,E.source):E.source;u.add(new r(E.originalLine,E.originalColumn,D,I,E.name))}}},r.prototype.add=function(i){if(Array.isArray(i))i.forEach(function(l){this.add(l)},this);else if(i[a]||typeof i=="string")i&&this.children.push(i);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+i);return this},r.prototype.prepend=function(i){if(Array.isArray(i))for(var l=i.length-1;l>=0;l--)this.prepend(i[l]);else if(i[a]||typeof i=="string")this.children.unshift(i);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+i);return this},r.prototype.walk=function(i){for(var l,c=0,u=this.children.length;c<u;c++)l=this.children[c],l[a]?l.walk(i):l!==""&&i(l,{source:this.source,line:this.line,column:this.column,name:this.name})},r.prototype.join=function(i){var l,c,u=this.children.length;if(u>0){for(l=[],c=0;c<u-1;c++)l.push(this.children[c]),l.push(i);l.push(this.children[c]),this.children=l}return this},r.prototype.replaceRight=function(i,l){var c=this.children[this.children.length-1];return c[a]?c.replaceRight(i,l):typeof c=="string"?this.children[this.children.length-1]=c.replace(i,l):this.children.push("".replace(i,l)),this},r.prototype.setSourceContent=function(i,l){this.sourceContents[e.toSetString(i)]=l},r.prototype.walkSourceContents=function(i){for(var l=0,c=this.children.length;l<c;l++)this.children[l][a]&&this.children[l].walkSourceContents(i);for(var u=Object.keys(this.sourceContents),l=0,c=u.length;l<c;l++)i(e.fromSetString(u[l]),this.sourceContents[u[l]])},r.prototype.toString=function(){var i="";return this.walk(function(l){i+=l}),i},r.prototype.toStringWithSourceMap=function(i){var l={code:"",line:1,column:0},c=new n(i),u=!1,h=null,m=null,f=null,v=null;return this.walk(function(O,k){l.code+=O,k.source!==null&&k.line!==null&&k.column!==null?((h!==k.source||m!==k.line||f!==k.column||v!==k.name)&&c.addMapping({source:k.source,original:{line:k.line,column:k.column},generated:{line:l.line,column:l.column},name:k.name}),h=k.source,m=k.line,f=k.column,v=k.name,u=!0):u&&(c.addMapping({generated:{line:l.line,column:l.column}}),h=null,u=!1);for(var M=0,E=O.length;M<E;M++)O.charCodeAt(M)===s?(l.line++,l.column=0,M+1===E?(h=null,u=!1):u&&c.addMapping({source:k.source,original:{line:k.line,column:k.column},generated:{line:l.line,column:l.column},name:k.name})):l.column++}),this.walkSourceContents(function(O,k){c.setSourceContent(O,k)}),{code:l.code,map:c}},Cx.SourceNode=r,Cx}var i9;function Pfe(){return i9||(i9=1,Sp.SourceMapGenerator=R_().SourceMapGenerator,Sp.SourceMapConsumer=xfe().SourceMapConsumer,Sp.SourceNode=kfe().SourceNode),Sp}const Sfe="2.1.0",Cfe={version:Sfe};var l9;function Mfe(){return l9||(l9=1,(function(n){(function(){var e,t,s,a,r,o,i,l,c,u,h,m,f,v,O,k,M,E,I,D,F,_,$,Z,ce,U;r=pfe(),o=bfe(),e=r.Syntax;function ue(x){return He.Expression.hasOwnProperty(x.type)}function W(x){return He.Statement.hasOwnProperty(x.type)}t={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},s={"??":t.Coalesce,"||":t.LogicalOR,"&&":t.LogicalAND,"|":t.BitwiseOR,"^":t.BitwiseXOR,"&":t.BitwiseAND,"==":t.Equality,"!=":t.Equality,"===":t.Equality,"!==":t.Equality,is:t.Equality,isnt:t.Equality,"<":t.Relational,">":t.Relational,"<=":t.Relational,">=":t.Relational,in:t.Relational,instanceof:t.Relational,"<<":t.BitwiseSHIFT,">>":t.BitwiseSHIFT,">>>":t.BitwiseSHIFT,"+":t.Additive,"-":t.Additive,"*":t.Multiplicative,"%":t.Multiplicative,"/":t.Multiplicative,"**":t.Exponentiation};var de=1,be=2,ke=4,Ce=8,Ae=16,q=32,Ne=64,Re=be|ke,je=de|be,me=de|be|ke,Ye=de,ft=ke,_e=de|ke,Ge=de,pt=de|q,rt=0,tn=de|Ae,on=de|Ce;function xn(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function Gt(x,B){var T="";for(B|=0;B>0;B>>>=1,x+=x)B&1&&(T+=x);return T}function In(x){return/[\r\n]/g.test(x)}function Ft(x){var B=x.length;return B&&o.code.isLineTerminator(x.charCodeAt(B-1))}function jt(x,B){var T;for(T in B)B.hasOwnProperty(T)&&(x[T]=B[T]);return x}function Gn(x,B){var T,R;function j(H){return typeof H=="object"&&H instanceof Object&&!(H instanceof RegExp)}for(T in B)B.hasOwnProperty(T)&&(R=B[T],j(R)?j(x[T])?Gn(x[T],R):x[T]=Gn({},R):x[T]=R);return x}function un(x){var B,T,R,j,H;if(x!==x)throw new Error("Numeric literal whose value is NaN");if(x<0||x===0&&1/x<0)throw new Error("Numeric literal whose value is negative");if(x===1/0)return c?"null":u?"1e400":"1e+400";if(B=""+x,!u||B.length<3)return B;for(T=B.indexOf("."),!c&&B.charCodeAt(0)===48&&T===1&&(T=0,B=B.slice(1)),R=B,B=B.replace("e+","e"),j=0,(H=R.indexOf("e"))>0&&(j=+R.slice(H+1),R=R.slice(0,H)),T>=0&&(j-=R.length-T-1,R=+(R.slice(0,T)+R.slice(T+1))+""),H=0;R.charCodeAt(R.length+H-1)===48;)--H;return H!==0&&(j-=H,R=R.slice(0,H)),j!==0&&(R+="e"+j),(R.length<B.length||h&&x>1e12&&Math.floor(x)===x&&(R="0x"+x.toString(16)).length<B.length)&&+R===x&&(B=R),B}function fn(x,B){return(x&-2)===8232?(B?"u":"\\u")+(x===8232?"2028":"2029"):x===10||x===13?(B?"":"\\")+(x===10?"n":"r"):String.fromCharCode(x)}function at(x){var B,T,R,j,H,ee,ne,ge;if(T=x.toString(),x.source){if(B=T.match(/\/([^/]*)$/),!B)return T;for(R=B[1],T="",ne=!1,ge=!1,j=0,H=x.source.length;j<H;++j)ee=x.source.charCodeAt(j),ge?(T+=fn(ee,ge),ge=!1):(ne?ee===93&&(ne=!1):ee===47?T+="\\":ee===91&&(ne=!0),T+=fn(ee,ge),ge=ee===92);return"/"+T+"/"+R}return T}function Un(x,B){var T;return x===8?"\\b":x===12?"\\f":x===9?"\\t":(T=x.toString(16).toUpperCase(),c||x>255?"\\u"+"0000".slice(T.length)+T:x===0&&!o.code.isDecimalDigit(B)?"\\0":x===11?"\\x0B":"\\x"+"00".slice(T.length)+T)}function nt(x){if(x===92)return"\\\\";if(x===10)return"\\n";if(x===13)return"\\r";if(x===8232)return"\\u2028";if(x===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function Mt(x){var B,T,R,j;for(j=m==="double"?'"':"'",B=0,T=x.length;B<T;++B)if(R=x.charCodeAt(B),R===39){j='"';break}else if(R===34){j="'";break}else R===92&&++B;return j+x+j}function Vt(x){var B="",T,R,j,H=0,ee=0,ne,ge;for(T=0,R=x.length;T<R;++T){if(j=x.charCodeAt(T),j===39)++H;else if(j===34)++ee;else if(j===47&&c)B+="\\";else if(o.code.isLineTerminator(j)||j===92){B+=nt(j);continue}else if(!o.code.isIdentifierPartES5(j)&&(c&&j<32||!c&&!f&&(j<32||j>126))){B+=Un(j,x.charCodeAt(T+1));continue}B+=String.fromCharCode(j)}if(ne=!(m==="double"||m==="auto"&&ee<H),ge=ne?"'":'"',!(ne?H:ee))return ge+B+ge;for(x=B,B=ge,T=0,R=x.length;T<R;++T)j=x.charCodeAt(T),(j===39&&ne||j===34&&!ne)&&(B+="\\"),B+=String.fromCharCode(j);return B+ge}function En(x){var B,T,R,j="";for(B=0,T=x.length;B<T;++B)R=x[B],j+=Array.isArray(R)?En(R):R;return j}function lt(x,B){if(!_)return Array.isArray(x)?En(x):x;if(B==null){if(x instanceof a)return x;B={}}return B.loc==null?new a(null,null,_,x,B.name||null):new a(B.loc.start.line,B.loc.start.column,_===!0?B.loc.source||null:_,x,B.name||null)}function It(){return O||" "}function Le(x,B){var T,R,j,H;return T=lt(x).toString(),T.length===0?[B]:(R=lt(B).toString(),R.length===0?[x]:(j=T.charCodeAt(T.length-1),H=R.charCodeAt(0),(j===43||j===45)&&j===H||o.code.isIdentifierPartES5(j)&&o.code.isIdentifierPartES5(H)||j===47&&H===105?[x,It(),B]:o.code.isWhiteSpace(j)||o.code.isLineTerminator(j)||o.code.isWhiteSpace(H)||o.code.isLineTerminator(H)?[x,B]:[x,O,B]))}function qt(x){return[i,x]}function tt(x){var B;B=i,i+=l,x(i),i=B}function zn(x){var B;for(B=x.length-1;B>=0&&!o.code.isLineTerminator(x.charCodeAt(B));--B);return x.length-1-B}function mt(x,B){var T,R,j,H,ee,ne,ge,Fe;for(T=x.split(/\r\n|[\r\n]/),ne=Number.MAX_VALUE,R=1,j=T.length;R<j;++R){for(H=T[R],ee=0;ee<H.length&&o.code.isWhiteSpace(H.charCodeAt(ee));)++ee;ne>ee&&(ne=ee)}for(typeof B<"u"?(ge=i,T[1][ne]==="*"&&(B+=" "),i=B):(ne&1&&--ne,ge=i),R=1,j=T.length;R<j;++R)Fe=lt(qt(T[R].slice(ne))),T[R]=_?Fe.join(""):Fe;return i=ge,T.join(`
`)}function Fn(x,B){if(x.type==="Line"){if(Ft(x.value))return"//"+x.value;var T="//"+x.value;return Z||(T+=`
`),T}return D.format.indent.adjustMultilineComment&&/[\n\r]/.test(x.value)?mt("/*"+x.value+"*/",B):"/*"+x.value+"*/"}function ea(x,B){var T,R,j,H,ee,ne,ge,Fe,Be,wt,Nt,yn,ws,gn;if(x.leadingComments&&x.leadingComments.length>0){if(H=B,Z){for(j=x.leadingComments[0],B=[],Fe=j.extendedRange,Be=j.range,Nt=$.substring(Fe[0],Be[0]),gn=(Nt.match(/\n/g)||[]).length,gn>0?(B.push(Gt(`
`,gn)),B.push(qt(Fn(j)))):(B.push(Nt),B.push(Fn(j))),wt=Be,T=1,R=x.leadingComments.length;T<R;T++)j=x.leadingComments[T],Be=j.range,yn=$.substring(wt[1],Be[0]),gn=(yn.match(/\n/g)||[]).length,B.push(Gt(`
`,gn)),B.push(qt(Fn(j))),wt=Be;ws=$.substring(Be[1],Fe[1]),gn=(ws.match(/\n/g)||[]).length,B.push(Gt(`
`,gn))}else for(j=x.leadingComments[0],B=[],E&&x.type===e.Program&&x.body.length===0&&B.push(`
`),B.push(Fn(j)),Ft(lt(B).toString())||B.push(`
`),T=1,R=x.leadingComments.length;T<R;++T)j=x.leadingComments[T],ge=[Fn(j)],Ft(lt(ge).toString())||ge.push(`
`),B.push(qt(ge));B.push(qt(H))}if(x.trailingComments)if(Z)j=x.trailingComments[0],Fe=j.extendedRange,Be=j.range,Nt=$.substring(Fe[0],Be[0]),gn=(Nt.match(/\n/g)||[]).length,gn>0?(B.push(Gt(`
`,gn)),B.push(qt(Fn(j)))):(B.push(Nt),B.push(Fn(j)));else for(ee=!Ft(lt(B).toString()),ne=Gt(" ",zn(lt([i,B,l]).toString())),T=0,R=x.trailingComments.length;T<R;++T)j=x.trailingComments[T],ee?(T===0?B=[B,l]:B=[B,ne],B.push(Fn(j,ne))):B=[B,qt(Fn(j))],T!==R-1&&!Ft(lt(B).toString())&&(B=[B,`
`]);return B}function Hn(x,B,T){var R,j=0;for(R=x;R<B;R++)$[R]===`
`&&j++;for(R=1;R<j;R++)T.push(v)}function Zt(x,B,T){return B<T?["(",x,")"]:x}function Dt(x){var B,T,R;for(R=x.split(/\r\n|\n/),B=1,T=R.length;B<T;B++)R[B]=v+i+R[B];return R}function Sn(x,B){var T,R,j;return T=x[D.verbatim],typeof T=="string"?R=Zt(Dt(T),t.Sequence,B):(R=Dt(T.content),j=T.precedence!=null?T.precedence:t.Sequence,R=Zt(R,j,B)),lt(R,x)}function He(){}He.prototype.maybeBlock=function(x,B){var T,R,j=this;return R=!D.comment||!x.leadingComments,x.type===e.BlockStatement&&R?[O,this.generateStatement(x,B)]:x.type===e.EmptyStatement&&R?";":(tt(function(){T=[v,qt(j.generateStatement(x,B))]}),T)},He.prototype.maybeBlockSuffix=function(x,B){var T=Ft(lt(B).toString());return x.type===e.BlockStatement&&(!D.comment||!x.leadingComments)&&!T?[B,O]:T?[B,i]:[B,v,i]};function Tt(x){return lt(x.name,x)}function kn(x,B){return x.async?"async"+(B?It():O):""}function vs(x){var B=x.generator&&!D.moz.starlessGenerator;return B?"*"+O:""}function ln(x){var B=x.value,T="";return B.async&&(T+=kn(B,!x.computed)),B.generator&&(T+=vs(B)?"*":""),T}He.prototype.generatePattern=function(x,B,T){return x.type===e.Identifier?Tt(x):this.generateExpression(x,B,T)},He.prototype.generateFunctionParams=function(x){var B,T,R,j;if(j=!1,x.type===e.ArrowFunctionExpression&&!x.rest&&(!x.defaults||x.defaults.length===0)&&x.params.length===1&&x.params[0].type===e.Identifier)R=[kn(x,!0),Tt(x.params[0])];else{for(R=x.type===e.ArrowFunctionExpression?[kn(x,!1)]:[],R.push("("),x.defaults&&(j=!0),B=0,T=x.params.length;B<T;++B)j&&x.defaults[B]?R.push(this.generateAssignment(x.params[B],x.defaults[B],"=",t.Assignment,me)):R.push(this.generatePattern(x.params[B],t.Assignment,me)),B+1<T&&R.push(","+O);x.rest&&(x.params.length&&R.push(","+O),R.push("..."),R.push(Tt(x.rest))),R.push(")")}return R},He.prototype.generateFunctionBody=function(x){var B,T;return B=this.generateFunctionParams(x),x.type===e.ArrowFunctionExpression&&(B.push(O),B.push("=>")),x.expression?(B.push(O),T=this.generateExpression(x.body,t.Assignment,me),T.toString().charAt(0)==="{"&&(T=["(",T,")"]),B.push(T)):B.push(this.maybeBlock(x.body,on)),B},He.prototype.generateIterationForStatement=function(x,B,T){var R=["for"+(B.await?It()+"await":"")+O+"("],j=this;return tt(function(){B.left.type===e.VariableDeclaration?tt(function(){R.push(B.left.kind+It()),R.push(j.generateStatement(B.left.declarations[0],rt))}):R.push(j.generateExpression(B.left,t.Call,me)),R=Le(R,x),R=[Le(R,j.generateExpression(B.right,t.Assignment,me)),")"]}),R.push(this.maybeBlock(B.body,T)),R},He.prototype.generatePropertyKey=function(x,B){var T=[];return B&&T.push("["),T.push(this.generateExpression(x,t.Assignment,me)),B&&T.push("]"),T},He.prototype.generateAssignment=function(x,B,T,R,j){return t.Assignment<R&&(j|=de),Zt([this.generateExpression(x,t.Call,j),O+T+O,this.generateExpression(B,t.Assignment,j)],t.Assignment,R)},He.prototype.semicolon=function(x){return!M&&x&q?"":";"},He.Statement={BlockStatement:function(x,B){var T,R,j=["{",v],H=this;return tt(function(){x.body.length===0&&Z&&(T=x.range,T[1]-T[0]>2&&(R=$.substring(T[0]+1,T[1]-1),R[0]===`
`&&(j=["{"]),j.push(R)));var ee,ne,ge,Fe;for(Fe=Ge,B&Ce&&(Fe|=Ae),ee=0,ne=x.body.length;ee<ne;++ee)Z&&(ee===0&&(x.body[0].leadingComments&&(T=x.body[0].leadingComments[0].extendedRange,R=$.substring(T[0],T[1]),R[0]===`
`&&(j=["{"])),x.body[0].leadingComments||Hn(x.range[0],x.body[0].range[0],j)),ee>0&&!x.body[ee-1].trailingComments&&!x.body[ee].leadingComments&&Hn(x.body[ee-1].range[1],x.body[ee].range[0],j)),ee===ne-1&&(Fe|=q),x.body[ee].leadingComments&&Z?ge=H.generateStatement(x.body[ee],Fe):ge=qt(H.generateStatement(x.body[ee],Fe)),j.push(ge),Ft(lt(ge).toString())||Z&&ee<ne-1&&x.body[ee+1].leadingComments||j.push(v),Z&&ee===ne-1&&(x.body[ee].trailingComments||Hn(x.body[ee].range[1],x.range[1],j))}),j.push(qt("}")),j},BreakStatement:function(x,B){return x.label?"break "+x.label.name+this.semicolon(B):"break"+this.semicolon(B)},ContinueStatement:function(x,B){return x.label?"continue "+x.label.name+this.semicolon(B):"continue"+this.semicolon(B)},ClassBody:function(x,B){var T=["{",v],R=this;return tt(function(j){var H,ee;for(H=0,ee=x.body.length;H<ee;++H)T.push(j),T.push(R.generateExpression(x.body[H],t.Sequence,me)),H+1<ee&&T.push(v)}),Ft(lt(T).toString())||T.push(v),T.push(i),T.push("}"),T},ClassDeclaration:function(x,B){var T,R;return T=["class"],x.id&&(T=Le(T,this.generateExpression(x.id,t.Sequence,me))),x.superClass&&(R=Le("extends",this.generateExpression(x.superClass,t.Unary,me)),T=Le(T,R)),T.push(O),T.push(this.generateStatement(x.body,pt)),T},DirectiveStatement:function(x,B){return D.raw&&x.raw?x.raw+this.semicolon(B):Mt(x.directive)+this.semicolon(B)},DoWhileStatement:function(x,B){var T=Le("do",this.maybeBlock(x.body,Ge));return T=this.maybeBlockSuffix(x.body,T),Le(T,["while"+O+"(",this.generateExpression(x.test,t.Sequence,me),")"+this.semicolon(B)])},CatchClause:function(x,B){var T,R=this;return tt(function(){var j;x.param?(T=["catch"+O+"(",R.generateExpression(x.param,t.Sequence,me),")"],x.guard&&(j=R.generateExpression(x.guard,t.Sequence,me),T.splice(2,0," if ",j))):T=["catch"]}),T.push(this.maybeBlock(x.body,Ge)),T},DebuggerStatement:function(x,B){return"debugger"+this.semicolon(B)},EmptyStatement:function(x,B){return";"},ExportDefaultDeclaration:function(x,B){var T=["export"],R;return R=B&q?pt:Ge,T=Le(T,"default"),W(x.declaration)?T=Le(T,this.generateStatement(x.declaration,R)):T=Le(T,this.generateExpression(x.declaration,t.Assignment,me)+this.semicolon(B)),T},ExportNamedDeclaration:function(x,B){var T=["export"],R,j=this;return R=B&q?pt:Ge,x.declaration?Le(T,this.generateStatement(x.declaration,R)):(x.specifiers&&(x.specifiers.length===0?T=Le(T,"{"+O+"}"):x.specifiers[0].type===e.ExportBatchSpecifier?T=Le(T,this.generateExpression(x.specifiers[0],t.Sequence,me)):(T=Le(T,"{"),tt(function(H){var ee,ne;for(T.push(v),ee=0,ne=x.specifiers.length;ee<ne;++ee)T.push(H),T.push(j.generateExpression(x.specifiers[ee],t.Sequence,me)),ee+1<ne&&T.push(","+v)}),Ft(lt(T).toString())||T.push(v),T.push(i+"}")),x.source?T=Le(T,["from"+O,this.generateExpression(x.source,t.Sequence,me),this.semicolon(B)]):T.push(this.semicolon(B))),T)},ExportAllDeclaration:function(x,B){return["export"+O,"*"+O,"from"+O,this.generateExpression(x.source,t.Sequence,me),this.semicolon(B)]},ExpressionStatement:function(x,B){var T,R;function j(ne){var ge;return ne.slice(0,5)!=="class"?!1:(ge=ne.charCodeAt(5),ge===123||o.code.isWhiteSpace(ge)||o.code.isLineTerminator(ge))}function H(ne){var ge;return ne.slice(0,8)!=="function"?!1:(ge=ne.charCodeAt(8),ge===40||o.code.isWhiteSpace(ge)||ge===42||o.code.isLineTerminator(ge))}function ee(ne){var ge,Fe,Be;if(ne.slice(0,5)!=="async"||!o.code.isWhiteSpace(ne.charCodeAt(5)))return!1;for(Fe=6,Be=ne.length;Fe<Be&&o.code.isWhiteSpace(ne.charCodeAt(Fe));++Fe);return Fe===Be||ne.slice(Fe,Fe+8)!=="function"?!1:(ge=ne.charCodeAt(Fe+8),ge===40||o.code.isWhiteSpace(ge)||ge===42||o.code.isLineTerminator(ge))}return T=[this.generateExpression(x.expression,t.Sequence,me)],R=lt(T).toString(),R.charCodeAt(0)===123||j(R)||H(R)||ee(R)||I&&B&Ae&&x.expression.type===e.Literal&&typeof x.expression.value=="string"?T=["(",T,")"+this.semicolon(B)]:T.push(this.semicolon(B)),T},ImportDeclaration:function(x,B){var T,R,j=this;return x.specifiers.length===0?["import",O,this.generateExpression(x.source,t.Sequence,me),this.semicolon(B)]:(T=["import"],R=0,x.specifiers[R].type===e.ImportDefaultSpecifier&&(T=Le(T,[this.generateExpression(x.specifiers[R],t.Sequence,me)]),++R),x.specifiers[R]&&(R!==0&&T.push(","),x.specifiers[R].type===e.ImportNamespaceSpecifier?T=Le(T,[O,this.generateExpression(x.specifiers[R],t.Sequence,me)]):(T.push(O+"{"),x.specifiers.length-R===1?(T.push(O),T.push(this.generateExpression(x.specifiers[R],t.Sequence,me)),T.push(O+"}"+O)):(tt(function(H){var ee,ne;for(T.push(v),ee=R,ne=x.specifiers.length;ee<ne;++ee)T.push(H),T.push(j.generateExpression(x.specifiers[ee],t.Sequence,me)),ee+1<ne&&T.push(","+v)}),Ft(lt(T).toString())||T.push(v),T.push(i+"}"+O)))),T=Le(T,["from"+O,this.generateExpression(x.source,t.Sequence,me),this.semicolon(B)]),T)},VariableDeclarator:function(x,B){var T=B&de?me:Re;return x.init?[this.generateExpression(x.id,t.Assignment,T),O,"=",O,this.generateExpression(x.init,t.Assignment,T)]:this.generatePattern(x.id,t.Assignment,T)},VariableDeclaration:function(x,B){var T,R,j,H,ee,ne=this;T=[x.kind],ee=B&de?Ge:rt;function ge(){for(H=x.declarations[0],D.comment&&H.leadingComments?(T.push(`
`),T.push(qt(ne.generateStatement(H,ee)))):(T.push(It()),T.push(ne.generateStatement(H,ee))),R=1,j=x.declarations.length;R<j;++R)H=x.declarations[R],D.comment&&H.leadingComments?(T.push(","+v),T.push(qt(ne.generateStatement(H,ee)))):(T.push(","+O),T.push(ne.generateStatement(H,ee)))}return x.declarations.length>1?tt(ge):ge(),T.push(this.semicolon(B)),T},ThrowStatement:function(x,B){return[Le("throw",this.generateExpression(x.argument,t.Sequence,me)),this.semicolon(B)]},TryStatement:function(x,B){var T,R,j,H;if(T=["try",this.maybeBlock(x.block,Ge)],T=this.maybeBlockSuffix(x.block,T),x.handlers)for(R=0,j=x.handlers.length;R<j;++R)T=Le(T,this.generateStatement(x.handlers[R],Ge)),(x.finalizer||R+1!==j)&&(T=this.maybeBlockSuffix(x.handlers[R].body,T));else{for(H=x.guardedHandlers||[],R=0,j=H.length;R<j;++R)T=Le(T,this.generateStatement(H[R],Ge)),(x.finalizer||R+1!==j)&&(T=this.maybeBlockSuffix(H[R].body,T));if(x.handler)if(Array.isArray(x.handler))for(R=0,j=x.handler.length;R<j;++R)T=Le(T,this.generateStatement(x.handler[R],Ge)),(x.finalizer||R+1!==j)&&(T=this.maybeBlockSuffix(x.handler[R].body,T));else T=Le(T,this.generateStatement(x.handler,Ge)),x.finalizer&&(T=this.maybeBlockSuffix(x.handler.body,T))}return x.finalizer&&(T=Le(T,["finally",this.maybeBlock(x.finalizer,Ge)])),T},SwitchStatement:function(x,B){var T,R,j,H,ee,ne=this;if(tt(function(){T=["switch"+O+"(",ne.generateExpression(x.discriminant,t.Sequence,me),")"+O+"{"+v]}),x.cases)for(ee=Ge,j=0,H=x.cases.length;j<H;++j)j===H-1&&(ee|=q),R=qt(this.generateStatement(x.cases[j],ee)),T.push(R),Ft(lt(R).toString())||T.push(v);return T.push(qt("}")),T},SwitchCase:function(x,B){var T,R,j,H,ee,ne=this;return tt(function(){for(x.test?T=[Le("case",ne.generateExpression(x.test,t.Sequence,me)),":"]:T=["default:"],j=0,H=x.consequent.length,H&&x.consequent[0].type===e.BlockStatement&&(R=ne.maybeBlock(x.consequent[0],Ge),T.push(R),j=1),j!==H&&!Ft(lt(T).toString())&&T.push(v),ee=Ge;j<H;++j)j===H-1&&B&q&&(ee|=q),R=qt(ne.generateStatement(x.consequent[j],ee)),T.push(R),j+1!==H&&!Ft(lt(R).toString())&&T.push(v)}),T},IfStatement:function(x,B){var T,R,j,H=this;return tt(function(){T=["if"+O+"(",H.generateExpression(x.test,t.Sequence,me),")"]}),j=B&q,R=Ge,j&&(R|=q),x.alternate?(T.push(this.maybeBlock(x.consequent,Ge)),T=this.maybeBlockSuffix(x.consequent,T),x.alternate.type===e.IfStatement?T=Le(T,["else ",this.generateStatement(x.alternate,R)]):T=Le(T,Le("else",this.maybeBlock(x.alternate,R)))):T.push(this.maybeBlock(x.consequent,R)),T},ForStatement:function(x,B){var T,R=this;return tt(function(){T=["for"+O+"("],x.init?x.init.type===e.VariableDeclaration?T.push(R.generateStatement(x.init,rt)):(T.push(R.generateExpression(x.init,t.Sequence,Re)),T.push(";")):T.push(";"),x.test&&(T.push(O),T.push(R.generateExpression(x.test,t.Sequence,me))),T.push(";"),x.update&&(T.push(O),T.push(R.generateExpression(x.update,t.Sequence,me))),T.push(")")}),T.push(this.maybeBlock(x.body,B&q?pt:Ge)),T},ForInStatement:function(x,B){return this.generateIterationForStatement("in",x,B&q?pt:Ge)},ForOfStatement:function(x,B){return this.generateIterationForStatement("of",x,B&q?pt:Ge)},LabeledStatement:function(x,B){return[x.label.name+":",this.maybeBlock(x.body,B&q?pt:Ge)]},Program:function(x,B){var T,R,j,H,ee;for(H=x.body.length,T=[E&&H>0?`
`:""],ee=tn,j=0;j<H;++j)!E&&j===H-1&&(ee|=q),Z&&(j===0&&(x.body[0].leadingComments||Hn(x.range[0],x.body[j].range[0],T)),j>0&&!x.body[j-1].trailingComments&&!x.body[j].leadingComments&&Hn(x.body[j-1].range[1],x.body[j].range[0],T)),R=qt(this.generateStatement(x.body[j],ee)),T.push(R),j+1<H&&!Ft(lt(R).toString())&&(Z&&x.body[j+1].leadingComments||T.push(v)),Z&&j===H-1&&(x.body[j].trailingComments||Hn(x.body[j].range[1],x.range[1],T));return T},FunctionDeclaration:function(x,B){return[kn(x,!0),"function",vs(x)||It(),x.id?Tt(x.id):"",this.generateFunctionBody(x)]},ReturnStatement:function(x,B){return x.argument?[Le("return",this.generateExpression(x.argument,t.Sequence,me)),this.semicolon(B)]:["return"+this.semicolon(B)]},WhileStatement:function(x,B){var T,R=this;return tt(function(){T=["while"+O+"(",R.generateExpression(x.test,t.Sequence,me),")"]}),T.push(this.maybeBlock(x.body,B&q?pt:Ge)),T},WithStatement:function(x,B){var T,R=this;return tt(function(){T=["with"+O+"(",R.generateExpression(x.object,t.Sequence,me),")"]}),T.push(this.maybeBlock(x.body,B&q?pt:Ge)),T}},jt(He.prototype,He.Statement),He.Expression={SequenceExpression:function(x,B,T){var R,j,H;for(t.Sequence<B&&(T|=de),R=[],j=0,H=x.expressions.length;j<H;++j)R.push(this.generateExpression(x.expressions[j],t.Assignment,T)),j+1<H&&R.push(","+O);return Zt(R,t.Sequence,B)},AssignmentExpression:function(x,B,T){return this.generateAssignment(x.left,x.right,x.operator,B,T)},ArrowFunctionExpression:function(x,B,T){return Zt(this.generateFunctionBody(x),t.ArrowFunction,B)},ConditionalExpression:function(x,B,T){return t.Conditional<B&&(T|=de),Zt([this.generateExpression(x.test,t.Coalesce,T),O+"?"+O,this.generateExpression(x.consequent,t.Assignment,T),O+":"+O,this.generateExpression(x.alternate,t.Assignment,T)],t.Conditional,B)},LogicalExpression:function(x,B,T){return x.operator==="??"&&(T|=Ne),this.BinaryExpression(x,B,T)},BinaryExpression:function(x,B,T){var R,j,H,ee,ne,ge;return ee=s[x.operator],j=x.operator==="**"?t.Postfix:ee,H=x.operator==="**"?ee:ee+1,ee<B&&(T|=de),ne=this.generateExpression(x.left,j,T),ge=ne.toString(),ge.charCodeAt(ge.length-1)===47&&o.code.isIdentifierPartES5(x.operator.charCodeAt(0))?R=[ne,It(),x.operator]:R=Le(ne,x.operator),ne=this.generateExpression(x.right,H,T),x.operator==="/"&&ne.toString().charAt(0)==="/"||x.operator.slice(-1)==="<"&&ne.toString().slice(0,3)==="!--"?(R.push(It()),R.push(ne)):R=Le(R,ne),x.operator==="in"&&!(T&de)?["(",R,")"]:(x.operator==="||"||x.operator==="&&")&&T&Ne?["(",R,")"]:Zt(R,ee,B)},CallExpression:function(x,B,T){var R,j,H;for(R=[this.generateExpression(x.callee,t.Call,je)],x.optional&&R.push("?."),R.push("("),j=0,H=x.arguments.length;j<H;++j)R.push(this.generateExpression(x.arguments[j],t.Assignment,me)),j+1<H&&R.push(","+O);return R.push(")"),T&be?Zt(R,t.Call,B):["(",R,")"]},ChainExpression:function(x,B,T){t.OptionalChaining<B&&(T|=be);var R=this.generateExpression(x.expression,t.OptionalChaining,T);return Zt(R,t.OptionalChaining,B)},NewExpression:function(x,B,T){var R,j,H,ee,ne;if(j=x.arguments.length,ne=T&ke&&!k&&j===0?_e:Ye,R=Le("new",this.generateExpression(x.callee,t.New,ne)),!(T&ke)||k||j>0){for(R.push("("),H=0,ee=j;H<ee;++H)R.push(this.generateExpression(x.arguments[H],t.Assignment,me)),H+1<ee&&R.push(","+O);R.push(")")}return Zt(R,t.New,B)},MemberExpression:function(x,B,T){var R,j;return R=[this.generateExpression(x.object,t.Call,T&be?je:Ye)],x.computed?(x.optional&&R.push("?."),R.push("["),R.push(this.generateExpression(x.property,t.Sequence,T&be?me:_e)),R.push("]")):(!x.optional&&x.object.type===e.Literal&&typeof x.object.value=="number"&&(j=lt(R).toString(),j.indexOf(".")<0&&!/[eExX]/.test(j)&&o.code.isDecimalDigit(j.charCodeAt(j.length-1))&&!(j.length>=2&&j.charCodeAt(0)===48)&&R.push(" ")),R.push(x.optional?"?.":"."),R.push(Tt(x.property))),Zt(R,t.Member,B)},MetaProperty:function(x,B,T){var R;return R=[],R.push(typeof x.meta=="string"?x.meta:Tt(x.meta)),R.push("."),R.push(typeof x.property=="string"?x.property:Tt(x.property)),Zt(R,t.Member,B)},UnaryExpression:function(x,B,T){var R,j,H,ee,ne;return j=this.generateExpression(x.argument,t.Unary,me),O===""?R=Le(x.operator,j):(R=[x.operator],x.operator.length>2?R=Le(R,j):(ee=lt(R).toString(),ne=ee.charCodeAt(ee.length-1),H=j.toString().charCodeAt(0),((ne===43||ne===45)&&ne===H||o.code.isIdentifierPartES5(ne)&&o.code.isIdentifierPartES5(H))&&R.push(It()),R.push(j))),Zt(R,t.Unary,B)},YieldExpression:function(x,B,T){var R;return x.delegate?R="yield*":R="yield",x.argument&&(R=Le(R,this.generateExpression(x.argument,t.Yield,me))),Zt(R,t.Yield,B)},AwaitExpression:function(x,B,T){var R=Le(x.all?"await*":"await",this.generateExpression(x.argument,t.Await,me));return Zt(R,t.Await,B)},UpdateExpression:function(x,B,T){return x.prefix?Zt([x.operator,this.generateExpression(x.argument,t.Unary,me)],t.Unary,B):Zt([this.generateExpression(x.argument,t.Postfix,me),x.operator],t.Postfix,B)},FunctionExpression:function(x,B,T){var R=[kn(x,!0),"function"];return x.id?(R.push(vs(x)||It()),R.push(Tt(x.id))):R.push(vs(x)||O),R.push(this.generateFunctionBody(x)),R},ArrayPattern:function(x,B,T){return this.ArrayExpression(x,B,T,!0)},ArrayExpression:function(x,B,T,R){var j,H,ee=this;return x.elements.length?(H=R?!1:x.elements.length>1,j=["[",H?v:""],tt(function(ne){var ge,Fe;for(ge=0,Fe=x.elements.length;ge<Fe;++ge)x.elements[ge]?(j.push(H?ne:""),j.push(ee.generateExpression(x.elements[ge],t.Assignment,me))):(H&&j.push(ne),ge+1===Fe&&j.push(",")),ge+1<Fe&&j.push(","+(H?v:O))}),H&&!Ft(lt(j).toString())&&j.push(v),j.push(H?i:""),j.push("]"),j):"[]"},RestElement:function(x,B,T){return"..."+this.generatePattern(x.argument)},ClassExpression:function(x,B,T){var R,j;return R=["class"],x.id&&(R=Le(R,this.generateExpression(x.id,t.Sequence,me))),x.superClass&&(j=Le("extends",this.generateExpression(x.superClass,t.Unary,me)),R=Le(R,j)),R.push(O),R.push(this.generateStatement(x.body,pt)),R},MethodDefinition:function(x,B,T){var R,j;return x.static?R=["static"+O]:R=[],x.kind==="get"||x.kind==="set"?j=[Le(x.kind,this.generatePropertyKey(x.key,x.computed)),this.generateFunctionBody(x.value)]:j=[ln(x),this.generatePropertyKey(x.key,x.computed),this.generateFunctionBody(x.value)],Le(R,j)},Property:function(x,B,T){return x.kind==="get"||x.kind==="set"?[x.kind,It(),this.generatePropertyKey(x.key,x.computed),this.generateFunctionBody(x.value)]:x.shorthand?x.value.type==="AssignmentPattern"?this.AssignmentPattern(x.value,t.Sequence,me):this.generatePropertyKey(x.key,x.computed):x.method?[ln(x),this.generatePropertyKey(x.key,x.computed),this.generateFunctionBody(x.value)]:[this.generatePropertyKey(x.key,x.computed),":"+O,this.generateExpression(x.value,t.Assignment,me)]},ObjectExpression:function(x,B,T){var R,j,H,ee=this;return x.properties.length?(R=x.properties.length>1,tt(function(){H=ee.generateExpression(x.properties[0],t.Sequence,me)}),!R&&!In(lt(H).toString())?["{",O,H,O,"}"]:(tt(function(ne){var ge,Fe;if(j=["{",v,ne,H],R)for(j.push(","+v),ge=1,Fe=x.properties.length;ge<Fe;++ge)j.push(ne),j.push(ee.generateExpression(x.properties[ge],t.Sequence,me)),ge+1<Fe&&j.push(","+v)}),Ft(lt(j).toString())||j.push(v),j.push(i),j.push("}"),j)):"{}"},AssignmentPattern:function(x,B,T){return this.generateAssignment(x.left,x.right,"=",B,T)},ObjectPattern:function(x,B,T){var R,j,H,ee,ne,ge=this;if(!x.properties.length)return"{}";if(ee=!1,x.properties.length===1)ne=x.properties[0],ne.type===e.Property&&ne.value.type!==e.Identifier&&(ee=!0);else for(j=0,H=x.properties.length;j<H;++j)if(ne=x.properties[j],ne.type===e.Property&&!ne.shorthand){ee=!0;break}return R=["{",ee?v:""],tt(function(Fe){var Be,wt;for(Be=0,wt=x.properties.length;Be<wt;++Be)R.push(ee?Fe:""),R.push(ge.generateExpression(x.properties[Be],t.Sequence,me)),Be+1<wt&&R.push(","+(ee?v:O))}),ee&&!Ft(lt(R).toString())&&R.push(v),R.push(ee?i:""),R.push("}"),R},ThisExpression:function(x,B,T){return"this"},Super:function(x,B,T){return"super"},Identifier:function(x,B,T){return Tt(x)},ImportDefaultSpecifier:function(x,B,T){return Tt(x.id||x.local)},ImportNamespaceSpecifier:function(x,B,T){var R=["*"],j=x.id||x.local;return j&&R.push(O+"as"+It()+Tt(j)),R},ImportSpecifier:function(x,B,T){var R=x.imported,j=[R.name],H=x.local;return H&&H.name!==R.name&&j.push(It()+"as"+It()+Tt(H)),j},ExportSpecifier:function(x,B,T){var R=x.local,j=[R.name],H=x.exported;return H&&H.name!==R.name&&j.push(It()+"as"+It()+Tt(H)),j},Literal:function(x,B,T){var R;if(x.hasOwnProperty("raw")&&F&&D.raw)try{if(R=F(x.raw).body[0].expression,R.type===e.Literal&&R.value===x.value)return x.raw}catch{}return x.regex?"/"+x.regex.pattern+"/"+x.regex.flags:typeof x.value=="bigint"?x.value.toString()+"n":x.bigint?x.bigint+"n":x.value===null?"null":typeof x.value=="string"?Vt(x.value):typeof x.value=="number"?un(x.value):typeof x.value=="boolean"?x.value?"true":"false":at(x.value)},GeneratorExpression:function(x,B,T){return this.ComprehensionExpression(x,B,T)},ComprehensionExpression:function(x,B,T){var R,j,H,ee,ne=this;return R=x.type===e.GeneratorExpression?["("]:["["],D.moz.comprehensionExpressionStartsWithAssignment&&(ee=this.generateExpression(x.body,t.Assignment,me),R.push(ee)),x.blocks&&tt(function(){for(j=0,H=x.blocks.length;j<H;++j)ee=ne.generateExpression(x.blocks[j],t.Sequence,me),j>0||D.moz.comprehensionExpressionStartsWithAssignment?R=Le(R,ee):R.push(ee)}),x.filter&&(R=Le(R,"if"+O),ee=this.generateExpression(x.filter,t.Sequence,me),R=Le(R,["(",ee,")"])),D.moz.comprehensionExpressionStartsWithAssignment||(ee=this.generateExpression(x.body,t.Assignment,me),R=Le(R,ee)),R.push(x.type===e.GeneratorExpression?")":"]"),R},ComprehensionBlock:function(x,B,T){var R;return x.left.type===e.VariableDeclaration?R=[x.left.kind,It(),this.generateStatement(x.left.declarations[0],rt)]:R=this.generateExpression(x.left,t.Call,me),R=Le(R,x.of?"of":"in"),R=Le(R,this.generateExpression(x.right,t.Sequence,me)),["for"+O+"(",R,")"]},SpreadElement:function(x,B,T){return["...",this.generateExpression(x.argument,t.Assignment,me)]},TaggedTemplateExpression:function(x,B,T){var R=je;T&be||(R=Ye);var j=[this.generateExpression(x.tag,t.Call,R),this.generateExpression(x.quasi,t.Primary,ft)];return Zt(j,t.TaggedTemplate,B)},TemplateElement:function(x,B,T){return x.value.raw},TemplateLiteral:function(x,B,T){var R,j,H;for(R=["`"],j=0,H=x.quasis.length;j<H;++j)R.push(this.generateExpression(x.quasis[j],t.Primary,me)),j+1<H&&(R.push("${"+O),R.push(this.generateExpression(x.expressions[j],t.Sequence,me)),R.push(O+"}"));return R.push("`"),R},ModuleSpecifier:function(x,B,T){return this.Literal(x,B,T)},ImportExpression:function(x,B,T){return Zt(["import(",this.generateExpression(x.source,t.Assignment,me),")"],t.Call,B)}},jt(He.prototype,He.Expression),He.prototype.generateExpression=function(x,B,T){var R,j;return j=x.type||e.Property,D.verbatim&&x.hasOwnProperty(D.verbatim)?Sn(x,B):(R=this[j](x,B,T),D.comment&&(R=ea(x,R)),lt(R,x))},He.prototype.generateStatement=function(x,B){var T,R;return T=this[x.type](x,B),D.comment&&(T=ea(x,T)),R=lt(T).toString(),x.type===e.Program&&!E&&v===""&&R.charAt(R.length-1)===`
`&&(T=_?lt(T).replaceRight(/\s+$/,""):R.replace(/\s+$/,"")),lt(T,x)};function Gs(x){var B;if(B=new He,W(x))return B.generateStatement(x,Ge);if(ue(x))return B.generateExpression(x,t.Sequence,me);throw new Error("Unknown node type: "+x.type)}function na(x,B){var T=xn(),R,j;return B!=null?(typeof B.indent=="string"&&(T.format.indent.style=B.indent),typeof B.base=="number"&&(T.format.indent.base=B.base),B=Gn(T,B),l=B.format.indent.style,typeof B.base=="string"?i=B.base:i=Gt(l,B.format.indent.base)):(B=T,l=B.format.indent.style,i=Gt(l,B.format.indent.base)),c=B.format.json,u=B.format.renumber,h=c?!1:B.format.hexadecimal,m=c?"double":B.format.quotes,f=B.format.escapeless,v=B.format.newline,O=B.format.space,B.format.compact&&(v=O=l=i=""),k=B.format.parentheses,M=B.format.semicolons,E=B.format.safeConcatenation,I=B.directive,F=c?null:B.parse,_=B.sourceMap,$=B.sourceCode,Z=B.format.preserveBlankLines&&$!==null,D=B,_&&(n.browser?a=Bde.sourceMap.SourceNode:a=Pfe().SourceNode),R=Gs(x),_?(j=R.toStringWithSourceMap({file:B.file,sourceRoot:B.sourceMapRoot}),B.sourceContent&&j.map.setSourceContent(B.sourceMap,B.sourceContent),B.sourceMapWithCode?j:j.map.toString()):(j={code:R.toString(),map:null},B.sourceMapWithCode?j:j.code)}ce={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},U=xn().format,n.version=Cfe.version,n.generate=na,n.attachComments=r.attachComments,n.Precedence=Gn({},t),n.browser=!1,n.FORMAT_MINIFY=ce,n.FORMAT_DEFAULTS=U})()})(fx)),fx}var Afe=Mfe();class Efe{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:e=>this.replacement=e}}replace(e,t,s,a){e&&t&&(s!=null?e[t][s]=a:e[t]=a)}remove(e,t,s){e&&t&&(s!=null?e[t].splice(s,1):delete e[t])}}class Dfe extends Efe{constructor(e,t){super(),this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:s=>this.replacement=s},this.enter=e,this.leave=t}visit(e,t,s,a){if(e){if(this.enter){const o=this.should_skip,i=this.should_remove,l=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,e,t,s,a),this.replacement&&(e=this.replacement,this.replace(t,s,a,e)),this.should_remove&&this.remove(t,s,a);const c=this.should_skip,u=this.should_remove;if(this.should_skip=o,this.should_remove=i,this.replacement=l,c)return e;if(u)return null}let r;for(r in e){const o=e[r];if(o&&typeof o=="object")if(Array.isArray(o)){const i=o;for(let l=0;l<i.length;l+=1){const c=i[l];c9(c)&&(this.visit(c,e,r,l)||l--)}}else c9(o)&&this.visit(o,e,r,null)}if(this.leave){const o=this.replacement,i=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,e,t,s,a),this.replacement&&(e=this.replacement,this.replace(t,s,a,e)),this.should_remove&&this.remove(t,s,a);const l=this.should_remove;if(this.replacement=o,this.should_remove=i,l)return null}}return e}}function c9(n){return n!==null&&typeof n=="object"&&"type"in n&&typeof n.type=="string"}function Tfe(n,{enter:e,leave:t}){return new Dfe(e,t).visit(n,null)}let __=[];function L_(n){__.push(n)}let Sy=new Map;function Ffe(n,e={}){var m;const{wrapAsync:t=!1,addReturn:s=!0,emitMiniLocations:a=!0,emitWidgets:r=!0}=e;let o=mfe(n,{ecmaVersion:2022,allowAwaitOutsideFunction:!0,locations:!0}),i=[];const l=(f,v)=>{const O=Sy.get("minilang");if(O){const k=`[${f}]`,M=O.getLocations(k,v.start);i=i.concat(M)}else{const k=YR(`"${f}"`,v.start,n);i=i.concat(k)}};let c=[];Tfe(o,{enter(f,v){var O,k,M;if(Zfe(f)){const{name:E}=f.tag,I=Sy.get(E),D=f.quasi.quasis[0].value.raw,F=f.quasi.start+1;if(a){const _=I.getLocations(D,F);i=i.concat(_)}return this.skip(),this.replace(Wfe(E,D,F))}if(zfe(f,"tidal")){const E=f.quasi.quasis[0].value.raw,I=f.quasi.start+1;if(a){const D=Gfe(E,I);i=i.concat(D)}return this.skip(),this.replace(Xfe(E,I))}if(Bfe(f,v)){const{quasis:E}=f,{raw:I}=E[0].value;return this.skip(),a&&l(I,f),this.replace(u9(I,f))}if(Nfe(f)){const{value:E}=f;return this.skip(),a&&l(E,f),this.replace(u9(E,f))}if($fe(f))return r&&c.push({from:f.arguments[0].start,to:f.arguments[0].end,value:f.arguments[0].raw,min:((O=f.arguments[1])==null?void 0:O.value)??0,max:((k=f.arguments[2])==null?void 0:k.value)??1,step:(M=f.arguments[3])==null?void 0:M.value,type:"slider"}),this.replace(_fe(f));if(Rfe(f)){const E=f.callee.property.name,I=c.filter(F=>F.type===E).length,D={to:f.end,index:I,type:E,id:e.id};return r&&c.push(D),this.replace(Lfe(f,D))}if(Ife(f,v))return this.replace(Qfe(f));if(Vfe(f))return this.replace(jfe(f))},leave(f,v,O,k){}});let{body:u}=o;if(!u.length)console.warn("empty body -> fallback to silence"),u.push({type:"ExpressionStatement",expression:{type:"Identifier",name:"silence"}});else if(!((m=u==null?void 0:u[u.length-1])!=null&&m.expression))throw new Error("unexpected ast format without body expression");if(s){const{expression:f}=u[u.length-1];u[u.length-1]={type:"ReturnStatement",argument:f}}let h=Afe.generate(o);return t&&(h=`(async ()=>{${h}})()`),a?{output:h,miniLocations:i,widgets:c}:{output:h}}function Nfe(n,e,t){return n.type!=="Literal"?!1:n.raw[0]==='"'}function Bfe(n,e){return n.type==="TemplateLiteral"&&e.type!=="TaggedTemplateExpression"}function u9(n,e){const{start:t}=e,s=Sy.get("minilang");let a="m";return s&&s.name&&(a=s.name),{type:"CallExpression",callee:{type:"Identifier",name:a},arguments:[{type:"Literal",value:n},{type:"Literal",value:t}],optional:!1}}function $fe(n){return n.type==="CallExpression"&&n.callee.name==="slider"}function Rfe(n){var e;return n.type==="CallExpression"&&__.includes((e=n.callee.property)==null?void 0:e.name)}function _fe(n){const e="slider_"+n.arguments[0].start;return n.arguments.unshift({type:"Literal",value:e,raw:e}),n.callee.name="sliderWithID",n}function pA(n){return`${n.id||""}_widget_${n.type}_${n.index}`}function Lfe(n,e){const t=pA(e);return n.arguments.unshift({type:"Literal",value:t,raw:t}),n}function Ife(n,e){return n.type==="CallExpression"&&n.callee.name==="samples"&&e.type!=="AwaitExpression"}function Qfe(n){return{type:"AwaitExpression",argument:n}}function Vfe(n){return n.type==="LabeledStatement"}function jfe(n){return{type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"MemberExpression",object:n.body.expression,property:{type:"Identifier",name:"p"}},arguments:[{type:"Literal",value:n.label.name,raw:`'${n.label.name}'`}]}}}function Zfe(n){return n.type==="TaggedTemplateExpression"&&Sy.has(n.tag.name)}function zfe(n,e){return n.type==="TaggedTemplateExpression"&&n.tag.name===e}function Gfe(n,e){return n.split("").reduce((t,s,a)=>(s!=='"'||(!t.length||t[t.length-1].length>1?t.push([a+1]):t[t.length-1].push(a)),t),[]).map(([t,s])=>{const a=n.slice(t,s);return YR(`"${a}"`,e+t-1)}).flat()}function Xfe(n,e){return{type:"CallExpression",callee:{type:"Identifier",name:"tidal"},arguments:[{type:"Literal",value:n},{type:"Literal",value:e}],optional:!1}}function Wfe(n,e,t){return{type:"CallExpression",callee:{type:"Identifier",name:n},arguments:[{type:"Literal",value:e},{type:"Literal",value:t}],optional:!1}}const qfe=Object.freeze(Object.defineProperty({__proto__:null,getWidgetID:pA,registerWidgetType:L_,transpiler:Ffe},Symbol.toStringTag,{value:"Module"}));let h9=n=>n,cd={},N2={addEventListener(){},removeEventListener(){}};function Ufe(){try{return typeof localStorage<"u"}catch{return!1}}Ufe()&&(cd=localStorage);let Hfe={addEventListener(n,e,t){window.addEventListener("storage",e),window.addEventListener("pageshow",t)},removeEventListener(n,e,t){window.removeEventListener("storage",e),window.removeEventListener("pageshow",t)}};typeof window<"u"&&(N2=Hfe);function Yfe(n,e=void 0,t={}){let s=t.encode||h9,a=t.decode||h9,r=KJ(e),o=r.set;r.set=c=>{typeof c>"u"?delete cd[n]:cd[n]=s(c),o(c)};function i(c){c.key===n?c.newValue===null?o(void 0):o(a(c.newValue)):cd[n]||o(void 0)}function l(){r.set(cd[n]?a(cd[n]):e)}return YJ(r,()=>{if(l(),t.listen!==!1)return N2.addEventListener(n,i,l),()=>{N2.removeEventListener(n,i,l)}}),r}const Kfe=JSON.parse(`[{"comment":"/**\\n * Overrides the css of highlighted events. Make sure to use single quotes!\\n * @name markcss\\n * @example\\n * note(\\"c a f e\\")\\n * .markcss('text-decoration:underline')\\n */","meta":{"filename":"codemirror.mjs","lineno":379,"columnno":0,"path":"/home/alex/src/strudel/packages/codemirror","code":{}},"description":"<p>Overrides the css of highlighted events. Make sure to use single quotes!</p>","name":"markcss","examples":["note(\\"c a f e\\")\\n.markcss('text-decoration:underline')"],"longname":"markcss","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a slider widget to allow the user manipulate a value\\n *\\n * @name slider\\n * @param {number} value Initial value\\n * @param {number} min Minimum value - optional, defaults to 0\\n * @param {number} max Maximum value - optional, defaults to 1\\n * @param {number} step Step size - optional\\n */","meta":{"filename":"slider.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/codemirror","code":{}},"description":"<p>Displays a slider widget to allow the user manipulate a value</p>","name":"slider","params":[{"type":{"names":["number"]},"description":"<p>Initial value</p>","name":"value"},{"type":{"names":["number"]},"description":"<p>Minimum value - optional, defaults to 0</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>Maximum value - optional, defaults to 1</p>","name":"max"},{"type":{"names":["number"]},"description":"<p>Step size - optional</p>","name":"step"}],"longname":"slider","kind":"member","scope":"global"},{"comment":"/**\\n * Select a sound / sample by name. When using mininotation, you can also optionally supply 'n' and 'gain' parameters\\n * separated by ':'.\\n *\\n * @name s\\n * @param {string | Pattern} sound The sound / pattern of sounds to pick\\n * @synonyms sound\\n * @example\\n * s(\\"bd hh\\")\\n * @example\\n * s(\\"bd:0 bd:1 bd:0:0.3 bd:1:1.4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":75,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Select a sound / sample by name. When using mininotation, you can also optionally supply 'n' and 'gain' parameters\\nseparated by ':'.</p>","name":"s","params":[{"type":{"names":["string","Pattern"]},"description":"<p>The sound / pattern of sounds to pick</p>","name":"sound"}],"synonyms_text":"sound","synonyms":["sound"],"examples":["s(\\"bd hh\\")","s(\\"bd:0 bd:1 bd:0:0.3 bd:1:1.4\\")"],"longname":"s","kind":"member","scope":"global"},{"comment":"/**\\n * Position in the wavetable of the wavetable oscillator\\n *\\n * @name wt\\n * @param {number | Pattern} position Position in the wavetable from 0 to 1\\n * @synonyms wavetablePosition\\n * @example\\n * s(\\"squelch\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").wt(\\"0 0.25 0.5 0.75 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":90,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Position in the wavetable of the wavetable oscillator</p>","name":"wt","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Position in the wavetable from 0 to 1</p>","name":"position"}],"synonyms_text":"wavetablePosition","synonyms":["wavetablePosition"],"examples":["s(\\"squelch\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").wt(\\"0 0.25 0.5 0.75 1\\")"],"longname":"wt","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of envelope applied wavetable oscillator's position envelope\\n *\\n * @name wtenv\\n * @param {number | Pattern} amount between 0 and 1\\n */","meta":{"filename":"controls.mjs","lineno":101,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of envelope applied wavetable oscillator's position envelope</p>","name":"wtenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"amount"}],"longname":"wtenv","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of the wavetable oscillator's position envelope\\n *\\n * @name wtattack\\n * @synonyms wtatt\\n * @param {number | Pattern} time attack time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":108,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of the wavetable oscillator's position envelope</p>","name":"wtattack","synonyms_text":"wtatt","synonyms":["wtatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"}],"longname":"wtattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of the wavetable oscillator's position envelope\\n *\\n * @name wtdecay\\n * @synonyms wtdec\\n * @param {number | Pattern} time decay time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":117,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of the wavetable oscillator's position envelope</p>","name":"wtdecay","synonyms_text":"wtdec","synonyms":["wtdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"longname":"wtdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain time of the wavetable oscillator's position envelope\\n *\\n * @name wtsustain\\n * @synonyms wtsus\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n */","meta":{"filename":"controls.mjs","lineno":126,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain time of the wavetable oscillator's position envelope</p>","name":"wtsustain","synonyms_text":"wtsus","synonyms":["wtsus"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"}],"longname":"wtsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of the wavetable oscillator's position envelope\\n *\\n * @name wtrelease\\n * @synonyms wtrel\\n * @param {number | Pattern} time release time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":135,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of the wavetable oscillator's position envelope</p>","name":"wtrelease","synonyms_text":"wtrel","synonyms":["wtrel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"longname":"wtrelease","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of the LFO for the wavetable oscillator's position\\n *\\n * @name wtrate\\n * @param {number | Pattern} rate rate in hertz\\n */","meta":{"filename":"controls.mjs","lineno":144,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of the LFO for the wavetable oscillator's position</p>","name":"wtrate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in hertz</p>","name":"rate"}],"longname":"wtrate","kind":"member","scope":"global"},{"comment":"/**\\n * cycle synced rate of the LFO for the wavetable oscillator's position\\n *\\n * @name wtsync\\n * @param {number | Pattern} rate rate in cycles\\n */","meta":{"filename":"controls.mjs","lineno":151,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>cycle synced rate of the LFO for the wavetable oscillator's position</p>","name":"wtsync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in cycles</p>","name":"rate"}],"longname":"wtsync","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of the LFO for the wavetable oscillator's position\\n *\\n * @name wtdepth\\n * @param {number | Pattern} depth depth of modulation\\n */","meta":{"filename":"controls.mjs","lineno":159,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of the LFO for the wavetable oscillator's position</p>","name":"wtdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation</p>","name":"depth"}],"longname":"wtdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of the LFO for the wavetable oscillator's position\\n *\\n * @name wtshape\\n * @param {number | Pattern} shape Shape of the lfo (0, 1, 2, ..)\\n */","meta":{"filename":"controls.mjs","lineno":167,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of the LFO for the wavetable oscillator's position</p>","name":"wtshape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Shape of the lfo (0, 1, 2, ..)</p>","name":"shape"}],"longname":"wtshape","kind":"member","scope":"global"},{"comment":"/**\\n * DC offset of the LFO for the wavetable oscillator's position\\n *\\n * @name wtdc\\n * @param {number | Pattern} dcoffset dc offset. set to 0 for unipolar\\n */","meta":{"filename":"controls.mjs","lineno":175,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DC offset of the LFO for the wavetable oscillator's position</p>","name":"wtdc","params":[{"type":{"names":["number","Pattern"]},"description":"<p>dc offset. set to 0 for unipolar</p>","name":"dcoffset"}],"longname":"wtdc","kind":"member","scope":"global"},{"comment":"/**\\n * Skew of the LFO for the wavetable oscillator's position\\n *\\n * @name wtskew\\n * @param {number | Pattern} skew How much to bend the LFO shape\\n */","meta":{"filename":"controls.mjs","lineno":183,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Skew of the LFO for the wavetable oscillator's position</p>","name":"wtskew","params":[{"type":{"names":["number","Pattern"]},"description":"<p>How much to bend the LFO shape</p>","name":"skew"}],"longname":"wtskew","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of warp (alteration of the waveform) to apply to the wavetable oscillator\\n *\\n * @name warp\\n * @param {number | Pattern} amount Warp of the wavetable from 0 to 1\\n * @synonyms wavetableWarp\\n * @example\\n * s(\\"basique\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n *   .warpmode(\\"spin\\")\\n */","meta":{"filename":"controls.mjs","lineno":191,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of warp (alteration of the waveform) to apply to the wavetable oscillator</p>","name":"warp","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Warp of the wavetable from 0 to 1</p>","name":"amount"}],"synonyms_text":"wavetableWarp","synonyms":["wavetableWarp"],"examples":["s(\\"basique\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n  .warpmode(\\"spin\\")"],"longname":"warp","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of the wavetable oscillator's warp envelope\\n *\\n * @name warpattack\\n * @synonyms warpatt\\n * @param {number | Pattern} time attack time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":203,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of the wavetable oscillator's warp envelope</p>","name":"warpattack","synonyms_text":"warpatt","synonyms":["warpatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"}],"longname":"warpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of the wavetable oscillator's warp envelope\\n *\\n * @name warpdecay\\n * @synonyms warpdec\\n * @param {number | Pattern} time decay time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of the wavetable oscillator's warp envelope</p>","name":"warpdecay","synonyms_text":"warpdec","synonyms":["warpdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"longname":"warpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain time of the wavetable oscillator's warp envelope\\n *\\n * @name warpsustain\\n * @synonyms warpsus\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n */","meta":{"filename":"controls.mjs","lineno":221,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain time of the wavetable oscillator's warp envelope</p>","name":"warpsustain","synonyms_text":"warpsus","synonyms":["warpsus"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"}],"longname":"warpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of the wavetable oscillator's warp envelope\\n *\\n * @name warprelease\\n * @synonyms warprel\\n * @param {number | Pattern} time release time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":230,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of the wavetable oscillator's warp envelope</p>","name":"warprelease","synonyms_text":"warprel","synonyms":["warprel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"longname":"warprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of the LFO for the wavetable oscillator's warp\\n *\\n * @name warprate\\n * @param {number | Pattern} rate rate in hertz\\n */","meta":{"filename":"controls.mjs","lineno":239,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of the LFO for the wavetable oscillator's warp</p>","name":"warprate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in hertz</p>","name":"rate"}],"longname":"warprate","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpdepth\\n * @param {number | Pattern} depth depth of modulation\\n */","meta":{"filename":"controls.mjs","lineno":247,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of the LFO for the wavetable oscillator's warp</p>","name":"warpdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation</p>","name":"depth"}],"longname":"warpdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpshape\\n * @param {number | Pattern} shape Shape of the lfo (0, 1, 2, ..)\\n */","meta":{"filename":"controls.mjs","lineno":255,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of the LFO for the wavetable oscillator's warp</p>","name":"warpshape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Shape of the lfo (0, 1, 2, ..)</p>","name":"shape"}],"longname":"warpshape","kind":"member","scope":"global"},{"comment":"/**\\n * DC offset of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpdc\\n * @param {number | Pattern} dcoffset dc offset. set to 0 for unipolar\\n */","meta":{"filename":"controls.mjs","lineno":263,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DC offset of the LFO for the wavetable oscillator's warp</p>","name":"warpdc","params":[{"type":{"names":["number","Pattern"]},"description":"<p>dc offset. set to 0 for unipolar</p>","name":"dcoffset"}],"longname":"warpdc","kind":"member","scope":"global"},{"comment":"/**\\n * Skew of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpskew\\n * @param {number | Pattern} skew How much to bend the LFO shape\\n */","meta":{"filename":"controls.mjs","lineno":271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Skew of the LFO for the wavetable oscillator's warp</p>","name":"warpskew","params":[{"type":{"names":["number","Pattern"]},"description":"<p>How much to bend the LFO shape</p>","name":"skew"}],"longname":"warpskew","kind":"member","scope":"global"},{"comment":"/**\\n * Type of warp (alteration of the waveform) to apply to the wavetable oscillator.\\n *\\n * The current options are: none, asym, bendp, bendm, bendmp, sync, quant, fold, pwm, orbit,\\n * spin, chaos, primes, binary, brownian, reciprocal, wormhole, logistic, sigmoid, fractal, flip\\n *\\n * @name warpmode\\n * @param {number | string | Pattern} mode Warp mode\\n * @synonyms wavetableWarpMode\\n * @example\\n * s(\\"morgana\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n *   .warpmode(\\"<asym bendp spin logistic sync wormhole brownian>*2\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":279,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Type of warp (alteration of the waveform) to apply to the wavetable oscillator.</p>\\n<p>The current options are: none, asym, bendp, bendm, bendmp, sync, quant, fold, pwm, orbit,\\nspin, chaos, primes, binary, brownian, reciprocal, wormhole, logistic, sigmoid, fractal, flip</p>","name":"warpmode","params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>Warp mode</p>","name":"mode"}],"synonyms_text":"wavetableWarpMode","synonyms":["wavetableWarpMode"],"examples":["s(\\"morgana\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n  .warpmode(\\"<asym bendp spin logistic sync wormhole brownian>*2\\")"],"longname":"warpmode","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of randomness of the initial phase of the wavetable oscillator.\\n *\\n * @name wtphaserand\\n * @param {number | Pattern} amount Randomness of the initial phase. Between 0 (not random) and 1 (fully random)\\n * @synonyms wavetablePhaseRand\\n * @example\\n * s(\\"basique\\").bank(\\"wt_digital\\").seg(16).wtphaserand(\\"<0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":295,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of randomness of the initial phase of the wavetable oscillator.</p>","name":"wtphaserand","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Randomness of the initial phase. Between 0 (not random) and 1 (fully random)</p>","name":"amount"}],"synonyms_text":"wavetablePhaseRand","synonyms":["wavetablePhaseRand"],"examples":["s(\\"basique\\").bank(\\"wt_digital\\").seg(16).wtphaserand(\\"<0 1>\\")"],"longname":"wtphaserand","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of envelope applied wavetable oscillator's position envelope\\n *\\n * @name warpenv\\n * @param {number | Pattern} amount between 0 and 1\\n */","meta":{"filename":"controls.mjs","lineno":307,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of envelope applied wavetable oscillator's position envelope</p>","name":"warpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"amount"}],"longname":"warpenv","kind":"member","scope":"global"},{"comment":"/**\\n * cycle synced rate of the LFO for the wavetable warp position\\n *\\n * @name warpsync\\n * @param {number | Pattern} rate rate in cycles\\n */","meta":{"filename":"controls.mjs","lineno":315,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>cycle synced rate of the LFO for the wavetable warp position</p>","name":"warpsync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in cycles</p>","name":"rate"}],"longname":"warpsync","kind":"member","scope":"global"},{"comment":"/**\\n * Define a custom webaudio node to use as a sound source.\\n *\\n * @name source\\n * @synonyms src\\n * @param {function} getSource\\n * @synonyms src\\n *\\n */","meta":{"filename":"controls.mjs","lineno":323,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Define a custom webaudio node to use as a sound source.</p>","name":"source","synonyms_text":"src","synonyms":["src"],"params":[{"type":{"names":["function"]},"name":"getSource"}],"longname":"source","kind":"member","scope":"global"},{"comment":"/**\\n * Selects the given index from the sample map.\\n * Numbers too high will wrap around.\\n * \`n\` can also be used to play midi numbers, but it is recommended to use \`note\` instead.\\n *\\n * @name n\\n * @param {number | Pattern} value sample index starting from 0\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").n(\\"<0 1>\\")\\n */","meta":{"filename":"controls.mjs","lineno":333,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Selects the given index from the sample map.\\nNumbers too high will wrap around.\\n<code>n</code> can also be used to play midi numbers, but it is recommended to use <code>note</code> instead.</p>","name":"n","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sample index starting from 0</p>","name":"value"}],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").n(\\"<0 1>\\")"],"longname":"n","kind":"member","scope":"global"},{"comment":"/**\\n * Plays the given note name or midi number. A note name consists of\\n *\\n * - a letter (a-g or A-G)\\n * - optional accidentals (b or #)\\n * - optional (possibly negative) octave number (0-9). Defaults to 3\\n *\\n * Examples of valid note names: \`c\`, \`bb\`, \`Bb\`, \`f#\`, \`c3\`, \`A4\`, \`Eb2\`, \`c#5\`\\n *\\n * You can also use midi numbers instead of note names, where 69 is mapped to A4 440Hz in 12EDO.\\n *\\n * @name note\\n * @example\\n * note(\\"c a f e\\")\\n * @example\\n * note(\\"c4 a4 f4 e4\\")\\n * @example\\n * note(\\"60 69 65 64\\")\\n * @example\\n * note(\\"fbb1 a#0 cbbb-1 e##-2\\").sound(\\"saw\\")\\n */","meta":{"filename":"controls.mjs","lineno":345,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Plays the given note name or midi number. A note name consists of</p>\\n<ul>\\n<li>a letter (a-g or A-G)</li>\\n<li>optional accidentals (b or #)</li>\\n<li>optional (possibly negative) octave number (0-9). Defaults to 3</li>\\n</ul>\\n<p>Examples of valid note names: <code>c</code>, <code>bb</code>, <code>Bb</code>, <code>f#</code>, <code>c3</code>, <code>A4</code>, <code>Eb2</code>, <code>c#5</code></p>\\n<p>You can also use midi numbers instead of note names, where 69 is mapped to A4 440Hz in 12EDO.</p>","name":"note","examples":["note(\\"c a f e\\")","note(\\"c4 a4 f4 e4\\")","note(\\"60 69 65 64\\")","note(\\"fbb1 a#0 cbbb-1 e##-2\\").sound(\\"saw\\")"],"longname":"note","kind":"member","scope":"global"},{"comment":"/**\\n * A pattern of numbers that speed up (or slow down) samples while they play. Currently only supported by osc / superdirt.\\n *\\n * @name accelerate\\n * @param {number | Pattern} amount acceleration.\\n * @superdirtOnly\\n * @example\\n * s(\\"sax\\").accelerate(\\"<0 1 2 4 8 16>\\").slow(2).osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":368,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A pattern of numbers that speed up (or slow down) samples while they play. Currently only supported by osc / superdirt.</p>","name":"accelerate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>acceleration.</p>","name":"amount"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"sax\\").accelerate(\\"<0 1 2 4 8 16>\\").slow(2).osc()"],"longname":"accelerate","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the velocity from 0 to 1. Is multiplied together with gain.\\n *\\n * @name velocity\\n * @example\\n * s(\\"hh*8\\")\\n * .gain(\\".4!2 1 .4!2 1 .4 1\\")\\n * .velocity(\\".4 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":379,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the velocity from 0 to 1. Is multiplied together with gain.</p>","name":"velocity","examples":["s(\\"hh*8\\")\\n.gain(\\".4!2 1 .4!2 1 .4 1\\")\\n.velocity(\\".4 1\\")"],"longname":"velocity","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the gain by an exponential amount.\\n *\\n * @name gain\\n * @param {number | Pattern} amount gain.\\n * @example\\n * s(\\"hh*8\\").gain(\\".4!2 1 .4!2 1 .4 1\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":389,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the gain by an exponential amount.</p>","name":"gain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>gain.</p>","name":"amount"}],"examples":["s(\\"hh*8\\").gain(\\".4!2 1 .4!2 1 .4 1\\").fast(2)"],"longname":"gain","kind":"member","scope":"global"},{"comment":"/**\\n * Gain applied after all effects have been processed.\\n *\\n * @name postgain\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\")\\n * .compressor(\\"-20:20:10:.002:.02\\").postgain(1.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":399,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Gain applied after all effects have been processed.</p>","name":"postgain","examples":["s(\\"bd sd [~ bd] sd,hh*8\\")\\n.compressor(\\"-20:20:10:.002:.02\\").postgain(1.5)"],"longname":"postgain","kind":"member","scope":"global"},{"comment":"/**\\n * Like \`gain\`, but linear.\\n *\\n * @name amp\\n * @param {number | Pattern} amount gain.\\n * @superdirtOnly\\n * @example\\n * s(\\"bd*8\\").amp(\\".1*2 .5 .1*2 .5 .1 .5\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":409,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>gain</code>, but linear.</p>","name":"amp","params":[{"type":{"names":["number","Pattern"]},"description":"<p>gain.</p>","name":"amount"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"bd*8\\").amp(\\".1*2 .5 .1*2 .5 .1 .5\\").osc()"],"longname":"amp","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope attack time: Specifies how long it takes for the sound to reach its peak value, relative to the onset.\\n *\\n * @name attack\\n * @param {number | Pattern} attack time in seconds.\\n * @synonyms att\\n * @example\\n * note(\\"c3 e3 f3 g3\\").attack(\\"<0 .1 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":420,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope attack time: Specifies how long it takes for the sound to reach its peak value, relative to the onset.</p>","name":"attack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds.</p>","name":"attack"}],"synonyms_text":"att","synonyms":["att"],"examples":["note(\\"c3 e3 f3 g3\\").attack(\\"<0 .1 .5>\\")"],"longname":"attack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the Frequency Modulation Harmonicity Ratio.\\n * Controls the timbre of the sound.\\n * Whole numbers and simple ratios sound more natural,\\n * while decimal numbers and complex ratios sound metallic.\\n *\\n * @name fmh\\n * @param {number | Pattern} harmonicity\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmh(\\"<1 2 1.5 1.61>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":432,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the Frequency Modulation Harmonicity Ratio.\\nControls the timbre of the sound.\\nWhole numbers and simple ratios sound more natural,\\nwhile decimal numbers and complex ratios sound metallic.</p>","name":"fmh","params":[{"type":{"names":["number","Pattern"]},"name":"harmonicity"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmh(\\"<1 2 1.5 1.61>\\")\\n._scope()"],"longname":"fmh","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the Frequency Modulation of the synth.\\n * Controls the modulation index, which defines the brightness of the sound.\\n *\\n * @name fm\\n * @param {number | Pattern} brightness modulation index\\n * @synonyms fmi\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(\\"<0 1 2 8 32>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the Frequency Modulation of the synth.\\nControls the modulation index, which defines the brightness of the sound.</p>","name":"fm","params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation index</p>","name":"brightness"}],"synonyms_text":"fmi","synonyms":["fmi"],"examples":["note(\\"c e g b g e\\")\\n.fm(\\"<0 1 2 8 32>\\")\\n._scope()"],"longname":"fm","kind":"member","scope":"global"},{"comment":"/**\\n * Ramp type of fm envelope. Exp might be a bit broken..\\n *\\n * @name fmenv\\n * @param {number | Pattern} type lin | exp\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(.2)\\n * .fmsustain(0)\\n * .fmenv(\\"<exp lin>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":463,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Ramp type of fm envelope. Exp might be a bit broken..</p>","name":"fmenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>lin | exp</p>","name":"type"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(.2)\\n.fmsustain(0)\\n.fmenv(\\"<exp lin>\\")\\n._scope()"],"longname":"fmenv","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time for the FM envelope: time it takes to reach maximum modulation\\n *\\n * @name fmattack\\n * @param {number | Pattern} time attack time\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmattack(\\"<0 .05 .1 .2>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":478,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time for the FM envelope: time it takes to reach maximum modulation</p>","name":"fmattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time</p>","name":"time"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmattack(\\"<0 .05 .1 .2>\\")\\n._scope()"],"longname":"fmattack","kind":"member","scope":"global"},{"comment":"/**\\n * Waveform of the fm modulator\\n *\\n * @name fmwave\\n * @param {number | Pattern} wave waveform\\n * @example\\n * n(\\"0 1 2 3\\".fast(4)).scale(\\"d:minor\\").s(\\"sine\\").fmwave(\\"<sine square sawtooth crackle>\\").fm(4).fmh(2.01)\\n * @example\\n * n(\\"0 1 2 3\\".fast(4)).chord(\\"<Dm Am F G>\\").voicing().s(\\"sawtooth\\").fmwave(\\"brown\\").fm(.6)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":492,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Waveform of the fm modulator</p>","name":"fmwave","params":[{"type":{"names":["number","Pattern"]},"description":"<p>waveform</p>","name":"wave"}],"examples":["n(\\"0 1 2 3\\".fast(4)).scale(\\"d:minor\\").s(\\"sine\\").fmwave(\\"<sine square sawtooth crackle>\\").fm(4).fmh(2.01)","n(\\"0 1 2 3\\".fast(4)).chord(\\"<Dm Am F G>\\").voicing().s(\\"sawtooth\\").fmwave(\\"brown\\").fm(.6)"],"longname":"fmwave","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time for the FM envelope: seconds until the sustain level is reached after the attack phase.\\n *\\n * @name fmdecay\\n * @param {number | Pattern} time decay time\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(\\"<.01 .05 .1 .2>\\")\\n * .fmsustain(.4)\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":505,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time for the FM envelope: seconds until the sustain level is reached after the attack phase.</p>","name":"fmdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time</p>","name":"time"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(\\"<.01 .05 .1 .2>\\")\\n.fmsustain(.4)\\n._scope()"],"longname":"fmdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain level for the FM envelope: how much modulation is applied after the decay phase\\n *\\n * @name fmsustain\\n * @param {number | Pattern} level sustain level\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(.1)\\n * .fmsustain(\\"<1 .75 .5 0>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":519,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain level for the FM envelope: how much modulation is applied after the decay phase</p>","name":"fmsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level</p>","name":"level"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(.1)\\n.fmsustain(\\"<1 .75 .5 0>\\")\\n._scope()"],"longname":"fmsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Select the sound bank to use. To be used together with \`s\`. The bank name (+ \\"_\\") will be prepended to the value of \`s\`.\\n *\\n * @name bank\\n * @param {string | Pattern} bank the name of the bank\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").bank('RolandTR909') // = s(\\"RolandTR909_bd RolandTR909_sd\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":537,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Select the sound bank to use. To be used together with <code>s</code>. The bank name (+ &quot;_&quot;) will be prepended to the value of <code>s</code>.</p>","name":"bank","params":[{"type":{"names":["string","Pattern"]},"description":"<p>the name of the bank</p>","name":"bank"}],"examples":["s(\\"bd sd [~ bd] sd\\").bank('RolandTR909') // = s(\\"RolandTR909_bd RolandTR909_sd\\")"],"longname":"bank","kind":"member","scope":"global"},{"comment":"/**\\n * mix control for the chorus effect\\n *\\n * @name chorus\\n * @param {string | Pattern} chorus mix amount between 0 and 1\\n * @example\\n * note(\\"d d a# a\\").s(\\"sawtooth\\").chorus(.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":548,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>mix control for the chorus effect</p>","name":"chorus","params":[{"type":{"names":["string","Pattern"]},"description":"<p>mix amount between 0 and 1</p>","name":"chorus"}],"examples":["note(\\"d d a# a\\").s(\\"sawtooth\\").chorus(.5)"],"longname":"chorus","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope decay time: the time it takes after the attack time to reach the sustain level.\\n * Note that the decay is only audible if the sustain value is lower than 1.\\n *\\n * @name decay\\n * @param {number | Pattern} time decay time in seconds\\n * @synonyms dec\\n * @example\\n * note(\\"c3 e3 f3 g3\\").decay(\\"<.1 .2 .3 .4>\\").sustain(0)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":564,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope decay time: the time it takes after the attack time to reach the sustain level.\\nNote that the decay is only audible if the sustain value is lower than 1.</p>","name":"decay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"synonyms_text":"dec","synonyms":["dec"],"examples":["note(\\"c3 e3 f3 g3\\").decay(\\"<.1 .2 .3 .4>\\").sustain(0)"],"longname":"decay","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope sustain level: The level which is reached after attack / decay, being sustained until the offset.\\n *\\n * @name sustain\\n * @param {number | Pattern} gain sustain level between 0 and 1\\n * @synonyms sus\\n * @example\\n * note(\\"c3 e3 f3 g3\\").decay(.2).sustain(\\"<0 .1 .4 .6 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":576,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope sustain level: The level which is reached after attack / decay, being sustained until the offset.</p>","name":"sustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level between 0 and 1</p>","name":"gain"}],"synonyms_text":"sus","synonyms":["sus"],"examples":["note(\\"c3 e3 f3 g3\\").decay(.2).sustain(\\"<0 .1 .4 .6 1>\\")"],"longname":"sustain","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope release time: The time it takes after the offset to go from sustain level to zero.\\n *\\n * @name release\\n * @param {number | Pattern} time release time in seconds\\n * @synonyms rel\\n * @example\\n * note(\\"c3 e3 g3 c4\\").release(\\"<0 .1 .4 .6 1>/2\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":587,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope release time: The time it takes after the offset to go from sustain level to zero.</p>","name":"release","params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"synonyms_text":"rel","synonyms":["rel"],"examples":["note(\\"c3 e3 g3 c4\\").release(\\"<0 .1 .4 .6 1>/2\\")"],"longname":"release","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the center frequency of the **b**and-**p**ass **f**ilter. When using mininotation, you\\n * can also optionally supply the 'bpq' parameter separated by ':'.\\n *\\n * @name bpf\\n * @param {number | Pattern} frequency center frequency\\n * @synonyms bandf, bp\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").bpf(\\"<1000 2000 4000 8000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":600,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the center frequency of the <strong>b</strong>and-<strong>p</strong>ass <strong>f</strong>ilter. When using mininotation, you\\ncan also optionally supply the 'bpq' parameter separated by ':'.</p>","name":"bpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>center frequency</p>","name":"frequency"}],"synonyms_text":"bandf, bp","synonyms":["bandf","bp"],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").bpf(\\"<1000 2000 4000 8000>\\")"],"longname":"bpf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the **b**and-**p**ass **q**-factor (resonance).\\n *\\n * @name bpq\\n * @param {number | Pattern} q q factor\\n * @synonyms bandq\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").bpf(500).bpq(\\"<0 1 2 3>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":613,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the <strong>b</strong>and-<strong>p</strong>ass <strong>q</strong>-factor (resonance).</p>","name":"bpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>q factor</p>","name":"q"}],"synonyms_text":"bandq","synonyms":["bandq"],"examples":["s(\\"bd sd [~ bd] sd\\").bpf(500).bpq(\\"<0 1 2 3>\\")"],"longname":"bpq","kind":"member","scope":"global"},{"comment":"/**\\n * A pattern of numbers from 0 to 1. Skips the beginning of each sample, e.g. \`0.25\` to cut off the first quarter from each sample.\\n *\\n * @memberof Pattern\\n * @name begin\\n * @param {number | Pattern} amount between 0 and 1, where 1 is the length of the sample\\n * @example\\n * samples({ rave: 'rave/AREUREADY.wav' }, 'github:tidalcycles/dirt-samples')\\n * s(\\"rave\\").begin(\\"<0 .25 .5 .75>\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":626,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A pattern of numbers from 0 to 1. Skips the beginning of each sample, e.g. <code>0.25</code> to cut off the first quarter from each sample.</p>","memberof":"Pattern","name":"begin","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"amount"}],"examples":["samples({ rave: 'rave/AREUREADY.wav' }, 'github:tidalcycles/dirt-samples')\\ns(\\"rave\\").begin(\\"<0 .25 .5 .75>\\").fast(2)"],"scope":"static","longname":"Pattern.begin","kind":"member"},{"comment":"/**\\n * The same as .begin, but cuts off the end off each sample.\\n *\\n * @memberof Pattern\\n * @name end\\n * @param {number | Pattern} length 1 = whole sample, .5 = half sample, .25 = quarter sample etc..\\n * @example\\n * s(\\"bd*2,oh*4\\").end(\\"<.1 .2 .5 1>\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The same as .begin, but cuts off the end off each sample.</p>","memberof":"Pattern","name":"end","params":[{"type":{"names":["number","Pattern"]},"description":"<p>1 = whole sample, .5 = half sample, .25 = quarter sample etc..</p>","name":"length"}],"examples":["s(\\"bd*2,oh*4\\").end(\\"<.1 .2 .5 1>\\").fast(2)"],"scope":"static","longname":"Pattern.end","kind":"member"},{"comment":"/**\\n * Loops the sample.\\n * Note that the tempo of the loop is not synced with the cycle tempo.\\n * To change the loop region, use loopBegin / loopEnd.\\n *\\n * @name loop\\n * @param {number | Pattern} on If 1, the sample is looped\\n * @example\\n * s(\\"casio\\").loop(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":649,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Loops the sample.\\nNote that the tempo of the loop is not synced with the cycle tempo.\\nTo change the loop region, use loopBegin / loopEnd.</p>","name":"loop","params":[{"type":{"names":["number","Pattern"]},"description":"<p>If 1, the sample is looped</p>","name":"on"}],"examples":["s(\\"casio\\").loop(1)"],"longname":"loop","kind":"member","scope":"global"},{"comment":"/**\\n * Begin to loop at a specific point in the sample (inbetween \`begin\` and \`end\`).\\n * Note that the loop point must be inbetween \`begin\` and \`end\`, and before \`loopEnd\`!\\n * Note: Samples starting with wt_ will automatically loop! (wt = wavetable)\\n *\\n * @name loopBegin\\n * @param {number | Pattern} time between 0 and 1, where 1 is the length of the sample\\n * @synonyms loopb\\n * @example\\n * s(\\"space\\").loop(1)\\n * .loopBegin(\\"<0 .125 .25>\\")._scope()\\n */","meta":{"filename":"controls.mjs","lineno":661,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Begin to loop at a specific point in the sample (inbetween <code>begin</code> and <code>end</code>).\\nNote that the loop point must be inbetween <code>begin</code> and <code>end</code>, and before <code>loopEnd</code>!\\nNote: Samples starting with wt_ will automatically loop! (wt = wavetable)</p>","name":"loopBegin","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"time"}],"synonyms_text":"loopb","synonyms":["loopb"],"examples":["s(\\"space\\").loop(1)\\n.loopBegin(\\"<0 .125 .25>\\")._scope()"],"longname":"loopBegin","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * End the looping section at a specific point in the sample (inbetween \`begin\` and \`end\`).\\n * Note that the loop point must be inbetween \`begin\` and \`end\`, and after \`loopBegin\`!\\n *\\n * @name loopEnd\\n * @param {number | Pattern} time between 0 and 1, where 1 is the length of the sample\\n * @synonyms loope\\n * @example\\n * s(\\"space\\").loop(1)\\n * .loopEnd(\\"<1 .75 .5 .25>\\")._scope()\\n */","meta":{"filename":"controls.mjs","lineno":674,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>End the looping section at a specific point in the sample (inbetween <code>begin</code> and <code>end</code>).\\nNote that the loop point must be inbetween <code>begin</code> and <code>end</code>, and after <code>loopBegin</code>!</p>","name":"loopEnd","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"time"}],"synonyms_text":"loope","synonyms":["loope"],"examples":["s(\\"space\\").loop(1)\\n.loopEnd(\\"<1 .75 .5 .25>\\")._scope()"],"longname":"loopEnd","kind":"member","scope":"global"},{"comment":"/**\\n * Bit crusher effect.\\n *\\n * @name crush\\n * @param {number | Pattern} depth between 1 (for drastic reduction in bit-depth) to 16 (for barely no reduction).\\n * @example\\n * s(\\"<bd sd>,hh*3\\").fast(2).crush(\\"<16 8 7 6 5 4 3 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":687,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Bit crusher effect.</p>","name":"crush","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 1 (for drastic reduction in bit-depth) to 16 (for barely no reduction).</p>","name":"depth"}],"examples":["s(\\"<bd sd>,hh*3\\").fast(2).crush(\\"<16 8 7 6 5 4 3 2>\\")"],"longname":"crush","kind":"member","scope":"global"},{"comment":"/**\\n * Fake-resampling for lowering the sample rate. Caution: This effect seems to only work in chromium based browsers\\n *\\n * @name coarse\\n * @param {number | Pattern} factor 1 for original 2 for half, 3 for a third and so on.\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").coarse(\\"<1 4 8 16 32>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":698,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Fake-resampling for lowering the sample rate. Caution: This effect seems to only work in chromium based browsers</p>","name":"coarse","params":[{"type":{"names":["number","Pattern"]},"description":"<p>1 for original 2 for half, 3 for a third and so on.</p>","name":"factor"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").coarse(\\"<1 4 8 16 32>\\")"],"longname":"coarse","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of a sound with a continuous waveform\\n *\\n * @name tremolo\\n * @synonyms trem\\n * @param {number | Pattern} speed modulation speed in HZ\\n * @example\\n * note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolo(\\"<3 2 100> \\").tremoloskew(\\"<.5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":709,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of a sound with a continuous waveform</p>","name":"tremolo","synonyms_text":"trem","synonyms":["trem"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation speed in HZ</p>","name":"speed"}],"examples":["note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolo(\\"<3 2 100> \\").tremoloskew(\\"<.5>\\")"],"longname":"tremolo","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of a sound with a continuous waveform\\n *\\n * @name tremolosync\\n * @synonyms tremsync\\n * @param {number | Pattern} cycles modulation speed in cycles\\n * @example\\n * note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolosync(\\"4\\").tremoloskew(\\"<1 .5 0>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":721,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of a sound with a continuous waveform</p>","name":"tremolosync","synonyms_text":"tremsync","synonyms":["tremsync"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation speed in cycles</p>","name":"cycles"}],"examples":["note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolosync(\\"4\\").tremoloskew(\\"<1 .5 0>\\")"],"longname":"tremolosync","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of amplitude modulation\\n *\\n * @name tremolodepth\\n * @synonyms tremdepth\\n * @param {number | Pattern} depth\\n * @example\\n * note(\\"a1 a1 a#1 a1\\".fast(4)).s(\\"pulse\\").tremsync(4).tremolodepth(\\"<1 2 .7>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":736,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of amplitude modulation</p>","name":"tremolodepth","synonyms_text":"tremdepth","synonyms":["tremdepth"],"params":[{"type":{"names":["number","Pattern"]},"name":"depth"}],"examples":["note(\\"a1 a1 a#1 a1\\".fast(4)).s(\\"pulse\\").tremsync(4).tremolodepth(\\"<1 2 .7>\\")"],"longname":"tremolodepth","kind":"member","scope":"global"},{"comment":"/**\\n * Alter the shape of the modulation waveform\\n *\\n * @name tremoloskew\\n * @synonyms tremskew\\n * @param {number | Pattern} amount between 0 & 1, the shape of the waveform\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremoloskew(\\"<.5 0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":747,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Alter the shape of the modulation waveform</p>","name":"tremoloskew","synonyms_text":"tremskew","synonyms":["tremskew"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 &amp; 1, the shape of the waveform</p>","name":"amount"}],"examples":["note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremoloskew(\\"<.5 0 1>\\")"],"longname":"tremoloskew","kind":"member","scope":"global"},{"comment":"/**\\n * Alter the phase of the modulation waveform\\n *\\n * @name tremolophase\\n * @synonyms tremphase\\n * @param {number | Pattern} offset the offset in cycles of the modulation\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremolophase(\\"<0 .25 .66>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":759,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Alter the phase of the modulation waveform</p>","name":"tremolophase","synonyms_text":"tremphase","synonyms":["tremphase"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>the offset in cycles of the modulation</p>","name":"offset"}],"examples":["note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremolophase(\\"<0 .25 .66>\\")"],"longname":"tremolophase","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of amplitude modulation\\n *\\n * @name tremoloshape\\n * @synonyms tremshape\\n * @param {number | Pattern} shape tri | square | sine | saw | ramp\\n * @example\\n * note(\\"{f g c d}%16\\").tremsync(4).tremoloshape(\\"<sine tri square>\\").s(\\"sawtooth\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":771,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of amplitude modulation</p>","name":"tremoloshape","synonyms_text":"tremshape","synonyms":["tremshape"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>tri | square | sine | saw | ramp</p>","name":"shape"}],"examples":["note(\\"{f g c d}%16\\").tremsync(4).tremoloshape(\\"<sine tri square>\\").s(\\"sawtooth\\")"],"longname":"tremoloshape","kind":"member","scope":"global"},{"comment":"/**\\n * Filter overdrive for supported filter types\\n *\\n * @name drive\\n * @param {number | Pattern} amount\\n * @example\\n * note(\\"{f g g c d a a#}%16\\".sub(17)).s(\\"supersaw\\").lpenv(8).lpf(150).lpq(.8).ftype('ladder').drive(\\"<.5 4>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":782,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filter overdrive for supported filter types</p>","name":"drive","params":[{"type":{"names":["number","Pattern"]},"name":"amount"}],"examples":["note(\\"{f g g c d a a#}%16\\".sub(17)).s(\\"supersaw\\").lpenv(8).lpf(150).lpq(.8).ftype('ladder').drive(\\"<.5 4>\\")"],"longname":"drive","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of an orbit to create a \\"sidechain\\" like effect.\\n *\\n * Can be applied to multiple orbits with the ':' mininotation, e.g. \`duckorbit(\\"2:3\\")\`\\n *\\n * @name duckorbit\\n * @synonyms duck\\n * @param {number | Pattern} orbit target orbit\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(1)\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"hh*16\\").orbit(3)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":793,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of an orbit to create a &quot;sidechain&quot; like effect.</p>\\n<p>Can be applied to multiple orbits with the ':' mininotation, e.g. <code>duckorbit(&quot;2:3&quot;)</code></p>","name":"duckorbit","synonyms_text":"duck","synonyms":["duck"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>target orbit</p>","name":"orbit"}],"examples":["$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(1)","$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"hh*16\\").orbit(3)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(1)"],"longname":"duckorbit","kind":"member","scope":"global"},{"comment":"/**\\n * The amount of ducking applied to target orbit\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckdepth(\\"0.3:0.1\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckdepth\\n * @param {number | Pattern} depth depth of modulation from 0 to 1\\n * @example\\n * stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(\\"<1 .9 .6 0>\\"))\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"hh*16\\").orbit(3)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(\\"1:0.5\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":812,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The amount of ducking applied to target orbit</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckdepth(&quot;0.3:0.1&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation from 0 to 1</p>","name":"depth"}],"examples":["stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(\\"<1 .9 .6 0>\\"))","$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"hh*16\\").orbit(3)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(\\"1:0.5\\")"],"longname":"duckdepth","kind":"member","scope":"global"},{"comment":"/**\\n * The time required for the ducked signal(s) to reach their lowest volume.\\n * Can be used to prevent clicking or for creative rhythmic effects.\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckonset(\\"0:0.003\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckonset\\n * @synonyms duckons\\n *\\n * @param {number | Pattern} time The onset time in seconds\\n * @example\\n * // Clicks\\n * sound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\n * duckerWithClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0).postgain(0)\\n * @example\\n * // No clicks\\n * sound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\n * duckerWithoutClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0.01).postgain(0)\\n * @example\\n * // Rhythmic\\n * noise: s(\\"pink\\").distort(\\"2:1\\").orbit(4) // used rhythmically with 0.3 onset below\\n * hhat: s(\\"hh*16\\").orbit(7)\\n * ducker: s(\\"bd*4\\").bank(\\"tr909\\").duckorbit(\\"4:7\\").duckonset(\\"0.3:0.003\\").duckattack(0.25)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":830,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The time required for the ducked signal(s) to reach their lowest volume.\\nCan be used to prevent clicking or for creative rhythmic effects.</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckonset(&quot;0:0.003&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckonset","synonyms_text":"duckons","synonyms":["duckons"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>The onset time in seconds</p>","name":"time"}],"examples":["// Clicks\\nsound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\nduckerWithClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0).postgain(0)","// No clicks\\nsound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\nduckerWithoutClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0.01).postgain(0)","// Rhythmic\\nnoise: s(\\"pink\\").distort(\\"2:1\\").orbit(4) // used rhythmically with 0.3 onset below\\nhhat: s(\\"hh*16\\").orbit(7)\\nducker: s(\\"bd*4\\").bank(\\"tr909\\").duckorbit(\\"4:7\\").duckonset(\\"0.3:0.003\\").duckattack(0.25)"],"longname":"duckonset","kind":"member","scope":"global"},{"comment":"/**\\n * The time required for the ducked signal(s) to return to their normal volume.\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckonset(\\"0:0.003\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckattack\\n * @synonyms duckatt\\n *\\n * @param {number | Pattern} time The attack time in seconds\\n * @example\\n * sound: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * ducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(\\"<0.2 0 0.4>\\").duckdepth(1)\\n * @example\\n * moreduck: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * lessduck: s(\\"hh*16\\").orbit(5)\\n * ducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:5\\").duckattack(\\"0.4:0.1\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":858,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The time required for the ducked signal(s) to return to their normal volume.</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckonset(&quot;0:0.003&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckattack","synonyms_text":"duckatt","synonyms":["duckatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>The attack time in seconds</p>","name":"time"}],"examples":["sound: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\nducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(\\"<0.2 0 0.4>\\").duckdepth(1)","moreduck: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\nlessduck: s(\\"hh*16\\").orbit(5)\\nducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:5\\").duckattack(\\"0.4:0.1\\")"],"longname":"duckattack","kind":"member","scope":"global"},{"comment":"/**\\n * Create byte beats with custom expressions\\n *\\n * @name byteBeatExpression\\n * @synonyms bbexpr\\n *\\n * @param {number | Pattern} byteBeatExpression bitwise expression for creating bytebeat\\n * @example\\n * s(\\"bytebeat\\").bbexpr('t*(t>>15^t>>66)')\\n *\\n */","meta":{"filename":"controls.mjs","lineno":879,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Create byte beats with custom expressions</p>","name":"byteBeatExpression","synonyms_text":"bbexpr","synonyms":["bbexpr"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>bitwise expression for creating bytebeat</p>","name":"byteBeatExpression"}],"examples":["s(\\"bytebeat\\").bbexpr('t*(t>>15^t>>66)')"],"longname":"byteBeatExpression","kind":"member","scope":"global"},{"comment":"/**\\n * Create byte beats with custom expressions\\n *\\n * @name byteBeatStartTime\\n * @synonyms bbst\\n *\\n * @param {number | Pattern} byteBeatStartTime in samples (t)\\n * @example\\n * note(\\"c3!8\\".add(\\"{0 0 12 0 7 5 3}%8\\")).s(\\"bytebeat:5\\").bbst(\\"<3 1>\\".mul(10000))._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":892,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Create byte beats with custom expressions</p>","name":"byteBeatStartTime","synonyms_text":"bbst","synonyms":["bbst"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>in samples (t)</p>","name":"byteBeatStartTime"}],"examples":["note(\\"c3!8\\".add(\\"{0 0 12 0 7 5 3}%8\\")).s(\\"bytebeat:5\\").bbst(\\"<3 1>\\".mul(10000))._scope()"],"longname":"byteBeatStartTime","kind":"member","scope":"global"},{"comment":"/**\\n * Allows you to set the output channels on the interface\\n *\\n * @name channels\\n * @synonyms ch\\n *\\n * @param {number | Pattern} channels pattern the output channels\\n * @example\\n * note(\\"e a d b g\\").channels(\\"3:4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":905,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows you to set the output channels on the interface</p>","name":"channels","synonyms_text":"ch","synonyms":["ch"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>pattern the output channels</p>","name":"channels"}],"examples":["note(\\"e a d b g\\").channels(\\"3:4\\")"],"longname":"channels","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the pulsewidth of the pulse oscillator\\n *\\n * @name pw\\n * @param {number | Pattern} pulsewidth\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"pulse\\").pw(\\".8:1:.2\\")\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0 .75 .5 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":918,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the pulsewidth of the pulse oscillator</p>","name":"pw","params":[{"type":{"names":["number","Pattern"]},"name":"pulsewidth"}],"examples":["note(\\"{f a c e}%16\\").s(\\"pulse\\").pw(\\".8:1:.2\\")","n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0 .75 .5 1\\")"],"longname":"pw","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the lfo rate for the pulsewidth of the pulse oscillator\\n *\\n * @name pwrate\\n * @param {number | Pattern} rate\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")\\n\\n *\\n */","meta":{"filename":"controls.mjs","lineno":930,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the lfo rate for the pulsewidth of the pulse oscillator</p>","name":"pwrate","params":[{"type":{"names":["number","Pattern"]},"name":"rate"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")"],"longname":"pwrate","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the lfo sweep for the pulsewidth of the pulse oscillator\\n *\\n * @name pwsweep\\n * @param {number | Pattern} sweep\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":942,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the lfo sweep for the pulsewidth of the pulse oscillator</p>","name":"pwsweep","params":[{"type":{"names":["number","Pattern"]},"name":"sweep"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")"],"longname":"pwsweep","kind":"member","scope":"global"},{"comment":"/**\\n * Phaser audio effect that approximates popular guitar pedals.\\n *\\n * @name phaser\\n * @synonyms ph\\n * @param {number | Pattern} speed speed of modulation\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(\\"<1 2 4 8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":953,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Phaser audio effect that approximates popular guitar pedals.</p>","name":"phaser","synonyms_text":"ph","synonyms":["ph"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>speed of modulation</p>","name":"speed"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(\\"<1 2 4 8>\\")"],"longname":"phaser","kind":"member","scope":"global"},{"comment":"/**\\n * The frequency sweep range of the lfo for the phaser effect. Defaults to 2000\\n *\\n * @name phasersweep\\n * @synonyms phs\\n * @param {number | Pattern} phasersweep most useful values are between 0 and 4000\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phasersweep(\\"<800 2000 4000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":970,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The frequency sweep range of the lfo for the phaser effect. Defaults to 2000</p>","name":"phasersweep","synonyms_text":"phs","synonyms":["phs"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>most useful values are between 0 and 4000</p>","name":"phasersweep"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phasersweep(\\"<800 2000 4000>\\")"],"longname":"phasersweep","kind":"member","scope":"global"},{"comment":"/**\\n * The center frequency of the phaser in HZ. Defaults to 1000\\n *\\n * @name phasercenter\\n * @synonyms phc\\n * @param {number | Pattern} centerfrequency in HZ\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phasercenter(\\"<800 2000 4000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":983,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The center frequency of the phaser in HZ. Defaults to 1000</p>","name":"phasercenter","synonyms_text":"phc","synonyms":["phc"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>in HZ</p>","name":"centerfrequency"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phasercenter(\\"<800 2000 4000>\\")"],"longname":"phasercenter","kind":"member","scope":"global"},{"comment":"/**\\n * The amount the signal is affected by the phaser effect. Defaults to 0.75\\n *\\n * @name phaserdepth\\n * @synonyms phd, phasdp\\n * @param {number | Pattern} depth number between 0 and 1\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phaserdepth(\\"<0 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":997,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The amount the signal is affected by the phaser effect. Defaults to 0.75</p>","name":"phaserdepth","synonyms_text":"phd, phasdp","synonyms":["phd","phasdp"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>number between 0 and 1</p>","name":"depth"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phaserdepth(\\"<0 .5 .75 1>\\")"],"longname":"phaserdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Choose the channel the pattern is sent to in superdirt\\n *\\n * @name channel\\n * @param {number | Pattern} channel channel number\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1011,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Choose the channel the pattern is sent to in superdirt</p>","name":"channel","params":[{"type":{"names":["number","Pattern"]},"description":"<p>channel number</p>","name":"channel"}],"longname":"channel","kind":"member","scope":"global"},{"comment":"/**\\n * In the style of classic drum-machines, \`cut\` will stop a playing sample as soon as another samples with in same cutgroup is to be played. An example would be an open hi-hat followed by a closed one, essentially muting the open.\\n *\\n * @name cut\\n * @param {number | Pattern} group cut group number\\n * @example\\n * s(\\"[oh hh]*4\\").cut(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1019,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>In the style of classic drum-machines, <code>cut</code> will stop a playing sample as soon as another samples with in same cutgroup is to be played. An example would be an open hi-hat followed by a closed one, essentially muting the open.</p>","name":"cut","params":[{"type":{"names":["number","Pattern"]},"description":"<p>cut group number</p>","name":"group"}],"examples":["s(\\"[oh hh]*4\\").cut(1)"],"longname":"cut","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the cutoff frequency of the **l**ow-**p**ass **f**ilter.\\n *\\n * When using mininotation, you can also optionally add the 'lpq' parameter, separated by ':'.\\n *\\n * @name lpf\\n * @param {number | Pattern} frequency audible between 0 and 20000\\n * @synonyms cutoff, ctf, lp\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").lpf(\\"<4000 2000 1000 500 200 100>\\")\\n * @example\\n * s(\\"bd*16\\").lpf(\\"1000:0 1000:10 1000:20 1000:30\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1029,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the cutoff frequency of the <strong>l</strong>ow-<strong>p</strong>ass <strong>f</strong>ilter.</p>\\n<p>When using mininotation, you can also optionally add the 'lpq' parameter, separated by ':'.</p>","name":"lpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>audible between 0 and 20000</p>","name":"frequency"}],"synonyms_text":"cutoff, ctf, lp","synonyms":["cutoff","ctf","lp"],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").lpf(\\"<4000 2000 1000 500 200 100>\\")","s(\\"bd*16\\").lpf(\\"1000:0 1000:10 1000:20 1000:30\\")"],"longname":"lpf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the lowpass filter envelope modulation depth.\\n * @name lpenv\\n * @param {number | Pattern} modulation depth of the lowpass filter envelope between 0 and _n_\\n * @synonyms lpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpa(.5)\\n * .lpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1045,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the lowpass filter envelope modulation depth.</p>","name":"lpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the lowpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"lpe","synonyms":["lpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpa(.5)\\n.lpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"lpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the highpass filter envelope modulation depth.\\n * @name hpenv\\n * @param {number | Pattern} modulation depth of the highpass filter envelope between 0 and _n_\\n * @synonyms hpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpa(.5)\\n * .hpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1058,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the highpass filter envelope modulation depth.</p>","name":"hpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the highpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"hpe","synonyms":["hpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpa(.5)\\n.hpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"hpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the bandpass filter envelope modulation depth.\\n * @name bpenv\\n * @param {number | Pattern} modulation depth of the bandpass filter envelope between 0 and _n_\\n * @synonyms bpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpa(.5)\\n * .bpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1071,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the bandpass filter envelope modulation depth.</p>","name":"bpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the bandpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"bpe","synonyms":["bpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpa(.5)\\n.bpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"bpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the lowpass filter envelope.\\n * @name lpattack\\n * @param {number | Pattern} attack time of the filter envelope\\n * @synonyms lpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpa(\\"<.5 .25 .1 .01>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1084,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the lowpass filter envelope.</p>","name":"lpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"attack"}],"synonyms_text":"lpa","synonyms":["lpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpa(\\"<.5 .25 .1 .01>/4\\")\\n.lpenv(4)"],"longname":"lpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the highpass filter envelope.\\n * @name hpattack\\n * @param {number | Pattern} attack time of the highpass filter envelope\\n * @synonyms hpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpa(\\"<.5 .25 .1 .01>/4\\")\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1097,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the highpass filter envelope.</p>","name":"hpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"attack"}],"synonyms_text":"hpa","synonyms":["hpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpa(\\"<.5 .25 .1 .01>/4\\")\\n.hpenv(4)"],"longname":"hpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the bandpass filter envelope.\\n * @name bpattack\\n * @param {number | Pattern} attack time of the bandpass filter envelope\\n * @synonyms bpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpa(\\"<.5 .25 .1 .01>/4\\")\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1110,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the bandpass filter envelope.</p>","name":"bpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"attack"}],"synonyms_text":"bpa","synonyms":["bpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpa(\\"<.5 .25 .1 .01>/4\\")\\n.bpenv(4)"],"longname":"bpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the lowpass filter envelope.\\n * @name lpdecay\\n * @param {number | Pattern} decay time of the filter envelope\\n * @synonyms lpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpd(\\"<.5 .25 .1 0>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1123,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the lowpass filter envelope.</p>","name":"lpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"decay"}],"synonyms_text":"lpd","synonyms":["lpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpd(\\"<.5 .25 .1 0>/4\\")\\n.lpenv(4)"],"longname":"lpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the highpass filter envelope.\\n * @name hpdecay\\n * @param {number | Pattern} decay time of the highpass filter envelope\\n * @synonyms hpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpd(\\"<.5 .25 .1 0>/4\\")\\n * .hps(0.2)\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1136,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the highpass filter envelope.</p>","name":"hpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"decay"}],"synonyms_text":"hpd","synonyms":["hpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpd(\\"<.5 .25 .1 0>/4\\")\\n.hps(0.2)\\n.hpenv(4)"],"longname":"hpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the bandpass filter envelope.\\n * @name bpdecay\\n * @param {number | Pattern} decay time of the bandpass filter envelope\\n * @synonyms bpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpd(\\"<.5 .25 .1 0>/4\\")\\n * .bps(0.2)\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1150,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the bandpass filter envelope.</p>","name":"bpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"decay"}],"synonyms_text":"bpd","synonyms":["bpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpd(\\"<.5 .25 .1 0>/4\\")\\n.bps(0.2)\\n.bpenv(4)"],"longname":"bpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the lowpass filter envelope.\\n * @name lpsustain\\n * @param {number | Pattern} sustain amplitude of the lowpass filter envelope\\n * @synonyms lps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpd(.5)\\n * .lps(\\"<0 .25 .5 1>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1164,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the lowpass filter envelope.</p>","name":"lpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the lowpass filter envelope</p>","name":"sustain"}],"synonyms_text":"lps","synonyms":["lps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpd(.5)\\n.lps(\\"<0 .25 .5 1>/4\\")\\n.lpenv(4)"],"longname":"lpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the highpass filter envelope.\\n * @name hpsustain\\n * @param {number | Pattern} sustain amplitude of the highpass filter envelope\\n * @synonyms hps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpd(.5)\\n * .hps(\\"<0 .25 .5 1>/4\\")\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1178,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the highpass filter envelope.</p>","name":"hpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the highpass filter envelope</p>","name":"sustain"}],"synonyms_text":"hps","synonyms":["hps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpd(.5)\\n.hps(\\"<0 .25 .5 1>/4\\")\\n.hpenv(4)"],"longname":"hpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the bandpass filter envelope.\\n * @name bpsustain\\n * @param {number | Pattern} sustain amplitude of the bandpass filter envelope\\n * @synonyms bps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpd(.5)\\n * .bps(\\"<0 .25 .5 1>/4\\")\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1192,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the bandpass filter envelope.</p>","name":"bpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the bandpass filter envelope</p>","name":"sustain"}],"synonyms_text":"bps","synonyms":["bps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpd(.5)\\n.bps(\\"<0 .25 .5 1>/4\\")\\n.bpenv(4)"],"longname":"bpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the lowpass filter envelope.\\n * @name lprelease\\n * @param {number | Pattern} release time of the filter envelope\\n * @synonyms lpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .lpf(300)\\n * .lpenv(4)\\n * .lpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1206,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the lowpass filter envelope.</p>","name":"lprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"release"}],"synonyms_text":"lpr","synonyms":["lpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.lpf(300)\\n.lpenv(4)\\n.lpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"lprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the highpass filter envelope.\\n * @name hprelease\\n * @param {number | Pattern} release time of the highpass filter envelope\\n * @synonyms hpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .hpf(500)\\n * .hpenv(4)\\n * .hpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1221,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the highpass filter envelope.</p>","name":"hprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"release"}],"synonyms_text":"hpr","synonyms":["hpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.hpf(500)\\n.hpenv(4)\\n.hpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"hprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the bandpass filter envelope.\\n * @name bprelease\\n * @param {number | Pattern} release time of the bandpass filter envelope\\n * @synonyms bpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .bpf(500)\\n * .bpenv(4)\\n * .bpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1236,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the bandpass filter envelope.</p>","name":"bprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"release"}],"synonyms_text":"bpr","synonyms":["bpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.bpf(500)\\n.bpenv(4)\\n.bpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"bprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the filter type. The ladder filter is more aggressive. More types might be added in the future.\\n * @name ftype\\n * @param {number | Pattern} type 12db (0), ladder (1), or 24db (2)\\n * @example\\n * note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpenv(4).lpf(500).ftype(\\"<0 1 2>\\").lpq(1)\\n * @example\\n * note(\\"c f g g a c d4\\").fast(2)\\n * .sound('sawtooth')\\n * .lpf(200).fanchor(0)\\n * .lpenv(3).lpq(1)\\n * .ftype(\\"<ladder 12db 24db>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1251,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the filter type. The ladder filter is more aggressive. More types might be added in the future.</p>","name":"ftype","params":[{"type":{"names":["number","Pattern"]},"description":"<p>12db (0), ladder (1), or 24db (2)</p>","name":"type"}],"examples":["note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpenv(4).lpf(500).ftype(\\"<0 1 2>\\").lpq(1)","note(\\"c f g g a c d4\\").fast(2)\\n.sound('sawtooth')\\n.lpf(200).fanchor(0)\\n.lpenv(3).lpq(1)\\n.ftype(\\"<ladder 12db 24db>\\")"],"longname":"ftype","kind":"member","scope":"global"},{"comment":"/**\\n * controls the center of the filter envelope. 0 is unipolar positive, .5 is bipolar, 1 is unipolar negative\\n * @name fanchor\\n * @param {number | Pattern} center 0 to 1\\n * @example\\n * note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpf(\\"{1000}%2\\")\\n * .lpenv(8).fanchor(\\"<0 .5 1>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1266,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>controls the center of the filter envelope. 0 is unipolar positive, .5 is bipolar, 1 is unipolar negative</p>","name":"fanchor","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 to 1</p>","name":"center"}],"examples":["note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpf(\\"{1000}%2\\")\\n.lpenv(8).fanchor(\\"<0 .5 1>\\")"],"longname":"fanchor","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the cutoff frequency of the **h**igh-**p**ass **f**ilter.\\n *\\n * When using mininotation, you can also optionally add the 'hpq' parameter, separated by ':'.\\n *\\n * @name hpf\\n * @param {number | Pattern} frequency audible between 0 and 20000\\n * @synonyms hp, hcutoff\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<4000 2000 1000 500 200 100>\\")\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<2000 2000:25>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1275,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the cutoff frequency of the <strong>h</strong>igh-<strong>p</strong>ass <strong>f</strong>ilter.</p>\\n<p>When using mininotation, you can also optionally add the 'hpq' parameter, separated by ':'.</p>","name":"hpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>audible between 0 and 20000</p>","name":"frequency"}],"synonyms_text":"hp, hcutoff","synonyms":["hp","hcutoff"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<4000 2000 1000 500 200 100>\\")","s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<2000 2000:25>\\")"],"longname":"hpf","kind":"member","scope":"global"},{"comment":"/**\\n * Applies a vibrato to the frequency of the oscillator.\\n *\\n * @name vib\\n * @synonyms vibrato, v\\n * @param {number | Pattern} frequency of the vibrato in hertz\\n * @example\\n * note(\\"a e\\")\\n * .vib(\\"<.5 1 2 4 8 16>\\")\\n * ._scope()\\n * @example\\n * // change the modulation depth with \\":\\"\\n * note(\\"a e\\")\\n * .vib(\\"<.5 1 2 4 8 16>:12\\")\\n * ._scope()\\n */","meta":{"filename":"controls.mjs","lineno":1291,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies a vibrato to the frequency of the oscillator.</p>","name":"vib","synonyms_text":"vibrato, v","synonyms":["vibrato","v"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>of the vibrato in hertz</p>","name":"frequency"}],"examples":["note(\\"a e\\")\\n.vib(\\"<.5 1 2 4 8 16>\\")\\n._scope()","// change the modulation depth with \\":\\"\\nnote(\\"a e\\")\\n.vib(\\"<.5 1 2 4 8 16>:12\\")\\n._scope()"],"longname":"vib","kind":"member","scope":"global"},{"comment":"/**\\n * Adds pink noise to the mix\\n *\\n * @name noise\\n * @param {number | Pattern} wet wet amount\\n * @example\\n * sound(\\"<white pink brown>/2\\")\\n */","meta":{"filename":"controls.mjs","lineno":1308,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Adds pink noise to the mix</p>","name":"noise","params":[{"type":{"names":["number","Pattern"]},"description":"<p>wet amount</p>","name":"wet"}],"examples":["sound(\\"<white pink brown>/2\\")"],"longname":"noise","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the vibrato depth in semitones. Only has an effect if \`vibrato\` | \`vib\` | \`v\` is is also set\\n *\\n * @name vibmod\\n * @synonyms vmod\\n * @param {number | Pattern} depth of vibrato (in semitones)\\n * @example\\n * note(\\"a e\\").vib(4)\\n * .vibmod(\\"<.25 .5 1 2 12>\\")\\n * ._scope()\\n * @example\\n * // change the vibrato frequency with \\":\\"\\n * note(\\"a e\\")\\n * .vibmod(\\"<.25 .5 1 2 12>:8\\")\\n * ._scope()\\n */","meta":{"filename":"controls.mjs","lineno":1317,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the vibrato depth in semitones. Only has an effect if <code>vibrato</code> | <code>vib</code> | <code>v</code> is is also set</p>","name":"vibmod","synonyms_text":"vmod","synonyms":["vmod"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>of vibrato (in semitones)</p>","name":"depth"}],"examples":["note(\\"a e\\").vib(4)\\n.vibmod(\\"<.25 .5 1 2 12>\\")\\n._scope()","// change the vibrato frequency with \\":\\"\\nnote(\\"a e\\")\\n.vibmod(\\"<.25 .5 1 2 12>:8\\")\\n._scope()"],"longname":"vibmod","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the **h**igh-**p**ass **q**-value.\\n *\\n * @name hpq\\n * @param {number | Pattern} q resonance factor between 0 and 50\\n * @synonyms hresonance\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(2000).hpq(\\"<0 10 20 30>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1335,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the <strong>h</strong>igh-<strong>p</strong>ass <strong>q</strong>-value.</p>","name":"hpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>resonance factor between 0 and 50</p>","name":"q"}],"synonyms_text":"hresonance","synonyms":["hresonance"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").hpf(2000).hpq(\\"<0 10 20 30>\\")"],"longname":"hpq","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the **l**ow-**p**ass **q**-value.\\n *\\n * @name lpq\\n * @param {number | Pattern} q resonance factor between 0 and 50\\n * @synonyms resonance\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").lpf(2000).lpq(\\"<0 10 20 30>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1346,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the <strong>l</strong>ow-<strong>p</strong>ass <strong>q</strong>-value.</p>","name":"lpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>resonance factor between 0 and 50</p>","name":"q"}],"synonyms_text":"resonance","synonyms":["resonance"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").lpf(2000).lpq(\\"<0 10 20 30>\\")"],"longname":"lpq","kind":"member","scope":"global"},{"comment":"/**\\n * DJ filter, below 0.5 is low pass filter, above is high pass filter.\\n *\\n * @name djf\\n * @param {number | Pattern} cutoff below 0.5 is low pass filter, above is high pass filter\\n * @example\\n * n(irand(16).seg(8)).scale(\\"d:phrygian\\").s(\\"supersaw\\").djf(\\"<.5 .3 .2 .75>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1358,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DJ filter, below 0.5 is low pass filter, above is high pass filter.</p>","name":"djf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>below 0.5 is low pass filter, above is high pass filter</p>","name":"cutoff"}],"examples":["n(irand(16).seg(8)).scale(\\"d:phrygian\\").s(\\"supersaw\\").djf(\\"<.5 .3 .2 .75>\\")"],"longname":"djf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the delay signal.\\n *\\n * When using mininotation, you can also optionally add the 'delaytime' and 'delayfeedback' parameter,\\n * separated by ':'.\\n *\\n *\\n * @name delay\\n * @param {number | Pattern} level between 0 and 1\\n * @example\\n * s(\\"bd bd\\").delay(\\"<0 .25 .5 1>\\")\\n * @example\\n * s(\\"bd bd\\").delay(\\"0.65:0.25:0.9 0.65:0.125:0.7\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1370,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the delay signal.</p>\\n<p>When using mininotation, you can also optionally add the 'delaytime' and 'delayfeedback' parameter,\\nseparated by ':'.</p>","name":"delay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"level"}],"examples":["s(\\"bd bd\\").delay(\\"<0 .25 .5 1>\\")","s(\\"bd bd\\").delay(\\"0.65:0.25:0.9 0.65:0.125:0.7\\")"],"longname":"delay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the signal that is fed back into the delay.\\n * Caution: Values >= 1 will result in a signal that gets louder and louder! Don't do it\\n *\\n * @name delayfeedback\\n * @param {number | Pattern} feedback between 0 and 1\\n * @synonyms delayfb, dfb\\n * @example\\n * s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the signal that is fed back into the delay.\\nCaution: Values &gt;= 1 will result in a signal that gets louder and louder! Don't do it</p>","name":"delayfeedback","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"feedback"}],"synonyms_text":"delayfb, dfb","synonyms":["delayfb","dfb"],"examples":["s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")"],"longname":"delayfeedback","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the signal that is fed back into the delay.\\n * Caution: Values >= 1 will result in a signal that gets louder and louder! Don't do it\\n *\\n * @name delayfeedback\\n * @param {number | Pattern} feedback between 0 and 1\\n * @synonyms delayfb, dfb\\n * @example\\n * s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1399,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the signal that is fed back into the delay.\\nCaution: Values &gt;= 1 will result in a signal that gets louder and louder! Don't do it</p>","name":"delayfeedback","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"feedback"}],"synonyms_text":"delayfb, dfb","synonyms":["delayfb","dfb"],"examples":["s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")"],"longname":"delayfeedback","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the time of the delay effect.\\n *\\n * @name delayspeed\\n * @param {number | Pattern} delayspeed controls the pitch of the delay feedback\\n * @synonyms delayt, dt\\n * @example\\n * note(\\"d d a# a\\".fast(2)).s(\\"sawtooth\\").delay(.8).delaytime(1/2).delayspeed(\\"<2 .5 -1 -2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1411,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the time of the delay effect.</p>","name":"delayspeed","params":[{"type":{"names":["number","Pattern"]},"description":"<p>controls the pitch of the delay feedback</p>","name":"delayspeed"}],"synonyms_text":"delayt, dt","synonyms":["delayt","dt"],"examples":["note(\\"d d a# a\\".fast(2)).s(\\"sawtooth\\").delay(.8).delaytime(1/2).delayspeed(\\"<2 .5 -1 -2>\\")"],"longname":"delayspeed","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the time of the delay effect in cycles.\\n *\\n * @name delaysync\\n * @param {number | Pattern} cycles delay length in cycles\\n * @synonyms delayt, dt\\n * @example\\n * s(\\"bd bd\\").delay(.25).delaysync(\\"<1 2 3 5>\\".div(8))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1423,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the time of the delay effect in cycles.</p>","name":"delaysync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>delay length in cycles</p>","name":"cycles"}],"synonyms_text":"delayt, dt","synonyms":["delayt","dt"],"examples":["s(\\"bd bd\\").delay(.25).delaysync(\\"<1 2 3 5>\\".div(8))"],"longname":"delaysync","kind":"member","scope":"global"},{"comment":"/**\\n * Specifies whether delaytime is calculated relative to cps.\\n *\\n * @name lock\\n * @param {number | Pattern} enable When set to 1, delaytime is a direct multiple of a cycle.\\n * @superdirtOnly\\n * @example\\n * s(\\"sd\\").delay().lock(1).osc()\\n *\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1435,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Specifies whether delaytime is calculated relative to cps.</p>","name":"lock","params":[{"type":{"names":["number","Pattern"]},"description":"<p>When set to 1, delaytime is a direct multiple of a cycle.</p>","name":"enable"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"sd\\").delay().lock(1).osc()"],"longname":"lock","kind":"member","scope":"global"},{"comment":"/**\\n * Set detune for stacked voices of supported oscillators\\n *\\n * @name detune\\n * @param {number | Pattern} amount\\n * @synonyms det\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").detune(\\"<.1 .2 .5 24.1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set detune for stacked voices of supported oscillators</p>","name":"detune","params":[{"type":{"names":["number","Pattern"]},"name":"amount"}],"synonyms_text":"det","synonyms":["det"],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").detune(\\"<.1 .2 .5 24.1>\\")"],"longname":"detune","kind":"member","scope":"global"},{"comment":"/**\\n * Set number of stacked voices for supported oscillators\\n *\\n * @name unison\\n * @param {number | Pattern} numvoices\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").unison(\\"<1 2 7>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1459,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set number of stacked voices for supported oscillators</p>","name":"unison","params":[{"type":{"names":["number","Pattern"]},"name":"numvoices"}],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").unison(\\"<1 2 7>\\")"],"longname":"unison","kind":"member","scope":"global"},{"comment":"/**\\n * Set the stereo pan spread for supported oscillators\\n *\\n * @name spread\\n * @param {number | Pattern} spread between 0 and 1\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").spread(\\"<0 .3 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1470,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set the stereo pan spread for supported oscillators</p>","name":"spread","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"spread"}],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").spread(\\"<0 .3 1>\\")"],"longname":"spread","kind":"member","scope":"global"},{"comment":"/**\\n * Set dryness of reverb. See \`room\` and \`size\` for more information about reverb.\\n *\\n * @name dry\\n * @param {number | Pattern} dry 0 = wet, 1 = dry\\n * @example\\n * n(\\"[0,3,7](3,8)\\").s(\\"superpiano\\").room(.7).dry(\\"<0 .5 .75 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1480,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set dryness of reverb. See <code>room</code> and <code>size</code> for more information about reverb.</p>","name":"dry","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 = wet, 1 = dry</p>","name":"dry"}],"examples":["n(\\"[0,3,7](3,8)\\").s(\\"superpiano\\").room(.7).dry(\\"<0 .5 .75 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"dry","kind":"member","scope":"global"},{"comment":"/**\\n * Set frequency of sound.\\n *\\n * @name freq\\n * @param {number | Pattern} frequency in Hz. the audible range is between 20 and 20000 Hz\\n * @example\\n * freq(\\"220 110 440 110\\").s(\\"superzow\\").osc()\\n * @example\\n * freq(\\"110\\".mul.out(\\".5 1.5 .6 [2 3]\\")).s(\\"superzow\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1505,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set frequency of sound.</p>","name":"freq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>in Hz. the audible range is between 20 and 20000 Hz</p>","name":"frequency"}],"examples":["freq(\\"220 110 440 110\\").s(\\"superzow\\").osc()","freq(\\"110\\".mul.out(\\".5 1.5 .6 [2 3]\\")).s(\\"superzow\\").osc()"],"longname":"freq","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of pitch envelope.\\n *\\n * @name pattack\\n * @synonyms patt\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"c eb g bb\\").pattack(\\"0 .1 .25 .5\\").slow(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1518,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of pitch envelope.</p>","name":"pattack","synonyms_text":"patt","synonyms":["patt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"c eb g bb\\").pattack(\\"0 .1 .25 .5\\").slow(2)"],"longname":"pattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of pitch envelope.\\n *\\n * @name pdecay\\n * @synonyms pdec\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"<c eb g bb>\\").pdecay(\\"<0 .1 .25 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1529,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of pitch envelope.</p>","name":"pdecay","synonyms_text":"pdec","synonyms":["pdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"<c eb g bb>\\").pdecay(\\"<0 .1 .25 .5>\\")"],"longname":"pdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of pitch envelope\\n *\\n * @name prelease\\n * @synonyms prel\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"<c eb g bb> ~\\")\\n * .release(.5) // to hear the pitch release\\n * .prelease(\\"<0 .1 .25 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1542,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of pitch envelope</p>","name":"prelease","synonyms_text":"prel","synonyms":["prel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"<c eb g bb> ~\\")\\n.release(.5) // to hear the pitch release\\n.prelease(\\"<0 .1 .25 .5>\\")"],"longname":"prelease","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of pitch envelope. Negative values will flip the envelope.\\n * If you don't set other pitch envelope controls, \`pattack:.2\` will be the default.\\n *\\n * @name penv\\n * @param {number | Pattern} semitones change in semitones\\n * @example\\n * note(\\"c\\")\\n * .penv(\\"<12 7 1 .5 0 -1 -7 -12>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1555,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of pitch envelope. Negative values will flip the envelope.\\nIf you don't set other pitch envelope controls, <code>pattack:.2</code> will be the default.</p>","name":"penv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>change in semitones</p>","name":"semitones"}],"examples":["note(\\"c\\")\\n.penv(\\"<12 7 1 .5 0 -1 -7 -12>\\")"],"longname":"penv","kind":"member","scope":"global"},{"comment":"/**\\n * Curve of envelope. Defaults to linear. exponential is good for kicks\\n *\\n * @name pcurve\\n * @param {number | Pattern} type 0 = linear, 1 = exponential\\n * @example\\n * note(\\"g1*4\\")\\n * .s(\\"sine\\").pdec(.5)\\n * .penv(32)\\n * .pcurve(\\"<0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1567,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Curve of envelope. Defaults to linear. exponential is good for kicks</p>","name":"pcurve","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 = linear, 1 = exponential</p>","name":"type"}],"examples":["note(\\"g1*4\\")\\n.s(\\"sine\\").pdec(.5)\\n.penv(32)\\n.pcurve(\\"<0 1>\\")"],"longname":"pcurve","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the range anchor of the envelope:\\n * - anchor 0: range = [note, note + penv]\\n * - anchor 1: range = [note - penv, note]\\n * If you don't set an anchor, the value will default to the psustain value.\\n *\\n * @name panchor\\n * @param {number | Pattern} anchor anchor offset\\n * @example\\n * note(\\"c c4\\").penv(12).panchor(\\"<0 .5 1 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1580,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the range anchor of the envelope:</p>\\n<ul>\\n<li>anchor 0: range = [note, note + penv]</li>\\n<li>anchor 1: range = [note - penv, note]\\nIf you don't set an anchor, the value will default to the psustain value.</li>\\n</ul>","name":"panchor","params":[{"type":{"names":["number","Pattern"]},"description":"<p>anchor offset</p>","name":"anchor"}],"examples":["note(\\"c c4\\").penv(12).panchor(\\"<0 .5 1 .5>\\")"],"longname":"panchor","kind":"member","scope":"global"},{"comment":"/**\\n * Emulation of a Leslie speaker: speakers rotating in a wooden amplified cabinet.\\n *\\n * @name leslie\\n * @param {number | Pattern} wet between 0 and 1\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(\\"<0 .4 .6 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1604,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Emulation of a Leslie speaker: speakers rotating in a wooden amplified cabinet.</p>","name":"leslie","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"wet"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(\\"<0 .4 .6 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"leslie","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of modulation / rotation for leslie effect\\n *\\n * @name lrate\\n * @param {number | Pattern} rate 6.7 for fast, 0.7 for slow\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(\\"<1 2 4 8>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1615,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of modulation / rotation for leslie effect</p>","name":"lrate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>6.7 for fast, 0.7 for slow</p>","name":"rate"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(\\"<1 2 4 8>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"lrate","kind":"member","scope":"global"},{"comment":"/**\\n * Physical size of the cabinet in meters. Be careful, it might be slightly larger than your computer. Affects the Doppler amount (pitch warble)\\n *\\n * @name lsize\\n * @param {number | Pattern} meters somewhere between 0 and 1\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(2).lsize(\\"<.1 .5 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1627,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Physical size of the cabinet in meters. Be careful, it might be slightly larger than your computer. Affects the Doppler amount (pitch warble)</p>","name":"lsize","params":[{"type":{"names":["number","Pattern"]},"description":"<p>somewhere between 0 and 1</p>","name":"meters"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(2).lsize(\\"<.1 .5 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"lsize","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the displayed text for an event on the pianoroll\\n *\\n * @name label\\n * @param {string} label text to display\\n */","meta":{"filename":"controls.mjs","lineno":1638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the displayed text for an event on the pianoroll</p>","name":"label","params":[{"type":{"names":["string"]},"description":"<p>text to display</p>","name":"label"}],"longname":"label","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the default octave of a synth.\\n *\\n * @name octave\\n * @param {number | Pattern} octave octave number\\n * @example\\n * n(\\"0,4,7\\").s('supersquare').octave(\\"<3 4 5 6>\\").osc()\\n * @superDirtOnly\\n */","meta":{"filename":"controls.mjs","lineno":1674,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the default octave of a synth.</p>","name":"octave","params":[{"type":{"names":["number","Pattern"]},"description":"<p>octave number</p>","name":"octave"}],"examples":["n(\\"0,4,7\\").s('supersquare').octave(\\"<3 4 5 6>\\").osc()"],"tags":[{"originalTitle":"superDirtOnly","title":"superdirtonly","text":""}],"longname":"octave","kind":"member","scope":"global"},{"comment":"/**\\n * An \`orbit\` is a global parameter context for patterns. Patterns with the same orbit will share the same global effects.\\n *\\n * @name orbit\\n * @param {number | Pattern} number\\n * @example\\n * stack(\\n *   s(\\"hh*6\\").delay(.5).delaytime(.25).orbit(1),\\n *   s(\\"~ sd ~ sd\\").delay(.5).delaytime(.125).orbit(2)\\n * )\\n */","meta":{"filename":"controls.mjs","lineno":1687,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>An <code>orbit</code> is a global parameter context for patterns. Patterns with the same orbit will share the same global effects.</p>","name":"orbit","params":[{"type":{"names":["number","Pattern"]},"name":"number"}],"examples":["stack(\\n  s(\\"hh*6\\").delay(.5).delaytime(.25).orbit(1),\\n  s(\\"~ sd ~ sd\\").delay(.5).delaytime(.125).orbit(2)\\n)"],"longname":"orbit","kind":"member","scope":"global"},{"comment":"/**\\n * Sets position in stereo.\\n *\\n * @name pan\\n * @param {number | Pattern} pan between 0 and 1, from left to right (assuming stereo), once round a circle (assuming multichannel)\\n * @example\\n * s(\\"[bd hh]*2\\").pan(\\"<.5 1 .5 0>\\")\\n * @example\\n * s(\\"bd rim sd rim bd ~ cp rim\\").pan(sine.slow(2))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1703,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets position in stereo.</p>","name":"pan","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, from left to right (assuming stereo), once round a circle (assuming multichannel)</p>","name":"pan"}],"examples":["s(\\"[bd hh]*2\\").pan(\\"<.5 1 .5 0>\\")","s(\\"bd rim sd rim bd ~ cp rim\\").pan(sine.slow(2))"],"longname":"pan","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of reverb.\\n *\\n * When using mininotation, you can also optionally add the 'size' parameter, separated by ':'.\\n *\\n * @name room\\n * @param {number | Pattern} level between 0 and 1\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(\\"<0 .2 .4 .6 .8 1>\\")\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(\\"<0.9:1 0.9:4>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1766,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of reverb.</p>\\n<p>When using mininotation, you can also optionally add the 'size' parameter, separated by ':'.</p>","name":"room","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"level"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(\\"<0 .2 .4 .6 .8 1>\\")","s(\\"bd sd [~ bd] sd\\").room(\\"<0.9:1 0.9:4>\\")"],"longname":"room","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb lowpass starting frequency (in hertz).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomlp\\n * @synonyms rlp\\n * @param {number} frequency between 0 and 20000hz\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000)\\n */","meta":{"filename":"controls.mjs","lineno":1780,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb lowpass starting frequency (in hertz).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomlp","synonyms_text":"rlp","synonyms":["rlp"],"params":[{"type":{"names":["number"]},"description":"<p>between 0 and 20000hz</p>","name":"frequency"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000)"],"longname":"roomlp","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb lowpass frequency at -60dB (in hertz).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomdim\\n * @synonyms rdim\\n * @param {number} frequency between 0 and 20000hz\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rdim(8000)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rdim(400)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1793,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb lowpass frequency at -60dB (in hertz).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomdim","synonyms_text":"rdim","synonyms":["rdim"],"params":[{"type":{"names":["number"]},"description":"<p>between 0 and 20000hz</p>","name":"frequency"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rdim(8000)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rdim(400)"],"longname":"roomdim","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb fade time (in seconds).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomfade\\n * @synonyms rfade\\n * @param {number} seconds for the reverb to fade\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rfade(0.5)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rfade(4)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1807,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb fade time (in seconds).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomfade","synonyms_text":"rfade","synonyms":["rfade"],"params":[{"type":{"names":["number"]},"description":"<p>for the reverb to fade</p>","name":"seconds"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rfade(0.5)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rfade(4)"],"longname":"roomfade","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sample to use as an impulse response for the reverb.\\n * @name iresponse\\n * @param {string | Pattern} sample to use as an impulse response\\n * @synonyms ir\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).ir(\\"<shaker_large:0 shaker_large:2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1821,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sample to use as an impulse response for the reverb.</p>","name":"iresponse","params":[{"type":{"names":["string","Pattern"]},"description":"<p>to use as an impulse response</p>","name":"sample"}],"synonyms_text":"ir","synonyms":["ir"],"examples":["s(\\"bd sd [~ bd] sd\\").room(.8).ir(\\"<shaker_large:0 shaker_large:2>\\")"],"longname":"iresponse","kind":"member","scope":"global"},{"comment":"/**\\n * Sets speed of the sample for the impulse response.\\n * @name irspeed\\n * @param {string | Pattern} speed\\n * @example\\n * samples('github:switchangel/pad')\\n * $: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.2).irspeed(\\"<2 1 .5>/2\\").irbegin(.5).roomsize(.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets speed of the sample for the impulse response.</p>","name":"irspeed","params":[{"type":{"names":["string","Pattern"]},"name":"speed"}],"examples":["samples('github:switchangel/pad')\\n$: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.2).irspeed(\\"<2 1 .5>/2\\").irbegin(.5).roomsize(.5)"],"longname":"irspeed","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the beginning of the IR response sample\\n * @name irbegin\\n * @param {string | Pattern} begin between 0 and 1\\n * @synonyms ir\\n * @example\\n * samples('github:switchangel/pad')\\n * $: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.65).irspeed(\\"-2\\").irbegin(\\"<0 .5 .75>/2\\").roomsize(.6)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1843,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the beginning of the IR response sample</p>","name":"irbegin","params":[{"type":{"names":["string","Pattern"]},"description":"<p>between 0 and 1</p>","name":"begin"}],"synonyms_text":"ir","synonyms":["ir"],"examples":["samples('github:switchangel/pad')\\n$: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.65).irspeed(\\"-2\\").irbegin(\\"<0 .5 .75>/2\\").roomsize(.6)"],"longname":"irbegin","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the room size of the reverb, see \`room\`.\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomsize\\n * @param {number | Pattern} size between 0 and 10\\n * @synonyms rsize, sz, size\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).rsize(1)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).rsize(4)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1854,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the room size of the reverb, see <code>room</code>.\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomsize","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 10</p>","name":"size"}],"synonyms_text":"rsize, sz, size","synonyms":["rsize","sz","size"],"examples":["s(\\"bd sd [~ bd] sd\\").room(.8).rsize(1)","s(\\"bd sd [~ bd] sd\\").room(.8).rsize(4)"],"longname":"roomsize","kind":"member","scope":"global"},{"comment":"/**\\n * (Deprecated) Wave shaping distortion. WARNING: can suddenly get unpredictably loud.\\n * Please use distort instead, which has a more predictable response curve\\n * second option in optional array syntax (ex: \\".9:.5\\") applies a postgain to the output\\n *\\n *\\n * @name shape\\n * @param {number | Pattern} distortion between 0 and 1\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").shape(\\"<0 .2 .4 .6 .8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1875,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>(Deprecated) Wave shaping distortion. WARNING: can suddenly get unpredictably loud.\\nPlease use distort instead, which has a more predictable response curve\\nsecond option in optional array syntax (ex: &quot;.9:.5&quot;) applies a postgain to the output</p>","name":"shape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"distortion"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").shape(\\"<0 .2 .4 .6 .8>\\")"],"longname":"shape","kind":"member","scope":"global"},{"comment":"/**\\n * Wave shaping distortion. CAUTION: it can get loud.\\n * Second option in optional array syntax (ex: \\".9:.5\\") applies a postgain to the output. Third option sets the waveshaping type.\\n * Most useful values are usually between 0 and 10 (depending on source gain). If you are feeling adventurous, you can turn it up to 11 and beyond ;)\\n *\\n * @name distort\\n * @synonyms dist\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n * @param {number | string | Pattern} type type of distortion to apply\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").distort(\\"<0 2 3 10:.5>\\")\\n * @example\\n * note(\\"d1!8\\").s(\\"sine\\").penv(36).pdecay(.12).decay(.23).distort(\\"8:.4\\")\\n * @example\\n * s(\\"bd:4*4\\").bank(\\"tr808\\").distort(\\"3:0.5:diode\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1888,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wave shaping distortion. CAUTION: it can get loud.\\nSecond option in optional array syntax (ex: &quot;.9:.5&quot;) applies a postgain to the output. Third option sets the waveshaping type.\\nMost useful values are usually between 0 and 10 (depending on source gain). If you are feeling adventurous, you can turn it up to 11 and beyond ;)</p>","name":"distort","synonyms_text":"dist","synonyms":["dist"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"},{"type":{"names":["number","string","Pattern"]},"description":"<p>type of distortion to apply</p>","name":"type"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").distort(\\"<0 2 3 10:.5>\\")","note(\\"d1!8\\").s(\\"sine\\").penv(36).pdecay(.12).decay(.23).distort(\\"8:.4\\")","s(\\"bd:4*4\\").bank(\\"tr808\\").distort(\\"3:0.5:diode\\")"],"longname":"distort","kind":"member","scope":"global"},{"comment":"/**\\n * Postgain for waveshaping distortion.\\n *\\n * @name distortvol\\n * @synonyms distvol\\n * @param {number | Pattern} volume linear postgain of the distortion\\n * @example\\n * s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distortvol(0.8)\\n */","meta":{"filename":"controls.mjs","lineno":1908,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Postgain for waveshaping distortion.</p>","name":"distortvol","synonyms_text":"distvol","synonyms":["distvol"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"examples":["s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distortvol(0.8)"],"longname":"distortvol","kind":"member","scope":"global"},{"comment":"/**\\n * Type of waveshaping distortion to apply.\\n *\\n * @name distorttype\\n * @synonyms disttype\\n * @param {number | string | Pattern} type type of distortion to apply\\n * @example\\n * s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distorttype(\\"<0 1 2>\\")\\n *\\n * @example\\n * s(\\"sine\\").note(\\"F1*2\\").release(1)\\n *   .penv(24).pdecay(0.05)\\n *   .distort(rand.range(1, 8))\\n *   .distorttype(\\"<fold chebyshev scurve diode asym sinefold>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1919,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Type of waveshaping distortion to apply.</p>","name":"distorttype","synonyms_text":"disttype","synonyms":["disttype"],"params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>type of distortion to apply</p>","name":"type"}],"examples":["s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distorttype(\\"<0 1 2>\\")","s(\\"sine\\").note(\\"F1*2\\").release(1)\\n  .penv(24).pdecay(0.05)\\n  .distort(rand.range(1, 8))\\n  .distorttype(\\"<fold chebyshev scurve diode asym sinefold>\\")"],"longname":"distorttype","kind":"member","scope":"global"},{"comment":"/**\\n * Dynamics Compressor. The params are \`compressor(\\"threshold:ratio:knee:attack:release\\")\`\\n * More info [here](https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode?retiredLocale=de#instance_properties)\\n *\\n * @name compressor\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\")\\n * .compressor(\\"-20:20:10:.002:.02\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1936,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Dynamics Compressor. The params are <code>compressor(&quot;threshold:ratio:knee:attack:release&quot;)</code>\\nMore info <a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode?retiredLocale=de#instance_properties\\">here</a></p>","name":"compressor","examples":["s(\\"bd sd [~ bd] sd,hh*8\\")\\n.compressor(\\"-20:20:10:.002:.02\\")"],"longname":"compressor","kind":"member","scope":"global"},{"comment":"/**\\n * Changes the speed of sample playback, i.e. a cheap way of changing pitch.\\n *\\n * @name speed\\n * @param {number | Pattern} speed -inf to inf, negative numbers play the sample backwards.\\n * @example\\n * s(\\"bd*6\\").speed(\\"1 2 4 1 -2 -4\\")\\n * @example\\n * speed(\\"1 1.5*2 [2 1.1]\\").s(\\"piano\\").clip(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1957,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the speed of sample playback, i.e. a cheap way of changing pitch.</p>","name":"speed","params":[{"type":{"names":["number","Pattern"]},"description":"<p>inf to inf, negative numbers play the sample backwards.</p>","name":"speed"}],"examples":["s(\\"bd*6\\").speed(\\"1 2 4 1 -2 -4\\")","speed(\\"1 1.5*2 [2 1.1]\\").s(\\"piano\\").clip(1)"],"longname":"speed","kind":"member","scope":"global"},{"comment":"/**\\n * Changes the speed of sample playback, i.e. a cheap way of changing pitch.\\n *\\n * @name stretch\\n * @param {number | Pattern} factor -inf to inf, negative numbers play the sample backwards.\\n * @example\\n * s(\\"gm_flute\\").stretch(\\"1 2 .5\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1970,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the speed of sample playback, i.e. a cheap way of changing pitch.</p>","name":"stretch","params":[{"type":{"names":["number","Pattern"]},"description":"<p>inf to inf, negative numbers play the sample backwards.</p>","name":"factor"}],"examples":["s(\\"gm_flute\\").stretch(\\"1 2 .5\\")"],"longname":"stretch","kind":"member","scope":"global"},{"comment":"/**\\n * Used in conjunction with \`speed\`, accepts values of \\"r\\" (rate, default behavior), \\"c\\" (cycles), or \\"s\\" (seconds). Using \`unit \\"c\\"\` means \`speed\` will be interpreted in units of cycles, e.g. \`speed \\"1\\"\` means samples will be stretched to fill a cycle. Using \`unit \\"s\\"\` means the playback speed will be adjusted so that the duration is the number of seconds specified by \`speed\`.\\n *\\n * @name unit\\n * @param {number | string | Pattern} unit see description above\\n * @example\\n * speed(\\"1 2 .5 3\\").s(\\"bd\\").unit(\\"c\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1980,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Used in conjunction with <code>speed</code>, accepts values of &quot;r&quot; (rate, default behavior), &quot;c&quot; (cycles), or &quot;s&quot; (seconds). Using <code>unit &quot;c&quot;</code> means <code>speed</code> will be interpreted in units of cycles, e.g. <code>speed &quot;1&quot;</code> means samples will be stretched to fill a cycle. Using <code>unit &quot;s&quot;</code> means the playback speed will be adjusted so that the duration is the number of seconds specified by <code>speed</code>.</p>","name":"unit","params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>see description above</p>","name":"unit"}],"examples":["speed(\\"1 2 .5 3\\").s(\\"bd\\").unit(\\"c\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"unit","kind":"member","scope":"global"},{"comment":"/**\\n * Made by Calum Gunn. Reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter. The SuperCollider manual defines Squiz as:\\n *\\n * \\"A simplistic pitch-raising algorithm. It's not meant to sound natural; its sound is reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter, depending on the input. The algorithm works by cutting the signal into fragments (delimited by upwards-going zero-crossings) and squeezing those fragments in the time domain (i.e. simply playing them back faster than they came in), leaving silences inbetween. All the parameters apart from memlen can be modulated.\\"\\n *\\n * @name squiz\\n * @param {number | Pattern} squiz Try passing multiples of 2 to it - 2, 4, 8 etc.\\n * @example\\n * squiz(\\"2 4/2 6 [8 16]\\").s(\\"bd\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1992,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Made by Calum Gunn. Reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter. The SuperCollider manual defines Squiz as:</p>\\n<p>&quot;A simplistic pitch-raising algorithm. It's not meant to sound natural; its sound is reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter, depending on the input. The algorithm works by cutting the signal into fragments (delimited by upwards-going zero-crossings) and squeezing those fragments in the time domain (i.e. simply playing them back faster than they came in), leaving silences inbetween. All the parameters apart from memlen can be modulated.&quot;</p>","name":"squiz","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Try passing multiples of 2 to it - 2, 4, 8 etc.</p>","name":"squiz"}],"examples":["squiz(\\"2 4/2 6 [8 16]\\").s(\\"bd\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"squiz","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Formant filter to make things sound like vowels.\\n *\\n * @name vowel\\n * @param {string | Pattern} vowel You can use a e i o u ae aa oe ue y uh un en an on, corresponding to [a] [e] [i] [o] [u] [æ] [ɑ] [ø] [y] [ɯ] [ʌ] [œ̃] [ɛ̃] [ɑ̃] [ɔ̃]. Aliases: aa = å = ɑ, oe = ø = ö, y = ı, ae = æ.\\n * @example\\n * note(\\"[c2 <eb2 <g2 g1>>]*2\\").s('sawtooth')\\n * .vowel(\\"<a e i <o u>>\\")\\n * @example\\n * s(\\"bd sd mt ht bd [~ cp] ht lt\\").vowel(\\"[a|e|i|o|u]\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2017,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Formant filter to make things sound like vowels.</p>","name":"vowel","params":[{"type":{"names":["string","Pattern"]},"description":"<p>You can use a e i o u ae aa oe ue y uh un en an on, corresponding to [a] [e] [i] [o] [u] [æ] [ɑ] [ø] [y] [ɯ] [ʌ] [œ̃] [ɛ̃] [ɑ̃] [ɔ̃]. Aliases: aa = å = ɑ, oe = ø = ö, y = ı, ae = æ.</p>","name":"vowel"}],"examples":["note(\\"[c2 <eb2 <g2 g1>>]*2\\").s('sawtooth')\\n.vowel(\\"<a e i <o u>>\\")","s(\\"bd sd mt ht bd [~ cp] ht lt\\").vowel(\\"[a|e|i|o|u]\\")"],"longname":"vowel","kind":"member","scope":"global"},{"comment":"/**\\n * Noise crackle density\\n *\\n * @name density\\n * @param {number | Pattern} density between 0 and x\\n * @example\\n * s(\\"crackle*4\\").density(\\"<0.01 0.04 0.2 0.5>\\".slow(4))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2042,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Noise crackle density</p>","name":"density","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and x</p>","name":"density"}],"examples":["s(\\"crackle*4\\").density(\\"<0.01 0.04 0.2 0.5>\\".slow(4))"],"longname":"density","kind":"member","scope":"global"},{"comment":"/**\\n * Multiplies the duration with the given number. Also cuts samples off at the end if they exceed the duration.\\n *\\n * @name clip\\n * @synonyms legato\\n * @param {number | Pattern} factor >= 0\\n * @example\\n * note(\\"c a f e\\").s(\\"piano\\").clip(\\"<.5 1 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2092,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Multiplies the duration with the given number. Also cuts samples off at the end if they exceed the duration.</p>","name":"clip","synonyms_text":"legato","synonyms":["legato"],"params":[{"type":{"names":["number","Pattern"]},"description":"<blockquote>\\n<p>= 0</p>\\n</blockquote>","name":"factor"}],"examples":["note(\\"c a f e\\").s(\\"piano\\").clip(\\"<.5 1 2>\\")"],"longname":"clip","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the duration of the event in cycles. Similar to clip / legato, it also cuts samples off at the end if they exceed the duration.\\n *\\n * @name duration\\n * @synonyms dur\\n * @param {number | Pattern} seconds >= 0\\n * @example\\n * note(\\"c a f e\\").s(\\"piano\\").dur(\\"<.5 1 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2104,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the duration of the event in cycles. Similar to clip / legato, it also cuts samples off at the end if they exceed the duration.</p>","name":"duration","synonyms_text":"dur","synonyms":["dur"],"params":[{"type":{"names":["number","Pattern"]},"description":"<blockquote>\\n<p>= 0</p>\\n</blockquote>","name":"seconds"}],"examples":["note(\\"c a f e\\").s(\\"piano\\").dur(\\"<.5 1 2>\\")"],"longname":"duration","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the color of the hap in visualizations like pianoroll or highlighting.\\n * @name color\\n * @synonyms colour\\n * @param {string} color Hexadecimal or CSS color name\\n */","meta":{"filename":"controls.mjs","lineno":2133,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the color of the hap in visualizations like pianoroll or highlighting.</p>","name":"color","synonyms_text":"colour","synonyms":["colour"],"params":[{"type":{"names":["string"]},"description":"<p>Hexadecimal or CSS color name</p>","name":"color"}],"longname":"color","kind":"member","scope":"global"},{"comment":"/**\\n * ADSR envelope: Combination of Attack, Decay, Sustain, and Release.\\n *\\n * @name adsr\\n * @param {number | Pattern} time attack time in seconds\\n * @param {number | Pattern} time decay time in seconds\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n * @param {number | Pattern} time release time in seconds\\n * @example\\n * note(\\"[c3 bb2 f3 eb3]*2\\").sound(\\"sawtooth\\").lpf(600).adsr(\\".1:.1:.5:.2\\")\\n */","meta":{"filename":"controls.mjs","lineno":2146,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>ADSR envelope: Combination of Attack, Decay, Sustain, and Release.</p>","name":"adsr","params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"},{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"},{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"},{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"examples":["note(\\"[c3 bb2 f3 eb3]*2\\").sound(\\"sawtooth\\").lpf(600).adsr(\\".1:.1:.5:.2\\")"],"longname":"adsr","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI channel: Sets the MIDI channel for the event.\\n *\\n * @name midichan\\n * @param {number | Pattern} channel MIDI channel number (0-15)\\n * @example\\n * note(\\"c4\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2180,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI channel: Sets the MIDI channel for the event.</p>","name":"midichan","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI channel number (0-15)</p>","name":"channel"}],"examples":["note(\\"c4\\").midichan(1).midi()"],"longname":"midichan","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI port: Sets the MIDI port for the event.\\n *\\n * @name midiport\\n * @param {number | Pattern} port MIDI port\\n * @example\\n * note(\\"c a f e\\").midiport(\\"<0 1 2 3>\\").midi()\\n */","meta":{"filename":"controls.mjs","lineno":2192,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI port: Sets the MIDI port for the event.</p>","name":"midiport","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI port</p>","name":"port"}],"examples":["note(\\"c a f e\\").midiport(\\"<0 1 2 3>\\").midi()"],"longname":"midiport","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI command: Sends a MIDI command message.\\n *\\n * @name midicmd\\n * @param {number | Pattern} command MIDI command\\n * @example\\n * midicmd(\\"clock*48,<start stop>/2\\").midi()\\n */","meta":{"filename":"controls.mjs","lineno":2202,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI command: Sends a MIDI command message.</p>","name":"midicmd","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI command</p>","name":"command"}],"examples":["midicmd(\\"clock*48,<start stop>/2\\").midi()"],"longname":"midicmd","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control: Sends a MIDI control change message.\\n *\\n * @name control\\n * @param {number | Pattern}  MIDI control number (0-127)\\n * @param {number | Pattern}  MIDI controller value (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control: Sends a MIDI control change message.</p>","name":"control","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control number (0-127)</p>","name":"MIDI"},{"type":{"names":["number","Pattern"]},"description":"<p>controller value (0-127)</p>","name":"MIDI"}],"longname":"control","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control number: Sends a MIDI control change message.\\n *\\n * @name ccn\\n * @param {number | Pattern}  MIDI control number (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2227,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control number: Sends a MIDI control change message.</p>","name":"ccn","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control number (0-127)</p>","name":"MIDI"}],"longname":"ccn","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control value: Sends a MIDI control change message.\\n *\\n * @name ccv\\n * @param {number | Pattern}  MIDI control value (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2234,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control value: Sends a MIDI control change message.</p>","name":"ccv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control value (0-127)</p>","name":"MIDI"}],"longname":"ccv","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI NRPN non-registered parameter number: Sends a MIDI NRPN non-registered parameter number message.\\n * @name nrpnn\\n * @param {number | Pattern} nrpnn MIDI NRPN non-registered parameter number (0-127)\\n * @example\\n * note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2244,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI NRPN non-registered parameter number: Sends a MIDI NRPN non-registered parameter number message.</p>","name":"nrpnn","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI NRPN non-registered parameter number (0-127)</p>","name":"nrpnn"}],"examples":["note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()"],"longname":"nrpnn","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI NRPN non-registered parameter value: Sends a MIDI NRPN non-registered parameter value message.\\n * @name nrpv\\n * @param {number | Pattern} nrpv MIDI NRPN non-registered parameter value (0-127)\\n * @example\\n * note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2252,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI NRPN non-registered parameter value: Sends a MIDI NRPN non-registered parameter value message.</p>","name":"nrpv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI NRPN non-registered parameter value (0-127)</p>","name":"nrpv"}],"examples":["note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()"],"longname":"nrpv","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI program number: Sends a MIDI program change message.\\n *\\n * @name progNum\\n * @param {number | Pattern} program MIDI program number (0-127)\\n * @example\\n * note(\\"c4\\").progNum(10).midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2261,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI program number: Sends a MIDI program change message.</p>","name":"progNum","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI program number (0-127)</p>","name":"program"}],"examples":["note(\\"c4\\").progNum(10).midichan(1).midi()"],"longname":"progNum","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex: Sends a MIDI sysex message.\\n * @name sysex\\n * @param {number | Pattern} id Sysex ID\\n * @param {number | Pattern} data Sysex data\\n * @example\\n * note(\\"c4\\").sysex([\\"0x77\\", \\"0x01:0x02:0x03:0x04\\"]).midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex: Sends a MIDI sysex message.</p>","name":"sysex","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex ID</p>","name":"id"},{"type":{"names":["number","Pattern"]},"description":"<p>Sysex data</p>","name":"data"}],"examples":["note(\\"c4\\").sysex([\\"0x77\\", \\"0x01:0x02:0x03:0x04\\"]).midichan(1).midi()"],"longname":"sysex","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex ID: Sends a MIDI sysex identifier message.\\n * @name sysexid\\n * @param {number | Pattern} id Sysex ID\\n * @example\\n * note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2286,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex ID: Sends a MIDI sysex identifier message.</p>","name":"sysexid","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex ID</p>","name":"id"}],"examples":["note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()"],"longname":"sysexid","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex data: Sends a MIDI sysex message.\\n * @name sysexdata\\n * @param {number | Pattern} data Sysex data\\n * @example\\n * note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2294,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex data: Sends a MIDI sysex message.</p>","name":"sysexdata","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex data</p>","name":"data"}],"examples":["note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()"],"longname":"sysexdata","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI pitch bend: Sends a MIDI pitch bend message.\\n * @name midibend\\n * @param {number | Pattern} midibend MIDI pitch bend (-1 - 1)\\n * @example\\n * note(\\"c4\\").midibend(sine.slow(4).range(-0.4,0.4)).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2303,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI pitch bend: Sends a MIDI pitch bend message.</p>","name":"midibend","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI pitch bend (-1 - 1)</p>","name":"midibend"}],"examples":["note(\\"c4\\").midibend(sine.slow(4).range(-0.4,0.4)).midi()"],"longname":"midibend","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI key after touch: Sends a MIDI key after touch message.\\n * @name miditouch\\n * @param {number | Pattern} miditouch MIDI key after touch (0-1)\\n * @example\\n * note(\\"c4\\").miditouch(sine.slow(4).range(0,1)).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2311,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI key after touch: Sends a MIDI key after touch message.</p>","name":"miditouch","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI key after touch (0-1)</p>","name":"miditouch"}],"examples":["note(\\"c4\\").miditouch(sine.slow(4).range(0,1)).midi()"],"longname":"miditouch","kind":"member","scope":"global"},{"comment":"/**\\n * The host to send open sound control messages to. Requires running the OSC bridge.\\n * @name oschost\\n * @param {string | Pattern} oschost e.g. 'localhost'\\n * @example\\n * note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();\\n */","meta":{"filename":"controls.mjs","lineno":2323,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The host to send open sound control messages to. Requires running the OSC bridge.</p>","name":"oschost","params":[{"type":{"names":["string","Pattern"]},"description":"<p>e.g. 'localhost'</p>","name":"oschost"}],"examples":["note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();"],"longname":"oschost","kind":"member","scope":"global"},{"comment":"/**\\n * The port to send open sound control messages to. Requires running the OSC bridge.\\n * @name oscport\\n * @param {number | Pattern} oscport e.g. 57120\\n * @example\\n * note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();\\n */","meta":{"filename":"controls.mjs","lineno":2332,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The port to send open sound control messages to. Requires running the OSC bridge.</p>","name":"oscport","params":[{"type":{"names":["number","Pattern"]},"description":"<p>e.g. 57120</p>","name":"oscport"}],"examples":["note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();"],"longname":"oscport","kind":"member","scope":"global"},{"comment":"/**\\n * Sets properties in a batch.\\n *\\n * @name as\\n * @param {String | Array} mapping the control names that are set\\n * @example\\n * \\"c:.5 a:1 f:.25 e:.8\\".as(\\"note:clip\\")\\n * @example\\n * \\"{0@2 0.25 0 0.5 .3 .5}%8\\".as(\\"begin\\").s(\\"sax_vib\\").clip(1)\\n */","meta":{"filename":"controls.mjs","lineno":2348,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets properties in a batch.</p>","name":"as","params":[{"type":{"names":["String","Array"]},"description":"<p>the control names that are set</p>","name":"mapping"}],"examples":["\\"c:.5 a:1 f:.25 e:.8\\".as(\\"note:clip\\")","\\"{0@2 0.25 0 0.5 .3 .5}%8\\".as(\\"begin\\").s(\\"sax_vib\\").clip(1)"],"longname":"as","kind":"member","scope":"global"},{"comment":"/**\\n * Allows you to scrub an audio file like a tape loop by passing values that represents the position in the audio file\\n * in the optional array syntax ex: \\"0.5:2\\", the second value controls the speed of playback\\n * @name scrub\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples('github:switchangel/pad')\\n * s(\\"swpad:0\\").scrub(\\"{0.1!2 .25@3 0.7!2 <0.8:1.5>}%8\\")\\n * @example\\n * samples('github:yaxu/clean-breaks/main');\\n * s(\\"amen/4\\").fit().scrub(\\"{0@3 0@2 4@3}%8\\".div(16))\\n */","meta":{"filename":"controls.mjs","lineno":2367,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows you to scrub an audio file like a tape loop by passing values that represents the position in the audio file\\nin the optional array syntax ex: &quot;0.5:2&quot;, the second value controls the speed of playback</p>","name":"scrub","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples('github:switchangel/pad')\\ns(\\"swpad:0\\").scrub(\\"{0.1!2 .25@3 0.7!2 <0.8:1.5>}%8\\")","samples('github:yaxu/clean-breaks/main');\\ns(\\"amen/4\\").fit().scrub(\\"{0@3 0@2 4@3}%8\\".div(16))"],"scope":"static","longname":"Pattern.scrub","kind":"member"},{"comment":"/**\\n * Intended for a debugging, drawLine renders the pattern as a string, where each character represents the same time span.\\n * Should only be used with single characters as values, otherwise the character slots will be messed up.\\n * Character legend:\\n *\\n * - \\"|\\" cycle separator\\n * - \\"-\\" hold previous value\\n * - \\".\\" silence\\n *\\n * @param {Pattern} pattern the pattern to use\\n * @param {number} chars max number of characters (approximately)\\n * @returns string\\n * @example\\n * const line = drawLine(\\"0 [1 2 3]\\", 10); // |0--123|0--123\\n * console.log(line);\\n * silence;\\n */","meta":{"range":[1426,2796],"filename":"drawLine.mjs","lineno":26,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100021770","name":"drawLine","type":"FunctionDeclaration","paramnames":["pat","chars"]},"vars":{"cycle":"drawLine~cycle","pos":"drawLine~pos","lines":"drawLine~lines","emptyLine":"drawLine~emptyLine","haps":"drawLine~haps","durations":"drawLine~durations","":null,"charFraction":"drawLine~charFraction","totalSlots":"drawLine~totalSlots","i":"drawLine~i","undefined":null,"matches":"drawLine~matches","missingLines":"drawLine~missingLines"}},"description":"<p>Intended for a debugging, drawLine renders the pattern as a string, where each character represents the same time span.\\nShould only be used with single characters as values, otherwise the character slots will be messed up.\\nCharacter legend:</p>\\n<ul>\\n<li>&quot;|&quot; cycle separator</li>\\n<li>&quot;-&quot; hold previous value</li>\\n<li>&quot;.&quot; silence</li>\\n</ul>","params":[{"type":{"names":["Pattern"]},"description":"<p>the pattern to use</p>","name":"pattern"},{"type":{"names":["number"]},"description":"<p>max number of characters (approximately)</p>","name":"chars"}],"returns":[{"description":"<p>string</p>"}],"examples":["const line = drawLine(\\"0 [1 2 3]\\", 10); // |0--123|0--123\\nconsole.log(line);\\nsilence;"],"name":"drawLine","longname":"drawLine","kind":"function","scope":"global"},{"comment":"/**\\n * Changes the structure of the pattern to form an Euclidean rhythm.\\n * Euclidean rhythms are rhythms obtained using the greatest common\\n * divisor of two numbers.  They were described in 2004 by Godfried\\n * Toussaint, a Canadian computer scientist.  Euclidean rhythms are\\n * really useful for computer/algorithmic music because they can\\n * describe a large number of rhythms with a couple of numbers.\\n *\\n * @memberof Pattern\\n * @name euclid\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @returns Pattern\\n * @example\\n * // The Cuban tresillo pattern.\\n * note(\\"c3\\").euclid(3,8)\\n */","meta":{"filename":"euclid.mjs","lineno":54,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the structure of the pattern to form an Euclidean rhythm.\\nEuclidean rhythms are rhythms obtained using the greatest common\\ndivisor of two numbers.  They were described in 2004 by Godfried\\nToussaint, a Canadian computer scientist.  Euclidean rhythms are\\nreally useful for computer/algorithmic music because they can\\ndescribe a large number of rhythms with a couple of numbers.</p>","memberof":"Pattern","name":"euclid","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["// The Cuban tresillo pattern.\\nnote(\\"c3\\").euclid(3,8)"],"scope":"static","longname":"Pattern.euclid","kind":"member"},{"comment":"/**\\n * Like \`euclid\`, but has an additional parameter for 'rotating' the resulting sequence.\\n * @memberof Pattern\\n * @name euclidRot\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param {number} rotation offset in steps\\n * @returns Pattern\\n * @example\\n * // A Samba rhythm necklace from Brazil\\n * note(\\"c3\\").euclidRot(3,16,14)\\n */","meta":{"filename":"euclid.mjs","lineno":72,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>euclid</code>, but has an additional parameter for 'rotating' the resulting sequence.</p>","memberof":"Pattern","name":"euclidRot","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>offset in steps</p>","name":"rotation"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["// A Samba rhythm necklace from Brazil\\nnote(\\"c3\\").euclidRot(3,16,14)"],"scope":"static","longname":"Pattern.euclidRot","kind":"member"},{"comment":"/**\\n * @example // A thirteenth-century Persian rhythm called Khafif-e-ramal.\\n * note(\\"c3\\").euclid(2,5)\\n * @example // The archetypal pattern of the Cumbia from Colombia, as well as a Calypso rhythm from Trinidad.\\n * note(\\"c3\\").euclid(3,4)\\n * @example // Another thirteenth century Persian rhythm by the name of Khafif-e-ramal, as well as a Rumanian folk-dance rhythm.\\n * note(\\"c3\\").euclidRot(3,5,2)\\n * @example // A Ruchenitza rhythm used in a Bulgarian folk dance.\\n * note(\\"c3\\").euclid(3,7)\\n * @example // The Cuban tresillo pattern.\\n * note(\\"c3\\").euclid(3,8)\\n * @example // Another Ruchenitza Bulgarian folk-dance rhythm.\\n * note(\\"c3\\").euclid(4,7)\\n * @example // The Aksak rhythm of Turkey.\\n * note(\\"c3\\").euclid(4,9)\\n * @example // The metric pattern used by Frank Zappa in his piece titled Outside Now.\\n * note(\\"c3\\").euclid(4,11)\\n * @example // Yields the York-Samai pattern, a popular Arab rhythm.\\n * note(\\"c3\\").euclid(5,6)\\n * @example // The Nawakhat pattern, another popular Arab rhythm.\\n * note(\\"c3\\").euclid(5,7)\\n * @example // The Cuban cinquillo pattern.\\n * note(\\"c3\\").euclid(5,8)\\n * @example // A popular Arab rhythm called Agsag-Samai.\\n * note(\\"c3\\").euclid(5,9)\\n * @example // The metric pattern used by Moussorgsky in Pictures at an Exhibition.\\n * note(\\"c3\\").euclid(5,11)\\n * @example // The Venda clapping pattern of a South African children’s song.\\n * note(\\"c3\\").euclid(5,12)\\n * @example // The Bossa-Nova rhythm necklace of Brazil.\\n * note(\\"c3\\").euclid(5,16)\\n * @example // A typical rhythm played on the Bendir (frame drum).\\n * note(\\"c3\\").euclid(7,8)\\n * @example // A common West African bell pattern.\\n * note(\\"c3\\").euclid(7,12)\\n * @example // A Samba rhythm necklace from Brazil.\\n * note(\\"c3\\").euclidRot(7,16,14)\\n * @example // A rhythm necklace used in the Central African Republic.\\n * note(\\"c3\\").euclid(9,16)\\n * @example // A rhythm necklace of the Aka Pygmies of Central Africa.\\n * note(\\"c3\\").euclidRot(11,24,14)\\n * @example // Another rhythm necklace of the Aka Pygmies of the upper Sangha.\\n * note(\\"c3\\").euclidRot(13,24,5)\\n */","meta":{"range":[5307,5459],"filename":"euclid.mjs","lineno":130,"columnno":6,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100022275","name":"_euclidRot","type":"FunctionExpression"},"vars":{"b":"_euclidRot~b"}},"examples":["// A thirteenth-century Persian rhythm called Khafif-e-ramal.\\nnote(\\"c3\\").euclid(2,5)","// The archetypal pattern of the Cumbia from Colombia, as well as a Calypso rhythm from Trinidad.\\nnote(\\"c3\\").euclid(3,4)","// Another thirteenth century Persian rhythm by the name of Khafif-e-ramal, as well as a Rumanian folk-dance rhythm.\\nnote(\\"c3\\").euclidRot(3,5,2)","// A Ruchenitza rhythm used in a Bulgarian folk dance.\\nnote(\\"c3\\").euclid(3,7)","// The Cuban tresillo pattern.\\nnote(\\"c3\\").euclid(3,8)","// Another Ruchenitza Bulgarian folk-dance rhythm.\\nnote(\\"c3\\").euclid(4,7)","// The Aksak rhythm of Turkey.\\nnote(\\"c3\\").euclid(4,9)","// The metric pattern used by Frank Zappa in his piece titled Outside Now.\\nnote(\\"c3\\").euclid(4,11)","// Yields the York-Samai pattern, a popular Arab rhythm.\\nnote(\\"c3\\").euclid(5,6)","// The Nawakhat pattern, another popular Arab rhythm.\\nnote(\\"c3\\").euclid(5,7)","// The Cuban cinquillo pattern.\\nnote(\\"c3\\").euclid(5,8)","// A popular Arab rhythm called Agsag-Samai.\\nnote(\\"c3\\").euclid(5,9)","// The metric pattern used by Moussorgsky in Pictures at an Exhibition.\\nnote(\\"c3\\").euclid(5,11)","// The Venda clapping pattern of a South African children’s song.\\nnote(\\"c3\\").euclid(5,12)","// The Bossa-Nova rhythm necklace of Brazil.\\nnote(\\"c3\\").euclid(5,16)","// A typical rhythm played on the Bendir (frame drum).\\nnote(\\"c3\\").euclid(7,8)","// A common West African bell pattern.\\nnote(\\"c3\\").euclid(7,12)","// A Samba rhythm necklace from Brazil.\\nnote(\\"c3\\").euclidRot(7,16,14)","// A rhythm necklace used in the Central African Republic.\\nnote(\\"c3\\").euclid(9,16)","// A rhythm necklace of the Aka Pygmies of Central Africa.\\nnote(\\"c3\\").euclidRot(11,24,14)","// Another rhythm necklace of the Aka Pygmies of the upper Sangha.\\nnote(\\"c3\\").euclidRot(13,24,5)"],"name":"_euclidRot","longname":"_euclidRot","kind":"function","scope":"global","params":[]},{"comment":"/**\\n * Similar to \`euclid\`, but each pulse is held until the next pulse,\\n * so there will be no gaps.\\n * @name euclidLegato\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param rotation offset in steps\\n * @param pat\\n * @example\\n * note(\\"c3\\").euclidLegato(3,8)\\n */","meta":{"filename":"euclid.mjs","lineno":154,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Similar to <code>euclid</code>, but each pulse is held until the next pulse,\\nso there will be no gaps.</p>","name":"euclidLegato","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"description":"<p>offset in steps</p>","name":"rotation"},{"name":"pat"}],"examples":["note(\\"c3\\").euclidLegato(3,8)"],"scope":"static","longname":"Pattern.euclidLegato","kind":"member"},{"comment":"/**\\n * Similar to \`euclid\`, but each pulse is held until the next pulse,\\n * so there will be no gaps, and has an additional parameter for 'rotating'\\n * the resulting sequence\\n * @name euclidLegatoRot\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param {number} rotation offset in steps\\n * @example\\n * note(\\"c3\\").euclidLegatoRot(3,5,2)\\n */","meta":{"filename":"euclid.mjs","lineno":184,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Similar to <code>euclid</code>, but each pulse is held until the next pulse,\\nso there will be no gaps, and has an additional parameter for 'rotating'\\nthe resulting sequence</p>","name":"euclidLegatoRot","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>offset in steps</p>","name":"rotation"}],"examples":["note(\\"c3\\").euclidLegatoRot(3,5,2)"],"scope":"static","longname":"Pattern.euclidLegatoRot","kind":"member"},{"comment":"/**\\n * A 'euclid' variant with an additional parameter that morphs the resulting\\n * rhythm from 0 (no morphing) to 1 (completely 'even'). For example\\n * \`sound(\\"bd\\").euclidish(3,8,0)\` would be the same as\\n * \`sound(\\"bd\\").euclid(3,8)\`, and \`sound(\\"bd\\").euclidish(3,8,1)\` would be the\\n * same as \`sound(\\"bd bd bd\\")\`. \`sound(\\"bd\\").euclidish(3,8,0.5)\` would have a\\n * groove somewhere between.\\n * Inspired by the work of Malcom Braff.\\n * @name euclidish\\n * @synonyms eish\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets\\n * @param {number} steps the number of steps to fill\\n * @param {number} groove exists between the extremes of 0 (straight euclidian) and 1 (straight pulse)\\n * @example\\n * sound(\\"hh\\").euclidish(7,12,sine.slow(8))\\n * .pan(sine.slow(8))\\n */","meta":{"filename":"euclid.mjs","lineno":200,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A 'euclid' variant with an additional parameter that morphs the resulting\\nrhythm from 0 (no morphing) to 1 (completely 'even'). For example\\n<code>sound(&quot;bd&quot;).euclidish(3,8,0)</code> would be the same as\\n<code>sound(&quot;bd&quot;).euclid(3,8)</code>, and <code>sound(&quot;bd&quot;).euclidish(3,8,1)</code> would be the\\nsame as <code>sound(&quot;bd bd bd&quot;)</code>. <code>sound(&quot;bd&quot;).euclidish(3,8,0.5)</code> would have a\\ngroove somewhere between.\\nInspired by the work of Malcom Braff.</p>","name":"euclidish","synonyms_text":"eish","synonyms":["eish"],"memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>exists between the extremes of 0 (straight euclidian) and 1 (straight pulse)</p>","name":"groove"}],"examples":["sound(\\"hh\\").euclidish(7,12,sine.slow(8))\\n.pan(sine.slow(8))"],"scope":"static","longname":"Pattern.euclidish","kind":"member"},{"comment":"/** @class Class representing a pattern. */","meta":{"range":[1713,27921],"filename":"pattern.mjs","lineno":44,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100024880","name":"exports.Pattern","type":"ClassDeclaration"}},"name":"Pattern","longname":"Pattern","kind":"class","classdesc":"<p>Class representing a pattern.</p>","scope":"global","description":"<p>Create a pattern. As an end user, you will most likely not create a Pattern directly.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"memberof":"Pattern","params":[{"type":{"names":["function"]},"description":"<p>The function that maps a <code>State</code> to an array of <code>Hap</code>.</p>","name":"query"}]},{"comment":"/**\\n   * Returns a new pattern, with the function applied to the value of\\n   * each hap. It has the alias \`fmap\`.\\n   * @synonyms fmap\\n   * @param {Function} func to to apply to the value\\n   * @returns Pattern\\n   * @example\\n   * \\"0 1 2\\".withValue(v => v + 10).log()\\n   */","meta":{"range":[3020,3189],"filename":"pattern.mjs","lineno":93,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100024988","name":"Pattern#withValue","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern, with the function applied to the value of\\neach hap. It has the alias <code>fmap</code>.</p>","synonyms_text":"fmap","synonyms":["fmap"],"params":[{"type":{"names":["function"]},"description":"<p>to to apply to the value</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2\\".withValue(v => v + 10).log()"],"name":"withValue","longname":"Pattern#withValue","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * see \`withValue\`\\n   * @noAutocomplete\\n   */","meta":{"range":[3362,3411],"filename":"pattern.mjs","lineno":108,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025042","name":"Pattern#fmap","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>see <code>withValue</code></p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"fmap","longname":"Pattern#fmap","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Assumes 'this' is a pattern of functions, and given a function to\\n   * resolve wholes, applies a given pattern of values to that\\n   * pattern of functions.\\n   * @param {Function} whole_func\\n   * @param {Function} func\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[3693,4435],"filename":"pattern.mjs","lineno":121,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025053","name":"Pattern#appWhole","type":"MethodDefinition","paramnames":["whole_func","pat_val"]},"vars":{"":null}},"description":"<p>Assumes 'this' is a pattern of functions, and given a function to\\nresolve wholes, applies a given pattern of values to that\\npattern of functions.</p>","params":[{"type":{"names":["function"]},"name":"whole_func"},{"type":{"names":["function"]},"name":"func"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appWhole","longname":"Pattern#appWhole","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * When this method is called on a pattern of functions, it matches its haps\\n   * with those in the given pattern of values.  A new pattern is returned, with\\n   * each matching value applied to the corresponding function.\\n   *\\n   * In this \`_appBoth\` variant, where timespans of the function and value haps\\n   * are not the same but do intersect, the resulting hap has a timespan of the\\n   * intersection. This applies to both the part and the whole timespan.\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[4986,5410],"filename":"pattern.mjs","lineno":157,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025160","name":"Pattern#appBoth","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>When this method is called on a pattern of functions, it matches its haps\\nwith those in the given pattern of values.  A new pattern is returned, with\\neach matching value applied to the corresponding function.</p>\\n<p>In this <code>_appBoth</code> variant, where timespans of the function and value haps\\nare not the same but do intersect, the resulting hap has a timespan of the\\nintersection. This applies to both the part and the whole timespan.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appBoth","longname":"Pattern#appBoth","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`appBoth\`, but the \`whole\` timespan is not the intersection,\\n   * but the timespan from the function of patterns that this method is called\\n   * on. In practice, this means that the pattern structure, including onsets,\\n   * are preserved from the pattern of functions (often referred to as the left\\n   * hand or inner pattern).\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[5840,6644],"filename":"pattern.mjs","lineno":184,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025220","name":"Pattern#appLeft","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>As with <code>appBoth</code>, but the <code>whole</code> timespan is not the intersection,\\nbut the timespan from the function of patterns that this method is called\\non. In practice, this means that the pattern structure, including onsets,\\nare preserved from the pattern of functions (often referred to as the left\\nhand or inner pattern).</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appLeft","longname":"Pattern#appLeft","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`appLeft\`, but \`whole\` timespans are instead taken from the\\n   * pattern of values, i.e. structure is preserved from the right hand/outer\\n   * pattern.\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[6898,7706],"filename":"pattern.mjs","lineno":217,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025342","name":"Pattern#appRight","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>As with <code>appLeft</code>, but <code>whole</code> timespans are instead taken from the\\npattern of values, i.e. structure is preserved from the right hand/outer\\npattern.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appRight","longname":"Pattern#appRight","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Query haps inside the given time span.\\n   *\\n   * @param {Fraction | number} begin from time\\n   * @param {Fraction | number} end to time\\n   * @returns Hap[]\\n   * @example\\n   * const pattern = sequence('a', ['b', 'c'])\\n   * const haps = pattern.queryArc(0, 1)\\n   * console.log(haps)\\n   * silence\\n   * @noAutocomplete\\n   */","meta":{"range":[13342,13558],"filename":"pattern.mjs","lineno":413,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026022","name":"Pattern#queryArc","type":"MethodDefinition","paramnames":["begin","end","controls"]},"vars":{"":null}},"description":"<p>Query haps inside the given time span.</p>","params":[{"type":{"names":["Fraction","number"]},"description":"<p>from time</p>","name":"begin"},{"type":{"names":["Fraction","number"]},"description":"<p>to time</p>","name":"end"}],"returns":[{"description":"<p>Hap[]</p>"}],"examples":["const pattern = sequence('a', ['b', 'c'])\\nconst haps = pattern.queryArc(0, 1)\\nconsole.log(haps)\\nsilence"],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"queryArc","longname":"Pattern#queryArc","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern, with queries split at cycle boundaries. This makes\\n   * some calculations easier to express, as all haps are then constrained to\\n   * happen within a cycle.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[13802,14002],"filename":"pattern.mjs","lineno":429,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026058","name":"Pattern#splitQueries","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with queries split at cycle boundaries. This makes\\nsome calculations easier to express, as all haps are then constrained to\\nhappen within a cycle.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"splitQueries","longname":"Pattern#splitQueries","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, where the given function is applied to the query\\n   * timespan before passing it to the original pattern.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[14245,14339],"filename":"pattern.mjs","lineno":444,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026098","name":"Pattern#withQuerySpan","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern, where the given function is applied to the query\\ntimespan before passing it to the original pattern.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withQuerySpan","longname":"Pattern#withQuerySpan","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withQuerySpan\`, but the function is applied to both the\\n   * begin and end time of the query timespan.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[14799,14918],"filename":"pattern.mjs","lineno":466,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026154","name":"Pattern#withQueryTime","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withQuerySpan</code>, but the function is applied to both the\\nbegin and end time of the query timespan.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withQueryTime","longname":"Pattern#withQueryTime","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Similar to \`withQuerySpan\`, but the function is applied to the timespans\\n   * of all haps returned by pattern queries (both \`part\` timespans, and where\\n   * present, \`whole\` timespans).\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15196,15306],"filename":"pattern.mjs","lineno":478,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026179","name":"Pattern#withHapSpan","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Similar to <code>withQuerySpan</code>, but the function is applied to the timespans\\nof all haps returned by pattern queries (both <code>part</code> timespans, and where\\npresent, <code>whole</code> timespans).</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHapSpan","longname":"Pattern#withHapSpan","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withHapSpan\`, but the function is applied to both the\\n   * begin and end time of the hap timespans.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15529,15612],"filename":"pattern.mjs","lineno":489,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026204","name":"Pattern#withHapTime","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withHapSpan</code>, but the function is applied to both the\\nbegin and end time of the hap timespans.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHapTime","longname":"Pattern#withHapTime","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the given function applied to the list of haps returned by every query.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15803,15950],"filename":"pattern.mjs","lineno":499,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026221","name":"Pattern#withHaps","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given function applied to the list of haps returned by every query.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHaps","longname":"Pattern#withHaps","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withHaps\`, but applies the function to every hap, rather than every list of haps.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16133,16204],"filename":"pattern.mjs","lineno":511,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026251","name":"Pattern#withHap","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withHaps</code>, but applies the function to every hap, rather than every list of haps.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHap","longname":"Pattern#withHap","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the context field set to every hap set to the given value.\\n   * @param {*} context\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16378,16462],"filename":"pattern.mjs","lineno":521,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026268","name":"Pattern#setContext","type":"MethodDefinition","paramnames":["context"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the context field set to every hap set to the given value.</p>","params":[{"type":{"names":["*"]},"name":"context"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"setContext","longname":"Pattern#setContext","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the given function applied to the context field of every hap.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16643,16883],"filename":"pattern.mjs","lineno":531,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026285","name":"Pattern#withContext","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given function applied to the context field of every hap.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withContext","longname":"Pattern#withContext","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the context field of every hap set to an empty object.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17029,17103],"filename":"pattern.mjs","lineno":545,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026333","name":"Pattern#stripContext","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern with the context field of every hap set to an empty object.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"stripContext","longname":"Pattern#stripContext","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern with the given location information added to the\\n   * context of every hap.\\n   * @param {Number} start start offset\\n   * @param {Number} end end offset\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17341,17708],"filename":"pattern.mjs","lineno":557,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026349","name":"Pattern#withLoc","type":"MethodDefinition","paramnames":["start","end"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given location information added to the\\ncontext of every hap.</p>","params":[{"type":{"names":["Number"]},"description":"<p>start offset</p>","name":"start"},{"type":{"names":["Number"]},"description":"<p>end offset</p>","name":"end"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withLoc","longname":"Pattern#withLoc","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new Pattern, which only returns haps that meet the given test.\\n   * @param {Function} hap_test - a function which returns false for haps to be removed from the pattern\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17950,18047],"filename":"pattern.mjs","lineno":579,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026413","name":"Pattern#filterHaps","type":"MethodDefinition","paramnames":["hap_test"]},"vars":{"":null}},"description":"<p>Returns a new Pattern, which only returns haps that meet the given test.</p>","params":[{"type":{"names":["function"]},"description":"<p>a function which returns false for haps to be removed from the pattern</p>","name":"hap_test"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"filterHaps","longname":"Pattern#filterHaps","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`filterHaps\`, but the function is applied to values\\n   * inside haps.\\n   * @param {Function} value_test\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18223,18368],"filename":"pattern.mjs","lineno":590,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026432","name":"Pattern#filterValues","type":"MethodDefinition","paramnames":["value_test"]},"vars":{"":null}},"description":"<p>As with <code>filterHaps</code>, but the function is applied to values\\ninside haps.</p>","params":[{"type":{"names":["function"]},"name":"value_test"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"filterValues","longname":"Pattern#filterValues","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern, with haps containing undefined values removed from\\n   * query results.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18526,18607],"filename":"pattern.mjs","lineno":600,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026463","name":"Pattern#removeUndefineds","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with haps containing undefined values removed from\\nquery results.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"removeUndefineds","longname":"Pattern#removeUndefineds","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, with all haps without onsets filtered out. A hap\\n   * with an onset is one with a \`whole\` timespan that begins at the same time\\n   * as its \`part\` timespan.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18851,19116],"filename":"pattern.mjs","lineno":611,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026477","name":"Pattern#onsetsOnly","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with all haps without onsets filtered out. A hap\\nwith an onset is one with a <code>whole</code> timespan that begins at the same time\\nas its <code>part</code> timespan.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"onsetsOnly","longname":"Pattern#onsetsOnly","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, with 'continuous' haps (those without 'whole'\\n   * timespans) removed from query results.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[19293,19427],"filename":"pattern.mjs","lineno":624,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026492","name":"Pattern#discreteOnly","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with 'continuous' haps (those without 'whole'\\ntimespans) removed from query results.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"discreteOnly","longname":"Pattern#discreteOnly","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Combines adjacent haps with the same value and whole.  Only\\n   * intended for use in tests.\\n   * @noAutocomplete\\n   */","meta":{"range":[19561,21006],"filename":"pattern.mjs","lineno":634,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026506","name":"Pattern#defragmentHaps","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Combines adjacent haps with the same value and whole.  Only\\nintended for use in tests.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"defragmentHaps","longname":"Pattern#defragmentHaps","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Queries the pattern for the first cycle, returning Haps. Mainly of use when\\n   * debugging a pattern.\\n   * @param {Boolean} with_context - set to true, otherwise the context field\\n   * will be stripped from the resulting haps.\\n   * @returns [Hap]\\n   * @noAutocomplete\\n   */","meta":{"range":[21295,21493],"filename":"pattern.mjs","lineno":689,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026737","name":"Pattern#firstCycle","type":"MethodDefinition","paramnames":["with_context"]},"vars":{"":null}},"description":"<p>Queries the pattern for the first cycle, returning Haps. Mainly of use when\\ndebugging a pattern.</p>","params":[{"type":{"names":["Boolean"]},"description":"<p>set to true, otherwise the context field\\nwill be stripped from the resulting haps.</p>","name":"with_context","defaultvalue":false}],"returns":[{"description":"<p>[Hap]</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"firstCycle","longname":"Pattern#firstCycle","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Accessor for a list of values returned by querying the first cycle.\\n   * @noAutocomplete\\n   */","meta":{"range":[21603,21685],"filename":"pattern.mjs","lineno":701,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026774","name":"Pattern#firstCycleValues","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Accessor for a list of values returned by querying the first cycle.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"firstCycleValues","longname":"Pattern#firstCycleValues","kind":"member","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * More human-readable version of the \`firstCycleValues\` accessor.\\n   * @noAutocomplete\\n   */","meta":{"range":[21791,21954],"filename":"pattern.mjs","lineno":709,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026791","name":"Pattern#showFirstCycle","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>More human-readable version of the <code>firstCycleValues</code> accessor.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"showFirstCycle","longname":"Pattern#showFirstCycle","kind":"member","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, which returns haps sorted in temporal order. Mainly\\n   * of use when comparing two patterns for equality, in tests.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[22157,22430],"filename":"pattern.mjs","lineno":721,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026829","name":"Pattern#sortHapsByPart","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, which returns haps sorted in temporal order. Mainly\\nof use when comparing two patterns for equality, in tests.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"sortHapsByPart","longname":"Pattern#sortHapsByPart","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Layers the result of the given function(s). Like \`superimpose\`, but without the original pattern:\\n   * @name layer\\n   * @memberof Pattern\\n   * @synonyms apply\\n   * @returns Pattern\\n   * @example\\n   * \\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n   *   .layer(x=>x.add(\\"0,2\\"))\\n   *   .scale('C minor').note()\\n   */","meta":{"filename":"pattern.mjs","lineno":779,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Layers the result of the given function(s). Like <code>superimpose</code>, but without the original pattern:</p>","name":"layer","memberof":"Pattern","synonyms_text":"apply","synonyms":["apply"],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n  .layer(x=>x.add(\\"0,2\\"))\\n  .scale('C minor').note()"],"scope":"static","longname":"Pattern.layer","kind":"member"},{"comment":"/**\\n   * Superimposes the result of the given function(s) on top of the original pattern:\\n   * @name superimpose\\n   * @memberof Pattern\\n   * @returns Pattern\\n   * @example\\n   * \\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n   *   .superimpose(x=>x.add(2))\\n   *   .scale('C minor').note()\\n   */","meta":{"filename":"pattern.mjs","lineno":794,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimposes the result of the given function(s) on top of the original pattern:</p>","name":"superimpose","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n  .superimpose(x=>x.add(2))\\n  .scale('C minor').note()"],"scope":"static","longname":"Pattern.superimpose","kind":"member"},{"comment":"/**\\n   * Writes the content of the current event to the console (visible in the side menu).\\n   * @name log\\n   * @memberof Pattern\\n   * @example\\n   * s(\\"bd sd\\").log()\\n   */","meta":{"filename":"pattern.mjs","lineno":854,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Writes the content of the current event to the console (visible in the side menu).</p>","name":"log","memberof":"Pattern","examples":["s(\\"bd sd\\").log()"],"scope":"static","longname":"Pattern.log","kind":"member"},{"comment":"/**\\n   * A simplified version of \`log\` which writes all \\"values\\" (various configurable parameters)\\n   * within the event to the console (visible in the side menu).\\n   * @name logValues\\n   * @memberof Pattern\\n   * @example\\n   * s(\\"bd sd\\").gain(\\"0.25 0.5 1\\").n(\\"2 1 0\\").logValues()\\n   */","meta":{"filename":"pattern.mjs","lineno":867,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A simplified version of <code>log</code> which writes all &quot;values&quot; (various configurable parameters)\\nwithin the event to the console (visible in the side menu).</p>","name":"logValues","memberof":"Pattern","examples":["s(\\"bd sd\\").gain(\\"0.25 0.5 1\\").n(\\"2 1 0\\").logValues()"],"scope":"static","longname":"Pattern.logValues","kind":"member"},{"comment":"/**\\n   * Breaks a pattern into pieces according to the structure of a given pattern.\\n   * True values in the given pattern cause the corresponding subcycle of the\\n   * source pattern to be looped, and for an (optional) given function to be\\n   * applied. False values result in the corresponding part of the source pattern\\n   * to be played unchanged.\\n   * @name into\\n   * @memberof Pattern\\n   * @example\\n   * sound(\\"bd sd ht lt\\").into(\\"1 0\\", hurry(2))\\n   */","meta":{"filename":"pattern.mjs","lineno":897,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Breaks a pattern into pieces according to the structure of a given pattern.\\nTrue values in the given pattern cause the corresponding subcycle of the\\nsource pattern to be looped, and for an (optional) given function to be\\napplied. False values result in the corresponding part of the source pattern\\nto be played unchanged.</p>","name":"into","memberof":"Pattern","examples":["sound(\\"bd sd ht lt\\").into(\\"1 0\\", hurry(2))"],"scope":"static","longname":"Pattern.into","kind":"member"},{"comment":"/**\\n * Selects indices in in stacked notes.\\n * @example\\n * note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n * .arpWith(haps => haps[2])\\n * */","meta":{"range":[28891,29121],"filename":"pattern.mjs","lineno":946,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100027543","name":"exports.arpWith","type":"VariableDeclaration"}},"description":"<p>Selects indices in in stacked notes.</p>","examples":["note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n.arpWith(haps => haps[2])"],"name":"arpWith","longname":"arpWith","kind":"constant","scope":"global"},{"comment":"/**\\n * Selects indices in in stacked notes.\\n * @example\\n * note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n * .arp(\\"0 [0,2] 1 [0,2]\\")\\n * */","meta":{"range":[29254,29397],"filename":"pattern.mjs","lineno":960,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100027597","name":"exports.arp","type":"VariableDeclaration"}},"description":"<p>Selects indices in in stacked notes.</p>","examples":["note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n.arp(\\"0 [0,2] 1 [0,2]\\")"],"name":"arp","longname":"arp","kind":"constant","scope":"global"},{"comment":"/**\\n     *\\n     * Assumes a pattern of numbers. Adds the given number to each item in the pattern.\\n     * @name add\\n     * @memberof Pattern\\n     * @example\\n     * // Here, the triad 0, 2, 4 is shifted by different amounts\\n     * n(\\"0 2 4\\".add(\\"<0 3 4 0>\\")).scale(\\"C:major\\")\\n     * // Without add, the equivalent would be:\\n     * // n(\\"<[0 2 4] [3 5 7] [4 6 8] [0 2 4]>\\").scale(\\"C:major\\")\\n     * @example\\n     * // You can also use add with notes:\\n     * note(\\"c3 e3 g3\\".add(\\"<0 5 7 0>\\"))\\n     * // Behind the scenes, the notes are converted to midi numbers:\\n     * // note(\\"48 52 55\\".add(\\"<0 5 7 0>\\"))\\n     */","meta":{"filename":"pattern.mjs","lineno":1023,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a pattern of numbers. Adds the given number to each item in the pattern.</p>","name":"add","memberof":"Pattern","examples":["// Here, the triad 0, 2, 4 is shifted by different amounts\\nn(\\"0 2 4\\".add(\\"<0 3 4 0>\\")).scale(\\"C:major\\")\\n// Without add, the equivalent would be:\\n// n(\\"<[0 2 4] [3 5 7] [4 6 8] [0 2 4]>\\").scale(\\"C:major\\")","// You can also use add with notes:\\nnote(\\"c3 e3 g3\\".add(\\"<0 5 7 0>\\"))\\n// Behind the scenes, the notes are converted to midi numbers:\\n// note(\\"48 52 55\\".add(\\"<0 5 7 0>\\"))"],"scope":"static","longname":"Pattern.add","kind":"member"},{"comment":"/**\\n     *\\n     * Like add, but the given numbers are subtracted.\\n     * @name sub\\n     * @memberof Pattern\\n     * @example\\n     * n(\\"0 2 4\\".sub(\\"<0 1 2 3>\\")).scale(\\"C4:minor\\")\\n     * // See add for more information.\\n     */","meta":{"filename":"pattern.mjs","lineno":1040,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like add, but the given numbers are subtracted.</p>","name":"sub","memberof":"Pattern","examples":["n(\\"0 2 4\\".sub(\\"<0 1 2 3>\\")).scale(\\"C4:minor\\")\\n// See add for more information."],"scope":"static","longname":"Pattern.sub","kind":"member"},{"comment":"/**\\n     *\\n     * Multiplies each number by the given factor.\\n     * @name mul\\n     * @memberof Pattern\\n     * @example\\n     * \\"<1 1.5 [1.66, <2 2.33>]>*4\\".mul(150).freq()\\n     */","meta":{"filename":"pattern.mjs","lineno":1050,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Multiplies each number by the given factor.</p>","name":"mul","memberof":"Pattern","examples":["\\"<1 1.5 [1.66, <2 2.33>]>*4\\".mul(150).freq()"],"scope":"static","longname":"Pattern.mul","kind":"member"},{"comment":"/**\\n     *\\n     * Divides each number by the given factor.\\n     * @name div\\n     * @memberof Pattern\\n     */","meta":{"filename":"pattern.mjs","lineno":1059,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides each number by the given factor.</p>","name":"div","memberof":"Pattern","scope":"static","longname":"Pattern.div","kind":"member"},{"comment":"/**\\n   * Applies the given structure to the pattern:\\n   *\\n   * @example\\n   * note(\\"c,eb,g\\")\\n   *   .struct(\\"x ~ x ~ ~ x ~ x ~ ~ ~ x ~ x ~ ~\\")\\n   *   .slow(2)\\n   */","meta":{"range":[35283,35371],"filename":"pattern.mjs","lineno":1155,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028142","name":"Pattern.prototype.struct","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Applies the given structure to the pattern:</p>","examples":["note(\\"c,eb,g\\")\\n  .struct(\\"x ~ x ~ ~ x ~ x ~ ~ ~ x ~ x ~ ~\\")\\n  .slow(2)"],"name":"struct","longname":"Pattern#struct","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns silence when mask is 0 or \\"~\\"\\n   *\\n   * @example\\n   * note(\\"c [eb,g] d [eb,g]\\").mask(\\"<1 [0 1]>\\")\\n   */","meta":{"range":[35591,35676],"filename":"pattern.mjs","lineno":1167,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028182","name":"Pattern.prototype.mask","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Returns silence when mask is 0 or &quot;~&quot;</p>","examples":["note(\\"c [eb,g] d [eb,g]\\").mask(\\"<1 [0 1]>\\")"],"name":"mask","longname":"Pattern#mask","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Resets the pattern to the start of the cycle for each onset of the reset pattern.\\n   *\\n   * @example\\n   * s(\\"[<bd lt> sd]*2, hh*8\\").reset(\\"<x@3 x(5,8)>\\")\\n   */","meta":{"range":[35941,36030],"filename":"pattern.mjs","lineno":1179,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028222","name":"Pattern.prototype.reset","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Resets the pattern to the start of the cycle for each onset of the reset pattern.</p>","examples":["s(\\"[<bd lt> sd]*2, hh*8\\").reset(\\"<x@3 x(5,8)>\\")"],"name":"reset","longname":"Pattern#reset","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Restarts the pattern for each onset of the restart pattern.\\n   * While reset will only reset the current cycle, restart will start from cycle 0.\\n   *\\n   * @example\\n   * s(\\"[<bd lt> sd]*2, hh*8\\").restart(\\"<x@3 x(5,8)>\\")\\n   */","meta":{"range":[36364,36457],"filename":"pattern.mjs","lineno":1192,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028262","name":"Pattern.prototype.restart","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Restarts the pattern for each onset of the restart pattern.\\nWhile reset will only reset the current cycle, restart will start from cycle 0.</p>","examples":["s(\\"[<bd lt> sd]*2, hh*8\\").restart(\\"<x@3 x(5,8)>\\")"],"name":"restart","longname":"Pattern#restart","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Does absolutely nothing, but with a given metrical 'steps'\\n * @name gap\\n * @param  {number} steps\\n * @example\\n * gap(3) // \\"~@3\\"\\n */","meta":{"filename":"pattern.mjs","lineno":1226,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Does absolutely nothing, but with a given metrical 'steps'</p>","name":"gap","params":[{"type":{"names":["number"]},"name":"steps"}],"examples":["gap(3) // \\"~@3\\""],"longname":"gap","kind":"member","scope":"global"},{"comment":"/**\\n * Does absolutely nothing..\\n * @name silence\\n * @example\\n * silence // \\"~\\"\\n */","meta":{"filename":"pattern.mjs","lineno":1235,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Does absolutely nothing..</p>","name":"silence","examples":["silence // \\"~\\""],"longname":"silence","kind":"member","scope":"global"},{"comment":"/**\\n * A discrete value that repeats once per cycle.\\n *\\n * @returns {Pattern}\\n * @example\\n * pure('e4') // \\"e4\\"\\n * @noAutocomplete\\n */","meta":{"range":[37708,37965],"filename":"pattern.mjs","lineno":1254,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028341","name":"exports.pure","type":"FunctionDeclaration","paramnames":["value"]}},"description":"<p>A discrete value that repeats once per cycle.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["pure('e4') // \\"e4\\""],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"pure","longname":"pure","kind":"function","scope":"global"},{"comment":"/** Takes a list of patterns, and returns a pattern of lists.\\n */","meta":{"range":[38970,39150],"filename":"pattern.mjs","lineno":1292,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028431","name":"exports.sequenceP","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Takes a list of patterns, and returns a pattern of lists.</p>","name":"sequenceP","longname":"sequenceP","kind":"function","scope":"global"},{"comment":"/**\\n * The given items are played at the same time at the same length.\\n *\\n * @return {Pattern}\\n * @synonyms polyrhythm, pr\\n * @example\\n * stack(\\"g3\\", \\"b3\\", [\\"e4\\", \\"d4\\"]).note()\\n * // \\"g3,b3,[e4 d4]\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").stack(\\n *   note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[39452,39830],"filename":"pattern.mjs","lineno":1315,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028471","name":"exports.stack","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>The given items are played at the same time at the same length.</p>","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"polyrhythm, pr","synonyms":["polyrhythm","pr"],"examples":["stack(\\"g3\\", \\"b3\\", [\\"e4\\", \\"d4\\"]).note()\\n// \\"g3,b3,[e4 d4]\\".note()","// As a chained function:\\ns(\\"hh*4\\").stack(\\n  note(\\"c4(5,8)\\")\\n)"],"name":"stack","longname":"stack","kind":"function","scope":"global"},{"comment":"/**\\n * Concatenation: combines a list of patterns, switching between them successively, one per cycle.\\n *\\n * @return {Pattern}\\n * @synonyms cat\\n * @example\\n * slowcat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"])\\n *\\n */","meta":{"range":[41498,42548],"filename":"pattern.mjs","lineno":1393,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028835","name":"exports.slowcat","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Concatenation: combines a list of patterns, switching between them successively, one per cycle.</p>","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"cat","synonyms":["cat"],"examples":["slowcat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"])"],"name":"slowcat","longname":"slowcat","kind":"function","scope":"global"},{"comment":"/** Concatenation: combines a list of patterns, switching between them successively, one per cycle. Unlike slowcat, this version will skip cycles.\\n * @param {...any} items - The items to concatenate\\n * @return {Pattern}\\n */","meta":{"range":[42774,43147],"filename":"pattern.mjs","lineno":1423,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028995","name":"exports.slowcatPrime","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Concatenation: combines a list of patterns, switching between them successively, one per cycle. Unlike slowcat, this version will skip cycles.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>The items to concatenate</p>","name":"items"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"slowcatPrime","longname":"slowcatPrime","kind":"function","scope":"global"},{"comment":"/** The given items are con**cat**enated, where each one takes one cycle.\\n *\\n * @param {...any} items - The items to concatenate\\n * @synonyms slowcat\\n * @return {Pattern}\\n * @example\\n * cat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n * // \\"<e5 b4 [d5 c5]>\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").cat(\\n *    note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[43496,43555],"filename":"pattern.mjs","lineno":1448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029048","name":"exports.cat","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>The given items are con<strong>cat</strong>enated, where each one takes one cycle.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>The items to concatenate</p>","name":"items"}],"synonyms_text":"slowcat","synonyms":["slowcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["cat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n// \\"<e5 b4 [d5 c5]>\\".note()","// As a chained function:\\ns(\\"hh*4\\").cat(\\n   note(\\"c4(5,8)\\")\\n)"],"name":"cat","longname":"cat","kind":"function","scope":"global"},{"comment":"/**\\n * Allows to arrange multiple patterns together over multiple cycles.\\n * Takes a variable number of arrays with two elements specifying the number of cycles and the pattern to use.\\n *\\n * @return {Pattern}\\n * @example\\n * arrange(\\n *   [4, \\"<c a f e>(3,8)\\"],\\n *   [2, \\"<g a>(5,8)\\"]\\n * ).note()\\n */","meta":{"range":[43857,44091],"filename":"pattern.mjs","lineno":1463,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029059","name":"exports.arrange","type":"FunctionDeclaration","paramnames":["sections"]}},"description":"<p>Allows to arrange multiple patterns together over multiple cycles.\\nTakes a variable number of arrays with two elements specifying the number of cycles and the pattern to use.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["arrange(\\n  [4, \\"<c a f e>(3,8)\\"],\\n  [2, \\"<g a>(5,8)\\"]\\n).note()"],"name":"arrange","longname":"arrange","kind":"function","scope":"global"},{"comment":"/**\\n * Similarly to \`arrange\`, allows you to arrange multiple patterns together over multiple cycles.\\n * Unlike \`arrange\`, you specify a start and stop time for each pattern rather than duration, which\\n * means that patterns can overlap.\\n * @return {Pattern}\\n * @example\\nseqPLoop([0, 2, \\"bd(3,8)\\"],\\n         [1, 3, \\"cp(3,8)\\"]\\n        )\\n  .sound()\\n */","meta":{"range":[44444,44868],"filename":"pattern.mjs","lineno":1480,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029104","name":"exports.seqPLoop","type":"FunctionDeclaration","paramnames":["parts"]}},"description":"<p>Similarly to <code>arrange</code>, allows you to arrange multiple patterns together over multiple cycles.\\nUnlike <code>arrange</code>, you specify a start and stop time for each pattern rather than duration, which\\nmeans that patterns can overlap.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["seqPLoop([0, 2, \\"bd(3,8)\\"],\\n         [1, 3, \\"cp(3,8)\\"]\\n        )\\n  .sound()"],"name":"seqPLoop","longname":"seqPLoop","kind":"function","scope":"global"},{"comment":"/** See \`fastcat\` */","meta":{"range":[45171,45235],"filename":"pattern.mjs","lineno":1512,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029247","name":"exports.sequence","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>See <code>fastcat</code></p>","name":"sequence","longname":"sequence","kind":"function","scope":"global"},{"comment":"/** Like **cat**, but the items are crammed into one cycle.\\n * @synonyms sequence, fastcat\\n * @example\\n * seq(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n * // \\"e5 b4 [d5 c5]\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").seq(\\n *   note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[45502,45561],"filename":"pattern.mjs","lineno":1529,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029258","name":"exports.seq","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Like <strong>cat</strong>, but the items are crammed into one cycle.</p>","synonyms_text":"sequence, fastcat","synonyms":["sequence","fastcat"],"examples":["seq(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n// \\"e5 b4 [d5 c5]\\".note()","// As a chained function:\\ns(\\"hh*4\\").seq(\\n  note(\\"c4(5,8)\\")\\n)"],"name":"seq","longname":"seq","kind":"function","scope":"global"},{"comment":"/**\\n * Registers a new pattern method. The method is added to the Pattern class + the standalone function is returned from register.\\n *\\n * @param {string | string[]} name name of the function, or an array of names to be used as synonyms\\n * @param {function} func function with 1 or more params, where last is the current pattern\\n * @noAutocomplete\\n *\\n */","meta":{"range":[48191,50867],"filename":"pattern.mjs","lineno":1593,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029890","name":"exports.register","type":"FunctionDeclaration","paramnames":["name","func","patternify","preserveSteps","join"]}},"description":"<p>Registers a new pattern method. The method is added to the Pattern class + the standalone function is returned from register.</p>","params":[{"type":{"names":["string","Array.<string>"]},"description":"<p>name of the function, or an array of names to be used as synonyms</p>","name":"name"},{"type":{"names":["function"]},"description":"<p>function with 1 or more params, where last is the current pattern</p>","name":"func"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"register","longname":"register","kind":"function","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values rounded\\n * to the nearest integer.\\n * @name round\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * n(\\"0.5 1.5 2.5\\".round()).scale(\\"C:major\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1686,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values rounded\\nto the nearest integer.</p>","name":"round","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0.5 1.5 2.5\\".round()).scale(\\"C:major\\")"],"scope":"static","longname":"Pattern.round","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values set to\\n * their mathematical floor. E.g. \`3.7\` replaced with to \`3\`, and \`-4.2\`\\n * replaced with \`-5\`.\\n * @name floor\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"42 42.1 42.5 43\\".floor())\\n */","meta":{"filename":"pattern.mjs","lineno":1699,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values set to\\ntheir mathematical floor. E.g. <code>3.7</code> replaced with to <code>3</code>, and <code>-4.2</code>\\nreplaced with <code>-5</code>.</p>","name":"floor","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"42 42.1 42.5 43\\".floor())"],"scope":"static","longname":"Pattern.floor","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values set to\\n * their mathematical ceiling. E.g. \`3.2\` replaced with \`4\`, and \`-4.2\`\\n * replaced with \`-4\`.\\n * @name ceil\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"42 42.1 42.5 43\\".ceil())\\n */","meta":{"filename":"pattern.mjs","lineno":1713,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values set to\\ntheir mathematical ceiling. E.g. <code>3.2</code> replaced with <code>4</code>, and <code>-4.2</code>\\nreplaced with <code>-4</code>.</p>","name":"ceil","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"42 42.1 42.5 43\\".ceil())"],"scope":"static","longname":"Pattern.ceil","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 ..\\n * 1. Returns a new pattern with values scaled to the bipolar range -1 .. 1\\n * @returns Pattern\\n * @noAutocomplete\\n */","meta":{"range":[52512,52616],"filename":"pattern.mjs","lineno":1732,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030406","name":"exports.toBipolar","type":"VariableDeclaration"}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 ..</p>\\n<ol>\\n<li>Returns a new pattern with values scaled to the bipolar range -1 .. 1</li>\\n</ol>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"toBipolar","longname":"toBipolar","kind":"constant","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\n * Returns a new pattern with values scaled to the unipolar range 0 .. 1\\n * @returns Pattern\\n * @noAutocomplete\\n */","meta":{"range":[52817,52927],"filename":"pattern.mjs","lineno":1742,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030428","name":"exports.fromBipolar","type":"VariableDeclaration"}},"description":"<p>Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\nReturns a new pattern with values scaled to the unipolar range 0 .. 1</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"fromBipolar","longname":"fromBipolar","kind":"constant","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 .. 1.\\n * Returns a new pattern with values scaled to the given min/max range.\\n * Most useful in combination with continuous patterns.\\n * @name range\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine.range(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1746,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 .. 1.\\nReturns a new pattern with values scaled to the given min/max range.\\nMost useful in combination with continuous patterns.</p>","name":"range","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine.range(500,4000))"],"scope":"static","longname":"Pattern.range","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 .. 1\\n * Returns a new pattern with values scaled to the given min/max range,\\n * following an exponential curve.\\n * @name rangex\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine.rangex(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1761,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 .. 1\\nReturns a new pattern with values scaled to the given min/max range,\\nfollowing an exponential curve.</p>","name":"rangex","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine.rangex(500,4000))"],"scope":"static","longname":"Pattern.rangex","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\n * Returns a new pattern with values scaled to the given min/max range.\\n * @name range2\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine2.range2(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1776,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\nReturns a new pattern with values scaled to the given min/max range.</p>","name":"range2","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine2.range2(500,4000))"],"scope":"static","longname":"Pattern.range2","kind":"member"},{"comment":"/**\\n * Allows dividing numbers via list notation using \\":\\".\\n * Returns a new pattern with just numbers.\\n * @name ratio\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * ratio(\\"1, 5:4, 3:2\\").mul(110)\\n * .freq().s(\\"piano\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1790,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows dividing numbers via list notation using &quot;:&quot;.\\nReturns a new pattern with just numbers.</p>","name":"ratio","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["ratio(\\"1, 5:4, 3:2\\").mul(110)\\n.freq().s(\\"piano\\")"],"scope":"static","longname":"Pattern.ratio","kind":"member"},{"comment":"/** Compress each cycle into the given timespan, leaving a gap\\n * @example\\n * cat(\\n *   s(\\"bd sd\\").compress(.25,.75),\\n *   s(\\"~ bd sd ~\\")\\n * )\\n */","meta":{"range":[54920,55173],"filename":"pattern.mjs","lineno":1819,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030573","name":"exports.compress","type":"VariableDeclaration"}},"description":"<p>Compress each cycle into the given timespan, leaving a gap</p>","examples":["cat(\\n  s(\\"bd sd\\").compress(.25,.75),\\n  s(\\"~ bd sd ~\\")\\n)"],"name":"compress","longname":"compress","kind":"constant","scope":"global"},{"comment":"/**\\n * speeds up a pattern like fast, but rather than it playing multiple times as fast would it instead leaves a gap in the remaining space of the cycle. For example, the following will play the sound pattern \\"bd sn\\" only once but compressed into the first half of the cycle, i.e. twice as fast.\\n * @name fastGap\\n * @synonyms fastgap\\n * @example\\n * s(\\"bd sd\\").fastGap(2)\\n */","meta":{"filename":"pattern.mjs","lineno":1832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>speeds up a pattern like fast, but rather than it playing multiple times as fast would it instead leaves a gap in the remaining space of the cycle. For example, the following will play the sound pattern &quot;bd sn&quot; only once but compressed into the first half of the cycle, i.e. twice as fast.</p>","name":"fastGap","synonyms_text":"fastgap","synonyms":["fastgap"],"examples":["s(\\"bd sd\\").fastGap(2)"],"longname":"fastGap","kind":"member","scope":"global"},{"comment":"/**\\n * Similar to \`compress\`, but doesn't leave gaps, and the 'focus' can be bigger than a cycle\\n * @example\\n * s(\\"bd hh sd hh\\").focus(1/4, 3/4)\\n */","meta":{"range":[57064,57254],"filename":"pattern.mjs","lineno":1874,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030915","name":"exports.focus","type":"VariableDeclaration"}},"description":"<p>Similar to <code>compress</code>, but doesn't leave gaps, and the 'focus' can be bigger than a cycle</p>","examples":["s(\\"bd hh sd hh\\").focus(1/4, 3/4)"],"name":"focus","longname":"focus","kind":"constant","scope":"global"},{"comment":"/** The ply function repeats each event the given number of times.\\n * @example\\n * s(\\"bd ~ sd cp\\").ply(\\"<1 2 3>\\")\\n */","meta":{"range":[57521,57752],"filename":"pattern.mjs","lineno":1891,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030994","name":"exports.ply","type":"VariableDeclaration"}},"description":"<p>The ply function repeats each event the given number of times.</p>","examples":["s(\\"bd ~ sd cp\\").ply(\\"<1 2 3>\\")"],"name":"ply","longname":"ply","kind":"constant","scope":"global"},{"comment":"/**\\n * Speed up a pattern by the given factor. Used by \\"*\\" in mini notation.\\n *\\n * @name fast\\n * @synonyms density\\n * @memberof Pattern\\n * @param {number | Pattern} factor speed up factor\\n * @returns Pattern\\n * @example\\n * s(\\"bd hh sd hh\\").fast(2) // s(\\"[bd hh sd hh]*2\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1899,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Speed up a pattern by the given factor. Used by &quot;*&quot; in mini notation.</p>","name":"fast","synonyms_text":"density","synonyms":["density"],"memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>speed up factor</p>","name":"factor"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd hh sd hh\\").fast(2) // s(\\"[bd hh sd hh]*2\\")"],"scope":"static","longname":"Pattern.fast","kind":"member"},{"comment":"/**\\n * Both speeds up the pattern (like 'fast') and the sample playback (like 'speed').\\n * @example\\n * s(\\"bd sd:2\\").hurry(\\"<1 2 4 3>\\").slow(1.5)\\n */","meta":{"range":[58520,58629],"filename":"pattern.mjs","lineno":1929,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031107","name":"exports.hurry","type":"VariableDeclaration"}},"description":"<p>Both speeds up the pattern (like 'fast') and the sample playback (like 'speed').</p>","examples":["s(\\"bd sd:2\\").hurry(\\"<1 2 4 3>\\").slow(1.5)"],"name":"hurry","longname":"hurry","kind":"constant","scope":"global"},{"comment":"/**\\n * Slow down a pattern over the given number of cycles. Like the \\"/\\" operator in mini notation.\\n *\\n * @name slow\\n * @synonyms sparsity\\n * @memberof Pattern\\n * @param {number | Pattern} factor slow down factor\\n * @returns Pattern\\n * @example\\n * s(\\"bd hh sd hh\\").slow(2) // s(\\"[bd hh sd hh]/2\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1933,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slow down a pattern over the given number of cycles. Like the &quot;/&quot; operator in mini notation.</p>","name":"slow","synonyms_text":"sparsity","synonyms":["sparsity"],"memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>slow down factor</p>","name":"factor"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd hh sd hh\\").slow(2) // s(\\"[bd hh sd hh]/2\\")"],"scope":"static","longname":"Pattern.slow","kind":"member"},{"comment":"/**\\n * Carries out an operation 'inside' a cycle.\\n * @example\\n * \\"0 1 2 3 4 3 2 1\\".inside(4, rev).scale('C major').note()\\n * // \\"0 1 2 3 4 3 2 1\\".slow(4).rev().fast(4).scale('C major').note()\\n */","meta":{"range":[59314,59431],"filename":"pattern.mjs","lineno":1957,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031168","name":"exports.inside","type":"VariableDeclaration"}},"description":"<p>Carries out an operation 'inside' a cycle.</p>","examples":["\\"0 1 2 3 4 3 2 1\\".inside(4, rev).scale('C major').note()\\n// \\"0 1 2 3 4 3 2 1\\".slow(4).rev().fast(4).scale('C major').note()"],"name":"inside","longname":"inside","kind":"constant","scope":"global"},{"comment":"/**\\n * Carries out an operation 'outside' a cycle.\\n * @example\\n * \\"<[0 1] 2 [3 4] 5>\\".outside(4, rev).scale('C major').note()\\n * // \\"<[0 1] 2 [3 4] 5>\\".fast(4).rev().slow(4).scale('C major').note()\\n */","meta":{"range":[59635,59754],"filename":"pattern.mjs","lineno":1967,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031192","name":"exports.outside","type":"VariableDeclaration"}},"description":"<p>Carries out an operation 'outside' a cycle.</p>","examples":["\\"<[0 1] 2 [3 4] 5>\\".outside(4, rev).scale('C major').note()\\n// \\"<[0 1] 2 [3 4] 5>\\".fast(4).rev().slow(4).scale('C major').note()"],"name":"outside","longname":"outside","kind":"constant","scope":"global"},{"comment":"/**\\n * Applies the given function every n cycles, starting from the last cycle.\\n * @name lastOf\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").lastOf(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1971,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function every n cycles, starting from the last cycle.</p>","name":"lastOf","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").lastOf(4, x=>x.rev())"],"scope":"static","longname":"Pattern.lastOf","kind":"member"},{"comment":"/**\\n * Applies the given function every n cycles, starting from the first cycle.\\n * @name firstOf\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").firstOf(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1987,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function every n cycles, starting from the first cycle.</p>","name":"firstOf","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").firstOf(4, x=>x.rev())"],"scope":"static","longname":"Pattern.firstOf","kind":"member"},{"comment":"/**\\n * An alias for \`firstOf\`\\n * @name every\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").every(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1998,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>An alias for <code>firstOf</code></p>","name":"every","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").every(4, x=>x.rev())"],"scope":"static","longname":"Pattern.every","kind":"member"},{"comment":"/**\\n * Like layer, but with a single function:\\n * @name apply\\n * @memberof Pattern\\n * @example\\n * \\"<c3 eb3 g3>\\".scale('C minor').apply(scaleTranspose(\\"0,2,4\\")).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2014,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like layer, but with a single function:</p>","name":"apply","memberof":"Pattern","examples":["\\"<c3 eb3 g3>\\".scale('C minor').apply(scaleTranspose(\\"0,2,4\\")).note()"],"scope":"static","longname":"Pattern.apply","kind":"member"},{"comment":"/**\\n * Plays the pattern at the given cycles per minute.\\n * @deprecated\\n * @example\\n * s(\\"<bd sd>,hh*2\\").cpm(90) // = 90 bpm\\n */","meta":{"range":[61398,61492],"filename":"pattern.mjs","lineno":2033,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031311","name":"exports.cpm","type":"VariableDeclaration"}},"description":"<p>Plays the pattern at the given cycles per minute.</p>","deprecated":true,"examples":["s(\\"<bd sd>,hh*2\\").cpm(90) // = 90 bpm"],"name":"cpm","longname":"cpm","kind":"constant","scope":"global"},{"comment":"/**\\n * Nudge a pattern to start earlier in time. Equivalent of Tidal's <~ operator\\n *\\n * @name early\\n * @memberof Pattern\\n * @param {number | Pattern} cycles number of cycles to nudge left\\n * @returns Pattern\\n * @example\\n * \\"bd ~\\".stack(\\"hh ~\\".early(.1)).s()\\n */","meta":{"filename":"pattern.mjs","lineno":2037,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Nudge a pattern to start earlier in time. Equivalent of Tidal's &lt;~ operator</p>","name":"early","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>number of cycles to nudge left</p>","name":"cycles"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"bd ~\\".stack(\\"hh ~\\".early(.1)).s()"],"scope":"static","longname":"Pattern.early","kind":"member"},{"comment":"/**\\n * Nudge a pattern to start later in time. Equivalent of Tidal's ~> operator\\n *\\n * @name late\\n * @memberof Pattern\\n * @param {number | Pattern} cycles number of cycles to nudge right\\n * @returns Pattern\\n * @example\\n * \\"bd ~\\".stack(\\"hh ~\\".late(.1)).s()\\n */","meta":{"filename":"pattern.mjs","lineno":2057,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Nudge a pattern to start later in time. Equivalent of Tidal's ~&gt; operator</p>","name":"late","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>number of cycles to nudge right</p>","name":"cycles"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"bd ~\\".stack(\\"hh ~\\".late(.1)).s()"],"scope":"static","longname":"Pattern.late","kind":"member"},{"comment":"/**\\n * Plays a portion of a pattern, specified by the beginning and end of a time span. The new resulting pattern is played over the time period of the original pattern:\\n *\\n * @example\\n * s(\\"bd*2 hh*3 [sd bd]*2 perc\\").zoom(0.25, 0.75)\\n * // s(\\"hh*3 [sd bd]*2\\") // equivalent\\n */","meta":{"range":[62678,63097],"filename":"pattern.mjs","lineno":2084,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031404","name":"exports.zoom","type":"VariableDeclaration"}},"description":"<p>Plays a portion of a pattern, specified by the beginning and end of a time span. The new resulting pattern is played over the time period of the original pattern:</p>","examples":["s(\\"bd*2 hh*3 [sd bd]*2 perc\\").zoom(0.25, 0.75)\\n// s(\\"hh*3 [sd bd]*2\\") // equivalent"],"name":"zoom","longname":"zoom","kind":"constant","scope":"global"},{"comment":"/**\\n * Splits a pattern into the given number of slices, and plays them according to a pattern of slice numbers.\\n * Similar to \`slice\`, but slices up patterns rather than sound samples.\\n * @param {number} number of slices\\n * @param {number} slices to play\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale('c:mixolydian'))\\n *.bite(4, \\"3 2 1 0\\")\\n * @example\\n * sound(\\"bd - bd bd*2, - sd:6 - sd:5 sd:1 - [- sd:2] -, hh [- cp:7]\\")\\n  .bank(\\"RolandTR909\\").speed(1.2)\\n  .bite(4, \\"0 0 [1 2] <3 2> 0 0 [2 1] 3\\")\\n */","meta":{"range":[63730,64028],"filename":"pattern.mjs","lineno":2116,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031529","name":"exports.bite","type":"VariableDeclaration"}},"description":"<p>Splits a pattern into the given number of slices, and plays them according to a pattern of slice numbers.\\nSimilar to <code>slice</code>, but slices up patterns rather than sound samples.</p>","params":[{"type":{"names":["number"]},"description":"<p>of slices</p>","name":"number"},{"type":{"names":["number"]},"description":"<p>to play</p>","name":"slices"}],"examples":["note(\\"0 1 2 3 4 5 6 7\\".scale('c:mixolydian'))\\n.bite(4, \\"3 2 1 0\\")","sound(\\"bd - bd bd*2, - sd:6 - sd:5 sd:1 - [- sd:2] -, hh [- cp:7]\\")\\n  .bank(\\"RolandTR909\\").speed(1.2)\\n  .bite(4, \\"0 0 [1 2] <3 2> 0 0 [2 1] 3\\")"],"name":"bite","longname":"bite","kind":"constant","scope":"global"},{"comment":"/**\\n * Selects the given fraction of the pattern and repeats that part to fill the remainder of the cycle.\\n * @param {number} fraction fraction to select\\n * @example\\n * s(\\"lt ht mt cp, [hh oh]*2\\").linger(\\"<1 .5 .25 .125>\\")\\n */","meta":{"range":[64257,64499],"filename":"pattern.mjs","lineno":2137,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031594","name":"exports.linger","type":"VariableDeclaration"}},"description":"<p>Selects the given fraction of the pattern and repeats that part to fill the remainder of the cycle.</p>","params":[{"type":{"names":["number"]},"description":"<p>fraction to select</p>","name":"fraction"}],"examples":["s(\\"lt ht mt cp, [hh oh]*2\\").linger(\\"<1 .5 .25 .125>\\")"],"name":"linger","longname":"linger","kind":"constant","scope":"global"},{"comment":"/**\\n * Samples the pattern at a rate of n events per cycle. Useful for turning a continuous pattern into a discrete one.\\n * @name segment\\n * @synonyms seg\\n * @param {number} segments number of segments per cycle\\n * @example\\n * note(saw.range(40,52).segment(24))\\n */","meta":{"filename":"pattern.mjs","lineno":2151,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Samples the pattern at a rate of n events per cycle. Useful for turning a continuous pattern into a discrete one.</p>","name":"segment","synonyms_text":"seg","synonyms":["seg"],"params":[{"type":{"names":["number"]},"description":"<p>number of segments per cycle</p>","name":"segments"}],"examples":["note(saw.range(40,52).segment(24))"],"longname":"segment","kind":"member","scope":"global"},{"comment":"/**\\n * The function \`swingBy x n\` breaks each cycle into \`n\` slices, and then delays events in the second half of each slice by the amount \`x\`, which is relative to the size of the (half) slice. So if \`x\` is 0 it does nothing, \`0.5\` delays for half the note duration, and 1 will wrap around to doing nothing again. The end result is a shuffle or swing-like rhythm\\n * @param {number} subdivision\\n * @param {number} offset\\n * @example\\n * s(\\"hh*8\\").swingBy(1/3, 4)\\n */","meta":{"range":[65382,65484],"filename":"pattern.mjs","lineno":2170,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031678","name":"exports.swingBy","type":"VariableDeclaration"}},"description":"<p>The function <code>swingBy x n</code> breaks each cycle into <code>n</code> slices, and then delays events in the second half of each slice by the amount <code>x</code>, which is relative to the size of the (half) slice. So if <code>x</code> is 0 it does nothing, <code>0.5</code> delays for half the note duration, and 1 will wrap around to doing nothing again. The end result is a shuffle or swing-like rhythm</p>","params":[{"type":{"names":["number"]},"name":"subdivision"},{"type":{"names":["number"]},"name":"offset"}],"examples":["s(\\"hh*8\\").swingBy(1/3, 4)"],"name":"swingBy","longname":"swingBy","kind":"constant","scope":"global"},{"comment":"/**\\n * Shorthand for swingBy with 1/3:\\n * @param {number} subdivision\\n * @example\\n * s(\\"hh*8\\").swing(4)\\n * // s(\\"hh*8\\").swingBy(1/3, 4)\\n */","meta":{"range":[65626,65700],"filename":"pattern.mjs","lineno":2179,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031702","name":"exports.swing","type":"VariableDeclaration"}},"description":"<p>Shorthand for swingBy with 1/3:</p>","params":[{"type":{"names":["number"]},"name":"subdivision"}],"examples":["s(\\"hh*8\\").swing(4)\\n// s(\\"hh*8\\").swingBy(1/3, 4)"],"name":"swing","longname":"swing","kind":"constant","scope":"global"},{"comment":"/**\\n * Swaps 1s and 0s in a binary pattern.\\n * @name invert\\n * @synonyms inv\\n * @example\\n * s(\\"bd\\").struct(\\"1 0 0 1 0 0 1 0\\".lastOf(4, invert))\\n */","meta":{"filename":"pattern.mjs","lineno":2181,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Swaps 1s and 0s in a binary pattern.</p>","name":"invert","synonyms_text":"inv","synonyms":["inv"],"examples":["s(\\"bd\\").struct(\\"1 0 0 1 0 0 1 0\\".lastOf(4, invert))"],"longname":"invert","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the given function whenever the given pattern is in a true state.\\n * @name when\\n * @memberof Pattern\\n * @param {Pattern} binary_pat\\n * @param {function} func\\n * @returns Pattern\\n * @example\\n * \\"c3 eb3 g3\\".when(\\"<0 1>/2\\", x=>x.sub(\\"5\\")).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2198,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function whenever the given pattern is in a true state.</p>","name":"when","memberof":"Pattern","params":[{"type":{"names":["Pattern"]},"name":"binary_pat"},{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"c3 eb3 g3\\".when(\\"<0 1>/2\\", x=>x.sub(\\"5\\")).note()"],"scope":"static","longname":"Pattern.when","kind":"member"},{"comment":"/**\\n * Superimposes the function result on top of the original pattern, delayed by the given time.\\n * @name off\\n * @memberof Pattern\\n * @param {Pattern | number} time offset time\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * \\"c3 eb3 g3\\".off(1/8, x=>x.add(7)).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimposes the function result on top of the original pattern, delayed by the given time.</p>","name":"off","memberof":"Pattern","params":[{"type":{"names":["Pattern","number"]},"description":"<p>offset time</p>","name":"time"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"c3 eb3 g3\\".off(1/8, x=>x.add(7)).note()"],"scope":"static","longname":"Pattern.off","kind":"member"},{"comment":"/**\\n * Returns a new pattern where every other cycle is played once, twice as\\n * fast, and offset in time by one quarter of a cycle. Creates a kind of\\n * breakbeat feel.\\n * @returns Pattern\\n */","meta":{"range":[67010,67148],"filename":"pattern.mjs","lineno":2232,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031789","name":"exports.brak","type":"VariableDeclaration"}},"description":"<p>Returns a new pattern where every other cycle is played once, twice as\\nfast, and offset in time by one quarter of a cycle. Creates a kind of\\nbreakbeat feel.</p>","returns":[{"description":"<p>Pattern</p>"}],"name":"brak","longname":"brak","kind":"constant","scope":"global"},{"comment":"/**\\n * Reverse all haps in a pattern\\n *\\n * @name rev\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"c d e g\\").rev()\\n */","meta":{"filename":"pattern.mjs","lineno":2236,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverse all haps in a pattern</p>","name":"rev","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c d e g\\").rev()"],"scope":"static","longname":"Pattern.rev","kind":"member"},{"comment":"/** Like press, but allows you to specify the amount by which each\\n * event is shifted. pressBy(0.5) is the same as press, while\\n * pressBy(1/3) shifts each event by a third of its timespan.\\n * @example\\n * stack(s(\\"hh*4\\"),\\n *       s(\\"bd mt sd ht\\").pressBy(\\"<0 0.5 0.25>\\")\\n *      ).slow(2)\\n */","meta":{"range":[68356,68486],"filename":"pattern.mjs","lineno":2277,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031939","name":"exports.pressBy","type":"VariableDeclaration"}},"description":"<p>Like press, but allows you to specify the amount by which each\\nevent is shifted. pressBy(0.5) is the same as press, while\\npressBy(1/3) shifts each event by a third of its timespan.</p>","examples":["stack(s(\\"hh*4\\"),\\n      s(\\"bd mt sd ht\\").pressBy(\\"<0 0.5 0.25>\\")\\n     ).slow(2)"],"name":"pressBy","longname":"pressBy","kind":"constant","scope":"global"},{"comment":"/**\\n * Syncopates a rhythm, by shifting each event halfway into its timespan.\\n * @example\\n * stack(s(\\"hh*4\\"),\\n *       s(\\"bd mt sd ht\\").every(4, press)\\n *      ).slow(2)\\n */","meta":{"range":[68662,68749],"filename":"pattern.mjs","lineno":2288,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031968","name":"exports.press","type":"VariableDeclaration"}},"description":"<p>Syncopates a rhythm, by shifting each event halfway into its timespan.</p>","examples":["stack(s(\\"hh*4\\"),\\n      s(\\"bd mt sd ht\\").every(4, press)\\n     ).slow(2)"],"name":"press","longname":"press","kind":"constant","scope":"global"},{"comment":"/**\\n * Silences a pattern.\\n * @example\\n * stack(\\n *   s(\\"bd\\").hush(),\\n *   s(\\"hh*3\\")\\n * )\\n */","meta":{"range":[68845,68903],"filename":"pattern.mjs","lineno":2300,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031985","name":"Pattern.prototype.hush","type":"FunctionExpression","paramnames":[]}},"description":"<p>Silences a pattern.</p>","examples":["stack(\\n  s(\\"bd\\").hush(),\\n  s(\\"hh*3\\")\\n)"],"name":"hush","longname":"Pattern#hush","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Applies \`rev\` to a pattern every other cycle, so that the pattern alternates between forwards and backwards.\\n * @example\\n * note(\\"c d e g\\").palindrome()\\n */","meta":{"range":[69070,69195],"filename":"pattern.mjs","lineno":2309,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031995","name":"exports.palindrome","type":"VariableDeclaration"}},"description":"<p>Applies <code>rev</code> to a pattern every other cycle, so that the pattern alternates between forwards and backwards.</p>","examples":["note(\\"c d e g\\").palindrome()"],"name":"palindrome","longname":"palindrome","kind":"constant","scope":"global"},{"comment":"/**\\n * Jux with adjustable stereo width. 0 = mono, 1 = full stereo.\\n * @name juxBy\\n * @synonyms juxby\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").juxBy(\\"<0 .5 1>/2\\", rev)\\n */","meta":{"filename":"pattern.mjs","lineno":2318,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Jux with adjustable stereo width. 0 = mono, 1 = full stereo.</p>","name":"juxBy","synonyms_text":"juxby","synonyms":["juxby"],"examples":["s(\\"bd lt [~ ht] mt cp ~ bd hh\\").juxBy(\\"<0 .5 1>/2\\", rev)"],"longname":"juxBy","kind":"member","scope":"global"},{"comment":"/**\\n * The jux function creates strange stereo effects, by applying a function to a pattern, but only in the right-hand channel.\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(rev)\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(press)\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(iter(4))\\n */","meta":{"range":[70214,70310],"filename":"pattern.mjs","lineno":2348,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100032124","name":"exports.jux","type":"VariableDeclaration"}},"description":"<p>The jux function creates strange stereo effects, by applying a function to a pattern, but only in the right-hand channel.</p>","examples":["s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(rev)","s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(press)","s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(iter(4))"],"name":"jux","longname":"jux","kind":"constant","scope":"global"},{"comment":"/**\\n * Superimpose and offset multiple times, applying the given function each time.\\n * @name echoWith\\n * @synonyms echowith, stutWith, stutwith\\n * @param {number} times how many times to repeat\\n * @param {number} time cycle offset between iterations\\n * @param {function} func function to apply, given the pattern and the iteration index\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .echoWith(4, 1/8, (p,n) => p.add(n*2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2352,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimpose and offset multiple times, applying the given function each time.</p>","name":"echoWith","synonyms_text":"echowith, stutWith, stutwith","synonyms":["echowith","stutWith","stutwith"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern and the iteration index</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.echoWith(4, 1/8, (p,n) => p.add(n*2))\\n.scale(\\"C:minor\\").note()"],"longname":"echoWith","kind":"member","scope":"global"},{"comment":"/**\\n * Superimpose and offset multiple times, gradually decreasing the velocity\\n * @name echo\\n * @memberof Pattern\\n * @returns Pattern\\n * @param {number} times how many times to repeat\\n * @param {number} time cycle offset between iterations\\n * @param {number} feedback velocity multiplicator for each iteration\\n * @example\\n * s(\\"bd sd\\").echo(3, 1/6, .8)\\n */","meta":{"filename":"pattern.mjs","lineno":2371,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimpose and offset multiple times, gradually decreasing the velocity</p>","name":"echo","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"},{"type":{"names":["number"]},"description":"<p>velocity multiplicator for each iteration</p>","name":"feedback"}],"examples":["s(\\"bd sd\\").echo(3, 1/6, .8)"],"scope":"static","longname":"Pattern.echo","kind":"member"},{"comment":"/**\\n * Deprecated. Like echo, but the last 2 parameters are flipped.\\n * @name stut\\n * @param {number} times how many times to repeat\\n * @param {number} feedback velocity multiplicator for each iteration\\n * @param {number} time cycle offset between iterations\\n * @example\\n * s(\\"bd sd\\").stut(3, .8, 1/6)\\n */","meta":{"filename":"pattern.mjs","lineno":2386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Deprecated. Like echo, but the last 2 parameters are flipped.</p>","name":"stut","params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>velocity multiplicator for each iteration</p>","name":"feedback"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"}],"examples":["s(\\"bd sd\\").stut(3, .8, 1/6)"],"longname":"stut","kind":"member","scope":"global"},{"comment":"/**\\n * The plyWith function repeats each event the given number of times, applying the given function to each event.\\\\n\\n * @name plyWith\\n * @synonyms plywith\\n * @param {number} factor how many times to repeat\\n * @param {function} func function to apply, given the pattern\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .plyWith(4, (p) => p.add(2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2407,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The plyWith function repeats each event the given number of times, applying the given function to each event.\\\\n</p>","name":"plyWith","synonyms_text":"plywith","synonyms":["plywith"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"factor"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.plyWith(4, (p) => p.add(2))\\n.scale(\\"C:minor\\").note()"],"longname":"plyWith","kind":"member","scope":"global"},{"comment":"/**\\n * The plyForEach function repeats each event the given number of times, applying the given function to each event.\\n * This version of ply uses the iteration index as an argument to the function, similar to echoWith.\\n * @name plyForEach\\n * @synonyms plyforeach\\n * @param {number} factor how many times to repeat\\n * @param {function} func function to apply, given the pattern and the iteration index\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .plyForEach(4, (p,n) => p.add(n*2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2428,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The plyForEach function repeats each event the given number of times, applying the given function to each event.\\nThis version of ply uses the iteration index as an argument to the function, similar to echoWith.</p>","name":"plyForEach","synonyms_text":"plyforeach","synonyms":["plyforeach"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"factor"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern and the iteration index</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.plyForEach(4, (p,n) => p.add(n*2))\\n.scale(\\"C:minor\\").note()"],"longname":"plyForEach","kind":"member","scope":"global"},{"comment":"/**\\n * Divides a pattern into a given number of subdivisions, plays the subdivisions in order, but increments the starting subdivision each cycle. The pattern wraps to the first subdivision after the last subdivision is played.\\n * @name iter\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"0 1 2 3\\".scale('A minor')).iter(4)\\n */","meta":{"filename":"pattern.mjs","lineno":2450,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides a pattern into a given number of subdivisions, plays the subdivisions in order, but increments the starting subdivision each cycle. The pattern wraps to the first subdivision after the last subdivision is played.</p>","name":"iter","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"0 1 2 3\\".scale('A minor')).iter(4)"],"scope":"static","longname":"Pattern.iter","kind":"member"},{"comment":"/**\\n * Like \`iter\`, but plays the subdivisions in reverse order. Known as iter' in tidalcycles\\n * @name iterBack\\n * @synonyms iterback\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"0 1 2 3\\".scale('A minor')).iterBack(4)\\n */","meta":{"filename":"pattern.mjs","lineno":2477,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>iter</code>, but plays the subdivisions in reverse order. Known as iter' in tidalcycles</p>","name":"iterBack","synonyms_text":"iterback","synonyms":["iterback"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"0 1 2 3\\".scale('A minor')).iterBack(4)"],"scope":"static","longname":"Pattern.iterBack","kind":"member"},{"comment":"/**\\n * Repeats each cycle the given number of times.\\n * @name repeatCycles\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(irand(12).add(34)).segment(4).repeatCycles(2).s(\\"gm_acoustic_guitar_nylon\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2495,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Repeats each cycle the given number of times.</p>","name":"repeatCycles","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(irand(12).add(34)).segment(4).repeatCycles(2).s(\\"gm_acoustic_guitar_nylon\\")"],"scope":"static","longname":"Pattern.repeatCycles","kind":"member"},{"comment":"/**\\n * Divides a pattern into a given number of parts, then cycles through those parts in turn, applying the given function to each part in turn (one part per cycle).\\n * @name chunk\\n * @synonyms slowChunk, slowchunk\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"0 1 2 3\\".chunk(4, x=>x.add(7))\\n * .scale(\\"A:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2518,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides a pattern into a given number of parts, then cycles through those parts in turn, applying the given function to each part in turn (one part per cycle).</p>","name":"chunk","synonyms_text":"slowChunk, slowchunk","synonyms":["slowChunk","slowchunk"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2 3\\".chunk(4, x=>x.add(7))\\n.scale(\\"A:minor\\").note()"],"scope":"static","longname":"Pattern.chunk","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but cycles through the parts in reverse order. Known as chunk' in tidalcycles\\n * @name chunkBack\\n * @synonyms chunkback\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"0 1 2 3\\".chunkBack(4, x=>x.add(7))\\n * .scale(\\"A:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2549,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but cycles through the parts in reverse order. Known as chunk' in tidalcycles</p>","name":"chunkBack","synonyms_text":"chunkback","synonyms":["chunkback"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2 3\\".chunkBack(4, x=>x.add(7))\\n.scale(\\"A:minor\\").note()"],"scope":"static","longname":"Pattern.chunkBack","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but the cycles of the source pattern aren't repeated\\n * for each set of chunks.\\n * @name fastChunk\\n * @synonyms fastchunk\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"<0 8> 1 2 3 4 5 6 7\\"\\n * .fastChunk(4, x => x.color('red')).slow(2)\\n * .scale(\\"C2:major\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2568,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but the cycles of the source pattern aren't repeated\\nfor each set of chunks.</p>","name":"fastChunk","synonyms_text":"fastchunk","synonyms":["fastchunk"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 8> 1 2 3 4 5 6 7\\"\\n.fastChunk(4, x => x.color('red')).slow(2)\\n.scale(\\"C2:major\\").note()"],"scope":"static","longname":"Pattern.fastChunk","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but the function is applied to a looped subcycle of the source pattern.\\n * @name chunkInto\\n * @synonyms chunkinto\\n * @memberof Pattern\\n * @example\\n * sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n *   .bank(\\"tr909\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2589,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but the function is applied to a looped subcycle of the source pattern.</p>","name":"chunkInto","synonyms_text":"chunkinto","synonyms":["chunkinto"],"memberof":"Pattern","examples":["sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n  .bank(\\"tr909\\")"],"scope":"static","longname":"Pattern.chunkInto","kind":"member"},{"comment":"/**\\n * Like \`chunkInto\`, but moves backwards through the chunks.\\n * @name chunkBackInto\\n * @synonyms chunkbackinto\\n * @memberof Pattern\\n * @example\\n * sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n *   .bank(\\"tr909\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2602,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunkInto</code>, but moves backwards through the chunks.</p>","name":"chunkBackInto","synonyms_text":"chunkbackinto","synonyms":["chunkbackinto"],"memberof":"Pattern","examples":["sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n  .bank(\\"tr909\\")"],"scope":"static","longname":"Pattern.chunkBackInto","kind":"member"},{"comment":"/**\\n * Loops the pattern inside an \`offset\` for \`cycles\`.\\n * If you think of the entire span of time in cycles as a ribbon, you can cut a single piece and loop it.\\n * @name ribbon\\n * @synonyms rib\\n * @param {number} offset start point of loop in cycles\\n * @param {number} cycles loop length in cycles\\n * @example\\n * note(\\"<c d e f>\\").ribbon(1, 2)\\n * @example\\n * // Looping a portion of randomness\\n * n(irand(8).segment(4)).scale(\\"c:pentatonic\\").ribbon(1337, 2)\\n * @example\\n * // rhythm generator\\n * s(\\"bd!16?\\").ribbon(29,.5)\\n */","meta":{"filename":"pattern.mjs","lineno":2631,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Loops the pattern inside an <code>offset</code> for <code>cycles</code>.\\nIf you think of the entire span of time in cycles as a ribbon, you can cut a single piece and loop it.</p>","name":"ribbon","synonyms_text":"rib","synonyms":["rib"],"params":[{"type":{"names":["number"]},"description":"<p>start point of loop in cycles</p>","name":"offset"},{"type":{"names":["number"]},"description":"<p>loop length in cycles</p>","name":"cycles"}],"examples":["note(\\"<c d e f>\\").ribbon(1, 2)","// Looping a portion of randomness\\nn(irand(8).segment(4)).scale(\\"c:pentatonic\\").ribbon(1337, 2)","// rhythm generator\\ns(\\"bd!16?\\").ribbon(29,.5)"],"longname":"ribbon","kind":"member","scope":"global"},{"comment":"/**\\n * Tags each Hap with an identifier. Good for filtering. The function populates Hap.context.tags (Array).\\n * @name tag\\n * @noAutocomplete\\n * @param {string} tag anything unique\\n */","meta":{"filename":"pattern.mjs","lineno":2659,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Tags each Hap with an identifier. Good for filtering. The function populates Hap.context.tags (Array).</p>","name":"tag","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"params":[{"type":{"names":["string"]},"description":"<p>anything unique</p>","name":"tag"}],"longname":"tag","kind":"member","scope":"global"},{"comment":"/**\\n * Filters haps using the given function\\n * @name filter\\n * @param {Function} test function to test Hap\\n * @example\\n * s(\\"hh!7 oh\\").filter(hap => hap.value.s==='hh')\\n */","meta":{"filename":"pattern.mjs","lineno":2669,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filters haps using the given function</p>","name":"filter","params":[{"type":{"names":["function"]},"description":"<p>function to test Hap</p>","name":"test"}],"examples":["s(\\"hh!7 oh\\").filter(hap => hap.value.s==='hh')"],"longname":"filter","kind":"member","scope":"global"},{"comment":"/**\\n * Filters haps by their begin time\\n * @name filterWhen\\n * @noAutocomplete\\n * @param {Function} test function to test Hap.whole.begin\\n */","meta":{"filename":"pattern.mjs","lineno":2678,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filters haps by their begin time</p>","name":"filterWhen","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"params":[{"type":{"names":["function"]},"description":"<p>function to test Hap.whole.begin</p>","name":"test"}],"longname":"filterWhen","kind":"member","scope":"global"},{"comment":"/**\\n * Use within to apply a function to only a part of a pattern.\\n * @name within\\n * @param {number} start start within cycle (0 - 1)\\n * @param {number} end end within cycle (0 - 1). Must be > start\\n * @param {Function} func function to be applied to the sub-pattern\\n */","meta":{"filename":"pattern.mjs","lineno":2686,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Use within to apply a function to only a part of a pattern.</p>","name":"within","params":[{"type":{"names":["number"]},"description":"<p>start within cycle (0 - 1)</p>","name":"start"},{"type":{"names":["number"]},"description":"<p>end within cycle (0 - 1). Must be &gt; start</p>","name":"end"},{"type":{"names":["function"]},"description":"<p>function to be applied to the sub-pattern</p>","name":"func"}],"longname":"within","kind":"member","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Speeds a pattern up or down, to fit to the given number of steps per cycle.\\n * @example\\n * sound(\\"bd sd cp\\").pace(4)\\n * // The same as sound(\\"{bd sd cp}%4\\") or sound(\\"<bd sd cp>*4\\")\\n */","meta":{"range":[83036,83331],"filename":"pattern.mjs","lineno":2767,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100033504","name":"exports.pace","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Speeds a pattern up or down, to fit to the given number of steps per cycle.</p>","examples":["sound(\\"bd sd cp\\").pace(4)\\n// The same as sound(\\"{bd sd cp}%4\\") or sound(\\"<bd sd cp>*4\\")"],"name":"pace","longname":"pace","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Aligns the steps of the patterns, creating polymeters. The patterns are repeated until they all fit the cycle. For example, in the below the first pattern is repeated twice, and the second is repeated three times, to fit the lowest common multiple of six steps.\\n * @synonyms pm\\n * @example\\n * // The same as note(\\"{c eb g, c2 g2}%6\\")\\n * polymeter(\\"c eb g\\", \\"c2 g2\\").note()\\n *\\n */","meta":{"range":[84209,84717],"filename":"pattern.mjs","lineno":2810,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100033657","name":"exports.polymeter","type":"FunctionDeclaration","paramnames":["args"]}},"description":"<p><em>Experimental</em></p>\\n<p>Aligns the steps of the patterns, creating polymeters. The patterns are repeated until they all fit the cycle. For example, in the below the first pattern is repeated twice, and the second is repeated three times, to fit the lowest common multiple of six steps.</p>","synonyms_text":"pm","synonyms":["pm"],"examples":["// The same as note(\\"{c eb g, c2 g2}%6\\")\\npolymeter(\\"c eb g\\", \\"c2 g2\\").note()"],"name":"polymeter","longname":"polymeter","kind":"function","scope":"global"},{"comment":"/** 'Concatenates' patterns like \`fastcat\`, but proportional to a number of steps per cycle.\\n * The steps can either be inferred from the pattern, or provided as a [length, pattern] pair.\\n * Has the alias \`timecat\`.\\n * @name stepcat\\n * @synonyms timeCat, timecat\\n * @return {Pattern}\\n * @example\\n * stepcat([3,\\"e3\\"],[1, \\"g3\\"]).note()\\n * // the same as \\"e3@3 g3\\".note()\\n * @example\\n * stepcat(\\"bd sd cp\\",\\"hh hh\\").sound()\\n * // the same as \\"bd sd cp hh hh\\".sound()\\n */","meta":{"filename":"pattern.mjs","lineno":2832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>'Concatenates' patterns like <code>fastcat</code>, but proportional to a number of steps per cycle.\\nThe steps can either be inferred from the pattern, or provided as a [length, pattern] pair.\\nHas the alias <code>timecat</code>.</p>","name":"stepcat","synonyms_text":"timeCat, timecat","synonyms":["timeCat","timecat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["stepcat([3,\\"e3\\"],[1, \\"g3\\"]).note()\\n// the same as \\"e3@3 g3\\".note()","stepcat(\\"bd sd cp\\",\\"hh hh\\").sound()\\n// the same as \\"bd sd cp hh hh\\".sound()"],"longname":"stepcat","kind":"member","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Concatenates patterns stepwise, according to an inferred 'steps per cycle'.\\n * Similar to \`stepcat\`, but if an argument is a list, the whole pattern will alternate between the elements in the list.\\n *\\n * @return {Pattern}\\n * @example\\n * stepalt([\\"bd cp\\", \\"mt\\"], \\"bd\\").sound()\\n * // The same as \\"bd cp bd mt bd\\".sound()\\n */","meta":{"range":[86781,87328],"filename":"pattern.mjs","lineno":2898,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034028","name":"exports.stepalt","type":"FunctionDeclaration","paramnames":["groups"]}},"description":"<p><em>Experimental</em></p>\\n<p>Concatenates patterns stepwise, according to an inferred 'steps per cycle'.\\nSimilar to <code>stepcat</code>, but if an argument is a list, the whole pattern will alternate between the elements in the list.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["stepalt([\\"bd cp\\", \\"mt\\"], \\"bd\\").sound()\\n// The same as \\"bd cp bd mt bd\\".sound()"],"name":"stepalt","longname":"stepalt","kind":"function","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Takes the given number of steps from a pattern (dropping the rest).\\n * A positive number will take steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"bd cp ht mt\\".take(\\"2\\").sound()\\n * // The same as \\"bd cp\\".sound()\\n * @example\\n * \\"bd cp ht mt\\".take(\\"1 2 3\\").sound()\\n * // The same as \\"bd bd cp bd cp ht\\".sound()\\n * @example\\n * \\"bd cp ht mt\\".take(\\"-1 -2 -3\\").sound()\\n * // The same as \\"mt ht mt cp ht mt\\".sound()\\n */","meta":{"range":[87831,88323],"filename":"pattern.mjs","lineno":2930,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034169","name":"exports.take","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Takes the given number of steps from a pattern (dropping the rest).\\nA positive number will take steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"bd cp ht mt\\".take(\\"2\\").sound()\\n// The same as \\"bd cp\\".sound()","\\"bd cp ht mt\\".take(\\"1 2 3\\").sound()\\n// The same as \\"bd bd cp bd cp ht\\".sound()","\\"bd cp ht mt\\".take(\\"-1 -2 -3\\").sound()\\n// The same as \\"mt ht mt cp ht mt\\".sound()"],"name":"take","longname":"take","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Drops the given number of steps from a pattern.\\n * A positive number will drop steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"1\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"-1\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"0 1 2 3\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"0 -1 -2 -3\\").sound().bank(\\"mridangam\\")\\n */","meta":{"range":[88824,89071],"filename":"pattern.mjs","lineno":2973,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034281","name":"exports.drop","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Drops the given number of steps from a pattern.\\nA positive number will drop steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".drop(\\"1\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"-1\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"0 1 2 3\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"0 -1 -2 -3\\").sound().bank(\\"mridangam\\")"],"name":"drop","longname":"drop","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * \`extend\` is similar to \`fast\` in that it increases its density, but it also increases the step count\\n * accordingly. So \`stepcat(\\"a b\\".extend(2), \\"c d\\")\` would be the same as \`\\"a b a b c d\\"\`, whereas\\n * \`stepcat(\\"a b\\".fast(2), \\"c d\\")\` would be the same as \`\\"[a b] [a b] c d\\"\`.\\n * @example\\n * stepcat(\\n *   sound(\\"bd bd - cp\\").extend(2),\\n *   sound(\\"bd - sd -\\")\\n * ).pace(8)\\n */","meta":{"range":[89479,89594],"filename":"pattern.mjs","lineno":2997,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034343","name":"exports.extend","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p><code>extend</code> is similar to <code>fast</code> in that it increases its density, but it also increases the step count\\naccordingly. So <code>stepcat(&quot;a b&quot;.extend(2), &quot;c d&quot;)</code> would be the same as <code>&quot;a b a b c d&quot;</code>, whereas\\n<code>stepcat(&quot;a b&quot;.fast(2), &quot;c d&quot;)</code> would be the same as <code>&quot;[a b] [a b] c d&quot;</code>.</p>","examples":["stepcat(\\n  sound(\\"bd bd - cp\\").extend(2),\\n  sound(\\"bd - sd -\\")\\n).pace(8)"],"name":"extend","longname":"extend","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * \`replicate\` is similar to \`fast\` in that it increases its density, but it also increases the step count\\n * accordingly. So \`stepcat(\\"a b\\".replicate(2), \\"c d\\")\` would be the same as \`\\"a b a b c d\\"\`, whereas\\n * \`stepcat(\\"a b\\".fast(2), \\"c d\\")\` would be the same as \`\\"[a b] [a b] c d\\"\`.\\n *\\n * TODO: find out how this function differs from extend\\n * @example\\n * stepcat(\\n *   sound(\\"bd bd - cp\\").replicate(2),\\n *   sound(\\"bd - sd -\\")\\n * ).pace(8)\\n */","meta":{"range":[90070,90212],"filename":"pattern.mjs","lineno":3015,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034364","name":"exports.replicate","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p><code>replicate</code> is similar to <code>fast</code> in that it increases its density, but it also increases the step count\\naccordingly. So <code>stepcat(&quot;a b&quot;.replicate(2), &quot;c d&quot;)</code> would be the same as <code>&quot;a b a b c d&quot;</code>, whereas\\n<code>stepcat(&quot;a b&quot;.fast(2), &quot;c d&quot;)</code> would be the same as <code>&quot;[a b] [a b] c d&quot;</code>.</p>\\n<p>TODO: find out how this function differs from extend</p>","examples":["stepcat(\\n  sound(\\"bd bd - cp\\").replicate(2),\\n  sound(\\"bd - sd -\\")\\n).pace(8)"],"name":"replicate","longname":"replicate","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Expands the step size of the pattern by the given factor.\\n * @example\\n * sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").expand(\\"3 2 1 1 2 3\\").pace(8)\\n */","meta":{"range":[90393,90522],"filename":"pattern.mjs","lineno":3026,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034389","name":"exports.expand","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Expands the step size of the pattern by the given factor.</p>","examples":["sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").expand(\\"3 2 1 1 2 3\\").pace(8)"],"name":"expand","longname":"expand","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Contracts the step size of the pattern by the given factor. See also \`expand\`.\\n * @example\\n * sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").contract(\\"3 2 1 1 2 3\\").pace(8)\\n */","meta":{"range":[90726,90859],"filename":"pattern.mjs","lineno":3037,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034414","name":"exports.contract","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Contracts the step size of the pattern by the given factor. See also <code>expand</code>.</p>","examples":["sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").contract(\\"3 2 1 1 2 3\\").pace(8)"],"name":"contract","longname":"contract","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Progressively shrinks the pattern by 'n' steps until there's nothing left, or if a second value is given (using mininotation list syntax with \`:\`),\\n * that number of times.\\n * A positive number will progressively drop steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"-1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .shrink(\\"1 -1\\").pace(8)\\n\\n */","meta":{"range":[92508,92890],"filename":"pattern.mjs","lineno":3103,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034654","name":"exports.shrink","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Progressively shrinks the pattern by 'n' steps until there's nothing left, or if a second value is given (using mininotation list syntax with <code>:</code>),\\nthat number of times.\\nA positive number will progressively drop steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".shrink(\\"1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".shrink(\\"-1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".shrink(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)","note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .shrink(\\"1 -1\\").pace(8)"],"name":"shrink","longname":"shrink","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Progressively grows the pattern by 'n' steps until the full pattern is played, or if a second value is given (using mininotation list syntax with \`:\`),\\n * that number of times.\\n * A positive number will progressively grow steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"-1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .grow(\\"1 -1\\").pace(8)\\n */","meta":{"range":[93570,93985],"filename":"pattern.mjs","lineno":3141,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034720","name":"exports.grow","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Progressively grows the pattern by 'n' steps until the full pattern is played, or if a second value is given (using mininotation list syntax with <code>:</code>),\\nthat number of times.\\nA positive number will progressively grow steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".grow(\\"1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".grow(\\"-1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".grow(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)","note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .grow(\\"1 -1\\").pace(8)"],"name":"grow","longname":"grow","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n * \\n * Inserts a pattern into a list of patterns. On the first repetition it will be inserted at the end of the list, then moved backwards through the list \\n * on successive repetitions. The patterns are added together stepwise, with all repetitions taking place over a single cycle. Using \`pace\` to set the \\n * number of steps per cycle is therefore usually recommended.\\n * \\n * @return {Pattern}\\n * @example\\n * \\"[c g]\\".tour(\\"e f\\", \\"e f g\\", \\"g f e c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)\\n */","meta":{"range":[94506,94582],"filename":"pattern.mjs","lineno":3173,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034797","name":"exports.tour","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Inserts a pattern into a list of patterns. On the first repetition it will be inserted at the end of the list, then moved backwards through the list\\non successive repetitions. The patterns are added together stepwise, with all repetitions taking place over a single cycle. Using <code>pace</code> to set the\\nnumber of steps per cycle is therefore usually recommended.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"[c g]\\".tour(\\"e f\\", \\"e f g\\", \\"g f e c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)"],"name":"tour","longname":"tour","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n * \\n * 'zips' together the steps of the provided patterns. This can create a long repetition, taking place over a single, dense cycle. \\n * Using \`pace\` to set the number of steps per cycle is therefore usually recommended.\\n * \\n * @returns {Pattern}\\n * @example\\n * zip(\\"e f\\", \\"e f g\\", \\"g [f e] a f4 c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)\\n */","meta":{"range":[95182,95437],"filename":"pattern.mjs","lineno":3199,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034866","name":"exports.zip","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>'zips' together the steps of the provided patterns. This can create a long repetition, taking place over a single, dense cycle.\\nUsing <code>pace</code> to set the number of steps per cycle is therefore usually recommended.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["zip(\\"e f\\", \\"e f g\\", \\"g [f e] a f4 c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)"],"name":"zip","longname":"zip","kind":"constant","scope":"global"},{"comment":"/** Aliases for \`stepcat\` */","meta":{"range":[95468,95499],"filename":"pattern.mjs","lineno":3207,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034930","name":"exports.timecat","type":"VariableDeclaration"}},"description":"<p>Aliases for <code>stepcat</code></p>","name":"timecat","longname":"timecat","kind":"constant","scope":"global"},{"comment":"/**\\n * Cuts each sample into the given number of parts, allowing you to explore a technique known as 'granular synthesis'.\\n * It turns a pattern of samples into a pattern of parts of samples.\\n * @name chop\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\")\\n *  .chop(4)\\n *  .rev() // reverse order of chops\\n *  .loopAt(2) // fit sample into 2 cycles\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3240,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cuts each sample into the given number of parts, allowing you to explore a technique known as 'granular synthesis'.\\nIt turns a pattern of samples into a pattern of parts of samples.</p>","name":"chop","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\")\\n .chop(4)\\n .rev() // reverse order of chops\\n .loopAt(2) // fit sample into 2 cycles"],"scope":"static","longname":"Pattern.chop","kind":"member"},{"comment":"/**\\n * Cuts each sample into the given number of parts, triggering progressive portions of each sample at each loop.\\n * @name striate\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"numbers:0 numbers:1 numbers:2\\").striate(6).slow(3)\\n */","meta":{"filename":"pattern.mjs","lineno":3271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cuts each sample into the given number of parts, triggering progressive portions of each sample at each loop.</p>","name":"striate","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"numbers:0 numbers:1 numbers:2\\").striate(6).slow(3)"],"scope":"static","longname":"Pattern.striate","kind":"member"},{"comment":"/**\\n * Makes the sample fit the given number of cycles by changing the speed.\\n * @name loopAt\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\").loopAt(2)\\n */","meta":{"filename":"pattern.mjs","lineno":3289,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit the given number of cycles by changing the speed.</p>","name":"loopAt","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\").loopAt(2)"],"scope":"static","longname":"Pattern.loopAt","kind":"member"},{"comment":"/**\\n * Chops samples into the given number of slices, triggering those slices with a given pattern of slice numbers.\\n * Instead of a number, it also accepts a list of numbers from 0 to 1 to slice at specific points.\\n * @name slice\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks165\\").slice(8, \\"0 1 <2 2*2> 3 [4 0] 5 6 7\\".every(3, rev)).slow(0.75)\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks125\\").fit().slice([0,.25,.5,.75], \\"0 1 1 <2 3>\\")\\n */","meta":{"filename":"pattern.mjs","lineno":3306,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Chops samples into the given number of slices, triggering those slices with a given pattern of slice numbers.\\nInstead of a number, it also accepts a list of numbers from 0 to 1 to slice at specific points.</p>","name":"slice","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks165\\").slice(8, \\"0 1 <2 2*2> 3 [4 0] 5 6 7\\".every(3, rev)).slow(0.75)","samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks125\\").fit().slice([0,.25,.5,.75], \\"0 1 1 <2 3>\\")"],"scope":"static","longname":"Pattern.slice","kind":"member"},{"comment":"/**\\n *\\n * make something happen on event time\\n * uses browser timeout which is innacurate for audio tasks\\n * @name onTriggerTime\\n * @memberof Pattern\\n *  @returns Pattern\\n * @example\\n * s(\\"bd!8\\").onTriggerTime((hap) => {console.log(hap)})\\n */","meta":{"filename":"pattern.mjs","lineno":3340,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>make something happen on event time\\nuses browser timeout which is innacurate for audio tasks</p>","name":"onTriggerTime","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd!8\\").onTriggerTime((hap) => {console.log(hap)})"],"scope":"static","longname":"Pattern.onTriggerTime","kind":"member"},{"comment":"/**\\n * Works the same as slice, but changes the playback speed of each slice to match the duration of its step.\\n * @name splice\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks165\\")\\n * .splice(8,  \\"0 1 [2 3 0]@2 3 0@2 7\\")\\n */","meta":{"filename":"pattern.mjs","lineno":3359,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Works the same as slice, but changes the playback speed of each slice to match the duration of its step.</p>","name":"splice","examples":["samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks165\\")\\n.splice(8,  \\"0 1 [2 3 0]@2 3 0@2 7\\")"],"longname":"splice","kind":"member","scope":"global"},{"comment":"/**\\n * Makes the sample fit its event duration. Good for rhythmical loops like drum breaks.\\n * Similar to \`loopAt\`.\\n * @name fit\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes/2\\").fit()\\n */","meta":{"filename":"pattern.mjs","lineno":3395,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit its event duration. Good for rhythmical loops like drum breaks.\\nSimilar to <code>loopAt</code>.</p>","name":"fit","examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes/2\\").fit()"],"longname":"fit","kind":"member","scope":"global"},{"comment":"/**\\n * Makes the sample fit the given number of cycles and cps value, by\\n * changing the speed. Please note that at some point cps will be\\n * given by a global clock and this function will be\\n * deprecated/removed.\\n * @name loopAtCps\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\").loopAtCps(4,1.5).cps(1.5)\\n */","meta":{"filename":"pattern.mjs","lineno":3418,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit the given number of cycles and cps value, by\\nchanging the speed. Please note that at some point cps will be\\ngiven by a global clock and this function will be\\ndeprecated/removed.</p>","name":"loopAtCps","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\").loopAtCps(4,1.5).cps(1.5)"],"scope":"static","longname":"Pattern.loopAtCps","kind":"member"},{"comment":"/** exposes a custom value at query time. basically allows mutating state without evaluation */","meta":{"range":[102969,103069],"filename":"pattern.mjs","lineno":3436,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100035770","name":"exports.ref","type":"VariableDeclaration"}},"description":"<p>exposes a custom value at query time. basically allows mutating state without evaluation</p>","name":"ref","longname":"ref","kind":"constant","scope":"global"},{"comment":"/**\\n * Cross-fades between left and right from 0 to 1:\\n * - 0 = (full left, no right)\\n * - .5 = (both equal)\\n * - 1 = (no left, full right)\\n *\\n * @name xfade\\n * @example\\n * xfade(s(\\"bd*2\\"), \\"<0 .25 .5 .75 1>\\", s(\\"hh*8\\"))\\n */","meta":{"filename":"pattern.mjs","lineno":3443,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cross-fades between left and right from 0 to 1:</p>\\n<ul>\\n<li>0 = (full left, no right)</li>\\n<li>.5 = (both equal)</li>\\n<li>1 = (no left, full right)</li>\\n</ul>","name":"xfade","examples":["xfade(s(\\"bd*2\\"), \\"<0 .25 .5 .75 1>\\", s(\\"hh*8\\"))"],"longname":"xfade","kind":"member","scope":"global"},{"comment":"/**\\n * creates a structure pattern from divisions of a cycle\\n * especially useful for creating rhythms\\n * @name beat\\n * @example\\n * s(\\"bd\\").beat(\\"0,7,10\\", 16)\\n * @example\\n * s(\\"sd\\").beat(\\"4,12\\", 16)\\n */","meta":{"filename":"pattern.mjs","lineno":3467,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>creates a structure pattern from divisions of a cycle\\nespecially useful for creating rhythms</p>","name":"beat","examples":["s(\\"bd\\").beat(\\"0,7,10\\", 16)","s(\\"sd\\").beat(\\"4,12\\", 16)"],"longname":"beat","kind":"member","scope":"global"},{"comment":"/**\\n * Takes two binary rhythms represented as lists of 1s and 0s, and a number\\n * between 0 and 1 that morphs between them. The two lists should contain the same\\n * number of true values.\\n * @example\\n * sound(\\"hh\\").struct(morph([1,0,1,0,1,0,1,0], // straight rhythm\\n *                          [1,1,0,1,0,1,0], // wonky rhythm\\n *                          0.25 // creates a slightly wonky rhythm\\n *                         )\\n *                   )\\n * @example\\n * sound(\\"hh\\").struct(morph(\\"1:0:1:0:1:0:1:0\\", // straight rhythm\\n *                          \\"1:1:0:1:0:1:0\\", // wonky rhythm\\n *                          sine.slow(8) // slowly morph between the rhythms\\n *                         )\\n *                   )\\n */","meta":{"range":[106043,106281],"filename":"pattern.mjs","lineno":3548,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036170","name":"exports.morph","type":"VariableDeclaration"}},"description":"<p>Takes two binary rhythms represented as lists of 1s and 0s, and a number\\nbetween 0 and 1 that morphs between them. The two lists should contain the same\\nnumber of true values.</p>","examples":["sound(\\"hh\\").struct(morph([1,0,1,0,1,0,1,0], // straight rhythm\\n                         [1,1,0,1,0,1,0], // wonky rhythm\\n                         0.25 // creates a slightly wonky rhythm\\n                        )\\n                  )","sound(\\"hh\\").struct(morph(\\"1:0:1:0:1:0:1:0\\", // straight rhythm\\n                         \\"1:1:0:1:0:1:0\\", // wonky rhythm\\n                         sine.slow(8) // slowly morph between the rhythms\\n                        )\\n                  )"],"name":"morph","longname":"morph","kind":"constant","scope":"global"},{"comment":"/**\\n * Soft-clipping distortion\\n *\\n * @name soft\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3555,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Soft-clipping distortion</p>","name":"soft","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"soft","kind":"member","scope":"global"},{"comment":"/**\\n * Hard-clipping distortion\\n *\\n * @name hard\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3563,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Hard-clipping distortion</p>","name":"hard","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"hard","kind":"member","scope":"global"},{"comment":"/**\\n * Cubic polynomial distortion\\n *\\n * @name cubic\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3571,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cubic polynomial distortion</p>","name":"cubic","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"cubic","kind":"member","scope":"global"},{"comment":"/**\\n * Diode-emulating distortion\\n *\\n * @name diode\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3579,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Diode-emulating distortion</p>","name":"diode","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"diode","kind":"member","scope":"global"},{"comment":"/**\\n * Asymmetrical diode distortion\\n *\\n * @name asym\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3587,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Asymmetrical diode distortion</p>","name":"asym","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"asym","kind":"member","scope":"global"},{"comment":"/**\\n * Wavefolding distortion\\n *\\n * @name fold\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3595,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wavefolding distortion</p>","name":"fold","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"fold","kind":"member","scope":"global"},{"comment":"/**\\n * Wavefolding distortion composed with sinusoid\\n *\\n * @name sinefold\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3603,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wavefolding distortion composed with sinusoid</p>","name":"sinefold","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"sinefold","kind":"member","scope":"global"},{"comment":"/**\\n * Distortion via Chebyshev polynomials\\n *\\n * @name chebyshev\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3611,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Distortion via Chebyshev polynomials</p>","name":"chebyshev","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"chebyshev","kind":"member","scope":"global"},{"comment":"/** * Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\n * Similar to \`inhabit\`, but maintains the structure of the original patterns.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(\\"<0 1 2!2 3>\\".pick([\\"g a\\", \\"e f\\", \\"f g f g\\" , \\"g c d\\"]))\\n * @example\\n * sound(\\"<0 1 [2,0]>\\".pick([\\"bd sd\\", \\"cp cp\\", \\"hh hh\\"]))\\n * @example\\n * sound(\\"<0!2 [0,1] 1>\\".pick([\\"bd(3,8)\\", \\"sd sd\\"]))\\n * @example\\n * s(\\"<a!2 [a,b] b>\\".pick({a: \\"bd(3,8)\\", b: \\"sd sd\\"}))\\n */","meta":{"range":[1892,2094],"filename":"pick.mjs","lineno":44,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036387","name":"exports.pick","type":"VariableDeclaration"}},"description":"<p>Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\nSimilar to <code>inhabit</code>, but maintains the structure of the original patterns.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<0 1 2!2 3>\\".pick([\\"g a\\", \\"e f\\", \\"f g f g\\" , \\"g c d\\"]))","sound(\\"<0 1 [2,0]>\\".pick([\\"bd sd\\", \\"cp cp\\", \\"hh hh\\"]))","sound(\\"<0!2 [0,1] 1>\\".pick([\\"bd(3,8)\\", \\"sd sd\\"]))","s(\\"<a!2 [a,b] b>\\".pick({a: \\"bd(3,8)\\", b: \\"sd sd\\"}))"],"name":"pick","longname":"pick","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pick\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * For example, if you pick the fifth pattern of a list of three, you'll get the\\n * second one.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[2519,2637],"filename":"pick.mjs","lineno":65,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036432","name":"exports.pickmod","type":"VariableDeclaration"}},"description":"<p>The same as <code>pick</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.\\nFor example, if you pick the fifth pattern of a list of three, you'll get the\\nsecond one.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmod","longname":"pickmod","kind":"constant","scope":"global"},{"comment":"/** * pickF lets you use a pattern of numbers to pick which function to apply to another pattern.\\n * @param {Pattern} pat\\n * @param {Pattern} lookup a pattern of indices\\n * @param {function[]} funcs the array of functions from which to pull\\n * @returns {Pattern}\\n * @example\\n * s(\\"bd [rim hh]\\").pickF(\\"<0 1 2>\\", [rev,jux(rev),fast(2)])\\n * @example\\n * note(\\"<c2 d2>(3,8)\\").s(\\"square\\")\\n *     .pickF(\\"<0 2> 1\\", [jux(rev),fast(2),x=>x.lpf(800)])\\n */","meta":{"range":[3086,3201],"filename":"pick.mjs","lineno":80,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036452","name":"exports.pickF","type":"VariableDeclaration"}},"description":"<p>pickF lets you use a pattern of numbers to pick which function to apply to another pattern.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["Pattern"]},"description":"<p>a pattern of indices</p>","name":"lookup"},{"type":{"names":["Array.<function()>"]},"description":"<p>the array of functions from which to pull</p>","name":"funcs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["s(\\"bd [rim hh]\\").pickF(\\"<0 1 2>\\", [rev,jux(rev),fast(2)])","note(\\"<c2 d2>(3,8)\\").s(\\"square\\")\\n    .pickF(\\"<0 2> 1\\", [jux(rev),fast(2),x=>x.lpf(800)])"],"name":"pickF","longname":"pickF","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickF\`, but if you pick a number greater than the size of the functions list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {Pattern} lookup a pattern of indices\\n * @param {function[]} funcs the array of functions from which to pull\\n * @returns {Pattern}\\n */","meta":{"range":[3532,3656],"filename":"pick.mjs","lineno":91,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036473","name":"exports.pickmodF","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickF</code>, but if you pick a number greater than the size of the functions list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["Pattern"]},"description":"<p>a pattern of indices</p>","name":"lookup"},{"type":{"names":["Array.<function()>"]},"description":"<p>the array of functions from which to pull</p>","name":"funcs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodF","longname":"pickmodF","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but it applies an outerJoin instead of an innerJoin.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[3803,3922],"filename":"pick.mjs","lineno":100,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036494","name":"exports.pickOut","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but it applies an outerJoin instead of an innerJoin.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickOut","longname":"pickOut","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickOut\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[4143,4267],"filename":"pick.mjs","lineno":110,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036514","name":"exports.pickmodOut","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickOut</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodOut","longname":"pickmodOut","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but the choosen pattern is restarted when its index is triggered.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[4427,4556],"filename":"pick.mjs","lineno":119,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036534","name":"exports.pickRestart","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but the choosen pattern is restarted when its index is triggered.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickRestart","longname":"pickRestart","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickRestart\`, but if you pick a number greater than the size of the list,\\n   * it wraps around, rather than sticking at the maximum value.\\n   * @param {Pattern} pat\\n   * @param {*} xs\\n   * @returns {Pattern}\\n   * @example\\n   * \\"<a@2 b@2 c@2 d@2>\\".pickRestart({\\n        a: n(\\"0 1 2 0\\"),\\n        b: n(\\"2 3 4 ~\\"),\\n        c: n(\\"[4 5] [4 3] 2 0\\"),\\n        d: n(\\"0 -3 0 ~\\")\\n      }).scale(\\"C:major\\").s(\\"piano\\")\\n   */","meta":{"range":[4989,5123],"filename":"pick.mjs","lineno":136,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036554","name":"exports.pickmodRestart","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickRestart</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"<a@2 b@2 c@2 d@2>\\".pickRestart({\\n        a: n(\\"0 1 2 0\\"),\\n        b: n(\\"2 3 4 ~\\"),\\n        c: n(\\"[4 5] [4 3] 2 0\\"),\\n        d: n(\\"0 -3 0 ~\\")\\n      }).scale(\\"C:major\\").s(\\"piano\\")"],"name":"pickmodRestart","longname":"pickmodRestart","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but the choosen pattern is reset when its index is triggered.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[5279,5402],"filename":"pick.mjs","lineno":145,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036574","name":"exports.pickReset","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but the choosen pattern is reset when its index is triggered.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickReset","longname":"pickReset","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickReset\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[5625,5753],"filename":"pick.mjs","lineno":155,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036594","name":"exports.pickmodReset","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickReset</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodReset","longname":"pickmodReset","kind":"constant","scope":"global"},{"comment":"/** Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\n   * Similar to \`pick\`, but cycles are squeezed into the target ('inhabited') pattern.\\n   * @name inhabit\\n   * @synonyms pickSqueeze\\n   * @param {Pattern} pat\\n   * @param {*} xs\\n   * @returns {Pattern}\\n   * @example\\n   * \\"<a b [a,b]>\\".inhabit({a: s(\\"bd(3,8)\\"),\\n                            b: s(\\"cp sd\\")\\n                           })\\n   * @example\\n   * s(\\"a@2 [a b] a\\".inhabit({a: \\"bd(3,8)\\", b: \\"sd sd\\"})).slow(4)\\n   */","meta":{"filename":"pick.mjs","lineno":159,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\nSimilar to <code>pick</code>, but cycles are squeezed into the target ('inhabited') pattern.</p>","name":"inhabit","synonyms_text":"pickSqueeze","synonyms":["pickSqueeze"],"params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"<a b [a,b]>\\".inhabit({a: s(\\"bd(3,8)\\"),\\n                            b: s(\\"cp sd\\")\\n                           })","s(\\"a@2 [a b] a\\".inhabit({a: \\"bd(3,8)\\", b: \\"sd sd\\"})).slow(4)"],"longname":"inhabit","kind":"member","scope":"global"},{"comment":"/** * The same as \`inhabit\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * For example, if you pick the fifth pattern of a list of three, you'll get the\\n * second one.\\n * @name inhabitmod\\n * @synonyms pickmodSqueeze\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"filename":"pick.mjs","lineno":177,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The same as <code>inhabit</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.\\nFor example, if you pick the fifth pattern of a list of three, you'll get the\\nsecond one.</p>","name":"inhabitmod","synonyms_text":"pickmodSqueeze","synonyms":["pickmodSqueeze"],"params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"longname":"inhabitmod","kind":"member","scope":"global"},{"comment":"/**\\n * Pick from the list of values (or patterns of values) via the index using the given\\n * pattern of integers. The selected pattern will be compressed to fit the duration of the selecting event\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(squeeze(\\"<0@2 [1!2] 2>\\", [\\"g a\\", \\"f g f g\\" , \\"g a c d\\"]))\\n */","meta":{"range":[7302,7543],"filename":"pick.mjs","lineno":202,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036666","name":"exports.squeeze","type":"VariableDeclaration"}},"description":"<p>Pick from the list of values (or patterns of values) via the index using the given\\npattern of integers. The selected pattern will be compressed to fit the duration of the selecting event</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(squeeze(\\"<0@2 [1!2] 2>\\", [\\"g a\\", \\"f g f g\\" , \\"g a c d\\"]))"],"name":"squeeze","longname":"squeeze","kind":"constant","scope":"global"},{"comment":"/**\\n   * Changes the global tempo to the given cycles per minute\\n   *\\n   * @name setcpm\\n   * @alias setCpm\\n   * @param {number} cpm cycles per minute\\n   * @example\\n   * setcpm(140/4) // =140 bpm in 4/4\\n   * $: s(\\"bd*4,[- sd]*2\\").bank('tr707')\\n   */","meta":{"filename":"repl.mjs","lineno":101,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the global tempo to the given cycles per minute</p>","name":"setcpm","alias":"setCpm","params":[{"type":{"names":["number"]},"description":"<p>cycles per minute</p>","name":"cpm"}],"examples":["setcpm(140/4) // =140 bpm in 4/4\\n$: s(\\"bd*4,[- sd]*2\\").bank('tr707')"],"longname":"setcpm","kind":"member","scope":"global"},{"comment":"/** Applies a function to all the running patterns. Note that the patterns are groups together into a single \`stack\` before the function is applied. This is probably what you want, but see \`each\` for\\n   * a version that applies the function to each pattern separately.\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * all(fast(\\"<2 3>\\"))\\n   * \`\`\`\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * all(x => x.pianoroll())\\n   * \`\`\`\\n   */","meta":{"range":[3428,3446],"filename":"repl.mjs","lineno":131,"columnno":6,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037065","name":"allTransforms","type":"ArrayExpression","value":"[]"}},"description":"<p>Applies a function to all the running patterns. Note that the patterns are groups together into a single <code>stack</code> before the function is applied. This is probably what you want, but see <code>each</code> for\\na version that applies the function to each pattern separately.</p>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\nall(fast(&quot;&lt;2 3>&quot;))\\n</code></pre>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\nall(x => x.pianoroll())\\n</code></pre>","name":"allTransforms","longname":"repl~allTransforms","kind":"member","memberof":"repl","scope":"inner","params":[]},{"comment":"/** Applies a function to each of the running patterns separately. This is intended for future use with upcoming 'stepwise' features. See \`all\` for a version that applies the function to all the patterns stacked together into a single pattern.\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * each(fast(\\"<2 3>\\"))\\n   * \`\`\`\\n   */","meta":{"range":[3898,3982],"filename":"repl.mjs","lineno":143,"columnno":8,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037083","name":"each","type":"FunctionExpression"},"vars":{"eachTransform":"repl~each~eachTransform"}},"description":"<p>Applies a function to each of the running patterns separately. This is intended for future use with upcoming 'stepwise' features. See <code>all</code> for a version that applies the function to all the patterns stacked together into a single pattern.</p>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\neach(fast(&quot;&lt;2 3>&quot;))\\n</code></pre>","name":"each","longname":"repl~each","kind":"function","memberof":"repl","scope":"inner","params":[]},{"comment":"/**\\n *  A sawtooth signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n * .clip(saw.slow(2))\\n * @example\\n * n(saw.range(0,8).segment(8))\\n * .scale('C major')\\n *\\n */","meta":{"range":[1533,1573],"filename":"signal.mjs","lineno":35,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037731","name":"exports.saw","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n.clip(saw.slow(2))","n(saw.range(0,8).segment(8))\\n.scale('C major')"],"name":"saw","longname":"saw","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between -1 and 1 (like \`saw\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[1673,1709],"filename":"signal.mjs","lineno":42,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037742","name":"exports.saw2","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between -1 and 1 (like <code>saw</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"saw2","longname":"saw2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between 1 and 0 (like \`saw\`, but flipped).\\n *\\n * @return {Pattern}\\n * @example\\n * note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n * .clip(isaw.slow(2))\\n * @example\\n * n(isaw.range(0,8).segment(8))\\n * .scale('C major')\\n *\\n */","meta":{"range":[1951,1998],"filename":"signal.mjs","lineno":56,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037750","name":"exports.isaw","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 1 and 0 (like <code>saw</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n.clip(isaw.slow(2))","n(isaw.range(0,8).segment(8))\\n.scale('C major')"],"name":"isaw","longname":"isaw","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between 1 and -1 (like \`saw2\`, but flipped).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2099,2137],"filename":"signal.mjs","lineno":63,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037763","name":"exports.isaw2","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 1 and -1 (like <code>saw2</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"isaw2","longname":"isaw2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sine signal between -1 and 1 (like \`sine\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2234,2296],"filename":"signal.mjs","lineno":70,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037771","name":"exports.sine2","type":"VariableDeclaration"}},"description":"<p>A sine signal between -1 and 1 (like <code>sine</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"sine2","longname":"sine2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sine signal between 0 and 1.\\n * @return {Pattern}\\n * @example\\n * n(sine.segment(16).range(0,15))\\n * .scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2433,2473],"filename":"signal.mjs","lineno":80,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037790","name":"exports.sine","type":"VariableDeclaration"}},"description":"<p>A sine signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(sine.segment(16).range(0,15))\\n.scale(\\"C:minor\\")"],"name":"sine","longname":"sine","kind":"constant","scope":"global"},{"comment":"/**\\n *  A cosine signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * n(stack(sine,cosine).segment(16).range(0,15))\\n * .scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2629,2683],"filename":"signal.mjs","lineno":91,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037798","name":"exports.cosine","type":"VariableDeclaration"}},"description":"<p>A cosine signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(stack(sine,cosine).segment(16).range(0,15))\\n.scale(\\"C:minor\\")"],"name":"cosine","longname":"cosine","kind":"constant","scope":"global"},{"comment":"/**\\n *  A cosine signal between -1 and 1 (like \`cosine\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2784,2840],"filename":"signal.mjs","lineno":98,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037813","name":"exports.cosine2","type":"VariableDeclaration"}},"description":"<p>A cosine signal between -1 and 1 (like <code>cosine</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"cosine2","longname":"cosine2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A square signal between 0 and 1.\\n * @return {Pattern}\\n * @example\\n * n(square.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2975,3036],"filename":"signal.mjs","lineno":107,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037828","name":"exports.square","type":"VariableDeclaration"}},"description":"<p>A square signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(square.segment(4).range(0,7)).scale(\\"C:minor\\")"],"name":"square","longname":"square","kind":"constant","scope":"global"},{"comment":"/**\\n *  A square signal between -1 and 1 (like \`square\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3137,3179],"filename":"signal.mjs","lineno":114,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037845","name":"exports.square2","type":"VariableDeclaration"}},"description":"<p>A square signal between -1 and 1 (like <code>square</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"square2","longname":"square2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A triangle signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * n(tri.segment(8).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[3316,3354],"filename":"signal.mjs","lineno":124,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037853","name":"exports.tri","type":"VariableDeclaration"}},"description":"<p>A triangle signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(tri.segment(8).range(0,7)).scale(\\"C:minor\\")"],"name":"tri","longname":"tri","kind":"constant","scope":"global"},{"comment":"/**\\n *  A triangle signal between -1 and 1 (like \`tri\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3454,3495],"filename":"signal.mjs","lineno":131,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037861","name":"exports.tri2","type":"VariableDeclaration"}},"description":"<p>A triangle signal between -1 and 1 (like <code>tri</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"tri2","longname":"tri2","kind":"constant","scope":"global"},{"comment":"/**\\n *  An inverted triangle signal between 1 and 0 (like \`tri\`, but flipped).\\n *\\n * @return {Pattern}\\n * @example\\n * n(itri.segment(8).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[3669,3708],"filename":"signal.mjs","lineno":141,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037869","name":"exports.itri","type":"VariableDeclaration"}},"description":"<p>An inverted triangle signal between 1 and 0 (like <code>tri</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(itri.segment(8).range(0,7)).scale(\\"C:minor\\")"],"name":"itri","longname":"itri","kind":"constant","scope":"global"},{"comment":"/**\\n *  An inverted triangle signal between -1 and 1 (like \`itri\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3819,3861],"filename":"signal.mjs","lineno":148,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037877","name":"exports.itri2","type":"VariableDeclaration"}},"description":"<p>An inverted triangle signal between -1 and 1 (like <code>itri</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"itri2","longname":"itri2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A signal representing the cycle time.\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3937,3968],"filename":"signal.mjs","lineno":155,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037885","name":"exports.time","type":"VariableDeclaration"}},"description":"<p>A signal representing the cycle time.</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"time","longname":"time","kind":"constant","scope":"global"},{"comment":"/**\\n *  The mouse's x position value ranges from 0 to 1.\\n * @name mousex\\n * @return {Pattern}\\n * @example\\n * n(mousex.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":157,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The mouse's x position value ranges from 0 to 1.</p>","name":"mousex","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(mousex.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"mousex","kind":"member","scope":"global"},{"comment":"/**\\n *  The mouse's y position value ranges from 0 to 1.\\n * @name mousey\\n * @return {Pattern}\\n * @example\\n * n(mousey.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":166,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The mouse's y position value ranges from 0 to 1.</p>","name":"mousey","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(mousey.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"mousey","kind":"member","scope":"global"},{"comment":"/**\\n * A discrete pattern of numbers from 0 to n-1\\n * @example\\n * n(run(4)).scale(\\"C4:pentatonic\\")\\n * // n(\\"0 1 2 3\\").scale(\\"C4:pentatonic\\")\\n */","meta":{"range":[5663,5724],"filename":"signal.mjs","lineno":228,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038102","name":"exports.run","type":"VariableDeclaration"}},"description":"<p>A discrete pattern of numbers from 0 to n-1</p>","examples":["n(run(4)).scale(\\"C4:pentatonic\\")\\n// n(\\"0 1 2 3\\").scale(\\"C4:pentatonic\\")"],"name":"run","longname":"run","kind":"constant","scope":"global"},{"comment":"/**\\n * Creates a pattern from a binary number.\\n *\\n * @name binary\\n * @param {number} n - input number to convert to binary\\n * @example\\n * \\"hh\\".s().struct(binary(5))\\n * // \\"hh\\".s().struct(\\"1 0 1\\")\\n */","meta":{"filename":"signal.mjs","lineno":230,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Creates a pattern from a binary number.</p>","name":"binary","params":[{"type":{"names":["number"]},"description":"<p>input number to convert to binary</p>","name":"n"}],"examples":["\\"hh\\".s().struct(binary(5))\\n// \\"hh\\".s().struct(\\"1 0 1\\")"],"longname":"binary","kind":"member","scope":"global"},{"comment":"/**\\n * Creates a pattern from a binary number, padded to n bits long.\\n *\\n * @name binaryN\\n * @param {number} n - input number to convert to binary\\n * @param {number} nBits - pattern length, defaults to 16\\n * @example\\n * \\"hh\\".s().struct(binaryN(55532, 16))\\n * // \\"hh\\".s().struct(\\"1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 0\\")\\n */","meta":{"filename":"signal.mjs","lineno":244,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Creates a pattern from a binary number, padded to n bits long.</p>","name":"binaryN","params":[{"type":{"names":["number"]},"description":"<p>input number to convert to binary</p>","name":"n"},{"type":{"names":["number"]},"description":"<p>pattern length, defaults to 16</p>","name":"nBits"}],"examples":["\\"hh\\".s().struct(binaryN(55532, 16))\\n// \\"hh\\".s().struct(\\"1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 0\\")"],"longname":"binaryN","kind":"member","scope":"global"},{"comment":"/**\\n * Slices a pattern into the given number of parts, then plays those parts in random order.\\n * Each part will be played exactly once per cycle.\\n * @name shuffle\\n * @example\\n * note(\\"c d e f\\").sound(\\"piano\\").shuffle(4)\\n * @example\\n * seq(\\"c d e f\\".shuffle(4), \\"g\\").note().sound(\\"piano\\")\\n */","meta":{"filename":"signal.mjs","lineno":279,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slices a pattern into the given number of parts, then plays those parts in random order.\\nEach part will be played exactly once per cycle.</p>","name":"shuffle","examples":["note(\\"c d e f\\").sound(\\"piano\\").shuffle(4)","seq(\\"c d e f\\".shuffle(4), \\"g\\").note().sound(\\"piano\\")"],"longname":"shuffle","kind":"member","scope":"global"},{"comment":"/**\\n * Slices a pattern into the given number of parts, then plays those parts at random. Similar to \`shuffle\`,\\n * but parts might be played more than once, or not at all, per cycle.\\n * @name scramble\\n * @example\\n * note(\\"c d e f\\").sound(\\"piano\\").scramble(4)\\n * @example\\n * seq(\\"c d e f\\".scramble(4), \\"g\\").note().sound(\\"piano\\")\\n */","meta":{"filename":"signal.mjs","lineno":292,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slices a pattern into the given number of parts, then plays those parts at random. Similar to <code>shuffle</code>,\\nbut parts might be played more than once, or not at all, per cycle.</p>","name":"scramble","examples":["note(\\"c d e f\\").sound(\\"piano\\").scramble(4)","seq(\\"c d e f\\".scramble(4), \\"g\\").note().sound(\\"piano\\")"],"longname":"scramble","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random numbers, between 0 and 1.\\n *\\n * @name rand\\n * @example\\n * // randomly change the cutoff\\n * s(\\"bd*4,hh*8\\").cutoff(rand.range(500,8000))\\n *\\n */","meta":{"filename":"signal.mjs","lineno":305,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of random numbers, between 0 and 1.</p>","name":"rand","examples":["// randomly change the cutoff\\ns(\\"bd*4,hh*8\\").cutoff(rand.range(500,8000))"],"longname":"rand","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random numbers, between -1 and 1\\n */","meta":{"range":[8355,8393],"filename":"signal.mjs","lineno":318,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038410","name":"exports.rand2","type":"VariableDeclaration"}},"description":"<p>A continuous pattern of random numbers, between -1 and 1</p>","name":"rand2","longname":"rand2","kind":"constant","scope":"global"},{"comment":"/**\\n * A continuous pattern of 0 or 1 (binary random), with a probability for the value being 1\\n *\\n * @name brandBy\\n * @param {number} probability - a number between 0 and 1\\n * @example\\n * s(\\"hh*10\\").pan(brandBy(0.2))\\n */","meta":{"filename":"signal.mjs","lineno":322,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of 0 or 1 (binary random), with a probability for the value being 1</p>","name":"brandBy","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"probability"}],"examples":["s(\\"hh*10\\").pan(brandBy(0.2))"],"longname":"brandBy","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of 0 or 1 (binary random)\\n *\\n * @name brand\\n * @example\\n * s(\\"hh*10\\").pan(brand)\\n */","meta":{"filename":"signal.mjs","lineno":332,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of 0 or 1 (binary random)</p>","name":"brand","examples":["s(\\"hh*10\\").pan(brand)"],"longname":"brand","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random integers, between 0 and n-1.\\n *\\n * @name irand\\n * @param {number} n max value (exclusive)\\n * @example\\n * // randomly select scale notes from 0 - 7 (= C to C)\\n * n(irand(8)).struct(\\"x x*2 x x*3\\").scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":343,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of random integers, between 0 and n-1.</p>","name":"irand","params":[{"type":{"names":["number"]},"description":"<p>max value (exclusive)</p>","name":"n"}],"examples":["// randomly select scale notes from 0 - 7 (= C to C)\\nn(irand(8)).struct(\\"x x*2 x x*3\\").scale(\\"C:minor\\")"],"longname":"irand","kind":"member","scope":"global"},{"comment":"/**\\n * Choose from the list of values (or patterns of values) using the given\\n * pattern of numbers, which should be in the range of 0..1\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(chooseWith(sine.fast(2), [\\"sawtooth\\", \\"triangle\\", \\"bd:6\\"]))\\n */","meta":{"range":[9855,9942],"filename":"signal.mjs","lineno":375,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038557","name":"exports.chooseWith","type":"VariableDeclaration"}},"description":"<p>Choose from the list of values (or patterns of values) using the given\\npattern of numbers, which should be in the range of 0..1</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(chooseWith(sine.fast(2), [\\"sawtooth\\", \\"triangle\\", \\"bd:6\\"]))"],"name":"chooseWith","longname":"chooseWith","kind":"constant","scope":"global"},{"comment":"/**\\n * As with {chooseWith}, but the structure comes from the chosen values, rather\\n * than the pattern you're using to choose with.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[10144,10233],"filename":"signal.mjs","lineno":386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038573","name":"exports.chooseInWith","type":"VariableDeclaration"}},"description":"<p>As with {chooseWith}, but the structure comes from the chosen values, rather\\nthan the pattern you're using to choose with.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"chooseInWith","longname":"chooseInWith","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses randomly from the given list of elements.\\n * @param  {...any} xs values / patterns to choose from.\\n * @returns {Pattern} - a continuous pattern.\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(choose(\\"sine\\", \\"triangle\\", \\"bd:6\\"))\\n */","meta":{"range":[10474,10528],"filename":"signal.mjs","lineno":397,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038589","name":"exports.choose","type":"VariableDeclaration"}},"description":"<p>Chooses randomly from the given list of elements.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>values / patterns to choose from.</p>","name":"xs"}],"returns":[{"type":{"names":["Pattern"]},"description":"<ul>\\n<li>a continuous pattern.</li>\\n</ul>"}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(choose(\\"sine\\", \\"triangle\\", \\"bd:6\\"))"],"name":"choose","longname":"choose","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses from the given list of values (or patterns of values), according\\n * to the pattern that the method is called on. The pattern should be in\\n * the range 0 .. 1.\\n * @param  {...any} xs\\n * @returns {Pattern}\\n */","meta":{"range":[10859,10937],"filename":"signal.mjs","lineno":410,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038617","name":"Pattern.prototype.choose","type":"FunctionExpression","paramnames":["xs"]}},"description":"<p>Chooses from the given list of values (or patterns of values), according\\nto the pattern that the method is called on. The pattern should be in\\nthe range 0 .. 1.</p>","params":[{"type":{"names":["any"]},"variable":true,"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"choose","longname":"Pattern#choose","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * As with choose, but the pattern that this method is called on should be\\n * in the range -1 .. 1\\n * @param  {...any} xs\\n * @returns {Pattern}\\n */","meta":{"range":[11092,11185],"filename":"signal.mjs","lineno":420,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038633","name":"Pattern.prototype.choose2","type":"FunctionExpression","paramnames":["xs"]}},"description":"<p>As with choose, but the pattern that this method is called on should be\\nin the range -1 .. 1</p>","params":[{"type":{"names":["any"]},"variable":true,"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"choose2","longname":"Pattern#choose2","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Picks one of the elements at random each cycle.\\n * @synonyms randcat\\n * @returns {Pattern}\\n * @example\\n * chooseCycles(\\"bd\\", \\"hh\\", \\"sd\\").s().fast(8)\\n * @example\\n * s(\\"bd | hh | sd\\").fast(8)\\n */","meta":{"range":[11389,11462],"filename":"signal.mjs","lineno":433,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038651","name":"exports.chooseCycles","type":"VariableDeclaration"}},"description":"<p>Picks one of the elements at random each cycle.</p>","synonyms_text":"randcat","synonyms":["randcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["chooseCycles(\\"bd\\", \\"hh\\", \\"sd\\").s().fast(8)","s(\\"bd | hh | sd\\").fast(8)"],"name":"chooseCycles","longname":"chooseCycles","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses randomly from the given list of elements by giving a probability to each element\\n * @param {...any} pairs arrays of value and weight\\n * @returns {Pattern} - a continuous pattern.\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(wchoose([\\"sine\\",10], [\\"triangle\\",1], [\\"bd:6\\",1]))\\n */","meta":{"range":[12754,12819],"filename":"signal.mjs","lineno":473,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038789","name":"exports.wchoose","type":"VariableDeclaration"}},"description":"<p>Chooses randomly from the given list of elements by giving a probability to each element</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>arrays of value and weight</p>","name":"pairs"}],"returns":[{"type":{"names":["Pattern"]},"description":"<ul>\\n<li>a continuous pattern.</li>\\n</ul>"}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(wchoose([\\"sine\\",10], [\\"triangle\\",1], [\\"bd:6\\",1]))"],"name":"wchoose","longname":"wchoose","kind":"constant","scope":"global"},{"comment":"/**\\n * Picks one of the elements at random each cycle by giving a probability to each element\\n * @synonyms wrandcat\\n * @returns {Pattern}\\n * @example\\n * wchooseCycles([\\"bd\\",10], [\\"hh\\",1], [\\"sd\\",1]).s().fast(8)\\n * @example\\n * wchooseCycles([\\"bd bd bd\\",5], [\\"hh hh hh\\",3], [\\"sd sd sd\\",1]).fast(4).s()\\n * @example\\n * // The probability can itself be a pattern\\n * wchooseCycles([\\"bd(3,8)\\",\\"<5 0>\\"], [\\"hh hh hh\\",3]).fast(4).s()\\n */","meta":{"range":[13248,13343],"filename":"signal.mjs","lineno":487,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038801","name":"exports.wchooseCycles","type":"VariableDeclaration"}},"description":"<p>Picks one of the elements at random each cycle by giving a probability to each element</p>","synonyms_text":"wrandcat","synonyms":["wrandcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["wchooseCycles([\\"bd\\",10], [\\"hh\\",1], [\\"sd\\",1]).s().fast(8)","wchooseCycles([\\"bd bd bd\\",5], [\\"hh hh hh\\",3], [\\"sd sd sd\\",1]).fast(4).s()","// The probability can itself be a pattern\\nwchooseCycles([\\"bd(3,8)\\",\\"<5 0>\\"], [\\"hh hh hh\\",3]).fast(4).s()"],"name":"wchooseCycles","longname":"wchooseCycles","kind":"constant","scope":"global"},{"comment":"/**\\n * Generates a continuous pattern of [perlin noise](https://en.wikipedia.org/wiki/Perlin_noise), in the range 0..1.\\n *\\n * @name perlin\\n * @example\\n * // randomly change the cutoff\\n * s(\\"bd*4,hh*8\\").cutoff(perlin.range(500,8000))\\n *\\n */","meta":{"filename":"signal.mjs","lineno":521,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Generates a continuous pattern of <a href=\\"https://en.wikipedia.org/wiki/Perlin_noise\\">perlin noise</a>, in the range 0..1.</p>","name":"perlin","examples":["// randomly change the cutoff\\ns(\\"bd*4,hh*8\\").cutoff(perlin.range(500,8000))"],"longname":"perlin","kind":"member","scope":"global"},{"comment":"/**\\n * Generates a continuous pattern of [berlin noise](conceived by Jame Coyne and Jade Rowland as a joke but turned out to be surprisingly cool and useful,\\n * like perlin noise but with sawtooth waves), in the range 0..1.\\n *\\n * @name berlin\\n * @example\\n * // ascending arpeggios\\n * n(\\"0!16\\".add(berlin.fast(4).mul(14))).scale(\\"d:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":532,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Generates a continuous pattern of [berlin noise](conceived by Jame Coyne and Jade Rowland as a joke but turned out to be surprisingly cool and useful,\\nlike perlin noise but with sawtooth waves), in the range 0..1.</p>","name":"berlin","examples":["// ascending arpeggios\\nn(\\"0!16\\".add(berlin.fast(4).mul(14))).scale(\\"d:minor\\")"],"longname":"berlin","kind":"member","scope":"global"},{"comment":"/**\\n * Randomly removes events from the pattern by a given amount.\\n * 0 = 0% chance of removal\\n * 1 = 100% chance of removal\\n *\\n * @name degradeBy\\n * @memberof Pattern\\n * @param {number} amount - a number between 0 and 1\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").degradeBy(0.2)\\n * @example\\n * s(\\"[hh?0.2]*8\\")\\n * @example\\n * //beat generator\\n * s(\\"bd\\").segment(16).degradeBy(.5).ribbon(16,1)\\n */","meta":{"filename":"signal.mjs","lineno":551,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly removes events from the pattern by a given amount.\\n0 = 0% chance of removal\\n1 = 100% chance of removal</p>","name":"degradeBy","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").degradeBy(0.2)","s(\\"[hh?0.2]*8\\")","//beat generator\\ns(\\"bd\\").segment(16).degradeBy(.5).ribbon(16,1)"],"scope":"static","longname":"Pattern.degradeBy","kind":"member"},{"comment":"/**\\n *\\n * Randomly removes 50% of events from the pattern. Shorthand for \`.degradeBy(0.5)\`\\n *\\n * @name degrade\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").degrade()\\n * @example\\n * s(\\"[hh?]*8\\")\\n */","meta":{"filename":"signal.mjs","lineno":577,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly removes 50% of events from the pattern. Shorthand for <code>.degradeBy(0.5)</code></p>","name":"degrade","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").degrade()","s(\\"[hh?]*8\\")"],"scope":"static","longname":"Pattern.degrade","kind":"member"},{"comment":"/**\\n * Inverse of \`degradeBy\`: Randomly removes events from the pattern by a given amount.\\n * 0 = 100% chance of removal\\n * 1 = 0% chance of removal\\n * Events that would be removed by degradeBy are let through by undegradeBy and vice versa (see second example).\\n *\\n * @name undegradeBy\\n * @memberof Pattern\\n * @param {number} amount - a number between 0 and 1\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").undegradeBy(0.2)\\n * @example\\n * s(\\"hh*10\\").layer(\\n *   x => x.degradeBy(0.2).pan(0),\\n *   x => x.undegradeBy(0.8).pan(1)\\n * )\\n */","meta":{"filename":"signal.mjs","lineno":591,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Inverse of <code>degradeBy</code>: Randomly removes events from the pattern by a given amount.\\n0 = 100% chance of removal\\n1 = 0% chance of removal\\nEvents that would be removed by degradeBy are let through by undegradeBy and vice versa (see second example).</p>","name":"undegradeBy","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").undegradeBy(0.2)","s(\\"hh*10\\").layer(\\n  x => x.degradeBy(0.2).pan(0),\\n  x => x.undegradeBy(0.8).pan(1)\\n)"],"scope":"static","longname":"Pattern.undegradeBy","kind":"member"},{"comment":"/**\\n * Inverse of \`degrade\`: Randomly removes 50% of events from the pattern. Shorthand for \`.undegradeBy(0.5)\`\\n * Events that would be removed by degrade are let through by undegrade and vice versa (see second example).\\n *\\n * @name undegrade\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").undegrade()\\n * @example\\n * s(\\"hh*10\\").layer(\\n *   x => x.degrade().pan(0),\\n *   x => x.undegrade().pan(1)\\n * )\\n */","meta":{"filename":"signal.mjs","lineno":621,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Inverse of <code>degrade</code>: Randomly removes 50% of events from the pattern. Shorthand for <code>.undegradeBy(0.5)</code>\\nEvents that would be removed by degrade are let through by undegrade and vice versa (see second example).</p>","name":"undegrade","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").undegrade()","s(\\"hh*10\\").layer(\\n  x => x.degrade().pan(0),\\n  x => x.undegrade().pan(1)\\n)"],"scope":"static","longname":"Pattern.undegrade","kind":"member"},{"comment":"/**\\n *\\n * Randomly applies the given function by the given probability.\\n * Similar to \`someCyclesBy\`\\n *\\n * @name sometimesBy\\n * @memberof Pattern\\n * @param {number | Pattern} probability - a number between 0 and 1\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").sometimesBy(.4, x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly applies the given function by the given probability.\\nSimilar to <code>someCyclesBy</code></p>","name":"sometimesBy","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>a number between 0 and 1</p>","name":"probability"},{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").sometimesBy(.4, x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.sometimesBy","kind":"member"},{"comment":"/**\\n *\\n * Applies the given function with a 50% chance\\n *\\n * @name sometimes\\n * @memberof Pattern\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").sometimes(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":658,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function with a 50% chance</p>","name":"sometimes","memberof":"Pattern","params":[{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").sometimes(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.sometimes","kind":"member"},{"comment":"/**\\n *\\n * Randomly applies the given function by the given probability on a cycle by cycle basis.\\n * Similar to \`sometimesBy\`\\n *\\n * @name someCyclesBy\\n * @memberof Pattern\\n * @param {number | Pattern} probability - a number between 0 and 1\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"bd,hh*8\\").someCyclesBy(.3, x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":673,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly applies the given function by the given probability on a cycle by cycle basis.\\nSimilar to <code>sometimesBy</code></p>","name":"someCyclesBy","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>a number between 0 and 1</p>","name":"probability"},{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd,hh*8\\").someCyclesBy(.3, x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.someCyclesBy","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.someCyclesBy(0.5, fn)\`\\n *\\n * @name someCycles\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"bd,hh*8\\").someCycles(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":698,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.someCyclesBy(0.5, fn)</code></p>","name":"someCycles","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd,hh*8\\").someCycles(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.someCycles","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.75, fn)\`\\n *\\n * @name often\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").often(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":712,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.75, fn)</code></p>","name":"often","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").often(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.often","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.25, fn)\`\\n *\\n * @name rarely\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").rarely(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":726,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.25, fn)</code></p>","name":"rarely","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").rarely(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.rarely","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.1, fn)\`\\n *\\n * @name almostNever\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").almostNever(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":740,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.1, fn)</code></p>","name":"almostNever","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").almostNever(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.almostNever","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.9, fn)\`\\n *\\n * @name almostAlways\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").almostAlways(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":754,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.9, fn)</code></p>","name":"almostAlways","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").almostAlways(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.almostAlways","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0, fn)\` (never calls fn)\\n *\\n * @name never\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").never(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":768,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0, fn)</code> (never calls fn)</p>","name":"never","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").never(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.never","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(1, fn)\` (always calls fn)\\n *\\n * @name always\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").always(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":782,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(1, fn)</code> (always calls fn)</p>","name":"always","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").always(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.always","kind":"member"},{"comment":"/**\\n *\\n * Do something on a keypress, or array of keypresses\\n * [Key name reference](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values)\\n *\\n * @name whenKey\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"bd(5,8)\\").whenKey(\\"Control:j\\", x => x.segment(16).color(\\"red\\")).whenKey(\\"Control:i\\", x => x.fast(2).color(\\"blue\\"))\\n */","meta":{"filename":"signal.mjs","lineno":809,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Do something on a keypress, or array of keypresses\\n<a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\\">Key name reference</a></p>","name":"whenKey","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd(5,8)\\").whenKey(\\"Control:j\\", x => x.segment(16).color(\\"red\\")).whenKey(\\"Control:i\\", x => x.fast(2).color(\\"blue\\"))"],"scope":"static","longname":"Pattern.whenKey","kind":"member"},{"comment":"/**\\n *\\n * returns true when a key or array of keys is held\\n * [Key name reference](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values)\\n *\\n * @name keyDown\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * keyDown(\\"Control:j\\").pick([s(\\"bd(5,8)\\"), s(\\"cp(3,8)\\")])\\n */","meta":{"filename":"signal.mjs","lineno":825,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>returns true when a key or array of keys is held\\n<a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\\">Key name reference</a></p>","name":"keyDown","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["keyDown(\\"Control:j\\").pick([s(\\"bd(5,8)\\"), s(\\"cp(3,8)\\")])"],"scope":"static","longname":"Pattern.keyDown","kind":"member"},{"comment":"/**\\n * @deprecated does not appear to be referenced or invoked anywhere in the codebase\\n * @noAutocomplete\\n */","meta":{"range":[2816,2983],"filename":"util.mjs","lineno":73,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100052618","name":"exports.getFreq","type":"VariableDeclaration"}},"deprecated":"does not appear to be referenced or invoked anywhere in the codebase","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"getFreq","longname":"getFreq","kind":"constant","scope":"global"},{"comment":"/**\\n * @deprecated only used in workshop (first-notes)\\n * @noAutocomplete\\n */","meta":{"range":[3142,3261],"filename":"util.mjs","lineno":85,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100052657","name":"exports.midi2note","type":"VariableDeclaration"}},"deprecated":"only used in workshop (first-notes)","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"midi2note","longname":"midi2note","kind":"constant","scope":"global"},{"comment":"/**\\n * Sends notes to Csound for rendering with MIDI semantics. The hap value is\\n * translated to these Csound pfields:\\n *\\n *  p1 -- Csound instrument either as a number (1-based, can be a fraction),\\n *        or as a string name.\\n *  p2 -- time in beats (usually seconds) from start of performance.\\n *  p3 -- duration in beats (usually seconds).\\n *  p4 -- MIDI key number (as a real number, not an integer but in [0, 127].\\n *  p5 -- MIDI velocity (as a real number, not an integer but in [0, 127].\\n *  p6 -- Strudel controls, as a string.\\n */","meta":{"range":[4679,6063],"filename":"index.mjs","lineno":139,"columnno":0,"path":"/home/alex/src/strudel/packages/csound","code":{"id":"astnode100055261","name":"exports.csoundm","type":"VariableDeclaration"}},"description":"<p>Sends notes to Csound for rendering with MIDI semantics. The hap value is\\ntranslated to these Csound pfields:</p>\\n<p>p1 -- Csound instrument either as a number (1-based, can be a fraction),\\nor as a string name.\\np2 -- time in beats (usually seconds) from start of performance.\\np3 -- duration in beats (usually seconds).\\np4 -- MIDI key number (as a real number, not an integer but in [0, 127].\\np5 -- MIDI velocity (as a real number, not an integer but in [0, 127].\\np6 -- Strudel controls, as a string.</p>","name":"csoundm","longname":"csoundm","kind":"constant","scope":"global"},{"comment":"/**\\n * Visualises a pattern as a scrolling 'pianoroll', displayed in the background of the editor. To show a pianoroll for all running patterns, use \`all(pianoroll)\`. To have a pianoroll appear below\\n * a pattern instead, prefix with \`_\`, e.g.: \`sound(\\"bd sd\\")._pianoroll()\`.\\n *\\n * @name pianoroll\\n * @synonyms punchcard\\n * @param {Object} options Object containing all the optional following parameters as key value pairs:\\n * @param {integer} cycles number of cycles to be displayed at the same time - defaults to 4\\n * @param {number} playhead location of the active notes on the time axis - 0 to 1, defaults to 0.5\\n * @param {boolean} vertical displays the roll vertically - 0 by default\\n * @param {boolean} labels displays labels on individual notes (see the label function) - 0 by default\\n * @param {boolean} flipTime reverse the direction of the roll - 0 by default\\n * @param {boolean} flipValues reverse the relative location of notes on the value axis - 0 by default\\n * @param {number} overscan lookup X cycles outside of the cycles window to display notes in advance - 1 by default\\n * @param {boolean} hideNegative hide notes with negative time (before starting playing the pattern) - 0 by default\\n * @param {boolean} smear notes leave a solid trace - 0 by default\\n * @param {boolean} fold notes takes the full value axis width - 0 by default\\n * @param {string} active hexadecimal or CSS color of the active notes - defaults to #FFCA28\\n * @param {string} inactive hexadecimal or CSS color of the inactive notes - defaults to #7491D2\\n * @param {string} background hexadecimal or CSS color of the background - defaults to transparent\\n * @param {string} playheadColor hexadecimal or CSS color of the line representing the play head - defaults to white\\n * @param {boolean} fill notes are filled with color (otherwise only the label is displayed) - 0 by default\\n * @param {boolean} fillActive active notes are filled with color - 0 by default\\n * @param {boolean} stroke notes are shown with colored borders - 0 by default\\n * @param {boolean} strokeActive active notes are shown with colored borders - 0 by default\\n * @param {boolean} hideInactive only active notes are shown - 0 by default\\n * @param {boolean} colorizeInactive use note color for inactive notes - 1 by default\\n * @param {string} fontFamily define the font used by notes labels - defaults to 'monospace'\\n * @param {integer} minMidi minimum note value to display on the value axis - defaults to 10\\n * @param {integer} maxMidi maximum note value to display on the value axis - defaults to 90\\n * @param {boolean} autorange automatically calculate the minMidi and maxMidi parameters - 0 by default\\n * @see _pianoroll\\n * @example\\n * note(\\"c2 a2 eb2\\")\\n * .euclid(5,8)\\n * .s('sawtooth')\\n * .lpenv(4).lpf(300)\\n * .pianoroll({ labels: 1 })\\n */","meta":{"filename":"pianoroll.mjs","lineno":39,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Visualises a pattern as a scrolling 'pianoroll', displayed in the background of the editor. To show a pianoroll for all running patterns, use <code>all(pianoroll)</code>. To have a pianoroll appear below\\na pattern instead, prefix with <code>_</code>, e.g.: <code>sound(&quot;bd sd&quot;)._pianoroll()</code>.</p>","name":"pianoroll","synonyms_text":"punchcard","synonyms":["punchcard"],"params":[{"type":{"names":["Object"]},"description":"<p>Object containing all the optional following parameters as key value pairs:</p>","name":"options"},{"type":{"names":["integer"]},"description":"<p>number of cycles to be displayed at the same time - defaults to 4</p>","name":"cycles"},{"type":{"names":["number"]},"description":"<p>location of the active notes on the time axis - 0 to 1, defaults to 0.5</p>","name":"playhead"},{"type":{"names":["boolean"]},"description":"<p>displays the roll vertically - 0 by default</p>","name":"vertical"},{"type":{"names":["boolean"]},"description":"<p>displays labels on individual notes (see the label function) - 0 by default</p>","name":"labels"},{"type":{"names":["boolean"]},"description":"<p>reverse the direction of the roll - 0 by default</p>","name":"flipTime"},{"type":{"names":["boolean"]},"description":"<p>reverse the relative location of notes on the value axis - 0 by default</p>","name":"flipValues"},{"type":{"names":["number"]},"description":"<p>lookup X cycles outside of the cycles window to display notes in advance - 1 by default</p>","name":"overscan"},{"type":{"names":["boolean"]},"description":"<p>hide notes with negative time (before starting playing the pattern) - 0 by default</p>","name":"hideNegative"},{"type":{"names":["boolean"]},"description":"<p>notes leave a solid trace - 0 by default</p>","name":"smear"},{"type":{"names":["boolean"]},"description":"<p>notes takes the full value axis width - 0 by default</p>","name":"fold"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the active notes - defaults to #FFCA28</p>","name":"active"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the inactive notes - defaults to #7491D2</p>","name":"inactive"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the background - defaults to transparent</p>","name":"background"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the line representing the play head - defaults to white</p>","name":"playheadColor"},{"type":{"names":["boolean"]},"description":"<p>notes are filled with color (otherwise only the label is displayed) - 0 by default</p>","name":"fill"},{"type":{"names":["boolean"]},"description":"<p>active notes are filled with color - 0 by default</p>","name":"fillActive"},{"type":{"names":["boolean"]},"description":"<p>notes are shown with colored borders - 0 by default</p>","name":"stroke"},{"type":{"names":["boolean"]},"description":"<p>active notes are shown with colored borders - 0 by default</p>","name":"strokeActive"},{"type":{"names":["boolean"]},"description":"<p>only active notes are shown - 0 by default</p>","name":"hideInactive"},{"type":{"names":["boolean"]},"description":"<p>use note color for inactive notes - 1 by default</p>","name":"colorizeInactive"},{"type":{"names":["string"]},"description":"<p>define the font used by notes labels - defaults to 'monospace'</p>","name":"fontFamily"},{"type":{"names":["integer"]},"description":"<p>minimum note value to display on the value axis - defaults to 10</p>","name":"minMidi"},{"type":{"names":["integer"]},"description":"<p>maximum note value to display on the value axis - defaults to 90</p>","name":"maxMidi"},{"type":{"names":["boolean"]},"description":"<p>automatically calculate the minMidi and maxMidi parameters - 0 by default</p>","name":"autorange"}],"see":["_pianoroll"],"examples":["note(\\"c2 a2 eb2\\")\\n.euclid(5,8)\\n.s('sawtooth')\\n.lpenv(4).lpf(300)\\n.pianoroll({ labels: 1 })"],"longname":"pianoroll","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a vertical pianoroll with event labels.\\n * Supports all the same options as pianoroll.\\n *\\n * @name wordfall\\n */","meta":{"filename":"pianoroll.mjs","lineno":297,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Displays a vertical pianoroll with event labels.\\nSupports all the same options as pianoroll.</p>","name":"wordfall","longname":"wordfall","kind":"member","scope":"global"},{"comment":"/**\\n * Renders a pitch circle to visualize frequencies within one octave\\n * @name pitchwheel\\n * @param {number} hapcircles\\n * @param {number} circle\\n * @param {number} edo\\n * @param {string} root\\n * @param {number} thickness\\n * @param {number} hapRadius\\n * @param {string} mode\\n * @param {number} margin\\n * @example\\n * n(\\"0 .. 12\\").scale(\\"C:chromatic\\")\\n * .s(\\"sawtooth\\")\\n * .lpf(500)\\n * ._pitchwheel()\\n */","meta":{"filename":"pitchwheel.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Renders a pitch circle to visualize frequencies within one octave</p>","name":"pitchwheel","params":[{"type":{"names":["number"]},"name":"hapcircles"},{"type":{"names":["number"]},"name":"circle"},{"type":{"names":["number"]},"name":"edo"},{"type":{"names":["string"]},"name":"root"},{"type":{"names":["number"]},"name":"thickness"},{"type":{"names":["number"]},"name":"hapRadius"},{"type":{"names":["string"]},"name":"mode"},{"type":{"names":["number"]},"name":"margin"}],"examples":["n(\\"0 .. 12\\").scale(\\"C:chromatic\\")\\n.s(\\"sawtooth\\")\\n.lpf(500)\\n._pitchwheel()"],"longname":"pitchwheel","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a spiral visual.\\n *\\n * @name spiral\\n * @param {Object} options Object containing all the optional following parameters as key value pairs:\\n * @param {number} stretch controls the rotations per cycle ratio, where 1 = 1 cycle / 360 degrees\\n * @param {number} size the diameter of the spiral\\n * @param {number} thickness line thickness\\n * @param {string} cap style of line ends: butt (default), round, square\\n * @param {string} inset number of rotations before spiral starts (default 3)\\n * @param {string} playheadColor color of playhead, defaults to white\\n * @param {number} playheadLength length of playhead in rotations, defaults to 0.02\\n * @param {number} playheadThickness thickness of playheadrotations, defaults to thickness\\n * @param {number} padding space around spiral\\n * @param {number} steady steadyness of spiral vs playhead. 1 = spiral doesn't move, playhead does.\\n * @param {number} activeColor color of active segment. defaults to foreground of theme\\n * @param {number} inactiveColor color of inactive segments. defaults to gutterForeground of theme\\n * @param {boolean} colorizeInactive wether or not to colorize inactive segments, defaults to 0\\n * @param {boolean} fade wether or not past and future should fade out. defaults to 1\\n * @param {boolean} logSpiral wether or not the spiral should be logarithmic. defaults to 0\\n * @example\\n * note(\\"c2 a2 eb2\\")\\n * .euclid(5,8)\\n * .s('sawtooth')\\n * .lpenv(4).lpf(300)\\n * ._spiral({ steady: .96 })\\n */","meta":{"filename":"spiral.mjs","lineno":128,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Displays a spiral visual.</p>","name":"spiral","params":[{"type":{"names":["Object"]},"description":"<p>Object containing all the optional following parameters as key value pairs:</p>","name":"options"},{"type":{"names":["number"]},"description":"<p>controls the rotations per cycle ratio, where 1 = 1 cycle / 360 degrees</p>","name":"stretch"},{"type":{"names":["number"]},"description":"<p>the diameter of the spiral</p>","name":"size"},{"type":{"names":["number"]},"description":"<p>line thickness</p>","name":"thickness"},{"type":{"names":["string"]},"description":"<p>style of line ends: butt (default), round, square</p>","name":"cap"},{"type":{"names":["string"]},"description":"<p>number of rotations before spiral starts (default 3)</p>","name":"inset"},{"type":{"names":["string"]},"description":"<p>color of playhead, defaults to white</p>","name":"playheadColor"},{"type":{"names":["number"]},"description":"<p>length of playhead in rotations, defaults to 0.02</p>","name":"playheadLength"},{"type":{"names":["number"]},"description":"<p>thickness of playheadrotations, defaults to thickness</p>","name":"playheadThickness"},{"type":{"names":["number"]},"description":"<p>space around spiral</p>","name":"padding"},{"type":{"names":["number"]},"description":"<p>steadyness of spiral vs playhead. 1 = spiral doesn't move, playhead does.</p>","name":"steady"},{"type":{"names":["number"]},"description":"<p>color of active segment. defaults to foreground of theme</p>","name":"activeColor"},{"type":{"names":["number"]},"description":"<p>color of inactive segments. defaults to gutterForeground of theme</p>","name":"inactiveColor"},{"type":{"names":["boolean"]},"description":"<p>wether or not to colorize inactive segments, defaults to 0</p>","name":"colorizeInactive"},{"type":{"names":["boolean"]},"description":"<p>wether or not past and future should fade out. defaults to 1</p>","name":"fade"},{"type":{"names":["boolean"]},"description":"<p>wether or not the spiral should be logarithmic. defaults to 0</p>","name":"logSpiral"}],"examples":["note(\\"c2 a2 eb2\\")\\n.euclid(5,8)\\n.s('sawtooth')\\n.lpenv(4).lpf(300)\\n._spiral({ steady: .96 })"],"longname":"spiral","kind":"member","scope":"global"},{"comment":"/**\\n * configures the default midimap, which is used when no \\"midimap\\" port is set\\n * @example\\n * defaultmidimap({ lpf: 74 })\\n * $: note(\\"c a f e\\").midi();\\n * $: lpf(sine.slow(4).segment(16)).midi();\\n */","meta":{"range":[4416,4515],"filename":"midi.mjs","lineno":131,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063183","name":"exports.defaultmidimap","type":"FunctionDeclaration","paramnames":["mapping"]}},"description":"<p>configures the default midimap, which is used when no &quot;midimap&quot; port is set</p>","examples":["defaultmidimap({ lpf: 74 })\\n$: note(\\"c a f e\\").midi();\\n$: lpf(sine.slow(4).segment(16)).midi();"],"name":"defaultmidimap","longname":"defaultmidimap","kind":"function","scope":"global"},{"comment":"/**\\n * Adds midimaps to the registry. Inside each midimap, control names (e.g. lpf) are mapped to cc numbers.\\n * @example\\n * midimaps({ mymap: { lpf: 74 } })\\n * $: note(\\"c a f e\\")\\n * .lpf(sine.slow(4))\\n * .midimap('mymap')\\n * .midi()\\n * @example\\n * midimaps({ mymap: {\\n *   lpf: { ccn: 74, min: 0, max: 20000, exp: 0.5 }\\n * }})\\n * $: note(\\"c a f e\\")\\n * .lpf(sine.slow(2).range(400,2000))\\n * .midimap('mymap')\\n * .midi()\\n */","meta":{"range":[4962,5392],"filename":"midi.mjs","lineno":154,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063201","name":"exports.midimaps","type":"FunctionDeclaration","paramnames":["map"]}},"description":"<p>Adds midimaps to the registry. Inside each midimap, control names (e.g. lpf) are mapped to cc numbers.</p>","examples":["midimaps({ mymap: { lpf: 74 } })\\n$: note(\\"c a f e\\")\\n.lpf(sine.slow(4))\\n.midimap('mymap')\\n.midi()","midimaps({ mymap: {\\n  lpf: { ccn: 74, min: 0, max: 20000, exp: 0.5 }\\n}})\\n$: note(\\"c a f e\\")\\n.lpf(sine.slow(2).range(400,2000))\\n.midimap('mymap')\\n.midi()"],"name":"midimaps","longname":"midimaps","kind":"function","scope":"global"},{"comment":"/**\\n * MIDI output: Opens a MIDI output port.\\n * @param {string | number} midiport MIDI device name or index defaulting to 0\\n * @param {object} options Additional MIDI configuration options\\n * @example\\n * note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1')\\n * @example\\n * note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1', { controller: true, latency: 50 })\\n */","meta":{"range":[10343,16473],"filename":"midi.mjs","lineno":289,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063852","name":"Pattern.prototype.midi","type":"FunctionExpression","paramnames":["midiport","options"]},"vars":{"undefined":null,"options":"Pattern#midi~options","midiport":"Pattern#midi~midiport","midiConfig":"Pattern#midi~midiConfig","":null}},"description":"<p>MIDI output: Opens a MIDI output port.</p>","params":[{"type":{"names":["string","number"]},"description":"<p>MIDI device name or index defaulting to 0</p>","name":"midiport"},{"type":{"names":["object"]},"description":"<p>Additional MIDI configuration options</p>","name":"options"}],"examples":["note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1')","note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1', { controller: true, latency: 50 })"],"name":"midi","longname":"Pattern#midi","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * MIDI input: Opens a MIDI input port to receive MIDI control change messages.\\n * @param {string | number} input MIDI device name or index defaulting to 0\\n * @returns {Function}\\n * @example\\n * let cc = await midin('IAC Driver Bus 1')\\n * note(\\"c a f e\\").lpf(cc(0).range(0, 1000)).lpq(cc(1).range(0, 10)).sound(\\"sawtooth\\")\\n */","meta":{"range":[16844,18118],"filename":"midi.mjs","lineno":474,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100064501","name":"exports.midin","type":"FunctionDeclaration","paramnames":["input"]}},"description":"<p>MIDI input: Opens a MIDI input port to receive MIDI control change messages.</p>","params":[{"type":{"names":["string","number"]},"description":"<p>MIDI device name or index defaulting to 0</p>","name":"input"}],"returns":[{"type":{"names":["function"]}}],"examples":["let cc = await midin('IAC Driver Bus 1')\\nnote(\\"c a f e\\").lpf(cc(0).range(0, 1000)).lpq(cc(1).range(0, 10)).sound(\\"sawtooth\\")"],"name":"midin","longname":"midin","kind":"function","scope":"global"},{"comment":"/**\\n *  The accelerometer's x-axis value ranges from 0 to 1.\\n * @name accelerationX\\n * @return {Pattern}\\n * @synonyms accX\\n * @example\\n * n(accelerationX.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":5,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's x-axis value ranges from 0 to 1.</p>","name":"accelerationX","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accX","synonyms":["accX"],"examples":["n(accelerationX.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationX","kind":"member","scope":"global"},{"comment":"/**\\n *  The accelerometer's y-axis value ranges from 0 to 1.\\n * @name accelerationY\\n * @return {Pattern}\\n * @synonyms accY\\n * @example\\n * n(accelerationY.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":15,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's y-axis value ranges from 0 to 1.</p>","name":"accelerationY","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accY","synonyms":["accY"],"examples":["n(accelerationY.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationY","kind":"member","scope":"global"},{"comment":"/**\\n *  The accelerometer's z-axis value ranges from 0 to 1.\\n * @name accelerationZ\\n * @return {Pattern}\\n * @synonyms accZ\\n * @example\\n * n(accelerationZ.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":25,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's z-axis value ranges from 0 to 1.</p>","name":"accelerationZ","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accZ","synonyms":["accZ"],"examples":["n(accelerationZ.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationZ","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity x-axis value ranges from 0 to 1.\\n * @name gravityX\\n * @return {Pattern}\\n * @synonyms gravX\\n * @example\\n * n(gravityX.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":35,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity x-axis value ranges from 0 to 1.</p>","name":"gravityX","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravX","synonyms":["gravX"],"examples":["n(gravityX.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityX","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity y-axis value ranges from 0 to 1.\\n * @name gravityY\\n * @return {Pattern}\\n * @synonyms gravY\\n * @example\\n * n(gravityY.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":45,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity y-axis value ranges from 0 to 1.</p>","name":"gravityY","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravY","synonyms":["gravY"],"examples":["n(gravityY.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityY","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity z-axis value ranges from 0 to 1.\\n * @name gravityZ\\n * @return {Pattern}\\n * @synonyms gravZ\\n * @example\\n * n(gravityZ.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":55,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity z-axis value ranges from 0 to 1.</p>","name":"gravityZ","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravZ","synonyms":["gravZ"],"examples":["n(gravityZ.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityZ","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the alpha-axis value ranges from 0 to 1.\\n * @name rotationAlpha\\n * @return {Pattern}\\n * @synonyms rotA, rotZ, rotationZ\\n * @example\\n * n(rotationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":65,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the alpha-axis value ranges from 0 to 1.</p>","name":"rotationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotA, rotZ, rotationZ","synonyms":["rotA","rotZ","rotationZ"],"examples":["n(rotationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the beta-axis value ranges from 0 to 1.\\n * @name rotationBeta\\n * @return {Pattern}\\n * @synonyms rotB, rotX, rotationX\\n * @example\\n * n(rotationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":75,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the beta-axis value ranges from 0 to 1.</p>","name":"rotationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotB, rotX, rotationX","synonyms":["rotB","rotX","rotationX"],"examples":["n(rotationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the gamma-axis value ranges from 0 to 1.\\n * @name rotationGamma\\n * @return {Pattern}\\n * @synonyms rotG, rotY, rotationY\\n * @example\\n * n(rotationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":85,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the gamma-axis value ranges from 0 to 1.</p>","name":"rotationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotG, rotY, rotationY","synonyms":["rotG","rotY","rotationY"],"examples":["n(rotationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation alpha value ranges from 0 to 1.\\n * @name orientationAlpha\\n * @return {Pattern}\\n * @synonyms oriA, oriZ, orientationZ\\n * @example\\n * n(orientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":95,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation alpha value ranges from 0 to 1.</p>","name":"orientationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriA, oriZ, orientationZ","synonyms":["oriA","oriZ","orientationZ"],"examples":["n(orientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation beta value ranges from 0 to 1.\\n * @name orientationBeta\\n * @return {Pattern}\\n * @synonyms oriB, oriX, orientationX\\n * @example\\n * n(orientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":105,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation beta value ranges from 0 to 1.</p>","name":"orientationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriB, oriX, orientationX","synonyms":["oriB","oriX","orientationX"],"examples":["n(orientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation gamma value ranges from 0 to 1.\\n * @name orientationGamma\\n * @return {Pattern}\\n * @synonyms oriG, oriY, orientationY\\n * @example\\n * n(orientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":115,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation gamma value ranges from 0 to 1.</p>","name":"orientationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriG, oriY, orientationY","synonyms":["oriG","oriY","orientationY"],"examples":["n(orientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation alpha value ranges from 0 to 1.\\n * @name absoluteOrientationAlpha\\n * @return {Pattern}\\n * @synonyms absOriA, absOriZ, absoluteOrientationZ\\n * @example\\n * n(absoluteOrientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":125,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation alpha value ranges from 0 to 1.</p>","name":"absoluteOrientationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriA, absOriZ, absoluteOrientationZ","synonyms":["absOriA","absOriZ","absoluteOrientationZ"],"examples":["n(absoluteOrientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation beta value ranges from 0 to 1.\\n * @name absoluteOrientationBeta\\n * @return {Pattern}\\n * @synonyms absOriB, absOriX, absoluteOrientationX\\n * @example\\n * n(absoluteOrientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":135,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation beta value ranges from 0 to 1.</p>","name":"absoluteOrientationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriB, absOriX, absoluteOrientationX","synonyms":["absOriB","absOriX","absoluteOrientationX"],"examples":["n(absoluteOrientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation gamma value ranges from 0 to 1.\\n * @name absoluteOrientationGamma\\n * @return {Pattern}\\n * @synonyms absOriG, absOriY, absoluteOrientationY\\n * @example\\n * n(absoluteOrientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":145,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation gamma value ranges from 0 to 1.</p>","name":"absoluteOrientationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriG, absOriY, absoluteOrientationY","synonyms":["absOriG","absOriY","absoluteOrientationY"],"examples":["n(absoluteOrientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Sends each hap as an OSC message, which can be picked up by SuperCollider or any other OSC-enabled software.\\n * For more info, read [MIDI & OSC in the docs](https://strudel.cc/learn/input-output/)\\n *\\n * @name osc\\n * @memberof Pattern\\n * @returns Pattern\\n */","meta":{"filename":"osc.mjs","lineno":76,"columnno":0,"path":"/home/alex/src/strudel/packages/osc","code":{}},"description":"<p>Sends each hap as an OSC message, which can be picked up by SuperCollider or any other OSC-enabled software.\\nFor more info, read <a href=\\"https://strudel.cc/learn/input-output/\\">MIDI &amp; OSC in the docs</a></p>","name":"osc","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"scope":"static","longname":"Pattern.osc","kind":"member"},{"comment":"/** Overlap-Add Node */","meta":{"range":[150,6513],"filename":"ola-processor.js","lineno":7,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101520","name":"OLAProcessor","type":"ClassDeclaration","paramnames":["options"]}},"name":"OLAProcessor","longname":"OLAProcessor","kind":"class","classdesc":"<p>Overlap-Add Node</p>","scope":"global"},{"comment":"/** Handles dynamic reallocation of input/output channels buffer\\n     (channel numbers may lety during lifecycle) **/","meta":{"range":[1429,1897],"filename":"ola-processor.js","lineno":39,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101673","name":"OLAProcessor#reallocateChannelsIfNeeded","type":"MethodDefinition","paramnames":["inputs","outputs"]},"vars":{"":null}},"description":"<p>Handles dynamic reallocation of input/output channels buffer\\n(channel numbers may lety during lifecycle)</p>","name":"reallocateChannelsIfNeeded","longname":"OLAProcessor#reallocateChannelsIfNeeded","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Read next web audio block to input buffers **/","meta":{"range":[3534,4122],"filename":"ola-processor.js","lineno":92,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101980","name":"OLAProcessor#readInputs","type":"MethodDefinition","paramnames":["inputs"]},"vars":{"":null}},"description":"<p>Read next web audio block to input buffers</p>","name":"readInputs","longname":"OLAProcessor#readInputs","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Write next web audio block from output buffers **/","meta":{"range":[4183,4461],"filename":"ola-processor.js","lineno":112,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102101","name":"OLAProcessor#writeOutputs","type":"MethodDefinition","paramnames":["outputs"]},"vars":{"":null}},"description":"<p>Write next web audio block from output buffers</p>","name":"writeOutputs","longname":"OLAProcessor#writeOutputs","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Shift left content of input buffers to receive new web audio block **/","meta":{"range":[4542,4757],"filename":"ola-processor.js","lineno":122,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102161","name":"OLAProcessor#shiftInputBuffers","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Shift left content of input buffers to receive new web audio block</p>","name":"shiftInputBuffers","longname":"OLAProcessor#shiftInputBuffers","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Shift left content of output buffers to receive new web audio block **/","meta":{"range":[4839,5147],"filename":"ola-processor.js","lineno":131,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102208","name":"OLAProcessor#shiftOutputBuffers","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Shift left content of output buffers to receive new web audio block</p>","name":"shiftOutputBuffers","longname":"OLAProcessor#shiftOutputBuffers","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Copy contents of input buffers to buffer actually sent to process **/","meta":{"range":[5227,5454],"filename":"ola-processor.js","lineno":141,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102275","name":"OLAProcessor#prepareInputBuffersToSend","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Copy contents of input buffers to buffer actually sent to process</p>","name":"prepareInputBuffersToSend","longname":"OLAProcessor#prepareInputBuffersToSend","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Add contents of output buffers just processed to output buffers **/","meta":{"range":[5532,5852],"filename":"ola-processor.js","lineno":150,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102327","name":"OLAProcessor#handleOutputBuffersToRetrieve","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Add contents of output buffers just processed to output buffers</p>","name":"handleOutputBuffersToRetrieve","longname":"OLAProcessor#handleOutputBuffersToRetrieve","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Generates a reverb impulse response.\\n\\n @param {!Object} params TODO: Document the properties.\\n @param {!function(!AudioBuffer)} callback Function to call when\\n  the impulse response has been generated. The impulse response\\n  is passed to this function as its parameter. May be called\\n  immediately within the current execution context, or later. */","meta":{"range":[969,2138],"filename":"reverbGen.mjs","lineno":24,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102812","name":"reverbGen.generateReverb","type":"FunctionExpression","paramnames":["params","callback"]},"vars":{"audioContext":"reverbGen.generateReverb~audioContext","sampleRate":"reverbGen.generateReverb~sampleRate","numChannels":"reverbGen.generateReverb~numChannels","totalTime":"reverbGen.generateReverb~totalTime","decaySampleFrames":"reverbGen.generateReverb~decaySampleFrames","numSampleFrames":"reverbGen.generateReverb~numSampleFrames","fadeInSampleFrames":"reverbGen.generateReverb~fadeInSampleFrames","decayBase":"reverbGen.generateReverb~decayBase","reverbIR":"reverbGen.generateReverb~reverbIR","i":"reverbGen.generateReverb~i","chan":"reverbGen.generateReverb~chan","j":"reverbGen.generateReverb~j","chan[undefined]":"reverbGen.generateReverb~chan.undefined]"}},"description":"<p>Generates a reverb impulse response.</p>","params":[{"type":{"names":["Object"]},"nullable":false,"description":"<p>TODO: Document the properties.</p>","name":"params"},{"type":{"names":["function"]},"nullable":false,"description":"<p>Function to call when\\nthe impulse response has been generated. The impulse response\\nis passed to this function as its parameter. May be called\\nimmediately within the current execution context, or later.</p>","name":"callback"}],"name":"generateReverb","longname":"reverbGen.generateReverb","kind":"function","memberof":"reverbGen","scope":"static"},{"comment":"/** Creates a canvas element showing a graph of the given data.\\n\\n\\n @param {!Float32Array} data An array of numbers, or a Float32Array.\\n @param {number} width Width in pixels of the canvas.\\n @param {number} height Height in pixels of the canvas.\\n @param {number} min Minimum value of data for the graph (lower edge).\\n @param {number} max Maximum value of data in the graph (upper edge).\\n @return {!CanvasElement} The generated canvas element. */","meta":{"range":[2586,3097],"filename":"reverbGen.mjs","lineno":58,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102992","name":"reverbGen.generateGraph","type":"FunctionExpression","paramnames":["data","width","height","min","max"]},"vars":{"canvas":"reverbGen.generateGraph~canvas","canvas.width":"reverbGen.generateGraph~canvas.width","canvas.height":"reverbGen.generateGraph~canvas.height","gc":"reverbGen.generateGraph~gc","gc.fillStyle":"reverbGen.generateGraph~gc.fillStyle","xscale":"reverbGen.generateGraph~xscale","yscale":"reverbGen.generateGraph~yscale","i":"reverbGen.generateGraph~i"}},"description":"<p>Creates a canvas element showing a graph of the given data.</p>","params":[{"type":{"names":["Float32Array"]},"nullable":false,"description":"<p>An array of numbers, or a Float32Array.</p>","name":"data"},{"type":{"names":["number"]},"description":"<p>Width in pixels of the canvas.</p>","name":"width"},{"type":{"names":["number"]},"description":"<p>Height in pixels of the canvas.</p>","name":"height"},{"type":{"names":["number"]},"description":"<p>Minimum value of data for the graph (lower edge).</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>Maximum value of data in the graph (upper edge).</p>","name":"max"}],"returns":[{"type":{"names":["CanvasElement"]},"nullable":false,"description":"<p>The generated canvas element.</p>"}],"name":"generateGraph","longname":"reverbGen.generateGraph","kind":"function","memberof":"reverbGen","scope":"static"},{"comment":"/** Applies a constantly changing lowpass filter to the given sound.\\n\\n @private\\n @param {!AudioBuffer} input\\n @param {number} lpFreqStart\\n @param {number} lpFreqEnd\\n @param {number} lpFreqEndAt\\n @param {!function(!AudioBuffer)} callback May be called\\n  immediately within the current execution context, or later.*/","meta":{"range":[3419,4357],"filename":"reverbGen.mjs","lineno":83,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103107","name":"applyGradualLowpass","type":"FunctionExpression"},"vars":{"channelData":"applyGradualLowpass~channelData","context":"applyGradualLowpass~context","player":"applyGradualLowpass~player","player.buffer":"applyGradualLowpass~player.buffer","filter":"applyGradualLowpass~filter","lpFreqStart":"applyGradualLowpass~lpFreqStart","lpFreqEnd":"applyGradualLowpass~lpFreqEnd","filter.type":"applyGradualLowpass~filter.type","filter.Q.value":"applyGradualLowpass~filter.Q.value","context.oncomplete":"applyGradualLowpass~context.oncomplete","":null,"window.filterNode":"window.filterNode"}},"description":"<p>Applies a constantly changing lowpass filter to the given sound.</p>","access":"private","params":[{"type":{"names":["AudioBuffer"]},"nullable":false,"name":"input"},{"type":{"names":["number"]},"name":"lpFreqStart"},{"type":{"names":["number"]},"name":"lpFreqEnd"},{"type":{"names":["number"]},"name":"lpFreqEndAt"},{"type":{"names":["function"]},"nullable":false,"description":"<p>May be called\\nimmediately within the current execution context, or later.</p>","name":"callback"}],"name":"applyGradualLowpass","longname":"applyGradualLowpass","kind":"function","scope":"global"},{"comment":"/** @private\\n @param {!AudioBuffer} buffer\\n @return {!Array.<!Float32Array>} An array containing the Float32Array of each channel's samples. */","meta":{"range":[4508,4691],"filename":"reverbGen.mjs","lineno":116,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103271","name":"getAllChannelData","type":"FunctionExpression"},"vars":{"channels":"getAllChannelData~channels","i":"getAllChannelData~i","channels[undefined]":"getAllChannelData~channels.undefined]"}},"access":"private","params":[{"type":{"names":["AudioBuffer"]},"nullable":false,"name":"buffer"}],"returns":[{"type":{"names":["Array.<!Float32Array>"]},"nullable":false,"description":"<p>An array containing the Float32Array of each channel's samples.</p>"}],"name":"getAllChannelData","longname":"getAllChannelData","kind":"function","scope":"global"},{"comment":"/** @private\\n @return {number} A random number from -1 to 1. */","meta":{"range":[4762,4824],"filename":"reverbGen.mjs","lineno":126,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103306","name":"randomSample","type":"FunctionExpression"}},"access":"private","returns":[{"type":{"names":["number"]},"description":"<p>A random number from -1 to 1.</p>"}],"name":"randomSample","longname":"randomSample","kind":"function","scope":"global","params":[]},{"comment":"/**\\n * Loads a collection of samples to use with \`s\`\\n * @example\\n * samples('github:tidalcycles/dirt-samples');\\n * s(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")\\n * @example\\n * samples({\\n *  bd: '808bd/BD0000.WAV',\\n *  sd: '808sd/SD0010.WAV'\\n *  }, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');\\n * s(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")\\n * @example\\n * samples('shabda:noise,chimp:2')\\n * s(\\"noise <chimp:0*2 chimp:1>\\")\\n * @example\\n * samples('shabda/speech/fr-FR/f:chocolat')\\n * s(\\"chocolat*4\\")\\n */","meta":{"range":[8306,8738],"filename":"sampler.mjs","lineno":247,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100104489","name":"exports.samples","type":"VariableDeclaration"}},"description":"<p>Loads a collection of samples to use with <code>s</code></p>","examples":["samples('github:tidalcycles/dirt-samples');\\ns(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")","samples({\\n bd: '808bd/BD0000.WAV',\\n sd: '808sd/SD0010.WAV'\\n }, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');\\ns(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")","samples('shabda:noise,chimp:2')\\ns(\\"noise <chimp:0*2 chimp:1>\\")","samples('shabda/speech/fr-FR/f:chocolat')\\ns(\\"chocolat*4\\")"],"name":"samples","longname":"samples","kind":"constant","scope":"global"},{"comment":"/**\\n * Register an alias for a bank of sounds.\\n * Optionally accepts a single argument map of bank aliases.\\n * Optionally accepts a single argument string of a path to a JSON file containing bank aliases.\\n * @param {string} bank - The bank to alias\\n * @param {string} alias - The alias to use for the bank\\n */","meta":{"range":[3606,3993],"filename":"superdough.mjs","lineno":96,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100105237","name":"exports.aliasBank","type":"FunctionDeclaration","paramnames":["args"]}},"description":"<p>Register an alias for a bank of sounds.\\nOptionally accepts a single argument map of bank aliases.\\nOptionally accepts a single argument string of a path to a JSON file containing bank aliases.</p>","params":[{"type":{"names":["string"]},"description":"<p>The bank to alias</p>","name":"bank"},{"type":{"names":["string"]},"description":"<p>The alias to use for the bank</p>","name":"alias"}],"name":"aliasBank","longname":"aliasBank","kind":"function","scope":"global"},{"comment":"/**\\n * Register an alias for a sound.\\n * @param {string} original - The original sound name\\n * @param {string} alias - The alias to use for the sound\\n */","meta":{"range":[4149,4346],"filename":"superdough.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100105289","name":"exports.soundAlias","type":"FunctionDeclaration","paramnames":["original","alias"]}},"description":"<p>Register an alias for a sound.</p>","params":[{"type":{"names":["string"]},"description":"<p>The original sound name</p>","name":"original"},{"type":{"names":["string"]},"description":"<p>The alias to use for the sound</p>","name":"alias"}],"name":"soundAlias","longname":"soundAlias","kind":"function","scope":"global"},{"comment":"/**\\n * Loads a collection of wavetables to use with \`s\`\\n *\\n * @name tables\\n */","meta":{"filename":"wavetable.mjs","lineno":180,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{}},"description":"<p>Loads a collection of wavetables to use with <code>s</code></p>","name":"tables","longname":"tables","kind":"member","scope":"global"},{"comment":"/** Apply Hann window in-place */","meta":{"range":[17486,17622],"filename":"worklets.mjs","lineno":640,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116136","name":"PhaseVocoderProcessor#applyHannWindow","type":"MethodDefinition","paramnames":["input"]},"vars":{"":null}},"description":"<p>Apply Hann window in-place</p>","name":"applyHannWindow","longname":"PhaseVocoderProcessor#applyHannWindow","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Compute squared magnitudes for peak finding **/","meta":{"range":[17680,17992],"filename":"worklets.mjs","lineno":647,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116170","name":"PhaseVocoderProcessor#computeMagnitudes","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Compute squared magnitudes for peak finding</p>","name":"computeMagnitudes","longname":"PhaseVocoderProcessor#computeMagnitudes","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Find peaks in spectrum magnitudes **/","meta":{"range":[18040,18511],"filename":"worklets.mjs","lineno":661,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116230","name":"PhaseVocoderProcessor#findPeaks","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Find peaks in spectrum magnitudes</p>","name":"findPeaks","longname":"PhaseVocoderProcessor#findPeaks","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Shift peaks and regions of influence by pitchFactor into new specturm */","meta":{"range":[18594,20657],"filename":"worklets.mjs","lineno":685,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116336","name":"PhaseVocoderProcessor#shiftPeaks","type":"MethodDefinition","paramnames":["pitchFactor"]},"vars":{"":null}},"description":"<p>Shift peaks and regions of influence by pitchFactor into new specturm</p>","name":"shiftPeaks","longname":"PhaseVocoderProcessor#shiftPeaks","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/**  BYTE BEATS */","meta":{"range":[23715,24646],"filename":"worklets.mjs","lineno":848,"columnno":6,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100117050","name":"chyx","type":"ObjectExpression","value":"{\\"bitC\\":\\"\\",\\"br\\":\\"\\",\\"sinf\\":\\"\\",\\"cosf\\":\\"\\",\\"tanf\\":\\"\\",\\"regG\\":\\"\\"}"}},"description":"<p>BYTE BEATS</p>","name":"chyx","longname":"chyx","kind":"constant","scope":"global","params":[]},{"comment":"/**\\n * Equal Power Crossfade function.\\n * Smoothly transitions between signals A and B, maintaining consistent perceived loudness.\\n *\\n * @param {number} a - Signal A (can be a single value or an array value in buffer processing).\\n * @param {number} b - Signal B (can be a single value or an array value in buffer processing).\\n * @param {number} m - Crossfade parameter (0.0 = all A, 1.0 = all B, 0.5 = equal mix).\\n * @returns {number} Crossfaded output value.\\n */","meta":{"range":[850,1009],"filename":"dough.mjs","lineno":23,"columnno":0,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100121405","name":"crossfade","type":"FunctionDeclaration","paramnames":["a","b","m"]},"vars":{"aGain":"crossfade~aGain","bGain":"crossfade~bGain"}},"description":"<p>Equal Power Crossfade function.\\nSmoothly transitions between signals A and B, maintaining consistent perceived loudness.</p>","params":[{"type":{"names":["number"]},"description":"<p>Signal A (can be a single value or an array value in buffer processing).</p>","name":"a"},{"type":{"names":["number"]},"description":"<p>Signal B (can be a single value or an array value in buffer processing).</p>","name":"b"},{"type":{"names":["number"]},"description":"<p>Crossfade parameter (0.0 = all A, 1.0 = all B, 0.5 = equal mix).</p>","name":"m"}],"returns":[{"type":{"names":["number"]},"description":"<p>Crossfaded output value.</p>"}],"name":"crossfade","longname":"crossfade","kind":"function","scope":"global"},{"comment":"/** @type {number} */","meta":{"range":[16818,16825],"filename":"dough.mjs","lineno":660,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124364","name":"id","type":"ClassProperty"}},"type":{"names":["number"]},"name":"id","longname":"DoughVoice#id","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number[]} */","meta":{"range":[16854,16867],"filename":"dough.mjs","lineno":662,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124366","name":"out","type":"ClassProperty"}},"type":{"names":["Array.<number>"]},"name":"out","longname":"DoughVoice#out","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16907,16914],"filename":"dough.mjs","lineno":665,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124370","name":"attack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"attack","longname":"DoughVoice#attack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16953,16959],"filename":"dough.mjs","lineno":667,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124371","name":"decay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"decay","longname":"DoughVoice#decay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16998,17006],"filename":"dough.mjs","lineno":669,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124372","name":"sustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"sustain","longname":"DoughVoice#sustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17033,17041],"filename":"dough.mjs","lineno":671,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124373","name":"release","type":"ClassProperty"}},"type":{"names":["number"]},"name":"release","longname":"DoughVoice#release","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17068,17075],"filename":"dough.mjs","lineno":673,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124374","name":"_begin","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_begin","longname":"DoughVoice#_begin","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17102,17112],"filename":"dough.mjs","lineno":675,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124375","name":"_duration","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_duration","longname":"DoughVoice#_duration","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {any} */","meta":{"range":[17137,17144],"filename":"dough.mjs","lineno":678,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124376","name":"_sound","type":"ClassProperty"}},"type":{"names":["any"]},"name":"_sound","longname":"DoughVoice#_sound","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17171,17185],"filename":"dough.mjs","lineno":680,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124377","name":"_channels","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_channels","longname":"DoughVoice#_channels","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {BufferPlayer[] | undefined} */","meta":{"range":[17232,17241],"filename":"dough.mjs","lineno":682,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124379","name":"_buffers","type":"ClassProperty"}},"type":{"names":["Array.<BufferPlayer>","undefined"]},"name":"_buffers","longname":"DoughVoice#_buffers","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {string | undefined} */","meta":{"range":[17280,17285],"filename":"dough.mjs","lineno":684,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124380","name":"unit","type":"ClassProperty"}},"type":{"names":["string","undefined"]},"name":"unit","longname":"DoughVoice#unit","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[17323,17329],"filename":"dough.mjs","lineno":687,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124381","name":"_penv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_penv","longname":"DoughVoice#_penv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17368,17373],"filename":"dough.mjs","lineno":689,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124382","name":"penv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"penv","longname":"DoughVoice#penv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17412,17420],"filename":"dough.mjs","lineno":691,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124383","name":"pattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"pattack","longname":"DoughVoice#pattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17459,17466],"filename":"dough.mjs","lineno":693,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124384","name":"pdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"pdecay","longname":"DoughVoice#pdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17505,17514],"filename":"dough.mjs","lineno":695,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124385","name":"psustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"psustain","longname":"DoughVoice#psustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17553,17562],"filename":"dough.mjs","lineno":697,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124386","name":"prelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"prelease","longname":"DoughVoice#prelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17602,17606],"filename":"dough.mjs","lineno":700,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124387","name":"vib","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"vib","longname":"DoughVoice#vib","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17654,17661],"filename":"dough.mjs","lineno":704,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124389","name":"vibmod","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"vibmod","longname":"DoughVoice#vibmod","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {SineOsc | undefined} */","meta":{"range":[17702,17706],"filename":"dough.mjs","lineno":707,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124390","name":"_fm","type":"ClassProperty"}},"type":{"names":["SineOsc","undefined"]},"name":"_fm","longname":"DoughVoice#_fm","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17745,17749],"filename":"dough.mjs","lineno":709,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124391","name":"fmh","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmh","longname":"DoughVoice#fmh","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17788,17792],"filename":"dough.mjs","lineno":711,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124392","name":"fmi","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmi","longname":"DoughVoice#fmi","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[17830,17837],"filename":"dough.mjs","lineno":714,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124393","name":"_fmenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_fmenv","longname":"DoughVoice#_fmenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17876,17885],"filename":"dough.mjs","lineno":716,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124394","name":"fmattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmattack","longname":"DoughVoice#fmattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17924,17932],"filename":"dough.mjs","lineno":718,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124395","name":"fmdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmdecay","longname":"DoughVoice#fmdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17971,17981],"filename":"dough.mjs","lineno":720,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124396","name":"fmsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmsustain","longname":"DoughVoice#fmsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18020,18030],"filename":"dough.mjs","lineno":722,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124397","name":"fmrelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmrelease","longname":"DoughVoice#fmrelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18068,18075],"filename":"dough.mjs","lineno":725,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124398","name":"_lpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_lpenv","longname":"DoughVoice#_lpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18123,18132],"filename":"dough.mjs","lineno":728,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124400","name":"lpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpattack","longname":"DoughVoice#lpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18171,18179],"filename":"dough.mjs","lineno":730,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124401","name":"lpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpdecay","longname":"DoughVoice#lpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18218,18228],"filename":"dough.mjs","lineno":732,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124402","name":"lpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpsustain","longname":"DoughVoice#lpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18267,18277],"filename":"dough.mjs","lineno":734,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124403","name":"lprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lprelease","longname":"DoughVoice#lprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18315,18322],"filename":"dough.mjs","lineno":737,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124404","name":"_hpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_hpenv","longname":"DoughVoice#_hpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18361,18367],"filename":"dough.mjs","lineno":739,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124405","name":"hpenv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpenv","longname":"DoughVoice#hpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18406,18415],"filename":"dough.mjs","lineno":741,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124406","name":"hpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpattack","longname":"DoughVoice#hpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18454,18462],"filename":"dough.mjs","lineno":743,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124407","name":"hpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpdecay","longname":"DoughVoice#hpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18501,18511],"filename":"dough.mjs","lineno":745,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124408","name":"hpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpsustain","longname":"DoughVoice#hpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18550,18560],"filename":"dough.mjs","lineno":747,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124409","name":"hprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hprelease","longname":"DoughVoice#hprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18598,18605],"filename":"dough.mjs","lineno":750,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124410","name":"_bpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_bpenv","longname":"DoughVoice#_bpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18644,18650],"filename":"dough.mjs","lineno":752,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124411","name":"bpenv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpenv","longname":"DoughVoice#bpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18689,18698],"filename":"dough.mjs","lineno":754,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124412","name":"bpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpattack","longname":"DoughVoice#bpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18737,18745],"filename":"dough.mjs","lineno":756,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124413","name":"bpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpdecay","longname":"DoughVoice#bpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18784,18794],"filename":"dough.mjs","lineno":758,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124414","name":"bpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpsustain","longname":"DoughVoice#bpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18833,18843],"filename":"dough.mjs","lineno":760,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124415","name":"bprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bprelease","longname":"DoughVoice#bprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18883,18890],"filename":"dough.mjs","lineno":763,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124416","name":"cutoff","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"cutoff","longname":"DoughVoice#cutoff","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18929,18937],"filename":"dough.mjs","lineno":765,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124417","name":"hcutoff","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hcutoff","longname":"DoughVoice#hcutoff","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18976,18982],"filename":"dough.mjs","lineno":767,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124418","name":"bandf","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bandf","longname":"DoughVoice#bandf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19021,19028],"filename":"dough.mjs","lineno":769,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124419","name":"coarse","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"coarse","longname":"DoughVoice#coarse","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19067,19073],"filename":"dough.mjs","lineno":771,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124420","name":"crush","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"crush","longname":"DoughVoice#crush","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19112,19120],"filename":"dough.mjs","lineno":773,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124421","name":"distort","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"distort","longname":"DoughVoice#distort","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[19148,19153],"filename":"dough.mjs","lineno":776,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124422","name":"freq","type":"ClassProperty"}},"type":{"names":["number"]},"name":"freq","longname":"DoughVoice#freq","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {string | undefined} */","meta":{"range":[19192,19197],"filename":"dough.mjs","lineno":778,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124423","name":"note","type":"ClassProperty"}},"type":{"names":["string","undefined"]},"name":"note","longname":"DoughVoice#note","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19253,19258],"filename":"dough.mjs","lineno":781,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124424","name":"_lpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_lpf","longname":"DoughVoice#_lpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19313,19318],"filename":"dough.mjs","lineno":783,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124425","name":"_hpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_hpf","longname":"DoughVoice#_hpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19373,19378],"filename":"dough.mjs","lineno":785,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124426","name":"_bpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_bpf","longname":"DoughVoice#_bpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Chorus[] | null | undefined} */","meta":{"range":[19426,19434],"filename":"dough.mjs","lineno":787,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124427","name":"_chorus","type":"ClassProperty"}},"type":{"names":["Array.<Chorus>","null","undefined"]},"name":"_chorus","longname":"DoughVoice#_chorus","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Coarse[] | null | undefined} */","meta":{"range":[19482,19490],"filename":"dough.mjs","lineno":789,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124428","name":"_coarse","type":"ClassProperty"}},"type":{"names":["Array.<Coarse>","null","undefined"]},"name":"_coarse","longname":"DoughVoice#_coarse","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Crush[] | null | undefined} */","meta":{"range":[19537,19544],"filename":"dough.mjs","lineno":791,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124429","name":"_crush","type":"ClassProperty"}},"type":{"names":["Array.<Crush>","null","undefined"]},"name":"_crush","longname":"DoughVoice#_crush","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Distort[] | null | undefined} */","meta":{"range":[19593,19602],"filename":"dough.mjs","lineno":793,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124430","name":"_distort","type":"ClassProperty"}},"type":{"names":["Array.<Distort>","null","undefined"]},"name":"_distort","longname":"DoughVoice#_distort","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/**\\n   * @param {DoughVoice} value\\n   */","meta":{"range":[19649,24138],"filename":"dough.mjs","lineno":798,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124431","name":"exports.DoughVoice","type":"MethodDefinition","paramnames":["value"]},"vars":{"":null}},"params":[{"type":{"names":["DoughVoice"]},"name":"value"}],"name":"DoughVoice","longname":"DoughVoice#DoughVoice","kind":"class","memberof":"DoughVoice","scope":"instance"},{"comment":"/**\\n * Change the pitch of each value by the given amount. Expects numbers or note strings as values.\\n * The amount can be given as a number of semitones or as a string in interval short notation.\\n * If you don't care about enharmonic correctness, just use numbers. Otherwise, pass the interval of\\n * the form: ST where S is the degree number and T the type of interval with\\n *\\n * - M = major\\n * - m = minor\\n * - P = perfect\\n * - A = augmented\\n * - d = diminished\\n *\\n * Examples intervals:\\n *\\n * - 1P = unison\\n * - 3M = major third\\n * - 3m = minor third\\n * - 4P = perfect fourth\\n * - 4A = augmented fourth\\n * - 5P = perfect fifth\\n * - 5d = diminished fifth\\n *\\n * @param {string | number} amount Either number of semitones or interval string.\\n * @returns Pattern\\n * @memberof Pattern\\n * @name transpose\\n * @synonyms trans\\n * @example\\n * \\"c2 c3\\".fast(2).transpose(\\"<0 -2 5 3>\\".slow(2)).note()\\n * @example\\n * \\"c2 c3\\".fast(2).transpose(\\"<1P -2M 4P 3m>\\".slow(2)).note()\\n */","meta":{"filename":"tonal.mjs","lineno":73,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Change the pitch of each value by the given amount. Expects numbers or note strings as values.\\nThe amount can be given as a number of semitones or as a string in interval short notation.\\nIf you don't care about enharmonic correctness, just use numbers. Otherwise, pass the interval of\\nthe form: ST where S is the degree number and T the type of interval with</p>\\n<ul>\\n<li>M = major</li>\\n<li>m = minor</li>\\n<li>P = perfect</li>\\n<li>A = augmented</li>\\n<li>d = diminished</li>\\n</ul>\\n<p>Examples intervals:</p>\\n<ul>\\n<li>1P = unison</li>\\n<li>3M = major third</li>\\n<li>3m = minor third</li>\\n<li>4P = perfect fourth</li>\\n<li>4A = augmented fourth</li>\\n<li>5P = perfect fifth</li>\\n<li>5d = diminished fifth</li>\\n</ul>","params":[{"type":{"names":["string","number"]},"description":"<p>Either number of semitones or interval string.</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"memberof":"Pattern","name":"transpose","synonyms_text":"trans","synonyms":["trans"],"examples":["\\"c2 c3\\".fast(2).transpose(\\"<0 -2 5 3>\\".slow(2)).note()","\\"c2 c3\\".fast(2).transpose(\\"<1P -2M 4P 3m>\\".slow(2)).note()"],"scope":"static","longname":"Pattern.transpose","kind":"member"},{"comment":"/**\\n * Transposes notes inside the scale by the number of steps.\\n * Expected to be called on a Pattern which already has a {@link Pattern#scale}\\n *\\n * @memberof Pattern\\n * @name scaleTranspose\\n * @param {offset} offset number of steps inside the scale\\n * @returns Pattern\\n * @synonyms scaleTrans, strans\\n * @example\\n * \\"-8 [2,4,6]\\"\\n * .scale('C4 bebop major')\\n * .scaleTranspose(\\"<0 -1 -2 -3 -4 -5 -6 -4>\\")\\n * .note()\\n */","meta":{"filename":"tonal.mjs","lineno":143,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Transposes notes inside the scale by the number of steps.\\nExpected to be called on a Pattern which already has a {@link Pattern#scale}</p>","memberof":"Pattern","name":"scaleTranspose","params":[{"type":{"names":["offset"]},"description":"<p>number of steps inside the scale</p>","name":"offset"}],"returns":[{"description":"<p>Pattern</p>"}],"synonyms_text":"scaleTrans, strans","synonyms":["scaleTrans","strans"],"examples":["\\"-8 [2,4,6]\\"\\n.scale('C4 bebop major')\\n.scaleTranspose(\\"<0 -1 -2 -3 -4 -5 -6 -4>\\")\\n.note()"],"scope":"static","longname":"Pattern.scaleTranspose","kind":"member"},{"comment":"/**\\n * Turns numbers into notes in the scale (zero indexed) or quantizes notes to a scale.\\n *\\n * When describing notes via numbers, note that negative numbers can be used to wrap backwards\\n * in the scale as well as sharps or flats (but not both) to produce notes outside of the scale.\\n *\\n * Also sets scale for other scale operations, like {@link Pattern#scaleTranspose}.\\n *\\n * A scale consists of a root note (e.g. \`c4\`, \`c\`, \`f#\`, \`bb4\`) followed by semicolon (':') and then a [scale type](https://github.com/tonaljs/tonal/blob/main/packages/scale-type/data.ts).\\n *\\n * The root note defaults to octave 3, if no octave number is given.\\n *\\n * @name scale\\n * @param {string} scale Name of scale\\n * @returns Pattern\\n * @example\\n * n(\\"0 2 4 6 4 2\\").scale(\\"C:major\\")\\n * @example\\n * n(\\"[0,7] 4 [2,7] 4\\")\\n * .scale(\\"C:<major minor>/2\\")\\n * .s(\\"piano\\")\\n * @example\\n * n(rand.range(0,12).segment(8))\\n * .scale(\\"C:ritusen\\")\\n * .s(\\"piano\\")\\n * @example\\n * n(\\"<[0,7b] [-4# -4] [-2,7##] 4 [0,7] [-4# -4b] [-2,7###] 4b>*4\\")\\n * .scale(\\"C:<major minor>/2\\")\\n * .s(\\"piano\\")\\n * @example\\n * note(\\"C1*16\\").transpose(irand(36)).scale('Cb2 major').scaleTranspose(3)\\n */","meta":{"filename":"tonal.mjs","lineno":225,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Turns numbers into notes in the scale (zero indexed) or quantizes notes to a scale.</p>\\n<p>When describing notes via numbers, note that negative numbers can be used to wrap backwards\\nin the scale as well as sharps or flats (but not both) to produce notes outside of the scale.</p>\\n<p>Also sets scale for other scale operations, like {@link Pattern#scaleTranspose}.</p>\\n<p>A scale consists of a root note (e.g. <code>c4</code>, <code>c</code>, <code>f#</code>, <code>bb4</code>) followed by semicolon (':') and then a <a href=\\"https://github.com/tonaljs/tonal/blob/main/packages/scale-type/data.ts\\">scale type</a>.</p>\\n<p>The root note defaults to octave 3, if no octave number is given.</p>","name":"scale","params":[{"type":{"names":["string"]},"description":"<p>Name of scale</p>","name":"scale"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0 2 4 6 4 2\\").scale(\\"C:major\\")","n(\\"[0,7] 4 [2,7] 4\\")\\n.scale(\\"C:<major minor>/2\\")\\n.s(\\"piano\\")","n(rand.range(0,12).segment(8))\\n.scale(\\"C:ritusen\\")\\n.s(\\"piano\\")","n(\\"<[0,7b] [-4# -4] [-2,7##] 4 [0,7] [-4# -4b] [-2,7###] 4b>*4\\")\\n.scale(\\"C:<major minor>/2\\")\\n.s(\\"piano\\")","note(\\"C1*16\\").transpose(irand(36)).scale('Cb2 major').scaleTranspose(3)"],"longname":"scale","kind":"member","scope":"global"},{"comment":"/**\\n * Adds a new custom voicing dictionary.\\n *\\n * @name addVoicings\\n * @memberof Pattern\\n * @param {string} name identifier for the voicing dictionary\\n * @param {Object} dictionary maps chord symbol to possible voicings\\n * @param {Array} range min, max note\\n * @returns Pattern\\n * @example\\n * addVoicings('cookie', {\\n *   7: ['3M 7m 9M 12P 15P', '7m 10M 13M 16M 19P'],\\n *   '^7': ['3M 6M 9M 12P 14M', '7M 10M 13M 16M 19P'],\\n *   m7: ['8P 11P 14m 17m 19P', '5P 8P 11P 14m 17m'],\\n *   m7b5: ['3m 5d 8P 11P 14m', '5d 8P 11P 14m 17m'],\\n *   o7: ['3m 6M 9M 11A 15P'],\\n *   '7alt': ['3M 7m 10m 13m 15P'],\\n *   '7#11': ['7m 10m 13m 15P 17m'],\\n * }, ['C3', 'C6'])\\n * \\"<C^7 A7 Dm7 G7>\\".voicings('cookie').note()\\n */","meta":{"filename":"voicings.mjs","lineno":89,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Adds a new custom voicing dictionary.</p>","name":"addVoicings","memberof":"Pattern","params":[{"type":{"names":["string"]},"description":"<p>identifier for the voicing dictionary</p>","name":"name"},{"type":{"names":["Object"]},"description":"<p>maps chord symbol to possible voicings</p>","name":"dictionary"},{"type":{"names":["Array"]},"description":"<p>min, max note</p>","name":"range"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["addVoicings('cookie', {\\n  7: ['3M 7m 9M 12P 15P', '7m 10M 13M 16M 19P'],\\n  '^7': ['3M 6M 9M 12P 14M', '7M 10M 13M 16M 19P'],\\n  m7: ['8P 11P 14m 17m 19P', '5P 8P 11P 14m 17m'],\\n  m7b5: ['3m 5d 8P 11P 14m', '5d 8P 11P 14m 17m'],\\n  o7: ['3m 6M 9M 11A 15P'],\\n  '7alt': ['3M 7m 10m 13m 15P'],\\n  '7#11': ['7m 10m 13m 15P 17m'],\\n}, ['C3', 'C6'])\\n\\"<C^7 A7 Dm7 G7>\\".voicings('cookie').note()"],"scope":"static","longname":"Pattern.addVoicings","kind":"member"},{"comment":"/**\\n * DEPRECATED: still works, but it is recommended you use .voicing instead (without s).\\n * Turns chord symbols into voicings, using the smoothest voice leading possible.\\n * Uses [chord-voicings package](https://github.com/felixroos/chord-voicings#chord-voicings).\\n *\\n * @name voicings\\n * @memberof Pattern\\n * @param {string} dictionary which voicing dictionary to use.\\n * @returns Pattern\\n * @example\\n * stack(\\"<C^7 A7 Dm7 G7>\\".voicings('lefthand'), \\"<C3 A2 D3 G2>\\").note()\\n */","meta":{"filename":"voicings.mjs","lineno":130,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>DEPRECATED: still works, but it is recommended you use .voicing instead (without s).\\nTurns chord symbols into voicings, using the smoothest voice leading possible.\\nUses <a href=\\"https://github.com/felixroos/chord-voicings#chord-voicings\\">chord-voicings package</a>.</p>","name":"voicings","memberof":"Pattern","params":[{"type":{"names":["string"]},"description":"<p>which voicing dictionary to use.</p>","name":"dictionary"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["stack(\\"<C^7 A7 Dm7 G7>\\".voicings('lefthand'), \\"<C3 A2 D3 G2>\\").note()"],"scope":"static","longname":"Pattern.voicings","kind":"member"},{"comment":"/**\\n * Maps the chords of the incoming pattern to root notes in the given octave.\\n *\\n * @name rootNotes\\n * @memberof Pattern\\n * @param {octave} octave octave to use\\n * @returns Pattern\\n * @example\\n * \\"<C^7 A7 Dm7 G7>\\".rootNotes(2).note()\\n */","meta":{"filename":"voicings.mjs","lineno":156,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Maps the chords of the incoming pattern to root notes in the given octave.</p>","name":"rootNotes","memberof":"Pattern","params":[{"type":{"names":["octave"]},"description":"<p>octave to use</p>","name":"octave"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<C^7 A7 Dm7 G7>\\".rootNotes(2).note()"],"scope":"static","longname":"Pattern.rootNotes","kind":"member"},{"comment":"/**\\n * Turns chord symbols into voicings. You can use the following control params:\\n *\\n * - \`chord\`: Note, followed by chord symbol, e.g. C Am G7 Bb^7\\n * - \`dict\`: voicing dictionary to use, falls back to default dictionary\\n * - \`anchor\`: the note that is used to align the chord\\n * - \`mode\`: how the voicing is aligned to the anchor\\n *   - \`below\`: top note <= anchor\\n *   - \`duck\`: top note <= anchor, anchor excluded\\n *   - \`above\`: bottom note >= anchor\\n * - \`offset\`: whole number that shifts the voicing up or down to the next voicing\\n * - \`n\`: if set, the voicing is played like a scale. Overshooting numbers will be octaved\\n *\\n * All of the above controls are optional, except \`chord\`.\\n * If you pass a pattern of strings to voicing, they will be interpreted as chords.\\n *\\n * @name voicing\\n * @returns Pattern\\n * @example\\n * n(\\"0 1 2 3\\").chord(\\"<C Am F G>\\").voicing()\\n */","meta":{"filename":"voicings.mjs","lineno":175,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Turns chord symbols into voicings. You can use the following control params:</p>\\n<ul>\\n<li><code>chord</code>: Note, followed by chord symbol, e.g. C Am G7 Bb^7</li>\\n<li><code>dict</code>: voicing dictionary to use, falls back to default dictionary</li>\\n<li><code>anchor</code>: the note that is used to align the chord</li>\\n<li><code>mode</code>: how the voicing is aligned to the anchor\\n<ul>\\n<li><code>below</code>: top note &lt;= anchor</li>\\n<li><code>duck</code>: top note &lt;= anchor, anchor excluded</li>\\n<li><code>above</code>: bottom note &gt;= anchor</li>\\n</ul>\\n</li>\\n<li><code>offset</code>: whole number that shifts the voicing up or down to the next voicing</li>\\n<li><code>n</code>: if set, the voicing is played like a scale. Overshooting numbers will be octaved</li>\\n</ul>\\n<p>All of the above controls are optional, except <code>chord</code>.\\nIf you pass a pattern of strings to voicing, they will be interpreted as chords.</p>","name":"voicing","returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0 1 2 3\\").chord(\\"<C Am F G>\\").voicing()"],"longname":"voicing","kind":"member","scope":"global"},{"comment":"/**\\n * Renders an oscilloscope for the frequency domain of the audio signal.\\n * @name fscope\\n * @param {string} color line color as hex or color name. defaults to white.\\n * @param {number} scale scales the y-axis. Defaults to 0.25\\n * @param {number} pos y-position relative to screen height. 0 = top, 1 = bottom of screen\\n * @param {number} lean y-axis alignment where 0 = top and 1 = bottom\\n * @param {number} min min value\\n * @param {number} max max value\\n * @example\\n * s(\\"sawtooth\\").fscope()\\n */","meta":{"filename":"scope.mjs","lineno":98,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders an oscilloscope for the frequency domain of the audio signal.</p>","name":"fscope","params":[{"type":{"names":["string"]},"description":"<p>line color as hex or color name. defaults to white.</p>","name":"color"},{"type":{"names":["number"]},"description":"<p>scales the y-axis. Defaults to 0.25</p>","name":"scale"},{"type":{"names":["number"]},"description":"<p>y-position relative to screen height. 0 = top, 1 = bottom of screen</p>","name":"pos"},{"type":{"names":["number"]},"description":"<p>y-axis alignment where 0 = top and 1 = bottom</p>","name":"lean"},{"type":{"names":["number"]},"description":"<p>min value</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>max value</p>","name":"max"}],"examples":["s(\\"sawtooth\\").fscope()"],"longname":"fscope","kind":"member","scope":"global"},{"comment":"/**\\n * Renders an oscilloscope for the time domain of the audio signal.\\n * @name scope\\n * @synonyms tscope\\n * @param {object} config optional config with options:\\n * @param {boolean} align if 1, the scope will be aligned to the first zero crossing. defaults to 1\\n * @param {string} color line color as hex or color name. defaults to white.\\n * @param {number} thickness line thickness. defaults to 3\\n * @param {number} scale scales the y-axis. Defaults to 0.25\\n * @param {number} pos y-position relative to screen height. 0 = top, 1 = bottom of screen\\n * @param {number} trigger amplitude value that is used to align the scope. defaults to 0.\\n * @example\\n * s(\\"sawtooth\\")._scope()\\n */","meta":{"filename":"scope.mjs","lineno":121,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders an oscilloscope for the time domain of the audio signal.</p>","name":"scope","synonyms_text":"tscope","synonyms":["tscope"],"params":[{"type":{"names":["object"]},"description":"<p>optional config with options:</p>","name":"config"},{"type":{"names":["boolean"]},"description":"<p>if 1, the scope will be aligned to the first zero crossing. defaults to 1</p>","name":"align"},{"type":{"names":["string"]},"description":"<p>line color as hex or color name. defaults to white.</p>","name":"color"},{"type":{"names":["number"]},"description":"<p>line thickness. defaults to 3</p>","name":"thickness"},{"type":{"names":["number"]},"description":"<p>scales the y-axis. Defaults to 0.25</p>","name":"scale"},{"type":{"names":["number"]},"description":"<p>y-position relative to screen height. 0 = top, 1 = bottom of screen</p>","name":"pos"},{"type":{"names":["number"]},"description":"<p>amplitude value that is used to align the scope. defaults to 0.</p>","name":"trigger"}],"examples":["s(\\"sawtooth\\")._scope()"],"longname":"scope","kind":"member","scope":"global"},{"comment":"/**\\n * Renders a spectrum analyzer for the incoming audio signal.\\n * @name spectrum\\n * @param {object} config optional config with options:\\n * @param {integer} thickness line thickness in px (default 3)\\n * @param {integer} speed scroll speed (default 1)\\n * @param {integer} min min db (default -80)\\n * @param {integer} max max db (default 0)\\n * @example\\n * n(\\"<0 4 <2 3> 1>*3\\")\\n * .off(1/8, add(n(5)))\\n * .off(1/5, add(n(7)))\\n * .scale(\\"d3:minor:pentatonic\\")\\n * .s('sine')\\n * .dec(.3).room(.5)\\n * ._spectrum()\\n */","meta":{"filename":"spectrum.mjs","lineno":5,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders a spectrum analyzer for the incoming audio signal.</p>","name":"spectrum","params":[{"type":{"names":["object"]},"description":"<p>optional config with options:</p>","name":"config"},{"type":{"names":["integer"]},"description":"<p>line thickness in px (default 3)</p>","name":"thickness"},{"type":{"names":["integer"]},"description":"<p>scroll speed (default 1)</p>","name":"speed"},{"type":{"names":["integer"]},"description":"<p>min db (default -80)</p>","name":"min"},{"type":{"names":["integer"]},"description":"<p>max db (default 0)</p>","name":"max"}],"examples":["n(\\"<0 4 <2 3> 1>*3\\")\\n.off(1/8, add(n(5)))\\n.off(1/5, add(n(7)))\\n.scale(\\"d3:minor:pentatonic\\")\\n.s('sine')\\n.dec(.3).room(.5)\\n._spectrum()"],"longname":"spectrum","kind":"member","scope":"global"},{"kind":"package","longname":"package:undefined","files":["/home/alex/src/strudel/packages/codemirror/autocomplete.mjs","/home/alex/src/strudel/packages/codemirror/basicSetup.mjs","/home/alex/src/strudel/packages/codemirror/codemirror.mjs","/home/alex/src/strudel/packages/codemirror/flash.mjs","/home/alex/src/strudel/packages/codemirror/highlight.mjs","/home/alex/src/strudel/packages/codemirror/html.mjs","/home/alex/src/strudel/packages/codemirror/index.mjs","/home/alex/src/strudel/packages/codemirror/keybindings.mjs","/home/alex/src/strudel/packages/codemirror/slider.mjs","/home/alex/src/strudel/packages/codemirror/themes/CutiePi.mjs","/home/alex/src/strudel/packages/codemirror/themes/algoboy.mjs","/home/alex/src/strudel/packages/codemirror/themes/androidstudio.mjs","/home/alex/src/strudel/packages/codemirror/themes/archBtw.mjs","/home/alex/src/strudel/packages/codemirror/themes/atomone.mjs","/home/alex/src/strudel/packages/codemirror/themes/aura.mjs","/home/alex/src/strudel/packages/codemirror/themes/bbedit.mjs","/home/alex/src/strudel/packages/codemirror/themes/blackscreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/bluescreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/bluescreenlight.mjs","/home/alex/src/strudel/packages/codemirror/themes/darcula.mjs","/home/alex/src/strudel/packages/codemirror/themes/dracula.mjs","/home/alex/src/strudel/packages/codemirror/themes/duotoneDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/duotoneLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/eclipse.mjs","/home/alex/src/strudel/packages/codemirror/themes/fruitDaw.mjs","/home/alex/src/strudel/packages/codemirror/themes/githubDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/githubLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/green-text.mjs","/home/alex/src/strudel/packages/codemirror/themes/gruvboxDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/gruvboxLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/materialDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/materialLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/monokai.mjs","/home/alex/src/strudel/packages/codemirror/themes/noctisLilac.mjs","/home/alex/src/strudel/packages/codemirror/themes/nord.mjs","/home/alex/src/strudel/packages/codemirror/themes/red-text.mjs","/home/alex/src/strudel/packages/codemirror/themes/solarizedDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/solarizedLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/sonic-pink.mjs","/home/alex/src/strudel/packages/codemirror/themes/strudel-theme.mjs","/home/alex/src/strudel/packages/codemirror/themes/sublime.mjs","/home/alex/src/strudel/packages/codemirror/themes/teletext.mjs","/home/alex/src/strudel/packages/codemirror/themes/terminal.mjs","/home/alex/src/strudel/packages/codemirror/themes/theme-helper.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokioNightStorm.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokyoNight.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokyoNightDay.mjs","/home/alex/src/strudel/packages/codemirror/themes/vscodeDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/vscodeLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/whitescreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/xcodeLight.mjs","/home/alex/src/strudel/packages/codemirror/themes.mjs","/home/alex/src/strudel/packages/codemirror/tooltip.mjs","/home/alex/src/strudel/packages/codemirror/vite.config.js","/home/alex/src/strudel/packages/codemirror/widget.mjs","/home/alex/src/strudel/packages/core/bench/pattern.bench.mjs","/home/alex/src/strudel/packages/core/clockworker.js","/home/alex/src/strudel/packages/core/controls.mjs","/home/alex/src/strudel/packages/core/cyclist.mjs","/home/alex/src/strudel/packages/core/drawLine.mjs","/home/alex/src/strudel/packages/core/euclid.mjs","/home/alex/src/strudel/packages/core/evaluate.mjs","/home/alex/src/strudel/packages/core/fraction.mjs","/home/alex/src/strudel/packages/core/hap.mjs","/home/alex/src/strudel/packages/core/index.mjs","/home/alex/src/strudel/packages/core/logger.mjs","/home/alex/src/strudel/packages/core/neocyclist.mjs","/home/alex/src/strudel/packages/core/pattern.mjs","/home/alex/src/strudel/packages/core/pick.mjs","/home/alex/src/strudel/packages/core/repl.mjs","/home/alex/src/strudel/packages/core/signal.mjs","/home/alex/src/strudel/packages/core/speak.mjs","/home/alex/src/strudel/packages/core/state.mjs","/home/alex/src/strudel/packages/core/test/controls.test.mjs","/home/alex/src/strudel/packages/core/test/drawLine.test.mjs","/home/alex/src/strudel/packages/core/test/euclid.test.js","/home/alex/src/strudel/packages/core/test/fraction.test.mjs","/home/alex/src/strudel/packages/core/test/pattern.test.mjs","/home/alex/src/strudel/packages/core/test/solmization.test.js","/home/alex/src/strudel/packages/core/test/util.test.mjs","/home/alex/src/strudel/packages/core/test/value.test.mjs","/home/alex/src/strudel/packages/core/time.mjs","/home/alex/src/strudel/packages/core/timespan.mjs","/home/alex/src/strudel/packages/core/ui.mjs","/home/alex/src/strudel/packages/core/util.mjs","/home/alex/src/strudel/packages/core/value.mjs","/home/alex/src/strudel/packages/core/vite.config.js","/home/alex/src/strudel/packages/core/zyklus.mjs","/home/alex/src/strudel/packages/csound/index.mjs","/home/alex/src/strudel/packages/csound/vite.config.js","/home/alex/src/strudel/packages/desktopbridge/index.mjs","/home/alex/src/strudel/packages/desktopbridge/loggerbridge.mjs","/home/alex/src/strudel/packages/desktopbridge/midibridge.mjs","/home/alex/src/strudel/packages/desktopbridge/oscbridge.mjs","/home/alex/src/strudel/packages/desktopbridge/utils.mjs","/home/alex/src/strudel/packages/draw/animate.mjs","/home/alex/src/strudel/packages/draw/color.mjs","/home/alex/src/strudel/packages/draw/draw.mjs","/home/alex/src/strudel/packages/draw/index.mjs","/home/alex/src/strudel/packages/draw/pianoroll.mjs","/home/alex/src/strudel/packages/draw/pitchwheel.mjs","/home/alex/src/strudel/packages/draw/spiral.mjs","/home/alex/src/strudel/packages/draw/vite.config.js","/home/alex/src/strudel/packages/embed/embed.js","/home/alex/src/strudel/packages/gamepad/gamepad.mjs","/home/alex/src/strudel/packages/gamepad/index.mjs","/home/alex/src/strudel/packages/gamepad/vite.config.js","/home/alex/src/strudel/packages/hs2js/src/hs2js.mjs","/home/alex/src/strudel/packages/hs2js/src/index.mjs","/home/alex/src/strudel/packages/hs2js/src/parser.mjs","/home/alex/src/strudel/packages/hs2js/vite.config.js","/home/alex/src/strudel/packages/hydra/hydra.mjs","/home/alex/src/strudel/packages/hydra/vite.config.js","/home/alex/src/strudel/packages/midi/index.mjs","/home/alex/src/strudel/packages/midi/midi.mjs","/home/alex/src/strudel/packages/midi/vite.config.js","/home/alex/src/strudel/packages/mini/bench/mini.bench.mjs","/home/alex/src/strudel/packages/mini/index.mjs","/home/alex/src/strudel/packages/mini/krill-parser.js","/home/alex/src/strudel/packages/mini/mini.mjs","/home/alex/src/strudel/packages/mini/test/mini.test.mjs","/home/alex/src/strudel/packages/mini/vite.config.js","/home/alex/src/strudel/packages/mondo/mondo.mjs","/home/alex/src/strudel/packages/mondo/test/mondo.test.mjs","/home/alex/src/strudel/packages/mondo/vite.config.js","/home/alex/src/strudel/packages/mondough/mondough.mjs","/home/alex/src/strudel/packages/mondough/vite.config.js","/home/alex/src/strudel/packages/motion/index.mjs","/home/alex/src/strudel/packages/motion/motion.mjs","/home/alex/src/strudel/packages/motion/vite.config.js","/home/alex/src/strudel/packages/mqtt/mqtt.mjs","/home/alex/src/strudel/packages/mqtt/vite.config.js","/home/alex/src/strudel/packages/osc/osc.mjs","/home/alex/src/strudel/packages/osc/server.js","/home/alex/src/strudel/packages/osc/superdirtoutput.js","/home/alex/src/strudel/packages/osc/tidal-sniffer.js","/home/alex/src/strudel/packages/osc/vite.config.js","/home/alex/src/strudel/packages/reference/index.mjs","/home/alex/src/strudel/packages/reference/vite.config.js","/home/alex/src/strudel/packages/repl/index.mjs","/home/alex/src/strudel/packages/repl/prebake.mjs","/home/alex/src/strudel/packages/repl/repl-component.mjs","/home/alex/src/strudel/packages/repl/vite.config.js","/home/alex/src/strudel/packages/sampler/sample-server.mjs","/home/alex/src/strudel/packages/serial/serial.mjs","/home/alex/src/strudel/packages/serial/vite.config.js","/home/alex/src/strudel/packages/soundfonts/convert.js","/home/alex/src/strudel/packages/soundfonts/fontloader.mjs","/home/alex/src/strudel/packages/soundfonts/gm.mjs","/home/alex/src/strudel/packages/soundfonts/index.mjs","/home/alex/src/strudel/packages/soundfonts/list.mjs","/home/alex/src/strudel/packages/soundfonts/sfumato.mjs","/home/alex/src/strudel/packages/soundfonts/vite.config.js","/home/alex/src/strudel/packages/superdough/audioContext.mjs","/home/alex/src/strudel/packages/superdough/dspworklet.mjs","/home/alex/src/strudel/packages/superdough/feedbackdelay.mjs","/home/alex/src/strudel/packages/superdough/fft.js","/home/alex/src/strudel/packages/superdough/helpers.mjs","/home/alex/src/strudel/packages/superdough/index.mjs","/home/alex/src/strudel/packages/superdough/logger.mjs","/home/alex/src/strudel/packages/superdough/noise.mjs","/home/alex/src/strudel/packages/superdough/ola-processor.js","/home/alex/src/strudel/packages/superdough/reverb.mjs","/home/alex/src/strudel/packages/superdough/reverbGen.mjs","/home/alex/src/strudel/packages/superdough/sampler.mjs","/home/alex/src/strudel/packages/superdough/superdough.mjs","/home/alex/src/strudel/packages/superdough/superdoughoutput.mjs","/home/alex/src/strudel/packages/superdough/synth.mjs","/home/alex/src/strudel/packages/superdough/util.mjs","/home/alex/src/strudel/packages/superdough/vite.config.js","/home/alex/src/strudel/packages/superdough/vowel.mjs","/home/alex/src/strudel/packages/superdough/wavetable.mjs","/home/alex/src/strudel/packages/superdough/worklets.mjs","/home/alex/src/strudel/packages/superdough/zzfx.mjs","/home/alex/src/strudel/packages/superdough/zzfx_fork.mjs","/home/alex/src/strudel/packages/supradough/dough-export.mjs","/home/alex/src/strudel/packages/supradough/dough-worklet.mjs","/home/alex/src/strudel/packages/supradough/dough.mjs","/home/alex/src/strudel/packages/supradough/index.mjs","/home/alex/src/strudel/packages/tidal/tidal.mjs","/home/alex/src/strudel/packages/tonal/index.mjs","/home/alex/src/strudel/packages/tonal/ireal.mjs","/home/alex/src/strudel/packages/tonal/test/tonal.test.mjs","/home/alex/src/strudel/packages/tonal/test/tonleiter.test.mjs","/home/alex/src/strudel/packages/tonal/tonal.mjs","/home/alex/src/strudel/packages/tonal/tonleiter.mjs","/home/alex/src/strudel/packages/tonal/vite.config.js","/home/alex/src/strudel/packages/tonal/voicings.mjs","/home/alex/src/strudel/packages/transpiler/index.mjs","/home/alex/src/strudel/packages/transpiler/test/transpiler.test.mjs","/home/alex/src/strudel/packages/transpiler/transpiler.mjs","/home/alex/src/strudel/packages/transpiler/vite.config.js","/home/alex/src/strudel/packages/vite-plugin-bundle-audioworklet/vite-plugin-bundle-audioworklet.js","/home/alex/src/strudel/packages/web/vite.config.js","/home/alex/src/strudel/packages/web/web.mjs","/home/alex/src/strudel/packages/webaudio/index.mjs","/home/alex/src/strudel/packages/webaudio/scope.mjs","/home/alex/src/strudel/packages/webaudio/spectrum.mjs","/home/alex/src/strudel/packages/webaudio/supradough.mjs","/home/alex/src/strudel/packages/webaudio/vite.config.js","/home/alex/src/strudel/packages/webaudio/webaudio.mjs","/home/alex/src/strudel/packages/xen/index.mjs","/home/alex/src/strudel/packages/xen/test/xen.test.mjs","/home/alex/src/strudel/packages/xen/tune.mjs","/home/alex/src/strudel/packages/xen/tunejs.js","/home/alex/src/strudel/packages/xen/vite.config.js","/home/alex/src/strudel/packages/xen/xen.mjs"]}]`),B2={docs:Kfe};let Jfe=n=>{const e=document.createElement("template");return e.innerHTML=n.trim(),e.content.childNodes},d9=n=>Array.isArray(n)?n.flat().join(""):n===void 0?"":n,ege=(n,...e)=>{let t="";for(let s in n)t+=d9(n[s]),t+=d9(e[s]);return Jfe(t)};const tge=n=>{const e=document.createElement("div");return e.innerText=n,e.innerHTML},nge=n=>{const e=document.createElement("div");return e.innerHTML=n,e.textContent||e.innerText||""},mw=n=>n.name||n.longname,sge=n=>n!=null&&n.length?`
    <div class="autocomplete-info-params-section">
      <h4 class="autocomplete-info-section-title">Parameters</h4>
      <ul class="autocomplete-info-params-list">
        ${n.map(({name:e,type:t,description:s})=>{var a;return`
          <li class="autocomplete-info-param-item">
            <span class="autocomplete-info-param-name">${e}</span>
            <span class="autocomplete-info-param-type">${(a=t.names)==null?void 0:a.join(" | ")}</span>
            ${s?`<div class="autocomplete-info-param-desc">${nge(s)}</div>`:""}
          </li>
        `}).join("")}
      </ul>
    </div>
  `:"",age=n=>n!=null&&n.length?`
    <div class="autocomplete-info-examples-section">
      <h4 class="autocomplete-info-section-title">Examples</h4>
      ${n.map(e=>`
        <pre class="autocomplete-info-example-code">${tge(e)}</pre>
      `).join("")}
    </div>
  `:"",I_=n=>ege`
  <div class="autocomplete-info-container">
    <div class="autocomplete-info-tooltip">
      <h3 class="autocomplete-info-function-name">${mw(n)}</h3>
      ${n.synonyms_text?`<div class="autocomplete-info-function-synonyms">Synonyms: ${n.synonyms_text}</div>`:""}
      ${n.description?`<div class="autocomplete-info-function-description">${n.description}</div>`:""}
      ${sge(n.params)}
      ${age(n.examples)}
    </div>
  </div>
`[0],rge=n=>{const e=mw(n);return e&&!e.startsWith("_")&&!["package"].includes(n.kind)},oge=n=>["superdirtOnly","noAutocomplete"].some(e=>{var t;return(t=n.tags)==null?void 0:t.find(s=>s.originalTitle===e)});function ige(){const n=NN.get(),e=new Set;for(const t of Object.keys(n)){const[s,a]=t.split("_");a&&s&&e.add(s)}return Array.from(e).sort().map(t=>({label:t,type:"bank"}))}let Q_=[];try{Q_=(ji.names?ji.names():[]).map(n=>({label:n,type:"scale"}))}catch(n){console.warn("[autocomplete] Could not load scale names from Tonal:",n)}const lge=[{label:"below",type:"mode"},{label:"above",type:"mode"},{label:"duck",type:"mode"},{label:"root",type:"mode"}],cge=["",...Object.keys(_d)].sort(),uge=cge.map(n=>n===""?{label:"major",apply:"",type:"chord-symbol"}:{label:n,apply:n,type:"chord-symbol"}),V_=(n,e)=>{const t=n.synonyms||[],s=[mw(n),...t].filter(a=>a&&a!==e);return{...n,name:e,longname:e,synonyms:s,synonyms_text:s.join(", ")}},hge=(()=>{const n=new Set,e=[];for(const t of B2.docs){if(!rge(t)||oge(t))continue;const s=mw(t),a=t.synonyms||[];let r=[s,...a];for(const o of r)o&&!n.has(o)&&(n.add(o),e.push({label:o,info:()=>I_(V_(t,o)),type:"function"}))}return e})(),Cy=["C","C#","Db","D","D#","Eb","E","E#","Fb","F","F#","Gb","G","G#","Ab","A","A#","Bb","B","B#","Cb"],dge=/scale\(\s*$/,mge=/scale\(\s*['"][^'"]*:[^'"]*$/,pge=/scale\(\s*['"][^'"]*$/,fge=/([A-Ga-g][#b]*)?$/,gge=/\s+/g;function bge(n){let e=n.matchBefore(dge);if(e)return{from:e.to,options:[]};let t=n.matchBefore(mge);if(t){const a=t.text,r=a.lastIndexOf(":");if(r!==-1){const o=a.slice(r+1),i=Q_.filter(l=>l.label.startsWith(o)).map(l=>({...l,apply:l.label.replace(gge,":")}));return{from:t.from+r+1,options:i}}}let s=n.matchBefore(pge);if(s&&!s.text.includes(":"))if(n.explicit){const a=s.text.match(fge),r=a?a[0]:"",o=Cy.filter(c=>c.toLowerCase().startsWith(r.toLowerCase())),i=s.to-r.length,l=o.map(c=>({label:c,type:"pitch"}));return{from:i,options:l}}else return{from:s.to,options:[]};return null}const yge=/(s|sound)\(\s*$/,vge=/(s|sound)\(\s*['"][^'"]*$/,wge=/(?:[\s[{(<])([\w]*)$/;function Oge(n){let e=n.matchBefore(yge);if(e)return{from:e.to,options:[]};let t=n.matchBefore(vge);if(!t)return null;const s=t.text,a=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(a===-1)return null;const r=s.slice(a+1),o=r.match(wge),i=o?o[1]:r;let l=Object.keys(NN.get()).sort().filter(c=>c.includes(i)).map(c=>({label:c,type:"sound"}));return{from:t.to-i.length,options:l}}const xge=/bank\(\s*$/,kge=/bank\(\s*['"][^'"]*$/;function Pge(n){let e=n.matchBefore(xge);if(e)return{from:e.to,options:[]};let t=n.matchBefore(kge);if(!t)return null;const s=t.text,a=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(a===-1)return null;const r=s.slice(a+1),o=ige().filter(i=>i.label.startsWith(r));return{from:t.to-r.length,options:o}}const Sge=/mode\(\s*$/,Cge=/mode\(\s*['"][^'"]*:[^'"]*$/,Mge=/mode\(\s*['"][^'"]*$/,Age=/(?:[\s[{(<])([\w:]*)$/;function Ege(n){let e=n.matchBefore(Sge);if(e)return{from:e.to,options:[]};let t=n.matchBefore(Cge);if(t){const u=t.text,h=u.lastIndexOf(":");if(h!==-1){const m=u.slice(h+1),f=Cy.filter(v=>v.toLowerCase().startsWith(m.toLowerCase())).map(v=>({label:v,type:"pitch"}));return{from:t.from+h+1,options:f}}}let s=n.matchBefore(Mge);if(!s)return null;const a=s.text,r=Math.max(a.lastIndexOf('"'),a.lastIndexOf("'"));if(r===-1)return null;const o=a.slice(r+1),i=o.match(Age),l=i?i[1]:o,c=lge.filter(u=>u.label.startsWith(l));return{from:s.to-l.length,options:c}}const Dge=/chord\(\s*$/,Tge=/chord\(\s*['"][^'"]*$/,Fge=/(?:[\s[{(<])([\w#b+^:-]*)$/;function Nge(n){let e=n.matchBefore(Dge);if(e)return{from:e.to,options:[]};let t=n.matchBefore(Tge);if(!t)return null;const s=t.text,a=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(a===-1)return null;const r=s.slice(a+1),o=r.match(Fge),i=o?o[1]:r;let l=null,c=i;for(const u of Cy)if(i.toLowerCase().startsWith(u.toLowerCase())){l=u,c=i.slice(u.length);break}if(l){const u=uge.filter(h=>h.label.toLowerCase().startsWith(c.toLowerCase()));return{from:t.to-c.length,options:u}}else{const u=Cy.filter(h=>h.toLowerCase().startsWith(i.toLowerCase())).map(h=>({label:h,type:"pitch"}));return{from:t.to-i.length,options:u}}}const Bge=/\w*/;function $ge(n){const e=n.matchBefore(Bge);return e&&e.from===e.to&&!n.explicit?null:e?{from:e.from,options:hge}:null}const Rge=[Oge,Pge,Nge,bge,Ege,$ge],_ge=n=>{for(const e of Rge){const t=e(n);if(t)return t}return null},Lge=n=>n?[Zue({override:[_ge],closeOnBlur:!1})]:[],Ige=n=>n.name||n.longname;let $2=!1;typeof window<"u"&&(window.addEventListener("keyup",function(n){n.key=="Control"&&($2=!1)},!0),window.addEventListener("keydown",function(n){n.key=="Control"&&($2=!0)},!0));const Qge=P6((n,e,t)=>{if(!$2)return null;let{from:s,to:a,text:r}=n.state.doc.lineAt(e),o=e,i=e;for(;o>s&&/\w/.test(r[o-s-1]);)o--;for(;i<a&&/\w/.test(r[i-s]);)i++;if(o==e&&t<0||i==e&&t>0)return null;let l=r.slice(o-s,i-s),c=B2.docs.filter(u=>Ige(u)===l)[0];if(!c){const u=B2.docs.filter(h=>h.synonyms&&h.synonyms.includes(l))[0];if(!u)return null;c=V_(u,l)}return{pos:o,end:i,above:!1,arrow:!0,create(u){let h=document.createElement("div");h.className="strudel-tooltip";const m=I_(c);return h.appendChild(m),{dom:h}}}},{hoverTime:10}),Vge=n=>n?Qge:[],jge=cn.define(),Zge=zs.define({create(){return Et.none},update(n,e){try{for(let t of e.effects)if(t.is(jge))if(t.value&&e.newDoc.length>0){const s=Et.mark({attributes:{style:"background-color: rgba(255,255,255, .4); filter: invert(10%)"}});n=Et.set([s.range(0,e.newDoc.length)])}else n=Et.set([]);return n}catch(t){return console.warn("flash error",t),n}},provide:n=>ut.decorations.from(n)}),zge=n=>n?Zge:[],j_=cn.define(),Z_=cn.define(),Gge=(n,e)=>{n.dispatch({effects:j_.of(e)})},Mx=(n,e,t)=>{n.dispatch({effects:Z_.of({atTime:e,haps:t})})},R2=zs.define({create(){return Et.none},update(n,e){e.docChanged&&(n=n.map(e.changes));for(let t of e.effects)if(t.is(j_)){const s=t.value.filter(([a])=>a<e.newDoc.length).map(([a,r])=>[a,Math.min(r,e.newDoc.length)]).map(a=>Et.mark({id:a.join(":"),attributes:{style:"background-color: #00CA2880"}}).range(...a));n=Et.set(s,!0)}return n}}),_2=zs.define({create(){return{atTime:0,haps:new Map}},update(n,e){var t;for(let s of e.effects)if(s.is(Z_)){const a=new Map;for(let r of s.value.haps)if(!(!((t=r.context)!=null&&t.locations)||!r.whole))for(let{start:o,end:i}of r.context.locations){let l=`${o}:${i}`;(!a.has(l)||a.get(l).whole.begin.lt(r.whole.begin))&&a.set(l,r)}n={atTime:s.value.atTime,haps:a}}return n}}),Xge=ut.decorations.compute([R2,_2],n=>{var a,r;const e=n.field(R2).iter(),{haps:t}=n.field(_2),s=new Hi;for(;e.value;){const{from:o,to:i,value:{spec:{id:l}}}=e;if(t.has(l)){const c=t.get(l),u=((a=c.value)==null?void 0:a.color)??"var(--foreground)",h=((r=c.value)==null?void 0:r.markcss)||`outline: solid 2px ${u}`;s.add(o,i,Et.mark({attributes:{style:h}}))}e.next()}return s.finish()}),Wge=[R2,_2,Xge],L2=(n,e)=>(n&&e&&setTimeout(()=>{Gge(e.editor,e.miniLocations)},100),n?jo.highest(Wge):[]),qge=Ks.fromClass(class{constructor(){}},{provide:()=>jo.highest(Qc.of([...gpe]))}),Uge=n=>[qge].concat(n??[]),Hge={vim:Kme,emacs:xme,codemirror:()=>Qc.of(ow),vscode:Uge};function Yge(n){const e=Hge[n];return[e?jo.high(e()):[]]}const _n=({theme:n,settings:e,styles:t})=>{const s=ut.theme({"&":{color:e.foreground,backgroundColor:e.background},".cm-gutters":{backgroundColor:e.gutterBackground,color:e.gutterForeground},".cm-content":{caretColor:e.caret},".cm-cursor, .cm-dropCursor":{borderLeftColor:e.caret},".cm-activeLineGutter":{backgroundColor:e.lineHighlight},".cm-activeLine":{backgroundColor:e.lineHighlight},"&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection":{background:e.selection+" !important"},"& .cm-selectionMatch":{backgroundColor:e.selectionMatch}},{dark:n==="dark"}),a=$m.define(t);return[s,Jv(a)]},Kge={background:"#222",foreground:"#fff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},Jge=_n({theme:"dark",settings:Kge,styles:[{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#89ddff"},{tag:y.labelName,color:"#89ddff"},{tag:y.keyword,color:"#c792ea"},{tag:y.operator,color:"#89ddff"},{tag:y.special(y.variableName),color:"#eeffff"},{tag:y.typeName,color:"#c3e88d"},{tag:y.atom,color:"#f78c6c"},{tag:y.number,color:"#c3e88d"},{tag:y.definition(y.variableName),color:"#82aaff"},{tag:y.string,color:"#c3e88d"},{tag:y.special(y.string),color:"#c3e88d"},{tag:y.comment,color:"#7d8799"},{tag:y.variableName,color:"#c792ea"},{tag:y.tagName,color:"#c3e88d"},{tag:y.bracket,color:"#525154"},{tag:y.meta,color:"#ffcb6b"},{tag:y.attributeName,color:"#c792ea"},{tag:y.propertyName,color:"#c792ea"},{tag:y.className,color:"#decb6b"},{tag:y.invalid,color:"#ffffff"},{tag:[y.unit,y.punctuation],color:"#82aaff"}]}),e0e={background:"#051DB5",foreground:"white",caret:"white",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},t0e=_n({theme:"dark",settings:e0e,styles:[{tag:y.labelName,color:"inherit"},{tag:y.keyword,color:"inherit"},{tag:y.operator,color:"inherit"},{tag:y.special(y.variableName),color:"inherit"},{tag:y.typeName,color:"inherit"},{tag:y.atom,color:"inherit"},{tag:y.number,color:"inherit"},{tag:y.definition(y.variableName),color:"inherit"},{tag:y.string,color:"inherit"},{tag:y.special(y.string),color:"inherit"},{tag:y.comment,color:"inherit"},{tag:y.variableName,color:"inherit"},{tag:y.tagName,color:"inherit"},{tag:y.bracket,color:"inherit"},{tag:y.meta,color:"inherit"},{tag:y.attributeName,color:"inherit"},{tag:y.propertyName,color:"inherit"},{tag:y.className,color:"inherit"},{tag:y.invalid,color:"inherit"},{tag:[y.unit,y.punctuation],color:"inherit"}]}),n0e={background:"black",foreground:"white",caret:"white",selection:"#ffffff20",selectionMatch:"#036dd626",lineHighlight:"#ffffff10",gutterBackground:"transparent",gutterForeground:"#8a919966"},s0e=_n({theme:"dark",settings:n0e,styles:[{tag:y.labelName,color:"inherit"},{tag:y.keyword,color:"inherit"},{tag:y.operator,color:"inherit"},{tag:y.special(y.variableName),color:"inherit"},{tag:y.typeName,color:"inherit"},{tag:y.atom,color:"inherit"},{tag:y.number,color:"inherit"},{tag:y.definition(y.variableName),color:"inherit"},{tag:y.string,color:"inherit"},{tag:y.special(y.string),color:"inherit"},{tag:y.comment,color:"inherit"},{tag:y.variableName,color:"inherit"},{tag:y.tagName,color:"inherit"},{tag:y.bracket,color:"inherit"},{tag:y.meta,color:"inherit"},{tag:y.attributeName,color:"inherit"},{tag:y.propertyName,color:"inherit"},{tag:y.className,color:"inherit"},{tag:y.invalid,color:"inherit"},{tag:[y.unit,y.punctuation],color:"inherit"}]}),a0e={background:"white",foreground:"black",caret:"black",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#ffffff26",lineHighlight:"#cccccc50",gutterBackground:"transparent",gutterForeground:"black"},r0e=_n({theme:"light",settings:a0e,styles:[{tag:y.labelName,color:"inherit"},{tag:y.keyword,color:"inherit"},{tag:y.operator,color:"inherit"},{tag:y.special(y.variableName),color:"inherit"},{tag:y.typeName,color:"inherit"},{tag:y.atom,color:"inherit"},{tag:y.number,color:"inherit"},{tag:y.definition(y.variableName),color:"inherit"},{tag:y.string,color:"inherit"},{tag:y.special(y.string),color:"inherit"},{tag:y.comment,color:"inherit"},{tag:y.variableName,color:"inherit"},{tag:y.tagName,color:"inherit"},{tag:y.bracket,color:"inherit"},{tag:y.meta,color:"inherit"},{tag:y.attributeName,color:"inherit"},{tag:y.propertyName,color:"inherit"},{tag:y.className,color:"inherit"},{tag:y.invalid,color:"inherit"}]});let Fo="#6edee4",z_="white",G_="red",X_="#f8fc55";const o0e={background:"#000000",foreground:Fo,caret:G_,selection:X_,selectionMatch:Fo,lineHighlight:"#6edee440",gutterBackground:"transparent",gutterForeground:"#8a919966"};let Ax=X_,j0=z_;const i0e=_n({theme:"dark",settings:o0e,styles:[{tag:y.labelName,color:z_},{tag:y.keyword,color:Fo},{tag:y.operator,color:j0},{tag:y.special(y.variableName),color:Fo},{tag:y.typeName,color:Fo},{tag:y.atom,color:Fo},{tag:y.number,color:j0},{tag:y.definition(y.variableName),color:Fo},{tag:y.string,color:j0},{tag:y.special(y.string),color:j0},{tag:y.comment,color:Ax},{tag:y.variableName,color:Fo},{tag:y.tagName,color:Fo},{tag:y.bracket,color:Ax},{tag:y.meta,color:Fo},{tag:y.attributeName,color:Fo},{tag:y.propertyName,color:Fo},{tag:y.className,color:Fo},{tag:y.invalid,color:G_},{tag:[y.unit,y.punctuation],color:Ax}]}),l0e={"Sour Watermelon B":["#996666","#6B4747","#3D2929","#0F0A0A"]},wr=l0e["Sour Watermelon B"],c0e={background:wr[3],foreground:wr[1],caret:wr[0],selection:wr[0],selectionMatch:wr[1],lineHighlight:wr[3],gutterBackground:"transparent",gutterForeground:wr[0]},u0e=_n({theme:"dark",settings:c0e,styles:[{tag:y.comment,color:wr[2]},{tag:y.string,color:wr[1]},{tag:[y.atom,y.number],color:wr[1]},{tag:[y.meta,y.labelName,y.variableName],color:wr[0]},{tag:[y.keyword,y.tagName,y.arithmeticOperator],color:wr[1]},{tag:[y.atom,y.bool,y.special(y.variableName)],color:wr[0]},{tag:[y.function(y.variableName),y.propertyName],color:wr[0]},{tag:y.atom,color:wr[1]}]}),I2="#5c019a",h0e="#fbeffc",W_="#272C35",d0e="#fee1ff",m0e="#465063",p0e="#9acd3f",f0e="#97a1b7",g0e="#f6a6fd",m9={background:"white",foreground:I2,caret:"#797977",selection:h0e,selectionMatch:"#2B323D",gutterBackground:W_,gutterForeground:m0e,lineHighlight:d0e},b0e=_n({theme:"light",settings:m9,styles:[{tag:[y.function(y.variableName),y.function(y.propertyName),y.url,y.processingInstruction],color:I2},{tag:[y.tagName,y.heading],color:m9.foreground},{tag:y.comment,color:f0e},{tag:[y.variableName,y.propertyName,y.labelName],color:g0e},{tag:[y.attributeName,y.number],color:"#d19a66"},{tag:y.className,color:W_},{tag:y.keyword,color:I2},{tag:[y.string,y.regexp,y.special(y.propertyName)],color:p0e}]}),Ii=["#1e1e1e","#fbde2d","#ff1493","#4c83ff","#ededed","#cccccc","#ffffff30","#dc2f8c"],y0e={background:"#000000",foreground:Ii[4],selection:Ii[6],gutterBackground:Ii[0],gutterForeground:Ii[5],lineHighlight:Ii[0]},v0e=_n({theme:"dark",settings:y0e,styles:[{tag:[y.function(y.variableName),y.function(y.propertyName),y.url,y.processingInstruction],color:Ii[4]},{tag:[y.atom,y.bool,y.special(y.variableName)],color:Ii[3]},{tag:y.comment,color:"#54636D"},{tag:[y.variableName,y.propertyName,y.labelName],color:Ii[4]},{tag:[y.attributeName,y.number],color:Ii[3]},{tag:y.keyword,color:Ii[1]},{tag:[y.string,y.regexp,y.special(y.propertyName)],color:Ii[2]}]}),qr=["#000000","#ff5356","#bd312a","#54636D","#171717"],w0e={background:qr[0],foreground:qr[2],selection:qr[4],selectionMatch:qr[0],gutterBackground:qr[0],gutterForeground:qr[3],lineHighlight:qr[0]},O0e=_n({theme:"dark",settings:w0e,styles:[{tag:[y.function(y.variableName),y.function(y.propertyName),y.url,y.processingInstruction],color:qr[2]},{tag:[y.atom,y.bool,y.special(y.variableName)],color:qr[1]},{tag:y.comment,color:qr[3]},{tag:[y.variableName,y.propertyName,y.labelName],color:qr[2]},{tag:[y.attributeName,y.number],color:qr[1]},{tag:y.keyword,color:qr[2]},{tag:[y.string,y.regexp,y.special(y.propertyName)],color:qr[1]}]}),Ur=["#000000","#8ed675","#56bd2a","#54636D","#171717"],x0e={background:Ur[0],foreground:Ur[2],selection:Ur[4],selectionMatch:Ur[0],gutterBackground:Ur[0],gutterForeground:Ur[3],lineHighlight:Ur[0]},k0e=_n({theme:"dark",settings:x0e,styles:[{tag:[y.function(y.variableName),y.function(y.propertyName),y.url,y.processingInstruction],color:Ur[2]},{tag:[y.atom,y.bool,y.special(y.variableName)],color:Ur[1]},{tag:y.comment,color:Ur[3]},{tag:[y.variableName,y.propertyName,y.labelName],color:Ur[2]},{tag:[y.attributeName,y.number],color:Ur[1]},{tag:y.keyword,color:Ur[2]},{tag:[y.string,y.regexp,y.special(y.propertyName)],color:Ur[1]}]}),Hr=["rgb(0, 0, 0)","rgb(82, 208, 250)","rgba(113, 208, 250, .4)","rgba(113, 208, 250, .15)"],P0e={background:Hr[0],foreground:Hr[1],selection:Hr[2],selectionMatch:Hr[0],gutterBackground:Hr[0],gutterForeground:Hr[2],lineHighlight:Hr[0]},S0e=_n({theme:"dark",settings:P0e,styles:[{tag:[y.function(y.variableName),y.function(y.propertyName),y.url,y.processingInstruction],color:Hr[1]},{tag:[y.atom,y.bool,y.special(y.variableName)],color:Hr[1]},{tag:[y.comment,y.brace,y.bracket],color:Hr[2]},{tag:[y.variableName,y.propertyName,y.labelName],color:Hr[1]},{tag:[y.attributeName,y.number],color:Hr[1]},{tag:y.keyword,color:Hr[1]},{tag:[y.string,y.regexp,y.special(y.propertyName)],color:Hr[1]}]}),Or=["rgb(84, 93, 98)","rgb(255, 255, 255)","rgba(255, 255, 255, .25)","rgb(67, 76, 81)","rgb(186, 230, 115)","rgb(252, 184, 67)","rgb(124, 206, 254)","rgb(83, 101, 102)","rgba(46, 62, 72,.5)","rgb(94, 100, 108)","rgb(167, 216, 177)"],C0e={background:Or[0],foreground:Or[10],selection:Or[8],selectionMatch:Or[0],gutterBackground:Or[3],gutterForeground:Or[2],lineHighlight:Or[3]},M0e=_n({theme:"dark",settings:C0e,styles:[{tag:[y.function(y.variableName),y.function(y.propertyName),y.url,y.processingInstruction],color:Or[1]},{tag:[y.bool,y.special(y.variableName)],color:Or[1]},{tag:[y.comment,y.brace,y.bracket],color:Or[2]},{tag:[y.variableName],color:Or[1]},{tag:[y.labelName,y.propertyName,y.self,y.atom],color:Or[5]},{tag:[y.attributeName,y.number],color:Or[6]},{tag:y.keyword,color:Or[5]},{tag:[y.string,y.regexp,y.special(y.propertyName)],color:Or[4]}]}),Yr=["rgb(75, 130, 247)","rgb(47, 108, 246)","rgb(255, 255, 255)","rgba(255, 255, 255,.3)"],A0e={background:Yr[0],foreground:Yr[2],selection:Yr[3],selectionMatch:Yr[0],gutterBackground:Yr[0],gutterForeground:Yr[2],lineHighlight:Yr[1]},E0e=_n({theme:"dark",settings:A0e,styles:[{tag:[y.function(y.variableName),y.function(y.propertyName),y.url,y.processingInstruction],color:Yr[2]},{tag:[y.atom,y.bool,y.special(y.variableName)],color:Yr[2]},{tag:[y.comment,y.bracket,y.brace,y.compareOperator],color:Yr[3]},{tag:[y.variableName,y.propertyName,y.labelName],color:Yr[2]},{tag:[y.attributeName,y.number],color:Yr[2]},{tag:y.keyword,color:Yr[2]},{tag:[y.string,y.regexp,y.special(y.propertyName)],color:Yr[2]}]}),D0e=_n({theme:"dark",settings:{background:"#282b2e",foreground:"#a9b7c6",caret:"#00FF00",selection:"#4e5254",selectionMatch:"#4e5254",gutterForeground:"#cccccc50",lineHighlight:"#7f85891f"},styles:[{tag:y.labelName,color:"inherit"},{tag:[y.keyword,y.deleted,y.className],color:"#a9b7c6"},{tag:[y.number,y.literal],color:"#6897bb"},{tag:[y.link,y.variableName],color:"#a9b7c6"},{tag:[y.comment,y.quote],color:"grey"},{tag:[y.meta,y.documentMeta],color:"#bbb529"},{tag:[y.propertyName,y.attributeValue],color:"#a9b7c6"},{tag:[y.string],color:"#6a8759"},{tag:[y.heading,y.typeName],color:"#ffc66d"},{tag:[y.attributeName],color:"#a9b7c6"},{tag:[y.emphasis],fontStyle:"italic"}]}),T0e=_n({theme:"dark",settings:{background:"#272C35",foreground:"#9d9b97",caret:"#797977",selection:"#3d4c64",selectionMatch:"#3d4c64",gutterBackground:"#272C35",gutterForeground:"#465063",lineHighlight:"#2e3f5940"},styles:[{tag:[y.function(y.variableName),y.function(y.propertyName),y.url,y.processingInstruction],color:"hsl(207, 82%, 66%)"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"hsl( 29, 54%, 61%)"},{tag:[y.tagName,y.heading],color:"#e06c75"},{tag:y.comment,color:"#54636D"},{tag:[y.variableName,y.propertyName,y.labelName],color:"hsl(220, 14%, 71%)"},{tag:[y.attributeName,y.number],color:"hsl( 29, 54%, 61%)"},{tag:y.className,color:"hsl( 39, 67%, 69%)"},{tag:y.keyword,color:"hsl(286, 60%, 67%)"},{tag:[y.string,y.regexp,y.special(y.propertyName)],color:"#98c379"}]}),F0e=_n({theme:"dark",settings:{background:"#21202e",foreground:"#edecee",caret:"#a277ff",selection:"#5a51898f",selectionMatch:"#5a51898f",gutterBackground:"#21202e",gutterForeground:"#edecee",lineHighlight:"#a394f033"},styles:[{tag:y.keyword,color:"#a277ff"},{tag:[y.name,y.deleted,y.character,y.macroName],color:"#edecee"},{tag:[y.propertyName],color:"#ffca85"},{tag:[y.processingInstruction,y.string,y.inserted,y.special(y.string)],color:"#61ffca"},{tag:[y.function(y.variableName),y.labelName],color:"#ffca85"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#61ffca"},{tag:[y.definition(y.name),y.separator],color:"#edecee"},{tag:[y.className],color:"#82e2ff"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#61ffca"},{tag:[y.typeName],color:"#82e2ff"},{tag:[y.operator,y.operatorKeyword],color:"#a277ff"},{tag:[y.url,y.escape,y.regexp,y.link],color:"#61ffca"},{tag:[y.meta,y.comment],color:"#6d6d6d"},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.link,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:"#a277ff"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#edecee"},{tag:y.invalid,color:"#ff6767"},{tag:y.strikethrough,textDecoration:"line-through"}]}),N0e=_n({theme:"dark",settings:{background:"#242424",foreground:"#f8f8f2",caret:"#FFFFFF",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"transparent",gutterForeground:"#999",lineHighlight:"rgba(255, 255, 255, 0.1)"},styles:[{tag:y.labelName,color:"#CCCCCC"},{tag:[y.atom,y.number],color:"#7A9EC2"},{tag:[y.comment],color:"#707070"},{tag:[y.string],color:"#6A8759"},{tag:[y.variableName,y.operator],color:"#CCCCCC"},{tag:[y.function(y.variableName),y.propertyName],color:"#FFC66D"},{tag:[y.meta,y.className],color:"#FFC66D"},{tag:[y.propertyName],color:"#FFC66D"},{tag:[y.keyword],color:"#CC7832"},{tag:[y.tagName],color:"#ff79c6"},{tag:[y.typeName],color:"#ffb86c"}]}),B0e="#BD93F9",$0e=_n({theme:"dark",settings:{background:"#282a36",foreground:"#f8f8f2",caret:"#f8f8f0",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"#282a36",gutterForeground:"#6272a4",lineHighlight:"rgba(255, 255, 255, 0.1)"},styles:[{tag:y.comment,color:"#6272a4"},{tag:y.string,color:"#f1fa8c"},{tag:[y.atom,y.number],color:B0e},{tag:[y.meta,y.labelName,y.variableName],color:"#f8f8f2"},{tag:[y.keyword,y.tagName,y.arithmeticOperator],color:"#ff79c6"},{tag:[y.function(y.variableName),y.propertyName],color:"#50fa7b"},{tag:y.atom,color:"#bd93f9"}]}),R0e=_n({theme:"dark",settings:{background:"#2a2734",foreground:"#6c6783",caret:"#ffad5c",selection:"#9a86fd",selectionMatch:"#9a86fd",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},styles:[{tag:[y.comment,y.bracket,y.operator],color:"#6c6783"},{tag:[y.atom,y.number,y.keyword,y.link,y.attributeName,y.quote],color:"#ffcc99"},{tag:[y.emphasis,y.heading,y.tagName,y.propertyName,y.className,y.variableName],color:"#eeebff"},{tag:[y.typeName,y.url],color:"#eeebff"},{tag:y.string,color:"#ffb870"},{tag:[y.propertyName],color:"#eeebff"},{tag:y.labelName,color:"#eeebff"}]}),_0e=_n({theme:"light",settings:{background:"#fff",foreground:"#000",caret:"#FFFFFF",selection:"#d7d4f0",selectionMatch:"#d7d4f0",gutterBackground:"#f7f7f7",gutterForeground:"#999",lineHighlight:"#006fff1c"},styles:[{tag:[y.comment],color:"#3F7F5F"},{tag:[y.documentMeta],color:"#FF1717"},{tag:y.keyword,color:"#7F0055",fontWeight:"bold"},{tag:y.atom,color:"#00f"},{tag:y.number,color:"#164"},{tag:y.propertyName,color:"#164"},{tag:[y.variableName,y.definition(y.variableName)],color:"#0000C0"},{tag:y.function(y.variableName),color:"#0000C0"},{tag:y.string,color:"#2A00FF"},{tag:y.operator,color:"black"},{tag:y.tagName,color:"#170"},{tag:y.attributeName,color:"#00c"},{tag:y.link,color:"#219"}]}),L0e=_n({theme:"dark",settings:{background:"#0d1117",foreground:"#c9d1d9",caret:"#c9d1d9",selection:"#003d73",selectionMatch:"#003d73",lineHighlight:"#36334280"},styles:[{tag:y.labelName,color:"#d2a8ff"},{tag:[y.standard(y.tagName),y.tagName],color:"#7ee787"},{tag:[y.comment,y.bracket],color:"#8b949e"},{tag:[y.className,y.propertyName],color:"#d2a8ff"},{tag:[y.variableName,y.attributeName],color:"#d2a8ff"},{tag:[y.number,y.operator],color:"#79c0ff"},{tag:[y.keyword,y.typeName,y.typeOperator,y.typeName],color:"#ff7b72"},{tag:[y.string,y.meta,y.regexp],color:"#a5d6ff"},{tag:[y.name,y.quote],color:"#7ee787"},{tag:[y.heading,y.strong],color:"#d2a8ff",fontWeight:"bold"},{tag:[y.emphasis],color:"#d2a8ff",fontStyle:"italic"},{tag:[y.deleted],color:"#ffdcd7",backgroundColor:"ffeef0"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#ffab70"},{tag:y.link,textDecoration:"underline"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.invalid,color:"#f97583"}]}),I0e=_n({theme:"light",settings:{background:"#fff",foreground:"#24292e",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#6e7781"},styles:[{tag:[y.standard(y.tagName),y.tagName],color:"#116329"},{tag:[y.comment,y.bracket],color:"#6a737d"},{tag:[y.className,y.propertyName],color:"#6f42c1"},{tag:[y.variableName,y.attributeName,y.number,y.operator],color:"#005cc5"},{tag:[y.keyword,y.typeName,y.typeOperator,y.typeName],color:"#d73a49"},{tag:[y.string,y.meta,y.regexp],color:"#032f62"},{tag:[y.name,y.quote],color:"#22863a"},{tag:[y.heading,y.strong],color:"#24292e",fontWeight:"bold"},{tag:[y.emphasis],color:"#24292e",fontStyle:"italic"},{tag:[y.deleted],color:"#b31d28",backgroundColor:"ffeef0"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#e36209"},{tag:[y.url,y.escape,y.regexp,y.link],color:"#032f62"},{tag:y.link,textDecoration:"underline"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.invalid,color:"#cb2431"}]}),Q0e=_n({theme:"dark",settings:{background:"#282828",foreground:"#ebdbb2",caret:"#ebdbb2",selection:"#b99d555c",selectionMatch:"#b99d555c",lineHighlight:"#baa1602b",gutterBackground:"#282828",gutterForeground:"#7c6f64"},styles:[{tag:y.keyword,color:"#fb4934"},{tag:[y.name,y.deleted,y.character,y.propertyName,y.macroName],color:"#8ec07c"},{tag:[y.variableName],color:"#83a598"},{tag:[y.function(y.variableName)],color:"#8ec07c",fontStyle:"bold"},{tag:[y.labelName],color:"#ebdbb2"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#d3869b"},{tag:[y.definition(y.name),y.separator],color:"#ebdbb2"},{tag:[y.brace],color:"#ebdbb2"},{tag:[y.annotation],color:"#fb4934d"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#d3869b"},{tag:[y.typeName,y.className],color:"#fabd2f"},{tag:[y.operatorKeyword],color:"#fb4934"},{tag:[y.tagName],color:"#8ec07c",fontStyle:"bold"},{tag:[y.squareBracket],color:"#fe8019"},{tag:[y.angleBracket],color:"#83a598"},{tag:[y.attributeName],color:"#8ec07c"},{tag:[y.regexp],color:"#8ec07c"},{tag:[y.quote],color:"#928374"},{tag:[y.string],color:"#ebdbb2"},{tag:y.link,color:"#a89984",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[y.url,y.escape,y.special(y.string)],color:"#d3869b"},{tag:[y.meta],color:"#fabd2f"},{tag:[y.comment],color:"#928374",fontStyle:"italic"},{tag:y.strong,fontWeight:"bold",color:"#fe8019"},{tag:y.emphasis,fontStyle:"italic",color:"#b8bb26"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.heading,fontWeight:"bold",color:"#b8bb26"},{tag:[y.heading1,y.heading2],fontWeight:"bold",color:"#b8bb26"},{tag:[y.heading3,y.heading4],fontWeight:"bold",color:"#fabd2f"},{tag:[y.heading5,y.heading6],color:"#fabd2f"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#d3869b"},{tag:[y.processingInstruction,y.inserted],color:"#83a598"},{tag:[y.contentSeparator],color:"#fb4934"},{tag:y.invalid,color:"#fe8019",borderBottom:"1px dotted #fb4934d"}]}),V0e=_n({theme:"light",settings:{background:"#fbf1c7",foreground:"#3c3836",caret:"#af3a03",selection:"#bdae9391",selectionMatch:"#bdae9391",lineHighlight:"#a37f2238",gutterBackground:"#ebdbb2",gutterForeground:"#665c54"},styles:[{tag:y.keyword,color:"#9d0006"},{tag:[y.name,y.deleted,y.character,y.propertyName,y.macroName],color:"#427b58"},{tag:[y.variableName],color:"#076678"},{tag:[y.function(y.variableName)],color:"#79740e",fontStyle:"bold"},{tag:[y.labelName],color:"#3c3836"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#8f3f71"},{tag:[y.definition(y.name),y.separator],color:"#3c3836"},{tag:[y.brace],color:"#3c3836"},{tag:[y.annotation],color:"#9d0006"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#8f3f71"},{tag:[y.typeName,y.className],color:"#b57614"},{tag:[y.operator,y.operatorKeyword],color:"#9d0006"},{tag:[y.tagName],color:"#427b58",fontStyle:"bold"},{tag:[y.squareBracket],color:"#af3a03"},{tag:[y.angleBracket],color:"#076678"},{tag:[y.attributeName],color:"#427b58"},{tag:[y.regexp],color:"#427b58"},{tag:[y.quote],color:"#928374"},{tag:[y.string],color:"#3c3836"},{tag:y.link,color:"#7c6f64",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[y.url,y.escape,y.special(y.string)],color:"#8f3f71"},{tag:[y.meta],color:"#b57614"},{tag:[y.comment],color:"#928374",fontStyle:"italic"},{tag:y.strong,fontWeight:"bold",color:"#af3a03"},{tag:y.emphasis,fontStyle:"italic",color:"#79740e"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.heading,fontWeight:"bold",color:"#79740e"},{tag:[y.heading1,y.heading2],fontWeight:"bold",color:"#79740e"},{tag:[y.heading3,y.heading4],fontWeight:"bold",color:"#b57614"},{tag:[y.heading5,y.heading6],color:"#b57614"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#8f3f71"},{tag:[y.processingInstruction,y.inserted],color:"#076678"},{tag:[y.contentSeparator],color:"#9d0006"},{tag:y.invalid,color:"#af3a03",borderBottom:"1px dotted #9d0006"}]}),j0e=_n({theme:"dark",settings:{background:"#212121",foreground:"#bdbdbd",caret:"#a0a4ae",selection:"#d7d4f063",selectionMatch:"#d7d4f063",gutterBackground:"#212121",gutterForeground:"#999",lineHighlight:"#333333"},styles:[{tag:y.keyword,color:"#cf6edf"},{tag:[y.name,y.deleted,y.character,y.macroName],color:"#56c8d8"},{tag:[y.propertyName],color:"#82AAFF"},{tag:[y.variableName],color:"#bdbdbd"},{tag:[y.function(y.variableName)],color:"#82AAFF"},{tag:[y.labelName],color:"#cf6edf"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#facf4e"},{tag:[y.definition(y.name),y.separator],color:"#56c8d8"},{tag:[y.brace],color:"#cf6edf"},{tag:[y.annotation],color:"#f07178"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#f07178"},{tag:[y.typeName,y.className],color:"#f07178"},{tag:[y.operator,y.operatorKeyword],color:"#82AAFF"},{tag:[y.tagName],color:"#99d066"},{tag:[y.squareBracket],color:"#f07178"},{tag:[y.angleBracket],color:"#606f7a"},{tag:[y.attributeName],color:"#bdbdbd"},{tag:[y.regexp],color:"#f07178"},{tag:[y.quote],color:"#6abf69"},{tag:[y.string],color:"#99d066"},{tag:y.link,color:"#56c8d8",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[y.url,y.escape,y.special(y.string)],color:"#facf4e"},{tag:[y.meta],color:"#707d8b"},{tag:[y.comment],color:"#707d8b",fontStyle:"italic"},{tag:y.monospace,color:"#bdbdbd"},{tag:y.strong,fontWeight:"bold",color:"#f07178"},{tag:y.emphasis,fontStyle:"italic",color:"#99d066"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.heading,fontWeight:"bold",color:"#facf4e"},{tag:y.heading1,fontWeight:"bold",color:"#facf4e"},{tag:[y.heading2,y.heading3,y.heading4],fontWeight:"bold",color:"#facf4e"},{tag:[y.heading5,y.heading6],color:"#facf4e"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#56c8d8"},{tag:[y.processingInstruction,y.inserted],color:"#f07178"},{tag:[y.contentSeparator],color:"#56c8d8"},{tag:y.invalid,color:"#606f7a",borderBottom:"1px dotted #f07178"}]}),Z0e=_n({theme:"light",settings:{background:"#FAFAFA",foreground:"#90A4AE",caret:"#272727",selection:"#80CBC440",selectionMatch:"#80CBC440",gutterBackground:"#FAFAFA",gutterForeground:"#90A4AE",lineHighlight:"#CCD7DA50"},styles:[{tag:y.keyword,color:"#39ADB5"},{tag:[y.name,y.deleted,y.character,y.macroName],color:"#90A4AE"},{tag:[y.propertyName],color:"#6182B8"},{tag:[y.processingInstruction,y.string,y.inserted,y.special(y.string)],color:"#91B859"},{tag:[y.function(y.variableName),y.labelName],color:"#6182B8"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#39ADB5"},{tag:[y.definition(y.name),y.separator],color:"#90A4AE"},{tag:[y.className],color:"#E2931D"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#F76D47"},{tag:[y.typeName],color:"#E2931D",fontStyle:"#E2931D"},{tag:[y.operator,y.operatorKeyword],color:"#39ADB5"},{tag:[y.url,y.escape,y.regexp,y.link],color:"#91B859"},{tag:[y.meta,y.comment],color:"#90A4AE"},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.link,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:"#39ADB5"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#90A4AE"},{tag:y.invalid,color:"#E5393570"},{tag:y.strikethrough,textDecoration:"line-through"}]}),z0e=_n({theme:"dark",settings:{background:"#2e3440",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#00000073",selectionMatch:"#00000073",gutterBackground:"#2e3440",gutterForeground:"#4c566a",lineHighlight:"#4c566a29"},styles:[{tag:y.keyword,color:"#5e81ac"},{tag:[y.name,y.deleted,y.character,y.propertyName,y.macroName],color:"#88c0d0"},{tag:[y.variableName],color:"#8fbcbb"},{tag:[y.function(y.variableName)],color:"#8fbcbb"},{tag:[y.labelName],color:"#81a1c1"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#5e81ac"},{tag:[y.definition(y.name),y.separator],color:"#a3be8c"},{tag:[y.brace],color:"#8fbcbb"},{tag:[y.annotation],color:"#d30102"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#b48ead"},{tag:[y.typeName,y.className],color:"#ebcb8b"},{tag:[y.operator,y.operatorKeyword],color:"#a3be8c"},{tag:[y.tagName],color:"#b48ead"},{tag:[y.squareBracket],color:"#bf616a"},{tag:[y.angleBracket],color:"#d08770"},{tag:[y.attributeName],color:"#ebcb8b"},{tag:[y.regexp],color:"#5e81ac"},{tag:[y.quote],color:"#b48ead"},{tag:[y.string],color:"#a3be8c"},{tag:y.link,color:"#a3be8c",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[y.url,y.escape,y.special(y.string)],color:"#8fbcbb"},{tag:[y.meta],color:"#88c0d0"},{tag:[y.monospace],color:"#d8dee9",fontStyle:"italic"},{tag:[y.comment],color:"#4c566a",fontStyle:"italic"},{tag:y.strong,fontWeight:"bold",color:"#5e81ac"},{tag:y.emphasis,fontStyle:"italic",color:"#5e81ac"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.heading,fontWeight:"bold",color:"#5e81ac"},{tag:y.special(y.heading1),fontWeight:"bold",color:"#5e81ac"},{tag:y.heading1,fontWeight:"bold",color:"#5e81ac"},{tag:[y.heading2,y.heading3,y.heading4],fontWeight:"bold",color:"#5e81ac"},{tag:[y.heading5,y.heading6],color:"#5e81ac"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#d08770"},{tag:[y.processingInstruction,y.inserted],color:"#8fbcbb"},{tag:[y.contentSeparator],color:"#ebcb8b"},{tag:y.invalid,color:"#434c5e",borderBottom:"1px dotted #d30102"}]}),G0e=_n({theme:"dark",settings:{background:"#272822",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#49483E",selectionMatch:"#49483E",gutterBackground:"#272822",gutterForeground:"#FFFFFF70",lineHighlight:"#0000003b"},styles:[{tag:y.labelName,color:"#bababa"},{tag:[y.comment,y.documentMeta],color:"#8292a2"},{tag:[y.number,y.bool,y.null,y.atom],color:"#ae81ff"},{tag:[y.attributeValue,y.className,y.name],color:"#e6db74"},{tag:[y.propertyName,y.attributeName],color:"#a6e22e"},{tag:[y.variableName],color:"#9effff"},{tag:[y.squareBracket],color:"#bababa"},{tag:[y.string,y.special(y.brace)],color:"#e6db74"},{tag:[y.regexp,y.className,y.typeName,y.definition(y.typeName)],color:"#66d9ef"},{tag:[y.definition(y.variableName),y.definition(y.propertyName),y.function(y.variableName)],color:"#a6e22e"},{tag:[y.keyword,y.definitionKeyword,y.modifier,y.tagName,y.angleBracket],color:"#f92672"}]}),Ts={background:"#002B36",foreground:"#839496",selection:"#004454AA",cursor:"#D30102",activeLine:"#00cafe11",keyword:"#859900",variable:"#268BD2",function:"#268BD2",string:"#2AA198",constant:"#CB4B16",type:"#859900",class:"#268BD2",number:"#D33682",comment:"#586E75",heading:"#268BD2",invalid:"#DC322F",regexp:"#DC322F",tag:"#268BD2"},X0e=_n({theme:"dark",settings:{background:Ts.background,foreground:Ts.foreground,caret:Ts.cursor,selection:Ts.selection,selectionMatch:Ts.selection,gutterBackground:Ts.background,gutterForeground:Ts.foreground,lineHighlight:Ts.activeLine},styles:[{tag:y.keyword,color:Ts.keyword},{tag:[y.name,y.deleted,y.character,y.macroName],color:Ts.variable},{tag:[y.propertyName],color:Ts.function},{tag:[y.processingInstruction,y.string,y.inserted,y.special(y.string)],color:Ts.string},{tag:[y.function(y.variableName),y.labelName],color:Ts.function},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:Ts.constant},{tag:[y.definition(y.name),y.separator],color:Ts.variable},{tag:[y.className],color:Ts.class},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:Ts.number},{tag:[y.typeName],color:Ts.type,fontStyle:Ts.type},{tag:[y.operator,y.operatorKeyword],color:Ts.keyword},{tag:[y.url,y.escape,y.regexp,y.link],color:Ts.regexp},{tag:[y.meta,y.comment],color:Ts.comment},{tag:y.tagName,color:Ts.tag},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.link,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:Ts.heading},{tag:[y.atom,y.bool,y.special(y.variableName)],color:Ts.variable},{tag:y.invalid,color:Ts.invalid},{tag:y.strikethrough,textDecoration:"line-through"}]}),Fs={background:"#FDF6E3",foreground:"#657B83",selection:"#EEE8D5",selectionMatch:"#EEE8D5",cursor:"#657B83",activeLine:"#3d392d11",keyword:"#859900",variable:"#268BD2",function:"#268BD2",string:"#2AA198",constant:"#CB4B16",type:"#859900",class:"#268BD2",number:"#D33682",comment:"#93A1A1",heading:"#268BD2",invalid:"#DC322F",regexp:"#DC322F",tag:"#268BD2"},W0e=_n({theme:"light",settings:{background:Fs.background,foreground:Fs.foreground,caret:Fs.cursor,selection:Fs.selection,selectionMatch:Fs.selectionMatch,gutterBackground:Fs.background,gutterForeground:Fs.foreground,lineHighlight:Fs.activeLine},styles:[{tag:y.keyword,color:Fs.keyword},{tag:[y.name,y.deleted,y.character,y.macroName],color:Fs.variable},{tag:[y.propertyName],color:Fs.function},{tag:[y.processingInstruction,y.string,y.inserted,y.special(y.string)],color:Fs.string},{tag:[y.function(y.variableName),y.labelName],color:Fs.function},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:Fs.constant},{tag:[y.definition(y.name),y.separator],color:Fs.variable},{tag:[y.className],color:Fs.class},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:Fs.number},{tag:[y.typeName],color:Fs.type,fontStyle:Fs.type},{tag:[y.operator,y.operatorKeyword],color:Fs.keyword},{tag:[y.url,y.escape,y.regexp,y.link],color:Fs.regexp},{tag:[y.meta,y.comment],color:Fs.comment},{tag:y.tagName,color:Fs.tag},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.link,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:Fs.heading},{tag:[y.atom,y.bool,y.special(y.variableName)],color:Fs.variable},{tag:y.invalid,color:Fs.invalid},{tag:y.strikethrough,textDecoration:"line-through"}]}),q0e=_n({theme:"dark",settings:{background:"#303841",foreground:"#FFFFFF",caret:"#FBAC52",selection:"#4C5964",selectionMatch:"#3A546E",gutterBackground:"#303841",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},styles:[{tag:y.labelName,color:"#A2A9B5"},{tag:[y.meta,y.comment],color:"#A2A9B5"},{tag:[y.attributeName,y.keyword],color:"#B78FBA"},{tag:y.function(y.variableName),color:"#5AB0B0"},{tag:[y.string,y.regexp,y.attributeValue],color:"#99C592"},{tag:y.operator,color:"#f47954"},{tag:[y.tagName,y.modifier],color:"#E35F63"},{tag:[y.number,y.definition(y.tagName),y.className,y.definition(y.variableName)],color:"#fbac52"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#E35F63"},{tag:y.variableName,color:"#539ac4"},{tag:[y.propertyName,y.typeName],color:"#629ccd"},{tag:y.propertyName,color:"#36b7b5"}]}),U0e=_n({theme:"dark",settings:{background:"#1a1b26",foreground:"#787c99",caret:"#c0caf5",selection:"#515c7e40",selectionMatch:"#16161e",gutterBackground:"#1a1b26",gutterForeground:"#787c99",lineHighlight:"#474b6611"},styles:[{tag:y.keyword,color:"#bb9af7"},{tag:[y.name,y.deleted,y.character,y.macroName],color:"#c0caf5"},{tag:[y.propertyName],color:"#7aa2f7"},{tag:[y.processingInstruction,y.string,y.inserted,y.special(y.string)],color:"#9ece6a"},{tag:[y.function(y.variableName),y.labelName],color:"#7aa2f7"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#bb9af7"},{tag:[y.definition(y.name),y.separator],color:"#c0caf5"},{tag:[y.className],color:"#c0caf5"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#ff9e64"},{tag:[y.typeName],color:"#0db9d7"},{tag:[y.operator,y.operatorKeyword],color:"#bb9af7"},{tag:[y.url,y.escape,y.regexp,y.link],color:"#b4f9f8"},{tag:[y.meta,y.comment],color:"#444b6a"},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.link,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:"#89ddff"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#c0caf5"},{tag:y.invalid,color:"#ff5370"},{tag:y.strikethrough,textDecoration:"line-through"}]}),H0e=_n({theme:"dark",settings:{background:"#24283b",foreground:"#7982a9",caret:"#c0caf5",selection:"#6f7bb630",selectionMatch:"#343b5f",gutterBackground:"#24283b",gutterForeground:"#7982a9",lineHighlight:"#292e427a"},styles:[{tag:y.keyword,color:"#bb9af7"},{tag:[y.name,y.deleted,y.character,y.macroName],color:"#c0caf5"},{tag:[y.propertyName],color:"#7aa2f7"},{tag:[y.processingInstruction,y.string,y.inserted,y.special(y.string)],color:"#9ece6a"},{tag:[y.function(y.variableName),y.labelName],color:"#7aa2f7"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#bb9af7"},{tag:[y.definition(y.name),y.separator],color:"#c0caf5"},{tag:[y.className],color:"#c0caf5"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#ff9e64"},{tag:[y.typeName],color:"#2ac3de",fontStyle:"#2ac3de"},{tag:[y.operator,y.operatorKeyword],color:"#bb9af7"},{tag:[y.url,y.escape,y.regexp,y.link],color:"#b4f9f8"},{tag:[y.meta,y.comment],color:"#565f89"},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.link,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:"#89ddff"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#c0caf5"},{tag:y.invalid,color:"#ff5370"},{tag:y.strikethrough,textDecoration:"line-through"}]}),Y0e=_n({theme:"light",settings:{background:"#e1e2e7",foreground:"#3760bf",caret:"#3760bf",selection:"#99a7df",selectionMatch:"#99a7df",gutterBackground:"#e1e2e7",gutterForeground:"#3760bf",lineHighlight:"#5f5faf11"},styles:[{tag:y.keyword,color:"#007197"},{tag:[y.name,y.deleted,y.character,y.macroName],color:"#3760bf"},{tag:[y.propertyName],color:"#3760bf"},{tag:[y.processingInstruction,y.string,y.inserted,y.special(y.string)],color:"#587539"},{tag:[y.function(y.variableName),y.labelName],color:"#3760bf"},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:"#3760bf"},{tag:[y.definition(y.name),y.separator],color:"#3760bf"},{tag:[y.className],color:"#3760bf"},{tag:[y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:"#b15c00"},{tag:[y.typeName],color:"#007197",fontStyle:"#007197"},{tag:[y.operator,y.operatorKeyword],color:"#007197"},{tag:[y.url,y.escape,y.regexp,y.link],color:"#587539"},{tag:[y.meta,y.comment],color:"#848cb5"},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.link,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:"#b15c00"},{tag:[y.atom,y.bool,y.special(y.variableName)],color:"#3760bf"},{tag:y.invalid,color:"#f52a65"},{tag:y.strikethrough,textDecoration:"line-through"}]}),K0e=_n({theme:"dark",settings:{background:"#1e1e1e",foreground:"#fff",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383"},styles:[{tag:[y.keyword,y.operatorKeyword,y.modifier,y.color,y.constant(y.name),y.standard(y.name),y.standard(y.tagName),y.special(y.brace),y.atom,y.bool,y.special(y.variableName)],color:"#569cd6"},{tag:[y.controlKeyword,y.moduleKeyword],color:"#c586c0"},{tag:[y.name,y.deleted,y.character,y.macroName,y.propertyName,y.variableName,y.labelName,y.definition(y.name)],color:"#9cdcfe"},{tag:y.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[y.typeName,y.className,y.tagName,y.number,y.changed,y.annotation,y.self,y.namespace],color:"#4ec9b0"},{tag:[y.function(y.variableName),y.function(y.propertyName)],color:"#dcdcaa"},{tag:[y.number],color:"#b5cea8"},{tag:[y.operator,y.punctuation,y.separator,y.url,y.escape,y.regexp],color:"#d4d4d4"},{tag:[y.regexp],color:"#d16969"},{tag:[y.special(y.string),y.processingInstruction,y.string,y.inserted],color:"#ce9178"},{tag:[y.angleBracket],color:"#808080"},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:[y.meta,y.comment],color:"#6a9955"},{tag:y.link,color:"#6a9955",textDecoration:"underline"},{tag:y.invalid,color:"#ff0000"}]}),J0e=_n({theme:"light",settings:{background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893"},styles:[{tag:[y.keyword,y.operatorKeyword,y.modifier,y.color,y.constant(y.name),y.standard(y.name),y.standard(y.tagName),y.special(y.brace),y.atom,y.bool,y.special(y.variableName)],color:"#0000ff"},{tag:[y.moduleKeyword,y.controlKeyword],color:"#af00db"},{tag:[y.name,y.deleted,y.character,y.macroName,y.propertyName,y.variableName,y.labelName,y.definition(y.name)],color:"#0070c1"},{tag:y.heading,fontWeight:"bold",color:"#0070c1"},{tag:[y.typeName,y.className,y.tagName,y.number,y.changed,y.annotation,y.self,y.namespace],color:"#267f99"},{tag:[y.function(y.variableName),y.function(y.propertyName)],color:"#795e26"},{tag:[y.number],color:"#098658"},{tag:[y.operator,y.punctuation,y.separator,y.url,y.escape,y.regexp],color:"#383a42"},{tag:[y.regexp],color:"#af00db"},{tag:[y.special(y.string),y.processingInstruction,y.string,y.inserted],color:"#a31515"},{tag:[y.angleBracket],color:"#383a42"},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:[y.meta,y.comment],color:"#008000"},{tag:y.link,color:"#4078f2",textDecoration:"underline"},{tag:y.invalid,color:"#e45649"}]}),ebe=_n({theme:"light",settings:{background:"#fff",foreground:"#3D3D3D",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#AFAFAF",lineHighlight:"#d5e6ff69"},styles:[{tag:[y.comment,y.quote],color:"#707F8D"},{tag:[y.typeName,y.typeOperator],color:"#aa0d91"},{tag:[y.keyword],color:"#aa0d91",fontWeight:"bold"},{tag:[y.string,y.meta],color:"#D23423"},{tag:[y.name],color:"#032f62"},{tag:[y.typeName],color:"#522BB2"},{tag:[y.variableName],color:"#23575C"},{tag:[y.definition(y.variableName)],color:"#327A9E"},{tag:[y.regexp,y.link],color:"#0e0eff"}]}),tbe=_n({theme:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#FBAC52",selection:"#FFD420",selectionMatch:"#FFD420",gutterBackground:"#f5f5f5",gutterForeground:"#4D4D4C",lineHighlight:"#00000012"},styles:[{tag:[y.meta,y.comment],color:"#804000"},{tag:[y.keyword,y.strong],color:"#0000FF"},{tag:[y.number],color:"#FF0080"},{tag:[y.string],color:"#FF0080"},{tag:[y.variableName],color:"#006600"},{tag:[y.escape],color:"#33CC33"},{tag:[y.tagName],color:"#1C02FF"},{tag:[y.heading],color:"#0C07FF"},{tag:[y.quote],color:"#000000"},{tag:[y.list],color:"#B90690"},{tag:[y.documentMeta],color:"#888888"},{tag:[y.function(y.variableName)],color:"#0000A2"},{tag:[y.definition(y.typeName),y.typeName],color:"#6D79DE"}]}),nbe=_n({theme:"light",settings:{background:"#f2f1f8",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",selectionMatch:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#16067911"},styles:[{tag:y.comment,color:"#9995b7"},{tag:y.keyword,color:"#ff5792",fontWeight:"bold"},{tag:[y.definitionKeyword,y.modifier],color:"#ff5792"},{tag:[y.className,y.tagName,y.definition(y.typeName)],color:"#0094f0"},{tag:[y.number,y.bool,y.null,y.special(y.brace)],color:"#5842ff"},{tag:[y.definition(y.propertyName),y.function(y.variableName)],color:"#0095a8"},{tag:y.typeName,color:"#b3694d"},{tag:[y.propertyName,y.variableName],color:"#fa8900"},{tag:y.operator,color:"#ff5792"},{tag:y.self,color:"#e64100"},{tag:[y.string,y.regexp],color:"#00b368"},{tag:[y.paren,y.bracket],color:"#0431fa"},{tag:y.labelName,color:"#00bdd6"},{tag:y.attributeName,color:"#e64100"},{tag:y.angleBracket,color:"#9995b7"}]}),p9={strudelTheme:Jge,algoboy:u0e,archBtw:S0e,androidstudio:D0e,atomone:T0e,aura:F0e,bbedit:tbe,blackscreen:s0e,bluescreen:t0e,bluescreenlight:E0e,CutiePi:b0e,darcula:N0e,dracula:$0e,duotoneDark:R0e,eclipse:_0e,fruitDaw:M0e,githubDark:L0e,githubLight:I0e,greenText:k0e,gruvboxDark:Q0e,gruvboxLight:V0e,sonicPink:v0e,materialDark:j0e,materialLight:Z0e,monokai:G0e,noctisLilac:nbe,nord:z0e,redText:O0e,solarizedDark:X0e,solarizedLight:W0e,sublime:q0e,teletext:i0e,tokyoNight:U0e,tokyoNightDay:Y0e,tokyoNightStorm:H0e,vscodeDark:K0e,vscodeLight:J0e,whitescreen:r0e,xcodeLight:ebe},sbe=n=>p9[n]||p9.strudelTheme;let Ex={};const abe=n=>`slider_${n}`;let rbe=class extends ol{constructor(e,t,s,a,r,o,i){super(),this.value=e,this.min=t,this.max=s,this.from=a,this.originalFrom=a,this.to=r,this.step=o,this.view=i}eq(){return!1}toDOM(){let e=document.createElement("span");e.setAttribute("aria-hidden","true"),e.className="cm-slider";let t=e.appendChild(document.createElement("input"));return t.type="range",t.min=this.min,t.max=this.max,t.step=this.step??(this.max-this.min)/1e3,t.originalValue=this.value,t.value=t.originalValue,t.from=this.from,t.originalFrom=this.originalFrom,t.to=this.to,t.style="width:64px;margin-right:4px;transform:translateY(4px)",this.slider=t,t.addEventListener("input",s=>{const a=s.target.value;let r=a;const o=t.from+t.originalValue.length;let i={from:t.from,to:o,insert:r};t.originalValue=r,t.value=r,this.view.dispatch({changes:i});const l=abe(t.originalFrom);window.postMessage({type:"cm-slider",value:Number(a),id:l})}),e}ignoreEvent(e){return!0}};const obe=cn.define();function ibe(n,e){return n.filter(t=>t.type==="slider").map(({from:t,to:s,value:a,min:r,max:o,step:i})=>Et.widget({widget:new rbe(a,r,o,t,s,i,e),side:0}).range(t))}Ks.fromClass(class{constructor(n){la(this,"decorations");this.decorations=Et.set([])}update(n){n.transactions.forEach(e=>{var t,s;if(e.docChanged){this.decorations=this.decorations.map(e.changes);const a=this.decorations.iter();for(;a.value;)(s=(t=a.value)==null?void 0:t.widget)!=null&&s.slider&&(a.value.widget.slider.from=a.from,a.value.widget.slider.to=a.to),a.next()}for(let a of e.effects)a.is(obe)&&(this.decorations=Et.set(ibe(a.value,n.view)))})}},{decorations:n=>n.decorations});typeof window<"u"&&window.addEventListener("message",n=>{n.data.type==="cm-slider"&&(Ex[n.data.id]!==void 0?Ex[n.data.id]=n.data.value:console.warn(`slider with id "${n.data.id}" is not registered. Only ${Object.keys(Ex)}`))});const lbe=cn.define({map:({from:n,to:e},t)=>({from:t.mapPos(n),to:t.mapPos(e)})});function cbe(n){return n.sort((e,t)=>e.to-t.to).map(e=>Et.widget({widget:new hbe(e),side:0,block:!0}).range(e.to))}zs.define({create(){return Et.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(lbe))try{n=n.update({filter:()=>!1,add:cbe(t.value)})}catch(s){console.log("err",s)}return n},provide:n=>ut.decorations.from(n)});const q_={};function ube(n,e){q_[n]=e,e.id=n}let hbe=class extends ol{constructor(e){super(),this.widgetConfig=e}eq(){return!0}toDOM(){const e=pA(this.widgetConfig);return q_[e]}ignoreEvent(e){return!0}};function zm(n,e){L_(n),e&&(Yl.prototype[n]=function(t,s={fold:1}){return e(t,s,this)})}function Gm(n,e={}){const{width:t=500,height:s=60,pixelRatio:a=window.devicePixelRatio}=e;let r=document.getElementById(n)||document.createElement("canvas");return r.width=t*a,r.height=s*a,r.style.width=t+"px",r.style.height=s+"px",ube(n,r),r}zm("_pianoroll",(n,e={},t)=>{const s=Gm(n,e).getContext("2d");return t.tag(n).pianoroll({fold:1,...e,ctx:s,id:n})});zm("_punchcard",(n,e={},t)=>{const s=Gm(n,e).getContext("2d");return t.tag(n).punchcard({fold:1,...e,ctx:s,id:n})});zm("_spiral",(n,e={},t)=>{let s=e.size||275;e={width:s,height:s,...e,size:s/5};const a=Gm(n,e).getContext("2d");return t.tag(n).spiral({...e,ctx:a,id:n})});zm("_scope",(n,e={},t)=>{e={width:500,height:60,pos:.5,scale:1,...e};const s=Gm(n,e).getContext("2d");return t.tag(n).scope({...e,ctx:s,id:n})});zm("_pitchwheel",(n,e={},t)=>{let s=e.size||200;e={width:s,height:s,...e,size:s/5};const a=Gm(n,e).getContext("2d");return t.pitchwheel({...e,ctx:a,id:n})});zm("_spectrum",(n,e={},t)=>{let s=e.size||200;e={width:s,height:s,...e,size:s/5};const a=Gm(n,e).getContext("2d");return t.spectrum({...e,ctx:a,id:n})});x6(),GM(),Mie(),zie(),Wie(),Qc.of([...x$,...ow,...XM]);x6(),GM(),xie(),Jv(a$,{fallback:!0}),Qc.of([...ow,...XM]);const dbe={isLineWrappingEnabled:n=>n?ut.lineWrapping:[],isBracketMatchingEnabled:n=>n?l$({brackets:"()[]{}<>"}):[],isBracketClosingEnabled:n=>n?y$():[],isLineNumbersDisplayed:n=>n?r2():[],theme:sbe,isAutoCompletionEnabled:Lge,isTooltipEnabled:Vge,isPatternHighlightingEnabled:L2,isActiveLineHighlighted:n=>n?[Lie(),mle()]:[],isFlashEnabled:zge,keybindings:Yge,isTabIndentationEnabled:n=>n?Qc.of([ede]):[],isMultiCursorEnabled:n=>n?[cs.allowMultipleSelections.of(!0),ut.clickAddsSelectionRange.of(e=>e.metaKey||e.ctrlKey)]:[]};Object.fromEntries(Object.keys(dbe).map(n=>[n,new Bg]));const mbe={keybindings:"codemirror",isBracketMatchingEnabled:!1,isBracketClosingEnabled:!0,isLineNumbersDisplayed:!0,isActiveLineHighlighted:!1,isAutoCompletionEnabled:!1,isPatternHighlightingEnabled:!0,isFlashEnabled:!0,isTooltipEnabled:!1,isLineWrappingEnabled:!1,isTabIndentationEnabled:!1,isMultiCursorEnabled:!1,theme:"strudelTheme",fontFamily:"monospace",fontSize:18};Yfe("codemirror-settings",mbe,{encode:JSON.stringify,decode:JSON.parse});HJ("markcss");const pbe=new Map,Q2=cn.define(),U_=zs.define({create(){return Et.none},update(n,e){e.docChanged&&(n=n.map(e.changes));for(const t of e.effects)if(t.is(Q2))return t.value;return n},provide:n=>ut.decorations.from(n)}),fbe=Et.mark({class:"cm-master-highlight"});function gbe(n,e={}){const{theme:t="light",placeholder:s="",lineNumbers:a=!0,autofocus:r=!1,onUpdate:o=null}=e,i=n.value||"",l=[a?r2():[],GM(),_ce(),l$(),y$(),ode(),Qc.of([...x$,...ow,...XM,...Nce]),the(),pu.data.of({closeBrackets:{brackets:["(","[","{","'",'"',"<"]},bracketMatching:{brackets:["(","[","{","'",'"',"<"]}}),Jv(a$),ut.lineWrapping,ut.updateListener.of(u=>{if(u.docChanged&&o){const h=u.state.doc.toString();o(h)}if(u.docChanged){const h=u.state.doc.toString();n.value=h;const m=new Event("input",{bubbles:!0});n.dispatchEvent(m)}}),ut.contentAttributes.of({"data-placeholder":s}),ut.baseTheme({"&.cm-editor":{outline:"none",position:"relative",boxSizing:"border-box"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:"1.4",height:"100%",overflowX:"auto",position:"relative",zIndex:"0"},".cm-content":{margin:"0",flexGrow:"2",flexShrink:"0",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none",minHeight:"120px"},".cm-lineWrapping":{whiteSpace:"pre-wrap",overflowWrap:"anywhere"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-gutters":{flexShrink:"0",display:"flex",height:"100%",boxSizing:"border-box",left:"0",zIndex:"200"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:"0",boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",color:"#999",whiteSpace:"nowrap"}}),ut.theme({"&.cm-editor":{fontSize:"14px",fontFamily:"'Courier New', Courier, monospace",border:"1px solid rgba(102, 126, 234, 0.25)",borderRadius:"12px",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"inset 0 0 0 1px rgba(255, 255, 255, 0.5)",overflow:"hidden"},".cm-content":{minHeight:"120px",padding:"8px",caretColor:"#000"},".cm-focused":{outline:"none"},".cm-editor.cm-focused":{borderColor:"#667eea",backgroundColor:"#fff",boxShadow:"inset 0 0 0 1px rgba(255, 255, 255, 0.5), 0 0 0 2px rgba(102, 126, 234, 0.2)"},".cm-placeholder":{color:"#999",fontStyle:"italic"},".cm-gutters":{backgroundColor:"rgba(245, 245, 245, 0.5)",color:"#999",border:"none",borderRight:"1px solid rgba(102, 126, 234, 0.15)"},".cm-kn":{color:"#002610"},".cm-kl":{color:"#002610"},".cm-kq":{color:"#400707"},".cm-jz":{color:"#400707"},".cm-kv":{color:"#400707"},".cm-kh":{color:"#400707"},".cm-string":{color:"#1a1a1a"},".cm-string1":{color:"#1a1a1a"},".cm-string2":{color:"#1a1a1a"}})];l.push(U_),t==="dark"&&l.push(fhe),r2||l.push(ut.lineWrapping);let c;try{c=new ut({doc:i,extensions:l}),n.style.display="none",n.parentNode.insertBefore(c.dom,n),console.log(`✅ Editor created and inserted for ${n.id||"textarea"}`)}catch(u){return console.error("❌ Error creating Strudel REPL editor:",u),console.error("   Error details:",u.message,u.stack),null}return c&&(c.getTextarea=()=>n,c.getValue=()=>c.state.doc.toString(),c.setValue=u=>{if(c.state.doc.toString()!==u){c.dispatch({changes:{from:0,to:c.state.doc.length,insert:u||""}}),n.value=u||"";const m=new Event("input",{bubbles:!0});n.dispatchEvent(m)}}),r&&c.focus(),c}function bbe(){try{console.log("🎨 Initializing Strudel REPL editors...");const n=document.querySelectorAll("strudel-editor[data-strudel-repl], strudel-editor#master-pattern");if(console.log(`   Found ${n.length} strudel-editor components`),n.forEach(e=>{if(e.editor)console.log(`✅ strudel-editor already initialized for ${e.id||"unnamed"}`);else{const t=setInterval(()=>{e.editor&&(console.log(`✅ strudel-editor ready for ${e.id||"unnamed"}`),clearInterval(t))},100);setTimeout(()=>clearInterval(t),5e3)}}),typeof ut<"u"){const e=document.querySelectorAll("textarea[data-strudel-repl], textarea#modal-pattern");console.log(`   Found ${e.length} textareas to initialize:`,Array.from(e).map(t=>t.id||"unnamed")),e.forEach(t=>{if(t.tagName==="TEXTAREA"&&!t.dataset.strudelReplInitialized){const s=t.id==="modal-pattern";console.log(`   Initializing editor for: ${t.id||"unnamed textarea"}`);const a=t.placeholder||"";try{const r=gbe(t,{theme:"light",placeholder:a,lineNumbers:!0,autofocus:!1,onUpdate:o=>{t.value=o}});r?(t.dataset.strudelReplInitialized="true",t._strudelEditor=r,pbe.set(t.id,r),console.log(`   ✅ Successfully created editor for ${t.id||"textarea"}`)):console.warn(`   ⚠️ Editor creation returned null for ${t.id||"textarea"}`)}catch(r){console.error(`   ❌ Error creating editor for ${t.id||"textarea"}:`,r)}}else t.dataset.strudelReplInitialized&&console.log(`   ⏭️ Skipping ${t.id||"unnamed"} - already initialized`)})}else console.warn("⚠️ CodeMirror EditorView is not available - textarea editors will not be initialized");console.log("✅ Strudel REPL editors initialization complete")}catch(n){console.error("❌ Error initializing Strudel REPL editors:",n)}}function Wg(n){const e=typeof n=="string"?document.getElementById(n):n;return e?e.tagName==="STRUDEL-EDITOR"&&e.editor?e.editor:e._strudelEditor?e._strudelEditor:null:null}function Qn(n){const e=Wg(n);if(e){if(e.getCode&&typeof e.getCode=="function")return e.getCode();if(e.getValue&&typeof e.getValue=="function")return e.getValue()}const t=typeof n=="string"?document.getElementById(n):n;return t?t.tagName==="STRUDEL-EDITOR"?t.getAttribute("code")||"":t.value||"":""}function Vn(n,e){const t=Wg(n);if(t){if(t.setCode&&typeof t.setCode=="function"){t.setCode(e);return}if(t.setValue&&typeof t.setValue=="function"){t.setValue(e);return}}const s=typeof n=="string"?document.getElementById(n):n;if(s){if(s.tagName==="STRUDEL-EDITOR"){s.setAttribute("code",e);return}s.value=e;const a=new Event("input",{bubbles:!0});s.dispatchEvent(a)}}function ybe(n,e){const t=Wg(n),s=document.getElementById(n);t&&t.contentDOM&&(t.contentDOM.setAttribute("contenteditable",e?"true":"false"),t.dom.classList.toggle("cm-readonly",!e)),s&&(s.readOnly=!e,s.classList.toggle("pattern-editor-readonly",!e))}function H_(n,e=[]){const t=Wg(n);if(!t){console.warn(`⚠️ CodeMirror editor not found for ${n}`);return}const s=t.editor?t.editor:t;if(!s||!s.state||!s.state.doc){console.warn(`⚠️ CodeMirror EditorView not available for ${n}`);return}let a=!1;try{a=s.state.field(U_)!==void 0}catch{a=!1}if(typeof Mx=="function"&&L2&&L2())try{const l=e.map(c=>({start:c.from,end:c.to}));if(l.length>0){Mx(s,l),console.log(`✅ Applied ${e.length} highlight range(s) using Strudel's built-in highlighting`);return}else{Mx(s,[]);return}}catch(l){console.warn("⚠️ Strudel built-in highlighting failed, falling back to custom:",l)}if(!a){if(e.length===0)return;console.warn("⚠️ highlightField not registered on editor. Cannot apply custom highlights.");return}const r=s.state.doc,o=[];Array.isArray(e)&&e.forEach(l=>{if(!l||typeof l.from!="number"||typeof l.to!="number")return;const c=Math.max(0,Math.min(r.length,Math.floor(l.from))),u=Math.max(c,Math.min(r.length,Math.ceil(l.to)));c!==u&&o.push(fbe.range(c,u))});const i=o.length>0?Et.set(o.sort((l,c)=>l.from-c.from)):Et.none;try{s.dispatch({effects:Q2.of(i)}),e.length>0?console.log(`✅ Applied ${e.length} highlight range(s) to CodeMirror editor (custom system)`):s.dispatch({effects:Q2.of(Et.none)})}catch(l){console.warn("⚠️ Error applying highlights to CodeMirror editor:",l)}}function f9(n,e,t={}){if(!e||typeof e!="string")return;const s=typeof t.cursorOffset=="number"?t.cursorOffset:null,a=Wg(n);if(a){const f=a,{state:v}=f,O=v.selection.main,k=O.from,M=O.to,E=g9(e,()=>{let D=k;for(;D>0;){const F=v.doc.sliceString(D-1,D);if(D-=1,!/\s/.test(F))return F}return""}),I=s!==null?s:E.endsWith("()")||E.endsWith("{}")?1:0;f.dispatch({changes:{from:k,to:M,insert:E},selection:Ve.cursor(Math.max(k+E.length-I,0)),scrollIntoView:!0}),f.focus();return}const r=document.getElementById(n);if(!r)return;const o=typeof r.selectionStart=="number"?r.selectionStart:r.value.length,i=typeof r.selectionEnd=="number"?r.selectionEnd:r.value.length,l=r.value.slice(0,o),c=r.value.slice(i),u=g9(e,()=>{let f=o;for(;f>0;){const v=r.value.charAt(f-1);if(f-=1,!/\s/.test(v))return v}return""});r.value=`${l}${u}${c}`;const h=s!==null?s:u.endsWith("()")||u.endsWith("{}")?1:0,m=Math.max(o+u.length-h,0);typeof r.setSelectionRange=="function"&&r.setSelectionRange(m,m),r.dispatchEvent(new Event("input",{bubbles:!0})),r.focus()}function g9(n,e){if(!n||n.trimStart().startsWith(".")||/^\s/.test(n))return n;const s=typeof e=="function"?e():"";return!s||s==="."||/\s/.test(s)||/[\(\[\{,]/.test(s)?n:`.${n}`}const fA="master-pattern";let gu=null,My=!1,Dx=!1;function vbe(n){const e=[],t=new Set;if(!Array.isArray(n))return e;const s=Qn(fA)||"";if(!s)return e;const a=Y_(s);return n.forEach((r,o)=>{var l;const i=(l=r==null?void 0:r.context)==null?void 0:l.locations;if(!Array.isArray(i)){Math.random()<.1&&o===0&&console.log("🔍 Debug collectActiveRanges: Hap has no locations array",{hasContext:!!(r!=null&&r.context),contextKeys:r!=null&&r.context?Object.keys(r.context):[],locationsType:typeof i,locationsValue:i,fullContext:r==null?void 0:r.context});return}i.forEach((c,u)=>{if(typeof(c==null?void 0:c.start)!="number"&&typeof(c==null?void 0:c.from)!="number"){Math.random()<.01&&o===0&&u===0&&console.log("🔍 Debug: Location has unexpected structure",{location:c,locationKeys:c?Object.keys(c):[],hasStart:typeof(c==null?void 0:c.start)=="number",hasFrom:typeof(c==null?void 0:c.from)=="number",hasEnd:typeof(c==null?void 0:c.end)=="number",hasTo:typeof(c==null?void 0:c.to)=="number"});return}const h=c.start??c.from,m=c.end??c.to;if(typeof h!="number"||typeof m!="number")return;let f=Math.max(0,Math.min(h,m)),v=Math.max(f,Math.max(h,m));const O=a.length;if(f>O)return;v=Math.min(v,O);const k=wbe(f,v,a,s),M=`${k.from}:${k.to}`;t.has(M)||(t.add(M),e.push({from:k.from,to:k.to}))})}),e}function Y_(n){if(!n)return"";const e="// Controls Selected Tempo:";let t=n.split(`
`).filter(s=>!s.trim().startsWith(e)).join(`
`);return t=t.replace(/\/\/.*$/gm,""),t=t.replace(/\/\*[\s\S]*?\*\//g,s=>/\/\*\s*Channel\s+\d+\s*\*\//i.test(s)?s:""),t=t.replace(/\n\s*\n\s*\n/g,`

`).trim(),t}function wbe(n,e,t,s){if(t===s)return{from:n,to:e};const a=new Map;let r=0,o=0,i=0;for(;i<s.length&&r<t.length;){const f=s.substring(i);if(f.startsWith("//")){const k=f.indexOf(`
`);if(k!==-1)i+=k+1,o+=k+1;else break;continue}if(f.startsWith("/*")){const k=f.indexOf("*/");if(k!==-1){const M=f.substring(0,k+2);if(/\/\*\s*Channel\s+\d+\s*\*\//i.test(M)){for(let I=0;I<M.length&&r<t.length;I++)t[r]===M[I]&&(a.set(r,o+I),r++);i+=M.length,o+=M.length}else i+=k+2,o+=k+2;continue}else break}const v=s[i],O=t[r];v===O||/\s/.test(v)&&/\s/.test(O)?(a.set(r,o),r++,o++,i++):/\s/.test(v)?(o++,i++):/\s/.test(O)?r++:(r++,o++,i++)}const l=a.get(n),c=a.get(e);if(l!==void 0&&c!==void 0)return{from:l,to:c};if(a.size>0){let f=-1,v=-1,O=1/0,k=1/0;for(const[M,E]of a.entries())M<=n&&M>f&&(f=M,v=E),M>=n&&M<O&&(O=M,k=E);if(f>=0){const M=v-f;return{from:n+M,to:e+M}}if(O<1/0){const M=k-O;return{from:n+M,to:e+M}}}const u=s.split(`
`);let h=0,m=!1;for(let f=0;f<u.length&&!m;f++){const v=u[f],O=v.trim(),k=Y_(v);O.startsWith("//")||O.startsWith("/*")||O.startsWith("*")||O===""&&!m||k.trim()===""&&O!==""?h+=v.length+1:k.trim()!==""&&(m=!0)}return{from:n+h,to:e+h}}function V2(){var t;if(!My){gu=null;return}const n=(t=window==null?void 0:window.strudel)==null?void 0:t.scheduler,e=n==null?void 0:n.pattern;if(!n||typeof n.now!="function"||!e||typeof e.queryArc!="function"){Dx||(console.warn("⚠️ Unable to update highlights - Strudel scheduler not ready."),Dx=!0),gu=requestAnimationFrame(V2);return}Dx=!1;try{const r=n.now(),o=Math.max(0,r-.05),i=r+.05,l=e.queryArc(o,i)||[];l.length>0&&l.length<=5&&(l.some(h=>{var m,f;return((f=(m=h==null?void 0:h.context)==null?void 0:m.locations)==null?void 0:f.length)>0})||(console.warn("⚠️ Haps found but no location data. Pattern may not have withLoc enabled or locations not preserved."),console.log("Sample hap:",l[0])));const c=vbe(l);if(c.length>0)console.log(`🎯 Highlighting ${c.length} active range(s) at time ${r.toFixed(3)}`,c);else if(l.length>0&&Math.random()<.1&&(console.log(`ℹ️ Found ${l.length} hap(s) but no highlight ranges (missing location data?)`),l[0])){const u=l[0],h=u.context||{},m=h.locations;let f="Unable to serialize";try{f=JSON.stringify({hapKeys:Object.keys(u),context:h,value:u.value,whole:u.whole?{begin:u.whole.begin,end:u.whole.end}:null,part:u.part?{begin:u.part.begin,end:u.part.end}:null},null,2).substring(0,1e3)}catch(v){f=`Serialization error: ${v.message}`}console.log("🔍 Sample hap structure:",{hasContext:!!u.context,contextKeys:u.context?Object.keys(u.context):[],hasLocations:!!m,locationType:typeof m,isArray:Array.isArray(m),locationCount:Array.isArray(m)?m.length:0,firstLocation:Array.isArray(m)&&m.length>0?m[0]:null,fullStructure:f}),console.log("🔍 Raw hap object:",u)}H_(fA,c)}catch(s){console.warn("⚠️ Unable to update code highlights:",s)}gu=requestAnimationFrame(V2)}function Tx(){My||(My=!0,console.log("✅ Starting master pattern highlighting"),gu||(gu=requestAnimationFrame(V2)))}function Fx(){My=!1,gu&&(cancelAnimationFrame(gu),gu=null),H_(fA,[])}const Obe=new URL("../../",import.meta.url);function K_(n){if(!n||typeof n!="string")return"";const e=n.replace(/^\/+/,"");return new URL(e,Obe).href}function Wo(n=[]){return Array.isArray(n)?n.map(e=>K_(e)):[]}let Nx=null,b9=null,y9=null,v9=null,w9=null,j2=null,O9=null;const xbe=(n,e)=>{if(!n||!e)return n;try{return new URL(n,e).toString()}catch{return n}},Z2=(n,e)=>{if(typeof n=="string")return xbe(n,e);if(Array.isArray(n))return n.map(t=>Z2(t,e));if(n&&typeof n=="object"){const t={};return Object.entries(n).forEach(([s,a])=>{t[s]=Z2(a,e)}),t}return n},kbe=n=>{if(!n||typeof n!="object")return n;const e=n._base||"",t={};return Object.entries(n).forEach(([s,a])=>{s!=="_base"&&(t[s]=Z2(a,e))}),t},Bx="https://raw.githubusercontent.com/felixroos/dough-samples/main";async function bc(){return Nx||(Nx=Promise.all([gs(()=>import("./strudel-core-cY4HxVpV.js").then(n=>n.A),[]),gs(()=>import("./strudel-web-vUJZkE4C.js").then(n=>n.i),__vite__mapDeps([0,1])),gs(()=>import("./strudel-web-vUJZkE4C.js").then(n=>n.b),__vite__mapDeps([0,1])),gs(()=>import("./index-CUU9O0BO.js"),__vite__mapDeps([2,1,0])),gs(()=>import("./index-DgT90eBX.js"),__vite__mapDeps([3,1,0])).catch(()=>null)]).then(n=>(b9=n[0],v9=n[1],y9=n[2],w9=n[3],j2=n[4],O9=null,{coreModule:b9,webModule:v9,webaudioModule:y9,tonalModule:w9,midiModule:j2,samplerModule:O9}))),Nx}const tf={superpiano:"piano",wood:"jazz"};function $x(n){if(!n||typeof n!="string")return n;let e=n;for(const[t,s]of Object.entries(tf)){const a=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp(`(\\.s\\(["'])${a}(["']\\))`,"gi");e=e.replace(r,(i,l,c)=>`${l}${s}${c}`);const o=new RegExp(`(sound\\(["'])${a}(["']\\))`,"gi");e=e.replace(o,(i,l,c)=>`${l}${s}${c}`)}return e}const Rx={major:"major",minor:"minor",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic",ionian:"major",aeolian:"minor","melodic minor":"melodic minor","dorian b2":"dorian b2","lydian augmented":"lydian augmented","lydian dominant":"lydian dominant","mixolydian b6":"mixolydian b6","locrian #2":"locrian #2",altered:"altered","harmonic minor":"harmonic minor","locrian #6":"locrian #6","ionian #5":"ionian #5","dorian #4":"dorian #4","phrygian dominant":"phrygian dominant","lydian #2":"lydian #2",ultralocrian:"ultralocrian","harmonic major":"harmonic major","dorian b5":"dorian b5","phrygian b4":"phrygian b4","lydian b3":"lydian b3","mixolydian b2":"mixolydian b2","lydian augmented #2":"lydian augmented #2","locrian bb7":"locrian bb7","major pentatonic":"major pentatonic","suspended pentatonic":"suspended pentatonic","man gong":"man gong",ritusen:"ritusen","minor pentatonic mode 5":"minor pentatonic","minor pentatonic":"minor pentatonic","blues minor pentatonic":"minor pentatonic","major pentatonic mode 3":"major pentatonic",egyptian:"egyptian","minor pentatonic mode 5":"minor pentatonic","whole tone":"whole tone","half-whole diminished":"dominant diminished","whole-half diminished":"diminished","minor blues":"blues"};function x9(n){const e=/(\s+|[,;:<>()[\]{}|\\/]+|\*+)/g,t=n.split(e);let s=!1,a=null;for(let r=0;r<t.length;r++){const o=t[r];if(!o||e.test(o)){e.lastIndex=0;continue}const i=o.match(/^([a-gA-G])([#b]?)(-?\d+)?(@[\d.]+)?$/);if(!i){e.lastIndex=0;continue}const l=i[1].toUpperCase(),c=i[2]||"",u=i[3]?parseInt(i[3],10):null,h=i[4]||"",m=[];u!==null&&!Number.isNaN(u)&&m.push(u),a!==null&&(m.push(Math.round(a/12)-1),m.push(Math.round(a/12)),m.push(Math.round(a/12)+1)),m.push(3,4,5);let f=null;for(const k of m){const M=`${l}${c}${k}`,E=hr.get(M);if(E&&Number.isFinite(E.midi)){f=E;break}}if(!f||!Number.isFinite(f.midi))return null;const v=Math.round(f.midi);a===null&&(a=v);const O=v-a;t[r]=String(O)+h,s=!0,e.lastIndex=0}return s?t.join(""):null}function k9(n){if(!n||typeof n!="string")return n;const e=/\bnote\s*\(\s*([a-gA-G][^'"()]*?)\s*\)/gi;let t=n.replace(e,(a,r)=>{const o=(r||"").trim();if(!o)return a;const i=x9(o);return i===null?a:`n("${i}")`});const s=/\bnote\s*\(\s*(['"])([\s\S]*?)\1\s*\)/gi;return t=t.replace(s,(a,r,o)=>{const i=x9(o);return i===null?a:`n(${r}${i}${r})`}),t}let P9=!1,_x=null,Lx=null;function ah(){if(P9)return;P9=!0,_x=_x||console.error,Lx=Lx||console.warn;const n=e=>{if(e&&e.length>0){let t="",s=null;if(typeof e[0]=="string"?t=e[0]:e[0]instanceof Error||typeof e[0]=="object"&&e[0]!==null?(t=e[0].message||String(e[0]),s=e[0]):t=String(e[0]),t.includes("AudioContext")&&(t.includes("not allowed")||t.includes("start")||t.includes("resume")||t.includes("user gesture"))||t.includes("@strudel/core was loaded more than once")||t.includes("undefined instead of pattern")||t.includes('got "undefined" instead of pattern')||t.includes("got undefined instead of pattern")||t.includes("Pattern evaluation failed: got undefined"))return!0;let a=t;for(let o=0;o<e.length;o++)(typeof e[o]=="string"||e[o]&&e[o].toString)&&(a+=" "+String(e[o]));const r=a.toLowerCase();if(a.includes("not found! Is it loaded?")||a.includes("not found")||r.includes("not found")||a.includes("sound ")&&a.includes("not found")||a.includes("[getTrigger] error")||a.includes("[getTrigger]")||t.includes("[getTrigger]")||a.includes("[eval] error")||a.includes("[eval]")||t.includes("[eval]")||a.includes("Unexpected token")||a.includes("createPeriodicWave")||a.includes("length of the real array provided (0)")||a.includes("minimum bound (2)")||a.includes('got "undefined" instead of pattern')||a.includes("got undefined instead of pattern")||a.includes("undefined instead of pattern")||r.includes("undefined instead of pattern")||t.includes("undefined instead of pattern")||a.includes("RolandTR909")||a.includes("RolandTR808")||a.includes("RolandTR")||r.includes("rolandtr")||t.includes("RolandTR")||a.includes("[superdough]")||a.includes("cannot schedule sounds in the past")||t.includes("[superdough]")||t.includes("cannot schedule sounds in the past")||(t.includes("SyntaxError")||a.includes("SyntaxError"))&&(t.includes("JSON")||a.includes("JSON"))||t.includes("<!DOCTYPE")||a.includes("<!DOCTYPE")||t.includes("Unexpected token")&&t.includes("<")||a.includes("Unexpected token")&&a.includes("<")||t.includes("is not valid JSON")||a.includes("is not valid JSON")||a.includes("Unexpected non-whitespace character after JSON")||a.includes("Unexpected token")&&a.includes("JSON")||a.includes("error loading")&&(a.includes("CycleTones")||a.includes("strudel.json"))||a.includes("Failed to load default sound banks")||t.includes("Failed to load default sound banks")||s&&s.isUndefinedPattern===!0)return!0}return!1};console.error=(...e)=>{const t=n(e);if(!t&&e.length>0){const s=e[0],a=typeof s=="string"?s:String(s);if(a.includes("[eval]")||a.includes("[getTrigger]")||a.includes("RolandTR")||a.includes("undefined instead of pattern")||a.includes("not found")||a.includes("createPeriodicWave")||a.includes("length of the real array provided (0)")||a.includes("minimum bound (2)")||a.includes("Unexpected token"))return}t||_x.apply(console,e)},console.warn=(...e)=>{const t=n(e);if(!t&&e.length>0){const s=e[0],a=typeof s=="string"?s:String(s);if(a.includes("[eval]")||a.includes("[getTrigger]")||a.includes("RolandTR")||a.includes("undefined instead of pattern")||a.includes("not found")||a.includes("[superdough]")||a.includes("cannot schedule sounds in the past")||a.includes("CycleTones not available")||a.includes("falling back to dirt-samples")||a.includes("createPeriodicWave")||a.includes("length of the real array provided (0)")||a.includes("minimum bound (2)")||a.includes("Unexpected token"))return}t||Lx.apply(console,e)}}ah();function _a(n,...e){try{n&&typeof n._logRoute=="function"&&n._logRoute(...e)}catch{}}class Pbe{constructor(){this.audioContext=null,this.appInstance=null,this.volume=fs.defaults.volume,this.activeSounds=new Map,this.audioBuffers=new Map,this.oscillators=new Map,this.elementGainNodes=new Map,this.elementPanNodes=new Map,this.elementGainValues=new Map,this.elementPanValues=new Map,this.currentEvaluatingSlot=null,this.initialized=!1,this.strudelSoundBanksLoaded=!1,this.strudelSoundBankLoading=!1,this.soundsPreloaded=!1,this.onSoundsReadyCallback=null,this.onMasterPatternUpdateCallback=null,this.onMasterStateChangeCallback=null,this.strudelLoading=!1,this.strudelLoaded=!1,this.strudelPatternSlots=new Map,this.patternSlotToElementId=new Map,this.nextPatternSlot=1,this.previewSlotName="d16",this.reservedSlots=new Set([this.previewSlotName]),this.loadedBanks=new Set,this.defaultTempo=120,this.currentTempo=this.defaultTempo,this.tempoUserAdjusted=!1,this.currentKey="C",this.currentScale="chromatic",this.currentTimeSignature="",this.patternCache=new Map,this.masterGainNode=null,this._manualStrudelOutputNode=null,this._manualStrudelOutputDisabled=!1,this.masterPanNode=null,this.masterFilterNode=null,this.masterDryGainNode=null,this.masterDelayNode=null,this.masterReverbNode=null,this.masterDelayGainNode=null,this.masterDelayFeedbackGainNode=null,this.masterReverbGainNode=null,this.editorHighlightingEnabled=!1,this.masterVolume=.7,this.masterPan=0,this.masterMuted=!1,this.masterVolumeBeforeMute=.7,this.masterFilterEnabled=!1,this.masterFilterFrequency=2e3,this.masterFilterResonance=.7,this.masterFilterMinHz=80,this.masterFilterMaxHz=8e3,this.masterFilterBypassHz=2e4,this.masterFilterMinQ=.1,this.masterFilterMaxQ=5,this.masterFilterSmoothing=.05,this.masterFilterMinUpdateMs=16,this._lastMasterFilterUpdateTime=0,this._masterFilterUpdateTimeout=null,this.masterDelayAmount=0,this.masterDelayFeedback=.5,this.masterDelayTime=.25,this.masterReverbAmount=0,this.masterReverbRoomSize=.5,this.visualizerAnalyser=null,this.visualizerAnalyserTapGain=null,this.visualizerAnalyserTapGainConnected=!1,this.debugAudioRouting=!1,this._logRoute=(...e)=>{this.debugAudioRouting&&console.log(...e)},this._verifyMasterChainConnection=()=>{var a,r,o,i,l,c;if(!this.masterGainNode||!this._realDestination)return console.error("❌ CRITICAL: Master chain incomplete - masterGainNode or _realDestination missing"),!1;const e=this.masterGainNode.gain.value,t=this.masterMuted;e===0&&!t&&console.warn("⚠️ Master gain is 0 - audio will be silent"),t&&console.warn("⚠️ Master is muted - audio will be silent");const s={masterPanNode:!!this.masterPanNode,masterFilterNode:!!this.masterFilterNode,masterDryGainNode:!!this.masterDryGainNode,masterGainNode:!!this.masterGainNode,realDestination:!!this._realDestination,masterGain:e,masterDryGain:((r=(a=this.masterDryGainNode)==null?void 0:a.gain)==null?void 0:r.value)??"N/A",masterPan:((i=(o=this.masterPanNode)==null?void 0:o.pan)==null?void 0:i.value)??"N/A",masterFilterFreq:((c=(l=this.masterFilterNode)==null?void 0:l.frequency)==null?void 0:c.value)??"N/A",muted:t};console.log("🎚️ Master chain verification:",s),this.masterDryGainNode&&this.masterDryGainNode.gain.value===0&&console.warn("⚠️ Master dry gain is 0 - audio will be silent!");try{this.masterGainNode.__originalConnect?this.masterGainNode.__originalConnect.call(this.masterGainNode,this._realDestination):this.masterGainNode.connect(this._realDestination),console.log("✅ Verified masterGainNode -> destination connection")}catch(u){if(u.message&&u.message.includes("already connected"))console.log("✅ masterGainNode -> destination already connected");else return console.error("❌ Failed to connect masterGainNode -> destination:",u.message),!1}return!0},this._routingBypass=!1,this.masterPattern="",this.masterSlot="d0",this.trackedPatterns=new Map,this.masterActive=!1,this.masterPatternManualOverride=!1,this.masterPlaybackStartTime=null,this.masterPlaybackSpeed=1,this.masterPlaybackTempo=this.currentTempo,this.masterOnlyPlayback=!0,this.previewElementIds=new Set,this.sampleNameToSpecialtyBank=new Map,this.specialtyManifests=new Map,this._pendingMasterPatternRefreshReason=null,this._masterPatternRefreshTimer=null,this._masterPatternEvalPromise=Promise.resolve(),this._cachedScaleContext=null,this._cachedScaleKey="",this.mediaRecorder=null,this.recordedChunks=[],this.isRecording=!1,this.midiEnabled=!1,this.midiOutputs=new Map,this.selectedMidiOutput=null,this.activeMidiNotes=new Set,this.midiChannel=0,this._midiFallbackLogged=!1}getPatternSlot(e){if(e==="modal-preview"){const s=this.previewSlotName,a=this.patternSlotToElementId.get(s);return a&&a!==e&&(console.log(`⚠️ Preview slot ${s} previously mapped to ${a}, reassigning...`),this.strudelPatternSlots.delete(a),this.patternSlotToElementId.delete(s),this.getPatternSlot(a)),this.strudelPatternSlots.set(e,s),this.patternSlotToElementId.set(s,e),s}if(!this.strudelPatternSlots.has(e)){let s=this.nextPatternSlot,a=`d${s}`;for(;this.reservedSlots.has(a);)s++,s>16&&(s=1),a=`d${s}`;this.strudelPatternSlots.set(e,a),this.patternSlotToElementId.set(a,e),console.log(`🎵 Assigned ${e} to pattern slot ${a}`),s++,s>16&&(s=1),this.nextPatternSlot=s}const t=this.strudelPatternSlots.get(e);return console.log(`🎵 ${e} using slot ${t}`),t}onSoundsReady(e){this.onSoundsReadyCallback=e}onMasterPatternUpdate(e){this.onMasterPatternUpdateCallback=e}onMasterStateChange(e){this.onMasterStateChangeCallback=e}setEditorHighlightingEnabled(e){const t=!!e;this.editorHighlightingEnabled!==t&&(this.editorHighlightingEnabled=t,this.editorHighlightingEnabled?this.masterActive&&Tx():this.editorHighlightingEnabled&&Fx())}async initializeStrudelAndSounds(){try{if(console.log("📦 Loading Strudel from CDN..."),!window.strudel||!window.strudel.evaluate||typeof globalThis.silence!="object"||typeof globalThis.sound!="function"?(console.log("Loading Strudel (window.strudel exists:",!!window.strudel,", functions exposed:",typeof globalThis.sound=="function",")"),await this.loadStrudelFromCDN()):console.log("Strudel already loaded and functions exposed"),!window.strudel||!window.strudel.evaluate)return console.error("Strudel failed to load properly"),!1;if(typeof globalThis.silence!="object"||typeof globalThis.sound!="function")return console.error("Strudel loaded but functions not exposed to globalThis!"),console.log("  typeof globalThis.silence:",typeof globalThis.silence,"(should be object)"),console.log("  typeof globalThis.sound:",typeof globalThis.sound,"(should be function)"),console.log("  typeof globalThis.note:",typeof globalThis.note,"(should be function)"),!1;if(console.log("✅ Strudel loaded successfully with functions exposed"),console.log("🔇 Ensuring all patterns are silent..."),globalThis.silence&&typeof globalThis.silence=="object")for(let s=1;s<=16;s++)try{window.strudel.evaluate(`d${s} = silence`).catch(()=>{})}catch{}else console.warn("⚠️ silence pattern not available yet - skipping pattern slot initialization");return console.log("📦 Loading sound banks..."),await this.ensureDefaultSoundBanks()?console.log("✅ Default sound banks loaded"):console.warn("⚠️ Default sound banks failed to load"),console.log("📦 Preloading all sounds..."),await this.preloadAllCommonDrumSounds(),console.log("📦 Pre-loading all configured patterns..."),this.preloadAllPatterns().catch(s=>{console.log("⚠️ Pattern pre-loading failed:",s)}),this.soundsPreloaded=!0,console.log("✅✅✅ All sounds ready and preloaded!"),!0}catch(e){return console.error("Error initializing Strudel/sounds:",e),!1}}async initialize(){var e;if(this.initialized&&this.audioContext&&this.audioContext.state==="running")return!0;try{if(this.audioContext&&this.audioContext.state==="closed"&&(this.audioContext=null),!this.audioContext){const t=window.AudioContext||window.webkitAudioContext;window.__OriginalAudioContext||(window.__OriginalAudioContext=t),this.audioContext=new t;const s=this.audioContext,a=function(){return _a(this,"🎚️ AudioContext constructor hijacked - returning our shared context"),s};a.prototype=t.prototype,a.__proto__=t,window.AudioContext=a,window.webkitAudioContext&&(window.webkitAudioContext=a),window.__hijackedAudioContext=s,this.audioContext.__masterPanNode=!0,console.log("✅ AudioContext hijacked - all future AudioContext creations will use our shared context"),this.masterPanNode=this.audioContext.createStereoPanner(),this.masterFilterNode=this.audioContext.createBiquadFilter(),this.masterFilterNode.type="lowpass",this.masterFilterNode.frequency.value=this.masterFilterFrequency,this.masterFilterNode.Q.value=this.masterFilterResonance,this.masterDryGainNode=this.audioContext.createGain(),this.masterDryGainNode.gain.value=1,this.masterDelayNode=this.audioContext.createDelay(1),this.masterDelayNode.delayTime.value=this.masterDelayTime,this.masterDelayGainNode=this.audioContext.createGain(),this.masterDelayGainNode.gain.value=this.masterDelayAmount,this.masterDelayFeedbackGainNode=this.audioContext.createGain(),this.masterDelayFeedbackGainNode.gain.value=this.masterDelayFeedback,this.masterReverbNode=this.audioContext.createConvolver(),this.masterReverbGainNode=this.audioContext.createGain(),this.masterReverbGainNode.gain.value=this.masterReverbAmount,this._createReverbImpulseResponse(),this.masterGainNode=this.audioContext.createGain(),this._realDestination=this.audioContext.destination,this.masterPanNode.connect(this.masterFilterNode),this.masterFilterNode.connect(this.masterDryGainNode),this.masterDryGainNode.connect(this.masterGainNode),console.log(`🎚️ Dry path: masterPan -> masterFilter (freq=${this.masterFilterNode.frequency.value}Hz) -> masterDryGain (gain=${this.masterDryGainNode.gain.value}) -> masterGain -> destination`),this.masterFilterNode.connect(this.masterDelayNode),this.masterDelayNode.connect(this.masterDelayGainNode),this.masterDelayGainNode.connect(this.masterGainNode),this.masterDelayNode.connect(this.masterDelayFeedbackGainNode),this.masterDelayFeedbackGainNode.connect(this.masterDelayNode),this.masterFilterNode.connect(this.masterReverbNode),this.masterReverbNode.connect(this.masterReverbGainNode),this.masterReverbGainNode.connect(this.masterGainNode);try{this.masterGainNode.connect(this._realDestination),console.log("✅ Connected masterGainNode -> _realDestination (initial setup)")}catch(o){console.error("❌ Failed to connect masterGainNode -> _realDestination:",o)}const r=this.audioContext.createGain();if(r.gain.value=1,r.connect(this.masterPanNode),console.log("✅ Created destination wrapper (GainNode) -> masterPanNode"),this.destinationWrapper=new Proxy(r,{set:(o,i,l)=>{if(i==="channelCount"&&(l===0||l<1))return console.warn(`🛡️ BLOCKED: superdough tried to set channelCount=${l} (invalid, must be >= 1)`),!0;try{o[i]=l}catch(c){console.warn(`⚠️ Could not set ${i}=${l}:`,c.message)}return!0},get:(o,i)=>{const l=o[i];return typeof l=="function"?l.bind(o):l}}),Object.defineProperty(this.audioContext,"destination",{get:()=>this.destinationWrapper,configurable:!0,enumerable:!0}),_a(this,`🎚️ ✅ INITIAL: Connected masterPan -> masterFilter -> masterDryGain -> masterGain -> destination (gain=${this.masterGainNode.gain.value.toFixed(3)})`),this.masterDryGainNode&&(this.masterDryGainNode.gain.value=1,console.log("🎚️ Dry path gain set to 1.0 (always audible)")),this.masterFilterNode&&this.masterFilterNode.frequency.value<20&&(console.warn(`⚠️ Filter frequency is very low (${this.masterFilterNode.frequency.value}Hz), might block audio. Setting to 2000Hz.`),this.masterFilterNode.frequency.value=2e3),this._requestMasterFilterUpdate(!0),this.masterGainNode.gain.value=this.masterVolume,this.masterPanNode.pan.value=this.masterPan,this._verifyMasterChainConnection(),this.gainNode=this.masterGainNode,console.log("💡 Master channel ready - will route Strudel through it during init"),!AudioNode.prototype.__originalConnect){AudioNode.prototype.__originalConnect=AudioNode.prototype.connect;const o=this.masterPanNode,i=this.masterFilterNode,l=this.masterGainNode,c=this.audioContext,u=this,h=this._realDestination;AudioNode.prototype.connect=function(m,f,v){var W,de,be,ke,Ce,Ae,q,Ne,Re,je,me,Ye,ft,_e,Ge,pt,rt,tn,on,xn,Gt,In,Ft,jt,Gn,un;if(u&&u._routingBypass===!0)return this.__originalConnect.call(this,m,f,v);const O=this.context,k=m==null?void 0:m.context,M=O&&O===c,E=k&&k===c,I=m===h||m===c.destination;if(!M||!(E||m&&!k&&I))return this.__originalConnect.call(this,m,f,v);const F=fn=>!!(fn&&fn.__strudelVisualizerNode);if(F(this)||F(m))return this.__originalConnect.call(this,m,f,v);if(u&&u.masterActive){const fn=this.constructor.name,at=((W=m==null?void 0:m.constructor)==null?void 0:W.name)||"unknown",Un=m===h||m===c.destination||((de=m==null?void 0:m.constructor)==null?void 0:de.name)==="AudioDestinationNode",nt=m===((ke=(be=window.strudel)==null?void 0:be.scheduler)==null?void 0:ke.output),Mt=m===(u==null?void 0:u.masterPanNode),Vt=nt?"(scheduler.output!)":Mt?"(masterPanNode!)":"";u._allConnectionsDebugLogged||(u._allConnectionsDebugLogged=new Set);const En=`${fn}->${at}`;u._allConnectionsDebugLogged.has(En)||(console.log(`🔊 CONNECTION DEBUG: ${fn} -> ${at}${Vt}, isDestination=${Un}, context=${this.context===c?"OUR":"OTHER"}`),u._allConnectionsDebugLogged.add(En))}const _=this.constructor.name==="AnalyserNode",$=m===h||m===c.destination||u&&m===u.masterPanNode,Z=m&&m.constructor&&m.constructor.name==="AudioDestinationNode";if(($||Z)&&!_){u._allDestConnectionsLogged||(u._allDestConnectionsLogged=new Set);const fn=`${this.constructor.name}->${(Ce=m==null?void 0:m.constructor)==null?void 0:Ce.name}`;u._allDestConnectionsLogged.has(fn)||(u._logRoute(`🎚️ 🔴 DESTINATION CONNECTION: ${this.constructor.name} -> ${(Ae=m==null?void 0:m.constructor)==null?void 0:Ae.name}, masterActive=${u.masterActive}, trackedPatterns=${u.trackedPatterns.size}`),u._allDestConnectionsLogged.add(fn))}if(u.masterActive&&!_){u._allConnectionsLogged||(u._allConnectionsLogged=new Set);const fn=`${this.constructor.name}->${(q=m==null?void 0:m.constructor)==null?void 0:q.name}`;u._allConnectionsLogged.has(fn)||(u._logRoute(`🎚️ Connection attempt: ${this.constructor.name} -> ${(Ne=m==null?void 0:m.constructor)==null?void 0:Ne.name}, isMasterDest=${$}, isAnyDest=${Z}, masterActive=${u.masterActive}`),u._allConnectionsLogged.add(fn))}const ce=($||Z)&&!_,U=u.masterActive&&u.trackedPatterns.size>0,ue=U;if(m&&m.constructor&&m.constructor.name==="StereoPannerNode"&&(u._debugStereoPanConnectionLogged||(console.log(`🔍 DEBUG: ${this.constructor.name} -> StereoPannerNode connection attempt`),console.log(`  isMasterDestination: ${$}`),console.log(`  isAnyAudioContextDestination: ${Z}`),console.log(`  isAnalyserNode: ${_}`),console.log(`  shouldIntercept: ${ce}`),console.log(`  destination === realDestination: ${m===h}`),console.log(`  destination === audioContextInstance.destination: ${m===c.destination}`),console.log(`  destination === soundManagerInstance.masterPanNode: ${m===u.masterPanNode}`),u._debugStereoPanConnectionLogged=!0)),ce&&m===u.masterPanNode&&m!==h){u._masterPanConnectionsLogged||(u._masterPanConnectionsLogged=new Set);const fn=`${this.constructor.name}->${m.constructor.name}`;return u._masterPanConnectionsLogged.has(fn)||(console.log(`🎚️ ✅ Allowing ${this.constructor.name} to connect naturally to masterPanNode (master chain will handle routing)`),console.log(`🎚️ ✅ Master chain: masterPan(${((je=(Re=u.masterPanNode)==null?void 0:Re.pan)==null?void 0:je.value)||"N/A"}) -> masterFilter(${((Ye=(me=u.masterFilterNode)==null?void 0:me.frequency)==null?void 0:Ye.value)||"N/A"}Hz) -> masterDryGain(${((_e=(ft=u.masterDryGainNode)==null?void 0:ft.gain)==null?void 0:_e.value)||"N/A"}) -> masterGain(${((pt=(Ge=u.masterGainNode)==null?void 0:Ge.gain)==null?void 0:pt.value)||"N/A"}) -> destination`),u._masterPanConnectionsLogged.add(fn)),this.__originalConnect.call(this,m,f,v)}if(ce){u._masterDestinationConnectLogged||(u._logRoute(`🎚️ ✅ INTERCEPTING connection to destination: ${this.constructor.name} -> ${(rt=m==null?void 0:m.constructor)==null?void 0:rt.name}, masterActive=${u.masterActive}, trackedPatterns=${u.trackedPatterns.size}`),u._masterDestinationConnectLogged=!0),u._nodeTypeConnectLogged||(u._nodeTypeConnectLogged=new Set);const fn=this.constructor.name;u._nodeTypeConnectLogged.has(fn)||(u._logRoute(`🎚️ Intercepting ${fn} connecting to ${(tn=m==null?void 0:m.constructor)==null?void 0:tn.name}`),u._nodeTypeConnectLogged.add(fn));let at=null;if(!ue&&u.masterActive&&u.trackedPatterns.size>0){const nt=Array.from(u.trackedPatterns.keys());if(nt.length===1)at=nt[0],u._singleElementMasterRoutingLogged||(u._logRoute(`🎚️ Single element master detected, routing through ${at} (trackedPatterns.size=${u.trackedPatterns.size})`),u._logRoute(`🎚️ currentEvaluatingSlot=${u.currentEvaluatingSlot}, patternSlotToElementId mapping:`,Array.from(u.patternSlotToElementId.entries())),u._singleElementMasterRoutingLogged=!0);else if(u.currentEvaluatingSlot){const Mt=u.patternSlotToElementId.get(u.currentEvaluatingSlot);Mt&&nt.includes(Mt)&&(at=Mt,u._logRoute(`🎚️ Multi-element evaluate: routing via currentEvaluatingSlot ${u.currentEvaluatingSlot} -> ${at}`))}}if(u.masterActive&&!at&&u.currentEvaluatingSlot&&(at=u.patternSlotToElementId.get(u.currentEvaluatingSlot),at?u._logRoute(`🎚️ Found element from currentEvaluatingSlot: ${at} (slot: ${u.currentEvaluatingSlot})`):u._logRoute(`🎚️ currentEvaluatingSlot=${u.currentEvaluatingSlot} but no mapping found. Available mappings:`,Array.from(u.patternSlotToElementId.entries()))),!at)for(const[nt,Mt]of u.patternSlotToElementId.entries())try{const Vt=globalThis[nt];if(Vt&&Vt!==globalThis.silence){at=Mt,u._logRoute(`🎚️ Found element from active slot: ${at} (slot: ${nt})`);break}}catch{}if(at){const nt=u.getElementAudioNodes(at);if(nt&&nt.gainNode){const Mt=nt.panNode;if(this.__punchcardMasterRouted&&this.__punchcardMasterConnectionNode&&typeof this.disconnect=="function"){try{this.disconnect(this.__punchcardMasterConnectionNode),u._logRoute(`🎚️ Disconnected ${this.constructor.name} from master fallback before routing through element chain`)}catch{}this.__punchcardMasterRouted=!1,this.__punchcardMasterConnectionNode=null}if(Mt)if(u.masterPanNode||u.masterGainNode)try{u._panNodeConnectedToMaster||(u._panNodeConnectedToMaster=new Set);const Le=`${at}-${u.masterPanNode?"pan":"gain"}`;if(!u._panNodeConnectedToMaster.has(Le)){let qt=!1;if(u.masterPanNode)try{Mt.connect(u.masterPanNode),qt=!0,u._panNodeConnectedToMaster.add(Le),u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.has(at)||(u._logRoute(`🎚️ ✅ Connected ${at} panNode -> masterPanNode`),u._panNodeConnectedLogged.add(at))}catch(tt){if(tt.message.includes("already connected")||tt.message.includes("already been connected"))u._panNodeConnectedToMaster.add(Le),qt=!0;else throw tt}else if(u.masterGainNode)try{Mt.connect(u.masterGainNode),qt=!0,u._panNodeConnectedToMaster.add(Le),u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.has(at)||(u._logRoute(`🎚️ ✅ Connected ${at} panNode -> masterGainNode (fallback)`),u._panNodeConnectedLogged.add(at))}catch(tt){if(tt.message.includes("already connected")||tt.message.includes("already been connected"))u._panNodeConnectedToMaster.add(Le),qt=!0;else throw tt}qt||console.error(`❌ ${at} panNode: Master nodes exist but connection failed!`)}}catch(Le){u._panNodeConnectionErrorLogged||(u._panNodeConnectionErrorLogged=new Set),u._panNodeConnectionErrorLogged.has(at)||(console.error(`❌ Failed to connect ${at} panNode to master chain:`,Le.message),console.error("   panNode:",Mt),console.error("   masterPanNode:",u.masterPanNode),console.error("   masterGainNode:",u.masterGainNode),u._panNodeConnectionErrorLogged.add(at))}else u._panNodeNotConnectedLogged||(u._panNodeNotConnectedLogged=new Set),u._panNodeNotConnectedLogged.has(at)||(console.warn(`⚠️ ${at} panNode: Master nodes not available yet (will connect when available)`),u._panNodeNotConnectedLogged.add(at));let Vt=[];Vt.push(`gainNode: gain=${nt.gainNode.gain.value.toFixed(3)}, inputs=${nt.gainNode.numberOfInputs}, outputs=${nt.gainNode.numberOfOutputs}`),Mt?Vt.push(`panNode: pan=${Mt.pan.value.toFixed(3)}, inputs=${Mt.numberOfInputs}, outputs=${Mt.numberOfOutputs}`):Vt.push("panNode: MISSING"),u.masterPanNode?Vt.push(`masterPanNode: inputs=${u.masterPanNode.numberOfInputs}, outputs=${u.masterPanNode.numberOfOutputs}`):Vt.push("masterPanNode: MISSING"),u.masterGainNode?Vt.push(`masterGainNode: gain=${u.masterGainNode.gain.value.toFixed(3)}, inputs=${u.masterGainNode.numberOfInputs}, outputs=${u.masterGainNode.numberOfOutputs}`):Vt.push("masterGainNode: MISSING"),u._chainVerificationLogged||(u._chainVerificationLogged=new Set),u._chainVerificationLogged.has(at)||(u._logRoute(`🎚️ INTERCEPTED: Routing ${at} audio through element gain node (${this.constructor.name} -> ${nt.gainNode.constructor.name})`),u._logRoute(`🎚️ Audio chain verification for ${at}:`,Vt.join(", ")),u._chainVerificationLogged.add(at));const En=nt.panNode;if(En&&!((on=u._panNodeConnectedLogged)!=null&&on.has(at)))try{if(u.masterPanNode)try{En.connect(u.masterPanNode),u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.add(at),u._logRoute(`🎚️ ✅ CRITICAL: Connected ${at} panNode -> masterPanNode`)}catch{u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.add(at)}else if(u.masterGainNode)try{En.connect(u.masterGainNode),u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.add(at),u._logRoute(`🎚️ ✅ CRITICAL: Connected ${at} panNode -> masterGainNode (fallback)`)}catch{u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.add(at)}}catch(It){console.error(`❌ CRITICAL: Failed to connect ${at} panNode: ${It.message}`)}try{typeof this.disconnect=="function"&&this.disconnect(nt.gainNode)}catch{}const lt=this.__originalConnect.call(this,nt.gainNode,f,v);if(u._masterGainDestVerifiedAfterRouting||(u._masterGainDestVerifiedAfterRouting=new Set),!u._masterGainDestVerifiedAfterRouting.has(at))if(u._masterGainDestVerifiedAfterRouting.add(at),u._logRoute(`🎚️ 🔍 VERIFYING: masterGainNode=${!!u.masterGainNode}, _realDestination=${!!u._realDestination}, gain=${((In=(Gt=(xn=u.masterGainNode)==null?void 0:xn.gain)==null?void 0:Gt.value)==null?void 0:In.toFixed(3))||"N/A"}, muted=${u.masterMuted}`),u.masterGainNode&&u._realDestination)try{u.masterGainNode.__originalConnect?u.masterGainNode.__originalConnect.call(u.masterGainNode,u._realDestination):u.masterGainNode.connect(u._realDestination),u._logRoute(`🎚️ ✅ CRITICAL: Connected masterGainNode -> destination after routing ${at} (gain=${u.masterGainNode.gain.value.toFixed(3)}, muted=${u.masterMuted})`)}catch(It){u._logRoute(`🎚️ ✅ CRITICAL: masterGainNode -> destination already connected for ${at} (${It.message})`)}else console.error(`❌ CRITICAL: Cannot verify masterGainNode -> destination: masterGainNode=${!!u.masterGainNode}, _realDestination=${!!u._realDestination}`);return u._connectionSuccessLogged||(u._connectionSuccessLogged=new Set),u._connectionSuccessLogged.has(at)||(u._logRoute(`🎚️ Connection result for ${at}: ${lt?"SUCCESS":"FAILED"}, source inputs now: ${nt.gainNode.numberOfInputs}`),u._connectionSuccessLogged.add(at)),this.__punchcardElementRouted!==!0&&(this.__punchcardElementRouted=!0),lt}else console.error(`❌ CRITICAL: Element ${at} found but no gain node available - elementNodes=${!!nt}, gainNode=${!!(nt!=null&&nt.gainNode)}`),console.error("❌ This means audio will bypass element controls!"),at=null}else{if(U){u._stackMasterRoutingLogged||(console.log(`🎚️ Stack() pattern: Routing through master chain (${u.trackedPatterns.size} elements)`),console.log(`🎚️ Stack() routing: masterPanNode=${!!o}, masterFilterNode=${!!i}, masterGainNode=${!!l}, gain=${((jt=(Ft=l==null?void 0:l.gain)==null?void 0:Ft.value)==null?void 0:jt.toFixed(3))||"N/A"}, muted=${u.masterMuted}`),u._stackMasterRoutingLogged=!0);const Mt=o||i||l;if(Mt){if(l&&u._realDestination&&!u._stackRoutingVerified)try{l.__originalConnect.call(l,u._realDestination),console.log(`🎚️ ✅ Stack() routing: Verified masterGainNode -> destination connection (gain=${l.gain.value.toFixed(3)})`),u._stackRoutingVerified=!0}catch(Vt){Vt.message&&Vt.message.includes("already connected")?u._stackRoutingVerified||(console.log("🎚️ ✅ Stack() routing: masterGainNode -> destination already connected"),u._stackRoutingVerified=!0):console.error("❌ Stack() routing: Failed to connect masterGainNode -> destination:",Vt.message)}return this.__originalConnect.call(this,Mt,f,v)}}u._noElementRoutingLogged||(u._logRoute(`🎚️ No element found for routing - trackedPatterns.size=${u.trackedPatterns.size}, currentEvaluatingSlot=${u.currentEvaluatingSlot}`),u._logRoute("🎚️ Available pattern slot mappings:",Array.from(u.patternSlotToElementId.entries())),u._logRoute("🎚️ Tracked elements:",Array.from(u.trackedPatterns.keys())),u._noElementRoutingLogged=!0)}if(!at&&o)return u._masterFallbackRoutingLogged||(u._logRoute(`🎚️ ⚠️ FALLBACK: No element found, routing through master chain: ${this.constructor.name} -> masterPanNode`),u._masterFallbackRoutingLogged=!0),this.__punchcardMasterRouted=!0,this.__punchcardMasterConnectionNode=o,this.__originalConnect.call(this,o,f,v);if(u.masterActive&&u.trackedPatterns.size===1&&!at){const nt=Array.from(u.trackedPatterns.keys());u._logRoute(`🎚️ 🔍 FALLBACK CHECK: trackedPatterns.size=${u.trackedPatterns.size}, elementId=${at}, trackedElementIds=${nt.join(", ")}`),nt.length===1?(at=nt[0],u._logRoute(`🎚️ ⚠️ Fallback: Using tracked element ${at} for routing (elementId was null)`)):console.warn(`🎚️ ⚠️ Fallback: trackedElementIds.length=${nt.length}, expected 1`)}else u.trackedPatterns.size!==1?console.log(`🎚️ 🔍 FALLBACK SKIP: trackedPatterns.size=${u.trackedPatterns.size}, elementId=${at} (not single element, skipping fallback)`):at&&console.log(`🎚️ 🔍 FALLBACK SKIP: trackedPatterns.size=${u.trackedPatterns.size}, elementId=${at} (elementId already set, skipping fallback)`);if(at){console.log(`🎚️ 🔍 FALLBACK ROUTING ATTEMPT: elementId=${at}, attempting to get elementNodes...`);const nt=u.getElementAudioNodes(at);if(console.log(`🎚️ 🔍 FALLBACK ROUTING: elementNodes=${!!nt}, gainNode=${!!(nt!=null&&nt.gainNode)}, panNode=${!!(nt!=null&&nt.panNode)}`),nt&&nt.gainNode){const Mt=nt.panNode;if(Mt&&o)try{try{Mt.disconnect(o)}catch{}Mt.connect(o)}catch{}return console.log(`🎚️ ✅ FALLBACK ROUTING: Routing ${this.constructor.name} through ${at} element chain (gain=${nt.gainNode.gain.value.toFixed(3)})`),this.__originalConnect.call(this,nt.gainNode,f,v)}else console.error(`❌ CRITICAL FALLBACK: Element ${at} found but elementNodes or gainNode is missing - elementNodes=${!!nt}, gainNode=${!!(nt!=null&&nt.gainNode)}`),console.error("❌ Audio will route through master chain, bypassing element controls!")}else console.log("🎚️ 🔍 FALLBACK ROUTING SKIP: elementId is null, will route through master chain");const Un=o||i||l;if(Un&&!at){if(this.__punchcardElementRouted)return console.log(`🎚️ Skipping master fallback for ${this.constructor.name} (already routed through element chain)`),this.__originalConnect.call(this,m,f,v);u._masterRoutingLogged||(u._masterRoutingLogged=new Set);const nt=`master-${Un.constructor.name}`;if(!u._masterRoutingLogged.has(nt)){if(u._masterRoutingLogged.add(nt),console.log(`🎚️ ⚠️ FALLBACK: Routing ${this.constructor.name} through master chain (${Un.constructor.name}) - element routing not available`),console.log(`🎚️ ⚠️ FALLBACK: masterGainNode.gain=${((un=(Gn=l==null?void 0:l.gain)==null?void 0:Gn.value)==null?void 0:un.toFixed(3))||"N/A"}, muted=${u.masterMuted}, connected to destination=${!!u._realDestination}`),o&&l)try{o.connect(l),console.log("🎚️ ✅ FALLBACK: Verified masterPanNode -> masterGainNode connection")}catch(Vt){Vt.message.includes("already connected")||Vt.message.includes("already been connected")?console.log("🎚️ ✅ FALLBACK: masterPanNode -> masterGainNode already connected"):console.warn(`⚠️ FALLBACK: Could not connect masterPanNode -> masterGainNode: ${Vt.message}`)}if(l&&u._realDestination)try{l.__originalConnect?l.__originalConnect.call(l,u._realDestination):l.connect(u._realDestination),console.log(`🎚️ ✅ FALLBACK: Ensured masterGainNode -> destination connection (gain=${l.gain.value.toFixed(3)})`)}catch(Vt){Vt.message&&Vt.message.includes("already connected")?console.log("🎚️ ✅ FALLBACK: masterGainNode -> destination already connected"):console.warn(`⚠️ FALLBACK: Could not connect masterGainNode -> destination: ${Vt.message}`)}}const Mt=this.__originalConnect.call(this,Un,f,v);return this.__punchcardMasterRouted=!0,this.__punchcardMasterConnectionNode=Un,Mt}if(!o&&!l&&console.warn("⚠️ No master nodes available, allowing direct connection to destination"),l&&h&&!u._masterGainDestVerified)try{l.__originalConnect?l.__originalConnect.call(l,h):l.connect(h),console.log("🎚️ ✅ Ensured masterGainNode -> destination connection (critical for audio output)"),u._masterGainDestVerified=!0}catch(nt){nt.message&&nt.message.includes("already connected")?console.log("🎚️ ✅ masterGainNode -> destination already connected"):console.log(`🎚️ masterGainNode -> destination: ${nt.message||"connection verified"}`),u._masterGainDestVerified=!0}}return this.__originalConnect.call(this,m,f,v)},console.log("🎚️ Patched AudioNode.prototype.connect to route through element gain nodes or master channel"),console.log("🎚️ Hijacking verification: AudioNode.prototype.__originalConnect exists:",!!AudioNode.prototype.__originalConnect),console.log("🎚️ Hijacking verification: AudioNode.prototype.connect is patched:",AudioNode.prototype.connect!==AudioNode.prototype.__originalConnect)}this.audioContext.__masterPanNode=this.masterPanNode,console.log("Audio context created with master channel, state:",this.audioContext.state),this.strudelLoaded||(_a(this,"🎚️ Loading Strudel after hijacking AudioContext and connect() (master nodes ready)..."),await this.loadStrudelFromCDN()),_a(this,`🎚️ Master initialized: volume=${(this.masterVolume*100).toFixed(0)}%, pan=${this.masterPan.toFixed(2)}`)}if(this.audioContext.state==="suspended")try{ah(),await this.audioContext.resume(),this.audioContext.state==="running"?console.log("Audio context resumed successfully"):console.log("Audio context state:",this.audioContext.state)}catch(t){return t.message&&t.message.includes("user gesture")||console.error("Cannot resume audio context:",t),!1}return this.audioContext&&this.audioContext.state==="running"?(this.initialized=!0,console.log("Sound Manager initialized successfully"),this.masterGainNode&&(this.masterGainNode.gain.value=this.masterVolume),this.masterPanNode&&(this.masterPanNode.pan.value=this.masterPan),_a(this,`🎚️ Master values set: volume=${(this.masterVolume*100).toFixed(0)}%, pan=${this.masterPan.toFixed(2)}`),this._verifyMasterChainConnection(),console.log("🎵 Starting Strudel initialization and sound bank loading..."),this.initializeStrudelAndSounds().catch(t=>{console.error("Failed to initialize Strudel/sounds:",t)}),this.preloadAudioFiles().catch(t=>{console.log("Background audio preload failed:",t)}),!0):(console.warn("Audio context not in running state:",(e=this.audioContext)==null?void 0:e.state),!1)}catch(t){return console.error("Failed to initialize audio context:",t),this.initialized=!1,!1}}async preloadAudioFiles(){const e=fs.getAudioElements();for(const t of e)if(t.audioFile)try{(await fetch(t.audioFile,{method:"HEAD"})).ok?await this.loadAudioFile(t.id,t.audioFile):console.log(`Skipping preload for ${t.id} (file not found): ${t.audioFile}`)}catch{}}async loadAudioFile(e,t){try{const s=await fetch(t);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.arrayBuffer(),r=await this.audioContext.decodeAudioData(a);return this.audioBuffers.set(e,r),r}catch(s){throw console.error(`Error loading audio file ${t}:`,s),s}}setVolume(e){this.volume=Math.max(0,Math.min(1,e)),this.gainNode&&(this.gainNode.gain.value=this.volume)}setMasterVolume(e){this.masterVolume=Math.max(0,Math.min(1,e)),this.masterGainNode?(this.masterGainNode.gain.value=this.masterVolume,_a(this,`🎚️ Master volume set to ${(this.masterVolume*100).toFixed(0)}% (gainNode instant via Web Audio API)`)):_a(this,`🎚️ Master volume stored as ${(this.masterVolume*100).toFixed(0)}% (gainNode not ready yet)`)}setMasterPan(e){this.masterPan=Math.max(-1,Math.min(1,e)),this.masterPanNode?(this.masterPanNode.pan.value=this.masterPan,_a(this,`🎚️ Master pan set to ${this.masterPan.toFixed(2)} (panNode instant via Web Audio API)`)):_a(this,`🎚️ Master pan stored as ${this.masterPan.toFixed(2)} (panNode not ready yet)`)}enableMasterFilter(e){const t=!!e;this.masterFilterEnabled!==t&&(this.masterFilterEnabled=t,this._requestMasterFilterUpdate(!0))}setMasterFilterFrequency(e,t=!1){const s=Number(e);if(Number.isFinite(s)){const a=Math.max(this.masterFilterMinHz,Math.min(this.masterFilterMaxHz,s));this.masterFilterFrequency=a,this._requestMasterFilterUpdate(t)}}setMasterFilterResonance(e,t=!1){const s=Number(e);if(Number.isFinite(s)){const a=Math.max(this.masterFilterMinQ,Math.min(this.masterFilterMaxQ,s));this.masterFilterResonance=a,this._requestMasterFilterUpdate(t)}}setMasterDelayAmount(e){const t=Number(e);if(Number.isFinite(t)&&this.masterDelayGainNode){const s=Math.max(0,Math.min(1,t));this.masterDelayAmount=s,this.masterDelayGainNode.gain.value=s}}setMasterDelayFeedback(e){const t=Number(e);if(Number.isFinite(t)&&this.masterDelayFeedbackGainNode){const s=Math.max(0,Math.min(1,t));this.masterDelayFeedback=s,this.masterDelayFeedbackGainNode.gain.value=s}}setMasterReverbAmount(e){const t=Number(e);if(Number.isFinite(t)&&this.masterReverbGainNode){const s=Math.max(0,Math.min(5,t));this.masterReverbAmount=s,this.masterReverbGainNode.gain.value=s}}setMasterReverbRoomSize(e){const t=Number(e);if(Number.isFinite(t)){const s=Math.max(0,Math.min(4,t));this.masterReverbRoomSize=s,this._createReverbImpulseResponse()}}_createReverbImpulseResponse(){if(!this.audioContext||!this.masterReverbNode)return;const e=this.audioContext.sampleRate,t=e*2,s=this.audioContext.createBuffer(2,t,e),a=this.masterReverbRoomSize;for(let r=0;r<2;r++){const o=s.getChannelData(r);for(let i=0;i<t;i++){const l=t-i,c=Math.pow(1-l/t,2),u=Math.pow(c,1+a);o[i]=(Math.random()*2-1)*u}}this.masterReverbNode.buffer=s}_requestMasterFilterUpdate(e=!1){if(!this.masterFilterNode||!this.audioContext)return;if(e){this._masterFilterUpdateTimeout&&(clearTimeout(this._masterFilterUpdateTimeout),this._masterFilterUpdateTimeout=null),this._lastMasterFilterUpdateTime=typeof performance<"u"?performance.now():Date.now(),this._updateMasterFilterNode(!0);return}const t=typeof performance<"u"?performance.now():Date.now(),s=Math.max(8,this.masterFilterMinUpdateMs||0),a=t-(this._lastMasterFilterUpdateTime||0);if(a>=s){this._lastMasterFilterUpdateTime=t,this._updateMasterFilterNode(!1);return}if(this._masterFilterUpdateTimeout)return;const r=Math.max(4,s-a);this._masterFilterUpdateTimeout=setTimeout(()=>{this._masterFilterUpdateTimeout=null,this._lastMasterFilterUpdateTime=typeof performance<"u"?performance.now():Date.now(),this._updateMasterFilterNode(!1)},r)}_updateMasterFilterNode(e=!1){if(!this.masterFilterNode||!this.audioContext)return;const t=this.audioContext.currentTime||0,s=this.masterFilterEnabled?Math.max(this.masterFilterMinHz,Math.min(this.masterFilterMaxHz,this.masterFilterFrequency||this.masterFilterMaxHz)):this.masterFilterBypassHz,a=this.masterFilterEnabled?Math.max(this.masterFilterMinQ,Math.min(this.masterFilterMaxQ,this.masterFilterResonance||this.masterFilterMinQ)):this.masterFilterMinQ,r=this.masterFilterNode.frequency,o=this.masterFilterNode.Q;if(e)r.cancelScheduledValues(t),o.cancelScheduledValues(t),r.setValueAtTime(s,t),o.setValueAtTime(a,t);else{const i=Math.max(.01,this.masterFilterSmoothing||.05);r.cancelScheduledValues(t),o.cancelScheduledValues(t),r.setTargetAtTime(s,t,i),o.setTargetAtTime(a,t,i)}}toggleMasterMute(){return this.masterMuted=!this.masterMuted,this.masterMuted?(this.masterVolumeBeforeMute=this.masterVolume,this.masterGainNode&&(this.masterGainNode.gain.value=0),console.log("🔇 Master muted (instant via Web Audio API)")):(this.masterGainNode&&(this.masterGainNode.gain.value=this.masterVolumeBeforeMute),this.masterVolume=this.masterVolumeBeforeMute,console.log(`🔊 Master unmuted (volume: ${(this.masterVolume*100).toFixed(0)}%) (instant via Web Audio API)`)),this.masterMuted}getElementAudioNodes(e){if(!this.audioContext)return null;if(!this.elementGainNodes.has(e)){const t=this.audioContext.createGain(),s=this.audioContext.createStereoPanner(),a=this.elementGainValues.get(e)||.8,r=this.elementPanValues.get(e)||0;this.elementGainNodes.set(e,t),this.elementPanNodes.set(e,s),this.elementGainValues.set(e,a),this.elementPanValues.set(e,r),t.gain.value=a*this.volume,s.pan.value=r,t.connect(s);let o=!1;if(this.masterPanNode)try{s.connect(this.masterPanNode),o=!0,_a(this,`🎚️ ${e}: Connected panNode to masterPanNode during node creation`)}catch(i){console.warn(`⚠️ ${e}: Failed to connect panNode to masterPanNode:`,i.message)}else if(this.masterGainNode)try{s.connect(this.masterGainNode),o=!0,_a(this,`🎚️ ${e}: Connected panNode to masterGainNode during node creation`)}catch(i){console.warn(`⚠️ ${e}: Failed to connect panNode to masterGainNode:`,i.message)}else if(this.gainNode)try{s.connect(this.gainNode),o=!0,_a(this,`🎚️ ${e}: Connected panNode to gainNode during node creation`)}catch(i){console.warn(`⚠️ ${e}: Failed to connect panNode to gainNode:`,i.message)}o||console.warn(`⚠️ ${e}: panNode not connected to master chain (master nodes may not exist yet - will connect on first audio connection)`),_a(this,`🎚️ Element audio chain for ${e}:`),console.log(`   gainNode (${t.numberOfInputs} inputs, ${t.numberOfOutputs} outputs)`),console.log(`   panNode (${s.numberOfInputs} inputs, ${s.numberOfOutputs} outputs)`),console.log(`   masterPanNode (${this.masterPanNode?this.masterPanNode.numberOfInputs:"N/A"} inputs)`),_a(this,`🎚️ Created element audio chain for ${e}: gain -> pan -> master`)}return{gainNode:this.elementGainNodes.get(e),panNode:this.elementPanNodes.get(e)}}disposeElementAudioNodes(e){if(!e)return;const t=this.elementGainNodes.get(e),s=this.elementPanNodes.get(e);if(t){try{t.disconnect()}catch{}this.elementGainNodes.delete(e)}if(s){try{s.disconnect()}catch{}this.elementPanNodes.delete(e)}this.elementGainValues.delete(e),this.elementPanValues.delete(e),this._panNodeConnectedToMaster&&(this._panNodeConnectedToMaster.delete(`${e}-pan`),this._panNodeConnectedToMaster.delete(`${e}-gain`))}isNotePattern(e){return!e||typeof e!="string"?!1:/\b(note|n)\s*\(/.test(e)}applyElementGainPanToPattern(e,t,s={}){const{applyGainInPattern:a=!0,applyPanInPattern:r=!0,applyTempoInPattern:o=!0}=s,i=this.elementGainValues.get(t)||.8,l=this.elementPanValues.get(t)||0,c=this.currentTempo||120;let u=e;u=u.replace(/\.postgain\s*\([^)]*\)/g,""),u=u.replace(/\.pan\s*\([^)]*\)/g,""),u=u.replace(/\.\.+/g,".").trim(),u=u.replace(/\.+$/,"").trim(),a&&(/\.postgain\s*\([^)]*\)\s*$/i.test(u)?u=u.replace(/\.postgain\s*\([^)]*\)\s*$/i,`.postgain(${i})`):u=`${u}.postgain(${i})`),r&&l!==0&&(u+=`.pan(${l})`);const h=c/120;return o&&(h>1?u+=`.fast(${h})`:h<1&&(u+=`.slow(${1/h})`)),console.log(`Applied gain=${i.toFixed(2)}, pan=${l.toFixed(2)}, tempo=${c} BPM (speed=${h.toFixed(2)}x) to ${t}`),u}async processPattern(e,t,s={}){const{preserveBanks:a=!1,attemptBankLoad:r=!1}=s||{};if(!e||typeof e!="string"||e.trim()==="")return null;let o=e.replace(/\r/g,"").split(`
`).map(c=>c.replace(/[ \t]+$/g,"")).join(`
`).trim();if(o=o.replace(/[ \t]+\./g,".").trim(),o=o.replace(/\n+\s*\./g,"."),o=o.replace(/\.\.+/g,".").trim(),o=o.replace(/\.(cpm|fast|slow)\([^)]*\)/g,"").trim(),o=o.replace(/\.\.+/g,".").trim(),o=$x(o),!o||o==="")return console.warn(`[${t}] Pattern became empty after processing - cannot process`),null;const i=o.match(/\.bank\(["']([^"']+)["']\)/g);if(i){const c=i.map(h=>h.match(/\.bank\(["']([^"']+)["']\)/)[1]);console.log(`[${t}] Pattern uses bank(s):`,c);let u=!1;for(const h of c){const m=h,v=["RolandTR808","RolandTR909","RolandTR707","RhythmAce","AkaiLinn","ViscoSpaceDrum","CasioRZ1"].includes(m);let O=this.loadedBanks.has(m)||v;if(!O&&r&&typeof this.loadBank=="function")try{console.log(`[${t}] Attempting to load bank "${m}" for pattern processing`),await this.loadBank(m)?(this.loadedBanks.add(m),O=!0,console.log(`[${t}] Bank "${m}" loaded successfully for pattern processing`)):console.warn(`[${t}] Bank "${m}" could not be loaded on demand`)}catch(k){console.warn(`[${t}] Error loading bank "${m}":`,k)}!O&&!a?(console.warn(`⚠️ Bank "${m}" not loaded - removing .bank() modifier from pattern`),o=o.replace(new RegExp(`\\.bank(["']${m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}["'])`,"g"),""),u=!0):!O&&a?console.warn(`⚠️ Bank "${m}" is not loaded but preserving .bank() for preview`):v&&(console.log(`[${t}] Bank "${m}" is built-in - keeping .bank() modifier`),this.loadedBanks.add(m))}if(o=o.replace(/\.+$/,"").trim(),u&&!a&&(!o||o.trim()===""))return console.warn("⚠️ Pattern became empty after removing unloaded banks"),null;console.log(`[${t}] Pattern after bank cleanup:`,o.substring(0,100))}const l=s.applyGainInPattern!==void 0?s.applyGainInPattern:this.masterActive;return o=this.applyElementGainPanToPattern(o,t,{applyGainInPattern:l}),!o||o.trim()===""?(console.warn(`[${t}] Pattern became empty after applying gain/pan - cannot process`),null):o}async preEvaluatePattern(e,t){if(!window.strudel||!window.strudel.evaluate)return console.log(`[${e}] Cannot pre-evaluate: Strudel not ready`),!1;if(!t||typeof t!="string"||t.trim()==="")return console.log(`[${e}] No pattern to pre-evaluate`),this.patternCache.set(e,{processedPattern:null,patternSlot:this.getPatternSlot(e),isPreEvaluated:!1,originalPattern:t||""}),!1;const s=await this.processPattern(t,e);if(!s)return console.warn(`[${e}] Pattern processing failed - cannot cache`),this.patternCache.set(e,{processedPattern:null,patternSlot:this.getPatternSlot(e),isPreEvaluated:!1,originalPattern:t}),!1;const a=this.getPatternSlot(e);try{const r=`${a} = silence`;return await window.strudel.evaluate(r),this.patternCache.set(e,{processedPattern:s,patternSlot:a,isPreEvaluated:!0,originalPattern:t}),console.log(`✅ Pre-evaluated and cached pattern for ${e} in ${a} (silent, ready for manual trigger)`),!0}catch(r){return console.warn(`[${e}] Failed to pre-evaluate pattern:`,r),this.patternCache.set(e,{processedPattern:s,patternSlot:a,isPreEvaluated:!1,originalPattern:t}),!1}}invalidatePatternCache(e){this.patternCache.delete(e),console.log(`🗑️ Invalidated pattern cache for ${e}`)}async preloadAllPatterns(){if(!window.strudel||!window.strudel.evaluate){console.log("Cannot preload patterns: Strudel not ready");return}console.log("📦 Pre-loading all configured patterns...");const e=fs.elements||[];let t=0,s=0;for(const a of e){const r=a.id;let o=null;try{const l=localStorage.getItem(`element-config-${r}`);l&&(o=JSON.parse(l))}catch{}const i=(o==null?void 0:o.pattern)||(a==null?void 0:a.pattern)||"";i&&i.trim()!==""&&(await this.preEvaluatePattern(r,i)?t++:s++)}console.log(`✅ Pre-loaded ${t} patterns${s>0?`, ${s} failed`:""}`)}async setElementGain(e,t){const s=Math.max(0,Math.min(1,t)),a=this.elementGainValues.get(e);this.elementGainValues.set(e,s),console.log(`[${e}] Gain set to ${s.toFixed(2)}`);const r=this.elementGainNodes.get(e);r&&(r.gain.value=s*this.volume,_a(this,`🎚️ Updated ${e} gain node to ${(s*this.volume).toFixed(2)}`)),a!==s&&(this.patternCache.get(e)&&(this.patternCache.delete(e),console.log(`🗑️ Invalidated pattern cache for ${e} (gain changed)`)),this.trackedPatterns.has(e)&&await this.updateTrackedElementGain(e,s)),this.isPlaying(e)&&!this.masterActive&&a!==s&&this.updatePlayingPattern(e)}async setElementPan(e,t){const s=Math.max(-1,Math.min(1,t)),a=this.elementPanValues.get(e);this.elementPanValues.set(e,s),console.log(`[${e}] Pan set to ${s.toFixed(2)}`);const r=this.elementPanNodes.get(e);r&&(r.pan.value=s,_a(this,`🎚️ Updated ${e} pan node to ${s.toFixed(2)}`)),a!==s&&(this.patternCache.get(e)&&(this.patternCache.delete(e),console.log(`🗑️ Invalidated pattern cache for ${e} (pan changed)`)),this.trackedPatterns.has(e)&&await this.updateTrackedElementPan(e,s)),this.isPlaying(e)&&!this.masterActive&&a!==s&&this.updatePlayingPattern(e)}async updatePlayingPattern(e){const t=this.activeSounds.get(e);if(!t||t.type!=="strudel")return;const s=this.elementGainValues.get(e)||.8;if(s<=.001){console.log(`[${e}] Gain is ${s} (effectively muted) - stopping playback`),this.stopSound(e);return}const a=this.strudelPatternSlots.get(e);if(!(!a||!window.strudel||!window.strudel.evaluate))try{const r=fs.getElementConfig(e);if(!r||!r.pattern)return;let o=r.pattern.replace(/\._scope\(\)/g,"");o=this.applyElementGainPanToPattern(o,e,{applyGainInPattern:!1}),await window.strudel.evaluate(`${a} = ${o}`),console.log(`✅ Updated ${a} with new gain/pan`)}catch(r){console.warn(`Could not update pattern for ${e}:`,r)}}async updatePatternInPlace(e,t){if(this.trackedPatterns.has(e)){const r=this.trackedPatterns.get(e),o=t.replace(/[""]/g,'"').replace(/['']/g,"'");r.rawPattern=o,r.pattern=this.convertPatternForScale(o)||o,_a(this,`🎚️ Updated tracked pattern for ${e} in master: ${t.substring(0,60)}...`),await this.updateMasterPattern(this.soloedElements,this.mutedElements),this.masterActive&&this.scheduleMasterPatternRefresh(`pattern-update:${e}`)}const s=this.activeSounds.get(e);if(!s||s.type!=="strudel")return;const a=this.strudelPatternSlots.get(e);if(!(!a||!window.strudel||!window.strudel.evaluate)){this._lastAppliedPatterns=this._lastAppliedPatterns||new Map;try{let r=t.replace(/\s+/g," ").trim();r=r.replace(/\s+\./g,".").trim(),r=r.replace(/\.\.+/g,".").trim(),r=r.replace(/\.(cpm|fast|slow)\([^)]*\)/g,"").trim(),r=r.replace(/\.\.+/g,".").trim();const o=r.match(/\.bank\(["']([^"']+)["']\)/g);if(o){const l=o.map(c=>c.match(/\.bank\(["']([^"']+)["']\)/)[1]);for(const c of l)this.loadedBanks.has(c)||(r=r.replace(new RegExp(`\\.bank(["']${c}["'])`,"g"),""));r=r.replace(/\.+$/,"").trim()}if(r=this.applyElementGainPanToPattern(r,e,{applyGainInPattern:this.masterActive}),this._lastAppliedPatterns.get(e)===r){_a(this,`⚡ Skipping re-evaluation for ${e}; pattern unchanged.`);return}await window.strudel.evaluate(`${a} = ${r}`),console.log(`✅ Updated ${a} pattern in place: ${r.substring(0,60)}...`),this._lastAppliedPatterns.set(e,r)}catch(r){console.warn(`Could not update pattern in place for ${e}:`,r)}}}getElementGain(e){return this.elementGainValues.get(e)||.8}getElementPan(e){return this.elementPanValues.get(e)||0}async playSynthesizedSound(e,t){if(!this.initialized||!this.audioContext){console.log("Audio not initialized - waiting for user interaction");return}if(this.audioContext.state==="suspended")try{if(ah(),await this.audioContext.resume(),this.audioContext.state!=="running"){console.log("Audio context not running - user interaction required");return}}catch{console.log("Audio context needs user interaction");return}this.stopSound(e);const s=this.parsePattern(t);if(s.sounds.length===0){console.warn(`No sounds parsed from pattern: ${t}`);return}console.log(`Playing pattern for ${e}:`,t,s);try{const a=this.createOscillatorForPattern(s,e);a&&a.gain?(this.activeSounds.set(e,{type:"synthesized",oscillator:a,gain:a.gain}),console.log(`Sound started for ${e}`)):console.error(`Failed to create oscillator for ${e}`)}catch(a){console.error(`Error playing sound for ${e}:`,a)}}parsePattern(e){let t=e;const s=e.match(/(?:sound|s)\(["']([^"']+)["']\)/);s&&(t=s[1]);const a={bd:{freq:60,duration:.1,type:"sine"},sd:{freq:200,duration:.05,type:"noise"},hh:{freq:800,duration:.02,type:"square"},cp:{freq:400,duration:.08,type:"triangle"},misc:{freq:300,duration:.06,type:"triangle"}},r=[];if(t.split(",").forEach((l,c)=>{let u=l.trim();u=u.replace(/(\w+)\*(\d+)/g,(f,v,O)=>Array(parseInt(O)).fill(v).join(" ")),u=u.replace(/\[([^\]]+)\]/g,(f,v)=>v.trim());const h=u.trim().split(/\s+/);let m=0;for(const f of h){if(f==="~"||f===""){m++;continue}a[f]&&r.push({...a[f],time:m*.25}),m++}}),r.length===0)return console.warn(`No sounds found in pattern: ${e}`),{sounds:[],duration:0};r.sort((l,c)=>l.time-c.time);const i=Math.max(...r.map(l=>l.time+l.duration));return{sounds:r,duration:Math.max(i,.5)}}parseIndexPattern(e){const t=[];let s=e.replace(/<([^>]+)>/g,(r,o)=>o.trim().split(/\s+/)[0]);s=s.replace(/\[([^\]]+)\]/g,(r,o)=>o.trim()),s=s.replace(/(\d+)\*(\d+)/g,(r,o,i)=>Array(parseInt(i)).fill(o).join(" "));const a=s.trim().split(/\s+/);for(const r of a){const o=parseInt(r);isNaN(o)||t.push(o)}return t}createPatternFromIndices(e){const t=["bd","sd","hh","cp","bd","sd","hh","cp"];return`sound("${e.map(a=>t[a%t.length]||"~").join(" ")}")`}createPatternFromSampleName(e){return e.includes("break")||e.includes("165")?'sound("bd ~ sd ~ bd ~ sd hh")':'sound("bd sd hh ~ cp ~ hh ~")'}createOscillatorForPattern(e,t){if(!this.audioContext)return console.error("Audio context not initialized"),{gain:null,stop:()=>{}};const s=this.audioContext.createGain(),a=t?this.getElementAudioNodes(t):null;a?(s.connect(a.gainNode),s.gain.value=1):(s.connect(this.gainNode),s.gain.value=this.volume);const r=this.audioContext.currentTime;e.sounds.forEach((i,l)=>{const c=r+i.time;if(i.type==="noise"){const u=Math.floor(this.audioContext.sampleRate*i.duration),h=this.audioContext.createBuffer(1,u,this.audioContext.sampleRate),m=h.getChannelData(0);for(let O=0;O<u;O++)m[O]=Math.random()*2-1;const f=this.audioContext.createBufferSource();f.buffer=h;const v=this.audioContext.createGain();f.connect(v),v.connect(s),v.gain.setValueAtTime(0,c),v.gain.linearRampToValueAtTime(.3,c+.01),v.gain.exponentialRampToValueAtTime(.01,c+i.duration),f.start(c),f.stop(c+i.duration)}else{const u=this.audioContext.createOscillator();u.type=i.type,u.frequency.value=i.freq;const h=this.audioContext.createGain();u.connect(h),h.connect(s),h.gain.setValueAtTime(0,c),h.gain.linearRampToValueAtTime(.5,c+.01),h.gain.exponentialRampToValueAtTime(.01,c+i.duration),u.start(c),u.stop(c+i.duration)}});const o=r+e.duration;return s.gain.setValueAtTime(this.volume,o),s.gain.exponentialRampToValueAtTime(.01,o+.1),{gain:s,stop:()=>{try{s.gain.cancelScheduledValues(this.audioContext.currentTime),s.gain.setValueAtTime(s.gain.value,this.audioContext.currentTime),s.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.1),setTimeout(()=>s.disconnect(),150)}catch(i){console.error("Error stopping sound:",i)}}}}playAudioFile(e,t){if(!this.initialized||!this.audioContext){console.warn("Audio not initialized yet. Please click anywhere first to enable audio.");return}this.audioContext.state==="suspended"&&(ah(),this.audioContext.resume().catch(a=>{console.error("Failed to resume audio context:",a)})),this.stopSound(e);const s=this.audioBuffers.get(e);s?this.playAudioBuffer(e,s):this.loadAudioFile(e,t).then(a=>{this.playAudioBuffer(e,a)}).catch(a=>{console.error(`Failed to play audio for ${e}:`,a)})}playAudioBuffer(e,t){const s=this.audioContext.createBufferSource();s.buffer=t;const a=this.audioContext.createGain();s.connect(a);const r=this.getElementAudioNodes(e);r?(a.connect(r.gainNode),a.gain.value=1):(a.connect(this.gainNode),a.gain.value=this.volume);const o=r?1:this.volume;a.gain.setValueAtTime(0,this.audioContext.currentTime),a.gain.linearRampToValueAtTime(o,this.audioContext.currentTime+fs.defaults.fadeInTime),s.onended=()=>{this.activeSounds.delete(e)},s.start(0),this.activeSounds.set(e,{type:"audio",source:s,gain:a})}async playStrudelPattern(e,t,s,a=!1){var i;if(!t||typeof t!="string"||t.trim()===""){console.log(`[${e}] No pattern assigned - skipping playback`);return}const r=this.elementGainValues.get(e)||.8;if(r<=.001){console.log(`[${e}] Gain is ${r} (effectively muted) - stopping playback`),this.stopSound(e);return}if(this.masterOnlyPlayback){const l=typeof e=="string"&&e.toLowerCase().includes("preview"),c=l,u=await this.routePatternThroughMaster(e,t,{isPreview:l,autoStart:c});return console.log(`🎚️ Routed ${e} through master-only playback`,u),u}if(!a){const l=document.querySelector(`[data-sound-id="${e}"]`);if(l){const c=l.querySelector(".loop-button");if((c==null?void 0:c.classList.contains("active"))&&this.isPlaying(e)){console.log(`🔄 ${e} has loop active and is playing - skipping sound trigger to prevent layering`);return}}}if(!this.initialized||!this.audioContext){console.log("Audio not initialized - attempting to initialize now...");try{await this.initialize()||console.warn("⚠️ Audio initialization failed - sounds may not play until user clicks")}catch(l){console.warn("⚠️ Error initializing audio:",l)}}if(this.strudelSoundBanksLoaded||console.log(`⏳ Sound banks not fully loaded yet for ${e}, but attempting to play anyway...`),this.audioContext.state==="suspended"){console.log(`🔄 Audio context is suspended for ${e}, attempting to resume...`);try{ah(),await this.audioContext.resume(),await new Promise(l=>setTimeout(l,50)),this.audioContext.state!=="running"?(console.warn(`⚠️ Audio context not running after resume attempt - state: ${this.audioContext.state}`),console.warn("   User interaction (click) may be required to resume audio")):console.log(`✅ Audio context resumed successfully for ${e}`)}catch(l){console.warn("⚠️ Failed to resume audio context:",l),console.warn("   User interaction (click) may be required to resume audio")}}this.stopSound(e),window.strudel&&window.strudel.scheduler&&!window.strudel.scheduler.started&&(console.log(`▶️ Starting scheduler for ${e} playback...`),await window.strudel.scheduler.start()),console.log(`Playing Strudel pattern for ${e}:`,t);try{if(window.strudel||await this.loadStrudelFromCDN(),!window.strudel||!window.strudel.evaluate||typeof window.strudel.evaluate!="function")throw console.error("❌ window.strudel.evaluate is not available"),console.error("window.strudel:",window.strudel),new Error("Strudel REPL evaluate function is not available. Strudel may not have initialized correctly.");if(console.log("Strudel evaluate is available..."),typeof globalThis.note=="function"&&typeof globalThis.sound=="function")console.log("✅ Core functions verified and available");else{const h=new Error("Core functions not available");console.warn("Core functions not available, attempting to load...");try{const{coreModule:m}=await bc();window.__coreModule=m,await window.strudel.evaluate(`
            (function() {
              const core = window.__coreModule || {};
              if (core && typeof core === 'object') {
                Object.assign(globalThis, core);
              }
              globalThis.__core_loaded = true;
            })();
          `);for(let f=0;f<20;f++){try{if(await window.strudel.evaluate("globalThis.__core_loaded === true")&&typeof globalThis.note=="function"){console.log("✅ Core functions loaded into REPL");break}}catch{}await new Promise(v=>setTimeout(v,100))}}catch(m){console.warn("Could not load core functions:",m)}}await this.ensureDefaultSoundBanks()||console.warn("⚠️ Continuing without default sound banks - patterns may fail");try{console.log("Registering sawtooth sound...");try{const{webaudioModule:h}=await bc(),m=`
                (function() {
                  const webaudio = window.__webaudioModule || {};
                  const { registerSound, getAudioContext } = webaudio;
                  
                  registerSound('sawtooth', (time, value, onended) => {
                    let { freq } = value;
                    const ctx = getAudioContext();
                    const o = new OscillatorNode(ctx, { type: 'sawtooth', frequency: Number(freq) || 440 });
                    o.start(time);
                    const g = new GainNode(ctx, { gain: 0.3 });
                    o.connect(g);
                    const stop = (time) => {
                      o.stop(time);
                      o.disconnect();
                      g.disconnect();
                      onended();
                    };
                    o.addEventListener('ended', () => {
                      o.disconnect();
                      g.disconnect();
                      onended();
                    });
                    return { node: g, stop };
                  }, { type: 'synth' });
                  
                  // Make registerSound and getAudioContext available globally for future use
                  globalThis.registerSound = registerSound;
                  globalThis.getAudioContext = getAudioContext;
                })();
              `;window.__webaudioModule=h,await window.strudel.evaluate(m),await new Promise(f=>setTimeout(f,200)),console.log("✅ Sawtooth sound registered (will be verified on first use)")}catch(h){console.warn("Could not use webaudio module:",h);try{const{webaudioModule:m}=await bc();window.__webaudioModule=m,await window.strudel.evaluate(`
                  (function() {
                    const webaudio = window.__webaudioModule || {};
                    const { registerSound, getAudioContext } = webaudio;
                  
                  if (registerSound && getAudioContext) {
                    registerSound('sawtooth', (time, value, onended) => {
                      let { freq } = value;
                      const ctx = getAudioContext();
                      const o = new OscillatorNode(ctx, { type: 'sawtooth', frequency: Number(freq) || 440 });
                      o.start(time);
                      const g = new GainNode(ctx, { gain: 0.3 });
                      o.connect(g);
                      const stop = (time) => {
                        o.stop(time);
                      };
                      o.addEventListener('ended', () => {
                        o.disconnect();
                        g.disconnect();
                        onended();
                      });
                      return { node: g, stop };
                    }, { type: 'synth' });
                  }
                })();
              `),await new Promise(v=>setTimeout(v,200)),console.log("✅ Sawtooth sound registered via REPL")}catch(m){console.warn("Could not register sawtooth via fallback:",m)}}}catch(h){console.warn("Could not register sawtooth sound:",h),console.warn("Pattern may still work if sawtooth is a default sound")}if(s){const h=window.strudel.samples||globalThis.samples;if(h&&typeof h=="function")try{if(typeof s=="string")console.log("Loading custom samples with string:",s),await h(s),console.log("Custom samples loaded successfully");else if(typeof s=="object"&&s!==null){const m=fs.getElementConfig(e),f=(m==null?void 0:m.samplesBaseUrl)||"";console.log("Loading custom samples:",s),console.log("Base URL:",f),await h(s,{baseUrl:f}),console.log("Custom samples loaded successfully")}}catch(m){console.error("Error loading custom samples:",m)}}try{if(typeof globalThis.note=="function"&&typeof globalThis.sound=="function")console.log("✅ Verified core functions are available");else{const k=new Error("Core functions not available");console.warn("Core functions check failed, attempting to load..."),console.warn("⚠️ Core functions not available, attempting to load now...");try{const{coreModule:M}=await bc();window.__coreModule=M,await window.strudel.evaluate(`
              (function() {
                const core = window.__coreModule || {};
                if (core && typeof core === 'object') {
                  Object.assign(globalThis, core);
                }
                globalThis.__core_loaded = true;
              })();
            `);for(let E=0;E<20;E++){try{if(await window.strudel.evaluate("globalThis.__core_loaded === true")&&typeof globalThis.note=="function")break}catch{}await new Promise(I=>setTimeout(I,100))}}catch(M){throw console.error("❌ Failed to load core functions:",M),new Error("Core Strudel functions (note, samples, etc.) are not available in REPL context. Pattern evaluation will fail.")}}if(console.log("Evaluating pattern:",t),window.strudel&&window.strudel.evaluate)try{const k=[];let M=0;for(;;){const E=t.indexOf("samples(",M);if(E===-1)break;let I=0,D=!1,F="",_=E+8;for(;_<t.length&&/\s/.test(t[_]);)_++;if(_<t.length&&t[_]==="{"){const $=_;for(I=1,_++;_<t.length&&I>0;){const Z=t[_];D?Z===F&&t[_-1]!=="\\"&&(D=!1):Z==='"'||Z==="'"?(D=!0,F=Z):Z==="{"?I++:Z==="}"&&I--,_++}if(I===0){const Z=t.substring($,_);for(;_<t.length&&(/\s/.test(t[_])||t[_]===",");)_++;let ce=null;if(_<t.length&&(t[_]==='"'||t[_]==="'")){const U=t[_],ue=_;for(_++;_<t.length;){if(t[_]==="\\"){_+=2;continue}if(t[_]===U){ce=t.substring(ue,_+1),_++;break}_++}}for(;_<t.length&&/\s/.test(t[_]);)_++;if(_<t.length&&t[_]===")"){const U=t.substring(E,_+1);k.push({fullCall:U,samplesObj:Z,secondParam:ce}),M=_+1;continue}else if(_<t.length){const U=t.substring(E,_);k.push({fullCall:U,samplesObj:Z,secondParam:ce}),M=_;continue}}}M=E+1}for(const E of k){const I=E.fullCall,D=E.samplesObj,F=E.secondParam;k.push({fullCall:I,samplesObj:D,secondParam:F})}for(const E of k)try{console.log("📦 Pre-loading samples() call in REPL:",E.fullCall),await window.strudel.evaluate(E.fullCall),console.log("✅ Samples loaded via REPL evaluation"),await new Promise(I=>setTimeout(I,500))}catch(I){console.warn("Could not evaluate samples() call in REPL:",I);try{const D=((i=window.strudel)==null?void 0:i.samples)||globalThis.samples;if(D&&typeof D=="function"){let F={};try{F=new Function("return "+E.samplesObj)()}catch(_){console.warn("Could not parse samples object:",_);continue}if(Object.keys(F).length>0){if(console.log("📦 Loading samples directly as fallback:",F),E.secondParam){let _=null;try{const $=E.secondParam.trim();$.startsWith("{")?_=new Function("return "+$)():_=$.replace(/^["']|["']$/g,""),await D(F,_)}catch{const Z=E.secondParam.trim().replace(/^["']|["']$/g,"");await D(F,Z)}}else await D(F);await new Promise(_=>setTimeout(_,500))}}}catch(D){console.warn("Fallback samples loading also failed:",D)}}k.length>0&&console.log(`✅ Pre-loaded ${k.length} samples() call(s) - pattern will be evaluated with samples already loaded`)}catch(k){console.warn("Error pre-loading samples from pattern:",k)}const h=this.getPatternSlot(e);console.log(`Assigning pattern to ${h} for element ${e}`);const m=this.getElementAudioNodes(e);(!m||!m.gainNode)&&console.warn(`⚠️ Could not prepare audio nodes for ${e} (pattern slot ${h})`),this.currentEvaluatingSlot=h;let f=null;const v=this.patternCache.get(e);if(v&&v.originalPattern===t&&v.processedPattern)f=v.processedPattern,console.log(`⚡ Using cached pattern for ${e} (instant trigger)`),f=this.applyElementGainPanToPattern(v.processedPattern.replace(/\.gain\([^)]*\)/g,"").replace(/\.pan\([^)]*\)/g,"").replace(/\.fast\([^)]*\)/g,"").replace(/\.slow\([^)]*\)/g,"").trim(),e,{applyGainInPattern:this.masterActive});else{if(console.log(`📝 Processing pattern for ${e} (not cached)`),f=await this.processPattern(t,e,{applyGainInPattern:this.masterActive}),!f){console.warn(`[${e}] Pattern processing failed - cannot evaluate`);try{const k=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(k);return}catch(k){console.error(`Failed to set ${h} to silence:`,k);return}}this.patternCache.set(e,{processedPattern:f,patternSlot:h,isPreEvaluated:!1,originalPattern:t})}if(!f||f.trim()===""){console.warn(`[${e}] Pattern became empty - cannot evaluate`);return}f.includes("undefined")&&!f.includes("globalThis.undefined")&&(console.warn("⚠️ Pattern contains 'undefined' - might be from removed samples() call"),f=f.replace(/undefined\s*[,\n;]/g,"").trim(),f=f.replace(/,\s*undefined/g,"").trim(),f=f.replace(/undefined\s*\./g,"").trim());const O=`${h} = ${f}`;console.log(`🎼 ${e} → ${h}:`),console.log(`   Full Pattern: ${f.substring(0,200)}${f.length>200?"...":""}`),console.log(`   Assignment: ${O.substring(0,200)}${O.length>200?"...":""}`);try{window.strudel&&window.strudel.scheduler&&!window.strudel.scheduler.started&&(console.log(`▶️ Starting scheduler for ${e} pattern evaluation...`),await window.strudel.scheduler.start());const k=await window.strudel.evaluate(O);this.currentEvaluatingSlot=h;const M=this.soundsPreloaded?500:1e3;if(setTimeout(()=>{this.currentEvaluatingSlot===h&&(this.currentEvaluatingSlot=null)},M),k&&typeof k=="object"&&k.message&&k.message.includes("undefined instead of pattern")){console.warn("⚠️ Pattern returned undefined - setting to silence");try{const E=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(E);return}catch(E){console.error(`Failed to set ${h} to silence:`,E);return}}console.log(`✅ Pattern assignment attempted for ${h}`)}catch(k){if(k.message&&k.message.includes("undefined instead of pattern")){console.error("❌ Pattern evaluation failed: pattern returned undefined"),console.error("   This usually means:"),console.error("   - Bank samples aren't loaded (check .bank() usage)"),console.error("   - Pattern syntax is invalid"),console.error("   - Required samples/sounds aren't available"),console.error(`   Pattern: ${f.substring(0,100)}`);try{const M=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(M),console.log(`✅ Set ${h} to silence due to pattern error`)}catch(M){console.error(`Failed to set ${h} to silence:`,M)}return}if(k.message.includes("not defined")||k.message.includes("ReferenceError")){console.log(`Slot ${h} doesn't exist, creating it...`);try{const M=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(M),await window.strudel.evaluate(O),console.log(`✅ Pattern assigned to ${h} after slot creation`)}catch(M){if(console.error(`❌ Failed to assign pattern to ${h} even after creating slot:`,M),M.message&&M.message.includes("undefined instead of pattern")){console.error("   Pattern still invalid - setting to silence");try{const E=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(E)}catch(E){console.error(`Failed to set ${h} to silence:`,E)}return}throw M}}else{console.error(`❌ Failed to assign pattern to ${h}:`,k);try{const M=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(M),console.log(`✅ Set ${h} to silence as fallback`)}catch(M){console.error(`Failed to set ${h} to silence:`,M)}return}}}catch(h){if(console.error("❌ Error evaluating pattern:",h),console.error("Pattern was:",t),console.error("Error details:",h.message),h.message&&h.message.includes("undefined instead of pattern")||h.isUndefinedPattern===!0){console.warn("⚠️ Pattern evaluation returned undefined"),console.warn("   This usually means:"),console.warn("   - Bank samples aren't loaded (check .bank() usage)"),console.warn("   - Pattern syntax is invalid"),console.warn("   - Required samples/sounds aren't available"),console.warn(`   Pattern: ${t.substring(0,100)}`);const m=this.getPatternSlot(e);try{await window.strudel.evaluate(`${m} = silence`),console.log(`✅ Set ${m} to silence due to pattern error`)}catch(f){console.warn(`⚠️ Failed to set ${m} to silence:`,f.message)}return}throw(h.message.includes("note is not defined")||h.message.includes("s is not defined"))&&(console.error("❌ Core Strudel functions (note, s, etc.) are not available in REPL context"),console.error("This means Strudel REPL was not properly initialized with core functions"),console.error("Pattern cannot be evaluated without core functions - NOT using fallback")),h}console.log(`Strudel pattern started for ${e}`),this.currentEvaluatingSlot=null;const c=this.strudelPatternSlots.get(e);if(typeof e=="string"&&e.toLowerCase().includes("preview"))this.trackedPatterns.has(e)&&(this.trackedPatterns.delete(e),console.log(`🗑️ Removed preview element ${e} from master tracking`),await this.updateMasterPattern(this.soloedElements,this.mutedElements));else if(!this.trackedPatterns.has(e)){const h=this.getElementGain(e)||.8,m=this.getElementPan(e)||0,f=t.replace(/[""]/g,'"').replace(/['']/g,"'");this.trackedPatterns.set(e,{pattern:f,gain:h,pan:m,muted:!1,soloed:!1}),console.log(`➕ Auto-added ${e} to master tracked patterns`),await this.updateMasterPattern(this.soloedElements,this.mutedElements)}this.activeSounds.set(e,{type:"strudel",patternSlot:c,stop:()=>{window.strudel.evaluate&&c&&(console.log(`🔇 Stopping ${e} (${c}) - setting to silence`),window.strudel.evaluate(`${c} = silence`).then(()=>{console.log(`✅ ${c} silenced`)}).catch(h=>{console.error(`❌ Error stopping pattern in ${c}:`,h)}))}});return}catch(l){console.warn("Failed to load Strudel from local packages:",l)}console.warn("Using simplified pattern parsing as fallback...");const o=t.match(/s\(["']([^"']+)["']\)/);if(o){const l=o[1],c=t.match(/\.slice\((\d+)\s*,\s*"([^"]+)"\)/);if(c){const u=this.parseIndexPattern(c[2]),h=this.createPatternFromIndices(u);await this.playSynthesizedSound(e,h)}else{const u=this.createPatternFromSampleName(l);await this.playSynthesizedSound(e,u)}}else await this.playSynthesizedSound(e,t)}async loadStrudelFromCDN(){var s,a,r,o,i,l,c,u,h;const e=typeof globalThis.silence=="object"&&typeof globalThis.sound=="function"&&typeof globalThis.note=="function";if(this.strudelLoaded&&window.strudel&&window.strudel.evaluate&&e){console.log("Strudel already loaded, initialized, and functions exposed");return}if(e||console.log("Functions not exposed, need to reload/expose:",{silence:typeof globalThis.silence+" (should be object)",sound:typeof globalThis.sound+" (should be function)",note:typeof globalThis.note+" (should be function)"}),this.strudelLoading){for(console.log("Strudel is currently loading, waiting...");this.strudelLoading;)await new Promise(m=>setTimeout(m,100));if(this.strudelLoaded&&window.strudel){console.log("Strudel loading completed by another call");return}}this.strudelLoading=!0,console.log("Loading Strudel...");try{const{webModule:m,coreModule:f,webaudioModule:v,tonalModule:O}=await bc(),k=m;console.log("✅ Loaded Strudel from local packages");let M=null,E=null,I=!1,D=v.webaudioOutput||((s=v.default)==null?void 0:s.webaudioOutput)||(k==null?void 0:k.webaudioOutput);!D&&typeof v=="function"&&(D=v),!D&&typeof v.default=="function"&&(D=v.default);const F=k.repl||m.repl,_=k.initStrudel||m.initStrudel;if(!F&&!_)throw new Error("Strudel REPL not available");if(console.log("Available initialization methods:",{hasRepl:!!F,hasInitStrudel:!!_}),!D||typeof D!="function")throw console.error("webaudioModule structure:",Object.keys(v||{})),console.error("webaudioOutput type:",typeof D),new Error("Strudel webaudioOutput not available or not a function");console.log("✅ Core module loaded, available functions:",Object.keys(f).filter(U=>typeof f[U]=="function").slice(0,15)),console.log("webaudioOutput type:",typeof D),this.strudelOutputFactory=D,console.log("Merging modules..."),console.log("  coreModule keys:",f?Object.keys(f).length:0),console.log("  tonalModule keys:",O?Object.keys(O).length:0),console.log("  webaudioModule keys:",v?Object.keys(v).length:0),console.log("  webModule keys:",m?Object.keys(m).length:0);const $={...f||{},...O||{},...v||{},...m||{},...j2||{}};if(Object.keys($).forEach(U=>{$[U]===void 0&&delete $[U]}),console.log("After merge - allModules total keys:",Object.keys($).length),console.log("After merge - function count:",Object.keys($).filter(U=>typeof $[U]=="function").length),typeof globalThis.silence=="object"&&typeof globalThis.sound=="function"&&typeof globalThis.note=="function"?(console.log("Strudel functions already properly exposed to globalThis, skipping..."),console.log("Verification - typeof globalThis.silence:",typeof globalThis.silence,"(Pattern object)"),console.log("Verification - typeof globalThis.sound:",typeof globalThis.sound,"(function)"),console.log("Verification - typeof globalThis.note:",typeof globalThis.note,"(function)")):(console.log("Exposing all Strudel functions to globalThis..."),console.log("allModules keys:",Object.keys($).length),console.log("Sample functions:",Object.keys($).filter(U=>typeof $[U]=="function").slice(0,10)),Object.assign(globalThis,$),globalThis.__strudelModulesExposed=!0,console.log("✅ Exposed",Object.keys($).filter(U=>typeof $[U]=="function").length,"functions to globalThis"),console.log("Verification - typeof globalThis.silence:",typeof globalThis.silence,"(Pattern object)"),console.log("Verification - typeof globalThis.sound:",typeof globalThis.sound,"(function)"),console.log("Verification - typeof globalThis.note:",typeof globalThis.note,"(function)")),E=m.samples||v.samples||k.samples,E?(globalThis.samples=E,console.log("✅ Samples function exposed to globalThis")):console.warn("⚠️ No samples function found in any module"),this.ensurePatternMidiMethodsRegistered("pre-init module exposure"),(m.getAudioContext||v.getAudioContext)&&console.log("✅ Audio context getter available"),console.log("🎚️ Using element channel routing:",!!(this.masterPanNode&&this.masterGainNode)),!globalThis.__strudelPatternsPreInitialized){console.log("🎰 PRE-REPL: Initializing pattern slots d0-d16 on globalThis...");const U=$.silence||globalThis.silence;if(U&&typeof U=="object"){for(let ue=0;ue<=16;ue++)globalThis[`d${ue}`]=U;console.log("✅ PRE-REPL: Pattern slots initialized with silence pattern")}else{console.warn("⚠️ PRE-REPL: silence pattern not available, creating empty pattern objects");const ue={_type:"pattern",query:()=>[],firstCycle:()=>[]};for(let W=0;W<=16;W++)globalThis[`d${W}`]=ue}globalThis.__strudelPatternsPreInitialized=!0,console.log("✅ PRE-REPL: Pattern slots are now defined on globalThis")}if(_&&typeof _=="function"){console.log("Using initStrudel for proper initialization...");try{if(this.midiEnabled)console.log("✅ MIDI already enabled, ensuring midiOutput handler is connected");else try{await this.initializeMIDI()}catch(be){console.warn("⚠️ MIDI initialization failed, continuing without MIDI:",be)}console.log("🔧 Creating fallback scheduler.output before initStrudel...");const U=this.audioContext.createGain();U.connect(this.masterPanNode),console.log("✅ Created fallback output (GainNode) connected to masterPanNode"),console.log("🎯 Keeping destination override active - Strudel will see masterPanNode as destination");const ue={audioContext:this.audioContext,getTime:()=>this.audioContext?this.audioContext.currentTime:0,editPattern:()=>{},setUrl:()=>{},withLoc:!0,midiOutput:be=>{this.midiEnabled&&this.selectedMidiOutput&&this.sendMIDIMessage(be)}};console.log("🎚️ initStrudel options:",Object.keys(ue)),console.log("📍 withLoc enabled for code highlighting"),console.log("🎚️ audioContext.destination (overridden to masterPanNode):",((r=(a=this.audioContext.destination)==null?void 0:a.constructor)==null?void 0:r.name)||typeof this.audioContext.destination);const W=await _(ue);(o=W.scheduler)!=null&&o.output?console.log("✅ Strudel created scheduler.output, and it should route through masterPanNode naturally"):(console.log("🔧 initStrudel did not create output, using fallback"),W.scheduler.output=U,console.log("✅ Assigned fallback output to scheduler.output")),M=W.repl||W,console.log("✅ initStrudel completed, replInstance:",!!M),window.strudel=window.strudel||{},W.scheduler&&(window.strudel.scheduler=W.scheduler,console.log("✅ Stored scheduler in window.strudel"),W.scheduler.output?console.log("✅ scheduler.output exists:",((l=(i=W.scheduler.output)==null?void 0:i.constructor)==null?void 0:l.name)||typeof W.scheduler.output):W.output?(console.log("✅ Found output in strudelContext.output, assigning to scheduler.output"),W.scheduler.output=W.output,console.log("✅ Assigned strudelContext.output to scheduler.output")):(console.warn("⚠️ scheduler.output is missing - Strudel should create it automatically from audioContext"),console.warn("⚠️ Audio may not play if scheduler.output is not set up"),console.warn("⚠️ Note: Manual creation requires internal Strudel functions that are not available"),setTimeout(()=>{var ke,Ce,Ae,q;W.output&&!W.scheduler.output&&(console.log("✅ Found output in strudelContext.output (delayed check), assigning to scheduler.output"),W.scheduler.output=W.output);const be=((ke=window.strudel)==null?void 0:ke.webaudio)||(W==null?void 0:W.webaudio)||((Ce=W==null?void 0:W.scheduler)==null?void 0:Ce.webaudio);if(be&&!W.scheduler.output){const Ne=be.output||be.outputNode;Ne&&(console.log("✅ Found output in webaudio, assigning to scheduler.output"),W.scheduler.output=Ne)}if(W.scheduler.output)console.log("✅ scheduler.output is now set:",((q=(Ae=W.scheduler.output)==null?void 0:Ae.constructor)==null?void 0:q.name)||typeof W.scheduler.output);else if(console.warn("⚠️ scheduler.output still missing after delayed check"),console.log("🔧 Attempting to create output using webaudioOutput factory..."),this.strudelOutputFactory&&typeof this.strudelOutputFactory=="function")try{const Ne=this.strudelOutputFactory({audioContext:this.audioContext,destination:this.audioContext.destination});if(Ne)W.scheduler.output=Ne,console.log("✅ Created scheduler.output using webaudioOutput factory");else throw new Error("Factory returned null/undefined")}catch(Ne){console.warn("⚠️ Factory creation failed, creating minimal wrapper:",Ne.message);try{const Re=this.audioContext.createGain();Re.connect(this.masterPanNode);const je=Re;Object.defineProperty(je,"output",{value:Re,writable:!1,enumerable:!0}),Object.defineProperty(je,"outputNode",{value:Re,writable:!1,enumerable:!0}),W.scheduler.output=je,window.strudel&&window.strudel.scheduler&&(window.strudel.scheduler.output=je),console.log("✅ Created minimal output (GainNode) connected to masterPanNode"),console.log("✅ Assigned to strudelContext.scheduler.output and window.strudel.scheduler.output"),console.log("✅ Output type:",je.constructor.name,"is AudioNode:",je instanceof AudioNode)}catch(Re){console.error("❌ Failed to create minimal output wrapper:",Re)}}else console.error("❌ Cannot create output - strudelOutputFactory not available")},500))),window.soundManager=this,this.ensurePatternMidiMethodsRegistered("post-init initStrudel"),this.midiEnabled&&(this.setupStrudelMIDIOutput(),setTimeout(async()=>{var be,ke,Ce;if(this.ensurePatternMidiMethodsRegistered("delayed post-init check"),M&&M.evaluate)try{const{webaudioModule:Ae}=await bc(),q=((be=window.strudel)==null?void 0:be.scheduler)||(W==null?void 0:W.scheduler);let Ne=(q==null?void 0:q.webaudio)||((ke=window.strudel)==null?void 0:ke.webaudio)||(W==null?void 0:W.webaudio)||((Ce=W==null?void 0:W.output)==null?void 0:Ce.webaudio)||q&&q.output&&q.output.webaudio;if(!Ne&&q&&q.output&&(console.log("   Checking scheduler.output for webaudio..."),typeof q.output.midiOutput=="function"?(console.log("   scheduler.output has midiOutput, treating as webaudio"),Ne=q.output,window.strudel.webaudio=Ne):q.output.webaudio&&(Ne=q.output.webaudio,window.strudel.webaudio=Ne)),!Ne&&W&&W.output&&(console.log("   Checking strudelContext.output for webaudio..."),typeof W.output.midiOutput=="function"?(console.log("   strudelContext.output has midiOutput, treating as webaudio"),Ne=W.output,window.strudel.webaudio=Ne):W.output.webaudio&&(Ne=W.output.webaudio,window.strudel.webaudio=Ne)),!Ne&&(console.log("   Checking strudelContext for webaudio in various locations..."),console.log("   strudelContext keys:",W?Object.keys(W).slice(0,10):[]),q)){console.log("   scheduler keys:",Object.keys(q));for(const Re of Object.keys(q)){const je=q[Re];if(je&&typeof je=="object"){if(typeof je.midiOutput=="function"){console.log(`   ✅ Found midiOutput in scheduler.${Re} - treating as webaudio`),Ne=je,window.strudel.webaudio=Ne;break}else if(je.webaudio){console.log(`   ✅ Found webaudio in scheduler.${Re}.webaudio`),Ne=je.webaudio,window.strudel.webaudio=Ne;break}}}}Ne||console.log("   ℹ️ webaudio not found, but MIDI will work via soundManager fallback"),console.log("🔍 Checking for scheduler/webaudio after delay:",{hasScheduler:!!q,hasWebaudio:!!Ne,midiOutputType:Ne?typeof Ne.midiOutput:"N/A",schedulerKeys:q?Object.keys(q).slice(0,10):[],strudelContextKeys:W?Object.keys(W).slice(0,10):[],hasSoundManager:!!window.soundManager,hasMidiOutputs:!!(window.soundManager&&window.soundManager.midiOutputs),midiOutputsCount:window.soundManager&&window.soundManager.midiOutputs?window.soundManager.midiOutputs.size:0}),await M.evaluate(`
                  (function() {
                    // Verify MIDI methods are available on Pattern.prototype
                    if (typeof Pattern !== 'undefined' && Pattern.prototype) {
                      const hasMidi = typeof Pattern.prototype.midi === 'function';
                      const hasMidiport = typeof Pattern.prototype.midiport === 'function';
                      console.log('🔍 MIDI methods on Pattern.prototype:', { midi: hasMidi, midiport: hasMidiport });
                      
                      if (hasMidi && hasMidiport) {
                        console.log('✅ MIDI methods (.midi(), .midiport()) are available on patterns');
                        console.log('   MIDI will work via soundManager fallback even without webaudio');
                        if (window.soundManager && window.soundManager.midiOutputs) {
                          const ports = Array.from(window.soundManager.midiOutputs.keys());
                          console.log('   Available MIDI ports:', ports.length > 0 ? ports.join(', ') : 'none');
                        }
                      } else {
                        console.warn('⚠️ MIDI methods not found on Pattern.prototype.');
                        console.warn('   They should have been registered early (before initStrudel).');
                        console.warn('   This may indicate a registration timing issue.');
                      }
                    } else {
                      console.warn('⚠️ Pattern class not found in REPL context');
                    }
                  })()
                `)}catch(Ae){console.warn("⚠️ Could not verify/register MIDI methods in REPL context:",Ae)}},500));try{const be=await fetch("/strudel.json");if(be.ok){const ke=await be.json();if(ke.samples){const Ce=((c=window.strudel)==null?void 0:c.samples)||globalThis.samples;Ce&&typeof Ce=="function"&&(console.log("📦 Loading samples from strudel.json"),await Ce(ke.samples),console.log("✅ Samples loaded from strudel.json"))}}}catch{console.log("ℹ️ No strudel.json found or error loading it (this is optional)")}try{await this.preloadPresetSamples()}catch(be){console.warn("⚠️ Error pre-loading preset samples:",be)}if(this.midiEnabled)try{this.setupStrudelMIDIOutput(),setTimeout(async()=>{try{await this.ensureMIDIFunctionsAvailable()}catch(be){console.warn("⚠️ Error ensuring MIDI functions available:",be)}},1e3)}catch(be){console.warn("⚠️ Error setting up MIDI functions:",be)}else console.log("ℹ️ MIDI not enabled; skipping Strudel MIDI wiring to avoid spurious warnings");console.log("replInstance type:",typeof M),console.log("replInstance.evaluate available:",typeof(M==null?void 0:M.evaluate)),console.log("strudelContext keys:",Object.keys(W)),console.log("🔍 Checking strudelContext for webaudio output...");const de=["strudelContext.webaudio","strudelContext.scheduler.webaudio","replInstance.webaudio","replInstance.scheduler.webaudio","strudelContext.output","replInstance.output"];W.scheduler&&(window.strudel=window.strudel||{},window.strudel.scheduler=W.scheduler,console.log("✅ Stored scheduler from strudelContext to window.strudel.scheduler"),W.scheduler.webaudio?(console.log("✅ Found webaudio in strudelContext.scheduler.webaudio"),window.strudel.webaudio=W.scheduler.webaudio):W.scheduler.output&&(console.log("✅ Found output in scheduler, checking for webaudio..."),W.scheduler.output.webaudio?(console.log("✅ Found webaudio in scheduler.output.webaudio"),window.strudel.webaudio=W.scheduler.output.webaudio):(console.log("   scheduler.output might be webaudio, storing it"),window.strudel.webaudio=W.scheduler.output))),W.webaudio&&(console.log("✅ Found webaudio in strudelContext.webaudio"),window.strudel=window.strudel||{},window.strudel.webaudio=W.webaudio),W.output&&(console.log("✅ Found output in strudelContext, checking if it's webaudio..."),W.output.webaudio?(console.log("✅ Found webaudio in strudelContext.output.webaudio"),window.strudel.webaudio=W.output.webaudio):typeof W.output.midiOutput=="function"&&(console.log("✅ strudelContext.output has midiOutput, treating as webaudio"),window.strudel.webaudio=W.output)),M&&M.scheduler&&(console.log("✅ Found scheduler in replInstance"),M.scheduler.webaudio&&console.log("✅ Found webaudio in replInstance.scheduler.webaudio")),(!M||typeof M.evaluate!="function")&&(console.warn("replInstance.evaluate not available, creating REPL manually..."),M=F({audioContext:this.audioContext,getTime:()=>this.audioContext.currentTime,withLoc:!0}),console.log("Created manual REPL, evaluate available:",typeof M.evaluate))}catch(U){console.warn("initStrudel failed, falling back to manual REPL:",U),M=F({audioContext:this.audioContext,getTime:()=>this.audioContext.currentTime})}}else console.log("Creating REPL manually (initStrudel not available)..."),M=F({audioContext:this.audioContext,getTime:()=>this.audioContext.currentTime,withLoc:!0});console.log("🎰 Checking if pattern slots need initialization..."),console.log("   replInstance:",!!M),console.log("   replInstance.evaluate:",typeof(M==null?void 0:M.evaluate)),console.log("   __strudelPatternsInitialized:",!!globalThis.__strudelPatternsInitialized),!globalThis.__strudelPatternsInitialized&&M&&M.evaluate?(console.log("🎰 Initializing pattern slots d0-d16..."),await(async()=>{for(let ue=0;ue<=16;ue++)try{await M.evaluate(`d${ue} = silence`),console.log(`  ✓ d${ue} initialized with silence`)}catch{try{await M.evaluate(`d${ue} = stack()`),console.log(`  ✓ d${ue} initialized with stack()`)}catch(de){console.error(`  ✗ Failed to initialize d${ue}:`,de.message)}}})(),console.log("✅ Pattern slot initialization complete"),globalThis.__strudelPatternsInitialized=!0,M.scheduler&&(console.log("⏸️ Scheduler NOT auto-started - will start when user presses play/preview"),setTimeout(()=>{const ue=M.scheduler;if(ue.webaudio||ue._webaudio){const W=ue.webaudio||ue._webaudio;if(W.output||W.outputNode){const de=W.output||W.outputNode;try{de.disconnect(),de.connect(this.masterPanNode),console.log("✅ Connected webaudio output to master")}catch(be){console.warn("⚠️ Could not connect webaudio output:",be)}}}},500))):globalThis.__strudelPatternsInitialized?console.log("✅ Pattern slots already initialized"):console.warn("⚠️ Cannot initialize pattern slots - replInstance not available"),console.log("✅ REPL initialized - functions available via globalThis");try{let U=null;try{U=await gs(()=>import("./index-Dx0fBmh0.js"),__vite__mapDeps([4,1])),console.log("✅ Draw module imported from local packages")}catch{U=await gs(()=>import("https://unpkg.com/@strudel/draw@1.2.4/dist/index.mjs"),[]),console.log("✅ Draw module imported from CDN")}const ue=((u=f==null?void 0:f.Pattern)==null?void 0:u.prototype)||(typeof Pattern<"u"?Pattern.prototype:null)||(globalThis.Pattern?globalThis.Pattern.prototype:null);if(ue&&(!ue._spectrum&&ue.spectrum&&(ue._spectrum=ue.spectrum),!ue._pianoroll&&ue.pianoroll&&(ue._pianoroll=ue.pianoroll)),U&&M&&M.evaluate){const W="https://unpkg.com/@strudel/draw@1.2.4/dist/index.mjs";try{await M.evaluate(`
              (async function() {
                // Import the draw module - this automatically adds methods to Pattern.prototype
                const draw = await import('${W}')
                // Export getDrawContext for use in visualizers
                if (draw.getDrawContext) {
                  globalThis.getDrawContext = draw.getDrawContext
                }
                if (typeof Pattern !== 'undefined') {
                  if (!Pattern.prototype._spectrum && Pattern.prototype.spectrum) {
                    Pattern.prototype._spectrum = Pattern.prototype.spectrum;
                  }
                  if (!Pattern.prototype._pianoroll && Pattern.prototype.pianoroll) {
                    Pattern.prototype._pianoroll = Pattern.prototype.pianoroll;
                  }
                }
              })()
            `),await new Promise(de=>setTimeout(de,300))}catch(de){console.warn("⚠️ Could not load @strudel/draw in REPL context:",de)}}}catch(U){console.warn("⚠️ Could not load @strudel/draw functions:",U)}if(this.strudelRepl=M,this.audioContext&&(m.getAudioContext||v.getAudioContext)&&typeof(m.getAudioContext||v.getAudioContext)=="function")try{m.getAudioContext&&Object.defineProperty(m,"getAudioContext",{value:()=>(console.log("🎚️ Strudel getAudioContext() called - returning our shared context"),this.audioContext),writable:!0,configurable:!0}),v.getAudioContext&&Object.defineProperty(v,"getAudioContext",{value:()=>(console.log("🎚️ Strudel webaudio getAudioContext() called - returning our shared context"),this.audioContext),writable:!0,configurable:!0}),console.log("✅ Patched Strudel getAudioContext() to return our shared context")}catch(ue){ue.message.includes("Cannot redefine property")||console.warn("⚠️ Could not patch getAudioContext (module may be read-only):",ue.message)}if(M&&M.scheduler){const U=M.scheduler;U.audioContext&&U.audioContext!==this.audioContext&&(console.log("🎚️ Replacing scheduler audioContext with our shared context"),U.audioContext=this.audioContext),U.superdough&&U.superdough.audioContext&&U.superdough.audioContext!==this.audioContext&&(console.log("🎚️ Replacing superdough audioContext with our shared context"),U.superdough.audioContext=this.audioContext)}if(this.exposeSampleListHelper(v,m),M&&M.scheduler&&this.masterPanNode&&this.masterGainNode)try{const U=M.scheduler;if(console.log("🔍 Checking for scheduler output..."),console.log("  scheduler.output:",!!U.output),console.log("  scheduler keys:",Object.keys(U).slice(0,15)),U.output){console.log("  scheduler.output type:",U.output.constructor.name);try{U.output.disconnect(),U.output.connect(this.masterPanNode),console.log("✅ Connected scheduler.output to masterPanNode")}catch(ue){console.warn("⚠️ Could not connect scheduler.output:",ue)}}if((h=U.superdough)!=null&&h.output){const ue=U.superdough.output;if(console.log("  Found superdough.output:",ue?ue.constructor.name:"null"),ue&&typeof ue.connect=="function")try{ue.disconnect(),ue.connect(this.masterPanNode),console.log("✅ Connected superdough.output to masterPanNode")}catch(W){console.warn("⚠️ Could not connect superdough.output:",W)}}if(U.audioContext){const ue=U.audioContext.destination;try{Object.defineProperty(U.audioContext,"destination",{get:()=>this.destinationWrapper||this.masterPanNode||ue,configurable:!0}),console.log("🎚️ Patched scheduler audioContext.destination to use destinationWrapper")}catch(W){console.warn("⚠️ Could not patch scheduler audioContext:",W)}}}catch(U){console.warn("⚠️ Could not intercept scheduler output:",U)}if(M&&M.scheduler){console.log("⏸️ REPL scheduler found (will be started after pattern slots are initialized)...");const U=(ue=1,W=1e3)=>{setTimeout(()=>{var Ae,q,Ne,Re;const de=M.scheduler,be={"scheduler.superdough":de.superdough,"scheduler.output":de.output,"window.superdough":window.superdough,"window.strudel.superdough":(Ae=window.strudel)==null?void 0:Ae.superdough,"replInstance.superdough":M.superdough},ke=de.output;let Ce=!1;if((q=de.superdough)!=null&&q.output&&this.masterPanNode){console.log(`🔍 [DELAYED CHECK ${ue}] Found scheduler.superdough.output`),console.log("  superdough.output type:",de.superdough.output.constructor.name);try{de.superdough.output.disconnect(),de.superdough.output.connect(this.masterPanNode),console.log(`✅ [DELAYED CHECK ${ue}] Connected scheduler.superdough.output to masterPanNode`),Ce=!0}catch(je){console.warn(`⚠️ [DELAYED CHECK ${ue}] Could not connect scheduler.superdough.output:`,je)}}else if(ke&&ke.constructor.name==="GainNode"&&ke!==this.masterPanNode)console.log(`🔍 [DELAYED CHECK ${ue}] Checking if scheduler.output is superdough output`),console.log("  scheduler.output type:",ke.constructor.name),console.log(`ℹ️ [DELAYED CHECK ${ue}] scheduler.output (GainNode) already connected to masterPanNode from initialization`),Ce=!0;else{console.log(`ℹ️ [DELAYED CHECK ${ue}] Superdough output search (waited ${W}ms):`);for(const[je,me]of Object.entries(be))console.log(`  ${je}:`,me?((Ne=me.constructor)==null?void 0:Ne.name)||typeof me:"undefined"),me&&typeof me=="object"&&me.output&&console.log(`    ${je}.output:`,(Re=me.output.constructor)==null?void 0:Re.name);console.log("  scheduler keys:",Object.keys(de).slice(0,20)),ue<5&&U(ue+1,W+1e3)}},W)};U(1,1e3)}const ce=async U=>{try{const ue=await M.evaluate(U);return ue===void 0&&U.includes("=")&&!U.trim().startsWith("//")&&(/^d\d+\s*=\s*/.test(U.trim())||/\w+\s*=\s*s\(|sound\(|note\(/.test(U))&&(console.warn(`⚠️ Pattern assignment returned undefined: ${U.substring(0,80)}`),console.warn("   This usually means the pattern is invalid or samples aren't loaded")),(ue!==void 0||!U.includes("="))&&console.log(`Eval result for "${U.substring(0,50)}...":`,typeof ue,ue),ue}catch(ue){if(ue.message&&ue.message.includes("undefined instead of pattern")){const W=new Error("Pattern evaluation failed: got undefined instead of pattern");throw W.originalError=ue,W.code=U,W.isUndefinedPattern=!0,console.warn("⚠️ Pattern evaluation error: got undefined instead of pattern"),console.warn(`   Code: ${U.substring(0,100)}`),console.warn("   This usually means:"),console.warn("   - Bank samples aren't loaded (check .bank() usage)"),console.warn("   - Pattern syntax is invalid"),console.warn("   - Required samples/sounds aren't available"),W}throw console.error("Evaluation error:",ue),ue}};E||(E=m.samples||k.samples||M&&M.samples),window.strudel={initialized:!0,evaluate:ce,samples:E||(()=>{}),repl:M,scheduler:M==null?void 0:M.scheduler},this.strudelLoaded=!0,this.strudelLoading=!1,console.log("Checking Strudel functions availability..."),console.log("  typeof silence:",typeof globalThis.silence),console.log("  typeof sound:",typeof globalThis.sound),console.log("  typeof note:",typeof globalThis.note),console.log("✅ REPL ready (functions available via globalThis)"),this.currentTempo=120;try{await window.strudel.evaluate("cps = 1"),console.log("✅ Initial tempo set to 120 BPM (base cps=1, using .fast()/.slow() on patterns)")}catch(U){console.warn("⚠️ Could not set initial cps:",U)}return}catch(m){console.error("Failed to load Strudel module:",m),this.strudelLoading=!1}const t=["https://unpkg.com/@strudel/web@1.2.5/dist/index.mjs","https://cdn.jsdelivr.net/npm/@strudel/web@1.2.5/dist/index.mjs","https://esm.sh/@strudel/web@1.2.5"];for(const m of t)try{console.log(`Trying to load Strudel from: ${m}`);const f=await import(m),v=f.repl,O=f.samples;if(!v){console.warn("Strudel module missing repl. Available exports:",Object.keys(f));continue}const k=f.initStrudel;k&&k({audioContext:this.audioContext,output:this.audioContext,withLoc:!0});let M=null;try{M=(await bc()).coreModule,console.log("✅ Core module from cached getStrudelModules()"),console.log("Available exports:",Object.keys(M).slice(0,10))}catch(I){console.warn("Could not get core module from cache, trying direct import:",I);try{M=await gs(()=>import("./strudel-core-cY4HxVpV.js").then(D=>D.A),[]),console.log("✅ Core module imported directly (fallback)")}catch(D){console.warn("Could not import core module:",D)}}const E=v({getTime:()=>this.audioContext.currentTime,withLoc:!0,scope:M?{...M}:void 0});if(M)try{await E.evaluate(`
              (async function() {
                const core = await import('https://unpkg.com/@strudel/core@1.2.5/dist/index.mjs')
                Object.assign(globalThis, core)
              })()
            `),await new Promise(D=>setTimeout(D,300)),console.log("✅ Core functions also loaded via evaluation")}catch(I){console.warn("Could not load core functions via evaluation:",I)}try{let I=null;try{I=await gs(()=>import("./index-Dx0fBmh0.js"),__vite__mapDeps([4,1])),console.log("✅ Draw module imported from local packages")}catch{I=await gs(()=>import("https://unpkg.com/@strudel/draw@1.2.4/dist/index.mjs"),[]),console.log("✅ Draw module imported from CDN")}if(I){const D="https://unpkg.com/@strudel/draw@1.2.4/dist/index.mjs";await E.evaluate(`
              (async function() {
                // Import the draw module - this automatically adds methods to Pattern.prototype
                await import('${D}')
                // Also export getDrawContext for use in visualizers
                const draw = await import('${D}')
                if (draw.getDrawContext) {
                  const originalGetDrawContext = draw.getDrawContext;
                  // Patch getDrawContext to use our canvas when available
                  globalThis.getDrawContext = function(id, options) {
                    // If no ID or default ID, try to use our canvas context
                    if ((!id || id === 'test-canvas') && window.__strudelVisualizerCtx) {
                      return window.__strudelVisualizerCtx;
                    }
                    // Otherwise use original function
                    return originalGetDrawContext(id, options);
                  };
                }
              })()
            `),await new Promise(F=>setTimeout(F,300))}}catch(I){console.warn("⚠️ Could not load @strudel/draw functions:",I)}window.strudel={initialized:!0,evaluate:E.evaluate,samples:O},this.strudelLoaded=!0,this.strudelLoading=!1,console.log("Strudel loaded from CDN successfully");return}catch(f){console.warn(`Failed to load from ${m}:`,f.message);continue}throw this.strudelLoading=!1,new Error("Failed to load Strudel from all CDN sources")}async triggerSound(e){let t=null;try{const i=localStorage.getItem(`element-config-${e}`);i&&(t=JSON.parse(i))}catch(i){console.error(`Error loading custom config for ${e}:`,i)}const s=fs.getElementConfig(e);if(!s&&!t){console.warn(`No config found for element: ${e}`);return}const a=t&&typeof t.sampleUrl=="string"&&t.sampleUrl.trim()!==""?t.sampleUrl.trim():s&&s.audioFile&&typeof s.audioFile=="string"&&s.audioFile.trim()!==""?s.audioFile.trim():null;if(a){try{await this.initialize()||console.warn("⚠️ Audio engine not fully initialized; attempting custom sample playback anyway.")}catch(i){console.warn("⚠️ Unable to initialize audio engine for custom sample playback:",i)}this.stopSound(e),console.log(`🔊 Playing custom sample for ${e}`),this.playAudioFile(e,a);return}let r=(t==null?void 0:t.pattern)!==void 0?t.pattern:s==null?void 0:s.pattern;const o=(s==null?void 0:s.type)||"strudel";if(!r||typeof r=="string"&&r.trim()===""){console.log(`[${e}] No pattern assigned - skipping sound trigger`);return}if(this.appInstance&&o==="strudel"){const i=this.appInstance.getPatternWithEffects(e,r);i!==r&&(console.log(`   Applying effects to ${e} for individual playback`),r=i)}console.log(`Triggering sound for ${e} (type: ${o})`),t!=null&&t.sampleUrl&&await this.loadCustomSample(e,t.sampleUrl),o==="synthesized"?await this.playSynthesizedSound(e,r):o==="strudel"?await this.playStrudelPattern(e,r,s==null?void 0:s.samples):o==="audio"&&this.playAudioFile(e,(s==null?void 0:s.audioFile)||(t==null?void 0:t.sampleUrl))}async loadCustomSample(e,t){console.log(`Loading custom sample for ${e} from ${t.substring(0,50)}...`)}pauseSound(e){if(this.masterOnlyPlayback){this.removeElementFromMaster(e).success&&this.masterActive&&this.playMasterPattern().catch(a=>console.warn("⚠️ Failed to refresh master after pause:",a)),this.activeSounds.delete(e);return}const t=this.strudelPatternSlots.get(e);if(t&&window.strudel&&window.strudel.evaluate)try{const s=typeof globalThis.silence=="object"?`${t} = globalThis.silence`:`${t} = silence`;window.strudel.evaluate(s),console.log(`⏸️ Paused ${e} (set ${t} to silence)`)}catch(s){console.error(`Error pausing sound for ${e}:`,s)}this.activeSounds.delete(e)}stopSound(e){if(this.masterOnlyPlayback){this.removeElementFromMaster(e).success&&this.masterActive&&this.playMasterPattern().catch(r=>console.warn("⚠️ Failed to refresh master after stop:",r)),this.activeSounds.delete(e);return}const t=this.activeSounds.get(e),s=typeof e=="string"&&e.toLowerCase().includes("preview");if(window.strudel&&window.strudel.evaluate)try{const a=this.getPatternSlot(e),r=typeof globalThis.silence=="object"?`${a} = globalThis.silence`:`${a} = silence`;window.strudel.evaluate(r).catch(o=>{console.log(`Cleared pattern slot ${a} for ${e}`)})}catch{}if(t){if(t.type==="synthesized"&&t.oscillator)t.oscillator.stop&&t.oscillator.stop();else if(t.type==="strudel"&&t.stop)t.stop(),this.activeSounds.delete(e);else if(t.type==="audio"&&t.source){const a=t.gain,r=this.audioContext.currentTime;a.gain.cancelScheduledValues(r),a.gain.setValueAtTime(a.gain.value,r),a.gain.linearRampToValueAtTime(0,r+fs.defaults.fadeOutTime),setTimeout(()=>{t.source.stop(),this.activeSounds.delete(e)},fs.defaults.fadeOutTime*1e3+50);return}else if(t.type==="sustaining"){this.stopSustainingTone(e);return}this.activeSounds.delete(e)}if(s){const a=this.strudelPatternSlots.get(e);a&&(this.patternSlotToElementId.delete(a),this.strudelPatternSlots.delete(e),console.log(`🧹 Cleared preview slot mapping (${a}) for ${e}`)),this.disposeElementAudioNodes(e),console.log(`🧹 Disposed preview audio nodes for ${e}`)}}async stopAllSounds(){var a;if(this._stoppingAllSounds)return;this._stoppingAllSounds=!0,console.log("🛑🛑🛑 EMERGENCY STOP - Killing all audio 🛑🛑🛑");const e=((a=this.audioContext)==null?void 0:a.currentTime)||0;this.masterGainNode?(this.masterGainNode.gain.setValueAtTime(0,e),console.log("✓ Master gain set to 0 (immediate)"),setTimeout(()=>{var r;this.masterGainNode&&!this.masterMuted&&(this.masterGainNode.gain.setValueAtTime(this.masterVolume,((r=this.audioContext)==null?void 0:r.currentTime)||0),console.log(`✓ Master gain restored to ${(this.masterVolume*100).toFixed(0)}%`))},100)):this.gainNode&&(this.gainNode.gain.setValueAtTime(0,e),console.log("✓ Gain set to 0 (immediate)"),setTimeout(()=>{var r;this.gainNode&&(this.gainNode.gain.setValueAtTime(this.volume,((r=this.audioContext)==null?void 0:r.currentTime)||0),console.log(`✓ Gain restored to ${(this.volume*100).toFixed(0)}%`))},100));let t=!1;if(window.strudel&&window.strudel.repl&&window.strudel.repl.scheduler)try{const r=window.strudel.repl.scheduler;typeof r.stop=="function"&&(r.stop(),t=!0,console.log("✓ Stopped REPL scheduler (immediate)"))}catch{}if(window.strudel&&window.strudel.evaluate){console.log("🔇 Silencing all Strudel pattern slots (d1-d16)...");const r=[];for(let o=0;o<=16;o++){const i=`d${o}`;try{r.push(window.strudel.evaluate(`${i} = silence`).catch(()=>{}))}catch{}}try{await Promise.all(r),console.log("✅ All pattern slots silenced")}catch{}}const s=Array.from(this.activeSounds.keys());console.log(`🔇 Stopping ${s.length} tracked sounds`);for(const r of s)try{this.stopSound(r),console.log(`✓ Stopped ${r}`)}catch{console.log(`Could not stop ${r}`)}this.activeSounds.clear(),this.oscillators.forEach((r,o)=>{try{r.stop&&r.stop(),r.disconnect&&r.disconnect(),console.log(`✓ Disconnected oscillator ${o}`)}catch{}}),this.oscillators.clear(),this.masterActive=!1,this.currentEvaluatingSlot=null,this.masterPattern="",this.trackedPatterns&&this.trackedPatterns.clear&&this.trackedPatterns.clear(),console.log("✅✅✅ EMERGENCY STOP COMPLETE ✅✅✅ (audio context left running, master muted)"),this._stoppingAllSounds=!1}async setTempo(e){this.currentTempo=e,this.masterPlaybackTempo=e,this.tempoUserAdjusted=!0;const t=Number.isFinite(e)&&e>0?e/120:1;if(this.masterActive&&this.masterPlaybackStartTime!=null){const s=this.audioContext,a=s?s.currentTime:performance.now()/1e3,r=this.masterPlaybackSpeed||1,o=Math.max(0,a-this.masterPlaybackStartTime),i=r>0?o*r%1:0;this.masterPlaybackSpeed=t>0?t:1,this.masterPlaybackStartTime=a-i/this.masterPlaybackSpeed}else this.masterPlaybackSpeed=t>0?t:1;if(!window.strudel||!window.strudel.evaluate){console.warn("⚠️ Strudel not loaded yet - cannot set tempo");return}console.log(`🎚️ Tempo set to ${e} BPM (using .cpm() on patterns)`),await this.updateAllPatternsWithNewTempo(),this.trackedPatterns.size>0&&(console.log("🔄 Updating master with new tempo"),this.updateMasterPattern())}async ensureStrudelWorkletsReady(e,t=!1){try{if(!window.strudel||!window.strudel.repl||!window.strudel.repl.scheduler)return;const a=window.strudel.repl.scheduler.superdough;if(!a||!(t||typeof e=="string"&&/\b(supersaw|pulse)\b/i.test(e))||this._workletsLoaded)return;typeof a.loadWorklets=="function"&&(console.log("⏳ Loading Strudel AudioWorklets..."),await a.loadWorklets(),this._workletsLoaded=!0,console.log("✅ Strudel AudioWorklets loaded"))}catch(s){console.warn("⚠️ Could not load Strudel AudioWorklets:",(s==null?void 0:s.message)||s)}}setKey(e){this.currentKey=e||"",this._cachedScaleContext=null,this._cachedScaleKey="",this.currentKey?console.log(`🎹 Key set to ${e}`):console.log("🎹 Key cleared (no key selected)"),this.updateAllPatternsWithNewScale()}updateAllPatternsWithNewScale(){this.trackedPatterns.size>0&&(console.log("🔄 Updating master with new key/scale"),this.updateMasterPattern());for(const[e,t]of this.trackedPatterns.entries()){if(!t)continue;const s=t.pattern||t.rawPattern;if(!s)continue;const a=this.convertPatternForScale(s);t.pattern=a||s}for(const[e,t]of this.activeSounds.entries()){if(t.type!=="strudel")continue;const s=this.loadElementConfig?this.loadElementConfig(e):null,a=(s==null?void 0:s.pattern)||t.originalPattern||"";if(!a)continue;const o=this.convertPatternForScale(a)||a;this.updatePatternInPlace(e,o).catch(()=>{})}}setScale(e){this.currentScale=(e||"").trim()||"chromatic",this._cachedScaleContext=null,this._cachedScaleKey="",this.currentScale?console.log(`🎼 Scale set to ${this.currentScale}`):console.log("🎼 Scale cleared (no scale selected)"),this.updateAllPatternsWithNewScale()}setTimeSignature(e){this.currentTimeSignature=e,console.log(`🎵 Time signature set to ${e}`);const[t,s]=e.split("/").map(Number);this.currentBeats=t,this.currentNoteValue=s,console.log(`   ${t} beats per measure, ${s} note gets the beat`),this.trackedPatterns.size>0&&(console.log("🔄 Updating master with new time signature"),this.updateMasterPattern())}extractChannelNumber(e,t=0){if(!e||typeof e!="string")return t+1;const s=e.match(/(\d+)$/);if(s&&s[1]){const a=parseInt(s[1],10);if(Number.isFinite(a)&&a>0)return a}return t+1}formatNumberForPattern(e,t=6){return!Number.isFinite(e)||e===0?"0":e.toFixed(t).replace(/(\.\d*?[1-9])0+$/,"$1").replace(/\.0+$/,"").replace(/^-0$/,"0")}getScaleConversionContext(){return null}convertPatternForScale(e){if(!e||typeof e!="string")return e;const t=this.patternHasNoteNames(e),s=this.patternHasNumericNotePattern(e);return t&&!s?(console.log("📝 convertPatternForScale: Pattern uses note names, preserving format"),e):k9(e)}convertNoteNamesToSemitones(e){return!e||typeof e!="string"?e:k9(e)}convertNoteNamesToScaleDegrees(e,t,s){if(!e||typeof e!="string")return e;const a=t&&t.trim()||"C",r=s&&s.trim()||"chromatic",o=this.getScaleSemitoneSteps(a,r);if(!o||!o.length)return e;const l=`${a.replace(/\s+/g,"").toUpperCase()}`.match(/^([A-G])([#B]?)/i);if(!l)return e;const c=`${l[1].toUpperCase()}${l[2]||""}`,u=hr.get(`${c}4`),h=Number.isFinite(u.midi)?u.midi:60,m=O=>{const k=/(\s+|[,;:<>()[\]{}|\\/]+|\*+)/g,M=[];let E=0,I;for(;(I=k.exec(O))!==null;)I.index>E&&M.push({type:"note",value:O.substring(E,I.index)}),M.push({type:"separator",value:I[0]}),E=I.index+I[0].length;E<O.length&&M.push({type:"note",value:O.substring(E)});let D=!1;for(let F=0;F<M.length;F++){const _=M[F];if(_.type==="separator")continue;const $=_.value.trim();if(!$)continue;const Z=$.match(/^([a-gA-G])([#b]?)(-?\d+)?(@[\d.]+)?$/);if(!Z)continue;const ce=Z[1].toUpperCase(),U=Z[2]||"",ue=Z[3]?parseInt(Z[3],10):null,W=Z[4]||"",de=[];ue!==null&&!Number.isNaN(ue)&&de.push(ue);const be=u.oct||4;de.push(be,be-1,be+1,3,4,5);let ke=null;for(const je of de){const me=hr.get(`${ce}${U}${je}`);if(me&&Number.isFinite(me.midi)){ke=me.midi;break}}if(ke===null)return null;const Ce=ke-h,Ae=(Ce%12+12)%12,q=o.indexOf(Ae);if(q===-1)return null;const Re=Math.floor((Ce-o[q])/12)*o.length+q;M[F]={type:"note",value:`${Re}${W}`},D=!0}return D?M.map(F=>F.value).join(""):null},f=/\bnote\s*\(\s*(["'])([\s\S]*?)\1\s*\)/gi;return e.replace(f,(O,k,M)=>{const E=m(M);return E===null?O:`n(${k}${E}${k})`})}getScaleSemitoneSteps(e,t){const s=e&&typeof e=="string"?e.trim():"",a=t&&typeof t=="string"?t.trim():"",r=Rx[a]||a||"chromatic";let o="C";if(s){const u=s.match(/^([a-gA-G])([#b]?)/);u?o=`${u[1].toUpperCase()}${u[2]||""}`:o=s}const i=ji.get(`${o} ${r}`);if(!i||!Array.isArray(i.intervals)||i.intervals.length===0)return null;const l=i.intervals.map(u=>{const h=Ou.semitones(u);return Number.isFinite(h)?h:null}).filter(u=>u!==null);if(!l.length)return null;const c=Array.from(new Set(l)).sort((u,h)=>u-h);return c[0]!==0&&c.unshift(0),c}patternHasNoteNames(e){if(!e||typeof e!="string")return!1;const t=/\b(note|n)\s*\(\s*["']([^"']+)["']/gi;let s;for(;(s=t.exec(e))!==null;){const a=s[2];if(/[a-gA-G][#b]?\d/.test(a)||/[a-gA-G][#b]?\s/.test(a))return!0}return!1}patternHasNumericNotePattern(e){if(!e||typeof e!="string")return!1;const t=/\b(note|n)\s*\(\s*["']([^"']+)["']/gi;let s,a=!1;for(;(s=t.exec(e))!==null;){a=!0;let r=s[2].replace(/[<>\[\]\{\}\|,]/g," ").trim();if(r&&(/[a-gA-G]/.test(r)||!/^[\d\s~\-\/]+$/.test(r)))return!1}return a}_ensureMasterPatternSanitized(){if(!this.masterPattern||typeof this.masterPattern!="string")return"";const e=this._sanitizePatternExpression(this.masterPattern);return e!==this.masterPattern&&(console.log("🧼 Sanitized master pattern before evaluation"),this.masterPattern=e),this.masterPattern}_repairBrokenSampleStrings(e){if(!e||typeof e!="string")return e;const t=/samples\s*\(\s*\{([\s\S]*?)\}\s*,\s*\{([\s\S]*?)\}\s*\)/g;return e.replace(t,(s,a,r)=>{var f,v;const o=/"([^"]+)"\s*:\s*"([\s\S]*?)"/g,i=[];let l;for(;(l=o.exec(a))!==null;){const O=(f=l[1])==null?void 0:f.trim(),k=(v=l[2])==null?void 0:v.replace(/[\r\n]+/g,"").trim();!O||!k||i.push([O,k])}if(!i.length)return s;const c=r.match(/baseUrl\s*:\s*"([\s\S]*?)"/),u=c?c[1].replace(/[\r\n]+/g,"").trim():"./";return`samples({
${i.map(([O,k])=>`  "${O}": "${k}"`).join(`,
`)}
}, { baseUrl: "${u||"./"}" })`})}_findMatchingParenIndex(e,t){let s=0,a=!1,r=!1,o=!1,i=!1,l=!1,c=!1;for(let u=t;u<e.length;u+=1){const h=e[u],m=e[u+1];if(c){c=!1;continue}if(l){h===`
`&&(l=!1);continue}if(i){h==="*"&&m==="/"&&(i=!1,u+=1);continue}if(h==="\\"){c=!0;continue}if(a){h==="'"&&(a=!1);continue}if(r){h==='"'&&(r=!1);continue}if(o){h==="`"&&(o=!1);continue}if(h==="'"&&!r&&!o){a=!0;continue}if(h==='"'&&!a&&!o){r=!0;continue}if(h==="`"&&!a&&!r){o=!0;continue}if(h==="/"&&m==="*"){i=!0,u+=1;continue}if(h==="/"&&m==="/"){l=!0,u+=1;continue}if(h==="("){s+=1;continue}if(h===")"){if(s-=1,s===0)return u;if(s<0)return-1}}return-1}_repairLeadingSampleStatements(e){if(!e||typeof e!="string")return e;const t=e.trimStart();if(t.startsWith("(() =>")||t.startsWith("(()=>"))return e;const s=e.slice(0,e.length-t.length),a=t.match(/^(?:\/\*[\s\S]*?\*\/\s*|\/\/[^\n]*\n\s*)+/),r=a?a[0]:"";let o=t.slice(r.length).trimStart();if(!o.startsWith("samples"))return e;const i=[];let l=0;for(;o.startsWith("samples",l);){const f=l,v=o.indexOf("(",f);if(v===-1)break;const O=this._findMatchingParenIndex(o,v);if(O===-1)break;const k=o.slice(f,O+1).trim();for(i.push(k),l=O+1;l<o.length&&/\s/.test(o[l]);)l+=1}if(!i.length)return e;const c=o.slice(l).trim();if(!c)return e;const u=i.map(f=>`  ${f};`).join(`
`),h=c.split(`
`).map(f=>`    ${f}`).join(`
`),m=`(() => {
${u}
  return (
${h}
  );
})()`;return`${s}${r}${m}`}_repairStringPatternOperators(e){if(!e||typeof e!="string")return e;let t="",s=0;const a=e.length,r=o=>o?/[,\(\{\[=:+\-*\/!&|?;%]/.test(o):!0;for(;s<a;){const o=e[s];if(o==='"'||o==="'"){const i=o;let l=s+1,c=!1;for(;l<a;){const k=e[l];if(!c&&k===i)break;!c&&k==="\\"?c=!0:c=!1,l+=1}if(l>=a){t+=e.slice(s);break}const u=e.slice(s,l+1);let h=s-1;for(;h>=0&&/\s/.test(e[h]);)h-=1;const m=h>=0?e[h]:"";let f=l+1;for(;f<a&&/\s/.test(e[f]);)f+=1;const v=e.startsWith(".div",f),O=r(m);v&&O?t+=`pattern(${u})`:t+=u,s=l+1;continue}t+=o,s+=1}return t}_sanitizePatternExpression(e){if(!e||typeof e!="string")return e;let t=e;return/"[^"\r\n]*[\r\n]+[^"]*"/.test(t)&&(t=this._repairBrokenSampleStrings(t)),t=this._repairLeadingSampleStatements(t),t=this._repairStringPatternOperators(t),t}applyMasterMixModifiers(e,t={}){if(!e||typeof e!="string"||e.trim()==="")return e;const{wrapStack:s=!1}=t;let a=e;if(s){const I=a.match(/stack\s*\(/);if(I){let D=I.index+I[0].length-1,F=1,_=D+1,$=!1,Z=null;for(;_<a.length&&F>0;){const ce=a[_];!$&&(ce==='"'||ce==="'")?($=!0,Z=ce):$&&ce===Z&&a[_-1]!=="\\"&&($=!1,Z=null),$||(ce==="("?F++:ce===")"&&F--),F>0&&_++}F===0&&(a=a.substring(0,_+1).trimEnd())}}else a=a.replace(/\.gain\s*\([^)]*\)/g,""),a=a.replace(/\.pan\s*\([^)]*\)/g,""),a=a.replace(/\.cpm\s*\([^)]*\)/g,""),a=a.replace(/\.\.+/g,".").replace(/\.\s*$/,"").trim();a=a.replace(/\.\.+/g,".").replace(/\.\s*$/,"").trim();let r=e;if(s){const I=e.match(/stack\s*\(/);if(I){let D=I.index+I[0].length-1,F=1,_=D+1,$=!1,Z=null;for(;_<e.length&&F>0;){const ce=e[_];!$&&(ce==='"'||ce==="'")?($=!0,Z=ce):$&&ce===Z&&e[_-1]!=="\\"&&($=!1,Z=null),$||(ce==="("?F++:ce===")"&&F--),F>0&&_++}F===0&&(r=e.substring(_+1))}}const o=[...r.matchAll(/\.gain\s*\(\s*([^)]+)\s*\)/g)];if(o.length>0){const I=o[o.length-1],D=parseFloat(I[1]);Number.isFinite(D)&&(this.masterVolume=D)}const i=[...r.matchAll(/\.pan\s*\(\s*([^)]+)\s*\)/g)];if(i.length>0){const I=i[i.length-1],D=parseFloat(I[1]);Number.isFinite(D)&&(this.masterPan=D)}const l=[];Number.isFinite(this.masterVolume)&&Math.abs(this.masterVolume-1)>1e-6&&l.push(`.gain(${this.formatNumberForPattern(this.masterVolume,4)})`),Number.isFinite(this.masterPan)&&Math.abs(this.masterPan)>1e-6&&l.push(`.pan(${this.formatNumberForPattern(this.masterPan,4)})`);const c=Number.isFinite(this.currentTempo)&&this.currentTempo>0?this.currentTempo:120;if(Math.abs(c-120)>1e-6){const I=c/4;l.push(`.cpm(${this.formatNumberForPattern(I,6)})`)}if(!l.length)return a;e=a;const u=l,h=e.match(/^(\s*\/\/[^\n]*\n)+/);let m="",f=e;h&&(m=h[0],f=e.slice(m.length));const v=f.match(/\s*$/),O=v?v[0]:"",k=f.trim();if(!k)return e;if(s){const I=k.match(/stack\s*\(/);if(I){let F=I.index+I[0].length-1,_=1,$=F+1,Z=!1,ce=null;for(;$<k.length&&_>0;){const U=k[$];!Z&&(U==='"'||U==="'")?(Z=!0,ce=U):Z&&U===ce&&k[$-1]!=="\\"&&(Z=!1,ce=null),Z||(U==="("?_++:U===")"&&_--),_>0&&$++}if(_===0){const U=k.slice(0,$+1);let W=k.slice($+1).trim(),de=W.length,be=0;for(;be<10&&(W=W.replace(/\.(gain|pan|cpm)\s*\([^)]*\)/g,""),W=W.replace(/\.\s*\(\s*(gain|pan|cpm)\s*\([^)]*\)\s*\)/g,""),W=W.replace(/\s*\(\s*(gain|pan|cpm)\s*\([^)]*\)\s*\)/g,""),W=W.replace(/\s*(gain|pan|cpm)\s*\([^)]*\)/g,""),W=W.replace(/\.\.+/g,".").replace(/\.\s*$/,"").replace(/^\s*\./,"").trim(),W.length!==de);)de=W.length,be++;(W.match(/(gain|pan|cpm)\s*\(/)||W.match(/[().]/))&&(W="");const ke=U+(u.length>0?u.join(""):"");return`${m}${ke}${O}`}}const D=k.lastIndexOf(")");if(D!==-1){const F=k.slice(0,D+1);let $=k.slice(D+1).trim(),Z=$.length,ce=0;for(;ce<10&&($=$.replace(/\.(gain|pan|cpm)\s*\([^)]*\)/g,""),$=$.replace(/\.\s*\(\s*(gain|pan|cpm)\s*\([^)]*\)\s*\)/g,""),$=$.replace(/\s*\(\s*(gain|pan|cpm)\s*\([^)]*\)\s*\)/g,""),$=$.replace(/\s*(gain|pan|cpm)\s*\([^)]*\)/g,""),$=$.replace(/\.\.+/g,".").replace(/\.\s*$/,"").replace(/^\s*\./,"").trim(),$.length!==Z);)Z=$.length,ce++;($.match(/(gain|pan|cpm)\s*\(/)||$.match(/[().]/))&&($="");const U=F+(u.length>0?u.join(""):"");return`${m}${U}${O}`}}const M=k.startsWith("(")&&k.endsWith(")"),E=u.length>0?M?`${k}${u.join("")}`:`(${k})${u.join("")}`:k;return`${m}${E}${O}`}applyGlobalSettingsToPattern(e,t=!1,s=!1,a=null,r=null){if(!e||e==="silence")return e;let o=e,i=t;const l=/\b(note|n)\s*\(/.test(o),c=this.patternHasNoteNames(o),u=/\b(note|n)\s*\(\s*["'][a-g][#b]?[a-z0-9]*\s*[a-z]/.test(o)||/\b(note|n)\s*\(\s*["'][^"']*\b(maj|min|m|dim|aug|sus|add|7|9|11|13)\b/i.test(o),h=/\.\s*chord\s*\(/i.test(o),m=/\b(note|n)\s*\(\s*["'][^"']*[a-g][#b]?\s/.test(o),f=c||u||m||h,v=this.patternHasNumericNotePattern(o),O=l&&!f&&!h&&v,k=a!==null?a:this.currentKey&&this.currentKey.trim()!==""?this.currentKey.trim():"",M=r!==null?r:this.currentScale&&this.currentScale.trim()!==""?this.currentScale.trim():"",E=k&&k.trim()!=="",I=M&&M.trim()!==""?M.trim():"";let D="",F="";if(E){const _=k.toLowerCase();_.includes("m")&&!_.includes("major")?(D=_.replace("m","").trim(),F="minor"):(D=_.replace("major","").trim(),F="major"),D||(D=_.trim())}if(O){let _="";if(E){const Z=I||F||"major",ce=Rx[Z]||Z,U=D||k.trim().toLowerCase();_=U?`${U}:${ce}`:ce}else I&&(_=Rx[I]||I);const $=/\.\s*scale\s*\(/i.test(o);if($&&(o=o.replace(/\.\s*scale\s*\((['"])(?:(?=(\\?))\2.)*?\1\)/gi,""),o=o.replace(/\.\s*scale\s*\([^)]*\)/gi,""),o=o.replace(/\.+/g,".").replace(/\.\s*\./g,".").trim(),o=o.replace(/\.+$/,"").trim(),console.log("  🔄 Removed existing scale modifier")),_&&!h){const Z=`.scale('${_}')`,ce=o.search(/\.(s|sound)\s*\(/);if(ce!==-1){const U=o.slice(0,ce),ue=o.slice(ce);o=`${U}${Z}${ue}`}else i?o=`${o}${Z}`:(o=`(${o})${Z}`,i=!0);console.log(`  🎼 Applied scale: ${_}`)}else(E||I)&&console.log(h?"  ⏭️  Skipped scale application (pattern uses .chord() modifier)":$?"  ⏭️  Skipped scale application (pattern already has scale)":"  ⏭️  Skipped scale application (pattern not compatible with key/scale settings)")}else if(f&&(E||I)){let _="note name";h?_="chord modifier (.chord())":u&&(_="chord"),console.log(`  ⏭️  Skipped scale for ${_} pattern (use numeric n() for scale/key changes)`)}else!l&&(E||I)&&console.log(`  ⏭️  Skipped scale for non-note pattern (Key: ${k||"none"}, Scale: ${I||"none"})`);return o}async updateAllPatternsWithNewTempo(){for(const[e,t]of this.activeSounds.entries())if(t.type==="strudel")try{const s=localStorage.getItem(`element-config-${e}`);if(s){const a=JSON.parse(s);a.pattern&&a.pattern.trim()!==""&&await this.updatePatternInPlace(e,a.pattern)}}catch{}}isPlaying(e){return this.activeSounds.has(e)}getAudioContext(){return this.audioContext}isAudioReady(){return this.initialized&&this.audioContext&&(this.audioContext.state==="running"||this.audioContext.state==="suspended")}playSustainingTone(e,t,s,a,r=null){if(!this.initialized||!this.audioContext)return;this.audioContext.state==="suspended"&&(ah(),this.audioContext.resume().catch(m=>{console.error("Failed to resume audio context:",m)}));const o=(t-s)/(a-s),i=160,c=i*Math.pow(1e4/i,o);this.stopSustainingTone(e);const u=this.audioContext.createOscillator(),h=this.audioContext.createGain();if(u.type="sine",u.frequency.value=c,u.connect(h),r){const m=this.getElementAudioNodes(r);m?(h.connect(m.gainNode),h.gain.value=.3):(h.connect(this.gainNode),h.gain.value=this.volume*.3)}else h.connect(this.gainNode),h.gain.value=this.volume*.3;u.start(0),this.activeSounds.set(e,{type:"sustaining",oscillator:u,gain:h,frequency:c})}updateSustainingToneFrequency(e,t,s,a,r=null){if(!this.audioContext)return;this.audioContext.state==="suspended"&&(ah(),this.audioContext.resume().catch(i=>{console.error("Failed to resume audio context:",i)}));const o=this.activeSounds.get(e);if(o&&o.type==="sustaining"&&o.oscillator)try{const i=(t-s)/(a-s),l=160,u=l*Math.pow(1e4/l,i);o.oscillator.frequency.setValueAtTime(u,this.audioContext.currentTime),o.frequency=u}catch(i){console.error("Error updating sustaining tone frequency:",i),this.playSustainingTone(e,t,s,a,r)}else this.playSustainingTone(e,t,s,a,r)}async checkSoundBanksStatus(){if(!window.strudel||!window.strudel.evaluate)return{loaded:!1,error:"Strudel not initialized"};try{return{loaded:(typeof globalThis.s=="function"&&typeof globalThis.sound=="function")===!0}}catch(e){return{loaded:!1,error:e.message}}}async ensureDefaultSoundBanks(){var e;if(!window.strudel||!window.strudel.evaluate){try{this.strudelLoaded||await this.initializeStrudelAndSounds()}catch{}if(!window.strudel||!window.strudel.evaluate)return!1}if(this.strudelSoundBanksLoaded)return!0;if(this.strudelSoundBankLoading){for(;this.strudelSoundBankLoading;)await new Promise(t=>setTimeout(t,100));return this.strudelSoundBanksLoaded}this.strudelSoundBankLoading=!0;try{if(console.log("📦 Loading default Strudel sound banks (dirt-samples)..."),typeof document<"u"){const a=document.getElementById("status-text");a&&(a.textContent="📦 Loading default drum samples...")}const t=((e=window.strudel)==null?void 0:e.samples)||globalThis.samples;if(t&&typeof t=="function")try{console.log("📦 Loading default Strudel samples from dough-samples CDN...");const a=Bx,r={tidalDrums:!1,piano:!1,dirt:!1,vcsl:!1,mridangam:!1};if(await Promise.all([t(`${a}/tidal-drum-machines.json`).then(()=>{console.log("  ✅ Tidal drum machines loaded (TR-808, TR-909, TR-707, RhythmAce, AkaiLinn, etc.)"),r.tidalDrums=!0}).catch(o=>{console.warn("  ⚠️ Could not load tidal-drum-machines from CDN:",o.message),console.log("  📁 Will use local TR-808/TR-909 samples as fallback")}),t(`${a}/piano.json`).then(()=>{console.log("  ✅ Piano samples loaded"),r.piano=!0}).catch(o=>console.warn("  ⚠️ Could not load piano:",o.message)),t(`${a}/Dirt-Samples.json`).then(()=>{console.log("  ✅ Dirt-Samples loaded"),r.dirt=!0}).catch(o=>console.warn("  ⚠️ Could not load Dirt-Samples:",o.message)),t(`${a}/vcsl.json`).then(()=>{console.log("  ✅ VCSL (vocal) samples loaded"),r.vcsl=!0}).catch(o=>console.warn("  ⚠️ Could not load VCSL:",o.message)),t(`${a}/mridangam.json`).then(()=>{console.log("  ✅ Mridangam (percussion) samples loaded"),r.mridangam=!0}).catch(o=>console.warn("  ⚠️ Could not load mridangam:",o.message))]),console.log("✅ Default Strudel samples loaded from dough-samples CDN"),r.tidalDrums)console.log("📝 Note: TR-808 and TR-909 loaded from CDN (local samples available as backup)");else{console.log("📁 Loading local TR-808 and TR-909 samples as fallback...");try{await this.loadBank("RolandTR808"),await this.loadBank("RolandTR909"),console.log("✅ Local TR-808 and TR-909 samples loaded successfully")}catch(o){console.warn("⚠️ Could not load local TR-808/TR-909 samples:",o)}}}catch(a){console.warn("⚠️ Error loading samples from dough-samples:",a),console.log("   Attempting to load local TR-808/TR-909 samples...");try{await this.loadBank("RolandTR808"),await this.loadBank("RolandTR909"),console.log("✅ Local TR-808 and TR-909 samples loaded as fallback")}catch(r){console.warn("⚠️ Could not load local samples either:",r)}}this.strudelSoundBanksLoaded=!0,this.strudelSoundBankLoading=!1,console.log("✅ Default sound banks ready"),console.log("📦 Available: Piano, Dirt-Samples, VCSL, Mridangam, Drum Machines (TR-808, TR-909, TR-707, etc.)"),console.log("🧪 Testing pattern evaluation...");let s=!1;if(typeof globalThis.silence=="object"&&typeof globalThis.sound=="function"&&typeof globalThis.note=="function"){console.log("✅ Pattern functions available in globalThis");try{await window.strudel.evaluate("d16 = silence"),console.log("✅ Pattern assignment test passed"),s=!0}catch(a){console.warn("⚠️ Pattern assignment test failed:",a),await new Promise(r=>setTimeout(r,1e3));try{await window.strudel.evaluate("d16 = silence"),console.log("✅ Pattern assignment test passed on retry"),s=!0}catch(r){console.error("❌ Pattern assignment still failing:",r)}}}else console.error("❌ Pattern functions not available in globalThis"),console.log("  silence:",typeof globalThis.silence,"(should be object)"),console.log("  sound:",typeof globalThis.sound,"(should be function)"),console.log("  note:",typeof globalThis.note,"(should be function)");if(s&&this.onSoundsReadyCallback?(console.log("🔔 Notifying app that sounds are ready..."),this.onSoundsReadyCallback()):s||console.warn("⚠️ Sounds loaded but patterns not ready - dots will stay red"),typeof document<"u"){const a=document.getElementById("status-text");a&&(a.textContent="✅ Samples loaded - Ready!",setTimeout(()=>{a.textContent.includes("Samples loaded")&&(a.textContent="Ready - Click elements to start/stop patterns (Press Escape to stop all)")},2e3))}return!0}catch(t){return this.strudelSoundBankLoading=!1,t.message&&t.message.includes("CycleTones")?(console.log("⚠️ CycleTones not available - patterns will use dirt-samples if loaded"),!1):(console.error("❌ Failed to load default sound banks:",t),console.error("Error details:",t.message,t.stack),console.error("Strudel patterns may not work without default sound banks"),!1)}}async preloadAllCommonDrumSounds(){return console.log("📦 Preloading skipped (silent mode) - no audible patterns will be evaluated"),!0}exposeSampleListHelper(e,t){globalThis.getLoadedSamples=()=>{try{let s=null,a="";const r=(e==null?void 0:e.soundMap)||(t==null?void 0:t.soundMap);if(r&&(s=typeof r.get=="function"?r.get():r,s&&typeof s=="object"&&(a="webaudioModule/webModule.soundMap")),(!s||Object.keys(s).length===0)&&this.strudelRepl){const l=this.strudelRepl;if(l.scheduler){const c=l.scheduler;if(c.soundMap&&(s=typeof c.soundMap.get=="function"?c.soundMap.get():c.soundMap,s&&typeof s=="object"&&(a="repl.scheduler.soundMap")),(!s||Object.keys(s).length===0)&&c.context){const u=c.context;u.soundMap&&(s=typeof u.soundMap.get=="function"?u.soundMap.get():u.soundMap,s&&typeof s=="object"&&(a="repl.scheduler.context.soundMap"))}}}if((!s||Object.keys(s).length===0)&&window.strudel&&window.strudel.repl&&window.strudel.repl.scheduler){const l=window.strudel.repl.scheduler;l.soundMap&&(s=typeof l.soundMap.get=="function"?l.soundMap.get():l.soundMap,s&&typeof s=="object"&&(a="window.strudel.repl.scheduler.soundMap"))}if(!s||Object.keys(s).length===0){const l=(e==null?void 0:e.getSound)||(t==null?void 0:t.getSound);if(l&&typeof l=="function"){console.log("🔍 Attempting to detect samples via getSound function...");const c=["bd","sd","hh","cp","oh","cr","rim","tr808_bd","tr909_bd","RolandTR808_bd","RolandTR909_bd"],u=[];c.forEach(h=>{try{const m=l(h);m&&m!=="triangle"&&u.push(h)}catch{}}),u.length>0&&(console.log(`📊 Found ${u.length} samples via getSound:`,u),a="getSound detection")}}if((!s||Object.keys(s).length===0)&&this.strudelRepl){const l=this.strudelRepl;console.log("🔍 Checking REPL properties for sample registry..."),console.log("   REPL keys:",Object.keys(l).slice(0,20)),l.scheduler&&(console.log("   Scheduler keys:",Object.keys(l.scheduler).slice(0,20)),l.scheduler.context&&console.log("   Scheduler.context keys:",Object.keys(l.scheduler.context).slice(0,20))),l.samples&&typeof l.samples=="object"&&(s=l.samples,a="repl.samples",console.log("✅ Found samples in repl.samples"))}if((!s||Object.keys(s).length===0)&&window.strudel&&window.strudel.evaluate){console.log("🔍 Testing pattern evaluation to detect available samples...");const l=['s("bd")','s("bd").bank("tr808")','s("bd").bank("tr909")','sound("bd")'];for(const c of l)try{const u=window.strudel.evaluate(c);console.log(`   Pattern "${c}" evaluated successfully`)}catch(u){u.message&&(u.message.includes("not found")||u.message.includes("not loaded"))?console.log(`   Pattern "${c}" - sample not found (expected)`):console.log(`   Pattern "${c}" - error:`,u.message)}}if(!s||Object.keys(s).length===0){const l=Object.keys(globalThis).filter(c=>c.toLowerCase().includes("sample")||c.toLowerCase().includes("sound")||c.toLowerCase().includes("bank"));l.length>0&&(console.log("🔍 Found potential sample-related globals:",l),l.forEach(c=>{try{const u=globalThis[c];if(typeof u=="object"&&u!==null&&!Array.isArray(u)){const h=Object.keys(u);h.length>0&&(console.log(`   ${c} has ${h.length} keys:`,h.slice(0,10)),(!s||Object.keys(s).length===0)&&(s=u,a=`globalThis.${c}`))}}catch{}}))}if(!s||typeof s!="object"||Object.keys(s).length===0)return console.log("⚠️ soundMap not found or empty"),console.log("   Tried: webaudioModule, webModule, repl.scheduler, window.strudel"),console.log("   This might mean samples are loaded but not yet registered"),console.log("   Try loading a bank first, then check again"),{total:0,keys:[],byBank:{},source:"none",note:"No samples found. Samples may need to be loaded first."};const o=Object.keys(s);console.log(`📊 Total loaded samples: ${o.length} (from ${a})`),console.log("📋 All loaded sample names:",o);const i={};return o.forEach(l=>{const c=l.split("_");if(c.length>1){const u=c[0],h=c.slice(1).join("_");i[u]||(i[u]=[]),i[u].push(h)}else i.default||(i.default=[]),i.default.push(l)}),Object.keys(i).length>0&&(console.log("📦 Samples grouped by bank:"),Object.entries(i).forEach(([l,c])=>{console.log(`  ${l}: ${c.length} sounds`,c.slice(0,20))})),{total:o.length,keys:o,byBank:i,source:a}}catch(s){return console.error("❌ Error getting loaded samples:",s),console.error("   Stack:",s.stack),null}},console.log("✅ Helper function available: getLoadedSamples()"),console.log("   Call getLoadedSamples() in console to see all loaded samples")}async loadBank(e){var u,h,m,f,v;if(!window.strudel||!window.strudel.evaluate)throw console.warn("Cannot load bank: Strudel not initialized"),new Error("Strudel not initialized");if(!e||typeof e!="string")return console.warn("Cannot load bank: invalid name",e),!1;if(e=e.trim(),!e)return console.warn("Cannot load bank: empty name after trimming"),!1;const t=e.toLowerCase();if(new Set(["sine","square","triangle","sawtooth","supersaw","pulse","saw","saw2","saw3","saw4","saw8"]).has(e.toLowerCase()))return console.log(`⏭️ Skipping built-in oscillator synth "${e}" (no loading needed)`),this.loadedBanks.add(e.toLowerCase()),this.loadedBanks.add(e),!0;const a={RolandTR909:{RolandTR909_bd:Wo(["assets/sounds/Kicks/ESWTR909 Kick 01.wav","assets/sounds/Kicks/ESWTR909 Kick 02.wav","assets/sounds/Kicks/ESWTR909 Kick 03.wav","assets/sounds/Kicks/ESWTR909 Kick 04.wav","assets/sounds/Kicks/ESWTR909 Kick 05.wav","assets/sounds/Kicks/ESWTR909 Kick 06.wav","assets/sounds/Kicks/ESWTR909 Kick 07.wav","assets/sounds/Kicks/ESWTR909 Kick 08.wav","assets/sounds/Kicks/ESWTR909 Kick 09.wav","assets/sounds/Kicks/ESWTR909 Kick 10.wav"]),RolandTR909_sd:Wo(["assets/sounds/Snares/ESWTR909 Snare 01.wav","assets/sounds/Snares/ESWTR909 Snare 02.wav","assets/sounds/Snares/ESWTR909 Snare 03.wav","assets/sounds/Snares/ESWTR909 Snare 04.wav","assets/sounds/Snares/ESWTR909 Snare 05.wav","assets/sounds/Snares/ESWTR909 Snare 06.wav","assets/sounds/Snares/ESWTR909 Snare 07.wav","assets/sounds/Snares/ESWTR909 Snare 08.wav","assets/sounds/Snares/ESWTR909 Snare 09.wav","assets/sounds/Snares/ESWTR909 Snare 10.wav","assets/sounds/Snares/ESWTR909 Snare 11.wav","assets/sounds/Snares/ESWTR909 Snare 12.wav"]),RolandTR909_hh:Wo(["assets/sounds/Hats/ESWTR909 HH Closed 01.wav","assets/sounds/Hats/ESWTR909 HH Closed 02.wav","assets/sounds/Hats/ESWTR909 HH Closed 03.wav","assets/sounds/Hats/ESWTR909 HH Closed 04.wav","assets/sounds/Hats/ESWTR909 HH Closed 05.wav","assets/sounds/Hats/ESWTR909 HH Closed 06.wav","assets/sounds/Hats/ESWTR909 HH Closed 07.wav","assets/sounds/Hats/ESWTR909 HH Closed 08.wav","assets/sounds/Hats/ESWTR909 HH Closed 09.wav","assets/sounds/Hats/ESWTR909 HH Closed 10.wav"]),RolandTR909_oh:Wo(["assets/sounds/Hats/ESWTR909 HH Open 01.wav","assets/sounds/Hats/ESWTR909 HH Open 02.wav","assets/sounds/Hats/ESWTR909 HH Open 03.wav","assets/sounds/Hats/ESWTR909 HH Open 04.wav","assets/sounds/Hats/ESWTR909 HH Open 05.wav","assets/sounds/Hats/ESWTR909 HH Open 06.wav","assets/sounds/Hats/ESWTR909 HH Open 07.wav","assets/sounds/Hats/ESWTR909 HH Open 08.wav"]),RolandTR909_cp:Wo(["assets/sounds/Claps/ESWTR909 Clap 01.wav","assets/sounds/Claps/ESWTR909 Clap 02.wav","assets/sounds/Claps/ESWTR909 Clap 03.wav","assets/sounds/Claps/ESWTR909 Clap 04.wav","assets/sounds/Claps/ESWTR909 Clap 05.wav"]),RolandTR909_cr:Wo(["assets/sounds/Hats/ESWTR909 HH Crash 01.wav","assets/sounds/Hats/ESWTR909 HH Crash 02.wav","assets/sounds/Hats/ESWTR909 HH Crash 03.wav","assets/sounds/Hats/ESWTR909 HH Crash 04.wav","assets/sounds/Hats/ESWTR909 HH Crash 05.wav"]),RolandTR909_lt:Wo(["assets/sounds/Toms/ESWTR909 Tom 01.wav","assets/sounds/Toms/ESWTR909 Tom 02.wav","assets/sounds/Toms/ESWTR909 Tom 03.wav","assets/sounds/Toms/ESWTR909 Tom 04.wav","assets/sounds/Toms/ESWTR909 Tom 05.wav"]),RolandTR909_mt:Wo(["assets/sounds/Toms/ESWTR909 Tom 06.wav","assets/sounds/Toms/ESWTR909 Tom 07.wav","assets/sounds/Toms/ESWTR909 Tom 08.wav","assets/sounds/Toms/ESWTR909 Tom 09.wav","assets/sounds/Toms/ESWTR909 Tom 10.wav"]),RolandTR909_ht:Wo(["assets/sounds/Toms/ESWTR909 Tom 11.wav","assets/sounds/Toms/ESWTR909 Tom 12.wav","assets/sounds/Toms/ESWTR909 Tom 13.wav","assets/sounds/Toms/ESWTR909 Tom 14.wav","assets/sounds/Toms/ESWTR909 Tom 15.wav"])},RolandTR808:{RolandTR808_bd:Wo(["assets/sounds/Kicks/ESW909X Kick 01.wav","assets/sounds/Kicks/ESW909X Kick 02.wav","assets/sounds/Kicks/ESW909X Kick 03.wav","assets/sounds/Kicks/ESW909X Kick 04.wav","assets/sounds/Kicks/ESW909X Kick 05.wav"]),RolandTR808_sd:Wo(["assets/sounds/Snares/ESW909X Snare 01.wav","assets/sounds/Snares/ESW909X Snare 02.wav","assets/sounds/Snares/ESW909X Snare 03.wav","assets/sounds/Snares/ESW909X Snare 04.wav","assets/sounds/Snares/ESW909X Snare 05.wav"]),RolandTR808_cp:Wo(["assets/sounds/Claps/ESW909X Clap 01.wav","assets/sounds/Claps/ESW909X Clap 02.wav","assets/sounds/Claps/ESW909X Clap 03.wav","assets/sounds/Claps/ESW909X Clap 04.wav","assets/sounds/Claps/ESW909X Clap 05.wav"])}},r=["RolandTR707","RhythmAce","AkaiLinn","ViscoSpaceDrum","CasioRZ1"],o=["piano","superpiano","jazz","supersaw","folkharp","casio","insect","wind","wood","metal","east","crow","space","numbers","sawtooth","sine","square","triangle","saw","saw2","saw3","saw4","saw8","gtr"],i={mridangam:`${Bx}/mridangam.json`,vcsl:`${Bx}/vcsl.json`};if(i[t]){const O=((u=window.strudel)==null?void 0:u.samples)||globalThis.samples;if(!O||typeof O!="function")return console.warn(`⚠️ samples() function not available for specialty bank "${t}"`),!1;try{console.log(`📦 Loading specialty sample bank "${t}" from dough-samples`);let k=this.specialtyManifests.get(t);if(!k){const I=await fetch(i[t]);if(!I.ok)throw new Error(`HTTP ${I.status}`);const D=await I.json();k=kbe(D),this.specialtyManifests.set(t,k)}const M={...k},E=Object.keys(k||{});return E.forEach(I=>{const D=`${t}_${I}`;M[D]||(M[D]=k[I])}),await O(M),E.forEach(I=>{const D=I.toLowerCase();this.sampleNameToSpecialtyBank.set(D,t),this.sampleNameToSpecialtyBank.set(`${t}_${D}`,t),this.loadedBanks.add(D),this.loadedBanks.add(I),this.loadedBanks.add(`${t}_${D}`),this.loadedBanks.add(`${t}_${I}`)}),this.loadedBanks.add(t),this.loadedBanks.add(e),console.log(`✅ Specialty bank "${t}" loaded`),!0}catch(k){return console.warn(`⚠️ Failed to load specialty bank "${t}":`,k.message||k),!1}}if(a[e]){console.log(`📦 Loading local custom bank "${e}" from assets folder...`);const O=((h=window.strudel)==null?void 0:h.samples)||globalThis.samples;if(O&&typeof O=="function")try{const k={...a[e]},M=`${e}_`.toLowerCase();return Object.entries(a[e]).forEach(([E,I])=>{if(k[E]=I,E.toLowerCase().startsWith(M)){const D=E.slice(M.length);D&&!k[D]&&(k[D]=I)}}),await O(k),Object.keys(k).forEach(E=>this.loadedBanks.add(E)),this.loadedBanks.add(e),console.log(`✅ Local custom bank "${e}" loaded successfully from assets`),!0}catch(k){return console.error(`❌ Failed to load local bank "${e}":`,k),!1}else return console.error("❌ samples() function not available"),!1}if(r.includes(e)){console.log(`📦 Ensuring built-in drum bank "${e}" samples are loaded...`);try{const k=`d15 = s("bd sd hh cp oh cr rd ht mt lt sh cb tb pe").bank("${e}")`;if(await window.strudel.evaluate(k),window.strudel.scheduler&&typeof window.strudel.scheduler.tick=="function")for(let M=0;M<4;M++)window.strudel.scheduler.tick(),await new Promise(E=>setTimeout(E,50));else await new Promise(M=>setTimeout(M,200));return await window.strudel.evaluate("d15 = silence"),this.loadedBanks.add(e),console.log(`✅ Built-in drum bank "${e}" ready`),!0}catch(O){return console.warn(`⚠️ Could not preload built-in bank "${e}":`,O),this.loadedBanks.add(e),!0}}let l=t;if(tf[t]&&(l=tf[t],console.log(`🔄 Normalizing bank name "${e}" to "${l}"`)),o.includes(l)){const O=((m=window.strudel)==null?void 0:m.samples)||globalThis.samples;if(O&&typeof O=="function")try{return console.log(`📦 Loading sample bank "${l}" via samples()`),await O(l),this.loadedBanks.add(l),this.loadedBanks.add(t),console.log(`✅ Sample bank "${l}" loaded`),!0}catch(k){return console.warn(`⚠️ Failed to load sample bank "${l}":`,k.message||k),this.loadedBanks.add(l),this.loadedBanks.add(t),!1}else return console.warn(`⚠️ samples() function not available for loading "${l}"`),!1}if(e.startsWith("github:")){const O=((f=window.strudel)==null?void 0:f.samples)||globalThis.samples;if(!O||typeof O!="function")throw console.error("samples function not available!"),new Error("samples function not available");console.log(`📦 Loading bank via samples(): ${e}`);try{const k=await O(e);return console.log("samples() call completed, result:",k),console.log("⏳ Waiting for samples to load..."),await new Promise(M=>setTimeout(M,2e3)),console.log(`✅ Bank loaded: ${e}`),!0}catch(k){throw console.error(`❌ Failed to load bank ${e}:`,k),k}}else{console.log(`📦 Bank "${e}" is a predefined bank name`);const O=((v=window.strudel)==null?void 0:v.samples)||globalThis.samples;if(!O||typeof O!="function")return console.warn(`⚠️ samples function not available for loading bank "${e}"`),console.log(`   Bank "${e}" may need to be loaded manually`),!1;const k=[e];let M=!1;const E=console.error;console.error=(...D)=>{let F="";for(let Z=0;Z<D.length;Z++)typeof D[Z]=="string"?F+=" "+D[Z]:D[Z]&&D[Z].toString&&(F+=" "+String(D[Z]));const _=String(D[0]||""),$=F.toLowerCase();_.includes("JSON")||_.includes("SyntaxError")||_.includes("not found")||_.includes("RolandTR")||_.includes("404")||_.includes("Failed")||_.includes("<!DOCTYPE")||_.includes("Unexpected token")||_.includes("is not valid JSON")||_.includes("Unexpected non-whitespace")||F.includes("JSON")||F.includes("SyntaxError")||F.includes("not found")||F.includes("RolandTR")||F.includes("404")||F.includes("<!DOCTYPE")||F.includes("Unexpected token")||F.includes("is not valid JSON")||$.includes("json")||$.includes("syntaxerror")||$.includes("rolandtr")||E.apply(console,D)};try{for(const D of k)try{console.log(`   Trying to load from: ${D}`);const F=await O(D);console.log(`   ✅ Successfully called samples() with: ${D}`),M=!0;break}catch{console.log(`   ✗ Path "${D}" not available`);continue}}finally{console.error=E}return M?(console.log("⏳ Waiting for samples to load..."),await new Promise(D=>setTimeout(D,3e3)),console.log(`✅ Bank "${e}" loading initiated`),this.loadedBanks.add(e)):(console.log(`⚠️ Could not load "${e}" from any known path`),console.log(`   Bank "${e}" may be embedded in Strudel or unavailable`),console.log(`   To use this bank in patterns (if available), use: .bank("${e}")`),console.log(`   Example: sound("bd hh").bank("${e}")`)),M}}async initializeMIDI(){try{if(await gt.enable(),this.midiEnabled=!0,console.log("✅ WebMidi enabled"),gt.outputs.forEach(e=>{this.midiOutputs.set(e.name,e),console.log(`🎹 MIDI Output available: ${e.name}`)}),this.midiOutputs.size>0){const e=Array.from(this.midiOutputs.values())[0];this.selectedMidiOutput=e,console.log(`✅ Auto-selected MIDI output: ${e.name}`)}gt.addListener("connected",e=>{e.port.type==="output"&&(this.midiOutputs.set(e.port.name,e.port),console.log(`🎹 MIDI Output connected: ${e.port.name}`),this.selectedMidiOutput||(this.selectedMidiOutput=e.port,console.log(`✅ Auto-selected MIDI output: ${e.port.name}`)))}),gt.addListener("disconnected",e=>{e.port.type==="output"&&(this.midiOutputs.delete(e.port.name),console.log(`🎹 MIDI Output disconnected: ${e.port.name}`),this.selectedMidiOutput===e.port&&(this.selectedMidiOutput=null,this.midiOutputs.size>0&&(this.selectedMidiOutput=Array.from(this.midiOutputs.values())[0],console.log(`✅ Auto-selected new MIDI output: ${this.selectedMidiOutput.name}`))))}),this.setupStrudelMIDIOutput(),this.ensurePatternMidiMethodsRegistered("initializeMIDI")}catch(e){console.warn("⚠️ WebMidi initialization failed:",e),this.midiEnabled=!1}}setupStrudelMIDIOutput(){var e,t;if(!(!this.midiEnabled||!window.strudel))try{const s=(e=window.strudel)==null?void 0:e.scheduler,a=(s==null?void 0:s.webaudio)||((t=window.strudel)==null?void 0:t.webaudio);if(a)if(a.midiOutput){const r=a.midiOutput;a.midiOutput=o=>{this.sendMIDIMessage(o),r&&typeof r=="function"&&r(o)},console.log("✅ Connected Strudel webaudio.midiOutput to WebMidi")}else a.midiOutput=r=>{this.sendMIDIMessage(r)},console.log("✅ Created Strudel webaudio.midiOutput handler"),console.log("ℹ️ MIDI modifiers (.midi(), .midiport()) should now be available on patterns");if(window.strudel.midiOutput){const r=window.strudel.midiOutput;window.strudel.midiOutput=o=>{this.sendMIDIMessage(o),r&&typeof r=="function"&&r(o)}}else window.strudel.midiOutput=r=>{this.sendMIDIMessage(r)};setTimeout(()=>{this.selectIACDriver()},500),this.ensurePatternMidiMethodsRegistered("setupStrudelMIDIOutput"),console.log("✅ Strudel MIDI output handler set up")}catch(s){console.warn("⚠️ Failed to set up Strudel MIDI output:",s)}}selectIACDriver(){const e=["IAC Driver Bus 1","IAC Driver Bus 2","IAC Driver","IAC Bus 1","IAC Bus 2","loopMIDI","Virtual MIDI"];for(const t of e)for(const[s,a]of this.midiOutputs.entries())if(s===t||t.toLowerCase().includes("iac")&&s.toLowerCase().includes("iac")){this.selectMIDIOutput(s),console.log(`✅ Auto-selected IAC Driver: ${s}`);return}this.midiOutputs.size>0?(console.log("ℹ️ IAC Driver not found. Available MIDI outputs:",Array.from(this.midiOutputs.keys()).join(", ")),console.log('ℹ️ You can manually select a MIDI output using: soundManager.selectMIDIOutput("port name")')):console.log("ℹ️ No MIDI outputs available. Make sure IAC Driver is enabled in Audio MIDI Setup on macOS.")}sendMIDIMessageToPort(e,t=null){if(!this.midiEnabled)return;let s=null;if(t&&this.midiOutputs&&this.midiOutputs.has(t)?s=this.midiOutputs.get(t):this.selectedMidiOutput&&(s=this.selectedMidiOutput),!s){this._midiFallbackLogged||(console.log("ℹ️ MIDI message received but no hardware output is configured yet. Message will be ignored until a MIDI port is selected."),this._midiFallbackLogged=!0);return}this._midiFallbackLogged=!1;const a=this.selectedMidiOutput;this.selectedMidiOutput=s;try{this.sendMIDIMessage(e)}finally{this.selectedMidiOutput=a}}sendMIDIMessage(e){if(!this.midiEnabled||!this.selectedMidiOutput){this._midiFallbackLogged||(console.log("ℹ️ MIDI message received but no hardware output is configured yet. Message will be ignored until a MIDI port is selected."),this._midiFallbackLogged=!0);return}this._midiFallbackLogged=!1;try{let t=this.midiChannel,s=null,a=127,r=null;switch(e.channel!==void 0?t=e.channel:e.port!==void 0&&(t=e.port),e.note!==void 0?s=e.note:e.number!==void 0&&(s=e.number),e.velocity!==void 0?a=e.velocity:e.value!==void 0&&e.type==="noteon"&&(a=e.value),e.type?r=e.type.toLowerCase():s!==null&&(r="noteon"),t=Math.max(0,Math.min(15,t)),r){case"noteon":case"noteon":if(s!==null){const o=Math.max(0,Math.min(1,a/127));this.selectedMidiOutput.playNote(s,{channel:t+1,attack:o});const i=`${s}:${t}`;this.activeMidiNotes.add(i)}break;case"noteoff":case"noteoff":if(s!==null){this.selectedMidiOutput.stopNote(s,{channel:t+1});const o=`${s}:${t}`;this.activeMidiNotes.delete(o)}break;case"cc":case"controlchange":e.controller!==void 0&&e.value!==void 0&&this.selectedMidiOutput.sendControlChange(e.controller,e.value,{channel:t+1});break;case"programchange":e.program!==void 0&&this.selectedMidiOutput.sendProgramChange(e.program,{channel:t+1});break;case"pitchbend":e.value!==void 0&&this.selectedMidiOutput.sendPitchBend(e.value,{channel:t+1});break;default:if(e.data&&Array.isArray(e.data))this.selectedMidiOutput.send(e.data);else if(s!==null){const o=Math.max(0,Math.min(1,a/127));this.selectedMidiOutput.playNote(s,{channel:t+1,attack:o});const i=`${s}:${t}`;this.activeMidiNotes.add(i)}}}catch(t){console.warn("⚠️ Failed to send MIDI message:",t,e)}}ensurePatternMidiMethodsRegistered(e="unspecified"){try{const t=this._gatherPatternConstructors();let s=0;t.forEach(a=>{this._installMidiMethodsOnPatternCtor(a,e)&&(s+=1)}),s>0&&console.log(`✅ Registered MIDI methods on ${s} Pattern constructor(s) (${e})`)}catch(t){console.warn("⚠️ Failed to ensure MIDI methods on Pattern prototypes:",t)}}_gatherPatternConstructors(){var r,o;const e=new Set,t=i=>{i&&typeof i=="function"&&i.prototype&&e.add(i)};t(globalThis.Pattern),t((r=window==null?void 0:window.strudel)==null?void 0:r.Pattern);const s=globalThis.silence;s&&s.constructor&&t(s.constructor);const a=globalThis.note||((o=window==null?void 0:window.strudel)==null?void 0:o.note);if(typeof a=="function")try{const i=a("c");i&&i.constructor&&t(i.constructor)}catch{}return Array.isArray(this._knownPatternConstructors)&&this._knownPatternConstructors.forEach(t),this._knownPatternConstructors=Array.from(e),e}_installMidiMethodsOnPatternCtor(e,t){if(!e||!e.prototype)return!1;const s=e.prototype;let a=!1;if((typeof s.midi!="function"||!s.midi.__soundManagerInjected)&&(s.midi=this._getPatternMidiMethod(),s.midi.__soundManagerInjected=!0,a=!0),(typeof s.midiport!="function"||!s.midiport.__soundManagerInjected)&&(s.midiport=this._getPatternMidiportMethod(),s.midiport.__soundManagerInjected=!0,a=!0),a){const r=e.name||"AnonymousPattern";console.log(`🎛️ MIDI methods installed on Pattern prototype (${r}, reason: ${t})`)}return a}_getPatternMidiMethod(){if(this._patternMidiMethod)return this._patternMidiMethod;const e=this;return this._patternMidiMethod=function(s){return this.fmap((a,r={})=>{var i;const o=s??((i=r==null?void 0:r.context)==null?void 0:i.midiport)??null;return e._processPatternValueForMIDI(a,r==null?void 0:r.time,o),a})},this._patternMidiMethod}_getPatternMidiportMethod(){return this._patternMidiportMethod?this._patternMidiportMethod:(this._patternMidiportMethod=function(t){return this.fmap(s=>(s&&typeof s=="object"&&(s.midiport=t),s))},this._patternMidiportMethod)}_processPatternValueForMIDI(e,t,s){const a=this._convertValueToMidiMessage(e,t);if(!a){Math.random()<.1&&console.log("🔍 MIDI: Could not convert value to MIDI message:",{value:e,valueType:typeof e,isObject:typeof e=="object"&&e!==null,keys:typeof e=="object"&&e!==null?Object.keys(e).slice(0,10):[],hasNote:e==null?void 0:e.note,hasNumber:e==null?void 0:e.number,hasMidi:e==null?void 0:e.midi});return}const r=this._getMidiOutputForPattern(s);if(r)try{r(a),Math.random()<.05&&console.log("🎹 MIDI sent:",{note:a.note,velocity:a.velocity,channel:a.channel,port:s||"default"})}catch(o){console.warn("⚠️ MIDI send error:",o,a)}else this._midiOutputMissingWarned||(this._midiOutputMissingWarned=!0,console.warn("⚠️ MIDI output handler not available. Select a MIDI output or enable WebMidi."))}_getMidiOutputForPattern(e){var a,r;const t=(a=window.strudel)==null?void 0:a.scheduler,s=(t==null?void 0:t.webaudio)||((r=window.strudel)==null?void 0:r.webaudio);if(s&&typeof s.midiOutput=="function")return o=>{try{s.midiOutput(o)}catch(i){console.warn("⚠️ webaudio.midiOutput error:",i)}};if(this.midiEnabled&&typeof this.sendMIDIMessageToPort=="function"){if(e&&this.midiOutputs&&this.midiOutputs.has(e))return o=>{try{this.sendMIDIMessageToPort(o,e)}catch(i){console.warn("⚠️ sendMIDIMessageToPort error:",i)}};if(this.selectedMidiOutput)return o=>{try{this.sendMIDIMessageToPort(o,null)}catch(i){console.warn("⚠️ sendMIDIMessageToPort error:",i)}}}return this.midiEnabled&&typeof this.sendMIDIMessage=="function"&&this.selectedMidiOutput?o=>{try{this.sendMIDIMessage(o)}catch(i){console.warn("⚠️ sendMIDIMessage error:",i)}}:null}_convertValueToMidiMessage(e,t=0){let s=null,a=100,r=0;if(e&&typeof e=="object"){if(e.note!==void 0)s=e.note;else if(e.number!==void 0)s=e.number;else if(e.midi!==void 0)s=e.midi;else if(e.sound!==void 0||e.name!==void 0){const o=e.sound||e.name;if(typeof o=="string"){const i={bd:36,sd:38,hh:42,oh:46,cp:49,ride:51,tom:48,kick:36,snare:38,hat:42,crash:49},l=o.toLowerCase();if(i[l])s=i[l];else{const c=o.match(/(\d+)/);if(c){const u=parseInt(c[1],10);u>=0&&u<=127&&(s=u)}}}}e.velocity!==void 0&&(a=e.velocity),e.channel!==void 0?r=e.channel:e.port!==void 0&&(r=e.port)}else typeof e=="number"?s=e:typeof e=="string"&&(s=this._noteNameToMidi(e));return typeof s!="number"||Number.isNaN(s)?null:{type:"noteOn",note:Math.round(s),velocity:Math.max(1,Math.min(127,Math.round(a))),channel:Math.max(0,Math.min(15,Math.round(r))),time:t}}_noteNameToMidi(e){if(!e||typeof e!="string")return null;try{const t=hr.get(e);if(t&&typeof t.midi=="number")return Math.round(t.midi)}catch{}return null}getMIDIOutputs(){return Array.from(this.midiOutputs.keys())}selectMIDIOutput(e){return this.midiOutputs.has(e)?(this.selectedMidiOutput=this.midiOutputs.get(e),console.log(`✅ Selected MIDI output: ${e}`),!0):(console.warn(`⚠️ MIDI output not found: ${e}`),!1)}setMIDIChannel(e){e>=0&&e<=15&&(this.midiChannel=e,console.log(`✅ MIDI channel set to: ${e+1}`))}stopAllMIDINotes(){if(!(!this.midiEnabled||!this.selectedMidiOutput||this.activeMidiNotes.size===0))try{const e=this.activeMidiNotes.size;for(const t of this.activeMidiNotes){const[s,a]=t.split(":"),r=parseInt(s,10),o=parseInt(a,10);if(!isNaN(r)&&!isNaN(o))try{this.selectedMidiOutput.stopNote(r,{channel:o+1})}catch{}}this.activeMidiNotes.clear(),e>0&&console.log(`✅ Stopped ${e} active MIDI note(s)`)}catch(e){console.warn("⚠️ Error stopping MIDI notes:",e)}}async ensureMIDIFunctionsAvailable(){if(!this.midiEnabled)return;try{await bc()}catch(s){console.warn("⚠️ Unable to load Strudel modules for MIDI check:",s)}const e=typeof globalThis.note=="function"?(...s)=>globalThis.note(...s):null,t=()=>{if(!e)return!1;try{const s=e("c");return!!s&&typeof s.midi=="function"}catch{return!1}};t()||this.ensurePatternMidiMethodsRegistered("ensureMIDIFunctionsAvailable"),t()?console.log("✅ MIDI pattern modifiers are available"):(console.warn("⚠️ MIDI pattern modifiers (.midi(), .midiport()) are still unavailable"),console.warn("   Patterns using .midi() will fail until the modifiers are registered"),console.warn("   Please verify that WebMidi is enabled and try selecting a MIDI output again"))}async preloadPresetSamples(){var s;const e=((s=window.strudel)==null?void 0:s.samples)||globalThis.samples;if(!e||typeof e!="function"){console.warn("⚠️ samples() function not available for pre-loading preset samples");return}const t=["github:tidalcycles/dirt-samples","github:switchangel/pad","github:yaxu/clean-breaks/main","github:tidalcycles/uzu-drumkit","github:yaxu/mrid","github:Bubobubobubobubo/Dough-Amiga","github:Bubobubobubobubo/Dough-Fox","github:Bubobubobubobubo/Dough-Amen","github:Bubobubobubobubo/Dough-Juj","github:mot4i/garden","github:mot4i/loom","github:heavy-lifting/a-maze","github:eddyflux/crate","github:ibleedicare/strudel-bank","github:Prof12200/strudel_repo","github:creativenucleus/strudel-m8-168-dnb-jungle"];console.log("📦 Pre-loading samples from Sampler Effects presets...");for(const a of t)try{console.log(`   Loading: ${a}`),await e(a),console.log(`   ✅ Loaded: ${a}`),await new Promise(r=>setTimeout(r,200))}catch(r){console.warn(`   ⚠️ Failed to load ${a}:`,r.message)}console.log("✅ Finished pre-loading preset samples")}async ensurePatternResourcesLoaded(e){var c;if(!e||typeof e!="string"||typeof this.loadBank!="function")return;const t=this._sanitizePatternExpression(e)||e,s=new Set(["sine","square","triangle","sawtooth","supersaw","pulse","saw","saw2","saw3","saw4","saw8"]),a=new Set,r=/\.bank\(["']([^"']+)["']\)/g;let o;for(;(o=r.exec(t))!==null;)o[1]&&a.add(o[1]);const i=/\.s\(["']([^"']+)["']\)/g;for(;(o=i.exec(t))!==null;){const u=o[1];u&&(/\s|~|\[|\]|,/.test(u)||s.has(u.toLowerCase())||a.add(u))}const l=/\.sound\(["']([^"']+)["']\)/g;for(;(o=l.exec(t))!==null;){const u=o[1];u&&(s.has(u.toLowerCase())||a.add(u))}for(const u of a){if(this.loadedBanks.has(u)||!u)continue;const h=u.toLowerCase();if(s.has(h)){console.log(`⏭️ Skipping built-in oscillator synth "${u}" (no loading needed)`),this.loadedBanks.add(h),this.loadedBanks.add(u);continue}const m=(c=this.sampleNameToSpecialtyBank)==null?void 0:c.get(h);if(m){if(console.log(`⏭️ "${u}" is provided by specialty bank "${m}"`),!this.loadedBanks.has(m))try{await this.loadBank(m)}catch(v){console.warn(`⚠️ Could not ensure specialty bank "${m}" for "${u}":`,v)}this.loadedBanks.add(h),this.loadedBanks.add(u);continue}let f=h;if(tf[h]&&(f=tf[h],console.log(`🔄 Normalizing "${u}" to "${f}" for loading`)),this.loadedBanks.has(f)){console.log(`✅ Resource "${u}" already loaded as "${f}"`),this.loadedBanks.add(u);continue}try{console.log(`🎚️ ensurePatternResourcesLoaded: loading "${f}" for playback`),await this.loadBank(f)?(this.loadedBanks.add(f),this.loadedBanks.add(u),console.log(`✅ Resource "${f}" loaded`)):console.warn(`⚠️ Could not load resource "${f}" (continuing anyway)`)}catch(v){console.warn(`⚠️ Error loading resource "${f}" (continuing anyway):`,v.message||v)}}}stopSustainingTone(e){const t=this.activeSounds.get(e);if(t&&t.type==="sustaining"&&t.oscillator)try{const s=t.gain,a=this.audioContext.currentTime;s.gain.cancelScheduledValues(a),s.gain.setValueAtTime(s.gain.value,a),s.gain.linearRampToValueAtTime(0,a+.1),setTimeout(()=>{t.oscillator.stop(),this.activeSounds.delete(e)},100)}catch(s){console.error("Error stopping sustaining tone:",s),this.activeSounds.delete(e)}}saveElementToMaster(e,t,s,a,r={}){const{isPreview:o=!1}=r;try{console.log(`💾 Saving ${e} to master: pattern="${t==null?void 0:t.substring(0,50)}...", gain=${s}, pan=${a}`);const i=(t||"").replace(/[""]/g,'"').replace(/['']/g,"'"),l=this._sanitizePatternExpression(i),c=this.patternHasNoteNames(l),u=this.patternHasNumericNotePattern(l);let h=l;if(/\bnote\s*\(/i.test(i)){const f=/\bnote\s*\(\s*(["'])([^"']*)\1/gi;let v=!1;h=h.replace(f,(O,k,M)=>{const E=M.replace(/[<>\[\]\{\}\|,]/g," ").trim();return E&&!/[a-gA-G]/.test(E)&&/^[\d\s~\-\/]+$/.test(E)?(v=!0,`n(${k}${M}${k}`):O}),v&&console.log(`🔄 Converted note() with semitones to n() for ${e}`)}return this.trackedPatterns.set(e,{rawPattern:h,pattern:h,gain:s||.8,pan:a||0,muted:!1,soloed:!1}),this.audioContext&&this.getElementAudioNodes(e)&&console.log(`  🎚️ Created audio nodes for ${e}`),this.masterActive&&!o&&this.scheduleMasterPatternRefresh(`save:${e}`),console.log(`✅ Saved ${e} to master. Total tracks: ${this.trackedPatterns.size}`),{success:!0}}catch(i){return console.error(`❌ Error saving ${e} to master:`,i),{success:!1,error:i.message}}}async routePatternThroughMaster(e,t,{isPreview:s=!1,autoStart:a=!1}={}){if(!this.masterOnlyPlayback)return{success:!1,error:"Master-only playback is disabled"};const r=typeof t=="string"?t:"";if(!r.trim())return console.warn(`⚠️ Empty pattern for ${e}, removing from master`),this.removeElementFromMaster(e),this.masterActive&&await this.playMasterPattern(),{success:!1,error:"Pattern empty"};const i=this.getElementGain(e),l=this.getElementPan(e),c=this.saveElementToMaster(e,r,i,l,{isPreview:s});return c.success?(s?this.previewElementIds.add(e):this.previewElementIds.delete(e),this.updateMasterPattern(this.soloedElements,this.mutedElements),this.masterActive?(this.scheduleMasterPatternRefresh(`route:${e}${s?":preview":""}`),{success:!0,autoRefreshed:!0}):a?this.playMasterPattern():{success:!0,autoStarted:!1}):c}removeElementFromMaster(e){try{return this.previewElementIds.delete(e),this.trackedPatterns.has(e)&&(this.trackedPatterns.delete(e),console.log(`🗑️ Removed ${e} from master. Remaining tracks: ${this.trackedPatterns.size}`),this.updateMasterPattern(),this.masterOnlyPlayback&&(this.masterPattern&&this.masterPattern.trim()?this.masterActive&&this.playMasterPattern().catch(t=>console.warn("⚠️ Failed to refresh master after removal:",t)):this.masterActive&&this.stopMasterPattern().catch(t=>console.warn("⚠️ Failed to stop master after removal:",t)))),{success:!0}}catch(t){return console.error(`❌ Error removing ${e} from master:`,t),{success:!1,error:t.message}}}async updateTrackedElementGain(e,t){if(this.trackedPatterns.has(e)){const s=this.trackedPatterns.get(e);return s.gain=t,console.log(`🎚️ Updated ${e} gain in master: ${t.toFixed(2)}`),await this.updateMasterPattern(this.soloedElements,this.mutedElements),this.scheduleMasterPatternRefresh(`gain change: ${e}`),{success:!0}}return{success:!1,reason:"Element not tracked in master"}}async updateTrackedElementPan(e,t){if(this.trackedPatterns.has(e)){const s=this.trackedPatterns.get(e);return s.pan=t,console.log(`🎚️ Updated ${e} pan in master: ${t.toFixed(2)}`),await this.updateMasterPattern(this.soloedElements,this.mutedElements),this.scheduleMasterPatternRefresh(`pan change: ${e}`),{success:!0}}return{success:!1,reason:"Element not tracked in master"}}scheduleMasterPatternRefresh(e="unspecified"){this._pendingMasterPatternRefreshReason=e,!this._masterPatternRefreshTimer&&(this._masterPatternRefreshTimer=setTimeout(()=>{this._masterPatternRefreshTimer=null,this._performScheduledMasterPatternRefresh()},60))}async _performScheduledMasterPatternRefresh(){if(!this.masterPattern||this.masterPattern.trim()===""){this._pendingMasterPatternRefreshReason=null;return}if(!this.masterActive){console.log(`🔁 Master refresh skipped (not active). Pending reason: ${this._pendingMasterPatternRefreshReason||"unspecified"}`),this._pendingMasterPatternRefreshReason=null;return}const e=this._pendingMasterPatternRefreshReason||"unspecified";this._pendingMasterPatternRefreshReason=null,this._masterPatternEvalPromise=this._masterPatternEvalPromise.catch(()=>{}).then(()=>this._reEvaluateMasterPattern(e));try{await this._masterPatternEvalPromise}catch(t){console.warn(`⚠️ Master pattern refresh failed (${e}):`,t)}}formatMasterPatternWithTempoComment(e){if(!e||typeof e!="string"||e.trim()==="")return e;const t=this.currentTempo||this.defaultTempo||120,s="// Controls Selected Tempo:",r=e.split(`
`).filter(i=>!i.trim().startsWith(s)).join(`
`).trimEnd(),o=this._sanitizePatternExpression(r);return o!==r&&console.log("🧼 Sanitized master pattern when formatting tempo comment"),!this.tempoUserAdjusted&&t===(this.defaultTempo||120)?o:`${o}

${s} ${t} BPM`}async updateMasterPattern(e=new Set,t=new Set){var s,a,r,o;try{console.log(`🎛️ Updating master pattern. Tracks: ${this.trackedPatterns.size}, Solo: ${e.size}, Muted: ${t.size}`);const i=[],l=[],c=[],u=e.size>0,h=this.getScaleConversionContext();let m=0;for(const[v,O]of this.trackedPatterns.entries()){const k=t.has(v),M=e.has(v),E=this.extractChannelNumber(v,m);if(m+=1,k||u&&!M){console.log(`  ⏭️ Skipping ${v} (muted: ${k}, solo active but not soloed: ${u&&!M})`);continue}if(O.gain<=0){console.log(`  ⏭️ Skipping ${v} (gain is ${O.gain})`);continue}const I=O.pattern||O.rawPattern||"";let D=this._sanitizePatternExpression(I);if(D!==I&&(O.pattern=D,O.rawPattern=D),!D||D.trim()===""){console.log(`  ⏭️ Skipping ${v} (empty pattern)`);continue}if(D.includes("setDefaultVoicings")){const Ce=/setDefaultVoicings\s*\(\s*(['"]([^'"]*)['"]|([^)]+))\s*\)/g,Ae=[];let q;for(;(q=Ce.exec(D))!==null;)Ae.push({fullMatch:q[0],arg:q[2]||q[3],isQuoted:!!q[2]});for(const Ne of Ae)try{const Re=Ne.isQuoted?`setDefaultVoicings('${Ne.arg}')`:`setDefaultVoicings(${Ne.arg})`;window.strudel&&window.strudel.evaluate&&(await window.strudel.evaluate(Re),console.log(`  ✅ Evaluated ${Re} from ${v}`))}catch(Re){console.warn(`  ⚠️ Could not evaluate setDefaultVoicings from ${v}:`,Re.message)}Ae.length>0&&(D=D.split(`
`).filter(je=>!je.trim().includes("setDefaultVoicings")).join(`
`).replace(/\n{3,}/g,`

`).trim(),O.pattern=D,O.rawPattern=D)}const F=this.patternHasNoteNames(D),_=this.patternHasNumericNotePattern(D);let $=D;F&&!_?($=D,console.log(`  📝 Preserving note names format for ${v}: ${D.substring(0,50)}...`)):_&&!F?($=D,console.log(`  📝 Preserving semitones format for ${v}: ${D.substring(0,50)}...`)):($=D,console.log(`  📝 Preserving pattern format as-is for ${v}: ${D.substring(0,50)}...`)),O.pattern=$;let Z=($||"").trim();if(Z=Z.replace(/[""]/g,'"').replace(/['']/g,"'"),(()=>{const Ce=/\/\*\s*Channel\s+\d+\s*\*\//i.test(Z),Ae=/\bstack\s*\(/i.test(Z);return!(Ce||Ae)})())for(;Z.startsWith("(")&&Z.endsWith(")");){let Ce=0,Ae=!0;for(let q=0;q<Z.length;q++)if(Z[q]==="("?Ce++:Z[q]===")"&&Ce--,Ce===0&&q<Z.length-1){Ae=!1;break}if(Ae&&Ce===0)Z=Z.slice(1,-1).trim();else break}if(Z.startsWith("(")){let Ce=0,Ae=-1;for(let q=0;q<Z.length;q++)if(Z[q]==="("&&Ce++,Z[q]===")"&&Ce--,Ce===0){Ae=q;break}Ae===-1&&(Z=Z.substring(1),console.log("  🔧 Stripped unmatched opening paren from pattern"))}Z=$x(Z),Z=Z.replace(/\.postgain\s*\([^)]*\)/gi,""),Z=Z.replace(/\.pan\s*\([^)]*\)/gi,""),Z=Z.replace(/\.\.+/g,"."),Z=Z.replace(/\s+\./g,"."),Z=Z.replace(/\.\s*$/,""),Z=Z.trim(),(s=this.appInstance)!=null&&s.getPatternWithMidi&&(Z=this.appInstance.getPatternWithMidi(v,Z)),Z=`${Z.trim()}.postgain(${O.gain.toFixed(2)})`,O.pan!==0&&(Z=`${Z}.pan(${O.pan.toFixed(2)})`);const ue=((r=(a=this.appInstance)==null?void 0:a.loadElementConfig)==null?void 0:r.call(a,v))||{};let W=ue.key||null,de=ue.scale||null;if((!W||!de)&&Z.includes(".scale(")){const Ce=Z.match(/\.\s*scale\s*\(\s*['"]([^'"]+)['"]\s*\)/i);if(Ce&&Ce[1]){const Ae=Ce[1];if(Ae.includes(":")){const[q,Ne]=Ae.split(":");W=W||q.trim(),de=de||Ne.trim(),console.log(`  🎼 Extracted scale from pattern: ${W}:${de}`)}else de=de||Ae.trim(),W=W||"C",console.log(`  🎼 Extracted scale from pattern: ${W}:${de}`)}}const be=Z.trim(),ke=be.startsWith("(")&&be.endsWith(")");if(Z=this.applyGlobalSettingsToPattern(Z,ke,!1,W,de),O.pan===0){let Ce=Z.trim();(()=>{for(;Ce.startsWith("(")&&Ce.endsWith(")");){let q=0,Ne=!0;for(let Re=0;Re<Ce.length;Re++){const je=Ce[Re];if(je==="("?q++:je===")"&&q--,q===0&&Re<Ce.length-1){Ne=!1;break}}if(!Ne||q!==0)break;Ce=Ce.slice(1,-1).trim()}})(),Z=Ce}i.push(Z),c.push(E),l.push(`Channel ${E}`),console.log(`  ✅ Added ${v}: ${Z.substring(0,100)}...`)}if(i.length===0)this.masterPattern="",this.masterPatternManualOverride=!1,console.log("🔇 No active patterns - master pattern cleared");else{if(this.masterPatternManualOverride&&this.masterPattern&&this.masterPattern.trim()!==""){console.log("📝 Using manual override pattern - skipping stack() wrapping and master mix modifiers");return}let O=`stack(
${i.map((_,$)=>`  /* Channel ${c[$]??$+1} */
  ${_}`).join(`,

`)}
)`;O=this.applyMasterMixModifiers(O,{wrapStack:!0}),this.masterPattern=O,this.masterPatternManualOverride=!1;let k=0,M=!1,E=null,I=!1;for(let _=0;_<this.masterPattern.length;_++){const $=this.masterPattern[_],Z=this.masterPattern[_+1];if(!M&&$==="/"&&Z==="/"){I=!0,_++;continue}if(I&&$===`
`){I=!1;continue}if(!I){if(!I&&($==='"'||$==="'")){M?$===E&&this.masterPattern[_-1]!=="\\"&&(M=!1,E=null):(M=!0,E=$);continue}if(!M&&!I){if($==="(")k++;else if($===")"&&(k--,k<0)){console.error(`  ⚠️ UNBALANCED PARENTHESES! Extra closing paren at position ${_}`);break}}}}const D=(this.masterPattern.match(/\(/g)||[]).length,F=(this.masterPattern.match(/\)/g)||[]).length;if(console.log(`🎵 Master pattern (stack): ${this.masterPattern.substring(0,150)}...`),console.log(`  📊 Parentheses: ${D} open, ${F} close, depth=${k}, balanced: ${k===0}`),k!==0)if(console.error(`  ⚠️ UNBALANCED PARENTHESES! Depth=${k}, fixing...`),console.log(`  🧾 Master pattern before fix:
`,this.masterPattern),k>0)this.masterPattern+=")".repeat(k),console.log(`  ✅ Added ${k} closing paren(s)`);else{const _=Math.abs(k);let $=0;for(let Z=this.masterPattern.length-1;Z>=0&&$<_;Z--)this.masterPattern[Z]===")"&&(this.masterPattern=this.masterPattern.substring(0,Z)+this.masterPattern.substring(Z+1),$++);console.log(`  ✅ Removed ${$} extra closing paren(s)`)}}if(this.masterPattern&&((o=window.__patternHistory)!=null&&o.saveMasterVersion))try{window.__patternHistory.saveMasterVersion(this.masterPattern)}catch(v){console.warn("⚠️ Unable to record master history entry:",v)}const f=this.masterPattern;if(f&&f.trim()!==""){let v=this.convertPatternForScale(f)||f;this.masterPattern=this.formatMasterPatternWithTempoComment(v)}return console.log(`🎛️ Applied global settings to master pattern (Key: ${this.currentKey||"none"}, Scale: ${this.currentScale||(this.currentKey?"derived":"none")}, Time Sig: ${this.currentTimeSignature||"none"}, Volume: ${this.formatNumberForPattern(this.masterVolume,4)}, Pan: ${this.formatNumberForPattern(this.masterPan,4)}, Tempo: ${this.currentTempo||120} BPM)`),this.onMasterPatternUpdateCallback&&this.onMasterPatternUpdateCallback(),{success:!0,pattern:this.masterPattern}}catch(i){return console.error("❌ Error updating master pattern:",i),{success:!1,error:i.message}}}setupVisualizerAnalyser(){var s,a;if(!this.audioContext||!window.strudel)return;const e="master-punchcard-canvas",t=((s=window.strudel)==null?void 0:s.getAnalyserById)||globalThis.getAnalyserById;if(!t||typeof t!="function"){console.warn("⚠️ getAnalyserById not available - visualizers may not work");return}try{let r=null;try{r=t(e,2048,.8),r&&r.context!==this.audioContext&&(console.warn("⚠️ Analyser from getAnalyserById is in different audio context, creating new one"),r=null)}catch(o){console.warn("⚠️ Could not get analyser from getAnalyserById:",o.message)}if(!r){r=this.audioContext.createAnalyser(),r.fftSize=2048,r.smoothingTimeConstant=.8,r.__strudelVisualizerNode=!0;const o=t,i=r;window.strudel&&(window.strudel.analysers&&typeof window.strudel.analysers=="object"&&(window.strudel.analysers[e]=r,console.log(`✅ Stored analyser "${e}" in Strudel's analyser registry`)),window.strudel.getAnalyserById=function(l,c,u){return l===e?i:o(l,c,u)}),globalThis.getAnalyserById&&(globalThis.getAnalyserById=function(l,c,u){return l===e?i:o(l,c,u)}),globalThis.analysers||(globalThis.analysers={}),globalThis.analysers[e]=r,console.log(`✅ Created analyser "${e}" in our audio context and patched getAnalyserById`)}if(this.visualizerAnalyser=r,this.visualizerAnalyser&&(this.visualizerAnalyser.__strudelVisualizerNode=!0),this.masterGainNode&&r){const o=this._realDestination||((a=this.audioContext)==null?void 0:a.destination);if(!o)console.warn("⚠️ Cannot connect analyser - destination unavailable");else try{if(!this.visualizerAnalyserTapGain&&this.audioContext&&(this.visualizerAnalyserTapGain=this.audioContext.createGain(),this.visualizerAnalyserTapGain.gain.value=0,this.visualizerAnalyserTapGain.__strudelVisualizerNode=!0),this.visualizerAnalyserTapGain){try{this.visualizerAnalyserTapGain.disconnect()}catch{}this.visualizerAnalyserTapGain.connect(o)}try{r.disconnect()}catch{}try{this.masterGainNode.disconnect(r)}catch{}this.masterGainNode.connect(r),this.visualizerAnalyserTapGain&&r.connect(this.visualizerAnalyserTapGain),console.log(`✅ Connected visualizer analyser "${e}" with silent tap to destination`),setTimeout(()=>{try{const i=new Uint8Array(r.frequencyBinCount);r.getByteFrequencyData(i);const l=i.some(h=>h>0),c=Math.max(...i);console.log(`🔍 Analyser data check: hasData=${l}, maxValue=${c}, frequencyBinCount=${r.frequencyBinCount}`);const u=document.getElementById(e);u?console.log(`🔍 Canvas check: found canvas with ID "${e}", width=${u.width}, height=${u.height}`):console.warn(`⚠️ Canvas with ID "${e}" not found!`)}catch(i){console.warn("⚠️ Could not check analyser data:",i)}},500)}catch(i){console.warn(`⚠️ Failed to connect analyser "${e}":`,i.message)}}else console.warn(`⚠️ Cannot connect analyser - masterGainNode: ${!!this.masterGainNode}, analyser: ${!!r}`)}catch(r){console.warn("⚠️ Failed to setup visualizer analyser:",r)}}applyVisualizerTargetsToPattern(e){if(!e||typeof e!="string")return e;const s="master-punchcard-canvas",a="window.__strudelVisualizerCtx || (document.getElementById('master-punchcard-canvas') && document.getElementById('master-punchcard-canvas').getContext && document.getElementById('master-punchcard-canvas').getContext('2d'))",r=["spectrum","scope","tscope","fscope","visual","pianoroll","barchart"];let o=e;const i=new RegExp(`\\.\\s*_(${r.join("|")})\\s*\\(`,"gi");o=o.replace(i,(u,h)=>u.replace(`_${h}`,h));const l=["spectrum","scope","tscope","fscope"],c=["visual","barchart","pianoroll"];return l.forEach(u=>{const h=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),m=new RegExp(`\\.\\s*_?${h}\\s*\\(\\s*\\)`,"gi");o=o.replace(m,v=>v.replace(/\(\s*\)/,`({ id: '${s}' })`));const f=new RegExp(`\\.\\s*_?${h}\\s*\\(\\s*\\{([^}]*)\\}\\s*\\)`,"gi");o=o.replace(f,(v,O)=>{let k=O.trim();return/(^|,)\s*id\s*:/.test(k)||(k=k.length>0?`${k}, id: '${s}'`:`id: '${s}'`),v.replace(O,k)})}),c.forEach(u=>{const h=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),m=new RegExp(`\\.\\s*_?${h}\\s*\\(\\s*\\)`,"gi");o=o.replace(m,v=>v.replace(/\(\s*\)/,`({ id: '${s}', ctx: ${a} })`));const f=new RegExp(`\\.\\s*_?${h}\\s*\\(\\s*\\{([^}]*)\\}\\s*\\)`,"gi");o=o.replace(f,(v,O)=>{let k=O.trim();const M=/(^|,)\s*id\s*:/.test(k),E=/(^|,)\s*ctx\s*:/.test(k);return M||(k=k.length>0?`${k}, id: '${s}'`:`id: '${s}'`),E||(k=k.length>0?`${k}, ctx: ${a}`:`ctx: ${a}`),v.replace(O,k)})}),o!==e&&(console.log("🎨 Injected canvas ID into visualizer methods"),console.log(`   Before: ${e.substring(0,150)}...`),console.log(`   After: ${o.substring(0,150)}...`)),o}async _reEvaluateMasterPattern(e="manual"){var a;if(!this.masterPattern||this.masterPattern.trim()==="")return console.log("⚠️ No master pattern to re-evaluate"),{success:!1,error:"No pattern to re-evaluate"};if(!window.strudel||typeof window.strudel.evaluate!="function")return{success:!1,error:"Strudel evaluate unavailable"};if(window.strudel.scheduler&&!window.strudel.scheduler.started){console.log(`🔄 Scheduler stopped, restarting before re-evaluation (${e})...`);try{await window.strudel.scheduler.start(),console.log("✅ Scheduler restarted")}catch(r){console.warn("⚠️ Could not restart scheduler:",r.message)}}const t=this.masterSlot||"d0";try{await window.strudel.evaluate(`${t} = silence`),await new Promise(r=>setTimeout(r,10))}catch(r){console.warn("⚠️ Could not clean up old pattern:",r.message)}if(this.masterGainNode){const r=((a=this.audioContext)==null?void 0:a.currentTime)||0;this.masterGainNode.gain.setValueAtTime(this.masterVolume,r)}this._ensureMasterPatternSanitized();let s=this.masterPattern.trim();try{const r=/setDefaultVoicings\s*\(\s*(['"]([^'"]*)['"]|([^)]+))\s*\)/g,o=[];let i;for(;(i=r.exec(s))!==null;)o.push({fullMatch:i[0],arg:i[2]||i[3],isQuoted:!!i[2]});for(const h of o)try{const m=h.isQuoted?`setDefaultVoicings('${h.arg}')`:`setDefaultVoicings(${h.arg})`;await window.strudel.evaluate(m),console.log(`✅ Evaluated ${m} before pattern`)}catch(m){console.warn("⚠️ Could not evaluate setDefaultVoicings:",m.message)}if(o.length>0&&(s=s.split(`
`).filter(f=>!f.trim().includes("setDefaultVoicings")).join(`
`),s=s.replace(/\n\s*\n\s*\n+/g,`

`).trim(),s.startsWith("stack("))){let f=0,v=!1,O=null;for(let k=0;k<s.length;k++){const M=s[k];!v&&(M==='"'||M==="'")?(v=!0,O=M):v&&M===O&&s[k-1]!=="\\"&&(v=!1,O=null),v||(M==="("?f++:M===")"&&f--)}f!==0?(console.warn(`⚠️ Pattern structure may be broken after removing setDefaultVoicings (depth: ${f})`),console.log(`   Pattern preview: ${s.substring(0,200)}...`)):console.log("✅ Pattern structure validated after removing setDefaultVoicings")}if(this.masterPatternManualOverride){const{setupCode:h,finalExpression:m}=this._splitManualOverridePattern(s);if(h)try{await window.strudel.evaluate(h)}catch(f){console.warn("⚠️ Manual override setup code failed:",f.message)}if(m){const f=`${t} = ${m}`;console.log(`🔄 Re-evaluating manual override pattern (${e})...`),await window.strudel.evaluate(f);try{const v=await window.strudel.evaluate(t);v&&typeof v.queryArc=="function"&&(window.strudel.scheduler.pattern=v,console.log("✅ Set scheduler.pattern for manual override"))}catch(v){console.warn("⚠️ Could not set scheduler.pattern for manual override:",v.message)}if(window.strudel.scheduler&&!window.strudel.scheduler.started){console.log("🔄 Scheduler stopped after manual override, restarting...");try{await window.strudel.scheduler.start(),console.log("✅ Scheduler restarted after manual override")}catch(v){console.warn("⚠️ Could not restart scheduler after manual override:",v.message)}}return console.log(`✅ Manual override pattern re-evaluated (${e})`),{success:!0,slot:t}}else console.warn("⚠️ Manual override pattern missing final expression - falling back to multi-statement evaluation")}const l=s.split(`
`).filter(h=>h.trim()&&!h.trim().startsWith("//")),c=l.length>1&&s.match(/^[a-zA-Z_$][a-zA-Z0-9_$]*\s*:/m),u=s.trim().match(/^(stack|all)\s*\(/);if(c&&l.length>1&&!u){const h=l.slice(0,-1).join(`
`);if(h.trim())try{await window.strudel.evaluate(h)}catch(v){console.warn("⚠️ Could not evaluate setup statements:",v.message)}const m=l[l.length-1].trim(),f=`${t} = ${m}`;try{console.log(`🔄 Re-evaluating master pattern (${e}) with multi-statement support...`),await window.strudel.evaluate(f)}catch(v){console.warn("⚠️ Failed to evaluate as multi-statement, trying as single expression:",v.message);const O=`${t} = ${s}`;await window.strudel.evaluate(O)}}else{const h=`${t} = ${s}`;console.log(`🔄 Re-evaluating master pattern (${e})...`),await window.strudel.evaluate(h)}try{const h=await window.strudel.evaluate(t);if(h&&typeof h.queryArc=="function"){window.strudel.scheduler.pattern=h,console.log("✅ Set scheduler.pattern for highlighting (re-evaluation)");try{const m=h.queryArc(0,.1)||[];m.length>0&&(m.some(v=>{var O,k;return((k=(O=v==null?void 0:v.context)==null?void 0:O.locations)==null?void 0:k.length)>0})?console.log("✅ Pattern has location data - highlighting should work"):console.warn("⚠️ Pattern set on scheduler but haps have no location data. withLoc may not be working correctly."))}catch{}}}catch(h){console.warn("⚠️ Could not set scheduler.pattern for highlighting:",h.message)}if(window.strudel.scheduler&&!window.strudel.scheduler.started){console.log("🔄 Scheduler stopped after re-evaluation, restarting...");try{await window.strudel.scheduler.start(),console.log("✅ Scheduler restarted after re-evaluation")}catch(h){console.warn("⚠️ Could not restart scheduler after re-evaluation:",h.message)}}return console.log(`✅ Master pattern re-evaluated (${e})`),{success:!0,slot:t}}catch(r){return console.error("❌ Failed to re-evaluate master pattern:",r),{success:!1,error:r.message}}}async _playMasterPatternSimple(){var r,o,i,l,c,u,h,m,f;if(!this.masterPattern||this.masterPattern.trim()==="")return console.log("⚠️ No master pattern to play (master-only mode)"),this.masterActive?await this._stopMasterPatternSimple():this.masterActive=!1,{success:!1,error:"No pattern to play"};console.log("🔍 [PLAY-TIME CHECK] Searching for superdough output...");const e=(r=window.strudel)==null?void 0:r.scheduler;if(e){if(console.log("  scheduler.output type:",(i=(o=e.output)==null?void 0:o.constructor)==null?void 0:i.name),console.log("  scheduler.superdough:",!!e.superdough),console.log("  scheduler keys:",Object.keys(e).slice(0,20)),e.webaudio){if(console.log("  ✅ Found scheduler.webaudio!"),console.log("    webaudio type:",(c=(l=e.webaudio)==null?void 0:l.constructor)==null?void 0:c.name),console.log("    webaudio keys:",Object.keys(e.webaudio||{}).slice(0,20)),e.webaudio.node&&this.masterPanNode){console.log("  🎯 Found scheduler.webaudio.node (the REAL output!)");try{e.webaudio.node.disconnect(),e.webaudio.node.connect(this.masterPanNode),console.log("✅ [PLAY-TIME CHECK] Connected scheduler.webaudio.node to masterPanNode - THIS IS THE KEY!")}catch(v){console.warn("⚠️ [PLAY-TIME CHECK] Could not connect scheduler.webaudio.node:",v)}}}else if(console.log("  ⚠️ scheduler.webaudio does NOT exist!"),console.log("  🔍 Checking if scheduler.output is connected to anything..."),e.output&&e.output!==this.masterPanNode)try{console.log("  🔧 Attempting to connect scheduler.output to masterPanNode..."),e.output.disconnect(),e.output.connect(this.masterPanNode),console.log("  ✅ Connected scheduler.output to masterPanNode!")}catch(v){console.warn("  ⚠️ Could not connect scheduler.output:",v)}else console.log("  ℹ️ scheduler.output is already masterPanNode or does not exist");if((u=e.superdough)!=null&&u.output&&this.masterPanNode){console.log("  ✅ Found scheduler.superdough.output");try{e.superdough.output.disconnect(),e.superdough.output.connect(this.masterPanNode),console.log("✅ [PLAY-TIME CHECK] Connected scheduler.superdough.output to masterPanNode")}catch(v){console.warn("⚠️ [PLAY-TIME CHECK] Could not connect scheduler.superdough.output:",v)}}else e.webaudio||console.log("  ℹ️ No scheduler.superdough.output or scheduler.webaudio found")}else console.log("  ⚠️ No scheduler found at window.strudel.scheduler");if(await this.initialize(),this.strudelLoaded||await this.initializeStrudelAndSounds(),this.masterGainNode){const v=((h=this.audioContext)==null?void 0:h.currentTime)||0;this.masterGainNode.gain.setValueAtTime(this.masterVolume,v)}if(this.masterPanNode&&this.masterPanNode.pan.setValueAtTime(this.masterPan,((m=this.audioContext)==null?void 0:m.currentTime)||0),!window.strudel||typeof window.strudel.evaluate!="function")return{success:!1,error:"Strudel evaluate unavailable"};this._ensureMasterPatternSanitized();const t=this.masterSlot||"d0",s=this.masterPattern.trim(),a=this.masterPatternManualOverride;try{if(a){const{setupCode:v,finalExpression:O}=this._splitManualOverridePattern(s);if(v)try{await window.strudel.evaluate(v)}catch(k){console.warn("⚠️ Manual override setup code failed:",k)}O?await window.strudel.evaluate(`${t} = ${O}`):(console.warn("⚠️ Manual override missing final expression, falling back to default evaluation"),await window.strudel.evaluate(`${t} = ${s}`))}else{const{setupStatements:v,patternExpression:O}=this.parseMultiStatementPattern(s);for(const M of v)try{await window.strudel.evaluate(M)}catch(E){console.warn(`⚠️ Setup statement evaluation warning: ${E.message}`)}const k=O||s;await window.strudel.evaluate(`${t} = ${k}`)}if(window.strudel.scheduler){window.strudel.scheduler.started||await window.strudel.scheduler.start();try{const v=await window.strudel.evaluate(t);if(v&&typeof v.queryArc=="function"){window.strudel.scheduler.pattern=v,console.log("✅ Set scheduler.pattern for highlighting");try{const O=v.queryArc(0,.1)||[];O.length>0&&(O.some(M=>{var E,I;return((I=(E=M==null?void 0:M.context)==null?void 0:E.locations)==null?void 0:I.length)>0})?console.log("✅ Pattern has location data - highlighting should work"):console.warn("⚠️ Pattern set on scheduler but haps have no location data. withLoc may not be working correctly."))}catch{}}}catch(v){console.warn("⚠️ Could not set scheduler.pattern for highlighting:",v.message)}}else console.warn("⚠️ Strudel scheduler missing - cannot ensure playback");return this.masterActive=!0,this.masterPlaybackStartTime=((f=this.audioContext)==null?void 0:f.currentTime)||performance.now(),this.onMasterStateChangeCallback&&this.onMasterStateChangeCallback(!0,Array.from(this.trackedPatterns.keys())),this.editorHighlightingEnabled&&Tx(),{success:!0,slot:t}}catch(v){return console.error("❌ Failed to evaluate master pattern:",v),{success:!1,error:v.message}}}parseMultiStatementPattern(e){if(!e||typeof e!="string")return{setupStatements:[],patternExpression:e||""};const t=[];let s="",a=!1,r="",o=0,i=0,l=0;for(let m=0;m<e.length;m++){const f=e[m],v=m>0?e[m-1]:"";if((f==='"'||f==="'"||f==="`")&&v!=="\\"&&(a?f===r&&(a=!1,r=""):(a=!0,r=f)),a||(f==="("?o++:f===")"?o--:f==="{"?i++:f==="}"?i--:f==="["?l++:f==="]"&&l--),!a&&o===0&&i===0&&l===0&&(f===`
`||f===";")){s.trim()&&t.push(s.trim()),s="";continue}s+=f}s.trim()&&t.push(s.trim());const c=[];let u="";const h=[/^\s*samples\s*\(/i,/^\s*setcps\s*\(/i,/^\s*setcpm\s*\(/i,/^\s*setbpm\s*\(/i,/^\s*(let|const|var)\s+\w+/i,/^\s*await\s+samples\s*\(/i];for(let m=0;m<t.length;m++){const f=t[m];if(!f||f.startsWith("//")||f.startsWith("/*"))continue;h.some(O=>O.test(f))?c.push(f):!u||m===t.length-1?u=f:u=u?`${u}
${f}`:f}return!u&&t.length>0&&(u=t[t.length-1]),t.length===1&&c.length===0&&(u=t[0]),{setupStatements:c,patternExpression:u}}async playMasterPattern(){var e,t,s,a,r,o,i,l,c,u,h,m,f,v,O,k,M,E,I,D,F,_,$,Z,ce,U,ue,W,de,be,ke,Ce,Ae,q,Ne,Re,je,me,Ye,ft,_e,Ge,pt,rt,tn,on,xn,Gt,In,Ft,jt,Gn,un,fn,at,Un,nt,Mt,Vt,En,lt,It,Le,qt,tt;if(this.masterOnlyPlayback)return this._playMasterPatternSimple();try{console.log("▶️ Playing master pattern..."),console.log("🔍 [PLAY-TIME CHECK] Searching for superdough output...");const zn=(e=window.strudel)==null?void 0:e.scheduler;if(zn)if(console.log("  scheduler.output type:",(s=(t=zn.output)==null?void 0:t.constructor)==null?void 0:s.name),console.log("  scheduler.superdough:",!!zn.superdough),console.log("  scheduler keys:",Object.keys(zn).slice(0,20)),(a=zn.superdough)!=null&&a.output&&this.masterPanNode){console.log("  ✅ Found scheduler.superdough.output");try{zn.superdough.output.disconnect(),zn.superdough.output.connect(this.masterPanNode),console.log("✅ [PLAY-TIME CHECK] Connected scheduler.superdough.output to masterPanNode")}catch(mt){console.warn("⚠️ [PLAY-TIME CHECK] Could not connect scheduler.superdough.output:",mt)}}else console.log("  ℹ️ scheduler.superdough.output not found - scheduler.output should already be connected");else console.log("  ⚠️ No scheduler found at window.strudel.scheduler");if(this.masterActive=!0,console.log("🎚️ masterActive set to TRUE before pattern evaluation"),console.log("🔍 PRE-PLAY: Verifying audio routing hijacking is active..."),console.log("   AudioNode.prototype.__originalConnect exists:",!!AudioNode.prototype.__originalConnect),console.log("   AudioNode.prototype.connect is patched:",AudioNode.prototype.connect!==AudioNode.prototype.__originalConnect),console.log("   masterActive:",this.masterActive),console.log("   trackedPatterns.size:",this.trackedPatterns.size),console.log("   masterPanNode exists:",!!this.masterPanNode),console.log("   masterGainNode exists:",!!this.masterGainNode),this.masterGainNode&&this.masterGainNode.gain.setValueAtTime(this.masterVolume,((r=this.audioContext)==null?void 0:r.currentTime)||0),(!this.audioContext||this.audioContext.state==="suspended")&&await this.initialize(),this.strudelLoaded||(console.log("⏳ Waiting for Strudel to initialize..."),await this.initializeStrudelAndSounds()),this._ensureMasterPatternSanitized(),this.setupVisualizerAnalyser(),!this.masterPattern||this.masterPattern.trim()==="")return console.log("⚠️ No master pattern to play"),this.masterActive=!1,{success:!1,error:"No pattern to play"};if(this.audioContext)if(this.audioContext.state!=="running"){console.log(`🔊 Audio context state: ${this.audioContext.state}, resuming...`);try{await this.audioContext.resume();let mt=0;for(;this.audioContext.state!=="running"&&mt<10;)await new Promise(Fn=>setTimeout(Fn,50)),mt++;this.audioContext.state==="running"?console.log(`✅ Audio context resumed successfully, state: ${this.audioContext.state}`):console.warn(`⚠️ Audio context not running after resume, state: ${this.audioContext.state}`)}catch(mt){console.warn("⚠️ Could not resume audio context:",mt)}}else console.log("✅ Audio context already running");else return console.error("❌ Audio context does not exist"),{success:!1,error:"Audio context not initialized"};if(window.strudel&&window.strudel.evaluate){let mt=this.masterPattern.trim();if(!mt||mt==="")return console.error("❌ Master pattern is empty, cannot evaluate"),{success:!1,error:"Master pattern is empty"};console.log("🎼 Master pattern before processing:",mt.substring(0,200)),mt=$x(mt),mt=this.applyVisualizerTargetsToPattern(mt),console.log("🎼 Master pattern after visualizer injection:",mt.substring(0,200)),await this.ensureStrudelWorkletsReady(mt);const Fn=mt.match(/\.bank\(["']([^"']+)["']\)/g);if(Fn&&typeof this.loadBank=="function"){const H=[...new Set(Fn.map(ee=>{const ne=ee.match(/\.bank\(["']([^"']+)["']\)/);return ne?ne[1]:null}).filter(Boolean))];for(const ee of H)if(!this.loadedBanks.has(ee))try{console.log(`🎚️ Master: ensuring bank "${ee}" is loaded before playback`),await this.loadBank(ee)?(this.loadedBanks.add(ee),console.log(`✅ Master: bank "${ee}" loaded`)):console.warn(`⚠️ Master: bank "${ee}" could not be loaded (continuing anyway)`)}catch(ne){console.warn(`⚠️ Master: error loading bank "${ee}":`,ne)}}await this.ensurePatternResourcesLoaded(mt),mt=mt.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\n\s*\n/g,`
`).trim();const ea=mt;mt=mt.replace(/[""]/g,'"').replace(/['']/g,"'"),ea!==mt&&(console.log("🔧 Normalized quotes in master pattern"),console.log(`  Before: ${ea.substring(0,100)}...`),console.log(`  After:  ${mt.substring(0,100)}...`)),!mt.includes(".loop(")&&!mt.includes(".loop()")&&(mt=`${mt}.loop()`,console.log("🔄 Added .loop() to master pattern for continuous playback")),this.masterActive=!0,console.log("🎚️ masterActive set to TRUE before pattern evaluation"),this._masterDestinationConnectLogged=!1,this._singleElementMasterRoutingLogged=!1,this._noElementRoutingLogged=!1,this._nodeTypeConnectLogged=new Set,this._stackMasterRoutingLogged=!1,this._masterRoutingLogged=!1,this._panNodeConnectedToMaster=new Set,this._gainConnectDebugged=!1,this._stackElementRoutingLogged=new Set,this._chainVerificationLogged=new Set,this._connectionSuccessLogged=new Set,this._allConnectionsLogged=new Set,this._allDestConnectionsLogged=new Set,this._panNodeConnectedLogged=new Set,this._panNodeNotConnectedLogged=new Set,this._panNodeConnectionErrorLogged=new Set,this._masterGainDestVerifiedAfterRouting=new Set,this._masterGainDestVerified=!1,this._stackConnectionCount&&this._stackConnectionCount.set("total",0);const Hn=this.masterSlot;this.currentEvaluatingSlot=Hn,console.log(`🎚️ Master stack evaluation slot: ${Hn}`),console.log(`🔧 Ensuring audio nodes exist for ${this.trackedPatterns.size} tracked elements...`);for(const[H]of this.trackedPatterns.entries()){const ee=this.getElementAudioNodes(H);if(ee){const ne=this.elementGainValues.get(H)||.8;ee.gainNode.gain.value=ne*this.volume;let ge=[];ge.push(`gainNode: gain=${ee.gainNode.gain.value.toFixed(3)}`),ge.push(`panNode: pan=${ee.panNode.pan.value.toFixed(3)}`),console.log(`  ✅ ${H}: ${ge.join(", ")}`)}else console.warn(`  ⚠️ ${H}: Failed to create audio nodes`)}if(this.visualizerAnalyser&&this.masterGainNode){try{this.masterGainNode.disconnect(this.visualizerAnalyser)}catch{}try{this.masterGainNode.connect(this.visualizerAnalyser),console.log("✅ Reconnected visualizer analyser to master gain node")}catch(H){console.warn("⚠️ Could not reconnect visualizer analyser:",H)}}if(window.strudel&&window.strudel.scheduler){if(window.strudel.scheduler.started)console.log("✅ Strudel scheduler already started");else{console.log("▶️ Starting Strudel scheduler BEFORE pattern evaluation...");try{await window.strudel.scheduler.start(),window.strudel.scheduler.started?console.log("✅ Strudel scheduler started successfully"):(console.error("❌ Strudel scheduler start() returned but scheduler.started is still false"),await window.strudel.scheduler.start(),window.strudel.scheduler.started?console.log("✅ Strudel scheduler started on retry"):console.error("❌ Strudel scheduler failed to start after retry"))}catch(ne){console.error("❌ Failed to start scheduler:",ne);try{await window.strudel.scheduler.start(),console.log("✅ Strudel scheduler started on second attempt")}catch(ge){console.error("❌ Failed to start scheduler on retry:",ge)}}}const H=window.strudel.scheduler;console.log("🔍 POST-START: Checking scheduler for webaudio output..."),console.log(`   scheduler keys: ${Object.keys(H).slice(0,15).join(", ")}`);let ee=H.webaudio||H._webaudio;if(!ee&&window.strudel.webaudio&&(ee=window.strudel.webaudio,console.log("   ✅ Found webaudio in window.strudel.webaudio")),ee){console.log(`   ✅ Found webaudio, keys: ${Object.keys(ee).slice(0,10).join(", ")}`);const ne=ee.output||ee.outputNode;if(ne){if(console.log(`   ✅ Found output node: ${ne.constructor.name}`),this.trackedPatterns.size>0){const ge=Array.from(this.trackedPatterns.keys())[0],Fe=this.getElementAudioNodes(ge);if(Fe!=null&&Fe.gainNode)try{ne.disconnect(),ne.connect(Fe.gainNode),console.log(`   ✅ Routed webaudio output to ${ge} gainNode`)}catch(Be){console.log(`   ✅ webaudio output already routed (${Be.message})`)}}else if(this.masterPanNode)try{ne.disconnect(),ne.connect(this.masterPanNode),console.log("   ✅ Routed webaudio output to masterPanNode (fallback)")}catch(ge){console.log(`   ✅ webaudio output already routed to master (${ge.message})`)}}else console.log("   ⚠️ webaudio found but no output node")}else console.log("   ⚠️ No webaudio found in scheduler or window.strudel");if(H.superdough){const ne=H.superdough;console.log(`   ✅ Found superdough, keys: ${Object.keys(ne).slice(0,20).join(", ")}`),ne.audioContext&&(console.log(`   🔍 superdough.audioContext: ${ne.audioContext===this.audioContext?"OUR CONTEXT ✅":"DIFFERENT CONTEXT ⚠️"}`),console.log(`   🔍 superdough.audioContext.state: ${ne.audioContext.state}`));const ge=["output","outputNode","_output","destination","_destination","gain","masterGain"];for(const Fe of ge)if(ne[Fe]&&ne[Fe]instanceof AudioNode){if(console.log(`   ✅ Found AudioNode at superdough.${Fe}: ${ne[Fe].constructor.name}`),this.trackedPatterns.size>0){const Be=Array.from(this.trackedPatterns.keys())[0],wt=this.getElementAudioNodes(Be);if(wt!=null&&wt.gainNode)try{ne[Fe].disconnect(),ne[Fe].connect(wt.gainNode),console.log(`   ✅ Routed superdough.${Fe} to ${Be} gainNode`)}catch(Nt){console.log(`   ✅ superdough.${Fe} already routed (${Nt.message})`)}}else if(this.masterPanNode)try{ne[Fe].disconnect(),ne[Fe].connect(this.masterPanNode),console.log(`   ✅ Routed superdough.${Fe} to masterPanNode`)}catch(Be){console.log(`   ✅ superdough.${Fe} already routed to master (${Be.message})`)}}}}else if(window.strudel&&window.strudel.scheduler&&window.strudel.scheduler.started){console.log("✅ Strudel scheduler already running");const H=window.strudel.scheduler;console.log("🔍 ALREADY-RUNNING: Checking scheduler for webaudio output..."),console.log(`   scheduler keys: ${Object.keys(H).slice(0,15).join(", ")}`);const ee=H.webaudio||H._webaudio;if(ee){console.log(`   ✅ Found webaudio, keys: ${Object.keys(ee).slice(0,10).join(", ")}`);const ne=ee.output||ee.outputNode;if(ne){if(console.log(`   ✅ Found output node: ${ne.constructor.name}`),this.trackedPatterns.size>0){const ge=Array.from(this.trackedPatterns.keys())[0],Fe=this.getElementAudioNodes(ge);if(Fe!=null&&Fe.gainNode)try{ne.disconnect(),ne.connect(Fe.gainNode),console.log(`   ✅ Routed webaudio output to ${ge} gainNode`)}catch(Be){console.log(`   ✅ webaudio output already routed (${Be.message})`)}}else if(this.masterPanNode)try{ne.disconnect(),ne.connect(this.masterPanNode),console.log("   ✅ Routed webaudio output to masterPanNode (fallback)")}catch(ge){console.log(`   ✅ webaudio output already routed to master (${ge.message})`)}}else console.log("   ⚠️ webaudio found but no output node")}else console.log("   ⚠️ No webaudio found in scheduler");if(H.superdough){const ne=H.superdough;console.log(`   ✅ Found superdough, keys: ${Object.keys(ne).slice(0,20).join(", ")}`),ne.audioContext&&(console.log(`   🔍 superdough.audioContext: ${ne.audioContext===this.audioContext?"OUR CONTEXT ✅":"DIFFERENT CONTEXT ⚠️"}`),console.log(`   🔍 superdough.audioContext.state: ${ne.audioContext.state}`));const ge=["output","outputNode","_output","destination","_destination","gain","masterGain"];for(const Fe of ge)if(ne[Fe]&&ne[Fe]instanceof AudioNode){if(console.log(`   ✅ Found AudioNode at superdough.${Fe}: ${ne[Fe].constructor.name}`),this.trackedPatterns.size>0){const Be=Array.from(this.trackedPatterns.keys())[0],wt=this.getElementAudioNodes(Be);if(wt!=null&&wt.gainNode)try{ne[Fe].disconnect(),ne[Fe].connect(wt.gainNode),console.log(`   ✅ Routed superdough.${Fe} to ${Be} gainNode`)}catch(Nt){console.log(`   ✅ superdough.${Fe} already routed (${Nt.message})`)}}else if(this.masterPanNode)try{ne[Fe].disconnect(),ne[Fe].connect(this.masterPanNode),console.log(`   ✅ Routed superdough.${Fe} to masterPanNode`)}catch(Be){console.log(`   ✅ superdough.${Fe} already routed to master (${Be.message})`)}}}else console.log("   ⚠️ No superdough found in scheduler")}else return console.error("❌ Strudel scheduler not available"),{success:!1,error:"Strudel scheduler not available"};const{setupStatements:Zt,patternExpression:Dt}=this.parseMultiStatementPattern(mt);Zt.length>0&&(console.log("🎼 Multi-statement pattern detected:"),console.log(`   Setup statements (${Zt.length}): ${Zt.map(H=>H.substring(0,40)+"...").join(", ")}`),console.log(`   Pattern expression: ${Dt.substring(0,100)}...`));for(const H of Zt)try{console.log(`   ⚙️ Evaluating setup: ${H.substring(0,60)}...`),await window.strudel.evaluate(H)}catch(ee){console.warn(`   ⚠️ Setup statement evaluation warning: ${ee.message}`)}const He=`${Hn} = ${Dt||mt}`;console.log("🎼 Evaluating master pattern:"),console.log(`   Full code: ${He}`),console.log(`   Code length: ${He.length} characters`),console.log(`   Evaluation slot: ${Hn}`);const Tt=((o=window.strudel)==null?void 0:o.repl)||window.strudel;if((i=Tt==null?void 0:Tt.scheduler)!=null&&i.superdough){const H=Tt.scheduler.superdough;if(H.audioWorkletsLoaded===!1||H.audioWorkletsLoaded===void 0){console.log("⏳ Waiting for AudioWorklets to load...");let ee=0;for(;(H.audioWorkletsLoaded===!1||H.audioWorkletsLoaded===void 0)&&ee<50;)await new Promise(ne=>setTimeout(ne,100)),ee++;H.audioWorkletsLoaded===!0?console.log(`✅ AudioWorklets loaded after ${ee*100}ms`):console.warn(`⚠️ AudioWorklets may not be loaded after ${ee*100}ms - proceeding anyway`)}else console.log("✅ AudioWorklets already loaded")}const kn=/\.scope\s*\(/.test(He),vs=/\.spectrum\s*\(/.test(He),ln=/\.spiral\s*\(/.test(He),Gs=/\._?pianoroll\s*\(/.test(He),na=/\._?barchart\s*\(/.test(He);if(kn||vs||ln||Gs||na){console.log(`   📊 Visualizer methods detected: scope=${kn}, spectrum=${vs}, spiral=${ln}, pianoroll=${Gs}, barchart=${na}`);const H=/master-punchcard-canvas/.test(He);console.log(`   🎯 Canvas ID present in pattern: ${H}`);const ee=He.match(/\.scope\([^)]*\)/),ne=He.match(/\.spectrum\([^)]*\)/),ge=He.match(/\.spiral\([^)]*\)/),Fe=He.match(/\._?pianoroll\([^)]*\)/),Be=He.match(/\._?barchart\([^)]*\)/);ee&&console.log(`   📊 Scope call: ${ee[0]}`),ne&&console.log(`   📊 Spectrum call: ${ne[0]}`),ge&&console.log(`   📊 Spiral call: ${ge[0]}`),Fe&&console.log(`   📊 Pianoroll call: ${Fe[0]}`),Be&&console.log(`   📊 Barchart call: ${Be[0]}`)}let x;try{if(x=await window.strudel.evaluate(He),console.log(`✅ Master pattern evaluated successfully, result type: ${typeof x}`),this.audioContext&&this.audioContext.state!=="running"){console.warn(`⚠️ Audio context not running after evaluation (${this.audioContext.state}), resuming...`);try{await this.audioContext.resume(),await new Promise(H=>setTimeout(H,50)),this.audioContext.state==="running"?console.log("✅ Audio context resumed after evaluation"):console.error(`❌ Audio context still not running: ${this.audioContext.state}`)}catch(H){console.error("❌ Failed to resume audio context after evaluation:",H)}}if(window.strudel&&window.strudel.scheduler)if(window.strudel.scheduler.started)console.log("✅ Scheduler is running");else{console.warn("⚠️ Scheduler not started after evaluation, starting...");try{await window.strudel.scheduler.start(),console.log("✅ Scheduler started after evaluation")}catch(H){console.error("❌ Failed to start scheduler:",H)}}}catch(H){console.warn("⚠️ Pattern evaluation warning:",H.message),console.warn(`⚠️ Pattern code that failed: ${He.substring(0,300)}`)}try{const H=(l=window.strudel)==null?void 0:l.scheduler,ee=globalThis==null?void 0:globalThis[Hn];if(H&&ee){console.log("🔍 PRE-PATTERN-SET: Checking scheduler state..."),console.log(`   scheduler.started: ${H.started}`),console.log(`   scheduler.pattern: ${H.pattern?"exists":"null"}`),console.log(`   scheduler keys before: ${Object.keys(H).slice(0,15).join(", ")}`);const ne=["webaudio","_webaudio","superdough","_superdough","output","outputNode","audioContext"];for(const ge of ne)H[ge]&&(console.log(`   ✅ Found ${ge} in scheduler: ${typeof H[ge]}`),H[ge]instanceof AudioNode&&console.log(`      → AudioNode: ${H[ge].constructor.name}`));try{if(H.pattern=ee,console.log(`🎚️ Scheduler pattern set directly to ${Hn}`),!H.started){console.warn("⚠️ Scheduler not started after setting pattern, starting...");try{await H.start(),console.log("✅ Scheduler started after pattern set")}catch(ge){console.error("❌ Failed to start scheduler after pattern set:",ge)}}if(this.audioContext&&this.audioContext.state!=="running"){console.warn(`⚠️ Audio context not running after pattern set (${this.audioContext.state}), resuming...`);try{await this.audioContext.resume(),await new Promise(ge=>setTimeout(ge,50)),this.audioContext.state==="running"?console.log("✅ Audio context resumed after pattern set"):console.error(`❌ Audio context still not running: ${this.audioContext.state}`)}catch(ge){console.error("❌ Failed to resume audio context:",ge)}}console.log("🔍 POST-PATTERN-SET: Checking scheduler state after pattern assignment..."),console.log(`   scheduler.pattern: ${H.pattern?"exists":"null"}`),console.log(`   scheduler.started: ${H.started}`),console.log(`   audioContext.state: ${((c=this.audioContext)==null?void 0:c.state)||"N/A"}`),await new Promise(ge=>setTimeout(ge,100));for(const ge of ne)if(H[ge]&&!H[`_checked_${ge}`]){if(console.log(`   ✅ Found ${ge} after pattern set: ${typeof H[ge]}`),H[ge]instanceof AudioNode&&(console.log(`      → AudioNode: ${H[ge].constructor.name}`),this.trackedPatterns.size>0)){const Fe=Array.from(this.trackedPatterns.keys())[0],Be=this.getElementAudioNodes(Fe);if(Be!=null&&Be.gainNode)try{H[ge].disconnect(),H[ge].connect(Be.gainNode),console.log(`      ✅ Routed scheduler.${ge} to ${Fe} gainNode`)}catch(wt){console.log(`      ✅ scheduler.${ge} already routed (${wt.message})`)}}H[`_checked_${ge}`]=!0}}catch{await window.strudel.evaluate(`pattern = ${Hn}`),console.log(`🎚️ Scheduler pattern set via REPL to ${Hn}`)}}else console.log("ℹ️ Could not set scheduler pattern directly (scheduler/slot missing)")}catch(H){console.warn(`⚠️ Failed to set scheduler pattern to ${Hn}:`,(H==null?void 0:H.message)||H)}console.log(`🔍 POST-EVALUATION: trackedPatterns.size=${this.trackedPatterns.size}`),console.log("🔍 POST-EVALUATION: Searching for audio nodes connected to destination...");try{if(this._realDestination&&this._realDestination._inputs){const H=this._realDestination._inputs;console.log(`   Found ${H.length} input(s) to destination`);for(let ee=0;ee<H.length;ee++){const ne=H[ee];if(ne&&ne._node){const ge=ne._node;if(console.log(`   Input ${ee}: ${ge.constructor.name}`),this.trackedPatterns.size>0){const Fe=Array.from(this.trackedPatterns.keys())[0],Be=this.getElementAudioNodes(Fe);if(Be!=null&&Be.gainNode)try{ge.disconnect(this._realDestination),ge.connect(Be.gainNode),console.log(`   ✅ Rerouted ${ge.constructor.name} through ${Fe} gainNode`)}catch(wt){console.log(`   ⚠️ Could not reroute ${ge.constructor.name}: ${wt.message}`)}}}}}else console.log("   ⚠️ Cannot access destination inputs (might be browser-specific)")}catch(H){console.log(`   ⚠️ Error checking destination inputs: ${H.message}`)}if(console.log(`🔍 POST-EVALUATION: Audio context state=${((u=this.audioContext)==null?void 0:u.state)||"unknown"}`),console.log(`🔍 POST-EVALUATION: masterGainNode.gain=${((f=(m=(h=this.masterGainNode)==null?void 0:h.gain)==null?void 0:m.value)==null?void 0:f.toFixed(3))||"N/A"}, muted=${this.masterMuted}`),console.log(`🔍 POST-EVALUATION: masterVolume=${this.masterVolume}, volume=${this.volume}`),this.trackedPatterns.size>=1){const H=Array.from(this.trackedPatterns.keys());console.log(`🔍 POST-EVALUATION: elementIds=${H.join(", ")}`);for(const ee of H){const ne=this.elementGainValues.get(ee)||.8,ge=this.getElementAudioNodes(ee),Fe=((O=(v=ge==null?void 0:ge.gainNode)==null?void 0:v.gain)==null?void 0:O.value)||0;console.log(`🔍 POST-EVALUATION: ${ee} - storedGain=${ne.toFixed(3)}, actualGain=${Fe.toFixed(3)}, volume=${this.volume.toFixed(3)}, totalGain=${(Fe*((M=(k=this.masterGainNode)==null?void 0:k.gain)==null?void 0:M.value)||0).toFixed(3)}`)}try{const ee=((E=window.strudel)==null?void 0:E.repl)||window.strudel;if(ee!=null&&ee.scheduler){const ne=ee.scheduler;console.log("🔍 POST-EVALUATION: Exploring scheduler object..."),console.log(`   scheduler keys: ${Object.keys(ne).slice(0,20).join(", ")}`);let ge=ne.webaudio||ne._webaudio,Fe=null;if(ge)Fe=ge.output||ge.outputNode,console.log(`🔍 POST-EVALUATION: Found webaudio, outputNode=${Fe?Fe.constructor.name:"null"}`);else{console.log("🔍 POST-EVALUATION: webaudio not found, searching scheduler for output node...");for(const Be of Object.keys(ne)){const wt=ne[Be];if(wt&&typeof wt=="object"){if(wt.output&&wt.output instanceof AudioNode){console.log(`🔍 POST-EVALUATION: Found output node in scheduler.${Be}.output`),Fe=wt.output;break}if(wt.outputNode&&wt.outputNode instanceof AudioNode){console.log(`🔍 POST-EVALUATION: Found output node in scheduler.${Be}.outputNode`),Fe=wt.outputNode;break}}}}console.log(`🎚️ 🔍 POST-EVALUATION: Final outputNode=${Fe?Fe.constructor.name:"null"}`);for(const Be of H){const wt=this.getElementAudioNodes(Be);if(console.log(`🎚️ 🔍 POST-EVALUATION: ${Be}: elementNodes=${!!wt}, gainNode=${!!(wt!=null&&wt.gainNode)}`),wt&&wt.gainNode){if(Fe)try{Fe.disconnect(),Fe.connect(wt.gainNode),console.log(`🎚️ ✅ POST-EVALUATION: Reconnected Strudel output -> ${Be} gainNode`)}catch(yn){console.warn(`⚠️ POST-EVALUATION: Could not reconnect Strudel output: ${yn.message}`)}else console.warn("⚠️ POST-EVALUATION: Output node not found - audio may not route through element chain");const Nt=wt.panNode;if(Nt&&this.masterPanNode)try{try{Nt.disconnect(this.masterPanNode)}catch{}Nt.connect(this.masterPanNode),console.log(`🎚️ ✅ POST-EVALUATION: Verified ${Be} panNode -> masterPanNode`)}catch(yn){console.warn(`⚠️ POST-EVALUATION: Could not verify panNode: ${yn.message}`)}}}if(this.masterGainNode&&this._realDestination)try{this.masterGainNode.connect(this._realDestination),console.log(`🎚️ ✅ POST-EVALUATION: Verified masterGainNode -> destination (gain=${this.masterGainNode.gain.value.toFixed(3)}, muted=${this.masterMuted})`)}catch(Be){Be.message.includes("already connected")||Be.message.includes("already been connected")?console.log(`🎚️ ✅ POST-EVALUATION: masterGainNode -> destination already connected (gain=${this.masterGainNode.gain.value.toFixed(3)}, muted=${this.masterMuted})`):console.warn(`⚠️ POST-EVALUATION: Could not verify masterGainNode -> destination: ${Be.message}`)}}else console.warn("⚠️ POST-EVALUATION: Could not find scheduler")}catch(ee){console.warn(`⚠️ POST-EVALUATION: Error reconnecting Strudel output: ${ee.message}`)}}if(setTimeout(()=>{this.currentEvaluatingSlot===this.masterSlot&&(this.currentEvaluatingSlot=null)},this.soundsPreloaded?100:500),this.trackedPatterns.size===1){const H=Array.from(this.trackedPatterns.keys())[0],ee=this.getElementAudioNodes(H);console.log(`🔍 AUDIO CHAIN VERIFICATION for ${H}:`),console.log("   📊 AUDIO ROUTING CHAIN (simplified, no masterAnalyser):"),console.log(`      1. Strudel output -> elementGainNode (gain=${((F=(D=(I=ee==null?void 0:ee.gainNode)==null?void 0:I.gain)==null?void 0:D.value)==null?void 0:F.toFixed(3))||"N/A"})`),console.log(`      2. elementGainNode -> elementPanNode (pan=${((Z=($=(_=ee==null?void 0:ee.panNode)==null?void 0:_.pan)==null?void 0:$.value)==null?void 0:Z.toFixed(3))||"N/A"})`),console.log("      3. elementPanNode -> masterPanNode"),console.log(`      4. masterPanNode -> masterGainNode (gain=${((ue=(U=(ce=this.masterGainNode)==null?void 0:ce.gain)==null?void 0:U.value)==null?void 0:ue.toFixed(3))||"N/A"}, muted=${this.masterMuted})`),console.log("      5. masterGainNode -> destination (audio output)"),console.log("      6. masterGainNode -> visualizerAnalyser (parallel, for visualization)"),console.log("   ✅ SIMPLIFIED CHAIN: element gain -> element pan -> master pan -> master gain -> destination"),console.log(`   elementGainNode: ${ee!=null&&ee.gainNode?"EXISTS":"MISSING"} (gain=${((be=(de=(W=ee==null?void 0:ee.gainNode)==null?void 0:W.gain)==null?void 0:de.value)==null?void 0:be.toFixed(3))||"N/A"})`),console.log(`   elementPanNode: ${ee!=null&&ee.panNode?"EXISTS":"MISSING"} (pan=${((Ae=(Ce=(ke=ee==null?void 0:ee.panNode)==null?void 0:ke.pan)==null?void 0:Ce.value)==null?void 0:Ae.toFixed(3))||"N/A"})`),console.log(`   masterPanNode: ${this.masterPanNode?"EXISTS":"MISSING"}`),console.log(`   masterGainNode: ${this.masterGainNode?"EXISTS":"MISSING"} (gain=${((Re=(Ne=(q=this.masterGainNode)==null?void 0:q.gain)==null?void 0:Ne.value)==null?void 0:Re.toFixed(3))||"N/A"}, muted=${this.masterMuted})`),console.log(`   visualizerAnalyser: ${this.visualizerAnalyser?"EXISTS":"MISSING"}`),console.log(`   destination: ${this._realDestination?"EXISTS":"MISSING"}`),console.log(`   TOTAL GAIN: ${((((me=(je=ee==null?void 0:ee.gainNode)==null?void 0:je.gain)==null?void 0:me.value)||0)*(((ft=(Ye=this.masterGainNode)==null?void 0:Ye.gain)==null?void 0:ft.value)||0)).toFixed(3)} (element=${((pt=(Ge=(_e=ee==null?void 0:ee.gainNode)==null?void 0:_e.gain)==null?void 0:Ge.value)==null?void 0:pt.toFixed(3))||"0"} * master=${((on=(tn=(rt=this.masterGainNode)==null?void 0:rt.gain)==null?void 0:tn.value)==null?void 0:on.toFixed(3))||"0"})`);try{const ne=((xn=window.strudel)==null?void 0:xn.repl)||window.strudel;if(ne!=null&&ne.scheduler){const ge=ne.scheduler,Fe=ge.webaudio||ge._webaudio;if(Fe){const Be=Fe.output||Fe.outputNode;Be?(console.log(`   Strudel outputNode: EXISTS (${Be.constructor.name})`),ee!=null&&ee.gainNode&&console.log("   ✅ Chain should be: Strudel output -> elementGain -> elementPan -> masterPan -> masterGain -> destination")):console.warn("   ⚠️ Strudel outputNode: NOT FOUND")}else console.warn("   ⚠️ Strudel webaudio: NOT FOUND")}}catch(ne){console.warn(`   ⚠️ Could not verify Strudel output: ${ne.message}`)}if(console.log("   🔍 VERIFYING MASTER CHAIN:"),console.log(`      masterPanNode: ${this.masterPanNode?"EXISTS":"MISSING"}`),console.log(`      masterFilterNode: ${this.masterFilterNode?"EXISTS":"MISSING"} (enabled=${this.masterFilterEnabled})`),console.log(`      masterGainNode: ${this.masterGainNode?"EXISTS":"MISSING"} (gain=${((Ft=(In=(Gt=this.masterGainNode)==null?void 0:Gt.gain)==null?void 0:In.value)==null?void 0:Ft.toFixed(3))||"N/A"})`),console.log(`      destination: ${this._realDestination?"EXISTS":"MISSING"}`),this.masterPanNode&&this.masterFilterNode)try{this.masterPanNode.connect(this.masterFilterNode),console.log("   ✅ VERIFIED: masterPanNode -> masterFilterNode")}catch(ne){ne.message.includes("already connected")||ne.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterPanNode -> masterFilterNode (already connected)"):console.warn(`   ⚠️ Could not verify masterPanNode -> masterFilterNode: ${ne.message}`)}if(this.masterFilterNode&&this.masterDryGainNode)try{this.masterFilterNode.connect(this.masterDryGainNode),console.log("   ✅ VERIFIED: masterFilterNode -> masterDryGainNode")}catch(ne){ne.message.includes("already connected")||ne.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterFilterNode -> masterDryGainNode (already connected)"):console.warn(`   ⚠️ Could not verify masterFilterNode -> masterDryGainNode: ${ne.message}`)}if(this.masterDryGainNode&&this.masterGainNode)try{this.masterDryGainNode.connect(this.masterGainNode),console.log("   ✅ VERIFIED: masterDryGainNode -> masterGainNode")}catch(ne){ne.message.includes("already connected")||ne.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterDryGainNode -> masterGainNode (already connected)"):console.warn(`   ⚠️ Could not verify masterDryGainNode -> masterGainNode: ${ne.message}`)}if(this.masterFilterNode&&this.masterDelayNode)try{this.masterFilterNode.connect(this.masterDelayNode),console.log("   ✅ VERIFIED: masterFilterNode -> masterDelayNode")}catch(ne){ne.message.includes("already connected")||ne.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterFilterNode -> masterDelayNode (already connected)"):console.warn(`   ⚠️ Could not verify masterFilterNode -> masterDelayNode: ${ne.message}`)}if(this.masterReverbGainNode&&this.masterGainNode)try{this.masterReverbGainNode.connect(this.masterGainNode),console.log("   ✅ VERIFIED: masterReverbGainNode -> masterGainNode")}catch(ne){ne.message.includes("already connected")||ne.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterReverbGainNode -> masterGainNode (already connected)"):console.warn(`   ⚠️ Could not verify masterReverbGainNode -> masterGainNode: ${ne.message}`)}if(this.masterGainNode&&this._realDestination)try{this.masterGainNode.connect(this._realDestination),console.log("   ✅ CONNECTED: masterGainNode -> destination (CRITICAL for audio output)")}catch(ne){if(ne.message&&ne.message.includes("already connected")||ne.message.includes("InvalidStateError"))console.log("   ✅ VERIFIED: masterGainNode -> destination (already connected)");else try{this.masterGainNode.connect(this._realDestination),console.log("   ✅ RECONNECTED: masterGainNode -> destination")}catch(ge){ge.message.includes("already connected")||ge.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterGainNode -> destination (already connected)"):console.error(`   ❌ FAILED: Could not connect masterGainNode -> destination: ${ge.message}`)}}else console.warn(`   ⚠️ Cannot verify masterGainNode->destination: masterGainNode=${!!this.masterGainNode}, destination=${!!this._realDestination}`)}if(console.log("🔍 FINAL CHAIN VERIFICATION:"),this.trackedPatterns.size>0){const H=Array.from(this.trackedPatterns.keys());for(const ee of H){const ne=this.getElementAudioNodes(ee);console.log(`   ${ee}:`),console.log(`      elementGain: ${ne!=null&&ne.gainNode?"EXISTS":"MISSING"} (gain=${((un=(Gn=(jt=ne==null?void 0:ne.gainNode)==null?void 0:jt.gain)==null?void 0:Gn.value)==null?void 0:un.toFixed(3))||"N/A"})`),console.log(`      elementPan: ${ne!=null&&ne.panNode?"EXISTS":"MISSING"} (pan=${((Un=(at=(fn=ne==null?void 0:ne.panNode)==null?void 0:fn.pan)==null?void 0:at.value)==null?void 0:Un.toFixed(3))||"N/A"})`)}}if(console.log(`   masterPanNode: ${this.masterPanNode?"EXISTS":"MISSING"}`),console.log(`   masterGainNode: ${this.masterGainNode?"EXISTS":"MISSING"} (gain=${((Vt=(Mt=(nt=this.masterGainNode)==null?void 0:nt.gain)==null?void 0:Mt.value)==null?void 0:Vt.toFixed(3))||"N/A"}, muted=${this.masterMuted})`),console.log(`   visualizerAnalyser: ${this.visualizerAnalyser?"EXISTS":"MISSING"}`),console.log(`   destination: ${this._realDestination?"EXISTS":"MISSING"}`),this.masterPanNode&&this.masterFilterNode)try{this.masterPanNode.connect(this.masterFilterNode),console.log("   ✅ VERIFIED: masterPanNode -> masterFilterNode (reconnected)")}catch(H){H.message.includes("already connected")||H.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterPanNode -> masterFilterNode (already connected)"):console.warn(`   ⚠️ Could not verify masterPanNode -> masterFilterNode: ${H.message}`)}if(this.masterFilterNode&&this.masterGainNode)try{this.masterDelayNode&&this.masterReverbNode?(this.masterFilterNode.connect(this.masterDelayNode),this.masterDelayNode.connect(this.masterDelayGainNode),this.masterDelayGainNode.connect(this.masterReverbNode),this.masterReverbNode.connect(this.masterReverbGainNode),this.masterReverbGainNode.connect(this.masterGainNode),this.masterDelayNode.connect(this.masterDelayFeedbackGainNode),this.masterDelayFeedbackGainNode.connect(this.masterDelayNode),console.log("   ✅ VERIFIED: masterFilterNode -> masterDelayNode -> masterReverbNode -> masterGainNode (reconnected)")):(this.masterFilterNode.connect(this.masterGainNode),console.log("   ✅ VERIFIED: masterFilterNode -> masterGainNode (reconnected, delay/reverb not available)"))}catch(H){H.message.includes("already connected")||H.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterFilterNode -> masterGainNode (already connected)"):console.warn(`   ⚠️ Could not verify masterFilterNode -> masterGainNode: ${H.message}`)}if(this.masterGainNode&&this._realDestination)try{this.masterGainNode.connect(this._realDestination),console.log(`   ✅ VERIFIED: masterGainNode -> destination (reconnected, gain=${this.masterGainNode.gain.value.toFixed(3)})`)}catch(H){H.message.includes("already connected")||H.message.includes("already been connected")?console.log(`   ✅ VERIFIED: masterGainNode -> destination (already connected, gain=${this.masterGainNode.gain.value.toFixed(3)})`):console.warn(`   ⚠️ Could not verify masterGainNode -> destination: ${H.message}`)}console.log("   🔍 FINAL: Searching for Strudel output node...");try{const H=((En=window.strudel)==null?void 0:En.repl)||window.strudel;if(console.log(`   🔍 FINAL: replInstance=${!!H}`),H!=null&&H.scheduler){const ee=H.scheduler;console.log(`   🔍 FINAL: scheduler=${!!ee}, keys=${Object.keys(ee).slice(0,10).join(", ")}`);let ne=null,ge=null;const Fe=ee.webaudio||ee._webaudio;if(Fe&&(ne=Fe.output||Fe.outputNode,ne&&(ge="scheduler.webaudio")),!ne&&ee.superdough){const Be=ee.superdough;if(console.log(`   🔍 FINAL: superdough found, keys=${Object.keys(Be).slice(0,20).join(", ")}`),ne=Be.output||Be.outputNode||Be._output||Be.destination||Be._destination,ne&&(ge="scheduler.superdough"),!ne&&Be.webaudio&&(console.log(`   🔍 FINAL: superdough.webaudio found, keys=${Object.keys(Be.webaudio).slice(0,10).join(", ")}`),ne=Be.webaudio.output||Be.webaudio.outputNode||Be.webaudio.destination,ne&&(ge="scheduler.superdough.webaudio")),!ne&&Be.audioContext&&console.log("   🔍 FINAL: superdough.audioContext found"),!ne)for(const wt of Object.keys(Be)){const Nt=Be[wt];if(Nt&&typeof Nt=="object"&&(((lt=Nt.constructor)==null?void 0:lt.name)==="GainNode"||((It=Nt.constructor)==null?void 0:It.name)==="AudioNode"||Nt instanceof AudioNode)){console.log(`   🔍 FINAL: Found potential output node at superdough.${wt} (${Nt.constructor.name})`),ne=Nt,ge=`scheduler.superdough.${wt}`;break}}}if(!ne&&ee._superdough){const Be=ee._superdough;ne=Be.output||Be.outputNode||Be._output,ne&&(ge="scheduler._superdough")}if(console.log(`   🔍 FINAL: outputNode=${ne?ne.constructor.name:"null"}, source=${ge||"not found"}`),ne&&this.trackedPatterns.size>0){const Be=Array.from(this.trackedPatterns.keys())[0],wt=this.getElementAudioNodes(Be);if(console.log(`   🔍 FINAL: ${Be}, elementNodes=${!!wt}, gainNode=${!!(wt!=null&&wt.gainNode)}`),wt!=null&&wt.gainNode)try{ne.disconnect(),ne.connect(wt.gainNode),console.log(`   ✅ FINAL: Reconnected Strudel output (${ge}) -> ${Be} gainNode (THIS IS CRITICAL FOR AUDIO)`)}catch(Nt){console.log(`   ✅ FINAL: Strudel output already routed to ${Be} gainNode (${Nt.message})`)}else console.error("   ❌ FINAL: Cannot reconnect - elementNodes or gainNode missing!")}else if(console.warn(`   ⚠️ FINAL: Cannot reconnect - outputNode=${!!ne}, trackedPatterns.size=${this.trackedPatterns.size}`),!ne&&(console.warn("   ⚠️ FINAL: Strudel output node not found in any expected location."),console.warn("   ⚠️ FINAL: This might mean Strudel creates audio nodes dynamically. Audio routing hijacking should catch connections."),console.warn('   ⚠️ FINAL: If you see "DESTINATION CONNECTION" logs, the hijacking is working. If not, Strudel might be using a different routing mechanism.'),console.log("   🔧 FINAL: Ensuring master chain is connected (fallback for dynamic audio nodes)..."),this.masterPanNode&&this.masterGainNode&&this._realDestination))try{this.masterGainNode.connect(this._realDestination),console.log(`   ✅ FINAL: Master chain verified and connected (gain=${this.masterGainNode.gain.value.toFixed(3)})`)}catch(Be){console.log(`   ✅ FINAL: Master chain already connected (${Be.message})`)}}else console.warn("   ⚠️ FINAL: scheduler not found in replInstance")}catch(H){console.error(`   ❌ FINAL: Error reconnecting Strudel output: ${H.message}`),console.error(`   ❌ FINAL: Stack: ${H.stack}`)}const B=this.audioContext?this.audioContext.currentTime:performance.now()/1e3;this.masterPlaybackStartTime=B,this.masterPlaybackTempo=this.currentTempo||120;const T=this.masterPlaybackTempo/120;this.masterPlaybackSpeed=Number.isFinite(T)&&T>0?T:1,console.log(`✅ Master pattern playing on ${this.masterSlot} (volume/pan/mute via Web Audio API)`),console.log(`🔊 Audio context state: ${((Le=this.audioContext)==null?void 0:Le.state)||"unknown"}`),console.log(`🔊 Master gain value: ${((tt=(qt=this.masterGainNode)==null?void 0:qt.gain)==null?void 0:tt.value)||"unknown"}`),console.log(`🔊 Master muted: ${this.masterMuted||!1}`),console.log("ℹ️ Note: If you see createPeriodicWave errors, they are suppressed but may affect audio playback"),this._audioNodeMonitorInterval&&clearInterval(this._audioNodeMonitorInterval);let R=0;const j=20;return this._audioNodeMonitorInterval=setInterval(()=>{var H;if(R++,R>j){clearInterval(this._audioNodeMonitorInterval),this._audioNodeMonitorInterval=null,console.log(`🔍 Audio node monitoring stopped after ${j} checks`);return}try{const ee=(H=window.strudel)==null?void 0:H.scheduler;if(ee){const ne=["webaudio","_webaudio","superdough","_superdough","output","outputNode"];for(const ge of ne)if(ee[ge]&&!ee[`_monitored_${ge}`]){if(console.log(`🔍 MONITOR: Found ${ge} in scheduler at check ${R}: ${typeof ee[ge]}`),ee[ge]instanceof AudioNode&&(console.log(`   → AudioNode: ${ee[ge].constructor.name}`),this.trackedPatterns.size>0)){const Fe=Array.from(this.trackedPatterns.keys())[0],Be=this.getElementAudioNodes(Fe);if(Be!=null&&Be.gainNode)try{ee[ge].disconnect(),ee[ge].connect(Be.gainNode),console.log(`   ✅ MONITOR: Routed scheduler.${ge} to ${Fe} gainNode`)}catch(wt){console.log(`   ✅ MONITOR: scheduler.${ge} already routed (${wt.message})`)}}ee[`_monitored_${ge}`]=!0}if(ee.superdough&&!ee._monitored_superdough){const ge=ee.superdough;console.log(`🔍 MONITOR: Found superdough at check ${R}, keys: ${Object.keys(ge).slice(0,10).join(", ")}`);const Fe=["output","outputNode","_output","destination","_destination","gain","masterGain"];for(const Be of Fe)if(ge[Be]&&ge[Be]instanceof AudioNode&&(console.log(`   → Found AudioNode at superdough.${Be}: ${ge[Be].constructor.name}`),this.trackedPatterns.size>0)){const wt=Array.from(this.trackedPatterns.keys())[0],Nt=this.getElementAudioNodes(wt);if(Nt!=null&&Nt.gainNode)try{ge[Be].disconnect(),ge[Be].connect(Nt.gainNode),console.log(`   ✅ MONITOR: Routed superdough.${Be} to ${wt} gainNode`)}catch(yn){console.log(`   ✅ MONITOR: superdough.${Be} already routed (${yn.message})`)}}ee._monitored_superdough=!0}}}catch(ee){console.warn(`🔍 MONITOR: Error checking scheduler: ${ee.message}`)}},100),this.audioContext&&this.audioContext.state==="suspended"&&(console.warn("⚠️ AUDIO CONTEXT SUSPENDED: Audio context is suspended - attempting to resume..."),this.audioContext.resume().then(()=>{console.log("✅ Audio context resumed successfully")}).catch(H=>{console.error(`❌ Failed to resume audio context: ${H.message}`)})),this._audioChainCheckInterval&&clearInterval(this._audioChainCheckInterval),this._zeroGainLogged=!1,this._mutedLogged=!1,this._audioChainCheckInterval=setInterval(()=>{if(this.masterActive&&this.masterGainNode&&this._realDestination){try{this.masterGainNode.connect(this._realDestination)}catch{}this.masterGainNode.gain.value===0&&!this._zeroGainLogged&&(console.warn("⚠️ AUDIO CHAIN CHECK: masterGainNode.gain.value is 0 - no audio will play!"),this._zeroGainLogged=!0),this.masterMuted&&!this._mutedLogged&&(console.warn("⚠️ AUDIO CHAIN CHECK: masterGainNode is muted - no audio will play!"),this._mutedLogged=!0)}else this._audioChainCheckInterval&&(clearInterval(this._audioChainCheckInterval),this._audioChainCheckInterval=null)},1e3),this.onMasterStateChangeCallback&&this.onMasterStateChangeCallback(!0,Array.from(this.trackedPatterns.keys())),this.editorHighlightingEnabled&&Tx(),{success:!0}}else return console.error("❌ Strudel not properly initialized"),{success:!1,error:"Strudel not initialized"}}catch(zn){return console.error("❌ Error playing master pattern:",zn),{success:!1,error:zn.message}}}async _stopMasterPatternSimple(){var e;try{if(window.strudel&&typeof window.strudel.evaluate=="function"){const t=this.masterSlot||"d0";await window.strudel.evaluate(`${t} = silence`),window.strudel.scheduler&&window.strudel.scheduler.started&&typeof window.strudel.scheduler.stop=="function"&&await window.strudel.scheduler.stop()}return this.masterActive=!1,Fx(),this.masterPlaybackStartTime=null,this.stopAllMIDINotes(),this.masterGainNode&&this.masterGainNode.gain.setValueAtTime(0,((e=this.audioContext)==null?void 0:e.currentTime)||0),this.onMasterStateChangeCallback&&this.onMasterStateChangeCallback(!1,[]),{success:!0}}catch(t){return console.error("❌ Error stopping master (simple mode):",t),{success:!1,error:t.message}}}async stopMasterPattern(){var e;if(this.masterOnlyPlayback)return this._stopMasterPatternSimple();try{if(console.log("⏹️ Stopping master pattern..."),window.strudel&&window.strudel.evaluate){window.strudel.repl&&window.strudel.repl.scheduler&&typeof window.strudel.repl.scheduler.stop=="function"&&(window.strudel.repl.scheduler.stop(),console.log("✓ Stopped REPL scheduler"));const t=`${this.masterSlot} = silence`;return await window.strudel.evaluate(t),window.strudel.repl&&window.strudel.repl.scheduler&&typeof window.strudel.repl.scheduler.start=="function"&&(window.strudel.repl.scheduler.start(),console.log("✓ Restarted REPL scheduler")),this.masterPlaybackStartTime=null,this.masterActive=!1,this.editorHighlightingEnabled&&Fx(),this.masterGainNode&&this.masterGainNode.gain.setValueAtTime(0,((e=this.audioContext)==null?void 0:e.currentTime)||0),this._audioChainCheckInterval&&(clearInterval(this._audioChainCheckInterval),this._audioChainCheckInterval=null),this.stopAllMIDINotes(),console.log("✅ Master pattern stopped"),this._masterTapLogged=!1,this._masterTapSuccess=new Set,this.onMasterStateChangeCallback&&this.onMasterStateChangeCallback(!1,[]),{success:!0}}else return console.error("❌ Strudel not available"),{success:!1,error:"Strudel not available"}}catch(t){return console.error("❌ Error stopping master pattern:",t),{success:!1,error:t.message}}}getMasterPatternCode(){if(this.masterPattern&&this.masterPattern.trim()!==""){const e="// Controls Selected Tempo:";this.masterPattern.split(`
`).some(s=>s.trim().startsWith(e))||(this.masterPattern=this.formatMasterPatternWithTempoComment(this.masterPattern))}return this._ensureMasterPatternSanitized(),this.masterPattern}isMasterActive(){return!!this.masterActive}getMasterPlaybackInfo(){return{isPlaying:!!this.masterActive,startTime:this.masterPlaybackStartTime,speed:this.masterPlaybackSpeed||1,tempo:this.masterPlaybackTempo||this.currentTempo||120}}_isCompletePattern(e){if(!e||typeof e!="string")return!1;const t=e.trim();if(t.includes("all(")&&!t.startsWith("stack("))return!0;const a=t.split(`
`).filter(o=>o.trim()&&!o.trim().startsWith("//")).length>1,r=t.match(/^[a-zA-Z_$][a-zA-Z0-9_$]*\s*:/m);return!!(a&&r)}_splitManualOverridePattern(e){if(!e||typeof e!="string")return{setupCode:"",finalExpression:""};const t=e.replace(/\r/g,"").trim();if(!t)return{setupCode:"",finalExpression:""};const s=[];let a=[];const r=()=>{a.length>0&&(s.push(a.join(`
`).trim()),a=[])};if(t.split(`
`).forEach(c=>{c.trim()===""?r():a.push(c)}),r(),!s.length)return{setupCode:"",finalExpression:t};let o=s.pop();return/^[a-zA-Z_$][a-zA-Z0-9_$]*\s*:/.test(o)&&(s.push(o),o=""),{setupCode:s.join(`

`).trim(),finalExpression:o.trim()}}async setMasterPatternCode(e){try{if(console.log(`✏️ Setting master pattern code: ${e.substring(0,100)}...`),e&&e.trim()!==""){this.masterPatternManualOverride=this._isCompletePattern(e),this.masterPatternManualOverride&&console.log("📝 Detected complete pattern - will use as-is without stack() wrapping");let t=e.trim();const s=/setDefaultVoicings\s*\(\s*(['"]([^'"]*)['"]|([^)]+))\s*\)/g,a=[];let r;for(;(r=s.exec(t))!==null;)a.push({fullMatch:r[0],arg:r[2]||r[3],isQuoted:!!r[2]});for(const o of a)try{const i=o.isQuoted?`setDefaultVoicings('${o.arg}')`:`setDefaultVoicings(${o.arg})`;window.strudel&&window.strudel.evaluate&&(await window.strudel.evaluate(i),console.log(`✅ Evaluated ${i} before storing pattern`))}catch(i){console.warn("⚠️ Could not evaluate setDefaultVoicings:",i.message)}a.length>0&&(t=t.split(`
`).filter(l=>!l.trim().includes("setDefaultVoicings")).join(`
`).replace(/\n{3,}/g,`

`).trim()),this.masterPattern=this.formatMasterPatternWithTempoComment(t)}else this.masterPattern="";if(this._ensureMasterPatternSanitized(),this.appInstance&&typeof this.appInstance.syncElementsFromMasterPattern=="function")try{this.appInstance.syncElementsFromMasterPattern(this.masterPattern)}catch(t){console.warn("⚠️ Failed to sync elements from master pattern:",t)}if(this.masterActive){console.log("🔄 Master is active - re-evaluating with updated pattern (no stop).");try{await this._reEvaluateMasterPattern("master code update")}catch(t){console.warn("⚠️ Could not re-evaluate master after code update:",t.message)}}return{success:!0}}catch(t){return console.error("❌ Error setting master pattern code:",t),{success:!1,error:t.message}}}async previewPattern(e,t="preview",s=null){var a,r,o;if(this.masterOnlyPlayback)return console.log(`👀 Preview via master stack (${t})`),this.routePatternThroughMaster(t,e,{isPreview:!0,autoStart:!0});try{console.log(`👀 Previewing pattern (received): ${e.substring(0,100)}...`),console.log(`👀 Full pattern to preview: ${e}`);const i="d16";if(this.currentEvaluatingSlot=i,this.patternSlotToElementId.set(i,t),console.log(`🎵 Preview: Mapped slot ${i} to elementId ${t} for audio routing`),window.strudel&&window.strudel.evaluate)try{await window.strudel.evaluate(`${i} = silence`),console.log(`✅ Preview slot ${i} cleared`)}catch(u){console.warn("⚠️ Error clearing preview slot:",u.message)}if((!this.audioContext||this.audioContext.state==="suspended")&&await this.initialize(),this.audioContext&&this.audioContext.state==="suspended"){console.log("🔊 Audio context suspended for preview, resuming...");try{await this.audioContext.resume(),console.log(`✅ Audio context resumed for preview, state: ${this.audioContext.state}`)}catch(u){console.warn("⚠️ Could not resume audio context for preview:",u)}}const l=this.getElementAudioNodes(t);(!l||!l.gainNode)&&console.warn(`⚠️ Could not prepare audio nodes for preview element ${t}`),this.strudelLoaded||(console.log("⏳ Waiting for Strudel to initialize..."),await this.initializeStrudelAndSounds()),await this.ensurePatternResourcesLoaded(e),console.log(`🔍 Preview - Original pattern: ${e}`),console.log(`🔍 Preview - Pattern type check: isNotePattern=${this.isNotePattern(e)}, contains s(${e.includes("s(")}, contains sound(${e.includes("sound(")}, contains note(${/\bnote\s*\(/i.test(e)})`);let c=await this.processPattern(e,t,{preserveBanks:!0,attemptBankLoad:!0,applyGainInPattern:!1});if(!c)return console.error("❌ Pattern processing failed for preview"),{success:!1,error:"Pattern processing failed"};if(console.log(`🔍 Preview - After processPattern: ${c}`),console.log(`🔍 Preview - Processed pattern type check: isNotePattern=${this.isNotePattern(c)}, contains s(${c.includes("s(")}, contains sound(${c.includes("sound(")}, contains note(${/\bnote\s*\(/i.test(c)})`),!c.includes(".loop(")&&!c.includes(".loop()")&&(c=`${c}.loop()`,console.log("🔄 Added .loop() to preview pattern for continuous playback")),window.strudel&&window.strudel.evaluate){const u=`${i} = ${c}`;console.log(`🎼 Preview evaluating: ${u.substring(0,300)}...`),console.log(`🔍 Preview - Full pattern code (${u.length} chars): ${u}`);const h=u.match(/\.s\(["']([^"']+)["']\)/),m=u.match(/\.sound\(["']([^"']+)["']\)/),f=m?m[1]:h?h[1]:"unknown";console.log(`🎵 Preview waveform: ${f}`);try{if(await window.strudel.evaluate(u),console.log("✅ Preview pattern evaluated successfully"),window.strudel.scheduler&&(window.strudel.scheduler.started?console.log("🔄 Scheduler already running, ensuring pattern is active..."):(console.log("▶️ Starting Strudel scheduler for preview..."),await window.strudel.scheduler.start())),this.soundsPreloaded)await new Promise(O=>setTimeout(O,50)),setTimeout(()=>{this.currentEvaluatingSlot===i&&(this.currentEvaluatingSlot=null)},500);else{if(window.strudel.scheduler&&window.strudel.scheduler.tick)try{for(let O=0;O<2;O++)window.strudel.scheduler.tick(),await new Promise(k=>setTimeout(k,10))}catch(O){console.warn("⚠️ Could not trigger scheduler tick:",O)}await new Promise(O=>setTimeout(O,200)),setTimeout(()=>{this.currentEvaluatingSlot===i&&(this.currentEvaluatingSlot=null)},1e3)}}catch(O){return console.error("❌ Preview pattern evaluation error:",O.message),console.error(`❌ Failed pattern code: ${u}`),{success:!1,error:O.message}}console.log(`✅ Preview pattern is playing on ${i}`),console.log(`🔊 Audio context state: ${((a=this.audioContext)==null?void 0:a.state)||"unknown"}`),console.log(`🔊 Master gain value: ${((o=(r=this.masterGainNode)==null?void 0:r.gain)==null?void 0:o.value)||"unknown"}`),console.log(`🔊 Master muted: ${this.masterMuted||!1}`);const v=c.includes(".s(")||c.includes(".sound(");return console.log(`🔍 Preview pattern waveform check: ${v?"Has waveform (.s() or .sound())":"No waveform found"}`),{success:!0,previewSlot:i}}else return console.error("❌ Strudel not properly initialized"),{success:!1,error:"Strudel not initialized"}}catch(i){return console.error("❌ Error previewing pattern:",i),{success:!1,error:i.message}}}async stopPreview(){if(this.masterOnlyPlayback){console.log("⏹️ Stopping preview routed through master");for(const e of this.previewElementIds)this.removeElementFromMaster(e);return this.previewElementIds.clear(),this.masterActive&&(!this.masterPattern||!this.masterPattern.trim())?await this.stopMasterPattern():this.masterActive&&await this.playMasterPattern(),{success:!0}}try{return console.log("⏹️ Stopping preview..."),window.strudel&&window.strudel.evaluate?(await window.strudel.evaluate("d16 = silence"),console.log("✅ Preview stopped"),{success:!0}):{success:!1,error:"Strudel not available"}}catch(e){return console.error("❌ Error stopping preview:",e),{success:!1,error:e.message}}}async exportAudioWAV(e=16,t=44100){try{if(console.log(`📦 Exporting master pattern as WAV (${e} seconds)...`),!this.masterPattern||this.masterPattern.trim()==="")return{success:!1,error:"No master pattern to export"};this.strudelLoaded||await this.initializeStrudelAndSounds();const a=new OfflineAudioContext(2,t*e,t).destination;return window.strudel&&window.strudel.repl&&window.strudel.repl.audioContext?(console.log("⚠️ Using MediaRecorder fallback for audio export"),await this.exportAudioMediaRecorder(e)):await this.exportAudioMediaRecorder(e)}catch(s){return console.error("❌ Error exporting WAV:",s),{success:!1,error:s.message}}}async exportAudioMediaRecorder(e=16){return new Promise(t=>{try{if(!this.audioContext){t({success:!1,error:"Audio context not initialized"});return}if(!this.masterGainNode||!this.masterPanNode){t({success:!1,error:"Master audio nodes not found"});return}const s=this.audioContext.sampleRate,a=Math.floor(s*e),r=2,o=4096,i=[];let l=!1,c=null;try{c=this.audioContext.createScriptProcessor(o,r,r);let m=0;c.onaudioprocess=f=>{m++;const v=f.inputBuffer,O=f.outputBuffer;for(let I=0;I<r;I++){const D=v.getChannelData(I);O.getChannelData(I).set(D)}const k=Math.max(...Array.from(v.getChannelData(0).map(Math.abs)));if((m<=5||m%50===0)&&console.log(`🔍 ScriptProcessor call #${m}: max amplitude = ${k.toFixed(6)}, isRecording = ${l}`),!l)return;const M=[];for(let I=0;I<r;I++){const D=v.getChannelData(I);M.push(new Float32Array(D))}const E=Math.max(...M[0].map(Math.abs));E>1e-4?(i.length%10===0||i.length<5)&&console.log(`📦 Recording chunk ${i.length}: max amplitude = ${E.toFixed(6)}`):i.length<5&&console.log(`📦 Recording chunk ${i.length}: SILENT (max amplitude = ${E.toFixed(6)})`),i.push(M)},console.log("✅ ScriptProcessorNode created")}catch(m){console.error("❌ Failed to create ScriptProcessorNode:",m),t({success:!1,error:"ScriptProcessorNode not supported: "+m.message});return}const u=this.masterActive;console.log("▶️ Setting up recording..."),console.log("🔍 Pattern code:",this.masterPattern.substring(0,100)),console.log("🔍 Pattern already playing:",u);let h;u?(console.log("▶️ Pattern already playing, ensuring scheduler is running..."),h=Promise.resolve().then(async()=>(window.strudel&&window.strudel.scheduler&&!window.strudel.scheduler.started&&(console.log("▶️ Starting Strudel scheduler..."),await window.strudel.scheduler.start()),{success:!0}))):(console.log("▶️ Pattern not playing, starting it now..."),h=this.playMasterPattern()),h.then(()=>{setTimeout(()=>{console.log("🔧 Setting up recording routing..."),console.log("🔍 Master active:",this.masterActive),console.log("🔍 Audio context state:",this.audioContext.state);try{this.masterGainNode.disconnect(),console.log("✅ Disconnected all connections from masterGainNode")}catch(m){console.warn("⚠️ Could not disconnect all:",m);try{this.masterGainNode.disconnect(this._realDestination),console.log("✅ Disconnected masterGainNode from destination")}catch(f){console.warn("⚠️ Could not disconnect from destination:",f)}}this.masterGainNode.connect(c),c.connect(this._realDestination),console.log("✅ Connected audio routing: masterGainNode -> scriptProcessor -> destination"),console.log("🔍 Verifying connections:"),console.log("  masterGainNode numberOfOutputs:",this.masterGainNode.numberOfOutputs),console.log("  scriptProcessor inputs:",c.numberOfInputs,"outputs:",c.numberOfOutputs),console.log("  Waiting for audio to flow through scriptProcessor..."),setTimeout(()=>{console.log(`🎙️ Recording started for ${e} seconds...`),console.log("🔍 Master active:",this.masterActive),console.log("🔍 Audio context state:",this.audioContext.state),console.log("🔍 ScriptProcessor connected - waiting for audio chunks..."),l=!0,setTimeout(()=>{var $;console.log(`⏹️ Stopping recording after ${e} seconds...`),console.log(`📦 Total chunks captured: ${i.length}`),l=!1;try{try{c.disconnect(this._realDestination)}catch{}try{this.masterGainNode.disconnect(c)}catch{}try{this.masterGainNode.connect(this._realDestination)}catch{try{this.masterGainNode.disconnect(this._realDestination),this.masterGainNode.connect(this._realDestination)}catch(ce){console.warn("Could not restore connection:",ce)}}console.log("✅ Restored original audio routing: masterGainNode -> destination")}catch(Z){console.warn("Error restoring audio routing:",Z);try{this.masterGainNode.connect(this._realDestination)}catch(ce){console.error("Failed to restore connection:",ce)}}if(u?console.log("✅ Pattern was already playing, leaving it running"):this.stopMasterPattern(),i.length===0){console.error("❌ No audio data recorded"),console.error("🔍 Debug info:"),console.error("  Master active:",this.masterActive),console.error("  Audio context state:",this.audioContext.state),console.error("  Master gain node:",!!this.masterGainNode),console.error("  Master pan node:",!!this.masterPanNode),console.error("  Script processor:",!!c),console.error("  Is recording flag:",l),console.error("  Pattern code length:",(($=this.masterPattern)==null?void 0:$.length)||0),t({success:!1,error:"No audio data was recorded. ScriptProcessorNode may not be receiving audio. Check console for debug info."});return}console.log(`📦 Recorded ${i.length} chunks`);const m=i.reduce((Z,ce)=>Z+ce[0].length,0);console.log(`📦 Total samples: ${m} (expected: ~${a})`);const f=new Float32Array(m),v=new Float32Array(m);let O=0;for(const Z of i){const ce=Z[0].length;f.set(Z[0],O),Z[1]?v.set(Z[1],O):v.set(Z[0],O),O+=ce}let k=0,M=0;const E=Math.max(1,Math.floor(m/1e3));for(let Z=0;Z<m;Z+=E){const ce=Math.abs(f[Z]),U=Math.abs(v[Z]),ue=Math.max(ce,U);k=Math.max(k,ue),ue>1e-4&&M++}console.log(`🔍 Audio analysis: max amplitude = ${k.toFixed(6)}, non-zero samples = ${M}`);const I=[],D=[];for(let Z=0;Z<Math.min(10,m);Z++)I.push(Math.abs(f[Z]));for(let Z=Math.max(0,m-10);Z<m;Z++)D.push(Math.abs(f[Z]));console.log(`🔍 First 10 samples: ${I.map(Z=>Z.toFixed(4)).join(", ")}`),console.log(`🔍 Last 10 samples: ${D.map(Z=>Z.toFixed(4)).join(", ")}`),k<1e-4&&(console.warn("⚠️ Audio appears to be silent (all zeros or very quiet)"),console.warn("⚠️ Master volume:",this.masterVolume),console.warn("⚠️ Master muted:",this.masterMuted),console.warn("⚠️ This might indicate that audio is not reaching masterPanNode"));const F=this.audioContext.createBuffer(r,m,s);F.getChannelData(0).set(f),F.getChannelData(1).set(v);const _=this.audioBufferToWAV(F);if(console.log(`✅ WAV blob created: ${_.size} bytes`),_.size===0){t({success:!1,error:"WAV blob is empty"});return}this.downloadBlob(_,"master-pattern.wav","audio/wav"),k<1e-4?t({success:!0,format:"wav",warning:"Audio file created but appears to be silent. Check that the pattern is playing and master volume is not muted."}):t({success:!0,format:"wav"})},e*1e3)},200)},500)}).catch(m=>{console.error("❌ Failed to start pattern for recording:",m);try{this.masterGainNode.disconnect(c),c.disconnect(this._realDestination),this.masterGainNode.connect(this._realDestination)}catch{}t({success:!1,error:"Failed to start pattern: "+m.message})})}catch(s){console.error("❌ Error in audio export:",s),t({success:!1,error:s.message})}})}parsePatternToMIDI(e){const t=[];this.currentTempo;const o=16*480;let i=[e];if(e.includes("stack(")){const c=e.match(/stack\s*\(([^)]+)\)/);if(c){const u=c[1];i=this.splitStackPatterns(u)}}const l={bd:36,kick:36,kickdrum:36,sd:38,snare:38,snaredrum:38,hh:42,hihat:42,closedhihat:42,oh:46,openhihat:46,cr:49,crash:49,rd:51,ride:51,ht:48,hightom:48,mt:47,midtom:47,lt:45,lowtom:45,cp:39,clap:39,rim:37,rimshot:37};return i.forEach((c,u)=>{const h=/note\s*\(["']([^"']+)["']\)/g;let m;const f=[];for(;(m=h.exec(c))!==null;){const O=m[1].split(/\s+/).filter(k=>k.trim());f.push(...O)}if(f.length>0){const v=o/f.length;f.forEach((O,k)=>{const M=this.noteToMIDI(O);if(M!==null){const E=Math.round(k*v),I=Math.round(v*.8);t.push({type:"noteOn",tick:E,channel:u%16,note:M,velocity:100}),t.push({type:"noteOff",tick:E+I,channel:u%16,note:M,velocity:0})}})}else{const v=/(?:sound|s)\s*\(["']([^"']+)["']\)/g;let O;for(;(O=v.exec(c))!==null;){const M=O[1].split(/\s+/).filter(I=>I.trim()),E=o/M.length;M.forEach((I,D)=>{const F=l[I.toLowerCase()]||36,_=Math.round(D*E),$=Math.round(E*.3);t.push({type:"noteOn",tick:_,channel:9,note:F,velocity:100}),t.push({type:"noteOff",tick:_+$,channel:9,note:F,velocity:0})})}}}),t.sort((c,u)=>c.tick-u.tick),t}splitStackPatterns(e){const t=[];let s="",a=0;for(let r=0;r<e.length;r++){const o=e[r];o==="("?(a++,s+=o):o===")"?(a--,s+=o):o===","&&a===0?(t.push(s.trim()),s=""):s+=o}return s.trim()&&t.push(s.trim()),t}noteToMIDI(e){const t=e.match(/^([a-gA-G])([#b]?)(\d+)$/);if(!t)return null;const[,s,a,r]=t,i=["c","d","e","f","g","a","b"].indexOf(s.toLowerCase());if(i===-1)return null;let l=12+parseInt(r)*12+i;return a==="#"?l+=1:a==="b"&&(l-=1),Math.max(0,Math.min(127,l))}createMIDIFile(e){const t=this.currentTempo||120,s=new Uint8Array([77,84,104,100,0,0,0,6,0,1,0,1,1,224]),a=[],r=Math.round(6e7/t);a.push({deltaTime:0,type:255,metaType:81,data:[r>>16&255,r>>8&255,r&255]});let o=0;e.forEach(h=>{const m=h.tick-o;o=h.tick,h.type==="noteOn"?a.push({deltaTime:m,type:144|h.channel,data:[h.note,h.velocity]}):h.type==="noteOff"&&a.push({deltaTime:m,type:128|h.channel,data:[h.note,h.velocity]})}),a.push({deltaTime:0,type:255,metaType:47,data:[]});const i=[];a.forEach(h=>{let m=h.deltaTime;const f=[];do{let v=m&127;m>>=7,f.length>0&&(v|=128),f.push(v)}while(m>0);i.push(...f),i.push(h.type),h.metaType!==void 0&&(i.push(h.metaType),i.push(h.data.length)),i.push(...h.data)});const l=i.length,c=new Uint8Array([77,84,114,107,l>>24&255,l>>16&255,l>>8&255,l&255,...i]),u=new Uint8Array(s.length+c.length);return u.set(s,0),u.set(c,s.length),new Blob([u],{type:"audio/midi"})}downloadBlob(e,t,s){const a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}async blobToAudioBuffer(e){const t=await e.arrayBuffer();return await this.audioContext.decodeAudioData(t)}audioBufferToWAV(e){const t=e.numberOfChannels,s=e.sampleRate,a=1,r=16,o=r/8,i=t*o,l=s*i,c=e.length*i,u=44+c,h=new ArrayBuffer(u),m=new DataView(h),f=(k,M)=>{for(let E=0;E<M.length;E++)m.setUint8(k+E,M.charCodeAt(E))};f(0,"RIFF"),m.setUint32(4,u-8,!0),f(8,"WAVE"),f(12,"fmt "),m.setUint32(16,16,!0),m.setUint16(20,a,!0),m.setUint16(22,t,!0),m.setUint32(24,s,!0),m.setUint32(28,l,!0),m.setUint16(32,i,!0),m.setUint16(34,r,!0),f(36,"data"),m.setUint32(40,c,!0);let v=44;const O=[];for(let k=0;k<t;k++)O.push(e.getChannelData(k));for(let k=0;k<e.length;k++)for(let M=0;M<t;M++){const E=Math.max(-1,Math.min(1,O[M][k]));m.setInt16(v,E<0?E*32768:E*32767,!0),v+=2}return new Blob([h],{type:"audio/wav"})}async exportAudioWAVOffline(e=16,t=44100){try{return console.log("📦 Exporting master pattern as WAV using OfflineAudioContext..."),!this.masterPattern||this.masterPattern.trim()===""?{success:!1,error:"No master pattern to export"}:(this.strudelLoaded||await this.initializeStrudelAndSounds(),await this.exportAudioMediaRecorder(e))}catch(s){return console.error("❌ Error exporting WAV offline:",s),{success:!1,error:s.message}}}}const oe=new Pbe;typeof window<"u"&&(window.soundManager=oe);class Sbe{constructor(){this.updateCallbacks=new Map,this.soundTrigger=null,this.controlSoundTimers=new Map,this.activeSliders=new Set,this.tempoSliderActivated=!1,this.tapTimes=[],this.tapTimeout=null,this.tapTimeoutDelay=2e3,this.initializeControls()}setSoundTrigger(e){this.soundTrigger=e}triggerControlSound(e){if(!this.soundTrigger)return;const t=this.controlSoundTimers.get(e);t&&clearTimeout(t);const s=setTimeout(()=>{this.controlSoundTimers.delete(e);const a=fs.getControlConfig(e);if(a&&a.type){const r=`control-${e}`;this.soundTrigger(r,a)}},100);this.controlSoundTimers.set(e,s)}initializeControls(){const e=document.getElementById("tempo-slider"),t=document.getElementById("tempo-value");if(e&&t){e.classList.add("inactive"),t.classList.add("inactive");const o=()=>this.markTempoSliderActive(e,t);e.addEventListener&&(e.addEventListener("pointerdown",o,{once:!0}),e.addEventListener("focus",o,{once:!0})),e.addEventListener("input",i=>{o();const l=parseInt(i.target.value);t.textContent=l,this.notify("tempo",l)})}const s=document.getElementById("tap-tempo-btn");s&&s.addEventListener("click",()=>{this.handleTapTempo(e,t,s)});const a=document.getElementById("key-select");a&&a.addEventListener("change",o=>{const i=o.target.value;i!==""&&this.notify("key",i)});const r=document.getElementById("scale-select");r&&r.addEventListener("change",o=>{const i=o.target.value;if(i===""){this.notify("scale","chromatic");return}this.notify("scale",i)})}markTempoSliderActive(e,t){this.tempoSliderActivated||(this.tempoSliderActivated=!0,e&&e.classList.remove("inactive"),t&&t.classList.remove("inactive"))}handleTapTempo(e,t,s){this.markTempoSliderActive(e,t);const a=Date.now();if(this.tapTimeout&&(clearTimeout(this.tapTimeout),this.tapTimeout=null),this.tapTimes.push(a),this.tapTimes.length>=3){const r=[];for(let l=1;l<this.tapTimes.length;l++)r.push(this.tapTimes[l]-this.tapTimes[l-1]);const o=r.reduce((l,c)=>l+c,0)/r.length;let i=Math.round(6e4/o);i=Math.max(60,Math.min(240,i)),e&&(e.value=i),t&&(t.textContent=i),this.notify("tempo",i),this.tapTimes.length>4&&(this.tapTimes=this.tapTimes.slice(-4))}else{const r=3-this.tapTimes.length;if(s){const o=s.textContent;s.textContent=`${r} more`,setTimeout(()=>{s.textContent=o},500)}}this.tapTimeout=setTimeout(()=>{this.tapTimes=[],this.tapTimeout=null,s&&(s.textContent="TAP")},this.tapTimeoutDelay)}onUpdate(e,t){this.updateCallbacks.has(e)||this.updateCallbacks.set(e,[]),this.updateCallbacks.get(e).push(t)}notify(e,t){const s=this.updateCallbacks.get(e);s&&s.forEach(a=>a(t))}updateStatus(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}updateActiveElements(e){const t=document.getElementById("active-elements");t&&(e.length===0?t.textContent="None":t.textContent=e.join(", "))}setElementState(e,t){const s=e.querySelector(".element-indicator");s&&(s.className="element-indicator",t==="hover"?s.classList.add("hover"):t==="proximity"&&s.classList.add("proximity")),e.className="sound-element",t==="hover"?e.classList.add("is-hovered"):t==="proximity"&&e.classList.add("is-proximity")}}const Os=new Sbe;var S9={};typeof BigInt>"u"&&(BigInt=function(n){if(isNaN(n))throw new Error("");return n});const an=BigInt(0),An=BigInt(1),sg=BigInt(2),z2=BigInt(5),Kr=BigInt(10),Cbe=2e3,St={s:An,n:an,d:An};function pc(n,e){try{n=BigInt(n)}catch{throw Uc()}return n*e}function Di(n){return typeof n=="bigint"?n:Math.floor(n)}function Ws(n,e){if(e===an)throw gA();const t=Object.create(Rs.prototype);t.s=n<an?-An:An,n=n<an?-n:n;const s=ch(n,e);return t.n=n/s,t.d=e/s,t}function td(n){const e={};let t=n,s=sg,a=z2-An;for(;a<=t;){for(;t%s===an;)t/=s,e[s]=(e[s]||an)+An;a+=An+sg*s++}return t!==n?t>1&&(e[t]=(e[t]||an)+An):e[n]=(e[n]||an)+An,e}const Ia=function(n,e){let t=an,s=An,a=An;if(n!=null)if(e!==void 0){if(typeof n=="bigint")t=n;else{if(isNaN(n))throw Uc();if(n%1!==0)throw C9();t=BigInt(n)}if(typeof e=="bigint")s=e;else{if(isNaN(e))throw Uc();if(e%1!==0)throw C9();s=BigInt(e)}a=t*s}else if(typeof n=="object"){if("d"in n&&"n"in n)t=BigInt(n.n),s=BigInt(n.d),"s"in n&&(t*=BigInt(n.s));else if(0 in n)t=BigInt(n[0]),1 in n&&(s=BigInt(n[1]));else if(typeof n=="bigint")t=n;else throw Uc();a=t*s}else if(typeof n=="number"){if(isNaN(n))throw Uc();if(n<0&&(a=-An,n=-n),n%1===0)t=BigInt(n);else if(n>0){let r=1,o=0,i=1,l=1,c=1,u=1e7;for(n>=1&&(r=10**Math.floor(1+Math.log10(n)),n/=r);i<=u&&c<=u;){let h=(o+l)/(i+c);if(n===h){i+c<=u?(t=o+l,s=i+c):c>i?(t=l,s=c):(t=o,s=i);break}else n>h?(o+=l,i+=c):(l+=o,c+=i),i>u?(t=l,s=c):(t=o,s=i)}t=BigInt(t)*BigInt(r),s=BigInt(s)}}else if(typeof n=="string"){let r=0,o=an,i=an,l=an,c=An,u=An,h=n.replace(/_/g,"").match(/\d+|./g);if(h===null)throw Uc();if(h[r]==="-"?(a=-An,r++):h[r]==="+"&&r++,h.length===r+1?i=pc(h[r++],a):h[r+1]==="."||h[r]==="."?(h[r]!=="."&&(o=pc(h[r++],a)),r++,(r+1===h.length||h[r+1]==="("&&h[r+3]===")"||h[r+1]==="'"&&h[r+3]==="'")&&(i=pc(h[r],a),c=Kr**BigInt(h[r].length),r++),(h[r]==="("&&h[r+2]===")"||h[r]==="'"&&h[r+2]==="'")&&(l=pc(h[r+1],a),u=Kr**BigInt(h[r+1].length)-An,r+=3)):h[r+1]==="/"||h[r+1]===":"?(i=pc(h[r],a),c=pc(h[r+2],An),r+=3):h[r+3]==="/"&&h[r+1]===" "&&(o=pc(h[r],a),i=pc(h[r+2],a),c=pc(h[r+4],An),r+=5),h.length<=r)s=c*u,a=t=l+s*o+u*i;else throw Uc()}else if(typeof n=="bigint")t=n,a=n,s=An;else throw Uc();if(s===an)throw gA();St.s=a<an?-An:An,St.n=t<an?-t:t,St.d=s<an?-s:s};function Mbe(n,e,t){let s=An;for(;e>an;n=n*n%t,e>>=An)e&An&&(s=s*n%t);return s}function Abe(n,e){for(;e%sg===an;e/=sg);for(;e%z2===an;e/=z2);if(e===An)return an;let t=Kr%e,s=1;for(;t!==An;s++)if(t=t*Kr%e,s>Cbe)return an;return BigInt(s)}function Ebe(n,e,t){let s=An,a=Mbe(Kr,t,e);for(let r=0;r<300;r++){if(s===a)return BigInt(r);s=s*Kr%e,a=a*Kr%e}return 0}function ch(n,e){if(!n)return e;if(!e)return n;for(;;){if(n%=e,!n)return e;if(e%=n,!e)return n}}function Rs(n,e){if(Ia(n,e),this instanceof Rs)n=ch(St.d,St.n),this.s=St.s,this.n=St.n/n,this.d=St.d/n;else return Ws(St.s*St.n,St.d)}var gA=function(){return new Error("Division by Zero")},Uc=function(){return new Error("Invalid argument")},C9=function(){return new Error("Parameters must be integer")};Rs.prototype={s:An,n:an,d:An,abs:function(){return Ws(this.n,this.d)},neg:function(){return Ws(-this.s*this.n,this.d)},add:function(n,e){return Ia(n,e),Ws(this.s*this.n*St.d+St.s*this.d*St.n,this.d*St.d)},sub:function(n,e){return Ia(n,e),Ws(this.s*this.n*St.d-St.s*this.d*St.n,this.d*St.d)},mul:function(n,e){return Ia(n,e),Ws(this.s*St.s*this.n*St.n,this.d*St.d)},div:function(n,e){return Ia(n,e),Ws(this.s*St.s*this.n*St.d,this.d*St.n)},clone:function(){return Ws(this.s*this.n,this.d)},mod:function(n,e){if(n===void 0)return Ws(this.s*this.n%this.d,An);if(Ia(n,e),an===St.n*this.d)throw gA();return Ws(this.s*(St.d*this.n)%(St.n*this.d),St.d*this.d)},gcd:function(n,e){return Ia(n,e),Ws(ch(St.n,this.n)*ch(St.d,this.d),St.d*this.d)},lcm:function(n,e){return Ia(n,e),St.n===an&&this.n===an?Ws(an,An):Ws(St.n*this.n,ch(St.n,this.n)*ch(St.d,this.d))},inverse:function(){return Ws(this.s*this.d,this.n)},pow:function(n,e){if(Ia(n,e),St.d===An)return St.s<an?Ws((this.s*this.d)**St.n,this.n**St.n):Ws((this.s*this.n)**St.n,this.d**St.n);if(this.s<an)return null;let t=td(this.n),s=td(this.d),a=An,r=An;for(let o in t)if(o!=="1"){if(o==="0"){a=an;break}if(t[o]*=St.n,t[o]%St.d===an)t[o]/=St.d;else return null;a*=BigInt(o)**t[o]}for(let o in s)if(o!=="1"){if(s[o]*=St.n,s[o]%St.d===an)s[o]/=St.d;else return null;r*=BigInt(o)**s[o]}return St.s<an?Ws(r,a):Ws(a,r)},log:function(n,e){if(Ia(n,e),this.s<=an||St.s<=an)return null;const t={},s=td(St.n),a=td(St.d),r=td(this.n),o=td(this.d);for(const c in a)s[c]=(s[c]||an)-a[c];for(const c in o)r[c]=(r[c]||an)-o[c];for(const c in s)c!=="1"&&(t[c]=!0);for(const c in r)c!=="1"&&(t[c]=!0);let i=null,l=null;for(const c in t){const u=s[c]||an,h=r[c]||an;if(u===an){if(h!==an)return null;continue}let m=h,f=u;const v=ch(m,f);if(m/=v,f/=v,i===null&&l===null)i=m,l=f;else if(m*l!==i*f)return null}return i!==null&&l!==null?Ws(i,l):null},equals:function(n,e){return Ia(n,e),this.s*this.n*St.d===St.s*St.n*this.d},lt:function(n,e){return Ia(n,e),this.s*this.n*St.d<St.s*St.n*this.d},lte:function(n,e){return Ia(n,e),this.s*this.n*St.d<=St.s*St.n*this.d},gt:function(n,e){return Ia(n,e),this.s*this.n*St.d>St.s*St.n*this.d},gte:function(n,e){return Ia(n,e),this.s*this.n*St.d>=St.s*St.n*this.d},compare:function(n,e){Ia(n,e);let t=this.s*this.n*St.d-St.s*St.n*this.d;return(an<t)-(t<an)},ceil:function(n){return n=Kr**BigInt(n||0),Ws(Di(this.s*n*this.n/this.d)+(n*this.n%this.d>an&&this.s>=an?An:an),n)},floor:function(n){return n=Kr**BigInt(n||0),Ws(Di(this.s*n*this.n/this.d)-(n*this.n%this.d>an&&this.s<an?An:an),n)},round:function(n){return n=Kr**BigInt(n||0),Ws(Di(this.s*n*this.n/this.d)+this.s*((this.s>=an?An:an)+sg*(n*this.n%this.d)>this.d?An:an),n)},roundTo:function(n,e){Ia(n,e);const t=this.n*St.d,s=this.d*St.n,a=t%s;let r=Di(t/s);return a+a>=s&&r++,Ws(this.s*r*St.n,St.d)},divisible:function(n,e){return Ia(n,e),!(!(St.n*this.d)||this.n*St.d%(St.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(n){let e=this.n,t=this.d;n=n||15;let s=Abe(e,t),a=Ebe(e,t,s),r=this.s<an?"-":"";if(r+=Di(e/t),e%=t,e*=Kr,e&&(r+="."),s){for(let o=a;o--;)r+=Di(e/t),e%=t,e*=Kr;r+="(";for(let o=s;o--;)r+=Di(e/t),e%=t,e*=Kr;r+=")"}else for(let o=n;e&&o--;)r+=Di(e/t),e%=t,e*=Kr;return r},toFraction:function(n){let e=this.n,t=this.d,s=this.s<an?"-":"";if(t===An)s+=e;else{let a=Di(e/t);n&&a>an&&(s+=a,s+=" ",e%=t),s+=e,s+="/",s+=t}return s},toLatex:function(n){let e=this.n,t=this.d,s=this.s<an?"-":"";if(t===An)s+=e;else{let a=Di(e/t);n&&a>an&&(s+=a,e%=t),s+="\\frac{",s+=e,s+="}{",s+=t,s+="}"}return s},toContinued:function(){let n=this.n,e=this.d,t=[];do{t.push(Di(n/e));let s=n%e;n=e,e=s}while(n!==An);return t},simplify:function(n){const e=BigInt(1/(n||.001)|0),t=this.abs(),s=t.toContinued();for(let a=1;a<s.length;a++){let r=Ws(s[a-1],An);for(let i=a-2;i>=0;i--)r=r.inverse().add(s[i]);let o=r.sub(t);if(o.n*e<o.d)return r.mul(this.s)}return this}};const bA="strudel.log";let Dbe=1e3,M9,A9;function yA(n,e="cyclist"){Za(`[${e}] error: ${n.message}`)}function Za(n,e,t={}){let s=performance.now();M9===n&&s-A9<Dbe||(M9=n,A9=s,console.log(`%c${n}`,"background-color: black;color:white;border-radius:15px"),typeof document<"u"&&typeof CustomEvent<"u"&&document.dispatchEvent(new CustomEvent(bA,{detail:{message:n,type:e,data:t}})))}Za.key=bA;const Tbe=n=>/^[a-gA-G][#bs]*[0-9]$/.test(n),Yh=n=>/^[a-gA-G][#bsf]*-?[0-9]?$/.test(n),J_=n=>{var a;if(typeof n!="string")return[];const[e,t="",s]=((a=n.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/))==null?void 0:a.slice(1))||[];return e?[e,t,s?Number(s):void 0]:[]},Fbe={c:0,d:2,e:4,f:5,g:7,a:9,b:11},Nbe={"#":1,b:-1,s:1,f:-1},Ji=(n,e=3)=>{const[t,s,a=e]=J_(n);if(!t)throw new Error('not a note: "'+n+'"');const r=Fbe[t.toLowerCase()],o=(s==null?void 0:s.split("").reduce((i,l)=>i+Nbe[l],0))||0;return(Number(a)+1)*12+r+o},mm=n=>Math.pow(2,(n-69)/12)*440,vA=n=>12*Math.log(n/440)/Math.LN2+69,eL=(n,e)=>{if(typeof n!="object")throw new Error("valueToMidi: expected object value");let{freq:t,note:s}=n;if(typeof t=="number")return vA(t);if(typeof s=="string")return Ji(s);if(typeof s=="number")return s;if(!e)throw new Error("valueToMidi: expected freq or note to be set");return e},Bbe=(n,e)=>(n-e)*1e3,tL=n=>mm(typeof n=="number"?n:Ji(n)),$be=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Rbe=n=>{const e=Math.floor(n/12)-1;return $be[n%12]+e},vi=(n,e)=>(n%e+e)%e,nL=n=>n.reduce((e,t)=>e+t)/n.length;function sL(n,e=0){return isNaN(Number(n))?(Za(`"${n}" is not a number, falling back to ${e}`,"warning"),e):n}const _be=(n,e)=>vi(Math.round(sL(n??0,0)),e),Lbe=n=>{let{value:e,context:t}=n,s=e;if(typeof s=="object"&&!Array.isArray(s)&&(s=s.note||s.n||s.value,s===void 0))throw new Error(`cannot find a playable note for ${JSON.stringify(e)}`);if(typeof s=="number"&&t.type!=="frequency")s=mm(n.value);else if(typeof s=="number"&&t.type==="frequency")s=n.value;else if(typeof s!="string"||!Yh(s))throw new Error("not a note: "+JSON.stringify(s));return s},aL=n=>{let{value:e,context:t}=n;if(typeof e=="object")return e.freq?e.freq:tL(e.note||e.n||e.value);if(typeof e=="number"&&t.type!=="frequency")e=mm(n.value);else if(typeof e=="string"&&Yh(e))e=mm(Ji(n.value));else if(typeof e!="number")throw new Error("not a note or frequency: "+e);return e},rL=(n,e)=>n.slice(e).concat(n.slice(0,e)),oL=(...n)=>n.reduce((e,t)=>(...s)=>e(t(...s)),e=>e),Ibe=(...n)=>oL(...n.reverse()),Xm=n=>n.filter(e=>e!=null),Pc=n=>[].concat(...n),Od=n=>n,Qbe=(n,e)=>n,qg=(n,e)=>Array.from({length:e-n+1},(t,s)=>s+n);function $n(n,e,t=n.length){const s=function a(...r){if(r.length>=t)return n.apply(this,r);{const o=function(...i){return a.apply(this,r.concat(i))};return e&&e(o,r),o}};return e&&e(s,[]),s}function wA(n){const e=Number(n);if(!isNaN(e))return e;if(Yh(n))return Ji(n);throw new Error(`cannot parse as numeral: "${n}"`)}function OA(n,e){return(...t)=>n(...t.map(e))}function Do(n){return OA(n,wA)}function iL(n){const e=Number(n);if(!isNaN(e))return e;const t={pi:Math.PI,w:1,h:.5,q:.25,e:.125,s:.0625,t:1/3,f:.2,x:1/6}[n];if(typeof t<"u")return t;throw new Error(`cannot parse as fractional: "${n}"`)}const Vbe=n=>OA(n,iL),xA=function(n,e){return[e.slice(0,n),e.slice(n)]},pw=(n,e,t)=>e.map((s,a)=>n(s,t[a])),lL=function(n){const e=[];for(let t=0;t<n.length-1;++t)e.push([n[t],n[t+1]]);return e},fw=(n,e,t)=>Math.min(Math.max(n,e),t),jbe=["Do","Reb","Re","Mib","Mi","Fa","Solb","Sol","Lab","La","Sib","Si"],Zbe=["Sa","Re","Ga","Ma","Pa","Dha","Ni"],zbe=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Hb","H"],Gbe=["Ni","Pab","Pa","Voub","Vou","Ga","Dib","Di","Keb","Ke","Zob","Zo"],Xbe=["I","Ro","Ha","Ni","Ho","He","To"],Wbe=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],qbe=(n,e="letters")=>{const t=(e==="solfeggio"?jbe:e==="indian"?Zbe:e==="german"?zbe:e==="byzantine"?Gbe:e==="japanese"?Xbe:Wbe)[n%12],s=Math.floor(n/12)-1;return t+s};function Ube(n){var e={};return n.filter(function(t){return e.hasOwn(t)?!1:e[t]=!0})}function Hbe(n){return n.sort().filter(function(e,t,s){return!t||e!=s[t-1]})}function cL(n){return n.sort((e,t)=>e.compare(t)).filter(function(e,t,s){return!t||e.ne(s[t-1])})}function uL(n){const e=new TextEncoder().encode(n);return btoa(String.fromCharCode(...e))}function hL(n){const e=new Uint8Array(atob(n).split("").map(t=>t.charCodeAt(0)));return new TextDecoder().decode(e)}function Ybe(n){return encodeURIComponent(uL(n))}function Kbe(n){return hL(decodeURIComponent(n))}function dL(n,e){return Array.isArray(n)?n.map(e):Object.fromEntries(Object.entries(n).map(([t,s],a)=>[t,e(s,t,a)]))}function G2(n,e){return n/e}class mL{constructor({getTargetClockTime:e=e1e,weight:t=16,offsetDelta:s=.005,checkAfterTime:a=2,resetAfterTime:r=8}){this.offsetTime,this.timeAtPrevOffsetSample,this.prevOffsetTimes=[],this.getTargetClockTime=e,this.weight=t,this.offsetDelta=s,this.checkAfterTime=a,this.resetAfterTime=r,this.reset=()=>{this.prevOffsetTimes=[],this.offsetTime=null,this.timeAtPrevOffsetSample=null}}calculateOffset(e){const t=this.getTargetClockTime(),s=t-this.timeAtPrevOffsetSample,a=t-e;if(s>this.resetAfterTime&&this.reset(),this.offsetTime==null&&(this.offsetTime=a),this.prevOffsetTimes.push(a),this.prevOffsetTimes.length>this.weight&&this.prevOffsetTimes.shift(),this.timeAtPrevOffsetSample==null||s>this.checkAfterTime){this.timeAtPrevOffsetSample=t;const r=nL(this.prevOffsetTimes);Math.abs(r-this.offsetTime)>this.offsetDelta&&(this.offsetTime=r)}return this.offsetTime}calculateTimestamp(e,t){return this.calculateOffset(e)+t}}function Jbe(){return performance.now()*.001}function e1e(){return Date.now()*.001}const pL=new Map([["control","Control"],["ctrl","Control"],["alt","Alt"],["shift","Shift"],["down","ArrowDown"],["up","ArrowUp"],["left","ArrowLeft"],["right","ArrowRight"]]);let Mp;function fL(){if(Mp==null){if(typeof window>"u")return;Mp={},window.addEventListener("keydown",n=>{Mp[n.key]=!0}),window.addEventListener("keyup",n=>{Mp[n.key]=!1})}return{...Mp}}function kA(n,e=!1){return typeof n=="object"?e?JSON.stringify(n).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(n):n}Rs.prototype.sam=function(){return this.floor()};Rs.prototype.nextSam=function(){return this.sam().add(1)};Rs.prototype.wholeCycle=function(){return new da(this.sam(),this.nextSam())};Rs.prototype.cyclePos=function(){return this.sub(this.sam())};Rs.prototype.lt=function(n){return this.compare(n)<0};Rs.prototype.gt=function(n){return this.compare(n)>0};Rs.prototype.lte=function(n){return this.compare(n)<=0};Rs.prototype.gte=function(n){return this.compare(n)>=0};Rs.prototype.eq=function(n){return this.compare(n)==0};Rs.prototype.ne=function(n){return this.compare(n)!=0};Rs.prototype.max=function(n){return this.gt(n)?this:n};Rs.prototype.maximum=function(...n){return n=n.map(e=>new Rs(e)),n.reduce((e,t)=>t.max(e),this)};Rs.prototype.min=function(n){return this.lt(n)?this:n};Rs.prototype.mulmaybe=function(n){return n!==void 0?this.mul(n):void 0};Rs.prototype.divmaybe=function(n){return n!==void 0?this.div(n):void 0};Rs.prototype.addmaybe=function(n){return n!==void 0?this.add(n):void 0};Rs.prototype.submaybe=function(n){return n!==void 0?this.sub(n):void 0};Rs.prototype.show=function(){return this.s*this.n+"/"+this.d};Rs.prototype.or=function(n){return this.eq(0)?n:this};const ht=n=>Rs(n),t1e=(...n)=>{if(n=Xm(n),n.length!==0)return n.reduce((e,t)=>e.gcd(t),ht(1))},zi=(...n)=>{if(n=Xm(n),n.length===0)return;const e=n.pop();return n.reduce((t,s)=>t===void 0||s===void 0?void 0:t.lcm(s),e)},n1e=n=>n instanceof Rs;ht._original=Rs;class da{constructor(e,t){this.begin=ht(e),this.end=ht(t)}get spanCycles(){const e=[];var t=this.begin;const s=this.end,a=s.sam();if(t.equals(s))return[new da(t,s)];for(;s.gt(t);){if(t.sam().equals(a)){e.push(new da(t,this.end));break}const r=t.nextSam();e.push(new da(t,r)),t=r}return e}get duration(){return this.end.sub(this.begin)}cycleArc(){const e=this.begin.cyclePos(),t=e.add(this.duration);return new da(e,t)}withTime(e){return new da(e(this.begin),e(this.end))}withEnd(e){return new da(this.begin,e(this.end))}withCycle(e){const t=this.begin.sam(),s=t.add(e(this.begin.sub(t))),a=t.add(e(this.end.sub(t)));return new da(s,a)}intersection(e){const t=this.begin.max(e.begin),s=this.end.min(e.end);if(!t.gt(s)&&!(t.equals(s)&&(t.equals(this.end)&&this.begin.lt(this.end)||t.equals(e.end)&&e.begin.lt(e.end))))return new da(t,s)}intersection_e(e){const t=this.intersection(e);if(t==null)throw"TimeSpans do not intersect";return t}midpoint(){return this.begin.add(this.duration.div(ht(2)))}equals(e){return this.begin.equals(e.begin)&&this.end.equals(e.end)}show(){return this.begin.show()+" → "+this.end.show()}}class aa{constructor(e,t,s,a={},r=!1){this.whole=e,this.part=t,this.value=s,this.context=a,this.stateful=r,r&&console.assert(typeof this.value=="function","Stateful values must be functions")}get duration(){var t,s;let e;return typeof((t=this.value)==null?void 0:t.duration)=="number"?e=ht(this.value.duration):e=this.whole.end.sub(this.whole.begin),typeof((s=this.value)==null?void 0:s.clip)=="number"?e.mul(this.value.clip):e}get endClipped(){return this.whole.begin.add(this.duration)}isActive(e){return this.whole.begin<=e&&this.endClipped>=e}isInPast(e){return e>this.endClipped}isInNearPast(e,t){return t-e<=this.endClipped}isInFuture(e){return e<this.whole.begin}isInNearFuture(e,t){return t<this.whole.begin&&t>this.whole.begin-e}isWithinTime(e,t){return this.whole.begin<=t&&this.endClipped>=e}wholeOrPart(){return this.whole?this.whole:this.part}withSpan(e){const t=this.whole?e(this.whole):void 0;return new aa(t,e(this.part),this.value,this.context)}withValue(e){return new aa(this.whole,this.part,e(this.value),this.context)}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}hasTag(e){var t;return(t=this.context.tags)==null?void 0:t.includes(e)}resolveState(e){if(this.stateful&&this.hasOnset()){console.log("stateful");const t=this.value,[s,a]=t(e);return[s,new aa(this.whole,this.part,a,this.context,!1)]}return[e,this]}spanEquals(e){return this.whole==null&&e.whole==null||this.whole.equals(e.whole)}equals(e){return this.spanEquals(e)&&this.part.equals(e.part)&&this.value===e.value}show(e=!1){const t=typeof this.value=="object"?e?JSON.stringify(this.value).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(this.value):this.value;var s="";if(this.whole==null)s="~"+this.part.show;else{var a=this.whole.begin.equals(this.part.begin)&&this.whole.end.equals(this.part.end);this.whole.begin.equals(this.part.begin)||(s=this.whole.begin.show()+" ⇜ "),a||(s+="("),s+=this.part.show(),a||(s+=")"),this.whole.end.equals(this.part.end)||(s+=" ⇝ "+this.whole.end.show())}return"[ "+s+" | "+t+" ]"}showWhole(e=!1){return`${this.whole==null?"~":this.whole.show()}: ${kA(this.value,e)}`}combineContext(e){const t=this;return{...t.context,...e.context,locations:(t.context.locations||[]).concat(e.context.locations||[])}}setContext(e){return new aa(this.whole,this.part,this.value,e)}ensureObjectValue(){if(typeof this.value!="object")throw new Error(`expected hap.value to be an object, but got "${this.value}". Hint: append .note() or .s() to the end`,"error")}}class pm{constructor(e,t={}){this.span=e,this.controls=t}setSpan(e){return new pm(e,this.controls)}withSpan(e){return this.setSpan(e(this.span))}setControls(e){return new pm(this.span,{...this.controls,...e})}}function s1e(n,e,t){if((e==null?void 0:e.value)!==void 0&&Object.keys(e).length===1)return Za("[warn]: Can't do arithmetic on control pattern."),n;const s=Object.keys(n).filter(a=>Object.keys(e).includes(a));return Object.assign({},n,e,Object.fromEntries(s.map(a=>[a,t(n[a],e[a])])))}$n((n,e)=>n*e);$n((n,e)=>e.map(n));function gL(n,e=60){let t=0,s=ht(0),a=[""],r="";for(;a[0].length<e;){const o=n.queryArc(t,t+1),i=o.filter(u=>u.hasOnset()).map(u=>u.duration),l=t1e(...i),c=l.inverse();a=a.map(u=>u+"|"),r+="|";for(let u=0;u<c;u++){const[h,m]=[s,s.add(l)],f=o.filter(O=>O.whole.begin.lte(h)&&O.whole.end.gte(m)),v=f.length-a.length;v>0&&(a=a.concat(Array(v).fill(r))),a=a.map((O,k)=>{const M=f[k];if(M){const E=M.whole.begin.eq(h)?""+M.value:"-";return O+E}return O+"."}),r+=".",s=s.add(l)}t++}return a.join(`
`)}let X2,Qo=!0;const a1e=function(n){Qo=!!n},bL=n=>X2=n;let dt=class Qa{constructor(e,t=void 0){la(this,"polyJoin",function(){const e=this;return e.fmap(t=>t.extend(e._steps.div(t._steps))).outerJoin()});this.query=e,this._Pattern=!0,this._steps=t}get _steps(){return this.__steps}set _steps(e){this.__steps=e===void 0?void 0:ht(e)}setSteps(e){return this._steps=e,this}withSteps(e){return Qo?new Qa(this.query,this._steps===void 0?void 0:e(this._steps)):this}get hasSteps(){return this._steps!==void 0}withValue(e){const t=new Qa(s=>this.query(s).map(a=>a.withValue(e)));return t._steps=this._steps,t}withState(e){return new Qa(t=>this.query(e(t)))}fmap(e){return this.withValue(e)}appWhole(e,t){const s=this,a=function(r){const o=s.query(r),i=t.query(r),l=function(c,u){const h=c.part.intersection(u.part);if(h!=null)return new aa(e(c.whole,u.whole),h,c.value(u.value),u.combineContext(c))};return Pc(o.map(c=>Xm(i.map(u=>l(c,u)))))};return new Qa(a)}appBoth(e){const t=this,s=function(r,o){if(!(r==null||o==null))return r.intersection_e(o)},a=t.appWhole(s,e);return Qo&&(a._steps=zi(e._steps,t._steps)),a}appLeft(e){const t=this,s=function(r){const o=[];for(const i of t.query(r)){const l=e.query(r.setSpan(i.wholeOrPart()));for(const c of l){const u=i.whole,h=i.part.intersection(c.part);if(h){const m=i.value(c.value),f=c.combineContext(i),v=new aa(u,h,m,f);o.push(v)}}}return o},a=new Qa(s);return a._steps=this._steps,a}appRight(e){const t=this,s=function(r){const o=[];for(const i of e.query(r)){const l=t.query(r.setSpan(i.wholeOrPart()));for(const c of l){const u=i.whole,h=c.part.intersection(i.part);if(h){const m=c.value(i.value),f=i.combineContext(c),v=new aa(u,h,m,f);o.push(v)}}}return o},a=new Qa(s);return a._steps=e._steps,a}bindWhole(e,t){const s=this,a=function(r){const o=function(l,c){return new aa(e(l.whole,c.whole),c.part,c.value,Object.assign({},l.context,c.context,{locations:(l.context.locations||[]).concat(c.context.locations||[])}))},i=function(l){return t(l.value).query(r.setSpan(l.part)).map(c=>o(l,c))};return Pc(s.query(r).map(l=>i(l)))};return new Qa(a)}bind(e){const t=function(s,a){if(!(s==null||a==null))return s.intersection_e(a)};return this.bindWhole(t,e)}join(){return this.bind(Od)}outerBind(e){return this.bindWhole(t=>t,e).setSteps(this._steps)}outerJoin(){return this.outerBind(Od)}innerBind(e){return this.bindWhole((t,s)=>s,e)}innerJoin(){return this.innerBind(Od)}resetJoin(e=!1){const t=this;return new Qa(s=>t.discreteOnly().query(s).map(a=>a.value.late(e?a.whole.begin:a.whole.begin.cyclePos()).query(s).map(r=>new aa(r.whole?r.whole.intersection(a.whole):void 0,r.part.intersection(a.part),r.value).setContext(a.combineContext(r))).filter(r=>r.part)).flat())}restartJoin(){return this.resetJoin(!0)}squeezeJoin(){const e=this;function t(s){const a=e.discreteOnly().query(s);function r(o){const i=o.value._focusSpan(o.wholeOrPart()).query(s.setSpan(o.part));function l(c,u){let h;if(u.whole&&c.whole&&(h=u.whole.intersection(c.whole),!h))return;const m=u.part.intersection(c.part);if(!m)return;const f=u.combineContext(c);return new aa(h,m,u.value,f)}return i.map(c=>l(o,c))}return Pc(a.map(r)).filter(o=>o)}return new Qa(t)}squeezeBind(e){return this.fmap(e).squeezeJoin()}polyBind(e){return this.fmap(e).polyJoin()}queryArc(e,t,s={}){try{return this.query(new pm(new da(e,t),s))}catch(a){return Za(`[query]: ${a.message}`,"error"),[]}}splitQueries(){const e=this,t=s=>Pc(s.span.spanCycles.map(a=>e.query(s.setSpan(a))));return new Qa(t)}withQuerySpan(e){return new Qa(t=>this.query(t.withSpan(e)))}withQuerySpanMaybe(e){const t=this;return new Qa(s=>{const a=s.withSpan(e);return a.span?t.query(a):[]})}withQueryTime(e){return new Qa(t=>this.query(t.withSpan(s=>s.withTime(e))))}withHapSpan(e){return new Qa(t=>this.query(t).map(s=>s.withSpan(e)))}withHapTime(e){return this.withHapSpan(t=>t.withTime(e))}withHaps(e){const t=new Qa(s=>e(this.query(s),s));return t._steps=this._steps,t}withHap(e){return this.withHaps(t=>t.map(e))}setContext(e){return this.withHap(t=>t.setContext(e))}withContext(e){const t=this.withHap(s=>s.setContext(e(s.context)));return this.__pure!==void 0&&(t.__pure=this.__pure,t.__pure_loc=this.__pure_loc),t}stripContext(){return this.withHap(e=>e.setContext({}))}withLoc(e,t){const s={start:e,end:t},a=this.withContext(r=>{const o=(r.locations||[]).concat([s]);return{...r,locations:o}});return this.__pure&&(a.__pure=this.__pure,a.__pure_loc=s),a}filterHaps(e){return new Qa(t=>this.query(t).filter(e))}filterValues(e){return new Qa(t=>this.query(t).filter(s=>e(s.value))).setSteps(this._steps)}removeUndefineds(){return this.filterValues(e=>e!=null)}onsetsOnly(){return this.filterHaps(e=>e.hasOnset())}discreteOnly(){return this.filterHaps(e=>e.whole)}defragmentHaps(){return this.discreteOnly().withHaps(e=>{const t=[];for(var s=0;s<e.length;++s){for(var a=!0,r=e[s];a;){const l=JSON.stringify(e[s].value);for(var o=!1,i=s+1;i<e.length;i++){const c=e[i];if(r.whole.equals(c.whole)){if(r.part.begin.eq(c.part.end)){if(l===JSON.stringify(c.value)){r=new aa(r.whole,new da(c.part.begin,r.part.end),r.value),e.splice(i,1),o=!0;break}}else if(c.part.begin.eq(r.part.end)&&l==JSON.stringify(c.value)){r=new aa(r.whole,new da(r.part.begin,c.part.end),r.value),e.splice(i,1),o=!0;break}}}a=o}t.push(r)}return t})}firstCycle(e=!1){var t=this;return e||(t=t.stripContext()),t.query(new pm(new da(ht(0),ht(1))))}get firstCycleValues(){return this.firstCycle().map(e=>e.value)}get showFirstCycle(){return this.firstCycle().map(e=>`${e.value}: ${e.whole.begin.toFraction()} - ${e.whole.end.toFraction()}`)}sortHapsByPart(){return this.withHaps(e=>e.sort((t,s)=>t.part.begin.sub(s.part.begin).or(t.part.end.sub(s.part.end)).or(t.whole.begin.sub(s.whole.begin).or(t.whole.end.sub(s.whole.end)))))}asNumber(){return this.fmap(wA)}_opIn(e,t){return this.fmap(t).appLeft(yt(e))}_opOut(e,t){return this.fmap(t).appRight(yt(e))}_opMix(e,t){return this.fmap(t).appBoth(yt(e))}_opSqueeze(e,t){const s=yt(e);return this.fmap(a=>s.fmap(r=>t(a)(r))).squeezeJoin()}_opSqueezeOut(e,t){const s=this;return yt(e).fmap(a=>s.fmap(r=>t(r)(a))).squeezeJoin()}_opReset(e,t){return yt(e).fmap(s=>this.fmap(a=>t(a)(s))).resetJoin()}_opRestart(e,t){return yt(e).fmap(s=>this.fmap(a=>t(a)(s))).restartJoin()}_opPoly(e,t){const s=yt(e);return this.fmap(a=>s.fmap(r=>t(r)(a))).polyJoin()}layer(...e){return js(...e.map(t=>t(this)))}superimpose(...e){return this.stack(...e.map(t=>t(this)))}stack(...e){return js(this,...e)}sequence(...e){return tl(this,...e)}seq(...e){return tl(this,...e)}cat(...e){return ag(this,...e)}fastcat(...e){return fr(this,...e)}slowcat(...e){return zu(this,...e)}onTrigger(e,t=!0){return this.withHap(s=>s.setContext({...s.context,onTrigger:(...a)=>{var r,o;(o=(r=s.context).onTrigger)==null||o.call(r,...a),e(...a)},dominantTrigger:s.context.dominantTrigger||t}))}log(e=s=>`[hap] ${s.showWhole(!0)}`,t=s=>({hap:s})){return this.onTrigger((...s)=>{Za(e(...s),void 0,t(...s))},!1)}logValues(e=t=>`[hap] ${kA(t,!0)}`){return this.log(t=>e(t.value))}drawLine(){return console.log(gL(this)),this}unjoin(e,t=Od){return e.withHap(s=>s.withValue(a=>a?t(this.ribbon(s.whole.begin,s.whole.duration)):this))}into(e,t){return this.unjoin(e,t).innerJoin()}};function r1e(n,e){let t=[];return e.forEach(s=>{const a=t.findIndex(([r])=>n(s,r));a===-1?t.push([s]):t[a].push(s)}),t}const o1e=(n,e)=>n.spanEquals(e);dt.prototype.collect=function(){return this.withHaps(n=>r1e(o1e,n).map(e=>new aa(e[0].whole,e[0].part,e,{})))};const i1e=Ie("arpWith",(n,e)=>e.collect().fmap(t=>yt(n(t))).innerJoin().withHap(t=>new aa(t.whole,t.part,t.value.value,t.combineContext(t.value)))),l1e=Ie("arp",(n,e)=>e.arpWith(t=>yt(n).fmap(s=>t[s%t.length])),!1);function Z0(n){return!Array.isArray(n)&&typeof n=="object"&&!n1e(n)}function c1e(n,e,t){return Z0(n)||Z0(e)?(Z0(n)||(n={value:n}),Z0(e)||(e={value:e}),s1e(n,e,t)):t(n,e)}(function(){const n={set:[(t,s)=>s],keep:[t=>t],keepif:[(t,s)=>s?t:void 0],add:[Do((t,s)=>t+s)],sub:[Do((t,s)=>t-s)],mul:[Do((t,s)=>t*s)],div:[Do((t,s)=>t/s)],mod:[Do(vi)],pow:[Do(Math.pow)],log2:[Do(Math.log2)],band:[Do((t,s)=>t&s)],bor:[Do((t,s)=>t|s)],bxor:[Do((t,s)=>t^s)],blshift:[Do((t,s)=>t<<s)],brshift:[Do((t,s)=>t>>s)],lt:[(t,s)=>t<s],gt:[(t,s)=>t>s],lte:[(t,s)=>t<=s],gte:[(t,s)=>t>=s],eq:[(t,s)=>t==s],eqt:[(t,s)=>t===s],ne:[(t,s)=>t!=s],net:[(t,s)=>t!==s],and:[(t,s)=>t&&s],or:[(t,s)=>t||s],func:[(t,s)=>s(t)]},e=["In","Out","Mix","Squeeze","SqueezeOut","Reset","Restart","Poly"];for(const[t,[s,a]]of Object.entries(n)){dt.prototype["_"+t]=function(r){return this.fmap(o=>s(o,r))},Object.defineProperty(dt.prototype,t,{get:function(){const r=this,o=(...i)=>r[t].in(...i);for(const i of e)o[i.toLowerCase()]=function(...l){var c=r;l=tl(l),a&&(c=a(c),l=a(l));var u;return t==="keepif"?(u=c["_op"+i](l,h=>m=>s(h,m)),u=u.removeUndefineds()):u=c["_op"+i](l,h=>m=>c1e(h,m,s)),u};return o.squeezein=o.squeeze,o}});for(const r of e)dt.prototype[r.toLowerCase()]=function(...o){return this.set[r.toLowerCase()](o)}}dt.prototype.struct=function(...t){return this.keepif.out(...t)},dt.prototype.structAll=function(...t){return this.keep.out(...t)},dt.prototype.mask=function(...t){return this.keepif.in(...t)},dt.prototype.maskAll=function(...t){return this.keep.in(...t)},dt.prototype.reset=function(...t){return this.keepif.reset(...t)},dt.prototype.resetAll=function(...t){return this.keep.reset(...t)},dt.prototype.restart=function(...t){return this.keepif.restart(...t)},dt.prototype.restartAll=function(...t){return this.keep.restart(...t)}})();const u1e=js,h1e=js,d1e=bw,Wm=n=>new dt(()=>[],n),us=Wm(1),el=Wm(0);function Ys(n){function e(s){return s.span.spanCycles.map(a=>new aa(ht(a.begin).wholeCycle(),a,n))}const t=new dt(e,1);return t.__pure=n,t}function gw(n){return n instanceof dt||(n==null?void 0:n._Pattern)}function yt(n){return gw(n)?n:X2&&typeof n=="string"?X2(n):Ys(n)}function yL(n){let e=Ys([]);for(const t of n)e=e.bind(s=>t.fmap(a=>s.concat([a])));return e}function js(...n){n=n.map(s=>Array.isArray(s)?tl(...s):yt(s));const e=s=>Pc(n.map(a=>a.query(s))),t=new dt(e);return Qo&&(t._steps=zi(...n.map(s=>s._steps))),t}function PA(n,e){if(e=e.map(r=>Array.isArray(r)?tl(...r):yt(r)),e.length===0)return us;if(e.length===1)return e[0];const[t,...s]=e.map(r=>r._steps),a=Qo?t.maximum(...s):void 0;return js(...n(a,e))}function vL(...n){return PA((e,t)=>t.map(s=>s._steps.eq(e)?s:go(s,Wm(e.sub(s._steps)))),n)}function wL(...n){return PA((e,t)=>t.map(s=>s._steps.eq(e)?s:go(Wm(e.sub(s._steps)),s)),n)}function OL(...n){return PA((e,t)=>t.map(s=>{if(s._steps.eq(e))return s;const a=Wm(e.sub(s._steps).div(2));return go(a,s,a)}),n)}function m1e(n,...e){const[t,...s]=e.map(o=>o._steps),a=t.maximum(...s),r={centre:OL,left:vL,right:wL,expand:js,repeat:(...o)=>bw(...o).steps(a)};return n.inhabit(r).fmap(o=>o(...e)).innerJoin().setSteps(a)}function zu(...n){if(n=n.map(s=>Array.isArray(s)?fr(...s):yt(s)),n.length==1)return n[0];const e=function(s){const a=s.span,r=vi(a.begin.sam(),n.length),o=n[r];if(!o)return[];const i=a.begin.floor().sub(a.begin.div(n.length).floor());return o.withHapTime(l=>l.add(i)).query(s.setSpan(a.withTime(l=>l.sub(i))))},t=Qo?zi(...n.map(s=>s._steps)):void 0;return new dt(e).splitQueries().setSteps(t)}function SA(...n){n=n.map(yt);const e=function(t){var a;const s=Math.floor(t.span.begin)%n.length;return((a=n[s])==null?void 0:a.query(t))||[]};return new dt(e).splitQueries()}function ag(...n){return zu(...n)}function p1e(...n){const e=n.reduce((t,[s])=>t+s,0);return n=n.map(([t,s])=>[t,s.fast(t)]),go(...n).slow(e)}function f1e(...n){let e=ht(0);for(let t of n)t.length==2&&t.unshift(e),e=t[1];return js(...n.map(([t,s,a])=>Ys(yt(a)).compress(ht(t).div(e),ht(s).div(e)))).slow(e).innerJoin()}function fr(...n){let e=zu(...n);return n.length>1&&(e=e._fast(n.length),e._steps=n.length),n.length==1&&n[0].__steps_source&&(n._steps=n[0]._steps),e}function tl(...n){return fr(...n)}function xL(...n){return fr(...n)}function W2(n){return Array.isArray(n)?n.length==0?[us,0]:n.length==1?W2(n[0]):[fr(...n.map(e=>W2(e)[0])),n.length]:[yt(n),1]}const g1e=$n((n,e)=>yt(e).mask(n)),b1e=$n((n,e)=>yt(e).struct(n)),y1e=$n((n,e)=>yt(e).superimpose(...n)),v1e=$n((n,e)=>yt(e).withValue(n)),w1e=$n((n,e)=>yt(e).bind(n)),O1e=$n((n,e)=>yt(e).innerBind(n)),x1e=$n((n,e)=>yt(e).outerBind(n)),k1e=$n((n,e)=>yt(e).squeezeBind(n)),P1e=$n((n,e)=>yt(e).stepBind(n)),S1e=$n((n,e)=>yt(e).polyBind(n)),C1e=$n((n,e)=>yt(e).set(n)),M1e=$n((n,e)=>yt(e).keep(n)),A1e=$n((n,e)=>yt(e).keepif(n)),E1e=$n((n,e)=>yt(e).add(n)),D1e=$n((n,e)=>yt(e).sub(n)),T1e=$n((n,e)=>yt(e).mul(n)),F1e=$n((n,e)=>yt(e).div(n)),N1e=$n((n,e)=>yt(e).mod(n)),B1e=$n((n,e)=>yt(e).pow(n)),$1e=$n((n,e)=>yt(e).band(n)),R1e=$n((n,e)=>yt(e).bor(n)),_1e=$n((n,e)=>yt(e).bxor(n)),L1e=$n((n,e)=>yt(e).blshift(n)),I1e=$n((n,e)=>yt(e).brshift(n)),Q1e=$n((n,e)=>yt(e).lt(n)),V1e=$n((n,e)=>yt(e).gt(n)),j1e=$n((n,e)=>yt(e).lte(n)),Z1e=$n((n,e)=>yt(e).gte(n)),z1e=$n((n,e)=>yt(e).eq(n)),G1e=$n((n,e)=>yt(e).eqt(n)),X1e=$n((n,e)=>yt(e).ne(n)),W1e=$n((n,e)=>yt(e).net(n)),q1e=$n((n,e)=>yt(e).and(n)),U1e=$n((n,e)=>yt(e).or(n)),H1e=$n((n,e)=>yt(e).func(n));function Ie(n,e,t=!0,s=!1,a=r=>r.innerJoin()){if(Array.isArray(n)){const i={};for(const l of n)i[l]=Ie(l,e,t,s,a);return i}const r=e.length;var o;return t?o=function(...i){i=i.map(yt);const l=i[i.length-1];let c;if(r===1)c=e(l);else{const u=i.slice(0,-1);if(u.every(h=>h.__pure!=null)){const h=u.map(f=>f.__pure),m=u.filter(f=>f.__pure_loc).map(f=>f.__pure_loc);c=e(...h,l),c=c.withContext(f=>{const v=(f.locations||[]).concat(m);return{...f,locations:v}})}else{const[h,...m]=u;let f=(...v)=>e(...v,l);f=$n(f,null,r-1),c=a(m.reduce((v,O)=>v.appLeft(O),h.fmap(f)))}}return s&&(c._steps=l._steps),c}:o=function(...i){i=i.map(yt);const l=e(...i);return s&&(l._steps=i[i.length-1]._steps),l},dt.prototype[n]=function(...i){if(r===2&&i.length!==1)i=[tl(...i)];else if(r!==i.length+1)throw new Error(`.${n}() expects ${r-1} inputs but got ${i.length}.`);return i=i.map(yt),o(...i,this)},r>1&&(dt.prototype["_"+n]=function(...i){const l=e(...i,this);return s&&l.setSteps(this._steps),l}),$n(o,null,r)}function qm(n,e,t=!0,s=!1,a=r=>r.stepJoin()){return Ie(n,e,t,s,a)}const Y1e=Ie("round",function(n){return n.asNumber().fmap(e=>Math.round(e))}),K1e=Ie("floor",function(n){return n.asNumber().fmap(e=>Math.floor(e))}),J1e=Ie("ceil",function(n){return n.asNumber().fmap(e=>Math.ceil(e))}),eye=Ie("toBipolar",function(n){return n.fmap(e=>e*2-1)}),tye=Ie("fromBipolar",function(n){return n.fmap(e=>(e+1)/2)}),nye=Ie("range",function(n,e,t){return t.mul(e-n).add(n)}),sye=Ie("rangex",function(n,e,t){return t._range(Math.log(n),Math.log(e)).fmap(Math.exp)}),aye=Ie("range2",function(n,e,t){return t.fromBipolar()._range(n,e)}),rye=Ie("ratio",n=>n.fmap(e=>Array.isArray(e)?e.slice(1).reduce((t,s)=>t/s,e[0]):e)),oye=Ie("compress",function(n,e,t){return n=ht(n),e=ht(e),n.gt(e)||n.gt(1)||e.gt(1)||n.lt(0)||e.lt(0)?us:t._fastGap(ht(1).div(e.sub(n)))._late(n)}),{compressSpan:iye,compressspan:lye}=Ie(["compressSpan","compressspan"],function(n,e){return e._compress(n.begin,n.end)}),{fastGap:cye,fastgap:uye}=Ie(["fastGap","fastgap"],function(n,e){const t=function(a){const r=a.begin.sam(),o=a.begin.sub(r).mul(n).min(1),i=a.end.sub(r).mul(n).min(1);if(!(o>=1))return new da(r.add(o),r.add(i))},s=function(a){const r=a.part.begin,o=a.part.end,i=r.sam(),l=r.sub(i).div(n).min(1),c=o.sub(i).div(n).min(1),u=new da(i.add(l),i.add(c)),h=a.whole?new da(u.begin.sub(r.sub(a.whole.begin).div(n)),u.end.add(a.whole.end.sub(o).div(n))):void 0;return new aa(h,u,a.value,a.context)};return e.withQuerySpanMaybe(t).withHap(s).splitQueries()}),hye=Ie("focus",function(n,e,t){return n=ht(n),e=ht(e),t._early(n.sam())._fast(ht(1).div(e.sub(n)))._late(n)}),{focusSpan:dye,focusspan:mye}=Ie(["focusSpan","focusspan"],function(n,e){return e._focus(n.begin,n.end)}),pye=Ie("ply",function(n,e){const t=e.fmap(s=>Ys(s)._fast(n)).squeezeJoin();return Qo&&(t._steps=ht(n).mulmaybe(e._steps)),t}),{fast:fye,density:C6e}=Ie(["fast","density"],function(n,e){return n===0?us:(n=ht(n),e.withQueryTime(t=>t.mul(n)).withHapTime(t=>t.div(n)).setSteps(e._steps))},!0,!0),gye=Ie("hurry",function(n,e){return e._fast(n).mul(Ys({speed:n}))}),{slow:bye,sparsity:yye}=Ie(["slow","sparsity"],function(n,e){return n===0?us:e._fast(ht(1).div(n))}),vye=Ie("inside",function(n,e,t){return e(t._slow(n))._fast(n)}),wye=Ie("outside",function(n,e,t){return e(t._fast(n))._slow(n)}),Oye=Ie("lastOf",function(n,e,t){const s=Array(n-1).fill(t);return s.push(e(t)),SA(...s)}),{firstOf:xye,every:kye}=Ie(["firstOf","every"],function(n,e,t){const s=Array(n-1).fill(t);return s.unshift(e(t)),SA(...s)}),Pye=Ie("apply",function(n,e){return n(e)}),Sye=Ie("cpm",function(n,e){return e._fast(n/60/1)}),Cye=Ie("early",function(n,e){return n=ht(n),e.withQueryTime(t=>t.add(n)).withHapTime(t=>t.sub(n))},!0,!0),kL=Ie("late",function(n,e){return n=ht(n),e._early(ht(0).sub(n))},!0,!0),Mye=Ie("zoom",function(n,e,t){var r;if(e=ht(e),n=ht(n),n.gte(e))return el;const s=e.sub(n),a=Qo?(r=t._steps)==null?void 0:r.mulmaybe(s):void 0;return t.withQuerySpan(o=>o.withCycle(i=>i.mul(s).add(n))).withHapSpan(o=>o.withCycle(i=>i.sub(n).div(s))).splitQueries().setSteps(a)}),{zoomArc:Aye,zoomarc:Eye}=Ie(["zoomArc","zoomarc"],function(n,e){return e.zoom(n.begin,n.end)}),Dye=Ie("bite",(n,e,t)=>e.fmap(s=>a=>{const r=ht(s).div(a).mod(1),o=r.add(ht(1).div(a));return t.zoom(r,o)}).appLeft(n).squeezeJoin(),!1),Tye=Ie("linger",function(n,e){return n==0?us:n<0?e._zoom(n.add(1),1)._slow(n):e._zoom(0,n)._slow(n)},!0,!0),{segment:Fye,seg:Nye}=Ie(["segment","seg"],function(n,e){return e.struct(Ys(!0)._fast(n)).setSteps(n)}),Bye=Ie("swingBy",(n,e,t)=>t.inside(e,kL(xL(0,n/2)))),$ye=Ie("swing",(n,e)=>e.swingBy(1/3,n)),{invert:Rye,inv:_ye}=Ie(["invert","inv"],function(n){return n.fmap(e=>!e)},!0,!0),Lye=Ie("when",function(n,e,t){return n?e(t):t}),Iye=Ie("off",function(n,e,t){return js(t,e(t.late(n)))}),Qye=Ie("brak",function(n){return n.when(zu(!1,!0),e=>fr(e,us)._late(.25))}),PL=Ie("rev",function(n){const e=function(t){const s=t.span,a=s.begin.sam(),r=s.begin.nextSam(),o=function(i){const l=i.withTime(u=>a.add(r.sub(u))),c=l.begin;return l.begin=l.end,l.end=c,l};return n.query(t.setSpan(o(s))).map(i=>i.withSpan(o))};return new dt(e).splitQueries()},!1,!0),Vye=Ie("pressBy",function(n,e){return e.fmap(t=>Ys(t).compress(n,1)).squeezeJoin()}),jye=Ie("press",function(n){return n._pressBy(.5)});dt.prototype.hush=function(){return us};const Zye=Ie("palindrome",function(n){return n.lastOf(2,PL)},!0,!0),{juxBy:zye,juxby:Gye}=Ie(["juxBy","juxby"],function(n,e,t){n/=2;const s=function(o,i,l){return i in o?o[i]:l},a=t.withValue(o=>Object.assign({},o,{pan:s(o,"pan",.5)-n})),r=e(t.withValue(o=>Object.assign({},o,{pan:s(o,"pan",.5)+n})));return js(a,r).setSteps(Qo?zi(a._steps,r._steps):void 0)}),Xye=Ie("jux",function(n,e){return e._juxBy(1,n,e)}),{echoWith:Wye,echowith:qye,stutWith:Uye,stutwith:Hye}=Ie(["echoWith","echowith","stutWith","stutwith"],function(n,e,t,s){return js(...qg(0,n-1).map(a=>t(s.late(ht(e).mul(a)),a)))}),Yye=Ie("echo",function(n,e,t,s){return s._echoWith(n,e,(a,r)=>a.gain(Math.pow(t,r)))}),Kye=Ie("stut",function(n,e,t,s){return s._echoWith(n,t,(a,r)=>a.gain(Math.pow(e,r)))}),SL=Ie("applyN",function(n,e,t){let s=t;for(let a=0;a<n;a++)s=e(s);return s}),Jye=Ie(["plyWith","plywith"],function(n,e,t){const s=t.fmap(a=>ag(...qg(0,n-1).map(r=>SL(r,e,a)))._fast(n)).squeezeJoin();return Qo&&(s._steps=ht(n).mulmaybe(t._steps)),s}),eve=Ie(["plyForEach","plyforeach"],function(n,e,t){const s=t.fmap(a=>ag(ag(Ys(a),...qg(1,n-1).map(r=>e(Ys(a),r))))._fast(n)).squeezeJoin();return Qo&&(s._steps=ht(n).mulmaybe(t._steps)),s}),CA=function(n,e,t=!1){return n=ht(n),zu(...qg(0,n.sub(1)).map(s=>t?e.late(ht(s).div(n)):e.early(ht(s).div(n))))},tve=Ie("iter",function(n,e){return CA(n,e,!1)},!0,!0),{iterBack:nve,iterback:sve}=Ie(["iterBack","iterback"],function(n,e){return CA(n,e,!0)},!0,!0),{repeatCycles:ave}=Ie("repeatCycles",function(n,e){return new dt(function(t){const s=t.span.begin.sam(),a=s.div(n).sam(),r=s.sub(a);return t=t.withSpan(o=>o.withTime(i=>i.sub(r))),e.query(t).map(o=>o.withSpan(i=>i.withTime(l=>l.add(r))))}).splitQueries()},!0,!0),MA=function(n,e,t,s=!1,a=!1){const r=Array(n-1).fill(!1);r.unshift(!0);const o=CA(n,tl(...r),!s);return a||(t=t.repeatCycles(n)),t.when(o,e)},{chunk:rve,slowchunk:ove,slowChunk:ive}=Ie(["chunk","slowchunk","slowChunk"],function(n,e,t){return MA(n,e,t,!1,!1)},!0,!0),{chunkBack:lve,chunkback:cve}=Ie(["chunkBack","chunkback"],function(n,e,t){return MA(n,e,t,!0)},!0,!0),{fastchunk:uve,fastChunk:hve}=Ie(["fastchunk","fastChunk"],function(n,e,t){return MA(n,e,t,!1,!0)},!0,!0),{chunkinto:dve,chunkInto:mve}=Ie(["chunkinto","chunkInto"],function(n,e,t){return t.into(fr(!0,...Array(n-1).fill(!1))._iterback(n),e)}),{chunkbackinto:pve,chunkBackInto:fve}=Ie(["chunkbackinto","chunkBackInto"],function(n,e,t){return t.into(fr(!0,...Array(n-1).fill(!1))._iter(n)._early(1),e)}),gve=Ie("bypass",function(n,e){return n=!!parseInt(n),n?us:e},!0,!0),{ribbon:bve,rib:yve}=Ie(["ribbon","rib"],(n,e,t)=>t.early(n).restart(Ys(1).slow(e))),vve=Ie("hsla",(n,e,t,s,a)=>a.color(`hsla(${n}turn,${e*100}%,${t*100}%,${s})`)),wve=Ie("hsl",(n,e,t,s)=>s.color(`hsl(${n}turn,${e*100}%,${t*100}%)`));dt.prototype.tag=function(n){return this.withContext(e=>({...e,tags:(e.tags||[]).concat([n])}))};const Ove=Ie("filter",(n,e)=>e.withHaps(t=>t.filter(n))),xve=Ie("filterWhen",(n,e)=>e.filter(t=>n(t.whole.begin))),kve=Ie("within",(n,e,t,s)=>js(t(s.filterWhen(a=>a.cyclePos()>=n&&a.cyclePos()<=e)),s.filterWhen(a=>a.cyclePos()<n||a.cyclePos()>e)));dt.prototype.stepJoin=function(){const n=this,e=go(...q2(U2(n.queryArc(0,1))))._steps,t=function(s){const a=n.early(s.span.begin.sam()).query(s.setSpan(new da(ht(0),ht(1))));return go(...q2(U2(a))).query(s)};return new dt(t,e)};dt.prototype.stepBind=function(n){return this.fmap(n).stepJoin()};function q2(n){const e=n.filter((r,o)=>o.hasSteps).reduce((r,o)=>r.add(o),ht(0)),t=Xm(n.map((r,o)=>o._steps)).reduce((r,o)=>r.add(o),ht(0)),s=e.eq(0)?void 0:t.div(e);function a(r,o){return o._steps===void 0?[r.mulmaybe(s),o]:[o._steps,o]}return n.map(r=>a(...r))}function U2(n){const e=Pc(n.map(s=>[s.part.begin,s.part.end])),t=cL([ht(0),ht(1),...e]);return lL(t).map(s=>[s[1].sub(s[0]),js(...CL(new da(...s),n).map(a=>a.value.withHap(r=>r.setContext(r.combineContext(a)))))])}function CL(n,e){return Xm(e.map(t=>ML(n,t)))}function ML(n,e){const t=n.intersection(e.part);if(t!=null)return new aa(e.whole,t,e.value,e.context)}const AL=Ie("pace",function(n,e){return e._steps===void 0?e:e._steps.eq(ht(0))?el:e._fast(ht(n).div(e._steps)).setSteps(n)});function EL(n,...e){const t=e.map(a=>W2(a));if(t.length==0)return us;n==0&&(n=t[0][1]);const s=[];for(const a of t)a[1]!=0&&(n==a[1]?s.push(a[0]):s.push(a[0]._fast(ht(n).div(ht(a[1])))));return js(...s)}function bw(...n){if(Array.isArray(n[0]))return EL(0,...n);if(n=n.filter(s=>s.hasSteps),n.length==0)return us;const e=zi(...n.map(s=>s._steps));if(e.eq(ht(0)))return el;const t=js(...n.map(s=>s.pace(e)));return t._steps=e,t}function go(...n){if(n.length===0)return el;const e=o=>Array.isArray(o)?o:[o._steps??1,o];if(n=n.map(e),n.find(o=>o[0]===void 0)){const o=n.map(l=>l[0]).filter(l=>l!==void 0);if(o.length===0)return fr(...n.map(l=>l[1]));if(o.length===n.length)return el;const i=o.reduce((l,c)=>l.add(c),ht(0)).div(o.length);for(let l of n)l[0]===void 0&&(l[0]=i)}if(n.length==1)return yt(n[0][1]).withSteps(o=>n[0][0]);const t=n.map(o=>o[0]).reduce((o,i)=>o.add(i),ht(0));let s=ht(0);const a=[];for(const[o,i]of n){if(ht(o).eq(0))continue;const l=s.add(o);a.push(yt(i)._compress(s.div(t),l.div(t))),s=l}const r=js(...a);return r._steps=t,r}function DL(...n){n=n.map(a=>Array.isArray(a)?a.map(yt):[yt(a)]);const e=zi(...n.map(a=>ht(a.length)));let t=[];for(let a=0;a<e;++a)t.push(...n.map(r=>r.length==0?us:r[a%r.length]));t=t.filter(a=>a.hasSteps&&a._steps>0);const s=t.reduce((a,r)=>a.add(r._steps),ht(0));return t=go(...t),t._steps=s,t}const TL=qm("take",function(n,e){if(!e.hasSteps||e._steps.lte(0)||(n=ht(n),n.eq(0)))return el;const t=n<0;t&&(n=n.abs());const s=n.div(e._steps);return s.lte(0)?el:s.gte(1)?e:t?e.zoom(ht(1).sub(s),1):e.zoom(0,s)}),FL=qm("drop",function(n,e){return e.hasSteps?(n=ht(n),n.lt(0)?e.take(e._steps.add(n)):e.take(ht(0).sub(e._steps.sub(n)))):el}),NL=qm("extend",function(n,e){return e.fast(n).expand(n)}),Pve=qm("replicate",function(n,e){return e.repeatCycles(n).fast(n).expand(n)}),BL=qm("expand",function(n,e){return e.withSteps(t=>t.mul(ht(n)))}),$L=qm("contract",function(n,e){return e.withSteps(t=>t.div(ht(n)))});dt.prototype.shrinklist=function(n){const e=this;if(!e.hasSteps)return[e];let[t,s]=Array.isArray(n)?n:[n,e._steps];if(t=ht(t),s===0||t===0)return[e];const a=t>0,r=[];if(a){const o=ht(1).div(e._steps).mul(t);for(let i=0;i<s;++i){const l=o.mul(i);if(l.gt(1))break;r.push([l,1])}}else{t=ht(0).sub(t);const o=ht(1).div(e._steps).mul(t);for(let i=0;i<s;++i){const l=ht(1).sub(o.mul(i));if(l.lt(0))break;r.push([ht(0),l])}}return r.map(o=>e.zoom(...o))};const RL=(n,e)=>e.shrinklist(n),_L=Ie("shrink",function(n,e){if(!e.hasSteps)return el;const t=e.shrinklist(n),s=go(...t);return s._steps=t.reduce((a,r)=>a.add(r._steps),ht(0)),s},!0,!1,n=>n.stepJoin()),Sve=Ie("grow",function(n,e){if(!e.hasSteps)return el;const t=e.shrinklist(ht(0).sub(n));t.reverse();const s=go(...t);return s._steps=t.reduce((a,r)=>a.add(r._steps),ht(0)),s},!0,!1,n=>n.stepJoin()),LL=function(n,...e){return n.tour(...e)};dt.prototype.tour=function(...n){return go(...[].concat(...n.map((e,t)=>[...n.slice(0,n.length-t),this,...n.slice(n.length-t)]),this,...n))};const IL=function(...n){n=n.filter(s=>s.hasSteps);const e=zu(...n.map(s=>s._slow(s._steps))),t=zi(...n.map(s=>s._steps));return e._fast(t).setSteps(t)},Cve=go,AA=go,Mve=go,Ave=DL,Eve=bw;dt.prototype.s_polymeter=dt.prototype.polymeter;const Dve=_L;dt.prototype.s_taper=dt.prototype.shrink;const Tve=RL;dt.prototype.s_taperlist=dt.prototype.shrinklist;const Fve=TL;dt.prototype.s_add=dt.prototype.take;const Nve=FL;dt.prototype.s_sub=dt.prototype.drop;const Bve=BL;dt.prototype.s_expand=dt.prototype.expand;const $ve=NL;dt.prototype.s_extend=dt.prototype.extend;const Rve=$L;dt.prototype.s_contract=dt.prototype.contract;const _ve=LL;dt.prototype.s_tour=dt.prototype.tour;const Lve=IL;dt.prototype.s_zip=dt.prototype.zip;const Ive=AL;dt.prototype.steps=dt.prototype.pace;const Qve=Ie("chop",function(n,e){const t=Array.from({length:n},(r,o)=>o).map(r=>({begin:r/n,end:(r+1)/n})),s=function(r,o){if("begin"in r&&"end"in r&&r.begin!==void 0&&r.end!==void 0){const i=r.end-r.begin;o={begin:r.begin+o.begin*i,end:r.begin+o.end*i}}return Object.assign({},r,o)},a=function(r){return tl(t.map(o=>s(r,o)))};return e.squeezeBind(a).setSteps(Qo?ht(n).mulmaybe(e._steps):void 0)}),Vve=Ie("striate",function(n,e){const t=Array.from({length:n},(a,r)=>r).map(a=>({begin:a/n,end:(a+1)/n})),s=zu(...t);return e.set(s)._fast(n).setSteps(Qo?ht(n).mulmaybe(e._steps):void 0)}),QL=function(n,e,t=.5){return e.speed(1/n*t).unit("c").slow(n)},VL=Ie("slice",function(n,e,t){return n.innerBind(s=>e.outerBind(a=>t.outerBind(r=>{r=r instanceof Object?r:{s:r};const o=Array.isArray(s)?s[a]:a/s,i=Array.isArray(s)?s[a+1]:(a+1)/s;return Ys({begin:o,end:i,_slices:s,...r})}))).setSteps(e._steps)},!1);dt.prototype.onTriggerTime=function(n){return this.onTrigger((e,t,s,a)=>{const r=a-t;window.setTimeout(()=>{n(e)},r*1e3)},!1)};const jve=Ie("splice",function(n,e,t){const s=VL(n,e,t);return new dt(a=>{const r=a.controls._cps||1;return s.query(a).map(o=>o.withValue(i=>({speed:r/i._slices/o.whole.duration*(i.speed||1),unit:"c",...i})))}).setSteps(e._steps)},!1),{loopAt:Zve,loopat:zve}=Ie(["loopAt","loopat"],function(n,e){const t=e._steps?e._steps.div(n):void 0;return new dt(s=>QL(n,e,s.controls._cps).query(s),t)}),Gve=Ie("fit",n=>n.withHaps((e,t)=>e.map(s=>s.withValue(a=>{const r=("end"in a?a.end:1)-("begin"in a?a.begin:0);return{...a,speed:(t.controls._cps||1)/s.whole.duration*r,unit:"c"}})))),{loopAtCps:Xve,loopatcps:Wve}=Ie(["loopAtCps","loopatcps"],function(n,e,t){return QL(n,t,e)}),jL=n=>Ys(1).withValue(()=>yt(n())).innerJoin();let E9=n=>n<.5?1:1-(n-.5)/.5,ZL=(n,e,t)=>{e=yt(e),n=yt(n),t=yt(t);let s=e.fmap(r=>({gain:E9(r)})),a=e.fmap(r=>({gain:E9(1-r)}));return js(n.mul(s),t.mul(a))};dt.prototype.xfade=function(n,e){return ZL(this,n,e)};const qve=n=>(e,t,s)=>{e=ht(e).mod(t),t=ht(t);const a=e.div(t),r=e.add(1).div(t);return n(s.fmap(o=>Ys(o)._compress(a,r)))},{beat:Uve}=Ie(["beat"],qve(n=>n.innerJoin())),EA=(n,e,t)=>{t=ht(t);const s=ht(1).div(n.length),a=i=>{const l=[];for(const[c,u]of i.entries())u&&l.push([ht(c).div(i.length),u]);return l},r=pw(([i,l],[c,u])=>{const h=t.mul(c-i).add(i),m=h.add(s);return new da(h,m)},a(n),a(e));function o(i){const l=i.span.begin.sam(),c=i.span.cycleArc(),u=[];for(const h of r){const m=h.intersection(c);m!==void 0&&u.push(new aa(h.withTime(f=>f.add(l)),m.withTime(f=>f.add(l)),!0))}return u}return new dt(o).splitQueries()},Hve=(n,e,t)=>(n=yt(n),e=yt(e),t=yt(t),n.innerBind(s=>e.innerBind(a=>t.innerBind(r=>EA(s,a,r))))),Yve=["scurve","soft","hard","cubic","diode","asym","fold","sinefold","chebyshev"];for(const n of Yve)dt.prototype[n]=function(e){const t=yt(e).fmap(s=>Array.isArray(s)?[...s,n]:[s,1,n]);return this.distort(t)};function yw(n){let e=Array.isArray(n);n=e?n:[n];const t=n[0],s=r=>{let o;if(typeof r=="object"&&r.value!==void 0&&(o={...r},r=r.value,delete o.value),e&&Array.isArray(r)){const i=o||{};return r.forEach((l,c)=>{c<n.length&&(i[n[c]]=l)}),i}else return o?(o[t]=r,o):{[t]:r}},a=function(r,o){return o?typeof r>"u"?o.fmap(s):o.set(yt(r).withValue(s)):yt(r).withValue(s)};return dt.prototype[t]=function(r){return a(r,this)},a}const rg=new Map;function zL(n){return rg.has(n)}function pe(n,...e){const t=Array.isArray(n)?n[0]:n;let s={};return s[t]=yw(n),rg.set(t,t),e.forEach(a=>{s[a]=s[t],rg.set(a,t),dt.prototype[a]=dt.prototype[t]}),s}const{s:GL,sound:XL}=pe(["s","n","gain"],"sound"),{wt:WL,wavetablePosition:qL}=pe("wt","wavetablePosition"),{wtenv:UL}=pe("wtenv"),{wtattack:HL,wtatt:YL}=pe("wtattack","wtatt"),{wtdecay:KL,wtdec:JL}=pe("wtdecay","wtdec"),{wtsustain:eI,wtsus:tI}=pe("wtsustain","wtsus"),{wtrelease:nI,wtrel:sI}=pe("wtrelease","wtrel"),{wtrate:aI}=pe("wtrate"),{wtsync:rI}=pe("wtsync"),{wtdepth:oI}=pe("wtdepth"),{wtshape:iI}=pe("wtshape"),{wtdc:lI}=pe("wtdc"),{wtskew:cI}=pe("wtskew"),{warp:uI,wavetableWarp:hI}=pe("warp","wavetableWarp"),{warpattack:dI,warpatt:mI}=pe("warpattack","warpatt"),{warpdecay:pI,warpdec:fI}=pe("warpdecay","warpdec"),{warpsustain:gI,warpsus:bI}=pe("warpsustain","warpsus"),{warprelease:yI,warprel:vI}=pe("warprelease","warprel"),{warprate:wI}=pe("warprate"),{warpdepth:OI}=pe("warpdepth"),{warpshape:xI}=pe("warpshape"),{warpdc:kI}=pe("warpdc"),{warpskew:PI}=pe("warpskew"),{warpmode:SI,wavetableWarpMode:CI}=pe("warpmode","wavetableWarpMode"),{wtphaserand:MI,wavetablePhaseRand:AI}=pe("wtphaserand","wavetablePhaseRand"),{warpenv:EI}=pe("warpenv"),{warpsync:DI}=pe("warpsync"),{source:TI,src:FI}=pe("source","src"),{n:NI}=pe("n"),{note:BI}=pe(["note","n"]),{accelerate:$I}=pe("accelerate"),{velocity:RI}=pe("velocity"),{gain:_I}=pe("gain"),{postgain:LI}=pe("postgain"),{amp:II}=pe("amp"),{attack:QI,att:VI}=pe("attack","att"),{fmh:jI}=pe(["fmh","fmi"],"fmh"),{fmi:ZI,fm:zI}=pe(["fmi","fmh"],"fm"),{fmenv:GI}=pe("fmenv"),{fmattack:XI}=pe("fmattack"),{fmwave:WI}=pe("fmwave"),{fmdecay:qI}=pe("fmdecay"),{fmsustain:UI}=pe("fmsustain"),{fmrelease:HI}=pe("fmrelease"),{fmvelocity:YI}=pe("fmvelocity"),{bank:KI}=pe("bank"),{chorus:JI}=pe("chorus"),{analyze:eQ}=pe("analyze"),{fft:tQ}=pe("fft"),{decay:nQ,dec:sQ}=pe("decay","dec"),{sustain:aQ,sus:rQ}=pe("sustain","sus"),{release:oQ,rel:iQ}=pe("release","rel"),{hold:lQ}=pe("hold"),{bandf:cQ,bpf:uQ,bp:hQ}=pe(["bandf","bandq","bpenv"],"bpf","bp"),{bandq:dQ,bpq:mQ}=pe("bandq","bpq"),{begin:pQ}=pe("begin"),{end:fQ}=pe("end"),{loop:gQ}=pe("loop"),{loopBegin:bQ,loopb:yQ}=pe("loopBegin","loopb"),{loopEnd:vQ,loope:wQ}=pe("loopEnd","loope"),{crush:OQ}=pe("crush"),{coarse:xQ}=pe("coarse"),{tremolo:kQ}=pe(["tremolo","tremolodepth","tremoloskew","tremolophase"],"trem"),{tremolosync:PQ}=pe(["tremolosync","tremolodepth","tremoloskew","tremolophase"],"tremsync"),{tremolodepth:SQ}=pe("tremolodepth","tremdepth"),{tremoloskew:CQ}=pe("tremoloskew","tremskew"),{tremolophase:MQ}=pe("tremolophase","tremphase"),{tremoloshape:AQ}=pe("tremoloshape","tremshape"),{drive:EQ}=pe("drive"),{duck:DQ}=pe("duckorbit","duck"),{duckdepth:TQ}=pe("duckdepth"),{duckonset:FQ}=pe("duckonset","duckons"),{duckattack:NQ}=pe("duckattack","duckatt"),{byteBeatExpression:BQ,bbexpr:$Q}=pe("byteBeatExpression","bbexpr"),{byteBeatStartTime:RQ,bbst:_Q}=pe("byteBeatStartTime","bbst"),{channels:LQ,ch:IQ}=pe("channels","ch"),{pw:QQ}=pe(["pw","pwrate","pwsweep"]),{pwrate:VQ}=pe("pwrate"),{pwsweep:jQ}=pe("pwsweep"),{phaserrate:ZQ,ph:zQ,phaser:GQ}=pe(["phaserrate","phaserdepth","phasercenter","phasersweep"],"ph","phaser"),{phasersweep:XQ,phs:WQ}=pe("phasersweep","phs"),{phasercenter:qQ,phc:UQ}=pe("phasercenter","phc"),{phaserdepth:HQ,phd:YQ,phasdp:KQ}=pe("phaserdepth","phd","phasdp"),{channel:JQ}=pe("channel"),{cut:eV}=pe("cut"),{cutoff:tV,ctf:nV,lpf:sV,lp:aV}=pe(["cutoff","resonance","lpenv"],"ctf","lpf","lp"),{lpenv:rV,lpe:oV}=pe("lpenv","lpe"),{hpenv:iV,hpe:lV}=pe("hpenv","hpe"),{bpenv:cV,bpe:uV}=pe("bpenv","bpe"),{lpattack:hV,lpa:dV}=pe("lpattack","lpa"),{hpattack:mV,hpa:pV}=pe("hpattack","hpa"),{bpattack:fV,bpa:gV}=pe("bpattack","bpa"),{lpdecay:bV,lpd:yV}=pe("lpdecay","lpd"),{hpdecay:vV,hpd:wV}=pe("hpdecay","hpd"),{bpdecay:OV,bpd:xV}=pe("bpdecay","bpd"),{lpsustain:kV,lps:PV}=pe("lpsustain","lps"),{hpsustain:SV,hps:CV}=pe("hpsustain","hps"),{bpsustain:MV,bps:AV}=pe("bpsustain","bps"),{lprelease:EV,lpr:DV}=pe("lprelease","lpr"),{hprelease:TV,hpr:FV}=pe("hprelease","hpr"),{bprelease:NV,bpr:BV}=pe("bprelease","bpr"),{ftype:$V}=pe("ftype"),{fanchor:RV}=pe("fanchor"),{vib:_V,vibrato:LV,v:IV}=pe(["vib","vibmod"],"vibrato","v"),{noise:QV}=pe("noise"),{vibmod:VV,vmod:jV}=pe(["vibmod","vib"],"vmod"),{hcutoff:ZV,hpf:zV,hp:GV}=pe(["hcutoff","hresonance","hpenv"],"hpf","hp"),{hresonance:XV,hpq:WV}=pe("hresonance","hpq"),{resonance:qV,lpq:UV}=pe("resonance","lpq"),{djf:HV}=pe("djf"),{delay:YV}=pe(["delay","delaytime","delayfeedback"]),{delayfeedback:KV,delayfb:JV,dfb:ej}=pe("delayfeedback","delayfb","dfb"),{delayspeed:tj}=pe("delayspeed"),{delaytime:nj,delayt:sj,dt:aj}=pe("delaytime","delayt","dt"),{delaysync:rj}=pe("delaysync"),{lock:oj}=pe("lock"),{detune:ij,det:lj}=pe("detune","det"),{unison:cj}=pe("unison"),{spread:uj}=pe("spread"),{dry:hj}=pe("dry"),{fadeTime:dj,fadeOutTime:mj}=pe("fadeTime","fadeOutTime"),{fadeInTime:pj}=pe("fadeInTime"),{freq:fj}=pe("freq"),{pattack:gj,patt:bj}=pe("pattack","patt"),{pdecay:yj,pdec:vj}=pe("pdecay","pdec"),{psustain:wj,psus:Oj}=pe("psustain","psus"),{prelease:xj,prel:kj}=pe("prelease","prel"),{penv:Pj}=pe("penv"),{pcurve:Sj}=pe("pcurve"),{panchor:Cj}=pe("panchor"),{gate:Mj,gat:Aj}=pe("gate","gat"),{leslie:Ej}=pe("leslie"),{lrate:Dj}=pe("lrate"),{lsize:Tj}=pe("lsize"),{activeLabel:Fj}=pe("activeLabel"),{label:Nj}=pe(["label","activeLabel"]),{degree:Bj}=pe("degree"),{mtranspose:$j}=pe("mtranspose"),{ctranspose:Rj}=pe("ctranspose"),{harmonic:_j}=pe("harmonic"),{stepsPerOctave:Lj}=pe("stepsPerOctave"),{octaveR:Ij}=pe("octaveR"),{nudge:Qj}=pe("nudge"),{octave:Vj}=pe("octave"),{orbit:jj}=pe("orbit"),{overgain:Zj}=pe("overgain"),{overshape:zj}=pe("overshape"),{pan:Gj}=pe("pan"),{panspan:Xj}=pe("panspan"),{pansplay:Wj}=pe("pansplay"),{panwidth:qj}=pe("panwidth"),{panorient:Uj}=pe("panorient"),{rate:Hj}=pe("rate"),{slide:Yj}=pe("slide"),{semitone:Kj}=pe("semitone"),{voice:Jj}=pe("voice"),{chord:eZ}=pe("chord"),{dictionary:tZ,dict:nZ}=pe("dictionary","dict"),{anchor:sZ}=pe("anchor"),{offset:aZ}=pe("offset"),{octaves:rZ}=pe("octaves"),{mode:oZ}=pe(["mode","anchor"]),{room:iZ}=pe(["room","size"]),{roomlp:lZ,rlp:cZ}=pe("roomlp","rlp"),{roomdim:uZ,rdim:hZ}=pe("roomdim","rdim"),{roomfade:dZ,rfade:mZ}=pe("roomfade","rfade"),{ir:pZ,iresponse:fZ}=pe(["ir","i"],"iresponse"),{irspeed:gZ}=pe("irspeed"),{irbegin:bZ}=pe("irbegin"),{roomsize:yZ,size:vZ,sz:wZ,rsize:OZ}=pe("roomsize","size","sz","rsize"),{shape:xZ}=pe(["shape","shapevol"]),{distort:kZ,dist:PZ}=pe(["distort","distortvol","distorttype"],"dist"),{distortvol:SZ}=pe("distortvol","distvol"),{distorttype:CZ}=pe("distorttype","disttype"),{compressor:MZ}=pe(["compressor","compressorRatio","compressorKnee","compressorAttack","compressorRelease"]),{compressorKnee:AZ}=pe("compressorKnee"),{compressorRatio:EZ}=pe("compressorRatio"),{compressorAttack:DZ}=pe("compressorAttack"),{compressorRelease:TZ}=pe("compressorRelease"),{speed:DA}=pe("speed"),{stretch:FZ}=pe("stretch"),{unit:NZ}=pe("unit"),{squiz:BZ}=pe("squiz"),{vowel:$Z}=pe("vowel"),{waveloss:RZ}=pe("waveloss"),{density:Kve}=pe("density"),{expression:_Z}=pe("expression"),{sustainpedal:LZ}=pe("sustainpedal"),{fshift:IZ}=pe("fshift"),{fshiftnote:QZ}=pe("fshiftnote"),{fshiftphase:VZ}=pe("fshiftphase"),{triode:jZ}=pe("triode"),{krush:ZZ}=pe("krush"),{kcutoff:zZ}=pe("kcutoff"),{octer:GZ}=pe("octer"),{octersub:XZ}=pe("octersub"),{octersubsub:WZ}=pe("octersubsub"),{ring:qZ}=pe("ring"),{ringf:UZ}=pe("ringf"),{ringdf:HZ}=pe("ringdf"),{freeze:YZ}=pe("freeze"),{xsdelay:KZ}=pe("xsdelay"),{tsdelay:JZ}=pe("tsdelay"),{real:ez}=pe("real"),{imag:tz}=pe("imag"),{enhance:nz}=pe("enhance"),{partials:sz}=pe("partials"),{comb:az}=pe("comb"),{smear:rz}=pe("smear"),{scram:oz}=pe("scram"),{binshift:iz}=pe("binshift"),{hbrick:lz}=pe("hbrick"),{lbrick:cz}=pe("lbrick"),{frameRate:uz}=pe("frameRate"),{frames:hz}=pe("frames"),{hours:dz}=pe("hours"),{minutes:mz}=pe("minutes"),{seconds:pz}=pe("seconds"),{songPtr:fz}=pe("songPtr"),{uid:gz}=pe("uid"),{val:bz}=pe("val"),{cps:yz}=pe("cps"),{clip:vz,legato:wz}=pe("clip","legato"),{duration:Oz,dur:xz}=pe("duration","dur"),{zrand:kz}=pe("zrand"),{curve:Pz}=pe("curve"),{deltaSlide:Sz}=pe("deltaSlide"),{pitchJump:Cz}=pe("pitchJump"),{pitchJumpTime:Mz}=pe("pitchJumpTime"),{lfo:Az,repeatTime:Ez}=pe("lfo","repeatTime"),{znoise:Dz}=pe("znoise"),{zmod:Tz}=pe("zmod"),{zcrush:Fz}=pe("zcrush"),{zdelay:Nz}=pe("zdelay"),{zzfx:Bz}=pe("zzfx"),{color:$z,colour:Rz}=pe(["color","colour"]);let TA=(...n)=>n.reduce((e,t)=>Object.assign(e,{[t]:yw(t)}),{});const _z=Ie("adsr",(n,e)=>{n=Array.isArray(n)?n:[n];const[t,s,a,r]=n;return e.set({attack:t,decay:s,sustain:a,release:r})}),Lz=Ie("ad",(n,e)=>{n=Array.isArray(n)?n:[n];const[t,s=t]=n;return e.attack(t).decay(s)}),Iz=Ie("ds",(n,e)=>{n=Array.isArray(n)?n:[n];const[t,s=0]=n;return e.set({decay:t,sustain:s})}),Qz=Ie("ar",(n,e)=>{n=Array.isArray(n)?n:[n];const[t,s=t]=n;return e.set({attack:t,release:s})}),{midichan:Vz}=pe("midichan"),{midimap:jz}=pe("midimap"),{midiport:Zz}=pe("midiport"),{midicmd:zz}=pe("midicmd"),Gz=Ie("control",(n,e)=>{if(!Array.isArray(n))throw new Error("control expects an array of [ccn, ccv]");const[t,s]=n;return e.ccn(t).ccv(s)}),{ccn:Xz}=pe("ccn"),{ccv:Wz}=pe("ccv"),{ctlNum:qz}=pe("ctlNum"),{nrpnn:Uz}=pe("nrpnn"),{nrpv:Hz}=pe("nrpv"),{progNum:Yz}=pe("progNum"),Kz=Ie("sysex",(n,e)=>{if(!Array.isArray(n))throw new Error("sysex expects an array of [id, data]");const[t,s]=n;return e.sysexid(t).sysexdata(s)}),{sysexid:Jz}=pe("sysexid"),{sysexdata:eG}=pe("sysexdata"),{midibend:tG}=pe("midibend"),{miditouch:nG}=pe("miditouch"),{polyTouch:sG}=pe("polyTouch"),{oschost:aG}=pe("oschost"),{oscport:rG}=pe("oscport"),FA=n=>rg.has(n)?rg.get(n):n,oG=Ie("as",(n,e)=>(n=Array.isArray(n)?n:[n],e.fmap(t=>(t=Array.isArray(t)?t:[t],t=Object.fromEntries(n.map((s,a)=>[FA(s),t[a]])),t)))),iG=Ie("scrub",(n,e)=>n.outerBind(t=>{Array.isArray(t)||(t=[t]);const[s,a=1]=t;return e.begin(s).mul(DA(a)).clip(1)}),!1),Jve=Object.freeze(Object.defineProperty({__proto__:null,accelerate:$I,activeLabel:Fj,ad:Lz,adsr:_z,amp:II,analyze:eQ,anchor:sZ,ar:Qz,as:oG,att:VI,attack:QI,bandf:cQ,bandq:dQ,bank:KI,bbexpr:$Q,bbst:_Q,begin:pQ,binshift:iz,bp:hQ,bpa:gV,bpattack:fV,bpd:xV,bpdecay:OV,bpe:uV,bpenv:cV,bpf:uQ,bpq:mQ,bpr:BV,bprelease:NV,bps:AV,bpsustain:MV,byteBeatExpression:BQ,byteBeatStartTime:RQ,ccn:Xz,ccv:Wz,ch:IQ,channel:JQ,channels:LQ,chord:eZ,chorus:JI,clip:vz,coarse:xQ,color:$z,colour:Rz,comb:az,compressor:MZ,compressorAttack:DZ,compressorKnee:AZ,compressorRatio:EZ,compressorRelease:TZ,control:Gz,cps:yz,createParam:yw,createParams:TA,crush:OQ,ctf:nV,ctlNum:qz,ctranspose:Rj,curve:Pz,cut:eV,cutoff:tV,dec:sQ,decay:nQ,degree:Bj,delay:YV,delayfb:JV,delayfeedback:KV,delayspeed:tj,delaysync:rj,delayt:sj,delaytime:nj,deltaSlide:Sz,density:Kve,det:lj,detune:ij,dfb:ej,dict:nZ,dictionary:tZ,dist:PZ,distort:kZ,distorttype:CZ,distortvol:SZ,djf:HV,drive:EQ,dry:hj,ds:Iz,dt:aj,duck:DQ,duckattack:NQ,duckdepth:TQ,duckonset:FQ,dur:xz,duration:Oz,end:fQ,enhance:nz,expression:_Z,fadeInTime:pj,fadeOutTime:mj,fadeTime:dj,fanchor:RV,fft:tQ,fm:zI,fmattack:XI,fmdecay:qI,fmenv:GI,fmh:jI,fmi:ZI,fmrelease:HI,fmsustain:UI,fmvelocity:YI,fmwave:WI,frameRate:uz,frames:hz,freeze:YZ,freq:fj,fshift:IZ,fshiftnote:QZ,fshiftphase:VZ,ftype:$V,gain:_I,gat:Aj,gate:Mj,getControlName:FA,harmonic:_j,hbrick:lz,hcutoff:ZV,hold:lQ,hours:dz,hp:GV,hpa:pV,hpattack:mV,hpd:wV,hpdecay:vV,hpe:lV,hpenv:iV,hpf:zV,hpq:WV,hpr:FV,hprelease:TV,hps:CV,hpsustain:SV,hresonance:XV,imag:tz,ir:pZ,irbegin:bZ,iresponse:fZ,irspeed:gZ,isControlName:zL,kcutoff:zZ,krush:ZZ,label:Nj,lbrick:cz,legato:wz,leslie:Ej,lfo:Az,lock:oj,loop:gQ,loopBegin:bQ,loopEnd:vQ,loopb:yQ,loope:wQ,lp:aV,lpa:dV,lpattack:hV,lpd:yV,lpdecay:bV,lpe:oV,lpenv:rV,lpf:sV,lpq:UV,lpr:DV,lprelease:EV,lps:PV,lpsustain:kV,lrate:Dj,lsize:Tj,midibend:tG,midichan:Vz,midicmd:zz,midimap:jz,midiport:Zz,miditouch:nG,minutes:mz,mode:oZ,mtranspose:$j,n:NI,noise:QV,note:BI,nrpnn:Uz,nrpv:Hz,nudge:Qj,octave:Vj,octaveR:Ij,octaves:rZ,octer:GZ,octersub:XZ,octersubsub:WZ,offset:aZ,orbit:jj,oschost:aG,oscport:rG,overgain:Zj,overshape:zj,pan:Gj,panchor:Cj,panorient:Uj,panspan:Xj,pansplay:Wj,panwidth:qj,partials:sz,patt:bj,pattack:gj,pcurve:Sj,pdec:vj,pdecay:yj,penv:Pj,ph:zQ,phasdp:KQ,phaser:GQ,phasercenter:qQ,phaserdepth:HQ,phaserrate:ZQ,phasersweep:XQ,phc:UQ,phd:YQ,phs:WQ,pitchJump:Cz,pitchJumpTime:Mz,polyTouch:sG,postgain:LI,prel:kj,prelease:xj,progNum:Yz,psus:Oj,psustain:wj,pw:QQ,pwrate:VQ,pwsweep:jQ,rate:Hj,rdim:hZ,real:ez,registerControl:pe,rel:iQ,release:oQ,repeatTime:Ez,resonance:qV,rfade:mZ,ring:qZ,ringdf:HZ,ringf:UZ,rlp:cZ,room:iZ,roomdim:uZ,roomfade:dZ,roomlp:lZ,roomsize:yZ,rsize:OZ,s:GL,scram:oz,scrub:iG,seconds:pz,semitone:Kj,shape:xZ,size:vZ,slide:Yj,smear:rz,songPtr:fz,sound:XL,source:TI,speed:DA,spread:uj,squiz:BZ,src:FI,stepsPerOctave:Lj,stretch:FZ,sus:rQ,sustain:aQ,sustainpedal:LZ,sysex:Kz,sysexdata:eG,sysexid:Jz,sz:wZ,tremolo:kQ,tremolodepth:SQ,tremolophase:MQ,tremoloshape:AQ,tremoloskew:CQ,tremolosync:PQ,triode:jZ,tsdelay:JZ,uid:gz,unison:cj,unit:NZ,v:IV,val:bz,velocity:RI,vib:_V,vibmod:VV,vibrato:LV,vmod:jV,voice:Jj,vowel:$Z,warp:uI,warpatt:mI,warpattack:dI,warpdc:kI,warpdec:fI,warpdecay:pI,warpdepth:OI,warpenv:EI,warpmode:SI,warprate:wI,warprel:vI,warprelease:yI,warpshape:xI,warpskew:PI,warpsus:bI,warpsustain:gI,warpsync:DI,waveloss:RZ,wavetablePhaseRand:AI,wavetablePosition:qL,wavetableWarp:hI,wavetableWarpMode:CI,wt:WL,wtatt:YL,wtattack:HL,wtdc:lI,wtdec:JL,wtdecay:KL,wtdepth:oI,wtenv:UL,wtphaserand:MI,wtrate:aI,wtrel:sI,wtrelease:nI,wtshape:iI,wtskew:cI,wtsus:tI,wtsustain:eI,wtsync:rI,xsdelay:KZ,zcrush:Fz,zdelay:Nz,zmod:Tz,znoise:Dz,zrand:kz,zzfx:Bz},Symbol.toStringTag,{value:"Module"})),ewe=function(n,e){const[t,s]=n,[a,r]=e,[o,i]=xA(s,a);return[[s,t-s],[pw((l,c)=>l.concat(c),o,r),i]]},twe=function(n,e){const[t,s]=n,[a,r]=e,[o,i]=xA(t,r);return[[t,s-t],[pw((l,c)=>l.concat(c),a,o),i]]},lG=function(n,e){const[t,s]=n;return Math.min(t,s)<=1?[n,e]:lG(...t>s?ewe(n,e):twe(n,e))},NA=function(n,e){const t=n<0,s=Math.abs(n),a=e-s,r=Array(s).fill([1]),o=Array(a).fill([0]),i=lG([s,a],[r,o]),l=Pc(i[1][0]).concat(Pc(i[1][1]));return t?l.map(c=>1-c):l},vw=function(n,e,t){const s=NA(n,e);return t?rL(s,-t):s},nwe=Ie("euclid",function(n,e,t){return t.struct(vw(n,e,0))}),swe=Ie("e",function(n,e){Array.isArray(n)||(n=[n]);const[t,s=t,a=0]=n;return e.struct(vw(t,s,a))}),{euclidrot:awe,euclidRot:rwe}=Ie(["euclidrot","euclidRot"],function(n,e,t,s){return s.struct(vw(n,e,t))}),cG=function(n,e,t,s){if(n<1)return us;const a=vw(n,e,0).join("").split("1").slice(1).map(r=>[r.length+1,!0]);return s.struct(AA(...a)).late(ht(t).div(e))},owe=Ie(["euclidLegato"],function(n,e,t){return cG(n,e,0,t)}),iwe=Ie(["euclidLegatoRot"],function(n,e,t,s){return cG(n,e,t,s)}),{euclidish:lwe,eish:cwe}=Ie(["euclidish","eish"],function(n,e,t,s){const a=EA(NA(n,e),new Array(n).fill(1),t);return s.struct(a).setSteps(e)});function uG(n,e,t=.05,s=.1,a=.1,r=globalThis.setInterval,o=globalThis.clearInterval,i=!0){let l=0,c=0,u=10**4,h=.01;const m=M=>t=M(t);a=a||s/2;const f=()=>{const M=n(),E=M+s+a;for(c===0&&(c=M+h);c<E;)c=i?Math.round(c*u)/u:c,e(c,t,l,M),c+=t,l++};let v;const O=()=>{k(),f(),v=r(f,s*1e3)},k=()=>{v!==void 0&&o(v),v=void 0};return{setDuration:m,start:O,stop:()=>{l=0,c=0,k()},pause:()=>k(),duration:t,interval:s,getPhase:()=>c,minLatency:h}}function uwe(n){return new dt(e=>[new aa(void 0,e.span,n)])}const Pi=n=>{const e=t=>[new aa(void 0,t.span,n(t.span.begin))];return new dt(e)},Ug=Pi(n=>n%1),BA=Ug.toBipolar(),ww=Pi(n=>1-n%1),$A=ww.toBipolar(),RA=Pi(n=>Math.sin(Math.PI*2*n)),hG=RA.fromBipolar(),hwe=hG._early(ht(1).div(4)),dwe=RA._early(ht(1).div(4)),dG=Pi(n=>Math.floor(n*2%2)),mwe=dG.toBipolar(),pwe=fr(Ug,ww),fwe=fr(BA,$A),gwe=fr(ww,Ug),bwe=fr($A,BA),_A=Pi(Od);let LA=0,IA=0;typeof window<"u"&&document.addEventListener("mousemove",n=>{LA=n.clientY/document.body.clientHeight,IA=n.clientX/document.body.clientWidth});const ywe=Pi(()=>LA),vwe=Pi(()=>LA),wwe=Pi(()=>IA),Owe=Pi(()=>IA),mG=n=>{const e=n<<13^n,t=e>>17^e;return t<<5^t},xwe=n=>n-Math.trunc(n),pG=n=>mG(Math.trunc(xwe(n/300)*536870912)),fG=n=>n%536870912/536870912,og=n=>Math.abs(fG(pG(n))),kwe=(n,e)=>{const t=[];for(let s=0;s<e;++s)t.push(fG(n)),n=mG(n);return t},Pwe=(n,e)=>kwe(pG(n),e),gG=n=>Ug.range(0,n).round().segment(n),Swe=n=>{const e=yt(n).log2(0).floor().add(1);return bG(n,e)},bG=(n,e=16)=>{e=yt(e);const t=gG(e).mul(-1).add(e.sub(1));return yt(n).segment(e).brshift(t).band(Ys(1))},yG=n=>Pi(e=>{const t=Pwe(e.floor().add(.5),n).map((a,r)=>[a,r]).sort((a,r)=>(a[0]>r[0])-(a[0]<r[0])).map(a=>a[1]),s=e.cyclePos().mul(n).floor()%n;return t[s]})._segment(n),vG=(n,e,t)=>{const s=[...Array(e).keys()].map(a=>t.zoom(ht(a).div(e),ht(a+1).div(e)));return n.fmap(a=>s[a].repeatCycles(e)._fast(e)).innerJoin()},Cwe=Ie("shuffle",(n,e)=>vG(yG(n),n,e)),Mwe=Ie("scramble",(n,e)=>vG(VA(n)._segment(n),n,e)),Fr=Pi(og),Awe=Fr.toBipolar(),QA=n=>Fr.fmap(e=>e<n),Ewe=n=>yt(n).fmap(QA).innerJoin(),Dwe=QA(.5),VA=n=>Fr.fmap(e=>Math.trunc(e*n)),Twe=n=>yt(n).fmap(VA).innerJoin(),jA=(n,e)=>(e=e.map(yt),e.length==0?us:n.range(0,e.length).fmap(t=>{const s=Math.min(Math.max(Math.floor(t),0),e.length-1);return e[s]})),Ow=(n,e)=>jA(n,e).outerJoin(),xw=(n,e)=>jA(n,e).innerJoin(),wG=(...n)=>Ow(Fr,n),Fwe=(...n)=>xw(Fr,n),Nwe=wG;dt.prototype.choose=function(...n){return Ow(this,n)};dt.prototype.choose2=function(...n){return Ow(this.fromBipolar(),n)};const OG=(...n)=>xw(Fr.segment(1),n),Bwe=OG,xG=function(n,...e){const t=e.map(i=>yt(i[0])),s=[];let a=Ys(0);for(const i of e)a=a.add(i[1]),s.push(a);const r=yL(s),o=function(i){const l=a.mul(i);return r.fmap(c=>u=>t[c.findIndex(h=>h>u,c)]).appLeft(l)};return n.bind(o)},$we=(...n)=>xG(...n).outerJoin(),Rwe=(...n)=>$we(Fr,...n),kG=(...n)=>xG(Fr.segment(1),...n).innerJoin(),_we=kG;function Lwe(n){let e=Math.floor(n),t=e+1;const s=a=>6*a**5-15*a**4+10*a**3;return(a=>r=>o=>r+s(a)*(o-r))(n-e)(og(e))(og(t))}const PG=n=>n.fmap(Lwe);function Iwe(n){const e=Math.floor(n),t=e+1,s=og(e),a=og(t)+s,r=(n-e)/(t-e);return((o,i,l)=>o+(i-o)*l)(s,a,r)/2}const SG=n=>n.fmap(Iwe),Qwe=PG(_A.fmap(n=>Number(n))),Vwe=SG(_A.fmap(n=>Number(n))),jwe=Ie("degradeByWith",(n,e,t)=>t.fmap(s=>a=>s).appLeft(n.filterValues(s=>s>e)),!0,!0),Zwe=Ie("degradeBy",function(n,e){return e._degradeByWith(Fr,n)},!0,!0),zwe=Ie("degrade",n=>n._degradeBy(.5),!0,!0),Gwe=Ie("undegradeBy",function(n,e){return e._degradeByWith(Fr.fmap(t=>1-t),n)},!0,!0),Xwe=Ie("undegrade",n=>n._undegradeBy(.5),!0,!0),Wwe=Ie("sometimesBy",function(n,e,t){return yt(n).fmap(s=>js(t._degradeBy(s),e(t._undegradeBy(1-s)))).innerJoin()}),qwe=Ie("sometimes",function(n,e){return e._sometimesBy(.5,n)}),Uwe=Ie("someCyclesBy",function(n,e,t){return yt(n).fmap(s=>js(t._degradeByWith(Fr._segment(1),s),e(t._degradeByWith(Fr.fmap(a=>1-a)._segment(1),1-s)))).innerJoin()}),Hwe=Ie("someCycles",function(n,e){return e._someCyclesBy(.5,n)}),Ywe=Ie("often",function(n,e){return e.sometimesBy(.75,n)}),Kwe=Ie("rarely",function(n,e){return e.sometimesBy(.25,n)}),Jwe=Ie("almostNever",function(n,e){return e.sometimesBy(.1,n)}),eOe=Ie("almostAlways",function(n,e){return e.sometimesBy(.9,n)}),tOe=Ie("never",function(n,e){return e}),nOe=Ie("always",function(n,e){return n(e)});function ZA(n){Array.isArray(n)===!1&&(n=[n]);const e=fL();return n.every(t=>{const s=pL.get(t)??t;return e[s]})}const sOe=Ie("whenKey",function(n,e,t){return t.when(ZA(n),e)}),aOe=Ie("keyDown",function(n){return n.fmap(ZA)}),tc=function(n,e,t=!0){const s=Array.isArray(n),a=Object.keys(n).length;return n=dL(n,yt),a===0?us:e.fmap(r=>{let o=r;return s&&(o=t?Math.round(o)%a:fw(Math.round(o),0,n.length-1)),n[o]})},CG=function(n,e){return Array.isArray(e)&&([e,n]=[n,e]),rOe(n,e)},rOe=Ie("pick",function(n,e){return tc(n,e,!1).innerJoin()}),MG=Ie("pickmod",function(n,e){return tc(n,e,!0).innerJoin()}),oOe=Ie("pickF",function(n,e,t){return t.apply(CG(n,e))}),iOe=Ie("pickmodF",function(n,e,t){return t.apply(MG(n,e))}),lOe=Ie("pickOut",function(n,e){return tc(n,e,!1).outerJoin()}),cOe=Ie("pickmodOut",function(n,e){return tc(n,e,!0).outerJoin()}),uOe=Ie("pickRestart",function(n,e){return tc(n,e,!1).restartJoin()}),hOe=Ie("pickmodRestart",function(n,e){return tc(n,e,!0).restartJoin()}),dOe=Ie("pickReset",function(n,e){return tc(n,e,!1).resetJoin()}),mOe=Ie("pickmodReset",function(n,e){return tc(n,e,!0).resetJoin()}),{inhabit:pOe,pickSqueeze:fOe}=Ie(["inhabit","pickSqueeze"],function(n,e){return tc(n,e,!1).squeezeJoin()}),{inhabitmod:gOe,pickmodSqueeze:bOe}=Ie(["inhabitmod","pickmodSqueeze"],function(n,e){return tc(n,e,!0).squeezeJoin()}),yOe=(n,e)=>(e=e.map(yt),e.length==0?us:n.fmap(t=>{const s=vi(Math.round(t),e.length);return e[s]}).squeezeJoin());let Ld;try{Ld=window==null?void 0:window.speechSynthesis}catch{console.warn("cannot use window: not in browser?")}let D9=Ld==null?void 0:Ld.getVoices();function vOe(n,e,t){Ld.cancel();const s=new SpeechSynthesisUtterance(n);s.lang=e,D9=Ld.getVoices();const a=D9.filter(r=>r.lang.includes(e));typeof t=="number"?s.voice=a[t%a.length]:typeof t=="string"&&(s.voice=a.find(r=>r.name===r)),speechSynthesis.speak(s)}const wOe=Ie("speak",function(n,e,t){return t.onTrigger(s=>{vOe(s.value,n,e)})}),AG={},zA=async(...n)=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="fulfilled").map(s=>s.value);return e.forEach((s,a)=>{s.status==="rejected"&&console.warn(`evalScope: module with index ${a} could not be loaded:`,s.reason)}),t.forEach(s=>{Object.entries(s).forEach(([a,r])=>{globalThis[a]=r,AG[a]=r})}),t};function OOe(n,e={}){const{wrapExpression:t=!0,wrapAsync:s=!0}=e;t&&(n=`{${n}}`),s&&(n=`(async ()=>${n})()`);const a=`"use strict";return (${n})`;return Function(a)()}const EG=async(n,e,t)=>{let s={};if(e){const a=e(n,t);n=a.output,s=a}return{mode:"javascript",pattern:await OOe(n,{wrapExpression:!!e}),meta:s}};class xOe{constructor({onTrigger:e,onToggle:t,getTime:s}){this.started=!1,this.cps=.5,this.getTime=s,this.time_at_last_tick_message=0,this.collator=new mL({getTargetClockTime:s}),this.onToggle=t,this.latency=.1,this.cycle=0,this.id=Math.round(Date.now()*Math.random()),this.worker=new SharedWorker(new URL(""+new URL("data:text/javascript;base64,KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIEwoKXtyZXR1cm4gcGVyZm9ybWFuY2Uubm93KCkqLjAwMX1sZXQgXz0wLHI9MCxvPS41O2NvbnN0IGg9bmV3IE1hcCxtPS4xLE09bmV3IEJyb2FkY2FzdENoYW5uZWwoInN0cnVkZWx0aWNrIiksYj0ocyxlKT0+e00ucG9zdE1lc3NhZ2Uoe3R5cGU6cyxwYXlsb2FkOmV9KX0sQz1FKEwsKHMsZSx0LG4pPT57Y29uc3QgaT1yKmUsZD1zLW4sYz1uK2QsdT1pKm8sbD1fK3UsZz1uLWMtZSxmPWUqbyxwPWwrZix5PWwrZypvO2IoInRpY2siLHtiZWdpbjpsLGVuZDpwLGNwczpvLHRpbWU6bixjeWNsZTp5fSkscisrfSxtKTtsZXQgaz0hMTtjb25zdCBJPXM9PntoLnNldChzLHtzdGFydGVkOiEwfSksIWsmJihDLnN0YXJ0KCksaz0hMCl9LEE9YXN5bmMgcz0+e2guc2V0KHMse3N0YXJ0ZWQ6ITF9KTtjb25zdCBlPUFycmF5LmZyb20oaC52YWx1ZXMoKSkuc29tZSh0PT50LnN0YXJ0ZWQpOyFrfHxlfHwoQy5zdG9wKCksdygwKSxrPSExKX0sdz1zPT57cj0wLF89c30sRD1zPT57Y29uc3R7dHlwZTplLHBheWxvYWQ6dH09cztzd2l0Y2goZSl7Y2FzZSJjcHNjaGFuZ2UiOntpZih0LmNwcyE9PW8pe2NvbnN0IG49ciptO189XytuKm8sbz10LmNwcyxyPTB9YnJlYWt9Y2FzZSJzZXRjeWNsZSI6e3codC5jeWNsZSk7YnJlYWt9Y2FzZSJ0b2dnbGUiOnt0LnN0YXJ0ZWQ/SShzLmlkKTpBKHMuaWQpO2JyZWFrfX19O3NlbGYub25jb25uZWN0PWZ1bmN0aW9uKHMpe2NvbnN0IGU9cy5wb3J0c1swXTtlLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLGZ1bmN0aW9uKHQpe0QodC5kYXRhKX0pLGUuc3RhcnQoKX07ZnVuY3Rpb24gRShzLGUsdD0uMDUsbj0uMSxpPS4xKXtsZXQgZD0wLGM9MCx1PTEwKio0LGw9LjAxO2NvbnN0IGc9YT0+dD1hKHQpO2k9aXx8bi8yO2NvbnN0IGY9KCk9Pntjb25zdCBhPXMoKSxPPWErbitpO2ZvcihjPT09MCYmKGM9YStsKTtjPE87KWM9TWF0aC5yb3VuZChjKnUpL3UsYz49YSYmZShjLHQsZCxhKSxjPGEmJmNvbnNvbGUubG9nKCJUT08gTEFURSIsYyksYys9dCxkKyt9O2xldCBwO2NvbnN0IHk9KCk9PntUKCksZigpLHA9c2V0SW50ZXJ2YWwoZixuKjFlMyl9LFQ9KCk9PnAhPT12b2lkIDAmJmNsZWFySW50ZXJ2YWwocCk7cmV0dXJue3NldER1cmF0aW9uOmcsc3RhcnQ6eSxzdG9wOigpPT57ZD0wLGM9MCxUKCl9LHBhdXNlOigpPT5UKCksZHVyYXRpb246dCxpbnRlcnZhbDpuLGdldFBoYXNlOigpPT5jLG1pbkxhdGVuY3k6bH19fSkoKTsK",import.meta.url).href,import.meta.url)),this.worker.port.start(),this.channel=new BroadcastChannel("strudeltick");const a=o=>{const{cps:i,begin:l,end:c,cycle:u,time:h}=o;this.cps=i,this.cycle=u;const m=this.collator.calculateOffset(h)+h;r(l,c,m),this.time_at_last_tick_message=m},r=(o,i,l)=>{this.started!==!1&&this.pattern.queryArc(o,i,{_cps:this.cps,cyclist:"neocyclist"}).forEach(c=>{if(c.hasOnset()){const u=G2(c.whole.begin-this.cycle,this.cps)+l+this.latency,h=G2(c.duration,this.cps);e==null||e(c,0,h,this.cps,u)}})};this.channel.onmessage=o=>{if(!this.started)return;const{payload:i,type:l}=o.data;switch(l){case"tick":a(i)}}}sendMessage(e,t){this.worker.port.postMessage({type:e,payload:t,id:this.id})}now(){const e=(this.getTime()-this.time_at_last_tick_message)*this.cps;return this.cycle+e}setCps(e=1){this.sendMessage("cpschange",{cps:e})}setCycle(e){this.sendMessage("setcycle",{cycle:e})}setStarted(e){var t;this.sendMessage("toggle",{started:e}),this.started=e,(t=this.onToggle)==null||t.call(this,e)}start(){Za("[cyclist] start"),this.setStarted(!0)}stop(){Za("[cyclist] stop"),this.collator.reset(),this.setStarted(!1)}setPattern(e,t=!1){this.pattern=e,t&&!this.started&&this.start()}log(e,t,s){const a=s.filter(r=>r.hasOnset());console.log(`${e.toFixed(4)} - ${t.toFixed(4)} ${Array(a.length).fill("I").join("")}`)}}class DG{constructor({interval:e,onTrigger:t,onToggle:s,onError:a,getTime:r,latency:o=.1,setInterval:i,clearInterval:l,beforeStart:c}){this.started=!1,this.beforeStart=c,this.cps=.5,this.num_ticks_since_cps_change=0,this.lastTick=0,this.lastBegin=0,this.lastEnd=0,this.getTime=r,this.num_cycles_at_cps_change=0,this.seconds_at_cps_change,this.onToggle=s,this.latency=o,this.clock=uG(r,(u,h,m,f)=>{this.num_ticks_since_cps_change===0&&(this.num_cycles_at_cps_change=this.lastEnd,this.seconds_at_cps_change=u),this.num_ticks_since_cps_change++;const v=this.num_ticks_since_cps_change*h*this.cps;try{const O=this.lastEnd;this.lastBegin=O;const k=this.num_cycles_at_cps_change+v;if(this.lastEnd=k,this.lastTick=u,u<f){console.log("skip query: too late");return}this.pattern.queryArc(O,k,{_cps:this.cps,cyclist:"cyclist"}).forEach(M=>{if(M.hasOnset()){const E=(M.whole.begin-this.num_cycles_at_cps_change)/this.cps+this.seconds_at_cps_change+o,I=M.duration/this.cps,D=E-u;t==null||t(M,D,I,this.cps,E),M.value.cps!==void 0&&this.cps!=M.value.cps&&(this.cps=M.value.cps,this.num_ticks_since_cps_change=0)}})}catch(O){yA(O),a==null||a(O)}},e,.1,.1,i,l)}now(){if(!this.started)return 0;const e=this.getTime()-this.lastTick-this.clock.duration;return this.lastBegin+e*this.cps}setStarted(e){var t;this.started=e,(t=this.onToggle)==null||t.call(this,e)}async start(){var e;if(await((e=this.beforeStart)==null?void 0:e.call(this)),this.num_ticks_since_cps_change=0,this.num_cycles_at_cps_change=0,!this.pattern)throw new Error("Scheduler: no pattern set! call .setPattern first.");Za("[cyclist] start"),this.clock.start(),this.setStarted(!0)}pause(){Za("[cyclist] pause"),this.clock.pause(),this.setStarted(!1)}stop(){Za("[cyclist] stop"),this.clock.stop(),this.lastEnd=0,this.setStarted(!1)}async setPattern(e,t=!1){this.pattern=e,t&&!this.started&&await this.start()}setCps(e=.5){this.cps!==e&&(this.cps=e,this.num_ticks_since_cps_change=0)}log(e,t,s){const a=s.filter(r=>r.hasOnset());console.log(`${e.toFixed(4)} - ${t.toFixed(4)} ${Array(a.length).fill("I").join("")}`)}}let H2;function Y2(){if(!H2)throw new Error("no time set! use setTime to define a time source");return H2()}function K2(n){H2=n}function TG({defaultOutput:n,onEvalError:e,beforeEval:t,beforeStart:s,afterEval:a,getTime:r,transpiler:o,onToggle:i,editPattern:l,onUpdateState:c,sync:u=!1,setInterval:h,clearInterval:m,id:f,mondo:v=!1}){const O={schedulerError:void 0,evalError:void 0,code:"// LOADING",activeCode:"// LOADING",pattern:void 0,miniLocations:[],widgets:[],pending:!1,started:!1},k={id:f},M=Re=>{Object.assign(O,Re),O.isDirty=O.code!==O.activeCode,O.error=O.evalError||O.schedulerError,c==null||c(O)},E={onTrigger:FG({defaultOutput:n,getTime:r}),getTime:r,onToggle:Re=>{M({started:Re}),i==null||i(Re)},setInterval:h,clearInterval:m,beforeStart:s},I=u&&typeof SharedWorker<"u"?new xOe(E):new DG(E);let D={},F=0,_;const $=function(){return D={},F=0,_=void 0,us};function Z(Re){return Re._Pattern?Re.__pure:Re}const ce=async(Re,je=!0)=>(Re=(l==null?void 0:l(Re))||Re,await I.setPattern(Re,je),Re);K2(()=>I.now());const U=()=>I.stop(),ue=()=>I.start(),W=()=>I.pause(),de=()=>I.toggle(),be=Re=>(I.setCps(Z(Re)),us),ke=Re=>(I.setCps(Z(Re)/60),us);let Ce=[];const Ae=function(Re){return Ce.push(Re),us},q=function(Re){return _=Re,us},Ne=()=>{dt.prototype.p=function(je){return typeof je=="string"&&(je.startsWith("_")||je.endsWith("_"))?us:(je==="$"&&(je=`$${F}`,F++),D[je]=this,this)},dt.prototype.q=function(je){return us};try{for(let je=1;je<10;++je)Object.defineProperty(dt.prototype,`d${je}`,{get(){return this.p(je)},configurable:!0}),Object.defineProperty(dt.prototype,`p${je}`,{get(){return this.p(je)},configurable:!0}),dt.prototype[`q${je}`]=us}catch(je){console.warn("injectPatternMethods: error:",je)}const Re=Ie("cpm",function(je,me){return me._fast(je/60/I.cps)});return zA({all:Ae,each:q,hush:$,cpm:Re,setCps:be,setcps:be,setCpm:ke,setcpm:ke})};return{scheduler:I,evaluate:async(Re,je=!0,me=!0)=>{if(!Re)throw new Error("no code to evaluate");try{M({code:Re,pending:!0}),await Ne(),K2(()=>I.now()),await(t==null?void 0:t({code:Re})),Ce=[],me&&$(),v&&(Re=`mondolang\`${Re}\``);let{pattern:Ye,meta:ft}=await EG(Re,o,k);if(Object.keys(D).length){let _e=[];for(const[Ge,pt]of Object.entries(D))_e.push(pt.withState(rt=>rt.setControls({id:Ge})));_&&(_e=_e.map(Ge=>_(Ge))),Ye=js(..._e)}else _&&(Ye=_(Ye));if(Ce.length)for(let _e in Ce)Ye=Ce[_e](Ye);if(!gw(Ye)){const _e=`got "${typeof evaluated}" instead of pattern`;throw new Error(_e+(typeof evaluated=="function"?", did you forget to call a function?":"."))}return Za("[eval] code updated"),Ye=await ce(Ye,je),M({miniLocations:(ft==null?void 0:ft.miniLocations)||[],widgets:(ft==null?void 0:ft.widgets)||[],activeCode:Re,pattern:Ye,evalError:void 0,schedulerError:void 0,pending:!1}),a==null||a({code:Re,pattern:Ye,meta:ft}),Ye}catch(Ye){Za(`[eval] error: ${Ye.message}`,"error"),console.error(Ye),M({evalError:Ye,pending:!1}),e==null||e(Ye)}},start:ue,stop:U,pause:W,setCps:be,setPattern:ce,setCode:Re=>M({code:Re}),toggle:de,state:O}}const FG=({getTime:n,defaultOutput:e})=>async(t,s,a,r,o)=>{try{(!t.context.onTrigger||!t.context.dominantTrigger)&&await e(t,s,a,r,o),t.context.onTrigger&&await t.context.onTrigger(t,n(),r,o)}catch(i){yA(i,"getTrigger")}},kOe=function(n,e={}){const t=document.getElementById("code"),s="background-image:url("+n+");background-size:contain;";t.style=s;const{className:a}=t,r=(i,l)=>{({style:()=>t.style=s+";"+l,className:()=>t.className=l+" "+a})[i]()},o=Object.entries(e).filter(([i,l])=>typeof l=="function");Object.entries(e).filter(([i,l])=>typeof l=="string").forEach(([i,l])=>r(i,l)),o.length},POe=()=>{const n=document.getElementById("code");n&&(n.style="")};Za("🌀 @strudel/core loaded 🌀");globalThis._strudelLoaded&&console.warn(`@strudel/core was loaded more than once...
This might happen when you have multiple versions of strudel installed. 
Please check with "npm ls @strudel/core".`);globalThis._strudelLoaded=!0;const NG=Object.freeze(Object.defineProperty({__proto__:null,ClockCollator:mL,Cyclist:DG,Fraction:ht,Hap:aa,Pattern:dt,State:pm,TimeSpan:da,__chooseWith:jA,_brandBy:QA,_fitslice:CL,_irand:VA,_keyDown:ZA,_match:ML,_mod:vi,_morph:EA,_polymeterListSteps:EL,_retime:q2,_slices:U2,accelerate:$I,activeLabel:Fj,ad:Lz,add:E1e,adsr:_z,almostAlways:eOe,almostNever:Jwe,always:nOe,amp:II,analyze:eQ,anchor:sZ,and:q1e,apply:Pye,applyN:SL,ar:Qz,arp:l1e,arpWith:i1e,arrange:p1e,as:oG,att:VI,attack:QI,averageArray:nL,backgroundImage:kOe,band:$1e,bandf:cQ,bandq:dQ,bank:KI,base64ToUnicode:hL,bbexpr:$Q,bbst:_Q,beat:Uve,begin:pQ,berlin:Vwe,berlinWith:SG,binary:Swe,binaryN:bG,bind:w1e,binshift:iz,bite:Dye,bjork:NA,blshift:L1e,bor:R1e,bp:hQ,bpa:gV,bpattack:fV,bpd:xV,bpdecay:OV,bpe:uV,bpenv:cV,bpf:uQ,bpq:mQ,bpr:BV,bprelease:NV,bps:AV,bpsustain:MV,brak:Qye,brand:Dwe,brandBy:Ewe,brshift:I1e,bxor:_1e,bypass:gve,byteBeatExpression:BQ,byteBeatStartTime:RQ,calculateSteps:a1e,cat:ag,ccn:Xz,ccv:Wz,ceil:J1e,ch:IQ,channel:JQ,channels:LQ,choose:wG,chooseCycles:OG,chooseIn:Fwe,chooseInWith:xw,chooseOut:Nwe,chooseWith:Ow,chop:Qve,chord:eZ,chorus:JI,chunk:rve,chunkBack:lve,chunkBackInto:fve,chunkInto:mve,chunkback:cve,chunkbackinto:pve,chunkinto:dve,clamp:fw,cleanupUi:POe,clip:vz,coarse:xQ,code2hash:Ybe,color:$z,colour:Rz,comb:az,compose:Ibe,compress:oye,compressSpan:iye,compressor:MZ,compressorAttack:DZ,compressorKnee:AZ,compressorRatio:EZ,compressorRelease:TZ,compressspan:lye,constant:Qbe,contract:$L,control:Gz,controls:Jve,cosine:hwe,cosine2:dwe,cpm:Sye,cps:yz,createClock:uG,createParam:yw,createParams:TA,crush:OQ,ctf:nV,ctlNum:qz,ctranspose:Rj,curry:$n,curve:Pz,cut:eV,cutoff:tV,cycleToSeconds:G2,dec:sQ,decay:nQ,degrade:zwe,degradeBy:Zwe,degradeByWith:jwe,degree:Bj,delay:YV,delayfb:JV,delayfeedback:KV,delayspeed:tj,delaysync:rj,delayt:sj,delaytime:nj,deltaSlide:Sz,det:lj,detune:ij,dfb:ej,dict:nZ,dictionary:tZ,dist:PZ,distort:kZ,distorttype:CZ,distortvol:SZ,div:F1e,djf:HV,drawLine:gL,drive:EQ,drop:FL,dry:hj,ds:Iz,dt:aj,duck:DQ,duckattack:NQ,duckdepth:TQ,duckonset:FQ,dur:xz,duration:Oz,e:swe,early:Cye,echo:Yye,echoWith:Wye,echowith:qye,eish:cwe,end:fQ,enhance:nz,eq:z1e,eqt:G1e,errorLogger:yA,euclid:nwe,euclidLegato:owe,euclidLegatoRot:iwe,euclidRot:rwe,euclidish:lwe,euclidrot:awe,evalScope:zA,evaluate:EG,every:kye,expand:BL,expression:_Z,extend:NL,fadeInTime:pj,fadeOutTime:mj,fadeTime:dj,fanchor:RV,fast:fye,fastChunk:hve,fastGap:cye,fastcat:fr,fastchunk:uve,fastgap:uye,fft:tQ,filter:Ove,filterWhen:xve,firstOf:xye,fit:Gve,flatten:Pc,floor:K1e,fm:zI,fmattack:XI,fmdecay:qI,fmenv:GI,fmh:jI,fmi:ZI,fmrelease:HI,fmsustain:UI,fmvelocity:YI,fmwave:WI,focus:hye,focusSpan:dye,focusspan:mye,fractionalArgs:Vbe,frameRate:uz,frames:hz,freeze:YZ,freq:fj,freqToMidi:vA,fromBipolar:tye,fshift:IZ,fshiftnote:QZ,fshiftphase:VZ,ftype:$V,func:H1e,gain:_I,gap:Wm,gat:Aj,gate:Mj,getControlName:FA,getCurrentKeyboardState:fL,getEventOffsetMs:Bbe,getFreq:tL,getFrequency:aL,getPerformanceTimeSeconds:Jbe,getPlayableNoteValue:Lbe,getSoundIndex:_be,getTime:Y2,getTrigger:FG,grow:Sve,gt:V1e,gte:Z1e,harmonic:_j,hash2code:Kbe,hbrick:lz,hcutoff:ZV,hold:lQ,hours:dz,hp:GV,hpa:pV,hpattack:mV,hpd:wV,hpdecay:vV,hpe:lV,hpenv:iV,hpf:zV,hpq:WV,hpr:FV,hprelease:TV,hps:CV,hpsustain:SV,hresonance:XV,hsl:wve,hsla:vve,hurry:gye,id:Od,imag:tz,inhabit:pOe,inhabitmod:gOe,innerBind:O1e,inside:vye,inv:_ye,invert:Rye,ir:pZ,irand:Twe,irbegin:bZ,iresponse:fZ,irspeed:gZ,isControlName:zL,isNote:Yh,isNoteWithOctave:Tbe,isPattern:gw,isaw:ww,isaw2:$A,iter:tve,iterBack:nve,iterback:sve,itri:gwe,itri2:bwe,jux:Xye,juxBy:zye,juxby:Gye,kcutoff:zZ,keep:M1e,keepif:A1e,keyAlias:pL,keyDown:aOe,krush:ZZ,label:Nj,lastOf:Oye,late:kL,lbrick:cz,legato:wz,leslie:Ej,lfo:Az,linger:Tye,listRange:qg,lock:oj,logKey:bA,logger:Za,loop:gQ,loopAt:Zve,loopAtCps:Xve,loopBegin:bQ,loopEnd:vQ,loopat:zve,loopatcps:Wve,loopb:yQ,loope:wQ,lp:aV,lpa:dV,lpattack:hV,lpd:yV,lpdecay:bV,lpe:oV,lpenv:rV,lpf:sV,lpq:UV,lpr:DV,lprelease:EV,lps:PV,lpsustain:kV,lrate:Dj,lsize:Tj,lt:Q1e,lte:j1e,mapArgs:OA,mask:g1e,midi2note:Rbe,midiToFreq:mm,midibend:tG,midichan:Vz,midicmd:zz,midimap:jz,midiport:Zz,miditouch:nG,minutes:mz,mod:N1e,mode:oZ,morph:Hve,mouseX:Owe,mouseY:vwe,mousex:wwe,mousey:ywe,mtranspose:$j,mul:T1e,n:NI,nanFallback:sL,ne:X1e,net:W1e,never:tOe,noise:QV,note:BI,noteToMidi:Ji,nothing:el,nrpnn:Uz,nrpv:Hz,nudge:Qj,numeralArgs:Do,objectMap:dL,octave:Vj,octaveR:Ij,octaves:rZ,octer:GZ,octersub:XZ,octersubsub:WZ,off:Iye,offset:aZ,often:Ywe,or:U1e,orbit:jj,oschost:aG,oscport:rG,outerBind:x1e,outside:wye,overgain:Zj,overshape:zj,pace:AL,pairs:lL,palindrome:Zye,pan:Gj,panchor:Cj,panorient:Uj,panspan:Xj,pansplay:Wj,panwidth:qj,parseFractional:iL,parseNumeral:wA,partials:sz,patt:bj,pattack:gj,pcurve:Sj,pdec:vj,pdecay:yj,penv:Pj,perlin:Qwe,perlinWith:PG,ph:zQ,phasdp:KQ,phaser:GQ,phasercenter:qQ,phaserdepth:HQ,phaserrate:ZQ,phasersweep:XQ,phc:UQ,phd:YQ,phs:WQ,pick:CG,pickF:oOe,pickOut:lOe,pickReset:dOe,pickRestart:uOe,pickSqueeze:fOe,pickmod:MG,pickmodF:iOe,pickmodOut:cOe,pickmodReset:mOe,pickmodRestart:hOe,pickmodSqueeze:bOe,pipe:oL,pitchJump:Cz,pitchJumpTime:Mz,ply:pye,plyForEach:eve,plyWith:Jye,pm:d1e,polyBind:S1e,polyTouch:sG,polymeter:bw,polyrhythm:u1e,postgain:LI,pow:B1e,pr:h1e,prel:kj,prelease:xj,press:jye,pressBy:Vye,progNum:Yz,psus:Oj,psustain:wj,pure:Ys,pw:QQ,pwrate:VQ,pwsweep:jQ,rand:Fr,rand2:Awe,randcat:Bwe,randrun:yG,range:nye,range2:aye,rangex:sye,rarely:Kwe,rate:Hj,ratio:rye,rdim:hZ,real:ez,ref:jL,register:Ie,registerControl:pe,reify:yt,rel:iQ,release:oQ,removeUndefineds:Xm,repeatCycles:ave,repeatTime:Ez,repl:TG,replicate:Pve,resonance:qV,rev:PL,rfade:mZ,rib:yve,ribbon:bve,ring:qZ,ringdf:HZ,ringf:UZ,rlp:cZ,room:iZ,roomdim:uZ,roomfade:dZ,roomlp:lZ,roomsize:yZ,rotate:rL,round:Y1e,rsize:OZ,run:gG,s:GL,s_add:Fve,s_alt:Ave,s_cat:Mve,s_contract:Rve,s_expand:Bve,s_extend:$ve,s_polymeter:Eve,s_sub:Nve,s_taper:Dve,s_taperlist:Tve,s_tour:_ve,s_zip:Lve,saw:Ug,saw2:BA,scram:oz,scramble:Mwe,scrub:iG,seconds:pz,seg:Nye,segment:Fye,semitone:Kj,seq:xL,seqPLoop:f1e,sequence:tl,sequenceP:yL,set:C1e,setStringParser:bL,setTime:K2,shape:xZ,shrink:_L,shrinklist:RL,shuffle:Cwe,signal:Pi,silence:us,sine:hG,sine2:RA,size:vZ,slice:VL,slide:Yj,slow:bye,slowChunk:ive,slowcat:zu,slowcatPrime:SA,slowchunk:ove,smear:rz,sol2note:qbe,someCycles:Hwe,someCyclesBy:Uwe,sometimes:qwe,sometimesBy:Wwe,songPtr:fz,sound:XL,source:TI,sparsity:yye,speak:wOe,speed:DA,splice:jve,splitAt:xA,spread:uj,square:dG,square2:mwe,squeeze:yOe,squeezeBind:k1e,squiz:BZ,src:FI,stack:js,stackBy:m1e,stackCentre:OL,stackLeft:vL,stackRight:wL,steady:uwe,stepBind:P1e,stepalt:DL,stepcat:go,steps:Ive,stepsPerOctave:Lj,stretch:FZ,striate:Vve,stringifyValues:kA,struct:b1e,strudelScope:AG,stut:Kye,stutWith:Uye,stutwith:Hye,sub:D1e,superimpose:y1e,sus:rQ,sustain:aQ,sustainpedal:LZ,swing:$ye,swingBy:Bye,sysex:Kz,sysexdata:eG,sysexid:Jz,sz:wZ,take:TL,time:_A,timeCat:AA,timecat:Cve,toBipolar:eye,tokenizeNote:J_,tour:LL,tremolo:kQ,tremolodepth:SQ,tremolophase:MQ,tremoloshape:AQ,tremoloskew:CQ,tremolosync:PQ,tri:pwe,tri2:fwe,triode:jZ,tsdelay:JZ,uid:gz,undegrade:Xwe,undegradeBy:Gwe,unicodeToBase64:uL,uniq:Ube,uniqsort:Hbe,uniqsortr:cL,unison:cj,unit:NZ,v:IV,val:bz,valueToMidi:eL,velocity:RI,vib:_V,vibmod:VV,vibrato:LV,vmod:jV,voice:Jj,vowel:$Z,warp:uI,warpatt:mI,warpattack:dI,warpdc:kI,warpdec:fI,warpdecay:pI,warpdepth:OI,warpenv:EI,warpmode:SI,warprate:wI,warprel:vI,warprelease:yI,warpshape:xI,warpskew:PI,warpsus:bI,warpsustain:gI,warpsync:DI,waveloss:RZ,wavetablePhaseRand:AI,wavetablePosition:qL,wavetableWarp:hI,wavetableWarpMode:CI,wchoose:Rwe,wchooseCycles:kG,when:Lye,whenKey:sOe,withValue:v1e,within:kve,wrandcat:_we,wt:WL,wtatt:YL,wtattack:HL,wtdc:lI,wtdec:JL,wtdecay:KL,wtdepth:oI,wtenv:UL,wtphaserand:MI,wtrate:aI,wtrel:sI,wtrelease:nI,wtshape:iI,wtskew:cI,wtsus:tI,wtsustain:eI,wtsync:rI,xfade:ZL,xsdelay:KZ,zcrush:Fz,zdelay:Nz,zip:IL,zipWith:pw,zmod:Tz,znoise:Dz,zoom:Mye,zoomArc:Aye,zoomarc:Eye,zrand:kz,zzfx:Bz},Symbol.toStringTag,{value:"Module"})),jc=(n="test-canvas",e)=>{let{contextType:t="2d",pixelated:s=!1,pixelRatio:a=window.devicePixelRatio}=e||{},r=document.querySelector("#"+n);if(!r){r=document.createElement("canvas"),r.id=n,r.width=window.innerWidth*a,r.height=window.innerHeight*a,r.style="pointer-events:none;width:100%;height:100%;position:fixed;top:0;left:0",s&&(r.style.imageRendering="pixelated"),document.body.prepend(r);let o;window.addEventListener("resize",()=>{o&&clearTimeout(o),o=setTimeout(()=>{r.width=window.innerWidth*a,r.height=window.innerHeight*a},200)})}return r.getContext(t,{willReadFrequently:!0})};let Id={};function BG(n){Id[n]!==void 0&&(cancelAnimationFrame(Id[n]),delete Id[n])}function SOe(n){Object.keys(Id).forEach(e=>(!n||e.startsWith(n))&&BG(e))}let fc={};dt.prototype.draw=function(n,e){if(typeof window>"u")return this;let{id:t=1,lookbehind:s=0,lookahead:a=0}=e,r=Math.max(Y2(),0);BG(t),s=Math.abs(s),fc[t]=(fc[t]||[]).filter(c=>!c.isInFuture(r));let o=this.queryArc(r,r+a).filter(c=>c.hasOnset());fc[t]=fc[t].concat(o);let i;const l=()=>{const c=Y2(),u=c+a;fc[t]=fc[t].filter(f=>f.isInNearPast(s,c));let h=Math.max(i||u,u-1/10);const m=this.queryArc(h,u).filter(f=>f.hasOnset());fc[t]=fc[t].concat(m),i=u,n(fc[t],c,u,this),Id[t]=requestAnimationFrame(l)};return Id[t]=requestAnimationFrame(l),this};const T9=(n=!0,e)=>{const t=jc();n&&t.clearRect(0,0,t.canvas.width,t.canvas.height),SOe(e)};dt.prototype.onPaint=function(n){return this.withState(e=>(e.controls.painters||(e.controls.painters=[]),e.controls.painters.push(n),e))};dt.prototype.getPainters=function(){let n=[];return this.queryArc(0,0,{painters:n}),n};class COe{constructor(e,t){this.onFrame=e,this.onError=t}start(){const e=this;let t=requestAnimationFrame(function s(a){try{e.onFrame(a)}catch(r){e.onError(r)}t=requestAnimationFrame(s)});e.cancel=()=>{cancelAnimationFrame(t)}}stop(){this.cancel&&this.cancel()}}class MOe{constructor(e,t){this.visibleHaps=[],this.lastFrame=null,this.drawTime=t,this.painters=[],this.framer=new COe(()=>{if(!this.scheduler){console.warn("Drawer: no scheduler");return}const s=Math.abs(this.drawTime[0]),a=this.drawTime[1],r=this.scheduler.now()+a;if(this.lastFrame===null){this.lastFrame=r;return}const o=this.scheduler.pattern.queryArc(Math.max(this.lastFrame,r-1/10),r);this.lastFrame=r,this.visibleHaps=(this.visibleHaps||[]).filter(l=>l.whole&&l.endClipped>=r-s-a).concat(o.filter(l=>l.hasOnset()));const i=r-a;e(this.visibleHaps,i,this,this.painters)},s=>{console.warn("draw error",s)})}setDrawTime(e){this.drawTime=e}invalidate(e=this.scheduler,t){if(!e)return;t=t??e.now(),this.scheduler=e;let[s,a]=this.drawTime;const[r,o]=[Math.max(t,0),t+a+.1];this.visibleHaps=this.visibleHaps.filter(l=>{var c;return((c=l.whole)==null?void 0:c.begin)<t}),this.painters=[];const i=e.pattern.queryArc(r,o,{painters:this.painters});this.visibleHaps=this.visibleHaps.concat(i)}start(e){this.scheduler=e,this.invalidate(),this.framer.start()}stop(){this.framer&&this.framer.stop()}}function M6e(n){return typeof window>"u"?"#fff":getComputedStyle(document.documentElement).getPropertyValue(n)}let $G={background:"#222",foreground:"#75baff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"};function Ac(){return $G}function AOe(n){$G=n}let F9="#22222210";dt.prototype.animate=function({callback:n,sync:e=!1,smear:t=.5}={}){window.frame&&cancelAnimationFrame(window.frame);const s=jc();let{clientWidth:a,clientHeight:r}=s.canvas;a*=window.devicePixelRatio,r*=window.devicePixelRatio;let o=t===0?"99":Number((1-t)*100).toFixed(0);o=o.length===1?`0${o}`:o,F9=`#200010${o}`;const i=l=>{let c;l=Math.round(l),c=this.slow(1e3).queryArc(l,l),s.fillStyle=F9,s.fillRect(0,0,a,r),c.forEach(u=>{let{x:h,y:m,w:f,h:v,s:O,r:k,angle:M=0,fill:E="darkseagreen"}=u.value;if(f*=a,v*=r,k!==void 0&&M!==void 0){const D=M*2*Math.PI,[F,_]=[(a-f)/2,(r-v)/2];h=F+Math.cos(D)*k*F,m=_+Math.sin(D)*k*_}else h*=a-f,m*=r-v;const I={...u.value,x:h,y:m,w:f,h:v};s.fillStyle=E,O==="rect"?s.fillRect(h,m,f,v):O==="ellipse"&&(s.beginPath(),s.ellipse(h+f/2,m+v/2,f/2,v/2,0,0,2*Math.PI),s.fill()),n&&n(s,I,u)}),window.frame=requestAnimationFrame(i)};return window.frame=requestAnimationFrame(i),us};const{x:RG,y:A6e,w:E6e,h:D6e,angle:T6e,r:F6e,fill:N6e,smear:B6e}=TA("x","y","w","h","angle","r","fill","smear"),$6e=Ie("rescale",function(n,e){return e.mul(RG(n).w(n).y(n).h(n))}),R6e=Ie("moveXY",function(n,e,t){return t.add(RG(n).y(e))}),_6e=Ie("zoomIn",function(n,e){const t=Ys(1).sub(n).div(2);return e.rescale(n).move(t,t)}),Ap=(n,e,t)=>n*(t-e)+e,N9=n=>{let{value:e}=n;typeof n.value!="object"&&(e={value:e});let{note:t,n:s,freq:a,s:r}=e;if(a)return vA(a);if(t=t??s,typeof t=="string")try{return Ji(t)}catch{return 0}return typeof t=="number"?t:r?"_"+r:e};dt.prototype.pianoroll=function(n={}){let{cycles:e=4,playhead:t=.5,overscan:s=0,hideNegative:a=!1,ctx:r=jc(),id:o=1}=n,i=-e*t,l=e*(1-t);const c=(u,h)=>(!a||u.whole.begin>=0)&&u.isWithinTime(h+i,h+l);return this.draw((u,h)=>{GA({...n,time:h,ctx:r,haps:u.filter(m=>c(m,h))})},{lookbehind:i-s,lookahead:l+s,id:o}),this};function L6e(n){return gw(n)?n.pianoroll():e=>e.pianoroll(n)}function GA({time:n,haps:e,cycles:t=4,playhead:s=.5,flipTime:a=0,flipValues:r=0,hideNegative:o=!1,inactive:i=Ac().foreground,active:l=Ac().foreground,background:c="transparent",smear:u=0,playheadColor:h=Ac().foreground,minMidi:m=10,maxMidi:f=90,autorange:v=0,timeframe:O,fold:k=1,vertical:M=0,labels:E=!1,fill:I=1,fillActive:D=!1,strokeActive:F=!0,stroke:_,hideInactive:$=0,colorizeInactive:Z=1,fontFamily:ce,ctx:U,id:ue}={}){const W=U.canvas.width,de=U.canvas.height;let be=-t*s,ke=t*(1-s);ue&&(e=e.filter(rt=>rt.hasTag(ue))),O&&(console.warn("timeframe is deprecated! use from/to instead"),be=0,ke=O);const Ce=M?de:W,Ae=M?W:de;let q=M?[Ce,0]:[0,Ce];const Ne=ke-be,Re=M?[0,Ae]:[Ae,0];let je=f-m+1,me=Ae/je,Ye=[];a&&q.reverse(),r&&Re.reverse();const{min:ft,max:_e,values:Ge}=e.reduce(({min:rt,max:tn,values:on},xn)=>{const Gt=N9(xn);return{min:Gt<rt?Gt:rt,max:Gt>tn?Gt:tn,values:on.includes(Gt)?on:[...on,Gt]}},{min:1/0,max:-1/0,values:[]});v&&(m=ft,f=_e,je=f-m+1),Ye=Ge.sort((rt,tn)=>typeof rt=="number"&&typeof tn=="number"?rt-tn:typeof rt=="number"?1:String(rt).localeCompare(String(tn))),me=k?Ae/Ye.length:Ae/je,U.fillStyle=c,U.globalAlpha=1,u||(U.clearRect(0,0,W,de),U.fillRect(0,0,W,de)),e.forEach(rt=>{var En;const tn=rt.whole.begin<=n&&rt.endClipped>n;let on=_??(F&&tn),xn=!tn&&I||tn&&D;if($&&!tn)return;let Gt=(En=rt.value)==null?void 0:En.color;l=Gt||l,i=Z&&Gt||i,Gt=tn?l:i,U.fillStyle=xn?Gt:"transparent",U.strokeStyle=Gt;const{velocity:In=1,gain:Ft=1}=rt.value||{};U.globalAlpha=In*Ft;const jt=(rt.whole.begin-(a?ke:be))/Ne,Gn=Ap(jt,...q);let un=Ap(rt.duration/Ne,0,Ce);const fn=N9(rt),at=k?Ye.indexOf(fn)/Ye.length:(Number(fn)-m)/je,Un=Ap(at,...Re);let nt=0;const Mt=Ap(n/Ne,...q);let Vt;if(M?Vt=[Un+1-(r?me:0),Ce-Mt+Gn+nt+1-(a?0:un),me-2,un-2]:Vt=[Gn-Mt+nt+1-(a?un:0),Un+1-(r?0:me),un-2,me-2],on&&U.strokeRect(...Vt),xn&&U.fillRect(...Vt),E){const lt=rt.value.note??rt.value.s+(rt.value.n?`:${rt.value.n}`:""),{label:It,activeLabel:Le}=rt.value,qt=(tn&&Le||It)??lt;let tt=M?un:me*.75;U.font=`${tt}px ${ce||"monospace"}`,U.fillStyle=xn?"black":Gt,U.textBaseline="top",U.fillText(qt,...Vt)}}),U.globalAlpha=1;const pt=Ap(-be/Ne,...q);return U.strokeStyle=h,U.beginPath(),M?(U.moveTo(0,pt),U.lineTo(Ae,pt)):(U.moveTo(pt,0),U.lineTo(pt,Ae)),U.stroke(),this}function _G(n,e={}){let[t,s]=n;t=Math.abs(t);const a=s+t,r=a!==0?t/a:0;return{fold:1,...e,cycles:a,playhead:r}}const EOe=(n={})=>(e,t,s,a)=>GA({ctx:e,time:t,haps:s,..._G(a,n)});dt.prototype.punchcard=function(n){return this.onPaint(EOe(n))};dt.prototype.wordfall=function(n){return this.punchcard({vertical:1,labels:1,stroke:0,fillActive:1,active:"white",...n})};function I6e(n){const{drawTime:e,...t}=n;GA({..._G(e),...t})}function DOe(n,e,t,s){const a=(n-90)*Math.PI/180;return[t+Math.cos(a)*e,s+Math.sin(a)*e]}const B9=(n,e,t,s,a=0)=>DOe((n+a)*360,e*n,t,s);function $9(n){let{ctx:e,from:t=0,to:s=3,margin:a=50,cx:r=100,cy:o=100,rotate:i=0,thickness:l=a/2,color:c=Ac().foreground,cap:u="round",stretch:h=1,fromOpacity:m=1,toOpacity:f=1}=n;t*=h,s*=h,i*=h,e.lineWidth=l,e.lineCap=u,e.strokeStyle=c,e.globalAlpha=m,e.beginPath();let[v,O]=B9(t,a,r,o,i);e.moveTo(v,O);const k=1/60;let M=t;for(;M<=s;){const[E,I]=B9(M,a,r,o,i);e.globalAlpha=(M-t)/(s-t)*f,e.lineTo(E,I),M+=k}e.stroke()}function TOe(n){let{stretch:e=1,size:t=80,thickness:s=t/2,cap:a="butt",inset:r=3,playheadColor:o="#ffffff",playheadLength:i=.02,playheadThickness:l=s,padding:c=0,steady:u=1,activeColor:h=Ac().foreground,inactiveColor:m=Ac().gutterForeground,colorizeInactive:f=0,fade:v=!0,ctx:O,time:k,haps:M,drawTime:E,id:I}=n;I&&(M=M.filter(W=>W.hasTag(I)));const[D,F]=[O.canvas.width,O.canvas.height];O.clearRect(0,0,D*2,F*2);const[_,$]=[D/2,F/2],Z={margin:t/e,cx:_,cy:$,stretch:e,cap:a,thickness:s},ce={...Z,thickness:l,from:r-i,to:r,color:o},[U]=E,ue=u*k;M.forEach(W=>{var Ne;const de=W.whole.begin<=k&&W.endClipped>k,be=W.whole.begin-k+r,ke=W.endClipped-k+r-c,Ce=((Ne=W.value)==null?void 0:Ne.color)||h,Ae=f||de?Ce:m,q=v?1-Math.abs((W.whole.begin-k)/U):1;$9({ctx:O,...Z,from:be,to:ke,rotate:ue,color:Ae,fromOpacity:q,toOpacity:q})}),$9({ctx:O,...ce,rotate:ue})}dt.prototype.spiral=function(n={}){return this.onPaint((e,t,s,a)=>TOe({ctx:e,time:t,haps:s,drawTime:a,...n}))};const FOe=mm(36),R9=(n,e,t,s)=>{s=s*Math.PI*2;const a=Math.sin(s)*t+n,r=Math.cos(s)*t+e;return[a,r]},_9=(n,e)=>.5-Math.log2(n/e)%1;function NOe({haps:n,ctx:e,id:t,hapcircles:s=1,circle:a=0,edo:r=12,root:o=FOe,thickness:i=3,hapRadius:l=6,mode:c="flake",margin:u=10}={}){const h=c==="polygon",m=c==="flake",f=e.canvas.width,v=e.canvas.height;e.clearRect(0,0,f,v);const O=Ac().foreground,k=Math.min(f,v)/2-i/2-l-u,M=f/2,E=v/2;t&&(n=n.filter(D=>D.hasTag(t))),e.strokeStyle=O,e.fillStyle=O,e.globalAlpha=1,e.lineWidth=i,a&&(e.beginPath(),e.arc(M,E,k,0,2*Math.PI),e.stroke()),r&&(Array.from({length:r},(D,F)=>{const _=_9(o*Math.pow(2,F/r),o),[$,Z]=R9(M,E,k,_);e.beginPath(),e.arc($,Z,l,0,2*Math.PI),e.fill()}),e.stroke());let I=[];e.lineWidth=l,n.forEach(D=>{let F;try{F=aL(D)}catch{return}const _=_9(F,o),[$,Z]=R9(M,E,k,_),ce=D.value.color||O;e.strokeStyle=ce,e.fillStyle=ce;const{velocity:U=1,gain:ue=1}=D.value||{},W=U*ue;e.globalAlpha=W,I.push([$,Z,_,ce,W]),e.beginPath(),s&&(e.moveTo($+l,Z),e.arc($,Z,l,0,2*Math.PI),e.fill()),m&&(e.moveTo(M,E),e.lineTo($,Z)),e.stroke()}),e.strokeStyle=O,e.globalAlpha=1,h&&I.length&&(I=I.sort((D,F)=>D[2]-F[2]),e.beginPath(),e.moveTo(I[0][0],I[0][1]),I.forEach(([D,F,_,$,Z])=>{e.strokeStyle=$,e.globalAlpha=Z,e.lineTo(D,F)}),e.lineTo(I[0][0],I[0][1]),e.stroke())}dt.prototype.pitchwheel=function(n={}){let{ctx:e=jc(),id:t=1}=n;return this.tag(t).onPaint((s,a,r)=>NOe({...n,ctx:e,haps:r.filter(o=>o.isActive(a)),id:t}))};function BOe(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function Vh(n,e,t,s){var a=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(a,Vh.prototype),a.expected=e,a.found=t,a.location=s,a.name="SyntaxError",a}BOe(Vh,Error);function Ix(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}Vh.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,s;for(s=0;s<n.length;s++)if(n[s].source===this.location.source){t=n[s].text.split(/\r\n|\n|\r/g);break}var a=this.location.start,r=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(a):a,o=this.location.source+":"+r.line+":"+r.column;if(t){var i=this.location.end,l=Ix("",r.line.toString().length," "),c=t[a.line-1],u=a.line===i.line?i.column:c.length+1,h=u-a.column||1;e+=`
 --> `+o+`
`+l+` |
`+r.line+" | "+c+`
`+l+" | "+Ix("",a.column-1," ")+Ix("",h,"^")}else e+=`
 at `+o}return e};Vh.buildMessage=function(n,e){var t={literal:function(c){return'"'+a(c.text)+'"'},class:function(c){var u=c.parts.map(function(h){return Array.isArray(h)?r(h[0])+"-"+r(h[1]):r(h)});return"["+(c.inverted?"^":"")+u.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(c){return c.description}};function s(c){return c.charCodeAt(0).toString(16).toUpperCase()}function a(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+s(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+s(u)})}function r(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+s(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+s(u)})}function o(c){return t[c.type](c)}function i(c){var u=c.map(o),h,m;if(u.sort(),u.length>0){for(h=1,m=1;h<u.length;h++)u[h-1]!==u[h]&&(u[m]=u[h],m++);u.length=m}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function l(c){return c?'"'+a(c)+'"':"end of input"}return"Expected "+i(n)+" but "+l(e)+" found."};function LG(n,e){e=e!==void 0?e:{};var t={},s=e.grammarSource,a={start:Yt},r=Yt,o=".",i="-",l="0",c=",",u="|",h="[",m="]",f="{",v="}",O="%",k="<",M=">",E="!",I="(",D=")",F="/",_="*",$="?",Z=":",ce="..",U="^",ue="struct",W="target",de="euclid",be="slow",ke="rotL",Ce="rotR",Ae="fast",q="scale",Ne="//",Re="cat",je="$",me="setcps",Ye="setbpm",ft="hush",_e=/^[1-9]/,Ge=/^[eE]/,pt=/^[+\-]/,rt=/^[0-9]/,tn=/^[ \n\r\t\xA0]/,on=/^["']/,xn=/^[#\--.0-9A-Z\^-_a-z~\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u09FC\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD-\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,Gt=/^[@_]/,In=/^[^\n]/,Ft=Je("number"),jt=De(".",!1),Gn=ot([["1","9"]],!1,!1),un=ot(["e","E"],!1,!1),fn=ot(["+","-"],!1,!1),at=De("-",!1),Un=De("0",!1),nt=ot([["0","9"]],!1,!1),Mt=Je("whitespace"),Vt=ot([" ",`
`,"\r","	"," "],!1,!1),En=De(",",!1),lt=De("|",!1),It=ot(['"',"'"],!1,!1),Le=Je('a letter, a number, "-", "#", ".", "^", "_"'),qt=ot(["#",["-","."],["0","9"],["A","Z"],["^","_"],["a","z"],"~","ª","µ","º",["À","Ö"],["Ø","ö"],["ø","ˁ"],["ˆ","ˑ"],["ˠ","ˤ"],"ˬ","ˮ",["Ͱ","ʹ"],["Ͷ","ͷ"],["ͺ","ͽ"],"Ϳ","Ά",["Έ","Ί"],"Ό",["Ύ","Ρ"],["Σ","ϵ"],["Ϸ","ҁ"],["Ҋ","ԯ"],["Ա","Ֆ"],"ՙ",["ՠ","ֈ"],["א","ת"],["ׯ","ײ"],["ؠ","ي"],["ٮ","ٯ"],["ٱ","ۓ"],"ە",["ۥ","ۦ"],["ۮ","ۯ"],["ۺ","ۼ"],"ۿ","ܐ",["ܒ","ܯ"],["ݍ","ޥ"],"ޱ",["ߊ","ߪ"],["ߴ","ߵ"],"ߺ",["ࠀ","ࠕ"],"ࠚ","ࠤ","ࠨ",["ࡀ","ࡘ"],["ࡠ","ࡪ"],["ࢠ","ࢴ"],["ࢶ","ࢽ"],["ऄ","ह"],"ऽ","ॐ",["क़","ॡ"],["ॱ","ঀ"],["অ","ঌ"],["এ","ঐ"],["ও","ন"],["প","র"],"ল",["শ","হ"],"ঽ","ৎ",["ড়","ঢ়"],["য়","ৡ"],["ৰ","ৱ"],"ৼ",["ਅ","ਊ"],["ਏ","ਐ"],["ਓ","ਨ"],["ਪ","ਰ"],["ਲ","ਲ਼"],["ਵ","ਸ਼"],["ਸ","ਹ"],["ਖ਼","ੜ"],"ਫ਼",["ੲ","ੴ"],["અ","ઍ"],["એ","ઑ"],["ઓ","ન"],["પ","ર"],["લ","ળ"],["વ","હ"],"ઽ","ૐ",["ૠ","ૡ"],"ૹ",["ଅ","ଌ"],["ଏ","ଐ"],["ଓ","ନ"],["ପ","ର"],["ଲ","ଳ"],["ଵ","ହ"],"ଽ",["ଡ଼","ଢ଼"],["ୟ","ୡ"],"ୱ","ஃ",["அ","ஊ"],["எ","ஐ"],["ஒ","க"],["ங","ச"],"ஜ",["ஞ","ட"],["ண","த"],["ந","ப"],["ம","ஹ"],"ௐ",["అ","ఌ"],["ఎ","ఐ"],["ఒ","న"],["ప","హ"],"ఽ",["ౘ","ౚ"],["ౠ","ౡ"],"ಀ",["ಅ","ಌ"],["ಎ","ಐ"],["ಒ","ನ"],["ಪ","ಳ"],["ವ","ಹ"],"ಽ","ೞ",["ೠ","ೡ"],["ೱ","ೲ"],["അ","ഌ"],["എ","ഐ"],["ഒ","ഺ"],"ഽ","ൎ",["ൔ","ൖ"],["ൟ","ൡ"],["ൺ","ൿ"],["අ","ඖ"],["ක","න"],["ඳ","ර"],"ල",["ව","ෆ"],["ก","ะ"],["า","ำ"],["เ","ๆ"],["ກ","ຂ"],"ຄ",["ງ","ຈ"],"ຊ","ຍ",["ດ","ທ"],["ນ","ຟ"],["ມ","ຣ"],"ລ","ວ",["ສ","ຫ"],["ອ","ະ"],["າ","ຳ"],"ຽ",["ເ","ໄ"],"ໆ",["ໜ","ໟ"],"ༀ",["ཀ","ཇ"],["ཉ","ཬ"],["ྈ","ྌ"],["က","ဪ"],"ဿ",["ၐ","ၕ"],["ၚ","ၝ"],"ၡ",["ၥ","ၦ"],["ၮ","ၰ"],["ၵ","ႁ"],"ႎ",["Ⴀ","Ⴥ"],"Ⴧ","Ⴭ",["ა","ჺ"],["ჼ","ቈ"],["ቊ","ቍ"],["ቐ","ቖ"],"ቘ",["ቚ","ቝ"],["በ","ኈ"],["ኊ","ኍ"],["ነ","ኰ"],["ኲ","ኵ"],["ኸ","ኾ"],"ዀ",["ዂ","ዅ"],["ወ","ዖ"],["ዘ","ጐ"],["ጒ","ጕ"],["ጘ","ፚ"],["ᎀ","ᎏ"],["Ꭰ","Ᏽ"],["ᏸ","ᏽ"],["ᐁ","ᙬ"],["ᙯ","ᙿ"],["ᚁ","ᚚ"],["ᚠ","ᛪ"],["ᛮ","ᛸ"],["ᜀ","ᜌ"],["ᜎ","ᜑ"],["ᜠ","ᜱ"],["ᝀ","ᝑ"],["ᝠ","ᝬ"],["ᝮ","ᝰ"],["ក","ឳ"],"ៗ","ៜ",["ᠠ","ᡸ"],["ᢀ","ᢄ"],["ᢇ","ᢨ"],"ᢪ",["ᢰ","ᣵ"],["ᤀ","ᤞ"],["ᥐ","ᥭ"],["ᥰ","ᥴ"],["ᦀ","ᦫ"],["ᦰ","ᧉ"],["ᨀ","ᨖ"],["ᨠ","ᩔ"],"ᪧ",["ᬅ","ᬳ"],["ᭅ","ᭋ"],["ᮃ","ᮠ"],["ᮮ","ᮯ"],["ᮺ","ᯥ"],["ᰀ","ᰣ"],["ᱍ","ᱏ"],["ᱚ","ᱽ"],["ᲀ","ᲈ"],["Ა","Ჺ"],["Ჽ","Ჿ"],["ᳩ","ᳬ"],["ᳮ","ᳱ"],["ᳵ","ᳶ"],["ᴀ","ᶿ"],["Ḁ","ἕ"],["Ἐ","Ἕ"],["ἠ","ὅ"],["Ὀ","Ὅ"],["ὐ","ὗ"],"Ὑ","Ὓ","Ὕ",["Ὗ","ώ"],["ᾀ","ᾴ"],["ᾶ","ᾼ"],"ι",["ῂ","ῄ"],["ῆ","ῌ"],["ῐ","ΐ"],["ῖ","Ί"],["ῠ","Ῥ"],["ῲ","ῴ"],["ῶ","ῼ"],"ⁱ","ⁿ",["ₐ","ₜ"],"ℂ","ℇ",["ℊ","ℓ"],"ℕ",["ℙ","ℝ"],"ℤ","Ω","ℨ",["K","ℭ"],["ℯ","ℹ"],["ℼ","ℿ"],["ⅅ","ⅉ"],"ⅎ",["Ⅰ","ↈ"],["Ⰰ","Ⱞ"],["ⰰ","ⱞ"],["Ⱡ","ⳤ"],["Ⳬ","ⳮ"],["Ⳳ","ⳳ"],["ⴀ","ⴥ"],"ⴧ","ⴭ",["ⴰ","ⵧ"],"ⵯ",["ⶀ","ⶖ"],["ⶠ","ⶦ"],["ⶨ","ⶮ"],["ⶰ","ⶶ"],["ⶸ","ⶾ"],["ⷀ","ⷆ"],["ⷈ","ⷎ"],["ⷐ","ⷖ"],["ⷘ","ⷞ"],"ⸯ",["々","〇"],["〡","〩"],["〱","〵"],["〸","〼"],["ぁ","ゖ"],["ゝ","ゟ"],["ァ","ヺ"],["ー","ヿ"],["ㄅ","ㄯ"],["ㄱ","ㆎ"],["ㆠ","ㆺ"],["ㇰ","ㇿ"],["㐀","䶵"],["一","鿯"],["ꀀ","ꒌ"],["ꓐ","ꓽ"],["ꔀ","ꘌ"],["ꘐ","ꘟ"],["ꘪ","ꘫ"],["Ꙁ","ꙮ"],["ꙿ","ꚝ"],["ꚠ","ꛯ"],["ꜗ","ꜟ"],["Ꜣ","ꞈ"],["Ꞌ","ꞹ"],["ꟷ","ꠁ"],["ꠃ","ꠅ"],["ꠇ","ꠊ"],["ꠌ","ꠢ"],["ꡀ","ꡳ"],["ꢂ","ꢳ"],["ꣲ","ꣷ"],"ꣻ",["ꣽ","ꣾ"],["ꤊ","ꤥ"],["ꤰ","ꥆ"],["ꥠ","ꥼ"],["ꦄ","ꦲ"],"ꧏ",["ꧠ","ꧤ"],["ꧦ","ꧯ"],["ꧺ","ꧾ"],["ꨀ","ꨨ"],["ꩀ","ꩂ"],["ꩄ","ꩋ"],["ꩠ","ꩶ"],"ꩺ",["ꩾ","ꪯ"],"ꪱ",["ꪵ","ꪶ"],["ꪹ","ꪽ"],"ꫀ","ꫂ",["ꫛ","ꫝ"],["ꫠ","ꫪ"],["ꫲ","ꫴ"],["ꬁ","ꬆ"],["ꬉ","ꬎ"],["ꬑ","ꬖ"],["ꬠ","ꬦ"],["ꬨ","ꬮ"],["ꬰ","ꭚ"],["ꭜ","ꭥ"],["ꭰ","ꯢ"],["가","힣"],["ힰ","ퟆ"],["ퟋ","ퟻ"],["豈","舘"],["並","龎"],["ﬀ","ﬆ"],["ﬓ","ﬗ"],"יִ",["ײַ","ﬨ"],["שׁ","זּ"],["טּ","לּ"],"מּ",["נּ","סּ"],["ףּ","פּ"],["צּ","ﮱ"],["ﯓ","ﴽ"],["ﵐ","ﶏ"],["ﶒ","ﷇ"],["ﷰ","ﷻ"],["ﹰ","ﹴ"],["ﹶ","ﻼ"],["Ａ","Ｚ"],["ａ","ｚ"],["ｦ","ﾾ"],["ￂ","ￇ"],["ￊ","ￏ"],["ￒ","ￗ"],["ￚ","ￜ"]],!1,!1),tt=De("[",!1),zn=De("]",!1),mt=De("{",!1),Fn=De("}",!1),ea=De("%",!1),Hn=De("<",!1),Zt=De(">",!1),Dt=ot(["@","_"],!1,!1),Sn=De("!",!1),He=De("(",!1),Tt=De(")",!1),kn=De("/",!1),vs=De("*",!1),ln=De("?",!1),Gs=De(":",!1),na=De("..",!1),x=De("^",!1),B=De("struct",!1),T=De("target",!1),R=De("euclid",!1),j=De("slow",!1),H=De("rotL",!1),ee=De("rotR",!1),ne=De("fast",!1),ge=De("scale",!1),Fe=De("//",!1),Be=ot([`
`],!0,!1),wt=De("cat",!1),Nt=De("$",!1),yn=De("setcps",!1),ws=De("setbpm",!1),gn=De("hush",!1),_s=function(){return parseFloat(Qe())},Cn=function(P){const Q=P.join("");return Q==="."||Q==="_"},Pn=function(P){return new kO(P.join(""))},bs=function(P){return P},ls=function(P,Q){return P.arguments_.stepsPerCycle=Q,P},Fa=function(P){return P},$r=function(P){return P.arguments_.alignment="polymeter_slowcat",P},Rr=function(P){return Q=>Q.options_.weight=(Q.options_.weight??1)+(P??2)-1},Na=function(P){return Q=>{const X=(Q.options_.reps??1)+(P??2)-1;Q.options_.reps=X,Q.options_.ops=Q.options_.ops.filter(ye=>ye.type_!=="replicate"),Q.options_.ops.push({type_:"replicate",arguments_:{amount:X}}),Q.options_.weight=X}},rc=function(P,Q,X){return ye=>ye.options_.ops.push({type_:"bjorklund",arguments_:{pulse:P,step:Q,rotation:X}})},Ls=function(P){return Q=>Q.options_.ops.push({type_:"stretch",arguments_:{amount:P,type:"slow"}})},oc=function(P){return Q=>Q.options_.ops.push({type_:"stretch",arguments_:{amount:P,type:"fast"}})},vo=function(P){return Q=>Q.options_.ops.push({type_:"degradeBy",arguments_:{amount:P,seed:Hu++}})},er=function(P){return Q=>Q.options_.ops.push({type_:"tail",arguments_:{element:P}})},ic=function(P){return Q=>Q.options_.ops.push({type_:"range",arguments_:{element:P}})},wo=function(P,Q){const X=new SO(P,{ops:[],weight:1,reps:1});for(const ye of Q)ye(X);return X},Zo=function(P,Q){return new hc(Q,"fastcat",void 0,!!P)},_r=function(P){return{alignment:"stack",list:P}},Yn=function(P){return{alignment:"rand",list:P,seed:Hu++}},oa=function(P){return{alignment:"feet",list:P,seed:Hu++}},Lr=function(P,Q){return Q&&Q.list.length>0?new hc([P,...Q.list],Q.alignment,Q.seed):P},br=function(P,Q){return new hc(Q?[P,...Q.list]:[P],"polymeter")},tr=function(P){return P},Ir=function(P){return{name:"struct",args:{mini:P}}},nr=function(P){return{name:"target",args:{name:P}}},lc=function(P,Q,X){return{name:"bjorklund",args:{pulse:P,step:parseInt(Q)}}},Ba=function(P){return{name:"stretch",args:{amount:P}}},zo=function(P){return{name:"shift",args:{amount:"-"+P}}},Oo=function(P){return{name:"shift",args:{amount:P}}},ys=function(P){return{name:"stretch",args:{amount:"1/"+P}}},Ct=function(P){return{name:"scale",args:{scale:P.join("")}}},Ai=function(P,Q){return Q},yr=function(P,Q){return Q.unshift(P),new hc(Q,"slowcat")},cc=function(P){return P},$a=function(P,Q){return new PO(P.name,P.args,Q)},hl=function(P){return P},Ra=function(P){return P},Y=function(P){return new Uu("setcps",{value:P})},J=function(P){return new Uu("setcps",{value:P/120/2})},te=function(){return new Uu("hush")},A=e.peg$currPos|0,he=A,we=[{line:1,column:1}],Oe=A,Se=e.peg$maxFailExpected||[],fe=e.peg$silentFails|0,Te;if(e.startRule){if(!(e.startRule in a))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');r=a[e.startRule]}function Qe(){return n.substring(he,A)}function Ee(){return et(he,A)}function De(P,Q){return{type:"literal",text:P,ignoreCase:Q}}function ot(P,Q,X){return{type:"class",parts:P,inverted:Q,ignoreCase:X}}function st(){return{type:"end"}}function Je(P){return{type:"other",description:P}}function We(P){var Q=we[P],X;if(Q)return Q;if(P>=we.length)X=we.length-1;else for(X=P;!we[--X];);for(Q=we[X],Q={line:Q.line,column:Q.column};X<P;)n.charCodeAt(X)===10?(Q.line++,Q.column=1):Q.column++,X++;return we[P]=Q,Q}function et(P,Q,X){var ye=We(P),Ue=We(Q),mn={source:s,start:{offset:P,line:ye.line,column:ye.column},end:{offset:Q,line:Ue.line,column:Ue.column}};return mn}function Me(P){A<Oe||(A>Oe&&(Oe=A,Se=[]),Se.push(P))}function Ke(P,Q,X){return new Vh(Vh.buildMessage(P,Q),P,Q,X)}function Yt(){var P;return P=xO(),P}function $t(){var P,Q;return fe++,P=A,pn(),Q=Jt(),Q!==t?(Ps(),ms(),he=P,P=_s()):(A=P,P=t),fe--,P===t&&fe===0&&Me(Ft),P}function dn(){var P;return n.charCodeAt(A)===46?(P=o,A++):(P=t,fe===0&&Me(jt)),P}function Rn(){var P;return P=n.charAt(A),_e.test(P)?A++:(P=t,fe===0&&Me(Gn)),P}function On(){var P;return P=n.charAt(A),Ge.test(P)?A++:(P=t,fe===0&&Me(un)),P}function ms(){var P,Q,X,ye,Ue;if(P=A,Q=On(),Q!==t){if(X=n.charAt(A),pt.test(X)?A++:(X=t,fe===0&&Me(fn)),X===t&&(X=null),ye=[],Ue=d(),Ue!==t)for(;Ue!==t;)ye.push(Ue),Ue=d();else ye=t;ye!==t?(Q=[Q,X,ye],P=Q):(A=P,P=t)}else A=P,P=t;return P}function Ps(){var P,Q,X,ye;if(P=A,Q=dn(),Q!==t){if(X=[],ye=d(),ye!==t)for(;ye!==t;)X.push(ye),ye=d();else X=t;X!==t?(Q=[Q,X],P=Q):(A=P,P=t)}else A=P,P=t;return P}function Jt(){var P,Q,X,ye;if(P=zt(),P===t)if(P=A,Q=Rn(),Q!==t){for(X=[],ye=d();ye!==t;)X.push(ye),ye=d();Q=[Q,X],P=Q}else A=P,P=t;return P}function pn(){var P;return n.charCodeAt(A)===45?(P=i,A++):(P=t,fe===0&&Me(at)),P}function zt(){var P;return n.charCodeAt(A)===48?(P=l,A++):(P=t,fe===0&&Me(Un)),P}function d(){var P;return P=n.charAt(A),rt.test(P)?A++:(P=t,fe===0&&Me(nt)),P}function p(){var P,Q;for(fe++,P=[],Q=n.charAt(A),tn.test(Q)?A++:(Q=t,fe===0&&Me(Vt));Q!==t;)P.push(Q),Q=n.charAt(A),tn.test(Q)?A++:(Q=t,fe===0&&Me(Vt));return fe--,Q=t,fe===0&&Me(Mt),P}function g(){var P,Q,X,ye;return P=A,Q=p(),n.charCodeAt(A)===44?(X=c,A++):(X=t,fe===0&&Me(En)),X!==t?(ye=p(),Q=[Q,X,ye],P=Q):(A=P,P=t),P}function b(){var P,Q,X,ye;return P=A,Q=p(),n.charCodeAt(A)===124?(X=u,A++):(X=t,fe===0&&Me(lt)),X!==t?(ye=p(),Q=[Q,X,ye],P=Q):(A=P,P=t),P}function S(){var P,Q,X,ye;return P=A,Q=p(),n.charCodeAt(A)===46?(X=o,A++):(X=t,fe===0&&Me(jt)),X!==t?(ye=p(),Q=[Q,X,ye],P=Q):(A=P,P=t),P}function C(){var P;return P=n.charAt(A),on.test(P)?A++:(P=t,fe===0&&Me(It)),P}function N(){var P;return fe++,P=n.charAt(A),xn.test(P)?A++:(P=t,fe===0&&Me(qt)),fe--,P===t&&fe===0&&Me(Le),P}function L(){var P,Q,X,ye;if(P=A,p(),Q=[],X=N(),X!==t)for(;X!==t;)Q.push(X),X=N();else Q=t;return Q!==t?(X=p(),he=A,ye=Cn(Q),ye?ye=t:ye=void 0,ye!==t?(he=P,P=Pn(Q)):(A=P,P=t)):(A=P,P=t),P}function V(){var P,Q,X,ye;return P=A,p(),n.charCodeAt(A)===91?(Q=h,A++):(Q=t,fe===0&&Me(tt)),Q!==t?(p(),X=Dn(),X!==t?(p(),n.charCodeAt(A)===93?(ye=m,A++):(ye=t,fe===0&&Me(zn)),ye!==t?(p(),he=P,P=bs(X)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function z(){var P,Q,X,ye,Ue;return P=A,p(),n.charCodeAt(A)===123?(Q=f,A++):(Q=t,fe===0&&Me(mt)),Q!==t?(p(),X=nn(),X!==t?(p(),n.charCodeAt(A)===125?(ye=v,A++):(ye=t,fe===0&&Me(Fn)),ye!==t?(Ue=G(),Ue===t&&(Ue=null),p(),he=P,P=ls(X,Ue)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function G(){var P,Q,X;return P=A,n.charCodeAt(A)===37?(Q=O,A++):(Q=t,fe===0&&Me(ea)),Q!==t?(X=le(),X!==t?(he=P,P=Fa(X)):(A=P,P=t)):(A=P,P=t),P}function ie(){var P,Q,X,ye;return P=A,p(),n.charCodeAt(A)===60?(Q=k,A++):(Q=t,fe===0&&Me(Hn)),Q!==t?(p(),X=nn(),X!==t?(p(),n.charCodeAt(A)===62?(ye=M,A++):(ye=t,fe===0&&Me(Zt)),ye!==t?(p(),he=P,P=$r(X)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function le(){var P;return P=L(),P===t&&(P=V(),P===t&&(P=z(),P===t&&(P=ie()))),P}function se(){var P;return P=K(),P===t&&(P=xe(),P===t&&(P=$e(),P===t&&(P=Pe(),P===t&&(P=ve(),P===t&&(P=ze(),P===t&&(P=ct(),P===t&&(P=it()))))))),P}function K(){var P,Q,X;return P=A,p(),Q=n.charAt(A),Gt.test(Q)?A++:(Q=t,fe===0&&Me(Dt)),Q!==t?(X=$t(),X===t&&(X=null),he=P,P=Rr(X)):(A=P,P=t),P}function ve(){var P,Q,X;return P=A,p(),n.charCodeAt(A)===33?(Q=E,A++):(Q=t,fe===0&&Me(Sn)),Q!==t?(X=$t(),X===t&&(X=null),he=P,P=Na(X)):(A=P,P=t),P}function xe(){var P,Q,X,ye,Ue,mn,ta;return P=A,n.charCodeAt(A)===40?(Q=I,A++):(Q=t,fe===0&&Me(He)),Q!==t?(p(),X=Rt(),X!==t?(p(),ye=g(),ye!==t?(p(),Ue=Rt(),Ue!==t?(p(),g(),p(),mn=Rt(),mn===t&&(mn=null),p(),n.charCodeAt(A)===41?(ta=D,A++):(ta=t,fe===0&&Me(Tt)),ta!==t?(he=P,P=rc(X,Ue,mn)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function $e(){var P,Q,X;return P=A,n.charCodeAt(A)===47?(Q=F,A++):(Q=t,fe===0&&Me(kn)),Q!==t?(X=le(),X!==t?(he=P,P=Ls(X)):(A=P,P=t)):(A=P,P=t),P}function Pe(){var P,Q,X;return P=A,n.charCodeAt(A)===42?(Q=_,A++):(Q=t,fe===0&&Me(vs)),Q!==t?(X=le(),X!==t?(he=P,P=oc(X)):(A=P,P=t)):(A=P,P=t),P}function ze(){var P,Q,X;return P=A,n.charCodeAt(A)===63?(Q=$,A++):(Q=t,fe===0&&Me(ln)),Q!==t?(X=$t(),X===t&&(X=null),he=P,P=vo(X)):(A=P,P=t),P}function ct(){var P,Q,X;return P=A,n.charCodeAt(A)===58?(Q=Z,A++):(Q=t,fe===0&&Me(Gs)),Q!==t?(X=le(),X!==t?(he=P,P=er(X)):(A=P,P=t)):(A=P,P=t),P}function it(){var P,Q,X;return P=A,n.substr(A,2)===ce?(Q=ce,A+=2):(Q=t,fe===0&&Me(na)),Q!==t?(X=le(),X!==t?(he=P,P=ic(X)):(A=P,P=t)):(A=P,P=t),P}function Rt(){var P,Q,X,ye;if(P=A,Q=le(),Q!==t){for(X=[],ye=se();ye!==t;)X.push(ye),ye=se();he=P,P=wo(Q,X)}else A=P,P=t;return P}function _t(){var P,Q,X,ye;if(P=A,n.charCodeAt(A)===94?(Q=U,A++):(Q=t,fe===0&&Me(x)),Q===t&&(Q=null),X=[],ye=Rt(),ye!==t)for(;ye!==t;)X.push(ye),ye=Rt();else X=t;return X!==t?(he=P,P=Zo(Q,X)):(A=P,P=t),P}function Ot(){var P,Q,X,ye,Ue;if(P=A,Q=[],X=A,ye=g(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t),X!==t)for(;X!==t;)Q.push(X),X=A,ye=g(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t);else Q=t;return Q!==t&&(he=P,Q=_r(Q)),P=Q,P}function qe(){var P,Q,X,ye,Ue;if(P=A,Q=[],X=A,ye=b(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t),X!==t)for(;X!==t;)Q.push(X),X=A,ye=b(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t);else Q=t;return Q!==t&&(he=P,Q=Yn(Q)),P=Q,P}function Ut(){var P,Q,X,ye,Ue;if(P=A,Q=[],X=A,ye=S(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t),X!==t)for(;X!==t;)Q.push(X),X=A,ye=S(),ye!==t?(Ue=_t(),Ue!==t?X=Ue:(A=X,X=t)):(A=X,X=t);else Q=t;return Q!==t&&(he=P,Q=oa(Q)),P=Q,P}function Dn(){var P,Q,X;return P=A,Q=_t(),Q!==t?(X=Ot(),X===t&&(X=qe(),X===t&&(X=Ut())),X===t&&(X=null),he=P,P=Lr(Q,X)):(A=P,P=t),P}function nn(){var P,Q,X;return P=A,Q=_t(),Q!==t?(X=Ot(),X===t&&(X=null),he=P,P=br(Q,X)):(A=P,P=t),P}function bn(){var P,Q,X,ye;return P=A,p(),Q=C(),Q!==t?(p(),X=Dn(),X!==t?(p(),ye=C(),ye!==t?(he=P,P=tr(X)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function ps(){var P;return P=mO(),P===t&&(P=sr(),P===t&&(P=dO(),P===t&&(P=Is(),P===t&&(P=ia(),P===t&&(P=sa(),P===t&&(P=hO(),P===t&&(P=uc()))))))),P}function sa(){var P,Q,X;return P=A,n.substr(A,6)===ue?(Q=ue,A+=6):(Q=t,fe===0&&Me(B)),Q!==t?(p(),X=xo(),X!==t?(he=P,P=Ir(X)):(A=P,P=t)):(A=P,P=t),P}function Is(){var P,Q,X,ye,Ue;return P=A,n.substr(A,6)===W?(Q=W,A+=6):(Q=t,fe===0&&Me(T)),Q!==t?(p(),X=C(),X!==t?(ye=L(),ye!==t?(Ue=C(),Ue!==t?(he=P,P=nr(ye)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function ia(){var P,Q,X,ye;return P=A,n.substr(A,6)===de?(Q=de,A+=6):(Q=t,fe===0&&Me(R)),Q!==t?(p(),X=Jt(),X!==t?(p(),ye=Jt(),ye!==t?(p(),Jt(),he=P,P=lc(X,ye)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t),P}function sr(){var P,Q,X;return P=A,n.substr(A,4)===be?(Q=be,A+=4):(Q=t,fe===0&&Me(j)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=Ba(X)):(A=P,P=t)):(A=P,P=t),P}function uc(){var P,Q,X;return P=A,n.substr(A,4)===ke?(Q=ke,A+=4):(Q=t,fe===0&&Me(H)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=zo(X)):(A=P,P=t)):(A=P,P=t),P}function hO(){var P,Q,X;return P=A,n.substr(A,4)===Ce?(Q=Ce,A+=4):(Q=t,fe===0&&Me(ee)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=Oo(X)):(A=P,P=t)):(A=P,P=t),P}function dO(){var P,Q,X;return P=A,n.substr(A,4)===Ae?(Q=Ae,A+=4):(Q=t,fe===0&&Me(ne)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=ys(X)):(A=P,P=t)):(A=P,P=t),P}function mO(){var P,Q,X,ye,Ue;if(P=A,n.substr(A,5)===q?(Q=q,A+=5):(Q=t,fe===0&&Me(ge)),Q!==t)if(p(),X=C(),X!==t){if(ye=[],Ue=N(),Ue!==t)for(;Ue!==t;)ye.push(Ue),Ue=N();else ye=t;ye!==t?(Ue=C(),Ue!==t?(he=P,P=Ct(ye)):(A=P,P=t)):(A=P,P=t)}else A=P,P=t;else A=P,P=t;return P}function qu(){var P,Q,X,ye;if(P=A,n.substr(A,2)===Ne?(Q=Ne,A+=2):(Q=t,fe===0&&Me(Fe)),Q!==t){for(X=[],ye=n.charAt(A),In.test(ye)?A++:(ye=t,fe===0&&Me(Be));ye!==t;)X.push(ye),ye=n.charAt(A),In.test(ye)?A++:(ye=t,fe===0&&Me(Be));Q=[Q,X],P=Q}else A=P,P=t;return P}function pO(){var P,Q,X,ye,Ue,mn,ta,ko;if(P=A,n.substr(A,3)===Re?(Q=Re,A+=3):(Q=t,fe===0&&Me(wt)),Q!==t)if(p(),n.charCodeAt(A)===91?(X=h,A++):(X=t,fe===0&&Me(tt)),X!==t)if(p(),ye=xo(),ye!==t){for(Ue=[],mn=A,ta=g(),ta!==t?(ko=xo(),ko!==t?(he=mn,mn=Ai(ye,ko)):(A=mn,mn=t)):(A=mn,mn=t);mn!==t;)Ue.push(mn),mn=A,ta=g(),ta!==t?(ko=xo(),ko!==t?(he=mn,mn=Ai(ye,ko)):(A=mn,mn=t)):(A=mn,mn=t);mn=p(),n.charCodeAt(A)===93?(ta=m,A++):(ta=t,fe===0&&Me(zn)),ta!==t?(he=P,P=yr(ye,Ue)):(A=P,P=t)}else A=P,P=t;else A=P,P=t;else A=P,P=t;return P}function fO(){var P;return P=pO(),P===t&&(P=bn()),P}function xo(){var P,Q,X,ye,Ue;if(P=A,Q=fO(),Q!==t){for(p(),X=[],ye=qu();ye!==t;)X.push(ye),ye=qu();he=P,P=cc(Q)}else A=P,P=t;return P===t&&(P=A,Q=ps(),Q!==t?(p(),n.charCodeAt(A)===36?(X=je,A++):(X=t,fe===0&&Me(Nt)),X!==t?(ye=p(),Ue=xo(),Ue!==t?(he=P,P=$a(Q,Ue)):(A=P,P=t)):(A=P,P=t)):(A=P,P=t)),P}function gO(){var P,Q;return P=A,Q=xo(),Q!==t&&(he=P,Q=hl(Q)),P=Q,P===t&&(P=qu()),P}function bO(){var P;return P=gO(),P}function yO(){var P,Q;return P=A,p(),Q=vO(),Q===t&&(Q=wO(),Q===t&&(Q=OO())),Q!==t?(p(),he=P,P=Ra(Q)):(A=P,P=t),P}function vO(){var P,Q,X;return P=A,n.substr(A,6)===me?(Q=me,A+=6):(Q=t,fe===0&&Me(yn)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=Y(X)):(A=P,P=t)):(A=P,P=t),P}function wO(){var P,Q,X;return P=A,n.substr(A,6)===Ye?(Q=Ye,A+=6):(Q=t,fe===0&&Me(ws)),Q!==t?(p(),X=$t(),X!==t?(he=P,P=J(X)):(A=P,P=t)):(A=P,P=t),P}function OO(){var P,Q;return P=A,n.substr(A,4)===ft?(Q=ft,A+=4):(Q=t,fe===0&&Me(gn)),Q!==t&&(he=P,Q=te()),P=Q,P}function xO(){var P;return P=bO(),P===t&&(P=yO()),P}var kO=function(P){this.type_="atom",this.source_=P,this.location_=Ee()},hc=function(P,Q,X,ye){this.type_="pattern",this.arguments_={alignment:Q,_steps:ye},X!==void 0&&(this.arguments_.seed=X),this.source_=P},PO=function(P,Q,X){this.type_=P,this.arguments_=Q,this.source_=X},SO=function(P,Q){this.type_="element",this.source_=P,this.options_=Q,this.location_=Ee()},Uu=function(P,Q){this.type_="command",this.name_=P,this.options_=Q},Hu=0;if(Te=r(),e.peg$library)return{peg$result:Te,peg$currPos:A,peg$FAILED:t,peg$maxFailExpected:Se,peg$maxFailPos:Oe};if(Te!==t&&A===n.length)return Te;throw Te!==t&&A<n.length&&Me(st()),Ke(Se,Oe<n.length?n.charAt(Oe):null,Oe<n.length?et(Oe,Oe+1):et(Oe,Oe))}const $Oe=["start"],IG=3e-4,ROe=(n,e)=>(t,s)=>{var o;const a=(o=n.source_[s].options_)==null?void 0:o.ops,r=t.__steps_source;if(a)for(const i of a)switch(i.type_){case"stretch":{const l=["fast","slow"],{type:c,amount:u}=i.arguments_;if(!l.includes(c))throw new Error(`mini: stretch: type must be one of ${l.join("|")} but got ${c}`);t=yt(t)[c](e(u));break}case"replicate":{const{amount:l}=i.arguments_;t=yt(t),t=t._repeatCycles(l)._fast(l);break}case"bjorklund":{i.arguments_.rotation?t=t.euclidRot(e(i.arguments_.pulse),e(i.arguments_.step),e(i.arguments_.rotation)):t=t.euclid(e(i.arguments_.pulse),e(i.arguments_.step));break}case"degradeBy":{t=yt(t)._degradeByWith(Fr.early(IG*i.arguments_.seed),i.arguments_.amount??.5);break}case"tail":{const l=e(i.arguments_.element);t=t.fmap(c=>u=>Array.isArray(c)?[...c,u]:[c,u]).appLeft(l);break}case"range":{const l=e(i.arguments_.element);t=yt(t);const c=(u,h,m=1)=>Array.from({length:Math.abs(h-u)/m+1},(f,v)=>u<h?u+v*m:u-v*m);t=((u,h)=>u.squeezeBind(m=>h.bind(f=>fr(...c(m,f)))))(t,l);break}default:console.warn(`operator "${i.type_}" not implemented`)}return t.__steps_source=t.__steps_source||r,t};function Um(n,e,t,s=0){t==null||t(n);const a=r=>Um(r,e,t,s);switch(n.type_){case"pattern":{const r=n.source_.map(c=>a(c)).map(ROe(n,a)),o=n.arguments_.alignment,i=r.filter(c=>c.__steps_source);let l;switch(o){case"stack":{l=js(...r),i.length&&(l._steps=zi(...i.map(c=>ht(c._steps))));break}case"polymeter_slowcat":{l=js(...r.map(c=>c._slow(c.__weight))),i.length&&(l._steps=zi(...i.map(c=>ht(c._steps))));break}case"polymeter":{const c=n.arguments_.stepsPerCycle?a(n.arguments_.stepsPerCycle).fmap(h=>ht(h)):Ys(ht(r.length>0?r[0].__weight:1)),u=r.map(h=>h.fast(c.fmap(m=>m.div(h.__weight))));l=js(...u);break}case"rand":{l=xw(Fr.early(IG*n.arguments_.seed).segment(1),r),i.length&&(l._steps=zi(...i.map(c=>ht(c._steps))));break}case"feet":{l=fr(...r);break}default:{if(n.source_.some(c=>{var u;return!!((u=c.options_)!=null&&u.weight)})){const c=n.source_.reduce((u,h)=>{var m;return u.add(((m=h.options_)==null?void 0:m.weight)||ht(1))},ht(0));l=AA(...n.source_.map((u,h)=>{var m;return[((m=u.options_)==null?void 0:m.weight)||ht(1),r[h]]})),l.__weight=c,l._steps=c,i.length&&(l._steps=l._steps.mul(zi(...i.map(u=>ht(u._steps)))))}else l=tl(...r),l._steps=r.length;n.arguments_._steps&&(l.__steps_source=!0)}}return i.length&&(l.__steps_source=!0),l}case"element":return a(n.source_);case"atom":{if(n.source_==="~"||n.source_==="-")return us;if(!n.location_)return console.warn("no location for",n),n.source_;const r=isNaN(Number(n.source_))?n.source_:Number(n.source_);if(s===-1)return Ys(r);const[o,i]=XA(e,n,s);return Ys(r).withLoc(o,i)}case"stretch":return a(n.source_).slow(a(n.arguments_.amount));default:return console.warn(`node type "${n.type_}" not implemented -> returning silence`),us}}const XA=(n,e,t=0)=>{const{start:s,end:a}=e.location_,r=n==null?void 0:n.split("").slice(s.offset,a.offset).join(""),[o=0,i=0]=r?r.split(e.source_).map(l=>l.split("").filter(c=>c===" ").length):[];return[s.offset+o+t,a.offset-i+t]},Hg=(n,e=0,t=n)=>{try{return LG(n)}catch(s){const a=[s.location.start.offset+e,s.location.end.offset+e],r=t.slice(0,a[0]).split(`
`).length;throw new Error(`[mini] parse error at line ${r}: ${s.message}`)}},QG=(n,e,t)=>{const s=Hg(n,e,t);let a=[];return Um(s,n,r=>{r.type_==="atom"&&a.push(r)},-1),a},WA=(n,e=0,t)=>QG(n,e,t).map(s=>XA(n,s,e)),qA=(...n)=>{const e=n.map(t=>{const s=`"${t}"`,a=Hg(s);return Um(a,s)});return tl(...e)},_Oe=(n,e)=>{const t=`"${n}"`,s=Hg(t);return Um(s,t,null,e)},LOe=n=>{const e=Hg(n);return Um(e,n)};function IOe(n){return typeof n=="string"?qA(n):yt(n)}function QOe(){bL(qA)}const VOe=Object.freeze(Object.defineProperty({__proto__:null,StartRules:$Oe,SyntaxError:Vh,getLeafLocation:XA,getLeafLocations:WA,getLeaves:QG,h:LOe,m:_Oe,mini:qA,mini2ast:Hg,miniAllStrings:QOe,minify:IOe,parse:LG,patternifyAST:Um},Symbol.toStringTag,{value:"Module"}));var jOe=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],VG=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],ZOe="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",jG="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Qx={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},Vx="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",zOe={5:Vx,"5module":Vx+" export import",6:Vx+" const class extends export import super"},GOe=/^in(stanceof)?$/,XOe=new RegExp("["+jG+"]"),WOe=new RegExp("["+jG+ZOe+"]");function J2(n,e){for(var t=65536,s=0;s<e.length;s+=2){if(t+=e[s],t>n)return!1;if(t+=e[s+1],t>=n)return!0}return!1}function Bc(n,e){return n<65?n===36:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&XOe.test(String.fromCharCode(n)):e===!1?!1:J2(n,VG)}function fm(n,e){return n<48?n===36:n<58?!0:n<65?!1:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&WOe.test(String.fromCharCode(n)):e===!1?!1:J2(n,VG)||J2(n,jOe)}var ns=function(n,e){e===void 0&&(e={}),this.label=n,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function qo(n,e){return new ns(n,{beforeExpr:!0,binop:e})}var Uo={beforeExpr:!0},Vr={startsExpr:!0},UA={};function Jn(n,e){return e===void 0&&(e={}),e.keyword=n,UA[n]=new ns(n,e)}var re={num:new ns("num",Vr),regexp:new ns("regexp",Vr),string:new ns("string",Vr),name:new ns("name",Vr),privateId:new ns("privateId",Vr),eof:new ns("eof"),bracketL:new ns("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ns("]"),braceL:new ns("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ns("}"),parenL:new ns("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ns(")"),comma:new ns(",",Uo),semi:new ns(";",Uo),colon:new ns(":",Uo),dot:new ns("."),question:new ns("?",Uo),questionDot:new ns("?."),arrow:new ns("=>",Uo),template:new ns("template"),invalidTemplate:new ns("invalidTemplate"),ellipsis:new ns("...",Uo),backQuote:new ns("`",Vr),dollarBraceL:new ns("${",{beforeExpr:!0,startsExpr:!0}),eq:new ns("=",{beforeExpr:!0,isAssign:!0}),assign:new ns("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ns("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ns("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:qo("||",1),logicalAND:qo("&&",2),bitwiseOR:qo("|",3),bitwiseXOR:qo("^",4),bitwiseAND:qo("&",5),equality:qo("==/!=/===/!==",6),relational:qo("</>/<=/>=",7),bitShift:qo("<</>>/>>>",8),plusMin:new ns("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:qo("%",10),star:qo("*",10),slash:qo("/",10),starstar:new ns("**",{beforeExpr:!0}),coalesce:qo("??",1),_break:Jn("break"),_case:Jn("case",Uo),_catch:Jn("catch"),_continue:Jn("continue"),_debugger:Jn("debugger"),_default:Jn("default",Uo),_do:Jn("do",{isLoop:!0,beforeExpr:!0}),_else:Jn("else",Uo),_finally:Jn("finally"),_for:Jn("for",{isLoop:!0}),_function:Jn("function",Vr),_if:Jn("if"),_return:Jn("return",Uo),_switch:Jn("switch"),_throw:Jn("throw",Uo),_try:Jn("try"),_var:Jn("var"),_const:Jn("const"),_while:Jn("while",{isLoop:!0}),_with:Jn("with"),_new:Jn("new",{beforeExpr:!0,startsExpr:!0}),_this:Jn("this",Vr),_super:Jn("super",Vr),_class:Jn("class",Vr),_extends:Jn("extends",Uo),_export:Jn("export"),_import:Jn("import",Vr),_null:Jn("null",Vr),_true:Jn("true",Vr),_false:Jn("false",Vr),_in:Jn("in",{beforeExpr:!0,binop:7}),_instanceof:Jn("instanceof",{beforeExpr:!0,binop:7}),_typeof:Jn("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Jn("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Jn("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Si=/\r\n?|\n|\u2028|\u2029/,qOe=new RegExp(Si.source,"g");function Hm(n){return n===10||n===13||n===8232||n===8233}function ZG(n,e,t){t===void 0&&(t=n.length);for(var s=e;s<t;s++){var a=n.charCodeAt(s);if(Hm(a))return s<t-1&&a===13&&n.charCodeAt(s+1)===10?s+2:s+1}return-1}var zG=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ti=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,GG=Object.prototype,UOe=GG.hasOwnProperty,HOe=GG.toString,Ym=Object.hasOwn||function(n,e){return UOe.call(n,e)},L9=Array.isArray||function(n){return HOe.call(n)==="[object Array]"},I9=Object.create(null);function cu(n){return I9[n]||(I9[n]=new RegExp("^(?:"+n.replace(/ /g,"|")+")$"))}function $c(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}var YOe=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,ig=function(n,e){this.line=n,this.column=e};ig.prototype.offset=function(n){return new ig(this.line,this.column+n)};var kw=function(n,e,t){this.start=e,this.end=t,n.sourceFile!==null&&(this.source=n.sourceFile)};function XG(n,e){for(var t=1,s=0;;){var a=ZG(n,s,e);if(a<0)return new ig(t,e-s);++t,s=a}}var eS={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Q9=!1;function KOe(n){var e={};for(var t in eS)e[t]=n&&Ym(n,t)?n[t]:eS[t];if(e.ecmaVersion==="latest"?e.ecmaVersion=1e8:e.ecmaVersion==null?(!Q9&&typeof console=="object"&&console.warn&&(Q9=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),e.allowReserved==null&&(e.allowReserved=e.ecmaVersion<5),(!n||n.allowHashBang==null)&&(e.allowHashBang=e.ecmaVersion>=14),L9(e.onToken)){var s=e.onToken;e.onToken=function(a){return s.push(a)}}return L9(e.onComment)&&(e.onComment=JOe(e,e.onComment)),e}function JOe(n,e){return function(t,s,a,r,o,i){var l={type:t?"Block":"Line",value:s,start:a,end:r};n.locations&&(l.loc=new kw(this,o,i)),n.ranges&&(l.range=[a,r]),e.push(l)}}var lg=1,Km=2,HA=4,WG=8,qG=16,UG=32,YA=64,HG=128,Yg=256,KA=lg|Km|Yg;function JA(n,e){return Km|(n?HA:0)|(e?WG:0)}var Ay=0,e3=1,Zc=2,YG=3,KG=4,JG=5,Ta=function(n,e,t){this.options=n=KOe(n),this.sourceFile=n.sourceFile,this.keywords=cu(zOe[n.ecmaVersion>=6?6:n.sourceType==="module"?"5module":5]);var s="";n.allowReserved!==!0&&(s=Qx[n.ecmaVersion>=6?6:n.ecmaVersion===5?5:3],n.sourceType==="module"&&(s+=" await")),this.reservedWords=cu(s);var a=(s?s+" ":"")+Qx.strict;this.reservedWordsStrict=cu(a),this.reservedWordsStrictBind=cu(a+" "+Qx.strictBind),this.input=String(e),this.containsEsc=!1,t?(this.pos=t,this.lineStart=this.input.lastIndexOf(`
`,t-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Si).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=re.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=n.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&n.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(lg),this.regexpState=null,this.privateNameStack=[]},nc={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Ta.prototype.parse=function(){var n=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(n)};nc.inFunction.get=function(){return(this.currentVarScope().flags&Km)>0};nc.inGenerator.get=function(){return(this.currentVarScope().flags&WG)>0&&!this.currentVarScope().inClassFieldInit};nc.inAsync.get=function(){return(this.currentVarScope().flags&HA)>0&&!this.currentVarScope().inClassFieldInit};nc.canAwait.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var e=this.scopeStack[n];if(e.inClassFieldInit||e.flags&Yg)return!1;if(e.flags&Km)return(e.flags&HA)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};nc.allowSuper.get=function(){var n=this.currentThisScope(),e=n.flags,t=n.inClassFieldInit;return(e&YA)>0||t||this.options.allowSuperOutsideMethod};nc.allowDirectSuper.get=function(){return(this.currentThisScope().flags&HG)>0};nc.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};nc.allowNewDotTarget.get=function(){var n=this.currentThisScope(),e=n.flags,t=n.inClassFieldInit;return(e&(Km|Yg))>0||t};nc.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Yg)>0};Ta.extend=function(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];for(var t=this,s=0;s<n.length;s++)t=n[s](t);return t};Ta.parse=function(n,e){return new this(e,n).parse()};Ta.parseExpressionAt=function(n,e,t){var s=new this(t,n,e);return s.nextToken(),s.parseExpression()};Ta.tokenizer=function(n,e){return new this(e,n)};Object.defineProperties(Ta.prototype,nc);var Br=Ta.prototype,exe=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Br.strictDirective=function(n){if(this.options.ecmaVersion<5)return!1;for(;;){ti.lastIndex=n,n+=ti.exec(this.input)[0].length;var e=exe.exec(this.input.slice(n));if(!e)return!1;if((e[1]||e[2])==="use strict"){ti.lastIndex=n+e[0].length;var t=ti.exec(this.input),s=t.index+t[0].length,a=this.input.charAt(s);return a===";"||a==="}"||Si.test(t[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(a)||a==="!"&&this.input.charAt(s+1)==="=")}n+=e[0].length,ti.lastIndex=n,n+=ti.exec(this.input)[0].length,this.input[n]===";"&&n++}};Br.eat=function(n){return this.type===n?(this.next(),!0):!1};Br.isContextual=function(n){return this.type===re.name&&this.value===n&&!this.containsEsc};Br.eatContextual=function(n){return this.isContextual(n)?(this.next(),!0):!1};Br.expectContextual=function(n){this.eatContextual(n)||this.unexpected()};Br.canInsertSemicolon=function(){return this.type===re.eof||this.type===re.braceR||Si.test(this.input.slice(this.lastTokEnd,this.start))};Br.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Br.semicolon=function(){!this.eat(re.semi)&&!this.insertSemicolon()&&this.unexpected()};Br.afterTrailingComma=function(n,e){if(this.type===n)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0};Br.expect=function(n){this.eat(n)||this.unexpected()};Br.unexpected=function(n){this.raise(n??this.start,"Unexpected token")};var Pw=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Br.checkPatternErrors=function(n,e){if(n){n.trailingComma>-1&&this.raiseRecoverable(n.trailingComma,"Comma is not permitted after the rest element");var t=e?n.parenthesizedAssign:n.parenthesizedBind;t>-1&&this.raiseRecoverable(t,e?"Assigning to rvalue":"Parenthesized pattern")}};Br.checkExpressionErrors=function(n,e){if(!n)return!1;var t=n.shorthandAssign,s=n.doubleProto;if(!e)return t>=0||s>=0;t>=0&&this.raise(t,"Shorthand property assignments are valid only in destructuring patterns"),s>=0&&this.raiseRecoverable(s,"Redefinition of __proto__ property")};Br.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Br.isSimpleAssignTarget=function(n){return n.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(n.expression):n.type==="Identifier"||n.type==="MemberExpression"};var Kt=Ta.prototype;Kt.parseTopLevel=function(n){var e=Object.create(null);for(n.body||(n.body=[]);this.type!==re.eof;){var t=this.parseStatement(null,!0,e);n.body.push(t)}if(this.inModule)for(var s=0,a=Object.keys(this.undefinedExports);s<a.length;s+=1){var r=a[s];this.raiseRecoverable(this.undefinedExports[r].start,"Export '"+r+"' is not defined")}return this.adaptDirectivePrologue(n.body),this.next(),n.sourceType=this.options.sourceType,this.finishNode(n,"Program")};var t3={kind:"loop"},txe={kind:"switch"};Kt.isLet=function(n){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;ti.lastIndex=this.pos;var e=ti.exec(this.input),t=this.pos+e[0].length,s=this.input.charCodeAt(t);if(s===91||s===92)return!0;if(n)return!1;if(s===123||s>55295&&s<56320)return!0;if(Bc(s,!0)){for(var a=t+1;fm(s=this.input.charCodeAt(a),!0);)++a;if(s===92||s>55295&&s<56320)return!0;var r=this.input.slice(t,a);if(!GOe.test(r))return!0}return!1};Kt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;ti.lastIndex=this.pos;var n=ti.exec(this.input),e=this.pos+n[0].length,t;return!Si.test(this.input.slice(this.pos,e))&&this.input.slice(e,e+8)==="function"&&(e+8===this.input.length||!(fm(t=this.input.charCodeAt(e+8))||t>55295&&t<56320))};Kt.parseStatement=function(n,e,t){var s=this.type,a=this.startNode(),r;switch(this.isLet(n)&&(s=re._var,r="let"),s){case re._break:case re._continue:return this.parseBreakContinueStatement(a,s.keyword);case re._debugger:return this.parseDebuggerStatement(a);case re._do:return this.parseDoStatement(a);case re._for:return this.parseForStatement(a);case re._function:return n&&(this.strict||n!=="if"&&n!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(a,!1,!n);case re._class:return n&&this.unexpected(),this.parseClass(a,!0);case re._if:return this.parseIfStatement(a);case re._return:return this.parseReturnStatement(a);case re._switch:return this.parseSwitchStatement(a);case re._throw:return this.parseThrowStatement(a);case re._try:return this.parseTryStatement(a);case re._const:case re._var:return r=r||this.value,n&&r!=="var"&&this.unexpected(),this.parseVarStatement(a,r);case re._while:return this.parseWhileStatement(a);case re._with:return this.parseWithStatement(a);case re.braceL:return this.parseBlock(!0,a);case re.semi:return this.parseEmptyStatement(a);case re._export:case re._import:if(this.options.ecmaVersion>10&&s===re._import){ti.lastIndex=this.pos;var o=ti.exec(this.input),i=this.pos+o[0].length,l=this.input.charCodeAt(i);if(l===40||l===46)return this.parseExpressionStatement(a,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),s===re._import?this.parseImport(a):this.parseExport(a,t);default:if(this.isAsyncFunction())return n&&this.unexpected(),this.next(),this.parseFunctionStatement(a,!0,!n);var c=this.value,u=this.parseExpression();return s===re.name&&u.type==="Identifier"&&this.eat(re.colon)?this.parseLabeledStatement(a,c,u,n):this.parseExpressionStatement(a,u)}};Kt.parseBreakContinueStatement=function(n,e){var t=e==="break";this.next(),this.eat(re.semi)||this.insertSemicolon()?n.label=null:this.type!==re.name?this.unexpected():(n.label=this.parseIdent(),this.semicolon());for(var s=0;s<this.labels.length;++s){var a=this.labels[s];if((n.label==null||a.name===n.label.name)&&(a.kind!=null&&(t||a.kind==="loop")||n.label&&t))break}return s===this.labels.length&&this.raise(n.start,"Unsyntactic "+e),this.finishNode(n,t?"BreakStatement":"ContinueStatement")};Kt.parseDebuggerStatement=function(n){return this.next(),this.semicolon(),this.finishNode(n,"DebuggerStatement")};Kt.parseDoStatement=function(n){return this.next(),this.labels.push(t3),n.body=this.parseStatement("do"),this.labels.pop(),this.expect(re._while),n.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(re.semi):this.semicolon(),this.finishNode(n,"DoWhileStatement")};Kt.parseForStatement=function(n){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(t3),this.enterScope(0),this.expect(re.parenL),this.type===re.semi)return e>-1&&this.unexpected(e),this.parseFor(n,null);var t=this.isLet();if(this.type===re._var||this.type===re._const||t){var s=this.startNode(),a=t?"let":this.value;return this.next(),this.parseVar(s,!0,a),this.finishNode(s,"VariableDeclaration"),(this.type===re._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&s.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===re._in?e>-1&&this.unexpected(e):n.await=e>-1),this.parseForIn(n,s)):(e>-1&&this.unexpected(e),this.parseFor(n,s))}var r=this.isContextual("let"),o=!1,i=this.containsEsc,l=new Pw,c=this.start,u=e>-1?this.parseExprSubscripts(l,"await"):this.parseExpression(!0,l);return this.type===re._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(e>-1?(this.type===re._in&&this.unexpected(e),n.await=!0):o&&this.options.ecmaVersion>=8&&(u.start===c&&!i&&u.type==="Identifier"&&u.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(n.await=!1)),r&&o&&this.raise(u.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(u,!1,l),this.checkLValPattern(u),this.parseForIn(n,u)):(this.checkExpressionErrors(l,!0),e>-1&&this.unexpected(e),this.parseFor(n,u))};Kt.parseFunctionStatement=function(n,e,t){return this.next(),this.parseFunction(n,Pf|(t?0:tS),!1,e)};Kt.parseIfStatement=function(n){return this.next(),n.test=this.parseParenExpression(),n.consequent=this.parseStatement("if"),n.alternate=this.eat(re._else)?this.parseStatement("if"):null,this.finishNode(n,"IfStatement")};Kt.parseReturnStatement=function(n){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(re.semi)||this.insertSemicolon()?n.argument=null:(n.argument=this.parseExpression(),this.semicolon()),this.finishNode(n,"ReturnStatement")};Kt.parseSwitchStatement=function(n){this.next(),n.discriminant=this.parseParenExpression(),n.cases=[],this.expect(re.braceL),this.labels.push(txe),this.enterScope(0);for(var e,t=!1;this.type!==re.braceR;)if(this.type===re._case||this.type===re._default){var s=this.type===re._case;e&&this.finishNode(e,"SwitchCase"),n.cases.push(e=this.startNode()),e.consequent=[],this.next(),s?e.test=this.parseExpression():(t&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),t=!0,e.test=null),this.expect(re.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(n,"SwitchStatement")};Kt.parseThrowStatement=function(n){return this.next(),Si.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),n.argument=this.parseExpression(),this.semicolon(),this.finishNode(n,"ThrowStatement")};var nxe=[];Kt.parseCatchClauseParam=function(){var n=this.parseBindingAtom(),e=n.type==="Identifier";return this.enterScope(e?UG:0),this.checkLValPattern(n,e?KG:Zc),this.expect(re.parenR),n};Kt.parseTryStatement=function(n){if(this.next(),n.block=this.parseBlock(),n.handler=null,this.type===re._catch){var e=this.startNode();this.next(),this.eat(re.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),n.handler=this.finishNode(e,"CatchClause")}return n.finalizer=this.eat(re._finally)?this.parseBlock():null,!n.handler&&!n.finalizer&&this.raise(n.start,"Missing catch or finally clause"),this.finishNode(n,"TryStatement")};Kt.parseVarStatement=function(n,e,t){return this.next(),this.parseVar(n,!1,e,t),this.semicolon(),this.finishNode(n,"VariableDeclaration")};Kt.parseWhileStatement=function(n){return this.next(),n.test=this.parseParenExpression(),this.labels.push(t3),n.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(n,"WhileStatement")};Kt.parseWithStatement=function(n){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),n.object=this.parseParenExpression(),n.body=this.parseStatement("with"),this.finishNode(n,"WithStatement")};Kt.parseEmptyStatement=function(n){return this.next(),this.finishNode(n,"EmptyStatement")};Kt.parseLabeledStatement=function(n,e,t,s){for(var a=0,r=this.labels;a<r.length;a+=1){var o=r[a];o.name===e&&this.raise(t.start,"Label '"+e+"' is already declared")}for(var i=this.type.isLoop?"loop":this.type===re._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===n.start)c.statementStart=this.start,c.kind=i;else break}return this.labels.push({name:e,kind:i,statementStart:this.start}),n.body=this.parseStatement(s?s.indexOf("label")===-1?s+"label":s:"label"),this.labels.pop(),n.label=t,this.finishNode(n,"LabeledStatement")};Kt.parseExpressionStatement=function(n,e){return n.expression=e,this.semicolon(),this.finishNode(n,"ExpressionStatement")};Kt.parseBlock=function(n,e,t){for(n===void 0&&(n=!0),e===void 0&&(e=this.startNode()),e.body=[],this.expect(re.braceL),n&&this.enterScope(0);this.type!==re.braceR;){var s=this.parseStatement(null);e.body.push(s)}return t&&(this.strict=!1),this.next(),n&&this.exitScope(),this.finishNode(e,"BlockStatement")};Kt.parseFor=function(n,e){return n.init=e,this.expect(re.semi),n.test=this.type===re.semi?null:this.parseExpression(),this.expect(re.semi),n.update=this.type===re.parenR?null:this.parseExpression(),this.expect(re.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,"ForStatement")};Kt.parseForIn=function(n,e){var t=this.type===re._in;return this.next(),e.type==="VariableDeclaration"&&e.declarations[0].init!=null&&(!t||this.options.ecmaVersion<8||this.strict||e.kind!=="var"||e.declarations[0].id.type!=="Identifier")&&this.raise(e.start,(t?"for-in":"for-of")+" loop variable declaration may not have an initializer"),n.left=e,n.right=t?this.parseExpression():this.parseMaybeAssign(),this.expect(re.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,t?"ForInStatement":"ForOfStatement")};Kt.parseVar=function(n,e,t,s){for(n.declarations=[],n.kind=t;;){var a=this.startNode();if(this.parseVarId(a,t),this.eat(re.eq)?a.init=this.parseMaybeAssign(e):!s&&t==="const"&&!(this.type===re._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!s&&a.id.type!=="Identifier"&&!(e&&(this.type===re._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):a.init=null,n.declarations.push(this.finishNode(a,"VariableDeclarator")),!this.eat(re.comma))break}return n};Kt.parseVarId=function(n,e){n.id=this.parseBindingAtom(),this.checkLValPattern(n.id,e==="var"?e3:Zc,!1)};var Pf=1,tS=2,eX=4;Kt.parseFunction=function(n,e,t,s,a){this.initFunction(n),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!s)&&(this.type===re.star&&e&tS&&this.unexpected(),n.generator=this.eat(re.star)),this.options.ecmaVersion>=8&&(n.async=!!s),e&Pf&&(n.id=e&eX&&this.type!==re.name?null:this.parseIdent(),n.id&&!(e&tS)&&this.checkLValSimple(n.id,this.strict||n.generator||n.async?this.treatFunctionsAsVar?e3:Zc:YG));var r=this.yieldPos,o=this.awaitPos,i=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(JA(n.async,n.generator)),e&Pf||(n.id=this.type===re.name?this.parseIdent():null),this.parseFunctionParams(n),this.parseFunctionBody(n,t,!1,a),this.yieldPos=r,this.awaitPos=o,this.awaitIdentPos=i,this.finishNode(n,e&Pf?"FunctionDeclaration":"FunctionExpression")};Kt.parseFunctionParams=function(n){this.expect(re.parenL),n.params=this.parseBindingList(re.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Kt.parseClass=function(n,e){this.next();var t=this.strict;this.strict=!0,this.parseClassId(n,e),this.parseClassSuper(n);var s=this.enterClassBody(),a=this.startNode(),r=!1;for(a.body=[],this.expect(re.braceL);this.type!==re.braceR;){var o=this.parseClassElement(n.superClass!==null);o&&(a.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(r&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),r=!0):o.key&&o.key.type==="PrivateIdentifier"&&sxe(s,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=t,this.next(),n.body=this.finishNode(a,"ClassBody"),this.exitClassBody(),this.finishNode(n,e?"ClassDeclaration":"ClassExpression")};Kt.parseClassElement=function(n){if(this.eat(re.semi))return null;var e=this.options.ecmaVersion,t=this.startNode(),s="",a=!1,r=!1,o="method",i=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(re.braceL))return this.parseClassStaticBlock(t),t;this.isClassElementNameStart()||this.type===re.star?i=!0:s="static"}if(t.static=i,!s&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===re.star)&&!this.canInsertSemicolon()?r=!0:s="async"),!s&&(e>=9||!r)&&this.eat(re.star)&&(a=!0),!s&&!r&&!a){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:s=l)}if(s?(t.computed=!1,t.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),t.key.name=s,this.finishNode(t.key,"Identifier")):this.parseClassElementName(t),e<13||this.type===re.parenL||o!=="method"||a||r){var c=!t.static&&Ey(t,"constructor"),u=c&&n;c&&o!=="method"&&this.raise(t.key.start,"Constructor can't have get/set modifier"),t.kind=c?"constructor":o,this.parseClassMethod(t,a,r,u)}else this.parseClassField(t);return t};Kt.isClassElementNameStart=function(){return this.type===re.name||this.type===re.privateId||this.type===re.num||this.type===re.string||this.type===re.bracketL||this.type.keyword};Kt.parseClassElementName=function(n){this.type===re.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),n.computed=!1,n.key=this.parsePrivateIdent()):this.parsePropertyName(n)};Kt.parseClassMethod=function(n,e,t,s){var a=n.key;n.kind==="constructor"?(e&&this.raise(a.start,"Constructor can't be a generator"),t&&this.raise(a.start,"Constructor can't be an async method")):n.static&&Ey(n,"prototype")&&this.raise(a.start,"Classes may not have a static property named prototype");var r=n.value=this.parseMethod(e,t,s);return n.kind==="get"&&r.params.length!==0&&this.raiseRecoverable(r.start,"getter should have no params"),n.kind==="set"&&r.params.length!==1&&this.raiseRecoverable(r.start,"setter should have exactly one param"),n.kind==="set"&&r.params[0].type==="RestElement"&&this.raiseRecoverable(r.params[0].start,"Setter cannot use rest params"),this.finishNode(n,"MethodDefinition")};Kt.parseClassField=function(n){if(Ey(n,"constructor")?this.raise(n.key.start,"Classes can't have a field named 'constructor'"):n.static&&Ey(n,"prototype")&&this.raise(n.key.start,"Classes can't have a static field named 'prototype'"),this.eat(re.eq)){var e=this.currentThisScope(),t=e.inClassFieldInit;e.inClassFieldInit=!0,n.value=this.parseMaybeAssign(),e.inClassFieldInit=t}else n.value=null;return this.semicolon(),this.finishNode(n,"PropertyDefinition")};Kt.parseClassStaticBlock=function(n){n.body=[];var e=this.labels;for(this.labels=[],this.enterScope(Yg|YA);this.type!==re.braceR;){var t=this.parseStatement(null);n.body.push(t)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(n,"StaticBlock")};Kt.parseClassId=function(n,e){this.type===re.name?(n.id=this.parseIdent(),e&&this.checkLValSimple(n.id,Zc,!1)):(e===!0&&this.unexpected(),n.id=null)};Kt.parseClassSuper=function(n){n.superClass=this.eat(re._extends)?this.parseExprSubscripts(null,!1):null};Kt.enterClassBody=function(){var n={declared:Object.create(null),used:[]};return this.privateNameStack.push(n),n.declared};Kt.exitClassBody=function(){var n=this.privateNameStack.pop(),e=n.declared,t=n.used;if(this.options.checkPrivateFields)for(var s=this.privateNameStack.length,a=s===0?null:this.privateNameStack[s-1],r=0;r<t.length;++r){var o=t[r];Ym(e,o.name)||(a?a.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function sxe(n,e){var t=e.key.name,s=n[t],a="true";return e.type==="MethodDefinition"&&(e.kind==="get"||e.kind==="set")&&(a=(e.static?"s":"i")+e.kind),s==="iget"&&a==="iset"||s==="iset"&&a==="iget"||s==="sget"&&a==="sset"||s==="sset"&&a==="sget"?(n[t]="true",!1):s?!0:(n[t]=a,!1)}function Ey(n,e){var t=n.computed,s=n.key;return!t&&(s.type==="Identifier"&&s.name===e||s.type==="Literal"&&s.value===e)}Kt.parseExportAllDeclaration=function(n,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(n.exported=this.parseModuleExportName(),this.checkExport(e,n.exported,this.lastTokStart)):n.exported=null),this.expectContextual("from"),this.type!==re.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ExportAllDeclaration")};Kt.parseExport=function(n,e){if(this.next(),this.eat(re.star))return this.parseExportAllDeclaration(n,e);if(this.eat(re._default))return this.checkExport(e,"default",this.lastTokStart),n.declaration=this.parseExportDefaultDeclaration(),this.finishNode(n,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())n.declaration=this.parseExportDeclaration(n),n.declaration.type==="VariableDeclaration"?this.checkVariableExport(e,n.declaration.declarations):this.checkExport(e,n.declaration.id,n.declaration.id.start),n.specifiers=[],n.source=null;else{if(n.declaration=null,n.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==re.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause());else{for(var t=0,s=n.specifiers;t<s.length;t+=1){var a=s[t];this.checkUnreserved(a.local),this.checkLocalExport(a.local),a.local.type==="Literal"&&this.raise(a.local.start,"A string literal cannot be used as an exported binding without `from`.")}n.source=null}this.semicolon()}return this.finishNode(n,"ExportNamedDeclaration")};Kt.parseExportDeclaration=function(n){return this.parseStatement(null)};Kt.parseExportDefaultDeclaration=function(){var n;if(this.type===re._function||(n=this.isAsyncFunction())){var e=this.startNode();return this.next(),n&&this.next(),this.parseFunction(e,Pf|eX,!1,n)}else if(this.type===re._class){var t=this.startNode();return this.parseClass(t,"nullableID")}else{var s=this.parseMaybeAssign();return this.semicolon(),s}};Kt.checkExport=function(n,e,t){n&&(typeof e!="string"&&(e=e.type==="Identifier"?e.name:e.value),Ym(n,e)&&this.raiseRecoverable(t,"Duplicate export '"+e+"'"),n[e]=!0)};Kt.checkPatternExport=function(n,e){var t=e.type;if(t==="Identifier")this.checkExport(n,e,e.start);else if(t==="ObjectPattern")for(var s=0,a=e.properties;s<a.length;s+=1){var r=a[s];this.checkPatternExport(n,r)}else if(t==="ArrayPattern")for(var o=0,i=e.elements;o<i.length;o+=1){var l=i[o];l&&this.checkPatternExport(n,l)}else t==="Property"?this.checkPatternExport(n,e.value):t==="AssignmentPattern"?this.checkPatternExport(n,e.left):t==="RestElement"&&this.checkPatternExport(n,e.argument)};Kt.checkVariableExport=function(n,e){if(n)for(var t=0,s=e;t<s.length;t+=1){var a=s[t];this.checkPatternExport(n,a.id)}};Kt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Kt.parseExportSpecifier=function(n){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(n,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")};Kt.parseExportSpecifiers=function(n){var e=[],t=!0;for(this.expect(re.braceL);!this.eat(re.braceR);){if(t)t=!1;else if(this.expect(re.comma),this.afterTrailingComma(re.braceR))break;e.push(this.parseExportSpecifier(n))}return e};Kt.parseImport=function(n){return this.next(),this.type===re.string?(n.specifiers=nxe,n.source=this.parseExprAtom()):(n.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),n.source=this.type===re.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ImportDeclaration")};Kt.parseImportSpecifier=function(){var n=this.startNode();return n.imported=this.parseModuleExportName(),this.eatContextual("as")?n.local=this.parseIdent():(this.checkUnreserved(n.imported),n.local=n.imported),this.checkLValSimple(n.local,Zc),this.finishNode(n,"ImportSpecifier")};Kt.parseImportDefaultSpecifier=function(){var n=this.startNode();return n.local=this.parseIdent(),this.checkLValSimple(n.local,Zc),this.finishNode(n,"ImportDefaultSpecifier")};Kt.parseImportNamespaceSpecifier=function(){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLValSimple(n.local,Zc),this.finishNode(n,"ImportNamespaceSpecifier")};Kt.parseImportSpecifiers=function(){var n=[],e=!0;if(this.type===re.name&&(n.push(this.parseImportDefaultSpecifier()),!this.eat(re.comma)))return n;if(this.type===re.star)return n.push(this.parseImportNamespaceSpecifier()),n;for(this.expect(re.braceL);!this.eat(re.braceR);){if(e)e=!1;else if(this.expect(re.comma),this.afterTrailingComma(re.braceR))break;n.push(this.parseImportSpecifier())}return n};Kt.parseWithClause=function(){var n=[];if(!this.eat(re._with))return n;this.expect(re.braceL);for(var e={},t=!0;!this.eat(re.braceR);){if(t)t=!1;else if(this.expect(re.comma),this.afterTrailingComma(re.braceR))break;var s=this.parseImportAttribute(),a=s.key.type==="Identifier"?s.key.name:s.key.value;Ym(e,a)&&this.raiseRecoverable(s.key.start,"Duplicate attribute key '"+a+"'"),e[a]=!0,n.push(s)}return n};Kt.parseImportAttribute=function(){var n=this.startNode();return n.key=this.type===re.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(re.colon),this.type!==re.string&&this.unexpected(),n.value=this.parseExprAtom(),this.finishNode(n,"ImportAttribute")};Kt.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===re.string){var n=this.parseLiteral(this.value);return YOe.test(n.value)&&this.raise(n.start,"An export name cannot include a lone surrogate."),n}return this.parseIdent(!0)};Kt.adaptDirectivePrologue=function(n){for(var e=0;e<n.length&&this.isDirectiveCandidate(n[e]);++e)n[e].directive=n[e].expression.raw.slice(1,-1)};Kt.isDirectiveCandidate=function(n){return this.options.ecmaVersion>=5&&n.type==="ExpressionStatement"&&n.expression.type==="Literal"&&typeof n.expression.value=="string"&&(this.input[n.start]==='"'||this.input[n.start]==="'")};var Ci=Ta.prototype;Ci.toAssignable=function(n,e,t){if(this.options.ecmaVersion>=6&&n)switch(n.type){case"Identifier":this.inAsync&&n.name==="await"&&this.raise(n.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":n.type="ObjectPattern",t&&this.checkPatternErrors(t,!0);for(var s=0,a=n.properties;s<a.length;s+=1){var r=a[s];this.toAssignable(r,e),r.type==="RestElement"&&(r.argument.type==="ArrayPattern"||r.argument.type==="ObjectPattern")&&this.raise(r.argument.start,"Unexpected token")}break;case"Property":n.kind!=="init"&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,e);break;case"ArrayExpression":n.type="ArrayPattern",t&&this.checkPatternErrors(t,!0),this.toAssignableList(n.elements,e);break;case"SpreadElement":n.type="RestElement",this.toAssignable(n.argument,e),n.argument.type==="AssignmentPattern"&&this.raise(n.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":n.operator!=="="&&this.raise(n.left.end,"Only '=' operator can be used for specifying default value."),n.type="AssignmentPattern",delete n.operator,this.toAssignable(n.left,e);break;case"ParenthesizedExpression":this.toAssignable(n.expression,e,t);break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(n.start,"Assigning to rvalue")}else t&&this.checkPatternErrors(t,!0);return n};Ci.toAssignableList=function(n,e){for(var t=n.length,s=0;s<t;s++){var a=n[s];a&&this.toAssignable(a,e)}if(t){var r=n[t-1];this.options.ecmaVersion===6&&e&&r&&r.type==="RestElement"&&r.argument.type!=="Identifier"&&this.unexpected(r.argument.start)}return n};Ci.parseSpread=function(n){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,n),this.finishNode(e,"SpreadElement")};Ci.parseRestBinding=function(){var n=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==re.name&&this.unexpected(),n.argument=this.parseBindingAtom(),this.finishNode(n,"RestElement")};Ci.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case re.bracketL:var n=this.startNode();return this.next(),n.elements=this.parseBindingList(re.bracketR,!0,!0),this.finishNode(n,"ArrayPattern");case re.braceL:return this.parseObj(!0)}return this.parseIdent()};Ci.parseBindingList=function(n,e,t,s){for(var a=[],r=!0;!this.eat(n);)if(r?r=!1:this.expect(re.comma),e&&this.type===re.comma)a.push(null);else{if(t&&this.afterTrailingComma(n))break;if(this.type===re.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),a.push(o),this.type===re.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(n);break}else a.push(this.parseAssignableListItem(s))}return a};Ci.parseAssignableListItem=function(n){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e};Ci.parseBindingListItem=function(n){return n};Ci.parseMaybeDefault=function(n,e,t){if(t=t||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(re.eq))return t;var s=this.startNodeAt(n,e);return s.left=t,s.right=this.parseMaybeAssign(),this.finishNode(s,"AssignmentPattern")};Ci.checkLValSimple=function(n,e,t){e===void 0&&(e=Ay);var s=e!==Ay;switch(n.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(n.name)&&this.raiseRecoverable(n.start,(s?"Binding ":"Assigning to ")+n.name+" in strict mode"),s&&(e===Zc&&n.name==="let"&&this.raiseRecoverable(n.start,"let is disallowed as a lexically bound name"),t&&(Ym(t,n.name)&&this.raiseRecoverable(n.start,"Argument name clash"),t[n.name]=!0),e!==JG&&this.declareName(n.name,e,n.start));break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":s&&this.raiseRecoverable(n.start,"Binding member expression");break;case"ParenthesizedExpression":return s&&this.raiseRecoverable(n.start,"Binding parenthesized expression"),this.checkLValSimple(n.expression,e,t);default:this.raise(n.start,(s?"Binding":"Assigning to")+" rvalue")}};Ci.checkLValPattern=function(n,e,t){switch(e===void 0&&(e=Ay),n.type){case"ObjectPattern":for(var s=0,a=n.properties;s<a.length;s+=1){var r=a[s];this.checkLValInnerPattern(r,e,t)}break;case"ArrayPattern":for(var o=0,i=n.elements;o<i.length;o+=1){var l=i[o];l&&this.checkLValInnerPattern(l,e,t)}break;default:this.checkLValSimple(n,e,t)}};Ci.checkLValInnerPattern=function(n,e,t){switch(e===void 0&&(e=Ay),n.type){case"Property":this.checkLValInnerPattern(n.value,e,t);break;case"AssignmentPattern":this.checkLValPattern(n.left,e,t);break;case"RestElement":this.checkLValPattern(n.argument,e,t);break;default:this.checkLValPattern(n,e,t)}};var $i=function(n,e,t,s,a){this.token=n,this.isExpr=!!e,this.preserveSpace=!!t,this.override=s,this.generator=!!a},Us={b_stat:new $i("{",!1),b_expr:new $i("{",!0),b_tmpl:new $i("${",!1),p_stat:new $i("(",!1),p_expr:new $i("(",!0),q_tmpl:new $i("`",!0,!0,function(n){return n.tryReadTemplateToken()}),f_stat:new $i("function",!1),f_expr:new $i("function",!0),f_expr_gen:new $i("function",!0,!1,null,!0),f_gen:new $i("function",!1,!1,null,!0)},Jm=Ta.prototype;Jm.initialContext=function(){return[Us.b_stat]};Jm.curContext=function(){return this.context[this.context.length-1]};Jm.braceIsBlock=function(n){var e=this.curContext();return e===Us.f_expr||e===Us.f_stat?!0:n===re.colon&&(e===Us.b_stat||e===Us.b_expr)?!e.isExpr:n===re._return||n===re.name&&this.exprAllowed?Si.test(this.input.slice(this.lastTokEnd,this.start)):n===re._else||n===re.semi||n===re.eof||n===re.parenR||n===re.arrow?!0:n===re.braceL?e===Us.b_stat:n===re._var||n===re._const||n===re.name?!1:!this.exprAllowed};Jm.inGeneratorContext=function(){for(var n=this.context.length-1;n>=1;n--){var e=this.context[n];if(e.token==="function")return e.generator}return!1};Jm.updateContext=function(n){var e,t=this.type;t.keyword&&n===re.dot?this.exprAllowed=!1:(e=t.updateContext)?e.call(this,n):this.exprAllowed=t.beforeExpr};Jm.overrideContext=function(n){this.curContext()!==n&&(this.context[this.context.length-1]=n)};re.parenR.updateContext=re.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var n=this.context.pop();n===Us.b_stat&&this.curContext().token==="function"&&(n=this.context.pop()),this.exprAllowed=!n.isExpr};re.braceL.updateContext=function(n){this.context.push(this.braceIsBlock(n)?Us.b_stat:Us.b_expr),this.exprAllowed=!0};re.dollarBraceL.updateContext=function(){this.context.push(Us.b_tmpl),this.exprAllowed=!0};re.parenL.updateContext=function(n){var e=n===re._if||n===re._for||n===re._with||n===re._while;this.context.push(e?Us.p_stat:Us.p_expr),this.exprAllowed=!0};re.incDec.updateContext=function(){};re._function.updateContext=re._class.updateContext=function(n){n.beforeExpr&&n!==re._else&&!(n===re.semi&&this.curContext()!==Us.p_stat)&&!(n===re._return&&Si.test(this.input.slice(this.lastTokEnd,this.start)))&&!((n===re.colon||n===re.braceL)&&this.curContext()===Us.b_stat)?this.context.push(Us.f_expr):this.context.push(Us.f_stat),this.exprAllowed=!1};re.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};re.backQuote.updateContext=function(){this.curContext()===Us.q_tmpl?this.context.pop():this.context.push(Us.q_tmpl),this.exprAllowed=!1};re.star.updateContext=function(n){if(n===re._function){var e=this.context.length-1;this.context[e]===Us.f_expr?this.context[e]=Us.f_expr_gen:this.context[e]=Us.f_gen}this.exprAllowed=!0};re.name.updateContext=function(n){var e=!1;this.options.ecmaVersion>=6&&n!==re.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var wn=Ta.prototype;wn.checkPropClash=function(n,e,t){if(!(this.options.ecmaVersion>=9&&n.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(n.computed||n.method||n.shorthand))){var s=n.key,a;switch(s.type){case"Identifier":a=s.name;break;case"Literal":a=String(s.value);break;default:return}var r=n.kind;if(this.options.ecmaVersion>=6){a==="__proto__"&&r==="init"&&(e.proto&&(t?t.doubleProto<0&&(t.doubleProto=s.start):this.raiseRecoverable(s.start,"Redefinition of __proto__ property")),e.proto=!0);return}a="$"+a;var o=e[a];if(o){var i;r==="init"?i=this.strict&&o.init||o.get||o.set:i=o.init||o[r],i&&this.raiseRecoverable(s.start,"Redefinition of property")}else o=e[a]={init:!1,get:!1,set:!1};o[r]=!0}};wn.parseExpression=function(n,e){var t=this.start,s=this.startLoc,a=this.parseMaybeAssign(n,e);if(this.type===re.comma){var r=this.startNodeAt(t,s);for(r.expressions=[a];this.eat(re.comma);)r.expressions.push(this.parseMaybeAssign(n,e));return this.finishNode(r,"SequenceExpression")}return a};wn.parseMaybeAssign=function(n,e,t){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(n);this.exprAllowed=!1}var s=!1,a=-1,r=-1,o=-1;e?(a=e.parenthesizedAssign,r=e.trailingComma,o=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new Pw,s=!0);var i=this.start,l=this.startLoc;(this.type===re.parenL||this.type===re.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=n==="await");var c=this.parseMaybeConditional(n,e);if(t&&(c=t.call(this,c,i,l)),this.type.isAssign){var u=this.startNodeAt(i,l);return u.operator=this.value,this.type===re.eq&&(c=this.toAssignable(c,!1,e)),s||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=c.start&&(e.shorthandAssign=-1),this.type===re.eq?this.checkLValPattern(c):this.checkLValSimple(c),u.left=c,this.next(),u.right=this.parseMaybeAssign(n),o>-1&&(e.doubleProto=o),this.finishNode(u,"AssignmentExpression")}else s&&this.checkExpressionErrors(e,!0);return a>-1&&(e.parenthesizedAssign=a),r>-1&&(e.trailingComma=r),c};wn.parseMaybeConditional=function(n,e){var t=this.start,s=this.startLoc,a=this.parseExprOps(n,e);if(this.checkExpressionErrors(e))return a;if(this.eat(re.question)){var r=this.startNodeAt(t,s);return r.test=a,r.consequent=this.parseMaybeAssign(),this.expect(re.colon),r.alternate=this.parseMaybeAssign(n),this.finishNode(r,"ConditionalExpression")}return a};wn.parseExprOps=function(n,e){var t=this.start,s=this.startLoc,a=this.parseMaybeUnary(e,!1,!1,n);return this.checkExpressionErrors(e)||a.start===t&&a.type==="ArrowFunctionExpression"?a:this.parseExprOp(a,t,s,-1,n)};wn.parseExprOp=function(n,e,t,s,a){var r=this.type.binop;if(r!=null&&(!a||this.type!==re._in)&&r>s){var o=this.type===re.logicalOR||this.type===re.logicalAND,i=this.type===re.coalesce;i&&(r=re.logicalAND.binop);var l=this.value;this.next();var c=this.start,u=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,a),c,u,r,a),m=this.buildBinary(e,t,n,h,l,o||i);return(o&&this.type===re.coalesce||i&&(this.type===re.logicalOR||this.type===re.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(m,e,t,s,a)}return n};wn.buildBinary=function(n,e,t,s,a,r){s.type==="PrivateIdentifier"&&this.raise(s.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(n,e);return o.left=t,o.operator=a,o.right=s,this.finishNode(o,r?"LogicalExpression":"BinaryExpression")};wn.parseMaybeUnary=function(n,e,t,s){var a=this.start,r=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(s),e=!0;else if(this.type.prefix){var i=this.startNode(),l=this.type===re.incDec;i.operator=this.value,i.prefix=!0,this.next(),i.argument=this.parseMaybeUnary(null,!0,l,s),this.checkExpressionErrors(n,!0),l?this.checkLValSimple(i.argument):this.strict&&i.operator==="delete"&&tX(i.argument)?this.raiseRecoverable(i.start,"Deleting local variable in strict mode"):i.operator==="delete"&&nS(i.argument)?this.raiseRecoverable(i.start,"Private fields can not be deleted"):e=!0,o=this.finishNode(i,l?"UpdateExpression":"UnaryExpression")}else if(!e&&this.type===re.privateId)(s||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==re._in&&this.unexpected();else{if(o=this.parseExprSubscripts(n,s),this.checkExpressionErrors(n))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(a,r);c.operator=this.value,c.prefix=!1,c.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(c,"UpdateExpression")}}if(!t&&this.eat(re.starstar))if(e)this.unexpected(this.lastTokStart);else return this.buildBinary(a,r,o,this.parseMaybeUnary(null,!1,!1,s),"**",!1);else return o};function tX(n){return n.type==="Identifier"||n.type==="ParenthesizedExpression"&&tX(n.expression)}function nS(n){return n.type==="MemberExpression"&&n.property.type==="PrivateIdentifier"||n.type==="ChainExpression"&&nS(n.expression)||n.type==="ParenthesizedExpression"&&nS(n.expression)}wn.parseExprSubscripts=function(n,e){var t=this.start,s=this.startLoc,a=this.parseExprAtom(n,e);if(a.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return a;var r=this.parseSubscripts(a,t,s,!1,e);return n&&r.type==="MemberExpression"&&(n.parenthesizedAssign>=r.start&&(n.parenthesizedAssign=-1),n.parenthesizedBind>=r.start&&(n.parenthesizedBind=-1),n.trailingComma>=r.start&&(n.trailingComma=-1)),r};wn.parseSubscripts=function(n,e,t,s,a){for(var r=this.options.ecmaVersion>=8&&n.type==="Identifier"&&n.name==="async"&&this.lastTokEnd===n.end&&!this.canInsertSemicolon()&&n.end-n.start===5&&this.potentialArrowAt===n.start,o=!1;;){var i=this.parseSubscript(n,e,t,s,r,o,a);if(i.optional&&(o=!0),i===n||i.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(e,t);l.expression=i,i=this.finishNode(l,"ChainExpression")}return i}n=i}};wn.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(re.arrow)};wn.parseSubscriptAsyncArrow=function(n,e,t,s){return this.parseArrowExpression(this.startNodeAt(n,e),t,!0,s)};wn.parseSubscript=function(n,e,t,s,a,r,o){var i=this.options.ecmaVersion>=11,l=i&&this.eat(re.questionDot);s&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(re.bracketL);if(c||l&&this.type!==re.parenL&&this.type!==re.backQuote||this.eat(re.dot)){var u=this.startNodeAt(e,t);u.object=n,c?(u.property=this.parseExpression(),this.expect(re.bracketR)):this.type===re.privateId&&n.type!=="Super"?u.property=this.parsePrivateIdent():u.property=this.parseIdent(this.options.allowReserved!=="never"),u.computed=!!c,i&&(u.optional=l),n=this.finishNode(u,"MemberExpression")}else if(!s&&this.eat(re.parenL)){var h=new Pw,m=this.yieldPos,f=this.awaitPos,v=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var O=this.parseExprList(re.parenR,this.options.ecmaVersion>=8,!1,h);if(a&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=m,this.awaitPos=f,this.awaitIdentPos=v,this.parseSubscriptAsyncArrow(e,t,O,o);this.checkExpressionErrors(h,!0),this.yieldPos=m||this.yieldPos,this.awaitPos=f||this.awaitPos,this.awaitIdentPos=v||this.awaitIdentPos;var k=this.startNodeAt(e,t);k.callee=n,k.arguments=O,i&&(k.optional=l),n=this.finishNode(k,"CallExpression")}else if(this.type===re.backQuote){(l||r)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var M=this.startNodeAt(e,t);M.tag=n,M.quasi=this.parseTemplate({isTagged:!0}),n=this.finishNode(M,"TaggedTemplateExpression")}return n};wn.parseExprAtom=function(n,e,t){this.type===re.slash&&this.readRegexp();var s,a=this.potentialArrowAt===this.start;switch(this.type){case re._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),s=this.startNode(),this.next(),this.type===re.parenL&&!this.allowDirectSuper&&this.raise(s.start,"super() call outside constructor of a subclass"),this.type!==re.dot&&this.type!==re.bracketL&&this.type!==re.parenL&&this.unexpected(),this.finishNode(s,"Super");case re._this:return s=this.startNode(),this.next(),this.finishNode(s,"ThisExpression");case re.name:var r=this.start,o=this.startLoc,i=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!i&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(re._function))return this.overrideContext(Us.f_expr),this.parseFunction(this.startNodeAt(r,o),0,!1,!0,e);if(a&&!this.canInsertSemicolon()){if(this.eat(re.arrow))return this.parseArrowExpression(this.startNodeAt(r,o),[l],!1,e);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===re.name&&!i&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(re.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,o),[l],!0,e)}return l;case re.regexp:var c=this.value;return s=this.parseLiteral(c.value),s.regex={pattern:c.pattern,flags:c.flags},s;case re.num:case re.string:return this.parseLiteral(this.value);case re._null:case re._true:case re._false:return s=this.startNode(),s.value=this.type===re._null?null:this.type===re._true,s.raw=this.type.keyword,this.next(),this.finishNode(s,"Literal");case re.parenL:var u=this.start,h=this.parseParenAndDistinguishExpression(a,e);return n&&(n.parenthesizedAssign<0&&!this.isSimpleAssignTarget(h)&&(n.parenthesizedAssign=u),n.parenthesizedBind<0&&(n.parenthesizedBind=u)),h;case re.bracketL:return s=this.startNode(),this.next(),s.elements=this.parseExprList(re.bracketR,!0,!0,n),this.finishNode(s,"ArrayExpression");case re.braceL:return this.overrideContext(Us.b_expr),this.parseObj(!1,n);case re._function:return s=this.startNode(),this.next(),this.parseFunction(s,0);case re._class:return this.parseClass(this.startNode(),!1);case re._new:return this.parseNew();case re.backQuote:return this.parseTemplate();case re._import:return this.options.ecmaVersion>=11?this.parseExprImport(t):this.unexpected();default:return this.parseExprAtomDefault()}};wn.parseExprAtomDefault=function(){this.unexpected()};wn.parseExprImport=function(n){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===re.parenL&&!n)return this.parseDynamicImport(e);if(this.type===re.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);return t.name="import",e.meta=this.finishNode(t,"Identifier"),this.parseImportMeta(e)}else this.unexpected()};wn.parseDynamicImport=function(n){if(this.next(),n.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(re.parenR)?n.options=null:(this.expect(re.comma),this.afterTrailingComma(re.parenR)?n.options=null:(n.options=this.parseMaybeAssign(),this.eat(re.parenR)||(this.expect(re.comma),this.afterTrailingComma(re.parenR)||this.unexpected())));else if(!this.eat(re.parenR)){var e=this.start;this.eat(re.comma)&&this.eat(re.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(n,"ImportExpression")};wn.parseImportMeta=function(n){this.next();var e=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="meta"&&this.raiseRecoverable(n.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(n.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(n.start,"Cannot use 'import.meta' outside a module"),this.finishNode(n,"MetaProperty")};wn.parseLiteral=function(n){var e=this.startNode();return e.value=n,e.raw=this.input.slice(this.start,this.end),e.raw.charCodeAt(e.raw.length-1)===110&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")};wn.parseParenExpression=function(){this.expect(re.parenL);var n=this.parseExpression();return this.expect(re.parenR),n};wn.shouldParseArrow=function(n){return!this.canInsertSemicolon()};wn.parseParenAndDistinguishExpression=function(n,e){var t=this.start,s=this.startLoc,a,r=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,i=this.startLoc,l=[],c=!0,u=!1,h=new Pw,m=this.yieldPos,f=this.awaitPos,v;for(this.yieldPos=0,this.awaitPos=0;this.type!==re.parenR;)if(c?c=!1:this.expect(re.comma),r&&this.afterTrailingComma(re.parenR,!0)){u=!0;break}else if(this.type===re.ellipsis){v=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===re.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,h,this.parseParenItem));var O=this.lastTokEnd,k=this.lastTokEndLoc;if(this.expect(re.parenR),n&&this.shouldParseArrow(l)&&this.eat(re.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=m,this.awaitPos=f,this.parseParenArrowList(t,s,l,e);(!l.length||u)&&this.unexpected(this.lastTokStart),v&&this.unexpected(v),this.checkExpressionErrors(h,!0),this.yieldPos=m||this.yieldPos,this.awaitPos=f||this.awaitPos,l.length>1?(a=this.startNodeAt(o,i),a.expressions=l,this.finishNodeAt(a,"SequenceExpression",O,k)):a=l[0]}else a=this.parseParenExpression();if(this.options.preserveParens){var M=this.startNodeAt(t,s);return M.expression=a,this.finishNode(M,"ParenthesizedExpression")}else return a};wn.parseParenItem=function(n){return n};wn.parseParenArrowList=function(n,e,t,s){return this.parseArrowExpression(this.startNodeAt(n,e),t,!1,s)};var axe=[];wn.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var n=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===re.dot){var e=this.startNodeAt(n.start,n.loc&&n.loc.start);e.name="new",n.meta=this.finishNode(e,"Identifier"),this.next();var t=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="target"&&this.raiseRecoverable(n.property.start,"The only valid meta property for new is 'new.target'"),t&&this.raiseRecoverable(n.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(n.start,"'new.target' can only be used in functions and class static block"),this.finishNode(n,"MetaProperty")}var s=this.start,a=this.startLoc;return n.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),s,a,!0,!1),this.eat(re.parenL)?n.arguments=this.parseExprList(re.parenR,this.options.ecmaVersion>=8,!1):n.arguments=axe,this.finishNode(n,"NewExpression")};wn.parseTemplateElement=function(n){var e=n.isTagged,t=this.startNode();return this.type===re.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),t.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),t.tail=this.type===re.backQuote,this.finishNode(t,"TemplateElement")};wn.parseTemplate=function(n){n===void 0&&(n={});var e=n.isTagged;e===void 0&&(e=!1);var t=this.startNode();this.next(),t.expressions=[];var s=this.parseTemplateElement({isTagged:e});for(t.quasis=[s];!s.tail;)this.type===re.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(re.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(re.braceR),t.quasis.push(s=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(t,"TemplateLiteral")};wn.isAsyncProp=function(n){return!n.computed&&n.key.type==="Identifier"&&n.key.name==="async"&&(this.type===re.name||this.type===re.num||this.type===re.string||this.type===re.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===re.star)&&!Si.test(this.input.slice(this.lastTokEnd,this.start))};wn.parseObj=function(n,e){var t=this.startNode(),s=!0,a={};for(t.properties=[],this.next();!this.eat(re.braceR);){if(s)s=!1;else if(this.expect(re.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(re.braceR))break;var r=this.parseProperty(n,e);n||this.checkPropClash(r,a,e),t.properties.push(r)}return this.finishNode(t,n?"ObjectPattern":"ObjectExpression")};wn.parseProperty=function(n,e){var t=this.startNode(),s,a,r,o;if(this.options.ecmaVersion>=9&&this.eat(re.ellipsis))return n?(t.argument=this.parseIdent(!1),this.type===re.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(t,"RestElement")):(t.argument=this.parseMaybeAssign(!1,e),this.type===re.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(t,"SpreadElement"));this.options.ecmaVersion>=6&&(t.method=!1,t.shorthand=!1,(n||e)&&(r=this.start,o=this.startLoc),n||(s=this.eat(re.star)));var i=this.containsEsc;return this.parsePropertyName(t),!n&&!i&&this.options.ecmaVersion>=8&&!s&&this.isAsyncProp(t)?(a=!0,s=this.options.ecmaVersion>=9&&this.eat(re.star),this.parsePropertyName(t)):a=!1,this.parsePropertyValue(t,n,s,a,r,o,e,i),this.finishNode(t,"Property")};wn.parseGetterSetter=function(n){n.kind=n.key.name,this.parsePropertyName(n),n.value=this.parseMethod(!1);var e=n.kind==="get"?0:1;if(n.value.params.length!==e){var t=n.value.start;n.kind==="get"?this.raiseRecoverable(t,"getter should have no params"):this.raiseRecoverable(t,"setter should have exactly one param")}else n.kind==="set"&&n.value.params[0].type==="RestElement"&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params")};wn.parsePropertyValue=function(n,e,t,s,a,r,o,i){(t||s)&&this.type===re.colon&&this.unexpected(),this.eat(re.colon)?(n.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),n.kind="init"):this.options.ecmaVersion>=6&&this.type===re.parenL?(e&&this.unexpected(),n.kind="init",n.method=!0,n.value=this.parseMethod(t,s)):!e&&!i&&this.options.ecmaVersion>=5&&!n.computed&&n.key.type==="Identifier"&&(n.key.name==="get"||n.key.name==="set")&&this.type!==re.comma&&this.type!==re.braceR&&this.type!==re.eq?((t||s)&&this.unexpected(),this.parseGetterSetter(n)):this.options.ecmaVersion>=6&&!n.computed&&n.key.type==="Identifier"?((t||s)&&this.unexpected(),this.checkUnreserved(n.key),n.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=a),n.kind="init",e?n.value=this.parseMaybeDefault(a,r,this.copyNode(n.key)):this.type===re.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),n.value=this.parseMaybeDefault(a,r,this.copyNode(n.key))):n.value=this.copyNode(n.key),n.shorthand=!0):this.unexpected()};wn.parsePropertyName=function(n){if(this.options.ecmaVersion>=6){if(this.eat(re.bracketL))return n.computed=!0,n.key=this.parseMaybeAssign(),this.expect(re.bracketR),n.key;n.computed=!1}return n.key=this.type===re.num||this.type===re.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};wn.initFunction=function(n){n.id=null,this.options.ecmaVersion>=6&&(n.generator=n.expression=!1),this.options.ecmaVersion>=8&&(n.async=!1)};wn.parseMethod=function(n,e,t){var s=this.startNode(),a=this.yieldPos,r=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=n),this.options.ecmaVersion>=8&&(s.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(JA(e,s.generator)|YA|(t?HG:0)),this.expect(re.parenL),s.params=this.parseBindingList(re.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(s,!1,!0,!1),this.yieldPos=a,this.awaitPos=r,this.awaitIdentPos=o,this.finishNode(s,"FunctionExpression")};wn.parseArrowExpression=function(n,e,t,s){var a=this.yieldPos,r=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(JA(t,!1)|qG),this.initFunction(n),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,n.params=this.toAssignableList(e,!0),this.parseFunctionBody(n,!0,!1,s),this.yieldPos=a,this.awaitPos=r,this.awaitIdentPos=o,this.finishNode(n,"ArrowFunctionExpression")};wn.parseFunctionBody=function(n,e,t,s){var a=e&&this.type!==re.braceL,r=this.strict,o=!1;if(a)n.body=this.parseMaybeAssign(s),n.expression=!0,this.checkParams(n,!1);else{var i=this.options.ecmaVersion>=7&&!this.isSimpleParamList(n.params);(!r||i)&&(o=this.strictDirective(this.end),o&&i&&this.raiseRecoverable(n.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(n,!r&&!o&&!e&&!t&&this.isSimpleParamList(n.params)),this.strict&&n.id&&this.checkLValSimple(n.id,JG),n.body=this.parseBlock(!1,void 0,o&&!r),n.expression=!1,this.adaptDirectivePrologue(n.body.body),this.labels=l}this.exitScope()};wn.isSimpleParamList=function(n){for(var e=0,t=n;e<t.length;e+=1){var s=t[e];if(s.type!=="Identifier")return!1}return!0};wn.checkParams=function(n,e){for(var t=Object.create(null),s=0,a=n.params;s<a.length;s+=1){var r=a[s];this.checkLValInnerPattern(r,e3,e?null:t)}};wn.parseExprList=function(n,e,t,s){for(var a=[],r=!0;!this.eat(n);){if(r)r=!1;else if(this.expect(re.comma),e&&this.afterTrailingComma(n))break;var o=void 0;t&&this.type===re.comma?o=null:this.type===re.ellipsis?(o=this.parseSpread(s),s&&this.type===re.comma&&s.trailingComma<0&&(s.trailingComma=this.start)):o=this.parseMaybeAssign(!1,s),a.push(o)}return a};wn.checkUnreserved=function(n){var e=n.start,t=n.end,s=n.name;if(this.inGenerator&&s==="yield"&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&s==="arguments"&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(s==="arguments"||s==="await")&&this.raise(e,"Cannot use "+s+" in class static initialization block"),this.keywords.test(s)&&this.raise(e,"Unexpected keyword '"+s+"'"),!(this.options.ecmaVersion<6&&this.input.slice(e,t).indexOf("\\")!==-1)){var a=this.strict?this.reservedWordsStrict:this.reservedWords;a.test(s)&&(!this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+s+"' is reserved"))}};wn.parseIdent=function(n){var e=this.parseIdentNode();return this.next(!!n),this.finishNode(e,"Identifier"),n||(this.checkUnreserved(e),e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=e.start)),e};wn.parseIdentNode=function(){var n=this.startNode();return this.type===re.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,(n.name==="class"||n.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=re.name):this.unexpected(),n};wn.parsePrivateIdent=function(){var n=this.startNode();return this.type===re.privateId?n.name=this.value:this.unexpected(),this.next(),this.finishNode(n,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(n.start,"Private field '#"+n.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(n)),n};wn.parseYield=function(n){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===re.semi||this.canInsertSemicolon()||this.type!==re.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(re.star),e.argument=this.parseMaybeAssign(n)),this.finishNode(e,"YieldExpression")};wn.parseAwait=function(n){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,n),this.finishNode(e,"AwaitExpression")};var Dy=Ta.prototype;Dy.raise=function(n,e){var t=XG(this.input,n);e+=" ("+t.line+":"+t.column+")";var s=new SyntaxError(e);throw s.pos=n,s.loc=t,s.raisedAt=this.pos,s};Dy.raiseRecoverable=Dy.raise;Dy.curPosition=function(){if(this.options.locations)return new ig(this.curLine,this.pos-this.lineStart)};var Gu=Ta.prototype,rxe=function(n){this.flags=n,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};Gu.enterScope=function(n){this.scopeStack.push(new rxe(n))};Gu.exitScope=function(){this.scopeStack.pop()};Gu.treatFunctionsAsVarInScope=function(n){return n.flags&Km||!this.inModule&&n.flags&lg};Gu.declareName=function(n,e,t){var s=!1;if(e===Zc){var a=this.currentScope();s=a.lexical.indexOf(n)>-1||a.functions.indexOf(n)>-1||a.var.indexOf(n)>-1,a.lexical.push(n),this.inModule&&a.flags&lg&&delete this.undefinedExports[n]}else if(e===KG){var r=this.currentScope();r.lexical.push(n)}else if(e===YG){var o=this.currentScope();this.treatFunctionsAsVar?s=o.lexical.indexOf(n)>-1:s=o.lexical.indexOf(n)>-1||o.var.indexOf(n)>-1,o.functions.push(n)}else for(var i=this.scopeStack.length-1;i>=0;--i){var l=this.scopeStack[i];if(l.lexical.indexOf(n)>-1&&!(l.flags&UG&&l.lexical[0]===n)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(n)>-1){s=!0;break}if(l.var.push(n),this.inModule&&l.flags&lg&&delete this.undefinedExports[n],l.flags&KA)break}s&&this.raiseRecoverable(t,"Identifier '"+n+"' has already been declared")};Gu.checkLocalExport=function(n){this.scopeStack[0].lexical.indexOf(n.name)===-1&&this.scopeStack[0].var.indexOf(n.name)===-1&&(this.undefinedExports[n.name]=n)};Gu.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Gu.currentVarScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&KA)return e}};Gu.currentThisScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&KA&&!(e.flags&qG))return e}};var Sw=function(n,e,t){this.type="",this.start=e,this.end=0,n.options.locations&&(this.loc=new kw(n,t)),n.options.directSourceFile&&(this.sourceFile=n.options.directSourceFile),n.options.ranges&&(this.range=[e,0])},Kg=Ta.prototype;Kg.startNode=function(){return new Sw(this,this.start,this.startLoc)};Kg.startNodeAt=function(n,e){return new Sw(this,n,e)};function nX(n,e,t,s){return n.type=e,n.end=t,this.options.locations&&(n.loc.end=s),this.options.ranges&&(n.range[1]=t),n}Kg.finishNode=function(n,e){return nX.call(this,n,e,this.lastTokEnd,this.lastTokEndLoc)};Kg.finishNodeAt=function(n,e,t,s){return nX.call(this,n,e,t,s)};Kg.copyNode=function(n){var e=new Sw(this,n.start,this.startLoc);for(var t in n)e[t]=n[t];return e};var oxe="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",sX="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",aX=sX+" Extended_Pictographic",rX=aX,oX=rX+" EBase EComp EMod EPres ExtPict",iX=oX,ixe=iX,lxe={9:sX,10:aX,11:rX,12:oX,13:iX,14:ixe},cxe="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",uxe={9:"",10:"",11:"",12:"",13:"",14:cxe},V9="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",lX="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",cX=lX+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",uX=cX+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",hX=uX+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",dX=hX+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",hxe=dX+" "+oxe,dxe={9:lX,10:cX,11:uX,12:hX,13:dX,14:hxe},mX={};function mxe(n){var e=mX[n]={binary:cu(lxe[n]+" "+V9),binaryOfStrings:cu(uxe[n]),nonBinary:{General_Category:cu(V9),Script:cu(dxe[n])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(var jx=0,j9=[9,10,11,12,13,14];jx<j9.length;jx+=1){var pxe=j9[jx];mxe(pxe)}var Wt=Ta.prototype,Ty=function(n,e){this.parent=n,this.base=e||this};Ty.prototype.separatedFrom=function(n){for(var e=this;e;e=e.parent)for(var t=n;t;t=t.parent)if(e.base===t.base&&e!==t)return!0;return!1};Ty.prototype.sibling=function(){return new Ty(this.parent,this.base)};var sc=function(n){this.parser=n,this.validFlags="gim"+(n.options.ecmaVersion>=6?"uy":"")+(n.options.ecmaVersion>=9?"s":"")+(n.options.ecmaVersion>=13?"d":"")+(n.options.ecmaVersion>=15?"v":""),this.unicodeProperties=mX[n.options.ecmaVersion>=14?14:n.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};sc.prototype.reset=function(n,e,t){var s=t.indexOf("v")!==-1,a=t.indexOf("u")!==-1;this.start=n|0,this.source=e+"",this.flags=t,s&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=a&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=a&&this.parser.options.ecmaVersion>=9)};sc.prototype.raise=function(n){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+n)};sc.prototype.at=function(n,e){e===void 0&&(e=!1);var t=this.source,s=t.length;if(n>=s)return-1;var a=t.charCodeAt(n);if(!(e||this.switchU)||a<=55295||a>=57344||n+1>=s)return a;var r=t.charCodeAt(n+1);return r>=56320&&r<=57343?(a<<10)+r-56613888:a};sc.prototype.nextIndex=function(n,e){e===void 0&&(e=!1);var t=this.source,s=t.length;if(n>=s)return s;var a=t.charCodeAt(n),r;return!(e||this.switchU)||a<=55295||a>=57344||n+1>=s||(r=t.charCodeAt(n+1))<56320||r>57343?n+1:n+2};sc.prototype.current=function(n){return n===void 0&&(n=!1),this.at(this.pos,n)};sc.prototype.lookahead=function(n){return n===void 0&&(n=!1),this.at(this.nextIndex(this.pos,n),n)};sc.prototype.advance=function(n){n===void 0&&(n=!1),this.pos=this.nextIndex(this.pos,n)};sc.prototype.eat=function(n,e){return e===void 0&&(e=!1),this.current(e)===n?(this.advance(e),!0):!1};sc.prototype.eatChars=function(n,e){e===void 0&&(e=!1);for(var t=this.pos,s=0,a=n;s<a.length;s+=1){var r=a[s],o=this.at(t,e);if(o===-1||o!==r)return!1;t=this.nextIndex(t,e)}return this.pos=t,!0};Wt.validateRegExpFlags=function(n){for(var e=n.validFlags,t=n.flags,s=!1,a=!1,r=0;r<t.length;r++){var o=t.charAt(r);e.indexOf(o)===-1&&this.raise(n.start,"Invalid regular expression flag"),t.indexOf(o,r+1)>-1&&this.raise(n.start,"Duplicate regular expression flag"),o==="u"&&(s=!0),o==="v"&&(a=!0)}this.options.ecmaVersion>=15&&s&&a&&this.raise(n.start,"Invalid regular expression flag")};function fxe(n){for(var e in n)return!0;return!1}Wt.validateRegExpPattern=function(n){this.regexp_pattern(n),!n.switchN&&this.options.ecmaVersion>=9&&fxe(n.groupNames)&&(n.switchN=!0,this.regexp_pattern(n))};Wt.regexp_pattern=function(n){n.pos=0,n.lastIntValue=0,n.lastStringValue="",n.lastAssertionIsQuantifiable=!1,n.numCapturingParens=0,n.maxBackReference=0,n.groupNames=Object.create(null),n.backReferenceNames.length=0,n.branchID=null,this.regexp_disjunction(n),n.pos!==n.source.length&&(n.eat(41)&&n.raise("Unmatched ')'"),(n.eat(93)||n.eat(125))&&n.raise("Lone quantifier brackets")),n.maxBackReference>n.numCapturingParens&&n.raise("Invalid escape");for(var e=0,t=n.backReferenceNames;e<t.length;e+=1){var s=t[e];n.groupNames[s]||n.raise("Invalid named capture referenced")}};Wt.regexp_disjunction=function(n){var e=this.options.ecmaVersion>=16;for(e&&(n.branchID=new Ty(n.branchID,null)),this.regexp_alternative(n);n.eat(124);)e&&(n.branchID=n.branchID.sibling()),this.regexp_alternative(n);e&&(n.branchID=n.branchID.parent),this.regexp_eatQuantifier(n,!0)&&n.raise("Nothing to repeat"),n.eat(123)&&n.raise("Lone quantifier brackets")};Wt.regexp_alternative=function(n){for(;n.pos<n.source.length&&this.regexp_eatTerm(n););};Wt.regexp_eatTerm=function(n){return this.regexp_eatAssertion(n)?(n.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(n)&&n.switchU&&n.raise("Invalid quantifier"),!0):(n.switchU?this.regexp_eatAtom(n):this.regexp_eatExtendedAtom(n))?(this.regexp_eatQuantifier(n),!0):!1};Wt.regexp_eatAssertion=function(n){var e=n.pos;if(n.lastAssertionIsQuantifiable=!1,n.eat(94)||n.eat(36))return!0;if(n.eat(92)){if(n.eat(66)||n.eat(98))return!0;n.pos=e}if(n.eat(40)&&n.eat(63)){var t=!1;if(this.options.ecmaVersion>=9&&(t=n.eat(60)),n.eat(61)||n.eat(33))return this.regexp_disjunction(n),n.eat(41)||n.raise("Unterminated group"),n.lastAssertionIsQuantifiable=!t,!0}return n.pos=e,!1};Wt.regexp_eatQuantifier=function(n,e){return e===void 0&&(e=!1),this.regexp_eatQuantifierPrefix(n,e)?(n.eat(63),!0):!1};Wt.regexp_eatQuantifierPrefix=function(n,e){return n.eat(42)||n.eat(43)||n.eat(63)||this.regexp_eatBracedQuantifier(n,e)};Wt.regexp_eatBracedQuantifier=function(n,e){var t=n.pos;if(n.eat(123)){var s=0,a=-1;if(this.regexp_eatDecimalDigits(n)&&(s=n.lastIntValue,n.eat(44)&&this.regexp_eatDecimalDigits(n)&&(a=n.lastIntValue),n.eat(125)))return a!==-1&&a<s&&!e&&n.raise("numbers out of order in {} quantifier"),!0;n.switchU&&!e&&n.raise("Incomplete quantifier"),n.pos=t}return!1};Wt.regexp_eatAtom=function(n){return this.regexp_eatPatternCharacters(n)||n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)};Wt.regexp_eatReverseSolidusAtomEscape=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatAtomEscape(n))return!0;n.pos=e}return!1};Wt.regexp_eatUncapturingGroup=function(n){var e=n.pos;if(n.eat(40)){if(n.eat(63)){if(this.options.ecmaVersion>=16){var t=this.regexp_eatModifiers(n),s=n.eat(45);if(t||s){for(var a=0;a<t.length;a++){var r=t.charAt(a);t.indexOf(r,a+1)>-1&&n.raise("Duplicate regular expression modifiers")}if(s){var o=this.regexp_eatModifiers(n);!t&&!o&&n.current()===58&&n.raise("Invalid regular expression modifiers");for(var i=0;i<o.length;i++){var l=o.charAt(i);(o.indexOf(l,i+1)>-1||t.indexOf(l)>-1)&&n.raise("Duplicate regular expression modifiers")}}}}if(n.eat(58)){if(this.regexp_disjunction(n),n.eat(41))return!0;n.raise("Unterminated group")}}n.pos=e}return!1};Wt.regexp_eatCapturingGroup=function(n){if(n.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(n):n.current()===63&&n.raise("Invalid group"),this.regexp_disjunction(n),n.eat(41))return n.numCapturingParens+=1,!0;n.raise("Unterminated group")}return!1};Wt.regexp_eatModifiers=function(n){for(var e="",t=0;(t=n.current())!==-1&&gxe(t);)e+=$c(t),n.advance();return e};function gxe(n){return n===105||n===109||n===115}Wt.regexp_eatExtendedAtom=function(n){return n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)||this.regexp_eatInvalidBracedQuantifier(n)||this.regexp_eatExtendedPatternCharacter(n)};Wt.regexp_eatInvalidBracedQuantifier=function(n){return this.regexp_eatBracedQuantifier(n,!0)&&n.raise("Nothing to repeat"),!1};Wt.regexp_eatSyntaxCharacter=function(n){var e=n.current();return pX(e)?(n.lastIntValue=e,n.advance(),!0):!1};function pX(n){return n===36||n>=40&&n<=43||n===46||n===63||n>=91&&n<=94||n>=123&&n<=125}Wt.regexp_eatPatternCharacters=function(n){for(var e=n.pos,t=0;(t=n.current())!==-1&&!pX(t);)n.advance();return n.pos!==e};Wt.regexp_eatExtendedPatternCharacter=function(n){var e=n.current();return e!==-1&&e!==36&&!(e>=40&&e<=43)&&e!==46&&e!==63&&e!==91&&e!==94&&e!==124?(n.advance(),!0):!1};Wt.regexp_groupSpecifier=function(n){if(n.eat(63)){this.regexp_eatGroupName(n)||n.raise("Invalid group");var e=this.options.ecmaVersion>=16,t=n.groupNames[n.lastStringValue];if(t)if(e)for(var s=0,a=t;s<a.length;s+=1){var r=a[s];r.separatedFrom(n.branchID)||n.raise("Duplicate capture group name")}else n.raise("Duplicate capture group name");e?(t||(n.groupNames[n.lastStringValue]=[])).push(n.branchID):n.groupNames[n.lastStringValue]=!0}};Wt.regexp_eatGroupName=function(n){if(n.lastStringValue="",n.eat(60)){if(this.regexp_eatRegExpIdentifierName(n)&&n.eat(62))return!0;n.raise("Invalid capture group name")}return!1};Wt.regexp_eatRegExpIdentifierName=function(n){if(n.lastStringValue="",this.regexp_eatRegExpIdentifierStart(n)){for(n.lastStringValue+=$c(n.lastIntValue);this.regexp_eatRegExpIdentifierPart(n);)n.lastStringValue+=$c(n.lastIntValue);return!0}return!1};Wt.regexp_eatRegExpIdentifierStart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,s=n.current(t);return n.advance(t),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(s=n.lastIntValue),bxe(s)?(n.lastIntValue=s,!0):(n.pos=e,!1)};function bxe(n){return Bc(n,!0)||n===36||n===95}Wt.regexp_eatRegExpIdentifierPart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,s=n.current(t);return n.advance(t),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(s=n.lastIntValue),yxe(s)?(n.lastIntValue=s,!0):(n.pos=e,!1)};function yxe(n){return fm(n,!0)||n===36||n===95||n===8204||n===8205}Wt.regexp_eatAtomEscape=function(n){return this.regexp_eatBackReference(n)||this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)||n.switchN&&this.regexp_eatKGroupName(n)?!0:(n.switchU&&(n.current()===99&&n.raise("Invalid unicode escape"),n.raise("Invalid escape")),!1)};Wt.regexp_eatBackReference=function(n){var e=n.pos;if(this.regexp_eatDecimalEscape(n)){var t=n.lastIntValue;if(n.switchU)return t>n.maxBackReference&&(n.maxBackReference=t),!0;if(t<=n.numCapturingParens)return!0;n.pos=e}return!1};Wt.regexp_eatKGroupName=function(n){if(n.eat(107)){if(this.regexp_eatGroupName(n))return n.backReferenceNames.push(n.lastStringValue),!0;n.raise("Invalid named reference")}return!1};Wt.regexp_eatCharacterEscape=function(n){return this.regexp_eatControlEscape(n)||this.regexp_eatCControlLetter(n)||this.regexp_eatZero(n)||this.regexp_eatHexEscapeSequence(n)||this.regexp_eatRegExpUnicodeEscapeSequence(n,!1)||!n.switchU&&this.regexp_eatLegacyOctalEscapeSequence(n)||this.regexp_eatIdentityEscape(n)};Wt.regexp_eatCControlLetter=function(n){var e=n.pos;if(n.eat(99)){if(this.regexp_eatControlLetter(n))return!0;n.pos=e}return!1};Wt.regexp_eatZero=function(n){return n.current()===48&&!Cw(n.lookahead())?(n.lastIntValue=0,n.advance(),!0):!1};Wt.regexp_eatControlEscape=function(n){var e=n.current();return e===116?(n.lastIntValue=9,n.advance(),!0):e===110?(n.lastIntValue=10,n.advance(),!0):e===118?(n.lastIntValue=11,n.advance(),!0):e===102?(n.lastIntValue=12,n.advance(),!0):e===114?(n.lastIntValue=13,n.advance(),!0):!1};Wt.regexp_eatControlLetter=function(n){var e=n.current();return fX(e)?(n.lastIntValue=e%32,n.advance(),!0):!1};function fX(n){return n>=65&&n<=90||n>=97&&n<=122}Wt.regexp_eatRegExpUnicodeEscapeSequence=function(n,e){e===void 0&&(e=!1);var t=n.pos,s=e||n.switchU;if(n.eat(117)){if(this.regexp_eatFixedHexDigits(n,4)){var a=n.lastIntValue;if(s&&a>=55296&&a<=56319){var r=n.pos;if(n.eat(92)&&n.eat(117)&&this.regexp_eatFixedHexDigits(n,4)){var o=n.lastIntValue;if(o>=56320&&o<=57343)return n.lastIntValue=(a-55296)*1024+(o-56320)+65536,!0}n.pos=r,n.lastIntValue=a}return!0}if(s&&n.eat(123)&&this.regexp_eatHexDigits(n)&&n.eat(125)&&vxe(n.lastIntValue))return!0;s&&n.raise("Invalid unicode escape"),n.pos=t}return!1};function vxe(n){return n>=0&&n<=1114111}Wt.regexp_eatIdentityEscape=function(n){if(n.switchU)return this.regexp_eatSyntaxCharacter(n)?!0:n.eat(47)?(n.lastIntValue=47,!0):!1;var e=n.current();return e!==99&&(!n.switchN||e!==107)?(n.lastIntValue=e,n.advance(),!0):!1};Wt.regexp_eatDecimalEscape=function(n){n.lastIntValue=0;var e=n.current();if(e>=49&&e<=57){do n.lastIntValue=10*n.lastIntValue+(e-48),n.advance();while((e=n.current())>=48&&e<=57);return!0}return!1};var gX=0,Rc=1,ri=2;Wt.regexp_eatCharacterClassEscape=function(n){var e=n.current();if(wxe(e))return n.lastIntValue=-1,n.advance(),Rc;var t=!1;if(n.switchU&&this.options.ecmaVersion>=9&&((t=e===80)||e===112)){n.lastIntValue=-1,n.advance();var s;if(n.eat(123)&&(s=this.regexp_eatUnicodePropertyValueExpression(n))&&n.eat(125))return t&&s===ri&&n.raise("Invalid property name"),s;n.raise("Invalid property name")}return gX};function wxe(n){return n===100||n===68||n===115||n===83||n===119||n===87}Wt.regexp_eatUnicodePropertyValueExpression=function(n){var e=n.pos;if(this.regexp_eatUnicodePropertyName(n)&&n.eat(61)){var t=n.lastStringValue;if(this.regexp_eatUnicodePropertyValue(n)){var s=n.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(n,t,s),Rc}}if(n.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(n)){var a=n.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(n,a)}return gX};Wt.regexp_validateUnicodePropertyNameAndValue=function(n,e,t){Ym(n.unicodeProperties.nonBinary,e)||n.raise("Invalid property name"),n.unicodeProperties.nonBinary[e].test(t)||n.raise("Invalid property value")};Wt.regexp_validateUnicodePropertyNameOrValue=function(n,e){if(n.unicodeProperties.binary.test(e))return Rc;if(n.switchV&&n.unicodeProperties.binaryOfStrings.test(e))return ri;n.raise("Invalid property name")};Wt.regexp_eatUnicodePropertyName=function(n){var e=0;for(n.lastStringValue="";bX(e=n.current());)n.lastStringValue+=$c(e),n.advance();return n.lastStringValue!==""};function bX(n){return fX(n)||n===95}Wt.regexp_eatUnicodePropertyValue=function(n){var e=0;for(n.lastStringValue="";Oxe(e=n.current());)n.lastStringValue+=$c(e),n.advance();return n.lastStringValue!==""};function Oxe(n){return bX(n)||Cw(n)}Wt.regexp_eatLoneUnicodePropertyNameOrValue=function(n){return this.regexp_eatUnicodePropertyValue(n)};Wt.regexp_eatCharacterClass=function(n){if(n.eat(91)){var e=n.eat(94),t=this.regexp_classContents(n);return n.eat(93)||n.raise("Unterminated character class"),e&&t===ri&&n.raise("Negated character class may contain strings"),!0}return!1};Wt.regexp_classContents=function(n){return n.current()===93?Rc:n.switchV?this.regexp_classSetExpression(n):(this.regexp_nonEmptyClassRanges(n),Rc)};Wt.regexp_nonEmptyClassRanges=function(n){for(;this.regexp_eatClassAtom(n);){var e=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassAtom(n)){var t=n.lastIntValue;n.switchU&&(e===-1||t===-1)&&n.raise("Invalid character class"),e!==-1&&t!==-1&&e>t&&n.raise("Range out of order in character class")}}};Wt.regexp_eatClassAtom=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatClassEscape(n))return!0;if(n.switchU){var t=n.current();(t===99||wX(t))&&n.raise("Invalid class escape"),n.raise("Invalid escape")}n.pos=e}var s=n.current();return s!==93?(n.lastIntValue=s,n.advance(),!0):!1};Wt.regexp_eatClassEscape=function(n){var e=n.pos;if(n.eat(98))return n.lastIntValue=8,!0;if(n.switchU&&n.eat(45))return n.lastIntValue=45,!0;if(!n.switchU&&n.eat(99)){if(this.regexp_eatClassControlLetter(n))return!0;n.pos=e}return this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)};Wt.regexp_classSetExpression=function(n){var e=Rc,t;if(!this.regexp_eatClassSetRange(n))if(t=this.regexp_eatClassSetOperand(n)){t===ri&&(e=ri);for(var s=n.pos;n.eatChars([38,38]);){if(n.current()!==38&&(t=this.regexp_eatClassSetOperand(n))){t!==ri&&(e=Rc);continue}n.raise("Invalid character in character class")}if(s!==n.pos)return e;for(;n.eatChars([45,45]);)this.regexp_eatClassSetOperand(n)||n.raise("Invalid character in character class");if(s!==n.pos)return e}else n.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(n)){if(t=this.regexp_eatClassSetOperand(n),!t)return e;t===ri&&(e=ri)}};Wt.regexp_eatClassSetRange=function(n){var e=n.pos;if(this.regexp_eatClassSetCharacter(n)){var t=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassSetCharacter(n)){var s=n.lastIntValue;return t!==-1&&s!==-1&&t>s&&n.raise("Range out of order in character class"),!0}n.pos=e}return!1};Wt.regexp_eatClassSetOperand=function(n){return this.regexp_eatClassSetCharacter(n)?Rc:this.regexp_eatClassStringDisjunction(n)||this.regexp_eatNestedClass(n)};Wt.regexp_eatNestedClass=function(n){var e=n.pos;if(n.eat(91)){var t=n.eat(94),s=this.regexp_classContents(n);if(n.eat(93))return t&&s===ri&&n.raise("Negated character class may contain strings"),s;n.pos=e}if(n.eat(92)){var a=this.regexp_eatCharacterClassEscape(n);if(a)return a;n.pos=e}return null};Wt.regexp_eatClassStringDisjunction=function(n){var e=n.pos;if(n.eatChars([92,113])){if(n.eat(123)){var t=this.regexp_classStringDisjunctionContents(n);if(n.eat(125))return t}else n.raise("Invalid escape");n.pos=e}return null};Wt.regexp_classStringDisjunctionContents=function(n){for(var e=this.regexp_classString(n);n.eat(124);)this.regexp_classString(n)===ri&&(e=ri);return e};Wt.regexp_classString=function(n){for(var e=0;this.regexp_eatClassSetCharacter(n);)e++;return e===1?Rc:ri};Wt.regexp_eatClassSetCharacter=function(n){var e=n.pos;if(n.eat(92))return this.regexp_eatCharacterEscape(n)||this.regexp_eatClassSetReservedPunctuator(n)?!0:n.eat(98)?(n.lastIntValue=8,!0):(n.pos=e,!1);var t=n.current();return t<0||t===n.lookahead()&&xxe(t)||kxe(t)?!1:(n.advance(),n.lastIntValue=t,!0)};function xxe(n){return n===33||n>=35&&n<=38||n>=42&&n<=44||n===46||n>=58&&n<=64||n===94||n===96||n===126}function kxe(n){return n===40||n===41||n===45||n===47||n>=91&&n<=93||n>=123&&n<=125}Wt.regexp_eatClassSetReservedPunctuator=function(n){var e=n.current();return Pxe(e)?(n.lastIntValue=e,n.advance(),!0):!1};function Pxe(n){return n===33||n===35||n===37||n===38||n===44||n===45||n>=58&&n<=62||n===64||n===96||n===126}Wt.regexp_eatClassControlLetter=function(n){var e=n.current();return Cw(e)||e===95?(n.lastIntValue=e%32,n.advance(),!0):!1};Wt.regexp_eatHexEscapeSequence=function(n){var e=n.pos;if(n.eat(120)){if(this.regexp_eatFixedHexDigits(n,2))return!0;n.switchU&&n.raise("Invalid escape"),n.pos=e}return!1};Wt.regexp_eatDecimalDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;Cw(t=n.current());)n.lastIntValue=10*n.lastIntValue+(t-48),n.advance();return n.pos!==e};function Cw(n){return n>=48&&n<=57}Wt.regexp_eatHexDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;yX(t=n.current());)n.lastIntValue=16*n.lastIntValue+vX(t),n.advance();return n.pos!==e};function yX(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function vX(n){return n>=65&&n<=70?10+(n-65):n>=97&&n<=102?10+(n-97):n-48}Wt.regexp_eatLegacyOctalEscapeSequence=function(n){if(this.regexp_eatOctalDigit(n)){var e=n.lastIntValue;if(this.regexp_eatOctalDigit(n)){var t=n.lastIntValue;e<=3&&this.regexp_eatOctalDigit(n)?n.lastIntValue=e*64+t*8+n.lastIntValue:n.lastIntValue=e*8+t}else n.lastIntValue=e;return!0}return!1};Wt.regexp_eatOctalDigit=function(n){var e=n.current();return wX(e)?(n.lastIntValue=e-48,n.advance(),!0):(n.lastIntValue=0,!1)};function wX(n){return n>=48&&n<=55}Wt.regexp_eatFixedHexDigits=function(n,e){var t=n.pos;n.lastIntValue=0;for(var s=0;s<e;++s){var a=n.current();if(!yX(a))return n.pos=t,!1;n.lastIntValue=16*n.lastIntValue+vX(a),n.advance()}return!0};var n3=function(n){this.type=n.type,this.value=n.value,this.start=n.start,this.end=n.end,n.options.locations&&(this.loc=new kw(n,n.startLoc,n.endLoc)),n.options.ranges&&(this.range=[n.start,n.end])},qn=Ta.prototype;qn.next=function(n){!n&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new n3(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};qn.getToken=function(){return this.next(),new n3(this)};typeof Symbol<"u"&&(qn[Symbol.iterator]=function(){var n=this;return{next:function(){var e=n.getToken();return{done:e.type===re.eof,value:e}}}});qn.nextToken=function(){var n=this.curContext();if((!n||!n.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(re.eof);if(n.override)return n.override(this);this.readToken(this.fullCharCodeAtPos())};qn.readToken=function(n){return Bc(n,this.options.ecmaVersion>=6)||n===92?this.readWord():this.getTokenFromCode(n)};qn.fullCharCodeAtPos=function(){var n=this.input.charCodeAt(this.pos);if(n<=55295||n>=56320)return n;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?n:(n<<10)+e-56613888};qn.skipBlockComment=function(){var n=this.options.onComment&&this.curPosition(),e=this.pos,t=this.input.indexOf("*/",this.pos+=2);if(t===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=t+2,this.options.locations)for(var s=void 0,a=e;(s=ZG(this.input,a,this.pos))>-1;)++this.curLine,a=this.lineStart=s;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,t),e,this.pos,n,this.curPosition())};qn.skipLineComment=function(n){for(var e=this.pos,t=this.options.onComment&&this.curPosition(),s=this.input.charCodeAt(this.pos+=n);this.pos<this.input.length&&!Hm(s);)s=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+n,this.pos),e,this.pos,t,this.curPosition())};qn.skipSpace=function(){e:for(;this.pos<this.input.length;){var n=this.input.charCodeAt(this.pos);switch(n){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(n>8&&n<14||n>=5760&&zG.test(String.fromCharCode(n)))++this.pos;else break e}}};qn.finishToken=function(n,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var t=this.type;this.type=n,this.value=e,this.updateContext(t)};qn.readToken_dot=function(){var n=this.input.charCodeAt(this.pos+1);if(n>=48&&n<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&n===46&&e===46?(this.pos+=3,this.finishToken(re.ellipsis)):(++this.pos,this.finishToken(re.dot))};qn.readToken_slash=function(){var n=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):n===61?this.finishOp(re.assign,2):this.finishOp(re.slash,1)};qn.readToken_mult_modulo_exp=function(n){var e=this.input.charCodeAt(this.pos+1),t=1,s=n===42?re.star:re.modulo;return this.options.ecmaVersion>=7&&n===42&&e===42&&(++t,s=re.starstar,e=this.input.charCodeAt(this.pos+2)),e===61?this.finishOp(re.assign,t+1):this.finishOp(s,t)};qn.readToken_pipe_amp=function(n){var e=this.input.charCodeAt(this.pos+1);if(e===n){if(this.options.ecmaVersion>=12){var t=this.input.charCodeAt(this.pos+2);if(t===61)return this.finishOp(re.assign,3)}return this.finishOp(n===124?re.logicalOR:re.logicalAND,2)}return e===61?this.finishOp(re.assign,2):this.finishOp(n===124?re.bitwiseOR:re.bitwiseAND,1)};qn.readToken_caret=function(){var n=this.input.charCodeAt(this.pos+1);return n===61?this.finishOp(re.assign,2):this.finishOp(re.bitwiseXOR,1)};qn.readToken_plus_min=function(n){var e=this.input.charCodeAt(this.pos+1);return e===n?e===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Si.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(re.incDec,2):e===61?this.finishOp(re.assign,2):this.finishOp(re.plusMin,1)};qn.readToken_lt_gt=function(n){var e=this.input.charCodeAt(this.pos+1),t=1;return e===n?(t=n===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+t)===61?this.finishOp(re.assign,t+1):this.finishOp(re.bitShift,t)):e===33&&n===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(e===61&&(t=2),this.finishOp(re.relational,t))};qn.readToken_eq_excl=function(n){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(re.equality,this.input.charCodeAt(this.pos+2)===61?3:2):n===61&&e===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(re.arrow)):this.finishOp(n===61?re.eq:re.prefix,1)};qn.readToken_question=function(){var n=this.options.ecmaVersion;if(n>=11){var e=this.input.charCodeAt(this.pos+1);if(e===46){var t=this.input.charCodeAt(this.pos+2);if(t<48||t>57)return this.finishOp(re.questionDot,2)}if(e===63){if(n>=12){var s=this.input.charCodeAt(this.pos+2);if(s===61)return this.finishOp(re.assign,3)}return this.finishOp(re.coalesce,2)}}return this.finishOp(re.question,1)};qn.readToken_numberSign=function(){var n=this.options.ecmaVersion,e=35;if(n>=13&&(++this.pos,e=this.fullCharCodeAtPos(),Bc(e,!0)||e===92))return this.finishToken(re.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+$c(e)+"'")};qn.getTokenFromCode=function(n){switch(n){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(re.parenL);case 41:return++this.pos,this.finishToken(re.parenR);case 59:return++this.pos,this.finishToken(re.semi);case 44:return++this.pos,this.finishToken(re.comma);case 91:return++this.pos,this.finishToken(re.bracketL);case 93:return++this.pos,this.finishToken(re.bracketR);case 123:return++this.pos,this.finishToken(re.braceL);case 125:return++this.pos,this.finishToken(re.braceR);case 58:return++this.pos,this.finishToken(re.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(re.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(e===120||e===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(e===111||e===79)return this.readRadixNumber(8);if(e===98||e===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(n);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(n);case 124:case 38:return this.readToken_pipe_amp(n);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(n);case 60:case 62:return this.readToken_lt_gt(n);case 61:case 33:return this.readToken_eq_excl(n);case 63:return this.readToken_question();case 126:return this.finishOp(re.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+$c(n)+"'")};qn.finishOp=function(n,e){var t=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(n,t)};qn.readRegexp=function(){for(var n,e,t=this.pos;;){this.pos>=this.input.length&&this.raise(t,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(Si.test(s)&&this.raise(t,"Unterminated regular expression"),n)n=!1;else{if(s==="[")e=!0;else if(s==="]"&&e)e=!1;else if(s==="/"&&!e)break;n=s==="\\"}++this.pos}var a=this.input.slice(t,this.pos);++this.pos;var r=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(r);var i=this.regexpState||(this.regexpState=new sc(this));i.reset(t,a,o),this.validateRegExpFlags(i),this.validateRegExpPattern(i);var l=null;try{l=new RegExp(a,o)}catch{}return this.finishToken(re.regexp,{pattern:a,flags:o,value:l})};qn.readInt=function(n,e,t){for(var s=this.options.ecmaVersion>=12&&e===void 0,a=t&&this.input.charCodeAt(this.pos)===48,r=this.pos,o=0,i=0,l=0,c=e??1/0;l<c;++l,++this.pos){var u=this.input.charCodeAt(this.pos),h=void 0;if(s&&u===95){a&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),i===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),i=u;continue}if(u>=97?h=u-97+10:u>=65?h=u-65+10:u>=48&&u<=57?h=u-48:h=1/0,h>=n)break;i=u,o=o*n+h}return s&&i===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===r||e!=null&&this.pos-r!==e?null:o};function Sxe(n,e){return e?parseInt(n,8):parseFloat(n.replace(/_/g,""))}function OX(n){return typeof BigInt!="function"?null:BigInt(n.replace(/_/g,""))}qn.readRadixNumber=function(n){var e=this.pos;this.pos+=2;var t=this.readInt(n);return t==null&&this.raise(this.start+2,"Expected number in radix "+n),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(t=OX(this.input.slice(e,this.pos)),++this.pos):Bc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(re.num,t)};qn.readNumber=function(n){var e=this.pos;!n&&this.readInt(10,void 0,!0)===null&&this.raise(e,"Invalid number");var t=this.pos-e>=2&&this.input.charCodeAt(e)===48;t&&this.strict&&this.raise(e,"Invalid number");var s=this.input.charCodeAt(this.pos);if(!t&&!n&&this.options.ecmaVersion>=11&&s===110){var a=OX(this.input.slice(e,this.pos));return++this.pos,Bc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(re.num,a)}t&&/[89]/.test(this.input.slice(e,this.pos))&&(t=!1),s===46&&!t&&(++this.pos,this.readInt(10),s=this.input.charCodeAt(this.pos)),(s===69||s===101)&&!t&&(s=this.input.charCodeAt(++this.pos),(s===43||s===45)&&++this.pos,this.readInt(10)===null&&this.raise(e,"Invalid number")),Bc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var r=Sxe(this.input.slice(e,this.pos),t);return this.finishToken(re.num,r)};qn.readCodePoint=function(){var n=this.input.charCodeAt(this.pos),e;if(n===123){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e};qn.readString=function(n){for(var e="",t=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var s=this.input.charCodeAt(this.pos);if(s===n)break;s===92?(e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!1),t=this.pos):s===8232||s===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(Hm(s)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(t,this.pos++),this.finishToken(re.string,e)};var xX={};qn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(n){if(n===xX)this.readInvalidTemplateToken();else throw n}this.inTemplateElement=!1};qn.invalidStringToken=function(n,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw xX;this.raise(n,e)};qn.readTmplToken=function(){for(var n="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var t=this.input.charCodeAt(this.pos);if(t===96||t===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===re.template||this.type===re.invalidTemplate)?t===36?(this.pos+=2,this.finishToken(re.dollarBraceL)):(++this.pos,this.finishToken(re.backQuote)):(n+=this.input.slice(e,this.pos),this.finishToken(re.template,n));if(t===92)n+=this.input.slice(e,this.pos),n+=this.readEscapedChar(!0),e=this.pos;else if(Hm(t)){switch(n+=this.input.slice(e,this.pos),++this.pos,t){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:n+=`
`;break;default:n+=String.fromCharCode(t);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}};qn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(re.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};qn.readEscapedChar=function(n){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return $c(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),n){var t=this.pos-1;this.invalidStringToken(t,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],a=parseInt(s,8);return a>255&&(s=s.slice(0,-1),a=parseInt(s,8)),this.pos+=s.length-1,e=this.input.charCodeAt(this.pos),(s!=="0"||e===56||e===57)&&(this.strict||n)&&this.invalidStringToken(this.pos-1-s.length,n?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(a)}return Hm(e)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(e)}};qn.readHexChar=function(n){var e=this.pos,t=this.readInt(16,n);return t===null&&this.invalidStringToken(e,"Bad character escape sequence"),t};qn.readWord1=function(){this.containsEsc=!1;for(var n="",e=!0,t=this.pos,s=this.options.ecmaVersion>=6;this.pos<this.input.length;){var a=this.fullCharCodeAtPos();if(fm(a,s))this.pos+=a<=65535?1:2;else if(a===92){this.containsEsc=!0,n+=this.input.slice(t,this.pos);var r=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(e?Bc:fm)(o,s)||this.invalidStringToken(r,"Invalid Unicode escape"),n+=$c(o),t=this.pos}else break;e=!1}return n+this.input.slice(t,this.pos)};qn.readWord=function(){var n=this.readWord1(),e=re.name;return this.keywords.test(n)&&(e=UA[n]),this.finishToken(e,n)};var Cxe="8.14.0";Ta.acorn={Parser:Ta,version:Cxe,defaultOptions:eS,Position:ig,SourceLocation:kw,getLineInfo:XG,Node:Sw,TokenType:ns,tokTypes:re,keywordTypes:UA,TokContext:$i,tokContexts:Us,isIdentifierChar:fm,isIdentifierStart:Bc,Token:n3,isNewLine:Hm,lineBreak:Si,lineBreakG:qOe,nonASCIIwhitespace:zG};function Mxe(n,e){return Ta.parse(n,e)}var Axe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kX(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Exe(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var a=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:function(){return n[s]}})}),t}var Z9={},z9={},G9;function Dxe(){return G9||(G9=1,(function(n){(function e(t){var s,a,r,o,i,l;function c(F){var _={},$,Z;for($ in F)F.hasOwnProperty($)&&(Z=F[$],typeof Z=="object"&&Z!==null?_[$]=c(Z):_[$]=Z);return _}function u(F,_){var $,Z,ce,U;for(Z=F.length,ce=0;Z;)$=Z>>>1,U=ce+$,_(F[U])?Z=$:(ce=U+1,Z-=$+1);return ce}s={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},r={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},o={},i={},l={},a={Break:o,Skip:i,Remove:l};function h(F,_){this.parent=F,this.key=_}h.prototype.replace=function(F){this.parent[this.key]=F},h.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function m(F,_,$,Z){this.node=F,this.path=_,this.wrap=$,this.ref=Z}function f(){}f.prototype.path=function(){var F,_,$,Z,ce,U;function ue(W,de){if(Array.isArray(de))for($=0,Z=de.length;$<Z;++$)W.push(de[$]);else W.push(de)}if(!this.__current.path)return null;for(ce=[],F=2,_=this.__leavelist.length;F<_;++F)U=this.__leavelist[F],ue(ce,U.path);return ue(ce,this.__current.path),ce},f.prototype.type=function(){var F=this.current();return F.type||this.__current.wrap},f.prototype.parents=function(){var F,_,$;for($=[],F=1,_=this.__leavelist.length;F<_;++F)$.push(this.__leavelist[F].node);return $},f.prototype.current=function(){return this.__current.node},f.prototype.__execute=function(F,_){var $,Z;return Z=void 0,$=this.__current,this.__current=_,this.__state=null,F&&(Z=F.call(this,_.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=$,Z},f.prototype.notify=function(F){this.__state=F},f.prototype.skip=function(){this.notify(i)},f.prototype.break=function(){this.notify(o)},f.prototype.remove=function(){this.notify(l)},f.prototype.__initialize=function(F,_){this.visitor=_,this.root=F,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,_.fallback==="iteration"?this.__fallback=Object.keys:typeof _.fallback=="function"&&(this.__fallback=_.fallback),this.__keys=r,_.keys&&(this.__keys=Object.assign(Object.create(this.__keys),_.keys))};function v(F){return F==null?!1:typeof F=="object"&&typeof F.type=="string"}function O(F,_){return(F===s.ObjectExpression||F===s.ObjectPattern)&&_==="properties"}function k(F,_){for(var $=F.length-1;$>=0;--$)if(F[$].node===_)return!0;return!1}f.prototype.traverse=function(F,_){var $,Z,ce,U,ue,W,de,be,ke,Ce,Ae,q;for(this.__initialize(F,_),q={},$=this.__worklist,Z=this.__leavelist,$.push(new m(F,null,null,null)),Z.push(new m(null,null,null,null));$.length;){if(ce=$.pop(),ce===q){if(ce=Z.pop(),W=this.__execute(_.leave,ce),this.__state===o||W===o)return;continue}if(ce.node){if(W=this.__execute(_.enter,ce),this.__state===o||W===o)return;if($.push(q),Z.push(ce),this.__state===i||W===i)continue;if(U=ce.node,ue=U.type||ce.wrap,Ce=this.__keys[ue],!Ce)if(this.__fallback)Ce=this.__fallback(U);else throw new Error("Unknown node type "+ue+".");for(be=Ce.length;(be-=1)>=0;)if(de=Ce[be],Ae=U[de],!!Ae){if(Array.isArray(Ae)){for(ke=Ae.length;(ke-=1)>=0;)if(Ae[ke]&&!k(Z,Ae[ke])){if(O(ue,Ce[be]))ce=new m(Ae[ke],[de,ke],"Property",null);else if(v(Ae[ke]))ce=new m(Ae[ke],[de,ke],null,null);else continue;$.push(ce)}}else if(v(Ae)){if(k(Z,Ae))continue;$.push(new m(Ae,de,null,null))}}}}},f.prototype.replace=function(F,_){var $,Z,ce,U,ue,W,de,be,ke,Ce,Ae,q,Ne;function Re(je){var me,Ye,ft,_e;if(je.ref.remove()){for(Ye=je.ref.key,_e=je.ref.parent,me=$.length;me--;)if(ft=$[me],ft.ref&&ft.ref.parent===_e){if(ft.ref.key<Ye)break;--ft.ref.key}}}for(this.__initialize(F,_),Ae={},$=this.__worklist,Z=this.__leavelist,q={root:F},W=new m(F,null,null,new h(q,"root")),$.push(W),Z.push(W);$.length;){if(W=$.pop(),W===Ae){if(W=Z.pop(),ue=this.__execute(_.leave,W),ue!==void 0&&ue!==o&&ue!==i&&ue!==l&&W.ref.replace(ue),(this.__state===l||ue===l)&&Re(W),this.__state===o||ue===o)return q.root;continue}if(ue=this.__execute(_.enter,W),ue!==void 0&&ue!==o&&ue!==i&&ue!==l&&(W.ref.replace(ue),W.node=ue),(this.__state===l||ue===l)&&(Re(W),W.node=null),this.__state===o||ue===o)return q.root;if(ce=W.node,!!ce&&($.push(Ae),Z.push(W),!(this.__state===i||ue===i))){if(U=ce.type||W.wrap,ke=this.__keys[U],!ke)if(this.__fallback)ke=this.__fallback(ce);else throw new Error("Unknown node type "+U+".");for(de=ke.length;(de-=1)>=0;)if(Ne=ke[de],Ce=ce[Ne],!!Ce)if(Array.isArray(Ce)){for(be=Ce.length;(be-=1)>=0;)if(Ce[be]){if(O(U,ke[de]))W=new m(Ce[be],[Ne,be],"Property",new h(Ce,be));else if(v(Ce[be]))W=new m(Ce[be],[Ne,be],null,new h(Ce,be));else continue;$.push(W)}}else v(Ce)&&$.push(new m(Ce,Ne,null,new h(ce,Ne)))}}return q.root};function M(F,_){var $=new f;return $.traverse(F,_)}function E(F,_){var $=new f;return $.replace(F,_)}function I(F,_){var $;return $=u(_,function(Z){return Z.range[0]>F.range[0]}),F.extendedRange=[F.range[0],F.range[1]],$!==_.length&&(F.extendedRange[1]=_[$].range[0]),$-=1,$>=0&&(F.extendedRange[0]=_[$].range[1]),F}function D(F,_,$){var Z=[],ce,U,ue,W;if(!F.range)throw new Error("attachComments needs range information");if(!$.length){if(_.length){for(ue=0,U=_.length;ue<U;ue+=1)ce=c(_[ue]),ce.extendedRange=[0,F.range[0]],Z.push(ce);F.leadingComments=Z}return F}for(ue=0,U=_.length;ue<U;ue+=1)Z.push(I(c(_[ue]),$));return W=0,M(F,{enter:function(de){for(var be;W<Z.length&&(be=Z[W],!(be.extendedRange[1]>de.range[0]));)be.extendedRange[1]===de.range[0]?(de.leadingComments||(de.leadingComments=[]),de.leadingComments.push(be),Z.splice(W,1)):W+=1;if(W===Z.length)return a.Break;if(Z[W].extendedRange[0]>de.range[1])return a.Skip}}),W=0,M(F,{leave:function(de){for(var be;W<Z.length&&(be=Z[W],!(de.range[1]<be.extendedRange[0]));)de.range[1]===be.extendedRange[0]?(de.trailingComments||(de.trailingComments=[]),de.trailingComments.push(be),Z.splice(W,1)):W+=1;if(W===Z.length)return a.Break;if(Z[W].extendedRange[0]>de.range[1])return a.Skip}}),F}return t.Syntax=s,t.traverse=M,t.replace=E,t.attachComments=D,t.VisitorKeys=r,t.VisitorOption=a,t.Controller=f,t.cloneEnvironment=function(){return e({})},t})(n)})(z9)),z9}var z0={},X9={exports:{}},W9;function Txe(){return W9||(W9=1,(function(){function n(o){if(o==null)return!1;switch(o.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function e(o){if(o==null)return!1;switch(o.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function t(o){if(o==null)return!1;switch(o.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function s(o){return t(o)||o!=null&&o.type==="FunctionDeclaration"}function a(o){switch(o.type){case"IfStatement":return o.alternate!=null?o.alternate:o.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return o.body}return null}function r(o){var i;if(o.type!=="IfStatement"||o.alternate==null)return!1;i=o.consequent;do{if(i.type==="IfStatement"&&i.alternate==null)return!0;i=a(i)}while(i);return!1}X9.exports={isExpression:n,isStatement:t,isIterationStatement:e,isSourceElement:s,isProblematicIfStatement:r,trailingStatement:a}})()),X9.exports}var q9={exports:{}},U9;function PX(){return U9||(U9=1,(function(){var n,e,t,s,a,r;e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},n={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function o(k){return 48<=k&&k<=57}function i(k){return 48<=k&&k<=57||97<=k&&k<=102||65<=k&&k<=70}function l(k){return k>=48&&k<=55}t=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function c(k){return k===32||k===9||k===11||k===12||k===160||k>=5760&&t.indexOf(k)>=0}function u(k){return k===10||k===13||k===8232||k===8233}function h(k){if(k<=65535)return String.fromCharCode(k);var M=String.fromCharCode(Math.floor((k-65536)/1024)+55296),E=String.fromCharCode((k-65536)%1024+56320);return M+E}for(s=new Array(128),r=0;r<128;++r)s[r]=r>=97&&r<=122||r>=65&&r<=90||r===36||r===95;for(a=new Array(128),r=0;r<128;++r)a[r]=r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||r===36||r===95;function m(k){return k<128?s[k]:e.NonAsciiIdentifierStart.test(h(k))}function f(k){return k<128?a[k]:e.NonAsciiIdentifierPart.test(h(k))}function v(k){return k<128?s[k]:n.NonAsciiIdentifierStart.test(h(k))}function O(k){return k<128?a[k]:n.NonAsciiIdentifierPart.test(h(k))}q9.exports={isDecimalDigit:o,isHexDigit:i,isOctalDigit:l,isWhiteSpace:c,isLineTerminator:u,isIdentifierStartES5:m,isIdentifierPartES5:f,isIdentifierStartES6:v,isIdentifierPartES6:O}})()),q9.exports}var H9={exports:{}},Y9;function Fxe(){return Y9||(Y9=1,(function(){var n=PX();function e(m){switch(m){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function t(m,f){return!f&&m==="yield"?!1:s(m,f)}function s(m,f){if(f&&e(m))return!0;switch(m.length){case 2:return m==="if"||m==="in"||m==="do";case 3:return m==="var"||m==="for"||m==="new"||m==="try";case 4:return m==="this"||m==="else"||m==="case"||m==="void"||m==="with"||m==="enum";case 5:return m==="while"||m==="break"||m==="catch"||m==="throw"||m==="const"||m==="yield"||m==="class"||m==="super";case 6:return m==="return"||m==="typeof"||m==="delete"||m==="switch"||m==="export"||m==="import";case 7:return m==="default"||m==="finally"||m==="extends";case 8:return m==="function"||m==="continue"||m==="debugger";case 10:return m==="instanceof";default:return!1}}function a(m,f){return m==="null"||m==="true"||m==="false"||t(m,f)}function r(m,f){return m==="null"||m==="true"||m==="false"||s(m,f)}function o(m){return m==="eval"||m==="arguments"}function i(m){var f,v,O;if(m.length===0||(O=m.charCodeAt(0),!n.isIdentifierStartES5(O)))return!1;for(f=1,v=m.length;f<v;++f)if(O=m.charCodeAt(f),!n.isIdentifierPartES5(O))return!1;return!0}function l(m,f){return(m-55296)*1024+(f-56320)+65536}function c(m){var f,v,O,k,M;if(m.length===0)return!1;for(M=n.isIdentifierStartES6,f=0,v=m.length;f<v;++f){if(O=m.charCodeAt(f),55296<=O&&O<=56319){if(++f,f>=v||(k=m.charCodeAt(f),!(56320<=k&&k<=57343)))return!1;O=l(O,k)}if(!M(O))return!1;M=n.isIdentifierPartES6}return!0}function u(m,f){return i(m)&&!a(m,f)}function h(m,f){return c(m)&&!r(m,f)}H9.exports={isKeywordES5:t,isKeywordES6:s,isReservedWordES5:a,isReservedWordES6:r,isRestrictedWord:o,isIdentifierNameES5:i,isIdentifierNameES6:c,isIdentifierES5:u,isIdentifierES6:h}})()),H9.exports}var K9;function Nxe(){return K9||(K9=1,(function(){z0.ast=Txe(),z0.code=PX(),z0.keyword=Fxe()})()),z0}var G0={},Zx={},X0={},W0={},J9;function Bxe(){if(J9)return W0;J9=1;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return W0.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},W0.decode=function(e){var t=65,s=90,a=97,r=122,o=48,i=57,l=43,c=47,u=26,h=52;return t<=e&&e<=s?e-t:a<=e&&e<=r?e-a+u:o<=e&&e<=i?e-o+h:e==l?62:e==c?63:-1},W0}var e4;function SX(){if(e4)return X0;e4=1;var n=Bxe(),e=5,t=1<<e,s=t-1,a=t;function r(i){return i<0?(-i<<1)+1:(i<<1)+0}function o(i){var l=(i&1)===1,c=i>>1;return l?-c:c}return X0.encode=function(i){var l="",c,u=r(i);do c=u&s,u>>>=e,u>0&&(c|=a),l+=n.encode(c);while(u>0);return l},X0.decode=function(i,l,c){var u=i.length,h=0,m=0,f,v;do{if(l>=u)throw new Error("Expected more digits in base 64 VLQ value.");if(v=n.decode(i.charCodeAt(l++)),v===-1)throw new Error("Invalid base64 digit: "+i.charAt(l-1));f=!!(v&a),v&=s,h=h+(v<<m),m+=e}while(f);c.value=o(h),c.rest=l},X0}var t4={},n4;function Jg(){return n4||(n4=1,(function(n){function e(D,F,_){if(F in D)return D[F];if(arguments.length===3)return _;throw new Error('"'+F+'" is a required argument.')}n.getArg=e;var t=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,s=/^data:.+\,.+$/;function a(D){var F=D.match(t);return F?{scheme:F[1],auth:F[2],host:F[3],port:F[4],path:F[5]}:null}n.urlParse=a;function r(D){var F="";return D.scheme&&(F+=D.scheme+":"),F+="//",D.auth&&(F+=D.auth+"@"),D.host&&(F+=D.host),D.port&&(F+=":"+D.port),D.path&&(F+=D.path),F}n.urlGenerate=r;function o(D){var F=D,_=a(D);if(_){if(!_.path)return D;F=_.path}for(var $=n.isAbsolute(F),Z=F.split(/\/+/),ce,U=0,ue=Z.length-1;ue>=0;ue--)ce=Z[ue],ce==="."?Z.splice(ue,1):ce===".."?U++:U>0&&(ce===""?(Z.splice(ue+1,U),U=0):(Z.splice(ue,2),U--));return F=Z.join("/"),F===""&&(F=$?"/":"."),_?(_.path=F,r(_)):F}n.normalize=o;function i(D,F){D===""&&(D="."),F===""&&(F=".");var _=a(F),$=a(D);if($&&(D=$.path||"/"),_&&!_.scheme)return $&&(_.scheme=$.scheme),r(_);if(_||F.match(s))return F;if($&&!$.host&&!$.path)return $.host=F,r($);var Z=F.charAt(0)==="/"?F:o(D.replace(/\/+$/,"")+"/"+F);return $?($.path=Z,r($)):Z}n.join=i,n.isAbsolute=function(D){return D.charAt(0)==="/"||t.test(D)};function l(D,F){D===""&&(D="."),D=D.replace(/\/$/,"");for(var _=0;F.indexOf(D+"/")!==0;){var $=D.lastIndexOf("/");if($<0||(D=D.slice(0,$),D.match(/^([^\/]+:\/)?\/*$/)))return F;++_}return Array(_+1).join("../")+F.substr(D.length+1)}n.relative=l;var c=(function(){var D=Object.create(null);return!("__proto__"in D)})();function u(D){return D}function h(D){return f(D)?"$"+D:D}n.toSetString=c?u:h;function m(D){return f(D)?D.slice(1):D}n.fromSetString=c?u:m;function f(D){if(!D)return!1;var F=D.length;if(F<9||D.charCodeAt(F-1)!==95||D.charCodeAt(F-2)!==95||D.charCodeAt(F-3)!==111||D.charCodeAt(F-4)!==116||D.charCodeAt(F-5)!==111||D.charCodeAt(F-6)!==114||D.charCodeAt(F-7)!==112||D.charCodeAt(F-8)!==95||D.charCodeAt(F-9)!==95)return!1;for(var _=F-10;_>=0;_--)if(D.charCodeAt(_)!==36)return!1;return!0}function v(D,F,_){var $=k(D.source,F.source);return $!==0||($=D.originalLine-F.originalLine,$!==0)||($=D.originalColumn-F.originalColumn,$!==0||_)||($=D.generatedColumn-F.generatedColumn,$!==0)||($=D.generatedLine-F.generatedLine,$!==0)?$:k(D.name,F.name)}n.compareByOriginalPositions=v;function O(D,F,_){var $=D.generatedLine-F.generatedLine;return $!==0||($=D.generatedColumn-F.generatedColumn,$!==0||_)||($=k(D.source,F.source),$!==0)||($=D.originalLine-F.originalLine,$!==0)||($=D.originalColumn-F.originalColumn,$!==0)?$:k(D.name,F.name)}n.compareByGeneratedPositionsDeflated=O;function k(D,F){return D===F?0:D===null?1:F===null?-1:D>F?1:-1}function M(D,F){var _=D.generatedLine-F.generatedLine;return _!==0||(_=D.generatedColumn-F.generatedColumn,_!==0)||(_=k(D.source,F.source),_!==0)||(_=D.originalLine-F.originalLine,_!==0)||(_=D.originalColumn-F.originalColumn,_!==0)?_:k(D.name,F.name)}n.compareByGeneratedPositionsInflated=M;function E(D){return JSON.parse(D.replace(/^\)]}'[^\n]*\n/,""))}n.parseSourceMapInput=E;function I(D,F,_){if(F=F||"",D&&(D[D.length-1]!=="/"&&F[0]!=="/"&&(D+="/"),F=D+F),_){var $=a(_);if(!$)throw new Error("sourceMapURL could not be parsed");if($.path){var Z=$.path.lastIndexOf("/");Z>=0&&($.path=$.path.substring(0,Z+1))}F=i(r($),F)}return o(F)}n.computeSourceURL=I})(t4)),t4}var zx={},s4;function CX(){if(s4)return zx;s4=1;var n=Jg(),e=Object.prototype.hasOwnProperty,t=typeof Map<"u";function s(){this._array=[],this._set=t?new Map:Object.create(null)}return s.fromArray=function(a,r){for(var o=new s,i=0,l=a.length;i<l;i++)o.add(a[i],r);return o},s.prototype.size=function(){return t?this._set.size:Object.getOwnPropertyNames(this._set).length},s.prototype.add=function(a,r){var o=t?a:n.toSetString(a),i=t?this.has(a):e.call(this._set,o),l=this._array.length;(!i||r)&&this._array.push(a),i||(t?this._set.set(a,l):this._set[o]=l)},s.prototype.has=function(a){if(t)return this._set.has(a);var r=n.toSetString(a);return e.call(this._set,r)},s.prototype.indexOf=function(a){if(t){var r=this._set.get(a);if(r>=0)return r}else{var o=n.toSetString(a);if(e.call(this._set,o))return this._set[o]}throw new Error('"'+a+'" is not in the set.')},s.prototype.at=function(a){if(a>=0&&a<this._array.length)return this._array[a];throw new Error("No element indexed by "+a)},s.prototype.toArray=function(){return this._array.slice()},zx.ArraySet=s,zx}var Gx={},a4;function $xe(){if(a4)return Gx;a4=1;var n=Jg();function e(s,a){var r=s.generatedLine,o=a.generatedLine,i=s.generatedColumn,l=a.generatedColumn;return o>r||o==r&&l>=i||n.compareByGeneratedPositionsInflated(s,a)<=0}function t(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return t.prototype.unsortedForEach=function(s,a){this._array.forEach(s,a)},t.prototype.add=function(s){e(this._last,s)?(this._last=s,this._array.push(s)):(this._sorted=!1,this._array.push(s))},t.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},Gx.MappingList=t,Gx}var r4;function MX(){if(r4)return Zx;r4=1;var n=SX(),e=Jg(),t=CX().ArraySet,s=$xe().MappingList;function a(r){r||(r={}),this._file=e.getArg(r,"file",null),this._sourceRoot=e.getArg(r,"sourceRoot",null),this._skipValidation=e.getArg(r,"skipValidation",!1),this._sources=new t,this._names=new t,this._mappings=new s,this._sourcesContents=null}return a.prototype._version=3,a.fromSourceMap=function(r){var o=r.sourceRoot,i=new a({file:r.file,sourceRoot:o});return r.eachMapping(function(l){var c={generated:{line:l.generatedLine,column:l.generatedColumn}};l.source!=null&&(c.source=l.source,o!=null&&(c.source=e.relative(o,c.source)),c.original={line:l.originalLine,column:l.originalColumn},l.name!=null&&(c.name=l.name)),i.addMapping(c)}),r.sources.forEach(function(l){var c=l;o!==null&&(c=e.relative(o,l)),i._sources.has(c)||i._sources.add(c);var u=r.sourceContentFor(l);u!=null&&i.setSourceContent(l,u)}),i},a.prototype.addMapping=function(r){var o=e.getArg(r,"generated"),i=e.getArg(r,"original",null),l=e.getArg(r,"source",null),c=e.getArg(r,"name",null);this._skipValidation||this._validateMapping(o,i,l,c),l!=null&&(l=String(l),this._sources.has(l)||this._sources.add(l)),c!=null&&(c=String(c),this._names.has(c)||this._names.add(c)),this._mappings.add({generatedLine:o.line,generatedColumn:o.column,originalLine:i!=null&&i.line,originalColumn:i!=null&&i.column,source:l,name:c})},a.prototype.setSourceContent=function(r,o){var i=r;this._sourceRoot!=null&&(i=e.relative(this._sourceRoot,i)),o!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(i)]=o):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(i)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},a.prototype.applySourceMap=function(r,o,i){var l=o;if(o==null){if(r.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);l=r.file}var c=this._sourceRoot;c!=null&&(l=e.relative(c,l));var u=new t,h=new t;this._mappings.unsortedForEach(function(m){if(m.source===l&&m.originalLine!=null){var f=r.originalPositionFor({line:m.originalLine,column:m.originalColumn});f.source!=null&&(m.source=f.source,i!=null&&(m.source=e.join(i,m.source)),c!=null&&(m.source=e.relative(c,m.source)),m.originalLine=f.line,m.originalColumn=f.column,f.name!=null&&(m.name=f.name))}var v=m.source;v!=null&&!u.has(v)&&u.add(v);var O=m.name;O!=null&&!h.has(O)&&h.add(O)},this),this._sources=u,this._names=h,r.sources.forEach(function(m){var f=r.sourceContentFor(m);f!=null&&(i!=null&&(m=e.join(i,m)),c!=null&&(m=e.relative(c,m)),this.setSourceContent(m,f))},this)},a.prototype._validateMapping=function(r,o,i,l){if(o&&typeof o.line!="number"&&typeof o.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(r&&"line"in r&&"column"in r&&r.line>0&&r.column>=0&&!o&&!i&&!l)){if(r&&"line"in r&&"column"in r&&o&&"line"in o&&"column"in o&&r.line>0&&r.column>=0&&o.line>0&&o.column>=0&&i)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:r,source:i,original:o,name:l}))}},a.prototype._serializeMappings=function(){for(var r=0,o=1,i=0,l=0,c=0,u=0,h="",m,f,v,O,k=this._mappings.toArray(),M=0,E=k.length;M<E;M++){if(f=k[M],m="",f.generatedLine!==o)for(r=0;f.generatedLine!==o;)m+=";",o++;else if(M>0){if(!e.compareByGeneratedPositionsInflated(f,k[M-1]))continue;m+=","}m+=n.encode(f.generatedColumn-r),r=f.generatedColumn,f.source!=null&&(O=this._sources.indexOf(f.source),m+=n.encode(O-u),u=O,m+=n.encode(f.originalLine-1-l),l=f.originalLine-1,m+=n.encode(f.originalColumn-i),i=f.originalColumn,f.name!=null&&(v=this._names.indexOf(f.name),m+=n.encode(v-c),c=v)),h+=m}return h},a.prototype._generateSourcesContent=function(r,o){return r.map(function(i){if(!this._sourcesContents)return null;o!=null&&(i=e.relative(o,i));var l=e.toSetString(i);return Object.prototype.hasOwnProperty.call(this._sourcesContents,l)?this._sourcesContents[l]:null},this)},a.prototype.toJSON=function(){var r={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(r.file=this._file),this._sourceRoot!=null&&(r.sourceRoot=this._sourceRoot),this._sourcesContents&&(r.sourcesContent=this._generateSourcesContent(r.sources,r.sourceRoot)),r},a.prototype.toString=function(){return JSON.stringify(this.toJSON())},Zx.SourceMapGenerator=a,Zx}var Ep={},o4={},i4;function Rxe(){return i4||(i4=1,(function(n){n.GREATEST_LOWER_BOUND=1,n.LEAST_UPPER_BOUND=2;function e(t,s,a,r,o,i){var l=Math.floor((s-t)/2)+t,c=o(a,r[l],!0);return c===0?l:c>0?s-l>1?e(l,s,a,r,o,i):i==n.LEAST_UPPER_BOUND?s<r.length?s:-1:l:l-t>1?e(t,l,a,r,o,i):i==n.LEAST_UPPER_BOUND?l:t<0?-1:t}n.search=function(t,s,a,r){if(s.length===0)return-1;var o=e(-1,s.length,t,s,a,r||n.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&a(s[o],s[o-1],!0)===0;)--o;return o}})(o4)),o4}var Xx={},l4;function _xe(){if(l4)return Xx;l4=1;function n(s,a,r){var o=s[a];s[a]=s[r],s[r]=o}function e(s,a){return Math.round(s+Math.random()*(a-s))}function t(s,a,r,o){if(r<o){var i=e(r,o),l=r-1;n(s,i,o);for(var c=s[o],u=r;u<o;u++)a(s[u],c)<=0&&(l+=1,n(s,l,u));n(s,l+1,u);var h=l+1;t(s,a,r,h-1),t(s,a,h+1,o)}}return Xx.quickSort=function(s,a){t(s,a,0,s.length-1)},Xx}var c4;function Lxe(){if(c4)return Ep;c4=1;var n=Jg(),e=Rxe(),t=CX().ArraySet,s=SX(),a=_xe().quickSort;function r(c,u){var h=c;return typeof c=="string"&&(h=n.parseSourceMapInput(c)),h.sections!=null?new l(h,u):new o(h,u)}r.fromSourceMap=function(c,u){return o.fromSourceMap(c,u)},r.prototype._version=3,r.prototype.__generatedMappings=null,Object.defineProperty(r.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),r.prototype.__originalMappings=null,Object.defineProperty(r.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),r.prototype._charIsMappingSeparator=function(c,u){var h=c.charAt(u);return h===";"||h===","},r.prototype._parseMappings=function(c,u){throw new Error("Subclasses must implement _parseMappings")},r.GENERATED_ORDER=1,r.ORIGINAL_ORDER=2,r.GREATEST_LOWER_BOUND=1,r.LEAST_UPPER_BOUND=2,r.prototype.eachMapping=function(c,u,h){var m=u||null,f=h||r.GENERATED_ORDER,v;switch(f){case r.GENERATED_ORDER:v=this._generatedMappings;break;case r.ORIGINAL_ORDER:v=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var O=this.sourceRoot;v.map(function(k){var M=k.source===null?null:this._sources.at(k.source);return M=n.computeSourceURL(O,M,this._sourceMapURL),{source:M,generatedLine:k.generatedLine,generatedColumn:k.generatedColumn,originalLine:k.originalLine,originalColumn:k.originalColumn,name:k.name===null?null:this._names.at(k.name)}},this).forEach(c,m)},r.prototype.allGeneratedPositionsFor=function(c){var u=n.getArg(c,"line"),h={source:n.getArg(c,"source"),originalLine:u,originalColumn:n.getArg(c,"column",0)};if(h.source=this._findSourceIndex(h.source),h.source<0)return[];var m=[],f=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(f>=0){var v=this._originalMappings[f];if(c.column===void 0)for(var O=v.originalLine;v&&v.originalLine===O;)m.push({line:n.getArg(v,"generatedLine",null),column:n.getArg(v,"generatedColumn",null),lastColumn:n.getArg(v,"lastGeneratedColumn",null)}),v=this._originalMappings[++f];else for(var k=v.originalColumn;v&&v.originalLine===u&&v.originalColumn==k;)m.push({line:n.getArg(v,"generatedLine",null),column:n.getArg(v,"generatedColumn",null),lastColumn:n.getArg(v,"lastGeneratedColumn",null)}),v=this._originalMappings[++f]}return m},Ep.SourceMapConsumer=r;function o(c,u){var h=c;typeof c=="string"&&(h=n.parseSourceMapInput(c));var m=n.getArg(h,"version"),f=n.getArg(h,"sources"),v=n.getArg(h,"names",[]),O=n.getArg(h,"sourceRoot",null),k=n.getArg(h,"sourcesContent",null),M=n.getArg(h,"mappings"),E=n.getArg(h,"file",null);if(m!=this._version)throw new Error("Unsupported version: "+m);O&&(O=n.normalize(O)),f=f.map(String).map(n.normalize).map(function(I){return O&&n.isAbsolute(O)&&n.isAbsolute(I)?n.relative(O,I):I}),this._names=t.fromArray(v.map(String),!0),this._sources=t.fromArray(f,!0),this._absoluteSources=this._sources.toArray().map(function(I){return n.computeSourceURL(O,I,u)}),this.sourceRoot=O,this.sourcesContent=k,this._mappings=M,this._sourceMapURL=u,this.file=E}o.prototype=Object.create(r.prototype),o.prototype.consumer=r,o.prototype._findSourceIndex=function(c){var u=c;if(this.sourceRoot!=null&&(u=n.relative(this.sourceRoot,u)),this._sources.has(u))return this._sources.indexOf(u);var h;for(h=0;h<this._absoluteSources.length;++h)if(this._absoluteSources[h]==c)return h;return-1},o.fromSourceMap=function(c,u){var h=Object.create(o.prototype),m=h._names=t.fromArray(c._names.toArray(),!0),f=h._sources=t.fromArray(c._sources.toArray(),!0);h.sourceRoot=c._sourceRoot,h.sourcesContent=c._generateSourcesContent(h._sources.toArray(),h.sourceRoot),h.file=c._file,h._sourceMapURL=u,h._absoluteSources=h._sources.toArray().map(function(F){return n.computeSourceURL(h.sourceRoot,F,u)});for(var v=c._mappings.toArray().slice(),O=h.__generatedMappings=[],k=h.__originalMappings=[],M=0,E=v.length;M<E;M++){var I=v[M],D=new i;D.generatedLine=I.generatedLine,D.generatedColumn=I.generatedColumn,I.source&&(D.source=f.indexOf(I.source),D.originalLine=I.originalLine,D.originalColumn=I.originalColumn,I.name&&(D.name=m.indexOf(I.name)),k.push(D)),O.push(D)}return a(h.__originalMappings,n.compareByOriginalPositions),h},o.prototype._version=3,Object.defineProperty(o.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function i(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}o.prototype._parseMappings=function(c,u){for(var h=1,m=0,f=0,v=0,O=0,k=0,M=c.length,E=0,I={},D={},F=[],_=[],$,Z,ce,U,ue;E<M;)if(c.charAt(E)===";")h++,E++,m=0;else if(c.charAt(E)===",")E++;else{for($=new i,$.generatedLine=h,U=E;U<M&&!this._charIsMappingSeparator(c,U);U++);if(Z=c.slice(E,U),ce=I[Z],ce)E+=Z.length;else{for(ce=[];E<U;)s.decode(c,E,D),ue=D.value,E=D.rest,ce.push(ue);if(ce.length===2)throw new Error("Found a source, but no line and column");if(ce.length===3)throw new Error("Found a source and line, but no column");I[Z]=ce}$.generatedColumn=m+ce[0],m=$.generatedColumn,ce.length>1&&($.source=O+ce[1],O+=ce[1],$.originalLine=f+ce[2],f=$.originalLine,$.originalLine+=1,$.originalColumn=v+ce[3],v=$.originalColumn,ce.length>4&&($.name=k+ce[4],k+=ce[4])),_.push($),typeof $.originalLine=="number"&&F.push($)}a(_,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=_,a(F,n.compareByOriginalPositions),this.__originalMappings=F},o.prototype._findMapping=function(c,u,h,m,f,v){if(c[h]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+c[h]);if(c[m]<0)throw new TypeError("Column must be greater than or equal to 0, got "+c[m]);return e.search(c,u,f,v)},o.prototype.computeColumnSpans=function(){for(var c=0;c<this._generatedMappings.length;++c){var u=this._generatedMappings[c];if(c+1<this._generatedMappings.length){var h=this._generatedMappings[c+1];if(u.generatedLine===h.generatedLine){u.lastGeneratedColumn=h.generatedColumn-1;continue}}u.lastGeneratedColumn=1/0}},o.prototype.originalPositionFor=function(c){var u={generatedLine:n.getArg(c,"line"),generatedColumn:n.getArg(c,"column")},h=this._findMapping(u,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(c,"bias",r.GREATEST_LOWER_BOUND));if(h>=0){var m=this._generatedMappings[h];if(m.generatedLine===u.generatedLine){var f=n.getArg(m,"source",null);f!==null&&(f=this._sources.at(f),f=n.computeSourceURL(this.sourceRoot,f,this._sourceMapURL));var v=n.getArg(m,"name",null);return v!==null&&(v=this._names.at(v)),{source:f,line:n.getArg(m,"originalLine",null),column:n.getArg(m,"originalColumn",null),name:v}}}return{source:null,line:null,column:null,name:null}},o.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(c){return c==null}):!1},o.prototype.sourceContentFor=function(c,u){if(!this.sourcesContent)return null;var h=this._findSourceIndex(c);if(h>=0)return this.sourcesContent[h];var m=c;this.sourceRoot!=null&&(m=n.relative(this.sourceRoot,m));var f;if(this.sourceRoot!=null&&(f=n.urlParse(this.sourceRoot))){var v=m.replace(/^file:\/\//,"");if(f.scheme=="file"&&this._sources.has(v))return this.sourcesContent[this._sources.indexOf(v)];if((!f.path||f.path=="/")&&this._sources.has("/"+m))return this.sourcesContent[this._sources.indexOf("/"+m)]}if(u)return null;throw new Error('"'+m+'" is not in the SourceMap.')},o.prototype.generatedPositionFor=function(c){var u=n.getArg(c,"source");if(u=this._findSourceIndex(u),u<0)return{line:null,column:null,lastColumn:null};var h={source:u,originalLine:n.getArg(c,"line"),originalColumn:n.getArg(c,"column")},m=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(c,"bias",r.GREATEST_LOWER_BOUND));if(m>=0){var f=this._originalMappings[m];if(f.source===h.source)return{line:n.getArg(f,"generatedLine",null),column:n.getArg(f,"generatedColumn",null),lastColumn:n.getArg(f,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},Ep.BasicSourceMapConsumer=o;function l(c,u){var h=c;typeof c=="string"&&(h=n.parseSourceMapInput(c));var m=n.getArg(h,"version"),f=n.getArg(h,"sections");if(m!=this._version)throw new Error("Unsupported version: "+m);this._sources=new t,this._names=new t;var v={line:-1,column:0};this._sections=f.map(function(O){if(O.url)throw new Error("Support for url field in sections not implemented.");var k=n.getArg(O,"offset"),M=n.getArg(k,"line"),E=n.getArg(k,"column");if(M<v.line||M===v.line&&E<v.column)throw new Error("Section offsets must be ordered and non-overlapping.");return v=k,{generatedOffset:{generatedLine:M+1,generatedColumn:E+1},consumer:new r(n.getArg(O,"map"),u)}})}return l.prototype=Object.create(r.prototype),l.prototype.constructor=r,l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){for(var c=[],u=0;u<this._sections.length;u++)for(var h=0;h<this._sections[u].consumer.sources.length;h++)c.push(this._sections[u].consumer.sources[h]);return c}}),l.prototype.originalPositionFor=function(c){var u={generatedLine:n.getArg(c,"line"),generatedColumn:n.getArg(c,"column")},h=e.search(u,this._sections,function(f,v){var O=f.generatedLine-v.generatedOffset.generatedLine;return O||f.generatedColumn-v.generatedOffset.generatedColumn}),m=this._sections[h];return m?m.consumer.originalPositionFor({line:u.generatedLine-(m.generatedOffset.generatedLine-1),column:u.generatedColumn-(m.generatedOffset.generatedLine===u.generatedLine?m.generatedOffset.generatedColumn-1:0),bias:c.bias}):{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(c){return c.consumer.hasContentsOfAllSources()})},l.prototype.sourceContentFor=function(c,u){for(var h=0;h<this._sections.length;h++){var m=this._sections[h],f=m.consumer.sourceContentFor(c,!0);if(f)return f}if(u)return null;throw new Error('"'+c+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(c){for(var u=0;u<this._sections.length;u++){var h=this._sections[u];if(h.consumer._findSourceIndex(n.getArg(c,"source"))!==-1){var m=h.consumer.generatedPositionFor(c);if(m){var f={line:m.line+(h.generatedOffset.generatedLine-1),column:m.column+(h.generatedOffset.generatedLine===m.line?h.generatedOffset.generatedColumn-1:0)};return f}}}return{line:null,column:null}},l.prototype._parseMappings=function(c,u){this.__generatedMappings=[],this.__originalMappings=[];for(var h=0;h<this._sections.length;h++)for(var m=this._sections[h],f=m.consumer._generatedMappings,v=0;v<f.length;v++){var O=f[v],k=m.consumer._sources.at(O.source);k=n.computeSourceURL(m.consumer.sourceRoot,k,this._sourceMapURL),this._sources.add(k),k=this._sources.indexOf(k);var M=null;O.name&&(M=m.consumer._names.at(O.name),this._names.add(M),M=this._names.indexOf(M));var E={source:k,generatedLine:O.generatedLine+(m.generatedOffset.generatedLine-1),generatedColumn:O.generatedColumn+(m.generatedOffset.generatedLine===O.generatedLine?m.generatedOffset.generatedColumn-1:0),originalLine:O.originalLine,originalColumn:O.originalColumn,name:M};this.__generatedMappings.push(E),typeof E.originalLine=="number"&&this.__originalMappings.push(E)}a(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),a(this.__originalMappings,n.compareByOriginalPositions)},Ep.IndexedSourceMapConsumer=l,Ep}var Wx={},u4;function Ixe(){if(u4)return Wx;u4=1;var n=MX().SourceMapGenerator,e=Jg(),t=/(\r?\n)/,s=10,a="$$$isSourceNode$$$";function r(o,i,l,c,u){this.children=[],this.sourceContents={},this.line=o??null,this.column=i??null,this.source=l??null,this.name=u??null,this[a]=!0,c!=null&&this.add(c)}return r.fromStringWithSourceMap=function(o,i,l){var c=new r,u=o.split(t),h=0,m=function(){var M=I(),E=I()||"";return M+E;function I(){return h<u.length?u[h++]:void 0}},f=1,v=0,O=null;return i.eachMapping(function(M){if(O!==null)if(f<M.generatedLine)k(O,m()),f++,v=0;else{var E=u[h]||"",I=E.substr(0,M.generatedColumn-v);u[h]=E.substr(M.generatedColumn-v),v=M.generatedColumn,k(O,I),O=M;return}for(;f<M.generatedLine;)c.add(m()),f++;if(v<M.generatedColumn){var E=u[h]||"";c.add(E.substr(0,M.generatedColumn)),u[h]=E.substr(M.generatedColumn),v=M.generatedColumn}O=M},this),h<u.length&&(O&&k(O,m()),c.add(u.splice(h).join(""))),i.sources.forEach(function(M){var E=i.sourceContentFor(M);E!=null&&(l!=null&&(M=e.join(l,M)),c.setSourceContent(M,E))}),c;function k(M,E){if(M===null||M.source===void 0)c.add(E);else{var I=l?e.join(l,M.source):M.source;c.add(new r(M.originalLine,M.originalColumn,I,E,M.name))}}},r.prototype.add=function(o){if(Array.isArray(o))o.forEach(function(i){this.add(i)},this);else if(o[a]||typeof o=="string")o&&this.children.push(o);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+o);return this},r.prototype.prepend=function(o){if(Array.isArray(o))for(var i=o.length-1;i>=0;i--)this.prepend(o[i]);else if(o[a]||typeof o=="string")this.children.unshift(o);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+o);return this},r.prototype.walk=function(o){for(var i,l=0,c=this.children.length;l<c;l++)i=this.children[l],i[a]?i.walk(o):i!==""&&o(i,{source:this.source,line:this.line,column:this.column,name:this.name})},r.prototype.join=function(o){var i,l,c=this.children.length;if(c>0){for(i=[],l=0;l<c-1;l++)i.push(this.children[l]),i.push(o);i.push(this.children[l]),this.children=i}return this},r.prototype.replaceRight=function(o,i){var l=this.children[this.children.length-1];return l[a]?l.replaceRight(o,i):typeof l=="string"?this.children[this.children.length-1]=l.replace(o,i):this.children.push("".replace(o,i)),this},r.prototype.setSourceContent=function(o,i){this.sourceContents[e.toSetString(o)]=i},r.prototype.walkSourceContents=function(o){for(var i=0,l=this.children.length;i<l;i++)this.children[i][a]&&this.children[i].walkSourceContents(o);for(var c=Object.keys(this.sourceContents),i=0,l=c.length;i<l;i++)o(e.fromSetString(c[i]),this.sourceContents[c[i]])},r.prototype.toString=function(){var o="";return this.walk(function(i){o+=i}),o},r.prototype.toStringWithSourceMap=function(o){var i={code:"",line:1,column:0},l=new n(o),c=!1,u=null,h=null,m=null,f=null;return this.walk(function(v,O){i.code+=v,O.source!==null&&O.line!==null&&O.column!==null?((u!==O.source||h!==O.line||m!==O.column||f!==O.name)&&l.addMapping({source:O.source,original:{line:O.line,column:O.column},generated:{line:i.line,column:i.column},name:O.name}),u=O.source,h=O.line,m=O.column,f=O.name,c=!0):c&&(l.addMapping({generated:{line:i.line,column:i.column}}),u=null,c=!1);for(var k=0,M=v.length;k<M;k++)v.charCodeAt(k)===s?(i.line++,i.column=0,k+1===M?(u=null,c=!1):c&&l.addMapping({source:O.source,original:{line:O.line,column:O.column},generated:{line:i.line,column:i.column},name:O.name})):i.column++}),this.walkSourceContents(function(v,O){l.setSourceContent(v,O)}),{code:i.code,map:l}},Wx.SourceNode=r,Wx}var h4;function Qxe(){return h4||(h4=1,G0.SourceMapGenerator=MX().SourceMapGenerator,G0.SourceMapConsumer=Lxe().SourceMapConsumer,G0.SourceNode=Ixe().SourceNode),G0}const Vxe="2.1.0",jxe={version:Vxe};var d4;function Zxe(){return d4||(d4=1,(function(n){(function(){var e,t,s,a,r,o,i,l,c,u,h,m,f,v,O,k,M,E,I,D,F,_,$,Z,ce,U;r=Dxe(),o=Nxe(),e=r.Syntax;function ue(x){return He.Expression.hasOwnProperty(x.type)}function W(x){return He.Statement.hasOwnProperty(x.type)}t={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},s={"??":t.Coalesce,"||":t.LogicalOR,"&&":t.LogicalAND,"|":t.BitwiseOR,"^":t.BitwiseXOR,"&":t.BitwiseAND,"==":t.Equality,"!=":t.Equality,"===":t.Equality,"!==":t.Equality,is:t.Equality,isnt:t.Equality,"<":t.Relational,">":t.Relational,"<=":t.Relational,">=":t.Relational,in:t.Relational,instanceof:t.Relational,"<<":t.BitwiseSHIFT,">>":t.BitwiseSHIFT,">>>":t.BitwiseSHIFT,"+":t.Additive,"-":t.Additive,"*":t.Multiplicative,"%":t.Multiplicative,"/":t.Multiplicative,"**":t.Exponentiation};var de=1,be=2,ke=4,Ce=8,Ae=16,q=32,Ne=64,Re=be|ke,je=de|be,me=de|be|ke,Ye=de,ft=ke,_e=de|ke,Ge=de,pt=de|q,rt=0,tn=de|Ae,on=de|Ce;function xn(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function Gt(x,B){var T="";for(B|=0;B>0;B>>>=1,x+=x)B&1&&(T+=x);return T}function In(x){return/[\r\n]/g.test(x)}function Ft(x){var B=x.length;return B&&o.code.isLineTerminator(x.charCodeAt(B-1))}function jt(x,B){var T;for(T in B)B.hasOwnProperty(T)&&(x[T]=B[T]);return x}function Gn(x,B){var T,R;function j(H){return typeof H=="object"&&H instanceof Object&&!(H instanceof RegExp)}for(T in B)B.hasOwnProperty(T)&&(R=B[T],j(R)?j(x[T])?Gn(x[T],R):x[T]=Gn({},R):x[T]=R);return x}function un(x){var B,T,R,j,H;if(x!==x)throw new Error("Numeric literal whose value is NaN");if(x<0||x===0&&1/x<0)throw new Error("Numeric literal whose value is negative");if(x===1/0)return c?"null":u?"1e400":"1e+400";if(B=""+x,!u||B.length<3)return B;for(T=B.indexOf("."),!c&&B.charCodeAt(0)===48&&T===1&&(T=0,B=B.slice(1)),R=B,B=B.replace("e+","e"),j=0,(H=R.indexOf("e"))>0&&(j=+R.slice(H+1),R=R.slice(0,H)),T>=0&&(j-=R.length-T-1,R=+(R.slice(0,T)+R.slice(T+1))+""),H=0;R.charCodeAt(R.length+H-1)===48;)--H;return H!==0&&(j-=H,R=R.slice(0,H)),j!==0&&(R+="e"+j),(R.length<B.length||h&&x>1e12&&Math.floor(x)===x&&(R="0x"+x.toString(16)).length<B.length)&&+R===x&&(B=R),B}function fn(x,B){return(x&-2)===8232?(B?"u":"\\u")+(x===8232?"2028":"2029"):x===10||x===13?(B?"":"\\")+(x===10?"n":"r"):String.fromCharCode(x)}function at(x){var B,T,R,j,H,ee,ne,ge;if(T=x.toString(),x.source){if(B=T.match(/\/([^/]*)$/),!B)return T;for(R=B[1],T="",ne=!1,ge=!1,j=0,H=x.source.length;j<H;++j)ee=x.source.charCodeAt(j),ge?(T+=fn(ee,ge),ge=!1):(ne?ee===93&&(ne=!1):ee===47?T+="\\":ee===91&&(ne=!0),T+=fn(ee,ge),ge=ee===92);return"/"+T+"/"+R}return T}function Un(x,B){var T;return x===8?"\\b":x===12?"\\f":x===9?"\\t":(T=x.toString(16).toUpperCase(),c||x>255?"\\u"+"0000".slice(T.length)+T:x===0&&!o.code.isDecimalDigit(B)?"\\0":x===11?"\\x0B":"\\x"+"00".slice(T.length)+T)}function nt(x){if(x===92)return"\\\\";if(x===10)return"\\n";if(x===13)return"\\r";if(x===8232)return"\\u2028";if(x===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function Mt(x){var B,T,R,j;for(j=m==="double"?'"':"'",B=0,T=x.length;B<T;++B)if(R=x.charCodeAt(B),R===39){j='"';break}else if(R===34){j="'";break}else R===92&&++B;return j+x+j}function Vt(x){var B="",T,R,j,H=0,ee=0,ne,ge;for(T=0,R=x.length;T<R;++T){if(j=x.charCodeAt(T),j===39)++H;else if(j===34)++ee;else if(j===47&&c)B+="\\";else if(o.code.isLineTerminator(j)||j===92){B+=nt(j);continue}else if(!o.code.isIdentifierPartES5(j)&&(c&&j<32||!c&&!f&&(j<32||j>126))){B+=Un(j,x.charCodeAt(T+1));continue}B+=String.fromCharCode(j)}if(ne=!(m==="double"||m==="auto"&&ee<H),ge=ne?"'":'"',!(ne?H:ee))return ge+B+ge;for(x=B,B=ge,T=0,R=x.length;T<R;++T)j=x.charCodeAt(T),(j===39&&ne||j===34&&!ne)&&(B+="\\"),B+=String.fromCharCode(j);return B+ge}function En(x){var B,T,R,j="";for(B=0,T=x.length;B<T;++B)R=x[B],j+=Array.isArray(R)?En(R):R;return j}function lt(x,B){if(!_)return Array.isArray(x)?En(x):x;if(B==null){if(x instanceof a)return x;B={}}return B.loc==null?new a(null,null,_,x,B.name||null):new a(B.loc.start.line,B.loc.start.column,_===!0?B.loc.source||null:_,x,B.name||null)}function It(){return O||" "}function Le(x,B){var T,R,j,H;return T=lt(x).toString(),T.length===0?[B]:(R=lt(B).toString(),R.length===0?[x]:(j=T.charCodeAt(T.length-1),H=R.charCodeAt(0),(j===43||j===45)&&j===H||o.code.isIdentifierPartES5(j)&&o.code.isIdentifierPartES5(H)||j===47&&H===105?[x,It(),B]:o.code.isWhiteSpace(j)||o.code.isLineTerminator(j)||o.code.isWhiteSpace(H)||o.code.isLineTerminator(H)?[x,B]:[x,O,B]))}function qt(x){return[i,x]}function tt(x){var B;B=i,i+=l,x(i),i=B}function zn(x){var B;for(B=x.length-1;B>=0&&!o.code.isLineTerminator(x.charCodeAt(B));--B);return x.length-1-B}function mt(x,B){var T,R,j,H,ee,ne,ge,Fe;for(T=x.split(/\r\n|[\r\n]/),ne=Number.MAX_VALUE,R=1,j=T.length;R<j;++R){for(H=T[R],ee=0;ee<H.length&&o.code.isWhiteSpace(H.charCodeAt(ee));)++ee;ne>ee&&(ne=ee)}for(typeof B<"u"?(ge=i,T[1][ne]==="*"&&(B+=" "),i=B):(ne&1&&--ne,ge=i),R=1,j=T.length;R<j;++R)Fe=lt(qt(T[R].slice(ne))),T[R]=_?Fe.join(""):Fe;return i=ge,T.join(`
`)}function Fn(x,B){if(x.type==="Line"){if(Ft(x.value))return"//"+x.value;var T="//"+x.value;return Z||(T+=`
`),T}return D.format.indent.adjustMultilineComment&&/[\n\r]/.test(x.value)?mt("/*"+x.value+"*/",B):"/*"+x.value+"*/"}function ea(x,B){var T,R,j,H,ee,ne,ge,Fe,Be,wt,Nt,yn,ws,gn;if(x.leadingComments&&x.leadingComments.length>0){if(H=B,Z){for(j=x.leadingComments[0],B=[],Fe=j.extendedRange,Be=j.range,Nt=$.substring(Fe[0],Be[0]),gn=(Nt.match(/\n/g)||[]).length,gn>0?(B.push(Gt(`
`,gn)),B.push(qt(Fn(j)))):(B.push(Nt),B.push(Fn(j))),wt=Be,T=1,R=x.leadingComments.length;T<R;T++)j=x.leadingComments[T],Be=j.range,yn=$.substring(wt[1],Be[0]),gn=(yn.match(/\n/g)||[]).length,B.push(Gt(`
`,gn)),B.push(qt(Fn(j))),wt=Be;ws=$.substring(Be[1],Fe[1]),gn=(ws.match(/\n/g)||[]).length,B.push(Gt(`
`,gn))}else for(j=x.leadingComments[0],B=[],E&&x.type===e.Program&&x.body.length===0&&B.push(`
`),B.push(Fn(j)),Ft(lt(B).toString())||B.push(`
`),T=1,R=x.leadingComments.length;T<R;++T)j=x.leadingComments[T],ge=[Fn(j)],Ft(lt(ge).toString())||ge.push(`
`),B.push(qt(ge));B.push(qt(H))}if(x.trailingComments)if(Z)j=x.trailingComments[0],Fe=j.extendedRange,Be=j.range,Nt=$.substring(Fe[0],Be[0]),gn=(Nt.match(/\n/g)||[]).length,gn>0?(B.push(Gt(`
`,gn)),B.push(qt(Fn(j)))):(B.push(Nt),B.push(Fn(j)));else for(ee=!Ft(lt(B).toString()),ne=Gt(" ",zn(lt([i,B,l]).toString())),T=0,R=x.trailingComments.length;T<R;++T)j=x.trailingComments[T],ee?(T===0?B=[B,l]:B=[B,ne],B.push(Fn(j,ne))):B=[B,qt(Fn(j))],T!==R-1&&!Ft(lt(B).toString())&&(B=[B,`
`]);return B}function Hn(x,B,T){var R,j=0;for(R=x;R<B;R++)$[R]===`
`&&j++;for(R=1;R<j;R++)T.push(v)}function Zt(x,B,T){return B<T?["(",x,")"]:x}function Dt(x){var B,T,R;for(R=x.split(/\r\n|\n/),B=1,T=R.length;B<T;B++)R[B]=v+i+R[B];return R}function Sn(x,B){var T,R,j;return T=x[D.verbatim],typeof T=="string"?R=Zt(Dt(T),t.Sequence,B):(R=Dt(T.content),j=T.precedence!=null?T.precedence:t.Sequence,R=Zt(R,j,B)),lt(R,x)}function He(){}He.prototype.maybeBlock=function(x,B){var T,R,j=this;return R=!D.comment||!x.leadingComments,x.type===e.BlockStatement&&R?[O,this.generateStatement(x,B)]:x.type===e.EmptyStatement&&R?";":(tt(function(){T=[v,qt(j.generateStatement(x,B))]}),T)},He.prototype.maybeBlockSuffix=function(x,B){var T=Ft(lt(B).toString());return x.type===e.BlockStatement&&(!D.comment||!x.leadingComments)&&!T?[B,O]:T?[B,i]:[B,v,i]};function Tt(x){return lt(x.name,x)}function kn(x,B){return x.async?"async"+(B?It():O):""}function vs(x){var B=x.generator&&!D.moz.starlessGenerator;return B?"*"+O:""}function ln(x){var B=x.value,T="";return B.async&&(T+=kn(B,!x.computed)),B.generator&&(T+=vs(B)?"*":""),T}He.prototype.generatePattern=function(x,B,T){return x.type===e.Identifier?Tt(x):this.generateExpression(x,B,T)},He.prototype.generateFunctionParams=function(x){var B,T,R,j;if(j=!1,x.type===e.ArrowFunctionExpression&&!x.rest&&(!x.defaults||x.defaults.length===0)&&x.params.length===1&&x.params[0].type===e.Identifier)R=[kn(x,!0),Tt(x.params[0])];else{for(R=x.type===e.ArrowFunctionExpression?[kn(x,!1)]:[],R.push("("),x.defaults&&(j=!0),B=0,T=x.params.length;B<T;++B)j&&x.defaults[B]?R.push(this.generateAssignment(x.params[B],x.defaults[B],"=",t.Assignment,me)):R.push(this.generatePattern(x.params[B],t.Assignment,me)),B+1<T&&R.push(","+O);x.rest&&(x.params.length&&R.push(","+O),R.push("..."),R.push(Tt(x.rest))),R.push(")")}return R},He.prototype.generateFunctionBody=function(x){var B,T;return B=this.generateFunctionParams(x),x.type===e.ArrowFunctionExpression&&(B.push(O),B.push("=>")),x.expression?(B.push(O),T=this.generateExpression(x.body,t.Assignment,me),T.toString().charAt(0)==="{"&&(T=["(",T,")"]),B.push(T)):B.push(this.maybeBlock(x.body,on)),B},He.prototype.generateIterationForStatement=function(x,B,T){var R=["for"+(B.await?It()+"await":"")+O+"("],j=this;return tt(function(){B.left.type===e.VariableDeclaration?tt(function(){R.push(B.left.kind+It()),R.push(j.generateStatement(B.left.declarations[0],rt))}):R.push(j.generateExpression(B.left,t.Call,me)),R=Le(R,x),R=[Le(R,j.generateExpression(B.right,t.Assignment,me)),")"]}),R.push(this.maybeBlock(B.body,T)),R},He.prototype.generatePropertyKey=function(x,B){var T=[];return B&&T.push("["),T.push(this.generateExpression(x,t.Assignment,me)),B&&T.push("]"),T},He.prototype.generateAssignment=function(x,B,T,R,j){return t.Assignment<R&&(j|=de),Zt([this.generateExpression(x,t.Call,j),O+T+O,this.generateExpression(B,t.Assignment,j)],t.Assignment,R)},He.prototype.semicolon=function(x){return!M&&x&q?"":";"},He.Statement={BlockStatement:function(x,B){var T,R,j=["{",v],H=this;return tt(function(){x.body.length===0&&Z&&(T=x.range,T[1]-T[0]>2&&(R=$.substring(T[0]+1,T[1]-1),R[0]===`
`&&(j=["{"]),j.push(R)));var ee,ne,ge,Fe;for(Fe=Ge,B&Ce&&(Fe|=Ae),ee=0,ne=x.body.length;ee<ne;++ee)Z&&(ee===0&&(x.body[0].leadingComments&&(T=x.body[0].leadingComments[0].extendedRange,R=$.substring(T[0],T[1]),R[0]===`
`&&(j=["{"])),x.body[0].leadingComments||Hn(x.range[0],x.body[0].range[0],j)),ee>0&&!x.body[ee-1].trailingComments&&!x.body[ee].leadingComments&&Hn(x.body[ee-1].range[1],x.body[ee].range[0],j)),ee===ne-1&&(Fe|=q),x.body[ee].leadingComments&&Z?ge=H.generateStatement(x.body[ee],Fe):ge=qt(H.generateStatement(x.body[ee],Fe)),j.push(ge),Ft(lt(ge).toString())||Z&&ee<ne-1&&x.body[ee+1].leadingComments||j.push(v),Z&&ee===ne-1&&(x.body[ee].trailingComments||Hn(x.body[ee].range[1],x.range[1],j))}),j.push(qt("}")),j},BreakStatement:function(x,B){return x.label?"break "+x.label.name+this.semicolon(B):"break"+this.semicolon(B)},ContinueStatement:function(x,B){return x.label?"continue "+x.label.name+this.semicolon(B):"continue"+this.semicolon(B)},ClassBody:function(x,B){var T=["{",v],R=this;return tt(function(j){var H,ee;for(H=0,ee=x.body.length;H<ee;++H)T.push(j),T.push(R.generateExpression(x.body[H],t.Sequence,me)),H+1<ee&&T.push(v)}),Ft(lt(T).toString())||T.push(v),T.push(i),T.push("}"),T},ClassDeclaration:function(x,B){var T,R;return T=["class"],x.id&&(T=Le(T,this.generateExpression(x.id,t.Sequence,me))),x.superClass&&(R=Le("extends",this.generateExpression(x.superClass,t.Unary,me)),T=Le(T,R)),T.push(O),T.push(this.generateStatement(x.body,pt)),T},DirectiveStatement:function(x,B){return D.raw&&x.raw?x.raw+this.semicolon(B):Mt(x.directive)+this.semicolon(B)},DoWhileStatement:function(x,B){var T=Le("do",this.maybeBlock(x.body,Ge));return T=this.maybeBlockSuffix(x.body,T),Le(T,["while"+O+"(",this.generateExpression(x.test,t.Sequence,me),")"+this.semicolon(B)])},CatchClause:function(x,B){var T,R=this;return tt(function(){var j;x.param?(T=["catch"+O+"(",R.generateExpression(x.param,t.Sequence,me),")"],x.guard&&(j=R.generateExpression(x.guard,t.Sequence,me),T.splice(2,0," if ",j))):T=["catch"]}),T.push(this.maybeBlock(x.body,Ge)),T},DebuggerStatement:function(x,B){return"debugger"+this.semicolon(B)},EmptyStatement:function(x,B){return";"},ExportDefaultDeclaration:function(x,B){var T=["export"],R;return R=B&q?pt:Ge,T=Le(T,"default"),W(x.declaration)?T=Le(T,this.generateStatement(x.declaration,R)):T=Le(T,this.generateExpression(x.declaration,t.Assignment,me)+this.semicolon(B)),T},ExportNamedDeclaration:function(x,B){var T=["export"],R,j=this;return R=B&q?pt:Ge,x.declaration?Le(T,this.generateStatement(x.declaration,R)):(x.specifiers&&(x.specifiers.length===0?T=Le(T,"{"+O+"}"):x.specifiers[0].type===e.ExportBatchSpecifier?T=Le(T,this.generateExpression(x.specifiers[0],t.Sequence,me)):(T=Le(T,"{"),tt(function(H){var ee,ne;for(T.push(v),ee=0,ne=x.specifiers.length;ee<ne;++ee)T.push(H),T.push(j.generateExpression(x.specifiers[ee],t.Sequence,me)),ee+1<ne&&T.push(","+v)}),Ft(lt(T).toString())||T.push(v),T.push(i+"}")),x.source?T=Le(T,["from"+O,this.generateExpression(x.source,t.Sequence,me),this.semicolon(B)]):T.push(this.semicolon(B))),T)},ExportAllDeclaration:function(x,B){return["export"+O,"*"+O,"from"+O,this.generateExpression(x.source,t.Sequence,me),this.semicolon(B)]},ExpressionStatement:function(x,B){var T,R;function j(ne){var ge;return ne.slice(0,5)!=="class"?!1:(ge=ne.charCodeAt(5),ge===123||o.code.isWhiteSpace(ge)||o.code.isLineTerminator(ge))}function H(ne){var ge;return ne.slice(0,8)!=="function"?!1:(ge=ne.charCodeAt(8),ge===40||o.code.isWhiteSpace(ge)||ge===42||o.code.isLineTerminator(ge))}function ee(ne){var ge,Fe,Be;if(ne.slice(0,5)!=="async"||!o.code.isWhiteSpace(ne.charCodeAt(5)))return!1;for(Fe=6,Be=ne.length;Fe<Be&&o.code.isWhiteSpace(ne.charCodeAt(Fe));++Fe);return Fe===Be||ne.slice(Fe,Fe+8)!=="function"?!1:(ge=ne.charCodeAt(Fe+8),ge===40||o.code.isWhiteSpace(ge)||ge===42||o.code.isLineTerminator(ge))}return T=[this.generateExpression(x.expression,t.Sequence,me)],R=lt(T).toString(),R.charCodeAt(0)===123||j(R)||H(R)||ee(R)||I&&B&Ae&&x.expression.type===e.Literal&&typeof x.expression.value=="string"?T=["(",T,")"+this.semicolon(B)]:T.push(this.semicolon(B)),T},ImportDeclaration:function(x,B){var T,R,j=this;return x.specifiers.length===0?["import",O,this.generateExpression(x.source,t.Sequence,me),this.semicolon(B)]:(T=["import"],R=0,x.specifiers[R].type===e.ImportDefaultSpecifier&&(T=Le(T,[this.generateExpression(x.specifiers[R],t.Sequence,me)]),++R),x.specifiers[R]&&(R!==0&&T.push(","),x.specifiers[R].type===e.ImportNamespaceSpecifier?T=Le(T,[O,this.generateExpression(x.specifiers[R],t.Sequence,me)]):(T.push(O+"{"),x.specifiers.length-R===1?(T.push(O),T.push(this.generateExpression(x.specifiers[R],t.Sequence,me)),T.push(O+"}"+O)):(tt(function(H){var ee,ne;for(T.push(v),ee=R,ne=x.specifiers.length;ee<ne;++ee)T.push(H),T.push(j.generateExpression(x.specifiers[ee],t.Sequence,me)),ee+1<ne&&T.push(","+v)}),Ft(lt(T).toString())||T.push(v),T.push(i+"}"+O)))),T=Le(T,["from"+O,this.generateExpression(x.source,t.Sequence,me),this.semicolon(B)]),T)},VariableDeclarator:function(x,B){var T=B&de?me:Re;return x.init?[this.generateExpression(x.id,t.Assignment,T),O,"=",O,this.generateExpression(x.init,t.Assignment,T)]:this.generatePattern(x.id,t.Assignment,T)},VariableDeclaration:function(x,B){var T,R,j,H,ee,ne=this;T=[x.kind],ee=B&de?Ge:rt;function ge(){for(H=x.declarations[0],D.comment&&H.leadingComments?(T.push(`
`),T.push(qt(ne.generateStatement(H,ee)))):(T.push(It()),T.push(ne.generateStatement(H,ee))),R=1,j=x.declarations.length;R<j;++R)H=x.declarations[R],D.comment&&H.leadingComments?(T.push(","+v),T.push(qt(ne.generateStatement(H,ee)))):(T.push(","+O),T.push(ne.generateStatement(H,ee)))}return x.declarations.length>1?tt(ge):ge(),T.push(this.semicolon(B)),T},ThrowStatement:function(x,B){return[Le("throw",this.generateExpression(x.argument,t.Sequence,me)),this.semicolon(B)]},TryStatement:function(x,B){var T,R,j,H;if(T=["try",this.maybeBlock(x.block,Ge)],T=this.maybeBlockSuffix(x.block,T),x.handlers)for(R=0,j=x.handlers.length;R<j;++R)T=Le(T,this.generateStatement(x.handlers[R],Ge)),(x.finalizer||R+1!==j)&&(T=this.maybeBlockSuffix(x.handlers[R].body,T));else{for(H=x.guardedHandlers||[],R=0,j=H.length;R<j;++R)T=Le(T,this.generateStatement(H[R],Ge)),(x.finalizer||R+1!==j)&&(T=this.maybeBlockSuffix(H[R].body,T));if(x.handler)if(Array.isArray(x.handler))for(R=0,j=x.handler.length;R<j;++R)T=Le(T,this.generateStatement(x.handler[R],Ge)),(x.finalizer||R+1!==j)&&(T=this.maybeBlockSuffix(x.handler[R].body,T));else T=Le(T,this.generateStatement(x.handler,Ge)),x.finalizer&&(T=this.maybeBlockSuffix(x.handler.body,T))}return x.finalizer&&(T=Le(T,["finally",this.maybeBlock(x.finalizer,Ge)])),T},SwitchStatement:function(x,B){var T,R,j,H,ee,ne=this;if(tt(function(){T=["switch"+O+"(",ne.generateExpression(x.discriminant,t.Sequence,me),")"+O+"{"+v]}),x.cases)for(ee=Ge,j=0,H=x.cases.length;j<H;++j)j===H-1&&(ee|=q),R=qt(this.generateStatement(x.cases[j],ee)),T.push(R),Ft(lt(R).toString())||T.push(v);return T.push(qt("}")),T},SwitchCase:function(x,B){var T,R,j,H,ee,ne=this;return tt(function(){for(x.test?T=[Le("case",ne.generateExpression(x.test,t.Sequence,me)),":"]:T=["default:"],j=0,H=x.consequent.length,H&&x.consequent[0].type===e.BlockStatement&&(R=ne.maybeBlock(x.consequent[0],Ge),T.push(R),j=1),j!==H&&!Ft(lt(T).toString())&&T.push(v),ee=Ge;j<H;++j)j===H-1&&B&q&&(ee|=q),R=qt(ne.generateStatement(x.consequent[j],ee)),T.push(R),j+1!==H&&!Ft(lt(R).toString())&&T.push(v)}),T},IfStatement:function(x,B){var T,R,j,H=this;return tt(function(){T=["if"+O+"(",H.generateExpression(x.test,t.Sequence,me),")"]}),j=B&q,R=Ge,j&&(R|=q),x.alternate?(T.push(this.maybeBlock(x.consequent,Ge)),T=this.maybeBlockSuffix(x.consequent,T),x.alternate.type===e.IfStatement?T=Le(T,["else ",this.generateStatement(x.alternate,R)]):T=Le(T,Le("else",this.maybeBlock(x.alternate,R)))):T.push(this.maybeBlock(x.consequent,R)),T},ForStatement:function(x,B){var T,R=this;return tt(function(){T=["for"+O+"("],x.init?x.init.type===e.VariableDeclaration?T.push(R.generateStatement(x.init,rt)):(T.push(R.generateExpression(x.init,t.Sequence,Re)),T.push(";")):T.push(";"),x.test&&(T.push(O),T.push(R.generateExpression(x.test,t.Sequence,me))),T.push(";"),x.update&&(T.push(O),T.push(R.generateExpression(x.update,t.Sequence,me))),T.push(")")}),T.push(this.maybeBlock(x.body,B&q?pt:Ge)),T},ForInStatement:function(x,B){return this.generateIterationForStatement("in",x,B&q?pt:Ge)},ForOfStatement:function(x,B){return this.generateIterationForStatement("of",x,B&q?pt:Ge)},LabeledStatement:function(x,B){return[x.label.name+":",this.maybeBlock(x.body,B&q?pt:Ge)]},Program:function(x,B){var T,R,j,H,ee;for(H=x.body.length,T=[E&&H>0?`
`:""],ee=tn,j=0;j<H;++j)!E&&j===H-1&&(ee|=q),Z&&(j===0&&(x.body[0].leadingComments||Hn(x.range[0],x.body[j].range[0],T)),j>0&&!x.body[j-1].trailingComments&&!x.body[j].leadingComments&&Hn(x.body[j-1].range[1],x.body[j].range[0],T)),R=qt(this.generateStatement(x.body[j],ee)),T.push(R),j+1<H&&!Ft(lt(R).toString())&&(Z&&x.body[j+1].leadingComments||T.push(v)),Z&&j===H-1&&(x.body[j].trailingComments||Hn(x.body[j].range[1],x.range[1],T));return T},FunctionDeclaration:function(x,B){return[kn(x,!0),"function",vs(x)||It(),x.id?Tt(x.id):"",this.generateFunctionBody(x)]},ReturnStatement:function(x,B){return x.argument?[Le("return",this.generateExpression(x.argument,t.Sequence,me)),this.semicolon(B)]:["return"+this.semicolon(B)]},WhileStatement:function(x,B){var T,R=this;return tt(function(){T=["while"+O+"(",R.generateExpression(x.test,t.Sequence,me),")"]}),T.push(this.maybeBlock(x.body,B&q?pt:Ge)),T},WithStatement:function(x,B){var T,R=this;return tt(function(){T=["with"+O+"(",R.generateExpression(x.object,t.Sequence,me),")"]}),T.push(this.maybeBlock(x.body,B&q?pt:Ge)),T}},jt(He.prototype,He.Statement),He.Expression={SequenceExpression:function(x,B,T){var R,j,H;for(t.Sequence<B&&(T|=de),R=[],j=0,H=x.expressions.length;j<H;++j)R.push(this.generateExpression(x.expressions[j],t.Assignment,T)),j+1<H&&R.push(","+O);return Zt(R,t.Sequence,B)},AssignmentExpression:function(x,B,T){return this.generateAssignment(x.left,x.right,x.operator,B,T)},ArrowFunctionExpression:function(x,B,T){return Zt(this.generateFunctionBody(x),t.ArrowFunction,B)},ConditionalExpression:function(x,B,T){return t.Conditional<B&&(T|=de),Zt([this.generateExpression(x.test,t.Coalesce,T),O+"?"+O,this.generateExpression(x.consequent,t.Assignment,T),O+":"+O,this.generateExpression(x.alternate,t.Assignment,T)],t.Conditional,B)},LogicalExpression:function(x,B,T){return x.operator==="??"&&(T|=Ne),this.BinaryExpression(x,B,T)},BinaryExpression:function(x,B,T){var R,j,H,ee,ne,ge;return ee=s[x.operator],j=x.operator==="**"?t.Postfix:ee,H=x.operator==="**"?ee:ee+1,ee<B&&(T|=de),ne=this.generateExpression(x.left,j,T),ge=ne.toString(),ge.charCodeAt(ge.length-1)===47&&o.code.isIdentifierPartES5(x.operator.charCodeAt(0))?R=[ne,It(),x.operator]:R=Le(ne,x.operator),ne=this.generateExpression(x.right,H,T),x.operator==="/"&&ne.toString().charAt(0)==="/"||x.operator.slice(-1)==="<"&&ne.toString().slice(0,3)==="!--"?(R.push(It()),R.push(ne)):R=Le(R,ne),x.operator==="in"&&!(T&de)?["(",R,")"]:(x.operator==="||"||x.operator==="&&")&&T&Ne?["(",R,")"]:Zt(R,ee,B)},CallExpression:function(x,B,T){var R,j,H;for(R=[this.generateExpression(x.callee,t.Call,je)],x.optional&&R.push("?."),R.push("("),j=0,H=x.arguments.length;j<H;++j)R.push(this.generateExpression(x.arguments[j],t.Assignment,me)),j+1<H&&R.push(","+O);return R.push(")"),T&be?Zt(R,t.Call,B):["(",R,")"]},ChainExpression:function(x,B,T){t.OptionalChaining<B&&(T|=be);var R=this.generateExpression(x.expression,t.OptionalChaining,T);return Zt(R,t.OptionalChaining,B)},NewExpression:function(x,B,T){var R,j,H,ee,ne;if(j=x.arguments.length,ne=T&ke&&!k&&j===0?_e:Ye,R=Le("new",this.generateExpression(x.callee,t.New,ne)),!(T&ke)||k||j>0){for(R.push("("),H=0,ee=j;H<ee;++H)R.push(this.generateExpression(x.arguments[H],t.Assignment,me)),H+1<ee&&R.push(","+O);R.push(")")}return Zt(R,t.New,B)},MemberExpression:function(x,B,T){var R,j;return R=[this.generateExpression(x.object,t.Call,T&be?je:Ye)],x.computed?(x.optional&&R.push("?."),R.push("["),R.push(this.generateExpression(x.property,t.Sequence,T&be?me:_e)),R.push("]")):(!x.optional&&x.object.type===e.Literal&&typeof x.object.value=="number"&&(j=lt(R).toString(),j.indexOf(".")<0&&!/[eExX]/.test(j)&&o.code.isDecimalDigit(j.charCodeAt(j.length-1))&&!(j.length>=2&&j.charCodeAt(0)===48)&&R.push(" ")),R.push(x.optional?"?.":"."),R.push(Tt(x.property))),Zt(R,t.Member,B)},MetaProperty:function(x,B,T){var R;return R=[],R.push(typeof x.meta=="string"?x.meta:Tt(x.meta)),R.push("."),R.push(typeof x.property=="string"?x.property:Tt(x.property)),Zt(R,t.Member,B)},UnaryExpression:function(x,B,T){var R,j,H,ee,ne;return j=this.generateExpression(x.argument,t.Unary,me),O===""?R=Le(x.operator,j):(R=[x.operator],x.operator.length>2?R=Le(R,j):(ee=lt(R).toString(),ne=ee.charCodeAt(ee.length-1),H=j.toString().charCodeAt(0),((ne===43||ne===45)&&ne===H||o.code.isIdentifierPartES5(ne)&&o.code.isIdentifierPartES5(H))&&R.push(It()),R.push(j))),Zt(R,t.Unary,B)},YieldExpression:function(x,B,T){var R;return x.delegate?R="yield*":R="yield",x.argument&&(R=Le(R,this.generateExpression(x.argument,t.Yield,me))),Zt(R,t.Yield,B)},AwaitExpression:function(x,B,T){var R=Le(x.all?"await*":"await",this.generateExpression(x.argument,t.Await,me));return Zt(R,t.Await,B)},UpdateExpression:function(x,B,T){return x.prefix?Zt([x.operator,this.generateExpression(x.argument,t.Unary,me)],t.Unary,B):Zt([this.generateExpression(x.argument,t.Postfix,me),x.operator],t.Postfix,B)},FunctionExpression:function(x,B,T){var R=[kn(x,!0),"function"];return x.id?(R.push(vs(x)||It()),R.push(Tt(x.id))):R.push(vs(x)||O),R.push(this.generateFunctionBody(x)),R},ArrayPattern:function(x,B,T){return this.ArrayExpression(x,B,T,!0)},ArrayExpression:function(x,B,T,R){var j,H,ee=this;return x.elements.length?(H=R?!1:x.elements.length>1,j=["[",H?v:""],tt(function(ne){var ge,Fe;for(ge=0,Fe=x.elements.length;ge<Fe;++ge)x.elements[ge]?(j.push(H?ne:""),j.push(ee.generateExpression(x.elements[ge],t.Assignment,me))):(H&&j.push(ne),ge+1===Fe&&j.push(",")),ge+1<Fe&&j.push(","+(H?v:O))}),H&&!Ft(lt(j).toString())&&j.push(v),j.push(H?i:""),j.push("]"),j):"[]"},RestElement:function(x,B,T){return"..."+this.generatePattern(x.argument)},ClassExpression:function(x,B,T){var R,j;return R=["class"],x.id&&(R=Le(R,this.generateExpression(x.id,t.Sequence,me))),x.superClass&&(j=Le("extends",this.generateExpression(x.superClass,t.Unary,me)),R=Le(R,j)),R.push(O),R.push(this.generateStatement(x.body,pt)),R},MethodDefinition:function(x,B,T){var R,j;return x.static?R=["static"+O]:R=[],x.kind==="get"||x.kind==="set"?j=[Le(x.kind,this.generatePropertyKey(x.key,x.computed)),this.generateFunctionBody(x.value)]:j=[ln(x),this.generatePropertyKey(x.key,x.computed),this.generateFunctionBody(x.value)],Le(R,j)},Property:function(x,B,T){return x.kind==="get"||x.kind==="set"?[x.kind,It(),this.generatePropertyKey(x.key,x.computed),this.generateFunctionBody(x.value)]:x.shorthand?x.value.type==="AssignmentPattern"?this.AssignmentPattern(x.value,t.Sequence,me):this.generatePropertyKey(x.key,x.computed):x.method?[ln(x),this.generatePropertyKey(x.key,x.computed),this.generateFunctionBody(x.value)]:[this.generatePropertyKey(x.key,x.computed),":"+O,this.generateExpression(x.value,t.Assignment,me)]},ObjectExpression:function(x,B,T){var R,j,H,ee=this;return x.properties.length?(R=x.properties.length>1,tt(function(){H=ee.generateExpression(x.properties[0],t.Sequence,me)}),!R&&!In(lt(H).toString())?["{",O,H,O,"}"]:(tt(function(ne){var ge,Fe;if(j=["{",v,ne,H],R)for(j.push(","+v),ge=1,Fe=x.properties.length;ge<Fe;++ge)j.push(ne),j.push(ee.generateExpression(x.properties[ge],t.Sequence,me)),ge+1<Fe&&j.push(","+v)}),Ft(lt(j).toString())||j.push(v),j.push(i),j.push("}"),j)):"{}"},AssignmentPattern:function(x,B,T){return this.generateAssignment(x.left,x.right,"=",B,T)},ObjectPattern:function(x,B,T){var R,j,H,ee,ne,ge=this;if(!x.properties.length)return"{}";if(ee=!1,x.properties.length===1)ne=x.properties[0],ne.type===e.Property&&ne.value.type!==e.Identifier&&(ee=!0);else for(j=0,H=x.properties.length;j<H;++j)if(ne=x.properties[j],ne.type===e.Property&&!ne.shorthand){ee=!0;break}return R=["{",ee?v:""],tt(function(Fe){var Be,wt;for(Be=0,wt=x.properties.length;Be<wt;++Be)R.push(ee?Fe:""),R.push(ge.generateExpression(x.properties[Be],t.Sequence,me)),Be+1<wt&&R.push(","+(ee?v:O))}),ee&&!Ft(lt(R).toString())&&R.push(v),R.push(ee?i:""),R.push("}"),R},ThisExpression:function(x,B,T){return"this"},Super:function(x,B,T){return"super"},Identifier:function(x,B,T){return Tt(x)},ImportDefaultSpecifier:function(x,B,T){return Tt(x.id||x.local)},ImportNamespaceSpecifier:function(x,B,T){var R=["*"],j=x.id||x.local;return j&&R.push(O+"as"+It()+Tt(j)),R},ImportSpecifier:function(x,B,T){var R=x.imported,j=[R.name],H=x.local;return H&&H.name!==R.name&&j.push(It()+"as"+It()+Tt(H)),j},ExportSpecifier:function(x,B,T){var R=x.local,j=[R.name],H=x.exported;return H&&H.name!==R.name&&j.push(It()+"as"+It()+Tt(H)),j},Literal:function(x,B,T){var R;if(x.hasOwnProperty("raw")&&F&&D.raw)try{if(R=F(x.raw).body[0].expression,R.type===e.Literal&&R.value===x.value)return x.raw}catch{}return x.regex?"/"+x.regex.pattern+"/"+x.regex.flags:typeof x.value=="bigint"?x.value.toString()+"n":x.bigint?x.bigint+"n":x.value===null?"null":typeof x.value=="string"?Vt(x.value):typeof x.value=="number"?un(x.value):typeof x.value=="boolean"?x.value?"true":"false":at(x.value)},GeneratorExpression:function(x,B,T){return this.ComprehensionExpression(x,B,T)},ComprehensionExpression:function(x,B,T){var R,j,H,ee,ne=this;return R=x.type===e.GeneratorExpression?["("]:["["],D.moz.comprehensionExpressionStartsWithAssignment&&(ee=this.generateExpression(x.body,t.Assignment,me),R.push(ee)),x.blocks&&tt(function(){for(j=0,H=x.blocks.length;j<H;++j)ee=ne.generateExpression(x.blocks[j],t.Sequence,me),j>0||D.moz.comprehensionExpressionStartsWithAssignment?R=Le(R,ee):R.push(ee)}),x.filter&&(R=Le(R,"if"+O),ee=this.generateExpression(x.filter,t.Sequence,me),R=Le(R,["(",ee,")"])),D.moz.comprehensionExpressionStartsWithAssignment||(ee=this.generateExpression(x.body,t.Assignment,me),R=Le(R,ee)),R.push(x.type===e.GeneratorExpression?")":"]"),R},ComprehensionBlock:function(x,B,T){var R;return x.left.type===e.VariableDeclaration?R=[x.left.kind,It(),this.generateStatement(x.left.declarations[0],rt)]:R=this.generateExpression(x.left,t.Call,me),R=Le(R,x.of?"of":"in"),R=Le(R,this.generateExpression(x.right,t.Sequence,me)),["for"+O+"(",R,")"]},SpreadElement:function(x,B,T){return["...",this.generateExpression(x.argument,t.Assignment,me)]},TaggedTemplateExpression:function(x,B,T){var R=je;T&be||(R=Ye);var j=[this.generateExpression(x.tag,t.Call,R),this.generateExpression(x.quasi,t.Primary,ft)];return Zt(j,t.TaggedTemplate,B)},TemplateElement:function(x,B,T){return x.value.raw},TemplateLiteral:function(x,B,T){var R,j,H;for(R=["`"],j=0,H=x.quasis.length;j<H;++j)R.push(this.generateExpression(x.quasis[j],t.Primary,me)),j+1<H&&(R.push("${"+O),R.push(this.generateExpression(x.expressions[j],t.Sequence,me)),R.push(O+"}"));return R.push("`"),R},ModuleSpecifier:function(x,B,T){return this.Literal(x,B,T)},ImportExpression:function(x,B,T){return Zt(["import(",this.generateExpression(x.source,t.Assignment,me),")"],t.Call,B)}},jt(He.prototype,He.Expression),He.prototype.generateExpression=function(x,B,T){var R,j;return j=x.type||e.Property,D.verbatim&&x.hasOwnProperty(D.verbatim)?Sn(x,B):(R=this[j](x,B,T),D.comment&&(R=ea(x,R)),lt(R,x))},He.prototype.generateStatement=function(x,B){var T,R;return T=this[x.type](x,B),D.comment&&(T=ea(x,T)),R=lt(T).toString(),x.type===e.Program&&!E&&v===""&&R.charAt(R.length-1)===`
`&&(T=_?lt(T).replaceRight(/\s+$/,""):R.replace(/\s+$/,"")),lt(T,x)};function Gs(x){var B;if(B=new He,W(x))return B.generateStatement(x,Ge);if(ue(x))return B.generateExpression(x,t.Sequence,me);throw new Error("Unknown node type: "+x.type)}function na(x,B){var T=xn(),R,j;return B!=null?(typeof B.indent=="string"&&(T.format.indent.style=B.indent),typeof B.base=="number"&&(T.format.indent.base=B.base),B=Gn(T,B),l=B.format.indent.style,typeof B.base=="string"?i=B.base:i=Gt(l,B.format.indent.base)):(B=T,l=B.format.indent.style,i=Gt(l,B.format.indent.base)),c=B.format.json,u=B.format.renumber,h=c?!1:B.format.hexadecimal,m=c?"double":B.format.quotes,f=B.format.escapeless,v=B.format.newline,O=B.format.space,B.format.compact&&(v=O=l=i=""),k=B.format.parentheses,M=B.format.semicolons,E=B.format.safeConcatenation,I=B.directive,F=c?null:B.parse,_=B.sourceMap,$=B.sourceCode,Z=B.format.preserveBlankLines&&$!==null,D=B,_&&(n.browser?a=Axe.sourceMap.SourceNode:a=Qxe().SourceNode),R=Gs(x),_?(j=R.toStringWithSourceMap({file:B.file,sourceRoot:B.sourceMapRoot}),B.sourceContent&&j.map.setSourceContent(B.sourceMap,B.sourceContent),B.sourceMapWithCode?j:j.map.toString()):(j={code:R.toString(),map:null},B.sourceMapWithCode?j:j.code)}ce={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},U=xn().format,n.version=jxe.version,n.generate=na,n.attachComments=r.attachComments,n.Precedence=Gn({},t),n.browser=!1,n.FORMAT_MINIFY=ce,n.FORMAT_DEFAULTS=U})()})(Z9)),Z9}var zxe=Zxe();const Gxe=kX(zxe);class Xxe{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:e=>this.replacement=e}}replace(e,t,s,a){e&&t&&(s!=null?e[t][s]=a:e[t]=a)}remove(e,t,s){e&&t&&(s!=null?e[t].splice(s,1):delete e[t])}}class Wxe extends Xxe{constructor(e,t){super(),this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:s=>this.replacement=s},this.enter=e,this.leave=t}visit(e,t,s,a){if(e){if(this.enter){const o=this.should_skip,i=this.should_remove,l=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,e,t,s,a),this.replacement&&(e=this.replacement,this.replace(t,s,a,e)),this.should_remove&&this.remove(t,s,a);const c=this.should_skip,u=this.should_remove;if(this.should_skip=o,this.should_remove=i,this.replacement=l,c)return e;if(u)return null}let r;for(r in e){const o=e[r];if(o&&typeof o=="object")if(Array.isArray(o)){const i=o;for(let l=0;l<i.length;l+=1){const c=i[l];m4(c)&&(this.visit(c,e,r,l)||l--)}}else m4(o)&&this.visit(o,e,r,null)}if(this.leave){const o=this.replacement,i=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,e,t,s,a),this.replacement&&(e=this.replacement,this.replace(t,s,a,e)),this.should_remove&&this.remove(t,s,a);const l=this.should_remove;if(this.replacement=o,this.should_remove=i,l)return null}}return e}}function m4(n){return n!==null&&typeof n=="object"&&"type"in n&&typeof n.type=="string"}function qxe(n,{enter:e,leave:t}){return new Wxe(e,t).visit(n,null)}let AX=[];function Uxe(n){AX.push(n)}let Fy=new Map;function Hxe(n,e={}){var m;const{wrapAsync:t=!1,addReturn:s=!0,emitMiniLocations:a=!0,emitWidgets:r=!0}=e;let o=Mxe(n,{ecmaVersion:2022,allowAwaitOutsideFunction:!0,locations:!0}),i=[];const l=(f,v)=>{const O=Fy.get("minilang");if(O){const k=`[${f}]`,M=O.getLocations(k,v.start);i=i.concat(M)}else{const k=WA(`"${f}"`,v.start,n);i=i.concat(k)}};let c=[];qxe(o,{enter(f,v){var O,k,M;if(ike(f)){const{name:E}=f.tag,I=Fy.get(E),D=f.quasi.quasis[0].value.raw,F=f.quasi.start+1;if(a){const _=I.getLocations(D,F);i=i.concat(_)}return this.skip(),this.replace(hke(E,D,F))}if(lke(f,"tidal")){const E=f.quasi.quasis[0].value.raw,I=f.quasi.start+1;if(a){const D=cke(E,I);i=i.concat(D)}return this.skip(),this.replace(uke(E,I))}if(Kxe(f,v)){const{quasis:E}=f,{raw:I}=E[0].value;return this.skip(),a&&l(I,f),this.replace(p4(I,f))}if(Yxe(f)){const{value:E}=f;return this.skip(),a&&l(E,f),this.replace(p4(E,f))}if(Jxe(f))return r&&c.push({from:f.arguments[0].start,to:f.arguments[0].end,value:f.arguments[0].raw,min:((O=f.arguments[1])==null?void 0:O.value)??0,max:((k=f.arguments[2])==null?void 0:k.value)??1,step:(M=f.arguments[3])==null?void 0:M.value,type:"slider"}),this.replace(tke(f));if(eke(f)){const E=f.callee.property.name,I=c.filter(F=>F.type===E).length,D={to:f.end,index:I,type:E,id:e.id};return r&&c.push(D),this.replace(nke(f,D))}if(ske(f,v))return this.replace(ake(f));if(rke(f))return this.replace(oke(f))},leave(f,v,O,k){}});let{body:u}=o;if(!u.length)console.warn("empty body -> fallback to silence"),u.push({type:"ExpressionStatement",expression:{type:"Identifier",name:"silence"}});else if(!((m=u==null?void 0:u[u.length-1])!=null&&m.expression))throw new Error("unexpected ast format without body expression");if(s){const{expression:f}=u[u.length-1];u[u.length-1]={type:"ReturnStatement",argument:f}}let h=Gxe.generate(o);return t&&(h=`(async ()=>{${h}})()`),a?{output:h,miniLocations:i,widgets:c}:{output:h}}function Yxe(n,e,t){return n.type!=="Literal"?!1:n.raw[0]==='"'}function Kxe(n,e){return n.type==="TemplateLiteral"&&e.type!=="TaggedTemplateExpression"}function p4(n,e){const{start:t}=e,s=Fy.get("minilang");let a="m";return s&&s.name&&(a=s.name),{type:"CallExpression",callee:{type:"Identifier",name:a},arguments:[{type:"Literal",value:n},{type:"Literal",value:t}],optional:!1}}function Jxe(n){return n.type==="CallExpression"&&n.callee.name==="slider"}function eke(n){var e;return n.type==="CallExpression"&&AX.includes((e=n.callee.property)==null?void 0:e.name)}function tke(n){const e="slider_"+n.arguments[0].start;return n.arguments.unshift({type:"Literal",value:e,raw:e}),n.callee.name="sliderWithID",n}function EX(n){return`${n.id||""}_widget_${n.type}_${n.index}`}function nke(n,e){const t=EX(e);return n.arguments.unshift({type:"Literal",value:t,raw:t}),n}function ske(n,e){return n.type==="CallExpression"&&n.callee.name==="samples"&&e.type!=="AwaitExpression"}function ake(n){return{type:"AwaitExpression",argument:n}}function rke(n){return n.type==="LabeledStatement"}function oke(n){return{type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"MemberExpression",object:n.body.expression,property:{type:"Identifier",name:"p"}},arguments:[{type:"Literal",value:n.label.name,raw:`'${n.label.name}'`}]}}}function ike(n){return n.type==="TaggedTemplateExpression"&&Fy.has(n.tag.name)}function lke(n,e){return n.type==="TaggedTemplateExpression"&&n.tag.name===e}function cke(n,e){return n.split("").reduce((t,s,a)=>(s!=='"'||(!t.length||t[t.length-1].length>1?t.push([a+1]):t[t.length-1].push(a)),t),[]).map(([t,s])=>{const a=n.slice(t,s);return WA(`"${a}"`,e+t-1)}).flat()}function uke(n,e){return{type:"CallExpression",callee:{type:"Identifier",name:"tidal"},arguments:[{type:"Literal",value:n},{type:"Literal",value:e}],optional:!1}}function hke(n,e,t){return{type:"CallExpression",callee:{type:"Identifier",name:n},arguments:[{type:"Literal",value:e},{type:"Literal",value:t}],optional:!1}}if(typeof DelayNode<"u"){class n extends DelayNode{constructor(t,s,a,r){super(t),s=Math.abs(s),this.delayTime.value=a;const o=t.createGain();o.gain.value=Math.min(Math.abs(r),.995),this.feedback=o.gain;const i=t.createGain();return i.gain.value=s,this.delayGain=i,this.connect(o),this.connect(i),o.connect(this),this.connect=l=>i.connect(l),this}start(t){this.delayGain.gain.setValueAtTime(this.delayGain.gain.value,t+this.delayTime.value)}}AudioContext.prototype.createFeedbackDelay=function(e,t,s){return new n(this,e,t,s)}}var s3={};s3.generateReverb=function(n,e){for(var t=n.audioContext||new AudioContext,s=t.sampleRate,a=n.numChannels||2,r=n.decayTime*1.5,o=Math.round(n.decayTime*s),i=Math.round(r*s),l=Math.round((n.fadeInTime||0)*s),c=Math.pow(1/1e3,1/o),u=t.createBuffer(a,i,s),h=0;h<a;h++){for(var m=u.getChannelData(h),f=0;f<i;f++)m[f]=pke()*Math.pow(c,f);for(var f=0;f<l;f++)m[f]*=f/l}dke(u,n.lpFreqStart||0,n.lpFreqEnd||0,n.decayTime,e)};s3.generateGraph=function(n,e,t,s,a){var r=document.createElement("canvas");r.width=e,r.height=t;var o=r.getContext("2d");o.fillStyle="#000",o.fillRect(0,0,r.width,r.height),o.fillStyle="#fff";for(var i=e/n.length,l=t/(a-s),c=0;c<n.length;c++)o.fillRect(c*i,t-(n[c]-s)*l,1,1);return r};var dke=function(n,e,t,s,a){if(e==0){a(n);return}var r=mke(n),o=new OfflineAudioContext(n.numberOfChannels,r[0].length,n.sampleRate),i=o.createBufferSource();i.buffer=n;var l=o.createBiquadFilter();e=Math.min(e,n.sampleRate/2),t=Math.min(t,n.sampleRate/2),l.type="lowpass",l.Q.value=1e-4,l.frequency.setValueAtTime(e,0),l.frequency.linearRampToValueAtTime(t,s),i.connect(l),l.connect(o.destination),i.start(),o.oncomplete=function(c){a(c.renderedBuffer)},o.startRendering(),window.filterNode=l},mke=function(n){for(var e=[],t=0;t<n.numberOfChannels;t++)e[t]=n.getChannelData(t);return e},pke=function(){return Math.random()*2-1};let DX=n=>console.log(n);function TX(n,e="superdough"){Ma(`[${e}] error: ${n.message}`)}const Ma=(...n)=>DX(...n),FX=n=>{DX=n},fke=n=>{var a;if(typeof n!="string")return[];const[e,t="",s]=((a=n.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/))==null?void 0:a.slice(1))||[];return e?[e,t,s?Number(s):void 0]:[]},gke={c:0,d:2,e:4,f:5,g:7,a:9,b:11},bke={"#":1,b:-1,s:1,f:-1},Mw=(n,e=3)=>{const[t,s,a=e]=fke(n);if(!t)throw new Error('not a note: "'+n+'"');const r=gke[t.toLowerCase()],o=(s==null?void 0:s.split("").reduce((i,l)=>i+bke[l],0))||0;return(Number(a)+1)*12+r+o},NX=n=>Math.pow(2,(n-69)/12)*440,Tu=(n,e,t)=>Math.min(Math.max(n,e),t),yke=n=>12*Math.log(n/440)/Math.LN2+69,vke=(n,e)=>{if(typeof n!="object")throw new Error("valueToMidi: expected object value");let{freq:t,note:s}=n;return typeof t=="number"?yke(t):typeof s=="string"?Mw(s):typeof s=="number"?s:e};function Sc(n,e=0,t){return isNaN(Number(n))?(!t&&Ma(`"${n}" is not a number, falling back to ${e}`,"warning"),e):n}const BX=(n,e)=>(n%e+e)%e,f4=(n,e)=>BX(Math.round(Sc(n,0)),e);function wke(n,e){return n/e}function $X(n,e){const{s:t,n:s=0}=n;let a=vke(n,36),r=a-36,o,i=0;if(Array.isArray(e))i=f4(s,e.length),o=e[i];else{const c=h=>Mw(h)-a,u=Object.keys(e).filter(h=>!h.startsWith("_")).reduce((h,m,f)=>!h||Math.abs(c(m))<Math.abs(c(h))?m:h,null);r=-c(u),i=f4(s,e[u].length),o=e[u][i]}const l=`${t}:${i}`;return{transpose:r,url:o,index:i,midi:a,label:l}}typeof AudioContext<"u"&&(AudioContext.prototype.adjustLength=function(n,e,t=1,s=0){const a=Math.floor(Tu(s,0,1)*e.length),r=e.sampleRate*n,o=this.createBuffer(e.numberOfChannels,e.length,e.sampleRate);for(let i=0;i<e.numberOfChannels;i++){let l=e.getChannelData(i),c=o.getChannelData(i);for(let u=0;u<r;u++){let h=(a+u*Math.abs(t))%l.length;t<1&&(h=h*-1),c[u]=l.at(h)||0}}return o},AudioContext.prototype.createReverb=function(n,e,t,s,a,r,o){const i=this.createConvolver();return i.generate=(l=2,c=.1,u=15e3,h=1e3,m,f,v)=>{i.duration=l,i.fade=c,i.lp=u,i.dim=h,i.ir=m,i.irspeed=f,i.irbegin=v,m?i.buffer=this.adjustLength(l,m,f,v):s3.generateReverb({audioContext:this,numChannels:2,decayTime:l,fadeInTime:c,lpFreqStart:u,lpFreqEnd:h},O=>{i.buffer=O})},i.generate(n,e,t,s,a,r,o),i});var g4={a:{freqs:[660,1120,2750,3e3,3350],gains:[1,.5012,.0708,.0631,.0126],qs:[80,90,120,130,140]},e:{freqs:[440,1800,2700,3e3,3300],gains:[1,.1995,.1259,.1,.1],qs:[70,80,100,120,120]},i:{freqs:[270,1850,2900,3350,3590],gains:[1,.0631,.0631,.0158,.0158],qs:[40,90,100,120,120]},o:{freqs:[430,820,2700,3e3,3300],gains:[1,.3162,.0501,.0794,.01995],qs:[40,80,100,120,120]},u:{freqs:[370,630,2750,3e3,3400],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},ae:{freqs:[650,1515,2400,3e3,3350],gains:[1,.5,.1008,.0631,.0126],qs:[80,90,120,130,140]},aa:{freqs:[560,900,2570,3e3,3300],gains:[1,.5,.0708,.0631,.0126],qs:[80,90,120,130,140]},oe:{freqs:[500,1430,2300,3e3,3300],gains:[1,.2,.0708,.0316,.01995],qs:[40,60,100,120,120]},ue:{freqs:[250,1750,2150,3200,3300],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},y:{freqs:[400,1460,2400,3e3,3300],gains:[1,.2,.0708,.0316,.02995],qs:[40,60,100,120,120]},uh:{freqs:[600,1250,2100,3100,3500],gains:[1,.3,.0608,.0316,.01995],qs:[40,70,100,120,130]},un:{freqs:[500,1240,2280,3e3,3500],gains:[1,.1,.1708,.0216,.02995],qs:[40,60,100,120,120]},en:{freqs:[600,1480,2450,3200,3300],gains:[1,.15,.0708,.0316,.02995],qs:[40,60,100,120,120]},an:{freqs:[700,1050,2500,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},on:{freqs:[500,1080,2350,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},get æ(){return this.ae},get ø(){return this.oe},get ɑ(){return this.aa},get å(){return this.aa},get ö(){return this.oe},get ü(){return this.ue},get ı(){return this.y}};if(typeof GainNode<"u"){class n extends GainNode{constructor(t,s){if(super(t),!g4[s])throw new Error("vowel: unknown vowel "+s);const{gains:a,qs:r,freqs:o}=g4[s],i=t.createGain();for(let l=0;l<5;l++){const c=t.createGain();c.gain.value=a[l];const u=t.createBiquadFilter();u.type="bandpass",u.Q.value=r[l],u.frequency.value=o[l],this.connect(u),u.connect(c),c.connect(i)}return i.gain.value=8,this.connect=l=>i.connect(l),this}}AudioContext.prototype.createVowelFilter=function(e){return new n(this,e)}}const Oke="data:text/javascript;base64,dmFyIF89ZnVuY3Rpb24oQyl7InVzZSBzdHJpY3QiO3ZhciBUZT1PYmplY3QuZGVmaW5lUHJvcGVydHk7dmFyIHllPShDLEQsTCk9PkQgaW4gQz9UZShDLEQse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOkx9KTpDW0RdPUw7dmFyIFN0PShDLEQsTCk9PnllKEMsdHlwZW9mIEQhPSJzeW1ib2wiP0QrIiI6RCxMKTtjbGFzcyBMIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuc3RhcnRlZD0hMSx0aGlzLm5iSW5wdXRzPXQubnVtYmVyT2ZJbnB1dHMsdGhpcy5uYk91dHB1dHM9dC5udW1iZXJPZk91dHB1dHMsdGhpcy5ibG9ja1NpemU9dC5wcm9jZXNzb3JPcHRpb25zLmJsb2NrU2l6ZSx0aGlzLmhvcFNpemU9MTI4LHRoaXMubmJPdmVybGFwcz10aGlzLmJsb2NrU2l6ZS90aGlzLmhvcFNpemUsdGhpcy5pbnB1dEJ1ZmZlcnM9bmV3IEFycmF5KHRoaXMubmJJbnB1dHMpLHRoaXMuaW5wdXRCdWZmZXJzSGVhZD1uZXcgQXJyYXkodGhpcy5uYklucHV0cyksdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQ9bmV3IEFycmF5KHRoaXMubmJJbnB1dHMpO2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspdGhpcy5hbGxvY2F0ZUlucHV0Q2hhbm5lbHMoZSwxKTt0aGlzLm91dHB1dEJ1ZmZlcnM9bmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKSx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlPW5ldyBBcnJheSh0aGlzLm5iT3V0cHV0cyk7Zm9yKGxldCBlPTA7ZTx0aGlzLm5iT3V0cHV0cztlKyspdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGUsMSl9cmVhbGxvY2F0ZUNoYW5uZWxzSWZOZWVkZWQodCxlKXtmb3IobGV0IHM9MDtzPHRoaXMubmJJbnB1dHM7cysrKXtsZXQgcj10W3NdLmxlbmd0aDtyIT10aGlzLmlucHV0QnVmZmVyc1tzXS5sZW5ndGgmJnRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKHMscil9Zm9yKGxldCBzPTA7czx0aGlzLm5iT3V0cHV0cztzKyspe2xldCByPWVbc10ubGVuZ3RoO3IhPXRoaXMub3V0cHV0QnVmZmVyc1tzXS5sZW5ndGgmJnRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhzLHIpfX1hbGxvY2F0ZUlucHV0Q2hhbm5lbHModCxlKXt0aGlzLmlucHV0QnVmZmVyc1t0XT1uZXcgQXJyYXkoZSk7Zm9yKGxldCBzPTA7czxlO3MrKyl0aGlzLmlucHV0QnVmZmVyc1t0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKzEyOCksdGhpcy5pbnB1dEJ1ZmZlcnNbdF1bc10uZmlsbCgwKTt0aGlzLmlucHV0QnVmZmVyc0hlYWRbdF09bmV3IEFycmF5KGUpLHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMuaW5wdXRCdWZmZXJzSGVhZFt0XVtzXT10aGlzLmlucHV0QnVmZmVyc1t0XVtzXS5zdWJhcnJheSgwLHRoaXMuYmxvY2tTaXplKSx0aGlzLmlucHV0QnVmZmVyc1RvU2VuZFt0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKX1hbGxvY2F0ZU91dHB1dENoYW5uZWxzKHQsZSl7dGhpcy5vdXRwdXRCdWZmZXJzW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMub3V0cHV0QnVmZmVyc1t0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKSx0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bc10uZmlsbCgwKTt0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF1bc109bmV3IEZsb2F0MzJBcnJheSh0aGlzLmJsb2NrU2l6ZSksdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVt0XVtzXS5maWxsKDApfXJlYWRJbnB1dHModCl7aWYodFswXS5sZW5ndGgmJnRbMF1bMF0ubGVuZ3RoPT0wKXtmb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl0aGlzLmlucHV0QnVmZmVyc1tlXVtzXS5maWxsKDAsdGhpcy5ibG9ja1NpemUpO3JldHVybn1mb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl7bGV0IHI9dFtlXVtzXTt0aGlzLmlucHV0QnVmZmVyc1tlXVtzXS5zZXQocix0aGlzLmJsb2NrU2l6ZSl9fXdyaXRlT3V0cHV0cyh0KXtmb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl7bGV0IHI9dGhpcy5vdXRwdXRCdWZmZXJzW2VdW3NdLnN1YmFycmF5KDAsMTI4KTt0W2VdW3NdLnNldChyKX19c2hpZnRJbnB1dEJ1ZmZlcnMoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJJbnB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5pbnB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKyl0aGlzLmlucHV0QnVmZmVyc1t0XVtlXS5jb3B5V2l0aGluKDAsMTI4KX1zaGlmdE91dHB1dEJ1ZmZlcnMoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJPdXRwdXRzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMub3V0cHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMub3V0cHV0QnVmZmVyc1t0XVtlXS5jb3B5V2l0aGluKDAsMTI4KSx0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bZV0uc3ViYXJyYXkodGhpcy5ibG9ja1NpemUtMTI4KS5maWxsKDApfXByZXBhcmVJbnB1dEJ1ZmZlcnNUb1NlbmQoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJJbnB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5pbnB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKyl0aGlzLmlucHV0QnVmZmVyc1RvU2VuZFt0XVtlXS5zZXQodGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW3RdW2VdKX1oYW5kbGVPdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSgpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYk91dHB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5vdXRwdXRCdWZmZXJzW3RdLmxlbmd0aDtlKyspZm9yKGxldCBzPTA7czx0aGlzLmJsb2NrU2l6ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW2VdW3NdKz10aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdW2VdW3NdL3RoaXMubmJPdmVybGFwc31wcm9jZXNzKHQsZSxzKXtjb25zdCBpPXRbMF1bMF0hPT12b2lkIDA7cmV0dXJuIHRoaXMuc3RhcnRlZCYmIWk/ITE6KHRoaXMuc3RhcnRlZD1pLHRoaXMucmVhbGxvY2F0ZUNoYW5uZWxzSWZOZWVkZWQodCxlKSx0aGlzLnJlYWRJbnB1dHModCksdGhpcy5zaGlmdElucHV0QnVmZmVycygpLHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpLHRoaXMucHJvY2Vzc09MQSh0aGlzLmlucHV0QnVmZmVyc1RvU2VuZCx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlLHMpLHRoaXMuaGFuZGxlT3V0cHV0QnVmZmVyc1RvUmV0cmlldmUoKSx0aGlzLndyaXRlT3V0cHV0cyhlKSx0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpLCEwKX1wcm9jZXNzT0xBKHQsZSxzKXtjb25zb2xlLmFzc2VydCghMSwiTm90IG92ZXJyaWRlbiIpfX1jbGFzcyBrdHtjb25zdHJ1Y3Rvcih0KXtpZih0aGlzLnNpemU9dHwwLHRoaXMuc2l6ZTw9MXx8dGhpcy5zaXplJnRoaXMuc2l6ZS0xKXRocm93IG5ldyBFcnJvcigiRkZUIHNpemUgbXVzdCBiZSBhIHBvd2VyIG9mIHR3byBhbmQgYmlnZ2VyIHRoYW4gMSIpO3RoaXMuX2NzaXplPXQ8PDE7Zm9yKHZhciBlPW5ldyBBcnJheSh0aGlzLnNpemUqMikscz0wO3M8ZS5sZW5ndGg7cys9Mil7Y29uc3QgYz1NYXRoLlBJKnMvdGhpcy5zaXplO2Vbc109TWF0aC5jb3MoYyksZVtzKzFdPS1NYXRoLnNpbihjKX10aGlzLnRhYmxlPWU7Zm9yKHZhciByPTAsaT0xO3RoaXMuc2l6ZT5pO2k8PD0xKXIrKzt0aGlzLl93aWR0aD1yJTI9PT0wP3ItMTpyLHRoaXMuX2JpdHJldj1uZXcgQXJyYXkoMTw8dGhpcy5fd2lkdGgpO2Zvcih2YXIgbz0wO288dGhpcy5fYml0cmV2Lmxlbmd0aDtvKyspe3RoaXMuX2JpdHJldltvXT0wO2Zvcih2YXIgYT0wO2E8dGhpcy5fd2lkdGg7YSs9Mil7dmFyIHU9dGhpcy5fd2lkdGgtYS0yO3RoaXMuX2JpdHJldltvXXw9KG8+Pj5hJjMpPDx1fX10aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGwsdGhpcy5faW52PTB9ZnJvbUNvbXBsZXhBcnJheSh0LGUpe2Zvcih2YXIgcz1lfHxuZXcgQXJyYXkodC5sZW5ndGg+Pj4xKSxyPTA7cjx0Lmxlbmd0aDtyKz0yKXNbcj4+PjFdPXRbcl07cmV0dXJuIHN9Y3JlYXRlQ29tcGxleEFycmF5KCl7Y29uc3QgdD1uZXcgQXJyYXkodGhpcy5fY3NpemUpO2Zvcih2YXIgZT0wO2U8dC5sZW5ndGg7ZSsrKXRbZV09MDtyZXR1cm4gdH10b0NvbXBsZXhBcnJheSh0LGUpe2Zvcih2YXIgcz1lfHx0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpLHI9MDtyPHMubGVuZ3RoO3IrPTIpc1tyXT10W3I+Pj4xXSxzW3IrMV09MDtyZXR1cm4gc31jb21wbGV0ZVNwZWN0cnVtKHQpe2Zvcih2YXIgZT10aGlzLl9jc2l6ZSxzPWU+Pj4xLHI9MjtyPHM7cis9Mil0W2Utcl09dFtyXSx0W2UtcisxXT0tdFtyKzFdfXRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0wLHRoaXMuX3RyYW5zZm9ybTQoKSx0aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGx9cmVhbFRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0wLHRoaXMuX3JlYWxUcmFuc2Zvcm00KCksdGhpcy5fb3V0PW51bGwsdGhpcy5fZGF0YT1udWxsfWludmVyc2VUcmFuc2Zvcm0odCxlKXtpZih0PT09ZSl0aHJvdyBuZXcgRXJyb3IoIklucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCIpO3RoaXMuX291dD10LHRoaXMuX2RhdGE9ZSx0aGlzLl9pbnY9MSx0aGlzLl90cmFuc2Zvcm00KCk7Zm9yKHZhciBzPTA7czx0Lmxlbmd0aDtzKyspdFtzXS89dGhpcy5zaXplO3RoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbH1fdHJhbnNmb3JtNCgpe3ZhciB0PXRoaXMuX291dCxlPXRoaXMuX2NzaXplLHM9dGhpcy5fd2lkdGgscj0xPDxzLGk9ZS9yPDwxLG8sYSx1PXRoaXMuX2JpdHJldjtpZihpPT09NClmb3Iobz0wLGE9MDtvPGU7bys9aSxhKyspe2NvbnN0IGQ9dVthXTt0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKG8sZCxyKX1lbHNlIGZvcihvPTAsYT0wO288ZTtvKz1pLGErKyl7Y29uc3QgZD11W2FdO3RoaXMuX3NpbmdsZVRyYW5zZm9ybTQobyxkLHIpfXZhciBjPXRoaXMuX2ludj8tMToxLGg9dGhpcy50YWJsZTtmb3Iocj4+PTI7cj49MjtyPj49Mil7aT1lL3I8PDE7dmFyIGY9aT4+PjI7Zm9yKG89MDtvPGU7bys9aSlmb3IodmFyIHA9bytmLGw9byxtPTA7bDxwO2wrPTIsbSs9cil7Y29uc3QgZD1sLGI9ZCtmLEk9YitmLHY9SStmLFA9dFtkXSx3PXRbZCsxXSxUPXRbYl0sQj10W2IrMV0sQT10W0ldLHk9dFtJKzFdLE89dFt2XSxxPXRbdisxXSx4PVAsRT13LE49aFttXSxGPWMqaFttKzFdLFY9VCpOLUIqRixrPVQqRitCKk4sUj1oWzIqbV0sWD1jKmhbMiptKzFdLHR0PUEqUi15KlgsZXQ9QSpYK3kqUixzdD1oWzMqbV0scnQ9YypoWzMqbSsxXSxudD1PKnN0LXEqcnQsaXQ9TypydCtxKnN0LG90PXgrdHQsSz1FK2V0LGo9eC10dCxhdD1FLWV0LGN0PVYrbnQsWj1rK2l0LCQ9YyooVi1udCksdXQ9Yyooay1pdCksbHQ9b3QrY3QsZ3Q9SytaLGJ0PW90LWN0LEl0PUstWixfdD1qK3V0LEJ0PWF0LSQsTXQ9ai11dCxQdD1hdCskO3RbZF09bHQsdFtkKzFdPWd0LHRbYl09X3QsdFtiKzFdPUJ0LHRbSV09YnQsdFtJKzFdPUl0LHRbdl09TXQsdFt2KzFdPVB0fX19X3NpbmdsZVRyYW5zZm9ybTIodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LGk9dGhpcy5fZGF0YSxvPWlbZV0sYT1pW2UrMV0sdT1pW2Urc10sYz1pW2UrcysxXSxoPW8rdSxmPWErYyxwPW8tdSxsPWEtYztyW3RdPWgsclt0KzFdPWYsclt0KzJdPXAsclt0KzNdPWx9X3NpbmdsZVRyYW5zZm9ybTQodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LGk9dGhpcy5fZGF0YSxvPXRoaXMuX2ludj8tMToxLGE9cyoyLHU9cyozLGM9aVtlXSxoPWlbZSsxXSxmPWlbZStzXSxwPWlbZStzKzFdLGw9aVtlK2FdLG09aVtlK2ErMV0sZD1pW2UrdV0sYj1pW2UrdSsxXSxJPWMrbCx2PWgrbSxQPWMtbCx3PWgtbSxUPWYrZCxCPXArYixBPW8qKGYtZCkseT1vKihwLWIpLE89SStULHE9ditCLHg9UCt5LEU9dy1BLE49SS1ULEY9di1CLFY9UC15LGs9dytBO3JbdF09TyxyW3QrMV09cSxyW3QrMl09eCxyW3QrM109RSxyW3QrNF09TixyW3QrNV09RixyW3QrNl09VixyW3QrN109a31fcmVhbFRyYW5zZm9ybTQoKXt2YXIgdD10aGlzLl9vdXQsZT10aGlzLl9jc2l6ZSxzPXRoaXMuX3dpZHRoLHI9MTw8cyxpPWUvcjw8MSxvLGEsdT10aGlzLl9iaXRyZXY7aWYoaT09PTQpZm9yKG89MCxhPTA7bzxlO28rPWksYSsrKXtjb25zdCB3dD11W2FdO3RoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm0yKG8sd3Q+Pj4xLHI+Pj4xKX1lbHNlIGZvcihvPTAsYT0wO288ZTtvKz1pLGErKyl7Y29uc3Qgd3Q9dVthXTt0aGlzLl9zaW5nbGVSZWFsVHJhbnNmb3JtNChvLHd0Pj4+MSxyPj4+MSl9dmFyIGM9dGhpcy5faW52Py0xOjEsaD10aGlzLnRhYmxlO2ZvcihyPj49MjtyPj0yO3I+Pj0yKXtpPWUvcjw8MTt2YXIgZj1pPj4+MSxwPWY+Pj4xLGw9cD4+PjE7Zm9yKG89MDtvPGU7bys9aSlmb3IodmFyIG09MCxkPTA7bTw9bDttKz0yLGQrPXIpe3ZhciBiPW8rbSxJPWIrcCx2PUkrcCxQPXYrcCx3PXRbYl0sVD10W2IrMV0sQj10W0ldLEE9dFtJKzFdLHk9dFt2XSxPPXRbdisxXSxxPXRbUF0seD10W1ArMV0sRT13LE49VCxGPWhbZF0sVj1jKmhbZCsxXSxrPUIqRi1BKlYsUj1CKlYrQSpGLFg9aFsyKmRdLHR0PWMqaFsyKmQrMV0sZXQ9eSpYLU8qdHQsc3Q9eSp0dCtPKlgscnQ9aFszKmRdLG50PWMqaFszKmQrMV0saXQ9cSpydC14Km50LG90PXEqbnQreCpydCxLPUUrZXQsaj1OK3N0LGF0PUUtZXQsY3Q9Ti1zdCxaPWsraXQsJD1SK290LHV0PWMqKGstaXQpLGx0PWMqKFItb3QpLGd0PUsrWixidD1qKyQsSXQ9YXQrbHQsX3Q9Y3QtdXQ7aWYodFtiXT1ndCx0W2IrMV09YnQsdFtJXT1JdCx0W0krMV09X3QsbT09PTApe3ZhciBCdD1LLVosTXQ9ai0kO3Rbdl09QnQsdFt2KzFdPU10O2NvbnRpbnVlfWlmKG0hPT1sKXt2YXIgUHQ9YXQsbWU9LWN0LHZlPUssZ2U9LWosYmU9LWMqbHQsSWU9LWMqdXQsX2U9LWMqJCxCZT0tYypaLE1lPVB0K2JlLFBlPW1lK0llLHdlPXZlK0JlLFNlPWdlLV9lLEN0PW8rcC1tLEV0PW8rZi1tO3RbQ3RdPU1lLHRbQ3QrMV09UGUsdFtFdF09d2UsdFtFdCsxXT1TZX19fX1fc2luZ2xlUmVhbFRyYW5zZm9ybTIodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LGk9dGhpcy5fZGF0YSxvPWlbZV0sYT1pW2Urc10sdT1vK2EsYz1vLWE7clt0XT11LHJbdCsxXT0wLHJbdCsyXT1jLHJbdCszXT0wfV9zaW5nbGVSZWFsVHJhbnNmb3JtNCh0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsaT10aGlzLl9kYXRhLG89dGhpcy5faW52Py0xOjEsYT1zKjIsdT1zKjMsYz1pW2VdLGg9aVtlK3NdLGY9aVtlK2FdLHA9aVtlK3VdLGw9YytmLG09Yy1mLGQ9aCtwLGI9byooaC1wKSxJPWwrZCx2PW0sUD0tYix3PWwtZCxUPW0sQj1iO3JbdF09SSxyW3QrMV09MCxyW3QrMl09dixyW3QrM109UCxyW3QrNF09dyxyW3QrNV09MCxyW3QrNl09VCxyW3QrN109Qn19bGV0IER0PW49PmNvbnNvbGUubG9nKG4pO2NvbnN0IHp0PSguLi5uKT0+RHQoLi4ubikscXQ9KG4sdCxlKT0+TWF0aC5taW4oTWF0aC5tYXgobix0KSxlKSxUdD1uPT5uLygxK24pLFd0PShuLHQpPT4obiV0K3QpJXQsTHQ9KG4sdCk9PigxK3QpKm4vKDErdCpNYXRoLmFicyhuKSksWT0obix0KT0+TWF0aC50YW5oKG4qKDErdCkpLFl0PShuLHQpPT5xdCgoMSt0KSpuLC0xLDEpLHl0PShuLHQpPT57bGV0IGU9KDErLjUqdCkqbjtjb25zdCBzPVd0KGUrMSw0KTtyZXR1cm4gMS1NYXRoLmFicyhzLTIpfSxIdD0obix0KT0+TWF0aC5zaW4oTWF0aC5QSS8yKnl0KG4sdCkpLFV0PShuLHQpPT57Y29uc3QgZT1UdChNYXRoLmxvZzFwKHQpKSxzPShuLWUvMypuKm4qbikvKDEtZS8zKTtyZXR1cm4gWShzLHQpfSxBdD0obix0LGU9ITEpPT57Y29uc3Qgcz0xKzIqdCxpPS4wNypUdChNYXRoLmxvZzFwKHQpKSxvPVkobitpLDIqdCksYT1ZKGU/aTotbitpLDIqdCksdT1vLWEsYz0xL01hdGguY29zaChzKmkpLGg9YypjLGY9TWF0aC5tYXgoMWUtOCwoZT8xOjIpKnMqaCk7cmV0dXJuIFkodS9mLHQpfSxPdD17c2N1cnZlOkx0LHNvZnQ6WSxoYXJkOll0LGN1YmljOlV0LGRpb2RlOkF0LGFzeW06KG4sdCk9PkF0KG4sdCwhMCksZm9sZDp5dCxzaW5lZm9sZDpIdCxjaGVieXNoZXY6KG4sdCk9Pntjb25zdCBlPTEwKk1hdGgubG9nMXAodCk7bGV0IHM9MSxyPW4saSxvPTA7Zm9yKGxldCBhPTE7YTw2NDthKyspe2lmKGE8Mil7bys9YT09MD9zOnI7Y29udGludWV9aT0yKm4qcy1yLHI9cyxzPWksYSUyPT09MCYmKG8rPU1hdGgubWluKDEuMyplL2EsMikqaSl9cmV0dXJuIFkobyxlLzIwKX19LEc9T2JqZWN0LmZyZWV6ZShPYmplY3Qua2V5cyhPdCkpLEt0PW49PntsZXQgdD1uO3R5cGVvZiBuPT0ic3RyaW5nIiYmKHQ9Ry5pbmRleE9mKG4pLHQ9PT0tMSYmKHp0KGBbc3VwZXJkb3VnaF0gQ291bGQgbm90IGZpbmQgd2F2ZXNoYXBpbmcgYWxnb3JpdGhtICR7bn0uCiAgICAgICAgQXZhaWxhYmxlIG9wdGlvbnMgYXJlICR7Ry5qb2luKCIsICIpfS4KICAgICAgICBEZWZhdWx0aW5nIHRvICR7R1swXX0uYCksdD0wKSk7Y29uc3QgZT1HW3QlRy5sZW5ndGhdO3JldHVybiBPdFtlXX0sTT0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLHh0PShuLHQpPT4obiV0K3QpJXQsanQ9KG4sdCxlKT0+ZSoodC1uKStuLFM9KG4sdCk9Pm5bdF0/P25bMF0sVz1uPT5uLU1hdGguZmxvb3IobiksZnQ9bj0+bnwwLE50PShuLHQsZSk9Pm48Mj8wOmp0KC10Ki41LHQqLjUsZS8obi0xKSksSD0obix0KT0+bipNYXRoLnBvdygyLHQvMTIpO2Z1bmN0aW9uIEZ0KG4sdD0xKXtyZXR1cm4gbj49dD9uLT10Om48MCYmKG4rPXQpLG59Y29uc3QgVT0xMjg7ZnVuY3Rpb24gWnQobix0KXtyZXR1cm4gdD1NYXRoLm1pbih0LDEtdCksbjx0PyhuLz10LG4rbi1uKm4tMSk6bj4xLXQ/KG49KG4tMSkvdCxuKm4rbituKzEpOjB9Y29uc3QgcHQ9e3RyaShuLHQ9LjUpe2NvbnN0IGU9MS10O3JldHVybiBuPj10PzEvZS1uL2U6bi90fSxzaW5lKG4pe3JldHVybiBNYXRoLnNpbihNYXRoLlBJKjIqbikqLjUrLjV9LHJhbXAobil7cmV0dXJuIG59LHNhdyhuKXtyZXR1cm4gMS1ufSxzcXVhcmUobix0PS41KXtyZXR1cm4gbj49dD8wOjF9LGN1c3RvbShuLHQ9WzAsMV0pe2NvbnN0IGU9dC5sZW5ndGgtMSxzPU1hdGguZmxvb3IobiplKSxyPTEvZSxpPU0odFtzXSwwLDEpLGE9TSh0W3MrMV0sMCwxKSx1PWksYz0wLGg9cjtyZXR1cm4oYS11KS8oaC1jKSoobi1yKnMpK2l9LHNhd2JsZXAobix0KXtyZXR1cm4gMipuLTEtWnQobix0KX19O2Z1bmN0aW9uIFEobix0KXtyZXR1cm4gdC5sZW5ndGg+MT90W25dOnRbMF19Y29uc3QgJHQ9T2JqZWN0LmtleXMocHQpO2NsYXNzIEd0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MH0se25hbWU6InRpbWUiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOi41fSx7bmFtZToic2tldyIsZGVmYXVsdFZhbHVlOi41fSx7bmFtZToiZGVwdGgiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToicGhhc2VvZmZzZXQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToic2hhcGUiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToiY3VydmUiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToiZGNvZmZzZXQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToibWluIixkZWZhdWx0VmFsdWU6MH0se25hbWU6Im1heCIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waGFzZX1pbmNyZW1lbnRQaGFzZSh0KXt0aGlzLnBoYXNlKz10LHRoaXMucGhhc2U+MSYmKHRoaXMucGhhc2U9dGhpcy5waGFzZS0xKX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXMuYmVnaW5bMF07aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2lmKGN1cnJlbnRUaW1lPD1yKXJldHVybiEwO2NvbnN0IGk9ZVswXSxvPXMuZnJlcXVlbmN5WzBdLGE9cy50aW1lWzBdLHU9cy5kZXB0aFswXSxjPXMuc2tld1swXSxoPXMucGhhc2VvZmZzZXRbMF0sZj1zLmN1cnZlWzBdLHA9cy5kY29mZnNldFswXSxsPXMubWluWzBdLG09cy5tYXhbMF0sZD0kdFtzLnNoYXBlWzBdXSxiPWlbMF0ubGVuZ3RoPz8wO3RoaXMucGhhc2U9PW51bGwmJih0aGlzLnBoYXNlPXh0KGEqbytoLDEpKTtjb25zdCBJPW8vc2FtcGxlUmF0ZTtmb3IobGV0IHY9MDt2PGI7disrKXtmb3IobGV0IFA9MDtQPGkubGVuZ3RoO1ArKyl7bGV0IHc9KHB0W2RdKHRoaXMucGhhc2UsYykrcCkqdTt3PU1hdGgucG93KHcsZiksaVtQXVt2XT1NKHcsbCxtKX10aGlzLmluY3JlbWVudFBoYXNlKEkpfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigibGZvLXByb2Nlc3NvciIsR3QpO2NsYXNzIFF0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImNvYXJzZSIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIW8pcmV0dXJuITE7dGhpcy5zdGFydGVkPW87bGV0IGE9cy5jb2Fyc2VbMF0/PzA7YT1NYXRoLm1heCgxLGEpO2ZvcihsZXQgdT0wO3U8VTt1KyspZm9yKGxldCBjPTA7YzxyLmxlbmd0aDtjKyspaVtjXVt1XT11JWE9PT0wP3JbY11bdV06aVtjXVt1LTFdO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiY29hcnNlLXByb2Nlc3NvciIsUXQpO2NsYXNzIEp0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImNydXNoIixkZWZhdWx0VmFsdWU6MH1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITF9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLGk9ZVswXSxvPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhbylyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9bztsZXQgYT1zLmNydXNoWzBdPz84O2E9TWF0aC5tYXgoMSxhKTtmb3IobGV0IHU9MDt1PFU7dSsrKWZvcihsZXQgYz0wO2M8ci5sZW5ndGg7YysrKXtjb25zdCBoPU1hdGgucG93KDIsYS0xKTtpW2NdW3VdPU1hdGgucm91bmQocltjXVt1XSpoKS9ofXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiY3J1c2gtcHJvY2Vzc29yIixKdCk7Y2xhc3MgWHQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToic2hhcGUiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToicG9zdGdhaW4iLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuc3RhcnRlZD0hMX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2xldCBhPXMuc2hhcGVbMF07YT1hPDE/YTouOTk5OTk5OTk5NixhPTIqYS8oMS1hKTtjb25zdCB1PU1hdGgubWF4KC4wMDEsTWF0aC5taW4oMSxzLnBvc3RnYWluWzBdKSk7Zm9yKGxldCBjPTA7YzxVO2MrKylmb3IobGV0IGg9MDtoPHIubGVuZ3RoO2grKylpW2hdW2NdPSgxK2EpKnJbaF1bY10vKDErYSpNYXRoLmFicyhyW2hdW2NdKSkqdTtyZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoInNoYXBlLXByb2Nlc3NvciIsWHQpO2NsYXNzIFZ0e2NvbnN0cnVjdG9yKCl7U3QodGhpcywiczAiLDApO1N0KHRoaXMsInMxIiwwKX11cGRhdGUodCxlLHM9MCl7cz1NKHMsMCwxKSxlPU0oZSwwLHNhbXBsZVJhdGUvMi0xKTtjb25zdCByPU0oMipNYXRoLnNpbihlKihkdC9zYW1wbGVSYXRlKSksMCwxLjE0KSxvPTEtTWF0aC5wb3coLjUsKHMrLjEyNSkvLjEyNSkqcjtyZXR1cm4gdGhpcy5zMD1vKnRoaXMuczAtcip0aGlzLnMxK3IqdCx0aGlzLnMxPW8qdGhpcy5zMStyKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgdGUgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToidmFsdWUiLGRlZmF1bHRWYWx1ZTouNX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLmZpbHRlcnM9W25ldyBWdCxuZXcgVnRdfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO3RoaXMuc3RhcnRlZD1vO2NvbnN0IGE9TShzLnZhbHVlWzBdLDAsMSk7bGV0IHU9Im5vbmUiLGMsaD0xO2E+LjUxPyh1PSJoaXBhc3MiLGg9KGEtLjUpKjIpOmE8LjQ5JiYodT0ibG9wYXNzIixoPWEqMiksYz1NYXRoLnBvdyhoKjExLDQpO2ZvcihsZXQgZj0wO2Y8ci5sZW5ndGg7ZisrKWZvcihsZXQgcD0wO3A8VTtwKyspdT09Im5vbmUiP2lbZl1bcF09cltmXVtwXToodGhpcy5maWx0ZXJzW2ZdLnVwZGF0ZShyW2ZdW3BdLGMsLjEpLHU9PT0ibG9wYXNzIj9pW2ZdW3BdPXRoaXMuZmlsdGVyc1tmXS5zMTp1PT09ImhpcGFzcyI/aVtmXVtwXT1yW2ZdW3BdLXRoaXMuZmlsdGVyc1tmXS5zMTppW2ZdW3BdPXJbZl1bcF0pO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGpmLXByb2Nlc3NvciIsdGUpO2Z1bmN0aW9uIHoobil7Y29uc3QgdD1uKm47cmV0dXJuIG4qKDI3K3QpLygyNys5KnQpfWNvbnN0IGR0PTMuMTQxNTkyNjUzNTk7Y2xhc3MgZWUgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NTAwfSx7bmFtZToicSIsZGVmYXVsdFZhbHVlOjF9LHtuYW1lOiJkcml2ZSIsZGVmYXVsdFZhbHVlOi42OX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITEsdGhpcy5wMD1bMCwwXSx0aGlzLnAxPVswLDBdLHRoaXMucDI9WzAsMF0sdGhpcy5wMz1bMCwwXSx0aGlzLnAzMj1bMCwwXSx0aGlzLnAzMz1bMCwwXSx0aGlzLnAzND1bMCwwXX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0saT1lWzBdLG89clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFvKXJldHVybiExO3RoaXMuc3RhcnRlZD1vO2NvbnN0IGE9cy5xWzBdLHU9TShNYXRoLmV4cChzLmRyaXZlWzBdKSwuMSwyZTMpO2xldCBjPXMuZnJlcXVlbmN5WzBdO2M9YyoyKmR0L3NhbXBsZVJhdGUsYz1jPjE/MTpjO2NvbnN0IGg9TWF0aC5taW4oOCxhKi4xMyk7bGV0IGY9MS91Kk1hdGgubWluKDEuNzUsMStoKTtmb3IobGV0IHA9MDtwPFU7cCsrKWZvcihsZXQgbD0wO2w8ci5sZW5ndGg7bCsrKXtjb25zdCBtPXRoaXMucDNbbF0qLjM2MDg5MSt0aGlzLnAzMltsXSouNDE3MjkrdGhpcy5wMzNbbF0qLjE3Nzg5Nit0aGlzLnAzNFtsXSouMDQzOTcyNTt0aGlzLnAzNFtsXT10aGlzLnAzM1tsXSx0aGlzLnAzM1tsXT10aGlzLnAzMltsXSx0aGlzLnAzMltsXT10aGlzLnAzW2xdLHRoaXMucDBbbF0rPSh6KHJbbF1bcF0qdS1oKm0pLXoodGhpcy5wMFtsXSkpKmMsdGhpcy5wMVtsXSs9KHoodGhpcy5wMFtsXSkteih0aGlzLnAxW2xdKSkqYyx0aGlzLnAyW2xdKz0oeih0aGlzLnAxW2xdKS16KHRoaXMucDJbbF0pKSpjLHRoaXMucDNbbF0rPSh6KHRoaXMucDJbbF0pLXoodGhpcy5wM1tsXSkpKmMsaVtsXVtwXT1tKmZ9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJsYWRkZXItcHJvY2Vzc29yIixlZSk7Y2xhc3Mgc2UgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiZGlzdG9ydCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJwb3N0Z2FpbiIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcih7cHJvY2Vzc29yT3B0aW9uczp0fSl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITEsdGhpcy5hbGdvcml0aG09S3QodC5hbGdvcml0aG0pfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxpPWVbMF0sbz1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIW8pcmV0dXJuITE7dGhpcy5zdGFydGVkPW87Zm9yKGxldCBhPTA7YTxVO2ErKyl7Y29uc3QgdT1NKFMocy5wb3N0Z2FpbixhKSwuMDAxLDEpLGM9TWF0aC5leHBtMShTKHMuZGlzdG9ydCxhKSk7Zm9yKGxldCBoPTA7aDxyLmxlbmd0aDtoKyspe2NvbnN0IGY9cltoXVthXTtpW2hdW2FdPXUqdGhpcy5hbGdvcml0aG0oZixjKX19cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJkaXN0b3J0LXByb2Nlc3NvciIsc2UpO2NsYXNzIHJlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnBoYXNlPVtdfXN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG1pbjowfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG1pbjowfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6InBhbnNwcmVhZCIsZGVmYXVsdFZhbHVlOi40LG1pbjowLG1heDoxfSx7bmFtZToiZnJlcXNwcmVhZCIsZGVmYXVsdFZhbHVlOi4yLG1pbjowfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46MH0se25hbWU6InZvaWNlcyIsZGVmYXVsdFZhbHVlOjUsbWluOjF9XX1wcm9jZXNzKHQsZSxzKXtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7Y29uc3Qgcj1lWzBdO2ZvcihsZXQgaT0wO2k8clswXS5sZW5ndGg7aSsrKXtjb25zdCBvPVMocy5kZXR1bmUsaSksYT1TKHMudm9pY2VzLGkpLHU9UyhzLmZyZXFzcHJlYWQsaSksYz1TKHMucGFuc3ByZWFkLGkpKi41Ky41LGg9TWF0aC5zcXJ0KDEtYyksZj1NYXRoLnNxcnQoYyk7bGV0IHA9UyhzLmZyZXF1ZW5jeSxpKTtwPUgocCxvLzEwMCk7Zm9yKGxldCBsPTA7bDxhO2wrKyl7Y29uc3QgbT0obCYxKT09MTtsZXQgZD1oLGI9ZjttJiYoZD1mLGI9aCk7Y29uc3QgST1IKHAsTnQoYSx1LGwpKSx2PXh0KEkvc2FtcGxlUmF0ZSwxKTt0aGlzLnBoYXNlW2xdPXRoaXMucGhhc2VbbF0/P01hdGgucmFuZG9tKCk7Y29uc3QgUD1wdC5zYXdibGVwKHRoaXMucGhhc2VbbF0sdik7clswXVtpXT1yWzBdW2ldK1AqZCxyWzFdW2ldPXJbMV1baV0rUCpiLHRoaXMucGhhc2VbbF09RnQodGhpcy5waGFzZVtsXSt2KX19cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJzdXBlcnNhdy1vc2NpbGxhdG9yIixyZSk7Y29uc3QgbmU9MjA0ODtmdW5jdGlvbiBpZShuKXtsZXQgdD1uZXcgRmxvYXQzMkFycmF5KG4pO2Zvcih2YXIgZT0wO2U8bjtlKyspdFtlXT0uNSooMS1NYXRoLmNvcygyKk1hdGguUEkqZS9uKSk7cmV0dXJuIHR9Y2xhc3Mgb2UgZXh0ZW5kcyBMe3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6InBpdGNoRmFjdG9yIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKHQpe3QucHJvY2Vzc29yT3B0aW9ucz17YmxvY2tTaXplOm5lfSxzdXBlcih0KSx0aGlzLmZmdFNpemU9dGhpcy5ibG9ja1NpemUsdGhpcy50aW1lQ3Vyc29yPTAsdGhpcy5oYW5uV2luZG93PWllKHRoaXMuYmxvY2tTaXplKSx0aGlzLmZmdD1uZXcga3QodGhpcy5mZnRTaXplKSx0aGlzLmZyZXFDb21wbGV4QnVmZmVyPXRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpLHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkPXRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpLHRoaXMudGltZUNvbXBsZXhCdWZmZXI9dGhpcy5mZnQuY3JlYXRlQ29tcGxleEFycmF5KCksdGhpcy5tYWduaXR1ZGVzPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5mZnRTaXplLzIrMSksdGhpcy5wZWFrSW5kZXhlcz1uZXcgSW50MzJBcnJheSh0aGlzLm1hZ25pdHVkZXMubGVuZ3RoKSx0aGlzLm5iUGVha3M9MH1wcm9jZXNzT0xBKHQsZSxzKXtsZXQgcj1zLnBpdGNoRmFjdG9yW3MucGl0Y2hGYWN0b3IubGVuZ3RoLTFdO3I8MCYmKHI9ciouMjUpLHI9TWF0aC5tYXgoMCxyKzEpO2Zvcih2YXIgaT0wO2k8dGhpcy5uYklucHV0cztpKyspZm9yKHZhciBvPTA7bzx0W2ldLmxlbmd0aDtvKyspe3ZhciBhPXRbaV1bb10sdT1lW2ldW29dO3RoaXMuYXBwbHlIYW5uV2luZG93KGEpLHRoaXMuZmZ0LnJlYWxUcmFuc2Zvcm0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlcixhKSx0aGlzLmNvbXB1dGVNYWduaXR1ZGVzKCksdGhpcy5maW5kUGVha3MoKSx0aGlzLnNoaWZ0UGVha3MociksdGhpcy5mZnQuY29tcGxldGVTcGVjdHJ1bSh0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCksdGhpcy5mZnQuaW52ZXJzZVRyYW5zZm9ybSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLHRoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkKSx0aGlzLmZmdC5mcm9tQ29tcGxleEFycmF5KHRoaXMudGltZUNvbXBsZXhCdWZmZXIsdSksdGhpcy5hcHBseUhhbm5XaW5kb3codSl9dGhpcy50aW1lQ3Vyc29yKz10aGlzLmhvcFNpemV9YXBwbHlIYW5uV2luZG93KHQpe2Zvcih2YXIgZT0wO2U8dGhpcy5ibG9ja1NpemU7ZSsrKXRbZV09dFtlXSp0aGlzLmhhbm5XaW5kb3dbZV0qMS42Mn1jb21wdXRlTWFnbml0dWRlcygpe2Zvcih2YXIgdD0wLGU9MDt0PHRoaXMubWFnbml0dWRlcy5sZW5ndGg7KXtsZXQgcz10aGlzLmZyZXFDb21wbGV4QnVmZmVyW2VdLHI9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltlKzFdO3RoaXMubWFnbml0dWRlc1t0XT1zKioyK3IqKjIsdCs9MSxlKz0yfX1maW5kUGVha3MoKXt0aGlzLm5iUGVha3M9MDt2YXIgdD0yO2xldCBlPXRoaXMubWFnbml0dWRlcy5sZW5ndGgtMjtmb3IoO3Q8ZTspe2xldCBzPXRoaXMubWFnbml0dWRlc1t0XTtpZih0aGlzLm1hZ25pdHVkZXNbdC0xXT49c3x8dGhpcy5tYWduaXR1ZGVzW3QtMl0+PXMpe3QrKztjb250aW51ZX1pZih0aGlzLm1hZ25pdHVkZXNbdCsxXT49c3x8dGhpcy5tYWduaXR1ZGVzW3QrMl0+PXMpe3QrKztjb250aW51ZX10aGlzLnBlYWtJbmRleGVzW3RoaXMubmJQZWFrc109dCx0aGlzLm5iUGVha3MrKyx0Kz0yfX1zaGlmdFBlYWtzKHQpe3RoaXMuZnJlcUNvbXBsZXhCdWZmZXJTaGlmdGVkLmZpbGwoMCk7Zm9yKHZhciBlPTA7ZTx0aGlzLm5iUGVha3M7ZSsrKXtsZXQgbz10aGlzLnBlYWtJbmRleGVzW2VdLGE9TWF0aC5yb3VuZChvKnQpO2lmKGE+dGhpcy5tYWduaXR1ZGVzLmxlbmd0aClicmVhazt2YXIgcz0wLHI9dGhpcy5mZnRTaXplO2lmKGU+MCl7bGV0IGg9dGhpcy5wZWFrSW5kZXhlc1tlLTFdO3M9by1NYXRoLmZsb29yKChvLWgpLzIpfWlmKGU8dGhpcy5uYlBlYWtzLTEpe2xldCBoPXRoaXMucGVha0luZGV4ZXNbZSsxXTtyPW8rTWF0aC5jZWlsKChoLW8pLzIpfWxldCB1PXMtbyxjPXItbztmb3IodmFyIGk9dTtpPGM7aSsrKXtsZXQgaD1vK2ksZj1hK2k7aWYoZj49dGhpcy5tYWduaXR1ZGVzLmxlbmd0aClicmVhaztsZXQgcD0yKk1hdGguUEkqKGYtaCkvdGhpcy5mZnRTaXplLGw9TWF0aC5jb3MocCp0aGlzLnRpbWVDdXJzb3IpLG09TWF0aC5zaW4ocCp0aGlzLnRpbWVDdXJzb3IpLGQ9aCoyLGI9ZCsxLEk9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltkXSx2PXRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbYl0sUD1JKmwtdiptLHc9SSptK3YqbCxUPWYqMixCPVQrMTt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtUXSs9UCx0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZFtCXSs9d319fX1yZWdpc3RlclByb2Nlc3NvcigicGhhc2Utdm9jb2Rlci1wcm9jZXNzb3IiLG9lKTtjbGFzcyBhZSBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3Nvcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5waT1kdCx0aGlzLnBoaT0tdGhpcy5waSx0aGlzLlkwPTAsdGhpcy5ZMT0wLHRoaXMuUFc9dGhpcy5waSx0aGlzLkI9Mi4zLHRoaXMuZHBoaWY9MCx0aGlzLmVudmY9MH1zdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjQ0MCxtaW46TnVtYmVyLkVQU0lMT059LHtuYW1lOiJkZXR1bmUiLGRlZmF1bHRWYWx1ZTowLG1pbjpOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWX0se25hbWU6InB1bHNld2lkdGgiLGRlZmF1bHRWYWx1ZToxLG1pbjowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9XX1wcm9jZXNzKHQsZSxzKXtpZih0aGlzLmRpc2Nvbm5lY3RlZClyZXR1cm4hMTtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7Y29uc3Qgcj1lWzBdO2xldCBpPTEsbztmb3IobGV0IGE9MDthPChyWzBdLmxlbmd0aD8/MCk7YSsrKXtjb25zdCB1PSgxLU0oUShhLHMucHVsc2V3aWR0aCksLS45OSwuOTkpKSp0aGlzLnBpLGM9UShhLHMuZGV0dW5lKSxoPUgoUShhLHMuZnJlcXVlbmN5KSxjLzEwMCk7bz1oKih0aGlzLnBpLyhzYW1wbGVSYXRlKi41KSksdGhpcy5kcGhpZis9LjEqKG8tdGhpcy5kcGhpZiksaSo9Ljk5OTgsdGhpcy5lbnZmKz0uMSooaS10aGlzLmVudmYpLHRoaXMuQj0yLjMqKDEtMWUtNCpoKSx0aGlzLkI8MCYmKHRoaXMuQj0wKSx0aGlzLnBoaSs9dGhpcy5kcGhpZix0aGlzLnBoaT49dGhpcy5waSYmKHRoaXMucGhpLT0yKnRoaXMucGkpO2xldCBmPU1hdGguY29zKHRoaXMucGhpK3RoaXMuQip0aGlzLlkwKTt0aGlzLlkwPS41KihmK3RoaXMuWTApO2xldCBwPU1hdGguY29zKHRoaXMucGhpK3RoaXMuQip0aGlzLlkxK3UpO3RoaXMuWTE9LjUqKHArdGhpcy5ZMSk7Zm9yKGxldCBsPTA7bDxyLmxlbmd0aDtsKyspcltsXVthXT0uMTUqKGYtcCkqdGhpcy5lbnZmfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigicHVsc2Utb3NjaWxsYXRvciIsYWUpO2NvbnN0IG10PXtiaXRDOmZ1bmN0aW9uKG4sdCxlKXtyZXR1cm4gbiZ0P2U6MH0sYnI6ZnVuY3Rpb24obix0PTgpe2lmKHQ+MzIpdGhyb3cgbmV3IEVycm9yKCJicigpIFNpemUgY2Fubm90IGJlIGdyZWF0ZXIgdGhhbiAzMiIpO3tsZXQgZT0wO2ZvcihsZXQgcz0wO3M8dC0wO3MrKyllKz1tdC5iaXRDKG4sMioqcywyKioodC0ocysxKSkpO3JldHVybiBlfX0sc2luZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC5zaW4obi8oMTI4L01hdGguUEkpKX0sY29zZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC5jb3Mobi8oMTI4L01hdGguUEkpKX0sdGFuZjpmdW5jdGlvbihuKXtyZXR1cm4gTWF0aC50YW4obi8oMTI4L01hdGguUEkpKX0scmVnRzpmdW5jdGlvbihuLHQpe3JldHVybiB0LnRlc3Qobi50b1N0cmluZygyKSl9fTtsZXQgSixodDtmdW5jdGlvbiBjZShuKXtpZigoSnx8aHQpPT1udWxsKXtKPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE1hdGgpLGh0PUoubWFwKHM9Pk1hdGhbc10pO2NvbnN0IHQ9T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMobXQpLGU9dC5tYXAocz0+bXRbc10pO0oucHVzaCgiaW50Iiwid2luZG93IiwuLi50KSxodC5wdXNoKE1hdGguZmxvb3IsZ2xvYmFsVGhpcywuLi5lKX1yZXR1cm4gbmV3IEZ1bmN0aW9uKC4uLkosInQiLGByZXR1cm4gMCwKJHtufHwwfTtgKS5iaW5kKGdsb2JhbFRoaXMsLi4uaHQpfWNsYXNzIHVlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnBvcnQub25tZXNzYWdlPXQ9PntsZXR7Y29kZVRleHQ6ZX09dC5kYXRhO2NvbnN0e2J5dGVCZWF0U3RhcnRUaW1lOnN9PXQuZGF0YTtzIT1udWxsJiYodGhpcy50PTAsdGhpcy5pbml0aWFsT2Zmc2V0PU1hdGguZmxvb3IocykpLGU9ZS50cmltKCkucmVwbGFjZSgvXmV2YWxcKHVuZXNjYXBlXChlc2NhcGUoPzpgfFwoJ3xcKCJ8XChgKSguKj8pKD86YHwnXCl8IlwpfGBcKSkucmVwbGFjZVwoXC91XChcLlwuXClcL2csWyInYF1cJDElWyInYF1cKVwpXCkkLywocixpKT0+dW5lc2NhcGUoZXNjYXBlKGkpLnJlcGxhY2UoL3UoLi4pL2csIiQxJSIpKSksdGhpcy5mdW5jPWNlKGUpfSx0aGlzLmluaXRpYWxPZmZzZXQ9bnVsbCx0aGlzLnQ9bnVsbCx0aGlzLmZ1bmM9bnVsbH1zdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJiZWdpbiIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH0se25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjQ0MCxtaW46TnVtYmVyLkVQU0lMT059LHtuYW1lOiJkZXR1bmUiLGRlZmF1bHRWYWx1ZTowLG1pbjpOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWX0se25hbWU6ImVuZCIsZGVmYXVsdFZhbHVlOjAsbWF4Ok51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW46MH1dfXByb2Nlc3ModCxlLHMpe2lmKHRoaXMuZGlzY29ubmVjdGVkKXJldHVybiExO2lmKGN1cnJlbnRUaW1lPD1zLmJlZ2luWzBdKXJldHVybiEwO2lmKGN1cnJlbnRUaW1lPj1zLmVuZFswXSlyZXR1cm4hMTt0aGlzLnQ9PW51bGwmJih0aGlzLnQ9cy5iZWdpblswXSpzYW1wbGVSYXRlKTtjb25zdCByPWVbMF07Zm9yKGxldCBpPTA7aTxyWzBdLmxlbmd0aDtpKyspe2NvbnN0IG89UShpLHMuZGV0dW5lKSxhPUgoUShpLHMuZnJlcXVlbmN5KSxvLzEwMCk7bGV0IHU9dGhpcy50LyhzYW1wbGVSYXRlLzI1NikqYSt0aGlzLmluaXRpYWxPZmZzZXQ7Y29uc3QgZj0oKHRoaXMuZnVuYyh1KSYyNTUpLzEyNy41LTEpKi4yO2ZvcihsZXQgcD0wO3A8ci5sZW5ndGg7cCsrKXJbcF1baV09TShmLC0uNCwuNCk7dGhpcy50PXRoaXMudCsxfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiYnl0ZS1iZWF0LXByb2Nlc3NvciIsdWUpO2NvbnN0IGc9T2JqZWN0LmZyZWV6ZSh7Tk9ORTowLEFTWU06MSxNSVJST1I6MixCRU5EUDozLEJFTkRNOjQsQkVORE1QOjUsU1lOQzo2LFFVQU5UOjcsRk9MRDo4LFBXTTo5LE9SQklUOjEwLFNQSU46MTEsQ0hBT1M6MTIsUFJJTUVTOjEzLEJJTkFSWToxNCxCUk9XTklBTjoxNSxSRUNJUFJPQ0FMOjE2LFdPUk1IT0xFOjE3LExPR0lTVElDOjE4LFNJR01PSUQ6MTksRlJBQ1RBTDoyMCxGTElQOjIxfSk7ZnVuY3Rpb24gaGUobil7cmV0dXJuIG49bisyMTI3OTEyMjE0KyhuPDwxMiksbj1uXjMzNDUwNzI3MDBebj4+PjE5LG49biszNzQ3NjEzOTMrKG48PDUpLG49biszNTUwNjM1MTE2Xm48PDksbj1uKzQyNTE5OTM3OTcrKG48PDMpLG49bl4zMDQyNTk0NTY5Xm4+Pj4xNixuPj4+MH1jb25zdCBSdD1uPT4oaGUobik+Pj44KS8xNjc3NzIxNjtmdW5jdGlvbiBsZShuLHQpe2xldCBlPTA7Zm9yKGxldCBzPTA7czx0O3MrKyllPWU8PDF8biYxLG4+Pj49MTtyZXR1cm4gZX1mdW5jdGlvbiBmZShuKXtjb25zdCB0PU1hdGguZmxvb3IobiksZT1uLXQscz1SdCh0KSxyPVJ0KHQrMSk7cmV0dXJuIHMrKHItcykqZX1mdW5jdGlvbiBwZShuLHQ9NCl7bGV0IGU9LjUscz0wLHI9MCxpPTE7Zm9yKGxldCBvPTA7bzx0O28rKylzKz1lKmZlKG4qaSkscis9ZSxlKj0uNSxpKj0yO3JldHVybiBzL3IqMi0xfWNvbnN0IHZ0PXt9O2NsYXNzIGRlIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJmcmVxc3ByZWFkIixkZWZhdWx0VmFsdWU6LjE4LG1pbjowfSx7bmFtZToicG9zaXRpb24iLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfSx7bmFtZToid2FycCIsZGVmYXVsdFZhbHVlOjAsbWluOjAsbWF4OjF9LHtuYW1lOiJ3YXJwTW9kZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJ2b2ljZXMiLGRlZmF1bHRWYWx1ZToxLG1pbjoxfSx7bmFtZToicGFuc3ByZWFkIixkZWZhdWx0VmFsdWU6LjcsbWluOjAsbWF4OjF9LHtuYW1lOiJwaGFzZXJhbmQiLGRlZmF1bHRWYWx1ZTowLG1pbjowLG1heDoxfV19Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5mcmFtZUxlbj0wLHRoaXMubnVtRnJhbWVzPTAsdGhpcy5waGFzZT1bXSx0aGlzLmludlNSPTEvc2FtcGxlUmF0ZSx0aGlzLnBvcnQub25tZXNzYWdlPWU9Pntjb25zdHt0eXBlOnMscGF5bG9hZDpyfT1lLmRhdGF8fHt9O2lmKHM9PT0idGFibGUiKXtjb25zdCBpPXIua2V5O2lmKHRoaXMuZnJhbWVMZW49ci5mcmFtZUxlbiwhdnRbaV0pe2NvbnN0IG89W3IuZnJhbWVzXTtsZXQgYT1vWzBdO2ZvcihsZXQgdT0xO3U8MTt1Kyspe2NvbnN0IGM9YS5sZW5ndGg+PjEsaD1hLm1hcChmPT57Y29uc3QgcD1uZXcgRmxvYXQzMkFycmF5KGMpO2ZvcihsZXQgbD0wO2w8YztsKyspcFtsXT0oZlsyKmxdK2ZbMipsKzFdKS8yO3JldHVybiBwfSk7aWYoby5wdXNoKGgpLGE9aCxjPD0zMilicmVha312dFtpXT1vfXRoaXMudGFibGVzPXZ0W2ldLHRoaXMubnVtRnJhbWVzPXRoaXMudGFibGVzWzBdLmxlbmd0aH19fV9taXJyb3IodCl7cmV0dXJuIDEtTWF0aC5hYnMoMip0LTEpfV90b0JpdHModCxlPTIscz0xMil7Y29uc3Qgcj1zKyhlLXMpKnQ7cmV0dXJue2I6cixuOk1hdGgucm91bmQoTWF0aC5wb3coMixyKSl9fV93YXJwUGhhc2UodCxlLHMpe3N3aXRjaChzKXtjYXNlIGcuTk9ORTpyZXR1cm4gdDtjYXNlIGcuQVNZTTp7Y29uc3Qgcj0uMDErLjk5KmU7cmV0dXJuIHQ8cj8uNSp0L3I6LjUrLjUqKHQtcikvKDEtcil9Y2FzZSBnLk1JUlJPUjpyZXR1cm4gdGhpcy5fbWlycm9yKHRoaXMuX3dhcnBQaGFzZSh0LGUsZy5BU1lNKSk7Y2FzZSBnLkJFTkRQOnJldHVybiBNYXRoLnBvdyh0LDErMyplKTtjYXNlIGcuQkVORE06cmV0dXJuIE1hdGgucG93KHQsMS8oMSszKmUpKTtjYXNlIGcuQkVORE1QOnJldHVybiBlPC41P3RoaXMuX3dhcnBQaGFzZSh0LDEtMiplLDMpOnRoaXMuX3dhcnBQaGFzZSh0LDIqZS0xLDIpO2Nhc2UgZy5TWU5DOntjb25zdCByPU1hdGgucG93KDE2LGUqZSk7cmV0dXJuIHQqciUxfWNhc2UgZy5RVUFOVDp7Y29uc3R7bjpyfT10aGlzLl90b0JpdHMoZSk7cmV0dXJuIGZ0KHQqcikvcn1jYXNlIGcuRk9MRDp7Y29uc3QgaT0xK01hdGgubWF4KDEsTWF0aC5yb3VuZCg3KmUpKTtyZXR1cm4gTWF0aC5hYnMoVyhpKnQpLS41KSoyfWNhc2UgZy5QV006e2NvbnN0IHI9TSguNSsuNDkqKDIqZS0xKSwwLDEpO3JldHVybiB0PHI/dC9yKi41Oi41Kyh0LXIpLygxLXIpKi41fWNhc2UgZy5PUkJJVDp7Y29uc3Qgcj0uNSplO3JldHVybiBXKHQrcipNYXRoLnNpbigyKk1hdGguUEkqMyp0KSl9Y2FzZSBnLlNQSU46e2NvbnN0IHI9LjUqZSx7bjppfT10aGlzLl90b0JpdHMoZSwxLDYpO3JldHVybiBXKHQrcipNYXRoLnNpbigyKk1hdGguUEkqaSp0KSl9Y2FzZSBnLkNIQU9TOntjb25zdCBpPSgzLjcrLjMqZSkqdCooMS10KTtyZXR1cm4gTSgoMS1lKSp0K2UqaSwwLDEpfWNhc2UgZy5QUklNRVM6e2NvbnN0IHI9bz0+e2lmKG88MilyZXR1cm4hMTtpZihvJTI9PT0wKXJldHVybiBvPT09Mjtmb3IobGV0IGE9MzthKmE8PW87YSs9MilpZihvJWE9PT0wKXJldHVybiExO3JldHVybiEwfTtsZXR7bjppfT10aGlzLl90b0JpdHMoZSwzKTtmb3IoOyFyKGkpOylpKys7cmV0dXJuIGZ0KHQqaSkvaX1jYXNlIGcuQklOQVJZOntsZXR7YjpyfT10aGlzLl90b0JpdHMoZSwzKTtyPU1hdGgucm91bmQocik7Y29uc3QgaT0xPDxyLG89ZnQodCppKTtyZXR1cm4gbGUobyxyKS9pfWNhc2UgZy5NT0RVTEFSOntjb25zdHtuOnJ9PXRoaXMuX3RvQml0cyhlKSxpPS41KmUsbz1XKHQqcikvcjtyZXR1cm4gVyh0K2kqbyl9Y2FzZSBnLkJST1dOSUFOOntjb25zdCByPS4yNSplKnBlKDY0KnQsNCk7cmV0dXJuIFcodCtyKX1jYXNlIGcuUkVDSVBST0NBTDp7Y29uc3Qgcj0yKzQqZSxpPXQqcixvPXQrKDEtdCkqcixhPW8+MWUtMTI/aS9vOjA7cmV0dXJuIE0oYSwwLDEpfWNhc2UgZy5XT1JNSE9MRTp7Y29uc3Qgcj1NKC44KmUsMCwxKSxpPS41KigxLXIpLG89LjUqKDErcik7cmV0dXJuIHQ8aT90L2kqLjU6dD5vPy41KigxKyh0LW8pLygxLW8pKTouNX1jYXNlIGcuTE9HSVNUSUM6e2xldCByPXQ7Y29uc3QgaT0zLjYrLjQqZSxvPTErTWF0aC5yb3VuZCgyKmUpO2ZvcihsZXQgYT0wO2E8bzthKyspcj1pKnIqKDEtcik7cmV0dXJuIE0ociwwLDEpfWNhc2UgZy5TSUdNT0lEOntjb25zdCByPTErMTAqZSxpPXQtLjUsbz0xLygxK01hdGguZXhwKC1yKmkpKSxhPTEvKDErTWF0aC5leHAoLjUqcikpLHU9MS8oMStNYXRoLmV4cCgtLjUqcikpO3JldHVybihvLWEpLyh1LWEpfWNhc2UgZy5GUkFDVEFMOntjb25zdCByPS41Kk1hdGguc2luKDIqTWF0aC5QSSp0KSplO3JldHVybiBXKHQrcil9Y2FzZSBnLkZMSVA6cmV0dXJuIHQ7ZGVmYXVsdDpyZXR1cm4gdH19X3NhbXBsZUZyYW1lKHQsZSl7Y29uc3Qgcz10Lmxlbmd0aCxyPWUqcztsZXQgaT1yfDA7aT49cyYmKGk9MCk7Y29uc3Qgbz1yLWksYT10W2ldO2xldCB1PWkrMTt1Pj1zJiYodT0wKTtjb25zdCBjPXRbdV07cmV0dXJuIGErKGMtYSkqb31fY2hvb3NlTWlwKHQpe3ZhciByO2NvbnN0IGU9TSh0LDFlLTYsNjQpO2xldCBzPTA7Zm9yKDtzKzE8KCgocj10aGlzLnRhYmxlcyk9PW51bGw/dm9pZCAwOnIubGVuZ3RoKXx8MSkmJmU8dGhpcy50YWJsZXNbc11bMF0ubGVuZ3RoLzg7KXMrKztyZXR1cm4gc31wcm9jZXNzKHQsZSxzKXtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7Y29uc3Qgcj1lWzBdWzBdLGk9ZVswXVsxXXx8ZVswXVswXTtpZighdGhpcy50YWJsZXMpcmV0dXJuIHIuZmlsbCgwKSxpIT09ciYmaS5zZXQociksITA7Zm9yKGxldCBvPTA7bzxyLmxlbmd0aDtvKyspe2NvbnN0IGE9UyhzLmRldHVuZSxvKSx1PVMocy5mcmVxc3ByZWFkLG8pLGg9TShTKHMucG9zaXRpb24sbyksMCwxKSoodGhpcy5udW1GcmFtZXMtMSksZj1ofDAscD1oLWYsbD1NKFMocy53YXJwLG8pLDAsMSksbT1TKHMud2FycE1vZGUsbyksZD1TKHMudm9pY2VzLG8pLGI9TShTKHMucGhhc2VyYW5kLG8pLDAsMSksST1kPjE/TShTKHMucGFuc3ByZWFkLG8pLDAsMSk6MCx2PU1hdGguc3FydCguNS0uNSpJKSxQPU1hdGguc3FydCguNSsuNSpJKTtsZXQgdz1TKHMuZnJlcXVlbmN5LG8pO3c9SCh3LGEvMTAwKTtjb25zdCBUPTEvTWF0aC5zcXJ0KGQpO2ZvcihsZXQgQj0wO0I8ZDtCKyspe2NvbnN0IEE9KEImMSk9PTE7bGV0IHk9dixPPVA7QSYmKHk9UCxPPXYpO2NvbnN0IHg9SCh3LE50KGQsdSxCKSkqdGhpcy5pbnZTUixFPXRoaXMuX2Nob29zZU1pcCh4KSxOPXRoaXMudGFibGVzW0VdO3RoaXMucGhhc2VbQl09dGhpcy5waGFzZVtCXT8/TWF0aC5yYW5kb20oKSpiO2NvbnN0IEY9dGhpcy5fd2FycFBoYXNlKHRoaXMucGhhc2VbQl0sbCxtKSxWPXRoaXMuX3NhbXBsZUZyYW1lKE5bZl0sRiksaz10aGlzLl9zYW1wbGVGcmFtZShOW01hdGgubWluKHRoaXMubnVtRnJhbWVzLTEsZisxKV0sRik7bGV0IFI9Visoay1WKSpwO209PT1nLkZMSVAmJnRoaXMucGhhc2VbQl08bCYmKFI9LVIpLHJbb10rPVIqeSpULGlbb10rPVIqTypULHRoaXMucGhhc2VbQl09RnQodGhpcy5waGFzZVtCXSt4KX19cmV0dXJuITB9fXJldHVybiByZWdpc3RlclByb2Nlc3Nvcigid2F2ZXRhYmxlLW9zY2lsbGF0b3ItcHJvY2Vzc29yIixkZSksQy5XYXJwTW9kZT1nLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDLFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6Ik1vZHVsZSJ9KSxDfSh7fSk7Cg==";let sS;const RX=()=>(sS=new AudioContext,sS),Xn=()=>sS||RX();function xke(){return Xn().currentTime}let qx={};function _X(n,e){const t=Xn();if(qx[n])return qx[n];const s=2*t.sampleRate,a=t.createBuffer(1,s,t.sampleRate),r=a.getChannelData(0);let o=0,i,l,c,u,h,m,f;i=l=c=u=h=m=f=0;for(let v=0;v<s;v++)if(n==="white")r[v]=Math.random()*2-1;else if(n==="brown"){let O=Math.random()*2-1;r[v]=(o+.02*O)/1.02,o=r[v]}else if(n==="pink"){let O=Math.random()*2-1;i=.99886*i+O*.0555179,l=.99332*l+O*.0750759,c=.969*c+O*.153852,u=.8665*u+O*.3104856,h=.55*h+O*.5329522,m=-.7616*m-O*.016898,r[v]=i+l+c+u+h+m+f+O*.5362,r[v]*=.11,f=O*.115926}else if(n==="crackle"){const O=e*.01;Math.random()<O?r[v]=Math.random()*2-1:r[v]=0}return n!=="crackle"&&(qx[n]=a),a}function aS(n="white",e,t=.02){const s=Xn().createBufferSource();return s.buffer=_X(n,t),s.loop=!0,s.start(e),{node:s,stop:a=>s.stop(a)}}function kke(n,e,t){const s=aS("pink",t);return{node:IX(n,s.node,e),stop:a=>s==null?void 0:s.stop(a)}}const a3=["pink","white","brown","crackle"];function Gr(n){const e=Xn().createGain();return e.gain.value=n,e}function Ny(n,e,t){const s=Gr(t);return n.connect(s),s.connect(e),s}const b4=(n,e,t,s)=>s-t===0?0:(e-n)/(s-t);function lo(n,e,t,s){const a=new AudioWorkletNode(n,e,s);return Object.entries(t).forEach(([r,o])=>{o!==void 0&&(a.parameters.get(r).value=o)}),a}const oi=(n,e,t,s,a,r,o,i,l,c="exponential")=>{e=Sc(e),t=Sc(t),s=Sc(s),a=Sc(a);const u=c==="exponential"?"exponentialRampToValueAtTime":"linearRampToValueAtTime";c==="exponential"&&(r=r===0?.001:r,o=o===0?.001:o);const h=o-r,m=o,f=r+s*h,v=l-i,O=k=>{let M;if(e>k){let E=b4(r,m,0,e);M=k*E+(r>m?r:0)}else M=(k-e)*b4(m,f,0,t)+m;return c==="exponential"&&(M=M||.001),M};n.setValueAtTime(r,i),e>v?n[u](O(v),l):e+t>v?(n[u](O(e),i+e),n[u](O(v),l)):(n[u](O(e),i+e),n[u](O(e+t),i+e+t),n.setValueAtTime(f,l)),n[u](r,l+a)};function Pke(n){return typeof n=="number"?n%5:{tri:0,triangle:0,sine:1,ramp:2,saw:3,square:4}[n]??0}function e0(n,e,t,s={}){const{shape:a=0,...r}=s,{dcoffset:o=-.5,depth:i=1}=s,l={frequency:1,depth:i,skew:.5,phaseoffset:0,time:e,begin:e,end:t,shape:Pke(a),dcoffset:o,min:o*i,max:o*i+i,curve:1,...r};return lo(n,"lfo-processor",l)}function LX(n,e,t,s,a,r){const o={threshold:e??-3,ratio:t??10,knee:s??10,attack:a??.005,release:r??.05};return new DynamicsCompressorNode(n,o)}const ii=(n,e="linear",t)=>{const[s,a,r,o]=n;if(s==null&&a==null&&r==null&&o==null)return t??[.001,.001,1,.01];const i=r??(s!=null&&a==null||s==null&&a==null?1:.001);return[Math.max(s??0,.001),Math.max(a??0,.001),Math.min(i,1),Math.max(o??0,.01)]};function rS(n,e,t,s,a,r){let{amount:o,offset:i,defaultAmount:l=1,curve:c="linear",values:u,holdEnd:h,defaultValues:m}=a;o==null&&(o=u.some(D=>D!=null)?l:0);const f=i??0,v=o+f;if(Math.abs(v-f)){const[D,F,_,$]=ii(u,c,m);oi(e,D,F,_,$,f,v,t,h,c)}let O,{defaultDepth:k=1,depth:M,dcoffset:E,...I}=r;return M==null&&(M=Object.values(I).some(D=>D!=null)?k:0),M&&(O=e0(n,t,s,{depth:M,dcoffset:E,...I}),O.connect(e)),{lfo:O,disconnect:()=>O==null?void 0:O.disconnect()}}function e1(n,e,t,s,a,r,o,i,l,c,u,h,m,f){const v="exponential",[O,k,M,E]=ii([a,r,o,i],v,[.005,.14,0,.1]);let I,D;if(m==="ladder"?(I=lo(n,"ladder-processor",{frequency:t,q:s,drive:f}),D=I.parameters.get("frequency")):(I=n.createBiquadFilter(),I.type=e,I.Q.value=s,I.frequency.value=t,D=I.frequency),(a??r??o??i??l)!==void 0){l=Sc(l,1,!0),h=Sc(h,0,!0);const F=Math.abs(l),_=F*h;let $=Tu(2**-_*t,0,2e4),Z=Tu(2**(F-_)*t,0,2e4);return l<0&&([$,Z]=[Z,$]),oi(D,O,k,M,E,$,Z,c,u,v),I}return I}let y4=n=>n<.5?1:1-(n-.5)/.5;function IX(n,e,t=0){const s=Xn();if(!t)return n;let a=s.createGain(),r=s.createGain();n.connect(a),e.connect(r),a.gain.value=y4(t),r.gain.value=y4(1-t);let o=s.createGain();return a.connect(o),r.connect(o),o}let Ske=["linear","exponential"];function gm(n,e,t,s){if((e.pattack??e.pdecay??e.psustain??e.prelease??e.penv)===void 0)return;const a=Sc(e.penv,1,!0),r=Ske[e.pcurve??0];let[o,i,l,c]=ii([e.pattack,e.pdecay,e.psustain,e.prelease],r,[.2,.001,1,.001]),u=e.panchor??l;const h=a*100,m=0-h*u,f=h-h*u;oi(n,o,i,l,c,m,f,t,s,r)}function bm(n,e,t){const{vibmod:s=.5,vib:a}=e;let r;if(a>0){r=Xn().createOscillator(),r.frequency.value=a;const o=Xn().createGain();return o.gain.value=s*100,r.connect(o),o.connect(n),r.start(t),r}}function Qd(n,e,t,s){const a=new ConstantSourceNode(n),r=Gr(0);return r.connect(n.destination),a.connect(r),a.onended=()=>{try{r.disconnect()}catch{}try{a.disconnect()}catch{}e()},a.start(t),a.stop(s),a}const Cke=(n,e=1,t="sine")=>{const s=Xn();let a;a3.includes(t)?(a=s.createBufferSource(),a.buffer=_X(t,2),a.loop=!0):(a=s.createOscillator(),a.type=t,a.frequency.value=n),a.start();const r=new GainNode(s,{gain:e});return a.connect(r),{node:r,stop:o=>a.stop(o)}},Mke=(n,e,t,s="sine")=>{const a=n.value*e,r=a*t;return Cke(a,r,s)};function cg(n,e,t){const{fmh:s=1,fmi:a,fmenv:r="exp",fmattack:o,fmdecay:i,fmsustain:l,fmrelease:c,fmvelocity:u,fmwave:h="sine",duration:m}=e;let f,v=()=>{};if(a){const O=Xn().createGain(),k=Mke(n,s,a,h);if(f=k.node,v=k.stop,![o,i,l,c,u].some(M=>M!==void 0))f.connect(n);else{const[M,E,I,D]=ii([o,i,l,c]),F=t+m;oi(O.gain,M,E,I,D,0,1,t,F,r==="exp"?"exponential":"linear"),f.connect(O),O.connect(n)}}return{stop:v}}const QX=n=>n/(1+n),Ake=(n,e)=>(n%e+e)%e,Eke=(n,e)=>(1+e)*n/(1+e*Math.abs(n)),Vd=(n,e)=>Math.tanh(n*(1+e)),Dke=(n,e)=>Tu((1+e)*n,-1,1),VX=(n,e)=>{let t=(1+.5*e)*n;const s=Ake(t+1,4);return 1-Math.abs(s-2)},Tke=(n,e)=>Math.sin(Math.PI/2*VX(n,e)),Fke=(n,e)=>{const t=QX(Math.log1p(e)),s=(n-t/3*n*n*n)/(1-t/3);return Vd(s,e)},jX=(n,e,t=!1)=>{const s=1+2*e,a=.07*QX(Math.log1p(e)),r=Vd(n+a,2*e),o=Vd(t?a:-n+a,2*e),i=r-o,l=1/Math.cosh(s*a),c=l*l,u=Math.max(1e-8,(t?1:2)*s*c);return Vd(i/u,e)},Nke=(n,e)=>jX(n,e,!0),Bke=(n,e)=>{const t=10*Math.log1p(e);let s=1,a=n,r,o=0;for(let i=1;i<64;i++){if(i<2){o+=i==0?s:a;continue}r=2*n*s-a,a=s,s=r,i%2===0&&(o+=Math.min(1.3*t/i,2)*r)}return Vd(o,t/20)},r3={scurve:Eke,soft:Vd,hard:Dke,cubic:Fke,diode:jX,asym:Nke,fold:VX,sinefold:Tke,chebyshev:Bke},Dp=Object.freeze(Object.keys(r3)),$ke=n=>{let e=n;typeof n=="string"&&(e=Dp.indexOf(n),e===-1&&(Ma(`[superdough] Could not find waveshaping algorithm ${n}.
        Available options are ${Dp.join(", ")}.
        Defaulting to ${Dp[0]}.`),e=0));const t=Dp[e%Dp.length];return r3[t]},ZX=(n,e,t)=>lo(Xn(),"distort-processor",{distort:n,postgain:e},{processorOptions:{algorithm:t}}),bh=(n,e=36)=>{let{note:t,freq:s}=n;return t=t||e,typeof t=="string"&&(t=Mw(t)),!s&&typeof t=="number"&&(s=NX(t)),Number(s)},xd=n=>{var e;n!=null&&(n.disconnect(),(e=n.parameters.get("end"))==null||e.setValueAtTime(0,0))};let Ti=[],Wc=0;const q0=4;let zX=n=>{let e=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(s){return t.lc=e.push(s),()=>{for(let r=Wc+q0;r<Ti.length;)Ti[r]===s?Ti.splice(r,q0):r+=q0;let a=e.indexOf(s);~a&&(e.splice(a,1),--t.lc||t.off())}},notify(s,a){let r=!Ti.length;for(let o of e)Ti.push(o,t.value,s,a);if(r){for(Wc=0;Wc<Ti.length;Wc+=q0)Ti[Wc](Ti[Wc+1],Ti[Wc+2],Ti[Wc+3]);Ti.length=0}},off(){},set(s){let a=t.value;a!==s&&(t.value=s,t.notify(a))},subscribe(s){let a=t.listen(s);return s(t.value),a},value:n};return t};const Rke=5,U0=6,H0=10;let _ke=(n,e,t,s)=>(n.events=n.events||{},n.events[t+H0]||(n.events[t+H0]=s(a=>{n.events[t].reduceRight((r,o)=>(o(r),r),{shared:{},...a})})),n.events[t]=n.events[t]||[],n.events[t].push(e),()=>{let a=n.events[t],r=a.indexOf(e);a.splice(r,1),a.length||(delete n.events[t],n.events[t+H0](),delete n.events[t+H0])}),Lke=1e3,Ike=(n,e)=>_ke(n,t=>{let s=e(t);s&&n.events[U0].push(s)},Rke,t=>{let s=n.listen;n.listen=(...r)=>(!n.lc&&!n.active&&(n.active=!0,t()),s(...r));let a=n.off;return n.events[U0]=[],n.off=()=>{a(),setTimeout(()=>{if(n.active&&!n.lc){n.active=!1;for(let r of n.events[U0])r();n.events[U0]=[]}},Lke)},()=>{n.listen=s,n.off=a}}),Qke=(n={})=>{let e=zX(n);return e.setKey=function(t,s){let a=e.value;typeof s>"u"&&t in e.value?(e.value={...e.value},delete e.value[t],e.notify(a,t)):e.value[t]!==s&&(e.value={...e.value,[t]:s},e.notify(a,t))},e};const o3={},Ux={},Vke=n=>o3[n];function jke(n,e){var t=1024;if(n<t)return n+" B";var s=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],a=-1;do n/=t,++a;while(n>=t);return n.toFixed(1)+" "+s[a]}function GX(n,e){const{speed:t=1}=n,{transpose:s,url:a,index:r,midi:o,label:i}=$X(n,e);let l=Math.abs(t)*Math.pow(2,s/12);return{transpose:s,url:a,index:r,midi:o,label:i,playbackRate:l}}const XX=async(n,e,t)=>{let{url:s,label:a,playbackRate:r}=GX(n,e);t&&(s=await t(s));const o=Xn(),i=await i3(s,o,a);return n.unit==="c"&&(r=r*i.duration),{buffer:i,playbackRate:r}},WX=async(n,e,t)=>{let{buffer:s,playbackRate:a}=await XX(n,e,t);n.speed<0&&(s=qX(s));const r=Xn().createBufferSource();r.buffer=s,r.playbackRate.value=a;const{loopBegin:o=0,loopEnd:i=1,begin:l=0,end:c=1}=n,u=l*r.buffer.duration;n.loop&&(r.loop=!0,r.loopStart=o*r.buffer.duration-u,r.loopEnd=i*r.buffer.duration-u);const h=r.buffer.duration/r.playbackRate.value,m=(c-l)*h;return{bufferSource:r,offset:u,bufferDuration:h,sliceDuration:m}},i3=(n,e,t,s=0)=>{const a=t?`sound "${t}:${s}"`:"sample";if(n=n.replace("#","%23"),!Ux[n]){Ma(`[sampler] load ${a}..`,"load-sample",{url:n});const r=Date.now();Ux[n]=fetch(n).then(o=>o.arrayBuffer()).then(async o=>{const i=Date.now()-r,l=jke(o.byteLength);Ma(`[sampler] load ${a}... done! loaded ${l} in ${i}ms`,"loaded-sample",{url:n});const c=await e.decodeAudioData(o);return o3[n]=c,c})}return Ux[n]};function qX(n){const e=Xn(),t=e.createBuffer(n.numberOfChannels,n.length,e.sampleRate);for(let s=0;s<n.numberOfChannels;s++)t.copyToChannel(n.getChannelData(s).slice().reverse(),s,s);return t}const Zke=n=>o3[n];function UX(n){if(n.startsWith("bubo:")){const[e,t]=n.split(":");n=`github:Bubobubobubobubo/dough-${t}`}return n}function HX(n,e=""){if(!n.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let t=n.slice(7);t=t.endsWith("/")?t.slice(0,-1):t;let s=t.split("/"),a=s[0],r=s.length>=2?s[1]:"samples",o=s.length>=3?s[2]:"main",i=s.slice(3);return i.push(e||""),i=i.join("/"),`https://raw.githubusercontent.com/${a}/${r}/${o}/${i}`}const YX=(n,e,t=n._base||"")=>Object.entries(n).forEach(([s,a])=>{if(typeof a=="string"&&(a=[a]),typeof a!="object")throw new Error("wrong sample map format for "+s);t=a._base||t,t=UX(t),t.startsWith("github:")&&(t=HX(t,""));const r=o=>t+o;Array.isArray(a)?a=a.map(r):a=Object.fromEntries(Object.entries(a).map(([o,i])=>[o,(typeof i=="string"?[i]:i).map(r)])),e(s,a)});let KX={};function zke(n,e){KX[n]=e}function Gke(n){const e=Object.entries(KX).find(([t])=>n.startsWith(t));if(e)return e[1]}async function Xke(n){const e=Gke(n);if(e)return e(n);if(n=UX(n),n.startsWith("github:")&&(n=HX(n,"strudel.json")),n.startsWith("local:")&&(n="http://localhost:5432"),n.startsWith("shabda:")){let[a,r]=n.split("shabda:");n=`https://shabda.ndre.gr/${r}.json?strudel=1`}if(n.startsWith("shabda/speech")){let[a,r]=n.split("shabda/speech");r=r.startsWith("/")?r.substring(1):r;let[o,i]=r.split(":"),l="f",c="en-GB";o&&([c,l]=o.split("/")),n=`https://shabda.ndre.gr/speech/${i}.json?gender=${l}&language=${c}&strudel=1'`}if(typeof fetch!="function")return;const t=n.split("/").slice(0,-1).join("/");if(typeof fetch>"u")return;const s=await fetch(n).then(a=>a.json()).catch(a=>{throw console.error(a),new Error(`error loading "${n}"`)});return[s,s._base||t]}const Kc=async(n,e=n._base||"",t={})=>{if(typeof n=="string"){const[r,o]=await Xke(n);return Kc(r,e||o,t)}const{prebake:s,tag:a}=t;YX(n,(r,o)=>{eW(r,o,{baseUrl:e,prebake:s,tag:a})},e)},v4=[];async function JX(n,e,t,s,a){let{s:r,nudge:o=0,cut:i,loop:l,clip:c=void 0,n:u=0,speed:h=1,duration:m}=e;if(h===0)return;const f=Xn();let[v,O,k,M]=ii([e.attack,e.decay,e.sustain,e.release]);const{bufferSource:E,sliceDuration:I,offset:D}=await WX(e,s,a);if(f.currentTime>n){Ma(`[sampler] still loading sound "${r}:${u}"`,"highlight");return}if(!E){Ma(`[sampler] could not load "${r}:${u}"`,"error");return}let F=bm(E.detune,e,n);const _=n+o;E.start(_,D);const $=f.createGain(),Z=E.connect($);c==null&&l==null&&e.release==null&&(m=I);let ce=n+m;oi(Z.gain,v,O,k,M,0,1,n,ce,"linear"),gm(E.detune,e,n,ce);const U=f.createGain();Z.connect(U),E.onended=function(){E.disconnect(),F==null||F.stop(),Z.disconnect(),U.disconnect(),t()};let ue=ce+M+.01;E.stop(ue);const W={node:U,bufferSource:E,stop:de=>{E.stop(de)}};if(i!==void 0){const de=v4[i];de&&(de.node.gain.setValueAtTime(1,_),de.node.gain.linearRampToValueAtTime(0,_+.01)),v4[i]=W}return W}function Wke(n,e,t){Ol(n,(s,a,r)=>JX(s,a,r,e),{type:"sample",samples:e,...t})}function eW(n,e,t){n.startsWith("wt_")?d3(n,e,t):Wke(n,e,t)}let nd=(n,e)=>n!==void 0&&n!==e;class qke{constructor(e){la(this,"reverbNode");la(this,"delayNode");la(this,"output");la(this,"summingNode");la(this,"djfNode");la(this,"audioContext");this.audioContext=e,this.output=new GainNode(e,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode=new GainNode(e,{gain:1,channelCount:2,channelCountMode:"explicit"}),this.summingNode.connect(this.output)}disconnect(){var e,t;this.output.disconnect(),this.summingNode.disconnect(),(e=this.delayNode)==null||e.disconnect(),(t=this.reverbNode)==null||t.disconnect()}getDjf(e,t=0){this.djfNode==null&&(this.djfNode=lo(this.audioContext,"djf-processor",{value:e}),this.summingNode.disconnect(),this.summingNode.connect(this.djfNode),this.djfNode.connect(this.output)),this.djfNode.parameters.get("value").setValueAtTime(e,t)}getDelay(e=0,t=.5,s){var a,r;return t=Tu(t,0,.98),this.delayNode==null&&(this.delayNode=this.audioContext.createFeedbackDelay(1,e,t),this.delayNode.connect(this.summingNode),(r=(a=this.delayNode).start)==null||r.call(a,s)),this.delayNode.delayTime.value!==e&&this.delayNode.delayTime.setValueAtTime(e,s),this.delayNode.feedback.value!==t&&this.delayNode.feedback.setValueAtTime(t,s),this.delayNode}getReverb(e,t,s,a,r,o,i){return this.reverbNode==null&&(this.reverbNode=this.audioContext.createReverb(e,t,s,a,r,o,i),this.reverbNode.connect(this.summingNode)),(nd(e,this.reverbNode.duration)||nd(t,this.reverbNode.fade)||nd(s,this.reverbNode.lp)||nd(a,this.reverbNode.dim)||nd(o,this.reverbNode.irspeed)||nd(i,this.reverbNode.irbegin)||this.reverbNode.ir!==r)&&this.reverbNode.generate(e,t,s,a,r,o,i),this.reverbNode}sendReverb(e,t){Ny(e,this.reverbNode,t)}sendDelay(e,t){Ny(e,this.delayNode,t)}duck(e,t=0,s=.1,a=1){const r=t,o=Math.max(s,.002),i=this.output.gain;Qd(this.audioContext,()=>{const l=this.audioContext.currentTime,c=i.value;i.cancelScheduledValues(l),i.setValueAtTime(c,l);const u=Math.max(e,l),h=Tu(1-Math.sqrt(a),.01,c);i.exponentialRampToValueAtTime(h,u+r),i.exponentialRampToValueAtTime(1,u+r+o)},0,e-.01)}connectToOutput(e){e.connect(this.summingNode)}}class Uke{constructor(e){la(this,"channelMerger");la(this,"destinationGain");la(this,"connectToDestination",(e,t=[0,1])=>{const s=new StereoPannerNode(this.audioContext);e.connect(s);const a=new ChannelSplitterNode(this.audioContext,{numberOfOutputs:s.channelCount});s.connect(a),t.forEach((r,o)=>{a.connect(this.channelMerger,o%s.channelCount,r%this.audioContext.destination.channelCount)})});this.audioContext=e,this.initializeAudio()}initializeAudio(){const e=this.audioContext,t=e.destination.maxChannelCount;this.audioContext.destination.channelCount=t,this.channelMerger=new ChannelMergerNode(e,{numberOfInputs:e.destination.channelCount}),this.destinationGain=new GainNode(e),this.channelMerger.connect(this.destinationGain),this.destinationGain.connect(e.destination)}reset(){this.disconnect(),this.initializeAudio()}disconnect(){this.channelMerger.disconnect(),this.destinationGain.disconnect(),this.destinationGain=null,this.channelMerger=null}}class Hke{constructor(e){la(this,"audioContext");la(this,"output");la(this,"nodes",{});this.audioContext=e,this.output=new Uke(e)}reset(){Array.from(this.nodes).forEach(e=>{e.disconnect()}),this.nodes={},this.output.reset()}duck(e,t,s=0,a=.1,r=1){const o=[e].flat(),i=[s].flat(),l=[a].flat(),c=[r].flat();o.forEach((u,h)=>{const m=this.nodes[u];if(m==null){TX(new Error(`duck target orbit ${u} does not exist`),"superdough");return}const f=i[h]??i[0],v=Math.max(l[h]??l[0],.002),O=c[h]??c[0];m.duck(t,f,v,O)})}getOrbit(e,t){return this.nodes[e]==null&&(this.nodes[e]=new qke(this.audioContext),this.output.connectToDestination(this.nodes[e].output,t)),this.nodes[e]}}const l3=128,oS="System Standard";let tW=l3;function nW(n){tW=parseInt(n)??l3}let sW=!1;function aW(n){sW=n==!0}const Io=Qke();function Ol(n,e,t={}){n=n.toLowerCase().replace(/\s+/g,"_"),Io.setKey(n,{onTrigger:e,data:t})}let rW=n=>n;function yc(n){return rW(n)}function Yke(n){rW=n}function iS(n){for(const t in n)n[t.toLowerCase()]=n[t];const e=Io.get();for(const t in e){const[s,a]=t.split("_");if(!a)continue;const r=n[s];if(r){if(typeof r=="string")e[`${r}_${a}`.toLowerCase()]=e[t];else if(Array.isArray(r))for(const o of r)e[`${o}_${a}`.toLowerCase()]=e[t]}}Io.set({...e})}async function Kke(n){const e=await(await fetch(n)).json();iS(e)}async function oW(...n){switch(n.length){case 1:return typeof n[0]=="string"?Kke(n[0]):iS(n[0]);case 2:return iS({[n[0]]:n[1]});default:throw new Error("aliasMap expects 1 or 2 arguments, received "+n.length)}}function Jke(n,e){if(jd(n)==null){Ma("soundAlias: original sound not found");return}Io.setKey(e,jd(n))}function jd(n){return typeof n!="string"?(console.warn(`getSound: expected string got "${n}". fall back to triangle`),Io.get().triangle):Io.get()[n.toLowerCase()]}const iW=async()=>{await navigator.mediaDevices.getUserMedia({audio:!0});let n=await navigator.mediaDevices.enumerateDevices();n=n.filter(t=>t.kind==="audiooutput"&&t.deviceId!=="default");const e=new Map;return e.set(oS,""),n.forEach(t=>{e.set(t.label,t.deviceId)}),e};let t0={s:"triangle",gain:.8,postgain:1,density:".03",ftype:"12db",fanchor:0,resonance:1,hresonance:1,bandq:1,channels:[1,2],phaserdepth:.75,shapevol:1,distortvol:1,distorttype:0,delay:0,byteBeatExpression:"0",delayfeedback:.5,delaysync:3/16,orbit:1,i:1,velocity:1,fft:8};const ePe=Object.freeze({...t0});function tPe(n,e){t0[n]=e}function nPe(){t0={...ePe}}let c3=new Map(Object.entries(t0));function u3(n,e){c3.set(n,e)}function ca(n){return c3.get(n)}function sPe(n){Object.keys(n).forEach(e=>{u3(e,n[e])})}function lW(){c3=new Map(Object.entries(t0))}function aPe(n){lW(),n==="1.0"&&u3("fanchor",.5)}const rPe=()=>Io.set({});let cW=[];function uW(n){cW.push(n)}let Hx;function oPe(){if(!Hx){const n=Xn(),e=cW.concat([Oke]);Hx=Promise.all(e.map(t=>n.audioWorklet.addModule(t)))}return Hx}async function hW(n={}){const{disableWorklets:e=!1,maxPolyphony:t,audioDeviceName:s=oS,multiChannelOrbits:a=!1}=n;if(nW(t),aW(a),typeof window>"u")return;const r=Xn();if(s!=null&&s!=oS)try{const o=(await iW()).get(s),i=(o??"").length>0;r.sinkId!==o&&i&&await r.setSinkId(o),Ma(`[superdough] Audio Device set to ${s}, it might take a few seconds before audio plays on all output channels`)}catch{Ma("[superdough] failed to set audio interface","warning")}if(await r.resume(),e){Ma("[superdough]: AudioWorklets disabled with disableWorklets");return}try{await oPe(),Ma("[superdough] AudioWorklets loaded")}catch(o){console.warn("could not load AudioWorklet effects",o)}Ma("[superdough] ready")}let Yx;async function iPe(n){return Yx||(Yx=new Promise(e=>{document.addEventListener("click",async function t(){document.removeEventListener("click",t),await hW(n),e()})})),Yx}let Zd;function dW(){return Zd==null&&(Zd=new Hke(Xn())),Zd}function mW(n,e){dW().output.connectToDestination(n,e)}function lPe(n,e,t=1,s=.5,a=1e3,r=2e3){const o=Xn(),i=e0(o,n,e,{frequency:t,depth:r*2}),l=2;let c=0;const u=[];for(let h=0;h<l;h++){const m=o.createBiquadFilter();m.type="notch",m.gain.value=1,m.frequency.value=a+c,m.Q.value=2-Math.min(Math.max(s*2,0),1.9),i.connect(m.detune),c+=282,h>0&&u[h-1].connect(m),u.push(m)}return u[u.length-1]}function cPe(n){n=n??0;const e=["12db","ladder","24db"];return typeof n=="number"?e[Math.floor(BX(n,e.length))]:n}let Pr={},Ah={};function pW(n,e=1024,t=.5){if(!Pr[n]){const s=Xn().createAnalyser();s.fftSize=e,s.smoothingTimeConstant=t,Pr[n]=s,Ah[n]=new Float32Array(Pr[n].frequencyBinCount)}return Pr[n].fftSize!==e&&(Pr[n].fftSize=e,Ah[n]=new Float32Array(Pr[n].frequencyBinCount)),Pr[n]}function Aw(n="time",e=1){const t={time:()=>{var s;return(s=Pr[e])==null?void 0:s.getFloatTimeDomainData(Ah[e])},frequency:()=>{var s;return(s=Pr[e])==null?void 0:s.getFloatFrequencyData(Ah[e])}}[n];if(!t)throw new Error(`getAnalyzerData: ${n} not supported. use one of ${Object.keys(t).join(", ")}`);return t(),Ah[e]}function uPe(){Zd==null||Zd.reset(),Pr={},Ah={}}let Tp=new Map;function w4(n){return(Array.isArray(n)?n:[n]).map(e=>e-1)}const h3=async(n,e,t,s=.5,a=.5)=>{var gn,_s,Cn;const r=Xn(),o=dW();let{stretch:i}=n;if(i!=null&&(e=e-.04),typeof n!="object")throw new Error(`expected hap.value to be an object, but got "${n}". Hint: append .note() or .s() to the end`,"error");if(n.duration=t,e<r.currentTime){console.warn(`[superdough]: cannot schedule sounds in the past (target: ${e.toFixed(2)}, now: ${r.currentTime.toFixed(2)})`);return}let{tremolo:l,tremolosync:c,tremolodepth:u=1,tremoloskew:h,tremolophase:m=0,tremoloshape:f,s:v=ca("s"),bank:O,source:k,gain:M=ca("gain"),postgain:E=ca("postgain"),density:I=ca("density"),duckorbit:D,duckonset:F,duckattack:_,duckdepth:$,djf:Z,fanchor:ce=ca("fanchor"),drive:U=.69,release:ue=0,cutoff:W,lpenv:de,lpattack:be,lpdecay:ke,lpsustain:Ce,lprelease:Ae,resonance:q=ca("resonance"),hpenv:Ne,hcutoff:Re,hpattack:je,hpdecay:me,hpsustain:Ye,hprelease:ft,hresonance:_e=ca("hresonance"),bpenv:Ge,bandf:pt,bpattack:rt,bpdecay:tn,bpsustain:on,bprelease:xn,bandq:Gt=ca("bandq"),phaserrate:In,phaserdepth:Ft=ca("phaserdepth"),phasersweep:jt,phasercenter:Gn,coarse:un,crush:fn,dry:at,shape:Un,shapevol:nt=ca("shapevol"),distort:Mt,distortvol:Vt=ca("distortvol"),distorttype:En=ca("distorttype"),pan:lt,vowel:It,delay:Le=ca("delay"),delayfeedback:qt=ca("delayfeedback"),delaysync:tt=ca("delaysync"),delaytime:zn,orbit:mt=ca("orbit"),room:Fn,roomfade:ea,roomlp:Hn,roomdim:Zt,roomsize:Dt,ir:Sn,irspeed:He,irbegin:Tt,i:kn=ca("i"),velocity:vs=ca("velocity"),analyze:ln,fft:Gs=ca("fft"),compressor:na,compressorRatio:x,compressorKnee:B,compressorAttack:T,compressorRelease:R}=n;zn=zn??wke(tt,s);const j=w4(sW&&mt>0?[mt*2-1,mt*2]:ca("channels")),H=n.channels!=null?w4(n.channels):j,ee=o.getOrbit(mt,H);D!=null&&o.duck(D,e,F,_,$),M=yc(Sc(M,1)),E=yc(E),nt=yc(nt),Vt=yc(Vt),Le=yc(Le),vs=yc(vs),u=yc(u),M*=vs;const ne=e+t,ge=ne+ue,Fe=Math.round(Math.random()*1e6);for(let Pn=0;Pn<=Tp.size-tW;Pn++){const bs=Tp.entries().next(),ls=bs.value[1],Fa=bs.value[0],$r=e+.25;(_s=(gn=ls==null?void 0:ls.node)==null?void 0:gn.gain)==null||_s.linearRampToValueAtTime(0,$r),(Cn=ls==null?void 0:ls.stop)==null||Cn.call(ls,$r),Tp.delete(Fa)}let Be=[];if(["-","~","_"].includes(v))return;O&&v&&(v=`${O}_${v}`,n.s=v);let wt;if(k)wt=k(e,n,t,s);else if(jd(v)){const{onTrigger:Pn}=jd(v),bs=await Pn(e,n,()=>{Be.forEach(ls=>ls==null?void 0:ls.disconnect()),Tp.delete(Fe)},s);bs&&(wt=bs.node,Tp.set(Fe,bs))}else throw new Error(`sound ${v} not found! Is it loaded?`);if(!wt)return;if(r.currentTime>e){Ma("[webaudio] skip hap: still loading",r.currentTime-e);return}const Nt=[];Nt.push(wt),i!==void 0&&Nt.push(lo(r,"phase-vocoder-processor",{pitchFactor:i})),Nt.push(Gr(M));const yn=cPe(n.ftype);if(W!==void 0){let Pn=()=>e1(r,"lowpass",W,q,be,ke,Ce,Ae,de,e,ne,ce,yn,U);Nt.push(Pn()),yn==="24db"&&Nt.push(Pn())}if(Re!==void 0){let Pn=()=>e1(r,"highpass",Re,_e,je,me,Ye,ft,Ne,e,ne,ce);Nt.push(Pn()),yn==="24db"&&Nt.push(Pn())}if(pt!==void 0){let Pn=()=>e1(r,"bandpass",pt,Gt,rt,tn,on,xn,Ge,e,ne,ce);Nt.push(Pn()),yn==="24db"&&Nt.push(Pn())}if(It!==void 0){const Pn=r.createVowelFilter(It);Nt.push(Pn)}if(un!==void 0&&Nt.push(lo(r,"coarse-processor",{coarse:un})),fn!==void 0&&Nt.push(lo(r,"crush-processor",{crush:fn})),Un!==void 0&&Nt.push(lo(r,"shape-processor",{shape:Un,postgain:nt})),Mt!==void 0&&Nt.push(ZX(Mt,Vt,En)),c!=null&&(l=s*c),n.wtPosSynced!=null&&(n.wtPosRate/=s),n.wtWarpSynced!=null&&(n.wtWarpRate/=s),l!==void 0){const Pn=Math.max(1-u,0),bs=new GainNode(r,{gain:Pn}),ls=a/s;e0(r,e,ge,{skew:h??(f!=null?.5:1),frequency:l,depth:u,time:ls,dcoffset:0,shape:f,phaseoffset:m,min:0,max:1,curve:1.5}).connect(bs.gain),Nt.push(bs)}if(na!==void 0&&Nt.push(LX(r,na,x,B,T,R)),lt!==void 0){const Pn=r.createStereoPanner();Pn.pan.value=2*lt-1,Nt.push(Pn)}if(In!==void 0&&Ft>0){const Pn=lPe(e,ge,In,Ft,Gn,jt);Nt.push(Pn)}const ws=new GainNode(r,{gain:E});if(Nt.push(ws),Le>0&&zn>0&&qt>0&&(ee.getDelay(zn,qt,e),ee.sendDelay(ws,Le)),Fn>0){let Pn;if(Sn!==void 0){let bs,ls=jd(Sn);Array.isArray(ls)?bs=ls.data.samples[kn%ls.data.samples.length]:typeof ls=="object"&&(bs=Object.values(ls.data.samples).flat()[kn%Object.values(ls.data.samples).length]),Pn=await i3(bs,r,Sn,0)}ee.getReverb(Dt,ea,Hn,Zt,Pn,He,Tt),ee.sendReverb(ws,Fn)}if(Z!=null&&ee.getDjf(Z,e),ln){const Pn=pW(ln,2**(Gs+5)),bs=Ny(ws,Pn,1);Be.push(bs)}if(at!=null){at=yc(at);const Pn=new GainNode(r,{gain:at});Nt.push(Pn),ee.connectToOutput(Pn)}else ee.connectToOutput(ws);Nt.slice(1).reduce((Pn,bs)=>Pn.connect(bs),Nt[0]),Be=Be.concat(Nt)},hPe=(n,e,t,s)=>{h3(e,n-t,e.duration/s,s)},dPe=["triangle","square","sawtooth","sine"],mPe=[["tri","triangle"],["sqr","square"],["saw","sawtooth"],["sin","sine"]];function pPe(n,e){const t=n,s=new Float32Array(e);for(let a=0;a<e;a++){const r=a*2/e-1;s[a]=Math.tanh(r*t)}return s}function fW(){[...dPe].forEach(n=>{Ol(n,(e,t,s)=>{const[a,r,o,i]=ii([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]);let l=bW(n,e,t),{node:c,stop:u,triggerRelease:h}=l;const m=Gr(.3),{duration:f}=t;c.onended=()=>{c.disconnect(),m.disconnect(),s()};const v=Gr(1);let O=c.connect(m).connect(v);const k=e+f;oi(O.gain,a,r,o,i,0,1,e,k,"linear");const M=k+i+.01;return h==null||h(M),u(M),{node:O,stop:E=>{u(E)}}},{type:"synth",prebake:!0})}),Ol("sbd",(n,e,t)=>{const{duration:s,decay:a=.5,pdecay:r=.5,penv:o=36,clip:i}=e,l=Xn(),c=.02,u=1.2,h=.025,m=1,f=l.createOscillator();f.type="triangle",f.frequency.value=bh(e,29),f.detune.setValueAtTime(o*100,0),f.detune.setValueAtTime(o*100,n),f.detune.exponentialRampToValueAtTime(.001,n+r);const v=Gr(1);v.gain.setValueAtTime(1,n+c),v.gain.exponentialRampToValueAtTime(.001,n+c+a),f.start(n);const O=aS("brown",n,2),k=Gr(1);k.gain.setValueAtTime(u,n),k.gain.exponentialRampToValueAtTime(.001,n+h);const M=new WaveShaperNode(l);M.curve=pPe(2,l.sampleRate);const E=Gr(m);f.onended=()=>{f.disconnect(),v.disconnect(),M.disconnect(),O.node.disconnect(),k.disconnect(),E.disconnect(),t()};const I=f.connect(M).connect(v).connect(E);O.node.connect(k).connect(E);let D=n+a+.01;return i!=null&&(D=Math.min(n+i*s,D)),E.gain.setValueAtTime(m,D-.01),E.gain.linearRampToValueAtTime(0,D),f.stop(D),O.stop(D),{node:I,stop:F=>{f.stop(F)}}},{type:"synth",prebake:!0}),Ol("supersaw",(n,e,t)=>{const s=Xn();let{duration:a,n:r,unison:o=5,spread:i=.6,detune:l}=e;l=l??r??.18;const c=bh(e),[u,h,m,f]=ii([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),v=n+a,O=v+f+.01,k=Tu(o,1,100);let M=k>1?Tu(i,0,1):0,E=lo(s,"supersaw-oscillator",{frequency:c,begin:n,end:O,freqspread:l,voices:k,panspread:M},{outputChannelCount:[2]});const I=1/Math.sqrt(k);gm(E.parameters.get("detune"),e,n,v);const D=bm(E.parameters.get("detune"),e,n),F=cg(E.parameters.get("frequency"),e,n);let _=Gr(1);_=E.connect(_),oi(_.gain,u,h,m,f,0,.3*I,n,v,"linear");let $=Qd(s,()=>{xd(E),_.disconnect(),t(),F==null||F.stop(),D==null||D.stop()},n,O);return{node:_,stop:Z=>{$.stop(Z)}}},{prebake:!0,type:"synth"}),Ol("bytebeat",(n,e,t)=>{const s=["(t%255 >= t/255%255)*255","(t*(t*8%60 <= 300)|(-t)*(t*4%512 < 256))+t/400","t","t*(t >> 10^t)","t&128","t&t>>8","((t%255+t%128+t%64+t%32+t%16+t%127.8+t%64.8+t%32.8+t%16.8)/3)","((t%64+t%63.8+t%64.15+t%64.35+t%63.5)/1.25)","(t&(t>>7)-t)","(sin(t*PI/128)*127+127)","((t^t/2+t+64*(sin((t*PI/64)+(t*PI/32768))+64))%128*2)","((t^t/2+t+64*(cos >> 0))%127.85*2)","((t^t/2+t+64)%128*2)","(((t * .25)^(t * .25)/100+(t * .25))%128)*2","((t^t/2+t+64)%7 * 24)"],{n:a=0}=e,r=bh(e),{byteBeatExpression:o=s[a%s.length],byteBeatStartTime:i}=e,l=Xn();let{duration:c}=e;const[u,h,m,f]=ii([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),v=n+c,O=v+f+.01;let k=lo(l,"byte-beat-processor",{frequency:r,begin:n,end:O},{outputChannelCount:[2]});k.port.postMessage({codeText:o,byteBeatStartTime:i,frequency:r});let M=Gr(1);M=k.connect(M),oi(M.gain,u,h,m,f,0,1,n,v,"linear");let E=Qd(l,()=>{xd(k),M.disconnect(),t()},n,O);return{node:M,stop:I=>{E.stop(I)}}},{prebake:!0,type:"synth"}),Ol("pulse",(n,e,t)=>{const s=Xn();let{pwrate:a,pwsweep:r}=e;r==null&&(a!=null?r=.3:r=0),a==null&&r!=null&&(a=1);let{duration:o,pw:i=.5}=e;const l=bh(e),[c,u,h,m]=ii([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),f=n+o,v=f+m+.01;let O=lo(s,"pulse-oscillator",{frequency:l,begin:n,end:v,pulsewidth:i},{outputChannelCount:[2]});gm(O.parameters.get("detune"),e,n,f);const k=bm(O.parameters.get("detune"),e,n),M=cg(O.parameters.get("frequency"),e,n);let E=Gr(1);E=O.connect(E),oi(E.gain,c,u,h,m,0,1,n,f,"linear");let I;r!=0&&(I=e0(s,n,v,{frequency:a,depth:r}),I.connect(O.parameters.get("pulsewidth")));let D=Qd(s,()=>{xd(O),xd(I),E.disconnect(),t(),M==null||M.stop(),k==null||k.stop()},n,v);return{node:E,stop:F=>{D.stop(F)}}},{prebake:!0,type:"synth"}),[...a3].forEach(n=>{Ol(n,(e,t,s)=>{const[a,r,o,i]=ii([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]);let l,{density:c}=t;l=aS(n,e,c);let{node:u,stop:h,triggerRelease:m}=l;const f=Gr(.3),{duration:v}=t;u.onended=()=>{u.disconnect(),f.disconnect(),s()};const O=Gr(1);let k=u.connect(f).connect(O);const M=e+v;oi(k.gain,a,r,o,i,0,1,e,M,"linear");const E=M+i+.01;return m==null||m(E),h(E),{node:k,stop:I=>{h(I)}}},{type:"synth",prebake:!0})}),mPe.forEach(([n,e])=>Io.set({...Io.get(),[n]:Io.get()[e]}))}function gW(n,e){const t=new Float32Array(n+1),s=new Float32Array(n+1),a=Xn(),r=a.createOscillator(),o={sawtooth:c=>[0,-1/c],square:c=>[0,c%2===0?0:1/c],triangle:c=>[c%2===0?0:1/(c*c),0]};if(!o[e])throw new Error(`unknown wave type ${e}`);t[0]=0,s[0]=0;let i=1;for(;i<=n;){const[c,u]=o[e](i);t[i]=c,s[i]=u,i++}const l=a.createPeriodicWave(t,s);return r.setPeriodicWave(l),r}function bW(n,e,t){let{n:s,duration:a,noise:r=0}=t,o;!s||n==="sine"?(o=Xn().createOscillator(),o.type=n||"triangle"):o=gW(s,n),o.frequency.value=bh(t),o.start(e);let i=bm(o.detune,t,e);gm(o.detune,t,e,e+a);const l=cg(o.frequency,t,e);let c;return r&&(c=kke(o,r,e)),{node:(c==null?void 0:c.node)||o,stop:u=>{l.stop(u),i==null||i.stop(u),c==null||c.stop(u),o.stop(u)},triggerRelease:u=>{}}}function fPe(n=1,e=.05,t=220,s=0,a=0,r=.1,o=0,i=1,l=0,c=0,u=0,h=0,m=0,f=0,v=0,O=0,k=0,M=1,E=0,I=0){let D=Math.PI*2,F=Xn().sampleRate,_=Ne=>Ne>0?1:-1,$=l*=500*D/F/F,Z=t*=(1+e*2*Math.random()-e)*D/F,ce=[],U=0,ue=0,W=0,de=1,be=0,ke=0,Ce=0,Ae,q;for(s=s*F+9,E*=F,a*=F,r*=F,k*=F,c*=500*D/F**3,v*=D/F,u*=D/F,h*=F,m=m*F|0,q=s+E+a+r+k|0;W<q;ce[W++]=Ce)++ke%(O*100|0)||(Ce=o?o>1?o>2?o>3?Math.sin((U%D)**3):Math.max(Math.min(Math.tan(U),1),-1):1-(2*U/D%2+2)%2:1-4*Math.abs(Math.round(U/D)-U/D):Math.sin(U),Ce=(m?1-I+I*Math.sin(D*W/m):1)*_(Ce)*Math.abs(Ce)**i*n*1*(W<s?W/s:W<s+E?1-(W-s)/E*(1-M):W<s+E+a?M:W<q-k?(q-W-k)/r*M:0),Ce=k?Ce/2+(k>W?0:(W<q-k?1:(q-W)/k)*ce[W-k|0]/2):Ce),Ae=(t+=l+=c)*Math.cos(v*ue++),U+=Ae-Ae*f*(1-(Math.sin(W)+1)*1e9%2),de&&++de>h&&(t+=u,Z+=u,de=0),m&&!(++be%m)&&(t=Z,l=$,de||(de=1));return ce}const yW=(n,e)=>{let{s:t,note:s=36,freq:a,zrand:r=0,attack:o=0,decay:i=0,sustain:l=.8,release:c=.1,curve:u=1,slide:h=0,deltaSlide:m=0,pitchJump:f=0,pitchJumpTime:v=0,lfo:O=0,znoise:k=0,zmod:M=0,zcrush:E=0,zdelay:I=0,tremolo:D=0,duration:F=.2,zzfx:_}=n;const $=Math.max(F-o-i,0);typeof s=="string"&&(s=Mw(s)),!a&&typeof s=="number"&&(a=NX(s)),t=t.replace("z_","");const Z=["sine","triangle","sawtooth","tan","noise"].indexOf(t)||0;u=t==="square"?0:u;const ce=fPe(..._||[.25,r,a,o,$,c,Z,u,h,m,f,v,O,k,M,E,I,l,i,D]),U=Xn(),ue=U.createBuffer(1,ce.length,U.sampleRate);ue.getChannelData(0).set(ce);const W=Xn().createBufferSource();return W.buffer=ue,W.start(e),{node:W}};function vW(){["zzfx","z_sine","z_sawtooth","z_triangle","z_square","z_tan","z_noise"].forEach(n=>{Ol(n,(e,t,s)=>{const{node:a}=yW({s:n,...t},e);return a.onended=()=>{a.disconnect(),s()},{node:a,stop:()=>{}}},{type:"synth",prebake:!0})})}let Jo;async function wW(n,e){const t=`dsp-worklet-${Date.now()}`,s=`${e}
let __q = []; // trigger queue
class MyProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.t = 0;
    this.stopped = false;
    this.port.onmessage = (e) => {
      if(e.data==='stop') {
        this.stopped = true;
      } else if(e.data?.dough) {
        __q.push(e.data)
      } else {
        msg?.(e.data)
      }
    };
  }
  process(inputs, outputs, parameters) {
    const output = outputs[0];
    if(__q.length) {
      for(let i=0;i<__q.length;++i) {
        const deadline = __q[i].time-currentTime;
        if(deadline<=0) {
          trigger(__q[i].dough)
          __q.splice(i,1)
        }
      }
    }
    for (let i = 0; i < output[0].length; i++) {
      const out = dsp(this.t / sampleRate);
      output.forEach((channel) => {
        channel[i] = out;
      });
      this.t++;
    }
  return !this.stopped;
  }
}
registerProcessor('${t}', MyProcessor);
`,a=`data:text/javascript;base64,${btoa(s)}`;await n.audioWorklet.addModule(a);const r=new AudioWorkletNode(n,t);return{node:r,stop:()=>r.port.postMessage("stop")}}const OW=()=>{var n;Jo&&(Jo==null||Jo.stop(),(n=Jo==null?void 0:Jo.node)==null||n.disconnect())};typeof window<"u"&&window.addEventListener("message",n=>{var e;n.data==="strudel-stop"?OW():(e=n.data)!=null&&e.dough&&(Jo==null||Jo.node.port.postMessage(n.data))});const gPe=async n=>{const e=Xn();OW(),Jo=await wW(e,n),Jo.node.connect(e.destination)};function xW(n,e,t,s){window.postMessage({time:s,dough:n.value,currentTime:e,duration:n.duration,cps:t})}const lS=Object.freeze({NONE:0,ASYM:1,MIRROR:2,BENDP:3,BENDM:4,BENDMP:5,SYNC:6,QUANT:7,FOLD:8,PWM:9,ORBIT:10,SPIN:11,CHAOS:12,PRIMES:13,BINARY:14,BROWNIAN:15,RECIPROCAL:16,WORMHOLE:17,LOGISTIC:18,SIGMOID:19,FRACTAL:20,FLIP:21}),O4=new Set;async function bPe(n,e,t=2048){const s=`${n},${t}`;if(!O4.has(s)){const a=(await OPe(n,e)).getChannelData(0),r=a.length,o=Math.max(1,Math.floor(r/t)),i=new Array(o);for(let l=0;l<o;l++){const c=l*t;i[l]=a.subarray(c,c+t)}return O4.add(s),{frames:i,frameLen:t,numFrames:o,key:s}}return{frameLen:t,key:s}}function yPe(n,e){var t=1024;if(n<t)return n+" B";var s=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],a=-1;do n/=t,++a;while(n>=t);return n.toFixed(1)+" "+s[a]}function vPe(n){const e=new DataView(n);let t=12;for(;t+8<=e.byteLength;){const s=String.fromCharCode(e.getUint8(t),e.getUint8(t+1),e.getUint8(t+2),e.getUint8(t+3)),a=e.getUint32(t+4,!0);if(s==="fmt ")return e.getUint32(t+12,!0);t+=8+a+(a&1)}return null}async function wPe(n){const e=vPe(n)||44100;return await new OfflineAudioContext(1,1,e).decodeAudioData(n)}const Kx={},OPe=(n,e)=>{if(n=n.replace("#","%23"),!Kx[n]){Ma(`[wavetable] load table ${e}..`,"load-table",{url:n});const t=Date.now();Kx[n]=fetch(n).then(s=>s.arrayBuffer()).then(async s=>{const a=Date.now()-t,r=yPe(s.byteLength);return Ma(`[wavetable] load table ${e}... done! loaded ${r} in ${a}ms`,"loaded-table",{url:n}),await wPe(s)})}return Kx[n]};function kW(n,e=""){if(!n.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[t,s]=n.split("github:");return s=s.endsWith("/")?s.slice(0,-1):s,s.split("/").length===2&&(s+="/main"),`https://raw.githubusercontent.com/${s}/${e}`}const x4=(n,e,t,s={})=>(e=n._base||e,Object.entries(n).forEach(([a,r])=>{if(a==="_base")return!1;if(typeof r=="string"&&(r=[r]),typeof r!="object")throw new Error("wrong json format for "+a);let o=e;o.startsWith("github:")&&(o=kW(o,"")),r=r.map(i=>o+i).filter(i=>i.toLowerCase().endsWith(".wav")?!0:(Ma(`[wavetable] skipping ${i} -- wavetables must be ".wav" format`),!1)),r.length&&d3(a,r,{baseUrl:e,frameLen:t})}));function d3(n,e,t){Ol(n,(s,a,r,o)=>PW(s,a,r,e,o,(t==null?void 0:t.frameLen)??2048),{type:"wavetable",tables:e,...t})}const xPe=async(n,e,t,s={})=>{if(t!==void 0)return x4(t,n,e);if(n.startsWith("github:")&&(n=kW(n,"strudel.json")),n.startsWith("local:")&&(n="http://localhost:5432"),typeof fetch=="function"&&!(typeof fetch>"u"))return fetch(n).then(a=>a.json()).then(a=>x4(a,n,e,s)).catch(a=>{throw console.error(a),new Error(`error loading "${n}"`)})};async function PW(n,e,t,s,a,r){const{s:o,n:i=0,duration:l,clip:c}=e,u=Xn(),[h,m,f,v]=ii([e.attack,e.decay,e.sustain,e.release]);let{warpmode:O}=e;typeof O=="string"&&(O=lS[O.toUpperCase()]??lS.NONE);const k=bh(e),{url:M,label:E}=$X(e,s),I=await bPe(M,E,r);let D=n+l;c!==void 0&&(D=Math.min(n+c*l,D));const F=D+v,_=F+.01,$=lo(u,"wavetable-oscillator-processor",{begin:n,end:_,frequency:k,freqspread:e.detune,position:e.wt,warp:e.warp,warpMode:O,voices:Math.max(e.unison??1,1),panspread:e.spread,phaserand:e.wtphaserand??e.unison>1?1:0},{outputChannelCount:[2]});if($.port.postMessage({type:"table",payload:I}),u.currentTime>n){Ma(`[wavetable] still loading sound "${o}:${i}"`,"highlight");return}const Z=[e.wtattack,e.wtdecay,e.wtsustain,e.wtrelease],ce=[e.warpattack,e.warpdecay,e.warpsustain,e.warprelease],U=$.parameters,ue=U.get("position"),W=U.get("warp");let de=e.wtrate;e.wtsync!=null&&(de=a*e.wtsync);const be=rS(u,ue,n,F,{offset:e.wt,amount:e.wtenv,defaultAmount:.5,values:Z,holdEnd:D,defaultValues:[0,.5,0,.1]},{frequency:de,depth:e.wtdepth,defaultDepth:.5,shape:e.wtshape,skew:e.wtskew,dcoffset:e.wtdc??0});let ke=e.warprate;e.warpsync!=null&&(ke=ke=a*e.warpsync);const Ce=rS(u,W,n,F,{offset:e.warp,amount:e.warpenv,defaultAmount:.5,values:ce,holdEnd:D,defaultValues:[0,.5,0,.1]},{frequency:ke,depth:e.warpdepth,defaultDepth:.5,shape:e.warpshape,skew:e.warpskew,dcoffset:e.warpdc??0}),Ae=bm($.parameters.get("detune"),e,n),q=cg($.parameters.get("frequency"),e,n),Ne=u.createGain(),Re=$.connect(Ne);oi(Re.gain,h,m,f,v,0,.3,n,D,"linear"),gm($.parameters.get("detune"),e,n,D);const je={node:Re,source:$},me=Qd(u,()=>{xd($),Ae==null||Ae.stop(),q==null||q.stop(),Re.disconnect(),be==null||be.disconnect(),Ce==null||Ce.disconnect(),t()},n,_);return je.stop=Ye=>{me.stop(Ye)},je}let Sf;function kPe(){const n=Xn();Sf=lo(n,"dough-processor",{},{outputChannelCount:[2]}),mW(Sf)}const t1=new Map,k4=new Map;dt.prototype.supradough=function(){return this.onTrigger((n,e,t,s)=>{n.value._begin=s,n.value._duration=n.duration/t,!Sf&&kPe();const a=(n.value.bank?n.value.bank+"_":"")+n.value.s,r=n.value.n??0,o=`${a}:${r}`;if(t1.has(a)&&(n.value.s=o),t1.has(a)&&!k4.has(o)){const i=t1.get(a),l=i[r%i.length];console.log(`load ${o} from ${l}`);const c=CPe(l);k4.set(o,c),c.then(({channels:u,sampleRate:h})=>Sf.port.postMessage({sample:o,channels:u,sampleRate:h}))}Sf.port.postMessage({spawn:n.value})},1)};function PPe(n,e=""){if(!n.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[t,s]=n.split("github:");return s=s.endsWith("/")?s.slice(0,-1):s,s.split("/").length===2&&(s+="/main"),`https://raw.githubusercontent.com/${s}/${e}`}async function SPe(n){if(n.startsWith("github:")&&(n=PPe(n,"strudel.json")),n.startsWith("local:")&&(n="http://localhost:5432"),n.startsWith("shabda:")){let[s,a]=n.split("shabda:");n=`https://shabda.ndre.gr/${a}.json?strudel=1`}if(n.startsWith("shabda/speech")){let[s,a]=n.split("shabda/speech");a=a.startsWith("/")?a.substring(1):a;let[r,o]=a.split(":"),i="f",l="en-GB";r&&([l,i]=r.split("/")),n=`https://shabda.ndre.gr/speech/${o}.json?gender=${i}&language=${l}&strudel=1'`}if(typeof fetch!="function")return;const e=n.split("/").slice(0,-1).join("/");if(typeof fetch>"u")return;const t=await fetch(n).then(s=>s.json()).catch(s=>{throw console.error(s),new Error(`error loading "${n}"`)});return[t,t._base||e]}async function CPe(n){const e=await fetch(n).then(s=>s.arrayBuffer()).then(s=>Xn().decodeAudioData(s));let t=[];for(let s=0;s<e.numberOfChannels;s++)t.push(e.getChannelData(s));return{channels:t,sampleRate:e.sampleRate}}async function SW(n,e){if(typeof n=="string"){const[t,s]=await SPe(n);return SW(t,s)}Object.entries(n).map(async([t,s])=>{t!=="_base"&&(s=s.map(a=>e+a),t1.set(t,s))})}const MPe="data:text/javascript;base64,dmFyIGF0PU9iamVjdC5kZWZpbmVQcm9wZXJ0eTt2YXIgaHQ9KHUsbSxmKT0+bSBpbiB1P2F0KHUsbSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6Zn0pOnVbbV09Zjt2YXIgZT0odSxtLGYpPT5odCh1LHR5cGVvZiBtIT0ic3ltYm9sIj9tKyIiOm0sZik7KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IHU9dHlwZW9mIHNhbXBsZVJhdGU8InUiP3NhbXBsZVJhdGU6NDhlMyxtPU1hdGguUEkvdSxmPTEvdTtsZXQgVj1oPT5NYXRoLnBvdyhoLDIpO2Z1bmN0aW9uIF8oaCl7cmV0dXJuIFYoaCl9ZnVuY3Rpb24gTyhoLHMsdCl7Y29uc3QgaT1NYXRoLnNpbigoMS10KSouNSpNYXRoLlBJKSxuPU1hdGguc2luKHQqLjUqTWF0aC5QSSk7cmV0dXJuIGgqaStzKm59Y2xhc3MgZ3tjb25zdHJ1Y3Rvcigpe2UodGhpcywicGhhc2UiLDApfXVwZGF0ZShzKXtjb25zdCB0PU1hdGguc2luKHRoaXMucGhhc2UqMipNYXRoLlBJKTtyZXR1cm4gdGhpcy5waGFzZT0odGhpcy5waGFzZStzL3UpJTEsdH19Y2xhc3MgSXtjb25zdHJ1Y3Rvcigpe2UodGhpcywicGhhc2UiLDApfXVwZGF0ZShzKXtyZXR1cm4gdGhpcy5waGFzZSs9ZipzLHRoaXMucGhhc2UlMSoyLTF9fWZ1bmN0aW9uIE0oaCxzKXtyZXR1cm4gaDxzPyhoLz1zLGgraC1oKmgtMSk6aD4xLXM/KGg9KGgtMSkvcyxoKmgraCtoKzEpOjB9Y2xhc3MgU3tjb25zdHJ1Y3RvcihzPXt9KXt0aGlzLnBoYXNlPXMucGhhc2U/PzB9dXBkYXRlKHMpe2NvbnN0IHQ9cy91O2xldCBpPU0odGhpcy5waGFzZSx0KSxuPTIqdGhpcy5waGFzZS0xLWk7cmV0dXJuIHRoaXMucGhhc2UrPXQsdGhpcy5waGFzZT4xJiYodGhpcy5waGFzZS09MSksbn19ZnVuY3Rpb24gVChoLHMsdCl7cmV0dXJuIGg8Mj8wOigobixsLHIpPT5yKihsLW4pK24pKC1zKi41LHMqLjUsdC8oaC0xKSl9ZnVuY3Rpb24geihoLHMpe3JldHVybiBoKk1hdGgucG93KDIscy8xMil9Y2xhc3MgRntjb25zdHJ1Y3RvcihzPXt9KXt0aGlzLnZvaWNlcz1zLnZvaWNlcz8/NSx0aGlzLmZyZXFzcHJlYWQ9cy5mcmVxc3ByZWFkPz8uMix0aGlzLnBhbnNwcmVhZD1zLnBhbnNwcmVhZD8/LjQsdGhpcy5waGFzZT1uZXcgRmxvYXQzMkFycmF5KHRoaXMudm9pY2VzKS5tYXAoKCk9Pk1hdGgucmFuZG9tKCkpfXVwZGF0ZShzKXtjb25zdCB0PU1hdGguc3FydCgxLXRoaXMucGFuc3ByZWFkKSxpPU1hdGguc3FydCh0aGlzLnBhbnNwcmVhZCk7bGV0IG49MCxsPTA7Zm9yKGxldCByPTA7cjx0aGlzLnZvaWNlcztyKyspe2NvbnN0IGE9eihzLFQodGhpcy52b2ljZXMsdGhpcy5mcmVxc3ByZWFkLHIpKS91LGM9KHImMSk9PTE7bGV0IGQ9dDtjJiYoZD1pKTtsZXQgYj1NKHRoaXMucGhhc2Vbcl0sYSksRT0yKnRoaXMucGhhc2Vbcl0tMS1iO249bitFKmQsbD1sK0UqZCx0aGlzLnBoYXNlW3JdKz1hLHRoaXMucGhhc2Vbcl0+MSYmKHRoaXMucGhhc2Vbcl0tPTEpfXJldHVybiBuK2x9fWNsYXNzIGt7Y29uc3RydWN0b3IoKXtlKHRoaXMsInBoYXNlIiwwKX11cGRhdGUocyl7dGhpcy5waGFzZSs9ZipzO2xldCB0PXRoaXMucGhhc2UlMTtyZXR1cm4odDwuNT8yKnQ6MS0yKih0LS41KSkqMi0xfX1jbGFzcyBxe2NvbnN0cnVjdG9yKCl7ZSh0aGlzLCJzMCIsMCk7ZSh0aGlzLCJzMSIsMCl9dXBkYXRlKHMsdCxpPTApe2k9TWF0aC5tYXgoaSwwKSx0PU1hdGgubWluKHQsMmU0KTtjb25zdCBuPTIqTWF0aC5zaW4odCptKSxyPTEtTWF0aC5wb3coLjUsKGkrLjEyNSkvLjEyNSkqbjtyZXR1cm4gdGhpcy5zMD1yKnRoaXMuczAtbip0aGlzLnMxK24qcyx0aGlzLnMxPXIqdGhpcy5zMStuKnRoaXMuczAsdGhpcy5zMX19Y2xhc3MgQ3tjb25zdHJ1Y3RvcihzPTApe3RoaXMucGhhc2U9c31zYXcocyx0KXtsZXQgaT0odGhpcy5waGFzZStzKSUxLG49TShpLHQpO3JldHVybiAyKmktMS1ufXVwZGF0ZShzLHQ9LjUpe2NvbnN0IGk9cy91O2xldCBuPXRoaXMuc2F3KDAsaSktdGhpcy5zYXcodCxpKTtyZXR1cm4gdGhpcy5waGFzZT0odGhpcy5waGFzZStpKSUxLG4rdCoyLTF9fWNsYXNzIEx7Y29uc3RydWN0b3IoKXtlKHRoaXMsInBoYXNlIiwwKX11cGRhdGUocyx0PS41KXtyZXR1cm4gdGhpcy5waGFzZSs9ZipzLHRoaXMucGhhc2UlMTx0PzE6LTF9fWNsYXNzIFB7Y29uc3RydWN0b3IoKXtlKHRoaXMsInVwZGF0ZSIscz0+TWF0aC5yYW5kb20oKTxzKmY/TWF0aC5yYW5kb20oKTowKX19Y2xhc3MgTnt1cGRhdGUoKXtyZXR1cm4gTWF0aC5yYW5kb20oKSoyLTF9fWNsYXNzIEd7Y29uc3RydWN0b3IoKXt0aGlzLm91dD0wfXVwZGF0ZSgpe2xldCBzPU1hdGgucmFuZG9tKCkqMi0xO3JldHVybiB0aGlzLm91dD0odGhpcy5vdXQrLjAyKnMpLzEuMDIsdGhpcy5vdXR9fWNsYXNzIGp7Y29uc3RydWN0b3IoKXt0aGlzLmIwPTAsdGhpcy5iMT0wLHRoaXMuYjI9MCx0aGlzLmIzPTAsdGhpcy5iND0wLHRoaXMuYjU9MCx0aGlzLmI2PTB9dXBkYXRlKCl7Y29uc3Qgcz1NYXRoLnJhbmRvbSgpKjItMTt0aGlzLmIwPS45OTg4Nip0aGlzLmIwK3MqLjA1NTUxNzksdGhpcy5iMT0uOTkzMzIqdGhpcy5iMStzKi4wNzUwNzU5LHRoaXMuYjI9Ljk2OSp0aGlzLmIyK3MqLjE1Mzg1Mix0aGlzLmIzPS44NjY1KnRoaXMuYjMrcyouMzEwNDg1Nix0aGlzLmI0PS41NSp0aGlzLmI0K3MqLjUzMjk1MjIsdGhpcy5iNT0tLjc2MTYqdGhpcy5iNS1zKi4wMTY4OTg7Y29uc3QgdD10aGlzLmIwK3RoaXMuYjErdGhpcy5iMit0aGlzLmIzK3RoaXMuYjQrdGhpcy5iNSt0aGlzLmI2K3MqLjUzNjI7cmV0dXJuIHRoaXMuYjY9cyouMTE1OTI2LHQqLjExfX1jbGFzcyBCe2NvbnN0cnVjdG9yKCl7ZSh0aGlzLCJwaGFzZSIsMSl9dXBkYXRlKHMpe3RoaXMucGhhc2UrPWYqcztsZXQgdD10aGlzLnBoYXNlPj0xPzE6MDtyZXR1cm4gdGhpcy5waGFzZT10aGlzLnBoYXNlJTEsdH19ZnVuY3Rpb24gUihoLHMsdCxpPTEpe2lmKGg8PTApcmV0dXJuIHM7aWYoaD49MSlyZXR1cm4gdDtsZXQgbjtyZXR1cm4gaT09PTA/bj1oOmk+MD9uPU1hdGgucG93KGgsaSk6bj0xLU1hdGgucG93KDEtaCwtaSkscysodC1zKSpufWNsYXNzIHZ7Y29uc3RydWN0b3Iocz17fSl7dGhpcy5zdGF0ZT0ib2ZmIix0aGlzLnN0YXJ0VGltZT0wLHRoaXMuc3RhcnRWYWw9MCx0aGlzLmRlY2F5Q3VydmU9cy5kZWNheUN1cnZlPz8xfXVwZGF0ZShzLHQsaSxuLGwscil7c3dpdGNoKHRoaXMuc3RhdGUpe2Nhc2Uib2ZmIjpyZXR1cm4gdD4wJiYodGhpcy5zdGF0ZT0iYXR0YWNrIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9MCksMDtjYXNlImF0dGFjayI6e2xldCBwPXMtdGhpcy5zdGFydFRpbWU7cmV0dXJuIHA+aT8odGhpcy5zdGF0ZT0iZGVjYXkiLHRoaXMuc3RhcnRUaW1lPXMsMSk6UihwL2ksdGhpcy5zdGFydFZhbCwxLDEpfWNhc2UiZGVjYXkiOntsZXQgcD1zLXRoaXMuc3RhcnRUaW1lLGE9UihwL24sMSxsLC10aGlzLmRlY2F5Q3VydmUpO3JldHVybiB0PD0wPyh0aGlzLnN0YXRlPSJyZWxlYXNlIix0aGlzLnN0YXJ0VGltZT1zLHRoaXMuc3RhcnRWYWw9YSxhKTpwPm4/KHRoaXMuc3RhdGU9InN1c3RhaW4iLHRoaXMuc3RhcnRUaW1lPXMsbCk6YX1jYXNlInN1c3RhaW4iOnJldHVybiB0PD0wJiYodGhpcy5zdGF0ZT0icmVsZWFzZSIsdGhpcy5zdGFydFRpbWU9cyx0aGlzLnN0YXJ0VmFsPWwpLGw7Y2FzZSJyZWxlYXNlIjp7bGV0IHA9cy10aGlzLnN0YXJ0VGltZTtpZihwPnIpcmV0dXJuIHRoaXMuc3RhdGU9Im9mZiIsMDtsZXQgYT1SKHAvcix0aGlzLnN0YXJ0VmFsLDAsLXRoaXMuZGVjYXlDdXJ2ZSk7cmV0dXJuIHQ+MCYmKHRoaXMuc3RhdGU9ImF0dGFjayIsdGhpcy5zdGFydFRpbWU9cyx0aGlzLnN0YXJ0VmFsPWEpLGF9fXRocm93ImludmFsaWQgZW52ZWxvcGUgc3RhdGUifX1jb25zdCBXPTEwO2NsYXNzIHh7Y29uc3RydWN0b3IoKXtlKHRoaXMsIndyaXRlSWR4IiwwKTtlKHRoaXMsInJlYWRJZHgiLDApO2UodGhpcywiYnVmZmVyIixuZXcgRmxvYXQzMkFycmF5KFcqdSkpfXdyaXRlKHMsdCl7dGhpcy53cml0ZUlkeD0odGhpcy53cml0ZUlkeCsxKSV0aGlzLmJ1ZmZlci5sZW5ndGgsdGhpcy5idWZmZXJbdGhpcy53cml0ZUlkeF09cztsZXQgaT1NYXRoLm1pbihNYXRoLmZsb29yKHUqdCksdGhpcy5idWZmZXIubGVuZ3RoLTEpO3RoaXMucmVhZElkeD10aGlzLndyaXRlSWR4LWksdGhpcy5yZWFkSWR4PDAmJih0aGlzLnJlYWRJZHgrPXRoaXMuYnVmZmVyLmxlbmd0aCl9dXBkYXRlKHMsdCl7cmV0dXJuIHRoaXMud3JpdGUocyx0KSx0aGlzLmJ1ZmZlclt0aGlzLnJlYWRJZHhdfX1jbGFzcyBYe2NvbnN0cnVjdG9yKCl7ZSh0aGlzLCJkZWxheSIsbmV3IHgpO2UodGhpcywibW9kdWxhdG9yIixuZXcgayl9dXBkYXRlKHMsdCxpLG4sbCl7Y29uc3Qgcj10aGlzLm1vZHVsYXRvci51cGRhdGUobikqbCxwPXRoaXMuZGVsYXkudXBkYXRlKHMsaSooMStyKSk7cmV0dXJuIE8ocyxwLHQpfX1jbGFzcyAke2NvbnN0cnVjdG9yKCl7ZSh0aGlzLCJob2xkIiwwKTtlKHRoaXMsInQiLDApfXVwZGF0ZShzLHQpe3JldHVybiB0aGlzLnQrKyV0PT09MCYmKHRoaXMudD0wLHRoaXMuaG9sZD1zKSx0aGlzLmhvbGR9fWNsYXNzIFV7dXBkYXRlKHMsdCl7dD1NYXRoLm1heCgxLHQpO2NvbnN0IGk9TWF0aC5wb3coMix0LTEpO3JldHVybiBNYXRoLnJvdW5kKHMqaSkvaX19Y2xhc3MgWXt1cGRhdGUocyx0PTAsaT0xKXtpPU1hdGgubWF4KC4wMDEsTWF0aC5taW4oMSxpKSk7Y29uc3Qgbj1NYXRoLmV4cG0xKHQpO3JldHVybigxK24pKnMvKDErbipNYXRoLmFicyhzKSkqaX19Y2xhc3Mgd3tjb25zdHJ1Y3RvcihzLHQsaSl7ZSh0aGlzLCJidWZmZXIiKTtlKHRoaXMsInNhbXBsZVJhdGUiKTtlKHRoaXMsInBvcyIsMCk7ZSh0aGlzLCJzYW1wbGVGcmVxIixBKCkpO3RoaXMuYnVmZmVyPXMsdGhpcy5zYW1wbGVSYXRlPXQsdGhpcy5kdXJhdGlvbj10aGlzLmJ1ZmZlci5sZW5ndGgvdGhpcy5zYW1wbGVSYXRlLHRoaXMuc3BlZWQ9dS90aGlzLnNhbXBsZVJhdGUsaSYmKHRoaXMuc3BlZWQqPXRoaXMuZHVyYXRpb24pfXVwZGF0ZShzKXtpZih0aGlzLnBvcz49dGhpcy5idWZmZXIubGVuZ3RoKXJldHVybiAwO2NvbnN0IHQ9cy90aGlzLnNhbXBsZUZyZXEqdGhpcy5zcGVlZDtsZXQgaT10aGlzLmJ1ZmZlcltNYXRoLmZsb29yKHRoaXMucG9zKV07cmV0dXJuIHRoaXMucG9zPXRoaXMucG9zK3QsaX19ZSh3LCJzYW1wbGVzIixuZXcgTWFwKTtjb25zdCB5PShoLHM9ImxpbmVhciIsdCk9Pntjb25zdFtyLHAsYSxjXT1oO2lmKHI9PW51bGwmJnA9PW51bGwmJmE9PW51bGwmJmM9PW51bGwpcmV0dXJuIHQ/P1suMDAxLC4wMDEsMSwuMDFdO2NvbnN0IGQ9YT8/KHIhPW51bGwmJnA9PW51bGx8fHI9PW51bGwmJnA9PW51bGw/MTouMDAxKTtyZXR1cm5bTWF0aC5tYXgocj8/MCwuMDAxKSxNYXRoLm1heChwPz8wLC4wMDEpLE1hdGgubWluKGQsMSksTWF0aC5tYXgoYz8/MCwuMDEpXX07bGV0IEQ9e3NpbmU6ZyxzYXc6Uyx6YXc6SSxzYXd0b290aDpTLHphd3Rvb3RoOkksc3VwZXJzYXc6Rix0cmk6ayx0cmlhbmdsZTprLHB1bHNlOkMsc3F1YXJlOkMscHVsemU6TCxkdXN0OlAsY3JhY2tsZTpQLGltcHVsc2U6Qix3aGl0ZTpOLGJyb3duOkcscGluazpqfTtjb25zdCBaPXtjaG9ydXM6MCxub3RlOjQ4LHM6InRyaWFuZ2xlIixiYW5rOiIiLGdhaW46MSxwb3N0Z2FpbjoxLHZlbG9jaXR5OjEsZGVuc2l0eToiLjAzIixmdHlwZToiMTJkYiIsZmFuY2hvcjowLHJlc29uYW5jZTowLGhyZXNvbmFuY2U6MCxiYW5kcTowLGNoYW5uZWxzOlsxLDJdLHBoYXNlcmRlcHRoOi43NSxzaGFwZXZvbDoxLGRpc3RvcnR2b2w6MSxkZWxheTowLGJ5dGVCZWF0RXhwcmVzc2lvbjoiMCIsZGVsYXlmZWVkYmFjazouNSxkZWxheXNwZWVkOjEsZGVsYXl0aW1lOi4yNSxvcmJpdDoxLGk6MSxmZnQ6OCx6OiJ0cmlhbmdsZSIscGFuOi41LGZtaDoxLGZtZW52OjAsc3BlZWQ6MSxwdzouNX07bGV0IG89aD0+WltoXTtjb25zdCBIPXtjOjAsZDoyLGU6NCxmOjUsZzo3LGE6OSxiOjExfSxKPXsiIyI6MSxiOi0xLHM6MSxmOi0xfSxLPShoLHM9Myk9Pnt2YXIgYTtsZXRbdCxpPSIiLG49IiJdPSgoYT1TdHJpbmcoaCkubWF0Y2goL14oW2EtZ0EtR10pKFsjYnNmXSopKFswLTldKikkLykpPT1udWxsP3ZvaWQgMDphLnNsaWNlKDEpKXx8W107aWYoIXQpdGhyb3cgbmV3IEVycm9yKCdub3QgYSBub3RlOiAiJytoKyciJyk7Y29uc3QgbD1IW3QudG9Mb3dlckNhc2UoKV0scj0oaT09bnVsbD92b2lkIDA6aS5zcGxpdCgiIikucmVkdWNlKChjLGQpPT5jK0pbZF0sMCkpfHwwO3JldHVybihOdW1iZXIobnx8cykrMSkqMTIrbCtyfSxRPWg9Pk1hdGgucG93KDIsKGgtNjkpLzEyKSo0NDAsQT1oPT4oaD1ofHxvKCJub3RlIiksdHlwZW9mIGg9PSJzdHJpbmciJiYoaD1LKGgsMykpLFEoaCkpO2NsYXNzIHR0e2NvbnN0cnVjdG9yKHMpe2UodGhpcywiaWQiLDApO2UodGhpcywib3V0IixbMCwwXSk7ZSh0aGlzLCJhdHRhY2siKTtlKHRoaXMsImRlY2F5Iik7ZSh0aGlzLCJzdXN0YWluIik7ZSh0aGlzLCJyZWxlYXNlIik7ZSh0aGlzLCJfYmVnaW4iKTtlKHRoaXMsIl9kdXJhdGlvbiIpO2UodGhpcywiX3NvdW5kIik7ZSh0aGlzLCJfY2hhbm5lbHMiLDEpO2UodGhpcywiX2J1ZmZlcnMiKTtlKHRoaXMsInVuaXQiKTtlKHRoaXMsIl9wZW52Iik7ZSh0aGlzLCJwZW52Iik7ZSh0aGlzLCJwYXR0YWNrIik7ZSh0aGlzLCJwZGVjYXkiKTtlKHRoaXMsInBzdXN0YWluIik7ZSh0aGlzLCJwcmVsZWFzZSIpO2UodGhpcywidmliIik7ZSh0aGlzLCJfdmliIik7ZSh0aGlzLCJ2aWJtb2QiKTtlKHRoaXMsIl9mbSIpO2UodGhpcywiZm1oIik7ZSh0aGlzLCJmbWkiKTtlKHRoaXMsIl9mbWVudiIpO2UodGhpcywiZm1hdHRhY2siKTtlKHRoaXMsImZtZGVjYXkiKTtlKHRoaXMsImZtc3VzdGFpbiIpO2UodGhpcywiZm1yZWxlYXNlIik7ZSh0aGlzLCJfbHBlbnYiKTtlKHRoaXMsImxwZW52Iik7ZSh0aGlzLCJscGF0dGFjayIpO2UodGhpcywibHBkZWNheSIpO2UodGhpcywibHBzdXN0YWluIik7ZSh0aGlzLCJscHJlbGVhc2UiKTtlKHRoaXMsIl9ocGVudiIpO2UodGhpcywiaHBlbnYiKTtlKHRoaXMsImhwYXR0YWNrIik7ZSh0aGlzLCJocGRlY2F5Iik7ZSh0aGlzLCJocHN1c3RhaW4iKTtlKHRoaXMsImhwcmVsZWFzZSIpO2UodGhpcywiX2JwZW52Iik7ZSh0aGlzLCJicGVudiIpO2UodGhpcywiYnBhdHRhY2siKTtlKHRoaXMsImJwZGVjYXkiKTtlKHRoaXMsImJwc3VzdGFpbiIpO2UodGhpcywiYnByZWxlYXNlIik7ZSh0aGlzLCJjdXRvZmYiKTtlKHRoaXMsImhjdXRvZmYiKTtlKHRoaXMsImJhbmRmIik7ZSh0aGlzLCJjb2Fyc2UiKTtlKHRoaXMsImNydXNoIik7ZSh0aGlzLCJkaXN0b3J0Iik7ZSh0aGlzLCJmcmVxIik7ZSh0aGlzLCJub3RlIik7ZSh0aGlzLCJfbHBmIik7ZSh0aGlzLCJfaHBmIik7ZSh0aGlzLCJfYnBmIik7ZSh0aGlzLCJfY2hvcnVzIik7ZSh0aGlzLCJfY29hcnNlIik7ZSh0aGlzLCJfY3J1c2giKTtlKHRoaXMsIl9kaXN0b3J0Iik7dmFyIGksbixsLHIscCxhLGM7dGhpcy5mcmVxPz8odGhpcy5mcmVxPUEocy5ub3RlKSksdGhpcy5fYmVnaW49cy5fYmVnaW4sdGhpcy5fZHVyYXRpb249cy5fZHVyYXRpb24sdGhpcy5yZWxlYXNlPXMucmVsZWFzZT8/MDtsZXQgdD10aGlzO2lmKE9iamVjdC5hc3NpZ24odCxzKSx0LnM9dC5zPz9vKCJzIiksdC5nYWluPV8odC5nYWluPz9vKCJnYWluIikpLHQudmVsb2NpdHk9Xyh0LnZlbG9jaXR5Pz9vKCJ2ZWxvY2l0eSIpKSx0LnBvc3RnYWluPV8odC5wb3N0Z2Fpbj8/bygicG9zdGdhaW4iKSksdC5kZW5zaXR5PXQuZGVuc2l0eT8/bygiZGVuc2l0eSIpLHQuZmFuY2hvcj10LmZhbmNob3I/P28oImZhbmNob3IiKSx0LmRyaXZlPXQuZHJpdmU/Py42OSx0LnBoYXNlcmRlcHRoPXQucGhhc2VyZGVwdGg/P28oInBoYXNlcmRlcHRoIiksdC5zaGFwZXZvbD1fKHQuc2hhcGV2b2w/P28oInNoYXBldm9sIikpLHQuZGlzdG9ydHZvbD1fKHQuZGlzdG9ydHZvbD8/bygiZGlzdG9ydHZvbCIpKSx0Lmk9dC5pPz9vKCJpIiksdC5jaG9ydXM9dC5jaG9ydXM/P28oImNob3J1cyIpLHQuZmZ0PXQuZmZ0Pz9vKCJmZnQiKSx0LnBhbj10LnBhbj8/bygicGFuIiksdC5vcmJpdD10Lm9yYml0Pz9vKCJvcmJpdCIpLHQuZm1lbnY9dC5mbWVudj8/bygiZm1lbnYiKSx0LnJlc29uYW5jZT10LnJlc29uYW5jZT8/bygicmVzb25hbmNlIiksdC5ocmVzb25hbmNlPXQuaHJlc29uYW5jZT8/bygiaHJlc29uYW5jZSIpLHQuYmFuZHE9dC5iYW5kcT8/bygiYmFuZHEiKSx0LnNwZWVkPXQuc3BlZWQ/P28oInNwZWVkIiksdC5wdz10LnB3Pz9vKCJwdyIpLFt0LmF0dGFjayx0LmRlY2F5LHQuc3VzdGFpbix0LnJlbGVhc2VdPXkoW3QuYXR0YWNrLHQuZGVjYXksdC5zdXN0YWluLHQucmVsZWFzZV0pLHQuX2hvbGRFbmQ9dC5fYmVnaW4rdC5fZHVyYXRpb24sdC5fZW5kPXQuX2hvbGRFbmQrdC5yZWxlYXNlKy4wMSx0LmZtaSYmKHQucz09PSJzYXcifHx0LnM9PT0ic2F3dG9vdGgiKSYmKHQucz0iemF3IiksRFt0LnNdKXtjb25zdCBkPURbdC5zXTt0Ll9zb3VuZD1uZXcgZCx0Ll9jaGFubmVscz0xfWVsc2UgaWYody5zYW1wbGVzLmhhcyh0LnMpKXtjb25zdCBkPXcuc2FtcGxlcy5nZXQodC5zKTt0Ll9idWZmZXJzPVtdLHQuX2NoYW5uZWxzPWQuY2hhbm5lbHMubGVuZ3RoO2ZvcihsZXQgYj0wO2I8dC5fY2hhbm5lbHM7YisrKXQuX2J1ZmZlcnMucHVzaChuZXcgdyhkLmNoYW5uZWxzW2JdLGQuc2FtcGxlUmF0ZSx0LnVuaXQ9PT0iYyIpKX1lbHNlIGNvbnNvbGUud2Fybigic291bmQgbm90IGxvYWRlZCIsdC5zKTt0LnBlbnYmJih0Ll9wZW52PW5ldyB2KHtkZWNheUN1cnZlOjR9KSxbdC5wYXR0YWNrLHQucGRlY2F5LHQucHN1c3RhaW4sdC5wcmVsZWFzZV09eShbdC5wYXR0YWNrLHQucGRlY2F5LHQucHN1c3RhaW4sdC5wcmVsZWFzZV0pKSx0LnZpYiYmKHQuX3ZpYj1uZXcgZyx0LnZpYm1vZD10LnZpYm1vZD8/bygidmlibW9kIikpLHQuZm1pJiYodC5fZm09bmV3IGcsdC5mbWg9dC5mbWg/P28oImZtaCIpLHQuZm1lbnYmJih0Ll9mbWVudj1uZXcgdih7ZGVjYXlDdXJ2ZToyfSksW3QuZm1hdHRhY2ssdC5mbWRlY2F5LHQuZm1zdXN0YWluLHQuZm1yZWxlYXNlXT15KFt0LmZtYXR0YWNrLHQuZm1kZWNheSx0LmZtc3VzdGFpbix0LmZtcmVsZWFzZV0pKSksdC5fYWRzcj1uZXcgdih7ZGVjYXlDdXJ2ZToyfSksdC5kZWxheT1fKHQuZGVsYXk/P28oImRlbGF5IikpLHQuZGVsYXlmZWVkYmFjaz10LmRlbGF5ZmVlZGJhY2s/P28oImRlbGF5ZmVlZGJhY2siKSx0LmRlbGF5c3BlZWQ9dC5kZWxheXNwZWVkPz9vKCJkZWxheXNwZWVkIiksdC5kZWxheXRpbWU9dC5kZWxheXRpbWU/P28oImRlbGF5dGltZSIpLHQubHBlbnYmJih0Ll9scGVudj1uZXcgdih7ZGVjYXlDdXJ2ZTo0fSksW3QubHBhdHRhY2ssdC5scGRlY2F5LHQubHBzdXN0YWluLHQubHByZWxlYXNlXT15KFt0LmxwYXR0YWNrLHQubHBkZWNheSx0Lmxwc3VzdGFpbix0LmxwcmVsZWFzZV0pKSx0LmhwZW52JiYodC5faHBlbnY9bmV3IHYoe2RlY2F5Q3VydmU6NH0pLFt0LmhwYXR0YWNrLHQuaHBkZWNheSx0Lmhwc3VzdGFpbix0LmhwcmVsZWFzZV09eShbdC5ocGF0dGFjayx0LmhwZGVjYXksdC5ocHN1c3RhaW4sdC5ocHJlbGVhc2VdKSksdC5icGVudiYmKHQuX2JwZW52PW5ldyB2KHtkZWNheUN1cnZlOjR9KSxbdC5icGF0dGFjayx0LmJwZGVjYXksdC5icHN1c3RhaW4sdC5icHJlbGVhc2VdPXkoW3QuYnBhdHRhY2ssdC5icGRlY2F5LHQuYnBzdXN0YWluLHQuYnByZWxlYXNlXSkpLHQuX2Nob3J1cz10LmNob3J1cz9bXTpudWxsLHQuX2xwZj10LmN1dG9mZj9bXTpudWxsLHQuX2hwZj10LmhjdXRvZmY/W106bnVsbCx0Ll9icGY9dC5iYW5kZj9bXTpudWxsLHQuX2NvYXJzZT10LmNvYXJzZT9bXTpudWxsLHQuX2NydXNoPXQuY3J1c2g/W106bnVsbCx0Ll9kaXN0b3J0PXQuZGlzdG9ydD9bXTpudWxsO2ZvcihsZXQgZD0wO2Q8dGhpcy5fY2hhbm5lbHM7ZCsrKShpPXQuX2xwZik9PW51bGx8fGkucHVzaChuZXcgcSksKG49dC5faHBmKT09bnVsbHx8bi5wdXNoKG5ldyBxKSwobD10Ll9icGYpPT1udWxsfHxsLnB1c2gobmV3IHEpLChyPXQuX2Nob3J1cyk9PW51bGx8fHIucHVzaChuZXcgWCksKHA9dC5fY29hcnNlKT09bnVsbHx8cC5wdXNoKG5ldyAkKSwoYT10Ll9jcnVzaCk9PW51bGx8fGEucHVzaChuZXcgVSksKGM9dC5fZGlzdG9ydCk9PW51bGx8fGMucHVzaChuZXcgWSl9dXBkYXRlKHMpe2lmKCF0aGlzLl9zb3VuZCYmIXRoaXMuX2J1ZmZlcnMpcmV0dXJuIDA7bGV0IHQ9KyhzPj10aGlzLl9iZWdpbiYmczw9dGhpcy5faG9sZEVuZCksaT10aGlzLmZyZXEqdGhpcy5zcGVlZDtpZih0aGlzLl9mbSYmdGhpcy5mbWghPT12b2lkIDAmJnRoaXMuZm1pIT09dm9pZCAwKXtsZXQgYT10aGlzLmZtaTtpZih0aGlzLl9mbWVudil7Y29uc3QgYj10aGlzLl9mbWVudi51cGRhdGUocyx0LHRoaXMuZm1hdHRhY2ssdGhpcy5mbWRlY2F5LHRoaXMuZm1zdXN0YWluLHRoaXMuZm1yZWxlYXNlKTthPXRoaXMuZm1lbnYqYiphfWNvbnN0IGM9aSp0aGlzLmZtaCxkPWMqYTtpPWkrdGhpcy5fZm0udXBkYXRlKGMpKmR9aWYodGhpcy5fdmliJiZ0aGlzLnZpYm1vZCE9PXZvaWQgMCYmKGk9aSoyKioodGhpcy5fdmliLnVwZGF0ZSh0aGlzLnZpYikqdGhpcy52aWJtb2QvMTIpKSx0aGlzLl9wZW52JiZ0aGlzLnBlbnYhPT12b2lkIDApe2NvbnN0IGE9dGhpcy5fcGVudi51cGRhdGUocyx0LHRoaXMucGF0dGFjayx0aGlzLnBkZWNheSx0aGlzLnBzdXN0YWluLHRoaXMucHJlbGVhc2UpO2k9aSthKnRoaXMucGVudn1sZXQgbj10aGlzLmN1dG9mZjtpZihuIT09dm9pZCAwJiZ0aGlzLl9scGVudil7Y29uc3QgYT10aGlzLl9scGVudi51cGRhdGUocyx0LHRoaXMubHBhdHRhY2ssdGhpcy5scGRlY2F5LHRoaXMubHBzdXN0YWluLHRoaXMubHByZWxlYXNlKTtuPXRoaXMubHBlbnYqYSpuK259bGV0IGw9dGhpcy5oY3V0b2ZmO2lmKGwhPT12b2lkIDAmJnRoaXMuX2hwZW52JiZ0aGlzLmhwZW52IT09dm9pZCAwKXtjb25zdCBhPXRoaXMuX2hwZW52LnVwZGF0ZShzLHQsdGhpcy5ocGF0dGFjayx0aGlzLmhwZGVjYXksdGhpcy5ocHN1c3RhaW4sdGhpcy5ocHJlbGVhc2UpO2w9MioqdGhpcy5ocGVudiphKmwrbH1sZXQgcj10aGlzLmJhbmRmO2lmKHIhPT12b2lkIDAmJnRoaXMuX2JwZW52JiZ0aGlzLmJwZW52IT09dm9pZCAwKXtjb25zdCBhPXRoaXMuX2JwZW52LnVwZGF0ZShzLHQsdGhpcy5icGF0dGFjayx0aGlzLmJwZGVjYXksdGhpcy5icHN1c3RhaW4sdGhpcy5icHJlbGVhc2UpO3I9MioqdGhpcy5icGVudiphKnIrcn1jb25zdCBwPXRoaXMuX2Fkc3IudXBkYXRlKHMsdCx0aGlzLmF0dGFjayx0aGlzLmRlY2F5LHRoaXMuc3VzdGFpbix0aGlzLnJlbGVhc2UpO2ZvcihsZXQgYT0wO2E8dGhpcy5fY2hhbm5lbHM7YSsrKXtpZih0aGlzLl9zb3VuZCYmdGhpcy5zPT09InB1bHNlIj90aGlzLm91dFthXT10aGlzLl9zb3VuZC51cGRhdGUoaSx0aGlzLnB3KTp0aGlzLl9zb3VuZD90aGlzLm91dFthXT10aGlzLl9zb3VuZC51cGRhdGUoaSk6dGhpcy5fYnVmZmVycyYmKHRoaXMub3V0W2FdPXRoaXMuX2J1ZmZlcnNbYV0udXBkYXRlKGkpKSx0aGlzLm91dFthXT10aGlzLm91dFthXSp0aGlzLmdhaW4qdGhpcy52ZWxvY2l0eSx0aGlzLl9jaG9ydXMpe2NvbnN0IGM9dGhpcy5fY2hvcnVzW2FdLnVwZGF0ZSh0aGlzLm91dFthXSx0aGlzLmNob3J1cywuMDMrLjA1KmEsMSwuMTEpO3RoaXMub3V0W2FdPWMrdGhpcy5vdXRbYV19dGhpcy5fbHBmJiYodGhpcy5fbHBmW2FdLnVwZGF0ZSh0aGlzLm91dFthXSxuLHRoaXMucmVzb25hbmNlKSx0aGlzLm91dFthXT10aGlzLl9scGZbYV0uczEpLHRoaXMuX2hwZiYmKHRoaXMuX2hwZlthXS51cGRhdGUodGhpcy5vdXRbYV0sbCx0aGlzLmhyZXNvbmFuY2UpLHRoaXMub3V0W2FdPXRoaXMub3V0W2FdLXRoaXMuX2hwZlthXS5zMSksdGhpcy5fYnBmJiYodGhpcy5fYnBmW2FdLnVwZGF0ZSh0aGlzLm91dFthXSxyLHRoaXMuYmFuZHEpLHRoaXMub3V0W2FdPXRoaXMuX2JwZlthXS5zMCksdGhpcy5fY29hcnNlJiYodGhpcy5vdXRbYV09dGhpcy5fY29hcnNlW2FdLnVwZGF0ZSh0aGlzLm91dFthXSx0aGlzLmNvYXJzZSkpLHRoaXMuX2NydXNoJiYodGhpcy5vdXRbYV09dGhpcy5fY3J1c2hbYV0udXBkYXRlKHRoaXMub3V0W2FdLHRoaXMuY3J1c2gpKSx0aGlzLl9kaXN0b3J0JiYodGhpcy5vdXRbYV09dGhpcy5fZGlzdG9ydFthXS51cGRhdGUodGhpcy5vdXRbYV0sdGhpcy5kaXN0b3J0LHRoaXMuZGlzdG9ydHZvbCkpLHRoaXMub3V0W2FdPXRoaXMub3V0W2FdKnAsdGhpcy5vdXRbYV09dGhpcy5vdXRbYV0qdGhpcy5wb3N0Z2Fpbix0aGlzLl9idWZmZXJzfHwodGhpcy5vdXRbYV09dGhpcy5vdXRbYV0qLjIpfWlmKHRoaXMuX2NoYW5uZWxzPT09MSYmKHRoaXMub3V0WzFdPXRoaXMub3V0WzBdKSx0aGlzLnBhbiE9PS41KXtjb25zdCBhPXRoaXMucGFuKk1hdGguUEkvMjt0aGlzLm91dFswXT10aGlzLm91dFswXSpNYXRoLmNvcyhhKSx0aGlzLm91dFsxXT10aGlzLm91dFsxXSpNYXRoLnNpbihhKX19fWNsYXNzIHN0e2NvbnN0cnVjdG9yKHM9NDhlMyx0PTApe2UodGhpcywidm9pY2VzIixbXSk7ZSh0aGlzLCJ2aWQiLDApO2UodGhpcywicSIsW10pO2UodGhpcywib3V0IixbMCwwXSk7ZSh0aGlzLCJkZWxheXNlbmQiLFswLDBdKTtlKHRoaXMsImRlbGF5dGltZSIsbygiZGVsYXl0aW1lIikpO2UodGhpcywiZGVsYXlmZWVkYmFjayIsbygiZGVsYXlmZWVkYmFjayIpKTtlKHRoaXMsImRlbGF5c3BlZWQiLG8oImRlbGF5c3BlZWQiKSk7ZSh0aGlzLCJ0IiwwKTt0aGlzLnNhbXBsZVJhdGU9cyx0aGlzLnQ9TWF0aC5mbG9vcih0KnMpLHRoaXMuX2RlbGF5TD1uZXcgeCx0aGlzLl9kZWxheVI9bmV3IHh9bG9hZFNhbXBsZShzLHQsaSl7dy5zYW1wbGVzLnNldChzLHtjaGFubmVsczp0LHNhbXBsZVJhdGU6aX0pfXNjaGVkdWxlU3Bhd24ocyl7aWYocy5fYmVnaW49PT12b2lkIDApdGhyb3cgbmV3IEVycm9yKCJbZG91Z2hdOiBzY2hlZHVsZVNwYXduIGV4cGVjdGVkIF9iZWdpbiB0byBiZSBzZXQiKTtpZihzLl9kdXJhdGlvbj09PXZvaWQgMCl0aHJvdyBuZXcgRXJyb3IoIltkb3VnaF06IHNjaGVkdWxlU3Bhd24gZXhwZWN0ZWQgX2R1cmF0aW9uIHRvIGJlIHNldCIpO3Muc2FtcGxlUmF0ZT10aGlzLnNhbXBsZVJhdGU7Y29uc3QgdD1NYXRoLmZsb29yKHMuX2JlZ2luKnRoaXMuc2FtcGxlUmF0ZSk7dGhpcy5zY2hlZHVsZSh7dGltZTp0LHR5cGU6InNwYXduIixhcmc6c30pfXNwYXduKHMpe3MuaWQ9dGhpcy52aWQrKztjb25zdCB0PW5ldyB0dChzKTt0aGlzLnZvaWNlcy5wdXNoKHQpO2NvbnN0IGk9TWF0aC5jZWlsKHQuX2VuZCp0aGlzLnNhbXBsZVJhdGUpO3RoaXMuc2NoZWR1bGUoe3RpbWU6aSx0eXBlOiJkZXNwYXduIixhcmc6dC5pZH0pfWRlc3Bhd24ocyl7dGhpcy52b2ljZXM9dGhpcy52b2ljZXMuZmlsdGVyKHQ9PnQuaWQhPT1zKX1zY2hlZHVsZShzKXtpZighdGhpcy5xLmxlbmd0aCl7dGhpcy5xLnB1c2gocyk7cmV0dXJufWxldCB0PTA7Zm9yKDt0PHRoaXMucS5sZW5ndGgmJnRoaXMucVt0XS50aW1lPHMudGltZTspdCsrO3RoaXMucS5zcGxpY2UodCwwLHMpfXVwZGF0ZSgpe2Zvcig7dGhpcy5xLmxlbmd0aD4wJiZ0aGlzLnFbMF0udGltZTw9dGhpcy50Oyl0aGlzW3RoaXMucVswXS50eXBlXSh0aGlzLnFbMF0uYXJnKSx0aGlzLnEuc2hpZnQoKTt0aGlzLm91dFswXT0wLHRoaXMub3V0WzFdPTA7Zm9yKGxldCBpPTA7aTx0aGlzLnZvaWNlcy5sZW5ndGg7aSsrKXRoaXMudm9pY2VzW2ldLnVwZGF0ZSh0aGlzLnQvdGhpcy5zYW1wbGVSYXRlKSx0aGlzLm91dFswXSs9dGhpcy52b2ljZXNbaV0ub3V0WzBdLHRoaXMub3V0WzFdKz10aGlzLnZvaWNlc1tpXS5vdXRbMV0sdGhpcy52b2ljZXNbaV0uZGVsYXkmJih0aGlzLmRlbGF5c2VuZFswXSs9dGhpcy52b2ljZXNbaV0ub3V0WzBdKnRoaXMudm9pY2VzW2ldLmRlbGF5LHRoaXMuZGVsYXlzZW5kWzFdKz10aGlzLnZvaWNlc1tpXS5vdXRbMV0qdGhpcy52b2ljZXNbaV0uZGVsYXksdGhpcy5kZWxheXRpbWU9dGhpcy52b2ljZXNbaV0uZGVsYXl0aW1lLHRoaXMuZGVsYXlzcGVlZD10aGlzLnZvaWNlc1tpXS5kZWxheXNwZWVkLHRoaXMuZGVsYXlmZWVkYmFjaz10aGlzLnZvaWNlc1tpXS5kZWxheWZlZWRiYWNrKTtjb25zdCBzPXRoaXMuX2RlbGF5TC51cGRhdGUodGhpcy5kZWxheXNlbmRbMF0sdGhpcy5kZWxheXRpbWUpLHQ9dGhpcy5fZGVsYXlSLnVwZGF0ZSh0aGlzLmRlbGF5c2VuZFsxXSx0aGlzLmRlbGF5dGltZSk7dGhpcy5kZWxheXNlbmRbMF09cyp0aGlzLmRlbGF5ZmVlZGJhY2ssdGhpcy5kZWxheXNlbmRbMV09dCp0aGlzLmRlbGF5ZmVlZGJhY2ssdGhpcy5vdXRbMF0rPXMsdGhpcy5vdXRbMV0rPXQsdGhpcy50Kyt9fWNvbnN0IGV0PShoLHMsdCk9Pk1hdGgubWluKE1hdGgubWF4KGgscyksdCk7Y2xhc3MgaXQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuZG91Z2g9bmV3IHN0KHNhbXBsZVJhdGUsY3VycmVudFRpbWUpLHRoaXMucG9ydC5vbm1lc3NhZ2U9cz0+e3MuZGF0YS5zcGF3bj90aGlzLmRvdWdoLnNjaGVkdWxlU3Bhd24ocy5kYXRhLnNwYXduKTpzLmRhdGEuc2FtcGxlP3RoaXMuZG91Z2gubG9hZFNhbXBsZShzLmRhdGEuc2FtcGxlLHMuZGF0YS5jaGFubmVscyxzLmRhdGEuc2FtcGxlUmF0ZSk6cy5kYXRhLnNhbXBsZXM/cy5kYXRhLnNhbXBsZXMuZm9yRWFjaCgoW3QsaSxuXSk9Pnt0aGlzLmRvdWdoLmxvYWRTYW1wbGUodCxpLG4pfSk6Y29uc29sZS5sb2coInVucmVjb2duaXplZCBldmVudCB0eXBlIixzLmRhdGEpfX1wcm9jZXNzKHMsdCxpKXtpZih0aGlzLmRpc2Nvbm5lY3RlZClyZXR1cm4hMTtjb25zdCBuPXRbMF07Zm9yKGxldCBsPTA7bDxuWzBdLmxlbmd0aDtsKyspe3RoaXMuZG91Z2gudXBkYXRlKCk7Zm9yKGxldCByPTA7cjxuLmxlbmd0aDtyKyspbltyXVtsXT1ldCh0aGlzLmRvdWdoLm91dFtyXSwtMSwxKX1yZXR1cm4hMH19cmVnaXN0ZXJQcm9jZXNzb3IoImRvdWdoLXByb2Nlc3NvciIsaXQpfSkoKTsK",APe=MPe;uW(APe);const{Pattern:EPe,logger:DPe,repl:TPe}=NG;FX(DPe);const FPe=n=>(n.ensureObjectValue(),n.value),m3=(n,e,t,s,a)=>{var r;return h3(FPe(n),a,t,s,(r=n.whole)==null?void 0:r.begin.valueOf())};function NPe(n={}){return n={getTime:()=>Xn().currentTime,defaultOutput:m3,...n},TPe(n)}EPe.prototype.dough=function(){return this.onTrigger(xW,1)};function CW(n,{align:e=!0,color:t="white",thickness:s=3,scale:a=.25,pos:r=.75,trigger:o=0,ctx:i=jc(),id:l=1}={}){i.lineWidth=s,i.strokeStyle=t;let c=i.canvas;if(!n){i.beginPath();let O=r*c.height;i.moveTo(0,O),i.lineTo(c.width,O),i.stroke();return}const u=Aw("time",l);i.beginPath();const h=n.frequencyBinCount;let m=e?Array.from(u).findIndex((O,k,M)=>k&&M[k-1]>-o&&O<=-o):0;m=Math.max(m,0);const f=c.width*1/h;let v=0;for(let O=m;O<h;O++){const k=u[O]+1,M=(r-a*(k-1))*c.height;O===0?i.moveTo(v,M):i.lineTo(v,M),v+=f}i.stroke()}function MW(n,{color:e="white",scale:t=.25,pos:s=.75,lean:a=.5,min:r=-150,max:o=0,ctx:i=jc(),id:l=1}={}){if(!n){i.beginPath();let v=s*u.height;i.moveTo(0,v),i.lineTo(u.width,v),i.stroke();return}const c=Aw("frequency",l),u=i.canvas;i.fillStyle=e;const h=n.frequencyBinCount,m=u.width*1/h;let f=0;for(let v=0;v<h;v++){const O=fw((c[v]-r)/(o-r),0,1)*t,k=O*u.height,M=(s-O*a)*u.height;i.fillRect(f,M,Math.max(m,1),k),f+=m}}function AW(n=0,e="0,0,0",t=jc()){n?(t.fillStyle=`rgba(${e},${1-n})`,t.fillRect(0,0,t.canvas.width,t.canvas.height)):t.clearRect(0,0,t.canvas.width,t.canvas.height)}dt.prototype.fscope=function(n={}){let e=n.id??1;return this.analyze(e).draw(()=>{AW(n.smear,"0,0,0",n.ctx),Pr[e]&&MW(Pr[e],n)},{id:e})};dt.prototype.tscope=function(n={}){let e=n.id??1;return this.analyze(e).draw(t=>{var s,a;n.color=((a=(s=t[0])==null?void 0:s.value)==null?void 0:a.color)||Ac().foreground,n.color,AW(n.smear,"0,0,0",n.ctx),CW(Pr[e],n)},{id:e})};dt.prototype.scope=dt.prototype.tscope;let P4={};dt.prototype.spectrum=function(n={}){let e=n.id??1;return this.analyze(e).draw(t=>{var s,a;n.color=((a=(s=t[0])==null?void 0:s.value)==null?void 0:a.color)||P4[e]||Ac().foreground,P4[e]=n.color,BPe(Pr[e],n)},{id:e})};dt.prototype.scope=dt.prototype.tscope;const Jx=new Map;function BPe(n,{thickness:e=3,speed:t=1,min:s=-80,max:a=0,ctx:r=jc(),id:o=1,color:i}={}){if(r.lineWidth=e,r.strokeStyle=i,!n)return;const l=t,c=Aw("frequency",o),u=r.canvas;r.fillStyle=i;const h=n.frequencyBinCount;let m=Jx.get(o)||r.getImageData(0,0,u.width,u.height);Jx.set(o,m),r.clearRect(0,0,r.canvas.width,r.canvas.height),r.putImageData(m,-l,0);let f=u.width-t;for(let v=0;v<h;v++){const O=fw((c[v]-s)/(a-s),0,1);r.globalAlpha=O;const k=Math.log(v+1)/Math.log(h)*u.height;r.fillRect(f,u.height-k,l,2)}Jx.set(o,r.getImageData(0,0,u.width,u.height))}const $Pe=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_MAX_POLYPHONY:l3,Warpmode:lS,aliasBank:oW,get analysers(){return Pr},get analysersData(){return Ah},applyFM:cg,applyGainCurve:yc,applyParameterModulators:rS,connectToDestination:mW,createFilter:e1,destroyAudioWorkletNode:xd,distortionAlgorithms:r3,dough:gPe,doughTrigger:xW,doughsamples:SW,drawFrequencyScope:MW,drawTimeScope:CW,drywet:IX,dspWorklet:wW,effectSend:Ny,errorLogger:TX,gainNode:Gr,getADSRValues:ii,getAnalyserById:pW,getAnalyzerData:Aw,getAudioContext:Xn,getAudioContextCurrentTime:xke,getAudioDevices:iW,getCachedBuffer:Vke,getCompressor:LX,getDefaultValue:ca,getDistortion:ZX,getDistortionAlgorithm:$ke,getFrequencyFromValue:bh,getLfo:e0,getLoadedBuffer:Zke,getOscillator:bW,getParamADSR:oi,getPitchEnvelope:gm,getSampleBuffer:XX,getSampleBufferSource:WX,getSampleInfo:GX,getSound:jd,getVibratoOscillator:bm,getWorklet:lo,getZZFX:yW,initAudio:hW,initAudioOnFirstClick:iPe,loadBuffer:i3,logger:Ma,noises:a3,onTriggerSample:JX,onTriggerSynth:PW,processSampleMap:YX,registerSampleSource:eW,registerSamplesPrefix:zke,registerSound:Ol,registerSynthSounds:fW,registerWaveTable:d3,registerWorklet:uW,registerZZFXSounds:vW,resetDefaultValues:lW,resetDefaults:nPe,resetGlobalEffects:uPe,resetLoadedSounds:rPe,reverseBuffer:qX,samples:Kc,setDefault:tPe,setDefaultAudioContext:RX,setDefaultValue:u3,setDefaultValues:sPe,setGainCurve:Yke,setLogger:FX,setMaxPolyphony:nW,setMultiChannelOrbits:aW,setVersionDefaults:aPe,soundAlias:Jke,soundMap:Io,superdough:h3,superdoughTrigger:hPe,tables:xPe,waveformN:gW,webAudioTimeout:Qd,webaudioOutput:m3,webaudioRepl:NPe},Symbol.toStringTag,{value:"Module"}));let cS=[],EW=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?EW:cS).push(t=t+n[e])})();function RPe(n){if(n<768)return!1;for(let e=0,t=cS.length;;){let s=e+t>>1;if(n<cS[s])t=s;else if(n>=EW[s])e=s+1;else return!0;if(e==t)return!1}}function S4(n){return n>=127462&&n<=127487}const C4=8205;function _Pe(n,e,t=!0,s=!0){return(t?DW:LPe)(n,e,s)}function DW(n,e,t){if(e==n.length)return e;e&&TW(n.charCodeAt(e))&&FW(n.charCodeAt(e-1))&&e--;let s=ek(n,e);for(e+=M4(s);e<n.length;){let a=ek(n,e);if(s==C4||a==C4||t&&RPe(a))e+=M4(a),s=a;else if(S4(a)){let r=0,o=e-2;for(;o>=0&&S4(ek(n,o));)r++,o-=2;if(r%2==0)break;e+=2}else break}return e}function LPe(n,e,t){for(;e>0;){let s=DW(n,e-2,t);if(s<e)return s;e--}return 0}function ek(n,e){let t=n.charCodeAt(e);if(!FW(t)||e+1==n.length)return t;let s=n.charCodeAt(e+1);return TW(s)?(t-55296<<10)+(s-56320)+65536:t}function TW(n){return n>=56320&&n<57344}function FW(n){return n>=55296&&n<56320}function M4(n){return n<65536?1:2}let os=class NW{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,s){[e,t]=ym(this,e,t);let a=[];return this.decompose(0,e,a,2),s.length&&s.decompose(0,s.length,a,3),this.decompose(t,this.length,a,1),Ml.from(a,this.length-(t-e)+s.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=ym(this,e,t);let s=[];return this.decompose(e,t,s,0),Ml.from(s,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),s=this.length-this.scanIdentical(e,-1),a=new Cf(this),r=new Cf(e);for(let o=t,i=t;;){if(a.next(o),r.next(o),o=0,a.lineBreak!=r.lineBreak||a.done!=r.done||a.value!=r.value)return!1;if(i+=a.value.length,a.done||i>=s)return!0}}iter(e=1){return new Cf(this,e)}iterRange(e,t=this.length){return new BW(this,e,t)}iterLines(e,t){let s;if(e==null)s=this.iter();else{t==null&&(t=this.lines+1);let a=this.line(e).from;s=this.iterRange(a,Math.max(a,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new $W(s)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?NW.empty:e.length<=32?new ha(e):Ml.from(ha.split(e,[]))}};class ha extends os{constructor(e,t=IPe(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,s,a){for(let r=0;;r++){let o=this.text[r],i=a+o.length;if((t?s:i)>=e)return new QPe(a,i,s,o);a=i+1,s++}}decompose(e,t,s,a){let r=e<=0&&t>=this.length?this:new ha(A4(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(a&1){let o=s.pop(),i=n1(r.text,o.text.slice(),0,r.length);if(i.length<=32)s.push(new ha(i,o.length+r.length));else{let l=i.length>>1;s.push(new ha(i.slice(0,l)),new ha(i.slice(l)))}}else s.push(r)}replace(e,t,s){if(!(s instanceof ha))return super.replace(e,t,s);[e,t]=ym(this,e,t);let a=n1(this.text,n1(s.text,A4(this.text,0,e)),t),r=this.length+s.length-(t-e);return a.length<=32?new ha(a,r):Ml.from(ha.split(a,[]),r)}sliceString(e,t=this.length,s=`
`){[e,t]=ym(this,e,t);let a="";for(let r=0,o=0;r<=t&&o<this.text.length;o++){let i=this.text[o],l=r+i.length;r>e&&o&&(a+=s),e<l&&t>r&&(a+=i.slice(Math.max(0,e-r),t-r)),r=l+1}return a}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let s=[],a=-1;for(let r of e)s.push(r),a+=r.length+1,s.length==32&&(t.push(new ha(s,a)),s=[],a=-1);return a>-1&&t.push(new ha(s,a)),t}}class Ml extends os{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let s of e)this.lines+=s.lines}lineInner(e,t,s,a){for(let r=0;;r++){let o=this.children[r],i=a+o.length,l=s+o.lines-1;if((t?l:i)>=e)return o.lineInner(e,t,s,a);a=i+1,s=l+1}}decompose(e,t,s,a){for(let r=0,o=0;o<=t&&r<this.children.length;r++){let i=this.children[r],l=o+i.length;if(e<=l&&t>=o){let c=a&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!c?s.push(i):i.decompose(e-o,t-o,s,c)}o=l+1}}replace(e,t,s){if([e,t]=ym(this,e,t),s.lines<this.lines)for(let a=0,r=0;a<this.children.length;a++){let o=this.children[a],i=r+o.length;if(e>=r&&t<=i){let l=o.replace(e-r,t-r,s),c=this.lines-o.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[a]=l,new Ml(u,this.length-(t-e)+s.length)}return super.replace(r,i,l)}r=i+1}return super.replace(e,t,s)}sliceString(e,t=this.length,s=`
`){[e,t]=ym(this,e,t);let a="";for(let r=0,o=0;r<this.children.length&&o<=t;r++){let i=this.children[r],l=o+i.length;o>e&&r&&(a+=s),e<l&&t>o&&(a+=i.sliceString(e-o,t-o,s)),o=l+1}return a}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Ml))return 0;let s=0,[a,r,o,i]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;a+=t,r+=t){if(a==o||r==i)return s;let l=this.children[a],c=e.children[r];if(l!=c)return s+l.scanIdentical(c,t);s+=l.length+1}}static from(e,t=e.reduce((s,a)=>s+a.length+1,-1)){let s=0;for(let f of e)s+=f.lines;if(s<32){let f=[];for(let v of e)v.flatten(f);return new ha(f,t)}let a=Math.max(32,s>>5),r=a<<1,o=a>>1,i=[],l=0,c=-1,u=[];function h(f){let v;if(f.lines>r&&f instanceof Ml)for(let O of f.children)h(O);else f.lines>o&&(l>o||!l)?(m(),i.push(f)):f instanceof ha&&l&&(v=u[u.length-1])instanceof ha&&f.lines+v.lines<=32?(l+=f.lines,c+=f.length+1,u[u.length-1]=new ha(v.text.concat(f.text),v.length+1+f.length)):(l+f.lines>a&&m(),l+=f.lines,c+=f.length+1,u.push(f))}function m(){l!=0&&(i.push(u.length==1?u[0]:Ml.from(u,c)),c=-1,l=u.length=0)}for(let f of e)h(f);return m(),i.length==1?i[0]:new Ml(i,t)}}os.empty=new ha([""],0);function IPe(n){let e=-1;for(let t of n)e+=t.length+1;return e}function n1(n,e,t=0,s=1e9){for(let a=0,r=0,o=!0;r<n.length&&a<=s;r++){let i=n[r],l=a+i.length;l>=t&&(l>s&&(i=i.slice(0,s-a)),a<t&&(i=i.slice(t-a)),o?(e[e.length-1]+=i,o=!1):e.push(i)),a=l+1}return e}function A4(n,e,t){return n1(n,[""],e,t)}class Cf{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof ha?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let s=this.nodes.length-1,a=this.nodes[s],r=this.offsets[s],o=r>>1,i=a instanceof ha?a.text.length:a.children.length;if(o==(t>0?i:0)){if(s==0)return this.done=!0,this.value="",this;t>0&&this.offsets[s-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(t>0?0:1)){if(this.offsets[s]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(a instanceof ha){let l=a.text[o+(t<0?-1:0)];if(this.offsets[s]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=a.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[s]+=t):(t<0&&this.offsets[s]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof ha?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class BW{constructor(e,t,s){this.value="",this.done=!1,this.cursor=new Cf(e,t>s?-1:1),this.pos=t>s?e.length:0,this.from=Math.min(t,s),this.to=Math.max(t,s)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let s=t<0?this.pos-this.from:this.to-this.pos;e>s&&(e=s),s-=e;let{value:a}=this.cursor.next(e);return this.pos+=(a.length+e)*t,this.value=a.length<=s?a:t<0?a.slice(a.length-s):a.slice(0,s),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class $W{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:s,value:a}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):s?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=a,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(os.prototype[Symbol.iterator]=function(){return this.iter()},Cf.prototype[Symbol.iterator]=BW.prototype[Symbol.iterator]=$W.prototype[Symbol.iterator]=function(){return this});class QPe{constructor(e,t,s,a){this.from=e,this.to=t,this.number=s,this.text=a}get length(){return this.to-this.from}}function ym(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Ya(n,e,t=!0,s=!0){return _Pe(n,e,t,s)}function VPe(n){return n>=56320&&n<57344}function jPe(n){return n>=55296&&n<56320}function ao(n,e){let t=n.charCodeAt(e);if(!jPe(t)||e+1==n.length)return t;let s=n.charCodeAt(e+1);return VPe(s)?(t-55296<<10)+(s-56320)+65536:t}function p3(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Al(n){return n<65536?1:2}const uS=/\r\n?|\n/;var ga=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(ga||(ga={}));class _l{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let s=this.sections[t+1];e+=s<0?this.sections[t]:s}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,s=0,a=0;t<this.sections.length;){let r=this.sections[t++],o=this.sections[t++];o<0?(e(s,a,r),a+=r):a+=o,s+=r}}iterChangedRanges(e,t=!1){hS(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let s=this.sections[t++],a=this.sections[t++];a<0?e.push(s,a):e.push(a,s)}return new _l(e)}composeDesc(e){return this.empty?e:e.empty?this:RW(this,e)}mapDesc(e,t=!1){return e.empty?this:dS(this,e,t)}mapPos(e,t=-1,s=ga.Simple){let a=0,r=0;for(let o=0;o<this.sections.length;){let i=this.sections[o++],l=this.sections[o++],c=a+i;if(l<0){if(c>e)return r+(e-a);r+=i}else{if(s!=ga.Simple&&c>=e&&(s==ga.TrackDel&&a<e&&c>e||s==ga.TrackBefore&&a<e||s==ga.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!i)return e==a||t<0?r:r+l;r+=l}a=c}if(e>a)throw new RangeError(`Position ${e} is out of range for changeset of length ${a}`);return r}touchesRange(e,t=e){for(let s=0,a=0;s<this.sections.length&&a<=t;){let r=this.sections[s++],o=this.sections[s++],i=a+r;if(o>=0&&a<=t&&i>=e)return a<e&&i>t?"cover":!0;a=i}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let s=this.sections[t++],a=this.sections[t++];e+=(e?" ":"")+s+(a>=0?":"+a:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new _l(e)}static create(e){return new _l(e)}}class Pa extends _l{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return hS(this,(t,s,a,r,o)=>e=e.replace(a,a+(s-t),o),!1),e}mapDesc(e,t=!1){return dS(this,e,t,!0)}invert(e){let t=this.sections.slice(),s=[];for(let a=0,r=0;a<t.length;a+=2){let o=t[a],i=t[a+1];if(i>=0){t[a]=i,t[a+1]=o;let l=a>>1;for(;s.length<l;)s.push(os.empty);s.push(o?e.slice(r,r+o):os.empty)}r+=o}return new Pa(t,s)}compose(e){return this.empty?e:e.empty?this:RW(this,e,!0)}map(e,t=!1){return e.empty?this:dS(this,e,t,!0)}iterChanges(e,t=!1){hS(this,e,t)}get desc(){return _l.create(this.sections)}filter(e){let t=[],s=[],a=[],r=new ug(this);e:for(let o=0,i=0;;){let l=o==e.length?1e9:e[o++];for(;i<l||i==l&&r.len==0;){if(r.done)break e;let u=Math.min(r.len,l-i);ir(a,u,-1);let h=r.ins==-1?-1:r.off==0?r.ins:0;ir(t,u,h),h>0&&uu(s,t,r.text),r.forward(u),i+=u}let c=e[o++];for(;i<c;){if(r.done)break e;let u=Math.min(r.len,c-i);ir(t,u,-1),ir(a,u,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(u),i+=u}}return{changes:new Pa(t,s),filtered:_l.create(a)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let s=this.sections[t],a=this.sections[t+1];a<0?e.push(s):a==0?e.push([s]):e.push([s].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,s){let a=[],r=[],o=0,i=null;function l(u=!1){if(!u&&!a.length)return;o<t&&ir(a,t-o,-1);let h=new Pa(a,r);i=i?i.compose(h.map(i)):h,a=[],r=[],o=0}function c(u){if(Array.isArray(u))for(let h of u)c(h);else if(u instanceof Pa){if(u.length!=t)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${t})`);l(),i=i?i.compose(u.map(i)):u}else{let{from:h,to:m=h,insert:f}=u;if(h>m||h<0||m>t)throw new RangeError(`Invalid change range ${h} to ${m} (in doc of length ${t})`);let v=f?typeof f=="string"?os.of(f.split(s||uS)):f:os.empty,O=v.length;if(h==m&&O==0)return;h<o&&l(),h>o&&ir(a,h-o,-1),ir(a,m-h,O),uu(r,a,v),o=m}}return c(e),l(!i),i}static empty(e){return new Pa(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],s=[];for(let a=0;a<e.length;a++){let r=e[a];if(typeof r=="number")t.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,i)=>i&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)t.push(r[0],0);else{for(;s.length<a;)s.push(os.empty);s[a]=os.of(r.slice(1)),t.push(r[0],s[a].length)}}}return new Pa(t,s)}static createSet(e,t){return new Pa(e,t)}}function ir(n,e,t,s=!1){if(e==0&&t<=0)return;let a=n.length-2;a>=0&&t<=0&&t==n[a+1]?n[a]+=e:a>=0&&e==0&&n[a]==0?n[a+1]+=t:s?(n[a]+=e,n[a+1]+=t):n.push(e,t)}function uu(n,e,t){if(t.length==0)return;let s=e.length-2>>1;if(s<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<s;)n.push(os.empty);n.push(t)}}function hS(n,e,t){let s=n.inserted;for(let a=0,r=0,o=0;o<n.sections.length;){let i=n.sections[o++],l=n.sections[o++];if(l<0)a+=i,r+=i;else{let c=a,u=r,h=os.empty;for(;c+=i,u+=l,l&&s&&(h=h.append(s[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)i=n.sections[o++],l=n.sections[o++];e(a,c,r,u,h),a=c,r=u}}}function dS(n,e,t,s=!1){let a=[],r=s?[]:null,o=new ug(n),i=new ug(e);for(let l=-1;;){if(o.done&&i.len||i.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&i.ins==-1){let c=Math.min(o.len,i.len);ir(a,c,-1),o.forward(c),i.forward(c)}else if(i.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(i.len<o.len||i.len==o.len&&!t))){let c=i.len;for(ir(a,i.ins,-1);c;){let u=Math.min(o.len,c);o.ins>=0&&l<o.i&&o.len<=u&&(ir(a,0,o.ins),r&&uu(r,a,o.text),l=o.i),o.forward(u),c-=u}i.next()}else if(o.ins>=0){let c=0,u=o.len;for(;u;)if(i.ins==-1){let h=Math.min(u,i.len);c+=h,u-=h,i.forward(h)}else if(i.ins==0&&i.len<u)u-=i.len,i.next();else break;ir(a,c,l<o.i?o.ins:0),r&&l<o.i&&uu(r,a,o.text),l=o.i,o.forward(o.len-u)}else{if(o.done&&i.done)return r?Pa.createSet(a,r):_l.create(a);throw new Error("Mismatched change set lengths")}}}function RW(n,e,t=!1){let s=[],a=t?[]:null,r=new ug(n),o=new ug(e);for(let i=!1;;){if(r.done&&o.done)return a?Pa.createSet(s,a):_l.create(s);if(r.ins==0)ir(s,r.len,0,i),r.next();else if(o.len==0&&!o.done)ir(s,0,o.ins,i),a&&uu(a,s,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(r.len2,o.len),c=s.length;if(r.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;ir(s,l,u,i),a&&u&&uu(a,s,o.text)}else o.ins==-1?(ir(s,r.off?0:r.len,l,i),a&&uu(a,s,r.textBit(l))):(ir(s,r.off?0:r.len,o.off?0:o.ins,i),a&&!o.off&&uu(a,s,o.text));i=(r.ins>l||o.ins>=0&&o.len>l)&&(i||s.length>c),r.forward2(l),o.forward(l)}}}}class ug{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?os.empty:e[t]}textBit(e){let{inserted:t}=this.set,s=this.i-2>>1;return s>=t.length&&!e?os.empty:t[s].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class yh{constructor(e,t,s){this.from=e,this.to=t,this.flags=s}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let s,a;return this.empty?s=a=e.mapPos(this.from,t):(s=e.mapPos(this.from,1),a=e.mapPos(this.to,-1)),s==this.from&&a==this.to?this:new yh(s,a,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return Ze.range(e,t);let s=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Ze.range(this.anchor,s)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Ze.range(e.anchor,e.head)}static create(e,t,s){return new yh(e,t,s)}}class Ze{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:Ze.create(this.ranges.map(s=>s.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let s=0;s<this.ranges.length;s++)if(!this.ranges[s].eq(e.ranges[s],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Ze([this.main],0)}addRange(e,t=!0){return Ze.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let s=this.ranges.slice();return s[t]=e,Ze.create(s,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Ze(e.ranges.map(t=>yh.fromJSON(t)),e.main)}static single(e,t=e){return new Ze([Ze.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let s=0,a=0;a<e.length;a++){let r=e[a];if(r.empty?r.from<=s:r.from<s)return Ze.normalized(e.slice(),t);s=r.to}return new Ze(e,t)}static cursor(e,t=0,s,a){return yh.create(e,e,(t==0?0:t<0?8:16)|(s==null?7:Math.min(6,s))|(a??16777215)<<6)}static range(e,t,s,a){let r=(s??16777215)<<6|(a==null?7:Math.min(6,a));return t<e?yh.create(t,e,48|r):yh.create(e,t,(t>e?8:0)|r)}static normalized(e,t=0){let s=e[t];e.sort((a,r)=>a.from-r.from),t=e.indexOf(s);for(let a=1;a<e.length;a++){let r=e[a],o=e[a-1];if(r.empty?r.from<=o.to:r.from<o.to){let i=o.from,l=Math.max(r.to,o.to);a<=t&&t--,e.splice(--a,2,r.anchor>r.head?Ze.range(l,i):Ze.range(i,l))}}return new Ze(e,t)}}function _W(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let f3=0;class Qt{constructor(e,t,s,a,r){this.combine=e,this.compareInput=t,this.compare=s,this.isStatic=a,this.id=f3++,this.default=e([]),this.extensions=typeof r=="function"?r(this):r}get reader(){return this}static define(e={}){return new Qt(e.combine||(t=>t),e.compareInput||((t,s)=>t===s),e.compare||(e.combine?(t,s)=>t===s:g3),!!e.static,e.enables)}of(e){return new s1([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new s1(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new s1(e,this,2,t)}from(e,t){return t||(t=s=>s),this.compute([e],s=>t(s.field(e)))}}function g3(n,e){return n==e||n.length==e.length&&n.every((t,s)=>t===e[s])}class s1{constructor(e,t,s,a){this.dependencies=e,this.facet=t,this.type=s,this.value=a,this.id=f3++}dynamicSlot(e){var t;let s=this.value,a=this.facet.compareInput,r=this.id,o=e[r]>>1,i=this.type==2,l=!1,c=!1,u=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?c=!0:((t=e[h.id])!==null&&t!==void 0?t:1)&1||u.push(e[h.id]);return{create(h){return h.values[o]=s(h),1},update(h,m){if(l&&m.docChanged||c&&(m.docChanged||m.selection)||mS(h,u)){let f=s(h);if(i?!E4(f,h.values[o],a):!a(f,h.values[o]))return h.values[o]=f,1}return 0},reconfigure:(h,m)=>{let f,v=m.config.address[r];if(v!=null){let O=$y(m,v);if(this.dependencies.every(k=>k instanceof Qt?m.facet(k)===h.facet(k):k instanceof Js?m.field(k,!1)==h.field(k,!1):!0)||(i?E4(f=s(h),O,a):a(f=s(h),O)))return h.values[o]=O,0}else f=s(h);return h.values[o]=f,1}}}}function E4(n,e,t){if(n.length!=e.length)return!1;for(let s=0;s<n.length;s++)if(!t(n[s],e[s]))return!1;return!0}function mS(n,e){let t=!1;for(let s of e)Mf(n,s)&1&&(t=!0);return t}function ZPe(n,e,t){let s=t.map(l=>n[l.id]),a=t.map(l=>l.type),r=s.filter(l=>!(l&1)),o=n[e.id]>>1;function i(l){let c=[];for(let u=0;u<s.length;u++){let h=$y(l,s[u]);if(a[u]==2)for(let m of h)c.push(m);else c.push(h)}return e.combine(c)}return{create(l){for(let c of s)Mf(l,c);return l.values[o]=i(l),1},update(l,c){if(!mS(l,r))return 0;let u=i(l);return e.compare(u,l.values[o])?0:(l.values[o]=u,1)},reconfigure(l,c){let u=mS(l,s),h=c.config.facets[e.id],m=c.facet(e);if(h&&!u&&g3(t,h))return l.values[o]=m,0;let f=i(l);return e.compare(f,m)?(l.values[o]=m,0):(l.values[o]=f,1)}}}const D4=Qt.define({static:!0});class Js{constructor(e,t,s,a,r){this.id=e,this.createF=t,this.updateF=s,this.compareF=a,this.spec=r,this.provides=void 0}static define(e){let t=new Js(f3++,e.create,e.update,e.compare||((s,a)=>s===a),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(D4).find(s=>s.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:s=>(s.values[t]=this.create(s),1),update:(s,a)=>{let r=s.values[t],o=this.updateF(r,a);return this.compareF(r,o)?0:(s.values[t]=o,1)},reconfigure:(s,a)=>a.config.address[this.id]!=null?(s.values[t]=a.field(this),0):(s.values[t]=this.create(s),1)}}init(e){return[this,D4.of({field:this,create:e})]}get extension(){return this}}const uh={lowest:4,low:3,default:2,high:1,highest:0};function Fp(n){return e=>new LW(e,n)}const yo={highest:Fp(uh.highest),high:Fp(uh.high),default:Fp(uh.default),low:Fp(uh.low),lowest:Fp(uh.lowest)};class LW{constructor(e,t){this.inner=e,this.prec=t}}class n0{of(e){return new pS(this,e)}reconfigure(e){return n0.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class pS{constructor(e,t){this.compartment=e,this.inner=t}}class By{constructor(e,t,s,a,r,o){for(this.base=e,this.compartments=t,this.dynamicSlots=s,this.address=a,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<s.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,s){let a=[],r=Object.create(null),o=new Map;for(let m of zPe(e,t,o))m instanceof Js?a.push(m):(r[m.facet.id]||(r[m.facet.id]=[])).push(m);let i=Object.create(null),l=[],c=[];for(let m of a)i[m.id]=c.length<<1,c.push(f=>m.slot(f));let u=s==null?void 0:s.config.facets;for(let m in r){let f=r[m],v=f[0].facet,O=u&&u[m]||[];if(f.every(k=>k.type==0))if(i[v.id]=l.length<<1|1,g3(O,f))l.push(s.facet(v));else{let k=v.combine(f.map(M=>M.value));l.push(s&&v.compare(k,s.facet(v))?s.facet(v):k)}else{for(let k of f)k.type==0?(i[k.id]=l.length<<1|1,l.push(k.value)):(i[k.id]=c.length<<1,c.push(M=>k.dynamicSlot(M)));i[v.id]=c.length<<1,c.push(k=>ZPe(k,v,f))}}let h=c.map(m=>m(i));return new By(e,o,h,i,l,r)}}function zPe(n,e,t){let s=[[],[],[],[],[]],a=new Map;function r(o,i){let l=a.get(o);if(l!=null){if(l<=i)return;let c=s[l].indexOf(o);c>-1&&s[l].splice(c,1),o instanceof pS&&t.delete(o.compartment)}if(a.set(o,i),Array.isArray(o))for(let c of o)r(c,i);else if(o instanceof pS){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;t.set(o.compartment,c),r(c,i)}else if(o instanceof LW)r(o.inner,o.prec);else if(o instanceof Js)s[i].push(o),o.provides&&r(o.provides,i);else if(o instanceof s1)s[i].push(o),o.facet.extensions&&r(o.facet.extensions,uh.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(c,i)}}return r(n,uh.default),s.reduce((o,i)=>o.concat(i))}function Mf(n,e){if(e&1)return 2;let t=e>>1,s=n.status[t];if(s==4)throw new Error("Cyclic dependency between fields and/or facets");if(s&2)return s;n.status[t]=4;let a=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|a}function $y(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const IW=Qt.define(),fS=Qt.define({combine:n=>n.some(e=>e),static:!0}),QW=Qt.define({combine:n=>n.length?n[0]:void 0,static:!0}),VW=Qt.define(),jW=Qt.define(),ZW=Qt.define(),zW=Qt.define({combine:n=>n.length?n[0]:!1});class zc{constructor(e,t){this.type=e,this.value=t}static define(){return new GPe}}class GPe{of(e){return new zc(this,e)}}class XPe{constructor(e){this.map=e}of(e){return new hn(this,e)}}class hn{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new hn(this.type,t)}is(e){return this.type==e}static define(e={}){return new XPe(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let s=[];for(let a of e){let r=a.map(t);r&&s.push(r)}return s}}hn.reconfigure=hn.define();hn.appendConfig=hn.define();class va{constructor(e,t,s,a,r,o){this.startState=e,this.changes=t,this.selection=s,this.effects=a,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,s&&_W(s,t.newLength),r.some(i=>i.type==va.time)||(this.annotations=r.concat(va.time.of(Date.now())))}static create(e,t,s,a,r,o){return new va(e,t,s,a,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(va.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}va.time=zc.define();va.userEvent=zc.define();va.addToHistory=zc.define();va.remote=zc.define();function WPe(n,e){let t=[];for(let s=0,a=0;;){let r,o;if(s<n.length&&(a==e.length||e[a]>=n[s]))r=n[s++],o=n[s++];else if(a<e.length)r=e[a++],o=e[a++];else return t;!t.length||t[t.length-1]<r?t.push(r,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function GW(n,e,t){var s;let a,r,o;return t?(a=e.changes,r=Pa.empty(e.changes.length),o=n.changes.compose(e.changes)):(a=e.changes.map(n.changes),r=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(a)),{changes:o,selection:e.selection?e.selection.map(r):(s=n.selection)===null||s===void 0?void 0:s.map(a),effects:hn.mapEffects(n.effects,a).concat(hn.mapEffects(e.effects,r)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function gS(n,e,t){let s=e.selection,a=zd(e.annotations);return e.userEvent&&(a=a.concat(va.userEvent.of(e.userEvent))),{changes:e.changes instanceof Pa?e.changes:Pa.of(e.changes||[],t,n.facet(QW)),selection:s&&(s instanceof Ze?s:Ze.single(s.anchor,s.head)),effects:zd(e.effects),annotations:a,scrollIntoView:!!e.scrollIntoView}}function XW(n,e,t){let s=gS(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let r=1;r<e.length;r++){e[r].filter===!1&&(t=!1);let o=!!e[r].sequential;s=GW(s,gS(n,e[r],o?s.changes.newLength:n.doc.length),o)}let a=va.create(n,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return UPe(t?qPe(a):a)}function qPe(n){let e=n.startState,t=!0;for(let a of e.facet(VW)){let r=a(n);if(r===!1){t=!1;break}Array.isArray(r)&&(t=t===!0?r:WPe(t,r))}if(t!==!0){let a,r;if(t===!1)r=n.changes.invertedDesc,a=Pa.empty(e.doc.length);else{let o=n.changes.filter(t);a=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}n=va.create(e,a,n.selection&&n.selection.map(r),hn.mapEffects(n.effects,r),n.annotations,n.scrollIntoView)}let s=e.facet(jW);for(let a=s.length-1;a>=0;a--){let r=s[a](n);r instanceof va?n=r:Array.isArray(r)&&r.length==1&&r[0]instanceof va?n=r[0]:n=XW(e,zd(r),!1)}return n}function UPe(n){let e=n.startState,t=e.facet(ZW),s=n;for(let a=t.length-1;a>=0;a--){let r=t[a](n);r&&Object.keys(r).length&&(s=GW(s,gS(e,r,n.changes.newLength),!0))}return s==n?n:va.create(e,n.changes,n.selection,s.effects,s.annotations,s.scrollIntoView)}const HPe=[];function zd(n){return n==null?HPe:Array.isArray(n)?n:[n]}var wa=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(wa||(wa={}));const YPe=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let bS;try{bS=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function KPe(n){if(bS)return bS.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||YPe.test(t)))return!0}return!1}function JPe(n){return e=>{if(!/\S/.test(e))return wa.Space;if(KPe(e))return wa.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return wa.Word;return wa.Other}}class as{constructor(e,t,s,a,r,o){this.config=e,this.doc=t,this.selection=s,this.values=a,this.status=e.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let i=0;i<this.config.dynamicSlots.length;i++)Mf(this,i<<1);this.computeSlot=null}field(e,t=!0){let s=this.config.address[e.id];if(s==null){if(t)throw new RangeError("Field is not present in this state");return}return Mf(this,s),$y(this,s)}update(...e){return XW(this,e,!0)}applyTransaction(e){let t=this.config,{base:s,compartments:a}=t;for(let i of e.effects)i.is(n0.reconfigure)?(t&&(a=new Map,t.compartments.forEach((l,c)=>a.set(c,l)),t=null),a.set(i.value.compartment,i.value.extension)):i.is(hn.reconfigure)?(t=null,s=i.value):i.is(hn.appendConfig)&&(t=null,s=zd(s).concat(i.value));let r;t?r=e.startState.values.slice():(t=By.resolve(s,a,this),r=new as(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(i,l)=>l.reconfigure(i,this),null).values);let o=e.startState.facet(fS)?e.newSelection:e.newSelection.asSingle();new as(t,e.newDoc,o,r,(i,l)=>l.update(i,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:Ze.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,s=e(t.ranges[0]),a=this.changes(s.changes),r=[s.range],o=zd(s.effects);for(let i=1;i<t.ranges.length;i++){let l=e(t.ranges[i]),c=this.changes(l.changes),u=c.map(a);for(let m=0;m<i;m++)r[m]=r[m].map(u);let h=a.mapDesc(c,!0);r.push(l.range.map(h)),a=a.compose(u),o=hn.mapEffects(o,u).concat(hn.mapEffects(zd(l.effects),h))}return{changes:a,selection:Ze.create(r,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Pa?e:Pa.of(e,this.doc.length,this.facet(as.lineSeparator))}toText(e){return os.of(e.split(this.facet(as.lineSeparator)||uS))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Mf(this,t),$y(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let s in e){let a=e[s];a instanceof Js&&this.config.address[a.id]!=null&&(t[s]=a.spec.toJSON(this.field(e[s]),this))}return t}static fromJSON(e,t={},s){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let a=[];if(s){for(let r in s)if(Object.prototype.hasOwnProperty.call(e,r)){let o=s[r],i=e[r];a.push(o.init(l=>o.spec.fromJSON(i,l)))}}return as.create({doc:e.doc,selection:Ze.fromJSON(e.selection),extensions:t.extensions?a.concat([t.extensions]):a})}static create(e={}){let t=By.resolve(e.extensions||[],new Map),s=e.doc instanceof os?e.doc:os.of((e.doc||"").split(t.staticFacet(as.lineSeparator)||uS)),a=e.selection?e.selection instanceof Ze?e.selection:Ze.single(e.selection.anchor,e.selection.head):Ze.single(0);return _W(a,s.length),t.staticFacet(fS)||(a=a.asSingle()),new as(t,s,a,t.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(as.tabSize)}get lineBreak(){return this.facet(as.lineSeparator)||`
`}get readOnly(){return this.facet(zW)}phrase(e,...t){for(let s of this.facet(as.phrases))if(Object.prototype.hasOwnProperty.call(s,e)){e=s[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(s,a)=>{if(a=="$")return"$";let r=+(a||1);return!r||r>t.length?s:t[r-1]})),e}languageDataAt(e,t,s=-1){let a=[];for(let r of this.facet(IW))for(let o of r(this,t,s))Object.prototype.hasOwnProperty.call(o,e)&&a.push(o[e]);return a}charCategorizer(e){return JPe(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:s,length:a}=this.doc.lineAt(e),r=this.charCategorizer(e),o=e-s,i=e-s;for(;o>0;){let l=Ya(t,o,!1);if(r(t.slice(l,o))!=wa.Word)break;o=l}for(;i<a;){let l=Ya(t,i);if(r(t.slice(i,l))!=wa.Word)break;i=l}return o==i?null:Ze.range(o+s,i+s)}}as.allowMultipleSelections=fS;as.tabSize=Qt.define({combine:n=>n.length?n[0]:4});as.lineSeparator=QW;as.readOnly=zW;as.phrases=Qt.define({compare(n,e){let t=Object.keys(n),s=Object.keys(e);return t.length==s.length&&t.every(a=>n[a]==e[a])}});as.languageData=IW;as.changeFilter=VW;as.transactionFilter=jW;as.transactionExtender=ZW;n0.reconfigure=hn.define();function Gc(n,e,t={}){let s={};for(let a of n)for(let r of Object.keys(a)){let o=a[r],i=s[r];if(i===void 0)s[r]=o;else if(!(i===o||o===void 0))if(Object.hasOwnProperty.call(t,r))s[r]=t[r](i,o);else throw new Error("Config merge conflict for field "+r)}for(let a in e)s[a]===void 0&&(s[a]=e[a]);return s}class jh{eq(e){return this==e}range(e,t=e){return yS.create(e,t,this)}}jh.prototype.startSide=jh.prototype.endSide=0;jh.prototype.point=!1;jh.prototype.mapMode=ga.TrackDel;let yS=class WW{constructor(e,t,s){this.from=e,this.to=t,this.value=s}static create(e,t,s){return new WW(e,t,s)}};function vS(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class b3{constructor(e,t,s,a){this.from=e,this.to=t,this.value=s,this.maxPoint=a}get length(){return this.to[this.to.length-1]}findIndex(e,t,s,a=0){let r=s?this.to:this.from;for(let o=a,i=r.length;;){if(o==i)return o;let l=o+i>>1,c=r[l]-e||(s?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return c>=0?o:i;c>=0?i=l:o=l+1}}between(e,t,s,a){for(let r=this.findIndex(t,-1e9,!0),o=this.findIndex(s,1e9,!1,r);r<o;r++)if(a(this.from[r]+e,this.to[r]+e,this.value[r])===!1)return!1}map(e,t){let s=[],a=[],r=[],o=-1,i=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+e,h=this.to[l]+e,m,f;if(u==h){let v=t.mapPos(u,c.startSide,c.mapMode);if(v==null||(m=f=v,c.startSide!=c.endSide&&(f=t.mapPos(u,c.endSide),f<m)))continue}else if(m=t.mapPos(u,c.startSide),f=t.mapPos(h,c.endSide),m>f||m==f&&c.startSide>0&&c.endSide<=0)continue;(f-m||c.endSide-c.startSide)<0||(o<0&&(o=m),c.point&&(i=Math.max(i,f-m)),s.push(c),a.push(m-o),r.push(f-o))}return{mapped:s.length?new b3(a,r,s,i):null,pos:o}}}class hs{constructor(e,t,s,a){this.chunkPos=e,this.chunk=t,this.nextLayer=s,this.maxPoint=a}static create(e,t,s,a){return new hs(e,t,s,a)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:s=!1,filterFrom:a=0,filterTo:r=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(s&&(t=t.slice().sort(vS)),this.isEmpty)return t.length?hs.of(t):this;let i=new qW(this,null,-1).goto(0),l=0,c=[],u=new Gl;for(;i.value||l<t.length;)if(l<t.length&&(i.from-t[l].from||i.startSide-t[l].value.startSide)>=0){let h=t[l++];u.addInner(h.from,h.to,h.value)||c.push(h)}else i.rangeIndex==1&&i.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(i.chunkIndex)<t[l].from)&&(!o||a>this.chunkEnd(i.chunkIndex)||r<this.chunkPos[i.chunkIndex])&&u.addChunk(this.chunkPos[i.chunkIndex],this.chunk[i.chunkIndex])?i.nextChunk():((!o||a>i.to||r<i.from||o(i.from,i.to,i.value))&&(u.addInner(i.from,i.to,i.value)||c.push(yS.create(i.from,i.to,i.value))),i.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?hs.empty:this.nextLayer.update({add:c,filter:o,filterFrom:a,filterTo:r}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],s=[],a=-1;for(let o=0;o<this.chunk.length;o++){let i=this.chunkPos[o],l=this.chunk[o],c=e.touchesRange(i,i+l.length);if(c===!1)a=Math.max(a,l.maxPoint),t.push(l),s.push(e.mapPos(i));else if(c===!0){let{mapped:u,pos:h}=l.map(i,e);u&&(a=Math.max(a,u.maxPoint),t.push(u),s.push(h))}}let r=this.nextLayer.map(e);return t.length==0?r:new hs(s,t,r||hs.empty,a)}between(e,t,s){if(!this.isEmpty){for(let a=0;a<this.chunk.length;a++){let r=this.chunkPos[a],o=this.chunk[a];if(t>=r&&e<=r+o.length&&o.between(r,e-r,t-r,s)===!1)return}this.nextLayer.between(e,t,s)}}iter(e=0){return hg.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return hg.from(e).goto(t)}static compare(e,t,s,a,r=-1){let o=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=r),i=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=r),l=T4(o,i,s),c=new Np(o,l,r),u=new Np(i,l,r);s.iterGaps((h,m,f)=>F4(c,h,u,m,f,a)),s.empty&&s.length==0&&F4(c,0,u,0,0,a)}static eq(e,t,s=0,a){a==null&&(a=999999999);let r=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0),o=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let i=T4(r,o),l=new Np(r,i,0).goto(s),c=new Np(o,i,0).goto(s);for(;;){if(l.to!=c.to||!wS(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>a)return!0;l.next(),c.next()}}static spans(e,t,s,a,r=-1){let o=new Np(e,null,r).goto(t),i=t,l=o.openStart;for(;;){let c=Math.min(o.to,s);if(o.point){let u=o.activeForPoint(o.to),h=o.pointFrom<t?u.length+1:o.point.startSide<0?u.length:Math.min(u.length,l);a.point(i,c,o.point,u,h,o.pointRank),l=Math.min(o.openEnd(c),u.length)}else c>i&&(a.span(i,c,o.active,l),l=o.openEnd(c));if(o.to>s)return l+(o.point&&o.to>s?1:0);i=o.to,o.next()}}static of(e,t=!1){let s=new Gl;for(let a of e instanceof yS?[e]:t?e2e(e):e)s.add(a.from,a.to,a.value);return s.finish()}static join(e){if(!e.length)return hs.empty;let t=e[e.length-1];for(let s=e.length-2;s>=0;s--)for(let a=e[s];a!=hs.empty;a=a.nextLayer)t=new hs(a.chunkPos,a.chunk,t,Math.max(a.maxPoint,t.maxPoint));return t}}hs.empty=new hs([],[],null,-1);function e2e(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let s=n[t];if(vS(e,s)>0)return n.slice().sort(vS);e=s}return n}hs.empty.nextLayer=hs.empty;class Gl{finishChunk(e){this.chunks.push(new b3(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,s){this.addInner(e,t,s)||(this.nextLayer||(this.nextLayer=new Gl)).add(e,t,s)}addInner(e,t,s){let a=e-this.lastTo||s.startSide-this.last.endSide;if(a<=0&&(e-this.lastFrom||s.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return a<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=s,this.lastFrom=e,this.lastTo=t,this.value.push(s),s.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let s=t.value.length-1;return this.last=t.value[s],this.lastFrom=t.from[s]+e,this.lastTo=t.to[s]+e,!0}finish(){return this.finishInner(hs.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=hs.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function T4(n,e,t){let s=new Map;for(let r of n)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&s.set(r.chunk[o],r.chunkPos[o]);let a=new Set;for(let r of e)for(let o=0;o<r.chunk.length;o++){let i=s.get(r.chunk[o]);i!=null&&(t?t.mapPos(i):i)==r.chunkPos[o]&&!(t!=null&&t.touchesRange(i,i+r.chunk[o].length))&&a.add(r.chunk[o])}return a}class qW{constructor(e,t,s,a=0){this.layer=e,this.skip=t,this.minPoint=s,this.rank=a}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,s){for(;this.chunkIndex<this.layer.chunk.length;){let a=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(a)||this.layer.chunkEnd(this.chunkIndex)<e||a.maxPoint<this.minPoint))break;this.chunkIndex++,s=!1}if(this.chunkIndex<this.layer.chunk.length){let a=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!s||this.rangeIndex<a)&&this.setRangeIndex(a)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],s=e+t.from[this.rangeIndex];if(this.from=s,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class hg{constructor(e){this.heap=e}static from(e,t=null,s=-1){let a=[];for(let r=0;r<e.length;r++)for(let o=e[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=s&&a.push(new qW(o,t,s,r));return a.length==1?a[0]:new hg(a)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let s of this.heap)s.goto(e,t);for(let s=this.heap.length>>1;s>=0;s--)tk(this.heap,s);return this.next(),this}forward(e,t){for(let s of this.heap)s.forward(e,t);for(let s=this.heap.length>>1;s>=0;s--)tk(this.heap,s);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),tk(this.heap,0)}}}function tk(n,e){for(let t=n[e];;){let s=(e<<1)+1;if(s>=n.length)break;let a=n[s];if(s+1<n.length&&a.compare(n[s+1])>=0&&(a=n[s+1],s++),t.compare(a)<0)break;n[s]=t,n[e]=a,e=s}}class Np{constructor(e,t,s){this.minPoint=s,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=hg.from(e,t,s)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Y0(this.active,e),Y0(this.activeTo,e),Y0(this.activeRank,e),this.minActive=N4(this.active,this.activeTo)}addActive(e){let t=0,{value:s,to:a,rank:r}=this.cursor;for(;t<this.activeRank.length&&(r-this.activeRank[t]||a-this.activeTo[t])>0;)t++;K0(this.active,t,s),K0(this.activeTo,t,a),K0(this.activeRank,t,r),e&&K0(e,t,this.cursor.from),this.minActive=N4(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let s=this.openStart<0?[]:null;for(;;){let a=this.minActive;if(a>-1&&(this.activeTo[a]-this.cursor.from||this.active[a].endSide-this.cursor.startSide)<0){if(this.activeTo[a]>e){this.to=this.activeTo[a],this.endSide=this.active[a].endSide;break}this.removeActive(a),s&&Y0(s,a)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(s),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(s){this.openStart=0;for(let a=s.length-1;a>=0&&s[a]<e;a--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let s=this.active.length-1;s>=0&&!(this.activeRank[s]<this.pointRank);s--)(this.activeTo[s]>e||this.activeTo[s]==e&&this.active[s].endSide>=this.point.endSide)&&t.push(this.active[s]);return t.reverse()}openEnd(e){let t=0;for(let s=this.activeTo.length-1;s>=0&&this.activeTo[s]>e;s--)t++;return t}}function F4(n,e,t,s,a,r){n.goto(e),t.goto(s);let o=s+a,i=s,l=s-e;for(;;){let c=n.to+l-t.to,u=c||n.endSide-t.endSide,h=u<0?n.to+l:t.to,m=Math.min(h,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&wS(n.activeForPoint(n.to),t.activeForPoint(t.to))||r.comparePoint(i,m,n.point,t.point):m>i&&!wS(n.active,t.active)&&r.compareRange(i,m,n.active,t.active),h>o)break;(c||n.openEnd!=t.openEnd)&&r.boundChange&&r.boundChange(h),i=h,u<=0&&n.next(),u>=0&&t.next()}}function wS(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function Y0(n,e){for(let t=e,s=n.length-1;t<s;t++)n[t]=n[t+1];n.pop()}function K0(n,e,t){for(let s=n.length-1;s>=e;s--)n[s+1]=n[s];n[e]=t}function N4(n,e){let t=-1,s=1e9;for(let a=0;a<e.length;a++)(e[a]-s||n[a].endSide-n[t].endSide)<0&&(t=a,s=e[a]);return t}function ep(n,e,t=n.length){let s=0;for(let a=0;a<t&&a<n.length;)n.charCodeAt(a)==9?(s+=e-s%e,a++):(s++,a=Ya(n,a));return s}function OS(n,e,t,s){for(let a=0,r=0;;){if(r>=e)return a;if(a==n.length)break;r+=n.charCodeAt(a)==9?t-r%t:1,a=Ya(n,a)}return s===!0?-1:n.length}const xS="ͼ",B4=typeof Symbol>"u"?"__"+xS:Symbol.for(xS),kS=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),$4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Fu{constructor(e,t){this.rules=[];let{finish:s}=t||{};function a(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function r(o,i,l,c){let u=[],h=/^@(\w+)\b/.exec(o[0]),m=h&&h[1]=="keyframes";if(h&&i==null)return l.push(o[0]+";");for(let f in i){let v=i[f];if(/&/.test(f))r(f.split(/,\s*/).map(O=>o.map(k=>O.replace(/&/,k))).reduce((O,k)=>O.concat(k)),v,l);else if(v&&typeof v=="object"){if(!h)throw new RangeError("The value of a property ("+f+") should be a primitive value.");r(a(f),v,u,m)}else v!=null&&u.push(f.replace(/_.*/,"").replace(/[A-Z]/g,O=>"-"+O.toLowerCase())+": "+v+";")}(u.length||m)&&l.push((s&&!h&&!c?o.map(s):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)r(a(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=$4[B4]||1;return $4[B4]=e+1,xS+e.toString(36)}static mount(e,t,s){let a=e[kS],r=s&&s.nonce;a?r&&a.setNonce(r):a=new t2e(e,r),a.mount(Array.isArray(t)?t:[t],e)}}let R4=new Map;class t2e{constructor(e,t){let s=e.ownerDocument||e,a=s.defaultView;if(!e.head&&e.adoptedStyleSheets&&a.CSSStyleSheet){let r=R4.get(s);if(r)return e[kS]=r;this.sheet=new a.CSSStyleSheet,R4.set(s,this)}else this.styleTag=s.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[kS]=this}mount(e,t){let s=this.sheet,a=0,r=0;for(let o=0;o<e.length;o++){let i=e[o],l=this.modules.indexOf(i);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,i),s)for(let c=0;c<i.rules.length;c++)s.insertRule(i.rules[c],a++)}else{for(;r<l;)a+=this.modules[r++].rules.length;a+=i.rules.length,r++}}if(s)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let i=t.head||t;this.styleTag.parentNode!=i&&i.insertBefore(this.styleTag,i.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Nu={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},dg={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},n2e=typeof navigator<"u"&&/Mac/.test(navigator.platform),s2e=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Ua=0;Ua<10;Ua++)Nu[48+Ua]=Nu[96+Ua]=String(Ua);for(var Ua=1;Ua<=24;Ua++)Nu[Ua+111]="F"+Ua;for(var Ua=65;Ua<=90;Ua++)Nu[Ua]=String.fromCharCode(Ua+32),dg[Ua]=String.fromCharCode(Ua);for(var nk in Nu)dg.hasOwnProperty(nk)||(dg[nk]=Nu[nk]);function a2e(n){var e=n2e&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||s2e&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?dg:Nu)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function mg(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function PS(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function a1(n,e){if(!e.anchorNode)return!1;try{return PS(n,e.anchorNode)}catch{return!1}}function pg(n){return n.nodeType==3?zh(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function Af(n,e,t,s){return t?_4(n,e,t,s,-1)||_4(n,e,t,s,1):!1}function Zh(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Ry(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function _4(n,e,t,s,a){for(;;){if(n==t&&e==s)return!0;if(e==(a<0?0:Xl(n))){if(n.nodeName=="DIV")return!1;let r=n.parentNode;if(!r||r.nodeType!=1)return!1;e=Zh(n)+(a<0?0:1),n=r}else if(n.nodeType==1){if(n=n.childNodes[e+(a<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=a<0?Xl(n):0}else return!1}}function Xl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Ew(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function r2e(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function UW(n,e){let t=e.width/n.offsetWidth,s=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(s>.995&&s<1.005||!isFinite(s)||Math.abs(e.height-n.offsetHeight)<1)&&(s=1),{scaleX:t,scaleY:s}}function o2e(n,e,t,s,a,r,o,i){let l=n.ownerDocument,c=l.defaultView||window;for(let u=n,h=!1;u&&!h;)if(u.nodeType==1){let m,f=u==l.body,v=1,O=1;if(f)m=r2e(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(h=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let E=u.getBoundingClientRect();({scaleX:v,scaleY:O}=UW(u,E)),m={left:E.left,right:E.left+u.clientWidth*v,top:E.top,bottom:E.top+u.clientHeight*O}}let k=0,M=0;if(a=="nearest")e.top<m.top?(M=-(m.top-e.top+o),t>0&&e.bottom>m.bottom+M&&(M=e.bottom-m.bottom+M+o)):e.bottom>m.bottom&&(M=e.bottom-m.bottom+o,t<0&&e.top-M<m.top&&(M=-(m.top+M-e.top+o)));else{let E=e.bottom-e.top,I=m.bottom-m.top;M=(a=="center"&&E<=I?e.top+E/2-I/2:a=="start"||a=="center"&&t<0?e.top-o:e.bottom-I+o)-m.top}if(s=="nearest"?e.left<m.left?(k=-(m.left-e.left+r),t>0&&e.right>m.right+k&&(k=e.right-m.right+k+r)):e.right>m.right&&(k=e.right-m.right+r,t<0&&e.left<m.left+k&&(k=-(m.left+k-e.left+r))):k=(s=="center"?e.left+(e.right-e.left)/2-(m.right-m.left)/2:s=="start"==i?e.left-r:e.right-(m.right-m.left)+r)-m.left,k||M)if(f)c.scrollBy(k,M);else{let E=0,I=0;if(M){let D=u.scrollTop;u.scrollTop+=M/O,I=(u.scrollTop-D)*O}if(k){let D=u.scrollLeft;u.scrollLeft+=k/v,E=(u.scrollLeft-D)*v}e={left:e.left-E,top:e.top-I,right:e.right-E,bottom:e.bottom-I},E&&Math.abs(E-k)<1&&(s="nearest"),I&&Math.abs(I-M)<1&&(a="nearest")}if(f)break;u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function i2e(n){let e=n.ownerDocument,t,s;for(let a=n.parentNode;a&&!(a==e.body||t&&s);)if(a.nodeType==1)!s&&a.scrollHeight>a.clientHeight&&(s=a),!t&&a.scrollWidth>a.clientWidth&&(t=a),a=a.assignedSlot||a.parentNode;else if(a.nodeType==11)a=a.host;else break;return{x:t,y:s}}class l2e{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:s}=e;this.set(t,Math.min(e.anchorOffset,t?Xl(t):0),s,Math.min(e.focusOffset,s?Xl(s):0))}set(e,t,s,a){this.anchorNode=e,this.anchorOffset=t,this.focusNode=s,this.focusOffset=a}}let sd=null;function HW(n){if(n.setActive)return n.setActive();if(sd)return n.focus(sd);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(sd==null?{get preventScroll(){return sd={preventScroll:!0},!0}}:void 0),!sd){sd=!1;for(let t=0;t<e.length;){let s=e[t++],a=e[t++],r=e[t++];s.scrollTop!=a&&(s.scrollTop=a),s.scrollLeft!=r&&(s.scrollLeft=r)}}}let L4;function zh(n,e,t=e){let s=L4||(L4=document.createRange());return s.setEnd(n,t),s.setStart(n,e),s}function Gd(n,e,t,s){let a={key:e,code:e,keyCode:t,which:t,cancelable:!0};s&&({altKey:a.altKey,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,metaKey:a.metaKey}=s);let r=new KeyboardEvent("keydown",a);r.synthetic=!0,n.dispatchEvent(r);let o=new KeyboardEvent("keyup",a);return o.synthetic=!0,n.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function c2e(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function YW(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function u2e(n,e){let t=e.focusNode,s=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=s)return!1;for(s=Math.min(s,Xl(t));;)if(s){if(t.nodeType!=1)return!1;let a=t.childNodes[s-1];a.contentEditable=="false"?s--:(t=a,s=Xl(t))}else{if(t==n)return!0;s=Zh(t),t=t.parentNode}}function KW(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function JW(n,e){for(let t=n,s=e;;){if(t.nodeType==3&&s>0)return{node:t,offset:s};if(t.nodeType==1&&s>0){if(t.contentEditable=="false")return null;t=t.childNodes[s-1],s=Xl(t)}else if(t.parentNode&&!Ry(t))s=Zh(t),t=t.parentNode;else return null}}function eq(n,e){for(let t=n,s=e;;){if(t.nodeType==3&&s<t.nodeValue.length)return{node:t,offset:s};if(t.nodeType==1&&s<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[s],s=0}else if(t.parentNode&&!Ry(t))s=Zh(t)+1,t=t.parentNode;else return null}}class ur{constructor(e,t,s=!0){this.node=e,this.offset=t,this.precise=s}static before(e,t){return new ur(e.parentNode,Zh(e),t)}static after(e,t){return new ur(e.parentNode,Zh(e)+1,t)}}const y3=[];class As{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let s of this.children){if(s==e)return t;t+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let s=this.dom,a=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=a?a.nextSibling:s.firstChild)){let i=As.get(r);(!i||!i.parent&&i.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(e,t),o.flags&=-8}if(r=a?a.nextSibling:s.firstChild,t&&!t.written&&t.node==s&&r!=o.dom&&(t.written=!0),o.dom.parentNode==s)for(;r&&r!=o.dom;)r=I4(r);else s.insertBefore(o.dom,r);a=o.dom}for(r=a?a.nextSibling:s.firstChild,r&&t&&t.node==s&&(t.written=!0);r;)r=I4(r)}else if(this.flags&1)for(let s of this.children)s.flags&7&&(s.sync(e,t),s.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let s;if(e==this.dom)s=this.dom.childNodes[t];else{let a=Xl(e)==0?0:t==0?-1:1;for(;;){let r=e.parentNode;if(r==this.dom)break;a==0&&r.firstChild!=r.lastChild&&(e==r.firstChild?a=-1:a=1),e=r}a<0?s=e:s=e.nextSibling}if(s==this.dom.firstChild)return 0;for(;s&&!As.get(s);)s=s.nextSibling;if(!s)return this.length;for(let a=0,r=0;;a++){let o=this.children[a];if(o.dom==s)return r;r+=o.length+o.breakAfter}}domBoundsAround(e,t,s=0){let a=-1,r=-1,o=-1,i=-1;for(let l=0,c=s,u=s;l<this.children.length;l++){let h=this.children[l],m=c+h.length;if(c<e&&m>t)return h.domBoundsAround(e,t,c);if(m>=e&&a==-1&&(a=l,r=c),c>t&&h.dom.parentNode==this.dom){o=l,i=u;break}u=m,c=m+h.breakAfter}return{from:r,to:i<0?s+this.length:i,startDOM:(a?this.children[a-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,s=y3){this.markDirty();for(let a=e;a<t;a++){let r=this.children[a];r.parent==this&&s.indexOf(r)<0&&r.destroy()}s.length<250?this.children.splice(e,t-e,...s):this.children=[].concat(this.children.slice(0,e),s,this.children.slice(t));for(let a=0;a<s.length;a++)s[a].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new tq(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,s,a,r,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}As.prototype.breakAfter=0;function I4(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class tq{constructor(e,t,s){this.children=e,this.pos=t,this.i=s,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let s=this.children[--this.i];this.pos-=s.length+s.breakAfter}}}function nq(n,e,t,s,a,r,o,i,l){let{children:c}=n,u=c.length?c[e]:null,h=r.length?r[r.length-1]:null,m=h?h.breakAfter:o;if(!(e==s&&u&&!o&&!m&&r.length<2&&u.merge(t,a,r.length?h:null,t==0,i,l))){if(s<c.length){let f=c[s];f&&(a<f.length||f.breakAfter&&(h!=null&&h.breakAfter))?(e==s&&(f=f.split(a),a=0),!m&&h&&f.merge(0,a,h,!0,0,l)?r[r.length-1]=f:((a||f.children.length&&!f.children[0].length)&&f.merge(0,a,null,!1,0,l),r.push(f))):f!=null&&f.breakAfter&&(h?h.breakAfter=1:o=1),s++}for(u&&(u.breakAfter=o,t>0&&(!o&&r.length&&u.merge(t,u.length,r[0],!1,i,0)?u.breakAfter=r.shift().breakAfter:(t<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(t,u.length,null,!1,i,0),e++));e<s&&r.length;)if(c[s-1].become(r[r.length-1]))s--,r.pop(),l=r.length?0:i;else if(c[e].become(r[0]))e++,r.shift(),i=r.length?0:l;else break;!r.length&&e&&s<c.length&&!c[e-1].breakAfter&&c[s].merge(0,0,c[e-1],!1,i,l)&&e--,(e<s||r.length)&&n.replaceChildren(e,s,r)}}function sq(n,e,t,s,a,r){let o=n.childCursor(),{i,off:l}=o.findPos(t,1),{i:c,off:u}=o.findPos(e,-1),h=e-t;for(let m of s)h+=m.length;n.length+=h,nq(n,c,u,i,l,s,0,a,r)}let ro=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},SS=typeof document<"u"?document:{documentElement:{style:{}}};const CS=/Edge\/(\d+)/.exec(ro.userAgent),aq=/MSIE \d/.test(ro.userAgent),MS=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ro.userAgent),Dw=!!(aq||MS||CS),Q4=!Dw&&/gecko\/(\d+)/i.test(ro.userAgent),sk=!Dw&&/Chrome\/(\d+)/.exec(ro.userAgent),V4="webkitFontSmoothing"in SS.documentElement.style,rq=!Dw&&/Apple Computer/.test(ro.vendor),j4=rq&&(/Mobile\/\w+/.test(ro.userAgent)||ro.maxTouchPoints>2);var Bt={mac:j4||/Mac/.test(ro.platform),windows:/Win/.test(ro.platform),linux:/Linux|X11/.test(ro.platform),ie:Dw,ie_version:aq?SS.documentMode||6:MS?+MS[1]:CS?+CS[1]:0,gecko:Q4,gecko_version:Q4?+(/Firefox\/(\d+)/.exec(ro.userAgent)||[0,0])[1]:0,chrome:!!sk,chrome_version:sk?+sk[1]:0,ios:j4,android:/Android\b/.test(ro.userAgent),webkit:V4,safari:rq,webkit_version:V4?+(/\bAppleWebKit\/(\d+)/.exec(ro.userAgent)||[0,0])[1]:0,tabSize:SS.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const h2e=256;class nl extends As{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,s){return this.flags&8||s&&(!(s instanceof nl)||this.length-(t-e)+s.length>h2e||s.flags&8)?!1:(this.text=this.text.slice(0,e)+(s?s.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new nl(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new ur(this.dom,e)}domBoundsAround(e,t,s){return{from:s,to:s+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return d2e(this.dom,e,t)}}class _c extends As{constructor(e,t=[],s=0){super(),this.mark=e,this.children=t,this.length=s;for(let a of t)a.setParent(this)}setAttrs(e){if(YW(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,s,a,r,o){return s&&(!(s instanceof _c&&s.mark.eq(this.mark))||e&&r<=0||t<this.length&&o<=0)?!1:(sq(this,e,t,s?s.children.slice():[],r-1,o-1),this.markDirty(),!0)}split(e){let t=[],s=0,a=-1,r=0;for(let i of this.children){let l=s+i.length;l>e&&t.push(s<e?i.split(e-s):i),a<0&&s>=e&&(a=r),s=l,r++}let o=this.length-e;return this.length=e,a>-1&&(this.children.length=a,this.markDirty()),new _c(this.mark,t,o)}domAtPos(e){return oq(this,e)}coordsAt(e,t){return lq(this,e,t)}}function d2e(n,e,t){let s=n.nodeValue.length;e>s&&(e=s);let a=e,r=e,o=0;e==0&&t<0||e==s&&t>=0?Bt.chrome||Bt.gecko||(e?(a--,o=1):r<s&&(r++,o=-1)):t<0?a--:r<s&&r++;let i=zh(n,a,r).getClientRects();if(!i.length)return null;let l=i[(o?o<0:t>=0)?0:i.length-1];return Bt.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(i,c=>c.width)||l),o?Ew(l,o<0):l||null}class hu extends As{static create(e,t,s){return new hu(e,t,s)}constructor(e,t,s){super(),this.widget=e,this.length=t,this.side=s,this.prevWidget=null}split(e){let t=hu.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,s,a,r,o){return s&&(!(s instanceof hu)||!this.widget.compare(s.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-t),!0)}become(e){return e instanceof hu&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return os.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,s=t&&t.state.doc,a=this.posAtStart;return s?s.slice(a,a+this.length):os.empty}domAtPos(e){return(this.length?e==0:this.side>0)?ur.before(this.dom):ur.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let s=this.widget.coordsAt(this.dom,e,t);if(s)return s;let a=this.dom.getClientRects(),r=null;if(!a.length)return null;let o=this.side?this.side<0:e>0;for(let i=o?a.length-1:0;r=a[i],!(e>0?i==0:i==a.length-1||r.top<r.bottom);i+=o?-1:1);return Ew(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class vm extends As{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof vm&&e.side==this.side}split(){return new vm(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?ur.before(this.dom):ur.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return os.empty}get isHidden(){return!0}}nl.prototype.children=hu.prototype.children=vm.prototype.children=y3;function oq(n,e){let t=n.dom,{children:s}=n,a=0;for(let r=0;a<s.length;a++){let o=s[a],i=r+o.length;if(!(i==r&&o.getSide()<=0)){if(e>r&&e<i&&o.dom.parentNode==t)return o.domAtPos(e-r);if(e<=r)break;r=i}}for(let r=a;r>0;r--){let o=s[r-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let r=a;r<s.length;r++){let o=s[r];if(o.dom.parentNode==t)return o.domAtPos(0)}return new ur(t,0)}function iq(n,e,t){let s,{children:a}=n;t>0&&e instanceof _c&&a.length&&(s=a[a.length-1])instanceof _c&&s.mark.eq(e.mark)?iq(s,e.children[0],t-1):(a.push(e),e.setParent(n)),n.length+=e.length}function lq(n,e,t){let s=null,a=-1,r=null,o=-1;function i(c,u){for(let h=0,m=0;h<c.children.length&&m<=u;h++){let f=c.children[h],v=m+f.length;v>=u&&(f.children.length?i(f,u-m):(!r||r.isHidden&&t>0)&&(v>u||m==v&&f.getSide()>0)?(r=f,o=u-m):(m<u||m==v&&f.getSide()<0&&!f.isHidden)&&(s=f,a=u-m)),m=v}}i(n,e);let l=(t<0?s:r)||s||r;return l?l.coordsAt(Math.max(0,l==s?a:o),t):m2e(n)}function m2e(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=pg(e);return t[t.length-1]||null}function AS(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const Z4=Object.create(null);function _y(n,e,t){if(n==e)return!0;n||(n=Z4),e||(e=Z4);let s=Object.keys(n),a=Object.keys(e);if(s.length-(t&&s.indexOf(t)>-1?1:0)!=a.length-(t&&a.indexOf(t)>-1?1:0))return!1;for(let r of s)if(r!=t&&(a.indexOf(r)==-1||n[r]!==e[r]))return!1;return!0}function ES(n,e,t){let s=!1;if(e)for(let a in e)t&&a in t||(s=!0,a=="style"?n.style.cssText="":n.removeAttribute(a));if(t)for(let a in t)e&&e[a]==t[a]||(s=!0,a=="style"?n.style.cssText=t[a]:n.setAttribute(a,t[a]));return s}function p2e(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let s=n.attributes[t];e[s.name]=s.value}return e}class cl{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,s){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Dr=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(Dr||(Dr={}));class en extends jh{constructor(e,t,s,a){super(),this.startSide=e,this.endSide=t,this.widget=s,this.spec=a}get heightRelevant(){return!1}static mark(e){return new s0(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),s=!!e.block;return t+=s&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Bu(e,t,t,s,e.widget||null,!1)}static replace(e){let t=!!e.block,s,a;if(e.isBlockGap)s=-5e8,a=4e8;else{let{start:r,end:o}=cq(e,t);s=(r?t?-3e8:-1:5e8)-1,a=(o?t?2e8:1:-6e8)+1}return new Bu(e,s,a,t,e.widget||null,!0)}static line(e){return new a0(e)}static set(e,t=!1){return hs.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}en.none=hs.empty;class s0 extends en{constructor(e){let{start:t,end:s}=cq(e);super(t?-1:5e8,s?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,s;return this==e||e instanceof s0&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((s=e.attrs)===null||s===void 0?void 0:s.class))&&_y(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}s0.prototype.point=!1;class a0 extends en{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof a0&&this.spec.class==e.spec.class&&_y(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}a0.prototype.mapMode=ga.TrackBefore;a0.prototype.point=!0;class Bu extends en{constructor(e,t,s,a,r,o){super(t,s,r,e),this.block=a,this.isReplace=o,this.mapMode=a?t<=0?ga.TrackBefore:ga.TrackAfter:ga.TrackDel}get type(){return this.startSide!=this.endSide?Dr.WidgetRange:this.startSide<=0?Dr.WidgetBefore:Dr.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Bu&&f2e(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Bu.prototype.point=!0;function cq(n,e=!1){let{inclusiveStart:t,inclusiveEnd:s}=n;return t==null&&(t=n.inclusive),s==null&&(s=n.inclusive),{start:t??e,end:s??e}}function f2e(n,e){return n==e||!!(n&&e&&n.compare(e))}function r1(n,e,t,s=0){let a=t.length-1;a>=0&&t[a]+s>=n?t[a]=Math.max(t[a],e):t.push(n,e)}class pa extends As{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,s,a,r,o){if(s){if(!(s instanceof pa))return!1;this.dom||s.transferDOM(this)}return a&&this.setDeco(s?s.attrs:null),sq(this,e,t,s?s.children.slice():[],r,o),!0}split(e){let t=new pa;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:s,off:a}=this.childPos(e);a&&(t.append(this.children[s].split(a),0),this.children[s].merge(a,this.children[s].length,null,!1,0,0),s++);for(let r=s;r<this.children.length;r++)t.append(this.children[r],0);for(;s>0&&this.children[s-1].length==0;)this.children[--s].destroy();return this.children.length=s,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){_y(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){iq(this,e,t)}addLineDeco(e){let t=e.spec.attributes,s=e.spec.class;t&&(this.attrs=AS(t,this.attrs||{})),s&&(this.attrs=AS({class:s},this.attrs||{}))}domAtPos(e){return oq(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var s;this.dom?this.flags&4&&(YW(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(ES(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let a=this.dom.lastChild;for(;a&&As.get(a)instanceof _c;)a=a.lastChild;if(!a||!this.length||a.nodeName!="BR"&&((s=As.get(a))===null||s===void 0?void 0:s.isEditable)==!1&&(!Bt.ios||!this.children.some(r=>r instanceof nl))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let s of this.children){if(!(s instanceof nl)||/[^ -~]/.test(s.text))return null;let a=pg(s.dom);if(a.length!=1)return null;e+=a[0].width,t=a[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let s=lq(this,e,t);if(!this.children.length&&s&&this.parent){let{heightOracle:a}=this.parent.view.viewState,r=s.bottom-s.top;if(Math.abs(r-a.lineHeight)<2&&a.textHeight<r){let o=(r-a.textHeight)/2;return{top:s.top+o,bottom:s.bottom-o,left:s.left,right:s.left}}}return s}become(e){return e instanceof pa&&this.children.length==0&&e.children.length==0&&_y(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let s=0,a=0;s<e.children.length;s++){let r=e.children[s],o=a+r.length;if(o>=t){if(r instanceof pa)return r;if(o>t)break}a=o+r.breakAfter}return null}}class Ec extends As{constructor(e,t,s){super(),this.widget=e,this.length=t,this.deco=s,this.breakAfter=0,this.prevWidget=null}merge(e,t,s,a,r,o){return s&&(!(s instanceof Ec)||!this.widget.compare(s.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?ur.before(this.dom):ur.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let s=new Ec(this.widget,t,this.deco);return s.breakAfter=this.breakAfter,s}get children(){return y3}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):os.empty}domBoundsAround(){return null}become(e){return e instanceof Ec&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)||(this.widget instanceof DS?null:Ew(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:s}=this.deco;return t==s?!1:e<0?t<0:s>0}}class DS extends cl{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Ef{constructor(e,t,s,a){this.doc=e,this.pos=t,this.end=s,this.disallowBlockEffectsFor=a,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Ec&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new pa),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(J0(new vm(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Ec)&&this.getLine()}buildText(e,t,s){for(;e>0;){if(this.textOff==this.text.length){let{value:r,lineBreak:o,done:i}=this.cursor.next(this.skip);if(this.skip=0,i)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=r,this.textOff=0}let a=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-s)),this.getLine().append(J0(new nl(this.text.slice(this.textOff,this.textOff+a)),t),s),this.atCursorPos=!0,this.textOff+=a,e-=a,s=0}}span(e,t,s,a){this.buildText(t-e,s,a),this.pos=t,this.openStart<0&&(this.openStart=a)}point(e,t,s,a,r,o){if(this.disallowBlockEffectsFor[o]&&s instanceof Bu){if(s.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let i=t-e;if(s instanceof Bu)if(s.block)s.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Ec(s.widget||wm.block,i,s));else{let l=hu.create(s.widget||wm.inline,i,i?0:s.startSide),c=this.atCursorPos&&!l.isEditable&&r<=a.length&&(e<t||s.startSide>0),u=!l.isEditable&&(e<t||r>a.length||s.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(a),c&&(h.append(J0(new vm(1),a),r),r=a.length+Math.max(0,r-a.length)),h.append(J0(l,a),r),this.atCursorPos=u,this.pendingBuffer=u?e<t||r>a.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=a.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(s);i&&(this.textOff+i<=this.text.length?this.textOff+=i:(this.skip+=i-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=r)}static build(e,t,s,a,r){let o=new Ef(e,t,s,r);return o.openEnd=hs.spans(a,t,s,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function J0(n,e){for(let t of e)n=new _c(t,[n],n.length);return n}class wm extends cl{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}wm.inline=new wm("span");wm.block=new wm("div");var Ds=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(Ds||(Ds={}));const Gh=Ds.LTR,v3=Ds.RTL;function uq(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const g2e=uq("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),b2e=uq("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),TS=Object.create(null),fl=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);TS[e]=t,TS[t]=-e}function hq(n){return n<=247?g2e[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?b2e[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const y2e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class du{get dir(){return this.level%2?v3:Gh}constructor(e,t,s){this.from=e,this.to=t,this.level=s}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,s,a){let r=-1;for(let o=0;o<e.length;o++){let i=e[o];if(i.from<=t&&i.to>=t){if(i.level==s)return o;(r<0||(a!=0?a<0?i.from<t:i.to>t:e[r].level>i.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}function dq(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let s=n[t],a=e[t];if(s.from!=a.from||s.to!=a.to||s.direction!=a.direction||!dq(s.inner,a.inner))return!1}return!0}const Ms=[];function v2e(n,e,t,s,a){for(let r=0;r<=s.length;r++){let o=r?s[r-1].to:e,i=r<s.length?s[r].from:t,l=r?256:a;for(let c=o,u=l,h=l;c<i;c++){let m=hq(n.charCodeAt(c));m==512?m=u:m==8&&h==4&&(m=16),Ms[c]=m==4?2:m,m&7&&(h=m),u=m}for(let c=o,u=l,h=l;c<i;c++){let m=Ms[c];if(m==128)c<i-1&&u==Ms[c+1]&&u&24?m=Ms[c]=u:Ms[c]=256;else if(m==64){let f=c+1;for(;f<i&&Ms[f]==64;)f++;let v=c&&u==8||f<t&&Ms[f]==8?h==1?1:8:256;for(let O=c;O<f;O++)Ms[O]=v;c=f-1}else m==8&&h==1&&(Ms[c]=1);u=m,m&7&&(h=m)}}}function w2e(n,e,t,s,a){let r=a==1?2:1;for(let o=0,i=0,l=0;o<=s.length;o++){let c=o?s[o-1].to:e,u=o<s.length?s[o].from:t;for(let h=c,m,f,v;h<u;h++)if(f=TS[m=n.charCodeAt(h)])if(f<0){for(let O=i-3;O>=0;O-=3)if(fl[O+1]==-f){let k=fl[O+2],M=k&2?a:k&4?k&1?r:a:0;M&&(Ms[h]=Ms[fl[O]]=M),i=O;break}}else{if(fl.length==189)break;fl[i++]=h,fl[i++]=m,fl[i++]=l}else if((v=Ms[h])==2||v==1){let O=v==a;l=O?0:1;for(let k=i-3;k>=0;k-=3){let M=fl[k+2];if(M&2)break;if(O)fl[k+2]|=2;else{if(M&4)break;fl[k+2]|=4}}}}}function O2e(n,e,t,s){for(let a=0,r=s;a<=t.length;a++){let o=a?t[a-1].to:n,i=a<t.length?t[a].from:e;for(let l=o;l<i;){let c=Ms[l];if(c==256){let u=l+1;for(;;)if(u==i){if(a==t.length)break;u=t[a++].to,i=a<t.length?t[a].from:e}else if(Ms[u]==256)u++;else break;let h=r==1,m=(u<e?Ms[u]:s)==1,f=h==m?h?1:2:s;for(let v=u,O=a,k=O?t[O-1].to:n;v>l;)v==k&&(v=t[--O].from,k=O?t[O-1].to:n),Ms[--v]=f;l=u}else r=c,l++}}}function FS(n,e,t,s,a,r,o){let i=s%2?2:1;if(s%2==a%2)for(let l=e,c=0;l<t;){let u=!0,h=!1;if(c==r.length||l<r[c].from){let O=Ms[l];O!=i&&(u=!1,h=O==16)}let m=!u&&i==1?[]:null,f=u?s:s+1,v=l;e:for(;;)if(c<r.length&&v==r[c].from){if(h)break e;let O=r[c];if(!u)for(let k=O.to,M=c+1;;){if(k==t)break e;if(M<r.length&&r[M].from==k)k=r[M++].to;else{if(Ms[k]==i)break e;break}}if(c++,m)m.push(O);else{O.from>l&&o.push(new du(l,O.from,f));let k=O.direction==Gh!=!(f%2);NS(n,k?s+1:s,a,O.inner,O.from,O.to,o),l=O.to}v=O.to}else{if(v==t||(u?Ms[v]!=i:Ms[v]==i))break;v++}m?FS(n,l,v,s+1,a,m,o):l<v&&o.push(new du(l,v,f)),l=v}else for(let l=t,c=r.length;l>e;){let u=!0,h=!1;if(!c||l>r[c-1].to){let O=Ms[l-1];O!=i&&(u=!1,h=O==16)}let m=!u&&i==1?[]:null,f=u?s:s+1,v=l;e:for(;;)if(c&&v==r[c-1].to){if(h)break e;let O=r[--c];if(!u)for(let k=O.from,M=c;;){if(k==e)break e;if(M&&r[M-1].to==k)k=r[--M].from;else{if(Ms[k-1]==i)break e;break}}if(m)m.push(O);else{O.to<l&&o.push(new du(O.to,l,f));let k=O.direction==Gh!=!(f%2);NS(n,k?s+1:s,a,O.inner,O.from,O.to,o),l=O.from}v=O.from}else{if(v==e||(u?Ms[v-1]!=i:Ms[v-1]==i))break;v--}m?FS(n,v,l,s+1,a,m,o):v<l&&o.push(new du(v,l,f)),l=v}}function NS(n,e,t,s,a,r,o){let i=e%2?2:1;v2e(n,a,r,s,i),w2e(n,a,r,s,i),O2e(a,r,s,i),FS(n,a,r,e,t,s,o)}function x2e(n,e,t){if(!n)return[new du(0,0,e==v3?1:0)];if(e==Gh&&!t.length&&!y2e.test(n))return mq(n.length);if(t.length)for(;n.length>Ms.length;)Ms[Ms.length]=256;let s=[],a=e==Gh?0:1;return NS(n,a,a,t,0,n.length,s),s}function mq(n){return[new du(0,n,0)]}let pq="";function k2e(n,e,t,s,a){var r;let o=s.head-n.from,i=du.find(e,o,(r=s.bidiLevel)!==null&&r!==void 0?r:-1,s.assoc),l=e[i],c=l.side(a,t);if(o==c){let m=i+=a?1:-1;if(m<0||m>=e.length)return null;l=e[i=m],o=l.side(!a,t),c=l.side(a,t)}let u=Ya(n.text,o,l.forward(a,t));(u<l.from||u>l.to)&&(u=c),pq=n.text.slice(Math.min(o,u),Math.max(o,u));let h=i==(a?e.length-1:0)?null:e[i+(a?1:-1)];return h&&u==c&&h.level+(a?0:1)<l.level?Ze.cursor(h.side(!a,t)+n.from,h.forward(a,t)?1:-1,h.level):Ze.cursor(u+n.from,l.forward(a,t)?-1:1,l.level)}function P2e(n,e,t){for(let s=e;s<t;s++){let a=hq(n.charCodeAt(s));if(a==1)return Gh;if(a==2||a==4)return v3}return Gh}const fq=Qt.define(),gq=Qt.define(),bq=Qt.define(),yq=Qt.define(),BS=Qt.define(),vq=Qt.define(),wq=Qt.define(),w3=Qt.define(),O3=Qt.define(),Oq=Qt.define({combine:n=>n.some(e=>e)}),xq=Qt.define({combine:n=>n.some(e=>e)}),kq=Qt.define();class Xd{constructor(e,t="nearest",s="nearest",a=5,r=5,o=!1){this.range=e,this.y=t,this.x=s,this.yMargin=a,this.xMargin=r,this.isSnapshot=o}map(e){return e.empty?this:new Xd(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Xd(Ze.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const eb=hn.define({map:(n,e)=>n.map(e)}),Pq=hn.define();function co(n,e,t){let s=n.facet(yq);s.length?s[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const xc=Qt.define({combine:n=>n.length?n[0]:!0});let S2e=0;const nf=Qt.define();class ra{constructor(e,t,s,a,r){this.id=e,this.create=t,this.domEventHandlers=s,this.domEventObservers=a,this.extension=r(this)}static define(e,t){const{eventHandlers:s,eventObservers:a,provide:r,decorations:o}=t||{};return new ra(S2e++,e,s,a,i=>{let l=[nf.of(i)];return o&&l.push(fg.of(c=>{let u=c.plugin(i);return u?o(u):en.none})),r&&l.push(r(i)),l})}static fromClass(e,t){return ra.define(s=>new e(s),t)}}class ak{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(s){if(co(t.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){co(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(s){co(e.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Sq=Qt.define(),x3=Qt.define(),fg=Qt.define(),Cq=Qt.define(),k3=Qt.define(),Mq=Qt.define();function z4(n,e){let t=n.state.facet(Mq);if(!t.length)return t;let s=t.map(r=>r instanceof Function?r(n):r),a=[];return hs.spans(s,e.from,e.to,{point(){},span(r,o,i,l){let c=r-e.from,u=o-e.from,h=a;for(let m=i.length-1;m>=0;m--,l--){let f=i[m].spec.bidiIsolate,v;if(f==null&&(f=P2e(e.text,c,u)),l>0&&h.length&&(v=h[h.length-1]).to==c&&v.direction==f)v.to=u,h=v.inner;else{let O={from:c,to:u,direction:f,inner:[]};h.push(O),h=O.inner}}}}),a}const Aq=Qt.define();function P3(n){let e=0,t=0,s=0,a=0;for(let r of n.state.facet(Aq)){let o=r(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(s=Math.max(s,o.top)),o.bottom!=null&&(a=Math.max(a,o.bottom)))}return{left:e,right:t,top:s,bottom:a}}const sf=Qt.define();class bi{constructor(e,t,s,a){this.fromA=e,this.toA=t,this.fromB=s,this.toB=a}join(e){return new bi(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,s=this;for(;t>0;t--){let a=e[t-1];if(!(a.fromA>s.toA)){if(a.toA<s.fromA)break;s=s.join(a),e.splice(t-1,1)}}return e.splice(t,0,s),e}static extendWithRanges(e,t){if(t.length==0)return e;let s=[];for(let a=0,r=0,o=0,i=0;;a++){let l=a==e.length?null:e[a],c=o-i,u=l?l.fromB:1e9;for(;r<t.length&&t[r]<u;){let h=t[r],m=t[r+1],f=Math.max(i,h),v=Math.min(u,m);if(f<=v&&new bi(f+c,v+c,f,v).addToSet(s),m>u)break;r+=2}if(!l)return s;new bi(l.fromA,l.toA,l.fromB,l.toB).addToSet(s),o=l.toA,i=l.toB}}}class Ly{constructor(e,t,s){this.view=e,this.state=t,this.transactions=s,this.flags=0,this.startState=e.state,this.changes=Pa.empty(this.startState.doc.length);for(let r of s)this.changes=this.changes.compose(r.changes);let a=[];this.changes.iterChangedRanges((r,o,i,l)=>a.push(new bi(r,o,i,l))),this.changedRanges=a}static create(e,t,s){return new Ly(e,t,s)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class G4 extends As{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=en.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new pa],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new bi(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let s=e.changedRanges;this.minWidth>0&&s.length&&(s.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let a=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?a=this.domChanged.newSel.head:!F2e(e.changes,this.hasComposition)&&!e.selectionSet&&(a=e.state.selection.main.head));let r=a>-1?M2e(this.view,e.changes,a):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;s=new bi(c,u,e.changes.mapPos(c,-1),e.changes.mapPos(u,1)).addToSet(s.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(Bt.ie||Bt.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,i=this.updateDeco(),l=D2e(o,i,e.changes);return s=bi.extendWithRanges(s,l),!(this.flags&7)&&s.length==0?!1:(this.updateInner(s,e.startState.doc.length,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,s){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,s);let{observer:a}=this.view;a.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Bt.chrome||Bt.ios?{node:a.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||a.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Ec&&o.widget instanceof DS&&r.push(o.dom);a.updateGaps(r)}updateChildren(e,t,s){let a=s?s.range.addToSet(e.slice()):e,r=this.childCursor(t);for(let o=a.length-1;;o--){let i=o>=0?a[o]:null;if(!i)break;let{fromA:l,toA:c,fromB:u,toB:h}=i,m,f,v,O;if(s&&s.range.fromB<h&&s.range.toB>u){let D=Ef.build(this.view.state.doc,u,s.range.fromB,this.decorations,this.dynamicDecorationMap),F=Ef.build(this.view.state.doc,s.range.toB,h,this.decorations,this.dynamicDecorationMap);f=D.breakAtStart,v=D.openStart,O=F.openEnd;let _=this.compositionView(s);F.breakAtStart?_.breakAfter=1:F.content.length&&_.merge(_.length,_.length,F.content[0],!1,F.openStart,0)&&(_.breakAfter=F.content[0].breakAfter,F.content.shift()),D.content.length&&_.merge(0,0,D.content[D.content.length-1],!0,0,D.openEnd)&&D.content.pop(),m=D.content.concat(_).concat(F.content)}else({content:m,breakAtStart:f,openStart:v,openEnd:O}=Ef.build(this.view.state.doc,u,h,this.decorations,this.dynamicDecorationMap));let{i:k,off:M}=r.findPos(c,1),{i:E,off:I}=r.findPos(l,-1);nq(this,E,I,k,M,m,f,v,O)}s&&this.fixCompositionDOM(s)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let s of t.effects)s.is(Pq)&&(this.editContextFormatting=s.value)}compositionView(e){let t=new nl(e.text.nodeValue);t.flags|=8;for(let{deco:a}of e.marks)t=new _c(a,[t],t.length);let s=new pa;return s.append(t,0),s}fixCompositionDOM(e){let t=(r,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let i=As.get(r);i&&i!=o&&(i.dom=null),o.setDOM(r)},s=this.childPos(e.range.fromB,1),a=this.children[s.i];t(e.line,a);for(let r=e.marks.length-1;r>=-1;r--)s=a.childPos(s.off,1),a=a.children[s.i],t(r>=0?e.marks[r].node:e.text,a)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let s=this.view.root.activeElement,a=s==this.dom,r=!a&&!(this.view.state.facet(xc)||this.dom.tabIndex>-1)&&a1(this.dom,this.view.observer.selectionRange)&&!(s&&this.dom.contains(s));if(!(a||t||r))return;let o=this.forceSelection;this.forceSelection=!1;let i=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(i.anchor)),c=i.empty?l:this.moveToLine(this.domAtPos(i.head));if(Bt.gecko&&i.empty&&!this.hasComposition&&C2e(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=c=new ur(h,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||(!Af(l.node,l.offset,u.anchorNode,u.anchorOffset)||!Af(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,i))&&(this.view.observer.ignore(()=>{Bt.android&&Bt.chrome&&this.dom.contains(u.focusNode)&&T2e(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=mg(this.view.root);if(h)if(i.empty){if(Bt.gecko){let m=A2e(l.node,l.offset);if(m&&m!=3){let f=(m==1?JW:eq)(l.node,l.offset);f&&(l=new ur(f.node,f.offset))}}h.collapse(l.node,l.offset),i.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=i.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(c.node,c.offset)}catch{}}else{let m=document.createRange();i.anchor>i.head&&([l,c]=[c,l]),m.setEnd(c.node,c.offset),m.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(m)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new ur(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new ur(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Af(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,s=mg(e.root),{anchorNode:a,anchorOffset:r}=e.observer.selectionRange;if(!s||!t.empty||!t.assoc||!s.modify)return;let o=pa.find(this,t.head);if(!o)return;let i=o.posAtStart;if(t.head==i||t.head==i+o.length)return;let l=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(t.head+t.assoc);s.collapse(u.node,u.offset),s.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&s.collapse(a,r)}moveToLine(e){let t=this.dom,s;if(e.node!=t)return e;for(let a=e.offset;!s&&a<t.childNodes.length;a++){let r=As.get(t.childNodes[a]);r instanceof pa&&(s=r.domAtPos(0))}for(let a=e.offset-1;!s&&a>=0;a--){let r=As.get(t.childNodes[a]);r instanceof pa&&(s=r.domAtPos(r.length))}return s?new ur(s.node,s.offset,!0):e}nearest(e){for(let t=e;t;){let s=As.get(t);if(s&&s.rootView==this)return s;t=t.parentNode}return null}posFromDOM(e,t){let s=this.nearest(e);if(!s)throw new RangeError("Trying to find position for a DOM position outside of the document");return s.localPosFromDOM(e,t)+s.posAtStart}domAtPos(e){let{i:t,off:s}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let a=this.children[t];if(s<a.length||a instanceof pa)break;t++,s=0}return this.children[t].domAtPos(s)}coordsAt(e,t){let s=null,a=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let i=this.children[o],l=r-i.breakAfter,c=l-i.length;if(l<e)break;if(c<=e&&(c<e||i.covers(-1))&&(l>e||i.covers(1))&&(!s||i instanceof pa&&!(s instanceof pa&&t>=0)))s=i,a=c;else if(s&&c==e&&l==e&&i instanceof Ec&&Math.abs(t)<2){if(i.deco.startSide<0)break;o&&(s=null)}r=c}return s?s.coordsAt(e-a,t):null}coordsForChar(e){let{i:t,off:s}=this.childPos(e,1),a=this.children[t];if(!(a instanceof pa))return null;for(;a.children.length;){let{i,off:l}=a.childPos(s,1);for(;;i++){if(i==a.children.length)return null;if((a=a.children[i]).length)break}s=l}if(!(a instanceof nl))return null;let r=Ya(a.text,s);if(r==s)return null;let o=zh(a.dom,s,r).getClientRects();for(let i=0;i<o.length;i++){let l=o[i];if(i==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:s,to:a}=e,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,i=-1,l=this.view.textDirection==Ds.LTR;for(let c=0,u=0;u<this.children.length;u++){let h=this.children[u],m=c+h.length;if(m>a)break;if(c>=s){let f=h.dom.getBoundingClientRect();if(t.push(f.height),o){let v=h.dom.lastChild,O=v?pg(v):[];if(O.length){let k=O[O.length-1],M=l?k.right-f.left:f.right-k.left;M>i&&(i=M,this.minWidth=r,this.minWidthFrom=c,this.minWidthTo=m)}}}c=m+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Ds.RTL:Ds.LTR}measureTextSize(){for(let r of this.children)if(r instanceof pa){let o=r.measureTextSize();if(o)return o}let e=document.createElement("div"),t,s,a;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let r=pg(e.firstChild)[0];t=e.getBoundingClientRect().height,s=r?r.width/27:7,a=r?r.height:t,e.remove()}),{lineHeight:t,charWidth:s,textHeight:a}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new tq(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let s=0,a=0;;a++){let r=a==t.viewports.length?null:t.viewports[a],o=r?r.from-1:this.length;if(o>s){let i=(t.lineBlockAt(o).bottom-t.lineBlockAt(s).top)/this.view.scaleY;e.push(en.replace({widget:new DS(i),block:!0,inclusive:!0,isBlockGap:!0}).range(s,o))}if(!r)break;s=r.to+1}return en.set(e)}updateDeco(){let e=1,t=this.view.state.facet(fg).map(r=>(this.dynamicDecorationMap[e++]=typeof r=="function")?r(this.view):r),s=!1,a=this.view.state.facet(Cq).map((r,o)=>{let i=typeof r=="function";return i&&(s=!0),i?r(this.view):r});for(a.length&&(this.dynamicDecorationMap[e++]=s,t.push(hs.join(a))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(kq))try{if(c(this.view,e.range,e))return!0}catch(u){co(this.view.state,u,"scroll handler")}let{range:t}=e,s=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),a;if(!s)return;!t.empty&&(a=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(s={left:Math.min(s.left,a.left),top:Math.min(s.top,a.top),right:Math.max(s.right,a.right),bottom:Math.max(s.bottom,a.bottom)});let r=P3(this.view),o={left:s.left-r.left,top:s.top-r.top,right:s.right+r.right,bottom:s.bottom+r.bottom},{offsetWidth:i,offsetHeight:l}=this.view.scrollDOM;o2e(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,i),-i),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Ds.LTR)}}function C2e(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function Eq(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let s=JW(t.focusNode,t.focusOffset),a=eq(t.focusNode,t.focusOffset),r=s||a;if(a&&s&&a.node!=s.node){let i=As.get(a.node);if(!i||i instanceof nl&&i.text!=a.node.nodeValue)r=a;else if(n.docView.lastCompositionAfterCursor){let l=As.get(s.node);!l||l instanceof nl&&l.text!=s.node.nodeValue||(r=a)}}if(n.docView.lastCompositionAfterCursor=r!=s,!r)return null;let o=e-r.offset;return{from:o,to:o+r.node.nodeValue.length,node:r.node}}function M2e(n,e,t){let s=Eq(n,t);if(!s)return null;let{node:a,from:r,to:o}=s,i=a.nodeValue;if(/[\n\r]/.test(i)||n.state.doc.sliceString(s.from,s.to)!=i)return null;let l=e.invertedDesc,c=new bi(l.mapPos(r),l.mapPos(o),r,o),u=[];for(let h=a.parentNode;;h=h.parentNode){let m=As.get(h);if(m instanceof _c)u.push({node:h,deco:m.mark});else{if(m instanceof pa||h.nodeName=="DIV"&&h.parentNode==n.contentDOM)return{range:c,text:a,marks:u,line:h};if(h!=n.contentDOM)u.push({node:h,deco:new s0({inclusive:!0,attributes:p2e(h),tagName:h.tagName.toLowerCase()})});else return null}}}function A2e(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let E2e=class{constructor(){this.changes=[]}compareRange(n,e){r1(n,e,this.changes)}comparePoint(n,e){r1(n,e,this.changes)}boundChange(n){r1(n,n,this.changes)}};function D2e(n,e,t){let s=new E2e;return hs.compare(n,e,t,s),s.changes}function T2e(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function F2e(n,e){let t=!1;return e&&n.iterChangedRanges((s,a)=>{s<e.to&&a>e.from&&(t=!0)}),t}function N2e(n,e,t=1){let s=n.charCategorizer(e),a=n.doc.lineAt(e),r=e-a.from;if(a.length==0)return Ze.cursor(e);r==0?t=1:r==a.length&&(t=-1);let o=r,i=r;t<0?o=Ya(a.text,r,!1):i=Ya(a.text,r);let l=s(a.text.slice(o,i));for(;o>0;){let c=Ya(a.text,o,!1);if(s(a.text.slice(c,o))!=l)break;o=c}for(;i<a.length;){let c=Ya(a.text,i);if(s(a.text.slice(i,c))!=l)break;i=c}return Ze.range(o+a.from,i+a.from)}function B2e(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function $2e(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function rk(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function X4(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function W4(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function $S(n,e,t){let s,a,r,o,i=!1,l,c,u,h;for(let v=n.firstChild;v;v=v.nextSibling){let O=pg(v);for(let k=0;k<O.length;k++){let M=O[k];a&&rk(a,M)&&(M=X4(W4(M,a.bottom),a.top));let E=B2e(e,M),I=$2e(t,M);if(E==0&&I==0)return v.nodeType==3?q4(v,e,t):$S(v,e,t);if(!s||o>I||o==I&&r>E){s=v,a=M,r=E,o=I;let D=I?t<M.top?-1:1:E?e<M.left?-1:1:0;i=!D||(D>0?k<O.length-1:k>0)}E==0?t>M.bottom&&(!u||u.bottom<M.bottom)?(l=v,u=M):t<M.top&&(!h||h.top>M.top)&&(c=v,h=M):u&&rk(u,M)?u=W4(u,M.bottom):h&&rk(h,M)&&(h=X4(h,M.top))}}if(u&&u.bottom>=t?(s=l,a=u):h&&h.top<=t&&(s=c,a=h),!s)return{node:n,offset:0};let m=Math.max(a.left,Math.min(a.right,e));if(s.nodeType==3)return q4(s,m,t);if(i&&s.contentEditable!="false")return $S(s,m,t);let f=Array.prototype.indexOf.call(n.childNodes,s)+(e>=(a.left+a.right)/2?1:0);return{node:n,offset:f}}function q4(n,e,t){let s=n.nodeValue.length,a=-1,r=1e9,o=0;for(let i=0;i<s;i++){let l=zh(n,i,i+1).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(u.top==u.bottom)continue;o||(o=e-u.left);let h=(u.top>t?u.top-t:t-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&h<r){let m=e>=(u.left+u.right)/2,f=m;if((Bt.chrome||Bt.gecko)&&zh(n,i).getBoundingClientRect().left==u.right&&(f=!m),h<=0)return{node:n,offset:i+(f?1:0)};a=i+(f?1:0),r=h}}}return{node:n,offset:a>-1?a:o>0?n.nodeValue.length:0}}function Dq(n,e,t,s=-1){var a,r;let o=n.contentDOM.getBoundingClientRect(),i=o.top+n.viewState.paddingTop,l,{docHeight:c}=n.viewState,{x:u,y:h}=e,m=h-i;if(m<0)return 0;if(m>c)return n.state.doc.length;for(let D=n.viewState.heightOracle.textHeight/2,F=!1;l=n.elementAtHeight(m),l.type!=Dr.Text;)for(;m=s>0?l.bottom+D:l.top-D,!(m>=0&&m<=c);){if(F)return t?null:0;F=!0,s=-s}h=i+m;let f=l.from;if(f<n.viewport.from)return n.viewport.from==0?0:t?null:U4(n,o,l,u,h);if(f>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:U4(n,o,l,u,h);let v=n.dom.ownerDocument,O=n.root.elementFromPoint?n.root:v,k=O.elementFromPoint(u,h);k&&!n.contentDOM.contains(k)&&(k=null),k||(u=Math.max(o.left+1,Math.min(o.right-1,u)),k=O.elementFromPoint(u,h),k&&!n.contentDOM.contains(k)&&(k=null));let M,E=-1;if(k&&((a=n.docView.nearest(k))===null||a===void 0?void 0:a.isEditable)!=!1){if(v.caretPositionFromPoint){let D=v.caretPositionFromPoint(u,h);D&&({offsetNode:M,offset:E}=D)}else if(v.caretRangeFromPoint){let D=v.caretRangeFromPoint(u,h);D&&({startContainer:M,startOffset:E}=D,(!n.contentDOM.contains(M)||Bt.safari&&R2e(M,E,u)||Bt.chrome&&_2e(M,E,u))&&(M=void 0))}M&&(E=Math.min(Xl(M),E))}if(!M||!n.docView.dom.contains(M)){let D=pa.find(n.docView,f);if(!D)return m>l.top+l.height/2?l.to:l.from;({node:M,offset:E}=$S(D.dom,u,h))}let I=n.docView.nearest(M);if(!I)return null;if(I.isWidget&&((r=I.dom)===null||r===void 0?void 0:r.nodeType)==1){let D=I.dom.getBoundingClientRect();return e.y<D.top||e.y<=D.bottom&&e.x<=(D.left+D.right)/2?I.posAtStart:I.posAtEnd}else return I.localPosFromDOM(M,E)+I.posAtStart}function U4(n,e,t,s,a){let r=Math.round((s-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let i=n.viewState.heightOracle.textHeight,l=Math.floor((a-t.top-(n.defaultLineHeight-i)*.5)/i);r+=l*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+OS(o,r,n.state.tabSize)}function R2e(n,e,t){let s;if(n.nodeType!=3||e!=(s=n.nodeValue.length))return!1;for(let a=n.nextSibling;a;a=a.nextSibling)if(a.nodeType!=1||a.nodeName!="BR")return!1;return zh(n,s-1,s).getBoundingClientRect().left>t}function _2e(n,e,t){if(e!=0)return!1;for(let a=n;;){let r=a.parentNode;if(!r||r.nodeType!=1||r.firstChild!=a)return!1;if(r.classList.contains("cm-line"))break;a=r}let s=n.nodeType==1?n.getBoundingClientRect():zh(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-s.left>5}function RS(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let s of t.type)if(s.to>e||s.to==e&&(s.to==t.to||s.type==Dr.Text))return s}return t}function L2e(n,e,t,s){let a=RS(n,e.head),r=!s||a.type!=Dr.Text||!(n.lineWrapping||a.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>a.from?e.head-1:e.head);if(r){let o=n.dom.getBoundingClientRect(),i=n.textDirectionAt(a.from),l=n.posAtCoords({x:t==(i==Ds.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(l!=null)return Ze.cursor(l,t?-1:1)}return Ze.cursor(t?a.to:a.from,t?-1:1)}function H4(n,e,t,s){let a=n.state.doc.lineAt(e.head),r=n.bidiSpans(a),o=n.textDirectionAt(a.from);for(let i=e,l=null;;){let c=k2e(a,r,o,i,t),u=pq;if(!c){if(a.number==(t?n.state.doc.lines:1))return i;u=`
`,a=n.state.doc.line(a.number+(t?1:-1)),r=n.bidiSpans(a),c=n.visualLineSide(a,!t)}if(l){if(!l(u))return i}else{if(!s)return c;l=s(u)}i=c}}function I2e(n,e,t){let s=n.state.charCategorizer(e),a=s(t);return r=>{let o=s(r);return a==wa.Space&&(a=o),a==o}}function Q2e(n,e,t,s){let a=e.head,r=t?1:-1;if(a==(t?n.state.doc.length:0))return Ze.cursor(a,e.assoc);let o=e.goalColumn,i,l=n.contentDOM.getBoundingClientRect(),c=n.coordsAtPos(a,e.assoc||-1),u=n.documentTop;if(c)o==null&&(o=c.left-l.left),i=r<0?c.top:c.bottom;else{let f=n.viewState.lineBlockAt(a);o==null&&(o=Math.min(l.right-l.left,n.defaultCharacterWidth*(a-f.from))),i=(r<0?f.top:f.bottom)+u}let h=l.left+o,m=s??n.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let v=i+(m+f)*r,O=Dq(n,{x:h,y:v},!1,r);if(v<l.top||v>l.bottom||(r<0?O<a:O>a)){let k=n.docView.coordsForChar(O),M=!k||v<k.top?-1:1;return Ze.cursor(O,M,void 0,o)}}}function o1(n,e,t){for(;;){let s=0;for(let a of n)a.between(e-1,e+1,(r,o,i)=>{if(e>r&&e<o){let l=s||t||(e-r<o-e?-1:1);e=l<0?r:o,s=l}});if(!s)return e}}function ok(n,e,t){let s=o1(n.state.facet(k3).map(a=>a(n)),t.from,e.head>t.from?-1:1);return s==t.from?t:Ze.cursor(s,s<t.from?1:-1)}const af="￿";class V2e{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(as.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=af}readRange(e,t){if(!e)return this;let s=e.parentNode;for(let a=e;;){this.findPointBefore(s,a);let r=this.text.length;this.readNode(a);let o=a.nextSibling;if(o==t)break;let i=As.get(a),l=As.get(o);(i&&l?i.breakAfter:(i?i.breakAfter:Ry(a))||Ry(o)&&(a.nodeName!="BR"||a.cmIgnore)&&this.text.length>r)&&this.lineBreak(),a=o}return this.findPointBefore(s,t),this}readTextNode(e){let t=e.nodeValue;for(let s of this.points)s.node==e&&(s.pos=this.text.length+Math.min(s.offset,t.length));for(let s=0,a=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,i;if(this.lineSeparator?(r=t.indexOf(this.lineSeparator,s),o=this.lineSeparator.length):(i=a.exec(t))&&(r=i.index,o=i[0].length),this.append(t.slice(s,r<0?t.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);s=r+o}}readNode(e){if(e.cmIgnore)return;let t=As.get(e),s=t&&t.overrideDOMText;if(s!=null){this.findPointInside(e,s.length);for(let a=s.iter();!a.next().done;)a.lineBreak?this.lineBreak():this.append(a.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let s of this.points)s.node==e&&e.childNodes[s.offset]==t&&(s.pos=this.text.length)}findPointInside(e,t){for(let s of this.points)(e.nodeType==3?s.node==e:e.contains(s.node))&&(s.pos=this.text.length+(j2e(e,s.node,s.offset)?t:0))}}function j2e(n,e,t){for(;;){if(!e||t<Xl(e))return!1;if(e==n)return!0;t=Zh(e)+1,e=e.parentNode}}class Y4{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Z2e{constructor(e,t,s,a){this.typeOver=a,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:r,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,s,0))){let i=r||o?[]:X2e(e),l=new V2e(i,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=W2e(i,this.bounds.from)}else{let i=e.observer.selectionRange,l=r&&r.node==i.focusNode&&r.offset==i.focusOffset||!PS(e.contentDOM,i.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(i.focusNode,i.focusOffset),c=o&&o.node==i.anchorNode&&o.offset==i.anchorOffset||!PS(e.contentDOM,i.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(i.anchorNode,i.anchorOffset),u=e.viewport;if((Bt.ios||Bt.chrome)&&e.state.selection.main.empty&&l!=c&&(u.from>0||u.to<e.state.doc.length)){let h=Math.min(l,c),m=Math.max(l,c),f=u.from-h,v=u.to-m;(f==0||f==1||h==0)&&(v==0||v==-1||m==e.state.doc.length)&&(l=0,c=e.state.doc.length)}this.newSel=Ze.single(c,l)}}}function Tq(n,e){let t,{newSel:s}=e,a=n.state.selection.main,r=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:i}=e.bounds,l=a.from,c=null;(r===8||Bt.android&&e.text.length<i-o)&&(l=a.to,c="end");let u=G2e(n.state.doc.sliceString(o,i,af),e.text,l-o,c);u&&(Bt.chrome&&r==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==af+af&&u.toB--,t={from:o+u.from,to:o+u.toA,insert:os.of(e.text.slice(u.from,u.toB).split(af))})}else s&&(!n.hasFocus&&n.state.facet(xc)||s.main.eq(a))&&(s=null);if(!t&&!s)return!1;if(!t&&e.typeOver&&!a.empty&&s&&s.main.empty?t={from:a.from,to:a.to,insert:n.state.doc.slice(a.from,a.to)}:(Bt.mac||Bt.android)&&t&&t.from==t.to&&t.from==a.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(s&&t.insert.length==2&&(s=Ze.single(s.main.anchor-1,s.main.head-1)),t={from:t.from,to:t.to,insert:os.of([t.insert.toString().replace("."," ")])}):t&&t.from>=a.from&&t.to<=a.to&&(t.from!=a.from||t.to!=a.to)&&a.to-a.from-(t.to-t.from)<=4?t={from:a.from,to:a.to,insert:n.state.doc.slice(a.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,a.to))}:Bt.chrome&&t&&t.from==t.to&&t.from==a.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(s&&(s=Ze.single(s.main.anchor-1,s.main.head-1)),t={from:a.from,to:a.to,insert:os.of([" "])}),t)return S3(n,t,s,r);if(s&&!s.main.eq(a)){let o=!1,i="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),i=n.inputState.lastSelectionOrigin),n.dispatch({selection:s,scrollIntoView:o,userEvent:i}),!0}else return!1}function S3(n,e,t,s=-1){if(Bt.ios&&n.inputState.flushIOSKey(e))return!0;let a=n.state.selection.main;if(Bt.android&&(e.to==a.to&&(e.from==a.from||e.from==a.from-1&&n.state.sliceDoc(e.from,a.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Gd(n.contentDOM,"Enter",13)||(e.from==a.from-1&&e.to==a.to&&e.insert.length==0||s==8&&e.insert.length<e.to-e.from&&e.to>a.head)&&Gd(n.contentDOM,"Backspace",8)||e.from==a.from&&e.to==a.to+1&&e.insert.length==0&&Gd(n.contentDOM,"Delete",46)))return!0;let r=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,i=()=>o||(o=z2e(n,e,t));return n.state.facet(vq).some(l=>l(n,e.from,e.to,r,i))||n.dispatch(i()),!0}function z2e(n,e,t){let s,a=n.state,r=a.selection.main;if(e.from>=r.from&&e.to<=r.to&&e.to-e.from>=(r.to-r.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let i=r.from<e.from?a.sliceDoc(r.from,e.from):"",l=r.to>e.to?a.sliceDoc(e.to,r.to):"";s=a.replaceSelection(n.state.toText(i+e.insert.sliceString(0,void 0,n.state.lineBreak)+l))}else{let i=a.changes(e),l=t&&t.main.to<=i.newLength?t.main:void 0;if(a.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=r.to&&e.to>=r.to-10){let c=n.state.sliceDoc(e.from,e.to),u,h=t&&Eq(n,t.main.head);if(h){let v=e.insert.length-(e.to-e.from);u={from:h.from,to:h.to-v}}else u=n.state.doc.lineAt(r.head);let m=r.to-e.to,f=r.to-r.from;s=a.changeByRange(v=>{if(v.from==r.from&&v.to==r.to)return{changes:i,range:l||v.map(i)};let O=v.to-m,k=O-c.length;if(v.to-v.from!=f||n.state.sliceDoc(k,O)!=c||v.to>=u.from&&v.from<=u.to)return{range:v};let M=a.changes({from:k,to:O,insert:e.insert}),E=v.to-r.to;return{changes:M,range:l?Ze.range(Math.max(0,l.anchor+E),Math.max(0,l.head+E)):v.map(M)}})}else s={changes:i,selection:l&&a.selection.replaceRange(l)}}let o="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,o+=".compose",n.inputState.compositionFirstChange&&(o+=".start",n.inputState.compositionFirstChange=!1)),a.update(s,{userEvent:o,scrollIntoView:!0})}function G2e(n,e,t,s){let a=Math.min(n.length,e.length),r=0;for(;r<a&&n.charCodeAt(r)==e.charCodeAt(r);)r++;if(r==a&&n.length==e.length)return null;let o=n.length,i=e.length;for(;o>0&&i>0&&n.charCodeAt(o-1)==e.charCodeAt(i-1);)o--,i--;if(s=="end"){let l=Math.max(0,r-Math.min(o,i));t-=o+l-r}if(o<r&&n.length<e.length){let l=t<=r&&t>=o?r-t:0;r-=l,i=r+(i-o),o=r}else if(i<r){let l=t<=r&&t>=i?r-t:0;r-=l,o=r+(o-i),i=r}return{from:r,toA:o,toB:i}}function X2e(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:s,focusNode:a,focusOffset:r}=n.observer.selectionRange;return t&&(e.push(new Y4(t,s)),(a!=t||r!=s)&&e.push(new Y4(a,r))),e}function W2e(n,e){if(n.length==0)return null;let t=n[0].pos,s=n.length==2?n[1].pos:t;return t>-1&&s>-1?Ze.single(t+e,s+e):null}class q2e{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Bt.safari&&e.contentDOM.addEventListener("input",()=>null),Bt.gecko&&uSe(e.contentDOM.ownerDocument)}handleEvent(e){!nSe(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let s=this.handlers[e];if(s){for(let a of s.observers)a(this.view,t);for(let a of s.handlers){if(t.defaultPrevented)break;if(a(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=U2e(e),s=this.handlers,a=this.view.contentDOM;for(let r in t)if(r!="scroll"){let o=!t[r].handlers.length,i=s[r];i&&o!=!i.handlers.length&&(a.removeEventListener(r,this.handleEvent),i=null),i||a.addEventListener(r,this.handleEvent,{passive:o})}for(let r in s)r!="scroll"&&!t[r]&&a.removeEventListener(r,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&Nq.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Bt.android&&Bt.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return Bt.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=Fq.find(s=>s.keyCode==e.keyCode))&&!e.ctrlKey||H2e.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Gd(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Bt.safari&&!Bt.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function K4(n,e){return(t,s)=>{try{return e.call(n,s,t)}catch(a){co(t.state,a)}}}function U2e(n){let e=Object.create(null);function t(s){return e[s]||(e[s]={observers:[],handlers:[]})}for(let s of n){let a=s.spec;if(a&&a.domEventHandlers)for(let r in a.domEventHandlers){let o=a.domEventHandlers[r];o&&t(r).handlers.push(K4(s.value,o))}if(a&&a.domEventObservers)for(let r in a.domEventObservers){let o=a.domEventObservers[r];o&&t(r).observers.push(K4(s.value,o))}}for(let s in sl)t(s).handlers.push(sl[s]);for(let s in wi)t(s).observers.push(wi[s]);return e}const Fq=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],H2e="dthko",Nq=[16,17,18,20,91,92,224,225],tb=6;function nb(n){return Math.max(0,n)*.7+8}function Y2e(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class K2e{constructor(e,t,s,a){this.view=e,this.startEvent=t,this.style=s,this.mustSelect=a,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=i2e(e.contentDOM),this.atoms=e.state.facet(k3).map(o=>o(e));let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(as.allowMultipleSelections)&&J2e(e,t),this.dragging=tSe(e,t)&&Rq(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Y2e(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,s=0,a=0,r=0,o=this.view.win.innerWidth,i=this.view.win.innerHeight;this.scrollParents.x&&({left:a,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:i}=this.scrollParents.y.getBoundingClientRect());let l=P3(this.view);e.clientX-l.left<=a+tb?t=-nb(a-e.clientX):e.clientX+l.right>=o-tb&&(t=nb(e.clientX-o)),e.clientY-l.top<=r+tb?s=-nb(r-e.clientY):e.clientY+l.bottom>=i-tb&&(s=nb(e.clientY-i)),this.setScrollSpeed(t,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let s=0;s<e.ranges.length;s++){let a=e.ranges[s],r=null;if(a.empty){let o=o1(this.atoms,a.from,0);o!=a.from&&(r=Ze.cursor(o,-1))}else{let o=o1(this.atoms,a.from,-1),i=o1(this.atoms,a.to,1);(o!=a.from||i!=a.to)&&(r=Ze.range(a.from==a.anchor?o:i,a.from==a.head?o:i))}r&&(t||(t=e.ranges.slice()),t[s]=r)}return t?Ze.create(t,e.mainIndex):e}select(e){let{view:t}=this,s=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!s.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:s,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function J2e(n,e){let t=n.state.facet(fq);return t.length?t[0](e):Bt.mac?e.metaKey:e.ctrlKey}function eSe(n,e){let t=n.state.facet(gq);return t.length?t[0](e):Bt.mac?!e.altKey:!e.ctrlKey}function tSe(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let s=mg(n.root);if(!s||s.rangeCount==0)return!0;let a=s.getRangeAt(0).getClientRects();for(let r=0;r<a.length;r++){let o=a[r];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function nSe(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,s;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(s=As.get(t))&&s.ignoreEvent(e))return!1;return!0}const sl=Object.create(null),wi=Object.create(null),Bq=Bt.ie&&Bt.ie_version<15||Bt.ios&&Bt.webkit_version<604;function sSe(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),$q(n,t.value)},50)}function Tw(n,e,t){for(let s of n.facet(e))t=s(t,n);return t}function $q(n,e){e=Tw(n.state,w3,e);let{state:t}=n,s,a=1,r=t.toText(e),o=r.lines==t.selection.ranges.length;if(_S!=null&&t.selection.ranges.every(i=>i.empty)&&_S==r.toString()){let i=-1;s=t.changeByRange(l=>{let c=t.doc.lineAt(l.from);if(c.from==i)return{range:l};i=c.from;let u=t.toText((o?r.line(a++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:u},range:Ze.cursor(l.from+u.length)}})}else o?s=t.changeByRange(i=>{let l=r.line(a++);return{changes:{from:i.from,to:i.to,insert:l.text},range:Ze.cursor(i.from+l.length)}}):s=t.replaceSelection(r);n.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}wi.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};sl.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);wi.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};wi.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};sl.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let s of n.state.facet(bq))if(t=s(n,e),t)break;if(!t&&e.button==0&&(t=oSe(n,e)),t){let s=!n.hasFocus;n.inputState.startMouseSelection(new K2e(n,e,t,s)),s&&n.observer.ignore(()=>{HW(n.contentDOM);let r=n.root.activeElement;r&&!r.contains(n.contentDOM)&&r.blur()});let a=n.inputState.mouseSelection;if(a)return a.start(e),a.dragging===!1}return!1};function J4(n,e,t,s){if(s==1)return Ze.cursor(e,t);if(s==2)return N2e(n.state,e,t);{let a=pa.find(n.docView,e),r=n.state.doc.lineAt(a?a.posAtEnd:e),o=a?a.posAtStart:r.from,i=a?a.posAtEnd:r.to;return i<n.state.doc.length&&i==r.to&&i++,Ze.range(o,i)}}let eT=(n,e,t)=>e>=t.top&&e<=t.bottom&&n>=t.left&&n<=t.right;function aSe(n,e,t,s){let a=pa.find(n.docView,e);if(!a)return 1;let r=e-a.posAtStart;if(r==0)return 1;if(r==a.length)return-1;let o=a.coordsAt(r,-1);if(o&&eT(t,s,o))return-1;let i=a.coordsAt(r,1);return i&&eT(t,s,i)?1:o&&o.bottom>=s?-1:1}function tT(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:aSe(n,t,e.clientX,e.clientY)}}const rSe=Bt.ie&&Bt.ie_version<=11;let nT=null,sT=0,aT=0;function Rq(n){if(!rSe)return n.detail;let e=nT,t=aT;return nT=n,aT=Date.now(),sT=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(sT+1)%3:1}function oSe(n,e){let t=tT(n,e),s=Rq(e),a=n.state.selection;return{update(r){r.docChanged&&(t.pos=r.changes.mapPos(t.pos),a=a.map(r.changes))},get(r,o,i){let l=tT(n,r),c,u=J4(n,l.pos,l.bias,s);if(t.pos!=l.pos&&!o){let h=J4(n,t.pos,t.bias,s),m=Math.min(h.from,u.from),f=Math.max(h.to,u.to);u=m<u.from?Ze.range(m,f):Ze.range(f,m)}return o?a.replaceRange(a.main.extend(u.from,u.to)):i&&s==1&&a.ranges.length>1&&(c=iSe(a,l.pos))?c:i?a.addRange(u):Ze.create([u])}}}function iSe(n,e){for(let t=0;t<n.ranges.length;t++){let{from:s,to:a}=n.ranges[t];if(s<=e&&a>=e)return Ze.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}sl.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let a=n.docView.nearest(e.target);if(a&&a.isWidget){let r=a.posAtStart,o=r+a.length;(r>=t.to||o<=t.from)&&(t=Ze.range(r,o))}}let{inputState:s}=n;return s.mouseSelection&&(s.mouseSelection.dragging=!0),s.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Tw(n.state,O3,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};sl.dragend=n=>(n.inputState.draggedContent=null,!1);function rT(n,e,t,s){if(t=Tw(n.state,w3,t),!t)return;let a=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:r}=n.inputState,o=s&&r&&eSe(n,e)?{from:r.from,to:r.to}:null,i={from:a,insert:t},l=n.state.changes(o?[o,i]:i);n.focus(),n.dispatch({changes:l,selection:{anchor:l.mapPos(a,-1),head:l.mapPos(a,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}sl.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let s=Array(t.length),a=0,r=()=>{++a==t.length&&rT(n,e,s.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let i=new FileReader;i.onerror=r,i.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(i.result)||(s[o]=i.result),r()},i.readAsText(t[o])}return!0}else{let s=e.dataTransfer.getData("Text");if(s)return rT(n,e,s,!0),!0}return!1};sl.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=Bq?null:e.clipboardData;return t?($q(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(sSe(n),!1)};function lSe(n,e){let t=n.dom.parentNode;if(!t)return;let s=t.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=e,s.focus(),s.selectionEnd=e.length,s.selectionStart=0,setTimeout(()=>{s.remove(),n.focus()},50)}function cSe(n){let e=[],t=[],s=!1;for(let a of n.selection.ranges)a.empty||(e.push(n.sliceDoc(a.from,a.to)),t.push(a));if(!e.length){let a=-1;for(let{from:r}of n.selection.ranges){let o=n.doc.lineAt(r);o.number>a&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),a=o.number}s=!0}return{text:Tw(n,O3,e.join(n.lineBreak)),ranges:t,linewise:s}}let _S=null;sl.copy=sl.cut=(n,e)=>{let{text:t,ranges:s,linewise:a}=cSe(n.state);if(!t&&!a)return!1;_S=a?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let r=Bq?null:e.clipboardData;return r?(r.clearData(),r.setData("text/plain",t),!0):(lSe(n,t),!1)};const _q=zc.define();function Lq(n,e){let t=[];for(let s of n.facet(wq)){let a=s(n,e);a&&t.push(a)}return t?n.update({effects:t,annotations:_q.of(!0)}):null}function Iq(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=Lq(n.state,e);t?n.dispatch(t):n.update([])}},10)}wi.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),Iq(n)};wi.blur=n=>{n.observer.clearSelectionRange(),Iq(n)};wi.compositionstart=wi.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};wi.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Bt.chrome&&Bt.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};wi.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};sl.beforeinput=(n,e)=>{var t,s;if(e.inputType=="insertReplacementText"&&n.observer.editContext){let r=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(r&&o.length){let i=o[0],l=n.posAtDOM(i.startContainer,i.startOffset),c=n.posAtDOM(i.endContainer,i.endOffset);return S3(n,{from:l,to:c,insert:n.state.toText(r)},null),!0}}let a;if(Bt.chrome&&Bt.android&&(a=Fq.find(r=>r.inputType==e.inputType))&&(n.observer.delayAndroidKey(a.key,a.keyCode),a.key=="Backspace"||a.key=="Delete")){let r=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Bt.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),Bt.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>wi.compositionend(n,e),20),!1};const oT=new Set;function uSe(n){oT.has(n)||(oT.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const iT=["pre-wrap","normal","pre-line","break-spaces"];let Om=!1;function lT(){Om=!1}class hSe{constructor(e){this.lineWrapping=e,this.doc=os.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let s=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((t-e-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return iT.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let s=0;s<e.length;s++){let a=e[s];a<0?s++:this.heightSamples[Math.floor(a*10)]||(t=!0,this.heightSamples[Math.floor(a*10)]=!0)}return t}refresh(e,t,s,a,r,o){let i=iT.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=i;if(this.lineWrapping=i,this.lineHeight=t,this.charWidth=s,this.textHeight=a,this.lineLength=r,l){this.heightSamples={};for(let c=0;c<o.length;c++){let u=o[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class dSe{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class El{constructor(e,t,s,a,r){this.from=e,this.length=t,this.top=s,this.height=a,this._content=r}get type(){return typeof this._content=="number"?Dr.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Bu?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new El(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Vs=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(Vs||(Vs={}));const i1=.001;class Tr{constructor(e,t,s=2){this.length=e,this.height=t,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>i1&&(Om=!0),this.height=e)}replace(e,t,s){return Tr.of(s)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,s,a){let r=this,o=s.doc;for(let i=a.length-1;i>=0;i--){let{fromA:l,toA:c,fromB:u,toB:h}=a[i],m=r.lineAt(l,Vs.ByPosNoHeight,s.setDoc(t),0,0),f=m.to>=c?m:r.lineAt(c,Vs.ByPosNoHeight,s,0,0);for(h+=f.to-c,c=f.to;i>0&&m.from<=a[i-1].toA;)l=a[i-1].fromA,u=a[i-1].fromB,i--,l<m.from&&(m=r.lineAt(l,Vs.ByPosNoHeight,s,0,0));u+=m.from-l,l=m.from;let v=C3.build(s.setDoc(o),e,u,h);r=Iy(r,r.replace(l,c,v))}return r.updateHeight(s,0)}static empty(){return new Ro(0,0)}static of(e){if(e.length==1)return e[0];let t=0,s=e.length,a=0,r=0;for(;;)if(t==s)if(a>r*2){let i=e[t-1];i.break?e.splice(--t,1,i.left,null,i.right):e.splice(--t,1,i.left,i.right),s+=1+i.break,a-=i.size}else if(r>a*2){let i=e[s];i.break?e.splice(s,1,i.left,null,i.right):e.splice(s,1,i.left,i.right),s+=2+i.break,r-=i.size}else break;else if(a<r){let i=e[t++];i&&(a+=i.size)}else{let i=e[--s];i&&(r+=i.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,s++),new mSe(Tr.of(e.slice(0,t)),o,Tr.of(e.slice(s)))}}function Iy(n,e){return n==e?n:(n.constructor!=e.constructor&&(Om=!0),e)}Tr.prototype.size=1;class Qq extends Tr{constructor(e,t,s){super(e,t),this.deco=s}blockAt(e,t,s,a){return new El(a,this.length,s,this.height,this.deco||0)}lineAt(e,t,s,a,r){return this.blockAt(0,s,a,r)}forEachLine(e,t,s,a,r,o){e<=r+this.length&&t>=r&&o(this.blockAt(0,s,a,r))}updateHeight(e,t=0,s=!1,a){return a&&a.from<=t&&a.more&&this.setHeight(a.heights[a.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ro extends Qq{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,s,a){return new El(a,this.length,s,this.height,this.breaks)}replace(e,t,s){let a=s[0];return s.length==1&&(a instanceof Ro||a instanceof Wa&&a.flags&4)&&Math.abs(this.length-a.length)<10?(a instanceof Wa?a=new Ro(a.length,this.height):a.height=this.height,this.outdated||(a.outdated=!1),a):Tr.of(s)}updateHeight(e,t=0,s=!1,a){return a&&a.from<=t&&a.more?this.setHeight(a.heights[a.index++]):(s||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Wa extends Tr{constructor(e){super(e,0)}heightMetrics(e,t){let s=e.doc.lineAt(t).number,a=e.doc.lineAt(t+this.length).number,r=a-s+1,o,i=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*r);o=l/r,this.length>r+1&&(i=(this.height-l)/(this.length-r-1))}else o=this.height/r;return{firstLine:s,lastLine:a,perLine:o,perChar:i}}blockAt(e,t,s,a){let{firstLine:r,lastLine:o,perLine:i,perChar:l}=this.heightMetrics(t,a);if(t.lineWrapping){let c=a+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-s)/this.height))*this.length)),u=t.doc.lineAt(c),h=i+u.length*l,m=Math.max(s,e-h/2);return new El(u.from,u.length,m,h,0)}else{let c=Math.max(0,Math.min(o-r,Math.floor((e-s)/i))),{from:u,length:h}=t.doc.line(r+c);return new El(u,h,s+i*c,i,0)}}lineAt(e,t,s,a,r){if(t==Vs.ByHeight)return this.blockAt(e,s,a,r);if(t==Vs.ByPosNoHeight){let{from:f,to:v}=s.doc.lineAt(e);return new El(f,v-f,0,0,0)}let{firstLine:o,perLine:i,perChar:l}=this.heightMetrics(s,r),c=s.doc.lineAt(e),u=i+c.length*l,h=c.number-o,m=a+i*h+l*(c.from-r-h);return new El(c.from,c.length,Math.max(a,Math.min(m,a+this.height-u)),u,0)}forEachLine(e,t,s,a,r,o){e=Math.max(e,r),t=Math.min(t,r+this.length);let{firstLine:i,perLine:l,perChar:c}=this.heightMetrics(s,r);for(let u=e,h=a;u<=t;){let m=s.doc.lineAt(u);if(u==e){let v=m.number-i;h+=l*v+c*(e-r-v)}let f=l+c*m.length;o(new El(m.from,m.length,h,f,0)),h+=f,u=m.to+1}}replace(e,t,s){let a=this.length-t;if(a>0){let r=s[s.length-1];r instanceof Wa?s[s.length-1]=new Wa(r.length+a):s.push(null,new Wa(a-1))}if(e>0){let r=s[0];r instanceof Wa?s[0]=new Wa(e+r.length):s.unshift(new Wa(e-1),null)}return Tr.of(s)}decomposeLeft(e,t){t.push(new Wa(e-1),null)}decomposeRight(e,t){t.push(null,new Wa(this.length-e-1))}updateHeight(e,t=0,s=!1,a){let r=t+this.length;if(a&&a.from<=t+this.length&&a.more){let o=[],i=Math.max(t,a.from),l=-1;for(a.from>t&&o.push(new Wa(a.from-t-1).updateHeight(e,t));i<=r&&a.more;){let u=e.doc.lineAt(i).length;o.length&&o.push(null);let h=a.heights[a.index++];l==-1?l=h:Math.abs(h-l)>=i1&&(l=-2);let m=new Ro(u,h);m.outdated=!1,o.push(m),i+=u+1}i<=r&&o.push(null,new Wa(r-i).updateHeight(e,i));let c=Tr.of(o);return(l<0||Math.abs(c.height-this.height)>=i1||Math.abs(l-this.heightMetrics(e,t).perLine)>=i1)&&(Om=!0),Iy(this,c)}else(s||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class mSe extends Tr{constructor(e,t,s){super(e.length+t+s.length,e.height+s.height,t|(e.outdated||s.outdated?2:0)),this.left=e,this.right=s,this.size=e.size+s.size}get break(){return this.flags&1}blockAt(e,t,s,a){let r=s+this.left.height;return e<r?this.left.blockAt(e,t,s,a):this.right.blockAt(e,t,r,a+this.left.length+this.break)}lineAt(e,t,s,a,r){let o=a+this.left.height,i=r+this.left.length+this.break,l=t==Vs.ByHeight?e<o:e<i,c=l?this.left.lineAt(e,t,s,a,r):this.right.lineAt(e,t,s,o,i);if(this.break||(l?c.to<i:c.from>i))return c;let u=t==Vs.ByPosNoHeight?Vs.ByPosNoHeight:Vs.ByPos;return l?c.join(this.right.lineAt(i,u,s,o,i)):this.left.lineAt(i,u,s,a,r).join(c)}forEachLine(e,t,s,a,r,o){let i=a+this.left.height,l=r+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,s,a,r,o),t>=l&&this.right.forEachLine(e,t,s,i,l,o);else{let c=this.lineAt(l,Vs.ByPos,s,a,r);e<c.from&&this.left.forEachLine(e,c.from-1,s,a,r,o),c.to>=e&&c.from<=t&&o(c),t>c.to&&this.right.forEachLine(c.to+1,t,s,i,l,o)}}replace(e,t,s){let a=this.left.length+this.break;if(t<a)return this.balanced(this.left.replace(e,t,s),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-a,t-a,s));let r=[];e>0&&this.decomposeLeft(e,r);let o=r.length;for(let i of s)r.push(i);if(e>0&&cT(r,o-1),t<this.length){let i=r.length;this.decomposeRight(t,r),cT(r,i)}return Tr.of(r)}decomposeLeft(e,t){let s=this.left.length;if(e<=s)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(s++,e>=s&&t.push(null)),e>s&&this.right.decomposeLeft(e-s,t)}decomposeRight(e,t){let s=this.left.length,a=s+this.break;if(e>=a)return this.right.decomposeRight(e-a,t);e<s&&this.left.decomposeRight(e,t),this.break&&e<a&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Tr.of(this.break?[e,null,t]:[e,t]):(this.left=Iy(this.left,e),this.right=Iy(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,s=!1,a){let{left:r,right:o}=this,i=t+r.length+this.break,l=null;return a&&a.from<=t+r.length&&a.more?l=r=r.updateHeight(e,t,s,a):r.updateHeight(e,t,s),a&&a.from<=i+o.length&&a.more?l=o=o.updateHeight(e,i,s,a):o.updateHeight(e,i,s),l?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function cT(n,e){let t,s;n[e]==null&&(t=n[e-1])instanceof Wa&&(s=n[e+1])instanceof Wa&&n.splice(e-1,3,new Wa(t.length+1+s.length))}const pSe=5;class C3{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let s=Math.min(t,this.lineEnd),a=this.nodes[this.nodes.length-1];a instanceof Ro?a.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new Ro(s-this.pos,-1)),this.writtenTo=s,t>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,s){if(e<t||s.heightRelevant){let a=s.widget?s.widget.estimatedHeight:0,r=s.widget?s.widget.lineBreaks:0;a<0&&(a=this.oracle.lineHeight);let o=t-e;s.block?this.addBlock(new Qq(o,a,s)):(o||r||a>=pSe)&&this.addLineDeco(a,r,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ro(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let s=new Wa(t-e);return this.oracle.doc.lineAt(e).to==t&&(s.flags|=4),s}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ro)return e;let t=new Ro(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,s){let a=this.ensureLine();a.length+=s,a.collapsed+=s,a.widgetHeight=Math.max(a.widgetHeight,e),a.breaks+=t,this.writtenTo=this.pos=this.pos+s}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Ro)&&!this.isCovered?this.nodes.push(new Ro(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=e;for(let a of this.nodes)a instanceof Ro&&a.updateHeight(this.oracle,s),s+=a?a.length:1;return this.nodes}static build(e,t,s,a){let r=new C3(s,e);return hs.spans(t,s,a,r,0),r.finish(s)}}function fSe(n,e,t){let s=new gSe;return hs.compare(n,e,t,s,0),s.changes}class gSe{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,s,a){(e<t||s&&s.heightRelevant||a&&a.heightRelevant)&&r1(e,t,this.changes,5)}}function bSe(n,e){let t=n.getBoundingClientRect(),s=n.ownerDocument,a=s.defaultView||window,r=Math.max(0,t.left),o=Math.min(a.innerWidth,t.right),i=Math.max(0,t.top),l=Math.min(a.innerHeight,t.bottom);for(let c=n.parentNode;c&&c!=s.body;)if(c.nodeType==1){let u=c,h=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&h.overflow!="visible"){let m=u.getBoundingClientRect();r=Math.max(r,m.left),o=Math.min(o,m.right),i=Math.max(i,m.top),l=Math.min(c==n.parentNode?a.innerHeight:l,m.bottom)}c=h.position=="absolute"||h.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:r-t.left,right:Math.max(r,o)-t.left,top:i-(t.top+e),bottom:Math.max(i,l)-(t.top+e)}}function ySe(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function vSe(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class ik{constructor(e,t,s,a){this.from=e,this.to=t,this.size=s,this.displaySize=a}static same(e,t){if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++){let a=e[s],r=t[s];if(a.from!=r.from||a.to!=r.to||a.size!=r.size)return!1}return!0}draw(e,t){return en.replace({widget:new wSe(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class wSe extends cl{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class uT{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=hT,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ds.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(x3).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new hSe(t),this.stateDeco=e.facet(fg).filter(s=>typeof s!="function"),this.heightMap=Tr.empty().applyChanges(this.stateDeco,os.empty,this.heightOracle.setDoc(e.doc),[new bi(0,0,0,e.doc.length)]);for(let s=0;s<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());s++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=en.set(this.lineGaps.map(s=>s.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let s=0;s<=1;s++){let a=s?t.head:t.anchor;if(!e.some(({from:r,to:o})=>a>=r&&a<=o)){let{from:r,to:o}=this.lineBlockAt(a);e.push(new sb(r,o))}}return this.viewports=e.sort((s,a)=>s.from-a.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?hT:new M3(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(rf(e,this.scaler))})}update(e,t=null){this.state=e.state;let s=this.stateDeco;this.stateDeco=this.state.facet(fg).filter(u=>typeof u!="function");let a=e.changedRanges,r=bi.extendWithRanges(a,fSe(s,this.stateDeco,e?e.changes:Pa.empty(this.state.doc.length))),o=this.heightMap.height,i=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);lT(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=o||Om)&&(e.flags|=2),i?(this.scrollAnchorPos=e.changes.mapPos(i.from,-1),this.scrollAnchorHeight=i.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(xq)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,s=window.getComputedStyle(t),a=this.heightOracle,r=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?Ds.RTL:Ds.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),i=t.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=i.height;this.contentDOMHeight=i.height,this.mustMeasureContent=!1;let c=0,u=0;if(i.width&&i.height){let{scaleX:D,scaleY:F}=UW(t,i);(D>.005&&Math.abs(this.scaleX-D)>.005||F>.005&&Math.abs(this.scaleY-F)>.005)&&(this.scaleX=D,this.scaleY=F,c|=16,o=l=!0)}let h=(parseInt(s.paddingTop)||0)*this.scaleY,m=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=m)&&(this.paddingTop=h,this.paddingBottom=m,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(a.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let f=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=f&&(this.scrollAnchorHeight=-1,this.scrollTop=f),this.scrolledToBottom=KW(e.scrollDOM);let v=(this.printing?vSe:bSe)(t,this.paddingTop),O=v.top-this.pixelViewport.top,k=v.bottom-this.pixelViewport.bottom;this.pixelViewport=v;let M=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(M!=this.inView&&(this.inView=M,M&&(l=!0)),!this.inView&&!this.scrollTarget&&!ySe(e.dom))return 0;let E=i.width;if((this.contentDOMWidth!=E||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=i.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let D=e.docView.measureVisibleLineHeights(this.viewport);if(a.mustRefreshForHeights(D)&&(o=!0),o||a.lineWrapping&&Math.abs(E-this.contentDOMWidth)>a.charWidth){let{lineHeight:F,charWidth:_,textHeight:$}=e.docView.measureTextSize();o=F>0&&a.refresh(r,F,_,$,E/_,D),o&&(e.docView.minWidth=0,c|=16)}O>0&&k>0?u=Math.max(O,k):O<0&&k<0&&(u=Math.min(O,k)),lT();for(let F of this.viewports){let _=F.from==this.viewport.from?D:e.docView.measureVisibleLineHeights(F);this.heightMap=(o?Tr.empty().applyChanges(this.stateDeco,os.empty,this.heightOracle,[new bi(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(a,0,o,new dSe(F.from,_))}Om&&(c|=2)}let I=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return I&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||I)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let s=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),a=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:i}=this,l=new sb(a.lineAt(o-s*1e3,Vs.ByHeight,r,0,0).from,a.lineAt(i+(1-s)*1e3,Vs.ByHeight,r,0,0).to);if(t){let{head:c}=t.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=a.lineAt(c,Vs.ByPos,r,0,0),m;t.y=="center"?m=(h.top+h.bottom)/2-u/2:t.y=="start"||t.y=="nearest"&&c<l.from?m=h.top:m=h.bottom-u,l=new sb(a.lineAt(m-1e3/2,Vs.ByHeight,r,0,0).from,a.lineAt(m+u+1e3/2,Vs.ByHeight,r,0,0).to)}}return l}mapViewport(e,t){let s=t.mapPos(e.from,-1),a=t.mapPos(e.to,1);return new sb(this.heightMap.lineAt(s,Vs.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(a,Vs.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},s=0){if(!this.inView)return!0;let{top:a}=this.heightMap.lineAt(e,Vs.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(t,Vs.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:i}=this;return(e==0||a<=o-Math.max(10,Math.min(-s,250)))&&(t==this.state.doc.length||r>=i+Math.max(10,Math.min(s,250)))&&a>o-2*1e3&&r<i+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let s=[];for(let a of e)t.touchesRange(a.from,a.to)||s.push(new ik(t.mapPos(a.from),t.mapPos(a.to),a.size,a.displaySize));return s}ensureLineGaps(e,t){let s=this.heightOracle.lineWrapping,a=s?1e4:2e3,r=a>>1,o=a<<1;if(this.defaultTextDirection!=Ds.LTR&&!s)return[];let i=[],l=(u,h,m,f)=>{if(h-u<r)return;let v=this.state.selection.main,O=[v.from];v.empty||O.push(v.to);for(let M of O)if(M>u&&M<h){l(u,M-10,m,f),l(M+10,h,m,f);return}let k=xSe(e,M=>M.from>=m.from&&M.to<=m.to&&Math.abs(M.from-u)<r&&Math.abs(M.to-h)<r&&!O.some(E=>M.from<E&&M.to>E));if(!k){if(h<m.to&&t&&s&&t.visibleRanges.some(I=>I.from<=h&&I.to>=h)){let I=t.moveToLineBoundary(Ze.cursor(h),!1,!0).head;I>u&&(h=I)}let M=this.gapSize(m,u,h,f),E=s||M<2e6?M:2e6;k=new ik(u,h,M,E)}i.push(k)},c=u=>{if(u.length<o||u.type!=Dr.Text)return;let h=OSe(u.from,u.to,this.stateDeco);if(h.total<o)return;let m=this.scrollTarget?this.scrollTarget.range.head:null,f,v;if(s){let O=a/this.heightOracle.lineLength*this.heightOracle.lineHeight,k,M;if(m!=null){let E=rb(h,m),I=((this.visibleBottom-this.visibleTop)/2+O)/u.height;k=E-I,M=E+I}else k=(this.visibleTop-u.top-O)/u.height,M=(this.visibleBottom-u.top+O)/u.height;f=ab(h,k),v=ab(h,M)}else{let O=h.total*this.heightOracle.charWidth,k=a*this.heightOracle.charWidth,M=0;if(O>2e6)for(let _ of e)_.from>=u.from&&_.from<u.to&&_.size!=_.displaySize&&_.from*this.heightOracle.charWidth+M<this.pixelViewport.left&&(M=_.size-_.displaySize);let E=this.pixelViewport.left+M,I=this.pixelViewport.right+M,D,F;if(m!=null){let _=rb(h,m),$=((I-E)/2+k)/O;D=_-$,F=_+$}else D=(E-k)/O,F=(I+k)/O;f=ab(h,D),v=ab(h,F)}f>u.from&&l(u.from,f,u,h),v<u.to&&l(v,u.to,u,h)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return i}gapSize(e,t,s,a){let r=rb(a,s)-rb(a,t);return this.heightOracle.lineWrapping?e.height*r:a.total*this.heightOracle.charWidth*r}updateLineGaps(e){ik.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=en.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let s=[];hs.spans(t,this.viewport.from,this.viewport.to,{span(r,o){s.push({from:r,to:o})},point(){}},20);let a=0;if(s.length!=this.visibleRanges.length)a=12;else for(let r=0;r<s.length&&!(a&8);r++){let o=this.visibleRanges[r],i=s[r];(o.from!=i.from||o.to!=i.to)&&(a|=4,e&&e.mapPos(o.from,-1)==i.from&&e.mapPos(o.to,1)==i.to||(a|=8))}return this.visibleRanges=s,a}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||rf(this.heightMap.lineAt(e,Vs.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||rf(this.heightMap.lineAt(this.scaler.fromDOM(e),Vs.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return rf(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class sb{constructor(e,t){this.from=e,this.to=t}}function OSe(n,e,t){let s=[],a=n,r=0;return hs.spans(t,n,e,{span(){},point(o,i){o>a&&(s.push({from:a,to:o}),r+=o-a),a=i}},20),a<e&&(s.push({from:a,to:e}),r+=e-a),{total:r,ranges:s}}function ab({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let s=Math.floor(n*t);for(let a=0;;a++){let{from:r,to:o}=e[a],i=o-r;if(s<=i)return r+s;s-=i}}function rb(n,e){let t=0;for(let{from:s,to:a}of n.ranges){if(e<=a){t+=e-s;break}t+=a-s}return t/n.total}function xSe(n,e){for(let t of n)if(e(t))return t}const hT={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};class M3{constructor(e,t,s){let a=0,r=0,o=0;this.viewports=s.map(({from:i,to:l})=>{let c=t.lineAt(i,Vs.ByPos,e,0,0).top,u=t.lineAt(l,Vs.ByPos,e,0,0).bottom;return a+=u-c,{from:i,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-a)/(t.height-a);for(let i of this.viewports)i.domTop=o+(i.top-r)*this.scale,o=i.domBottom=i.domTop+(i.bottom-i.top),r=i.bottom}toDOM(e){for(let t=0,s=0,a=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return a+(e-s)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);s=r.bottom,a=r.domBottom}}fromDOM(e){for(let t=0,s=0,a=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return s+(e-a)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);s=r.bottom,a=r.domBottom}}eq(e){return e instanceof M3?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,s)=>t.from==e.viewports[s].from&&t.to==e.viewports[s].to):!1}}function rf(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),s=e.toDOM(n.bottom);return new El(n.from,n.length,t,s-t,Array.isArray(n._content)?n._content.map(a=>rf(a,e)):n._content)}const ob=Qt.define({combine:n=>n.join(" ")}),LS=Qt.define({combine:n=>n.indexOf(!0)>-1}),IS=Fu.newName(),Vq=Fu.newName(),jq=Fu.newName(),Zq={"&light":"."+Vq,"&dark":"."+jq};function QS(n,e,t){return new Fu(e,{finish(s){return/&/.test(s)?s.replace(/&\w*/,a=>{if(a=="&")return n;if(!t||!t[a])throw new RangeError(`Unsupported selector: ${a}`);return t[a]}):n+" "+s}})}const kSe=QS("."+IS,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Zq),PSe={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},lk=Bt.ie&&Bt.ie_version<=11;class SSe{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new l2e,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let s of t)this.queue.push(s);(Bt.ie&&Bt.ie_version<=11||Bt.ios&&e.composing)&&t.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(Bt.chrome&&Bt.chrome_version<126)&&(this.editContext=new MSe(e),e.state.facet(xc)&&(e.contentDOM.editContext=this.editContext.editContext)),lk&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,s)=>t!=e[s]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,a=this.selectionRange;if(s.state.facet(xc)?s.root.activeElement!=this.dom:!a1(this.dom,a))return;let r=a.anchorNode&&s.docView.nearest(a.anchorNode);if(r&&r.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Bt.ie&&Bt.ie_version<=11||Bt.android&&Bt.chrome)&&!s.state.selection.main.empty&&a.focusNode&&Af(a.focusNode,a.focusOffset,a.anchorNode,a.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=mg(e.root);if(!t)return!1;let s=Bt.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&CSe(this.view,t)||t;if(!s||this.selectionRange.eq(s))return!1;let a=a1(this.dom,s);return a&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&u2e(this.dom,s)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(s),a&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let s=this.dom;s;)if(s.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==s?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=t)s.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,PSe),lk&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),lk&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var s;if(!this.delayedAndroidKey){let a=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&Gd(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(a)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,s=-1,a=!1;for(let r of e){let o=this.readMutation(r);o&&(o.typeOver&&(a=!0),t==-1?{from:t,to:s}=o:(t=Math.min(o.from,t),s=Math.max(o.to,s)))}return{from:t,to:s,typeOver:a}}readChange(){let{from:e,to:t,typeOver:s}=this.processRecords(),a=this.selectionChanged&&a1(this.dom,this.selectionRange);if(e<0&&!a)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new Z2e(this.view,e,t,s);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let s=this.view.state,a=Tq(this.view,t);return this.view.state==s&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),a}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let s=dT(t,e.previousSibling||e.target.previousSibling,-1),a=dT(t,e.nextSibling||e.target.nextSibling,1);return{from:s?t.posAfter(s):t.posAtStart,to:a?t.posBefore(a):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(xc)!=e.state.facet(xc)&&(e.view.contentDOM.editContext=e.state.facet(xc)?this.editContext.editContext:null))}destroy(){var e,t,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect();for(let a of this.scrollTargets)a.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function dT(n,e,t){for(;e;){let s=As.get(e);if(s&&s.parent==n)return s;let a=e.parentNode;e=a!=n.dom?a:t>0?e.nextSibling:e.previousSibling}return null}function mT(n,e){let t=e.startContainer,s=e.startOffset,a=e.endContainer,r=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return Af(o.node,o.offset,a,r)&&([t,s,a,r]=[a,r,t,s]),{anchorNode:t,anchorOffset:s,focusNode:a,focusOffset:r}}function CSe(n,e){if(e.getComposedRanges){let a=e.getComposedRanges(n.root)[0];if(a)return mT(n,a)}let t=null;function s(a){a.preventDefault(),a.stopImmediatePropagation(),t=a.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",s,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",s,!0),t?mT(n,t):null}class MSe{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=s=>{let a=e.state.selection.main,{anchor:r,head:o}=a,i=this.toEditorPos(s.updateRangeStart),l=this.toEditorPos(s.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:s.updateRangeStart,editorBase:i,drifted:!1});let c={from:i,to:l,insert:os.of(s.text.split(`
`))};if(c.from==this.from&&r<this.from?c.from=r:c.to==this.to&&r>this.to&&(c.to=r),c.from==c.to&&!c.insert.length){let u=Ze.single(this.toEditorPos(s.selectionStart),this.toEditorPos(s.selectionEnd));u.main.eq(a)||e.dispatch({selection:u,userEvent:"select"});return}if((Bt.mac||Bt.android)&&c.from==o-1&&/^\. ?$/.test(s.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:i,to:l,insert:os.of([s.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let u=this.to-this.from+(c.to-c.from+c.insert.length);S3(e,c,Ze.single(this.toEditorPos(s.selectionStart,u),this.toEditorPos(s.selectionEnd,u)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=s=>{let a=[],r=null;for(let o=this.toEditorPos(s.rangeStart),i=this.toEditorPos(s.rangeEnd);o<i;o++){let l=e.coordsForChar(o);r=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||r||new DOMRect,a.push(r)}t.updateCharacterBounds(s.rangeStart,a)},this.handlers.textformatupdate=s=>{let a=[];for(let r of s.getTextFormats()){let o=r.underlineStyle,i=r.underlineThickness;if(o!="None"&&i!="None"){let l=this.toEditorPos(r.rangeStart),c=this.toEditorPos(r.rangeEnd);if(l<c){let u=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${i=="Thin"?1:2}px`;a.push(en.mark({attributes:{style:u}}).range(l,c))}}}e.dispatch({effects:Pq.of(en.set(a))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:s}=this.composing;this.composing=null,s&&this.reset(e.state)}};for(let s in this.handlers)t.addEventListener(s,this.handlers[s]);this.measureReq={read:s=>{this.editContext.updateControlBounds(s.contentDOM.getBoundingClientRect());let a=mg(s.root);a&&a.rangeCount&&this.editContext.updateSelectionBounds(a.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,s=!1,a=this.pendingContextChange;return e.changes.iterChanges((r,o,i,l,c)=>{if(s)return;let u=c.length-(o-r);if(a&&o>=a.to)if(a.from==r&&a.to==o&&a.insert.eq(c)){a=this.pendingContextChange=null,t+=u,this.to+=u;return}else a=null,this.revertPending(e.state);if(r+=t,o+=t,o<=this.from)this.from+=u,this.to+=u;else if(r<this.to){if(r<this.from||o>this.to||this.to-this.from+c.length>3e4){s=!0;return}this.editContext.updateText(this.toContextPos(r),this.toContextPos(o),c.toString()),this.to+=u}t+=u}),a&&!s&&this.revertPending(e.state),!s}update(e){let t=this.pendingContextChange;this.composing&&(this.composing.drifted||e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,s=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),a=this.toContextPos(t.head);(this.editContext.selectionStart!=s||this.editContext.selectionEnd!=a)&&this.editContext.updateSelection(s,a)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let s=this.composing;return s&&s.drifted?s.editorBase+(e-s.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class vt{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:s}=e;this.dispatchTransactions=e.dispatchTransactions||s&&(a=>a.forEach(r=>s(r,this)))||(a=>this.update(a)),this.dispatch=this.dispatch.bind(this),this._root=e.root||c2e(e.parent)||document,this.viewState=new uT(e.state||as.create(e)),e.scrollTo&&e.scrollTo.is(eb)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(nf).map(a=>new ak(a));for(let a of this.plugins)a.update(this);this.observer=new SSe(this),this.inputState=new q2e(this),this.inputState.ensureHandlers(this.plugins),this.docView=new G4(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof va?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,s=!1,a,r=this.state;for(let m of e){if(m.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=m.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,i=0,l=null;e.some(m=>m.annotation(_q))?(this.inputState.notifiedFocused=o,i=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=Lq(r,o),l||(i=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(u=null)):this.observer.clear(),r.facet(as.phrases)!=this.state.facet(as.phrases))return this.setState(r);a=Ly.create(this,r,e),a.flags|=i;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let m of e){if(h&&(h=h.map(m.changes)),m.scrollIntoView){let{main:f}=m.state.selection;h=new Xd(f.empty?f:Ze.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of m.effects)f.is(eb)&&(h=f.value.clip(this.state))}this.viewState.update(a,h),this.bidiCache=Qy.update(this.bidiCache,a.changes),a.empty||(this.updatePlugins(a),this.inputState.update(a)),t=this.docView.update(a),this.state.facet(sf)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(m=>m.isUserEvent("select.pointer")))}finally{this.updateState=0}if(a.startState.facet(ob)!=a.state.facet(ob)&&(this.viewState.mustMeasureContent=!0),(t||s||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!a.empty)for(let m of this.state.facet(BS))try{m(a)}catch(f){co(this.state,f,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!Tq(this,u)&&c.force&&Gd(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new uT(e),this.plugins=e.facet(nf).map(s=>new ak(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView.destroy(),this.docView=new G4(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(nf),s=e.state.facet(nf);if(t!=s){let a=[];for(let r of s){let o=t.indexOf(r);if(o<0)a.push(new ak(r));else{let i=this.plugins[o];i.mustUpdate=e,a.push(i)}}for(let r of this.plugins)r.mustUpdate!=e&&r.destroy(this);this.plugins=a,this.pluginMap.clear()}else for(let a of this.plugins)a.mustUpdate=e;for(let a=0;a<this.plugins.length;a++)this.plugins[a].update(this);t!=s&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(s){co(this.state,s,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,s=this.scrollDOM,a=s.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(a-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let i=0;;i++){if(o<0)if(KW(s))r=-1,o=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(a);r=f.from,o=f.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(i>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(f=>{try{return f.read(this)}catch(v){return co(this.state,v),pT}}),h=Ly.create(this,this.state,[]),m=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),m=this.docView.update(h),m&&this.docViewUpdate());for(let f=0;f<c.length;f++)if(u[f]!=pT)try{let v=c[f];v.write&&v.write(u[f],this)}catch(v){co(this.state,v)}if(m&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let f=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(f>1||f<-1){a=a+f,s.scrollTop=a/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let i of this.state.facet(BS))i(t)}get themeClasses(){return IS+" "+(this.state.facet(LS)?jq:Vq)+" "+this.state.facet(ob)}updateAttrs(){let e=fT(this,Sq,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(xc)?"true":"false",class:"cm-content",style:`${Bt.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),fT(this,x3,t);let s=this.observer.ignore(()=>{let a=ES(this.contentDOM,this.contentAttrs,t),r=ES(this.dom,this.editorAttrs,e);return a||r});return this.editorAttrs=e,this.contentAttrs=t,s}showAnnouncements(e){let t=!0;for(let s of e)for(let a of s.effects)if(a.is(vt.announce)){t&&(this.announceDOM.textContent=""),t=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=a.value}}mountStyles(){this.styleModules=this.state.facet(sf);let e=this.state.facet(vt.cspNonce);Fu.mount(this.root,this.styleModules.concat(kSe).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(s=>s.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,s){return ok(this,e,H4(this,e,t,s))}moveByGroup(e,t){return ok(this,e,H4(this,e,t,s=>I2e(this,e.head,s)))}visualLineSide(e,t){let s=this.bidiSpans(e),a=this.textDirectionAt(e.from),r=s[t?s.length-1:0];return Ze.cursor(r.side(t,a)+e.from,r.forward(!t,a)?1:-1)}moveToLineBoundary(e,t,s=!0){return L2e(this,e,t,s)}moveVertically(e,t,s){return ok(this,e,Q2e(this,e,t,s))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Dq(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let s=this.docView.coordsAt(e,t);if(!s||s.left==s.right)return s;let a=this.state.doc.lineAt(e),r=this.bidiSpans(a),o=r[du.find(r,e-a.from,-1,t)];return Ew(s,o.dir==Ds.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Oq)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>ASe)return mq(e.length);let t=this.textDirectionAt(e.from),s;for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t&&(r.fresh||dq(r.isolates,s=z4(this,e))))return r.order;s||(s=z4(this,e));let a=x2e(e.text,t,s);return this.bidiCache.push(new Qy(e.from,e.to,t,s,!0,a)),a}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Bt.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{HW(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return eb.of(new Xd(typeof e=="number"?Ze.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,s=this.viewState.scrollAnchorAt(e);return eb.of(new Xd(Ze.cursor(s.from),"start","start",s.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return ra.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return ra.define(()=>({}),{eventObservers:e})}static theme(e,t){let s=Fu.newName(),a=[ob.of(s),sf.of(QS(`.${s}`,e))];return t&&t.dark&&a.push(LS.of(!0)),a}static baseTheme(e){return yo.lowest(sf.of(QS("."+IS,e,Zq)))}static findFromDOM(e){var t;let s=e.querySelector(".cm-content"),a=s&&As.get(s)||As.get(e);return((t=a==null?void 0:a.rootView)===null||t===void 0?void 0:t.view)||null}}vt.styleModule=sf;vt.inputHandler=vq;vt.clipboardInputFilter=w3;vt.clipboardOutputFilter=O3;vt.scrollHandler=kq;vt.focusChangeEffect=wq;vt.perLineTextDirection=Oq;vt.exceptionSink=yq;vt.updateListener=BS;vt.editable=xc;vt.mouseSelectionStyle=bq;vt.dragMovesSelection=gq;vt.clickAddsSelectionRange=fq;vt.decorations=fg;vt.outerDecorations=Cq;vt.atomicRanges=k3;vt.bidiIsolatedRanges=Mq;vt.scrollMargins=Aq;vt.darkTheme=LS;vt.cspNonce=Qt.define({combine:n=>n.length?n[0]:""});vt.contentAttributes=x3;vt.editorAttributes=Sq;vt.lineWrapping=vt.contentAttributes.of({class:"cm-lineWrapping"});vt.announce=hn.define();const ASe=4096,pT={};class Qy{constructor(e,t,s,a,r,o){this.from=e,this.to=t,this.dir=s,this.isolates=a,this.fresh=r,this.order=o}static update(e,t){if(t.empty&&!e.some(r=>r.fresh))return e;let s=[],a=e.length?e[e.length-1].dir:Ds.LTR;for(let r=Math.max(0,e.length-10);r<e.length;r++){let o=e[r];o.dir==a&&!t.touchesRange(o.from,o.to)&&s.push(new Qy(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return s}}function fT(n,e,t){for(let s=n.state.facet(e),a=s.length-1;a>=0;a--){let r=s[a],o=typeof r=="function"?r(n):r;o&&AS(o,t)}return t}const ESe=Bt.mac?"mac":Bt.windows?"win":Bt.linux?"linux":"key";function DSe(n,e){const t=n.split(/-(?!$)/);let s=t[t.length-1];s=="Space"&&(s=" ");let a,r,o,i;for(let l=0;l<t.length-1;++l){const c=t[l];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))a=!0;else if(/^(c|ctrl|control)$/i.test(c))r=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?i=!0:r=!0;else throw new Error("Unrecognized modifier name: "+c)}return a&&(s="Alt-"+s),r&&(s="Ctrl-"+s),i&&(s="Meta-"+s),o&&(s="Shift-"+s),s}function ib(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const TSe=yo.default(vt.domEventHandlers({keydown(n,e){return Gq(zq(e.state),n,e,"editor")}})),Xc=Qt.define({enables:TSe}),gT=new WeakMap;function zq(n){let e=n.facet(Xc),t=gT.get(e);return t||gT.set(e,t=NSe(e.reduce((s,a)=>s.concat(a),[]))),t}function rh(n,e,t){return Gq(zq(n.state),e,n,t)}let nu=null;const FSe=4e3;function NSe(n,e=ESe){let t=Object.create(null),s=Object.create(null),a=(o,i)=>{let l=s[o];if(l==null)s[o]=i;else if(l!=i)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,i,l,c,u)=>{var h,m;let f=t[o]||(t[o]=Object.create(null)),v=i.split(/ (?!$)/).map(M=>DSe(M,e));for(let M=1;M<v.length;M++){let E=v.slice(0,M).join(" ");a(E,!0),f[E]||(f[E]={preventDefault:!0,stopPropagation:!1,run:[I=>{let D=nu={view:I,prefix:E,scope:o};return setTimeout(()=>{nu==D&&(nu=null)},FSe),!0}]})}let O=v.join(" ");a(O,!1);let k=f[O]||(f[O]={preventDefault:!1,stopPropagation:!1,run:((m=(h=f._any)===null||h===void 0?void 0:h.run)===null||m===void 0?void 0:m.slice())||[]});l&&k.run.push(l),c&&(k.preventDefault=!0),u&&(k.stopPropagation=!0)};for(let o of n){let i=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of i){let u=t[c]||(t[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=o;for(let m in u)u[m].run.push(f=>h(f,VS))}let l=o[e]||o.key;if(l)for(let c of i)r(c,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&r(c,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return t}let VS=null;function Gq(n,e,t,s){VS=e;let a=a2e(e),r=ao(a,0),o=Al(r)==a.length&&a!=" ",i="",l=!1,c=!1,u=!1;nu&&nu.view==t&&nu.scope==s&&(i=nu.prefix+" ",Nq.indexOf(e.keyCode)<0&&(c=!0,nu=null));let h=new Set,m=k=>{if(k){for(let M of k.run)if(!h.has(M)&&(h.add(M),M(t)))return k.stopPropagation&&(u=!0),!0;k.preventDefault&&(k.stopPropagation&&(u=!0),c=!0)}return!1},f=n[s],v,O;return f&&(m(f[i+ib(a,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Bt.windows&&e.ctrlKey&&e.altKey)&&(v=Nu[e.keyCode])&&v!=a?(m(f[i+ib(v,e,!0)])||e.shiftKey&&(O=dg[e.keyCode])!=a&&O!=v&&m(f[i+ib(O,e,!1)]))&&(l=!0):o&&e.shiftKey&&m(f[i+ib(a,e,!0)])&&(l=!0),!l&&m(f._any)&&(l=!0)),c&&(l=!0),l&&u&&e.stopPropagation(),VS=null,l}class r0{constructor(e,t,s,a,r){this.className=e,this.left=t,this.top=s,this.width=a,this.height=r}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,s){if(s.empty){let a=e.coordsAtPos(s.head,s.assoc||1);if(!a)return[];let r=Xq(e);return[new r0(t,a.left-r.left,a.top-r.top,null,a.bottom-a.top)]}else return BSe(e,t,s)}}function Xq(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Ds.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function bT(n,e,t,s){let a=n.coordsAtPos(e,t*2);if(!a)return s;let r=n.dom.getBoundingClientRect(),o=(a.top+a.bottom)/2,i=n.posAtCoords({x:r.left+1,y:o}),l=n.posAtCoords({x:r.right-1,y:o});return i==null||l==null?s:{from:Math.max(s.from,Math.min(i,l)),to:Math.min(s.to,Math.max(i,l))}}function BSe(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let s=Math.max(t.from,n.viewport.from),a=Math.min(t.to,n.viewport.to),r=n.textDirection==Ds.LTR,o=n.contentDOM,i=o.getBoundingClientRect(),l=Xq(n),c=o.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),h=i.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),m=i.right-(u?parseInt(u.paddingRight):0),f=RS(n,s),v=RS(n,a),O=f.type==Dr.Text?f:null,k=v.type==Dr.Text?v:null;if(O&&(n.lineWrapping||f.widgetLineBreaks)&&(O=bT(n,s,1,O)),k&&(n.lineWrapping||v.widgetLineBreaks)&&(k=bT(n,a,-1,k)),O&&k&&O.from==k.from&&O.to==k.to)return E(I(t.from,t.to,O));{let F=O?I(t.from,null,O):D(f,!1),_=k?I(null,t.to,k):D(v,!0),$=[];return(O||f).to<(k||v).from-(O&&k?1:0)||f.widgetLineBreaks>1&&F.bottom+n.defaultLineHeight/2<_.top?$.push(M(h,F.bottom,m,_.top)):F.bottom<_.top&&n.elementAtHeight((F.bottom+_.top)/2).type==Dr.Text&&(F.bottom=_.top=(F.bottom+_.top)/2),E(F).concat($).concat(E(_))}function M(F,_,$,Z){return new r0(e,F-l.left,_-l.top,$-F,Z-_)}function E({top:F,bottom:_,horizontal:$}){let Z=[];for(let ce=0;ce<$.length;ce+=2)Z.push(M($[ce],F,$[ce+1],_));return Z}function I(F,_,$){let Z=1e9,ce=-1e9,U=[];function ue(be,ke,Ce,Ae,q){let Ne=n.coordsAtPos(be,be==$.to?-2:2),Re=n.coordsAtPos(Ce,Ce==$.from?2:-2);!Ne||!Re||(Z=Math.min(Ne.top,Re.top,Z),ce=Math.max(Ne.bottom,Re.bottom,ce),q==Ds.LTR?U.push(r&&ke?h:Ne.left,r&&Ae?m:Re.right):U.push(!r&&Ae?h:Re.left,!r&&ke?m:Ne.right))}let W=F??$.from,de=_??$.to;for(let be of n.visibleRanges)if(be.to>W&&be.from<de)for(let ke=Math.max(be.from,W),Ce=Math.min(be.to,de);;){let Ae=n.state.doc.lineAt(ke);for(let q of n.bidiSpans(Ae)){let Ne=q.from+Ae.from,Re=q.to+Ae.from;if(Ne>=Ce)break;Re>ke&&ue(Math.max(Ne,ke),F==null&&Ne<=W,Math.min(Re,Ce),_==null&&Re>=de,q.dir)}if(ke=Ae.to+1,ke>=Ce)break}return U.length==0&&ue(W,F==null,de,_==null,n.textDirection),{top:Z,bottom:ce,horizontal:U}}function D(F,_){let $=i.top+(_?F.top:F.bottom);return{top:$,bottom:$,horizontal:[]}}}function $Se(n,e){return n.constructor==e.constructor&&n.eq(e)}class RSe{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(l1)!=e.state.facet(l1)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,s=e.facet(l1);for(;t<s.length&&s[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,s)=>!$Se(t,this.drawn[s]))){let t=this.dom.firstChild,s=0;for(let a of e)a.update&&t&&a.constructor&&this.drawn[s].constructor&&a.update(t,this.drawn[s])?(t=t.nextSibling,s++):this.dom.insertBefore(a.draw(),t);for(;t;){let a=t.nextSibling;t.remove(),t=a}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const l1=Qt.define();function Wq(n){return[ra.define(e=>new RSe(e,n)),l1.of(n)]}const qq=!(Bt.ios&&Bt.webkit&&Bt.webkit_version<534),xm=Qt.define({combine(n){return Gc(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function Uq(n={}){return[xm.of(n),_Se,LSe,ISe,xq.of(!0)]}function Hq(n){return n.facet(xm)}function Yq(n){return n.startState.facet(xm)!=n.state.facet(xm)}const _Se=Wq({above:!0,markers(n){let{state:e}=n,t=e.facet(xm),s=[];for(let a of e.selection.ranges){let r=a==e.selection.main;if(a.empty?!r||qq:t.drawRangeCursor){let o=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",i=a.empty?a:Ze.cursor(a.head,a.head>a.anchor?-1:1);for(let l of r0.forRange(n,o,i))s.push(l)}}return s},update(n,e){n.transactions.some(s=>s.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=Yq(n);return t&&yT(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){yT(e.state,n)},class:"cm-cursorLayer"});function yT(n,e){e.style.animationDuration=n.facet(xm).cursorBlinkRate+"ms"}const LSe=Wq({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:r0.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||Yq(n)},class:"cm-selectionLayer"}),jS={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};qq&&(jS[".cm-line"].caretColor=jS[".cm-content"].caretColor="transparent !important");const ISe=yo.highest(vt.theme(jS)),Kq=hn.define({map(n,e){return n==null?null:e.mapPos(n)}}),of=Js.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,s)=>s.is(Kq)?s.value:t,n)}}),QSe=ra.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(of);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(of)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(of),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let s=n.scrollDOM.getBoundingClientRect();return{left:t.left-s.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-s.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(of)!=n&&this.view.dispatch({effects:Kq.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function VSe(){return[of,QSe]}function vT(n,e,t,s,a){e.lastIndex=0;for(let r=n.iterRange(t,s),o=t,i;!r.next().done;o+=r.value.length)if(!r.lineBreak)for(;i=e.exec(r.value);)a(o+i.index,i)}function jSe(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let s=[];for(let{from:a,to:r}of t)a=Math.max(n.state.doc.lineAt(a).from,a-e),r=Math.min(n.state.doc.lineAt(r).to,r+e),s.length&&s[s.length-1].to>=a?s[s.length-1].to=r:s.push({from:a,to:r});return s}class ZSe{constructor(e){const{regexp:t,decoration:s,decorate:a,boundary:r,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,a)this.addMatch=(i,l,c,u)=>a(u,c,c+i[0].length,i,l);else if(typeof s=="function")this.addMatch=(i,l,c,u)=>{let h=s(i,l,c);h&&u(c,c+i[0].length,h)};else if(s)this.addMatch=(i,l,c,u)=>u(c,c+i[0].length,s);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=r,this.maxLength=o}createDeco(e){let t=new Gl,s=t.add.bind(t);for(let{from:a,to:r}of jSe(e,this.maxLength))vT(e.state.doc,this.regexp,a,r,(o,i)=>this.addMatch(i,e,o,s));return t.finish()}updateDeco(e,t){let s=1e9,a=-1;return e.docChanged&&e.changes.iterChanges((r,o,i,l)=>{l>=e.view.viewport.from&&i<=e.view.viewport.to&&(s=Math.min(i,s),a=Math.max(l,a))}),e.viewportMoved||a-s>1e3?this.createDeco(e.view):a>-1?this.updateRange(e.view,t.map(e.changes),s,a):t}updateRange(e,t,s,a){for(let r of e.visibleRanges){let o=Math.max(r.from,s),i=Math.min(r.to,a);if(i>o){let l=e.state.doc.lineAt(o),c=l.to<i?e.state.doc.lineAt(i):l,u=Math.max(r.from,l.from),h=Math.min(r.to,c.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){u=o;break}for(;i<c.to;i++)if(this.boundary.test(c.text[i-c.from])){h=i;break}}let m=[],f,v=(O,k,M)=>m.push(M.range(O,k));if(l==c)for(this.regexp.lastIndex=u-l.from;(f=this.regexp.exec(l.text))&&f.index<h-l.from;)this.addMatch(f,e,f.index+l.from,v);else vT(e.state.doc,this.regexp,u,h,(O,k)=>this.addMatch(k,e,O,v));t=t.update({filterFrom:u,filterTo:h,filter:(O,k)=>O<u||k>h,add:m})}}return t}}const ZS=/x/.unicode!=null?"gu":"g",zSe=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,ZS),GSe={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let ck=null;function XSe(){var n;if(ck==null&&typeof document<"u"&&document.body){let e=document.body.style;ck=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return ck||!1}const c1=Qt.define({combine(n){let e=Gc(n,{render:null,specialChars:zSe,addSpecialChars:null});return(e.replaceTabs=!XSe())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,ZS)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,ZS)),e}});function Jq(n={}){return[c1.of(n),WSe()]}let wT=null;function WSe(){return wT||(wT=ra.fromClass(class{constructor(n){this.view=n,this.decorations=en.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(c1)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new ZSe({regexp:n.specialChars,decoration:(e,t,s)=>{let{doc:a}=t.state,r=ao(e[0],0);if(r==9){let o=a.lineAt(s),i=t.state.tabSize,l=ep(o.text,i,s-o.from);return en.replace({widget:new YSe((i-l%i)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[r]||(this.decorationCache[r]=en.replace({widget:new HSe(n,r)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(c1);n.startState.facet(c1)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const qSe="•";function USe(n){return n>=32?qSe:n==10?"␤":String.fromCharCode(9216+n)}class HSe extends cl{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=USe(this.code),s=e.state.phrase("Control character")+" "+(GSe[this.code]||"0x"+this.code.toString(16)),a=this.options.render&&this.options.render(this.code,s,t);if(a)return a;let r=document.createElement("span");return r.textContent=t,r.title=s,r.setAttribute("aria-label",s),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class YSe extends cl{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function KSe(){return eCe}const JSe=en.line({class:"cm-activeLine"}),eCe=ra.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let s of n.state.selection.ranges){let a=n.lineBlockAt(s.head);a.from>e&&(t.push(JSe.range(a.from)),e=a.from)}return en.set(t)}},{decorations:n=>n.decorations}),zS=2e3;function tCe(n,e,t){let s=Math.min(e.line,t.line),a=Math.max(e.line,t.line),r=[];if(e.off>zS||t.off>zS||e.col<0||t.col<0){let o=Math.min(e.off,t.off),i=Math.max(e.off,t.off);for(let l=s;l<=a;l++){let c=n.doc.line(l);c.length<=i&&r.push(Ze.range(c.from+o,c.to+i))}}else{let o=Math.min(e.col,t.col),i=Math.max(e.col,t.col);for(let l=s;l<=a;l++){let c=n.doc.line(l),u=OS(c.text,o,n.tabSize,!0);if(u<0)r.push(Ze.cursor(c.to));else{let h=OS(c.text,i,n.tabSize);r.push(Ze.range(c.from+u,c.from+h))}}}return r}function nCe(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function OT(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),s=n.state.doc.lineAt(t),a=t-s.from,r=a>zS?-1:a==s.length?nCe(n,e.clientX):ep(s.text,n.state.tabSize,t-s.from);return{line:s.number,col:r,off:a}}function sCe(n,e){let t=OT(n,e),s=n.state.selection;return t?{update(a){if(a.docChanged){let r=a.changes.mapPos(a.startState.doc.line(t.line).from),o=a.state.doc.lineAt(r);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},s=s.map(a.changes)}},get(a,r,o){let i=OT(n,a);if(!i)return s;let l=tCe(n.state,t,i);return l.length?o?Ze.create(l.concat(s.ranges)):Ze.create(l):s}}:null}function aCe(n){let e=t=>t.altKey&&t.button==0;return vt.mouseSelectionStyle.of((t,s)=>e(s)?sCe(t,s):null)}const rCe={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},oCe={style:"cursor: crosshair"};function iCe(n={}){let[e,t]=rCe[n.key||"Alt"],s=ra.fromClass(class{constructor(a){this.view=a,this.isDown=!1}set(a){this.isDown!=a&&(this.isDown=a,this.view.update([]))}},{eventObservers:{keydown(a){this.set(a.keyCode==e||t(a))},keyup(a){(a.keyCode==e||!t(a))&&this.set(!1)},mousemove(a){this.set(t(a))}}});return[s,vt.contentAttributes.of(a=>{var r;return!((r=a.plugin(s))===null||r===void 0)&&r.isDown?oCe:null})]}const Bp="-10000px";class eU{constructor(e,t,s,a){this.facet=t,this.createTooltipView=s,this.removeTooltipView=a,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let r=null;this.tooltipViews=this.tooltips.map(o=>r=s(o,r))}update(e,t){var s;let a=e.state.facet(this.facet),r=a.filter(l=>l);if(a===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],i=t?[]:null;for(let l=0;l<r.length;l++){let c=r[l],u=-1;if(c){for(let h=0;h<this.tooltips.length;h++){let m=this.tooltips[h];m&&m.create==c.create&&(u=h)}if(u<0)o[l]=this.createTooltipView(c,l?o[l-1]:null),i&&(i[l]=!!c.above);else{let h=o[l]=this.tooltipViews[u];i&&(i[l]=t[u]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(s=l.destroy)===null||s===void 0||s.call(l));return t&&(i.forEach((l,c)=>t[c]=l),t.length=i.length),this.input=a,this.tooltips=r,this.tooltipViews=o,!0}}function lCe(n){let{win:e}=n;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const uk=Qt.define({combine:n=>{var e,t,s;return{position:Bt.ios?"absolute":((e=n.find(a=>a.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(a=>a.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((s=n.find(a=>a.tooltipSpace))===null||s===void 0?void 0:s.tooltipSpace)||lCe}}}),xT=new WeakMap,A3=ra.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(uk);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new eU(n,E3,(t,s)=>this.createTooltip(t,s),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,s=n.state.facet(uk);if(s.position!=this.position&&!this.madeAbsolute){this.position=s.position;for(let a of this.manager.tooltipViews)a.dom.style.position=this.position;t=!0}if(s.parent!=this.parent){this.parent&&this.container.remove(),this.parent=s.parent,this.createContainer();for(let a of this.manager.tooltipViews)this.container.appendChild(a.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),s=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let a=document.createElement("div");a.className="cm-tooltip-arrow",t.dom.appendChild(a)}return t.dom.style.position=this.position,t.dom.style.top=Bp,t.dom.style.left="0px",this.container.insertBefore(t.dom,s),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let s of this.manager.tooltipViews)s.dom.remove(),(n=s.destroy)===null||n===void 0||n.call(s);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(Bt.gecko)t=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==Bp&&r.style.left=="0px"){let o=r.getBoundingClientRect();t=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(t||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(n=r.width/this.parent.offsetWidth,e=r.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let s=this.view.scrollDOM.getBoundingClientRect(),a=P3(this.view);return{visible:{left:s.left+a.left,top:s.top+a.top,right:s.right-a.right,bottom:s.bottom-a.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((r,o)=>{let i=this.manager.tooltipViews[o];return i.getCoords?i.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(uk).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let i of this.manager.tooltipViews)i.dom.style.position="absolute"}let{visible:t,space:s,scaleX:a,scaleY:r}=n,o=[];for(let i=0;i<this.manager.tooltips.length;i++){let l=this.manager.tooltips[i],c=this.manager.tooltipViews[i],{dom:u}=c,h=n.pos[i],m=n.size[i];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,s.top)||h.top>=Math.min(t.bottom,s.bottom)||h.right<Math.max(t.left,s.left)-.1||h.left>Math.min(t.right,s.right)+.1)){u.style.top=Bp;continue}let f=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,v=f?7:0,O=m.right-m.left,k=(e=xT.get(c))!==null&&e!==void 0?e:m.bottom-m.top,M=c.offset||uCe,E=this.view.textDirection==Ds.LTR,I=m.width>s.right-s.left?E?s.left:s.right-m.width:E?Math.max(s.left,Math.min(h.left-(f?14:0)+M.x,s.right-O)):Math.min(Math.max(s.left,h.left-O+(f?14:0)-M.x),s.right-O),D=this.above[i];!l.strictSide&&(D?h.top-k-v-M.y<s.top:h.bottom+k+v+M.y>s.bottom)&&D==s.bottom-h.bottom>h.top-s.top&&(D=this.above[i]=!D);let F=(D?h.top-s.top:s.bottom-h.bottom)-v;if(F<k&&c.resize!==!1){if(F<this.view.defaultLineHeight){u.style.top=Bp;continue}xT.set(c,k),u.style.height=(k=F)/r+"px"}else u.style.height&&(u.style.height="");let _=D?h.top-k-v-M.y:h.bottom+v+M.y,$=I+O;if(c.overlap!==!0)for(let Z of o)Z.left<$&&Z.right>I&&Z.top<_+k&&Z.bottom>_&&(_=D?Z.top-k-2-v:Z.bottom+v+2);if(this.position=="absolute"?(u.style.top=(_-n.parent.top)/r+"px",kT(u,(I-n.parent.left)/a)):(u.style.top=_/r+"px",kT(u,I/a)),f){let Z=h.left+(E?M.x:-M.x)-(I+14-7);f.style.left=Z/a+"px"}c.overlap!==!0&&o.push({left:I,top:_,right:$,bottom:_+k}),u.classList.toggle("cm-tooltip-above",D),u.classList.toggle("cm-tooltip-below",!D),c.positioned&&c.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Bp}},{eventObservers:{scroll(){this.maybeMeasure()}}});function kT(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const cCe=vt.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),uCe={x:0,y:0},E3=Qt.define({enables:[A3,cCe]}),Vy=Qt.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class Fw{static create(e){return new Fw(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new eU(e,Vy,(t,s)=>this.createHostedView(t,s),t=>t.dom.remove())}createHostedView(e,t){let s=e.create(this.view);return s.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(s.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&s.mount&&s.mount(this.view),s}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let s of this.manager.tooltipViews){let a=s[e];if(a!==void 0){if(t===void 0)t=a;else if(t!==a)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const hCe=E3.compute([Vy],n=>{let e=n.facet(Vy);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var s;return(s=t.end)!==null&&s!==void 0?s:t.pos})),create:Fw.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class dCe{constructor(e,t,s,a,r){this.view=e,this.source=t,this.field=s,this.setHover=a,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,s=e.docView.nearest(t.target);if(!s)return;let a,r=1;if(s instanceof hu)a=s.posAtStart;else{if(a=e.posAtCoords(t),a==null)return;let i=e.coordsAtPos(a);if(!i||t.y<i.top||t.y>i.bottom||t.x<i.left-e.defaultCharacterWidth||t.x>i.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(a)).find(u=>u.from<=a&&u.to>=a),c=l&&l.dir==Ds.RTL?-1:1;r=t.x<i.left?-c:c}let o=this.source(e,a,r);if(o!=null&&o.then){let i=this.pending={pos:a};o.then(l=>{this.pending==i&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>co(e.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(A3),t=e?e.manager.tooltips.findIndex(s=>s.create==Fw.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,s;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:a,tooltip:r}=this;if(a.length&&r&&!mCe(r.dom,e)||this.pending){let{pos:o}=a[0]||this.pending,i=(s=(t=a[0])===null||t===void 0?void 0:t.end)!==null&&s!==void 0?s:o;(o==i?this.view.posAtCoords(this.lastMove)!=o:!pCe(this.view,o,i,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:s}=this;s&&s.dom.contains(e.relatedTarget)?this.watchTooltipLeave(s.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=s=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(s.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const lb=4;function mCe(n,e){let{left:t,right:s,top:a,bottom:r}=n.getBoundingClientRect(),o;if(o=n.querySelector(".cm-tooltip-arrow")){let i=o.getBoundingClientRect();a=Math.min(i.top,a),r=Math.max(i.bottom,r)}return e.clientX>=t-lb&&e.clientX<=s+lb&&e.clientY>=a-lb&&e.clientY<=r+lb}function pCe(n,e,t,s,a,r){let o=n.scrollDOM.getBoundingClientRect(),i=n.documentTop+n.documentPadding.top+n.contentHeight;if(o.left>s||o.right<s||o.top>a||Math.min(o.bottom,i)<a)return!1;let l=n.posAtCoords({x:s,y:a},!1);return l>=e&&l<=t}function tU(n,e={}){let t=hn.define(),s=Js.define({create(){return[]},update(a,r){if(a.length&&(e.hideOnChange&&(r.docChanged||r.selection)?a=[]:e.hideOn&&(a=a.filter(o=>!e.hideOn(r,o))),r.docChanged)){let o=[];for(let i of a){let l=r.changes.mapPos(i.pos,-1,ga.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),i);c.pos=l,c.end!=null&&(c.end=r.changes.mapPos(c.end)),o.push(c)}}a=o}for(let o of r.effects)o.is(t)&&(a=o.value),o.is(fCe)&&(a=[]);return a},provide:a=>Vy.from(a)});return{active:s,extension:[s,ra.define(a=>new dCe(a,n,s,t,e.hoverTime||300)),hCe]}}function nU(n,e){let t=n.plugin(A3);if(!t)return null;let s=t.manager.tooltips.indexOf(e);return s<0?null:t.manager.tooltipViews[s]}const fCe=hn.define(),PT=Qt.define({combine(n){let e,t;for(let s of n)e=e||s.topContainer,t=t||s.bottomContainer;return{topContainer:e,bottomContainer:t}}});function gg(n,e){let t=n.plugin(sU),s=t?t.specs.indexOf(e):-1;return s>-1?t.panels[s]:null}const sU=ra.fromClass(class{constructor(n){this.input=n.state.facet($u),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(PT);this.top=new cb(n,!0,e.topContainer),this.bottom=new cb(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(PT);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new cb(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new cb(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet($u);if(t!=this.input){let s=t.filter(l=>l),a=[],r=[],o=[],i=[];for(let l of s){let c=this.specs.indexOf(l),u;c<0?(u=l(n.view),i.push(u)):(u=this.panels[c],u.update&&u.update(n)),a.push(u),(u.top?r:o).push(u)}this.specs=s,this.panels=a,this.top.sync(r),this.bottom.sync(o);for(let l of i)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let s of this.panels)s.update&&s.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>vt.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class cb{constructor(e,t,s){this.view=e,this.top=t,this.container=s,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=ST(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=ST(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function ST(n){let e=n.nextSibling;return n.remove(),e}const $u=Qt.define({enables:sU});class Ru extends jh{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ru.prototype.elementClass="";Ru.prototype.toDOM=void 0;Ru.prototype.mapMode=ga.TrackBefore;Ru.prototype.startSide=Ru.prototype.endSide=-1;Ru.prototype.point=!0;const u1=Qt.define(),gCe=Qt.define(),h1=Qt.define(),CT=Qt.define({combine:n=>n.some(e=>e)});function bCe(n){return[yCe]}const yCe=ra.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(h1).map(e=>new AT(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(CT),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,s=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(s<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(CT)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=hs.iter(this.view.state.facet(u1),this.view.viewport.from),s=[],a=this.gutters.map(r=>new vCe(r,this.view.viewport,-this.view.documentPadding.top));for(let r of this.view.viewportLineBlocks)if(s.length&&(s=[]),Array.isArray(r.type)){let o=!0;for(let i of r.type)if(i.type==Dr.Text&&o){GS(t,s,i.from);for(let l of a)l.line(this.view,i,s);o=!1}else if(i.widget)for(let l of a)l.widget(this.view,i)}else if(r.type==Dr.Text){GS(t,s,r.from);for(let o of a)o.line(this.view,r,s)}else if(r.widget)for(let o of a)o.widget(this.view,r);for(let r of a)r.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(h1),t=n.state.facet(h1),s=n.docChanged||n.heightChanged||n.viewportChanged||!hs.eq(n.startState.facet(u1),n.state.facet(u1),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let a of this.gutters)a.update(n)&&(s=!0);else{s=!0;let a=[];for(let r of t){let o=e.indexOf(r);o<0?a.push(new AT(this.view,r)):(this.gutters[o].update(n),a.push(this.gutters[o]))}for(let r of this.gutters)r.dom.remove(),a.indexOf(r)<0&&r.destroy();for(let r of a)this.dom.appendChild(r.dom);this.gutters=a}return s}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>vt.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==Ds.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function MT(n){return Array.isArray(n)?n:[n]}function GS(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class vCe{constructor(e,t,s){this.gutter=e,this.height=s,this.i=0,this.cursor=hs.iter(e.markers,t.from)}addElement(e,t,s){let{gutter:a}=this,r=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==a.elements.length){let i=new aU(e,o,r,s);a.elements.push(i),a.dom.appendChild(i.dom)}else a.elements[this.i].update(e,o,r,s);this.height=t.bottom,this.i++}line(e,t,s){let a=[];GS(this.cursor,a,t.from),s.length&&(a=a.concat(s));let r=this.gutter.config.lineMarker(e,t,a);r&&a.unshift(r);let o=this.gutter;a.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,a)}widget(e,t){let s=this.gutter.config.widgetMarker(e,t.widget,t),a=s?[s]:null;for(let r of e.state.facet(gCe)){let o=r(e,t.widget,t);o&&(a||(a=[])).push(o)}a&&this.addElement(e,t,a)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class AT{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in t.domEventHandlers)this.dom.addEventListener(s,a=>{let r=a.target,o;if(r!=this.dom&&this.dom.contains(r)){for(;r.parentNode!=this.dom;)r=r.parentNode;let l=r.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=a.clientY;let i=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[s](e,i,a)&&a.preventDefault()});this.markers=MT(t.markers(e)),t.initialSpacer&&(this.spacer=new aU(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=MT(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let a=this.config.updateSpacer(this.spacer.markers[0],e);a!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[a])}let s=e.view.viewport;return!hs.eq(this.markers,t,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class aU{constructor(e,t,s,a){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,s,a)}update(e,t,s,a){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),wCe(this.markers,a)||this.setMarkers(e,a)}setMarkers(e,t){let s="cm-gutterElement",a=this.dom.firstChild;for(let r=0,o=0;;){let i=o,l=r<t.length?t[r++]:null,c=!1;if(l){let u=l.elementClass;u&&(s+=" "+u);for(let h=o;h<this.markers.length;h++)if(this.markers[h].compare(l)){i=h,c=!0;break}}else i=this.markers.length;for(;o<i;){let u=this.markers[o++];if(u.toDOM){u.destroy(a);let h=a.nextSibling;a.remove(),a=h}}if(!l)break;l.toDOM&&(c?a=a.nextSibling:this.dom.insertBefore(l.toDOM(e),a)),c&&o++}this.dom.className=s,this.markers=t}destroy(){this.setMarkers(null,[])}}function wCe(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const OCe=Qt.define(),xCe=Qt.define(),kd=Qt.define({combine(n){return Gc(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let s=Object.assign({},e);for(let a in t){let r=s[a],o=t[a];s[a]=r?(i,l,c)=>r(i,l,c)||o(i,l,c):o}return s}})}});class hk extends Ru{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function dk(n,e){return n.state.facet(kd).formatNumber(e,n.state)}const kCe=h1.compute([kd],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(OCe)},lineMarker(e,t,s){return s.some(a=>a.toDOM)?null:new hk(dk(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,s)=>{for(let a of e.state.facet(xCe)){let r=a(e,t,s);if(r)return r}return null},lineMarkerChange:e=>e.startState.facet(kd)!=e.state.facet(kd),initialSpacer(e){return new hk(dk(e,ET(e.state.doc.lines)))},updateSpacer(e,t){let s=dk(t.view,ET(t.view.state.doc.lines));return s==e.number?e:new hk(s)},domEventHandlers:n.facet(kd).domEventHandlers}));function PCe(n={}){return[kd.of(n),bCe(),kCe]}function ET(n){let e=9;for(;e<n;)e=e*10+9;return e}const SCe=new class extends Ru{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},CCe=u1.compute(["selection"],n=>{let e=[],t=-1;for(let s of n.selection.ranges){let a=n.doc.lineAt(s.head).from;a>t&&(t=a,e.push(SCe.range(a)))}return hs.of(e)});function MCe(){return CCe}const rU=1024;let ACe=0;class mk{constructor(e,t){this.from=e,this.to=t}}class Zn{constructor(e={}){this.id=ACe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=bo.match(e)),t=>{let s=e(t);return s===void 0?null:[this,s]}}}Zn.closedBy=new Zn({deserialize:n=>n.split(" ")});Zn.openedBy=new Zn({deserialize:n=>n.split(" ")});Zn.group=new Zn({deserialize:n=>n.split(" ")});Zn.isolate=new Zn({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Zn.contextHash=new Zn({perNode:!0});Zn.lookAhead=new Zn({perNode:!0});Zn.mounted=new Zn({perNode:!0});class jy{constructor(e,t,s){this.tree=e,this.overlay=t,this.parser=s}static get(e){return e&&e.props&&e.props[Zn.mounted.id]}}const ECe=Object.create(null);class bo{constructor(e,t,s,a=0){this.name=e,this.props=t,this.id=s,this.flags=a}static define(e){let t=e.props&&e.props.length?Object.create(null):ECe,s=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),a=new bo(e.name||"",t,e.id,s);if(e.props){for(let r of e.props)if(Array.isArray(r)||(r=r(a)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}}return a}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Zn.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let s in e)for(let a of s.split(" "))t[a]=e[s];return s=>{for(let a=s.prop(Zn.group),r=-1;r<(a?a.length:0);r++){let o=t[r<0?s.name:a[r]];if(o)return o}}}}bo.none=new bo("",Object.create(null),0,8);class D3{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let s of this.types){let a=null;for(let r of e){let o=r(s);o&&(a||(a=Object.assign({},s.props)),a[o[0].id]=o[1])}t.push(a?new bo(s.name,a,s.id,s.flags):s)}return new D3(t)}}const ub=new WeakMap,DT=new WeakMap;var Ca;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(Ca||(Ca={}));class Oa{constructor(e,t,s,a,r){if(this.type=e,this.children=t,this.positions=s,this.length=a,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,i]of r)this.props[typeof o=="number"?o:o.id]=i}}toString(){let e=jy.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let s of this.children){let a=s.toString();a&&(t&&(t+=","),t+=a)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new WS(this.topNode,e)}cursorAt(e,t=0,s=0){let a=ub.get(this)||this.topNode,r=new WS(a);return r.moveTo(e,t),ub.set(this,r._tree),r}get topNode(){return new mo(this,0,0,null)}resolve(e,t=0){let s=bg(ub.get(this)||this.topNode,e,t,!1);return ub.set(this,s),s}resolveInner(e,t=0){let s=bg(DT.get(this)||this.topNode,e,t,!0);return DT.set(this,s),s}resolveStack(e,t=0){return FCe(this,e,t)}iterate(e){let{enter:t,leave:s,from:a=0,to:r=this.length}=e,o=e.mode||0,i=(o&Ca.IncludeAnonymous)>0;for(let l=this.cursor(o|Ca.IncludeAnonymous);;){let c=!1;if(l.from<=r&&l.to>=a&&(!i&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&s&&(i||!l.type.isAnonymous)&&s(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:N3(bo.none,this.children,this.positions,0,this.children.length,0,this.length,(t,s,a)=>new Oa(this.type,t,s,a,this.propValues),e.makeTree||((t,s,a)=>new Oa(bo.none,t,s,a)))}static build(e){return NCe(e)}}Oa.empty=new Oa(bo.none,[],[],0);class T3{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new T3(this.buffer,this.index)}}class _u{constructor(e,t,s){this.buffer=e,this.length=t,this.set=s}get type(){return bo.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],s=this.buffer[e+3],a=this.set.types[t],r=a.name;if(/\W/.test(r)&&!a.isError&&(r=JSON.stringify(r)),e+=4,s==e)return r;let o=[];for(;e<s;)o.push(this.childString(e)),e=this.buffer[e+3];return r+"("+o.join(",")+")"}findChild(e,t,s,a,r){let{buffer:o}=this,i=-1;for(let l=e;l!=t&&!(oU(r,a,o[l+1],o[l+2])&&(i=l,s>0));l=o[l+3]);return i}slice(e,t,s){let a=this.buffer,r=new Uint16Array(t-e),o=0;for(let i=e,l=0;i<t;){r[l++]=a[i++],r[l++]=a[i++]-s;let c=r[l++]=a[i++]-s;r[l++]=a[i++]-e,o=Math.max(o,c)}return new _u(r,o,this.set)}}function oU(n,e,t,s){switch(n){case-2:return t<e;case-1:return s>=e&&t<e;case 0:return t<e&&s>e;case 1:return t<=e&&s>e;case 2:return s>e;case 4:return!0}}function bg(n,e,t,s){for(var a;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!s&&n instanceof mo&&n.index<0?null:n.parent;if(!o)return n;n=o}let r=s?0:Ca.IgnoreOverlays;if(s)for(let o=n,i=o.parent;i;o=i,i=o.parent)o instanceof mo&&o.index<0&&((a=i.enter(e,t,r))===null||a===void 0?void 0:a.from)!=o.from&&(n=i);for(;;){let o=n.enter(e,t,r);if(!o)return n;n=o}}class iU{cursor(e=0){return new WS(this,e)}getChild(e,t=null,s=null){let a=TT(this,e,t,s);return a.length?a[0]:null}getChildren(e,t=null,s=null){return TT(this,e,t,s)}resolve(e,t=0){return bg(this,e,t,!1)}resolveInner(e,t=0){return bg(this,e,t,!0)}matchContext(e){return XS(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),s=this;for(;t;){let a=t.lastChild;if(!a||a.to!=t.to)break;a.type.isError&&a.from==a.to?(s=t,t=a.prevSibling):t=a}return s}get node(){return this}get next(){return this.parent}}class mo extends iU{constructor(e,t,s,a){super(),this._tree=e,this.from=t,this.index=s,this._parent=a}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,s,a,r=0){for(let o=this;;){for(let{children:i,positions:l}=o._tree,c=t>0?i.length:-1;e!=c;e+=t){let u=i[e],h=l[e]+o.from;if(oU(a,s,h,h+u.length)){if(u instanceof _u){if(r&Ca.ExcludeBuffers)continue;let m=u.findChild(0,u.buffer.length,t,s-h,a);if(m>-1)return new Fl(new DCe(o,u,e,h),null,m)}else if(r&Ca.IncludeAnonymous||!u.type.isAnonymous||F3(u)){let m;if(!(r&Ca.IgnoreMounts)&&(m=jy.get(u))&&!m.overlay)return new mo(m.tree,h,e,o);let f=new mo(u,h,e,o);return r&Ca.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(t<0?u.children.length-1:0,t,s,a)}}}if(r&Ca.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,s=0){let a;if(!(s&Ca.IgnoreOverlays)&&(a=jy.get(this._tree))&&a.overlay){let r=e-this.from;for(let{from:o,to:i}of a.overlay)if((t>0?o<=r:o<r)&&(t<0?i>=r:i>r))return new mo(a.tree,a.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,s)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function TT(n,e,t,s){let a=n.cursor(),r=[];if(!a.firstChild())return r;if(t!=null){for(let o=!1;!o;)if(o=a.type.is(t),!a.nextSibling())return r}for(;;){if(s!=null&&a.type.is(s))return r;if(a.type.is(e)&&r.push(a.node),!a.nextSibling())return s==null?r:[]}}function XS(n,e,t=e.length-1){for(let s=n;t>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(e[t]&&e[t]!=s.name)return!1;t--}}return!0}class DCe{constructor(e,t,s,a){this.parent=e,this.buffer=t,this.index=s,this.start=a}}class Fl extends iU{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,s){super(),this.context=e,this._parent=t,this.index=s,this.type=e.buffer.set.types[e.buffer.buffer[s]]}child(e,t,s){let{buffer:a}=this.context,r=a.findChild(this.index+4,a.buffer[this.index+3],e,t-this.context.start,s);return r<0?null:new Fl(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,s=0){if(s&Ca.ExcludeBuffers)return null;let{buffer:a}=this.context,r=a.findChild(this.index+4,a.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return r<0?null:new Fl(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Fl(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Fl(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:s}=this.context,a=this.index+4,r=s.buffer[this.index+3];if(r>a){let o=s.buffer[this.index+1];e.push(s.slice(a,r,o)),t.push(0)}return new Oa(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function lU(n){if(!n.length)return null;let e=0,t=n[0];for(let r=1;r<n.length;r++){let o=n[r];(o.from>t.from||o.to<t.to)&&(t=o,e=r)}let s=t instanceof mo&&t.index<0?null:t.parent,a=n.slice();return s?a[e]=s:a.splice(e,1),new TCe(a,t)}class TCe{constructor(e,t){this.heads=e,this.node=t}get next(){return lU(this.heads)}}function FCe(n,e,t){let s=n.resolveInner(e,t),a=null;for(let r=s instanceof mo?s:s.context.parent;r;r=r.parent)if(r.index<0){let o=r.parent;(a||(a=[s])).push(o.resolve(e,t)),r=o}else{let o=jy.get(r.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let i=new mo(o.tree,o.overlay[0].from+r.from,-1,r);(a||(a=[s])).push(bg(i,e,t,!1))}}return a?lU(a):s}class WS{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof mo)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let s=e._parent;s;s=s._parent)this.stack.unshift(s.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:s,buffer:a}=this.buffer;return this.type=t||a.set.types[a.buffer[e]],this.from=s+a.buffer[e+1],this.to=s+a.buffer[e+2],!0}yield(e){return e?e instanceof mo?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,s){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,s,this.mode));let{buffer:a}=this.buffer,r=a.findChild(this.index+4,a.buffer[this.index+3],e,t-this.buffer.start,s);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,s=this.mode){return this.buffer?s&Ca.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,s))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ca.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ca.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,s=this.stack.length-1;if(e<0){let a=s<0?0:this.stack[s]+4;if(this.index!=a)return this.yieldBuf(t.findChild(a,this.index,-1,0,4))}else{let a=t.buffer[this.index+3];if(a<(s<0?t.buffer.length:t.buffer[this.stack[s]+3]))return this.yieldBuf(a)}return s<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,s,{buffer:a}=this;if(a){if(e>0){if(this.index<a.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(a.buffer.buffer[r+3]<this.index)return!1;({index:t,parent:s}=a)}else({index:t,_parent:s}=this._tree);for(;s;{index:t,_parent:s}=s)if(t>-1)for(let r=t+e,o=e<0?-1:s._tree.children.length;r!=o;r+=e){let i=s._tree.children[r];if(this.mode&Ca.IncludeAnonymous||i instanceof _u||!i.type.isAnonymous||F3(i))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,s=0;if(e&&e.context==this.buffer)e:for(let a=this.index,r=this.stack.length;r>=0;){for(let o=e;o;o=o._parent)if(o.index==a){if(a==this.index)return o;t=o,s=r+1;break e}a=this.stack[--r]}for(let a=s;a<this.stack.length;a++)t=new Fl(this.buffer,t,this.stack[a]);return this.bufferNode=new Fl(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let s=0;;){let a=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){s++;continue}this.type.isAnonymous||(a=!0)}for(;;){if(a&&t&&t(this),a=this.type.isAnonymous,!s)return;if(this.nextSibling())break;this.parent(),s--,a=!0}}}matchContext(e){if(!this.buffer)return XS(this.node.parent,e);let{buffer:t}=this.buffer,{types:s}=t.set;for(let a=e.length-1,r=this.stack.length-1;a>=0;r--){if(r<0)return XS(this._tree,e,a);let o=s[t.buffer[this.stack[r]]];if(!o.isAnonymous){if(e[a]&&e[a]!=o.name)return!1;a--}}return!0}}function F3(n){return n.children.some(e=>e instanceof _u||!e.type.isAnonymous||F3(e))}function NCe(n){var e;let{buffer:t,nodeSet:s,maxBufferLength:a=rU,reused:r=[],minRepeatType:o=s.types.length}=n,i=Array.isArray(t)?new T3(t,t.length):t,l=s.types,c=0,u=0;function h(F,_,$,Z,ce,U){let{id:ue,start:W,end:de,size:be}=i,ke=u,Ce=c;for(;be<0;)if(i.next(),be==-1){let je=r[ue];$.push(je),Z.push(W-F);return}else if(be==-3){c=ue;return}else if(be==-4){u=ue;return}else throw new RangeError(`Unrecognized record size: ${be}`);let Ae=l[ue],q,Ne,Re=W-F;if(de-W<=a&&(Ne=k(i.pos-_,ce))){let je=new Uint16Array(Ne.size-Ne.skip),me=i.pos-Ne.size,Ye=je.length;for(;i.pos>me;)Ye=M(Ne.start,je,Ye);q=new _u(je,de-Ne.start,s),Re=Ne.start-F}else{let je=i.pos-be;i.next();let me=[],Ye=[],ft=ue>=o?ue:-1,_e=0,Ge=de;for(;i.pos>je;)ft>=0&&i.id==ft&&i.size>=0?(i.end<=Ge-a&&(v(me,Ye,W,_e,i.end,Ge,ft,ke,Ce),_e=me.length,Ge=i.end),i.next()):U>2500?m(W,je,me,Ye):h(W,je,me,Ye,ft,U+1);if(ft>=0&&_e>0&&_e<me.length&&v(me,Ye,W,_e,W,Ge,ft,ke,Ce),me.reverse(),Ye.reverse(),ft>-1&&_e>0){let pt=f(Ae,Ce);q=N3(Ae,me,Ye,0,me.length,0,de-W,pt,pt)}else q=O(Ae,me,Ye,de-W,ke-de,Ce)}$.push(q),Z.push(Re)}function m(F,_,$,Z){let ce=[],U=0,ue=-1;for(;i.pos>_;){let{id:W,start:de,end:be,size:ke}=i;if(ke>4)i.next();else{if(ue>-1&&de<ue)break;ue<0&&(ue=be-a),ce.push(W,de,be),U++,i.next()}}if(U){let W=new Uint16Array(U*4),de=ce[ce.length-2];for(let be=ce.length-3,ke=0;be>=0;be-=3)W[ke++]=ce[be],W[ke++]=ce[be+1]-de,W[ke++]=ce[be+2]-de,W[ke++]=ke;$.push(new _u(W,ce[2]-de,s)),Z.push(de-F)}}function f(F,_){return($,Z,ce)=>{let U=0,ue=$.length-1,W,de;if(ue>=0&&(W=$[ue])instanceof Oa){if(!ue&&W.type==F&&W.length==ce)return W;(de=W.prop(Zn.lookAhead))&&(U=Z[ue]+W.length+de)}return O(F,$,Z,ce,U,_)}}function v(F,_,$,Z,ce,U,ue,W,de){let be=[],ke=[];for(;F.length>Z;)be.push(F.pop()),ke.push(_.pop()+$-ce);F.push(O(s.types[ue],be,ke,U-ce,W-U,de)),_.push(ce-$)}function O(F,_,$,Z,ce,U,ue){if(U){let W=[Zn.contextHash,U];ue=ue?[W].concat(ue):[W]}if(ce>25){let W=[Zn.lookAhead,ce];ue=ue?[W].concat(ue):[W]}return new Oa(F,_,$,Z,ue)}function k(F,_){let $=i.fork(),Z=0,ce=0,U=0,ue=$.end-a,W={size:0,start:0,skip:0};e:for(let de=$.pos-F;$.pos>de;){let be=$.size;if($.id==_&&be>=0){W.size=Z,W.start=ce,W.skip=U,U+=4,Z+=4,$.next();continue}let ke=$.pos-be;if(be<0||ke<de||$.start<ue)break;let Ce=$.id>=o?4:0,Ae=$.start;for($.next();$.pos>ke;){if($.size<0)if($.size==-3)Ce+=4;else break e;else $.id>=o&&(Ce+=4);$.next()}ce=Ae,Z+=be,U+=Ce}return(_<0||Z==F)&&(W.size=Z,W.start=ce,W.skip=U),W.size>4?W:void 0}function M(F,_,$){let{id:Z,start:ce,end:U,size:ue}=i;if(i.next(),ue>=0&&Z<o){let W=$;if(ue>4){let de=i.pos-(ue-4);for(;i.pos>de;)$=M(F,_,$)}_[--$]=W,_[--$]=U-F,_[--$]=ce-F,_[--$]=Z}else ue==-3?c=Z:ue==-4&&(u=Z);return $}let E=[],I=[];for(;i.pos>0;)h(n.start||0,n.bufferStart||0,E,I,-1,0);let D=(e=n.length)!==null&&e!==void 0?e:E.length?I[0]+E[0].length:0;return new Oa(l[n.topID],E.reverse(),I.reverse(),D)}const FT=new WeakMap;function d1(n,e){if(!n.isAnonymous||e instanceof _u||e.type!=n)return 1;let t=FT.get(e);if(t==null){t=1;for(let s of e.children){if(s.type!=n||!(s instanceof Oa)){t=1;break}t+=d1(n,s)}FT.set(e,t)}return t}function N3(n,e,t,s,a,r,o,i,l){let c=0;for(let v=s;v<a;v++)c+=d1(n,e[v]);let u=Math.ceil(c*1.5/8),h=[],m=[];function f(v,O,k,M,E){for(let I=k;I<M;){let D=I,F=O[I],_=d1(n,v[I]);for(I++;I<M;I++){let $=d1(n,v[I]);if(_+$>=u)break;_+=$}if(I==D+1){if(_>u){let $=v[D];f($.children,$.positions,0,$.children.length,O[D]+E);continue}h.push(v[D])}else{let $=O[I-1]+v[I-1].length-F;h.push(N3(n,v,O,D,I,F,$,null,l))}m.push(F+E-r)}}return f(e,t,s,a,0),(i||l)(h,m,o)}class BCe{constructor(){this.map=new WeakMap}setBuffer(e,t,s){let a=this.map.get(e);a||this.map.set(e,a=new Map),a.set(t,s)}getBuffer(e,t){let s=this.map.get(e);return s&&s.get(t)}set(e,t){e instanceof Fl?this.setBuffer(e.context.buffer,e.index,t):e instanceof mo&&this.map.set(e.tree,t)}get(e){return e instanceof Fl?this.getBuffer(e.context.buffer,e.index):e instanceof mo?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class Eh{constructor(e,t,s,a,r=!1,o=!1){this.from=e,this.to=t,this.tree=s,this.offset=a,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],s=!1){let a=[new Eh(0,e.length,e,0,!1,s)];for(let r of t)r.to>e.length&&a.push(r);return a}static applyChanges(e,t,s=128){if(!t.length)return e;let a=[],r=1,o=e.length?e[0]:null;for(let i=0,l=0,c=0;;i++){let u=i<t.length?t[i]:null,h=u?u.fromA:1e9;if(h-l>=s)for(;o&&o.from<h;){let m=o;if(l>=m.from||h<=m.to||c){let f=Math.max(m.from,l)-c,v=Math.min(m.to,h)-c;m=f>=v?null:new Eh(f,v,m.tree,m.offset+c,i>0,!!u)}if(m&&a.push(m),o.to>h)break;o=r<e.length?e[r++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return a}}class cU{startParse(e,t,s){return typeof e=="string"&&(e=new $Ce(e)),s=s?s.length?s.map(a=>new mk(a.from,a.to)):[new mk(0,0)]:[new mk(0,e.length)],this.createParse(e,t||[],s)}parse(e,t,s){let a=this.startParse(e,t,s);for(;;){let r=a.advance();if(r)return r}}}class $Ce{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Zn({perNode:!0});let RCe=0;class ni{constructor(e,t,s,a){this.name=e,this.set=t,this.base=s,this.modified=a,this.id=RCe++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let s=typeof e=="string"?e:"?";if(e instanceof ni&&(t=e),t==null?void 0:t.base)throw new Error("Can not derive from a modified tag");let a=new ni(s,[],null,[]);if(a.set.push(a),t)for(let r of t.set)a.set.push(r);return a}static defineModifier(e){let t=new Zy(e);return s=>s.modified.indexOf(t)>-1?s:Zy.get(s.base||s,s.modified.concat(t).sort((a,r)=>a.id-r.id))}}let _Ce=0;class Zy{constructor(e){this.name=e,this.instances=[],this.id=_Ce++}static get(e,t){if(!t.length)return e;let s=t[0].instances.find(i=>i.base==e&&LCe(t,i.modified));if(s)return s;let a=[],r=new ni(e.name,a,e,t);for(let i of t)i.instances.push(r);let o=ICe(t);for(let i of e.set)if(!i.modified.length)for(let l of o)a.push(Zy.get(i,l));return r}}function LCe(n,e){return n.length==e.length&&n.every((t,s)=>t==e[s])}function ICe(n){let e=[[]];for(let t=0;t<n.length;t++)for(let s=0,a=e.length;s<a;s++)e.push(e[s].concat(n[t]));return e.sort((t,s)=>s.length-t.length)}function uU(n){let e=Object.create(null);for(let t in n){let s=n[t];Array.isArray(s)||(s=[s]);for(let a of t.split(" "))if(a){let r=[],o=2,i=a;for(let h=0;;){if(i=="..."&&h>0&&h+3==a.length){o=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(i);if(!m)throw new RangeError("Invalid path: "+a);if(r.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),h+=m[0].length,h==a.length)break;let f=a[h++];if(h==a.length&&f=="!"){o=0;break}if(f!="/")throw new RangeError("Invalid path: "+a);i=a.slice(h)}let l=r.length-1,c=r[l];if(!c)throw new RangeError("Invalid path: "+a);let u=new zy(s,o,l>0?r.slice(0,l):null);e[c]=u.sort(e[c])}}return hU.add(e)}const hU=new Zn;class zy{constructor(e,t,s,a){this.tags=e,this.mode=t,this.context=s,this.next=a}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}zy.empty=new zy([],2,null);function dU(n,e){let t=Object.create(null);for(let r of n)if(!Array.isArray(r.tag))t[r.tag.id]=r.class;else for(let o of r.tag)t[o.id]=r.class;let{scope:s,all:a=null}=e||{};return{style:r=>{let o=a;for(let i of r)for(let l of i.set){let c=t[l.id];if(c){o=o?o+" "+c:c;break}}return o},scope:s}}function QCe(n,e){let t=null;for(let s of n){let a=s.style(e);a&&(t=t?t+" "+a:a)}return t}function VCe(n,e,t,s=0,a=n.length){let r=new jCe(s,Array.isArray(e)?e:[e],t);r.highlightRange(n.cursor(),s,a,"",r.highlighters),r.flush(a)}class jCe{constructor(e,t,s){this.at=e,this.highlighters=t,this.span=s,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,s,a,r){let{type:o,from:i,to:l}=e;if(i>=s||l<=t)return;o.isTop&&(r=this.highlighters.filter(f=>!f.scope||f.scope(o)));let c=a,u=ZCe(e)||zy.empty,h=QCe(r,u.tags);if(h&&(c&&(c+=" "),c+=h,u.mode==1&&(a+=(a?" ":"")+h)),this.startSpan(Math.max(t,i),c),u.opaque)return;let m=e.tree&&e.tree.prop(Zn.mounted);if(m&&m.overlay){let f=e.node.enter(m.overlay[0].from+i,1),v=this.highlighters.filter(k=>!k.scope||k.scope(m.tree.type)),O=e.firstChild();for(let k=0,M=i;;k++){let E=k<m.overlay.length?m.overlay[k]:null,I=E?E.from+i:l,D=Math.max(t,M),F=Math.min(s,I);if(D<F&&O)for(;e.from<F&&(this.highlightRange(e,D,F,a,r),this.startSpan(Math.min(F,e.to),c),!(e.to>=I||!e.nextSibling())););if(!E||I>s)break;M=E.to+i,M>t&&(this.highlightRange(f.cursor(),Math.max(t,E.from+i),Math.min(s,M),"",v),this.startSpan(Math.min(s,M),c))}O&&e.parent()}else if(e.firstChild()){m&&(a="");do if(!(e.to<=t)){if(e.from>=s)break;this.highlightRange(e,t,s,a,r),this.startSpan(Math.min(s,e.to),c)}while(e.nextSibling());e.parent()}}}function ZCe(n){let e=n.type.prop(hU);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const kt=ni.define,hb=kt(),Jc=kt(),NT=kt(Jc),BT=kt(Jc),eu=kt(),db=kt(eu),pk=kt(eu),vl=kt(),eh=kt(vl),gl=kt(),bl=kt(),qS=kt(),$p=kt(qS),mb=kt(),w={comment:hb,lineComment:kt(hb),blockComment:kt(hb),docComment:kt(hb),name:Jc,variableName:kt(Jc),typeName:NT,tagName:kt(NT),propertyName:BT,attributeName:kt(BT),className:kt(Jc),labelName:kt(Jc),namespace:kt(Jc),macroName:kt(Jc),literal:eu,string:db,docString:kt(db),character:kt(db),attributeValue:kt(db),number:pk,integer:kt(pk),float:kt(pk),bool:kt(eu),regexp:kt(eu),escape:kt(eu),color:kt(eu),url:kt(eu),keyword:gl,self:kt(gl),null:kt(gl),atom:kt(gl),unit:kt(gl),modifier:kt(gl),operatorKeyword:kt(gl),controlKeyword:kt(gl),definitionKeyword:kt(gl),moduleKeyword:kt(gl),operator:bl,derefOperator:kt(bl),arithmeticOperator:kt(bl),logicOperator:kt(bl),bitwiseOperator:kt(bl),compareOperator:kt(bl),updateOperator:kt(bl),definitionOperator:kt(bl),typeOperator:kt(bl),controlOperator:kt(bl),punctuation:qS,separator:kt(qS),bracket:$p,angleBracket:kt($p),squareBracket:kt($p),paren:kt($p),brace:kt($p),content:vl,heading:eh,heading1:kt(eh),heading2:kt(eh),heading3:kt(eh),heading4:kt(eh),heading5:kt(eh),heading6:kt(eh),contentSeparator:kt(vl),list:kt(vl),quote:kt(vl),emphasis:kt(vl),strong:kt(vl),link:kt(vl),monospace:kt(vl),strikethrough:kt(vl),inserted:kt(),deleted:kt(),changed:kt(),invalid:kt(),meta:mb,documentMeta:kt(mb),annotation:kt(mb),processingInstruction:kt(mb),definition:ni.defineModifier("definition"),constant:ni.defineModifier("constant"),function:ni.defineModifier("function"),standard:ni.defineModifier("standard"),local:ni.defineModifier("local"),special:ni.defineModifier("special")};for(let n in w){let e=w[n];e instanceof ni&&(e.name=n)}dU([{tag:w.link,class:"tok-link"},{tag:w.heading,class:"tok-heading"},{tag:w.emphasis,class:"tok-emphasis"},{tag:w.strong,class:"tok-strong"},{tag:w.keyword,class:"tok-keyword"},{tag:w.atom,class:"tok-atom"},{tag:w.bool,class:"tok-bool"},{tag:w.url,class:"tok-url"},{tag:w.labelName,class:"tok-labelName"},{tag:w.inserted,class:"tok-inserted"},{tag:w.deleted,class:"tok-deleted"},{tag:w.literal,class:"tok-literal"},{tag:w.string,class:"tok-string"},{tag:w.number,class:"tok-number"},{tag:[w.regexp,w.escape,w.special(w.string)],class:"tok-string2"},{tag:w.variableName,class:"tok-variableName"},{tag:w.local(w.variableName),class:"tok-variableName tok-local"},{tag:w.definition(w.variableName),class:"tok-variableName tok-definition"},{tag:w.special(w.variableName),class:"tok-variableName2"},{tag:w.definition(w.propertyName),class:"tok-propertyName tok-definition"},{tag:w.typeName,class:"tok-typeName"},{tag:w.namespace,class:"tok-namespace"},{tag:w.className,class:"tok-className"},{tag:w.macroName,class:"tok-macroName"},{tag:w.propertyName,class:"tok-propertyName"},{tag:w.operator,class:"tok-operator"},{tag:w.comment,class:"tok-comment"},{tag:w.meta,class:"tok-meta"},{tag:w.invalid,class:"tok-invalid"},{tag:w.punctuation,class:"tok-punctuation"}]);var fk;const Pd=new Zn;function mU(n){return Qt.define({combine:n?e=>e.concat(n):void 0})}const B3=new Zn;class di{constructor(e,t,s=[],a=""){this.data=e,this.name=a,as.prototype.hasOwnProperty("tree")||Object.defineProperty(as.prototype,"tree",{get(){return Ka(this)}}),this.parser=t,this.extension=[Pm.of(this),as.languageData.of((r,o,i)=>{let l=$T(r,o,i),c=l.type.prop(Pd);if(!c)return[];let u=r.facet(c),h=l.type.prop(B3);if(h){let m=l.resolve(o-l.from,i);for(let f of h)if(f.test(m,r)){let v=r.facet(f.facet);return f.type=="replace"?v:v.concat(u)}}return u})].concat(s)}isActiveAt(e,t,s=-1){return $T(e,t,s).type.prop(Pd)==this.data}findRegions(e){let t=e.facet(Pm);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let s=[],a=(r,o)=>{if(r.prop(Pd)==this.data){s.push({from:o,to:o+r.length});return}let i=r.prop(Zn.mounted);if(i){if(i.tree.prop(Pd)==this.data){if(i.overlay)for(let l of i.overlay)s.push({from:l.from+o,to:l.to+o});else s.push({from:o,to:o+r.length});return}else if(i.overlay){let l=s.length;if(a(i.tree,i.overlay[0].from+o),s.length>l)return}}for(let l=0;l<r.children.length;l++){let c=r.children[l];c instanceof Oa&&a(c,r.positions[l]+o)}};return a(Ka(e),0),s}get allowsNesting(){return!0}}di.setState=hn.define();function $T(n,e,t){let s=n.facet(Pm),a=Ka(n).topNode;if(!s||s.allowsNesting)for(let r=a;r;r=r.enter(e,t,Ca.ExcludeBuffers))r.type.isTop&&(a=r);return a}class Gy extends di{constructor(e,t,s){super(e,t,[],s),this.parser=t}static define(e){let t=mU(e.languageData);return new Gy(t,e.parser.configure({props:[Pd.add(s=>s.isTop?t:void 0)]}),e.name)}configure(e,t){return new Gy(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ka(n){let e=n.field(di.state,!1);return e?e.tree:Oa.empty}function pU(n,e,t=50){var s;let a=(s=n.field(di.state,!1))===null||s===void 0?void 0:s.context;if(!a)return null;let r=a.viewport;a.updateViewport({from:0,to:e});let o=a.isDone(e)||a.work(t,e)?a.tree:null;return a.updateViewport(r),o}class zCe{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let s=this.cursorPos-this.string.length;return e<s||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-s,t-s)}}let Rp=null;class Xy{constructor(e,t,s=[],a,r,o,i,l){this.parser=e,this.state=t,this.fragments=s,this.tree=a,this.treeLen=r,this.viewport=o,this.skipped=i,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,s){return new Xy(e,t,[],Oa.empty,0,s,[],null)}startParse(){return this.parser.startParse(new zCe(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Oa.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var s;if(typeof e=="number"){let a=Date.now()+e;e=()=>Date.now()>a}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let a=this.parse.advance();if(a)if(this.fragments=this.withoutTempSkipped(Eh.addTree(a,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(s=this.parse.stoppedAt)!==null&&s!==void 0?s:this.state.doc.length,this.tree=a,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Eh.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Rp;Rp=this;try{return e()}finally{Rp=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=RT(e,t.from,t.to);return e}changes(e,t){let{fragments:s,tree:a,treeLen:r,viewport:o,skipped:i}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,u,h,m)=>l.push({fromA:c,toA:u,fromB:h,toB:m})),s=Eh.applyChanges(s,l),a=Oa.empty,r=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){i=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),h=e.mapPos(c.to,-1);u<h&&i.push({from:u,to:h})}}}return new Xy(this.parser,t,s,a,r,o,i,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:a,to:r}=this.skipped[s];a<e.to&&r>e.from&&(this.fragments=RT(this.fragments,a,r),this.skipped.splice(s--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends cU{createParse(t,s,a){let r=a[0].from,o=a[a.length-1].to;return{parsedPos:r,advance(){let i=Rp;if(i){for(let l of a)i.tempSkipped.push(l);e&&(i.scheduleOn=i.scheduleOn?Promise.all([i.scheduleOn,e]):e)}return this.parsedPos=o,new Oa(bo.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Rp}}function RT(n,e,t){return Eh.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class km{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),s=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,s)||t.takeTree(),new km(t)}static init(e){let t=Math.min(3e3,e.doc.length),s=Xy.create(e.facet(Pm).parser,e,{from:0,to:t});return s.work(20,t)||s.takeTree(),new km(s)}}di.state=Js.define({create:km.init,update(n,e){for(let t of e.effects)if(t.is(di.setState))return t.value;return e.startState.facet(Pm)!=e.state.facet(Pm)?km.init(e.state):n.apply(e)}});let fU=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(fU=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const gk=typeof navigator<"u"&&!((fk=navigator.scheduling)===null||fk===void 0)&&fk.isInputPending?()=>navigator.scheduling.isInputPending():null,GCe=ra.fromClass(class{constructor(n){this.view=n,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(n){let e=this.view.state.field(di.state).context;(e.updateViewport(n.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(n.docChanged||n.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:n}=this.view,e=n.field(di.state);(e.tree!=e.context.tree||!e.context.isDone(n.doc.length))&&(this.working=fU(this.work))}work(n){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:t,viewport:{to:s}}=this.view,a=t.field(di.state);if(a.tree==a.context.tree&&a.context.isDone(s+1e5))return;let r=Date.now()+Math.min(this.chunkBudget,100,n&&!gk?Math.max(25,n.timeRemaining()-5):1e9),o=a.context.treeLen<s&&t.doc.length>s+1e3,i=a.context.work(()=>gk&&gk()||Date.now()>r,s+(o?0:1e5));this.chunkBudget-=Date.now()-e,(i||this.chunkBudget<=0)&&(a.context.takeTree(),this.view.dispatch({effects:di.setState.of(new km(a.context))})),this.chunkBudget>0&&!(i&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(a.context)}checkAsyncSchedule(n){n.scheduleOn&&(this.workScheduled++,n.scheduleOn.then(()=>this.scheduleWork()).catch(e=>co(this.view.state,e)).then(()=>this.workScheduled--),n.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Pm=Qt.define({combine(n){return n.length?n[0]:null},enables:n=>[di.state,GCe,vt.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class XCe{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const WCe=Qt.define(),Sm=Qt.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function Wy(n){let e=n.facet(Sm);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function qy(n,e){let t="",s=n.tabSize,a=n.facet(Sm)[0];if(a=="	"){for(;e>=s;)t+="	",e-=s;a=" "}for(let r=0;r<e;r++)t+=a;return t}function gU(n,e){n instanceof as&&(n=new Nw(n));for(let s of n.state.facet(WCe)){let a=s(n,e);if(a!==void 0)return a}let t=Ka(n.state);return t.length>=e?qCe(n,t,e):null}class Nw{constructor(e,t={}){this.state=e,this.options=t,this.unit=Wy(e)}lineAt(e,t=1){let s=this.state.doc.lineAt(e),{simulateBreak:a,simulateDoubleBreak:r}=this.options;return a!=null&&a>=s.from&&a<=s.to?r&&a==e?{text:"",from:e}:(t<0?a<e:a<=e)?{text:s.text.slice(a-s.from),from:a}:{text:s.text.slice(0,a-s.from),from:s.from}:s}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:s,from:a}=this.lineAt(e,t);return s.slice(e-a,Math.min(s.length,e+100-a))}column(e,t=1){let{text:s,from:a}=this.lineAt(e,t),r=this.countColumn(s,e-a),o=this.options.overrideIndentation?this.options.overrideIndentation(a):-1;return o>-1&&(r+=o-this.countColumn(s,s.search(/\S|$/))),r}countColumn(e,t=e.length){return ep(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:s,from:a}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){let o=r(a);if(o>-1)return o}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const bU=new Zn;function qCe(n,e,t){let s=e.resolveStack(t),a=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(a!=s.node){let r=[];for(let o=a;o&&!(o.from==s.node.from&&o.type==s.node.type);o=o.parent)r.push(o);for(let o=r.length-1;o>=0;o--)s={node:r[o],next:s}}return yU(s,n,t)}function yU(n,e,t){for(let s=n;s;s=s.next){let a=HCe(s.node);if(a)return a($3.create(e,t,s))}return 0}function UCe(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function HCe(n){let e=n.type.prop(bU);if(e)return e;let t=n.firstChild,s;if(t&&(s=t.type.prop(Zn.closedBy))){let a=n.lastChild,r=a&&s.indexOf(a.name)>-1;return o=>vU(o,!0,1,void 0,r&&!UCe(o)?a.from:void 0)}return n.parent==null?YCe:null}function YCe(){return 0}class $3 extends Nw{constructor(e,t,s){super(e.state,e.options),this.base=e,this.pos=t,this.context=s}get node(){return this.context.node}static create(e,t,s){return new $3(e,t,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let s=e.resolve(t.from);for(;s.parent&&s.parent.from==s.from;)s=s.parent;if(KCe(s,e))break;t=this.state.doc.lineAt(s.from)}return this.lineIndent(t.from)}continue(){return yU(this.context.next,this.base,this.pos)}}function KCe(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function JCe(n){let e=n.node,t=e.childAfter(e.from),s=e.lastChild;if(!t)return null;let a=n.options.simulateBreak,r=n.state.doc.lineAt(t.from),o=a==null||a<=r.from?r.to:Math.min(r.to,a);for(let i=t.to;;){let l=e.childAfter(i);if(!l||l==s)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let c=/^ */.exec(r.text.slice(t.to-r.from))[0].length;return{from:t.from,to:t.to+c}}i=l.to}}function eMe({closing:n,align:e=!0,units:t=1}){return s=>vU(s,e,t,n)}function vU(n,e,t,s,a){let r=n.textAfter,o=r.match(/^\s*/)[0].length,i=s&&r.slice(o,o+s.length)==s||a==n.pos+o,l=e?JCe(n):null;return l?i?n.column(l.from):n.column(l.to):n.baseIndent+(i?0:n.unit*t)}const tMe=n=>n.baseIndent;function bk({except:n,units:e=1}={}){return t=>{let s=n&&n.test(t.textAfter);return t.baseIndent+(s?0:e*t.unit)}}const nMe=Qt.define(),wU=new Zn;function sMe(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function aMe(n,e,t){let s=Ka(n);if(s.length<t)return null;let a=s.resolveStack(t,1),r=null;for(let o=a;o;o=o.next){let i=o.node;if(i.to<=t||i.from>t)continue;if(r&&i.from<e)break;let l=i.type.prop(wU);if(l&&(i.to<s.length-50||s.length==n.doc.length||!rMe(i))){let c=l(i,n);c&&c.from<=t&&c.from>=e&&c.to>t&&(r=c)}}return r}function rMe(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function OU(n,e,t){for(let s of n.facet(nMe)){let a=s(n,e,t);if(a)return a}return aMe(n,e,t)}function xU(n,e){let t=e.mapPos(n.from,1),s=e.mapPos(n.to,-1);return t>=s?void 0:{from:t,to:s}}const R3=hn.define({map:xU}),Bw=hn.define({map:xU});function kU(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(s=>s.from<=t&&s.to>=t)||e.push(n.lineBlockAt(t));return e}const o0=Js.define({create(){return en.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(R3)&&!oMe(n,t.value.from,t.value.to)){let{preparePlaceholder:s}=e.state.facet(AU),a=s?en.replace({widget:new dMe(s(e.state,t.value))}):_T;n=n.update({add:[a.range(t.value.from,t.value.to)]})}else t.is(Bw)&&(n=n.update({filter:(s,a)=>t.value.from!=s||t.value.to!=a,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:s}=e.selection.main;n.between(s,s,(a,r)=>{a<s&&r>s&&(t=!0)}),t&&(n=n.update({filterFrom:s,filterTo:s,filter:(a,r)=>r<=s||a>=s}))}return n},provide:n=>vt.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(s,a)=>{t.push(s,a)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let s=n[t++],a=n[t++];if(typeof s!="number"||typeof a!="number")throw new RangeError("Invalid JSON for fold state");e.push(_T.range(s,a))}return en.set(e,!0)}});function PU(n,e,t){var s;let a=null;return(s=n.field(o0,!1))===null||s===void 0||s.between(e,t,(r,o)=>{(!a||a.from>r)&&(a={from:r,to:o})}),a}function oMe(n,e,t){let s=!1;return n.between(e,e,(a,r)=>{a==e&&r==t&&(s=!0)}),s}function SU(n,e){return n.field(o0,!1)?e:e.concat(hn.appendConfig.of(hMe()))}const CU=n=>{for(let e of kU(n)){let t=OU(n.state,e.from,e.to);if(t)return n.dispatch({effects:SU(n.state,[R3.of(t),MU(n,t)])}),!0}return!1},iMe=n=>{if(!n.state.field(o0,!1))return!1;let e=[];for(let t of kU(n)){let s=PU(n.state,t.from,t.to);s&&e.push(Bw.of(s),MU(n,s,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function MU(n,e,t=!0){let s=n.state.doc.lineAt(e.from).number,a=n.state.doc.lineAt(e.to).number;return vt.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${s} ${n.state.phrase("to")} ${a}.`)}const lMe=n=>{let{state:e}=n,t=[];for(let s=0;s<e.doc.length;){let a=n.lineBlockAt(s),r=OU(e,a.from,a.to);r&&t.push(R3.of(r)),s=(r?n.lineBlockAt(r.to):a).to+1}return t.length&&n.dispatch({effects:SU(n.state,t)}),!!t.length},cMe=n=>{let e=n.state.field(o0,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(s,a)=>{t.push(Bw.of({from:s,to:a}))}),n.dispatch({effects:t}),!0},uMe={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},AU=Qt.define({combine(n){return Gc(n,uMe)}});function hMe(n){return[o0,mMe]}function EU(n,e){let{state:t}=n,s=t.facet(AU),a=o=>{let i=n.lineBlockAt(n.posAtDOM(o.target)),l=PU(n.state,i.from,i.to);l&&n.dispatch({effects:Bw.of(l)}),o.preventDefault()};if(s.placeholderDOM)return s.placeholderDOM(n,a,e);let r=document.createElement("span");return r.textContent=s.placeholderText,r.setAttribute("aria-label",t.phrase("folded code")),r.title=t.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=a,r}const _T=en.replace({widget:new class extends cl{toDOM(n){return EU(n,null)}}});class dMe extends cl{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return EU(e,this.value)}}const mMe=vt.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class i0{constructor(e,t){this.specs=e;let s;function a(i){let l=Fu.newName();return(s||(s=Object.create(null)))["."+l]=i,l}const r=typeof t.all=="string"?t.all:t.all?a(t.all):void 0,o=t.scope;this.scope=o instanceof di?i=>i.prop(Pd)==o.data:o?i=>i==o:void 0,this.style=dU(e.map(i=>({tag:i.tag,class:i.class||a(Object.assign({},i,{tag:null}))})),{all:r}).style,this.module=s?new Fu(s):null,this.themeType=t.themeType}static define(e,t){return new i0(e,t||{})}}const US=Qt.define(),DU=Qt.define({combine(n){return n.length?[n[0]]:null}});function yk(n){let e=n.facet(US);return e.length?e:n.facet(DU)}function _3(n,e){let t=[fMe],s;return n instanceof i0&&(n.module&&t.push(vt.styleModule.of(n.module)),s=n.themeType),e!=null&&e.fallback?t.push(DU.of(n)):s?t.push(US.computeN([vt.darkTheme],a=>a.facet(vt.darkTheme)==(s=="dark")?[n]:[])):t.push(US.of(n)),t}class pMe{constructor(e){this.markCache=Object.create(null),this.tree=Ka(e.state),this.decorations=this.buildDeco(e,yk(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Ka(e.state),s=yk(e.state),a=s!=yk(e.startState),{viewport:r}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<r.to&&!a&&t.type==this.tree.type&&o>=r.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||a)&&(this.tree=t,this.decorations=this.buildDeco(e.view,s),this.decoratedTo=r.to)}buildDeco(e,t){if(!t||!this.tree.length)return en.none;let s=new Gl;for(let{from:a,to:r}of e.visibleRanges)VCe(this.tree,t,(o,i,l)=>{s.add(o,i,this.markCache[l]||(this.markCache[l]=en.mark({class:l})))},a,r);return s.finish()}}const fMe=yo.high(ra.fromClass(pMe,{decorations:n=>n.decorations})),TU=i0.define([{tag:w.meta,color:"#404740"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,textDecoration:"underline",fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.strong,fontWeight:"bold"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.keyword,color:"#708"},{tag:[w.atom,w.bool,w.url,w.contentSeparator,w.labelName],color:"#219"},{tag:[w.literal,w.inserted],color:"#164"},{tag:[w.string,w.deleted],color:"#a11"},{tag:[w.regexp,w.escape,w.special(w.string)],color:"#e40"},{tag:w.definition(w.variableName),color:"#00f"},{tag:w.local(w.variableName),color:"#30a"},{tag:[w.typeName,w.namespace],color:"#085"},{tag:w.className,color:"#167"},{tag:[w.special(w.variableName),w.macroName],color:"#256"},{tag:w.definition(w.propertyName),color:"#00c"},{tag:w.comment,color:"#940"},{tag:w.invalid,color:"#f00"}]),gMe=vt.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),FU=1e4,NU="()[]{}",BU=Qt.define({combine(n){return Gc(n,{afterCursor:!0,brackets:NU,maxScanDistance:FU,renderMatch:vMe})}}),bMe=en.mark({class:"cm-matchingBracket"}),yMe=en.mark({class:"cm-nonmatchingBracket"});function vMe(n){let e=[],t=n.matched?bMe:yMe;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const wMe=Js.define({create(){return en.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],s=e.state.facet(BU);for(let a of e.state.selection.ranges){if(!a.empty)continue;let r=mi(e.state,a.head,-1,s)||a.head>0&&mi(e.state,a.head-1,1,s)||s.afterCursor&&(mi(e.state,a.head,1,s)||a.head<e.state.doc.length&&mi(e.state,a.head+1,-1,s));r&&(t=t.concat(s.renderMatch(r,e.state)))}return en.set(t,!0)},provide:n=>vt.decorations.from(n)}),OMe=[wMe,gMe];function xMe(n={}){return[BU.of(n),OMe]}const kMe=new Zn;function HS(n,e,t){let s=n.prop(e<0?Zn.openedBy:Zn.closedBy);if(s)return s;if(n.name.length==1){let a=t.indexOf(n.name);if(a>-1&&a%2==(e<0?1:0))return[t[a+e]]}return null}function YS(n){let e=n.type.prop(kMe);return e?e(n.node):n}function mi(n,e,t,s={}){let a=s.maxScanDistance||FU,r=s.brackets||NU,o=Ka(n),i=o.resolveInner(e,t);for(let l=i;l;l=l.parent){let c=HS(l.type,t,r);if(c&&l.from<l.to){let u=YS(l);if(u&&(t>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return PMe(n,e,t,l,u,c,r)}}return SMe(n,e,t,o,i.type,a,r)}function PMe(n,e,t,s,a,r,o){let i=s.parent,l={from:a.from,to:a.to},c=0,u=i==null?void 0:i.cursor();if(u&&(t<0?u.childBefore(s.from):u.childAfter(s.to)))do if(t<0?u.to<=s.from:u.from>=s.to){if(c==0&&r.indexOf(u.type.name)>-1&&u.from<u.to){let h=YS(u);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(HS(u.type,t,o))c++;else if(HS(u.type,-t,o)){if(c==0){let h=YS(u);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}c--}}while(t<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function SMe(n,e,t,s,a,r,o){let i=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),l=o.indexOf(i);if(l<0||l%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},u=n.doc.iterRange(e,t>0?n.doc.length:0),h=0;for(let m=0;!u.next().done&&m<=r;){let f=u.value;t<0&&(m+=f.length);let v=e+m*t;for(let O=t>0?0:f.length-1,k=t>0?f.length:-1;O!=k;O+=t){let M=o.indexOf(f[O]);if(!(M<0||s.resolveInner(v+O,1).type!=a))if(M%2==0==t>0)h++;else{if(h==1)return{start:c,end:{from:v+O,to:v+O+1},matched:M>>1==l>>1};h--}}t>0&&(m+=f.length)}return u.done?{start:c,matched:!1}:null}function LT(n,e,t,s=0,a=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let r=a;for(let o=s;o<e;o++)n.charCodeAt(o)==9?r+=t-r%t:r++;return r}class CMe{constructor(e,t,s,a){this.string=e,this.tabSize=t,this.indentUnit=s,this.overrideIndent=a,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),s;if(typeof e=="string"?s=t==e:s=t&&(e instanceof RegExp?e.test(t):e(t)),s)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=LT(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:LT(this.string,null,this.tabSize)}match(e,t,s){if(typeof e=="string"){let a=o=>s?o.toLowerCase():o,r=this.string.substr(this.pos,e.length);return a(r)==a(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let a=this.string.slice(this.pos).match(e);return a&&a.index>0?null:(a&&t!==!1&&(this.pos+=a[0].length),a)}}current(){return this.string.slice(this.start,this.pos)}}const MMe=Object.create(null),IT=[bo.none],QT=[],VT=Object.create(null),AMe=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])AMe[n]=EMe(MMe,e);function vk(n,e){QT.indexOf(n)>-1||(QT.push(n),console.warn(e))}function EMe(n,e){let t=[];for(let i of e.split(" ")){let l=[];for(let c of i.split(".")){let u=n[c]||w[c];u?typeof u=="function"?l.length?l=l.map(u):vk(c,`Modifier ${c} used at start of tag`):l.length?vk(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:vk(c,`Unknown highlighting tag ${c}`)}for(let c of l)t.push(c)}if(!t.length)return 0;let s=e.replace(/ /g,"_"),a=s+" "+t.map(i=>i.id),r=VT[a];if(r)return r.id;let o=VT[a]=bo.define({id:IT.length,name:s,props:[uU({[s]:t})]});return IT.push(o),o.id}Ds.RTL,Ds.LTR;class $U{constructor(e,t,s,a){this.state=e,this.pos=t,this.explicit=s,this.view=a,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Ka(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),s=Math.max(t.from,this.pos-250),a=t.text.slice(s-t.from,this.pos-t.from),r=a.search(_U(e,!1));return r<0?null:{from:s+r,to:this.pos,text:a.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,s){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),s&&s.onDocChange&&(this.abortOnDocChange=!0))}}function jT(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function DMe(n){let e=Object.create(null),t=Object.create(null);for(let{label:a}of n){e[a[0]]=!0;for(let r=1;r<a.length;r++)t[a[r]]=!0}let s=jT(e)+jT(t)+"*$";return[new RegExp("^"+s),new RegExp(s)]}function RU(n){let e=n.map(a=>typeof a=="string"?{label:a}:a),[t,s]=e.every(a=>/^\w+$/.test(a.label))?[/\w*$/,/\w+$/]:DMe(e);return a=>{let r=a.matchBefore(s);return r||a.explicit?{from:r?r.from:a.pos,options:e,validFor:t}:null}}function TMe(n,e){return t=>{for(let s=Ka(t.state).resolveInner(t.pos,-1);s;s=s.parent){if(n.indexOf(s.name)>-1)return null;if(s.type.isTop)break}return e(t)}}class ZT{constructor(e,t,s,a){this.completion=e,this.source=t,this.match=s,this.score=a}}function Dh(n){return n.selection.main.from}function _U(n,e){var t;let{source:s}=n,a=e&&s[0]!="^",r=s[s.length-1]!="$";return!a&&!r?n:new RegExp(`${a?"^":""}(?:${s})${r?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const L3=zc.define();function FMe(n,e,t,s){let{main:a}=n.selection,r=t-a.from,o=s-a.from;return Object.assign(Object.assign({},n.changeByRange(i=>{if(i!=a&&t!=s&&n.sliceDoc(i.from+r,i.from+o)!=n.sliceDoc(t,s))return{range:i};let l=n.toText(e);return{changes:{from:i.from+r,to:s==a.from?i.to:i.from+o,insert:l},range:Ze.cursor(i.from+r+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const zT=new WeakMap;function NMe(n){if(!Array.isArray(n))return n;let e=zT.get(n);return e||zT.set(n,e=RU(n)),e}const Uy=hn.define(),yg=hn.define();class BMe{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let s=ao(e,t),a=Al(s);this.chars.push(s);let r=e.slice(t,t+a),o=r.toUpperCase();this.folded.push(ao(o==r?r.toLowerCase():o,0)),t+=a}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:s,any:a,precise:r,byWord:o}=this;if(t.length==1){let E=ao(e,0),I=Al(E),D=I==e.length?0:-100;if(E!=t[0])if(E==s[0])D+=-200;else return null;return this.ret(D,[0,I])}let i=e.indexOf(this.pattern);if(i==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,c=0;if(i<0){for(let E=0,I=Math.min(e.length,200);E<I&&c<l;){let D=ao(e,E);(D==t[c]||D==s[c])&&(a[c++]=E),E+=Al(D)}if(c<l)return null}let u=0,h=0,m=!1,f=0,v=-1,O=-1,k=/[a-z]/.test(e),M=!0;for(let E=0,I=Math.min(e.length,200),D=0;E<I&&h<l;){let F=ao(e,E);i<0&&(u<l&&F==t[u]&&(r[u++]=E),f<l&&(F==t[f]||F==s[f]?(f==0&&(v=E),O=E+1,f++):f=0));let _,$=F<255?F>=48&&F<=57||F>=97&&F<=122?2:F>=65&&F<=90?1:0:(_=p3(F))!=_.toLowerCase()?1:_!=_.toUpperCase()?2:0;(!E||$==1&&k||D==0&&$!=0)&&(t[h]==F||s[h]==F&&(m=!0)?o[h++]=E:o.length&&(M=!1)),D=$,E+=Al(F)}return h==l&&o[0]==0&&M?this.result(-100+(m?-200:0),o,e):f==l&&v==0?this.ret(-200-e.length+(O==e.length?0:-100),[0,O]):i>-1?this.ret(-700-e.length,[i,i+this.pattern.length]):f==l?this.ret(-900-e.length,[v,O]):h==l?this.result(-100+(m?-200:0)+-700+(M?0:-1100),o,e):t.length==2?null:this.result((a[0]?-700:0)+-200+-1100,a,e)}result(e,t,s){let a=[],r=0;for(let o of t){let i=o+(this.astral?Al(ao(s,o)):1);r&&a[r-1]==o?a[r-1]=i:(a[r++]=o,a[r++]=i)}return this.ret(e-s.length,a)}}class $Me{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),s=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return s==null?null:(this.matched=[0,t.length],this.score=s+(e.length==this.pattern.length?0:-100),this)}}const ja=Qt.define({combine(n){return Gc(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:RMe,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>s=>GT(e(s),t(s)),optionClass:(e,t)=>s=>GT(e(s),t(s)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function GT(n,e){return n?e?n+" "+e:n:e}function RMe(n,e,t,s,a,r){let o=n.textDirection==Ds.RTL,i=o,l=!1,c="top",u,h,m=e.left-a.left,f=a.right-e.right,v=s.right-s.left,O=s.bottom-s.top;if(i&&m<Math.min(v,f)?i=!1:!i&&f<Math.min(v,m)&&(i=!0),v<=(i?m:f))u=Math.max(a.top,Math.min(t.top,a.bottom-O))-e.top,h=Math.min(400,i?m:f);else{l=!0,h=Math.min(400,(o?e.right:a.right-e.left)-30);let E=a.bottom-e.bottom;E>=O||E>e.top?u=t.bottom-e.top:(c="bottom",u=e.bottom-t.top)}let k=(e.bottom-e.top)/r.offsetHeight,M=(e.right-e.left)/r.offsetWidth;return{style:`${c}: ${u/k}px; max-width: ${h/M}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":i?"left":"right")}}function _Me(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let s=document.createElement("div");return s.classList.add("cm-completionIcon"),t.type&&s.classList.add(...t.type.split(/\s+/g).map(a=>"cm-completionIcon-"+a)),s.setAttribute("aria-hidden","true"),s},position:20}),e.push({render(t,s,a,r){let o=document.createElement("span");o.className="cm-completionLabel";let i=t.displayLabel||t.label,l=0;for(let c=0;c<r.length;){let u=r[c++],h=r[c++];u>l&&o.appendChild(document.createTextNode(i.slice(l,u)));let m=o.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(i.slice(u,h))),m.className="cm-completionMatchedText",l=h}return l<i.length&&o.appendChild(document.createTextNode(i.slice(l))),o},position:50},{render(t){if(!t.detail)return null;let s=document.createElement("span");return s.className="cm-completionDetail",s.textContent=t.detail,s},position:80}),e.sort((t,s)=>t.position-s.position).map(t=>t.render)}function wk(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let a=Math.floor(e/t);return{from:a*t,to:(a+1)*t}}let s=Math.floor((n-e)/t);return{from:n-(s+1)*t,to:n-s*t}}class LMe{constructor(e,t,s){this.view=e,this.stateField=t,this.applyCompletion=s,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let a=e.state.field(t),{options:r,selected:o}=a.open,i=e.state.facet(ja);this.optionContent=_Me(i),this.optionClass=i.optionClass,this.tooltipClass=i.tooltipClass,this.range=wk(r.length,o,i.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(t).open;for(let u=l.target,h;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(h=/-(\d+)$/.exec(u.id))&&+h[1]<c.length){this.applyCompletion(e,c[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(ja).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:yg.of(null)})}),this.showOptions(r,a.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let s=e.state.field(this.stateField),a=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),s!=a){let{options:r,selected:o,disabled:i}=s.open;(!a.open||a.open.options!=r)&&(this.range=wk(r.length,o,e.state.facet(ja).maxRenderedOptions),this.showOptions(r,s.id)),this.updateSel(),i!=((t=a.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!i)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let s of this.currentClass.split(" "))s&&this.dom.classList.remove(s);for(let s of t.split(" "))s&&this.dom.classList.add(s);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=wk(t.options.length,t.selected,this.view.state.facet(ja).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:s}=t.options[t.selected],{info:a}=s;if(!a)return;let r=typeof a=="string"?document.createTextNode(a):a(s);if(!r)return;"then"in r?r.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,s)}).catch(o=>co(this.view.state,o,"completion info")):this.addInfoPane(r,s)}}addInfoPane(e,t){this.destroyInfo();let s=this.info=document.createElement("div");if(s.className="cm-tooltip cm-completionInfo",e.nodeType!=null)s.appendChild(e),this.infoDestroy=null;else{let{dom:a,destroy:r}=e;s.appendChild(a),this.infoDestroy=r||null}this.dom.appendChild(s),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let s=this.list.firstChild,a=this.range.from;s;s=s.nextSibling,a++)s.nodeName!="LI"||!s.id?a--:a==e?s.hasAttribute("aria-selected")||(s.setAttribute("aria-selected","true"),t=s):s.hasAttribute("aria-selected")&&s.removeAttribute("aria-selected");return t&&QMe(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),s=this.info.getBoundingClientRect(),a=e.getBoundingClientRect(),r=this.space;if(!r){let o=this.dom.ownerDocument.defaultView||window;r={left:0,top:0,right:o.innerWidth,bottom:o.innerHeight}}return a.top>Math.min(r.bottom,t.bottom)-10||a.bottom<Math.max(r.top,t.top)+10?null:this.view.state.facet(ja).positionInfo(this.view,t,a,s,r,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,s){const a=document.createElement("ul");a.id=t,a.setAttribute("role","listbox"),a.setAttribute("aria-expanded","true"),a.setAttribute("aria-label",this.view.state.phrase("Completions"));let r=null;for(let o=s.from;o<s.to;o++){let{completion:i,match:l}=e[o],{section:c}=i;if(c){let m=typeof c=="string"?c:c.name;if(m!=r&&(o>s.from||s.from==0))if(r=m,typeof c!="string"&&c.header)a.appendChild(c.header(c));else{let f=a.appendChild(document.createElement("completion-section"));f.textContent=m}}const u=a.appendChild(document.createElement("li"));u.id=t+"-"+o,u.setAttribute("role","option");let h=this.optionClass(i);h&&(u.className=h);for(let m of this.optionContent){let f=m(i,this.view.state,this.view,l);f&&u.appendChild(f)}}return s.from&&a.classList.add("cm-completionListIncompleteTop"),s.to<e.length&&a.classList.add("cm-completionListIncompleteBottom"),a}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function IMe(n,e){return t=>new LMe(t,n,e)}function QMe(n,e){let t=n.getBoundingClientRect(),s=e.getBoundingClientRect(),a=t.height/n.offsetHeight;s.top<t.top?n.scrollTop-=(t.top-s.top)/a:s.bottom>t.bottom&&(n.scrollTop+=(s.bottom-t.bottom)/a)}function XT(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function VMe(n,e){let t=[],s=null,a=c=>{t.push(c);let{section:u}=c.completion;if(u){s||(s=[]);let h=typeof u=="string"?u:u.name;s.some(m=>m.name==h)||s.push(typeof u=="string"?{name:h}:u)}},r=e.facet(ja);for(let c of n)if(c.hasResult()){let u=c.result.getMatch;if(c.result.filter===!1)for(let h of c.result.options)a(new ZT(h,c.source,u?u(h):[],1e9-t.length));else{let h=e.sliceDoc(c.from,c.to),m,f=r.filterStrict?new $Me(h):new BMe(h);for(let v of c.result.options)if(m=f.match(v.label)){let O=v.displayLabel?u?u(v,m.matched):[]:m.matched;a(new ZT(v,c.source,O,m.score+(v.boost||0)))}}}if(s){let c=Object.create(null),u=0,h=(m,f)=>{var v,O;return((v=m.rank)!==null&&v!==void 0?v:1e9)-((O=f.rank)!==null&&O!==void 0?O:1e9)||(m.name<f.name?-1:1)};for(let m of s.sort(h))u-=1e5,c[m.name]=u;for(let m of t){let{section:f}=m.completion;f&&(m.score+=c[typeof f=="string"?f:f.name])}}let o=[],i=null,l=r.compareCompletions;for(let c of t.sort((u,h)=>h.score-u.score||l(u.completion,h.completion))){let u=c.completion;!i||i.label!=u.label||i.detail!=u.detail||i.type!=null&&u.type!=null&&i.type!=u.type||i.apply!=u.apply||i.boost!=u.boost?o.push(c):XT(c.completion)>XT(i)&&(o[o.length-1]=c),i=c.completion}return o}class Sd{constructor(e,t,s,a,r,o){this.options=e,this.attrs=t,this.tooltip=s,this.timestamp=a,this.selected=r,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Sd(this.options,WT(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,s,a,r,o){if(a&&!o&&e.some(c=>c.isPending))return a.setDisabled();let i=VMe(e,t);if(!i.length)return a&&e.some(c=>c.isPending)?a.setDisabled():null;let l=t.facet(ja).selectOnOpen?0:-1;if(a&&a.selected!=l&&a.selected!=-1){let c=a.options[a.selected].completion;for(let u=0;u<i.length;u++)if(i[u].completion==c){l=u;break}}return new Sd(i,WT(s,l),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:WMe,above:r.aboveCursor},a?a.timestamp:Date.now(),l,!1)}map(e){return new Sd(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new Sd(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Hy{constructor(e,t,s){this.active=e,this.id=t,this.open=s}static start(){return new Hy(GMe,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,s=t.facet(ja),a=(s.override||t.languageDataAt("autocomplete",Dh(t)).map(NMe)).map(i=>(this.active.find(l=>l.source==i)||new pi(i,this.active.some(l=>l.state!=0)?1:0)).update(e,s));a.length==this.active.length&&a.every((i,l)=>i==this.active[l])&&(a=this.active);let r=this.open,o=e.effects.some(i=>i.is(I3));r&&e.docChanged&&(r=r.map(e.changes)),e.selection||a.some(i=>i.hasResult()&&e.changes.touchesRange(i.from,i.to))||!jMe(a,this.active)||o?r=Sd.build(a,t,this.id,r,s,o):r&&r.disabled&&!a.some(i=>i.isPending)&&(r=null),!r&&a.every(i=>!i.isPending)&&a.some(i=>i.hasResult())&&(a=a.map(i=>i.hasResult()?new pi(i.source,0):i));for(let i of e.effects)i.is(IU)&&(r=r&&r.setSelected(i.value,this.id));return a==this.active&&r==this.open?this:new Hy(a,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?ZMe:zMe}}function jMe(n,e){if(n==e)return!0;for(let t=0,s=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;s<e.length&&!e[s].hasResult();)s++;let a=t==n.length,r=s==e.length;if(a||r)return a==r;if(n[t++].result!=e[s++].result)return!1}}const ZMe={"aria-autocomplete":"list"},zMe={};function WT(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const GMe=[];function LU(n,e){if(n.isUserEvent("input.complete")){let s=n.annotation(L3);if(s&&e.activateOnCompletion(s))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class pi{constructor(e,t,s=!1){this.source=e,this.state=t,this.explicit=s}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let s=LU(e,t),a=this;(s&8||s&16&&this.touches(e))&&(a=new pi(a.source,0)),s&4&&a.state==0&&(a=new pi(this.source,1)),a=a.updateFor(e,s);for(let r of e.effects)if(r.is(Uy))a=new pi(a.source,1,r.value);else if(r.is(yg))a=new pi(a.source,0);else if(r.is(I3))for(let o of r.value)o.source==a.source&&(a=o);return a}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Dh(e.state))}}class Wd extends pi{constructor(e,t,s,a,r,o){super(e,3,t),this.limit=s,this.result=a,this.from=r,this.to=o}hasResult(){return!0}updateFor(e,t){var s;if(!(t&3))return this.map(e.changes);let a=this.result;a.map&&!e.changes.empty&&(a=a.map(a,e.changes));let r=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),i=Dh(e.state);if(i>o||!a||t&2&&(Dh(e.startState)==this.from||i<this.limit))return new pi(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return XMe(a.validFor,e.state,r,o)?new Wd(this.source,this.explicit,l,a,r,o):a.update&&(a=a.update(a,r,o,new $U(e.state,i,!1)))?new Wd(this.source,this.explicit,l,a,a.from,(s=a.to)!==null&&s!==void 0?s:Dh(e.state)):new pi(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Wd(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new pi(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function XMe(n,e,t,s){if(!n)return!1;let a=e.sliceDoc(t,s);return typeof n=="function"?n(a,t,s,e):_U(n,!0).test(a)}const I3=hn.define({map(n,e){return n.map(t=>t.map(e))}}),IU=hn.define(),Cr=Js.define({create(){return Hy.start()},update(n,e){return n.update(e)},provide:n=>[E3.from(n,e=>e.tooltip),vt.contentAttributes.from(n,e=>e.attrs)]});function Q3(n,e){const t=e.completion.apply||e.completion.label;let s=n.state.field(Cr).active.find(a=>a.source==e.source);return s instanceof Wd?(typeof t=="string"?n.dispatch(Object.assign(Object.assign({},FMe(n.state,t,s.from,s.to)),{annotations:L3.of(e.completion)})):t(n,e.completion,s.from,s.to),!0):!1}const WMe=IMe(Cr,Q3);function mu(n,e="option"){return t=>{let s=t.state.field(Cr,!1);if(!s||!s.open||s.open.disabled||Date.now()-s.open.timestamp<t.state.facet(ja).interactionDelay)return!1;let a=1,r;e=="page"&&(r=nU(t,s.open.tooltip))&&(a=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=s.open.options,i=s.open.selected>-1?s.open.selected+a*(n?1:-1):n?0:o-1;return i<0?i=e=="page"?0:o-1:i>=o&&(i=e=="page"?o-1:0),t.dispatch({effects:IU.of(i)}),!0}}const KS=n=>{let e=n.state.field(Cr,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(ja).interactionDelay?!1:Q3(n,e.open.options[e.open.selected])},JS=n=>n.state.field(Cr,!1)?(n.dispatch({effects:Uy.of(!0)}),!0):!1,QU=n=>{let e=n.state.field(Cr,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:yg.of(null)}),!0)};class qMe{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const UMe=50,HMe=1e3,YMe=ra.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(Cr).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(Cr),t=n.state.facet(ja);if(!n.selectionSet&&!n.docChanged&&n.startState.field(Cr)==e)return;let s=n.transactions.some(r=>{let o=LU(r,t);return o&8||(r.selection||r.docChanged)&&!(o&3)});for(let r=0;r<this.running.length;r++){let o=this.running[r];if(s||o.context.abortOnDocChange&&n.docChanged||o.updates.length+n.transactions.length>UMe&&Date.now()-o.time>HMe){for(let i of o.context.abortListeners)try{i()}catch(l){co(this.view.state,l)}o.context.abortListeners=null,this.running.splice(r--,1)}else o.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(r=>r.effects.some(o=>o.is(Uy)))&&(this.pendingStart=!0);let a=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(r=>r.isPending&&!this.running.some(o=>o.active.source==r.source))?setTimeout(()=>this.startUpdate(),a):-1,this.composing!=0)for(let r of n.transactions)r.isUserEvent("input.type")?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(Cr);for(let t of e.active)t.isPending&&!this.running.some(s=>s.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(ja).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=Dh(e),s=new $U(e,t,n.explicit,this.view),a=new qMe(n,s);this.running.push(a),Promise.resolve(n.source(s)).then(r=>{a.context.aborted||(a.done=r||null,this.scheduleAccept())},r=>{this.view.dispatch({effects:yg.of(null)}),co(this.view.state,r)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(ja).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(ja),s=this.view.state.field(Cr);for(let a=0;a<this.running.length;a++){let r=this.running[a];if(r.done===void 0)continue;if(this.running.splice(a--,1),r.done){let i=Dh(r.updates.length?r.updates[0].startState:this.view.state),l=Math.min(i,r.done.from+(r.active.explicit?0:1)),c=new Wd(r.active.source,r.active.explicit,l,r.done,r.done.from,(n=r.done.to)!==null&&n!==void 0?n:i);for(let u of r.updates)c=c.update(u,t);if(c.hasResult()){e.push(c);continue}}let o=s.active.find(i=>i.source==r.active.source);if(o&&o.isPending)if(r.done==null){let i=new pi(r.active.source,0);for(let l of r.updates)i=i.update(l,t);i.isPending||e.push(i)}else this.startQuery(o)}(e.length||s.open&&s.open.disabled)&&this.view.dispatch({effects:I3.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(Cr,!1);if(e&&e.tooltip&&this.view.state.facet(ja).closeOnBlur){let t=e.open&&nU(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:yg.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Uy.of(!1)}),20),this.composing=0}}}),KMe=typeof navigator=="object"&&/Win/.test(navigator.platform),JMe=yo.highest(vt.domEventHandlers({keydown(n,e){let t=e.state.field(Cr,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(KMe&&n.altKey)||n.metaKey)return!1;let s=t.open.options[t.open.selected],a=t.active.find(o=>o.source==s.source),r=s.completion.commitCharacters||a.result.commitCharacters;return r&&r.indexOf(n.key)>-1&&Q3(e,s),!1}})),VU=vt.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class eAe{constructor(e,t,s,a){this.field=e,this.line=t,this.from=s,this.to=a}}class V3{constructor(e,t,s){this.field=e,this.from=t,this.to=s}map(e){let t=e.mapPos(this.from,-1,ga.TrackDel),s=e.mapPos(this.to,1,ga.TrackDel);return t==null||s==null?null:new V3(this.field,t,s)}}class j3{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let s=[],a=[t],r=e.doc.lineAt(t),o=/^\s*/.exec(r.text)[0];for(let l of this.lines){if(s.length){let c=o,u=/^\t*/.exec(l)[0].length;for(let h=0;h<u;h++)c+=e.facet(Sm);a.push(t+c.length-u),l=c+l.slice(u)}s.push(l),t+=l.length+1}let i=this.fieldPositions.map(l=>new V3(l.field,a[l.line]+l.from,a[l.line]+l.to));return{text:s,ranges:i}}static parse(e){let t=[],s=[],a=[],r;for(let o of e.split(/\r\n?|\n/)){for(;r=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let i=r[1]?+r[1]:null,l=r[2]||r[3]||"",c=-1,u=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<t.length;h++)(i!=null?t[h].seq==i:u&&t[h].name==u)&&(c=h);if(c<0){let h=0;for(;h<t.length&&(i==null||t[h].seq!=null&&t[h].seq<i);)h++;t.splice(h,0,{seq:i,name:u}),c=h;for(let m of a)m.field>=c&&m.field++}a.push(new eAe(c,s.length,r.index,r.index+u.length)),o=o.slice(0,r.index)+l+o.slice(r.index+r[0].length)}o=o.replace(/\\([{}])/g,(i,l,c)=>{for(let u of a)u.line==s.length&&u.from>c&&(u.from--,u.to--);return l}),s.push(o)}return new j3(s,a)}}let tAe=en.widget({widget:new class extends cl{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),nAe=en.mark({class:"cm-snippetField"});class tp{constructor(e,t){this.ranges=e,this.active=t,this.deco=en.set(e.map(s=>(s.from==s.to?tAe:nAe).range(s.from,s.to)))}map(e){let t=[];for(let s of this.ranges){let a=s.map(e);if(!a)return null;t.push(a)}return new tp(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(s=>s.field==this.active&&s.from<=t.from&&s.to>=t.to))}}const l0=hn.define({map(n,e){return n&&n.map(e)}}),sAe=hn.define(),vg=Js.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(l0))return t.value;if(t.is(sAe)&&n)return new tp(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>vt.decorations.from(n,e=>e?e.deco:en.none)});function Z3(n,e){return Ze.create(n.filter(t=>t.field==e).map(t=>Ze.range(t.from,t.to)))}function aAe(n){let e=j3.parse(n);return(t,s,a,r)=>{let{text:o,ranges:i}=e.instantiate(t.state,a),{main:l}=t.state.selection,c={changes:{from:a,to:r==l.from?l.to:r,insert:os.of(o)},scrollIntoView:!0,annotations:s?[L3.of(s),va.userEvent.of("input.complete")]:void 0};if(i.length&&(c.selection=Z3(i,0)),i.some(u=>u.field>0)){let u=new tp(i,0),h=c.effects=[l0.of(u)];t.state.field(vg,!1)===void 0&&h.push(hn.appendConfig.of([vg,cAe,uAe,VU]))}t.dispatch(t.state.update(c))}}function jU(n){return({state:e,dispatch:t})=>{let s=e.field(vg,!1);if(!s||n<0&&s.active==0)return!1;let a=s.active+n,r=n>0&&!s.ranges.some(o=>o.field==a+n);return t(e.update({selection:Z3(s.ranges,a),effects:l0.of(r?null:new tp(s.ranges,a)),scrollIntoView:!0})),!0}}const rAe=({state:n,dispatch:e})=>n.field(vg,!1)?(e(n.update({effects:l0.of(null)})),!0):!1,oAe=jU(1),iAe=jU(-1),lAe=[{key:"Tab",run:oAe,shift:iAe},{key:"Escape",run:rAe}],qT=Qt.define({combine(n){return n.length?n[0]:lAe}}),cAe=yo.highest(Xc.compute([qT],n=>n.facet(qT)));function Zr(n,e){return Object.assign(Object.assign({},e),{apply:aAe(n)})}const uAe=vt.domEventHandlers({mousedown(n,e){let t=e.state.field(vg,!1),s;if(!t||(s=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let a=t.ranges.find(r=>r.from<=s&&r.to>=s);return!a||a.field==t.active?!1:(e.dispatch({selection:Z3(t.ranges,a.field),effects:l0.of(t.ranges.some(r=>r.field>a.field)?new tp(t.ranges,a.field):null),scrollIntoView:!0}),!0)}}),wg={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},vh=hn.define({map(n,e){return e.mapPos(n,-1,ga.TrackAfter)??void 0}}),z3=new class extends jh{};z3.startSide=1;z3.endSide=-1;const ZU=Js.define({create(){return hs.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:s=>s>=t.from&&s<=t.to})}for(let t of e.effects)t.is(vh)&&(n=n.update({add:[z3.range(t.value,t.value+1)]}));return n}});function hAe(){return[mAe,ZU]}const Ok="()[]{}<>";function zU(n){for(let e=0;e<Ok.length;e+=2)if(Ok.charCodeAt(e)==n)return Ok.charAt(e+1);return p3(n<128?n:n+1)}function GU(n,e){return n.languageDataAt("closeBrackets",e)[0]||wg}const dAe=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),mAe=vt.inputHandler.of((n,e,t,s)=>{if((dAe?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let a=n.state.selection.main;if(s.length>2||s.length==2&&Al(ao(s,0))==1||e!=a.from||t!=a.to)return!1;let r=fAe(n.state,s);return r?(n.dispatch(r),!0):!1}),XU=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=GU(n,n.selection.main.head).brackets||wg.brackets,s=null,a=n.changeByRange(r=>{if(r.empty){let o=gAe(n.doc,r.head);for(let i of t)if(i==o&&$w(n.doc,r.head)==zU(ao(i,0)))return{changes:{from:r.head-i.length,to:r.head+i.length},range:Ze.cursor(r.head-i.length)}}return{range:s=r}});return s||e(n.update(a,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},pAe=[{key:"Backspace",run:XU}];function fAe(n,e){let t=GU(n,n.selection.main.head),s=t.brackets||wg.brackets;for(let a of s){let r=zU(ao(a,0));if(e==a)return r==a?vAe(n,a,s.indexOf(a+a+a)>-1,t):bAe(n,a,r,t.before||wg.before);if(e==r&&WU(n,n.selection.main.from))return yAe(n,a,r)}return null}function WU(n,e){let t=!1;return n.field(ZU).between(0,n.doc.length,s=>{s==e&&(t=!0)}),t}function $w(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Al(ao(t,0)))}function gAe(n,e){let t=n.sliceString(e-2,e);return Al(ao(t,0))==t.length?t:t.slice(1)}function bAe(n,e,t,s){let a=null,r=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:vh.of(o.to+e.length),range:Ze.range(o.anchor+e.length,o.head+e.length)};let i=$w(n.doc,o.head);return!i||/\s/.test(i)||s.indexOf(i)>-1?{changes:{insert:e+t,from:o.head},effects:vh.of(o.head+e.length),range:Ze.cursor(o.head+e.length)}:{range:a=o}});return a?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function yAe(n,e,t){let s=null,a=n.changeByRange(r=>r.empty&&$w(n.doc,r.head)==t?{changes:{from:r.head,to:r.head+t.length,insert:t},range:Ze.cursor(r.head+t.length)}:s={range:r});return s?null:n.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function vAe(n,e,t,s){let a=s.stringPrefixes||wg.stringPrefixes,r=null,o=n.changeByRange(i=>{if(!i.empty)return{changes:[{insert:e,from:i.from},{insert:e,from:i.to}],effects:vh.of(i.to+e.length),range:Ze.range(i.anchor+e.length,i.head+e.length)};let l=i.head,c=$w(n.doc,l),u;if(c==e){if(UT(n,l))return{changes:{insert:e+e,from:l},effects:vh.of(l+e.length),range:Ze.cursor(l+e.length)};if(WU(n,l)){let h=t&&n.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+h.length,insert:h},range:Ze.cursor(l+h.length)}}}else{if(t&&n.sliceDoc(l-2*e.length,l)==e+e&&(u=HT(n,l-2*e.length,a))>-1&&UT(n,u))return{changes:{insert:e+e+e+e,from:l},effects:vh.of(l+e.length),range:Ze.cursor(l+e.length)};if(n.charCategorizer(l)(c)!=wa.Word&&HT(n,l,a)>-1&&!wAe(n,l,e,a))return{changes:{insert:e+e,from:l},effects:vh.of(l+e.length),range:Ze.cursor(l+e.length)}}return{range:r=i}});return r?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function UT(n,e){let t=Ka(n).resolveInner(e+1);return t.parent&&t.from==e}function wAe(n,e,t,s){let a=Ka(n).resolveInner(e,-1),r=s.reduce((o,i)=>Math.max(o,i.length),0);for(let o=0;o<5;o++){let i=n.sliceDoc(a.from,Math.min(a.to,a.from+t.length+r)),l=i.indexOf(t);if(!l||l>-1&&s.indexOf(i.slice(0,l))>-1){let u=a.firstChild;for(;u&&u.from==a.from&&u.to-u.from>t.length+l;){if(n.sliceDoc(u.to-t.length,u.to)==t)return!1;u=u.firstChild}return!0}let c=a.to==e&&a.parent;if(!c)break;a=c}return!1}function HT(n,e,t){let s=n.charCategorizer(e);if(s(n.sliceDoc(e-1,e))!=wa.Word)return e;for(let a of t){let r=e-a.length;if(n.sliceDoc(r,e)==a&&s(n.sliceDoc(r-1,r))!=wa.Word)return r}return-1}function OAe(n={}){return[JMe,Cr,ja.of(n),YMe,kAe,VU]}const xAe=[{key:"Ctrl-Space",run:JS},{mac:"Alt-`",run:JS},{key:"Escape",run:QU},{key:"ArrowDown",run:mu(!0)},{key:"ArrowUp",run:mu(!1)},{key:"PageDown",run:mu(!0,"page")},{key:"PageUp",run:mu(!1,"page")},{key:"Enter",run:KS}],kAe=yo.highest(Xc.computeN([ja],n=>n.facet(ja).defaultKeymap?[xAe]:[]));function PAe(n){let e=n.field(Cr,!1);return e&&e.active.some(t=>t.isPending)?"pending":e&&e.active.some(t=>t.state!=0)?"active":null}const Rw=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),s=X3(n.state,t.from);return s.line?qU(n):s.block?UU(n):!1};function c0(n,e){return({state:t,dispatch:s})=>{if(t.readOnly)return!1;let a=n(e,t);return a?(s(t.update(a)),!0):!1}}const qU=c0(W3,0),SAe=c0(W3,1),CAe=c0(W3,2),G3=c0(HU,0),UU=c0((n,e)=>HU(n,e,AAe(e)),0);function X3(n,e){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const _p=50;function MAe(n,{open:e,close:t},s,a){let r=n.sliceDoc(s-_p,s),o=n.sliceDoc(a,a+_p),i=/\s*$/.exec(r)[0].length,l=/^\s*/.exec(o)[0].length,c=r.length-i;if(r.slice(c-e.length,c)==e&&o.slice(l,l+t.length)==t)return{open:{pos:s-i,margin:i&&1},close:{pos:a+l,margin:l&&1}};let u,h;a-s<=2*_p?u=h=n.sliceDoc(s,a):(u=n.sliceDoc(s,s+_p),h=n.sliceDoc(a-_p,a));let m=/^\s*/.exec(u)[0].length,f=/\s*$/.exec(h)[0].length,v=h.length-f-t.length;return u.slice(m,m+e.length)==e&&h.slice(v,v+t.length)==t?{open:{pos:s+m+e.length,margin:/\s/.test(u.charAt(m+e.length))?1:0},close:{pos:a-f-t.length,margin:/\s/.test(h.charAt(v-1))?1:0}}:null}function AAe(n){let e=[];for(let t of n.selection.ranges){let s=n.doc.lineAt(t.from),a=t.to<=s.to?s:n.doc.lineAt(t.to);a.from>s.from&&a.from==t.to&&(a=t.to==s.to+1?s:n.doc.lineAt(t.to-1));let r=e.length-1;r>=0&&e[r].to>s.from?e[r].to=a.to:e.push({from:s.from+/^\s*/.exec(s.text)[0].length,to:a.to})}return e}function HU(n,e,t=e.selection.ranges){let s=t.map(r=>X3(e,r.from).block);if(!s.every(r=>r))return null;let a=t.map((r,o)=>MAe(e,s[o],r.from,r.to));if(n!=2&&!a.every(r=>r))return{changes:e.changes(t.map((r,o)=>a[o]?[]:[{from:r.from,insert:s[o].open+" "},{from:r.to,insert:" "+s[o].close}]))};if(n!=1&&a.some(r=>r)){let r=[];for(let o=0,i;o<a.length;o++)if(i=a[o]){let l=s[o],{open:c,close:u}=i;r.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:r}}return null}function W3(n,e,t=e.selection.ranges){let s=[],a=-1;for(let{from:r,to:o}of t){let i=s.length,l=1e9,c=X3(e,r).line;if(c){for(let u=r;u<=o;){let h=e.doc.lineAt(u);if(h.from>a&&(r==o||o>h.from)){a=h.from;let m=/^\s*/.exec(h.text)[0].length,f=m==h.length,v=h.text.slice(m,m+c.length)==c?m:-1;m<h.text.length&&m<l&&(l=m),s.push({line:h,comment:v,token:c,indent:m,empty:f,single:!1})}u=h.to+1}if(l<1e9)for(let u=i;u<s.length;u++)s[u].indent<s[u].line.text.length&&(s[u].indent=l);s.length==i+1&&(s[i].single=!0)}}if(n!=2&&s.some(r=>r.comment<0&&(!r.empty||r.single))){let r=[];for(let{line:i,token:l,indent:c,empty:u,single:h}of s)(h||!u)&&r.push({from:i.from+c,insert:l+" "});let o=e.changes(r);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&s.some(r=>r.comment>=0)){let r=[];for(let{line:o,comment:i,token:l}of s)if(i>=0){let c=o.from+i,u=c+l.length;o.text[u-o.from]==" "&&u++,r.push({from:c,to:u})}return{changes:r}}return null}const eC=zc.define(),EAe=zc.define(),DAe=Qt.define(),YU=Qt.define({combine(n){return Gc(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(s,a)=>e(s,a)||t(s,a)})}}),KU=Js.define({create(){return Nl.empty},update(n,e){let t=e.state.facet(YU),s=e.annotation(eC);if(s){let l=uo.fromTransaction(e,s.selection),c=s.side,u=c==0?n.undone:n.done;return l?u=Yy(u,u.length,t.minDepth,l):u=nH(u,e.startState.selection),new Nl(c==0?s.rest:u,c==0?u:s.rest)}let a=e.annotation(EAe);if((a=="full"||a=="before")&&(n=n.isolate()),e.annotation(va.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let r=uo.fromTransaction(e),o=e.annotation(va.time),i=e.annotation(va.userEvent);return r?n=n.addChanges(r,o,i,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,i,t.newGroupDelay)),(a=="full"||a=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Nl(n.done.map(uo.fromJSON),n.undone.map(uo.fromJSON))}});function JU(n={}){return[KU,YU.of(n),vt.domEventHandlers({beforeinput(e,t){let s=e.inputType=="historyUndo"?Lw:e.inputType=="historyRedo"?Cm:null;return s?(e.preventDefault(),s(t)):!1}})]}function _w(n,e){return function({state:t,dispatch:s}){if(!e&&t.readOnly)return!1;let a=t.field(KU,!1);if(!a)return!1;let r=a.pop(n,t,e);return r?(s(r),!0):!1}}const Lw=_w(0,!1),Cm=_w(1,!1),eH=_w(0,!0),TAe=_w(1,!0);class uo{constructor(e,t,s,a,r){this.changes=e,this.effects=t,this.mapped=s,this.startSelection=a,this.selectionsAfter=r}setSelAfter(e){return new uo(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,s;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(s=this.startSelection)===null||s===void 0?void 0:s.toJSON(),selectionsAfter:this.selectionsAfter.map(a=>a.toJSON())}}static fromJSON(e){return new uo(e.changes&&Pa.fromJSON(e.changes),[],e.mapped&&_l.fromJSON(e.mapped),e.startSelection&&Ze.fromJSON(e.startSelection),e.selectionsAfter.map(Ze.fromJSON))}static fromTransaction(e,t){let s=fi;for(let a of e.startState.facet(DAe)){let r=a(e);r.length&&(s=s.concat(r))}return!s.length&&e.changes.empty?null:new uo(e.changes.invert(e.startState.doc),s,void 0,t||e.startState.selection,fi)}static selection(e){return new uo(void 0,fi,void 0,void 0,e)}}function Yy(n,e,t,s){let a=e+1>t+20?e-t-1:0,r=n.slice(a,e);return r.push(s),r}function FAe(n,e){let t=[],s=!1;return n.iterChangedRanges((a,r)=>t.push(a,r)),e.iterChangedRanges((a,r,o,i)=>{for(let l=0;l<t.length;){let c=t[l++],u=t[l++];i>=c&&o<=u&&(s=!0)}}),s}function NAe(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,s)=>t.empty!=e.ranges[s].empty).length===0}function tH(n,e){return n.length?e.length?n.concat(e):n:e}const fi=[],BAe=200;function nH(n,e){if(n.length){let t=n[n.length-1],s=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-BAe));return s.length&&s[s.length-1].eq(e)?n:(s.push(e),Yy(n,n.length-1,1e9,t.setSelAfter(s)))}else return[uo.selection([e])]}function $Ae(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function xk(n,e){if(!n.length)return n;let t=n.length,s=fi;for(;t;){let a=RAe(n[t-1],e,s);if(a.changes&&!a.changes.empty||a.effects.length){let r=n.slice(0,t);return r[t-1]=a,r}else e=a.mapped,t--,s=a.selectionsAfter}return s.length?[uo.selection(s)]:fi}function RAe(n,e,t){let s=tH(n.selectionsAfter.length?n.selectionsAfter.map(i=>i.map(e)):fi,t);if(!n.changes)return uo.selection(s);let a=n.changes.map(e),r=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(r):r;return new uo(a,hn.mapEffects(n.effects,e),o,n.startSelection.map(r),s)}const _Ae=/^(input\.type|delete)($|\.)/;class Nl{constructor(e,t,s=0,a=void 0){this.done=e,this.undone=t,this.prevTime=s,this.prevUserEvent=a}isolate(){return this.prevTime?new Nl(this.done,this.undone):this}addChanges(e,t,s,a,r){let o=this.done,i=o[o.length-1];return i&&i.changes&&!i.changes.empty&&e.changes&&(!s||_Ae.test(s))&&(!i.selectionsAfter.length&&t-this.prevTime<a.newGroupDelay&&a.joinToEvent(r,FAe(i.changes,e.changes))||s=="input.type.compose")?o=Yy(o,o.length-1,a.minDepth,new uo(e.changes.compose(i.changes),tH(hn.mapEffects(e.effects,i.changes),i.effects),i.mapped,i.startSelection,fi)):o=Yy(o,o.length,a.minDepth,e),new Nl(o,fi,t,s)}addSelection(e,t,s,a){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:fi;return r.length>0&&t-this.prevTime<a&&s==this.prevUserEvent&&s&&/^select($|\.)/.test(s)&&NAe(r[r.length-1],e)?this:new Nl(nH(this.done,e),this.undone,t,s)}addMapping(e){return new Nl(xk(this.done,e),xk(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,s){let a=e==0?this.done:this.undone;if(a.length==0)return null;let r=a[a.length-1],o=r.selectionsAfter[0]||t.selection;if(s&&r.selectionsAfter.length)return t.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:eC.of({side:e,rest:$Ae(a),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let i=a.length==1?fi:a.slice(0,a.length-1);return r.mapped&&(i=xk(i,r.mapped)),t.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:eC.of({side:e,rest:i,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Nl.empty=new Nl(fi,fi);const sH=[{key:"Mod-z",run:Lw,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Cm,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Cm,preventDefault:!0},{key:"Mod-u",run:eH,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:TAe,preventDefault:!0}];function np(n,e){return Ze.create(n.ranges.map(e),n.mainIndex)}function ac(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function ul({state:n,dispatch:e},t){let s=np(n.selection,t);return s.eq(n.selection,!0)?!1:(e(ac(n,s)),!0)}function Iw(n,e){return Ze.cursor(e?n.to:n.from)}function q3(n,e){return ul(n,t=>t.empty?n.moveByChar(t,e):Iw(t,e))}function gr(n){return n.textDirectionAt(n.state.selection.main.head)==Ds.LTR}const Og=n=>q3(n,!gr(n)),Ky=n=>q3(n,gr(n)),LAe=n=>q3(n,!1);function aH(n,e){return ul(n,t=>t.empty?n.moveByGroup(t,e):Iw(t,e))}const rH=n=>aH(n,!gr(n)),oH=n=>aH(n,gr(n));function IAe(n,e,t){if(e.type.prop(t))return!0;let s=e.to-e.from;return s&&(s>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function Qw(n,e,t){let s=Ka(n).resolveInner(e.head),a=t?Zn.closedBy:Zn.openedBy;for(let l=e.head;;){let c=t?s.childAfter(l):s.childBefore(l);if(!c)break;IAe(n,c,a)?s=c:l=t?c.to:c.from}let r=s.type.prop(a),o,i;return r&&(o=t?mi(n,s.from,1):mi(n,s.to,-1))&&o.matched?i=t?o.end.to:o.end.from:i=t?s.to:s.from,Ze.cursor(i,t?-1:1)}const QAe=n=>ul(n,e=>Qw(n.state,e,!gr(n))),VAe=n=>ul(n,e=>Qw(n.state,e,gr(n)));function iH(n,e){return ul(n,t=>{if(!t.empty)return Iw(t,e);let s=n.moveVertically(t,e);return s.head!=t.head?s:n.moveToLineBoundary(t,e)})}const Jy=n=>iH(n,!1),ev=n=>iH(n,!0);function lH(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,s=0,a;if(e){for(let r of n.state.facet(vt.scrollMargins)){let o=r(n);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(s=Math.max(o==null?void 0:o.bottom,s))}a=n.scrollDOM.clientHeight-t-s}else a=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:s,selfScroll:e,height:Math.max(n.defaultLineHeight,a-5)}}function cH(n,e){let t=lH(n),{state:s}=n,a=np(s.selection,o=>o.empty?n.moveVertically(o,e,t.height):Iw(o,e));if(a.eq(s.selection))return!1;let r;if(t.selfScroll){let o=n.coordsAtPos(s.selection.main.head),i=n.scrollDOM.getBoundingClientRect(),l=i.top+t.marginTop,c=i.bottom-t.marginBottom;o&&o.top>l&&o.bottom<c&&(r=vt.scrollIntoView(a.main.head,{y:"start",yMargin:o.top-l}))}return n.dispatch(ac(s,a),{effects:r}),!0}const Df=n=>cH(n,!1),qd=n=>cH(n,!0);function Xu(n,e,t){let s=n.lineBlockAt(e.head),a=n.moveToLineBoundary(e,t);if(a.head==e.head&&a.head!=(t?s.to:s.from)&&(a=n.moveToLineBoundary(e,t,!1)),!t&&a.head==s.from&&s.length){let r=/^\s*/.exec(n.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;r&&e.head!=s.from+r&&(a=Ze.cursor(s.from+r))}return a}const tv=n=>ul(n,e=>Xu(n,e,!0)),nv=n=>ul(n,e=>Xu(n,e,!1)),jAe=n=>ul(n,e=>Xu(n,e,!gr(n))),ZAe=n=>ul(n,e=>Xu(n,e,gr(n))),uH=n=>ul(n,e=>Ze.cursor(n.lineBlockAt(e.head).from,1)),hH=n=>ul(n,e=>Ze.cursor(n.lineBlockAt(e.head).to,-1));function zAe(n,e,t){let s=!1,a=np(n.selection,r=>{let o=mi(n,r.head,-1)||mi(n,r.head,1)||r.head>0&&mi(n,r.head-1,1)||r.head<n.doc.length&&mi(n,r.head+1,-1);if(!o||!o.end)return r;s=!0;let i=o.start.from==r.head?o.end.to:o.end.from;return Ze.cursor(i)});return s?(e(ac(n,a)),!0):!1}const dH=({state:n,dispatch:e})=>zAe(n,e);function Mi(n,e){let t=np(n.state.selection,s=>{let a=e(s);return Ze.range(s.anchor,a.head,a.goalColumn,a.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(ac(n.state,t)),!0)}function mH(n,e){return Mi(n,t=>n.moveByChar(t,e))}const sv=n=>mH(n,!gr(n)),av=n=>mH(n,gr(n));function pH(n,e){return Mi(n,t=>n.moveByGroup(t,e))}const fH=n=>pH(n,!gr(n)),gH=n=>pH(n,gr(n)),GAe=n=>Mi(n,e=>Qw(n.state,e,!gr(n))),XAe=n=>Mi(n,e=>Qw(n.state,e,gr(n)));function bH(n,e){return Mi(n,t=>n.moveVertically(t,e))}const rv=n=>bH(n,!1),ov=n=>bH(n,!0);function yH(n,e){return Mi(n,t=>n.moveVertically(t,e,lH(n).height))}const iv=n=>yH(n,!1),lv=n=>yH(n,!0),tC=n=>Mi(n,e=>Xu(n,e,!0)),nC=n=>Mi(n,e=>Xu(n,e,!1)),WAe=n=>Mi(n,e=>Xu(n,e,!gr(n))),qAe=n=>Mi(n,e=>Xu(n,e,gr(n))),vH=n=>Mi(n,e=>Ze.cursor(n.lineBlockAt(e.head).from)),wH=n=>Mi(n,e=>Ze.cursor(n.lineBlockAt(e.head).to)),cv=({state:n,dispatch:e})=>(e(ac(n,{anchor:0})),!0),uv=({state:n,dispatch:e})=>(e(ac(n,{anchor:n.doc.length})),!0),hv=({state:n,dispatch:e})=>(e(ac(n,{anchor:n.selection.main.anchor,head:0})),!0),dv=({state:n,dispatch:e})=>(e(ac(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),OH=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),xH=({state:n,dispatch:e})=>{let t=Vw(n).map(({from:s,to:a})=>Ze.range(s,Math.min(a+1,n.doc.length)));return e(n.update({selection:Ze.create(t),userEvent:"select"})),!0},UAe=({state:n,dispatch:e})=>{let t=np(n.selection,s=>{let a=Ka(n),r=a.resolveStack(s.from,1);if(s.empty){let o=a.resolveStack(s.from,-1);o.node.from>=r.node.from&&o.node.to<=r.node.to&&(r=o)}for(let o=r;o;o=o.next){let{node:i}=o;if((i.from<s.from&&i.to>=s.to||i.to>s.to&&i.from<=s.from)&&o.next)return Ze.range(i.to,i.from)}return s});return t.eq(n.selection)?!1:(e(ac(n,t)),!0)},HAe=({state:n,dispatch:e})=>{let t=n.selection,s=null;return t.ranges.length>1?s=Ze.create([t.main]):t.main.empty||(s=Ze.create([Ze.cursor(t.main.head)])),s?(e(ac(n,s)),!0):!1};function sp(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:s}=n,a=s.changeByRange(r=>{let{from:o,to:i}=r;if(o==i){let l=e(r);l<o?(t="delete.backward",l=pb(n,l,!1)):l>o&&(t="delete.forward",l=pb(n,l,!0)),o=Math.min(o,l),i=Math.max(i,l)}else o=pb(n,o,!1),i=pb(n,i,!0);return o==i?{range:r}:{changes:{from:o,to:i},range:Ze.cursor(o,o<r.head?-1:1)}});return a.changes.empty?!1:(n.dispatch(s.update(a,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?vt.announce.of(s.phrase("Selection deleted")):void 0})),!0)}function pb(n,e,t){if(n instanceof vt)for(let s of n.state.facet(vt.atomicRanges).map(a=>a(n)))s.between(e,e,(a,r)=>{a<e&&r>e&&(e=t?r:a)});return e}const kH=(n,e,t)=>sp(n,s=>{let a=s.from,{state:r}=n,o=r.doc.lineAt(a),i,l;if(t&&!e&&a>o.from&&a<o.from+200&&!/[^ \t]/.test(i=o.text.slice(0,a-o.from))){if(i[i.length-1]=="	")return a-1;let c=ep(i,r.tabSize),u=c%Wy(r)||Wy(r);for(let h=0;h<u&&i[i.length-1-h]==" ";h++)a--;l=a}else l=Ya(o.text,a-o.from,e,e)+o.from,l==a&&o.number!=(e?r.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,a-o.from))&&(l=Ya(o.text,l-o.from,!1,!1)+o.from);return l}),Ud=n=>kH(n,!1,!0),mv=n=>kH(n,!0,!1),PH=(n,e)=>sp(n,t=>{let s=t.head,{state:a}=n,r=a.doc.lineAt(s),o=a.charCategorizer(s);for(let i=null;;){if(s==(e?r.to:r.from)){s==t.head&&r.number!=(e?a.doc.lines:1)&&(s+=e?1:-1);break}let l=Ya(r.text,s-r.from,e)+r.from,c=r.text.slice(Math.min(s,l)-r.from,Math.max(s,l)-r.from),u=o(c);if(i!=null&&u!=i)break;(c!=" "||s!=t.head)&&(i=u),s=l}return s}),pv=n=>PH(n,!1),SH=n=>PH(n,!0),sC=n=>sp(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),YAe=n=>sp(n,e=>{let t=n.lineBlockAt(e.head).from;return e.head>t?t:Math.max(0,e.head-1)}),KAe=n=>sp(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),JAe=n=>sp(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),U3=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:os.of(["",""])},range:Ze.cursor(s.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},CH=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(s=>{if(!s.empty||s.from==0||s.from==n.doc.length)return{range:s};let a=s.from,r=n.doc.lineAt(a),o=a==r.from?a-1:Ya(r.text,a-r.from,!1)+r.from,i=a==r.to?a+1:Ya(r.text,a-r.from,!0)+r.from;return{changes:{from:o,to:i,insert:n.doc.slice(a,i).append(n.doc.slice(o,a))},range:Ze.cursor(i)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Vw(n){let e=[],t=-1;for(let s of n.selection.ranges){let a=n.doc.lineAt(s.from),r=n.doc.lineAt(s.to);if(!s.empty&&s.to==r.from&&(r=n.doc.lineAt(s.to-1)),t>=a.number){let o=e[e.length-1];o.to=r.to,o.ranges.push(s)}else e.push({from:a.from,to:r.to,ranges:[s]});t=r.number+1}return e}function MH(n,e,t){if(n.readOnly)return!1;let s=[],a=[];for(let r of Vw(n)){if(t?r.to==n.doc.length:r.from==0)continue;let o=n.doc.lineAt(t?r.to+1:r.from-1),i=o.length+1;if(t){s.push({from:r.to,to:o.to},{from:r.from,insert:o.text+n.lineBreak});for(let l of r.ranges)a.push(Ze.range(Math.min(n.doc.length,l.anchor+i),Math.min(n.doc.length,l.head+i)))}else{s.push({from:o.from,to:r.from},{from:r.to,insert:n.lineBreak+o.text});for(let l of r.ranges)a.push(Ze.range(l.anchor-i,l.head-i))}}return s.length?(e(n.update({changes:s,scrollIntoView:!0,selection:Ze.create(a,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const AH=({state:n,dispatch:e})=>MH(n,e,!1),EH=({state:n,dispatch:e})=>MH(n,e,!0);function DH(n,e,t){if(n.readOnly)return!1;let s=[];for(let a of Vw(n))t?s.push({from:a.from,insert:n.doc.slice(a.from,a.to)+n.lineBreak}):s.push({from:a.to,insert:n.lineBreak+n.doc.slice(a.from,a.to)});return e(n.update({changes:s,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const TH=({state:n,dispatch:e})=>DH(n,e,!1),FH=({state:n,dispatch:e})=>DH(n,e,!0),NH=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Vw(e).map(({from:a,to:r})=>(a>0?a--:r<e.doc.length&&r++,{from:a,to:r}))),s=np(e.selection,a=>{let r;if(n.lineWrapping){let o=n.lineBlockAt(a.head),i=n.coordsAtPos(a.head,a.assoc||1);i&&(r=o.bottom+n.documentTop-i.bottom+n.defaultLineHeight/2)}return n.moveVertically(a,!0,r)}).map(t);return n.dispatch({changes:t,selection:s,scrollIntoView:!0,userEvent:"delete.line"}),!0};function e3e(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Ka(n).resolveInner(e),s=t.childBefore(e),a=t.childAfter(e),r;return s&&a&&s.to<=e&&a.from>=e&&(r=s.type.prop(Zn.closedBy))&&r.indexOf(a.name)>-1&&n.doc.lineAt(s.to).from==n.doc.lineAt(a.from).from&&!/\S/.test(n.sliceDoc(s.to,a.from))?{from:s.to,to:a.from}:null}const xg=BH(!1),t3e=BH(!0);function BH(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let s=e.changeByRange(a=>{let{from:r,to:o}=a,i=e.doc.lineAt(r),l=!n&&r==o&&e3e(e,r);n&&(r=o=(o<=i.to?i:e.doc.lineAt(o)).to);let c=new Nw(e,{simulateBreak:r,simulateDoubleBreak:!!l}),u=gU(c,r);for(u==null&&(u=ep(/^\s*/.exec(e.doc.lineAt(r).text)[0],e.tabSize));o<i.to&&/\s/.test(i.text[o-i.from]);)o++;l?{from:r,to:o}=l:r>i.from&&r<i.from+100&&!/\S/.test(i.text.slice(0,r))&&(r=i.from);let h=["",qy(e,u)];return l&&h.push(qy(e,c.lineIndent(i.from,-1))),{changes:{from:r,to:o,insert:os.of(h)},range:Ze.cursor(r+1+h[1].length)}});return t(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function H3(n,e){let t=-1;return n.changeByRange(s=>{let a=[];for(let o=s.from;o<=s.to;){let i=n.doc.lineAt(o);i.number>t&&(s.empty||s.to>i.from)&&(e(i,a,s),t=i.number),o=i.to+1}let r=n.changes(a);return{changes:a,range:Ze.range(r.mapPos(s.anchor,1),r.mapPos(s.head,1))}})}const $H=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),s=new Nw(n,{overrideIndentation:r=>t[r]??-1}),a=H3(n,(r,o,i)=>{let l=gU(s,r.from);if(l==null)return;/\S/.test(r.text)||(l=0);let c=/^\s*/.exec(r.text)[0],u=qy(n,l);(c!=u||i.from<r.from+c.length)&&(t[r.from]=l,o.push({from:r.from,to:r.from+c.length,insert:u}))});return a.changes.empty||e(n.update(a,{userEvent:"indent"})),!0},kg=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(H3(n,(t,s)=>{s.push({from:t.from,insert:n.facet(Sm)})}),{userEvent:"input.indent"})),!0),Pg=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(H3(n,(t,s)=>{let a=/^\s*/.exec(t.text)[0];if(!a)return;let r=ep(a,n.tabSize),o=0,i=qy(n,Math.max(0,r-Wy(n)));for(;o<a.length&&o<i.length&&a.charCodeAt(o)==i.charCodeAt(o);)o++;s.push({from:t.from+o,to:t.from+a.length,insert:i.slice(o)})}),{userEvent:"delete.dedent"})),!0),n3e=n=>(n.setTabFocusMode(),!0),s3e=[{key:"Ctrl-b",run:Og,shift:sv,preventDefault:!0},{key:"Ctrl-f",run:Ky,shift:av},{key:"Ctrl-p",run:Jy,shift:rv},{key:"Ctrl-n",run:ev,shift:ov},{key:"Ctrl-a",run:uH,shift:vH},{key:"Ctrl-e",run:hH,shift:wH},{key:"Ctrl-d",run:mv},{key:"Ctrl-h",run:Ud},{key:"Ctrl-k",run:sC},{key:"Ctrl-Alt-h",run:pv},{key:"Ctrl-o",run:U3},{key:"Ctrl-t",run:CH},{key:"Ctrl-v",run:qd}],a3e=[{key:"ArrowLeft",run:Og,shift:sv,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:rH,shift:fH,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:jAe,shift:WAe,preventDefault:!0},{key:"ArrowRight",run:Ky,shift:av,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:oH,shift:gH,preventDefault:!0},{mac:"Cmd-ArrowRight",run:ZAe,shift:qAe,preventDefault:!0},{key:"ArrowUp",run:Jy,shift:rv,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cv,shift:hv},{mac:"Ctrl-ArrowUp",run:Df,shift:iv},{key:"ArrowDown",run:ev,shift:ov,preventDefault:!0},{mac:"Cmd-ArrowDown",run:uv,shift:dv},{mac:"Ctrl-ArrowDown",run:qd,shift:lv},{key:"PageUp",run:Df,shift:iv},{key:"PageDown",run:qd,shift:lv},{key:"Home",run:nv,shift:nC,preventDefault:!0},{key:"Mod-Home",run:cv,shift:hv},{key:"End",run:tv,shift:tC,preventDefault:!0},{key:"Mod-End",run:uv,shift:dv},{key:"Enter",run:xg,shift:xg},{key:"Mod-a",run:OH},{key:"Backspace",run:Ud,shift:Ud},{key:"Delete",run:mv},{key:"Mod-Backspace",mac:"Alt-Backspace",run:pv},{key:"Mod-Delete",mac:"Alt-Delete",run:SH},{mac:"Mod-Backspace",run:KAe},{mac:"Mod-Delete",run:JAe}].concat(s3e.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),Y3=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:QAe,shift:GAe},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:VAe,shift:XAe},{key:"Alt-ArrowUp",run:AH},{key:"Shift-Alt-ArrowUp",run:TH},{key:"Alt-ArrowDown",run:EH},{key:"Shift-Alt-ArrowDown",run:FH},{key:"Escape",run:HAe},{key:"Mod-Enter",run:t3e},{key:"Alt-l",mac:"Ctrl-l",run:xH},{key:"Mod-i",run:UAe,preventDefault:!0},{key:"Mod-[",run:Pg},{key:"Mod-]",run:kg},{key:"Mod-Alt-\\",run:$H},{key:"Shift-Mod-k",run:NH},{key:"Shift-Mod-\\",run:dH},{key:"Mod-/",run:Rw},{key:"Alt-A",run:G3},{key:"Ctrl-m",mac:"Shift-Alt-m",run:n3e}].concat(a3e),r3e={key:"Tab",run:kg,shift:Pg};class fv{constructor(e,t,s,a,r,o,i,l,c,u=0,h){this.p=e,this.stack=t,this.state=s,this.reducePos=a,this.pos=r,this.score=o,this.buffer=i,this.bufferBase=l,this.curContext=c,this.lookAhead=u,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,s=0){let a=e.parser.context;return new fv(e,[],t,s,s,0,[],0,a?new YT(a,a.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let s=e>>19,a=e&65535,{parser:r}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let i=r.dynamicPrecedence(a);if(i&&(this.score+=i),s==0){this.pushState(r.getGoto(this.state,a,!0),this.reducePos),a<r.minRepeatTerm&&this.storeNode(a,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(a,this.reducePos);return}let l=this.stack.length-(s-1)*3-(e&262144?6:0),c=l?this.stack[l-2]:this.p.ranges[0].from,u=this.reducePos-c;u>=2e3&&!(!((t=this.p.parser.nodeSet.types[a])===null||t===void 0)&&t.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=u):this.p.lastBigReductionSize<u&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=u));let h=l?this.stack[l-1]:0,m=this.bufferBase+this.buffer.length-h;if(a<r.minRepeatTerm||e&131072){let f=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(a,c,f,m+4,!0)}if(e&262144)this.state=this.stack[l];else{let f=this.stack[l-3];this.state=r.getGoto(f,a,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(a,c)}storeNode(e,t,s,a=4,r=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,i=this.buffer.length;if(i==0&&o.parent&&(i=o.bufferBase-o.parent.bufferBase,o=o.parent),i>0&&o.buffer[i-4]==0&&o.buffer[i-1]>-1){if(t==s)return;if(o.buffer[i-2]>=t){o.buffer[i-2]=s;return}}}if(!r||this.pos==s)this.buffer.push(e,t,s,a);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let i=!1;for(let l=o;l>0&&this.buffer[l-2]>s;l-=4)if(this.buffer[l-1]>=0){i=!0;break}if(i)for(;o>0&&this.buffer[o-2]>s;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,a>4&&(a-=4)}this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=s,this.buffer[o+3]=a}}shift(e,t,s,a){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=a,this.shiftContext(t,s),t<=this.p.parser.maxNode&&this.buffer.push(t,s,a,4);else{let r=e,{parser:o}=this.p;(a>this.pos||t<=o.maxNode)&&(this.pos=a,o.stateFlag(r,1)||(this.reducePos=a)),this.pushState(r,s),this.shiftContext(t,s),t<=o.maxNode&&this.buffer.push(t,s,a,4)}}apply(e,t,s,a){e&65536?this.reduce(e):this.shift(e,t,s,a)}useNode(e,t){let s=this.p.reused.length-1;(s<0||this.p.reused[s]!=e)&&(this.p.reused.push(e),s++);let a=this.pos;this.reducePos=this.pos=a+e.length,this.pushState(t,a),this.buffer.push(s,a,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let s=e.buffer.slice(t),a=e.bufferBase+t;for(;e&&a==e.bufferBase;)e=e.parent;return new fv(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,s,a,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let s=e<=this.p.parser.maxNode;s&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,s?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new o3e(this);;){let s=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(s==0)return!1;if(!(s&65536))return!0;t.reduce(s)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let a=[];for(let r=0,o;r<t.length;r+=2)(o=t[r+1])!=this.state&&this.p.parser.hasAction(o,e)&&a.push(t[r],o);if(this.stack.length<120)for(let r=0;a.length<8&&r<t.length;r+=2){let o=t[r+1];a.some((i,l)=>l&1&&i==o)||a.push(t[r],o)}t=a}let s=[];for(let a=0;a<t.length&&s.length<4;a+=2){let r=t[a+1];if(r==this.state)continue;let o=this.split();o.pushState(r,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[a],this.pos),o.reducePos=this.pos,o.score-=200,s.push(o)}return s}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let s=t>>19,a=t&65535,r=this.stack.length-s*3;if(r<0||e.getGoto(this.stack[r],a,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],s=(a,r)=>{if(!t.includes(a))return t.push(a),e.allActions(a,o=>{if(!(o&393216))if(o&65536){let i=(o>>19)-r;if(i>1){let l=o&65535,c=this.stack.length-i*3;if(c>=0&&e.getGoto(this.stack[c],l,!1)>=0)return i<<19|65536|l}}else{let i=s(o,r+1);if(i!=null)return i}})};return s(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new YT(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class YT{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class o3e{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,s=e>>19;s==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(s-1)*3;let a=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=a}}class gv{constructor(e,t,s){this.stack=e,this.pos=t,this.index=s,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new gv(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new gv(this.stack,this.pos,this.index)}}function lf(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let s=0,a=0;s<n.length;){let r=0;for(;;){let o=n.charCodeAt(s++),i=!1;if(o==126){r=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,i=!0),r+=l,i)break;r*=46}t?t[a++]=r:t=new e(r)}return t}class m1{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const KT=new m1;class i3e{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=KT,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let s=this.range,a=this.rangeIndex,r=this.pos+e;for(;r<s.from;){if(!a)return null;let o=this.ranges[--a];r-=s.from-o.to,s=o}for(;t<0?r>s.to:r>=s.to;){if(a==this.ranges.length-1)return null;let o=this.ranges[++a];r+=o.from-s.to,s=o}return r}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,s,a;if(t>=0&&t<this.chunk.length)s=this.pos+e,a=this.chunk.charCodeAt(t);else{let r=this.resolveOffset(e,1);if(r==null)return-1;if(s=r,s>=this.chunk2Pos&&s<this.chunk2Pos+this.chunk2.length)a=this.chunk2.charCodeAt(s-this.chunk2Pos);else{let o=this.rangeIndex,i=this.range;for(;i.to<=s;)i=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=s),s+this.chunk2.length>i.to&&(this.chunk2=this.chunk2.slice(0,i.to-s)),a=this.chunk2.charCodeAt(0)}}return s>=this.token.lookAhead&&(this.token.lookAhead=s+1),a}acceptToken(e,t=0){let s=t?this.resolveOffset(t,-1):this.pos;if(s==null||s<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=s}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=KT,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let s="";for(let a of this.ranges){if(a.from>=t)break;a.to>e&&(s+=this.input.read(Math.max(a.from,e),Math.min(a.to,t)))}return s}}class Hd{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:s}=t.p;RH(this.data,e,t,this.id,s.data,s.tokenPrecTable)}}Hd.prototype.contextual=Hd.prototype.fallback=Hd.prototype.extend=!1;class aC{constructor(e,t,s){this.precTable=t,this.elseToken=s,this.data=typeof e=="string"?lf(e):e}token(e,t){let s=e.pos,a=0;for(;;){let r=e.next<0,o=e.resolveOffset(1,1);if(RH(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(r||a++,o==null)break;e.reset(o,e.token)}a&&(e.reset(s,e.token),e.acceptToken(this.elseToken,a))}}aC.prototype.contextual=Hd.prototype.fallback=Hd.prototype.extend=!1;class u0{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function RH(n,e,t,s,a,r){let o=0,i=1<<s,{dialect:l}=t.p.parser;e:for(;i&n[o];){let c=n[o+1];for(let f=o+3;f<c;f+=2)if((n[f+1]&i)>0){let v=n[f];if(l.allows(v)&&(e.token.value==-1||e.token.value==v||l3e(v,e.token.value,a,r))){e.acceptToken(v);break}}let u=e.next,h=0,m=n[o+2];if(e.next<0&&m>h&&n[c+m*3-3]==65535){o=n[c+m*3-1];continue e}for(;h<m;){let f=h+m>>1,v=c+f+(f<<1),O=n[v],k=n[v+1]||65536;if(u<O)m=f;else if(u>=k)h=f+1;else{o=n[v+2],e.advance();continue e}}break}}function JT(n,e,t){for(let s=e,a;(a=n[s])!=65535;s++)if(a==t)return s-e;return-1}function l3e(n,e,t,s){let a=JT(t,s,e);return a<0||JT(t,s,n)<a}const Mo=typeof process<"u"&&S9&&/\bparse\b/.test(S9.LOG);let kk=null;function eF(n,e,t){let s=n.cursor(Ca.IncludeAnonymous);for(s.moveTo(e);;)if(!(t<0?s.childBefore(e):s.childAfter(e)))for(;;){if((t<0?s.to<e:s.from>e)&&!s.type.isError)return t<0?Math.max(0,Math.min(s.to-1,e-25)):Math.min(n.length,Math.max(s.from+1,e+25));if(t<0?s.prevSibling():s.nextSibling())break;if(!s.parent())return t<0?0:n.length}}class c3e{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?eF(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?eF(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let s=this.trees[t],a=this.index[t];if(a==s.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=s.children[a],o=this.start[t]+s.positions[a];if(o>e)return this.nextStart=o,null;if(r instanceof Oa){if(o==e){if(o<this.safeFrom)return null;let i=o+r.length;if(i<=this.safeTo){let l=r.prop(Zn.lookAhead);if(!l||i+l<this.fragment.to)return r}}this.index[t]++,o+r.length>=Math.max(this.safeFrom,e)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+r.length}}}class u3e{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(s=>new m1)}getActions(e){let t=0,s=null,{parser:a}=e.p,{tokenizers:r}=a,o=a.stateSlot(e.state,3),i=e.curContext?e.curContext.hash:0,l=0;for(let c=0;c<r.length;c++){if(!(1<<c&o))continue;let u=r[c],h=this.tokens[c];if(!(s&&!u.fallback)&&((u.contextual||h.start!=e.pos||h.mask!=o||h.context!=i)&&(this.updateCachedToken(h,u,e),h.mask=o,h.context=i),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let m=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!u.extend&&(s=h,t>m))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!s&&e.pos==this.stream.end&&(s=new m1,s.value=e.p.parser.eofTerm,s.start=s.end=e.pos,t=this.addActions(e,s.value,s.end,t)),this.mainToken=s,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new m1,{pos:s,p:a}=e;return t.start=s,t.end=Math.min(s+1,a.stream.end),t.value=s==a.stream.end?a.parser.eofTerm:0,t}updateCachedToken(e,t,s){let a=this.stream.clipPos(s.pos);if(t.token(this.stream.reset(a,e),s),e.value>-1){let{parser:r}=s.p;for(let o=0;o<r.specialized.length;o++)if(r.specialized[o]==e.value){let i=r.specializers[o](this.stream.read(e.start,e.end),s);if(i>=0&&s.p.parser.dialect.allows(i>>1)){i&1?e.extended=i>>1:e.value=i>>1;break}}}else e.value=0,e.end=this.stream.clipPos(a+1)}putAction(e,t,s,a){for(let r=0;r<a;r+=3)if(this.actions[r]==e)return a;return this.actions[a++]=e,this.actions[a++]=t,this.actions[a++]=s,a}addActions(e,t,s,a){let{state:r}=e,{parser:o}=e.p,{data:i}=o;for(let l=0;l<2;l++)for(let c=o.stateSlot(r,l?2:1);;c+=3){if(i[c]==65535)if(i[c+1]==1)c=wc(i,c+2);else{a==0&&i[c+1]==2&&(a=this.putAction(wc(i,c+2),t,s,a));break}i[c]==t&&(a=this.putAction(wc(i,c+1),t,s,a))}return a}}class h3e{constructor(e,t,s,a){this.parser=e,this.input=t,this.ranges=a,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new i3e(t,a),this.tokens=new u3e(e,this.stream),this.topTerm=e.top[1];let{from:r}=a[0];this.stacks=[fv.start(this,e.top[0],r)],this.fragments=s.length&&this.stream.end-r>e.bufferLength*4?new c3e(s,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,s=this.stacks=[],a,r;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let i=e[o];for(;;){if(this.tokens.mainToken=null,i.pos>t)s.push(i);else{if(this.advanceStack(i,s,e))continue;{a||(a=[],r=[]),a.push(i);let l=this.tokens.getMainToken(i);r.push(l.value,l.end)}}break}}if(!s.length){let o=a&&p3e(a);if(o)return Mo&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw Mo&&a&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&a){let o=this.stoppedAt!=null&&a[0].pos>this.stoppedAt?a[0]:this.runRecovery(a,r,s);if(o)return Mo&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(s.length>o)for(s.sort((i,l)=>l.score-i.score);s.length>o;)s.pop();s.some(i=>i.reducePos>t)&&this.recovering--}else if(s.length>1){e:for(let o=0;o<s.length-1;o++){let i=s[o];for(let l=o+1;l<s.length;l++){let c=s[l];if(i.sameState(c)||i.buffer.length>500&&c.buffer.length>500)if((i.score-c.score||i.buffer.length-c.buffer.length)>0)s.splice(l--,1);else{s.splice(o--,1);continue e}}}s.length>12&&s.splice(12,s.length-12)}this.minStackPos=s[0].pos;for(let o=1;o<s.length;o++)s[o].pos<this.minStackPos&&(this.minStackPos=s[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,s){let a=e.pos,{parser:r}=this,o=Mo?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&a>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let c=e.curContext&&e.curContext.tracker.strict,u=c?e.curContext.hash:0;for(let h=this.fragments.nodeAt(a);h;){let m=this.parser.nodeSet.types[h.type.id]==h.type?r.getGoto(e.state,h.type.id):-1;if(m>-1&&h.length&&(!c||(h.prop(Zn.contextHash)||0)==u))return e.useNode(h,m),Mo&&console.log(o+this.stackID(e)+` (via reuse of ${r.getName(h.type.id)})`),!0;if(!(h instanceof Oa)||h.children.length==0||h.positions[0]>0)break;let f=h.children[0];if(f instanceof Oa&&h.positions[0]==0)h=f;else break}}let i=r.stateSlot(e.state,4);if(i>0)return e.reduce(i),Mo&&console.log(o+this.stackID(e)+` (via always-reduce ${r.getName(i&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let c=0;c<l.length;){let u=l[c++],h=l[c++],m=l[c++],f=c==l.length||!s,v=f?e:e.split(),O=this.tokens.mainToken;if(v.apply(u,h,O?O.start:v.pos,m),Mo&&console.log(o+this.stackID(v)+` (via ${u&65536?`reduce of ${r.getName(u&65535)}`:"shift"} for ${r.getName(h)} @ ${a}${v==e?"":", split"})`),f)return!0;v.pos>a?t.push(v):s.push(v)}return!1}advanceFully(e,t){let s=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>s)return tF(e,t),!0}}runRecovery(e,t,s){let a=null,r=!1;for(let o=0;o<e.length;o++){let i=e[o],l=t[o<<1],c=t[(o<<1)+1],u=Mo?this.stackID(i)+" -> ":"";if(i.deadEnd&&(r||(r=!0,i.restart(),Mo&&console.log(u+this.stackID(i)+" (restarted)"),this.advanceFully(i,s))))continue;let h=i.split(),m=u;for(let f=0;h.forceReduce()&&f<10&&(Mo&&console.log(m+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,s));f++)Mo&&(m=this.stackID(h)+" -> ");for(let f of i.recoverByInsert(l))Mo&&console.log(u+this.stackID(f)+" (via recover-insert)"),this.advanceFully(f,s);this.stream.end>i.pos?(c==i.pos&&(c++,l=0),i.recoverByDelete(l,c),Mo&&console.log(u+this.stackID(i)+` (via recover-delete ${this.parser.getName(l)})`),tF(i,s)):(!a||a.score<i.score)&&(a=i)}return a}stackToTree(e){return e.close(),Oa.build({buffer:gv.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(kk||(kk=new WeakMap)).get(e);return t||kk.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function tF(n,e){for(let t=0;t<e.length;t++){let s=e[t];if(s.pos==n.pos&&s.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class d3e{constructor(e,t,s){this.source=e,this.flags=t,this.disabled=s}allows(e){return!this.disabled||this.disabled[e]==0}}const Pk=n=>n;class m3e{constructor(e){this.start=e.start,this.shift=e.shift||Pk,this.reduce=e.reduce||Pk,this.reuse=e.reuse||Pk,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class bv extends cU{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let i=0;i<e.repeatNodeCount;i++)t.push("");let s=Object.keys(e.topRules).map(i=>e.topRules[i][1]),a=[];for(let i=0;i<t.length;i++)a.push([]);function r(i,l,c){a[i].push([l,l.deserialize(String(c))])}if(e.nodeProps)for(let i of e.nodeProps){let l=i[0];typeof l=="string"&&(l=Zn[l]);for(let c=1;c<i.length;){let u=i[c++];if(u>=0)r(u,l,i[c++]);else{let h=i[c+-u];for(let m=-u;m>0;m--)r(i[c++],l,h);c++}}}this.nodeSet=new D3(t.map((i,l)=>bo.define({name:l>=this.minRepeatTerm?void 0:i,id:l,props:a[l],top:s.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=rU;let o=lf(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let i=0;i<this.specializerSpecs.length;i++)this.specialized[i]=this.specializerSpecs[i].term;this.specializers=this.specializerSpecs.map(nF),this.states=lf(e.states,Uint32Array),this.data=lf(e.stateData),this.goto=lf(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(i=>typeof i=="number"?new Hd(o,i):i),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,s){let a=new h3e(this,e,t,s);for(let r of this.wrappers)a=r(a,e,t,s);return a}getGoto(e,t,s=!1){let a=this.goto;if(t>=a[0])return-1;for(let r=a[t+1];;){let o=a[r++],i=o&1,l=a[r++];if(i&&s)return l;for(let c=r+(o>>1);r<c;r++)if(a[r]==e)return l;if(i)return-1}}hasAction(e,t){let s=this.data;for(let a=0;a<2;a++)for(let r=this.stateSlot(e,a?2:1),o;;r+=3){if((o=s[r])==65535)if(s[r+1]==1)o=s[r=wc(s,r+2)];else{if(s[r+1]==2)return wc(s,r+2);break}if(o==t||o==0)return wc(s,r+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,s=>s==t?!0:null)}allActions(e,t){let s=this.stateSlot(e,4),a=s?t(s):void 0;for(let r=this.stateSlot(e,1);a==null;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=wc(this.data,r+2);else break;a=t(wc(this.data,r+1))}return a}nextStates(e){let t=[];for(let s=this.stateSlot(e,1);;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=wc(this.data,s+2);else break;if(!(this.data[s+2]&1)){let a=this.data[s+1];t.some((r,o)=>o&1&&r==a)||t.push(this.data[s],a)}}return t}configure(e){let t=Object.assign(Object.create(bv.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let s=this.topRules[e.top];if(!s)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=s}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(s=>{let a=e.tokenizers.find(r=>r.from==s);return a?a.to:s})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((s,a)=>{let r=e.specializers.find(i=>i.from==s.external);if(!r)return s;let o=Object.assign(Object.assign({},s),{external:r.to});return t.specializers[a]=nF(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),s=t.map(()=>!1);if(e)for(let r of e.split(" ")){let o=t.indexOf(r);o>=0&&(s[o]=!0)}let a=null;for(let r=0;r<t.length;r++)if(!s[r])for(let o=this.dialects[t[r]],i;(i=this.data[o++])!=65535;)(a||(a=new Uint8Array(this.maxTerm+1)))[i]=1;return new d3e(e,s,a)}static deserialize(e){return new bv(e)}}function wc(n,e){return n[e]|n[e+1]<<16}function p3e(n){let e=null;for(let t of n){let s=t.p.stoppedAt;(t.pos==t.p.stream.end||s!=null&&t.pos>s)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function nF(n){if(n.external){let e=n.extend?1:0;return(t,s)=>n.external(t,s)<<1|e}return n.get}const f3e=314,g3e=315,sF=1,b3e=2,y3e=3,v3e=4,w3e=316,O3e=318,x3e=319,k3e=5,P3e=6,S3e=0,rC=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],_H=125,C3e=59,oC=47,M3e=42,A3e=43,E3e=45,D3e=60,T3e=44,F3e=63,N3e=46,B3e=91,$3e=new m3e({start:!1,shift(n,e){return e==k3e||e==P3e||e==O3e?n:e==x3e},strict:!1}),R3e=new u0((n,e)=>{let{next:t}=n;(t==_H||t==-1||e.context)&&n.acceptToken(w3e)},{contextual:!0,fallback:!0}),_3e=new u0((n,e)=>{let{next:t}=n,s;rC.indexOf(t)>-1||t==oC&&((s=n.peek(1))==oC||s==M3e)||t!=_H&&t!=C3e&&t!=-1&&!e.context&&n.acceptToken(f3e)},{contextual:!0}),L3e=new u0((n,e)=>{n.next==B3e&&!e.context&&n.acceptToken(g3e)},{contextual:!0}),I3e=new u0((n,e)=>{let{next:t}=n;if(t==A3e||t==E3e){if(n.advance(),t==n.next){n.advance();let s=!e.context&&e.canShift(sF);n.acceptToken(s?sF:b3e)}}else t==F3e&&n.peek(1)==N3e&&(n.advance(),n.advance(),(n.next<48||n.next>57)&&n.acceptToken(y3e))},{contextual:!0});function Sk(n,e){return n>=65&&n<=90||n>=97&&n<=122||n==95||n>=192||!e&&n>=48&&n<=57}const Q3e=new u0((n,e)=>{if(n.next!=D3e||!e.dialectEnabled(S3e)||(n.advance(),n.next==oC))return;let t=0;for(;rC.indexOf(n.next)>-1;)n.advance(),t++;if(Sk(n.next,!0)){for(n.advance(),t++;Sk(n.next,!1);)n.advance(),t++;for(;rC.indexOf(n.next)>-1;)n.advance(),t++;if(n.next==T3e)return;for(let s=0;;s++){if(s==7){if(!Sk(n.next,!0))return;break}if(n.next!="extends".charCodeAt(s))break;n.advance(),t++}}n.acceptToken(v3e,-t)}),V3e=uU({"get set async static":w.modifier,"for while do if else switch try catch finally return throw break continue default case":w.controlKeyword,"in of await yield void typeof delete instanceof":w.operatorKeyword,"let var const using function class extends":w.definitionKeyword,"import export from":w.moduleKeyword,"with debugger as new":w.keyword,TemplateString:w.special(w.string),super:w.atom,BooleanLiteral:w.bool,this:w.self,null:w.null,Star:w.modifier,VariableName:w.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":w.function(w.variableName),VariableDefinition:w.definition(w.variableName),Label:w.labelName,PropertyName:w.propertyName,PrivatePropertyName:w.special(w.propertyName),"CallExpression/MemberExpression/PropertyName":w.function(w.propertyName),"FunctionDeclaration/VariableDefinition":w.function(w.definition(w.variableName)),"ClassDeclaration/VariableDefinition":w.definition(w.className),"NewExpression/VariableName":w.className,PropertyDefinition:w.definition(w.propertyName),PrivatePropertyDefinition:w.definition(w.special(w.propertyName)),UpdateOp:w.updateOperator,"LineComment Hashbang":w.lineComment,BlockComment:w.blockComment,Number:w.number,String:w.string,Escape:w.escape,ArithOp:w.arithmeticOperator,LogicOp:w.logicOperator,BitOp:w.bitwiseOperator,CompareOp:w.compareOperator,RegExp:w.regexp,Equals:w.definitionOperator,Arrow:w.function(w.punctuation),": Spread":w.punctuation,"( )":w.paren,"[ ]":w.squareBracket,"{ }":w.brace,"InterpolationStart InterpolationEnd":w.special(w.brace),".":w.derefOperator,", ;":w.separator,"@":w.meta,TypeName:w.typeName,TypeDefinition:w.definition(w.typeName),"type enum interface implements namespace module declare":w.definitionKeyword,"abstract global Privacy readonly override":w.modifier,"is keyof unique infer asserts":w.operatorKeyword,JSXAttributeValue:w.attributeValue,JSXText:w.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":w.angleBracket,"JSXIdentifier JSXNameSpacedName":w.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":w.attributeName,"JSXBuiltin/JSXIdentifier":w.standard(w.tagName)}),j3e={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,const:52,extends:56,this:60,true:68,false:68,null:80,void:84,typeof:88,super:104,new:138,delete:150,yield:159,await:163,class:168,public:231,private:231,protected:231,readonly:233,instanceof:252,satisfies:255,in:256,import:290,keyof:347,unique:351,infer:357,asserts:393,is:395,abstract:415,implements:417,type:419,let:422,var:424,using:427,interface:433,enum:437,namespace:443,module:445,declare:449,global:453,for:472,of:481,while:484,with:488,do:492,if:496,else:498,switch:502,case:508,try:514,catch:518,finally:522,return:526,throw:530,break:534,continue:538,debugger:542},Z3e={__proto__:null,async:125,get:127,set:129,declare:191,public:193,private:193,protected:193,static:195,abstract:197,override:199,readonly:205,accessor:207,new:399},z3e={__proto__:null,"<":189},G3e=bv.deserialize({version:14,states:"$EOQ%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#D_O.QQlO'#DeO.bQlO'#DpO%[QlO'#DxO0fQlO'#EQOOQ!0Lf'#EY'#EYO1PQ`O'#EVOOQO'#En'#EnOOQO'#Ij'#IjO1XQ`O'#GrO1dQ`O'#EmO1iQ`O'#EmO3hQ!0MxO'#JpO6[Q!0MxO'#JqO6uQ`O'#F[O6zQ,UO'#FsOOQ!0Lf'#Fe'#FeO7VO7dO'#FeO7eQMhO'#F{O9UQ`O'#FzOOQ!0Lf'#Jq'#JqOOQ!0Lb'#Jp'#JpO9ZQ`O'#GvOOQ['#K]'#K]O9fQ`O'#IWO9kQ!0LrO'#IXOOQ['#J^'#J^OOQ['#I]'#I]Q`QlOOQ`QlOOO9sQ!L^O'#DtO9zQlO'#D|O:RQlO'#EOO9aQ`O'#GrO:YQMhO'#CoO:hQ`O'#ElO:sQ`O'#EwO:xQMhO'#FdO;gQ`O'#GrOOQO'#K^'#K^O;lQ`O'#K^O;zQ`O'#GzO;zQ`O'#G{O;zQ`O'#G}O9aQ`O'#HQO<qQ`O'#HTO>YQ`O'#CeO>jQ`O'#HaO>rQ`O'#HgO>rQ`O'#HiO`QlO'#HkO>rQ`O'#HmO>rQ`O'#HpO>wQ`O'#HvO>|Q!0LsO'#H|O%[QlO'#IOO?XQ!0LsO'#IQO?dQ!0LsO'#ISO9kQ!0LrO'#IUO?oQ!0MxO'#CiO@qQpO'#DjQOQ`OOO%[QlO'#EOOAXQ`O'#ERO:YQMhO'#ElOAdQ`O'#ElOAoQ!bO'#FdOOQ['#Cg'#CgOOQ!0Lb'#Do'#DoOOQ!0Lb'#Jt'#JtO%[QlO'#JtOOQO'#Jw'#JwOOQO'#If'#IfOBoQpO'#EeOOQ!0Lb'#Ed'#EdOOQ!0Lb'#J{'#J{OCkQ!0MSO'#EeOCuQpO'#EUOOQO'#Jv'#JvODZQpO'#JwOEhQpO'#EUOCuQpO'#EePEuO&2DjO'#CbPOOO)CD{)CD{OOOO'#I^'#I^OFQO#tO,59UOOQ!0Lh,59U,59UOOOO'#I_'#I_OF`O&jO,59UOFnQ!L^O'#DaOOOO'#Ia'#IaOFuO#@ItO,59yOOQ!0Lf,59y,59yOGTQlO'#IbOGhQ`O'#JrOIgQ!fO'#JrO+}QlO'#JrOInQ`O,5:POJUQ`O'#EnOJcQ`O'#KROJnQ`O'#KQOJnQ`O'#KQOJvQ`O,5;[OJ{Q`O'#KPOOQ!0Ln,5:[,5:[OKSQlO,5:[OMQQ!0MxO,5:dOMqQ`O,5:lON[Q!0LrO'#KOONcQ`O'#J}O9ZQ`O'#J}ONwQ`O'#J}O! PQ`O,5;ZO! UQ`O'#J}O!#ZQ!fO'#JqOOQ!0Lh'#Ci'#CiO%[QlO'#EQO!#yQ!fO,5:qOOQS'#Jx'#JxOOQO-E<h-E<hO9aQ`O,5=^O!$aQ`O,5=^O!$fQlO,5;XO!&iQMhO'#EiO!(SQ`O,5;XO!(XQlO'#DwO!(cQpO,5;bO!(kQpO,5;bO%[QlO,5;bOOQ['#FS'#FSOOQ['#FU'#FUO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cOOQ['#FY'#FYO!(yQlO,5;sOOQ!0Lf,5;x,5;xOOQ!0Lf,5;y,5;yOOQ!0Lf,5;{,5;{O%[QlO'#InO!*|Q!0LrO,5<hO%[QlO,5;cO!&iQMhO,5;cO!+kQMhO,5;cO!-]QMhO'#E[O%[QlO,5;vOOQ!0Lf,5;z,5;zO!-dQ,UO'#FiO!.aQ,UO'#KVO!-{Q,UO'#KVO!.hQ,UO'#KVOOQO'#KV'#KVO!.|Q,UO,5<ROOOW,5<_,5<_O!/_QlO'#FuOOOW'#Im'#ImO7VO7dO,5<PO!/fQ,UO'#FwOOQ!0Lf,5<P,5<PO!0VQ$IUO'#CwOOQ!0Lh'#C{'#C{O!0jO#@ItO'#DPO!1WQMjO,5<dO!1_Q`O,5<gO!2zQ(CWO'#GWO!3XQ`O'#GXO!3^Q`O'#GXO!4|Q(CWO'#G]O!6RQpO'#GaOOQO'#Gm'#GmO!+rQMhO'#GlOOQO'#Go'#GoO!+rQMhO'#GnO!6tQ$IUO'#JjOOQ!0Lh'#Jj'#JjO!7OQ`O'#JiO!7^Q`O'#JhO!7fQ`O'#CuOOQ!0Lh'#Cy'#CyO!7qQ`O'#C{OOQ!0Lh'#DT'#DTOOQ!0Lh'#DV'#DVO1SQ`O'#DXO!+rQMhO'#GOO!+rQMhO'#GQO!7vQ`O'#GSO!7{Q`O'#GTO!3^Q`O'#GZO!+rQMhO'#G`O;zQ`O'#JiO!8QQ`O'#EoO!8oQ`O,5<fOOQ!0Lb'#Cr'#CrO!8wQ`O'#EpO!9qQpO'#EqOOQ!0Lb'#KP'#KPO!9xQ!0LrO'#K_O9kQ!0LrO,5=bO`QlO,5>rOOQ['#Jf'#JfOOQ[,5>s,5>sOOQ[-E<Z-E<ZO!;wQ!0MxO,5:`O!9lQpO,5:^O!>bQ!0MxO,5:hO%[QlO,5:hO!@xQ!0MxO,5:jOOQO,5@x,5@xO!AiQMhO,5=^O!AwQ!0LrO'#JgO9UQ`O'#JgO!BYQ!0LrO,59ZO!BeQpO,59ZO!BmQMhO,59ZO:YQMhO,59ZO!BxQ`O,5;XO!CQQ`O'#H`O!CfQ`O'#KbO%[QlO,5;|O!9lQpO,5<OO!CnQ`O,5=yO!CsQ`O,5=yO!CxQ`O,5=yO9kQ!0LrO,5=yO;zQ`O,5=iOOQO'#Cw'#CwO!DWQpO,5=fO!D`QMhO,5=gO!DkQ`O,5=iO!DpQ!bO,5=lO!DxQ`O'#K^O>wQ`O'#HVO9aQ`O'#HXO!D}Q`O'#HXO:YQMhO'#HZO!ESQ`O'#HZOOQ[,5=o,5=oO!EXQ`O'#H[O!EjQ`O'#CoO!EoQ`O,59PO!EyQ`O,59PO!HOQlO,59POOQ[,59P,59PO!H`Q!0LrO,59PO%[QlO,59PO!JkQlO'#HcOOQ['#Hd'#HdOOQ['#He'#HeO`QlO,5={O!KRQ`O,5={O`QlO,5>RO`QlO,5>TO!KWQ`O,5>VO`QlO,5>XO!K]Q`O,5>[O!KbQlO,5>bOOQ[,5>h,5>hO%[QlO,5>hO9kQ!0LrO,5>jOOQ[,5>l,5>lO# lQ`O,5>lOOQ[,5>n,5>nO# lQ`O,5>nOOQ[,5>p,5>pO#!YQpO'#D]O%[QlO'#JtO#!{QpO'#JtO##VQpO'#DkO##hQpO'#DkO#%yQlO'#DkO#&QQ`O'#JsO#&YQ`O,5:UO#&_Q`O'#ErO#&mQ`O'#KSO#&uQ`O,5;]O#&zQpO'#DkO#'XQpO'#ETOOQ!0Lf,5:m,5:mO%[QlO,5:mO#'`Q`O,5:mO>wQ`O,5;WO!BeQpO,5;WO!BmQMhO,5;WO:YQMhO,5;WO#'hQ`O,5@`O#'mQ07dO,5:qOOQO-E<d-E<dO#(sQ!0MSO,5;POCuQpO,5:pO#(}QpO,5:pOCuQpO,5;PO!BYQ!0LrO,5:pOOQ!0Lb'#Eh'#EhOOQO,5;P,5;PO%[QlO,5;PO#)[Q!0LrO,5;PO#)gQ!0LrO,5;PO!BeQpO,5:pOOQO,5;V,5;VO#)uQ!0LrO,5;PPOOO'#I['#I[P#*ZO&2DjO,58|POOO,58|,58|OOOO-E<[-E<[OOQ!0Lh1G.p1G.pOOOO-E<]-E<]OOOO,59{,59{O#*fQ!bO,59{OOOO-E<_-E<_OOQ!0Lf1G/e1G/eO#*kQ!fO,5>|O+}QlO,5>|OOQO,5?S,5?SO#*uQlO'#IbOOQO-E<`-E<`O#+SQ`O,5@^O#+[Q!fO,5@^O#+cQ`O,5@lOOQ!0Lf1G/k1G/kO%[QlO,5@mO#+kQ`O'#IhOOQO-E<f-E<fO#+cQ`O,5@lOOQ!0Lb1G0v1G0vOOQ!0Ln1G/v1G/vOOQ!0Ln1G0W1G0WO%[QlO,5@jO#,PQ!0LrO,5@jO#,bQ!0LrO,5@jO#,iQ`O,5@iO9ZQ`O,5@iO#,qQ`O,5@iO#-PQ`O'#IkO#,iQ`O,5@iOOQ!0Lb1G0u1G0uO!(cQpO,5:sO!(nQpO,5:sOOQS,5:u,5:uO#-qQdO,5:uO#-yQMhO1G2xO9aQ`O1G2xOOQ!0Lf1G0s1G0sO#.XQ!0MxO1G0sO#/^Q!0MvO,5;TOOQ!0Lh'#GV'#GVO#/zQ!0MzO'#JjO!$fQlO1G0sO#2VQ!fO'#JuO%[QlO'#JuO#2aQ`O,5:cOOQ!0Lh'#D]'#D]OOQ!0Lf1G0|1G0|O%[QlO1G0|OOQ!0Lf1G1e1G1eO#2fQ`O1G0|O#4zQ!0MxO1G0}O#5RQ!0MxO1G0}O#7iQ!0MxO1G0}O#7pQ!0MxO1G0}O#:WQ!0MxO1G0}O#<nQ!0MxO1G0}O#<uQ!0MxO1G0}O#<|Q!0MxO1G0}O#?dQ!0MxO1G0}O#?kQ!0MxO1G0}O#AxQ?MtO'#CiO#CsQ?MtO1G1_O#CzQ?MtO'#JqO#D_Q!0MxO,5?YOOQ!0Lb-E<l-E<lO#FlQ!0MxO1G0}O#GiQ!0MzO1G0}OOQ!0Lf1G0}1G0}O#HlQMjO'#JzO#HvQ`O,5:vO#H{Q!0MxO1G1bO#IoQ,UO,5<VO#IwQ,UO,5<WO#JPQ,UO'#FnO#JhQ`O'#FmOOQO'#KW'#KWOOQO'#Il'#IlO#JmQ,UO1G1mOOQ!0Lf1G1m1G1mOOOW1G1x1G1xO#KOQ?MtO'#JpO#KYQ`O,5<aO!(yQlO,5<aOOOW-E<k-E<kOOQ!0Lf1G1k1G1kO#K_QpO'#KVOOQ!0Lf,5<c,5<cO#KgQpO,5<cO#KlQMhO'#DROOOO'#I`'#I`O#KsO#@ItO,59kOOQ!0Lh,59k,59kO%[QlO1G2OO!7{Q`O'#IpO#LOQ`O,5<yOOQ!0Lh,5<v,5<vO!+rQMhO'#IsO#LlQMjO,5=WO!+rQMhO'#IuO#M_QMjO,5=YO!&iQMhO,5=[OOQO1G2R1G2RO#MiQ!dO'#CrO#M|Q(CWO'#EpO$ RQpO'#GaO$ iQ!dO,5<rO$ pQ`O'#KYO9ZQ`O'#KYO$!OQ`O,5<tO!+rQMhO,5<sO$!TQ`O'#GYO$!fQ`O,5<sO$!kQ!dO'#GVO$!xQ!dO'#KZO$#SQ`O'#KZO!&iQMhO'#KZO$#XQ`O,5<wO$#^QlO'#JtO$#hQpO'#GbO##hQpO'#GbO$#yQ`O'#GfO!3^Q`O'#GjO$$OQ!0LrO'#IrO$$ZQpO,5<{OOQ!0Lp,5<{,5<{O$$bQpO'#GbO$$oQpO'#GcO$%QQpO'#GcO$%VQMjO,5=WO$%gQMjO,5=YOOQ!0Lh,5=],5=]O!+rQMhO,5@TO!+rQMhO,5@TO$%wQ`O'#IwO$&VQ`O,5@SO$&_Q`O,59aOOQ!0Lh,59g,59gO$'UQ$IYO,59sOOQ!0Lh'#Jn'#JnO$'wQMjO,5<jO$(jQMjO,5<lO@iQ`O,5<nOOQ!0Lh,5<o,5<oO$(tQ`O,5<uO$(yQMjO,5<zO$)ZQ`O,5@TO$)iQ`O'#J}O!$fQlO1G2QO$)nQ`O1G2QO9ZQ`O'#KQO9ZQ`O'#ErO%[QlO'#ErO9ZQ`O'#IyO$)sQ!0LrO,5@yOOQ[1G2|1G2|OOQ[1G4^1G4^OOQ!0Lf1G/z1G/zOOQ!0Lf1G/x1G/xO$+uQ!0MxO1G0SOOQ[1G2x1G2xO!&iQMhO1G2xO%[QlO1G2xO#-|Q`O1G2xO$-yQMhO'#EiOOQ!0Lb,5@R,5@RO$.WQ!0LrO,5@ROOQ[1G.u1G.uO!BYQ!0LrO1G.uO!BeQpO1G.uO!BmQMhO1G.uO$.iQ`O1G0sO$.nQ`O'#CiO$.yQ`O'#KcO$/RQ`O,5=zO$/WQ`O'#KcO$/]Q`O'#KcO$/kQ`O'#JPO$/yQ`O,5@|O$0RQ!fO1G1hOOQ!0Lf1G1j1G1jO9aQ`O1G3eO@iQ`O1G3eO$0YQ`O1G3eO$0_Q`O1G3eOOQ[1G3e1G3eO!DkQ`O1G3TO!&iQMhO1G3QO$0dQ`O1G3QOOQ[1G3R1G3RO!&iQMhO1G3RO$0iQ`O1G3RO$0qQpO'#HPOOQ[1G3T1G3TO!5|QpO'#I{O!DpQ!bO1G3WOOQ[1G3W1G3WOOQ[,5=q,5=qO$0yQMhO,5=sO9aQ`O,5=sO$#yQ`O,5=uO9UQ`O,5=uO!BeQpO,5=uO!BmQMhO,5=uO:YQMhO,5=uO$1XQ`O'#KaO$1dQ`O,5=vOOQ[1G.k1G.kO$1iQ!0LrO1G.kO@iQ`O1G.kO$1tQ`O1G.kO9kQ!0LrO1G.kO$3|Q!fO,5AOO$4ZQ`O,5AOO9ZQ`O,5AOO$4fQlO,5=}O$4mQ`O,5=}OOQ[1G3g1G3gO`QlO1G3gOOQ[1G3m1G3mOOQ[1G3o1G3oO>rQ`O1G3qO$4rQlO1G3sO$8vQlO'#HrOOQ[1G3v1G3vO$9TQ`O'#HxO>wQ`O'#HzOOQ[1G3|1G3|O$9]QlO1G3|O9kQ!0LrO1G4SOOQ[1G4U1G4UOOQ!0Lb'#G^'#G^O9kQ!0LrO1G4WO9kQ!0LrO1G4YO$=dQ`O,5@`O!(yQlO,5;^O9ZQ`O,5;^O>wQ`O,5:VO!(yQlO,5:VO!BeQpO,5:VO$=iQ?MtO,5:VOOQO,5;^,5;^O$=sQpO'#IcO$>ZQ`O,5@_OOQ!0Lf1G/p1G/pO$>cQpO'#IiO$>mQ`O,5@nOOQ!0Lb1G0w1G0wO##hQpO,5:VOOQO'#Ie'#IeO$>uQpO,5:oOOQ!0Ln,5:o,5:oO#'cQ`O1G0XOOQ!0Lf1G0X1G0XO%[QlO1G0XOOQ!0Lf1G0r1G0rO>wQ`O1G0rO!BeQpO1G0rO!BmQMhO1G0rOOQ!0Lb1G5z1G5zO!BYQ!0LrO1G0[OOQO1G0k1G0kO%[QlO1G0kO$>|Q!0LrO1G0kO$?XQ!0LrO1G0kO!BeQpO1G0[OCuQpO1G0[O$?gQ!0LrO1G0kOOQO1G0[1G0[O$?{Q!0MxO1G0kPOOO-E<Y-E<YPOOO1G.h1G.hOOOO1G/g1G/gO$@VQ!bO,5<hO$@_Q!fO1G4hOOQO1G4n1G4nO%[QlO,5>|O$@iQ`O1G5xO$@qQ`O1G6WO$@yQ!fO1G6XO9ZQ`O,5?SO$ATQ!0MxO1G6UO%[QlO1G6UO$AeQ!0LrO1G6UO$AvQ`O1G6TO$AvQ`O1G6TO9ZQ`O1G6TO$BOQ`O,5?VO9ZQ`O,5?VOOQO,5?V,5?VO$BdQ`O,5?VO$)iQ`O,5?VOOQO-E<i-E<iOOQS1G0_1G0_OOQS1G0a1G0aO#-tQ`O1G0aOOQ[7+(d7+(dO!&iQMhO7+(dO%[QlO7+(dO$BrQ`O7+(dO$B}QMhO7+(dO$C]Q!0MzO,5=WO$EhQ!0MzO,5=YO$GsQ!0MzO,5=WO$JUQ!0MzO,5=YO$LgQ!0MzO,59sO$NlQ!0MzO,5<jO%!wQ!0MzO,5<lO%%SQ!0MzO,5<zOOQ!0Lf7+&_7+&_O%'eQ!0MxO7+&_O%(XQlO'#IdO%(fQ`O,5@aO%(nQ!fO,5@aOOQ!0Lf1G/}1G/}O%(xQ`O7+&hOOQ!0Lf7+&h7+&hO%(}Q?MtO,5:dO%[QlO7+&yO%)XQ?MtO,5:`O%)fQ?MtO,5:hO%)pQ?MtO,5:jO%)zQMhO'#IgO%*UQ`O,5@fOOQ!0Lh1G0b1G0bOOQO1G1q1G1qOOQO1G1r1G1rO%*^Q!jO,5<YO!(yQlO,5<XOOQO-E<j-E<jOOQ!0Lf7+'X7+'XOOOW7+'d7+'dOOOW1G1{1G1{O%*iQ`O1G1{OOQ!0Lf1G1}1G1}OOOO,59m,59mO%*nQ!dO,59mOOOO-E<^-E<^OOQ!0Lh1G/V1G/VO%*uQ!0MxO7+'jOOQ!0Lh,5?[,5?[O%+iQMhO1G2eP%+pQ`O'#IpPOQ!0Lh-E<n-E<nO%,^QMjO,5?_OOQ!0Lh-E<q-E<qO%-PQMjO,5?aOOQ!0Lh-E<s-E<sO%-ZQ!dO1G2vO%-bQ!dO'#CrO%-xQMhO'#KQO$#^QlO'#JtOOQ!0Lh1G2^1G2^O%.PQ`O'#IoO%.eQ`O,5@tO%.eQ`O,5@tO%.mQ`O,5@tO%.xQ`O,5@tOOQO1G2`1G2`O%/WQMjO1G2_O!+rQMhO1G2_O%/hQ(CWO'#IqO%/uQ`O,5@uO!&iQMhO,5@uO%/}Q!dO,5@uOOQ!0Lh1G2c1G2cO%2_Q!fO'#CiO%2iQ`O,5=OOOQ!0Lb,5<|,5<|O%2qQpO,5<|OOQ!0Lb,5<},5<}OCfQ`O,5<|O%2|QpO,5<|OOQ!0Lb,5=Q,5=QO$)iQ`O,5=UOOQO,5?^,5?^OOQO-E<p-E<pOOQ!0Lp1G2g1G2gO##hQpO,5<|O$#^QlO,5=OO%3[Q`O,5<}O%3gQpO,5<}O!+rQMhO'#IsO%4aQMjO1G2rO!+rQMhO'#IuO%5SQMjO1G2tO%5^QMjO1G5oO%5hQMjO1G5oOOQO,5?c,5?cOOQO-E<u-E<uOOQO1G.{1G.{O!9lQpO,59uO%[QlO,59uOOQ!0Lh,5<i,5<iO%5uQ`O1G2YO!+rQMhO1G2aO!+rQMhO1G5oO!+rQMhO1G5oO%5zQ!0MxO7+'lOOQ!0Lf7+'l7+'lO!$fQlO7+'lO%6nQ`O,5;^OOQ!0Lb,5?e,5?eOOQ!0Lb-E<w-E<wO%6sQ!dO'#K[O#'cQ`O7+(dO4UQ!fO7+(dO$BuQ`O7+(dO%6}Q!0MvO'#CiO%7nQ!0LrO,5=RO%8PQ!0MvO,5=RO%8dQ`O,5=ROOQ!0Lb1G5m1G5mOOQ[7+$a7+$aO!BYQ!0LrO7+$aO!BeQpO7+$aO!$fQlO7+&_O%8lQ`O'#JOO%9TQ`O,5@}OOQO1G3f1G3fO9aQ`O,5@}O%9TQ`O,5@}O%9]Q`O,5@}OOQO,5?k,5?kOOQO-E<}-E<}OOQ!0Lf7+'S7+'SO%9bQ`O7+)PO9kQ!0LrO7+)PO9aQ`O7+)PO@iQ`O7+)POOQ[7+(o7+(oO%9gQ!0MvO7+(lO!&iQMhO7+(lO!DfQ`O7+(mOOQ[7+(m7+(mO!&iQMhO7+(mO%9qQ`O'#K`O%9|Q`O,5=kOOQO,5?g,5?gOOQO-E<y-E<yOOQ[7+(r7+(rO%;`QpO'#HYOOQ[1G3_1G3_O!&iQMhO1G3_O%[QlO1G3_O%;gQ`O1G3_O%;rQMhO1G3_O9kQ!0LrO1G3aO$#yQ`O1G3aO9UQ`O1G3aO!BeQpO1G3aO!BmQMhO1G3aO%<QQ`O'#I}O%<fQ`O,5@{O%<nQpO,5@{OOQ!0Lb1G3b1G3bOOQ[7+$V7+$VO@iQ`O7+$VO9kQ!0LrO7+$VO%<yQ`O7+$VO%[QlO1G6jO%[QlO1G6kO%=OQ!0LrO1G6jO%=YQlO1G3iO%=aQ`O1G3iO%=fQlO1G3iOOQ[7+)R7+)RO9kQ!0LrO7+)]O`QlO7+)_OOQ['#Kf'#KfOOQ['#JQ'#JQO%=mQlO,5>^OOQ[,5>^,5>^O%[QlO'#HsO%=zQ`O'#HuOOQ[,5>d,5>dO9ZQ`O,5>dOOQ[,5>f,5>fOOQ[7+)h7+)hOOQ[7+)n7+)nOOQ[7+)r7+)rOOQ[7+)t7+)tO%>PQpO1G5zO%>kQ?MtO1G0xO%>uQ`O1G0xOOQO1G/q1G/qO%?QQ?MtO1G/qO>wQ`O1G/qO!(yQlO'#DkOOQO,5>},5>}OOQO-E<a-E<aOOQO,5?T,5?TOOQO-E<g-E<gO!BeQpO1G/qOOQO-E<c-E<cOOQ!0Ln1G0Z1G0ZOOQ!0Lf7+%s7+%sO#'cQ`O7+%sOOQ!0Lf7+&^7+&^O>wQ`O7+&^O!BeQpO7+&^OOQO7+%v7+%vO$?{Q!0MxO7+&VOOQO7+&V7+&VO%[QlO7+&VO%?[Q!0LrO7+&VO!BYQ!0LrO7+%vO!BeQpO7+%vO%?gQ!0LrO7+&VO%?uQ!0MxO7++pO%[QlO7++pO%@VQ`O7++oO%@VQ`O7++oOOQO1G4q1G4qO9ZQ`O1G4qO%@_Q`O1G4qOOQS7+%{7+%{O#'cQ`O<<LOO4UQ!fO<<LOO%@mQ`O<<LOOOQ[<<LO<<LOO!&iQMhO<<LOO%[QlO<<LOO%@uQ`O<<LOO%AQQ!0MzO,5?_O%C]Q!0MzO,5?aO%EhQ!0MzO1G2_O%GyQ!0MzO1G2rO%JUQ!0MzO1G2tO%LaQ!fO,5?OO%[QlO,5?OOOQO-E<b-E<bO%LkQ`O1G5{OOQ!0Lf<<JS<<JSO%LsQ?MtO1G0sO%NzQ?MtO1G0}O& RQ?MtO1G0}O&#SQ?MtO1G0}O&#ZQ?MtO1G0}O&%[Q?MtO1G0}O&']Q?MtO1G0}O&'dQ?MtO1G0}O&'kQ?MtO1G0}O&)lQ?MtO1G0}O&)sQ?MtO1G0}O&)zQ!0MxO<<JeO&+rQ?MtO1G0}O&,oQ?MvO1G0}O&-rQ?MvO'#JjO&/xQ?MtO1G1bO&0VQ?MtO1G0SO&0aQMjO,5?ROOQO-E<e-E<eO!(yQlO'#FpOOQO'#KX'#KXOOQO1G1t1G1tO&0kQ`O1G1sO&0pQ?MtO,5?YOOOW7+'g7+'gOOOO1G/X1G/XO&0zQ!dO1G4vOOQ!0Lh7+(P7+(PP!&iQMhO,5?[O!+rQMhO7+(bO&1RQ`O,5?ZO9ZQ`O,5?ZOOQO-E<m-E<mO&1aQ`O1G6`O&1aQ`O1G6`O&1iQ`O1G6`O&1tQMjO7+'yO&2UQ!dO,5?]O&2`Q`O,5?]O!&iQMhO,5?]OOQO-E<o-E<oO&2eQ!dO1G6aO&2oQ`O1G6aO&2wQ`O1G2jO!&iQMhO1G2jOOQ!0Lb1G2h1G2hOOQ!0Lb1G2i1G2iO%2qQpO1G2hO!BeQpO1G2hOCfQ`O1G2hOOQ!0Lb1G2p1G2pO&2|QpO1G2hO&3[Q`O1G2jO$)iQ`O1G2iOCfQ`O1G2iO$#^QlO1G2jO&3dQ`O1G2iO&4WQMjO,5?_OOQ!0Lh-E<r-E<rO&4yQMjO,5?aOOQ!0Lh-E<t-E<tO!+rQMhO7++ZOOQ!0Lh1G/a1G/aO&5TQ`O1G/aOOQ!0Lh7+'t7+'tO&5YQMjO7+'{O&5jQMjO7++ZO&5tQMjO7++ZO&6RQ!0MxO<<KWOOQ!0Lf<<KW<<KWO&6uQ`O1G0xO!&iQMhO'#IxO&6zQ`O,5@vO&8|Q!fO<<LOO!&iQMhO1G2mO&9TQ!0LrO1G2mOOQ[<<G{<<G{O!BYQ!0LrO<<G{O&9fQ!0MxO<<IyOOQ!0Lf<<Iy<<IyOOQO,5?j,5?jO&:YQ`O,5?jO&:_Q`O,5?jOOQO-E<|-E<|O&:mQ`O1G6iO&:mQ`O1G6iO9aQ`O1G6iO@iQ`O<<LkOOQ[<<Lk<<LkO&:uQ`O<<LkO9kQ!0LrO<<LkOOQ[<<LW<<LWO%9gQ!0MvO<<LWOOQ[<<LX<<LXO!DfQ`O<<LXO&:zQpO'#IzO&;VQ`O,5@zO!(yQlO,5@zOOQ[1G3V1G3VOOQO'#I|'#I|O9kQ!0LrO'#I|O&;_QpO,5=tOOQ[,5=t,5=tO&;fQpO'#EeO&;mQpO'#GdO&;rQ`O7+(yO&;wQ`O7+(yOOQ[7+(y7+(yO!&iQMhO7+(yO%[QlO7+(yO&<PQ`O7+(yOOQ[7+({7+({O9kQ!0LrO7+({O$#yQ`O7+({O9UQ`O7+({O!BeQpO7+({O&<[Q`O,5?iOOQO-E<{-E<{OOQO'#H]'#H]O&<gQ`O1G6gO9kQ!0LrO<<GqOOQ[<<Gq<<GqO@iQ`O<<GqO&<oQ`O7+,UO&<tQ`O7+,VO%[QlO7+,UO%[QlO7+,VOOQ[7+)T7+)TO&<yQ`O7+)TO&=OQlO7+)TO&=VQ`O7+)TOOQ[<<Lw<<LwOOQ[<<Ly<<LyOOQ[-E=O-E=OOOQ[1G3x1G3xO&=[Q`O,5>_OOQ[,5>a,5>aO&=aQ`O1G4OO9ZQ`O7+&dO!(yQlO7+&dOOQO7+%]7+%]O&=fQ?MtO1G6XO>wQ`O7+%]OOQ!0Lf<<I_<<I_OOQ!0Lf<<Ix<<IxO>wQ`O<<IxOOQO<<Iq<<IqO$?{Q!0MxO<<IqO%[QlO<<IqOOQO<<Ib<<IbO!BYQ!0LrO<<IbO&=pQ!0LrO<<IqO&={Q!0MxO<= [O&>]Q`O<= ZOOQO7+*]7+*]O9ZQ`O7+*]OOQ[ANAjANAjO&>eQ!fOANAjO!&iQMhOANAjO#'cQ`OANAjO4UQ!fOANAjO&>lQ`OANAjO%[QlOANAjO&>tQ!0MzO7+'yO&AVQ!0MzO,5?_O&CbQ!0MzO,5?aO&EmQ!0MzO7+'{O&HOQ!fO1G4jO&HYQ?MtO7+&_O&J^Q?MvO,5=WO&LeQ?MvO,5=YO&LuQ?MvO,5=WO&MVQ?MvO,5=YO&MgQ?MvO,59sO' mQ?MvO,5<jO'#pQ?MvO,5<lO'&UQ?MvO,5<zO''zQ?MtO7+'jO'(XQ?MtO7+'lO'(fQ`O,5<[OOQO7+'_7+'_OOQ!0Lh7+*b7+*bO'(kQMjO<<K|OOQO1G4u1G4uO'(rQ`O1G4uO'(}Q`O1G4uO')]Q`O7++zO')]Q`O7++zO!&iQMhO1G4wO')eQ!dO1G4wO')oQ`O7++{O')wQ`O7+(UO'*SQ!dO7+(UOOQ!0Lb7+(S7+(SOOQ!0Lb7+(T7+(TO!BeQpO7+(SOCfQ`O7+(SO'*^Q`O7+(UO!&iQMhO7+(UO$)iQ`O7+(TO'*cQ`O7+(UOCfQ`O7+(TO'*kQMjO<<NuOOQ!0Lh7+${7+${O!+rQMhO<<NuO'*uQ!dO,5?dOOQO-E<v-E<vO'+PQ!0MvO7+(XO!&iQMhO7+(XOOQ[AN=gAN=gO9aQ`O1G5UOOQO1G5U1G5UO'+aQ`O1G5UO'+fQ`O7+,TO'+fQ`O7+,TO9kQ!0LrOANBVO@iQ`OANBVOOQ[ANBVANBVOOQ[ANArANArOOQ[ANAsANAsO'+nQ`O,5?fOOQO-E<x-E<xO'+yQ?MtO1G6fOOQO,5?h,5?hOOQO-E<z-E<zOOQ[1G3`1G3`O',TQ`O,5=OOOQ[<<Le<<LeO!&iQMhO<<LeO&;rQ`O<<LeO',YQ`O<<LeO%[QlO<<LeOOQ[<<Lg<<LgO9kQ!0LrO<<LgO$#yQ`O<<LgO9UQ`O<<LgO',bQpO1G5TO',mQ`O7+,ROOQ[AN=]AN=]O9kQ!0LrOAN=]OOQ[<= p<= pOOQ[<= q<= qO',uQ`O<= pO',zQ`O<= qOOQ[<<Lo<<LoO'-PQ`O<<LoO'-UQlO<<LoOOQ[1G3y1G3yO>wQ`O7+)jO'-]Q`O<<JOO'-hQ?MtO<<JOOOQO<<Hw<<HwOOQ!0LfAN?dAN?dOOQOAN?]AN?]O$?{Q!0MxOAN?]OOQOAN>|AN>|O%[QlOAN?]OOQO<<Mw<<MwOOQ[G27UG27UO!&iQMhOG27UO#'cQ`OG27UO'-rQ!fOG27UO4UQ!fOG27UO'-yQ`OG27UO'.RQ?MtO<<JeO'.`Q?MvO1G2_O'0UQ?MvO,5?_O'2XQ?MvO,5?aO'4[Q?MvO1G2rO'6_Q?MvO1G2tO'8bQ?MtO<<KWO'8oQ?MtO<<IyOOQO1G1v1G1vO!+rQMhOANAhOOQO7+*a7+*aO'8|Q`O7+*aO'9XQ`O<= fO'9aQ!dO7+*cOOQ!0Lb<<Kp<<KpO$)iQ`O<<KpOCfQ`O<<KpO'9kQ`O<<KpO!&iQMhO<<KpOOQ!0Lb<<Kn<<KnO!BeQpO<<KnO'9vQ!dO<<KpOOQ!0Lb<<Ko<<KoO':QQ`O<<KpO!&iQMhO<<KpO$)iQ`O<<KoO':VQMjOANDaO':aQ!0MvO<<KsOOQO7+*p7+*pO9aQ`O7+*pO':qQ`O<= oOOQ[G27qG27qO9kQ!0LrOG27qO!(yQlO1G5QO':yQ`O7+,QO';RQ`O1G2jO&;rQ`OANBPOOQ[ANBPANBPO!&iQMhOANBPO';WQ`OANBPOOQ[ANBRANBRO9kQ!0LrOANBRO$#yQ`OANBROOQO'#H^'#H^OOQO7+*o7+*oOOQ[G22wG22wOOQ[ANE[ANE[OOQ[ANE]ANE]OOQ[ANBZANBZO';`Q`OANBZOOQ[<<MU<<MUO!(yQlOAN?jOOQOG24wG24wO$?{Q!0MxOG24wO#'cQ`OLD,pOOQ[LD,pLD,pO!&iQMhOLD,pO';eQ!fOLD,pO';lQ?MvO7+'yO'=bQ?MvO,5?_O'?eQ?MvO,5?aO'AhQ?MvO7+'{O'C^QMjOG27SOOQO<<M{<<M{OOQ!0LbANA[ANA[O$)iQ`OANA[OCfQ`OANA[O'CnQ!dOANA[OOQ!0LbANAYANAYO'CuQ`OANA[O!&iQMhOANA[O'DQQ!dOANA[OOQ!0LbANAZANAZOOQO<<N[<<N[OOQ[LD-]LD-]O'D[Q?MtO7+*lOOQO'#Ge'#GeOOQ[G27kG27kO&;rQ`OG27kO!&iQMhOG27kOOQ[G27mG27mO9kQ!0LrOG27mOOQ[G27uG27uO'DfQ?MtOG25UOOQOLD*cLD*cOOQ[!$(![!$(![O#'cQ`O!$(![O!&iQMhO!$(![O'DpQ!0MzOG27SOOQ!0LbG26vG26vO$)iQ`OG26vO'GRQ`OG26vOCfQ`OG26vO'G^Q!dOG26vO!&iQMhOG26vOOQ[LD-VLD-VO&;rQ`OLD-VOOQ[LD-XLD-XOOQ[!)9Ev!)9EvO#'cQ`O!)9EvOOQ!0LbLD,bLD,bO$)iQ`OLD,bOCfQ`OLD,bO'GeQ`OLD,bO'GpQ!dOLD,bOOQ[!$(!q!$(!qOOQ[!.K;b!.K;bO'GwQ?MvOG27SOOQ!0Lb!$( |!$( |O$)iQ`O!$( |OCfQ`O!$( |O'ImQ`O!$( |OOQ!0Lb!)9Eh!)9EhO$)iQ`O!)9EhOCfQ`O!)9EhOOQ!0Lb!.K;S!.K;SO$)iQ`O!.K;SOOQ!0Lb!4/0n!4/0nO!(yQlO'#DxO1PQ`O'#EVO'IxQ!fO'#JpO'JPQ!L^O'#DtO'JWQlO'#D|O'J_Q!fO'#CiO'LuQ!fO'#CiO!(yQlO'#EOO'MVQlO,5;XO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO'#InO( YQ`O,5<hO!(yQlO,5;cO( bQMhO,5;cO(!{QMhO,5;cO!(yQlO,5;vO!&iQMhO'#GlO( bQMhO'#GlO!&iQMhO'#GnO( bQMhO'#GnO1SQ`O'#DXO1SQ`O'#DXO!&iQMhO'#GOO( bQMhO'#GOO!&iQMhO'#GQO( bQMhO'#GQO!&iQMhO'#G`O( bQMhO'#G`O!(yQlO,5:hO(#SQpO'#D]O(#^QpO'#JtO!(yQlO,5@mO'MVQlO1G0sO(#hQ?MtO'#CiO!(yQlO1G2OO!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO(#rQ!dO'#CrO!&iQMhO,5<sO( bQMhO,5<sO'MVQlO1G2QO!(yQlO7+&yO!&iQMhO1G2_O( bQMhO1G2_O!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO!&iQMhO1G2aO( bQMhO1G2aO'MVQlO7+'lO'MVQlO7+&_O!&iQMhOANAhO( bQMhOANAhO($VQ`O'#EmO($[Q`O'#EmO($dQ`O'#F[O($iQ`O'#EwO($nQ`O'#KRO($yQ`O'#KPO(%UQ`O,5;XO(%ZQMjO,5<dO(%bQ`O'#GXO(%gQ`O'#GXO(%lQ`O,5<fO(%tQ`O,5;XO(%|Q?MtO1G1_O(&TQ`O,5<sO(&YQ`O,5<sO(&_Q`O,5<uO(&dQ`O,5<uO(&iQ`O1G2QO(&nQ`O1G0sO(&sQMjO<<K|O(&zQMjO<<K|O7eQMhO'#F{O9UQ`O'#FzOAdQ`O'#ElO!(yQlO,5;sO!3^Q`O'#GXO!3^Q`O'#GXO!3^Q`O'#GZO!3^Q`O'#GZO!+rQMhO7+(bO!+rQMhO7+(bO%-ZQ!dO1G2vO%-ZQ!dO1G2vO!&iQMhO,5=[O!&iQMhO,5=[",stateData:"((P~O'zOS'{OSTOS'|RQ~OPYOQYOSfOY!VOaqOdzOeyOj!POnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!swO!vxO!z]O$V|O$miO%g}O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO&U!WO&[!XO&^!YO&`!ZO&b![O&e!]O&k!^O&q!_O&s!`O&u!aO&w!bO&y!cO(RSO(TTO(WUO(_VO(m[O~OWtO~P`OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa!wOq!nO!Q!oO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!xO#U!pO#V!pO#Y!zO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O'|!{O~OP]XR]X[]Xa]Xp]X!O]X!Q]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X'x]X(_]X(p]X(w]X(x]X~O!e%QX~P(qO_!}O(T#PO(U!}O(V#PO~O_#QO(V#PO(W#PO(X#QO~Ov#SO!S#TO(`#TO(a#VO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R;{O(TTO(WUO(_VO(m[O~O!Y#ZO!Z#WO!W(fP!W(tP~P+}O![#cO~P`OPYOQYOSfOd!jOe!iOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(TTO(WUO(_VO(m[O~On#mO!Y#iO!z]O#g#lO#h#iO(R;|O!i(qP~P.iO!j#oO(R#nO~O!v#sO!z]O%g#tO~O#i#uO~O!e#vO#i#uO~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z$_O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa(dX'x(dX'u(dX!i(dX!W(dX!](dX%h(dX!e(dX~P1qO#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX!](eX%h(eX~Oa(eX'x(eX'u(eX!W(eX!i(eXt(eX!e(eX~P4UO#^$eO~O$[$hO$^$gO$e$mO~OSfO!]$nO$h$oO$j$qO~Oh%VOj%cOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R$sO(TTO(WUO(_$uO(w$}O(x%POg([P~O!j%dO~O!Q%gO!]%hO(R%fO~O!e%lO~Oa%mO'x%mO~O!O%qO~P%[O(S!lO~P%[O%m%uO~P%[Oh%VO!j%dO(R%fO(S!lO~Oe%|O!j%dO(R%fO~O#t$RO~O!O&RO!]&OO!j&QO%i&UO(R%fO(S!lO(TTO(WUO`)UP~O!v#sO~O%r&WO!Q)QX!])QX(R)QX~O(R&XO~Oj!PO!s&^O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO~Od&cOe&bO!v&`O%g&aO%z&_O~P<POd&fOeyOj!PO!]&eO!s&^O!vxO!z]O%g}O%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO~Ob&iO#^&lO%i&gO(S!lO~P=UO!j&mO!s&qO~O!j#oO~O!]XO~Oa%mO'v&yO'x%mO~Oa%mO'v&|O'x%mO~Oa%mO'v'OO'x%mO~O'u]X!W]Xt]X!i]X&Y]X!]]X%h]X!e]X~P(qO!`']O!a'UO!b'UO(S!lO(TTO(WUO~Oq'SO!Q'RO!Y'VO(c'QO![(gP![(vP~P@]Ol'`O!]'^O(R%fO~Oe'eO!j%dO(R%fO~O!O&RO!j&QO~Oq!nO!Q!oO!z;wO#R!pO#S!pO#U!pO#V!pO(S!lO(TTO(WUO(c!mO(m!sO~O!`'kO!a'jO!b'jO#T!pO#Y'lO#Z'lO~PAwOa%mOh%VO!e#vO!j%dO'x%mO(p'nO~O!n'rO#^'pO~PCVOq!nO!Q!oO(TTO(WUO(c!mO(m!sO~O!]XOq(kX!Q(kX!`(kX!a(kX!b(kX!z(kX#R(kX#S(kX#T(kX#U(kX#V(kX#Y(kX#Z(kX(S(kX(T(kX(W(kX(c(kX(m(kX~O!a'jO!b'jO(S!lO~PCuO'}'vO(O'vO(P'xO~O_!}O(T'zO(U!}O(V'zO~O_#QO(V'zO(W'zO(X#QO~Ot'|O~P%[Ov#SO!S#TO(`#TO(a(PO~O!Y(RO!W'UX!W'[X!Z'UX!Z'[X~P+}O!Z(TO!W(fX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z(TO!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~O!W(fX~PGpO!W(YO~O!W(sX!Z(sX!e(sX!i(sX(p(sX~O#^(sX#i#bX![(sX~PIsO#^(ZO!W(uX!Z(uX~O!Z([O!W(tX~O!W(_O~O#^$eO~PIsO![(`O~P`OR#zO!O#yO!Q#{O!j#xO(_VOP!la[!lap!la!Z!la!n!la#P!la#l!la#m!la#n!la#o!la#p!la#q!la#r!la#s!la#t!la#u!la#w!la#y!la#z!la(p!la(w!la(x!la~Oa!la'x!la'u!la!W!la!i!lat!la!]!la%h!la!e!la~PKZO!i(aO~O!e#vO#^(bO(p'nO!Z(rXa(rX'x(rX~O!i(rX~PMvO!Q%gO!]%hO!z]O#g(gO#h(fO(R%fO~O!Z(hO!i(qX~O!i(jO~O!Q%gO!]%hO#h(fO(R%fO~OP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O!e#vO!i(eX~P! dOR(lO!O(kO!j#xO#Q$dO!z!ya!Q!ya~O!v!ya%g!ya!]!ya#g!ya#h!ya(R!ya~P!#eO!v(pO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~O#i(vO~O!Y(xO!i(iP~P%[O(c(zO(m[O~O!Q(|O!j#xO(c(zO(m[O~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z$_Oa$pa'x$pa'u$pa!i$pa!W$pa!]$pa%h$pa!e$pa~Oj)bO~P!&iOh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Og(nP~P!+rO!O)gO!e)fO!]$]X$Y$]X$[$]X$^$]X$e$]X~O!e)fO!](yX$Y(yX$[(yX$^(yX$e(yX~O!O)gO~P!-{O!O)gO!](yX$Y(yX$[(yX$^(yX$e(yX~O!])iO$Y)mO$[)hO$^)hO$e)nO~O!Y)qO~P!(yO$[$hO$^$gO$e)uO~Ol$yX!O$yX#Q$yX'w$yX(w$yX(x$yX~OgkXg$yXlkX!ZkX#^kX~P!/qOv)wO(`)xO(a)zO~Ol*TO!O)|O'w)}O(w$}O(x%PO~Og){O~P!0uOg*UO~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q*WO!]*XO!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~O!Y*[O(R*VO!i(|P~P!1dO#i*^O~O!j*_O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R*aO(TTO(WUO(_$uO(w$}O(x%PO~O!Y*dO!W(}P~P!3cOp*pOq!nO!Q*fO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO(c!mO~O![*mO~P!5WO#Q$dOl(^X!O(^X'w(^X(w(^X(x(^X!Z(^X#^(^X~Og(^X#}(^X~P!6YOl*uO#^*tOg(]X!Z(]X~O!Z*vOg([X~Oj%cO(R&XOg([P~Oq*yO~O!j+OO~O(R(tO~On+TO!Q%gO!Y#iO!]%hO!z]O#g#lO#h#iO(R%fO!i(qP~O!e#vO#i+UO~O!Q%gO!Y+WO!Z([O!]%hO(R%fO!W(tP~Oq'YO!Q+YO!Y+XO(TTO(WUO(c(zO~O![(vP~P!9]O!Z+ZOa)RX'x)RX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa!ha!Z!ha'x!ha'u!ha!W!ha!i!hat!ha!]!ha%h!ha!e!ha~P!:TOR#zO!O#yO!Q#{O!j#xO(_VOP!pa[!pap!pa!Z!pa!n!pa#P!pa#l!pa#m!pa#n!pa#o!pa#p!pa#q!pa#r!pa#s!pa#t!pa#u!pa#w!pa#y!pa#z!pa(p!pa(w!pa(x!pa~Oa!pa'x!pa'u!pa!W!pa!i!pat!pa!]!pa%h!pa!e!pa~P!<kOR#zO!O#yO!Q#{O!j#xO(_VOP!ra[!rap!ra!Z!ra!n!ra#P!ra#l!ra#m!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#w!ra#y!ra#z!ra(p!ra(w!ra(x!ra~Oa!ra'x!ra'u!ra!W!ra!i!rat!ra!]!ra%h!ra!e!ra~P!?ROh%VOl+dO!]'^O%h+cO~O!e+fOa(ZX!](ZX'x(ZX!Z(ZX~Oa%mO!]XO'x%mO~Oh%VO!j%dO~Oh%VO!j%dO(R%fO~O!e#vO#i(vO~Ob+qO%i+rO(R+nO(TTO(WUO![)VP~O!Z+sO`)UX~O[+wO~O`+xO~O!]&OO(R%fO(S!lO`)UP~Oh%VO#^+}O~Oh%VOl,QO!]$|O~O!],SO~O!O,UO!]XO~O%m%uO~O!v,ZO~Oe,`O~Ob,aO(R#nO(TTO(WUO![)TP~Oe%|O~O%i!QO(R&XO~P=UO[,fO`,eO~OPYOQYOSfOdzOeyOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!guO!jZO!mYO!nYO!oYO!qvO!vxO!z]O$miO%g}O(TTO(WUO(_VO(m[O~O!]!eO!s!gO$V!kO(R!dO~P!FRO`,eOa%mO'x%mO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa,kOj!OO!swO%k!OO%l!OO%m!OO~P!HkO!j&mO~O&[,qO~O!],sO~O&m,uO&o,vOP&jaQ&jaS&jaY&jaa&jad&jae&jaj&jan&jap&jaq&jar&jax&jaz&ja|&ja!Q&ja!U&ja!V&ja!]&ja!g&ja!j&ja!m&ja!n&ja!o&ja!q&ja!s&ja!v&ja!z&ja$V&ja$m&ja%g&ja%i&ja%k&ja%l&ja%m&ja%p&ja%r&ja%u&ja%v&ja%x&ja&U&ja&[&ja&^&ja&`&ja&b&ja&e&ja&k&ja&q&ja&s&ja&u&ja&w&ja&y&ja'u&ja(R&ja(T&ja(W&ja(_&ja(m&ja![&ja&c&jab&ja&h&ja~O(R,{O~Oh!cX!Z!PX![!PX!e!PX!e!cX!j!cX#^!PX~O!Z!cX![!cX~P# qO!e-QO#^-POh(hX!Z#fX![#fX!e(hX!j(hX~O!Z(hX![(hX~P#!dOh%VO!e-SO!j%dO!Z!_X![!_X~Oq!nO!Q!oO(TTO(WUO(c!mO~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(TTO(WUO(_VO(m[O~O(R<rO~P##yO!Z-WO![(gX~O![-YO~O!e-QO#^-PO!Z#fX![#fX~O!Z-ZO![(vX~O![-]O~O!a-^O!b-^O(S!lO~P##hO![-aO~P'_Ol-dO!]'^O~O!W-iO~Oq!ya!`!ya!a!ya!b!ya#R!ya#S!ya#T!ya#U!ya#V!ya#Y!ya#Z!ya(S!ya(T!ya(W!ya(c!ya(m!ya~P!#eO!n-nO#^-lO~PCVO!a-pO!b-pO(S!lO~PCuOa%mO#^-lO'x%mO~Oa%mO!e#vO#^-lO'x%mO~Oa%mO!e#vO!n-nO#^-lO'x%mO(p'nO~O'}'vO(O'vO(P-uO~Ot-vO~O!W'Ua!Z'Ua~P!:TO!Y-zO!W'UX!Z'UX~P%[O!Z(TO!W(fa~O!W(fa~PGpO!Z([O!W(ta~O!Q%gO!Y.OO!]%hO(R%fO!W'[X!Z'[X~O#^.QO!Z(ra!i(raa(ra'x(ra~O!e#vO~P#,PO!Z(hO!i(qa~O!Q%gO!]%hO#h.UO(R%fO~On.ZO!Q%gO!Y.WO!]%hO!z]O#g.YO#h.WO(R%fO!Z'_X!i'_X~OR._O!j#xO~Oh%VOl.bO!]'^O%h.aO~Oa#ai!Z#ai'x#ai'u#ai!W#ai!i#ait#ai!]#ai%h#ai!e#ai~P!:TOl=|O!O)|O'w)}O(w$}O(x%PO~O#i#]aa#]a#^#]a'x#]a!Z#]a!i#]a!]#]a!W#]a~P#.{O#i(^XP(^XR(^X[(^Xa(^Xp(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X'x(^X(_(^X(p(^X!i(^X!W(^X'u(^Xt(^X!](^X%h(^X!e(^X~P!6YO!Z.oO!i(iX~P!:TO!i.rO~O!W.tO~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kia#kip#ki!Z#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#l#ki~P#2kO#l$OO~P#2kOP$[OR#zOp$aO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO[#kia#ki!Z#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#p#ki~P#5YO#p$QO~P#5YOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO(_VOa#ki!Z#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#u#ki~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO(_VO(x#}Oa#ki!Z#ki#y#ki#z#ki'x#ki(p#ki(w#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#w$UO~P#:_O#w#ki~P#:_O#u$SO~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO(_VO(w#|O(x#}Oa#ki!Z#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#y#ki~P#=TO#y$WO~P#=TOP]XR]X[]Xp]X!O]X!Q]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X!Z]X![]X~O#}]X~P#?rOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO#y<XO#z<YO(_VO(p$YO(w#|O(x#}O~O#}.vO~P#BPO#Q$dO#^<`O$P<`O#}(eX![(eX~P! dOa'ba!Z'ba'x'ba'u'ba!i'ba!W'bat'ba!]'ba%h'ba!e'ba~P!:TO[#kia#kip#ki!Z#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO(w#ki(x#ki~P#EROl=|O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P#ERO!Z.zOg(nX~P!0uOg.|O~Oa$Oi!Z$Oi'x$Oi'u$Oi!W$Oi!i$Oit$Oi!]$Oi%h$Oi!e$Oi~P!:TO$[.}O$^.}O~O$[/OO$^/OO~O!e)fO#^/PO!]$bX$Y$bX$[$bX$^$bX$e$bX~O!Y/QO~O!])iO$Y/SO$[)hO$^)hO$e/TO~O!Z<ZO![(dX~P#BPO![/UO~O!e)fO$e(yX~O$e/WO~Ot/XO~P!&iOv)wO(`)xO(a/[O~O!Q/_O~O(w$}Ol%`a!O%`a'w%`a(x%`a!Z%`a#^%`a~Og%`a#}%`a~P#LTO(x%POl%ba!O%ba'w%ba(w%ba!Z%ba#^%ba~Og%ba#}%ba~P#LvO!ZfX!efX!ifX!i$yX(pfX~P!/qO!Y/hO!Z([O(R/gO!W(tP!W(}P~P!1dOp*pO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO~Oq<oO!Q/iO!Y+XO![*mO(c<nO![(vP~P#NaO!i/jO~P#.{O!Z/kO!e#vO(p'nO!i(|X~O!i/pO~O!Q%gO!Y*[O!]%hO(R%fO!i(|P~O#i/rO~O!W$yX!Z$yX!e%QX~P!/qO!Z/sO!W(}X~P#.{O!e/uO~O!W/wO~OnkO(R/xO~P.iOh%VOp/}O!e#vO!j%dO(p'nO~O!e+fO~Oa%mO!Z0RO'x%mO~O![0TO~P!5WO!a0UO!b0UO(S!lO~P##hOq!nO!Q0VO(TTO(WUO(c!mO~O#Y0XO~Og%`a!Z%`a#^%`a#}%`a~P!0uOg%ba!Z%ba#^%ba#}%ba~P!0uOj%cO(R&XOg'kX!Z'kX~O!Z*vOg([a~Og0bO~OR0cO!O0cO!Q0dO#Q$dOl{a'w{a(w{a(x{a!Z{a#^{a~Og{a#}{a~P$&dO!O)|O'w)}Ol$ra(w$ra(x$ra!Z$ra#^$ra~Og$ra#}$ra~P$'`O!O)|O'w)}Ol$ta(w$ta(x$ta!Z$ta#^$ta~Og$ta#}$ta~P$(RO#i0gO~Og%Sa!Z%Sa#^%Sa#}%Sa~P!0uOl0iO#^0hOg(]a!Z(]a~O!e#vO~O#i0lO~O!Z+ZOa)Ra'x)Ra~OR#zO!O#yO!Q#{O!j#xO(_VOP!pi[!pip!pi!Z!pi!n!pi#P!pi#l!pi#m!pi#n!pi#o!pi#p!pi#q!pi#r!pi#s!pi#t!pi#u!pi#w!pi#y!pi#z!pi(p!pi(w!pi(x!pi~Oa!pi'x!pi'u!pi!W!pi!i!pit!pi!]!pi%h!pi!e!pi~P$*OOh%VOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~On0vO%[0wO(R0tO~P$,fO!e+fOa(Za!](Za'x(Za!Z(Za~O#i0|O~O[]X!ZfX![fX~O!Z0}O![)VX~O![1PO~O[1QO~Ob1SO(R+nO(TTO(WUO~O!]&OO(R%fO`'sX!Z'sX~O!Z+sO`)Ua~O!i1VO~P!:TO[1YO~O`1ZO~O#^1^O~Ol1aO!]$|O~O(c(zO![)SP~Oh%VOl1jO!]1gO%h1iO~O[1tO!Z1rO![)TX~O![1uO~O`1wOa%mO'x%mO~O(R#nO(TTO(WUO~O#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O#t1zO&Y1{Oa(eX~P$2PO#^$eO#t1zO&Y1{O~Oa1}O~P%[Oa2PO~O&c2SOP&aiQ&aiS&aiY&aia&aid&aie&aij&ain&aip&aiq&air&aix&aiz&ai|&ai!Q&ai!U&ai!V&ai!]&ai!g&ai!j&ai!m&ai!n&ai!o&ai!q&ai!s&ai!v&ai!z&ai$V&ai$m&ai%g&ai%i&ai%k&ai%l&ai%m&ai%p&ai%r&ai%u&ai%v&ai%x&ai&U&ai&[&ai&^&ai&`&ai&b&ai&e&ai&k&ai&q&ai&s&ai&u&ai&w&ai&y&ai'u&ai(R&ai(T&ai(W&ai(_&ai(m&ai![&aib&ai&h&ai~Ob2YO![2WO&h2XO~P`O!]XO!j2[O~O&o,vOP&jiQ&jiS&jiY&jia&jid&jie&jij&jin&jip&jiq&jir&jix&jiz&ji|&ji!Q&ji!U&ji!V&ji!]&ji!g&ji!j&ji!m&ji!n&ji!o&ji!q&ji!s&ji!v&ji!z&ji$V&ji$m&ji%g&ji%i&ji%k&ji%l&ji%m&ji%p&ji%r&ji%u&ji%v&ji%x&ji&U&ji&[&ji&^&ji&`&ji&b&ji&e&ji&k&ji&q&ji&s&ji&u&ji&w&ji&y&ji'u&ji(R&ji(T&ji(W&ji(_&ji(m&ji![&ji&c&jib&ji&h&ji~O!W2bO~O!Z!_a![!_a~P#BPOq!nO!Q!oO!Y2hO(c!mO!Z'VX!['VX~P@]O!Z-WO![(ga~O!Z']X![']X~P!9]O!Z-ZO![(va~O![2oO~P'_Oa%mO#^2xO'x%mO~Oa%mO!e#vO#^2xO'x%mO~Oa%mO!e#vO!n2|O#^2xO'x%mO(p'nO~Oa%mO'x%mO~P!:TO!Z$_Ot$pa~O!W'Ui!Z'Ui~P!:TO!Z(TO!W(fi~O!Z([O!W(ti~O!W(ui!Z(ui~P!:TO!Z(ri!i(ria(ri'x(ri~P!:TO#^3OO!Z(ri!i(ria(ri'x(ri~O!Z(hO!i(qi~O!Q%gO!]%hO!z]O#g3TO#h3SO(R%fO~O!Q%gO!]%hO#h3SO(R%fO~Ol3[O!]'^O%h3ZO~Oh%VOl3[O!]'^O%h3ZO~O#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`at%`a!]%`a%h%`a!e%`a~P#LTO#i%baP%baR%ba[%baa%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%bat%ba!]%ba%h%ba!e%ba~P#LvO#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!Z%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`a#^%`at%`a!]%`a%h%`a!e%`a~P#.{O#i%baP%baR%ba[%baa%bap%ba!Q%ba!Z%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%ba#^%bat%ba!]%ba%h%ba!e%ba~P#.{O#i{aP{a[{aa{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a'x{a(_{a(p{a!i{a!W{a'u{at{a!]{a%h{a!e{a~P$&dO#i$raP$raR$ra[$raa$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra'x$ra(_$ra(p$ra!i$ra!W$ra'u$rat$ra!]$ra%h$ra!e$ra~P$'`O#i$taP$taR$ta[$taa$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta'x$ta(_$ta(p$ta!i$ta!W$ta'u$tat$ta!]$ta%h$ta!e$ta~P$(RO#i%SaP%SaR%Sa[%Saa%Sap%Sa!Q%Sa!Z%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa'x%Sa(_%Sa(p%Sa!i%Sa!W%Sa'u%Sa#^%Sat%Sa!]%Sa%h%Sa!e%Sa~P#.{Oa#aq!Z#aq'x#aq'u#aq!W#aq!i#aqt#aq!]#aq%h#aq!e#aq~P!:TO!Y3dO!Z'WX!i'WX~P%[O!Z.oO!i(ia~O!Z.oO!i(ia~P!:TO!W3gO~O#}!la![!la~PKZO#}!ha!Z!ha![!ha~P#BPO#}!pa![!pa~P!<kO#}!ra![!ra~P!?ROg'ZX!Z'ZX~P!+rO!Z.zOg(na~OSfO!]3{O$c3|O~O![4QO~Ot4RO~P#.{Oa$lq!Z$lq'x$lq'u$lq!W$lq!i$lqt$lq!]$lq%h$lq!e$lq~P!:TO!W4TO~P!&iO!Q4UO~O!O)|O'w)}O(x%POl'ga(w'ga!Z'ga#^'ga~Og'ga#}'ga~P%+uO!O)|O'w)}Ol'ia(w'ia(x'ia!Z'ia#^'ia~Og'ia#}'ia~P%,hO(p$YO~P#.{O!WfX!W$yX!ZfX!Z$yX!e%QX#^fX~P!/qO(R<xO~P!1dO!Q%gO!Y4XO!]%hO(R%fO!Z'cX!i'cX~O!Z/kO!i(|a~O!Z/kO!e#vO!i(|a~O!Z/kO!e#vO(p'nO!i(|a~Og${i!Z${i#^${i#}${i~P!0uO!Y4aO!W'eX!Z'eX~P!3cO!Z/sO!W(}a~O!Z/sO!W(}a~P#.{OP]XR]X[]Xp]X!O]X!Q]X!W]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!e%XX#t%XX~P%0XO!e#vO#t4fO~Oh%VO!e#vO!j%dO~Oh%VOp4kO!j%dO(p'nO~Op4pO!e#vO(p'nO~Oq!nO!Q4qO(TTO(WUO(c!mO~O(w$}Ol%`i!O%`i'w%`i(x%`i!Z%`i#^%`i~Og%`i#}%`i~P%3xO(x%POl%bi!O%bi'w%bi(w%bi!Z%bi#^%bi~Og%bi#}%bi~P%4kOg(]i!Z(]i~P!0uO#^4wOg(]i!Z(]i~P!0uO!i4zO~Oa$nq!Z$nq'x$nq'u$nq!W$nq!i$nqt$nq!]$nq%h$nq!e$nq~P!:TO!W5QO~O!Z5RO!])OX~P#.{Oa]Xa$yX!]]X!]$yX%]]X'x]X'x$yX!Z]X!Z$yX~P!/qO%]5UOa%Za!]%Za'x%Za!Z%Za~OlmX!OmX'wmX(wmX(xmX~P%7nOn5VO(R#nO~Ob5]O%i5^O(R+nO(TTO(WUO!Z'rX!['rX~O!Z0}O![)Va~O[5bO~O`5cO~Oa%mO'x%mO~P#.{O!Z5kO#^5mO![)SX~O![5nO~Op5tOq!nO!Q*fO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!pO#U!pO#V!pO#Y5sO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O![5rO~P%:ROl5yO!]1gO%h5xO~Oh%VOl5yO!]1gO%h5xO~Ob6QO(R#nO(TTO(WUO!Z'qX!['qX~O!Z1rO![)Ta~O(TTO(WUO(c6SO~O`6WO~O#t6ZO&Y6[O~PMvO!i6]O~P%[Oa6_O~Oa6_O~P%[Ob2YO![6dO&h2XO~P`O!e6fO~O!e6hOh(hi!Z(hi![(hi!e(hi!j(hip(hi(p(hi~O!Z#fi![#fi~P#BPO#^6iO!Z#fi![#fi~O!Z!_i![!_i~P#BPOa%mO#^6rO'x%mO~Oa%mO!e#vO#^6rO'x%mO~O!Z(rq!i(rqa(rq'x(rq~P!:TO!Z(hO!i(qq~O!Q%gO!]%hO#h6yO(R%fO~O!]'^O%h6|O~Ol7QO!]'^O%h6|O~O#i'gaP'gaR'ga['gaa'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga'x'ga(_'ga(p'ga!i'ga!W'ga'u'gat'ga!]'ga%h'ga!e'ga~P%+uO#i'iaP'iaR'ia['iaa'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia'x'ia(_'ia(p'ia!i'ia!W'ia'u'iat'ia!]'ia%h'ia!e'ia~P%,hO#i${iP${iR${i[${ia${ip${i!Q${i!Z${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i'x${i(_${i(p${i!i${i!W${i'u${i#^${it${i!]${i%h${i!e${i~P#.{O#i%`iP%`iR%`i[%`ia%`ip%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i'x%`i(_%`i(p%`i!i%`i!W%`i'u%`it%`i!]%`i%h%`i!e%`i~P%3xO#i%biP%biR%bi[%bia%bip%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi'x%bi(_%bi(p%bi!i%bi!W%bi'u%bit%bi!]%bi%h%bi!e%bi~P%4kO!Z'Wa!i'Wa~P!:TO!Z.oO!i(ii~O#}#ai!Z#ai![#ai~P#BPOP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kip#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#l#ki~P%MQO#l<PO~P%MQOP$[OR#zOp<]O!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO[#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#p#ki~P& YO#p<RO~P& YOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO(_VO#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#u#ki~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO(_VO(x#}O#y#ki#z#ki#}#ki(p#ki(w#ki!Z#ki![#ki~O#w<VO~P&%cO#w#ki~P&%cO#u<TO~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO(_VO(w#|O(x#}O#z#ki#}#ki(p#ki!Z#ki![#ki~O#y#ki~P&'rO#y<XO~P&'rOa#{y!Z#{y'x#{y'u#{y!W#{y!i#{yt#{y!]#{y%h#{y!e#{y~P!:TO[#kip#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki!Z#ki![#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO(w#ki(x#ki~P&*nOl=}O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P&*nO#Q$dOP(^XR(^X[(^Xl(^Xp(^X!O(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X#}(^X'w(^X(_(^X(p(^X(w(^X(x(^X!Z(^X![(^X~O#}$Oi!Z$Oi![$Oi~P#BPO#}!pi![!pi~P$*OOg'Za!Z'Za~P!0uO![7dO~O!Z'ba!['ba~P#BPO!W7eO~P#.{O!e#vO(p'nO!Z'ca!i'ca~O!Z/kO!i(|i~O!Z/kO!e#vO!i(|i~Og${q!Z${q#^${q#}${q~P!0uO!W'ea!Z'ea~P#.{O!e7lO~O!Z/sO!W(}i~P#.{O!Z/sO!W(}i~O!W7oO~Oh%VOp7tO!j%dO(p'nO~O!e#vO#t7vO~Op7yO!e#vO(p'nO~O!O)|O'w)}O(x%POl'ha(w'ha!Z'ha#^'ha~Og'ha#}'ha~P&3oO!O)|O'w)}Ol'ja(w'ja(x'ja!Z'ja#^'ja~Og'ja#}'ja~P&4bO!W7{O~Og$}q!Z$}q#^$}q#}$}q~P!0uOg(]q!Z(]q~P!0uO#^7|Og(]q!Z(]q~P!0uOa$ny!Z$ny'x$ny'u$ny!W$ny!i$nyt$ny!]$ny%h$ny!e$ny~P!:TO!e6hO~O!Z5RO!])Oa~O!]'^OP$SaR$Sa[$Sap$Sa!O$Sa!Q$Sa!Z$Sa!j$Sa!n$Sa#P$Sa#l$Sa#m$Sa#n$Sa#o$Sa#p$Sa#q$Sa#r$Sa#s$Sa#t$Sa#u$Sa#w$Sa#y$Sa#z$Sa(_$Sa(p$Sa(w$Sa(x$Sa~O%h6|O~P&7SO%]8QOa%Zi!]%Zi'x%Zi!Z%Zi~Oa#ay!Z#ay'x#ay'u#ay!W#ay!i#ayt#ay!]#ay%h#ay!e#ay~P!:TO[8SO~Ob8UO(R+nO(TTO(WUO~O!Z0}O![)Vi~O`8YO~O(c(zO!Z'nX!['nX~O!Z5kO![)Sa~O![8cO~P%:RO(m!sO~P$$oO#Y8dO~O!]1gO~O!]1gO%h8fO~Ol8iO!]1gO%h8fO~O[8nO!Z'qa!['qa~O!Z1rO![)Ti~O!i8rO~O!i8sO~O!i8vO~O!i8vO~P%[Oa8xO~O!e8yO~O!i8zO~O!Z(ui![(ui~P#BPOa%mO#^9SO'x%mO~O!Z(ry!i(rya(ry'x(ry~P!:TO!Z(hO!i(qy~O%h9VO~P&7SO!]'^O%h9VO~O#i${qP${qR${q[${qa${qp${q!Q${q!Z${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q'x${q(_${q(p${q!i${q!W${q'u${q#^${qt${q!]${q%h${q!e${q~P#.{O#i'haP'haR'ha['haa'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha'x'ha(_'ha(p'ha!i'ha!W'ha'u'hat'ha!]'ha%h'ha!e'ha~P&3oO#i'jaP'jaR'ja['jaa'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja'x'ja(_'ja(p'ja!i'ja!W'ja'u'jat'ja!]'ja%h'ja!e'ja~P&4bO#i$}qP$}qR$}q[$}qa$}qp$}q!Q$}q!Z$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q'x$}q(_$}q(p$}q!i$}q!W$}q'u$}q#^$}qt$}q!]$}q%h$}q!e$}q~P#.{O!Z'Wi!i'Wi~P!:TO#}#aq!Z#aq![#aq~P#BPO(w$}OP%`aR%`a[%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a#}%`a(_%`a(p%`a!Z%`a![%`a~Ol%`a!O%`a'w%`a(x%`a~P&HgO(x%POP%baR%ba[%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba#}%ba(_%ba(p%ba!Z%ba![%ba~Ol%ba!O%ba'w%ba(w%ba~P&JnOl=}O!O)|O'w)}O(x%PO~P&HgOl=}O!O)|O'w)}O(w$}O~P&JnOR0cO!O0cO!Q0dO#Q$dOP{a[{al{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a#}{a'w{a(_{a(p{a(w{a(x{a!Z{a![{a~O!O)|O'w)}OP$raR$ra[$ral$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra#}$ra(_$ra(p$ra(w$ra(x$ra!Z$ra![$ra~O!O)|O'w)}OP$taR$ta[$tal$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta#}$ta(_$ta(p$ta(w$ta(x$ta!Z$ta![$ta~Ol=}O!O)|O'w)}O(w$}O(x%PO~OP%SaR%Sa[%Sap%Sa!Q%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa#}%Sa(_%Sa(p%Sa!Z%Sa![%Sa~P'%sO#}$lq!Z$lq![$lq~P#BPO#}$nq!Z$nq![$nq~P#BPO![9dO~O#}9eO~P!0uO!e#vO!Z'ci!i'ci~O!e#vO(p'nO!Z'ci!i'ci~O!Z/kO!i(|q~O!W'ei!Z'ei~P#.{O!Z/sO!W(}q~Op9lO!e#vO(p'nO~O[9nO!W9mO~P#.{O!W9mO~O!e#vO#t9tO~Og(]y!Z(]y~P!0uO!Z'la!]'la~P#.{Oa%Zq!]%Zq'x%Zq!Z%Zq~P#.{O[9yO~O!Z0}O![)Vq~O#^9}O!Z'na!['na~O!Z5kO![)Si~P#BPO!Q:PO~O!]1gO%h:SO~O(TTO(WUO(c:XO~O!Z1rO![)Tq~O!i:[O~O!i:]O~O!i:^O~O!i:^O~P%[O#^:aO!Z#fy![#fy~O!Z#fy![#fy~P#BPO%h:fO~P&7SO!]'^O%h:fO~O#}#{y!Z#{y![#{y~P#BPOP${iR${i[${ip${i!Q${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i#}${i(_${i(p${i!Z${i![${i~P'%sO!O)|O'w)}O(x%POP'gaR'ga['gal'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga#}'ga(_'ga(p'ga(w'ga!Z'ga!['ga~O!O)|O'w)}OP'iaR'ia['ial'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia#}'ia(_'ia(p'ia(w'ia(x'ia!Z'ia!['ia~O(w$}OP%`iR%`i[%`il%`ip%`i!O%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i#}%`i'w%`i(_%`i(p%`i(x%`i!Z%`i![%`i~O(x%POP%biR%bi[%bil%bip%bi!O%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi#}%bi'w%bi(_%bi(p%bi(w%bi!Z%bi![%bi~O#}$ny!Z$ny![$ny~P#BPO#}#ay!Z#ay![#ay~P#BPO!e#vO!Z'cq!i'cq~O!Z/kO!i(|y~O!W'eq!Z'eq~P#.{Op:pO!e#vO(p'nO~O[:tO!W:sO~P#.{O!W:sO~Og(]!R!Z(]!R~P!0uOa%Zy!]%Zy'x%Zy!Z%Zy~P#.{O!Z0}O![)Vy~O!Z5kO![)Sq~O(R:zO~O!]1gO%h:}O~O!i;QO~O%h;VO~P&7SOP${qR${q[${qp${q!Q${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q#}${q(_${q(p${q!Z${q![${q~P'%sO!O)|O'w)}O(x%POP'haR'ha['hal'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha#}'ha(_'ha(p'ha(w'ha!Z'ha!['ha~O!O)|O'w)}OP'jaR'ja['jal'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja#}'ja(_'ja(p'ja(w'ja(x'ja!Z'ja!['ja~OP$}qR$}q[$}qp$}q!Q$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q#}$}q(_$}q(p$}q!Z$}q![$}q~P'%sOg%d!Z!Z%d!Z#^%d!Z#}%d!Z~P!0uO!W;ZO~P#.{Op;[O!e#vO(p'nO~O[;^O!W;ZO~P#.{O!Z'nq!['nq~P#BPO!Z#f!Z![#f!Z~P#BPO#i%d!ZP%d!ZR%d!Z[%d!Za%d!Zp%d!Z!Q%d!Z!Z%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z'x%d!Z(_%d!Z(p%d!Z!i%d!Z!W%d!Z'u%d!Z#^%d!Zt%d!Z!]%d!Z%h%d!Z!e%d!Z~P#.{Op;fO!e#vO(p'nO~O!W;gO~P#.{Op;nO!e#vO(p'nO~O!W;oO~P#.{OP%d!ZR%d!Z[%d!Zp%d!Z!Q%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z#}%d!Z(_%d!Z(p%d!Z!Z%d!Z![%d!Z~P'%sOp;rO!e#vO(p'nO~Ot(dX~P1qO!O%qO~P!(yO(S!lO~P!(yO!WfX!ZfX#^fX~P%0XOP]XR]X[]Xp]X!O]X!Q]X!Z]X!ZfX!j]X!n]X#P]X#Q]X#^]X#^fX#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!efX!i]X!ifX(pfX~P'JlOP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]XO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z<ZO![$pa~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<fO!Q${O!]$|O!g=wO!j$xO#h<lO$V%_O$s<hO$u<jO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Oj)bO~P( bOp!cX(p!cX~P# qOp(hX(p(hX~P#!dO![]X![fX~P'JlO!WfX!W$yX!ZfX!Z$yX#^fX~P!/qO#i<OO~O!e#vO#i<OO~O#^<`O~O#t<SO~O#^<pO!Z(uX![(uX~O#^<`O!Z(sX![(sX~O#i<qO~Og<sO~P!0uO#i<yO~O#i<zO~O!e#vO#i<{O~O!e#vO#i<qO~O#}<|O~P#BPO#i<}O~O#i=OO~O#i=TO~O#i=UO~O#i=VO~O#i=WO~O#}=XO~P!0uO#}=YO~P!0uO#Q#R#S#U#V#Y#g#h#s$m$s$u$x%[%]%g%h%i%p%r%u%v%x%z~'|T#m!V'z(S#nq#l#op!O'{$['{(R$^(c~",goto:"$8f)ZPPPPPP)[PP)_P)pP+Q/VPPPP6aPP6wPP<oP@cP@yP@yPPP@yPCRP@yP@yP@yPCVPC[PCyPHsPPPHwPPPPHwKzPPPLQLrPHwPHwPP! QHwPPPHwPHwP!#XHwP!&o!'t!'}P!(q!(u!(q!,SPPPPPPP!,s!'tPP!-T!.uP!2RHwHw!2W!5d!:Q!:Q!>PPPP!>XHwPPPPPPPPPP!AhP!BuPPHw!DWPHwPHwHwHwHwHwPHw!EjP!HtP!KzP!LO!LY!L^!L^P!HqP!Lb!LbP# hP# lHwPHw# r#$wCV@yP@yP@y@yP#&U@y@y#(h@y#+`@y#-l@y@y#.[#0p#0p#0u#1O#0p#1ZPP#0pP@y#1s@y#5r@y@y6aPPP#9wPPP#:b#:bP#:bP#:x#:bPP#;OP#:uP#:u#;c#:u#;}#<T#<W)_#<Z)_P#<b#<b#<bP)_P)_P)_P)_PP)_P#<h#<kP#<k)_P#<oP#<rP)_P)_P)_P)_P)_P)_)_PP#<x#=O#=Z#=a#=g#=m#=s#>R#>X#>c#>i#>s#>y#?Z#?a#@R#@e#@k#@q#AP#Af#CZ#Ci#Cp#E[#Ej#G[#Gj#Gp#Gv#G|#HW#H^#Hd#Hn#IQ#IWPPPPPPPPPPP#I^PPPPPPP#JR#MY#Nr#Ny$ RPPP$&mP$&v$)o$0Y$0]$0`$1_$1b$1i$1qP$1w$1zP$2h$2l$3d$4r$4w$5_PP$5d$5j$5n$5q$5u$5y$6u$7^$7u$7y$7|$8P$8V$8Y$8^$8bR!|RoqOXst!Z#d%l&p&r&s&u,n,s2S2VY!vQ'^-`1g5qQ%svQ%{yQ&S|Q&h!VS'U!e-WQ'd!iS'j!r!yU*h$|*X*lQ+l%|Q+y&UQ,_&bQ-^']Q-h'eQ-p'kQ0U*nQ1q,`R<m;z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9SS#q];w!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU*{%[<e<fQ+q&OQ,a&eQ,h&mQ0r+dQ0u+fQ1S+rQ1y,fQ3W.bQ5V0wQ5]0}Q6Q1rQ7O3[Q8U5^R9Y7Q'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s!S!nQ!r!v!y!z$|'U']'^'j'k'l*h*l*n*o-W-^-`-p0U0X1g5q5s%[$ti#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q&V|Q'S!eS'Y%h-ZQ+q&OQ,a&eQ0f+OQ1S+rQ1X+xQ1x,eQ1y,fQ5]0}Q5f1ZQ6Q1rQ6T1tQ6U1wQ8U5^Q8X5cQ8q6WQ9|8YQ:Y8nR<o*XrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR,c&i&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=r=s[#]WZ#W#Z'V(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ%vxQ%zyS&P|&UQ&]!TQ'a!hQ'c!iQ(o#sS+k%{%|Q+o&OQ,Y&`Q,^&bS-g'd'eQ.d(pQ0{+lQ1R+rQ1T+sQ1W+wQ1l,ZS1p,_,`Q2t-hQ5[0}Q5`1QQ5e1YQ6P1qQ8T5^Q8W5bQ9x8SR:w9y!U$zi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y!^%xy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pQ+e%vQ,O&YQ,R&ZQ,]&bQ.c(oQ1k,YU1o,^,_,`Q3].dQ5z1lS6O1p1qQ8m6P#f=t#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o=u<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YW%Ti%V*v=pS&Y!Q&gQ&Z!RQ&[!SQ+S%cR+|&W%]%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}T)x$u)yV*{%[<e<fW'Y!e%h*X-ZS({#y#zQ+`%qQ+v&RS.](k(lQ1b,SQ4x0cR8^5k'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s$i$^c#Y#e%p%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.w.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ'W!eR2i-W!W!nQ!e!r!v!y!z$|'U']'^'j'k'l*X*h*l*n*o-W-^-`-p0U0X1g5q5sR1d,UnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&w!^Q't!xS(q#u<OQ+i%yQ,W&]Q,X&_Q-e'bQ-r'mS.m(v<qS0k+U<{Q0y+jQ1f,VQ2Z,uQ2],vQ2e-RQ2r-fQ2u-jS5P0l=VQ5W0zS5Z0|=WQ6j2gQ6n2sQ6s2zQ8R5XQ8}6lQ9O6oQ9R6tR:`8z$d$]c#Y#e%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gS(m#p'gQ(}#zS+_%p.wS.^(l(nR3U._'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS#q];wQ&r!XQ&s!YQ&u![Q&v!]R2R,qQ'_!hQ+b%vQ-c'aS.`(o+eQ2p-bW3Y.c.d0q0sQ6m2qW6z3V3X3]5TU9U6{6}7PU:e9W9X9ZS;T:d:gQ;b;UR;j;cU!wQ'^-`T5o1g5q!Q_OXZ`st!V!Z#d#h%d%l&g&i&p&r&s&u(h,n,s.V2S2V]!pQ!r'^-`1g5qT#q];w%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS({#y#zS.](k(l!s=^$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU$fd)],hS(n#p'gU*s%R(u3vU0e*z.i7]Q5T0rQ6{3WQ9X7OR:g9Ym!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sQ'r!uS(d#g1|S-n'i'uQ/n*ZQ/{*gQ2|-qQ4]/oQ4i/}Q4j0OQ4o0WQ7h4WS7s4k4mS7w4p4rQ9g7iQ9k7oQ9p7tQ9u7yS:o9l9mS;Y:p:sS;e;Z;[S;m;f;gS;q;n;oR;t;rQ#wbQ'q!uS(c#g1|S(e#m+TQ+V%eQ+g%wQ+m%}U-m'i'r'uQ.R(dQ/m*ZQ/|*gQ0P*iQ0x+hQ1m,[S2y-n-qQ3R.ZS4[/n/oQ4e/yS4h/{0WQ4l0QQ5|1nQ6u2|Q7g4WQ7k4]U7r4i4o4rQ7u4nQ8k5}S9f7h7iQ9j7oQ9r7wQ9s7xQ:V8lQ:m9gS:n9k9mQ:v9uQ;P:WS;X:o:sS;d;Y;ZS;l;e;gS;p;m;oQ;s;qQ;u;tQ=a=[Q=l=eR=m=fV!wQ'^-`%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS#wz!j!r=Z$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=a=r%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SQ%ej!^%wy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pS%}z!jQ+h%xQ,[&bW1n,],^,_,`U5}1o1p1qS8l6O6PQ:W8m!r=[$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ=e=qR=f=r%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SY#bWZ#W#Z(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ,i&m!p=]$Z$n)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=`'VU'Z!e%h*XR2k-Z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9S!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ,h&mQ0r+dQ3W.bQ7O3[R9Y7Q!b$Tc#Y%p(Q(W(r(w)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!P<U)[)o-U.w2c2f3h3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!f$Vc#Y%p(Q(W(r(w)U)V)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!T<W)[)o-U.w2c2f3h3n3o3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!^$Zc#Y%p(Q(W(r(w)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;xQ4V/fz=s)[)o-U.w2c2f3h3w4P6k7W7a7b8`8|9[9b9c:y;R=gQ=x=zR=y={'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS$oh$pR3|/P'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$kf$qQ$ifS)h$l)lR)t$qT$jf$qT)j$l)l'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$oh$pQ$rhR)s$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9S!s=q$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s#glOPXZst!Z!`!o#S#d#o#{$n%l&i&l&m&p&r&s&u&y'R'`(|)q*f+Y+d,k,n,s-d.b/Q/i0V0d1j1z1{1}2P2S2V2X3[3{4q5y6Z6[6_7Q8i8x!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}Q+P%`Q/^)|o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!U$yi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yQ*`$zU*i$|*X*lQ+Q%aQ0Q*j#f=c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n=d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YQ=h=tQ=i=uQ=j=vR=k=w!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YnoOXst!Z#d%l&p&r&s&u,n,s2S2VS*c${*WQ,|&|Q,}'OR4`/s%[%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q,P&ZQ1`,RQ5i1_R8]5jV*k$|*X*lU*k$|*X*lT5p1g5qS/y*f/iQ4n0VT7x4q:PQ+g%wQ0P*iQ0x+hQ1m,[Q5|1nQ8k5}Q:V8lR;P:W!U%Oi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yx*P$v)c*Q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=oS0Y*q0Z#f<a#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<b<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!d<t(s)a*Y*b.e.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={`<u3u7X7[7`9]:h:k;kS=P.g3aT=Q7Z9`!U%Qi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y|*R$v)c*S*q+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=oS0[*r0]#f<c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!h<v(s)a*Y*b.f.g.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={d<w3u7Y7Z7`9]9^:h:i:k;kS=R.h3bT=S7[9arnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ&d!UR,k&mrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR&d!UQ,T&[R1[+|snOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ1h,YS5w1k1lU8e5u5v5zS:R8g8hS:{:Q:TQ;_:|R;i;`Q&k!VR,d&gR6T1tR:Y8nS&P|&UR1T+sQ&p!WR,n&qR,t&vT2T,s2VR,x&wQ,w&wR2^,xQ'w!{R-t'wSsOtQ#dXT%os#dQ#OTR'y#OQ#RUR'{#RQ)y$uR/Z)yQ#UVR(O#UQ#XWU(U#X(V-{Q(V#YR-{(WQ-X'WR2j-XQ.p(wS3e.p3fR3f.qQ-`'^R2n-`Y!rQ'^-`1g5qR'h!rQ.{)cR3z.{U#_W%g*WU(]#_(^-|Q(^#`R-|(XQ-['ZR2l-[t`OXst!V!Z#d%l&g&i&p&r&s&u,n,s2S2VS#hZ%dU#r`#h.VR.V(hQ(i#jQ.S(eW.[(i.S3P6wQ3P.TR6w3QQ)l$lR/R)lQ$phR)r$pQ$`cU)_$`-w<[Q-w;xR<[)oQ/l*ZW4Y/l4Z7j9hU4Z/m/n/oS7j4[4]R9h7k$e*O$v(s)a)c*Y*b*q*r*|*}+R.g.h.j.k.l/Y/b/d/f/q/v0^0_0p1]3^3_3`3u3y4S4^4_4c4s4u4{4|4}5h7R7S7T7U7Z7[7^7_7`7f7m7p7z7}8P9]9^9_9i9q9v9w:h:i:j:k:l:q:u;W;];h;k=b=n=o=z={Q/t*bU4b/t4d7nQ4d/vR7n4cS*l$|*XR0S*lx*Q$v)c*q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=o!d.e(s)a*Y*b.g.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/c*Q.e7Xa7X3u7Z7[7`9]:h:k;kQ0Z*qQ3a.gU4t0Z3a9`R9`7Z|*S$v)c*q*r+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=o!h.f(s)a*Y*b.g.h.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/e*S.f7Ye7Y3u7Z7[7`9]9^:h:i:k;kQ0]*rQ3b.hU4v0]3b9aR9a7[Q*w%UR0a*wQ5S0pR8O5SQ+[%jR0o+[Q5l1bS8_5l:OR:O8`Q,V&]R1e,VQ5q1gR8b5qQ1s,aS6R1s8oR8o6TQ1O+oW5_1O5a8V9zQ5a1RQ8V5`R9z8WQ+t&PR1U+tQ2V,sR6c2VYrOXst#dQ&t!ZQ+^%lQ,m&pQ,o&rQ,p&sQ,r&uQ2Q,nS2T,s2VR6b2SQ%npQ&x!_Q&{!aQ&}!bQ'P!cQ'o!uQ+]%kQ+i%yQ+{&VQ,c&kQ,z&zW-k'i'q'r'uQ-r'mQ0R*kQ0y+jS1v,d,gQ2_,yQ2`,|Q2a,}Q2u-jW2w-m-n-q-sQ5W0zQ5d1XQ5g1]Q5{1mQ6V1xQ6a2RU6p2v2y2|Q6s2zQ8R5XQ8Z5fQ8[5hQ8a5pQ8j5|Q8p6US9P6q6uQ9R6tQ9{8XQ:U8kQ:Z8qQ:b9QQ:x9|Q;O:VQ;S:cR;a;PQ%yyQ'b!iQ'm!uU+j%z%{%|Q-R'TU-f'c'd'eS-j'i'sQ/z*gS0z+k+lQ2g-TS2s-g-hQ2z-oS4g/{0OQ5X0{Q6l2mQ6o2tQ6t2{U7q4i4j4mQ9o7sR:r9pS$wi=pR*x%VU%Ui%V=pR0`*vQ$viS(s#v+fS)a$b$cQ)c$dQ*Y$xS*b${*WQ*q%OQ*r%QQ*|%]Q*}%^Q+R%bQ.g<aQ.h<cQ.j<gQ.k<iQ.l<kQ/Y)wQ/b*PQ/d*RQ/f*TQ/q*^S/v*d/hQ0^*tQ0_*ul0p+c,Q.a1a1i3Z5x6|8f9V:S:f:};VQ1]+}Q3^<tQ3_<vQ3`<yS3u<^<_Q3y.zS4S/_4UQ4^/rQ4_/sQ4c/uQ4s0YQ4u0[Q4{0gQ4|0hQ4}0iQ5h1^Q7R<}Q7S=PQ7T=RQ7U=TQ7Z<bQ7[<dQ7^<hQ7_<jQ7`<lQ7f4VQ7m4aQ7p4fQ7z4wQ7}5RQ8P5UQ9]<zQ9^<uQ9_<wQ9i7lQ9q7vQ9v7|Q9w8QQ:h=OQ:i=QQ:j=SQ:k=UQ:l9eQ:q9nQ:u9tQ;W=XQ;]:tQ;h;^Q;k=YQ=b=pQ=n=xQ=o=yQ=z=|R={=}Q*z%[Q.i<eR7]<fnpOXst!Z#d%l&p&r&s&u,n,s2S2VQ!fPS#fZ#oQ&z!`W'f!o*f0V4qQ'}#SQ)O#{Q)p$nS,g&i&lQ,l&mQ,y&yS-O'R/iQ-b'`Q.s(|Q/V)qQ0m+YQ0s+dQ2O,kQ2q-dQ3X.bQ4O/QQ4y0dQ5v1jQ6X1zQ6Y1{Q6^1}Q6`2PQ6e2XQ7P3[Q7c3{Q8h5yQ8t6ZQ8u6[Q8w6_Q9Z7QQ:T8iR:_8x#[cOPXZst!Z!`!o#d#o#{%l&i&l&m&p&r&s&u&y'R'`(|*f+Y+d,k,n,s-d.b/i0V0d1j1z1{1}2P2S2V2X3[4q5y6Z6[6_7Q8i8xQ#YWQ#eYQ%puQ%rvS%tw!gS(Q#W(TQ(W#ZQ(r#uQ(w#xQ)P$OQ)Q$PQ)R$QQ)S$RQ)T$SQ)U$TQ)V$UQ)W$VQ)X$WQ)Y$XQ)[$ZQ)^$_Q)`$aQ)e$eW)o$n)q/Q3{Q+a%sQ+u&QS-U'V2hQ-s'pS-x(R-zQ-}(ZQ.P(bQ.n(vQ.q(xQ.u;vQ.w;yQ.x;zQ.y;}Q/]){Q0j+UQ2c-PQ2f-SQ2v-lQ2}.QQ3c.oQ3h<OQ3i<PQ3j<QQ3k<RQ3l<SQ3m<TQ3n<UQ3o<VQ3p<WQ3q<XQ3r<YQ3s.vQ3t<]Q3w<`Q3x<mQ4P<ZQ5O0lQ5Y0|Q6k<pQ6q2xQ6v3OQ7V3dQ7W<qQ7a<sQ7b<{Q8`5mQ8|6iQ9Q6rQ9[<|Q9b=VQ9c=WQ:c9SQ:y9}Q;R:aQ;x#SR=g=sR#[WR'X!el!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sS'T!e-WU*g$|*X*lS-T'U']S0O*h*nQ0W*oQ2m-^Q4m0UR4r0XR(y#xQ!fQT-_'^-`]!qQ!r'^-`1g5qQ#p]R'g;wR)d$dY!uQ'^-`1g5qQ'i!rS's!v!yS'u!z5sS-o'j'kQ-q'lR2{-pT#kZ%dS#jZ%dS%jm,jU(e#h#i#lS.T(f(gQ.X(hQ0n+ZQ3Q.UU3R.V.W.YS6x3S3TR9T6yd#^W#W#Z%g(R([*W+W.O/hr#gZm#h#i#l%d(f(g(h+Z.U.V.W.Y3S3T6yS*Z$x*_Q/o*[Q1|,jQ2d-QQ4W/kQ6g2[Q7i4XQ8{6hT=_'V+XV#aW%g*WU#`W%g*WS(S#W([U(X#Z+W/hS-V'V+XT-y(R.OV'[!e%h*XQ$lfR)v$qT)k$l)lR3}/PT*]$x*_T*e${*WQ0q+cQ1_,QQ3V.aQ5j1aQ5u1iQ6}3ZQ8g5xQ9W6|Q:Q8fQ:d9VQ:|:SQ;U:fQ;`:}R;c;VnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&j!VR,c&gtmOXst!U!V!Z#d%l&g&p&r&s&u,n,s2S2VR,j&mT%km,jR1c,SR,b&eQ&T|R+z&UR+p&OT&n!W&qT&o!W&qT2U,s2V",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:378,context:$3e,nodeProps:[["isolate",-8,5,6,14,35,37,49,51,53,""],["group",-26,9,17,19,66,206,210,214,215,217,220,223,233,235,241,243,245,247,250,256,262,264,266,268,270,272,273,"Statement",-34,13,14,30,33,34,40,49,52,53,55,60,68,70,74,78,80,82,83,108,109,118,119,135,138,140,141,142,143,144,146,147,166,168,170,"Expression",-23,29,31,35,39,41,43,172,174,176,177,179,180,181,183,184,185,187,188,189,200,202,204,205,"Type",-3,86,101,107,"ClassItem"],["openedBy",23,"<",36,"InterpolationStart",54,"[",58,"{",71,"(",159,"JSXStartCloseTag"],["closedBy",-2,24,167,">",38,"InterpolationEnd",48,"]",59,"}",72,")",164,"JSXEndTag"]],propSources:[V3e],skippedNodes:[0,5,6,276],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$h&j(Up(X!b'z0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(V#S$h&j'{0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$h&j(Up(X!b'{0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$h&j!n),Q(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(T':f$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$h&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$c`$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$c``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$c`$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(X!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$c`(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$h&j(Up(X!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$h&j(Up(X!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$h&j(X!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$h&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(X!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$h&j(UpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(UpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Up(X!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$h&j(m%1l(Up(X!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$h&j(Up(X!b$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$h&j(Up(X!b$[#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$h&j(Up(X!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$h&j$P(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(x+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$h&j#y(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(W';W$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$h&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$c`$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(UpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$c`(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!j/.^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!i!Lf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$h&j(Up(X!b(S%&f#o(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$h&j(Up(X!b#l(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$h&j(Up(X!bp+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!Z+Jf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$h&j(Up(X!b!O.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_!Y!L^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$h&j(Up(X!b#m(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$h&j(X!b!V7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$h&j!V7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$h&j!V7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!V7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!V7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$h&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$h&j(X!b!V7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(X!b!V7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(X!b!V7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(X!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$h&j(X!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$h&j(Up!V7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$h&j(Up!V7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Up!V7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Up!V7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(UpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$h&j(UpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$h&j(Up(X!b!V7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Up(X!b!V7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Up(X!b!V7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Up(X!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$h&j(Up(X!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$h&j(Up(X!b'|0/l!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$h&j(Up(X!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$h&j(X!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$h&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(X!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$h&j(UpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(UpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Up(X!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$h&j$P(Ch(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Y#t$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!e$b$h&j#})Lv(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#P-<U(Up(X!b$m7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$j&j(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#p(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$P(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#q(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#^*!Y$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#i(Cl$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#q(Ch$e#|$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#q(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(p(Ct$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$h&j#z(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!z$Ip$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!Q0,v$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$h&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$h&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$h&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$h&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$h&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!W#)l$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#w(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$h&j(Up(X!b(_+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$h&j(Up(X!b(R,2j$^#t(c$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$h&j(Up(X!b$^#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!]#Hb(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(w+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_![(CdtBr$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!o7`$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$h&j(Up(X!b'z0/l$[#t(R,2j(c$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$h&j(Up(X!b'{0/l$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[_3e,L3e,I3e,Q3e,2,3,4,5,6,7,8,9,10,11,12,13,14,R3e,new aC("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOv~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!S~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(a~~",141,338),new aC("j~RQYZXz{^~^O(O~~aP!P!Qd~iO(P~~",25,321)],topRules:{Script:[0,7],SingleExpression:[1,274],SingleClassItem:[2,275]},dialects:{jsx:0,ts:15091},dynamicPrecedences:{78:1,80:1,92:1,168:1,198:1},specialized:[{term:325,get:n=>j3e[n]||-1},{term:341,get:n=>Z3e[n]||-1},{term:93,get:n=>z3e[n]||-1}],tokenPrec:15116}),LH=[Zr("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Zr("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Zr("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Zr("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Zr("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Zr(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Zr("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Zr(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Zr(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Zr('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Zr('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],X3e=LH.concat([Zr("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Zr("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Zr("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),aF=new BCe,IH=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Lp(n){return(e,t)=>{let s=e.node.getChild("VariableDefinition");return s&&t(s,n),!0}}const W3e=["FunctionDeclaration"],q3e={FunctionDeclaration:Lp("function"),ClassDeclaration:Lp("class"),ClassExpression:()=>!0,EnumDeclaration:Lp("constant"),TypeAliasDeclaration:Lp("type"),NamespaceDeclaration:Lp("namespace"),VariableDefinition(n,e){n.matchContext(W3e)||e(n,"variable")},TypeDefinition(n,e){e(n,"type")},__proto__:null};function QH(n,e){let t=aF.get(e);if(t)return t;let s=[],a=!0;function r(o,i){let l=n.sliceString(o.from,o.to);s.push({label:l,type:i})}return e.cursor(Ca.IncludeAnonymous).iterate(o=>{if(a)a=!1;else if(o.name){let i=q3e[o.name];if(i&&i(o,r)||IH.has(o.name))return!1}else if(o.to-o.from>8192){for(let i of QH(n,o.node))s.push(i);return!1}}),aF.set(e,s),s}const rF=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,VH=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function U3e(n){let e=Ka(n.state).resolveInner(n.pos,-1);if(VH.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&rF.test(n.state.sliceDoc(e.from,e.to));if(!t&&!n.explicit)return null;let s=[];for(let a=e;a;a=a.parent)IH.has(a.name)&&(s=s.concat(QH(n.state.doc,a)));return{options:s,from:t?e.from:n.pos,validFor:rF}}const bu=Gy.define({name:"javascript",parser:G3e.configure({props:[bU.add({IfStatement:bk({except:/^\s*({|else\b)/}),TryStatement:bk({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:tMe,SwitchBody:n=>{let e=n.textAfter,t=/^\s*\}/.test(e),s=/^\s*(case|default)\b/.test(e);return n.baseIndent+(t?0:s?1:2)*n.unit},Block:eMe({closing:"}"}),ArrowFunction:n=>n.baseIndent+n.unit,"TemplateString BlockComment":()=>null,"Statement Property":bk({except:/^{/}),JSXElement(n){let e=/^\s*<\//.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},JSXEscape(n){let e=/\s*\}/.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},"JSXOpenTag JSXSelfClosingTag"(n){return n.column(n.node.from)+n.unit}}),wU.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":sMe,BlockComment(n){return{from:n.from+2,to:n.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),jH={test:n=>/^JSX/.test(n.name),facet:mU({commentTokens:{block:{open:"{/*",close:"*/}"}}})},H3e=bu.configure({dialect:"ts"},"typescript"),Y3e=bu.configure({dialect:"jsx",props:[B3.add(n=>n.isTop?[jH]:void 0)]}),K3e=bu.configure({dialect:"jsx ts",props:[B3.add(n=>n.isTop?[jH]:void 0)]},"typescript");let ZH=n=>({label:n,type:"keyword"});const zH="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(ZH),J3e=zH.concat(["declare","implements","private","protected","public"].map(ZH));function e5e(n={}){let e=n.jsx?n.typescript?K3e:Y3e:n.typescript?H3e:bu,t=n.typescript?X3e.concat(J3e):LH.concat(zH);return new XCe(e,[bu.data.of({autocomplete:TMe(VH,RU(t))}),bu.data.of({autocomplete:U3e}),n.jsx?s5e:[]])}function t5e(n){for(;;){if(n.name=="JSXOpenTag"||n.name=="JSXSelfClosingTag"||n.name=="JSXFragmentTag")return n;if(n.name=="JSXEscape"||!n.parent)return null;n=n.parent}}function oF(n,e,t=n.length){for(let s=e==null?void 0:e.firstChild;s;s=s.nextSibling)if(s.name=="JSXIdentifier"||s.name=="JSXBuiltin"||s.name=="JSXNamespacedName"||s.name=="JSXMemberExpression")return n.sliceString(s.from,Math.min(s.to,t));return""}const n5e=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),s5e=vt.inputHandler.of((n,e,t,s,a)=>{if((n5e?n.composing:n.compositionStarted)||n.state.readOnly||e!=t||s!=">"&&s!="/"||!bu.isActiveAt(n.state,e,-1))return!1;let r=a(),{state:o}=r,i=o.changeByRange(l=>{var c;let{head:u}=l,h=Ka(o).resolveInner(u-1,-1),m;if(h.name=="JSXStartTag"&&(h=h.parent),!(o.doc.sliceString(u-1,u)!=s||h.name=="JSXAttributeValue"&&h.to>u)){if(s==">"&&h.name=="JSXFragmentTag")return{range:l,changes:{from:u,insert:"</>"}};if(s=="/"&&h.name=="JSXStartCloseTag"){let f=h.parent,v=f.parent;if(v&&f.from==u-2&&((m=oF(o.doc,v.firstChild,u))||((c=v.firstChild)===null||c===void 0?void 0:c.name)=="JSXFragmentTag")){let O=`${m}>`;return{range:Ze.cursor(u+O.length,-1),changes:{from:u,insert:O}}}}else if(s==">"){let f=t5e(h);if(f&&f.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(o.doc.sliceString(u,u+2))&&(m=oF(o.doc,f,u)))return{range:l,changes:{from:u,insert:`</${m}>`}}}}return{range:l}});return i.changes.empty?!1:(n.dispatch([r,o.update(i,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),a5e=JSON.parse(`[{"comment":"/**\\n * Overrides the css of highlighted events. Make sure to use single quotes!\\n * @name markcss\\n * @example\\n * note(\\"c a f e\\")\\n * .markcss('text-decoration:underline')\\n */","meta":{"filename":"codemirror.mjs","lineno":379,"columnno":0,"path":"/home/alex/src/strudel/packages/codemirror","code":{}},"description":"<p>Overrides the css of highlighted events. Make sure to use single quotes!</p>","name":"markcss","examples":["note(\\"c a f e\\")\\n.markcss('text-decoration:underline')"],"longname":"markcss","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a slider widget to allow the user manipulate a value\\n *\\n * @name slider\\n * @param {number} value Initial value\\n * @param {number} min Minimum value - optional, defaults to 0\\n * @param {number} max Maximum value - optional, defaults to 1\\n * @param {number} step Step size - optional\\n */","meta":{"filename":"slider.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/codemirror","code":{}},"description":"<p>Displays a slider widget to allow the user manipulate a value</p>","name":"slider","params":[{"type":{"names":["number"]},"description":"<p>Initial value</p>","name":"value"},{"type":{"names":["number"]},"description":"<p>Minimum value - optional, defaults to 0</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>Maximum value - optional, defaults to 1</p>","name":"max"},{"type":{"names":["number"]},"description":"<p>Step size - optional</p>","name":"step"}],"longname":"slider","kind":"member","scope":"global"},{"comment":"/**\\n * Select a sound / sample by name. When using mininotation, you can also optionally supply 'n' and 'gain' parameters\\n * separated by ':'.\\n *\\n * @name s\\n * @param {string | Pattern} sound The sound / pattern of sounds to pick\\n * @synonyms sound\\n * @example\\n * s(\\"bd hh\\")\\n * @example\\n * s(\\"bd:0 bd:1 bd:0:0.3 bd:1:1.4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":75,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Select a sound / sample by name. When using mininotation, you can also optionally supply 'n' and 'gain' parameters\\nseparated by ':'.</p>","name":"s","params":[{"type":{"names":["string","Pattern"]},"description":"<p>The sound / pattern of sounds to pick</p>","name":"sound"}],"synonyms_text":"sound","synonyms":["sound"],"examples":["s(\\"bd hh\\")","s(\\"bd:0 bd:1 bd:0:0.3 bd:1:1.4\\")"],"longname":"s","kind":"member","scope":"global"},{"comment":"/**\\n * Position in the wavetable of the wavetable oscillator\\n *\\n * @name wt\\n * @param {number | Pattern} position Position in the wavetable from 0 to 1\\n * @synonyms wavetablePosition\\n * @example\\n * s(\\"squelch\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").wt(\\"0 0.25 0.5 0.75 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":90,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Position in the wavetable of the wavetable oscillator</p>","name":"wt","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Position in the wavetable from 0 to 1</p>","name":"position"}],"synonyms_text":"wavetablePosition","synonyms":["wavetablePosition"],"examples":["s(\\"squelch\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").wt(\\"0 0.25 0.5 0.75 1\\")"],"longname":"wt","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of envelope applied wavetable oscillator's position envelope\\n *\\n * @name wtenv\\n * @param {number | Pattern} amount between 0 and 1\\n */","meta":{"filename":"controls.mjs","lineno":101,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of envelope applied wavetable oscillator's position envelope</p>","name":"wtenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"amount"}],"longname":"wtenv","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of the wavetable oscillator's position envelope\\n *\\n * @name wtattack\\n * @synonyms wtatt\\n * @param {number | Pattern} time attack time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":108,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of the wavetable oscillator's position envelope</p>","name":"wtattack","synonyms_text":"wtatt","synonyms":["wtatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"}],"longname":"wtattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of the wavetable oscillator's position envelope\\n *\\n * @name wtdecay\\n * @synonyms wtdec\\n * @param {number | Pattern} time decay time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":117,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of the wavetable oscillator's position envelope</p>","name":"wtdecay","synonyms_text":"wtdec","synonyms":["wtdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"longname":"wtdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain time of the wavetable oscillator's position envelope\\n *\\n * @name wtsustain\\n * @synonyms wtsus\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n */","meta":{"filename":"controls.mjs","lineno":126,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain time of the wavetable oscillator's position envelope</p>","name":"wtsustain","synonyms_text":"wtsus","synonyms":["wtsus"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"}],"longname":"wtsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of the wavetable oscillator's position envelope\\n *\\n * @name wtrelease\\n * @synonyms wtrel\\n * @param {number | Pattern} time release time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":135,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of the wavetable oscillator's position envelope</p>","name":"wtrelease","synonyms_text":"wtrel","synonyms":["wtrel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"longname":"wtrelease","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of the LFO for the wavetable oscillator's position\\n *\\n * @name wtrate\\n * @param {number | Pattern} rate rate in hertz\\n */","meta":{"filename":"controls.mjs","lineno":144,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of the LFO for the wavetable oscillator's position</p>","name":"wtrate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in hertz</p>","name":"rate"}],"longname":"wtrate","kind":"member","scope":"global"},{"comment":"/**\\n * cycle synced rate of the LFO for the wavetable oscillator's position\\n *\\n * @name wtsync\\n * @param {number | Pattern} rate rate in cycles\\n */","meta":{"filename":"controls.mjs","lineno":151,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>cycle synced rate of the LFO for the wavetable oscillator's position</p>","name":"wtsync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in cycles</p>","name":"rate"}],"longname":"wtsync","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of the LFO for the wavetable oscillator's position\\n *\\n * @name wtdepth\\n * @param {number | Pattern} depth depth of modulation\\n */","meta":{"filename":"controls.mjs","lineno":159,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of the LFO for the wavetable oscillator's position</p>","name":"wtdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation</p>","name":"depth"}],"longname":"wtdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of the LFO for the wavetable oscillator's position\\n *\\n * @name wtshape\\n * @param {number | Pattern} shape Shape of the lfo (0, 1, 2, ..)\\n */","meta":{"filename":"controls.mjs","lineno":167,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of the LFO for the wavetable oscillator's position</p>","name":"wtshape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Shape of the lfo (0, 1, 2, ..)</p>","name":"shape"}],"longname":"wtshape","kind":"member","scope":"global"},{"comment":"/**\\n * DC offset of the LFO for the wavetable oscillator's position\\n *\\n * @name wtdc\\n * @param {number | Pattern} dcoffset dc offset. set to 0 for unipolar\\n */","meta":{"filename":"controls.mjs","lineno":175,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DC offset of the LFO for the wavetable oscillator's position</p>","name":"wtdc","params":[{"type":{"names":["number","Pattern"]},"description":"<p>dc offset. set to 0 for unipolar</p>","name":"dcoffset"}],"longname":"wtdc","kind":"member","scope":"global"},{"comment":"/**\\n * Skew of the LFO for the wavetable oscillator's position\\n *\\n * @name wtskew\\n * @param {number | Pattern} skew How much to bend the LFO shape\\n */","meta":{"filename":"controls.mjs","lineno":183,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Skew of the LFO for the wavetable oscillator's position</p>","name":"wtskew","params":[{"type":{"names":["number","Pattern"]},"description":"<p>How much to bend the LFO shape</p>","name":"skew"}],"longname":"wtskew","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of warp (alteration of the waveform) to apply to the wavetable oscillator\\n *\\n * @name warp\\n * @param {number | Pattern} amount Warp of the wavetable from 0 to 1\\n * @synonyms wavetableWarp\\n * @example\\n * s(\\"basique\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n *   .warpmode(\\"spin\\")\\n */","meta":{"filename":"controls.mjs","lineno":191,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of warp (alteration of the waveform) to apply to the wavetable oscillator</p>","name":"warp","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Warp of the wavetable from 0 to 1</p>","name":"amount"}],"synonyms_text":"wavetableWarp","synonyms":["wavetableWarp"],"examples":["s(\\"basique\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n  .warpmode(\\"spin\\")"],"longname":"warp","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of the wavetable oscillator's warp envelope\\n *\\n * @name warpattack\\n * @synonyms warpatt\\n * @param {number | Pattern} time attack time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":203,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of the wavetable oscillator's warp envelope</p>","name":"warpattack","synonyms_text":"warpatt","synonyms":["warpatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"}],"longname":"warpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of the wavetable oscillator's warp envelope\\n *\\n * @name warpdecay\\n * @synonyms warpdec\\n * @param {number | Pattern} time decay time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of the wavetable oscillator's warp envelope</p>","name":"warpdecay","synonyms_text":"warpdec","synonyms":["warpdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"longname":"warpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain time of the wavetable oscillator's warp envelope\\n *\\n * @name warpsustain\\n * @synonyms warpsus\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n */","meta":{"filename":"controls.mjs","lineno":221,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain time of the wavetable oscillator's warp envelope</p>","name":"warpsustain","synonyms_text":"warpsus","synonyms":["warpsus"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"}],"longname":"warpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of the wavetable oscillator's warp envelope\\n *\\n * @name warprelease\\n * @synonyms warprel\\n * @param {number | Pattern} time release time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":230,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of the wavetable oscillator's warp envelope</p>","name":"warprelease","synonyms_text":"warprel","synonyms":["warprel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"longname":"warprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of the LFO for the wavetable oscillator's warp\\n *\\n * @name warprate\\n * @param {number | Pattern} rate rate in hertz\\n */","meta":{"filename":"controls.mjs","lineno":239,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of the LFO for the wavetable oscillator's warp</p>","name":"warprate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in hertz</p>","name":"rate"}],"longname":"warprate","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpdepth\\n * @param {number | Pattern} depth depth of modulation\\n */","meta":{"filename":"controls.mjs","lineno":247,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of the LFO for the wavetable oscillator's warp</p>","name":"warpdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation</p>","name":"depth"}],"longname":"warpdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpshape\\n * @param {number | Pattern} shape Shape of the lfo (0, 1, 2, ..)\\n */","meta":{"filename":"controls.mjs","lineno":255,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of the LFO for the wavetable oscillator's warp</p>","name":"warpshape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Shape of the lfo (0, 1, 2, ..)</p>","name":"shape"}],"longname":"warpshape","kind":"member","scope":"global"},{"comment":"/**\\n * DC offset of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpdc\\n * @param {number | Pattern} dcoffset dc offset. set to 0 for unipolar\\n */","meta":{"filename":"controls.mjs","lineno":263,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DC offset of the LFO for the wavetable oscillator's warp</p>","name":"warpdc","params":[{"type":{"names":["number","Pattern"]},"description":"<p>dc offset. set to 0 for unipolar</p>","name":"dcoffset"}],"longname":"warpdc","kind":"member","scope":"global"},{"comment":"/**\\n * Skew of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpskew\\n * @param {number | Pattern} skew How much to bend the LFO shape\\n */","meta":{"filename":"controls.mjs","lineno":271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Skew of the LFO for the wavetable oscillator's warp</p>","name":"warpskew","params":[{"type":{"names":["number","Pattern"]},"description":"<p>How much to bend the LFO shape</p>","name":"skew"}],"longname":"warpskew","kind":"member","scope":"global"},{"comment":"/**\\n * Type of warp (alteration of the waveform) to apply to the wavetable oscillator.\\n *\\n * The current options are: none, asym, bendp, bendm, bendmp, sync, quant, fold, pwm, orbit,\\n * spin, chaos, primes, binary, brownian, reciprocal, wormhole, logistic, sigmoid, fractal, flip\\n *\\n * @name warpmode\\n * @param {number | string | Pattern} mode Warp mode\\n * @synonyms wavetableWarpMode\\n * @example\\n * s(\\"morgana\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n *   .warpmode(\\"<asym bendp spin logistic sync wormhole brownian>*2\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":279,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Type of warp (alteration of the waveform) to apply to the wavetable oscillator.</p>\\n<p>The current options are: none, asym, bendp, bendm, bendmp, sync, quant, fold, pwm, orbit,\\nspin, chaos, primes, binary, brownian, reciprocal, wormhole, logistic, sigmoid, fractal, flip</p>","name":"warpmode","params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>Warp mode</p>","name":"mode"}],"synonyms_text":"wavetableWarpMode","synonyms":["wavetableWarpMode"],"examples":["s(\\"morgana\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n  .warpmode(\\"<asym bendp spin logistic sync wormhole brownian>*2\\")"],"longname":"warpmode","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of randomness of the initial phase of the wavetable oscillator.\\n *\\n * @name wtphaserand\\n * @param {number | Pattern} amount Randomness of the initial phase. Between 0 (not random) and 1 (fully random)\\n * @synonyms wavetablePhaseRand\\n * @example\\n * s(\\"basique\\").bank(\\"wt_digital\\").seg(16).wtphaserand(\\"<0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":295,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of randomness of the initial phase of the wavetable oscillator.</p>","name":"wtphaserand","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Randomness of the initial phase. Between 0 (not random) and 1 (fully random)</p>","name":"amount"}],"synonyms_text":"wavetablePhaseRand","synonyms":["wavetablePhaseRand"],"examples":["s(\\"basique\\").bank(\\"wt_digital\\").seg(16).wtphaserand(\\"<0 1>\\")"],"longname":"wtphaserand","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of envelope applied wavetable oscillator's position envelope\\n *\\n * @name warpenv\\n * @param {number | Pattern} amount between 0 and 1\\n */","meta":{"filename":"controls.mjs","lineno":307,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of envelope applied wavetable oscillator's position envelope</p>","name":"warpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"amount"}],"longname":"warpenv","kind":"member","scope":"global"},{"comment":"/**\\n * cycle synced rate of the LFO for the wavetable warp position\\n *\\n * @name warpsync\\n * @param {number | Pattern} rate rate in cycles\\n */","meta":{"filename":"controls.mjs","lineno":315,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>cycle synced rate of the LFO for the wavetable warp position</p>","name":"warpsync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in cycles</p>","name":"rate"}],"longname":"warpsync","kind":"member","scope":"global"},{"comment":"/**\\n * Define a custom webaudio node to use as a sound source.\\n *\\n * @name source\\n * @synonyms src\\n * @param {function} getSource\\n * @synonyms src\\n *\\n */","meta":{"filename":"controls.mjs","lineno":323,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Define a custom webaudio node to use as a sound source.</p>","name":"source","synonyms_text":"src","synonyms":["src"],"params":[{"type":{"names":["function"]},"name":"getSource"}],"longname":"source","kind":"member","scope":"global"},{"comment":"/**\\n * Selects the given index from the sample map.\\n * Numbers too high will wrap around.\\n * \`n\` can also be used to play midi numbers, but it is recommended to use \`note\` instead.\\n *\\n * @name n\\n * @param {number | Pattern} value sample index starting from 0\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").n(\\"<0 1>\\")\\n */","meta":{"filename":"controls.mjs","lineno":333,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Selects the given index from the sample map.\\nNumbers too high will wrap around.\\n<code>n</code> can also be used to play midi numbers, but it is recommended to use <code>note</code> instead.</p>","name":"n","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sample index starting from 0</p>","name":"value"}],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").n(\\"<0 1>\\")"],"longname":"n","kind":"member","scope":"global"},{"comment":"/**\\n * Plays the given note name or midi number. A note name consists of\\n *\\n * - a letter (a-g or A-G)\\n * - optional accidentals (b or #)\\n * - optional (possibly negative) octave number (0-9). Defaults to 3\\n *\\n * Examples of valid note names: \`c\`, \`bb\`, \`Bb\`, \`f#\`, \`c3\`, \`A4\`, \`Eb2\`, \`c#5\`\\n *\\n * You can also use midi numbers instead of note names, where 69 is mapped to A4 440Hz in 12EDO.\\n *\\n * @name note\\n * @example\\n * note(\\"c a f e\\")\\n * @example\\n * note(\\"c4 a4 f4 e4\\")\\n * @example\\n * note(\\"60 69 65 64\\")\\n * @example\\n * note(\\"fbb1 a#0 cbbb-1 e##-2\\").sound(\\"saw\\")\\n */","meta":{"filename":"controls.mjs","lineno":345,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Plays the given note name or midi number. A note name consists of</p>\\n<ul>\\n<li>a letter (a-g or A-G)</li>\\n<li>optional accidentals (b or #)</li>\\n<li>optional (possibly negative) octave number (0-9). Defaults to 3</li>\\n</ul>\\n<p>Examples of valid note names: <code>c</code>, <code>bb</code>, <code>Bb</code>, <code>f#</code>, <code>c3</code>, <code>A4</code>, <code>Eb2</code>, <code>c#5</code></p>\\n<p>You can also use midi numbers instead of note names, where 69 is mapped to A4 440Hz in 12EDO.</p>","name":"note","examples":["note(\\"c a f e\\")","note(\\"c4 a4 f4 e4\\")","note(\\"60 69 65 64\\")","note(\\"fbb1 a#0 cbbb-1 e##-2\\").sound(\\"saw\\")"],"longname":"note","kind":"member","scope":"global"},{"comment":"/**\\n * A pattern of numbers that speed up (or slow down) samples while they play. Currently only supported by osc / superdirt.\\n *\\n * @name accelerate\\n * @param {number | Pattern} amount acceleration.\\n * @superdirtOnly\\n * @example\\n * s(\\"sax\\").accelerate(\\"<0 1 2 4 8 16>\\").slow(2).osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":368,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A pattern of numbers that speed up (or slow down) samples while they play. Currently only supported by osc / superdirt.</p>","name":"accelerate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>acceleration.</p>","name":"amount"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"sax\\").accelerate(\\"<0 1 2 4 8 16>\\").slow(2).osc()"],"longname":"accelerate","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the velocity from 0 to 1. Is multiplied together with gain.\\n *\\n * @name velocity\\n * @example\\n * s(\\"hh*8\\")\\n * .gain(\\".4!2 1 .4!2 1 .4 1\\")\\n * .velocity(\\".4 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":379,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the velocity from 0 to 1. Is multiplied together with gain.</p>","name":"velocity","examples":["s(\\"hh*8\\")\\n.gain(\\".4!2 1 .4!2 1 .4 1\\")\\n.velocity(\\".4 1\\")"],"longname":"velocity","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the gain by an exponential amount.\\n *\\n * @name gain\\n * @param {number | Pattern} amount gain.\\n * @example\\n * s(\\"hh*8\\").gain(\\".4!2 1 .4!2 1 .4 1\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":389,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the gain by an exponential amount.</p>","name":"gain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>gain.</p>","name":"amount"}],"examples":["s(\\"hh*8\\").gain(\\".4!2 1 .4!2 1 .4 1\\").fast(2)"],"longname":"gain","kind":"member","scope":"global"},{"comment":"/**\\n * Gain applied after all effects have been processed.\\n *\\n * @name postgain\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\")\\n * .compressor(\\"-20:20:10:.002:.02\\").postgain(1.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":399,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Gain applied after all effects have been processed.</p>","name":"postgain","examples":["s(\\"bd sd [~ bd] sd,hh*8\\")\\n.compressor(\\"-20:20:10:.002:.02\\").postgain(1.5)"],"longname":"postgain","kind":"member","scope":"global"},{"comment":"/**\\n * Like \`gain\`, but linear.\\n *\\n * @name amp\\n * @param {number | Pattern} amount gain.\\n * @superdirtOnly\\n * @example\\n * s(\\"bd*8\\").amp(\\".1*2 .5 .1*2 .5 .1 .5\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":409,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>gain</code>, but linear.</p>","name":"amp","params":[{"type":{"names":["number","Pattern"]},"description":"<p>gain.</p>","name":"amount"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"bd*8\\").amp(\\".1*2 .5 .1*2 .5 .1 .5\\").osc()"],"longname":"amp","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope attack time: Specifies how long it takes for the sound to reach its peak value, relative to the onset.\\n *\\n * @name attack\\n * @param {number | Pattern} attack time in seconds.\\n * @synonyms att\\n * @example\\n * note(\\"c3 e3 f3 g3\\").attack(\\"<0 .1 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":420,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope attack time: Specifies how long it takes for the sound to reach its peak value, relative to the onset.</p>","name":"attack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds.</p>","name":"attack"}],"synonyms_text":"att","synonyms":["att"],"examples":["note(\\"c3 e3 f3 g3\\").attack(\\"<0 .1 .5>\\")"],"longname":"attack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the Frequency Modulation Harmonicity Ratio.\\n * Controls the timbre of the sound.\\n * Whole numbers and simple ratios sound more natural,\\n * while decimal numbers and complex ratios sound metallic.\\n *\\n * @name fmh\\n * @param {number | Pattern} harmonicity\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmh(\\"<1 2 1.5 1.61>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":432,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the Frequency Modulation Harmonicity Ratio.\\nControls the timbre of the sound.\\nWhole numbers and simple ratios sound more natural,\\nwhile decimal numbers and complex ratios sound metallic.</p>","name":"fmh","params":[{"type":{"names":["number","Pattern"]},"name":"harmonicity"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmh(\\"<1 2 1.5 1.61>\\")\\n._scope()"],"longname":"fmh","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the Frequency Modulation of the synth.\\n * Controls the modulation index, which defines the brightness of the sound.\\n *\\n * @name fm\\n * @param {number | Pattern} brightness modulation index\\n * @synonyms fmi\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(\\"<0 1 2 8 32>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the Frequency Modulation of the synth.\\nControls the modulation index, which defines the brightness of the sound.</p>","name":"fm","params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation index</p>","name":"brightness"}],"synonyms_text":"fmi","synonyms":["fmi"],"examples":["note(\\"c e g b g e\\")\\n.fm(\\"<0 1 2 8 32>\\")\\n._scope()"],"longname":"fm","kind":"member","scope":"global"},{"comment":"/**\\n * Ramp type of fm envelope. Exp might be a bit broken..\\n *\\n * @name fmenv\\n * @param {number | Pattern} type lin | exp\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(.2)\\n * .fmsustain(0)\\n * .fmenv(\\"<exp lin>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":463,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Ramp type of fm envelope. Exp might be a bit broken..</p>","name":"fmenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>lin | exp</p>","name":"type"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(.2)\\n.fmsustain(0)\\n.fmenv(\\"<exp lin>\\")\\n._scope()"],"longname":"fmenv","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time for the FM envelope: time it takes to reach maximum modulation\\n *\\n * @name fmattack\\n * @param {number | Pattern} time attack time\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmattack(\\"<0 .05 .1 .2>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":478,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time for the FM envelope: time it takes to reach maximum modulation</p>","name":"fmattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time</p>","name":"time"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmattack(\\"<0 .05 .1 .2>\\")\\n._scope()"],"longname":"fmattack","kind":"member","scope":"global"},{"comment":"/**\\n * Waveform of the fm modulator\\n *\\n * @name fmwave\\n * @param {number | Pattern} wave waveform\\n * @example\\n * n(\\"0 1 2 3\\".fast(4)).scale(\\"d:minor\\").s(\\"sine\\").fmwave(\\"<sine square sawtooth crackle>\\").fm(4).fmh(2.01)\\n * @example\\n * n(\\"0 1 2 3\\".fast(4)).chord(\\"<Dm Am F G>\\").voicing().s(\\"sawtooth\\").fmwave(\\"brown\\").fm(.6)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":492,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Waveform of the fm modulator</p>","name":"fmwave","params":[{"type":{"names":["number","Pattern"]},"description":"<p>waveform</p>","name":"wave"}],"examples":["n(\\"0 1 2 3\\".fast(4)).scale(\\"d:minor\\").s(\\"sine\\").fmwave(\\"<sine square sawtooth crackle>\\").fm(4).fmh(2.01)","n(\\"0 1 2 3\\".fast(4)).chord(\\"<Dm Am F G>\\").voicing().s(\\"sawtooth\\").fmwave(\\"brown\\").fm(.6)"],"longname":"fmwave","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time for the FM envelope: seconds until the sustain level is reached after the attack phase.\\n *\\n * @name fmdecay\\n * @param {number | Pattern} time decay time\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(\\"<.01 .05 .1 .2>\\")\\n * .fmsustain(.4)\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":505,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time for the FM envelope: seconds until the sustain level is reached after the attack phase.</p>","name":"fmdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time</p>","name":"time"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(\\"<.01 .05 .1 .2>\\")\\n.fmsustain(.4)\\n._scope()"],"longname":"fmdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain level for the FM envelope: how much modulation is applied after the decay phase\\n *\\n * @name fmsustain\\n * @param {number | Pattern} level sustain level\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(.1)\\n * .fmsustain(\\"<1 .75 .5 0>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":519,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain level for the FM envelope: how much modulation is applied after the decay phase</p>","name":"fmsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level</p>","name":"level"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(.1)\\n.fmsustain(\\"<1 .75 .5 0>\\")\\n._scope()"],"longname":"fmsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Select the sound bank to use. To be used together with \`s\`. The bank name (+ \\"_\\") will be prepended to the value of \`s\`.\\n *\\n * @name bank\\n * @param {string | Pattern} bank the name of the bank\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").bank('RolandTR909') // = s(\\"RolandTR909_bd RolandTR909_sd\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":537,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Select the sound bank to use. To be used together with <code>s</code>. The bank name (+ &quot;_&quot;) will be prepended to the value of <code>s</code>.</p>","name":"bank","params":[{"type":{"names":["string","Pattern"]},"description":"<p>the name of the bank</p>","name":"bank"}],"examples":["s(\\"bd sd [~ bd] sd\\").bank('RolandTR909') // = s(\\"RolandTR909_bd RolandTR909_sd\\")"],"longname":"bank","kind":"member","scope":"global"},{"comment":"/**\\n * mix control for the chorus effect\\n *\\n * @name chorus\\n * @param {string | Pattern} chorus mix amount between 0 and 1\\n * @example\\n * note(\\"d d a# a\\").s(\\"sawtooth\\").chorus(.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":548,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>mix control for the chorus effect</p>","name":"chorus","params":[{"type":{"names":["string","Pattern"]},"description":"<p>mix amount between 0 and 1</p>","name":"chorus"}],"examples":["note(\\"d d a# a\\").s(\\"sawtooth\\").chorus(.5)"],"longname":"chorus","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope decay time: the time it takes after the attack time to reach the sustain level.\\n * Note that the decay is only audible if the sustain value is lower than 1.\\n *\\n * @name decay\\n * @param {number | Pattern} time decay time in seconds\\n * @synonyms dec\\n * @example\\n * note(\\"c3 e3 f3 g3\\").decay(\\"<.1 .2 .3 .4>\\").sustain(0)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":564,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope decay time: the time it takes after the attack time to reach the sustain level.\\nNote that the decay is only audible if the sustain value is lower than 1.</p>","name":"decay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"synonyms_text":"dec","synonyms":["dec"],"examples":["note(\\"c3 e3 f3 g3\\").decay(\\"<.1 .2 .3 .4>\\").sustain(0)"],"longname":"decay","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope sustain level: The level which is reached after attack / decay, being sustained until the offset.\\n *\\n * @name sustain\\n * @param {number | Pattern} gain sustain level between 0 and 1\\n * @synonyms sus\\n * @example\\n * note(\\"c3 e3 f3 g3\\").decay(.2).sustain(\\"<0 .1 .4 .6 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":576,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope sustain level: The level which is reached after attack / decay, being sustained until the offset.</p>","name":"sustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level between 0 and 1</p>","name":"gain"}],"synonyms_text":"sus","synonyms":["sus"],"examples":["note(\\"c3 e3 f3 g3\\").decay(.2).sustain(\\"<0 .1 .4 .6 1>\\")"],"longname":"sustain","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope release time: The time it takes after the offset to go from sustain level to zero.\\n *\\n * @name release\\n * @param {number | Pattern} time release time in seconds\\n * @synonyms rel\\n * @example\\n * note(\\"c3 e3 g3 c4\\").release(\\"<0 .1 .4 .6 1>/2\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":587,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope release time: The time it takes after the offset to go from sustain level to zero.</p>","name":"release","params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"synonyms_text":"rel","synonyms":["rel"],"examples":["note(\\"c3 e3 g3 c4\\").release(\\"<0 .1 .4 .6 1>/2\\")"],"longname":"release","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the center frequency of the **b**and-**p**ass **f**ilter. When using mininotation, you\\n * can also optionally supply the 'bpq' parameter separated by ':'.\\n *\\n * @name bpf\\n * @param {number | Pattern} frequency center frequency\\n * @synonyms bandf, bp\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").bpf(\\"<1000 2000 4000 8000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":600,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the center frequency of the <strong>b</strong>and-<strong>p</strong>ass <strong>f</strong>ilter. When using mininotation, you\\ncan also optionally supply the 'bpq' parameter separated by ':'.</p>","name":"bpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>center frequency</p>","name":"frequency"}],"synonyms_text":"bandf, bp","synonyms":["bandf","bp"],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").bpf(\\"<1000 2000 4000 8000>\\")"],"longname":"bpf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the **b**and-**p**ass **q**-factor (resonance).\\n *\\n * @name bpq\\n * @param {number | Pattern} q q factor\\n * @synonyms bandq\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").bpf(500).bpq(\\"<0 1 2 3>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":613,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the <strong>b</strong>and-<strong>p</strong>ass <strong>q</strong>-factor (resonance).</p>","name":"bpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>q factor</p>","name":"q"}],"synonyms_text":"bandq","synonyms":["bandq"],"examples":["s(\\"bd sd [~ bd] sd\\").bpf(500).bpq(\\"<0 1 2 3>\\")"],"longname":"bpq","kind":"member","scope":"global"},{"comment":"/**\\n * A pattern of numbers from 0 to 1. Skips the beginning of each sample, e.g. \`0.25\` to cut off the first quarter from each sample.\\n *\\n * @memberof Pattern\\n * @name begin\\n * @param {number | Pattern} amount between 0 and 1, where 1 is the length of the sample\\n * @example\\n * samples({ rave: 'rave/AREUREADY.wav' }, 'github:tidalcycles/dirt-samples')\\n * s(\\"rave\\").begin(\\"<0 .25 .5 .75>\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":626,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A pattern of numbers from 0 to 1. Skips the beginning of each sample, e.g. <code>0.25</code> to cut off the first quarter from each sample.</p>","memberof":"Pattern","name":"begin","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"amount"}],"examples":["samples({ rave: 'rave/AREUREADY.wav' }, 'github:tidalcycles/dirt-samples')\\ns(\\"rave\\").begin(\\"<0 .25 .5 .75>\\").fast(2)"],"scope":"static","longname":"Pattern.begin","kind":"member"},{"comment":"/**\\n * The same as .begin, but cuts off the end off each sample.\\n *\\n * @memberof Pattern\\n * @name end\\n * @param {number | Pattern} length 1 = whole sample, .5 = half sample, .25 = quarter sample etc..\\n * @example\\n * s(\\"bd*2,oh*4\\").end(\\"<.1 .2 .5 1>\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The same as .begin, but cuts off the end off each sample.</p>","memberof":"Pattern","name":"end","params":[{"type":{"names":["number","Pattern"]},"description":"<p>1 = whole sample, .5 = half sample, .25 = quarter sample etc..</p>","name":"length"}],"examples":["s(\\"bd*2,oh*4\\").end(\\"<.1 .2 .5 1>\\").fast(2)"],"scope":"static","longname":"Pattern.end","kind":"member"},{"comment":"/**\\n * Loops the sample.\\n * Note that the tempo of the loop is not synced with the cycle tempo.\\n * To change the loop region, use loopBegin / loopEnd.\\n *\\n * @name loop\\n * @param {number | Pattern} on If 1, the sample is looped\\n * @example\\n * s(\\"casio\\").loop(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":649,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Loops the sample.\\nNote that the tempo of the loop is not synced with the cycle tempo.\\nTo change the loop region, use loopBegin / loopEnd.</p>","name":"loop","params":[{"type":{"names":["number","Pattern"]},"description":"<p>If 1, the sample is looped</p>","name":"on"}],"examples":["s(\\"casio\\").loop(1)"],"longname":"loop","kind":"member","scope":"global"},{"comment":"/**\\n * Begin to loop at a specific point in the sample (inbetween \`begin\` and \`end\`).\\n * Note that the loop point must be inbetween \`begin\` and \`end\`, and before \`loopEnd\`!\\n * Note: Samples starting with wt_ will automatically loop! (wt = wavetable)\\n *\\n * @name loopBegin\\n * @param {number | Pattern} time between 0 and 1, where 1 is the length of the sample\\n * @synonyms loopb\\n * @example\\n * s(\\"space\\").loop(1)\\n * .loopBegin(\\"<0 .125 .25>\\")._scope()\\n */","meta":{"filename":"controls.mjs","lineno":661,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Begin to loop at a specific point in the sample (inbetween <code>begin</code> and <code>end</code>).\\nNote that the loop point must be inbetween <code>begin</code> and <code>end</code>, and before <code>loopEnd</code>!\\nNote: Samples starting with wt_ will automatically loop! (wt = wavetable)</p>","name":"loopBegin","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"time"}],"synonyms_text":"loopb","synonyms":["loopb"],"examples":["s(\\"space\\").loop(1)\\n.loopBegin(\\"<0 .125 .25>\\")._scope()"],"longname":"loopBegin","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * End the looping section at a specific point in the sample (inbetween \`begin\` and \`end\`).\\n * Note that the loop point must be inbetween \`begin\` and \`end\`, and after \`loopBegin\`!\\n *\\n * @name loopEnd\\n * @param {number | Pattern} time between 0 and 1, where 1 is the length of the sample\\n * @synonyms loope\\n * @example\\n * s(\\"space\\").loop(1)\\n * .loopEnd(\\"<1 .75 .5 .25>\\")._scope()\\n */","meta":{"filename":"controls.mjs","lineno":674,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>End the looping section at a specific point in the sample (inbetween <code>begin</code> and <code>end</code>).\\nNote that the loop point must be inbetween <code>begin</code> and <code>end</code>, and after <code>loopBegin</code>!</p>","name":"loopEnd","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"time"}],"synonyms_text":"loope","synonyms":["loope"],"examples":["s(\\"space\\").loop(1)\\n.loopEnd(\\"<1 .75 .5 .25>\\")._scope()"],"longname":"loopEnd","kind":"member","scope":"global"},{"comment":"/**\\n * Bit crusher effect.\\n *\\n * @name crush\\n * @param {number | Pattern} depth between 1 (for drastic reduction in bit-depth) to 16 (for barely no reduction).\\n * @example\\n * s(\\"<bd sd>,hh*3\\").fast(2).crush(\\"<16 8 7 6 5 4 3 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":687,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Bit crusher effect.</p>","name":"crush","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 1 (for drastic reduction in bit-depth) to 16 (for barely no reduction).</p>","name":"depth"}],"examples":["s(\\"<bd sd>,hh*3\\").fast(2).crush(\\"<16 8 7 6 5 4 3 2>\\")"],"longname":"crush","kind":"member","scope":"global"},{"comment":"/**\\n * Fake-resampling for lowering the sample rate. Caution: This effect seems to only work in chromium based browsers\\n *\\n * @name coarse\\n * @param {number | Pattern} factor 1 for original 2 for half, 3 for a third and so on.\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").coarse(\\"<1 4 8 16 32>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":698,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Fake-resampling for lowering the sample rate. Caution: This effect seems to only work in chromium based browsers</p>","name":"coarse","params":[{"type":{"names":["number","Pattern"]},"description":"<p>1 for original 2 for half, 3 for a third and so on.</p>","name":"factor"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").coarse(\\"<1 4 8 16 32>\\")"],"longname":"coarse","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of a sound with a continuous waveform\\n *\\n * @name tremolo\\n * @synonyms trem\\n * @param {number | Pattern} speed modulation speed in HZ\\n * @example\\n * note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolo(\\"<3 2 100> \\").tremoloskew(\\"<.5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":709,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of a sound with a continuous waveform</p>","name":"tremolo","synonyms_text":"trem","synonyms":["trem"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation speed in HZ</p>","name":"speed"}],"examples":["note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolo(\\"<3 2 100> \\").tremoloskew(\\"<.5>\\")"],"longname":"tremolo","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of a sound with a continuous waveform\\n *\\n * @name tremolosync\\n * @synonyms tremsync\\n * @param {number | Pattern} cycles modulation speed in cycles\\n * @example\\n * note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolosync(\\"4\\").tremoloskew(\\"<1 .5 0>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":721,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of a sound with a continuous waveform</p>","name":"tremolosync","synonyms_text":"tremsync","synonyms":["tremsync"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation speed in cycles</p>","name":"cycles"}],"examples":["note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolosync(\\"4\\").tremoloskew(\\"<1 .5 0>\\")"],"longname":"tremolosync","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of amplitude modulation\\n *\\n * @name tremolodepth\\n * @synonyms tremdepth\\n * @param {number | Pattern} depth\\n * @example\\n * note(\\"a1 a1 a#1 a1\\".fast(4)).s(\\"pulse\\").tremsync(4).tremolodepth(\\"<1 2 .7>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":736,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of amplitude modulation</p>","name":"tremolodepth","synonyms_text":"tremdepth","synonyms":["tremdepth"],"params":[{"type":{"names":["number","Pattern"]},"name":"depth"}],"examples":["note(\\"a1 a1 a#1 a1\\".fast(4)).s(\\"pulse\\").tremsync(4).tremolodepth(\\"<1 2 .7>\\")"],"longname":"tremolodepth","kind":"member","scope":"global"},{"comment":"/**\\n * Alter the shape of the modulation waveform\\n *\\n * @name tremoloskew\\n * @synonyms tremskew\\n * @param {number | Pattern} amount between 0 & 1, the shape of the waveform\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremoloskew(\\"<.5 0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":747,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Alter the shape of the modulation waveform</p>","name":"tremoloskew","synonyms_text":"tremskew","synonyms":["tremskew"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 &amp; 1, the shape of the waveform</p>","name":"amount"}],"examples":["note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremoloskew(\\"<.5 0 1>\\")"],"longname":"tremoloskew","kind":"member","scope":"global"},{"comment":"/**\\n * Alter the phase of the modulation waveform\\n *\\n * @name tremolophase\\n * @synonyms tremphase\\n * @param {number | Pattern} offset the offset in cycles of the modulation\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremolophase(\\"<0 .25 .66>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":759,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Alter the phase of the modulation waveform</p>","name":"tremolophase","synonyms_text":"tremphase","synonyms":["tremphase"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>the offset in cycles of the modulation</p>","name":"offset"}],"examples":["note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremolophase(\\"<0 .25 .66>\\")"],"longname":"tremolophase","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of amplitude modulation\\n *\\n * @name tremoloshape\\n * @synonyms tremshape\\n * @param {number | Pattern} shape tri | square | sine | saw | ramp\\n * @example\\n * note(\\"{f g c d}%16\\").tremsync(4).tremoloshape(\\"<sine tri square>\\").s(\\"sawtooth\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":771,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of amplitude modulation</p>","name":"tremoloshape","synonyms_text":"tremshape","synonyms":["tremshape"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>tri | square | sine | saw | ramp</p>","name":"shape"}],"examples":["note(\\"{f g c d}%16\\").tremsync(4).tremoloshape(\\"<sine tri square>\\").s(\\"sawtooth\\")"],"longname":"tremoloshape","kind":"member","scope":"global"},{"comment":"/**\\n * Filter overdrive for supported filter types\\n *\\n * @name drive\\n * @param {number | Pattern} amount\\n * @example\\n * note(\\"{f g g c d a a#}%16\\".sub(17)).s(\\"supersaw\\").lpenv(8).lpf(150).lpq(.8).ftype('ladder').drive(\\"<.5 4>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":782,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filter overdrive for supported filter types</p>","name":"drive","params":[{"type":{"names":["number","Pattern"]},"name":"amount"}],"examples":["note(\\"{f g g c d a a#}%16\\".sub(17)).s(\\"supersaw\\").lpenv(8).lpf(150).lpq(.8).ftype('ladder').drive(\\"<.5 4>\\")"],"longname":"drive","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of an orbit to create a \\"sidechain\\" like effect.\\n *\\n * Can be applied to multiple orbits with the ':' mininotation, e.g. \`duckorbit(\\"2:3\\")\`\\n *\\n * @name duckorbit\\n * @synonyms duck\\n * @param {number | Pattern} orbit target orbit\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(1)\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"hh*16\\").orbit(3)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":793,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of an orbit to create a &quot;sidechain&quot; like effect.</p>\\n<p>Can be applied to multiple orbits with the ':' mininotation, e.g. <code>duckorbit(&quot;2:3&quot;)</code></p>","name":"duckorbit","synonyms_text":"duck","synonyms":["duck"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>target orbit</p>","name":"orbit"}],"examples":["$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(1)","$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"hh*16\\").orbit(3)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(1)"],"longname":"duckorbit","kind":"member","scope":"global"},{"comment":"/**\\n * The amount of ducking applied to target orbit\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckdepth(\\"0.3:0.1\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckdepth\\n * @param {number | Pattern} depth depth of modulation from 0 to 1\\n * @example\\n * stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(\\"<1 .9 .6 0>\\"))\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"hh*16\\").orbit(3)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(\\"1:0.5\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":812,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The amount of ducking applied to target orbit</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckdepth(&quot;0.3:0.1&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation from 0 to 1</p>","name":"depth"}],"examples":["stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(\\"<1 .9 .6 0>\\"))","$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"hh*16\\").orbit(3)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(\\"1:0.5\\")"],"longname":"duckdepth","kind":"member","scope":"global"},{"comment":"/**\\n * The time required for the ducked signal(s) to reach their lowest volume.\\n * Can be used to prevent clicking or for creative rhythmic effects.\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckonset(\\"0:0.003\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckonset\\n * @synonyms duckons\\n *\\n * @param {number | Pattern} time The onset time in seconds\\n * @example\\n * // Clicks\\n * sound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\n * duckerWithClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0).postgain(0)\\n * @example\\n * // No clicks\\n * sound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\n * duckerWithoutClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0.01).postgain(0)\\n * @example\\n * // Rhythmic\\n * noise: s(\\"pink\\").distort(\\"2:1\\").orbit(4) // used rhythmically with 0.3 onset below\\n * hhat: s(\\"hh*16\\").orbit(7)\\n * ducker: s(\\"bd*4\\").bank(\\"tr909\\").duckorbit(\\"4:7\\").duckonset(\\"0.3:0.003\\").duckattack(0.25)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":830,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The time required for the ducked signal(s) to reach their lowest volume.\\nCan be used to prevent clicking or for creative rhythmic effects.</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckonset(&quot;0:0.003&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckonset","synonyms_text":"duckons","synonyms":["duckons"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>The onset time in seconds</p>","name":"time"}],"examples":["// Clicks\\nsound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\nduckerWithClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0).postgain(0)","// No clicks\\nsound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\nduckerWithoutClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0.01).postgain(0)","// Rhythmic\\nnoise: s(\\"pink\\").distort(\\"2:1\\").orbit(4) // used rhythmically with 0.3 onset below\\nhhat: s(\\"hh*16\\").orbit(7)\\nducker: s(\\"bd*4\\").bank(\\"tr909\\").duckorbit(\\"4:7\\").duckonset(\\"0.3:0.003\\").duckattack(0.25)"],"longname":"duckonset","kind":"member","scope":"global"},{"comment":"/**\\n * The time required for the ducked signal(s) to return to their normal volume.\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckonset(\\"0:0.003\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckattack\\n * @synonyms duckatt\\n *\\n * @param {number | Pattern} time The attack time in seconds\\n * @example\\n * sound: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * ducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(\\"<0.2 0 0.4>\\").duckdepth(1)\\n * @example\\n * moreduck: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * lessduck: s(\\"hh*16\\").orbit(5)\\n * ducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:5\\").duckattack(\\"0.4:0.1\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":858,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The time required for the ducked signal(s) to return to their normal volume.</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckonset(&quot;0:0.003&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckattack","synonyms_text":"duckatt","synonyms":["duckatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>The attack time in seconds</p>","name":"time"}],"examples":["sound: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\nducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(\\"<0.2 0 0.4>\\").duckdepth(1)","moreduck: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\nlessduck: s(\\"hh*16\\").orbit(5)\\nducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:5\\").duckattack(\\"0.4:0.1\\")"],"longname":"duckattack","kind":"member","scope":"global"},{"comment":"/**\\n * Create byte beats with custom expressions\\n *\\n * @name byteBeatExpression\\n * @synonyms bbexpr\\n *\\n * @param {number | Pattern} byteBeatExpression bitwise expression for creating bytebeat\\n * @example\\n * s(\\"bytebeat\\").bbexpr('t*(t>>15^t>>66)')\\n *\\n */","meta":{"filename":"controls.mjs","lineno":879,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Create byte beats with custom expressions</p>","name":"byteBeatExpression","synonyms_text":"bbexpr","synonyms":["bbexpr"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>bitwise expression for creating bytebeat</p>","name":"byteBeatExpression"}],"examples":["s(\\"bytebeat\\").bbexpr('t*(t>>15^t>>66)')"],"longname":"byteBeatExpression","kind":"member","scope":"global"},{"comment":"/**\\n * Create byte beats with custom expressions\\n *\\n * @name byteBeatStartTime\\n * @synonyms bbst\\n *\\n * @param {number | Pattern} byteBeatStartTime in samples (t)\\n * @example\\n * note(\\"c3!8\\".add(\\"{0 0 12 0 7 5 3}%8\\")).s(\\"bytebeat:5\\").bbst(\\"<3 1>\\".mul(10000))._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":892,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Create byte beats with custom expressions</p>","name":"byteBeatStartTime","synonyms_text":"bbst","synonyms":["bbst"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>in samples (t)</p>","name":"byteBeatStartTime"}],"examples":["note(\\"c3!8\\".add(\\"{0 0 12 0 7 5 3}%8\\")).s(\\"bytebeat:5\\").bbst(\\"<3 1>\\".mul(10000))._scope()"],"longname":"byteBeatStartTime","kind":"member","scope":"global"},{"comment":"/**\\n * Allows you to set the output channels on the interface\\n *\\n * @name channels\\n * @synonyms ch\\n *\\n * @param {number | Pattern} channels pattern the output channels\\n * @example\\n * note(\\"e a d b g\\").channels(\\"3:4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":905,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows you to set the output channels on the interface</p>","name":"channels","synonyms_text":"ch","synonyms":["ch"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>pattern the output channels</p>","name":"channels"}],"examples":["note(\\"e a d b g\\").channels(\\"3:4\\")"],"longname":"channels","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the pulsewidth of the pulse oscillator\\n *\\n * @name pw\\n * @param {number | Pattern} pulsewidth\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"pulse\\").pw(\\".8:1:.2\\")\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0 .75 .5 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":918,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the pulsewidth of the pulse oscillator</p>","name":"pw","params":[{"type":{"names":["number","Pattern"]},"name":"pulsewidth"}],"examples":["note(\\"{f a c e}%16\\").s(\\"pulse\\").pw(\\".8:1:.2\\")","n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0 .75 .5 1\\")"],"longname":"pw","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the lfo rate for the pulsewidth of the pulse oscillator\\n *\\n * @name pwrate\\n * @param {number | Pattern} rate\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")\\n\\n *\\n */","meta":{"filename":"controls.mjs","lineno":930,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the lfo rate for the pulsewidth of the pulse oscillator</p>","name":"pwrate","params":[{"type":{"names":["number","Pattern"]},"name":"rate"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")"],"longname":"pwrate","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the lfo sweep for the pulsewidth of the pulse oscillator\\n *\\n * @name pwsweep\\n * @param {number | Pattern} sweep\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":942,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the lfo sweep for the pulsewidth of the pulse oscillator</p>","name":"pwsweep","params":[{"type":{"names":["number","Pattern"]},"name":"sweep"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")"],"longname":"pwsweep","kind":"member","scope":"global"},{"comment":"/**\\n * Phaser audio effect that approximates popular guitar pedals.\\n *\\n * @name phaser\\n * @synonyms ph\\n * @param {number | Pattern} speed speed of modulation\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(\\"<1 2 4 8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":953,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Phaser audio effect that approximates popular guitar pedals.</p>","name":"phaser","synonyms_text":"ph","synonyms":["ph"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>speed of modulation</p>","name":"speed"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(\\"<1 2 4 8>\\")"],"longname":"phaser","kind":"member","scope":"global"},{"comment":"/**\\n * The frequency sweep range of the lfo for the phaser effect. Defaults to 2000\\n *\\n * @name phasersweep\\n * @synonyms phs\\n * @param {number | Pattern} phasersweep most useful values are between 0 and 4000\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phasersweep(\\"<800 2000 4000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":970,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The frequency sweep range of the lfo for the phaser effect. Defaults to 2000</p>","name":"phasersweep","synonyms_text":"phs","synonyms":["phs"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>most useful values are between 0 and 4000</p>","name":"phasersweep"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phasersweep(\\"<800 2000 4000>\\")"],"longname":"phasersweep","kind":"member","scope":"global"},{"comment":"/**\\n * The center frequency of the phaser in HZ. Defaults to 1000\\n *\\n * @name phasercenter\\n * @synonyms phc\\n * @param {number | Pattern} centerfrequency in HZ\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phasercenter(\\"<800 2000 4000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":983,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The center frequency of the phaser in HZ. Defaults to 1000</p>","name":"phasercenter","synonyms_text":"phc","synonyms":["phc"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>in HZ</p>","name":"centerfrequency"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phasercenter(\\"<800 2000 4000>\\")"],"longname":"phasercenter","kind":"member","scope":"global"},{"comment":"/**\\n * The amount the signal is affected by the phaser effect. Defaults to 0.75\\n *\\n * @name phaserdepth\\n * @synonyms phd, phasdp\\n * @param {number | Pattern} depth number between 0 and 1\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phaserdepth(\\"<0 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":997,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The amount the signal is affected by the phaser effect. Defaults to 0.75</p>","name":"phaserdepth","synonyms_text":"phd, phasdp","synonyms":["phd","phasdp"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>number between 0 and 1</p>","name":"depth"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phaserdepth(\\"<0 .5 .75 1>\\")"],"longname":"phaserdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Choose the channel the pattern is sent to in superdirt\\n *\\n * @name channel\\n * @param {number | Pattern} channel channel number\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1011,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Choose the channel the pattern is sent to in superdirt</p>","name":"channel","params":[{"type":{"names":["number","Pattern"]},"description":"<p>channel number</p>","name":"channel"}],"longname":"channel","kind":"member","scope":"global"},{"comment":"/**\\n * In the style of classic drum-machines, \`cut\` will stop a playing sample as soon as another samples with in same cutgroup is to be played. An example would be an open hi-hat followed by a closed one, essentially muting the open.\\n *\\n * @name cut\\n * @param {number | Pattern} group cut group number\\n * @example\\n * s(\\"[oh hh]*4\\").cut(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1019,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>In the style of classic drum-machines, <code>cut</code> will stop a playing sample as soon as another samples with in same cutgroup is to be played. An example would be an open hi-hat followed by a closed one, essentially muting the open.</p>","name":"cut","params":[{"type":{"names":["number","Pattern"]},"description":"<p>cut group number</p>","name":"group"}],"examples":["s(\\"[oh hh]*4\\").cut(1)"],"longname":"cut","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the cutoff frequency of the **l**ow-**p**ass **f**ilter.\\n *\\n * When using mininotation, you can also optionally add the 'lpq' parameter, separated by ':'.\\n *\\n * @name lpf\\n * @param {number | Pattern} frequency audible between 0 and 20000\\n * @synonyms cutoff, ctf, lp\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").lpf(\\"<4000 2000 1000 500 200 100>\\")\\n * @example\\n * s(\\"bd*16\\").lpf(\\"1000:0 1000:10 1000:20 1000:30\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1029,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the cutoff frequency of the <strong>l</strong>ow-<strong>p</strong>ass <strong>f</strong>ilter.</p>\\n<p>When using mininotation, you can also optionally add the 'lpq' parameter, separated by ':'.</p>","name":"lpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>audible between 0 and 20000</p>","name":"frequency"}],"synonyms_text":"cutoff, ctf, lp","synonyms":["cutoff","ctf","lp"],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").lpf(\\"<4000 2000 1000 500 200 100>\\")","s(\\"bd*16\\").lpf(\\"1000:0 1000:10 1000:20 1000:30\\")"],"longname":"lpf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the lowpass filter envelope modulation depth.\\n * @name lpenv\\n * @param {number | Pattern} modulation depth of the lowpass filter envelope between 0 and _n_\\n * @synonyms lpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpa(.5)\\n * .lpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1045,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the lowpass filter envelope modulation depth.</p>","name":"lpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the lowpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"lpe","synonyms":["lpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpa(.5)\\n.lpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"lpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the highpass filter envelope modulation depth.\\n * @name hpenv\\n * @param {number | Pattern} modulation depth of the highpass filter envelope between 0 and _n_\\n * @synonyms hpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpa(.5)\\n * .hpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1058,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the highpass filter envelope modulation depth.</p>","name":"hpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the highpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"hpe","synonyms":["hpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpa(.5)\\n.hpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"hpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the bandpass filter envelope modulation depth.\\n * @name bpenv\\n * @param {number | Pattern} modulation depth of the bandpass filter envelope between 0 and _n_\\n * @synonyms bpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpa(.5)\\n * .bpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1071,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the bandpass filter envelope modulation depth.</p>","name":"bpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the bandpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"bpe","synonyms":["bpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpa(.5)\\n.bpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"bpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the lowpass filter envelope.\\n * @name lpattack\\n * @param {number | Pattern} attack time of the filter envelope\\n * @synonyms lpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpa(\\"<.5 .25 .1 .01>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1084,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the lowpass filter envelope.</p>","name":"lpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"attack"}],"synonyms_text":"lpa","synonyms":["lpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpa(\\"<.5 .25 .1 .01>/4\\")\\n.lpenv(4)"],"longname":"lpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the highpass filter envelope.\\n * @name hpattack\\n * @param {number | Pattern} attack time of the highpass filter envelope\\n * @synonyms hpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpa(\\"<.5 .25 .1 .01>/4\\")\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1097,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the highpass filter envelope.</p>","name":"hpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"attack"}],"synonyms_text":"hpa","synonyms":["hpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpa(\\"<.5 .25 .1 .01>/4\\")\\n.hpenv(4)"],"longname":"hpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the bandpass filter envelope.\\n * @name bpattack\\n * @param {number | Pattern} attack time of the bandpass filter envelope\\n * @synonyms bpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpa(\\"<.5 .25 .1 .01>/4\\")\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1110,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the bandpass filter envelope.</p>","name":"bpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"attack"}],"synonyms_text":"bpa","synonyms":["bpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpa(\\"<.5 .25 .1 .01>/4\\")\\n.bpenv(4)"],"longname":"bpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the lowpass filter envelope.\\n * @name lpdecay\\n * @param {number | Pattern} decay time of the filter envelope\\n * @synonyms lpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpd(\\"<.5 .25 .1 0>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1123,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the lowpass filter envelope.</p>","name":"lpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"decay"}],"synonyms_text":"lpd","synonyms":["lpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpd(\\"<.5 .25 .1 0>/4\\")\\n.lpenv(4)"],"longname":"lpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the highpass filter envelope.\\n * @name hpdecay\\n * @param {number | Pattern} decay time of the highpass filter envelope\\n * @synonyms hpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpd(\\"<.5 .25 .1 0>/4\\")\\n * .hps(0.2)\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1136,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the highpass filter envelope.</p>","name":"hpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"decay"}],"synonyms_text":"hpd","synonyms":["hpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpd(\\"<.5 .25 .1 0>/4\\")\\n.hps(0.2)\\n.hpenv(4)"],"longname":"hpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the bandpass filter envelope.\\n * @name bpdecay\\n * @param {number | Pattern} decay time of the bandpass filter envelope\\n * @synonyms bpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpd(\\"<.5 .25 .1 0>/4\\")\\n * .bps(0.2)\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1150,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the bandpass filter envelope.</p>","name":"bpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"decay"}],"synonyms_text":"bpd","synonyms":["bpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpd(\\"<.5 .25 .1 0>/4\\")\\n.bps(0.2)\\n.bpenv(4)"],"longname":"bpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the lowpass filter envelope.\\n * @name lpsustain\\n * @param {number | Pattern} sustain amplitude of the lowpass filter envelope\\n * @synonyms lps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpd(.5)\\n * .lps(\\"<0 .25 .5 1>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1164,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the lowpass filter envelope.</p>","name":"lpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the lowpass filter envelope</p>","name":"sustain"}],"synonyms_text":"lps","synonyms":["lps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpd(.5)\\n.lps(\\"<0 .25 .5 1>/4\\")\\n.lpenv(4)"],"longname":"lpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the highpass filter envelope.\\n * @name hpsustain\\n * @param {number | Pattern} sustain amplitude of the highpass filter envelope\\n * @synonyms hps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpd(.5)\\n * .hps(\\"<0 .25 .5 1>/4\\")\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1178,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the highpass filter envelope.</p>","name":"hpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the highpass filter envelope</p>","name":"sustain"}],"synonyms_text":"hps","synonyms":["hps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpd(.5)\\n.hps(\\"<0 .25 .5 1>/4\\")\\n.hpenv(4)"],"longname":"hpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the bandpass filter envelope.\\n * @name bpsustain\\n * @param {number | Pattern} sustain amplitude of the bandpass filter envelope\\n * @synonyms bps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpd(.5)\\n * .bps(\\"<0 .25 .5 1>/4\\")\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1192,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the bandpass filter envelope.</p>","name":"bpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the bandpass filter envelope</p>","name":"sustain"}],"synonyms_text":"bps","synonyms":["bps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpd(.5)\\n.bps(\\"<0 .25 .5 1>/4\\")\\n.bpenv(4)"],"longname":"bpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the lowpass filter envelope.\\n * @name lprelease\\n * @param {number | Pattern} release time of the filter envelope\\n * @synonyms lpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .lpf(300)\\n * .lpenv(4)\\n * .lpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1206,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the lowpass filter envelope.</p>","name":"lprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"release"}],"synonyms_text":"lpr","synonyms":["lpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.lpf(300)\\n.lpenv(4)\\n.lpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"lprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the highpass filter envelope.\\n * @name hprelease\\n * @param {number | Pattern} release time of the highpass filter envelope\\n * @synonyms hpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .hpf(500)\\n * .hpenv(4)\\n * .hpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1221,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the highpass filter envelope.</p>","name":"hprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"release"}],"synonyms_text":"hpr","synonyms":["hpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.hpf(500)\\n.hpenv(4)\\n.hpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"hprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the bandpass filter envelope.\\n * @name bprelease\\n * @param {number | Pattern} release time of the bandpass filter envelope\\n * @synonyms bpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .bpf(500)\\n * .bpenv(4)\\n * .bpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1236,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the bandpass filter envelope.</p>","name":"bprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"release"}],"synonyms_text":"bpr","synonyms":["bpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.bpf(500)\\n.bpenv(4)\\n.bpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"bprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the filter type. The ladder filter is more aggressive. More types might be added in the future.\\n * @name ftype\\n * @param {number | Pattern} type 12db (0), ladder (1), or 24db (2)\\n * @example\\n * note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpenv(4).lpf(500).ftype(\\"<0 1 2>\\").lpq(1)\\n * @example\\n * note(\\"c f g g a c d4\\").fast(2)\\n * .sound('sawtooth')\\n * .lpf(200).fanchor(0)\\n * .lpenv(3).lpq(1)\\n * .ftype(\\"<ladder 12db 24db>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1251,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the filter type. The ladder filter is more aggressive. More types might be added in the future.</p>","name":"ftype","params":[{"type":{"names":["number","Pattern"]},"description":"<p>12db (0), ladder (1), or 24db (2)</p>","name":"type"}],"examples":["note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpenv(4).lpf(500).ftype(\\"<0 1 2>\\").lpq(1)","note(\\"c f g g a c d4\\").fast(2)\\n.sound('sawtooth')\\n.lpf(200).fanchor(0)\\n.lpenv(3).lpq(1)\\n.ftype(\\"<ladder 12db 24db>\\")"],"longname":"ftype","kind":"member","scope":"global"},{"comment":"/**\\n * controls the center of the filter envelope. 0 is unipolar positive, .5 is bipolar, 1 is unipolar negative\\n * @name fanchor\\n * @param {number | Pattern} center 0 to 1\\n * @example\\n * note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpf(\\"{1000}%2\\")\\n * .lpenv(8).fanchor(\\"<0 .5 1>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1266,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>controls the center of the filter envelope. 0 is unipolar positive, .5 is bipolar, 1 is unipolar negative</p>","name":"fanchor","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 to 1</p>","name":"center"}],"examples":["note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpf(\\"{1000}%2\\")\\n.lpenv(8).fanchor(\\"<0 .5 1>\\")"],"longname":"fanchor","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the cutoff frequency of the **h**igh-**p**ass **f**ilter.\\n *\\n * When using mininotation, you can also optionally add the 'hpq' parameter, separated by ':'.\\n *\\n * @name hpf\\n * @param {number | Pattern} frequency audible between 0 and 20000\\n * @synonyms hp, hcutoff\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<4000 2000 1000 500 200 100>\\")\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<2000 2000:25>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1275,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the cutoff frequency of the <strong>h</strong>igh-<strong>p</strong>ass <strong>f</strong>ilter.</p>\\n<p>When using mininotation, you can also optionally add the 'hpq' parameter, separated by ':'.</p>","name":"hpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>audible between 0 and 20000</p>","name":"frequency"}],"synonyms_text":"hp, hcutoff","synonyms":["hp","hcutoff"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<4000 2000 1000 500 200 100>\\")","s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<2000 2000:25>\\")"],"longname":"hpf","kind":"member","scope":"global"},{"comment":"/**\\n * Applies a vibrato to the frequency of the oscillator.\\n *\\n * @name vib\\n * @synonyms vibrato, v\\n * @param {number | Pattern} frequency of the vibrato in hertz\\n * @example\\n * note(\\"a e\\")\\n * .vib(\\"<.5 1 2 4 8 16>\\")\\n * ._scope()\\n * @example\\n * // change the modulation depth with \\":\\"\\n * note(\\"a e\\")\\n * .vib(\\"<.5 1 2 4 8 16>:12\\")\\n * ._scope()\\n */","meta":{"filename":"controls.mjs","lineno":1291,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies a vibrato to the frequency of the oscillator.</p>","name":"vib","synonyms_text":"vibrato, v","synonyms":["vibrato","v"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>of the vibrato in hertz</p>","name":"frequency"}],"examples":["note(\\"a e\\")\\n.vib(\\"<.5 1 2 4 8 16>\\")\\n._scope()","// change the modulation depth with \\":\\"\\nnote(\\"a e\\")\\n.vib(\\"<.5 1 2 4 8 16>:12\\")\\n._scope()"],"longname":"vib","kind":"member","scope":"global"},{"comment":"/**\\n * Adds pink noise to the mix\\n *\\n * @name noise\\n * @param {number | Pattern} wet wet amount\\n * @example\\n * sound(\\"<white pink brown>/2\\")\\n */","meta":{"filename":"controls.mjs","lineno":1308,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Adds pink noise to the mix</p>","name":"noise","params":[{"type":{"names":["number","Pattern"]},"description":"<p>wet amount</p>","name":"wet"}],"examples":["sound(\\"<white pink brown>/2\\")"],"longname":"noise","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the vibrato depth in semitones. Only has an effect if \`vibrato\` | \`vib\` | \`v\` is is also set\\n *\\n * @name vibmod\\n * @synonyms vmod\\n * @param {number | Pattern} depth of vibrato (in semitones)\\n * @example\\n * note(\\"a e\\").vib(4)\\n * .vibmod(\\"<.25 .5 1 2 12>\\")\\n * ._scope()\\n * @example\\n * // change the vibrato frequency with \\":\\"\\n * note(\\"a e\\")\\n * .vibmod(\\"<.25 .5 1 2 12>:8\\")\\n * ._scope()\\n */","meta":{"filename":"controls.mjs","lineno":1317,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the vibrato depth in semitones. Only has an effect if <code>vibrato</code> | <code>vib</code> | <code>v</code> is is also set</p>","name":"vibmod","synonyms_text":"vmod","synonyms":["vmod"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>of vibrato (in semitones)</p>","name":"depth"}],"examples":["note(\\"a e\\").vib(4)\\n.vibmod(\\"<.25 .5 1 2 12>\\")\\n._scope()","// change the vibrato frequency with \\":\\"\\nnote(\\"a e\\")\\n.vibmod(\\"<.25 .5 1 2 12>:8\\")\\n._scope()"],"longname":"vibmod","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the **h**igh-**p**ass **q**-value.\\n *\\n * @name hpq\\n * @param {number | Pattern} q resonance factor between 0 and 50\\n * @synonyms hresonance\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(2000).hpq(\\"<0 10 20 30>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1335,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the <strong>h</strong>igh-<strong>p</strong>ass <strong>q</strong>-value.</p>","name":"hpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>resonance factor between 0 and 50</p>","name":"q"}],"synonyms_text":"hresonance","synonyms":["hresonance"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").hpf(2000).hpq(\\"<0 10 20 30>\\")"],"longname":"hpq","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the **l**ow-**p**ass **q**-value.\\n *\\n * @name lpq\\n * @param {number | Pattern} q resonance factor between 0 and 50\\n * @synonyms resonance\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").lpf(2000).lpq(\\"<0 10 20 30>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1346,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the <strong>l</strong>ow-<strong>p</strong>ass <strong>q</strong>-value.</p>","name":"lpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>resonance factor between 0 and 50</p>","name":"q"}],"synonyms_text":"resonance","synonyms":["resonance"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").lpf(2000).lpq(\\"<0 10 20 30>\\")"],"longname":"lpq","kind":"member","scope":"global"},{"comment":"/**\\n * DJ filter, below 0.5 is low pass filter, above is high pass filter.\\n *\\n * @name djf\\n * @param {number | Pattern} cutoff below 0.5 is low pass filter, above is high pass filter\\n * @example\\n * n(irand(16).seg(8)).scale(\\"d:phrygian\\").s(\\"supersaw\\").djf(\\"<.5 .3 .2 .75>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1358,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DJ filter, below 0.5 is low pass filter, above is high pass filter.</p>","name":"djf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>below 0.5 is low pass filter, above is high pass filter</p>","name":"cutoff"}],"examples":["n(irand(16).seg(8)).scale(\\"d:phrygian\\").s(\\"supersaw\\").djf(\\"<.5 .3 .2 .75>\\")"],"longname":"djf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the delay signal.\\n *\\n * When using mininotation, you can also optionally add the 'delaytime' and 'delayfeedback' parameter,\\n * separated by ':'.\\n *\\n *\\n * @name delay\\n * @param {number | Pattern} level between 0 and 1\\n * @example\\n * s(\\"bd bd\\").delay(\\"<0 .25 .5 1>\\")\\n * @example\\n * s(\\"bd bd\\").delay(\\"0.65:0.25:0.9 0.65:0.125:0.7\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1370,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the delay signal.</p>\\n<p>When using mininotation, you can also optionally add the 'delaytime' and 'delayfeedback' parameter,\\nseparated by ':'.</p>","name":"delay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"level"}],"examples":["s(\\"bd bd\\").delay(\\"<0 .25 .5 1>\\")","s(\\"bd bd\\").delay(\\"0.65:0.25:0.9 0.65:0.125:0.7\\")"],"longname":"delay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the signal that is fed back into the delay.\\n * Caution: Values >= 1 will result in a signal that gets louder and louder! Don't do it\\n *\\n * @name delayfeedback\\n * @param {number | Pattern} feedback between 0 and 1\\n * @synonyms delayfb, dfb\\n * @example\\n * s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the signal that is fed back into the delay.\\nCaution: Values &gt;= 1 will result in a signal that gets louder and louder! Don't do it</p>","name":"delayfeedback","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"feedback"}],"synonyms_text":"delayfb, dfb","synonyms":["delayfb","dfb"],"examples":["s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")"],"longname":"delayfeedback","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the signal that is fed back into the delay.\\n * Caution: Values >= 1 will result in a signal that gets louder and louder! Don't do it\\n *\\n * @name delayfeedback\\n * @param {number | Pattern} feedback between 0 and 1\\n * @synonyms delayfb, dfb\\n * @example\\n * s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1399,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the signal that is fed back into the delay.\\nCaution: Values &gt;= 1 will result in a signal that gets louder and louder! Don't do it</p>","name":"delayfeedback","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"feedback"}],"synonyms_text":"delayfb, dfb","synonyms":["delayfb","dfb"],"examples":["s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")"],"longname":"delayfeedback","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the time of the delay effect.\\n *\\n * @name delayspeed\\n * @param {number | Pattern} delayspeed controls the pitch of the delay feedback\\n * @synonyms delayt, dt\\n * @example\\n * note(\\"d d a# a\\".fast(2)).s(\\"sawtooth\\").delay(.8).delaytime(1/2).delayspeed(\\"<2 .5 -1 -2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1411,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the time of the delay effect.</p>","name":"delayspeed","params":[{"type":{"names":["number","Pattern"]},"description":"<p>controls the pitch of the delay feedback</p>","name":"delayspeed"}],"synonyms_text":"delayt, dt","synonyms":["delayt","dt"],"examples":["note(\\"d d a# a\\".fast(2)).s(\\"sawtooth\\").delay(.8).delaytime(1/2).delayspeed(\\"<2 .5 -1 -2>\\")"],"longname":"delayspeed","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the time of the delay effect in cycles.\\n *\\n * @name delaysync\\n * @param {number | Pattern} cycles delay length in cycles\\n * @synonyms delayt, dt\\n * @example\\n * s(\\"bd bd\\").delay(.25).delaysync(\\"<1 2 3 5>\\".div(8))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1423,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the time of the delay effect in cycles.</p>","name":"delaysync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>delay length in cycles</p>","name":"cycles"}],"synonyms_text":"delayt, dt","synonyms":["delayt","dt"],"examples":["s(\\"bd bd\\").delay(.25).delaysync(\\"<1 2 3 5>\\".div(8))"],"longname":"delaysync","kind":"member","scope":"global"},{"comment":"/**\\n * Specifies whether delaytime is calculated relative to cps.\\n *\\n * @name lock\\n * @param {number | Pattern} enable When set to 1, delaytime is a direct multiple of a cycle.\\n * @superdirtOnly\\n * @example\\n * s(\\"sd\\").delay().lock(1).osc()\\n *\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1435,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Specifies whether delaytime is calculated relative to cps.</p>","name":"lock","params":[{"type":{"names":["number","Pattern"]},"description":"<p>When set to 1, delaytime is a direct multiple of a cycle.</p>","name":"enable"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"sd\\").delay().lock(1).osc()"],"longname":"lock","kind":"member","scope":"global"},{"comment":"/**\\n * Set detune for stacked voices of supported oscillators\\n *\\n * @name detune\\n * @param {number | Pattern} amount\\n * @synonyms det\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").detune(\\"<.1 .2 .5 24.1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set detune for stacked voices of supported oscillators</p>","name":"detune","params":[{"type":{"names":["number","Pattern"]},"name":"amount"}],"synonyms_text":"det","synonyms":["det"],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").detune(\\"<.1 .2 .5 24.1>\\")"],"longname":"detune","kind":"member","scope":"global"},{"comment":"/**\\n * Set number of stacked voices for supported oscillators\\n *\\n * @name unison\\n * @param {number | Pattern} numvoices\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").unison(\\"<1 2 7>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1459,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set number of stacked voices for supported oscillators</p>","name":"unison","params":[{"type":{"names":["number","Pattern"]},"name":"numvoices"}],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").unison(\\"<1 2 7>\\")"],"longname":"unison","kind":"member","scope":"global"},{"comment":"/**\\n * Set the stereo pan spread for supported oscillators\\n *\\n * @name spread\\n * @param {number | Pattern} spread between 0 and 1\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").spread(\\"<0 .3 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1470,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set the stereo pan spread for supported oscillators</p>","name":"spread","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"spread"}],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").spread(\\"<0 .3 1>\\")"],"longname":"spread","kind":"member","scope":"global"},{"comment":"/**\\n * Set dryness of reverb. See \`room\` and \`size\` for more information about reverb.\\n *\\n * @name dry\\n * @param {number | Pattern} dry 0 = wet, 1 = dry\\n * @example\\n * n(\\"[0,3,7](3,8)\\").s(\\"superpiano\\").room(.7).dry(\\"<0 .5 .75 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1480,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set dryness of reverb. See <code>room</code> and <code>size</code> for more information about reverb.</p>","name":"dry","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 = wet, 1 = dry</p>","name":"dry"}],"examples":["n(\\"[0,3,7](3,8)\\").s(\\"superpiano\\").room(.7).dry(\\"<0 .5 .75 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"dry","kind":"member","scope":"global"},{"comment":"/**\\n * Set frequency of sound.\\n *\\n * @name freq\\n * @param {number | Pattern} frequency in Hz. the audible range is between 20 and 20000 Hz\\n * @example\\n * freq(\\"220 110 440 110\\").s(\\"superzow\\").osc()\\n * @example\\n * freq(\\"110\\".mul.out(\\".5 1.5 .6 [2 3]\\")).s(\\"superzow\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1505,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set frequency of sound.</p>","name":"freq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>in Hz. the audible range is between 20 and 20000 Hz</p>","name":"frequency"}],"examples":["freq(\\"220 110 440 110\\").s(\\"superzow\\").osc()","freq(\\"110\\".mul.out(\\".5 1.5 .6 [2 3]\\")).s(\\"superzow\\").osc()"],"longname":"freq","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of pitch envelope.\\n *\\n * @name pattack\\n * @synonyms patt\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"c eb g bb\\").pattack(\\"0 .1 .25 .5\\").slow(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1518,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of pitch envelope.</p>","name":"pattack","synonyms_text":"patt","synonyms":["patt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"c eb g bb\\").pattack(\\"0 .1 .25 .5\\").slow(2)"],"longname":"pattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of pitch envelope.\\n *\\n * @name pdecay\\n * @synonyms pdec\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"<c eb g bb>\\").pdecay(\\"<0 .1 .25 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1529,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of pitch envelope.</p>","name":"pdecay","synonyms_text":"pdec","synonyms":["pdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"<c eb g bb>\\").pdecay(\\"<0 .1 .25 .5>\\")"],"longname":"pdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of pitch envelope\\n *\\n * @name prelease\\n * @synonyms prel\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"<c eb g bb> ~\\")\\n * .release(.5) // to hear the pitch release\\n * .prelease(\\"<0 .1 .25 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1542,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of pitch envelope</p>","name":"prelease","synonyms_text":"prel","synonyms":["prel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"<c eb g bb> ~\\")\\n.release(.5) // to hear the pitch release\\n.prelease(\\"<0 .1 .25 .5>\\")"],"longname":"prelease","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of pitch envelope. Negative values will flip the envelope.\\n * If you don't set other pitch envelope controls, \`pattack:.2\` will be the default.\\n *\\n * @name penv\\n * @param {number | Pattern} semitones change in semitones\\n * @example\\n * note(\\"c\\")\\n * .penv(\\"<12 7 1 .5 0 -1 -7 -12>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1555,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of pitch envelope. Negative values will flip the envelope.\\nIf you don't set other pitch envelope controls, <code>pattack:.2</code> will be the default.</p>","name":"penv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>change in semitones</p>","name":"semitones"}],"examples":["note(\\"c\\")\\n.penv(\\"<12 7 1 .5 0 -1 -7 -12>\\")"],"longname":"penv","kind":"member","scope":"global"},{"comment":"/**\\n * Curve of envelope. Defaults to linear. exponential is good for kicks\\n *\\n * @name pcurve\\n * @param {number | Pattern} type 0 = linear, 1 = exponential\\n * @example\\n * note(\\"g1*4\\")\\n * .s(\\"sine\\").pdec(.5)\\n * .penv(32)\\n * .pcurve(\\"<0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1567,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Curve of envelope. Defaults to linear. exponential is good for kicks</p>","name":"pcurve","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 = linear, 1 = exponential</p>","name":"type"}],"examples":["note(\\"g1*4\\")\\n.s(\\"sine\\").pdec(.5)\\n.penv(32)\\n.pcurve(\\"<0 1>\\")"],"longname":"pcurve","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the range anchor of the envelope:\\n * - anchor 0: range = [note, note + penv]\\n * - anchor 1: range = [note - penv, note]\\n * If you don't set an anchor, the value will default to the psustain value.\\n *\\n * @name panchor\\n * @param {number | Pattern} anchor anchor offset\\n * @example\\n * note(\\"c c4\\").penv(12).panchor(\\"<0 .5 1 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1580,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the range anchor of the envelope:</p>\\n<ul>\\n<li>anchor 0: range = [note, note + penv]</li>\\n<li>anchor 1: range = [note - penv, note]\\nIf you don't set an anchor, the value will default to the psustain value.</li>\\n</ul>","name":"panchor","params":[{"type":{"names":["number","Pattern"]},"description":"<p>anchor offset</p>","name":"anchor"}],"examples":["note(\\"c c4\\").penv(12).panchor(\\"<0 .5 1 .5>\\")"],"longname":"panchor","kind":"member","scope":"global"},{"comment":"/**\\n * Emulation of a Leslie speaker: speakers rotating in a wooden amplified cabinet.\\n *\\n * @name leslie\\n * @param {number | Pattern} wet between 0 and 1\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(\\"<0 .4 .6 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1604,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Emulation of a Leslie speaker: speakers rotating in a wooden amplified cabinet.</p>","name":"leslie","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"wet"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(\\"<0 .4 .6 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"leslie","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of modulation / rotation for leslie effect\\n *\\n * @name lrate\\n * @param {number | Pattern} rate 6.7 for fast, 0.7 for slow\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(\\"<1 2 4 8>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1615,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of modulation / rotation for leslie effect</p>","name":"lrate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>6.7 for fast, 0.7 for slow</p>","name":"rate"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(\\"<1 2 4 8>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"lrate","kind":"member","scope":"global"},{"comment":"/**\\n * Physical size of the cabinet in meters. Be careful, it might be slightly larger than your computer. Affects the Doppler amount (pitch warble)\\n *\\n * @name lsize\\n * @param {number | Pattern} meters somewhere between 0 and 1\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(2).lsize(\\"<.1 .5 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1627,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Physical size of the cabinet in meters. Be careful, it might be slightly larger than your computer. Affects the Doppler amount (pitch warble)</p>","name":"lsize","params":[{"type":{"names":["number","Pattern"]},"description":"<p>somewhere between 0 and 1</p>","name":"meters"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(2).lsize(\\"<.1 .5 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"lsize","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the displayed text for an event on the pianoroll\\n *\\n * @name label\\n * @param {string} label text to display\\n */","meta":{"filename":"controls.mjs","lineno":1638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the displayed text for an event on the pianoroll</p>","name":"label","params":[{"type":{"names":["string"]},"description":"<p>text to display</p>","name":"label"}],"longname":"label","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the default octave of a synth.\\n *\\n * @name octave\\n * @param {number | Pattern} octave octave number\\n * @example\\n * n(\\"0,4,7\\").s('supersquare').octave(\\"<3 4 5 6>\\").osc()\\n * @superDirtOnly\\n */","meta":{"filename":"controls.mjs","lineno":1674,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the default octave of a synth.</p>","name":"octave","params":[{"type":{"names":["number","Pattern"]},"description":"<p>octave number</p>","name":"octave"}],"examples":["n(\\"0,4,7\\").s('supersquare').octave(\\"<3 4 5 6>\\").osc()"],"tags":[{"originalTitle":"superDirtOnly","title":"superdirtonly","text":""}],"longname":"octave","kind":"member","scope":"global"},{"comment":"/**\\n * An \`orbit\` is a global parameter context for patterns. Patterns with the same orbit will share the same global effects.\\n *\\n * @name orbit\\n * @param {number | Pattern} number\\n * @example\\n * stack(\\n *   s(\\"hh*6\\").delay(.5).delaytime(.25).orbit(1),\\n *   s(\\"~ sd ~ sd\\").delay(.5).delaytime(.125).orbit(2)\\n * )\\n */","meta":{"filename":"controls.mjs","lineno":1687,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>An <code>orbit</code> is a global parameter context for patterns. Patterns with the same orbit will share the same global effects.</p>","name":"orbit","params":[{"type":{"names":["number","Pattern"]},"name":"number"}],"examples":["stack(\\n  s(\\"hh*6\\").delay(.5).delaytime(.25).orbit(1),\\n  s(\\"~ sd ~ sd\\").delay(.5).delaytime(.125).orbit(2)\\n)"],"longname":"orbit","kind":"member","scope":"global"},{"comment":"/**\\n * Sets position in stereo.\\n *\\n * @name pan\\n * @param {number | Pattern} pan between 0 and 1, from left to right (assuming stereo), once round a circle (assuming multichannel)\\n * @example\\n * s(\\"[bd hh]*2\\").pan(\\"<.5 1 .5 0>\\")\\n * @example\\n * s(\\"bd rim sd rim bd ~ cp rim\\").pan(sine.slow(2))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1703,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets position in stereo.</p>","name":"pan","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, from left to right (assuming stereo), once round a circle (assuming multichannel)</p>","name":"pan"}],"examples":["s(\\"[bd hh]*2\\").pan(\\"<.5 1 .5 0>\\")","s(\\"bd rim sd rim bd ~ cp rim\\").pan(sine.slow(2))"],"longname":"pan","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of reverb.\\n *\\n * When using mininotation, you can also optionally add the 'size' parameter, separated by ':'.\\n *\\n * @name room\\n * @param {number | Pattern} level between 0 and 1\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(\\"<0 .2 .4 .6 .8 1>\\")\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(\\"<0.9:1 0.9:4>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1766,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of reverb.</p>\\n<p>When using mininotation, you can also optionally add the 'size' parameter, separated by ':'.</p>","name":"room","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"level"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(\\"<0 .2 .4 .6 .8 1>\\")","s(\\"bd sd [~ bd] sd\\").room(\\"<0.9:1 0.9:4>\\")"],"longname":"room","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb lowpass starting frequency (in hertz).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomlp\\n * @synonyms rlp\\n * @param {number} frequency between 0 and 20000hz\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000)\\n */","meta":{"filename":"controls.mjs","lineno":1780,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb lowpass starting frequency (in hertz).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomlp","synonyms_text":"rlp","synonyms":["rlp"],"params":[{"type":{"names":["number"]},"description":"<p>between 0 and 20000hz</p>","name":"frequency"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000)"],"longname":"roomlp","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb lowpass frequency at -60dB (in hertz).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomdim\\n * @synonyms rdim\\n * @param {number} frequency between 0 and 20000hz\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rdim(8000)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rdim(400)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1793,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb lowpass frequency at -60dB (in hertz).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomdim","synonyms_text":"rdim","synonyms":["rdim"],"params":[{"type":{"names":["number"]},"description":"<p>between 0 and 20000hz</p>","name":"frequency"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rdim(8000)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rdim(400)"],"longname":"roomdim","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb fade time (in seconds).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomfade\\n * @synonyms rfade\\n * @param {number} seconds for the reverb to fade\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rfade(0.5)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rfade(4)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1807,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb fade time (in seconds).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomfade","synonyms_text":"rfade","synonyms":["rfade"],"params":[{"type":{"names":["number"]},"description":"<p>for the reverb to fade</p>","name":"seconds"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rfade(0.5)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rfade(4)"],"longname":"roomfade","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sample to use as an impulse response for the reverb.\\n * @name iresponse\\n * @param {string | Pattern} sample to use as an impulse response\\n * @synonyms ir\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).ir(\\"<shaker_large:0 shaker_large:2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1821,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sample to use as an impulse response for the reverb.</p>","name":"iresponse","params":[{"type":{"names":["string","Pattern"]},"description":"<p>to use as an impulse response</p>","name":"sample"}],"synonyms_text":"ir","synonyms":["ir"],"examples":["s(\\"bd sd [~ bd] sd\\").room(.8).ir(\\"<shaker_large:0 shaker_large:2>\\")"],"longname":"iresponse","kind":"member","scope":"global"},{"comment":"/**\\n * Sets speed of the sample for the impulse response.\\n * @name irspeed\\n * @param {string | Pattern} speed\\n * @example\\n * samples('github:switchangel/pad')\\n * $: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.2).irspeed(\\"<2 1 .5>/2\\").irbegin(.5).roomsize(.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets speed of the sample for the impulse response.</p>","name":"irspeed","params":[{"type":{"names":["string","Pattern"]},"name":"speed"}],"examples":["samples('github:switchangel/pad')\\n$: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.2).irspeed(\\"<2 1 .5>/2\\").irbegin(.5).roomsize(.5)"],"longname":"irspeed","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the beginning of the IR response sample\\n * @name irbegin\\n * @param {string | Pattern} begin between 0 and 1\\n * @synonyms ir\\n * @example\\n * samples('github:switchangel/pad')\\n * $: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.65).irspeed(\\"-2\\").irbegin(\\"<0 .5 .75>/2\\").roomsize(.6)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1843,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the beginning of the IR response sample</p>","name":"irbegin","params":[{"type":{"names":["string","Pattern"]},"description":"<p>between 0 and 1</p>","name":"begin"}],"synonyms_text":"ir","synonyms":["ir"],"examples":["samples('github:switchangel/pad')\\n$: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.65).irspeed(\\"-2\\").irbegin(\\"<0 .5 .75>/2\\").roomsize(.6)"],"longname":"irbegin","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the room size of the reverb, see \`room\`.\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomsize\\n * @param {number | Pattern} size between 0 and 10\\n * @synonyms rsize, sz, size\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).rsize(1)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).rsize(4)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1854,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the room size of the reverb, see <code>room</code>.\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomsize","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 10</p>","name":"size"}],"synonyms_text":"rsize, sz, size","synonyms":["rsize","sz","size"],"examples":["s(\\"bd sd [~ bd] sd\\").room(.8).rsize(1)","s(\\"bd sd [~ bd] sd\\").room(.8).rsize(4)"],"longname":"roomsize","kind":"member","scope":"global"},{"comment":"/**\\n * (Deprecated) Wave shaping distortion. WARNING: can suddenly get unpredictably loud.\\n * Please use distort instead, which has a more predictable response curve\\n * second option in optional array syntax (ex: \\".9:.5\\") applies a postgain to the output\\n *\\n *\\n * @name shape\\n * @param {number | Pattern} distortion between 0 and 1\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").shape(\\"<0 .2 .4 .6 .8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1875,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>(Deprecated) Wave shaping distortion. WARNING: can suddenly get unpredictably loud.\\nPlease use distort instead, which has a more predictable response curve\\nsecond option in optional array syntax (ex: &quot;.9:.5&quot;) applies a postgain to the output</p>","name":"shape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"distortion"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").shape(\\"<0 .2 .4 .6 .8>\\")"],"longname":"shape","kind":"member","scope":"global"},{"comment":"/**\\n * Wave shaping distortion. CAUTION: it can get loud.\\n * Second option in optional array syntax (ex: \\".9:.5\\") applies a postgain to the output. Third option sets the waveshaping type.\\n * Most useful values are usually between 0 and 10 (depending on source gain). If you are feeling adventurous, you can turn it up to 11 and beyond ;)\\n *\\n * @name distort\\n * @synonyms dist\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n * @param {number | string | Pattern} type type of distortion to apply\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").distort(\\"<0 2 3 10:.5>\\")\\n * @example\\n * note(\\"d1!8\\").s(\\"sine\\").penv(36).pdecay(.12).decay(.23).distort(\\"8:.4\\")\\n * @example\\n * s(\\"bd:4*4\\").bank(\\"tr808\\").distort(\\"3:0.5:diode\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1888,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wave shaping distortion. CAUTION: it can get loud.\\nSecond option in optional array syntax (ex: &quot;.9:.5&quot;) applies a postgain to the output. Third option sets the waveshaping type.\\nMost useful values are usually between 0 and 10 (depending on source gain). If you are feeling adventurous, you can turn it up to 11 and beyond ;)</p>","name":"distort","synonyms_text":"dist","synonyms":["dist"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"},{"type":{"names":["number","string","Pattern"]},"description":"<p>type of distortion to apply</p>","name":"type"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").distort(\\"<0 2 3 10:.5>\\")","note(\\"d1!8\\").s(\\"sine\\").penv(36).pdecay(.12).decay(.23).distort(\\"8:.4\\")","s(\\"bd:4*4\\").bank(\\"tr808\\").distort(\\"3:0.5:diode\\")"],"longname":"distort","kind":"member","scope":"global"},{"comment":"/**\\n * Postgain for waveshaping distortion.\\n *\\n * @name distortvol\\n * @synonyms distvol\\n * @param {number | Pattern} volume linear postgain of the distortion\\n * @example\\n * s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distortvol(0.8)\\n */","meta":{"filename":"controls.mjs","lineno":1908,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Postgain for waveshaping distortion.</p>","name":"distortvol","synonyms_text":"distvol","synonyms":["distvol"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"examples":["s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distortvol(0.8)"],"longname":"distortvol","kind":"member","scope":"global"},{"comment":"/**\\n * Type of waveshaping distortion to apply.\\n *\\n * @name distorttype\\n * @synonyms disttype\\n * @param {number | string | Pattern} type type of distortion to apply\\n * @example\\n * s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distorttype(\\"<0 1 2>\\")\\n *\\n * @example\\n * s(\\"sine\\").note(\\"F1*2\\").release(1)\\n *   .penv(24).pdecay(0.05)\\n *   .distort(rand.range(1, 8))\\n *   .distorttype(\\"<fold chebyshev scurve diode asym sinefold>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1919,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Type of waveshaping distortion to apply.</p>","name":"distorttype","synonyms_text":"disttype","synonyms":["disttype"],"params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>type of distortion to apply</p>","name":"type"}],"examples":["s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distorttype(\\"<0 1 2>\\")","s(\\"sine\\").note(\\"F1*2\\").release(1)\\n  .penv(24).pdecay(0.05)\\n  .distort(rand.range(1, 8))\\n  .distorttype(\\"<fold chebyshev scurve diode asym sinefold>\\")"],"longname":"distorttype","kind":"member","scope":"global"},{"comment":"/**\\n * Dynamics Compressor. The params are \`compressor(\\"threshold:ratio:knee:attack:release\\")\`\\n * More info [here](https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode?retiredLocale=de#instance_properties)\\n *\\n * @name compressor\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\")\\n * .compressor(\\"-20:20:10:.002:.02\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1936,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Dynamics Compressor. The params are <code>compressor(&quot;threshold:ratio:knee:attack:release&quot;)</code>\\nMore info <a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode?retiredLocale=de#instance_properties\\">here</a></p>","name":"compressor","examples":["s(\\"bd sd [~ bd] sd,hh*8\\")\\n.compressor(\\"-20:20:10:.002:.02\\")"],"longname":"compressor","kind":"member","scope":"global"},{"comment":"/**\\n * Changes the speed of sample playback, i.e. a cheap way of changing pitch.\\n *\\n * @name speed\\n * @param {number | Pattern} speed -inf to inf, negative numbers play the sample backwards.\\n * @example\\n * s(\\"bd*6\\").speed(\\"1 2 4 1 -2 -4\\")\\n * @example\\n * speed(\\"1 1.5*2 [2 1.1]\\").s(\\"piano\\").clip(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1957,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the speed of sample playback, i.e. a cheap way of changing pitch.</p>","name":"speed","params":[{"type":{"names":["number","Pattern"]},"description":"<p>inf to inf, negative numbers play the sample backwards.</p>","name":"speed"}],"examples":["s(\\"bd*6\\").speed(\\"1 2 4 1 -2 -4\\")","speed(\\"1 1.5*2 [2 1.1]\\").s(\\"piano\\").clip(1)"],"longname":"speed","kind":"member","scope":"global"},{"comment":"/**\\n * Changes the speed of sample playback, i.e. a cheap way of changing pitch.\\n *\\n * @name stretch\\n * @param {number | Pattern} factor -inf to inf, negative numbers play the sample backwards.\\n * @example\\n * s(\\"gm_flute\\").stretch(\\"1 2 .5\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1970,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the speed of sample playback, i.e. a cheap way of changing pitch.</p>","name":"stretch","params":[{"type":{"names":["number","Pattern"]},"description":"<p>inf to inf, negative numbers play the sample backwards.</p>","name":"factor"}],"examples":["s(\\"gm_flute\\").stretch(\\"1 2 .5\\")"],"longname":"stretch","kind":"member","scope":"global"},{"comment":"/**\\n * Used in conjunction with \`speed\`, accepts values of \\"r\\" (rate, default behavior), \\"c\\" (cycles), or \\"s\\" (seconds). Using \`unit \\"c\\"\` means \`speed\` will be interpreted in units of cycles, e.g. \`speed \\"1\\"\` means samples will be stretched to fill a cycle. Using \`unit \\"s\\"\` means the playback speed will be adjusted so that the duration is the number of seconds specified by \`speed\`.\\n *\\n * @name unit\\n * @param {number | string | Pattern} unit see description above\\n * @example\\n * speed(\\"1 2 .5 3\\").s(\\"bd\\").unit(\\"c\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1980,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Used in conjunction with <code>speed</code>, accepts values of &quot;r&quot; (rate, default behavior), &quot;c&quot; (cycles), or &quot;s&quot; (seconds). Using <code>unit &quot;c&quot;</code> means <code>speed</code> will be interpreted in units of cycles, e.g. <code>speed &quot;1&quot;</code> means samples will be stretched to fill a cycle. Using <code>unit &quot;s&quot;</code> means the playback speed will be adjusted so that the duration is the number of seconds specified by <code>speed</code>.</p>","name":"unit","params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>see description above</p>","name":"unit"}],"examples":["speed(\\"1 2 .5 3\\").s(\\"bd\\").unit(\\"c\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"unit","kind":"member","scope":"global"},{"comment":"/**\\n * Made by Calum Gunn. Reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter. The SuperCollider manual defines Squiz as:\\n *\\n * \\"A simplistic pitch-raising algorithm. It's not meant to sound natural; its sound is reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter, depending on the input. The algorithm works by cutting the signal into fragments (delimited by upwards-going zero-crossings) and squeezing those fragments in the time domain (i.e. simply playing them back faster than they came in), leaving silences inbetween. All the parameters apart from memlen can be modulated.\\"\\n *\\n * @name squiz\\n * @param {number | Pattern} squiz Try passing multiples of 2 to it - 2, 4, 8 etc.\\n * @example\\n * squiz(\\"2 4/2 6 [8 16]\\").s(\\"bd\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1992,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Made by Calum Gunn. Reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter. The SuperCollider manual defines Squiz as:</p>\\n<p>&quot;A simplistic pitch-raising algorithm. It's not meant to sound natural; its sound is reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter, depending on the input. The algorithm works by cutting the signal into fragments (delimited by upwards-going zero-crossings) and squeezing those fragments in the time domain (i.e. simply playing them back faster than they came in), leaving silences inbetween. All the parameters apart from memlen can be modulated.&quot;</p>","name":"squiz","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Try passing multiples of 2 to it - 2, 4, 8 etc.</p>","name":"squiz"}],"examples":["squiz(\\"2 4/2 6 [8 16]\\").s(\\"bd\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"squiz","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Formant filter to make things sound like vowels.\\n *\\n * @name vowel\\n * @param {string | Pattern} vowel You can use a e i o u ae aa oe ue y uh un en an on, corresponding to [a] [e] [i] [o] [u] [æ] [ɑ] [ø] [y] [ɯ] [ʌ] [œ̃] [ɛ̃] [ɑ̃] [ɔ̃]. Aliases: aa = å = ɑ, oe = ø = ö, y = ı, ae = æ.\\n * @example\\n * note(\\"[c2 <eb2 <g2 g1>>]*2\\").s('sawtooth')\\n * .vowel(\\"<a e i <o u>>\\")\\n * @example\\n * s(\\"bd sd mt ht bd [~ cp] ht lt\\").vowel(\\"[a|e|i|o|u]\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2017,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Formant filter to make things sound like vowels.</p>","name":"vowel","params":[{"type":{"names":["string","Pattern"]},"description":"<p>You can use a e i o u ae aa oe ue y uh un en an on, corresponding to [a] [e] [i] [o] [u] [æ] [ɑ] [ø] [y] [ɯ] [ʌ] [œ̃] [ɛ̃] [ɑ̃] [ɔ̃]. Aliases: aa = å = ɑ, oe = ø = ö, y = ı, ae = æ.</p>","name":"vowel"}],"examples":["note(\\"[c2 <eb2 <g2 g1>>]*2\\").s('sawtooth')\\n.vowel(\\"<a e i <o u>>\\")","s(\\"bd sd mt ht bd [~ cp] ht lt\\").vowel(\\"[a|e|i|o|u]\\")"],"longname":"vowel","kind":"member","scope":"global"},{"comment":"/**\\n * Noise crackle density\\n *\\n * @name density\\n * @param {number | Pattern} density between 0 and x\\n * @example\\n * s(\\"crackle*4\\").density(\\"<0.01 0.04 0.2 0.5>\\".slow(4))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2042,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Noise crackle density</p>","name":"density","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and x</p>","name":"density"}],"examples":["s(\\"crackle*4\\").density(\\"<0.01 0.04 0.2 0.5>\\".slow(4))"],"longname":"density","kind":"member","scope":"global"},{"comment":"/**\\n * Multiplies the duration with the given number. Also cuts samples off at the end if they exceed the duration.\\n *\\n * @name clip\\n * @synonyms legato\\n * @param {number | Pattern} factor >= 0\\n * @example\\n * note(\\"c a f e\\").s(\\"piano\\").clip(\\"<.5 1 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2092,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Multiplies the duration with the given number. Also cuts samples off at the end if they exceed the duration.</p>","name":"clip","synonyms_text":"legato","synonyms":["legato"],"params":[{"type":{"names":["number","Pattern"]},"description":"<blockquote>\\n<p>= 0</p>\\n</blockquote>","name":"factor"}],"examples":["note(\\"c a f e\\").s(\\"piano\\").clip(\\"<.5 1 2>\\")"],"longname":"clip","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the duration of the event in cycles. Similar to clip / legato, it also cuts samples off at the end if they exceed the duration.\\n *\\n * @name duration\\n * @synonyms dur\\n * @param {number | Pattern} seconds >= 0\\n * @example\\n * note(\\"c a f e\\").s(\\"piano\\").dur(\\"<.5 1 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2104,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the duration of the event in cycles. Similar to clip / legato, it also cuts samples off at the end if they exceed the duration.</p>","name":"duration","synonyms_text":"dur","synonyms":["dur"],"params":[{"type":{"names":["number","Pattern"]},"description":"<blockquote>\\n<p>= 0</p>\\n</blockquote>","name":"seconds"}],"examples":["note(\\"c a f e\\").s(\\"piano\\").dur(\\"<.5 1 2>\\")"],"longname":"duration","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the color of the hap in visualizations like pianoroll or highlighting.\\n * @name color\\n * @synonyms colour\\n * @param {string} color Hexadecimal or CSS color name\\n */","meta":{"filename":"controls.mjs","lineno":2133,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the color of the hap in visualizations like pianoroll or highlighting.</p>","name":"color","synonyms_text":"colour","synonyms":["colour"],"params":[{"type":{"names":["string"]},"description":"<p>Hexadecimal or CSS color name</p>","name":"color"}],"longname":"color","kind":"member","scope":"global"},{"comment":"/**\\n * ADSR envelope: Combination of Attack, Decay, Sustain, and Release.\\n *\\n * @name adsr\\n * @param {number | Pattern} time attack time in seconds\\n * @param {number | Pattern} time decay time in seconds\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n * @param {number | Pattern} time release time in seconds\\n * @example\\n * note(\\"[c3 bb2 f3 eb3]*2\\").sound(\\"sawtooth\\").lpf(600).adsr(\\".1:.1:.5:.2\\")\\n */","meta":{"filename":"controls.mjs","lineno":2146,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>ADSR envelope: Combination of Attack, Decay, Sustain, and Release.</p>","name":"adsr","params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"},{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"},{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"},{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"examples":["note(\\"[c3 bb2 f3 eb3]*2\\").sound(\\"sawtooth\\").lpf(600).adsr(\\".1:.1:.5:.2\\")"],"longname":"adsr","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI channel: Sets the MIDI channel for the event.\\n *\\n * @name midichan\\n * @param {number | Pattern} channel MIDI channel number (0-15)\\n * @example\\n * note(\\"c4\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2180,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI channel: Sets the MIDI channel for the event.</p>","name":"midichan","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI channel number (0-15)</p>","name":"channel"}],"examples":["note(\\"c4\\").midichan(1).midi()"],"longname":"midichan","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI port: Sets the MIDI port for the event.\\n *\\n * @name midiport\\n * @param {number | Pattern} port MIDI port\\n * @example\\n * note(\\"c a f e\\").midiport(\\"<0 1 2 3>\\").midi()\\n */","meta":{"filename":"controls.mjs","lineno":2192,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI port: Sets the MIDI port for the event.</p>","name":"midiport","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI port</p>","name":"port"}],"examples":["note(\\"c a f e\\").midiport(\\"<0 1 2 3>\\").midi()"],"longname":"midiport","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI command: Sends a MIDI command message.\\n *\\n * @name midicmd\\n * @param {number | Pattern} command MIDI command\\n * @example\\n * midicmd(\\"clock*48,<start stop>/2\\").midi()\\n */","meta":{"filename":"controls.mjs","lineno":2202,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI command: Sends a MIDI command message.</p>","name":"midicmd","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI command</p>","name":"command"}],"examples":["midicmd(\\"clock*48,<start stop>/2\\").midi()"],"longname":"midicmd","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control: Sends a MIDI control change message.\\n *\\n * @name control\\n * @param {number | Pattern}  MIDI control number (0-127)\\n * @param {number | Pattern}  MIDI controller value (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control: Sends a MIDI control change message.</p>","name":"control","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control number (0-127)</p>","name":"MIDI"},{"type":{"names":["number","Pattern"]},"description":"<p>controller value (0-127)</p>","name":"MIDI"}],"longname":"control","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control number: Sends a MIDI control change message.\\n *\\n * @name ccn\\n * @param {number | Pattern}  MIDI control number (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2227,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control number: Sends a MIDI control change message.</p>","name":"ccn","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control number (0-127)</p>","name":"MIDI"}],"longname":"ccn","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control value: Sends a MIDI control change message.\\n *\\n * @name ccv\\n * @param {number | Pattern}  MIDI control value (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2234,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control value: Sends a MIDI control change message.</p>","name":"ccv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control value (0-127)</p>","name":"MIDI"}],"longname":"ccv","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI NRPN non-registered parameter number: Sends a MIDI NRPN non-registered parameter number message.\\n * @name nrpnn\\n * @param {number | Pattern} nrpnn MIDI NRPN non-registered parameter number (0-127)\\n * @example\\n * note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2244,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI NRPN non-registered parameter number: Sends a MIDI NRPN non-registered parameter number message.</p>","name":"nrpnn","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI NRPN non-registered parameter number (0-127)</p>","name":"nrpnn"}],"examples":["note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()"],"longname":"nrpnn","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI NRPN non-registered parameter value: Sends a MIDI NRPN non-registered parameter value message.\\n * @name nrpv\\n * @param {number | Pattern} nrpv MIDI NRPN non-registered parameter value (0-127)\\n * @example\\n * note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2252,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI NRPN non-registered parameter value: Sends a MIDI NRPN non-registered parameter value message.</p>","name":"nrpv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI NRPN non-registered parameter value (0-127)</p>","name":"nrpv"}],"examples":["note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()"],"longname":"nrpv","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI program number: Sends a MIDI program change message.\\n *\\n * @name progNum\\n * @param {number | Pattern} program MIDI program number (0-127)\\n * @example\\n * note(\\"c4\\").progNum(10).midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2261,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI program number: Sends a MIDI program change message.</p>","name":"progNum","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI program number (0-127)</p>","name":"program"}],"examples":["note(\\"c4\\").progNum(10).midichan(1).midi()"],"longname":"progNum","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex: Sends a MIDI sysex message.\\n * @name sysex\\n * @param {number | Pattern} id Sysex ID\\n * @param {number | Pattern} data Sysex data\\n * @example\\n * note(\\"c4\\").sysex([\\"0x77\\", \\"0x01:0x02:0x03:0x04\\"]).midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex: Sends a MIDI sysex message.</p>","name":"sysex","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex ID</p>","name":"id"},{"type":{"names":["number","Pattern"]},"description":"<p>Sysex data</p>","name":"data"}],"examples":["note(\\"c4\\").sysex([\\"0x77\\", \\"0x01:0x02:0x03:0x04\\"]).midichan(1).midi()"],"longname":"sysex","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex ID: Sends a MIDI sysex identifier message.\\n * @name sysexid\\n * @param {number | Pattern} id Sysex ID\\n * @example\\n * note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2286,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex ID: Sends a MIDI sysex identifier message.</p>","name":"sysexid","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex ID</p>","name":"id"}],"examples":["note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()"],"longname":"sysexid","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex data: Sends a MIDI sysex message.\\n * @name sysexdata\\n * @param {number | Pattern} data Sysex data\\n * @example\\n * note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2294,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex data: Sends a MIDI sysex message.</p>","name":"sysexdata","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex data</p>","name":"data"}],"examples":["note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()"],"longname":"sysexdata","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI pitch bend: Sends a MIDI pitch bend message.\\n * @name midibend\\n * @param {number | Pattern} midibend MIDI pitch bend (-1 - 1)\\n * @example\\n * note(\\"c4\\").midibend(sine.slow(4).range(-0.4,0.4)).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2303,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI pitch bend: Sends a MIDI pitch bend message.</p>","name":"midibend","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI pitch bend (-1 - 1)</p>","name":"midibend"}],"examples":["note(\\"c4\\").midibend(sine.slow(4).range(-0.4,0.4)).midi()"],"longname":"midibend","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI key after touch: Sends a MIDI key after touch message.\\n * @name miditouch\\n * @param {number | Pattern} miditouch MIDI key after touch (0-1)\\n * @example\\n * note(\\"c4\\").miditouch(sine.slow(4).range(0,1)).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2311,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI key after touch: Sends a MIDI key after touch message.</p>","name":"miditouch","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI key after touch (0-1)</p>","name":"miditouch"}],"examples":["note(\\"c4\\").miditouch(sine.slow(4).range(0,1)).midi()"],"longname":"miditouch","kind":"member","scope":"global"},{"comment":"/**\\n * The host to send open sound control messages to. Requires running the OSC bridge.\\n * @name oschost\\n * @param {string | Pattern} oschost e.g. 'localhost'\\n * @example\\n * note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();\\n */","meta":{"filename":"controls.mjs","lineno":2323,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The host to send open sound control messages to. Requires running the OSC bridge.</p>","name":"oschost","params":[{"type":{"names":["string","Pattern"]},"description":"<p>e.g. 'localhost'</p>","name":"oschost"}],"examples":["note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();"],"longname":"oschost","kind":"member","scope":"global"},{"comment":"/**\\n * The port to send open sound control messages to. Requires running the OSC bridge.\\n * @name oscport\\n * @param {number | Pattern} oscport e.g. 57120\\n * @example\\n * note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();\\n */","meta":{"filename":"controls.mjs","lineno":2332,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The port to send open sound control messages to. Requires running the OSC bridge.</p>","name":"oscport","params":[{"type":{"names":["number","Pattern"]},"description":"<p>e.g. 57120</p>","name":"oscport"}],"examples":["note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();"],"longname":"oscport","kind":"member","scope":"global"},{"comment":"/**\\n * Sets properties in a batch.\\n *\\n * @name as\\n * @param {String | Array} mapping the control names that are set\\n * @example\\n * \\"c:.5 a:1 f:.25 e:.8\\".as(\\"note:clip\\")\\n * @example\\n * \\"{0@2 0.25 0 0.5 .3 .5}%8\\".as(\\"begin\\").s(\\"sax_vib\\").clip(1)\\n */","meta":{"filename":"controls.mjs","lineno":2348,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets properties in a batch.</p>","name":"as","params":[{"type":{"names":["String","Array"]},"description":"<p>the control names that are set</p>","name":"mapping"}],"examples":["\\"c:.5 a:1 f:.25 e:.8\\".as(\\"note:clip\\")","\\"{0@2 0.25 0 0.5 .3 .5}%8\\".as(\\"begin\\").s(\\"sax_vib\\").clip(1)"],"longname":"as","kind":"member","scope":"global"},{"comment":"/**\\n * Allows you to scrub an audio file like a tape loop by passing values that represents the position in the audio file\\n * in the optional array syntax ex: \\"0.5:2\\", the second value controls the speed of playback\\n * @name scrub\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples('github:switchangel/pad')\\n * s(\\"swpad:0\\").scrub(\\"{0.1!2 .25@3 0.7!2 <0.8:1.5>}%8\\")\\n * @example\\n * samples('github:yaxu/clean-breaks/main');\\n * s(\\"amen/4\\").fit().scrub(\\"{0@3 0@2 4@3}%8\\".div(16))\\n */","meta":{"filename":"controls.mjs","lineno":2367,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows you to scrub an audio file like a tape loop by passing values that represents the position in the audio file\\nin the optional array syntax ex: &quot;0.5:2&quot;, the second value controls the speed of playback</p>","name":"scrub","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples('github:switchangel/pad')\\ns(\\"swpad:0\\").scrub(\\"{0.1!2 .25@3 0.7!2 <0.8:1.5>}%8\\")","samples('github:yaxu/clean-breaks/main');\\ns(\\"amen/4\\").fit().scrub(\\"{0@3 0@2 4@3}%8\\".div(16))"],"scope":"static","longname":"Pattern.scrub","kind":"member"},{"comment":"/**\\n * Intended for a debugging, drawLine renders the pattern as a string, where each character represents the same time span.\\n * Should only be used with single characters as values, otherwise the character slots will be messed up.\\n * Character legend:\\n *\\n * - \\"|\\" cycle separator\\n * - \\"-\\" hold previous value\\n * - \\".\\" silence\\n *\\n * @param {Pattern} pattern the pattern to use\\n * @param {number} chars max number of characters (approximately)\\n * @returns string\\n * @example\\n * const line = drawLine(\\"0 [1 2 3]\\", 10); // |0--123|0--123\\n * console.log(line);\\n * silence;\\n */","meta":{"range":[1426,2796],"filename":"drawLine.mjs","lineno":26,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100021770","name":"drawLine","type":"FunctionDeclaration","paramnames":["pat","chars"]},"vars":{"cycle":"drawLine~cycle","pos":"drawLine~pos","lines":"drawLine~lines","emptyLine":"drawLine~emptyLine","haps":"drawLine~haps","durations":"drawLine~durations","":null,"charFraction":"drawLine~charFraction","totalSlots":"drawLine~totalSlots","i":"drawLine~i","undefined":null,"matches":"drawLine~matches","missingLines":"drawLine~missingLines"}},"description":"<p>Intended for a debugging, drawLine renders the pattern as a string, where each character represents the same time span.\\nShould only be used with single characters as values, otherwise the character slots will be messed up.\\nCharacter legend:</p>\\n<ul>\\n<li>&quot;|&quot; cycle separator</li>\\n<li>&quot;-&quot; hold previous value</li>\\n<li>&quot;.&quot; silence</li>\\n</ul>","params":[{"type":{"names":["Pattern"]},"description":"<p>the pattern to use</p>","name":"pattern"},{"type":{"names":["number"]},"description":"<p>max number of characters (approximately)</p>","name":"chars"}],"returns":[{"description":"<p>string</p>"}],"examples":["const line = drawLine(\\"0 [1 2 3]\\", 10); // |0--123|0--123\\nconsole.log(line);\\nsilence;"],"name":"drawLine","longname":"drawLine","kind":"function","scope":"global"},{"comment":"/**\\n * Changes the structure of the pattern to form an Euclidean rhythm.\\n * Euclidean rhythms are rhythms obtained using the greatest common\\n * divisor of two numbers.  They were described in 2004 by Godfried\\n * Toussaint, a Canadian computer scientist.  Euclidean rhythms are\\n * really useful for computer/algorithmic music because they can\\n * describe a large number of rhythms with a couple of numbers.\\n *\\n * @memberof Pattern\\n * @name euclid\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @returns Pattern\\n * @example\\n * // The Cuban tresillo pattern.\\n * note(\\"c3\\").euclid(3,8)\\n */","meta":{"filename":"euclid.mjs","lineno":54,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the structure of the pattern to form an Euclidean rhythm.\\nEuclidean rhythms are rhythms obtained using the greatest common\\ndivisor of two numbers.  They were described in 2004 by Godfried\\nToussaint, a Canadian computer scientist.  Euclidean rhythms are\\nreally useful for computer/algorithmic music because they can\\ndescribe a large number of rhythms with a couple of numbers.</p>","memberof":"Pattern","name":"euclid","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["// The Cuban tresillo pattern.\\nnote(\\"c3\\").euclid(3,8)"],"scope":"static","longname":"Pattern.euclid","kind":"member"},{"comment":"/**\\n * Like \`euclid\`, but has an additional parameter for 'rotating' the resulting sequence.\\n * @memberof Pattern\\n * @name euclidRot\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param {number} rotation offset in steps\\n * @returns Pattern\\n * @example\\n * // A Samba rhythm necklace from Brazil\\n * note(\\"c3\\").euclidRot(3,16,14)\\n */","meta":{"filename":"euclid.mjs","lineno":72,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>euclid</code>, but has an additional parameter for 'rotating' the resulting sequence.</p>","memberof":"Pattern","name":"euclidRot","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>offset in steps</p>","name":"rotation"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["// A Samba rhythm necklace from Brazil\\nnote(\\"c3\\").euclidRot(3,16,14)"],"scope":"static","longname":"Pattern.euclidRot","kind":"member"},{"comment":"/**\\n * @example // A thirteenth-century Persian rhythm called Khafif-e-ramal.\\n * note(\\"c3\\").euclid(2,5)\\n * @example // The archetypal pattern of the Cumbia from Colombia, as well as a Calypso rhythm from Trinidad.\\n * note(\\"c3\\").euclid(3,4)\\n * @example // Another thirteenth century Persian rhythm by the name of Khafif-e-ramal, as well as a Rumanian folk-dance rhythm.\\n * note(\\"c3\\").euclidRot(3,5,2)\\n * @example // A Ruchenitza rhythm used in a Bulgarian folk dance.\\n * note(\\"c3\\").euclid(3,7)\\n * @example // The Cuban tresillo pattern.\\n * note(\\"c3\\").euclid(3,8)\\n * @example // Another Ruchenitza Bulgarian folk-dance rhythm.\\n * note(\\"c3\\").euclid(4,7)\\n * @example // The Aksak rhythm of Turkey.\\n * note(\\"c3\\").euclid(4,9)\\n * @example // The metric pattern used by Frank Zappa in his piece titled Outside Now.\\n * note(\\"c3\\").euclid(4,11)\\n * @example // Yields the York-Samai pattern, a popular Arab rhythm.\\n * note(\\"c3\\").euclid(5,6)\\n * @example // The Nawakhat pattern, another popular Arab rhythm.\\n * note(\\"c3\\").euclid(5,7)\\n * @example // The Cuban cinquillo pattern.\\n * note(\\"c3\\").euclid(5,8)\\n * @example // A popular Arab rhythm called Agsag-Samai.\\n * note(\\"c3\\").euclid(5,9)\\n * @example // The metric pattern used by Moussorgsky in Pictures at an Exhibition.\\n * note(\\"c3\\").euclid(5,11)\\n * @example // The Venda clapping pattern of a South African children’s song.\\n * note(\\"c3\\").euclid(5,12)\\n * @example // The Bossa-Nova rhythm necklace of Brazil.\\n * note(\\"c3\\").euclid(5,16)\\n * @example // A typical rhythm played on the Bendir (frame drum).\\n * note(\\"c3\\").euclid(7,8)\\n * @example // A common West African bell pattern.\\n * note(\\"c3\\").euclid(7,12)\\n * @example // A Samba rhythm necklace from Brazil.\\n * note(\\"c3\\").euclidRot(7,16,14)\\n * @example // A rhythm necklace used in the Central African Republic.\\n * note(\\"c3\\").euclid(9,16)\\n * @example // A rhythm necklace of the Aka Pygmies of Central Africa.\\n * note(\\"c3\\").euclidRot(11,24,14)\\n * @example // Another rhythm necklace of the Aka Pygmies of the upper Sangha.\\n * note(\\"c3\\").euclidRot(13,24,5)\\n */","meta":{"range":[5307,5459],"filename":"euclid.mjs","lineno":130,"columnno":6,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100022275","name":"_euclidRot","type":"FunctionExpression"},"vars":{"b":"_euclidRot~b"}},"examples":["// A thirteenth-century Persian rhythm called Khafif-e-ramal.\\nnote(\\"c3\\").euclid(2,5)","// The archetypal pattern of the Cumbia from Colombia, as well as a Calypso rhythm from Trinidad.\\nnote(\\"c3\\").euclid(3,4)","// Another thirteenth century Persian rhythm by the name of Khafif-e-ramal, as well as a Rumanian folk-dance rhythm.\\nnote(\\"c3\\").euclidRot(3,5,2)","// A Ruchenitza rhythm used in a Bulgarian folk dance.\\nnote(\\"c3\\").euclid(3,7)","// The Cuban tresillo pattern.\\nnote(\\"c3\\").euclid(3,8)","// Another Ruchenitza Bulgarian folk-dance rhythm.\\nnote(\\"c3\\").euclid(4,7)","// The Aksak rhythm of Turkey.\\nnote(\\"c3\\").euclid(4,9)","// The metric pattern used by Frank Zappa in his piece titled Outside Now.\\nnote(\\"c3\\").euclid(4,11)","// Yields the York-Samai pattern, a popular Arab rhythm.\\nnote(\\"c3\\").euclid(5,6)","// The Nawakhat pattern, another popular Arab rhythm.\\nnote(\\"c3\\").euclid(5,7)","// The Cuban cinquillo pattern.\\nnote(\\"c3\\").euclid(5,8)","// A popular Arab rhythm called Agsag-Samai.\\nnote(\\"c3\\").euclid(5,9)","// The metric pattern used by Moussorgsky in Pictures at an Exhibition.\\nnote(\\"c3\\").euclid(5,11)","// The Venda clapping pattern of a South African children’s song.\\nnote(\\"c3\\").euclid(5,12)","// The Bossa-Nova rhythm necklace of Brazil.\\nnote(\\"c3\\").euclid(5,16)","// A typical rhythm played on the Bendir (frame drum).\\nnote(\\"c3\\").euclid(7,8)","// A common West African bell pattern.\\nnote(\\"c3\\").euclid(7,12)","// A Samba rhythm necklace from Brazil.\\nnote(\\"c3\\").euclidRot(7,16,14)","// A rhythm necklace used in the Central African Republic.\\nnote(\\"c3\\").euclid(9,16)","// A rhythm necklace of the Aka Pygmies of Central Africa.\\nnote(\\"c3\\").euclidRot(11,24,14)","// Another rhythm necklace of the Aka Pygmies of the upper Sangha.\\nnote(\\"c3\\").euclidRot(13,24,5)"],"name":"_euclidRot","longname":"_euclidRot","kind":"function","scope":"global","params":[]},{"comment":"/**\\n * Similar to \`euclid\`, but each pulse is held until the next pulse,\\n * so there will be no gaps.\\n * @name euclidLegato\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param rotation offset in steps\\n * @param pat\\n * @example\\n * note(\\"c3\\").euclidLegato(3,8)\\n */","meta":{"filename":"euclid.mjs","lineno":154,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Similar to <code>euclid</code>, but each pulse is held until the next pulse,\\nso there will be no gaps.</p>","name":"euclidLegato","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"description":"<p>offset in steps</p>","name":"rotation"},{"name":"pat"}],"examples":["note(\\"c3\\").euclidLegato(3,8)"],"scope":"static","longname":"Pattern.euclidLegato","kind":"member"},{"comment":"/**\\n * Similar to \`euclid\`, but each pulse is held until the next pulse,\\n * so there will be no gaps, and has an additional parameter for 'rotating'\\n * the resulting sequence\\n * @name euclidLegatoRot\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param {number} rotation offset in steps\\n * @example\\n * note(\\"c3\\").euclidLegatoRot(3,5,2)\\n */","meta":{"filename":"euclid.mjs","lineno":184,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Similar to <code>euclid</code>, but each pulse is held until the next pulse,\\nso there will be no gaps, and has an additional parameter for 'rotating'\\nthe resulting sequence</p>","name":"euclidLegatoRot","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>offset in steps</p>","name":"rotation"}],"examples":["note(\\"c3\\").euclidLegatoRot(3,5,2)"],"scope":"static","longname":"Pattern.euclidLegatoRot","kind":"member"},{"comment":"/**\\n * A 'euclid' variant with an additional parameter that morphs the resulting\\n * rhythm from 0 (no morphing) to 1 (completely 'even'). For example\\n * \`sound(\\"bd\\").euclidish(3,8,0)\` would be the same as\\n * \`sound(\\"bd\\").euclid(3,8)\`, and \`sound(\\"bd\\").euclidish(3,8,1)\` would be the\\n * same as \`sound(\\"bd bd bd\\")\`. \`sound(\\"bd\\").euclidish(3,8,0.5)\` would have a\\n * groove somewhere between.\\n * Inspired by the work of Malcom Braff.\\n * @name euclidish\\n * @synonyms eish\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets\\n * @param {number} steps the number of steps to fill\\n * @param {number} groove exists between the extremes of 0 (straight euclidian) and 1 (straight pulse)\\n * @example\\n * sound(\\"hh\\").euclidish(7,12,sine.slow(8))\\n * .pan(sine.slow(8))\\n */","meta":{"filename":"euclid.mjs","lineno":200,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A 'euclid' variant with an additional parameter that morphs the resulting\\nrhythm from 0 (no morphing) to 1 (completely 'even'). For example\\n<code>sound(&quot;bd&quot;).euclidish(3,8,0)</code> would be the same as\\n<code>sound(&quot;bd&quot;).euclid(3,8)</code>, and <code>sound(&quot;bd&quot;).euclidish(3,8,1)</code> would be the\\nsame as <code>sound(&quot;bd bd bd&quot;)</code>. <code>sound(&quot;bd&quot;).euclidish(3,8,0.5)</code> would have a\\ngroove somewhere between.\\nInspired by the work of Malcom Braff.</p>","name":"euclidish","synonyms_text":"eish","synonyms":["eish"],"memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>exists between the extremes of 0 (straight euclidian) and 1 (straight pulse)</p>","name":"groove"}],"examples":["sound(\\"hh\\").euclidish(7,12,sine.slow(8))\\n.pan(sine.slow(8))"],"scope":"static","longname":"Pattern.euclidish","kind":"member"},{"comment":"/** @class Class representing a pattern. */","meta":{"range":[1713,27921],"filename":"pattern.mjs","lineno":44,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100024880","name":"exports.Pattern","type":"ClassDeclaration"}},"name":"Pattern","longname":"Pattern","kind":"class","classdesc":"<p>Class representing a pattern.</p>","scope":"global","description":"<p>Create a pattern. As an end user, you will most likely not create a Pattern directly.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"memberof":"Pattern","params":[{"type":{"names":["function"]},"description":"<p>The function that maps a <code>State</code> to an array of <code>Hap</code>.</p>","name":"query"}]},{"comment":"/**\\n   * Returns a new pattern, with the function applied to the value of\\n   * each hap. It has the alias \`fmap\`.\\n   * @synonyms fmap\\n   * @param {Function} func to to apply to the value\\n   * @returns Pattern\\n   * @example\\n   * \\"0 1 2\\".withValue(v => v + 10).log()\\n   */","meta":{"range":[3020,3189],"filename":"pattern.mjs","lineno":93,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100024988","name":"Pattern#withValue","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern, with the function applied to the value of\\neach hap. It has the alias <code>fmap</code>.</p>","synonyms_text":"fmap","synonyms":["fmap"],"params":[{"type":{"names":["function"]},"description":"<p>to to apply to the value</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2\\".withValue(v => v + 10).log()"],"name":"withValue","longname":"Pattern#withValue","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * see \`withValue\`\\n   * @noAutocomplete\\n   */","meta":{"range":[3362,3411],"filename":"pattern.mjs","lineno":108,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025042","name":"Pattern#fmap","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>see <code>withValue</code></p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"fmap","longname":"Pattern#fmap","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Assumes 'this' is a pattern of functions, and given a function to\\n   * resolve wholes, applies a given pattern of values to that\\n   * pattern of functions.\\n   * @param {Function} whole_func\\n   * @param {Function} func\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[3693,4435],"filename":"pattern.mjs","lineno":121,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025053","name":"Pattern#appWhole","type":"MethodDefinition","paramnames":["whole_func","pat_val"]},"vars":{"":null}},"description":"<p>Assumes 'this' is a pattern of functions, and given a function to\\nresolve wholes, applies a given pattern of values to that\\npattern of functions.</p>","params":[{"type":{"names":["function"]},"name":"whole_func"},{"type":{"names":["function"]},"name":"func"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appWhole","longname":"Pattern#appWhole","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * When this method is called on a pattern of functions, it matches its haps\\n   * with those in the given pattern of values.  A new pattern is returned, with\\n   * each matching value applied to the corresponding function.\\n   *\\n   * In this \`_appBoth\` variant, where timespans of the function and value haps\\n   * are not the same but do intersect, the resulting hap has a timespan of the\\n   * intersection. This applies to both the part and the whole timespan.\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[4986,5410],"filename":"pattern.mjs","lineno":157,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025160","name":"Pattern#appBoth","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>When this method is called on a pattern of functions, it matches its haps\\nwith those in the given pattern of values.  A new pattern is returned, with\\neach matching value applied to the corresponding function.</p>\\n<p>In this <code>_appBoth</code> variant, where timespans of the function and value haps\\nare not the same but do intersect, the resulting hap has a timespan of the\\nintersection. This applies to both the part and the whole timespan.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appBoth","longname":"Pattern#appBoth","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`appBoth\`, but the \`whole\` timespan is not the intersection,\\n   * but the timespan from the function of patterns that this method is called\\n   * on. In practice, this means that the pattern structure, including onsets,\\n   * are preserved from the pattern of functions (often referred to as the left\\n   * hand or inner pattern).\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[5840,6644],"filename":"pattern.mjs","lineno":184,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025220","name":"Pattern#appLeft","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>As with <code>appBoth</code>, but the <code>whole</code> timespan is not the intersection,\\nbut the timespan from the function of patterns that this method is called\\non. In practice, this means that the pattern structure, including onsets,\\nare preserved from the pattern of functions (often referred to as the left\\nhand or inner pattern).</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appLeft","longname":"Pattern#appLeft","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`appLeft\`, but \`whole\` timespans are instead taken from the\\n   * pattern of values, i.e. structure is preserved from the right hand/outer\\n   * pattern.\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[6898,7706],"filename":"pattern.mjs","lineno":217,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025342","name":"Pattern#appRight","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>As with <code>appLeft</code>, but <code>whole</code> timespans are instead taken from the\\npattern of values, i.e. structure is preserved from the right hand/outer\\npattern.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appRight","longname":"Pattern#appRight","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Query haps inside the given time span.\\n   *\\n   * @param {Fraction | number} begin from time\\n   * @param {Fraction | number} end to time\\n   * @returns Hap[]\\n   * @example\\n   * const pattern = sequence('a', ['b', 'c'])\\n   * const haps = pattern.queryArc(0, 1)\\n   * console.log(haps)\\n   * silence\\n   * @noAutocomplete\\n   */","meta":{"range":[13342,13558],"filename":"pattern.mjs","lineno":413,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026022","name":"Pattern#queryArc","type":"MethodDefinition","paramnames":["begin","end","controls"]},"vars":{"":null}},"description":"<p>Query haps inside the given time span.</p>","params":[{"type":{"names":["Fraction","number"]},"description":"<p>from time</p>","name":"begin"},{"type":{"names":["Fraction","number"]},"description":"<p>to time</p>","name":"end"}],"returns":[{"description":"<p>Hap[]</p>"}],"examples":["const pattern = sequence('a', ['b', 'c'])\\nconst haps = pattern.queryArc(0, 1)\\nconsole.log(haps)\\nsilence"],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"queryArc","longname":"Pattern#queryArc","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern, with queries split at cycle boundaries. This makes\\n   * some calculations easier to express, as all haps are then constrained to\\n   * happen within a cycle.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[13802,14002],"filename":"pattern.mjs","lineno":429,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026058","name":"Pattern#splitQueries","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with queries split at cycle boundaries. This makes\\nsome calculations easier to express, as all haps are then constrained to\\nhappen within a cycle.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"splitQueries","longname":"Pattern#splitQueries","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, where the given function is applied to the query\\n   * timespan before passing it to the original pattern.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[14245,14339],"filename":"pattern.mjs","lineno":444,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026098","name":"Pattern#withQuerySpan","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern, where the given function is applied to the query\\ntimespan before passing it to the original pattern.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withQuerySpan","longname":"Pattern#withQuerySpan","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withQuerySpan\`, but the function is applied to both the\\n   * begin and end time of the query timespan.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[14799,14918],"filename":"pattern.mjs","lineno":466,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026154","name":"Pattern#withQueryTime","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withQuerySpan</code>, but the function is applied to both the\\nbegin and end time of the query timespan.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withQueryTime","longname":"Pattern#withQueryTime","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Similar to \`withQuerySpan\`, but the function is applied to the timespans\\n   * of all haps returned by pattern queries (both \`part\` timespans, and where\\n   * present, \`whole\` timespans).\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15196,15306],"filename":"pattern.mjs","lineno":478,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026179","name":"Pattern#withHapSpan","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Similar to <code>withQuerySpan</code>, but the function is applied to the timespans\\nof all haps returned by pattern queries (both <code>part</code> timespans, and where\\npresent, <code>whole</code> timespans).</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHapSpan","longname":"Pattern#withHapSpan","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withHapSpan\`, but the function is applied to both the\\n   * begin and end time of the hap timespans.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15529,15612],"filename":"pattern.mjs","lineno":489,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026204","name":"Pattern#withHapTime","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withHapSpan</code>, but the function is applied to both the\\nbegin and end time of the hap timespans.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHapTime","longname":"Pattern#withHapTime","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the given function applied to the list of haps returned by every query.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15803,15950],"filename":"pattern.mjs","lineno":499,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026221","name":"Pattern#withHaps","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given function applied to the list of haps returned by every query.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHaps","longname":"Pattern#withHaps","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withHaps\`, but applies the function to every hap, rather than every list of haps.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16133,16204],"filename":"pattern.mjs","lineno":511,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026251","name":"Pattern#withHap","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withHaps</code>, but applies the function to every hap, rather than every list of haps.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHap","longname":"Pattern#withHap","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the context field set to every hap set to the given value.\\n   * @param {*} context\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16378,16462],"filename":"pattern.mjs","lineno":521,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026268","name":"Pattern#setContext","type":"MethodDefinition","paramnames":["context"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the context field set to every hap set to the given value.</p>","params":[{"type":{"names":["*"]},"name":"context"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"setContext","longname":"Pattern#setContext","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the given function applied to the context field of every hap.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16643,16883],"filename":"pattern.mjs","lineno":531,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026285","name":"Pattern#withContext","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given function applied to the context field of every hap.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withContext","longname":"Pattern#withContext","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the context field of every hap set to an empty object.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17029,17103],"filename":"pattern.mjs","lineno":545,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026333","name":"Pattern#stripContext","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern with the context field of every hap set to an empty object.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"stripContext","longname":"Pattern#stripContext","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern with the given location information added to the\\n   * context of every hap.\\n   * @param {Number} start start offset\\n   * @param {Number} end end offset\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17341,17708],"filename":"pattern.mjs","lineno":557,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026349","name":"Pattern#withLoc","type":"MethodDefinition","paramnames":["start","end"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given location information added to the\\ncontext of every hap.</p>","params":[{"type":{"names":["Number"]},"description":"<p>start offset</p>","name":"start"},{"type":{"names":["Number"]},"description":"<p>end offset</p>","name":"end"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withLoc","longname":"Pattern#withLoc","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new Pattern, which only returns haps that meet the given test.\\n   * @param {Function} hap_test - a function which returns false for haps to be removed from the pattern\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17950,18047],"filename":"pattern.mjs","lineno":579,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026413","name":"Pattern#filterHaps","type":"MethodDefinition","paramnames":["hap_test"]},"vars":{"":null}},"description":"<p>Returns a new Pattern, which only returns haps that meet the given test.</p>","params":[{"type":{"names":["function"]},"description":"<p>a function which returns false for haps to be removed from the pattern</p>","name":"hap_test"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"filterHaps","longname":"Pattern#filterHaps","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`filterHaps\`, but the function is applied to values\\n   * inside haps.\\n   * @param {Function} value_test\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18223,18368],"filename":"pattern.mjs","lineno":590,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026432","name":"Pattern#filterValues","type":"MethodDefinition","paramnames":["value_test"]},"vars":{"":null}},"description":"<p>As with <code>filterHaps</code>, but the function is applied to values\\ninside haps.</p>","params":[{"type":{"names":["function"]},"name":"value_test"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"filterValues","longname":"Pattern#filterValues","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern, with haps containing undefined values removed from\\n   * query results.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18526,18607],"filename":"pattern.mjs","lineno":600,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026463","name":"Pattern#removeUndefineds","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with haps containing undefined values removed from\\nquery results.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"removeUndefineds","longname":"Pattern#removeUndefineds","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, with all haps without onsets filtered out. A hap\\n   * with an onset is one with a \`whole\` timespan that begins at the same time\\n   * as its \`part\` timespan.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18851,19116],"filename":"pattern.mjs","lineno":611,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026477","name":"Pattern#onsetsOnly","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with all haps without onsets filtered out. A hap\\nwith an onset is one with a <code>whole</code> timespan that begins at the same time\\nas its <code>part</code> timespan.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"onsetsOnly","longname":"Pattern#onsetsOnly","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, with 'continuous' haps (those without 'whole'\\n   * timespans) removed from query results.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[19293,19427],"filename":"pattern.mjs","lineno":624,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026492","name":"Pattern#discreteOnly","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with 'continuous' haps (those without 'whole'\\ntimespans) removed from query results.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"discreteOnly","longname":"Pattern#discreteOnly","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Combines adjacent haps with the same value and whole.  Only\\n   * intended for use in tests.\\n   * @noAutocomplete\\n   */","meta":{"range":[19561,21006],"filename":"pattern.mjs","lineno":634,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026506","name":"Pattern#defragmentHaps","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Combines adjacent haps with the same value and whole.  Only\\nintended for use in tests.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"defragmentHaps","longname":"Pattern#defragmentHaps","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Queries the pattern for the first cycle, returning Haps. Mainly of use when\\n   * debugging a pattern.\\n   * @param {Boolean} with_context - set to true, otherwise the context field\\n   * will be stripped from the resulting haps.\\n   * @returns [Hap]\\n   * @noAutocomplete\\n   */","meta":{"range":[21295,21493],"filename":"pattern.mjs","lineno":689,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026737","name":"Pattern#firstCycle","type":"MethodDefinition","paramnames":["with_context"]},"vars":{"":null}},"description":"<p>Queries the pattern for the first cycle, returning Haps. Mainly of use when\\ndebugging a pattern.</p>","params":[{"type":{"names":["Boolean"]},"description":"<p>set to true, otherwise the context field\\nwill be stripped from the resulting haps.</p>","name":"with_context","defaultvalue":false}],"returns":[{"description":"<p>[Hap]</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"firstCycle","longname":"Pattern#firstCycle","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Accessor for a list of values returned by querying the first cycle.\\n   * @noAutocomplete\\n   */","meta":{"range":[21603,21685],"filename":"pattern.mjs","lineno":701,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026774","name":"Pattern#firstCycleValues","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Accessor for a list of values returned by querying the first cycle.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"firstCycleValues","longname":"Pattern#firstCycleValues","kind":"member","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * More human-readable version of the \`firstCycleValues\` accessor.\\n   * @noAutocomplete\\n   */","meta":{"range":[21791,21954],"filename":"pattern.mjs","lineno":709,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026791","name":"Pattern#showFirstCycle","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>More human-readable version of the <code>firstCycleValues</code> accessor.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"showFirstCycle","longname":"Pattern#showFirstCycle","kind":"member","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, which returns haps sorted in temporal order. Mainly\\n   * of use when comparing two patterns for equality, in tests.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[22157,22430],"filename":"pattern.mjs","lineno":721,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026829","name":"Pattern#sortHapsByPart","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, which returns haps sorted in temporal order. Mainly\\nof use when comparing two patterns for equality, in tests.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"sortHapsByPart","longname":"Pattern#sortHapsByPart","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Layers the result of the given function(s). Like \`superimpose\`, but without the original pattern:\\n   * @name layer\\n   * @memberof Pattern\\n   * @synonyms apply\\n   * @returns Pattern\\n   * @example\\n   * \\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n   *   .layer(x=>x.add(\\"0,2\\"))\\n   *   .scale('C minor').note()\\n   */","meta":{"filename":"pattern.mjs","lineno":779,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Layers the result of the given function(s). Like <code>superimpose</code>, but without the original pattern:</p>","name":"layer","memberof":"Pattern","synonyms_text":"apply","synonyms":["apply"],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n  .layer(x=>x.add(\\"0,2\\"))\\n  .scale('C minor').note()"],"scope":"static","longname":"Pattern.layer","kind":"member"},{"comment":"/**\\n   * Superimposes the result of the given function(s) on top of the original pattern:\\n   * @name superimpose\\n   * @memberof Pattern\\n   * @returns Pattern\\n   * @example\\n   * \\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n   *   .superimpose(x=>x.add(2))\\n   *   .scale('C minor').note()\\n   */","meta":{"filename":"pattern.mjs","lineno":794,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimposes the result of the given function(s) on top of the original pattern:</p>","name":"superimpose","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n  .superimpose(x=>x.add(2))\\n  .scale('C minor').note()"],"scope":"static","longname":"Pattern.superimpose","kind":"member"},{"comment":"/**\\n   * Writes the content of the current event to the console (visible in the side menu).\\n   * @name log\\n   * @memberof Pattern\\n   * @example\\n   * s(\\"bd sd\\").log()\\n   */","meta":{"filename":"pattern.mjs","lineno":854,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Writes the content of the current event to the console (visible in the side menu).</p>","name":"log","memberof":"Pattern","examples":["s(\\"bd sd\\").log()"],"scope":"static","longname":"Pattern.log","kind":"member"},{"comment":"/**\\n   * A simplified version of \`log\` which writes all \\"values\\" (various configurable parameters)\\n   * within the event to the console (visible in the side menu).\\n   * @name logValues\\n   * @memberof Pattern\\n   * @example\\n   * s(\\"bd sd\\").gain(\\"0.25 0.5 1\\").n(\\"2 1 0\\").logValues()\\n   */","meta":{"filename":"pattern.mjs","lineno":867,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A simplified version of <code>log</code> which writes all &quot;values&quot; (various configurable parameters)\\nwithin the event to the console (visible in the side menu).</p>","name":"logValues","memberof":"Pattern","examples":["s(\\"bd sd\\").gain(\\"0.25 0.5 1\\").n(\\"2 1 0\\").logValues()"],"scope":"static","longname":"Pattern.logValues","kind":"member"},{"comment":"/**\\n   * Breaks a pattern into pieces according to the structure of a given pattern.\\n   * True values in the given pattern cause the corresponding subcycle of the\\n   * source pattern to be looped, and for an (optional) given function to be\\n   * applied. False values result in the corresponding part of the source pattern\\n   * to be played unchanged.\\n   * @name into\\n   * @memberof Pattern\\n   * @example\\n   * sound(\\"bd sd ht lt\\").into(\\"1 0\\", hurry(2))\\n   */","meta":{"filename":"pattern.mjs","lineno":897,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Breaks a pattern into pieces according to the structure of a given pattern.\\nTrue values in the given pattern cause the corresponding subcycle of the\\nsource pattern to be looped, and for an (optional) given function to be\\napplied. False values result in the corresponding part of the source pattern\\nto be played unchanged.</p>","name":"into","memberof":"Pattern","examples":["sound(\\"bd sd ht lt\\").into(\\"1 0\\", hurry(2))"],"scope":"static","longname":"Pattern.into","kind":"member"},{"comment":"/**\\n * Selects indices in in stacked notes.\\n * @example\\n * note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n * .arpWith(haps => haps[2])\\n * */","meta":{"range":[28891,29121],"filename":"pattern.mjs","lineno":946,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100027543","name":"exports.arpWith","type":"VariableDeclaration"}},"description":"<p>Selects indices in in stacked notes.</p>","examples":["note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n.arpWith(haps => haps[2])"],"name":"arpWith","longname":"arpWith","kind":"constant","scope":"global"},{"comment":"/**\\n * Selects indices in in stacked notes.\\n * @example\\n * note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n * .arp(\\"0 [0,2] 1 [0,2]\\")\\n * */","meta":{"range":[29254,29397],"filename":"pattern.mjs","lineno":960,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100027597","name":"exports.arp","type":"VariableDeclaration"}},"description":"<p>Selects indices in in stacked notes.</p>","examples":["note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n.arp(\\"0 [0,2] 1 [0,2]\\")"],"name":"arp","longname":"arp","kind":"constant","scope":"global"},{"comment":"/**\\n     *\\n     * Assumes a pattern of numbers. Adds the given number to each item in the pattern.\\n     * @name add\\n     * @memberof Pattern\\n     * @example\\n     * // Here, the triad 0, 2, 4 is shifted by different amounts\\n     * n(\\"0 2 4\\".add(\\"<0 3 4 0>\\")).scale(\\"C:major\\")\\n     * // Without add, the equivalent would be:\\n     * // n(\\"<[0 2 4] [3 5 7] [4 6 8] [0 2 4]>\\").scale(\\"C:major\\")\\n     * @example\\n     * // You can also use add with notes:\\n     * note(\\"c3 e3 g3\\".add(\\"<0 5 7 0>\\"))\\n     * // Behind the scenes, the notes are converted to midi numbers:\\n     * // note(\\"48 52 55\\".add(\\"<0 5 7 0>\\"))\\n     */","meta":{"filename":"pattern.mjs","lineno":1023,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a pattern of numbers. Adds the given number to each item in the pattern.</p>","name":"add","memberof":"Pattern","examples":["// Here, the triad 0, 2, 4 is shifted by different amounts\\nn(\\"0 2 4\\".add(\\"<0 3 4 0>\\")).scale(\\"C:major\\")\\n// Without add, the equivalent would be:\\n// n(\\"<[0 2 4] [3 5 7] [4 6 8] [0 2 4]>\\").scale(\\"C:major\\")","// You can also use add with notes:\\nnote(\\"c3 e3 g3\\".add(\\"<0 5 7 0>\\"))\\n// Behind the scenes, the notes are converted to midi numbers:\\n// note(\\"48 52 55\\".add(\\"<0 5 7 0>\\"))"],"scope":"static","longname":"Pattern.add","kind":"member"},{"comment":"/**\\n     *\\n     * Like add, but the given numbers are subtracted.\\n     * @name sub\\n     * @memberof Pattern\\n     * @example\\n     * n(\\"0 2 4\\".sub(\\"<0 1 2 3>\\")).scale(\\"C4:minor\\")\\n     * // See add for more information.\\n     */","meta":{"filename":"pattern.mjs","lineno":1040,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like add, but the given numbers are subtracted.</p>","name":"sub","memberof":"Pattern","examples":["n(\\"0 2 4\\".sub(\\"<0 1 2 3>\\")).scale(\\"C4:minor\\")\\n// See add for more information."],"scope":"static","longname":"Pattern.sub","kind":"member"},{"comment":"/**\\n     *\\n     * Multiplies each number by the given factor.\\n     * @name mul\\n     * @memberof Pattern\\n     * @example\\n     * \\"<1 1.5 [1.66, <2 2.33>]>*4\\".mul(150).freq()\\n     */","meta":{"filename":"pattern.mjs","lineno":1050,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Multiplies each number by the given factor.</p>","name":"mul","memberof":"Pattern","examples":["\\"<1 1.5 [1.66, <2 2.33>]>*4\\".mul(150).freq()"],"scope":"static","longname":"Pattern.mul","kind":"member"},{"comment":"/**\\n     *\\n     * Divides each number by the given factor.\\n     * @name div\\n     * @memberof Pattern\\n     */","meta":{"filename":"pattern.mjs","lineno":1059,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides each number by the given factor.</p>","name":"div","memberof":"Pattern","scope":"static","longname":"Pattern.div","kind":"member"},{"comment":"/**\\n   * Applies the given structure to the pattern:\\n   *\\n   * @example\\n   * note(\\"c,eb,g\\")\\n   *   .struct(\\"x ~ x ~ ~ x ~ x ~ ~ ~ x ~ x ~ ~\\")\\n   *   .slow(2)\\n   */","meta":{"range":[35283,35371],"filename":"pattern.mjs","lineno":1155,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028142","name":"Pattern.prototype.struct","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Applies the given structure to the pattern:</p>","examples":["note(\\"c,eb,g\\")\\n  .struct(\\"x ~ x ~ ~ x ~ x ~ ~ ~ x ~ x ~ ~\\")\\n  .slow(2)"],"name":"struct","longname":"Pattern#struct","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns silence when mask is 0 or \\"~\\"\\n   *\\n   * @example\\n   * note(\\"c [eb,g] d [eb,g]\\").mask(\\"<1 [0 1]>\\")\\n   */","meta":{"range":[35591,35676],"filename":"pattern.mjs","lineno":1167,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028182","name":"Pattern.prototype.mask","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Returns silence when mask is 0 or &quot;~&quot;</p>","examples":["note(\\"c [eb,g] d [eb,g]\\").mask(\\"<1 [0 1]>\\")"],"name":"mask","longname":"Pattern#mask","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Resets the pattern to the start of the cycle for each onset of the reset pattern.\\n   *\\n   * @example\\n   * s(\\"[<bd lt> sd]*2, hh*8\\").reset(\\"<x@3 x(5,8)>\\")\\n   */","meta":{"range":[35941,36030],"filename":"pattern.mjs","lineno":1179,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028222","name":"Pattern.prototype.reset","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Resets the pattern to the start of the cycle for each onset of the reset pattern.</p>","examples":["s(\\"[<bd lt> sd]*2, hh*8\\").reset(\\"<x@3 x(5,8)>\\")"],"name":"reset","longname":"Pattern#reset","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Restarts the pattern for each onset of the restart pattern.\\n   * While reset will only reset the current cycle, restart will start from cycle 0.\\n   *\\n   * @example\\n   * s(\\"[<bd lt> sd]*2, hh*8\\").restart(\\"<x@3 x(5,8)>\\")\\n   */","meta":{"range":[36364,36457],"filename":"pattern.mjs","lineno":1192,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028262","name":"Pattern.prototype.restart","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Restarts the pattern for each onset of the restart pattern.\\nWhile reset will only reset the current cycle, restart will start from cycle 0.</p>","examples":["s(\\"[<bd lt> sd]*2, hh*8\\").restart(\\"<x@3 x(5,8)>\\")"],"name":"restart","longname":"Pattern#restart","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Does absolutely nothing, but with a given metrical 'steps'\\n * @name gap\\n * @param  {number} steps\\n * @example\\n * gap(3) // \\"~@3\\"\\n */","meta":{"filename":"pattern.mjs","lineno":1226,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Does absolutely nothing, but with a given metrical 'steps'</p>","name":"gap","params":[{"type":{"names":["number"]},"name":"steps"}],"examples":["gap(3) // \\"~@3\\""],"longname":"gap","kind":"member","scope":"global"},{"comment":"/**\\n * Does absolutely nothing..\\n * @name silence\\n * @example\\n * silence // \\"~\\"\\n */","meta":{"filename":"pattern.mjs","lineno":1235,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Does absolutely nothing..</p>","name":"silence","examples":["silence // \\"~\\""],"longname":"silence","kind":"member","scope":"global"},{"comment":"/**\\n * A discrete value that repeats once per cycle.\\n *\\n * @returns {Pattern}\\n * @example\\n * pure('e4') // \\"e4\\"\\n * @noAutocomplete\\n */","meta":{"range":[37708,37965],"filename":"pattern.mjs","lineno":1254,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028341","name":"exports.pure","type":"FunctionDeclaration","paramnames":["value"]}},"description":"<p>A discrete value that repeats once per cycle.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["pure('e4') // \\"e4\\""],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"pure","longname":"pure","kind":"function","scope":"global"},{"comment":"/** Takes a list of patterns, and returns a pattern of lists.\\n */","meta":{"range":[38970,39150],"filename":"pattern.mjs","lineno":1292,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028431","name":"exports.sequenceP","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Takes a list of patterns, and returns a pattern of lists.</p>","name":"sequenceP","longname":"sequenceP","kind":"function","scope":"global"},{"comment":"/**\\n * The given items are played at the same time at the same length.\\n *\\n * @return {Pattern}\\n * @synonyms polyrhythm, pr\\n * @example\\n * stack(\\"g3\\", \\"b3\\", [\\"e4\\", \\"d4\\"]).note()\\n * // \\"g3,b3,[e4 d4]\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").stack(\\n *   note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[39452,39830],"filename":"pattern.mjs","lineno":1315,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028471","name":"exports.stack","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>The given items are played at the same time at the same length.</p>","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"polyrhythm, pr","synonyms":["polyrhythm","pr"],"examples":["stack(\\"g3\\", \\"b3\\", [\\"e4\\", \\"d4\\"]).note()\\n// \\"g3,b3,[e4 d4]\\".note()","// As a chained function:\\ns(\\"hh*4\\").stack(\\n  note(\\"c4(5,8)\\")\\n)"],"name":"stack","longname":"stack","kind":"function","scope":"global"},{"comment":"/**\\n * Concatenation: combines a list of patterns, switching between them successively, one per cycle.\\n *\\n * @return {Pattern}\\n * @synonyms cat\\n * @example\\n * slowcat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"])\\n *\\n */","meta":{"range":[41498,42548],"filename":"pattern.mjs","lineno":1393,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028835","name":"exports.slowcat","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Concatenation: combines a list of patterns, switching between them successively, one per cycle.</p>","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"cat","synonyms":["cat"],"examples":["slowcat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"])"],"name":"slowcat","longname":"slowcat","kind":"function","scope":"global"},{"comment":"/** Concatenation: combines a list of patterns, switching between them successively, one per cycle. Unlike slowcat, this version will skip cycles.\\n * @param {...any} items - The items to concatenate\\n * @return {Pattern}\\n */","meta":{"range":[42774,43147],"filename":"pattern.mjs","lineno":1423,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028995","name":"exports.slowcatPrime","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Concatenation: combines a list of patterns, switching between them successively, one per cycle. Unlike slowcat, this version will skip cycles.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>The items to concatenate</p>","name":"items"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"slowcatPrime","longname":"slowcatPrime","kind":"function","scope":"global"},{"comment":"/** The given items are con**cat**enated, where each one takes one cycle.\\n *\\n * @param {...any} items - The items to concatenate\\n * @synonyms slowcat\\n * @return {Pattern}\\n * @example\\n * cat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n * // \\"<e5 b4 [d5 c5]>\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").cat(\\n *    note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[43496,43555],"filename":"pattern.mjs","lineno":1448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029048","name":"exports.cat","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>The given items are con<strong>cat</strong>enated, where each one takes one cycle.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>The items to concatenate</p>","name":"items"}],"synonyms_text":"slowcat","synonyms":["slowcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["cat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n// \\"<e5 b4 [d5 c5]>\\".note()","// As a chained function:\\ns(\\"hh*4\\").cat(\\n   note(\\"c4(5,8)\\")\\n)"],"name":"cat","longname":"cat","kind":"function","scope":"global"},{"comment":"/**\\n * Allows to arrange multiple patterns together over multiple cycles.\\n * Takes a variable number of arrays with two elements specifying the number of cycles and the pattern to use.\\n *\\n * @return {Pattern}\\n * @example\\n * arrange(\\n *   [4, \\"<c a f e>(3,8)\\"],\\n *   [2, \\"<g a>(5,8)\\"]\\n * ).note()\\n */","meta":{"range":[43857,44091],"filename":"pattern.mjs","lineno":1463,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029059","name":"exports.arrange","type":"FunctionDeclaration","paramnames":["sections"]}},"description":"<p>Allows to arrange multiple patterns together over multiple cycles.\\nTakes a variable number of arrays with two elements specifying the number of cycles and the pattern to use.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["arrange(\\n  [4, \\"<c a f e>(3,8)\\"],\\n  [2, \\"<g a>(5,8)\\"]\\n).note()"],"name":"arrange","longname":"arrange","kind":"function","scope":"global"},{"comment":"/**\\n * Similarly to \`arrange\`, allows you to arrange multiple patterns together over multiple cycles.\\n * Unlike \`arrange\`, you specify a start and stop time for each pattern rather than duration, which\\n * means that patterns can overlap.\\n * @return {Pattern}\\n * @example\\nseqPLoop([0, 2, \\"bd(3,8)\\"],\\n         [1, 3, \\"cp(3,8)\\"]\\n        )\\n  .sound()\\n */","meta":{"range":[44444,44868],"filename":"pattern.mjs","lineno":1480,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029104","name":"exports.seqPLoop","type":"FunctionDeclaration","paramnames":["parts"]}},"description":"<p>Similarly to <code>arrange</code>, allows you to arrange multiple patterns together over multiple cycles.\\nUnlike <code>arrange</code>, you specify a start and stop time for each pattern rather than duration, which\\nmeans that patterns can overlap.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["seqPLoop([0, 2, \\"bd(3,8)\\"],\\n         [1, 3, \\"cp(3,8)\\"]\\n        )\\n  .sound()"],"name":"seqPLoop","longname":"seqPLoop","kind":"function","scope":"global"},{"comment":"/** See \`fastcat\` */","meta":{"range":[45171,45235],"filename":"pattern.mjs","lineno":1512,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029247","name":"exports.sequence","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>See <code>fastcat</code></p>","name":"sequence","longname":"sequence","kind":"function","scope":"global"},{"comment":"/** Like **cat**, but the items are crammed into one cycle.\\n * @synonyms sequence, fastcat\\n * @example\\n * seq(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n * // \\"e5 b4 [d5 c5]\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").seq(\\n *   note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[45502,45561],"filename":"pattern.mjs","lineno":1529,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029258","name":"exports.seq","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Like <strong>cat</strong>, but the items are crammed into one cycle.</p>","synonyms_text":"sequence, fastcat","synonyms":["sequence","fastcat"],"examples":["seq(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n// \\"e5 b4 [d5 c5]\\".note()","// As a chained function:\\ns(\\"hh*4\\").seq(\\n  note(\\"c4(5,8)\\")\\n)"],"name":"seq","longname":"seq","kind":"function","scope":"global"},{"comment":"/**\\n * Registers a new pattern method. The method is added to the Pattern class + the standalone function is returned from register.\\n *\\n * @param {string | string[]} name name of the function, or an array of names to be used as synonyms\\n * @param {function} func function with 1 or more params, where last is the current pattern\\n * @noAutocomplete\\n *\\n */","meta":{"range":[48191,50867],"filename":"pattern.mjs","lineno":1593,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029890","name":"exports.register","type":"FunctionDeclaration","paramnames":["name","func","patternify","preserveSteps","join"]}},"description":"<p>Registers a new pattern method. The method is added to the Pattern class + the standalone function is returned from register.</p>","params":[{"type":{"names":["string","Array.<string>"]},"description":"<p>name of the function, or an array of names to be used as synonyms</p>","name":"name"},{"type":{"names":["function"]},"description":"<p>function with 1 or more params, where last is the current pattern</p>","name":"func"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"register","longname":"register","kind":"function","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values rounded\\n * to the nearest integer.\\n * @name round\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * n(\\"0.5 1.5 2.5\\".round()).scale(\\"C:major\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1686,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values rounded\\nto the nearest integer.</p>","name":"round","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0.5 1.5 2.5\\".round()).scale(\\"C:major\\")"],"scope":"static","longname":"Pattern.round","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values set to\\n * their mathematical floor. E.g. \`3.7\` replaced with to \`3\`, and \`-4.2\`\\n * replaced with \`-5\`.\\n * @name floor\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"42 42.1 42.5 43\\".floor())\\n */","meta":{"filename":"pattern.mjs","lineno":1699,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values set to\\ntheir mathematical floor. E.g. <code>3.7</code> replaced with to <code>3</code>, and <code>-4.2</code>\\nreplaced with <code>-5</code>.</p>","name":"floor","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"42 42.1 42.5 43\\".floor())"],"scope":"static","longname":"Pattern.floor","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values set to\\n * their mathematical ceiling. E.g. \`3.2\` replaced with \`4\`, and \`-4.2\`\\n * replaced with \`-4\`.\\n * @name ceil\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"42 42.1 42.5 43\\".ceil())\\n */","meta":{"filename":"pattern.mjs","lineno":1713,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values set to\\ntheir mathematical ceiling. E.g. <code>3.2</code> replaced with <code>4</code>, and <code>-4.2</code>\\nreplaced with <code>-4</code>.</p>","name":"ceil","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"42 42.1 42.5 43\\".ceil())"],"scope":"static","longname":"Pattern.ceil","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 ..\\n * 1. Returns a new pattern with values scaled to the bipolar range -1 .. 1\\n * @returns Pattern\\n * @noAutocomplete\\n */","meta":{"range":[52512,52616],"filename":"pattern.mjs","lineno":1732,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030406","name":"exports.toBipolar","type":"VariableDeclaration"}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 ..</p>\\n<ol>\\n<li>Returns a new pattern with values scaled to the bipolar range -1 .. 1</li>\\n</ol>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"toBipolar","longname":"toBipolar","kind":"constant","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\n * Returns a new pattern with values scaled to the unipolar range 0 .. 1\\n * @returns Pattern\\n * @noAutocomplete\\n */","meta":{"range":[52817,52927],"filename":"pattern.mjs","lineno":1742,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030428","name":"exports.fromBipolar","type":"VariableDeclaration"}},"description":"<p>Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\nReturns a new pattern with values scaled to the unipolar range 0 .. 1</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"fromBipolar","longname":"fromBipolar","kind":"constant","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 .. 1.\\n * Returns a new pattern with values scaled to the given min/max range.\\n * Most useful in combination with continuous patterns.\\n * @name range\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine.range(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1746,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 .. 1.\\nReturns a new pattern with values scaled to the given min/max range.\\nMost useful in combination with continuous patterns.</p>","name":"range","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine.range(500,4000))"],"scope":"static","longname":"Pattern.range","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 .. 1\\n * Returns a new pattern with values scaled to the given min/max range,\\n * following an exponential curve.\\n * @name rangex\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine.rangex(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1761,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 .. 1\\nReturns a new pattern with values scaled to the given min/max range,\\nfollowing an exponential curve.</p>","name":"rangex","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine.rangex(500,4000))"],"scope":"static","longname":"Pattern.rangex","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\n * Returns a new pattern with values scaled to the given min/max range.\\n * @name range2\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine2.range2(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1776,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\nReturns a new pattern with values scaled to the given min/max range.</p>","name":"range2","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine2.range2(500,4000))"],"scope":"static","longname":"Pattern.range2","kind":"member"},{"comment":"/**\\n * Allows dividing numbers via list notation using \\":\\".\\n * Returns a new pattern with just numbers.\\n * @name ratio\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * ratio(\\"1, 5:4, 3:2\\").mul(110)\\n * .freq().s(\\"piano\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1790,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows dividing numbers via list notation using &quot;:&quot;.\\nReturns a new pattern with just numbers.</p>","name":"ratio","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["ratio(\\"1, 5:4, 3:2\\").mul(110)\\n.freq().s(\\"piano\\")"],"scope":"static","longname":"Pattern.ratio","kind":"member"},{"comment":"/** Compress each cycle into the given timespan, leaving a gap\\n * @example\\n * cat(\\n *   s(\\"bd sd\\").compress(.25,.75),\\n *   s(\\"~ bd sd ~\\")\\n * )\\n */","meta":{"range":[54920,55173],"filename":"pattern.mjs","lineno":1819,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030573","name":"exports.compress","type":"VariableDeclaration"}},"description":"<p>Compress each cycle into the given timespan, leaving a gap</p>","examples":["cat(\\n  s(\\"bd sd\\").compress(.25,.75),\\n  s(\\"~ bd sd ~\\")\\n)"],"name":"compress","longname":"compress","kind":"constant","scope":"global"},{"comment":"/**\\n * speeds up a pattern like fast, but rather than it playing multiple times as fast would it instead leaves a gap in the remaining space of the cycle. For example, the following will play the sound pattern \\"bd sn\\" only once but compressed into the first half of the cycle, i.e. twice as fast.\\n * @name fastGap\\n * @synonyms fastgap\\n * @example\\n * s(\\"bd sd\\").fastGap(2)\\n */","meta":{"filename":"pattern.mjs","lineno":1832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>speeds up a pattern like fast, but rather than it playing multiple times as fast would it instead leaves a gap in the remaining space of the cycle. For example, the following will play the sound pattern &quot;bd sn&quot; only once but compressed into the first half of the cycle, i.e. twice as fast.</p>","name":"fastGap","synonyms_text":"fastgap","synonyms":["fastgap"],"examples":["s(\\"bd sd\\").fastGap(2)"],"longname":"fastGap","kind":"member","scope":"global"},{"comment":"/**\\n * Similar to \`compress\`, but doesn't leave gaps, and the 'focus' can be bigger than a cycle\\n * @example\\n * s(\\"bd hh sd hh\\").focus(1/4, 3/4)\\n */","meta":{"range":[57064,57254],"filename":"pattern.mjs","lineno":1874,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030915","name":"exports.focus","type":"VariableDeclaration"}},"description":"<p>Similar to <code>compress</code>, but doesn't leave gaps, and the 'focus' can be bigger than a cycle</p>","examples":["s(\\"bd hh sd hh\\").focus(1/4, 3/4)"],"name":"focus","longname":"focus","kind":"constant","scope":"global"},{"comment":"/** The ply function repeats each event the given number of times.\\n * @example\\n * s(\\"bd ~ sd cp\\").ply(\\"<1 2 3>\\")\\n */","meta":{"range":[57521,57752],"filename":"pattern.mjs","lineno":1891,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030994","name":"exports.ply","type":"VariableDeclaration"}},"description":"<p>The ply function repeats each event the given number of times.</p>","examples":["s(\\"bd ~ sd cp\\").ply(\\"<1 2 3>\\")"],"name":"ply","longname":"ply","kind":"constant","scope":"global"},{"comment":"/**\\n * Speed up a pattern by the given factor. Used by \\"*\\" in mini notation.\\n *\\n * @name fast\\n * @synonyms density\\n * @memberof Pattern\\n * @param {number | Pattern} factor speed up factor\\n * @returns Pattern\\n * @example\\n * s(\\"bd hh sd hh\\").fast(2) // s(\\"[bd hh sd hh]*2\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1899,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Speed up a pattern by the given factor. Used by &quot;*&quot; in mini notation.</p>","name":"fast","synonyms_text":"density","synonyms":["density"],"memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>speed up factor</p>","name":"factor"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd hh sd hh\\").fast(2) // s(\\"[bd hh sd hh]*2\\")"],"scope":"static","longname":"Pattern.fast","kind":"member"},{"comment":"/**\\n * Both speeds up the pattern (like 'fast') and the sample playback (like 'speed').\\n * @example\\n * s(\\"bd sd:2\\").hurry(\\"<1 2 4 3>\\").slow(1.5)\\n */","meta":{"range":[58520,58629],"filename":"pattern.mjs","lineno":1929,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031107","name":"exports.hurry","type":"VariableDeclaration"}},"description":"<p>Both speeds up the pattern (like 'fast') and the sample playback (like 'speed').</p>","examples":["s(\\"bd sd:2\\").hurry(\\"<1 2 4 3>\\").slow(1.5)"],"name":"hurry","longname":"hurry","kind":"constant","scope":"global"},{"comment":"/**\\n * Slow down a pattern over the given number of cycles. Like the \\"/\\" operator in mini notation.\\n *\\n * @name slow\\n * @synonyms sparsity\\n * @memberof Pattern\\n * @param {number | Pattern} factor slow down factor\\n * @returns Pattern\\n * @example\\n * s(\\"bd hh sd hh\\").slow(2) // s(\\"[bd hh sd hh]/2\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1933,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slow down a pattern over the given number of cycles. Like the &quot;/&quot; operator in mini notation.</p>","name":"slow","synonyms_text":"sparsity","synonyms":["sparsity"],"memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>slow down factor</p>","name":"factor"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd hh sd hh\\").slow(2) // s(\\"[bd hh sd hh]/2\\")"],"scope":"static","longname":"Pattern.slow","kind":"member"},{"comment":"/**\\n * Carries out an operation 'inside' a cycle.\\n * @example\\n * \\"0 1 2 3 4 3 2 1\\".inside(4, rev).scale('C major').note()\\n * // \\"0 1 2 3 4 3 2 1\\".slow(4).rev().fast(4).scale('C major').note()\\n */","meta":{"range":[59314,59431],"filename":"pattern.mjs","lineno":1957,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031168","name":"exports.inside","type":"VariableDeclaration"}},"description":"<p>Carries out an operation 'inside' a cycle.</p>","examples":["\\"0 1 2 3 4 3 2 1\\".inside(4, rev).scale('C major').note()\\n// \\"0 1 2 3 4 3 2 1\\".slow(4).rev().fast(4).scale('C major').note()"],"name":"inside","longname":"inside","kind":"constant","scope":"global"},{"comment":"/**\\n * Carries out an operation 'outside' a cycle.\\n * @example\\n * \\"<[0 1] 2 [3 4] 5>\\".outside(4, rev).scale('C major').note()\\n * // \\"<[0 1] 2 [3 4] 5>\\".fast(4).rev().slow(4).scale('C major').note()\\n */","meta":{"range":[59635,59754],"filename":"pattern.mjs","lineno":1967,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031192","name":"exports.outside","type":"VariableDeclaration"}},"description":"<p>Carries out an operation 'outside' a cycle.</p>","examples":["\\"<[0 1] 2 [3 4] 5>\\".outside(4, rev).scale('C major').note()\\n// \\"<[0 1] 2 [3 4] 5>\\".fast(4).rev().slow(4).scale('C major').note()"],"name":"outside","longname":"outside","kind":"constant","scope":"global"},{"comment":"/**\\n * Applies the given function every n cycles, starting from the last cycle.\\n * @name lastOf\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").lastOf(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1971,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function every n cycles, starting from the last cycle.</p>","name":"lastOf","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").lastOf(4, x=>x.rev())"],"scope":"static","longname":"Pattern.lastOf","kind":"member"},{"comment":"/**\\n * Applies the given function every n cycles, starting from the first cycle.\\n * @name firstOf\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").firstOf(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1987,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function every n cycles, starting from the first cycle.</p>","name":"firstOf","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").firstOf(4, x=>x.rev())"],"scope":"static","longname":"Pattern.firstOf","kind":"member"},{"comment":"/**\\n * An alias for \`firstOf\`\\n * @name every\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").every(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1998,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>An alias for <code>firstOf</code></p>","name":"every","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").every(4, x=>x.rev())"],"scope":"static","longname":"Pattern.every","kind":"member"},{"comment":"/**\\n * Like layer, but with a single function:\\n * @name apply\\n * @memberof Pattern\\n * @example\\n * \\"<c3 eb3 g3>\\".scale('C minor').apply(scaleTranspose(\\"0,2,4\\")).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2014,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like layer, but with a single function:</p>","name":"apply","memberof":"Pattern","examples":["\\"<c3 eb3 g3>\\".scale('C minor').apply(scaleTranspose(\\"0,2,4\\")).note()"],"scope":"static","longname":"Pattern.apply","kind":"member"},{"comment":"/**\\n * Plays the pattern at the given cycles per minute.\\n * @deprecated\\n * @example\\n * s(\\"<bd sd>,hh*2\\").cpm(90) // = 90 bpm\\n */","meta":{"range":[61398,61492],"filename":"pattern.mjs","lineno":2033,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031311","name":"exports.cpm","type":"VariableDeclaration"}},"description":"<p>Plays the pattern at the given cycles per minute.</p>","deprecated":true,"examples":["s(\\"<bd sd>,hh*2\\").cpm(90) // = 90 bpm"],"name":"cpm","longname":"cpm","kind":"constant","scope":"global"},{"comment":"/**\\n * Nudge a pattern to start earlier in time. Equivalent of Tidal's <~ operator\\n *\\n * @name early\\n * @memberof Pattern\\n * @param {number | Pattern} cycles number of cycles to nudge left\\n * @returns Pattern\\n * @example\\n * \\"bd ~\\".stack(\\"hh ~\\".early(.1)).s()\\n */","meta":{"filename":"pattern.mjs","lineno":2037,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Nudge a pattern to start earlier in time. Equivalent of Tidal's &lt;~ operator</p>","name":"early","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>number of cycles to nudge left</p>","name":"cycles"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"bd ~\\".stack(\\"hh ~\\".early(.1)).s()"],"scope":"static","longname":"Pattern.early","kind":"member"},{"comment":"/**\\n * Nudge a pattern to start later in time. Equivalent of Tidal's ~> operator\\n *\\n * @name late\\n * @memberof Pattern\\n * @param {number | Pattern} cycles number of cycles to nudge right\\n * @returns Pattern\\n * @example\\n * \\"bd ~\\".stack(\\"hh ~\\".late(.1)).s()\\n */","meta":{"filename":"pattern.mjs","lineno":2057,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Nudge a pattern to start later in time. Equivalent of Tidal's ~&gt; operator</p>","name":"late","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>number of cycles to nudge right</p>","name":"cycles"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"bd ~\\".stack(\\"hh ~\\".late(.1)).s()"],"scope":"static","longname":"Pattern.late","kind":"member"},{"comment":"/**\\n * Plays a portion of a pattern, specified by the beginning and end of a time span. The new resulting pattern is played over the time period of the original pattern:\\n *\\n * @example\\n * s(\\"bd*2 hh*3 [sd bd]*2 perc\\").zoom(0.25, 0.75)\\n * // s(\\"hh*3 [sd bd]*2\\") // equivalent\\n */","meta":{"range":[62678,63097],"filename":"pattern.mjs","lineno":2084,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031404","name":"exports.zoom","type":"VariableDeclaration"}},"description":"<p>Plays a portion of a pattern, specified by the beginning and end of a time span. The new resulting pattern is played over the time period of the original pattern:</p>","examples":["s(\\"bd*2 hh*3 [sd bd]*2 perc\\").zoom(0.25, 0.75)\\n// s(\\"hh*3 [sd bd]*2\\") // equivalent"],"name":"zoom","longname":"zoom","kind":"constant","scope":"global"},{"comment":"/**\\n * Splits a pattern into the given number of slices, and plays them according to a pattern of slice numbers.\\n * Similar to \`slice\`, but slices up patterns rather than sound samples.\\n * @param {number} number of slices\\n * @param {number} slices to play\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale('c:mixolydian'))\\n *.bite(4, \\"3 2 1 0\\")\\n * @example\\n * sound(\\"bd - bd bd*2, - sd:6 - sd:5 sd:1 - [- sd:2] -, hh [- cp:7]\\")\\n  .bank(\\"RolandTR909\\").speed(1.2)\\n  .bite(4, \\"0 0 [1 2] <3 2> 0 0 [2 1] 3\\")\\n */","meta":{"range":[63730,64028],"filename":"pattern.mjs","lineno":2116,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031529","name":"exports.bite","type":"VariableDeclaration"}},"description":"<p>Splits a pattern into the given number of slices, and plays them according to a pattern of slice numbers.\\nSimilar to <code>slice</code>, but slices up patterns rather than sound samples.</p>","params":[{"type":{"names":["number"]},"description":"<p>of slices</p>","name":"number"},{"type":{"names":["number"]},"description":"<p>to play</p>","name":"slices"}],"examples":["note(\\"0 1 2 3 4 5 6 7\\".scale('c:mixolydian'))\\n.bite(4, \\"3 2 1 0\\")","sound(\\"bd - bd bd*2, - sd:6 - sd:5 sd:1 - [- sd:2] -, hh [- cp:7]\\")\\n  .bank(\\"RolandTR909\\").speed(1.2)\\n  .bite(4, \\"0 0 [1 2] <3 2> 0 0 [2 1] 3\\")"],"name":"bite","longname":"bite","kind":"constant","scope":"global"},{"comment":"/**\\n * Selects the given fraction of the pattern and repeats that part to fill the remainder of the cycle.\\n * @param {number} fraction fraction to select\\n * @example\\n * s(\\"lt ht mt cp, [hh oh]*2\\").linger(\\"<1 .5 .25 .125>\\")\\n */","meta":{"range":[64257,64499],"filename":"pattern.mjs","lineno":2137,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031594","name":"exports.linger","type":"VariableDeclaration"}},"description":"<p>Selects the given fraction of the pattern and repeats that part to fill the remainder of the cycle.</p>","params":[{"type":{"names":["number"]},"description":"<p>fraction to select</p>","name":"fraction"}],"examples":["s(\\"lt ht mt cp, [hh oh]*2\\").linger(\\"<1 .5 .25 .125>\\")"],"name":"linger","longname":"linger","kind":"constant","scope":"global"},{"comment":"/**\\n * Samples the pattern at a rate of n events per cycle. Useful for turning a continuous pattern into a discrete one.\\n * @name segment\\n * @synonyms seg\\n * @param {number} segments number of segments per cycle\\n * @example\\n * note(saw.range(40,52).segment(24))\\n */","meta":{"filename":"pattern.mjs","lineno":2151,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Samples the pattern at a rate of n events per cycle. Useful for turning a continuous pattern into a discrete one.</p>","name":"segment","synonyms_text":"seg","synonyms":["seg"],"params":[{"type":{"names":["number"]},"description":"<p>number of segments per cycle</p>","name":"segments"}],"examples":["note(saw.range(40,52).segment(24))"],"longname":"segment","kind":"member","scope":"global"},{"comment":"/**\\n * The function \`swingBy x n\` breaks each cycle into \`n\` slices, and then delays events in the second half of each slice by the amount \`x\`, which is relative to the size of the (half) slice. So if \`x\` is 0 it does nothing, \`0.5\` delays for half the note duration, and 1 will wrap around to doing nothing again. The end result is a shuffle or swing-like rhythm\\n * @param {number} subdivision\\n * @param {number} offset\\n * @example\\n * s(\\"hh*8\\").swingBy(1/3, 4)\\n */","meta":{"range":[65382,65484],"filename":"pattern.mjs","lineno":2170,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031678","name":"exports.swingBy","type":"VariableDeclaration"}},"description":"<p>The function <code>swingBy x n</code> breaks each cycle into <code>n</code> slices, and then delays events in the second half of each slice by the amount <code>x</code>, which is relative to the size of the (half) slice. So if <code>x</code> is 0 it does nothing, <code>0.5</code> delays for half the note duration, and 1 will wrap around to doing nothing again. The end result is a shuffle or swing-like rhythm</p>","params":[{"type":{"names":["number"]},"name":"subdivision"},{"type":{"names":["number"]},"name":"offset"}],"examples":["s(\\"hh*8\\").swingBy(1/3, 4)"],"name":"swingBy","longname":"swingBy","kind":"constant","scope":"global"},{"comment":"/**\\n * Shorthand for swingBy with 1/3:\\n * @param {number} subdivision\\n * @example\\n * s(\\"hh*8\\").swing(4)\\n * // s(\\"hh*8\\").swingBy(1/3, 4)\\n */","meta":{"range":[65626,65700],"filename":"pattern.mjs","lineno":2179,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031702","name":"exports.swing","type":"VariableDeclaration"}},"description":"<p>Shorthand for swingBy with 1/3:</p>","params":[{"type":{"names":["number"]},"name":"subdivision"}],"examples":["s(\\"hh*8\\").swing(4)\\n// s(\\"hh*8\\").swingBy(1/3, 4)"],"name":"swing","longname":"swing","kind":"constant","scope":"global"},{"comment":"/**\\n * Swaps 1s and 0s in a binary pattern.\\n * @name invert\\n * @synonyms inv\\n * @example\\n * s(\\"bd\\").struct(\\"1 0 0 1 0 0 1 0\\".lastOf(4, invert))\\n */","meta":{"filename":"pattern.mjs","lineno":2181,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Swaps 1s and 0s in a binary pattern.</p>","name":"invert","synonyms_text":"inv","synonyms":["inv"],"examples":["s(\\"bd\\").struct(\\"1 0 0 1 0 0 1 0\\".lastOf(4, invert))"],"longname":"invert","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the given function whenever the given pattern is in a true state.\\n * @name when\\n * @memberof Pattern\\n * @param {Pattern} binary_pat\\n * @param {function} func\\n * @returns Pattern\\n * @example\\n * \\"c3 eb3 g3\\".when(\\"<0 1>/2\\", x=>x.sub(\\"5\\")).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2198,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function whenever the given pattern is in a true state.</p>","name":"when","memberof":"Pattern","params":[{"type":{"names":["Pattern"]},"name":"binary_pat"},{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"c3 eb3 g3\\".when(\\"<0 1>/2\\", x=>x.sub(\\"5\\")).note()"],"scope":"static","longname":"Pattern.when","kind":"member"},{"comment":"/**\\n * Superimposes the function result on top of the original pattern, delayed by the given time.\\n * @name off\\n * @memberof Pattern\\n * @param {Pattern | number} time offset time\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * \\"c3 eb3 g3\\".off(1/8, x=>x.add(7)).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimposes the function result on top of the original pattern, delayed by the given time.</p>","name":"off","memberof":"Pattern","params":[{"type":{"names":["Pattern","number"]},"description":"<p>offset time</p>","name":"time"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"c3 eb3 g3\\".off(1/8, x=>x.add(7)).note()"],"scope":"static","longname":"Pattern.off","kind":"member"},{"comment":"/**\\n * Returns a new pattern where every other cycle is played once, twice as\\n * fast, and offset in time by one quarter of a cycle. Creates a kind of\\n * breakbeat feel.\\n * @returns Pattern\\n */","meta":{"range":[67010,67148],"filename":"pattern.mjs","lineno":2232,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031789","name":"exports.brak","type":"VariableDeclaration"}},"description":"<p>Returns a new pattern where every other cycle is played once, twice as\\nfast, and offset in time by one quarter of a cycle. Creates a kind of\\nbreakbeat feel.</p>","returns":[{"description":"<p>Pattern</p>"}],"name":"brak","longname":"brak","kind":"constant","scope":"global"},{"comment":"/**\\n * Reverse all haps in a pattern\\n *\\n * @name rev\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"c d e g\\").rev()\\n */","meta":{"filename":"pattern.mjs","lineno":2236,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverse all haps in a pattern</p>","name":"rev","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c d e g\\").rev()"],"scope":"static","longname":"Pattern.rev","kind":"member"},{"comment":"/** Like press, but allows you to specify the amount by which each\\n * event is shifted. pressBy(0.5) is the same as press, while\\n * pressBy(1/3) shifts each event by a third of its timespan.\\n * @example\\n * stack(s(\\"hh*4\\"),\\n *       s(\\"bd mt sd ht\\").pressBy(\\"<0 0.5 0.25>\\")\\n *      ).slow(2)\\n */","meta":{"range":[68356,68486],"filename":"pattern.mjs","lineno":2277,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031939","name":"exports.pressBy","type":"VariableDeclaration"}},"description":"<p>Like press, but allows you to specify the amount by which each\\nevent is shifted. pressBy(0.5) is the same as press, while\\npressBy(1/3) shifts each event by a third of its timespan.</p>","examples":["stack(s(\\"hh*4\\"),\\n      s(\\"bd mt sd ht\\").pressBy(\\"<0 0.5 0.25>\\")\\n     ).slow(2)"],"name":"pressBy","longname":"pressBy","kind":"constant","scope":"global"},{"comment":"/**\\n * Syncopates a rhythm, by shifting each event halfway into its timespan.\\n * @example\\n * stack(s(\\"hh*4\\"),\\n *       s(\\"bd mt sd ht\\").every(4, press)\\n *      ).slow(2)\\n */","meta":{"range":[68662,68749],"filename":"pattern.mjs","lineno":2288,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031968","name":"exports.press","type":"VariableDeclaration"}},"description":"<p>Syncopates a rhythm, by shifting each event halfway into its timespan.</p>","examples":["stack(s(\\"hh*4\\"),\\n      s(\\"bd mt sd ht\\").every(4, press)\\n     ).slow(2)"],"name":"press","longname":"press","kind":"constant","scope":"global"},{"comment":"/**\\n * Silences a pattern.\\n * @example\\n * stack(\\n *   s(\\"bd\\").hush(),\\n *   s(\\"hh*3\\")\\n * )\\n */","meta":{"range":[68845,68903],"filename":"pattern.mjs","lineno":2300,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031985","name":"Pattern.prototype.hush","type":"FunctionExpression","paramnames":[]}},"description":"<p>Silences a pattern.</p>","examples":["stack(\\n  s(\\"bd\\").hush(),\\n  s(\\"hh*3\\")\\n)"],"name":"hush","longname":"Pattern#hush","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Applies \`rev\` to a pattern every other cycle, so that the pattern alternates between forwards and backwards.\\n * @example\\n * note(\\"c d e g\\").palindrome()\\n */","meta":{"range":[69070,69195],"filename":"pattern.mjs","lineno":2309,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031995","name":"exports.palindrome","type":"VariableDeclaration"}},"description":"<p>Applies <code>rev</code> to a pattern every other cycle, so that the pattern alternates between forwards and backwards.</p>","examples":["note(\\"c d e g\\").palindrome()"],"name":"palindrome","longname":"palindrome","kind":"constant","scope":"global"},{"comment":"/**\\n * Jux with adjustable stereo width. 0 = mono, 1 = full stereo.\\n * @name juxBy\\n * @synonyms juxby\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").juxBy(\\"<0 .5 1>/2\\", rev)\\n */","meta":{"filename":"pattern.mjs","lineno":2318,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Jux with adjustable stereo width. 0 = mono, 1 = full stereo.</p>","name":"juxBy","synonyms_text":"juxby","synonyms":["juxby"],"examples":["s(\\"bd lt [~ ht] mt cp ~ bd hh\\").juxBy(\\"<0 .5 1>/2\\", rev)"],"longname":"juxBy","kind":"member","scope":"global"},{"comment":"/**\\n * The jux function creates strange stereo effects, by applying a function to a pattern, but only in the right-hand channel.\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(rev)\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(press)\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(iter(4))\\n */","meta":{"range":[70214,70310],"filename":"pattern.mjs","lineno":2348,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100032124","name":"exports.jux","type":"VariableDeclaration"}},"description":"<p>The jux function creates strange stereo effects, by applying a function to a pattern, but only in the right-hand channel.</p>","examples":["s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(rev)","s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(press)","s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(iter(4))"],"name":"jux","longname":"jux","kind":"constant","scope":"global"},{"comment":"/**\\n * Superimpose and offset multiple times, applying the given function each time.\\n * @name echoWith\\n * @synonyms echowith, stutWith, stutwith\\n * @param {number} times how many times to repeat\\n * @param {number} time cycle offset between iterations\\n * @param {function} func function to apply, given the pattern and the iteration index\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .echoWith(4, 1/8, (p,n) => p.add(n*2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2352,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimpose and offset multiple times, applying the given function each time.</p>","name":"echoWith","synonyms_text":"echowith, stutWith, stutwith","synonyms":["echowith","stutWith","stutwith"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern and the iteration index</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.echoWith(4, 1/8, (p,n) => p.add(n*2))\\n.scale(\\"C:minor\\").note()"],"longname":"echoWith","kind":"member","scope":"global"},{"comment":"/**\\n * Superimpose and offset multiple times, gradually decreasing the velocity\\n * @name echo\\n * @memberof Pattern\\n * @returns Pattern\\n * @param {number} times how many times to repeat\\n * @param {number} time cycle offset between iterations\\n * @param {number} feedback velocity multiplicator for each iteration\\n * @example\\n * s(\\"bd sd\\").echo(3, 1/6, .8)\\n */","meta":{"filename":"pattern.mjs","lineno":2371,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimpose and offset multiple times, gradually decreasing the velocity</p>","name":"echo","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"},{"type":{"names":["number"]},"description":"<p>velocity multiplicator for each iteration</p>","name":"feedback"}],"examples":["s(\\"bd sd\\").echo(3, 1/6, .8)"],"scope":"static","longname":"Pattern.echo","kind":"member"},{"comment":"/**\\n * Deprecated. Like echo, but the last 2 parameters are flipped.\\n * @name stut\\n * @param {number} times how many times to repeat\\n * @param {number} feedback velocity multiplicator for each iteration\\n * @param {number} time cycle offset between iterations\\n * @example\\n * s(\\"bd sd\\").stut(3, .8, 1/6)\\n */","meta":{"filename":"pattern.mjs","lineno":2386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Deprecated. Like echo, but the last 2 parameters are flipped.</p>","name":"stut","params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>velocity multiplicator for each iteration</p>","name":"feedback"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"}],"examples":["s(\\"bd sd\\").stut(3, .8, 1/6)"],"longname":"stut","kind":"member","scope":"global"},{"comment":"/**\\n * The plyWith function repeats each event the given number of times, applying the given function to each event.\\\\n\\n * @name plyWith\\n * @synonyms plywith\\n * @param {number} factor how many times to repeat\\n * @param {function} func function to apply, given the pattern\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .plyWith(4, (p) => p.add(2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2407,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The plyWith function repeats each event the given number of times, applying the given function to each event.\\\\n</p>","name":"plyWith","synonyms_text":"plywith","synonyms":["plywith"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"factor"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.plyWith(4, (p) => p.add(2))\\n.scale(\\"C:minor\\").note()"],"longname":"plyWith","kind":"member","scope":"global"},{"comment":"/**\\n * The plyForEach function repeats each event the given number of times, applying the given function to each event.\\n * This version of ply uses the iteration index as an argument to the function, similar to echoWith.\\n * @name plyForEach\\n * @synonyms plyforeach\\n * @param {number} factor how many times to repeat\\n * @param {function} func function to apply, given the pattern and the iteration index\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .plyForEach(4, (p,n) => p.add(n*2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2428,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The plyForEach function repeats each event the given number of times, applying the given function to each event.\\nThis version of ply uses the iteration index as an argument to the function, similar to echoWith.</p>","name":"plyForEach","synonyms_text":"plyforeach","synonyms":["plyforeach"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"factor"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern and the iteration index</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.plyForEach(4, (p,n) => p.add(n*2))\\n.scale(\\"C:minor\\").note()"],"longname":"plyForEach","kind":"member","scope":"global"},{"comment":"/**\\n * Divides a pattern into a given number of subdivisions, plays the subdivisions in order, but increments the starting subdivision each cycle. The pattern wraps to the first subdivision after the last subdivision is played.\\n * @name iter\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"0 1 2 3\\".scale('A minor')).iter(4)\\n */","meta":{"filename":"pattern.mjs","lineno":2450,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides a pattern into a given number of subdivisions, plays the subdivisions in order, but increments the starting subdivision each cycle. The pattern wraps to the first subdivision after the last subdivision is played.</p>","name":"iter","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"0 1 2 3\\".scale('A minor')).iter(4)"],"scope":"static","longname":"Pattern.iter","kind":"member"},{"comment":"/**\\n * Like \`iter\`, but plays the subdivisions in reverse order. Known as iter' in tidalcycles\\n * @name iterBack\\n * @synonyms iterback\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"0 1 2 3\\".scale('A minor')).iterBack(4)\\n */","meta":{"filename":"pattern.mjs","lineno":2477,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>iter</code>, but plays the subdivisions in reverse order. Known as iter' in tidalcycles</p>","name":"iterBack","synonyms_text":"iterback","synonyms":["iterback"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"0 1 2 3\\".scale('A minor')).iterBack(4)"],"scope":"static","longname":"Pattern.iterBack","kind":"member"},{"comment":"/**\\n * Repeats each cycle the given number of times.\\n * @name repeatCycles\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(irand(12).add(34)).segment(4).repeatCycles(2).s(\\"gm_acoustic_guitar_nylon\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2495,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Repeats each cycle the given number of times.</p>","name":"repeatCycles","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(irand(12).add(34)).segment(4).repeatCycles(2).s(\\"gm_acoustic_guitar_nylon\\")"],"scope":"static","longname":"Pattern.repeatCycles","kind":"member"},{"comment":"/**\\n * Divides a pattern into a given number of parts, then cycles through those parts in turn, applying the given function to each part in turn (one part per cycle).\\n * @name chunk\\n * @synonyms slowChunk, slowchunk\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"0 1 2 3\\".chunk(4, x=>x.add(7))\\n * .scale(\\"A:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2518,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides a pattern into a given number of parts, then cycles through those parts in turn, applying the given function to each part in turn (one part per cycle).</p>","name":"chunk","synonyms_text":"slowChunk, slowchunk","synonyms":["slowChunk","slowchunk"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2 3\\".chunk(4, x=>x.add(7))\\n.scale(\\"A:minor\\").note()"],"scope":"static","longname":"Pattern.chunk","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but cycles through the parts in reverse order. Known as chunk' in tidalcycles\\n * @name chunkBack\\n * @synonyms chunkback\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"0 1 2 3\\".chunkBack(4, x=>x.add(7))\\n * .scale(\\"A:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2549,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but cycles through the parts in reverse order. Known as chunk' in tidalcycles</p>","name":"chunkBack","synonyms_text":"chunkback","synonyms":["chunkback"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2 3\\".chunkBack(4, x=>x.add(7))\\n.scale(\\"A:minor\\").note()"],"scope":"static","longname":"Pattern.chunkBack","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but the cycles of the source pattern aren't repeated\\n * for each set of chunks.\\n * @name fastChunk\\n * @synonyms fastchunk\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"<0 8> 1 2 3 4 5 6 7\\"\\n * .fastChunk(4, x => x.color('red')).slow(2)\\n * .scale(\\"C2:major\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2568,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but the cycles of the source pattern aren't repeated\\nfor each set of chunks.</p>","name":"fastChunk","synonyms_text":"fastchunk","synonyms":["fastchunk"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 8> 1 2 3 4 5 6 7\\"\\n.fastChunk(4, x => x.color('red')).slow(2)\\n.scale(\\"C2:major\\").note()"],"scope":"static","longname":"Pattern.fastChunk","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but the function is applied to a looped subcycle of the source pattern.\\n * @name chunkInto\\n * @synonyms chunkinto\\n * @memberof Pattern\\n * @example\\n * sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n *   .bank(\\"tr909\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2589,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but the function is applied to a looped subcycle of the source pattern.</p>","name":"chunkInto","synonyms_text":"chunkinto","synonyms":["chunkinto"],"memberof":"Pattern","examples":["sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n  .bank(\\"tr909\\")"],"scope":"static","longname":"Pattern.chunkInto","kind":"member"},{"comment":"/**\\n * Like \`chunkInto\`, but moves backwards through the chunks.\\n * @name chunkBackInto\\n * @synonyms chunkbackinto\\n * @memberof Pattern\\n * @example\\n * sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n *   .bank(\\"tr909\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2602,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunkInto</code>, but moves backwards through the chunks.</p>","name":"chunkBackInto","synonyms_text":"chunkbackinto","synonyms":["chunkbackinto"],"memberof":"Pattern","examples":["sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n  .bank(\\"tr909\\")"],"scope":"static","longname":"Pattern.chunkBackInto","kind":"member"},{"comment":"/**\\n * Loops the pattern inside an \`offset\` for \`cycles\`.\\n * If you think of the entire span of time in cycles as a ribbon, you can cut a single piece and loop it.\\n * @name ribbon\\n * @synonyms rib\\n * @param {number} offset start point of loop in cycles\\n * @param {number} cycles loop length in cycles\\n * @example\\n * note(\\"<c d e f>\\").ribbon(1, 2)\\n * @example\\n * // Looping a portion of randomness\\n * n(irand(8).segment(4)).scale(\\"c:pentatonic\\").ribbon(1337, 2)\\n * @example\\n * // rhythm generator\\n * s(\\"bd!16?\\").ribbon(29,.5)\\n */","meta":{"filename":"pattern.mjs","lineno":2631,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Loops the pattern inside an <code>offset</code> for <code>cycles</code>.\\nIf you think of the entire span of time in cycles as a ribbon, you can cut a single piece and loop it.</p>","name":"ribbon","synonyms_text":"rib","synonyms":["rib"],"params":[{"type":{"names":["number"]},"description":"<p>start point of loop in cycles</p>","name":"offset"},{"type":{"names":["number"]},"description":"<p>loop length in cycles</p>","name":"cycles"}],"examples":["note(\\"<c d e f>\\").ribbon(1, 2)","// Looping a portion of randomness\\nn(irand(8).segment(4)).scale(\\"c:pentatonic\\").ribbon(1337, 2)","// rhythm generator\\ns(\\"bd!16?\\").ribbon(29,.5)"],"longname":"ribbon","kind":"member","scope":"global"},{"comment":"/**\\n * Tags each Hap with an identifier. Good for filtering. The function populates Hap.context.tags (Array).\\n * @name tag\\n * @noAutocomplete\\n * @param {string} tag anything unique\\n */","meta":{"filename":"pattern.mjs","lineno":2659,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Tags each Hap with an identifier. Good for filtering. The function populates Hap.context.tags (Array).</p>","name":"tag","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"params":[{"type":{"names":["string"]},"description":"<p>anything unique</p>","name":"tag"}],"longname":"tag","kind":"member","scope":"global"},{"comment":"/**\\n * Filters haps using the given function\\n * @name filter\\n * @param {Function} test function to test Hap\\n * @example\\n * s(\\"hh!7 oh\\").filter(hap => hap.value.s==='hh')\\n */","meta":{"filename":"pattern.mjs","lineno":2669,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filters haps using the given function</p>","name":"filter","params":[{"type":{"names":["function"]},"description":"<p>function to test Hap</p>","name":"test"}],"examples":["s(\\"hh!7 oh\\").filter(hap => hap.value.s==='hh')"],"longname":"filter","kind":"member","scope":"global"},{"comment":"/**\\n * Filters haps by their begin time\\n * @name filterWhen\\n * @noAutocomplete\\n * @param {Function} test function to test Hap.whole.begin\\n */","meta":{"filename":"pattern.mjs","lineno":2678,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filters haps by their begin time</p>","name":"filterWhen","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"params":[{"type":{"names":["function"]},"description":"<p>function to test Hap.whole.begin</p>","name":"test"}],"longname":"filterWhen","kind":"member","scope":"global"},{"comment":"/**\\n * Use within to apply a function to only a part of a pattern.\\n * @name within\\n * @param {number} start start within cycle (0 - 1)\\n * @param {number} end end within cycle (0 - 1). Must be > start\\n * @param {Function} func function to be applied to the sub-pattern\\n */","meta":{"filename":"pattern.mjs","lineno":2686,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Use within to apply a function to only a part of a pattern.</p>","name":"within","params":[{"type":{"names":["number"]},"description":"<p>start within cycle (0 - 1)</p>","name":"start"},{"type":{"names":["number"]},"description":"<p>end within cycle (0 - 1). Must be &gt; start</p>","name":"end"},{"type":{"names":["function"]},"description":"<p>function to be applied to the sub-pattern</p>","name":"func"}],"longname":"within","kind":"member","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Speeds a pattern up or down, to fit to the given number of steps per cycle.\\n * @example\\n * sound(\\"bd sd cp\\").pace(4)\\n * // The same as sound(\\"{bd sd cp}%4\\") or sound(\\"<bd sd cp>*4\\")\\n */","meta":{"range":[83036,83331],"filename":"pattern.mjs","lineno":2767,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100033504","name":"exports.pace","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Speeds a pattern up or down, to fit to the given number of steps per cycle.</p>","examples":["sound(\\"bd sd cp\\").pace(4)\\n// The same as sound(\\"{bd sd cp}%4\\") or sound(\\"<bd sd cp>*4\\")"],"name":"pace","longname":"pace","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Aligns the steps of the patterns, creating polymeters. The patterns are repeated until they all fit the cycle. For example, in the below the first pattern is repeated twice, and the second is repeated three times, to fit the lowest common multiple of six steps.\\n * @synonyms pm\\n * @example\\n * // The same as note(\\"{c eb g, c2 g2}%6\\")\\n * polymeter(\\"c eb g\\", \\"c2 g2\\").note()\\n *\\n */","meta":{"range":[84209,84717],"filename":"pattern.mjs","lineno":2810,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100033657","name":"exports.polymeter","type":"FunctionDeclaration","paramnames":["args"]}},"description":"<p><em>Experimental</em></p>\\n<p>Aligns the steps of the patterns, creating polymeters. The patterns are repeated until they all fit the cycle. For example, in the below the first pattern is repeated twice, and the second is repeated three times, to fit the lowest common multiple of six steps.</p>","synonyms_text":"pm","synonyms":["pm"],"examples":["// The same as note(\\"{c eb g, c2 g2}%6\\")\\npolymeter(\\"c eb g\\", \\"c2 g2\\").note()"],"name":"polymeter","longname":"polymeter","kind":"function","scope":"global"},{"comment":"/** 'Concatenates' patterns like \`fastcat\`, but proportional to a number of steps per cycle.\\n * The steps can either be inferred from the pattern, or provided as a [length, pattern] pair.\\n * Has the alias \`timecat\`.\\n * @name stepcat\\n * @synonyms timeCat, timecat\\n * @return {Pattern}\\n * @example\\n * stepcat([3,\\"e3\\"],[1, \\"g3\\"]).note()\\n * // the same as \\"e3@3 g3\\".note()\\n * @example\\n * stepcat(\\"bd sd cp\\",\\"hh hh\\").sound()\\n * // the same as \\"bd sd cp hh hh\\".sound()\\n */","meta":{"filename":"pattern.mjs","lineno":2832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>'Concatenates' patterns like <code>fastcat</code>, but proportional to a number of steps per cycle.\\nThe steps can either be inferred from the pattern, or provided as a [length, pattern] pair.\\nHas the alias <code>timecat</code>.</p>","name":"stepcat","synonyms_text":"timeCat, timecat","synonyms":["timeCat","timecat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["stepcat([3,\\"e3\\"],[1, \\"g3\\"]).note()\\n// the same as \\"e3@3 g3\\".note()","stepcat(\\"bd sd cp\\",\\"hh hh\\").sound()\\n// the same as \\"bd sd cp hh hh\\".sound()"],"longname":"stepcat","kind":"member","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Concatenates patterns stepwise, according to an inferred 'steps per cycle'.\\n * Similar to \`stepcat\`, but if an argument is a list, the whole pattern will alternate between the elements in the list.\\n *\\n * @return {Pattern}\\n * @example\\n * stepalt([\\"bd cp\\", \\"mt\\"], \\"bd\\").sound()\\n * // The same as \\"bd cp bd mt bd\\".sound()\\n */","meta":{"range":[86781,87328],"filename":"pattern.mjs","lineno":2898,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034028","name":"exports.stepalt","type":"FunctionDeclaration","paramnames":["groups"]}},"description":"<p><em>Experimental</em></p>\\n<p>Concatenates patterns stepwise, according to an inferred 'steps per cycle'.\\nSimilar to <code>stepcat</code>, but if an argument is a list, the whole pattern will alternate between the elements in the list.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["stepalt([\\"bd cp\\", \\"mt\\"], \\"bd\\").sound()\\n// The same as \\"bd cp bd mt bd\\".sound()"],"name":"stepalt","longname":"stepalt","kind":"function","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Takes the given number of steps from a pattern (dropping the rest).\\n * A positive number will take steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"bd cp ht mt\\".take(\\"2\\").sound()\\n * // The same as \\"bd cp\\".sound()\\n * @example\\n * \\"bd cp ht mt\\".take(\\"1 2 3\\").sound()\\n * // The same as \\"bd bd cp bd cp ht\\".sound()\\n * @example\\n * \\"bd cp ht mt\\".take(\\"-1 -2 -3\\").sound()\\n * // The same as \\"mt ht mt cp ht mt\\".sound()\\n */","meta":{"range":[87831,88323],"filename":"pattern.mjs","lineno":2930,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034169","name":"exports.take","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Takes the given number of steps from a pattern (dropping the rest).\\nA positive number will take steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"bd cp ht mt\\".take(\\"2\\").sound()\\n// The same as \\"bd cp\\".sound()","\\"bd cp ht mt\\".take(\\"1 2 3\\").sound()\\n// The same as \\"bd bd cp bd cp ht\\".sound()","\\"bd cp ht mt\\".take(\\"-1 -2 -3\\").sound()\\n// The same as \\"mt ht mt cp ht mt\\".sound()"],"name":"take","longname":"take","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Drops the given number of steps from a pattern.\\n * A positive number will drop steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"1\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"-1\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"0 1 2 3\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"0 -1 -2 -3\\").sound().bank(\\"mridangam\\")\\n */","meta":{"range":[88824,89071],"filename":"pattern.mjs","lineno":2973,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034281","name":"exports.drop","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Drops the given number of steps from a pattern.\\nA positive number will drop steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".drop(\\"1\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"-1\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"0 1 2 3\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"0 -1 -2 -3\\").sound().bank(\\"mridangam\\")"],"name":"drop","longname":"drop","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * \`extend\` is similar to \`fast\` in that it increases its density, but it also increases the step count\\n * accordingly. So \`stepcat(\\"a b\\".extend(2), \\"c d\\")\` would be the same as \`\\"a b a b c d\\"\`, whereas\\n * \`stepcat(\\"a b\\".fast(2), \\"c d\\")\` would be the same as \`\\"[a b] [a b] c d\\"\`.\\n * @example\\n * stepcat(\\n *   sound(\\"bd bd - cp\\").extend(2),\\n *   sound(\\"bd - sd -\\")\\n * ).pace(8)\\n */","meta":{"range":[89479,89594],"filename":"pattern.mjs","lineno":2997,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034343","name":"exports.extend","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p><code>extend</code> is similar to <code>fast</code> in that it increases its density, but it also increases the step count\\naccordingly. So <code>stepcat(&quot;a b&quot;.extend(2), &quot;c d&quot;)</code> would be the same as <code>&quot;a b a b c d&quot;</code>, whereas\\n<code>stepcat(&quot;a b&quot;.fast(2), &quot;c d&quot;)</code> would be the same as <code>&quot;[a b] [a b] c d&quot;</code>.</p>","examples":["stepcat(\\n  sound(\\"bd bd - cp\\").extend(2),\\n  sound(\\"bd - sd -\\")\\n).pace(8)"],"name":"extend","longname":"extend","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * \`replicate\` is similar to \`fast\` in that it increases its density, but it also increases the step count\\n * accordingly. So \`stepcat(\\"a b\\".replicate(2), \\"c d\\")\` would be the same as \`\\"a b a b c d\\"\`, whereas\\n * \`stepcat(\\"a b\\".fast(2), \\"c d\\")\` would be the same as \`\\"[a b] [a b] c d\\"\`.\\n *\\n * TODO: find out how this function differs from extend\\n * @example\\n * stepcat(\\n *   sound(\\"bd bd - cp\\").replicate(2),\\n *   sound(\\"bd - sd -\\")\\n * ).pace(8)\\n */","meta":{"range":[90070,90212],"filename":"pattern.mjs","lineno":3015,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034364","name":"exports.replicate","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p><code>replicate</code> is similar to <code>fast</code> in that it increases its density, but it also increases the step count\\naccordingly. So <code>stepcat(&quot;a b&quot;.replicate(2), &quot;c d&quot;)</code> would be the same as <code>&quot;a b a b c d&quot;</code>, whereas\\n<code>stepcat(&quot;a b&quot;.fast(2), &quot;c d&quot;)</code> would be the same as <code>&quot;[a b] [a b] c d&quot;</code>.</p>\\n<p>TODO: find out how this function differs from extend</p>","examples":["stepcat(\\n  sound(\\"bd bd - cp\\").replicate(2),\\n  sound(\\"bd - sd -\\")\\n).pace(8)"],"name":"replicate","longname":"replicate","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Expands the step size of the pattern by the given factor.\\n * @example\\n * sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").expand(\\"3 2 1 1 2 3\\").pace(8)\\n */","meta":{"range":[90393,90522],"filename":"pattern.mjs","lineno":3026,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034389","name":"exports.expand","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Expands the step size of the pattern by the given factor.</p>","examples":["sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").expand(\\"3 2 1 1 2 3\\").pace(8)"],"name":"expand","longname":"expand","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Contracts the step size of the pattern by the given factor. See also \`expand\`.\\n * @example\\n * sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").contract(\\"3 2 1 1 2 3\\").pace(8)\\n */","meta":{"range":[90726,90859],"filename":"pattern.mjs","lineno":3037,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034414","name":"exports.contract","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Contracts the step size of the pattern by the given factor. See also <code>expand</code>.</p>","examples":["sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").contract(\\"3 2 1 1 2 3\\").pace(8)"],"name":"contract","longname":"contract","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Progressively shrinks the pattern by 'n' steps until there's nothing left, or if a second value is given (using mininotation list syntax with \`:\`),\\n * that number of times.\\n * A positive number will progressively drop steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"-1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .shrink(\\"1 -1\\").pace(8)\\n\\n */","meta":{"range":[92508,92890],"filename":"pattern.mjs","lineno":3103,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034654","name":"exports.shrink","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Progressively shrinks the pattern by 'n' steps until there's nothing left, or if a second value is given (using mininotation list syntax with <code>:</code>),\\nthat number of times.\\nA positive number will progressively drop steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".shrink(\\"1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".shrink(\\"-1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".shrink(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)","note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .shrink(\\"1 -1\\").pace(8)"],"name":"shrink","longname":"shrink","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Progressively grows the pattern by 'n' steps until the full pattern is played, or if a second value is given (using mininotation list syntax with \`:\`),\\n * that number of times.\\n * A positive number will progressively grow steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"-1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .grow(\\"1 -1\\").pace(8)\\n */","meta":{"range":[93570,93985],"filename":"pattern.mjs","lineno":3141,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034720","name":"exports.grow","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Progressively grows the pattern by 'n' steps until the full pattern is played, or if a second value is given (using mininotation list syntax with <code>:</code>),\\nthat number of times.\\nA positive number will progressively grow steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".grow(\\"1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".grow(\\"-1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".grow(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)","note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .grow(\\"1 -1\\").pace(8)"],"name":"grow","longname":"grow","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n * \\n * Inserts a pattern into a list of patterns. On the first repetition it will be inserted at the end of the list, then moved backwards through the list \\n * on successive repetitions. The patterns are added together stepwise, with all repetitions taking place over a single cycle. Using \`pace\` to set the \\n * number of steps per cycle is therefore usually recommended.\\n * \\n * @return {Pattern}\\n * @example\\n * \\"[c g]\\".tour(\\"e f\\", \\"e f g\\", \\"g f e c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)\\n */","meta":{"range":[94506,94582],"filename":"pattern.mjs","lineno":3173,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034797","name":"exports.tour","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Inserts a pattern into a list of patterns. On the first repetition it will be inserted at the end of the list, then moved backwards through the list\\non successive repetitions. The patterns are added together stepwise, with all repetitions taking place over a single cycle. Using <code>pace</code> to set the\\nnumber of steps per cycle is therefore usually recommended.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"[c g]\\".tour(\\"e f\\", \\"e f g\\", \\"g f e c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)"],"name":"tour","longname":"tour","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n * \\n * 'zips' together the steps of the provided patterns. This can create a long repetition, taking place over a single, dense cycle. \\n * Using \`pace\` to set the number of steps per cycle is therefore usually recommended.\\n * \\n * @returns {Pattern}\\n * @example\\n * zip(\\"e f\\", \\"e f g\\", \\"g [f e] a f4 c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)\\n */","meta":{"range":[95182,95437],"filename":"pattern.mjs","lineno":3199,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034866","name":"exports.zip","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>'zips' together the steps of the provided patterns. This can create a long repetition, taking place over a single, dense cycle.\\nUsing <code>pace</code> to set the number of steps per cycle is therefore usually recommended.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["zip(\\"e f\\", \\"e f g\\", \\"g [f e] a f4 c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)"],"name":"zip","longname":"zip","kind":"constant","scope":"global"},{"comment":"/** Aliases for \`stepcat\` */","meta":{"range":[95468,95499],"filename":"pattern.mjs","lineno":3207,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034930","name":"exports.timecat","type":"VariableDeclaration"}},"description":"<p>Aliases for <code>stepcat</code></p>","name":"timecat","longname":"timecat","kind":"constant","scope":"global"},{"comment":"/**\\n * Cuts each sample into the given number of parts, allowing you to explore a technique known as 'granular synthesis'.\\n * It turns a pattern of samples into a pattern of parts of samples.\\n * @name chop\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\")\\n *  .chop(4)\\n *  .rev() // reverse order of chops\\n *  .loopAt(2) // fit sample into 2 cycles\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3240,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cuts each sample into the given number of parts, allowing you to explore a technique known as 'granular synthesis'.\\nIt turns a pattern of samples into a pattern of parts of samples.</p>","name":"chop","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\")\\n .chop(4)\\n .rev() // reverse order of chops\\n .loopAt(2) // fit sample into 2 cycles"],"scope":"static","longname":"Pattern.chop","kind":"member"},{"comment":"/**\\n * Cuts each sample into the given number of parts, triggering progressive portions of each sample at each loop.\\n * @name striate\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"numbers:0 numbers:1 numbers:2\\").striate(6).slow(3)\\n */","meta":{"filename":"pattern.mjs","lineno":3271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cuts each sample into the given number of parts, triggering progressive portions of each sample at each loop.</p>","name":"striate","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"numbers:0 numbers:1 numbers:2\\").striate(6).slow(3)"],"scope":"static","longname":"Pattern.striate","kind":"member"},{"comment":"/**\\n * Makes the sample fit the given number of cycles by changing the speed.\\n * @name loopAt\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\").loopAt(2)\\n */","meta":{"filename":"pattern.mjs","lineno":3289,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit the given number of cycles by changing the speed.</p>","name":"loopAt","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\").loopAt(2)"],"scope":"static","longname":"Pattern.loopAt","kind":"member"},{"comment":"/**\\n * Chops samples into the given number of slices, triggering those slices with a given pattern of slice numbers.\\n * Instead of a number, it also accepts a list of numbers from 0 to 1 to slice at specific points.\\n * @name slice\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks165\\").slice(8, \\"0 1 <2 2*2> 3 [4 0] 5 6 7\\".every(3, rev)).slow(0.75)\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks125\\").fit().slice([0,.25,.5,.75], \\"0 1 1 <2 3>\\")\\n */","meta":{"filename":"pattern.mjs","lineno":3306,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Chops samples into the given number of slices, triggering those slices with a given pattern of slice numbers.\\nInstead of a number, it also accepts a list of numbers from 0 to 1 to slice at specific points.</p>","name":"slice","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks165\\").slice(8, \\"0 1 <2 2*2> 3 [4 0] 5 6 7\\".every(3, rev)).slow(0.75)","samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks125\\").fit().slice([0,.25,.5,.75], \\"0 1 1 <2 3>\\")"],"scope":"static","longname":"Pattern.slice","kind":"member"},{"comment":"/**\\n *\\n * make something happen on event time\\n * uses browser timeout which is innacurate for audio tasks\\n * @name onTriggerTime\\n * @memberof Pattern\\n *  @returns Pattern\\n * @example\\n * s(\\"bd!8\\").onTriggerTime((hap) => {console.log(hap)})\\n */","meta":{"filename":"pattern.mjs","lineno":3340,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>make something happen on event time\\nuses browser timeout which is innacurate for audio tasks</p>","name":"onTriggerTime","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd!8\\").onTriggerTime((hap) => {console.log(hap)})"],"scope":"static","longname":"Pattern.onTriggerTime","kind":"member"},{"comment":"/**\\n * Works the same as slice, but changes the playback speed of each slice to match the duration of its step.\\n * @name splice\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks165\\")\\n * .splice(8,  \\"0 1 [2 3 0]@2 3 0@2 7\\")\\n */","meta":{"filename":"pattern.mjs","lineno":3359,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Works the same as slice, but changes the playback speed of each slice to match the duration of its step.</p>","name":"splice","examples":["samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks165\\")\\n.splice(8,  \\"0 1 [2 3 0]@2 3 0@2 7\\")"],"longname":"splice","kind":"member","scope":"global"},{"comment":"/**\\n * Makes the sample fit its event duration. Good for rhythmical loops like drum breaks.\\n * Similar to \`loopAt\`.\\n * @name fit\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes/2\\").fit()\\n */","meta":{"filename":"pattern.mjs","lineno":3395,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit its event duration. Good for rhythmical loops like drum breaks.\\nSimilar to <code>loopAt</code>.</p>","name":"fit","examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes/2\\").fit()"],"longname":"fit","kind":"member","scope":"global"},{"comment":"/**\\n * Makes the sample fit the given number of cycles and cps value, by\\n * changing the speed. Please note that at some point cps will be\\n * given by a global clock and this function will be\\n * deprecated/removed.\\n * @name loopAtCps\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\").loopAtCps(4,1.5).cps(1.5)\\n */","meta":{"filename":"pattern.mjs","lineno":3418,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit the given number of cycles and cps value, by\\nchanging the speed. Please note that at some point cps will be\\ngiven by a global clock and this function will be\\ndeprecated/removed.</p>","name":"loopAtCps","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\").loopAtCps(4,1.5).cps(1.5)"],"scope":"static","longname":"Pattern.loopAtCps","kind":"member"},{"comment":"/** exposes a custom value at query time. basically allows mutating state without evaluation */","meta":{"range":[102969,103069],"filename":"pattern.mjs","lineno":3436,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100035770","name":"exports.ref","type":"VariableDeclaration"}},"description":"<p>exposes a custom value at query time. basically allows mutating state without evaluation</p>","name":"ref","longname":"ref","kind":"constant","scope":"global"},{"comment":"/**\\n * Cross-fades between left and right from 0 to 1:\\n * - 0 = (full left, no right)\\n * - .5 = (both equal)\\n * - 1 = (no left, full right)\\n *\\n * @name xfade\\n * @example\\n * xfade(s(\\"bd*2\\"), \\"<0 .25 .5 .75 1>\\", s(\\"hh*8\\"))\\n */","meta":{"filename":"pattern.mjs","lineno":3443,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cross-fades between left and right from 0 to 1:</p>\\n<ul>\\n<li>0 = (full left, no right)</li>\\n<li>.5 = (both equal)</li>\\n<li>1 = (no left, full right)</li>\\n</ul>","name":"xfade","examples":["xfade(s(\\"bd*2\\"), \\"<0 .25 .5 .75 1>\\", s(\\"hh*8\\"))"],"longname":"xfade","kind":"member","scope":"global"},{"comment":"/**\\n * creates a structure pattern from divisions of a cycle\\n * especially useful for creating rhythms\\n * @name beat\\n * @example\\n * s(\\"bd\\").beat(\\"0,7,10\\", 16)\\n * @example\\n * s(\\"sd\\").beat(\\"4,12\\", 16)\\n */","meta":{"filename":"pattern.mjs","lineno":3467,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>creates a structure pattern from divisions of a cycle\\nespecially useful for creating rhythms</p>","name":"beat","examples":["s(\\"bd\\").beat(\\"0,7,10\\", 16)","s(\\"sd\\").beat(\\"4,12\\", 16)"],"longname":"beat","kind":"member","scope":"global"},{"comment":"/**\\n * Takes two binary rhythms represented as lists of 1s and 0s, and a number\\n * between 0 and 1 that morphs between them. The two lists should contain the same\\n * number of true values.\\n * @example\\n * sound(\\"hh\\").struct(morph([1,0,1,0,1,0,1,0], // straight rhythm\\n *                          [1,1,0,1,0,1,0], // wonky rhythm\\n *                          0.25 // creates a slightly wonky rhythm\\n *                         )\\n *                   )\\n * @example\\n * sound(\\"hh\\").struct(morph(\\"1:0:1:0:1:0:1:0\\", // straight rhythm\\n *                          \\"1:1:0:1:0:1:0\\", // wonky rhythm\\n *                          sine.slow(8) // slowly morph between the rhythms\\n *                         )\\n *                   )\\n */","meta":{"range":[106043,106281],"filename":"pattern.mjs","lineno":3548,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036170","name":"exports.morph","type":"VariableDeclaration"}},"description":"<p>Takes two binary rhythms represented as lists of 1s and 0s, and a number\\nbetween 0 and 1 that morphs between them. The two lists should contain the same\\nnumber of true values.</p>","examples":["sound(\\"hh\\").struct(morph([1,0,1,0,1,0,1,0], // straight rhythm\\n                         [1,1,0,1,0,1,0], // wonky rhythm\\n                         0.25 // creates a slightly wonky rhythm\\n                        )\\n                  )","sound(\\"hh\\").struct(morph(\\"1:0:1:0:1:0:1:0\\", // straight rhythm\\n                         \\"1:1:0:1:0:1:0\\", // wonky rhythm\\n                         sine.slow(8) // slowly morph between the rhythms\\n                        )\\n                  )"],"name":"morph","longname":"morph","kind":"constant","scope":"global"},{"comment":"/**\\n * Soft-clipping distortion\\n *\\n * @name soft\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3555,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Soft-clipping distortion</p>","name":"soft","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"soft","kind":"member","scope":"global"},{"comment":"/**\\n * Hard-clipping distortion\\n *\\n * @name hard\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3563,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Hard-clipping distortion</p>","name":"hard","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"hard","kind":"member","scope":"global"},{"comment":"/**\\n * Cubic polynomial distortion\\n *\\n * @name cubic\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3571,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cubic polynomial distortion</p>","name":"cubic","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"cubic","kind":"member","scope":"global"},{"comment":"/**\\n * Diode-emulating distortion\\n *\\n * @name diode\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3579,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Diode-emulating distortion</p>","name":"diode","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"diode","kind":"member","scope":"global"},{"comment":"/**\\n * Asymmetrical diode distortion\\n *\\n * @name asym\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3587,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Asymmetrical diode distortion</p>","name":"asym","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"asym","kind":"member","scope":"global"},{"comment":"/**\\n * Wavefolding distortion\\n *\\n * @name fold\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3595,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wavefolding distortion</p>","name":"fold","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"fold","kind":"member","scope":"global"},{"comment":"/**\\n * Wavefolding distortion composed with sinusoid\\n *\\n * @name sinefold\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3603,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wavefolding distortion composed with sinusoid</p>","name":"sinefold","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"sinefold","kind":"member","scope":"global"},{"comment":"/**\\n * Distortion via Chebyshev polynomials\\n *\\n * @name chebyshev\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3611,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Distortion via Chebyshev polynomials</p>","name":"chebyshev","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"chebyshev","kind":"member","scope":"global"},{"comment":"/** * Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\n * Similar to \`inhabit\`, but maintains the structure of the original patterns.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(\\"<0 1 2!2 3>\\".pick([\\"g a\\", \\"e f\\", \\"f g f g\\" , \\"g c d\\"]))\\n * @example\\n * sound(\\"<0 1 [2,0]>\\".pick([\\"bd sd\\", \\"cp cp\\", \\"hh hh\\"]))\\n * @example\\n * sound(\\"<0!2 [0,1] 1>\\".pick([\\"bd(3,8)\\", \\"sd sd\\"]))\\n * @example\\n * s(\\"<a!2 [a,b] b>\\".pick({a: \\"bd(3,8)\\", b: \\"sd sd\\"}))\\n */","meta":{"range":[1892,2094],"filename":"pick.mjs","lineno":44,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036387","name":"exports.pick","type":"VariableDeclaration"}},"description":"<p>Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\nSimilar to <code>inhabit</code>, but maintains the structure of the original patterns.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<0 1 2!2 3>\\".pick([\\"g a\\", \\"e f\\", \\"f g f g\\" , \\"g c d\\"]))","sound(\\"<0 1 [2,0]>\\".pick([\\"bd sd\\", \\"cp cp\\", \\"hh hh\\"]))","sound(\\"<0!2 [0,1] 1>\\".pick([\\"bd(3,8)\\", \\"sd sd\\"]))","s(\\"<a!2 [a,b] b>\\".pick({a: \\"bd(3,8)\\", b: \\"sd sd\\"}))"],"name":"pick","longname":"pick","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pick\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * For example, if you pick the fifth pattern of a list of three, you'll get the\\n * second one.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[2519,2637],"filename":"pick.mjs","lineno":65,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036432","name":"exports.pickmod","type":"VariableDeclaration"}},"description":"<p>The same as <code>pick</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.\\nFor example, if you pick the fifth pattern of a list of three, you'll get the\\nsecond one.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmod","longname":"pickmod","kind":"constant","scope":"global"},{"comment":"/** * pickF lets you use a pattern of numbers to pick which function to apply to another pattern.\\n * @param {Pattern} pat\\n * @param {Pattern} lookup a pattern of indices\\n * @param {function[]} funcs the array of functions from which to pull\\n * @returns {Pattern}\\n * @example\\n * s(\\"bd [rim hh]\\").pickF(\\"<0 1 2>\\", [rev,jux(rev),fast(2)])\\n * @example\\n * note(\\"<c2 d2>(3,8)\\").s(\\"square\\")\\n *     .pickF(\\"<0 2> 1\\", [jux(rev),fast(2),x=>x.lpf(800)])\\n */","meta":{"range":[3086,3201],"filename":"pick.mjs","lineno":80,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036452","name":"exports.pickF","type":"VariableDeclaration"}},"description":"<p>pickF lets you use a pattern of numbers to pick which function to apply to another pattern.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["Pattern"]},"description":"<p>a pattern of indices</p>","name":"lookup"},{"type":{"names":["Array.<function()>"]},"description":"<p>the array of functions from which to pull</p>","name":"funcs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["s(\\"bd [rim hh]\\").pickF(\\"<0 1 2>\\", [rev,jux(rev),fast(2)])","note(\\"<c2 d2>(3,8)\\").s(\\"square\\")\\n    .pickF(\\"<0 2> 1\\", [jux(rev),fast(2),x=>x.lpf(800)])"],"name":"pickF","longname":"pickF","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickF\`, but if you pick a number greater than the size of the functions list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {Pattern} lookup a pattern of indices\\n * @param {function[]} funcs the array of functions from which to pull\\n * @returns {Pattern}\\n */","meta":{"range":[3532,3656],"filename":"pick.mjs","lineno":91,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036473","name":"exports.pickmodF","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickF</code>, but if you pick a number greater than the size of the functions list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["Pattern"]},"description":"<p>a pattern of indices</p>","name":"lookup"},{"type":{"names":["Array.<function()>"]},"description":"<p>the array of functions from which to pull</p>","name":"funcs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodF","longname":"pickmodF","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but it applies an outerJoin instead of an innerJoin.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[3803,3922],"filename":"pick.mjs","lineno":100,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036494","name":"exports.pickOut","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but it applies an outerJoin instead of an innerJoin.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickOut","longname":"pickOut","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickOut\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[4143,4267],"filename":"pick.mjs","lineno":110,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036514","name":"exports.pickmodOut","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickOut</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodOut","longname":"pickmodOut","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but the choosen pattern is restarted when its index is triggered.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[4427,4556],"filename":"pick.mjs","lineno":119,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036534","name":"exports.pickRestart","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but the choosen pattern is restarted when its index is triggered.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickRestart","longname":"pickRestart","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickRestart\`, but if you pick a number greater than the size of the list,\\n   * it wraps around, rather than sticking at the maximum value.\\n   * @param {Pattern} pat\\n   * @param {*} xs\\n   * @returns {Pattern}\\n   * @example\\n   * \\"<a@2 b@2 c@2 d@2>\\".pickRestart({\\n        a: n(\\"0 1 2 0\\"),\\n        b: n(\\"2 3 4 ~\\"),\\n        c: n(\\"[4 5] [4 3] 2 0\\"),\\n        d: n(\\"0 -3 0 ~\\")\\n      }).scale(\\"C:major\\").s(\\"piano\\")\\n   */","meta":{"range":[4989,5123],"filename":"pick.mjs","lineno":136,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036554","name":"exports.pickmodRestart","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickRestart</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"<a@2 b@2 c@2 d@2>\\".pickRestart({\\n        a: n(\\"0 1 2 0\\"),\\n        b: n(\\"2 3 4 ~\\"),\\n        c: n(\\"[4 5] [4 3] 2 0\\"),\\n        d: n(\\"0 -3 0 ~\\")\\n      }).scale(\\"C:major\\").s(\\"piano\\")"],"name":"pickmodRestart","longname":"pickmodRestart","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but the choosen pattern is reset when its index is triggered.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[5279,5402],"filename":"pick.mjs","lineno":145,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036574","name":"exports.pickReset","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but the choosen pattern is reset when its index is triggered.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickReset","longname":"pickReset","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickReset\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[5625,5753],"filename":"pick.mjs","lineno":155,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036594","name":"exports.pickmodReset","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickReset</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodReset","longname":"pickmodReset","kind":"constant","scope":"global"},{"comment":"/** Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\n   * Similar to \`pick\`, but cycles are squeezed into the target ('inhabited') pattern.\\n   * @name inhabit\\n   * @synonyms pickSqueeze\\n   * @param {Pattern} pat\\n   * @param {*} xs\\n   * @returns {Pattern}\\n   * @example\\n   * \\"<a b [a,b]>\\".inhabit({a: s(\\"bd(3,8)\\"),\\n                            b: s(\\"cp sd\\")\\n                           })\\n   * @example\\n   * s(\\"a@2 [a b] a\\".inhabit({a: \\"bd(3,8)\\", b: \\"sd sd\\"})).slow(4)\\n   */","meta":{"filename":"pick.mjs","lineno":159,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\nSimilar to <code>pick</code>, but cycles are squeezed into the target ('inhabited') pattern.</p>","name":"inhabit","synonyms_text":"pickSqueeze","synonyms":["pickSqueeze"],"params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"<a b [a,b]>\\".inhabit({a: s(\\"bd(3,8)\\"),\\n                            b: s(\\"cp sd\\")\\n                           })","s(\\"a@2 [a b] a\\".inhabit({a: \\"bd(3,8)\\", b: \\"sd sd\\"})).slow(4)"],"longname":"inhabit","kind":"member","scope":"global"},{"comment":"/** * The same as \`inhabit\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * For example, if you pick the fifth pattern of a list of three, you'll get the\\n * second one.\\n * @name inhabitmod\\n * @synonyms pickmodSqueeze\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"filename":"pick.mjs","lineno":177,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The same as <code>inhabit</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.\\nFor example, if you pick the fifth pattern of a list of three, you'll get the\\nsecond one.</p>","name":"inhabitmod","synonyms_text":"pickmodSqueeze","synonyms":["pickmodSqueeze"],"params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"longname":"inhabitmod","kind":"member","scope":"global"},{"comment":"/**\\n * Pick from the list of values (or patterns of values) via the index using the given\\n * pattern of integers. The selected pattern will be compressed to fit the duration of the selecting event\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(squeeze(\\"<0@2 [1!2] 2>\\", [\\"g a\\", \\"f g f g\\" , \\"g a c d\\"]))\\n */","meta":{"range":[7302,7543],"filename":"pick.mjs","lineno":202,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036666","name":"exports.squeeze","type":"VariableDeclaration"}},"description":"<p>Pick from the list of values (or patterns of values) via the index using the given\\npattern of integers. The selected pattern will be compressed to fit the duration of the selecting event</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(squeeze(\\"<0@2 [1!2] 2>\\", [\\"g a\\", \\"f g f g\\" , \\"g a c d\\"]))"],"name":"squeeze","longname":"squeeze","kind":"constant","scope":"global"},{"comment":"/**\\n   * Changes the global tempo to the given cycles per minute\\n   *\\n   * @name setcpm\\n   * @alias setCpm\\n   * @param {number} cpm cycles per minute\\n   * @example\\n   * setcpm(140/4) // =140 bpm in 4/4\\n   * $: s(\\"bd*4,[- sd]*2\\").bank('tr707')\\n   */","meta":{"filename":"repl.mjs","lineno":101,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the global tempo to the given cycles per minute</p>","name":"setcpm","alias":"setCpm","params":[{"type":{"names":["number"]},"description":"<p>cycles per minute</p>","name":"cpm"}],"examples":["setcpm(140/4) // =140 bpm in 4/4\\n$: s(\\"bd*4,[- sd]*2\\").bank('tr707')"],"longname":"setcpm","kind":"member","scope":"global"},{"comment":"/** Applies a function to all the running patterns. Note that the patterns are groups together into a single \`stack\` before the function is applied. This is probably what you want, but see \`each\` for\\n   * a version that applies the function to each pattern separately.\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * all(fast(\\"<2 3>\\"))\\n   * \`\`\`\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * all(x => x.pianoroll())\\n   * \`\`\`\\n   */","meta":{"range":[3428,3446],"filename":"repl.mjs","lineno":131,"columnno":6,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037065","name":"allTransforms","type":"ArrayExpression","value":"[]"}},"description":"<p>Applies a function to all the running patterns. Note that the patterns are groups together into a single <code>stack</code> before the function is applied. This is probably what you want, but see <code>each</code> for\\na version that applies the function to each pattern separately.</p>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\nall(fast(&quot;&lt;2 3>&quot;))\\n</code></pre>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\nall(x => x.pianoroll())\\n</code></pre>","name":"allTransforms","longname":"repl~allTransforms","kind":"member","memberof":"repl","scope":"inner","params":[]},{"comment":"/** Applies a function to each of the running patterns separately. This is intended for future use with upcoming 'stepwise' features. See \`all\` for a version that applies the function to all the patterns stacked together into a single pattern.\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * each(fast(\\"<2 3>\\"))\\n   * \`\`\`\\n   */","meta":{"range":[3898,3982],"filename":"repl.mjs","lineno":143,"columnno":8,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037083","name":"each","type":"FunctionExpression"},"vars":{"eachTransform":"repl~each~eachTransform"}},"description":"<p>Applies a function to each of the running patterns separately. This is intended for future use with upcoming 'stepwise' features. See <code>all</code> for a version that applies the function to all the patterns stacked together into a single pattern.</p>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\neach(fast(&quot;&lt;2 3>&quot;))\\n</code></pre>","name":"each","longname":"repl~each","kind":"function","memberof":"repl","scope":"inner","params":[]},{"comment":"/**\\n *  A sawtooth signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n * .clip(saw.slow(2))\\n * @example\\n * n(saw.range(0,8).segment(8))\\n * .scale('C major')\\n *\\n */","meta":{"range":[1533,1573],"filename":"signal.mjs","lineno":35,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037731","name":"exports.saw","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n.clip(saw.slow(2))","n(saw.range(0,8).segment(8))\\n.scale('C major')"],"name":"saw","longname":"saw","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between -1 and 1 (like \`saw\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[1673,1709],"filename":"signal.mjs","lineno":42,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037742","name":"exports.saw2","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between -1 and 1 (like <code>saw</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"saw2","longname":"saw2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between 1 and 0 (like \`saw\`, but flipped).\\n *\\n * @return {Pattern}\\n * @example\\n * note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n * .clip(isaw.slow(2))\\n * @example\\n * n(isaw.range(0,8).segment(8))\\n * .scale('C major')\\n *\\n */","meta":{"range":[1951,1998],"filename":"signal.mjs","lineno":56,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037750","name":"exports.isaw","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 1 and 0 (like <code>saw</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n.clip(isaw.slow(2))","n(isaw.range(0,8).segment(8))\\n.scale('C major')"],"name":"isaw","longname":"isaw","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between 1 and -1 (like \`saw2\`, but flipped).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2099,2137],"filename":"signal.mjs","lineno":63,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037763","name":"exports.isaw2","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 1 and -1 (like <code>saw2</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"isaw2","longname":"isaw2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sine signal between -1 and 1 (like \`sine\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2234,2296],"filename":"signal.mjs","lineno":70,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037771","name":"exports.sine2","type":"VariableDeclaration"}},"description":"<p>A sine signal between -1 and 1 (like <code>sine</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"sine2","longname":"sine2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sine signal between 0 and 1.\\n * @return {Pattern}\\n * @example\\n * n(sine.segment(16).range(0,15))\\n * .scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2433,2473],"filename":"signal.mjs","lineno":80,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037790","name":"exports.sine","type":"VariableDeclaration"}},"description":"<p>A sine signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(sine.segment(16).range(0,15))\\n.scale(\\"C:minor\\")"],"name":"sine","longname":"sine","kind":"constant","scope":"global"},{"comment":"/**\\n *  A cosine signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * n(stack(sine,cosine).segment(16).range(0,15))\\n * .scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2629,2683],"filename":"signal.mjs","lineno":91,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037798","name":"exports.cosine","type":"VariableDeclaration"}},"description":"<p>A cosine signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(stack(sine,cosine).segment(16).range(0,15))\\n.scale(\\"C:minor\\")"],"name":"cosine","longname":"cosine","kind":"constant","scope":"global"},{"comment":"/**\\n *  A cosine signal between -1 and 1 (like \`cosine\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2784,2840],"filename":"signal.mjs","lineno":98,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037813","name":"exports.cosine2","type":"VariableDeclaration"}},"description":"<p>A cosine signal between -1 and 1 (like <code>cosine</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"cosine2","longname":"cosine2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A square signal between 0 and 1.\\n * @return {Pattern}\\n * @example\\n * n(square.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2975,3036],"filename":"signal.mjs","lineno":107,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037828","name":"exports.square","type":"VariableDeclaration"}},"description":"<p>A square signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(square.segment(4).range(0,7)).scale(\\"C:minor\\")"],"name":"square","longname":"square","kind":"constant","scope":"global"},{"comment":"/**\\n *  A square signal between -1 and 1 (like \`square\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3137,3179],"filename":"signal.mjs","lineno":114,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037845","name":"exports.square2","type":"VariableDeclaration"}},"description":"<p>A square signal between -1 and 1 (like <code>square</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"square2","longname":"square2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A triangle signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * n(tri.segment(8).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[3316,3354],"filename":"signal.mjs","lineno":124,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037853","name":"exports.tri","type":"VariableDeclaration"}},"description":"<p>A triangle signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(tri.segment(8).range(0,7)).scale(\\"C:minor\\")"],"name":"tri","longname":"tri","kind":"constant","scope":"global"},{"comment":"/**\\n *  A triangle signal between -1 and 1 (like \`tri\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3454,3495],"filename":"signal.mjs","lineno":131,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037861","name":"exports.tri2","type":"VariableDeclaration"}},"description":"<p>A triangle signal between -1 and 1 (like <code>tri</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"tri2","longname":"tri2","kind":"constant","scope":"global"},{"comment":"/**\\n *  An inverted triangle signal between 1 and 0 (like \`tri\`, but flipped).\\n *\\n * @return {Pattern}\\n * @example\\n * n(itri.segment(8).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[3669,3708],"filename":"signal.mjs","lineno":141,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037869","name":"exports.itri","type":"VariableDeclaration"}},"description":"<p>An inverted triangle signal between 1 and 0 (like <code>tri</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(itri.segment(8).range(0,7)).scale(\\"C:minor\\")"],"name":"itri","longname":"itri","kind":"constant","scope":"global"},{"comment":"/**\\n *  An inverted triangle signal between -1 and 1 (like \`itri\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3819,3861],"filename":"signal.mjs","lineno":148,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037877","name":"exports.itri2","type":"VariableDeclaration"}},"description":"<p>An inverted triangle signal between -1 and 1 (like <code>itri</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"itri2","longname":"itri2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A signal representing the cycle time.\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3937,3968],"filename":"signal.mjs","lineno":155,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037885","name":"exports.time","type":"VariableDeclaration"}},"description":"<p>A signal representing the cycle time.</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"time","longname":"time","kind":"constant","scope":"global"},{"comment":"/**\\n *  The mouse's x position value ranges from 0 to 1.\\n * @name mousex\\n * @return {Pattern}\\n * @example\\n * n(mousex.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":157,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The mouse's x position value ranges from 0 to 1.</p>","name":"mousex","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(mousex.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"mousex","kind":"member","scope":"global"},{"comment":"/**\\n *  The mouse's y position value ranges from 0 to 1.\\n * @name mousey\\n * @return {Pattern}\\n * @example\\n * n(mousey.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":166,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The mouse's y position value ranges from 0 to 1.</p>","name":"mousey","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(mousey.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"mousey","kind":"member","scope":"global"},{"comment":"/**\\n * A discrete pattern of numbers from 0 to n-1\\n * @example\\n * n(run(4)).scale(\\"C4:pentatonic\\")\\n * // n(\\"0 1 2 3\\").scale(\\"C4:pentatonic\\")\\n */","meta":{"range":[5663,5724],"filename":"signal.mjs","lineno":228,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038102","name":"exports.run","type":"VariableDeclaration"}},"description":"<p>A discrete pattern of numbers from 0 to n-1</p>","examples":["n(run(4)).scale(\\"C4:pentatonic\\")\\n// n(\\"0 1 2 3\\").scale(\\"C4:pentatonic\\")"],"name":"run","longname":"run","kind":"constant","scope":"global"},{"comment":"/**\\n * Creates a pattern from a binary number.\\n *\\n * @name binary\\n * @param {number} n - input number to convert to binary\\n * @example\\n * \\"hh\\".s().struct(binary(5))\\n * // \\"hh\\".s().struct(\\"1 0 1\\")\\n */","meta":{"filename":"signal.mjs","lineno":230,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Creates a pattern from a binary number.</p>","name":"binary","params":[{"type":{"names":["number"]},"description":"<p>input number to convert to binary</p>","name":"n"}],"examples":["\\"hh\\".s().struct(binary(5))\\n// \\"hh\\".s().struct(\\"1 0 1\\")"],"longname":"binary","kind":"member","scope":"global"},{"comment":"/**\\n * Creates a pattern from a binary number, padded to n bits long.\\n *\\n * @name binaryN\\n * @param {number} n - input number to convert to binary\\n * @param {number} nBits - pattern length, defaults to 16\\n * @example\\n * \\"hh\\".s().struct(binaryN(55532, 16))\\n * // \\"hh\\".s().struct(\\"1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 0\\")\\n */","meta":{"filename":"signal.mjs","lineno":244,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Creates a pattern from a binary number, padded to n bits long.</p>","name":"binaryN","params":[{"type":{"names":["number"]},"description":"<p>input number to convert to binary</p>","name":"n"},{"type":{"names":["number"]},"description":"<p>pattern length, defaults to 16</p>","name":"nBits"}],"examples":["\\"hh\\".s().struct(binaryN(55532, 16))\\n// \\"hh\\".s().struct(\\"1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 0\\")"],"longname":"binaryN","kind":"member","scope":"global"},{"comment":"/**\\n * Slices a pattern into the given number of parts, then plays those parts in random order.\\n * Each part will be played exactly once per cycle.\\n * @name shuffle\\n * @example\\n * note(\\"c d e f\\").sound(\\"piano\\").shuffle(4)\\n * @example\\n * seq(\\"c d e f\\".shuffle(4), \\"g\\").note().sound(\\"piano\\")\\n */","meta":{"filename":"signal.mjs","lineno":279,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slices a pattern into the given number of parts, then plays those parts in random order.\\nEach part will be played exactly once per cycle.</p>","name":"shuffle","examples":["note(\\"c d e f\\").sound(\\"piano\\").shuffle(4)","seq(\\"c d e f\\".shuffle(4), \\"g\\").note().sound(\\"piano\\")"],"longname":"shuffle","kind":"member","scope":"global"},{"comment":"/**\\n * Slices a pattern into the given number of parts, then plays those parts at random. Similar to \`shuffle\`,\\n * but parts might be played more than once, or not at all, per cycle.\\n * @name scramble\\n * @example\\n * note(\\"c d e f\\").sound(\\"piano\\").scramble(4)\\n * @example\\n * seq(\\"c d e f\\".scramble(4), \\"g\\").note().sound(\\"piano\\")\\n */","meta":{"filename":"signal.mjs","lineno":292,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slices a pattern into the given number of parts, then plays those parts at random. Similar to <code>shuffle</code>,\\nbut parts might be played more than once, or not at all, per cycle.</p>","name":"scramble","examples":["note(\\"c d e f\\").sound(\\"piano\\").scramble(4)","seq(\\"c d e f\\".scramble(4), \\"g\\").note().sound(\\"piano\\")"],"longname":"scramble","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random numbers, between 0 and 1.\\n *\\n * @name rand\\n * @example\\n * // randomly change the cutoff\\n * s(\\"bd*4,hh*8\\").cutoff(rand.range(500,8000))\\n *\\n */","meta":{"filename":"signal.mjs","lineno":305,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of random numbers, between 0 and 1.</p>","name":"rand","examples":["// randomly change the cutoff\\ns(\\"bd*4,hh*8\\").cutoff(rand.range(500,8000))"],"longname":"rand","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random numbers, between -1 and 1\\n */","meta":{"range":[8355,8393],"filename":"signal.mjs","lineno":318,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038410","name":"exports.rand2","type":"VariableDeclaration"}},"description":"<p>A continuous pattern of random numbers, between -1 and 1</p>","name":"rand2","longname":"rand2","kind":"constant","scope":"global"},{"comment":"/**\\n * A continuous pattern of 0 or 1 (binary random), with a probability for the value being 1\\n *\\n * @name brandBy\\n * @param {number} probability - a number between 0 and 1\\n * @example\\n * s(\\"hh*10\\").pan(brandBy(0.2))\\n */","meta":{"filename":"signal.mjs","lineno":322,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of 0 or 1 (binary random), with a probability for the value being 1</p>","name":"brandBy","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"probability"}],"examples":["s(\\"hh*10\\").pan(brandBy(0.2))"],"longname":"brandBy","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of 0 or 1 (binary random)\\n *\\n * @name brand\\n * @example\\n * s(\\"hh*10\\").pan(brand)\\n */","meta":{"filename":"signal.mjs","lineno":332,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of 0 or 1 (binary random)</p>","name":"brand","examples":["s(\\"hh*10\\").pan(brand)"],"longname":"brand","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random integers, between 0 and n-1.\\n *\\n * @name irand\\n * @param {number} n max value (exclusive)\\n * @example\\n * // randomly select scale notes from 0 - 7 (= C to C)\\n * n(irand(8)).struct(\\"x x*2 x x*3\\").scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":343,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of random integers, between 0 and n-1.</p>","name":"irand","params":[{"type":{"names":["number"]},"description":"<p>max value (exclusive)</p>","name":"n"}],"examples":["// randomly select scale notes from 0 - 7 (= C to C)\\nn(irand(8)).struct(\\"x x*2 x x*3\\").scale(\\"C:minor\\")"],"longname":"irand","kind":"member","scope":"global"},{"comment":"/**\\n * Choose from the list of values (or patterns of values) using the given\\n * pattern of numbers, which should be in the range of 0..1\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(chooseWith(sine.fast(2), [\\"sawtooth\\", \\"triangle\\", \\"bd:6\\"]))\\n */","meta":{"range":[9855,9942],"filename":"signal.mjs","lineno":375,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038557","name":"exports.chooseWith","type":"VariableDeclaration"}},"description":"<p>Choose from the list of values (or patterns of values) using the given\\npattern of numbers, which should be in the range of 0..1</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(chooseWith(sine.fast(2), [\\"sawtooth\\", \\"triangle\\", \\"bd:6\\"]))"],"name":"chooseWith","longname":"chooseWith","kind":"constant","scope":"global"},{"comment":"/**\\n * As with {chooseWith}, but the structure comes from the chosen values, rather\\n * than the pattern you're using to choose with.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[10144,10233],"filename":"signal.mjs","lineno":386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038573","name":"exports.chooseInWith","type":"VariableDeclaration"}},"description":"<p>As with {chooseWith}, but the structure comes from the chosen values, rather\\nthan the pattern you're using to choose with.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"chooseInWith","longname":"chooseInWith","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses randomly from the given list of elements.\\n * @param  {...any} xs values / patterns to choose from.\\n * @returns {Pattern} - a continuous pattern.\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(choose(\\"sine\\", \\"triangle\\", \\"bd:6\\"))\\n */","meta":{"range":[10474,10528],"filename":"signal.mjs","lineno":397,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038589","name":"exports.choose","type":"VariableDeclaration"}},"description":"<p>Chooses randomly from the given list of elements.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>values / patterns to choose from.</p>","name":"xs"}],"returns":[{"type":{"names":["Pattern"]},"description":"<ul>\\n<li>a continuous pattern.</li>\\n</ul>"}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(choose(\\"sine\\", \\"triangle\\", \\"bd:6\\"))"],"name":"choose","longname":"choose","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses from the given list of values (or patterns of values), according\\n * to the pattern that the method is called on. The pattern should be in\\n * the range 0 .. 1.\\n * @param  {...any} xs\\n * @returns {Pattern}\\n */","meta":{"range":[10859,10937],"filename":"signal.mjs","lineno":410,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038617","name":"Pattern.prototype.choose","type":"FunctionExpression","paramnames":["xs"]}},"description":"<p>Chooses from the given list of values (or patterns of values), according\\nto the pattern that the method is called on. The pattern should be in\\nthe range 0 .. 1.</p>","params":[{"type":{"names":["any"]},"variable":true,"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"choose","longname":"Pattern#choose","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * As with choose, but the pattern that this method is called on should be\\n * in the range -1 .. 1\\n * @param  {...any} xs\\n * @returns {Pattern}\\n */","meta":{"range":[11092,11185],"filename":"signal.mjs","lineno":420,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038633","name":"Pattern.prototype.choose2","type":"FunctionExpression","paramnames":["xs"]}},"description":"<p>As with choose, but the pattern that this method is called on should be\\nin the range -1 .. 1</p>","params":[{"type":{"names":["any"]},"variable":true,"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"choose2","longname":"Pattern#choose2","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Picks one of the elements at random each cycle.\\n * @synonyms randcat\\n * @returns {Pattern}\\n * @example\\n * chooseCycles(\\"bd\\", \\"hh\\", \\"sd\\").s().fast(8)\\n * @example\\n * s(\\"bd | hh | sd\\").fast(8)\\n */","meta":{"range":[11389,11462],"filename":"signal.mjs","lineno":433,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038651","name":"exports.chooseCycles","type":"VariableDeclaration"}},"description":"<p>Picks one of the elements at random each cycle.</p>","synonyms_text":"randcat","synonyms":["randcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["chooseCycles(\\"bd\\", \\"hh\\", \\"sd\\").s().fast(8)","s(\\"bd | hh | sd\\").fast(8)"],"name":"chooseCycles","longname":"chooseCycles","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses randomly from the given list of elements by giving a probability to each element\\n * @param {...any} pairs arrays of value and weight\\n * @returns {Pattern} - a continuous pattern.\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(wchoose([\\"sine\\",10], [\\"triangle\\",1], [\\"bd:6\\",1]))\\n */","meta":{"range":[12754,12819],"filename":"signal.mjs","lineno":473,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038789","name":"exports.wchoose","type":"VariableDeclaration"}},"description":"<p>Chooses randomly from the given list of elements by giving a probability to each element</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>arrays of value and weight</p>","name":"pairs"}],"returns":[{"type":{"names":["Pattern"]},"description":"<ul>\\n<li>a continuous pattern.</li>\\n</ul>"}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(wchoose([\\"sine\\",10], [\\"triangle\\",1], [\\"bd:6\\",1]))"],"name":"wchoose","longname":"wchoose","kind":"constant","scope":"global"},{"comment":"/**\\n * Picks one of the elements at random each cycle by giving a probability to each element\\n * @synonyms wrandcat\\n * @returns {Pattern}\\n * @example\\n * wchooseCycles([\\"bd\\",10], [\\"hh\\",1], [\\"sd\\",1]).s().fast(8)\\n * @example\\n * wchooseCycles([\\"bd bd bd\\",5], [\\"hh hh hh\\",3], [\\"sd sd sd\\",1]).fast(4).s()\\n * @example\\n * // The probability can itself be a pattern\\n * wchooseCycles([\\"bd(3,8)\\",\\"<5 0>\\"], [\\"hh hh hh\\",3]).fast(4).s()\\n */","meta":{"range":[13248,13343],"filename":"signal.mjs","lineno":487,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038801","name":"exports.wchooseCycles","type":"VariableDeclaration"}},"description":"<p>Picks one of the elements at random each cycle by giving a probability to each element</p>","synonyms_text":"wrandcat","synonyms":["wrandcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["wchooseCycles([\\"bd\\",10], [\\"hh\\",1], [\\"sd\\",1]).s().fast(8)","wchooseCycles([\\"bd bd bd\\",5], [\\"hh hh hh\\",3], [\\"sd sd sd\\",1]).fast(4).s()","// The probability can itself be a pattern\\nwchooseCycles([\\"bd(3,8)\\",\\"<5 0>\\"], [\\"hh hh hh\\",3]).fast(4).s()"],"name":"wchooseCycles","longname":"wchooseCycles","kind":"constant","scope":"global"},{"comment":"/**\\n * Generates a continuous pattern of [perlin noise](https://en.wikipedia.org/wiki/Perlin_noise), in the range 0..1.\\n *\\n * @name perlin\\n * @example\\n * // randomly change the cutoff\\n * s(\\"bd*4,hh*8\\").cutoff(perlin.range(500,8000))\\n *\\n */","meta":{"filename":"signal.mjs","lineno":521,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Generates a continuous pattern of <a href=\\"https://en.wikipedia.org/wiki/Perlin_noise\\">perlin noise</a>, in the range 0..1.</p>","name":"perlin","examples":["// randomly change the cutoff\\ns(\\"bd*4,hh*8\\").cutoff(perlin.range(500,8000))"],"longname":"perlin","kind":"member","scope":"global"},{"comment":"/**\\n * Generates a continuous pattern of [berlin noise](conceived by Jame Coyne and Jade Rowland as a joke but turned out to be surprisingly cool and useful,\\n * like perlin noise but with sawtooth waves), in the range 0..1.\\n *\\n * @name berlin\\n * @example\\n * // ascending arpeggios\\n * n(\\"0!16\\".add(berlin.fast(4).mul(14))).scale(\\"d:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":532,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Generates a continuous pattern of [berlin noise](conceived by Jame Coyne and Jade Rowland as a joke but turned out to be surprisingly cool and useful,\\nlike perlin noise but with sawtooth waves), in the range 0..1.</p>","name":"berlin","examples":["// ascending arpeggios\\nn(\\"0!16\\".add(berlin.fast(4).mul(14))).scale(\\"d:minor\\")"],"longname":"berlin","kind":"member","scope":"global"},{"comment":"/**\\n * Randomly removes events from the pattern by a given amount.\\n * 0 = 0% chance of removal\\n * 1 = 100% chance of removal\\n *\\n * @name degradeBy\\n * @memberof Pattern\\n * @param {number} amount - a number between 0 and 1\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").degradeBy(0.2)\\n * @example\\n * s(\\"[hh?0.2]*8\\")\\n * @example\\n * //beat generator\\n * s(\\"bd\\").segment(16).degradeBy(.5).ribbon(16,1)\\n */","meta":{"filename":"signal.mjs","lineno":551,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly removes events from the pattern by a given amount.\\n0 = 0% chance of removal\\n1 = 100% chance of removal</p>","name":"degradeBy","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").degradeBy(0.2)","s(\\"[hh?0.2]*8\\")","//beat generator\\ns(\\"bd\\").segment(16).degradeBy(.5).ribbon(16,1)"],"scope":"static","longname":"Pattern.degradeBy","kind":"member"},{"comment":"/**\\n *\\n * Randomly removes 50% of events from the pattern. Shorthand for \`.degradeBy(0.5)\`\\n *\\n * @name degrade\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").degrade()\\n * @example\\n * s(\\"[hh?]*8\\")\\n */","meta":{"filename":"signal.mjs","lineno":577,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly removes 50% of events from the pattern. Shorthand for <code>.degradeBy(0.5)</code></p>","name":"degrade","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").degrade()","s(\\"[hh?]*8\\")"],"scope":"static","longname":"Pattern.degrade","kind":"member"},{"comment":"/**\\n * Inverse of \`degradeBy\`: Randomly removes events from the pattern by a given amount.\\n * 0 = 100% chance of removal\\n * 1 = 0% chance of removal\\n * Events that would be removed by degradeBy are let through by undegradeBy and vice versa (see second example).\\n *\\n * @name undegradeBy\\n * @memberof Pattern\\n * @param {number} amount - a number between 0 and 1\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").undegradeBy(0.2)\\n * @example\\n * s(\\"hh*10\\").layer(\\n *   x => x.degradeBy(0.2).pan(0),\\n *   x => x.undegradeBy(0.8).pan(1)\\n * )\\n */","meta":{"filename":"signal.mjs","lineno":591,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Inverse of <code>degradeBy</code>: Randomly removes events from the pattern by a given amount.\\n0 = 100% chance of removal\\n1 = 0% chance of removal\\nEvents that would be removed by degradeBy are let through by undegradeBy and vice versa (see second example).</p>","name":"undegradeBy","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").undegradeBy(0.2)","s(\\"hh*10\\").layer(\\n  x => x.degradeBy(0.2).pan(0),\\n  x => x.undegradeBy(0.8).pan(1)\\n)"],"scope":"static","longname":"Pattern.undegradeBy","kind":"member"},{"comment":"/**\\n * Inverse of \`degrade\`: Randomly removes 50% of events from the pattern. Shorthand for \`.undegradeBy(0.5)\`\\n * Events that would be removed by degrade are let through by undegrade and vice versa (see second example).\\n *\\n * @name undegrade\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").undegrade()\\n * @example\\n * s(\\"hh*10\\").layer(\\n *   x => x.degrade().pan(0),\\n *   x => x.undegrade().pan(1)\\n * )\\n */","meta":{"filename":"signal.mjs","lineno":621,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Inverse of <code>degrade</code>: Randomly removes 50% of events from the pattern. Shorthand for <code>.undegradeBy(0.5)</code>\\nEvents that would be removed by degrade are let through by undegrade and vice versa (see second example).</p>","name":"undegrade","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").undegrade()","s(\\"hh*10\\").layer(\\n  x => x.degrade().pan(0),\\n  x => x.undegrade().pan(1)\\n)"],"scope":"static","longname":"Pattern.undegrade","kind":"member"},{"comment":"/**\\n *\\n * Randomly applies the given function by the given probability.\\n * Similar to \`someCyclesBy\`\\n *\\n * @name sometimesBy\\n * @memberof Pattern\\n * @param {number | Pattern} probability - a number between 0 and 1\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").sometimesBy(.4, x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly applies the given function by the given probability.\\nSimilar to <code>someCyclesBy</code></p>","name":"sometimesBy","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>a number between 0 and 1</p>","name":"probability"},{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").sometimesBy(.4, x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.sometimesBy","kind":"member"},{"comment":"/**\\n *\\n * Applies the given function with a 50% chance\\n *\\n * @name sometimes\\n * @memberof Pattern\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").sometimes(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":658,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function with a 50% chance</p>","name":"sometimes","memberof":"Pattern","params":[{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").sometimes(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.sometimes","kind":"member"},{"comment":"/**\\n *\\n * Randomly applies the given function by the given probability on a cycle by cycle basis.\\n * Similar to \`sometimesBy\`\\n *\\n * @name someCyclesBy\\n * @memberof Pattern\\n * @param {number | Pattern} probability - a number between 0 and 1\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"bd,hh*8\\").someCyclesBy(.3, x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":673,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly applies the given function by the given probability on a cycle by cycle basis.\\nSimilar to <code>sometimesBy</code></p>","name":"someCyclesBy","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>a number between 0 and 1</p>","name":"probability"},{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd,hh*8\\").someCyclesBy(.3, x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.someCyclesBy","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.someCyclesBy(0.5, fn)\`\\n *\\n * @name someCycles\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"bd,hh*8\\").someCycles(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":698,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.someCyclesBy(0.5, fn)</code></p>","name":"someCycles","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd,hh*8\\").someCycles(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.someCycles","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.75, fn)\`\\n *\\n * @name often\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").often(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":712,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.75, fn)</code></p>","name":"often","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").often(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.often","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.25, fn)\`\\n *\\n * @name rarely\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").rarely(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":726,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.25, fn)</code></p>","name":"rarely","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").rarely(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.rarely","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.1, fn)\`\\n *\\n * @name almostNever\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").almostNever(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":740,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.1, fn)</code></p>","name":"almostNever","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").almostNever(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.almostNever","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.9, fn)\`\\n *\\n * @name almostAlways\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").almostAlways(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":754,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.9, fn)</code></p>","name":"almostAlways","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").almostAlways(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.almostAlways","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0, fn)\` (never calls fn)\\n *\\n * @name never\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").never(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":768,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0, fn)</code> (never calls fn)</p>","name":"never","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").never(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.never","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(1, fn)\` (always calls fn)\\n *\\n * @name always\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").always(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":782,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(1, fn)</code> (always calls fn)</p>","name":"always","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").always(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.always","kind":"member"},{"comment":"/**\\n *\\n * Do something on a keypress, or array of keypresses\\n * [Key name reference](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values)\\n *\\n * @name whenKey\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"bd(5,8)\\").whenKey(\\"Control:j\\", x => x.segment(16).color(\\"red\\")).whenKey(\\"Control:i\\", x => x.fast(2).color(\\"blue\\"))\\n */","meta":{"filename":"signal.mjs","lineno":809,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Do something on a keypress, or array of keypresses\\n<a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\\">Key name reference</a></p>","name":"whenKey","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd(5,8)\\").whenKey(\\"Control:j\\", x => x.segment(16).color(\\"red\\")).whenKey(\\"Control:i\\", x => x.fast(2).color(\\"blue\\"))"],"scope":"static","longname":"Pattern.whenKey","kind":"member"},{"comment":"/**\\n *\\n * returns true when a key or array of keys is held\\n * [Key name reference](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values)\\n *\\n * @name keyDown\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * keyDown(\\"Control:j\\").pick([s(\\"bd(5,8)\\"), s(\\"cp(3,8)\\")])\\n */","meta":{"filename":"signal.mjs","lineno":825,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>returns true when a key or array of keys is held\\n<a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\\">Key name reference</a></p>","name":"keyDown","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["keyDown(\\"Control:j\\").pick([s(\\"bd(5,8)\\"), s(\\"cp(3,8)\\")])"],"scope":"static","longname":"Pattern.keyDown","kind":"member"},{"comment":"/**\\n * @deprecated does not appear to be referenced or invoked anywhere in the codebase\\n * @noAutocomplete\\n */","meta":{"range":[2816,2983],"filename":"util.mjs","lineno":73,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100052618","name":"exports.getFreq","type":"VariableDeclaration"}},"deprecated":"does not appear to be referenced or invoked anywhere in the codebase","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"getFreq","longname":"getFreq","kind":"constant","scope":"global"},{"comment":"/**\\n * @deprecated only used in workshop (first-notes)\\n * @noAutocomplete\\n */","meta":{"range":[3142,3261],"filename":"util.mjs","lineno":85,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100052657","name":"exports.midi2note","type":"VariableDeclaration"}},"deprecated":"only used in workshop (first-notes)","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"midi2note","longname":"midi2note","kind":"constant","scope":"global"},{"comment":"/**\\n * Sends notes to Csound for rendering with MIDI semantics. The hap value is\\n * translated to these Csound pfields:\\n *\\n *  p1 -- Csound instrument either as a number (1-based, can be a fraction),\\n *        or as a string name.\\n *  p2 -- time in beats (usually seconds) from start of performance.\\n *  p3 -- duration in beats (usually seconds).\\n *  p4 -- MIDI key number (as a real number, not an integer but in [0, 127].\\n *  p5 -- MIDI velocity (as a real number, not an integer but in [0, 127].\\n *  p6 -- Strudel controls, as a string.\\n */","meta":{"range":[4679,6063],"filename":"index.mjs","lineno":139,"columnno":0,"path":"/home/alex/src/strudel/packages/csound","code":{"id":"astnode100055261","name":"exports.csoundm","type":"VariableDeclaration"}},"description":"<p>Sends notes to Csound for rendering with MIDI semantics. The hap value is\\ntranslated to these Csound pfields:</p>\\n<p>p1 -- Csound instrument either as a number (1-based, can be a fraction),\\nor as a string name.\\np2 -- time in beats (usually seconds) from start of performance.\\np3 -- duration in beats (usually seconds).\\np4 -- MIDI key number (as a real number, not an integer but in [0, 127].\\np5 -- MIDI velocity (as a real number, not an integer but in [0, 127].\\np6 -- Strudel controls, as a string.</p>","name":"csoundm","longname":"csoundm","kind":"constant","scope":"global"},{"comment":"/**\\n * Visualises a pattern as a scrolling 'pianoroll', displayed in the background of the editor. To show a pianoroll for all running patterns, use \`all(pianoroll)\`. To have a pianoroll appear below\\n * a pattern instead, prefix with \`_\`, e.g.: \`sound(\\"bd sd\\")._pianoroll()\`.\\n *\\n * @name pianoroll\\n * @synonyms punchcard\\n * @param {Object} options Object containing all the optional following parameters as key value pairs:\\n * @param {integer} cycles number of cycles to be displayed at the same time - defaults to 4\\n * @param {number} playhead location of the active notes on the time axis - 0 to 1, defaults to 0.5\\n * @param {boolean} vertical displays the roll vertically - 0 by default\\n * @param {boolean} labels displays labels on individual notes (see the label function) - 0 by default\\n * @param {boolean} flipTime reverse the direction of the roll - 0 by default\\n * @param {boolean} flipValues reverse the relative location of notes on the value axis - 0 by default\\n * @param {number} overscan lookup X cycles outside of the cycles window to display notes in advance - 1 by default\\n * @param {boolean} hideNegative hide notes with negative time (before starting playing the pattern) - 0 by default\\n * @param {boolean} smear notes leave a solid trace - 0 by default\\n * @param {boolean} fold notes takes the full value axis width - 0 by default\\n * @param {string} active hexadecimal or CSS color of the active notes - defaults to #FFCA28\\n * @param {string} inactive hexadecimal or CSS color of the inactive notes - defaults to #7491D2\\n * @param {string} background hexadecimal or CSS color of the background - defaults to transparent\\n * @param {string} playheadColor hexadecimal or CSS color of the line representing the play head - defaults to white\\n * @param {boolean} fill notes are filled with color (otherwise only the label is displayed) - 0 by default\\n * @param {boolean} fillActive active notes are filled with color - 0 by default\\n * @param {boolean} stroke notes are shown with colored borders - 0 by default\\n * @param {boolean} strokeActive active notes are shown with colored borders - 0 by default\\n * @param {boolean} hideInactive only active notes are shown - 0 by default\\n * @param {boolean} colorizeInactive use note color for inactive notes - 1 by default\\n * @param {string} fontFamily define the font used by notes labels - defaults to 'monospace'\\n * @param {integer} minMidi minimum note value to display on the value axis - defaults to 10\\n * @param {integer} maxMidi maximum note value to display on the value axis - defaults to 90\\n * @param {boolean} autorange automatically calculate the minMidi and maxMidi parameters - 0 by default\\n * @see _pianoroll\\n * @example\\n * note(\\"c2 a2 eb2\\")\\n * .euclid(5,8)\\n * .s('sawtooth')\\n * .lpenv(4).lpf(300)\\n * .pianoroll({ labels: 1 })\\n */","meta":{"filename":"pianoroll.mjs","lineno":39,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Visualises a pattern as a scrolling 'pianoroll', displayed in the background of the editor. To show a pianoroll for all running patterns, use <code>all(pianoroll)</code>. To have a pianoroll appear below\\na pattern instead, prefix with <code>_</code>, e.g.: <code>sound(&quot;bd sd&quot;)._pianoroll()</code>.</p>","name":"pianoroll","synonyms_text":"punchcard","synonyms":["punchcard"],"params":[{"type":{"names":["Object"]},"description":"<p>Object containing all the optional following parameters as key value pairs:</p>","name":"options"},{"type":{"names":["integer"]},"description":"<p>number of cycles to be displayed at the same time - defaults to 4</p>","name":"cycles"},{"type":{"names":["number"]},"description":"<p>location of the active notes on the time axis - 0 to 1, defaults to 0.5</p>","name":"playhead"},{"type":{"names":["boolean"]},"description":"<p>displays the roll vertically - 0 by default</p>","name":"vertical"},{"type":{"names":["boolean"]},"description":"<p>displays labels on individual notes (see the label function) - 0 by default</p>","name":"labels"},{"type":{"names":["boolean"]},"description":"<p>reverse the direction of the roll - 0 by default</p>","name":"flipTime"},{"type":{"names":["boolean"]},"description":"<p>reverse the relative location of notes on the value axis - 0 by default</p>","name":"flipValues"},{"type":{"names":["number"]},"description":"<p>lookup X cycles outside of the cycles window to display notes in advance - 1 by default</p>","name":"overscan"},{"type":{"names":["boolean"]},"description":"<p>hide notes with negative time (before starting playing the pattern) - 0 by default</p>","name":"hideNegative"},{"type":{"names":["boolean"]},"description":"<p>notes leave a solid trace - 0 by default</p>","name":"smear"},{"type":{"names":["boolean"]},"description":"<p>notes takes the full value axis width - 0 by default</p>","name":"fold"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the active notes - defaults to #FFCA28</p>","name":"active"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the inactive notes - defaults to #7491D2</p>","name":"inactive"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the background - defaults to transparent</p>","name":"background"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the line representing the play head - defaults to white</p>","name":"playheadColor"},{"type":{"names":["boolean"]},"description":"<p>notes are filled with color (otherwise only the label is displayed) - 0 by default</p>","name":"fill"},{"type":{"names":["boolean"]},"description":"<p>active notes are filled with color - 0 by default</p>","name":"fillActive"},{"type":{"names":["boolean"]},"description":"<p>notes are shown with colored borders - 0 by default</p>","name":"stroke"},{"type":{"names":["boolean"]},"description":"<p>active notes are shown with colored borders - 0 by default</p>","name":"strokeActive"},{"type":{"names":["boolean"]},"description":"<p>only active notes are shown - 0 by default</p>","name":"hideInactive"},{"type":{"names":["boolean"]},"description":"<p>use note color for inactive notes - 1 by default</p>","name":"colorizeInactive"},{"type":{"names":["string"]},"description":"<p>define the font used by notes labels - defaults to 'monospace'</p>","name":"fontFamily"},{"type":{"names":["integer"]},"description":"<p>minimum note value to display on the value axis - defaults to 10</p>","name":"minMidi"},{"type":{"names":["integer"]},"description":"<p>maximum note value to display on the value axis - defaults to 90</p>","name":"maxMidi"},{"type":{"names":["boolean"]},"description":"<p>automatically calculate the minMidi and maxMidi parameters - 0 by default</p>","name":"autorange"}],"see":["_pianoroll"],"examples":["note(\\"c2 a2 eb2\\")\\n.euclid(5,8)\\n.s('sawtooth')\\n.lpenv(4).lpf(300)\\n.pianoroll({ labels: 1 })"],"longname":"pianoroll","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a vertical pianoroll with event labels.\\n * Supports all the same options as pianoroll.\\n *\\n * @name wordfall\\n */","meta":{"filename":"pianoroll.mjs","lineno":297,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Displays a vertical pianoroll with event labels.\\nSupports all the same options as pianoroll.</p>","name":"wordfall","longname":"wordfall","kind":"member","scope":"global"},{"comment":"/**\\n * Renders a pitch circle to visualize frequencies within one octave\\n * @name pitchwheel\\n * @param {number} hapcircles\\n * @param {number} circle\\n * @param {number} edo\\n * @param {string} root\\n * @param {number} thickness\\n * @param {number} hapRadius\\n * @param {string} mode\\n * @param {number} margin\\n * @example\\n * n(\\"0 .. 12\\").scale(\\"C:chromatic\\")\\n * .s(\\"sawtooth\\")\\n * .lpf(500)\\n * ._pitchwheel()\\n */","meta":{"filename":"pitchwheel.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Renders a pitch circle to visualize frequencies within one octave</p>","name":"pitchwheel","params":[{"type":{"names":["number"]},"name":"hapcircles"},{"type":{"names":["number"]},"name":"circle"},{"type":{"names":["number"]},"name":"edo"},{"type":{"names":["string"]},"name":"root"},{"type":{"names":["number"]},"name":"thickness"},{"type":{"names":["number"]},"name":"hapRadius"},{"type":{"names":["string"]},"name":"mode"},{"type":{"names":["number"]},"name":"margin"}],"examples":["n(\\"0 .. 12\\").scale(\\"C:chromatic\\")\\n.s(\\"sawtooth\\")\\n.lpf(500)\\n._pitchwheel()"],"longname":"pitchwheel","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a spiral visual.\\n *\\n * @name spiral\\n * @param {Object} options Object containing all the optional following parameters as key value pairs:\\n * @param {number} stretch controls the rotations per cycle ratio, where 1 = 1 cycle / 360 degrees\\n * @param {number} size the diameter of the spiral\\n * @param {number} thickness line thickness\\n * @param {string} cap style of line ends: butt (default), round, square\\n * @param {string} inset number of rotations before spiral starts (default 3)\\n * @param {string} playheadColor color of playhead, defaults to white\\n * @param {number} playheadLength length of playhead in rotations, defaults to 0.02\\n * @param {number} playheadThickness thickness of playheadrotations, defaults to thickness\\n * @param {number} padding space around spiral\\n * @param {number} steady steadyness of spiral vs playhead. 1 = spiral doesn't move, playhead does.\\n * @param {number} activeColor color of active segment. defaults to foreground of theme\\n * @param {number} inactiveColor color of inactive segments. defaults to gutterForeground of theme\\n * @param {boolean} colorizeInactive wether or not to colorize inactive segments, defaults to 0\\n * @param {boolean} fade wether or not past and future should fade out. defaults to 1\\n * @param {boolean} logSpiral wether or not the spiral should be logarithmic. defaults to 0\\n * @example\\n * note(\\"c2 a2 eb2\\")\\n * .euclid(5,8)\\n * .s('sawtooth')\\n * .lpenv(4).lpf(300)\\n * ._spiral({ steady: .96 })\\n */","meta":{"filename":"spiral.mjs","lineno":128,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Displays a spiral visual.</p>","name":"spiral","params":[{"type":{"names":["Object"]},"description":"<p>Object containing all the optional following parameters as key value pairs:</p>","name":"options"},{"type":{"names":["number"]},"description":"<p>controls the rotations per cycle ratio, where 1 = 1 cycle / 360 degrees</p>","name":"stretch"},{"type":{"names":["number"]},"description":"<p>the diameter of the spiral</p>","name":"size"},{"type":{"names":["number"]},"description":"<p>line thickness</p>","name":"thickness"},{"type":{"names":["string"]},"description":"<p>style of line ends: butt (default), round, square</p>","name":"cap"},{"type":{"names":["string"]},"description":"<p>number of rotations before spiral starts (default 3)</p>","name":"inset"},{"type":{"names":["string"]},"description":"<p>color of playhead, defaults to white</p>","name":"playheadColor"},{"type":{"names":["number"]},"description":"<p>length of playhead in rotations, defaults to 0.02</p>","name":"playheadLength"},{"type":{"names":["number"]},"description":"<p>thickness of playheadrotations, defaults to thickness</p>","name":"playheadThickness"},{"type":{"names":["number"]},"description":"<p>space around spiral</p>","name":"padding"},{"type":{"names":["number"]},"description":"<p>steadyness of spiral vs playhead. 1 = spiral doesn't move, playhead does.</p>","name":"steady"},{"type":{"names":["number"]},"description":"<p>color of active segment. defaults to foreground of theme</p>","name":"activeColor"},{"type":{"names":["number"]},"description":"<p>color of inactive segments. defaults to gutterForeground of theme</p>","name":"inactiveColor"},{"type":{"names":["boolean"]},"description":"<p>wether or not to colorize inactive segments, defaults to 0</p>","name":"colorizeInactive"},{"type":{"names":["boolean"]},"description":"<p>wether or not past and future should fade out. defaults to 1</p>","name":"fade"},{"type":{"names":["boolean"]},"description":"<p>wether or not the spiral should be logarithmic. defaults to 0</p>","name":"logSpiral"}],"examples":["note(\\"c2 a2 eb2\\")\\n.euclid(5,8)\\n.s('sawtooth')\\n.lpenv(4).lpf(300)\\n._spiral({ steady: .96 })"],"longname":"spiral","kind":"member","scope":"global"},{"comment":"/**\\n * configures the default midimap, which is used when no \\"midimap\\" port is set\\n * @example\\n * defaultmidimap({ lpf: 74 })\\n * $: note(\\"c a f e\\").midi();\\n * $: lpf(sine.slow(4).segment(16)).midi();\\n */","meta":{"range":[4416,4515],"filename":"midi.mjs","lineno":131,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063183","name":"exports.defaultmidimap","type":"FunctionDeclaration","paramnames":["mapping"]}},"description":"<p>configures the default midimap, which is used when no &quot;midimap&quot; port is set</p>","examples":["defaultmidimap({ lpf: 74 })\\n$: note(\\"c a f e\\").midi();\\n$: lpf(sine.slow(4).segment(16)).midi();"],"name":"defaultmidimap","longname":"defaultmidimap","kind":"function","scope":"global"},{"comment":"/**\\n * Adds midimaps to the registry. Inside each midimap, control names (e.g. lpf) are mapped to cc numbers.\\n * @example\\n * midimaps({ mymap: { lpf: 74 } })\\n * $: note(\\"c a f e\\")\\n * .lpf(sine.slow(4))\\n * .midimap('mymap')\\n * .midi()\\n * @example\\n * midimaps({ mymap: {\\n *   lpf: { ccn: 74, min: 0, max: 20000, exp: 0.5 }\\n * }})\\n * $: note(\\"c a f e\\")\\n * .lpf(sine.slow(2).range(400,2000))\\n * .midimap('mymap')\\n * .midi()\\n */","meta":{"range":[4962,5392],"filename":"midi.mjs","lineno":154,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063201","name":"exports.midimaps","type":"FunctionDeclaration","paramnames":["map"]}},"description":"<p>Adds midimaps to the registry. Inside each midimap, control names (e.g. lpf) are mapped to cc numbers.</p>","examples":["midimaps({ mymap: { lpf: 74 } })\\n$: note(\\"c a f e\\")\\n.lpf(sine.slow(4))\\n.midimap('mymap')\\n.midi()","midimaps({ mymap: {\\n  lpf: { ccn: 74, min: 0, max: 20000, exp: 0.5 }\\n}})\\n$: note(\\"c a f e\\")\\n.lpf(sine.slow(2).range(400,2000))\\n.midimap('mymap')\\n.midi()"],"name":"midimaps","longname":"midimaps","kind":"function","scope":"global"},{"comment":"/**\\n * MIDI output: Opens a MIDI output port.\\n * @param {string | number} midiport MIDI device name or index defaulting to 0\\n * @param {object} options Additional MIDI configuration options\\n * @example\\n * note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1')\\n * @example\\n * note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1', { controller: true, latency: 50 })\\n */","meta":{"range":[10343,16473],"filename":"midi.mjs","lineno":289,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063852","name":"Pattern.prototype.midi","type":"FunctionExpression","paramnames":["midiport","options"]},"vars":{"undefined":null,"options":"Pattern#midi~options","midiport":"Pattern#midi~midiport","midiConfig":"Pattern#midi~midiConfig","":null}},"description":"<p>MIDI output: Opens a MIDI output port.</p>","params":[{"type":{"names":["string","number"]},"description":"<p>MIDI device name or index defaulting to 0</p>","name":"midiport"},{"type":{"names":["object"]},"description":"<p>Additional MIDI configuration options</p>","name":"options"}],"examples":["note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1')","note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1', { controller: true, latency: 50 })"],"name":"midi","longname":"Pattern#midi","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * MIDI input: Opens a MIDI input port to receive MIDI control change messages.\\n * @param {string | number} input MIDI device name or index defaulting to 0\\n * @returns {Function}\\n * @example\\n * let cc = await midin('IAC Driver Bus 1')\\n * note(\\"c a f e\\").lpf(cc(0).range(0, 1000)).lpq(cc(1).range(0, 10)).sound(\\"sawtooth\\")\\n */","meta":{"range":[16844,18118],"filename":"midi.mjs","lineno":474,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100064501","name":"exports.midin","type":"FunctionDeclaration","paramnames":["input"]}},"description":"<p>MIDI input: Opens a MIDI input port to receive MIDI control change messages.</p>","params":[{"type":{"names":["string","number"]},"description":"<p>MIDI device name or index defaulting to 0</p>","name":"input"}],"returns":[{"type":{"names":["function"]}}],"examples":["let cc = await midin('IAC Driver Bus 1')\\nnote(\\"c a f e\\").lpf(cc(0).range(0, 1000)).lpq(cc(1).range(0, 10)).sound(\\"sawtooth\\")"],"name":"midin","longname":"midin","kind":"function","scope":"global"},{"comment":"/**\\n *  The accelerometer's x-axis value ranges from 0 to 1.\\n * @name accelerationX\\n * @return {Pattern}\\n * @synonyms accX\\n * @example\\n * n(accelerationX.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":5,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's x-axis value ranges from 0 to 1.</p>","name":"accelerationX","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accX","synonyms":["accX"],"examples":["n(accelerationX.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationX","kind":"member","scope":"global"},{"comment":"/**\\n *  The accelerometer's y-axis value ranges from 0 to 1.\\n * @name accelerationY\\n * @return {Pattern}\\n * @synonyms accY\\n * @example\\n * n(accelerationY.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":15,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's y-axis value ranges from 0 to 1.</p>","name":"accelerationY","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accY","synonyms":["accY"],"examples":["n(accelerationY.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationY","kind":"member","scope":"global"},{"comment":"/**\\n *  The accelerometer's z-axis value ranges from 0 to 1.\\n * @name accelerationZ\\n * @return {Pattern}\\n * @synonyms accZ\\n * @example\\n * n(accelerationZ.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":25,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's z-axis value ranges from 0 to 1.</p>","name":"accelerationZ","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accZ","synonyms":["accZ"],"examples":["n(accelerationZ.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationZ","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity x-axis value ranges from 0 to 1.\\n * @name gravityX\\n * @return {Pattern}\\n * @synonyms gravX\\n * @example\\n * n(gravityX.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":35,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity x-axis value ranges from 0 to 1.</p>","name":"gravityX","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravX","synonyms":["gravX"],"examples":["n(gravityX.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityX","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity y-axis value ranges from 0 to 1.\\n * @name gravityY\\n * @return {Pattern}\\n * @synonyms gravY\\n * @example\\n * n(gravityY.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":45,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity y-axis value ranges from 0 to 1.</p>","name":"gravityY","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravY","synonyms":["gravY"],"examples":["n(gravityY.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityY","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity z-axis value ranges from 0 to 1.\\n * @name gravityZ\\n * @return {Pattern}\\n * @synonyms gravZ\\n * @example\\n * n(gravityZ.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":55,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity z-axis value ranges from 0 to 1.</p>","name":"gravityZ","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravZ","synonyms":["gravZ"],"examples":["n(gravityZ.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityZ","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the alpha-axis value ranges from 0 to 1.\\n * @name rotationAlpha\\n * @return {Pattern}\\n * @synonyms rotA, rotZ, rotationZ\\n * @example\\n * n(rotationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":65,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the alpha-axis value ranges from 0 to 1.</p>","name":"rotationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotA, rotZ, rotationZ","synonyms":["rotA","rotZ","rotationZ"],"examples":["n(rotationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the beta-axis value ranges from 0 to 1.\\n * @name rotationBeta\\n * @return {Pattern}\\n * @synonyms rotB, rotX, rotationX\\n * @example\\n * n(rotationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":75,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the beta-axis value ranges from 0 to 1.</p>","name":"rotationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotB, rotX, rotationX","synonyms":["rotB","rotX","rotationX"],"examples":["n(rotationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the gamma-axis value ranges from 0 to 1.\\n * @name rotationGamma\\n * @return {Pattern}\\n * @synonyms rotG, rotY, rotationY\\n * @example\\n * n(rotationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":85,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the gamma-axis value ranges from 0 to 1.</p>","name":"rotationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotG, rotY, rotationY","synonyms":["rotG","rotY","rotationY"],"examples":["n(rotationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation alpha value ranges from 0 to 1.\\n * @name orientationAlpha\\n * @return {Pattern}\\n * @synonyms oriA, oriZ, orientationZ\\n * @example\\n * n(orientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":95,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation alpha value ranges from 0 to 1.</p>","name":"orientationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriA, oriZ, orientationZ","synonyms":["oriA","oriZ","orientationZ"],"examples":["n(orientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation beta value ranges from 0 to 1.\\n * @name orientationBeta\\n * @return {Pattern}\\n * @synonyms oriB, oriX, orientationX\\n * @example\\n * n(orientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":105,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation beta value ranges from 0 to 1.</p>","name":"orientationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriB, oriX, orientationX","synonyms":["oriB","oriX","orientationX"],"examples":["n(orientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation gamma value ranges from 0 to 1.\\n * @name orientationGamma\\n * @return {Pattern}\\n * @synonyms oriG, oriY, orientationY\\n * @example\\n * n(orientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":115,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation gamma value ranges from 0 to 1.</p>","name":"orientationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriG, oriY, orientationY","synonyms":["oriG","oriY","orientationY"],"examples":["n(orientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation alpha value ranges from 0 to 1.\\n * @name absoluteOrientationAlpha\\n * @return {Pattern}\\n * @synonyms absOriA, absOriZ, absoluteOrientationZ\\n * @example\\n * n(absoluteOrientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":125,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation alpha value ranges from 0 to 1.</p>","name":"absoluteOrientationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriA, absOriZ, absoluteOrientationZ","synonyms":["absOriA","absOriZ","absoluteOrientationZ"],"examples":["n(absoluteOrientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation beta value ranges from 0 to 1.\\n * @name absoluteOrientationBeta\\n * @return {Pattern}\\n * @synonyms absOriB, absOriX, absoluteOrientationX\\n * @example\\n * n(absoluteOrientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":135,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation beta value ranges from 0 to 1.</p>","name":"absoluteOrientationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriB, absOriX, absoluteOrientationX","synonyms":["absOriB","absOriX","absoluteOrientationX"],"examples":["n(absoluteOrientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation gamma value ranges from 0 to 1.\\n * @name absoluteOrientationGamma\\n * @return {Pattern}\\n * @synonyms absOriG, absOriY, absoluteOrientationY\\n * @example\\n * n(absoluteOrientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":145,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation gamma value ranges from 0 to 1.</p>","name":"absoluteOrientationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriG, absOriY, absoluteOrientationY","synonyms":["absOriG","absOriY","absoluteOrientationY"],"examples":["n(absoluteOrientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Sends each hap as an OSC message, which can be picked up by SuperCollider or any other OSC-enabled software.\\n * For more info, read [MIDI & OSC in the docs](https://strudel.cc/learn/input-output/)\\n *\\n * @name osc\\n * @memberof Pattern\\n * @returns Pattern\\n */","meta":{"filename":"osc.mjs","lineno":76,"columnno":0,"path":"/home/alex/src/strudel/packages/osc","code":{}},"description":"<p>Sends each hap as an OSC message, which can be picked up by SuperCollider or any other OSC-enabled software.\\nFor more info, read <a href=\\"https://strudel.cc/learn/input-output/\\">MIDI &amp; OSC in the docs</a></p>","name":"osc","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"scope":"static","longname":"Pattern.osc","kind":"member"},{"comment":"/** Overlap-Add Node */","meta":{"range":[150,6513],"filename":"ola-processor.js","lineno":7,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101520","name":"OLAProcessor","type":"ClassDeclaration","paramnames":["options"]}},"name":"OLAProcessor","longname":"OLAProcessor","kind":"class","classdesc":"<p>Overlap-Add Node</p>","scope":"global"},{"comment":"/** Handles dynamic reallocation of input/output channels buffer\\n     (channel numbers may lety during lifecycle) **/","meta":{"range":[1429,1897],"filename":"ola-processor.js","lineno":39,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101673","name":"OLAProcessor#reallocateChannelsIfNeeded","type":"MethodDefinition","paramnames":["inputs","outputs"]},"vars":{"":null}},"description":"<p>Handles dynamic reallocation of input/output channels buffer\\n(channel numbers may lety during lifecycle)</p>","name":"reallocateChannelsIfNeeded","longname":"OLAProcessor#reallocateChannelsIfNeeded","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Read next web audio block to input buffers **/","meta":{"range":[3534,4122],"filename":"ola-processor.js","lineno":92,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101980","name":"OLAProcessor#readInputs","type":"MethodDefinition","paramnames":["inputs"]},"vars":{"":null}},"description":"<p>Read next web audio block to input buffers</p>","name":"readInputs","longname":"OLAProcessor#readInputs","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Write next web audio block from output buffers **/","meta":{"range":[4183,4461],"filename":"ola-processor.js","lineno":112,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102101","name":"OLAProcessor#writeOutputs","type":"MethodDefinition","paramnames":["outputs"]},"vars":{"":null}},"description":"<p>Write next web audio block from output buffers</p>","name":"writeOutputs","longname":"OLAProcessor#writeOutputs","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Shift left content of input buffers to receive new web audio block **/","meta":{"range":[4542,4757],"filename":"ola-processor.js","lineno":122,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102161","name":"OLAProcessor#shiftInputBuffers","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Shift left content of input buffers to receive new web audio block</p>","name":"shiftInputBuffers","longname":"OLAProcessor#shiftInputBuffers","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Shift left content of output buffers to receive new web audio block **/","meta":{"range":[4839,5147],"filename":"ola-processor.js","lineno":131,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102208","name":"OLAProcessor#shiftOutputBuffers","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Shift left content of output buffers to receive new web audio block</p>","name":"shiftOutputBuffers","longname":"OLAProcessor#shiftOutputBuffers","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Copy contents of input buffers to buffer actually sent to process **/","meta":{"range":[5227,5454],"filename":"ola-processor.js","lineno":141,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102275","name":"OLAProcessor#prepareInputBuffersToSend","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Copy contents of input buffers to buffer actually sent to process</p>","name":"prepareInputBuffersToSend","longname":"OLAProcessor#prepareInputBuffersToSend","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Add contents of output buffers just processed to output buffers **/","meta":{"range":[5532,5852],"filename":"ola-processor.js","lineno":150,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102327","name":"OLAProcessor#handleOutputBuffersToRetrieve","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Add contents of output buffers just processed to output buffers</p>","name":"handleOutputBuffersToRetrieve","longname":"OLAProcessor#handleOutputBuffersToRetrieve","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Generates a reverb impulse response.\\n\\n @param {!Object} params TODO: Document the properties.\\n @param {!function(!AudioBuffer)} callback Function to call when\\n  the impulse response has been generated. The impulse response\\n  is passed to this function as its parameter. May be called\\n  immediately within the current execution context, or later. */","meta":{"range":[969,2138],"filename":"reverbGen.mjs","lineno":24,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102812","name":"reverbGen.generateReverb","type":"FunctionExpression","paramnames":["params","callback"]},"vars":{"audioContext":"reverbGen.generateReverb~audioContext","sampleRate":"reverbGen.generateReverb~sampleRate","numChannels":"reverbGen.generateReverb~numChannels","totalTime":"reverbGen.generateReverb~totalTime","decaySampleFrames":"reverbGen.generateReverb~decaySampleFrames","numSampleFrames":"reverbGen.generateReverb~numSampleFrames","fadeInSampleFrames":"reverbGen.generateReverb~fadeInSampleFrames","decayBase":"reverbGen.generateReverb~decayBase","reverbIR":"reverbGen.generateReverb~reverbIR","i":"reverbGen.generateReverb~i","chan":"reverbGen.generateReverb~chan","j":"reverbGen.generateReverb~j","chan[undefined]":"reverbGen.generateReverb~chan.undefined]"}},"description":"<p>Generates a reverb impulse response.</p>","params":[{"type":{"names":["Object"]},"nullable":false,"description":"<p>TODO: Document the properties.</p>","name":"params"},{"type":{"names":["function"]},"nullable":false,"description":"<p>Function to call when\\nthe impulse response has been generated. The impulse response\\nis passed to this function as its parameter. May be called\\nimmediately within the current execution context, or later.</p>","name":"callback"}],"name":"generateReverb","longname":"reverbGen.generateReverb","kind":"function","memberof":"reverbGen","scope":"static"},{"comment":"/** Creates a canvas element showing a graph of the given data.\\n\\n\\n @param {!Float32Array} data An array of numbers, or a Float32Array.\\n @param {number} width Width in pixels of the canvas.\\n @param {number} height Height in pixels of the canvas.\\n @param {number} min Minimum value of data for the graph (lower edge).\\n @param {number} max Maximum value of data in the graph (upper edge).\\n @return {!CanvasElement} The generated canvas element. */","meta":{"range":[2586,3097],"filename":"reverbGen.mjs","lineno":58,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102992","name":"reverbGen.generateGraph","type":"FunctionExpression","paramnames":["data","width","height","min","max"]},"vars":{"canvas":"reverbGen.generateGraph~canvas","canvas.width":"reverbGen.generateGraph~canvas.width","canvas.height":"reverbGen.generateGraph~canvas.height","gc":"reverbGen.generateGraph~gc","gc.fillStyle":"reverbGen.generateGraph~gc.fillStyle","xscale":"reverbGen.generateGraph~xscale","yscale":"reverbGen.generateGraph~yscale","i":"reverbGen.generateGraph~i"}},"description":"<p>Creates a canvas element showing a graph of the given data.</p>","params":[{"type":{"names":["Float32Array"]},"nullable":false,"description":"<p>An array of numbers, or a Float32Array.</p>","name":"data"},{"type":{"names":["number"]},"description":"<p>Width in pixels of the canvas.</p>","name":"width"},{"type":{"names":["number"]},"description":"<p>Height in pixels of the canvas.</p>","name":"height"},{"type":{"names":["number"]},"description":"<p>Minimum value of data for the graph (lower edge).</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>Maximum value of data in the graph (upper edge).</p>","name":"max"}],"returns":[{"type":{"names":["CanvasElement"]},"nullable":false,"description":"<p>The generated canvas element.</p>"}],"name":"generateGraph","longname":"reverbGen.generateGraph","kind":"function","memberof":"reverbGen","scope":"static"},{"comment":"/** Applies a constantly changing lowpass filter to the given sound.\\n\\n @private\\n @param {!AudioBuffer} input\\n @param {number} lpFreqStart\\n @param {number} lpFreqEnd\\n @param {number} lpFreqEndAt\\n @param {!function(!AudioBuffer)} callback May be called\\n  immediately within the current execution context, or later.*/","meta":{"range":[3419,4357],"filename":"reverbGen.mjs","lineno":83,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103107","name":"applyGradualLowpass","type":"FunctionExpression"},"vars":{"channelData":"applyGradualLowpass~channelData","context":"applyGradualLowpass~context","player":"applyGradualLowpass~player","player.buffer":"applyGradualLowpass~player.buffer","filter":"applyGradualLowpass~filter","lpFreqStart":"applyGradualLowpass~lpFreqStart","lpFreqEnd":"applyGradualLowpass~lpFreqEnd","filter.type":"applyGradualLowpass~filter.type","filter.Q.value":"applyGradualLowpass~filter.Q.value","context.oncomplete":"applyGradualLowpass~context.oncomplete","":null,"window.filterNode":"window.filterNode"}},"description":"<p>Applies a constantly changing lowpass filter to the given sound.</p>","access":"private","params":[{"type":{"names":["AudioBuffer"]},"nullable":false,"name":"input"},{"type":{"names":["number"]},"name":"lpFreqStart"},{"type":{"names":["number"]},"name":"lpFreqEnd"},{"type":{"names":["number"]},"name":"lpFreqEndAt"},{"type":{"names":["function"]},"nullable":false,"description":"<p>May be called\\nimmediately within the current execution context, or later.</p>","name":"callback"}],"name":"applyGradualLowpass","longname":"applyGradualLowpass","kind":"function","scope":"global"},{"comment":"/** @private\\n @param {!AudioBuffer} buffer\\n @return {!Array.<!Float32Array>} An array containing the Float32Array of each channel's samples. */","meta":{"range":[4508,4691],"filename":"reverbGen.mjs","lineno":116,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103271","name":"getAllChannelData","type":"FunctionExpression"},"vars":{"channels":"getAllChannelData~channels","i":"getAllChannelData~i","channels[undefined]":"getAllChannelData~channels.undefined]"}},"access":"private","params":[{"type":{"names":["AudioBuffer"]},"nullable":false,"name":"buffer"}],"returns":[{"type":{"names":["Array.<!Float32Array>"]},"nullable":false,"description":"<p>An array containing the Float32Array of each channel's samples.</p>"}],"name":"getAllChannelData","longname":"getAllChannelData","kind":"function","scope":"global"},{"comment":"/** @private\\n @return {number} A random number from -1 to 1. */","meta":{"range":[4762,4824],"filename":"reverbGen.mjs","lineno":126,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103306","name":"randomSample","type":"FunctionExpression"}},"access":"private","returns":[{"type":{"names":["number"]},"description":"<p>A random number from -1 to 1.</p>"}],"name":"randomSample","longname":"randomSample","kind":"function","scope":"global","params":[]},{"comment":"/**\\n * Loads a collection of samples to use with \`s\`\\n * @example\\n * samples('github:tidalcycles/dirt-samples');\\n * s(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")\\n * @example\\n * samples({\\n *  bd: '808bd/BD0000.WAV',\\n *  sd: '808sd/SD0010.WAV'\\n *  }, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');\\n * s(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")\\n * @example\\n * samples('shabda:noise,chimp:2')\\n * s(\\"noise <chimp:0*2 chimp:1>\\")\\n * @example\\n * samples('shabda/speech/fr-FR/f:chocolat')\\n * s(\\"chocolat*4\\")\\n */","meta":{"range":[8306,8738],"filename":"sampler.mjs","lineno":247,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100104489","name":"exports.samples","type":"VariableDeclaration"}},"description":"<p>Loads a collection of samples to use with <code>s</code></p>","examples":["samples('github:tidalcycles/dirt-samples');\\ns(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")","samples({\\n bd: '808bd/BD0000.WAV',\\n sd: '808sd/SD0010.WAV'\\n }, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');\\ns(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")","samples('shabda:noise,chimp:2')\\ns(\\"noise <chimp:0*2 chimp:1>\\")","samples('shabda/speech/fr-FR/f:chocolat')\\ns(\\"chocolat*4\\")"],"name":"samples","longname":"samples","kind":"constant","scope":"global"},{"comment":"/**\\n * Register an alias for a bank of sounds.\\n * Optionally accepts a single argument map of bank aliases.\\n * Optionally accepts a single argument string of a path to a JSON file containing bank aliases.\\n * @param {string} bank - The bank to alias\\n * @param {string} alias - The alias to use for the bank\\n */","meta":{"range":[3606,3993],"filename":"superdough.mjs","lineno":96,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100105237","name":"exports.aliasBank","type":"FunctionDeclaration","paramnames":["args"]}},"description":"<p>Register an alias for a bank of sounds.\\nOptionally accepts a single argument map of bank aliases.\\nOptionally accepts a single argument string of a path to a JSON file containing bank aliases.</p>","params":[{"type":{"names":["string"]},"description":"<p>The bank to alias</p>","name":"bank"},{"type":{"names":["string"]},"description":"<p>The alias to use for the bank</p>","name":"alias"}],"name":"aliasBank","longname":"aliasBank","kind":"function","scope":"global"},{"comment":"/**\\n * Register an alias for a sound.\\n * @param {string} original - The original sound name\\n * @param {string} alias - The alias to use for the sound\\n */","meta":{"range":[4149,4346],"filename":"superdough.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100105289","name":"exports.soundAlias","type":"FunctionDeclaration","paramnames":["original","alias"]}},"description":"<p>Register an alias for a sound.</p>","params":[{"type":{"names":["string"]},"description":"<p>The original sound name</p>","name":"original"},{"type":{"names":["string"]},"description":"<p>The alias to use for the sound</p>","name":"alias"}],"name":"soundAlias","longname":"soundAlias","kind":"function","scope":"global"},{"comment":"/**\\n * Loads a collection of wavetables to use with \`s\`\\n *\\n * @name tables\\n */","meta":{"filename":"wavetable.mjs","lineno":180,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{}},"description":"<p>Loads a collection of wavetables to use with <code>s</code></p>","name":"tables","longname":"tables","kind":"member","scope":"global"},{"comment":"/** Apply Hann window in-place */","meta":{"range":[17486,17622],"filename":"worklets.mjs","lineno":640,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116136","name":"PhaseVocoderProcessor#applyHannWindow","type":"MethodDefinition","paramnames":["input"]},"vars":{"":null}},"description":"<p>Apply Hann window in-place</p>","name":"applyHannWindow","longname":"PhaseVocoderProcessor#applyHannWindow","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Compute squared magnitudes for peak finding **/","meta":{"range":[17680,17992],"filename":"worklets.mjs","lineno":647,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116170","name":"PhaseVocoderProcessor#computeMagnitudes","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Compute squared magnitudes for peak finding</p>","name":"computeMagnitudes","longname":"PhaseVocoderProcessor#computeMagnitudes","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Find peaks in spectrum magnitudes **/","meta":{"range":[18040,18511],"filename":"worklets.mjs","lineno":661,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116230","name":"PhaseVocoderProcessor#findPeaks","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Find peaks in spectrum magnitudes</p>","name":"findPeaks","longname":"PhaseVocoderProcessor#findPeaks","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Shift peaks and regions of influence by pitchFactor into new specturm */","meta":{"range":[18594,20657],"filename":"worklets.mjs","lineno":685,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116336","name":"PhaseVocoderProcessor#shiftPeaks","type":"MethodDefinition","paramnames":["pitchFactor"]},"vars":{"":null}},"description":"<p>Shift peaks and regions of influence by pitchFactor into new specturm</p>","name":"shiftPeaks","longname":"PhaseVocoderProcessor#shiftPeaks","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/**  BYTE BEATS */","meta":{"range":[23715,24646],"filename":"worklets.mjs","lineno":848,"columnno":6,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100117050","name":"chyx","type":"ObjectExpression","value":"{\\"bitC\\":\\"\\",\\"br\\":\\"\\",\\"sinf\\":\\"\\",\\"cosf\\":\\"\\",\\"tanf\\":\\"\\",\\"regG\\":\\"\\"}"}},"description":"<p>BYTE BEATS</p>","name":"chyx","longname":"chyx","kind":"constant","scope":"global","params":[]},{"comment":"/**\\n * Equal Power Crossfade function.\\n * Smoothly transitions between signals A and B, maintaining consistent perceived loudness.\\n *\\n * @param {number} a - Signal A (can be a single value or an array value in buffer processing).\\n * @param {number} b - Signal B (can be a single value or an array value in buffer processing).\\n * @param {number} m - Crossfade parameter (0.0 = all A, 1.0 = all B, 0.5 = equal mix).\\n * @returns {number} Crossfaded output value.\\n */","meta":{"range":[850,1009],"filename":"dough.mjs","lineno":23,"columnno":0,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100121405","name":"crossfade","type":"FunctionDeclaration","paramnames":["a","b","m"]},"vars":{"aGain":"crossfade~aGain","bGain":"crossfade~bGain"}},"description":"<p>Equal Power Crossfade function.\\nSmoothly transitions between signals A and B, maintaining consistent perceived loudness.</p>","params":[{"type":{"names":["number"]},"description":"<p>Signal A (can be a single value or an array value in buffer processing).</p>","name":"a"},{"type":{"names":["number"]},"description":"<p>Signal B (can be a single value or an array value in buffer processing).</p>","name":"b"},{"type":{"names":["number"]},"description":"<p>Crossfade parameter (0.0 = all A, 1.0 = all B, 0.5 = equal mix).</p>","name":"m"}],"returns":[{"type":{"names":["number"]},"description":"<p>Crossfaded output value.</p>"}],"name":"crossfade","longname":"crossfade","kind":"function","scope":"global"},{"comment":"/** @type {number} */","meta":{"range":[16818,16825],"filename":"dough.mjs","lineno":660,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124364","name":"id","type":"ClassProperty"}},"type":{"names":["number"]},"name":"id","longname":"DoughVoice#id","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number[]} */","meta":{"range":[16854,16867],"filename":"dough.mjs","lineno":662,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124366","name":"out","type":"ClassProperty"}},"type":{"names":["Array.<number>"]},"name":"out","longname":"DoughVoice#out","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16907,16914],"filename":"dough.mjs","lineno":665,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124370","name":"attack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"attack","longname":"DoughVoice#attack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16953,16959],"filename":"dough.mjs","lineno":667,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124371","name":"decay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"decay","longname":"DoughVoice#decay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16998,17006],"filename":"dough.mjs","lineno":669,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124372","name":"sustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"sustain","longname":"DoughVoice#sustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17033,17041],"filename":"dough.mjs","lineno":671,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124373","name":"release","type":"ClassProperty"}},"type":{"names":["number"]},"name":"release","longname":"DoughVoice#release","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17068,17075],"filename":"dough.mjs","lineno":673,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124374","name":"_begin","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_begin","longname":"DoughVoice#_begin","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17102,17112],"filename":"dough.mjs","lineno":675,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124375","name":"_duration","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_duration","longname":"DoughVoice#_duration","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {any} */","meta":{"range":[17137,17144],"filename":"dough.mjs","lineno":678,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124376","name":"_sound","type":"ClassProperty"}},"type":{"names":["any"]},"name":"_sound","longname":"DoughVoice#_sound","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17171,17185],"filename":"dough.mjs","lineno":680,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124377","name":"_channels","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_channels","longname":"DoughVoice#_channels","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {BufferPlayer[] | undefined} */","meta":{"range":[17232,17241],"filename":"dough.mjs","lineno":682,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124379","name":"_buffers","type":"ClassProperty"}},"type":{"names":["Array.<BufferPlayer>","undefined"]},"name":"_buffers","longname":"DoughVoice#_buffers","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {string | undefined} */","meta":{"range":[17280,17285],"filename":"dough.mjs","lineno":684,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124380","name":"unit","type":"ClassProperty"}},"type":{"names":["string","undefined"]},"name":"unit","longname":"DoughVoice#unit","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[17323,17329],"filename":"dough.mjs","lineno":687,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124381","name":"_penv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_penv","longname":"DoughVoice#_penv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17368,17373],"filename":"dough.mjs","lineno":689,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124382","name":"penv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"penv","longname":"DoughVoice#penv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17412,17420],"filename":"dough.mjs","lineno":691,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124383","name":"pattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"pattack","longname":"DoughVoice#pattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17459,17466],"filename":"dough.mjs","lineno":693,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124384","name":"pdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"pdecay","longname":"DoughVoice#pdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17505,17514],"filename":"dough.mjs","lineno":695,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124385","name":"psustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"psustain","longname":"DoughVoice#psustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17553,17562],"filename":"dough.mjs","lineno":697,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124386","name":"prelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"prelease","longname":"DoughVoice#prelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17602,17606],"filename":"dough.mjs","lineno":700,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124387","name":"vib","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"vib","longname":"DoughVoice#vib","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17654,17661],"filename":"dough.mjs","lineno":704,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124389","name":"vibmod","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"vibmod","longname":"DoughVoice#vibmod","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {SineOsc | undefined} */","meta":{"range":[17702,17706],"filename":"dough.mjs","lineno":707,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124390","name":"_fm","type":"ClassProperty"}},"type":{"names":["SineOsc","undefined"]},"name":"_fm","longname":"DoughVoice#_fm","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17745,17749],"filename":"dough.mjs","lineno":709,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124391","name":"fmh","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmh","longname":"DoughVoice#fmh","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17788,17792],"filename":"dough.mjs","lineno":711,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124392","name":"fmi","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmi","longname":"DoughVoice#fmi","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[17830,17837],"filename":"dough.mjs","lineno":714,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124393","name":"_fmenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_fmenv","longname":"DoughVoice#_fmenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17876,17885],"filename":"dough.mjs","lineno":716,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124394","name":"fmattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmattack","longname":"DoughVoice#fmattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17924,17932],"filename":"dough.mjs","lineno":718,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124395","name":"fmdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmdecay","longname":"DoughVoice#fmdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17971,17981],"filename":"dough.mjs","lineno":720,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124396","name":"fmsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmsustain","longname":"DoughVoice#fmsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18020,18030],"filename":"dough.mjs","lineno":722,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124397","name":"fmrelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmrelease","longname":"DoughVoice#fmrelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18068,18075],"filename":"dough.mjs","lineno":725,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124398","name":"_lpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_lpenv","longname":"DoughVoice#_lpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18123,18132],"filename":"dough.mjs","lineno":728,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124400","name":"lpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpattack","longname":"DoughVoice#lpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18171,18179],"filename":"dough.mjs","lineno":730,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124401","name":"lpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpdecay","longname":"DoughVoice#lpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18218,18228],"filename":"dough.mjs","lineno":732,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124402","name":"lpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpsustain","longname":"DoughVoice#lpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18267,18277],"filename":"dough.mjs","lineno":734,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124403","name":"lprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lprelease","longname":"DoughVoice#lprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18315,18322],"filename":"dough.mjs","lineno":737,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124404","name":"_hpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_hpenv","longname":"DoughVoice#_hpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18361,18367],"filename":"dough.mjs","lineno":739,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124405","name":"hpenv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpenv","longname":"DoughVoice#hpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18406,18415],"filename":"dough.mjs","lineno":741,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124406","name":"hpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpattack","longname":"DoughVoice#hpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18454,18462],"filename":"dough.mjs","lineno":743,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124407","name":"hpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpdecay","longname":"DoughVoice#hpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18501,18511],"filename":"dough.mjs","lineno":745,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124408","name":"hpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpsustain","longname":"DoughVoice#hpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18550,18560],"filename":"dough.mjs","lineno":747,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124409","name":"hprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hprelease","longname":"DoughVoice#hprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18598,18605],"filename":"dough.mjs","lineno":750,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124410","name":"_bpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_bpenv","longname":"DoughVoice#_bpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18644,18650],"filename":"dough.mjs","lineno":752,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124411","name":"bpenv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpenv","longname":"DoughVoice#bpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18689,18698],"filename":"dough.mjs","lineno":754,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124412","name":"bpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpattack","longname":"DoughVoice#bpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18737,18745],"filename":"dough.mjs","lineno":756,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124413","name":"bpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpdecay","longname":"DoughVoice#bpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18784,18794],"filename":"dough.mjs","lineno":758,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124414","name":"bpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpsustain","longname":"DoughVoice#bpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18833,18843],"filename":"dough.mjs","lineno":760,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124415","name":"bprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bprelease","longname":"DoughVoice#bprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18883,18890],"filename":"dough.mjs","lineno":763,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124416","name":"cutoff","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"cutoff","longname":"DoughVoice#cutoff","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18929,18937],"filename":"dough.mjs","lineno":765,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124417","name":"hcutoff","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hcutoff","longname":"DoughVoice#hcutoff","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18976,18982],"filename":"dough.mjs","lineno":767,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124418","name":"bandf","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bandf","longname":"DoughVoice#bandf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19021,19028],"filename":"dough.mjs","lineno":769,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124419","name":"coarse","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"coarse","longname":"DoughVoice#coarse","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19067,19073],"filename":"dough.mjs","lineno":771,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124420","name":"crush","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"crush","longname":"DoughVoice#crush","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19112,19120],"filename":"dough.mjs","lineno":773,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124421","name":"distort","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"distort","longname":"DoughVoice#distort","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[19148,19153],"filename":"dough.mjs","lineno":776,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124422","name":"freq","type":"ClassProperty"}},"type":{"names":["number"]},"name":"freq","longname":"DoughVoice#freq","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {string | undefined} */","meta":{"range":[19192,19197],"filename":"dough.mjs","lineno":778,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124423","name":"note","type":"ClassProperty"}},"type":{"names":["string","undefined"]},"name":"note","longname":"DoughVoice#note","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19253,19258],"filename":"dough.mjs","lineno":781,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124424","name":"_lpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_lpf","longname":"DoughVoice#_lpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19313,19318],"filename":"dough.mjs","lineno":783,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124425","name":"_hpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_hpf","longname":"DoughVoice#_hpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19373,19378],"filename":"dough.mjs","lineno":785,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124426","name":"_bpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_bpf","longname":"DoughVoice#_bpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Chorus[] | null | undefined} */","meta":{"range":[19426,19434],"filename":"dough.mjs","lineno":787,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124427","name":"_chorus","type":"ClassProperty"}},"type":{"names":["Array.<Chorus>","null","undefined"]},"name":"_chorus","longname":"DoughVoice#_chorus","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Coarse[] | null | undefined} */","meta":{"range":[19482,19490],"filename":"dough.mjs","lineno":789,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124428","name":"_coarse","type":"ClassProperty"}},"type":{"names":["Array.<Coarse>","null","undefined"]},"name":"_coarse","longname":"DoughVoice#_coarse","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Crush[] | null | undefined} */","meta":{"range":[19537,19544],"filename":"dough.mjs","lineno":791,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124429","name":"_crush","type":"ClassProperty"}},"type":{"names":["Array.<Crush>","null","undefined"]},"name":"_crush","longname":"DoughVoice#_crush","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Distort[] | null | undefined} */","meta":{"range":[19593,19602],"filename":"dough.mjs","lineno":793,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124430","name":"_distort","type":"ClassProperty"}},"type":{"names":["Array.<Distort>","null","undefined"]},"name":"_distort","longname":"DoughVoice#_distort","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/**\\n   * @param {DoughVoice} value\\n   */","meta":{"range":[19649,24138],"filename":"dough.mjs","lineno":798,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124431","name":"exports.DoughVoice","type":"MethodDefinition","paramnames":["value"]},"vars":{"":null}},"params":[{"type":{"names":["DoughVoice"]},"name":"value"}],"name":"DoughVoice","longname":"DoughVoice#DoughVoice","kind":"class","memberof":"DoughVoice","scope":"instance"},{"comment":"/**\\n * Change the pitch of each value by the given amount. Expects numbers or note strings as values.\\n * The amount can be given as a number of semitones or as a string in interval short notation.\\n * If you don't care about enharmonic correctness, just use numbers. Otherwise, pass the interval of\\n * the form: ST where S is the degree number and T the type of interval with\\n *\\n * - M = major\\n * - m = minor\\n * - P = perfect\\n * - A = augmented\\n * - d = diminished\\n *\\n * Examples intervals:\\n *\\n * - 1P = unison\\n * - 3M = major third\\n * - 3m = minor third\\n * - 4P = perfect fourth\\n * - 4A = augmented fourth\\n * - 5P = perfect fifth\\n * - 5d = diminished fifth\\n *\\n * @param {string | number} amount Either number of semitones or interval string.\\n * @returns Pattern\\n * @memberof Pattern\\n * @name transpose\\n * @synonyms trans\\n * @example\\n * \\"c2 c3\\".fast(2).transpose(\\"<0 -2 5 3>\\".slow(2)).note()\\n * @example\\n * \\"c2 c3\\".fast(2).transpose(\\"<1P -2M 4P 3m>\\".slow(2)).note()\\n */","meta":{"filename":"tonal.mjs","lineno":73,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Change the pitch of each value by the given amount. Expects numbers or note strings as values.\\nThe amount can be given as a number of semitones or as a string in interval short notation.\\nIf you don't care about enharmonic correctness, just use numbers. Otherwise, pass the interval of\\nthe form: ST where S is the degree number and T the type of interval with</p>\\n<ul>\\n<li>M = major</li>\\n<li>m = minor</li>\\n<li>P = perfect</li>\\n<li>A = augmented</li>\\n<li>d = diminished</li>\\n</ul>\\n<p>Examples intervals:</p>\\n<ul>\\n<li>1P = unison</li>\\n<li>3M = major third</li>\\n<li>3m = minor third</li>\\n<li>4P = perfect fourth</li>\\n<li>4A = augmented fourth</li>\\n<li>5P = perfect fifth</li>\\n<li>5d = diminished fifth</li>\\n</ul>","params":[{"type":{"names":["string","number"]},"description":"<p>Either number of semitones or interval string.</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"memberof":"Pattern","name":"transpose","synonyms_text":"trans","synonyms":["trans"],"examples":["\\"c2 c3\\".fast(2).transpose(\\"<0 -2 5 3>\\".slow(2)).note()","\\"c2 c3\\".fast(2).transpose(\\"<1P -2M 4P 3m>\\".slow(2)).note()"],"scope":"static","longname":"Pattern.transpose","kind":"member"},{"comment":"/**\\n * Transposes notes inside the scale by the number of steps.\\n * Expected to be called on a Pattern which already has a {@link Pattern#scale}\\n *\\n * @memberof Pattern\\n * @name scaleTranspose\\n * @param {offset} offset number of steps inside the scale\\n * @returns Pattern\\n * @synonyms scaleTrans, strans\\n * @example\\n * \\"-8 [2,4,6]\\"\\n * .scale('C4 bebop major')\\n * .scaleTranspose(\\"<0 -1 -2 -3 -4 -5 -6 -4>\\")\\n * .note()\\n */","meta":{"filename":"tonal.mjs","lineno":143,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Transposes notes inside the scale by the number of steps.\\nExpected to be called on a Pattern which already has a {@link Pattern#scale}</p>","memberof":"Pattern","name":"scaleTranspose","params":[{"type":{"names":["offset"]},"description":"<p>number of steps inside the scale</p>","name":"offset"}],"returns":[{"description":"<p>Pattern</p>"}],"synonyms_text":"scaleTrans, strans","synonyms":["scaleTrans","strans"],"examples":["\\"-8 [2,4,6]\\"\\n.scale('C4 bebop major')\\n.scaleTranspose(\\"<0 -1 -2 -3 -4 -5 -6 -4>\\")\\n.note()"],"scope":"static","longname":"Pattern.scaleTranspose","kind":"member"},{"comment":"/**\\n * Turns numbers into notes in the scale (zero indexed) or quantizes notes to a scale.\\n *\\n * When describing notes via numbers, note that negative numbers can be used to wrap backwards\\n * in the scale as well as sharps or flats (but not both) to produce notes outside of the scale.\\n *\\n * Also sets scale for other scale operations, like {@link Pattern#scaleTranspose}.\\n *\\n * A scale consists of a root note (e.g. \`c4\`, \`c\`, \`f#\`, \`bb4\`) followed by semicolon (':') and then a [scale type](https://github.com/tonaljs/tonal/blob/main/packages/scale-type/data.ts).\\n *\\n * The root note defaults to octave 3, if no octave number is given.\\n *\\n * @name scale\\n * @param {string} scale Name of scale\\n * @returns Pattern\\n * @example\\n * n(\\"0 2 4 6 4 2\\").scale(\\"C:major\\")\\n * @example\\n * n(\\"[0,7] 4 [2,7] 4\\")\\n * .scale(\\"C:<major minor>/2\\")\\n * .s(\\"piano\\")\\n * @example\\n * n(rand.range(0,12).segment(8))\\n * .scale(\\"C:ritusen\\")\\n * .s(\\"piano\\")\\n * @example\\n * n(\\"<[0,7b] [-4# -4] [-2,7##] 4 [0,7] [-4# -4b] [-2,7###] 4b>*4\\")\\n * .scale(\\"C:<major minor>/2\\")\\n * .s(\\"piano\\")\\n * @example\\n * note(\\"C1*16\\").transpose(irand(36)).scale('Cb2 major').scaleTranspose(3)\\n */","meta":{"filename":"tonal.mjs","lineno":225,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Turns numbers into notes in the scale (zero indexed) or quantizes notes to a scale.</p>\\n<p>When describing notes via numbers, note that negative numbers can be used to wrap backwards\\nin the scale as well as sharps or flats (but not both) to produce notes outside of the scale.</p>\\n<p>Also sets scale for other scale operations, like {@link Pattern#scaleTranspose}.</p>\\n<p>A scale consists of a root note (e.g. <code>c4</code>, <code>c</code>, <code>f#</code>, <code>bb4</code>) followed by semicolon (':') and then a <a href=\\"https://github.com/tonaljs/tonal/blob/main/packages/scale-type/data.ts\\">scale type</a>.</p>\\n<p>The root note defaults to octave 3, if no octave number is given.</p>","name":"scale","params":[{"type":{"names":["string"]},"description":"<p>Name of scale</p>","name":"scale"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0 2 4 6 4 2\\").scale(\\"C:major\\")","n(\\"[0,7] 4 [2,7] 4\\")\\n.scale(\\"C:<major minor>/2\\")\\n.s(\\"piano\\")","n(rand.range(0,12).segment(8))\\n.scale(\\"C:ritusen\\")\\n.s(\\"piano\\")","n(\\"<[0,7b] [-4# -4] [-2,7##] 4 [0,7] [-4# -4b] [-2,7###] 4b>*4\\")\\n.scale(\\"C:<major minor>/2\\")\\n.s(\\"piano\\")","note(\\"C1*16\\").transpose(irand(36)).scale('Cb2 major').scaleTranspose(3)"],"longname":"scale","kind":"member","scope":"global"},{"comment":"/**\\n * Adds a new custom voicing dictionary.\\n *\\n * @name addVoicings\\n * @memberof Pattern\\n * @param {string} name identifier for the voicing dictionary\\n * @param {Object} dictionary maps chord symbol to possible voicings\\n * @param {Array} range min, max note\\n * @returns Pattern\\n * @example\\n * addVoicings('cookie', {\\n *   7: ['3M 7m 9M 12P 15P', '7m 10M 13M 16M 19P'],\\n *   '^7': ['3M 6M 9M 12P 14M', '7M 10M 13M 16M 19P'],\\n *   m7: ['8P 11P 14m 17m 19P', '5P 8P 11P 14m 17m'],\\n *   m7b5: ['3m 5d 8P 11P 14m', '5d 8P 11P 14m 17m'],\\n *   o7: ['3m 6M 9M 11A 15P'],\\n *   '7alt': ['3M 7m 10m 13m 15P'],\\n *   '7#11': ['7m 10m 13m 15P 17m'],\\n * }, ['C3', 'C6'])\\n * \\"<C^7 A7 Dm7 G7>\\".voicings('cookie').note()\\n */","meta":{"filename":"voicings.mjs","lineno":89,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Adds a new custom voicing dictionary.</p>","name":"addVoicings","memberof":"Pattern","params":[{"type":{"names":["string"]},"description":"<p>identifier for the voicing dictionary</p>","name":"name"},{"type":{"names":["Object"]},"description":"<p>maps chord symbol to possible voicings</p>","name":"dictionary"},{"type":{"names":["Array"]},"description":"<p>min, max note</p>","name":"range"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["addVoicings('cookie', {\\n  7: ['3M 7m 9M 12P 15P', '7m 10M 13M 16M 19P'],\\n  '^7': ['3M 6M 9M 12P 14M', '7M 10M 13M 16M 19P'],\\n  m7: ['8P 11P 14m 17m 19P', '5P 8P 11P 14m 17m'],\\n  m7b5: ['3m 5d 8P 11P 14m', '5d 8P 11P 14m 17m'],\\n  o7: ['3m 6M 9M 11A 15P'],\\n  '7alt': ['3M 7m 10m 13m 15P'],\\n  '7#11': ['7m 10m 13m 15P 17m'],\\n}, ['C3', 'C6'])\\n\\"<C^7 A7 Dm7 G7>\\".voicings('cookie').note()"],"scope":"static","longname":"Pattern.addVoicings","kind":"member"},{"comment":"/**\\n * DEPRECATED: still works, but it is recommended you use .voicing instead (without s).\\n * Turns chord symbols into voicings, using the smoothest voice leading possible.\\n * Uses [chord-voicings package](https://github.com/felixroos/chord-voicings#chord-voicings).\\n *\\n * @name voicings\\n * @memberof Pattern\\n * @param {string} dictionary which voicing dictionary to use.\\n * @returns Pattern\\n * @example\\n * stack(\\"<C^7 A7 Dm7 G7>\\".voicings('lefthand'), \\"<C3 A2 D3 G2>\\").note()\\n */","meta":{"filename":"voicings.mjs","lineno":130,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>DEPRECATED: still works, but it is recommended you use .voicing instead (without s).\\nTurns chord symbols into voicings, using the smoothest voice leading possible.\\nUses <a href=\\"https://github.com/felixroos/chord-voicings#chord-voicings\\">chord-voicings package</a>.</p>","name":"voicings","memberof":"Pattern","params":[{"type":{"names":["string"]},"description":"<p>which voicing dictionary to use.</p>","name":"dictionary"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["stack(\\"<C^7 A7 Dm7 G7>\\".voicings('lefthand'), \\"<C3 A2 D3 G2>\\").note()"],"scope":"static","longname":"Pattern.voicings","kind":"member"},{"comment":"/**\\n * Maps the chords of the incoming pattern to root notes in the given octave.\\n *\\n * @name rootNotes\\n * @memberof Pattern\\n * @param {octave} octave octave to use\\n * @returns Pattern\\n * @example\\n * \\"<C^7 A7 Dm7 G7>\\".rootNotes(2).note()\\n */","meta":{"filename":"voicings.mjs","lineno":156,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Maps the chords of the incoming pattern to root notes in the given octave.</p>","name":"rootNotes","memberof":"Pattern","params":[{"type":{"names":["octave"]},"description":"<p>octave to use</p>","name":"octave"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<C^7 A7 Dm7 G7>\\".rootNotes(2).note()"],"scope":"static","longname":"Pattern.rootNotes","kind":"member"},{"comment":"/**\\n * Turns chord symbols into voicings. You can use the following control params:\\n *\\n * - \`chord\`: Note, followed by chord symbol, e.g. C Am G7 Bb^7\\n * - \`dict\`: voicing dictionary to use, falls back to default dictionary\\n * - \`anchor\`: the note that is used to align the chord\\n * - \`mode\`: how the voicing is aligned to the anchor\\n *   - \`below\`: top note <= anchor\\n *   - \`duck\`: top note <= anchor, anchor excluded\\n *   - \`above\`: bottom note >= anchor\\n * - \`offset\`: whole number that shifts the voicing up or down to the next voicing\\n * - \`n\`: if set, the voicing is played like a scale. Overshooting numbers will be octaved\\n *\\n * All of the above controls are optional, except \`chord\`.\\n * If you pass a pattern of strings to voicing, they will be interpreted as chords.\\n *\\n * @name voicing\\n * @returns Pattern\\n * @example\\n * n(\\"0 1 2 3\\").chord(\\"<C Am F G>\\").voicing()\\n */","meta":{"filename":"voicings.mjs","lineno":175,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Turns chord symbols into voicings. You can use the following control params:</p>\\n<ul>\\n<li><code>chord</code>: Note, followed by chord symbol, e.g. C Am G7 Bb^7</li>\\n<li><code>dict</code>: voicing dictionary to use, falls back to default dictionary</li>\\n<li><code>anchor</code>: the note that is used to align the chord</li>\\n<li><code>mode</code>: how the voicing is aligned to the anchor\\n<ul>\\n<li><code>below</code>: top note &lt;= anchor</li>\\n<li><code>duck</code>: top note &lt;= anchor, anchor excluded</li>\\n<li><code>above</code>: bottom note &gt;= anchor</li>\\n</ul>\\n</li>\\n<li><code>offset</code>: whole number that shifts the voicing up or down to the next voicing</li>\\n<li><code>n</code>: if set, the voicing is played like a scale. Overshooting numbers will be octaved</li>\\n</ul>\\n<p>All of the above controls are optional, except <code>chord</code>.\\nIf you pass a pattern of strings to voicing, they will be interpreted as chords.</p>","name":"voicing","returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0 1 2 3\\").chord(\\"<C Am F G>\\").voicing()"],"longname":"voicing","kind":"member","scope":"global"},{"comment":"/**\\n * Renders an oscilloscope for the frequency domain of the audio signal.\\n * @name fscope\\n * @param {string} color line color as hex or color name. defaults to white.\\n * @param {number} scale scales the y-axis. Defaults to 0.25\\n * @param {number} pos y-position relative to screen height. 0 = top, 1 = bottom of screen\\n * @param {number} lean y-axis alignment where 0 = top and 1 = bottom\\n * @param {number} min min value\\n * @param {number} max max value\\n * @example\\n * s(\\"sawtooth\\").fscope()\\n */","meta":{"filename":"scope.mjs","lineno":98,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders an oscilloscope for the frequency domain of the audio signal.</p>","name":"fscope","params":[{"type":{"names":["string"]},"description":"<p>line color as hex or color name. defaults to white.</p>","name":"color"},{"type":{"names":["number"]},"description":"<p>scales the y-axis. Defaults to 0.25</p>","name":"scale"},{"type":{"names":["number"]},"description":"<p>y-position relative to screen height. 0 = top, 1 = bottom of screen</p>","name":"pos"},{"type":{"names":["number"]},"description":"<p>y-axis alignment where 0 = top and 1 = bottom</p>","name":"lean"},{"type":{"names":["number"]},"description":"<p>min value</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>max value</p>","name":"max"}],"examples":["s(\\"sawtooth\\").fscope()"],"longname":"fscope","kind":"member","scope":"global"},{"comment":"/**\\n * Renders an oscilloscope for the time domain of the audio signal.\\n * @name scope\\n * @synonyms tscope\\n * @param {object} config optional config with options:\\n * @param {boolean} align if 1, the scope will be aligned to the first zero crossing. defaults to 1\\n * @param {string} color line color as hex or color name. defaults to white.\\n * @param {number} thickness line thickness. defaults to 3\\n * @param {number} scale scales the y-axis. Defaults to 0.25\\n * @param {number} pos y-position relative to screen height. 0 = top, 1 = bottom of screen\\n * @param {number} trigger amplitude value that is used to align the scope. defaults to 0.\\n * @example\\n * s(\\"sawtooth\\")._scope()\\n */","meta":{"filename":"scope.mjs","lineno":121,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders an oscilloscope for the time domain of the audio signal.</p>","name":"scope","synonyms_text":"tscope","synonyms":["tscope"],"params":[{"type":{"names":["object"]},"description":"<p>optional config with options:</p>","name":"config"},{"type":{"names":["boolean"]},"description":"<p>if 1, the scope will be aligned to the first zero crossing. defaults to 1</p>","name":"align"},{"type":{"names":["string"]},"description":"<p>line color as hex or color name. defaults to white.</p>","name":"color"},{"type":{"names":["number"]},"description":"<p>line thickness. defaults to 3</p>","name":"thickness"},{"type":{"names":["number"]},"description":"<p>scales the y-axis. Defaults to 0.25</p>","name":"scale"},{"type":{"names":["number"]},"description":"<p>y-position relative to screen height. 0 = top, 1 = bottom of screen</p>","name":"pos"},{"type":{"names":["number"]},"description":"<p>amplitude value that is used to align the scope. defaults to 0.</p>","name":"trigger"}],"examples":["s(\\"sawtooth\\")._scope()"],"longname":"scope","kind":"member","scope":"global"},{"comment":"/**\\n * Renders a spectrum analyzer for the incoming audio signal.\\n * @name spectrum\\n * @param {object} config optional config with options:\\n * @param {integer} thickness line thickness in px (default 3)\\n * @param {integer} speed scroll speed (default 1)\\n * @param {integer} min min db (default -80)\\n * @param {integer} max max db (default 0)\\n * @example\\n * n(\\"<0 4 <2 3> 1>*3\\")\\n * .off(1/8, add(n(5)))\\n * .off(1/5, add(n(7)))\\n * .scale(\\"d3:minor:pentatonic\\")\\n * .s('sine')\\n * .dec(.3).room(.5)\\n * ._spectrum()\\n */","meta":{"filename":"spectrum.mjs","lineno":5,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders a spectrum analyzer for the incoming audio signal.</p>","name":"spectrum","params":[{"type":{"names":["object"]},"description":"<p>optional config with options:</p>","name":"config"},{"type":{"names":["integer"]},"description":"<p>line thickness in px (default 3)</p>","name":"thickness"},{"type":{"names":["integer"]},"description":"<p>scroll speed (default 1)</p>","name":"speed"},{"type":{"names":["integer"]},"description":"<p>min db (default -80)</p>","name":"min"},{"type":{"names":["integer"]},"description":"<p>max db (default 0)</p>","name":"max"}],"examples":["n(\\"<0 4 <2 3> 1>*3\\")\\n.off(1/8, add(n(5)))\\n.off(1/5, add(n(7)))\\n.scale(\\"d3:minor:pentatonic\\")\\n.s('sine')\\n.dec(.3).room(.5)\\n._spectrum()"],"longname":"spectrum","kind":"member","scope":"global"},{"kind":"package","longname":"package:undefined","files":["/home/alex/src/strudel/packages/codemirror/autocomplete.mjs","/home/alex/src/strudel/packages/codemirror/basicSetup.mjs","/home/alex/src/strudel/packages/codemirror/codemirror.mjs","/home/alex/src/strudel/packages/codemirror/flash.mjs","/home/alex/src/strudel/packages/codemirror/highlight.mjs","/home/alex/src/strudel/packages/codemirror/html.mjs","/home/alex/src/strudel/packages/codemirror/index.mjs","/home/alex/src/strudel/packages/codemirror/keybindings.mjs","/home/alex/src/strudel/packages/codemirror/slider.mjs","/home/alex/src/strudel/packages/codemirror/themes/CutiePi.mjs","/home/alex/src/strudel/packages/codemirror/themes/algoboy.mjs","/home/alex/src/strudel/packages/codemirror/themes/androidstudio.mjs","/home/alex/src/strudel/packages/codemirror/themes/archBtw.mjs","/home/alex/src/strudel/packages/codemirror/themes/atomone.mjs","/home/alex/src/strudel/packages/codemirror/themes/aura.mjs","/home/alex/src/strudel/packages/codemirror/themes/bbedit.mjs","/home/alex/src/strudel/packages/codemirror/themes/blackscreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/bluescreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/bluescreenlight.mjs","/home/alex/src/strudel/packages/codemirror/themes/darcula.mjs","/home/alex/src/strudel/packages/codemirror/themes/dracula.mjs","/home/alex/src/strudel/packages/codemirror/themes/duotoneDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/duotoneLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/eclipse.mjs","/home/alex/src/strudel/packages/codemirror/themes/fruitDaw.mjs","/home/alex/src/strudel/packages/codemirror/themes/githubDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/githubLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/green-text.mjs","/home/alex/src/strudel/packages/codemirror/themes/gruvboxDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/gruvboxLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/materialDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/materialLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/monokai.mjs","/home/alex/src/strudel/packages/codemirror/themes/noctisLilac.mjs","/home/alex/src/strudel/packages/codemirror/themes/nord.mjs","/home/alex/src/strudel/packages/codemirror/themes/red-text.mjs","/home/alex/src/strudel/packages/codemirror/themes/solarizedDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/solarizedLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/sonic-pink.mjs","/home/alex/src/strudel/packages/codemirror/themes/strudel-theme.mjs","/home/alex/src/strudel/packages/codemirror/themes/sublime.mjs","/home/alex/src/strudel/packages/codemirror/themes/teletext.mjs","/home/alex/src/strudel/packages/codemirror/themes/terminal.mjs","/home/alex/src/strudel/packages/codemirror/themes/theme-helper.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokioNightStorm.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokyoNight.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokyoNightDay.mjs","/home/alex/src/strudel/packages/codemirror/themes/vscodeDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/vscodeLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/whitescreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/xcodeLight.mjs","/home/alex/src/strudel/packages/codemirror/themes.mjs","/home/alex/src/strudel/packages/codemirror/tooltip.mjs","/home/alex/src/strudel/packages/codemirror/vite.config.js","/home/alex/src/strudel/packages/codemirror/widget.mjs","/home/alex/src/strudel/packages/core/bench/pattern.bench.mjs","/home/alex/src/strudel/packages/core/clockworker.js","/home/alex/src/strudel/packages/core/controls.mjs","/home/alex/src/strudel/packages/core/cyclist.mjs","/home/alex/src/strudel/packages/core/drawLine.mjs","/home/alex/src/strudel/packages/core/euclid.mjs","/home/alex/src/strudel/packages/core/evaluate.mjs","/home/alex/src/strudel/packages/core/fraction.mjs","/home/alex/src/strudel/packages/core/hap.mjs","/home/alex/src/strudel/packages/core/index.mjs","/home/alex/src/strudel/packages/core/logger.mjs","/home/alex/src/strudel/packages/core/neocyclist.mjs","/home/alex/src/strudel/packages/core/pattern.mjs","/home/alex/src/strudel/packages/core/pick.mjs","/home/alex/src/strudel/packages/core/repl.mjs","/home/alex/src/strudel/packages/core/signal.mjs","/home/alex/src/strudel/packages/core/speak.mjs","/home/alex/src/strudel/packages/core/state.mjs","/home/alex/src/strudel/packages/core/test/controls.test.mjs","/home/alex/src/strudel/packages/core/test/drawLine.test.mjs","/home/alex/src/strudel/packages/core/test/euclid.test.js","/home/alex/src/strudel/packages/core/test/fraction.test.mjs","/home/alex/src/strudel/packages/core/test/pattern.test.mjs","/home/alex/src/strudel/packages/core/test/solmization.test.js","/home/alex/src/strudel/packages/core/test/util.test.mjs","/home/alex/src/strudel/packages/core/test/value.test.mjs","/home/alex/src/strudel/packages/core/time.mjs","/home/alex/src/strudel/packages/core/timespan.mjs","/home/alex/src/strudel/packages/core/ui.mjs","/home/alex/src/strudel/packages/core/util.mjs","/home/alex/src/strudel/packages/core/value.mjs","/home/alex/src/strudel/packages/core/vite.config.js","/home/alex/src/strudel/packages/core/zyklus.mjs","/home/alex/src/strudel/packages/csound/index.mjs","/home/alex/src/strudel/packages/csound/vite.config.js","/home/alex/src/strudel/packages/desktopbridge/index.mjs","/home/alex/src/strudel/packages/desktopbridge/loggerbridge.mjs","/home/alex/src/strudel/packages/desktopbridge/midibridge.mjs","/home/alex/src/strudel/packages/desktopbridge/oscbridge.mjs","/home/alex/src/strudel/packages/desktopbridge/utils.mjs","/home/alex/src/strudel/packages/draw/animate.mjs","/home/alex/src/strudel/packages/draw/color.mjs","/home/alex/src/strudel/packages/draw/draw.mjs","/home/alex/src/strudel/packages/draw/index.mjs","/home/alex/src/strudel/packages/draw/pianoroll.mjs","/home/alex/src/strudel/packages/draw/pitchwheel.mjs","/home/alex/src/strudel/packages/draw/spiral.mjs","/home/alex/src/strudel/packages/draw/vite.config.js","/home/alex/src/strudel/packages/embed/embed.js","/home/alex/src/strudel/packages/gamepad/gamepad.mjs","/home/alex/src/strudel/packages/gamepad/index.mjs","/home/alex/src/strudel/packages/gamepad/vite.config.js","/home/alex/src/strudel/packages/hs2js/src/hs2js.mjs","/home/alex/src/strudel/packages/hs2js/src/index.mjs","/home/alex/src/strudel/packages/hs2js/src/parser.mjs","/home/alex/src/strudel/packages/hs2js/vite.config.js","/home/alex/src/strudel/packages/hydra/hydra.mjs","/home/alex/src/strudel/packages/hydra/vite.config.js","/home/alex/src/strudel/packages/midi/index.mjs","/home/alex/src/strudel/packages/midi/midi.mjs","/home/alex/src/strudel/packages/midi/vite.config.js","/home/alex/src/strudel/packages/mini/bench/mini.bench.mjs","/home/alex/src/strudel/packages/mini/index.mjs","/home/alex/src/strudel/packages/mini/krill-parser.js","/home/alex/src/strudel/packages/mini/mini.mjs","/home/alex/src/strudel/packages/mini/test/mini.test.mjs","/home/alex/src/strudel/packages/mini/vite.config.js","/home/alex/src/strudel/packages/mondo/mondo.mjs","/home/alex/src/strudel/packages/mondo/test/mondo.test.mjs","/home/alex/src/strudel/packages/mondo/vite.config.js","/home/alex/src/strudel/packages/mondough/mondough.mjs","/home/alex/src/strudel/packages/mondough/vite.config.js","/home/alex/src/strudel/packages/motion/index.mjs","/home/alex/src/strudel/packages/motion/motion.mjs","/home/alex/src/strudel/packages/motion/vite.config.js","/home/alex/src/strudel/packages/mqtt/mqtt.mjs","/home/alex/src/strudel/packages/mqtt/vite.config.js","/home/alex/src/strudel/packages/osc/osc.mjs","/home/alex/src/strudel/packages/osc/server.js","/home/alex/src/strudel/packages/osc/superdirtoutput.js","/home/alex/src/strudel/packages/osc/tidal-sniffer.js","/home/alex/src/strudel/packages/osc/vite.config.js","/home/alex/src/strudel/packages/reference/index.mjs","/home/alex/src/strudel/packages/reference/vite.config.js","/home/alex/src/strudel/packages/repl/index.mjs","/home/alex/src/strudel/packages/repl/prebake.mjs","/home/alex/src/strudel/packages/repl/repl-component.mjs","/home/alex/src/strudel/packages/repl/vite.config.js","/home/alex/src/strudel/packages/sampler/sample-server.mjs","/home/alex/src/strudel/packages/serial/serial.mjs","/home/alex/src/strudel/packages/serial/vite.config.js","/home/alex/src/strudel/packages/soundfonts/convert.js","/home/alex/src/strudel/packages/soundfonts/fontloader.mjs","/home/alex/src/strudel/packages/soundfonts/gm.mjs","/home/alex/src/strudel/packages/soundfonts/index.mjs","/home/alex/src/strudel/packages/soundfonts/list.mjs","/home/alex/src/strudel/packages/soundfonts/sfumato.mjs","/home/alex/src/strudel/packages/soundfonts/vite.config.js","/home/alex/src/strudel/packages/superdough/audioContext.mjs","/home/alex/src/strudel/packages/superdough/dspworklet.mjs","/home/alex/src/strudel/packages/superdough/feedbackdelay.mjs","/home/alex/src/strudel/packages/superdough/fft.js","/home/alex/src/strudel/packages/superdough/helpers.mjs","/home/alex/src/strudel/packages/superdough/index.mjs","/home/alex/src/strudel/packages/superdough/logger.mjs","/home/alex/src/strudel/packages/superdough/noise.mjs","/home/alex/src/strudel/packages/superdough/ola-processor.js","/home/alex/src/strudel/packages/superdough/reverb.mjs","/home/alex/src/strudel/packages/superdough/reverbGen.mjs","/home/alex/src/strudel/packages/superdough/sampler.mjs","/home/alex/src/strudel/packages/superdough/superdough.mjs","/home/alex/src/strudel/packages/superdough/superdoughoutput.mjs","/home/alex/src/strudel/packages/superdough/synth.mjs","/home/alex/src/strudel/packages/superdough/util.mjs","/home/alex/src/strudel/packages/superdough/vite.config.js","/home/alex/src/strudel/packages/superdough/vowel.mjs","/home/alex/src/strudel/packages/superdough/wavetable.mjs","/home/alex/src/strudel/packages/superdough/worklets.mjs","/home/alex/src/strudel/packages/superdough/zzfx.mjs","/home/alex/src/strudel/packages/superdough/zzfx_fork.mjs","/home/alex/src/strudel/packages/supradough/dough-export.mjs","/home/alex/src/strudel/packages/supradough/dough-worklet.mjs","/home/alex/src/strudel/packages/supradough/dough.mjs","/home/alex/src/strudel/packages/supradough/index.mjs","/home/alex/src/strudel/packages/tidal/tidal.mjs","/home/alex/src/strudel/packages/tonal/index.mjs","/home/alex/src/strudel/packages/tonal/ireal.mjs","/home/alex/src/strudel/packages/tonal/test/tonal.test.mjs","/home/alex/src/strudel/packages/tonal/test/tonleiter.test.mjs","/home/alex/src/strudel/packages/tonal/tonal.mjs","/home/alex/src/strudel/packages/tonal/tonleiter.mjs","/home/alex/src/strudel/packages/tonal/vite.config.js","/home/alex/src/strudel/packages/tonal/voicings.mjs","/home/alex/src/strudel/packages/transpiler/index.mjs","/home/alex/src/strudel/packages/transpiler/test/transpiler.test.mjs","/home/alex/src/strudel/packages/transpiler/transpiler.mjs","/home/alex/src/strudel/packages/transpiler/vite.config.js","/home/alex/src/strudel/packages/vite-plugin-bundle-audioworklet/vite-plugin-bundle-audioworklet.js","/home/alex/src/strudel/packages/web/vite.config.js","/home/alex/src/strudel/packages/web/web.mjs","/home/alex/src/strudel/packages/webaudio/index.mjs","/home/alex/src/strudel/packages/webaudio/scope.mjs","/home/alex/src/strudel/packages/webaudio/spectrum.mjs","/home/alex/src/strudel/packages/webaudio/supradough.mjs","/home/alex/src/strudel/packages/webaudio/vite.config.js","/home/alex/src/strudel/packages/webaudio/webaudio.mjs","/home/alex/src/strudel/packages/xen/index.mjs","/home/alex/src/strudel/packages/xen/test/xen.test.mjs","/home/alex/src/strudel/packages/xen/tune.mjs","/home/alex/src/strudel/packages/xen/tunejs.js","/home/alex/src/strudel/packages/xen/vite.config.js","/home/alex/src/strudel/packages/xen/xen.mjs"]}]`),iC={docs:a5e};let r5e=n=>{const e=document.createElement("template");return e.innerHTML=n.trim(),e.content.childNodes},iF=n=>Array.isArray(n)?n.flat().join(""):n===void 0?"":n,o5e=(n,...e)=>{let t="";for(let s in n)t+=iF(n[s]),t+=iF(e[s]);return r5e(t)};function K3(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function J3(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var GH=[0,2,4,-1,1,3,5],XH=GH.map(n=>Math.floor(n*7/12));function WH(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=GH[e]+7*t;if(s===void 0)return[a*r];const o=s-XH[e]-4*t;return[a*r,a*o]}var i5e=[3,0,4,1,5,2,6];function qH(n){const[e,t,s]=n,a=i5e[l5e(e)],r=Math.floor((e+1)/7);if(t===void 0)return{step:a,alt:r,dir:s};const o=t+4*r+XH[a];return{step:a,alt:r,oct:o,dir:s}}function l5e(n){const e=(n+1)%7;return e<0?7+e:e}var lF=(n,e)=>Array(Math.abs(e)+1).join(n),lC=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),c5e="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",u5e="(AA|A|P|M|m|d|dd)([-+]?\\d+)",h5e=new RegExp("^"+c5e+"|"+u5e+"$");function d5e(n){const e=h5e.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var cF={};function Wl(n){return typeof n=="string"?cF[n]||(cF[n]=m5e(n)):J3(n)?Wl(f5e(n)):K3(n)?Wl(n.name):lC}var uF=[0,2,4,5,7,9,11],UH="PMMPPMM";function m5e(n){const e=d5e(n);if(e[0]==="")return lC;const t=+e[0],s=e[1],a=(Math.abs(t)-1)%7,r=UH[a];if(r==="M"&&s==="P")return lC;const o=r==="M"?"majorable":"perfectable",i=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(a+1),u=p5e(o,s),h=Math.floor((Math.abs(t)-1)/7),m=l*(uF[a]+u+12*h),f=(l*(uF[a]+u)%12+12)%12,v=WH({step:a,alt:u,oct:h,dir:l});return{empty:!1,name:i,num:t,q:s,step:a,alt:u,dir:l,type:o,simple:c,semitones:m,chroma:f,coord:v,oct:h}}function HH(n,e){const[t,s=0]=n,a=t*7+s*12<0,r=e||a?[-t,-s,-1]:[t,s,1];return Wl(qH(r))}function p5e(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function f5e(n){const{step:e,alt:t,oct:s=0,dir:a}=n;if(!a)return"";const r=e+1+7*s,o=r===0?e+1:r,i=a<0?"-":"",l=UH[e]==="M"?"majorable":"perfectable";return i+o+g5e(l,t)}function g5e(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?lF("A",e):lF("d",n==="perfectable"?e:e+1)}var hF=(n,e)=>Array(Math.abs(e)+1).join(n),YH=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),dF=new Map,b5e=n=>"CDEFGAB".charAt(n),jw=n=>n<0?hF("b",-n):hF("#",n),e5=n=>n[0]==="b"?-n.length:n.length;function ds(n){const e=JSON.stringify(n),t=dF.get(e);if(t)return t;const s=typeof n=="string"?O5e(n):J3(n)?ds(x5e(n)):K3(n)?ds(n.name):YH;return dF.set(e,s),s}var y5e=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function t5(n){const e=y5e.exec(n);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function v5e(n){return ds(qH(n))}var w5e=(n,e)=>(n%e+e)%e,Ck=[0,2,4,5,7,9,11];function O5e(n){const e=t5(n);if(e[0]===""||e[3]!=="")return YH;const t=e[0],s=e[1],a=e[2],r=(t.charCodeAt(0)+3)%7,o=e5(s),i=a.length?+a:void 0,l=WH({step:r,alt:o,oct:i}),c=t+s+a,u=t+s,h=(Ck[r]+o+120)%12,m=i===void 0?w5e(Ck[r]+o,12)-1188:Ck[r]+o+12*(i+1),f=m>=0&&m<=127?m:null,v=i===void 0?null:Math.pow(2,(m-69)/12)*440;return{empty:!1,acc:s,alt:o,chroma:h,coord:l,freq:v,height:m,letter:t,midi:f,name:c,oct:i,pc:u,step:r}}function x5e(n){const{step:e,alt:t,oct:s}=n,a=b5e(e);if(!a)return"";const r=a+jw(t);return s||s===0?r+s:r}function al(n,e){const t=ds(n),s=Array.isArray(e)?e:Wl(e).coord;if(t.empty||!s||s.length<2)return"";const a=t.coord,r=a.length===1?[a[0]+s[0]]:[a[0]+s[0],a[1]+s[1]];return v5e(r).name}function KH(n,e){const t=n.length;return s=>{if(!e)return"";const a=s<0?(t- -s%t)%t:s%t,r=Math.floor(s/t),o=al(e,[0,r]);return al(o,n[a])}}function Zw(n,e){const t=ds(n),s=ds(e);if(t.empty||s.empty)return"";const a=t.coord,r=s.coord,o=r[0]-a[0],i=a.length===2&&r.length===2?r[1]-a[1]:-Math.floor(o*7/12),l=s.height===t.height&&s.midi!==null&&t.oct===s.oct&&t.step>s.step;return HH([o,i],l).name}var mF=(n,e)=>Array(e+1).join(n),k5e=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function JH(n){const e=k5e.exec(n);return e?[e[1],e[2],e[3]]:["","",""]}function yv(n){const[e,t,s]=JH(n);if(t==="")return"";let a=4;for(let o=0;o<s.length;o++)a+=s.charAt(o)===","?-1:1;const r=e[0]==="_"?e.replace(/_/g,"b"):e[0]==="^"?e.replace(/\^/g,"#"):"";return t.charCodeAt(0)>96?t.toUpperCase()+r+(a+1):t+r+a}function eY(n){const e=ds(n);if(e.empty||!e.oct&&e.oct!==0)return"";const{letter:t,acc:s,oct:a}=e,r=s[0]==="b"?s.replace(/b/g,"_"):s.replace(/#/g,"^"),o=a>4?t.toLowerCase():t,i=a===5?"":a>4?mF("'",a-5):mF(",",4-a);return r+o+i}function P5e(n,e){return eY(al(yv(n),e))}function S5e(n,e){return Zw(yv(n),yv(e))}var C5e={abcToScientificNotation:yv,scientificToAbcNotation:eY,tokenize:JH,transpose:P5e,distance:S5e};function M5e(n,e){const t=[];for(;e--;t[e]=e+n);return t}function A5e(n,e){const t=[];for(;e--;t[e]=n-e);return t}function E5e(n,e){return n<e?M5e(n,e-n+1):A5e(n,n-e+1)}function D5e(n,e){const t=e.length,s=(n%t+t)%t;return e.slice(s,t).concat(e.slice(0,s))}function T5e(n){return n.filter(e=>e===0||e)}function tY(n){return n.map(e=>ds(e)).filter(e=>!e.empty).sort((e,t)=>e.height-t.height).map(e=>e.name)}function F5e(n){return tY(n).filter((e,t,s)=>t===0||e!==s[t-1])}function N5e(n,e=Math.random){let t,s,a=n.length;for(;a;)t=Math.floor(e()*a--),s=n[a],n[a]=n[t],n[t]=s;return n}function nY(n){return n.length===0?[[]]:nY(n.slice(1)).reduce((e,t)=>e.concat(n.map((s,a)=>{const r=t.slice();return r.splice(a,0,n[0]),r})),[])}const B5e=Object.freeze(Object.defineProperty({__proto__:null,compact:T5e,permutations:nY,range:E5e,rotate:D5e,shuffle:N5e,sortedNoteNames:tY,sortedUniqNoteNames:F5e},Symbol.toStringTag,{value:"Module"}));function $5e(n,e){const t=[];for(;e--;t[e]=e+n);return t}function R5e(n,e){const t=[];for(;e--;t[e]=n-e);return t}function zw(n,e){return n<e?$5e(n,e-n+1):R5e(n,n-e+1)}function ap(n,e){const t=e.length,s=(n%t+t)%t;return e.slice(s,t).concat(e.slice(0,s))}function n5(n){return n.filter(e=>e===0||e)}function _5e(n,e=Math.random){let t,s,a=n.length;for(;a;)t=Math.floor(e()*a--),s=n[a],n[a]=n[t],n[t]=s;return n}function sY(n){return n.length===0?[[]]:sY(n.slice(1)).reduce((e,t)=>e.concat(n.map((s,a)=>{const r=t.slice();return r.splice(a,0,n[0]),r})),[])}var L5e={compact:n5,permutations:sY,range:zw,rotate:ap,shuffle:_5e},Lu={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},s5=n=>Number(n).toString(2).padStart(12,"0"),pF=n=>parseInt(n,2),I5e=/^[01]{12}$/;function a5(n){return I5e.test(n)}var Q5e=n=>typeof n=="number"&&n>=0&&n<=4095,V5e=n=>n&&a5(n.chroma),fF={[Lu.chroma]:Lu};function Ja(n){const e=a5(n)?n:Q5e(n)?s5(n):Array.isArray(n)?J5e(n):V5e(n)?n.chroma:Lu.chroma;return fF[e]=fF[e]||K5e(e)}var j5e=Ja,aY=n=>Ja(n).chroma,Z5e=n=>Ja(n).intervals,z5e=n=>Ja(n).setNum,G5e=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function X5e(n){const e=[];for(let t=0;t<12;t++)n.charAt(t)==="1"&&e.push(G5e[t]);return e}function W5e(n){return Ja(n).intervals.map(e=>al("C",e))}function q5e(){return zw(2048,4095).map(s5)}function r5(n,e=!0){const t=Ja(n).chroma.split("");return n5(t.map((s,a)=>{const r=ap(a,t);return e&&r[0]==="0"?null:r.join("")}))}function U5e(n,e){return Ja(n).setNum===Ja(e).setNum}function Gw(n){const e=Ja(n).setNum;return t=>{const s=Ja(t).setNum;return e&&e!==s&&(s&e)===s}}function Xw(n){const e=Ja(n).setNum;return t=>{const s=Ja(t).setNum;return e&&e!==s&&(s|e)===s}}function rY(n){const e=Ja(n);return t=>{const s=ds(t);return e&&!s.empty&&e.chroma.charAt(s.chroma)==="1"}}function H5e(n){const e=rY(n);return t=>t.filter(e)}var oY={get:Ja,chroma:aY,num:z5e,intervals:Z5e,chromas:q5e,isSupersetOf:Xw,isSubsetOf:Gw,isNoteIncludedIn:rY,isEqual:U5e,filter:H5e,modes:r5,notes:W5e,pcset:j5e};function Y5e(n){const e=n.split("");return e.map((t,s)=>ap(s,e).join(""))}function K5e(n){const e=pF(n),t=Y5e(n).map(pF).filter(r=>r>=2048).sort()[0],s=s5(t),a=X5e(n);return{empty:!1,name:"",setNum:e,chroma:n,normalized:s,intervals:a}}function J5e(n){if(n.length===0)return Lu.chroma;let e;const t=[0,0,0,0,0,0,0,0,0,0,0,0];for(let s=0;s<n.length;s++)e=ds(n[s]),e.empty&&(e=Wl(n[s])),e.empty||(t[e.chroma]=1);return t.join("")}var eEe=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],tEe=eEe;({...Lu});var o5=[],p1={};function iY(){return o5.slice()}function nEe(n,e,t){const s=aEe(n),a={...Ja(n),name:t||"",quality:s,intervals:n,aliases:e};o5.push(a),a.name&&(p1[a.name]=a),p1[a.setNum]=a,p1[a.chroma]=a,a.aliases.forEach(r=>sEe(a,r))}function sEe(n,e){p1[e]=n}function aEe(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}tEe.forEach(([n,e,t])=>nEe(n.split(" "),t.split(" "),e));o5.sort((n,e)=>n.setNum-e.setNum);var rEe=n=>{const e=n.reduce((t,s)=>{const a=ds(s).chroma;return a!==void 0&&(t[a]=t[a]||ds(s).name),t},{});return t=>e[t]};function oEe(n,e={}){const t=n.map(s=>ds(s).pc).filter(s=>s);return ds.length===0?[]:mEe(t,1,e).filter(s=>s.weight).sort((s,a)=>a.weight-s.weight).map(s=>s.name)}var Ww={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},qw=n=>e=>!!(e&n),iEe=qw(Ww.anyThirds),lEe=qw(Ww.perfectFifth),cEe=qw(Ww.anySeventh),uEe=qw(Ww.nonPerfectFifths);function hEe(n){const e=parseInt(n.chroma,2);return iEe(e)&&lEe(e)&&cEe(e)}function dEe(n){const e=parseInt(n,2);return uEe(e)?n:(e|16).toString(2)}function mEe(n,e,t){const s=n[0],a=ds(s).chroma,r=rEe(n),o=r5(n,!1),i=[];return o.forEach((l,c)=>{const u=t.assumePerfectFifth&&dEe(l);iY().filter(h=>t.assumePerfectFifth&&hEe(h)?h.chroma===u:h.chroma===l).forEach(h=>{const m=h.aliases[0],f=r(c);c!==a?i.push({weight:.5*e,name:`${f}${m}/${s}`}):i.push({weight:1*e,name:`${f}${m}`})})}),i}function h0(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}var lY=[0,2,4,5,7,9,11],cY=({step:n,alt:e})=>(lY[n]+e+120)%12,i5=({step:n,alt:e,oct:t,dir:s=1})=>s*(lY[n]+e+12*(t===void 0?-100:t)),uY=n=>{const e=i5(n);return n.oct!==void 0&&e>=-12&&e<=115?e+12:null};function Uw(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"}var hY=[0,2,4,-1,1,3,5],dY=hY.map(n=>Math.floor(n*7/12));function Hw(n){const{step:e,alt:t,oct:s,dir:a=1}=n,r=hY[e]+7*t;if(s===void 0)return[a*r];const o=s-dY[e]-4*t;return[a*r,a*o]}var pEe=[3,0,4,1,5,2,6];function Yw(n){const[e,t,s]=n,a=pEe[fEe(e)],r=Math.floor((e+1)/7);if(t===void 0)return{step:a,alt:r,dir:s};const o=t+4*r+dY[a];return{step:a,alt:r,oct:o,dir:s}}function fEe(n){const e=(n+1)%7;return e<0?7+e:e}var gF=(n,e)=>Array(Math.abs(e)+1).join(n),cC={empty:!0,name:"",acc:""},gEe="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",bEe="(AA|A|P|M|m|d|dd)([-+]?\\d+)",yEe=new RegExp("^"+gEe+"|"+bEe+"$");function l5(n){const e=yEe.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var bF={};function mr(n){return typeof n=="string"?bF[n]||(bF[n]=vEe(n)):Uw(n)?mr(OEe(n)):h0(n)?mr(n.name):cC}var yF=[0,2,4,5,7,9,11],mY="PMMPPMM";function vEe(n){const e=l5(n);if(e[0]==="")return cC;const t=+e[0],s=e[1],a=(Math.abs(t)-1)%7,r=mY[a];if(r==="M"&&s==="P")return cC;const o=r==="M"?"majorable":"perfectable",i=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(a+1),u=wEe(o,s),h=Math.floor((Math.abs(t)-1)/7),m=l*(yF[a]+u+12*h),f=(l*(yF[a]+u)%12+12)%12,v=Hw({step:a,alt:u,oct:h,dir:l});return{empty:!1,name:i,num:t,q:s,step:a,alt:u,dir:l,type:o,simple:c,semitones:m,chroma:f,coord:v,oct:h}}function d0(n,e){const[t,s=0]=n,a=t*7+s*12<0,r=e||a?[-t,-s,-1]:[t,s,1];return mr(Yw(r))}function wEe(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function OEe(n){const{step:e,alt:t,oct:s=0,dir:a}=n;if(!a)return"";const r=e+1+7*s,o=r===0?e+1:r,i=a<0?"-":"",l=mY[e]==="M"?"majorable":"perfectable";return i+o+xEe(l,t)}function xEe(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?gF("A",e):gF("d",n==="perfectable"?e:e+1)}var vF=(n,e)=>Array(Math.abs(e)+1).join(n),pY={empty:!0,name:"",pc:"",acc:""},wF=new Map,c5=n=>"CDEFGAB".charAt(n),u5=n=>n<0?vF("b",-n):vF("#",n),h5=n=>n[0]==="b"?-n.length:n.length;function ql(n){const e=JSON.stringify(n),t=wF.get(e);if(t)return t;const s=typeof n=="string"?SEe(n):Uw(n)?ql(CEe(n)):h0(n)?ql(n.name):pY;return wF.set(e,s),s}var kEe=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Kw(n){const e=kEe.exec(n);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function d5(n){return ql(Yw(n))}var PEe=(n,e)=>(n%e+e)%e,Mk=[0,2,4,5,7,9,11];function SEe(n){const e=Kw(n);if(e[0]===""||e[3]!=="")return pY;const t=e[0],s=e[1],a=e[2],r=(t.charCodeAt(0)+3)%7,o=h5(s),i=a.length?+a:void 0,l=Hw({step:r,alt:o,oct:i}),c=t+s+a,u=t+s,h=(Mk[r]+o+120)%12,m=i===void 0?PEe(Mk[r]+o,12)-1188:Mk[r]+o+12*(i+1),f=m>=0&&m<=127?m:null,v=i===void 0?null:Math.pow(2,(m-69)/12)*440;return{empty:!1,acc:s,alt:o,chroma:h,coord:l,freq:v,height:m,letter:t,midi:f,name:c,oct:i,pc:u,step:r}}function CEe(n){const{step:e,alt:t,oct:s}=n,a=c5(e);if(!a)return"";const r=a+u5(t);return s||s===0?r+s:r}function Mm(n,e){const t=ql(n),s=Array.isArray(e)?e:mr(e).coord;if(t.empty||!s||s.length<2)return"";const a=t.coord,r=a.length===1?[a[0]+s[0]]:[a[0]+s[0],a[1]+s[1]];return d5(r).name}function Jw(n,e){const t=n.length;return s=>{if(!e)return"";const a=s<0?(t- -s%t)%t:s%t,r=Math.floor(s/t),o=Mm(e,[0,r]);return Mm(o,n[a])}}function m5(n,e){const t=ql(n),s=ql(e);if(t.empty||s.empty)return"";const a=t.coord,r=s.coord,o=r[0]-a[0],i=a.length===2&&r.length===2?r[1]-a[1]:-Math.floor(o*7/12),l=s.height===t.height&&s.midi!==null&&t.midi!==null&&t.step>s.step;return d0([o,i],l).name}var fY=(n,e)=>Array(Math.abs(e)+1).join(n);function rp(n,e,t){return function(...s){return console.warn(`${n} is deprecated. Use ${e}.`),t.apply(this,s)}}var gY=rp("isNamed","isNamedPitch",h0);const bY=Object.freeze(Object.defineProperty({__proto__:null,accToAlt:h5,altToAcc:u5,chroma:cY,coordToInterval:d0,coordToNote:d5,coordinates:Hw,deprecate:rp,distance:m5,fillStr:fY,height:i5,interval:mr,isNamed:gY,isNamedPitch:h0,isPitch:Uw,midi:uY,note:ql,pitch:Yw,stepToLetter:c5,tokenizeInterval:l5,tokenizeNote:Kw,tonicIntervalsTransposer:Jw,transpose:Mm},Symbol.toStringTag,{value:"Module"}));var MEe=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],AEe=MEe,EEe={...Lu,name:"",quality:"Unknown",intervals:[],aliases:[]},op=[],Th={};function p5(n){return Th[n]||EEe}var DEe=rp("ChordType.chordType","ChordType.get",p5);function TEe(){return op.map(n=>n.name).filter(n=>n)}function FEe(){return op.map(n=>n.aliases[0]).filter(n=>n)}function NEe(){return Object.keys(Th)}function eO(){return op.slice()}var BEe=rp("ChordType.entries","ChordType.all",eO);function $Ee(){op=[],Th={}}function yY(n,e,t){const s=_Ee(n),a={...Ja(n),name:t||"",quality:s,intervals:n,aliases:e};op.push(a),a.name&&(Th[a.name]=a),Th[a.setNum]=a,Th[a.chroma]=a,a.aliases.forEach(r=>REe(a,r))}function REe(n,e){Th[e]=n}function _Ee(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}AEe.forEach(([n,e,t])=>yY(n.split(" "),t.split(" "),e));op.sort((n,e)=>n.setNum-e.setNum);var vY={names:TEe,symbols:FEe,get:p5,all:eO,add:yY,removeAll:$Ee,keys:NEe,entries:BEe,chordType:DEe},LEe=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],IEe=LEe,QEe={...Lu,intervals:[],aliases:[]},tO=[],Fh={};function wY(){return tO.map(n=>n.name)}function nO(n){return Fh[n]||QEe}var VEe=nO;function ip(){return tO.slice()}var jEe=ip;function ZEe(){return Object.keys(Fh)}function zEe(){tO=[],Fh={}}function OY(n,e,t=[]){const s={...Ja(n),name:e,intervals:n,aliases:t};return tO.push(s),Fh[s.name]=s,Fh[s.setNum]=s,Fh[s.chroma]=s,s.aliases.forEach(a=>GEe(s,a)),s}function GEe(n,e){Fh[e]=n}IEe.forEach(([n,e,...t])=>OY(n.split(" "),e,t));var xY={names:wY,get:nO,all:ip,add:OY,removeAll:zEe,keys:ZEe,entries:jEe,scaleType:VEe},uC={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function f5(n){const[e,t,s,a]=Kw(n);return e===""?["",n]:e==="A"&&a==="ug"?["","aug"]:[e+t,s+a]}function Kh(n){if(n==="")return uC;if(Array.isArray(n)&&n.length===2)return f1(n[1],n[0]);{const[e,t]=f5(n),s=f1(t,e);return s.empty?f1(n):s}}function f1(n,e,t){const s=p5(n),a=ql(e||""),r=ql(t||"");if(s.empty||e&&a.empty||t&&r.empty)return uC;const o=m5(a.pc,r.pc),i=s.intervals.indexOf(o)+1;if(!r.empty&&!i)return uC;const l=Array.from(s.intervals);for(let m=1;m<i;m++){const f=l[0][0],v=l[0][1],O=parseInt(f,10)+7;l.push(`${O}${v}`),l.shift()}const c=a.empty?[]:l.map(m=>Mm(a,m));n=s.aliases.indexOf(n)!==-1?n:s.aliases[0];const u=`${a.empty?"":a.pc}${n}${r.empty||i<=1?"":"/"+r.pc}`,h=`${e?a.pc+" ":""}${s.name}${i>1&&t?" over "+r.pc:""}`;return{...s,name:h,symbol:u,type:s.name,root:r.name,intervals:l,rootDegree:i,tonic:a.name,notes:c}}var XEe=rp("Chord.chord","Chord.get",Kh);function WEe(n,e){const[t,s]=f5(n);return t?Mm(t,e)+s:n}function qEe(n){const e=Kh(n),t=Xw(e.chroma);return ip().filter(s=>t(s.chroma)).map(s=>s.name)}function UEe(n){const e=Kh(n),t=Xw(e.chroma);return eO().filter(s=>t(s.chroma)).map(s=>e.tonic+s.aliases[0])}function HEe(n){const e=Kh(n),t=Gw(e.chroma);return eO().filter(s=>t(s.chroma)).map(s=>e.tonic+s.aliases[0])}function YEe(n){const{intervals:e,tonic:t}=Kh(n),s=Jw(e,t);return a=>a?s(a>0?a-1:a):""}function KEe(n){const{intervals:e,tonic:t}=Kh(n);return Jw(e,t)}var JEe={getChord:f1,get:Kh,detect:oEe,chordScales:qEe,extended:UEe,reduced:HEe,tokenize:f5,transpose:WEe,degrees:YEe,steps:KEe,chord:XEe},eDe=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],tDe=eDe,sO=[];tDe.forEach(([n,e,t])=>cDe(n,e,t));var nDe={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]};function sDe(){return sO.reduce((n,e)=>(e.names.forEach(t=>n.push(t)),n),[])}function aDe(){return sO.map(n=>n.shorthand)}var rDe=/^([^.]+)(\.*)$/;function g5(n){const[e,t,s]=rDe.exec(n)||[],a=sO.find(i=>i.shorthand===t||i.names.includes(t));if(!a)return nDe;const r=uDe(a.fraction,s.length),o=r[0]/r[1];return{...a,name:n,dots:s,value:o,fraction:r}}var oDe=n=>g5(n).value,iDe=n=>g5(n).fraction,lDe={names:sDe,shorthands:aDe,get:g5,value:oDe,fraction:iDe};function cDe(n,e,t){sO.push({empty:!1,dots:"",name:"",value:1/n,fraction:n<1?[1/n,1]:[1,n],shorthand:e,names:t})}function uDe(n,e){const t=Math.pow(2,e);let s=n[0]*t,a=n[1]*t;const r=s;for(let o=0;o<e;o++)s+=r/Math.pow(2,o+1);for(;s%2===0&&a%2===0;)s/=2,a/=2;return[s,a]}function hDe(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")}var kY=mr,dDe=n=>mr(n).name,mDe=n=>mr(n).semitones,pDe=n=>mr(n).q,fDe=n=>mr(n).num;function gDe(n){const e=mr(n);return e.empty?"":e.simple+e.q}function bDe(n){const e=mr(n);if(e.empty)return"";const t=(7-e.step)%7,s=e.type==="perfectable"?-e.alt:-(e.alt+1);return mr({step:t,alt:s,oct:e.oct,dir:e.dir}).name}var yDe=[1,2,2,3,3,4,5,5,6,6,7,7],vDe="P m M m M P d P m M m M".split(" ");function wDe(n){const e=n<0?-1:1,t=Math.abs(n),s=t%12,a=Math.floor(t/12);return e*(yDe[s]+7*a)+vDe[s]}var ODe=Zw,PY=SY((n,e)=>[n[0]+e[0],n[1]+e[1]]),xDe=n=>e=>PY(n,e),kDe=SY((n,e)=>[n[0]-e[0],n[1]-e[1]]);function PDe(n,e){const t=kY(n);if(t.empty)return"";const[s,a,r]=t.coord;return d0([s+e,a,r]).name}var Xh={names:hDe,get:kY,name:dDe,num:fDe,semitones:mDe,quality:pDe,fromSemitones:wDe,distance:ODe,invert:bDe,simplify:gDe,add:PY,addTo:xDe,substract:kDe,transposeFifths:PDe};function SY(n){return(e,t)=>{const s=mr(e).coord,a=mr(t).coord;if(s&&a){const r=n(s,a);return d0(r).name}}}function CY(n){return+n>=0&&+n<=127}function MY(n){if(CY(n))return+n;const e=ds(n);return e.empty?null:e.midi}function SDe(n,e=440){return Math.pow(2,(n-69)/12)*e}var CDe=Math.log(2),MDe=Math.log(440);function b5(n){const e=12*(Math.log(n)-MDe)/CDe+69;return Math.round(e*100)/100}var ADe="C C# D D# E F F# G G# A A# B".split(" "),EDe="C Db D Eb E F Gb G Ab A Bb B".split(" ");function Wu(n,e={}){if(isNaN(n)||n===-1/0||n===1/0)return"";n=Math.round(n);const t=(e.sharps===!0?ADe:EDe)[n%12];if(e.pitchClass)return t;const s=Math.floor(n/12)-1;return t+s}function y5(n){return n%12}function DDe(n){return n.split("").reduce((e,t,s)=>(s<12&&t==="1"&&e.push(s),e),[])}function TDe(n){return n.map(y5).sort((e,t)=>e-t).filter((e,t,s)=>t===0||e!==s[t-1])}function v5(n){return Array.isArray(n)?TDe(n):DDe(n)}function FDe(n){const e=v5(n);return t=>{const s=y5(t);for(let a=0;a<12;a++){if(e.includes(s+a))return t+a;if(e.includes(s-a))return t-a}}}function AY(n,e){const t=v5(n),s=t.length;return a=>{const r=a<0?(s- -a%s)%s:a%s,o=Math.floor(a/s);return t[r]+o*12+e}}function NDe(n,e){const t=AY(n,e);return s=>{if(s!==0)return t(s>0?s-1:s)}}var BDe={chroma:y5,freqToMidi:b5,isMidi:CY,midiToFreq:SDe,midiToNoteName:Wu,pcsetNearest:FDe,pcset:v5,pcsetDegrees:NDe,pcsetSteps:AY,toMidi:MY},$De=["C","D","E","F","G","A","B"],EY=n=>n.name,DY=n=>n.map(ds).filter(e=>!e.empty);function RDe(n){return n===void 0?$De.slice():Array.isArray(n)?DY(n).map(EY):[]}var rl=ds,_De=n=>rl(n).name,LDe=n=>rl(n).pc,IDe=n=>rl(n).acc,QDe=n=>rl(n).oct,VDe=n=>rl(n).midi,jDe=n=>rl(n).freq,ZDe=n=>rl(n).chroma;function TY(n){return Wu(n)}function zDe(n){return Wu(b5(n))}function GDe(n){return Wu(b5(n),{sharps:!0})}function XDe(n){return Wu(n,{sharps:!0})}var WDe=Zw,Xi=al,qDe=al,FY=n=>e=>Xi(e,n),UDe=FY,NY=n=>e=>Xi(n,e),HDe=NY;function vv(n,e){return Xi(n,[e,0])}var YDe=vv;function KDe(n,e){return Xi(n,[0,e])}var w5=(n,e)=>n.height-e.height,JDe=(n,e)=>e.height-n.height;function BY(n,e){return e=e||w5,DY(n).sort(e).map(EY)}function $Y(n){return BY(n,w5).filter((e,t,s)=>t===0||e!==s[t-1])}var e7e=n=>{const e=rl(n);return e.empty?"":Wu(e.midi||e.chroma,{sharps:e.alt>0,pitchClass:e.midi===null})};function RY(n,e){const t=rl(n);if(t.empty)return"";const s=rl(e||Wu(t.midi||t.chroma,{sharps:t.alt<0,pitchClass:!0}));if(s.empty||s.chroma!==t.chroma)return"";if(t.oct===void 0)return s.pc;const a=t.chroma-t.alt,r=s.chroma-s.alt,o=a>11||r<0?-1:a<0||r>11?1:0,i=t.oct+o;return s.pc+i}var Ll={names:RDe,get:rl,name:_De,pitchClass:LDe,accidentals:IDe,octave:QDe,midi:VDe,ascending:w5,descending:JDe,distance:WDe,sortedNames:BY,sortedUniqNames:$Y,fromMidi:TY,fromMidiSharps:XDe,freq:jDe,fromFreq:zDe,fromFreqSharps:GDe,chroma:ZDe,transpose:Xi,tr:qDe,transposeBy:FY,trBy:UDe,transposeFrom:NY,trFrom:HDe,transposeFifths:vv,transposeOctaves:KDe,trFifths:YDe,simplify:e7e,enharmonic:RY},_Y={empty:!0,name:"",chordType:""},OF={};function Iu(n){return typeof n=="string"?OF[n]||(OF[n]=i7e(n)):typeof n=="number"?Iu(aO[n]||""):J3(n)?s7e(n):K3(n)?Iu(n.name):_Y}var t7e=Iu;function n7e(n=!0){return(n?aO:o7e).slice()}function s7e(n){return Iu(jw(n.alt)+aO[n.step])}var a7e=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function r7e(n){return a7e.exec(n)||["","","",""]}var LY="I II III IV V VI VII",aO=LY.split(" "),o7e=LY.toLowerCase().split(" ");function i7e(n){const[e,t,s,a]=r7e(n);if(!s)return _Y;const r=s.toUpperCase(),o=aO.indexOf(r),i=e5(t),l=1;return{empty:!1,name:e,roman:s,interval:Wl({step:o,alt:i,dir:l}).name,acc:t,chordType:a,alt:i,step:o,major:s===r,oct:0,dir:l}}var l7e={names:n7e,get:Iu,romanNumeral:t7e},Ga=Object.freeze([]),IY={type:"major",tonic:"",alteration:0,keySignature:""},g1={tonic:"",grades:Ga,intervals:Ga,scale:Ga,triads:Ga,chords:Ga,chordsHarmonicFunction:Ga,chordScales:Ga,secondaryDominants:Ga,secondaryDominantSupertonics:Ga,substituteDominantsMinorRelative:Ga,substituteDominants:Ga,substituteDominantSupertonics:Ga,secondaryDominantsMinorRelative:Ga},c7e={...IY,...g1,type:"major",minorRelative:"",scale:Ga,substituteDominants:Ga,secondaryDominantSupertonics:Ga,substituteDominantsMinorRelative:Ga},u7e={...IY,type:"minor",relativeMajor:"",natural:g1,harmonic:g1,melodic:g1},Ak=(n,e,t="")=>e.map((s,a)=>`${n[a]}${t}${s}`);function rO(n,e,t,s,a){return r=>{const o=n.map(f=>Iu(f).interval||""),i=o.map(f=>Xi(r,f)),l=Ak(i,t),c=i.map(f=>Xi(f,"5P")).map(f=>i.includes(f)&&!l.includes(f+"7")?f+"7":""),u=xF(c,e),h=c.map(f=>{if(!f)return"";const v=f.slice(0,-1);return Xi(v,"5d")+"7"}),m=xF(h,e);return{tonic:r,grades:n,intervals:o,scale:i,triads:Ak(i,e),chords:l,chordsHarmonicFunction:s.slice(),chordScales:Ak(i,a," "),secondaryDominants:c,secondaryDominantSupertonics:u,substituteDominants:h,substituteDominantSupertonics:m,secondaryDominantsMinorRelative:u,substituteDominantsMinorRelative:m}}}var xF=(n,e)=>n.map((t,s)=>{if(!t)return"";const a=t.slice(0,-1),r=Xi(a,"5P");return e[s].endsWith("m")?r+"m7":r+"m7b5"}),QY=(n,e)=>{const t=ds(n),s=ds(e);return t.empty||s.empty?0:s.coord[0]-t.coord[0]},h7e=rO("I II III IV V VI VII".split(" ")," m m   m dim".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),d7e=rO("I II bIII IV V bVI bVII".split(" "),"m dim  m m  ".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),m7e=rO("I II bIII IV V bVI VII".split(" "),"m dim aug m   dim".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),p7e=rO("I II bIII IV V VI VII".split(" "),"m m aug   dim dim".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));function f7e(n){const e=ds(n).pc;if(!e)return c7e;const t=h7e(e),s=QY("C",e);return{...t,type:"major",minorRelative:Xi(e,"-3m"),alteration:s,keySignature:jw(s)}}function g7e(n){const e=ds(n).pc;if(!e)return u7e;const t=QY("C",e)-3;return{type:"minor",tonic:e,relativeMajor:Xi(e,"3m"),alteration:t,keySignature:jw(t),natural:d7e(e),harmonic:m7e(e),melodic:p7e(e)}}function b7e(n){return typeof n=="number"?vv("C",n):typeof n=="string"&&/^b+|#+$/.test(n)?vv("C",e5(n)):null}var y7e={majorKey:f7e,majorTonicFromKeySignature:b7e,minorKey:g7e},v7e=Wl;function w7e(n){const e=Wl(n);return e.empty?"":e.simple+e.q}function O7e(n,e){const t=v7e(n);if(t.empty)return"";const[s,a,r]=t.coord;return HH([s+e,a,r]).name}var O5=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],kF={...Lu,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},x5=O5.map(S7e),hC={};x5.forEach(n=>{hC[n.name]=n,n.aliases.forEach(e=>{hC[e]=n})});function Wh(n){return typeof n=="string"?hC[n.toLowerCase()]||kF:n&&n.name?Wh(n.name):kF}var x7e=Wh;function VY(){return x5.slice()}var k7e=VY;function P7e(){return x5.map(n=>n.name)}function S7e(n){const[e,t,s,a,r,o,i]=n,l=i?[i]:[],c=Number(t).toString(2);return{empty:!1,intervals:nO(a).intervals,modeNum:e,chroma:c,normalized:c,name:a,setNum:t,alt:s,triad:r,seventh:o,aliases:l}}function C7e(n,e){return Wh(n).intervals.map(t=>al(e,t))}function jY(n){return(e,t)=>{const s=Wh(e);if(s.empty)return[];const a=ap(s.modeNum,n),r=s.intervals.map(o=>al(t,o));return a.map((o,i)=>r[i]+o)}}var M7e=jY(O5.map(n=>n[4])),A7e=jY(O5.map(n=>n[5]));function ZY(n,e){const t=Wh(e),s=Wh(n);return t.empty||s.empty?"":w7e(O7e("1P",s.alt-t.alt))}function E7e(n,e,t){return al(t,ZY(n,e))}var D7e={get:Wh,names:P7e,all:VY,distance:ZY,relativeTonic:E7e,notes:C7e,triads:M7e,seventhChords:A7e,entries:k7e,mode:x7e};function T7e(n){const[e,t,s,a]=t5(n);return e===""?Ek("",n):e==="A"&&a==="ug"?Ek("","aug"):Ek(e+t,s+a)}function Ek(n,e){const t=e.split("/");if(t.length===1)return[n,t[0],""];const[s,a,r,o]=t5(t[1]);return s!==""&&r===""&&o===""?[n,t[0],s+a]:[n,e,""]}function F7e(n,e){return e.map(Iu).map(t=>al(n,Wl(t))+t.chordType)}function N7e(n,e){return e.map(t=>{const[s,a]=T7e(t),r=Zw(n,s);return Iu(Wl(r)).name+a})}var B7e={fromRomanNumerals:F7e,toRomanNumerals:N7e};function zY(n){const e=n5(n.map(t=>typeof t=="number"?t:MY(t)));return!n.length||e.length!==n.length?[]:e.reduce((t,s)=>{const a=t[t.length-1];return t.concat(zw(a,s).slice(1))},[e[0]])}function $7e(n,e){return zY(n).map(t=>Wu(t,e))}var R7e={numeric:zY,chromatic:$7e},_7e={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function GY(n){if(typeof n!="string")return["",""];const e=n.indexOf(" "),t=ds(n.substring(0,e));if(t.empty){const a=ds(n);return a.empty?["",n]:[a.name,""]}const s=n.substring(t.name.length+1).toLowerCase();return[t.name,s.length?s:""]}var L7e=wY;function Ul(n){const e=Array.isArray(n)?n:GY(n),t=ds(e[0]).name,s=nO(e[1]);if(s.empty)return _7e;const a=s.name,r=t?s.intervals.map(i=>al(t,i)):[],o=t?t+" "+a:a;return{...s,name:o,type:a,tonic:t,notes:r}}var I7e=Ul;function Q7e(n,e={}){const t=aY(n),s=ds(e.tonic??n[0]??""),a=s.chroma;if(a===void 0)return[];const r=t.split("");r[a]="1";const o=ap(a,r).join(""),i=ip().find(c=>c.chroma===o),l=[];return i&&l.push(s.name+" "+i.name),e.match==="exact"||XY(o).forEach(c=>{l.push(s.name+" "+c)}),l}function V7e(n){const e=Ul(n),t=Gw(e.chroma);return iY().filter(s=>t(s.chroma)).map(s=>s.aliases[0])}function XY(n){const e=a5(n)?n:Ul(n).chroma,t=Xw(e);return ip().filter(s=>t(s.chroma)).map(s=>s.name)}function j7e(n){const e=Gw(Ul(n).chroma);return ip().filter(t=>e(t.chroma)).map(t=>t.name)}function WY(n){const e=n.map(a=>ds(a).pc).filter(a=>a),t=e[0],s=$Y(e);return ap(s.indexOf(t),s)}function Z7e(n){const e=Ul(n);if(e.empty)return[];const t=e.tonic?e.notes:e.intervals;return r5(e.chroma).map((s,a)=>{const r=Ul(s).name;return r?[t[a],r]:["",""]}).filter(s=>s[0])}function z7e(n){const e=Array.isArray(n)?WY(n):Ul(n).notes,t=e.map(s=>ds(s).chroma);return s=>{const a=ds(typeof s=="number"?TY(s):s),r=a.height;if(r===void 0)return;const o=r%12,i=t.indexOf(o);if(i!==-1)return RY(a.name,e[i])}}function G7e(n){const e=z7e(n);return(t,s)=>{const a=ds(t).height,r=ds(s).height;return a===void 0||r===void 0?[]:zw(a,r).map(e).filter(o=>o)}}function X7e(n){const{intervals:e,tonic:t}=Ul(n),s=KH(e,t);return a=>a?s(a>0?a-1:a):""}function W7e(n){const{intervals:e,tonic:t}=Ul(n);return KH(e,t)}var Am={degrees:X7e,detect:Q7e,extended:XY,get:Ul,modeNames:Z7e,names:L7e,rangeOf:G7e,reduced:j7e,scaleChords:V7e,scaleNotes:WY,steps:W7e,tokenize:GY,scale:I7e},q7e={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},U7e=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"];function H7e(){return U7e.slice()}var Y7e=/^(\d*\d(?:\+\d)*)\/(\d+)$/,PF=new Map;function K7e(n){const e=JSON.stringify(n),t=PF.get(e);if(t)return t;const s=t9e(k5(n));return PF.set(e,s),s}function k5(n){if(typeof n=="string"){const[r,o,i]=Y7e.exec(n)||[];return k5([o,i])}const[e,t]=n,s=+t;if(typeof e=="number")return[e,s];const a=e.split("+").map(r=>+r);return a.length===1?[a[0],s]:[a,s]}var J7e={names:H7e,parse:k5,get:K7e},e9e=n=>Math.log(n)/Math.log(2)%1===0;function t9e([n,e]){const t=Array.isArray(n)?n.reduce((i,l)=>i+l,0):n,s=e;if(t===0||s===0)return q7e;const a=Array.isArray(n)?`${n.join("+")}/${e}`:`${n}/${e}`,r=Array.isArray(n)?n:[],o=s===4||s===2?"simple":s===8&&t%3===0?"compound":e9e(s)?"irregular":"irrational";return{empty:!1,name:a,type:o,upper:t,lower:s,additive:r}}var n9e=bY,s9e=oY,a9e=vY,r9e=xY;const o9e=Object.freeze(Object.defineProperty({__proto__:null,AbcNotation:C5e,Array:B5e,Chord:JEe,ChordDictionary:a9e,ChordType:vY,Collection:L5e,Core:bY,DurationValue:lDe,Interval:Xh,Key:y7e,Midi:BDe,Mode:D7e,Note:Ll,PcSet:s9e,Pcset:oY,Progression:B7e,Range:R7e,RomanNumeral:l7e,Scale:Am,ScaleDictionary:r9e,ScaleType:xY,TimeSignature:J7e,Tonal:n9e,accToAlt:h5,altToAcc:u5,chroma:cY,coordToInterval:d0,coordToNote:d5,coordinates:Hw,deprecate:rp,distance:m5,fillStr:fY,height:i5,interval:mr,isNamed:gY,isNamedPitch:h0,isPitch:Uw,midi:uY,note:ql,pitch:Yw,stepToLetter:c5,tokenizeInterval:l5,tokenizeNote:Kw,tonicIntervalsTransposer:Jw,transpose:Mm},Symbol.toStringTag,{value:"Module"})),i9e=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],l9e=["c","db","d","eb","e","f","gb","g","ab","a","bb","b"],c9e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],u9e={b:-1,"#":1},h9e=n=>{const[e,...t]=n.split("");return l9e.indexOf(e.toLowerCase())+t.reduce((s,a)=>s+u9e[a],0)};function d9e(n){const e=(n||"").match(/^([A-G][b#]*)([^/]*)[/]?([A-G][b#]*)?$/);return e?e.slice(1):[]}const dC=n=>n%12,qY=n=>{let e=Number(n);return isNaN(e)?Xh.semitones(n):e},mC=(n,e)=>{if(typeof n=="number")return n;if(typeof n=="string")return Ji(n,e)},m9e=(n,e=!1)=>{const t=Math.floor(n/12)-1;return(e?c9e:i9e)[n%12]+t};function p9e(n,e,t=1){n=n.map(a=>typeof a=="string"?Ji(a):a);const s=Math.floor(e/n.length)*t*12;return e=vi(e,n.length),n[e]+s}function UY(n,e,t){let s=0,a=1/0;return e.forEach((r,o)=>{const i=Math.abs(r-n);(!t&&i<a||t&&i<=a)&&(s=o,a=i)}),s}let Dk={};function f9e(n,e,t,s){const[a,r]=Am.tokenize(e),o=mC(a),i=dC(o);if(!Dk[r]){const{intervals:h}=Am.get(`C ${r}`);Dk[r]=h.map(qY)}const l=Dk[r];if(!l)return null;let c=o;if(t){t=mC(t,3);const h=dC(t),m=vi(h-i,12),f=UY(m,l,s);n=n+f,c=t-m}const u=Math.floor(n/l.length)*12;return n=vi(n,l.length),l[n]+c+u}let SF={below:n=>n.slice(-1)[0],duck:n=>n.slice(-1)[0],above:n=>n[0],root:n=>n[0]};function g9e({chord:n,dictionary:e,offset:t=0,n:s,mode:a="below",anchor:r="c5",octaves:o=1}){const[i,l]=d9e(n),c=h9e(i);r=mC((r==null?void 0:r.note)||r,4);const u=dC(r),h=e[l].map(_=>(typeof _=="string"?_.split(" "):_).map(qY));let m,f,v=h.map((_,$)=>{const Z=SF[a](_),ce=vi(u-Z-c,12);return(m===void 0||ce<m)&&(m=ce,f=$),ce});a==="root"&&(f=0);const O=Math.ceil(t/h.length)*12,k=vi(f+t,h.length),M=h[k],E=SF[a](M),I=r-v[k]+O,D=M.map(_=>I-E+_);let F=D.map(_=>m9e(_));return a==="duck"&&(F=F.filter((_,$)=>D[$]!==r)),s!==void 0?[p9e(F,s,o)]:F}const b9e=n=>(n<=0?-1:1)+n*7+"P";function P5(n){n=n.replaceAll(":"," ");const e=Am.get(n),{tonic:t,empty:s}=e;if(s&&Yh(n)||s&&!t)throw new Error(`Scale name ${n} is incomplete. Make sure to use ":" instead of spaces, example: .scale("C:major")`);if(s)throw new Error(`Invalid scale name "${n}"`);return e}function y9e(n,e){n=Math.ceil(n);let{intervals:t,tonic:s}=P5(e);s=s||"C";const{pc:a,oct:r=3}=Ll.get(s),o=Math.floor(n/t.length),i=vi(n,t.length),l=Xh.add(t[i],b9e(o));return Ll.transpose(a+r,l)}function CF(n,e,t){let{notes:s}=P5(n);if(s=s.map(h=>Ll.get(h).pc),e=Number(e),isNaN(e))throw new Error(`scale offset "${e}" not a number`);const{pc:a,oct:r=3}=Ll.get(t),o=s.indexOf(a);if(o===-1)throw new Error(`note "${t}" is not in scale "${n}"`);let i=o,l=r,c=a;const u=Math.sign(e);for(;Math.abs(i-o)<Math.abs(e);){i+=u;const h=vi(i,s.length);u<0&&c[0]==="C"&&(l+=u),c=s[h],u>0&&c[0]==="C"&&(l+=u)}return c+l}const{transpose:Q6e,trans:V6e}=Ie(["transpose","trans"],function(n,e){return e.withHap(t=>{const s=t.value.note??t.value;if(typeof s=="number"){let o;typeof n=="number"?o=n:typeof n=="string"&&(o=Xh.semitones(n)||0);const i=s+o;return typeof t.value=="object"?t.withValue(()=>({...t.value,note:i})):t.withValue(()=>i)}if(typeof s!="string"||!Yh(s))return Za(`[tonal] transpose: not a note "${s}"`,"warning"),t;const a=isNaN(Number(n))?String(n):Xh.fromSemitones(n),r=Ll.transpose(s,a);return typeof t.value=="object"?t.withValue(()=>({...t.value,note:r})):t.withValue(()=>r)})}),{scaleTranspose:j6e,scaleTrans:Z6e,strans:z6e}=Ie(["scaleTranspose","scaleTrans","strans"],function(n,e){return e.withHap(t=>{if(!t.context.scale)throw new Error("can only use scaleTranspose after .scale");if(typeof t.value=="object")return t.withValue(()=>({...t.value,note:CF(t.context.scale,Number(n),t.value.note)}));if(typeof t.value!="string")throw new Error("can only use scaleTranspose with notes");return t.withValue(()=>CF(t.context.scale,Number(n),t.value))})});function v9e(n){let e=Number(n),t=0;if(isNaN(e)){n=String(n);const s=/^(-?\d+)(#+|b+)?$/.exec(n);if(!s)throw new Error(`invalid scale step "${n}", expected number or integer with optional # b suffixes`);e=Number(s[1]);const a=s[2]||"";t=a[0]==="#"?a.length:-a.length}return[e,t]}let Tk={};function w9e(n,e,t=!0){let s=typeof e=="string"?Ji(e):e;if(Tk[n]===void 0){const{intervals:h,tonic:m}=P5(n),{pc:f}=Ll.get(m),v=h.concat("8P").map(k=>Ll.transpose(f+"0",k)),O=v.map(Ji);Tk[n]=[O,v]}const[a,r]=Tk[n],o=a[0],i=Math.floor((s-o)/12),l=a.map(h=>h+12*i),c=UY(s,l,t),u=r[c];return Ll.transpose(u,Xh.fromSemitones(12*i))}const G6e=Ie("scale",function(n,e){return Array.isArray(n)&&(n=n.flat().join(" ")),e.fmap(t=>{const s=typeof t=="object";if(!s||s&&("n"in t||"value"in t)){const a=s?t.n??t.value:t;if(delete t.n,Yh(a))return Ys(a);try{const[r,o]=v9e(a);let i;s&&t.anchor?i=f9e(r,n,t.anchor):i=y9e(r,n),o!=0&&(i=Ll.transpose(i,Xh.fromSemitones(o))),t=Ys(s?{...t,note:i}:i)}catch(r){return Za(`[tonal] ${r.message}`,"error"),us}return t}else{const a=w9e(n,t.note);return Ys(s?{...t,note:a}:a)}}).outerJoin().withHap(t=>t.setContext({...t.context,scale:n}))},!0,!0);var MF={},fb={},Ip={},AF;function HY(){if(AF)return Ip;AF=1,Ip.__esModule=!0,Ip.getBestVoicing=void 0;function n(e){var t=e.chord,s=e.range,a=e.finder,r=e.picker,o=e.lastVoicing,i=a(t,s);return i.length?r(i,o):[]}return Ip.getBestVoicing=n,Ip}var Qp={};const YY=Exe(o9e);var Vp={},EF;function KY(){if(EF)return Vp;EF=1,Vp.__esModule=!0,Vp.tokenizeChord=void 0;function n(e){var t=(e||"").match(/^([A-G][b#]*)([^\/]*)[\/]?([A-G][b#]*)?$/);return t?t.slice(1):[]}return Vp.tokenizeChord=n,Vp}var DF;function O9e(){if(DF)return Qp;DF=1,Qp.__esModule=!0,Qp.voicingsInRange=void 0;var n=YY,e=JY(),t=KY();function s(a,r,o){r===void 0&&(r=e.lefthand),o===void 0&&(o=["D3","A4"]);var i=(0,t.tokenizeChord)(a),l=i[0],c=i[1];if(!r[c])return[];var u=r[c].map(function(m){return m.split(" ")}),h=n.Range.chromatic(o);return u.reduce(function(m,f){var v=f.map(function(E){return n.Interval.substract(E,f[0])}),O=n.Note.transpose(l,f[0]),k=h.filter(function(E){return n.Note.chroma(E)===n.Note.chroma(O)}).filter(function(E){return n.Note.midi(n.Note.transpose(E,v[v.length-1]))<=n.Note.midi(o[1])}).map(function(E){return n.Note.enharmonic(E,O)}),M=k.map(function(E){return v.map(function(I){return n.Note.transpose(E,I)})});return m.concat(M)},[])}return Qp.voicingsInRange=s,Qp}var TF;function JY(){return TF||(TF=1,(function(n){var e=fb.__assign||function(){return e=Object.assign||function(i){for(var l,c=1,u=arguments.length;c<u;c++){l=arguments[c];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(i[h]=l[h])}return i},e.apply(this,arguments)},t=fb.__rest||function(i,l){var c={};for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&l.indexOf(u)<0&&(c[u]=i[u]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,u=Object.getOwnPropertySymbols(i);h<u.length;h++)l.indexOf(u[h])<0&&Object.prototype.propertyIsEnumerable.call(i,u[h])&&(c[u[h]]=i[u[h]]);return c};n.__esModule=!0,n.dictionaryVoicing=n.dictionaryVoicingFinder=n.triads=n.guidetones=n.lefthand=void 0;var s=HY(),a=O9e();n.lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},n.guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},n.triads={M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]};var r=function(i){return function(l,c){return(0,a.voicingsInRange)(l,i,c)}};n.dictionaryVoicingFinder=r;var o=function(i){var l=i.dictionary,c=i.range,u=t(i,["dictionary","range"]);return(0,s.getBestVoicing)(e(e({},u),{range:c,finder:(0,n.dictionaryVoicingFinder)(l)}))};n.dictionaryVoicing=o})(fb)),fb}var jp={},FF;function x9e(){if(FF)return jp;FF=1,jp.__esModule=!0,jp.minTopNoteDiff=void 0;var n=YY;function e(t,s){if(!s)return t[0];var a=function(r){return Math.abs(n.Note.midi(s[s.length-1])-n.Note.midi(r[r.length-1]))};return t.reduce(function(r,o){return a(o)<a(r)?o:r},t[0])}return jp.minTopNoteDiff=e,jp}var NF;function k9e(){return NF||(NF=1,(function(n){n.__esModule=!0;var e=JY(),t=x9e(),s=HY(),a=KY();n.default={tokenizeChord:a.tokenizeChord,getBestVoicing:s.getBestVoicing,dictionaryVoicing:e.dictionaryVoicing,dictionaryVoicingFinder:e.dictionaryVoicingFinder,lefthand:e.lefthand,guidetones:e.guidetones,triads:e.triads,minTopNoteDiff:t.minTopNoteDiff}})(MF)),MF}var P9e=k9e();const BF=kX(P9e),Cd={2:["1P 5P 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P"],5:["1P 5P 8P 12P","5P 8P 12P 15P"],6:["1P 5P 6M 8P 10M","1P 5P 8P 10M 13M","3M 5P 8P 10M 13M","5P 8P 10M 12P 13M"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M"],9:["1P 5P 7m 9M 10M","1P 7m 9M 10M 12P","3M 7m 8P 9M 12P","7m 9M 10M 14m 15P","3M 7m 8P 12P 16M","7m 10M 12P 15P 16M"],11:["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],13:["1P 6M 7m 9M 10M","1P 7m 9M 10M 13M","3M 7m 8P 9M 13M","7m 8P 9M 10M 13M","7m 9M 10M 13M 15P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 8P 9M 13M","5P 8P 9M 10M 13M"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 12P 17M"],"+":["1P 3M 6m 8P 10M","1P 6m 8P 10M 13m","3M 6m 8P 10M 13m","3M 8P 10M 13m 15P","6m 8P 10M 13m 15P","6m 10M 13m 15P 17M"],o:["1P 5d 8P 10m 12d","3m 8P 10m 12d 15P","5d 8P 10m 12d 15P"],h:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P","1P 4P 5P 8P 11P","5P 8P 11P 12P","5P 8P 11P 12P 15P"],"^":["1P 5P 8P 10M","1P 5P 8P 10M 12P","3M 5P 8P 10M 12P","3M 8P 10M 12P 15P","5P 8P 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 5P 8P 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 5P 7M 10M 12P","1P 10M 12P 14M","3M 8P 10M 12P 14M","5P 8P 10M 12P 14M","5P 8P 10M 14M 17M"],"-7":["1P 3m 5P 7m 10m","1P 5P 7m 10m 12P","3m 7m 8P 10m 12P","3m 7m 8P 10m 14m","5P 7m 8P 10m 14m","7m 10m 12P 14m 15P","5P 8P 10m 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 5P 7m 8P 11P","5P 8P 11P 12P 14m","7m 8P 11P 12P 14m","7m 11P 12P 14m 18P"],h7:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 5P 7M 9M 10M","1P 7M 9M 10M 12P","3M 7M 8P 9M 12P","3M 7M 8P 12P 16M","5P 8P 10M 14M 16M","7M 8P 10M 12P 16M"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 8P 13M 16M","7M 8P 10M 13M 16M"],"^7#11":["1P 5P 7M 10M 12d","3M 7M 8P 10M 12d","1P 7M 10M 12d 14M","3M 7M 8P 12d 14M","5P 8P 10M 12d 14M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 8P 9M 12d","3M 8P 9M 12d 14M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 8P 10M 13m","6m 7M 8P 10M 13m"],"-6":["1P 3m 5P 6M 8P","1P 5P 6M 8P 10m","3m 5P 6M 8P 10m","1P 5P 8P 10m 13M","3m 5P 8P 10m 13M","5P 8P 10m 12P 13M","5P 8P 10m 13M 15P"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 10m","1P 5P 7M 10m 12P","3m 7M 8P 10m 12P","5P 7M 8P 10m 14M","5P 8P 10m 14M 17m"],"-^9":["1P 3m 5P 7M 9M","1P 7M 9M 10m 12P","3m 7M 8P 9M 12P","5P 8P 9M 10m 14M"],"-9":["1P 3m 5P 7m 9M","3m 5P 7m 8P 9M","3m 7m 8P 9M 12P","5P 8P 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 12P 15P 16M"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["1P 3m 7m 9M 11P","3m 7m 8P 9M 11P","1P 4P 7m 10m 12P","5P 8P 11P 14m","3m 7m 9M 11P 15P","5P 8P 11P 14m 16M","7m 10m 12P 15P 18P"],"-7b5":["3m 5d 7m 8P 10m","1P 7m 10m 12d","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["1P 7m 9M 10m 12d","3m 7m 8P 9M 12d","5d 8P 9M 10m 14m","7m 10m 12d 15P 16M"],"-b6":["1P 5P 6m 8P 10m","1P 5P 8P 10m 13m","3m 5P 8P 10m 13m","5P 8P 10m 13m","5P 8P 10m 13m 15P"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 10m 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 8P 10m 14m","7m 10m 10M 14m 15P"],"7#11":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7b5":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"7#9#5":["1P 3M 7m 10m 13m","3M 7m 10m 13m 15P","7m 10M 13m 15P 17m"],"7#9b5":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7#9#11":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7b9#11":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9b5":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 8P 9m 10m","7m 8P 10M 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7alt":["3M 7m 8P 9m 12d","1P 7m 10m 10M 13m","3M 7m 8P 10m 13m","3M 7m 9m 12d 15P","3M 7m 10m 13m 15P","7m 10M 12d 15P 17m","7m 10M 13m 15P 17m"],"13#11":["1P 6M 7m 10M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["1P 3M 6M 7m 9m","1P 6M 7m 9m 10M","3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["1P 3M 6M 7m 10m","3M 7m 8P 10m 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","5P 7m 9M 11P 13M","7m 9M 11P 13M 15P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},Yd={2:["1P 5P 6M 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P 13M","5P 8P 9M 12P 15P"],5:["1P 5P 8P 12P","1P 5P 8P 9M 12P","5P 8P 12P 15P","5P 8P 12P 15P 16M"],6:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M","7m 10M 14m 17M 19P"],9:["1P 6M 7m 9M 10M","3M 7m 9M 10M 12P","1P 7m 9M 10M 13M","3M 7m 9M 10M 13M","3M 7m 9M 12P 15P","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],11:["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],13:["3M 7m 9M 10M 13M","3M 7m 9M 13M 15P","3M 7m 10M 13M 16M","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 10M 15P","5P 8P 9M 12P 17M"],"+":["1P 6m 8P 9M 10M","1P 6m 8P 10M 13m","3M 8P 9M 10M 13m","3M 8P 10M 13m 15P","6m 10M 13m 15P 16M","6m 10M 13m 15P 17M"],o:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],h:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P 9M","1P 4P 5P 8P 11P","1P 5P 8P 9M 11P","5P 8P 9M 11P 12P","5P 8P 11P 12P 13M","5P 8P 11P 13M 15P"],"^":["1P 3M 5P 6M 9M","1P 5P 8P 10M 12P","3M 5P 9M 10M 12P","1P 5P 8P 10M 13M","3M 8P 10M 13M 15P","5P 9M 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 3m 5P 9M 11P","3m 5P 8P 9M 11P","5P 8P 9M 10m 11P","1P 5P 9M 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 6M 7M 9M 10M","3M 7M 9M 10M 12P","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"-7":["1P 3m 5P 7m 9M","1P 3m 5P 7m 10m","1P 5P 7m 10m 11P","3m 7m 8P 10m 11P","1P 5P 7m 10m 12P","3m 7m 9M 10m 12P","3m 7m 8P 10m 14m","5P 7m 9M 10m 14m","7m 10m 11P 14m 15P","7m 10m 12P 15P 16M","5P 8P 11P 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],h7:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^7#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 10M 12d 14M","7M 10M 12d 13M 14M","7M 10M 12d 13M 16M","7M 10M 12d 14M 17M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 9M 12d 14M","7M 10M 12d 14M 16M","7M 10M 12d 13M 16M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 9M 10M 13m","3M 7M 10M 13m 14M","7M 10M 13m 14M 16M","7M 10M 13m 14M 17M"],"-6":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","1P 5P 6M 10m 11P","3m 5P 6M 8P 11P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 10m 11P 13M","5P 8P 10m 13M 16M"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-^9":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-9":["1P 3m 5P 7m 9M","1P 3m 7m 9M 11P","3m 7m 9M 10m 11P","3m 7m 9M 10m 12P","3m 7m 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 11P 14m 16M","7m 10m 12P 16M 18P"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["3m 5P 7m 9M 11P","7m 9M 10m 11P","1P 4P 7m 10m 12P","3m 7m 9M 11P 12P","7m 9M 10m 11P 12P","3m 7m 9M 11P 14m","4P 10m 12P 14m","5P 8P 11P 14m","5P 8P 11P 14m 16M","7m 10m 12P 16M 18P","7m 10m 11P 16M 21m"],"-7b5":["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["3m 5d 7m 9M 11P","1P 7m 9M 10m 12d","3m 7m 9M 12d 14m","5d 8P 9M 10m 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 16M"],"-b6":["1P 3m 5P 6m 8P","3m 5P 8P 11P 13m","5P 8P 10m 11P 13m"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 11P 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 10m 10M 12P","3M 7m 10m 12P 14m","7m 10M 12P 14m 17m"],"7#11":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7b5":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"7#9#5":["3M 7m 10m 10M 13m","3M 7m 10m 13m 14m","7m 10M 13m 14m 17m"],"7#9b5":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7#9#11":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7b9#11":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9b5":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 10m 13m 16m","7m 10M 13m 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7alt":["3M 7m 8P 10m 13m","3M 7m 9m 12d 13m","3M 7m 9m 10m 13m","3M 7m 10m 13m 14m","3M 7m 9m 12d 14m","3M 7m 10m 13m 15P","3M 7m 10m 13m 16m","7m 10M 12d 14m 16m","7m 10M 12d 13m 16m","7m 10M 13m 15P 17m","7m 10M 13m 16m 17m","7m 10M 13m 16m 19d"],"13#11":["3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["3M 7m 10m 10M 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","4P 7m 9M 11P 13M","7m 9M 11P 13M 15P","7m 11P 13M 14m 16M","7m 11P 13M 16M 18P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},{dictionaryVoicing:S9e,minTopNoteDiff:C9e}=BF.default||BF,M9e={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},A9e={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},E9e={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]},D9e={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"],m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},m0={lefthand:{dictionary:M9e,range:["F3","A4"],mode:"below",anchor:"a4"},triads:{dictionary:E9e,mode:"below",anchor:"a4"},guidetones:{dictionary:A9e,mode:"above",anchor:"a4"},legacy:{dictionary:D9e,mode:"below",anchor:"a4"}};let eK="ireal";const T9e=n=>eK=n,X6e=(n,e)=>F9e(n,m0[n].dictionary,e),F9e=(n,e,t=["F3","A4"])=>{Object.assign(m0,{[n]:{dictionary:e,range:t}})},tK=(n,e,t={})=>{Object.assign(m0,{[n]:{dictionary:e,...t}})},N9e=(n,e,t)=>{const{dictionary:s,range:a}=m0[e];return S9e({chord:n,dictionary:s,range:a,picker:C9e,lastVoicing:t})};let b1;const W6e=Ie("voicings",function(n,e){return e.fmap(t=>(b1=N9e(t,n,b1),js(...b1))).outerJoin()}),q6e=Ie("rootNotes",function(n,e){return e.fmap(t=>{const s=(t.chord||t).match(/^([a-gA-G][b#]?).*$/)[1]+n;return t.chord?{note:s}:s})}),U6e=Ie("voicing",function(n){return n.fmap(e=>{e=typeof e=="string"?{chord:e}:e;let{dictionary:t=eK,chord:s,anchor:a,offset:r,mode:o,n:i,octaves:l,...c}=e;t=typeof t=="string"?m0[t]:{dictionary:t,mode:"below",anchor:"c5"};try{let u=g9e({...t,chord:s,anchor:a,offset:r,mode:o,n:i,octaves:l});return js(...u).note().set(c)}catch{return Za(`[voicing]: unknown chord "${s}"`),us}}).outerJoin()});function y1(n,e,t){t=Array.isArray(t)?t:[t],t.forEach(s=>{s[e]=s[n]})}y1("^","",[Cd,Yd]);Object.keys(Cd).forEach(n=>{if(n.includes("-")){let e=n.replace("-","m");y1(n,e,[Yd,Cd])}if(n.includes("^")){let e=n.replace("^","M");y1(n,e,[Yd,Cd])}if(n.includes("+")){let e=n.replace("+","aug");y1(n,e,[Yd,Cd])}});tK("ireal",Cd);tK("ireal-ext",Yd);function H6e(){b1=void 0,T9e("ireal")}const B9e=n=>{const e=document.createElement("div");return e.innerText=n,e.innerHTML},$9e=n=>{const e=document.createElement("div");return e.innerHTML=n,e.textContent||e.innerText||""},oO=n=>n.name||n.longname,R9e=n=>n!=null&&n.length?`
    <div class="autocomplete-info-params-section">
      <h4 class="autocomplete-info-section-title">Parameters</h4>
      <ul class="autocomplete-info-params-list">
        ${n.map(({name:e,type:t,description:s})=>{var a;return`
          <li class="autocomplete-info-param-item">
            <span class="autocomplete-info-param-name">${e}</span>
            <span class="autocomplete-info-param-type">${(a=t.names)==null?void 0:a.join(" | ")}</span>
            ${s?`<div class="autocomplete-info-param-desc">${$9e(s)}</div>`:""}
          </li>
        `}).join("")}
      </ul>
    </div>
  `:"",_9e=n=>n!=null&&n.length?`
    <div class="autocomplete-info-examples-section">
      <h4 class="autocomplete-info-section-title">Examples</h4>
      ${n.map(e=>`
        <pre class="autocomplete-info-example-code">${B9e(e)}</pre>
      `).join("")}
    </div>
  `:"",nK=n=>o5e`
  <div class="autocomplete-info-container">
    <div class="autocomplete-info-tooltip">
      <h3 class="autocomplete-info-function-name">${oO(n)}</h3>
      ${n.synonyms_text?`<div class="autocomplete-info-function-synonyms">Synonyms: ${n.synonyms_text}</div>`:""}
      ${n.description?`<div class="autocomplete-info-function-description">${n.description}</div>`:""}
      ${R9e(n.params)}
      ${_9e(n.examples)}
    </div>
  </div>
`[0],L9e=n=>{const e=oO(n);return e&&!e.startsWith("_")&&!["package"].includes(n.kind)},I9e=n=>["superdirtOnly","noAutocomplete"].some(e=>{var t;return(t=n.tags)==null?void 0:t.find(s=>s.originalTitle===e)});function Q9e(){const n=Io.get(),e=new Set;for(const t of Object.keys(n)){const[s,a]=t.split("_");a&&s&&e.add(s)}return Array.from(e).sort().map(t=>({label:t,type:"bank"}))}let sK=[];try{sK=(Am.names?Am.names():[]).map(n=>({label:n,type:"scale"}))}catch(n){console.warn("[autocomplete] Could not load scale names from Tonal:",n)}const V9e=[{label:"below",type:"mode"},{label:"above",type:"mode"},{label:"duck",type:"mode"},{label:"root",type:"mode"}],j9e=["",...Object.keys(Yd)].sort(),Z9e=j9e.map(n=>n===""?{label:"major",apply:"",type:"chord-symbol"}:{label:n,apply:n,type:"chord-symbol"}),aK=(n,e)=>{const t=n.synonyms||[],s=[oO(n),...t].filter(a=>a&&a!==e);return{...n,name:e,longname:e,synonyms:s,synonyms_text:s.join(", ")}},z9e=(()=>{const n=new Set,e=[];for(const t of iC.docs){if(!L9e(t)||I9e(t))continue;const s=oO(t),a=t.synonyms||[];let r=[s,...a];for(const o of r)o&&!n.has(o)&&(n.add(o),e.push({label:o,info:()=>nK(aK(t,o)),type:"function"}))}return e})(),wv=["C","C#","Db","D","D#","Eb","E","E#","Fb","F","F#","Gb","G","G#","Ab","A","A#","Bb","B","B#","Cb"],G9e=/scale\(\s*$/,X9e=/scale\(\s*['"][^'"]*:[^'"]*$/,W9e=/scale\(\s*['"][^'"]*$/,q9e=/([A-Ga-g][#b]*)?$/,U9e=/\s+/g;function H9e(n){let e=n.matchBefore(G9e);if(e)return{from:e.to,options:[]};let t=n.matchBefore(X9e);if(t){const a=t.text,r=a.lastIndexOf(":");if(r!==-1){const o=a.slice(r+1),i=sK.filter(l=>l.label.startsWith(o)).map(l=>({...l,apply:l.label.replace(U9e,":")}));return{from:t.from+r+1,options:i}}}let s=n.matchBefore(W9e);if(s&&!s.text.includes(":"))if(n.explicit){const a=s.text.match(q9e),r=a?a[0]:"",o=wv.filter(c=>c.toLowerCase().startsWith(r.toLowerCase())),i=s.to-r.length,l=o.map(c=>({label:c,type:"pitch"}));return{from:i,options:l}}else return{from:s.to,options:[]};return null}const Y9e=/(s|sound)\(\s*$/,K9e=/(s|sound)\(\s*['"][^'"]*$/,J9e=/(?:[\s[{(<])([\w]*)$/;function e4e(n){let e=n.matchBefore(Y9e);if(e)return{from:e.to,options:[]};let t=n.matchBefore(K9e);if(!t)return null;const s=t.text,a=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(a===-1)return null;const r=s.slice(a+1),o=r.match(J9e),i=o?o[1]:r;let l=Object.keys(Io.get()).sort().filter(c=>c.includes(i)).map(c=>({label:c,type:"sound"}));return{from:t.to-i.length,options:l}}const t4e=/bank\(\s*$/,n4e=/bank\(\s*['"][^'"]*$/;function s4e(n){let e=n.matchBefore(t4e);if(e)return{from:e.to,options:[]};let t=n.matchBefore(n4e);if(!t)return null;const s=t.text,a=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(a===-1)return null;const r=s.slice(a+1),o=Q9e().filter(i=>i.label.startsWith(r));return{from:t.to-r.length,options:o}}const a4e=/mode\(\s*$/,r4e=/mode\(\s*['"][^'"]*:[^'"]*$/,o4e=/mode\(\s*['"][^'"]*$/,i4e=/(?:[\s[{(<])([\w:]*)$/;function l4e(n){let e=n.matchBefore(a4e);if(e)return{from:e.to,options:[]};let t=n.matchBefore(r4e);if(t){const u=t.text,h=u.lastIndexOf(":");if(h!==-1){const m=u.slice(h+1),f=wv.filter(v=>v.toLowerCase().startsWith(m.toLowerCase())).map(v=>({label:v,type:"pitch"}));return{from:t.from+h+1,options:f}}}let s=n.matchBefore(o4e);if(!s)return null;const a=s.text,r=Math.max(a.lastIndexOf('"'),a.lastIndexOf("'"));if(r===-1)return null;const o=a.slice(r+1),i=o.match(i4e),l=i?i[1]:o,c=V9e.filter(u=>u.label.startsWith(l));return{from:s.to-l.length,options:c}}const c4e=/chord\(\s*$/,u4e=/chord\(\s*['"][^'"]*$/,h4e=/(?:[\s[{(<])([\w#b+^:-]*)$/;function d4e(n){let e=n.matchBefore(c4e);if(e)return{from:e.to,options:[]};let t=n.matchBefore(u4e);if(!t)return null;const s=t.text,a=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(a===-1)return null;const r=s.slice(a+1),o=r.match(h4e),i=o?o[1]:r;let l=null,c=i;for(const u of wv)if(i.toLowerCase().startsWith(u.toLowerCase())){l=u,c=i.slice(u.length);break}if(l){const u=Z9e.filter(h=>h.label.toLowerCase().startsWith(c.toLowerCase()));return{from:t.to-c.length,options:u}}else{const u=wv.filter(h=>h.toLowerCase().startsWith(i.toLowerCase())).map(h=>({label:h,type:"pitch"}));return{from:t.to-i.length,options:u}}}const m4e=/\w*/;function p4e(n){const e=n.matchBefore(m4e);return e&&e.from===e.to&&!n.explicit?null:e?{from:e.from,options:z9e}:null}const f4e=[e4e,s4e,d4e,H9e,l4e,p4e],g4e=n=>{for(const e of f4e){const t=e(n);if(t)return t}return null},b4e=n=>n?[OAe({override:[g4e],closeOnBlur:!1})]:[],y4e=n=>n.name||n.longname;let pC=!1;typeof window<"u"&&(window.addEventListener("keyup",function(n){n.key=="Control"&&(pC=!1)},!0),window.addEventListener("keydown",function(n){n.key=="Control"&&(pC=!0)},!0));const v4e=tU((n,e,t)=>{if(!pC)return null;let{from:s,to:a,text:r}=n.state.doc.lineAt(e),o=e,i=e;for(;o>s&&/\w/.test(r[o-s-1]);)o--;for(;i<a&&/\w/.test(r[i-s]);)i++;if(o==e&&t<0||i==e&&t>0)return null;let l=r.slice(o-s,i-s),c=iC.docs.filter(u=>y4e(u)===l)[0];if(!c){const u=iC.docs.filter(h=>h.synonyms&&h.synonyms.includes(l))[0];if(!u)return null;c=aK(u,l)}return{pos:o,end:i,above:!1,arrow:!0,create(u){let h=document.createElement("div");h.className="strudel-tooltip";const m=nK(c);return h.appendChild(m),{dom:h}}}},{hoverTime:10}),w4e=n=>n?v4e:[],Ov=hn.define(),rK=Js.define({create(){return en.none},update(n,e){try{for(let t of e.effects)if(t.is(Ov))if(t.value&&e.newDoc.length>0){const s=en.mark({attributes:{style:"background-color: rgba(255,255,255, .4); filter: invert(10%)"}});n=en.set([s.range(0,e.newDoc.length)])}else n=en.set([]);return n}catch(t){return console.warn("flash error",t),n}},provide:n=>vt.decorations.from(n)}),oK=(n,e=200)=>{n.dispatch({effects:Ov.of(!0)}),setTimeout(()=>{n.dispatch({effects:Ov.of(!1)})},e)},iK=n=>n?rK:[],S5=hn.define(),C5=hn.define(),xv=(n,e)=>{n.dispatch({effects:S5.of(e)})},lK=(n,e,t)=>{n.dispatch({effects:C5.of({atTime:e,haps:t})})},fC=Js.define({create(){return en.none},update(n,e){e.docChanged&&(n=n.map(e.changes));for(let t of e.effects)if(t.is(S5)){const s=t.value.filter(([a])=>a<e.newDoc.length).map(([a,r])=>[a,Math.min(r,e.newDoc.length)]).map(a=>en.mark({id:a.join(":"),attributes:{style:"background-color: #00CA2880"}}).range(...a));n=en.set(s,!0)}return n}}),gC=Js.define({create(){return{atTime:0,haps:new Map}},update(n,e){var t;for(let s of e.effects)if(s.is(C5)){const a=new Map;for(let r of s.value.haps)if(!(!((t=r.context)!=null&&t.locations)||!r.whole))for(let{start:o,end:i}of r.context.locations){let l=`${o}:${i}`;(!a.has(l)||a.get(l).whole.begin.lt(r.whole.begin))&&a.set(l,r)}n={atTime:s.value.atTime,haps:a}}return n}}),O4e=vt.decorations.compute([fC,gC],n=>{var a,r;const e=n.field(fC).iter(),{haps:t}=n.field(gC),s=new Gl;for(;e.value;){const{from:o,to:i,value:{spec:{id:l}}}=e;if(t.has(l)){const c=t.get(l),u=((a=c.value)==null?void 0:a.color)??"var(--foreground)",h=((r=c.value)==null?void 0:r.markcss)||`outline: solid 2px ${u}`;s.add(o,i,en.mark({attributes:{style:h}}))}e.next()}return s.finish()}),cK=[fC,gC,O4e],uK=(n,e)=>(n&&e&&setTimeout(()=>{xv(e.editor,e.miniLocations)},100),n?yo.highest(cK):[]);function $s(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=t[s];typeof a=="string"?n.setAttribute(s,a):a!=null&&(n[s]=a)}e++}for(;e<arguments.length;e++)hK(n,arguments[e]);return n}function hK(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)hK(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}const $F=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Sg{constructor(e,t,s=0,a=e.length,r,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(s,a),this.bufferStart=s,this.normalize=r?i=>r($F(i)):$F,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ao(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=p3(e),s=this.bufferStart+this.bufferPos;this.bufferPos+=Al(e);let a=this.normalize(t);if(a.length)for(let r=0,o=s;;r++){let i=a.charCodeAt(r),l=this.match(i,o,this.bufferPos+this.bufferStart);if(r==a.length-1){if(l)return this.value=l,this;break}o==s&&r<t.length&&t.charCodeAt(r)==i&&o++}}}match(e,t,s){let a=null;for(let r=0;r<this.matches.length;r+=2){let o=this.matches[r],i=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?a={from:this.matches[r+1],to:s}:(this.matches[r]++,i=!0)),i||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?a={from:t,to:s}:this.matches.push(1,t)),a&&this.test&&!this.test(a.from,a.to,this.buffer,this.bufferStart)&&(a=null),a}}typeof Symbol<"u"&&(Sg.prototype[Symbol.iterator]=function(){return this});const dK={from:-1,to:-1,match:/.*/.exec("")},M5="gm"+(/x/.unicode==null?"":"u");class A5{constructor(e,t,s,a=0,r=e.length){if(this.text=e,this.to=r,this.curLine="",this.done=!1,this.value=dK,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new mK(e,t,s,a,r);this.re=new RegExp(t,M5+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.iter=e.iter();let o=e.lineAt(a);this.curLineStart=o.from,this.matchPos=kv(e,a),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let s=this.curLineStart+t.index,a=s+t[0].length;if(this.matchPos=kv(this.text,a+(s==a?1:0)),s==this.curLineStart+this.curLine.length&&this.nextLine(),(s<a||s>this.value.to)&&(!this.test||this.test(s,a,t)))return this.value={from:s,to:a,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Fk=new WeakMap;class Kd{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,s){let a=Fk.get(e);if(!a||a.from>=s||a.to<=t){let i=new Kd(t,e.sliceString(t,s));return Fk.set(e,i),i}if(a.from==t&&a.to==s)return a;let{text:r,from:o}=a;return o>t&&(r=e.sliceString(t,o)+r,o=t),a.to<s&&(r+=e.sliceString(a.to,s)),Fk.set(e,new Kd(o,r)),new Kd(t,r.slice(t-o,s-o))}}class mK{constructor(e,t,s,a,r){this.text=e,this.to=r,this.done=!1,this.value=dK,this.matchPos=kv(e,a),this.re=new RegExp(t,M5+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.flat=Kd.get(e,a,this.chunkEnd(a+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let s=this.flat.from+t.index,a=s+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(s,a,t)))return this.value={from:s,to:a,match:t},this.matchPos=kv(this.text,a+(s==a?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Kd.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(A5.prototype[Symbol.iterator]=mK.prototype[Symbol.iterator]=function(){return this});function x4e(n){try{return new RegExp(n,M5),!0}catch{return!1}}function kv(n,e){if(e>=n.length)return e;let t=n.lineAt(e),s;for(;e<t.to&&(s=t.text.charCodeAt(e-t.from))>=56320&&s<57344;)e++;return e}function bC(n){let e=String(n.state.doc.lineAt(n.state.selection.main.head).number),t=$s("input",{class:"cm-textfield",name:"line",value:e}),s=$s("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),n.dispatch({effects:Pv.of(!1)}),n.focus()):r.keyCode==13&&(r.preventDefault(),a())},onsubmit:r=>{r.preventDefault(),a()}},$s("label",n.state.phrase("Go to line"),": ",t)," ",$s("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function a(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!r)return;let{state:o}=n,i=o.doc.lineAt(o.selection.main.head),[,l,c,u,h]=r,m=u?+u.slice(1):0,f=c?+c:i.number;if(c&&h){let k=f/100;l&&(k=k*(l=="-"?-1:1)+i.number/o.doc.lines),f=Math.round(o.doc.lines*k)}else c&&l&&(f=f*(l=="-"?-1:1)+i.number);let v=o.doc.line(Math.max(1,Math.min(o.doc.lines,f))),O=Ze.cursor(v.from+Math.max(0,Math.min(m,v.length)));n.dispatch({effects:[Pv.of(!1),vt.scrollIntoView(O.from,{y:"center"})],selection:O}),n.focus()}return{dom:s}}const Pv=hn.define(),RF=Js.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(Pv)&&(n=t.value);return n},provide:n=>$u.from(n,e=>e?bC:null)}),k4e=n=>{let e=gg(n,bC);if(!e){let t=[Pv.of(!0)];n.state.field(RF,!1)==null&&t.push(hn.appendConfig.of([RF,P4e])),n.dispatch({effects:t}),e=gg(n,bC)}return e&&e.dom.querySelector("input").select(),!0},P4e=vt.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),S4e=({state:n,dispatch:e})=>{let{selection:t}=n,s=Ze.create(t.ranges.map(a=>n.wordAt(a.head)||Ze.cursor(a.head)),t.mainIndex);return s.eq(t)?!1:(e(n.update({selection:s})),!0)};function C4e(n,e){let{main:t,ranges:s}=n.selection,a=n.wordAt(t.head),r=a&&a.from==t.from&&a.to==t.to;for(let o=!1,i=new Sg(n.doc,e,s[s.length-1].to);;)if(i.next(),i.done){if(o)return null;i=new Sg(n.doc,e,0,Math.max(0,s[s.length-1].from-1)),o=!0}else{if(o&&s.some(l=>l.from==i.value.from))continue;if(r){let l=n.wordAt(i.value.from);if(!l||l.from!=i.value.from||l.to!=i.value.to)continue}return i.value}}const M4e=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(r=>r.from===r.to))return S4e({state:n,dispatch:e});let s=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(r=>n.sliceDoc(r.from,r.to)!=s))return!1;let a=C4e(n,s);return a?(e(n.update({selection:n.selection.addRange(Ze.range(a.from,a.to),!1),effects:vt.scrollIntoView(a.to)})),!0):!1},lp=Qt.define({combine(n){return Gc(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new R4e(e),scrollToMatch:e=>vt.scrollIntoView(e)})}});class E5{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||x4e(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,s)=>s=="n"?`
`:s=="r"?"\r":s=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new T4e(this):new E4e(this)}getCursor(e,t=0,s){let a=e.doc?e:as.create({doc:e});return s==null&&(s=a.doc.length),this.regexp?hd(this,a,t,s):ud(this,a,t,s)}}class pK{constructor(e){this.spec=e}}function ud(n,e,t,s){return new Sg(e.doc,n.unquoted,t,s,n.caseSensitive?void 0:a=>a.toLowerCase(),n.wholeWord?A4e(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function A4e(n,e){return(t,s,a,r)=>((r>t||r+a.length<s)&&(r=Math.max(0,t-2),a=n.sliceString(r,Math.min(n.length,s+2))),(e(Sv(a,t-r))!=wa.Word||e(Cv(a,t-r))!=wa.Word)&&(e(Cv(a,s-r))!=wa.Word||e(Sv(a,s-r))!=wa.Word))}class E4e extends pK{constructor(e){super(e)}nextMatch(e,t,s){let a=ud(this.spec,e,s,e.doc.length).nextOverlapping();if(a.done){let r=Math.min(e.doc.length,t+this.spec.unquoted.length);a=ud(this.spec,e,0,r).nextOverlapping()}return a.done||a.value.from==t&&a.value.to==s?null:a.value}prevMatchInRange(e,t,s){for(let a=s;;){let r=Math.max(t,a-1e4-this.spec.unquoted.length),o=ud(this.spec,e,r,a),i=null;for(;!o.nextOverlapping().done;)i=o.value;if(i)return i;if(r==t)return null;a-=1e4}}prevMatch(e,t,s){let a=this.prevMatchInRange(e,0,t);return a||(a=this.prevMatchInRange(e,Math.max(0,s-this.spec.unquoted.length),e.doc.length)),a&&(a.from!=t||a.to!=s)?a:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let s=ud(this.spec,e,0,e.doc.length),a=[];for(;!s.next().done;){if(a.length>=t)return null;a.push(s.value)}return a}highlight(e,t,s,a){let r=ud(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(s+this.spec.unquoted.length,e.doc.length));for(;!r.next().done;)a(r.value.from,r.value.to)}}function hd(n,e,t,s){return new A5(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?D4e(e.charCategorizer(e.selection.main.head)):void 0},t,s)}function Sv(n,e){return n.slice(Ya(n,e,!1),e)}function Cv(n,e){return n.slice(e,Ya(n,e))}function D4e(n){return(e,t,s)=>!s[0].length||(n(Sv(s.input,s.index))!=wa.Word||n(Cv(s.input,s.index))!=wa.Word)&&(n(Cv(s.input,s.index+s[0].length))!=wa.Word||n(Sv(s.input,s.index+s[0].length))!=wa.Word)}class T4e extends pK{nextMatch(e,t,s){let a=hd(this.spec,e,s,e.doc.length).next();return a.done&&(a=hd(this.spec,e,0,t).next()),a.done?null:a.value}prevMatchInRange(e,t,s){for(let a=1;;a++){let r=Math.max(t,s-a*1e4),o=hd(this.spec,e,r,s),i=null;for(;!o.next().done;)i=o.value;if(i&&(r==t||i.from>r+10))return i;if(r==t)return null}}prevMatch(e,t,s){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,s,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(t,s)=>s=="$"?"$":s=="&"?e.match[0]:s!="0"&&+s<e.match.length?e.match[s]:t)}matchAll(e,t){let s=hd(this.spec,e,0,e.doc.length),a=[];for(;!s.next().done;){if(a.length>=t)return null;a.push(s.value)}return a}highlight(e,t,s,a){let r=hd(this.spec,e,Math.max(0,t-250),Math.min(s+250,e.doc.length));for(;!r.next().done;)a(r.value.from,r.value.to)}}const Qu=hn.define(),D5=hn.define(),yu=Js.define({create(n){return new Nk(yC(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Qu)?n=new Nk(t.value.create(),n.panel):t.is(D5)&&(n=new Nk(n.query,t.value?T5:null));return n},provide:n=>$u.from(n,e=>e.panel)});class Nk{constructor(e,t){this.query=e,this.panel=t}}const F4e=en.mark({class:"cm-searchMatch"}),N4e=en.mark({class:"cm-searchMatch cm-searchMatch-selected"}),B4e=ra.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(yu))}update(n){let e=n.state.field(yu);(e!=n.startState.field(yu)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return en.none;let{view:t}=this,s=new Gl;for(let a=0,r=t.visibleRanges,o=r.length;a<o;a++){let{from:i,to:l}=r[a];for(;a<o-1&&l>r[a+1].from-500;)l=r[++a].to;n.highlight(t.state,i,l,(c,u)=>{let h=t.state.selection.ranges.some(m=>m.from==c&&m.to==u);s.add(c,u,h?N4e:F4e)})}return s.finish()}},{decorations:n=>n.decorations});function p0(n){return e=>{let t=e.state.field(yu,!1);return t&&t.query.spec.valid?n(e,t):vK(e)}}const _F=p0((n,{query:e})=>{let{to:t}=n.state.selection.main,s=e.nextMatch(n.state,t,t);if(!s)return!1;let a=Ze.single(s.from,s.to),r=n.state.facet(lp);return n.dispatch({selection:a,effects:[F5(n,s),r.scrollToMatch(a.main,n)],userEvent:"select.search"}),yK(n),!0}),LF=p0((n,{query:e})=>{let{state:t}=n,{from:s}=t.selection.main,a=e.prevMatch(t,s,s);if(!a)return!1;let r=Ze.single(a.from,a.to),o=n.state.facet(lp);return n.dispatch({selection:r,effects:[F5(n,a),o.scrollToMatch(r.main,n)],userEvent:"select.search"}),yK(n),!0}),fK=p0((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:Ze.create(t.map(s=>Ze.range(s.from,s.to))),userEvent:"select.search.matches"}),!0)}),$4e=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:s,to:a}=t.main,r=[],o=0;for(let i=new Sg(n.doc,n.sliceDoc(s,a));!i.next().done;){if(r.length>1e3)return!1;i.value.from==s&&(o=r.length),r.push(Ze.range(i.value.from,i.value.to))}return e(n.update({selection:Ze.create(r,o),userEvent:"select.search.matches"})),!0},IF=p0((n,{query:e})=>{let{state:t}=n,{from:s,to:a}=t.selection.main;if(t.readOnly)return!1;let r=e.nextMatch(t,s,s);if(!r)return!1;let o=r,i=[],l,c,u=[];if(o.from==s&&o.to==a&&(c=t.toText(e.getReplacement(o)),i.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(t,o.from,o.to),u.push(vt.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(s).number)+"."))),o){let h=i.length==0||i[0].from>=r.to?0:r.to-r.from-c.length;l=Ze.single(o.from-h,o.to-h),u.push(F5(n,o)),u.push(t.facet(lp).scrollToMatch(l.main,n))}return n.dispatch({changes:i,selection:l,effects:u,userEvent:"input.replace"}),!0}),gK=p0((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(a=>{let{from:r,to:o}=a;return{from:r,to:o,insert:e.getReplacement(a)}});if(!t.length)return!1;let s=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:vt.announce.of(s),userEvent:"input.replace.all"}),!0});function T5(n){return n.state.facet(lp).createPanel(n)}function yC(n,e){var t,s,a,r,o;let i=n.selection.main,l=i.empty||i.to>i.from+100?"":n.sliceDoc(i.from,i.to);if(e&&!l)return e;let c=n.facet(lp);return new E5({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(s=e==null?void 0:e.caseSensitive)!==null&&s!==void 0?s:c.caseSensitive,literal:(a=e==null?void 0:e.literal)!==null&&a!==void 0?a:c.literal,regexp:(r=e==null?void 0:e.regexp)!==null&&r!==void 0?r:c.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function bK(n){let e=gg(n,T5);return e&&e.dom.querySelector("[main-field]")}function yK(n){let e=bK(n);e&&e==n.root.activeElement&&e.select()}const vK=n=>{let e=n.state.field(yu,!1);if(e&&e.panel){let t=bK(n);if(t&&t!=n.root.activeElement){let s=yC(n.state,e.query.spec);s.valid&&n.dispatch({effects:Qu.of(s)}),t.focus(),t.select()}}else n.dispatch({effects:[D5.of(!0),e?Qu.of(yC(n.state,e.query.spec)):hn.appendConfig.of(L4e)]});return!0},wK=n=>{let e=n.state.field(yu,!1);if(!e||!e.panel)return!1;let t=gg(n,T5);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:D5.of(!1)}),!0};class R4e{constructor(e){this.view=e;let t=this.query=e.state.field(yu).query.spec;this.commit=this.commit.bind(this),this.searchField=$s("input",{value:t.search,placeholder:Ao(e,"Find"),"aria-label":Ao(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=$s("input",{value:t.replace,placeholder:Ao(e,"Replace"),"aria-label":Ao(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=$s("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=$s("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=$s("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function s(a,r,o){return $s("button",{class:"cm-button",name:a,onclick:r,type:"button"},o)}this.dom=$s("div",{onkeydown:a=>this.keydown(a),class:"cm-search"},[this.searchField,s("next",()=>_F(e),[Ao(e,"next")]),s("prev",()=>LF(e),[Ao(e,"previous")]),s("select",()=>fK(e),[Ao(e,"all")]),$s("label",null,[this.caseField,Ao(e,"match case")]),$s("label",null,[this.reField,Ao(e,"regexp")]),$s("label",null,[this.wordField,Ao(e,"by word")]),...e.state.readOnly?[]:[$s("br"),this.replaceField,s("replace",()=>IF(e),[Ao(e,"replace")]),s("replaceAll",()=>gK(e),[Ao(e,"replace all")])],$s("button",{name:"close",onclick:()=>wK(e),"aria-label":Ao(e,"close"),type:"button"},["×"])])}commit(){let e=new E5({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Qu.of(e)}))}keydown(e){rh(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?LF:_F)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),IF(this.view))}update(e){for(let t of e.transactions)for(let s of t.effects)s.is(Qu)&&!s.value.eq(this.query)&&this.setQuery(s.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(lp).top}}function Ao(n,e){return n.state.phrase(e)}const gb=30,bb=/[\s\.,:;?!]/;function F5(n,{from:e,to:t}){let s=n.state.doc.lineAt(e),a=n.state.doc.lineAt(t).to,r=Math.max(s.from,e-gb),o=Math.min(a,t+gb),i=n.state.sliceDoc(r,o);if(r!=s.from){for(let l=0;l<gb;l++)if(!bb.test(i[l+1])&&bb.test(i[l])){i=i.slice(l);break}}if(o!=a){for(let l=i.length-1;l>i.length-gb;l--)if(!bb.test(i[l-1])&&bb.test(i[l])){i=i.slice(0,l);break}}return vt.announce.of(`${n.state.phrase("current match")}. ${i} ${n.state.phrase("on line")} ${s.number}.`)}const _4e=vt.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),L4e=[yu,yo.low(B4e),_4e];let vC=Hq,I4e=class{constructor(n,e,t,s,a,r,o,i,l,c){this.left=n,this.top=e,this.height=t,this.fontFamily=s,this.fontSize=a,this.fontWeight=r,this.color=o,this.className=i,this.letter=l,this.partial=c}draw(){let n=document.createElement("div");return n.className=this.className,this.adjust(n),n}adjust(n){n.style.left=this.left+"px",n.style.top=this.top+"px",n.style.height=this.height+"px",n.style.lineHeight=this.height+"px",n.style.fontFamily=this.fontFamily,n.style.fontSize=this.fontSize,n.style.fontWeight=this.fontWeight,n.style.color=this.partial?"transparent":this.color,n.className=this.className,n.textContent=this.letter}eq(n){return this.left==n.left&&this.top==n.top&&this.height==n.height&&this.fontFamily==n.fontFamily&&this.fontSize==n.fontSize&&this.fontWeight==n.fontWeight&&this.color==n.color&&this.className==n.className&&this.letter==n.letter}},Q4e=class{constructor(n,e){this.view=n,this.rangePieces=[],this.cursors=[],this.em=e,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=n.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),n.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let n=vC(this.view.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=n+"ms"}update(n){(n.selectionSet||n.geometryChanged||n.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),V4e(n)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:n}=this.view,e=[];for(let t of n.selection.ranges){let s=t==n.selection.main,a=G4e(this.em,this.view,t,s);a&&e.push(a)}return{cursors:e}}drawSel({cursors:n}){if(n.length!=this.cursors.length||n.some((e,t)=>!e.eq(this.cursors[t]))){let e=this.cursorLayer.children;if(e.length!==n.length){this.cursorLayer.textContent="";for(const t of n)this.cursorLayer.appendChild(t.draw())}else n.forEach((t,s)=>t.adjust(e[s]));this.cursors=n}}destroy(){this.cursorLayer.remove()}};function V4e(n){return vC(n.startState)!=vC(n.state)}const j4e={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}},Z4e=yo.highest(vt.theme(j4e));function z4e(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Ds.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function G4e(n,e,t,s){var a,r;let o=t.head,i=1;(n.$data.count||n.$data.keyChain)&&(i=.5);{let c=o<e.state.doc.length&&e.state.sliceDoc(o,o+1);c&&/[\uDC00-\uDFFF]/.test(c)&&o>1&&(o--,c=e.state.sliceDoc(o,o+1));let u=e.coordsAtPos(o,1);if(!u)return null;let h=z4e(e),m=e.domAtPos(o),f=m?m.node:e.contentDOM;for(;m&&m.node instanceof HTMLElement;)f=m.node,m={node:m.node.childNodes[m.offset],offset:0};if(!(f instanceof HTMLElement)){if(!f.parentNode)return null;f=f.parentNode}let v=getComputedStyle(f),O=u.left,k=(r=(a=e).coordsForChar)===null||r===void 0?void 0:r.call(a,o);if(k&&(O=k.left),!c||c==`
`||c=="\r")c=" ";else if(c=="	"){c=" ";var l=e.coordsAtPos(o+1,-1);l&&(O=l.left-(l.left-u.left)/parseInt(v.tabSize))}else/[\uD800-\uDBFF]/.test(c)&&o<e.state.doc.length-1&&(c+=e.state.sliceDoc(o+1,o+2));let M=u.bottom-u.top;return new I4e(O-h.left,u.top-h.top+M*(1-i),M*i,v.fontFamily,v.fontSize,v.fontWeight,v.color,s?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",c,i!=1)}}const X4e=vt.theme({".cm-emacsMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"5px 10px",backgroundColor:"#fffa8f",fontFamily:"monospace"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"#fffa8f"}}),W4e=ra.fromClass(class{constructor(n){this.status="",this.view=n,this.em=new wh(n),this.blockCursor=new Q4e(n,this.em),this.view.scrollDOM.classList.add("cm-emacsMode")}update(n){n.docChanged&&(this.em.$emacsMark=null,this.em.updateMarksOnChange(n.changes)),this.blockCursor.update(n)}destroy(){this.view.scrollDOM.classList.remove("cm-emacsMode"),this.blockCursor.destroy()}},{eventHandlers:{keydown:function(n,e){var t=this.em.handleKeyboard(n);return t&&this.blockCursor.scheduleRedraw(),!!t},mousedown:function(){this.em.$emacsMark=null}}}),q4e=hn.define(),U4e=Js.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(q4e)&&(n=t.value);return n},provide:n=>$u.from(n,e=>e?H4e:null)});function H4e(n){let e=document.createElement("div");return e.className="cm-vim-panel",{top:!1,dom:e}}function Y4e(n={}){return[X4e,W4e,Z4e,U4e]}var K4e={Return:"Return",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Return",Divide:"/",Slash:"/",Multiply:"*",Subtract:"-",Minus:"-",Equal:"="},J4e={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1};const Bk={};class wh{constructor(e){this.view=e,this.$data={count:0,keyChain:"",lastCommand:""},this.$emacsMarkRing=[],this.$emacsMark=null}static bindKey(e,t){e.split("|").forEach(function(s){let a="",r=s.split(/\s+/);r.forEach(function(o,i){let l=o.split(/-(?=.)/),c=l.pop();l.length&&(a+=l.sort().join("-")+"-"),a+=c,i===r.length-1?Bk[a]=t:(Bk[a]="null",a+=" ")})})}static getKey(e){var t=e.code,s=e.key;if(J4e[s])return["","",""];t.length>1&&(t[0]=="N"&&(t=t.replace(/^Numpad/,"")),t[0]=="K"&&(t=t.replace(/^Key/,""))),t=K4e[t]||t,t.length==1&&(t=t.toLowerCase());var a="";return e.ctrlKey&&(a+="C-"),e.metaKey&&(a+="CMD-"),e.altKey&&(a+="M-"),e.shiftKey&&(a+="S-"),[t,a,s]}static addCommands(e){Object.keys(e).forEach(function(t){var s=e[t];typeof s=="function"&&(s={exec:s}),wh.commands[t]=s})}static execCommand(e,t,s,a=1){var r=void 0;if(a<0&&(a=-a),typeof e=="function")for(var o=0;o<a;o++)e(t.view);else if(e!=="null")if(e.exec){a>1&&e.handlesCount&&(s||(s={}),typeof s=="object"&&(s.count=a),a=1);for(var o=0;o<a;o++)r=e.exec(t,s||{})}else throw new Error("missformed command");return r}handleKeyboard(e){var t=wh.getKey(e),s=this.findCommand(t);if(!(/Up|Down/.test(t==null?void 0:t[0])&&PAe(this.view.state))){if(s&&s.command){var a=wh.execCommand(s.command,this,s.args,s.count);if(a===!1)return}return s}}findCommand([e,t,s]){if(e){var a=this,r=this.$data;if(!t&&e.length==1&&(a.pushEmacsMark(),r.count)){var o=new Array(r.count+1).join(s);return r.count=null,{command:"insertstring",args:o}}if(t=="C-"||r.count){var i=parseInt(e[e.length-1]);if(typeof i=="number"&&!isNaN(i))return r.count=Math.max(r.count||0,0),r.count=10*r.count+i,{command:"null"}}t&&(e=t+e),r.keyChain&&(e=r.keyChain+=" "+e);var l=Bk[e];if(r.keyChain=l=="null"?e:"",!!l){if(l==="null")return{command:"null"};if(l==="universalArgument")return r.count=-4,{command:"null"};var c;if(typeof l!="string"&&(c=l.args,l.command&&(l=l.command)),(l==="insertstring"||l===U3||l===Rw)&&a.pushEmacsMark(),!(typeof l=="string"&&(l=wh.commands[l],!l))){!l.readOnly&&!l.keepLastCommand&&(r.lastCommand=null);var i=r.count||1;return r.count&&(r.count=0),{command:l,args:c,count:i}}}}}showCommandLine(e){console.error("TODO")}updateMarksOnChange(e){this.$emacsMark&&(this.$emacsMark=this.updateMark(this.$emacsMark,e)),this.$emacsMarkRing=this.$emacsMarkRing.map(t=>this.updateMark(t,e)).filter(Boolean)}updateMark(e,t){if(e){var s=e.map(function(a){return t.mapPos(a,1,ga.TrackDel)}).filter(a=>a!=null);return s.length==0?null:s}}emacsMark(){return this.$emacsMark}setEmacsMark(e){this.$emacsMark=e}pushEmacsMark(e,t){var s=this.$emacsMark;s&&QF(this.$emacsMarkRing,s),!e||t?this.setEmacsMark(e):QF(this.$emacsMarkRing,e)}popEmacsMark(){var e=this.emacsMark();return e?(this.setEmacsMark(null),e):this.$emacsMarkRing.pop()}getLastEmacsMark(){return this.$emacsMark||this.$emacsMarkRing.slice(-1)[0]}getCopyText(){var e=this.view.state;return e.selection.ranges.map(t=>e.sliceDoc(t.from,t.to)).join(`
`)}clearSelection(){var e=this.view,t=e.state.selection,s=!t.ranges.some(r=>r.from!=r.to);if(s)return!1;var a=t.ranges.map(r=>Ze.range(r.head,r.head));return e.dispatch({selection:Ze.create(a,t.mainIndex)}),!0}onPaste(e){var t=this.view,s=t.state.selection,a;if(s.ranges.length>1){var r=e.split(`
`);r.length==s.ranges.length&&(a=r)}var o=0,i=t.state.changeByRange(l=>{var c=a?a[o]:e;return o++,{changes:{from:l.from,to:l.to,insert:c},range:Ze.cursor(l.from+c.length)}});t.dispatch(i)}selectionToEmacsMark(){var e=this.view.state.selection;return e.ranges.map(t=>t.head)}}wh.commands={};function QF(n,e){n.length&&n[n.length-1]+""==e+""||n.push(e)}function eTe(n){var e=n.Pos;function t(d,p,g){if(p.line===g.line&&p.ch>=g.ch-1){var b=d.getLine(p.line),S=b.charCodeAt(p.ch);55296<=S&&S<=55551&&(g.ch+=1)}return{start:p,end:g}}var s=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"g<Up>",type:"keyToKey",toKeys:"gk"},{keys:"g<Down>",type:"keyToKey",toKeys:"gj"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h"},{keys:"<Del>",type:"keyToKey",toKeys:"x"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"keyToKey",toKeys:"i",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"g$",type:"motion",motion:"moveToEndOfDisplayLine"},{keys:"g^",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"g0",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"gn",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!0}},{keys:"gN",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!1}},{keys:"gq",type:"operator",operator:"hardWrap"},{keys:"gw",type:"operator",operator:"hardWrap",operatorArgs:{keepCursor:!0}},{keys:"g?",type:"operator",operator:"rot13"},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-u>",type:"operatorMotion",operator:"delete",motion:"moveToStartOfLine",context:"insert"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"gi",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"lastEdit"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"gI",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"bol"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"gJ",type:"action",action:"joinLines",actionArgs:{keepSpaces:!0},isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<register>",type:"action",action:"replayMacro"},{keys:"q<register>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0},context:"normal"},{keys:"R",type:"operator",operator:"change",operatorArgs:{linewise:!0,fullLine:!0},context:"visual",exitVisualBlock:!0},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<register>",type:"action",action:"setMark"},{keys:'"<register>',type:"action",action:"setRegister"},{keys:"<C-r><register>",type:"action",action:"insertRegister",context:"insert",isEdit:!0},{keys:"<C-o>",type:"action",action:"oneNormalCommand",context:"insert"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<register>",type:"motion",motion:"textObjectManipulation"},{keys:"i<register>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],a=Object.create(null),r=s.length,o=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"omap",shortName:"om"},{name:"noremap",shortName:"no"},{name:"nnoremap",shortName:"nn"},{name:"vnoremap",shortName:"vn"},{name:"inoremap",shortName:"ino"},{name:"onoremap",shortName:"ono"},{name:"unmap"},{name:"mapclear",shortName:"mapc"},{name:"nmapclear",shortName:"nmapc"},{name:"vmapclear",shortName:"vmapc"},{name:"imapclear",shortName:"imapc"},{name:"omapclear",shortName:"omapc"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"startinsert",shortName:"start"},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"marks",excludeFromCommandHistory:!0},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"vglobal",shortName:"v"},{name:"delete",shortName:"d"},{name:"join",shortName:"j"},{name:"normal",shortName:"norm"},{name:"global",shortName:"g"}],i=In("");function l(d){d.setOption("disableInput",!0),d.setOption("showCursorWhenSelecting",!1),n.signal(d,"vim-mode-change",{mode:"normal"}),d.on("cursorActivity",dn),Ae(d),n.on(d.getInputField(),"paste",u(d))}function c(d){d.setOption("disableInput",!1),d.off("cursorActivity",dn),n.off(d.getInputField(),"paste",u(d)),d.state.vim=null,Ra&&clearTimeout(Ra)}function u(d){var p=d.state.vim;return p.onPasteFn||(p.onPasteFn=function(){p.insertMode||(d.setCursor(mt(d.getCursor(),0,1)),Le.enterInsertMode(d,{},p))}),p.onPasteFn}var h=/[\d]/,m=[n.isWordChar,function(d){return d&&!n.isWordChar(d)&&!/\s/.test(d)}],f=[function(d){return/\S/.test(d)}],v=["<",">"],O=["-",'"',".",":","_","/","+"],k=/^\w$/,M=/^[A-Z]$/;try{M=new RegExp("^[\\p{Lu}]$","u")}catch{}function E(d,p){return p>=d.firstLine()&&p<=d.lastLine()}function I(d){return/^[a-z]$/.test(d)}function D(d){return"()[]{}".indexOf(d)!=-1}function F(d){return h.test(d)}function _(d){return M.test(d)}function $(d){return/^\s*$/.test(d)}function Z(d){return".?!".indexOf(d)!=-1}function ce(d,p){for(var g=0;g<p.length;g++)if(p[g]==d)return!0;return!1}var U={};function ue(d,p,g,b,S){if(p===void 0&&!S)throw Error("defaultValue is required unless callback is provided");if(g||(g="string"),U[d]={type:g,defaultValue:p,callback:S},b)for(var C=0;C<b.length;C++)U[b[C]]=U[d];p&&W(d,p)}function W(d,p,g,b){var S=U[d];b=b||{};var C=b.scope;if(!S)return new Error("Unknown option: "+d);if(S.type=="boolean"){if(p&&p!==!0)return new Error("Invalid argument: "+d+"="+p);p!==!1&&(p=!0)}S.callback?(C!=="local"&&S.callback(p,void 0),C!=="global"&&g&&S.callback(p,g)):(C!=="local"&&(S.value=S.type=="boolean"?!!p:p),C!=="global"&&g&&(g.state.vim.options[d]={value:p}))}function de(d,p,g){var b=U[d];g=g||{};var S=g.scope;if(!b)return new Error("Unknown option: "+d);if(b.callback){let C=p&&b.callback(void 0,p);return S!=="global"&&C!==void 0?C:S!=="local"?b.callback():void 0}else return(S!=="global"&&p&&p.state.vim.options[d]||S!=="local"&&b||{}).value}ue("filetype",void 0,"string",["ft"],function(d,p){if(p!==void 0)if(d===void 0){let g=p.getOption("mode");return g=="null"?"":g}else{let g=d==""?"null":d;p.setOption("mode",g)}}),ue("textwidth",80,"number",["tw"],function(d,p){if(p!==void 0)if(d===void 0){var g=p.getOption("textwidth");return g}else{var b=Math.round(d);b>1&&p.setOption("textwidth",b)}});var be=function(){var d=100,p=-1,g=0,b=0,S=new Array(d);function C(V,z,G){var ie=p%d,le=S[ie];function se(ve){var xe=++p%d,$e=S[xe];$e&&$e.clear(),S[xe]=V.setBookmark(ve)}if(le){var K=le.find();K&&!Sn(K,z)&&se(z)}else se(z);se(G),g=p,b=p-d+1,b<0&&(b=0)}function N(V,z){p+=z,p>g?p=g:p<b&&(p=b);var G=S[(d+p)%d];if(G&&!G.find()){var ie=z>0?1:-1,le,se=V.getCursor();do if(p+=ie,G=S[(d+p)%d],G&&(le=G.find())&&!Sn(se,le))break;while(p<g&&p>b)}return G}function L(V,z){var G=p,ie=N(V,z);return p=G,ie&&ie.find()}return{cachedCursor:void 0,add:C,find:L,move:N}},ke=function(d){return d?{changes:d.changes,expectCursorActivityForChange:d.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};class Ce{constructor(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=ke()}exitMacroRecordMode(){var p=q.macroModeState;p.onRecordingDone&&p.onRecordingDone(),p.onRecordingDone=void 0,p.isRecording=!1}enterMacroRecordMode(p,g){var b=q.registerController.getRegister(g);if(b){if(b.clear(),this.latestRegister=g,p.openDialog){var S=ys("span",{class:"cm-vim-message"},"recording @"+g);this.onRecordingDone=p.openDialog(S,function(){},{bottom:!0})}this.isRecording=!0}}}function Ae(d){return d.state.vim||(d.state.vim={inputState:new Ft,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeReturn:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:void 0,sel:{anchor:new e(0,0),head:new e(0,0)},options:{},expectLiteralNext:!1,status:""}),d.state.vim}var q;function Ne(){q={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:be(),macroModeState:new Ce,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new at({}),searchHistoryController:new Un,exCommandHistoryController:new Un};for(var d in U){var p=U[d];p.value=p.defaultValue}}class Re{constructor(p,g){this.keyName=p,this.key=g.key,this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.metaKey=g.metaKey,this.shiftKey=g.shiftKey}}var je,me={enterVimMode:l,leaveVimMode:c,buildKeyMap:function(){},getRegisterController:function(){return q.registerController},resetVimGlobalState_:Ne,getVimGlobalState_:function(){return q},maybeInitVimState_:Ae,suppressErrorLogging:!1,InsertModeKey:Re,map:function(d,p,g){Qe.map(d,p,g)},unmap:function(d,p){return Qe.unmap(d,p)},noremap:function(d,p,g){Qe.map(d,p,g,!0)},mapclear:function(d){var p=s.length,g=r,b=s.slice(0,p-g);if(s=s.slice(p-g),d)for(var S=b.length-1;S>=0;S--){var C=b[S];if(d!==C.context)if(C.context)this._mapCommand(C);else{var N=["normal","insert","visual"];for(var L in N)if(N[L]!==d){var V=Object.assign({},C);V.context=N[L],this._mapCommand(V)}}}},langmap:Gt,vimKeyFromEvent:xn,setOption:W,getOption:de,defineOption:ue,defineEx:function(d,p,g){if(!p)p=d;else if(d.indexOf(p)!==0)throw new Error('(Vim.defineEx) "'+p+'" is not a prefix of "'+d+'", command not registered');Te[d]=g,Qe.commandMap_[p]={name:d,shortName:p,type:"api"}},handleKey:function(d,p,g){var b=this.findKey(d,p,g);if(typeof b=="function")return b()},multiSelectHandleKey:zt,findKey:function(d,p,g){var b=Ae(d),S=d;function C(){var G=q.macroModeState;if(G.isRecording){if(p=="q")return G.exitMacroRecordMode(),jt(S),!0;g!="mapping"&&Me(G,p)}}function N(){if(p=="<Esc>"){if(b.visualMode)Be(S);else if(b.insertMode)De(S);else return;return jt(S),!0}}function L(){if(N())return!0;b.inputState.keyBuffer.push(p);var G=b.inputState.keyBuffer.join(""),ie=p.length==1,le=nt.matchCommand(G,s,b.inputState,"insert"),se=b.inputState.changeQueue;if(le.type=="none")return jt(S),!1;if(le.type=="partial"){if(le.expectLiteralNext&&(b.expectLiteralNext=!0),je&&window.clearTimeout(je),je=ie&&window.setTimeout(function(){b.insertMode&&b.inputState.keyBuffer.length&&jt(S)},de("insertModeEscKeysTimeout")),ie){var K=S.listSelections();(!se||se.removed.length!=K.length)&&(se=b.inputState.changeQueue=new Gn),se.inserted+=p;for(var ve=0;ve<K.length;ve++){var xe=Tt(K[ve].anchor,K[ve].head),$e=kn(K[ve].anchor,K[ve].head),Pe=S.getRange(xe,S.state.overwrite?mt($e,0,1):$e);se.removed[ve]=(se.removed[ve]||"")+Pe}}return!ie}else le.type=="full"&&(b.inputState.keyBuffer.length=0);if(b.expectLiteralNext=!1,je&&window.clearTimeout(je),le.command&&se){for(var K=S.listSelections(),ve=0;ve<K.length;ve++){var ze=K[ve].head;S.replaceRange(se.removed[ve]||"",mt(ze,0,-se.inserted.length),ze,"+input")}q.macroModeState.lastInsertModeChanges.changes.pop()}return le.command||jt(S),le.command}function V(){if(C()||N())return!0;b.inputState.keyBuffer.push(p);var G=b.inputState.keyBuffer.join("");if(/^[1-9]\d*$/.test(G))return!0;var ie=/^(\d*)(.*)$/.exec(G);if(!ie)return jt(S),!1;var le=b.visualMode?"visual":"normal",se=ie[2]||ie[1];b.inputState.operatorShortcut&&b.inputState.operatorShortcut.slice(-1)==se&&(se=b.inputState.operatorShortcut);var K=nt.matchCommand(se,s,b.inputState,le);return K.type=="none"?(jt(S),!1):K.type=="partial"?(K.expectLiteralNext&&(b.expectLiteralNext=!0),!0):K.type=="clear"?(jt(S),!0):(b.expectLiteralNext=!1,b.inputState.keyBuffer.length=0,ie=/^(\d*)(.*)$/.exec(G),ie&&ie[1]&&ie[1]!="0"&&b.inputState.pushRepeatDigit(ie[1]),K.command)}var z=b.insertMode?L():V();if(z===!1)return!b.insertMode&&(p.length===1||n.isMac&&/<A-.>/.test(p))?function(){return!0}:void 0;if(z===!0)return function(){return!0};if(z)return function(){return S.operation(function(){S.curOp.isVimOp=!0;try{if(typeof z!="object")return;z.type=="keyToKey"?pt(S,z.toKeys,z):nt.processCommand(S,b,z)}catch(G){throw S.state.vim=void 0,Ae(S),me.suppressErrorLogging||console.log(G),G}return!0})}},handleEx:function(d,p){Qe.processCommand(d,p)},defineMotion:Vt,defineAction:qt,defineOperator:It,mapCommand:We,_mapCommand:ot,defineRegister:fn,exitVisualMode:Be,exitInsertMode:De},Ye=[],ft=!1,_e;function Ge(d){if(!_e)throw new Error("No prompt to send key to");if(d[0]=="<"){var p=d.toLowerCase().slice(1,-1),g=p.split("-");if(p=g.pop()||"",p=="lt")d="<";else if(p=="space")d=" ";else if(p=="cr")d=`
`;else if(on[p]){var b=_e.value||"",S={key:on[p],target:{value:b,selectionEnd:b.length,selectionStart:b.length}};_e.onKeyDown&&_e.onKeyDown(S,_e.value,N),_e&&_e.onKeyUp&&_e.onKeyUp(S,_e.value,N);return}}if(d==`
`){var C=_e;_e=null,C.onClose&&C.onClose(C.value)}else _e.value=(_e.value||"")+d;function N(L){_e&&(typeof L=="string"?_e.value=L:_e=null)}}function pt(d,p,g){var b=ft;if(g){if(Ye.indexOf(g)!=-1)return;Ye.push(g),ft=g.noremap!=!1}try{for(var S=Ae(d),C=/<(?:[CSMA]-)*\w+>|./gi,N;N=C.exec(p);){var L=N[0],V=S.insertMode;if(_e){Ge(L);continue}var z=me.handleKey(d,L,"mapping");if(!z&&V&&S.insertMode){if(L[0]=="<"){var G=L.toLowerCase().slice(1,-1),ie=G.split("-");if(G=ie.pop()||"",G=="lt")L="<";else if(G=="space")L=" ";else if(G=="cr")L=`
`;else if(on.hasOwnProperty(G)){L=on[G],Ps(d,L);continue}else L=L[0],C.lastIndex=N.index+1}d.replaceSelection(L)}}}finally{if(Ye.pop(),ft=Ye.length?b:!1,!Ye.length&&_e){var le=_e;_e=null,yr(d,le)}}}var rt={Return:"CR",Backspace:"BS",Delete:"Del",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"CR"," ":"Space"},tn={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1,AltGraph:1,Dead:1,Unidentified:1},on={};"Left|Right|Up|Down|End|Home".split("|").concat(Object.keys(rt)).forEach(function(d){on[(rt[d]||"").toLowerCase()]=on[d.toLowerCase()]=d});function xn(d,p){var C;var g=d.key;if(!tn[g]){g.length>1&&g[0]=="n"&&(g=g.replace("Numpad","")),g=rt[g]||g;var b="";if(d.ctrlKey&&(b+="C-"),d.altKey&&(b+="A-"),d.metaKey&&(b+="M-"),n.isMac&&b=="A-"&&g.length==1&&(b=b.slice(2)),(b||g.length>1)&&d.shiftKey&&(b+="S-"),p&&!p.expectLiteralNext&&g.length==1){if(i.keymap&&g in i.keymap)(i.remapCtrl!=!1||!b)&&(g=i.keymap[g]);else if(g.charCodeAt(0)>128&&!a[g]){var S=((C=d.code)==null?void 0:C.slice(-1))||"";d.shiftKey||(S=S.toLowerCase()),S&&(g=S,!b&&d.altKey&&(b="A-"))}}return b+=g,b.length>1&&(b="<"+b+">"),b}}function Gt(d,p){i.string!==d&&(i=In(d)),i.remapCtrl=p}function In(d){let p={};if(!d)return{keymap:p,string:""};function g(b){return b.split(/\\?(.)/).filter(Boolean)}return d.split(/((?:[^\\,]|\\.)+),/).map(b=>{if(!b)return;const S=b.split(/((?:[^\\;]|\\.)+);/);if(S.length==3){const C=g(S[1]),N=g(S[2]);if(C.length!==N.length)return;for(let L=0;L<C.length;++L)p[C[L]]=N[L]}else if(S.length==1){const C=g(b);if(C.length%2!==0)return;for(let N=0;N<C.length;N+=2)p[C[N]]=C[N+1]}}),{keymap:p,string:d}}ue("langmap",void 0,"string",["lmap"],function(d,p){if(d===void 0)return i.string;Gt(d)});class Ft{constructor(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=void 0,this.changeQueue=null}pushRepeatDigit(p){this.operator?this.motionRepeat=this.motionRepeat.concat(p):this.prefixRepeat=this.prefixRepeat.concat(p)}getRepeat(){var p=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(p=1,this.prefixRepeat.length>0&&(p*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(p*=parseInt(this.motionRepeat.join(""),10))),p}}function jt(d,p){d.state.vim.inputState=new Ft,d.state.vim.expectLiteralNext=!1,n.signal(d,"vim-command-done",p)}function Gn(){this.removed=[],this.inserted=""}class un{constructor(p,g,b){this.clear(),this.keyBuffer=[p||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!g,this.blockwise=!!b}setText(p,g,b){this.keyBuffer=[p||""],this.linewise=!!g,this.blockwise=!!b}pushText(p,g){g&&(this.linewise||this.keyBuffer.push(`
`),this.linewise=!0),this.keyBuffer.push(p)}pushInsertModeChanges(p){this.insertModeChanges.push(ke(p))}pushSearchQuery(p){this.searchQueries.push(p)}clear(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1}toString(){return this.keyBuffer.join("")}}function fn(d,p){var g=q.registerController.registers;if(!d||d.length!=1)throw Error("Register name must be 1 character");if(g[d])throw Error("Register already defined "+d);g[d]=p,O.push(d)}class at{constructor(p){this.registers=p,this.unnamedRegister=p['"']=new un,p["."]=new un,p[":"]=new un,p["/"]=new un,p["+"]=new un}pushText(p,g,b,S,C){if(p!=="_"){S&&b.charAt(b.length-1)!==`
`&&(b+=`
`);var N=this.isValidRegister(p)?this.getRegister(p):null;if(!N||!p){switch(g){case"yank":this.registers[0]=new un(b,S,C);break;case"delete":case"change":b.indexOf(`
`)==-1?this.registers["-"]=new un(b,S):(this.shiftNumericRegisters_(),this.registers[1]=new un(b,S));break}this.unnamedRegister.setText(b,S,C);return}var L=_(p);L?N.pushText(b,S):N.setText(b,S,C),p==="+"&&navigator.clipboard.writeText(b),this.unnamedRegister.setText(N.toString(),S)}}getRegister(p){return this.isValidRegister(p)?(p=p.toLowerCase(),this.registers[p]||(this.registers[p]=new un),this.registers[p]):this.unnamedRegister}isValidRegister(p){return p&&(ce(p,O)||k.test(p))}shiftNumericRegisters_(){for(var p=9;p>=2;p--)this.registers[p]=this.getRegister(""+(p-1))}}class Un{constructor(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}nextMatch(p,g){var b=this.historyBuffer,S=g?-1:1;this.initialPrefix===null&&(this.initialPrefix=p);for(var C=this.iterator+S;g?C>=0:C<b.length;C+=S)for(var N=b[C],L=0;L<=N.length;L++)if(this.initialPrefix==N.substring(0,L))return this.iterator=C,N;if(C>=b.length)return this.iterator=b.length,this.initialPrefix;if(C<0)return p}pushInput(p){var g=this.historyBuffer.indexOf(p);g>-1&&this.historyBuffer.splice(g,1),p.length&&this.historyBuffer.push(p)}reset(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}}var nt={matchCommand:function(d,p,g,b){var S=Fn(d,p,b,g),C=S.full[0];if(!C)return S.partial.length?{type:"partial",expectLiteralNext:S.partial.length==1&&S.partial[0].keys.slice(-11)=="<character>"}:{type:"none"};if(C.keys.slice(-11)=="<character>"||C.keys.slice(-10)=="<register>"){var N=Hn(d);if(!N||N.length>1)return{type:"clear"};g.selectedCharacter=N}return{type:"full",command:C}},processCommand:function(d,p,g){switch(p.inputState.repeatOverride=g.repeatOverride,g.type){case"motion":this.processMotion(d,p,g);break;case"operator":this.processOperator(d,p,g);break;case"operatorMotion":this.processOperatorMotion(d,p,g);break;case"action":this.processAction(d,p,g);break;case"search":this.processSearch(d,p,g);break;case"ex":case"keyToEx":this.processEx(d,p,g);break}},processMotion:function(d,p,g){p.inputState.motion=g.motion,p.inputState.motionArgs=zn(g.motionArgs),this.evalInput(d,p)},processOperator:function(d,p,g){var b=p.inputState;if(b.operator)if(b.operator==g.operator){b.motion="expandToLine",b.motionArgs={linewise:!0,repeat:1},this.evalInput(d,p);return}else jt(d);b.operator=g.operator,b.operatorArgs=zn(g.operatorArgs),g.keys.length>1&&(b.operatorShortcut=g.keys),g.exitVisualBlock&&(p.visualBlock=!1,ne(d)),p.visualMode&&this.evalInput(d,p)},processOperatorMotion:function(d,p,g){var b=p.visualMode,S=zn(g.operatorMotionArgs);S&&b&&S.visualLine&&(p.visualLine=!0),this.processOperator(d,p,g),b||this.processMotion(d,p,g)},processAction:function(d,p,g){var b=p.inputState,S=b.getRepeat(),C=!!S,N=zn(g.actionArgs)||{repeat:1};b.selectedCharacter&&(N.selectedCharacter=b.selectedCharacter),g.operator&&this.processOperator(d,p,g),g.motion&&this.processMotion(d,p,g),(g.motion||g.operator)&&this.evalInput(d,p),N.repeat=S||1,N.repeatIsExplicit=C,N.registerName=b.registerName,jt(d),p.lastMotion=null,g.isEdit&&this.recordLastEdit(p,b,g),Le[g.action](d,N,p)},processSearch:function(d,p,g){if(!d.getSearchCursor)return;var b=g.searchArgs.forward,S=g.searchArgs.wholeWordOnly;Yn(d).setReversed(!b);var C=b?"/":"?",N=Yn(d).getQuery(),L=d.getScrollInfo(),V="";function z(Pe,ze,ct){q.searchHistoryController.pushInput(Pe),q.searchHistoryController.reset();try{$a(d,Pe,ze,ct)}catch{Ct(d,"Invalid regex: "+Pe),jt(d);return}nt.processMotion(d,p,{keys:"",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:g.searchArgs.toJumplist}})}function G(Pe){d.scrollTo(L.left,L.top),z(Pe,!0,!0);var ze=q.macroModeState;ze.isRecording&&Yt(ze,Pe)}function ie(){return de("pcre")?"(JavaScript regexp: set pcre)":"(Vim regexp: set nopcre)"}function le(Pe,ze,ct){var it=xn(Pe),Rt,_t;it=="<Up>"||it=="<Down>"?(Rt=it=="<Up>",_t=Pe.target?Pe.target.selectionEnd:0,ze=q.searchHistoryController.nextMatch(ze,Rt)||"",ct(ze),_t&&Pe.target&&(Pe.target.selectionEnd=Pe.target.selectionStart=Math.min(_t,Pe.target.value.length))):it&&it!="<Left>"&&it!="<Right>"&&q.searchHistoryController.reset(),V=ze,se()}function se(){var Pe;try{Pe=$a(d,V,!0,!0)}catch{}Pe?d.scrollIntoView(J(d,!b,Pe),30):(A(d),d.scrollTo(L.left,L.top))}function K(Pe,ze,ct){var it=xn(Pe);it=="<Esc>"||it=="<C-c>"||it=="<C-[>"||it=="<BS>"&&ze==""?(q.searchHistoryController.pushInput(ze),q.searchHistoryController.reset(),$a(d,(N==null?void 0:N.source)||""),A(d),d.scrollTo(L.left,L.top),n.e_stop(Pe),jt(d),ct(),d.focus()):it=="<Up>"||it=="<Down>"?n.e_stop(Pe):it=="<C-u>"&&(n.e_stop(Pe),ct(""))}switch(g.searchArgs.querySrc){case"prompt":var ve=q.macroModeState;if(ve.isPlaying){let ze=ve.replaySearchQueries.shift();z(ze||"",!0,!1)}else yr(d,{onClose:G,prefix:C,desc:ys("span",{$cursor:"pointer",onmousedown:function(ze){ze.preventDefault(),W("pcre",!de("pcre")),this.textContent=ie(),se()}},ie()),onKeyUp:le,onKeyDown:K});break;case"wordUnderCursor":var xe=ws(d,{noSymbol:!0}),$e=!0;if(xe||(xe=ws(d,{noSymbol:!1}),$e=!1),!xe){Ct(d,"No word under cursor"),jt(d);return}let Pe=d.getLine(xe.start.line).substring(xe.start.ch,xe.end.ch);$e&&S?Pe="\\b"+Pe+"\\b":Pe=na(Pe),q.jumpList.cachedCursor=d.getCursor(),d.setCursor(xe.start),z(Pe,!0,!1);break}},processEx:function(d,p,g){function b(L){q.exCommandHistoryController.pushInput(L),q.exCommandHistoryController.reset(),Qe.processCommand(d,L),d.state.vim&&jt(d),A(d)}function S(L,V,z){var G=xn(L),ie,le;(G=="<Esc>"||G=="<C-c>"||G=="<C-[>"||G=="<BS>"&&V=="")&&(q.exCommandHistoryController.pushInput(V),q.exCommandHistoryController.reset(),n.e_stop(L),jt(d),A(d),z(),d.focus()),G=="<Up>"||G=="<Down>"?(n.e_stop(L),ie=G=="<Up>",le=L.target?L.target.selectionEnd:0,V=q.exCommandHistoryController.nextMatch(V,ie)||"",z(V),le&&L.target&&(L.target.selectionEnd=L.target.selectionStart=Math.min(le,L.target.value.length))):G=="<C-u>"?(n.e_stop(L),z("")):G&&G!="<Left>"&&G!="<Right>"&&q.exCommandHistoryController.reset()}function C(L,V){var z=new n.StringStream(V),G={};try{if(Qe.parseInput_(d,z,G),G.commandName!="s"){A(d);return}var ie=Qe.matchCommand_(G.commandName);if(!ie||(Qe.parseCommandArgs_(z,G,ie),!G.argString))return;var le=Oo(G.argString.slice(1),!0,!0);le&&Y(d,le)}catch{}}if(g.type=="keyToEx")Qe.processCommand(d,g.exArgs.input);else{var N={onClose:b,onKeyDown:S,onKeyUp:C,prefix:":"};p.visualMode&&(N.value="'<,'>",N.selectValueOnOpen=!1),yr(d,N)}},evalInput:function(d,p){var g=p.inputState,b=g.motion,S=g.motionArgs||{repeat:1},C=g.operator,N=g.operatorArgs||{},L=g.registerName,V=p.sel,z=Dt(p.visualMode?tt(d,V.head):d.getCursor("head")),G=Dt(p.visualMode?tt(d,V.anchor):d.getCursor("anchor")),ie=Dt(z),le=Dt(G),se,K,ve;if(C&&this.recordLastEdit(p,g),g.repeatOverride!==void 0?ve=g.repeatOverride:ve=g.getRepeat(),ve>0&&S.explicitRepeat?S.repeatIsExplicit=!0:(S.noRepeat||!S.explicitRepeat&&ve===0)&&(ve=1,S.repeatIsExplicit=!1),g.selectedCharacter&&(S.selectedCharacter=N.selectedCharacter=g.selectedCharacter),S.repeat=ve,jt(d),b){var xe=Mt[b](d,z,S,p,g);if(p.lastMotion=Mt[b],!xe)return;if(S.toJumplist){var $e=q.jumpList,Pe=$e.cachedCursor;Pe?(_s(d,Pe,xe),delete $e.cachedCursor):_s(d,z,xe)}xe instanceof Array?(K=xe[0],se=xe[1]):se=xe,se||(se=Dt(z)),p.visualMode?(p.visualBlock&&se.ch===1/0||(se=tt(d,se,ie)),K&&(K=tt(d,K)),K=K||le,V.anchor=K,V.head=se,ne(d),Ls(d,p,"<",He(K,se)?K:se),Ls(d,p,">",He(K,se)?se:K)):C||(se=tt(d,se,ie),d.setCursor(se.line,se.ch))}if(C){if(N.lastSel){K=le;var ze=N.lastSel,ct=Math.abs(ze.head.line-ze.anchor.line),it=Math.abs(ze.head.ch-ze.anchor.ch);ze.visualLine?se=new e(le.line+ct,le.ch):ze.visualBlock?se=new e(le.line+ct,le.ch+it):ze.head.line==ze.anchor.line?se=new e(le.line,le.ch+it):se=new e(le.line+ct,le.ch),p.visualMode=!0,p.visualLine=ze.visualLine,p.visualBlock=ze.visualBlock,V=p.sel={anchor:K,head:se},ne(d)}else p.visualMode&&(N.lastSel={anchor:Dt(V.anchor),head:Dt(V.head),visualBlock:p.visualBlock,visualLine:p.visualLine});var Rt,_t,Ot,qe,Ut;if(p.visualMode){Rt=Tt(V.head,V.anchor),_t=kn(V.head,V.anchor),Ot=p.visualLine||N.linewise,qe=p.visualBlock?"block":Ot?"line":"char";var Dn=t(d,Rt,_t);if(Ut=ge(d,{anchor:Dn.start,head:Dn.end},qe),Ot){var nn=Ut.ranges;if(qe=="block")for(var bn=0;bn<nn.length;bn++)nn[bn].head.ch=ln(d,nn[bn].head.line);else qe=="line"&&(nn[0].head=new e(nn[0].head.line+1,0))}}else{if(Rt=Dt(K||le),_t=Dt(se||ie),He(_t,Rt)){var ps=Rt;Rt=_t,_t=ps}Ot=S.linewise||N.linewise,Ot?Nt(d,Rt,_t):S.forward&&wt(d,Rt,_t),qe="char";var sa=!S.inclusive||Ot,Dn=t(d,Rt,_t);Ut=ge(d,{anchor:Dn.start,head:Dn.end},qe,sa)}d.setSelections(Ut.ranges,Ut.primary),p.lastMotion=null,N.repeat=ve,N.registerName=L,N.linewise=Ot;var Is=lt[C](d,N,Ut.ranges,le,se);p.visualMode&&Be(d,Is!=null),Is&&d.setCursor(Is)}},recordLastEdit:function(d,p,g){var b=q.macroModeState;b.isPlaying||(d.lastEditInputState=p,d.lastEditActionCommand=g,b.lastInsertModeChanges.changes=[],b.lastInsertModeChanges.expectCursorActivityForChange=!1,b.lastInsertModeChanges.visualBlock=d.visualBlock?d.sel.head.line-d.sel.anchor.line:0)}},Mt={moveToTopLine:function(d,p,g){var b=we(d).top+g.repeat-1;return new e(b,yn(d.getLine(b)))},moveToMiddleLine:function(d){var p=we(d),g=Math.floor((p.top+p.bottom)*.5);return new e(g,yn(d.getLine(g)))},moveToBottomLine:function(d,p,g){var b=we(d).bottom-g.repeat+1;return new e(b,yn(d.getLine(b)))},expandToLine:function(d,p,g){var b=p;return new e(b.line+g.repeat-1,1/0)},findNext:function(d,p,g){var b=Yn(d),S=b.getQuery();if(S){var C=!g.forward;C=b.isReversed()?!C:C,Y(d,S);var N=J(d,C,S,g.repeat);return N||Ct(d,"No match found "+S+(de("pcre")?" (set nopcre to use Vim regexps)":"")),N}},findAndSelectNextInclusive:function(d,p,g,b,S){var C=Yn(d),N=C.getQuery();if(N){var L=!g.forward;L=C.isReversed()?!L:L;var V=te(d,L,N,g.repeat,b);if(V){if(S.operator)return V;var z=V[0],G=new e(V[1].line,V[1].ch-1);if(b.visualMode){(b.visualLine||b.visualBlock)&&(b.visualLine=!1,b.visualBlock=!1,n.signal(d,"vim-mode-change",{mode:"visual",subMode:""}));var ie=b.sel.anchor;if(ie)return C.isReversed()?g.forward?[ie,z]:[ie,G]:g.forward?[ie,G]:[ie,z]}else b.visualMode=!0,b.visualLine=!1,b.visualBlock=!1,n.signal(d,"vim-mode-change",{mode:"visual",subMode:""});return L?[G,z]:[z,G]}}},goToMark:function(d,p,g,b){var S=Oe(d,b,g.selectedCharacter||"");return S?g.linewise?{line:S.line,ch:yn(d.getLine(S.line))}:S:null},moveToOtherHighlightedEnd:function(d,p,g,b){var S=b.sel;return b.visualBlock&&g.sameLine?[tt(d,new e(S.anchor.line,S.head.ch)),tt(d,new e(S.head.line,S.anchor.ch))]:[S.head,S.anchor]},jumpToMark:function(d,p,g,b){for(var S=p,C=0;C<g.repeat;C++){var N=S;for(var L in b.marks)if(I(L)){var V=b.marks[L].find(),z=g.forward?He(V,N):He(N,V);if(!z&&!(g.linewise&&V.line==N.line)){var G=Sn(N,S),ie=g.forward?vs(N,V,S):vs(S,V,N);(G||ie)&&(S=V)}}}return g.linewise&&(S=new e(S.line,yn(d.getLine(S.line)))),S},moveByCharacters:function(d,p,g){var b=p,S=g.repeat,C=g.forward?b.ch+S:b.ch-S;return new e(b.line,C)},moveByLines:function(d,p,g,b){var S=p,C=S.ch;switch(b.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:C=b.lastHPos;break;default:b.lastHPos=C}var N=g.repeat+(g.repeatOffset||0),L=g.forward?S.line+N:S.line-N,V=d.firstLine(),z=d.lastLine(),G=d.findPosV(S,g.forward?N:-N,"line",b.lastHSPos),ie=g.forward?G.line>L:G.line<L;return ie&&(L=G.line,C=G.ch),L<V&&S.line==V?this.moveToStartOfLine(d,p,g,b):L>z&&S.line==z?Rr(d,p,g,b,!0):(g.toFirstChar&&(C=yn(d.getLine(L)),b.lastHPos=C),b.lastHSPos=d.charCoords(new e(L,C),"div").left,new e(L,C))},moveByDisplayLines:function(d,p,g,b){var S=p;switch(b.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:b.lastHSPos=d.charCoords(S,"div").left}var C=g.repeat,N=d.findPosV(S,g.forward?C:-C,"line",b.lastHSPos);if(N.hitSide)if(g.forward){var L=d.charCoords(N,"div"),V={top:L.top+8,left:b.lastHSPos};N=d.coordsChar(V,"div")}else{var z=d.charCoords(new e(d.firstLine(),0),"div");z.left=b.lastHSPos,N=d.coordsChar(z,"div")}return b.lastHPos=N.ch,N},moveByPage:function(d,p,g){var b=p,S=g.repeat;return d.findPosV(b,g.forward?S:-S,"page")},moveByParagraph:function(d,p,g){var b=g.forward?1:-1;return vo(d,p,g.repeat,b).start},moveBySentence:function(d,p,g){var b=g.forward?1:-1;return ic(d,p,g.repeat,b)},moveByScroll:function(d,p,g,b){var S=d.getScrollInfo(),C=null,N=g.repeat;N||(N=S.clientHeight/(2*d.defaultTextHeight()));var L=d.charCoords(p,"local");if(g.repeat=N,C=Mt.moveByDisplayLines(d,p,g,b),!C)return null;var V=d.charCoords(C,"local");return d.scrollTo(null,S.top+V.top-L.top),C},moveByWords:function(d,p,g){return $r(d,p,g.repeat,!!g.forward,!!g.wordEnd,!!g.bigWord)},moveTillCharacter:function(d,p,g){var b=g.repeat,S=Na(d,b,g.forward,g.selectedCharacter,p),C=g.forward?-1:1;return Cn(C,g),S?(S.ch+=C,S):null},moveToCharacter:function(d,p,g){var b=g.repeat;return Cn(0,g),Na(d,b,g.forward,g.selectedCharacter,p)||p},moveToSymbol:function(d,p,g){var b=g.repeat;return g.selectedCharacter&&ls(d,b,g.forward,g.selectedCharacter)||p},moveToColumn:function(d,p,g,b){var S=g.repeat;return b.lastHPos=S-1,b.lastHSPos=d.charCoords(p,"div").left,rc(d,S)},moveToEol:function(d,p,g,b){return Rr(d,p,g,b,!1)},moveToFirstNonWhiteSpaceCharacter:function(d,p){var g=p;return new e(g.line,yn(d.getLine(g.line)))},moveToMatchedSymbol:function(d,p){for(var g=p,b=g.line,S=g.ch,C=d.getLine(b),N;S<C.length;S++)if(N=C.charAt(S),N&&D(N)){var L=d.getTokenTypeAt(new e(b,S+1));if(L!=="string"&&L!=="comment")break}if(S<C.length){var V=N==="<"||N===">"?/[(){}[\]<>]/:/[(){}[\]]/,z=d.findMatchingBracket(new e(b,S),{bracketRegex:V});return z.to}else return g},moveToStartOfLine:function(d,p){return new e(p.line,0)},moveToLineOrEdgeOfDocument:function(d,p,g){var b=g.forward?d.lastLine():d.firstLine();return g.repeatIsExplicit&&(b=g.repeat-d.getOption("firstLineNumber")),new e(b,yn(d.getLine(b)))},moveToStartOfDisplayLine:function(d){return d.execCommand("goLineLeft"),d.getCursor()},moveToEndOfDisplayLine:function(d){d.execCommand("goLineRight");var p=d.getCursor();return p.sticky=="before"&&p.ch--,p},textObjectManipulation:function(d,p,g,b){var S={"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"},C={"'":!0,'"':!0,"`":!0},N=g.selectedCharacter||"";N=="b"?N="(":N=="B"&&(N="{");var L=!g.textObjectInner,V,z;if(S[N]){if(z=!0,V=wo(d,p,N,L),!V){var G=d.getSearchCursor(new RegExp("\\"+N,"g"),p);G.find()&&(V=wo(d,G.from(),N,L))}}else if(C[N])z=!0,V=Zo(d,p,N,L);else if(N==="W"||N==="w")for(var ie=g.repeat||1;ie-- >0;){var le=ws(d,{inclusive:L,innerWord:!L,bigWord:N==="W",noSymbol:N==="W",multiline:!0},V&&V.end);le&&(V||(V=le),V.end=le.end)}else if(N==="p")if(V=vo(d,p,g.repeat,0,L),g.linewise=!0,b.visualMode)b.visualLine||(b.visualLine=!0);else{var se=b.inputState.operatorArgs;se&&(se.linewise=!0),V.end.line--}else if(N==="t")V=gn(d,p,L);else if(N==="s"){var K=d.getLine(p.line);p.ch>0&&Z(K[p.ch])&&(p.ch-=1);var ve=er(d,p,g.repeat,1,L),xe=er(d,p,g.repeat,-1,L);$(d.getLine(xe.line)[xe.ch])&&$(d.getLine(ve.line)[ve.ch-1])&&(xe={line:xe.line,ch:xe.ch+1}),V={start:xe,end:ve}}return V?d.state.vim.visualMode?ee(d,V.start,V.end,z):[V.start,V.end]:null},repeatLastCharacterSearch:function(d,p,g){var b=q.lastCharacterSearch,S=g.repeat,C=g.forward===b.forward,N=(b.increment?1:0)*(C?-1:1);d.moveH(-N,"char"),g.inclusive=!!C;var L=Na(d,S,C,b.selectedCharacter);return L?(L.ch+=N,L):(d.moveH(N,"char"),p)}};function Vt(d,p){Mt[d]=p}function En(d,p){for(var g=[],b=0;b<p;b++)g.push(d);return g}var lt={change:function(d,p,g){var b,S,C=d.state.vim,N=g[0].anchor,L=g[0].head;if(C.visualMode)if(p.fullLine)L.ch=Number.MAX_VALUE,L.line--,d.setSelection(N,L),S=d.getSelection(),d.replaceSelection(""),b=N;else{S=d.getSelection();var V=En("",g.length);d.replaceSelections(V),b=Tt(g[0].head,g[0].anchor)}else{S=d.getRange(N,L);var z=C.lastEditInputState;if((z==null?void 0:z.motion)=="moveByWords"&&!$(S)){var G=/\s+$/.exec(S);G&&z.motionArgs&&z.motionArgs.forward&&(L=mt(L,0,-G[0].length),S=S.slice(0,-G[0].length))}p.linewise&&(N=new e(N.line,yn(d.getLine(N.line))),L.line>N.line&&(L=new e(L.line-1,Number.MAX_VALUE))),d.replaceRange("",N,L),b=N}q.registerController.pushText(p.registerName,"change",S,p.linewise,g.length>1),Le.enterInsertMode(d,{head:b},d.state.vim)},delete:function(d,p,g){var b,S,C=d.state.vim;if(C.visualBlock){S=d.getSelection();var N=En("",g.length);d.replaceSelections(N),b=Tt(g[0].head,g[0].anchor)}else{var L=g[0].anchor,V=g[0].head;p.linewise&&V.line!=d.firstLine()&&L.line==d.lastLine()&&L.line==V.line-1&&(L.line==d.firstLine()?L.ch=0:L=new e(L.line-1,ln(d,L.line-1))),S=d.getRange(L,V),d.replaceRange("",L,V),b=L,p.linewise&&(b=Mt.moveToFirstNonWhiteSpaceCharacter(d,L))}return q.registerController.pushText(p.registerName,"delete",S,p.linewise,C.visualBlock),tt(d,b)},indent:function(d,p,g){var b=d.state.vim,S=b.visualMode&&p.repeat||1;if(b.visualBlock){for(var C=d.getOption("tabSize"),N=d.getOption("indentWithTabs")?"	":" ".repeat(C),L,V=g.length-1;V>=0;V--)if(L=Tt(g[V].anchor,g[V].head),p.indentRight)d.replaceRange(N.repeat(S),L,L);else{for(var z=d.getLine(L.line),G=0,ie=0;ie<S;ie++){var le=z[L.ch+G];if(le=="	")G++;else if(le==" "){G++;for(var se=1;se<N.length&&(le=z[L.ch+G],le===" ");se++)G++}else break}d.replaceRange("",L,mt(L,0,G))}return L}else if(d.indentMore)for(var ie=0;ie<S;ie++)p.indentRight?d.indentMore():d.indentLess();else{var K=g[0].anchor.line,ve=b.visualBlock?g[g.length-1].anchor.line:g[0].head.line;p.linewise&&ve--;for(var V=K;V<=ve;V++)for(var ie=0;ie<S;ie++)d.indentLine(V,p.indentRight)}return Mt.moveToFirstNonWhiteSpaceCharacter(d,g[0].anchor)},indentAuto:function(d,p,g){return d.execCommand("indentAuto"),Mt.moveToFirstNonWhiteSpaceCharacter(d,g[0].anchor)},hardWrap:function(d,p,g,b){if(d.hardWrap){var S=g[0].anchor.line,C=g[0].head.line;p.linewise&&C--;var N=d.hardWrap({from:S,to:C});return N>S&&p.linewise&&N--,p.keepCursor?b:new e(N,0)}},changeCase:function(d,p,g,b,S){for(var C=d.getSelections(),N=[],L=p.toLower,V=0;V<C.length;V++){var z=C[V],G="";if(L===!0)G=z.toLowerCase();else if(L===!1)G=z.toUpperCase();else for(var ie=0;ie<z.length;ie++){var le=z.charAt(ie);G+=_(le)?le.toLowerCase():le.toUpperCase()}N.push(G)}return d.replaceSelections(N),p.shouldMoveCursor?S:!d.state.vim.visualMode&&p.linewise&&g[0].anchor.line+1==g[0].head.line?Mt.moveToFirstNonWhiteSpaceCharacter(d,b):p.linewise?b:Tt(g[0].anchor,g[0].head)},yank:function(d,p,g,b){var S=d.state.vim,C=d.getSelection(),N=S.visualMode?Tt(S.sel.anchor,S.sel.head,g[0].head,g[0].anchor):b;return q.registerController.pushText(p.registerName,"yank",C,p.linewise,S.visualBlock),N},rot13:function(d,p,g,b,S){for(var C=d.getSelections(),N=[],L=0;L<C.length;L++){const V=C[L].split("").map(z=>{const G=z.charCodeAt(0);return G>=65&&G<=90?String.fromCharCode(65+(G-65+13)%26):G>=97&&G<=122?String.fromCharCode(97+(G-97+13)%26):z}).join("");N.push(V)}return d.replaceSelections(N),p.shouldMoveCursor?S:!d.state.vim.visualMode&&p.linewise&&g[0].anchor.line+1==g[0].head.line?Mt.moveToFirstNonWhiteSpaceCharacter(d,b):p.linewise?b:Tt(g[0].anchor,g[0].head)}};function It(d,p){lt[d]=p}var Le={jumpListWalk:function(d,p,g){if(!g.visualMode){var b=p.repeat||1,S=p.forward,C=q.jumpList,N=C.move(d,S?b:-b),L=N?N.find():void 0;L=L||d.getCursor(),d.setCursor(L)}},scroll:function(d,p,g){if(!g.visualMode){var b=p.repeat||1,S=d.defaultTextHeight(),C=d.getScrollInfo().top,N=S*b,L=p.forward?C+N:C-N,V=Dt(d.getCursor()),z=d.charCoords(V,"local");if(p.forward)L>z.top?(V.line+=(L-z.top)/S,V.line=Math.ceil(V.line),d.setCursor(V),z=d.charCoords(V,"local"),d.scrollTo(null,z.top)):d.scrollTo(null,L);else{var G=L+d.getScrollInfo().clientHeight;G<z.bottom?(V.line-=(z.bottom-G)/S,V.line=Math.floor(V.line),d.setCursor(V),z=d.charCoords(V,"local"),d.scrollTo(null,z.bottom-d.getScrollInfo().clientHeight)):d.scrollTo(null,L)}}},scrollToCursor:function(d,p){var g=d.getCursor().line,b=d.charCoords(new e(g,0),"local"),S=d.getScrollInfo().clientHeight,C=b.top;switch(p.position){case"center":C=b.bottom-S/2;break;case"bottom":var N=new e(g,d.getLine(g).length-1),L=d.charCoords(N,"local"),V=L.bottom-C;C=C-S+V;break}d.scrollTo(null,C)},replayMacro:function(d,p,g){var b=p.selectedCharacter||"",S=p.repeat||1,C=q.macroModeState;for(b=="@"?b=C.latestRegister||"":C.latestRegister=b;S--;)et(d,g,C,b)},enterMacroRecordMode:function(d,p){var g=q.macroModeState,b=p.selectedCharacter;q.registerController.isValidRegister(b)&&g.enterMacroRecordMode(d,b)},toggleOverwrite:function(d){d.state.overwrite?(d.toggleOverwrite(!1),d.setOption("keyMap","vim-insert"),n.signal(d,"vim-mode-change",{mode:"insert"})):(d.toggleOverwrite(!0),d.setOption("keyMap","vim-replace"),n.signal(d,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(d,p,g){if(!d.getOption("readOnly")){g.insertMode=!0,g.insertModeRepeat=p&&p.repeat||1;var b=p?p.insertAt:null,S=g.sel,C=p.head||d.getCursor("head"),N=d.listSelections().length;if(b=="eol")C=new e(C.line,ln(d,C.line));else if(b=="bol")C=new e(C.line,0);else if(b=="charAfter"){var L=t(d,C,mt(C,0,1));C=L.end}else if(b=="firstNonBlank"){var L=t(d,C,Mt.moveToFirstNonWhiteSpaceCharacter(d,C));C=L.end}else if(b=="startOfSelectedArea"){if(!g.visualMode)return;g.visualBlock?(C=new e(Math.min(S.head.line,S.anchor.line),Math.min(S.head.ch,S.anchor.ch)),N=Math.abs(S.head.line-S.anchor.line)+1):S.head.line<S.anchor.line?C=S.head:C=new e(S.anchor.line,0)}else if(b=="endOfSelectedArea"){if(!g.visualMode)return;g.visualBlock?(C=new e(Math.min(S.head.line,S.anchor.line),Math.max(S.head.ch,S.anchor.ch)+1),N=Math.abs(S.head.line-S.anchor.line)+1):S.head.line>=S.anchor.line?C=mt(S.head,0,1):C=new e(S.anchor.line,0)}else if(b=="inplace"){if(g.visualMode)return}else b=="lastEdit"&&(C=Se(d)||C);d.setOption("disableInput",!1),p&&p.replace?(d.toggleOverwrite(!0),d.setOption("keyMap","vim-replace"),n.signal(d,"vim-mode-change",{mode:"replace"})):(d.toggleOverwrite(!1),d.setOption("keyMap","vim-insert"),n.signal(d,"vim-mode-change",{mode:"insert"})),q.macroModeState.isPlaying||(d.on("change",$t),g.insertEnd&&g.insertEnd.clear(),g.insertEnd=d.setBookmark(C,{insertLeft:!0}),n.on(d.getInputField(),"keydown",On)),g.visualMode&&Be(d),T(d,C,N)}},toggleVisualMode:function(d,p,g){var b=p.repeat,S=d.getCursor(),C;if(g.visualMode)g.visualLine!=!!p.linewise||g.visualBlock!=!!p.blockwise?(g.visualLine=!!p.linewise,g.visualBlock=!!p.blockwise,n.signal(d,"vim-mode-change",{mode:"visual",subMode:g.visualLine?"linewise":g.visualBlock?"blockwise":""}),ne(d)):Be(d);else{g.visualMode=!0,g.visualLine=!!p.linewise,g.visualBlock=!!p.blockwise,C=tt(d,new e(S.line,S.ch+b-1));var N=t(d,S,C);g.sel={anchor:N.start,head:N.end},n.signal(d,"vim-mode-change",{mode:"visual",subMode:g.visualLine?"linewise":g.visualBlock?"blockwise":""}),ne(d),Ls(d,g,"<",Tt(S,C)),Ls(d,g,">",kn(S,C))}},reselectLastSelection:function(d,p,g){var b=g.lastSelection;if(g.visualMode&&H(d,g),b){var S=b.anchorMark.find(),C=b.headMark.find();if(!S||!C)return;g.sel={anchor:S,head:C},g.visualMode=!0,g.visualLine=b.visualLine,g.visualBlock=b.visualBlock,ne(d),Ls(d,g,"<",Tt(S,C)),Ls(d,g,">",kn(S,C)),n.signal(d,"vim-mode-change",{mode:"visual",subMode:g.visualLine?"linewise":g.visualBlock?"blockwise":""})}},joinLines:function(d,p,g){var b,S;if(g.visualMode){if(b=d.getCursor("anchor"),S=d.getCursor("head"),He(S,b)){var C=S;S=b,b=C}S.ch=ln(d,S.line)-1}else{var N=Math.max(p.repeat,2);b=d.getCursor(),S=tt(d,new e(b.line+N-1,1/0))}for(var L=0,V=b.line;V<S.line;V++){L=ln(d,b.line);var z="",G=0;if(!p.keepSpaces){var ie=d.getLine(b.line+1);G=ie.search(/\S/),G==-1?G=ie.length:z=" "}d.replaceRange(z,new e(b.line,L),new e(b.line+1,G))}var le=tt(d,new e(b.line,L));g.visualMode&&Be(d,!1),d.setCursor(le)},newLineAndEnterInsertMode:function(d,p,g){g.insertMode=!0;var b=Dt(d.getCursor());if(b.line===d.firstLine()&&!p.after)d.replaceRange(`
`,new e(d.firstLine(),0)),d.setCursor(d.firstLine(),0);else{b.line=p.after?b.line:b.line-1,b.ch=ln(d,b.line),d.setCursor(b);var S=n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent;S(d)}this.enterInsertMode(d,{repeat:p.repeat},g)},paste:function(d,p,g){var b=q.registerController.getRegister(p.registerName);if(p.registerName==="+")navigator.clipboard.readText().then(C=>{this.continuePaste(d,p,g,C,b)});else{var S=b.toString();this.continuePaste(d,p,g,S,b)}},continuePaste:function(d,p,g,b,S){var C=Dt(d.getCursor());if(b){if(p.matchIndent){var N=d.getOption("tabSize"),L=function(nn){var bn=nn.split("	").length-1,ps=nn.split(" ").length-1;return bn*N+ps*1},V=d.getLine(d.getCursor().line),z=L(V.match(/^\s*/)[0]),G=b.replace(/\n$/,""),ie=b!==G,le=L(b.match(/^\s*/)[0]),b=G.replace(/^\s*/gm,function(nn){var bn=z+(L(nn)-le);if(bn<0)return"";if(d.getOption("indentWithTabs")){var ps=Math.floor(bn/N);return Array(ps+1).join("	")}else return Array(bn+1).join(" ")});b+=ie?`
`:""}p.repeat>1&&(b=Array(p.repeat+1).join(b));var se=S.linewise,K=S.blockwise,ve=K?b.split(`
`):void 0;if(ve){se&&ve.pop();for(var xe=0;xe<ve.length;xe++)ve[xe]=ve[xe]==""?" ":ve[xe];C.ch+=p.after?1:0,C.ch=Math.min(ln(d,C.line),C.ch)}else se?g.visualMode?b=g.visualLine?b.slice(0,-1):`
`+b.slice(0,b.length-1)+`
`:p.after?(b=`
`+b.slice(0,b.length-1),C.ch=ln(d,C.line)):C.ch=0:C.ch+=p.after?1:0;var $e;if(g.visualMode){g.lastPastedText=b;var Pe,ze=j(d),ct=ze[0],it=ze[1],Rt=d.getSelection(),_t=d.listSelections(),Ot=new Array(_t.length).join("1").split("1");g.lastSelection&&(Pe=g.lastSelection.headMark.find()),q.registerController.unnamedRegister.setText(Rt),K?(d.replaceSelections(Ot),it=new e(ct.line+b.length-1,ct.ch),d.setCursor(ct),B(d,it),d.replaceSelections(b),$e=ct):g.visualBlock?(d.replaceSelections(Ot),d.setCursor(ct),d.replaceRange(b,ct,ct),$e=ct):(d.replaceRange(b,ct,it),$e=d.posFromIndex(d.indexFromPos(ct)+b.length-1)),Pe&&(g.lastSelection.headMark=d.setBookmark(Pe)),se&&($e.ch=0)}else if(K&&ve){d.setCursor(C);for(var xe=0;xe<ve.length;xe++){var qe=C.line+xe;qe>d.lastLine()&&d.replaceRange(`
`,new e(qe,0));var Ut=ln(d,qe);Ut<C.ch&&x(d,qe,C.ch)}d.setCursor(C),B(d,new e(C.line+ve.length-1,C.ch)),d.replaceSelections(ve),$e=C}else if(d.replaceRange(b,C),se){var qe=p.after?C.line+1:C.line;$e=new e(qe,yn(d.getLine(qe)))}else $e=Dt(C),/\n/.test(b)||($e.ch+=b.length-(p.after?1:0));g.visualMode&&Be(d,!1),d.setCursor($e)}},undo:function(d,p){d.operation(function(){Zt(d,n.commands.undo,p.repeat)(),d.setCursor(tt(d,d.getCursor("start")))})},redo:function(d,p){Zt(d,n.commands.redo,p.repeat)()},setRegister:function(d,p,g){g.inputState.registerName=p.selectedCharacter},insertRegister:function(d,p,g){var b=p.selectedCharacter,S=q.registerController.getRegister(b),C=S&&S.toString();C&&d.replaceSelection(C)},oneNormalCommand:function(d,p,g){De(d,!0),g.insertModeReturn=!0,n.on(d,"vim-command-done",function b(){g.visualMode||(g.insertModeReturn&&(g.insertModeReturn=!1,g.insertMode||Le.enterInsertMode(d,{},g)),n.off(d,"vim-command-done",b))})},setMark:function(d,p,g){var b=p.selectedCharacter;b&&Ls(d,g,b,d.getCursor())},replace:function(d,p,g){var b=p.selectedCharacter||"",S=d.getCursor(),C,N,L=d.listSelections();if(g.visualMode)S=d.getCursor("start"),N=d.getCursor("end");else{var V=d.getLine(S.line);C=S.ch+p.repeat,C>V.length&&(C=V.length),N=new e(S.line,C)}var z=t(d,S,N);if(S=z.start,N=z.end,b==`
`)g.visualMode||d.replaceRange("",S,N),(n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent)(d);else{var G=d.getRange(S,N);if(G=G.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b),G=G.replace(/[^\n]/g,b),g.visualBlock){var ie=new Array(d.getOption("tabSize")+1).join(" ");G=d.getSelection(),G=G.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,b);var le=G.replace(/\t/g,ie).replace(/[^\n]/g,b).split(`
`);d.replaceSelections(le)}else d.replaceRange(G,S,N);g.visualMode?(S=He(L[0].anchor,L[0].head)?L[0].anchor:L[0].head,d.setCursor(S),Be(d,!1)):d.setCursor(mt(N,0,-1))}},incrementNumberToken:function(d,p){for(var g=d.getCursor(),b=d.getLine(g.line),S=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi,C,N,L,V;(C=S.exec(b))!==null&&(N=C.index,L=N+C[0].length,!(g.ch<L)););if(!(!p.backtrack&&L<=g.ch)){if(C){var z=C[2]||C[4],G=C[3]||C[5],ie=p.increase?1:-1,le={"0b":2,0:8,"":10,"0x":16}[z.toLowerCase()],se=parseInt(C[1]+G,le)+ie*p.repeat;V=se.toString(le);var K=z?new Array(G.length-V.length+1+C[1].length).join("0"):"";V.charAt(0)==="-"?V="-"+z+K+V.substr(1):V=z+K+V;var ve=new e(g.line,N),xe=new e(g.line,L);d.replaceRange(V,ve,xe)}else return;d.setCursor(new e(g.line,N+V.length-1))}},repeatLastEdit:function(d,p,g){var b=g.lastEditInputState;if(b){var S=p.repeat;S&&p.repeatIsExplicit?b.repeatOverride=S:S=b.repeatOverride||S,ms(d,g,S,!1)}},indent:function(d,p){d.indentLine(d.getCursor().line,p.indentRight)},exitInsertMode:function(d,p){De(d)}};function qt(d,p){Le[d]=p}function tt(d,p,g){var b=d.state.vim,S=b.insertMode||b.visualMode,C=Math.min(Math.max(d.firstLine(),p.line),d.lastLine()),N=d.getLine(C),L=N.length-1+ +!!S,V=Math.min(Math.max(0,p.ch),L),z=N.charCodeAt(V);if(56320<=z&&z<=57343){var G=1;g&&g.line==C&&g.ch>V&&(G=-1),V+=G,V>L&&(V-=2)}return new e(C,V)}function zn(d){var p={};for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(p[g]=d[g]);return p}function mt(d,p,g){return typeof p=="object"&&(g=p.ch,p=p.line),new e(d.line+p,d.ch+g)}function Fn(d,p,g,b){b.operator&&(g="operatorPending");for(var S,C=[],N=[],L=ft?p.length-r:0,V=L;V<p.length;V++){var z=p[V];g=="insert"&&z.context!="insert"||z.context&&z.context!=g||b.operator&&z.type=="action"||!(S=ea(d,z.keys))||(S=="partial"&&C.push(z),S=="full"&&N.push(z))}return{partial:C,full:N}}function ea(d,p){const g=p.slice(-11)=="<character>",b=p.slice(-10)=="<register>";if(g||b){var S=p.length-(g?11:10),C=d.slice(0,S),N=p.slice(0,S);return C==N&&d.length>S?"full":N.indexOf(C)==0?"partial":!1}else return d==p?"full":p.indexOf(d)==0?"partial":!1}function Hn(d){var p=/^.*(<[^>]+>)$/.exec(d),g=p?p[1]:d.slice(-1);if(g.length>1)switch(g){case"<CR>":case"<S-CR>":g=`
`;break;case"<Space>":case"<S-Space>":g=" ";break;default:g="";break}return g}function Zt(d,p,g){return function(){for(var b=0;b<g;b++)p(d)}}function Dt(d){return new e(d.line,d.ch)}function Sn(d,p){return d.ch==p.ch&&d.line==p.line}function He(d,p){return d.line<p.line||d.line==p.line&&d.ch<p.ch}function Tt(d,p){return arguments.length>2&&(p=Tt.apply(void 0,Array.prototype.slice.call(arguments,1))),He(d,p)?d:p}function kn(d,p){return arguments.length>2&&(p=kn.apply(void 0,Array.prototype.slice.call(arguments,1))),He(d,p)?p:d}function vs(d,p,g){var b=He(d,p),S=He(p,g);return b&&S}function ln(d,p){return d.getLine(p).length}function Gs(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function na(d){return d.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function x(d,p,g){var b=ln(d,p),S=new Array(g-b+1).join(" ");d.setCursor(new e(p,b)),d.replaceRange(S,d.getCursor())}function B(d,p){var g=[],b=d.listSelections(),S=Dt(d.clipPos(p)),C=!Sn(p,S),N=d.getCursor("head"),L=R(b,N),V=Sn(b[L].head,b[L].anchor),z=b.length-1,G=z-L>L?z:0,ie=b[G].anchor,le=Math.min(ie.line,S.line),se=Math.max(ie.line,S.line),K=ie.ch,ve=S.ch,xe=b[G].head.ch-K,$e=ve-K;xe>0&&$e<=0?(K++,C||ve--):xe<0&&$e>=0?(K--,V||ve++):xe<0&&$e==-1&&(K--,ve++);for(var Pe=le;Pe<=se;Pe++){var ze={anchor:new e(Pe,K),head:new e(Pe,ve)};g.push(ze)}return d.setSelections(g),p.ch=ve,ie.ch=K,ie}function T(d,p,g){for(var b=[],S=0;S<g;S++){var C=mt(p,S,0);b.push({anchor:C,head:C})}d.setSelections(b,0)}function R(d,p,g){for(var b=0;b<d.length;b++){var S=Sn(d[b].anchor,p),C=Sn(d[b].head,p);if(S||C)return b}return-1}function j(d,p){var g=d.listSelections(),b=g[0],S=g[g.length-1],C=He(b.anchor,b.head)?b.anchor:b.head,N=He(S.anchor,S.head)?S.head:S.anchor;return[C,N]}function H(d,p){var g=p.sel.anchor,b=p.sel.head;p.lastPastedText&&(b=d.posFromIndex(d.indexFromPos(g)+p.lastPastedText.length),p.lastPastedText=void 0),p.lastSelection={anchorMark:d.setBookmark(g),headMark:d.setBookmark(b),anchor:Dt(g),head:Dt(b),visualMode:p.visualMode,visualLine:p.visualLine,visualBlock:p.visualBlock}}function ee(d,p,g,b){var S=d.state.vim.sel,C=b?p:S.head,N=b?p:S.anchor,L;return He(g,p)&&(L=g,g=p,p=L),He(C,N)?(C=Tt(p,C),N=kn(N,g)):(N=Tt(p,N),C=kn(C,g),C=mt(C,0,-1),C.ch==-1&&C.line!=d.firstLine()&&(C=new e(C.line-1,ln(d,C.line-1)))),[N,C]}function ne(d,p,g){var b=d.state.vim;p=p||b.sel,g||(g=b.visualLine?"line":b.visualBlock?"block":"char");var S=ge(d,p,g);d.setSelections(S.ranges,S.primary)}function ge(d,p,g,b){var S=Dt(p.head),C=Dt(p.anchor);if(g=="char"){var N=!b&&!He(p.head,p.anchor)?1:0,L=He(p.head,p.anchor)?1:0;return S=mt(p.head,0,N),C=mt(p.anchor,0,L),{ranges:[{anchor:C,head:S}],primary:0}}else if(g=="line"){if(He(p.head,p.anchor))S.ch=0,C.ch=ln(d,C.line);else{C.ch=0;var V=d.lastLine();S.line>V&&(S.line=V),S.ch=ln(d,S.line)}return{ranges:[{anchor:C,head:S}],primary:0}}else if(g=="block"){var z=Math.min(C.line,S.line),G=C.ch,ie=Math.max(C.line,S.line),le=S.ch;G<le?le+=1:G+=1;for(var se=ie-z+1,K=S.line==z?0:se-1,ve=[],xe=0;xe<se;xe++)ve.push({anchor:new e(z+xe,G),head:new e(z+xe,le)});return{ranges:ve,primary:K}}throw"never happens"}function Fe(d){var p=d.getCursor("head");return d.getSelection().length==1&&(p=Tt(p,d.getCursor("anchor"))),p}function Be(d,p){var g=d.state.vim;p!==!1&&d.setCursor(tt(d,g.sel.head)),H(d,g),g.visualMode=!1,g.visualLine=!1,g.visualBlock=!1,g.insertMode||n.signal(d,"vim-mode-change",{mode:"normal"})}function wt(d,p,g){var b=d.getRange(p,g);if(/\n\s*$/.test(b)){var S=b.split(`
`);S.pop();for(var C=S.pop();S.length>0&&C&&$(C);C=S.pop())g.line--,g.ch=0;C?(g.line--,g.ch=ln(d,g.line)):g.ch=0}}function Nt(d,p,g){p.ch=0,g.ch=0,g.line++}function yn(d){if(!d)return 0;var p=d.search(/\S/);return p==-1?d.length:p}function ws(d,{inclusive:p,innerWord:g,bigWord:b,noSymbol:S,multiline:C},N){var L=N||Fe(d),V=d.getLine(L.line),z=V,G=L.line,ie=G,le=L.ch,se,K=S?m[0]:f[0];if(g&&/\s/.test(V.charAt(le)))K=function(ct){return/\s/.test(ct)};else{for(;!K(V.charAt(le));)if(le++,le>=V.length){if(!C)return null;le--,se=Fa(d,L,!0,b,!0);break}b?K=f[0]:(K=m[0],K(V.charAt(le))||(K=m[1]))}for(var ve=le,xe=le;K(V.charAt(xe))&&xe>=0;)xe--;if(xe++,se)ve=se.to,ie=se.line,z=d.getLine(ie),!z&&ve==0&&ve++;else for(;K(V.charAt(ve))&&ve<V.length;)ve++;if(p){var $e=ve,Pe=L.ch<=xe&&/\s/.test(V.charAt(L.ch));if(!Pe)for(;/\s/.test(z.charAt(ve))&&ve<z.length;)ve++;if($e==ve||Pe){for(var ze=xe;/\s/.test(V.charAt(xe-1))&&xe>0;)xe--;!xe&&!Pe&&(xe=ze)}}return{start:new e(G,xe),end:new e(ie,ve)}}function gn(d,p,g){var b=p;if(!n.findMatchingTag||!n.findEnclosingTag)return{start:b,end:b};var S=n.findMatchingTag(d,p)||n.findEnclosingTag(d,p);return!S||!S.open||!S.close?{start:b,end:b}:g?{start:S.open.from,end:S.close.to}:{start:S.open.to,end:S.close.from}}function _s(d,p,g){Sn(p,g)||q.jumpList.add(d,p,g)}function Cn(d,p){q.lastCharacterSearch.increment=d,q.lastCharacterSearch.forward=p.forward,q.lastCharacterSearch.selectedCharacter=p.selectedCharacter}var Pn={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},bs={bracket:{isComplete:function(d){if(d.nextCh===d.symb){if(d.depth++,d.depth>=1)return!0}else d.nextCh===d.reverseSymb&&d.depth--;return!1}},section:{init:function(d){d.curMoveThrough=!0,d.symb=(d.forward?"]":"[")===d.symb?"{":"}"},isComplete:function(d){return d.index===0&&d.nextCh===d.symb}},comment:{isComplete:function(d){var p=d.lastCh==="*"&&d.nextCh==="/";return d.lastCh=d.nextCh,p}},method:{init:function(d){d.symb=d.symb==="m"?"{":"}",d.reverseSymb=d.symb==="{"?"}":"{"},isComplete:function(d){return d.nextCh===d.symb}},preprocess:{init:function(d){d.index=0},isComplete:function(d){var g;if(d.nextCh==="#"){var p=(g=d.lineText.match(/^#(\w+)/))==null?void 0:g[1];if(p==="endif"){if(d.forward&&d.depth===0)return!0;d.depth++}else if(p==="if"){if(!d.forward&&d.depth===0)return!0;d.depth--}if(p==="else"&&d.depth===0)return!0}return!1}}};function ls(d,p,g,b){var S=Dt(d.getCursor()),C=g?1:-1,N=g?d.lineCount():-1,L=S.ch,V=S.line,z=d.getLine(V),G={lineText:z,nextCh:z.charAt(L),lastCh:null,index:L,symb:b,reverseSymb:(g?{")":"(","}":"{"}:{"(":")","{":"}"})[b],forward:g,depth:0,curMoveThrough:!1},ie=Pn[b];if(!ie)return S;var le=bs[ie].init,se=bs[ie].isComplete;for(le&&le(G);V!==N&&p;){if(G.index+=C,G.nextCh=G.lineText.charAt(G.index),!G.nextCh){if(V+=C,G.lineText=d.getLine(V)||"",C>0)G.index=0;else{var K=G.lineText.length;G.index=K>0?K-1:0}G.nextCh=G.lineText.charAt(G.index)}se(G)&&(S.line=V,S.ch=G.index,p--)}return G.nextCh||G.curMoveThrough?new e(V,G.index):S}function Fa(d,p,g,b,S){var C=p.line,N=p.ch,L=d.getLine(C),V=g?1:-1,z=b?f:m;if(S&&L==""){if(C+=V,L=d.getLine(C),!E(d,C))return null;N=g?0:L.length}for(;;){if(S&&L=="")return{from:0,to:0,line:C};for(var G=V>0?L.length:-1,ie=G,le=G;N!=G;){for(var se=!1,K=0;K<z.length&&!se;++K)if(z[K](L.charAt(N))){for(ie=N;N!=G&&z[K](L.charAt(N));)N+=V;if(le=N,se=ie!=le,ie==p.ch&&C==p.line&&le==ie+V)continue;return{from:Math.min(ie,le+1),to:Math.max(ie,le),line:C}}se||(N+=V)}if(C+=V,!E(d,C))return null;L=d.getLine(C),N=V>0?0:L.length}}function $r(d,p,g,b,S,C){var N=Dt(p),L=[];(b&&!S||!b&&S)&&g++;for(var V=!(b&&S),z=0;z<g;z++){var G=Fa(d,p,b,C,V);if(!G){var ie=ln(d,d.lastLine());L.push(b?{line:d.lastLine(),from:ie,to:ie}:{line:0,from:0,to:0});break}L.push(G),p=new e(G.line,b?G.to-1:G.from)}var le=L.length!=g,se=L[0],K=L.pop();return b&&!S?(!le&&(se.from!=N.ch||se.line!=N.line)&&(K=L.pop()),K&&new e(K.line,K.from)):b&&S?K&&new e(K.line,K.to-1):!b&&S?(!le&&(se.to!=N.ch||se.line!=N.line)&&(K=L.pop()),K&&new e(K.line,K.to)):K&&new e(K.line,K.from)}function Rr(d,p,g,b,S){var C=p,N=new e(C.line+g.repeat-1,1/0),L=d.clipPos(N);return L.ch--,S||(b.lastHPos=1/0,b.lastHSPos=d.charCoords(L,"div").left),N}function Na(d,p,g,b,S){if(b){for(var C=S||d.getCursor(),N=C.ch,L,V=0;V<p;V++){var z=d.getLine(C.line);if(L=oc(N,z,b,g),L==-1)return;N=L}if(L!=null)return new e(d.getCursor().line,L)}}function rc(d,p){var g=d.getCursor().line;return tt(d,new e(g,p-1))}function Ls(d,p,g,b){!ce(g,v)&&!k.test(g)||(p.marks[g]&&p.marks[g].clear(),p.marks[g]=d.setBookmark(b))}function oc(d,p,g,b,S){var C;return b?C=p.indexOf(g,d+1):C=p.lastIndexOf(g,d-1),C}function vo(d,p,g,b,S){var C=p.line,N=d.firstLine(),L=d.lastLine(),V,z,G=C;function ie(xe){return!d.getLine(xe)}function le(xe,$e,Pe){return Pe?ie(xe)!=ie(xe+$e):!ie(xe)&&ie(xe+$e)}if(b){for(;N<=G&&G<=L&&g>0;)le(G,b)&&g--,G+=b;return{start:new e(G,0),end:p}}var se=d.state.vim;if(se.visualLine&&le(C,1,!0)){var K=se.sel.anchor;le(K.line,-1,!0)&&(!S||K.line!=C)&&(C+=1)}var ve=ie(C);for(G=C;G<=L&&g;G++)le(G,1,!0)&&(!S||ie(G)!=ve)&&g--;for(z=new e(G,0),G>L&&!ve?ve=!0:S=!1,G=C;G>N&&!((!S||ie(G)==ve||G==C)&&le(G,-1,!0));G--);return V=new e(G,0),{start:V,end:z}}function er(d,p,g,b,S){function C(z){z.line!==null&&(z.pos+z.dir<0||z.pos+z.dir>=z.line.length?z.line=null:z.pos+=z.dir)}function N(z,G,ie,le){var se=z.getLine(G),K={line:se,ln:G,pos:ie,dir:le};if(K.line==="")return{ln:K.ln,pos:K.pos};var ve=K.pos;for(C(K);K.line!==null;){if(ve=K.pos,Z(K.line[K.pos]))if(S){for(C(K);K.line!==null&&$(K.line[K.pos]);)ve=K.pos,C(K);return{ln:K.ln,pos:ve+1}}else return{ln:K.ln,pos:K.pos+1};C(K)}return{ln:K.ln,pos:ve+1}}function L(z,G,ie,le){var se=z.getLine(G),K={line:se,ln:G,pos:ie,dir:le};if(K.line==="")return{ln:K.ln,pos:K.pos};var ve=K.pos;for(C(K);K.line!==null;){if(!$(K.line[K.pos])&&!Z(K.line[K.pos]))ve=K.pos;else if(Z(K.line[K.pos]))return S?$(K.line[K.pos+1])?{ln:K.ln,pos:K.pos+1}:{ln:K.ln,pos:ve}:{ln:K.ln,pos:ve};C(K)}return K.line=se,S&&$(K.line[K.pos])?{ln:K.ln,pos:K.pos}:{ln:K.ln,pos:ve}}for(var V={ln:p.line,pos:p.ch};g>0;)b<0?V=L(d,V.ln,V.pos,b):V=N(d,V.ln,V.pos,b),g--;return new e(V.ln,V.pos)}function ic(d,p,g,b){function S(V,z){if(z.line!==null)if(z.pos+z.dir<0||z.pos+z.dir>=z.line.length){if(z.ln+=z.dir,!E(V,z.ln)){z.line=null;return}z.line=V.getLine(z.ln),z.pos=z.dir>0?0:z.line.length-1}else z.pos+=z.dir}function C(V,z,G,ie){var xe=V.getLine(z),le=xe==="",se={line:xe,ln:z,pos:G,dir:ie},K={ln:se.ln,pos:se.pos},ve=se.line==="";for(S(V,se);se.line!==null;){if(K.ln=se.ln,K.pos=se.pos,se.line===""&&!ve)return{ln:se.ln,pos:se.pos};if(le&&se.line!==""&&!$(se.line[se.pos]))return{ln:se.ln,pos:se.pos};Z(se.line[se.pos])&&!le&&(se.pos===se.line.length-1||$(se.line[se.pos+1]))&&(le=!0),S(V,se)}var xe=V.getLine(K.ln);K.pos=0;for(var $e=xe.length-1;$e>=0;--$e)if(!$(xe[$e])){K.pos=$e;break}return K}function N(V,z,G,ie){var xe=V.getLine(z),le={line:xe,ln:z,pos:G,dir:ie},se=le.ln,K=null,ve=le.line==="";for(S(V,le);le.line!==null;){if(le.line===""&&!ve)return K!==null?{ln:se,pos:K}:{ln:le.ln,pos:le.pos};if(Z(le.line[le.pos])&&K!==null&&!(le.ln===se&&le.pos+1===K))return{ln:se,pos:K};le.line!==""&&!$(le.line[le.pos])&&(ve=!1,se=le.ln,K=le.pos),S(V,le)}var xe=V.getLine(se);K=0;for(var $e=0;$e<xe.length;++$e)if(!$(xe[$e])){K=$e;break}return{ln:se,pos:K}}for(var L={ln:p.line,pos:p.ch};g>0;)b<0?L=N(d,L.ln,L.pos,b):L=C(d,L.ln,L.pos,b),g--;return new e(L.ln,L.pos)}function wo(d,p,g,b){var S=p,C={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[g],N={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"}[g],L=d.getLine(S.line).charAt(S.ch),V=L===N?1:0,z=d.scanForBracket(new e(S.line,S.ch+V),-1,void 0,{bracketRegex:C}),G=d.scanForBracket(new e(S.line,S.ch+V),1,void 0,{bracketRegex:C});if(!z||!G)return null;var ie=z.pos,le=G.pos;if(ie.line==le.line&&ie.ch>le.ch||ie.line>le.line){var se=ie;ie=le,le=se}return b?le.ch+=1:ie.ch+=1,{start:ie,end:le}}function Zo(d,p,g,b){var S=Dt(p),C=d.getLine(S.line),N=C.split(""),L,V,z,G,ie=N.indexOf(g);if(S.ch<ie)S.ch=ie;else if(ie<S.ch&&N[S.ch]==g){var le=/string/.test(d.getTokenTypeAt(mt(p,0,1))),se=/string/.test(d.getTokenTypeAt(p)),K=le&&!se;K||(V=S.ch,--S.ch)}if(N[S.ch]==g&&!V)L=S.ch+1;else for(z=S.ch;z>-1&&!L;z--)N[z]==g&&(L=z+1);if(L&&!V)for(z=L,G=N.length;z<G&&!V;z++)N[z]==g&&(V=z);return!L||!V?{start:S,end:S}:(b&&(--L,++V),{start:new e(S.line,L),end:new e(S.line,V)})}ue("pcre",!0,"boolean");class _r{constructor(){this.highlightTimeout}getQuery(){return q.query}setQuery(p){q.query=p}getOverlay(){return this.searchOverlay}setOverlay(p){this.searchOverlay=p}isReversed(){return q.isReversed}setReversed(p){q.isReversed=p}getScrollbarAnnotate(){return this.annotate}setScrollbarAnnotate(p){this.annotate=p}}function Yn(d){var p=d.state.vim;return p.searchState_||(p.searchState_=new _r)}function oa(d){return br(d,"/")}function Lr(d){return tr(d,"/")}function br(d,p){var g=tr(d,p);if(!g.length)return[];var b=[];if(g[0]===0){for(var S=0;S<g.length;S++)typeof g[S]=="number"&&b.push(d.substring(g[S]+1,g[S+1]));return b}}function tr(d,p){p||(p="/");for(var g=!1,b=[],S=0;S<d.length;S++){var C=d.charAt(S);!g&&C==p&&b.push(S),g=!g&&C=="\\"}return b}function Ir(d){var p={V:"|(){+?*.[$^",M:"|(){+?*.[",m:"|(){+?",v:"<>"},g={">":"(?<=[\\w])(?=[^\\w]|$)","<":"(?<=[^\\w]|^)(?=[\\w])"},b=p.m,S=d.replace(/\\.|[\[|(){+*?.$^<>]/g,function(N){if(N[0]==="\\"){var L=N[1];return L==="}"||b.indexOf(L)!=-1?L:L in p?(b=p[L],""):L in g?g[L]:N}else return b.indexOf(N)!=-1?g[N]||"\\"+N:N}),C=S.indexOf("\\zs");return C!=-1&&(S="(?<="+S.slice(0,C)+")"+S.slice(C+3)),C=S.indexOf("\\ze"),C!=-1&&(S=S.slice(0,C)+"(?="+S.slice(C+3)+")"),S}var nr={"\\n":`
`,"\\r":"\r","\\t":"	"};function lc(d){for(var p=!1,g=[],b=-1;b<d.length;b++){var S=d.charAt(b)||"",C=d.charAt(b+1)||"";nr[S+C]?(g.push(nr[S+C]),b++):p?(g.push(S),p=!1):S==="\\"?(p=!0,F(C)||C==="$"?g.push("$"):C!=="/"&&C!=="\\"&&g.push("\\")):(S==="$"&&g.push("$"),g.push(S),C==="/"&&g.push("\\"))}return g.join("")}var Ba={"\\/":"/","\\\\":"\\","\\n":`
`,"\\r":"\r","\\t":"	","\\&":"&"};function zo(d){for(var p=new n.StringStream(d),g=[];!p.eol();){for(;p.peek()&&p.peek()!="\\";)g.push(p.next());var b=!1;for(var S in Ba)if(p.match(S,!0)){b=!0,g.push(Ba[S]);break}b||g.push(p.next())}return g.join("")}function Oo(d,p,g){var b=q.registerController.getRegister("/");b.setText(d);var S=Lr(d),C,N;if(!S.length)C=d;else{C=d.substring(0,S[0]);var L=d.substring(S[0]);N=L.indexOf("i")!=-1}if(!C)return null;de("pcre")||(C=Ir(C)),g&&(p=/^[^A-Z]*$/.test(C));var V=new RegExp(C,p||N?"im":"m");return V}function ys(d){typeof d=="string"&&(d=document.createElement(d));for(var p=1;p<arguments.length;p++){var g=arguments[p];if(g)if(typeof g!="object"&&(g=document.createTextNode(g)),g.nodeType)d.appendChild(g);else for(var b in g)Object.prototype.hasOwnProperty.call(g,b)&&(b[0]==="$"?d.style[b.slice(1)]=g[b]:typeof g[b]=="function"?d[b]=g[b]:d.setAttribute(b,g[b]))}return d}function Ct(d,p,g){var b=ys("div",{$color:"red",$whiteSpace:"pre",class:"cm-vim-message"},p);d.openNotification?g?(b=ys("div",{},b,ys("div",{},"Press ENTER or type command to continue")),d.state.closeVimNotification&&d.state.closeVimNotification(),d.state.closeVimNotification=d.openNotification(b,{bottom:!0,duration:0})):d.openNotification(b,{bottom:!0,duration:15e3}):alert(b.innerText)}function Ai(d,p){return ys("div",{$display:"flex",$flex:1},ys("span",{$fontFamily:"monospace",$whiteSpace:"pre",$flex:1,$display:"flex"},d,ys("input",{type:"text",autocorrect:"off",autocapitalize:"off",spellcheck:"false",$flex:1})),p&&ys("span",{$color:"#888"},p))}function yr(d,p){var S;if(Ye.length){p.value||(p.value=""),_e=p;return}var g=Ai(p.prefix,p.desc);if(d.openDialog)d.openDialog(g,p.onClose,{onKeyDown:p.onKeyDown,onKeyUp:p.onKeyUp,bottom:!0,selectValueOnOpen:!1,value:p.value});else{var b="";typeof p.prefix!="string"&&p.prefix&&(b+=p.prefix.textContent),p.desc&&(b+=" "+p.desc),(S=p.onClose)==null||S.call(p,prompt(b,""))}}function cc(d,p){return d instanceof RegExp&&p instanceof RegExp?d.flags==p.flags&&d.source==p.source:!1}function $a(d,p,g,b){if(p){var S=Yn(d),C=Oo(p,!!g,!!b);if(C)return Y(d,C),cc(C,S.getQuery())||S.setQuery(C),C}}function hl(d){if(d.source.charAt(0)=="^")var p=!0;return{token:function(g){if(p&&!g.sol()){g.skipToEnd();return}var b=g.match(d,!1);if(b)return b[0].length==0?(g.next(),"searching"):!g.sol()&&(g.backUp(1),!d.exec(g.next()+b[0]))?(g.next(),null):(g.match(d),"searching");for(;!g.eol()&&(g.next(),!g.match(d,!1)););},query:d}}var Ra=0;function Y(d,p){clearTimeout(Ra);var g=Yn(d);g.highlightTimeout=Ra,Ra=setTimeout(function(){if(d.state.vim){var b=Yn(d);b.highlightTimeout=void 0;var S=b.getOverlay();(!S||p!=S.query)&&(S&&d.removeOverlay(S),S=hl(p),d.addOverlay(S),d.showMatchesOnScrollbar&&(b.getScrollbarAnnotate()&&b.getScrollbarAnnotate().clear(),b.setScrollbarAnnotate(d.showMatchesOnScrollbar(p))),b.setOverlay(S))}},50)}function J(d,p,g,b){return d.operation(function(){b===void 0&&(b=1);for(var S=d.getCursor(),C=d.getSearchCursor(g,S),N=0;N<b;N++){var L=C.find(p);if(N==0&&L&&Sn(C.from(),S)){var V=p?C.from():C.to();L=C.find(p),L&&!L[0]&&Sn(C.from(),V)&&d.getLine(V.line).length==V.ch&&(L=C.find(p))}if(!L&&(C=d.getSearchCursor(g,p?new e(d.lastLine()):new e(d.firstLine(),0)),!C.find(p)))return}return C.from()})}function te(d,p,g,b,S){return d.operation(function(){b===void 0&&(b=1);var C=d.getCursor(),N=d.getSearchCursor(g,C),L=N.find(!p);!S.visualMode&&L&&Sn(N.from(),C)&&N.find(!p);for(var V=0;V<b;V++)if(L=N.find(p),!L&&(N=d.getSearchCursor(g,p?new e(d.lastLine()):new e(d.firstLine(),0)),!N.find(p)))return;var z=N.from(),G=N.to();return z&&G&&[z,G]})}function A(d){var p=Yn(d);p.highlightTimeout&&(clearTimeout(p.highlightTimeout),p.highlightTimeout=void 0),d.removeOverlay(Yn(d).getOverlay()),p.setOverlay(null),p.getScrollbarAnnotate()&&(p.getScrollbarAnnotate().clear(),p.setScrollbarAnnotate(null))}function he(d,p,g){return typeof d!="number"&&(d=d.line),p instanceof Array?ce(d,p):typeof g=="number"?d>=p&&d<=g:d==p}function we(d){var p=d.getScrollInfo(),g=6,b=10,S=d.coordsChar({left:0,top:g+p.top},"local"),C=p.clientHeight-b+p.top,N=d.coordsChar({left:0,top:C},"local");return{top:S.line,bottom:N.line}}function Oe(d,p,g){if(g=="'"||g=="`")return q.jumpList.find(d,-1)||new e(0,0);if(g==".")return Se(d);var b=p.marks[g];return b&&b.find()}function Se(d){if(d.getLastEditEnd)return d.getLastEditEnd();for(var p=d.doc.history.done,g=p.length;g--;)if(p[g].changes)return Dt(p[g].changes[0].to)}class fe{constructor(){this.commandMap_,this.buildCommandMap_()}processCommand(p,g,b){var S=this;p.operation(function(){p.curOp&&(p.curOp.isVimOp=!0),S._processCommand(p,g,b)})}_processCommand(p,g,b){var S=p.state.vim,C=q.registerController.getRegister(":"),N=C.toString(),L=new n.StringStream(g);C.setText(g);var V=b||{};V.input=g;try{this.parseInput_(p,L,V)}catch(ie){throw Ct(p,ie+""),ie}S.visualMode&&Be(p);var z,G;if(!V.commandName)V.line!==void 0&&(G="move");else if(z=this.matchCommand_(V.commandName),z){if(G=z.name,z.excludeFromCommandHistory&&C.setText(N),this.parseCommandArgs_(L,V,z),z.type=="exToKey"){pt(p,z.toKeys||"",z);return}else if(z.type=="exToEx"){this.processCommand(p,z.toInput||"");return}}if(!G){Ct(p,'Not an editor command ":'+g+'"');return}try{Te[G](p,V),(!z||!z.possiblyAsync)&&V.callback&&V.callback()}catch(ie){throw Ct(p,ie+""),ie}}parseInput_(p,g,b){var C,N;g.eatWhile(":"),g.eat("%")?(b.line=p.firstLine(),b.lineEnd=p.lastLine()):(b.line=this.parseLineSpec_(p,g),b.line!==void 0&&g.eat(",")&&(b.lineEnd=this.parseLineSpec_(p,g))),b.line==null?p.state.vim.visualMode?(b.selectionLine=(C=Oe(p,p.state.vim,"<"))==null?void 0:C.line,b.selectionLineEnd=(N=Oe(p,p.state.vim,">"))==null?void 0:N.line):b.selectionLine=p.getCursor().line:(b.selectionLine=b.line,b.selectionLineEnd=b.lineEnd);var S=g.match(/^(\w+|!!|@@|[!#&*<=>@~])/);return S?b.commandName=S[1]:b.commandName=(g.match(/.*/)||[""])[0],b}parseLineSpec_(p,g){var b=g.match(/^(\d+)/);if(b)return parseInt(b[1],10)-1;switch(g.next()){case".":return this.parseLineSpecOffset_(g,p.getCursor().line);case"$":return this.parseLineSpecOffset_(g,p.lastLine());case"'":var S=g.next()||"",C=Oe(p,p.state.vim,S);if(!C)throw new Error("Mark not set");return this.parseLineSpecOffset_(g,C.line);case"-":case"+":return g.backUp(1),this.parseLineSpecOffset_(g,p.getCursor().line);default:g.backUp(1);return}}parseLineSpecOffset_(p,g){var b=p.match(/^([+-])?(\d+)/);if(b){var S=parseInt(b[2],10);b[1]=="-"?g-=S:g+=S}return g}parseCommandArgs_(p,g,b){var N;if(!p.eol()){g.argString=(N=p.match(/.*/))==null?void 0:N[0];var S=b.argDelimiter||/\s+/,C=Gs(g.argString||"").split(S);C.length&&C[0]&&(g.args=C)}}matchCommand_(p){for(var g=p.length;g>0;g--){var b=p.substring(0,g);if(this.commandMap_[b]){var S=this.commandMap_[b];if(S.name.indexOf(p)===0)return S}}}buildCommandMap_(){this.commandMap_={};for(var p=0;p<o.length;p++){var g=o[p],b=g.shortName||g.name;this.commandMap_[b]=g}}map(p,g,b,S){if(p!=":"&&p.charAt(0)==":"){if(b)throw Error("Mode not supported for ex mappings");var C=p.substring(1);g!=":"&&g.charAt(0)==":"?this.commandMap_[C]={name:C,type:"exToEx",toInput:g.substring(1),user:!0}:this.commandMap_[C]={name:C,type:"exToKey",toKeys:g,user:!0}}else{var N={keys:p,type:"keyToKey",toKeys:g,noremap:!!S};b&&(N.context=b),ot(N)}}unmap(p,g){if(p!=":"&&p.charAt(0)==":"){if(g)throw Error("Mode not supported for ex mappings");var b=p.substring(1);if(this.commandMap_[b]&&this.commandMap_[b].user)return delete this.commandMap_[b],!0}else for(var S=p,C=0;C<s.length;C++)if(S==s[C].keys&&s[C].context===g)return s.splice(C,1),Je(S),!0}}var Te={colorscheme:function(d,p){if(!p.args||p.args.length<1){Ct(d,d.getOption("theme"));return}d.setOption("theme",p.args[0])},map:function(d,p,g,b){var S=p.args;if(!S||S.length<2){d&&Ct(d,"Invalid mapping: "+p.input);return}Qe.map(S[0],S[1],g,b)},imap:function(d,p){this.map(d,p,"insert")},nmap:function(d,p){this.map(d,p,"normal")},vmap:function(d,p){this.map(d,p,"visual")},omap:function(d,p){this.map(d,p,"operatorPending")},noremap:function(d,p){this.map(d,p,void 0,!0)},inoremap:function(d,p){this.map(d,p,"insert",!0)},nnoremap:function(d,p){this.map(d,p,"normal",!0)},vnoremap:function(d,p){this.map(d,p,"visual",!0)},onoremap:function(d,p){this.map(d,p,"operatorPending",!0)},unmap:function(d,p,g){var b=p.args;(!b||b.length<1||!Qe.unmap(b[0],g))&&d&&Ct(d,"No such mapping: "+p.input)},mapclear:function(d,p){me.mapclear()},imapclear:function(d,p){me.mapclear("insert")},nmapclear:function(d,p){me.mapclear("normal")},vmapclear:function(d,p){me.mapclear("visual")},omapclear:function(d,p){me.mapclear("operatorPending")},move:function(d,p){nt.processCommand(d,d.state.vim,{keys:"",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:p.line+1})},set:function(d,p){var g=p.args,b=p.setCfg||{};if(!g||g.length<1){d&&Ct(d,"Invalid mapping: "+p.input);return}var S=g[0].split("="),C=S.shift()||"",N=S.length>0?S.join("="):void 0,L=!1,V=!1;if(C.charAt(C.length-1)=="?"){if(N)throw Error("Trailing characters: "+p.argString);C=C.substring(0,C.length-1),L=!0}else C.charAt(C.length-1)=="!"&&(C=C.substring(0,C.length-1),V=!0);N===void 0&&C.substring(0,2)=="no"&&(C=C.substring(2),N=!1);var z=U[C]&&U[C].type=="boolean";if(z&&(V?N=!de(C,d,b):N==null&&(N=!0)),!z&&N===void 0||L){var G=de(C,d,b);G instanceof Error?Ct(d,G.message):G===!0||G===!1?Ct(d," "+(G?"":"no")+C):Ct(d,"  "+C+"="+G)}else{var ie=W(C,N,d,b);ie instanceof Error&&Ct(d,ie.message)}},setlocal:function(d,p){p.setCfg={scope:"local"},this.set(d,p)},setglobal:function(d,p){p.setCfg={scope:"global"},this.set(d,p)},registers:function(d,p){var g=p.args,b=q.registerController.registers,S=`----------Registers----------

`;if(g)for(var C=g.join(""),N=0;N<C.length;N++){var L=C.charAt(N);if(q.registerController.isValidRegister(L)){var V=b[L]||new un;S+='"'+L+"    "+V.toString()+`
`}}else for(var L in b){var z=b[L].toString();z.length&&(S+='"'+L+"    "+z+`
`)}Ct(d,S,!0)},marks:function(d,p){var g=p.args,b=d.state.vim.marks,S=`-----------Marks-----------
mark	line	col

`;if(g)for(var C=g.join(""),N=0;N<C.length;N++){var L=C.charAt(N),V=b[L]&&b[L].find();V&&(S+=L+"	"+V.line+"	"+V.ch+`
`)}else for(var L in b){var V=b[L]&&b[L].find();V&&(S+=L+"	"+V.line+"	"+V.ch+`
`)}Ct(d,S,!0)},sort:function(d,p){var g,b,S,C,N;function L(){if(p.argString){var Ot=new n.StringStream(p.argString);if(Ot.eat("!")&&(g=!0),Ot.eol())return;if(!Ot.eatSpace())return"Invalid arguments";var qe=Ot.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!qe||!Ot.eol())return"Invalid arguments";if(qe[1]){b=qe[1].indexOf("i")!=-1,S=qe[1].indexOf("u")!=-1;var Ut=qe[1].indexOf("d")!=-1||qe[1].indexOf("n")!=-1,Dn=qe[1].indexOf("x")!=-1,nn=qe[1].indexOf("o")!=-1;if(Number(Ut)+Number(Dn)+Number(nn)>1)return"Invalid arguments";C=Ut&&"decimal"||Dn&&"hex"||nn&&"octal"}qe[2]&&(N=new RegExp(qe[2].substr(1,qe[2].length-2),b?"i":""))}}var V=L();if(V){Ct(d,V+": "+p.argString);return}var z=p.line||d.firstLine(),G=p.lineEnd||p.line||d.lastLine();if(z==G)return;var ie=new e(z,0),le=new e(G,ln(d,G)),se=d.getRange(ie,le).split(`
`),K=C=="decimal"?/(-?)([\d]+)/:C=="hex"?/(-?)(?:0x)?([0-9a-f]+)/i:C=="octal"?/([0-7]+)/:null,ve=C=="decimal"?10:C=="hex"?16:C=="octal"?8:void 0,xe=[],$e=[];if(C||N)for(var Pe=0;Pe<se.length;Pe++){var ze=N?se[Pe].match(N):null;ze&&ze[0]!=""?xe.push(ze):K&&K.exec(se[Pe])?xe.push(se[Pe]):$e.push(se[Pe])}else $e=se;function ct(Ot,qe){if(g){var Ut;Ut=Ot,Ot=qe,qe=Ut}b&&(Ot=Ot.toLowerCase(),qe=qe.toLowerCase());var Dn=K&&K.exec(Ot),nn=K&&K.exec(qe);if(!Dn||!nn)return Ot<qe?-1:1;var bn=parseInt((Dn[1]+Dn[2]).toLowerCase(),ve),ps=parseInt((nn[1]+nn[2]).toLowerCase(),ve);return bn-ps}function it(Ot,qe){if(g){var Ut;Ut=Ot,Ot=qe,qe=Ut}return b&&(Ot[0]=Ot[0].toLowerCase(),qe[0]=qe[0].toLowerCase()),Ot[0]<qe[0]?-1:1}if(xe.sort(N?it:ct),N)for(var Pe=0;Pe<xe.length;Pe++)xe[Pe]=xe[Pe].input;else C||$e.sort(ct);if(se=g?xe.concat($e):$e.concat(xe),S){var Rt=se,_t;se=[];for(var Pe=0;Pe<Rt.length;Pe++)Rt[Pe]!=_t&&se.push(Rt[Pe]),_t=Rt[Pe]}d.replaceRange(se.join(`
`),ie,le)},vglobal:function(d,p){this.global(d,p)},normal:function(d,p){var g=!1,b=p.argString;if(b&&b[0]=="!"&&(b=b.slice(1),g=!0),b=b.trimStart(),!b){Ct(d,"Argument is required.");return}var S=p.line;if(typeof S=="number")for(var C=isNaN(p.lineEnd)?S:p.lineEnd,N=S;N<=C;N++)d.setCursor(N,0),pt(d,p.argString.trimStart(),{noremap:g}),d.state.vim.insertMode&&De(d,!0);else pt(d,p.argString.trimStart(),{noremap:g}),d.state.vim.insertMode&&De(d,!0)},global:function(d,p){var g=p.argString;if(!g){Ct(d,"Regular Expression missing from global");return}var b=p.commandName[0]==="v";g[0]==="!"&&p.commandName[0]==="g"&&(b=!0,g=g.slice(1));var S=p.line!==void 0?p.line:d.firstLine(),C=p.lineEnd||p.line||d.lastLine(),N=oa(g),L=g,V="";if(N&&N.length&&(L=N[0],V=N.slice(1,N.length).join("/")),L)try{$a(d,L,!0,!0)}catch{Ct(d,"Invalid regex: "+L);return}for(var z=Yn(d).getQuery(),G=[],ie=S;ie<=C;ie++){var le=d.getLine(ie),se=z.test(le);se!==b&&G.push(V?d.getLineHandle(ie):le)}if(!V){Ct(d,G.join(`
`));return}var K=0,ve=function(){if(K<G.length){var xe=G[K++],$e=d.getLineNumber(xe);if($e==null){ve();return}var Pe=$e+1+V;Qe.processCommand(d,Pe,{callback:ve})}else d.releaseLineHandles&&d.releaseLineHandles()};ve()},substitute:function(d,p){if(!d.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var g=p.argString,b=g?br(g,g[0]):[],S="",C="",N,L,V,z=!1,G=!1;if(b&&b.length)S=b[0],de("pcre")&&S!==""&&(S=new RegExp(S).source),C=b[1],C!==void 0&&(de("pcre")?C=zo(C.replace(/([^\\])&/g,"$1$$&")):C=lc(C),q.lastSubstituteReplacePart=C),N=b[2]?b[2].split(" "):[];else if(g&&g.length){Ct(d,"Substitutions should be of the form :s/pattern/replace/");return}if(N&&(L=N[0],V=parseInt(N[1]),L&&(L.indexOf("c")!=-1&&(z=!0),L.indexOf("g")!=-1&&(G=!0),de("pcre")?S=S+"/"+L:S=S.replace(/\//g,"\\/")+"/"+L)),S)try{$a(d,S,!0,!0)}catch{Ct(d,"Invalid regex: "+S);return}if(C=C||q.lastSubstituteReplacePart,C===void 0){Ct(d,"No previous substitute regular expression");return}var ie=Yn(d),le=ie.getQuery(),se=p.line!==void 0?p.line:d.getCursor().line,K=p.lineEnd||se;se==d.firstLine()&&K==d.lastLine()&&(K=1/0),V&&(se=K,K=se+V-1);var ve=tt(d,new e(se,0)),xe=d.getSearchCursor(le,ve);Ee(d,z,G,se,K,xe,le,C,p.callback)},startinsert:function(d,p){pt(d,p.argString=="!"?"A":"i",{})},redo:n.commands.redo,undo:n.commands.undo,write:function(d){n.commands.save?n.commands.save(d):d.save&&d.save()},nohlsearch:function(d){A(d)},yank:function(d){var p=Dt(d.getCursor()),g=p.line,b=d.getLine(g);q.registerController.pushText("0","yank",b,!0,!0)},delete:function(d,p){var g=p.selectionLine,b=isNaN(p.selectionLineEnd)?g:p.selectionLineEnd;lt.delete(d,{linewise:!0},[{anchor:new e(g,0),head:new e(b+1,0)}])},join:function(d,p){var g=p.selectionLine,b=isNaN(p.selectionLineEnd)?g:p.selectionLineEnd;d.setCursor(new e(g,0)),Le.joinLines(d,{repeat:b-g},d.state.vim)},delmarks:function(d,p){if(!p.argString||!Gs(p.argString)){Ct(d,"Argument required");return}for(var g=d.state.vim,b=new n.StringStream(Gs(p.argString));!b.eol();){b.eatSpace();var S=b.pos;if(!b.match(/[a-zA-Z]/,!1)){Ct(d,"Invalid argument: "+p.argString.substring(S));return}var C=b.next();if(b.match("-",!0)){if(!b.match(/[a-zA-Z]/,!1)){Ct(d,"Invalid argument: "+p.argString.substring(S));return}var N=C,L=b.next();if(N&&L&&I(N)==I(L)){var V=N.charCodeAt(0),z=L.charCodeAt(0);if(V>=z){Ct(d,"Invalid argument: "+p.argString.substring(S));return}for(var G=0;G<=z-V;G++){var ie=String.fromCharCode(V+G);delete g.marks[ie]}}else{Ct(d,"Invalid argument: "+N+"-");return}}else C&&delete g.marks[C]}}},Qe=new fe;me.defineEx("version","ve",d=>{Ct(d,"Codemirror-vim version: 6.3.0")});function Ee(d,p,g,b,S,C,N,L,V){d.state.vim.exMode=!0;var z=!1,G=0,ie,le,se;function K(){d.operation(function(){for(;!z;)ve(),$e();Pe()})}function ve(){var ct="",it=C.match||C.pos&&C.pos.match;if(it)ct=L.replace(/\$(\d{1,3}|[$&])/g,function(Ot,qe){if(qe=="$")return"$";if(qe=="&")return it[0];for(var Ut=qe;parseInt(Ut)>=it.length&&Ut.length>0;)Ut=Ut.slice(0,Ut.length-1);return Ut?it[Ut]+qe.slice(Ut.length,qe.length):Ot});else{var Rt=d.getRange(C.from(),C.to());ct=Rt.replace(N,L)}var _t=C.to().line;C.replace(ct),le=C.to().line,S+=le-_t,se=le<_t}function xe(){var ct=ie&&Dt(C.to()),it=C.findNext();return it&&!it[0]&&ct&&Sn(C.from(),ct)&&(it=C.findNext()),it&&G++,it}function $e(){for(;xe()&&he(C.from(),b,S);)if(!(!g&&C.from().line==le&&!se)){d.scrollIntoView(C.from(),30),d.setSelection(C.from(),C.to()),ie=C.from(),z=!1;return}z=!0}function Pe(ct){if(ct&&ct(),d.focus(),ie){d.setCursor(ie);var it=d.state.vim;it.exMode=!1,it.lastHPos=it.lastHSPos=ie.ch}V?V():z&&Ct(d,(G?"Found "+G+" matches":"No matches found")+" for pattern: "+N+(de("pcre")?" (set nopcre to use Vim regexps)":""))}function ze(ct,it,Rt){n.e_stop(ct);var _t=xn(ct);switch(_t){case"y":ve(),$e();break;case"n":$e();break;case"a":var Ot=V;V=void 0,d.operation(K),V=Ot;break;case"l":ve();case"q":case"<Esc>":case"<C-c>":case"<C-[>":Pe(Rt);break}return z&&Pe(Rt),!0}if($e(),z){Ct(d,"No matches for "+N+(de("pcre")?" (set nopcre to use vim regexps)":""));return}if(!p){K(),V&&V();return}yr(d,{prefix:ys("span","replace with ",ys("strong",L)," (y/n/a/q/l)"),onKeyDown:ze})}function De(d,p){var g=d.state.vim,b=q.macroModeState,S=q.registerController.getRegister("."),C=b.isPlaying,N=b.lastInsertModeChanges;C||(d.off("change",$t),g.insertEnd&&g.insertEnd.clear(),g.insertEnd=void 0,n.off(d.getInputField(),"keydown",On)),!C&&g.insertModeRepeat&&g.insertModeRepeat>1&&(ms(d,g,g.insertModeRepeat-1,!0),g.lastEditInputState.repeatOverride=g.insertModeRepeat),delete g.insertModeRepeat,g.insertMode=!1,p||d.setCursor(d.getCursor().line,d.getCursor().ch-1),d.setOption("keyMap","vim"),d.setOption("disableInput",!0),d.toggleOverwrite(!1),S.setText(N.changes.join("")),n.signal(d,"vim-mode-change",{mode:"normal"}),b.isRecording&&Ke(b)}function ot(d){s.unshift(d),d.keys&&st(d.keys)}function st(d){d.split(/(<(?:[CSMA]-)*\w+>|.)/i).forEach(function(p){p&&(a[p]||(a[p]=0),a[p]++)})}function Je(d){d.split(/(<(?:[CSMA]-)*\w+>|.)/i).forEach(function(p){a[p]&&a[p]--})}function We(d,p,g,b,S){var C={keys:d,type:p};C[p]=g,C[p+"Args"]=b;for(var N in S)C[N]=S[N];ot(C)}ue("insertModeEscKeysTimeout",200,"number");function et(d,p,g,b){var S=q.registerController.getRegister(b);if(b==":"){S.keyBuffer[0]&&Qe.processCommand(d,S.keyBuffer[0]),g.isPlaying=!1;return}var C=S.keyBuffer,N=0;g.isPlaying=!0,g.replaySearchQueries=S.searchQueries.slice(0);for(var L=0;L<C.length;L++)for(var V=C[L],z,G,ie=/<(?:[CSMA]-)*\w+>|./gi;z=ie.exec(V);)if(G=z[0],me.handleKey(d,G,"macro"),p.insertMode){var le=S.insertModeChanges[N++].changes;q.macroModeState.lastInsertModeChanges.changes=le,Jt(d,le,1),De(d)}g.isPlaying=!1}function Me(d,p){if(!d.isPlaying){var g=d.latestRegister,b=q.registerController.getRegister(g);b&&b.pushText(p)}}function Ke(d){if(!d.isPlaying){var p=d.latestRegister,g=q.registerController.getRegister(p);g&&g.pushInsertModeChanges&&g.pushInsertModeChanges(d.lastInsertModeChanges)}}function Yt(d,p){if(!d.isPlaying){var g=d.latestRegister,b=q.registerController.getRegister(g);b&&b.pushSearchQuery&&b.pushSearchQuery(p)}}function $t(d,p){var g=q.macroModeState,b=g.lastInsertModeChanges;if(!g.isPlaying)for(var S=d.state.vim;p;){if(b.expectCursorActivityForChange=!0,b.ignoreCount>1)b.ignoreCount--;else if(p.origin=="+input"||p.origin=="paste"||p.origin===void 0){var C=d.listSelections().length;C>1&&(b.ignoreCount=C);var N=p.text.join(`
`);if(b.maybeReset&&(b.changes=[],b.maybeReset=!1),N)if(d.state.overwrite&&!/\n/.test(N))b.changes.push([N]);else{if(N.length>1){var L=S&&S.insertEnd&&S.insertEnd.find(),V=d.getCursor();if(L&&L.line==V.line){var z=L.ch-V.ch;z>0&&z<N.length&&(b.changes.push([N,z]),N="")}}N&&b.changes.push(N)}}p=p.next}}function dn(d){var S;var p=d.state.vim;if(p.insertMode){var g=q.macroModeState;if(g.isPlaying)return;var b=g.lastInsertModeChanges;b.expectCursorActivityForChange?b.expectCursorActivityForChange=!1:(b.maybeReset=!0,p.insertEnd&&p.insertEnd.clear(),p.insertEnd=d.setBookmark(d.getCursor(),{insertLeft:!0}))}else(S=d.curOp)!=null&&S.isVimOp||Rn(d,p)}function Rn(d,p){var g=d.getCursor("anchor"),b=d.getCursor("head");if(p.visualMode&&!d.somethingSelected()?Be(d,!1):!p.visualMode&&!p.insertMode&&d.somethingSelected()&&(p.visualMode=!0,p.visualLine=!1,n.signal(d,"vim-mode-change",{mode:"visual"})),p.visualMode){var S=He(b,g)?0:-1,C=He(b,g)?-1:0;b=mt(b,0,S),g=mt(g,0,C),p.sel={anchor:g,head:b},Ls(d,p,"<",Tt(b,g)),Ls(d,p,">",kn(b,g))}else p.insertMode||(p.lastHPos=d.getCursor().ch)}function On(d){var p=q.macroModeState,g=p.lastInsertModeChanges,b=n.keyName?n.keyName(d):d.key;b&&(b.indexOf("Delete")!=-1||b.indexOf("Backspace")!=-1)&&(g.maybeReset&&(g.changes=[],g.maybeReset=!1),g.changes.push(new Re(b,d)))}function ms(d,p,g,b){var S=q.macroModeState;S.isPlaying=!0;var C=p.lastEditActionCommand,N=p.inputState;function L(){C?nt.processAction(d,p,C):nt.evalInput(d,p)}function V(G){if(S.lastInsertModeChanges.changes.length>0){G=p.lastEditActionCommand?G:1;var ie=S.lastInsertModeChanges;Jt(d,ie.changes,G)}}if(p.inputState=p.lastEditInputState,C&&C.interlaceInsertRepeat)for(var z=0;z<g;z++)L(),V(1);else b||L(),V(g);p.inputState=N,p.insertMode&&!b&&De(d),S.isPlaying=!1}function Ps(d,p){n.lookupKey(p,"vim-insert",function(g){return typeof g=="string"?n.commands[g](d):g(d),!0})}function Jt(d,p,g){var b=d.getCursor("head"),S=q.macroModeState.lastInsertModeChanges.visualBlock;S&&(T(d,b,S+1),g=d.listSelections().length,d.setCursor(b));for(var C=0;C<g;C++){S&&d.setCursor(mt(b,C,0));for(var N=0;N<p.length;N++){var L=p[N];if(L instanceof Re)Ps(d,L.keyName);else if(typeof L=="string")d.replaceSelection(L);else{var V=d.getCursor(),z=mt(V,0,L[0].length-(L[1]||0));d.replaceRange(L[0],V,L[1]?V:z),d.setCursor(z)}}}S&&d.setCursor(mt(b,0,1))}function pn(d){var p=new d.constructor;return Object.keys(d).forEach(function(g){if(g!="insertEnd"){var b=d[g];Array.isArray(b)?b=b.slice():b&&typeof b=="object"&&b.constructor!=Object&&(b=pn(b)),p[g]=b}}),d.sel&&(p.sel={head:d.sel.head&&Dt(d.sel.head),anchor:d.sel.anchor&&Dt(d.sel.anchor)}),p}function zt(d,p,g){var C=Ae(d),b=d,S=!1,C=me.maybeInitVimState_(b),N=C.visualBlock||C.wasInVisualBlock;if(b.state.closeVimNotification){var L=b.state.closeVimNotification;if(b.state.closeVimNotification=null,L(),p=="<CR>")return jt(b),!0}var V=b.isInMultiSelectMode();if(C.wasInVisualBlock&&!V?C.wasInVisualBlock=!1:V&&C.visualBlock&&(C.wasInVisualBlock=!0),p=="<Esc>"&&!C.insertMode&&!C.visualMode&&V&&C.status=="<Esc>")jt(b);else if(N||!V||b.inVirtualSelectionMode)S=me.handleKey(b,p,g);else{var z=pn(C),G=C.inputState.changeQueueList||[];b.operation(function(){var le;b.curOp&&(b.curOp.isVimOp=!0);var ie=0;b.forEachSelection(function(){b.state.vim.inputState.changeQueue=G[ie];var se=b.getCursor("head"),K=b.getCursor("anchor"),ve=He(se,K)?0:-1,xe=He(se,K)?-1:0;se=mt(se,0,ve),K=mt(K,0,xe),b.state.vim.sel.head=se,b.state.vim.sel.anchor=K,S=me.handleKey(b,p,g),b.virtualSelection&&(G[ie]=b.state.vim.inputState.changeQueue,b.state.vim=pn(z)),ie++}),(le=b.curOp)!=null&&le.cursorActivity&&!S&&(b.curOp.cursorActivity=!1),b.state.vim=C,C.inputState.changeQueueList=G,C.inputState.changeQueue=null},!0)}return S&&!C.visualMode&&!C.insertMode&&C.visualMode!=b.somethingSelected()&&Rn(b,C),S}return Ne(),me}function Eo(n,e){var t=e.ch,s=e.line+1;s<1&&(s=1,t=0),s>n.lines&&(s=n.lines,t=Number.MAX_VALUE);var a=n.line(s);return Math.min(a.from+Math.max(0,t),a.to)}function Ko(n,e){let t=n.lineAt(e);return{line:t.number-1,ch:e-t.from}}class xl{constructor(e,t){this.line=e,this.ch=t}}function OK(n,e,t){if(n.addEventListener)n.addEventListener(e,t,!1);else{var s=n._handlers||(n._handlers={});s[e]=(s[e]||[]).concat(t)}}function xK(n,e,t){if(n.removeEventListener)n.removeEventListener(e,t,!1);else{var s=n._handlers,a=s&&s[e];if(a){var r=a.indexOf(t);r>-1&&(s[e]=a.slice(0,r).concat(a.slice(r+1)))}}}function kK(n,e,...t){var s,a=(s=n._handlers)===null||s===void 0?void 0:s[e];if(a)for(var r=0;r<a.length;++r)a[r](...t)}function VF(n,...e){if(n)for(var t=0;t<n.length;++t)n[t](...e)}let wC;try{wC=new RegExp("[\\w\\p{Alphabetic}\\p{Number}_]","u")}catch{wC=/[\w]/}function cf(n,e){var t=n.cm6;if(!t.state.readOnly){var s="input.type.compose";if(n.curOp&&(n.curOp.lastChange||(s="input.type.compose.start")),e.annotations)try{e.annotations.some(function(a){a.value=="input"&&(a.value=s)})}catch(a){console.error(a)}else e.userEvent=s;return t.dispatch(e)}}function jF(n,e){var t;n.curOp&&(n.curOp.$changeStart=void 0),(e?Lw:Cm)(n.cm6);let s=(t=n.curOp)===null||t===void 0?void 0:t.$changeStart;s!=null&&n.cm6.dispatch({selection:{anchor:s}})}var tTe={Left:n=>rh(n.cm6,{key:"Left"},"editor"),Right:n=>rh(n.cm6,{key:"Right"},"editor"),Up:n=>rh(n.cm6,{key:"Up"},"editor"),Down:n=>rh(n.cm6,{key:"Down"},"editor"),Backspace:n=>rh(n.cm6,{key:"Backspace"},"editor"),Delete:n=>rh(n.cm6,{key:"Delete"},"editor")};class Bn{openDialog(e,t,s){return sTe(this,e,t,s)}openNotification(e,t){return nTe(this,e,t)}constructor(e){this.state={},this.marks=Object.create(null),this.$mid=0,this.options={},this._handlers={},this.$lastChangeEndOffset=0,this.virtualSelection=null,this.cm6=e,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this)}on(e,t){OK(this,e,t)}off(e,t){xK(this,e,t)}signal(e,t,s){kK(this,e,t,s)}indexFromPos(e){return Eo(this.cm6.state.doc,e)}posFromIndex(e){return Ko(this.cm6.state.doc,e)}foldCode(e){let t=this.cm6,s=t.state.selection.ranges,a=this.cm6.state.doc,r=Eo(a,e),o=Ze.create([Ze.range(r,r)],0).ranges;t.state.selection.ranges=o,CU(t),t.state.selection.ranges=s}firstLine(){return 0}lastLine(){return this.cm6.state.doc.lines-1}lineCount(){return this.cm6.state.doc.lines}setCursor(e,t){typeof e=="object"&&(t=e.ch,e=e.line);var s=Eo(this.cm6.state.doc,{line:e,ch:t||0});this.cm6.dispatch({selection:{anchor:s}},{scrollIntoView:!this.curOp}),this.curOp&&!this.curOp.isVimOp&&this.onBeforeEndOperation()}getCursor(e){var t=this.cm6.state.selection.main,s=e=="head"||!e?t.head:e=="anchor"?t.anchor:e=="start"?t.from:e=="end"?t.to:null;if(s==null)throw new Error("Invalid cursor type");return this.posFromIndex(s)}listSelections(){var e=this.cm6.state.doc;return this.cm6.state.selection.ranges.map(t=>({anchor:Ko(e,t.anchor),head:Ko(e,t.head)}))}setSelections(e,t){var s=this.cm6.state.doc,a=e.map(r=>{var o=Eo(s,r.head),i=Eo(s,r.anchor);return o==i?Ze.cursor(o,1):Ze.range(i,o)});this.cm6.dispatch({selection:Ze.create(a,t)})}setSelection(e,t,s){this.setSelections([{anchor:e,head:t}],0),s&&s.origin=="*mouse"&&this.onBeforeEndOperation()}getLine(e){var t=this.cm6.state.doc;return e<0||e>=t.lines?"":this.cm6.state.doc.line(e+1).text}getLineHandle(e){return this.$lineHandleChanges||(this.$lineHandleChanges=[]),{row:e,index:this.indexFromPos(new xl(e,0))}}getLineNumber(e){var t=this.$lineHandleChanges;if(!t)return null;for(var s=e.index,a=0;a<t.length;a++)if(s=t[a].changes.mapPos(s,1,ga.TrackAfter),s==null)return null;var r=this.posFromIndex(s);return r.ch==0?r.line:null}releaseLineHandles(){this.$lineHandleChanges=void 0}getRange(e,t){var s=this.cm6.state.doc;return this.cm6.state.sliceDoc(Eo(s,e),Eo(s,t))}replaceRange(e,t,s,a){s||(s=t);var r=this.cm6.state.doc,o=Eo(r,t),i=Eo(r,s);cf(this,{changes:{from:o,to:i,insert:e}})}replaceSelection(e){cf(this,this.cm6.state.replaceSelection(e))}replaceSelections(e){var t=this.cm6.state.selection.ranges,s=t.map((a,r)=>({from:a.from,to:a.to,insert:e[r]||""}));cf(this,{changes:s})}getSelection(){return this.getSelections().join(`
`)}getSelections(){var e=this.cm6;return e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to))}somethingSelected(){return this.cm6.state.selection.ranges.some(e=>!e.empty)}getInputField(){return this.cm6.contentDOM}clipPos(e){var t=this.cm6.state.doc,s=e.ch,a=e.line+1;a<1&&(a=1,s=0),a>t.lines&&(a=t.lines,s=Number.MAX_VALUE);var r=t.line(a);return s=Math.min(Math.max(0,s),r.to-r.from),new xl(a-1,s)}getValue(){return this.cm6.state.doc.toString()}setValue(e){var t=this.cm6;return t.dispatch({changes:{from:0,to:t.state.doc.length,insert:e},selection:Ze.range(0,0)})}focus(){return this.cm6.focus()}blur(){return this.cm6.contentDOM.blur()}defaultTextHeight(){return this.cm6.defaultLineHeight}findMatchingBracket(e,t){var s=this.cm6.state,a=Eo(s.doc,e),r=mi(s,a+1,-1);return r&&r.end?{to:Ko(s.doc,r.end.from)}:(r=mi(s,a,1),r&&r.end?{to:Ko(s.doc,r.end.from)}:{to:void 0})}scanForBracket(e,t,s,a){return oTe(this,e,t,s,a)}indentLine(e,t){t?this.indentMore():this.indentLess()}indentMore(){kg(this.cm6)}indentLess(){Pg(this.cm6)}execCommand(e){if(e=="indentAuto")Bn.commands.indentAuto(this);else if(e=="goLineLeft")nv(this.cm6);else if(e=="goLineRight"){tv(this.cm6);let t=this.cm6.state,s=t.selection.main.head;s<t.doc.length&&t.sliceDoc(s,s+1)!==`
`&&LAe(this.cm6)}else console.log(e+" is not implemented")}setBookmark(e,t){var s=t!=null&&t.insertLeft?1:-1,a=this.indexFromPos(e),r=new cTe(this,a,s);return r}addOverlay({query:e}){let t=new E5({regexp:!0,search:e.source,caseSensitive:!/i/.test(e.flags)});if(t.valid){t.forVim=!0,this.cm6Query=t;let s=Qu.of(t);return this.cm6.dispatch({effects:s}),t}}removeOverlay(e){if(!this.cm6Query)return;this.cm6Query.forVim=!1;let t=Qu.of(this.cm6Query);this.cm6.dispatch({effects:t})}getSearchCursor(e,t){var s=this,a=null,r=null,o=!1;t.ch==null&&(t.ch=Number.MAX_VALUE);var i=Eo(s.cm6.state.doc,t),l=e.source.replace(/(\\.|{(?:\d+(?:,\d*)?|,\d+)})|[{}]/g,function(f,v){return v||"\\"+f});function c(f,v=0,O=f.length){return new A5(f,l,{ignoreCase:e.ignoreCase},v,O)}function u(f){var v=s.cm6.state.doc;if(f>v.length)return null;let O=c(v,f).next();return O.done?null:O.value}var h=1e4;function m(f,v){var O=s.cm6.state.doc;for(let k=1;;k++){let M=Math.max(f,v-k*h),E=c(O,M,v),I=null;for(;!E.next().done;)I=E.value;if(I&&(M==f||I.from>M+10))return I;if(M==f)return null}}return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(f){var v=s.cm6.state.doc;if(f){let O=a?o?a.to-1:a.from:i;a=m(0,O)}else{let O=a?o?a.to+1:a.to:i;a=u(O)}return r=a&&{from:Ko(v,a.from),to:Ko(v,a.to),match:a.match},o=a?a.from==a.to:!1,a&&a.match},from:function(){return r==null?void 0:r.from},to:function(){return r==null?void 0:r.to},replace:function(f){a&&(cf(s,{changes:{from:a.from,to:a.to,insert:f}}),a.to=a.from+f.length,r&&(r.to=Ko(s.cm6.state.doc,a.to)))},get match(){return r&&r.match}}}findPosV(e,t,s,a){let{cm6:r}=this;const o=r.state.doc;let i=s=="page"?r.dom.clientHeight:0;const l=Eo(o,e);let c=Ze.cursor(l,1,void 0,a),u=Math.round(Math.abs(t));for(let m=0;m<u;m++)s=="page"?c=r.moveVertically(c,t>0,i):s=="line"&&(c=r.moveVertically(c,t>0));let h=Ko(o,c.head);return(t<0&&c.head==0&&a!=0&&e.line==0&&e.ch!=0||t>0&&c.head==o.length&&h.ch!=a&&e.line==h.line)&&(h.hitSide=!0),h}charCoords(e,t){var s=this.cm6.contentDOM.getBoundingClientRect(),a=Eo(this.cm6.state.doc,e),r=this.cm6.coordsAtPos(a),o=-s.top;return{left:((r==null?void 0:r.left)||0)-s.left,top:((r==null?void 0:r.top)||0)+o,bottom:((r==null?void 0:r.bottom)||0)+o}}coordsChar(e,t){var s=this.cm6.contentDOM.getBoundingClientRect(),a=this.cm6.posAtCoords({x:e.left+s.left,y:e.top+s.top})||0;return Ko(this.cm6.state.doc,a)}getScrollInfo(){var e=this.cm6.scrollDOM;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight,width:e.scrollWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}scrollTo(e,t){e!=null&&(this.cm6.scrollDOM.scrollLeft=e),t!=null&&(this.cm6.scrollDOM.scrollTop=t)}scrollIntoView(e,t){if(e){var s=this.indexFromPos(e);this.cm6.dispatch({effects:vt.scrollIntoView(s)})}else this.cm6.dispatch({scrollIntoView:!0,userEvent:"scroll"})}getWrapperElement(){return this.cm6.dom}getMode(){return{name:this.getOption("mode")}}setSize(e,t){this.cm6.dom.style.width=e+4+"px",this.cm6.dom.style.height=t+"px",this.refresh()}refresh(){this.cm6.measure()}destroy(){this.removeOverlay()}getLastEditEnd(){return this.posFromIndex(this.$lastChangeEndOffset)}onChange(e){this.$lineHandleChanges&&this.$lineHandleChanges.push(e);for(let s in this.marks)this.marks[s].update(e.changes);this.virtualSelection&&(this.virtualSelection.ranges=this.virtualSelection.ranges.map(s=>s.map(e.changes)));var t=this.curOp=this.curOp||{};e.changes.iterChanges((s,a,r,o,i)=>{(t.$changeStart==null||t.$changeStart>r)&&(t.$changeStart=r),this.$lastChangeEndOffset=o;var l={text:i.toJSON()};t.lastChange?t.lastChange.next=t.lastChange=l:t.lastChange=t.change=l},!0),t.changeHandlers||(t.changeHandlers=this._handlers.change&&this._handlers.change.slice())}onSelectionChange(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._handlers.cursorActivity&&this._handlers.cursorActivity.slice()),this.curOp.cursorActivity=!0}operation(e,t){this.curOp||(this.curOp={$d:0}),this.curOp.$d++;try{var s=e()}finally{this.curOp&&(this.curOp.$d--,this.curOp.$d||this.onBeforeEndOperation())}return s}onBeforeEndOperation(){var e=this.curOp,t=!1;e&&(e.change&&VF(e.changeHandlers,this,e.change),e&&e.cursorActivity&&(VF(e.cursorActivityHandlers,this,null),e.isVimOp&&(t=!0)),this.curOp=null),t&&this.scrollIntoView()}moveH(e,t){if(t=="char"){var s=this.getCursor();this.setCursor(s.line,s.ch+e)}}setOption(e,t){switch(e){case"keyMap":this.state.keyMap=t;break;case"textwidth":this.state.textwidth=t;break}}getOption(e){switch(e){case"firstLineNumber":return 1;case"tabSize":return this.cm6.state.tabSize||4;case"readOnly":return this.cm6.state.readOnly;case"indentWithTabs":return this.cm6.state.facet(Sm)=="	";case"indentUnit":return this.cm6.state.facet(Sm).length||2;case"textwidth":return this.state.textwidth;case"keyMap":return this.state.keyMap||"vim"}}toggleOverwrite(e){this.state.overwrite=e}getTokenTypeAt(e){var t,s=this.indexFromPos(e),a=pU(this.cm6.state,s),r=a==null?void 0:a.resolve(s),o=((t=r==null?void 0:r.type)===null||t===void 0?void 0:t.name)||"";return/comment/i.test(o)?"comment":/string/i.test(o)?"string":""}overWriteSelection(e){var t=this.cm6.state.doc,s=this.cm6.state.selection,a=s.ranges.map(r=>{if(r.empty){var o=r.to<t.length?t.sliceString(r.from,r.to+1):"";if(o&&!/\n/.test(o))return Ze.range(r.from,r.to+1)}return r});this.cm6.dispatch({selection:Ze.create(a,s.mainIndex)}),this.replaceSelection(e)}isInMultiSelectMode(){return this.cm6.state.selection.ranges.length>1}virtualSelectionMode(){return!!this.virtualSelection}forEachSelection(e){var t=this.cm6.state.selection;this.virtualSelection=Ze.create(t.ranges,t.mainIndex);for(var s=0;s<this.virtualSelection.ranges.length;s++){var a=this.virtualSelection.ranges[s];a&&(this.cm6.dispatch({selection:Ze.create([a])}),e(),this.virtualSelection.ranges[s]=this.cm6.state.selection.ranges[0])}this.cm6.dispatch({selection:this.virtualSelection}),this.virtualSelection=null}hardWrap(e){return uTe(this,e)}}Bn.isMac=typeof navigator<"u"&&/Mac/.test(navigator.platform);Bn.Pos=xl;Bn.StringStream=CMe;Bn.commands={cursorCharLeft:function(n){Og(n.cm6)},redo:function(n){jF(n,!1)},undo:function(n){jF(n,!0)},newlineAndIndent:function(n){xg({state:n.cm6.state,dispatch:e=>cf(n,e)})},indentAuto:function(n){$H(n.cm6)},newlineAndIndentContinueComment:void 0,save:void 0};Bn.isWordChar=function(n){return wC.test(n)};Bn.keys=tTe;Bn.addClass=function(n,e){};Bn.rmClass=function(n,e){};Bn.e_preventDefault=function(n){n.preventDefault()};Bn.e_stop=function(n){var e,t;(e=n==null?void 0:n.stopPropagation)===null||e===void 0||e.call(n),(t=n==null?void 0:n.preventDefault)===null||t===void 0||t.call(n)};Bn.lookupKey=function(n,e,t){var s=Bn.keys[n];!s&&/^Arrow/.test(n)&&(s=Bn.keys[n.slice(5)]),s&&t(s)};Bn.on=OK;Bn.off=xK;Bn.signal=kK;Bn.findMatchingTag=iTe;Bn.findEnclosingTag=lTe;Bn.keyName=void 0;function PK(n,e,t){var s=document.createElement("div");return s.appendChild(e),s}function SK(n,e){n.state.currentNotificationClose&&n.state.currentNotificationClose(),n.state.currentNotificationClose=e}function nTe(n,e,t){SK(n,i);var s=PK(n,e,t&&t.bottom),a=!1,r,o=t&&typeof t.duration<"u"?t.duration:5e3;function i(){a||(a=!0,clearTimeout(r),s.remove(),MK(n,s))}return s.onclick=function(l){l.preventDefault(),i()},CK(n,s),o&&(r=setTimeout(i,o)),i}function CK(n,e){var t=n.state.dialog;n.state.dialog=e,e.style.flex="1",e&&t!==e&&(t&&t.contains(document.activeElement)&&n.focus(),t&&t.parentElement?t.parentElement.replaceChild(e,t):t&&t.remove(),Bn.signal(n,"dialog"))}function MK(n,e){n.state.dialog==e&&(n.state.dialog=null,Bn.signal(n,"dialog"))}function sTe(n,e,t,s){s||(s={}),SK(n,void 0);var a=PK(n,e,s.bottom),r=!1;CK(n,a);function o(l){if(typeof l=="string")i.value=l;else{if(r)return;r=!0,MK(n,a),n.state.dialog||n.focus(),s.onClose&&s.onClose(a)}}var i=a.getElementsByTagName("input")[0];return i&&(s.value&&(i.value=s.value,s.selectValueOnOpen!==!1&&i.select()),s.onInput&&Bn.on(i,"input",function(l){s.onInput(l,i.value,o)}),s.onKeyUp&&Bn.on(i,"keyup",function(l){s.onKeyUp(l,i.value,o)}),Bn.on(i,"keydown",function(l){s&&s.onKeyDown&&s.onKeyDown(l,i.value,o)||(l.keyCode==13&&t&&t(i.value),(l.keyCode==27||s.closeOnEnter!==!1&&l.keyCode==13)&&(i.blur(),Bn.e_stop(l),o()))}),s.closeOnBlur!==!1&&Bn.on(i,"blur",function(){setTimeout(function(){document.activeElement!==i&&o()})}),i.focus()),o}var aTe={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function rTe(n){return n&&n.bracketRegex||/[(){}[\]]/}function oTe(n,e,t,s,a){for(var r=a&&a.maxScanLineLength||1e4,o=a&&a.maxScanLines||1e3,i=[],l=rTe(a),c=t>0?Math.min(e.line+o,n.lastLine()+1):Math.max(n.firstLine()-1,e.line-o),u=e.line;u!=c;u+=t){var h=n.getLine(u);if(h){var m=t>0?0:h.length-1,f=t>0?h.length:-1;if(!(h.length>r))for(u==e.line&&(m=e.ch-(t<0?1:0));m!=f;m+=t){var v=h.charAt(m);if(l.test(v)){var O=aTe[v];if(O&&O.charAt(1)==">"==t>0)i.push(v);else if(i.length)i.pop();else return{pos:new xl(u,m),ch:v}}}}}return u-t==(t>0?n.lastLine():n.firstLine())?!1:null}function iTe(n,e){return null}function lTe(n,e){var t,s,a=n.cm6.state,r=n.indexFromPos(e);if(r<a.doc.length){var o=a.sliceDoc(r,r+1);o=="<"&&r++}for(var i=pU(a,r),l=(i==null?void 0:i.resolve(r))||null;l;){if(((t=l.firstChild)===null||t===void 0?void 0:t.type.name)=="OpenTag"&&((s=l.lastChild)===null||s===void 0?void 0:s.type.name)=="CloseTag")return{open:ZF(a.doc,l.firstChild),close:ZF(a.doc,l.lastChild)};l=l.parent}}function ZF(n,e){return{from:Ko(n,e.from),to:Ko(n,e.to)}}class cTe{constructor(e,t,s){this.cm=e,this.id=e.$mid++,this.offset=t,this.assoc=s,e.marks[this.id]=this}clear(){delete this.cm.marks[this.id]}find(){return this.offset==null?null:this.cm.posFromIndex(this.offset)}update(e){this.offset!=null&&(this.offset=e.mapPos(this.offset,this.assoc,ga.TrackDel))}}function uTe(n,e){for(var t,s=e.column||n.getOption("textwidth")||80,a=e.allowMerge!=!1,r=Math.min(e.from,e.to),o=Math.max(e.from,e.to);r<=o;){var i=n.getLine(r);if(i.length>s){var l=v(i,s,5);if(l){var c=(t=/^\s*/.exec(i))===null||t===void 0?void 0:t[0];n.replaceRange(`
`+c,new xl(r,l.start),new xl(r,l.end))}o++}else if(a&&/\S/.test(i)&&r!=o){var u=n.getLine(r+1);if(u&&/\S/.test(u)){var h=i.replace(/\s+$/,""),m=u.replace(/^\s+/,""),f=h+" "+m,l=v(f,s,5);l&&l.start>h.length||f.length<s?(n.replaceRange(" ",new xl(r,h.length),new xl(r+1,u.length-m.length)),r--,o--):h.length<i.length&&n.replaceRange("",new xl(r,h.length),new xl(r,i.length))}}r++}return r;function v(O,k,M){if(!(O.length<k)){var E=O.slice(0,k),I=O.slice(k),D=/^(?:(\s+)|(\S+)(\s+))/.exec(I),F=/(?:(\s+)|(\s+)(\S+))$/.exec(E),_=0,$=0;if(F&&!F[2]&&(_=k-F[1].length,$=k),D&&!D[2]&&(_||(_=k),$=k+D[1].length),_)return{start:_,end:$};if(F&&F[2]&&F.index>M)return{start:F.index,end:F.index+F[2].length};if(D&&D[2])return _=k+D[2].length,{start:_,end:_+D[3].length}}}}let OC=Hq;class hTe{constructor(e,t,s,a,r,o,i,l,c,u){this.left=e,this.top=t,this.height=s,this.fontFamily=a,this.fontSize=r,this.fontWeight=o,this.color=i,this.className=l,this.letter=c,this.partial=u}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.height=this.height+"px",e.style.lineHeight=this.height+"px",e.style.fontFamily=this.fontFamily,e.style.fontSize=this.fontSize,e.style.fontWeight=this.fontWeight,e.style.color=this.partial?"transparent":this.color,e.className=this.className,e.textContent=this.letter}eq(e){return this.left==e.left&&this.top==e.top&&this.height==e.height&&this.fontFamily==e.fontFamily&&this.fontSize==e.fontSize&&this.fontWeight==e.fontWeight&&this.color==e.color&&this.className==e.className&&this.letter==e.letter}}class dTe{constructor(e,t){this.view=e,this.rangePieces=[],this.cursors=[],this.cm=t,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let e=OC(this.cm.cm6.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=e+"ms"}update(e){(e.selectionSet||e.geometryChanged||e.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),mTe(e)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:e}=this.view,t=[];for(let s of e.selection.ranges){let a=s==e.selection.main,r=bTe(this.cm,this.view,s,a);r&&t.push(r)}return{cursors:t}}drawSel({cursors:e}){if(e.length!=this.cursors.length||e.some((t,s)=>!t.eq(this.cursors[s]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const s of e)this.cursorLayer.appendChild(s.draw())}else e.forEach((s,a)=>s.adjust(t[a]));this.cursors=e}}destroy(){this.cursorLayer.remove()}}function mTe(n){return OC(n.startState)!=OC(n.state)}const pTe={".cm-vimMode .cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}},fTe=yo.highest(vt.theme(pTe));function gTe(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Ds.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function bTe(n,e,t,s){var a,r,o,i;let l=t.head,c=!1,u=1,h=n.state.vim;if(h&&(!h.insertMode||n.state.overwrite)){if(c=!0,h.visualBlock&&!s)return null;t.anchor<t.head&&(l<e.state.doc.length&&e.state.sliceDoc(l,l+1))!=`
`&&l--,n.state.overwrite?u=.2:h.status&&(u=.5)}if(c){let f=l<e.state.doc.length&&e.state.sliceDoc(l,l+1);f&&/[\uDC00-\uDFFF]/.test(f)&&l>1&&(l--,f=e.state.sliceDoc(l,l+1));let v=e.coordsAtPos(l,1);if(!v)return null;let O=gTe(e),k=e.domAtPos(l),M=k?k.node:e.contentDOM;for(M instanceof Text&&k.offset>=M.data.length&&!((a=M.parentElement)===null||a===void 0)&&a.nextSibling&&(M=(r=M.parentElement)===null||r===void 0?void 0:r.nextSibling,k={node:M,offset:0});k&&k.node instanceof HTMLElement;)M=k.node,k={node:k.node.childNodes[k.offset],offset:0};if(!(M instanceof HTMLElement)){if(!M.parentNode)return null;M=M.parentNode}let E=getComputedStyle(M),I=v.left,D=(i=(o=e).coordsForChar)===null||i===void 0?void 0:i.call(o,l);if(D&&(I=D.left),!f||f==`
`||f=="\r")f=" ";else if(f=="	"){f=" ";var m=e.coordsAtPos(l+1,-1);m&&(I=m.left-(m.left-v.left)/parseInt(E.tabSize))}else/[\uD800-\uDBFF]/.test(f)&&l<e.state.doc.length-1&&(f+=e.state.sliceDoc(l+1,l+2));let F=v.bottom-v.top;return new hTe((I-O.left)/e.scaleX,(v.top-O.top+F*(1-u))/e.scaleY,F*u/e.scaleY,E.fontFamily,E.fontSize,E.fontWeight,E.color,s?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",f,u!=1)}else return null}var yTe=typeof navigator<"u"&&/linux/i.test(navigator.platform)&&/ Gecko\/\d+/.exec(navigator.userAgent);const th=eTe(Bn),vTe=250,wTe=vt.baseTheme({".cm-vimMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"0px 10px",fontFamily:"monospace",minHeight:"1.3em",display:"flex"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"inherit"},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"}}),OTe=ra.fromClass(class{constructor(n){this.status="",this.query=null,this.decorations=en.none,this.waitForCopy=!1,this.lastKeydown="",this.useNextTextInput=!1,this.compositionText="",this.view=n;const e=this.cm=new Bn(n);th.enterVimMode(this.cm),this.view.cm=this.cm,this.cm.state.vimPlugin=this,this.blockCursor=new dTe(n,e),this.updateClass(),this.cm.on("vim-command-done",()=>{e.state.vim&&(e.state.vim.status=""),this.blockCursor.scheduleRedraw(),this.updateStatus()}),this.cm.on("vim-mode-change",t=>{e.state.vim&&(e.state.vim.mode=t.mode,t.subMode&&(e.state.vim.mode+=" block"),e.state.vim.status="",this.blockCursor.scheduleRedraw(),this.updateClass(),this.updateStatus())}),this.cm.on("dialog",()=>{this.cm.state.statusbar?this.updateStatus():n.dispatch({effects:AK.of(!!this.cm.state.dialog)})}),this.dom=document.createElement("span"),this.spacer=document.createElement("span"),this.spacer.style.flex="1",this.statusButton=document.createElement("span"),this.statusButton.onclick=t=>{th.handleKey(this.cm,"<Esc>","user"),this.cm.focus()},this.statusButton.style.cssText="cursor: pointer"}update(n){var e;if((n.viewportChanged||n.docChanged)&&this.query&&this.highlight(this.query),n.docChanged&&this.cm.onChange(n),n.selectionSet&&this.cm.onSelectionChange(),n.viewportChanged,this.cm.curOp&&!this.cm.curOp.isVimOp&&this.cm.onBeforeEndOperation(),n.transactions){for(let t of n.transactions)for(let s of t.effects)if(s.is(Qu))if(!(!((e=s.value)===null||e===void 0)&&e.forVim))this.highlight(null);else{let a=s.value.create();this.highlight(a)}}this.blockCursor.update(n)}updateClass(){const n=this.cm.state;!n.vim||n.vim.insertMode&&!n.overwrite?this.view.scrollDOM.classList.remove("cm-vimMode"):this.view.scrollDOM.classList.add("cm-vimMode")}updateStatus(){let n=this.cm.state.statusbar,e=this.cm.state.vim;if(!n||!e)return;let t=this.cm.state.dialog;if(t)t.parentElement!=n&&(n.textContent="",n.appendChild(t));else{n.textContent="";var s=(e.mode||"normal").toUpperCase();e.insertModeReturn&&(s+="(C-O)"),this.statusButton.textContent=`--${s}--`,n.appendChild(this.statusButton),n.appendChild(this.spacer)}this.dom.textContent=e.status,n.appendChild(this.dom)}destroy(){th.leaveVimMode(this.cm),this.updateClass(),this.blockCursor.destroy(),delete this.view.cm}highlight(n){if(this.query=n,!n)return this.decorations=en.none;let{view:e}=this,t=new Gl;for(let s=0,a=e.visibleRanges,r=a.length;s<r;s++){let{from:o,to:i}=a[s];for(;s<r-1&&i>a[s+1].from-2*vTe;)i=a[++s].to;n.highlight(e.state,o,i,(l,c)=>{t.add(l,c,kTe)})}return this.decorations=t.finish()}handleKey(n,e){const t=this.cm;let s=t.state.vim;if(!s)return;const a=th.vimKeyFromEvent(n,s);if(Bn.signal(this.cm,"inputEvent",{type:"handleKey",key:a}),!a)return;if(a=="<Esc>"&&!s.insertMode&&!s.visualMode&&this.query){const o=s.searchState_;o&&(t.removeOverlay(o.getOverlay()),o.setOverlay(null))}if(a==="<C-c>"&&!Bn.isMac&&t.somethingSelected())return this.waitForCopy=!0,!0;s.status=(s.status||"")+a;let r=th.multiSelectHandleKey(t,a,"user");return s=th.maybeInitVimState_(t),!r&&s.insertMode&&t.state.overwrite&&(n.key&&n.key.length==1&&!/\n/.test(n.key)?(r=!0,t.overWriteSelection(n.key)):n.key=="Backspace"&&(r=!0,Bn.commands.cursorCharLeft(t))),r&&(Bn.signal(this.cm,"vim-keypress",a),n.preventDefault(),n.stopPropagation(),this.blockCursor.scheduleRedraw()),this.updateStatus(),!!r}},{eventHandlers:{copy:function(n,e){this.waitForCopy&&(this.waitForCopy=!1,Promise.resolve().then(()=>{var t=this.cm,s=t.state.vim;s&&(s.insertMode?t.setSelection(t.getCursor(),t.getCursor()):t.operation(()=>{t.curOp&&(t.curOp.isVimOp=!0),th.handleKey(t,"<Esc>","user")}))}))},compositionstart:function(n,e){this.useNextTextInput=!0,Bn.signal(this.cm,"inputEvent",n)},compositionupdate:function(n,e){Bn.signal(this.cm,"inputEvent",n)},compositionend:function(n,e){Bn.signal(this.cm,"inputEvent",n)},keypress:function(n,e){Bn.signal(this.cm,"inputEvent",n),this.lastKeydown=="Dead"&&this.handleKey(n,e)},keydown:function(n,e){Bn.signal(this.cm,"inputEvent",n),this.lastKeydown=n.key,this.lastKeydown=="Unidentified"||this.lastKeydown=="Process"||this.lastKeydown=="Dead"?this.useNextTextInput=!0:(this.useNextTextInput=!1,this.handleKey(n,e))}},provide:()=>[vt.inputHandler.of((n,e,t,s)=>{var a,r,o=ATe(n);if(!o)return!1;var i=(a=o.state)===null||a===void 0?void 0:a.vim,l=o.state.vimPlugin;if(i&&!i.insertMode&&!(!((r=o.curOp)===null||r===void 0)&&r.isVimOp)){if(s==="\0\0")return!0;if(Bn.signal(o,"inputEvent",{type:"text",text:s,from:e,to:t}),s.length==1&&l.useNextTextInput){if(i.expectLiteralNext&&n.composing)return l.compositionText=s,!1;if(l.compositionText){var c=l.compositionText;l.compositionText="";var u=n.state.selection.main.head,h=n.state.sliceDoc(u-c.length,u);if(c===h){var m=o.getCursor();o.replaceRange("",o.posFromIndex(u-c.length),m)}}return l.handleKey({key:s,preventDefault:()=>{},stopPropagation:()=>{}}),xTe(n),!0}}return!1})],decorations:n=>n.decorations});function xTe(n){var e=n.scrollDOM.parentElement;if(e){if(yTe){n.contentDOM.textContent="\0\0",n.contentDOM.dispatchEvent(new CustomEvent("compositionend"));return}var t=n.scrollDOM.nextSibling,s=window.getSelection(),a=s&&{anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset};n.scrollDOM.remove(),e.insertBefore(n.scrollDOM,t);try{a&&s&&(s.setPosition(a.anchorNode,a.anchorOffset),a.focusNode&&s.extend(a.focusNode,a.focusOffset))}catch(r){console.error(r)}n.focus(),n.contentDOM.dispatchEvent(new CustomEvent("compositionend"))}}const kTe=en.mark({class:"cm-searchMatch"}),AK=hn.define(),PTe=Js.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(AK)&&(n=t.value);return n},provide:n=>$u.from(n,e=>e?STe:null)});function STe(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.dialog&&e.appendChild(t.state.dialog),{top:!1,dom:e}}function CTe(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.statusbar=e,t.state.vimPlugin.updateStatus(),{dom:e}}function MTe(n={}){return[wTe,OTe,fTe,n.status?$u.of(CTe):PTe]}function ATe(n){return n.cm||null}class zF{constructor(e,t,s){this.from=e,this.to=t,this.diagnostic=s}}class hh{constructor(e,t,s){this.diagnostics=e,this.panel=t,this.selected=s}static init(e,t,s){let a=e,r=s.facet(Cg).markerFilter;r&&(a=r(a,s));let o=e.slice().sort((h,m)=>h.from-m.from||h.to-m.to),i=new Gl,l=[],c=0;for(let h=0;;){let m=h==o.length?null:o[h];if(!m&&!l.length)break;let f,v;for(l.length?(f=c,v=l.reduce((k,M)=>Math.min(k,M.to),m&&m.from>f?m.from:1e8)):(f=m.from,v=m.to,l.push(m),h++);h<o.length;){let k=o[h];if(k.from==f&&(k.to>k.from||k.to==f))l.push(k),h++,v=Math.min(k.to,v);else{v=Math.min(k.from,v);break}}let O=QTe(l);if(l.some(k=>k.from==k.to||k.from==k.to-1&&s.doc.lineAt(k.from).to==k.from))i.add(f,f,en.widget({widget:new RTe(O),diagnostics:l.slice()}));else{let k=l.reduce((M,E)=>E.markClass?M+" "+E.markClass:M,"");i.add(f,v,en.mark({class:"cm-lintRange cm-lintRange-"+O+k,diagnostics:l.slice(),inclusiveEnd:l.some(M=>M.to>v)}))}c=v;for(let k=0;k<l.length;k++)l[k].to<=c&&l.splice(k--,1)}let u=i.finish();return new hh(u,t,Em(u))}}function Em(n,e=null,t=0){let s=null;return n.between(t,1e9,(a,r,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!s)s=new zF(a,r,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(s.diagnostic)<0)return!1;s=new zF(s.from,r,s.diagnostic)}}),s}function ETe(n,e){let t=e.pos,s=e.end||t,a=n.state.facet(Cg).hideOn(n,t,s);if(a!=null)return a;let r=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(o=>o.is(EK))||n.changes.touchesRange(r.from,Math.max(r.to,s)))}function DTe(n,e){return n.field(Lo,!1)?e:e.concat(hn.appendConfig.of(VTe))}const EK=hn.define(),N5=hn.define(),DK=hn.define(),Lo=Js.define({create(){return new hh(en.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),s=null,a=n.panel;if(n.selected){let r=e.changes.mapPos(n.selected.from,1);s=Em(t,n.selected.diagnostic,r)||Em(t,null,r)}!t.size&&a&&e.state.facet(Cg).autoPanel&&(a=null),n=new hh(t,a,s)}for(let t of e.effects)if(t.is(EK)){let s=e.state.facet(Cg).autoPanel?t.value.length?Mg.open:null:n.panel;n=hh.init(t.value,s,e.state)}else t.is(N5)?n=new hh(n.diagnostics,t.value?Mg.open:null,n.selected):t.is(DK)&&(n=new hh(n.diagnostics,n.panel,t.value));return n},provide:n=>[$u.from(n,e=>e.panel),vt.decorations.from(n,e=>e.diagnostics)]}),TTe=en.mark({class:"cm-lintRange cm-lintRange-active"});function FTe(n,e,t){let{diagnostics:s}=n.state.field(Lo),a,r=-1,o=-1;s.between(e-(t<0?1:0),e+(t>0?1:0),(l,c,{spec:u})=>{if(e>=l&&e<=c&&(l==c||(e>l||t>0)&&(e<c||t<0)))return a=u.diagnostics,r=l,o=c,!1});let i=n.state.facet(Cg).tooltipFilter;return a&&i&&(a=i(a,n.state)),a?{pos:r,end:o,above:n.state.doc.lineAt(r).to<o,create(){return{dom:NTe(n,a)}}}:null}function NTe(n,e){return $s("ul",{class:"cm-tooltip-lint"},e.map(t=>FK(n,t,!1)))}const BTe=n=>{let e=n.state.field(Lo,!1);(!e||!e.panel)&&n.dispatch({effects:DTe(n.state,[N5.of(!0)])});let t=gg(n,Mg.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},GF=n=>{let e=n.state.field(Lo,!1);return!e||!e.panel?!1:(n.dispatch({effects:N5.of(!1)}),!0)},$Te=n=>{let e=n.state.field(Lo,!1);if(!e)return!1;let t=n.state.selection.main,s=e.diagnostics.iter(t.to+1);return!s.value&&(s=e.diagnostics.iter(0),!s.value||s.from==t.from&&s.to==t.to)?!1:(n.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0}),!0)},Cg=Qt.define({combine(n){return Object.assign({sources:n.map(e=>e.source).filter(e=>e!=null)},Gc(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?s=>e(s)||t(s):e:t}))}});function TK(n){let e=[];if(n)e:for(let{name:t}of n){for(let s=0;s<t.length;s++){let a=t[s];if(/[a-zA-Z]/.test(a)&&!e.some(r=>r.toLowerCase()==a.toLowerCase())){e.push(a);continue e}}e.push("")}return e}function FK(n,e,t){var s;let a=t?TK(e.actions):[];return $s("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},$s("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(s=e.actions)===null||s===void 0?void 0:s.map((r,o)=>{let i=!1,l=m=>{if(m.preventDefault(),i)return;i=!0;let f=Em(n.state.field(Lo).diagnostics,e);f&&r.apply(n,f.from,f.to)},{name:c}=r,u=a[o]?c.indexOf(a[o]):-1,h=u<0?c:[c.slice(0,u),$s("u",c.slice(u,u+1)),c.slice(u+1)];return $s("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${c}${u<0?"":` (access key "${a[o]})"`}.`},h)}),e.source&&$s("div",{class:"cm-diagnosticSource"},e.source))}class RTe extends cl{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return $s("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class XF{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=FK(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Mg{constructor(e){this.view=e,this.items=[];let t=a=>{if(a.keyCode==27)GF(this.view),this.view.focus();else if(a.keyCode==38||a.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(a.keyCode==40||a.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(a.keyCode==36)this.moveSelection(0);else if(a.keyCode==35)this.moveSelection(this.items.length-1);else if(a.keyCode==13)this.view.focus();else if(a.keyCode>=65&&a.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:r}=this.items[this.selectedIndex],o=TK(r.actions);for(let i=0;i<o.length;i++)if(o[i].toUpperCase().charCodeAt(0)==a.keyCode){let l=Em(this.view.state.field(Lo).diagnostics,r);l&&r.actions[i].apply(e,l.from,l.to)}}else return;a.preventDefault()},s=a=>{for(let r=0;r<this.items.length;r++)this.items[r].dom.contains(a.target)&&this.moveSelection(r)};this.list=$s("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:s}),this.dom=$s("div",{class:"cm-panel-lint"},this.list,$s("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>GF(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Lo).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Lo),s=0,a=!1,r=null,o=new Set;for(e.between(0,this.view.state.doc.length,(i,l,{spec:c})=>{for(let u of c.diagnostics){if(o.has(u))continue;o.add(u);let h=-1,m;for(let f=s;f<this.items.length;f++)if(this.items[f].diagnostic==u){h=f;break}h<0?(m=new XF(this.view,u),this.items.splice(s,0,m),a=!0):(m=this.items[h],h>s&&(this.items.splice(s,h-s),a=!0)),t&&m.diagnostic==t.diagnostic?m.dom.hasAttribute("aria-selected")||(m.dom.setAttribute("aria-selected","true"),r=m):m.dom.hasAttribute("aria-selected")&&m.dom.removeAttribute("aria-selected"),s++}});s<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)a=!0,this.items.pop();this.items.length==0&&(this.items.push(new XF(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),a=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:i,panel:l})=>{let c=l.height/this.list.offsetHeight;i.top<l.top?this.list.scrollTop-=(l.top-i.top)/c:i.bottom>l.bottom&&(this.list.scrollTop+=(i.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),a&&this.sync()}sync(){let e=this.list.firstChild;function t(){let s=e;e=s.nextSibling,s.remove()}for(let s of this.items)if(s.dom.parentNode==this.list){for(;e!=s.dom;)t();e=s.dom.nextSibling}else this.list.insertBefore(s.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Lo),s=Em(t.diagnostics,this.items[e].diagnostic);s&&this.view.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:DK.of(s)})}static open(e){return new Mg(e)}}function _Te(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function yb(n){return _Te(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const LTe=vt.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:yb("#d11")},".cm-lintRange-warning":{backgroundImage:yb("orange")},".cm-lintRange-info":{backgroundImage:yb("#999")},".cm-lintRange-hint":{backgroundImage:yb("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function ITe(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function QTe(n){let e="hint",t=1;for(let s of n){let a=ITe(s.severity);a>t&&(t=a,e=s.severity)}return e}const VTe=[Lo,vt.decorations.compute([Lo],n=>{let{selected:e,panel:t}=n.field(Lo);return!e||!t||e.from==e.to?en.none:en.set([TTe.range(e.from,e.to)])}),tU(FTe,{hideOn:ETe}),LTe],NK=n=>e=>{const t=n==="down";let s=e.state.selection;for(const a of s.ranges)s=s.addRange(e.moveVertically(a,t));return e.dispatch({selection:s}),!0},jTe=NK("up"),ZTe=NK("down"),zTe=n=>{let e=null;for(const t of n.state.selection.ranges)if(!t.empty)for(let s=t.from;s<=t.to;){const a=n.state.doc.lineAt(s),r=Math.min(a.to,t.to);e?e=e.addRange(Ze.range(r,r)):e=Ze.single(r),s=a.to+1}return e?(n.dispatch({selection:e}),!0):!1},GTe=[{key:"Ctrl-Space",run:JS},{key:"Escape",run:QU},{key:"ArrowDown",run:mu(!0)},{key:"ArrowUp",run:mu(!1)},{key:"PageDown",run:mu(!0,"page")},{key:"PageUp",run:mu(!1,"page")},{key:"Enter",run:KS},{key:"Tab",run:KS},{key:"Mod-f",run:vK,scope:"editor search-panel"},{key:"Escape",run:wK,scope:"editor search-panel"},{key:"Alt-Enter",run:fK,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:gK,scope:"editor search-panel"},{key:"Ctrl-g",run:k4e},{key:"Mod-d",run:M4e,preventDefault:!0},{key:"Shift-Mod-l",run:$4e},{key:"Enter",run:xg,shift:xg},{key:"ArrowLeft",run:Og,shift:sv,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:rH,shift:fH},{key:"ArrowRight",run:Ky,shift:av,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:oH,shift:gH},{key:"ArrowUp",run:Jy,shift:rv,preventDefault:!0},{key:"ArrowDown",run:ev,shift:ov,preventDefault:!0},{key:"Home",run:nv,shift:nC},{mac:"Cmd-ArrowLeft",run:nv,shift:nC},{key:"Mod-Home",run:cv,shift:hv},{mac:"Cmd-ArrowUp",run:cv,shift:hv},{key:"PageUp",run:Df,shift:iv},{mac:"Ctrl-ArrowUp",run:Df,shift:iv},{key:"PageDown",run:qd,shift:lv},{mac:"Ctrl-ArrowDown",run:qd,shift:lv},{key:"End",run:tv,shift:tC},{mac:"Cmd-ArrowRight",run:tv,shift:tC},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:jTe,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:ZTe,preventDefault:!0},{key:"Shift-Alt-i",run:zTe},{key:"Mod-End",run:uv,shift:dv},{mac:"Cmd-ArrowDown",run:uv,shift:dv},{key:"Mod-a",run:OH},{key:"Backspace",run:XU},{key:"Backspace",run:Ud,shift:Ud},{key:"Delete",run:mv},{key:"Mod-Backspace",mac:"Alt-Backspace",run:pv},{key:"Mod-Delete",mac:"Alt-Delete",run:SH},{mac:"Mod-Backspace",run:YAe},{mac:"Mod-Delete",run:sC},{mac:"Ctrl-b",run:Og,shift:sv,preventDefault:!0},{mac:"Ctrl-f",run:Ky,shift:av},{mac:"Ctrl-p",run:Jy,shift:rv},{mac:"Ctrl-n",run:ev,shift:ov},{mac:"Ctrl-a",run:uH,shift:vH},{mac:"Ctrl-e",run:hH,shift:wH},{mac:"Ctrl-d",run:mv},{mac:"Ctrl-h",run:Ud},{mac:"Ctrl-k",run:sC},{mac:"Ctrl-Alt-h",run:pv},{mac:"Ctrl-o",run:U3},{mac:"Ctrl-t",run:CH},{mac:"Ctrl-v",run:qd},{mac:"Alt-v",run:Df},{key:"Shift-Mod-k",run:NH},{key:"Alt-ArrowDown",run:EH},{key:"Alt-ArrowUp",run:AH},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:FH},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:TH},{key:"Mod-l",run:xH,preventDefault:!0},{key:"Shift-Mod-\\",run:dH},{key:"Tab",run:kg,shift:Pg,preventDefault:!0},{key:"Mod-[",run:Pg},{key:"Mod-]",run:kg},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:CU},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:iMe},{key:"Mod-k Mod-0",run:lMe},{key:"Mod-k Mod-j",run:cMe},{key:"Mod-k Mod-c",run:SAe},{key:"Mod-k Mod-u",run:CAe},{key:"Mod-/",run:Rw},{key:"Shift-Alt-a",run:G3},{key:"Mod-z",run:Lw,preventDefault:!0},{key:"Mod-y",run:Cm,preventDefault:!0},{key:"Mod-Shift-z",run:Cm,preventDefault:!0},{key:"Mod-u",run:eH,preventDefault:!0},{key:"Mod-Shift-m",run:BTe},{key:"F8",run:$Te}],XTe=ra.fromClass(class{constructor(){}},{provide:()=>yo.highest(Xc.of([...GTe]))}),WTe=n=>[XTe].concat(n??[]),qTe={vim:MTe,emacs:Y4e,codemirror:()=>Xc.of(Y3),vscode:WTe};function UTe(n){const e=qTe[n];return[e?yo.high(e()):[]]}const Ln=({theme:n,settings:e,styles:t})=>{const s=vt.theme({"&":{color:e.foreground,backgroundColor:e.background},".cm-gutters":{backgroundColor:e.gutterBackground,color:e.gutterForeground},".cm-content":{caretColor:e.caret},".cm-cursor, .cm-dropCursor":{borderLeftColor:e.caret},".cm-activeLineGutter":{backgroundColor:e.lineHighlight},".cm-activeLine":{backgroundColor:e.lineHighlight},"&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection":{background:e.selection+" !important"},"& .cm-selectionMatch":{backgroundColor:e.selectionMatch}},{dark:n==="dark"}),a=i0.define(t);return[s,_3(a)]},BK={background:"#222",lineBackground:"#22222299",foreground:"#fff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},HTe=Ln({theme:"dark",settings:BK,styles:[{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#89ddff"},{tag:w.labelName,color:"#89ddff"},{tag:w.keyword,color:"#c792ea"},{tag:w.operator,color:"#89ddff"},{tag:w.special(w.variableName),color:"#eeffff"},{tag:w.typeName,color:"#c3e88d"},{tag:w.atom,color:"#f78c6c"},{tag:w.number,color:"#c3e88d"},{tag:w.definition(w.variableName),color:"#82aaff"},{tag:w.string,color:"#c3e88d"},{tag:w.special(w.string),color:"#c3e88d"},{tag:w.comment,color:"#7d8799"},{tag:w.variableName,color:"#c792ea"},{tag:w.tagName,color:"#c3e88d"},{tag:w.bracket,color:"#525154"},{tag:w.meta,color:"#ffcb6b"},{tag:w.attributeName,color:"#c792ea"},{tag:w.propertyName,color:"#c792ea"},{tag:w.className,color:"#decb6b"},{tag:w.invalid,color:"#ffffff"},{tag:[w.unit,w.punctuation],color:"#82aaff"}]}),$K={background:"#051DB5",lineBackground:"#051DB550",foreground:"white",caret:"white",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},YTe=Ln({theme:"dark",settings:$K,styles:[{tag:w.labelName,color:"inherit"},{tag:w.keyword,color:"inherit"},{tag:w.operator,color:"inherit"},{tag:w.special(w.variableName),color:"inherit"},{tag:w.typeName,color:"inherit"},{tag:w.atom,color:"inherit"},{tag:w.number,color:"inherit"},{tag:w.definition(w.variableName),color:"inherit"},{tag:w.string,color:"inherit"},{tag:w.special(w.string),color:"inherit"},{tag:w.comment,color:"inherit"},{tag:w.variableName,color:"inherit"},{tag:w.tagName,color:"inherit"},{tag:w.bracket,color:"inherit"},{tag:w.meta,color:"inherit"},{tag:w.attributeName,color:"inherit"},{tag:w.propertyName,color:"inherit"},{tag:w.className,color:"inherit"},{tag:w.invalid,color:"inherit"},{tag:[w.unit,w.punctuation],color:"inherit"}]}),RK={background:"black",foreground:"white",caret:"white",selection:"#ffffff20",selectionMatch:"#036dd626",lineHighlight:"#ffffff10",lineBackground:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},KTe=Ln({theme:"dark",settings:RK,styles:[{tag:w.labelName,color:"inherit"},{tag:w.keyword,color:"inherit"},{tag:w.operator,color:"inherit"},{tag:w.special(w.variableName),color:"inherit"},{tag:w.typeName,color:"inherit"},{tag:w.atom,color:"inherit"},{tag:w.number,color:"inherit"},{tag:w.definition(w.variableName),color:"inherit"},{tag:w.string,color:"inherit"},{tag:w.special(w.string),color:"inherit"},{tag:w.comment,color:"inherit"},{tag:w.variableName,color:"inherit"},{tag:w.tagName,color:"inherit"},{tag:w.bracket,color:"inherit"},{tag:w.meta,color:"inherit"},{tag:w.attributeName,color:"inherit"},{tag:w.propertyName,color:"inherit"},{tag:w.className,color:"inherit"},{tag:w.invalid,color:"inherit"},{tag:[w.unit,w.punctuation],color:"inherit"}]}),_K={background:"white",foreground:"black",caret:"black",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#ffffff26",lineHighlight:"#cccccc50",lineBackground:"#ffffff50",gutterBackground:"transparent",gutterForeground:"black",light:!0},JTe=Ln({theme:"light",settings:_K,styles:[{tag:w.labelName,color:"inherit"},{tag:w.keyword,color:"inherit"},{tag:w.operator,color:"inherit"},{tag:w.special(w.variableName),color:"inherit"},{tag:w.typeName,color:"inherit"},{tag:w.atom,color:"inherit"},{tag:w.number,color:"inherit"},{tag:w.definition(w.variableName),color:"inherit"},{tag:w.string,color:"inherit"},{tag:w.special(w.string),color:"inherit"},{tag:w.comment,color:"inherit"},{tag:w.variableName,color:"inherit"},{tag:w.tagName,color:"inherit"},{tag:w.bracket,color:"inherit"},{tag:w.meta,color:"inherit"},{tag:w.attributeName,color:"inherit"},{tag:w.propertyName,color:"inherit"},{tag:w.className,color:"inherit"},{tag:w.invalid,color:"inherit"}]});let No="#6edee4",LK="white",IK="red",QK="#f8fc55";const VK={background:"#000000",foreground:No,caret:IK,selection:QK,selectionMatch:No,lineHighlight:"#6edee440",lineBackground:"#00000040",gutterBackground:"transparent",gutterForeground:"#8a919966"};let $k=QK,vb=LK;const eFe=Ln({theme:"dark",settings:VK,styles:[{tag:w.labelName,color:LK},{tag:w.keyword,color:No},{tag:w.operator,color:vb},{tag:w.special(w.variableName),color:No},{tag:w.typeName,color:No},{tag:w.atom,color:No},{tag:w.number,color:vb},{tag:w.definition(w.variableName),color:No},{tag:w.string,color:vb},{tag:w.special(w.string),color:vb},{tag:w.comment,color:$k},{tag:w.variableName,color:No},{tag:w.tagName,color:No},{tag:w.bracket,color:$k},{tag:w.meta,color:No},{tag:w.attributeName,color:No},{tag:w.propertyName,color:No},{tag:w.className,color:No},{tag:w.invalid,color:IK},{tag:[w.unit,w.punctuation],color:$k}]}),tFe={"Sour Watermelon B":["#996666","#6B4747","#3D2929","#0F0A0A"]},rr=tFe["Sour Watermelon B"],jK={background:rr[3],foreground:rr[1],caret:rr[0],selection:rr[0],selectionMatch:rr[1],lineHighlight:rr[3],lineBackground:rr[3]+"90",gutterBackground:"transparent",gutterForeground:rr[0],light:!1},nFe=Ln({theme:"dark",settings:jK,styles:[{tag:w.comment,color:rr[2]},{tag:w.string,color:rr[1]},{tag:[w.atom,w.number],color:rr[1]},{tag:[w.meta,w.labelName,w.variableName],color:rr[0]},{tag:[w.keyword,w.tagName,w.arithmeticOperator],color:rr[1]},{tag:[w.atom,w.bool,w.special(w.variableName)],color:rr[0]},{tag:[w.function(w.variableName),w.propertyName],color:rr[0]},{tag:w.atom,color:rr[1]}]}),xC="#5c019a",sFe="#fbeffc",ZK="#272C35",aFe="#fee1ff",rFe="#465063",oFe="#9acd3f",iFe="#97a1b7",lFe="#f6a6fd",kC={background:"white",lineBackground:"transparent",foreground:xC,caret:"#797977",selection:sFe,selectionMatch:"#2B323D",gutterBackground:ZK,gutterForeground:rFe,gutterBorder:"transparent",lineHighlight:aFe},cFe=Ln({theme:"light",settings:kC,styles:[{tag:[w.function(w.variableName),w.function(w.propertyName),w.url,w.processingInstruction],color:xC},{tag:[w.tagName,w.heading],color:kC.foreground},{tag:w.comment,color:iFe},{tag:[w.variableName,w.propertyName,w.labelName],color:lFe},{tag:[w.attributeName,w.number],color:"#d19a66"},{tag:w.className,color:ZK},{tag:w.keyword,color:xC},{tag:[w.string,w.regexp,w.special(w.propertyName)],color:oFe}]}),Qi=["#1e1e1e","#fbde2d","#ff1493","#4c83ff","#ededed","#cccccc","#ffffff30","#dc2f8c"],zK={background:"#000000",lineBackground:"transparent",foreground:Qi[4],selection:Qi[6],gutterBackground:Qi[0],gutterForeground:Qi[5],gutterBorder:"transparent",lineHighlight:Qi[0]},uFe=Ln({theme:"dark",settings:zK,styles:[{tag:[w.function(w.variableName),w.function(w.propertyName),w.url,w.processingInstruction],color:Qi[4]},{tag:[w.atom,w.bool,w.special(w.variableName)],color:Qi[3]},{tag:w.comment,color:"#54636D"},{tag:[w.variableName,w.propertyName,w.labelName],color:Qi[4]},{tag:[w.attributeName,w.number],color:Qi[3]},{tag:w.keyword,color:Qi[1]},{tag:[w.string,w.regexp,w.special(w.propertyName)],color:Qi[2]}]}),Jr=["#000000","#ff5356","#bd312a","#54636D","#171717"],GK={background:Jr[0],lineBackground:"transparent",foreground:Jr[2],selection:Jr[4],selectionMatch:Jr[0],gutterBackground:Jr[0],gutterForeground:Jr[3],gutterBorder:"transparent",lineHighlight:Jr[0]},hFe=Ln({theme:"dark",settings:GK,styles:[{tag:[w.function(w.variableName),w.function(w.propertyName),w.url,w.processingInstruction],color:Jr[2]},{tag:[w.atom,w.bool,w.special(w.variableName)],color:Jr[1]},{tag:w.comment,color:Jr[3]},{tag:[w.variableName,w.propertyName,w.labelName],color:Jr[2]},{tag:[w.attributeName,w.number],color:Jr[1]},{tag:w.keyword,color:Jr[2]},{tag:[w.string,w.regexp,w.special(w.propertyName)],color:Jr[1]}]}),eo=["#000000","#8ed675","#56bd2a","#54636D","#171717"],XK={background:eo[0],lineBackground:"transparent",foreground:eo[2],selection:eo[4],selectionMatch:eo[0],gutterBackground:eo[0],gutterForeground:eo[3],gutterBorder:"transparent",lineHighlight:eo[0]},dFe=Ln({theme:"dark",settings:XK,styles:[{tag:[w.function(w.variableName),w.function(w.propertyName),w.url,w.processingInstruction],color:eo[2]},{tag:[w.atom,w.bool,w.special(w.variableName)],color:eo[1]},{tag:w.comment,color:eo[3]},{tag:[w.variableName,w.propertyName,w.labelName],color:eo[2]},{tag:[w.attributeName,w.number],color:eo[1]},{tag:w.keyword,color:eo[2]},{tag:[w.string,w.regexp,w.special(w.propertyName)],color:eo[1]}]}),to=["rgb(0, 0, 0)","rgb(82, 208, 250)","rgba(113, 208, 250, .4)","rgba(113, 208, 250, .15)"],WK={background:to[0],lineBackground:"transparent",foreground:to[1],selection:to[2],selectionMatch:to[0],gutterBackground:to[0],gutterForeground:to[2],gutterBorder:"transparent",lineHighlight:to[0]},mFe=Ln({theme:"dark",settings:WK,styles:[{tag:[w.function(w.variableName),w.function(w.propertyName),w.url,w.processingInstruction],color:to[1]},{tag:[w.atom,w.bool,w.special(w.variableName)],color:to[1]},{tag:[w.comment,w.brace,w.bracket],color:to[2]},{tag:[w.variableName,w.propertyName,w.labelName],color:to[1]},{tag:[w.attributeName,w.number],color:to[1]},{tag:w.keyword,color:to[1]},{tag:[w.string,w.regexp,w.special(w.propertyName)],color:to[1]}]}),xr=["rgb(84, 93, 98)","rgb(255, 255, 255)","rgba(255, 255, 255, .25)","rgb(67, 76, 81)","rgb(186, 230, 115)","rgb(252, 184, 67)","rgb(124, 206, 254)","rgb(83, 101, 102)","rgba(46, 62, 72,.5)","rgb(94, 100, 108)","rgb(167, 216, 177)"],qK={background:xr[0],lineBackground:"transparent",foreground:xr[10],selection:xr[8],selectionMatch:xr[0],gutterBackground:xr[3],gutterForeground:xr[2],gutterBorder:"transparent",lineHighlight:xr[3]},pFe=Ln({theme:"dark",settings:qK,styles:[{tag:[w.function(w.variableName),w.function(w.propertyName),w.url,w.processingInstruction],color:xr[1]},{tag:[w.bool,w.special(w.variableName)],color:xr[1]},{tag:[w.comment,w.brace,w.bracket],color:xr[2]},{tag:[w.variableName],color:xr[1]},{tag:[w.labelName,w.propertyName,w.self,w.atom],color:xr[5]},{tag:[w.attributeName,w.number],color:xr[6]},{tag:w.keyword,color:xr[5]},{tag:[w.string,w.regexp,w.special(w.propertyName)],color:xr[4]}]}),no=["rgb(75, 130, 247)","rgb(47, 108, 246)","rgb(255, 255, 255)","rgba(255, 255, 255,.3)"],UK={background:no[0],lineBackground:"transparent",foreground:no[2],selection:no[3],selectionMatch:no[0],gutterBackground:no[0],gutterForeground:no[2],gutterBorder:"transparent",lineHighlight:no[1]},fFe=Ln({theme:"dark",settings:UK,styles:[{tag:[w.function(w.variableName),w.function(w.propertyName),w.url,w.processingInstruction],color:no[2]},{tag:[w.atom,w.bool,w.special(w.variableName)],color:no[2]},{tag:[w.comment,w.bracket,w.brace,w.compareOperator],color:no[3]},{tag:[w.variableName,w.propertyName,w.labelName],color:no[2]},{tag:[w.attributeName,w.number],color:no[2]},{tag:w.keyword,color:no[2]},{tag:[w.string,w.regexp,w.special(w.propertyName)],color:no[2]}]}),gFe={background:"#282b2e",lineBackground:"#282b2e99",foreground:"#a9b7c6",caret:"#00FF00",selection:"#343739",selectionMatch:"#343739",lineHighlight:"#343739"},bFe=Ln({theme:"dark",settings:{background:"#282b2e",foreground:"#a9b7c6",caret:"#00FF00",selection:"#4e5254",selectionMatch:"#4e5254",gutterForeground:"#cccccc50",lineHighlight:"#7f85891f"},styles:[{tag:w.labelName,color:"inherit"},{tag:[w.keyword,w.deleted,w.className],color:"#a9b7c6"},{tag:[w.number,w.literal],color:"#6897bb"},{tag:[w.link,w.variableName],color:"#a9b7c6"},{tag:[w.comment,w.quote],color:"grey"},{tag:[w.meta,w.documentMeta],color:"#bbb529"},{tag:[w.propertyName,w.attributeValue],color:"#a9b7c6"},{tag:[w.string],color:"#6a8759"},{tag:[w.heading,w.typeName],color:"#ffc66d"},{tag:[w.attributeName],color:"#a9b7c6"},{tag:[w.emphasis],fontStyle:"italic"}]}),yFe={background:"#272C35",lineBackground:"#272C3599",foreground:"hsl(220, 14%, 71%)",caret:"#797977",selection:"#ffffff30",selectionMatch:"#2B323D",gutterBackground:"#272C35",gutterForeground:"#465063",gutterBorder:"transparent",lineHighlight:"#2B323D"},vFe=Ln({theme:"dark",settings:{background:"#272C35",foreground:"#9d9b97",caret:"#797977",selection:"#3d4c64",selectionMatch:"#3d4c64",gutterBackground:"#272C35",gutterForeground:"#465063",lineHighlight:"#2e3f5940"},styles:[{tag:[w.function(w.variableName),w.function(w.propertyName),w.url,w.processingInstruction],color:"hsl(207, 82%, 66%)"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"hsl( 29, 54%, 61%)"},{tag:[w.tagName,w.heading],color:"#e06c75"},{tag:w.comment,color:"#54636D"},{tag:[w.variableName,w.propertyName,w.labelName],color:"hsl(220, 14%, 71%)"},{tag:[w.attributeName,w.number],color:"hsl( 29, 54%, 61%)"},{tag:w.className,color:"hsl( 39, 67%, 69%)"},{tag:w.keyword,color:"hsl(286, 60%, 67%)"},{tag:[w.string,w.regexp,w.special(w.propertyName)],color:"#98c379"}]}),wFe={background:"#21202e",lineBackground:"#21202e99",foreground:"#edecee",caret:"#a277ff",selection:"#3d375e7f",selectionMatch:"#3d375e7f",gutterBackground:"#21202e",gutterForeground:"#edecee",gutterBorder:"transparent",lineHighlight:"#a394f033"},OFe=Ln({theme:"dark",settings:{background:"#21202e",foreground:"#edecee",caret:"#a277ff",selection:"#5a51898f",selectionMatch:"#5a51898f",gutterBackground:"#21202e",gutterForeground:"#edecee",lineHighlight:"#a394f033"},styles:[{tag:w.keyword,color:"#a277ff"},{tag:[w.name,w.deleted,w.character,w.macroName],color:"#edecee"},{tag:[w.propertyName],color:"#ffca85"},{tag:[w.processingInstruction,w.string,w.inserted,w.special(w.string)],color:"#61ffca"},{tag:[w.function(w.variableName),w.labelName],color:"#ffca85"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#61ffca"},{tag:[w.definition(w.name),w.separator],color:"#edecee"},{tag:[w.className],color:"#82e2ff"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#61ffca"},{tag:[w.typeName],color:"#82e2ff"},{tag:[w.operator,w.operatorKeyword],color:"#a277ff"},{tag:[w.url,w.escape,w.regexp,w.link],color:"#61ffca"},{tag:[w.meta,w.comment],color:"#6d6d6d"},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:"#a277ff"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#edecee"},{tag:w.invalid,color:"#ff6767"},{tag:w.strikethrough,textDecoration:"line-through"}]}),xFe={background:"#242424",lineBackground:"#24242499",foreground:"#f8f8f2",caret:"#FFFFFF",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"rgba(255, 255, 255, 0.1)",gutterForeground:"#999",gutterBorder:"transparent",lineHighlight:"rgba(255, 255, 255, 0.1)"},kFe=Ln({theme:"dark",settings:{background:"#242424",foreground:"#f8f8f2",caret:"#FFFFFF",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"transparent",gutterForeground:"#999",lineHighlight:"rgba(255, 255, 255, 0.1)"},styles:[{tag:w.labelName,color:"#CCCCCC"},{tag:[w.atom,w.number],color:"#7A9EC2"},{tag:[w.comment],color:"#707070"},{tag:[w.string],color:"#6A8759"},{tag:[w.variableName,w.operator],color:"#CCCCCC"},{tag:[w.function(w.variableName),w.propertyName],color:"#FFC66D"},{tag:[w.meta,w.className],color:"#FFC66D"},{tag:[w.propertyName],color:"#FFC66D"},{tag:[w.keyword],color:"#CC7832"},{tag:[w.tagName],color:"#ff79c6"},{tag:[w.typeName],color:"#ffb86c"}]}),PFe={background:"#282a36",lineBackground:"#282a3699",foreground:"#f8f8f2",caret:"#f8f8f0",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"#282a36",gutterForeground:"#6272a4",gutterBorder:"transparent",lineHighlight:"rgba(255, 255, 255, 0.1)"},SFe="#BD93F9",CFe=Ln({theme:"dark",settings:{background:"#282a36",foreground:"#f8f8f2",caret:"#f8f8f0",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"#282a36",gutterForeground:"#6272a4",lineHighlight:"rgba(255, 255, 255, 0.1)"},styles:[{tag:w.comment,color:"#6272a4"},{tag:w.string,color:"#f1fa8c"},{tag:[w.atom,w.number],color:SFe},{tag:[w.meta,w.labelName,w.variableName],color:"#f8f8f2"},{tag:[w.keyword,w.tagName,w.arithmeticOperator],color:"#ff79c6"},{tag:[w.function(w.variableName),w.propertyName],color:"#50fa7b"},{tag:w.atom,color:"#bd93f9"}]}),MFe={background:"#2a2734",lineBackground:"#2a273499",foreground:"#eeebff",caret:"#ffad5c",selection:"rgba(255, 255, 255, 0.1)",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},AFe=Ln({theme:"dark",settings:{background:"#2a2734",foreground:"#6c6783",caret:"#ffad5c",selection:"#9a86fd",selectionMatch:"#9a86fd",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},styles:[{tag:[w.comment,w.bracket,w.operator],color:"#6c6783"},{tag:[w.atom,w.number,w.keyword,w.link,w.attributeName,w.quote],color:"#ffcc99"},{tag:[w.emphasis,w.heading,w.tagName,w.propertyName,w.className,w.variableName],color:"#eeebff"},{tag:[w.typeName,w.url],color:"#eeebff"},{tag:w.string,color:"#ffb870"},{tag:[w.propertyName],color:"#eeebff"},{tag:w.labelName,color:"#eeebff"}]}),EFe={light:!0,background:"#fff",lineBackground:"#ffffff99",foreground:"#000",caret:"#FFFFFF",selection:"#d7d4f0",selectionMatch:"#d7d4f0",gutterBackground:"#f7f7f7",gutterForeground:"#999",lineHighlight:"#e8f2ff",gutterBorder:"transparent"},DFe=Ln({theme:"light",settings:{background:"#fff",foreground:"#000",caret:"#FFFFFF",selection:"#d7d4f0",selectionMatch:"#d7d4f0",gutterBackground:"#f7f7f7",gutterForeground:"#999",lineHighlight:"#006fff1c"},styles:[{tag:[w.comment],color:"#3F7F5F"},{tag:[w.documentMeta],color:"#FF1717"},{tag:w.keyword,color:"#7F0055",fontWeight:"bold"},{tag:w.atom,color:"#00f"},{tag:w.number,color:"#164"},{tag:w.propertyName,color:"#164"},{tag:[w.variableName,w.definition(w.variableName)],color:"#0000C0"},{tag:w.function(w.variableName),color:"#0000C0"},{tag:w.string,color:"#2A00FF"},{tag:w.operator,color:"black"},{tag:w.tagName,color:"#170"},{tag:w.attributeName,color:"#00c"},{tag:w.link,color:"#219"}]}),TFe={background:"#0d1117",lineBackground:"#0d111799",foreground:"#c9d1d9",caret:"#c9d1d9",selection:"#003d73",selectionMatch:"#003d73",lineHighlight:"#36334280"},FFe=Ln({theme:"dark",settings:{background:"#0d1117",foreground:"#c9d1d9",caret:"#c9d1d9",selection:"#003d73",selectionMatch:"#003d73",lineHighlight:"#36334280"},styles:[{tag:w.labelName,color:"#d2a8ff"},{tag:[w.standard(w.tagName),w.tagName],color:"#7ee787"},{tag:[w.comment,w.bracket],color:"#8b949e"},{tag:[w.className,w.propertyName],color:"#d2a8ff"},{tag:[w.variableName,w.attributeName],color:"#d2a8ff"},{tag:[w.number,w.operator],color:"#79c0ff"},{tag:[w.keyword,w.typeName,w.typeOperator,w.typeName],color:"#ff7b72"},{tag:[w.string,w.meta,w.regexp],color:"#a5d6ff"},{tag:[w.name,w.quote],color:"#7ee787"},{tag:[w.heading,w.strong],color:"#d2a8ff",fontWeight:"bold"},{tag:[w.emphasis],color:"#d2a8ff",fontStyle:"italic"},{tag:[w.deleted],color:"#ffdcd7",backgroundColor:"ffeef0"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#ffab70"},{tag:w.link,textDecoration:"underline"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.invalid,color:"#f97583"}]}),NFe={light:!0,background:"#fff",lineBackground:"#ffffff99",foreground:"#24292e",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#6e7781"},BFe=Ln({theme:"light",settings:{background:"#fff",foreground:"#24292e",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#6e7781"},styles:[{tag:[w.standard(w.tagName),w.tagName],color:"#116329"},{tag:[w.comment,w.bracket],color:"#6a737d"},{tag:[w.className,w.propertyName],color:"#6f42c1"},{tag:[w.variableName,w.attributeName,w.number,w.operator],color:"#005cc5"},{tag:[w.keyword,w.typeName,w.typeOperator,w.typeName],color:"#d73a49"},{tag:[w.string,w.meta,w.regexp],color:"#032f62"},{tag:[w.name,w.quote],color:"#22863a"},{tag:[w.heading,w.strong],color:"#24292e",fontWeight:"bold"},{tag:[w.emphasis],color:"#24292e",fontStyle:"italic"},{tag:[w.deleted],color:"#b31d28",backgroundColor:"ffeef0"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#e36209"},{tag:[w.url,w.escape,w.regexp,w.link],color:"#032f62"},{tag:w.link,textDecoration:"underline"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.invalid,color:"#cb2431"}]}),$Fe={background:"#282828",lineBackground:"#28282899",foreground:"#ebdbb2",caret:"#ebdbb2",selection:"#bdae93",selectionMatch:"#bdae93",lineHighlight:"#3c3836",gutterBackground:"#282828",gutterForeground:"#7c6f64"},RFe=Ln({theme:"dark",settings:{background:"#282828",foreground:"#ebdbb2",caret:"#ebdbb2",selection:"#b99d555c",selectionMatch:"#b99d555c",lineHighlight:"#baa1602b",gutterBackground:"#282828",gutterForeground:"#7c6f64"},styles:[{tag:w.keyword,color:"#fb4934"},{tag:[w.name,w.deleted,w.character,w.propertyName,w.macroName],color:"#8ec07c"},{tag:[w.variableName],color:"#83a598"},{tag:[w.function(w.variableName)],color:"#8ec07c",fontStyle:"bold"},{tag:[w.labelName],color:"#ebdbb2"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#d3869b"},{tag:[w.definition(w.name),w.separator],color:"#ebdbb2"},{tag:[w.brace],color:"#ebdbb2"},{tag:[w.annotation],color:"#fb4934d"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#d3869b"},{tag:[w.typeName,w.className],color:"#fabd2f"},{tag:[w.operatorKeyword],color:"#fb4934"},{tag:[w.tagName],color:"#8ec07c",fontStyle:"bold"},{tag:[w.squareBracket],color:"#fe8019"},{tag:[w.angleBracket],color:"#83a598"},{tag:[w.attributeName],color:"#8ec07c"},{tag:[w.regexp],color:"#8ec07c"},{tag:[w.quote],color:"#928374"},{tag:[w.string],color:"#ebdbb2"},{tag:w.link,color:"#a89984",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[w.url,w.escape,w.special(w.string)],color:"#d3869b"},{tag:[w.meta],color:"#fabd2f"},{tag:[w.comment],color:"#928374",fontStyle:"italic"},{tag:w.strong,fontWeight:"bold",color:"#fe8019"},{tag:w.emphasis,fontStyle:"italic",color:"#b8bb26"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.heading,fontWeight:"bold",color:"#b8bb26"},{tag:[w.heading1,w.heading2],fontWeight:"bold",color:"#b8bb26"},{tag:[w.heading3,w.heading4],fontWeight:"bold",color:"#fabd2f"},{tag:[w.heading5,w.heading6],color:"#fabd2f"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#d3869b"},{tag:[w.processingInstruction,w.inserted],color:"#83a598"},{tag:[w.contentSeparator],color:"#fb4934"},{tag:w.invalid,color:"#fe8019",borderBottom:"1px dotted #fb4934d"}]}),_Fe={light:!0,background:"#fbf1c7",lineBackground:"#fbf1c799",foreground:"#3c3836",caret:"#af3a03",selection:"#ebdbb2",selectionMatch:"#bdae93",lineHighlight:"#ebdbb2",gutterBackground:"#ebdbb2",gutterForeground:"#665c54",gutterBorder:"transparent"},LFe=Ln({theme:"light",settings:{background:"#fbf1c7",foreground:"#3c3836",caret:"#af3a03",selection:"#bdae9391",selectionMatch:"#bdae9391",lineHighlight:"#a37f2238",gutterBackground:"#ebdbb2",gutterForeground:"#665c54"},styles:[{tag:w.keyword,color:"#9d0006"},{tag:[w.name,w.deleted,w.character,w.propertyName,w.macroName],color:"#427b58"},{tag:[w.variableName],color:"#076678"},{tag:[w.function(w.variableName)],color:"#79740e",fontStyle:"bold"},{tag:[w.labelName],color:"#3c3836"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#8f3f71"},{tag:[w.definition(w.name),w.separator],color:"#3c3836"},{tag:[w.brace],color:"#3c3836"},{tag:[w.annotation],color:"#9d0006"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#8f3f71"},{tag:[w.typeName,w.className],color:"#b57614"},{tag:[w.operator,w.operatorKeyword],color:"#9d0006"},{tag:[w.tagName],color:"#427b58",fontStyle:"bold"},{tag:[w.squareBracket],color:"#af3a03"},{tag:[w.angleBracket],color:"#076678"},{tag:[w.attributeName],color:"#427b58"},{tag:[w.regexp],color:"#427b58"},{tag:[w.quote],color:"#928374"},{tag:[w.string],color:"#3c3836"},{tag:w.link,color:"#7c6f64",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[w.url,w.escape,w.special(w.string)],color:"#8f3f71"},{tag:[w.meta],color:"#b57614"},{tag:[w.comment],color:"#928374",fontStyle:"italic"},{tag:w.strong,fontWeight:"bold",color:"#af3a03"},{tag:w.emphasis,fontStyle:"italic",color:"#79740e"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.heading,fontWeight:"bold",color:"#79740e"},{tag:[w.heading1,w.heading2],fontWeight:"bold",color:"#79740e"},{tag:[w.heading3,w.heading4],fontWeight:"bold",color:"#b57614"},{tag:[w.heading5,w.heading6],color:"#b57614"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#8f3f71"},{tag:[w.processingInstruction,w.inserted],color:"#076678"},{tag:[w.contentSeparator],color:"#9d0006"},{tag:w.invalid,color:"#af3a03",borderBottom:"1px dotted #9d0006"}]}),IFe={background:"#212121",lineBackground:"#21212199",foreground:"#bdbdbd",caret:"#a0a4ae",selection:"#d7d4f0",selectionMatch:"#d7d4f0",gutterBackground:"#212121",gutterForeground:"#999",gutterActiveForeground:"#4f5b66",lineHighlight:"#111111"},QFe=Ln({theme:"dark",settings:{background:"#212121",foreground:"#bdbdbd",caret:"#a0a4ae",selection:"#d7d4f063",selectionMatch:"#d7d4f063",gutterBackground:"#212121",gutterForeground:"#999",lineHighlight:"#333333"},styles:[{tag:w.keyword,color:"#cf6edf"},{tag:[w.name,w.deleted,w.character,w.macroName],color:"#56c8d8"},{tag:[w.propertyName],color:"#82AAFF"},{tag:[w.variableName],color:"#bdbdbd"},{tag:[w.function(w.variableName)],color:"#82AAFF"},{tag:[w.labelName],color:"#cf6edf"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#facf4e"},{tag:[w.definition(w.name),w.separator],color:"#56c8d8"},{tag:[w.brace],color:"#cf6edf"},{tag:[w.annotation],color:"#f07178"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#f07178"},{tag:[w.typeName,w.className],color:"#f07178"},{tag:[w.operator,w.operatorKeyword],color:"#82AAFF"},{tag:[w.tagName],color:"#99d066"},{tag:[w.squareBracket],color:"#f07178"},{tag:[w.angleBracket],color:"#606f7a"},{tag:[w.attributeName],color:"#bdbdbd"},{tag:[w.regexp],color:"#f07178"},{tag:[w.quote],color:"#6abf69"},{tag:[w.string],color:"#99d066"},{tag:w.link,color:"#56c8d8",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[w.url,w.escape,w.special(w.string)],color:"#facf4e"},{tag:[w.meta],color:"#707d8b"},{tag:[w.comment],color:"#707d8b",fontStyle:"italic"},{tag:w.monospace,color:"#bdbdbd"},{tag:w.strong,fontWeight:"bold",color:"#f07178"},{tag:w.emphasis,fontStyle:"italic",color:"#99d066"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.heading,fontWeight:"bold",color:"#facf4e"},{tag:w.heading1,fontWeight:"bold",color:"#facf4e"},{tag:[w.heading2,w.heading3,w.heading4],fontWeight:"bold",color:"#facf4e"},{tag:[w.heading5,w.heading6],color:"#facf4e"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#56c8d8"},{tag:[w.processingInstruction,w.inserted],color:"#f07178"},{tag:[w.contentSeparator],color:"#56c8d8"},{tag:w.invalid,color:"#606f7a",borderBottom:"1px dotted #f07178"}]}),VFe={light:!0,background:"#FAFAFA",lineBackground:"#FAFAFA99",foreground:"#90A4AE",caret:"#272727",selection:"#80CBC440",selectionMatch:"#FAFAFA",gutterBackground:"#FAFAFA",gutterForeground:"#90A4AE",gutterBorder:"transparent",lineHighlight:"#CCD7DA50"},jFe=Ln({theme:"light",settings:{background:"#FAFAFA",foreground:"#90A4AE",caret:"#272727",selection:"#80CBC440",selectionMatch:"#80CBC440",gutterBackground:"#FAFAFA",gutterForeground:"#90A4AE",lineHighlight:"#CCD7DA50"},styles:[{tag:w.keyword,color:"#39ADB5"},{tag:[w.name,w.deleted,w.character,w.macroName],color:"#90A4AE"},{tag:[w.propertyName],color:"#6182B8"},{tag:[w.processingInstruction,w.string,w.inserted,w.special(w.string)],color:"#91B859"},{tag:[w.function(w.variableName),w.labelName],color:"#6182B8"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#39ADB5"},{tag:[w.definition(w.name),w.separator],color:"#90A4AE"},{tag:[w.className],color:"#E2931D"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#F76D47"},{tag:[w.typeName],color:"#E2931D",fontStyle:"#E2931D"},{tag:[w.operator,w.operatorKeyword],color:"#39ADB5"},{tag:[w.url,w.escape,w.regexp,w.link],color:"#91B859"},{tag:[w.meta,w.comment],color:"#90A4AE"},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:"#39ADB5"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#90A4AE"},{tag:w.invalid,color:"#E5393570"},{tag:w.strikethrough,textDecoration:"line-through"}]}),ZFe={background:"#2e3440",lineBackground:"#2e344099",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#3b4252",selectionMatch:"#e5e9f0",gutterBackground:"#2e3440",gutterForeground:"#4c566a",gutterActiveForeground:"#d8dee9",lineHighlight:"#4c566a"},zFe=Ln({theme:"dark",settings:{background:"#2e3440",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#00000073",selectionMatch:"#00000073",gutterBackground:"#2e3440",gutterForeground:"#4c566a",lineHighlight:"#4c566a29"},styles:[{tag:w.keyword,color:"#5e81ac"},{tag:[w.name,w.deleted,w.character,w.propertyName,w.macroName],color:"#88c0d0"},{tag:[w.variableName],color:"#8fbcbb"},{tag:[w.function(w.variableName)],color:"#8fbcbb"},{tag:[w.labelName],color:"#81a1c1"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#5e81ac"},{tag:[w.definition(w.name),w.separator],color:"#a3be8c"},{tag:[w.brace],color:"#8fbcbb"},{tag:[w.annotation],color:"#d30102"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#b48ead"},{tag:[w.typeName,w.className],color:"#ebcb8b"},{tag:[w.operator,w.operatorKeyword],color:"#a3be8c"},{tag:[w.tagName],color:"#b48ead"},{tag:[w.squareBracket],color:"#bf616a"},{tag:[w.angleBracket],color:"#d08770"},{tag:[w.attributeName],color:"#ebcb8b"},{tag:[w.regexp],color:"#5e81ac"},{tag:[w.quote],color:"#b48ead"},{tag:[w.string],color:"#a3be8c"},{tag:w.link,color:"#a3be8c",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[w.url,w.escape,w.special(w.string)],color:"#8fbcbb"},{tag:[w.meta],color:"#88c0d0"},{tag:[w.monospace],color:"#d8dee9",fontStyle:"italic"},{tag:[w.comment],color:"#4c566a",fontStyle:"italic"},{tag:w.strong,fontWeight:"bold",color:"#5e81ac"},{tag:w.emphasis,fontStyle:"italic",color:"#5e81ac"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:w.heading,fontWeight:"bold",color:"#5e81ac"},{tag:w.special(w.heading1),fontWeight:"bold",color:"#5e81ac"},{tag:w.heading1,fontWeight:"bold",color:"#5e81ac"},{tag:[w.heading2,w.heading3,w.heading4],fontWeight:"bold",color:"#5e81ac"},{tag:[w.heading5,w.heading6],color:"#5e81ac"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#d08770"},{tag:[w.processingInstruction,w.inserted],color:"#8fbcbb"},{tag:[w.contentSeparator],color:"#ebcb8b"},{tag:w.invalid,color:"#434c5e",borderBottom:"1px dotted #d30102"}]}),GFe={background:"#272822",lineBackground:"#27282299",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#49483E",selectionMatch:"#49483E",gutterBackground:"#272822",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},XFe=Ln({theme:"dark",settings:{background:"#272822",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#49483E",selectionMatch:"#49483E",gutterBackground:"#272822",gutterForeground:"#FFFFFF70",lineHighlight:"#0000003b"},styles:[{tag:w.labelName,color:"#bababa"},{tag:[w.comment,w.documentMeta],color:"#8292a2"},{tag:[w.number,w.bool,w.null,w.atom],color:"#ae81ff"},{tag:[w.attributeValue,w.className,w.name],color:"#e6db74"},{tag:[w.propertyName,w.attributeName],color:"#a6e22e"},{tag:[w.variableName],color:"#9effff"},{tag:[w.squareBracket],color:"#bababa"},{tag:[w.string,w.special(w.brace)],color:"#e6db74"},{tag:[w.regexp,w.className,w.typeName,w.definition(w.typeName)],color:"#66d9ef"},{tag:[w.definition(w.variableName),w.definition(w.propertyName),w.function(w.variableName)],color:"#a6e22e"},{tag:[w.keyword,w.definitionKeyword,w.modifier,w.tagName,w.angleBracket],color:"#f92672"}]}),WFe={background:"#002b36",lineBackground:"#002b3699",foreground:"#93a1a1",caret:"#839496",selection:"#173541",selectionMatch:"#aafe661a",gutterBackground:"#00252f",gutterForeground:"#839496",lineHighlight:"#173541"},Ns={background:"#002B36",foreground:"#839496",selection:"#004454AA",cursor:"#D30102",activeLine:"#00cafe11",keyword:"#859900",variable:"#268BD2",function:"#268BD2",string:"#2AA198",constant:"#CB4B16",type:"#859900",class:"#268BD2",number:"#D33682",comment:"#586E75",heading:"#268BD2",invalid:"#DC322F",regexp:"#DC322F",tag:"#268BD2"},qFe=Ln({theme:"dark",settings:{background:Ns.background,foreground:Ns.foreground,caret:Ns.cursor,selection:Ns.selection,selectionMatch:Ns.selection,gutterBackground:Ns.background,gutterForeground:Ns.foreground,lineHighlight:Ns.activeLine},styles:[{tag:w.keyword,color:Ns.keyword},{tag:[w.name,w.deleted,w.character,w.macroName],color:Ns.variable},{tag:[w.propertyName],color:Ns.function},{tag:[w.processingInstruction,w.string,w.inserted,w.special(w.string)],color:Ns.string},{tag:[w.function(w.variableName),w.labelName],color:Ns.function},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:Ns.constant},{tag:[w.definition(w.name),w.separator],color:Ns.variable},{tag:[w.className],color:Ns.class},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:Ns.number},{tag:[w.typeName],color:Ns.type,fontStyle:Ns.type},{tag:[w.operator,w.operatorKeyword],color:Ns.keyword},{tag:[w.url,w.escape,w.regexp,w.link],color:Ns.regexp},{tag:[w.meta,w.comment],color:Ns.comment},{tag:w.tagName,color:Ns.tag},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:Ns.heading},{tag:[w.atom,w.bool,w.special(w.variableName)],color:Ns.variable},{tag:w.invalid,color:Ns.invalid},{tag:w.strikethrough,textDecoration:"line-through"}]}),UFe={light:!0,background:"#fdf6e3",lineBackground:"#fdf6e399",foreground:"#657b83",caret:"#586e75",selection:"#dfd9c8",selectionMatch:"#dfd9c8",gutterBackground:"#00000010",gutterForeground:"#657b83",lineHighlight:"#dfd9c8"},Bs={background:"#FDF6E3",foreground:"#657B83",selection:"#EEE8D5",selectionMatch:"#EEE8D5",cursor:"#657B83",activeLine:"#3d392d11",keyword:"#859900",variable:"#268BD2",function:"#268BD2",string:"#2AA198",constant:"#CB4B16",type:"#859900",class:"#268BD2",number:"#D33682",comment:"#93A1A1",heading:"#268BD2",invalid:"#DC322F",regexp:"#DC322F",tag:"#268BD2"},HFe=Ln({theme:"light",settings:{background:Bs.background,foreground:Bs.foreground,caret:Bs.cursor,selection:Bs.selection,selectionMatch:Bs.selectionMatch,gutterBackground:Bs.background,gutterForeground:Bs.foreground,lineHighlight:Bs.activeLine},styles:[{tag:w.keyword,color:Bs.keyword},{tag:[w.name,w.deleted,w.character,w.macroName],color:Bs.variable},{tag:[w.propertyName],color:Bs.function},{tag:[w.processingInstruction,w.string,w.inserted,w.special(w.string)],color:Bs.string},{tag:[w.function(w.variableName),w.labelName],color:Bs.function},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:Bs.constant},{tag:[w.definition(w.name),w.separator],color:Bs.variable},{tag:[w.className],color:Bs.class},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:Bs.number},{tag:[w.typeName],color:Bs.type,fontStyle:Bs.type},{tag:[w.operator,w.operatorKeyword],color:Bs.keyword},{tag:[w.url,w.escape,w.regexp,w.link],color:Bs.regexp},{tag:[w.meta,w.comment],color:Bs.comment},{tag:w.tagName,color:Bs.tag},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:Bs.heading},{tag:[w.atom,w.bool,w.special(w.variableName)],color:Bs.variable},{tag:w.invalid,color:Bs.invalid},{tag:w.strikethrough,textDecoration:"line-through"}]}),YFe={background:"#303841",lineBackground:"#30384199",foreground:"#FFFFFF",caret:"#FBAC52",selection:"#4C5964",selectionMatch:"#3A546E",gutterBackground:"#303841",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},KFe=Ln({theme:"dark",settings:{background:"#303841",foreground:"#FFFFFF",caret:"#FBAC52",selection:"#4C5964",selectionMatch:"#3A546E",gutterBackground:"#303841",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},styles:[{tag:w.labelName,color:"#A2A9B5"},{tag:[w.meta,w.comment],color:"#A2A9B5"},{tag:[w.attributeName,w.keyword],color:"#B78FBA"},{tag:w.function(w.variableName),color:"#5AB0B0"},{tag:[w.string,w.regexp,w.attributeValue],color:"#99C592"},{tag:w.operator,color:"#f47954"},{tag:[w.tagName,w.modifier],color:"#E35F63"},{tag:[w.number,w.definition(w.tagName),w.className,w.definition(w.variableName)],color:"#fbac52"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#E35F63"},{tag:w.variableName,color:"#539ac4"},{tag:[w.propertyName,w.typeName],color:"#629ccd"},{tag:w.propertyName,color:"#36b7b5"}]}),JFe={background:"#1a1b26",lineBackground:"#1a1b2699",foreground:"#787c99",caret:"#c0caf5",selection:"#515c7e40",selectionMatch:"#16161e",gutterBackground:"#1a1b26",gutterForeground:"#787c99",gutterBorder:"transparent",lineHighlight:"#1e202e"},eNe=Ln({theme:"dark",settings:{background:"#1a1b26",foreground:"#787c99",caret:"#c0caf5",selection:"#515c7e40",selectionMatch:"#16161e",gutterBackground:"#1a1b26",gutterForeground:"#787c99",lineHighlight:"#474b6611"},styles:[{tag:w.keyword,color:"#bb9af7"},{tag:[w.name,w.deleted,w.character,w.macroName],color:"#c0caf5"},{tag:[w.propertyName],color:"#7aa2f7"},{tag:[w.processingInstruction,w.string,w.inserted,w.special(w.string)],color:"#9ece6a"},{tag:[w.function(w.variableName),w.labelName],color:"#7aa2f7"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#bb9af7"},{tag:[w.definition(w.name),w.separator],color:"#c0caf5"},{tag:[w.className],color:"#c0caf5"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#ff9e64"},{tag:[w.typeName],color:"#0db9d7"},{tag:[w.operator,w.operatorKeyword],color:"#bb9af7"},{tag:[w.url,w.escape,w.regexp,w.link],color:"#b4f9f8"},{tag:[w.meta,w.comment],color:"#444b6a"},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:"#89ddff"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#c0caf5"},{tag:w.invalid,color:"#ff5370"},{tag:w.strikethrough,textDecoration:"line-through"}]}),tNe={background:"#24283b",lineBackground:"#24283b99",foreground:"#7982a9",caret:"#c0caf5",selection:"#6f7bb630",selectionMatch:"#1f2335",gutterBackground:"#24283b",gutterForeground:"#7982a9",gutterBorder:"transparent",lineHighlight:"#292e42"},nNe=Ln({theme:"dark",settings:{background:"#24283b",foreground:"#7982a9",caret:"#c0caf5",selection:"#6f7bb630",selectionMatch:"#343b5f",gutterBackground:"#24283b",gutterForeground:"#7982a9",lineHighlight:"#292e427a"},styles:[{tag:w.keyword,color:"#bb9af7"},{tag:[w.name,w.deleted,w.character,w.macroName],color:"#c0caf5"},{tag:[w.propertyName],color:"#7aa2f7"},{tag:[w.processingInstruction,w.string,w.inserted,w.special(w.string)],color:"#9ece6a"},{tag:[w.function(w.variableName),w.labelName],color:"#7aa2f7"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#bb9af7"},{tag:[w.definition(w.name),w.separator],color:"#c0caf5"},{tag:[w.className],color:"#c0caf5"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#ff9e64"},{tag:[w.typeName],color:"#2ac3de",fontStyle:"#2ac3de"},{tag:[w.operator,w.operatorKeyword],color:"#bb9af7"},{tag:[w.url,w.escape,w.regexp,w.link],color:"#b4f9f8"},{tag:[w.meta,w.comment],color:"#565f89"},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:"#89ddff"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#c0caf5"},{tag:w.invalid,color:"#ff5370"},{tag:w.strikethrough,textDecoration:"line-through"}]}),sNe={light:!0,background:"#e1e2e7",lineBackground:"#e1e2e799",foreground:"#3760bf",caret:"#3760bf",selection:"#99a7df",selectionMatch:"#99a7df",gutterBackground:"#e1e2e7",gutterForeground:"#3760bf",gutterBorder:"transparent",lineHighlight:"#5f5faf11"},aNe=Ln({theme:"light",settings:{background:"#e1e2e7",foreground:"#3760bf",caret:"#3760bf",selection:"#99a7df",selectionMatch:"#99a7df",gutterBackground:"#e1e2e7",gutterForeground:"#3760bf",lineHighlight:"#5f5faf11"},styles:[{tag:w.keyword,color:"#007197"},{tag:[w.name,w.deleted,w.character,w.macroName],color:"#3760bf"},{tag:[w.propertyName],color:"#3760bf"},{tag:[w.processingInstruction,w.string,w.inserted,w.special(w.string)],color:"#587539"},{tag:[w.function(w.variableName),w.labelName],color:"#3760bf"},{tag:[w.color,w.constant(w.name),w.standard(w.name)],color:"#3760bf"},{tag:[w.definition(w.name),w.separator],color:"#3760bf"},{tag:[w.className],color:"#3760bf"},{tag:[w.number,w.changed,w.annotation,w.modifier,w.self,w.namespace],color:"#b15c00"},{tag:[w.typeName],color:"#007197",fontStyle:"#007197"},{tag:[w.operator,w.operatorKeyword],color:"#007197"},{tag:[w.url,w.escape,w.regexp,w.link],color:"#587539"},{tag:[w.meta,w.comment],color:"#848cb5"},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.link,textDecoration:"underline"},{tag:w.heading,fontWeight:"bold",color:"#b15c00"},{tag:[w.atom,w.bool,w.special(w.variableName)],color:"#3760bf"},{tag:w.invalid,color:"#f52a65"},{tag:w.strikethrough,textDecoration:"line-through"}]}),rNe={background:"#1e1e1e",lineBackground:"#1e1e1e99",foreground:"#fff",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff"},oNe=Ln({theme:"dark",settings:{background:"#1e1e1e",foreground:"#fff",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383"},styles:[{tag:[w.keyword,w.operatorKeyword,w.modifier,w.color,w.constant(w.name),w.standard(w.name),w.standard(w.tagName),w.special(w.brace),w.atom,w.bool,w.special(w.variableName)],color:"#569cd6"},{tag:[w.controlKeyword,w.moduleKeyword],color:"#c586c0"},{tag:[w.name,w.deleted,w.character,w.macroName,w.propertyName,w.variableName,w.labelName,w.definition(w.name)],color:"#9cdcfe"},{tag:w.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[w.typeName,w.className,w.tagName,w.number,w.changed,w.annotation,w.self,w.namespace],color:"#4ec9b0"},{tag:[w.function(w.variableName),w.function(w.propertyName)],color:"#dcdcaa"},{tag:[w.number],color:"#b5cea8"},{tag:[w.operator,w.punctuation,w.separator,w.url,w.escape,w.regexp],color:"#d4d4d4"},{tag:[w.regexp],color:"#d16969"},{tag:[w.special(w.string),w.processingInstruction,w.string,w.inserted],color:"#ce9178"},{tag:[w.angleBracket],color:"#808080"},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:[w.meta,w.comment],color:"#6a9955"},{tag:w.link,color:"#6a9955",textDecoration:"underline"},{tag:w.invalid,color:"#ff0000"}]}),iNe={background:"#ffffff",lineBackground:"#ffffff50",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},lNe=Ln({theme:"light",settings:{background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893"},styles:[{tag:[w.keyword,w.operatorKeyword,w.modifier,w.color,w.constant(w.name),w.standard(w.name),w.standard(w.tagName),w.special(w.brace),w.atom,w.bool,w.special(w.variableName)],color:"#0000ff"},{tag:[w.moduleKeyword,w.controlKeyword],color:"#af00db"},{tag:[w.name,w.deleted,w.character,w.macroName,w.propertyName,w.variableName,w.labelName,w.definition(w.name)],color:"#0070c1"},{tag:w.heading,fontWeight:"bold",color:"#0070c1"},{tag:[w.typeName,w.className,w.tagName,w.number,w.changed,w.annotation,w.self,w.namespace],color:"#267f99"},{tag:[w.function(w.variableName),w.function(w.propertyName)],color:"#795e26"},{tag:[w.number],color:"#098658"},{tag:[w.operator,w.punctuation,w.separator,w.url,w.escape,w.regexp],color:"#383a42"},{tag:[w.regexp],color:"#af00db"},{tag:[w.special(w.string),w.processingInstruction,w.string,w.inserted],color:"#a31515"},{tag:[w.angleBracket],color:"#383a42"},{tag:w.strong,fontWeight:"bold"},{tag:w.emphasis,fontStyle:"italic"},{tag:w.strikethrough,textDecoration:"line-through"},{tag:[w.meta,w.comment],color:"#008000"},{tag:w.link,color:"#4078f2",textDecoration:"underline"},{tag:w.invalid,color:"#e45649"}]}),cNe={light:!0,background:"#fff",lineBackground:"#ffffff99",foreground:"#3D3D3D",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#AFAFAF",lineHighlight:"#EDF4FF"},uNe=Ln({theme:"light",settings:{background:"#fff",foreground:"#3D3D3D",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#AFAFAF",lineHighlight:"#d5e6ff69"},styles:[{tag:[w.comment,w.quote],color:"#707F8D"},{tag:[w.typeName,w.typeOperator],color:"#aa0d91"},{tag:[w.keyword],color:"#aa0d91",fontWeight:"bold"},{tag:[w.string,w.meta],color:"#D23423"},{tag:[w.name],color:"#032f62"},{tag:[w.typeName],color:"#522BB2"},{tag:[w.variableName],color:"#23575C"},{tag:[w.definition(w.variableName)],color:"#327A9E"},{tag:[w.regexp,w.link],color:"#0e0eff"}]}),hNe={light:!0,background:"#FFFFFF",lineBackground:"#FFFFFF99",foreground:"#000000",caret:"#FBAC52",selection:"#FFD420",selectionMatch:"#FFD420",gutterBackground:"#f5f5f5",gutterForeground:"#4D4D4C",gutterBorder:"transparent",lineHighlight:"#00000012"},dNe=Ln({theme:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#FBAC52",selection:"#FFD420",selectionMatch:"#FFD420",gutterBackground:"#f5f5f5",gutterForeground:"#4D4D4C",lineHighlight:"#00000012"},styles:[{tag:[w.meta,w.comment],color:"#804000"},{tag:[w.keyword,w.strong],color:"#0000FF"},{tag:[w.number],color:"#FF0080"},{tag:[w.string],color:"#FF0080"},{tag:[w.variableName],color:"#006600"},{tag:[w.escape],color:"#33CC33"},{tag:[w.tagName],color:"#1C02FF"},{tag:[w.heading],color:"#0C07FF"},{tag:[w.quote],color:"#000000"},{tag:[w.list],color:"#B90690"},{tag:[w.documentMeta],color:"#888888"},{tag:[w.function(w.variableName)],color:"#0000A2"},{tag:[w.definition(w.typeName),w.typeName],color:"#6D79DE"}]}),mNe={light:!0,background:"#f2f1f8",lineBackground:"#f2f1f899",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",selectionMatch:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#e1def3"},pNe=Ln({theme:"light",settings:{background:"#f2f1f8",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",selectionMatch:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#16067911"},styles:[{tag:w.comment,color:"#9995b7"},{tag:w.keyword,color:"#ff5792",fontWeight:"bold"},{tag:[w.definitionKeyword,w.modifier],color:"#ff5792"},{tag:[w.className,w.tagName,w.definition(w.typeName)],color:"#0094f0"},{tag:[w.number,w.bool,w.null,w.special(w.brace)],color:"#5842ff"},{tag:[w.definition(w.propertyName),w.function(w.variableName)],color:"#0095a8"},{tag:w.typeName,color:"#b3694d"},{tag:[w.propertyName,w.variableName],color:"#fa8900"},{tag:w.operator,color:"#ff5792"},{tag:w.self,color:"#e64100"},{tag:[w.string,w.regexp],color:"#00b368"},{tag:[w.paren,w.bracket],color:"#0431fa"},{tag:w.labelName,color:"#00bdd6"},{tag:w.attributeName,color:"#e64100"},{tag:w.angleBracket,color:"#9995b7"}]}),PC={strudelTheme:HTe,algoboy:nFe,archBtw:mFe,androidstudio:bFe,atomone:vFe,aura:OFe,bbedit:dNe,blackscreen:KTe,bluescreen:YTe,bluescreenlight:fFe,CutiePi:cFe,darcula:kFe,dracula:CFe,duotoneDark:AFe,eclipse:DFe,fruitDaw:pFe,githubDark:FFe,githubLight:BFe,greenText:dFe,gruvboxDark:RFe,gruvboxLight:LFe,sonicPink:uFe,materialDark:QFe,materialLight:jFe,monokai:XFe,noctisLilac:pNe,nord:zFe,redText:hFe,solarizedDark:qFe,solarizedLight:HFe,sublime:KFe,teletext:eFe,tokyoNight:eNe,tokyoNightDay:aNe,tokyoNightStorm:nNe,vscodeDark:oNe,vscodeLight:lNe,whitescreen:JTe,xcodeLight:uNe},v1={strudelTheme:BK,bluescreen:$K,bluescreenlight:UK,blackscreen:RK,whitescreen:_K,teletext:VK,algoboy:jK,archBtw:WK,androidstudio:gFe,atomone:yFe,aura:wFe,bbedit:hNe,darcula:xFe,dracula:PFe,duotoneDark:MFe,eclipse:EFe,CutiePi:kC,sonicPink:zK,fruitDaw:qK,githubLight:NFe,githubDark:TFe,greenText:XK,gruvboxDark:$Fe,gruvboxLight:_Fe,materialDark:IFe,materialLight:VFe,noctisLilac:mNe,nord:ZFe,monokai:GFe,redText:GK,solarizedLight:UFe,solarizedDark:WFe,sublime:YFe,tokyoNight:JFe,tokyoNightStorm:tNe,vscodeDark:rNe,vscodeLight:iNe,xcodeLight:cNe,tokyoNightDay:sNe};function fNe(n){const e=/#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})/g,t=[];let s;for(;(s=e.exec(n))!==null;){const a=s[0];t.includes(a)||t.push(a)}return t}function gNe(n){return fNe(yNe(n))}function bNe(){const n=new WeakSet;return(e,t)=>{if(typeof t=="object"&&t!==null){if(n.has(t))return;n.add(t)}return t}}function yNe(n){return JSON.stringify(n,bNe())}const HK=n=>PC[n]||PC.strudelTheme;function YK(n){const e=document.createElement("style");document.head.appendChild(e);const t=e.sheet,s=t.insertRule(n,0);return()=>t.deleteRule(s)}let WF,Zp,w1,qF="strudel-theme-vars";function KK(n){document.getElementById(qF)||(w1=document.createElement("style"),w1.id=qF,document.head.append(w1)),B5(n)}function B5(n){if(WF===n)return;WF=n,v1[n]||console.warn("theme",n,"has no settings.. defaulting to strudelTheme settings");const e=v1[n]||v1.strudelTheme;w1.innerHTML=`:root {
      ${Object.entries(e).map(([t,s])=>`--${t}: ${s} !important;`).join(`
`)}
    }`,AOe(e),e.light?document.documentElement.classList.remove("dark"):document.documentElement.classList.add("dark"),Zp==null||Zp(),Zp=void 0,e.customStyle&&(Zp=YK(e.customStyle))}let Jd={};const vNe=n=>`slider_${n}`;class JK extends cl{constructor(e,t,s,a,r,o,i){super(),this.value=e,this.min=t,this.max=s,this.from=a,this.originalFrom=a,this.to=r,this.step=o,this.view=i}eq(){return!1}toDOM(){let e=document.createElement("span");e.setAttribute("aria-hidden","true"),e.className="cm-slider";let t=e.appendChild(document.createElement("input"));return t.type="range",t.min=this.min,t.max=this.max,t.step=this.step??(this.max-this.min)/1e3,t.originalValue=this.value,t.value=t.originalValue,t.from=this.from,t.originalFrom=this.originalFrom,t.to=this.to,t.style="width:64px;margin-right:4px;transform:translateY(4px)",this.slider=t,t.addEventListener("input",s=>{const a=s.target.value;let r=a;const o=t.from+t.originalValue.length;let i={from:t.from,to:o,insert:r};t.originalValue=r,t.value=r,this.view.dispatch({changes:i});const l=vNe(t.originalFrom);window.postMessage({type:"cm-slider",value:Number(a),id:l})}),e}ignoreEvent(e){return!0}}const $5=hn.define(),eJ=(n,e)=>{n.dispatch({effects:$5.of(e)})};function wNe(n,e){return n.filter(t=>t.type==="slider").map(({from:t,to:s,value:a,min:r,max:o,step:i})=>en.widget({widget:new JK(a,r,o,t,s,i,e),side:0}).range(t))}const tJ=ra.fromClass(class{constructor(n){la(this,"decorations");this.decorations=en.set([])}update(n){n.transactions.forEach(e=>{var t,s;if(e.docChanged){this.decorations=this.decorations.map(e.changes);const a=this.decorations.iter();for(;a.value;)(s=(t=a.value)==null?void 0:t.widget)!=null&&s.slider&&(a.value.widget.slider.from=a.from,a.value.widget.slider.to=a.to),a.next()}for(let a of e.effects)a.is($5)&&(this.decorations=en.set(wNe(a.value,n.view)))})}},{decorations:n=>n.decorations});let ONe=n=>(console.warn("slider will only work when the transpiler is used... passing value as is"),Ys(n)),xNe=(n,e,t,s)=>(Jd[n]=e,jL(()=>Jd[n]));typeof window<"u"&&window.addEventListener("message",n=>{n.data.type==="cm-slider"&&(Jd[n.data.id]!==void 0?Jd[n.data.id]=n.data.value:console.warn(`slider with id "${n.data.id}" is not registered. Only ${Object.keys(Jd)}`))});const R5=hn.define({map:({from:n,to:e},t)=>({from:t.mapPos(n),to:t.mapPos(e)})}),nJ=(n,e)=>{n.dispatch({effects:R5.of(e)})};function kNe(n){return n.sort((e,t)=>e.to-t.to).map(e=>en.widget({widget:new rJ(e),side:0,block:!0}).range(e.to))}const PNe=Js.define({create(){return en.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(R5))try{n=n.update({filter:()=>!1,add:kNe(t.value)})}catch(s){console.log("err",s)}return n},provide:n=>vt.decorations.from(n)}),sJ={};function aJ(n,e){sJ[n]=e,e.id=n}class rJ extends cl{constructor(e){super(),this.widgetConfig=e}eq(){return!0}toDOM(){const e=EX(this.widgetConfig);return sJ[e]}ignoreEvent(e){return!0}}const oJ=[PNe];function Jh(n,e){Uxe(n),e&&(dt.prototype[n]=function(t,s={fold:1}){return e(t,s,this)})}function cp(n,e={}){const{width:t=500,height:s=60,pixelRatio:a=window.devicePixelRatio}=e;let r=document.getElementById(n)||document.createElement("canvas");return r.width=t*a,r.height=s*a,r.style.width=t+"px",r.style.height=s+"px",aJ(n,r),r}Jh("_pianoroll",(n,e={},t)=>{const s=cp(n,e).getContext("2d");return t.tag(n).pianoroll({fold:1,...e,ctx:s,id:n})});Jh("_punchcard",(n,e={},t)=>{const s=cp(n,e).getContext("2d");return t.tag(n).punchcard({fold:1,...e,ctx:s,id:n})});Jh("_spiral",(n,e={},t)=>{let s=e.size||275;e={width:s,height:s,...e,size:s/5};const a=cp(n,e).getContext("2d");return t.tag(n).spiral({...e,ctx:a,id:n})});Jh("_scope",(n,e={},t)=>{e={width:500,height:60,pos:.5,scale:1,...e};const s=cp(n,e).getContext("2d");return t.tag(n).scope({...e,ctx:s,id:n})});Jh("_pitchwheel",(n,e={},t)=>{let s=e.size||200;e={width:s,height:s,...e,size:s/5};const a=cp(n,e).getContext("2d");return t.pitchwheel({...e,ctx:a,id:n})});Jh("_spectrum",(n,e={},t)=>{let s=e.size||200;e={width:s,height:s,...e,size:s/5};const a=cp(n,e).getContext("2d");return t.spectrum({...e,ctx:a,id:n})});let UF=n=>n,dd={},SC={addEventListener(){},removeEventListener(){}};function SNe(){try{return typeof localStorage<"u"}catch{return!1}}SNe()&&(dd=localStorage);let CNe={addEventListener(n,e,t){window.addEventListener("storage",e),window.addEventListener("pageshow",t)},removeEventListener(n,e,t){window.removeEventListener("storage",e),window.removeEventListener("pageshow",t)}};typeof window<"u"&&(SC=CNe);function MNe(n,e=void 0,t={}){let s=t.encode||UF,a=t.decode||UF,r=zX(e),o=r.set;r.set=c=>{typeof c>"u"?delete dd[n]:dd[n]=s(c),o(c)};function i(c){c.key===n?c.newValue===null?o(void 0):o(a(c.newValue)):dd[n]||o(void 0)}function l(){r.set(dd[n]?a(dd[n]):e)}return Ike(r,()=>{if(l(),t.listen!==!1)return SC.addEventListener(n,i,l),()=>{SC.removeEventListener(n,i,l)}}),r}const ANe=[Jq(),JU(),VSe(),aCe(),iCe(),Xc.of([...pAe,...Y3,...sH])];Jq(),JU(),Uq(),_3(TU,{fallback:!0}),Xc.of([...Y3,...sH]);const Md={isLineWrappingEnabled:n=>n?vt.lineWrapping:[],isBracketMatchingEnabled:n=>n?xMe({brackets:"()[]{}<>"}):[],isBracketClosingEnabled:n=>n?hAe():[],isLineNumbersDisplayed:n=>n?PCe():[],theme:HK,isAutoCompletionEnabled:b4e,isTooltipEnabled:w4e,isPatternHighlightingEnabled:uK,isActiveLineHighlighted:n=>n?[KSe(),MCe()]:[],isFlashEnabled:iK,keybindings:UTe,isTabIndentationEnabled:n=>n?Xc.of([r3e]):[],isMultiCursorEnabled:n=>n?[as.allowMultipleSelections.of(!0),vt.clickAddsSelectionRange.of(e=>e.metaKey||e.ctrlKey)]:[]},CC=Object.fromEntries(Object.keys(Md).map(n=>[n,new n0])),iJ={keybindings:"codemirror",isBracketMatchingEnabled:!1,isBracketClosingEnabled:!0,isLineNumbersDisplayed:!0,isActiveLineHighlighted:!1,isAutoCompletionEnabled:!1,isPatternHighlightingEnabled:!0,isFlashEnabled:!0,isTooltipEnabled:!1,isLineWrappingEnabled:!1,isTabIndentationEnabled:!1,isMultiCursorEnabled:!1,theme:"strudelTheme",fontFamily:"monospace",fontSize:18},em=MNe("codemirror-settings",iJ,{encode:JSON.stringify,decode:JSON.parse});function lJ({initialCode:n="",onChange:e,onEvaluate:t,onStop:s,root:a,mondo:r}){const o=em.get(),i=Object.keys(CC).map(c=>CC[c].of(Md[c](uJ(o[c]))));KK(o.theme);let l=as.create({doc:n,extensions:[...i,ANe,r?[]:e5e(),bu.data.of({closeBrackets:{brackets:["(","[","{","'",'"',"<"]},bracketMatching:{brackets:["(","[","{","'",'"',"<"]}}),tJ,oJ,_3(TU),vt.updateListener.of(c=>e(c)),Uq({cursorBlinkRate:0}),yo.highest(Xc.of([{key:"Ctrl-Enter",run:()=>t==null?void 0:t()},{key:"Alt-Enter",run:()=>t==null?void 0:t()},{key:"Ctrl-.",run:()=>s==null?void 0:s()},{key:"Alt-.",preventDefault:!0,run:()=>s==null?void 0:s()}]))]});return new vt({state:l,parent:a})}class cJ{constructor(e){const{root:t,id:s,initialCode:a="",onDraw:r,drawContext:o,drawTime:i=[0,0],autodraw:l,prebake:c,bgFill:u=!0,solo:h=!0,...m}=e;this.code=a,this.root=t,this.miniLocations=[],this.widgets=[],this.drawTime=i,this.drawContext=o,this.onDraw=r||this.draw,this.id=s||ENe(),this.solo=h,this.drawer=new MOe((O,k,M,E)=>{const I=O.filter(D=>D.isActive(k));this.highlight(I,k),this.onDraw(O,k,E)},i),this.prebaked=c(),l&&this.drawFirstFrame(),this.repl=TG({...m,id:s,onToggle:O=>{var k;(k=m==null?void 0:m.onToggle)==null||k.call(m,O),O?(this.drawer.start(this.repl.scheduler),this.solo&&document.dispatchEvent(new CustomEvent("start-repl",{detail:this.id}))):(this.drawer.stop(),xv(this.editor,[]),T9(!0,s))},beforeEval:async()=>{var O;T9(!0,s),await this.prebaked,await((O=m==null?void 0:m.beforeEval)==null?void 0:O.call(m))},afterEval:O=>{var I,D,F;this.miniLocations=(I=O.meta)==null?void 0:I.miniLocations,this.widgets=(D=O.meta)==null?void 0:D.widgets;const k=this.widgets.filter(_=>_.type==="slider");eJ(this.editor,k);const M=this.widgets.filter(_=>_.type!=="slider");nJ(this.editor,M),xv(this.editor,this.miniLocations),(F=m==null?void 0:m.afterEval)==null||F.call(m,O);const E=O.pattern.getPainters().length?this.drawTime:[0,0];this.drawer.setDrawTime(E),this.drawer.invalidate(this.repl.scheduler)}}),this.editor=lJ({root:t,initialCode:a,onChange:O=>{var k,M;O.docChanged&&(this.code=O.state.doc.toString(),(M=(k=this.repl).setCode)==null||M.call(k,this.code))},onEvaluate:()=>this.evaluate(),onStop:()=>this.stop(),mondo:m.mondo});const f=this.root.querySelector(".cm-editor");f&&(this.root.style.display="block",u&&(this.root.style.backgroundColor="var(--background)"),f.style.backgroundColor="transparent");const v=em.get();this.setFontSize(v.fontSize),this.setFontFamily(v.fontFamily),this.onStartRepl=O=>{this.solo&&O.detail!==this.id&&this.stop()},document.addEventListener("start-repl",this.onStartRepl)}draw(e,t,s){s==null||s.forEach(a=>a(this.drawContext,t,e,this.drawTime))}async drawFirstFrame(){var e;if(this.onDraw){await this.prebaked;try{await this.repl.evaluate(this.code,!1),this.drawer.invalidate(this.repl.scheduler,-.001),(e=this.onDraw)==null||e.call(this,this.drawer.visibleHaps,-.001,this.drawer.painters)}catch{console.warn("first frame could not be painted")}}}async evaluate(){this.flash(),await this.repl.evaluate(this.code)}async stop(){this.repl.scheduler.stop()}async toggle(){this.repl.scheduler.started?this.repl.stop():this.evaluate()}flash(e){oK(this.editor,e)}highlight(e,t){lK(this.editor,t,e)}setFontSize(e){this.root.style.fontSize=e+"px"}setFontFamily(e){this.root.style.fontFamily=e;const t=this.root.querySelector(".cm-scroller");t&&(t.style.fontFamily=e)}reconfigureExtension(e,t){if(!Md[e]){console.warn(`extension ${e} is not known`);return}t=uJ(t);const s=Md[e](t,this);this.editor.dispatch({effects:CC[e].reconfigure(s)}),e==="theme"&&B5(t)}setLineWrappingEnabled(e){this.reconfigureExtension("isLineWrappingEnabled",e)}setBracketMatchingEnabled(e){this.reconfigureExtension("isBracketMatchingEnabled",e)}setLineNumbersDisplayed(e){this.reconfigureExtension("isLineNumbersDisplayed",e)}setBracketClosingEnabled(e){this.reconfigureExtension("isBracketClosingEnabled",e)}setTheme(e){this.reconfigureExtension("theme",e)}setAutocompletionEnabled(e){this.reconfigureExtension("isAutoCompletionEnabled",e)}updateSettings(e){this.setFontSize(e.fontSize),this.setFontFamily(e.fontFamily);for(let s in Md)this.reconfigureExtension(s,e[s]);const t={...em.get(),...e};em.set(t)}changeSetting(e,t){if(Md[e]){this.reconfigureExtension(e,t);return}else e==="fontFamily"?this.setFontFamily(t):e==="fontSize"&&this.setFontSize(t)}setCode(e){const t={from:0,to:this.editor.state.doc.length,insert:e};this.editor.dispatch({changes:t})}clear(){this.onStartRepl&&document.removeEventListener("start-repl",this.onStartRepl)}getCursorLocation(){return this.editor.state.selection.main.head}setCursorLocation(e){return this.editor.dispatch({selection:{anchor:e}})}appendCode(e){const t=this.getCursorLocation();this.setCode(this.code+e),this.setCursorLocation(t)}}function uJ(n){return{true:!0,false:!1}[n]??n}function ENe(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}const DNe=pe("markcss"),TNe=Object.freeze(Object.defineProperty({__proto__:null,BlockWidget:rJ,SliderWidget:JK,StrudelMirror:cJ,activateTheme:B5,addWidget:R5,codemirrorSettings:em,defaultSettings:iJ,flash:oK,flashField:rK,highlightExtension:cK,highlightMiniLocations:lK,initEditor:lJ,initTheme:KK,injectStyle:YK,isFlashEnabled:iK,isPatternHighlightingEnabled:uK,markcss:DNe,registerWidget:Jh,setFlash:Ov,setMiniLocations:S5,setSliderWidgets:$5,setWidget:aJ,settings:v1,showMiniLocations:C5,slider:ONe,sliderPlugin:tJ,sliderValues:Jd,sliderWithID:xNe,theme:HK,themeColors:gNe,themes:PC,toggleBlockComment:G3,toggleBlockCommentByLine:UU,toggleComment:Rw,toggleLineComment:qU,updateMiniLocations:xv,updateSliderWidgets:eJ,updateWidgets:nJ,widgetPlugin:oJ},Symbol.toStringTag,{value:"Module"}));async function FNe(){const n=zA(NG,gs(()=>import("./index-DwrY4rFz-3V9t-Qji.js"),__vite__mapDeps([5,1,0])),Promise.resolve().then(()=>VOe),gs(()=>import("./index-4tJ7gvaE-l2o3c6l-.js"),__vite__mapDeps([6,1,0])),Promise.resolve().then(()=>$Pe),Promise.resolve().then(()=>TNe),gs(()=>import("./hydra-CQk8qs5I-DwYIHJ7N.js"),__vite__mapDeps([7,1,0])),gs(()=>import("./index-C0UtYFVu-DuAxcpcw.js"),__vite__mapDeps([8,1,0])),gs(()=>import("./index--jEhV1EM-Dp2XHzWu.js"),__vite__mapDeps([9,1,0]))),e="https://raw.githubusercontent.com/felixroos/dough-samples/main";await Promise.all([n,fW(),vW(),gs(async()=>{const{registerSoundfonts:s}=await import("./index-C0UtYFVu-DuAxcpcw.js");return{registerSoundfonts:s}},__vite__mapDeps([8,1,0])).then(({registerSoundfonts:s})=>s()),Kc(`${e}/tidal-drum-machines.json`),Kc(`${e}/piano.json`),Kc(`${e}/Dirt-Samples.json`),Kc(`${e}/vcsl.json`),Kc(`${e}/mridangam.json`),Kc("https://raw.githubusercontent.com/tidalcycles/uzu-drumkit/main/strudel.json")]),oW("https://raw.githubusercontent.com/todepond/samples/main/tidal-drum-machines-alias.json")}const NNe=Ji("C8"),BNe=(n,e)=>n*e+(1-e)/2;dt.prototype.piano=function(){return this.fmap(n=>({...n,clip:n.clip??1})).s("piano").release(.1).fmap(n=>{const e=eL(n),t=BNe(Math.min(Math.round(e)/NNe,1),.5);return{...n,pan:(n.pan||1)*t}})};if(typeof HTMLElement<"u"){class n extends HTMLElement{constructor(){super();la(this,"settings",em.get());la(this,"editor",null);la(this,"sync",!1);la(this,"solo",!0)}attributeChangedCallback(s,a,r){var o;s==="code"&&(this.code=r,(o=this.editor)==null||o.setCode(r))}connectedCallback(){setTimeout(()=>{const o=(this.innerHTML+"").replace("<!--","").replace("-->","").trim();o&&this.setAttribute("code",o)});const s=document.createElement("div");this.parentElement.insertBefore(s,this.nextSibling);const a=jc(),r=[-2,2];this.editor=new cJ({defaultOutput:m3,getTime:()=>Xn().currentTime,transpiler:Hxe,root:s,initialCode:"// LOADING",pattern:us,drawTime:r,drawContext:a,prebake:FNe,onUpdateState:o=>{const i=new CustomEvent("update",{detail:o});this.dispatchEvent(i)},solo:this.solo,sync:this.sync}),this.editor.updateSettings(this.settings),this.editor.setCode(this.code)}}la(n,"observedAttributes",["code"]),customElements.define("strudel-editor",n)}const hJ="/api";class Rk extends Error{constructor(e,t,s){super(e),this.status=t,this.data=s}}async function Tn(n,e={}){const t=`${hJ}${n}`,s={...e,credentials:"include",headers:{"Content-Type":"application/json",...e.headers}};try{const a=await fetch(t,s),r=await a.json().catch(()=>({}));if(!a.ok)throw new Rk(r.error||"Request failed",a.status,r);return r}catch(a){throw a instanceof Rk?a:new Rk(a.message||"Network error",0,null)}}const _i={async getCurrentUser(){return Tn("/auth/me")},async logout(){return Tn("/auth/logout",{method:"POST"})},getGoogleLoginUrl(){return`${hJ}/auth/google`},async login(n,e){return Tn("/auth/login",{method:"POST",body:JSON.stringify({email:n,password:e})})},async register({email:n,password:e,name:t}){return Tn("/auth/register",{method:"POST",body:JSON.stringify({email:n,password:e,name:t})})},async verifyEmail(n){return Tn("/auth/verify-email",{method:"POST",body:JSON.stringify({token:n})})},async resendVerification(n){return Tn("/auth/resend-verification",{method:"POST",body:JSON.stringify({email:n})})},async requestPasswordReset(n){return Tn("/auth/request-password-reset",{method:"POST",body:JSON.stringify({email:n})})},async resetPassword(n,e){return Tn("/auth/reset-password",{method:"POST",body:JSON.stringify({token:n,password:e})})},async deleteAccount(){return Tn("/auth/delete-account",{method:"POST"})}},Bl={async listUsers(n="",e=50){const t=new URLSearchParams;return n&&t.append("search",n),t.append("limit",e),Tn(`/users?${t.toString()}`)},async getUser(n){return Tn(`/users/${n}`)},async updateUser(n,e){return Tn(`/users/${n}`,{method:"PUT",body:JSON.stringify(e)})},async searchUsers(n){return Tn(`/users/search/${encodeURIComponent(n)}`)},async listAdminUsers(){return Tn("/users/admin/all")},async blockUser(n){return Tn(`/users/${n}/block`,{method:"POST"})},async unblockUser(n){return Tn(`/users/${n}/unblock`,{method:"POST"})},async deleteUser(n){return Tn(`/users/${n}`,{method:"DELETE"})}},vu={async createPattern(n){return Tn("/patterns",{method:"POST",body:JSON.stringify(n)})},async getPatterns(n={}){const e=new URLSearchParams;n.type&&e.append("type",n.type),n.isPublic!==void 0&&e.append("isPublic",n.isPublic),n.shared!==void 0&&e.append("shared",n.shared);const t=e.toString();return Tn(`/patterns${t?`?${t}`:""}`)},async getPattern(n){return Tn(`/patterns/${n}`)},async updatePattern(n,e){return Tn(`/patterns/${n}`,{method:"PUT",body:JSON.stringify(e)})},async deletePattern(n){return Tn(`/patterns/${n}`,{method:"DELETE"})},async sharePattern(n,e){return Tn(`/patterns/${n}/share`,{method:"POST",body:JSON.stringify({userIds:e})})},async getPatternUsers(n){return Tn(`/patterns/${n}/users`)},async getTopTracks(n=5){const e=new URLSearchParams;return e.append("limit",n),Tn(`/patterns/top?${e.toString()}`)},async recordMasterLoad(n){if(!n)throw new Error("patternId is required");return Tn(`/patterns/${encodeURIComponent(n)}/master-load`,{method:"POST"})}},vr={async createSession(n){return Tn("/collab-sessions",{method:"POST",body:JSON.stringify({title:n})})},async getSession(n,{refresh:e=!1}={}){const t=e?"?refresh=true":"";return Tn(`/collab-sessions/${encodeURIComponent(n)}${t}`)},async getCpuStats(n){return Tn(`/collab-sessions/${encodeURIComponent(n)}/cpu`)},async joinSession(n){return Tn(`/collab-sessions/${encodeURIComponent(n)}/join`,{method:"POST"})},async leaveSession(n){return Tn(`/collab-sessions/${encodeURIComponent(n)}/leave`,{method:"POST"})},async getPendingInvites(){return Tn("/collab-sessions/invites")},async acceptInvite(n){return Tn(`/collab-sessions/invites/${encodeURIComponent(n)}/accept`,{method:"POST"})},async declineInvite(n){return Tn(`/collab-sessions/invites/${encodeURIComponent(n)}/decline`,{method:"POST"})},async listRecentSessions(){return Tn("/collab-sessions/recent")},async sendInvites(n,e){return Tn(`/collab-sessions/${encodeURIComponent(n)}/invite`,{method:"POST",body:JSON.stringify({inviteeIds:e})})},async saveChannel(n,e){return Tn(`/collab-sessions/${encodeURIComponent(n)}/channels`,{method:"POST",body:JSON.stringify(e)})},async publishChannel(n,e,t="live"){return Tn(`/collab-sessions/${encodeURIComponent(n)}/channels/${encodeURIComponent(e)}/publish`,{method:"POST",body:JSON.stringify({status:t})})},async overrideMaster(n,e){return Tn(`/collab-sessions/${encodeURIComponent(n)}/master`,{method:"POST",body:JSON.stringify({masterCode:e})})},async updateDelay(n,e){return Tn(`/collab-sessions/${encodeURIComponent(n)}/delay`,{method:"POST",body:JSON.stringify({applyDelayMs:e})})},async deleteSession(n){return Tn(`/collab-sessions/${encodeURIComponent(n)}`,{method:"DELETE"})}};async function Nh(){try{return await _i.getCurrentUser()}catch{return null}}const Cc=Object.freeze(Object.defineProperty({__proto__:null,authAPI:_i,collabAPI:vr,getCurrentUser:Nh,patternsAPI:vu,usersAPI:Bl},Symbol.toStringTag,{value:"Module"})),Ag=new Set;function iO(){const n=document.body;if(!n){setTimeout(iO,0);return}Ag.size>0?n.style.overflow="hidden":n.style.overflow=""}function Oi(n="global"){Ag.add(n),iO()}function Vo(n="global"){n?Ag.delete(n):Ag.clear(),iO()}function Eg(){Ag.clear(),iO()}class $Ne{constructor(){this.modal=null,this.onLoginSuccess=null,this.activeForm="login",this.statusEl=null}init(){this.createModal(),this.attachEventListeners(),this.checkAuthStatus()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="login-modal-overlay" id="login-modal-overlay" style="display: none;">
        <div class="login-modal">
          <div class="login-modal-header">
            <h2 class="login-logo">Sign in to Strudesk 4000</h2>
            <button class="login-modal-close" id="login-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="login-modal-body">
            <div class="login-tabs">
              <button type="button" class="login-tab active" data-auth-tab="login">Login</button>
              <button type="button" class="login-tab" data-auth-tab="signup">Create account</button>
            </div>

            <form id="login-email-form" data-auth-form="login" class="auth-form auth-form-active">
              <div class="form-group">
                <label for="login-email">Email</label>
                <input type="email" id="login-email" required placeholder="you@example.com" />
              </div>
              <div class="form-group">
                <label for="login-password">Password</label>
                <input type="password" id="login-password" required placeholder="••••••••" />
              </div>
              <button type="submit" class="btn-primary">Login</button>
              <div class="auth-links">
                <button type="button" data-show-form="reset-request">Forgot password?</button>
                <button type="button" data-show-form="verify-email">Verify email</button>
              </div>
            </form>

            <form id="signup-email-form" data-auth-form="signup" class="auth-form">
              <div class="form-group">
                <label for="signup-name">Name</label>
                <input type="text" id="signup-name" placeholder="Display name" />
              </div>
              <div class="form-group">
                <label for="signup-email">Email</label>
                <input type="email" id="signup-email" required placeholder="you@example.com" />
              </div>
              <div class="form-group">
                <label for="signup-password">Password</label>
                <input type="password" id="signup-password" required placeholder="Create a password" />
              </div>
              <button type="submit" class="btn-primary">Create account</button>
            </form>

            <form id="verify-email-form" data-auth-form="verify-email" class="auth-form">
              <div class="form-group">
                <label for="verify-token">Verification token</label>
                <input type="text" id="verify-token" placeholder="Paste token here" required />
              </div>
              <button type="submit" class="btn-primary">Verify email</button>
              <div class="auth-links">
                <button type="button" data-show-form="login">Back to login</button>
                <button type="button" data-resend-verification>Resend verification email</button>
              </div>
            </form>

            <form id="reset-request-form" data-auth-form="reset-request" class="auth-form">
              <div class="form-group">
                <label for="reset-email">Email</label>
                <input type="email" id="reset-email" required placeholder="you@example.com" />
              </div>
              <button type="submit" class="btn-primary">Send reset link</button>
              <div class="auth-links">
                <button type="button" data-show-form="reset-password">Have a reset token?</button>
                <button type="button" data-show-form="login">Back to login</button>
              </div>
            </form>

            <form id="reset-password-form" data-auth-form="reset-password" class="auth-form">
              <div class="form-group">
                <label for="reset-token">Reset token</label>
                <input type="text" id="reset-token" required placeholder="Token from email" />
              </div>
              <div class="form-group">
                <label for="reset-new-password">New password</label>
                <input type="password" id="reset-new-password" required placeholder="New password" />
              </div>
              <button type="submit" class="btn-primary">Update password</button>
              <div class="auth-links">
                <button type="button" data-show-form="login">Back to login</button>
              </div>
            </form>

            <div class="auth-status" id="login-status-message"></div>

            <div class="login-separator"><span>or</span></div>

            <div class="login-buttons">
              <button class="login-button login-button-google" id="login-google">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" aria-hidden="true">
                  <path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z" fill="#4285F4"/>
                  <path d="M9 18c2.43 0 4.467-.806 5.965-2.18l-2.908-2.258c-.806.54-1.837.86-3.057.86-2.35 0-4.34-1.587-5.053-3.72H.957v2.332C2.438 15.983 5.482 18 9 18z" fill="#34A853"/>
                  <path d="M3.947 10.712c-.18-.54-.282-1.117-.282-1.712s.102-1.172.282-1.712V4.956H.957C.348 6.174 0 7.55 0 9s.348 2.826.957 4.044l2.99-2.332z" fill="#FBBC05"/>
                  <path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.956L3.947 7.288C4.66 5.153 6.65 3.58 9 3.58z" fill="#EA4335"/>
                </svg>
                Continue with Google
              </button>
            </div>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("login-modal-overlay"),this.statusEl=document.getElementById("login-status-message")}attachEventListeners(){var f;const e=document.getElementById("login-modal-close");e==null||e.addEventListener("click",()=>this.hide()),(f=this.modal)==null||f.addEventListener("click",v=>{v.target===this.modal&&this.hide()}),document.querySelectorAll("[data-auth-tab]").forEach(v=>{v.addEventListener("click",()=>{this.setActiveForm(v.dataset.authTab)})}),document.querySelectorAll("[data-show-form]").forEach(v=>{v.addEventListener("click",()=>{this.setActiveForm(v.dataset.showForm)})});const t=document.querySelector("[data-resend-verification]");t==null||t.addEventListener("click",async()=>{var O,k;const v=((O=document.getElementById("signup-email"))==null?void 0:O.value)||((k=document.getElementById("login-email"))==null?void 0:k.value);if(!v){this.setStatus("Enter your email in the login or signup form first.","error");return}try{this.setStatus("Sending verification email...","info");const M=await _i.resendVerification(v);if(M!=null&&M.verificationToken){const E=document.getElementById("verify-token");E&&(E.value=M.verificationToken),this.setStatus(M.note||"Verification token sent. Use the token below.","info")}else this.setStatus("Verification email sent.","success")}catch(M){this.setStatus(M.message||"Failed to resend verification email.","error")}});const s=document.getElementById("login-email-form");s==null||s.addEventListener("submit",async v=>{var M,E;v.preventDefault();const O=(M=document.getElementById("login-email"))==null?void 0:M.value.trim(),k=(E=document.getElementById("login-password"))==null?void 0:E.value;if(!(!O||!k))try{this.setStatus("Signing in...","info");let I=null;const D=await _i.login(O,k);if(D!=null&&D.user)I=D.user;else{const{getCurrentUser:F}=await gs(async()=>{const{getCurrentUser:_}=await Promise.resolve().then(()=>Cc);return{getCurrentUser:_}},void 0);I=await F()}this.setStatus("Login successful!","success"),I&&this.onLoginSuccess?this.onLoginSuccess(I,!0):await this.checkAuthStatus(!0),this.hide()}catch(I){this.setStatus(I.message||"Login failed.","error")}});const a=document.getElementById("signup-email-form");a==null||a.addEventListener("submit",async v=>{var E,I,D,F;v.preventDefault();const O=(E=document.getElementById("signup-name"))==null?void 0:E.value.trim(),k=(I=document.getElementById("signup-email"))==null?void 0:I.value.trim(),M=(D=document.getElementById("signup-password"))==null?void 0:D.value;if(!(!k||!M))try{this.setStatus("Creating account...","info");const _=await _i.register({email:k,password:M,name:O});if(this.setActiveForm("verify-email"),document.getElementById("login-email").value=k,_!=null&&_.verificationToken){const $=document.getElementById("verify-token");$&&($.value=_.verificationToken),this.setStatus(_.note||"Account created! Use the verification token below.","info")}else this.setStatus("Account created! Check your email for verification token.","success"),(F=document.getElementById("verify-token"))==null||F.focus()}catch(_){this.setStatus(_.message||"Registration failed.","error")}});const r=document.getElementById("verify-email-form");r==null||r.addEventListener("submit",async v=>{var k;v.preventDefault();const O=(k=document.getElementById("verify-token"))==null?void 0:k.value.trim();if(O)try{this.setStatus("Verifying...","info");const M=await _i.verifyEmail(O);this.setStatus("Email verified! You can now log in.","success"),M!=null&&M.user?(await this.checkAuthStatus(!0),this.hide()):this.setActiveForm("login")}catch(M){this.setStatus(M.message||"Verification failed.","error")}});const o=document.getElementById("reset-request-form");o==null||o.addEventListener("submit",async v=>{var k;v.preventDefault();const O=(k=document.getElementById("reset-email"))==null?void 0:k.value.trim();if(O)try{this.setStatus("Sending reset link...","info"),await _i.requestPasswordReset(O),this.setStatus("Reset instructions sent (check server log in dev).","success")}catch(M){this.setStatus(M.message||"Failed to send reset email.","error")}});const i=document.getElementById("reset-password-form");i==null||i.addEventListener("submit",async v=>{var M,E;v.preventDefault();const O=(M=document.getElementById("reset-token"))==null?void 0:M.value.trim(),k=(E=document.getElementById("reset-new-password"))==null?void 0:E.value;if(!(!O||!k))try{this.setStatus("Updating password...","info"),await _i.resetPassword(O,k),this.setStatus("Password updated. You can now log in.","success"),this.setActiveForm("login")}catch(I){this.setStatus(I.message||"Failed to update password.","error")}});const l=document.getElementById("login-google");l==null||l.addEventListener("click",async()=>{window.location.href=_i.getGoogleLoginUrl()});const c=new URLSearchParams(window.location.search),u=c.get("auth"),h=()=>{Eg()},m=()=>{this.modal&&this.modal.style.display!=="none"?this.hide():h()};if(u==="success"){setTimeout(async()=>{console.log("🔍 Checking auth status after Google login redirect..."),await this.checkAuthStatus(!0)?(console.log("✅ Auth check successful after Google login"),m()):(console.log("⚠️ First auth check failed, retrying..."),setTimeout(async()=>{await this.checkAuthStatus(!0)?(console.log("✅ Auth check successful after Google login (retry)"),m()):(console.error("❌ Auth check failed after retry - session may not be set"),this.show(),this.setStatus("Login successful but session not established. Please refresh the page.","error"))},1e3))},500);const v=`${window.location.origin}${window.location.pathname}${window.location.hash}`;window.history.replaceState({},document.title,v)}else if(u==="error"){const v=c.get("message")||"Authentication failed";this.show(),this.setStatus(v,"error");const O=`${window.location.origin}${window.location.pathname}${window.location.hash}`;window.history.replaceState({},document.title,O)}}setActiveForm(e){this.activeForm=e,document.querySelectorAll(".auth-form").forEach(t=>{t.classList.toggle("auth-form-active",t.dataset.authForm===e)}),document.querySelectorAll("[data-auth-tab]").forEach(t=>{t.classList.toggle("active",t.dataset.authTab===e)}),this.clearStatus()}setStatus(e,t="info"){this.statusEl&&(this.statusEl.textContent=e,this.statusEl.dataset.statusType=t)}clearStatus(){this.statusEl&&(this.statusEl.textContent="",this.statusEl.dataset.statusType="")}async checkAuthStatus(e=!1){try{const{getCurrentUser:t}=await gs(async()=>{const{getCurrentUser:a}=await Promise.resolve().then(()=>Cc);return{getCurrentUser:a}},void 0),s=await t();return s&&this.onLoginSuccess?(this.onLoginSuccess(s,e),!0):!!s}catch(t){return e&&this.setStatus(t.message||"Authentication failed.","error"),!1}}show(){this.modal&&(this.setActiveForm("login"),this.modal.style.display="flex",Oi("login-modal"))}hide(){this.modal&&(this.modal.style.display="none",Vo("login-modal"),this.clearStatus())}setOnLoginSuccess(e){this.onLoginSuccess=e}}class RNe{constructor(){this.modal=null,this.user=null,this.onUpdate=null}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="user-profile-modal-overlay" id="user-profile-modal-overlay" style="display: none;">
        <div class="user-profile-modal">
          <div class="user-profile-modal-header">
            <h2>Edit Profile</h2>
            <button class="user-profile-modal-close" id="user-profile-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="user-profile-modal-body">
            <form id="user-profile-form">
              <div class="form-group" id="profile-avatar-group">
                <label for="profile-avatar-url">Profile Image</label>
                <div class="avatar-preview-container">
                  <img id="profile-avatar-preview" src="" alt="Avatar preview" style="display: none; width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin-bottom: 10px; border: 2px solid #ddd;" />
                  <input type="url" id="profile-avatar-url" placeholder="https://example.com/your-image.jpg" />
                  <small id="profile-avatar-note">Enter a URL to your profile image</small>
                  <small id="profile-avatar-provider-note" style="display: none;">Your profile image is managed by Google and can be changed from your Google Account.</small>
                </div>
              </div>

              <div class="form-group">
                <label for="profile-artist-name">Artist Name (Pseudonym)</label>
                <input type="text" id="profile-artist-name" placeholder="Your artist name or pseudonym" />
                <small>This will be used as the default copyright holder for your patterns</small>
              </div>

              <div class="form-group">
                <label>Social Media Links</label>
                <div class="social-links-grid">
                  <div class="social-link-item">
                    <label for="social-twitter">Twitter/X</label>
                    <input type="url" id="social-twitter" placeholder="https://twitter.com/username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-facebook">Meta/Facebook</label>
                    <input type="url" id="social-facebook" placeholder="https://facebook.com/username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-instagram">Instagram</label>
                    <input type="url" id="social-instagram" placeholder="https://instagram.com/username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-soundcloud">SoundCloud</label>
                    <input type="url" id="social-soundcloud" placeholder="https://soundcloud.com/username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-bandcamp">Bandcamp</label>
                    <input type="url" id="social-bandcamp" placeholder="https://username.bandcamp.com" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-youtube">YouTube</label>
                    <input type="url" id="social-youtube" placeholder="https://youtube.com/@username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-spotify">Spotify</label>
                    <input type="url" id="social-spotify" placeholder="https://open.spotify.com/artist/..." />
                  </div>
                  <div class="social-link-item">
                    <label for="social-website">Website</label>
                    <input type="url" id="social-website" placeholder="https://yourwebsite.com" />
                  </div>
                </div>
              </div>

              <div class="form-group">
                <div class="user-profile-info">
                  <p><strong>Display Name:</strong> <span id="profile-display-name"></span></p>
                  <p><strong>Joined:</strong> <span id="profile-display-joined"></span></p>
                </div>
              </div>

              <div class="user-profile-optional">
                <div class="user-profile-optional-header">
                  <h3>Personal details (optional)</h3>
                  <p>These details stay private and help us personalize your experience.</p>
                </div>
                <div class="user-profile-optional-grid">
                  <div class="form-group user-profile-email-field">
                    <label>Email</label>
                    <div class="user-profile-email" id="profile-email-display">—</div>
                  </div>
                  <div class="form-group user-profile-birthdate-field">
                    <label for="profile-birth-date">Birth date</label>
                    <input type="date" id="profile-birth-date" />
                  </div>
                  <div class="form-group user-profile-first-name">
                    <label for="profile-first-name">First name</label>
                    <input type="text" id="profile-first-name" placeholder="First name" />
                  </div>
                  <div class="form-group user-profile-last-name">
                    <label for="profile-last-name">Last name</label>
                    <input type="text" id="profile-last-name" placeholder="Last name" />
                  </div>
                  <div class="form-group">
                    <label for="profile-city">City</label>
                    <input type="text" id="profile-city" placeholder="City" />
                  </div>
                  <div class="form-group">
                    <label for="profile-country">Country</label>
                    <input type="text" id="profile-country" placeholder="Country" />
                  </div>
                </div>
              </div>

              <div class="user-profile-modal-footer">
                <button
                  type="button"
                  class="user-profile-footer-btn user-profile-footer-btn--danger"
                  id="profile-delete-account-btn"
                >Delete Account</button>
                <button
                  type="button"
                  class="user-profile-footer-btn user-profile-footer-btn--neutral"
                  id="profile-cancel-btn"
                >Cancel</button>
                <button
                  type="submit"
                  class="user-profile-footer-btn user-profile-footer-btn--primary"
                  id="profile-save-btn"
                >Save Changes</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("user-profile-modal-overlay")}attachEventListeners(){const e=document.getElementById("user-profile-modal-close");e&&e.addEventListener("click",()=>this.hide());const t=document.getElementById("profile-delete-account-btn");t&&t.addEventListener("click",async()=>{if(confirm("Delete your account and all patterns? This action cannot be undone."))try{await _i.deleteAccount(),window.location.reload()}catch(r){console.error("Delete account error:",r),alert(r.message||"Failed to delete account")}});const s=document.getElementById("profile-cancel-btn");s&&s.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",r=>{r.target===this.modal&&this.hide()});const a=document.getElementById("user-profile-form");a&&a.addEventListener("submit",async r=>{r.preventDefault(),await this.saveProfile()})}async loadUserData(){try{let e=this.user;if(e?console.log("loadUserData: using existing user:",e):(e=await Nh(),console.log("loadUserData: fetched user via API:",e)),!e)throw new Error("Not authenticated");if(!e.id)throw new Error("User object missing ID");this.user=e,console.log("loadUserData: this.user set to:",this.user);let t=e;try{t=await Bl.getUser(e.id),t&&e.oauthProvider&&!t.oauthProvider&&(t.oauthProvider=e.oauthProvider),this.user=t}catch(k){console.warn("Failed to fetch full user data, using current user data:",k)}if(!this.user)throw new Error("No user data available");const s=document.getElementById("profile-avatar-url"),a=document.getElementById("profile-avatar-preview");s&&(s.value=this.user.avatarUrl||"",s.dataset.listenerAttached||(s.dataset.listenerAttached="true",s.addEventListener("input",k=>{const M=k.target.value.trim();a&&(M?(a.src=M,a.style.display="block",a.onerror=()=>{a.style.display="none"}):a.style.display="none")})),this.user.avatarUrl&&a?(a.src=this.user.avatarUrl,a.style.display="block",a.onerror=()=>{a.style.display="none"}):a&&(a.style.display="none")),this.updateAvatarFieldState();const r=document.getElementById("profile-artist-name");r&&(r.value=this.user.artistName||"");const o=document.getElementById("profile-display-name");if(o){const k=this.user.artistName||this.user.name||"Not set";o.textContent=k}const i=document.getElementById("profile-display-joined");if(i&&this.user.createdAt){const k=new Date(this.user.createdAt);i.textContent=k.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}else i&&(i.textContent="Unknown");const l=document.getElementById("profile-email-display");l&&(l.textContent=this.user.email||"Not set");const c=document.getElementById("profile-first-name");c&&(c.value=this.user.firstName||"");const u=document.getElementById("profile-last-name");u&&(u.value=this.user.lastName||"");const h=document.getElementById("profile-city");h&&(h.value=this.user.city||"");const m=document.getElementById("profile-country");m&&(m.value=this.user.country||"");const f=document.getElementById("profile-birth-date");if(f)if(this.user.birthDate){const k=new Date(this.user.birthDate);Number.isNaN(k.getTime())?f.value="":f.value=k.toISOString().split("T")[0]}else f.value="";const v=this.user.socialLinks||{};return["twitter","facebook","instagram","soundcloud","bandcamp","youtube","spotify","website"].forEach(k=>{const M=document.getElementById(`social-${k}`);M&&(M.value=v[k]||"")}),this.user}catch(e){return console.error("Error loading user data:",e),this.user||alert("Failed to load profile data: "+(e.message||"Unknown error")),this.user||null}}isAvatarManagedExternally(){var e;return((e=this.user)==null?void 0:e.oauthProvider)==="google"}updateAvatarFieldState(){var i;const e=document.getElementById("profile-avatar-group"),t=document.getElementById("profile-avatar-url"),s=document.getElementById("profile-avatar-note"),a=document.getElementById("profile-avatar-provider-note"),r=document.getElementById("profile-avatar-preview"),o=this.isAvatarManagedExternally();e&&(e.classList.toggle("is-locked",o),o?(t&&(t.disabled=!0,t.style.display="none"),s&&(s.style.display="none"),a&&(a.style.display="block"),r&&((i=this.user)!=null&&i.avatarUrl?(r.src=this.user.avatarUrl,r.style.display="block"):r.style.display="none")):(t&&(t.disabled=!1,t.style.display=""),s&&(s.style.display="block"),a&&(a.style.display="none")))}async saveProfile(){var s,a,r,o,i,l;console.log("saveProfile called, this.user =",this.user);let e;try{if(e=await Nh(),!e||!e.id){alert("Your session has expired. Please log in again."),window.location.reload();return}}catch(c){console.error("saveProfile: Failed to verify authentication:",c),alert("Your session has expired. Please log in again."),window.location.reload();return}const t=e.id;if(!this.user||this.user.id!==t)try{await this.loadUserData(),(!this.user||this.user.id!==t)&&(this.user=e)}catch(c){console.warn("saveProfile: Failed to reload user data, using current user:",c),this.user=e}if(!this.user||!this.user.id){console.error("saveProfile: User ID missing",this.user),alert("User ID missing. Please try logging in again.");return}if(this.user.id!==t){alert("You can only edit your own profile. Please refresh the page.");return}try{const c=document.getElementById("profile-avatar-url"),u=c?c.value.trim():"",h=((s=document.getElementById("profile-artist-name"))==null?void 0:s.value.trim())||null,m=((a=document.getElementById("profile-first-name"))==null?void 0:a.value.trim())||"",f=((r=document.getElementById("profile-last-name"))==null?void 0:r.value.trim())||"",v=((o=document.getElementById("profile-birth-date"))==null?void 0:o.value)||"",O=((i=document.getElementById("profile-city"))==null?void 0:i.value.trim())||"",k=((l=document.getElementById("profile-country"))==null?void 0:l.value.trim())||"",M={};["twitter","facebook","instagram","soundcloud","bandcamp","youtube","spotify","website"].forEach($=>{const Z=document.getElementById(`social-${$}`);Z&&Z.value.trim()&&(M[$]=Z.value.trim())});const I=$=>{const Z=$==null?void 0:$.trim();return Z||null};let D=null;if(v){const $=new Date(v);Number.isNaN($.getTime())||(D=$.toISOString())}const F={artistName:h,socialLinks:M,firstName:I(m),lastName:I(f),city:I(O),country:I(k),birthDate:v?D:null};this.isAvatarManagedExternally()||(F.avatarUrl=u||null);const _=await Bl.updateUser(t,F);this.user=_,this.onUpdate&&this.onUpdate(_),this.hide(),alert("Profile updated successfully!")}catch(c){console.error("Error saving profile:",c),c.status===401?(alert("Your session has expired. Please log in again."),window.location.reload()):alert("Failed to save profile: "+(c.message||"Unknown error"))}}async show(e=null){if(!this.modal){console.error("Profile modal not initialized");return}try{if(!e&&!this.user){const s=await Nh();if(!s)throw new Error("Please log in to view your profile.");this.user=s}if(e&&(this.user=e),!await this.loadUserData()&&!this.user){alert("Unable to load user profile. Please try logging in again.");return}this.modal.style.display="flex",Oi("user-profile-modal")}catch(t){console.error("Error showing profile modal:",t),this.user||alert("Failed to load profile: "+(t.message||"Unknown error"))}}hide(){this.modal&&(this.modal.style.display="none",Vo("user-profile-modal"))}setOnUpdate(e){this.onUpdate=e}}class _Ne{constructor(){this.modal=null,this.users=[],this.searchTimeout=null}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="user-profiles-modal-overlay" id="user-profiles-modal-overlay" style="display: none;">
        <div class="user-profiles-modal">
          <div class="user-profiles-modal-header">
            <h2>User Profiles</h2>
            <button class="user-profiles-modal-close" id="user-profiles-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="user-profiles-modal-body">
            <div class="profiles-search-container">
              <input 
                type="text" 
                id="profiles-search-input" 
                placeholder="Search users by name, email, or artist name..." 
                class="profiles-search-input"
              />
            </div>
            <div class="profiles-list" id="profiles-list">
              <div class="profiles-loading">Loading profiles...</div>
            </div>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("user-profiles-modal-overlay")}attachEventListeners(){const e=document.getElementById("user-profiles-modal-close");e&&e.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",s=>{s.target===this.modal&&this.hide()});const t=document.getElementById("profiles-search-input");t&&t.addEventListener("input",s=>{const a=s.target.value.trim();clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.loadUsers(a)},300)})}async loadUsers(e=""){const t=document.getElementById("profiles-list");if(t)try{t.innerHTML='<div class="profiles-loading">Loading profiles...</div>';const s=await Bl.listUsers(e,100);if(this.users=s,s.length===0){t.innerHTML='<div class="profiles-empty">No users found.</div>';return}t.innerHTML=s.map(a=>this.renderUserCard(a)).join("")}catch(s){console.error("Error loading users:",s),t.innerHTML='<div class="profiles-error">Failed to load profiles. Please try again.</div>'}}renderUserCard(e){var c;const t=e.artistName&&e.artistName.trim()||e.name||e.email||"Unnamed Artist",s=t.charAt(0).toUpperCase(),a=e.avatarUrl||"https://via.placeholder.com/80?text="+encodeURIComponent(s),r=((c=e._count)==null?void 0:c.patterns)||0,o=e.socialLinks||{},i=this.renderSocialLinks(o);let l="";return e.createdAt&&(l=`<div class="user-card-date">Joined ${new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}</div>`),`
      <div class="user-card" data-user-id="${e.id}">
        <div class="user-card-avatar">
          <img src="${a}" alt="${this.escapeHtml(t)}" onerror="this.src='https://via.placeholder.com/80?text=' + encodeURIComponent('${this.escapeHtml(s)}')" />
        </div>
        <div class="user-card-info">
          <div class="user-card-name">${this.escapeHtml(t)}</div>
          ${l}
          <div class="user-card-stats">
            <span class="user-card-patterns">${r} pattern${r!==1?"s":""}</span>
          </div>
          ${i}
        </div>
      </div>
    `}getSocialIcon(e){return{twitter:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>',facebook:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>',instagram:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>',soundcloud:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M17.707 8.274A4.36 4.36 0 0 0 13.638 6a4.35 4.35 0 0 0-.947.112 4.989 4.989 0 0 0-9.79.654A3.52 3.52 0 0 0 3.507 16H19.23a3.307 3.307 0 1 0 .558-6.632h-.013a4.33 4.33 0 0 0-2.068-1.094z"/></svg>',bandcamp:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M2.4 6h7.4l5.8 6-5.8 6H2.4l5.8-6z"/></svg>',youtube:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>',spotify:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.84-.179-.84-.66 0-.419.36-.66.78-.54 4.56 1.021 8.52 1.561 11.64 1.92.42.06.66.36.6.78zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.42 1.56-.3.421-1.02.599-1.56.3z"/></svg>',website:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM18.92 8h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"/></svg>'}[e]||'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg>'}renderSocialLinks(e){const t=[];return Object.entries(e).forEach(([s,a])=>{if(a){const r=this.getSocialIcon(s);t.push(`<a href="${this.escapeHtml(a)}" target="_blank" rel="noopener noreferrer" class="user-card-social-link" title="${s}">${r}</a>`)}}),t.length===0?"":`<div class="user-card-social">${t.join("")}</div>`}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}async show(){if(this.modal){this.modal.style.display="flex",Oi("user-profiles-modal"),await this.loadUsers();const e=document.getElementById("profiles-search-input");e&&setTimeout(()=>e.focus(),100)}}hide(){if(this.modal){this.modal.style.display="none",Vo("user-profiles-modal");const e=document.getElementById("profiles-search-input");e&&(e.value="")}}}class LNe{constructor(){this.modal=null,this.user=null,this.patterns=[],this.currentEditingId=null}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="user-submissions-modal-overlay" id="user-submissions-modal-overlay" style="display: none;">
        <div class="user-submissions-modal">
          <div class="user-submissions-modal-header">
            <h2>My Submissions</h2>
            <button class="user-submissions-modal-close" id="user-submissions-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="user-submissions-modal-body">
            <div class="user-submissions-tabs">
              <button class="user-submissions-tab active" data-tab="all">All</button>
              <button class="user-submissions-tab" data-tab="master">Tracks</button>
              <button class="user-submissions-tab" data-tab="channel">Patterns</button>
            </div>
            <div class="user-submissions-content">
              <div class="user-submissions-loading" id="user-submissions-loading" style="display: none;">
                <p>Loading your submissions...</p>
              </div>
              <div class="user-submissions-empty" id="user-submissions-empty" style="display: none;">
                <p>You haven't submitted any patterns or tracks yet.</p>
              </div>
              <div class="user-submissions-list" id="user-submissions-list"></div>
            </div>
          </div>
          <div class="user-submissions-modal-footer">
            <button
              type="button"
              class="user-submissions-footer-btn user-submissions-footer-btn--neutral"
              id="user-submissions-close-btn"
            >Close</button>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("user-submissions-modal-overlay")}attachEventListeners(){var a;const e=document.getElementById("user-submissions-modal-close");e&&e.addEventListener("click",()=>this.hide());const t=document.getElementById("user-submissions-close-btn");t&&t.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",r=>{r.target===this.modal&&this.hide()});const s=(a=this.modal)==null?void 0:a.querySelectorAll(".user-submissions-tab");s==null||s.forEach(r=>{r.addEventListener("click",()=>{const o=r.dataset.tab;this.switchTab(o)})})}switchTab(e){var s;const t=(s=this.modal)==null?void 0:s.querySelectorAll(".user-submissions-tab");t==null||t.forEach(a=>{a.dataset.tab===e?a.classList.add("active"):a.classList.remove("active")}),this.loadPatterns(e==="all"?null:e)}async show(e){if(e||(e=await Nh()),!e){alert("Please log in to view your submissions.");return}this.user=e,this.currentEditingId=null,this.showModal(),await this.loadPatterns()}async loadPatterns(e=null){const t=document.getElementById("user-submissions-loading"),s=document.getElementById("user-submissions-empty"),a=document.getElementById("user-submissions-list");t&&(t.style.display="block"),s&&(s.style.display="none"),a&&(a.innerHTML="");try{const r={};e&&(r.type=e);let o=await vu.getPatterns(r);o=o.filter(i=>i.userId===this.user.id),this.patterns=o,t&&(t.style.display="none"),o.length===0?(s&&(s.style.display="block"),a&&(a.innerHTML="")):(s&&(s.style.display="none"),this.renderPatterns(o,a))}catch(r){console.error("Error loading patterns:",r),t&&(t.style.display="none"),a&&(a.innerHTML=`<p class="user-submissions-error">Error loading submissions: ${r.message||"Unknown error"}</p>`)}}renderPatterns(e,t){t&&(t.innerHTML="",e.forEach(s=>{const a=this.createPatternElement(s);t.appendChild(a)}))}createPatternElement(e){const t=document.createElement("div");t.className="user-submission-item",t.dataset.patternId=e.id;const s=this.currentEditingId===e.id,a=new Date(e.createdAt).toLocaleDateString(),r=new Date(e.updatedAt).toLocaleDateString(),o=e.type==="master"?"Track":"Pattern",i=e.isPublic?"Public":"Private";t.innerHTML=`
      <div class="user-submission-header">
        <div class="user-submission-info">
          <h3 class="user-submission-title">${e.title||"Untitled"} <span class="user-submission-type">${o}</span></h3>
          <div class="user-submission-meta">
            <span class="user-submission-date">Created: ${a}</span>
            <span class="user-submission-date">Updated: ${r}</span>
            <span class="user-submission-visibility">${i}</span>
            ${e.version>1?`<span class="user-submission-version">v${e.version}</span>`:""}
            ${e.versionName?`<span class="user-submission-version-name">${e.versionName}</span>`:""}
          </div>
        </div>
        <div class="user-submission-actions">
          ${s?`
            <button class="user-submission-btn user-submission-btn--save" data-action="save" data-pattern-id="${e.id}">Save</button>
            <button class="user-submission-btn user-submission-btn--cancel" data-action="cancel" data-pattern-id="${e.id}">Cancel</button>
          `:`
            <button class="user-submission-btn user-submission-btn--edit" data-action="edit" data-pattern-id="${e.id}">Edit</button>
            <button class="user-submission-btn user-submission-btn--delete" data-action="delete" data-pattern-id="${e.id}">Delete</button>
          `}
        </div>
      </div>
      ${s?this.createEditForm(e):this.createViewContent(e)}
    `;const l=t.querySelector('[data-action="edit"]'),c=t.querySelector('[data-action="delete"]'),u=t.querySelector('[data-action="save"]'),h=t.querySelector('[data-action="cancel"]');return l&&l.addEventListener("click",()=>this.startEdit(e.id)),c&&c.addEventListener("click",()=>this.deletePattern(e.id)),u&&u.addEventListener("click",()=>this.savePattern(e.id)),h&&h.addEventListener("click",()=>this.cancelEdit(e.id)),t}createViewContent(e){let t=e.patternCode||"";const s=t.split(`
`);let a=0;for(let r=0;r<s.length;r++)if(s[r].trim().startsWith("// Pattern code:")){a=r+1,a<s.length&&s[a].trim()===""&&a++;break}return a>0&&(t=s.slice(a).join(`
`).trim()),`
      <div class="user-submission-content">
        <div class="user-submission-field">
          <label>Title:</label>
          <div class="user-submission-value">${e.title||"Untitled"}</div>
        </div>
        ${e.artistName?`
          <div class="user-submission-field">
            <label>Artist:</label>
            <div class="user-submission-value">${e.artistName}</div>
          </div>
        `:""}
        ${e.genre?`
          <div class="user-submission-field">
            <label>Genre:</label>
            <div class="user-submission-value">${e.genre}</div>
          </div>
        `:""}
        <div class="user-submission-field">
          <label>Pattern Code:</label>
          <pre class="user-submission-code">${this.escapeHtml(t.substring(0,200))}${t.length>200?"...":""}</pre>
        </div>
      </div>
    `}createEditForm(e){let t=e.patternCode||"";const s=t.split(`
`);let a=0;for(let r=0;r<s.length;r++)if(s[r].trim().startsWith("// Pattern code:")){a=r+1,a<s.length&&s[a].trim()===""&&a++;break}return a>0&&(t=s.slice(a).join(`
`).trim()),`
      <div class="user-submission-edit-form">
        <div class="user-submission-edit-field">
          <label for="edit-title-${e.id}">Title:</label>
          <input type="text" id="edit-title-${e.id}" value="${this.escapeHtml(e.title||"")}" />
        </div>
        ${e.type==="master"?`
          <div class="user-submission-edit-field">
            <label for="edit-genre-${e.id}">Genre:</label>
            <input type="text" id="edit-genre-${e.id}" value="${this.escapeHtml(e.genre||"")}" />
          </div>
        `:""}
        <div class="user-submission-edit-field">
          <label for="edit-isPublic-${e.id}">Visibility:</label>
          <select id="edit-isPublic-${e.id}">
            <option value="true" ${e.isPublic?"selected":""}>Public</option>
            <option value="false" ${e.isPublic?"":"selected"}>Private</option>
          </select>
        </div>
        <div class="user-submission-edit-field">
          <label for="edit-code-${e.id}">Pattern Code:</label>
          <textarea id="edit-code-${e.id}" rows="8" class="user-submission-code-input">${this.escapeHtml(t)}</textarea>
        </div>
      </div>
    `}startEdit(e){this.currentEditingId=e,this.loadPatterns()}cancelEdit(e){this.currentEditingId=null,this.loadPatterns()}async savePattern(e){const t=this.patterns.find(v=>v.id===e);if(!t)return;const s=document.getElementById(`edit-title-${e}`),a=document.getElementById(`edit-code-${e}`),r=document.getElementById(`edit-isPublic-${e}`),o=document.getElementById(`edit-genre-${e}`);if(!s||!a||!r){alert("Error: Form elements not found");return}const i=s.value.trim();let l=a.value.trim();const c=r.value==="true",u=o?o.value.trim():null;if(!l){alert("Pattern code cannot be empty");return}const h=l.split(`
`);let m=0,f=h.length;for(let v=0;v<h.length;v++){const O=h[v].trim();if(!(O.startsWith("//")||O==="")){m=v;break}}for(let v=h.length-1;v>=m;v--){const O=h[v].trim();if(!(O===""||O.startsWith("//"))){f=v+1;break}}l=h.slice(m,f).join(`
`).trim();try{const v=this.formatPatternWithMetadata({patternCode:l,title:i,artistName:t.artistName,version:t.version,versionName:t.versionName}),O={title:i||null,patternCode:v,isPublic:c,...t.type==="master"&&u!==null?{genre:u}:{}};await vu.updatePattern(e,O),this.currentEditingId=null,await this.loadPatterns()}catch(v){console.error("Error saving pattern:",v),alert(`Error saving pattern: ${v.message||"Unknown error"}`)}}async deletePattern(e){const t=this.patterns.find(a=>a.id===e);if(!t)return;const s=t.title||"Untitled";if(confirm(`Are you sure you want to delete "${s}"? This action cannot be undone.`))try{await vu.deletePattern(e),await this.loadPatterns()}catch(a){console.error("Error deleting pattern:",a),alert(`Error deleting pattern: ${a.message||"Unknown error"}`)}}formatPatternWithMetadata({patternCode:e,title:t,artistName:s,version:a,versionName:r}){const o=[];return t&&s?o.push(`// "${t}" @by ${s}`):t&&o.push(`// "${t}"`),a&&o.push(`// @version ${a}`),s&&o.push(`// @copyright ${s}`),o.push(""),o.push(e),o.push(""),o.push("// Made with Strudesk 4000 by eKommissar."),o.join(`
`)}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}showModal(){this.modal&&(this.modal.style.display="flex",Oi())}hide(){this.modal&&(this.modal.style.display="none",Vo()),this.currentEditingId=null}}class INe{constructor(){this.modal=null,this.onSave=null,this.currentPattern=null,this.patternType=null,this.elementId=null,this.selectedUsers=[]}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="save-pattern-modal-overlay" id="save-pattern-modal-overlay" style="display: none;">
        <div class="save-pattern-modal">
          <div class="save-pattern-modal-header">
            <h2 id="save-pattern-modal-title">Save Track</h2>
            <button class="save-pattern-modal-close" id="save-pattern-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="save-pattern-modal-body">
            <form id="save-pattern-form">
              <div class="form-group">
                <label for="save-pattern-title">Track Title</label>
                <input type="text" id="save-pattern-title" placeholder="e.g., My Awesome Beat" required />
              </div>

              <div class="form-group">
                <label for="save-pattern-artist">Artist Name</label>
                <input type="text" id="save-pattern-artist" placeholder="Leave empty to use your default artist name" required />
                <small>Override your default artist name for this track</small>
              </div>

              <div class="form-group" id="save-pattern-image-group">
                <label for="save-pattern-image">Cover Image URL (optional)</label>
                <input type="url" id="save-pattern-image" placeholder="https://example.com/cover.jpg" />
                <small>Shown in the Top Tracks section when shared</small>
              </div>

              <div class="form-group">
                <label for="save-pattern-version-name">Version Name (optional)</label>
                <input type="text" id="save-pattern-version-name" placeholder="e.g., Remix, Live, Studio" />
                <small>Add a label to this version (version number is automatic)</small>
              </div>

              <div class="form-group" id="save-pattern-genre-group" style="display: none;">
                <label for="save-pattern-genre">Genre/Style (optional)</label>
                <select id="save-pattern-genre">
                  <option value="">Select a genre...</option>
                  <optgroup label="Electronic">
                    <option value="Techno">Techno</option>
                    <option value="House">House</option>
                    <option value="Trance">Trance</option>
                    <option value="Dubstep">Dubstep</option>
                    <option value="Drum & Bass">Drum & Bass</option>
                    <option value="Ambient">Ambient</option>
                    <option value="IDM">IDM</option>
                    <option value="Electro">Electro</option>
                    <option value="Synthwave">Synthwave</option>
                    <option value="Industrial">Industrial</option>
                  </optgroup>
                  <optgroup label="Hip Hop & Urban">
                    <option value="Hip Hop">Hip Hop</option>
                    <option value="Trap">Trap</option>
                    <option value="R&B">R&B</option>
                    <option value="Grime">Grime</option>
                    <option value="Drill">Drill</option>
                  </optgroup>
                  <optgroup label="Rock & Alternative">
                    <option value="Rock">Rock</option>
                    <option value="Alternative">Alternative</option>
                    <option value="Indie">Indie</option>
                    <option value="Punk">Punk</option>
                    <option value="Metal">Metal</option>
                    <option value="Post-Rock">Post-Rock</option>
                  </optgroup>
                  <optgroup label="Jazz & Blues">
                    <option value="Jazz">Jazz</option>
                    <option value="Blues">Blues</option>
                    <option value="Smooth Jazz">Smooth Jazz</option>
                    <option value="Bebop">Bebop</option>
                    <option value="Fusion">Fusion</option>
                  </optgroup>
                  <optgroup label="World & Folk">
                    <option value="World">World</option>
                    <option value="Folk">Folk</option>
                    <option value="Traditional">Traditional</option>
                    <option value="Ethnic">Ethnic</option>
                  </optgroup>
                  <optgroup label="Pop & Dance">
                    <option value="Pop">Pop</option>
                    <option value="Dance">Dance</option>
                    <option value="EDM">EDM</option>
                    <option value="Disco">Disco</option>
                    <option value="Funk">Funk</option>
                  </optgroup>
                  <optgroup label="Experimental">
                    <option value="Experimental">Experimental</option>
                    <option value="Noise">Noise</option>
                    <option value="Avant-garde">Avant-garde</option>
                    <option value="Minimal">Minimal</option>
                  </optgroup>
                  <optgroup label="Other">
                    <option value="Cinematic">Cinematic</option>
                    <option value="Game Music">Game Music</option>
                    <option value="Other">Other</option>
                  </optgroup>
                </select>
                <small>Select a genre to help with pattern matching and discovery</small>
              </div>

              <div class="form-group">
                <label class="privacy-toggle-label">
                  <input type="checkbox" id="save-pattern-public" />
                  <span>Make this track public</span>
                </label>
                <small>Public patterns can be seen and used by all users</small>
              </div>

              <div class="form-group" id="save-pattern-share-group" style="display: none;">
                <label>Share with specific users (optional)</label>
                <div class="user-search-container">
                  <input type="text" id="save-pattern-user-search" placeholder="Search users by name or email..." />
                  <div class="user-search-results" id="save-pattern-user-results"></div>
                </div>
                <div class="selected-users" id="save-pattern-selected-users"></div>
              </div>

              <div class="save-pattern-modal-footer">
                <button type="button" class="btn-cancel" id="save-pattern-cancel-btn">Cancel</button>
                <button type="submit" class="btn-save" id="save-pattern-save-btn">Save Track</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("save-pattern-modal-overlay")}attachEventListeners(){const e=document.getElementById("save-pattern-modal-close");e&&e.addEventListener("click",()=>this.hide());const t=document.getElementById("save-pattern-cancel-btn");t&&t.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",i=>{i.target===this.modal&&this.hide()});const s=document.getElementById("save-pattern-form");s&&s.addEventListener("submit",async i=>{i.preventDefault(),await this.savePattern()});const a=document.getElementById("save-pattern-public"),r=document.getElementById("save-pattern-share-group");a&&r&&a.addEventListener("change",i=>{i.target.checked?(r.style.display="none",this.selectedUsers=[],this.updateSelectedUsers()):r.style.display="block"});const o=document.getElementById("save-pattern-user-search");if(o){let i;o.addEventListener("input",l=>{clearTimeout(i);const c=l.target.value.trim();c.length>=2?i=setTimeout(()=>this.searchUsers(c),300):this.clearUserSearchResults()})}}async searchUsers(e){try{const{usersAPI:t}=await gs(async()=>{const{usersAPI:a}=await Promise.resolve().then(()=>Cc);return{usersAPI:a}},void 0),s=await t.searchUsers(e);this.displayUserSearchResults(s)}catch(t){console.error("Error searching users:",t)}}displayUserSearchResults(e){const t=document.getElementById("save-pattern-user-results");if(t){if(e.length===0){t.innerHTML='<div class="user-search-no-results">No users found</div>';return}t.innerHTML=e.filter(s=>!this.selectedUsers.find(a=>a.id===s.id)).map(s=>`
        <div class="user-search-result-item" data-user-id="${s.id}">
          <img src="${s.avatarUrl||""}" alt="${s.name}" class="user-search-avatar" onerror="this.style.display='none'">
          <div class="user-search-result-info">
            <div class="user-search-result-name">${s.name}</div>
            <div class="user-search-result-email">${s.email}</div>
          </div>
          <button type="button" class="user-search-add-btn">Add</button>
        </div>
      `).join(""),t.querySelectorAll(".user-search-result-item").forEach(s=>{const a=s.querySelector(".user-search-add-btn"),r=s.dataset.userId,o=e.find(i=>i.id===r);a&&o&&a.addEventListener("click",()=>{this.addUserToShare(o),s.remove()})})}}clearUserSearchResults(){const e=document.getElementById("save-pattern-user-results");e&&(e.innerHTML="")}addUserToShare(e){this.selectedUsers.find(s=>s.id===e.id)||(this.selectedUsers.push(e),this.updateSelectedUsers());const t=document.getElementById("save-pattern-user-search");t&&(t.value=""),this.clearUserSearchResults()}removeUserFromShare(e){this.selectedUsers=this.selectedUsers.filter(t=>t.id!==e),this.updateSelectedUsers()}updateSelectedUsers(){const e=document.getElementById("save-pattern-selected-users");if(e){if(this.selectedUsers.length===0){e.innerHTML="";return}e.innerHTML=this.selectedUsers.map(t=>`
      <div class="selected-user-item">
        <img src="${t.avatarUrl||""}" alt="${t.name}" class="selected-user-avatar" onerror="this.style.display='none'">
        <span class="selected-user-name">${t.name}</span>
        <button type="button" class="selected-user-remove" data-user-id="${t.id}">&times;</button>
      </div>
    `).join(""),e.querySelectorAll(".selected-user-remove").forEach(t=>{t.addEventListener("click",()=>{this.removeUserFromShare(t.dataset.userId)})})}}async show(e,t,s=null){var f,v,O,k;if(!this.modal)return;this.currentPattern=e,this.patternType=t,this.elementId=s,this.selectedUsers=[];const a=t==="master",r=document.getElementById("save-pattern-modal-title"),o=document.getElementById("save-pattern-save-btn");r&&(r.textContent=a?"Save Track":"Save Pattern"),o&&(o.textContent=a?"Save Track":"Save Pattern");const i=document.getElementById("save-pattern-title"),l=document.getElementById("save-pattern-artist"),c=document.getElementById("save-pattern-image-group"),u=document.getElementById("save-pattern-image");i&&(i.required=a,i.placeholder=a?"Enter track title":"e.g., My Awesome Beat"),l&&(l.required=a,l.placeholder=a?"Enter artist name":"Leave empty to use your default artist name"),c&&(c.style.display=a?"block":"none");const h=document.getElementById("save-pattern-genre-group");h&&(h.style.display=a?"block":"none"),(f=document.getElementById("save-pattern-title"))!=null&&f.value&&(document.getElementById("save-pattern-title").value=""),(v=document.getElementById("save-pattern-artist"))!=null&&v.value&&(document.getElementById("save-pattern-artist").value=""),(O=document.getElementById("save-pattern-version-name"))!=null&&O.value&&(document.getElementById("save-pattern-version-name").value=""),u&&(u.value="");const m=document.getElementById("save-pattern-genre");m&&(m.value=""),(k=document.getElementById("save-pattern-public"))!=null&&k.checked&&(document.getElementById("save-pattern-public").checked=!1),this.updateSelectedUsers(),this.clearUserSearchResults(),this.modal.style.display="flex",Oi("save-pattern-dialog")}hide(){this.modal&&(this.modal.style.display="none",Vo("save-pattern-dialog"))}async savePattern(){var e,t,s,a,r,o;if(!this.currentPattern){alert("No pattern to save");return}try{if(!await Nh()){alert("Please log in to save patterns");return}const l=((e=document.getElementById("save-pattern-title"))==null?void 0:e.value.trim())||null,c=((t=document.getElementById("save-pattern-artist"))==null?void 0:t.value.trim())||null,u=((s=document.getElementById("save-pattern-version-name"))==null?void 0:s.value.trim())||null,h=((a=document.getElementById("save-pattern-genre"))==null?void 0:a.value.trim())||null,m=((r=document.getElementById("save-pattern-public"))==null?void 0:r.checked)||!1,f=((o=document.getElementById("save-pattern-image"))==null?void 0:o.value.trim())||null;if(this.patternType==="master"){if(!l){alert("Track title is required.");return}if(!c){alert("Artist name is required.");return}}let v=this.currentPattern;const O=v.split(`
`);let k=0,M=O.length;for(let $=0;$<O.length;$++)if(O[$].trim()===""&&$>0&&O[$-1].trim().startsWith("//")){k=$+1;break}for(let $=O.length-1;$>=0;$--)if(O[$].includes("Made with Strudesk 4000")){M=$;break}v=O.slice(k,M).join(`
`).trim();let E=v,I="";for(;I!==E;)I=E,E=E.replace(/\.postgain\s*\([^)]*\)/gi,"");E=E.replace(/\.pan\s*\([^)]*\)/gi,""),E=E.replace(/\.fast\s*\([^)]*\)/gi,""),E=E.replace(/\.slow\s*\([^)]*\)/gi,""),E=E.replace(/\.cpm\s*\([^)]*\)/gi,""),E=E.replace(/\.\.+/g,".").trim(),E=E.replace(/\.+$/,"").trim(),E=E.replace(/\s+\./g,".");const D={};f&&(D.imageUrl=f);const F={type:this.patternType,elementId:this.elementId,patternCode:E,title:l,artistName:c,versionName:u,genre:this.patternType==="master"?h:null,isPublic:m,metadata:Object.keys(D).length?D:void 0},_=await vu.createPattern(F);!m&&this.selectedUsers.length>0&&await vu.sharePattern(_.id,this.selectedUsers.map($=>$.id)),this.onSave&&this.onSave(_),this.hide(),alert(this.patternType==="master"?"Track saved successfully!":"Pattern saved successfully!")}catch(i){console.error("Error saving pattern:",i),alert("Failed to save pattern: "+(i.message||"Unknown error"))}}setOnSave(e){this.onSave=e}}const f0={superpiano:"piano",wood:"jazz"},uf=["sine","square","triangle","sawtooth","supersaw","pulse"],md=["piano","supersaw","gtr","casio","jazz","metal","folkharp"],dJ=Object.keys(f0),_5=[{value:"RolandTR808",label:"Roland TR-808"},{value:"RolandTR909",label:"Roland TR-909"},{value:"RolandTR707",label:"Roland TR-707"},{value:"RhythmAce",label:"Rhythm Ace"},{value:"AkaiLinn",label:"Akai Linn"},{value:"ViscoSpaceDrum",label:"Visco Space Drum"},{value:"CasioRZ1",label:"Casio RZ-1"}],Ri=new Set(_5.map(n=>n.value)),QNe=[{value:"sine",label:"Sine"},{value:"square",label:"Square"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"supersaw",label:"Supersaw"},{value:"pulse",label:"Pulse"}],VNe=[{value:"piano",label:"Piano"},{value:"supersaw",label:"Saw Synth"},{value:"gtr",label:"Guitar"},{value:"casio",label:"Casio"},{value:"jazz",label:"Jazz"},{value:"metal",label:"Metal"},{value:"folkharp",label:"Folk Harp"}];_5.reduce((n,e)=>(n[e.value]=e.label,n),{});const mJ=[{group:"Drums",options:_5},{group:"Basic Waveforms",options:QNe},{group:"Sample-based Synths",options:VNe}],jNe=new Set(mJ.flatMap(n=>n.options).map(n=>n.value)),Mv="vcsl:",Ad=n=>{if(!n||typeof n!="string")return{rawValue:"",bankValue:"",isVcslInstrument:!1,vcslInstrument:""};if(n.startsWith(Mv)){const e=n.slice(Mv.length);return{rawValue:n,bankValue:"vcsl",isVcslInstrument:!0,vcslInstrument:e}}return{rawValue:n,bankValue:n,isVcslInstrument:!1,vcslInstrument:""}},$l={cutoff:{id:"cutoff",label:"Filter Cutoff (Hz)",description:"Maps the X or Y axis to the master filter cutoff frequency.",defaultMin:80,defaultMax:8e3,defaultValue:2400,unit:"Hz",step:10},resonance:{id:"resonance",label:"Filter Resonance (Q)",description:"Controls the resonance (Q) of the master filter.",defaultMin:.1,defaultMax:5,defaultValue:.8,unit:"Q",step:.1},volume:{id:"volume",label:"Master Volume",description:"Adjusts the global master volume.",defaultMin:0,defaultMax:1,defaultValue:.7,unit:"",step:.01},pan:{id:"pan",label:"Master Pan",description:"Moves the master output left or right.",defaultMin:-1,defaultMax:1,defaultValue:0,unit:"",step:.01},delayAmount:{id:"delayAmount",label:"Delay Amount",description:"Controls the amount/wet level of the delay effect.",defaultMin:0,defaultMax:1,defaultValue:0,unit:"",step:.01},delayFeedback:{id:"delayFeedback",label:"Delay Feedback",description:"Controls the feedback level of the delay effect.",defaultMin:0,defaultMax:1,defaultValue:.5,unit:"",step:.01},reverbAmount:{id:"reverbAmount",label:"Reverb Amount",description:"Controls the amount/wet level of the reverb effect.",defaultMin:0,defaultMax:5,defaultValue:0,unit:"",step:.01},reverbRoomSize:{id:"reverbRoomSize",label:"Reverb Room Size",description:"Controls the room size of the reverb effect.",defaultMin:0,defaultMax:4,defaultValue:.5,unit:"",step:.01}},ZNe=Object.values($l),Dg={x:{effect:"cutoff",min:$l.cutoff.defaultMin,max:$l.cutoff.defaultMax},y:{effect:"resonance",min:$l.resonance.defaultMin,max:$l.resonance.defaultMax}},pJ="strudesk_settings_v1",zNe=new Set(["animated","solid","image"]),qh={sampleBanks:{hidden:[]},chaospad:{axes:structuredClone(Dg)},styling:{backgroundType:"animated",backgroundColor:"#05060a",backgroundImage:""}};let Wi=GNe();const Av=new Set;function GNe(){try{const n=typeof localStorage<"u"?localStorage.getItem(pJ):null;if(!n)return structuredClone(qh);const e=JSON.parse(n);return gJ(e)}catch(n){return console.warn("⚠️ Unable to read settings from storage, using defaults:",n),structuredClone(qh)}}function fJ(){if(!(typeof localStorage>"u"))try{localStorage.setItem(pJ,JSON.stringify(Wi))}catch(n){console.warn("⚠️ Unable to persist settings:",n)}}function L5(n,e){return typeof e!="object"||e===null||Object.keys(e).forEach(t=>{const s=e[t];if(Array.isArray(s)){n[t]=Array.from(s);return}if(s&&typeof s=="object"){n[t]=L5(n[t]?{...n[t]}:{},s);return}n[t]=s}),n}function HF(n,e){const t=e||Dg.x,s=n!=null&&n.effect&&$l[n.effect]?n.effect:t.effect,a=$l[s]||$l[t.effect],r=Number.isFinite(n==null?void 0:n.min)?n.min:Number.isFinite(t==null?void 0:t.min)?t.min:a.defaultMin,o=Number.isFinite(n==null?void 0:n.max)?n.max:Number.isFinite(t==null?void 0:t.max)?t.max:a.defaultMax;let i=typeof r=="number"?r:a.defaultMin,l=typeof o=="number"?o:a.defaultMax;return l<=i&&(l=i+Math.abs(a.defaultMax-a.defaultMin)||i+1),{effect:s,min:i,max:l}}function gJ(n){var a,r,o,i,l,c,u;const e=L5(structuredClone(qh),n||{}),t=Array.isArray((a=e.sampleBanks)==null?void 0:a.hidden)?e.sampleBanks.hidden:[];e.sampleBanks.hidden=Array.from(new Set(t.filter(h=>typeof h=="string"&&jNe.has(h)))),e.chaospad.axes={x:HF((o=(r=e.chaospad)==null?void 0:r.axes)==null?void 0:o.x,Dg.x),y:HF((l=(i=e.chaospad)==null?void 0:i.axes)==null?void 0:l.y,Dg.y)};const s=(c=e.styling)==null?void 0:c.backgroundType;return zNe.has(s)||(e.styling.backgroundType=(u=e.styling)!=null&&u.disableBubbles?"solid":"animated"),e.styling.backgroundColor=e.styling.backgroundColor||qh.styling.backgroundColor,e.styling.backgroundImage=(e.styling.backgroundImage||"").trim(),"disableBubbles"in e.styling&&delete e.styling.disableBubbles,e}function _k(){return structuredClone(qh)}function YF(){return Wi}function pd(n={}){const e=L5(structuredClone(Wi),n);Wi=gJ(e),fJ(),Av.forEach(t=>t(Wi))}function bJ(n){return typeof n!="function"?()=>{}:(Av.add(n),()=>Av.delete(n))}function XNe(){Wi=structuredClone(qh),fJ(),Av.forEach(n=>n(Wi))}function O1(n,e=Wi){var s;return n?!(((s=e==null?void 0:e.sampleBanks)==null?void 0:s.hidden)||[]).includes(n):!0}function WNe(n=Wi){var e;return structuredClone(((e=n==null?void 0:n.chaospad)==null?void 0:e.axes)||Dg)}function qNe(n=Wi){return structuredClone((n==null?void 0:n.styling)||qh.styling)}function UNe(n,e){var s;if(!n)return;const t=new Set(((s=Wi.sampleBanks)==null?void 0:s.hidden)||[]);e?t.delete(n):t.add(n),pd({sampleBanks:{hidden:Array.from(t)}})}const HNe=[{value:"animated",label:"Animated bubbles"},{value:"solid",label:"Solid color"},{value:"image",label:"Background image"}];class YNe{constructor(){this.overlay=null,this.unsubscribe=null,this.isOpen=!1,this.saveStatusTimeout=null}init(){this.render(),this.attachEventListeners(),this.syncUI(YF()),this.unsubscribe=bJ(e=>this.syncUI(e))}render(){if(!this.overlay){const t=`
        <div class="settings-panel-overlay" id="settings-panel-overlay" style="display: none;">
          <div class="settings-panel" role="dialog" aria-modal="true" aria-labelledby="settings-panel-title">
            <div class="settings-panel-header">
              <div>
                <h2 id="settings-panel-title">Settings</h2>
                <p>Customize how Strudesk 4000 behaves for you.</p>
              </div>
              <div class="settings-panel-actions">
                <button type="button" class="settings-link" id="settings-reset-btn" aria-label="Reset settings to defaults">Reset</button>
                <button type="button" class="settings-save-btn" id="settings-save-btn" aria-label="Save and apply settings">Save</button>
                <button type="button" class="settings-panel-close" id="settings-panel-close" aria-label="Close settings">&times;</button>
              </div>
            </div>
            <div class="settings-panel-body">
              <section class="settings-section" id="settings-sample-banks">
                <div class="settings-section-header">
                  <div>
                    <h3>Sample Bank Visibility</h3>
                    <p>Hide the banks you never use to keep dropdowns tidy.</p>
                  </div>
                </div>
                ${this.renderSampleBankControls()}
              </section>

              <section class="settings-section" id="settings-chaospad">
                <div class="settings-section-header">
                  <div>
                    <h3>Chaospad Controls</h3>
                    <p>Pick an effect for each axis and fine-tune its response.</p>
                  </div>
                </div>
                <div class="settings-chaospad-grid">
                  ${this.renderChaospadAxisControls("x","Horizontal Axis (X)")}
                  ${this.renderChaospadAxisControls("y","Vertical Axis (Y)")}
                </div>
              </section>

              <section class="settings-section" id="settings-styling">
                <div class="settings-section-header">
                  <div>
                    <h3>Page Styling</h3>
                    <p>Switch off the animated background or bring your own visuals.</p>
                  </div>
                </div>
                <div class="settings-field settings-radio-group" role="radiogroup" aria-label="Page background mode">
                  ${HNe.map(({value:s,label:a})=>`
                    <label class="settings-radio">
                      <input type="radio" name="settings-bg-mode" value="${s}">
                      <span>${a}</span>
                    </label>
                  `).join("")}
                </div>
                <div class="settings-field">
                  <label for="settings-bg-color">Solid color</label>
                  <input type="color" id="settings-bg-color" value="#05060a">
                  <small>Applied for Solid or Image modes.</small>
                </div>
                <div class="settings-field">
                  <label for="settings-bg-image">Background image URL</label>
                  <input type="url" id="settings-bg-image" placeholder="https://example.com/texture.jpg" disabled>
                  <small>Used only when “Background image” mode is active.</small>
                </div>
              </section>
            </div>
            <div class="settings-panel-footer">
              <div class="settings-save-status" id="settings-save-status">
                <span class="settings-save-icon">✓</span>
                <span class="settings-save-text">Settings saved automatically</span>
              </div>
            </div>
          </div>
        </div>
      `;document.body.insertAdjacentHTML("beforeend",t),this.overlay=document.getElementById("settings-panel-overlay")}const e=document.getElementById("user-menu-dropdown");if(e){let t=e.querySelector("#user-settings-link");if(!t){const s=document.createElement("div");s.className="user-menu-divider",t=document.createElement("button"),t.id="user-settings-link",t.type="button",t.className="user-menu-item",t.textContent="Settings";const a=e.querySelector("#user-logout-btn");s&&a?(e.insertBefore(s,a),e.insertBefore(t,a)):(e.appendChild(s),e.appendChild(t))}t&&!t.dataset.listenerAttached&&(t.addEventListener("click",()=>{this.show(),e.classList.remove("active")}),t.dataset.listenerAttached="true")}}renderSampleBankControls(){return mJ.map(({group:e,options:t})=>`
      <div class="settings-fieldset">
        <div class="settings-fieldset-heading">
          <div>
            <h4>${e}</h4>
            <p>${t.length} banks</p>
          </div>
        </div>
        <div class="settings-checkbox-grid">
          ${t.map(s=>`
            <label class="settings-checkbox">
              <input type="checkbox" class="settings-bank-toggle" data-bank-value="${s.value}">
              <span>${s.label}</span>
            </label>
          `).join("")}
        </div>
      </div>
    `).join("")}renderChaospadAxisControls(e,t){const s=ZNe.map(a=>`<option value="${a.id}">${a.label}</option>`).join("");return`
      <div class="settings-chaospad-card" data-axis="${e}">
        <header>
          <h4>${t}</h4>
          <p>Drag ${e==="x"?"left ↔ right":"up ↕ down"} on Chaospad to control this.</p>
        </header>
        <label class="settings-input-label">
          Effect
          <select data-chaospad-effect="${e}" id="settings-chaospad-${e}-effect">
            ${s}
          </select>
        </label>
        <div class="settings-range-field">
          <label>
            Min
            <input type="number" data-chaospad-min="${e}" step="0.01">
          </label>
          <label>
            Max
            <input type="number" data-chaospad-max="${e}" step="0.01">
          </label>
        </div>
      </div>
    `}attachEventListeners(){if(!this.overlay)return;const e=this.overlay.querySelector("#settings-panel-close");e==null||e.addEventListener("click",()=>this.hide()),this.overlay.addEventListener("click",o=>{o.target===this.overlay&&this.hide()}),document.addEventListener("keydown",o=>{this.isOpen&&o.key==="Escape"&&this.hide()}),this.overlay.querySelectorAll(".settings-bank-toggle").forEach(o=>{o.addEventListener("change",i=>{const l=i.target.dataset.bankValue;UNe(l,i.target.checked),this.showSaveStatus()})}),this.overlay.querySelectorAll("[data-chaospad-effect]").forEach(o=>{o.addEventListener("change",i=>{const l=i.target.dataset.chaospadEffect,c=i.target.value,u=$l[c];pd({chaospad:{axes:{[l]:{effect:c,min:(u==null?void 0:u.defaultMin)??0,max:(u==null?void 0:u.defaultMax)??1}}}}),this.showSaveStatus()})}),this.overlay.querySelectorAll("[data-chaospad-min]").forEach(o=>{o.addEventListener("change",i=>{this.handleChaospadRangeChange(i,"min"),this.showSaveStatus()})}),this.overlay.querySelectorAll("[data-chaospad-max]").forEach(o=>{o.addEventListener("change",i=>{this.handleChaospadRangeChange(i,"max"),this.showSaveStatus()})}),this.overlay.querySelectorAll('input[name="settings-bg-mode"]').forEach(o=>{o.addEventListener("change",i=>{i.target.checked&&(pd({styling:{backgroundType:i.target.value}}),this.showSaveStatus())})});const t=this.overlay.querySelector("#settings-bg-color");t==null||t.addEventListener("input",o=>{pd({styling:{backgroundColor:o.target.value||_k().styling.backgroundColor}}),this.showSaveStatus()});const s=this.overlay.querySelector("#settings-bg-image");s==null||s.addEventListener("change",o=>{pd({styling:{backgroundImage:(o.target.value||"").trim()}}),this.showSaveStatus()});const a=this.overlay.querySelector("#settings-reset-btn");a==null||a.addEventListener("click",()=>{XNe(),this.showSaveStatus(),this.applySettings()});const r=this.overlay.querySelector("#settings-save-btn");r==null||r.addEventListener("click",()=>{this.applySettings(),this.showSaveStatus()})}handleChaospadRangeChange(e,t){var l,c;const s=e.target.dataset[`chaospad${t==="min"?"Min":"Max"}`],a=parseFloat(e.target.value);if(!s||Number.isNaN(a))return;const r=YF(),i={...((c=(l=r==null?void 0:r.chaospad)==null?void 0:l.axes)==null?void 0:c[s])||{},[t]:a};t==="min"&&i.max!==void 0&&a>i.max&&(i.max=a),t==="max"&&i.min!==void 0&&a<i.min&&(i.min=a),pd({chaospad:{axes:{[s]:i}}})}syncUI(e){var i;if(!this.overlay)return;const t=new Set(((i=e==null?void 0:e.sampleBanks)==null?void 0:i.hidden)||[]);this.overlay.querySelectorAll(".settings-bank-toggle").forEach(l=>{const c=l.dataset.bankValue;l.checked=!t.has(c)}),["x","y"].forEach(l=>{var f,v;const c=(v=(f=e==null?void 0:e.chaospad)==null?void 0:f.axes)==null?void 0:v[l];if(!c)return;const u=this.overlay.querySelector(`[data-chaospad-effect="${l}"]`),h=this.overlay.querySelector(`[data-chaospad-min="${l}"]`),m=this.overlay.querySelector(`[data-chaospad-max="${l}"]`);u&&(u.value=c.effect),h&&(h.value=c.min),m&&(m.value=c.max),this.updateChaospadAxisInputs(l,c)});const s=(e==null?void 0:e.styling)||_k().styling,a=this.overlay.querySelector(`input[name="settings-bg-mode"][value="${s.backgroundType}"]`);a&&!a.checked&&(a.checked=!0);const r=this.overlay.querySelector("#settings-bg-color");r&&(r.value=s.backgroundColor||_k().styling.backgroundColor);const o=this.overlay.querySelector("#settings-bg-image");o&&(o.value=s.backgroundImage||"",o.disabled=s.backgroundType!=="image"),r.disabled=s.backgroundType==="animated"}updateChaospadAxisInputs(e,t){var o,i;const s=$l[t.effect],a=(o=this.overlay)==null?void 0:o.querySelector(`[data-chaospad-min="${e}"]`),r=(i=this.overlay)==null?void 0:i.querySelector(`[data-chaospad-max="${e}"]`);a&&s&&(a.step=s.step??a.step,a.placeholder=s.defaultMin),r&&s&&(r.step=s.step??r.step,r.placeholder=s.defaultMax)}show(){!this.overlay||this.isOpen||(this.overlay.style.display="flex",Oi("settings-panel"),this.isOpen=!0)}hide(){!this.overlay||!this.isOpen||(this.overlay.style.display="none",Vo("settings-panel"),this.isOpen=!1)}applySettings(){typeof window<"u"&&window.dispatchEvent(new CustomEvent("settings-apply-requested"))}showSaveStatus(){var t;const e=(t=this.overlay)==null?void 0:t.querySelector("#settings-save-status");e&&(this.saveStatusTimeout&&clearTimeout(this.saveStatusTimeout),e.classList.add("settings-save-status--saved"),e.querySelector(".settings-save-text").textContent="Saved!",this.saveStatusTimeout=setTimeout(()=>{e.classList.remove("settings-save-status--saved"),e.querySelector(".settings-save-text").textContent="Settings saved automatically"},2e3))}destroy(){this.saveStatusTimeout&&(clearTimeout(this.saveStatusTimeout),this.saveStatusTimeout=null),this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.overlay&&(this.overlay.remove(),this.overlay=null)}}class KNe{constructor(){this.modal=null,this.user=null,this.onComplete=null}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="profile-onboarding-overlay" id="profile-onboarding-overlay" style="display: none;">
        <div class="profile-onboarding-modal">
          <div class="profile-onboarding-header">
            <h2>Welcome! Let's complete your profile</h2>
            <p>Tell the community who you are. These details appear on your shared patterns.</p>
          </div>
          <form id="profile-onboarding-form" class="profile-onboarding-form">
            <div class="form-group">
              <label for="onboarding-name">Display Name</label>
              <input type="text" id="onboarding-name" placeholder="Your full name" required />
            </div>
            <div class="form-group">
              <label for="onboarding-artist">Artist / Producer Name</label>
              <input type="text" id="onboarding-artist" placeholder="e.g., Neon Skyline" required />
              <small>This name is shown on saved patterns. You can change it later.</small>
            </div>
            <div class="form-group">
              <label for="onboarding-avatar">Profile Image URL (optional)</label>
              <input type="url" id="onboarding-avatar" placeholder="https://example.com/avatar.jpg" />
            </div>
            <div class="profile-onboarding-actions">
              <button type="submit" class="btn-save">Save & Continue</button>
            </div>
            <div class="profile-onboarding-status" id="profile-onboarding-status"></div>
          </form>
        </div>
      </div>
    `),this.modal=document.getElementById("profile-onboarding-overlay")}attachEventListeners(){const e=document.getElementById("profile-onboarding-form");e&&e.addEventListener("submit",async t=>{t.preventDefault(),await this.saveProfile()})}async saveProfile(){var r,o,i;if(!this.user)return;const e=document.getElementById("profile-onboarding-status"),t=(r=document.getElementById("onboarding-name"))==null?void 0:r.value.trim(),s=(o=document.getElementById("onboarding-artist"))==null?void 0:o.value.trim(),a=((i=document.getElementById("onboarding-avatar"))==null?void 0:i.value.trim())||null;if(!t||!s){e&&(e.textContent="Please fill in both required fields.");return}try{e&&(e.textContent="Saving...");const l=await Bl.updateUser(this.user.id,{name:t,artistName:s,avatarUrl:a,profileCompleted:!0});e&&(e.textContent="Profile updated!"),this.hide(),this.onComplete&&this.onComplete(l)}catch(l){console.error("Onboarding save error:",l),e&&(e.textContent=l.message||"Failed to save profile.")}}async show(e){if(this.user=e,this.modal){const t=document.getElementById("onboarding-name"),s=document.getElementById("onboarding-artist"),a=document.getElementById("onboarding-avatar"),r=document.getElementById("profile-onboarding-status");t&&(t.value=(e==null?void 0:e.name)||""),s&&(s.value=(e==null?void 0:e.artistName)||""),a&&(a.value=(e==null?void 0:e.avatarUrl)||""),r&&(r.textContent=""),this.modal.style.display="flex",Oi("profile-onboarding-modal")}}hide(){this.modal&&(this.modal.style.display="none",Vo("profile-onboarding-modal"))}setOnComplete(e){this.onComplete=e}}class JNe{constructor(){this.modal=null,this.tableBody=null,this.statusEl=null,this.users=[]}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="admin-modal-overlay" id="admin-modal-overlay" style="display:none;">
        <div class="admin-modal">
          <div class="admin-modal-header">
            <h2>User Management</h2>
            <button class="admin-modal-close" id="admin-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="admin-modal-body">
            <div class="admin-status" id="admin-status"></div>
            <div class="admin-table-wrapper">
              <table class="admin-table">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th>Created</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="admin-users-body">
                  <tr><td colspan="6">Loading users...</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("admin-modal-overlay"),this.tableBody=document.getElementById("admin-users-body"),this.statusEl=document.getElementById("admin-status")}attachEventListeners(){const e=document.getElementById("admin-modal-close");e&&e.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",t=>{t.target===this.modal&&this.hide()}),this.tableBody&&this.tableBody.addEventListener("click",async t=>{const s=t.target.closest("[data-admin-action]");if(!s)return;const a=s.dataset.adminAction,r=s.dataset.userId;r&&(a==="block"?await this.blockUser(r):a==="unblock"?await this.unblockUser(r):a==="delete"&&confirm("Delete this user and all their data?")&&await this.deleteUser(r))})}async blockUser(e){await Bl.blockUser(e),this.setStatus("User blocked"),await this.loadUsers()}async unblockUser(e){await Bl.unblockUser(e),this.setStatus("User unblocked"),await this.loadUsers()}async deleteUser(e){await Bl.deleteUser(e),this.setStatus("User deleted"),await this.loadUsers()}setStatus(e,t="info"){this.statusEl&&(this.statusEl.textContent=e,this.statusEl.dataset.statusType=t)}renderRow(e){const t=new Date(e.createdAt).toLocaleDateString(),s=e.status==="blocked";return`
      <tr>
        <td>${this.escape(e.name||"")}</td>
        <td>${this.escape(e.email)}</td>
        <td>${e.role}</td>
        <td class="status-${e.status}">${e.status}</td>
        <td>${t}</td>
        <td class="admin-actions">
          ${s?`<button data-admin-action="unblock" data-user-id="${e.id}">Unblock</button>`:`<button data-admin-action="block" data-user-id="${e.id}">Block</button>`}
          <button data-admin-action="delete" data-user-id="${e.id}" class="danger">Delete</button>
        </td>
      </tr>
    `}escape(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}async loadUsers(){if(this.tableBody){this.tableBody.innerHTML='<tr><td colspan="6">Loading users...</td></tr>';try{const e=await Bl.listAdminUsers();if(this.users=e,!e.length){this.tableBody.innerHTML='<tr><td colspan="6">No users found.</td></tr>';return}this.tableBody.innerHTML=e.map(t=>this.renderRow(t)).join("")}catch(e){console.error("Admin load users error:",e),this.tableBody.innerHTML='<tr><td colspan="6">Failed to load users.</td></tr>'}}}async show(){this.modal&&(this.modal.style.display="flex",Oi("admin-user-manager"),await this.loadUsers())}hide(){this.modal&&(this.modal.style.display="none",Vo("admin-user-manager"),this.setStatus(""))}}const Hl=Object.create(null);Hl.open="0";Hl.close="1";Hl.ping="2";Hl.pong="3";Hl.message="4";Hl.upgrade="5";Hl.noop="6";const x1=Object.create(null);Object.keys(Hl).forEach(n=>{x1[Hl[n]]=n});const MC={type:"error",data:"parser error"},yJ=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",vJ=typeof ArrayBuffer=="function",wJ=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,I5=({type:n,data:e},t,s)=>yJ&&e instanceof Blob?t?s(e):KF(e,s):vJ&&(e instanceof ArrayBuffer||wJ(e))?t?s(e):KF(new Blob([e]),s):s(Hl[n]+(e||"")),KF=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function JF(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let Lk;function e8e(n,e){if(yJ&&n.data instanceof Blob)return n.data.arrayBuffer().then(JF).then(e);if(vJ&&(n.data instanceof ArrayBuffer||wJ(n.data)))return e(JF(n.data));I5(n,!1,t=>{Lk||(Lk=new TextEncoder),e(Lk.encode(t))})}const eN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<eN.length;n++)hf[eN.charCodeAt(n)]=n;const t8e=n=>{let e=n.length*.75,t=n.length,s,a=0,r,o,i,l;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const c=new ArrayBuffer(e),u=new Uint8Array(c);for(s=0;s<t;s+=4)r=hf[n.charCodeAt(s)],o=hf[n.charCodeAt(s+1)],i=hf[n.charCodeAt(s+2)],l=hf[n.charCodeAt(s+3)],u[a++]=r<<2|o>>4,u[a++]=(o&15)<<4|i>>2,u[a++]=(i&3)<<6|l&63;return c},n8e=typeof ArrayBuffer=="function",Q5=(n,e)=>{if(typeof n!="string")return{type:"message",data:OJ(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:s8e(n.substring(1),e)}:x1[t]?n.length>1?{type:x1[t],data:n.substring(1)}:{type:x1[t]}:MC},s8e=(n,e)=>{if(n8e){const t=t8e(n);return OJ(t,e)}else return{base64:!0,data:n}},OJ=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},xJ="",a8e=(n,e)=>{const t=n.length,s=new Array(t);let a=0;n.forEach((r,o)=>{I5(r,!1,i=>{s[o]=i,++a===t&&e(s.join(xJ))})})},r8e=(n,e)=>{const t=n.split(xJ),s=[];for(let a=0;a<t.length;a++){const r=Q5(t[a],e);if(s.push(r),r.type==="error")break}return s};function o8e(){return new TransformStream({transform(n,e){e8e(n,t=>{const s=t.length;let a;if(s<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,s);else if(s<65536){a=new Uint8Array(3);const r=new DataView(a.buffer);r.setUint8(0,126),r.setUint16(1,s)}else{a=new Uint8Array(9);const r=new DataView(a.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(a[0]|=128),e.enqueue(a),e.enqueue(t)})}})}let Ik;function wb(n){return n.reduce((e,t)=>e+t.length,0)}function Ob(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let a=0;a<e;a++)t[a]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function i8e(n,e){Ik||(Ik=new TextDecoder);const t=[];let s=0,a=-1,r=!1;return new TransformStream({transform(o,i){for(t.push(o);;){if(s===0){if(wb(t)<1)break;const l=Ob(t,1);r=(l[0]&128)===128,a=l[0]&127,a<126?s=3:a===126?s=1:s=2}else if(s===1){if(wb(t)<2)break;const l=Ob(t,2);a=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),s=3}else if(s===2){if(wb(t)<8)break;const l=Ob(t,8),c=new DataView(l.buffer,l.byteOffset,l.length),u=c.getUint32(0);if(u>Math.pow(2,21)-1){i.enqueue(MC);break}a=u*Math.pow(2,32)+c.getUint32(4),s=3}else{if(wb(t)<a)break;const l=Ob(t,a);i.enqueue(Q5(r?l:Ik.decode(l),e)),s=0}if(a===0||a>n){i.enqueue(MC);break}}}})}const kJ=4;function xa(n){if(n)return l8e(n)}function l8e(n){for(var e in xa.prototype)n[e]=xa.prototype[e];return n}xa.prototype.on=xa.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};xa.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};xa.prototype.off=xa.prototype.removeListener=xa.prototype.removeAllListeners=xa.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,a=0;a<t.length;a++)if(s=t[a],s===e||s.fn===e){t.splice(a,1);break}return t.length===0&&delete this._callbacks["$"+n],this};xa.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,a=t.length;s<a;++s)t[s].apply(this,e)}return this};xa.prototype.emitReserved=xa.prototype.emit;xa.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};xa.prototype.hasListeners=function(n){return!!this.listeners(n).length};const lO=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),si=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),c8e="arraybuffer";function PJ(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const u8e=si.setTimeout,h8e=si.clearTimeout;function cO(n,e){e.useNativeTimers?(n.setTimeoutFn=u8e.bind(si),n.clearTimeoutFn=h8e.bind(si)):(n.setTimeoutFn=si.setTimeout.bind(si),n.clearTimeoutFn=si.clearTimeout.bind(si))}const d8e=1.33;function m8e(n){return typeof n=="string"?p8e(n):Math.ceil((n.byteLength||n.size)*d8e)}function p8e(n){let e=0,t=0;for(let s=0,a=n.length;s<a;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function SJ(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function f8e(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function g8e(n){let e={},t=n.split("&");for(let s=0,a=t.length;s<a;s++){let r=t[s].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}class b8e extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class V5 extends xa{constructor(e){super(),this.writable=!1,cO(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new b8e(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Q5(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=f8e(e);return t.length?"?"+t:""}}class y8e extends V5{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};r8e(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,a8e(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=SJ()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let CJ=!1;try{CJ=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const v8e=CJ;function w8e(){}class O8e extends y8e{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(a,r)=>{this.onError("xhr post error",a,r)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}class Il extends xa{constructor(e,t,s){super(),this.createRequest=e,cO(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=PJ(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&s.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var a;s.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=Il.requestsCount++,Il.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=w8e,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Il.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Il.requestsCount=0;Il.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",tN);else if(typeof addEventListener=="function"){const n="onpagehide"in si?"pagehide":"unload";addEventListener(n,tN,!1)}}function tN(){for(let n in Il.requests)Il.requests.hasOwnProperty(n)&&Il.requests[n].abort()}const x8e=(function(){const n=MJ({xdomain:!1});return n&&n.responseType!==null})();class k8e extends O8e{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=x8e&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Il(MJ,this.uri(),e)}}function MJ(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||v8e))return new XMLHttpRequest}catch{}if(!e)try{return new si[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const AJ=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class P8e extends V5{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=AJ?{}:PJ(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],a=t===e.length-1;I5(s,this.supportsBinary,r=>{try{this.doWrite(s,r)}catch{}a&&lO(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=SJ()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Qk=si.WebSocket||si.MozWebSocket;class S8e extends P8e{createSocket(e,t,s){return AJ?new Qk(e,t,s):t?new Qk(e,t):new Qk(e)}doWrite(e,t){this.ws.send(t)}}class C8e extends V5{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=i8e(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),a=o8e();a.readable.pipeTo(e.writable),this._writer=a.writable.getWriter();const r=()=>{s.read().then(({done:i,value:l})=>{i||(this.onPacket(l),r())}).catch(i=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],a=t===e.length-1;this._writer.write(s).then(()=>{a&&lO(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const M8e={websocket:S8e,webtransport:C8e,polling:k8e},A8e=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,E8e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function AC(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let a=A8e.exec(n||""),r={},o=14;for(;o--;)r[E8e[o]]=a[o]||"";return t!=-1&&s!=-1&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=D8e(r,r.path),r.queryKey=T8e(r,r.query),r}function D8e(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function T8e(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,a,r){a&&(t[a]=r)}),t}const EC=typeof addEventListener=="function"&&typeof removeEventListener=="function",k1=[];EC&&addEventListener("offline",()=>{k1.forEach(n=>n())},!1);class wu extends xa{constructor(e,t){if(super(),this.binaryType=c8e,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=AC(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=AC(t.host).host);cO(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const a=s.prototype.name;this.transports.push(a),this._transportsByName[a]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=g8e(this.opts.query)),EC&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},k1.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=kJ,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&wu.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",wu.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const a=this.writeBuffer[s].data;if(a&&(t+=m8e(a)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,lO(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,a){if(typeof t=="function"&&(a=t,t=void 0),typeof s=="function"&&(a=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const r={type:e,data:t,options:s};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),a&&this.once("flush",a),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(wu.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),EC&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=k1.indexOf(this._offlineEventListener);s!==-1&&k1.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}wu.protocol=kJ;class F8e extends wu{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;wu.priorWebsocketSuccess=!1;const a=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",h=>{if(!s)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;wu.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const m=new Error("probe error");m.transport=t.name,this.emitReserved("upgradeError",m)}}))};function r(){s||(s=!0,u(),t.close(),t=null)}const o=h=>{const m=new Error("probe error: "+h);m.transport=t.name,r(),this.emitReserved("upgradeError",m)};function i(){o("transport closed")}function l(){o("socket closed")}function c(h){t&&h.name!==t.name&&r()}const u=()=>{t.removeListener("open",a),t.removeListener("error",o),t.removeListener("close",i),this.off("close",l),this.off("upgrading",c)};t.once("open",a),t.once("error",o),t.once("close",i),this.once("close",l),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let N8e=class extends F8e{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(a=>M8e[a]).filter(a=>!!a)),super(e,s)}};function B8e(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=AC(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const r=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+r+":"+s.port+e,s.href=s.protocol+"://"+r+(t&&t.port===s.port?"":":"+s.port),s}const $8e=typeof ArrayBuffer=="function",R8e=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,EJ=Object.prototype.toString,_8e=typeof Blob=="function"||typeof Blob<"u"&&EJ.call(Blob)==="[object BlobConstructor]",L8e=typeof File=="function"||typeof File<"u"&&EJ.call(File)==="[object FileConstructor]";function j5(n){return $8e&&(n instanceof ArrayBuffer||R8e(n))||_8e&&n instanceof Blob||L8e&&n instanceof File}function P1(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(P1(n[t]))return!0;return!1}if(j5(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return P1(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&P1(n[t]))return!0;return!1}function I8e(n){const e=[],t=n.data,s=n;return s.data=DC(t,e),s.attachments=e.length,{packet:s,buffers:e}}function DC(n,e){if(!n)return n;if(j5(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=DC(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=DC(n[s],e));return t}return n}function Q8e(n,e){return n.data=TC(n.data,e),delete n.attachments,n}function TC(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=TC(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=TC(n[t],e));return n}const V8e=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],j8e=5;var es;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(es||(es={}));class Z8e{constructor(e){this.replacer=e}encode(e){return(e.type===es.EVENT||e.type===es.ACK)&&P1(e)?this.encodeAsBinary({type:e.type===es.EVENT?es.BINARY_EVENT:es.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===es.BINARY_EVENT||e.type===es.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=I8e(e),s=this.encodeAsString(t.packet),a=t.buffers;return a.unshift(s),a}}function nN(n){return Object.prototype.toString.call(n)==="[object Object]"}class Z5 extends xa{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===es.BINARY_EVENT;s||t.type===es.BINARY_ACK?(t.type=s?es.EVENT:es.ACK,this.reconstructor=new z8e(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(j5(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(es[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===es.BINARY_EVENT||s.type===es.BINARY_ACK){const r=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(r,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(t+1)==="/"){const r=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(r,t)}else s.nsp="/";const a=e.charAt(t+1);if(a!==""&&Number(a)==a){const r=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}s.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(Z5.isPayloadValid(s.type,r))s.data=r;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case es.CONNECT:return nN(t);case es.DISCONNECT:return t===void 0;case es.CONNECT_ERROR:return typeof t=="string"||nN(t);case es.EVENT:case es.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&V8e.indexOf(t[0])===-1);case es.ACK:case es.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class z8e{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Q8e(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const G8e=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Z5,Encoder:Z8e,get PacketType(){return es},protocol:j8e},Symbol.toStringTag,{value:"Module"}));function Li(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const X8e=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class DJ extends xa{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Li(e,"open",this.onopen.bind(this)),Li(e,"packet",this.onpacket.bind(this)),Li(e,"error",this.onerror.bind(this)),Li(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,a,r;if(X8e.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:es.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const u=this.ids++,h=t.pop();this._registerAckCallback(u,h),o.id=u}const i=(a=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||a===void 0?void 0:a.writable,l=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!i||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var s;const a=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(a===void 0){this.acks[e]=t;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let i=0;i<this.sendBuffer.length;i++)this.sendBuffer[i].id===e&&this.sendBuffer.splice(i,1);t.call(this,new Error("operation has timed out"))},a),o=(...i)=>{this.io.clearTimeoutFn(r),t.apply(this,i)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((s,a)=>{const r=(o,i)=>o?a(o):s(i);r.withError=!0,t.push(r),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((a,...r)=>s!==this._queue[0]?void 0:(a!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(a)):(this._queue.shift(),t&&t(null,...r)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:es.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case es.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case es.EVENT:case es.BINARY_EVENT:this.onevent(e);break;case es.ACK:case es.BINARY_ACK:this.onack(e);break;case es.DISCONNECT:this.ondisconnect();break;case es.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...a){s||(s=!0,t.packet({type:es.ACK,id:e,data:a}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:es.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function up(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}up.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=(Math.floor(e*10)&1)==0?n-t:n+t}return Math.min(n,this.max)|0};up.prototype.reset=function(){this.attempts=0};up.prototype.setMin=function(n){this.ms=n};up.prototype.setMax=function(n){this.max=n};up.prototype.setJitter=function(n){this.jitter=n};class FC extends xa{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,cO(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new up({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const a=t.parser||G8e;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new N8e(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const a=Li(t,"open",function(){s.onopen(),e&&e()}),r=i=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",i),e?e(i):this.maybeReconnectOnOpen()},o=Li(t,"error",r);if(this._timeout!==!1){const i=this._timeout,l=this.setTimeoutFn(()=>{a(),r(new Error("timeout")),t.close()},i);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(a),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Li(e,"ping",this.onping.bind(this)),Li(e,"data",this.ondata.bind(this)),Li(e,"error",this.onerror.bind(this)),Li(e,"close",this.onclose.bind(this)),Li(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){lO(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new DJ(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(a=>{a?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",a)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const zp={};function S1(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=B8e(n,e.path||"/socket.io"),s=t.source,a=t.id,r=t.path,o=zp[a]&&r in zp[a].nsps,i=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return i?l=new FC(s,e):(zp[a]||(zp[a]=new FC(s,e)),l=zp[a]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(S1,{Manager:FC,Socket:DJ,io:S1,connect:S1});const Vk={},W8e=(Vk==null?void 0:Vk.VITE_SOCKET_URL)||window.location.origin;class q8e{constructor(){this.socket=null,this.connected=!1,this.eventHandlers=new Map,this.currentSessionId=null,this.masterUpdateQueue=[],this.masterUpdateTimer=null}ensureSocket(){return this.socket?(!this.socket.connected&&!this.socket.connecting&&this.socket.connect(),this.socket):(this.socket=S1(W8e,{withCredentials:!0,transports:["websocket"],autoConnect:!0,timeout:8e3}),this.socket.on("connect",()=>{this.connected=!0,this.emitLocal("connect"),this.currentSessionId&&this.joinSession(this.currentSessionId).catch(()=>{})}),this.socket.on("disconnect",e=>{this.connected=!1,this.emitLocal("disconnect",{reason:e})}),this.socket.on("session:snapshot",e=>{e!=null&&e.id&&(this.currentSessionId=e.id),this.emitLocal("session:snapshot",e)}),this.socket.on("session:participant-event",e=>{this.emitLocal("session:participant-event",e)}),this.socket.on("master:updated",e=>{this.queueMasterUpdate(e)}),this.socket.on("auth:error",e=>{this.emitLocal("auth:error",e)}),this.socket.on("connect_error",e=>{this.emitLocal("error",{message:e.message})}),this.socket)}on(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t),()=>this.off(e,t)}off(e,t){const s=this.eventHandlers.get(e);s&&(s.delete(t),s.size===0&&this.eventHandlers.delete(e))}emitLocal(e,t){const s=this.eventHandlers.get(e);s&&s.forEach(a=>{try{a(t)}catch(r){console.error(`CollaborationClient handler error for event ${e}:`,r)}})}queueMasterUpdate(e){e&&(this.masterUpdateQueue.push(e),!this.masterUpdateTimer&&(this.masterUpdateTimer=setTimeout(()=>{const t=this.masterUpdateQueue[this.masterUpdateQueue.length-1];this.masterUpdateQueue=[],this.masterUpdateTimer=null,this.emitLocal("master:updated",t)},120)))}async joinSession(e){if(!e)throw new Error("Session identifier is required");return this.ensureSocket(),new Promise((t,s)=>{this.socket.emit("session:join",{sessionId:e},a=>{var r;a!=null&&a.success?(this.currentSessionId=((r=a.snapshot)==null?void 0:r.id)||e,a.snapshot&&this.emitLocal("session:snapshot",a.snapshot),t(a.snapshot)):s(new Error((a==null?void 0:a.error)||"Failed to join session"))})})}async leaveSession(e=this.currentSessionId){if(!(!e||!this.socket))return new Promise(t=>{this.socket.emit("session:leave",{sessionId:e},()=>{e===this.currentSessionId&&(this.currentSessionId=null),t()})})}async pushChannelDraft(e={}){const t=e.sessionId||this.currentSessionId;if(!t)throw new Error("Join a session before pushing a channel");return this.ensureSocket(),new Promise((s,a)=>{this.socket.emit("channel:update",{...e,sessionId:t},r=>{r!=null&&r.success?s():a(new Error((r==null?void 0:r.error)||"Failed to push channel"))})})}async publishChannel({channelId:e,status:t="live",sessionId:s}={}){const a=s||this.currentSessionId;if(!a||!e)throw new Error("sessionId and channelId are required");return this.ensureSocket(),new Promise((r,o)=>{this.socket.emit("channel:publish",{sessionId:a,channelId:e,status:t},i=>{i!=null&&i.success?r():o(new Error((i==null?void 0:i.error)||"Failed to publish channel"))})})}async editMaster(e,t=this.currentSessionId){if(!t)throw new Error("Join a session before editing master");return this.ensureSocket(),new Promise((s,a)=>{this.socket.emit("master:edit",{sessionId:t,masterCode:e},r=>{r!=null&&r.success?s():a(new Error((r==null?void 0:r.error)||"Failed to update master"))})})}}const NC=new q8e,uO={modal:{mountId:"modal-theory-block",timeGroupSelector:"#modal-time-signature-group",keyGroupSelector:"#modal-key-scale-group",chordSelectors:["#modal-scale-chord-suggestions"],timeGroupClass:"form-group",timeGroupId:"modal-time-signature-group",timeSelectId:"modal-time-signature-select",keyGridClass:"form-group",keyGridId:"modal-key-scale-group",keySelectId:"modal-key-select",scaleSelectId:"modal-scale-select",scaleNotesId:"modal-scale-notes-display",keyGridStyle:"display: none;",pianoElementId:"modal-piano"},collab:{mountId:"collab-theory-block",timeGroupSelector:"#collab-time-signature-group",keyGroupSelector:".collab-key-scale-grid",chordSelectors:[".collab-chord-tools"],timeGroupClass:"form-group collab-time-signature",timeGroupId:"collab-time-signature-group",timeSelectId:"collab-channel-time-signature",keyGridClass:"collab-key-scale-grid",keyGridId:"collab-key-scale-group",keySelectId:"collab-key-select",scaleSelectId:"collab-scale-select",scaleNotesId:"collab-scale-notes-display",keyGridStyle:"",pianoElementId:"collab-piano"}},U8e=["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B"],H8e=[{value:"4/4",label:"4/4 (Common Time)",selected:!0},{value:"3/4",label:"3/4 (Waltz)"},{value:"6/8",label:"6/8"},{value:"2/4",label:"2/4 (March)"},{value:"5/4",label:"5/4"},{value:"7/8",label:"7/8"},{value:"12/8",label:"12/8"},{value:"2/2",label:"2/2 (Cut Time)"},{value:"3/8",label:"3/8"},{value:"9/8",label:"9/8"},{value:"5/8",label:"5/8"},{value:"7/4",label:"7/4"}],Y8e=[{label:"Diatonic (Major Scale) Modes",options:[{value:"ionian",label:"Ionian (Major)"},{value:"dorian",label:"Dorian"},{value:"phrygian",label:"Phrygian"},{value:"lydian",label:"Lydian"},{value:"mixolydian",label:"Mixolydian"},{value:"aeolian",label:"Aeolian (Natural Minor)"},{value:"locrian",label:"Locrian"}]},{label:"Melodic Minor Modes (Jazz Melodic Minor)",options:[{value:"melodic minor",label:"Melodic Minor (Jazz Minor)"},{value:"dorian b2",label:"Dorian ♭2"},{value:"lydian augmented",label:"Lydian Augmented"},{value:"lydian dominant",label:"Lydian Dominant"},{value:"mixolydian b6",label:"Mixolydian ♭6"},{value:"locrian #2",label:"Locrian ♮2"},{value:"altered",label:"Altered Scale (Super-Locrian)"}]},{label:"Harmonic Major Modes",options:[{value:"harmonic major",label:"Harmonic Major"},{value:"dorian b5",label:"Dorian ♭5"},{value:"phrygian b4",label:"Phrygian ♭4"},{value:"lydian b3",label:"Lydian ♭3"},{value:"mixolydian b2",label:"Mixolydian ♭2"},{value:"lydian augmented #2",label:"Lydian Augmented ♯2"},{value:"locrian bb7",label:"Locrian ♭♭7"}]},{label:"Harmonic Minor Modes",options:[{value:"harmonic minor",label:"Harmonic Minor"},{value:"locrian #6",label:"Locrian ♮6"},{value:"ionian #5",label:"Ionian ♯5"},{value:"dorian #4",label:"Dorian ♯4"},{value:"phrygian dominant",label:"Phrygian Dominant"},{value:"lydian #2",label:"Lydian ♯2"},{value:"ultralocrian",label:"Ultralocrian"}]},{label:"Pentatonic Modes (Major Pentatonic)",options:[{value:"major pentatonic",label:"Major Pentatonic"},{value:"suspended pentatonic",label:"Suspended Pentatonic"},{value:"man gong",label:"Man Gong"},{value:"ritusen",label:"Ritusen"},{value:"minor pentatonic mode 5",label:"Minor Pentatonic Mode 5"}]},{label:"Pentatonic Modes (Minor Pentatonic)",options:[{value:"minor pentatonic",label:"Minor Pentatonic"},{value:"blues minor pentatonic",label:"Blues Minor (no ♭5)"},{value:"major pentatonic mode 3",label:"Major Pentatonic Mode 3"},{value:"egyptian",label:"Egyptian"},{value:"minor pentatonic mode 5",label:"Minor Pentatonic Mode 5"}]},{label:"Other Scale Systems",options:[{value:"whole tone",label:"Whole Tone"},{value:"half-whole diminished",label:"Half–Whole"},{value:"whole-half diminished",label:"Whole–Half"},{value:"minor blues",label:"Minor Blues"}]}],K8e=[{value:"i-iv-v",label:"I · IV · V"},{value:"ii-v-i",label:"ii · V · I"},{value:"lofi-walk",label:"Lo-fi walk"}],J8e=`<option value="">Select Key</option>${U8e.map(n=>`<option value="${n}">${n}</option>`).join("")}`,eBe=H8e.map(n=>`<option value="${n.value}"${n.selected?" selected":""}>${n.label}</option>`).join(""),tBe=['<option value="chromatic" selected>Chromatic</option>',Y8e.map(n=>{const e=n.options.map(t=>`<option value="${t.value}">${t.label}</option>`).join("");return`<optgroup label="${n.label}">${e}</optgroup>`}).join("")].join("");function sN(n){const e=uO[n];return e?`
    <div class="${e.timeGroupClass}" id="${e.timeGroupId}">
      <label for="${e.timeSelectId}">Time Signature:</label>
      <select id="${e.timeSelectId}" class="control-select" aria-label="Time Signature">
        ${eBe}
      </select>
    </div>
  `:""}function aN(n){const e=uO[n];if(!e)return"";const t=e.keyGridStyle?` style="${e.keyGridStyle}"`:"";return`
    <div class="${e.keyGridClass}" id="${e.keyGridId||""}"${t}>
      <div class="form-group">
        <label for="${e.keySelectId}">Key:</label>
        <select id="${e.keySelectId}" class="control-select" aria-label="Key">
          ${J8e}
        </select>
      </div>
      <div class="form-group">
        <label for="${e.scaleSelectId}">Scale:</label>
        <select id="${e.scaleSelectId}" class="control-select" aria-label="Scale">
          ${tBe}
        </select>
        <div id="${e.scaleNotesId}" class="theory-scale-notes-hint"></div>
      </div>
    </div>
  `}function nBe(){return`
    <div class="scale-chord-suggestions" id="modal-scale-chord-suggestions" aria-live="polite">
      <div class="scale-chord-suggestions__header">
        <p id="modal-scale-chord-title">Select a key and scale to view chord progressions.</p>
        <p id="modal-scale-characteristic" class="scale-chord-suggestions__characteristic"></p>
      </div>
      <div class="scale-chord-suggestions__dropdown-wrapper">
        <label for="modal-chord-progression-select" class="scale-chord-suggestions__label">Chord Progressions:</label>
        <select id="modal-chord-progression-select" class="scale-chord-suggestions__select">
          <option value="">Select a progression...</option>
        </select>
      </div>
    </div>
  `}function sBe(){return`
    <div class="collab-chord-tools">
      <label for="collab-chord-select">Chords</label>
      <div class="collab-chord-row">
        <select id="collab-chord-select" class="control-select">
          ${['<option value="">Add a chord progression…</option>',K8e.map(e=>`<option value="${e.value}">${e.label}</option>`).join("")].join("")}
        </select>
        <label class="collab-note-mode-toggle">
          <input type="checkbox" id="collab-note-mode-toggle" />
          <span id="collab-note-mode-label">Note names</span>
        </label>
      </div>
    </div>
  `}function rN(n){const e=uO[n];if(!e)return"";const t=e.pianoElementId||`${n}-piano`;return`
    <div class="piano-section" data-piano-section data-piano-context="${n}" data-piano-element-id="${t}" hidden>
      <div class="piano-header">
        <h3>Interactive Piano</h3>
        <div class="piano-octave-controls">
          <label>Octave:</label>
          <button class="piano-octave-btn" data-piano-octave="1">1</button>
          <button class="piano-octave-btn" data-piano-octave="2">2</button>
          <button class="piano-octave-btn active" data-piano-octave="3">3</button>
          <button class="piano-octave-btn" data-piano-octave="4">4</button>
          <button class="piano-octave-btn" data-piano-octave="5">5</button>
        </div>
      </div>
      <div class="piano-keyboard" data-piano-keys>
        <button class="piano-key white" data-note="C">C</button>
        <button class="piano-key black" data-note="C#">C#</button>
        <button class="piano-key white" data-note="D">D</button>
        <button class="piano-key black" data-note="D#">D#</button>
        <button class="piano-key white" data-note="E">E</button>
        <button class="piano-key white" data-note="F">F</button>
        <button class="piano-key black" data-note="F#">F#</button>
        <button class="piano-key white" data-note="G">G</button>
        <button class="piano-key black" data-note="G#">G#</button>
        <button class="piano-key white" data-note="A">A</button>
        <button class="piano-key black" data-note="A#">A#</button>
        <button class="piano-key white" data-note="B">B</button>
      </div>
    </div>
  `}function TJ(n){if(n==="modal")return[sN(n),aN(n),nBe(),rN(n)].join(`
`);if(n==="collab")return`
      <div class="collab-theory-block">
        <div class="collab-channel-editor-tools">
          <div class="form-group collab-mode-toggle-group">
            <label>Editor mode</label>
            <div class="collab-mode-switch">
              <span class="collab-mode-label collab-mode-label--code">Code</span>
              <label class="toggle-switch collab-mode-toggle">
                <input type="checkbox" id="collab-editor-mode-toggle" aria-label="Toggle step editor" />
                <span class="toggle-slider"></span>
              </label>
              <span class="collab-mode-label collab-mode-label--step">Step</span>
            </div>
          </div>
        </div>
        ${sN(n)}
        ${aN(n)}
        ${sBe()}
        ${rN(n)}
      </div>
    `;throw new Error(`Unknown theory block context: ${n}`)}function FJ(n,{showTimeSignature:e,showKeyScale:t,showPiano:s}){const a=uO[n];if(!a)return;const r=document.querySelector(a.timeGroupSelector);r&&(r.style.display=e?"":"none");const o=document.querySelector(a.keyGroupSelector);o&&(o.style.display=t?"":"none"),Array.isArray(a.chordSelectors)&&a.chordSelectors.forEach(c=>{const u=document.querySelector(c);u&&(u.style.display=t?"":"none")});const i=a.mountId?document.getElementById(a.mountId):null,l=i==null?void 0:i.querySelector("[data-piano-section]");l&&(!!s?(l.hidden=!1,l.classList.remove("piano-section--hidden"),l.style.removeProperty("display")):(l.hidden=!0,l.classList.add("piano-section--hidden"),l.style.setProperty("display","none","important")))}const xb=3,aBe={modal:{textareaSelector:"#modal-pattern",keySelector:"#modal-key-select",scaleSelector:"#modal-scale-select",resolveNoteMode(){return"note"}},collab:{textareaSelector:"#collab-channel-code",keySelector:"#collab-key-select",scaleSelector:"#collab-scale-select",resolveNoteMode(){const n=document.getElementById("collab-note-mode-toggle");return n!=null&&n.checked?"semitone":"note"}}};function rBe(n){return!n||!n.textareaSelector?null:document.querySelector(n.textareaSelector)}function oN(n,e=""){if(!n)return e;const t=document.querySelector(n);return t&&t.value||e}function NJ(n){return!n||typeof n!="string"?"C":n.trim()||"C"}function oBe(n){return!n||typeof n!="string"?"chromatic":n.trim()||"chromatic"}function iBe(n){const e=NJ(n),t=hr.get(`${e}4`);return Number.isFinite(t.midi)?t.midi:60}function lBe(n,e){if(!(oe!=null&&oe.getScaleSemitoneSteps))return null;const t=oe.getScaleSemitoneSteps(NJ(n),oBe(e));return Array.isArray(t)&&t.length>0?t:null}function cBe(n,e,t,s){const a=hr.get(`${n}${e}`);if(!a||!Number.isFinite(a.midi))return null;const r=iBe(t),o=lBe(t,s),i=a.midi-r;if(!o||!o.length)return i;const l=(i%12+12)%12,c=o.indexOf(l);return c===-1?null:Math.floor((i-o[c])/12)*o.length+c}function uBe(n,e,t){const s=n||"",a=t==="n"?/\bn\s*\(\s*(["'])([\s\S]*?)\1\s*\)/:/\bnote\s*\(\s*(["'])([\s\S]*?)\1\s*\)/,r=s.match(a);if(r){const[c,u,h]=r,m=h.trim(),f=m?`${m} ${e}`:e,v=`${t}(${u}${f}${u})`,O=r.index??0;return`${s.slice(0,O)}${v}${s.slice(O+c.length)}`}const o=t==="n"?`n("${e}")`:`note("${e}")`,i=s.trimEnd();return`${i}${i?`
`:""}${o}
`}function hBe(n,e){return/\bn\s*\(/i.test(n)?"n":/\bnote\s*\(/i.test(n)?"note":e==="semitone"?"n":"note"}function dBe(n,e,t){var m;const s=aBe[n];if(!s)return!1;const a=rBe(s);if(!a)return!1;const r=oN(s.keySelector,"C"),o=oN(s.scaleSelector,"chromatic"),i=((m=s.resolveNoteMode)==null?void 0:m.call(s))==="semitone"?"semitone":"note",l=a.value||"",c=hBe(l,i);let u=`${e}${t}`;if(c==="n"){const f=cBe(e,t,r,o);if(!Number.isFinite(f))return console.warn(`⚠️ Unable to map ${e}${t} to scale degrees (key=${r}, scale=${o})`),!1;u=String(f)}const h=uBe(l,u,c);return h?(a.value=h,a.dispatchEvent(new Event("input",{bubbles:!0})),!0):!1}async function mBe(n,e,t,s){if(!n)return;if(!oe.isAudioReady()&&!await oe.initialize()){console.warn("⚠️ Unable to initialize audio for piano keyboard");return}if(oe.audioContext&&oe.audioContext.state==="suspended")try{await oe.audioContext.resume(),await new Promise(o=>setTimeout(o,30))}catch(o){console.warn("⚠️ Failed to resume audio context for piano keyboard:",o)}if(!oe.isAudioReady()){console.warn("⚠️ Audio context not ready for piano playback");return}const r=`note("${`${n}${e}`}").s("piano")`;try{await oe.playStrudelPattern(t,r),s&&(s.classList.add("active"),setTimeout(()=>s.classList.remove("active"),150))}catch(o){console.warn("⚠️ Unable to play piano note:",o)}}function pBe(n){if(!n||n.dataset.pianoInitialized==="true")return;const e=n.querySelector("[data-piano-keys]");if(!e)return;n.dataset.pianoInitialized="true";const t=n.getAttribute("data-piano-element-id")||"piano-keys",s=n.getAttribute("data-piano-context")||"modal",a=n.querySelectorAll(".piano-octave-btn"),r=n.querySelector(".piano-octave-btn.active");let o=r?parseInt(r.dataset.pianoOctave||`${xb}`,10):xb;if(Number.isNaN(o)&&(o=xb),!r&&a.length>0){const c=a[0];c.classList.add("active");const u=parseInt(c.dataset.pianoOctave||`${xb}`,10);Number.isNaN(u)||(o=u)}const i=(c,u)=>{o=c,a.forEach(h=>h.classList.remove("active")),u&&u.classList.add("active")};a.forEach(c=>{c.addEventListener("click",()=>{const u=parseInt(c.dataset.pianoOctave,10);Number.isNaN(u)||i(u,c)})}),e.querySelectorAll(".piano-key").forEach(c=>{const u=c.dataset.note;if(!u)return;const h=m=>{m&&m.preventDefault(),dBe(s,u,o),mBe(u,o,t,c)};c.addEventListener("mousedown",h),c.addEventListener("touchstart",h,{passive:!1})})}function BJ(n=document){if(!n)return;n.querySelectorAll("[data-piano-section]").forEach(pBe)}const rn={info:"info",success:"success",error:"error"},kb=[{key:"bd",label:"Kick",sample:"bd"},{key:"sd",label:"Snare",sample:"sd"},{key:"hh",label:"Hi-hat",sample:"hh"},{key:"oh",label:"Open hat",sample:"oh"},{key:"cp",label:"Clap",sample:"cp"},{key:"perc",label:"Perc",sample:"perc"}],Gp={"2/4":8,"3/4":12,"4/4":16,"5/4":20,"6/8":12,"7/4":28,"7/8":14,"9/8":18,"12/8":24,"2/2":16,"3/8":6,"5/8":10},Pb="4/4",fBe=[{id:"i-iv-v",label:"I · IV · V",noteSnippet:'note("c4 e4 g4").slow(2) ++ note("f4 a4 c5").slow(2) ++ note("g4 b4 d5").slow(2)',semitoneSnippet:'n("0 4 7").slow(2) ++ n("5 9 12").slow(2) ++ n("7 11 14").slow(2)'},{id:"ii-v-i",label:"ii · V · I",noteSnippet:'note("d4 f4 a4").slow(2) ++ note("g3 b3 d4").slow(2) ++ note("c4 e4 g4").slow(2)',semitoneSnippet:'n("2 5 9").slow(2) ++ n("7 11 14").slow(2) ++ n("0 4 7").slow(2)'},{id:"lofi-walk",label:"Lo-fi walk",noteSnippet:'note("c4 e4 g4").stack(note("b3 d4 g4")).slow(2)',semitoneSnippet:'n("0 4 7").stack(n("11 2 7")).slow(2)'}],ad={NOTE:"note",SEMITONE:"semitone"},iN=new Set(["live","published"]),lN=[{bg:"#fff1f2",border:"#fda4af"},{bg:"#fefce8",border:"#fcd34d"},{bg:"#ecfccb",border:"#bef264"},{bg:"#cffafe",border:"#67e8f9"},{bg:"#e0e7ff",border:"#a5b4fc"},{bg:"#fdf2f8",border:"#f9a8d4"},{bg:"#fffbeb",border:"#fcd34d"}],jk="// @meta";class gBe{constructor(e=NC){this.root=null,this.overlay=null,this.closeBtn=null,this.socketClient=e,this.currentSnapshot=null,this.currentUser=null,this.statusTimer=null,this.boundHandlers=[],this.isOpen=!1,this.pendingInvites=[],this.recentSessions=[],this.inviteSearchResults=[],this.selectedInvitees=[],this.inviteSearchTimeout=null,this.channelEditorState=this.createDefaultEditorState(),this.channelTitleAuto=!0,this.channelLastChordLabel=null,this.lineNumberElement=null,this.modeToggleSwitch=null,this.userColorAssignments=new Map,this.userColorIndex=0,this.masterPlaybackActive=!1}createDefaultEditorState(){const e=Gp[Pb];return{mode:"code",timeSignature:Pb,stepsPerBar:e,gridSelections:this.createEmptyGridSelections(e),noteMode:ad.NOTE,bankValue:"",key:"",scale:"chromatic"}}createEmptyGridSelections(e){const t={};return kb.forEach(s=>{t[s.key]=new Array(e).fill(!1)}),t}init(){this.ensureModal(),this.root&&(this.render(),this.attachEvents(),this.bindSocketEvents(),this.updateAuthState())}ensureModal(){var e,t;this.overlay&&this.root||(document.getElementById("collab-modal-overlay")||document.body.insertAdjacentHTML("beforeend",`
        <div class="collab-modal-overlay" id="collab-modal-overlay" style="display: none;">
          <div class="collab-modal">
            <button type="button" class="collab-modal-close" id="collab-modal-close" aria-label="Close collaboration panel">&times;</button>
            <div class="collab-panel-wrapper">
              <div id="collab-panel-root"></div>
            </div>
          </div>
        </div>
      `),this.overlay=document.getElementById("collab-modal-overlay"),this.root=((e=this.overlay)==null?void 0:e.querySelector("#collab-panel-root"))||null,this.closeBtn=((t=this.overlay)==null?void 0:t.querySelector("#collab-modal-close"))||null)}show(){if(!this.currentUser){this.setStatus("Login to access live collaboration.",rn.error,2e3);return}this.ensureModal(),this.overlay&&(this.overlay.style.display="flex",Oi("collab-modal"),this.isOpen=!0,this.refreshUserInvites(),this.refreshRecentSessions())}hide(){this.overlay&&(this.overlay.style.display="none",Vo("collab-modal"),this.isOpen=!1)}destroy(){this.boundHandlers.forEach(e=>e()),this.boundHandlers=[],this.overlay&&(this.overlay.remove(),this.overlay=null,this.root=null,this.closeBtn=null)}setCurrentUser(e){this.currentUser=e,this.updateAuthState(),e?(this.refreshUserInvites(),this.refreshRecentSessions(),this.renderInviteSearchResults(),this.renderSelectedInvitees()):(this.pendingInvites=[],this.recentSessions=[],this.inviteSearchResults=[],this.selectedInvitees=[],this.renderPendingInvites(),this.renderRecentSessions(),this.renderInviteSearchResults(),this.renderSelectedInvitees())}updateAuthState(){var a,r;const e=!this.currentUser,t=(a=this.root)==null?void 0:a.querySelector("[data-collab-auth-message]"),s=(r=this.root)==null?void 0:r.querySelectorAll("[data-collab-requires-auth]");s&&s.forEach(o=>{o.disabled=e}),t&&(t.style.display=e?"block":"none"),e&&this.isOpen&&this.hide()}render(){this.root.innerHTML=`
      <div class="collab-panel-header">
        <div>
          <h3>Live Collaboration</h3>
          <p id="collab-session-label">Not connected</p>
        </div>
        <div class="collab-connection-indicator" id="collab-connection-indicator" title="Socket status"></div>
      </div>
      <div class="collab-panel-body">
        <div class="collab-auth-gate" data-collab-auth-message>
          <p>Login to create or join a collaboration session.</p>
        </div>
        <div class="collab-form-row">
          <label for="collab-title-input">Session title</label>
          <div class="collab-form-controls">
            <input type="text" id="collab-title-input" placeholder="Friday night jam" data-collab-requires-auth />
            <button id="collab-create-btn" class="btn-primary" data-collab-requires-auth>Create session</button>
          </div>
        </div>
        <div class="collab-status-message" id="collab-status-message" role="status" aria-live="polite"></div>
        <section class="collab-recents-section">
          <div class="collab-list-header">
            <strong>Recent sessions</strong>
            <button id="collab-refresh-recents-btn" class="btn-link" type="button">Refresh</button>
          </div>
          <div id="collab-recents-list" class="collab-chip-list collab-empty-state">Log in to see your recent collaborations.</div>
        </section>
        <section class="collab-invites-section">
          <div class="collab-list-header">
            <strong>Invitations for you</strong>
            <button id="collab-refresh-invites-btn" class="btn-link" type="button">Refresh</button>
          </div>
          <div id="collab-my-invites" class="collab-invites-list collab-empty-state">No pending invites.</div>
        </section>
        <div class="collab-session-details" id="collab-session-details" hidden>
          <div class="collab-session-meta">
            <div><strong>Session reference:</strong> <span id="collab-share-code">—</span></div>
            <div><strong>Delay to apply:</strong>
              <input type="range" min="0" max="5000" step="50" id="collab-delay-slider" data-collab-requires-auth />
              <span id="collab-delay-value">0 ms</span>
            </div>
            <div class="collab-cpu-row">
              <span><strong>CPU avg:</strong> <span id="collab-cpu-load">n/a</span></span>
              <span><strong>Last server update:</strong> <span id="collab-cpu-updated">—</span></span>
              <span class="collab-cpu-warning" id="collab-cpu-warning"></span>
              <button id="collab-refresh-cpu-btn" class="btn-link" type="button">Refresh stats</button>
            </div>
          </div>
          <div class="collab-owner-tools" id="collab-owner-tools" hidden>
            <div class="collab-list-header">
              <strong>Invite collaborators (max 5 at a time)</strong>
            </div>
            <div class="collab-invite-search">
              <input type="text" id="collab-invite-search" placeholder="Search users by display name or email..." data-collab-requires-auth />
              <div id="collab-invite-results" class="collab-invite-results collab-empty-state">Start typing to search users.</div>
              <div id="collab-selected-invitees" class="collab-selected-invitees collab-empty-state">No users selected yet.</div>
              <small class="collab-helper-text" id="collab-selected-count">Selected 0 of 5 slots.</small>
              <div class="collab-channel-actions">
                <button id="collab-send-invite-btn" class="btn-primary" data-collab-requires-auth>Send invites</button>
              </div>
            </div>
            <small class="collab-helper-text">Selected users will receive an invite in their Live Collaboration panel.</small>
          </div>
          <div class="collab-participants">
            <div class="collab-list-header">
              <strong>Participants</strong>
              <button id="collab-leave-btn" class="btn-ghost danger" data-collab-requires-auth>Leave</button>
            </div>
            <ul id="collab-participants-list"></ul>
          </div>
          <div class="collab-channel-form">
            <div class="collab-list-header">
              <strong>Channel snippet</strong>
              <button id="collab-load-editor-btn" class="btn-link" type="button">Use master editor content</button>
            </div>
            <div class="collab-channel-config">
              <div class="collab-config-grid">
                <div class="form-group">
                  <label for="collab-pattern-bank">Sound Bank:</label>
                  <select id="collab-pattern-bank" class="control-select">
                  <optgroup label="Drums">
                    <option value="">Default</option>
                    <option value="RolandTR808">Roland TR-808</option>
                    <option value="RolandTR909">Roland TR-909</option>
                    <option value="RolandTR707">Roland TR-707</option>
                    <option value="RhythmAce">Rhythm Ace</option>
                    <option value="AkaiLinn">Akai Linn</option>
                    <option value="ViscoSpaceDrum">Visco Space Drum</option>
                    <option value="CasioRZ1">Casio RZ-1</option>
                  </optgroup>
                  <optgroup label="Basic Waveforms">
                    <option value="sine">Sine</option>
                    <option value="square">Square</option>
                    <option value="triangle">Triangle</option>
                    <option value="sawtooth">Sawtooth</option>
                  </optgroup>
                  <optgroup label="Sample-based Synths">
                    <option value="piano">Piano</option>
                    <option value="supersaw">Saw Synth</option>
                    <option value="casio">Casio</option>
                    <option value="jazz">Jazz</option>
                    <option value="metal">Metal</option>
                    <option value="folkharp">Folk Harp</option>
                  </optgroup>
                  </select>
                  <div class="pattern-help">
                    <small>Select a sound bank to load. Banks are loaded when selected.</small>
                  </div>
                </div>
                <div class="form-group">
                  <label for="collab-channel-title">Title:</label>
                  <input type="text" id="collab-channel-title" placeholder="e.g., My drum pattern" />
                </div>
              </div>
              <div id="collab-theory-block"></div>
            </div>
            <div class="collab-step-editor" id="collab-step-editor" hidden>
              <div class="collab-step-grid" id="collab-step-grid"></div>
              <p class="collab-step-hint">Click steps to toggle hits. Multi-hits create stacked samples.</p>
            </div>
            <div class="collab-channel-editor">
              <div class="pattern-label-row">
                <label for="collab-channel-code">Pattern</label>
              </div>
              <div class="collab-pattern-wrapper">
                <div class="collab-line-numbers" id="collab-line-numbers" aria-hidden="true"></div>
                <textarea id="collab-channel-code" class="collab-pattern-input" rows="6" placeholder="// Write the pattern you want to push"></textarea>
              </div>
              <div class="pattern-help">
                <small>
                  Drum sounds: https://strudel.cc/workshop/first-sounds/#drum-sounds ·
                  Synth sounds: https://strudel.cc/workshop/first-notes/#changing-the-sound
                </small>
              </div>
            </div>
            <div class="collab-channel-actions">
              <button id="collab-push-draft-btn" class="btn-secondary collab-action-button" data-collab-requires-auth>Save draft</button>
              <button id="collab-publish-btn" class="btn-primary collab-action-button" data-collab-requires-auth>Publish to master</button>
              <button
                id="collab-play-master-btn"
                class="play-master-button collab-play-master-button"
                type="button"
                title="Play master pattern"
                aria-label="Play master pattern"
                data-collab-requires-auth
              >▶</button>
            </div>
            <div class="collab-master-display">
              <div class="collab-list-header">
                <strong>Published Master Pattern</strong>
              </div>
              <div id="collab-master-pattern" class="collab-master-pattern-field" role="region" aria-live="polite"></div>
            </div>
          </div>
          <div class="collab-channels-list">
            <div class="collab-list-header">
              <strong>Recent submissions</strong>
              <button id="collab-refresh-session-btn" class="btn-link" type="button">Refresh snapshot</button>
            </div>
            <div id="collab-channels-container"></div>
          </div>
        </div>
      </div>
    `;const e=this.root.querySelector("#collab-theory-block");e&&(e.innerHTML=TJ("collab"),BJ(e)),this.renderPendingInvites(),this.renderRecentSessions(),this.renderInviteSearchResults(),this.renderSelectedInvitees(),this.initializeChannelFormControls(),this.renderMasterPattern(this.currentSnapshot)}initializeChannelFormControls(){var e,t,s,a,r,o,i,l;if(this.root&&(this.channelEditorState||(this.channelEditorState=this.createDefaultEditorState()),this.channelTextarea=this.root.querySelector("#collab-channel-code"),this.lineNumberElement=this.root.querySelector("#collab-line-numbers"),this.channelTitleInput=this.root.querySelector("#collab-channel-title"),this.bankSelect=this.root.querySelector("#collab-pattern-bank"),this.timeSignatureSelect=this.root.querySelector("#collab-channel-time-signature"),this.keySelect=this.root.querySelector("#collab-key-select"),this.scaleSelect=this.root.querySelector("#collab-scale-select"),this.chordSelect=this.root.querySelector("#collab-chord-select"),this.noteToggle=this.root.querySelector("#collab-note-mode-toggle"),this.noteModeLabel=this.root.querySelector("#collab-note-mode-label"),this.channelTitleAuto=!this.channelTitleInput||this.channelTitleInput.value.trim().length===0,!!this.channelTextarea)){if(this.channelTextarea.addEventListener("input",()=>{this.channelEditorState.mode==="code"&&(this.channelEditorState.customCode=this.channelTextarea.value),this.updatePatternLineNumbers()}),this.channelTextarea.addEventListener("scroll",()=>{this.lineNumberElement&&(this.lineNumberElement.scrollTop=this.channelTextarea.scrollTop)}),(e=this.channelTitleInput)==null||e.addEventListener("input",()=>{this.handleTitleInputChange()}),(t=this.bankSelect)==null||t.addEventListener("change",c=>{this.handleBankChange(c.target.value)}),this.bankSelect&&(this.channelEditorState.bankValue=((s=this.bankSelect.value)==null?void 0:s.trim())||""),(a=this.timeSignatureSelect)==null||a.addEventListener("change",c=>{this.handleTimeSignatureChange(c.target.value)}),this.timeSignatureSelect){const c=this.timeSignatureSelect.value||Pb;this.channelEditorState.timeSignature=c,this.channelEditorState.stepsPerBar=Gp[c]||16}(r=this.keySelect)==null||r.addEventListener("change",c=>{this.handleKeyChange(c.target.value)}),(o=this.scaleSelect)==null||o.addEventListener("change",c=>{this.handleScaleChange(c.target.value)}),this.keySelect&&(this.channelEditorState.key=this.keySelect.value||""),this.scaleSelect&&(this.channelEditorState.scale=this.scaleSelect.value||"chromatic"),(i=this.chordSelect)==null||i.addEventListener("change",c=>{this.handleChordSelection(c.target.value)}),(l=this.noteToggle)==null||l.addEventListener("change",c=>{this.handleNoteModeToggle(c.target.checked)}),this.modeToggleSwitch=this.root.querySelector("#collab-editor-mode-toggle"),this.modeToggleSwitch&&!this.modeToggleSwitch.dataset.listenerAttached&&(this.modeToggleSwitch.addEventListener("change",c=>{const u=c.target.checked?"step":"code";this.setChannelEditorMode(u)}),this.modeToggleSwitch.dataset.listenerAttached="true"),this.buildStepEditorGrid(),this.autoFillTitleFromBank(),this.updateEditorModeButtons(),this.updateEditorModeVisibility(),this.channelEditorState.mode==="step"?(this.populateGridFromCode(this.channelTextarea.value),this.syncCodeFromGrid()):this.syncCodeAnnotationsFromState(),this.handleNoteModeToggle(this.channelEditorState.noteMode===ad.SEMITONE,{silent:!0}),this.updateTheoryBlockVisibility(),this.updatePatternLineNumbers()}}updateTheoryBlockVisibility(){var o,i,l,c;const e=((o=this.channelEditorState)==null?void 0:o.bankValue)||"",t=!!e&&Ri.has(e),s=((i=this.channelEditorState)==null?void 0:i.mode)==="step",a=(l=this.root)==null?void 0:l.querySelector(".collab-mode-toggle-group");a&&(a.style.display=t?"":"none");const r=(c=this.root)==null?void 0:c.querySelector("#collab-step-editor");r&&(r.hidden=!t||this.channelEditorState.mode!=="step"),FJ("collab",{showTimeSignature:t&&s,showKeyScale:!!e&&!t,showPiano:!!e&&!t})}updatePatternLineNumbers(){if(!this.lineNumberElement||!this.channelTextarea)return;const e=this.channelTextarea.value||"",t=Math.max(e.split(`
`).length,1),s=Math.max(String(t).length,2),a=Array.from({length:t},(r,o)=>`<span>${o+1}</span>`).join("");this.lineNumberElement.innerHTML=a,this.lineNumberElement.style.minWidth=`${s*8+16}px`,this.lineNumberElement.scrollTop=this.channelTextarea.scrollTop}updateMasterPlayButton(e=oe==null?void 0:oe.masterActive){var s;const t=(s=this.root)==null?void 0:s.querySelector("#collab-play-master-btn");t&&(e?(t.textContent="■",t.setAttribute("aria-label","Stop master playback"),t.setAttribute("title","Stop Master"),t.classList.add("active"),this.masterPlaybackActive=!0):(t.textContent="▶",t.setAttribute("aria-label","Play master pattern"),t.setAttribute("title","Play Master"),t.classList.remove("active"),this.masterPlaybackActive=!1))}async toggleMasterPlayback(){var e,t,s,a;if(!this.currentSnapshot){this.setStatus("Join a session before playing master.",rn.error,2500);return}try{if(oe.masterActive){await oe.stopMasterPattern(),this.updateMasterPlayButton(!1),this.setStatus("Master playback stopped.",rn.info,2e3);return}const r=((t=(e=this.currentSnapshot)==null?void 0:e.mergedStack)==null?void 0:t.trim())||((a=(s=this.currentSnapshot)==null?void 0:s.masterCode)==null?void 0:a.trim());if(!r){this.setStatus("Nothing has been published yet.",rn.error,2500);return}await oe.setMasterPatternCode(r);const o=await oe.playMasterPattern();if(!(o!=null&&o.success))throw new Error((o==null?void 0:o.error)||"Failed to start master playback");this.updateMasterPlayButton(!0),this.setStatus("Master playback started.",rn.success,2e3)}catch(r){console.error("toggleMasterPlayback failed:",r),this.updateMasterPlayButton(!1),this.setStatus(r.message||"Unable to toggle master playback",rn.error,3e3)}}getSelectedBankInfo(){var o;const e=((o=this.channelEditorState)==null?void 0:o.bankValue)||"";if(!e)return null;const s=Ad(e).bankValue||"";if(!s)return null;const a=s.toLowerCase(),r=f0[a]||s;return{bankValue:s,synthName:r,isDrum:Ri.has(s)}}applySelectedInstrumentToPattern(){const e=this.getChannelTextarea();if(!e)return;let t=e.value||"";if(!t.trim())return;const s=this.getSelectedBankInfo();if(s){if(s.isDrum)t.includes(".bank(")?t=t.replace(/\.bank\s*\([^)]*\)/gi,`.bank("${s.bankValue}")`):t=`${t}.bank("${s.bankValue}")`;else{const a=/\.\s*(s|sound)\s*\(\s*["'][^"']*["']\s*\)/gi;a.test(t)?t=t.replace(a,`.s("${s.synthName}")`):t=`${t}.s("${s.synthName}")`}e.value=t,this.updatePatternLineNumbers()}}handleTitleInputChange(){if(!this.channelTitleInput)return;const e=this.channelTitleInput.value||"";this.channelTitleAuto=e.trim().length===0}handleBankChange(e){const t=Ad(e),s=(t==null?void 0:t.bankValue)||"",a=!!s&&Ri.has(s);this.channelEditorState.bankValue=s,this.channelEditorState.bankSelectionRaw=(t==null?void 0:t.rawValue)||"",this.channelEditorState.vcslInstrument=t!=null&&t.isVcslInstrument?t.vcslInstrument:"",this.autoFillTitleFromBank(),!a&&this.channelEditorState.mode!=="code"?(this.setChannelEditorMode("code"),this.syncCodeAnnotationsFromState()):(this.channelEditorState.mode==="step"?this.syncCodeFromGrid():this.syncCodeAnnotationsFromState(),this.updateTheoryBlockVisibility())}autoFillTitleFromBank(){var t;if(!this.channelTitleAuto||!this.channelTitleInput||!this.bankSelect)return;const e=(t=this.bankSelect.selectedOptions)==null?void 0:t[0];e&&e.textContent&&(this.channelTitleInput.value=e.textContent.trim())}handleTimeSignatureChange(e){const t=Gp[e]?e:Pb;this.channelEditorState.timeSignature=t,this.channelEditorState.stepsPerBar=Gp[t]||16,this.channelEditorState.gridSelections=this.createEmptyGridSelections(this.channelEditorState.stepsPerBar),this.buildStepEditorGrid(),this.channelEditorState.mode==="step"&&this.syncCodeFromGrid()}handleKeyChange(e){this.channelEditorState.key=e||"",this.syncCodeAnnotationsFromState(),this.applySelectedInstrumentToPattern()}handleScaleChange(e){this.channelEditorState.scale=e||"",this.syncCodeAnnotationsFromState(),this.applySelectedInstrumentToPattern()}handleChordSelection(e){if(!e)return;const t=fBe.find(a=>a.id===e);if(!t)return;const s=this.channelEditorState.noteMode===ad.SEMITONE?t.semitoneSnippet:t.noteSnippet;s&&(this.channelEditorState.mode==="step"&&this.setChannelEditorMode("code"),this.insertSnippetIntoCode(s.trim()),this.channelLastChordLabel=t.label,this.chordSelect.value="",this.syncCodeAnnotationsFromState(),this.applySelectedInstrumentToPattern())}handleNoteModeToggle(e,t={}){this.channelEditorState.noteMode=e?ad.SEMITONE:ad.NOTE,!t.silent&&this.channelEditorState.mode==="code"&&this.syncCodeAnnotationsFromState(),this.noteModeLabel&&(this.noteModeLabel.textContent=e?"Semitone steps":"Note names"),this.noteToggle&&(this.noteToggle.checked=e)}insertSnippetIntoCode(e){const t=this.getChannelTextarea();if(!t||!e)return;const s=t.value.trimEnd();t.value=s?`${s}
${e}
`:`${e}
`,this.updatePatternLineNumbers(),t.focus()}getChannelTextarea(){var e;return this.channelTextarea&&this.channelTextarea.isConnected?this.channelTextarea:(this.channelTextarea=((e=this.root)==null?void 0:e.querySelector("#collab-channel-code"))||null,this.channelTextarea)}setChannelEditorMode(e="code"){var s;const t=e==="step"?"step":"code";if(this.channelEditorState.mode===t){this.updateEditorModeButtons(),this.updateEditorModeVisibility();return}this.channelEditorState.mode=t,t==="step"?(this.populateGridFromCode(((s=this.getChannelTextarea())==null?void 0:s.value)||""),this.syncCodeFromGrid()):this.syncCodeAnnotationsFromState(),this.updateEditorModeButtons(),this.updateEditorModeVisibility(),this.updateTheoryBlockVisibility()}updateEditorModeButtons(){var s,a;this.modeToggleSwitch&&(this.modeToggleSwitch.checked=this.channelEditorState.mode==="step");const e=(s=this.root)==null?void 0:s.querySelector(".collab-mode-label--code"),t=(a=this.root)==null?void 0:a.querySelector(".collab-mode-label--step");e&&e.classList.toggle("active",this.channelEditorState.mode==="code"),t&&t.classList.toggle("active",this.channelEditorState.mode==="step")}updateEditorModeVisibility(){var o,i,l;const e=(o=this.root)==null?void 0:o.querySelector("#collab-step-editor"),t=(i=this.root)==null?void 0:i.querySelector("#collab-time-signature-group"),s=(l=this.root)==null?void 0:l.querySelector(".collab-channel-editor"),a=this.getChannelTextarea(),r=this.channelEditorState.mode==="step";e&&(e.hidden=!r),t&&(t.hidden=!r),a&&(a.readOnly=r,a.classList.toggle("pattern-editor-readonly",r)),s&&s.classList.toggle("collab-code-readonly",r)}buildStepEditorGrid(){var a;const e=(a=this.root)==null?void 0:a.querySelector("#collab-step-grid");if(!e)return;const t=this.channelEditorState.stepsPerBar||16,s=this.channelEditorState.gridSelections&&Object.values(this.channelEditorState.gridSelections)[0]&&Object.values(this.channelEditorState.gridSelections)[0].length===t?this.channelEditorState.gridSelections:this.createEmptyGridSelections(t);this.channelEditorState.gridSelections=s,e.innerHTML="",kb.forEach(r=>{var c;const o=document.createElement("div");o.className="collab-step-row";const i=document.createElement("span");i.className="collab-step-label",i.textContent=r.label,o.appendChild(i);const l=document.createElement("div");l.className="collab-step-cells",l.style.gridTemplateColumns=`repeat(${t}, minmax(18px, 1fr))`;for(let u=0;u<t;u+=1){const h=document.createElement("label");h.className="collab-step-cell",u%4===0&&h.classList.add("beat");const m=document.createElement("input");m.type="checkbox",m.checked=!!((c=s[r.key])!=null&&c[u]),m.addEventListener("change",()=>{this.handleStepCheckboxChange(r.key,u,m.checked)}),h.appendChild(m),l.appendChild(h)}o.appendChild(l),e.appendChild(o)})}handleStepCheckboxChange(e,t,s){this.channelEditorState.gridSelections[e]||(this.channelEditorState.gridSelections[e]=new Array(this.channelEditorState.stepsPerBar).fill(!1)),this.channelEditorState.gridSelections[e][t]=s,this.syncCodeFromGrid()}syncCodeFromGrid(){if(this.channelEditorState.mode!=="step")return;const e=this.getChannelTextarea();if(!e)return;const t=this.generatePatternFromGrid(),s=this.applyCodeAnnotations(t);e.value=s,this.updatePatternLineNumbers()}syncCodeAnnotationsFromState(){const e=this.getChannelTextarea();if(!e)return;if(this.channelEditorState.mode==="step"){this.syncCodeFromGrid();return}const s=this.collectChannelAnnotations().map(({label:i,value:l})=>`${jk} ${i}: ${l}`),r=e.value.split(`
`).filter(i=>!i.startsWith(jk)).join(`
`).trim(),o=[s.length?s.join(`
`):"",r].filter(Boolean).join(`
`);e.value=o.trim(),this.updatePatternLineNumbers()}collectChannelAnnotations(){const e=[],t=this.getSelectedBankLabel();return t&&e.push({label:"Bank",value:t}),this.channelEditorState.timeSignature&&e.push({label:"Signature",value:this.channelEditorState.timeSignature}),this.channelEditorState.key&&e.push({label:"Key",value:this.channelEditorState.key}),this.channelEditorState.scale&&e.push({label:"Scale",value:this.channelEditorState.scale}),this.channelLastChordLabel&&e.push({label:"Chords",value:this.channelLastChordLabel}),this.channelEditorState.noteMode===ad.SEMITONE&&e.push({label:"Note mode",value:"Semitone"}),e}getSelectedBankLabel(){var t,s;if(!this.bankSelect)return"";const e=(t=this.bankSelect.selectedOptions)==null?void 0:t[0];return((s=e==null?void 0:e.textContent)==null?void 0:s.trim())||""}generatePatternFromGrid(){const e=this.channelEditorState.stepsPerBar||16,t=[];for(let a=0;a<e;a+=1){const r=[];kb.forEach(o=>{var i;(i=this.channelEditorState.gridSelections[o.key])!=null&&i[a]&&r.push(o.sample)}),r.length===0?t.push("~"):r.length===1?t.push(r[0]):t.push(`[${r.join(" ")}]`)}let s=`s("${t.join(" ")}")`;return this.channelEditorState.bankValue&&(s+=`.bank("${this.channelEditorState.bankValue}")`),s}applyCodeAnnotations(e){const t=this.collectChannelAnnotations();return t.length?`${t.map(({label:a,value:r})=>`${jk} ${a}: ${r}`).join(`
`)}
${e}`.trim():e}populateGridFromCode(e){if(!e){this.channelEditorState.gridSelections=this.createEmptyGridSelections(this.channelEditorState.stepsPerBar),this.buildStepEditorGrid();return}const t=e.match(/s\("([^"]*)"\)/i);if(!t||!t[1]){this.channelEditorState.gridSelections=this.createEmptyGridSelections(this.channelEditorState.stepsPerBar),this.buildStepEditorGrid();return}const a=t[1].split(/\s+/).filter(Boolean),r=Object.entries(Gp).find(([,l])=>l===a.length);r&&(this.channelEditorState.timeSignature=r[0],this.channelEditorState.stepsPerBar=r[1],this.timeSignatureSelect&&(this.timeSignatureSelect.value=r[0]));const o=this.channelEditorState.stepsPerBar,i=this.createEmptyGridSelections(o);for(let l=0;l<o;l+=1){const c=a[l];if(!c)continue;const u=this.parseTokenSamples(c);kb.forEach(h=>{i[h.key][l]=u.includes(h.sample)})}this.channelEditorState.gridSelections=i,this.buildStepEditorGrid()}parseTokenSamples(e){if(!e)return[];let t=e.trim();return!t||t==="~"?[]:((t.startsWith("[")&&t.endsWith("]")||t.startsWith("{")&&t.endsWith("}"))&&(t=t.slice(1,-1)),t=t.replace(/[,]+/g," "),t.split(/\s+/).map(s=>s.trim()).filter(Boolean))}attachEvents(){var t,s,a,r,o,i,l,c,u,h,m,f,v,O,k,M,E,I,D,F,_,$,Z,ce,U,ue,W,de,be,ke,Ce,Ae,q,Ne,Re,je,me,Ye,ft;(t=this.closeBtn)==null||t.addEventListener("click",()=>{this.hide()}),(s=this.overlay)==null||s.addEventListener("click",_e=>{_e.target===this.overlay&&this.hide()}),(r=(a=this.root)==null?void 0:a.querySelector("#collab-create-btn"))==null||r.addEventListener("click",()=>{this.handleCreateSession()}),(i=(o=this.root)==null?void 0:o.querySelector("#collab-leave-btn"))==null||i.addEventListener("click",()=>{this.handleLeaveSession()}),(c=(l=this.root)==null?void 0:l.querySelector("#collab-load-editor-btn"))==null||c.addEventListener("click",()=>{this.populateFromEditor()}),(h=(u=this.root)==null?void 0:u.querySelector("#collab-push-draft-btn"))==null||h.addEventListener("click",()=>{this.handleChannelSubmit("draft")}),(f=(m=this.root)==null?void 0:m.querySelector("#collab-publish-btn"))==null||f.addEventListener("click",()=>{this.handleChannelSubmit("live")}),(O=(v=this.root)==null?void 0:v.querySelector("#collab-play-master-btn"))==null||O.addEventListener("click",()=>{this.toggleMasterPlayback()}),(M=(k=this.root)==null?void 0:k.querySelector("#collab-refresh-session-btn"))==null||M.addEventListener("click",()=>{var _e;(_e=this.currentSnapshot)!=null&&_e.slug&&this.fetchSnapshot(this.currentSnapshot.slug)}),(I=(E=this.root)==null?void 0:E.querySelector("#collab-refresh-cpu-btn"))==null||I.addEventListener("click",()=>{var _e;(_e=this.currentSnapshot)!=null&&_e.slug&&this.fetchCpuStats(this.currentSnapshot.id||this.currentSnapshot.slug)}),(F=(D=this.root)==null?void 0:D.querySelector("#collab-refresh-invites-btn"))==null||F.addEventListener("click",()=>{this.refreshUserInvites()}),($=(_=this.root)==null?void 0:_.querySelector("#collab-refresh-recents-btn"))==null||$.addEventListener("click",()=>{this.refreshRecentSessions()}),(ce=(Z=this.root)==null?void 0:Z.querySelector("#collab-invite-search"))==null||ce.addEventListener("input",_e=>{const Ge=_e.target.value.trim();this.scheduleInviteSearch(Ge)}),(ue=(U=this.root)==null?void 0:U.querySelector("#collab-invite-results"))==null||ue.addEventListener("click",_e=>{const Ge=_e.target.closest("[data-add-invitee]");if(!Ge)return;const pt=Ge.getAttribute("data-add-invitee"),rt=this.inviteSearchResults.find(tn=>tn.id===pt);rt&&this.addInvitee(rt)}),(de=(W=this.root)==null?void 0:W.querySelector("#collab-selected-invitees"))==null||de.addEventListener("click",_e=>{const Ge=_e.target.closest("[data-remove-invitee]");if(!Ge)return;const pt=Ge.getAttribute("data-remove-invitee");this.removeInvitee(pt)}),(ke=(be=this.root)==null?void 0:be.querySelector("#collab-send-invite-btn"))==null||ke.addEventListener("click",()=>{this.handleSendInvite()}),(Ae=(Ce=this.root)==null?void 0:Ce.querySelector("#collab-master-pattern"))==null||Ae.addEventListener("click",_e=>{const Ge=_e.target.closest("[data-remove-master-id]");if(!Ge)return;const pt=Ge.getAttribute("data-remove-master-id");this.handleRemoveChannelFromMaster(pt)}),(Ne=(q=this.root)==null?void 0:q.querySelector("#collab-my-invites"))==null||Ne.addEventListener("click",_e=>{const Ge=_e.target.closest("[data-accept-invite]");if(Ge){const rt=Ge.getAttribute("data-accept-invite");rt&&this.handleRespondInvite(rt,!0);return}const pt=_e.target.closest("[data-decline-invite]");if(pt){const rt=pt.getAttribute("data-decline-invite");rt&&this.handleRespondInvite(rt,!1)}});const e=(Re=this.root)==null?void 0:Re.querySelector("#collab-recents-list");e&&(e.addEventListener("click",_e=>{const Ge=_e.target.closest("[data-remove-session-id]");if(Ge){_e.preventDefault(),_e.stopPropagation();const tn=Ge.getAttribute("data-remove-session-id");tn&&this.handleRecentSessionRemoval(tn);return}const pt=_e.target.closest("[data-collab-session-id]");if(!pt)return;const rt=pt.getAttribute("data-collab-session-id");rt&&this.connectToSession(rt)}),e.addEventListener("keydown",_e=>{const Ge=_e.target.closest("[data-collab-session-id]");if(Ge&&(_e.key==="Enter"||_e.key===" ")){_e.preventDefault();const pt=Ge.getAttribute("data-collab-session-id");pt&&this.connectToSession(pt)}})),(me=(je=this.root)==null?void 0:je.querySelector("#collab-delay-slider"))==null||me.addEventListener("input",_e=>{const Ge=Number(_e.target.value),pt=this.root.querySelector("#collab-delay-value");pt&&(pt.textContent=`${Ge} ms`)}),(ft=(Ye=this.root)==null?void 0:Ye.querySelector("#collab-delay-slider"))==null||ft.addEventListener("change",_e=>{var pt;const Ge=Number(_e.target.value);(pt=this.currentSnapshot)!=null&&pt.id&&vr.updateDelay(this.currentSnapshot.id,Ge).catch(rt=>{console.error("Delay update failed",rt),this.setStatus(rt.message||"Failed to update delay",rn.error)})})}bindSocketEvents(){this.boundHandlers.push(this.socketClient.on("connect",()=>{this.updateConnectionIndicator(!0)})),this.boundHandlers.push(this.socketClient.on("disconnect",()=>{this.updateConnectionIndicator(!1)})),this.boundHandlers.push(this.socketClient.on("error",e=>{this.setStatus((e==null?void 0:e.message)||"Socket error",rn.error)})),this.boundHandlers.push(this.socketClient.on("auth:error",e=>{this.setStatus((e==null?void 0:e.error)||"Authentication required",rn.error)})),this.boundHandlers.push(this.socketClient.on("session:snapshot",e=>{this.updateSnapshot(e)})),this.boundHandlers.push(this.socketClient.on("master:updated",e=>{e!=null&&e.masterCode&&(this.setStatus("Master updated across collaborators",rn.info,2e3),this.currentSnapshot?(this.currentSnapshot.masterCode=e.masterCode,this.renderMasterPattern(this.currentSnapshot,e.masterCode)):this.renderMasterPattern(null,e.masterCode))}))}updateConnectionIndicator(e){var s;const t=(s=this.root)==null?void 0:s.querySelector("#collab-connection-indicator");t&&t.classList.toggle("connected",!!e)}async handleCreateSession(){var s,a;const e=(s=this.root)==null?void 0:s.querySelector("#collab-title-input"),t=(a=e==null?void 0:e.value)==null?void 0:a.trim();if(!t){this.setStatus("Enter a session title first.",rn.error);return}try{this.setStatus("Creating session…",rn.info);const r=await vr.createSession(t);this.updateSnapshot(r),await this.socketClient.joinSession(r.id),await this.refreshRecentSessions(),this.setStatus("Session created. Share the code with your friends!",rn.success,4e3)}catch(r){console.error("Create session failed",r),this.setStatus(r.message||"Failed to create session",rn.error)}}async handleLeaveSession(){var e;if((e=this.currentSnapshot)!=null&&e.id)try{await vr.leaveSession(this.currentSnapshot.id),await this.socketClient.leaveSession(this.currentSnapshot.id),await this.clearCurrentSessionState({notify:!1,skipSocketLeave:!0}),this.setStatus("You left the session.",rn.info,2e3),await this.refreshRecentSessions()}catch(t){console.error("Leave session failed",t),this.setStatus(t.message||"Failed to leave session",rn.error)}}async clearCurrentSessionState({notify:e=!0,skipSocketLeave:t=!1}={}){var a;const s=(a=this.currentSnapshot)==null?void 0:a.id;if(s&&!t)try{await this.socketClient.leaveSession(s)}catch(r){console.warn("⚠️ Unable to leave collaboration socket:",r)}this.currentSnapshot=null,this.channelEditorState=this.createDefaultEditorState(),this.channelTitleAuto=!0,this.channelTitleInput&&(this.channelTitleInput.value=""),this.channelTextarea&&(this.channelTextarea.value="",this.updatePatternLineNumbers()),this.bankSelect&&(this.bankSelect.value=""),this.keySelect&&(this.keySelect.value=""),this.scaleSelect&&(this.scaleSelect.value="chromatic"),this.noteToggle&&(this.noteToggle.checked=!1),this.noteModeLabel&&(this.noteModeLabel.textContent="Note names"),this.channelEditorState.gridSelections=this.createEmptyGridSelections(this.channelEditorState.stepsPerBar),this.buildStepEditorGrid(),this.setChannelEditorMode("code"),this.updateTheoryBlockVisibility(),this.renderParticipants([]),this.renderChannels([]),this.renderMasterPattern(null),this.renderEmptyState(),this.updateMasterPlayButton(!1);try{oe!=null&&oe.stopAllSounds&&await oe.stopAllSounds(),Vn==null||Vn("master-pattern","")}catch(r){console.warn("⚠️ Unable to fully reset master playback:",r)}e&&this.setStatus("Session cleared. Start a new session to collaborate.",rn.info,2500)}async handleChannelSubmit(e="draft"){var s;if(!((s=this.currentSnapshot)!=null&&s.id)){this.setStatus("Join a session first.",rn.error);return}const t=this.collectChannelFormValues();if(!t.code){this.setStatus("Write a pattern before pushing.",rn.error);return}try{this.setStatus(e==="live"?"Publishing…":"Saving draft…",rn.info),await this.socketClient.pushChannelDraft({sessionId:this.currentSnapshot.id,code:t.code,name:t.name,metadata:t.metadata,status:e}),e==="live"?this.setStatus("Published to master.",rn.success,2500):this.setStatus("Draft saved.",rn.success,2500)}catch(a){console.error("Channel submit failed",a),this.setStatus(a.message||"Failed to push channel",rn.error)}}collectChannelFormValues(){var i,l,c,u,h,m,f,v,O,k,M,E;const e=(i=this.root)==null?void 0:i.querySelector("#collab-channel-code"),t=(l=this.root)==null?void 0:l.querySelector("#collab-channel-title");((c=this.channelEditorState)==null?void 0:c.mode)==="step"&&this.syncCodeFromGrid();const s=((u=t==null?void 0:t.value)==null?void 0:u.trim())||"",a={},r=(m=(h=this.channelEditorState)==null?void 0:h.bankValue)==null?void 0:m.trim(),o=this.getSelectedBankLabel();return r&&(a.soundBank=r),o&&(a.soundBankLabel=o),(f=this.channelEditorState)!=null&&f.timeSignature&&(a.timeSignature=this.channelEditorState.timeSignature),(v=this.channelEditorState)!=null&&v.key&&(a.key=this.channelEditorState.key),(O=this.channelEditorState)!=null&&O.scale&&this.channelEditorState.scale!=="chromatic"&&(a.scale=this.channelEditorState.scale),(k=this.channelEditorState)!=null&&k.mode&&(a.editorMode=this.channelEditorState.mode),(M=this.channelEditorState)!=null&&M.noteMode&&(a.noteMode=this.channelEditorState.noteMode),this.channelLastChordLabel&&(a.chords=this.channelLastChordLabel),s&&(a.title=s),{code:((E=e==null?void 0:e.value)==null?void 0:E.trim())||"",name:s||null,metadata:Object.keys(a).length?a:void 0}}populateFromEditor(){var e,t;try{const s=Qn("master-pattern");if(!s){this.setStatus("Master editor is empty.",rn.error,2e3);return}const a=(e=this.root)==null?void 0:e.querySelector("#collab-channel-code");a&&(a.value=s.trim(),this.updatePatternLineNumbers(),a.focus(),((t=this.channelEditorState)==null?void 0:t.mode)==="step"?(this.populateGridFromCode(a.value),this.syncCodeFromGrid()):this.syncCodeAnnotationsFromState()),this.setStatus("Copied master editor content into snippet box.",rn.info,2e3)}catch(s){console.warn("Unable to read master editor value",s),this.setStatus("Master editor is not ready yet.",rn.error)}}async fetchSnapshot(e,{silent:t=!1}={}){try{const s=await vr.getSession(e,{refresh:!0});this.updateSnapshot(s),t||this.setStatus("Snapshot refreshed.",rn.info,2e3)}catch(s){console.error("Fetch snapshot failed",s),this.setStatus(s.message||"Failed to refresh snapshot",rn.error)}}async fetchCpuStats(e){var t,s,a;try{const r=await vr.getCpuStats(e),o=(a=(s=(t=r==null?void 0:r.cpuStats)==null?void 0:t.recentServerSamples)==null?void 0:s.slice(-1))==null?void 0:a[0];o&&(this.updateCpuStats(o),this.setStatus("CPU stats refreshed.",rn.info,2e3))}catch(r){console.error("Fetch CPU failed",r),this.setStatus(r.message||"Failed to refresh CPU stats",rn.error)}}updateSnapshot(e){var c,u,h,m,f,v,O;if(!e)return;this.currentSnapshot=e;const t=(c=this.root)==null?void 0:c.querySelector("#collab-session-details");t&&(t.hidden=!1);const s=(u=this.root)==null?void 0:u.querySelector("#collab-session-label");s&&(s.textContent=`Session: ${e.title} (${e.slug})`);const a=(h=this.root)==null?void 0:h.querySelector("#collab-share-code");a&&(a.textContent=e.slug);const r=(m=this.root)==null?void 0:m.querySelector("#collab-delay-slider"),o=(f=this.root)==null?void 0:f.querySelector("#collab-delay-value");r&&(r.value=e.applyDelayMs??0),o&&(o.textContent=`${e.applyDelayMs??0} ms`),(e.applyDelayMs??0)>0&&this.setStatus(`Master updates apply after ${e.applyDelayMs} ms to protect playback.`,rn.info,3e3);const i=(v=this.root)==null?void 0:v.querySelector("#collab-owner-tools");i&&(i.hidden=!(this.currentUser&&e.owner&&this.currentUser.id===e.owner.id)),this.renderParticipants(e.participants||[]),this.renderChannels(e.channels||[]);const l=((O=e.cpuStats)==null?void 0:O.recentServerSamples)||[];l.length&&this.updateCpuStats(l[l.length-1]),this.renderMasterPattern(e)}renderParticipants(e){var s;const t=(s=this.root)==null?void 0:s.querySelector("#collab-participants-list");if(t){if(!e.length){t.innerHTML='<li class="empty">No collaborators yet.</li>';return}t.innerHTML=e.map(a=>{var o,i;return`<li>
        <span>${((o=a.user)==null?void 0:o.artistName)||((i=a.user)==null?void 0:i.name)||"Unknown"}</span>
        <span class="role">${a.role}</span>
      </li>`}).join("")}}renderChannels(e){var a;const t=(a=this.root)==null?void 0:a.querySelector("#collab-channels-container");if(!t)return;const s=(e||[]).filter(r=>iN.has(r.status));if(!s.length){t.innerHTML='<div class="empty">Publish a channel to see it here.</div>';return}t.innerHTML=s.slice(0,5).map(r=>{var l,c;const o=r.updatedAt?new Date(r.updatedAt).toLocaleString():"",i=((l=r.user)==null?void 0:l.artistName)||((c=r.user)==null?void 0:c.name)||"anonymous";return`
        <div class="collab-channel-card">
          <div class="collab-channel-card__header">
            <span>${r.name||"Untitled channel"}</span>
            <span class="badge ${r.status}">${r.status}</span>
          </div>
          <div class="collab-channel-card__meta">
            <span>By ${i}</span>
            <span>${o}</span>
          </div>
          <pre>${r.code.slice(0,220)}${r.code.length>220?"…":""}</pre>
        </div>
      `}).join("")}renderMasterPattern(e,t=""){var r;const s=(r=this.root)==null?void 0:r.querySelector("#collab-master-pattern");if(!s)return;const a=Array.isArray(e==null?void 0:e.channels)?e.channels.filter(o=>!o||!iN.has(o.status)?!1:!!(o.code&&o.code.trim().length)):[];if(!a.length){const o=(t||(e==null?void 0:e.masterCode)||"").trim();o?s.innerHTML=`<pre>${this.escapeHtml(o)}</pre>`:s.innerHTML='<div class="collab-master-empty">No published channels yet. Publish a channel to build the master.</div>',this.updateMasterPlayButton(!1);return}s.innerHTML=a.map(o=>this.renderMasterChannelBlock(o)).join(""),this.updateMasterPlayButton(oe==null?void 0:oe.masterActive)}renderMasterChannelBlock(e){var h,m,f,v,O;const t=e.name||e.elementId||"Untitled channel",s=((h=e.user)==null?void 0:h.artistName)||((m=e.user)==null?void 0:m.name)||"anonymous",a=(e.code||"").trim(),o=`${`// ${t} — ${s}`}
${a}`.trim(),i=this.getUserColor(e),l=this.escapeHtml(t),u=!!this.currentUser&&(this.currentUser.id===((f=e.user)==null?void 0:f.id)||this.currentUser.id===((O=(v=this.currentSnapshot)==null?void 0:v.owner)==null?void 0:O.id))?`<button type="button" class="collab-master-block__remove" data-remove-master-id="${e.id}" aria-label="Remove ${l}">&times;</button>`:"";return`
      <div class="collab-master-block" data-master-channel-id="${e.id}" style="--author-bg:${i.bg}; --author-border:${i.border};">
        ${u}
        <div class="collab-master-block__meta">
          <span>${l}</span>
          <span>${this.escapeHtml(s)}</span>
        </div>
        <pre>${this.escapeHtml(o)}</pre>
      </div>
    `}getUserColor(e){var s,a,r;const t=((s=e==null?void 0:e.user)==null?void 0:s.id)||((a=e==null?void 0:e.user)==null?void 0:a.artistName)||((r=e==null?void 0:e.user)==null?void 0:r.name)||(e==null?void 0:e.id)||(e==null?void 0:e.elementId)||`anonymous-${(e==null?void 0:e.status)||"unknown"}`;if(!this.userColorAssignments.has(t)){const o=lN[this.userColorIndex%lN.length];this.userColorAssignments.set(t,o),this.userColorIndex+=1}return this.userColorAssignments.get(t)}escapeHtml(e=""){const t=document.createElement("div");return t.textContent=e??"",t.innerHTML}updateCpuStats(e){var r,o,i;const t=(r=this.root)==null?void 0:r.querySelector("#collab-cpu-load"),s=(o=this.root)==null?void 0:o.querySelector("#collab-cpu-updated"),a=(i=this.root)==null?void 0:i.querySelector("#collab-cpu-warning");if(t){const l=Array.isArray(e.loadAvg)?e.loadAvg[0]:e.loadAvg;t.textContent=typeof l=="number"?`${l.toFixed(2)}`:"n/a"}s&&(s.textContent=e.timestamp?new Date(e.timestamp).toLocaleTimeString():"—"),a&&(a.textContent=e.warning||"",a.style.display=e.warning?"inline-flex":"none"),e.warning&&this.setStatus(e.warning,rn.error,4e3)}async refreshUserInvites(){if(!this.currentUser){this.pendingInvites=[],this.renderPendingInvites();return}try{this.pendingInvites=await vr.getPendingInvites(),this.renderPendingInvites()}catch(e){console.error("Failed to load invites:",e),this.setStatus(e.message||"Failed to load invites",rn.error,3e3)}}renderPendingInvites(){var t;const e=(t=this.root)==null?void 0:t.querySelector("#collab-my-invites");if(e){if(!this.currentUser){e.classList.add("collab-empty-state"),e.innerHTML="Login to see your invitations.";return}if(!this.pendingInvites.length){e.classList.add("collab-empty-state"),e.innerHTML="No pending invites.";return}e.classList.remove("collab-empty-state"),e.innerHTML=this.pendingInvites.map(s=>{var i,l;const a=((i=s.inviter)==null?void 0:i.name)||"Someone",r=((l=s.session)==null?void 0:l.title)||"Untitled session",o=s.createdAt?new Date(s.createdAt).toLocaleString():"";return`
          <div class="collab-invite-card">
            <div class="collab-invite-card__details">
              <strong>${r}</strong>
              <span>Invited by ${a}</span>
              <span class="collab-invite-card__meta">${o}</span>
            </div>
            <div class="collab-invite-card__actions">
              <button class="btn-primary btn-small" data-accept-invite="${s.id}">Accept</button>
              <button class="btn-ghost btn-small" data-decline-invite="${s.id}">Decline</button>
            </div>
          </div>
        `}).join("")}}async handleRespondInvite(e,t){if(e)try{this.setStatus(t?"Accepting invite…":"Declining invite…",rn.info);const s=t?await vr.acceptInvite(e):await vr.declineInvite(e);await this.refreshUserInvites(),t&&(s!=null&&s.session)?(this.updateSnapshot(s.session),await this.socketClient.joinSession(s.session.id),await this.refreshRecentSessions(),this.setStatus("Invite accepted. Connected to session.",rn.success,3e3)):t?this.setStatus("Invite accepted.",rn.success,2e3):this.setStatus("Invite declined.",rn.info,2e3)}catch(s){console.error("Failed to respond to invite:",s),this.setStatus(s.message||"Failed to respond to invite",rn.error,3e3)}}async handleSendInvite(){var e;if(!((e=this.currentSnapshot)!=null&&e.id)){this.setStatus("Start a session before inviting collaborators.",rn.error,3e3);return}if(!this.selectedInvitees.length){this.setStatus("Select up to five users to invite.",rn.error,2500);return}try{this.setStatus("Sending invites…",rn.info);const t=this.selectedInvitees.map(s=>s.id);await vr.sendInvites(this.currentSnapshot.id,t),this.selectedInvitees=[],this.renderSelectedInvitees(),this.setStatus(`Invitations sent to ${t.length} user${t.length>1?"s":""}.`,rn.success,2500),this.refreshUserInvites()}catch(t){console.error("Failed to send invite:",t),this.setStatus(t.message||"Failed to send invite",rn.error,3e3)}}async refreshRecentSessions(){if(!this.currentUser){this.recentSessions=[],this.renderRecentSessions();return}try{this.recentSessions=await vr.listRecentSessions(),this.renderRecentSessions()}catch(e){console.error("Failed to fetch recent sessions:",e),this.setStatus(e.message||"Failed to load recent sessions",rn.error,3e3)}}renderRecentSessions(){var t;const e=(t=this.root)==null?void 0:t.querySelector("#collab-recents-list");if(e){if(!this.currentUser){e.classList.add("collab-empty-state"),e.innerHTML="Login to see your recent collaborations.";return}if(!this.recentSessions.length){e.classList.add("collab-empty-state"),e.innerHTML="No recent sessions yet.";return}e.classList.remove("collab-empty-state"),e.innerHTML=this.recentSessions.map(s=>{var i,l;const a=s.updatedAt?new Date(s.updatedAt).toLocaleString():"—",r=((i=s.owner)==null?void 0:i.id)||"",o=r&&r===((l=this.currentUser)==null?void 0:l.id)?"Delete session":"Leave session";return`
          <div class="collab-chip" data-collab-session-id="${s.id}" role="button" tabindex="0">
            <div class="collab-chip__content">
              <span>${s.title}</span>
              <span class="collab-chip__meta">${a}</span>
            </div>
            <button type="button" class="collab-chip-remove" data-remove-session-id="${s.id}" aria-label="${o}">&times;</button>
          </div>
        `}).join("")}}async handleRecentSessionRemoval(e){var r,o;if(!e||!this.currentUser)return;const t=this.recentSessions.find(i=>i.id===e),s=((r=t==null?void 0:t.owner)==null?void 0:r.id)===this.currentUser.id,a=((o=this.currentSnapshot)==null?void 0:o.id)===e;try{this.setStatus(s?"Deleting session…":"Leaving session…",rn.info),s?await vr.deleteSession(e):await vr.leaveSession(e),a&&await this.clearCurrentSessionState({notify:!1}),await this.refreshRecentSessions();const i=a?"Session cleared. Start a new session to collaborate.":s?"Session deleted.":"Removed from session.";this.setStatus(i,rn.success,2200)}catch(i){console.error("Failed to update session membership:",i),this.setStatus(i.message||"Failed to update recent session",rn.error,3e3)}}async handleRemoveChannelFromMaster(e){var t;if(!(!e||!((t=this.currentSnapshot)!=null&&t.id)))try{this.setStatus("Removing channel from master…",rn.info),await vr.publishChannel(this.currentSnapshot.id,e,"draft");const s=this.currentSnapshot.slug||this.currentSnapshot.id;s&&await this.fetchSnapshot(s,{silent:!0}),this.setStatus("Channel removed from master.",rn.success,2200)}catch(s){console.error("Failed to remove master channel:",s),this.setStatus(s.message||"Failed to remove channel from master",rn.error,3e3)}}scheduleInviteSearch(e){if(this.inviteSearchTimeout&&clearTimeout(this.inviteSearchTimeout),!e){this.inviteSearchResults=[],this.renderInviteSearchResults();return}this.inviteSearchTimeout=setTimeout(()=>{this.performInviteSearch(e)},250)}async performInviteSearch(e){try{const t=await Bl.listUsers(e,10);this.inviteSearchResults=t.filter(s=>{var a;return s.id!==((a=this.currentUser)==null?void 0:a.id)}),this.renderInviteSearchResults()}catch(t){console.error("Invite search failed:",t),this.inviteSearchResults=[],this.renderInviteSearchResults("Failed to search users. Try again.")}}renderInviteSearchResults(e){var s;const t=(s=this.root)==null?void 0:s.querySelector("#collab-invite-results");if(t){if(e){t.classList.add("collab-empty-state"),t.innerHTML=e;return}if(!this.inviteSearchResults.length){t.classList.add("collab-empty-state"),t.innerHTML="Start typing to search users.";return}t.classList.remove("collab-empty-state"),t.innerHTML=this.inviteSearchResults.map(a=>{var i;const r=this.selectedInvitees.some(l=>l.id===a.id)||this.selectedInvitees.length>=5,o=((i=a.artistName)==null?void 0:i.trim())||a.name||a.email||"Unnamed";return`
          <button class="collab-invite-result${r?" disabled":""}" data-add-invitee="${a.id}" ${r?"disabled":""}>
            <span>${o}</span>
            <span class="collab-invite-result__meta">${a.email||""}</span>
          </button>
        `}).join("")}}addInvitee(e){if(this.selectedInvitees.length>=5){this.setStatus("You can invite up to five users at a time.",rn.error,2500);return}this.selectedInvitees.some(t=>t.id===e.id)||(this.selectedInvitees.push(e),this.renderSelectedInvitees(),this.renderInviteSearchResults())}removeInvitee(e){this.selectedInvitees=this.selectedInvitees.filter(t=>t.id!==e),this.renderSelectedInvitees(),this.renderInviteSearchResults()}renderSelectedInvitees(){var s,a;const e=(s=this.root)==null?void 0:s.querySelector("#collab-selected-invitees"),t=(a=this.root)==null?void 0:a.querySelector("#collab-selected-count");if(t&&(t.textContent=`Selected ${this.selectedInvitees.length} of 5 slots.`),!!e){if(!this.selectedInvitees.length){e.classList.add("collab-empty-state"),e.innerHTML="No users selected yet.";return}e.classList.remove("collab-empty-state"),e.innerHTML=this.selectedInvitees.map(r=>{var i;const o=((i=r.artistName)==null?void 0:i.trim())||r.name||r.email||"Unnamed";return`
          <span class="collab-selected-invitee">
            <span>${o}</span>
            <button type="button" data-remove-invitee="${r.id}" aria-label="Remove ${o}">&times;</button>
          </span>
        `}).join("")}}async connectToSession(e){if(e)try{this.setStatus("Connecting…",rn.info);const t=await vr.joinSession(e);t&&(this.updateSnapshot(t),await this.socketClient.joinSession(e),await this.refreshRecentSessions(),this.setStatus("Connected to session.",rn.success,2500))}catch(t){console.error("Failed to connect to session:",t),this.setStatus(t.message||"Failed to connect to session",rn.error,3e3)}}renderEmptyState(){var a,r,o;const e=(a=this.root)==null?void 0:a.querySelector("#collab-session-details");e&&(e.hidden=!0);const t=(r=this.root)==null?void 0:r.querySelector("#collab-owner-tools");t&&(t.hidden=!0);const s=(o=this.root)==null?void 0:o.querySelector("#collab-session-label");s&&(s.textContent="Not connected")}setStatus(e,t=rn.info,s=0){var r;const a=(r=this.root)==null?void 0:r.querySelector("#collab-status-message");a&&(a.textContent=e,a.className=`collab-status-message ${t}`,this.statusTimer&&clearTimeout(this.statusTimer),s>0&&(this.statusTimer=setTimeout(()=>{a.textContent="",a.className="collab-status-message"},s)))}}const $J={bd:"Bass drum, Kick drum",sd:"Snare drum",rim:"Rimshot",cp:"Clap",hh:"Closed hi-hat",oh:"Open hi-hat",cr:"Crash",rd:"Ride",ht:"High tom",mt:"Medium tom",lt:"Low tom",sh:"Shakers",cb:"Cowbell",tb:"Tambourine",perc:"Other percussions",misc:"Miscellaneous samples",fx:"Effects"},bBe="https://raw.githubusercontent.com/felixroos/dough-samples/main/vcsl.json";let Oh=null,fd=null;const cN="World Instruments",uN="VCSL Instruments",hN=["Chordophones","Aerophones","Membranophones","Electrophones","Idiophones"],rd=[{value:"github:tidalcycles/uzu-drumkit",label:"Uzu Drumkit (16)",samples:16},{value:"github:yaxu/clean-breaks/main",label:"Clean Breaks Main (32)",samples:32},{value:"github:yaxu/mrid",label:"Mrid (13)",samples:13},{value:"github:Bubobubobubobubo/Dough-Amiga",label:"Dough Amiga (116)",samples:116},{value:"github:Bubobubobubobubo/Dough-Fox",label:"Dough Fox (63)",samples:63},{value:"github:Bubobubobubobubo/Dough-Amen",label:"Dough Amen (3)",samples:3},{value:"github:Bubobubobubobubo/Dough-Juj",label:"Dough Juj (1)",samples:1},{value:"github:switchangel/pad",label:"Switchangel Pad",samples:0},{value:"github:mot4i/garden",label:"Garden (13)",samples:13},{value:"github:mot4i/loom",label:"Loom",samples:0},{value:"github:heavy-lifting/a-maze",label:"A-Maze (26)",samples:26},{value:"github:eddyflux/crate",label:"Eddyflux Crate (18)",samples:18},{value:"github:ibleedicare/strudel-bank",label:"Ibleedicare Strudel Bank (2)",samples:2},{value:"github:Prof12200/strudel_repo",label:"Prof12200 Strudel Repo (6)",samples:6},{value:"github:creativenucleus/strudel-m8-168-dnb-jungle",label:"Strudel M8 168 DNB Jungle (8)",samples:8},{value:"github:tidalcycles/dirt-samples",label:"Dirt Samples",samples:218}],yBe=[".wav",".wave",".mp3",".ogg",".oga",".flac",".aif",".aiff",".m4a",".mp4",".webm"],vBe={Accept:"application/vnd.github+json"},Zk=new Map,Sb=new Map,dN="strudesk_gdpr_consent_v1",Tg=(n="")=>n.replace(/^\/+|\/+$/g,""),wBe=(n="")=>{const e=n.toLowerCase();return yBe.some(t=>e.endsWith(t))},OBe=(n="")=>{if(typeof n!="string"||!n.startsWith("github:"))return null;const t=n.slice(7).split("/").filter(Boolean);if(t.length<2)return null;const s=t.shift(),a=t.shift(),r=t.length>0?t.join("/"):"";return{owner:s,repo:a,subdir:Tg(r)}},xBe=({owner:n,repo:e,branch:t,path:s})=>`https://raw.githubusercontent.com/${n}/${e}/${t}/${s}`;async function mN(n){const e=await fetch(n,{headers:vBe});if(!e.ok){let t=e.statusText;try{const s=await e.json();s!=null&&s.message&&(t=s.message)}catch{}throw new Error(`GitHub API error (${e.status}): ${t}`)}return e.json()}async function kBe(n){if(Zk.has(n))return Zk.get(n);if(Sb.has(n))return Sb.get(n);const e=(async()=>{const t=OBe(n);if(!t)throw new Error("Invalid sample pack format.");const{owner:s,repo:a,subdir:r}=t,o=await mN(`https://api.github.com/repos/${s}/${a}`),i=(o==null?void 0:o.default_branch)||"main",l=await mN(`https://api.github.com/repos/${s}/${a}/git/trees/${encodeURIComponent(i)}?recursive=1`);if(!(l!=null&&l.tree))throw new Error("GitHub repository tree data is unavailable.");const c=Tg(r),u=c?`${c}/`:"",h=l.tree.filter(f=>f.type==="blob"&&wBe(f.path)).map(f=>{if(c&&f.path!==c){if(!f.path.startsWith(u))return null}const v=c?f.path===c?f.path.split("/").pop()||f.path:f.path.slice(u.length):f.path,O=Tg(v);if(!O)return null;const k=O.split("/").pop()||O,M=k.replace(/\.[^/.]+$/,"");return{id:`${n}:${f.path}`,name:M,path:f.path,relativePath:O,fileName:k,rawUrl:xBe({owner:s,repo:a,branch:i,path:f.path})}}).filter(Boolean).sort((f,v)=>f.relativePath.localeCompare(v.relativePath));if(h.length===0)throw new Error("No audio files were found in this sample pack.");const m={audioNodes:h,meta:{owner:s,repo:a,branch:i,rootPath:c}};return Zk.set(n,m),m})().finally(()=>{Sb.delete(n)});return Sb.set(n,e),e}const BC=[{value:"mridangam",label:"Mridangam Percussion Set"}],PBe=new Set(BC.map(n=>(n.value||"").toLowerCase()).filter(Boolean)),SBe=new Set(["localhost","127.0.0.1","0.0.0.0","::1"]);typeof window<"u"&&SBe.has(window.location.hostname);const CBe=typeof window<"u"&&typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame.bind(window):n=>setTimeout(n,16),zk=new Map;let Gk=null;const Cb=(n,e)=>{n&&(zk.set(n,e),Gk===null&&(Gk=CBe(()=>{zk.forEach((t,s)=>{s.textContent=t}),zk.clear(),Gk=null})))},RJ=n=>n?n.replace(/[_-]+/g," ").replace(/\s+/g," ").trim().replace(/\b\w/g,e=>e.toUpperCase()):"",MBe=n=>{if(!n)return"";if(typeof n=="string")return n;if(Array.isArray(n))return typeof n[0]=="string"?n[0]:"";if(typeof n=="object"){const e=Object.values(n)[0];if(typeof e=="string")return e;if(Array.isArray(e)&&typeof e[0]=="string")return e[0]}return""},ABe=(n,e)=>{const t=(n||e||"").toLowerCase();return/(membranophone|idiophone|drum|percussion|bongo|cajon|shaker|triangle|tambourine|clave|cowbell|snare|kick|timpani|gong|cymbal)/i.test(t)?"drums":"world"},EBe=(n,e)=>{if(!n||!e)return n;try{return new URL(n,e).toString()}catch{return n}},$C=(n,e)=>{if(typeof n=="string")return EBe(n,e);if(Array.isArray(n))return n.map(t=>$C(t,e));if(n&&typeof n=="object"){const t={};return Object.entries(n).forEach(([s,a])=>{t[s]=$C(a,e)}),t}return n},DBe=n=>{if(!n||typeof n!="object")return n;const e=n._base||"",t={};return Object.entries(n).forEach(([s,a])=>{s!=="_base"&&(t[s]=$C(a,e))}),t},TBe=n=>{if(!n||typeof n!="string")return"Other";const e=n.match(/^([^/]+)/);if(!e)return"Other";try{const t=decodeURIComponent(e[1]);return t.charAt(0).toUpperCase()+t.slice(1)}catch{return e[1]}},FBe=n=>{const e=hN.indexOf(n);return e===-1?hN.length+1:e},NBe=async()=>Oh||fd||(fd=fetch(bBe).then(async n=>{if(!n.ok)throw new Error(`Failed to load VCSL instruments: ${n.status}`);const e=await n.json();DBe(e);const s=Object.entries(e||{}).filter(([a])=>a&&a!=="_base").map(([a,r])=>{const o=MBe(r),i=TBe(o),l=ABe(o,i);return{value:a,optionValue:`${Mv}${a}`,label:`VCSL · ${RJ(a)}`,category:l,samplePath:o,family:i,familyOrder:FBe(i)}}).sort((a,r)=>a.familyOrder!==r.familyOrder?a.familyOrder-r.familyOrder:a.label.localeCompare(r.label));return Oh=s,s}).catch(n=>(console.warn("⚠️ Unable to load VCSL instrument list:",n),Oh=[],[])).finally(()=>{fd=null}),fd),Tf={RolandTR808:"Roland TR-808",RolandTR909:"Roland TR-909",RolandTR707:"Roland TR-707",RhythmAce:"Rhythm Ace",AkaiLinn:"Akai Linn",ViscoSpaceDrum:"Visco Space Drum",CasioRZ1:"Casio RZ-1"},pN=/\b(note|n)\s*\(/i,fN=/\bn\(\s*["'][^"']*["']\s*\)/i,To=n=>!n||typeof n!="string"?!1:(pN.lastIndex=0,pN.test(n)),Fi=n=>!n||typeof n!="string"?!1:(fN.lastIndex=0,fN.test(n)),dh=n=>{if(!n)return"Channel";const e=n.match(/element-(\d+)/i);return e&&e[1]?`Channel ${e[1]}`:n},BBe=(n,e)=>{const t=dh(n),s=e?e.trim():"";if(!s||/^element\s*\d+$/i.test(s))return t;if(/^channel\s*\d+$/i.test(s))return s;const a=s.replace(/^channel\s*\d+\s*(–|-)\s*/i,"");return`${t} – ${a}`},Ho=(n,e)=>{const t=document.querySelector(`[data-sound-id="${n}"]`);if(!t)return;const s=t.querySelector(".element-title");s&&(s.textContent=BBe(n,e));const a=t.querySelector(".config-button");a&&(a.textContent=e&&e.trim()?e.trim():"Configure Sound")},Mb=n=>n?Object.prototype.hasOwnProperty.call(Tf,n)?Tf[n]:n.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Za-z])(\d+)/g,"$1 $2").trim():"",gN={RolandTR808:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"cp",label:"CP",sample:"cp"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"},{key:"cb",label:"CB",sample:"cb"},{key:"sh",label:"SH",sample:"sh"}],RolandTR909:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"cp",label:"CP",sample:"cp"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],RolandTR707:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],RhythmAce:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],AkaiLinn:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],ViscoSpaceDrum:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],CasioRZ1:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}]},$Be=[{id:"roland808-simple-bd-hh",label:"Roland 808 – Kick & Hat",bank:"RolandTR808",description:"Simple BD/HH groove shown in the step editor",pattern:'s("bd ~ hh ~ bd ~ hh ~ bd ~ hh ~ bd ~ hh ~").bank("RolandTR808")',editorBadge:"Step editor"},{id:"drum-beat-generator",label:"Beat Generator",bank:"",description:"Opens in code editor for generative BD patterns",pattern:'s("bd").bank("RolandTR808").segment(16).degradeBy(.5).ribbon(16,1)',editorBadge:"Code"},{id:"random-modifiers",label:"Random Modifiers",bank:"",description:"chooseCycles randomizes BD / HH / SD each cycle",pattern:'s(chooseCycles("bd","hh","sd")).bank("RolandTR808").fast(8)',editorBadge:"Code"},{id:"mridangam-pulse",label:"Mridangam Percussion Set",bank:"",description:"Classical tha · dhi · thom · nam motif on the mridangam bank",pattern:`"tha dhi thom nam".drop("0 -1 -2 -3").sound().bank("mridangam")

/* Available sounds: tha · dhi · dhin · thom · nam · na · ta · ka · ki · gumki · dhum · chaapu · ardha */`,editorBadge:"Code"}],_J=[{id:"independent-params",label:"Note Names and Filter Pattern",bank:"",description:"note, cutoff, gain and sound controlled independently",pattern:'note("F3 A3 C3 E3").cutoff("<500 1000 2000 [4000 8000]>").gain(.8).s("sawtooth").log()'},{id:"semitones-scale-transpose",label:"Semitones, Scale & Transpose",bank:"",description:"Transposes notes inside the scale by the number of steps",pattern:`"[-8 [2,4,6]]*2".scale('c:ionian').scaleTranspose("<0 -1 -2 -3 -4 -5 -6 -4>*2").note().s("piano")`,useNoteNames:!1},{id:"simple-arpeggios",label:"Simple Arpeggios in Semitones & Chords",bank:"",description:"Combines numeric semitones with chord progressions",pattern:'n("0 1 2 3").chord("<C Am F G>").voicing()',useNoteNames:!1},{id:"simple-backing-track",label:"Simple Backing Track",bank:"",description:"Together with layer, struct and voicings, this can be used to create a basic backing track",pattern:`"<C^7 A7b13 Dm7 G7>*2".layer(
  x => x.voicings("lefthand").struct("[~ x]*2").note(),
  x => x.rootNotes(2).note().s("sawtooth").cutoff(800)
)`},{id:"vcsl-vocal-bed",label:"VCSL World Textures",bank:"",description:"Layered Ball Whistle + Bongo textures from the VCSL set",pattern:'sound("<ballwhistle ~ bongo ~>*2").bank("vcsl").slow(2).room(.35).shape(.2)'},{id:"jazz-blues-in-f",label:"Jazz Blues in F",bank:"",description:"Classic jazz-blues progression with layered voicings and struct patterns",pattern:`(() => {
  const chords = chord(\`<

F7 Bb7 F7 [Cm7 F7]

Bb7 Bo F7 [Am7 D7]

Gm7 C7 [F7 D7] [Gm7 C7]

>\`);

  return stack(
    n("7 8 [10 9] 8").set(chords).voicing().dec(.2),
    chords.struct("- x - x").voicing().room(.5),
    n("0 - 1 -").set(chords).mode("root:g2").voicing()
  );
})()`},{id:"mini-notation-example",label:"Mini-notation Example",bank:"",description:"Layered mini-notation demo showing melody + bass progressions",pattern:`note(\`<

[e5 [b4 c5] d5 [c5 b4]]

[a4 [a4 c5] e5 [d5 c5]]

[b4 [~ c5] d5 e5]

[c5 a4 a4 ~]

[[~ d5] [~ f5] a5 [g5 f5]]

[e5 [~ c5] e5 [d5 c5]]

[b4 [b4 c5] d5 e5]

[c5 a4 a4 ~]

,

[[e2 e3]*4]

[[a2 a3]*4]

[[g#2 g#3]*2 [e2 e3]*2]

[a2 a3 a2 a3 a2 a3 b1 c2]

[[d2 d3]*4]

[[c2 c3]*4]

[[b1 b2]*2 [e2 e3]*2]

[[a1 a2]*4]

>\`)`}],RBe=[{id:"sampler-begin",label:"begin",description:"Skip the first section of each triggered sample.",tooltip:"A 0–1 pattern that trims the start of each hit (0.25 removes the first quarter).",pattern:`samples({
  "rave": "rave/AREUREADY.wav"
}, "github:tidalcycles/dirt-samples")

s("rave")
  .begin("<0 0.25 0.5 0.75>")
  .fast(2)`},{id:"sampler-end",label:"end",description:"Cut the tail of the sample instead of the beginning.",tooltip:"Same as .begin but trims from the end (1 = full sample, 0.5 = half length).",pattern:`s("bd*2,oh*4").bank("RolandTR808")
  .end("<0.1 0.2 0.5 1>")
  .fast(2)`},{id:"sampler-loop",label:"loop",description:"Keep a sample looping regardless of the cycle length.",tooltip:"Enable sustained looping (1 = on) — tempo is free-running.",pattern:`s("casio")
  .loop(1)`},{id:"sampler-loopBegin",label:"loopBegin",description:"Set the point inside the sample where looping starts.",tooltip:"Choose the loop start within 0–1 of the file; must be before loopEnd.",pattern:`s("space").loop(1)
  .loopBegin("<0 0.125 0.25>")
  ._scope()`},{id:"sampler-loopEnd",label:"loopEnd",description:"Set the point inside the sample where looping ends.",tooltip:"Choose the loop end (0–1). Must be after loopBegin for a valid loop.",pattern:`s("space").loop(1)
  .loopEnd("<1 0.75 0.5 0.25>")
  ._scope()`},{id:"sampler-cut",label:"cut",description:"Use classic drum-machine style choke groups.",tooltip:"Samples in the same cut group (1 here) stop each other when they retrigger.",pattern:`s("[oh hh]*4").bank("RolandTR808")
  .cut(1)`},{id:"sampler-clip",label:"clip",description:"Shorten or lengthen the note duration without altering tempo.",tooltip:"Multiplies sustain by the factor; values <1 gate the sample early.",pattern:`note("c a f e")
  .s("piano")
  .clip("<0.5 1 2>")
  .legato(1)`},{id:"sampler-loopAt",label:"loopAt",description:"Time-stretch samples to a specific number of cycles.",tooltip:"Stretches/compresses playback so the loop fits exactly 2 cycles.",pattern:`samples({
  "rhodes": "https://cdn.freesound.org/previews/132/132051_316502-lq.mp3"
})

s("rhodes").loopAt(2)`},{id:"sampler-fit",label:"fit",description:"Resize a sample to the length of each event.",tooltip:"Fits every triggered slice to its event duration — great for breakbeats.",pattern:`samples({
  "rhodes": "https://cdn.freesound.org/previews/132/132051-lq.mp3"
})

s("rhodes/2")
  .fit()`},{id:"sampler-chop",label:"chop",description:"Split samples into equal slices for granular tricks.",tooltip:"Cuts each hit into 4 tiny grains, then reorders/repeats them in two cycles.",pattern:`samples({
  "rhodes": "https://cdn.freesound.org/previews/132/132051-lq.mp3"
})

s("rhodes")
  .chop(4)
  .rev()
  .loopAt(2)`},{id:"sampler-striate",label:"striate",description:"Sequentially scan through chunks of each sample.",tooltip:"Each trigger jumps forward through 6 slices of the source file.",pattern:`s("numbers:0 numbers:1 numbers:2")
  .striate(6)
  .slow(3)`},{id:"sampler-slice",label:"slice",description:"Address slices explicitly using indexes or fractional lists.",tooltip:"Divide the file into slices and trigger them via patterns or fractional lists.",pattern:`samples("github:tidalcycles/dirt-samples")

s("breaks165")
  .slice(8, "0 1 <2 2*2> 3 [4 0] 5 6 7")
  .slow(0.75)

s("breaks125")
  .fit()
  .slice([0, 0.25, 0.5, 0.75], "0 1 1 <2 3>")`},{id:"sampler-splice",label:"splice",description:"Slice like .slice but time-stretches to match step length.",tooltip:"Each slice is warped to fill its step, so rhythms stay tight.",pattern:`samples("github:tidalcycles/dirt-samples")

s("breaks165")
  .splice(8, "0 1 [2 3 0]@2 3 0@2 7")`},{id:"sampler-scrub",label:"scrub",description:"Manually scrub through audio (great for granular tape FX).",tooltip:"Supply 0–1 positions (optionally with :speed) to scrub through the waveform.",pattern:`samples("github:switchangel/pad")
s("swpad:0")
  .scrub("{0.1!2 0.25@3 0.7!2 <0.8:1.5>}%8")

samples("github:yaxu/clean-breaks/main")
s("amen/4")
  .fit()
  .scrub(pattern("{0@3 0@2 4@3}%8").div(16))`},{id:"sampler-speed",label:"speed",description:"Pitch-shift or reverse by changing playback speed.",tooltip:"Positive speeds raise the pitch; negatives play the sample backwards.",pattern:`s("bd*6")
  .speed("1 2 4 1 -2 -4")

speed("1 1.5*2 [2 1.1]")
  .s("piano")
  .clip(1)`}].map(n=>({...n,editorBadge:"Code"}));_J.forEach(n=>{n.editorBadge||(n.editorBadge="Code")});const Xk=[{id:"song-acidic-tooth",label:'Song · "acidic tooth" @by eddyflux',pattern:`// "acidic tooth" @by eddyflux
// @version 1.0

setcps(1)

stack(

  /* Channel 1 */
  stack(
    s("bd*2").mask("<0@4 1@16>"),
    s("hh*8").gain(saw.mul(saw.fast(2))).clip(sine)
    .mask("<0@8 1@16>")
  ).bank('RolandTR909')

  ,

  /* Channel 2 */
  note("[<g1 f1>/8](<3 5>,8)")
  .clip(perlin.range(.15,1.5))
  .release(.1)
  .s("sawtooth")
  .lpf(sine.range(400,800).slow(16))
  .lpq(cosine.range(6,14).slow(3))
  .lpenv(sine.mul(4).slow(4))
  .lpd(.2).lpa(.02)
  .ftype('24db')
  .rarely(add(note(12)))
  .room(.2).shape(.3).postgain(.5)
  .superimpose(x=>x.add(note(12)).delay(.5).bpf(1000))
  .gain("[.2 1@3]*2") // fake sidechain

)`.trim()}],Wk=K_("assets/samples/voice/Strudesk4000_de.mp3");let xs=null;const bN=25,yN=25,vN="strudel_channel_history:",qk="strudel_master_history",Xp={get(n){try{return window.localStorage.getItem(n)}catch(e){return console.warn("Pattern history storage get failed:",e),null}},set(n,e){try{window.localStorage.setItem(n,e)}catch(t){console.warn("Pattern history storage set failed:",t)}}},Xr=(()=>{const n=new Map;let e=null;const t=u=>{if(!u)return[];try{const h=JSON.parse(u);return Array.isArray(h)?h:[]}catch{return[]}},s=(u,h)=>{Xp.set(u,JSON.stringify(h))};return{saveChannelVersion:(u,h)=>{const m=(h||"").trim();if(!u||!m||n.get(u)===m)return;const f=`${vN}${u}`;let v=t(Xp.get(f));if(v.length&&v[0].pattern===m){n.set(u,m);return}const O={id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,pattern:m,createdAt:Date.now()};if(v.unshift(O),v.length>bN&&(v=v.slice(0,bN)),s(f,v),n.set(u,m),typeof window<"u"&&typeof window.dispatchEvent=="function")try{window.dispatchEvent(new CustomEvent("channel-history-updated",{detail:{elementId:u}}))}catch{}},getChannelVersions:u=>u?t(Xp.get(`${vN}${u}`)):[],markChannelSnapshot:(u,h)=>{u&&n.set(u,(h||"").trim())},saveMasterVersion:u=>{const h=(u||"").trim();if(!h||h===e){e=h;return}let m=t(Xp.get(qk));if(m.length&&m[0].pattern===h){e=h;return}const f={id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,pattern:h,createdAt:Date.now()};m.unshift(f),m.length>yN&&(m=m.slice(0,yN)),s(qk,m),e=h},getMasterVersions:()=>t(Xp.get(qk)),markMasterSnapshot:u=>{e=(u||"").trim()}}})();window.__patternHistory=Xr;const _Be=()=>{const n=document.getElementById("pattern-history-modal");if(!n)return{openChannelHistory:()=>{},openMasterHistory:()=>{},close:()=>{}};const e=document.getElementById("pattern-history-title"),t=document.getElementById("pattern-history-list"),s=document.getElementById("pattern-history-tabs"),a=document.getElementById("pattern-history-close");let r=null,o=[],i="local";const l=M=>M.replace(/[&<>"']/g,E=>{switch(E){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";default:return E}}),c=M=>{try{return new Date(M).toLocaleString()}catch{return""}},u=()=>{n.classList.remove("is-open"),n.setAttribute("aria-hidden","true"),r=null,o=[],Vo("pattern-history-modal")},h=()=>{n.classList.add("is-open"),n.setAttribute("aria-hidden","false"),Oi("pattern-history-modal")},m=(M,E={})=>{const{includeMasterSongs:I=!1,isCloudPatterns:D=!1}=E,F=document.createDocumentFragment();if(Array.isArray(M)&&M.length>0)M.forEach(($,Z)=>{const ce=document.createElement("div");ce.className="pattern-history-entry";let U=$.patternCode||$.pattern||"";const ue=U.length>240?`${U.slice(0,240)}…`:U,W=(Z+1).toString().padStart(2,"0");let de=c($.createdAt);if(D){const be=[];$.title&&be.push(`"${$.title}"`),$.artistName&&be.push(`by ${$.artistName}`),$.version&&be.push(`v${$.version}${$.versionName?` (${$.versionName})`:""}`),$.userCount>0&&be.push(`${$.userCount} user${$.userCount>1?"s":""}`),be.length>0&&(de=be.join(" • "))}ce.innerHTML=`
          <div class="pattern-history-meta">
            <span class="pattern-history-index">#${W}</span>
            <p class="pattern-history-date">${l(de)}</p>
          </div>
          <pre class="pattern-history-snippet">${l(ue)}</pre>
          <div class="pattern-history-actions">
            <button type="button" class="pattern-history-load" data-version-id="${$.id}" data-is-cloud="${D}">Load</button>
          </div>
        `,F.appendChild(ce)});else{const $=document.createElement("p");$.className="pattern-history-empty",$.textContent="No saved versions yet.",F.appendChild($)}if(I&&Xk.length&&i==="local"){const $=document.createElement("h4");$.className="pattern-history-section-title",$.textContent="Songs",F.appendChild($),Xk.forEach((Z,ce)=>{const U=document.createElement("div");U.className="pattern-history-entry pattern-history-entry--song";const ue=Z.pattern.length>400?`${Z.pattern.slice(0,400)}…`:Z.pattern,W=(ce+1).toString().padStart(2,"0");U.innerHTML=`
          <div class="pattern-history-meta">
            <span class="pattern-history-index">#${W}</span>
            <p class="pattern-history-date">${l(Z.label)}</p>
          </div>
          <pre class="pattern-history-snippet">${l(ue)}</pre>
          <div class="pattern-history-actions">
            <button type="button" class="pattern-history-load" data-song-id="${Z.id}">Load</button>
          </div>
        `,F.appendChild(U)})}t.innerHTML="",t.appendChild(F)};t.addEventListener("click",async M=>{const E=M.target.closest(".pattern-history-load");if(!E||!xs)return;const I=E.dataset.versionId,D=E.dataset.songId,F=E.dataset.isCloud==="true";if(D&&(r==null?void 0:r.type)==="master"){const Z=Xk.find(ce=>ce.id===D);if(!Z)return;xs.applyMasterHistoryEntry(Z.pattern),u();return}let _=o.find(Z=>Z.id===I);if(F&&_)try{const{patternsAPI:Z,getCurrentUser:ce}=await gs(async()=>{const{patternsAPI:W,getCurrentUser:de}=await Promise.resolve().then(()=>Cc);return{patternsAPI:W,getCurrentUser:de}},void 0);if(!await ce()){alert("Please log in to load patterns from cloud");return}_=await Z.getPattern(I)}catch(Z){console.error("Error loading cloud pattern:",Z),alert("Failed to load pattern: "+(Z.message||"Please check your login status"));return}if(!_)return;let $=_.patternCode||_.pattern;$&&($=$.replace(/\.postgain\s*\([^)]*\)/gi,""),$=$.replace(/\.pan\s*\([^)]*\)/gi,""),$=$.replace(/\.fast\s*\([^)]*\)/gi,""),$=$.replace(/\.slow\s*\([^)]*\)/gi,""),$=$.replace(/\.cpm\s*\([^)]*\)/gi,""),$=$.replace(/\.\.+/g,".").trim(),$=$.replace(/\.+$/,"").trim(),(r==null?void 0:r.type)==="channel"?xs.applyChannelHistoryEntry(r.elementId,$):(r==null?void 0:r.type)==="master"&&xs.applyMasterHistoryEntry($),u())}),a==null||a.addEventListener("click",u),n.addEventListener("click",M=>{M.target===n&&u()});const f=async(M,E=null)=>{try{const{patternsAPI:I,getCurrentUser:D}=await gs(async()=>{const{patternsAPI:Z,getCurrentUser:ce}=await Promise.resolve().then(()=>Cc);return{patternsAPI:Z,getCurrentUser:ce}},void 0),F=await D();if(!F)return[];const _={type:M};let $=[];return i==="my-patterns"?($=await I.getPatterns({type:M,isPublic:!1}),$=$.filter(Z=>Z.userId===F.id)):i==="public"?$=await I.getPatterns({type:M,isPublic:!0}):i==="shared"&&($=await I.getPatterns({type:M,shared:!0})),$}catch(I){return console.error("Error loading cloud patterns:",I),[]}},v=async M=>{if(i=M,s&&s.querySelectorAll(".pattern-history-tab").forEach(E=>{E.classList.toggle("active",E.dataset.tab===M)}),t.innerHTML='<p class="pattern-history-empty">Loading…</p>',M==="local")(r==null?void 0:r.type)==="channel"?(o=Xr.getChannelVersions(r.elementId),m(o)):(r==null?void 0:r.type)==="master"&&(o=Xr.getMasterVersions(),m(o,{includeMasterSongs:!0}));else{const E=await f((r==null?void 0:r.type)||"master",r==null?void 0:r.elementId);o=E,m(E,{isCloudPatterns:!0})}},O=async M=>{if(!M)return;r={type:"channel",elementId:M},e.textContent=`${dh(M)} history`,h();const{getCurrentUser:E}=await gs(async()=>{const{getCurrentUser:D}=await Promise.resolve().then(()=>Cc);return{getCurrentUser:D}},void 0),I=await E();s&&(s.style.display=I?"flex":"none"),t.innerHTML='<p class="pattern-history-empty">Loading…</p>',i="local",o=Xr.getChannelVersions(M),m(o)},k=async()=>{r={type:"master"},e.textContent="Master history",h();const{getCurrentUser:M}=await gs(async()=>{const{getCurrentUser:I}=await Promise.resolve().then(()=>Cc);return{getCurrentUser:I}},void 0),E=await M();s&&(s.style.display=E?"flex":"none"),t.innerHTML='<p class="pattern-history-empty">Loading…</p>',i="local",o=Xr.getMasterVersions(),m(o,{includeMasterSongs:!0})};return s&&s.addEventListener("click",M=>{const E=M.target.closest(".pattern-history-tab");E&&v(E.dataset.tab)}),{openChannelHistory:O,openMasterHistory:k,close:u}};let C1=null;const LBe=n=>{var a,r;if(!C1)return;const e=n.target.closest("[data-history-save]");if(e){n.preventDefault();const o=e.dataset.historySave;if(o==="channel"){const i=e.closest(".sound-element"),l=i==null?void 0:i.getAttribute("data-sound-id");l&&xs&&((a=xs.saveChannelWithMidi)==null||a.call(xs,l))}else o==="master"&&xs&&((r=xs.saveMasterHistoryEntry)==null||r.call(xs));return}const t=n.target.closest('[data-history-target="channel"]');if(t){n.preventDefault();const o=t.closest(".sound-element"),i=o==null?void 0:o.getAttribute("data-sound-id");i&&C1.openChannelHistory(i);return}n.target.closest("#load-master-history-btn")&&(n.preventDefault(),C1.openMasterHistory())},wN=()=>{C1=_Be(),document.addEventListener("click",LBe)},Uk=[{key:"bd",label:"BD",sample:"bd"},{key:"sn",label:"SN",sample:"sd"},{key:"hh",label:"HH",sample:"hh"}],IBe=new Set([...uf,...md,...dJ]),QBe=["note()","n()","sound()","s()","bank()","beat()","vowel()","chord()","voicing()","addVoicings()","gain()","adsr()","scale()","pan()","speed()","slow()","fast()","early()","late()","legato()","euclid()","euclidRot()","euclidLegato()","rev()","palindrome()","iter()","iterBack()","ply()","range()","rangex()","range2()","lpf()","lpa()","lpd()","lps()","lpq()","lpattack()","lpdecay()","lpsustain()","lprelease()","orbit()","postgain()","irand()","seg()","hpf()","hpq()","bpf()","bpg()","bpq()","fancor()","lpenv()","ftype()","attack()","decay()","sustain()","release()","tremolo()","resonance()","cutoff()","noise()","tremolosync()","tremoloskew()","tremolodepth()","tremolophase()","tremoloshape()","sometimes()","stack()","clip()","sub()","mul()","div()","floor()","ceil()","ratio()","as()","saw()","sine()","cosine()","tri()","square()","rand()","saw2()","sine2()","cosine2()","tri2()","square2()","rand2()","perlin()","brand()","brandBy()","mouseX()","mouseY()","choose()","wchoose()","chooseCycles()","wchooseCycles()","degradeBy()","degrade()","undegradeBy()","undegrade()","sometimesBy()","sometimes()","someCyclesBy()","someCycles()","often()","rarely()","almostNever()","almostAlways()","never()","always()","lastOf()","firstOf()","when()","chunk()","chunkBack()","fastChunk()","arp()","arpWith()","struct()","mask()","reset()","restart()","hush()","invert()","pick()","pickmod()","pickF()","pickmodF()","pickRestart()","pickmodRestart()","pickReset()","pickmodReset()","inhabit()","inhabitmod()","squeeze()","superimpose()","layer()","off()","echo()","echoWith()","transpose()","scaleTranspose()","rootNotes()","pace()","stepcat()","stepalt()","expand()","contract()","extend()","take()","drop()","polymeter()","shrink()","grow()","tour()","zip()","vib()","vibmod()","add()","anchor()","dict()","penv()","segment()","compress()","zoom()","linger()","fastGap()","inside()","outside()","cpm()","ribbon()","swingBy()","swing()","patt()","dec()","mode()","set()","struct()","pick()","pattack()","pdecay()","prelease()","pcurve()","panchor()","velocity()","fm()","fmh()","fmattack()","fmdecay()","fmsustain()","fmenv()","zrand()","curve()","slide()","deltaSlide()","zmod()","zcrush()","zdelay()","pitchJump()","pitchJumpTime()","lfo()","compressor()","control()","ccn()","ccv()","midimap()","midimaps()","defaultmidimap()","midi()","midiport()","midicmd()","midibend()","miditouch()","progNum()","sysex()","sysexid()","sysexdata()","osc()","mqtt()","xfade()","jux()","juxBy()","coarse()","crush()","distort()","delay()","delaytime()","delayfeedback()","room()","roomsize()","roomfade()","roomlp()","roomdim()","iresponse()","phaser()","phaserdepth()","phasercenter()","phasersweep()","duckorbit()","duckattack()","duckdepth()"],M1=["stack()","vowel()","beat()","bank()","sound()","chord()","note()"],VBe=['sound("sawtooth")','sound("square")','sound("triangle")','sound("sine")','sound("white")','sound("pink")','sound("brown")'],jBe=["beat","chord","note","sound","stack"],ZBe=new Map([['sound("brown")',"pattern-snippet-tag-sound-brown"],['sound("pink")',"pattern-snippet-tag-sound-pink"],['sound("white")',"pattern-snippet-tag-sound-white"]]),zBe=new Set(["core"]),GBe=new Set(["filters-lp","filters-hp","filters-bp"]),XBe=new Set(["filters-lp","filters-hp","filters-bp"]),Wp=new Map;function Hk(n){return n<=20?0:n>=2e4?1:n<=100?(n-20)/80*.25:n<=500?.25+(n-100)/400*.25:n<=5e3?.5+(n-500)/4500*.3:.8+(n-5e3)/15e3*.2}function Yk(n){return n<=0?20:n>=1?2e4:n<=.25?20+n/.25*80:n<=.5?100+(n-.25)/.25*400:n<=.8?500+(n-.5)/.3*4500:5e3+(n-.8)/.2*15e3}const df={lpf:{min:20,max:2e4,step:10,default:2e4,unit:"Hz"},hpf:{min:20,max:2e4,step:10,default:20,unit:"Hz"},bpf:{min:20,max:2e4,step:10,default:1e3,unit:"Hz"},lpq:{min:0,max:20,step:.1,default:0,unit:""},hpq:{min:0,max:20,step:.1,default:0,unit:""},bpq:{min:0,max:20,step:.1,default:0,unit:""},bpg:{min:-20,max:20,step:.1,default:0,unit:"dB"},attack:{min:0,max:2,step:.01,default:.01,unit:"s"},decay:{min:0,max:2,step:.01,default:.1,unit:"s"},sustain:{min:0,max:1,step:.01,default:.5,unit:""},release:{min:0,max:5,step:.01,default:.1,unit:"s"},lpattack:{min:0,max:2,step:.01,default:.01,unit:"s"},lpdecay:{min:0,max:2,step:.01,default:.1,unit:"s"},lpsustain:{min:0,max:1,step:.01,default:.5,unit:""},lprelease:{min:0,max:5,step:.01,default:.1,unit:"s"},hpattack:{min:0,max:2,step:.01,default:.01,unit:"s"},hpdecay:{min:0,max:2,step:.01,default:.1,unit:"s"},hpsustain:{min:0,max:1,step:.01,default:.5,unit:""},hprelease:{min:0,max:5,step:.01,default:.1,unit:"s"},bpattack:{min:0,max:2,step:.01,default:.01,unit:"s"},bpdecay:{min:0,max:2,step:.01,default:.1,unit:"s"},bpsustain:{min:0,max:1,step:.01,default:.5,unit:""},bprelease:{min:0,max:5,step:.01,default:.1,unit:"s"},bpenv:{min:0,max:1,step:.01,default:.5,unit:""},hpenv:{min:0,max:1,step:.01,default:.5,unit:""},pattack:{min:0,max:2,step:.01,default:.01,unit:"s"},pdecay:{min:0,max:2,step:.01,default:.1,unit:"s"},prelease:{min:0,max:5,step:.01,default:.1,unit:"s"},gain:{min:0,max:2,step:.01,default:.8,unit:""},postgain:{min:0,max:2,step:.01,default:1,unit:""},velocity:{min:0,max:1,step:.01,default:.5,unit:""},pan:{min:-1,max:1,step:.01,default:0,unit:""},slow:{min:.1,max:10,step:.1,default:2,unit:"x"},fast:{min:.1,max:10,step:.1,default:2,unit:"x"},early:{min:0,max:1,step:.01,default:.25,unit:""},late:{min:0,max:1,step:.01,default:.25,unit:""},delay:{min:0,max:1,step:.01,default:0,unit:""},delaytime:{min:0,max:1,step:.01,default:.25,unit:"s"},delayfeedback:{min:0,max:1,step:.01,default:.5,unit:""},room:{min:0,max:5,step:.01,default:0,unit:""},roomsize:{min:0,max:4,step:.01,default:.5,unit:""},roomfade:{min:0,max:1,step:.01,default:.5,unit:""},roomlp:{min:20,max:2e4,step:10,default:20,unit:"Hz"},roomdim:{min:0,max:1,step:.01,default:0,unit:""},iresponse:{min:0,max:1,step:.01,default:0,unit:""},phaser:{min:0,max:1,step:.01,default:0,unit:""},phaserdepth:{min:0,max:1,step:.01,default:.5,unit:""},phasercenter:{min:0,max:1,step:.01,default:.5,unit:""},phasersweep:{min:0,max:1,step:.01,default:.5,unit:""},duckattack:{min:0,max:2,step:.01,default:.01,unit:"s"},duckdepth:{min:0,max:1,step:.01,default:.5,unit:""},tremolo:{min:0,max:1,step:.01,default:0,unit:""},tremolodepth:{min:0,max:1,step:.01,default:.5,unit:""},tremoloskew:{min:0,max:1,step:.01,default:.5,unit:""},tremolophase:{min:0,max:1,step:.01,default:0,unit:""},resonance:{min:0,max:20,step:.1,default:0,unit:""},cutoff:{min:20,max:2e4,step:10,default:2e4,unit:"Hz"},speed:{min:.1,max:10,step:.1,default:1,unit:"x"},legato:{min:0,max:1,step:.01,default:0,unit:""},cpm:{min:60,max:300,step:1,default:120,unit:"BPM"}},Ff=[{id:"core",order:0,label:"Core",heading:"Core",matcher:n=>["stack","beat","bank","sound","s","note","n"].includes(n),className:"snippet-group-core"},{id:"amplitude-modulation",order:1,label:"Amplitude Modulation",heading:"Amplitude Modulation",matcher:n=>["tremolo","tremolosync","tremolodepth","tremoloskew","tremolophase","tremoloshape"].includes(n),className:"snippet-group-amplitude-modulation"},{id:"amplitude-envelope",order:2,label:"Amplitude Envelope",heading:"Amplitude Envelope",matcher:n=>["attack","decay","sustain","release","adsr"].includes(n),className:"snippet-group-amplitude-envelope"},{id:"filter-envelope",order:3,label:"Filter Envelope",heading:"Filter Envelope",matcher:n=>["lpattack","lpdecay","lpsustain","lprelease","lpenv"].includes(n),className:"snippet-group-filter-envelope"},{id:"pitch-envelope",order:4,label:"Pitch Envelope",heading:"Pitch Envelope",matcher:n=>["pattack","pdecay","prelease","penv","pcurve","panchor"].includes(n),className:"snippet-group-pitch-envelope"},{id:"dynamics",order:5,label:"Dynamics",heading:"Dynamics",matcher:n=>["gain","velocity","compressor","postgain","xfade"].includes(n),className:"snippet-group-dynamics"},{id:"panning",order:6,label:"Panning",heading:"Panning",matcher:n=>["jux","juxby","pan"].includes(n),className:"snippet-group-panning"},{id:"waveshaping",order:7,label:"Waveshaping",heading:"Waveshaping",matcher:n=>["coarse","crush","distort"].includes(n),className:"snippet-group-waveshaping"},{id:"global-effects",order:8,label:"Global Effects",heading:"Global Effects",matcher:n=>["orbit"].includes(n),className:"snippet-group-global-effects"},{id:"delay",order:9,label:"Delay",heading:"Delay",matcher:n=>["delay","delaytime","delayfeedback"].includes(n),className:"snippet-group-delay"},{id:"reverb",order:10,label:"Reverb",heading:"Reverb",matcher:n=>["room","roomsize","roomfade","roomlp","roomdim","iresponse"].includes(n),className:"snippet-group-reverb"},{id:"phaser",order:11,label:"Phaser",heading:"Phaser",matcher:n=>["phaser","phaserdepth","phasercenter","phasersweep"].includes(n),className:"snippet-group-phaser"},{id:"duck",order:12,label:"Duck",heading:"Duck",matcher:n=>["duckorbit","duckattack","duckdepth"].includes(n),className:"snippet-group-duck"},{id:"filters-hp",order:5,label:"Filters · High-pass",heading:"Filters · High-pass",matcher:n=>n.startsWith("hp"),className:"snippet-group-filters-hp"},{id:"filters-bp",order:6,label:"Filters · Band-pass",heading:"Filters · Band-pass",matcher:n=>n.startsWith("bp"),className:"snippet-group-filters-bp"},{id:"filters-lp",order:7,label:"Filters · Low-pass",heading:"Filters · Low-pass",matcher:n=>n.startsWith("lp")||n==="ftype"||n==="vowel"||n==="applygraduallowpass",className:"snippet-group-filters-lp"},{id:"time",order:8,label:"Time Modifiers",heading:"Time Modifiers",matcher:n=>["slow","fast","early","late","clip","legato","euclid","euclidrot","euclidlegato","rev","palindrome","iter","iterback","ply","segment","compress","zoom","linger","fastgap","inside","outside","cpm","ribbon","swingby","swing"].includes(n),className:"snippet-group-time"},{id:"control-operators",order:9,label:"Control · Operators",heading:"Control Parameters · Operators",matcher:n=>["add","sub","mul","div","floor","ceil","range","rangex","range2","ratio","as"].includes(n),className:"snippet-group-controls"},{id:"signals",order:10,label:"Signals",heading:"Signals",matcher:n=>["saw","sine","cosine","tri","square","rand","saw2","sine2","cosine2","tri2","square2","rand2","perlin","irand","brand","brandby"].includes(n),className:"snippet-group-signals"},{id:"visual-feedback",order:11,label:"Visual Feedback",heading:"Visual Feedback",matcher:(n,e)=>{if(n==="color"||n==="markcss"||["fscope","generategraph","pianoroll","pitchwheel","scope","spiral","wordfall"].includes(n))return!0;if(!e||typeof e!="string")return!1;const t=e.toLowerCase();return t.includes("_punchcard")||t.includes("_pianoroll")||t.includes("_scope")||t.includes("_spiral")||t.includes("_pitchwheel")||t.includes("_spectrum")},className:"snippet-group-visual-feedback"},{id:"synths",order:12,label:"Synths",heading:"Synths",matcher:(n,e)=>n==="sound"?typeof e=="string"&&e.includes('sound("'):["decay","sustain","attack","release","cutoff","noise","vib","vibmod","fm","fmh","fmattack","fmdecay","fmsustain","fmenv","fmwave","zrand","curve","slide","deltaslide","zmod","zcrush","zdelay","pitchjump","pitchjumptime","lfo","tremolo","octave","pw","pwrate","pwsweep","spread","unison","isaw","isaw2","itri","itri2"].includes(n),className:"snippet-group-synths"},{id:"tonal",order:13,label:"Tonal Functions",heading:"Tonal Functions",matcher:n=>["voicing","voicings","addvoicings","scale","transpose","scaletranspose","rootnotes","chord","dict","anchor","mode","below","duck","above","offset","n","note"].includes(n),className:"snippet-group-tonal"},{id:"stepwise",order:14,label:"Stepwise Patterning",heading:"Stepwise Patterning",matcher:n=>["pace","stepcat","stepalt","expand","contract","extend","take","drop","polymeter","shrink","grow","tour","zip"].includes(n),className:"snippet-group-stepwise"},{id:"random",order:15,label:"Random Modifiers",heading:"Random Modifiers",matcher:n=>["choose","wchoose","choosecycles","wchoosecycles","degradeby","degrade","undegradeby","undegrade","sometimesby","sometimes","somecyclesby","somecycles","often","rarely","almostnever","almostalways","never","always"].includes(n),className:"snippet-group-random"},{id:"conditional",order:16,label:"Conditional Modifiers",heading:"Conditional Modifiers",matcher:n=>["lastof","firstof","when","chunk","chunkback","fastchunk","arp","arpwith","struct","mask","reset","restart","hush","invert","pick","pickmod","pickf","pickmodf","pickrestart","pickmodrestart","pickreset","pickmodreset","inhabit","inhabitmod","squeeze"].includes(n),className:"snippet-group-conditional"},{id:"accumulation",order:17,label:"Accumulation Modifiers",heading:"Accumulation Modifiers",matcher:n=>["superimpose","layer","off","echo","echowith"].includes(n),className:"snippet-group-accumulation"},{id:"midi",order:18,label:"MIDI",heading:"MIDI",matcher:n=>n.includes("midi")||n.startsWith("ccn")||n.startsWith("ccv")||n==="prognum"||n==="sysex"||n==="sysexid"||n==="sysexdata"||n==="control",className:"snippet-group-midi",exclude:["pianoroll"]},{id:"device",order:19,label:"Device Motion",heading:"Device Motion",matcher:n=>["orientation","acceleration","accelerationx","accelerationy","accelerationz","rotationx","rotationy","rotationz","gravityx","gravityy","gravityz","mousex","mousey"].some(t=>n.includes(t)),className:"snippet-group-device"},{id:"external-communication",order:20,label:"External Communication",heading:"External Communication",matcher:n=>["osc","mqtt"].includes(n),className:"snippet-group-external-communication"},{id:"other",order:Number.MAX_SAFE_INTEGER,label:"Other",heading:"Other",matcher:()=>!0,className:"snippet-group-other"}],Ab=Ff.reduce((n,e)=>(n.set(e.id,e),n),new Map),WBe={sound:["bank","note","chord","delay","room","phaser","gain","lpf","pan"],s:["bank","note","chord","delay","room","phaser","gain","lpf","pan"],note:["chord","scale","voicing","transpose","scaletranspose","rootnotes","attack","decay","release","lpf","gain","pan"],stack:["beat","sound","note","gain","pan"],beat:["sound","s","euclid","mask","slow","fast","rev","iter"],bank:["sound","s","gain","pan","slow","fast","euclid","mask","delay","room","crush","distort"],lpf:["lpenv","lpattack","lpdecay","lpsustain","lprelease","lpq","ftype","hpf","bpf","gain"],hpf:["hpattack","hpdecay","hpsustain","hprelease","hpq","lpf","bpf","gain"],bpf:["bpattack","bpdecay","bpsustain","bprelease","bpq","bpg","lpf","hpf","gain"],lpenv:["lpf","lpattack","lpdecay","lpsustain","lprelease","lpq"],lpattack:["lpf","lpenv","lpdecay","lpsustain","lprelease"],lpdecay:["lpf","lpenv","lpattack","lpsustain","lprelease"],lpsustain:["lpf","lpenv","lpattack","lpdecay","lprelease"],lprelease:["lpf","lpenv","lpattack","lpdecay","lpsustain"],lpq:["lpf","lpenv"],hpq:["hpf"],bpq:["bpf","bpg"],bpg:["bpf","bpq"],ftype:["lpf"],vowel:["lpf","ftype"],attack:["decay","sustain","release","adsr","gain","lpf"],decay:["attack","sustain","release","adsr","gain"],sustain:["attack","decay","release","adsr","gain"],release:["attack","decay","sustain","adsr","gain"],adsr:["attack","decay","sustain","release","gain"],pattack:["pdecay","prelease","penv","pcurve","panchor"],pdecay:["pattack","prelease","penv","pcurve"],prelease:["pattack","pdecay","penv","pcurve"],penv:["pattack","pdecay","prelease","pcurve","panchor"],pcurve:["penv","pattack","pdecay","prelease"],panchor:["penv","pattack"],delay:["delaytime","delayfeedback"],delaytime:["delay","delayfeedback"],delayfeedback:["delay","delaytime"],room:["roomsize","roomfade","roomlp","roomdim","iresponse"],roomsize:["room","roomfade","roomlp","roomdim"],roomfade:["room","roomsize","roomlp"],roomlp:["room","roomsize","roomfade"],roomdim:["room","roomsize"],iresponse:["room","roomsize"],phaser:["phaserdepth","phasercenter","phasersweep"],phaserdepth:["phaser","phasercenter","phasersweep"],phasercenter:["phaser","phaserdepth","phasersweep"],phasersweep:["phaser","phaserdepth","phasercenter"],duckorbit:["duckattack","duckdepth"],duckattack:["duckorbit","duckdepth"],duckdepth:["duckorbit","duckattack"],gain:["velocity","compressor","postgain","pan","delay","room"],velocity:["gain","attack","decay"],compressor:["gain","postgain"],postgain:["gain","compressor"],xfade:["gain"],pan:["jux","juxby","gain"],jux:["juxby","pan"],juxby:["jux","pan"],crush:["distort","coarse","gain"],distort:["crush","coarse","gain"],coarse:["crush","distort"],slow:["fast","early","late","clip","legato","swing"],fast:["slow","early","late","clip","legato"],early:["late","slow","fast","clip"],late:["early","slow","fast","clip"],clip:["slow","fast","legato","early","late"],legato:["clip","early","late","slow","fast"],euclid:["euclidrot","euclidlegato","mask","beat","slow","fast"],euclidrot:["euclid","euclidlegato","mask"],euclidlegato:["euclid","euclidrot","mask"],rev:["palindrome","iter","iterback"],palindrome:["rev","iter","iterback"],iter:["iterback","rev","palindrome"],iterback:["iter","rev","palindrome"],ply:["segment","compress","zoom"],segment:["ply","compress","zoom","ribbon"],compress:["ply","segment"],zoom:["linger","fastgap","ply","segment"],linger:["zoom","fastgap"],fastgap:["zoom","linger"],inside:["outside","clip"],outside:["inside","clip"],swing:["swingby","cpm","slow","fast"],swingby:["swing","cpm"],cpm:["swing","swingby"],ribbon:["segment","ply"],add:["sub","mul","div","range","rangex"],sub:["add","mul","div","range"],mul:["add","sub","div","range"],div:["add","sub","mul","range"],range:["rangex","range2","add","sub","mul"],rangex:["range","range2"],range2:["range","rangex"],floor:["ceil","ratio"],ceil:["floor","ratio"],ratio:["floor","ceil"],as:["range"],saw:["sine","tri","square","rand","range"],sine:["saw","cosine","tri","square","range"],cosine:["sine","saw","tri","square"],tri:["saw","sine","square","rand"],square:["saw","sine","tri","rand"],rand:["saw","sine","tri","square","irand","brand"],saw2:["sine2","tri2","square2","rand2"],sine2:["saw2","cosine2","tri2","square2"],cosine2:["sine2","saw2","tri2","square2"],tri2:["saw2","sine2","square2","rand2"],square2:["saw2","sine2","tri2","rand2"],rand2:["saw2","sine2","tri2","square2"],perlin:["rand","brand","range"],irand:["rand","brand"],brand:["rand","irand","brandby"],brandby:["brand"],chord:["voicing","addvoicings","scale","transpose","scaletranspose","rootnotes","dict","mode","note"],voicing:["chord","addvoicings","scale","transpose","note"],addvoicings:["voicing","chord"],scale:["chord","voicing","transpose","scaletranspose","rootnotes","dict","mode","note"],transpose:["scale","scaletranspose","chord","note","offset"],scaletranspose:["scale","transpose","chord"],rootnotes:["scale","chord","transpose"],dict:["chord","scale","note"],anchor:["penv","pcurve","panchor","scale"],mode:["scale","chord","note"],below:["above","note","chord"],above:["below","note","chord"],offset:["transpose","scale","note"],n:["note","chord","scale","voicing","transpose"],cutoff:["lpf","resonance","lpenv"],resonance:["cutoff","lpf","lpq"],noise:["sound","cutoff","lpf"],vib:["vibmod","tremolo"],vibmod:["vib"],fm:["fmh","fmattack","fmdecay","fmsustain","fmenv","fmwave"],fmh:["fm","fmattack","fmdecay"],fmattack:["fm","fmdecay","fmsustain","fmenv"],fmdecay:["fm","fmattack","fmsustain","fmenv"],fmsustain:["fm","fmattack","fmdecay","fmenv"],fmenv:["fm","fmattack","fmdecay","fmsustain"],fmwave:["fm"],zrand:["rand","brand"],curve:["slide","deltaslide"],slide:["curve","deltaslide"],deltaslide:["slide","curve"],zmod:["vib","vibmod"],zcrush:["crush","distort"],zdelay:["delay","delaytime"],pitchjump:["pitchjumptime","penv"],pitchjumptime:["pitchjump"],lfo:["tremolo","vib"],octave:["transpose","note"],pw:["pwrate","pwsweep"],pwrate:["pw","pwsweep"],pwsweep:["pw","pwrate"],spread:["unison","pan"],unison:["spread"],isaw:["isaw2","itri","itri2"],isaw2:["isaw","itri","itri2"],itri:["isaw","isaw2","itri2"],itri2:["isaw","isaw2","itri"],tremolo:["tremolosync","tremolodepth","tremoloskew","tremolophase","tremoloshape","lfo"],tremolosync:["tremolo","tremolodepth"],tremolodepth:["tremolo","tremolosync"],tremoloskew:["tremolo","tremolophase"],tremolophase:["tremolo","tremoloshape"],tremoloshape:["tremolo","tremolophase"],choose:["wchoose","sometimes","rarely"],wchoose:["choose","sometimes"],choosecycles:["wchoosecycles","somecycles"],wchoosecycles:["choosecycles","somecycles"],degradeby:["degrade","sometimes"],degrade:["degradeby","sometimes"],undegradeby:["undegrade"],undegrade:["undegradeby"],sometimesby:["sometimes","rarely","often"],sometimes:["sometimesby","rarely","often","choose"],somecyclesby:["somecycles","choosecycles"],somecycles:["somecyclesby","choosecycles"],often:["sometimes","rarely","almostalways"],rarely:["sometimes","often","almostnever"],almostnever:["rarely","never"],almostalways:["often","always"],never:["almostnever"],always:["almostalways"],lastof:["firstof","when","mask"],firstof:["lastof","when","mask"],when:["lastof","firstof","mask","struct"],chunk:["chunkback","fastchunk","mask","struct"],chunkback:["chunk","fastchunk","mask"],fastchunk:["chunk","chunkback","mask"],arp:["arpwith","chord","voicing","note"],arpwith:["arp","chord"],struct:["mask","pick","when","beat"],mask:["struct","when","euclid","beat","chunk"],reset:["restart","pickreset"],restart:["reset","pickrestart"],hush:["silence"],invert:["rev","palindrome"],pick:["pickmod","pickf","pickmodf","struct","mask"],pickmod:["pick","pickmodf","struct"],pickf:["pick","pickmodf","struct"],pickmodf:["pick","pickf","struct"],pickrestart:["pickmodrestart","restart"],pickmodrestart:["pickrestart"],pickreset:["pickmodreset","reset"],pickmodreset:["pickreset"],inhabit:["inhabitmod","mask","struct"],inhabitmod:["inhabit","mask"],squeeze:["compress","segment"],superimpose:["layer","off","echo"],layer:["superimpose","off"],off:["superimpose","layer"],echo:["echowith","delay","superimpose"],echowith:["echo"],pace:["stepcat","stepalt","polymeter","slow","fast"],stepcat:["pace","stepalt","polymeter"],stepalt:["pace","stepcat"],expand:["contract","extend","take","drop"],contract:["expand","extend","take","drop"],extend:["expand","contract","take","drop"],take:["drop","extend","expand","contract"],drop:["take","extend","expand","contract"],polymeter:["pace","stepcat","slow","fast"],shrink:["grow","compress"],grow:["shrink","expand"],tour:["zip","iter"],zip:["tour","iter"],orientation:["acceleration","rotationx","rotationy","rotationz"],acceleration:["accelerationx","accelerationy","accelerationz","gravityx","gravityy","gravityz"],accelerate:["acceleration"],accelerationx:["accelerationy","accelerationz","gravityx"],accelerationy:["accelerationx","accelerationz","gravityy"],accelerationz:["accelerationx","accelerationy","gravityz"],rotationx:["rotationy","rotationz","orientation"],rotationy:["rotationx","rotationz","orientation"],rotationz:["rotationx","rotationy","orientation"],gravityx:["gravityy","gravityz","accelerationx"],gravityy:["gravityx","gravityz","accelerationy"],gravityz:["gravityx","gravityy","accelerationz"],mousex:["mousey","pan","range"],mousey:["mousex","gain","range"],osc:["mqtt"],mqtt:["osc"],midi:["midiport","midicmd","midibend","miditouch"],midiport:["midi"],midicmd:["midi"],midibend:["midi","miditouch"],miditouch:["midi","midibend"],midimap:["midimaps","defaultmidimap"],midimaps:["midimap","defaultmidimap"],defaultmidimap:["midimap","midimaps"],ccn:["ccv","control"],ccv:["ccn","control"],control:["ccn","ccv"],prognum:["midi"],sysex:["sysexid","sysexdata"],sysexid:["sysex","sysexdata"],sysexdata:["sysex","sysexid"],orbit:["duckorbit","pan"],scope:["fscope","pianoroll","spiral"],fscope:["scope","pianoroll"],pianoroll:["scope","fscope"],spiral:["scope"],pitchwheel:["penv"],color:["markcss"],markcss:["color"],vowel:["ftype","lpf"],speed:["slow","fast"],seg:["segment"],fancor:["lpf"],patt:["struct"],dec:["decay"],set:["struct"],irand:["rand","brand"]};function Vi(n){if(!n||typeof n!="string")return"";const e=n.replace(/^[.]+/,""),t=e.match(/^([a-zA-Z0-9_]+)/);return(t?t[1]:e).toLowerCase()}function Kk(n){if(!n||typeof n!="string")return!1;if(M1.includes(n))return!0;const e=n.toLowerCase();return jBe.some(t=>{const s=`.${t}`,a=`${t}(`;return e.includes(s)||e.includes(a)})}function Jk(n){if(!n||typeof n!="string")return"";const e=n.replace(/^[.]+/,"").toLowerCase();for(const[t,s]of ZBe.entries()){const a=t.toLowerCase();if(e===a||e.includes(a))return s}return""}function RC(n){const e=document.createElement("div");return e.innerHTML=n||"",(e.textContent||e.innerText||"").trim()}let eP=null,Eb=null;async function _C(){return Eb||(eP||(eP=gs(()=>import("./index-CuqbEPxt.js"),[]).then(n=>{var s;const e=((s=n==null?void 0:n.reference)==null?void 0:s.docs)||{},t=new Map;for(const a of Object.values(e)){if(!a||!a.name)continue;const r=a.name.trim().toLowerCase();if(!r||t.has(r))continue;const o=Array.isArray(a.params)?a.params.map(i=>{var l;return{name:(i==null?void 0:i.name)||"",types:Array.isArray((l=i==null?void 0:i.type)==null?void 0:l.names)?i.type.names.slice():[],description:RC((i==null?void 0:i.description)||"")}}):[];t.set(r,{name:a.name.trim(),descriptionHtml:a.description||"",descriptionText:RC(a.description||""),params:o})}return t}).catch(n=>(console.warn("⚠️ Unable to load Strudel reference docs:",n),new Map))),Eb=await eP,Eb)}function tP(n){return n?(typeof n.descriptionText=="string"||(n.descriptionText=RC(n.descriptionHtml||"")),n.descriptionText):""}function LJ(n){if(!n)return null;const e=n.toLowerCase(),t=e.match(/between\s+([-\d.]+)\s+and\s+([-\d.]+)/);if(t)return`${t[1]}-${t[2]}`;const s=e.match(/([-\d.]+)\s*-\s*([-\d.]+)/);return s?`${s[1]}-${s[2]}`:null}function qBe(n){if(!n)return"";const e=n.name||"value",t=n.types||[],s=n.description||"",a=LJ(s);return t.includes("number")?a?`${e}:${a}`:`${e}:number`:t.includes("string")?`${e}`:t.includes("Pattern")?`${e}:pattern`:e}function nP(n){if(!n)return"";const e=n.name||"value",t=n.types||[],s=n.description||"",a=LJ(s);return t.includes("number")?a?`${e} (number ${a})`:`${e} (number)`:t.includes("string")?`${e} (string)`:t.includes("Pattern")?`${e} (pattern)`:s?`${e} (${s})`:e}function ON(n,e){if(!n||typeof n!="string"||!n.endsWith("()"))return n;const t=(e==null?void 0:e.params)||[];if(!t.length)return n;const s=t.map(qBe).filter(Boolean);return s.length?`${n.slice(0,-1)}${s.join(", ")})`:n}let ar=null,kc=null,xN=!1;function UBe(){if(ar&&document.body.contains(ar))return ar;if(ar=document.createElement("div"),ar.id="pattern-snippet-tooltip",ar.className="pattern-snippet-tooltip",ar.setAttribute("role","tooltip"),ar.setAttribute("aria-hidden","true"),document.body.appendChild(ar),!xN){xN=!0;const n=()=>zr();window.addEventListener("scroll",n,!0),window.addEventListener("resize",n,{passive:!0}),document.addEventListener("keydown",e=>{e.key==="Escape"&&zr()},!0)}return ar}function zr(n=kc){ar&&(ar.classList.remove("visible"),ar.style.display="none",ar.style.visibility="hidden",ar.innerHTML="",ar.setAttribute("aria-hidden","true"),n&&n instanceof HTMLElement&&n.removeAttribute("aria-describedby"),kc&&kc!==n&&kc.removeAttribute("aria-describedby"),kc=null)}function sP(n){if(!n||!(n instanceof HTMLElement)||!document.body.contains(n))return;const e=UBe();kc&&kc!==n&&zr(kc);const t=n.dataset.tooltipTitle||n.textContent||"",s=n.dataset.tooltipDescription||"",a=n.dataset.tooltipParams||"";if(e.innerHTML="",t){const f=document.createElement("div");f.className="pattern-snippet-tooltip-title",f.textContent=t,e.appendChild(f)}if(s){const f=document.createElement("div");f.className="pattern-snippet-tooltip-body",s.split(`
`).forEach((v,O)=>{const k=v.trim();k&&(O>0&&f.appendChild(document.createElement("br")),f.appendChild(document.createTextNode(k)))}),f.childNodes.length>0&&e.appendChild(f)}if(a){const f=document.createElement("div");f.className="pattern-snippet-tooltip-params",a.split(`
`).forEach(v=>{const O=v.trim();if(!O)return;const k=document.createElement("div");k.textContent=O,f.appendChild(k)}),f.childElementCount>0&&e.appendChild(f)}e.style.display="block",e.style.visibility="hidden",e.classList.remove("visible");const r=n.getBoundingClientRect(),o=window.innerWidth||document.documentElement.clientWidth||0,i=window.innerHeight||document.documentElement.clientHeight||0,l=e.getBoundingClientRect(),c=8;let u=r.bottom+c;if(u+l.height>i-12){const f=r.top-l.height-c;f>=12?u=f:u=Math.max(12,i-l.height-12)}let h=r.left+r.width/2-l.width/2;const m=o-l.width-12;h>m&&(h=m),h<12&&(h=12),e.style.left=`${Math.round(h)}px`,e.style.top=`${Math.round(u)}px`,e.style.visibility="visible",e.classList.add("visible"),e.setAttribute("aria-hidden","false"),e.id||(e.id="pattern-snippet-tooltip"),n.setAttribute("aria-describedby",e.id),kc=n}let aP=null,rP=null,kN="",oP=null;function IJ(n){return!n||typeof n!="string"?"":n.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").trim()}function HBe(n,e){if(!e)return n;const t=IJ(e),s=new Set((t.match(/\.[a-zA-Z_][a-zA-Z0-9_]*/g)||[]).map(a=>Vi(a)));return n.filter(a=>{const r=Vi(a);return df[r]?!0:!s.has(r)})}async function PN(n=""){const e=IJ(n);if(e===kN&&oP)return oP;rP||(aP||(aP=(async()=>{const r=new Map;QBe.forEach(O=>{const k=Vi(O);!r.has(k)&&O&&r.set(k,O)});const o=await _C();o.forEach((O,k)=>{r.has(k)||/^[a-z][\w]*$/i.test(O.name)&&r.set(k,`${O.name}()`)});const i=Ff.reduce((O,k)=>(O.set(k.id,{snippets:[]}),O),new Map),l=new Set(M1.map(O=>Vi(O))),c=new Map;Array.from(r.entries()).sort((O,k)=>O[0].localeCompare(k[0])).forEach(([O,k])=>{const M=o.get(O),E=Ff.find(D=>D.exclude&&D.exclude.includes(O)?!1:D.matcher(O,k,M))||Ab.get("other"),I=i.get(E.id);I&&I.snippets.push({snippet:k,groupId:E.id,className:E.className,heading:E.heading}),l.has(O)&&c.set(O,{snippet:k,groupId:E.id,className:E.className,heading:E.heading})});const u=M1.map(O=>{const k=Vi(O);return c.get(k)||{snippet:O,groupId:"core",className:Ab.get("core").className,heading:Ab.get("core").heading}}).filter(Boolean).sort((O,k)=>O.snippet.localeCompare(k.snippet)),h=[],m=new Set;u.forEach(O=>{const{snippet:k,groupId:M,className:E,heading:I}=O;h.push({snippet:k,groupId:M,className:E,heading:I})}),[...Ff].sort((O,k)=>O.heading.localeCompare(k.heading)).forEach(O=>{const k=i.get(O.id);!k||!k.snippets.length||(m.has(O.id)||m.add(O.id),k.snippets.slice().sort((M,E)=>M.snippet.localeCompare(E.snippet)).forEach(({snippet:M,className:E,heading:I})=>{M1.includes(M)||h.push({snippet:M,groupId:O.id,className:E,heading:I})}))});const v=Ab.get("synths");return v&&VBe.forEach(O=>{h.some(k=>k.snippet===O)||h.push({snippet:O,groupId:v.id,className:v.className,heading:v.heading})}),rP=h,h})()),await aP);const t=rP||[],s=HBe(t.map(r=>r.snippet),e),a=t.filter(r=>s.includes(r.snippet));return kN=e,oP=a,a}function Db(n){if(!n||typeof n!="string")return n;const e=n.trim();return f0[e.toLowerCase()]||e}function SN(n){if(!n||typeof n!="string")return n;let e=n;for(const[t,s]of Object.entries(f0)){const a=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp(`(\\.s\\(["'])${a}(["']\\))`,"gi");e=e.replace(r,(i,l,c)=>`${l}${s}${c}`);const o=new RegExp(`(sound\\(["'])${a}(["']\\))`,"gi");e=e.replace(o,(i,l,c)=>`${l}${s}${c}`)}return e}function YBe(n){if(!n||typeof n!="string")return!1;for(const e of IBe){const t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(new RegExp(`\\.s\\(["']${t}["']\\)`,"i").test(n))return!0}return/\b(note|n)\s*\(/.test(n)}function KBe(n){if(!n||typeof n!="string")return"";const e=n.trim();if(!e)return"";if(e.includes("sound(")||e.includes("s(")||To(e))return e;const t=e.split(/\s+/).filter(o=>o.trim()),s=[],a=[];for(const o of t)if(o)if(o.startsWith("."))a.push(o);else{const i=o.split("(")[0].trim();i&&($J.hasOwnProperty(i.toLowerCase())||i.length>0)&&s.push(i)}if(s.length===0)return e;let r=`sound("${s.join(" ")}")`;return a.length>0&&(r+=a.join("")),r}function Ni(n){let e=4,t=4;if(typeof n=="string"&&n.includes("/")){const[o,i]=n.split("/"),l=parseInt(o,10),c=parseInt(i,10);Number.isFinite(l)&&l>0&&(e=l),Number.isFinite(c)&&c>0&&(t=c)}const s=16/t,a=Math.max(1,Math.round(s)),r=Math.max(e,1)*a;return{signature:`${e}/${t}`,numerator:e,denominator:t,stepsPerBeat:a,totalSteps:r}}const JBe=(n,e,t,s)=>{const a=(n-90)*Math.PI/180;return[t+Math.cos(a)*e,s+Math.sin(a)*e]},CN=(n,e,t,s,a=0)=>{const r=(n+a)*360;return JBe(r,e*n,t,s)};function MN(n,e){let{from:t=0,to:s=3,margin:a=40,cx:r=100,cy:o=100,rotate:i=0,thickness:l=a/2,color:c="#4c51bf",cap:u="round",stretch:h=1,fromOpacity:m=1,toOpacity:f=1}=e;t*=h,s*=h,i*=h,n.lineWidth=l,n.lineCap=u,n.strokeStyle=c,n.globalAlpha=m,n.beginPath();let[v,O]=CN(t,a,r,o,i);n.moveTo(v,O);const k=1/60;let M=t;for(;M<=s;){const[E,I]=CN(M,a,r,o,i);n.globalAlpha=(M-t)/(s-t)*f,n.lineTo(E,I),M+=k}n.stroke(),n.globalAlpha=1}const e6e=4,t6e=2;class AN{constructor(){xs=this,this.activeElements=new Set,this.initialized=!1,this.currentEditingElementId=null,this.mutedElements=new Set,this.soloedElements=new Set,this.isMobileView=typeof window<"u"?window.matchMedia("(max-width: 640px)").matches:!1,this.initialElementCount=this.isMobileView?t6e:e6e,this.elementCounter=this.initialElementCount,this.masterActive=!1,this.masterPatternField=null,this._applyingVisualizer=!1,this.elementMidiSettings=this.loadStoredMidiSettings(),this.currentTimeSignature="4/4",this.currentTimeSignatureMetrics=Ni(this.currentTimeSignature),this.masterPunchcardContainer=null,this.masterPunchcardHeaderNote=null,this.masterPunchcardCanvas=null,this.masterPunchcardCtx=null,this.masterPunchcardPlaceholder=null,this.masterPunchcardIsRendering=!1,this.masterPunchcardPendingRefresh=!1,this.masterPunchcardResizeTimer=null,this.externalVisualizerCanvas=null,this.externalVisualizerObserver=null,this.externalVisualizerType=null,this.scopeAnimationFrame=null,this.barchartAnimationFrame=null,this.cameraBlendAnimationFrame=null,this.scopeDataArray=null,this.spectrumDataArray=null,this.activeVisualizerLoop=null,this.introSamplePlayed=!1,this._introSampleActivationHandler=null,this.nativeHighlightingEnabled=!1,this.nativeHighlightingDisabled=!1,this.nativeHighlightRetryCount=0,this.nativeHighlightRetryTimer=null,this.visualizerFullscreenBtn=null,this.handleVisualizerFullscreenChange=this.handleVisualizerFullscreenChange.bind(this),document.addEventListener("fullscreenchange",this.handleVisualizerFullscreenChange),document.addEventListener("webkitfullscreenchange",this.handleVisualizerFullscreenChange),document.addEventListener("mozfullscreenchange",this.handleVisualizerFullscreenChange),document.addEventListener("MSFullscreenChange",this.handleVisualizerFullscreenChange),this.chaospadEnabled=!1,this.currentCutoffValue=null,this.lastCutoffUpdate=null,this.currentResonanceValue=null,this.lastResonanceUpdate=null,this.currentVolumeValue=null,this.lastVolumeUpdate=null,this.currentPanValue=null,this.lastPanUpdate=null,this.currentDelayAmountValue=null,this.lastDelayAmountUpdate=null,this.currentDelayFeedbackValue=null,this.lastDelayFeedbackUpdate=null,this.currentReverbAmountValue=null,this.lastReverbAmountUpdate=null,this.currentReverbRoomSizeValue=null,this.lastReverbRoomSizeUpdate=null,this.chaospadSettings={minFrequency:oe.masterFilterMinHz||80,maxFrequency:oe.masterFilterMaxHz||8e3,minResonance:oe.masterFilterMinQ||.1,maxResonance:oe.masterFilterMaxQ||5,xAxis:{effect:"cutoff",min:oe.masterFilterMinHz||80,max:oe.masterFilterMaxHz||8e3},yAxis:{effect:"resonance",min:oe.masterFilterMinQ||.1,max:oe.masterFilterMaxQ||5}},this.chaospadDefaults={cutoff:Math.min(this.chaospadSettings.maxFrequency,Math.max(this.chaospadSettings.minFrequency,oe.masterFilterFrequency||4040)),resonance:Math.min(this.chaospadSettings.maxResonance,Math.max(this.chaospadSettings.minResonance,oe.masterFilterResonance||.7)),volume:oe.masterVolume||.7,pan:oe.masterPan||0,delayAmount:oe.masterDelayAmount||0,delayFeedback:oe.masterDelayFeedback||.5,reverbAmount:oe.masterReverbAmount||0,reverbRoomSize:oe.masterReverbRoomSize||.5},this.chaospadOrientationActive=!1,this.chaospadOrientationPermission="unknown",this.chaospadVirtualGravity={x:0,y:0},this.chaospadTiltAvailable=!1,typeof window<"u"&&(typeof window.gravityX>"u"&&(window.gravityX=0),typeof window.gravityY>"u"&&(window.gravityY=0)),this.handleChaospadOrientation=this.handleChaospadOrientation.bind(this),this.collabUnsubscribers=[],this.masterUpdateQueue=[],this.masterUpdateTimer=null,this.topTracks=[],this.visualizerTextInterval=null,this.hasGdprConsent=this.getStoredGdprConsent(),this.postConsentReady=!1,this.gdprOverlay=null,this.gdprAcceptButton=null,this.cameraEnabled=!1,this.cameraStream=null,this.cameraVideo=null,this.cameraBlendValue=.5,this.cameraAvailable=!1,this.cameraBlendSlider=null,this.cameraBlendSliderMobile=null,this.isMobileView&&this.limitInitialElementsForMobile()}limitInitialElementsForMobile(){const e=document.querySelector(".elements-container");e&&Array.from(e.querySelectorAll(".sound-element")).slice(this.initialElementCount).forEach(s=>s.remove()),Array.isArray(fs.elements)&&fs.elements.length>this.initialElementCount&&fs.elements.splice(this.initialElementCount)}updateMobileOrientationLock(){const e=screen==null?void 0:screen.orientation;!this.isMobileView||!e||typeof e.lock!="function"||(this.chaospadEnabled?e.lock("portrait").catch(()=>{}):typeof e.unlock=="function"&&e.unlock())}setChaospadTiltAvailability(e){this.chaospadTiltAvailable=!!e,this.refreshTiltControlsState(),this.syncTiltSlidersFromGravity()}refreshTiltControlsState(){const e=document.getElementById("chaospad-tilt-inline");if(!e)return;const t=this.chaospadEnabled&&this.chaospadTiltAvailable;e.classList.toggle("active",t),e.querySelectorAll('input[type="range"]').forEach(s=>{s.disabled=!t}),this.updateTiltValueLabels()}updateTiltValueLabels(){const e=document.getElementById("chaospad-tilt-x"),t=document.getElementById("chaospad-tilt-y"),s=document.getElementById("chaospad-tilt-x-value"),a=document.getElementById("chaospad-tilt-y-value");if(e&&s){const r=parseInt(e.value,10)||0;s.textContent=`${r}°`}if(t&&a){const r=parseInt(t.value,10)||0;a.textContent=`${r}°`}}applyTiltFromSliders(){if(!this.chaospadEnabled)return;const e=document.getElementById("chaospad-tilt-x"),t=document.getElementById("chaospad-tilt-y");if(!e||!t)return;const s=parseFloat(e.value)||0,a=parseFloat(t.value)||0,r=(s+45)/90,o=1-(a+45)/90;this.applyChaospadInputFromPercentages(r,o,"slider")}syncTiltSlidersFromGravity(e="mouse"){if(e==="slider")return;const t=document.getElementById("chaospad-tilt-x"),s=document.getElementById("chaospad-tilt-y");if(!t||!s||t.disabled)return;const a=this.chaospadVirtualGravity||{x:0,y:0},r=Math.max(-45,Math.min(45,Math.round((a.x||0)*45))),o=(a.y+1)/2,i=Math.max(-45,Math.min(45,Math.round((1-o)*90-45)));t.value=r,s.value=i,this.updateTiltValueLabels()}async loadTopTracks(e=5){const t=document.getElementById("top-tracks-list"),s=document.getElementById("top-tracks-empty");if(!(!t||!s)){s.style.display="block",s.textContent="Loading top tracks…",t.innerHTML="";try{const a=await vu.getTopTracks(e);if(this.topTracks=a,!a.length){s.textContent="No public tracks yet. Save a track to be featured.";return}s.style.display="none",t.innerHTML=a.map((r,o)=>this.renderTopTrackCard(r,o)).join(""),t.querySelectorAll("[data-track-index]").forEach(r=>{r.addEventListener("click",()=>{const o=Number(r.dataset.trackIndex),i=this.topTracks[o];i&&this.applyTopTrackToMaster(i)})})}catch(a){console.error("Failed to load top tracks:",a),s.style.display="block",s.textContent="Unable to load top tracks. Please try again later."}}}renderTopTrackCard(e,t){var O,k,M,E,I,D,F,_,$;const s=((O=e.title)==null?void 0:O.trim())||"Untitled Track",a=((k=e.artistName)==null?void 0:k.trim())||((M=e.user)==null?void 0:M.artistName)||((E=e.user)==null?void 0:E.name)||"Unknown Artist",r=((I=e.genre)==null?void 0:I.trim())||"Uncategorized",o=((D=e.analytics)==null?void 0:D.masterLoadCount)??0,i=((_=(F=e.metadata)==null?void 0:F.imageUrl)==null?void 0:_.trim())||(($=e.user)==null?void 0:$.avatarUrl)||"",l=s.charAt(0).toUpperCase(),c=!!i,u=this.escapeHtml(s),h=this.escapeHtml(a),m=this.escapeHtml(r),f=this.escapeHtml(i),v=`${o} ${o===1?"add":"adds"}`;return`
      <button type="button" class="top-track-card" data-track-index="${t}" data-track-id="${e.id||""}">
        <div class="top-track-image ${c?"":"fallback"}">
          ${c?`<img src="${f}" alt="${u} cover art" loading="lazy" onerror="this.parentElement.classList.add('fallback'); this.remove();">`:""}
          <span class="top-track-placeholder">${this.escapeHtml(l)}</span>
        </div>
        <div class="top-track-info">
          <h4>${u}</h4>
          <p class="top-track-artist">${h}</p>
          <span class="top-track-genre">${m}</span>
          <span class="top-track-count">${v}</span>
        </div>
      </button>
    `}applyTopTrackToMaster(e){if(!(e!=null&&e.patternCode))return;const t=e.patternCode.trim();Vn("master-pattern",t),oe.setMasterPatternCode(t),this.updateMasterPatternDisplay();const s=e.title||"Untitled Track";Os.updateStatus(`Loaded “${s}” into master`),e.id&&vu.recordMasterLoad(e.id).then(a=>{const r=(a==null?void 0:a.masterLoadCount)??null;r!==null&&this.updateTopTrackLoadCount(e.id,r)}).catch(a=>{console.warn("⚠️ Failed to record master load:",(a==null?void 0:a.message)||a)})}updateTopTrackLoadCount(e,t){if(!e||t===void 0||t===null)return;Array.isArray(this.topTracks)&&(this.topTracks=this.topTracks.map(a=>a.id===e?{...a,analytics:{...a.analytics||{},masterLoadCount:t}}:a));const s=document.querySelector(`.top-track-card[data-track-id="${e}"] .top-track-count`);s&&(s.textContent=`${t} ${t===1?"add":"adds"}`)}startVisualizerTitleLoop(){if(this.visualizerTextInterval)return;const e=document.querySelectorAll("[data-visualizer-label]");if(!e.length)return;const t=[{text:"STRUDESK 4000",className:"punchcard-logo--latin",lang:"en"},{text:"스트루데스크 4000",className:"punchcard-logo--korean",lang:"ko"}],s=Array.from(new Set(t.map(o=>o.className).filter(Boolean)));let a=0;const r=()=>{const o=t[a];e.forEach(i=>{s.forEach(l=>i.classList.remove(l)),o.className&&i.classList.add(o.className),o.lang?i.setAttribute("lang",o.lang):i.removeAttribute("lang"),i.textContent=o.text}),a=(a+1)%t.length};r(),this.visualizerTextInterval=window.setInterval(r,5e3)}escapeHtml(e=""){const t=document.createElement("div");return t.textContent=e??"",t.innerHTML}async init(){oe.appInstance=this,this.startVisualizerTitleLoop(),this.setupGdprConsentFlow(),Os.onUpdate("tempo",h=>{oe.setTempo(h)}),Os.onUpdate("key",h=>{oe.setKey(h),console.log(`🎹 Key changed to: ${h}`)}),Os.onUpdate("scale",h=>{oe.setScale(h),console.log(`🎼 Scale changed to: ${h||"(none)"}`)}),Os.onUpdate("timeSignature",h=>{if(this.currentTimeSignature=h||"4/4",this.currentTimeSignatureMetrics=Ni(this.currentTimeSignature),oe.setTimeSignature(h),console.log(`🎵 Time signature changed to: ${h}`),typeof this.applyTimeSignatureToDrumGrid=="function")try{this.applyTimeSignatureToDrumGrid(this.currentTimeSignature)}catch(m){console.warn("⚠️ Could not update drum grid for new time signature:",m)}this.refreshMasterPunchcard("time-signature-change").catch(m=>{console.warn("⚠️ Could not refresh punchcard after time signature change:",m)})}),Os.setSoundTrigger((h,m)=>{oe.isAudioReady()&&(m.type==="synthesized"?oe.playSynthesizedSound(h,m.pattern).catch(f=>{console.error(`Error triggering control sound for ${h}:`,f)}):m.type==="strudel"&&oe.playStrudelPattern(h,m.pattern).catch(f=>{console.error(`Error triggering control sound for ${h}:`,f)}))}),this.registerElements(),this.setupElementControls(),oe.onSoundsReady(()=>{console.log("🎉 Sounds are ready - activating green dots"),this.setAllElementsLoaded(),Os.updateStatus("Ready - Click elements to start/stop patterns (Press Escape to stop all)"),this.enableNativeStrudelHighlighting()}),oe.onMasterPatternUpdate(async()=>{console.log("🔄 Master pattern updated - refreshing display"),this.updateMasterPatternDisplay(),this.updateActiveElementsDisplay(),this.refreshMasterPunchcard("master-update").catch(h=>{console.warn("⚠️ Could not refresh punchcard after master update:",h)})}),oe.onMasterStateChange((h,m)=>{console.log(`🎚️ Master state changed: ${h?"playing":"stopped"}, elements: ${m.join(", ")}`),this.masterActive=h;const f=document.getElementById("play-master-btn"),v=document.querySelector(".master-active-dot");f&&(h?(f.textContent="❚❚",f.title="Pause Master",f.classList.add("active")):(f.textContent="▶",f.title="Play Master",f.classList.remove("active"))),v&&(h?v.classList.add("active"):v.classList.remove("active")),h?Os.updateStatus("Playing Master"):this.activeElements.size>0||Os.updateStatus("Ready - Click elements to start/stop patterns (Press Escape to stop all)");const O=document.getElementById("pattern-slots");O&&(O.style.display=h?"none":"block"),m.forEach(k=>{this.updateStatusDots(k,!0,h)}),h||document.querySelectorAll(".element-circle").forEach(k=>{k.classList.remove("playing")}),h?(this.selectedVisualizer==="off"?this.showMasterPunchcardPlaceholder():this.hideMasterPunchcardPlaceholder(),this.enableNativeStrudelHighlighting()):this.selectedVisualizer==="off"?this.showMasterPunchcardPlaceholder():this.hideMasterPunchcardPlaceholder()}),this.setupMasterChannel();const e=h=>{console.log("Key pressed:",h.key),(h.key==="Escape"||h.keyCode===27)&&(console.log("🛑 Emergency stop activated (Escape key pressed)"),h.preventDefault(),h.stopPropagation(),oe.stopAllSounds(),Os.updateStatus("🛑 All sounds stopped"),this.activeElements.clear(),this.updateActiveElementsDisplay(),fs.elements.forEach(m=>{const f=this.elementHasPattern(m.id);this.updateStatusDots(m.id,f,!1)}))};document.addEventListener("keydown",e,!0),window.addEventListener("keydown",e,!0),console.log("✅ Escape key handler registered");let t=null;const s=h=>{(h.key==="s"||h.key==="S")&&h.shiftKey&&!h.ctrlKey&&!h.metaKey&&!h.altKey&&(h.preventDefault(),t||(t=new Audio(Wk),t.volume=.7),t.currentTime=0,t.play().catch(m=>{console.warn("⚠️ Could not play Shift+S sound:",m)}))};document.addEventListener("keydown",s,!0),window.addEventListener("keydown",s,!0),console.log("✅ Shift+S key sound handler registered");const a=new Set,r={c:"C",d:"D",e:"E",f:"F",g:"G",a:"A",b:"B"},o={C:"C#",D:"D#",F:"F#",G:"G#",A:"A#"},i={C:"Db",D:"Eb",F:"Gb",G:"Ab",A:"Bb"},l=async h=>{const m=h.key.toLowerCase(),f=r.hasOwnProperty(m),v=/^[0-9]$/.test(m);if((f||v||(m==="+"||m==="="))&&a.add(m),f&&!h.repeat){const k=h.shiftKey,M=h.ctrlKey||h.metaKey;let E=r[m];k&&o.hasOwnProperty(E)?E=o[E]:M&&i.hasOwnProperty(E)&&(E=i[E]);let I=3;for(const _ of a)if(/^[0-9]$/.test(_)){I=parseInt(_,10);break}const D=document.activeElement,F=D&&(D.tagName==="INPUT"||D.tagName==="TEXTAREA"||D.isContentEditable);if(oe.isAudioReady()&&!F){h.preventDefault();const _=`${E}${I}`,$="keyboard-piano",Z=a.has("+")||a.has("=");if(oe.trackedPatterns.has($)){const ce=oe.trackedPatterns.get($);let U=(ce==null?void 0:ce.rawPattern)||(ce==null?void 0:ce.pattern)||"";if(Z&&U){const ue=U.match(/note\s*\(\s*["']([^"']+)["']/);if(ue){const de=`${ue[1]} ${_}`;U=U.replace(/note\s*\(\s*["']([^"']+)["']/,`note("${de}"`)}else U=`note("${_}").s("piano")`}else U=`note("${_}").s("piano")`;await oe.updatePatternInPlace($,U),this.updateMasterPatternDisplay&&this.updateMasterPatternDisplay()}else{const ce=`note("${_}").s("piano")`;await oe.saveElementToMaster($,ce,.8,0),this.updateMasterPatternDisplay&&this.updateMasterPatternDisplay()}}}},c=h=>{const m=h.key.toLowerCase();(r.hasOwnProperty(m)||/^[0-9]$/.test(m)||m==="+"||m==="=")&&a.delete(m)};document.addEventListener("keydown",l,!0),document.addEventListener("keyup",c,!0),window.addEventListener("keydown",l,!0),window.addEventListener("keyup",c,!0),console.log("✅ Keyboard piano handler registered");const u=document.getElementById("stop-all-btn");u?(u.addEventListener("click",()=>{console.log("🛑 Stop All button clicked"),oe.stopAllSounds(),Os.updateStatus("🛑 All sounds stopped"),this.activeElements.clear(),this.updateActiveElementsDisplay(),fs.elements.forEach(h=>{const m=this.elementHasPattern(h.id);this.updateStatusDots(h.id,m,!1)})}),console.log("✅ Stop All button handler registered")):console.warn("⚠️ Stop All button not found in DOM"),this.initialized=!0,this.setAllElementsNotLoaded(),this.migrateLocalStorageQuotes(),this.loadAllElementConfigs(),this.setupModal(),this.setupAddElementButton(),Os.updateStatus("Ready - Click anywhere to enable audio (Press Escape to stop all sounds)"),setTimeout(()=>{try{bbe(),this.enableNativeStrudelHighlighting()}catch(h){console.warn("⚠️ Strudel REPL editor initialization failed (non-critical):",h.message),console.log("💡 Pattern editing will use plain textareas instead")}},100),this.setupCollaborationBridge(),console.log("Interactive Sound App initialized"),console.log("💡 Tip: Press Escape key or click Stop All button to silence everything")}initializeElementVisualizations(e=null,t=null){(e?[e]:document.querySelectorAll(".sound-element")).forEach(a=>{const r=t||a.dataset.soundId;if(!r)return;a.querySelector(".config-button");const o=this.loadElementConfig(r);if(o&&o.pattern&&o.pattern.trim()!==""){const l=o.title&&o.title.trim()?o.title:o.bank?Tf[o.bank]||o.bank:"";Ho(r,l)}else Ho(r,"")})}setupMasterChannel(){const e=document.getElementById("master-volume"),t=document.getElementById("master-pan"),s=document.getElementById("master-mute-btn"),a=document.getElementById("master-volume-value"),r=document.getElementById("master-pan-value");if(e){const o=parseFloat(e.value);oe.masterVolume=o/100,a&&(a.textContent=Math.round(o)),console.log(`🎚️ Master volume slider initialized: ${o}% (${oe.masterVolume})`),e.addEventListener("input",i=>{const l=parseFloat(i.target.value);console.log(`🎚️ Master volume slider changed: ${l}%`),oe.setMasterVolume(l/100),a&&(a.textContent=Math.round(l)),oe.updateMasterPattern(this.soloedElements,this.mutedElements)}),oe.isAudioReady()&&oe.masterGainNode?(console.log(`🎚️ Audio already ready, setting master volume to ${o}%`),oe.setMasterVolume(o/100)):console.log("🎚️ Audio not ready yet, master volume will be set on initialization")}else console.warn("⚠️ Master volume slider not found in DOM");if(t){const o=parseFloat(t.value);oe.masterPan=o,r&&(r.textContent=o.toFixed(2)),console.log(`🎚️ Master pan slider initialized: ${o}`),t.addEventListener("input",i=>{const l=parseFloat(i.target.value);console.log(`🎚️ Master pan slider changed: ${l}`),oe.setMasterPan(l),r&&(r.textContent=l.toFixed(2)),oe.updateMasterPattern(this.soloedElements,this.mutedElements)}),oe.isAudioReady()&&oe.masterPanNode?(console.log(`🎚️ Audio already ready, setting master pan to ${o}`),oe.setMasterPan(o)):console.log("🎚️ Audio not ready yet, master pan will be set on initialization")}else console.warn("⚠️ Master pan slider not found in DOM");s&&s.addEventListener("click",()=>{console.log("🎚️ Master mute button clicked");const o=oe.toggleMasterMute();s.textContent=o?"🔇":"🔊",s.title=o?"Unmute Master":"Mute Master",console.log(`🎚️ Master mute toggled: ${o?"MUTED":"UNMUTED"}`)}),this.setupMasterPatternControls(),this.setupMasterPunchcard(),console.log("✅ Master channel controls setup complete")}tryPlayIntroSample(){if(this.introSamplePlayed||!Wk||!oe)return;const e=typeof oe.getAudioContext=="function"?oe.getAudioContext():null,t=oe.isAudioReady()&&e,s=()=>{try{oe.playAudioFile("intro-sample",Wk),this.introSamplePlayed=!0,this.detachIntroSampleActivationHandlers()}catch(a){console.warn("⚠️ Unable to play intro sample automatically:",a)}};t?e.state!=="running"?e.resume().then(()=>{s()}).catch(a=>{console.warn("⚠️ Unable to resume audio context for intro sample:",a),this.attachIntroSampleActivationHandlers()}):s():this.attachIntroSampleActivationHandlers()}attachIntroSampleActivationHandlers(){this._introSampleActivationHandler||this.introSamplePlayed||(this._introSampleActivationHandler=()=>{if(oe!=null&&oe.getAudioContext){const e=oe.getAudioContext();e&&e.state==="suspended"&&e.resume().catch(()=>{})}this.tryPlayIntroSample()},document.addEventListener("pointerdown",this._introSampleActivationHandler,{passive:!0}),document.addEventListener("keydown",this._introSampleActivationHandler))}detachIntroSampleActivationHandlers(){this._introSampleActivationHandler&&(document.removeEventListener("pointerdown",this._introSampleActivationHandler),document.removeEventListener("keydown",this._introSampleActivationHandler),this._introSampleActivationHandler=null)}setupMasterPatternControls(){this.masterPatternField=document.getElementById("master-pattern");const e=document.getElementById("play-master-btn"),t=document.getElementById("update-master-btn"),s=document.querySelector(".master-active-dot");if(!this.masterPatternField){console.warn("⚠️ Master pattern field not found in DOM");return}if(e){const i=async l=>{var c,u,h,m,f,v,O;if(console.log(`▶️ [PLAY] Event: ${l.type}, masterActive: ${this.masterActive}`),console.log(`▶️ [PLAY] Audio ready: ${oe.isAudioReady()}, context: ${!!oe.audioContext}, state: ${((c=oe.audioContext)==null?void 0:c.state)||"N/A"}`),console.log(`▶️ [PLAY] Strudel loaded: ${oe.strudelLoaded}, scheduler: ${!!((u=window.strudel)!=null&&u.scheduler)}, started: ${((m=(h=window.strudel)==null?void 0:h.scheduler)==null?void 0:m.started)||!1}`),l.type==="touchstart"&&oe.audioContext)if(l.preventDefault(),oe.audioContext.state!=="running"){console.log("🎵 [PLAY] Touch: Resuming audio context immediately...");try{await oe.audioContext.resume(),console.log(`🎵 [PLAY] Touch: Audio context resumed, state: ${oe.audioContext.state}`)}catch(k){console.error("🎵 [PLAY] Touch: Could not resume in touch handler:",k)}}else console.log("🎵 [PLAY] Touch: Audio context already running");else l.type==="touchstart"&&(l.preventDefault(),console.log("🎵 [PLAY] Touch: No audio context yet, will initialize in playMasterPattern"));if(this.masterActive)console.log("⏸️ Pause Master button clicked"),(await oe.stopMasterPattern()).success&&(this.masterActive=!1,oe.masterActive=!1,e.textContent="▶",e.title="Play Master",e.classList.remove("active"),s&&s.classList.remove("active"),console.log("✅ Master playback paused"));else{console.log("▶️ Play Master button clicked");const k="modal-preview";if(oe.isPlaying(k)){console.log("⏹️ Stopping modal preview before playing master"),oe.stopSound(k);const I=document.getElementById("modal-preview-btn");I&&(I.textContent="▶ Preview Pattern",I.classList.remove("active"))}const M=Qn("master-pattern").trim();if(M&&M!==oe.getMasterPatternCode()){if(oe.masterPattern=oe.formatMasterPatternWithTempoComment(M),typeof this.syncElementsFromMasterPattern=="function")try{this.syncElementsFromMasterPattern(oe.masterPattern)}catch(I){console.warn("⚠️ Could not sync elements from master code before play:",I)}console.log("📝 Updated master pattern code directly before playing")}this.selectedVisualizer&&this.selectedVisualizer!=="punchcard"&&this.selectedVisualizer!=="off"?(console.log(`🎨 Preparing canvas for visualizer "${this.selectedVisualizer}"`),await this.prepareCanvasForExternalVisualizer()):this.showMasterPunchcardPlaceholder(),console.log(`🎨 Applying visualizer "${this.selectedVisualizer||"off"}" before playing`);try{await this.applyVisualizerToMaster()}catch(I){console.warn("⚠️ Error applying visualizer, continuing with playback:",I)}console.log("▶️ [PLAY] Calling playMasterPattern...");const E=await oe.playMasterPattern();console.log("▶️ [PLAY] playMasterPattern result:",E),console.log(`▶️ [PLAY] After playMasterPattern - audioContext state: ${((f=oe.audioContext)==null?void 0:f.state)||"N/A"}`),console.log(`▶️ [PLAY] After playMasterPattern - scheduler started: ${((O=(v=window.strudel)==null?void 0:v.scheduler)==null?void 0:O.started)||!1}`),E.success?(this.masterActive=!0,e.textContent="❚❚",e.title="Pause Master",e.classList.add("active"),s&&s.classList.add("active"),console.log("✅ [PLAY] Master playback started"),setTimeout(()=>{var I,D,F;console.log(`▶️ [PLAY] Post-start check - audioContext state: ${((I=oe.audioContext)==null?void 0:I.state)||"N/A"}`),console.log(`▶️ [PLAY] Post-start check - scheduler started: ${((F=(D=window.strudel)==null?void 0:D.scheduler)==null?void 0:F.started)||!1}`),oe.audioContext&&oe.audioContext.state!=="running"&&console.error("❌ [PLAY] Audio context not running after start!")},500)):(console.error("❌ [PLAY] Failed to play master:",E.error),alert(`Failed to play master: ${E.error}`))}};e.addEventListener("click",i),e.addEventListener("touchstart",i,{passive:!1}),this._masterSpacebarHandlerAttached||(this._masterSpacebarHandlerAttached=!0,document.addEventListener("keydown",async l=>{var m;if(l.code!=="Space")return;const c=document.activeElement,u=(m=c==null?void 0:c.tagName)==null?void 0:m.toLowerCase();c!=null&&c.isContentEditable||u==="textarea"||u==="input"&&(c==null?void 0:c.type)!=="button"&&(c==null?void 0:c.type)!=="checkbox"&&(c==null?void 0:c.type)!=="range"||u==="select"||(l.preventDefault(),e.click())}))}const a=document.getElementById("export-audio-btn");a&&a.addEventListener("click",async()=>{if(console.log("🎵 Export Audio button clicked"),!oe.getMasterPatternCode()||oe.getMasterPatternCode().trim()===""){alert("No master pattern to export. Please create a pattern first.");return}const i=prompt("Enter export duration in seconds (default: 16):","16");if(i===null)return;const l=parseInt(i)||16;a.disabled=!0,a.textContent="⏳ Exporting...";try{const c=await oe.exportAudioWAV(l);c.success?(c.warning?alert(`⚠️ Audio exported as ${c.format.toUpperCase()}!

${c.warning}`):alert(`✅ Audio exported successfully as ${c.format.toUpperCase()}!`),console.log("✅ Audio export complete")):(alert(`❌ Export failed: ${c.error}`),console.error("❌ Audio export failed:",c.error))}catch(c){alert(`❌ Export error: ${c.message}`),console.error("❌ Audio export error:",c)}finally{a.disabled=!1,a.textContent="🎵 Export Audio"}}),t&&t.addEventListener("click",async()=>{console.log("💾 Update Master button clicked");const i=Qn("master-pattern").trim();if(!i){alert("Master pattern is empty");return}const l=await oe.setMasterPatternCode(i);l.success?(console.log("✅ Master pattern code updated"),alert("Master pattern updated successfully!")):(console.error("❌ Failed to update master:",l.error),alert(`Failed to update master: ${l.error}`))});const r=document.getElementById("copy-code-btn");r&&r.addEventListener("click",async()=>{const i=this.masterPatternField.value.trim();if(!i){alert("Master pattern is empty");return}try{const l="// Created with Strudesk 4000 by eKommissar",c=i.startsWith(l)?i:`${l}

${i}`;await navigator.clipboard.writeText(c);const u=r.textContent;r.textContent="✓ Copied!",r.title="Copied!",setTimeout(()=>{r.textContent=u,r.title="Copy"},2e3),console.log("✅ Master pattern code copied to clipboard")}catch(l){console.error("❌ Failed to copy code:",l),alert("Failed to copy code to clipboard")}});const o=document.getElementById("clear-all-btn");o&&o.addEventListener("click",()=>{confirm("Are you sure you want to clear all? This will clear the master pattern and all element configurations.")&&(console.log("🗑️ Clear All button clicked"),this.resetAll())}),console.log("✅ Master pattern controls setup complete")}setupMasterPunchcard(){if(this.masterPunchcardContainer=document.getElementById("master-punchcard"),this.masterPunchcardCanvas=document.getElementById("master-punchcard-canvas"),this.masterPunchcardPlaceholder=this.masterPunchcardContainer?this.masterPunchcardContainer.querySelector(".punchcard-placeholder"):null,!this.masterPunchcardContainer||!this.masterPunchcardCanvas){console.warn("⚠️ Master punchcard elements not found in DOM");return}const e=this.getMasterPunchcardContext();e&&(window.__strudelVisualizerCtx=e),this.selectedVisualizer="off";const t=document.getElementById("visualizer-select");this.visualizerSelect=t,t&&(t.value=this.selectedVisualizer,t.addEventListener("change",async l=>{this.selectedVisualizer=l.target.value,console.log(`🎨 Visualizer changed to: ${this.selectedVisualizer}`),this.selectedVisualizer!=="off"&&!this.cameraEnabled?await this.requestCameraAccess()&&(this.cameraEnabled=!0):this.selectedVisualizer!=="off"&&this.cameraEnabled&&this.cameraVideo?this.cameraVideo.paused&&this.cameraVideo.play().catch(c=>{console.warn("⚠️ Could not play camera video when enabling visualizer:",c)}):this.selectedVisualizer==="off"&&this.cameraEnabled&&this.stopCamera(),this.updateCameraControlsVisibility(),this.selectedVisualizer==="off"?this.showMasterPunchcardPlaceholder():this.selectedVisualizer!=="punchcard"?await this.prepareCanvasForExternalVisualizer():this.showMasterPunchcardPlaceholder(),await this.applyVisualizerToMaster(),this.refreshMasterPunchcard("visualizer-change").catch(c=>{console.warn("⚠️ Unable to refresh punchcard after visualizer change:",c)})})),this.visualizerFullscreenBtn=document.getElementById("visualizer-fullscreen-btn"),this.visualizerFullscreenBtn&&(this.visualizerFullscreenBtn.addEventListener("click",()=>{this.toggleVisualizerFullscreen()}),this.updateVisualizerFullscreenButton(!1)),this.cameraBlendSlider=document.getElementById("camera-blend-slider");const s=document.getElementById("camera-blend-value");document.getElementById("camera-blend-control"),this.cameraBlendSliderMobile=document.getElementById("camera-blend-slider-mobile");const a=document.getElementById("camera-blend-value-mobile");document.getElementById("camera-blend-control-mobile"),this.checkCameraAvailability(),this.updateCameraControlsVisibility(),this.cameraBlendSlider&&s&&(this.cameraBlendSlider.addEventListener("input",l=>{const c=parseInt(l.target.value,10);this.cameraBlendValue=c/100,s.textContent=`${c}%`,this.cameraBlendSliderMobile&&(this.cameraBlendSliderMobile.value=c),a&&(a.textContent=`${c}%`)}),s.textContent=`${parseInt(this.cameraBlendSlider.value,10)}%`),this.cameraBlendSliderMobile&&a&&(this.cameraBlendSliderMobile.addEventListener("input",l=>{const c=parseInt(l.target.value,10);this.cameraBlendValue=c/100,a.textContent=`${c}%`,this.cameraBlendSlider&&(this.cameraBlendSlider.value=c),s&&(s.textContent=`${c}%`)}),a.textContent=`${parseInt(this.cameraBlendSliderMobile.value,10)}%`),document.addEventListener("visibilitychange",()=>{document.hidden&&this.cameraEnabled&&this.cameraStream?this.cameraStream.getTracks().forEach(l=>{l.enabled=!1}):!document.hidden&&this.cameraEnabled&&this.cameraStream&&(this.cameraStream.getTracks().forEach(l=>{l.enabled=!0}),this.cameraVideo&&this.cameraVideo.paused&&this.cameraVideo.play().catch(l=>{console.warn("⚠️ Could not resume camera video playback:",l)}))});const r=document.getElementById("chaospad-checkbox");r&&r.addEventListener("change",async l=>{const c=this.chaospadEnabled;this.chaospadEnabled=l.target.checked,console.log(`🎛️ Chaospad ${this.chaospadEnabled?"enabled":"disabled"}`),this.updateMobileOrientationLock(),this.refreshTiltControlsState(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.cursor=this.chaospadEnabled?"pointer":""),this.chaospadEnabled?(console.log("🎛️ Chaospad: Enabled - activating master filter with defaults"),c||this.updateChaospadDefaultsFromCurrent(),oe.enableMasterFilter(!0),this.resetChaospadToDefaults(!0),this.isMobileView&&this.showChaospadMobileNotification()):(console.log("🎛️ Chaospad: Disabled - restoring defaults"),this.restoreChaospadDefaults(),oe.enableMasterFilter(!1)),await this.updateChaospadInputMode()});const o=document.getElementById("chaospad-tilt-x"),i=document.getElementById("chaospad-tilt-y");if(o&&o.addEventListener("input",()=>{this.updateTiltValueLabels(),this.chaospadEnabled&&this.chaospadTiltAvailable&&this.applyTiltFromSliders()}),i&&i.addEventListener("input",()=>{this.updateTiltValueLabels(),this.chaospadEnabled&&this.chaospadTiltAvailable&&this.applyTiltFromSliders()}),this.updateTiltValueLabels(),this.refreshTiltControlsState(),this.masterPunchcardCanvas){const l=()=>{this.chaospadEnabled?this.masterPunchcardCanvas.style.cursor="pointer":this.masterPunchcardCanvas.style.cursor=""};this.masterPunchcardCanvas.addEventListener("mousemove",c=>{this.chaospadEnabled&&this.handleChaospadMouseMove(c)}),this.masterPunchcardCanvas.addEventListener("mouseenter",c=>{this.chaospadEnabled&&this.handleChaospadMouseMove(c)}),this.masterPunchcardCanvas.addEventListener("mouseleave",()=>{this.chaospadEnabled&&this.restoreChaospadDefaults()}),l()}this.showMasterPunchcardPlaceholder(),this.handleChaospadMouseMove=this.handleChaospadMouseMove.bind(this),window.addEventListener("resize",()=>{this.masterPunchcardResizeTimer&&clearTimeout(this.masterPunchcardResizeTimer),this.masterPunchcardResizeTimer=setTimeout(()=>{this.refreshMasterPunchcard("resize").catch(l=>{console.warn("⚠️ Unable to refresh punchcard after resize:",l)})},150)}),this.refreshMasterPunchcard("initial").catch(l=>{console.warn("⚠️ Unable to render initial punchcard:",l)}),this.updateChaospadInputMode(),this.refreshTiltControlsState(),this.loadTopTracks().catch(l=>{console.warn("⚠️ Unable to load top tracks:",l)})}getCurrentFullscreenElement(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null}async toggleVisualizerFullscreen(){if(!this.masterPunchcardContainer)return;const e=this.getCurrentFullscreenElement(),t=this.masterPunchcardContainer.classList.contains("is-fullscreen")&&!e;if(e===this.masterPunchcardContainer||t){e===this.masterPunchcardContainer?document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen():(this.masterPunchcardContainer.classList.remove("is-fullscreen"),Vo("visualizer-fullscreen"),this.updateVisualizerFullscreenButton(!1),this.removeMobileFullscreenCloseButton());return}try{if(this.masterPunchcardContainer.requestFullscreen){await this.masterPunchcardContainer.requestFullscreen();return}if(this.masterPunchcardContainer.webkitRequestFullscreen)try{const s=typeof Element<"u"&&Element.ALLOW_KEYBOARD_INPUT!==void 0?Element.ALLOW_KEYBOARD_INPUT:void 0;s!==void 0?await this.masterPunchcardContainer.webkitRequestFullscreen(s):await this.masterPunchcardContainer.webkitRequestFullscreen();return}catch(s){console.warn("⚠️ Webkit fullscreen failed, trying fallback:",s)}if(this.masterPunchcardContainer.mozRequestFullScreen){await this.masterPunchcardContainer.mozRequestFullScreen();return}if(this.masterPunchcardContainer.msRequestFullscreen){await this.masterPunchcardContainer.msRequestFullscreen();return}if(this.isMobileDevice()){this.masterPunchcardContainer.classList.add("is-fullscreen"),Oi("visualizer-fullscreen"),this.updateVisualizerFullscreenButton(!0),this.addMobileFullscreenCloseButton(),setTimeout(()=>{this.refreshMasterPunchcard("css-fullscreen").catch(s=>{console.warn("⚠️ Unable to refresh punchcard after CSS fullscreen:",s)})},100);return}console.warn("⚠️ Fullscreen API not supported on this device")}catch(s){console.warn("⚠️ Unable to enter visualizer fullscreen:",s),this.isMobileDevice()&&(this.masterPunchcardContainer.classList.add("is-fullscreen"),Oi("visualizer-fullscreen"),this.updateVisualizerFullscreenButton(!0),this.addMobileFullscreenCloseButton(),setTimeout(()=>{this.refreshMasterPunchcard("css-fullscreen-fallback").catch(a=>{console.warn("⚠️ Unable to refresh punchcard after CSS fullscreen fallback:",a)})},100))}}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768&&"ontouchstart"in window}addMobileFullscreenCloseButton(){if(this.removeMobileFullscreenCloseButton(),!this.masterPunchcardContainer)return;const e=document.createElement("button");e.id="mobile-fullscreen-close",e.className="mobile-fullscreen-close-btn",e.innerHTML="✕",e.setAttribute("aria-label","Close fullscreen"),e.addEventListener("click",()=>{this.toggleVisualizerFullscreen()}),this.masterPunchcardContainer.appendChild(e)}removeMobileFullscreenCloseButton(){const e=document.getElementById("mobile-fullscreen-close");e&&e.remove()}updateVisualizerFullscreenButton(e){this.visualizerFullscreenBtn&&(this.visualizerFullscreenBtn.classList.toggle("is-active",e),this.visualizerFullscreenBtn.setAttribute("aria-label",e?"Exit visualizer fullscreen":"Enter visualizer fullscreen"))}handleVisualizerFullscreenChange(){const t=this.getCurrentFullscreenElement()===this.masterPunchcardContainer;this.masterPunchcardContainer&&(this.masterPunchcardContainer.classList.toggle("is-fullscreen",t),!t&&this.isMobileDevice()?(Vo("visualizer-fullscreen"),this.removeMobileFullscreenCloseButton()):t&&this.isMobileDevice()&&setTimeout(()=>{this.addMobileFullscreenCloseButton()},100)),this.updateVisualizerFullscreenButton(t),this.refreshMasterPunchcard("fullscreen-change").catch(s=>{console.warn("⚠️ Unable to refresh punchcard after fullscreen change:",s)})}async applyVisualizerToMaster(){var r;console.log(`🎨 Applying visualizer "${this.selectedVisualizer}" to master pattern`);const e=typeof oe.isMasterActive=="function"?oe.isMasterActive():!!oe.masterActive;this.scopeSpectrumObserver=null,this.scopeSpectrumCopyLoop=null,this.stopVisualizerAnimation(),this.teardownExternalVisualizerCanvas(),this.selectedVisualizer!=="pianoroll"&&document.querySelectorAll('canvas[data-processed="true"]').forEach(i=>{i.id!=="master-punchcard-canvas"&&i.remove()});const t=await this.getMasterPatternWithoutVisualizer();let s=t;const a="master-punchcard-canvas";if(this.selectedVisualizer!=="off"){if(await this.prepareCanvasForExternalVisualizer(),(this.selectedVisualizer==="spectrum"||this.selectedVisualizer==="pianoroll")&&await new Promise(l=>setTimeout(l,50)),this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"||this.selectedVisualizer==="spectrum"){oe.setupVisualizerAnalyser(),await new Promise(u=>setTimeout(u,100));const l=a,c=((r=window.strudel)==null?void 0:r.getAnalyserById)||globalThis.getAnalyserById;if(c)try{const u=c(l);u&&u.context===oe.audioContext?console.log(`✅ Verified analyser "${l}" is ready in correct audio context`):console.warn(`⚠️ Analyser "${l}" not ready or in wrong context`)}catch(u){console.warn("⚠️ Could not verify analyser:",u.message)}}const o=document.getElementById(a);if(o){o.style.position="relative",o.style.display="block",o.style.visibility="visible",o.style.opacity="1",o.style.left="0",o.style.top="0",o.style.width="100%",o.style.height="100%",o.id=a;const l=document.getElementById("master-punchcard");if(l&&o.parentNode!==l&&l.appendChild(o),l){const c=l.getBoundingClientRect(),u=window.devicePixelRatio||1,h=Math.max(c.width||320,320),m=Math.max(c.height||200,200);o.width=h*u,o.height=m*u,o.style.width=`${h}px`,o.style.height=`${m}px`,(this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"||this.selectedVisualizer==="spectrum")&&(o.offsetHeight,console.log(`✅ Canvas "${a}" ready for ${this.selectedVisualizer}`))}}else console.error(`❌ Canvas "${a}" not found!`);if((this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"||this.selectedVisualizer==="spectrum")&&(o&&o.id!==a&&(o.id=a),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block")),this.selectedVisualizer==="pianoroll"||this.selectedVisualizer==="spectrum")try{const{getDrawContext:l}=await gs(async()=>{const{getDrawContext:u}=await import("./index-Dx0fBmh0.js");return{getDrawContext:u}},__vite__mapDeps([4,1])),c=l(a,{contextType:"2d"});window.__strudelVisualizerCtx=c,console.log(`✅ Registered canvas "${a}" with getDrawContext for ${this.selectedVisualizer}`)}catch(l){console.warn(`⚠️ Failed to register canvas with getDrawContext for ${this.selectedVisualizer}:`,l)}this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"||this.selectedVisualizer==="punchcard"?s=t:this.selectedVisualizer==="spectrum"?s=`${t}.spectrum({
        id: '${a}',
        thickness: 3,
        speed: 1,
        min: -80,
        max: 0
      })`:this.selectedVisualizer==="pianoroll"&&(s=`${t}.pianoroll({ 
          id: '${a}',
          ctx: (window.__strudelVisualizerCtx || (document.getElementById('master-punchcard-canvas') && document.getElementById('master-punchcard-canvas').getContext && document.getElementById('master-punchcard-canvas').getContext('2d'))),
          cycles: 4,
          playhead: 0.5,
          fill: true,
          fillActive: true,
          stroke: true,
          strokeActive: true,
          autorange: true,
          colorizeInactive: true,
          background: '#05060a'
        })`)}(!s||s.trim()==="")&&(console.warn("⚠️ Pattern with visualizer is empty, reverting to base pattern"),s=t||"silence"),this.selectedVisualizer!=="off"&&this.selectedVisualizer!=="punchcard"&&(this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"?console.log(`✅ Using internal analyser visualizer for ${this.selectedVisualizer}`):new RegExp(`\\.\\s*_?${this.selectedVisualizer}\\s*\\(`).test(s)?console.log(`✅ Visualizer "${this.selectedVisualizer}" found in pattern`):console.error(`❌ Visualizer "${this.selectedVisualizer}" not found in pattern! Pattern:`,s)),await oe.setMasterPatternCode(s),await this.ensureMasterPlaybackAfterVisualizerChange(e),this.selectedVisualizer==="off"?this.cameraEnabled?(this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.startCameraBlendLoop()):this.showMasterPunchcardPlaceholder():this.selectedVisualizer==="scope"?(this.startScopeVisualizerLoop(),this.cameraEnabled):this.selectedVisualizer==="barchart"?(this.startBarchartVisualizerLoop(),this.cameraEnabled):this.selectedVisualizer==="pianoroll"?(this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.hideMasterPunchcardPlaceholder(),this.cameraEnabled&&this.startCameraBlendLoop(),this.watchForExternalVisualizerCanvas("pianoroll")):this.selectedVisualizer==="spectrum"&&(this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.hideMasterPunchcardPlaceholder(),this.cameraEnabled&&this.startCameraBlendLoop(),this.watchForExternalVisualizerCanvas("spectrum")),this.refreshMasterPunchcard(this.selectedVisualizer==="off"?"visualizer-off":"visualizer-applied").catch(o=>{console.warn("⚠️ Unable to refresh punchcard after applying visualizer:",o)})}async ensureMasterPlaybackAfterVisualizerChange(e){var a,r,o,i;if(!e)return;const t=((r=(a=window.strudel)==null?void 0:a.scheduler)==null?void 0:r.started)||!1;if(t||(typeof oe.isMasterActive=="function"?oe.isMasterActive():!!oe.masterActive)){!oe.masterActive&&t&&(oe.masterActive=!0,console.log("🔄 Restored masterActive flag after visualizer change"));return}if((o=window.strudel)!=null&&o.scheduler&&typeof window.strudel.scheduler.start=="function")try{if(console.log("🔄 Restarting scheduler after visualizer change..."),oe.masterGainNode){const l=((i=oe.audioContext)==null?void 0:i.currentTime)||0;oe.masterGainNode.gain.setValueAtTime(oe.masterVolume,l)}await window.strudel.scheduler.start(),oe.masterActive=!0,console.log("✅ Scheduler restarted, playback resumed")}catch(l){if(console.warn("⚠️ Could not restart scheduler, falling back to playMasterPattern:",l),typeof oe.playMasterPattern=="function")try{await oe.playMasterPattern()}catch(c){console.warn("⚠️ Unable to resume master playback after visualizer change:",c)}}else if(typeof oe.playMasterPattern=="function")try{await oe.playMasterPattern()}catch(l){console.warn("⚠️ Unable to resume master playback after visualizer change:",l)}}showMasterPunchcardPlaceholder(){this.masterPunchcardContainer&&(this.masterPunchcardPlaceholder&&this.masterPunchcardPlaceholder.classList.remove("hidden"),this.masterPunchcardCanvas&&this.masterPunchcardCtx&&(this.masterPunchcardCtx.setTransform(1,0,0,1,0,0),this.masterPunchcardCtx.clearRect(0,0,this.masterPunchcardCanvas.width,this.masterPunchcardCanvas.height)))}async refreshMasterPunchcard(e="auto"){if(!this.masterPunchcardContainer)return;if(this.selectedVisualizer==="off"){this.stopVisualizerAnimation(),this.teardownExternalVisualizerCanvas(),this.cameraEnabled?(this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.startCameraBlendLoop()):(this.showMasterPunchcardPlaceholder(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block",this.masterPunchcardCtx&&(this.masterPunchcardCtx.setTransform(1,0,0,1,0,0),this.masterPunchcardCtx.clearRect(0,0,this.masterPunchcardCanvas.width,this.masterPunchcardCanvas.height))));return}const t=oe.getMasterPatternCode();if(!t||t.trim()===""){this.showMasterPunchcardPlaceholder();return}const s=this.shouldUseSpiralVisualizer(t),a=!s&&this.shouldUseScopeVisualizer(t),r=!s&&!a&&this.shouldUseSpectrumVisualizer(t),o=!s&&!a&&!r&&this.shouldUsePitchwheelVisualizer(t),i=!s&&!a&&!r&&!o&&this.shouldUsePianorollVisualizer(t),l=!s&&!a&&!r&&!o&&!i&&this.shouldUseBarchartVisualizer(t);r&&this.selectedVisualizer!=="spectrum"&&(!this.selectedVisualizer||this.selectedVisualizer==="off"||["scope","punchcard","barchart"].includes(this.selectedVisualizer))&&(this.selectedVisualizer="spectrum",this.visualizerSelect&&(this.visualizerSelect.value="spectrum")),i&&this.selectedVisualizer!=="pianoroll"&&(!this.selectedVisualizer||["scope","punchcard","barchart","spectrum"].includes(this.selectedVisualizer))&&(this.selectedVisualizer="pianoroll",this.visualizerSelect&&(this.visualizerSelect.value="pianoroll"));const c=this.selectedVisualizer||"punchcard";if(c==="scope"){await this.prepareCanvasForExternalVisualizer(),this.startScopeVisualizerLoop(),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(c==="barchart"){await this.prepareCanvasForExternalVisualizer(),this.startBarchartVisualizerLoop(),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(c==="spectrum"){await this.prepareCanvasForExternalVisualizer(),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(c==="pianoroll"){await this.prepareCanvasForExternalVisualizer(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(c!=="scope"&&c!=="barchart"&&this.stopVisualizerAnimation(),this.selectedVisualizer==="off"){this.stopVisualizerAnimation(),this.showMasterPunchcardPlaceholder();return}if(a||r||s||o||i||l){(this.selectedVisualizer||"punchcard")==="punchcard"&&a&&this.watchForExternalVisualizerCanvas("scope"),await this.prepareCanvasForExternalVisualizer(),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(this.masterPunchcardIsRendering){this.masterPunchcardPendingRefresh=!0;return}this.masterPunchcardIsRendering=!0;try{const u=this.currentTimeSignatureMetrics||Ni(this.currentTimeSignature||"4/4"),h=await this.computeMasterPunchcardData(t,u);if(!h||h.error){const f=h!=null&&h.error?`Unable to render punchcard: ${h.error}`:"Unable to render punchcard.";console.warn(f,{reason:e,data:h}),this.showMasterPunchcardPlaceholder();return}if(!h.counts||h.counts.length===0){this.showMasterPunchcardPlaceholder();return}if(Math.max(...h.counts)<=0){this.showMasterPunchcardPlaceholder();return}this.renderMasterPunchcard(u,h)}finally{this.masterPunchcardIsRendering=!1,this.masterPunchcardPendingRefresh&&(this.masterPunchcardPendingRefresh=!1,this.refreshMasterPunchcard("queued-refresh").catch(u=>{console.warn("⚠️ Queued punchcard refresh failed:",u)}))}}renderMasterPunchcard(e,t){!this.masterPunchcardContainer||!this.masterPunchcardCanvas||(this.hideMasterPunchcardPlaceholder(),this.drawMasterPunchcardCanvas(e,t))}async prepareCanvasForExternalVisualizer(){if(!this.masterPunchcardContainer||!this.masterPunchcardCanvas){console.warn("⚠️ Canvas elements not found for visualizer");return}const e=this.masterPunchcardCanvas.id;if(console.log(`🎨 Preparing canvas for external visualizer: ${e}`),!document.getElementById(e)){console.error(`❌ Canvas "${e}" not found via getElementById!`);return}console.log(`✅ Canvas "${e}" is accessible via getElementById`),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas.style.position="relative",this.masterPunchcardCanvas.style.left="0",this.masterPunchcardCanvas.style.top="0",this.masterPunchcardCanvas.style.width="100%",this.masterPunchcardCanvas.style.height="100%",this.masterPunchcardCanvas.style.display="block";const s=["scope","barchart","spectrum"];this.masterPunchcardCanvas.style.background=s.includes(this.selectedVisualizer)?"#05060a":"rgba(255, 255, 255, 0.9)";let a;try{const{getDrawContext:r}=await gs(async()=>{const{getDrawContext:o}=await import("./index-Dx0fBmh0.js");return{getDrawContext:o}},__vite__mapDeps([4,1]));a=r(e,{contextType:"2d"}),console.log(`✅ Got draw context via getDrawContext for ${e}`)}catch(r){console.warn("⚠️ getDrawContext failed, falling back to native:",r),a=this.masterPunchcardCanvas.getContext("2d")}if(a&&(this.sizeCanvasToContainer(this.masterPunchcardCanvas,a),window.__strudelVisualizerCtx=a,window.strudel&&window.strudel.controls))try{window.strudel.controls.setCanvas(e),console.log(`✅ Registered canvas "${e}" with Strudel controls`)}catch(r){console.log("ℹ️ Could not register with strudel.controls:",r.message)}}sizeCanvasToContainer(e,t){if(!e||!this.masterPunchcardContainer)return;const s=this.masterPunchcardContainer.getBoundingClientRect(),a=Math.max(s.width||this.masterPunchcardContainer.offsetWidth||320,240),r=Math.max(s.height||this.masterPunchcardContainer.offsetHeight||200,220),o=window.devicePixelRatio||1;e.width=a*o,e.height=r*o,e.style.width="100%",e.style.height="100%",e.style.display="block",e.style.opacity="1",t&&(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),t.setTransform(o,0,0,o,0,0))}ensureVisualizerAnalyser(){return oe?(oe.visualizerAnalyser||typeof oe.setupVisualizerAnalyser=="function"&&oe.setupVisualizerAnalyser(),oe.visualizerAnalyser||null):null}stopVisualizerAnimation(){this.scopeAnimationFrame&&(cancelAnimationFrame(this.scopeAnimationFrame),this.scopeAnimationFrame=null),this.barchartAnimationFrame&&(cancelAnimationFrame(this.barchartAnimationFrame),this.barchartAnimationFrame=null),this.cameraBlendAnimationFrame&&(cancelAnimationFrame(this.cameraBlendAnimationFrame),this.cameraBlendAnimationFrame=null),this.activeVisualizerLoop=null}async requestCameraAccess(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return console.warn("⚠️ Camera API not available in this browser"),this.cameraAvailable=!1,!1;try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:1280},height:{ideal:720}}});this.cameraVideo||(this.cameraVideo=document.createElement("video"),this.cameraVideo.autoplay=!0,this.cameraVideo.playsInline=!0,this.cameraVideo.muted=!0,this.cameraVideo.style.display="none",this.cameraVideo.style.position="absolute",this.cameraVideo.style.visibility="hidden",document.body.appendChild(this.cameraVideo)),this.cameraVideo.srcObject=e,this.cameraStream=e,this.cameraAvailable=!0,this.cameraEnabled=!0,await new Promise(t=>{this.cameraVideo.readyState>=2?t():this.cameraVideo.addEventListener("loadedmetadata",t,{once:!0})});try{await this.cameraVideo.play()}catch(t){console.warn("⚠️ Could not play camera video automatically:",t),setTimeout(async()=>{try{await this.cameraVideo.play()}catch(s){console.warn("⚠️ Retry play() also failed:",s)}},100)}return console.log("✅ Camera access granted"),!0}catch(e){return console.warn("⚠️ Camera access denied or unavailable:",e),this.cameraAvailable=!1,this.cameraEnabled=!1,!1}}stopCamera(){this.cameraStream&&(this.cameraStream.getTracks().forEach(e=>{e.stop()}),this.cameraStream=null),this.cameraVideo&&(this.cameraVideo.srcObject=null,this.cameraVideo.parentNode&&this.cameraVideo.parentNode.removeChild(this.cameraVideo),this.cameraVideo=null),this.cameraEnabled=!1,console.log("📷 Camera stopped")}checkCameraAvailability(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?this.cameraAvailable=!0:(this.cameraAvailable=!1,console.warn("⚠️ Camera API not supported in this browser"))}updateCameraControlsVisibility(){const e=document.getElementById("camera-blend-control"),t=document.getElementById("camera-blend-control-mobile");e&&(this.selectedVisualizer!=="off"?e.style.display="flex":e.style.display="none"),t&&(this.selectedVisualizer!=="off"?t.style.display="block":t.style.display="none")}drawVisualizerMessage(e){const t=this.masterPunchcardCanvas;if(!t)return;let s=this.masterPunchcardCtx;if(!s||typeof s.setTransform!="function"){if(s=t.getContext("2d"),!s||typeof s.setTransform!="function"){console.warn("⚠️ drawVisualizerMessage: Cannot get valid 2D context");return}this.masterPunchcardCtx=s}this.sizeCanvasToContainer(t,s);const a=window.devicePixelRatio||1,r=t.width/a,o=t.height/a;s.fillStyle="rgba(5, 6, 10, 0.92)",s.fillRect(0,0,r,o),s.fillStyle="#94a3b8",s.font='14px "Fira Sans", "Inter", system-ui, sans-serif',s.textAlign="center",s.textBaseline="middle",s.fillText(e,r/2,o/2)}startScopeVisualizerLoop(){this.scopeAnimationFrame&&(cancelAnimationFrame(this.scopeAnimationFrame),this.scopeAnimationFrame=null);const e=this.masterPunchcardCanvas;if(!e){console.warn("⚠️ Scope visualizer: Canvas not available");return}const t=this.ensureVisualizerAnalyser();if(!t){console.warn("⚠️ Scope visualizer: Analyser not available"),this.drawVisualizerMessage("Scope analyser unavailable");return}const s=t.fftSize||2048;(!this.scopeDataArray||this.scopeDataArray.length!==s)&&(this.scopeDataArray=new Uint8Array(s)),this.activeVisualizerLoop="scope",console.log("🎨 Starting scope visualizer loop");const a=()=>{if(this.selectedVisualizer!=="scope"){console.log(`🎨 Scope loop stopping: selectedVisualizer is "${this.selectedVisualizer}", expected "scope"`),this.stopVisualizerAnimation();return}let r=this.masterPunchcardCtx;if(!r||typeof r.setTransform!="function"){if(r=this.masterPunchcardCanvas.getContext("2d"),!r||typeof r.setTransform!="function"){console.warn("⚠️ Scope visualizer: Cannot get valid 2D context"),this.stopVisualizerAnimation();return}this.masterPunchcardCtx=r}this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas.style.display="block",this.sizeCanvasToContainer(e,r),t.getByteTimeDomainData(this.scopeDataArray);const o=window.devicePixelRatio||1,i=e.width/o,l=e.height/o;r.fillStyle="rgba(5, 6, 10, 0.92)",r.fillRect(0,0,i,l);const c=l/2;r.strokeStyle="#38bdf8",r.lineWidth=2,r.beginPath();const u=i/this.scopeDataArray.length;let h=0;for(let m=0;m<this.scopeDataArray.length;m++){const v=this.scopeDataArray[m]/128*l/2;m===0?r.moveTo(h,v):r.lineTo(h,v),h+=u}if(r.lineTo(i,c),r.stroke(),r.strokeStyle="rgba(14, 165, 233, 0.4)",r.beginPath(),r.moveTo(0,c),r.lineTo(i,c),r.stroke(),this.cameraEnabled&&this.cameraVideo&&this.cameraVideo.readyState>=2&&this.cameraVideo.videoWidth>0&&this.cameraVideo.videoHeight>0){const m=r.globalAlpha;r.globalAlpha=this.cameraBlendValue;try{r.drawImage(this.cameraVideo,0,0,i,l)}catch(f){console.warn("⚠️ Error drawing camera frame:",f)}r.globalAlpha=m}this.scopeAnimationFrame=requestAnimationFrame(a)};a()}startBarchartVisualizerLoop(){var i;this.barchartAnimationFrame&&(cancelAnimationFrame(this.barchartAnimationFrame),this.barchartAnimationFrame=null);const e=this.masterPunchcardCanvas;if(!e){console.warn("⚠️ Bar chart visualizer: Canvas not available");return}const t=this.ensureVisualizerAnalyser();if(!t){console.warn("⚠️ Bar chart visualizer: Analyser not available"),this.drawVisualizerMessage("Spectrum analyser unavailable");return}const s=t.frequencyBinCount||1024;(!this.spectrumDataArray||this.spectrumDataArray.length!==s)&&(this.spectrumDataArray=new Uint8Array(s));const r=(((i=t.context)==null?void 0:i.sampleRate)||44100)/2;this.activeVisualizerLoop="barchart",console.log("🎨 Starting bar chart visualizer loop");const o=()=>{if(this.selectedVisualizer!=="barchart"){console.log(`🎨 Bar chart loop stopping: selectedVisualizer is "${this.selectedVisualizer}", expected "barchart"`),this.stopVisualizerAnimation();return}let l=this.masterPunchcardCtx;if(!l||typeof l.setTransform!="function"){if(l=this.masterPunchcardCanvas.getContext("2d"),!l||typeof l.setTransform!="function"){console.warn("⚠️ Bar chart visualizer: Cannot get valid 2D context"),this.stopVisualizerAnimation();return}this.masterPunchcardCtx=l}this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas.style.display="block",this.sizeCanvasToContainer(e,l),t.getByteFrequencyData(this.spectrumDataArray);const c=window.devicePixelRatio||1,u=e.width/c,h=e.height/c;l.fillStyle="rgba(5, 6, 10, 0.92)",l.fillRect(0,0,u,h);const m=Math.min(200,Math.floor(u/2)),f=[];for(let O=0;O<this.spectrumDataArray.length;O++){const k=O/this.spectrumDataArray.length*r;if(k>=20&&k<=2e4){const M=Hk(k),E=this.spectrumDataArray[O]/255;f.push({position:M,value:E,frequency:k})}}f.sort((O,k)=>O.position-k.position);const v=u/m;for(let O=0;O<m;O++){const k=O/m,M=1/m,E=k<.3?M*4:k<.6?M*2:M,I=f.filter(ce=>Math.abs(ce.position-k)<E);let D=I.length>0?Math.max(...I.map(ce=>ce.value)):0;if(D===0&&f.length>0){let ce=0,U=1/0;for(const ue of f){const W=Math.abs(ue.position-k);if(W<U)U=W,ce=ue.value;else if(W>U)break}D=ce}const F=Math.max(D*h,2),_=k*u,$=h-F,Z=l.createLinearGradient(_,$,_,h);Z.addColorStop(0,"rgba(56, 189, 248, 0.95)"),Z.addColorStop(1,"rgba(14, 116, 144, 0.75)"),l.fillStyle=Z,l.fillRect(_,$,v+1,F)}if(this.cameraEnabled&&this.cameraVideo&&this.cameraVideo.readyState>=2&&this.cameraVideo.videoWidth>0&&this.cameraVideo.videoHeight>0){const O=l.globalAlpha;l.globalAlpha=this.cameraBlendValue;try{l.drawImage(this.cameraVideo,0,0,u,h)}catch(k){console.warn("⚠️ Error drawing camera frame:",k)}l.globalAlpha=O}this.barchartAnimationFrame=requestAnimationFrame(o)};o()}startCameraBlendLoop(){this.cameraBlendAnimationFrame&&(cancelAnimationFrame(this.cameraBlendAnimationFrame),this.cameraBlendAnimationFrame=null);const e=this.masterPunchcardCanvas;if(!e)return;const t=()=>{if(!this.cameraEnabled){this.cameraBlendAnimationFrame=null;return}if(!(this.selectedVisualizer==="spectrum"||this.selectedVisualizer==="pianoroll"||this.selectedVisualizer==="off")){this.cameraBlendAnimationFrame=null;return}if(!this.cameraVideo||this.cameraVideo.readyState<2){this.cameraBlendAnimationFrame=requestAnimationFrame(t);return}let a=this.masterPunchcardCtx;if(!a||typeof a.setTransform!="function"){if(a=e.getContext("2d"),!a||typeof a.setTransform!="function"){console.warn("⚠️ Camera blend loop: Cannot get valid 2D context"),this.cameraBlendAnimationFrame=requestAnimationFrame(t);return}this.masterPunchcardCtx=a}try{this.sizeCanvasToContainer(e,a);const r=window.devicePixelRatio||1,o=e.width/r,i=e.height/r,l=this.selectedVisualizer==="off"?1:this.cameraBlendValue;if(this.selectedVisualizer==="off"&&(a.fillStyle="rgba(5, 6, 10, 0.92)",a.fillRect(0,0,o,i)),this.cameraVideo.videoWidth>0&&this.cameraVideo.videoHeight>0){const c=a.globalAlpha;a.globalAlpha=l,a.drawImage(this.cameraVideo,0,0,o,i),a.globalAlpha=c}}catch(r){console.warn("⚠️ Error drawing camera frame in blend loop:",r)}this.cameraBlendAnimationFrame=requestAnimationFrame(t)};t()}teardownExternalVisualizerCanvas(){this.externalVisualizerObserver&&(this.externalVisualizerObserver.disconnect(),this.externalVisualizerObserver=null),this.externalVisualizerCanvas&&this.externalVisualizerCanvas.parentNode&&this.externalVisualizerCanvas.remove(),this.externalVisualizerCanvas=null,this.externalVisualizerType=null,document.querySelectorAll("canvas").forEach(t=>{if(!(t===this.masterPunchcardCanvas||t.id==="master-punchcard-canvas")&&this.masterPunchcardContainer&&this.masterPunchcardContainer.contains(t)){const s=(t.id||"").toLowerCase(),a=(t.className||"").toLowerCase();(s.includes("spectrum")||s.includes("scope")||a.includes("spectrum")||a.includes("scope")||t.dataset.spectrum!==void 0||t.dataset.scope!==void 0)&&(console.log("🧹 Removing external visualizer canvas:",t.id||t.className),t.remove())}}),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block")}attachExternalVisualizerCanvas(e){return!e||!this.masterPunchcardContainer?!1:(this.masterPunchcardCanvas.style.display="none",this.hideMasterPunchcardPlaceholder(),this.masterPunchcardContainer.style.position===""&&(this.masterPunchcardContainer.style.position="relative"),e.dataset.visualizerAttached="true",e.style.position="relative",e.style.left="0",e.style.top="0",e.style.pointerEvents="auto",this.sizeCanvasToContainer(e,e.getContext("2d")),this.masterPunchcardContainer.appendChild(e),this.externalVisualizerCanvas=e,!0)}watchForExternalVisualizerCanvas(e){const t=()=>{const s=this.findExternalVisualizerCanvasCandidate(e);return s?this.attachExternalVisualizerCanvas(s):!1};t()||(this.externalVisualizerObserver=new MutationObserver(()=>{t()&&this.externalVisualizerObserver&&(this.externalVisualizerObserver.disconnect(),this.externalVisualizerObserver=null)}),this.externalVisualizerObserver.observe(document.body,{childList:!0,subtree:!0}))}findExternalVisualizerCanvasCandidate(e){const t=Array.from(document.querySelectorAll("canvas"));for(const s of t)if(s!==this.masterPunchcardCanvas&&s.dataset.visualizerAttached!=="true"&&(e==="pianoroll"&&this.isPianorollCanvas(s)||e==="scope"&&this.isScopeCanvas(s)||e==="spectrum"&&this.isSpectrumCanvas(s)))return s;return null}isPianorollCanvas(e){if(!e)return!1;if(e.dataset.pianoroll!==void 0)return!0;const t=e.className||"";if(/pianoroll/i.test(t))return!0;const s=e.getBoundingClientRect();return s.width===0||s.height===0?!1:s.width>window.innerWidth*.6&&s.height>window.innerHeight*.4}isScopeCanvas(e){if(!e)return!1;const t=(e.id||"").toLowerCase(),s=(e.className||"").toLowerCase();if(t.includes("scope")||s.includes("scope")||e.dataset.scope!==void 0)return!0;const a=e.getBoundingClientRect();return a.width>window.innerWidth*.5&&a.height<260}isSpectrumCanvas(e){if(!e)return!1;const t=(e.id||"").toLowerCase(),s=(e.className||"").toLowerCase();if(t.includes("spectrum")||s.includes("spectrum")||e.dataset.spectrum!==void 0)return!0;const a=e.getBoundingClientRect();return a.width>window.innerWidth*.5&&a.height<400}hideMasterPunchcardPlaceholder(){this.masterPunchcardPlaceholder&&this.masterPunchcardPlaceholder.classList.add("hidden")}handleChaospadMouseMove(e){if(!this.masterPunchcardCanvas||!this.chaospadEnabled){console.log("🎛️ Chaospad: Skipping - canvas or enabled check failed",{hasCanvas:!!this.masterPunchcardCanvas,enabled:this.chaospadEnabled});return}if(this.chaospadOrientationActive&&this.isMobileDevice())return;const t=e.touches&&e.touches.length?e.touches[0]:e;if(typeof t.clientX!="number"||typeof t.clientY!="number")return;const s=this.masterPunchcardCanvas.getBoundingClientRect(),a=t.clientX-s.left,r=s.bottom-t.clientY,o=s.width,i=s.height;if(o===0||i===0){console.log("⚠️ Chaospad: Canvas not sized yet");return}const l=Math.max(0,Math.min(1,a/o)),c=Math.max(0,Math.min(1,r/i));this.applyChaospadInputFromPercentages(l,c,"mouse")}applyChaospadInputFromPercentages(e=0,t=0,s="mouse"){if(!this.chaospadEnabled)return;const a=Math.max(0,Math.min(1,Number.isFinite(e)?e:0)),r=Math.max(0,Math.min(1,Number.isFinite(t)?t:0)),o=this.chaospadSettings.xAxis||{effect:"cutoff",min:80,max:8e3},i=this.chaospadSettings.yAxis||{effect:"resonance",min:.1,max:5},l=o.min+(o.max-o.min)*a,c=Date.now();switch(o.effect){case"cutoff":{const h=Math.round(l);(this.currentCutoffValue===null||Math.abs(this.currentCutoffValue-h)>50||this.lastCutoffUpdate&&c-this.lastCutoffUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(a*100).toFixed(1)}% → ${h} Hz`),this.currentCutoffValue=h,this.lastCutoffUpdate=c,oe.setMasterFilterFrequency(h));break}case"resonance":{const h=Math.round(l*10)/10;(this.currentResonanceValue===null||Math.abs(this.currentResonanceValue-h)>.2||this.lastResonanceUpdate&&c-this.lastResonanceUpdate>120)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(a*100).toFixed(1)}% → Q ${h}`),this.currentResonanceValue=h,this.lastResonanceUpdate=c,oe.setMasterFilterResonance(h));break}case"volume":{const h=Math.max(0,Math.min(1,l));(this.currentVolumeValue===null||Math.abs(this.currentVolumeValue-h)>.02||this.lastVolumeUpdate&&c-this.lastVolumeUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(a*100).toFixed(1)}% → Volume ${(h*100).toFixed(1)}%`),this.currentVolumeValue=h,this.lastVolumeUpdate=c,oe.masterVolume=h,oe.masterGainNode&&(oe.masterGainNode.gain.value=h));break}case"pan":{const h=Math.max(-1,Math.min(1,l));(this.currentPanValue===null||Math.abs(this.currentPanValue-h)>.05||this.lastPanUpdate&&c-this.lastPanUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(a*100).toFixed(1)}% → Pan ${h.toFixed(2)}`),this.currentPanValue=h,this.lastPanUpdate=c,oe.masterPan=h,oe.masterPanNode&&(oe.masterPanNode.pan.value=h));break}case"delayAmount":{const h=Math.max(0,Math.min(1,l));(this.currentDelayAmountValue===null||Math.abs(this.currentDelayAmountValue-h)>.02||this.lastDelayAmountUpdate&&c-this.lastDelayAmountUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(a*100).toFixed(1)}% → Delay Amount ${(h*100).toFixed(1)}%`),this.currentDelayAmountValue=h,this.lastDelayAmountUpdate=c,oe.setMasterDelayAmount(h));break}case"delayFeedback":{const h=Math.max(0,Math.min(1,l));(this.currentDelayFeedbackValue===null||Math.abs(this.currentDelayFeedbackValue-h)>.02||this.lastDelayFeedbackUpdate&&c-this.lastDelayFeedbackUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(a*100).toFixed(1)}% → Delay Feedback ${(h*100).toFixed(1)}%`),this.currentDelayFeedbackValue=h,this.lastDelayFeedbackUpdate=c,oe.setMasterDelayFeedback(h));break}case"reverbAmount":{const h=Math.max(0,Math.min(5,l));(this.currentReverbAmountValue===null||Math.abs(this.currentReverbAmountValue-h)>.1||this.lastReverbAmountUpdate&&c-this.lastReverbAmountUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(a*100).toFixed(1)}% → Reverb Amount ${h.toFixed(2)}`),this.currentReverbAmountValue=h,this.lastReverbAmountUpdate=c,oe.setMasterReverbAmount(h));break}case"reverbRoomSize":{const h=Math.max(0,Math.min(4,l));(this.currentReverbRoomSizeValue===null||Math.abs(this.currentReverbRoomSizeValue-h)>.1||this.lastReverbRoomSizeUpdate&&c-this.lastReverbRoomSizeUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(a*100).toFixed(1)}% → Reverb Room Size ${h.toFixed(2)}`),this.currentReverbRoomSizeValue=h,this.lastReverbRoomSizeUpdate=c,oe.setMasterReverbRoomSize(h));break}}const u=i.min+(i.max-i.min)*r;switch(i.effect){case"cutoff":{const h=Math.round(u);(this.currentCutoffValue===null||Math.abs(this.currentCutoffValue-h)>50||this.lastCutoffUpdate&&c-this.lastCutoffUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(r*100).toFixed(1)}% → ${h} Hz`),this.currentCutoffValue=h,this.lastCutoffUpdate=c,oe.setMasterFilterFrequency(h));break}case"resonance":{let h=Math.round(u*10)/10;this.currentCutoffValue!==null&&this.currentCutoffValue<250&&(h=Math.min(h,2.5)),(this.currentResonanceValue===null||Math.abs(this.currentResonanceValue-h)>.2||this.lastResonanceUpdate&&c-this.lastResonanceUpdate>120)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(r*100).toFixed(1)}% → Q ${h}`),this.currentResonanceValue=h,this.lastResonanceUpdate=c,oe.setMasterFilterResonance(h));break}case"volume":{const h=Math.max(0,Math.min(1,u));(this.currentVolumeValue===null||Math.abs(this.currentVolumeValue-h)>.02||this.lastVolumeUpdate&&c-this.lastVolumeUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(r*100).toFixed(1)}% → Volume ${(h*100).toFixed(1)}%`),this.currentVolumeValue=h,this.lastVolumeUpdate=c,oe.masterVolume=h,oe.masterGainNode&&(oe.masterGainNode.gain.value=h));break}case"pan":{const h=Math.max(-1,Math.min(1,u));(this.currentPanValue===null||Math.abs(this.currentPanValue-h)>.05||this.lastPanUpdate&&c-this.lastPanUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(r*100).toFixed(1)}% → Pan ${h.toFixed(2)}`),this.currentPanValue=h,this.lastPanUpdate=c,oe.masterPan=h,oe.masterPanNode&&(oe.masterPanNode.pan.value=h));break}case"delayAmount":{const h=Math.max(0,Math.min(1,u));(this.currentDelayAmountValue===null||Math.abs(this.currentDelayAmountValue-h)>.02||this.lastDelayAmountUpdate&&c-this.lastDelayAmountUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(r*100).toFixed(1)}% → Delay Amount ${(h*100).toFixed(1)}%`),this.currentDelayAmountValue=h,this.lastDelayAmountUpdate=c,oe.setMasterDelayAmount(h));break}case"delayFeedback":{const h=Math.max(0,Math.min(1,u));(this.currentDelayFeedbackValue===null||Math.abs(this.currentDelayFeedbackValue-h)>.02||this.lastDelayFeedbackUpdate&&c-this.lastDelayFeedbackUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(r*100).toFixed(1)}% → Delay Feedback ${(h*100).toFixed(1)}%`),this.currentDelayFeedbackValue=h,this.lastDelayFeedbackUpdate=c,oe.setMasterDelayFeedback(h));break}case"reverbAmount":{const h=Math.max(0,Math.min(5,u));(this.currentReverbAmountValue===null||Math.abs(this.currentReverbAmountValue-h)>.1||this.lastReverbAmountUpdate&&c-this.lastReverbAmountUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(r*100).toFixed(1)}% → Reverb Amount ${h.toFixed(2)}`),this.currentReverbAmountValue=h,this.lastReverbAmountUpdate=c,oe.setMasterReverbAmount(h));break}case"reverbRoomSize":{const h=Math.max(0,Math.min(4,u));(this.currentReverbRoomSizeValue===null||Math.abs(this.currentReverbRoomSizeValue-h)>.1||this.lastReverbRoomSizeUpdate&&c-this.lastReverbRoomSizeUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(r*100).toFixed(1)}% → Reverb Room Size ${h.toFixed(2)}`),this.currentReverbRoomSizeValue=h,this.lastReverbRoomSizeUpdate=c,oe.setMasterReverbRoomSize(h));break}}this.updateChaospadVirtualGravity(a,r,s)}updateChaospadVirtualGravity(e=.5,t=.5,s="mouse"){const a=Math.max(0,Math.min(1,Number.isFinite(e)?e:.5)),r=Math.max(0,Math.min(1,Number.isFinite(t)?t:.5)),o=parseFloat((a*2-1).toFixed(4)),i=parseFloat((r*2-1).toFixed(4));this.chaospadVirtualGravity={x:o,y:i,source:s},typeof window<"u"&&(window.gravityX=o,window.gravityY=i,window.dispatchEvent(new CustomEvent("chaospad-gravitychange",{detail:{gravityX:o,gravityY:i,source:s}}))),this.syncTiltSlidersFromGravity(s)}supportsChaospadOrientation(){return typeof window<"u"&&typeof window.DeviceOrientationEvent<"u"}async updateChaospadInputMode(){if(!this.chaospadEnabled){this.disableChaospadOrientationControl();return}this.isMobileDevice()&&this.supportsChaospadOrientation()?await this.enableChaospadOrientationControl():this.disableChaospadOrientationControl()}async enableChaospadOrientationControl(){if(!(!this.supportsChaospadOrientation()||this.chaospadOrientationActive)){if(typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function"){if(this.chaospadOrientationPermission!=="granted")try{const e=await DeviceOrientationEvent.requestPermission();this.chaospadOrientationPermission=e}catch(e){this.chaospadOrientationPermission="denied",console.warn("⚠️ Chaospad: Device orientation permission request failed:",(e==null?void 0:e.message)||e);return}if(this.chaospadOrientationPermission!=="granted"){console.warn("⚠️ Chaospad: Device orientation permission not granted by the user");return}}window.addEventListener("deviceorientation",this.handleChaospadOrientation,{passive:!0}),this.chaospadOrientationActive=!0,console.log("🎛️ Chaospad: Device orientation control enabled")}}disableChaospadOrientationControl(){this.chaospadOrientationActive&&(window.removeEventListener("deviceorientation",this.handleChaospadOrientation),this.chaospadOrientationActive=!1,console.log("🎛️ Chaospad: Device orientation control disabled"))}handleChaospadOrientation(e){if(!this.chaospadEnabled||!e)return;const t=(l,c,u)=>Math.max(c,Math.min(u,l)),s=typeof e.gamma=="number"?t(e.gamma,-60,60):null,a=typeof e.beta=="number"?t(e.beta,-60,60):null;if(s===null&&a===null)return;const r=s===null?.5:(s+60)/120,i=1-(a===null?.5:(a+60)/120);this.applyChaospadInputFromPercentages(r,i,"orientation")}showChaospadMobileNotification(){const e=document.getElementById("chaospad-mobile-notification");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),setTimeout(()=>{e.hidden=!0,e.setAttribute("aria-hidden","true")},3e3))}updateChaospadDefaultsFromCurrent(){this.chaospadDefaults.cutoff=oe.masterFilterFrequency||this.chaospadDefaults.cutoff,this.chaospadDefaults.resonance=oe.masterFilterResonance||this.chaospadDefaults.resonance,this.chaospadDefaults.volume=oe.masterVolume||this.chaospadDefaults.volume,this.chaospadDefaults.pan=oe.masterPan||this.chaospadDefaults.pan,this.chaospadDefaults.delayAmount=oe.masterDelayAmount||this.chaospadDefaults.delayAmount,this.chaospadDefaults.delayFeedback=oe.masterDelayFeedback||this.chaospadDefaults.delayFeedback,this.chaospadDefaults.reverbAmount=oe.masterReverbAmount||this.chaospadDefaults.reverbAmount,this.chaospadDefaults.reverbRoomSize=oe.masterReverbRoomSize||this.chaospadDefaults.reverbRoomSize}resetChaospadToDefaults(e=!1){if(!this.chaospadEnabled)return;this.currentCutoffValue=this.chaospadDefaults.cutoff,this.currentResonanceValue=this.chaospadDefaults.resonance,oe.setMasterFilterFrequency(this.currentCutoffValue,e),oe.setMasterFilterResonance(this.currentResonanceValue,e);const{minFrequency:t,maxFrequency:s,minResonance:a,maxResonance:r}=this.chaospadSettings,o=(this.currentCutoffValue-t)/(s-t||1),i=(this.currentResonanceValue-a)/(r-a||1);this.updateChaospadVirtualGravity(Math.max(0,Math.min(1,o)),Math.max(0,Math.min(1,i)),"reset")}restoreChaospadDefaults(){const e=this.chaospadSettings.xAxis||{effect:"cutoff"},t=this.chaospadSettings.yAxis||{effect:"resonance"};switch(e.effect){case"cutoff":oe.setMasterFilterFrequency(this.chaospadDefaults.cutoff,!0),this.currentCutoffValue=this.chaospadDefaults.cutoff;break;case"resonance":oe.setMasterFilterResonance(this.chaospadDefaults.resonance,!0),this.currentResonanceValue=this.chaospadDefaults.resonance;break;case"volume":oe.masterVolume=this.chaospadDefaults.volume,oe.masterGainNode&&(oe.masterGainNode.gain.value=this.chaospadDefaults.volume),this.currentVolumeValue=this.chaospadDefaults.volume;break;case"pan":oe.masterPan=this.chaospadDefaults.pan,oe.masterPanNode&&(oe.masterPanNode.pan.value=this.chaospadDefaults.pan),this.currentPanValue=this.chaospadDefaults.pan;break;case"delayAmount":oe.setMasterDelayAmount(this.chaospadDefaults.delayAmount),this.currentDelayAmountValue=this.chaospadDefaults.delayAmount;break;case"delayFeedback":oe.setMasterDelayFeedback(this.chaospadDefaults.delayFeedback),this.currentDelayFeedbackValue=this.chaospadDefaults.delayFeedback;break;case"reverbAmount":oe.setMasterReverbAmount(this.chaospadDefaults.reverbAmount),this.currentReverbAmountValue=this.chaospadDefaults.reverbAmount;break;case"reverbRoomSize":oe.setMasterReverbRoomSize(this.chaospadDefaults.reverbRoomSize),this.currentReverbRoomSizeValue=this.chaospadDefaults.reverbRoomSize;break}switch(t.effect){case"cutoff":oe.setMasterFilterFrequency(this.chaospadDefaults.cutoff,!0),this.currentCutoffValue=this.chaospadDefaults.cutoff;break;case"resonance":oe.setMasterFilterResonance(this.chaospadDefaults.resonance,!0),this.currentResonanceValue=this.chaospadDefaults.resonance;break;case"volume":oe.masterVolume=this.chaospadDefaults.volume,oe.masterGainNode&&(oe.masterGainNode.gain.value=this.chaospadDefaults.volume),this.currentVolumeValue=this.chaospadDefaults.volume;break;case"pan":oe.masterPan=this.chaospadDefaults.pan,oe.masterPanNode&&(oe.masterPanNode.pan.value=this.chaospadDefaults.pan),this.currentPanValue=this.chaospadDefaults.pan;break;case"delayAmount":oe.setMasterDelayAmount(this.chaospadDefaults.delayAmount),this.currentDelayAmountValue=this.chaospadDefaults.delayAmount;break;case"delayFeedback":oe.setMasterDelayFeedback(this.chaospadDefaults.delayFeedback),this.currentDelayFeedbackValue=this.chaospadDefaults.delayFeedback;break;case"reverbAmount":oe.setMasterReverbAmount(this.chaospadDefaults.reverbAmount),this.currentReverbAmountValue=this.chaospadDefaults.reverbAmount;break;case"reverbRoomSize":oe.setMasterReverbRoomSize(this.chaospadDefaults.reverbRoomSize),this.currentReverbRoomSizeValue=this.chaospadDefaults.reverbRoomSize;break}switch(t.effect){case"cutoff":oe.setMasterFilterFrequency(this.chaospadDefaults.cutoff,!0),this.currentCutoffValue=this.chaospadDefaults.cutoff;break;case"resonance":oe.setMasterFilterResonance(this.chaospadDefaults.resonance,!0),this.currentResonanceValue=this.chaospadDefaults.resonance;break;case"volume":oe.masterVolume=this.chaospadDefaults.volume,oe.masterGainNode&&(oe.masterGainNode.gain.value=this.chaospadDefaults.volume),this.currentVolumeValue=this.chaospadDefaults.volume;break;case"pan":oe.masterPan=this.chaospadDefaults.pan,oe.masterPanNode&&(oe.masterPanNode.pan.value=this.chaospadDefaults.pan),this.currentPanValue=this.chaospadDefaults.pan;break;case"delayAmount":oe.setMasterDelayAmount(this.chaospadDefaults.delayAmount),this.currentDelayAmountValue=this.chaospadDefaults.delayAmount;break;case"delayFeedback":oe.setMasterDelayFeedback(this.chaospadDefaults.delayFeedback),this.currentDelayFeedbackValue=this.chaospadDefaults.delayFeedback;break;case"reverbAmount":oe.setMasterReverbAmount(this.chaospadDefaults.reverbAmount),this.currentReverbAmountValue=this.chaospadDefaults.reverbAmount;break;case"reverbRoomSize":oe.setMasterReverbRoomSize(this.chaospadDefaults.reverbRoomSize),this.currentReverbRoomSizeValue=this.chaospadDefaults.reverbRoomSize;break}this.updateChaospadVirtualGravity(.5,.5,"restore"),console.log("🎛️ Chaospad: Restored defaults",this.chaospadDefaults)}async getMasterPatternWithoutVisualizer(){let e=oe.getMasterPatternCode();if(!e||e.trim()===""){if(oe.trackedPatterns&&oe.trackedPatterns.size>0&&(console.log(`🔄 Master pattern empty; rebuilding from ${oe.trackedPatterns.size} tracked pattern(s)`),oe.updateMasterPattern(new Set,new Set),e=oe.getMasterPatternCode()),!e||e.trim()===""){const t=Qn("master-pattern").trim();t&&(console.log("📝 Falling back to master editor contents"),e=t)}(!e||e.trim()==="")&&(console.warn("⚠️ No master pattern available; using silence"),e="silence")}return e=e.replace(/\/\/.*$/gm,""),e=e.replace(/\/\*[\s\S]*?\*\//g,t=>/\/\*\s*Channel\s+\d+\s*\*\//i.test(t)?t:""),e=e.replace(/\n\s*\n/g,`
`).trim(),this.stripVisualizerMethods(e)}stripVisualizerMethods(e){if(!e)return e;const t=(r,o)=>{let i=1;for(let l=o+1;l<r.length;l++)if(r[l]==="(")i++;else if(r[l]===")"&&(i--,i===0))return l;return-1},s=["scope","tscope","fscope","spectrum","visual","pianoroll","barchart"];let a=e;return s.forEach(r=>{const o=new RegExp(`\\.\\s*_?${r}\\s*\\(`,"gi");let i;for(;(i=o.exec(a))!==null;){const l=i.index,c=i.index+i[0].length-1,u=t(a,c);if(u!==-1)a=a.substring(0,l)+a.substring(u+1),o.lastIndex=0;else break}}),a.trim().replace(/\.\s*$/,"").replace(/\.\.+/g,".").trim()}shouldUseSpiralVisualizer(e){return e?/\.\s*_?spiral\s*\(/i.test(e):!1}shouldUseScopeVisualizer(e){return e?/\.\s*_?(?:t?scope)\s*\(/i.test(e):!1}shouldUseSpectrumVisualizer(e){return e?/\.\s*_?spectrum\s*\(/i.test(e):!1}shouldUsePitchwheelVisualizer(e){return e?/\.\s*_?pitchwheel\s*\(/i.test(e):!1}shouldUsePianorollVisualizer(e){return e?/\.\s*_?pianoroll\s*\(/i.test(e):!1}shouldUseBarchartVisualizer(e){return e?/\.\s*_?barchart\s*\(/i.test(e):!1}extractSpiralOptions(e){if(!e)return{};const t=e.match(/\.\s*_?spiral\s*\(\s*\{([^}]*)\}\s*\)/i);if(!t)return{};const s={};return t[1].split(",").forEach(r=>{const[o,i]=r.split(":");if(!o||!i)return;const l=o.trim(),c=i.trim(),u=Number(c.replace(/[^0-9.+-eE]/g,""));Number.isNaN(u)?/true|false/i.test(c)?s[l]=/^true$/i.test(c):s[l]=c.replace(/['"]/g,""):s[l]=u}),s}async getMasterPunchcardContext(){if(!this.masterPunchcardCanvas)return null;if(!this.masterPunchcardCtx)try{const{getDrawContext:e}=await gs(async()=>{const{getDrawContext:s}=await import("./index-Dx0fBmh0.js");return{getDrawContext:s}},__vite__mapDeps([4,1])),t=e(this.masterPunchcardCanvas.id,{contextType:"2d"});t&&typeof t.setTransform=="function"?this.masterPunchcardCtx=t:t&&t.canvas?this.masterPunchcardCtx=t.canvas.getContext("2d"):this.masterPunchcardCtx=this.masterPunchcardCanvas.getContext("2d")}catch(e){console.warn("⚠️ Falling back to native canvas context:",e),this.masterPunchcardCtx=this.masterPunchcardCanvas.getContext("2d")}return this.masterPunchcardCtx&&typeof this.masterPunchcardCtx.setTransform!="function"&&(console.warn("⚠️ Context from getDrawContext does not have setTransform, using native context"),this.masterPunchcardCtx=this.masterPunchcardCanvas.getContext("2d")),this.masterPunchcardCtx}drawMasterPunchcardCanvas(e,t){const s=this.masterPunchcardCanvas,a=this.getMasterPunchcardContext();if(!s||!a)return;const r=this.masterPunchcardContainer.getBoundingClientRect(),o=Math.max(r.width||this.masterPunchcardContainer.offsetWidth||600,240),i=Math.max(r.height||this.masterPunchcardContainer.offsetHeight||200,200),l=window.devicePixelRatio||1;(s.width!==o*l||s.height!==i*l)&&(s.width=o*l,s.height=i*l,s.style.width=`${o}px`,s.style.height=`${i}px`),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,s.width,s.height),a.save(),a.setTransform(l,0,0,l,0,0);const c=16,u=o-c*2,h=i-c*3,m=c,f=i-c*1.5,v=a.createLinearGradient(0,0,o,i);v.addColorStop(0,"rgba(102, 126, 234, 0.06)"),v.addColorStop(1,"rgba(118, 75, 162, 0.08)"),a.fillStyle=v,a.fillRect(0,0,o,i);const{counts:O,hits:k}=t,{totalSteps:M,stepsPerBeat:E}=e;O.length!==M&&console.warn("⚠️ Punchcard data length mismatch",{expected:M,received:O.length});const I=Math.max(...O,1e-4),D=u/M;a.strokeStyle="rgba(102, 126, 234, 0.25)",a.lineWidth=1,a.beginPath();for(let F=0;F<=M;F+=E){const _=m+F*D;a.moveTo(_,f),a.lineTo(_,f-h)}a.stroke(),O.forEach((F,_)=>{const $=Math.max(F/I,0),Z=h*$,ce=m+_*D,U=f-Z;if(Z<=2){a.fillStyle="rgba(148, 163, 184, 0.35)",a.fillRect(ce+D*.3,f-3,D*.4,3);return}const ue=a.createLinearGradient(ce,U,ce,f);ue.addColorStop(0,"rgba(102, 126, 234, 0.9)"),ue.addColorStop(1,"rgba(118, 75, 162, 0.85)"),a.fillStyle=ue;const W=ce+D*.2,de=D*.6,be=Math.min(D*.3,8);typeof a.roundRect=="function"?(a.beginPath(),a.roundRect(W,U,de,Z,be),a.fill()):a.fillRect(W,U,de,Z);const ke=k==null?void 0:k[_];if(ke&&ke.length){a.fillStyle="rgba(26, 32, 44, 0.75)",a.font='10px "Fira Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',a.textAlign="center",a.textBaseline="bottom";const Ce=ke.slice(0,2).join(" • ");a.fillText(Ce,ce+D/2,U-4)}}),a.strokeStyle="rgba(79, 70, 229, 0.55)",a.lineWidth=1.5,a.beginPath(),a.moveTo(m,f),a.lineTo(m+u,f),a.stroke(),a.restore()}renderMasterSpiral(e,t,s={}){if(!this.masterPunchcardContainer||!this.masterPunchcardCanvas)return;const a=t.events||[];if(!a.length){this.showMasterPunchcardPlaceholder();return}this.hideMasterPunchcardPlaceholder(),this.drawMasterSpiralCanvas(e,a,s)}drawMasterSpiralCanvas(e,t,s={}){const a=this.masterPunchcardCanvas,r=this.getMasterPunchcardContext();if(!a||!r)return;const o=this.masterPunchcardContainer.getBoundingClientRect(),i=Math.max(o.width||this.masterPunchcardContainer.offsetWidth||320,240),l=Math.max(o.height||this.masterPunchcardContainer.offsetHeight||240,220),c=window.devicePixelRatio||1;(a.width!==i*c||a.height!==l*c)&&(a.width=i*c,a.height=l*c,a.style.width=`${i}px`,a.style.height=`${l}px`),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,a.width,a.height),r.save(),r.setTransform(c,0,0,c,0,0);const u=Number.isFinite(s.padding)?s.padding:32,h=Number.isFinite(s.inset)?s.inset:3,m=Number.isFinite(s.stretch)?s.stretch:1,f=Number.isFinite(s.rotations)?s.rotations:Math.max(e.numerator??4,4),v=Number.isFinite(s.steady)?s.steady:.9,O=Number.isFinite(s.thickness)?s.thickness:6,k=typeof s.cap=="string"?s.cap:"round",M=r.createLinearGradient(0,0,i,l);M.addColorStop(0,"rgba(102, 126, 234, 0.08)"),M.addColorStop(1,"rgba(118, 75, 162, 0.12)"),r.fillStyle=M,r.fillRect(0,0,i,l);const E=i/2,I=l/2,F=Math.max(Math.min(i,l)/2-u,40)/Math.max(f+h+1,1),$=v*0,Z={margin:F,cx:E,cy:I,stretch:m,cap:k,thickness:O},ce="rgba(76, 81, 191, 0.85)",U="rgba(148, 163, 184, 0.35)",ue=Math.max(...t.map(be=>be.weight??1),1),W=f;t.forEach(be=>{const ke=Number.isFinite(be.begin)?be.begin:0,Ce=Number.isFinite(be.endClipped)?be.endClipped:Number.isFinite(be.end)?be.end:ke,Ae=Number.isFinite(be.weight)?Math.max(be.weight,.1):1,q=be.color||ce,Ne=h+ke*W,Re=h+Math.max(Ce,ke)*W;MN(r,{...Z,from:Ne,to:Re,rotate:$,thickness:Z.thickness*(.6+Ae/ue*.8),color:q})});const de=h+W+1;MN(r,{...Z,from:h,to:de,rotate:$,color:U,thickness:Z.thickness*.6,fromOpacity:.35,toOpacity:.1}),r.restore()}async computeMasterPunchcardData(e,t){try{oe.strudelLoaded||await oe.initStrudel()}catch(E){return console.warn("⚠️ Unable to initialize Strudel for punchcard:",E),{error:"Strudel is not ready yet."}}if(!window.strudel||typeof window.strudel.evaluate!="function")return{error:"Strudel evaluate function is unavailable."};let s=e;console.log("═══════════════════════════════════════════════════════════"),console.log("🔍 PUNCHCARD EVALUATION - Original pattern:"),console.log("   Full pattern:",s),console.log("───────────────────────────────────────────────────────────"),s=s.replace(/\/\/.*$/gm,""),s=s.replace(/\/\*[\s\S]*?\*\//g,""),s=s.replace(/\n\s*\n/g,`
`).trim(),s=s.replace(/\)\s*\.\s*\((gain|pan)\s*\(/g,").$1("),/\)\s*\.\s*(gain|pan)\s*\(/.test(s)||(s=s.replace(/([a-zA-Z_$][a-zA-Z0-9_$]*\s*\([^()]*\)(?:\s*\.\s*[a-zA-Z_$][a-zA-Z0-9_$]*\s*\([^()]*\))*)\s*\.\s*(gain|pan)\s*\(/g,(E,I,D)=>I.trim().startsWith("(")?E:`(${I}).${D}(`)),console.log("🔍 PUNCHCARD EVALUATION - After removing comments and fixing modifiers:"),console.log("   Pattern:",s),console.log("───────────────────────────────────────────────────────────");const r=(E,I)=>{let D=1;for(let F=I+1;F<E.length;F++)if(E[F]==="(")D++;else if(E[F]===")"&&(D--,D===0))return F;return-1},o=["scope","tscope","fscope","spectrum","visual","spiral"];if(o.forEach(E=>{const I=new RegExp(`\\.\\s*_?${E}\\s*\\(`,"gi");let D,F=0;for(;(D=I.exec(s))!==null;){const _=D.index,$=D.index+D[0].length-1,Z=r(s,$);if(Z!==-1)s=s.substring(0,_)+s.substring(Z+1),F++,console.log(`  Stripped .${E}(...) occurrence #${F}`),I.lastIndex=0;else{console.warn(`  Could not find matching ) for .${E}( at position ${$}`);break}}}),s=s.trim(),s=s.replace(/\.\s*$/,"").replace(/\.\.+/g,".").trim(),console.log("🔍 PUNCHCARD EVALUATION - After stripping:"),console.log("   Stripped pattern:",s),console.log("───────────────────────────────────────────────────────────"),!s||s.trim()==="")return console.warn("⚠️ Pattern is empty after stripping visualizers"),{error:"Pattern is empty after removing visualizers."};if(o.some(E=>new RegExp(`\\.\\s*_?${E}\\s*\\(`,"i").test(s)))return console.warn("═══════════════════════════════════════════════════════════"),console.warn("⚠️ PUNCHCARD EVALUATION - FAILED TO STRIP VISUALIZERS"),console.warn("   Pattern still contains visualizers after stripping:"),console.warn("   ",s),console.warn("   This will cause Mini parser errors. Skipping punchcard evaluation."),console.warn("═══════════════════════════════════════════════════════════"),{error:"Pattern contains visualizers that could not be stripped."};if(console.log("✅ PUNCHCARD EVALUATION - Ready to evaluate (no visualizers detected)"),console.log("═══════════════════════════════════════════════════════════"),!s||s.trim()==="")return console.warn("⚠️ Pattern is empty after stripping - cannot evaluate"),{error:"Pattern is empty after processing"};console.log("📝 Final pattern to evaluate:",s);try{await oe.ensurePatternResourcesLoaded(s)}catch(E){console.warn("⚠️ Unable to preload resources for punchcard evaluation:",E)}const l=E=>{if(E==null)return 0;if(typeof E=="number")return E;if(typeof E.valueOf=="function"){const D=E.valueOf();if(typeof D=="number"&&!Number.isNaN(D))return D}if(typeof E=="object"&&E!==null&&"n"in E&&"d"in E){const D=Number(E.n??0),F=Number(E.d??1);return F!==0?D/F:0}const I=Number(E);return Number.isFinite(I)?I:0},c=E=>E?typeof E=="string"?E:E.label?E.label:E.sample?E.sample:E.s?E.s:E.note?E.note:E.n?E.n:E.sound?E.sound:E.instrument?E.instrument:null:null;let u;try{const{coreModule:E}=await bc(),I=E==null?void 0:E.evaluate,{transpiler:D}=await gs(async()=>{const{transpiler:_}=await Promise.resolve().then(()=>qfe);return{transpiler:_}},void 0),F=await I(s,D,{wrapAsync:!1,addReturn:!1,emitMiniLocations:!1});u=F==null?void 0:F.pattern,console.log("🔍 Evaluated pattern object:",u)}catch(E){return console.error("❌ Failed to evaluate pattern for punchcard:",E),{error:(E==null?void 0:E.message)||"Pattern evaluation failed."}}if(!u&&window.strudel&&typeof window.strudel.evaluate=="function"){console.log("🔁 strudelCoreEvaluate returned no pattern - attempting fallback via window.strudel.evaluate");try{const E=`globalThis.__punchcard_pattern = ${s}`;console.log("🔍 Fallback evaluation code:",E.substring(0,200));const I=await window.strudel.evaluate(E);if(globalThis.__punchcard_pattern)u=globalThis.__punchcard_pattern,console.log("🔍 Fallback pattern object from globalThis:",u);else if(I&&typeof I.queryArc=="function")u=I,console.log("🔍 Fallback pattern object from eval result:",u);else if(I&&I._Pattern)u=I,console.log("🔍 Fallback pattern object (has _Pattern):",u);else{const D=await window.strudel.evaluate(s);D&&(typeof D.queryArc=="function"||D._Pattern)&&(u=D,console.log("🔍 Fallback pattern object from direct eval:",u))}}catch(E){console.warn("⚠️ Fallback evaluation failed:",E),console.warn("⚠️ Pattern that failed:",s.substring(0,200))}}if(!(u&&(typeof u.queryArc=="function"||typeof u.query=="function"||u._Pattern===!0))){if(console.warn("⚠️ Pattern did not return a valid Strudel pattern object"),console.warn("⚠️ Pattern object type:",typeof u),console.warn("⚠️ Pattern object:",u),console.warn("⚠️ Pattern that failed:",s.substring(0,300)),window.strudel&&typeof window.strudel.evaluate=="function")try{const I=`(${s})`,D=await window.strudel.evaluate(I);D&&(typeof D.queryArc=="function"||typeof D.query=="function"||D._Pattern===!0)&&(u=D,console.log("✅ Last attempt succeeded with wrapped pattern"))}catch(I){console.warn("⚠️ Last attempt also failed:",I)}if(!(u&&(typeof u.queryArc=="function"||typeof u.query=="function"||u._Pattern===!0)))return{error:"Pattern expression did not return a Strudel pattern."}}let m;try{if(typeof u.queryArc=="function")m=u.queryArc(0,1)||[];else if(typeof u.query=="function")m=u.query(0,1)||[];else if(u.__steps&&typeof u.__steps=="object")m=[],console.warn("⚠️ Pattern has _Pattern but no queryArc/query - attempting to extract haps from __steps");else throw new Error("Pattern object does not have queryArc, query, or __steps")}catch(E){return console.error("❌ Failed to query pattern arc for punchcard:",E),{error:(E==null?void 0:E.message)||"Pattern queryArc failed."}}try{delete globalThis.__punchcard_pattern}catch{globalThis.__punchcard_pattern=void 0}const f={events:m.map(E=>{const I=E==null?void 0:E.part,D=E==null?void 0:E.whole,F=l(I?I.begin??I.start??0:(D==null?void 0:D.begin)??0);let _=l(I?I.end??I.finish??I.begin??0:(D==null?void 0:D.end)??(D==null?void 0:D.begin)??0);(!Number.isFinite(_)||_<F)&&(_=F);const $=(E==null?void 0:E.value)??null,Z=c($),ce=$&&typeof $=="object"?$.note??$.n??null:null,U=$&&typeof $=="object"?$.sound??$.s??null:null,ue=$&&typeof $=="object"?$.sample??null:null,W=$&&typeof $=="object"?$.instrument??null:null,de=$&&typeof $=="object"?$.source??$.path??null:null,be=typeof $=="string"?$:null,ke=$&&typeof $=="object"&&$.velocity!=null?Number($.velocity):1,Ce=$&&typeof $=="object"&&$.gain!=null?Number($.gain):1,Ae=(Number.isFinite(ke)?ke:1)*(Number.isFinite(Ce)?Ce:1);return{begin:F,end:_,endClipped:l((E==null?void 0:E.endClipped)??_),wholeBegin:l((D==null?void 0:D.begin)??F),wholeEnd:l((D==null?void 0:D.end)??_),label:Z,weight:Number.isFinite(Ae)&&Ae>0?Ae:1,color:$&&typeof $=="object"&&$.color?$.color:null,tags:Array.isArray(E==null?void 0:E.tags)?E.tags:[],meta:{label:Z,note:ce,sound:U,sample:ue,instrument:W,source:de,rawString:be}}})};if(!f||f.error)return console.warn("⚠️ Parsed result has error:",f==null?void 0:f.error),{error:(f==null?void 0:f.error)||"Unknown error from Strudel evaluation."};const{totalSteps:v}=t,O=new Array(v).fill(0),k=new Array(v).fill(null).map(()=>[]),M=f.events||[];return M.forEach(E=>{if(!E)return;const{begin:I,end:D,endClipped:F,label:_,weight:$}=E,Z=(Number(I)%1+1)%1,ce=Number.isFinite(F)?F:D;let U=(Number(ce)%1+1)%1;(!Number.isFinite(U)||U<Z)&&(U=Z);const ue=Math.min(v-1,Math.max(0,Math.floor(Z*v))),W=Math.min(v-1,Math.max(ue,Math.ceil(U*v)-1)),de=Number.isFinite($)?Math.max($,.1):1;for(let be=ue;be<=W;be+=1)if(O[be]+=de,_){const ke=k[be];ke.includes(_)||ke.push(_)}}),{counts:O,hits:k,events:M}}enableNativeStrudelHighlighting(){this.nativeHighlightingEnabled=!0,this.nativeHighlightingDisabled=!1,typeof(oe==null?void 0:oe.setEditorHighlightingEnabled)=="function"&&oe.setEditorHighlightingEnabled(!0)}updateMasterPatternDisplay(){if(!this.masterPatternField)return;const e=oe.getMasterPatternCode();e&&e.trim()!==""?(Vn("master-pattern",e),this.masterPatternField.placeholder="",console.log(`📝 Updated master pattern display: ${e.substring(0,100)}...`)):(Vn("master-pattern",""),this.masterPatternField.placeholder="Combined pattern will appear here...")}updateMasterIndicators(){fs.elements.forEach(e=>{const t=e.id,s=document.querySelector(`[data-sound-id="${t}"]`);if(s){const a=s.querySelector(".master-status-indicator");a&&(oe.trackedPatterns.has(t)?a.classList.add("active"):a.classList.remove("active"))}})}registerElements(e=null){(e||fs.elements.map(s=>{const a=document.querySelector(s.selector);return a?{element:a,elementId:s.id}:null}).filter(s=>s!==null)).forEach(({element:s,elementId:a})=>{s&&(s.getAttribute("data-sound-id"),s.addEventListener("click",r=>{if(r.target.classList.contains("config-button")||r.target.classList.contains("pause-button")||r.target.classList.contains("solo-button")||r.target.classList.contains("mute-button")||r.target.classList.contains("gain-slider")||r.target.classList.contains("pan-slider")||r.target.classList.contains("collapsible-toggle")||r.target.classList.contains("collapsible-content")||r.target.classList.contains("effect-slider")||r.target.classList.contains("filter-slider")||r.target.closest(".collapsible-section"))return;const o=s.getAttribute("data-sound-id");console.log(`🖱️ Click triggered for ${o}`),this.activeElements.has(o)?this.deactivateElement(o,s,"click"):this.activateElement(o,s,"click")}))})}setupElementControls(){fs.elements.forEach(e=>{const t=document.querySelector(e.selector);if(!t)return;const s=e.id,a=t.querySelector(".gain-slider"),r=t.querySelector(".pan-slider");if(a){const c=parseFloat(a.value);oe.setElementGain(s,c),a.addEventListener("input",u=>{u.stopPropagation();const h=parseFloat(u.target.value);oe.setElementGain(s,h),oe.updateTrackedElementGain(s,h),this.updateMasterPatternDisplay()})}if(r){const c=parseFloat(r.value);oe.setElementPan(s,c),r.addEventListener("input",u=>{u.stopPropagation();const h=parseFloat(u.target.value);oe.setElementPan(s,h),oe.updateTrackedElementPan(s,h),this.updateMasterPatternDisplay()})}const o=t.querySelector(".pause-button");o&&o.addEventListener("click",async c=>{c.stopPropagation(),await this.handlePauseButton(s)});const i=t.querySelector(".solo-button");i&&i.addEventListener("click",c=>{c.stopPropagation(),this.handleSoloButton(s,i)});const l=t.querySelector(".mute-button");l&&l.addEventListener("click",c=>{c.stopPropagation(),this.handleMuteButton(s,l)}),this.initializeMidiControls(t,s)})}initializeMidiControls(e,t){if(!e||!t)return;const s=e.querySelector(".midi-enable-toggle"),a=e.querySelector(".midi-channel-select");(()=>{const o=this.getElementMidiSettings(t);s&&(s.checked=!!o.enabled),a&&(a.value=String(o.channel),a.disabled=!o.enabled)})(),s&&!s.dataset.hasListener&&(s.dataset.hasListener="true",s.addEventListener("change",o=>{const i=!!o.target.checked;a&&(a.disabled=!i),this.updateElementMidiSettings(t,{enabled:i})})),a&&!a.dataset.hasListener&&(a.dataset.hasListener="true",a.addEventListener("change",o=>{const i=parseInt(o.target.value,10)||1;this.updateElementMidiSettings(t,{channel:i})}))}getElementMidiSettings(e){var s;if(this.elementMidiSettings||(this.elementMidiSettings={}),this.elementMidiSettings[e]){const a=this.elementMidiSettings[e];return{enabled:!!a.enabled,channel:this.normalizeMidiChannel(a.channel)}}const t=this.deriveMidiSettingsFromPattern((s=fs.getElementConfig(e))==null?void 0:s.pattern)||{enabled:!1,channel:1};return this.elementMidiSettings[e]=t,t}normalizeMidiChannel(e){const t=Number(e);return Number.isFinite(t)?Math.min(16,Math.max(1,Math.round(t))):1}updateElementMidiSettings(e,t={}){if(!e)return;const s=this.getElementMidiSettings(e),a={enabled:t.enabled!==void 0?!!t.enabled:s.enabled,channel:this.normalizeMidiChannel(t.channel!==void 0?t.channel:s.channel)};this.elementMidiSettings[e]=a,this.persistMidiSettings(),this.applyMidiSettingsToPattern(e)}loadStoredMidiSettings(){try{const e=localStorage.getItem("element-midi-settings");if(!e)return{};const t=JSON.parse(e);if(!t||typeof t!="object")return{};const s={};return Object.entries(t).forEach(([a,r])=>{!r||typeof r!="object"||(s[a]={enabled:!!r.enabled,channel:this.normalizeMidiChannel(r.channel)})}),s}catch(e){return console.warn("⚠️ Unable to load MIDI settings:",e),{}}}persistMidiSettings(){try{localStorage.setItem("element-midi-settings",JSON.stringify(this.elementMidiSettings||{}))}catch(e){console.warn("⚠️ Unable to persist MIDI settings:",e)}}deriveMidiSettingsFromPattern(e){if(!e||!/\.midi\b/i.test(e))return null;const t=e.match(/\.midiport\s*\(\s*(\d+)\s*\)/i);return{enabled:!0,channel:t?this.normalizeMidiChannel(parseInt(t[1],10)+1):1}}stripMidiModifiers(e){if(!e)return e;let t=e;return t=t.replace(/\.midiport\s*\([^)]*\)/gi,""),t=t.replace(/\.midi\s*\([^)]*\)/gi,""),t=t.replace(/\.midi\b/gi,""),t=t.replace(/\.\.+/g,"."),t=t.replace(/\s+\./g,"."),t=t.replace(/\.\s*$/,""),t.trim()}getPatternWithMidi(e,t){if(!t)return t;const s=this.stripMidiModifiers(t),a=this.getElementMidiSettings(e);if(!a.enabled)return s;const o=`.midi().midiport(${Math.max(0,this.normalizeMidiChannel(a.channel)-1)})`;if(/\.postgain\s*\(/i.test(s)){const i=s.search(/\.postgain\s*\(/i);return s.slice(0,i)+o+s.slice(i)}return`${s}${o}`}async applyMidiSettingsToPattern(e,t={}){var h;if(!e)return;const{persistConfig:s=!0}=t,a=this.loadElementConfig(e),r=fs.getElementConfig(e),o=(h=oe.trackedPatterns)==null?void 0:h.get(e);let i=(a==null?void 0:a.pattern)||(o==null?void 0:o.pattern)||(o==null?void 0:o.rawPattern)||(r==null?void 0:r.pattern)||"";if(!i||i.trim()==="")return;const l=this.getPatternWithMidi(e,i);if(!l||l===i)return;if(s){const m={...a||{},pattern:l};if(this.saveElementConfig(e,m,!0),this.currentEditingElementId===e&&typeof Vn=="function")try{Vn("modal-pattern",l)}catch(f){console.warn("⚠️ Unable to update modal pattern with MIDI changes:",f)}}const c=oe.trackedPatterns&&oe.trackedPatterns.has(e),u=oe.isPlaying(e);try{c?(await oe.updatePatternInPlace(e,l,!0),this.updateMasterPatternDisplay()):u?await oe.updatePatternInPlace(e,l):await oe.preEvaluatePattern(e,l)}catch(m){console.warn(`⚠️ Unable to apply MIDI settings to ${e}:`,m)}}async saveChannelWithMidi(e){var o,i,l,c;const{getCurrentUser:t}=await gs(async()=>{const{getCurrentUser:u}=await Promise.resolve().then(()=>Cc);return{getCurrentUser:u}},void 0);if(!await t()){alert("Please log in to save patterns");return}const a=this.loadElementConfig(e);if(!a||!a.pattern){(i=(o=this.uiController)==null?void 0:o.updateStatus)==null||i.call(o,"Nothing to save for this channel.");return}const r=this.getPatternWithMidi(e,a.pattern);window.savePatternDialog?(await window.savePatternDialog.show(r,"channel",e),window.savePatternDialog.setOnSave(async()=>{var h,m;const u={...a,pattern:r};this.saveElementConfig(e,u,!1),Xr.markChannelSnapshot(e,r),(m=(h=this.uiController)==null?void 0:h.updateStatus)==null||m.call(h,`Saved channel ${e} to cloud.`)})):(c=(l=this.uiController)==null?void 0:l.updateStatus)==null||c.call(l,"Save dialog not available.")}applyChannelHistoryEntry(e,t){var r,o;if(!e||!t)return;const s=t.trim(),a=this.loadElementConfig(e)||{};Xr.markChannelSnapshot(e,s),this.saveElementConfig(e,{...a,pattern:s},!0),this.currentEditingElementId!==e&&(this.openConfigModal?this.openConfigModal(e):console.warn("⚠️ openConfigModal not available, modal may not open")),setTimeout(()=>{Vn("modal-pattern",s)},50),(o=(r=this.uiController)==null?void 0:r.updateStatus)==null||o.call(r,`Loaded history for ${e}. Save to apply.`)}applyMasterHistoryEntry(e){var s,a;if(!e)return;const t=e.trim();Vn("master-pattern",t),oe.masterPattern=t,Xr.markMasterSnapshot(t),this.updateMasterPatternDisplay(),(a=(s=this.uiController)==null?void 0:s.updateStatus)==null||a.call(s,"Loaded master pattern history entry.")}async saveMasterHistoryEntry(){var o,i,l,c;const{getCurrentUser:e}=await gs(async()=>{const{getCurrentUser:u}=await Promise.resolve().then(()=>Cc);return{getCurrentUser:u}},void 0);if(!await e()){alert("Please log in to save patterns");return}const s=document.getElementById("master-pattern"),r=((s?s.value:"")||"").trim();if(!r){(i=(o=this.uiController)==null?void 0:o.updateStatus)==null||i.call(o,"Master pattern is empty.");return}window.savePatternDialog?(await window.savePatternDialog.show(r,"master",null),window.savePatternDialog.setOnSave(async u=>{var h,m;Xr.saveMasterVersion(r),Xr.markMasterSnapshot(r),oe.masterPattern=r,this.updateMasterPatternDisplay(),(m=(h=this.uiController)==null?void 0:h.updateStatus)==null||m.call(h,"Saved master pattern to cloud.")})):(c=(l=this.uiController)==null?void 0:l.updateStatus)==null||c.call(l,"Save dialog not available.")}async handlePauseButton(e){const t=document.querySelector(`[data-sound-id="${e}"]`);if(!t)return;const s=t.querySelector(".element-indicator"),a=t.querySelector(".pause-button");(a==null?void 0:a.classList.contains("paused"))?(a==null||a.classList.remove("paused"),s==null||s.classList.remove("paused"),this.elementHasPattern(e)&&await oe.triggerSound(e),console.log(`▶️ Resumed ${e}`)):(a==null||a.classList.add("paused"),s==null||s.classList.add("paused"),s==null||s.classList.remove("looped"),oe.pauseSound(e),console.log(`⏸️ Paused ${e}`))}handleSoloButton(e,t){this.soloedElements.has(e)?(this.soloedElements.delete(e),t.classList.remove("active"),console.log(`🎵 Unsolo: ${e}`)):(this.soloedElements.add(e),t.classList.add("active"),console.log(`🎵 Solo: ${e}`)),this.updateElementAudioStates()}handleMuteButton(e,t){this.mutedElements.has(e)?(this.mutedElements.delete(e),t.classList.remove("active"),console.log(`🔊 Unmute: ${e}`)):(this.mutedElements.add(e),t.classList.add("active"),console.log(`🔇 Mute: ${e}`)),this.updateElementAudioStates()}updateElementAudioStates(){const e=this.soloedElements.size>0;fs.elements.forEach(t=>{const s=t.id,a=this.mutedElements.has(s),r=this.soloedElements.has(s);let o;a?o=0:e?o=r?1:0:o=1;const i=document.querySelector(`[data-sound-id="${s}"]`);if(i){const l=i.querySelector(".gain-slider"),c=l?parseFloat(l.value):.8;oe.setElementGain(s,c*o)}}),oe.updateMasterPattern(this.soloedElements,this.mutedElements),this.updateMasterPatternDisplay()}activateElement(e,t,s){if(console.log(`🎵 Activating ${e} via ${s}`),this.masterActive&&oe.trackedPatterns.has(e)){console.log(`   ⚠️ Master is playing and ${e} is tracked - ignoring individual activation`),Os.updateStatus(`Cannot play ${e} individually while master is active. Stop master first.`);return}Os.setElementState(t,"focus"),this.updateStatusDots(e,this.elementHasPattern(e),!1),Os.updateStatus("Ready")}deactivateElement(e,t,s){if(console.log(`🔇 Deactivating ${e} (was triggered by ${s})`),this.activeElements.has(e)){this.activeElements.delete(e),console.log(`   Stopping sound for ${e}`),oe.stopSound(e);const a=this.elementHasPattern(e);this.updateStatusDots(e,a,!1),Os.setElementState(t,null),this.updateActiveElementsDisplay(),this.activeElements.size===0&&Os.updateStatus("Ready")}}updateActiveElementsDisplay(){const e=Array.from(this.activeElements).map(s=>{const a=fs.getElementConfig(s);return(a==null?void 0:a.description)||s});Os.updateActiveElements(e);const t=document.getElementById("slots-info");if(t){const s=oe.trackedPatterns?Array.from(oe.trackedPatterns.keys()):[],a=new Set([...this.activeElements,...s]);if(a.size===0)t.textContent="None active";else{const r=Array.from(a).map(o=>{let i="";const l=document.querySelector(`[data-sound-id="${o}"]`);if(l){const c=l.querySelector(".element-title");c&&(i=c.textContent.trim())}if(!i)try{const c=localStorage.getItem(`element-config-${o}`);if(c){const u=JSON.parse(c);i=u.title||u.description||""}}catch{}if(!i){const c=fs.getElementConfig(o);i=(c==null?void 0:c.description)||o}return i});t.textContent=r.join(" | ")}}}elementHasPattern(e){const t=fs.getElementConfig(e);if(t!=null&&t.pattern&&t.pattern.trim()!=="")return!0;try{const s=localStorage.getItem(`element-config-${e}`);if(s){const a=JSON.parse(s);if(a.pattern&&a.pattern.trim()!=="")return!0}}catch{}return!1}updateStatusDots(e,t,s){const a=document.querySelector(`[data-sound-id="${e}"]`);if(!a)return;const r=a.querySelector(".loaded-dot"),o=a.querySelector(".playing-dot"),i=a.querySelector(".element-circle");if(r&&(t?r.classList.remove("active"):r.classList.add("active")),o){const l=this.loadElementConfig(e);l&&l.pattern&&l.pattern.trim()!==""?(o.classList.add("active"),s?o.classList.add("is-playing"):o.classList.remove("is-playing")):(o.classList.remove("active"),o.classList.remove("is-playing"))}i&&(s?(i.classList.add("playing"),console.log(`🟢 Circle turned green for ${e} (playing)`)):i.classList.remove("playing"))}isDrumPattern(e){if(!e||typeof e!="string")return!1;const t=e.match(/sound\(["']([^"']+)["']\)|s\(["']([^"']+)["']\)/);if(!t)return!1;const s=t[1]||t[2];return s?s.split(/\s+/).filter(o=>o.trim()).some(o=>$J.hasOwnProperty(o.toLowerCase())):!1}convertNumericPatternToNoteNames(e,t,s){if(!e||!s)return e;const a=k=>typeof k=="string"&&/[b]/i.test(k),r=new Map([["Abb","G"],["Bbb","A"],["Cbb","Bb"],["Dbb","C"],["Ebb","D"],["Fbb","Eb"],["Gbb","F"],["A##","B"],["B##","C#"],["C##","D"],["D##","E"],["E##","F#"],["F##","G"],["G##","A"],["Fb","E"],["Cb","B"],["E#","F"],["B#","C"]]),o=new Map([["A#","Bb"],["C#","Db"],["D#","Eb"],["F#","Gb"],["G#","Ab"]]);function i(k,M){const E=k.match(/^([A-Ga-g])([#b]{0,2})(-?\d+)?$/);if(!E)return k;const I=E[1].toUpperCase(),D=E[2]||"",F=E[3]||"",_=`${I}${D}`;if(r.has(_))return`${r.get(_)}${F}`;if(M&&D==="#"){const $=o.get(`${I}#`);if($)return`${$}${F}`}return`${I}${D}${F}`}const c={major:"major",minor:"minor",chromatic:"chromatic",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic",ionian:"major",aeolian:"minor","melodic minor":"melodic minor","dorian b2":"dorian b2","lydian augmented":"lydian augmented","lydian dominant":"lydian dominant","mixolydian b6":"mixolydian b6","locrian #2":"locrian #2",altered:"altered","harmonic minor":"harmonic minor","locrian #6":"locrian #6","ionian #5":"ionian #5","dorian #4":"dorian #4","phrygian dominant":"phrygian dominant","lydian #2":"lydian #2",ultralocrian:"ultralocrian","harmonic major":"harmonic major","dorian b5":"dorian b5","phrygian b4":"phrygian b4","lydian b3":"lydian b3","mixolydian b2":"mixolydian b2","lydian augmented #2":"lydian augmented #2","locrian bb7":"locrian bb7","major pentatonic":"major pentatonic","suspended pentatonic":"suspended pentatonic","man gong":"man gong",ritusen:"ritusen","minor pentatonic mode 5":"minor pentatonic","minor pentatonic":"minor pentatonic","blues minor pentatonic":"minor pentatonic","major pentatonic mode 3":"major pentatonic",egyptian:"egyptian","minor pentatonic mode 5":"minor pentatonic","whole tone":"whole tone","half-whole diminished":"dominant diminished","whole-half diminished":"diminished","minor blues":"blues"}[s]||s;let u="C";if(t){const k=t.trim().match(/^([a-gA-G])([#b]?)/);k?u=`${k[1].toUpperCase()}${k[2]||""}`:u=t.trim()}const h=`${u} ${c}`,m=ji.get(h);if(!m||!m.notes||m.notes.length===0)return console.warn(`⚠️ Could not get scale notes for "${h}"`),e;const f=a(u),v=m.notes.map(k=>i(`${k}`,f).replace(/-?\d+$/,""));console.log(`🎼 Scale "${h}" notes:`,v);const O=/\b(n|note)\s*\(\s*(["'])([^"']+)\2\s*\)/g;return e.replace(O,(k,M,E,I)=>{const D=/(\s+|[,;:<>()[\]{}|\\/]+|\*+)/g,F=[];let _=0,$;for(;($=D.exec(I))!==null;)$.index>_&&F.push({type:"number",value:I.substring(_,$.index)}),F.push({type:"separator",value:$[0]}),_=$.index+$[0].length;_<I.length&&F.push({type:"number",value:I.substring(_)});const Z=[];for(const ce of F)if(ce.type==="separator")Z.push(ce.value);else{const U=parseInt(ce.value.trim(),10);if(isNaN(U))Z.push(ce.value);else{const ue=v.length||1,W=Math.floor(U/ue),de=(U%ue+ue)%ue,be=v[de],Ce=3+W,Ae=i(`${be}${Ce}`,f);Z.push(Ae)}}return`note(${E}${Z.join("")}${E})`})}getAllScaleNotesAsPattern(e,t){if(!t)return"";const a={major:"major",minor:"minor",chromatic:"chromatic",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic",ionian:"major",aeolian:"minor","dorian b2":"dorian b2","lydian augmented":"lydian augmented","lydian dominant":"lydian dominant","mixolydian b6":"mixolydian b6","locrian #2":"locrian #2",altered:"altered","harmonic minor":"harmonic minor","locrian #6":"locrian #6","ionian #5":"ionian #5","dorian #4":"dorian #4","phrygian dominant":"phrygian dominant","lydian #2":"lydian #2",ultralocrian:"ultralocrian","harmonic major":"harmonic major","dorian b5":"dorian b5","phrygian b4":"phrygian b4","lydian b3":"lydian b3","mixolydian b2":"mixolydian b2","lydian augmented #2":"lydian augmented #2","locrian bb7":"locrian bb7","major pentatonic":"major pentatonic","minor pentatonic":"minor pentatonic","suspended pentatonic":"suspended pentatonic","man gong":"man gong",ritusen:"ritusen","major pentatonic mode 3":"major pentatonic","minor pentatonic mode 5":"minor pentatonic","blues minor pentatonic":"minor pentatonic","whole tone":"whole tone","half-whole diminished":"dominant diminished","whole-half diminished":"diminished","minor blues":"blues"}[t]||t;let r="C";if(e){const u=e.trim().match(/^([a-gA-G])([#b]?)/);u?r=`${u[1].toUpperCase()}${u[2]||""}`:r=e.trim()}const o=`${r} ${a}`,i=ji.get(o);if(!i||!i.notes||i.notes.length===0)return console.warn(`⚠️ Could not get scale notes for "${o}"`),"";const l=i.notes;return console.log(`🎼 Scale "${o}" notes:`,l),`n("${Array.from({length:l.length},(u,h)=>h).join(" ")}")`}getAllScaleNotesAsNoteNames(e,t){if(!t)return"";const a={major:"major",minor:"minor",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic"}[t]||t;let r="C";if(e){const u=e.trim().match(/^([a-gA-G])([#b]?)/);u?r=`${u[1].toUpperCase()}${u[2]||""}`:r=e.trim()}const o=`${r} ${a}`,i=ji.get(o);if(!i||!i.notes||i.notes.length===0)return console.warn(`⚠️ Could not get scale notes for "${o}"`),"";const l=i.notes;return console.log(`🎼 Scale "${o}" notes:`,l),`note("${l.map(u=>`${u}4`).join(" ")}")`}resetAll(){console.log("🔄 Resetting all elements and master pattern..."),oe.stopAllSounds(),document.querySelectorAll(".sound-element").forEach(a=>{const r=a.dataset.soundId;r&&parseInt(r.replace("element-",""))>this.initialElementCount&&(console.log(`🗑️ Removing dynamically created element: ${r}`),a.remove())}),this.elementCounter=this.initialElementCount,console.log("🗑️ Clearing all localStorage..."),localStorage.clear(),oe.trackedPatterns.clear(),oe.updateMasterPattern(),this.masterPatternField&&(Vn("master-pattern",""),this.masterPatternField.placeholder="Combined pattern will appear here..."),document.querySelectorAll(".sound-element").forEach(a=>{const r=a.dataset.soundId;if(r){const o=fs.getElementConfig(r);o&&(o.pattern="",o.description="No sound assigned",o.title="",o.sampleUrl="",o.bank=void 0,o.key=void 0,o.scale=void 0,o.keepNotesAsWritten=!1),oe.removeElementFromMaster(r),Ho(r,""),this.updateStatusDots(r,!1,!1);const i=a.querySelector(".element-circle");i&&i.classList.remove("playing");const l=a.querySelector(".master-status-indicator");l&&l.classList.remove("active");const c=a.querySelector(".gain-slider"),u=a.querySelector(".pan-slider");c&&(c.value=.8),u&&(u.value=0);const h=a.querySelector(".midi-enable-toggle"),m=a.querySelector(".midi-channel-select");h&&(h.checked=!1),m&&(m.value="1",m.disabled=!0),this.elementMidiSettings&&delete this.elementMidiSettings[r]}}),this.activeElements.clear(),this.mutedElements.clear(),this.soloedElements.clear(),this.elementMidiSettings={},this.persistMidiSettings(),this.masterActive=!1,this.currentEditingElementId=null,this.selectedVisualizer="scope";const s=document.getElementById("visualizer-select");if(s&&(s.value="scope"),this.masterPunchcardCanvas){const a=this.masterPunchcardCanvas.getContext("2d");a&&a.clearRect(0,0,this.masterPunchcardCanvas.width,this.masterPunchcardCanvas.height)}this.updateActiveElementsDisplay(),this.updateMasterPatternDisplay(),this.updateMasterIndicators(),Os.updateStatus("✅ All cleared")}setAllElementsNotLoaded(){fs.elements.forEach(e=>{this.updateStatusDots(e.id,!1,!1)}),console.log("🔴 All element status dots marked as NOT loaded (red)")}setAllElementsLoaded(){fs.elements.forEach(e=>{let t=!1;if(e.pattern&&e.pattern.trim()!==""&&(t=!0),!t)try{const s=localStorage.getItem(`element-config-${e.id}`);if(s){const a=JSON.parse(s);a.pattern&&a.pattern.trim()!==""&&(t=!0)}}catch{}this.updateStatusDots(e.id,t,!1)}),console.log("✅ Element status dots updated based on configured patterns")}getStoredGdprConsent(){if(typeof localStorage>"u")return!1;try{return localStorage.getItem(dN)==="true"}catch{return!1}}setupGdprConsentFlow(){var e;if(this.gdprOverlay=document.getElementById("gdpr-consent-overlay"),this.gdprAcceptButton=document.getElementById("gdpr-accept-btn"),!this.gdprOverlay||!this.gdprAcceptButton){this.enablePostConsentFeatures();return}if(this.hasGdprConsent){this.hideGdprOverlay(),this.enablePostConsentFeatures();return}(e=document.body)==null||e.classList.add("gdpr-locked"),this.gdprOverlay.removeAttribute("hidden"),this.gdprOverlay.setAttribute("aria-hidden","false"),this.gdprAcceptButton.addEventListener("click",t=>{t.preventDefault(),this.handleGdprAccept()},{once:!0})}hideGdprOverlay(){var e;this.gdprOverlay&&(this.gdprOverlay.setAttribute("hidden","hidden"),this.gdprOverlay.setAttribute("aria-hidden","true")),(e=document.body)==null||e.classList.remove("gdpr-locked")}async handleGdprAccept(){if(this.hasGdprConsent){this.hideGdprOverlay(),this.enablePostConsentFeatures();return}this.hasGdprConsent=!0;try{typeof localStorage<"u"&&localStorage.setItem(dN,"true")}catch(e){console.warn("⚠️ Unable to persist GDPR consent:",e)}this.hideGdprOverlay(),this.enablePostConsentFeatures();try{oe.isAudioReady()||await oe.initialize()}catch(e){console.warn("⚠️ Audio initialization after consent failed:",e)}}enablePostConsentFeatures(){this.postConsentReady||(this.postConsentReady=!0,this.setupAudioInitialization())}setupAudioInitialization(){const e=async s=>{var a,r,o,i;if(console.log(`🎵 [AUDIO INIT] Event: ${s.type}, target: ${((a=s.target)==null?void 0:a.tagName)||"unknown"}`),console.log(`🎵 [AUDIO INIT] isAudioReady: ${oe.isAudioReady()}, audioContext: ${!!oe.audioContext}, state: ${((r=oe.audioContext)==null?void 0:r.state)||"N/A"}`),oe.isAudioReady())console.log(`🎵 [AUDIO INIT] Audio already ready, state: ${((i=oe.audioContext)==null?void 0:i.state)||"N/A"}`),oe.audioContext&&oe.audioContext.state!=="running"&&(console.log(`🎵 [AUDIO INIT] Audio ready but context not running (${oe.audioContext.state}), resuming...`),oe.audioContext.resume().then(()=>{console.log(`🎵 [AUDIO INIT] Audio context resumed, state: ${oe.audioContext.state}`)}).catch(l=>{console.error("🎵 [AUDIO INIT] Failed to resume:",l)}));else{console.log("🎵 [AUDIO INIT] Starting audio initialization...");const l=await oe.initialize();console.log(`🎵 [AUDIO INIT] Initialize result: ${l}, audioContext state: ${((o=oe.audioContext)==null?void 0:o.state)||"N/A"}`),l?(Os.updateStatus("Audio enabled - Loading sounds..."),t.forEach(({target:c,eventName:u,options:h})=>{c.removeEventListener(u,e,h)})):(console.error("🎵 [AUDIO INIT] Failed to initialize audio"),Os.updateStatus("Click to enable audio (required for sound playback)"))}},t=[{target:document,eventName:"click",options:!1},{target:document,eventName:"touchstart",options:{passive:!0}},{target:document,eventName:"touchend",options:{passive:!0}},{target:document,eventName:"pointerdown",options:{passive:!0}},{target:document,eventName:"keydown",options:!1},{target:document,eventName:"mousedown",options:!1},{target:window,eventName:"focus",options:!1}];t.forEach(({target:s,eventName:a,options:r})=>{s.addEventListener(a,e,r)})}loadAllElementConfigs(){fs.elements.forEach(e=>{const t=this.loadElementConfig(e.id);if(t){const s=t.title&&t.title.trim()?t.title:t.bank&&t.bank.trim()?Tf[t.bank]||t.bank.replace("github:tidalcycles/",""):"";Ho(e.id,s),t.pattern!==void 0&&(e.pattern=t.pattern),t.title!==void 0&&(e.description=t.title)}else Ho(e.id,e.description||"")})}migrateLocalStorageQuotes(){try{console.log("🔧 Migrating localStorage to fix fancy quotes...");let e=0;for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);if(s&&s.startsWith("element-config-"))try{const a=localStorage.getItem(s);if(a){const r=JSON.parse(a);if(r&&r.pattern){const o=r.pattern,i=o.replace(/[""]/g,'"').replace(/['']/g,"'");o!==i&&(r.pattern=i,localStorage.setItem(s,JSON.stringify(r)),e++,console.log(`  ✅ Fixed quotes in ${s}`))}}}catch(a){console.warn(`  ⚠️ Could not migrate ${s}:`,a)}}e>0?console.log(`✅ Migrated ${e} patterns with fancy quotes`):console.log("✅ No patterns needed migration")}catch(e){console.error("Error during localStorage migration:",e)}}loadElementConfig(e){try{const t=localStorage.getItem(`element-config-${e}`);if(t){const s=JSON.parse(t);if(s&&s.pattern&&(s.pattern=s.pattern.replace(/[""]/g,'"').replace(/['']/g,"'"),s.pattern=SN(s.pattern)),s&&s.bank){const a=Db(s.bank);a!==s.bank&&console.log(`🔁 Normalized synth bank from "${s.bank}" to "${a}" for ${e}`),s.bank=a}if(s&&s.pattern&&(!this.elementMidiSettings||!this.elementMidiSettings[e])){const a=this.deriveMidiSettingsFromPattern(s.pattern);a&&(this.elementMidiSettings=this.elementMidiSettings||{},this.elementMidiSettings[e]=a,this.persistMidiSettings())}return s}}catch(t){console.error(`Error loading config for ${e}:`,t)}return null}saveElementConfig(e,t,s=!1){try{if(t.bank&&typeof t.bank=="string"){const u=Db(t.bank);u!==t.bank&&(console.log(`🔁 Normalized bank selection from "${t.bank}" to "${u}" before saving`),t.bank=u)}if(t.pattern&&typeof t.pattern=="string"){const u=SN(t.pattern);u!==t.pattern&&(console.log("🔁 Updated pattern to use canonical synth names before saving"),t.pattern=u),Xr.saveChannelVersion(e,t.pattern)}localStorage.setItem(`element-config-${e}`,JSON.stringify(t));const a=fs.getElementConfig(e);a&&(t.pattern!==void 0&&(a.pattern=t.pattern),t.title!==void 0&&(a.description=t.title),t.sampleUrl&&t.sampleUrl.trim()!==""?(a.audioFile=t.sampleUrl,a.type="audio"):(a.audioFile=void 0,a.type="strudel"));const r=t.title&&t.title.trim()?t.title:t.bank?Tf[t.bank]||t.bank.replace("github:tidalcycles/",""):"";Ho(e,r);const o=document.querySelector(`[data-sound-id="${e}"]`);if(o){const u=t.pattern&&YBe(t.pattern),h=o.querySelector(".synthesis-section");h&&u&&(h.style.display="block",console.log(`✅ ${e}: Synthesis section shown for synth pattern`))}const i=t.pattern&&t.pattern.trim()!=="",l=this.activeElements.has(e);this.updateStatusDots(e,i,!1);const c=oe.masterActive;if(t.pattern!==void 0&&(oe.invalidatePatternCache(e),oe.preEvaluatePattern(e,t.pattern).catch(u=>{console.log(`⚠️ Failed to pre-evaluate pattern for ${e}:`,u)})),!s&&t.pattern!==void 0&&t.pattern.trim()!==""){const u=document.querySelector(`[data-sound-id="${e}"]`);let h=.8,m=0;if(u){const v=u.querySelector(".gain-slider"),O=u.querySelector(".pan-slider");v&&(h=parseFloat(v.value)),O&&(m=parseFloat(O.value))}const f=oe.saveElementToMaster(e,t.pattern,h,m);if(f.success){if(oe.updateMasterPattern(this.soloedElements,this.mutedElements),!c&&oe.masterActive){if(typeof oe.stopMasterPattern=="function")try{oe.stopMasterPattern()}catch(v){console.warn("⚠️ Could not stop master after save:",v)}oe.masterActive=!1}if(!c&&window.strudel&&window.strudel.scheduler&&window.strudel.scheduler.started)try{window.strudel.scheduler.stop()}catch(v){console.warn("⚠️ Could not stop scheduler after save:",v)}this.updateMasterPatternDisplay(),this.updateMasterIndicators(),console.log(`✅ Pattern saved to master for ${e}`)}else console.error(`❌ Failed to save pattern to master for ${e}:`,f.error)}this.applyMidiSettingsToPattern(e),console.log(`✅ Saved config for ${e}:`,t)}catch(a){console.error(`Error saving config for ${e}:`,a)}}setupModal(){var Ra;const e=document.getElementById("config-modal");if(!e)return;const t=this,s=e.querySelector("#modal-theory-block");s&&(s.innerHTML=TJ("modal"),BJ(s));const a=document.getElementById("modal-pattern-bank"),r=document.getElementById("modal-sample-url"),o=document.getElementById("modal-sample-name"),i=document.getElementById("modal-add-sample-btn"),l=document.getElementById("modal-sample-file");document.getElementById("modal-pattern");const u=(()=>{if(!a)return null;let Y=document.getElementById("sample-pack-sounds-group");if(Y){const Se=Y.querySelector(".sample-pack-path-container"),fe=Y.querySelector("select"),Te=Y.querySelector(".sample-pack-sounds-status");return{wrapper:Y,select:fe,status:Te,pathContainer:Se}}const J=a.closest(".form-group");if(!J)return null;Y=document.createElement("div"),Y.className="form-group sample-pack-sounds-group",Y.id="sample-pack-sounds-group",Y.style.display="none";const te=document.createElement("label");te.setAttribute("for","sample-pack-sound-select"),te.textContent="Sample Pack Sounds:";const A=document.createElement("select");A.id="sample-pack-sound-select",A.className="control-select",A.disabled=!0;const he=document.createElement("option");he.value="",he.textContent="Select a sample",A.appendChild(he);const we=document.createElement("small");we.className="sample-pack-sounds-status",we.textContent="Select a sample pack to view its sounds.";const Oe=document.createElement("div");return Oe.className="sample-pack-path-container",Oe.style.display="none",Y.appendChild(te),Y.appendChild(Oe),Y.appendChild(A),Y.appendChild(we),J.insertAdjacentElement("afterend",Y),{wrapper:Y,select:A,status:we,pathContainer:Oe}})();let h="",m=0,f=null,v=[],O=[];const k=(Y="Select a sample pack to view its sounds.")=>{if(!u)return;u.wrapper.style.display="none",u.select.disabled=!0,u.select.innerHTML="";const J=document.createElement("option");J.value="",J.textContent="Select a sample",u.select.appendChild(J),u.pathContainer&&(u.pathContainer.innerHTML="",u.pathContainer.style.display="none"),u.pathContainer&&(u.pathContainer.innerHTML="",u.pathContainer.style.display="none"),u.status.textContent=Y,h="",f=null,v=[],O=[]},M=(Y="this pack")=>{if(!u)return;u.wrapper.style.display="",u.select.disabled=!0,u.select.innerHTML="";const J=document.createElement("option");J.value="",J.textContent="Loading samples...",u.select.appendChild(J),u.pathContainer&&(u.pathContainer.innerHTML="",u.pathContainer.style.display="none"),u.status.textContent=`Loading samples from ${Y}...`},E=Y=>{if(!Y||!f)return;const J=v.find(ot=>ot.id===Y);if(!J){u!=null&&u.status&&(u.status.textContent="Unable to insert sample (not found in current view).");return}const te=`https://raw.githubusercontent.com/${f.meta.owner}/${f.meta.repo}/${f.meta.branch}/`,A=J.relativePath||J.path||J.fileName||J.name,he=J.name,Oe=`(${["samples({",`  "${he}": "${A}"`,`}, { baseUrl: "${te}" })`].join(`
`)},
 sound("${he}"))`,Se=Qn("modal-pattern")||"",fe=Se.trimEnd(),Qe=fe.length>0?`${fe}

${Oe}`:Oe,Ee=Se.includes(`"${he}": "${A}"`);if(Se.includes(`sound("${he}")`)||Ee){u!=null&&u.status&&(u.status.textContent=`sound("${he}") already exists in the pattern.`),u.select.value="";return}Vn("modal-pattern",Qe),typeof In=="function"&&In(),u!=null&&u.status&&(u.status.textContent=`Added samples() block and sound("${he}") to the pattern.`),u.select.value=""},I=(Y=[])=>Tg(Y.filter(Boolean).join("/")),D=(Y,J="")=>{const te=Tg(J),A=new Set,he=[],we=te?`${te}/`:"";Y.audioNodes.forEach(fe=>{const Te=fe.relativePath;if(te){if(Te===te){he.push(fe);return}if(!Te.startsWith(we))return;const Qe=Te.slice(we.length);if(!Qe){he.push(fe);return}const[Ee,...De]=Qe.split("/");De.length===0?he.push(fe):A.add(Ee)}else Te.includes("/")?A.add(Te.split("/")[0]):he.push(fe)});const Oe=he.map(fe=>({name:fe.name,relativePath:fe.relativePath,rawUrl:fe.rawUrl,id:fe.id,path:fe.path,fileName:fe.fileName})).filter((fe,Te,Qe)=>Qe.findIndex(Ee=>Ee.relativePath===fe.relativePath)===Te).sort((fe,Te)=>fe.relativePath.localeCompare(Te.relativePath));return{folders:Array.from(A).sort((fe,Te)=>fe.localeCompare(Te)),samples:Oe}},F=()=>{if(!u)return;if(!!!f){u.select.disabled=!0,u.select.innerHTML="";const he=document.createElement("option");he.value="",he.textContent="Select a sample",u.select.appendChild(he);return}const J=I(O),{samples:te}=D(f,J);if(!te.length){u.select.disabled=!0,u.select.innerHTML="";const he=document.createElement("option");he.value="",he.textContent="No audio files in this folder",u.select.appendChild(he),u.status.textContent=O.length?"This folder has no audio files. Select another folder.":"No audio files found at the root. Browse folders to find samples.";return}u.select.disabled=!1,u.select.innerHTML="";const A=document.createElement("option");A.value="",A.textContent=`Select a sample (${te.length})`,u.select.appendChild(A),v=te,te.forEach(he=>{const we=document.createElement("option");we.value=he.id,we.textContent=he.relativePath,we.dataset.name=he.name,we.dataset.path=he.path,u.select.appendChild(we)}),u.status.textContent=J?`Showing samples in /${J}`:"Showing samples in root folder."},_=()=>{if(!u||!u.pathContainer)return;if(u.pathContainer.innerHTML="",!f){u.pathContainer.style.display="none";return}let Y=!1;for(let J=0;;J++){const te=O.slice(0,J),A=I(te),{folders:he}=D(f,A);if(!he.length)break;Y=!0;const we=document.createElement("select");we.className="sample-pack-path-select",we.dataset.level=String(J);const Oe=document.createElement("option");Oe.value="",Oe.textContent=J===0?"Root folder":"Select subfolder",we.appendChild(Oe),he.forEach(fe=>{const Te=document.createElement("option");Te.value=fe,Te.textContent=fe,we.appendChild(Te)});const Se=O[J]||"";if(we.value=Se,we.addEventListener("change",()=>{O=O.slice(0,J),we.value&&(O[J]=we.value),$()}),u.pathContainer.appendChild(we),!Se)break}u.pathContainer.style.display=Y?"":"none"},$=()=>{_(),F()},Z=async(Y,J="")=>{var A;if(!u)return;m+=1;const te=m;M(J);try{const he=await kBe(Y);if(te!==m)return;h=Y,f=he,O=[],u.wrapper.style.display="",$()}catch(he){if(te!==m)return;u.select.disabled=!0,u.select.innerHTML="";const we=document.createElement("option");we.value="",we.textContent="Unable to load samples",u.select.appendChild(we);const Oe=(A=he.message)!=null&&A.includes("API rate limit")?"GitHub API rate limit reached. Please wait a few minutes and try again.":he.message;u.status.textContent=`Unable to load samples: ${Oe}`,u.pathContainer&&(u.pathContainer.innerHTML="",u.pathContainer.style.display="none")}};u!=null&&u.select&&!u.select.dataset.listenerAttached&&(u.select.addEventListener("change",()=>{const Y=u.select.value;Y&&E(Y)}),u.select.dataset.listenerAttached="true"),k();const ce=Y=>{const J={baseUrl:"./",samplePath:""};if(!Y||typeof Y!="string")return J;const te=Y.trim();if(!te)return J;try{const A=new URL(te),he=A.pathname||"",we=he.endsWith("/")&&he.length>1?he.slice(0,-1):he,Oe=we.lastIndexOf("/");if(Oe!==-1){const Se=we.slice(Oe+1)||"",fe=we.slice(0,Oe+1);return{baseUrl:`${A.origin}${fe}`,samplePath:Se||te}}return{baseUrl:`${A.origin}/`,samplePath:we||A.origin}}catch{const A=te.replace(/\\/g,"/"),he=A.lastIndexOf("/");return he!==-1?{baseUrl:A.slice(0,he+1),samplePath:A.slice(he+1)||A}:{baseUrl:"./",samplePath:A||"sample.wav"}}},U=(Y="")=>Y.replace(/[\r\n]+/g,"").trim(),ue=(Y="")=>JSON.stringify(Y??""),W=(Y,J,te)=>{const A=ue(Y||"sample"),he=U(te||Y||""),we=ue(he),Oe=U(J||"./"),Se=ue(Oe||"./"),fe=`samples({
  ${A}: ${we}
}, { baseUrl: ${Se} })`,Te=`sound(${A})`,Qe=`(${fe},
 ${Te})`,De=(Qn("modal-pattern")||"").trim(),ot=De?`${De}

${Qe}`:Qe;Vn("modal-pattern",ot),typeof In=="function"&&In(),o.value="",r.value="",l&&(l.value=""),o.focus()};i&&i.addEventListener("click",()=>{if(!o||!r)return;const Y=o.value.trim(),J=r.value.trim(),te=l&&l.files&&l.files.length>0;if(!Y||!J&&!te){alert("Please provide a Sample Name and either a Sample URL or select a file.");return}if(J){const{baseUrl:A,samplePath:he}=ce(J);W(Y,A,he||Y)}else if(te){const A=l.files[0],he=new FileReader;he.onload=we=>{const Oe=we.target.result;typeof Oe=="string"&&Oe.length>0?W(Y,"./",Oe):alert("Unable to read the selected file. Please try again.")},he.onerror=()=>{alert("Unable to read the selected file. Please try again.")},he.readAsDataURL(A)}});const de=()=>{a&&a.querySelectorAll('option[data-source="specialty-vcsl"]').forEach(Y=>Y.remove())},be=(Y=a?a.value:"")=>{if(!a)return;const J=a.value,te=Y??J;let A=Array.from(a.children).find(Ee=>Ee.tagName==="OPTGROUP"&&Ee.label&&(Ee.label||"").toLowerCase()==="drums"),he=Array.from(a.children).find(Ee=>Ee.tagName==="OPTGROUP"&&Ee.label&&(Ee.label||"").toLowerCase().includes("waveform")),we=Array.from(a.children).find(Ee=>Ee.tagName==="OPTGROUP"&&Ee.label&&(Ee.label||"").toLowerCase().includes("synth")),Oe=Array.from(a.children).find(Ee=>Ee.tagName==="OPTGROUP"&&Ee.label===cN),Se=Array.from(a.children).find(Ee=>Ee.tagName==="OPTGROUP"&&Ee.label===uN),fe=Array.from(a.children).find(Ee=>Ee.tagName==="OPTGROUP"&&Ee.label&&Ee.label==="Sample Packs");A||(A=document.createElement("optgroup"),A.label="Drums",a.insertBefore(A,a.firstChild)),he||(he=document.createElement("optgroup"),he.label="Basic Waveforms",A.nextSibling?a.insertBefore(he,A.nextSibling):a.appendChild(he)),we||(we=document.createElement("optgroup"),we.label="Sample-based Synths",he.nextSibling?a.insertBefore(we,he.nextSibling):a.appendChild(we)),Oe||(Oe=document.createElement("optgroup"),Oe.label=cN,we.nextSibling?a.insertBefore(Oe,we.nextSibling):a.appendChild(Oe)),Se||(Se=document.createElement("optgroup"),Se.label=uN,a.appendChild(Se)),fe||(fe=document.createElement("optgroup"),fe.label="Sample Packs",a.appendChild(fe)),A.innerHTML="";const Te=document.createElement("option");if(Te.value="",Te.textContent="Default",A.appendChild(Te),Array.from(Ri).sort((Ee,De)=>Mb(Ee).localeCompare(Mb(De))).forEach(Ee=>{if(!O1(Ee))return;const De=document.createElement("option");De.value=Ee,De.textContent=Mb(Ee),A.appendChild(De)}),he&&Array.from(he.querySelectorAll("option")).forEach(Ee=>{const De=Ee.value;De&&!O1(De)?(Ee.style.display="none",Ee.hidden=!0):De&&(Ee.style.display="",Ee.hidden=!1)}),we&&Array.from(we.querySelectorAll("option")).forEach(Ee=>{const De=Ee.value;De&&!O1(De)?(Ee.style.display="none",Ee.hidden=!0):De&&(Ee.style.display="",Ee.hidden=!1)}),Oe.innerHTML="",Se.innerHTML="",BC.forEach(({value:Ee,label:De})=>{const ot=document.createElement("option");ot.value=Ee,ot.textContent=De,Ee&&Ee.toLowerCase()==="vcsl"?Se.appendChild(ot):Oe.appendChild(ot)}),de(),Array.isArray(Oh)&&Oh.length>0?Oh.forEach(Ee=>{const De=document.createElement("option");De.value=Ee.optionValue,De.textContent=Ee.label,De.dataset.source="specialty-vcsl",De.dataset.instrument=Ee.value,Se.appendChild(De)}):fd||NBe().then(()=>{be(Y)}).catch(()=>{}),fe||(console.error("❌ samplePacksGroup not found after creation, creating it again..."),fe=document.createElement("optgroup"),fe.label="Sample Packs",a.appendChild(fe)),fe.innerHTML="",typeof rd>"u")console.error("❌ SAMPLE_PACKS constant is not defined!");else if(!Array.isArray(rd))console.error("❌ SAMPLE_PACKS is not an array:",typeof rd);else if(rd.length===0)console.warn("⚠️ SAMPLE_PACKS array is empty");else{const Ee=[...rd].sort((De,ot)=>ot.samples!==De.samples?ot.samples-De.samples:De.label.localeCompare(ot.label));console.log(`📦 Populating ${Ee.length} sample packs in dropdown`),Ee.forEach(De=>{if(!De||!De.value||!De.label){console.warn("⚠️ Invalid sample pack entry:",De);return}const ot=document.createElement("option");ot.value=De.value,ot.textContent=De.label,ot.dataset.source="sample-pack",fe.appendChild(ot)}),console.log(`✅ Added ${Ee.length} sample pack options to dropdown`)}te&&a.querySelector(`option[value="${te}"]`)?a.value=te:J&&a.querySelector(`option[value="${J}"]`)?a.value=J:a.value=""};window.refreshBankOptions=be,be();const ke=document.getElementById("modal-drum-grid-section"),Ce=document.getElementById("modal-drum-grid-timesig"),Ae=(()=>{if(typeof localStorage>"u")return null;try{return localStorage.getItem("drumGridEditorMode")}catch{return null}})(),q={active:!1,totalSteps:0,built:!1,patternEditorEnabled:Ae?Ae==="code":!0,updatingFromPattern:!1,updatingFromGrid:!1,currentBankRows:null,checkboxes:{},numBars:1,currentBar:1,barTokens:[]},Ne=document.getElementById("modal-editor-mode-switch"),Re=document.getElementById("modal-editor-mode-switch-wrapper"),je=e.querySelector(".pattern-label-row");let me=((Ra=e.querySelector("#modal-pattern-snippets-toggle"))==null?void 0:Ra.closest(".modal-presets"))||null,Ye=me?me.querySelector(".pattern-snippet-list"):null,ft=me?me.querySelector(".pattern-snippet-search"):null;const _e=document.getElementById("modal-presets-toggle"),Ge=document.getElementById("modal-presets-content"),pt=document.getElementById("modal-drum-presets"),rt=document.getElementById("modal-tonal-presets"),tn=document.getElementById("modal-sampler-presets"),on=document.getElementById("modal-preview-btn"),xn=Y=>{if(!_e||!Ge)return;_e.setAttribute("aria-expanded",Y.toString()),Ge.classList.toggle("is-open",Y),Ge.setAttribute("aria-hidden",(!Y).toString());const J=_e.closest(".modal-presets");J&&J.classList.toggle("collapsed",!Y)},Gt=()=>{Ge&&Ge.hasAttribute("hidden")&&Ge.removeAttribute("hidden"),xn(!1)},In=()=>{if(!on)return;const Y=Qn("modal-pattern"),J=!!(Y&&Y.trim().length>0);on.disabled=!J};let Ft=null;const jt=()=>{const Y=document.getElementById("modal-my-channels");if(!Y)return;const J=t==null?void 0:t.currentEditingElementId,te=J?Xr.getChannelVersions(J):[];if(!te.length){Y.innerHTML='<div class="modal-presets-empty">No saved channels yet.</div>';return}Y.innerHTML=te.slice(0,12).map((we,Oe)=>{const Se=we.title&&we.title.trim()?we.title.trim():`Saved channel ${Oe+1}`,fe=we.createdAt?new Date(we.createdAt).toLocaleString():"";return`
          <button type="button" class="modal-preset-button" data-my-channel-index="${Oe}">
            <div class="modal-preset-heading-row">
              <strong>${Se}</strong>
            </div>
            ${fe?`<span class="modal-preset-description">${fe}</span>`:""}
          </button>
        `}).join("");const A=document.querySelector('[data-target="modal-my-channels"]'),he=A==null?void 0:A.closest(".modal-presets-group");A&&he&&te.length&&A.getAttribute("aria-expanded")!=="true"&&(A.setAttribute("aria-expanded","true"),Y.classList.add("is-open"),Y.classList.remove("collapsed"),he.classList.remove("collapsed"))},Gn=document.getElementById("modal-my-channels");Gn&&!Gn.dataset.listenerAttached&&(Gn.addEventListener("click",Y=>{const J=Y.target.closest("[data-my-channel-index]");if(!J)return;const te=Number(J.dataset.myChannelIndex);if(Number.isNaN(te))return;const A=t==null?void 0:t.currentEditingElementId;if(!A)return;const we=(Xr.getChannelVersions(A)||[])[te];we!=null&&we.pattern&&(Vn("modal-pattern",we.pattern),In(),Mt(),It())}),Gn.dataset.listenerAttached="true"),window.__strudelChannelHistoryListenerAttached||(window.addEventListener("channel-history-updated",Y=>{var te;const J=(te=Y==null?void 0:Y.detail)==null?void 0:te.elementId;!J||J!==(t==null?void 0:t.currentEditingElementId)||(jt(),typeof Ft=="function"&&Ft().catch(A=>console.warn("⚠️ Unable to refresh snippet tags:",A)))}),window.__strudelChannelHistoryListenerAttached=!0),(async()=>{var fe;jt();const Y=Qn("modal-pattern"),J=ft?ft.value.trim().toLowerCase():"",[te,A]=await Promise.all([PN(Y),_C()]),he=()=>{const Te=this.currentEditingElementId;if(!Te)return[{groupId:"my-channels",heading:"My Channels",isPlaceholder:!0,placeholderText:"Save a channel to see it here."}];const Qe=Xr.getChannelVersions(Te)||[];return Qe.length?Qe.slice(0,12).map((Ee,De)=>({groupId:"my-channels",heading:"My Channels",snippet:Ee.pattern,insertionSnippet:Ee.pattern,className:"pattern-snippet-tag-my-channel",displayLabel:`Saved channel ${De+1}`,secondaryLabel:Ee.createdAt?new Date(Ee.createdAt).toLocaleString():""})):[{groupId:"my-channels",heading:"My Channels",isPlaceholder:!0,placeholderText:"No saved channels yet."}]},we=Te=>[...he(),...Te];if(!me){me=document.createElement("div"),me.className="modal-presets",me.classList.add("modal-presets--beta"),me.setAttribute("aria-disabled","false");const Te=document.createElement("button");Te.type="button",Te.id="modal-pattern-snippets-toggle",Te.className="modal-presets-toggle pattern-snippet-group-heading",Te.setAttribute("aria-expanded","false");const Qe=document.createElement("span");Qe.textContent="Add to pattern (Advanced (beta))",Te.appendChild(Qe),me.appendChild(Te);const Ee=document.createElement("div");Ee.id="modal-pattern-snippets-content",Ee.className="modal-presets-content",Ee.setAttribute("hidden",""),ft=document.createElement("input"),ft.type="search",ft.className="pattern-snippet-search",ft.setAttribute("placeholder","Search tags…"),ft.setAttribute("aria-label","Search snippet tags"),Ee.appendChild(ft),Ye=document.createElement("div"),Ye.className="pattern-snippet-list",Ee.appendChild(Ye),me.appendChild(Ee);const De=Je=>{Te.setAttribute("aria-expanded",Je.toString()),Ee.classList.toggle("is-open",Je),Ee.setAttribute("aria-hidden",(!Je).toString()),me.classList.toggle("collapsed",!Je)};Ee.hasAttribute("hidden")&&Ee.removeAttribute("hidden"),De(!1),Te.dataset.listenerAttached||(Te.addEventListener("click",()=>{const We=!(Te.getAttribute("aria-expanded")==="true");De(We)}),Te.dataset.listenerAttached="true"),(()=>{const Je=(je==null?void 0:je.parentElement)||e.querySelector(".modal-body")||e;if(!Je){e.appendChild(me);return}const We=Array.from(Je.children).filter(Me=>{var Ke;return Me!==me&&((Ke=Me.classList)==null?void 0:Ke.contains("modal-presets"))}),et=We[We.length-1];et?et.insertAdjacentElement("afterend",me):je?je.insertAdjacentElement("afterend",me):Je.appendChild(me)})();let st=(fe=e.querySelector("#modal-samples-toggle"))==null?void 0:fe.closest(".modal-presets");if(st){const Je=st.closest(".form-group"),We=me.parentElement||(Je==null?void 0:Je.parentElement);if(Je&&We)We.insertBefore(Je,me);else if(!Je){const et=document.createElement("div");et.className="form-group",st.parentElement.insertBefore(et,st),et.appendChild(st),(me.parentElement||e).insertBefore(et,me)}}else{const Je=document.createElement("div");Je.className="form-group",st=document.createElement("div"),st.className="modal-presets";const We=document.createElement("button");We.type="button",We.id="modal-samples-toggle",We.className="modal-presets-toggle pattern-snippet-group-heading",We.setAttribute("aria-expanded","false");const et=document.createElement("span");et.textContent="Add samples",We.appendChild(et),st.appendChild(We);const Me=document.createElement("div");Me.id="modal-samples-content",Me.className="modal-presets-content",Me.setAttribute("hidden","");const Ke=document.createElement("div");Ke.className="form-group";const Yt=document.createElement("label");Yt.setAttribute("for","modal-sample-url"),Yt.textContent="Sample URL:";const $t=document.createElement("input");$t.type="text",$t.id="modal-sample-url",$t.placeholder="e.g., https://example.com/sample.wav (optional)",Ke.appendChild(Yt),Ke.appendChild($t),Me.appendChild(Ke);const dn=document.createElement("div");dn.className="form-group";const Rn=document.createElement("label");Rn.setAttribute("for","modal-sample-file"),Rn.textContent="Or Select File:";const On=document.createElement("input");On.type="file",On.id="modal-sample-file",On.setAttribute("accept","audio/*"),dn.appendChild(Rn),dn.appendChild(On),Me.appendChild(dn);const ms=document.createElement("div");ms.className="form-group",ms.id="modal-sample-name-group";const Ps=document.createElement("label");Ps.setAttribute("for","modal-sample-name"),Ps.textContent="Sample Name:";const Jt=document.createElement("div");Jt.className="sample-add-row";const pn=document.createElement("input");pn.type="text",pn.id="modal-sample-name",pn.placeholder='e.g., "dream-pad"';const zt=document.createElement("button");zt.type="button",zt.id="modal-add-sample-btn",zt.className="sample-add-button",zt.textContent="Add";const d=document.createElement("small");d.className="sample-add-hint",d.textContent='Adds a samples(...) block and sound("name") to the pattern.',Jt.appendChild(pn),Jt.appendChild(zt),ms.appendChild(Ps),ms.appendChild(Jt),ms.appendChild(d),Me.appendChild(ms),st.appendChild(Me),Je.appendChild(st);const p=me.parentElement||(je==null?void 0:je.parentElement)||e;p?p.insertBefore(Je,me):e.appendChild(Je);const g=b=>{We.setAttribute("aria-expanded",b.toString()),Me.classList.toggle("is-open",b),Me.setAttribute("aria-hidden",(!b).toString()),st.classList.toggle("collapsed",!b)};Me.hasAttribute("hidden")&&Me.removeAttribute("hidden"),g(!1),We.dataset.listenerAttached||(We.addEventListener("click",()=>{const S=!(We.getAttribute("aria-expanded")==="true");g(S)}),We.dataset.listenerAttached="true")}}if(!Ye){const Te=me.querySelector("#modal-pattern-snippets-content");Ye=Te?Te.querySelector(".pattern-snippet-list"):null}if(!ft){const Te=me.querySelector("#modal-pattern-snippets-content");ft=Te?Te.querySelector(".pattern-snippet-search"):null}this.selectedTagKey||(this.selectedTagKey=null);let Oe=this.selectedTagKey;const Se=(Te,Qe,Ee,De)=>{zr(),Te.innerHTML="";const ot=!!(De&&De.trim().length),st=De||"",Je=new Map,We=[];Qe.forEach(Ke=>{if(Ke&&typeof Ke=="object"&&Ke.isPlaceholder){const g=Ke.groupId||"other",b=Ke.heading||"Other";Je.has(g)||(Je.set(g,{id:g,heading:b,className:Ke.className||"",items:[]}),We.push(Je.get(g))),Je.get(g).items.push(Ke);return}const Yt=typeof Ke=="string"?Ke:Ke.snippet,$t=typeof Ke=="string"?"other":Ke.groupId||"other",dn=typeof Ke=="string"?"":Ke.className||"",Rn=(typeof Ke=="string"?"Other":Ke.heading)||"Other",On=Vi(Yt),ms=Ee.get(On);let Ps=typeof Ke=="object"&&(Ke!=null&&Ke.insertionSnippet)?Ke.insertionSnippet:ON(Yt,ms);On==="bank"&&Ps.includes("display bank(bank)")&&(Ps="bank()");const Jt=Ps.replace(/^[.]+/,"");let pn=typeof Ke=="object"&&(Ke!=null&&Ke.displayLabel)?Ke.displayLabel:Jt;pn.match(/^sound\s*\(\s*["']([^"']+)["']\s*\)/i)||(pn=pn.replace(/\([^)]*\)/g,"()"));const d=pn.toLowerCase(),p=Rn.toLowerCase();st&&!d.includes(st)&&!On.includes(st)&&!p.includes(st)||(Je.has($t)||(Je.set($t,{id:$t,heading:Rn,className:dn,items:[]}),We.push(Je.get($t))),Je.get($t).items.push({snippet:Yt,insertionSnippet:Jt,displayLabel:pn,secondaryLabel:typeof Ke=="object"?Ke.secondaryLabel:"",key:On,className:dn,heading:Rn,referenceEntry:ms}))}),We.sort((Ke,Yt)=>{if(Ke.id==="my-channels"&&Yt.id!=="my-channels")return-1;if(Yt.id==="my-channels"&&Ke.id!=="my-channels")return 1;const $t=(Ke.heading||"").toLowerCase(),dn=(Yt.heading||"").toLowerCase();return $t.localeCompare(dn)});let et=!1;const Me=new Map;if(Qe.forEach(Ke=>{const Yt=typeof Ke=="string"?Ke:Ke.snippet,$t=Vi(Yt);Me.has($t)||Me.set($t,Ke)}),We.forEach(Ke=>{var Jt,pn;if(!Array.isArray(Ke.items)||!Ke.items.length)return;Ke.items.sort((zt,d)=>{const p=(zt.displayLabel||"").toLowerCase(),g=(d.displayLabel||"").toLowerCase();return p<g?-1:p>g?1:0}),et=!0;const Yt=document.createElement("div");Yt.className="pattern-snippet-group",Yt.dataset.groupId=Ke.id;const $t=GBe.has(Ke.id)?XBe:zBe,dn=Wp.has(Ke.id)?Wp.get(Ke.id):$t.has(Ke.id),Rn=ot?!0:dn;Wp.has(Ke.id)||Wp.set(Ke.id,dn);const On=document.createElement("button");On.type="button",On.className="pattern-snippet-group-heading",On.textContent=Ke.heading,(pn=(Jt=Cn==null?void 0:Cn.container)==null?void 0:Jt.dataset)==null||pn.forceOpen;const ms=Ke.id==="chord-progressions"?!0:Rn;On.setAttribute("aria-expanded",ms?"true":"false");const Ps=document.createElement("div");Ps.className="pattern-snippet-group-items",ms||Yt.classList.add("collapsed"),On.addEventListener("click",()=>{var g,b;zr();const zt=Ke.id==="chord-progressions",p=!(zt&&((b=(g=Cn==null?void 0:Cn.container)==null?void 0:g.dataset)==null?void 0:b.forceOpen)==="true"?!1:Yt.classList.toggle("collapsed"));On.setAttribute("aria-expanded",p?"true":"false"),zt||Wp.set(Ke.id,p)}),Ke.items.forEach(zt=>{var C,N,L,V;if(zt&&zt.isPlaceholder){const z=document.createElement("div");z.className="pattern-snippet-placeholder",z.textContent=zt.placeholderText||"No saved channels yet.",Ps.appendChild(z);return}const d=document.createElement("div");d.className="pattern-snippet-item",d.dataset.snippetKey=Vi(zt.snippet);const p=Vi(zt.snippet);let g=df[p];if(!g&&zt.snippet){const z=zt.snippet.match(/\(([a-zA-Z_]+):number\)/),G=zt.snippet.match(/\(([0-9.]+)\)/);if(z||G){let ie=G?parseFloat(G[1]):null;if(z&&!ie){const le=z[1];df[p]?g=df[p]:le.includes("attack")||le.includes("decay")||le.includes("release")?g={min:0,max:2,step:.01,default:.01,unit:"s"}:le.includes("sustain")||le.includes("modulation")||le.includes("env")?g={min:0,max:1,step:.01,default:.5,unit:""}:g={min:0,max:1,step:.01,default:.5,unit:""}}else if(G&&ie!==null){let le=Math.max(0,ie*.1),se=ie*10,K=ie<1?.01:ie<10?.1:1;ie>=20&&ie<=2e4?(le=20,se=2e4,K=10):ie>=0&&ie<=1?(le=0,se=1,K=.01):ie>=-1&&ie<=1&&(le=-1,se=1,K=.01),g={min:le,max:se,step:K,default:ie,unit:""}}}}if(!!g){const z=document.createElement("button");z.type="button";const G=Jk(zt.snippet),ie=!G&&zt.groupId!=="core"&&Kk(zt.snippet),le=[zt.className||"",G,ie?"pattern-snippet-tag-core":""].filter(Boolean).join(" ");z.className=`pattern-snippet-tag ${le}`.trim(),z.dataset.snippet=zt.snippet,z.dataset.insertion=zt.insertionSnippet;let se=zt.displayLabel;const K=se.match(/\(([a-zA-Z_]+):number\)/);K?se=`${K[1]}()`:se.includes('sound("')&&se.includes('")')?se=zt.displayLabel:se=se.replace(/\([^)]*\)/g,"()"),z.textContent=se,z.setAttribute("aria-label",zt.displayLabel);const ve=document.createElement("div");ve.className="slider-row snippet-slider-row",ve.style.display="none",ve.style.width="100%",ve.style.marginTop="8px",ve.style.padding="8px",ve.style.backgroundColor="rgba(102, 126, 234, 0.05)",ve.style.border="1px solid rgba(102, 126, 234, 0.2)",ve.style.borderRadius="4px";const xe=document.createElement("label");xe.textContent=zt.displayLabel.replace(/\(\)$/,""),xe.style.fontSize="0.75rem",xe.style.fontWeight="600",xe.style.color="#4c51bf",xe.style.marginBottom="4px";const $e=document.createElement("div");$e.style.display="flex",$e.style.alignItems="center",$e.style.gap="8px",$e.style.width="100%";const Pe=document.createElement("input");Pe.type="range",Pe.className="snippet-slider",Pe.dataset.snippet=zt.snippet,Pe.dataset.tagKey=p,Pe.style.flex="1";let ze;const ct=p,it=g.unit==="Hz"&&(p==="lpf"||p==="hpf"||p==="bpf"||p==="cutoff"||p==="roomlp");if(it){Pe.min="0",Pe.max="1",Pe.step="0.001";const nn=(()=>{const sa=Qn("modal-pattern")||"",ia=new RegExp(`\\.${ct}\\(([^)]+)\\)`,"g").exec(sa);return ia?ia[1]:null})();let bn=nn?parseFloat(nn):g.default;bn=Math.max(g.min,Math.min(g.max,bn));const ps=Hk(bn);Pe.value=String(ps),ze=document.createElement("span"),ze.className="slider-value",ze.style.minWidth="60px",ze.style.textAlign="right",ze.style.fontSize="0.75rem",ze.style.fontWeight="600",ze.textContent=Math.round(bn)+" "+g.unit,Pe.addEventListener("input",sa=>{const Is=parseFloat(sa.target.value),ia=Yk(Is);Cb(ze,Math.round(ia)+" "+g.unit)})}else{Pe.min=String(g.min),Pe.max=String(g.max),Pe.step=String(g.step);const nn=(()=>{const bn=Qn("modal-pattern")||"",sa=new RegExp(`\\.${ct}\\(([^)]+)\\)`,"g").exec(bn);return sa?sa[1]:null})();Pe.value=String(nn||g.default),ze=document.createElement("span"),ze.className="slider-value",ze.style.minWidth="60px",ze.style.textAlign="right",ze.style.fontSize="0.75rem",ze.style.fontWeight="600",ze.textContent=Pe.value+(g.unit?" "+g.unit:""),Pe.addEventListener("input",bn=>{const ps=bn.target.value;Cb(ze,ps+(g.unit?" "+g.unit:""))})}Pe.addEventListener("change",Dn=>{let nn=Dn.target.value;if(it){const ia=parseFloat(nn),sr=Yk(ia);nn=Math.round(sr),Cb(ze,nn+" "+g.unit)}else Cb(ze,nn+(g.unit?" "+g.unit:""));const bn=Qn("modal-pattern")||"",ps=`.${ct}(${nn})`,sa=new RegExp(`\\.${ct}\\([^)]*\\)`,"g");if(sa.test(bn)){const ia=bn.replace(sa,ps);Vn("modal-pattern",ia)}else{const ia=bn.trim()+ps;Vn("modal-pattern",ia)}}),z.addEventListener("click",Dn=>{if(Dn.stopPropagation(),Dn.preventDefault(),ve.style.display==="none"||ve.style.display===""){ve.style.display="flex",ve.style.flexDirection="column",ve.style.gap="4px";const bn=Qn("modal-pattern")||"",sa=new RegExp(`\\.${ct}\\(([^)]+)\\)`,"g").exec(bn);if(sa){let Is=sa[1];if(it){const ia=parseFloat(Is),sr=Math.max(g.min,Math.min(g.max,ia)),uc=Hk(sr);Pe.value=String(uc),ze.textContent=Math.round(sr)+" "+g.unit}else Pe.value=Is,ze.textContent=Is+(g.unit?" "+g.unit:"")}else{let Is=Pe.value;if(it){const uc=parseFloat(Pe.value);Is=Math.round(Yk(uc))}const ia=`.${ct}(${Is})`,sr=bn.trim()+ia;Vn("modal-pattern",sr)}}});const Rt=((C=zt.referenceEntry)==null?void 0:C.name)||zt.displayLabel.replace(/^[.]+/,"").trim(),_t=tP(zt.referenceEntry),Ot=Array.isArray((N=zt.referenceEntry)==null?void 0:N.params)?zt.referenceEntry.params.map(nP).filter(Boolean).join(`
`):"";z.dataset.tooltipTitle=Rt||zt.displayLabel,z.dataset.tooltipDescription=_t||"",z.dataset.tooltipParams=Ot||"";const qe=()=>sP(z),Ut=()=>zr(z);z.addEventListener("mouseenter",qe),z.addEventListener("mouseleave",Ut),z.addEventListener("focus",qe),z.addEventListener("blur",Ut),$e.appendChild(Pe),$e.appendChild(ze),ve.appendChild(xe),ve.appendChild($e),d.appendChild(z),d.appendChild(ve)}else{const z=document.createElement("button");z.type="button";const G=Jk(zt.snippet),ie=!G&&zt.groupId!=="core"&&Kk(zt.snippet),le=[zt.className||"",G,ie?"pattern-snippet-tag-core":""].filter(Boolean).join(" ");z.className=`pattern-snippet-tag ${le}`.trim(),z.dataset.snippet=zt.snippet,z.dataset.insertion=zt.insertionSnippet,z.textContent=zt.displayLabel,z.setAttribute("aria-label",zt.displayLabel);const se=((L=zt.referenceEntry)==null?void 0:L.name)||zt.displayLabel.replace(/^[.]+/,"").trim(),K=tP(zt.referenceEntry),ve=Array.isArray((V=zt.referenceEntry)==null?void 0:V.params)?zt.referenceEntry.params.map(nP).filter(Boolean).join(`
`):"";z.dataset.tooltipTitle=se||zt.displayLabel,z.dataset.tooltipDescription=K||"",z.dataset.tooltipParams=ve||"";const xe=()=>sP(z),$e=()=>zr(z);z.addEventListener("mouseenter",xe),z.addEventListener("mouseleave",$e),z.addEventListener("focus",xe),z.addEventListener("blur",$e),z.addEventListener("click",$e),d.appendChild(z)}if(zt.secondaryLabel){const z=document.createElement("span");z.className="pattern-snippet-meta",z.textContent=zt.secondaryLabel,d.appendChild(z)}Ps.appendChild(d);const S=Oe||t.selectedTagKey;if(S&&p===S){const z=WBe[p];if(z&&Array.isArray(z)&&z.length>0){const G=document.createElement("div");G.className="pattern-snippet-suggestions";const ie=document.createElement("div");ie.className="pattern-snippet-suggestions-label",ie.textContent="Suggested:",G.appendChild(ie);const le=document.createElement("div");le.className="pattern-snippet-suggestions-list";const K=z.filter(ve=>Me.has(ve)).slice(0,8);K.forEach(ve=>{const xe=Me.get(ve),$e=typeof xe=="string"?xe:xe.snippet,Pe=Vi($e),ze=Ee.get(Pe),it=ON($e,ze).replace(/^[.]+/,"");let Rt=it;Rt=Rt.replace(/\([^)]*\)/g,"()");let _t="other",Ot="";for(const sr of Ff)if(sr.matcher(Pe,$e)){_t=sr.id,Ot=sr.className;break}const qe=document.createElement("button");qe.type="button";const Ut=Jk($e),Dn=!Ut&&_t!=="core"&&Kk($e),nn=[Ot,Ut,Dn?"pattern-snippet-tag-core":"","pattern-snippet-tag-suggested"].filter(Boolean).join(" ");qe.className=`pattern-snippet-tag ${nn}`.trim(),qe.dataset.snippet=$e,qe.dataset.insertion=it,qe.textContent=Rt,qe.setAttribute("aria-label",Rt),qe.addEventListener("click",sr=>{sr.stopPropagation(),!me.classList.contains("disabled")&&q.patternEditorEnabled&&(Oe=Pe,t.selectedTagKey=Pe,zr(qe),f9("modal-pattern",it),typeof Ft=="function"&&Ft().catch(uc=>console.warn("⚠️ Unable to refresh snippet tags:",uc)))});const bn=(ze==null?void 0:ze.name)||Rt.replace(/^[.]+/,"").trim(),ps=tP(ze),sa=Array.isArray(ze==null?void 0:ze.params)?ze.params.map(nP).filter(Boolean).join(`
`):"";qe.dataset.tooltipTitle=bn||Rt,qe.dataset.tooltipDescription=ps||"",qe.dataset.tooltipParams=sa||"";const Is=()=>sP(qe),ia=()=>zr(qe);qe.addEventListener("mouseenter",Is),qe.addEventListener("mouseleave",ia),qe.addEventListener("focus",Is),qe.addEventListener("blur",ia),le.appendChild(qe)}),K.length>0&&(G.appendChild(le),Ps.appendChild(G))}}}),Yt.appendChild(On),Yt.appendChild(Ps),Te.appendChild(Yt)}),!et){const Ke=document.createElement("div");Ke.className="pattern-snippet-empty",Ke.textContent="No tags match your search.",Te.appendChild(Ke)}};Ye&&Se(Ye,we(te),A,J),Ft=async()=>{if(!Ye)return;const Te=await PN(Qn("modal-pattern")),Qe=await _C(),Ee=ft?ft.value.trim().toLowerCase():"";Oe=t.selectedTagKey,Se(Ye,we(Te),Qe,Ee)},t.refreshSnippetButtons=Ft,Ye&&!Ye.dataset.listenersAttached&&(Ye.addEventListener("click",Te=>{const Qe=Te.target.closest(".pattern-snippet-tag");if(!Qe||me.classList.contains("disabled")||!q.patternEditorEnabled)return;const Ee=Qe.closest(".pattern-snippet-item");if(Ee&&Ee.dataset.snippetKey){const st=Ee.dataset.snippetKey;if(df[st])return}const De=Qe.dataset.insertion||Qe.dataset.snippet;if(!De)return;const ot=Vi(De);Oe=ot,t.selectedTagKey=ot,zr(Qe),f9("modal-pattern",De),typeof Ft=="function"&&Ft().catch(st=>console.warn("⚠️ Unable to refresh snippet tags:",st))}),Ye.addEventListener("mouseleave",()=>{zr()}),Ye.addEventListener("scroll",()=>{zr()}),Ye.dataset.listenersAttached="true"),ft&&!ft.dataset.listenerAttached&&(ft.addEventListener("input",()=>{zr(),typeof Ft=="function"&&Ft().catch(Te=>console.warn("⚠️ Unable to refresh snippet tags:",Te))}),ft.dataset.listenerAttached="true")})().catch(Y=>{console.warn("⚠️ Unable to prepare pattern snippet tags:",Y)}),In();const fn=Y=>{try{if(!e)return;this.currentEditingElementId=Y,En(!0),Ne&&(Ne.checked=!1);const J=document.getElementById("modal-element-id");J&&(J.textContent=Y||"");const te=this.loadElementConfig?this.loadElementConfig(Y):null,A=(te==null?void 0:te.bank)||"",he=(te==null?void 0:te.vcslInstrument)||"",we=A==="vcsl"&&he?`${Mv}${he}`:A;be(we),a&&(a.value=we);const Oe=(te==null?void 0:te.pattern)||"";Vn("modal-pattern",Oe||"");const Se=document.getElementById("modal-key-select"),fe=document.getElementById("modal-scale-select");Se&&(te!=null&&te.key||(te==null?void 0:te.key)==="")&&(Se.value=te.key||""),fe&&(te!=null&&te.scale||(te==null?void 0:te.scale)==="")&&(fe.value=te.scale||"chromatic"),$r(),Fa(),In(),It(),jt(),x(),Gt(),e.style.display="block"}catch(J){console.warn("⚠️ Failed to open modal:",J)}},at=()=>{try{if(!e)return;e.style.display="none",oe&&typeof oe.stopSound=="function"&&oe.stopSound("modal-preview")}catch(Y){console.warn("⚠️ Failed to close modal:",Y)}};if(on&&!on.dataset.listenerAttached){let Y=!1;on.addEventListener("click",async()=>{var Qe,Ee,De,ot,st,Je,We;const J="modal-preview";if(oe.trackedPatterns&&oe.trackedPatterns.has(J)){oe.stopSound&&oe.stopSound(J);try{const et=oe.trackedPatterns?oe.trackedPatterns.size:0;Y&&et===0&&oe.stopMasterPattern&&await oe.stopMasterPattern()}catch{}Y=!1,on.textContent="▶ Preview Pattern",on.classList.remove("active"),Os.updateStatus("⏹ Preview stopped");return}q.active&&ln();let A=Qn("modal-pattern");if(!A||!A.trim()){Os.updateStatus("⚠️ No pattern to preview");return}const we=(a?Ad(a.value):{bankValue:""}).bankValue;console.log("🎵 Preview: Original pattern:",A),console.log("🎵 Preview: Bank value:",we);const Oe=[...uf,...md],Se=we&&Oe.includes(we.toLowerCase()),fe=we&&Ri.has(we);if(we&&we!=="")if(fe&&!Se)if(A.includes(".bank("))A=A.replace(/\.bank\(["'][^"']*["']\)/g,`.bank("${we}")`);else if(A.includes(".gain(")||A.includes(".pan(")||A.includes(".fast(")||A.includes(".slow(")){const et=A.match(/(\.(gain|pan|fast|slow)\([^)]*\))/);if(et){const Me=et.index;A=A.slice(0,Me)+`.bank("${we}")`+A.slice(Me)}else A=`${A}.bank("${we}")`}else A=`${A}.bank("${we}")`;else Se&&(A=A.replace(/\.bank\(["'][^"']*["']\)/g,""),A=A.replace(/\.+$/,"").trim());else A=A.replace(/\.bank\(["'][^"']*["']\)/g,""),A=A.replace(/\.+$/,"").trim();console.log("🎵 Preview: Final pattern before preview:",A);const Te=this.currentEditingElementId;if(Te){const et=oe.elementGainValues.get(Te)||.8,Me=oe.elementPanValues.get(Te)||0,Ke=et*.501;oe.elementGainValues.set(J,Ke),oe.elementPanValues.set(J,Me),console.log(`🎵 Preview: Using gain=${Ke} (${et} * 0.501 for -6dB), pan=${Me} from element ${Te}`)}if(we&&we!==""){console.log(`🎵 Preview: Ensuring bank "${we}" is loaded...`);try{await oe.loadBank(we),console.log(`✅ Preview: Bank "${we}" loaded successfully`)}catch(et){console.warn(`⚠️ Preview: Could not load bank "${we}":`,et)}}console.log(`🎵 [PREVIEW] Starting preview for ${J}`),console.log(`🎵 [PREVIEW] Audio ready: ${oe.isAudioReady()}, context: ${!!oe.audioContext}, state: ${((Qe=oe.audioContext)==null?void 0:Qe.state)||"N/A"}`),console.log(`🎵 [PREVIEW] Strudel loaded: ${oe.strudelLoaded}, scheduler: ${!!((Ee=window.strudel)!=null&&Ee.scheduler)}, started: ${((ot=(De=window.strudel)==null?void 0:De.scheduler)==null?void 0:ot.started)||!1}`),Os.updateStatus("▶ Previewing pattern…"),on.textContent="⏹ Stop Preview",on.classList.add("active");try{const et=!!oe.masterActive;console.log("🎵 [PREVIEW] Calling playStrudelPattern..."),await oe.playStrudelPattern(J,A),console.log(`🎵 [PREVIEW] After playStrudelPattern - audioContext state: ${((st=oe.audioContext)==null?void 0:st.state)||"N/A"}`),console.log(`🎵 [PREVIEW] After playStrudelPattern - scheduler started: ${((We=(Je=window.strudel)==null?void 0:Je.scheduler)==null?void 0:We.started)||!1}`),!oe.masterActive&&oe.playMasterPattern&&(console.log("🎵 [PREVIEW] Master not active, starting master..."),await oe.playMasterPattern()),Y=!et&&!!oe.masterActive,Os.updateStatus("✅ Preview playing"),setTimeout(()=>{var Me,Ke,Yt;console.log(`🎵 [PREVIEW] Post-start check - audioContext state: ${((Me=oe.audioContext)==null?void 0:Me.state)||"N/A"}`),console.log(`🎵 [PREVIEW] Post-start check - scheduler started: ${((Yt=(Ke=window.strudel)==null?void 0:Ke.scheduler)==null?void 0:Yt.started)||!1}`),oe.audioContext&&oe.audioContext.state!=="running"&&console.error("❌ [PREVIEW] Audio context not running after preview start!")},500)}catch(et){console.error("❌ [PREVIEW] Preview failed:",et),Os.updateStatus("⚠️ Preview failed – check console for details"),on.textContent="▶ Preview Pattern",on.classList.remove("active")}}),on.dataset.listenerAttached="true"}const Un=Y=>{zr(),ybe("modal-pattern",Y);const J=document.getElementById("modal-pattern");J&&J.classList.toggle("pattern-editor-readonly",!Y),me&&(me.classList.toggle("disabled",!Y),me.setAttribute("aria-disabled",(!Y).toString())),ft&&(ft.disabled=!Y)},nt=()=>{var te;Ne&&(Ne.checked=!q.patternEditorEnabled),Un(q.patternEditorEnabled);const Y=document.getElementById("modal-pattern-editor-wrapper");Y&&(Y.style.display=q.patternEditorEnabled?"block":"none",Mt()),me&&(me.style.display=q.patternEditorEnabled?"block":"none");const J=(te=document.getElementById("modal-time-signature-select"))==null?void 0:te.closest(".form-group");J&&(J.style.display=q.patternEditorEnabled?"none":"block")},Mt=()=>{const Y=document.getElementById("modal-note-conversion-control");if(!Y)return;const J=Qn("modal-pattern"),te=J&&To(J);te&&Fi(J),te?Y.style.display="block":Y.style.display="none"},Vt=document.getElementById("modal-pattern");if(Vt&&!Vt.dataset.previewListenerAttached){const Y=J=>{if(!J||typeof J!="string"||!J.includes("(silence)")||!/\b(note|n)\s*\(/i.test(J))return J;const te=J.trim().startsWith("(silence)"),A=J.trim().match(/^\(silence\)\.\s*([\s\S]+)$/);if(te&&A){const we=A[1].trim().replace(/^\.+/,""),Oe=J.search(/\b(note|n)\s*\(/i);if(Oe>=0){let Se=J.indexOf("(",Oe),fe=0,Te=-1;for(let Qe=Se;Qe<J.length;Qe++){const Ee=J[Qe];if(Ee==="(")fe++;else if(Ee===")"&&(fe--,fe===0)){Te=Qe;break}}if(Te>Se){let Ee=`${J.substring(Oe,Te+1).trim()}`;return we&&!/^\s*$/.test(we)&&(Ee=`${Ee}.${we}`.replace(/\.\.+/g,".").replace(/\.($|\s)/,"$1").trim()),Ee}}}let he=J.replace(/\(silence\)/g,"").replace(/\.\.+/g,".").trim();return he=he.replace(/^\./,"").trim(),he};Vt.addEventListener("input",()=>{const J=Qn("modal-pattern"),te=Y(J);te!==J&&Vn("modal-pattern",te),In(),Mt(),te&&Fi(te)&&(Lr=te),oa=!1,Ba(Qn("modal-pattern"),!0);const A=document.getElementById("modal-key-scale-group"),he=Qn("modal-pattern"),we=he&&To(he),Oe=a?a.value:"",Se=Oe&&md.includes(Oe.toLowerCase());A&&(A.style.display=we||Se?"block":"none"),typeof Ft=="function"&&Ft().catch(fe=>console.warn("⚠️ Unable to refresh snippet tags:",fe))}),Vt.dataset.previewListenerAttached="true"}const En=Y=>{q.patternEditorEnabled=!!Y,Ne&&(Ne.checked=!q.patternEditorEnabled),nt();try{typeof localStorage<"u"&&localStorage.setItem("drumGridEditorMode",q.patternEditorEnabled?"code":"step")}catch{}It()},lt=Y=>{const J=Ad(Y);return J.bankValue&&Ri.has(J.bankValue)},It=()=>{const Y=a?a.value:"",J=!!Y,te=lt(Y),A=q.active&&!q.patternEditorEnabled;FJ("modal",{showTimeSignature:te&&A,showKeyScale:J&&!te,showPiano:J&&!te})},Le=Y=>{Ce&&(Ce.textContent=`${Y.signature} · ${Y.totalSteps} steps`)},qt=()=>{const Y=document.getElementById("modal-drum-grid-bar-count"),J=document.getElementById("modal-drum-grid-bar-arrow-left"),te=document.getElementById("modal-drum-grid-bar-arrow-right");Y&&(q.numBars===1?Y.textContent="1 bar":Y.textContent=`Bar ${q.currentBar} of ${q.numBars}`),J&&(J.style.display=q.numBars>1&&q.currentBar>1?"flex":"none"),te&&(te.style.display=q.numBars>1&&q.currentBar<q.numBars?"flex":"none")},tt=Y=>{if(Y<1||Y>q.numBars)return;const J=document.getElementById("modal-time-signature-select"),te=(J==null?void 0:J.value)||this.currentTimeSignature||"4/4",A=Ni(te);Sn(A),q.currentBar=Y,qt();const he=a?a.value:"";if(q.built=!1,Fn(A,he),!q.barTokens||!q.barTokens.length){const we=Qn("modal-pattern"),Oe=ea(we);Dt(A,Oe||[])}else Zt(A);He(A)},zn=()=>{const Y=document.getElementById("modal-time-signature-select"),J=(Y==null?void 0:Y.value)||this.currentTimeSignature||"4/4",te=Ni(J);Sn(te),q.numBars++,Zt(te);const A=te.totalSteps;q.barTokens[q.numBars-1]=new Array(A).fill("~"),qt(),tt(q.numBars)},mt=()=>{!q.active||q.updatingFromPattern||ln()},Fn=(Y,J)=>{if(!ke)return;const te=J&&gN[J]?gN[J]:Uk;if(!(!q.built||q.totalSteps!==Y.totalSteps||JSON.stringify(q.currentBankRows)!==JSON.stringify(te)))return;const he=document.getElementById("modal-drum-grid-container");if(!he){console.error("❌ ensureDrumGridBuilt: Drum grid container not found!"),console.error("   Looking for: modal-drum-grid-container"),console.error("   Modal exists:",!!ke),ke&&console.error("   Drum grid section children:",Array.from(ke.children).map(we=>we.id||we.className));return}console.log("🔨 Building drum grid with",te.length,"rows,",Y.totalSteps,"steps"),console.log("   Grid container found:",he,"current children:",he.children.length),he.innerHTML="",q.checkboxes={},q.currentBankRows=te,te.forEach(({key:we,label:Oe,sample:Se})=>{const fe=document.createElement("div");fe.className="drum-grid-row",fe.setAttribute("data-row",we);const Te=document.createElement("span");Te.className="drum-grid-row-label",Te.textContent=Oe,fe.appendChild(Te);const Qe=document.createElement("div");Qe.className="drum-grid-steps",Qe.id=`drum-grid-steps-${we}`,Qe.style.gridTemplateColumns=`repeat(${Y.totalSteps}, minmax(18px, 1fr))`,q.checkboxes[we]=[],Y.totalSteps*q.numBars;const Ee=(q.currentBar-1)*Y.totalSteps,De=Ee+Y.totalSteps;for(let ot=Ee;ot<De;ot+=1){const st=document.createElement("div");st.className="drum-grid-step";const Je=ot-Ee;Je>0&&Je%4===0&&st.classList.add("quarter-boundary");const We=document.createElement("input");We.type="checkbox",We.dataset.row=we,We.dataset.step=String(ot),We.dataset.bar=String(q.currentBar),We.addEventListener("change",mt),st.appendChild(We),Qe.appendChild(st),q.checkboxes[we].push(We)}fe.appendChild(Qe),he.appendChild(fe)}),Zt(Y),He(Y),q.totalSteps=Y.totalSteps,q.built=!0},ea=Y=>{if(!Y||typeof Y!="string")return null;const J=Y.match(/(?:s|sound)\(\s*["'`]([^"'`]+)["'`]\s*\)/i);if(!J||!J[1])return null;const te=J[1].trim();return te?te.split(/\s+/).filter(Boolean):null};function Hn(Y){if(!Y)return[];const J=Y.trim();if(!J||J==="~")return[];let te=J;return(te.startsWith("[")&&te.endsWith("]")||te.startsWith("{")&&te.endsWith("}"))&&(te=te.slice(1,-1)),te=te.replace(/[,]+/g," "),te.split(/\s+/).map(A=>A.trim()).filter(Boolean)}function Zt(Y){q.barTokens||(q.barTokens=[]);const J=Y.totalSteps,te=Math.max(1,q.numBars);for(q.barTokens.length>te&&(q.barTokens.length=te);q.barTokens.length<te;)q.barTokens.push(new Array(J).fill("~"));q.barTokens=q.barTokens.map(A=>{const he=Array.isArray(A)?A.slice(0,J):[];for(;he.length<J;)he.push("~");return he})}function Dt(Y,J){const te=Y.totalSteps,A=Math.max(1,q.numBars),he=te*A;let we=Array.isArray(J)?J.slice(0,he):[];we.length<he&&(we=we.concat(new Array(he-we.length).fill("~"))),q.barTokens=[];for(let Oe=0;Oe<A;Oe++){const Se=Oe*te;q.barTokens.push(we.slice(Se,Se+te))}Zt(Y)}function Sn(Y){if(!q.active||q.updatingFromPattern||!q.checkboxes)return;const J=q.currentBar-1;if(J<0)return;Zt(Y);const te=Y.totalSteps,A=q.currentBankRows||Uk,he=new Array(te).fill("~");for(let we=0;we<te;we+=1){const Oe=[];A.forEach(({key:Se,sample:fe})=>{const Te=q.checkboxes[Se],Qe=Te?Te[we]:null;Qe&&Qe.checked&&Oe.push(fe)}),Oe.length===1?he[we]=Oe[0]:Oe.length>1&&(he[we]=`[${Oe.join(" ")}]`)}q.barTokens[J]=he}function He(Y){if(!q.checkboxes)return;Zt(Y);const J=q.currentBar-1,te=q.barTokens[J];if(!te)return;(q.currentBankRows||Uk).forEach(({key:he,sample:we})=>{const Oe=q.checkboxes[he];Oe&&Oe.forEach((Se,fe)=>{if(!Se)return;const Te=Hn(te[fe]);Se.checked=Te.includes(we)})})}function Tt(){return Array.isArray(q.barTokens)?q.barTokens.flat():[]}const kn=(Y,J)=>{if(!ke||!q.active)return;const te=ea(Y),A=J.totalSteps;if(te&&te.length){const he=Math.max(1,Math.ceil(te.length/A));q.numBars!==he&&(q.numBars=he,q.currentBar>q.numBars&&(q.currentBar=q.numBars),qt()),Dt(J,te)}else q.barTokens.length?Zt(J):Dt(J,[]);q.updatingFromPattern=!0,He(J),q.updatingFromPattern=!1},vs=Y=>(Zt(Y),Tt()),ln=()=>{if(!ke||!q.active||!a)return;const Y=document.getElementById("modal-time-signature-select"),J=(Y==null?void 0:Y.value)||this.currentTimeSignature||"4/4",te=Ni(J);Sn(te);const he=vs(te).join(" "),we=a.value,Oe=we&&we!==""?`.bank("${we}")`:"",Se=`s("${he}")${Oe}`;q.updatingFromGrid=!0,Vn("modal-pattern",Se),q.updatingFromGrid=!1},Gs=(Y,J)=>{if(!ke){console.warn("⚠️ Drum grid section not found");return}const te=a?a.value:"";console.log("🎹 Showing drum grid for bank:",te,"metrics:",Y);const A=document.getElementById("modal-drum-grid-container");if(!A){console.error("❌ Drum grid container not found!");return}console.log("✅ Grid container found:",A),Fn(Y,te),Le(Y),ke.style.display="block",q.active=!0,kn(J,Y),qt();const he=A.querySelectorAll(".drum-grid-row");console.log("✅ Drum grid shown, active:",q.active,"rows:",he.length)},na=()=>{ke&&(ke.style.display="none",q.active=!1,q.built=!1,q.numBars=1,q.currentBar=1,qt())};nt();const x=()=>{if(!a){console.log("⚠️ refreshDrumGridForCurrentState: bankSelect not found");return}const Y=a.value,J=lt(Y);if(console.log("🔄 refreshDrumGridForCurrentState: bankValue=",Y,"isDrum=",J,"patternEditorEnabled=",q.patternEditorEnabled),Re&&(Re.style.display=J?"inline-flex":"none"),!J){console.log("📝 Not a drum bank, enabling pattern editor"),En(!0),na(),nt();return}const te=Qn("modal-pattern");if(te&&te.trim(),ea(te),q.patternEditorEnabled){console.log("📝 Pattern editor enabled, hiding drum grid"),na(),nt();return}console.log("🎹 Showing drum grid for drum bank");const A=document.getElementById("modal-time-signature-select"),he=(A==null?void 0:A.value)||this.currentTimeSignature||"4/4",we=Ni(he);console.log("🎹 Calling showDrumGrid with metrics:",we,"pattern:",te),Gs(we,te)},B=document.getElementById("modal-pattern");B&&B.addEventListener("input",()=>{if(!q.active||q.updatingFromGrid||!a||!lt(a.value))return;const Y=document.getElementById("modal-time-signature-select"),J=(Y==null?void 0:Y.value)||this.currentTimeSignature||"4/4",te=Ni(J),A=B.value?B.value.trim():"",he=ea(B.value);if(A&&(!he||he.length===0)){En(!0),na();return}kn(B.value,te)});const T=Y=>{var Oe;if(!Y)return;const J=this.currentEditingElementId;if(J){const Se=document.getElementById("modal-title");Se&&(Se.value=Y.label);const fe=document.getElementById("modal-element-id");if(fe&&(fe.textContent=dh(J)),Ho(J,Y.label),typeof this.saveElementConfig=="function"){const Qe={...((Oe=this.loadElementConfig)==null?void 0:Oe.call(this,J))||{},title:Y.label};this.saveElementConfig(J,Qe,!0)}}const te=typeof Y.bank=="string"?Y.bank:"",A=()=>{if(typeof Y.useNoteNames=="boolean")return Y.useNoteNames;const Se=Y.pattern||"";return Se.includes("note(")||Se.includes('note("')},he=()=>{if(Y.pattern){const Se=document.getElementById("modal-keep-notes-as-written");Se&&(Se.checked=A()),Vn("modal-pattern",Y.pattern.trim()),In()}te&&lt(te)?(En(!1),x()):(En(!0),na(),nt()),B&&B.focus()},we=document.getElementById("modal-keep-notes-as-written");if(we&&(we.checked=A()),a){const Se=te||"";if(a.value!==Se){a.value=Se,a.dispatchEvent(new Event("change",{bubbles:!0})),setTimeout(he,60);return}}he()};Gt();const R=Y=>{if(!Y||!Y.classList.contains("has-tooltip"))return;const J=Y.getBoundingClientRect();if(J.width===0&&J.height===0){requestAnimationFrame(()=>R(Y));return}const te=(e==null?void 0:e.querySelector(".modal-presets-content"))||e,A=te?te.getBoundingClientRect():{left:0,width:window.innerWidth},he=A.left+A.width/2,Oe=J.left+J.width/2>he;Y.classList.toggle("tooltip-align-right",Oe),Y.classList.toggle("tooltip-align-left",!Oe)};let j=null;const H=()=>{j||(j=requestAnimationFrame(()=>{j=null;const Y=e==null?void 0:e.querySelectorAll(".modal-preset-button.has-tooltip");Y==null||Y.forEach(J=>R(J))}))};window.addEventListener("resize",H);const ee=(Y,J)=>{!Y||!Array.isArray(J)||(Y.innerHTML="",J.forEach(te=>{const A=document.createElement("button");A.type="button",A.className="modal-preset-button";const he=te.editorBadge?`<span class="modal-preset-badge${te.editorBadge.toLowerCase().includes("code")?" is-code":te.editorBadge.toLowerCase().includes("step")?" is-step":""}">${te.editorBadge}</span>`:"",we=te.secondaryLabel?`<div class="modal-preset-secondary-row">${te.secondaryLabel}</div>`:"";A.innerHTML=`
          <div class="modal-preset-heading-row">
            <strong>${te.label}</strong>
            ${he}
          </div>
          ${we}
          ${te.description?`<span class="modal-preset-description">${te.description}</span>`:""}
        `,te.tooltip&&(A.classList.add("has-tooltip"),A.setAttribute("data-tooltip",te.tooltip),A.addEventListener("mouseenter",()=>R(A)),A.addEventListener("focus",()=>R(A)),requestAnimationFrame(()=>R(A))),A.addEventListener("click",()=>T(te)),Y.appendChild(A)}),H())},ne=()=>{e.querySelectorAll(".modal-presets-subtoggle").forEach(J=>{const te=J.getAttribute("data-target"),A=te?document.getElementById(te):J.nextElementSibling;if(!A)return;const he=Oe=>{J.setAttribute("aria-expanded",String(Oe)),A.classList.toggle("is-open",Oe);const Se=J.closest(".modal-presets-group");Se&&Se.classList.toggle("collapsed",!Oe)},we=A.classList.contains("is-open");he(we),J.addEventListener("click",()=>{const Oe=J.getAttribute("aria-expanded")!=="true";he(Oe)})})};_e&&Ge&&_e.addEventListener("click",()=>{const J=!(_e.getAttribute("aria-expanded")==="true");xn(J)}),ee(pt,$Be),ee(rt,_J),ee(tn,RBe),ne(),Ne&&!Ne.dataset.listenerAttached&&(Ne.addEventListener("change",Y=>{const J=Y.target.checked?"step":"code";En(J==="code"),x()}),Ne.dataset.listenerAttached="true");const ge=document.getElementById("modal-time-signature-select");ge&&ge.addEventListener("change",Y=>{const J=Y.target.value;if(J&&(this.currentTimeSignature=J,q.active)){const te=Ni(J),A=Qn("modal-pattern"),he=a?a.value:"";Fn(te,he),Le(te),Gs(te,A)}});const Fe=document.getElementById("modal-drum-grid-bar-count"),Be=document.getElementById("modal-drum-grid-add-bar"),wt=document.getElementById("modal-drum-grid-bar-arrow-left"),Nt=document.getElementById("modal-drum-grid-bar-arrow-right");Fe&&(Fe.addEventListener("click",()=>{const Y=q.currentBar<q.numBars?q.currentBar+1:1;tt(Y)}),Fe.style.cursor="pointer",Fe.title="Click to switch between bars"),wt&&wt.addEventListener("click",Y=>{Y.stopPropagation(),q.currentBar>1&&tt(q.currentBar-1)}),Nt&&Nt.addEventListener("click",Y=>{Y.stopPropagation(),q.currentBar<q.numBars&&tt(q.currentBar+1)}),Be&&Be.addEventListener("click",Y=>{Y.stopPropagation(),zn()}),this.applyTimeSignatureToDrumGrid=Y=>{if(!ke||!q.active)return;const J=Ni(Y||"4/4"),te=Qn("modal-pattern"),A=a?a.value:"";Fn(J,A),Le(J),Gs(J,te)};const yn=e.querySelector(".modal-close");yn&&yn.addEventListener("click",at);const ws=document.getElementById("modal-sample-file");ws&&ws.addEventListener("change",Y=>{var we,Oe;const J=Y.target.files&&Y.target.files.length>0?Y.target.files[0]:null,te=(we=document.getElementById("modal-pattern-bank"))==null?void 0:we.closest(".form-group"),A=(Oe=document.getElementById("modal-time-signature-select"))==null?void 0:Oe.closest(".form-group"),he=document.getElementById("modal-title");if(J){if(te&&(te.style.display="none"),A&&(A.style.display="none"),he){const fe=J.name.replace(/\.[^/.]+$/,"");he.value=fe}}else te&&(te.style.display="block")});const gn=document.getElementById("modal-key-select"),_s=document.getElementById("modal-scale-select"),Cn={container:document.getElementById("modal-scale-chord-suggestions"),title:document.getElementById("modal-scale-chord-title"),characteristic:document.getElementById("modal-scale-characteristic"),dropdown:document.getElementById("modal-chord-progression-select")},Pn=(Y,J)=>{try{const te=Y.trim(),A=J.map(we=>we);return Z8.fromRomanNumerals(te,A).filter(Boolean).map((we,Oe)=>!we||we===""?J[Oe]:we)}catch(te){return console.warn("Error converting Roman numerals to chords:",te,"Romans:",J),J.map(A=>A.replace(/b/g,"♭").replace(/#/g,"♯"))}},bs={ionian:{displayName:"Ionian (Major)",colorTone:"7 (natural)",progressions:{"2-chord":[{label:"I – IV",romans:["I","IV"]},{label:"I – V",romans:["I","V"]},{label:"I – vi",romans:["I","vi"]},{label:"Imaj7 – IVmaj7",romans:["Imaj7","IVmaj7"]}],"3-chord":[{label:"I – IV – V",romans:["I","IV","V"]},{label:"I – V – vi",romans:["I","V","vi"]},{label:"I – iii – vi",romans:["I","iii","vi"]},{label:"Imaj7 – vi – ii",romans:["Imaj7","vi","ii"]}],"4-chord":[{label:"I – IV – V – I",romans:["I","IV","V","I"]},{label:"I – vi – IV – V",romans:["I","vi","IV","V"]},{label:"I – V – vi – IV (pop classic)",romans:["I","V","vi","IV"]},{label:"ii – V – I – vi (turnaround)",romans:["ii","V","I","vi"]}]}},dorian:{displayName:"Dorian",colorTone:"natural 6 in a minor scale",progressions:{"2-chord":[{label:"i – IV",romans:["i","IV"]},{label:"i – ii",romans:["i","ii"]},{label:"i – v",romans:["i","v"]}],"3-chord":[{label:"i – IV – v",romans:["i","IV","v"]},{label:"i – ii – IV",romans:["i","ii","IV"]},{label:"i – IV – VII",romans:["i","IV","VII"]},{label:"i – iv – ♭VII",romans:["i","iv","bVII"]}],"4-chord":[{label:"i – IV – i – v",romans:["i","IV","i","v"]},{label:"i – ii – IV – i",romans:["i","ii","IV","i"]},{label:"i – IV – vii° – i",romans:["i","IV","vii°","i"]},{label:"i – iv – i – ♭VII",romans:["i","iv","i","bVII"]}]}},phrygian:{displayName:"Phrygian",colorTone:"♭2 (very dark/tense)",progressions:{"2-chord":[{label:"i – ♭II",romans:["i","bII"]},{label:"i – v",romans:["i","v"]}],"3-chord":[{label:"i – ♭II – i",romans:["i","bII","i"]},{label:"i – v – ♭II",romans:["i","v","bII"]}],"4-chord":[{label:"i – ♭II – vii – i",romans:["i","bII","vii","i"]},{label:"i – v – ♭II – i",romans:["i","v","bII","i"]}]}},lydian:{displayName:"Lydian",colorTone:"♯4 (bright, dreamy, floaty)",progressions:{"2-chord":[{label:"I – II",romans:["I","II"]},{label:"I – Vmaj7",romans:["I","Vmaj7"]}],"3-chord":[{label:"I – II – I",romans:["I","II","I"]},{label:"I – V – II",romans:["I","V","II"]}],"4-chord":[{label:"I – II – V – I",romans:["I","II","V","I"]},{label:"I – vii – II – I",romans:["I","vii","II","I"]}]}},mixolydian:{displayName:"Mixolydian",colorTone:"♭7 (rock-dominant sound)",progressions:{"2-chord":[{label:"I – ♭VII",romans:["I","bVII"]},{label:"I – v",romans:["I","v"]}],"3-chord":[{label:"I – ♭VII – IV",romans:["I","bVII","IV"]},{label:"I – IV – ♭VII",romans:["I","IV","bVII"]}],"4-chord":[{label:"I – ♭VII – IV – I",romans:["I","bVII","IV","I"]},{label:"I – v – ♭VII – IV",romans:["I","v","bVII","IV"]}]}},aeolian:{displayName:"Aeolian (Natural Minor)",colorTone:"♭6",progressions:{"2-chord":[{label:"i – ♭VI",romans:["i","bVI"]},{label:"i – ♭VII",romans:["i","bVII"]},{label:"i – iv",romans:["i","iv"]}],"3-chord":[{label:"i – ♭VII – ♭VI",romans:["i","bVII","bVI"]},{label:"i – iv – ♭VI",romans:["i","iv","bVI"]},{label:"i – iv – v",romans:["i","iv","v"]}],"4-chord":[{label:"i – ♭VII – ♭VI – v",romans:["i","bVII","bVI","v"]},{label:"i – iv – ♭VII – ♭VI",romans:["i","iv","bVII","bVI"]},{label:"i – iv – V – i (minor cadence)",romans:["i","iv","V","i"]}]}},locrian:{displayName:"Locrian",colorTone:"♭2, ♭5 (very unstable)",progressions:{"2-chord":[{label:"iø – ♭II",romans:["iø","bII"]},{label:"iø – v",romans:["iø","v"]}],"3-chord":[{label:"iø – ♭II – iø",romans:["iø","bII","iø"]},{label:"iø – v – ♭II",romans:["iø","v","bII"]}],"4-chord":[{label:"iø – ♭II – v – iø",romans:["iø","bII","v","iø"]}]}},"melodic minor":{displayName:"Melodic Minor (Jazz Minor)",colorTone:"i−maj7",progressions:{"2-chord":[{label:"i−maj7 – IV7",romans:["imMaj7","IV7"]},{label:"i−maj7 – V7",romans:["imMaj7","V7"]}],"3-chord":[{label:"i−maj7 – IV7 – v",romans:["imMaj7","IV7","v"]},{label:"i−maj7 – IV7 – ♭VIImaj7",romans:["imMaj7","IV7","bVIImaj7"]}],"4-chord":[{label:"i−maj7 – ii – IV7 – i−maj7",romans:["imMaj7","ii","IV7","imMaj7"]},{label:"imMaj7 – V7 – i – iv",romans:["imMaj7","V7","i","iv"]}]}},"lydian dominant":{displayName:"Lydian Dominant",colorTone:"♯11",progressions:{"2-chord":[{label:"I7 – II",romans:["I7","II"]}],"3-chord":[{label:"I7 – ♭VII – II",romans:["I7","bVII","II"]}],"4-chord":[{label:"I7 – iiø – ♭VII – I7",romans:["I7","iiø","bVII","I7"]}]}},altered:{displayName:"Altered (Super-Locrian)",colorTone:"V7alt",progressions:{"2-chord":[{label:"V7alt → i",romans:["V7alt","i"]},{label:"V7alt → Imaj7",romans:["V7alt","Imaj7"]}],"3-chord":[{label:"iiø – V7alt – i",romans:["iiø","V7alt","i"]}]}},"harmonic minor":{displayName:"Harmonic Minor",colorTone:"i−maj7",progressions:{"2-chord":[{label:"i – V",romans:["i","V"]}],"3-chord":[{label:"i – iv – V",romans:["i","iv","V"]}],"4-chord":[{label:"i – iv – V – i",romans:["i","iv","V","i"]}]}},"phrygian dominant":{displayName:"Phrygian Dominant",colorTone:"Major chord on ♭II + dominant on V",progressions:{"2-chord":[{label:"i – ♭II",romans:["i","bII"]},{label:"V – i",romans:["V","i"]}],"3-chord":[{label:"V – ♭II – i",romans:["V","bII","i"]}],"4-chord":[{label:"i – ♭II – V – i",romans:["i","bII","V","i"]}]}},"dorian #4":{displayName:"Ukrainian Dorian (Dorian ♯4)",colorTone:"Dorian ♯4",progressions:{"2-chord":[{label:"i – IV",romans:["i","IV"]}],"3-chord":[{label:"i – ♭VII – IV",romans:["i","bVII","IV"]}],"4-chord":[{label:"i – iv – ♭VII – IV",romans:["i","iv","bVII","IV"]}]}},"whole tone":{displayName:"Whole Tone",colorTone:"V7♯5",progressions:{"2-chord":[{label:"V7♯5 – V7♯5",romans:["V7#5","V7#5"]},{label:"V7♯5 – I",romans:["V7#5","I"]}],"3-chord":[{label:"V7♯5 – ♭III+ – V7♯5",romans:["V7#5","bIII+","V7#5"]}]}},"half-whole diminished":{displayName:"Half–Whole Diminished",colorTone:"V7♭9♯11♭13",progressions:{"2-chord":[{label:"V7♭9 – V7♭9",romans:["V7b9","V7b9"]}],"3-chord":[{label:"iiø – V7♭9 – i",romans:["iiø","V7b9","i"]}]}},"whole-half diminished":{displayName:"Whole–Half Diminished",colorTone:"°7",progressions:{"2-chord":[{label:"°7 – °7",romans:["°7","°7"]}],"3-chord":[{label:"°7 – °7 – °7",romans:["°7","°7","°7"]}],"4-chord":[{label:"°7 – ♭III – vi – °7",romans:["°7","bIII","vi","°7"]}]}}},ls=Y=>!Y||typeof Y!="string"?"":Y.replace(/bb(?=\d)/gi,"♭♭").replace(/b(?=\d)/gi,"♭").replace(/#(?=\d)/g,"♯").split(/\s+/).filter(Boolean).map(te=>te.charAt(0).toUpperCase()+te.slice(1)).join(" "),Fa=()=>{const Y=document.getElementById("modal-scale-notes-display");if(!Y)return;const J=gn?(gn.value||"").trim():"",te=_s?(_s.value||"").trim():"";if(!te||te==="chromatic"){Y.textContent="";return}try{const he={major:"major",minor:"minor",chromatic:"chromatic",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic",ionian:"major",aeolian:"minor","melodic minor":"melodic minor","dorian b2":"dorian b2","lydian augmented":"lydian augmented","lydian dominant":"lydian dominant","mixolydian b6":"mixolydian b6","locrian #2":"locrian #2",altered:"altered","harmonic minor":"harmonic minor","locrian #6":"locrian #6","ionian #5":"ionian #5","dorian #4":"dorian #4","phrygian dominant":"phrygian dominant","lydian #2":"lydian #2",ultralocrian:"ultralocrian","harmonic major":"harmonic major","dorian b5":"dorian b5","phrygian b4":"phrygian b4","lydian b3":"lydian b3","mixolydian b2":"mixolydian b2","lydian augmented #2":"lydian augmented #2","locrian bb7":"locrian bb7","major pentatonic":"major pentatonic","suspended pentatonic":"suspended pentatonic","man gong":"man gong",ritusen:"ritusen","minor pentatonic":"minor pentatonic","blues minor pentatonic":"minor pentatonic","major pentatonic mode 3":"major pentatonic",egyptian:"egyptian","whole tone":"whole tone","half-whole diminished":"dominant diminished","whole-half diminished":"diminished","minor blues":"blues"}[te.toLowerCase()]||te.toLowerCase();let we="C";if(J){const Ee=J.trim().match(/^([a-gA-G])([#b]?)/);Ee?we=`${Ee[1].toUpperCase()}${Ee[2]||""}`:we=J.trim()}const Oe=`${we} ${he}`,Se=ji.get(Oe);if(!Se||!Se.notes||Se.notes.length===0){Y.textContent="";return}const Te=Se.notes.map((Ee,De)=>`${Ee.replace(/-?\d+$/,"")} = ${De}`),Qe=`<strong>${we.toLowerCase()}:${he}</strong> ${Te.join(", ")}`;Y.innerHTML=Qe}catch(A){console.warn("Error displaying scale notes:",A),Y.textContent=""}},$r=()=>{if(!Cn.container||!Cn.dropdown)return;const Y=gn?(gn.value||"").trim():"",J=_s?(_s.value||"").trim():"";if(Cn.dropdown.innerHTML='<option value="">Select a progression...</option>',!Y||!J){Cn.container.style.display="none",Cn.container.dataset.state="idle",Cn.container.dataset.forceOpen="false",Cn.title&&(Cn.title.textContent="Select a key and scale to view chord progressions."),Cn.characteristic&&(Cn.characteristic.textContent="");return}const te=J.toLowerCase(),A=bs[te],he=(A==null?void 0:A.displayName)||ls(J);if(Cn.container.style.display="block",Cn.container.dataset.forceOpen="true",Cn.title&&(Cn.title.textContent=`${Y} ${he} Chord Progressions`),!A||!A.progressions){Cn.container.dataset.state="placeholder",Cn.characteristic&&(Cn.characteristic.textContent="No chord progressions available for this scale yet.");return}Cn.container.dataset.state="ready",Cn.characteristic&&(Cn.characteristic.textContent=`Color tone: ${A.colorTone||"N/A"}`),["2-chord","3-chord","4-chord"].forEach(Oe=>{const Se=A.progressions[Oe];if(Se&&Se.length>0){const fe=document.createElement("optgroup");fe.label=Oe.charAt(0).toUpperCase()+Oe.slice(1).replace("-"," "),Se.forEach(Te=>{const Qe=document.createElement("option"),Ee=Pn(Y,Te.romans),De=Ee.length>0?`${Te.label} (${Ee.join(" – ")})`:Te.label;Qe.value=JSON.stringify({romans:Te.romans,label:Te.label}),Qe.textContent=De,fe.appendChild(Qe)}),Cn.dropdown.appendChild(fe)}})};$r(),Fa(),Cn.dropdown&&Cn.dropdown.addEventListener("change",Y=>{const J=Y.target.value;if(!(!J||J===""))try{const te=JSON.parse(J),A=gn?(gn.value||"").trim():"";if(!A){console.warn("No key selected for chord progression");return}const he=Pn(A,te.romans);if(he.length>0){const we=Qn("modal-pattern")||"";let Oe=we;Oe=Oe.replace(/\bn\s*\([^)]*\)\s*\.\s*scale\s*\([^)]*\)(?:\s*\.\s*[a-zA-Z]+\s*\([^)]*\))*/gi,""),Oe=Oe.replace(/\bn\s*\(["'][^"']*["']\)\s*\.\s*scale\s*\(["'][^"']*["']\)(?:\s*\.\s*[a-zA-Z]+\s*\([^)]*\))*/gi,""),Oe=Oe.replace(/^\s*\.\s*/,"").replace(/\s*\.\s*$/,"").trim();const fe=`n().chord("<${he.join(" ")}>").voicing()`,Te=vo(fe,we);Vn("modal-pattern",Te)}}catch(te){console.warn("Error parsing chord progression data:",te)}});const Rr=Y=>{if(typeof Y!="string")return!1;let J=0,te=!1,A="";for(let he=0;he<Y.length;he++){const we=Y[he];if(te){if(we==="\\"){he++;continue}we===A&&(te=!1,A="");continue}if(we==='"'||we==="'"){te=!0,A=we;continue}if(we==="("&&J++,we===")"&&J--,J<0)return!1}return!te&&J===0},Na=(Y,J,te=!1)=>{if(!Y||!Y.trim())return Y;let A=Y.trim();if(te){const he=/\.\s*bank\s*\(\s*["'][^"']*["']\s*\)/gi;he.test(A)?A=A.replace(he,`.bank("${J}")`):A=`${A}.bank("${J}")`}else{const he=/\.\s*(s|sound)\s*\(\s*["'][^"']*["']\s*\)/gi;he.test(A)?A=A.replace(he,`.s("${J}")`):A=`${A}.s("${J}")`}return A},rc=Y=>{if(!Y||typeof Y!="string")return null;const J=Y.match(/\.bank\s*\(\s*["']([^"']+)["']\s*\)/i),te=Y.match(/\.s(?:ound)?\s*\(\s*["']([^"']+)["']\s*\)/i);if(J&&Ri.has(J[1]))return{type:"drum",value:J[1]};if(te){const A=J&&J[1]&&J[1].toLowerCase()==="vcsl"?"vcsl":null;return{type:"synth",value:te[1],extraBank:A}}return J&&J[1]&&J[1].toLowerCase()==="vcsl"?{type:"synth",value:null,extraBank:"vcsl"}:null},Ls=()=>{if(!a)return null;const Y=Ad(a.value||"");if(!Y.bankValue)return null;if(Ri.has(Y.bankValue))return{type:"drum",value:Y.bankValue};const J=(Y.bankValue||"").toLowerCase(),te=f0[J]||Y.bankValue,A=Y.isVcslInstrument&&Y.vcslInstrument||te,he=Y.isVcslInstrument?"vcsl":null;return{type:"synth",value:A,extraBank:he}},oc=(Y,J)=>{if(!J||!Y)return Y;let te=Y;return J.type==="drum"&&J.value?te=Na(te,J.value,!0):J.type==="synth"&&(J.value&&(te=Na(te,J.value,!1)),J.extraBank==="vcsl"&&(/\.bank\s*\(\s*["']vcsl["']\s*\)/i.test(te)||(te=`${te}.bank("vcsl")`))),te},vo=(Y,J)=>{const te=Ls()||rc(J||Y);return oc(Y,te)},er=Y=>{if(!Y||!Y.trim())return"";const J=Y.trim();if(/(\.\s*(bank|s|sound)\s*\()|(\b(note|n|stack|sound)\s*\()/i.test(J))return J;const A=KBe(J);return A?A.trim():""},ic=(Y,J,te,A)=>{let we=(Y||"").trim();const Oe=/\.\s*(s|sound|scale)\s*\(/i.test(we);we?(!we.startsWith("(")||!we.endsWith(")"))&&(Oe||(we=`(${we})`)):we="(silence)";const Se=we.match(/\.\s*scale\s*\(\s*['"]([^'"]+)['"]\s*\)/i),fe=Se?Se[1]:null,Te=we.match(/\.\s*(s|sound)\s*\(\s*["']([^"']+)["']\s*\)/i),Qe=Te?Te[2]:null;let Ee=we.replace(/\.\s*scale\s*\([^)]*\)/gi,"").replace(/\.\s*(s|sound)\s*\([^)]*\)/gi,"");if(te&&te.trim()!==""||J&&J.trim()!==""){const ot=J&&J.trim()!==""?J.trim().toLowerCase():"c",st=te&&te.trim()!==""?te.trim():"major";Ee=`${Ee}.scale('${ot}:${st}')`}else fe&&(Ee=`${Ee}.scale('${fe}')`);return Qe&&(Ee=`${Ee}.s("${Qe}")`),Ee},wo=(Y=!1)=>{$r(),Fa();const J=Qn("modal-pattern"),te=gn&&gn.value||null,A=_s&&_s.value||null;if(console.log(`🎼 applyKeyScaleToPattern called: keyValue="${te}", scaleValue="${A}"`),!te&&!A){console.log("⚠️ No key/scale selected, skipping");return}const he=document.getElementById("modal-keep-notes-as-written"),we=Y||he&&he.checked,Oe=te&&te.trim()!==""?te:null,Se=A&&A.trim()!==""?A:null;if(!J||J.trim()===""||!To(J)){let Je=null;if(J&&J.trim()!==""){const et=J.match(/\.\s*(s|sound)\s*\(\s*["']([^"']+)["']\s*\)/i);et&&et[2]&&(Je=et[2])}if(!Je){const et=document.getElementById("modal-pattern-bank");et&&et.value&&(Je=et.value.toLowerCase())}let We="";if(we){if(typeof this.getAllScaleNotesAsNoteNames=="function"&&(We=this.getAllScaleNotesAsNoteNames(te||"C",A||"chromatic")||""),!We){const et=this.getAllScaleNotesAsPattern(te||"C",A||"chromatic");et&&(We=this.convertNumericPatternToNoteNames(et,te||"C",A||"chromatic"))}}else{const et=this.getAllScaleNotesAsPattern(te||"C",A||"chromatic");if(et){const Me=et.match(/(?:note|n)\s*\(\s*["']([^"']+)["']\s*\)/),Ke=Me?Me[1]:"0 1 2 3 4 5",Yt=`${(te||"C").toLowerCase()}:${A||"chromatic"}`;We=`n("${Ke}").scale('${Yt}')`}}if(!We){console.warn("⚠️ Could not generate scale notes for empty/non-note pattern");return}Je&&(We=`${We}.s("${Je}")`),Rr(We)?(Vn("modal-pattern",We),console.log(`🎼 Inserted scale notes for empty/non-note pattern: ${We}`)):console.warn("⚠️ Generated scale-notes pattern failed quick syntax check; not applying");return}const fe=/\b(note|n)\s*\(/.test(J),Te=/\b(note|n)\s*\(\s*["'][a-g][#b]?/.test(J),Qe=/\b(note|n)\s*\(\s*["'][a-g][#b]?[a-z0-9]*\s*[a-z]/.test(J)||/\b(note|n)\s*\(\s*["'][^"']*\b(maj|min|m|dim|aug|sus|add|7|9|11|13)\b/i.test(J),Ee=/\.\s*chord\s*\(/i.test(J),De=/\b(note|n)\s*\(\s*["'][^"']*[a-g][#b]?\s/.test(J),ot=Te||Qe||De||Ee,st=fe&&!ot&&!Ee;if(ot&&!st){console.log("ℹ️ Pattern uses explicit note names – skipping key/scale rewrite");return}if(fe&&Fi(J)&&!ot&&!Ee){const Je=nr(Oe,Se);if(!Je){console.log("ℹ️ Numeric pattern: no scale selected, skipping rewrite");return}let We=J.replace(/\.\s*scale\s*\((['"])(?:(?=(\\?))\2.)*?\1\)/gi,"");We=We.replace(/\.\s*scale\s*\([^)]*\)/gi,""),We=We.replace(/\.+/g,".").replace(/\.\s*\./g,".").trim(),We=We.replace(/\.+$/,"").trim(),We=zo(We,Je),Vn("modal-pattern",We),Ba(We,!0),console.log(`ℹ️ Numeric pattern updated with scale modifier ${Je}`);return}if(we&&Te&&!Ee){const Je=oe.convertNoteNamesToSemitones(J),We=Oe||"C",et=Se||"chromatic";let Me=Je?this.convertNumericPatternToNoteNames(Je,We,et):null;if((!Me||Me===J)&&(Me=this.convertNumericPatternToNoteNames(J,We,et)),Me&&Me!==J){const Ke=nr(Oe,Se);Ke&&(_r=Ke),oa=!0,Ba(Me,!0),Me=vo(Me,J),Vn("modal-pattern",Me),Oe&&(oe.currentKey=Oe),Se&&(oe.currentScale=Se);const Yt=document.getElementById("modal-pattern");if(Yt){try{Yt.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{Yt.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}}console.log(`🎼 Converted note names to new key/scale: ${Me.substring(0,120)}...`);return}else console.log(`⚠️ Note names unchanged after conversion attempt (key=${We}, scale=${et})`)}if(!Ee&&st){console.log(`🎼 applyKeyScaleToPattern: keyValue="${te}", scaleValue="${A}", pattern="${J.substring(0,50)}..."`);let Je=J;if(Se&&(Oe||Se))if(we){const et=/\b(note|n)\s*\(\s*["'][a-gA-G][#b]?\d/.test(J);if(/\b(n|note)\s*\(\s*["'][\d\s]+["']/.test(J)&&!et)Je=this.convertNumericPatternToNoteNames(J,Oe,Se),console.log(`🎼 Converted numeric pattern to note names in ${Se}: ${Je.substring(0,100)}...`);else if(et){const Ke=oe.convertNoteNamesToSemitones(J);Ke&&Ke!==J?(Je=this.convertNumericPatternToNoteNames(Ke,Oe,Se),console.log(`🎼 Converted note names to ${Se} scale: ${Je.substring(0,100)}...`)):Je=this.convertNumericPatternToNoteNames(J,Oe,Se)}try{const Ke=this.getAllScaleNotesAsPattern(Oe||"C",Se||"chromatic");if(Ke){const $t=this.convertNumericPatternToNoteNames(Ke,Oe||"C",Se||"chromatic").match(/\b(note|n)\s*\(\s*["']([^"']+)["']\s*\)/i),dn=Je.match(/\b(note|n)\s*\(\s*["']([^"']+)["']\s*\)/i);if($t&&dn){const Rn=$t[2];Je=Je.replace(/\b(note|n)\s*\(\s*["'][^"']+["']\s*\)/i,(On,ms)=>`${ms}("${Rn}")`),console.log(`🎼 Resized note names to match scale: ${Rn}`)}}}catch{}}else{const et=ic(J,Oe,Se);if(Rr(et)){Je=et;const Me=Je.match(/\b(n|note)\s*\(\s*["']([^"']+)["']\s*\)/i);if(Me&&Me[2]){const Ke=Me[2].trim().split(/\s+/).map($t=>parseInt($t,10)).filter($t=>!isNaN($t)),Yt=this.getAllScaleNotesAsPattern(Oe||"C",Se||"chromatic");if(Yt){const $t=Yt.match(/\b(n|note)\s*\(\s*["']([^"']+)["']\s*\)/i),dn=$t?$t[2]:null;if(dn){const Rn=dn.trim().split(/\s+/).length;Ke.length!==Rn&&(Je=Je.replace(/\b(n|note)\s*\(\s*["'][^"']+["']\s*\)/i,(On,ms)=>`${ms}("${dn}")`),console.log(`🎼 Resized numeric degrees to match scale (${Rn} steps): ${dn}`))}}}}else Je=J;console.log(`🎼 Semitone mode: upserted scale=${Se} key=${Oe}`)}let We=Je;if(console.log(`🎼 applyKeyScaleToPattern: result="${We?We.substring(0,80):"null"}..."`),console.log(`🎼 Pattern comparison - original length: ${J.length}, new length: ${We?We.length:0}, same: ${We===J}`),!we&&We&&Fi(We)){const et=Oo(We,Oe,Se);et&&et!==We&&(We=et,console.log(`🎼 Normalized numeric pattern to scale degrees (${Se||"chromatic"})`))}if(!we&&We&&(Oe||Se))try{const et=this.getAllScaleNotesAsPattern(Oe||"C",Se||"chromatic"),Me=et&&et.match(/\b(n|note)\s*\(\s*["']([^"']+)["']\s*\)/i),Ke=Me?Me[2]:null,Yt=We.match(/\b(n|note)\s*\(\s*["']([^"']+)["']\s*\)/i);if(Ke&&Yt&&Yt[2]){const On=Yt[2].trim().split(/\s+/);On.every(Jt=>/^-?\d+$/.test(Jt))&&On.every((Jt,pn)=>parseInt(Jt,10)===pn)&&(We=We.replace(/\b(n|note)\s*\(\s*["'][^"']+["']\s*\)/i,(Jt,pn)=>`${pn}("${Ke}")`),console.log(`🎼 Resized numeric degrees to match scale (${Se||"chromatic"}): ${Ke}`))}const $t=Oe||"C",dn=Se||"chromatic",Rn=this.convertNumericPatternToNoteNames(We,$t,dn);if(Rn){const On=oe.convertNoteNamesToScaleDegrees(Rn,$t,dn);On&&Rr(On)&&(We=On,console.log(`🎼 Normalized numeric degrees to scale length (${dn})`))}}catch(et){console.warn("⚠️ Degree resize failed:",et)}if(we&&(Oe||Se)){const et=nr(Oe||null,Se||null);et&&(_r=et)}if(We){!we&&Fi(We)&&(We=Oo(We,Oe,Se),Lr=We),oa=!1,Ba(We,!0),Vn("modal-pattern",We),Oe&&(oe.currentKey=Oe),Se&&(oe.currentScale=Se);const et=document.getElementById("modal-pattern");if(et){try{et.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{et.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}}console.log(`✅ Applied key/scale to pattern immediately: ${We.substring(0,100)}...`)}else console.log("⚠️ Pattern unchanged - applyGlobalSettingsToPattern returned null or undefined")}else if(!Ee&&ot&&!we){const Je=Zo(J);let We=Oe||null,et=Se||null;Je&&(We=We||Je.key||null,et=et||Je.scale||null);const Me=We||"C",Ke=et||"chromatic",Yt=oe.convertNoteNamesToScaleDegrees(J,Me,Ke),dn=(Oo(Yt||J,Oe,Se)||J).replace(/\.\s*scale\s*\([^)]*\)/gi,""),Rn=zo(dn,nr(Oe,Se));if(Rr(Rn)){Vn("modal-pattern",Rn),Oe&&(oe.currentKey=Oe),Se&&(oe.currentScale=Se);const On=document.getElementById("modal-pattern");if(On){try{On.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{On.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}}console.log(`✅ Converted note names to semitone degrees for scale: ${Rn.substring(0,120)}...`)}else console.log("⚠️ Conversion to semitones or upsert failed validation; leaving pattern unchanged")}else console.log(`⚠️ Cannot apply scale - hasChordModifier: ${Ee}, isNumericPattern: ${st}, hasNoteFunction: ${fe}, hasExplicitNotes: ${ot}`)};gn&&!gn.dataset.listenerAttached&&(gn.addEventListener("change",()=>{Fa(),wo(!1)}),gn.dataset.listenerAttached="true"),_s&&!_s.dataset.listenerAttached&&(_s.addEventListener("change",()=>{Fa(),wo(!1)}),_s.dataset.listenerAttached="true"),Fa();const Zo=Y=>{const J=Y.match(/\.\s*scale\s*\(\s*['"]([^'"]+)['"]\s*\)/i);if(J&&J[1]){const te=J[1];if(te.includes(":")){const[A,he]=te.split(":");return{key:A.trim(),scale:he.trim()}}else return{key:"C",scale:te.trim()}}return null};let _r=null,Yn=null,oa=!1,Lr=null,br=null,tr=null,Ir=null;const nr=(Y,J)=>{const te=Y&&Y.trim()!=="",A=J&&J.trim()!=="";if(!te&&!A)return null;const he=te?Y.trim().toLowerCase():"c",we=A?J.trim():"major";return`.scale('${he}:${we}')`},lc=Y=>{if(!Y||typeof Y!="string")return null;const J=Y.match(/\bnote\s*\(\s*["']([^"']+)["']/i);if(!J||!J[1])return null;const A=J[1].match(/([a-gA-G])([#b]?)/);if(!A)return null;const he=A[1].toUpperCase(),we=A[2]?A[2]:"";return`${he}${we}`},Ba=(Y,J=!1)=>{if(!Y||!To(Y)){Yn=null,oa=!1;return}if(oa&&!J)return;if(Fi(Y)){Yn=Y;return}const te=oe.convertNoteNamesToSemitones(Y);te&&Fi(te)&&(Yn=te)},zo=(Y,J)=>{if(!Y||!J||/\.\s*scale\s*\(/i.test(Y))return Y;const te=Y.search(/\.(s|sound)\s*\(/i);if(te!==-1){const he=Y.slice(0,te),we=Y.slice(te);return`${he}${J}${we}`}const A=Y.trim();return A.startsWith("(")&&A.endsWith(")")?`${Y}${J}`:`(${Y})${J}`},Oo=(Y,J,te)=>{if(!Y||!Fi(Y))return Y;const A=!J||!J.trim()||!te||!te.trim()?Zo(Y):null,he=J&&J.trim()||(A==null?void 0:A.key)||"C",we=te&&te.trim()||(A==null?void 0:A.scale)||"chromatic",Oe=this.convertNumericPatternToNoteNames(Y,he,we);if(!Oe)return Y;const Se=oe.convertNoteNamesToScaleDegrees(Oe,he,we);if(Se&&Fi(Se)){const fe=oe.getScaleSemitoneSteps(he,we);if(!fe||fe.length===0)return Se;const Te=fe.length;return(Ee=>{const De=/\b(n|note)\s*\(\s*(["'])([\s\S]*?)\2\s*\)/gi;return Ee.replace(De,(ot,st,Je,We)=>{const et=We.trim().split(/\s+/);if(et.length<=Te)return ot;const Me=et.map($t=>{const dn=parseInt($t,10);return Number.isFinite(dn)?dn:null});if(Me.some($t=>$t===null)||!Me.every(($t,dn)=>$t===dn))return ot;const Yt=Array.from({length:Te},($t,dn)=>String(dn)).join(" ");return`${st}(${Je}${Yt}${Je})`})})(Se)}return Y},ys=(Y,J,te=!1)=>{if(!Y||!To(Y))return Y;const A=oe.patternHasNoteNames&&oe.patternHasNoteNames(Y)||/\b(note|n)\s*\(\s*["'][^"']*[a-gA-G][#b]?\d/i.test(Y),he=oe.patternHasNumericNotePattern&&oe.patternHasNumericNotePattern(Y)||/\b(note|n)\s*\(\s*["'][\d\s\-~<>[\]]+["']/i.test(Y)&&!A;if(J){if(he&&!A){oa||(Yn=Y),oa=!0;const we=Zo(Y),Oe=document.getElementById("modal-key-select"),Se=document.getElementById("modal-scale-select");let fe=Oe&&Oe.value||null,Te=Se&&Se.value||null;return we&&(fe=we.key,Te=we.scale,console.log(`🎼 Using scale from pattern .scale() modifier: ${fe}:${Te}`)),fe||Te?t.convertNumericPatternToNoteNames(Y,fe,Te||"major"):(console.log("⚠️ No key/scale selected, using C major for conversion"),t.convertNumericPatternToNoteNames(Y,"C","major"))}return Y}else{if(A&&!he){if(oa=!1,Yn&&Fi(Yn))return console.log("🔁 Restoring semitone snapshot for note-name toggle"),Yn;const we=Zo(Y);let Oe=null,Se=null;if(we)Oe=we.key,Se=we.scale;else{const Te=lc(Y);if(Te)Oe=Te,Se="chromatic";else{const Qe=document.getElementById("modal-key-select"),Ee=document.getElementById("modal-scale-select");Oe=Qe&&Qe.value||"C",Se=Ee&&Ee.value||"chromatic"}}let fe=oe.convertNoteNamesToScaleDegrees(Y,Oe||"C",Se||"chromatic");if(fe&&fe!==Y){const Te=nr(Oe||"C",Se||"chromatic");return Te&&(fe=zo(fe,Te)),console.log(`🔄 Converted note names to scale degrees: ${fe.substring(0,80)}...`),Ba(fe,!0),Lr=fe,fe}return Y}return Y}},Ct=document.getElementById("modal-keep-notes-as-written");Ct&&!Ct.dataset.listenerAttached&&(Ct.addEventListener("change",()=>{const Y=Qn("modal-pattern"),J=Ct.checked;let te;J&&tr&&Ir&&Y===Ir?(te=tr,console.log("🔁 Restoring original note-name pattern from snapshot")):!J&&br&&Y===br&&Lr?(te=Lr,console.log("🔁 Restoring canonical numeric pattern from snapshot")):te=ys(Y,J,!0);const A=document.getElementById("modal-key-select"),he=document.getElementById("modal-scale-select");if(J?oa=!0:oa=!1,J&&te){const we=/\.\s*scale\s*\((['"])(?:(?=(\\?))\2.)*?\1\)/gi,Oe=te.match(we);if(Oe&&Oe.length>0)_r=Oe[Oe.length-1];else{const Se=nr(A==null?void 0:A.value,he==null?void 0:he.value);Se&&(_r=Se)}te=te.replace(we,""),te=te.replace(/\.\s*scale\s*\([^)]*\)/gi,""),te=te.replace(/\.+/g,".").replace(/\.\s*\./g,".").trim(),te=te.replace(/\.+$/,"").trim(),console.log("🗑️ Removed .scale() modifier when switching to note names")}else!J&&te&&_r&&(te=zo(te,_r));te!==Y?(te=vo(te,Y),Vn("modal-pattern",te),J?(Lr=Y,br=te,oa=!0,tr=null,Ir=null):(br=null,oa=!1,Y&&To(Y)?(tr=Y,Ir=te):(tr=null,Ir=null),Ba(te,!0)),console.log(`🔄 Converted pattern ${J?"to note names":"to semitones"}: ${te.substring(0,100)}...`)):J||(br=null,oa=!1,tr=null,Ir=null,Ba(Y,!0)),It()}),Ct.dataset.listenerAttached="true"),Ba(Qn("modal-pattern"),!0);const Ai=Y=>Y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),yr=(Y,J)=>{if(!Y||!J)return Y;let te=Y.trim();const A=(we,Oe,Se)=>{if(!Se)return we;const fe=new RegExp(`\\s*\\.\\s*${Oe}\\s*\\(\\s*${Ai(Se)}\\s*\\)\\s*$`,"i");let Te=we;for(;fe.test(Te);)Te=Te.replace(fe,"").trim();return Te};return typeof J.gain=="number"&&Math.abs(J.gain-1)>1e-6&&(te=A(te,"gain",J.gain.toFixed(2))),typeof J.pan=="number"&&Math.abs(J.pan)>1e-6&&(te=A(te,"pan",J.pan.toFixed(2))),te=(we=>{let Oe=we;for(;Oe.startsWith("(")&&Oe.endsWith(")");){let Se=0,fe=!0;for(let Te=0;Te<Oe.length;Te++){const Qe=Oe[Te];if(Qe==="("?Se++:Qe===")"&&Se--,Se===0&&Te<Oe.length-1){fe=!1;break}}if(fe&&Se===0)Oe=Oe.slice(1,-1).trim();else break}return Oe})(te.trim()),te},cc=Y=>{if(!Y||typeof Y!="string")return[];let J=Y.trim();if(!J)return[];J.startsWith("[")&&J.endsWith("]")&&(J=J.slice(1,-1).trim());const te=[];let A="",he=0,we=!1,Oe=null,Se=!1,fe=!1;for(let Te=0;Te<J.length;Te++){const Qe=J[Te],Ee=J[Te+1];if(Se){Qe===`
`&&(Se=!1,A+=Qe);continue}if(fe){Qe==="*"&&Ee==="/"&&(fe=!1,Te++);continue}if(!we&&Qe==="/"&&Ee==="/"){Se=!0,Te++;continue}if(!we&&Qe==="/"&&Ee==="*"){fe=!0,Te++;continue}if(we){A+=Qe,Qe===Oe&&J[Te-1]!=="\\"&&(we=!1,Oe=null);continue}if(Qe==='"'||Qe==="'"){we=!0,Oe=Qe,A+=Qe;continue}if(Qe==="("||Qe==="["||Qe==="{"){he++,A+=Qe;continue}if(Qe===")"||Qe==="]"||Qe==="}"){he>0&&he--,A+=Qe;continue}if(Qe===","&&he===0){A.trim()&&te.push(A.trim()),A="";continue}A+=Qe}return A.trim()&&te.push(A.trim()),te.filter(Boolean)};this.syncElementsFromMasterPattern=Y=>{if(!Y||typeof Y!="string"){console.warn("⚠️ Cannot sync elements - master pattern missing or invalid");return}try{const J=/^\/\/\s*Controls Selected Tempo:[^\n]*\n?/im;let te=Y.replace(J,"").trim();if(!te){console.warn("⚠️ Master pattern empty after sanitizing, skipping element sync");return}let A=te;const he=te.indexOf("stack(");if(he!==-1){const Te=te.indexOf("(",he);if(Te!==-1){let Qe=1,Ee=Te+1,De=!1,ot=null;for(;Ee<te.length&&Qe>0;){const st=te[Ee],Je=te[Ee-1];if(De)st===ot&&Je!=="\\"&&(De=!1,ot=null);else if(st==='"'||st==="'")De=!0,ot=st;else if(st==="(")Qe++;else if(st===")"&&(Qe--,Qe===0)){A=te.slice(Te+1,Ee);break}Ee++}}}const we=/\s*\/\*\s*Channel\s+(\d+)\s*\*\/([\s\S]*?)(?=(\s*\/\*\s*Channel\s+\d+\s*\*\/)|$)/g;let Oe;const Se=[],fe=(Te,Qe)=>{var Ke;if(!Number.isFinite(Te)||Te<1)return;let Ee=Qe;if(!Ee||(Ee=Ee.trim(),!Ee)||(Ee=Ee.replace(/^,+/,"").replace(/,+$/,"").trim(),!Ee))return;const De=Ee,ot=`element-${Te}`,st=(Ke=oe.trackedPatterns)==null?void 0:Ke.get(ot),We=yr(Ee,st)||Ee,Me={...this.loadElementConfig(ot)||{},pattern:We};if(this.saveElementConfig(ot,Me,!0),oe.trackedPatterns){const Yt=(st==null?void 0:st.gain)??(typeof oe.getElementGain=="function"?oe.getElementGain(ot):.8),$t=(st==null?void 0:st.pan)??(typeof oe.getElementPan=="function"?oe.getElementPan(ot):0),dn=(st==null?void 0:st.muted)??!1,Rn=(st==null?void 0:st.soloed)??!1;oe.trackedPatterns.set(ot,{rawPattern:De,pattern:We,gain:Yt,pan:$t,muted:dn,soloed:Rn})}if(this.currentEditingElementId===ot){const Yt=Qn("modal-pattern");if((Yt==null?void 0:Yt.trim())!==Ee.trim()&&(Vn("modal-pattern",Ee),console.log(`📝 Updated modal editor for ${ot} to match master pattern`)),q.active&&a&&lt(a.value)){console.log("🔁 Refreshing drum grid to match updated pattern"),q.updatingFromPattern=!0;const dn=document.getElementById("modal-time-signature-select"),Rn=(dn==null?void 0:dn.value)||this.currentTimeSignature||"4/4",On=Ni(Rn);kn(Ee,On),q.updatingFromPattern=!1}}Se.push(ot)};for(;(Oe=we.exec(A))!==null;){const Te=parseInt(Oe[1],10);fe(Te,Oe[2])}Se.length===0&&cc(A).forEach((Qe,Ee)=>{fe(Ee+1,Qe)}),Se.length>0?console.log(`🔄 Synced master pattern changes to elements: ${Se.join(", ")}`):console.warn("ℹ️ No channel definitions found while syncing master pattern")}catch(J){console.warn("⚠️ Failed to sync master pattern to elements:",J)}},setTimeout(()=>{const Y=Qn("modal-pattern"),J=gn&&gn.value||null,te=_s&&_s.value||null;Y&&To(Y)&&(J||te)&&(console.log(`🎼 Applying initial key/scale on modal open: key="${J}", scale="${te}"`),wo())},200),a&&!a.dataset.listenerAttached&&a.addEventListener("change",async Y=>{var On,ms,Ps;const J=Y.target.value,te=Ad(J),A=te.bankValue;console.log("📦 Bank select changed to:",J),a.value!==J&&(a.value=J);const he=this.currentEditingElementId,we=(Jt={},pn=!0)=>{if(!he)return;const d={...this.loadElementConfig(he)||{},...Jt};te.isVcslInstrument?d.vcslInstrument=te.vcslInstrument:"vcslInstrument"in d&&delete d.vcslInstrument,this.saveElementConfig(he,d,pn)};if(A&&A!==""){ws&&(ws.value="");const Jt=(On=document.getElementById("modal-pattern-bank"))==null?void 0:On.closest(".form-group");Jt&&(Jt.style.display="block"),It(),this.selectedTagKey="bank",typeof this.refreshSnippetButtons=="function"&&setTimeout(()=>{this.refreshSnippetButtons().catch(pn=>console.warn("⚠️ Unable to refresh snippet tags:",pn))},100)}else It(),this.selectedTagKey=null,typeof this.refreshSnippetButtons=="function"&&setTimeout(()=>{this.refreshSnippetButtons().catch(Jt=>console.warn("⚠️ Unable to refresh snippet tags:",Jt))},100);if(!he){console.warn("⚠️ No elementId when bank changed");return}const Oe=document.getElementById("status-text"),Se=document.getElementById("modal-pattern"),fe=!!(oe!=null&&oe.masterActive),Te=Qn("modal-pattern");A&&A!==""&&(!Te||Te.trim()==="")&&Se&&(Se.placeholder='Drums and Percussion: s("bd sd rim cp hh oh cr rd ht mt lt sh cb tb perc misc fx"), Synths: note("c3 d3 [e3 f3]")');const Qe=(ms=document.getElementById("modal-sample-url"))==null?void 0:ms.closest(".form-group"),Ee=(Ps=document.getElementById("modal-sample-file"))==null?void 0:Ps.closest(".form-group"),De=document.getElementById("modal-sample-name-group"),ot=A&&A!=="";if(Qe&&(Qe.style.display=ot?"none":"block"),Ee&&(Ee.style.display=ot?"none":"block"),De&&(De.style.display=ot?"none":"block"),!A||A===""){console.log("📦 Using Default (no bank)"),Se.placeholder="",Oe&&(Oe.textContent="📦 Using Default samples");const Jt=document.getElementById("modal-title");Jt.value="Default";const pn=document.getElementById("modal-element-id");pn&&(pn.textContent=dh(he)),Ho(he,"Default"),we({title:"Default",bank:void 0},!1),console.log(`📝 Saved title "Default" for ${he}`);let zt=Qn("modal-pattern").trim(),d=er(zt);d&&d.trim()!==""?(d=d.replace(/\.\s*bank\s*\(\s*["'][^"']*["']\s*\)/gi,""),d=d.replace(/\.+/g,".").replace(/\.\s*\./g,".").trim(),d=d.replace(/\.+$/,"").trim(),Vn("modal-pattern",d),Se.placeholder="",console.log(`📝 Removed .bank() modifier only, preserving pattern: ${d.substring(0,80)}...`)):Se.placeholder="",k()}else{const Jt=(p,g)=>{if(!p||p.trim()==="")return g;let b=p.trim();return!b.endsWith(".")&&!g.startsWith(".")&&(b+="."),b+=g,b.replace(/\.\.+/g,".").replace(/\.\s+\./g,".").trim()};if(te.isVcslInstrument){const p=te.vcslInstrument,g=RJ(p),b=document.getElementById("modal-title");Oe&&(Oe.textContent=`🎙️ VCSL Instrument: ${g}`),b&&(b.value=g);const S=document.getElementById("modal-element-id");S&&(S.textContent=dh(he)),Ho(he,g),we({title:g,bank:"vcsl"},!0);let C=Qn("modal-pattern").trim(),N=er(C);const L=/sound\s*\(\s*["'][^"']*["']\s*\)/i,V=N&&N.trim()!==""?N:"";V?L.test(V)?N=V.replace(L,`sound("${p}")`):V.includes(".s(")?N=V.replace(/\.s\s*\(\s*["'][^"']*["']\s*\)/i,`.sound("${p}")`):N=Jt(V,`sound("${p}")`):N=`sound("${p}")`,N=Na(N,"vcsl",!0),Vn("modal-pattern",N),Se.placeholder="",setTimeout(()=>{Mt()},50);return}const pn=Db(A);if([...uf,...md].includes(pn)||dJ.includes(A)){const p=document.getElementById("modal-title"),g={piano:"Piano",supersaw:"Saw Synth",gtr:"Guitar",casio:"Casio",wood:"Jazz",jazz:"Jazz",metal:"Metal",folkharp:"Folk Harp",superpiano:"Piano"},b=g[pn]||g[A]||pn.charAt(0).toUpperCase()+pn.slice(1);console.log(`🎹 Using synth sound: ${pn}`),Oe&&(Oe.textContent=`🎹 Using ${b}`),p.value=b;const S=document.getElementById("modal-element-id");S&&(S.textContent=dh(he)),Ho(he,b),we({title:b,bank:A}),console.log(`📝 Saved title "${b}" for ${he}`);let C=Qn("modal-pattern").trim(),N=er(C);N&&N.trim()!==""?(console.log(`🎹 BANK CHANGE: Updating .s() modifier only, preserving pattern: ${N.substring(0,80)}...`),N=Na(N,pn,!1),console.log(`🎹 BANK CHANGE: Updated pattern: ${N.substring(0,80)}...`)):(N=`note("c3").s("${pn}")`,console.log(`🎹 BANK CHANGE: Created minimal pattern with .s("${pn}")`)),Vn("modal-pattern",N),Se.placeholder="";const L=document.getElementById("modal-keep-notes-as-written");L&&(L.checked=!0,console.log("🎹 Set note names toggle to ON for synth/waveform")),setTimeout(()=>{Mt()},50);const V=Qn("modal-pattern");console.log(`🎹 BANK CHANGE: Verified textarea contains: ${V}`)}else{console.log(`📦 Loading bank: ${A}`),Oe&&(Oe.textContent=`📦 Loading bank: ${A}...`);const p=["RolandTR808","RolandTR909","RolandTR707","RhythmAce","AkaiLinn","ViscoSpaceDrum","CasioRZ1"],g=[...uf,...md,"insect","wind","east","crow","space","numbers","superpiano","jazz"],b=(A==null?void 0:A.toLowerCase())||"",S=PBe.has(b),C=p.includes(A)||g.includes(b);let N=!1;if(S)try{N=await oe.loadBank(b),N?(console.log(`✅ Specialty sample bank loaded: ${b}`),Oe&&(Oe.textContent=`✅ Bank loaded: ${b}`)):(console.log(`⚠️ Specialty sample bank "${b}" may not be fully loaded`),Oe&&(Oe.textContent=`⚠️ Bank "${b}" may not be available`))}catch(L){console.error(`Error loading specialty bank ${b}:`,L),N=!1,Oe&&(Oe.textContent=`⚠️ Error loading bank: ${b}`)}else if(C)N=!0,console.log(`✅ Built-in bank/waveform: ${A} (no loading required)`),Oe&&(Oe.textContent=`✅ Built-in: ${A}`);else try{N=await oe.loadBank(A),N?(console.log(`✅ Bank loaded: ${A}`),Oe&&(Oe.textContent=`✅ Bank loaded: ${A}`)):(console.log(`⚠️ Bank "${A}" may not be fully loaded, but continuing...`),Oe&&(Oe.textContent=`⚠️ Bank "${A}" may not be available`))}catch(L){console.error(`Error loading bank ${A}:`,L),N=!1,Oe&&(Oe.textContent=`⚠️ Error loading bank: ${A}`)}try{const L=document.getElementById("modal-title");let V;const z=BC.find($e=>$e.value===b);if(A.startsWith("github:")){const $e=rd.find(Pe=>Pe.value===A);if($e)V=$e.label.replace(/\s*\(\d+\)$/,"");else{const Pe=A.match(/github:([^/]+\/[^/]+)/);V=Pe?Pe[1]:A.replace("github:","")}}else Ri.has(A)?V=Mb(A):z?V=z.label:V=A;L.value=V;const G=document.getElementById("modal-element-id");if(G&&(G.textContent=dh(he)),Ho(he,V),!fe&&this.activeElements.has(he)){console.log(`🛑 Stopping sound for ${he} (bank selected, not auto-playing)`),oe.stopSound(he),this.activeElements.delete(he);const $e=document.querySelector(`[data-sound-id="${he}"]`);if($e){const Pe=$e.querySelector(".element-circle");Pe&&Pe.classList.remove("playing"),this.updateStatusDots(he,!0,!1)}}else fe&&console.log(`⏭️ Master running – skipping element stop for ${he}`);const ie=this.loadElementConfig(he)||{};try{const $e={...ie,title:V,bank:A};localStorage.setItem(`elementConfig_${he}`,JSON.stringify($e)),console.log(`📝 Saved title "${V}" and bank "${A}" for ${he} (NOT saved to master)`)}catch($e){console.warn("⚠️ Could not save config:",$e)}let le=Qn("modal-pattern").trim();console.log(`📝 Bank change: currentPattern="${le.substring(0,100)}..."`);let se=er(le);console.log(`📝 Bank change: normalizedPattern="${se.substring(0,100)}..."`);const K=Ri.has(A),ve=uf.includes(b)||md.includes(b)||["sawtooth","square","triangle","sine"].includes(b),xe=A.startsWith("github:");if(console.log(`📝 Bank change: isDrumBank=${K}, isSynthOrWaveform=${ve}, isSpecialSampleBank=${S}, isSamplePack=${xe}, bankValue="${A}"`),xe)Se.placeholder='Select a sample from "Sample Pack Sounds" to insert it into your pattern.',Z(A,V),u!=null&&u.status&&(u.status.textContent="Choose a sample to insert. Each selection adds its own samples() block automatically.");else if(K||S){const $e=S?b:A;if(se&&se.trim()!==""){const Pe=se;se=Na(se,$e,!0),console.log(`📝 Updated .bank("${$e}") modifier`),console.log(`   Before: ${Pe.substring(0,80)}...`),console.log(`   After: ${se.substring(0,80)}...`)}else S?se=`${$e==="mridangam"?'sound("tha dhi thom nam")':'sound("ahh ~ ohh")'}.bank("${$e}")`:se=`s("bd").bank("${$e}")`,console.log(`📝 Created minimal pattern with .bank("${$e}")`);Vn("modal-pattern",se),Se.placeholder="",k(),Vn("modal-pattern",se),Se.placeholder="",k(),k()}else if(ve){const $e=Db(A);if(se&&se.trim()!==""){const ze=se;se=Na(se,$e,!1),console.log(`📝 Updated .s("${$e}") modifier`),console.log(`   Before: ${ze.substring(0,80)}...`),console.log(`   After: ${se.substring(0,80)}...`)}else se=`note("c3").s("${$e}")`,console.log(`📝 Created minimal pattern with .s("${$e}")`);Vn("modal-pattern",se),Se.placeholder="";const Pe=document.getElementById("modal-keep-notes-as-written");Pe&&(Pe.checked=!0,console.log("📝 Set note names toggle to ON for synth/waveform"))}else Se.placeholder='Add a pattern, e.g., sound("bd").bank("CustomBank")',k();console.log(`📝 Final pattern in editor: ${Qn("modal-pattern").substring(0,100)}...`),setTimeout(()=>{Mt()},50)}catch(L){console.error("Error loading bank:",L)}}}const st=document.getElementById("modal-title"),Je=st?st.value.trim():"",We=Se?Se.value.trim():"";let et;We&&We.includes("(")&&We.includes(")")&&(We.match(/\([^)]+\)/g)||[]).some(Jt=>Jt.includes("drum")||Jt.includes("Kick")||Jt.includes("hi-hat"))?et=er(We):et=We;const Me=document.getElementById("modal-keep-notes-as-written"),Ke=Me&&Me.checked;if(et&&To(et)&&!Fi(et)&&!Ke){const Jt=oe.convertPatternForScale(et);Jt&&Jt!==et&&(et=Jt,Se&&Vn("modal-pattern",Jt))}if(!fe&&this.activeElements.has(he)){console.log(`🛑 Stopping sound for ${he} (bank changed, not auto-playing)`),oe.stopSound(he),this.activeElements.delete(he);const Jt=document.querySelector(`[data-sound-id="${he}"]`);if(Jt){const pn=Jt.querySelector(".element-circle");pn&&pn.classList.remove("playing"),this.updateStatusDots(he,!0,!1)}}else fe&&console.log(`⏭️ Master running – skipping element stop for ${he}`);const Yt=document.querySelector(`[data-sound-id="${he}"]`);if(!fe&&Yt){const Jt=Yt.querySelector(".loop-button");Jt&&Jt.classList.contains("active")&&(console.log(`🛑 Stopping loop for ${he} (bank changed)`),Jt.classList.remove("active"),oe.stopSound(he))}const $t=document.getElementById("modal-keep-notes-as-written"),dn=$t?$t.checked:!1;this.saveElementConfig(he,{title:Je||bankDisplayName,pattern:et,bank:A||void 0,keepNotesAsWritten:dn},!0),console.log(`💾 Saved config with bank: ${A}`),oe.invalidatePatternCache(he),et&&(await oe.preEvaluatePattern(he,et),console.log(`📦 Pre-evaluated pattern for ${he} (silent, ready for manual trigger)`));const Rn=A&&Ri.has(A);console.log("📦 Bank change: isDrum=",Rn,"bankValue=",A),Rn?(console.log("📦 Drum bank selected – preserving current editor mode"),q.patternEditorEnabled?x():(q.built=!1,setTimeout(()=>{x()},0))):(console.log("📦 Not a drum bank, using code editor"),En(!0),x())});const $a=e.querySelector(".btn-cancel");$a&&$a.addEventListener("click",()=>{at()});const hl=e.querySelector(".btn-save");hl&&hl.addEventListener("click",()=>{if(!this.currentEditingElementId)return;q.active&&ln();let Y=document.getElementById("modal-title").value.trim();Y==="No sound assigned"&&(Y="");const J=Qn("modal-pattern").trim();let te;J.includes(".bank(")||J.includes(".s(")||J.includes(".synth(")||To(J)||J.includes("sound(")||J.includes("s(")?te=J:te=er(J);const A=document.getElementById("modal-keep-notes-as-written"),he=A?A.checked:!1;if(te&&To(te)){const st=/\b(note|n)\s*\(\s*["'][a-gA-G][#b]?\d/.test(te),Je=/\b(n|note)\s*\(\s*["'][\d\s\-]+["']/.test(te)&&!/\b(note|n)\s*\(\s*["'][a-gA-G]/.test(te);st&&!Je?console.log(`📝 Preserving note names format: ${te.substring(0,50)}...`):Je&&!st&&console.log(`📝 Preserving semitones format: ${te.substring(0,50)}...`)}const we=he,Oe=document.getElementById("modal-key-select"),Se=document.getElementById("modal-scale-select"),fe=Oe&&Oe.value||null,Te=Se&&Se.value||null;if(console.log(`🎼 Modal save: Reading key/scale from dropdowns - elementKey="${fe}", elementScale="${Te}", modalKeySelect.value="${Oe==null?void 0:Oe.value}", modalScaleSelect.value="${Se==null?void 0:Se.value}"`),te&&To(te)&&(fe||Te)){const st=/\b(note|n)\s*\(/.test(te),Je=/\b(note|n)\s*\(\s*["'][a-gA-G][#b]?\d/.test(te),We=/\b(n|note)\s*\(\s*["'][\d\s\-]+["']/.test(te)&&!/\b(note|n)\s*\(\s*["'][a-gA-G]/.test(te),et=/\.\s*chord\s*\(/i.test(te),Me=st&&We&&!Je&&!et;if(console.log(`🎼 Modal save: pattern="${te.substring(0,50)}...", hasNoteFunction=${st}, hasNoteNames=${Je}, hasNumericNotes=${We}, isNumericPattern=${Me}, elementKey="${fe}", elementScale="${Te}"`),!et&&Me&&!Je){const Ke=oe.applyGlobalSettingsToPattern(te,!1,!1,fe||null,Te||null);console.log(`🎼 Modal save: patternWithScale="${Ke?Ke.substring(0,80):"null"}..."`),Ke&&Ke!==te?(te=Ke,Vn("modal-pattern",te),console.log(`✅ Applied key/scale to pattern: ${te.substring(0,80)}...`)):console.log("⚠️ Scale not applied - pattern unchanged or applyGlobalSettingsToPattern returned same pattern")}else console.log(Je?"📝 Pattern uses note names - preserving format, not applying scale modifier":`⚠️ Scale not applied - hasChordModifier=${et}, isNumericPattern=${Me}`)}else console.log(`⚠️ Key/Scale not applied - pattern: ${!!te}, hasNoteCall: ${te?To(te):!1}, elementKey: ${fe}, elementScale: ${Te}`);if(te){let st=te,Je="";for(;Je!==st;)Je=st,st=st.replace(/\.postgain\s*\([^)]*\)/gi,"");st=st.replace(/\.pan\s*\([^)]*\)/gi,""),st=st.replace(/\.fast\s*\([^)]*\)/gi,""),st=st.replace(/\.slow\s*\([^)]*\)/gi,""),st=st.replace(/\.cpm\s*\([^)]*\)/gi,""),st=st.replace(/\.\.+/g,".").trim(),st=st.replace(/\.+$/,"").trim(),st=st.replace(/\s+\./g,"."),te=st}const Qe=document.getElementById("modal-sample-url").value.trim(),Ee=document.getElementById("modal-sample-file"),De=a?a.value:"";let ot=Qe;if(Ee.files&&Ee.files.length>0){const st=Ee.files[0],Je=new FileReader;Je.onload=We=>{ot=We.target.result,this.saveElementConfig(this.currentEditingElementId,{title:Y||this.currentEditingElementId,pattern:te,sampleUrl:ot,fileName:st.name,bank:De||void 0,keepNotesAsWritten:we,key:fe,scale:Te}),at()},Je.readAsDataURL(st)}else this.saveElementConfig(this.currentEditingElementId,{title:Y||this.currentEditingElementId,pattern:te,sampleUrl:ot,bank:De||void 0,keepNotesAsWritten:we,key:fe,scale:Te}),at()}),e.addEventListener("click",Y=>{Y.target===e&&at()}),document.addEventListener("keydown",Y=>{Y.key==="Escape"&&e.style.display!=="none"&&at()}),document.querySelectorAll(".config-button").forEach(Y=>{Y.addEventListener("click",J=>{J.stopPropagation();const te=Y.closest(".sound-element");if(te){const A=te.getAttribute("data-sound-id");A&&fn(A)}})}),this.openConfigModal=fn}isOverlapping(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)}setupAddElementButton(){const e=document.getElementById("add-element-btn");e&&e.addEventListener("click",()=>{this.createNewElement()})}createNewElement(){this.elementCounter++;const e=`element-${this.elementCounter}`,t=this.elementCounter;console.log(`➕ Creating new element: ${e}`);const s=document.querySelector(".elements-container"),a=document.getElementById("add-element-btn");if(!s||!a)return;const r=`
      <div class="sound-element" data-sound-id="${e}">
        <input type="range" class="gain-slider" min="0" max="1" step="0.01" value="0.8" orient="vertical" />
        <div class="volume-label">Gain</div>
        <div class="channel-label">Channel ${t}</div>
        <input type="range" class="pan-slider" min="-1" max="1" step="0.01" value="0" orient="horizontal" />
        <div class="pan-label">Pan</div>
        <div class="status-dots">
          <div class="status-dot loaded-dot" title="Sound Loaded"></div>
          <div class="status-dot playing-dot" title="Playing"></div>
        </div>
        <div class="master-status-indicator" title="Pattern saved to Master">M</div>
        <div class="element-title">Element ${t}</div>
        <div class="element-indicator"></div>
        <div class="element-circle"></div>
        <div class="spiral-visualization-container" style="display: none;"></div>
        <div class="element-controls">
          <button class="solo-button" title="Solo">S</button>
          <button class="mute-button" title="Mute">M</button>
        </div>
        
        <div class="element-action-buttons">
        <button class="config-button">Configure Sound</button>
          <div class="history-button-row">
            <button class="history-button" type="button" data-history-target="channel">Load</button>
            <button class="history-button history-button--primary" type="button" data-history-save="channel">Save</button>
          </div>
        </div>
      </div>
    `;a.insertAdjacentHTML("beforebegin",r);const o=document.querySelector(`[data-sound-id="${e}"]`);if(o){fs.elements.push({id:e,selector:`[data-sound-id="${e}"]`,type:"strudel",pattern:"",description:"No sound assigned"}),this.registerElements([{element:o,elementId:e}]),this.setupElementControlsForElement(o,e);const i=o.querySelector(".config-button");i&&this.openConfigModal&&i.addEventListener("click",u=>{u.stopPropagation(),this.openConfigModal(e)});const l=o.querySelector(".config-button");if(l&&(l.textContent="Configure Sound"),Ho(e,""),this.initializeElementVisualizations(o,e),l){const u=this.loadElementConfig(e);(!u||!u.pattern||u.pattern.trim()==="")&&(l.textContent="Configure Sound")}const c=o.querySelector(".history-button-row");c&&(c.style.display=kl?"":"none"),console.log(`✅ Element ${e} created and fully initialized`)}}setupElementControlsForElement(e,t){if(!e||!t)return;const s=e.querySelector(".gain-slider"),a=e.querySelector(".pan-slider");if(s){const i=parseFloat(s.value);oe.setElementGain(t,i),s.addEventListener("input",l=>{l.stopPropagation();const c=parseFloat(l.target.value);oe.setElementGain(t,c),oe.updateTrackedElementGain(t,c),this.updateMasterPatternDisplay()})}if(a){const i=parseFloat(a.value);oe.setElementPan(t,i),a.addEventListener("input",l=>{l.stopPropagation();const c=parseFloat(l.target.value);oe.setElementPan(t,c),oe.updateTrackedElementPan(t,c),this.updateMasterPatternDisplay()})}const r=e.querySelector(".solo-button");r&&r.addEventListener("click",i=>{i.stopPropagation(),this.handleSoloButton(t,r)});const o=e.querySelector(".mute-button");o&&o.addEventListener("click",i=>{i.stopPropagation(),this.handleMuteButton(t,o)}),this.initializeMidiControls(e,t)}setupCollaborationBridge(){this.collabUnsubscribers.forEach(s=>{try{typeof s=="function"&&s()}catch{}}),this.collabUnsubscribers=[];const e=s=>{var r,o;const a=((r=s==null?void 0:s.mergedStack)==null?void 0:r.trim())||((o=s==null?void 0:s.masterCode)==null?void 0:o.trim());a&&this.queueCollaborativeMaster(a,"snapshot")},t=s=>{var r,o;const a=((r=s==null?void 0:s.mergedStack)==null?void 0:r.trim())||((o=s==null?void 0:s.masterCode)==null?void 0:o.trim());a&&this.queueCollaborativeMaster(a,"socket")};this.collabUnsubscribers.push(NC.on("session:snapshot",e)),this.collabUnsubscribers.push(NC.on("master:updated",t))}queueCollaborativeMaster(e,t="socket"){const s=(e||"").trim();s&&(this.masterUpdateQueue.push({code:s,source:t}),!this.masterUpdateTimer&&(this.masterUpdateTimer=setTimeout(()=>{const a=this.masterUpdateQueue[this.masterUpdateQueue.length-1];this.masterUpdateQueue=[],this.masterUpdateTimer=null,a&&this.applyCollaborativeMaster(a.code,a.source)},150)))}applyCollaborativeMaster(e,t="socket"){var r,o;const s=(e||"").trim();if(!s)return;let a="";try{a=((r=Qn("master-pattern"))==null?void 0:r.trim())||""}catch{const i=document.getElementById("master-pattern");a=((o=i==null?void 0:i.value)==null?void 0:o.trim())||""}if(a!==s){try{Vn("master-pattern",s)}catch{const i=document.getElementById("master-pattern");if(i){i.value=s;const l=new Event("input",{bubbles:!0});i.dispatchEvent(l)}}oe.setMasterPatternCode(s),this.updateMasterPatternDisplay(),t==="socket"?Os.updateStatus("Master updated from collaborators"):t==="snapshot"&&Os.updateStatus("Synced latest master pattern")}}}let kl=null,Bo=null,qp=null,Tb=null,Fb=null,iP=null,Nf=null,Nb=null,Mr=null,Bb=null;function EN(){return Mr||(Mr=new gBe,Mr.init(),kl&&Mr.setCurrentUser(kl),Mr)}async function DN(){Bo=new $Ne,Bo.setOnLoginSuccess(c=>{$b(c)}),Bo.init(),z5(!1);try{const c=await Nh();c?$b(c):od(),Nf=new KNe,Nf.init(),Nf.setOnComplete(u=>{Vo("profile-onboarding-modal"),$b(u)}),Nb=new JNe,Nb.init()}catch{od()}setTimeout(()=>{Eg()},100);const n=document.getElementById("header-login-btn");n&&n.addEventListener("click",()=>{Bo&&Bo.show()});const e=document.getElementById("user-menu-button"),t=document.getElementById("user-menu-dropdown");e&&t&&(e.addEventListener("click",c=>{c.stopPropagation(),t.classList.toggle("active")}),document.addEventListener("click",c=>{!e.contains(c.target)&&!t.contains(c.target)&&t.classList.remove("active")}));const s=document.getElementById("user-logout-btn");s&&s.addEventListener("click",async()=>{try{await _i.logout(),kl=null,od(),t==null||t.classList.remove("active")}catch(c){console.error("Logout error:",c)}});const a=document.getElementById("user-profile-link");a&&a.addEventListener("click",async c=>{if(c.preventDefault(),!kl){alert("Please log in to view your profile."),Bo?Bo.show():od(),t==null||t.classList.remove("active");return}qp&&await qp.show(kl),t==null||t.classList.remove("active")});const r=document.getElementById("user-submissions-link");r&&r.addEventListener("click",async c=>{if(c.preventDefault(),!kl){alert("Please log in to view your submissions."),Bo?Bo.show():od(),t==null||t.classList.remove("active");return}Fb&&await Fb.show(kl),t==null||t.classList.remove("active")});const o=document.getElementById("user-collab-link");o&&o.addEventListener("click",c=>{if(c.preventDefault(),!kl){alert("Please log in to use live collaboration."),Bo?Bo.show():od(),t==null||t.classList.remove("active");return}Mr==null||Mr.show(),t==null||t.classList.remove("active")}),qp=new RNe,qp.init(),qp.setOnUpdate(c=>{$b(c)}),Tb=new _Ne,Tb.init(),Fb=new LNe,Fb.init();const i=document.getElementById("user-profiles-link");i&&i.addEventListener("click",async c=>{c.preventDefault(),Tb&&await Tb.show(),t==null||t.classList.remove("active")});const l=document.getElementById("user-admin-link");l&&l.addEventListener("click",async c=>{c.preventDefault(),Nb&&await Nb.show(),t==null||t.classList.remove("active")}),iP=new INe,iP.init(),window.savePatternDialog=iP,Bb||(Bb=new YNe,Bb.init(),window.settingsPanel=Bb),lP(),cP(),bJ(()=>{lP(),cP(),uP()}),typeof window<"u"&&window.addEventListener("settings-apply-requested",()=>{lP(),cP(),uP()}),uP()}function lP(){const n=qNe(),e=document.body,t=document.querySelector(".bubble-background"),s=document.documentElement;e.classList.remove("page-style-animated","page-style-solid","page-style-image"),n.backgroundType==="solid"?(e.classList.add("page-style-solid"),t&&t.setAttribute("data-hidden","true")):n.backgroundType==="image"?(e.classList.add("page-style-image"),t&&t.setAttribute("data-hidden","true")):(e.classList.add("page-style-animated"),t&&t.removeAttribute("data-hidden")),s.style.setProperty("--page-solid-color",n.backgroundColor||"#05060a"),n.backgroundImage?s.style.setProperty("--page-bg-image",`url(${n.backgroundImage})`):s.style.setProperty("--page-bg-image","none")}function cP(){if(!xs||!xs.chaospadSettings)return;const n=WNe(),e=n.x,t=n.y;xs.chaospadSettings.xAxis={effect:e.effect,min:e.min,max:e.max},xs.chaospadSettings.yAxis={effect:t.effect,min:t.min,max:t.max},e.effect==="cutoff"&&(xs.chaospadSettings.minFrequency=e.min,xs.chaospadSettings.maxFrequency=e.max),t.effect==="resonance"&&(xs.chaospadSettings.minResonance=t.min,xs.chaospadSettings.maxResonance=t.max),console.log("🎛️ Chaospad settings applied:",{xAxis:e.effect,yAxis:t.effect,settings:xs.chaospadSettings})}function uP(){const n=document.getElementById("modal-pattern-bank");if(!n)return;const e=n.value;window.refreshBankOptions&&typeof window.refreshBankOptions=="function"?window.refreshBankOptions(e):Array.from(n.querySelectorAll("optgroup")).forEach(t=>{Array.from(t.querySelectorAll("option")).forEach(s=>{const a=s.value;a&&O1(a)?(s.style.display="",s.hidden=!1):a&&(s.style.display="none",s.hidden=!0),a||(s.style.display="",s.hidden=!1)})})}function QJ(n){const e=document.getElementById("load-master-history-btn"),t=document.getElementById("save-master-history-btn");e&&(e.style.display=n?"":"none"),t&&(t.style.display=n?"":"none"),document.querySelectorAll(".sound-element .history-button-row").forEach(a=>{a.style.display=n?"":"none"})}function z5(n){const e=document.querySelector(".elements-container"),t=document.getElementById("add-element-btn"),s=!n;e&&(e.hidden=s,e.style.display=s?"none":"",e.setAttribute("aria-hidden",s?"true":"false")),t&&(t.hidden=s,t.style.display=s?"none":"",t.setAttribute("aria-hidden",s?"true":"false"))}function n6e(n){const e=document.getElementById("header-login-btn"),t=document.getElementById("user-menu"),s=document.getElementById("user-name"),a=document.getElementById("user-avatar"),r=document.getElementById("user-admin-link"),o=document.getElementById("user-collab-link"),i=document.getElementById("status-text");e&&(e.style.display="none"),t&&(t.style.display="block"),s&&(s.textContent=n.name||n.email),a&&n.avatarUrl?(a.src=n.avatarUrl,a.style.display="block"):a&&(a.style.display="none"),r&&(r.style.display=n.role==="admin"?"block":"none"),o&&(o.style.display=""),QJ(!0),z5(!0),i&&i.textContent==="Login to unlock more features"&&(i.textContent="Ready")}function od(){const n=document.getElementById("header-login-btn"),e=document.getElementById("user-menu"),t=document.getElementById("user-admin-link"),s=document.getElementById("user-collab-link"),a=document.getElementById("status-text");n&&(n.style.display="block"),e&&(e.style.display="none"),t&&(t.style.display="none"),s&&(s.style.display="none"),Mr==null||Mr.setCurrentUser(null),xs==null||xs.setChaospadTiltAvailability(!1),QJ(!1),z5(!1),a&&(a.textContent="Login to unlock more features")}function $b(n){n&&(kl=n,Mr==null||Mr.setCurrentUser(n),xs==null||xs.setChaospadTiltAvailability(!0),Bo&&Bo.hide(),Eg(),n6e(n),!n.profileCompleted&&Nf?Nf.show(n):setTimeout(()=>{Eg()},50))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new AN().init(),wN(),EN(),DN()}):(new AN().init(),wN(),EN(),DN());window.addEventListener("load",()=>{setTimeout(()=>{var o,i,l,c,u,h;const n=((o=document.getElementById("login-modal-overlay"))==null?void 0:o.style.display)!=="none",e=((i=document.getElementById("profile-onboarding-overlay"))==null?void 0:i.style.display)!=="none",t=((l=document.getElementById("user-profile-modal-overlay"))==null?void 0:l.style.display)!=="none",s=((c=document.getElementById("save-pattern-dialog-overlay"))==null?void 0:c.style.display)!=="none",a=((u=document.getElementById("user-profiles-modal-overlay"))==null?void 0:u.style.display)!=="none",r=((h=document.getElementById("admin-user-manager-overlay"))==null?void 0:h.style.display)!=="none";!n&&!e&&!t&&!s&&!a&&!r&&Eg()},200)});export{MOe as $,V6e as A,G6e as B,y1 as C,j6e as D,Cd as E,Z6e as F,AOe as G,_G as H,m0 as I,yt as J,Y2 as K,U6e as L,Q6e as M,mh as N,B6e as O,I6e as P,H6e as Q,q6e as R,DA as S,X6e as T,Ac as U,o6e as V,xZ as W,Ji as X,NOe as Y,W6e as Z,Ol as _,Ou as a,vA as a0,ii as a1,_be as a2,Xn as a3,oi as a4,bm as a5,gm as a6,dt as a7,Lbe as a8,gw as a9,Za as aa,jL as ab,FA as ac,Bbe as ad,ji as b,COe as c,A7 as d,jc as e,D6e as f,T6e as g,F6e as h,hr as i,EOe as j,L6e as k,E6e as l,RG as m,A6e as n,F9e as o,M6e as p,Yd as q,tK as r,GA as s,T9 as t,T9e as u,$6e as v,_6e as w,R6e as x,N6e as y,z6e as z};
