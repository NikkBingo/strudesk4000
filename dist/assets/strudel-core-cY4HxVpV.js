var ku=Object.defineProperty;var _u=(e,t,n)=>t in e?ku(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var xt=(e,t,n)=>_u(e,typeof t!="symbol"?t+"":t,n);typeof BigInt>"u"&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const g=BigInt(0),b=BigInt(1),M=BigInt(2),be=BigInt(3),pe=BigInt(5),J=BigInt(10);BigInt(Number.MAX_SAFE_INTEGER);const Su=2e3,w={s:b,n:g,d:b};function Q(e,t){try{e=BigInt(e)}catch{throw ne()}return e*t}function $(e){return typeof e=="bigint"?e:Math.floor(e)}function z(e,t){if(t===g)throw $e();const n=Object.create(x.prototype);n.s=e<g?-b:b,e=e<g?-e:e;const r=ie(e,t);return n.n=e/r,n.d=t/r,n}const xu=[M*M,M,M*M,M,M*M,M*be,M,M*be];function ue(e){const t=Object.create(null);if(e<=b)return t[e]=b,t;const n=r=>{t[r]=(t[r]||g)+b};for(;e%M===g;)n(M),e/=M;for(;e%be===g;)n(be),e/=be;for(;e%pe===g;)n(pe),e/=pe;for(let r=0,s=M+pe;s*s<=e;){for(;e%s===g;)n(s),e/=s;s+=xu[r],r=r+1&7}return e>b&&n(e),t}const P=function(e,t){let n=g,r=b,s=b;if(e!=null)if(t!==void 0){if(typeof e=="bigint")n=e;else{if(isNaN(e))throw ne();if(e%1!==0)throw Tt();n=BigInt(e)}if(typeof t=="bigint")r=t;else{if(isNaN(t))throw ne();if(t%1!==0)throw Tt();r=BigInt(t)}s=n*r}else if(typeof e=="object"){if("d"in e&&"n"in e)n=BigInt(e.n),r=BigInt(e.d),"s"in e&&(n*=BigInt(e.s));else if(0 in e)n=BigInt(e[0]),1 in e&&(r=BigInt(e[1]));else if(typeof e=="bigint")n=e;else throw ne();s=n*r}else if(typeof e=="number"){if(isNaN(e))throw ne();if(e<0&&(s=-b,e=-e),e%1===0)n=BigInt(e);else{let i=1,a=0,c=1,u=1,p=1,y=1e7;for(e>=1&&(i=10**Math.floor(1+Math.log10(e)),e/=i);c<=y&&p<=y;){let f=(a+u)/(c+p);if(e===f){c+p<=y?(n=a+u,r=c+p):p>c?(n=u,r=p):(n=a,r=c);break}else e>f?(a+=u,c+=p):(u+=a,p+=c),c>y?(n=u,r=p):(n=a,r=c)}n=BigInt(n)*BigInt(i),r=BigInt(r)}}else if(typeof e=="string"){let i=0,a=g,c=g,u=g,p=b,y=b,f=e.replace(/_/g,"").match(/\d+|./g);if(f===null)throw ne();if(f[i]==="-"?(s=-b,i++):f[i]==="+"&&i++,f.length===i+1?c=Q(f[i++],s):f[i+1]==="."||f[i]==="."?(f[i]!=="."&&(a=Q(f[i++],s)),i++,(i+1===f.length||f[i+1]==="("&&f[i+3]===")"||f[i+1]==="'"&&f[i+3]==="'")&&(c=Q(f[i],s),p=J**BigInt(f[i].length),i++),(f[i]==="("&&f[i+2]===")"||f[i]==="'"&&f[i+2]==="'")&&(u=Q(f[i+1],s),y=J**BigInt(f[i+1].length)-b,i+=3)):f[i+1]==="/"||f[i+1]===":"?(c=Q(f[i],s),p=Q(f[i+2],b),i+=3):f[i+3]==="/"&&f[i+1]===" "&&(a=Q(f[i],s),c=Q(f[i+2],s),p=Q(f[i+4],b),i+=5),f.length<=i)r=p*y,s=n=u+r*a+y*c;else throw ne()}else if(typeof e=="bigint")n=e,s=e,r=b;else throw ne();if(r===g)throw $e();w.s=s<g?-b:b,w.n=n<g?-n:n,w.d=r<g?-r:r};function Tu(e,t,n){let r=b;for(;t>g;e=e*e%n,t>>=b)t&b&&(r=r*e%n);return r}function qu(e,t){for(;t%M===g;t/=M);for(;t%pe===g;t/=pe);if(t===b)return g;let n=J%t,r=1;for(;n!==b;r++)if(n=n*J%t,r>Su)return g;return BigInt(r)}function Au(e,t,n){let r=b,s=Tu(J,n,t);for(let i=0;i<300;i++){if(r===s)return BigInt(i);r=r*J%t,s=s*J%t}return 0}function ie(e,t){if(!e)return t;if(!t)return e;for(;;){if(e%=t,!e)return t;if(t%=e,!t)return e}}function x(e,t){if(P(e,t),this instanceof x)e=ie(w.d,w.n),this.s=w.s,this.n=w.n/e,this.d=w.d/e;else return z(w.s*w.n,w.d)}const $e=function(){return new Error("Division by Zero")},ne=function(){return new Error("Invalid argument")},Tt=function(){return new Error("Parameters must be integer")};x.prototype={s:b,n:g,d:b,abs:function(){return z(this.n,this.d)},neg:function(){return z(-this.s*this.n,this.d)},add:function(e,t){return P(e,t),z(this.s*this.n*w.d+w.s*this.d*w.n,this.d*w.d)},sub:function(e,t){return P(e,t),z(this.s*this.n*w.d-w.s*this.d*w.n,this.d*w.d)},mul:function(e,t){return P(e,t),z(this.s*w.s*this.n*w.n,this.d*w.d)},div:function(e,t){return P(e,t),z(this.s*w.s*this.n*w.d,this.d*w.n)},clone:function(){return z(this.s*this.n,this.d)},mod:function(e,t){if(e===void 0)return z(this.s*this.n%this.d,b);if(P(e,t),g===w.n*this.d)throw $e();return z(this.s*(w.d*this.n)%(w.n*this.d),w.d*this.d)},gcd:function(e,t){return P(e,t),z(ie(w.n,this.n)*ie(w.d,this.d),w.d*this.d)},lcm:function(e,t){return P(e,t),w.n===g&&this.n===g?z(g,b):z(w.n*this.n,ie(w.n,this.n)*ie(w.d,this.d))},inverse:function(){return z(this.s*this.d,this.n)},pow:function(e,t){if(P(e,t),w.d===b)return w.s<g?z((this.s*this.d)**w.n,this.n**w.n):z((this.s*this.n)**w.n,this.d**w.n);if(this.s<g)return null;let n=ue(this.n),r=ue(this.d),s=b,i=b;for(let a in n)if(a!=="1"){if(a==="0"){s=g;break}if(n[a]*=w.n,n[a]%w.d===g)n[a]/=w.d;else return null;s*=BigInt(a)**n[a]}for(let a in r)if(a!=="1"){if(r[a]*=w.n,r[a]%w.d===g)r[a]/=w.d;else return null;i*=BigInt(a)**r[a]}return w.s<g?z(i,s):z(s,i)},log:function(e,t){if(P(e,t),this.s<=g||w.s<=g)return null;const n=Object.create(null),r=ue(w.n),s=ue(w.d),i=ue(this.n),a=ue(this.d);for(const p in s)r[p]=(r[p]||g)-s[p];for(const p in a)i[p]=(i[p]||g)-a[p];for(const p in r)p!=="1"&&(n[p]=!0);for(const p in i)p!=="1"&&(n[p]=!0);let c=null,u=null;for(const p in n){const y=r[p]||g,f=i[p]||g;if(y===g){if(f!==g)return null;continue}let S=f,k=y;const A=ie(S,k);if(S/=A,k/=A,c===null&&u===null)c=S,u=k;else if(S*u!==c*k)return null}return c!==null&&u!==null?z(c,u):null},equals:function(e,t){return P(e,t),this.s*this.n*w.d===w.s*w.n*this.d},lt:function(e,t){return P(e,t),this.s*this.n*w.d<w.s*w.n*this.d},lte:function(e,t){return P(e,t),this.s*this.n*w.d<=w.s*w.n*this.d},gt:function(e,t){return P(e,t),this.s*this.n*w.d>w.s*w.n*this.d},gte:function(e,t){return P(e,t),this.s*this.n*w.d>=w.s*w.n*this.d},compare:function(e,t){P(e,t);let n=this.s*this.n*w.d-w.s*w.n*this.d;return(g<n)-(n<g)},ceil:function(e){return e=J**BigInt(e||0),z($(this.s*e*this.n/this.d)+(e*this.n%this.d>g&&this.s>=g?b:g),e)},floor:function(e){return e=J**BigInt(e||0),z($(this.s*e*this.n/this.d)-(e*this.n%this.d>g&&this.s<g?b:g),e)},round:function(e){return e=J**BigInt(e||0),z($(this.s*e*this.n/this.d)+this.s*((this.s>=g?b:g)+M*(e*this.n%this.d)>this.d?b:g),e)},roundTo:function(e,t){P(e,t);const n=this.n*w.d,r=this.d*w.n,s=n%r;let i=$(n/r);return s+s>=r&&i++,z(this.s*i*w.n,w.d)},divisible:function(e,t){return P(e,t),w.n===g?!1:this.n*w.d%(w.n*this.d)===g},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(e=15){let t=this.n,n=this.d,r=qu(t,n),s=Au(t,n,r),i=this.s<g?"-":"";if(i+=$(t/n),t%=n,t*=J,t&&(i+="."),r){for(let a=s;a--;)i+=$(t/n),t%=n,t*=J;i+="(";for(let a=r;a--;)i+=$(t/n),t%=n,t*=J;i+=")"}else for(let a=e;t&&a--;)i+=$(t/n),t%=n,t*=J;return i},toFraction:function(e=!1){let t=this.n,n=this.d,r=this.s<g?"-":"";if(n===b)r+=t;else{const s=$(t/n);e&&s>g&&(r+=s,r+=" ",t%=n),r+=t,r+="/",r+=n}return r},toLatex:function(e=!1){let t=this.n,n=this.d,r=this.s<g?"-":"";if(n===b)r+=t;else{const s=$(t/n);e&&s>g&&(r+=s,t%=n),r+="\\frac{",r+=t,r+="}{",r+=n,r+="}"}return r},toContinued:function(){let e=this.n,t=this.d;const n=[];for(;t;){n.push($(e/t));const r=e%t;e=t,t=r}return n},simplify:function(e=.001){const t=BigInt(Math.ceil(1/e)),n=this.abs(),r=n.toContinued();for(let s=1;s<r.length;s++){let i=z(r[s-1],b);for(let c=s-2;c>=0;c--)i=i.inverse().add(r[c]);let a=i.sub(n);if(a.n*t<a.d)return i.mul(this.s)}return this}};const Ve="strudel.log";let zu=1e3,qt,At;function Ye(e,t="cyclist"){j(`[${t}] error: ${e.message}`)}function j(e,t,n={}){let r=performance.now();qt===e&&r-At<zu||(qt=e,At=r,console.log(`%c${e}`,"background-color: black;color:white;border-radius:15px"),typeof document<"u"&&typeof CustomEvent<"u"&&document.dispatchEvent(new CustomEvent(Ve,{detail:{message:e,type:t,data:n}})))}j.key=Ve;const Bu=e=>/^[a-gA-G][#bs]*[0-9]$/.test(e),Be=e=>/^[a-gA-G][#bsf]*-?[0-9]?$/.test(e),Ct=e=>{var s;if(typeof e!="string")return[];const[t,n="",r]=((s=e.match(/^([a-gA-G])([#bsf]*)(-?[0-9]*)$/))==null?void 0:s.slice(1))||[];return t?[t,n,r?Number(r):void 0]:[]},Cu={c:0,d:2,e:4,f:5,g:7,a:9,b:11},Ou={"#":1,b:-1,s:1,f:-1},xe=(e,t=3)=>{const[n,r,s=t]=Ct(e);if(!n)throw new Error('not a note: "'+e+'"');const i=Cu[n.toLowerCase()],a=(r==null?void 0:r.split("").reduce((c,u)=>c+Ou[u],0))||0;return(Number(s)+1)*12+i+a},ve=e=>Math.pow(2,(e-69)/12)*440,Ot=e=>12*Math.log(e/440)/Math.LN2+69,Nu=(e,t)=>{if(typeof e!="object")throw new Error("valueToMidi: expected object value");let{freq:n,note:r}=e;if(typeof n=="number")return Ot(n);if(typeof r=="string")return xe(r);if(typeof r=="number")return r;if(!t)throw new Error("valueToMidi: expected freq or note to be set");return t},Eu=(e,t)=>(e-t)*1e3,Nt=e=>ve(typeof e=="number"?e:xe(e)),Pu=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Mu=e=>{const t=Math.floor(e/12)-1;return Pu[e%12]+t},Te=(e,t)=>(e%t+t)%t,Et=e=>e.reduce((t,n)=>t+n)/e.length;function Pt(e,t=0){return isNaN(Number(e))?(j(`"${e}" is not a number, falling back to ${t}`,"warning"),t):e}const Iu=(e,t)=>Te(Math.round(Pt(e??0,0)),t),Wu=e=>{let{value:t,context:n}=e,r=t;if(typeof r=="object"&&!Array.isArray(r)&&(r=r.note||r.n||r.value,r===void 0))throw new Error(`cannot find a playable note for ${JSON.stringify(t)}`);if(typeof r=="number"&&n.type!=="frequency")r=ve(e.value);else if(typeof r=="number"&&n.type==="frequency")r=e.value;else if(typeof r!="string"||!Be(r))throw new Error("not a note: "+JSON.stringify(r));return r},ju=e=>{let{value:t,context:n}=e;if(typeof t=="object")return t.freq?t.freq:Nt(t.note||t.n||t.value);if(typeof t=="number"&&n.type!=="frequency")t=ve(e.value);else if(typeof t=="string"&&Be(t))t=ve(xe(e.value));else if(typeof t!="number")throw new Error("not a note or frequency: "+t);return t},Mt=(e,t)=>e.slice(t).concat(e.slice(0,t)),It=(...e)=>e.reduce((t,n)=>(...r)=>t(n(...r)),t=>t),Ju=(...e)=>It(...e.reverse()),de=e=>e.filter(t=>t!=null),U=e=>[].concat(...e),le=e=>e,Lu=(e,t)=>e,qe=(e,t)=>Array.from({length:t-e+1},(n,r)=>r+e);function v(e,t,n=e.length){const r=function s(...i){if(i.length>=n)return e.apply(this,i);{const a=function(...c){return s.apply(this,i.concat(c))};return t&&t(a,i),a}};return t&&t(r,[]),r}function De(e){const t=Number(e);if(!isNaN(t))return t;if(Be(e))return xe(e);throw new Error(`cannot parse as numeral: "${e}"`)}function Xe(e,t){return(...n)=>e(...n.map(t))}function F(e){return Xe(e,De)}function Wt(e){const t=Number(e);if(!isNaN(t))return t;const n={pi:Math.PI,w:1,h:.5,q:.25,e:.125,s:.0625,t:1/3,f:.2,x:1/6}[e];if(typeof n<"u")return n;throw new Error(`cannot parse as fractional: "${e}"`)}const Ru=e=>Xe(e,Wt),Qe=function(e,t){return[t.slice(0,e),t.slice(e)]},Ce=(e,t,n)=>t.map((r,s)=>e(r,n[s])),jt=function(e){const t=[];for(let n=0;n<e.length-1;++n)t.push([e[n],e[n+1]]);return t},Jt=(e,t,n)=>Math.min(Math.max(e,t),n),Zu=["Do","Reb","Re","Mib","Mi","Fa","Solb","Sol","Lab","La","Sib","Si"],Fu=["Sa","Re","Ga","Ma","Pa","Dha","Ni"],Hu=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Hb","H"],Ku=["Ni","Pab","Pa","Voub","Vou","Ga","Dib","Di","Keb","Ke","Zob","Zo"],Gu=["I","Ro","Ha","Ni","Ho","He","To"],$u=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Vu=(e,t="letters")=>{const n=(t==="solfeggio"?Zu:t==="indian"?Fu:t==="german"?Hu:t==="byzantine"?Ku:t==="japanese"?Gu:$u)[e%12],r=Math.floor(e/12)-1;return n+r};function Yu(e){var t={};return e.filter(function(n){return t.hasOwn(n)?!1:t[n]=!0})}function Du(e){return e.sort().filter(function(t,n,r){return!n||t!=r[n-1]})}function Lt(e){return e.sort((t,n)=>t.compare(n)).filter(function(t,n,r){return!n||t.ne(r[n-1])})}function Rt(e){const t=new TextEncoder().encode(e);return btoa(String.fromCharCode(...t))}function Zt(e){const t=new Uint8Array(atob(e).split("").map(n=>n.charCodeAt(0)));return new TextDecoder().decode(t)}function Xu(e){return encodeURIComponent(Rt(e))}function Qu(e){return Zt(decodeURIComponent(e))}function Ft(e,t){return Array.isArray(e)?e.map(t):Object.fromEntries(Object.entries(e).map(([n,r],s)=>[n,t(r,n,s)]))}function Le(e,t){return e/t}class Ht{constructor({getTargetClockTime:t=ep,weight:n=16,offsetDelta:r=.005,checkAfterTime:s=2,resetAfterTime:i=8}){this.offsetTime,this.timeAtPrevOffsetSample,this.prevOffsetTimes=[],this.getTargetClockTime=t,this.weight=n,this.offsetDelta=r,this.checkAfterTime=s,this.resetAfterTime=i,this.reset=()=>{this.prevOffsetTimes=[],this.offsetTime=null,this.timeAtPrevOffsetSample=null}}calculateOffset(t){const n=this.getTargetClockTime(),r=n-this.timeAtPrevOffsetSample,s=n-t;if(r>this.resetAfterTime&&this.reset(),this.offsetTime==null&&(this.offsetTime=s),this.prevOffsetTimes.push(s),this.prevOffsetTimes.length>this.weight&&this.prevOffsetTimes.shift(),this.timeAtPrevOffsetSample==null||r>this.checkAfterTime){this.timeAtPrevOffsetSample=n;const i=Et(this.prevOffsetTimes);Math.abs(i-this.offsetTime)>this.offsetDelta&&(this.offsetTime=i)}return this.offsetTime}calculateTimestamp(t,n){return this.calculateOffset(t)+n}}function Uu(){return performance.now()*.001}function ep(){return Date.now()*.001}const Kt=new Map([["control","Control"],["ctrl","Control"],["alt","Alt"],["shift","Shift"],["down","ArrowDown"],["up","ArrowUp"],["left","ArrowLeft"],["right","ArrowRight"]]);let ge;function Gt(){if(ge==null){if(typeof window>"u")return;ge={},window.addEventListener("keydown",e=>{ge[e.key]=!0}),window.addEventListener("keyup",e=>{ge[e.key]=!1})}return{...ge}}function Ue(e,t=!1){return typeof e=="object"?t?JSON.stringify(e).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(e):e}x.prototype.sam=function(){return this.floor()};x.prototype.nextSam=function(){return this.sam().add(1)};x.prototype.wholeCycle=function(){return new N(this.sam(),this.nextSam())};x.prototype.cyclePos=function(){return this.sub(this.sam())};x.prototype.lt=function(e){return this.compare(e)<0};x.prototype.gt=function(e){return this.compare(e)>0};x.prototype.lte=function(e){return this.compare(e)<=0};x.prototype.gte=function(e){return this.compare(e)>=0};x.prototype.eq=function(e){return this.compare(e)==0};x.prototype.ne=function(e){return this.compare(e)!=0};x.prototype.max=function(e){return this.gt(e)?this:e};x.prototype.maximum=function(...e){return e=e.map(t=>new x(t)),e.reduce((t,n)=>n.max(t),this)};x.prototype.min=function(e){return this.lt(e)?this:e};x.prototype.mulmaybe=function(e){return e!==void 0?this.mul(e):void 0};x.prototype.divmaybe=function(e){return e!==void 0?this.div(e):void 0};x.prototype.addmaybe=function(e){return e!==void 0?this.add(e):void 0};x.prototype.submaybe=function(e){return e!==void 0?this.sub(e):void 0};x.prototype.show=function(){return this.s*this.n+"/"+this.d};x.prototype.or=function(e){return this.eq(0)?e:this};const d=e=>x(e),tp=(...e)=>{if(e=de(e),e.length!==0)return e.reduce((t,n)=>t.gcd(n),d(1))},oe=(...e)=>{if(e=de(e),e.length===0)return;const t=e.pop();return e.reduce((n,r)=>n===void 0||r===void 0?void 0:n.lcm(r),t)},np=e=>e instanceof x;d._original=x;class N{constructor(t,n){this.begin=d(t),this.end=d(n)}get spanCycles(){const t=[];var n=this.begin;const r=this.end,s=r.sam();if(n.equals(r))return[new N(n,r)];for(;r.gt(n);){if(n.sam().equals(s)){t.push(new N(n,this.end));break}const i=n.nextSam();t.push(new N(n,i)),n=i}return t}get duration(){return this.end.sub(this.begin)}cycleArc(){const t=this.begin.cyclePos(),n=t.add(this.duration);return new N(t,n)}withTime(t){return new N(t(this.begin),t(this.end))}withEnd(t){return new N(this.begin,t(this.end))}withCycle(t){const n=this.begin.sam(),r=n.add(t(this.begin.sub(n))),s=n.add(t(this.end.sub(n)));return new N(r,s)}intersection(t){const n=this.begin.max(t.begin),r=this.end.min(t.end);if(!n.gt(r)&&!(n.equals(r)&&(n.equals(this.end)&&this.begin.lt(this.end)||n.equals(t.end)&&t.begin.lt(t.end))))return new N(n,r)}intersection_e(t){const n=this.intersection(t);if(n==null)throw"TimeSpans do not intersect";return n}midpoint(){return this.begin.add(this.duration.div(d(2)))}equals(t){return this.begin.equals(t.begin)&&this.end.equals(t.end)}show(){return this.begin.show()+" → "+this.end.show()}}class O{constructor(t,n,r,s={},i=!1){this.whole=t,this.part=n,this.value=r,this.context=s,this.stateful=i,i&&console.assert(typeof this.value=="function","Stateful values must be functions")}get duration(){var n,r;let t;return typeof((n=this.value)==null?void 0:n.duration)=="number"?t=d(this.value.duration):t=this.whole.end.sub(this.whole.begin),typeof((r=this.value)==null?void 0:r.clip)=="number"?t.mul(this.value.clip):t}get endClipped(){return this.whole.begin.add(this.duration)}isActive(t){return this.whole.begin<=t&&this.endClipped>=t}isInPast(t){return t>this.endClipped}isInNearPast(t,n){return n-t<=this.endClipped}isInFuture(t){return t<this.whole.begin}isInNearFuture(t,n){return n<this.whole.begin&&n>this.whole.begin-t}isWithinTime(t,n){return this.whole.begin<=n&&this.endClipped>=t}wholeOrPart(){return this.whole?this.whole:this.part}withSpan(t){const n=this.whole?t(this.whole):void 0;return new O(n,t(this.part),this.value,this.context)}withValue(t){return new O(this.whole,this.part,t(this.value),this.context)}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}hasTag(t){var n;return(n=this.context.tags)==null?void 0:n.includes(t)}resolveState(t){if(this.stateful&&this.hasOnset()){console.log("stateful");const n=this.value,[r,s]=n(t);return[r,new O(this.whole,this.part,s,this.context,!1)]}return[t,this]}spanEquals(t){return this.whole==null&&t.whole==null||this.whole.equals(t.whole)}equals(t){return this.spanEquals(t)&&this.part.equals(t.part)&&this.value===t.value}show(t=!1){const n=typeof this.value=="object"?t?JSON.stringify(this.value).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(this.value):this.value;var r="";if(this.whole==null)r="~"+this.part.show;else{var s=this.whole.begin.equals(this.part.begin)&&this.whole.end.equals(this.part.end);this.whole.begin.equals(this.part.begin)||(r=this.whole.begin.show()+" ⇜ "),s||(r+="("),r+=this.part.show(),s||(r+=")"),this.whole.end.equals(this.part.end)||(r+=" ⇝ "+this.whole.end.show())}return"[ "+r+" | "+n+" ]"}showWhole(t=!1){return`${this.whole==null?"~":this.whole.show()}: ${Ue(this.value,t)}`}combineContext(t){const n=this;return{...n.context,...t.context,locations:(n.context.locations||[]).concat(t.context.locations||[])}}setContext(t){return new O(this.whole,this.part,this.value,t)}ensureObjectValue(){if(typeof this.value!="object")throw new Error(`expected hap.value to be an object, but got "${this.value}". Hint: append .note() or .s() to the end`,"error")}}class fe{constructor(t,n={}){this.span=t,this.controls=n}setSpan(t){return new fe(t,this.controls)}withSpan(t){return this.setSpan(t(this.span))}setControls(t){return new fe(this.span,{...this.controls,...t})}}function rp(e,t,n){if((t==null?void 0:t.value)!==void 0&&Object.keys(t).length===1)return j("[warn]: Can't do arithmetic on control pattern."),e;const r=Object.keys(e).filter(s=>Object.keys(t).includes(s));return Object.assign({},e,t,Object.fromEntries(r.map(s=>[s,n(e[s],t[s])])))}v((e,t)=>e*t);v((e,t)=>t.map(e));function $t(e,t=60){let n=0,r=d(0),s=[""],i="";for(;s[0].length<t;){const a=e.queryArc(n,n+1),c=a.filter(y=>y.hasOnset()).map(y=>y.duration),u=tp(...c),p=u.inverse();s=s.map(y=>y+"|"),i+="|";for(let y=0;y<p;y++){const[f,S]=[r,r.add(u)],k=a.filter(T=>T.whole.begin.lte(f)&&T.whole.end.gte(S)),A=k.length-s.length;A>0&&(s=s.concat(Array(A).fill(i))),s=s.map((T,Y)=>{const B=k[Y];if(B){const X=B.whole.begin.eq(f)?""+B.value:"-";return T+X}return T+"."}),i+=".",r=r.add(u)}n++}return s.join(`
`)}let Re,H=!0;const sp=function(e){H=!!e},ip=e=>Re=e;class h{constructor(t,n=void 0){xt(this,"polyJoin",function(){const t=this;return t.fmap(n=>n.extend(t._steps.div(n._steps))).outerJoin()});this.query=t,this._Pattern=!0,this._steps=n}get _steps(){return this.__steps}set _steps(t){this.__steps=t===void 0?void 0:d(t)}setSteps(t){return this._steps=t,this}withSteps(t){return H?new h(this.query,this._steps===void 0?void 0:t(this._steps)):this}get hasSteps(){return this._steps!==void 0}withValue(t){const n=new h(r=>this.query(r).map(s=>s.withValue(t)));return n._steps=this._steps,n}withState(t){return new h(n=>this.query(t(n)))}fmap(t){return this.withValue(t)}appWhole(t,n){const r=this,s=function(i){const a=r.query(i),c=n.query(i),u=function(p,y){const f=p.part.intersection(y.part);if(f!=null)return new O(t(p.whole,y.whole),f,p.value(y.value),y.combineContext(p))};return U(a.map(p=>de(c.map(y=>u(p,y)))))};return new h(s)}appBoth(t){const n=this,r=function(i,a){if(!(i==null||a==null))return i.intersection_e(a)},s=n.appWhole(r,t);return H&&(s._steps=oe(t._steps,n._steps)),s}appLeft(t){const n=this,r=function(i){const a=[];for(const c of n.query(i)){const u=t.query(i.setSpan(c.wholeOrPart()));for(const p of u){const y=c.whole,f=c.part.intersection(p.part);if(f){const S=c.value(p.value),k=p.combineContext(c),A=new O(y,f,S,k);a.push(A)}}}return a},s=new h(r);return s._steps=this._steps,s}appRight(t){const n=this,r=function(i){const a=[];for(const c of t.query(i)){const u=n.query(i.setSpan(c.wholeOrPart()));for(const p of u){const y=c.whole,f=p.part.intersection(c.part);if(f){const S=p.value(c.value),k=c.combineContext(p),A=new O(y,f,S,k);a.push(A)}}}return a},s=new h(r);return s._steps=t._steps,s}bindWhole(t,n){const r=this,s=function(i){const a=function(u,p){return new O(t(u.whole,p.whole),p.part,p.value,Object.assign({},u.context,p.context,{locations:(u.context.locations||[]).concat(p.context.locations||[])}))},c=function(u){return n(u.value).query(i.setSpan(u.part)).map(p=>a(u,p))};return U(r.query(i).map(u=>c(u)))};return new h(s)}bind(t){const n=function(r,s){if(!(r==null||s==null))return r.intersection_e(s)};return this.bindWhole(n,t)}join(){return this.bind(le)}outerBind(t){return this.bindWhole(n=>n,t).setSteps(this._steps)}outerJoin(){return this.outerBind(le)}innerBind(t){return this.bindWhole((n,r)=>r,t)}innerJoin(){return this.innerBind(le)}resetJoin(t=!1){const n=this;return new h(r=>n.discreteOnly().query(r).map(s=>s.value.late(t?s.whole.begin:s.whole.begin.cyclePos()).query(r).map(i=>new O(i.whole?i.whole.intersection(s.whole):void 0,i.part.intersection(s.part),i.value).setContext(s.combineContext(i))).filter(i=>i.part)).flat())}restartJoin(){return this.resetJoin(!0)}squeezeJoin(){const t=this;function n(r){const s=t.discreteOnly().query(r);function i(a){const c=a.value._focusSpan(a.wholeOrPart()).query(r.setSpan(a.part));function u(p,y){let f;if(y.whole&&p.whole&&(f=y.whole.intersection(p.whole),!f))return;const S=y.part.intersection(p.part);if(!S)return;const k=y.combineContext(p);return new O(f,S,y.value,k)}return c.map(p=>u(a,p))}return U(s.map(i)).filter(a=>a)}return new h(n)}squeezeBind(t){return this.fmap(t).squeezeJoin()}polyBind(t){return this.fmap(t).polyJoin()}queryArc(t,n,r={}){try{return this.query(new fe(new N(t,n),r))}catch(s){return j(`[query]: ${s.message}`,"error"),[]}}splitQueries(){const t=this,n=r=>U(r.span.spanCycles.map(s=>t.query(r.setSpan(s))));return new h(n)}withQuerySpan(t){return new h(n=>this.query(n.withSpan(t)))}withQuerySpanMaybe(t){const n=this;return new h(r=>{const s=r.withSpan(t);return s.span?n.query(s):[]})}withQueryTime(t){return new h(n=>this.query(n.withSpan(r=>r.withTime(t))))}withHapSpan(t){return new h(n=>this.query(n).map(r=>r.withSpan(t)))}withHapTime(t){return this.withHapSpan(n=>n.withTime(t))}withHaps(t){const n=new h(r=>t(this.query(r),r));return n._steps=this._steps,n}withHap(t){return this.withHaps(n=>n.map(t))}setContext(t){return this.withHap(n=>n.setContext(t))}withContext(t){const n=this.withHap(r=>r.setContext(t(r.context)));return this.__pure!==void 0&&(n.__pure=this.__pure,n.__pure_loc=this.__pure_loc),n}stripContext(){return this.withHap(t=>t.setContext({}))}withLoc(t,n){const r={start:t,end:n},s=this.withContext(i=>{const a=(i.locations||[]).concat([r]);return{...i,locations:a}});return this.__pure&&(s.__pure=this.__pure,s.__pure_loc=r),s}filterHaps(t){return new h(n=>this.query(n).filter(t))}filterValues(t){return new h(n=>this.query(n).filter(r=>t(r.value))).setSteps(this._steps)}removeUndefineds(){return this.filterValues(t=>t!=null)}onsetsOnly(){return this.filterHaps(t=>t.hasOnset())}discreteOnly(){return this.filterHaps(t=>t.whole)}defragmentHaps(){return this.discreteOnly().withHaps(t=>{const n=[];for(var r=0;r<t.length;++r){for(var s=!0,i=t[r];s;){const u=JSON.stringify(t[r].value);for(var a=!1,c=r+1;c<t.length;c++){const p=t[c];if(i.whole.equals(p.whole)){if(i.part.begin.eq(p.part.end)){if(u===JSON.stringify(p.value)){i=new O(i.whole,new N(p.part.begin,i.part.end),i.value),t.splice(c,1),a=!0;break}}else if(p.part.begin.eq(i.part.end)&&u==JSON.stringify(p.value)){i=new O(i.whole,new N(i.part.begin,p.part.end),i.value),t.splice(c,1),a=!0;break}}}s=a}n.push(i)}return n})}firstCycle(t=!1){var n=this;return t||(n=n.stripContext()),n.query(new fe(new N(d(0),d(1))))}get firstCycleValues(){return this.firstCycle().map(t=>t.value)}get showFirstCycle(){return this.firstCycle().map(t=>`${t.value}: ${t.whole.begin.toFraction()} - ${t.whole.end.toFraction()}`)}sortHapsByPart(){return this.withHaps(t=>t.sort((n,r)=>n.part.begin.sub(r.part.begin).or(n.part.end.sub(r.part.end)).or(n.whole.begin.sub(r.whole.begin).or(n.whole.end.sub(r.whole.end)))))}asNumber(){return this.fmap(De)}_opIn(t,n){return this.fmap(n).appLeft(m(t))}_opOut(t,n){return this.fmap(n).appRight(m(t))}_opMix(t,n){return this.fmap(n).appBoth(m(t))}_opSqueeze(t,n){const r=m(t);return this.fmap(s=>r.fmap(i=>n(s)(i))).squeezeJoin()}_opSqueezeOut(t,n){const r=this;return m(t).fmap(s=>r.fmap(i=>n(i)(s))).squeezeJoin()}_opReset(t,n){return m(t).fmap(r=>this.fmap(s=>n(s)(r))).resetJoin()}_opRestart(t,n){return m(t).fmap(r=>this.fmap(s=>n(s)(r))).restartJoin()}_opPoly(t,n){const r=m(t);return this.fmap(s=>r.fmap(i=>n(i)(s))).polyJoin()}layer(...t){return E(...t.map(n=>n(this)))}superimpose(...t){return this.stack(...t.map(n=>n(this)))}stack(...t){return E(this,...t)}sequence(...t){return ee(this,...t)}seq(...t){return ee(this,...t)}cat(...t){return ke(this,...t)}fastcat(...t){return R(this,...t)}slowcat(...t){return re(this,...t)}onTrigger(t,n=!0){return this.withHap(r=>r.setContext({...r.context,onTrigger:(...s)=>{var i,a;(a=(i=r.context).onTrigger)==null||a.call(i,...s),t(...s)},dominantTrigger:r.context.dominantTrigger||n}))}log(t=r=>`[hap] ${r.showWhole(!0)}`,n=r=>({hap:r})){return this.onTrigger((...r)=>{j(t(...r),void 0,n(...r))},!1)}logValues(t=n=>`[hap] ${Ue(n,!0)}`){return this.log(n=>t(n.value))}drawLine(){return console.log($t(this)),this}unjoin(t,n=le){return t.withHap(r=>r.withValue(s=>s?n(this.ribbon(r.whole.begin,r.whole.duration)):this))}into(t,n){return this.unjoin(t,n).innerJoin()}}function op(e,t){let n=[];return t.forEach(r=>{const s=n.findIndex(([i])=>e(r,i));s===-1?n.push([r]):n[s].push(r)}),n}const ap=(e,t)=>e.spanEquals(t);h.prototype.collect=function(){return this.withHaps(e=>op(ap,e).map(t=>new O(t[0].whole,t[0].part,t,{})))};const cp=l("arpWith",(e,t)=>t.collect().fmap(n=>m(e(n))).innerJoin().withHap(n=>new O(n.whole,n.part,n.value.value,n.combineContext(n.value)))),up=l("arp",(e,t)=>t.arpWith(n=>m(e).fmap(r=>n[r%n.length])),!1);function ze(e){return!Array.isArray(e)&&typeof e=="object"&&!np(e)}function pp(e,t,n){return ze(e)||ze(t)?(ze(e)||(e={value:e}),ze(t)||(t={value:t}),rp(e,t,n)):n(e,t)}(function(){const e={set:[(n,r)=>r],keep:[n=>n],keepif:[(n,r)=>r?n:void 0],add:[F((n,r)=>n+r)],sub:[F((n,r)=>n-r)],mul:[F((n,r)=>n*r)],div:[F((n,r)=>n/r)],mod:[F(Te)],pow:[F(Math.pow)],log2:[F(Math.log2)],band:[F((n,r)=>n&r)],bor:[F((n,r)=>n|r)],bxor:[F((n,r)=>n^r)],blshift:[F((n,r)=>n<<r)],brshift:[F((n,r)=>n>>r)],lt:[(n,r)=>n<r],gt:[(n,r)=>n>r],lte:[(n,r)=>n<=r],gte:[(n,r)=>n>=r],eq:[(n,r)=>n==r],eqt:[(n,r)=>n===r],ne:[(n,r)=>n!=r],net:[(n,r)=>n!==r],and:[(n,r)=>n&&r],or:[(n,r)=>n||r],func:[(n,r)=>r(n)]},t=["In","Out","Mix","Squeeze","SqueezeOut","Reset","Restart","Poly"];for(const[n,[r,s]]of Object.entries(e)){h.prototype["_"+n]=function(i){return this.fmap(a=>r(a,i))},Object.defineProperty(h.prototype,n,{get:function(){const i=this,a=(...c)=>i[n].in(...c);for(const c of t)a[c.toLowerCase()]=function(...u){var p=i;u=ee(u),s&&(p=s(p),u=s(u));var y;return n==="keepif"?(y=p["_op"+c](u,f=>S=>r(f,S)),y=y.removeUndefineds()):y=p["_op"+c](u,f=>S=>pp(f,S,r)),y};return a.squeezein=a.squeeze,a}});for(const i of t)h.prototype[i.toLowerCase()]=function(...a){return this.set[i.toLowerCase()](a)}}h.prototype.struct=function(...n){return this.keepif.out(...n)},h.prototype.structAll=function(...n){return this.keep.out(...n)},h.prototype.mask=function(...n){return this.keepif.in(...n)},h.prototype.maskAll=function(...n){return this.keep.in(...n)},h.prototype.reset=function(...n){return this.keepif.reset(...n)},h.prototype.resetAll=function(...n){return this.keep.reset(...n)},h.prototype.restart=function(...n){return this.keepif.restart(...n)},h.prototype.restartAll=function(...n){return this.keep.restart(...n)}})();const lp=E,hp=E,fp=Oe,me=e=>new h(()=>[],e),q=me(1),V=me(0);function W(e){function t(r){return r.span.spanCycles.map(s=>new O(d(s.begin).wholeCycle(),s,e))}const n=new h(t,1);return n.__pure=e,n}function et(e){return e instanceof h||(e==null?void 0:e._Pattern)}function m(e){return et(e)?e:Re&&typeof e=="string"?Re(e):W(e)}function Vt(e){let t=W([]);for(const n of e)t=t.bind(r=>n.fmap(s=>r.concat([s])));return t}function E(...e){e=e.map(r=>Array.isArray(r)?ee(...r):m(r));const t=r=>U(e.map(s=>s.query(r))),n=new h(t);return H&&(n._steps=oe(...e.map(r=>r._steps))),n}function tt(e,t){if(t=t.map(i=>Array.isArray(i)?ee(...i):m(i)),t.length===0)return q;if(t.length===1)return t[0];const[n,...r]=t.map(i=>i._steps),s=H?n.maximum(...r):void 0;return E(...e(s,t))}function Yt(...e){return tt((t,n)=>n.map(r=>r._steps.eq(t)?r:L(r,me(t.sub(r._steps)))),e)}function Dt(...e){return tt((t,n)=>n.map(r=>r._steps.eq(t)?r:L(me(t.sub(r._steps)),r)),e)}function Xt(...e){return tt((t,n)=>n.map(r=>{if(r._steps.eq(t))return r;const s=me(t.sub(r._steps).div(2));return L(s,r,s)}),e)}function dp(e,...t){const[n,...r]=t.map(a=>a._steps),s=n.maximum(...r),i={centre:Xt,left:Yt,right:Dt,expand:E,repeat:(...a)=>Oe(...a).steps(s)};return e.inhabit(i).fmap(a=>a(...t)).innerJoin().setSteps(s)}function re(...e){if(e=e.map(r=>Array.isArray(r)?R(...r):m(r)),e.length==1)return e[0];const t=function(r){const s=r.span,i=Te(s.begin.sam(),e.length),a=e[i];if(!a)return[];const c=s.begin.floor().sub(s.begin.div(e.length).floor());return a.withHapTime(u=>u.add(c)).query(r.setSpan(s.withTime(u=>u.sub(c))))},n=H?oe(...e.map(r=>r._steps)):void 0;return new h(t).splitQueries().setSteps(n)}function nt(...e){e=e.map(m);const t=function(n){var s;const r=Math.floor(n.span.begin)%e.length;return((s=e[r])==null?void 0:s.query(n))||[]};return new h(t).splitQueries()}function ke(...e){return re(...e)}function mp(...e){const t=e.reduce((n,[r])=>n+r,0);return e=e.map(([n,r])=>[n,r.fast(n)]),L(...e).slow(t)}function yp(...e){let t=d(0);for(let n of e)n.length==2&&n.unshift(t),t=n[1];return E(...e.map(([n,r,s])=>W(m(s)).compress(d(n).div(t),d(r).div(t)))).slow(t).innerJoin()}function R(...e){let t=re(...e);return e.length>1&&(t=t._fast(e.length),t._steps=e.length),e.length==1&&e[0].__steps_source&&(e._steps=e[0]._steps),t}function ee(...e){return R(...e)}function Qt(...e){return R(...e)}function Ze(e){return Array.isArray(e)?e.length==0?[q,0]:e.length==1?Ze(e[0]):[R(...e.map(t=>Ze(t)[0])),e.length]:[m(e),1]}const wp=v((e,t)=>m(t).mask(e)),gp=v((e,t)=>m(t).struct(e)),bp=v((e,t)=>m(t).superimpose(...e)),vp=v((e,t)=>m(t).withValue(e)),kp=v((e,t)=>m(t).bind(e)),_p=v((e,t)=>m(t).innerBind(e)),Sp=v((e,t)=>m(t).outerBind(e)),xp=v((e,t)=>m(t).squeezeBind(e)),Tp=v((e,t)=>m(t).stepBind(e)),qp=v((e,t)=>m(t).polyBind(e)),Ap=v((e,t)=>m(t).set(e)),zp=v((e,t)=>m(t).keep(e)),Bp=v((e,t)=>m(t).keepif(e)),Cp=v((e,t)=>m(t).add(e)),Op=v((e,t)=>m(t).sub(e)),Np=v((e,t)=>m(t).mul(e)),Ep=v((e,t)=>m(t).div(e)),Pp=v((e,t)=>m(t).mod(e)),Mp=v((e,t)=>m(t).pow(e)),Ip=v((e,t)=>m(t).band(e)),Wp=v((e,t)=>m(t).bor(e)),jp=v((e,t)=>m(t).bxor(e)),Jp=v((e,t)=>m(t).blshift(e)),Lp=v((e,t)=>m(t).brshift(e)),Rp=v((e,t)=>m(t).lt(e)),Zp=v((e,t)=>m(t).gt(e)),Fp=v((e,t)=>m(t).lte(e)),Hp=v((e,t)=>m(t).gte(e)),Kp=v((e,t)=>m(t).eq(e)),Gp=v((e,t)=>m(t).eqt(e)),$p=v((e,t)=>m(t).ne(e)),Vp=v((e,t)=>m(t).net(e)),Yp=v((e,t)=>m(t).and(e)),Dp=v((e,t)=>m(t).or(e)),Xp=v((e,t)=>m(t).func(e));function l(e,t,n=!0,r=!1,s=i=>i.innerJoin()){if(Array.isArray(e)){const c={};for(const u of e)c[u]=l(u,t,n,r,s);return c}const i=t.length;var a;return n?a=function(...c){c=c.map(m);const u=c[c.length-1];let p;if(i===1)p=t(u);else{const y=c.slice(0,-1);if(y.every(f=>f.__pure!=null)){const f=y.map(k=>k.__pure),S=y.filter(k=>k.__pure_loc).map(k=>k.__pure_loc);p=t(...f,u),p=p.withContext(k=>{const A=(k.locations||[]).concat(S);return{...k,locations:A}})}else{const[f,...S]=y;let k=(...A)=>t(...A,u);k=v(k,null,i-1),p=s(S.reduce((A,T)=>A.appLeft(T),f.fmap(k)))}}return r&&(p._steps=u._steps),p}:a=function(...c){c=c.map(m);const u=t(...c);return r&&(u._steps=c[c.length-1]._steps),u},h.prototype[e]=function(...c){if(i===2&&c.length!==1)c=[ee(...c)];else if(i!==c.length+1)throw new Error(`.${e}() expects ${i-1} inputs but got ${c.length}.`);return c=c.map(m),a(...c,this)},i>1&&(h.prototype["_"+e]=function(...c){const u=t(...c,this);return r&&u.setSteps(this._steps),u}),v(a,null,i)}function ye(e,t,n=!0,r=!1,s=i=>i.stepJoin()){return l(e,t,n,r,s)}const Qp=l("round",function(e){return e.asNumber().fmap(t=>Math.round(t))}),Up=l("floor",function(e){return e.asNumber().fmap(t=>Math.floor(t))}),el=l("ceil",function(e){return e.asNumber().fmap(t=>Math.ceil(t))}),tl=l("toBipolar",function(e){return e.fmap(t=>t*2-1)}),nl=l("fromBipolar",function(e){return e.fmap(t=>(t+1)/2)}),rl=l("range",function(e,t,n){return n.mul(t-e).add(e)}),sl=l("rangex",function(e,t,n){return n._range(Math.log(e),Math.log(t)).fmap(Math.exp)}),il=l("range2",function(e,t,n){return n.fromBipolar()._range(e,t)}),ol=l("ratio",e=>e.fmap(t=>Array.isArray(t)?t.slice(1).reduce((n,r)=>n/r,t[0]):t)),al=l("compress",function(e,t,n){return e=d(e),t=d(t),e.gt(t)||e.gt(1)||t.gt(1)||e.lt(0)||t.lt(0)?q:n._fastGap(d(1).div(t.sub(e)))._late(e)}),{compressSpan:cl,compressspan:ul}=l(["compressSpan","compressspan"],function(e,t){return t._compress(e.begin,e.end)}),{fastGap:pl,fastgap:ll}=l(["fastGap","fastgap"],function(e,t){const n=function(s){const i=s.begin.sam(),a=s.begin.sub(i).mul(e).min(1),c=s.end.sub(i).mul(e).min(1);if(!(a>=1))return new N(i.add(a),i.add(c))},r=function(s){const i=s.part.begin,a=s.part.end,c=i.sam(),u=i.sub(c).div(e).min(1),p=a.sub(c).div(e).min(1),y=new N(c.add(u),c.add(p)),f=s.whole?new N(y.begin.sub(i.sub(s.whole.begin).div(e)),y.end.add(s.whole.end.sub(a).div(e))):void 0;return new O(f,y,s.value,s.context)};return t.withQuerySpanMaybe(n).withHap(r).splitQueries()}),hl=l("focus",function(e,t,n){return e=d(e),t=d(t),n._early(e.sam())._fast(d(1).div(t.sub(e)))._late(e)}),{focusSpan:fl,focusspan:dl}=l(["focusSpan","focusspan"],function(e,t){return t._focus(e.begin,e.end)}),ml=l("ply",function(e,t){const n=t.fmap(r=>W(r)._fast(e)).squeezeJoin();return H&&(n._steps=d(e).mulmaybe(t._steps)),n}),{fast:yl,density:Od}=l(["fast","density"],function(e,t){return e===0?q:(e=d(e),t.withQueryTime(n=>n.mul(e)).withHapTime(n=>n.div(e)).setSteps(t._steps))},!0,!0),wl=l("hurry",function(e,t){return t._fast(e).mul(W({speed:e}))}),{slow:gl,sparsity:bl}=l(["slow","sparsity"],function(e,t){return e===0?q:t._fast(d(1).div(e))}),vl=l("inside",function(e,t,n){return t(n._slow(e))._fast(e)}),kl=l("outside",function(e,t,n){return t(n._fast(e))._slow(e)}),_l=l("lastOf",function(e,t,n){const r=Array(e-1).fill(n);return r.push(t(n)),nt(...r)}),{firstOf:Sl,every:xl}=l(["firstOf","every"],function(e,t,n){const r=Array(e-1).fill(n);return r.unshift(t(n)),nt(...r)}),Tl=l("apply",function(e,t){return e(t)}),ql=l("cpm",function(e,t){return t._fast(e/60/1)}),Al=l("early",function(e,t){return e=d(e),t.withQueryTime(n=>n.add(e)).withHapTime(n=>n.sub(e))},!0,!0),Ut=l("late",function(e,t){return e=d(e),t._early(d(0).sub(e))},!0,!0),zl=l("zoom",function(e,t,n){var i;if(t=d(t),e=d(e),e.gte(t))return V;const r=t.sub(e),s=H?(i=n._steps)==null?void 0:i.mulmaybe(r):void 0;return n.withQuerySpan(a=>a.withCycle(c=>c.mul(r).add(e))).withHapSpan(a=>a.withCycle(c=>c.sub(e).div(r))).splitQueries().setSteps(s)}),{zoomArc:Bl,zoomarc:Cl}=l(["zoomArc","zoomarc"],function(e,t){return t.zoom(e.begin,e.end)}),Ol=l("bite",(e,t,n)=>t.fmap(r=>s=>{const i=d(r).div(s).mod(1),a=i.add(d(1).div(s));return n.zoom(i,a)}).appLeft(e).squeezeJoin(),!1),Nl=l("linger",function(e,t){return e==0?q:e<0?t._zoom(e.add(1),1)._slow(e):t._zoom(0,e)._slow(e)},!0,!0),{segment:El,seg:Pl}=l(["segment","seg"],function(e,t){return t.struct(W(!0)._fast(e)).setSteps(e)}),Ml=l("swingBy",(e,t,n)=>n.inside(t,Ut(Qt(0,e/2)))),Il=l("swing",(e,t)=>t.swingBy(1/3,e)),{invert:Wl,inv:jl}=l(["invert","inv"],function(e){return e.fmap(t=>!t)},!0,!0),Jl=l("when",function(e,t,n){return e?t(n):n}),Ll=l("off",function(e,t,n){return E(n,t(n.late(e)))}),Rl=l("brak",function(e){return e.when(re(!1,!0),t=>R(t,q)._late(.25))}),en=l("rev",function(e){const t=function(n){const r=n.span,s=r.begin.sam(),i=r.begin.nextSam(),a=function(c){const u=c.withTime(y=>s.add(i.sub(y))),p=u.begin;return u.begin=u.end,u.end=p,u};return e.query(n.setSpan(a(r))).map(c=>c.withSpan(a))};return new h(t).splitQueries()},!1,!0),Zl=l("pressBy",function(e,t){return t.fmap(n=>W(n).compress(e,1)).squeezeJoin()}),Fl=l("press",function(e){return e._pressBy(.5)});h.prototype.hush=function(){return q};const Hl=l("palindrome",function(e){return e.lastOf(2,en)},!0,!0),{juxBy:Kl,juxby:Gl}=l(["juxBy","juxby"],function(e,t,n){e/=2;const r=function(a,c,u){return c in a?a[c]:u},s=n.withValue(a=>Object.assign({},a,{pan:r(a,"pan",.5)-e})),i=t(n.withValue(a=>Object.assign({},a,{pan:r(a,"pan",.5)+e})));return E(s,i).setSteps(H?oe(s._steps,i._steps):void 0)}),$l=l("jux",function(e,t){return t._juxBy(1,e,t)}),{echoWith:Vl,echowith:Yl,stutWith:Dl,stutwith:Xl}=l(["echoWith","echowith","stutWith","stutwith"],function(e,t,n,r){return E(...qe(0,e-1).map(s=>n(r.late(d(t).mul(s)),s)))}),Ql=l("echo",function(e,t,n,r){return r._echoWith(e,t,(s,i)=>s.gain(Math.pow(n,i)))}),Ul=l("stut",function(e,t,n,r){return r._echoWith(e,n,(s,i)=>s.gain(Math.pow(t,i)))}),tn=l("applyN",function(e,t,n){let r=n;for(let s=0;s<e;s++)r=t(r);return r}),eh=l(["plyWith","plywith"],function(e,t,n){const r=n.fmap(s=>ke(...qe(0,e-1).map(i=>tn(i,t,s)))._fast(e)).squeezeJoin();return H&&(r._steps=d(e).mulmaybe(n._steps)),r}),th=l(["plyForEach","plyforeach"],function(e,t,n){const r=n.fmap(s=>ke(ke(W(s),...qe(1,e-1).map(i=>t(W(s),i))))._fast(e)).squeezeJoin();return H&&(r._steps=d(e).mulmaybe(n._steps)),r}),rt=function(e,t,n=!1){return e=d(e),re(...qe(0,e.sub(1)).map(r=>n?t.late(d(r).div(e)):t.early(d(r).div(e))))},nh=l("iter",function(e,t){return rt(e,t,!1)},!0,!0),{iterBack:rh,iterback:sh}=l(["iterBack","iterback"],function(e,t){return rt(e,t,!0)},!0,!0),{repeatCycles:ih}=l("repeatCycles",function(e,t){return new h(function(n){const r=n.span.begin.sam(),s=r.div(e).sam(),i=r.sub(s);return n=n.withSpan(a=>a.withTime(c=>c.sub(i))),t.query(n).map(a=>a.withSpan(c=>c.withTime(u=>u.add(i))))}).splitQueries()},!0,!0),st=function(e,t,n,r=!1,s=!1){const i=Array(e-1).fill(!1);i.unshift(!0);const a=rt(e,ee(...i),!r);return s||(n=n.repeatCycles(e)),n.when(a,t)},{chunk:oh,slowchunk:ah,slowChunk:ch}=l(["chunk","slowchunk","slowChunk"],function(e,t,n){return st(e,t,n,!1,!1)},!0,!0),{chunkBack:uh,chunkback:ph}=l(["chunkBack","chunkback"],function(e,t,n){return st(e,t,n,!0)},!0,!0),{fastchunk:lh,fastChunk:hh}=l(["fastchunk","fastChunk"],function(e,t,n){return st(e,t,n,!1,!0)},!0,!0),{chunkinto:fh,chunkInto:dh}=l(["chunkinto","chunkInto"],function(e,t,n){return n.into(R(!0,...Array(e-1).fill(!1))._iterback(e),t)}),{chunkbackinto:mh,chunkBackInto:yh}=l(["chunkbackinto","chunkBackInto"],function(e,t,n){return n.into(R(!0,...Array(e-1).fill(!1))._iter(e)._early(1),t)}),wh=l("bypass",function(e,t){return e=!!parseInt(e),e?q:t},!0,!0),{ribbon:gh,rib:bh}=l(["ribbon","rib"],(e,t,n)=>n.early(e).restart(W(1).slow(t))),vh=l("hsla",(e,t,n,r,s)=>s.color(`hsla(${e}turn,${t*100}%,${n*100}%,${r})`)),kh=l("hsl",(e,t,n,r)=>r.color(`hsl(${e}turn,${t*100}%,${n*100}%)`));h.prototype.tag=function(e){return this.withContext(t=>({...t,tags:(t.tags||[]).concat([e])}))};const _h=l("filter",(e,t)=>t.withHaps(n=>n.filter(e))),Sh=l("filterWhen",(e,t)=>t.filter(n=>e(n.whole.begin))),xh=l("within",(e,t,n,r)=>E(n(r.filterWhen(s=>s.cyclePos()>=e&&s.cyclePos()<=t)),r.filterWhen(s=>s.cyclePos()<e||s.cyclePos()>t)));h.prototype.stepJoin=function(){const e=this,t=L(...Fe(He(e.queryArc(0,1))))._steps,n=function(r){const s=e.early(r.span.begin.sam()).query(r.setSpan(new N(d(0),d(1))));return L(...Fe(He(s))).query(r)};return new h(n,t)};h.prototype.stepBind=function(e){return this.fmap(e).stepJoin()};function Fe(e){const t=e.filter((i,a)=>a.hasSteps).reduce((i,a)=>i.add(a),d(0)),n=de(e.map((i,a)=>a._steps)).reduce((i,a)=>i.add(a),d(0)),r=t.eq(0)?void 0:n.div(t);function s(i,a){return a._steps===void 0?[i.mulmaybe(r),a]:[a._steps,a]}return e.map(i=>s(...i))}function He(e){const t=U(e.map(r=>[r.part.begin,r.part.end])),n=Lt([d(0),d(1),...t]);return jt(n).map(r=>[r[1].sub(r[0]),E(...nn(new N(...r),e).map(s=>s.value.withHap(i=>i.setContext(i.combineContext(s)))))])}function nn(e,t){return de(t.map(n=>rn(e,n)))}function rn(e,t){const n=e.intersection(t.part);if(n!=null)return new O(t.whole,n,t.value,t.context)}const sn=l("pace",function(e,t){return t._steps===void 0?t:t._steps.eq(d(0))?V:t._fast(d(e).div(t._steps)).setSteps(e)});function on(e,...t){const n=t.map(s=>Ze(s));if(n.length==0)return q;e==0&&(e=n[0][1]);const r=[];for(const s of n)s[1]!=0&&(e==s[1]?r.push(s[0]):r.push(s[0]._fast(d(e).div(d(s[1])))));return E(...r)}function Oe(...e){if(Array.isArray(e[0]))return on(0,...e);if(e=e.filter(r=>r.hasSteps),e.length==0)return q;const t=oe(...e.map(r=>r._steps));if(t.eq(d(0)))return V;const n=E(...e.map(r=>r.pace(t)));return n._steps=t,n}function L(...e){if(e.length===0)return V;const t=a=>Array.isArray(a)?a:[a._steps??1,a];if(e=e.map(t),e.find(a=>a[0]===void 0)){const a=e.map(u=>u[0]).filter(u=>u!==void 0);if(a.length===0)return R(...e.map(u=>u[1]));if(a.length===e.length)return V;const c=a.reduce((u,p)=>u.add(p),d(0)).div(a.length);for(let u of e)u[0]===void 0&&(u[0]=c)}if(e.length==1)return m(e[0][1]).withSteps(a=>e[0][0]);const n=e.map(a=>a[0]).reduce((a,c)=>a.add(c),d(0));let r=d(0);const s=[];for(const[a,c]of e){if(d(a).eq(0))continue;const u=r.add(a);s.push(m(c)._compress(r.div(n),u.div(n))),r=u}const i=E(...s);return i._steps=n,i}function an(...e){e=e.map(s=>Array.isArray(s)?s.map(m):[m(s)]);const t=oe(...e.map(s=>d(s.length)));let n=[];for(let s=0;s<t;++s)n.push(...e.map(i=>i.length==0?q:i[s%i.length]));n=n.filter(s=>s.hasSteps&&s._steps>0);const r=n.reduce((s,i)=>s.add(i._steps),d(0));return n=L(...n),n._steps=r,n}const cn=ye("take",function(e,t){if(!t.hasSteps||t._steps.lte(0)||(e=d(e),e.eq(0)))return V;const n=e<0;n&&(e=e.abs());const r=e.div(t._steps);return r.lte(0)?V:r.gte(1)?t:n?t.zoom(d(1).sub(r),1):t.zoom(0,r)}),un=ye("drop",function(e,t){return t.hasSteps?(e=d(e),e.lt(0)?t.take(t._steps.add(e)):t.take(d(0).sub(t._steps.sub(e)))):V}),pn=ye("extend",function(e,t){return t.fast(e).expand(e)}),Th=ye("replicate",function(e,t){return t.repeatCycles(e).fast(e).expand(e)}),ln=ye("expand",function(e,t){return t.withSteps(n=>n.mul(d(e)))}),hn=ye("contract",function(e,t){return t.withSteps(n=>n.div(d(e)))});h.prototype.shrinklist=function(e){const t=this;if(!t.hasSteps)return[t];let[n,r]=Array.isArray(e)?e:[e,t._steps];if(n=d(n),r===0||n===0)return[t];const s=n>0,i=[];if(s){const a=d(1).div(t._steps).mul(n);for(let c=0;c<r;++c){const u=a.mul(c);if(u.gt(1))break;i.push([u,1])}}else{n=d(0).sub(n);const a=d(1).div(t._steps).mul(n);for(let c=0;c<r;++c){const u=d(1).sub(a.mul(c));if(u.lt(0))break;i.push([d(0),u])}}return i.map(a=>t.zoom(...a))};const fn=(e,t)=>t.shrinklist(e),dn=l("shrink",function(e,t){if(!t.hasSteps)return V;const n=t.shrinklist(e),r=L(...n);return r._steps=n.reduce((s,i)=>s.add(i._steps),d(0)),r},!0,!1,e=>e.stepJoin()),qh=l("grow",function(e,t){if(!t.hasSteps)return V;const n=t.shrinklist(d(0).sub(e));n.reverse();const r=L(...n);return r._steps=n.reduce((s,i)=>s.add(i._steps),d(0)),r},!0,!1,e=>e.stepJoin()),mn=function(e,...t){return e.tour(...t)};h.prototype.tour=function(...e){return L(...[].concat(...e.map((t,n)=>[...e.slice(0,e.length-n),this,...e.slice(e.length-n)]),this,...e))};const yn=function(...e){e=e.filter(r=>r.hasSteps);const t=re(...e.map(r=>r._slow(r._steps))),n=oe(...e.map(r=>r._steps));return t._fast(n).setSteps(n)},Ah=L,wn=L,zh=L,Bh=an,Ch=Oe;h.prototype.s_polymeter=h.prototype.polymeter;const Oh=dn;h.prototype.s_taper=h.prototype.shrink;const Nh=fn;h.prototype.s_taperlist=h.prototype.shrinklist;const Eh=cn;h.prototype.s_add=h.prototype.take;const Ph=un;h.prototype.s_sub=h.prototype.drop;const Mh=ln;h.prototype.s_expand=h.prototype.expand;const Ih=pn;h.prototype.s_extend=h.prototype.extend;const Wh=hn;h.prototype.s_contract=h.prototype.contract;const jh=mn;h.prototype.s_tour=h.prototype.tour;const Jh=yn;h.prototype.s_zip=h.prototype.zip;const Lh=sn;h.prototype.steps=h.prototype.pace;const Rh=l("chop",function(e,t){const n=Array.from({length:e},(i,a)=>a).map(i=>({begin:i/e,end:(i+1)/e})),r=function(i,a){if("begin"in i&&"end"in i&&i.begin!==void 0&&i.end!==void 0){const c=i.end-i.begin;a={begin:i.begin+a.begin*c,end:i.begin+a.end*c}}return Object.assign({},i,a)},s=function(i){return ee(n.map(a=>r(i,a)))};return t.squeezeBind(s).setSteps(H?d(e).mulmaybe(t._steps):void 0)}),Zh=l("striate",function(e,t){const n=Array.from({length:e},(s,i)=>i).map(s=>({begin:s/e,end:(s+1)/e})),r=re(...n);return t.set(r)._fast(e).setSteps(H?d(e).mulmaybe(t._steps):void 0)}),gn=function(e,t,n=.5){return t.speed(1/e*n).unit("c").slow(e)},bn=l("slice",function(e,t,n){return e.innerBind(r=>t.outerBind(s=>n.outerBind(i=>{i=i instanceof Object?i:{s:i};const a=Array.isArray(r)?r[s]:s/r,c=Array.isArray(r)?r[s+1]:(s+1)/r;return W({begin:a,end:c,_slices:r,...i})}))).setSteps(t._steps)},!1);h.prototype.onTriggerTime=function(e){return this.onTrigger((t,n,r,s)=>{const i=s-n;window.setTimeout(()=>{e(t)},i*1e3)},!1)};const Fh=l("splice",function(e,t,n){const r=bn(e,t,n);return new h(s=>{const i=s.controls._cps||1;return r.query(s).map(a=>a.withValue(c=>({speed:i/c._slices/a.whole.duration*(c.speed||1),unit:"c",...c})))}).setSteps(t._steps)},!1),{loopAt:Hh,loopat:Kh}=l(["loopAt","loopat"],function(e,t){const n=t._steps?t._steps.div(e):void 0;return new h(r=>gn(e,t,r.controls._cps).query(r),n)}),Gh=l("fit",e=>e.withHaps((t,n)=>t.map(r=>r.withValue(s=>{const i=("end"in s?s.end:1)-("begin"in s?s.begin:0);return{...s,speed:(n.controls._cps||1)/r.whole.duration*i,unit:"c"}})))),{loopAtCps:$h,loopatcps:Vh}=l(["loopAtCps","loopatcps"],function(e,t,n){return gn(e,n,t)}),Yh=e=>W(1).withValue(()=>m(e())).innerJoin();let zt=e=>e<.5?1:1-(e-.5)/.5,vn=(e,t,n)=>{t=m(t),e=m(e),n=m(n);let r=t.fmap(i=>({gain:zt(i)})),s=t.fmap(i=>({gain:zt(1-i)}));return E(e.mul(r),n.mul(s))};h.prototype.xfade=function(e,t){return vn(this,e,t)};const Dh=e=>(t,n,r)=>{t=d(t).mod(n),n=d(n);const s=t.div(n),i=t.add(1).div(n);return e(r.fmap(a=>W(a)._compress(s,i)))},{beat:Xh}=l(["beat"],Dh(e=>e.innerJoin())),it=(e,t,n)=>{n=d(n);const r=d(1).div(e.length),s=c=>{const u=[];for(const[p,y]of c.entries())y&&u.push([d(p).div(c.length),y]);return u},i=Ce(([c,u],[p,y])=>{const f=n.mul(p-c).add(c),S=f.add(r);return new N(f,S)},s(e),s(t));function a(c){const u=c.span.begin.sam(),p=c.span.cycleArc(),y=[];for(const f of i){const S=f.intersection(p);S!==void 0&&y.push(new O(f.withTime(k=>k.add(u)),S.withTime(k=>k.add(u)),!0))}return y}return new h(a).splitQueries()},Qh=(e,t,n)=>(e=m(e),t=m(t),n=m(n),e.innerBind(r=>t.innerBind(s=>n.innerBind(i=>it(r,s,i))))),Uh=["scurve","soft","hard","cubic","diode","asym","fold","sinefold","chebyshev"];for(const e of Uh)h.prototype[e]=function(t){const n=m(t).fmap(r=>Array.isArray(r)?[...r,e]:[r,1,e]);return this.distort(n)};function Ne(e){let t=Array.isArray(e);e=t?e:[e];const n=e[0],r=i=>{let a;if(typeof i=="object"&&i.value!==void 0&&(a={...i},i=i.value,delete a.value),t&&Array.isArray(i)){const c=a||{};return i.forEach((u,p)=>{p<e.length&&(c[e[p]]=u)}),c}else return a?(a[n]=i,a):{[n]:i}},s=function(i,a){return a?typeof i>"u"?a.fmap(r):a.set(m(i).withValue(r)):m(i).withValue(r)};return h.prototype[n]=function(i){return s(i,this)},s}const _e=new Map;function kn(e){return _e.has(e)}function o(e,...t){const n=Array.isArray(e)?e[0]:e;let r={};return r[n]=Ne(e),_e.set(n,n),t.forEach(s=>{r[s]=r[n],_e.set(s,n),h.prototype[s]=h.prototype[n]}),r}const{s:_n,sound:Sn}=o(["s","n","gain"],"sound"),{wt:xn,wavetablePosition:Tn}=o("wt","wavetablePosition"),{wtenv:qn}=o("wtenv"),{wtattack:An,wtatt:zn}=o("wtattack","wtatt"),{wtdecay:Bn,wtdec:Cn}=o("wtdecay","wtdec"),{wtsustain:On,wtsus:Nn}=o("wtsustain","wtsus"),{wtrelease:En,wtrel:Pn}=o("wtrelease","wtrel"),{wtrate:Mn}=o("wtrate"),{wtsync:In}=o("wtsync"),{wtdepth:Wn}=o("wtdepth"),{wtshape:jn}=o("wtshape"),{wtdc:Jn}=o("wtdc"),{wtskew:Ln}=o("wtskew"),{warp:Rn,wavetableWarp:Zn}=o("warp","wavetableWarp"),{warpattack:Fn,warpatt:Hn}=o("warpattack","warpatt"),{warpdecay:Kn,warpdec:Gn}=o("warpdecay","warpdec"),{warpsustain:$n,warpsus:Vn}=o("warpsustain","warpsus"),{warprelease:Yn,warprel:Dn}=o("warprelease","warprel"),{warprate:Xn}=o("warprate"),{warpdepth:Qn}=o("warpdepth"),{warpshape:Un}=o("warpshape"),{warpdc:er}=o("warpdc"),{warpskew:tr}=o("warpskew"),{warpmode:nr,wavetableWarpMode:rr}=o("warpmode","wavetableWarpMode"),{wtphaserand:sr,wavetablePhaseRand:ir}=o("wtphaserand","wavetablePhaseRand"),{warpenv:or}=o("warpenv"),{warpsync:ar}=o("warpsync"),{source:cr,src:ur}=o("source","src"),{n:pr}=o("n"),{note:lr}=o(["note","n"]),{accelerate:hr}=o("accelerate"),{velocity:fr}=o("velocity"),{gain:dr}=o("gain"),{postgain:mr}=o("postgain"),{amp:yr}=o("amp"),{attack:wr,att:gr}=o("attack","att"),{fmh:br}=o(["fmh","fmi"],"fmh"),{fmi:vr,fm:kr}=o(["fmi","fmh"],"fm"),{fmenv:_r}=o("fmenv"),{fmattack:Sr}=o("fmattack"),{fmwave:xr}=o("fmwave"),{fmdecay:Tr}=o("fmdecay"),{fmsustain:qr}=o("fmsustain"),{fmrelease:Ar}=o("fmrelease"),{fmvelocity:zr}=o("fmvelocity"),{bank:Br}=o("bank"),{chorus:Cr}=o("chorus"),{analyze:Or}=o("analyze"),{fft:Nr}=o("fft"),{decay:Er,dec:Pr}=o("decay","dec"),{sustain:Mr,sus:Ir}=o("sustain","sus"),{release:Wr,rel:jr}=o("release","rel"),{hold:Jr}=o("hold"),{bandf:Lr,bpf:Rr,bp:Zr}=o(["bandf","bandq","bpenv"],"bpf","bp"),{bandq:Fr,bpq:Hr}=o("bandq","bpq"),{begin:Kr}=o("begin"),{end:Gr}=o("end"),{loop:$r}=o("loop"),{loopBegin:Vr,loopb:Yr}=o("loopBegin","loopb"),{loopEnd:Dr,loope:Xr}=o("loopEnd","loope"),{crush:Qr}=o("crush"),{coarse:Ur}=o("coarse"),{tremolo:es}=o(["tremolo","tremolodepth","tremoloskew","tremolophase"],"trem"),{tremolosync:ts}=o(["tremolosync","tremolodepth","tremoloskew","tremolophase"],"tremsync"),{tremolodepth:ns}=o("tremolodepth","tremdepth"),{tremoloskew:rs}=o("tremoloskew","tremskew"),{tremolophase:ss}=o("tremolophase","tremphase"),{tremoloshape:is}=o("tremoloshape","tremshape"),{drive:os}=o("drive"),{duck:as}=o("duckorbit","duck"),{duckdepth:cs}=o("duckdepth"),{duckonset:us}=o("duckonset","duckons"),{duckattack:ps}=o("duckattack","duckatt"),{byteBeatExpression:ls,bbexpr:hs}=o("byteBeatExpression","bbexpr"),{byteBeatStartTime:fs,bbst:ds}=o("byteBeatStartTime","bbst"),{channels:ms,ch:ys}=o("channels","ch"),{pw:ws}=o(["pw","pwrate","pwsweep"]),{pwrate:gs}=o("pwrate"),{pwsweep:bs}=o("pwsweep"),{phaserrate:vs,ph:ks,phaser:_s}=o(["phaserrate","phaserdepth","phasercenter","phasersweep"],"ph","phaser"),{phasersweep:Ss,phs:xs}=o("phasersweep","phs"),{phasercenter:Ts,phc:qs}=o("phasercenter","phc"),{phaserdepth:As,phd:zs,phasdp:Bs}=o("phaserdepth","phd","phasdp"),{channel:Cs}=o("channel"),{cut:Os}=o("cut"),{cutoff:Ns,ctf:Es,lpf:Ps,lp:Ms}=o(["cutoff","resonance","lpenv"],"ctf","lpf","lp"),{lpenv:Is,lpe:Ws}=o("lpenv","lpe"),{hpenv:js,hpe:Js}=o("hpenv","hpe"),{bpenv:Ls,bpe:Rs}=o("bpenv","bpe"),{lpattack:Zs,lpa:Fs}=o("lpattack","lpa"),{hpattack:Hs,hpa:Ks}=o("hpattack","hpa"),{bpattack:Gs,bpa:$s}=o("bpattack","bpa"),{lpdecay:Vs,lpd:Ys}=o("lpdecay","lpd"),{hpdecay:Ds,hpd:Xs}=o("hpdecay","hpd"),{bpdecay:Qs,bpd:Us}=o("bpdecay","bpd"),{lpsustain:ei,lps:ti}=o("lpsustain","lps"),{hpsustain:ni,hps:ri}=o("hpsustain","hps"),{bpsustain:si,bps:ii}=o("bpsustain","bps"),{lprelease:oi,lpr:ai}=o("lprelease","lpr"),{hprelease:ci,hpr:ui}=o("hprelease","hpr"),{bprelease:pi,bpr:li}=o("bprelease","bpr"),{ftype:hi}=o("ftype"),{fanchor:fi}=o("fanchor"),{vib:di,vibrato:mi,v:yi}=o(["vib","vibmod"],"vibrato","v"),{noise:wi}=o("noise"),{vibmod:gi,vmod:bi}=o(["vibmod","vib"],"vmod"),{hcutoff:vi,hpf:ki,hp:_i}=o(["hcutoff","hresonance","hpenv"],"hpf","hp"),{hresonance:Si,hpq:xi}=o("hresonance","hpq"),{resonance:Ti,lpq:qi}=o("resonance","lpq"),{djf:Ai}=o("djf"),{delay:zi}=o(["delay","delaytime","delayfeedback"]),{delayfeedback:Bi,delayfb:Ci,dfb:Oi}=o("delayfeedback","delayfb","dfb"),{delayspeed:Ni}=o("delayspeed"),{delaytime:Ei,delayt:Pi,dt:Mi}=o("delaytime","delayt","dt"),{delaysync:Ii}=o("delaysync"),{lock:Wi}=o("lock"),{detune:ji,det:Ji}=o("detune","det"),{unison:Li}=o("unison"),{spread:Ri}=o("spread"),{dry:Zi}=o("dry"),{fadeTime:Fi,fadeOutTime:Hi}=o("fadeTime","fadeOutTime"),{fadeInTime:Ki}=o("fadeInTime"),{freq:Gi}=o("freq"),{pattack:$i,patt:Vi}=o("pattack","patt"),{pdecay:Yi,pdec:Di}=o("pdecay","pdec"),{psustain:Xi,psus:Qi}=o("psustain","psus"),{prelease:Ui,prel:eo}=o("prelease","prel"),{penv:to}=o("penv"),{pcurve:no}=o("pcurve"),{panchor:ro}=o("panchor"),{gate:so,gat:io}=o("gate","gat"),{leslie:oo}=o("leslie"),{lrate:ao}=o("lrate"),{lsize:co}=o("lsize"),{activeLabel:uo}=o("activeLabel"),{label:po}=o(["label","activeLabel"]),{degree:lo}=o("degree"),{mtranspose:ho}=o("mtranspose"),{ctranspose:fo}=o("ctranspose"),{harmonic:mo}=o("harmonic"),{stepsPerOctave:yo}=o("stepsPerOctave"),{octaveR:wo}=o("octaveR"),{nudge:go}=o("nudge"),{octave:bo}=o("octave"),{orbit:vo}=o("orbit"),{overgain:ko}=o("overgain"),{overshape:_o}=o("overshape"),{pan:So}=o("pan"),{panspan:xo}=o("panspan"),{pansplay:To}=o("pansplay"),{panwidth:qo}=o("panwidth"),{panorient:Ao}=o("panorient"),{rate:zo}=o("rate"),{slide:Bo}=o("slide"),{semitone:Co}=o("semitone"),{voice:Oo}=o("voice"),{chord:No}=o("chord"),{dictionary:Eo,dict:Po}=o("dictionary","dict"),{anchor:Mo}=o("anchor"),{offset:Io}=o("offset"),{octaves:Wo}=o("octaves"),{mode:jo}=o(["mode","anchor"]),{room:Jo}=o(["room","size"]),{roomlp:Lo,rlp:Ro}=o("roomlp","rlp"),{roomdim:Zo,rdim:Fo}=o("roomdim","rdim"),{roomfade:Ho,rfade:Ko}=o("roomfade","rfade"),{ir:Go,iresponse:$o}=o(["ir","i"],"iresponse"),{irspeed:Vo}=o("irspeed"),{irbegin:Yo}=o("irbegin"),{roomsize:Do,size:Xo,sz:Qo,rsize:Uo}=o("roomsize","size","sz","rsize"),{shape:ea}=o(["shape","shapevol"]),{distort:ta,dist:na}=o(["distort","distortvol","distorttype"],"dist"),{distortvol:ra}=o("distortvol","distvol"),{distorttype:sa}=o("distorttype","disttype"),{compressor:ia}=o(["compressor","compressorRatio","compressorKnee","compressorAttack","compressorRelease"]),{compressorKnee:oa}=o("compressorKnee"),{compressorRatio:aa}=o("compressorRatio"),{compressorAttack:ca}=o("compressorAttack"),{compressorRelease:ua}=o("compressorRelease"),{speed:ot}=o("speed"),{stretch:pa}=o("stretch"),{unit:la}=o("unit"),{squiz:ha}=o("squiz"),{vowel:fa}=o("vowel"),{waveloss:da}=o("waveloss"),{density:ef}=o("density"),{expression:ma}=o("expression"),{sustainpedal:ya}=o("sustainpedal"),{fshift:wa}=o("fshift"),{fshiftnote:ga}=o("fshiftnote"),{fshiftphase:ba}=o("fshiftphase"),{triode:va}=o("triode"),{krush:ka}=o("krush"),{kcutoff:_a}=o("kcutoff"),{octer:Sa}=o("octer"),{octersub:xa}=o("octersub"),{octersubsub:Ta}=o("octersubsub"),{ring:qa}=o("ring"),{ringf:Aa}=o("ringf"),{ringdf:za}=o("ringdf"),{freeze:Ba}=o("freeze"),{xsdelay:Ca}=o("xsdelay"),{tsdelay:Oa}=o("tsdelay"),{real:Na}=o("real"),{imag:Ea}=o("imag"),{enhance:Pa}=o("enhance"),{partials:Ma}=o("partials"),{comb:Ia}=o("comb"),{smear:Wa}=o("smear"),{scram:ja}=o("scram"),{binshift:Ja}=o("binshift"),{hbrick:La}=o("hbrick"),{lbrick:Ra}=o("lbrick"),{frameRate:Za}=o("frameRate"),{frames:Fa}=o("frames"),{hours:Ha}=o("hours"),{minutes:Ka}=o("minutes"),{seconds:Ga}=o("seconds"),{songPtr:$a}=o("songPtr"),{uid:Va}=o("uid"),{val:Ya}=o("val"),{cps:Da}=o("cps"),{clip:Xa,legato:Qa}=o("clip","legato"),{duration:Ua,dur:ec}=o("duration","dur"),{zrand:tc}=o("zrand"),{curve:nc}=o("curve"),{deltaSlide:rc}=o("deltaSlide"),{pitchJump:sc}=o("pitchJump"),{pitchJumpTime:ic}=o("pitchJumpTime"),{lfo:oc,repeatTime:ac}=o("lfo","repeatTime"),{znoise:cc}=o("znoise"),{zmod:uc}=o("zmod"),{zcrush:pc}=o("zcrush"),{zdelay:lc}=o("zdelay"),{zzfx:hc}=o("zzfx"),{color:fc,colour:dc}=o(["color","colour"]);let mc=(...e)=>e.reduce((t,n)=>Object.assign(t,{[n]:Ne(n)}),{});const yc=l("adsr",(e,t)=>{e=Array.isArray(e)?e:[e];const[n,r,s,i]=e;return t.set({attack:n,decay:r,sustain:s,release:i})}),wc=l("ad",(e,t)=>{e=Array.isArray(e)?e:[e];const[n,r=n]=e;return t.attack(n).decay(r)}),gc=l("ds",(e,t)=>{e=Array.isArray(e)?e:[e];const[n,r=0]=e;return t.set({decay:n,sustain:r})}),bc=l("ar",(e,t)=>{e=Array.isArray(e)?e:[e];const[n,r=n]=e;return t.set({attack:n,release:r})}),{midichan:vc}=o("midichan"),{midimap:kc}=o("midimap"),{midiport:_c}=o("midiport"),{midicmd:Sc}=o("midicmd"),xc=l("control",(e,t)=>{if(!Array.isArray(e))throw new Error("control expects an array of [ccn, ccv]");const[n,r]=e;return t.ccn(n).ccv(r)}),{ccn:Tc}=o("ccn"),{ccv:qc}=o("ccv"),{ctlNum:Ac}=o("ctlNum"),{nrpnn:zc}=o("nrpnn"),{nrpv:Bc}=o("nrpv"),{progNum:Cc}=o("progNum"),Oc=l("sysex",(e,t)=>{if(!Array.isArray(e))throw new Error("sysex expects an array of [id, data]");const[n,r]=e;return t.sysexid(n).sysexdata(r)}),{sysexid:Nc}=o("sysexid"),{sysexdata:Ec}=o("sysexdata"),{midibend:Pc}=o("midibend"),{miditouch:Mc}=o("miditouch"),{polyTouch:Ic}=o("polyTouch"),{oschost:Wc}=o("oschost"),{oscport:jc}=o("oscport"),at=e=>_e.has(e)?_e.get(e):e,Jc=l("as",(e,t)=>(e=Array.isArray(e)?e:[e],t.fmap(n=>(n=Array.isArray(n)?n:[n],n=Object.fromEntries(e.map((r,s)=>[at(r),n[s]])),n)))),Lc=l("scrub",(e,t)=>e.outerBind(n=>{Array.isArray(n)||(n=[n]);const[r,s=1]=n;return t.begin(r).mul(ot(s)).clip(1)}),!1),tf=Object.freeze(Object.defineProperty({__proto__:null,accelerate:hr,activeLabel:uo,ad:wc,adsr:yc,amp:yr,analyze:Or,anchor:Mo,ar:bc,as:Jc,att:gr,attack:wr,bandf:Lr,bandq:Fr,bank:Br,bbexpr:hs,bbst:ds,begin:Kr,binshift:Ja,bp:Zr,bpa:$s,bpattack:Gs,bpd:Us,bpdecay:Qs,bpe:Rs,bpenv:Ls,bpf:Rr,bpq:Hr,bpr:li,bprelease:pi,bps:ii,bpsustain:si,byteBeatExpression:ls,byteBeatStartTime:fs,ccn:Tc,ccv:qc,ch:ys,channel:Cs,channels:ms,chord:No,chorus:Cr,clip:Xa,coarse:Ur,color:fc,colour:dc,comb:Ia,compressor:ia,compressorAttack:ca,compressorKnee:oa,compressorRatio:aa,compressorRelease:ua,control:xc,cps:Da,createParam:Ne,createParams:mc,crush:Qr,ctf:Es,ctlNum:Ac,ctranspose:fo,curve:nc,cut:Os,cutoff:Ns,dec:Pr,decay:Er,degree:lo,delay:zi,delayfb:Ci,delayfeedback:Bi,delayspeed:Ni,delaysync:Ii,delayt:Pi,delaytime:Ei,deltaSlide:rc,density:ef,det:Ji,detune:ji,dfb:Oi,dict:Po,dictionary:Eo,dist:na,distort:ta,distorttype:sa,distortvol:ra,djf:Ai,drive:os,dry:Zi,ds:gc,dt:Mi,duck:as,duckattack:ps,duckdepth:cs,duckonset:us,dur:ec,duration:Ua,end:Gr,enhance:Pa,expression:ma,fadeInTime:Ki,fadeOutTime:Hi,fadeTime:Fi,fanchor:fi,fft:Nr,fm:kr,fmattack:Sr,fmdecay:Tr,fmenv:_r,fmh:br,fmi:vr,fmrelease:Ar,fmsustain:qr,fmvelocity:zr,fmwave:xr,frameRate:Za,frames:Fa,freeze:Ba,freq:Gi,fshift:wa,fshiftnote:ga,fshiftphase:ba,ftype:hi,gain:dr,gat:io,gate:so,getControlName:at,harmonic:mo,hbrick:La,hcutoff:vi,hold:Jr,hours:Ha,hp:_i,hpa:Ks,hpattack:Hs,hpd:Xs,hpdecay:Ds,hpe:Js,hpenv:js,hpf:ki,hpq:xi,hpr:ui,hprelease:ci,hps:ri,hpsustain:ni,hresonance:Si,imag:Ea,ir:Go,irbegin:Yo,iresponse:$o,irspeed:Vo,isControlName:kn,kcutoff:_a,krush:ka,label:po,lbrick:Ra,legato:Qa,leslie:oo,lfo:oc,lock:Wi,loop:$r,loopBegin:Vr,loopEnd:Dr,loopb:Yr,loope:Xr,lp:Ms,lpa:Fs,lpattack:Zs,lpd:Ys,lpdecay:Vs,lpe:Ws,lpenv:Is,lpf:Ps,lpq:qi,lpr:ai,lprelease:oi,lps:ti,lpsustain:ei,lrate:ao,lsize:co,midibend:Pc,midichan:vc,midicmd:Sc,midimap:kc,midiport:_c,miditouch:Mc,minutes:Ka,mode:jo,mtranspose:ho,n:pr,noise:wi,note:lr,nrpnn:zc,nrpv:Bc,nudge:go,octave:bo,octaveR:wo,octaves:Wo,octer:Sa,octersub:xa,octersubsub:Ta,offset:Io,orbit:vo,oschost:Wc,oscport:jc,overgain:ko,overshape:_o,pan:So,panchor:ro,panorient:Ao,panspan:xo,pansplay:To,panwidth:qo,partials:Ma,patt:Vi,pattack:$i,pcurve:no,pdec:Di,pdecay:Yi,penv:to,ph:ks,phasdp:Bs,phaser:_s,phasercenter:Ts,phaserdepth:As,phaserrate:vs,phasersweep:Ss,phc:qs,phd:zs,phs:xs,pitchJump:sc,pitchJumpTime:ic,polyTouch:Ic,postgain:mr,prel:eo,prelease:Ui,progNum:Cc,psus:Qi,psustain:Xi,pw:ws,pwrate:gs,pwsweep:bs,rate:zo,rdim:Fo,real:Na,registerControl:o,rel:jr,release:Wr,repeatTime:ac,resonance:Ti,rfade:Ko,ring:qa,ringdf:za,ringf:Aa,rlp:Ro,room:Jo,roomdim:Zo,roomfade:Ho,roomlp:Lo,roomsize:Do,rsize:Uo,s:_n,scram:ja,scrub:Lc,seconds:Ga,semitone:Co,shape:ea,size:Xo,slide:Bo,smear:Wa,songPtr:$a,sound:Sn,source:cr,speed:ot,spread:Ri,squiz:ha,src:ur,stepsPerOctave:yo,stretch:pa,sus:Ir,sustain:Mr,sustainpedal:ya,sysex:Oc,sysexdata:Ec,sysexid:Nc,sz:Qo,tremolo:es,tremolodepth:ns,tremolophase:ss,tremoloshape:is,tremoloskew:rs,tremolosync:ts,triode:va,tsdelay:Oa,uid:Va,unison:Li,unit:la,v:yi,val:Ya,velocity:fr,vib:di,vibmod:gi,vibrato:mi,vmod:bi,voice:Oo,vowel:fa,warp:Rn,warpatt:Hn,warpattack:Fn,warpdc:er,warpdec:Gn,warpdecay:Kn,warpdepth:Qn,warpenv:or,warpmode:nr,warprate:Xn,warprel:Dn,warprelease:Yn,warpshape:Un,warpskew:tr,warpsus:Vn,warpsustain:$n,warpsync:ar,waveloss:da,wavetablePhaseRand:ir,wavetablePosition:Tn,wavetableWarp:Zn,wavetableWarpMode:rr,wt:xn,wtatt:zn,wtattack:An,wtdc:Jn,wtdec:Cn,wtdecay:Bn,wtdepth:Wn,wtenv:qn,wtphaserand:sr,wtrate:Mn,wtrel:Pn,wtrelease:En,wtshape:jn,wtskew:Ln,wtsus:Nn,wtsustain:On,wtsync:In,xsdelay:Ca,zcrush:pc,zdelay:lc,zmod:uc,znoise:cc,zrand:tc,zzfx:hc},Symbol.toStringTag,{value:"Module"})),nf=function(e,t){const[n,r]=e,[s,i]=t,[a,c]=Qe(r,s);return[[r,n-r],[Ce((u,p)=>u.concat(p),a,i),c]]},rf=function(e,t){const[n,r]=e,[s,i]=t,[a,c]=Qe(n,i);return[[n,r-n],[Ce((u,p)=>u.concat(p),s,a),c]]},Rc=function(e,t){const[n,r]=e;return Math.min(n,r)<=1?[e,t]:Rc(...n>r?nf(e,t):rf(e,t))},ct=function(e,t){const n=e<0,r=Math.abs(e),s=t-r,i=Array(r).fill([1]),a=Array(s).fill([0]),c=Rc([r,s],[i,a]),u=U(c[1][0]).concat(U(c[1][1]));return n?u.map(p=>1-p):u},Ee=function(e,t,n){const r=ct(e,t);return n?Mt(r,-n):r},sf=l("euclid",function(e,t,n){return n.struct(Ee(e,t,0))}),of=l("e",function(e,t){Array.isArray(e)||(e=[e]);const[n,r=n,s=0]=e;return t.struct(Ee(n,r,s))}),{euclidrot:af,euclidRot:cf}=l(["euclidrot","euclidRot"],function(e,t,n,r){return r.struct(Ee(e,t,n))}),Zc=function(e,t,n,r){if(e<1)return q;const s=Ee(e,t,0).join("").split("1").slice(1).map(i=>[i.length+1,!0]);return r.struct(wn(...s)).late(d(n).div(t))},uf=l(["euclidLegato"],function(e,t,n){return Zc(e,t,0,n)}),pf=l(["euclidLegatoRot"],function(e,t,n,r){return Zc(e,t,n,r)}),{euclidish:lf,eish:hf}=l(["euclidish","eish"],function(e,t,n,r){const s=it(ct(e,t),new Array(e).fill(1),n);return r.struct(s).setSteps(t)});function Fc(e,t,n=.05,r=.1,s=.1,i=globalThis.setInterval,a=globalThis.clearInterval,c=!0){let u=0,p=0,y=10**4,f=.01;const S=B=>n=B(n);s=s||r/2;const k=()=>{const B=e(),X=B+r+s;for(p===0&&(p=B+f);p<X;)p=c?Math.round(p*y)/y:p,t(p,n,u,B),p+=n,u++};let A;const T=()=>{Y(),k(),A=i(k,r*1e3)},Y=()=>{A!==void 0&&a(A),A=void 0};return{setDuration:S,start:T,stop:()=>{u=0,p=0,Y()},pause:()=>Y(),duration:n,interval:r,getPhase:()=>p,minLatency:f}}function ff(e){return new h(t=>[new O(void 0,t.span,e)])}const G=e=>{const t=n=>[new O(void 0,n.span,e(n.span.begin))];return new h(t)},Ae=G(e=>e%1),ut=Ae.toBipolar(),Pe=G(e=>1-e%1),pt=Pe.toBipolar(),lt=G(e=>Math.sin(Math.PI*2*e)),Hc=lt.fromBipolar(),df=Hc._early(d(1).div(4)),mf=lt._early(d(1).div(4)),Kc=G(e=>Math.floor(e*2%2)),yf=Kc.toBipolar(),wf=R(Ae,Pe),gf=R(ut,pt),bf=R(Pe,Ae),vf=R(pt,ut),ht=G(le);let ft=0,dt=0;typeof window<"u"&&document.addEventListener("mousemove",e=>{ft=e.clientY/document.body.clientHeight,dt=e.clientX/document.body.clientWidth});const kf=G(()=>ft),_f=G(()=>ft),Sf=G(()=>dt),xf=G(()=>dt),Gc=e=>{const t=e<<13^e,n=t>>17^t;return n<<5^n},Tf=e=>e-Math.trunc(e),$c=e=>Gc(Math.trunc(Tf(e/300)*536870912)),Vc=e=>e%536870912/536870912,Se=e=>Math.abs(Vc($c(e))),qf=(e,t)=>{const n=[];for(let r=0;r<t;++r)n.push(Vc(e)),e=Gc(e);return n},Af=(e,t)=>qf($c(e),t),Yc=e=>Ae.range(0,e).round().segment(e),zf=e=>{const t=m(e).log2(0).floor().add(1);return Dc(e,t)},Dc=(e,t=16)=>{t=m(t);const n=Yc(t).mul(-1).add(t.sub(1));return m(e).segment(t).brshift(n).band(W(1))},Xc=e=>G(t=>{const n=Af(t.floor().add(.5),e).map((s,i)=>[s,i]).sort((s,i)=>(s[0]>i[0])-(s[0]<i[0])).map(s=>s[1]),r=t.cyclePos().mul(e).floor()%e;return n[r]})._segment(e),Qc=(e,t,n)=>{const r=[...Array(t).keys()].map(s=>n.zoom(d(s).div(t),d(s+1).div(t)));return e.fmap(s=>r[s].repeatCycles(t)._fast(t)).innerJoin()},Bf=l("shuffle",(e,t)=>Qc(Xc(e),e,t)),Cf=l("scramble",(e,t)=>Qc(yt(e)._segment(e),e,t)),K=G(Se),Of=K.toBipolar(),mt=e=>K.fmap(t=>t<e),Nf=e=>m(e).fmap(mt).innerJoin(),Ef=mt(.5),yt=e=>K.fmap(t=>Math.trunc(t*e)),Pf=e=>m(e).fmap(yt).innerJoin(),wt=(e,t)=>(t=t.map(m),t.length==0?q:e.range(0,t.length).fmap(n=>{const r=Math.min(Math.max(Math.floor(n),0),t.length-1);return t[r]})),Me=(e,t)=>wt(e,t).outerJoin(),gt=(e,t)=>wt(e,t).innerJoin(),Uc=(...e)=>Me(K,e),Mf=(...e)=>gt(K,e),If=Uc;h.prototype.choose=function(...e){return Me(this,e)};h.prototype.choose2=function(...e){return Me(this.fromBipolar(),e)};const eu=(...e)=>gt(K.segment(1),e),Wf=eu,tu=function(e,...t){const n=t.map(c=>m(c[0])),r=[];let s=W(0);for(const c of t)s=s.add(c[1]),r.push(s);const i=Vt(r),a=function(c){const u=s.mul(c);return i.fmap(p=>y=>n[p.findIndex(f=>f>y,p)]).appLeft(u)};return e.bind(a)},jf=(...e)=>tu(...e).outerJoin(),Jf=(...e)=>jf(K,...e),nu=(...e)=>tu(K.segment(1),...e).innerJoin(),Lf=nu;function Rf(e){let t=Math.floor(e),n=t+1;const r=s=>6*s**5-15*s**4+10*s**3;return(s=>i=>a=>i+r(s)*(a-i))(e-t)(Se(t))(Se(n))}const ru=e=>e.fmap(Rf);function Zf(e){const t=Math.floor(e),n=t+1,r=Se(t),s=Se(n)+r,i=(e-t)/(n-t);return((a,c,u)=>a+(c-a)*u)(r,s,i)/2}const su=e=>e.fmap(Zf),Ff=ru(ht.fmap(e=>Number(e))),Hf=su(ht.fmap(e=>Number(e))),Kf=l("degradeByWith",(e,t,n)=>n.fmap(r=>s=>r).appLeft(e.filterValues(r=>r>t)),!0,!0),Gf=l("degradeBy",function(e,t){return t._degradeByWith(K,e)},!0,!0),$f=l("degrade",e=>e._degradeBy(.5),!0,!0),Vf=l("undegradeBy",function(e,t){return t._degradeByWith(K.fmap(n=>1-n),e)},!0,!0),Yf=l("undegrade",e=>e._undegradeBy(.5),!0,!0),Df=l("sometimesBy",function(e,t,n){return m(e).fmap(r=>E(n._degradeBy(r),t(n._undegradeBy(1-r)))).innerJoin()}),Xf=l("sometimes",function(e,t){return t._sometimesBy(.5,e)}),Qf=l("someCyclesBy",function(e,t,n){return m(e).fmap(r=>E(n._degradeByWith(K._segment(1),r),t(n._degradeByWith(K.fmap(s=>1-s)._segment(1),1-r)))).innerJoin()}),Uf=l("someCycles",function(e,t){return t._someCyclesBy(.5,e)}),ed=l("often",function(e,t){return t.sometimesBy(.75,e)}),td=l("rarely",function(e,t){return t.sometimesBy(.25,e)}),nd=l("almostNever",function(e,t){return t.sometimesBy(.1,e)}),rd=l("almostAlways",function(e,t){return t.sometimesBy(.9,e)}),sd=l("never",function(e,t){return t}),id=l("always",function(e,t){return e(t)});function bt(e){Array.isArray(e)===!1&&(e=[e]);const t=Gt();return e.every(n=>{const r=Kt.get(n)??n;return t[r]})}const od=l("whenKey",function(e,t,n){return n.when(bt(e),t)}),ad=l("keyDown",function(e){return e.fmap(bt)}),D=function(e,t,n=!0){const r=Array.isArray(e),s=Object.keys(e).length;return e=Ft(e,m),s===0?q:t.fmap(i=>{let a=i;return r&&(a=n?Math.round(a)%s:Jt(Math.round(a),0,e.length-1)),e[a]})},iu=function(e,t){return Array.isArray(t)&&([t,e]=[e,t]),cd(e,t)},cd=l("pick",function(e,t){return D(e,t,!1).innerJoin()}),ou=l("pickmod",function(e,t){return D(e,t,!0).innerJoin()}),ud=l("pickF",function(e,t,n){return n.apply(iu(e,t))}),pd=l("pickmodF",function(e,t,n){return n.apply(ou(e,t))}),ld=l("pickOut",function(e,t){return D(e,t,!1).outerJoin()}),hd=l("pickmodOut",function(e,t){return D(e,t,!0).outerJoin()}),fd=l("pickRestart",function(e,t){return D(e,t,!1).restartJoin()}),dd=l("pickmodRestart",function(e,t){return D(e,t,!0).restartJoin()}),md=l("pickReset",function(e,t){return D(e,t,!1).resetJoin()}),yd=l("pickmodReset",function(e,t){return D(e,t,!0).resetJoin()}),{inhabit:wd,pickSqueeze:gd}=l(["inhabit","pickSqueeze"],function(e,t){return D(e,t,!1).squeezeJoin()}),{inhabitmod:bd,pickmodSqueeze:vd}=l(["inhabitmod","pickmodSqueeze"],function(e,t){return D(e,t,!0).squeezeJoin()}),kd=(e,t)=>(t=t.map(m),t.length==0?q:e.fmap(n=>{const r=Te(Math.round(n),t.length);return t[r]}).squeezeJoin());let he;try{he=window==null?void 0:window.speechSynthesis}catch{console.warn("cannot use window: not in browser?")}let Bt=he==null?void 0:he.getVoices();function _d(e,t,n){he.cancel();const r=new SpeechSynthesisUtterance(e);r.lang=t,Bt=he.getVoices();const s=Bt.filter(i=>i.lang.includes(t));typeof n=="number"?r.voice=s[n%s.length]:typeof n=="string"&&(r.voice=s.find(i=>i.name===i)),speechSynthesis.speak(r)}const Sd=l("speak",function(e,t,n){return n.onTrigger(r=>{_d(r.value,e,t)})}),au={},cu=async(...e)=>{const t=await Promise.allSettled(e),n=t.filter(r=>r.status==="fulfilled").map(r=>r.value);return t.forEach((r,s)=>{r.status==="rejected"&&console.warn(`evalScope: module with index ${s} could not be loaded:`,r.reason)}),n.forEach(r=>{Object.entries(r).forEach(([s,i])=>{globalThis[s]=i,au[s]=i})}),n};function xd(e,t={}){const{wrapExpression:n=!0,wrapAsync:r=!0}=t;n&&(e=`{${e}}`),r&&(e=`(async ()=>${e})()`);const s=`"use strict";return (${e})`;return Function(s)()}const uu=async(e,t,n)=>{let r={};if(t){const s=t(e,n);e=s.output,r=s}return{mode:"javascript",pattern:await xd(e,{wrapExpression:!!t}),meta:r}};class Td{constructor({onTrigger:t,onToggle:n,getTime:r}){this.started=!1,this.cps=.5,this.getTime=r,this.time_at_last_tick_message=0,this.collator=new Ht({getTargetClockTime:r}),this.onToggle=n,this.latency=.1,this.cycle=0,this.id=Math.round(Date.now()*Math.random()),this.worker=new SharedWorker(new URL(""+new URL("data:text/javascript;base64,KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIEwoKXtyZXR1cm4gcGVyZm9ybWFuY2Uubm93KCkqLjAwMX1sZXQgXz0wLHI9MCxvPS41O2NvbnN0IGg9bmV3IE1hcCxtPS4xLE09bmV3IEJyb2FkY2FzdENoYW5uZWwoInN0cnVkZWx0aWNrIiksYj0ocyxlKT0+e00ucG9zdE1lc3NhZ2Uoe3R5cGU6cyxwYXlsb2FkOmV9KX0sQz1FKEwsKHMsZSx0LG4pPT57Y29uc3QgaT1yKmUsZD1zLW4sYz1uK2QsdT1pKm8sbD1fK3UsZz1uLWMtZSxmPWUqbyxwPWwrZix5PWwrZypvO2IoInRpY2siLHtiZWdpbjpsLGVuZDpwLGNwczpvLHRpbWU6bixjeWNsZTp5fSkscisrfSxtKTtsZXQgaz0hMTtjb25zdCBJPXM9PntoLnNldChzLHtzdGFydGVkOiEwfSksIWsmJihDLnN0YXJ0KCksaz0hMCl9LEE9YXN5bmMgcz0+e2guc2V0KHMse3N0YXJ0ZWQ6ITF9KTtjb25zdCBlPUFycmF5LmZyb20oaC52YWx1ZXMoKSkuc29tZSh0PT50LnN0YXJ0ZWQpOyFrfHxlfHwoQy5zdG9wKCksdygwKSxrPSExKX0sdz1zPT57cj0wLF89c30sRD1zPT57Y29uc3R7dHlwZTplLHBheWxvYWQ6dH09cztzd2l0Y2goZSl7Y2FzZSJjcHNjaGFuZ2UiOntpZih0LmNwcyE9PW8pe2NvbnN0IG49ciptO189XytuKm8sbz10LmNwcyxyPTB9YnJlYWt9Y2FzZSJzZXRjeWNsZSI6e3codC5jeWNsZSk7YnJlYWt9Y2FzZSJ0b2dnbGUiOnt0LnN0YXJ0ZWQ/SShzLmlkKTpBKHMuaWQpO2JyZWFrfX19O3NlbGYub25jb25uZWN0PWZ1bmN0aW9uKHMpe2NvbnN0IGU9cy5wb3J0c1swXTtlLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLGZ1bmN0aW9uKHQpe0QodC5kYXRhKX0pLGUuc3RhcnQoKX07ZnVuY3Rpb24gRShzLGUsdD0uMDUsbj0uMSxpPS4xKXtsZXQgZD0wLGM9MCx1PTEwKio0LGw9LjAxO2NvbnN0IGc9YT0+dD1hKHQpO2k9aXx8bi8yO2NvbnN0IGY9KCk9Pntjb25zdCBhPXMoKSxPPWErbitpO2ZvcihjPT09MCYmKGM9YStsKTtjPE87KWM9TWF0aC5yb3VuZChjKnUpL3UsYz49YSYmZShjLHQsZCxhKSxjPGEmJmNvbnNvbGUubG9nKCJUT08gTEFURSIsYyksYys9dCxkKyt9O2xldCBwO2NvbnN0IHk9KCk9PntUKCksZigpLHA9c2V0SW50ZXJ2YWwoZixuKjFlMyl9LFQ9KCk9PnAhPT12b2lkIDAmJmNsZWFySW50ZXJ2YWwocCk7cmV0dXJue3NldER1cmF0aW9uOmcsc3RhcnQ6eSxzdG9wOigpPT57ZD0wLGM9MCxUKCl9LHBhdXNlOigpPT5UKCksZHVyYXRpb246dCxpbnRlcnZhbDpuLGdldFBoYXNlOigpPT5jLG1pbkxhdGVuY3k6bH19fSkoKTsK",import.meta.url).href,import.meta.url)),this.worker.port.start(),this.channel=new BroadcastChannel("strudeltick");const s=a=>{const{cps:c,begin:u,end:p,cycle:y,time:f}=a;this.cps=c,this.cycle=y;const S=this.collator.calculateOffset(f)+f;i(u,p,S),this.time_at_last_tick_message=S},i=(a,c,u)=>{this.started!==!1&&this.pattern.queryArc(a,c,{_cps:this.cps,cyclist:"neocyclist"}).forEach(p=>{if(p.hasOnset()){const y=Le(p.whole.begin-this.cycle,this.cps)+u+this.latency,f=Le(p.duration,this.cps);t==null||t(p,0,f,this.cps,y)}})};this.channel.onmessage=a=>{if(!this.started)return;const{payload:c,type:u}=a.data;switch(u){case"tick":s(c)}}}sendMessage(t,n){this.worker.port.postMessage({type:t,payload:n,id:this.id})}now(){const t=(this.getTime()-this.time_at_last_tick_message)*this.cps;return this.cycle+t}setCps(t=1){this.sendMessage("cpschange",{cps:t})}setCycle(t){this.sendMessage("setcycle",{cycle:t})}setStarted(t){var n;this.sendMessage("toggle",{started:t}),this.started=t,(n=this.onToggle)==null||n.call(this,t)}start(){j("[cyclist] start"),this.setStarted(!0)}stop(){j("[cyclist] stop"),this.collator.reset(),this.setStarted(!1)}setPattern(t,n=!1){this.pattern=t,n&&!this.started&&this.start()}log(t,n,r){const s=r.filter(i=>i.hasOnset());console.log(`${t.toFixed(4)} - ${n.toFixed(4)} ${Array(s.length).fill("I").join("")}`)}}class pu{constructor({interval:t,onTrigger:n,onToggle:r,onError:s,getTime:i,latency:a=.1,setInterval:c,clearInterval:u,beforeStart:p}){this.started=!1,this.beforeStart=p,this.cps=.5,this.num_ticks_since_cps_change=0,this.lastTick=0,this.lastBegin=0,this.lastEnd=0,this.getTime=i,this.num_cycles_at_cps_change=0,this.seconds_at_cps_change,this.onToggle=r,this.latency=a,this.clock=Fc(i,(y,f,S,k)=>{this.num_ticks_since_cps_change===0&&(this.num_cycles_at_cps_change=this.lastEnd,this.seconds_at_cps_change=y),this.num_ticks_since_cps_change++;const A=this.num_ticks_since_cps_change*f*this.cps;try{const T=this.lastEnd;this.lastBegin=T;const Y=this.num_cycles_at_cps_change+A;if(this.lastEnd=Y,this.lastTick=y,y<k){console.log("skip query: too late");return}this.pattern.queryArc(T,Y,{_cps:this.cps,cyclist:"cyclist"}).forEach(B=>{if(B.hasOnset()){const X=(B.whole.begin-this.num_cycles_at_cps_change)/this.cps+this.seconds_at_cps_change+a,Z=B.duration/this.cps,ae=X-y;n==null||n(B,ae,Z,this.cps,X),B.value.cps!==void 0&&this.cps!=B.value.cps&&(this.cps=B.value.cps,this.num_ticks_since_cps_change=0)}})}catch(T){Ye(T),s==null||s(T)}},t,.1,.1,c,u)}now(){if(!this.started)return 0;const t=this.getTime()-this.lastTick-this.clock.duration;return this.lastBegin+t*this.cps}setStarted(t){var n;this.started=t,(n=this.onToggle)==null||n.call(this,t)}async start(){var t;if(await((t=this.beforeStart)==null?void 0:t.call(this)),this.num_ticks_since_cps_change=0,this.num_cycles_at_cps_change=0,!this.pattern)throw new Error("Scheduler: no pattern set! call .setPattern first.");j("[cyclist] start"),this.clock.start(),this.setStarted(!0)}pause(){j("[cyclist] pause"),this.clock.pause(),this.setStarted(!1)}stop(){j("[cyclist] stop"),this.clock.stop(),this.lastEnd=0,this.setStarted(!1)}async setPattern(t,n=!1){this.pattern=t,n&&!this.started&&await this.start()}setCps(t=.5){this.cps!==t&&(this.cps=t,this.num_ticks_since_cps_change=0)}log(t,n,r){const s=r.filter(i=>i.hasOnset());console.log(`${t.toFixed(4)} - ${n.toFixed(4)} ${Array(s.length).fill("I").join("")}`)}}let Ke;function qd(){if(!Ke)throw new Error("no time set! use setTime to define a time source");return Ke()}function Ge(e){Ke=e}function Ad({defaultOutput:e,onEvalError:t,beforeEval:n,beforeStart:r,afterEval:s,getTime:i,transpiler:a,onToggle:c,editPattern:u,onUpdateState:p,sync:y=!1,setInterval:f,clearInterval:S,id:k,mondo:A=!1}){const T={schedulerError:void 0,evalError:void 0,code:"// LOADING",activeCode:"// LOADING",pattern:void 0,miniLocations:[],widgets:[],pending:!1,started:!1},Y={id:k},B=_=>{Object.assign(T,_),T.isDirty=T.code!==T.activeCode,T.error=T.evalError||T.schedulerError,p==null||p(T)},X={onTrigger:lu({defaultOutput:e,getTime:i}),getTime:i,onToggle:_=>{B({started:_}),c==null||c(_)},setInterval:f,clearInterval:S,beforeStart:r},Z=y&&typeof SharedWorker<"u"?new Td(X):new pu(X);let ae={},Ie=0,ce;const vt=function(){return ae={},Ie=0,ce=void 0,q};function kt(_){return _._Pattern?_.__pure:_}const _t=async(_,C=!0)=>(_=(u==null?void 0:u(_))||_,await Z.setPattern(_,C),_);Ge(()=>Z.now());const hu=()=>Z.stop(),fu=()=>Z.start(),du=()=>Z.pause(),mu=()=>Z.toggle(),We=_=>(Z.setCps(kt(_)),q),St=_=>(Z.setCps(kt(_)/60),q);let we=[];const yu=function(_){return we.push(_),q},wu=function(_){return ce=_,q},gu=()=>{h.prototype.p=function(C){return typeof C=="string"&&(C.startsWith("_")||C.endsWith("_"))?q:(C==="$"&&(C=`$${Ie}`,Ie++),ae[C]=this,this)},h.prototype.q=function(C){return q};try{for(let C=1;C<10;++C)Object.defineProperty(h.prototype,`d${C}`,{get(){return this.p(C)},configurable:!0}),Object.defineProperty(h.prototype,`p${C}`,{get(){return this.p(C)},configurable:!0}),h.prototype[`q${C}`]=q}catch(C){console.warn("injectPatternMethods: error:",C)}const _=l("cpm",function(C,je){return je._fast(C/60/Z.cps)});return cu({all:yu,each:wu,hush:vt,cpm:_,setCps:We,setcps:We,setCpm:St,setcpm:St})};return{scheduler:Z,evaluate:async(_,C=!0,je=!0)=>{if(!_)throw new Error("no code to evaluate");try{B({code:_,pending:!0}),await gu(),Ge(()=>Z.now()),await(n==null?void 0:n({code:_})),we=[],je&&vt(),A&&(_=`mondolang\`${_}\``);let{pattern:I,meta:se}=await uu(_,a,Y);if(Object.keys(ae).length){let te=[];for(const[Je,bu]of Object.entries(ae))te.push(bu.withState(vu=>vu.setControls({id:Je})));ce&&(te=te.map(Je=>ce(Je))),I=E(...te)}else ce&&(I=ce(I));if(we.length)for(let te in we)I=we[te](I);if(!et(I)){const te=`got "${typeof evaluated}" instead of pattern`;throw new Error(te+(typeof evaluated=="function"?", did you forget to call a function?":"."))}return j("[eval] code updated"),I=await _t(I,C),B({miniLocations:(se==null?void 0:se.miniLocations)||[],widgets:(se==null?void 0:se.widgets)||[],activeCode:_,pattern:I,evalError:void 0,schedulerError:void 0,pending:!1}),s==null||s({code:_,pattern:I,meta:se}),I}catch(I){j(`[eval] error: ${I.message}`,"error"),console.error(I),B({evalError:I,pending:!1}),t==null||t(I)}},start:fu,stop:hu,pause:du,setCps:We,setPattern:_t,setCode:_=>B({code:_}),toggle:mu,state:T}}const lu=({getTime:e,defaultOutput:t})=>async(n,r,s,i,a)=>{try{(!n.context.onTrigger||!n.context.dominantTrigger)&&await t(n,r,s,i,a),n.context.onTrigger&&await n.context.onTrigger(n,e(),i,a)}catch(c){Ye(c,"getTrigger")}},zd=function(e,t={}){const n=document.getElementById("code"),r="background-image:url("+e+");background-size:contain;";n.style=r;const{className:s}=n,i=(c,u)=>{({style:()=>n.style=r+";"+u,className:()=>n.className=u+" "+s})[c]()},a=Object.entries(t).filter(([c,u])=>typeof u=="function");Object.entries(t).filter(([c,u])=>typeof u=="string").forEach(([c,u])=>i(c,u)),a.length},Bd=()=>{const e=document.getElementById("code");e&&(e.style="")};j("🌀 @strudel/core loaded 🌀");globalThis._strudelLoaded&&console.warn(`@strudel/core was loaded more than once...
This might happen when you have multiple versions of strudel installed. 
Please check with "npm ls @strudel/core".`);globalThis._strudelLoaded=!0;const Nd=Object.freeze(Object.defineProperty({__proto__:null,ClockCollator:Ht,Cyclist:pu,Fraction:d,Hap:O,Pattern:h,State:fe,TimeSpan:N,__chooseWith:wt,_brandBy:mt,_fitslice:nn,_irand:yt,_keyDown:bt,_match:rn,_mod:Te,_morph:it,_polymeterListSteps:on,_retime:Fe,_slices:He,accelerate:hr,activeLabel:uo,ad:wc,add:Cp,adsr:yc,almostAlways:rd,almostNever:nd,always:id,amp:yr,analyze:Or,anchor:Mo,and:Yp,apply:Tl,applyN:tn,ar:bc,arp:up,arpWith:cp,arrange:mp,as:Jc,att:gr,attack:wr,averageArray:Et,backgroundImage:zd,band:Ip,bandf:Lr,bandq:Fr,bank:Br,base64ToUnicode:Zt,bbexpr:hs,bbst:ds,beat:Xh,begin:Kr,berlin:Hf,berlinWith:su,binary:zf,binaryN:Dc,bind:kp,binshift:Ja,bite:Ol,bjork:ct,blshift:Jp,bor:Wp,bp:Zr,bpa:$s,bpattack:Gs,bpd:Us,bpdecay:Qs,bpe:Rs,bpenv:Ls,bpf:Rr,bpq:Hr,bpr:li,bprelease:pi,bps:ii,bpsustain:si,brak:Rl,brand:Ef,brandBy:Nf,brshift:Lp,bxor:jp,bypass:wh,byteBeatExpression:ls,byteBeatStartTime:fs,calculateSteps:sp,cat:ke,ccn:Tc,ccv:qc,ceil:el,ch:ys,channel:Cs,channels:ms,choose:Uc,chooseCycles:eu,chooseIn:Mf,chooseInWith:gt,chooseOut:If,chooseWith:Me,chop:Rh,chord:No,chorus:Cr,chunk:oh,chunkBack:uh,chunkBackInto:yh,chunkInto:dh,chunkback:ph,chunkbackinto:mh,chunkinto:fh,clamp:Jt,cleanupUi:Bd,clip:Xa,coarse:Ur,code2hash:Xu,color:fc,colour:dc,comb:Ia,compose:Ju,compress:al,compressSpan:cl,compressor:ia,compressorAttack:ca,compressorKnee:oa,compressorRatio:aa,compressorRelease:ua,compressspan:ul,constant:Lu,contract:hn,control:xc,controls:tf,cosine:df,cosine2:mf,cpm:ql,cps:Da,createClock:Fc,createParam:Ne,createParams:mc,crush:Qr,ctf:Es,ctlNum:Ac,ctranspose:fo,curry:v,curve:nc,cut:Os,cutoff:Ns,cycleToSeconds:Le,dec:Pr,decay:Er,degrade:$f,degradeBy:Gf,degradeByWith:Kf,degree:lo,delay:zi,delayfb:Ci,delayfeedback:Bi,delayspeed:Ni,delaysync:Ii,delayt:Pi,delaytime:Ei,deltaSlide:rc,det:Ji,detune:ji,dfb:Oi,dict:Po,dictionary:Eo,dist:na,distort:ta,distorttype:sa,distortvol:ra,div:Ep,djf:Ai,drawLine:$t,drive:os,drop:un,dry:Zi,ds:gc,dt:Mi,duck:as,duckattack:ps,duckdepth:cs,duckonset:us,dur:ec,duration:Ua,e:of,early:Al,echo:Ql,echoWith:Vl,echowith:Yl,eish:hf,end:Gr,enhance:Pa,eq:Kp,eqt:Gp,errorLogger:Ye,euclid:sf,euclidLegato:uf,euclidLegatoRot:pf,euclidRot:cf,euclidish:lf,euclidrot:af,evalScope:cu,evaluate:uu,every:xl,expand:ln,expression:ma,extend:pn,fadeInTime:Ki,fadeOutTime:Hi,fadeTime:Fi,fanchor:fi,fast:yl,fastChunk:hh,fastGap:pl,fastcat:R,fastchunk:lh,fastgap:ll,fft:Nr,filter:_h,filterWhen:Sh,firstOf:Sl,fit:Gh,flatten:U,floor:Up,fm:kr,fmattack:Sr,fmdecay:Tr,fmenv:_r,fmh:br,fmi:vr,fmrelease:Ar,fmsustain:qr,fmvelocity:zr,fmwave:xr,focus:hl,focusSpan:fl,focusspan:dl,fractionalArgs:Ru,frameRate:Za,frames:Fa,freeze:Ba,freq:Gi,freqToMidi:Ot,fromBipolar:nl,fshift:wa,fshiftnote:ga,fshiftphase:ba,ftype:hi,func:Xp,gain:dr,gap:me,gat:io,gate:so,getControlName:at,getCurrentKeyboardState:Gt,getEventOffsetMs:Eu,getFreq:Nt,getFrequency:ju,getPerformanceTimeSeconds:Uu,getPlayableNoteValue:Wu,getSoundIndex:Iu,getTime:qd,getTrigger:lu,grow:qh,gt:Zp,gte:Hp,harmonic:mo,hash2code:Qu,hbrick:La,hcutoff:vi,hold:Jr,hours:Ha,hp:_i,hpa:Ks,hpattack:Hs,hpd:Xs,hpdecay:Ds,hpe:Js,hpenv:js,hpf:ki,hpq:xi,hpr:ui,hprelease:ci,hps:ri,hpsustain:ni,hresonance:Si,hsl:kh,hsla:vh,hurry:wl,id:le,imag:Ea,inhabit:wd,inhabitmod:bd,innerBind:_p,inside:vl,inv:jl,invert:Wl,ir:Go,irand:Pf,irbegin:Yo,iresponse:$o,irspeed:Vo,isControlName:kn,isNote:Be,isNoteWithOctave:Bu,isPattern:et,isaw:Pe,isaw2:pt,iter:nh,iterBack:rh,iterback:sh,itri:bf,itri2:vf,jux:$l,juxBy:Kl,juxby:Gl,kcutoff:_a,keep:zp,keepif:Bp,keyAlias:Kt,keyDown:ad,krush:ka,label:po,lastOf:_l,late:Ut,lbrick:Ra,legato:Qa,leslie:oo,lfo:oc,linger:Nl,listRange:qe,lock:Wi,logKey:Ve,logger:j,loop:$r,loopAt:Hh,loopAtCps:$h,loopBegin:Vr,loopEnd:Dr,loopat:Kh,loopatcps:Vh,loopb:Yr,loope:Xr,lp:Ms,lpa:Fs,lpattack:Zs,lpd:Ys,lpdecay:Vs,lpe:Ws,lpenv:Is,lpf:Ps,lpq:qi,lpr:ai,lprelease:oi,lps:ti,lpsustain:ei,lrate:ao,lsize:co,lt:Rp,lte:Fp,mapArgs:Xe,mask:wp,midi2note:Mu,midiToFreq:ve,midibend:Pc,midichan:vc,midicmd:Sc,midimap:kc,midiport:_c,miditouch:Mc,minutes:Ka,mod:Pp,mode:jo,morph:Qh,mouseX:xf,mouseY:_f,mousex:Sf,mousey:kf,mtranspose:ho,mul:Np,n:pr,nanFallback:Pt,ne:$p,net:Vp,never:sd,noise:wi,note:lr,noteToMidi:xe,nothing:V,nrpnn:zc,nrpv:Bc,nudge:go,numeralArgs:F,objectMap:Ft,octave:bo,octaveR:wo,octaves:Wo,octer:Sa,octersub:xa,octersubsub:Ta,off:Ll,offset:Io,often:ed,or:Dp,orbit:vo,oschost:Wc,oscport:jc,outerBind:Sp,outside:kl,overgain:ko,overshape:_o,pace:sn,pairs:jt,palindrome:Hl,pan:So,panchor:ro,panorient:Ao,panspan:xo,pansplay:To,panwidth:qo,parseFractional:Wt,parseNumeral:De,partials:Ma,patt:Vi,pattack:$i,pcurve:no,pdec:Di,pdecay:Yi,penv:to,perlin:Ff,perlinWith:ru,ph:ks,phasdp:Bs,phaser:_s,phasercenter:Ts,phaserdepth:As,phaserrate:vs,phasersweep:Ss,phc:qs,phd:zs,phs:xs,pick:iu,pickF:ud,pickOut:ld,pickReset:md,pickRestart:fd,pickSqueeze:gd,pickmod:ou,pickmodF:pd,pickmodOut:hd,pickmodReset:yd,pickmodRestart:dd,pickmodSqueeze:vd,pipe:It,pitchJump:sc,pitchJumpTime:ic,ply:ml,plyForEach:th,plyWith:eh,pm:fp,polyBind:qp,polyTouch:Ic,polymeter:Oe,polyrhythm:lp,postgain:mr,pow:Mp,pr:hp,prel:eo,prelease:Ui,press:Fl,pressBy:Zl,progNum:Cc,psus:Qi,psustain:Xi,pure:W,pw:ws,pwrate:gs,pwsweep:bs,rand:K,rand2:Of,randcat:Wf,randrun:Xc,range:rl,range2:il,rangex:sl,rarely:td,rate:zo,ratio:ol,rdim:Fo,real:Na,ref:Yh,register:l,registerControl:o,reify:m,rel:jr,release:Wr,removeUndefineds:de,repeatCycles:ih,repeatTime:ac,repl:Ad,replicate:Th,resonance:Ti,rev:en,rfade:Ko,rib:bh,ribbon:gh,ring:qa,ringdf:za,ringf:Aa,rlp:Ro,room:Jo,roomdim:Zo,roomfade:Ho,roomlp:Lo,roomsize:Do,rotate:Mt,round:Qp,rsize:Uo,run:Yc,s:_n,s_add:Eh,s_alt:Bh,s_cat:zh,s_contract:Wh,s_expand:Mh,s_extend:Ih,s_polymeter:Ch,s_sub:Ph,s_taper:Oh,s_taperlist:Nh,s_tour:jh,s_zip:Jh,saw:Ae,saw2:ut,scram:ja,scramble:Cf,scrub:Lc,seconds:Ga,seg:Pl,segment:El,semitone:Co,seq:Qt,seqPLoop:yp,sequence:ee,sequenceP:Vt,set:Ap,setStringParser:ip,setTime:Ge,shape:ea,shrink:dn,shrinklist:fn,shuffle:Bf,signal:G,silence:q,sine:Hc,sine2:lt,size:Xo,slice:bn,slide:Bo,slow:gl,slowChunk:ch,slowcat:re,slowcatPrime:nt,slowchunk:ah,smear:Wa,sol2note:Vu,someCycles:Uf,someCyclesBy:Qf,sometimes:Xf,sometimesBy:Df,songPtr:$a,sound:Sn,source:cr,sparsity:bl,speak:Sd,speed:ot,splice:Fh,splitAt:Qe,spread:Ri,square:Kc,square2:yf,squeeze:kd,squeezeBind:xp,squiz:ha,src:ur,stack:E,stackBy:dp,stackCentre:Xt,stackLeft:Yt,stackRight:Dt,steady:ff,stepBind:Tp,stepalt:an,stepcat:L,steps:Lh,stepsPerOctave:yo,stretch:pa,striate:Zh,stringifyValues:Ue,struct:gp,strudelScope:au,stut:Ul,stutWith:Dl,stutwith:Xl,sub:Op,superimpose:bp,sus:Ir,sustain:Mr,sustainpedal:ya,swing:Il,swingBy:Ml,sysex:Oc,sysexdata:Ec,sysexid:Nc,sz:Qo,take:cn,time:ht,timeCat:wn,timecat:Ah,toBipolar:tl,tokenizeNote:Ct,tour:mn,tremolo:es,tremolodepth:ns,tremolophase:ss,tremoloshape:is,tremoloskew:rs,tremolosync:ts,tri:wf,tri2:gf,triode:va,tsdelay:Oa,uid:Va,undegrade:Yf,undegradeBy:Vf,unicodeToBase64:Rt,uniq:Yu,uniqsort:Du,uniqsortr:Lt,unison:Li,unit:la,v:yi,val:Ya,valueToMidi:Nu,velocity:fr,vib:di,vibmod:gi,vibrato:mi,vmod:bi,voice:Oo,vowel:fa,warp:Rn,warpatt:Hn,warpattack:Fn,warpdc:er,warpdec:Gn,warpdecay:Kn,warpdepth:Qn,warpenv:or,warpmode:nr,warprate:Xn,warprel:Dn,warprelease:Yn,warpshape:Un,warpskew:tr,warpsus:Vn,warpsustain:$n,warpsync:ar,waveloss:da,wavetablePhaseRand:ir,wavetablePosition:Tn,wavetableWarp:Zn,wavetableWarpMode:rr,wchoose:Jf,wchooseCycles:nu,when:Jl,whenKey:od,withValue:vp,within:xh,wrandcat:Lf,wt:xn,wtatt:zn,wtattack:An,wtdc:Jn,wtdec:Cn,wtdecay:Bn,wtdepth:Wn,wtenv:qn,wtphaserand:sr,wtrate:Mn,wtrel:Pn,wtrelease:En,wtshape:jn,wtskew:Ln,wtsus:Nn,wtsustain:On,wtsync:In,xfade:vn,xsdelay:Ca,zcrush:pc,zdelay:lc,zip:yn,zipWith:Ce,zmod:uc,znoise:cc,zoom:zl,zoomArc:Bl,zoomarc:Cl,zrand:tc,zzfx:hc},Symbol.toStringTag,{value:"Module"}));export{Nd as A,E as B,j as E,ju as F,ee as G,Jt as H,K as L,mc as P,R as W,et as Y,Ot as a,Te as b,wn as c,m as d,o as e,h as f,gt as g,d as h,qd as i,Yh as j,Eu as k,l,ve as n,xe as p,Be as q,at as s,q as v,W as z};
