const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/strudel-web-Ddx65js9.js","assets/strudel-core-Cml4IbyB.js","assets/index-yklpTfks.js","assets/index-BlL7NNdw-BccxfaFl.js","assets/index-Dey5jBuS-BbPKYugp.js","assets/hydra-DKOnazUo-CxeqApDG.js","assets/index-A_ER2EO_-Ex0iZyga.js","assets/index-CGsTjduW-FbrGUNuc.js"])))=>i.map(i=>d[i]);
var UG=Object.defineProperty;var WG=(n,e,t)=>e in n?UG(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Yl=(n,e,t)=>WG(n,typeof e!="symbol"?e+"":e,t);import{l as Hd,M as pC,E as mC,z as GG,c as XG,d as km,q as Xx,e as dh,g as Ab,Y as HG,a as dO,m as Ap,n as YG,Q as KG,N as K7,P as JG,h as J7,j as wg,O as eX,k as tX,f as nX}from"./strudel-core-Cml4IbyB.js";import{o as sX,a as rX,B as e9}from"./strudel-web-Ddx65js9.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const aX="modulepreload",iX=function(n){return"/"+n},HE={},ds=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){let i=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=i(t.map(c=>{if(c=iX(c),c in HE)return;HE[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":aX,u||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((m,y)=>{d.addEventListener("load",m),d.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return r.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})},hs={elements:[{id:"element-1",selector:'[data-sound-id="element-1"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-2",selector:'[data-sound-id="element-2"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-3",selector:'[data-sound-id="element-3"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-4",selector:'[data-sound-id="element-4"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-5",selector:'[data-sound-id="element-5"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-6",selector:'[data-sound-id="element-6"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-7",selector:'[data-sound-id="element-7"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-8",selector:'[data-sound-id="element-8"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-9",selector:'[data-sound-id="element-9"]',type:"strudel",pattern:"",description:"No sound assigned"},{id:"element-10",selector:'[data-sound-id="element-10"]',type:"strudel",pattern:"",description:"No sound assigned"}],defaults:{proximityThreshold:100,hoverEnabled:!0,proximityEnabled:!0,volume:.5,fadeInTime:.1,fadeOutTime:.2},controls:{"proximity-threshold":{type:"synthesized",pattern:'sound("cp cp ~ cp")',description:"Threshold tick"},volume:{type:"synthesized",pattern:'sound("~ cp cp cp")',description:"Volume tick"}},getElementConfig(n){return this.elements.find(e=>e.id===n)},getSynthesizedElements(){return this.elements.filter(n=>n.type==="synthesized")},getAudioElements(){return this.elements.filter(n=>n.type==="audio")},getControlConfig(n){return this.controls[n]}};function oX(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function lX(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var t9=[0,2,4,-1,1,3,5],n9=t9.map(n=>Math.floor(n*7/12));function cX(n){const{step:e,alt:t,oct:s,dir:r=1}=n,a=t9[e]+7*t;if(s===void 0)return[r*a];const i=s-n9[e]-4*t;return[r*a,r*i]}var uX=[3,0,4,1,5,2,6];function hX(n){const[e,t,s]=n,r=uX[dX(e)],a=Math.floor((e+1)/7);if(t===void 0)return{step:r,alt:a,dir:s};const i=t+4*a+n9[r];return{step:r,alt:a,oct:i,dir:s}}function dX(n){const e=(n+1)%7;return e<0?7+e:e}var YE=(n,e)=>Array(Math.abs(e)+1).join(n),Hx=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),pX="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",mX="(AA|A|P|M|m|d|dd)([-+]?\\d+)",fX=new RegExp("^"+pX+"|"+mX+"$");function gX(n){const e=fX.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var KE={};function Eb(n){return typeof n=="string"?KE[n]||(KE[n]=bX(n)):lX(n)?Eb(OX(n)):oX(n)?Eb(n.name):Hx}var JE=[0,2,4,5,7,9,11],s9="PMMPPMM";function bX(n){const e=gX(n);if(e[0]==="")return Hx;const t=+e[0],s=e[1],r=(Math.abs(t)-1)%7,a=s9[r];if(a==="M"&&s==="P")return Hx;const i=a==="M"?"majorable":"perfectable",o=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(r+1),u=vX(i,s),h=Math.floor((Math.abs(t)-1)/7),d=l*(JE[r]+u+12*h),m=(l*(JE[r]+u)%12+12)%12,y=cX({step:r,alt:u,oct:h,dir:l});return{empty:!1,name:o,num:t,q:s,step:r,alt:u,dir:l,type:i,simple:c,semitones:d,chroma:m,coord:y,oct:h}}function yX(n,e){const[t,s=0]=n,r=t*7+s*12<0,a=e||r?[-t,-s,-1]:[t,s,1];return Eb(hX(a))}function vX(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function OX(n){const{step:e,alt:t,oct:s=0,dir:r}=n;if(!r)return"";const a=e+1+7*s,i=a===0?e+1:a,o=r<0?"-":"",l=s9[e]==="M"?"majorable":"perfectable";return o+i+wX(l,t)}function wX(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?YE("A",e):YE("d",n==="perfectable"?e:e+1)}function xX(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function kX(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var r9=[0,2,4,-1,1,3,5],a9=r9.map(n=>Math.floor(n*7/12));function SX(n){const{step:e,alt:t,oct:s,dir:r=1}=n,a=r9[e]+7*t;if(s===void 0)return[r*a];const i=s-a9[e]-4*t;return[r*a,r*i]}var CX=[3,0,4,1,5,2,6];function PX(n){const[e,t,s]=n,r=CX[AX(e)],a=Math.floor((e+1)/7);if(t===void 0)return{step:r,alt:a,dir:s};const i=t+4*a+a9[r];return{step:r,alt:a,oct:i,dir:s}}function AX(n){const e=(n+1)%7;return e<0?7+e:e}var eM=(n,e)=>Array(Math.abs(e)+1).join(n),i9=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),tM=new Map,EX=n=>"CDEFGAB".charAt(n),D1=n=>n<0?eM("b",-n):eM("#",n),fC=n=>n[0]==="b"?-n.length:n.length;function as(n){const e=JSON.stringify(n),t=tM.get(e);if(t)return t;const s=typeof n=="string"?BX(n):kX(n)?as(FX(n)):xX(n)?as(n.name):i9;return tM.set(e,s),s}var MX=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function gC(n){const e=MX.exec(n);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function DX(n){return as(PX(n))}var TX=(n,e)=>(n%e+e)%e,pO=[0,2,4,5,7,9,11];function BX(n){const e=gC(n);if(e[0]===""||e[3]!=="")return i9;const t=e[0],s=e[1],r=e[2],a=(t.charCodeAt(0)+3)%7,i=fC(s),o=r.length?+r:void 0,l=SX({step:a,alt:i,oct:o}),c=t+s+r,u=t+s,h=(pO[a]+i+120)%12,d=o===void 0?TX(pO[a]+i,12)-1188:pO[a]+i+12*(o+1),m=d>=0&&d<=127?d:null,y=o===void 0?null:Math.pow(2,(d-69)/12)*440;return{empty:!1,acc:s,alt:i,chroma:h,coord:l,freq:y,height:d,letter:t,midi:m,name:c,oct:o,pc:u,step:a}}function FX(n){const{step:e,alt:t,oct:s}=n,r=EX(e);if(!r)return"";const a=r+D1(t);return s||s===0?a+s:a}function Zo(n,e){const t=as(n),s=Array.isArray(e)?e:Eb(e).coord;if(t.empty||!s||s.length<2)return"";const r=t.coord,a=r.length===1?[r[0]+s[0]]:[r[0]+s[0],r[1]+s[1]];return DX(a).name}function o9(n,e){const t=n.length;return s=>{if(!e)return"";const r=s<0?(t- -s%t)%t:s%t,a=Math.floor(s/t),i=Zo(e,[0,a]);return Zo(i,n[r])}}function T1(n,e){const t=as(n),s=as(e);if(t.empty||s.empty)return"";const r=t.coord,a=s.coord,i=a[0]-r[0],o=r.length===2&&a.length===2?a[1]-r[1]:-Math.floor(i*7/12),l=s.height===t.height&&s.midi!==null&&t.oct===s.oct&&t.step>s.step;return yX([i,o],l).name}var nM=(n,e)=>Array(e+1).join(n),$X=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function l9(n){const e=$X.exec(n);return e?[e[1],e[2],e[3]]:["","",""]}function Mb(n){const[e,t,s]=l9(n);if(t==="")return"";let r=4;for(let i=0;i<s.length;i++)r+=s.charAt(i)===","?-1:1;const a=e[0]==="_"?e.replace(/_/g,"b"):e[0]==="^"?e.replace(/\^/g,"#"):"";return t.charCodeAt(0)>96?t.toUpperCase()+a+(r+1):t+a+r}function c9(n){const e=as(n);if(e.empty||!e.oct&&e.oct!==0)return"";const{letter:t,acc:s,oct:r}=e,a=s[0]==="b"?s.replace(/b/g,"_"):s.replace(/#/g,"^"),i=r>4?t.toLowerCase():t,o=r===5?"":r>4?nM("'",r-5):nM(",",4-r);return a+i+o}function NX(n,e){return c9(Zo(Mb(n),e))}function _X(n,e){return T1(Mb(n),Mb(e))}var RX={abcToScientificNotation:Mb,scientificToAbcNotation:c9,tokenize:l9,transpose:NX,distance:_X};function IX(n,e){const t=[];for(;e--;t[e]=e+n);return t}function LX(n,e){const t=[];for(;e--;t[e]=n-e);return t}function QX(n,e){return n<e?IX(n,e-n+1):LX(n,n-e+1)}function jX(n,e){const t=e.length,s=(n%t+t)%t;return e.slice(s,t).concat(e.slice(0,s))}function VX(n){return n.filter(e=>e===0||e)}function u9(n){return n.map(t=>as(t)).filter(t=>!t.empty).sort((t,s)=>t.height-s.height).map(t=>t.name)}function ZX(n){return u9(n).filter((e,t,s)=>t===0||e!==s[t-1])}function zX(n,e=Math.random){let t,s,r=n.length;for(;r;)t=Math.floor(e()*r--),s=n[r],n[r]=n[t],n[t]=s;return n}function h9(n){return n.length===0?[[]]:h9(n.slice(1)).reduce((e,t)=>e.concat(n.map((s,r)=>{const a=t.slice();return a.splice(r,0,n[0]),a})),[])}const qX=Object.freeze(Object.defineProperty({__proto__:null,compact:VX,permutations:h9,range:QX,rotate:jX,shuffle:zX,sortedNoteNames:u9,sortedUniqNoteNames:ZX},Symbol.toStringTag,{value:"Module"}));function UX(n,e){const t=[];for(;e--;t[e]=e+n);return t}function WX(n,e){const t=[];for(;e--;t[e]=n-e);return t}function B1(n,e){return n<e?UX(n,e-n+1):WX(n,n-e+1)}function Yd(n,e){const t=e.length,s=(n%t+t)%t;return e.slice(s,t).concat(e.slice(0,s))}function bC(n){return n.filter(e=>e===0||e)}function GX(n,e=Math.random){let t,s,r=n.length;for(;r;)t=Math.floor(e()*r--),s=n[r],n[r]=n[t],n[t]=s;return n}function d9(n){return n.length===0?[[]]:d9(n.slice(1)).reduce((e,t)=>e.concat(n.map((s,r)=>{const a=t.slice();return a.splice(r,0,n[0]),a})),[])}var XX={compact:bC,permutations:d9,range:B1,rotate:Yd,shuffle:GX};function HX(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function YX(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var p9=[0,2,4,-1,1,3,5],KX=p9.map(n=>Math.floor(n*7/12));function JX(n){const{step:e,alt:t,oct:s,dir:r=1}=n,a=p9[e]+7*t;if(s===void 0)return[r*a];const i=s-KX[e]-4*t;return[r*a,r*i]}var sM=(n,e)=>Array(Math.abs(e)+1).join(n),Yx=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),eH="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",tH="(AA|A|P|M|m|d|dd)([-+]?\\d+)",nH=new RegExp("^"+eH+"|"+tH+"$");function sH(n){const e=nH.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var rM={};function Kx(n){return typeof n=="string"?rM[n]||(rM[n]=rH(n)):YX(n)?Kx(iH(n)):HX(n)?Kx(n.name):Yx}var aM=[0,2,4,5,7,9,11],m9="PMMPPMM";function rH(n){const e=sH(n);if(e[0]==="")return Yx;const t=+e[0],s=e[1],r=(Math.abs(t)-1)%7,a=m9[r];if(a==="M"&&s==="P")return Yx;const i=a==="M"?"majorable":"perfectable",o=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(r+1),u=aH(i,s),h=Math.floor((Math.abs(t)-1)/7),d=l*(aM[r]+u+12*h),m=(l*(aM[r]+u)%12+12)%12,y=JX({step:r,alt:u,oct:h,dir:l});return{empty:!1,name:o,num:t,q:s,step:r,alt:u,dir:l,type:i,simple:c,semitones:d,chroma:m,coord:y,oct:h}}function aH(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function iH(n){const{step:e,alt:t,oct:s=0,dir:r}=n;if(!r)return"";const a=e+1+7*s,i=a===0?e+1:a,o=r<0?"-":"",l=m9[e]==="M"?"majorable":"perfectable";return o+i+oH(l,t)}function oH(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?sM("A",e):sM("d",n==="perfectable"?e:e+1)}var Bl={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},yC=n=>Number(n).toString(2).padStart(12,"0"),iM=n=>parseInt(n,2),lH=/^[01]{12}$/;function vC(n){return lH.test(n)}var cH=n=>typeof n=="number"&&n>=0&&n<=4095,uH=n=>n&&vC(n.chroma),oM={[Bl.chroma]:Bl};function Pr(n){const e=vC(n)?n:cH(n)?yC(n):Array.isArray(n)?xH(n):uH(n)?n.chroma:Bl.chroma;return oM[e]=oM[e]||wH(e)}var hH=Pr,f9=n=>Pr(n).chroma,dH=n=>Pr(n).intervals,pH=n=>Pr(n).setNum,mH=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function fH(n){const e=[];for(let t=0;t<12;t++)n.charAt(t)==="1"&&e.push(mH[t]);return e}function gH(n){return Pr(n).intervals.map(e=>Zo("C",e))}function bH(){return B1(2048,4095).map(yC)}function OC(n,e=!0){const s=Pr(n).chroma.split("");return bC(s.map((r,a)=>{const i=Yd(a,s);return e&&i[0]==="0"?null:i.join("")}))}function yH(n,e){return Pr(n).setNum===Pr(e).setNum}function F1(n){const e=Pr(n).setNum;return t=>{const s=Pr(t).setNum;return e&&e!==s&&(s&e)===s}}function $1(n){const e=Pr(n).setNum;return t=>{const s=Pr(t).setNum;return e&&e!==s&&(s|e)===s}}function g9(n){const e=Pr(n);return t=>{const s=as(t);return e&&!s.empty&&e.chroma.charAt(s.chroma)==="1"}}function vH(n){const e=g9(n);return t=>t.filter(e)}var b9={get:Pr,chroma:f9,num:pH,intervals:dH,chromas:bH,isSupersetOf:$1,isSubsetOf:F1,isNoteIncludedIn:g9,isEqual:yH,filter:vH,modes:OC,notes:gH,pcset:hH};function OH(n){const e=n.split("");return e.map((t,s)=>Yd(s,e).join(""))}function wH(n){const e=iM(n),t=OH(n).map(iM).filter(a=>a>=2048).sort()[0],s=yC(t),r=fH(n);return{empty:!1,name:"",setNum:e,chroma:n,normalized:s,intervals:r}}function xH(n){if(n.length===0)return Bl.chroma;let e;const t=[0,0,0,0,0,0,0,0,0,0,0,0];for(let s=0;s<n.length;s++)e=as(n[s]),e.empty&&(e=Kx(n[s])),e.empty||(t[e.chroma]=1);return t.join("")}var kH=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],SH=kH;({...Bl});var wC=[],j0={};function CH(){return wC.slice()}function PH(n,e,t){const s=EH(n),r={...Pr(n),name:t||"",quality:s,intervals:n,aliases:e};wC.push(r),r.name&&(j0[r.name]=r),j0[r.setNum]=r,j0[r.chroma]=r,r.aliases.forEach(a=>AH(r,a))}function AH(n,e){j0[e]=n}function EH(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}SH.forEach(([n,e,t])=>PH(n.split(" "),t.split(" "),e));wC.sort((n,e)=>n.setNum-e.setNum);var MH=n=>{const e=n.reduce((t,s)=>{const r=as(s).chroma;return r!==void 0&&(t[r]=t[r]||as(s).name),t},{});return t=>e[t]};function DH(n,e={}){const t=n.map(r=>as(r).pc).filter(r=>r);return as.length===0?[]:RH(t,1,e).filter(r=>r.weight).sort((r,a)=>a.weight-r.weight).map(r=>r.name)}var N1={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},_1=n=>e=>!!(e&n),TH=_1(N1.anyThirds),BH=_1(N1.perfectFifth),FH=_1(N1.anySeventh),$H=_1(N1.nonPerfectFifths);function NH(n){const e=parseInt(n.chroma,2);return TH(e)&&BH(e)&&FH(e)}function _H(n){const e=parseInt(n,2);return $H(e)?n:(e|16).toString(2)}function RH(n,e,t){const s=n[0],r=as(s).chroma,a=MH(n),i=OC(n,!1),o=[];return i.forEach((l,c)=>{const u=t.assumePerfectFifth&&_H(l);CH().filter(d=>t.assumePerfectFifth&&NH(d)?d.chroma===u:d.chroma===l).forEach(d=>{const m=d.aliases[0],y=a(c);c!==r?o.push({weight:.5*e,name:`${y}${m}/${s}`}):o.push({weight:1*e,name:`${y}${m}`})})}),o}function Qf(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}var y9=[0,2,4,5,7,9,11],v9=({step:n,alt:e})=>(y9[n]+e+120)%12,xC=({step:n,alt:e,oct:t,dir:s=1})=>s*(y9[n]+e+12*(t===void 0?-100:t)),O9=n=>{const e=xC(n);return n.oct!==void 0&&e>=-12&&e<=115?e+12:null};function R1(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"}var w9=[0,2,4,-1,1,3,5],x9=w9.map(n=>Math.floor(n*7/12));function I1(n){const{step:e,alt:t,oct:s,dir:r=1}=n,a=w9[e]+7*t;if(s===void 0)return[r*a];const i=s-x9[e]-4*t;return[r*a,r*i]}var IH=[3,0,4,1,5,2,6];function L1(n){const[e,t,s]=n,r=IH[LH(e)],a=Math.floor((e+1)/7);if(t===void 0)return{step:r,alt:a,dir:s};const i=t+4*a+x9[r];return{step:r,alt:a,oct:i,dir:s}}function LH(n){const e=(n+1)%7;return e<0?7+e:e}var lM=(n,e)=>Array(Math.abs(e)+1).join(n),Jx={empty:!0,name:"",acc:""},QH="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",jH="(AA|A|P|M|m|d|dd)([-+]?\\d+)",VH=new RegExp("^"+QH+"|"+jH+"$");function kC(n){const e=VH.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var cM={};function la(n){return typeof n=="string"?cM[n]||(cM[n]=ZH(n)):R1(n)?la(qH(n)):Qf(n)?la(n.name):Jx}var uM=[0,2,4,5,7,9,11],k9="PMMPPMM";function ZH(n){const e=kC(n);if(e[0]==="")return Jx;const t=+e[0],s=e[1],r=(Math.abs(t)-1)%7,a=k9[r];if(a==="M"&&s==="P")return Jx;const i=a==="M"?"majorable":"perfectable",o=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(r+1),u=zH(i,s),h=Math.floor((Math.abs(t)-1)/7),d=l*(uM[r]+u+12*h),m=(l*(uM[r]+u)%12+12)%12,y=I1({step:r,alt:u,oct:h,dir:l});return{empty:!1,name:o,num:t,q:s,step:r,alt:u,dir:l,type:i,simple:c,semitones:d,chroma:m,coord:y,oct:h}}function jf(n,e){const[t,s=0]=n,r=t*7+s*12<0,a=e||r?[-t,-s,-1]:[t,s,1];return la(L1(a))}function zH(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function qH(n){const{step:e,alt:t,oct:s=0,dir:r}=n;if(!r)return"";const a=e+1+7*s,i=a===0?e+1:a,o=r<0?"-":"",l=k9[e]==="M"?"majorable":"perfectable";return o+i+UH(l,t)}function UH(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?lM("A",e):lM("d",n==="perfectable"?e:e+1)}var hM=(n,e)=>Array(Math.abs(e)+1).join(n),S9={empty:!0,name:"",pc:"",acc:""},dM=new Map,SC=n=>"CDEFGAB".charAt(n),CC=n=>n<0?hM("b",-n):hM("#",n),PC=n=>n[0]==="b"?-n.length:n.length;function Fl(n){const e=JSON.stringify(n),t=dM.get(e);if(t)return t;const s=typeof n=="string"?XH(n):R1(n)?Fl(HH(n)):Qf(n)?Fl(n.name):S9;return dM.set(e,s),s}var WH=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Q1(n){const e=WH.exec(n);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function AC(n){return Fl(L1(n))}var GH=(n,e)=>(n%e+e)%e,mO=[0,2,4,5,7,9,11];function XH(n){const e=Q1(n);if(e[0]===""||e[3]!=="")return S9;const t=e[0],s=e[1],r=e[2],a=(t.charCodeAt(0)+3)%7,i=PC(s),o=r.length?+r:void 0,l=I1({step:a,alt:i,oct:o}),c=t+s+r,u=t+s,h=(mO[a]+i+120)%12,d=o===void 0?GH(mO[a]+i,12)-1188:mO[a]+i+12*(o+1),m=d>=0&&d<=127?d:null,y=o===void 0?null:Math.pow(2,(d-69)/12)*440;return{empty:!1,acc:s,alt:i,chroma:h,coord:l,freq:y,height:d,letter:t,midi:m,name:c,oct:o,pc:u,step:a}}function HH(n){const{step:e,alt:t,oct:s}=n,r=SC(e);if(!r)return"";const a=r+CC(t);return s||s===0?a+s:a}function Cd(n,e){const t=Fl(n),s=Array.isArray(e)?e:la(e).coord;if(t.empty||!s||s.length<2)return"";const r=t.coord,a=r.length===1?[r[0]+s[0]]:[r[0]+s[0],r[1]+s[1]];return AC(a).name}function j1(n,e){const t=n.length;return s=>{if(!e)return"";const r=s<0?(t- -s%t)%t:s%t,a=Math.floor(s/t),i=Cd(e,[0,a]);return Cd(i,n[r])}}function EC(n,e){const t=Fl(n),s=Fl(e);if(t.empty||s.empty)return"";const r=t.coord,a=s.coord,i=a[0]-r[0],o=r.length===2&&a.length===2?a[1]-r[1]:-Math.floor(i*7/12),l=s.height===t.height&&s.midi!==null&&t.midi!==null&&t.step>s.step;return jf([i,o],l).name}var C9=(n,e)=>Array(Math.abs(e)+1).join(n);function Kd(n,e,t){return function(...s){return console.warn(`${n} is deprecated. Use ${e}.`),t.apply(this,s)}}var P9=Kd("isNamed","isNamedPitch",Qf);const A9=Object.freeze(Object.defineProperty({__proto__:null,accToAlt:PC,altToAcc:CC,chroma:v9,coordToInterval:jf,coordToNote:AC,coordinates:I1,deprecate:Kd,distance:EC,fillStr:C9,height:xC,interval:la,isNamed:P9,isNamedPitch:Qf,isPitch:R1,midi:O9,note:Fl,pitch:L1,stepToLetter:SC,tokenizeInterval:kC,tokenizeNote:Q1,tonicIntervalsTransposer:j1,transpose:Cd},Symbol.toStringTag,{value:"Module"}));var YH=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],KH=YH,JH={...Bl,name:"",quality:"Unknown",intervals:[],aliases:[]},Jd=[],rh={};function MC(n){return rh[n]||JH}var eY=Kd("ChordType.chordType","ChordType.get",MC);function tY(){return Jd.map(n=>n.name).filter(n=>n)}function nY(){return Jd.map(n=>n.aliases[0]).filter(n=>n)}function sY(){return Object.keys(rh)}function V1(){return Jd.slice()}var rY=Kd("ChordType.entries","ChordType.all",V1);function aY(){Jd=[],rh={}}function E9(n,e,t){const s=oY(n),r={...Pr(n),name:t||"",quality:s,intervals:n,aliases:e};Jd.push(r),r.name&&(rh[r.name]=r),rh[r.setNum]=r,rh[r.chroma]=r,r.aliases.forEach(a=>iY(r,a))}function iY(n,e){rh[e]=n}function oY(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}KH.forEach(([n,e,t])=>E9(n.split(" "),t.split(" "),e));Jd.sort((n,e)=>n.setNum-e.setNum);var M9={names:tY,symbols:nY,get:MC,all:V1,add:E9,removeAll:aY,keys:sY,entries:rY,chordType:eY},lY=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neapolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5p pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7m pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neapolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neapolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],cY=lY,uY={...Bl,intervals:[],aliases:[]},Z1=[],ah={};function D9(){return Z1.map(n=>n.name)}function z1(n){return ah[n]||uY}var hY=z1;function ep(){return Z1.slice()}var dY=ep;function pY(){return Object.keys(ah)}function mY(){Z1=[],ah={}}function T9(n,e,t=[]){const s={...Pr(n),name:e,intervals:n,aliases:t};return Z1.push(s),ah[s.name]=s,ah[s.setNum]=s,ah[s.chroma]=s,s.aliases.forEach(r=>fY(s,r)),s}function fY(n,e){ah[e]=n}cY.forEach(([n,e,...t])=>T9(n.split(" "),e,t));var B9={names:D9,get:z1,all:ep,add:T9,removeAll:mY,keys:pY,entries:dY,scaleType:hY},ek={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function DC(n){const[e,t,s,r]=Q1(n);return e===""?["",n]:e==="A"&&r==="ug"?["","aug"]:[e+t,s+r]}function Ph(n){if(n==="")return ek;if(Array.isArray(n)&&n.length===2)return V0(n[1],n[0]);{const[e,t]=DC(n),s=V0(t,e);return s.empty?V0(n):s}}function V0(n,e,t){const s=MC(n),r=Fl(e||""),a=Fl(t||"");if(s.empty||e&&r.empty||t&&a.empty)return ek;const i=EC(r.pc,a.pc),o=s.intervals.indexOf(i)+1;if(!a.empty&&!o)return ek;const l=Array.from(s.intervals);for(let d=1;d<o;d++){const m=l[0][0],y=l[0][1],O=parseInt(m,10)+7;l.push(`${O}${y}`),l.shift()}const c=r.empty?[]:l.map(d=>Cd(r,d));n=s.aliases.indexOf(n)!==-1?n:s.aliases[0];const u=`${r.empty?"":r.pc}${n}${a.empty||o<=1?"":"/"+a.pc}`,h=`${e?r.pc+" ":""}${s.name}${o>1&&t?" over "+a.pc:""}`;return{...s,name:h,symbol:u,type:s.name,root:a.name,intervals:l,rootDegree:o,tonic:r.name,notes:c}}var gY=Kd("Chord.chord","Chord.get",Ph);function bY(n,e){const[t,s]=DC(n);return t?Cd(t,e)+s:n}function yY(n){const e=Ph(n),t=$1(e.chroma);return ep().filter(s=>t(s.chroma)).map(s=>s.name)}function vY(n){const e=Ph(n),t=$1(e.chroma);return V1().filter(s=>t(s.chroma)).map(s=>e.tonic+s.aliases[0])}function OY(n){const e=Ph(n),t=F1(e.chroma);return V1().filter(s=>t(s.chroma)).map(s=>e.tonic+s.aliases[0])}function wY(n){const{intervals:e,tonic:t}=Ph(n),s=j1(e,t);return r=>r?s(r>0?r-1:r):""}function xY(n){const{intervals:e,tonic:t}=Ph(n);return j1(e,t)}var kY={getChord:V0,get:Ph,detect:DH,chordScales:yY,extended:vY,reduced:OY,tokenize:DC,transpose:bY,degrees:wY,steps:xY,chord:gY},SY=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],CY=SY,q1=[];CY.forEach(([n,e,t])=>FY(n,e,t));var PY={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]};function AY(){return q1.reduce((n,e)=>(e.names.forEach(t=>n.push(t)),n),[])}function EY(){return q1.map(n=>n.shorthand)}var MY=/^([^.]+)(\.*)$/;function TC(n){const[e,t,s]=MY.exec(n)||[],r=q1.find(o=>o.shorthand===t||o.names.includes(t));if(!r)return PY;const a=$Y(r.fraction,s.length),i=a[0]/a[1];return{...r,name:n,dots:s,value:i,fraction:a}}var DY=n=>TC(n).value,TY=n=>TC(n).fraction,BY={names:AY,shorthands:EY,get:TC,value:DY,fraction:TY};function FY(n,e,t){q1.push({empty:!1,dots:"",name:"",value:1/n,fraction:n<1?[1/n,1]:[1,n],shorthand:e,names:t})}function $Y(n,e){const t=Math.pow(2,e);let s=n[0]*t,r=n[1]*t;const a=s;for(let i=0;i<e;i++)s+=a/Math.pow(2,i+1);for(;s%2===0&&r%2===0;)s/=2,r/=2;return[s,r]}function NY(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")}var F9=la,_Y=n=>la(n).name,RY=n=>la(n).semitones,IY=n=>la(n).q,LY=n=>la(n).num;function QY(n){const e=la(n);return e.empty?"":e.simple+e.q}function jY(n){const e=la(n);if(e.empty)return"";const t=(7-e.step)%7,s=e.type==="perfectable"?-e.alt:-(e.alt+1);return la({step:t,alt:s,oct:e.oct,dir:e.dir}).name}var VY=[1,2,2,3,3,4,5,5,6,6,7,7],ZY="P m M m M P d P m M m M".split(" ");function zY(n){const e=n<0?-1:1,t=Math.abs(n),s=t%12,r=Math.floor(t/12);return e*(VY[s]+7*r)+ZY[s]}var qY=T1,$9=N9((n,e)=>[n[0]+e[0],n[1]+e[1]]),UY=n=>e=>$9(n,e),WY=N9((n,e)=>[n[0]-e[0],n[1]-e[1]]);function GY(n,e){const t=F9(n);if(t.empty)return"";const[s,r,a]=t.coord;return jf([s+e,r,a]).name}var au={names:NY,get:F9,name:_Y,num:LY,semitones:RY,quality:IY,fromSemitones:zY,distance:qY,invert:jY,simplify:QY,add:$9,addTo:UY,substract:WY,transposeFifths:GY};function N9(n){return(e,t)=>{const s=la(e).coord,r=la(t).coord;if(s&&r){const a=n(s,r);return jf(a).name}}}function _9(n){return+n>=0&&+n<=127}function R9(n){if(_9(n))return+n;const e=as(n);return e.empty?null:e.midi}function XY(n,e=440){return Math.pow(2,(n-69)/12)*e}var HY=Math.log(2),YY=Math.log(440);function BC(n){const e=12*(Math.log(n)-YY)/HY+69;return Math.round(e*100)/100}var KY="C C# D D# E F F# G G# A A# B".split(" "),JY="C Db D Eb E F Gb G Ab A Bb B".split(" ");function Su(n,e={}){if(isNaN(n)||n===-1/0||n===1/0)return"";n=Math.round(n);const s=(e.sharps===!0?KY:JY)[n%12];if(e.pitchClass)return s;const r=Math.floor(n/12)-1;return s+r}function FC(n){return n%12}function eK(n){return n.split("").reduce((e,t,s)=>(s<12&&t==="1"&&e.push(s),e),[])}function tK(n){return n.map(FC).sort((e,t)=>e-t).filter((e,t,s)=>t===0||e!==s[t-1])}function $C(n){return Array.isArray(n)?tK(n):eK(n)}function nK(n){const e=$C(n);return t=>{const s=FC(t);for(let r=0;r<12;r++){if(e.includes(s+r))return t+r;if(e.includes(s-r))return t-r}}}function I9(n,e){const t=$C(n),s=t.length;return r=>{const a=r<0?(s- -r%s)%s:r%s,i=Math.floor(r/s);return t[a]+i*12+e}}function sK(n,e){const t=I9(n,e);return s=>{if(s!==0)return t(s>0?s-1:s)}}var rK={chroma:FC,freqToMidi:BC,isMidi:_9,midiToFreq:XY,midiToNoteName:Su,pcsetNearest:nK,pcset:$C,pcsetDegrees:sK,pcsetSteps:I9,toMidi:R9},aK=["C","D","E","F","G","A","B"],L9=n=>n.name,Q9=n=>n.map(as).filter(e=>!e.empty);function iK(n){return n===void 0?aK.slice():Array.isArray(n)?Q9(n).map(L9):[]}var zo=as,oK=n=>zo(n).name,lK=n=>zo(n).pc,cK=n=>zo(n).acc,uK=n=>zo(n).oct,hK=n=>zo(n).midi,dK=n=>zo(n).freq,pK=n=>zo(n).chroma;function j9(n){return Su(n)}function mK(n){return Su(BC(n))}function fK(n){return Su(BC(n),{sharps:!0})}function gK(n){return Su(n,{sharps:!0})}var bK=T1,jo=Zo,yK=Zo,V9=n=>e=>jo(e,n),vK=V9,Z9=n=>e=>jo(n,e),OK=Z9;function Db(n,e){return jo(n,[e,0])}var wK=Db;function xK(n,e){return jo(n,[0,e])}var NC=(n,e)=>n.height-e.height,kK=(n,e)=>e.height-n.height;function z9(n,e){return e=e||NC,Q9(n).sort(e).map(L9)}function q9(n){return z9(n,NC).filter((e,t,s)=>t===0||e!==s[t-1])}var SK=n=>{const e=zo(n);return e.empty?"":Su(e.midi||e.chroma,{sharps:e.alt>0,pitchClass:e.midi===null})};function U9(n,e){const t=zo(n);if(t.empty)return"";const s=zo(e||Su(t.midi||t.chroma,{sharps:t.alt<0,pitchClass:!0}));if(s.empty||s.chroma!==t.chroma)return"";if(t.oct===void 0)return s.pc;const r=t.chroma-t.alt,a=s.chroma-s.alt,i=r>11||a<0?-1:r<0||a>11?1:0,o=t.oct+i;return s.pc+o}var oa={names:iK,get:zo,name:oK,pitchClass:lK,accidentals:cK,octave:uK,midi:hK,ascending:NC,descending:kK,distance:bK,sortedNames:z9,sortedUniqNames:q9,fromMidi:j9,fromMidiSharps:gK,freq:dK,fromFreq:mK,fromFreqSharps:fK,chroma:pK,transpose:jo,tr:yK,transposeBy:V9,trBy:vK,transposeFrom:Z9,trFrom:OK,transposeFifths:Db,transposeOctaves:xK,trFifths:wK,simplify:SK,enharmonic:U9};function W9(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function G9(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var X9=[0,2,4,-1,1,3,5],CK=X9.map(n=>Math.floor(n*7/12));function PK(n){const{step:e,alt:t,oct:s,dir:r=1}=n,a=X9[e]+7*t;if(s===void 0)return[r*a];const i=s-CK[e]-4*t;return[r*a,r*i]}var pM=(n,e)=>Array(Math.abs(e)+1).join(n),tk=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),AK="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",EK="(AA|A|P|M|m|d|dd)([-+]?\\d+)",MK=new RegExp("^"+AK+"|"+EK+"$");function DK(n){const e=MK.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var mM={};function nk(n){return typeof n=="string"?mM[n]||(mM[n]=TK(n)):G9(n)?nk(FK(n)):W9(n)?nk(n.name):tk}var fM=[0,2,4,5,7,9,11],H9="PMMPPMM";function TK(n){const e=DK(n);if(e[0]==="")return tk;const t=+e[0],s=e[1],r=(Math.abs(t)-1)%7,a=H9[r];if(a==="M"&&s==="P")return tk;const i=a==="M"?"majorable":"perfectable",o=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(r+1),u=BK(i,s),h=Math.floor((Math.abs(t)-1)/7),d=l*(fM[r]+u+12*h),m=(l*(fM[r]+u)%12+12)%12,y=PK({step:r,alt:u,oct:h,dir:l});return{empty:!1,name:o,num:t,q:s,step:r,alt:u,dir:l,type:i,simple:c,semitones:d,chroma:m,coord:y,oct:h}}function BK(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function FK(n){const{step:e,alt:t,oct:s=0,dir:r}=n;if(!r)return"";const a=e+1+7*s,i=a===0?e+1:a,o=r<0?"-":"",l=H9[e]==="M"?"majorable":"perfectable";return o+i+$K(l,t)}function $K(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?pM("A",e):pM("d",n==="perfectable"?e:e+1)}var Y9={empty:!0,name:"",chordType:""},gM={};function iu(n){return typeof n=="string"?gM[n]||(gM[n]=jK(n)):typeof n=="number"?iu(U1[n]||""):G9(n)?RK(n):W9(n)?iu(n.name):Y9}var NK=iu;function _K(n=!0){return(n?U1:QK).slice()}function RK(n){return iu(D1(n.alt)+U1[n.step])}var IK=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;function LK(n){return IK.exec(n)||["","","",""]}var K9="I II III IV V VI VII",U1=K9.split(" "),QK=K9.toLowerCase().split(" ");function jK(n){const[e,t,s,r]=LK(n);if(!s)return Y9;const a=s.toUpperCase(),i=U1.indexOf(a),o=fC(t),l=1;return{empty:!1,name:e,roman:s,interval:nk({step:i,alt:o,dir:l}).name,acc:t,chordType:r,alt:o,step:i,major:s===a,oct:0,dir:l}}var VK={names:_K,get:iu,romanNumeral:NK},Qr=Object.freeze([]),J9={type:"major",tonic:"",alteration:0,keySignature:""},Z0={tonic:"",grades:Qr,intervals:Qr,scale:Qr,triads:Qr,chords:Qr,chordsHarmonicFunction:Qr,chordScales:Qr,secondaryDominants:Qr,secondaryDominantSupertonics:Qr,substituteDominantsMinorRelative:Qr,substituteDominants:Qr,substituteDominantSupertonics:Qr,secondaryDominantsMinorRelative:Qr},ZK={...J9,...Z0,type:"major",minorRelative:"",scale:Qr,substituteDominants:Qr,secondaryDominantSupertonics:Qr,substituteDominantsMinorRelative:Qr},zK={...J9,type:"minor",relativeMajor:"",natural:Z0,harmonic:Z0,melodic:Z0},fO=(n,e,t="")=>e.map((s,r)=>`${n[r]}${t}${s}`);function W1(n,e,t,s,r){return a=>{const i=n.map(m=>iu(m).interval||""),o=i.map(m=>jo(a,m)),l=fO(o,t),c=o.map(m=>jo(m,"5P")).map(m=>o.includes(m)&&!l.includes(m+"7")?m+"7":""),u=bM(c,e),h=c.map(m=>{if(!m)return"";const y=m.slice(0,-1);return jo(y,"5d")+"7"}),d=bM(h,e);return{tonic:a,grades:n,intervals:i,scale:o,triads:fO(o,e),chords:l,chordsHarmonicFunction:s.slice(),chordScales:fO(o,r," "),secondaryDominants:c,secondaryDominantSupertonics:u,substituteDominants:h,substituteDominantSupertonics:d,secondaryDominantsMinorRelative:u,substituteDominantsMinorRelative:d}}}var bM=(n,e)=>n.map((t,s)=>{if(!t)return"";const r=t.slice(0,-1),a=jo(r,"5P");return e[s].endsWith("m")?a+"m7":a+"m7b5"}),eB=(n,e)=>{const t=as(n),s=as(e);return t.empty||s.empty?0:s.coord[0]-t.coord[0]},qK=W1("I II III IV V VI VII".split(" ")," m m   m dim".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),UK=W1("I II bIII IV V bVI bVII".split(" "),"m dim  m m  ".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),WK=W1("I II bIII IV V bVI VII".split(" "),"m dim aug m   dim".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),GK=W1("I II bIII IV V VI VII".split(" "),"m m aug   dim dim".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));function XK(n){const e=as(n).pc;if(!e)return ZK;const t=qK(e),s=eB("C",e);return{...t,type:"major",minorRelative:jo(e,"-3m"),alteration:s,keySignature:D1(s)}}function HK(n){const e=as(n).pc;if(!e)return zK;const t=eB("C",e)-3;return{type:"minor",tonic:e,relativeMajor:jo(e,"3m"),alteration:t,keySignature:D1(t),natural:UK(e),harmonic:WK(e),melodic:GK(e)}}function YK(n){return typeof n=="number"?Db("C",n):typeof n=="string"&&/^b+|#+$/.test(n)?Db("C",fC(n)):null}var KK={majorKey:XK,majorTonicFromKeySignature:YK,minorKey:HK};function JK(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function eJ(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var tB=[0,2,4,-1,1,3,5],nB=tB.map(n=>Math.floor(n*7/12));function tJ(n){const{step:e,alt:t,oct:s,dir:r=1}=n,a=tB[e]+7*t;if(s===void 0)return[r*a];const i=s-nB[e]-4*t;return[r*a,r*i]}var nJ=[3,0,4,1,5,2,6];function sJ(n){const[e,t,s]=n,r=nJ[rJ(e)],a=Math.floor((e+1)/7);if(t===void 0)return{step:r,alt:a,dir:s};const i=t+4*a+nB[r];return{step:r,alt:a,oct:i,dir:s}}function rJ(n){const e=(n+1)%7;return e<0?7+e:e}var yM=(n,e)=>Array(Math.abs(e)+1).join(n),sk=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),aJ="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",iJ="(AA|A|P|M|m|d|dd)([-+]?\\d+)",oJ=new RegExp("^"+aJ+"|"+iJ+"$");function lJ(n){const e=oJ.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var vM={};function zm(n){return typeof n=="string"?vM[n]||(vM[n]=cJ(n)):eJ(n)?zm(dJ(n)):JK(n)?zm(n.name):sk}var OM=[0,2,4,5,7,9,11],sB="PMMPPMM";function cJ(n){const e=lJ(n);if(e[0]==="")return sk;const t=+e[0],s=e[1],r=(Math.abs(t)-1)%7,a=sB[r];if(a==="M"&&s==="P")return sk;const i=a==="M"?"majorable":"perfectable",o=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(r+1),u=hJ(i,s),h=Math.floor((Math.abs(t)-1)/7),d=l*(OM[r]+u+12*h),m=(l*(OM[r]+u)%12+12)%12,y=tJ({step:r,alt:u,oct:h,dir:l});return{empty:!1,name:o,num:t,q:s,step:r,alt:u,dir:l,type:i,simple:c,semitones:d,chroma:m,coord:y,oct:h}}function uJ(n,e){const[t,s=0]=n,a=t*7+s*12<0?[-t,-s,-1]:[t,s,1];return zm(sJ(a))}function hJ(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function dJ(n){const{step:e,alt:t,oct:s=0,dir:r}=n;if(!r)return"";const a=e+1+7*s,i=a===0?e+1:a,o=r<0?"-":"",l=sB[e]==="M"?"majorable":"perfectable";return o+i+pJ(l,t)}function pJ(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?yM("A",e):yM("d",n==="perfectable"?e:e+1)}var mJ=zm;function fJ(n){const e=zm(n);return e.empty?"":e.simple+e.q}function gJ(n,e){const t=mJ(n);if(t.empty)return"";const[s,r,a]=t.coord;return uJ([s+e,r,a]).name}var _C=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],wM={...Bl,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},RC=_C.map(OJ),rk={};RC.forEach(n=>{rk[n.name]=n,n.aliases.forEach(e=>{rk[e]=n})});function ph(n){return typeof n=="string"?rk[n.toLowerCase()]||wM:n&&n.name?ph(n.name):wM}var bJ=ph;function rB(){return RC.slice()}var yJ=rB;function vJ(){return RC.map(n=>n.name)}function OJ(n){const[e,t,s,r,a,i,o]=n,l=o?[o]:[],c=Number(t).toString(2);return{empty:!1,intervals:z1(r).intervals,modeNum:e,chroma:c,normalized:c,name:r,setNum:t,alt:s,triad:a,seventh:i,aliases:l}}function wJ(n,e){return ph(n).intervals.map(t=>Zo(e,t))}function aB(n){return(e,t)=>{const s=ph(e);if(s.empty)return[];const r=Yd(s.modeNum,n),a=s.intervals.map(i=>Zo(t,i));return r.map((i,o)=>a[o]+i)}}var xJ=aB(_C.map(n=>n[4])),kJ=aB(_C.map(n=>n[5]));function iB(n,e){const t=ph(e),s=ph(n);return t.empty||s.empty?"":fJ(gJ("1P",s.alt-t.alt))}function SJ(n,e,t){return Zo(t,iB(n,e))}var CJ={get:ph,names:vJ,all:rB,distance:iB,relativeTonic:SJ,notes:wJ,triads:xJ,seventhChords:kJ,entries:yJ,mode:bJ},PJ=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],AJ=PJ;({...Bl});var oB=[],z0={};function EJ(n,e,t){const s=DJ(n),r={...Pr(n),name:t||"",quality:s,intervals:n,aliases:e};oB.push(r),r.name&&(z0[r.name]=r),z0[r.setNum]=r,z0[r.chroma]=r,r.aliases.forEach(a=>MJ(r,a))}function MJ(n,e){z0[e]=n}function DJ(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}AJ.forEach(([n,e,t])=>EJ(n.split(" "),t.split(" "),e));oB.sort((n,e)=>n.setNum-e.setNum);function TJ(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function BJ(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var lB=[0,2,4,-1,1,3,5],FJ=lB.map(n=>Math.floor(n*7/12));function $J(n){const{step:e,alt:t,oct:s,dir:r=1}=n,a=lB[e]+7*t;if(s===void 0)return[r*a];const i=s-FJ[e]-4*t;return[r*a,r*i]}var xM=(n,e)=>Array(Math.abs(e)+1).join(n),ak=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),NJ="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",_J="(AA|A|P|M|m|d|dd)([-+]?\\d+)",RJ=new RegExp("^"+NJ+"|"+_J+"$");function IJ(n){const e=RJ.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var kM={};function Tb(n){return typeof n=="string"?kM[n]||(kM[n]=LJ(n)):BJ(n)?Tb(jJ(n)):TJ(n)?Tb(n.name):ak}var SM=[0,2,4,5,7,9,11],cB="PMMPPMM";function LJ(n){const e=IJ(n);if(e[0]==="")return ak;const t=+e[0],s=e[1],r=(Math.abs(t)-1)%7,a=cB[r];if(a==="M"&&s==="P")return ak;const i=a==="M"?"majorable":"perfectable",o=""+t+s,l=t<0?-1:1,c=t===8||t===-8?t:l*(r+1),u=QJ(i,s),h=Math.floor((Math.abs(t)-1)/7),d=l*(SM[r]+u+12*h),m=(l*(SM[r]+u)%12+12)%12,y=$J({step:r,alt:u,oct:h,dir:l});return{empty:!1,name:o,num:t,q:s,step:r,alt:u,dir:l,type:i,simple:c,semitones:d,chroma:m,coord:y,oct:h}}function QJ(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function jJ(n){const{step:e,alt:t,oct:s=0,dir:r}=n;if(!r)return"";const a=e+1+7*s,i=a===0?e+1:a,o=r<0?"-":"",l=cB[e]==="M"?"majorable":"perfectable";return o+i+VJ(l,t)}function VJ(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?xM("A",e):xM("d",n==="perfectable"?e:e+1)}function ZJ(n){const[e,t,s,r]=gC(n);return e===""?gO("",n):e==="A"&&r==="ug"?gO("","aug"):gO(e+t,s+r)}function gO(n,e){const t=e.split("/");if(t.length===1)return[n,t[0],""];const[s,r,a,i]=gC(t[1]);return s!==""&&a===""&&i===""?[n,t[0],s+r]:[n,e,""]}function zJ(n,e){return e.map(iu).map(s=>Zo(n,Tb(s))+s.chordType)}function qJ(n,e){return e.map(t=>{const[s,r]=ZJ(t),a=T1(n,s);return iu(Tb(a)).name+r})}var uB={fromRomanNumerals:zJ,toRomanNumerals:qJ};function hB(n){const e=bC(n.map(t=>typeof t=="number"?t:R9(t)));return!n.length||e.length!==n.length?[]:e.reduce((t,s)=>{const r=t[t.length-1];return t.concat(B1(r,s).slice(1))},[e[0]])}function UJ(n,e){return hB(n).map(t=>Su(t,e))}var WJ={numeric:hB,chromatic:UJ},GJ=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],XJ=GJ;({...Bl});var IC=[],q0={};function HJ(){return IC.slice()}function YJ(n,e,t){const s=JJ(n),r={...Pr(n),name:t||"",quality:s,intervals:n,aliases:e};IC.push(r),r.name&&(q0[r.name]=r),q0[r.setNum]=r,q0[r.chroma]=r,r.aliases.forEach(a=>KJ(r,a))}function KJ(n,e){q0[e]=n}function JJ(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}XJ.forEach(([n,e,t])=>YJ(n.split(" "),t.split(" "),e));IC.sort((n,e)=>n.setNum-e.setNum);var eee={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function dB(n){if(typeof n!="string")return["",""];const e=n.indexOf(" "),t=as(n.substring(0,e));if(t.empty){const r=as(n);return r.empty?["",n.toLowerCase()]:[r.name,""]}const s=n.substring(t.name.length+1).toLowerCase();return[t.name,s.length?s:""]}var tee=D9;function $l(n){const e=Array.isArray(n)?n:dB(n),t=as(e[0]).name,s=z1(e[1]);if(s.empty)return eee;const r=s.name,a=t?s.intervals.map(o=>Zo(t,o)):[],i=t?t+" "+r:r;return{...s,name:i,type:r,tonic:t,notes:a}}var nee=$l;function see(n,e={}){const t=f9(n),s=as(e.tonic??n[0]??""),r=s.chroma;if(r===void 0)return[];const a=t.split("");a[r]="1";const i=Yd(r,a).join(""),o=ep().find(c=>c.chroma===i),l=[];return o&&l.push(s.name+" "+o.name),e.match==="exact"||pB(i).forEach(c=>{l.push(s.name+" "+c)}),l}function ree(n){const e=$l(n),t=F1(e.chroma);return HJ().filter(s=>t(s.chroma)).map(s=>s.aliases[0])}function pB(n){const e=vC(n)?n:$l(n).chroma,t=$1(e);return ep().filter(s=>t(s.chroma)).map(s=>s.name)}function aee(n){const e=F1($l(n).chroma);return ep().filter(t=>e(t.chroma)).map(t=>t.name)}function mB(n){const e=n.map(r=>as(r).pc).filter(r=>r),t=e[0],s=q9(e);return Yd(s.indexOf(t),s)}function iee(n){const e=$l(n);if(e.empty)return[];const t=e.tonic?e.notes:e.intervals;return OC(e.chroma).map((s,r)=>{const a=$l(s).name;return a?[t[r],a]:["",""]}).filter(s=>s[0])}function oee(n){const e=Array.isArray(n)?mB(n):$l(n).notes,t=e.map(s=>as(s).chroma);return s=>{const r=as(typeof s=="number"?j9(s):s),a=r.height;if(a===void 0)return;const i=a%12,o=t.indexOf(i);if(o!==-1)return U9(r.name,e[o])}}function lee(n){const e=oee(n);return(t,s)=>{const r=as(t).height,a=as(s).height;return r===void 0||a===void 0?[]:B1(r,a).map(e).filter(i=>i)}}function cee(n){const{intervals:e,tonic:t}=$l(n),s=o9(e,t);return r=>r?s(r>0?r-1:r):""}function uee(n){const{intervals:e,tonic:t}=$l(n);return o9(e,t)}var _o={degrees:cee,detect:see,extended:pB,get:$l,modeNames:iee,names:tee,rangeOf:lee,reduced:aee,scaleChords:ree,scaleNotes:mB,steps:uee,tokenize:dB,scale:nee},hee={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},dee=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"];function pee(){return dee.slice()}var mee=/^(\d*\d(?:\+\d)*)\/(\d+)$/,CM=new Map;function fee(n){const e=JSON.stringify(n),t=CM.get(e);if(t)return t;const s=yee(LC(n));return CM.set(e,s),s}function LC(n){if(typeof n=="string"){const[a,i,o]=mee.exec(n)||[];return LC([i,o])}const[e,t]=n,s=+t;if(typeof e=="number")return[e,s];const r=e.split("+").map(a=>+a);return r.length===1?[r[0],s]:[r,s]}var gee={names:pee,parse:LC,get:fee},bee=n=>Math.log(n)/Math.log(2)%1===0;function yee([n,e]){const t=Array.isArray(n)?n.reduce((o,l)=>o+l,0):n,s=e;if(t===0||s===0)return hee;const r=Array.isArray(n)?`${n.join("+")}/${e}`:`${n}/${e}`,a=Array.isArray(n)?n:[],i=s===4||s===2?"simple":s===8&&t%3===0?"compound":bee(s)?"irregular":"irrational";return{empty:!1,name:r,type:i,upper:t,lower:s,additive:a}}var vee=A9,Oee=b9,wee=M9,xee=B9;const kee=Object.freeze(Object.defineProperty({__proto__:null,AbcNotation:RX,Array:qX,Chord:kY,ChordDictionary:wee,ChordType:M9,Collection:XX,Core:A9,DurationValue:BY,Interval:au,Key:KK,Midi:rK,Mode:CJ,Note:oa,PcSet:Oee,Pcset:b9,Progression:uB,Range:WJ,RomanNumeral:VK,Scale:_o,ScaleDictionary:xee,ScaleType:B9,TimeSignature:gee,Tonal:vee,accToAlt:PC,altToAcc:CC,chroma:v9,coordToInterval:jf,coordToNote:AC,coordinates:I1,deprecate:Kd,distance:EC,fillStr:C9,height:xC,interval:la,isNamed:P9,isNamedPitch:Qf,isPitch:R1,midi:O9,note:Fl,pitch:L1,stepToLetter:SC,tokenizeInterval:kC,tokenizeNote:Q1,tonicIntervalsTransposer:j1,transpose:Cd},Symbol.toStringTag,{value:"Module"}));class Ro{constructor(e=!1){this.eventMap={},this.eventsSuspended=e==!0}addListener(e,t,s={}){if(typeof e=="string"&&e.length<1||e instanceof String&&e.length<1||typeof e!="string"&&!(e instanceof String)&&e!==Ro.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof t!="function")throw new TypeError("The callback must be a function.");const r=new PM(e,this,t,s);return this.eventMap[e]||(this.eventMap[e]=[]),s.prepend?this.eventMap[e].unshift(r):this.eventMap[e].push(r),r}addOneTimeListener(e,t,s={}){s.remaining=1,this.addListener(e,t,s)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(e,t){return e===void 0?this.eventMap[Ro.ANY_EVENT]&&this.eventMap[Ro.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,s])=>s.length>0):this.eventMap[e]&&this.eventMap[e].length>0?t instanceof PM?this.eventMap[e].filter(r=>r===t).length>0:typeof t=="function"?this.eventMap[e].filter(r=>r.callback===t).length>0:t==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(e){return this.eventMap[e]||[]}suspendEvent(e){this.getListeners(e).forEach(t=>{t.suspended=!0})}unsuspendEvent(e){this.getListeners(e).forEach(t=>{t.suspended=!1})}getListenerCount(e){return this.getListeners(e).length}emit(e,...t){if(typeof e!="string"&&!(e instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let s=[],r=this.eventMap[Ro.ANY_EVENT]||[];return this.eventMap[e]&&(r=r.concat(this.eventMap[e])),r.forEach(a=>{if(a.suspended)return;let i=[...t];Array.isArray(a.arguments)&&(i=i.concat(a.arguments)),a.remaining>0&&(s.push(a.callback.apply(a.context,i)),a.count++),--a.remaining<1&&a.remove()}),s}removeListener(e,t,s={}){if(e===void 0){this.eventMap={};return}else if(!this.eventMap[e])return;let r=this.eventMap[e].filter(a=>t&&a.callback!==t||s.remaining&&s.remaining!==a.remaining||s.context&&s.context!==a.context);r.length?this.eventMap[e]=r:delete this.eventMap[e]}async waitFor(e,t={}){return t.duration=parseInt(t.duration),(isNaN(t.duration)||t.duration<=0)&&(t.duration=1/0),new Promise((s,r)=>{let a,i=this.addListener(e,()=>{clearTimeout(a),s()},{remaining:1});t.duration!==1/0&&(a=setTimeout(()=>{i.remove(),r("The duration expired before the event was emitted.")},t.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class PM{constructor(e,t,s,r={}){if(typeof e!="string"&&!(e instanceof String)&&e!==Ro.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!t)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof s!="function")throw new TypeError("The 'callback' must be a function.");r.arguments!==void 0&&!Array.isArray(r.arguments)&&(r.arguments=[r.arguments]),r=Object.assign({context:t,remaining:1/0,arguments:void 0,duration:1/0},r),r.duration!==1/0&&setTimeout(()=>this.remove(),r.duration),this.arguments=r.arguments,this.callback=s,this.context=r.context,this.count=0,this.event=e,this.remaining=parseInt(r.remaining)>=1?parseInt(r.remaining):1/0,this.suspended=!1,this.target=t}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}/**
 * The `Enumerations` class contains enumerations and arrays of elements used throughout the
 * library. All its properties are static and should be referenced using the class name. For
 * example: `Enumerations.CHANNEL_MESSAGES`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class qe{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),qe.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),qe.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),qe.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),qe.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}/**
 * The `Note` class represents a single musical note such as `"D3"`, `"G#4"`, `"F-1"`, `"Gb7"`, etc.
 *
 * `Note` objects can be played back on a single channel by calling
 * [`OutputChannel.playNote()`]{@link OutputChannel#playNote} or, on multiple channels of the same
 * output, by calling [`Output.playNote()`]{@link Output#playNote}.
 *
 * The note has [`attack`](#attack) and [`release`](#release) velocities set at `0.5` by default.
 * These can be changed by passing in the appropriate option. It is also possible to set a
 * system-wide default for attack and release velocities by using the
 * [`WebMidi.defaults`](WebMidi#defaults) property.
 *
 * If you prefer to work with raw MIDI values (`0` to `127`), you can use [`rawAttack`](#rawAttack) and
 * [`rawRelease`](#rawRelease) to both get and set the values.
 *
 * The note may have a [`duration`](#duration). If it does, playback will be automatically stopped
 * when the duration has elapsed by sending a `"noteoff"` event. By default, the duration is set to
 * `Infinity`. In this case, it will never stop playing unless explicitly stopped by calling a
 * method such as [`OutputChannel.stopNote()`]{@link OutputChannel#stopNote},
 * [`Output.stopNote()`]{@link Output#stopNote} or similar.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class Gu{constructor(e,t={}){this.duration=ft.defaults.note.duration,this.attack=ft.defaults.note.attack,this.release=ft.defaults.note.release,t.duration!=null&&(this.duration=t.duration),t.attack!=null&&(this.attack=t.attack),t.rawAttack!=null&&(this.attack=gt.from7bitToFloat(t.rawAttack)),t.release!=null&&(this.release=t.release),t.rawRelease!=null&&(this.release=gt.from7bitToFloat(t.rawRelease)),Number.isInteger(e)?this.identifier=gt.toNoteIdentifier(e):this.identifier=e}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(e){const t=gt.getNoteDetails(e);if(ft.validation&&!e)throw new Error("Invalid note identifier");this._name=t.name,this._accidental=t.accidental,this._octave=t.octave}get name(){return this._name}set name(e){if(ft.validation&&(e=e.toUpperCase(),!["C","D","E","F","G","A","B"].includes(e)))throw new Error("Invalid name value");this._name=e}get accidental(){return this._accidental}set accidental(e){if(ft.validation&&(e=e.toLowerCase(),!["#","##","b","bb"].includes(e)))throw new Error("Invalid accidental value");this._accidental=e}get octave(){return this._octave}set octave(e){if(ft.validation&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid octave value");this._octave=e}get duration(){return this._duration}set duration(e){if(ft.validation&&(e=parseFloat(e),isNaN(e)||e===null||e<0))throw new RangeError("Invalid duration value.");this._duration=e}get attack(){return this._attack}set attack(e){if(ft.validation&&(e=parseFloat(e),isNaN(e)||!(e>=0&&e<=1)))throw new RangeError("Invalid attack value.");this._attack=e}get release(){return this._release}set release(e){if(ft.validation&&(e=parseFloat(e),isNaN(e)||!(e>=0&&e<=1)))throw new RangeError("Invalid release value.");this._release=e}get rawAttack(){return gt.fromFloatTo7Bit(this._attack)}set rawAttack(e){this._attack=gt.from7bitToFloat(e)}get rawRelease(){return gt.fromFloatTo7Bit(this._release)}set rawRelease(e){this._release=gt.from7bitToFloat(e)}get number(){return gt.toNoteNumber(this.identifier)}getOffsetNumber(e=0,t=0){return ft.validation&&(e=parseInt(e)||0,t=parseInt(t)||0),Math.min(Math.max(this.number+e*12+t,0),127)}}/**
 * The `Utilities` class contains general-purpose utility methods. All methods are static and
 * should be called using the class name. For example: `Utilities.getNoteDetails("C4")`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class gt{static toNoteNumber(e,t=0){if(t=t==null?0:parseInt(t),isNaN(t))throw new RangeError("Invalid 'octaveOffset' value");typeof e!="string"&&(e="");const s=this.getNoteDetails(e);if(!s)throw new TypeError("Invalid note identifier");const r={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let a=(s.octave+1+t)*12;if(a+=r[s.name],s.accidental&&(s.accidental.startsWith("b")?a-=s.accidental.length:a+=s.accidental.length),a<0||a>127)throw new RangeError("Invalid octaveOffset value");return a}static getNoteDetails(e){Number.isInteger(e)&&(e=this.toNoteIdentifier(e));const t=e.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!t)throw new TypeError("Invalid note identifier");const s=t[1].toUpperCase(),r=parseInt(t[3]);let a=t[2].toLowerCase();return a=a===""?void 0:a,{accidental:a,identifier:s+(a||"")+r,name:s,octave:r}}static sanitizeChannels(e){let t;if(ft.validation){if(e==="all")t=["all"];else if(e==="none")return[]}return Array.isArray(e)?t=e:t=[e],t.indexOf("all")>-1&&(t=qe.MIDI_CHANNEL_NUMBERS),t.map(function(s){return parseInt(s)}).filter(function(s){return s>=1&&s<=16})}static toTimestamp(e){let t=!1;const s=parseFloat(e);return isNaN(s)?!1:(typeof e=="string"&&e.substring(0,1)==="+"?s>=0&&(t=ft.time+s):s>=0&&(t=s),t)}static guessNoteNumber(e,t){t=parseInt(t)||0;let s=!1;if(Number.isInteger(e)&&e>=0&&e<=127)s=parseInt(e);else if(parseInt(e)>=0&&parseInt(e)<=127)s=parseInt(e);else if(typeof e=="string"||e instanceof String)try{s=this.toNoteNumber(e.trim(),t)}catch{return!1}return s}static toNoteIdentifier(e,t){if(e=parseInt(e),isNaN(e)||e<0||e>127)throw new RangeError("Invalid note number");if(t=t==null?0:parseInt(t),isNaN(t))throw new RangeError("Invalid octaveOffset value");const s=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],r=Math.floor(e/12-1)+t;return s[e%12]+r.toString()}static buildNote(e,t={}){if(t.octaveOffset=parseInt(t.octaveOffset)||0,e instanceof Gu)return e;let s=this.guessNoteNumber(e,t.octaveOffset);if(s===!1)throw new TypeError(`The input could not be parsed as a note (${e})`);return t.octaveOffset=void 0,new Gu(s,t)}static buildNoteArray(e,t={}){let s=[];return Array.isArray(e)||(e=[e]),e.forEach(r=>{s.push(this.buildNote(r,t))}),s}static from7bitToFloat(e){return e===1/0&&(e=127),e=parseInt(e)||0,Math.min(Math.max(e/127,0),1)}static fromFloatTo7Bit(e){return e===1/0&&(e=1),e=parseFloat(e)||0,Math.min(Math.max(Math.round(e*127),0),127)}static fromMsbLsbToFloat(e,t=0){ft.validation&&(e=Math.min(Math.max(parseInt(e)||0,0),127),t=Math.min(Math.max(parseInt(t)||0,0),127));const s=((e<<7)+t)/16383;return Math.min(Math.max(s,0),1)}static fromFloatToMsbLsb(e){ft.validation&&(e=Math.min(Math.max(parseFloat(e)||0,0),1));const t=Math.round(e*16383);return{msb:t>>7,lsb:t&127}}static offsetNumber(e,t=0,s=0){if(ft.validation){if(e=parseInt(e),isNaN(e))throw new Error("Invalid note number");t=parseInt(t)||0,s=parseInt(s)||0}return Math.min(Math.max(e+t*12+s,0),127)}static getPropertyByValue(e,t){return Object.keys(e).find(s=>e[s]===t)}static getCcNameByNumber(e){if(!(ft.validation&&(e=parseInt(e),!(e>=0&&e<=127))))return qe.CONTROL_CHANGE_MESSAGES[e].name}static getCcNumberByName(e){let t=qe.CONTROL_CHANGE_MESSAGES.find(s=>s.name===e);return t?t.number:qe.MIDI_CONTROL_CHANGE_MESSAGES[e]}static getChannelModeByNumber(e){if(!(e>=120&&e<=127))return!1;for(let t in qe.CHANNEL_MODE_MESSAGES)if(qe.CHANNEL_MODE_MESSAGES.hasOwnProperty(t)&&e===qe.CHANNEL_MODE_MESSAGES[t])return t;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}/**
 * The `OutputChannel` class represents a single output MIDI channel. `OutputChannel` objects are
 * provided by an [`Output`](Output) port which, itself, is made available by a device. The
 * `OutputChannel` object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `OutputChannel` objects can be found inside the parent output's
 * [`channels`]{@link Output#channels} property.
 *
 * @param {Output} output The [`Output`](Output) this channel belongs to.
 * @param {number} number The MIDI channel number (`1` - `16`).
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class fB extends Ro{constructor(e,t){super(),this._output=e,this._number=t,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(e,t={time:0}){return this.output.send(e,t),this}sendKeyAftertouch(e,t,s={}){if(ft.validation){if(s.useRawValue&&(s.rawValue=s.useRawValue),isNaN(parseFloat(t)))throw new RangeError("Invalid key aftertouch value.");if(s.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}s.rawValue||(t=gt.fromFloatTo7Bit(t));const r=ft.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(e)||(e=[e]),gt.buildNoteArray(e).forEach(a=>{this.send([(qe.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),a.getOffsetNumber(r),t],{time:gt.toTimestamp(s.time)})}),this}sendControlChange(e,t,s={}){if(typeof e=="string"&&(e=gt.getCcNumberByName(e)),Array.isArray(t)||(t=[t]),ft.validation){if(e===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(t=t.map(r=>{const a=Math.min(Math.max(parseInt(r),0),127);if(isNaN(a))throw new TypeError("Values must be integers between 0 and 127");return a}),t.length===2&&e>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return t.forEach((r,a)=>{this.send([(qe.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),e+a*32,t[a]],{time:gt.toTimestamp(s.time)})}),this}_selectNonRegisteredParameter(e,t={}){return this.sendControlChange(99,e[0],t),this.sendControlChange(98,e[1],t),this}_deselectRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_deselectNonRegisteredParameter(e={}){return this.sendControlChange(101,127,e),this.sendControlChange(100,127,e),this}_selectRegisteredParameter(e,t={}){return this.sendControlChange(101,e[0],t),this.sendControlChange(100,e[1],t),this}_setCurrentParameter(e,t={}){return e=[].concat(e),this.sendControlChange(6,e[0],t),e.length<2?this:(this.sendControlChange(38,e[1],t),this)}sendRpnDecrement(e,t={}){if(Array.isArray(e)||(e=qe.REGISTERED_PARAMETERS[e]),ft.validation){if(e===void 0)throw new TypeError("The specified registered parameter is invalid.");let s=!1;if(Object.getOwnPropertyNames(qe.REGISTERED_PARAMETERS).forEach(r=>{qe.REGISTERED_PARAMETERS[r][0]===e[0]&&qe.REGISTERED_PARAMETERS[r][1]===e[1]&&(s=!0)}),!s)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(97,0,t),this._deselectRegisteredParameter(t),this}sendRpnIncrement(e,t={}){if(Array.isArray(e)||(e=qe.REGISTERED_PARAMETERS[e]),ft.validation){if(e===void 0)throw new TypeError("The specified registered parameter is invalid.");let s=!1;if(Object.getOwnPropertyNames(qe.REGISTERED_PARAMETERS).forEach(r=>{qe.REGISTERED_PARAMETERS[r][0]===e[0]&&qe.REGISTERED_PARAMETERS[r][1]===e[1]&&(s=!0)}),!s)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(e,t),this.sendControlChange(96,0,t),this._deselectRegisteredParameter(t),this}playNote(e,t={}){this.sendNoteOn(e,t);const s=Array.isArray(e)?e:[e];for(let r of s)if(parseInt(r.duration)>0){const a={time:(gt.toTimestamp(t.time)||ft.time)+parseInt(r.duration),release:r.release,rawRelease:r.rawRelease};this.sendNoteOff(r,a)}else if(parseInt(t.duration)>0){const a={time:(gt.toTimestamp(t.time)||ft.time)+parseInt(t.duration),release:t.release,rawRelease:t.rawRelease};this.sendNoteOff(r,a)}return this}sendNoteOff(e,t={}){if(ft.validation){if(t.rawRelease!=null&&!(t.rawRelease>=0&&t.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(t.release!=null&&!(t.release>=0&&t.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");t.rawVelocity&&(t.rawRelease=t.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),t.velocity&&(t.release=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let s=64;t.rawRelease!=null?s=t.rawRelease:isNaN(t.release)||(s=Math.round(t.release*127));const r=ft.octaveOffset+this.output.octaveOffset+this.octaveOffset;return gt.buildNoteArray(e,{rawRelease:parseInt(s)}).forEach(a=>{this.send([(qe.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),a.getOffsetNumber(r),a.rawRelease],{time:gt.toTimestamp(t.time)})}),this}stopNote(e,t={}){return this.sendNoteOff(e,t)}sendNoteOn(e,t={}){if(ft.validation){if(t.rawAttack!=null&&!(t.rawAttack>=0&&t.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(t.attack!=null&&!(t.attack>=0&&t.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");t.rawVelocity&&(t.rawAttack=t.velocity,t.rawRelease=t.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),t.velocity&&(t.attack=t.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let s=64;t.rawAttack!=null?s=t.rawAttack:isNaN(t.attack)||(s=Math.round(t.attack*127));const r=ft.octaveOffset+this.output.octaveOffset+this.octaveOffset;return gt.buildNoteArray(e,{rawAttack:s}).forEach(a=>{this.send([(qe.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),a.getOffsetNumber(r),a.rawAttack],{time:gt.toTimestamp(t.time)})}),this}sendChannelMode(e,t=0,s={}){if(typeof e=="string"&&(e=qe.CHANNEL_MODE_MESSAGES[e]),ft.validation){if(e===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(e)||!(e>=120&&e<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(t))||t<0||t>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(qe.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),e,t],{time:gt.toTimestamp(s.time)}),this}sendOmniMode(e,t={}){return e===void 0||e?this.sendChannelMode("omnimodeon",0,t):this.sendChannelMode("omnimodeoff",0,t),this}sendChannelAftertouch(e,t={}){if(ft.validation){if(isNaN(parseFloat(e)))throw new RangeError("Invalid channel aftertouch value.");if(t.rawValue){if(!(e>=0&&e<=127&&Number.isInteger(e)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(e>=0&&e<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return t.rawValue||(e=gt.fromFloatTo7Bit(e)),this.send([(qe.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(e)],{time:gt.toTimestamp(t.time)}),this}sendMasterTuning(e,t={}){if(e=parseFloat(e)||0,ft.validation&&!(e>-65&&e<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let s=Math.floor(e)+64,r=e-Math.floor(e);r=Math.round((r+1)/2*16383);let a=r>>7&127,i=r&127;return this.sendRpnValue("channelcoarsetuning",s,t),this.sendRpnValue("channelfinetuning",[a,i],t),this}sendModulationRange(e,t,s={}){if(ft.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(t!=null&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return t>=0&&t<=127||(t=0),this.sendRpnValue("modulationrange",[e,t],s),this}sendNrpnValue(e,t,s={}){if(t=[].concat(t),ft.validation){if(!Array.isArray(e)||!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");t.forEach(r=>{if(!(r>=0&&r<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(e,s),this._setCurrentParameter(t,s),this._deselectNonRegisteredParameter(s),this}sendPitchBend(e,t={}){if(ft.validation)if(t.rawValue&&Array.isArray(e)){if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(t.rawValue&&!Array.isArray(e)){if(!(e>=0&&e<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(e)||e===null)throw new RangeError("Invalid pitch bend value.");if(!(e>=-1&&e<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let s=0,r=0;if(t.rawValue&&Array.isArray(e))s=e[0],r=e[1];else if(t.rawValue&&!Array.isArray(e))s=e;else{const a=gt.fromFloatToMsbLsb((e+1)/2);s=a.msb,r=a.lsb}return this.send([(qe.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),r,s],{time:gt.toTimestamp(t.time)}),this}sendPitchBendRange(e,t,s={}){if(ft.validation){if(!Number.isInteger(e)||!(e>=0&&e<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[e,t],s),this}sendProgramChange(e,t={}){if(e=parseInt(e)||0,ft.validation&&!(e>=0&&e<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(qe.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),e],{time:gt.toTimestamp(t.time)}),this}sendRpnValue(e,t,s={}){if(Array.isArray(e)||(e=qe.REGISTERED_PARAMETERS[e]),ft.validation){if(!Number.isInteger(e[0])||!Number.isInteger(e[1]))throw new TypeError("The specified NRPN is invalid.");if(!(e[0]>=0&&e[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(e[1]>=0&&e[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(t).forEach(r=>{if(!(r>=0&&r<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(e,s),this._setCurrentParameter(t,s),this._deselectRegisteredParameter(s),this}sendTuningBank(e,t={}){if(ft.validation&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",e,t),this}sendTuningProgram(e,t={}){if(ft.validation&&(!Number.isInteger(e)||!(e>=0&&e<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",e,t),this}sendLocalControl(e,t={}){return e?this.sendChannelMode("localcontrol",127,t):this.sendChannelMode("localcontrol",0,t)}sendAllNotesOff(e={}){return this.sendChannelMode("allnotesoff",0,e)}sendAllSoundOff(e={}){return this.sendChannelMode("allsoundoff",0,e)}sendResetAllControllers(e={}){return this.sendChannelMode("resetallcontrollers",0,e)}sendPolyphonicMode(e,t={}){return e==="mono"?this.sendChannelMode("monomodeon",0,t):this.sendChannelMode("polymodeon",0,t)}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get output(){return this._output}get number(){return this._number}}/**
 * The `Output` class represents a single MIDI output port (not to be confused with a MIDI channel).
 * A port is made available by a MIDI device. A MIDI device can advertise several input and output
 * ports. Each port has 16 MIDI channels which can be accessed via the [`channels`](#channels)
 * property.
 *
 * The `Output` object is automatically instantiated by the library according to the host's MIDI
 * subsystem and should not be directly instantiated.
 *
 * You can access all available `Output` objects by referring to the
 * [`WebMidi.outputs`](WebMidi#outputs) array or by using methods such as
 * [`WebMidi.getOutputByName()`](WebMidi#getOutputByName) or
 * [`WebMidi.getOutputById()`](WebMidi#getOutputById).
 *
 * @fires Output#opened
 * @fires Output#disconnected
 * @fires Output#closed
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class Bb extends Ro{constructor(e){super(),this._midiOutput=e,this._octaveOffset=0,this.channels=[];for(let t=1;t<=16;t++)this.channels[t]=new fB(this,t);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(e){let t={timestamp:ft.time};e.port.connection==="open"?(t.type="opened",t.target=this,t.port=t.target,this.emit("opened",t)):e.port.connection==="closed"&&e.port.state==="connected"?(t.type="closed",t.target=this,t.port=t.target,this.emit("closed",t)):e.port.connection==="closed"&&e.port.state==="disconnected"?(t.type="disconnected",t.port={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):e.port.connection==="pending"&&e.port.state==="disconnected"||console.warn("This statechange event was not caught:",e.port.connection,e.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(e){return Promise.reject(e)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(e,t={time:0},s=0){if(e instanceof QC&&(e=gt.isNode?e.data:e.rawData),e instanceof Uint8Array&&gt.isNode&&(e=Array.from(e)),ft.validation){if(!Array.isArray(e)&&!(e instanceof Uint8Array)&&(e=[e],Array.isArray(t)&&(e=e.concat(t)),t=isNaN(s)?{time:0}:{time:s}),!(parseInt(e[0])>=128&&parseInt(e[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");e.slice(1).forEach(r=>{if(r=parseInt(r),!(r>=0&&r<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),t||(t={time:0})}return this._midiOutput.send(e,gt.toTimestamp(t.time)),this}sendSysex(e,t=[],s={}){if(e=[].concat(e),t instanceof Uint8Array){const r=new Uint8Array(1+e.length+t.length+1);r[0]=qe.SYSTEM_MESSAGES.sysex,r.set(Uint8Array.from(e),1),r.set(t,1+e.length),r[r.length-1]=qe.SYSTEM_MESSAGES.sysexend,this.send(r,{time:s.time})}else{const r=e.concat(t,qe.SYSTEM_MESSAGES.sysexend);this.send([qe.SYSTEM_MESSAGES.sysex].concat(r),{time:s.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():ft.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(e,t={}){if(ft.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([qe.SYSTEM_MESSAGES.timecode,e],{time:t.time}),this}sendSongPosition(e=0,t={}){e=Math.floor(e)||0;var s=e>>7&127,r=e&127;return this.send([qe.SYSTEM_MESSAGES.songposition,s,r],{time:t.time}),this}sendSongSelect(e=0,t={}){if(ft.validation&&(e=parseInt(e),isNaN(e)||!(e>=0&&e<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([qe.SYSTEM_MESSAGES.songselect,e],{time:t.time}),this}sendTuneRequest(e={}){return this.send([qe.SYSTEM_MESSAGES.tunerequest],{time:e.time}),this}sendClock(e={}){return this.send([qe.SYSTEM_MESSAGES.clock],{time:e.time}),this}sendStart(e={}){return this.send([qe.SYSTEM_MESSAGES.start],{time:e.time}),this}sendContinue(e={}){return this.send([qe.SYSTEM_MESSAGES.continue],{time:e.time}),this}sendStop(e={}){return this.send([qe.SYSTEM_MESSAGES.stop],{time:e.time}),this}sendActiveSensing(e={}){return this.send([qe.SYSTEM_MESSAGES.activesensing],{time:e.time}),this}sendReset(e={}){return this.send([qe.SYSTEM_MESSAGES.reset],{time:e.time}),this}sendTuningRequest(e={}){return ft.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(e)}sendKeyAftertouch(e,t,s={}){return s.channels==null&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r].sendKeyAftertouch(e,t,s)}),this}sendControlChange(e,t,s={},r={}){if(ft.validation&&(Array.isArray(s)||Number.isInteger(s)||s==="all")){const a=s;s=r,s.channels=a,s.channels==="all"&&(s.channels=qe.MIDI_CHANNEL_NUMBERS)}return s.channels==null&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a].sendControlChange(e,t,s)}),this}sendPitchBendRange(e=0,t=0,s={}){return s.channels==null&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r].sendPitchBendRange(e,t,s)}),this}setPitchBendRange(e=0,t=0,s="all",r={}){return ft.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),r.channels=s,r.channels==="all"&&(r.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(e,t,r)}sendRpnValue(e,t,s={}){return s.channels==null&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r].sendRpnValue(e,t,s)}),this}setRegisteredParameter(e,t=[],s="all",r={}){return ft.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),r.channels=s,r.channels==="all"&&(r.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(e,t,r)}sendChannelAftertouch(e,t={},s={}){if(ft.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendChannelAftertouch(e,t)}),this}sendPitchBend(e,t={},s={}){if(ft.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendPitchBend(e,t)}),this}sendProgramChange(e=0,t={},s={}){if(ft.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendProgramChange(e,t)}),this}sendModulationRange(e,t,s={}){return s.channels==null&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r].sendModulationRange(e,t,s)}),this}setModulationRange(e=0,t=0,s="all",r={}){return ft.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),r.channels=s,r.channels==="all"&&(r.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(e,t,r)}sendMasterTuning(e,t={}){return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendMasterTuning(e,t)}),this}setMasterTuning(e,t={},s={}){return ft.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),s.channels=t,s.channels==="all"&&(s.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(e,s)}sendTuningProgram(e,t={}){return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendTuningProgram(e,t)}),this}setTuningProgram(e,t="all",s={}){return ft.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),s.channels=t,s.channels==="all"&&(s.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(e,s)}sendTuningBank(e=0,t={}){return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendTuningBank(e,t)}),this}setTuningBank(e,t="all",s={}){return ft.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),s.channels=t,s.channels==="all"&&(s.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(e,s)}sendChannelMode(e,t=0,s={},r={}){if(ft.validation&&(Array.isArray(s)||Number.isInteger(s)||s==="all")){const a=s;s=r,s.channels=a,s.channels==="all"&&(s.channels=qe.MIDI_CHANNEL_NUMBERS)}return s.channels==null&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(s.channels).forEach(a=>{this.channels[a].sendChannelMode(e,t,s)}),this}sendAllSoundOff(e={}){return e.channels==null&&(e.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].sendAllSoundOff(e)}),this}sendAllNotesOff(e={}){return e.channels==null&&(e.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(e.channels).forEach(t=>{this.channels[t].sendAllNotesOff(e)}),this}sendResetAllControllers(e={},t={}){if(ft.validation&&(Array.isArray(e)||Number.isInteger(e)||e==="all")){const s=e;e=t,e.channels=s,e.channels==="all"&&(e.channels=qe.MIDI_CHANNEL_NUMBERS)}return e.channels==null&&(e.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(e.channels).forEach(s=>{this.channels[s].sendResetAllControllers(e)}),this}sendPolyphonicMode(e,t={},s={}){if(ft.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendPolyphonicMode(e,t)}),this}sendLocalControl(e,t={},s={}){if(ft.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendLocalControl(e,t)}),this}sendOmniMode(e,t={},s={}){if(ft.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendOmniMode(e,t)}),this}sendNrpnValue(e,t,s={}){return s.channels==null&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r].sendNrpnValue(e,t,s)}),this}setNonRegisteredParameter(e,t=[],s="all",r={}){return ft.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),r.channels=s,r.channels==="all"&&(r.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(e,t,r)}sendRpnIncrement(e,t={}){return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendRpnIncrement(e,t)}),this}incrementRegisteredParameter(e,t="all",s={}){return ft.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),s.channels=t,s.channels==="all"&&(s.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(e,s)}sendRpnDecrement(e,t={}){return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(s=>{this.channels[s].sendRpnDecrement(e,t)}),this}decrementRegisteredParameter(e,t="all",s={}){return ft.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),s.channels=t,s.channels==="all"&&(s.channels=qe.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(e,s)}sendNoteOff(e,t={},s={}){if(ft.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendNoteOff(e,t)}),this}stopNote(e,t){return this.sendNoteOff(e,t)}playNote(e,t={},s={}){if(ft.validation&&(t.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),t.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].playNote(e,t)}),this}sendNoteOn(e,t={},s={}){if(ft.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=s,t.channels=r,t.channels==="all"&&(t.channels=qe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendNoteOn(e,t)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}}/**
 * The `Forwarder` class allows the forwarding of MIDI messages to predetermined outputs. When you
 * call its [`forward()`](#forward) method, it will send the specified [`Message`](Message) object
 * to all the outputs listed in its [`destinations`](#destinations) property.
 *
 * If specific channels or message types have been defined in the [`channels`](#channels) or
 * [`types`](#types) properties, only messages matching the channels/types will be forwarded.
 *
 * While it can be manually instantiated, you are more likely to come across a `Forwarder` object as
 * the return value of the [`Input.addForwarder()`](Input#addForwarder) method.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class ik{constructor(e=[],t={}){this.destinations=[],this.types=[...Object.keys(qe.SYSTEM_MESSAGES),...Object.keys(qe.CHANNEL_MESSAGES)],this.channels=qe.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(e)||(e=[e]),t.types&&!Array.isArray(t.types)&&(t.types=[t.types]),t.channels&&!Array.isArray(t.channels)&&(t.channels=[t.channels]),ft.validation&&(e.forEach(s=>{if(!(s instanceof Bb))throw new TypeError("Destinations must be of type 'Output'.")}),t.types!==void 0&&t.types.forEach(s=>{if(!qe.SYSTEM_MESSAGES.hasOwnProperty(s)&&!qe.CHANNEL_MESSAGES.hasOwnProperty(s))throw new TypeError("Type must be a valid message type.")}),t.channels!==void 0&&t.channels.forEach(s=>{if(!qe.MIDI_CHANNEL_NUMBERS.includes(s))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=e,t.types&&(this.types=t.types),t.channels&&(this.channels=t.channels)}forward(e){this.suspended||this.types.includes(e.type)&&(e.channel&&!this.channels.includes(e.channel)||this.destinations.forEach(t=>{ft.validation&&!(t instanceof Bb)||t.send(e)}))}}/**
 * The `InputChannel` class represents a single MIDI input channel (1-16) from a single input
 * device. This object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `InputChannel` objects can be found inside the input's [`channels`](Input#channels)
 * property.
 *
 * @fires InputChannel#midimessage
 * @fires InputChannel#unknownmessage
 *
 * @fires InputChannel#noteoff
 * @fires InputChannel#noteon
 * @fires InputChannel#keyaftertouch
 * @fires InputChannel#programchange
 * @fires InputChannel#channelaftertouch
 * @fires InputChannel#pitchbend
 *
 * @fires InputChannel#allnotesoff
 * @fires InputChannel#allsoundoff
 * @fires InputChannel#localcontrol
 * @fires InputChannel#monomode
 * @fires InputChannel#omnimode
 * @fires InputChannel#resetallcontrollers
 *
 * @fires InputChannel#event:nrpn
 * @fires InputChannel#event:nrpn-dataentrycoarse
 * @fires InputChannel#event:nrpn-dataentryfine
 * @fires InputChannel#event:nrpn-dataincrement
 * @fires InputChannel#event:nrpn-datadecrement
 * @fires InputChannel#event:rpn
 * @fires InputChannel#event:rpn-dataentrycoarse
 * @fires InputChannel#event:rpn-dataentryfine
 * @fires InputChannel#event:rpn-dataincrement
 * @fires InputChannel#event:rpn-datadecrement
 *
 * @fires InputChannel#controlchange
 * @fires InputChannel#event:controlchange-controllerxxx
 * @fires InputChannel#event:controlchange-bankselectcoarse
 * @fires InputChannel#event:controlchange-modulationwheelcoarse
 * @fires InputChannel#event:controlchange-breathcontrollercoarse
 * @fires InputChannel#event:controlchange-footcontrollercoarse
 * @fires InputChannel#event:controlchange-portamentotimecoarse
 * @fires InputChannel#event:controlchange-dataentrycoarse
 * @fires InputChannel#event:controlchange-volumecoarse
 * @fires InputChannel#event:controlchange-balancecoarse
 * @fires InputChannel#event:controlchange-pancoarse
 * @fires InputChannel#event:controlchange-expressioncoarse
 * @fires InputChannel#event:controlchange-effectcontrol1coarse
 * @fires InputChannel#event:controlchange-effectcontrol2coarse
 * @fires InputChannel#event:controlchange-generalpurposecontroller1
 * @fires InputChannel#event:controlchange-generalpurposecontroller2
 * @fires InputChannel#event:controlchange-generalpurposecontroller3
 * @fires InputChannel#event:controlchange-generalpurposecontroller4
 * @fires InputChannel#event:controlchange-bankselectfine
 * @fires InputChannel#event:controlchange-modulationwheelfine
 * @fires InputChannel#event:controlchange-breathcontrollerfine
 * @fires InputChannel#event:controlchange-footcontrollerfine
 * @fires InputChannel#event:controlchange-portamentotimefine
 * @fires InputChannel#event:controlchange-dataentryfine
 * @fires InputChannel#event:controlchange-channelvolumefine
 * @fires InputChannel#event:controlchange-balancefine
 * @fires InputChannel#event:controlchange-panfine
 * @fires InputChannel#event:controlchange-expressionfine
 * @fires InputChannel#event:controlchange-effectcontrol1fine
 * @fires InputChannel#event:controlchange-effectcontrol2fine
 * @fires InputChannel#event:controlchange-damperpedal
 * @fires InputChannel#event:controlchange-portamento
 * @fires InputChannel#event:controlchange-sostenuto
 * @fires InputChannel#event:controlchange-softpedal
 * @fires InputChannel#event:controlchange-legatopedal
 * @fires InputChannel#event:controlchange-hold2
 * @fires InputChannel#event:controlchange-soundvariation
 * @fires InputChannel#event:controlchange-resonance
 * @fires InputChannel#event:controlchange-releasetime
 * @fires InputChannel#event:controlchange-attacktime
 * @fires InputChannel#event:controlchange-brightness
 * @fires InputChannel#event:controlchange-decaytime
 * @fires InputChannel#event:controlchange-vibratorate
 * @fires InputChannel#event:controlchange-vibratodepth
 * @fires InputChannel#event:controlchange-vibratodelay
 * @fires InputChannel#event:controlchange-generalpurposecontroller5
 * @fires InputChannel#event:controlchange-generalpurposecontroller6
 * @fires InputChannel#event:controlchange-generalpurposecontroller7
 * @fires InputChannel#event:controlchange-generalpurposecontroller8
 * @fires InputChannel#event:controlchange-portamentocontrol
 * @fires InputChannel#event:controlchange-highresolutionvelocityprefix
 * @fires InputChannel#event:controlchange-effect1depth
 * @fires InputChannel#event:controlchange-effect2depth
 * @fires InputChannel#event:controlchange-effect3depth
 * @fires InputChannel#event:controlchange-effect4depth
 * @fires InputChannel#event:controlchange-effect5depth
 * @fires InputChannel#event:controlchange-dataincrement
 * @fires InputChannel#event:controlchange-datadecrement
 * @fires InputChannel#event:controlchange-nonregisteredparameterfine
 * @fires InputChannel#event:controlchange-nonregisteredparametercoarse
 * @fires InputChannel#event:controlchange-registeredparameterfine
 * @fires InputChannel#event:controlchange-registeredparametercoarse
 * @fires InputChannel#event:controlchange-allsoundoff
 * @fires InputChannel#event:controlchange-resetallcontrollers
 * @fires InputChannel#event:controlchange-localcontrol
 * @fires InputChannel#event:controlchange-allnotesoff
 * @fires InputChannel#event:controlchange-omnimodeoff
 * @fires InputChannel#event:controlchange-omnimodeon
 * @fires InputChannel#event:controlchange-monomodeon
 * @fires InputChannel#event:controlchange-polymodeon
 * @fires InputChannel#event:
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class gB extends Ro{constructor(e,t){super(),this._input=e,this._number=t,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(e){const t=Object.assign({},e);t.port=this.input,t.target=this,t.type="midimessage",this.emit(t.type,t),this._parseEventForStandardMessages(t)}_parseEventForStandardMessages(e){const t=Object.assign({},e);t.type=t.message.type||"unknownmessage";const s=e.message.dataBytes[0],r=e.message.dataBytes[1];if(t.type==="noteoff"||t.type==="noteon"&&r===0)this.notesState[s]=!1,t.type="noteoff",t.note=new Gu(gt.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+ft.octaveOffset),{rawAttack:0,rawRelease:r}),t.value=gt.from7bitToFloat(r),t.rawValue=r,t.velocity=t.note.release,t.rawVelocity=t.note.rawRelease;else if(t.type==="noteon")this.notesState[s]=!0,t.note=new Gu(gt.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+ft.octaveOffset),{rawAttack:r}),t.value=gt.from7bitToFloat(r),t.rawValue=r,t.velocity=t.note.attack,t.rawVelocity=t.note.rawAttack;else if(t.type==="keyaftertouch")t.note=new Gu(gt.offsetNumber(s,this.octaveOffset+this.input.octaveOffset+ft.octaveOffset)),t.value=gt.from7bitToFloat(r),t.rawValue=r,t.identifier=t.note.identifier,t.key=t.note.number,t.rawKey=s;else if(t.type==="controlchange"){t.controller={number:s,name:qe.CONTROL_CHANGE_MESSAGES[s].name,description:qe.CONTROL_CHANGE_MESSAGES[s].description,position:qe.CONTROL_CHANGE_MESSAGES[s].position},t.subtype=t.controller.name||"controller"+s,t.value=gt.from7bitToFloat(r),t.rawValue=r;const a=Object.assign({},t);a.type=`${t.type}-controller${s}`,delete a.subtype,this.emit(a.type,a);const i=Object.assign({},t);i.type=`${t.type}-`+qe.CONTROL_CHANGE_MESSAGES[s].name,delete i.subtype,i.type.indexOf("controller")!==0&&this.emit(i.type,i),t.message.dataBytes[0]>=120&&this._parseChannelModeMessage(t),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(t.message.dataBytes[0])&&this._parseEventForParameterNumber(t)}else t.type==="programchange"?(t.value=s,t.rawValue=t.value):t.type==="channelaftertouch"?(t.value=gt.from7bitToFloat(s),t.rawValue=s):t.type==="pitchbend"?(t.value=((r<<7)+s-8192)/8192,t.rawValue=(r<<7)+s):t.type="unknownmessage";this.emit(t.type,t)}_parseChannelModeMessage(e){const t=Object.assign({},e);t.type=t.controller.name,t.type==="localcontrol"&&(t.value=t.message.data[2]===127,t.rawValue=t.message.data[2]),t.type==="omnimodeon"?(t.type="omnimode",t.value=!0,t.rawValue=t.message.data[2]):t.type==="omnimodeoff"&&(t.type="omnimode",t.value=!1,t.rawValue=t.message.data[2]),t.type==="monomodeon"?(t.type="monomode",t.value=!0,t.rawValue=t.message.data[2]):t.type==="polymodeon"&&(t.type="monomode",t.value=!1,t.rawValue=t.message.data[2]),this.emit(t.type,t)}_parseEventForParameterNumber(e){const t=e.message.dataBytes[0],s=e.message.dataBytes[1];t===99||t===101?(this._nrpnBuffer=[],this._rpnBuffer=[],t===99?this._nrpnBuffer=[e.message]:s!==127&&(this._rpnBuffer=[e.message])):t===98||t===100?t===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(e.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&s!==127?this._rpnBuffer.push(e.message):this._rpnBuffer=[]):(t===6||t===38||t===96||t===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],e):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],e):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(e){return e===6||e===38||e===96||e===97||e===98||e===99||e===100||e===101}_dispatchParameterNumberEvent(e,t,s,r){e=e==="nrpn"?"nrpn":"rpn";const a={target:r.target,timestamp:r.timestamp,message:r.message,parameterMsb:t,parameterLsb:s,value:gt.from7bitToFloat(r.message.dataBytes[1]),rawValue:r.message.dataBytes[1]};e==="rpn"?a.parameter=Object.keys(qe.REGISTERED_PARAMETERS).find(l=>qe.REGISTERED_PARAMETERS[l][0]===t&&qe.REGISTERED_PARAMETERS[l][1]===s):a.parameter=(t<<7)+s;const i=qe.CONTROL_CHANGE_MESSAGES[r.message.dataBytes[0]].name;a.type=`${e}-${i}`,this.emit(a.type,a);const o=Object.assign({},a);o.type==="nrpn-dataincrement"?o.type="nrpn-databuttonincrement":o.type==="nrpn-datadecrement"?o.type="nrpn-databuttondecrement":o.type==="rpn-dataincrement"?o.type="rpn-databuttonincrement":o.type==="rpn-datadecrement"&&(o.type="rpn-databuttondecrement"),this.emit(o.type,o),a.type=e,a.subtype=i,this.emit(a.type,a)}getChannelModeByNumber(e){return ft.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),e=Math.floor(e)),gt.getChannelModeByNumber(e)}getCcNameByNumber(e){if(ft.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),e=parseInt(e),!(e>=0&&e<=127)))throw new RangeError("Invalid control change number.");return gt.getCcNameByNumber(e)}getNoteState(e){e instanceof Gu&&(e=e.identifier);const t=gt.guessNoteNumber(e,ft.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[t]}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(e){this.validation&&(e=!!e),this.parameterNumberEventsEnabled=e}}/**
 * The `Message` class represents a single MIDI message. It has several properties that make it
 * easy to make sense of the binary data it contains.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class QC{constructor(e){this.rawData=e,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=gt.getPropertyByValue(qe.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=gt.getPropertyByValue(qe.SYSTEM_MESSAGES,this.command)),this.statusByte===qe.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}/**
 * The `Input` class represents a single MIDI input port. This object is automatically instantiated
 * by the library according to the host's MIDI subsystem and does not need to be directly
 * instantiated. Instead, you can access all `Input` objects by referring to the
 * [`WebMidi.inputs`](WebMidi#inputs) array. You can also retrieve inputs by using methods such as
 * [`WebMidi.getInputByName()`](WebMidi#getInputByName) and
 * [`WebMidi.getInputById()`](WebMidi#getInputById).
 *
 * Note that a single MIDI device may expose several inputs and/or outputs.
 *
 * **Important**: the `Input` class does not directly fire channel-specific MIDI messages
 * (such as [`noteon`](InputChannel#event:noteon) or
 * [`controlchange`](InputChannel#event:controlchange), etc.). The [`InputChannel`](InputChannel)
 * object does that. However, you can still use the
 * [`Input.addListener()`](#addListener) method to listen to channel-specific events on multiple
 * [`InputChannel`](InputChannel) objects at once.
 *
 * @fires Input#opened
 * @fires Input#disconnected
 * @fires Input#closed
 * @fires Input#midimessage
 *
 * @fires Input#sysex
 * @fires Input#timecode
 * @fires Input#songposition
 * @fires Input#songselect
 * @fires Input#tunerequest
 * @fires Input#clock
 * @fires Input#start
 * @fires Input#continue
 * @fires Input#stop
 * @fires Input#activesensing
 * @fires Input#reset
 *
 * @fires Input#unknownmidimessage
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class bB extends Ro{constructor(e){super(),this._midiInput=e,this._octaveOffset=0,this.channels=[];for(let t=1;t<=16;t++)this.channels[t]=new gB(this,t);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(e=>e.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(e){let t={timestamp:ft.time,target:this,port:this};e.port.connection==="open"?(t.type="opened",this.emit("opened",t)):e.port.connection==="closed"&&e.port.state==="connected"?(t.type="closed",this.emit("closed",t)):e.port.connection==="closed"&&e.port.state==="disconnected"?(t.type="disconnected",t.port={connection:e.port.connection,id:e.port.id,manufacturer:e.port.manufacturer,name:e.port.name,state:e.port.state,type:e.port.type},this.emit("disconnected",t)):e.port.connection==="pending"&&e.port.state==="disconnected"||console.warn("This statechange event was not caught: ",e.port.connection,e.port.state)}_onMidiMessage(e){const t=new QC(e.data),s={port:this,target:this,message:t,timestamp:e.timeStamp,type:"midimessage",data:t.data,rawData:t.data,statusByte:t.data[0],dataBytes:t.dataBytes};this.emit("midimessage",s),t.isSystemMessage?this._parseEvent(s):t.isChannelMessage&&this.channels[t.channel]._processMidiMessageEvent(s),this._forwarders.forEach(r=>r.forward(t))}_parseEvent(e){const t=Object.assign({},e);t.type=t.message.type||"unknownmidimessage",t.type==="songselect"&&(t.song=e.data[1]+1,t.value=e.data[1],t.rawValue=t.value),this.emit(t.type,t)}async open(){try{await this._midiInput.open()}catch(e){return Promise.reject(e)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(e){return Promise.reject(e)}return Promise.resolve(this)}getChannelModeByNumber(){ft.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(e,t,s={}){if(ft.validation&&typeof s=="function"){let r=t!=null?[].concat(t):void 0;t=s,s={channels:r}}if(qe.CHANNEL_EVENTS.includes(e)){s.channels===void 0&&(s.channels=qe.MIDI_CHANNEL_NUMBERS);let r=[];return gt.sanitizeChannels(s.channels).forEach(a=>{r.push(this.channels[a].addListener(e,t,s))}),r}else return super.addListener(e,t,s)}addOneTimeListener(e,t,s={}){return s.remaining=1,this.addListener(e,t,s)}on(e,t,s,r){return this.addListener(e,t,s,r)}hasListener(e,t,s={}){if(ft.validation&&typeof s=="function"){let r=[].concat(t);t=s,s={channels:r}}return qe.CHANNEL_EVENTS.includes(e)?(s.channels===void 0&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),gt.sanitizeChannels(s.channels).every(r=>this.channels[r].hasListener(e,t))):super.hasListener(e,t)}removeListener(e,t,s={}){if(ft.validation&&typeof s=="function"){let r=[].concat(t);t=s,s={channels:r}}if(s.channels===void 0&&(s.channels=qe.MIDI_CHANNEL_NUMBERS),e==null)return gt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r]&&this.channels[r].removeListener()}),super.removeListener();qe.CHANNEL_EVENTS.includes(e)?gt.sanitizeChannels(s.channels).forEach(r=>{this.channels[r].removeListener(e,t,s)}):super.removeListener(e,t,s)}addForwarder(e,t={}){let s;return e instanceof ik?s=e:s=new ik(e,t),this._forwarders.push(s),s}removeForwarder(e){this._forwarders=this._forwarders.filter(t=>t!==e)}hasForwarder(e){return this._forwarders.includes(e)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return ft.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}/**
 * The `WebMidi` object makes it easier to work with the low-level Web MIDI API. Basically, it
 * simplifies sending outgoing MIDI messages and reacting to incoming MIDI messages.
 *
 * When using the WebMidi.js library, you should know that the `WebMidi` class has already been
 * instantiated. You cannot instantiate it yourself. If you use the **IIFE** version, you should
 * simply use the global object called `WebMidi`. If you use the **CJS** (CommonJS) or **ESM** (ES6
 * module) version, you get an already-instantiated object when you import the module.
 *
 * @fires WebMidi#connected
 * @fires WebMidi#disabled
 * @fires WebMidi#disconnected
 * @fires WebMidi#enabled
 * @fires WebMidi#error
 * @fires WebMidi#midiaccessgranted
 * @fires WebMidi#portschanged
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class See extends Ro{constructor(){super(),this.defaults={note:{attack:gt.from7bitToFloat(64),release:gt.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(e={},t=!1){if(gt.isNode)try{window.navigator}catch{let o=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,o)}if(this.validation=e.validation!==!1,this.validation&&(typeof e=="function"&&(e={callback:e,sysex:t}),t&&(e.sysex=!0)),this.enabled)return typeof e.callback=="function"&&e.callback(),Promise.resolve();const s={timestamp:this.time,target:this,type:"error",error:void 0},r={timestamp:this.time,target:this,type:"midiaccessgranted"},a={timestamp:this.time,target:this,type:"enabled"};try{typeof e.requestMIDIAccessFunction=="function"?this.interface=await e.requestMIDIAccessFunction({sysex:e.sysex,software:e.software}):this.interface=await navigator.requestMIDIAccess({sysex:e.sysex,software:e.software})}catch(i){return s.error=i,this.emit("error",s),typeof e.callback=="function"&&e.callback(i),Promise.reject(i)}this.emit("midiaccessgranted",r),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(i){return s.error=i,this.emit("error",s),typeof e.callback=="function"&&e.callback(i),Promise.reject(i)}return this.emit("enabled",a),typeof e.callback=="function"&&e.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let e={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",e),this.removeListener()})}getInputById(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return}if(t.disconnected){for(let s=0;s<this._disconnectedInputs.length;s++)if(this._disconnectedInputs[s]._midiInput&&this._disconnectedInputs[s].id===e.toString())return this._disconnectedInputs[s]}else for(let s=0;s<this.inputs.length;s++)if(this.inputs[s]._midiInput&&this.inputs[s].id===e.toString())return this.inputs[s]}getInputByName(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return;e=e.toString()}if(t.disconnected){for(let s=0;s<this._disconnectedInputs.length;s++)if(~this._disconnectedInputs[s].name.indexOf(e))return this._disconnectedInputs[s]}else for(let s=0;s<this.inputs.length;s++)if(~this.inputs[s].name.indexOf(e))return this.inputs[s]}getOutputByName(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return;e=e.toString()}if(t.disconnected){for(let s=0;s<this._disconnectedOutputs.length;s++)if(~this._disconnectedOutputs[s].name.indexOf(e))return this._disconnectedOutputs[s]}else for(let s=0;s<this.outputs.length;s++)if(~this.outputs[s].name.indexOf(e))return this.outputs[s]}getOutputById(e,t={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!e)return}if(t.disconnected){for(let s=0;s<this._disconnectedOutputs.length;s++)if(this._disconnectedOutputs[s]._midiOutput&&this._disconnectedOutputs[s].id===e.toString())return this._disconnectedOutputs[s]}else for(let s=0;s<this.outputs.length;s++)if(this.outputs[s]._midiOutput&&this.outputs[s].id===e.toString())return this.outputs[s]}noteNameToNumber(e){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),gt.toNoteNumber(e,this.octaveOffset)}getOctave(e){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),e=parseInt(e)),!isNaN(e)&&e>=0&&e<=127?gt.getNoteDetails(gt.offsetNumber(e,this.octaveOffset)).octave:!1}sanitizeChannels(e){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),gt.sanitizeChannels(e)}toMIDIChannels(e){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),gt.sanitizeChannels(e)}guessNoteNumber(e){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),gt.guessNoteNumber(e,this.octaveOffset)}getValidNoteArray(e,t={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),gt.buildNoteArray(e,t)}convertToTimestamp(e){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),gt.toTimestamp(e)}async _destroyInputsAndOutputs(){let e=[];return this.inputs.forEach(t=>e.push(t.destroy())),this.outputs.forEach(t=>e.push(t.destroy())),Promise.all(e).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(e){this._updateInputsAndOutputs();let t={timestamp:e.timeStamp,type:e.port.state,target:this};if(e.port.state==="connected"&&e.port.connection==="open"){e.port.type==="output"?t.port=this.getOutputById(e.port.id):e.port.type==="input"&&(t.port=this.getInputById(e.port.id)),this.emit(e.port.state,t);const s=Object.assign({},t);s.type="portschanged",this.emit(s.type,s)}else if(e.port.state==="disconnected"&&e.port.connection==="pending"){e.port.type==="input"?t.port=this.getInputById(e.port.id,{disconnected:!0}):e.port.type==="output"&&(t.port=this.getOutputById(e.port.id,{disconnected:!0})),this.emit(e.port.state,t);const s=Object.assign({},t);s.type="portschanged",this.emit(s.type,s)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let t=this._inputs.length-1;t>=0;t--){const s=this._inputs[t];Array.from(this.interface.inputs.values()).find(a=>a===s._midiInput)||(this._disconnectedInputs.push(s),this._inputs.splice(t,1))}let e=[];return this.interface.inputs.forEach(t=>{if(!this._inputs.find(s=>s._midiInput===t)){let s=this._disconnectedInputs.find(r=>r._midiInput===t);s||(s=new bB(t)),this._inputs.push(s),e.push(s.open())}}),Promise.all(e)}async _updateOutputs(){if(!this.interface)return;for(let t=this._outputs.length-1;t>=0;t--){const s=this._outputs[t];Array.from(this.interface.outputs.values()).find(a=>a===s._midiOutput)||(this._disconnectedOutputs.push(s),this._outputs.splice(t,1))}let e=[];return this.interface.outputs.forEach(t=>{if(!this._outputs.find(s=>s._midiOutput===t)){let s=this._disconnectedOutputs.find(r=>r._midiOutput===t);s||(s=new Bb(t)),this._outputs.push(s),e.push(s.open())}}),Promise.all(e)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),gt.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),gt.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(e){if(this.validation&&(e=parseInt(e),isNaN(e)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=e}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.14"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),qe.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),qe.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),qe.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),qe.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),qe.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const ft=new See;ft.constructor=null;const a5e=Object.freeze(Object.defineProperty({__proto__:null,Enumerations:qe,Forwarder:ik,Input:bB,InputChannel:gB,Message:QC,Note:Gu,Output:Bb,OutputChannel:fB,Utilities:gt,WebMidi:ft},Symbol.toStringTag,{value:"Module"}));let ok=[],yB=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?yB:ok).push(t=t+n[e])})();function Cee(n){if(n<768)return!1;for(let e=0,t=ok.length;;){let s=e+t>>1;if(n<ok[s])t=s;else if(n>=yB[s])e=s+1;else return!0;if(e==t)return!1}}function AM(n){return n>=127462&&n<=127487}const EM=8205;function Pee(n,e,t=!0,s=!0){return(t?vB:Aee)(n,e,s)}function vB(n,e,t){if(e==n.length)return e;e&&OB(n.charCodeAt(e))&&wB(n.charCodeAt(e-1))&&e--;let s=bO(n,e);for(e+=MM(s);e<n.length;){let r=bO(n,e);if(s==EM||r==EM||t&&Cee(r))e+=MM(r),s=r;else if(AM(r)){let a=0,i=e-2;for(;i>=0&&AM(bO(n,i));)a++,i-=2;if(a%2==0)break;e+=2}else break}return e}function Aee(n,e,t){for(;e>0;){let s=vB(n,e-2,t);if(s<e)return s;e--}return 0}function bO(n,e){let t=n.charCodeAt(e);if(!wB(t)||e+1==n.length)return t;let s=n.charCodeAt(e+1);return OB(s)?(t-55296<<10)+(s-56320)+65536:t}function OB(n){return n>=56320&&n<57344}function wB(n){return n>=55296&&n<56320}function MM(n){return n<65536?1:2}let us=class xB{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,s){[e,t]=Pd(this,e,t);let r=[];return this.decompose(0,e,r,2),s.length&&s.decompose(0,s.length,r,3),this.decompose(t,this.length,r,1),ml.from(r,this.length-(t-e)+s.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Pd(this,e,t);let s=[];return this.decompose(e,t,s,0),ml.from(s,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),s=this.length-this.scanIdentical(e,-1),r=new Sm(this),a=new Sm(e);for(let i=t,o=t;;){if(r.next(i),a.next(i),i=0,r.lineBreak!=a.lineBreak||r.done!=a.done||r.value!=a.value)return!1;if(o+=r.value.length,r.done||o>=s)return!0}}iter(e=1){return new Sm(this,e)}iterRange(e,t=this.length){return new kB(this,e,t)}iterLines(e,t){let s;if(e==null)s=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;s=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new SB(s)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?xB.empty:e.length<=32?new ar(e):ml.from(ar.split(e,[]))}};class ar extends us{constructor(e,t=Eee(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,s,r){for(let a=0;;a++){let i=this.text[a],o=r+i.length;if((t?s:o)>=e)return new Mee(r,o,s,i);r=o+1,s++}}decompose(e,t,s,r){let a=e<=0&&t>=this.length?this:new ar(DM(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let i=s.pop(),o=U0(a.text,i.text.slice(),0,a.length);if(o.length<=32)s.push(new ar(o,i.length+a.length));else{let l=o.length>>1;s.push(new ar(o.slice(0,l)),new ar(o.slice(l)))}}else s.push(a)}replace(e,t,s){if(!(s instanceof ar))return super.replace(e,t,s);[e,t]=Pd(this,e,t);let r=U0(this.text,U0(s.text,DM(this.text,0,e)),t),a=this.length+s.length-(t-e);return r.length<=32?new ar(r,a):ml.from(ar.split(r,[]),a)}sliceString(e,t=this.length,s=`
`){[e,t]=Pd(this,e,t);let r="";for(let a=0,i=0;a<=t&&i<this.text.length;i++){let o=this.text[i],l=a+o.length;a>e&&i&&(r+=s),e<l&&t>a&&(r+=o.slice(Math.max(0,e-a),t-a)),a=l+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let s=[],r=-1;for(let a of e)s.push(a),r+=a.length+1,s.length==32&&(t.push(new ar(s,r)),s=[],r=-1);return r>-1&&t.push(new ar(s,r)),t}}class ml extends us{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let s of e)this.lines+=s.lines}lineInner(e,t,s,r){for(let a=0;;a++){let i=this.children[a],o=r+i.length,l=s+i.lines-1;if((t?l:o)>=e)return i.lineInner(e,t,s,r);r=o+1,s=l+1}}decompose(e,t,s,r){for(let a=0,i=0;i<=t&&a<this.children.length;a++){let o=this.children[a],l=i+o.length;if(e<=l&&t>=i){let c=r&((i<=e?1:0)|(l>=t?2:0));i>=e&&l<=t&&!c?s.push(o):o.decompose(e-i,t-i,s,c)}i=l+1}}replace(e,t,s){if([e,t]=Pd(this,e,t),s.lines<this.lines)for(let r=0,a=0;r<this.children.length;r++){let i=this.children[r],o=a+i.length;if(e>=a&&t<=o){let l=i.replace(e-a,t-a,s),c=this.lines-i.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[r]=l,new ml(u,this.length-(t-e)+s.length)}return super.replace(a,o,l)}a=o+1}return super.replace(e,t,s)}sliceString(e,t=this.length,s=`
`){[e,t]=Pd(this,e,t);let r="";for(let a=0,i=0;a<this.children.length&&i<=t;a++){let o=this.children[a],l=i+o.length;i>e&&a&&(r+=s),e<l&&t>i&&(r+=o.sliceString(e-i,t-i,s)),i=l+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof ml))return 0;let s=0,[r,a,i,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,a+=t){if(r==i||a==o)return s;let l=this.children[r],c=e.children[a];if(l!=c)return s+l.scanIdentical(c,t);s+=l.length+1}}static from(e,t=e.reduce((s,r)=>s+r.length+1,-1)){let s=0;for(let m of e)s+=m.lines;if(s<32){let m=[];for(let y of e)y.flatten(m);return new ar(m,t)}let r=Math.max(32,s>>5),a=r<<1,i=r>>1,o=[],l=0,c=-1,u=[];function h(m){let y;if(m.lines>a&&m instanceof ml)for(let O of m.children)h(O);else m.lines>i&&(l>i||!l)?(d(),o.push(m)):m instanceof ar&&l&&(y=u[u.length-1])instanceof ar&&m.lines+y.lines<=32?(l+=m.lines,c+=m.length+1,u[u.length-1]=new ar(y.text.concat(m.text),y.length+1+m.length)):(l+m.lines>r&&d(),l+=m.lines,c+=m.length+1,u.push(m))}function d(){l!=0&&(o.push(u.length==1?u[0]:ml.from(u,c)),c=-1,l=u.length=0)}for(let m of e)h(m);return d(),o.length==1?o[0]:new ml(o,t)}}us.empty=new ar([""],0);function Eee(n){let e=-1;for(let t of n)e+=t.length+1;return e}function U0(n,e,t=0,s=1e9){for(let r=0,a=0,i=!0;a<n.length&&r<=s;a++){let o=n[a],l=r+o.length;l>=t&&(l>s&&(o=o.slice(0,s-r)),r<t&&(o=o.slice(t-r)),i?(e[e.length-1]+=o,i=!1):e.push(o)),r=l+1}return e}function DM(n,e,t){return U0(n,[""],e,t)}class Sm{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof ar?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let s=this.nodes.length-1,r=this.nodes[s],a=this.offsets[s],i=a>>1,o=r instanceof ar?r.text.length:r.children.length;if(i==(t>0?o:0)){if(s==0)return this.done=!0,this.value="",this;t>0&&this.offsets[s-1]++,this.nodes.pop(),this.offsets.pop()}else if((a&1)==(t>0?0:1)){if(this.offsets[s]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof ar){let l=r.text[i+(t<0?-1:0)];if(this.offsets[s]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=r.children[i+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[s]+=t):(t<0&&this.offsets[s]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof ar?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class kB{constructor(e,t,s){this.value="",this.done=!1,this.cursor=new Sm(e,t>s?-1:1),this.pos=t>s?e.length:0,this.from=Math.min(t,s),this.to=Math.max(t,s)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let s=t<0?this.pos-this.from:this.to-this.pos;e>s&&(e=s),s-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=s?r:t<0?r.slice(r.length-s):r.slice(0,s),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class SB{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:s,value:r}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):s?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(us.prototype[Symbol.iterator]=function(){return this.iter()},Sm.prototype[Symbol.iterator]=kB.prototype[Symbol.iterator]=SB.prototype[Symbol.iterator]=function(){return this});class Mee{constructor(e,t,s,r){this.from=e,this.to=t,this.number=s,this.text=r}get length(){return this.to-this.from}}function Pd(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Rr(n,e,t=!0,s=!0){return Pee(n,e,t,s)}function Dee(n){return n>=56320&&n<57344}function Tee(n){return n>=55296&&n<56320}function Ha(n,e){let t=n.charCodeAt(e);if(!Tee(t)||e+1==n.length)return t;let s=n.charCodeAt(e+1);return Dee(s)?(t-55296<<10)+(s-56320)+65536:t}function jC(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function fl(n){return n<65536?1:2}const lk=/\r\n?|\n/;var pr=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(pr||(pr={}));class El{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let s=this.sections[t+1];e+=s<0?this.sections[t]:s}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,s=0,r=0;t<this.sections.length;){let a=this.sections[t++],i=this.sections[t++];i<0?(e(s,r,a),r+=a):r+=i,s+=a}}iterChangedRanges(e,t=!1){ck(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let s=this.sections[t++],r=this.sections[t++];r<0?e.push(s,r):e.push(r,s)}return new El(e)}composeDesc(e){return this.empty?e:e.empty?this:CB(this,e)}mapDesc(e,t=!1){return e.empty?this:uk(this,e,t)}mapPos(e,t=-1,s=pr.Simple){let r=0,a=0;for(let i=0;i<this.sections.length;){let o=this.sections[i++],l=this.sections[i++],c=r+o;if(l<0){if(c>e)return a+(e-r);a+=o}else{if(s!=pr.Simple&&c>=e&&(s==pr.TrackDel&&r<e&&c>e||s==pr.TrackBefore&&r<e||s==pr.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!o)return e==r||t<0?a:a+l;a+=l}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return a}touchesRange(e,t=e){for(let s=0,r=0;s<this.sections.length&&r<=t;){let a=this.sections[s++],i=this.sections[s++],o=r+a;if(i>=0&&r<=t&&o>=e)return r<e&&o>t?"cover":!0;r=o}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let s=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+s+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new El(e)}static create(e){return new El(e)}}class xr extends El{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return ck(this,(t,s,r,a,i)=>e=e.replace(r,r+(s-t),i),!1),e}mapDesc(e,t=!1){return uk(this,e,t,!0)}invert(e){let t=this.sections.slice(),s=[];for(let r=0,a=0;r<t.length;r+=2){let i=t[r],o=t[r+1];if(o>=0){t[r]=o,t[r+1]=i;let l=r>>1;for(;s.length<l;)s.push(us.empty);s.push(i?e.slice(a,a+i):us.empty)}a+=i}return new xr(t,s)}compose(e){return this.empty?e:e.empty?this:CB(this,e,!0)}map(e,t=!1){return e.empty?this:uk(this,e,t,!0)}iterChanges(e,t=!1){ck(this,e,t)}get desc(){return El.create(this.sections)}filter(e){let t=[],s=[],r=[],a=new qm(this);e:for(let i=0,o=0;;){let l=i==e.length?1e9:e[i++];for(;o<l||o==l&&a.len==0;){if(a.done)break e;let u=Math.min(a.len,l-o);sa(r,u,-1);let h=a.ins==-1?-1:a.off==0?a.ins:0;sa(t,u,h),h>0&&Zc(s,t,a.text),a.forward(u),o+=u}let c=e[i++];for(;o<c;){if(a.done)break e;let u=Math.min(a.len,c-o);sa(t,u,-1),sa(r,u,a.ins==-1?-1:a.off==0?a.ins:0),a.forward(u),o+=u}}return{changes:new xr(t,s),filtered:El.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let s=this.sections[t],r=this.sections[t+1];r<0?e.push(s):r==0?e.push([s]):e.push([s].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,s){let r=[],a=[],i=0,o=null;function l(u=!1){if(!u&&!r.length)return;i<t&&sa(r,t-i,-1);let h=new xr(r,a);o=o?o.compose(h.map(o)):h,r=[],a=[],i=0}function c(u){if(Array.isArray(u))for(let h of u)c(h);else if(u instanceof xr){if(u.length!=t)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${t})`);l(),o=o?o.compose(u.map(o)):u}else{let{from:h,to:d=h,insert:m}=u;if(h>d||h<0||d>t)throw new RangeError(`Invalid change range ${h} to ${d} (in doc of length ${t})`);let y=m?typeof m=="string"?us.of(m.split(s||lk)):m:us.empty,O=y.length;if(h==d&&O==0)return;h<i&&l(),h>i&&sa(r,h-i,-1),sa(r,d-h,O),Zc(a,r,y),i=d}}return c(e),l(!o),o}static empty(e){return new xr(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],s=[];for(let r=0;r<e.length;r++){let a=e[r];if(typeof a=="number")t.push(a,-1);else{if(!Array.isArray(a)||typeof a[0]!="number"||a.some((i,o)=>o&&typeof i!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(a.length==1)t.push(a[0],0);else{for(;s.length<r;)s.push(us.empty);s[r]=us.of(a.slice(1)),t.push(a[0],s[r].length)}}}return new xr(t,s)}static createSet(e,t){return new xr(e,t)}}function sa(n,e,t,s=!1){if(e==0&&t<=0)return;let r=n.length-2;r>=0&&t<=0&&t==n[r+1]?n[r]+=e:r>=0&&e==0&&n[r]==0?n[r+1]+=t:s?(n[r]+=e,n[r+1]+=t):n.push(e,t)}function Zc(n,e,t){if(t.length==0)return;let s=e.length-2>>1;if(s<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<s;)n.push(us.empty);n.push(t)}}function ck(n,e,t){let s=n.inserted;for(let r=0,a=0,i=0;i<n.sections.length;){let o=n.sections[i++],l=n.sections[i++];if(l<0)r+=o,a+=o;else{let c=r,u=a,h=us.empty;for(;c+=o,u+=l,l&&s&&(h=h.append(s[i-2>>1])),!(t||i==n.sections.length||n.sections[i+1]<0);)o=n.sections[i++],l=n.sections[i++];e(r,c,a,u,h),r=c,a=u}}}function uk(n,e,t,s=!1){let r=[],a=s?[]:null,i=new qm(n),o=new qm(e);for(let l=-1;;){if(i.done&&o.len||o.done&&i.len)throw new Error("Mismatched change set lengths");if(i.ins==-1&&o.ins==-1){let c=Math.min(i.len,o.len);sa(r,c,-1),i.forward(c),o.forward(c)}else if(o.ins>=0&&(i.ins<0||l==i.i||i.off==0&&(o.len<i.len||o.len==i.len&&!t))){let c=o.len;for(sa(r,o.ins,-1);c;){let u=Math.min(i.len,c);i.ins>=0&&l<i.i&&i.len<=u&&(sa(r,0,i.ins),a&&Zc(a,r,i.text),l=i.i),i.forward(u),c-=u}o.next()}else if(i.ins>=0){let c=0,u=i.len;for(;u;)if(o.ins==-1){let h=Math.min(u,o.len);c+=h,u-=h,o.forward(h)}else if(o.ins==0&&o.len<u)u-=o.len,o.next();else break;sa(r,c,l<i.i?i.ins:0),a&&l<i.i&&Zc(a,r,i.text),l=i.i,i.forward(i.len-u)}else{if(i.done&&o.done)return a?xr.createSet(r,a):El.create(r);throw new Error("Mismatched change set lengths")}}}function CB(n,e,t=!1){let s=[],r=t?[]:null,a=new qm(n),i=new qm(e);for(let o=!1;;){if(a.done&&i.done)return r?xr.createSet(s,r):El.create(s);if(a.ins==0)sa(s,a.len,0,o),a.next();else if(i.len==0&&!i.done)sa(s,0,i.ins,o),r&&Zc(r,s,i.text),i.next();else{if(a.done||i.done)throw new Error("Mismatched change set lengths");{let l=Math.min(a.len2,i.len),c=s.length;if(a.ins==-1){let u=i.ins==-1?-1:i.off?0:i.ins;sa(s,l,u,o),r&&u&&Zc(r,s,i.text)}else i.ins==-1?(sa(s,a.off?0:a.len,l,o),r&&Zc(r,s,a.textBit(l))):(sa(s,a.off?0:a.len,i.off?0:i.ins,o),r&&!i.off&&Zc(r,s,i.text));o=(a.ins>l||i.ins>=0&&i.len>l)&&(o||s.length>c),a.forward2(l),i.forward(l)}}}}class qm{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?us.empty:e[t]}textBit(e){let{inserted:t}=this.set,s=this.i-2>>1;return s>=t.length&&!e?us.empty:t[s].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Xu{constructor(e,t,s){this.from=e,this.to=t,this.flags=s}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let s,r;return this.empty?s=r=e.mapPos(this.from,t):(s=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),s==this.from&&r==this.to?this:new Xu(s,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return Le.range(e,t);let s=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Le.range(this.anchor,s)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Le.range(e.anchor,e.head)}static create(e,t,s){return new Xu(e,t,s)}}class Le{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:Le.create(this.ranges.map(s=>s.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let s=0;s<this.ranges.length;s++)if(!this.ranges[s].eq(e.ranges[s],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Le([this.main],0)}addRange(e,t=!0){return Le.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let s=this.ranges.slice();return s[t]=e,Le.create(s,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Le(e.ranges.map(t=>Xu.fromJSON(t)),e.main)}static single(e,t=e){return new Le([Le.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let s=0,r=0;r<e.length;r++){let a=e[r];if(a.empty?a.from<=s:a.from<s)return Le.normalized(e.slice(),t);s=a.to}return new Le(e,t)}static cursor(e,t=0,s,r){return Xu.create(e,e,(t==0?0:t<0?8:16)|(s==null?7:Math.min(6,s))|(r??16777215)<<6)}static range(e,t,s,r){let a=(s??16777215)<<6|(r==null?7:Math.min(6,r));return t<e?Xu.create(t,e,48|a):Xu.create(e,t,(t>e?8:0)|a)}static normalized(e,t=0){let s=e[t];e.sort((r,a)=>r.from-a.from),t=e.indexOf(s);for(let r=1;r<e.length;r++){let a=e[r],i=e[r-1];if(a.empty?a.from<=i.to:a.from<i.to){let o=i.from,l=Math.max(a.to,i.to);r<=t&&t--,e.splice(--r,2,a.anchor>a.head?Le.range(l,o):Le.range(o,l))}}return new Le(e,t)}}function PB(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let VC=0;class Dt{constructor(e,t,s,r,a){this.combine=e,this.compareInput=t,this.compare=s,this.isStatic=r,this.id=VC++,this.default=e([]),this.extensions=typeof a=="function"?a(this):a}get reader(){return this}static define(e={}){return new Dt(e.combine||(t=>t),e.compareInput||((t,s)=>t===s),e.compare||(e.combine?(t,s)=>t===s:ZC),!!e.static,e.enables)}of(e){return new W0([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new W0(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new W0(e,this,2,t)}from(e,t){return t||(t=s=>s),this.compute([e],s=>t(s.field(e)))}}function ZC(n,e){return n==e||n.length==e.length&&n.every((t,s)=>t===e[s])}class W0{constructor(e,t,s,r){this.dependencies=e,this.facet=t,this.type=s,this.value=r,this.id=VC++}dynamicSlot(e){var t;let s=this.value,r=this.facet.compareInput,a=this.id,i=e[a]>>1,o=this.type==2,l=!1,c=!1,u=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?c=!0:(((t=e[h.id])!==null&&t!==void 0?t:1)&1)==0&&u.push(e[h.id]);return{create(h){return h.values[i]=s(h),1},update(h,d){if(l&&d.docChanged||c&&(d.docChanged||d.selection)||hk(h,u)){let m=s(h);if(o?!TM(m,h.values[i],r):!r(m,h.values[i]))return h.values[i]=m,1}return 0},reconfigure:(h,d)=>{let m,y=d.config.address[a];if(y!=null){let O=$b(d,y);if(this.dependencies.every(S=>S instanceof Dt?d.facet(S)===h.facet(S):S instanceof qs?d.field(S,!1)==h.field(S,!1):!0)||(o?TM(m=s(h),O,r):r(m=s(h),O)))return h.values[i]=O,0}else m=s(h);return h.values[i]=m,1}}}}function TM(n,e,t){if(n.length!=e.length)return!1;for(let s=0;s<n.length;s++)if(!t(n[s],e[s]))return!1;return!0}function hk(n,e){let t=!1;for(let s of e)Cm(n,s)&1&&(t=!0);return t}function Bee(n,e,t){let s=t.map(l=>n[l.id]),r=t.map(l=>l.type),a=s.filter(l=>!(l&1)),i=n[e.id]>>1;function o(l){let c=[];for(let u=0;u<s.length;u++){let h=$b(l,s[u]);if(r[u]==2)for(let d of h)c.push(d);else c.push(h)}return e.combine(c)}return{create(l){for(let c of s)Cm(l,c);return l.values[i]=o(l),1},update(l,c){if(!hk(l,a))return 0;let u=o(l);return e.compare(u,l.values[i])?0:(l.values[i]=u,1)},reconfigure(l,c){let u=hk(l,s),h=c.config.facets[e.id],d=c.facet(e);if(h&&!u&&ZC(t,h))return l.values[i]=d,0;let m=o(l);return e.compare(m,d)?(l.values[i]=d,0):(l.values[i]=m,1)}}}const xg=Dt.define({static:!0});class qs{constructor(e,t,s,r,a){this.id=e,this.createF=t,this.updateF=s,this.compareF=r,this.spec=a,this.provides=void 0}static define(e){let t=new qs(VC++,e.create,e.update,e.compare||((s,r)=>s===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(xg).find(s=>s.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:s=>(s.values[t]=this.create(s),1),update:(s,r)=>{let a=s.values[t],i=this.updateF(a,r);return this.compareF(a,i)?0:(s.values[t]=i,1)},reconfigure:(s,r)=>{let a=s.facet(xg),i=r.facet(xg),o;return(o=a.find(l=>l.field==this))&&o!=i.find(l=>l.field==this)?(s.values[t]=o.create(s),1):r.config.address[this.id]!=null?(s.values[t]=r.field(this),0):(s.values[t]=this.create(s),1)}}}init(e){return[this,xg.of({field:this,create:e})]}get extension(){return this}}const ju={lowest:4,low:3,default:2,high:1,highest:0};function Ep(n){return e=>new AB(e,n)}const Fi={highest:Ep(ju.highest),high:Ep(ju.high),default:Ep(ju.default),low:Ep(ju.low),lowest:Ep(ju.lowest)};class AB{constructor(e,t){this.inner=e,this.prec=t}}class Vf{of(e){return new dk(this,e)}reconfigure(e){return Vf.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class dk{constructor(e,t){this.compartment=e,this.inner=t}}class Fb{constructor(e,t,s,r,a,i){for(this.base=e,this.compartments=t,this.dynamicSlots=s,this.address=r,this.staticValues=a,this.facets=i,this.statusTemplate=[];this.statusTemplate.length<s.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,s){let r=[],a=Object.create(null),i=new Map;for(let d of Fee(e,t,i))d instanceof qs?r.push(d):(a[d.facet.id]||(a[d.facet.id]=[])).push(d);let o=Object.create(null),l=[],c=[];for(let d of r)o[d.id]=c.length<<1,c.push(m=>d.slot(m));let u=s==null?void 0:s.config.facets;for(let d in a){let m=a[d],y=m[0].facet,O=u&&u[d]||[];if(m.every(S=>S.type==0))if(o[y.id]=l.length<<1|1,ZC(O,m))l.push(s.facet(y));else{let S=y.combine(m.map(A=>A.value));l.push(s&&y.compare(S,s.facet(y))?s.facet(y):S)}else{for(let S of m)S.type==0?(o[S.id]=l.length<<1|1,l.push(S.value)):(o[S.id]=c.length<<1,c.push(A=>S.dynamicSlot(A)));o[y.id]=c.length<<1,c.push(S=>Bee(S,y,m))}}let h=c.map(d=>d(o));return new Fb(e,i,h,o,l,a)}}function Fee(n,e,t){let s=[[],[],[],[],[]],r=new Map;function a(i,o){let l=r.get(i);if(l!=null){if(l<=o)return;let c=s[l].indexOf(i);c>-1&&s[l].splice(c,1),i instanceof dk&&t.delete(i.compartment)}if(r.set(i,o),Array.isArray(i))for(let c of i)a(c,o);else if(i instanceof dk){if(t.has(i.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(i.compartment)||i.inner;t.set(i.compartment,c),a(c,o)}else if(i instanceof AB)a(i.inner,i.prec);else if(i instanceof qs)s[o].push(i),i.provides&&a(i.provides,o);else if(i instanceof W0)s[o].push(i),i.facet.extensions&&a(i.facet.extensions,ju.default);else{let c=i.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${i}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);a(c,o)}}return a(n,ju.default),s.reduce((i,o)=>i.concat(o))}function Cm(n,e){if(e&1)return 2;let t=e>>1,s=n.status[t];if(s==4)throw new Error("Cyclic dependency between fields and/or facets");if(s&2)return s;n.status[t]=4;let r=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|r}function $b(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const EB=Dt.define(),pk=Dt.define({combine:n=>n.some(e=>e),static:!0}),MB=Dt.define({combine:n=>n.length?n[0]:void 0,static:!0}),DB=Dt.define(),TB=Dt.define(),BB=Dt.define(),FB=Dt.define({combine:n=>n.length?n[0]:!1});class Cc{constructor(e,t){this.type=e,this.value=t}static define(){return new $ee}}class $ee{of(e){return new Cc(this,e)}}class Nee{constructor(e){this.map=e}of(e){return new rn(this,e)}}class rn{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new rn(this.type,t)}is(e){return this.type==e}static define(e={}){return new Nee(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let s=[];for(let r of e){let a=r.map(t);a&&s.push(a)}return s}}rn.reconfigure=rn.define();rn.appendConfig=rn.define();class fr{constructor(e,t,s,r,a,i){this.startState=e,this.changes=t,this.selection=s,this.effects=r,this.annotations=a,this.scrollIntoView=i,this._doc=null,this._state=null,s&&PB(s,t.newLength),a.some(o=>o.type==fr.time)||(this.annotations=a.concat(fr.time.of(Date.now())))}static create(e,t,s,r,a,i){return new fr(e,t,s,r,a,i)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(fr.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}fr.time=Cc.define();fr.userEvent=Cc.define();fr.addToHistory=Cc.define();fr.remote=Cc.define();function _ee(n,e){let t=[];for(let s=0,r=0;;){let a,i;if(s<n.length&&(r==e.length||e[r]>=n[s]))a=n[s++],i=n[s++];else if(r<e.length)a=e[r++],i=e[r++];else return t;!t.length||t[t.length-1]<a?t.push(a,i):t[t.length-1]<i&&(t[t.length-1]=i)}}function $B(n,e,t){var s;let r,a,i;return t?(r=e.changes,a=xr.empty(e.changes.length),i=n.changes.compose(e.changes)):(r=e.changes.map(n.changes),a=n.changes.mapDesc(e.changes,!0),i=n.changes.compose(r)),{changes:i,selection:e.selection?e.selection.map(a):(s=n.selection)===null||s===void 0?void 0:s.map(r),effects:rn.mapEffects(n.effects,r).concat(rn.mapEffects(e.effects,a)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function mk(n,e,t){let s=e.selection,r=sd(e.annotations);return e.userEvent&&(r=r.concat(fr.userEvent.of(e.userEvent))),{changes:e.changes instanceof xr?e.changes:xr.of(e.changes||[],t,n.facet(MB)),selection:s&&(s instanceof Le?s:Le.single(s.anchor,s.head)),effects:sd(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function NB(n,e,t){let s=mk(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let a=1;a<e.length;a++){e[a].filter===!1&&(t=!1);let i=!!e[a].sequential;s=$B(s,mk(n,e[a],i?s.changes.newLength:n.doc.length),i)}let r=fr.create(n,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return Iee(t?Ree(r):r)}function Ree(n){let e=n.startState,t=!0;for(let r of e.facet(DB)){let a=r(n);if(a===!1){t=!1;break}Array.isArray(a)&&(t=t===!0?a:_ee(t,a))}if(t!==!0){let r,a;if(t===!1)a=n.changes.invertedDesc,r=xr.empty(e.doc.length);else{let i=n.changes.filter(t);r=i.changes,a=i.filtered.mapDesc(i.changes).invertedDesc}n=fr.create(e,r,n.selection&&n.selection.map(a),rn.mapEffects(n.effects,a),n.annotations,n.scrollIntoView)}let s=e.facet(TB);for(let r=s.length-1;r>=0;r--){let a=s[r](n);a instanceof fr?n=a:Array.isArray(a)&&a.length==1&&a[0]instanceof fr?n=a[0]:n=NB(e,sd(a),!1)}return n}function Iee(n){let e=n.startState,t=e.facet(BB),s=n;for(let r=t.length-1;r>=0;r--){let a=t[r](n);a&&Object.keys(a).length&&(s=$B(s,mk(e,a,n.changes.newLength),!0))}return s==n?n:fr.create(e,n.changes,n.selection,s.effects,s.annotations,s.scrollIntoView)}const Lee=[];function sd(n){return n==null?Lee:Array.isArray(n)?n:[n]}var zs=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(zs||(zs={}));const Qee=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let fk;try{fk=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function jee(n){if(fk)return fk.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||Qee.test(t)))return!0}return!1}function Vee(n){return e=>{if(!/\S/.test(e))return zs.Space;if(jee(e))return zs.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return zs.Word;return zs.Other}}class ls{constructor(e,t,s,r,a,i){this.config=e,this.doc=t,this.selection=s,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=a,i&&(i._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)Cm(this,o<<1);this.computeSlot=null}field(e,t=!0){let s=this.config.address[e.id];if(s==null){if(t)throw new RangeError("Field is not present in this state");return}return Cm(this,s),$b(this,s)}update(...e){return NB(this,e,!0)}applyTransaction(e){let t=this.config,{base:s,compartments:r}=t;for(let o of e.effects)o.is(Vf.reconfigure)?(t&&(r=new Map,t.compartments.forEach((l,c)=>r.set(c,l)),t=null),r.set(o.value.compartment,o.value.extension)):o.is(rn.reconfigure)?(t=null,s=o.value):o.is(rn.appendConfig)&&(t=null,s=sd(s).concat(o.value));let a;t?a=e.startState.values.slice():(t=Fb.resolve(s,r,this),a=new ls(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let i=e.startState.facet(pk)?e.newSelection:e.newSelection.asSingle();new ls(t,e.newDoc,i,a,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:Le.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,s=e(t.ranges[0]),r=this.changes(s.changes),a=[s.range],i=sd(s.effects);for(let o=1;o<t.ranges.length;o++){let l=e(t.ranges[o]),c=this.changes(l.changes),u=c.map(r);for(let d=0;d<o;d++)a[d]=a[d].map(u);let h=r.mapDesc(c,!0);a.push(l.range.map(h)),r=r.compose(u),i=rn.mapEffects(i,u).concat(rn.mapEffects(sd(l.effects),h))}return{changes:r,selection:Le.create(a,t.mainIndex),effects:i}}changes(e=[]){return e instanceof xr?e:xr.of(e,this.doc.length,this.facet(ls.lineSeparator))}toText(e){return us.of(e.split(this.facet(ls.lineSeparator)||lk))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Cm(this,t),$b(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let s in e){let r=e[s];r instanceof qs&&this.config.address[r.id]!=null&&(t[s]=r.spec.toJSON(this.field(e[s]),this))}return t}static fromJSON(e,t={},s){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(s){for(let a in s)if(Object.prototype.hasOwnProperty.call(e,a)){let i=s[a],o=e[a];r.push(i.init(l=>i.spec.fromJSON(o,l)))}}return ls.create({doc:e.doc,selection:Le.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=Fb.resolve(e.extensions||[],new Map),s=e.doc instanceof us?e.doc:us.of((e.doc||"").split(t.staticFacet(ls.lineSeparator)||lk)),r=e.selection?e.selection instanceof Le?e.selection:Le.single(e.selection.anchor,e.selection.head):Le.single(0);return PB(r,s.length),t.staticFacet(pk)||(r=r.asSingle()),new ls(t,s,r,t.dynamicSlots.map(()=>null),(a,i)=>i.create(a),null)}get tabSize(){return this.facet(ls.tabSize)}get lineBreak(){return this.facet(ls.lineSeparator)||`
`}get readOnly(){return this.facet(FB)}phrase(e,...t){for(let s of this.facet(ls.phrases))if(Object.prototype.hasOwnProperty.call(s,e)){e=s[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(s,r)=>{if(r=="$")return"$";let a=+(r||1);return!a||a>t.length?s:t[a-1]})),e}languageDataAt(e,t,s=-1){let r=[];for(let a of this.facet(EB))for(let i of a(this,t,s))Object.prototype.hasOwnProperty.call(i,e)&&r.push(i[e]);return r}charCategorizer(e){let t=this.languageDataAt("wordChars",e);return Vee(t.length?t[0]:"")}wordAt(e){let{text:t,from:s,length:r}=this.doc.lineAt(e),a=this.charCategorizer(e),i=e-s,o=e-s;for(;i>0;){let l=Rr(t,i,!1);if(a(t.slice(l,i))!=zs.Word)break;i=l}for(;o<r;){let l=Rr(t,o);if(a(t.slice(o,l))!=zs.Word)break;o=l}return i==o?null:Le.range(i+s,o+s)}}ls.allowMultipleSelections=pk;ls.tabSize=Dt.define({combine:n=>n.length?n[0]:4});ls.lineSeparator=MB;ls.readOnly=FB;ls.phrases=Dt.define({compare(n,e){let t=Object.keys(n),s=Object.keys(e);return t.length==s.length&&t.every(r=>n[r]==e[r])}});ls.languageData=EB;ls.changeFilter=DB;ls.transactionFilter=TB;ls.transactionExtender=BB;Vf.reconfigure=rn.define();function Ll(n,e,t={}){let s={};for(let r of n)for(let a of Object.keys(r)){let i=r[a],o=s[a];if(o===void 0)s[a]=i;else if(!(o===i||i===void 0))if(Object.hasOwnProperty.call(t,a))s[a]=t[a](o,i);else throw new Error("Config merge conflict for field "+a)}for(let r in e)s[r]===void 0&&(s[r]=e[r]);return s}class ou{eq(e){return this==e}range(e,t=e){return gk.create(e,t,this)}}ou.prototype.startSide=ou.prototype.endSide=0;ou.prototype.point=!1;ou.prototype.mapMode=pr.TrackDel;function zC(n,e){return n==e||n.constructor==e.constructor&&n.eq(e)}let gk=class _B{constructor(e,t,s){this.from=e,this.to=t,this.value=s}static create(e,t,s){return new _B(e,t,s)}};function bk(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class qC{constructor(e,t,s,r){this.from=e,this.to=t,this.value=s,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,s,r=0){let a=s?this.to:this.from;for(let i=r,o=a.length;;){if(i==o)return i;let l=i+o>>1,c=a[l]-e||(s?this.value[l].endSide:this.value[l].startSide)-t;if(l==i)return c>=0?i:o;c>=0?o=l:i=l+1}}between(e,t,s,r){for(let a=this.findIndex(t,-1e9,!0),i=this.findIndex(s,1e9,!1,a);a<i;a++)if(r(this.from[a]+e,this.to[a]+e,this.value[a])===!1)return!1}map(e,t){let s=[],r=[],a=[],i=-1,o=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+e,h=this.to[l]+e,d,m;if(u==h){let y=t.mapPos(u,c.startSide,c.mapMode);if(y==null||(d=m=y,c.startSide!=c.endSide&&(m=t.mapPos(u,c.endSide),m<d)))continue}else if(d=t.mapPos(u,c.startSide),m=t.mapPos(h,c.endSide),d>m||d==m&&c.startSide>0&&c.endSide<=0)continue;(m-d||c.endSide-c.startSide)<0||(i<0&&(i=d),c.point&&(o=Math.max(o,m-d)),s.push(c),r.push(d-i),a.push(m-i))}return{mapped:s.length?new qC(r,a,s,o):null,pos:i}}}class Zn{constructor(e,t,s,r){this.chunkPos=e,this.chunk=t,this.nextLayer=s,this.maxPoint=r}static create(e,t,s,r){return new Zn(e,t,s,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:s=!1,filterFrom:r=0,filterTo:a=this.length}=e,i=e.filter;if(t.length==0&&!i)return this;if(s&&(t=t.slice().sort(bk)),this.isEmpty)return t.length?Zn.of(t):this;let o=new RB(this,null,-1).goto(0),l=0,c=[],u=new qo;for(;o.value||l<t.length;)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let h=t[l++];u.addInner(h.from,h.to,h.value)||c.push(h)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!i||r>this.chunkEnd(o.chunkIndex)||a<this.chunkPos[o.chunkIndex])&&u.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!i||r>o.to||a<o.from||i(o.from,o.to,o.value))&&(u.addInner(o.from,o.to,o.value)||c.push(gk.create(o.from,o.to,o.value))),o.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?Zn.empty:this.nextLayer.update({add:c,filter:i,filterFrom:r,filterTo:a}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],s=[],r=-1;for(let i=0;i<this.chunk.length;i++){let o=this.chunkPos[i],l=this.chunk[i],c=e.touchesRange(o,o+l.length);if(c===!1)r=Math.max(r,l.maxPoint),t.push(l),s.push(e.mapPos(o));else if(c===!0){let{mapped:u,pos:h}=l.map(o,e);u&&(r=Math.max(r,u.maxPoint),t.push(u),s.push(h))}}let a=this.nextLayer.map(e);return t.length==0?a:new Zn(s,t,a||Zn.empty,r)}between(e,t,s){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let a=this.chunkPos[r],i=this.chunk[r];if(t>=a&&e<=a+i.length&&i.between(a,e-a,t-a,s)===!1)return}this.nextLayer.between(e,t,s)}}iter(e=0){return Um.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Um.from(e).goto(t)}static compare(e,t,s,r,a=-1){let i=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=a),o=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=a),l=BM(i,o,s),c=new Mp(i,l,a),u=new Mp(o,l,a);s.iterGaps((h,d,m)=>FM(c,h,u,d,m,r)),s.empty&&s.length==0&&FM(c,0,u,0,0,r)}static eq(e,t,s=0,r){r==null&&(r=999999999);let a=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0),i=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(a.length!=i.length)return!1;if(!a.length)return!0;let o=BM(a,i),l=new Mp(a,o,0).goto(s),c=new Mp(i,o,0).goto(s);for(;;){if(l.to!=c.to||!yk(l.active,c.active)||l.point&&(!c.point||!zC(l.point,c.point)))return!1;if(l.to>r)return!0;l.next(),c.next()}}static spans(e,t,s,r,a=-1){let i=new Mp(e,null,a).goto(t),o=t,l=i.openStart;for(;;){let c=Math.min(i.to,s);if(i.point){let u=i.activeForPoint(i.to),h=i.pointFrom<t?u.length+1:i.point.startSide<0?u.length:Math.min(u.length,l);r.point(o,c,i.point,u,h,i.pointRank),l=Math.min(i.openEnd(c),u.length)}else c>o&&(r.span(o,c,i.active,l),l=i.openEnd(c));if(i.to>s)return l+(i.point&&i.to>s?1:0);o=i.to,i.next()}}static of(e,t=!1){let s=new qo;for(let r of e instanceof gk?[e]:t?Zee(e):e)s.add(r.from,r.to,r.value);return s.finish()}static join(e){if(!e.length)return Zn.empty;let t=e[e.length-1];for(let s=e.length-2;s>=0;s--)for(let r=e[s];r!=Zn.empty;r=r.nextLayer)t=new Zn(r.chunkPos,r.chunk,t,Math.max(r.maxPoint,t.maxPoint));return t}}Zn.empty=new Zn([],[],null,-1);function Zee(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let s=n[t];if(bk(e,s)>0)return n.slice().sort(bk);e=s}return n}Zn.empty.nextLayer=Zn.empty;class qo{finishChunk(e){this.chunks.push(new qC(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,s){this.addInner(e,t,s)||(this.nextLayer||(this.nextLayer=new qo)).add(e,t,s)}addInner(e,t,s){let r=e-this.lastTo||s.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||s.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=s,this.lastFrom=e,this.lastTo=t,this.value.push(s),s.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let s=t.value.length-1;return this.last=t.value[s],this.lastFrom=t.from[s]+e,this.lastTo=t.to[s]+e,!0}finish(){return this.finishInner(Zn.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Zn.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function BM(n,e,t){let s=new Map;for(let a of n)for(let i=0;i<a.chunk.length;i++)a.chunk[i].maxPoint<=0&&s.set(a.chunk[i],a.chunkPos[i]);let r=new Set;for(let a of e)for(let i=0;i<a.chunk.length;i++){let o=s.get(a.chunk[i]);o!=null&&(t?t.mapPos(o):o)==a.chunkPos[i]&&!(t!=null&&t.touchesRange(o,o+a.chunk[i].length))&&r.add(a.chunk[i])}return r}class RB{constructor(e,t,s,r=0){this.layer=e,this.skip=t,this.minPoint=s,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,s){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,s=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!s||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],s=e+t.from[this.rangeIndex];if(this.from=s,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Um{constructor(e){this.heap=e}static from(e,t=null,s=-1){let r=[];for(let a=0;a<e.length;a++)for(let i=e[a];!i.isEmpty;i=i.nextLayer)i.maxPoint>=s&&r.push(new RB(i,t,s,a));return r.length==1?r[0]:new Um(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let s of this.heap)s.goto(e,t);for(let s=this.heap.length>>1;s>=0;s--)yO(this.heap,s);return this.next(),this}forward(e,t){for(let s of this.heap)s.forward(e,t);for(let s=this.heap.length>>1;s>=0;s--)yO(this.heap,s);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),yO(this.heap,0)}}}function yO(n,e){for(let t=n[e];;){let s=(e<<1)+1;if(s>=n.length)break;let r=n[s];if(s+1<n.length&&r.compare(n[s+1])>=0&&(r=n[s+1],s++),t.compare(r)<0)break;n[s]=t,n[e]=r,e=s}}class Mp{constructor(e,t,s){this.minPoint=s,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Um.from(e,t,s)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){kg(this.active,e),kg(this.activeTo,e),kg(this.activeRank,e),this.minActive=$M(this.active,this.activeTo)}addActive(e){let t=0,{value:s,to:r,rank:a}=this.cursor;for(;t<this.activeRank.length&&(a-this.activeRank[t]||r-this.activeTo[t])>0;)t++;Sg(this.active,t,s),Sg(this.activeTo,t,r),Sg(this.activeRank,t,a),e&&Sg(e,t,this.cursor.from),this.minActive=$M(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let s=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),s&&kg(s,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let a=this.cursor.value;if(!a.point)this.addActive(s),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=a,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=a.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(s){this.openStart=0;for(let r=s.length-1;r>=0&&s[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let s=this.active.length-1;s>=0&&!(this.activeRank[s]<this.pointRank);s--)(this.activeTo[s]>e||this.activeTo[s]==e&&this.active[s].endSide>=this.point.endSide)&&t.push(this.active[s]);return t.reverse()}openEnd(e){let t=0;for(let s=this.activeTo.length-1;s>=0&&this.activeTo[s]>e;s--)t++;return t}}function FM(n,e,t,s,r,a){n.goto(e),t.goto(s);let i=s+r,o=s,l=s-e,c=!!a.boundChange;for(let u=!1;;){let h=n.to+l-t.to,d=h||n.endSide-t.endSide,m=d<0?n.to+l:t.to,y=Math.min(m,i);if(n.point||t.point?(n.point&&t.point&&zC(n.point,t.point)&&yk(n.activeForPoint(n.to),t.activeForPoint(t.to))||a.comparePoint(o,y,n.point,t.point),u=!1):(u&&a.boundChange(o),y>o&&!yk(n.active,t.active)&&a.compareRange(o,y,n.active,t.active),c&&y<i&&(h||n.openEnd(m)!=t.openEnd(m))&&(u=!0)),m>i)break;o=m,d<=0&&n.next(),d>=0&&t.next()}}function yk(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!zC(n[t],e[t]))return!1;return!0}function kg(n,e){for(let t=e,s=n.length-1;t<s;t++)n[t]=n[t+1];n.pop()}function Sg(n,e,t){for(let s=n.length-1;s>=e;s--)n[s+1]=n[s];n[e]=t}function $M(n,e){let t=-1,s=1e9;for(let r=0;r<e.length;r++)(e[r]-s||n[r].endSide-n[t].endSide)<0&&(t=r,s=e[r]);return t}function tp(n,e,t=n.length){let s=0;for(let r=0;r<t&&r<n.length;)n.charCodeAt(r)==9?(s+=e-s%e,r++):(s++,r=Rr(n,r));return s}function vk(n,e,t,s){for(let r=0,a=0;;){if(a>=e)return r;if(r==n.length)break;a+=n.charCodeAt(r)==9?t-a%t:1,r=Rr(n,r)}return s===!0?-1:n.length}const Ok="ͼ",NM=typeof Symbol>"u"?"__"+Ok:Symbol.for(Ok),wk=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),_M=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class lu{constructor(e,t){this.rules=[];let{finish:s}=t||{};function r(i){return/^@/.test(i)?[i]:i.split(/,\s*/)}function a(i,o,l,c){let u=[],h=/^@(\w+)\b/.exec(i[0]),d=h&&h[1]=="keyframes";if(h&&o==null)return l.push(i[0]+";");for(let m in o){let y=o[m];if(/&/.test(m))a(m.split(/,\s*/).map(O=>i.map(S=>O.replace(/&/,S))).reduce((O,S)=>O.concat(S)),y,l);else if(y&&typeof y=="object"){if(!h)throw new RangeError("The value of a property ("+m+") should be a primitive value.");a(r(m),y,u,d)}else y!=null&&u.push(m.replace(/_.*/,"").replace(/[A-Z]/g,O=>"-"+O.toLowerCase())+": "+y+";")}(u.length||d)&&l.push((s&&!h&&!c?i.map(s):i).join(", ")+" {"+u.join(" ")+"}")}for(let i in e)a(r(i),e[i],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=_M[NM]||1;return _M[NM]=e+1,Ok+e.toString(36)}static mount(e,t,s){let r=e[wk],a=s&&s.nonce;r?a&&r.setNonce(a):r=new zee(e,a),r.mount(Array.isArray(t)?t:[t],e)}}let RM=new Map;class zee{constructor(e,t){let s=e.ownerDocument||e,r=s.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let a=RM.get(s);if(a)return e[wk]=a;this.sheet=new r.CSSStyleSheet,RM.set(s,this)}else this.styleTag=s.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[wk]=this}mount(e,t){let s=this.sheet,r=0,a=0;for(let i=0;i<e.length;i++){let o=e[i],l=this.modules.indexOf(o);if(l<a&&l>-1&&(this.modules.splice(l,1),a--,l=-1),l==-1){if(this.modules.splice(a++,0,o),s)for(let c=0;c<o.rules.length;c++)s.insertRule(o.rules[c],r++)}else{for(;a<l;)r+=this.modules[a++].rules.length;r+=o.rules.length,a++}}if(s)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let i="";for(let l=0;l<this.modules.length;l++)i+=this.modules[l].getRules()+`
`;this.styleTag.textContent=i;let o=t.head||t;this.styleTag.parentNode!=o&&o.insertBefore(this.styleTag,o.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var cu={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Wm={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},qee=typeof navigator<"u"&&/Mac/.test(navigator.platform),Uee=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Zr=0;Zr<10;Zr++)cu[48+Zr]=cu[96+Zr]=String(Zr);for(var Zr=1;Zr<=24;Zr++)cu[Zr+111]="F"+Zr;for(var Zr=65;Zr<=90;Zr++)cu[Zr]=String.fromCharCode(Zr+32),Wm[Zr]=String.fromCharCode(Zr);for(var vO in cu)Wm.hasOwnProperty(vO)||(Wm[vO]=cu[vO]);function Wee(n){var e=qee&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Uee&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Wm:cu)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function bs(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var r=t[s];typeof r=="string"?n.setAttribute(s,r):r!=null&&(n[s]=r)}e++}for(;e<arguments.length;e++)IB(n,arguments[e]);return n}function IB(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)IB(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let ba=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},xk=typeof document<"u"?document:{documentElement:{style:{}}};const kk=/Edge\/(\d+)/.exec(ba.userAgent),LB=/MSIE \d/.test(ba.userAgent),Sk=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ba.userAgent),G1=!!(LB||Sk||kk),IM=!G1&&/gecko\/(\d+)/i.test(ba.userAgent),OO=!G1&&/Chrome\/(\d+)/.exec(ba.userAgent),Gee="webkitFontSmoothing"in xk.documentElement.style,Ck=!G1&&/Apple Computer/.test(ba.vendor),LM=Ck&&(/Mobile\/\w+/.test(ba.userAgent)||ba.maxTouchPoints>2);var Bt={mac:LM||/Mac/.test(ba.platform),windows:/Win/.test(ba.platform),linux:/Linux|X11/.test(ba.platform),ie:G1,ie_version:LB?xk.documentMode||6:Sk?+Sk[1]:kk?+kk[1]:0,gecko:IM,gecko_version:IM?+(/Firefox\/(\d+)/.exec(ba.userAgent)||[0,0])[1]:0,chrome:!!OO,chrome_version:OO?+OO[1]:0,ios:LM,android:/Android\b/.test(ba.userAgent),webkit_version:Gee?+(/\bAppleWebKit\/(\d+)/.exec(ba.userAgent)||[0,0])[1]:0,safari:Ck,safari_version:Ck?+(/\bVersion\/(\d+(\.\d+)?)/.exec(ba.userAgent)||[0,0])[1]:0,tabSize:xk.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function UC(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const Nb=Object.create(null);function WC(n,e,t){if(n==e)return!0;n||(n=Nb),e||(e=Nb);let s=Object.keys(n),r=Object.keys(e);if(s.length-0!=r.length-0)return!1;for(let a of s)if(a!=t&&(r.indexOf(a)==-1||n[a]!==e[a]))return!1;return!0}function Xee(n,e){for(let t=n.attributes.length-1;t>=0;t--){let s=n.attributes[t].name;e[s]==null&&n.removeAttribute(s)}for(let t in e){let s=e[t];t=="style"?n.style.cssText=s:n.getAttribute(t)!=s&&n.setAttribute(t,s)}}function QM(n,e,t){let s=!1;if(e)for(let r in e)t&&r in t||(s=!0,r=="style"?n.style.cssText="":n.removeAttribute(r));if(t)for(let r in t)e&&e[r]==t[r]||(s=!0,r=="style"?n.style.cssText=t[r]:n.setAttribute(r,t[r]));return s}function Hee(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let s=n.attributes[t];e[s.name]=s.value}return e}class ho{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,s){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Ur=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(Ur||(Ur={}));class At extends ou{constructor(e,t,s,r){super(),this.startSide=e,this.endSide=t,this.widget=s,this.spec=r}get heightRelevant(){return!1}static mark(e){return new Zf(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),s=!!e.block;return t+=s&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new mh(e,t,t,s,e.widget||null,!1)}static replace(e){let t=!!e.block,s,r;if(e.isBlockGap)s=-5e8,r=4e8;else{let{start:a,end:i}=QB(e,t);s=(a?t?-3e8:-1:5e8)-1,r=(i?t?2e8:1:-6e8)+1}return new mh(e,s,r,t,e.widget||null,!0)}static line(e){return new zf(e)}static set(e,t=!1){return Zn.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}At.none=Zn.empty;class Zf extends At{constructor(e){let{start:t,end:s}=QB(e);super(t?-1:5e8,s?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?UC(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||Nb}eq(e){return this==e||e instanceof Zf&&this.tagName==e.tagName&&WC(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Zf.prototype.point=!1;class zf extends At{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof zf&&this.spec.class==e.spec.class&&WC(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}zf.prototype.mapMode=pr.TrackBefore;zf.prototype.point=!0;class mh extends At{constructor(e,t,s,r,a,i){super(t,s,a,e),this.block=r,this.isReplace=i,this.mapMode=r?t<=0?pr.TrackBefore:pr.TrackAfter:pr.TrackDel}get type(){return this.startSide!=this.endSide?Ur.WidgetRange:this.startSide<=0?Ur.WidgetBefore:Ur.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof mh&&Yee(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}mh.prototype.point=!0;function QB(n,e=!1){let{inclusiveStart:t,inclusiveEnd:s}=n;return t==null&&(t=n.inclusive),s==null&&(s=n.inclusive),{start:t??e,end:s??e}}function Yee(n,e){return n==e||!!(n&&e&&n.compare(e))}function rd(n,e,t,s=0){let r=t.length-1;r>=0&&t[r]+s>=n?t[r]=Math.max(t[r],e):t.push(n,e)}class Gm extends ou{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof Gm&&this.tagName==e.tagName&&WC(this.attributes,e.attributes)}static create(e){return new Gm(e.tagName,e.attributes||Nb)}static set(e,t=!1){return Zn.of(e,t)}}Gm.prototype.startSide=Gm.prototype.endSide=-1;function Xm(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function Pk(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function Pm(n,e){if(!e.anchorNode)return!1;try{return Pk(n,e.anchorNode)}catch{return!1}}function G0(n){return n.nodeType==3?Hm(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function Am(n,e,t,s){return t?jM(n,e,t,s,-1)||jM(n,e,t,s,1):!1}function uu(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function _b(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function jM(n,e,t,s,r){for(;;){if(n==t&&e==s)return!0;if(e==(r<0?0:bc(n))){if(n.nodeName=="DIV")return!1;let a=n.parentNode;if(!a||a.nodeType!=1)return!1;e=uu(n)+(r<0?0:1),n=a}else if(n.nodeType==1){if(n=n.childNodes[e+(r<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=r<0?bc(n):0}else return!1}}function bc(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Rb(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function Kee(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function jB(n,e){let t=e.width/n.offsetWidth,s=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(s>.995&&s<1.005||!isFinite(s)||Math.abs(e.height-n.offsetHeight)<1)&&(s=1),{scaleX:t,scaleY:s}}function Jee(n,e,t,s,r,a,i,o){let l=n.ownerDocument,c=l.defaultView||window;for(let u=n,h=!1;u&&!h;)if(u.nodeType==1){let d,m=u==l.body,y=1,O=1;if(m)d=Kee(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(h=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let F=u.getBoundingClientRect();({scaleX:y,scaleY:O}=jB(u,F)),d={left:F.left,right:F.left+u.clientWidth*y,top:F.top,bottom:F.top+u.clientHeight*O}}let S=0,A=0;if(r=="nearest")e.top<d.top?(A=e.top-(d.top+i),t>0&&e.bottom>d.bottom+A&&(A=e.bottom-d.bottom+i)):e.bottom>d.bottom&&(A=e.bottom-d.bottom+i,t<0&&e.top-A<d.top&&(A=e.top-(d.top+i)));else{let F=e.bottom-e.top,j=d.bottom-d.top;A=(r=="center"&&F<=j?e.top+F/2-j/2:r=="start"||r=="center"&&t<0?e.top-i:e.bottom-j+i)-d.top}if(s=="nearest"?e.left<d.left?(S=e.left-(d.left+a),t>0&&e.right>d.right+S&&(S=e.right-d.right+a)):e.right>d.right&&(S=e.right-d.right+a,t<0&&e.left<d.left+S&&(S=e.left-(d.left+a))):S=(s=="center"?e.left+(e.right-e.left)/2-(d.right-d.left)/2:s=="start"==o?e.left-a:e.right-(d.right-d.left)+a)-d.left,S||A)if(m)c.scrollBy(S,A);else{let F=0,j=0;if(A){let N=u.scrollTop;u.scrollTop+=A/O,j=(u.scrollTop-N)*O}if(S){let N=u.scrollLeft;u.scrollLeft+=S/y,F=(u.scrollLeft-N)*y}e={left:e.left-F,top:e.top-j,right:e.right-F,bottom:e.bottom-j},F&&Math.abs(F-S)<1&&(s="nearest"),j&&Math.abs(j-A)<1&&(r="nearest")}if(m)break;(e.top<d.top||e.bottom>d.bottom||e.left<d.left||e.right>d.right)&&(e={left:Math.max(e.left,d.left),right:Math.min(e.right,d.right),top:Math.max(e.top,d.top),bottom:Math.min(e.bottom,d.bottom)}),u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function ete(n){let e=n.ownerDocument,t,s;for(let r=n.parentNode;r&&!(r==e.body||t&&s);)if(r.nodeType==1)!s&&r.scrollHeight>r.clientHeight&&(s=r),!t&&r.scrollWidth>r.clientWidth&&(t=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:t,y:s}}class tte{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:s}=e;this.set(t,Math.min(e.anchorOffset,t?bc(t):0),s,Math.min(e.focusOffset,s?bc(s):0))}set(e,t,s,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=s,this.focusOffset=r}}let Iu=null;Bt.safari&&Bt.safari_version>=26&&(Iu=!1);function VB(n){if(n.setActive)return n.setActive();if(Iu)return n.focus(Iu);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(Iu==null?{get preventScroll(){return Iu={preventScroll:!0},!0}}:void 0),!Iu){Iu=!1;for(let t=0;t<e.length;){let s=e[t++],r=e[t++],a=e[t++];s.scrollTop!=r&&(s.scrollTop=r),s.scrollLeft!=a&&(s.scrollLeft=a)}}}let VM;function Hm(n,e,t=e){let s=VM||(VM=document.createRange());return s.setEnd(n,t),s.setStart(n,e),s}function ad(n,e,t,s){let r={key:e,code:e,keyCode:t,which:t,cancelable:!0};s&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=s);let a=new KeyboardEvent("keydown",r);a.synthetic=!0,n.dispatchEvent(a);let i=new KeyboardEvent("keyup",r);return i.synthetic=!0,n.dispatchEvent(i),a.defaultPrevented||i.defaultPrevented}function nte(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function ste(n,e){let t=e.focusNode,s=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=s)return!1;for(s=Math.min(s,bc(t));;)if(s){if(t.nodeType!=1)return!1;let r=t.childNodes[s-1];r.contentEditable=="false"?s--:(t=r,s=bc(t))}else{if(t==n)return!0;s=uu(t),t=t.parentNode}}function ZB(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function zB(n,e){for(let t=n,s=e;;){if(t.nodeType==3&&s>0)return{node:t,offset:s};if(t.nodeType==1&&s>0){if(t.contentEditable=="false")return null;t=t.childNodes[s-1],s=bc(t)}else if(t.parentNode&&!_b(t))s=uu(t),t=t.parentNode;else return null}}function qB(n,e){for(let t=n,s=e;;){if(t.nodeType==3&&s<t.nodeValue.length)return{node:t,offset:s};if(t.nodeType==1&&s<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[s],s=0}else if(t.parentNode&&!_b(t))s=uu(t)+1,t=t.parentNode;else return null}}class Io{constructor(e,t,s=!0){this.node=e,this.offset=t,this.precise=s}static before(e,t){return new Io(e.parentNode,uu(e),t)}static after(e,t){return new Io(e.parentNode,uu(e)+1,t)}}var fs=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(fs||(fs={}));const fh=fs.LTR,GC=fs.RTL;function UB(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const rte=UB("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ate=UB("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Ak=Object.create(null),sl=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);Ak[e]=t,Ak[t]=-e}function WB(n){return n<=247?rte[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?ate[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const ite=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class xl{get dir(){return this.level%2?GC:fh}constructor(e,t,s){this.from=e,this.to=t,this.level=s}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,s,r){let a=-1;for(let i=0;i<e.length;i++){let o=e[i];if(o.from<=t&&o.to>=t){if(o.level==s)return i;(a<0||(r!=0?r<0?o.from<t:o.to>t:e[a].level>o.level))&&(a=i)}}if(a<0)throw new RangeError("Index out of range");return a}}function GB(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let s=n[t],r=e[t];if(s.from!=r.from||s.to!=r.to||s.direction!=r.direction||!GB(s.inner,r.inner))return!1}return!0}const Os=[];function ote(n,e,t,s,r){for(let a=0;a<=s.length;a++){let i=a?s[a-1].to:e,o=a<s.length?s[a].from:t,l=a?256:r;for(let c=i,u=l,h=l;c<o;c++){let d=WB(n.charCodeAt(c));d==512?d=u:d==8&&h==4&&(d=16),Os[c]=d==4?2:d,d&7&&(h=d),u=d}for(let c=i,u=l,h=l;c<o;c++){let d=Os[c];if(d==128)c<o-1&&u==Os[c+1]&&u&24?d=Os[c]=u:Os[c]=256;else if(d==64){let m=c+1;for(;m<o&&Os[m]==64;)m++;let y=c&&u==8||m<t&&Os[m]==8?h==1?1:8:256;for(let O=c;O<m;O++)Os[O]=y;c=m-1}else d==8&&h==1&&(Os[c]=1);u=d,d&7&&(h=d)}}}function lte(n,e,t,s,r){let a=r==1?2:1;for(let i=0,o=0,l=0;i<=s.length;i++){let c=i?s[i-1].to:e,u=i<s.length?s[i].from:t;for(let h=c,d,m,y;h<u;h++)if(m=Ak[d=n.charCodeAt(h)])if(m<0){for(let O=o-3;O>=0;O-=3)if(sl[O+1]==-m){let S=sl[O+2],A=S&2?r:S&4?S&1?a:r:0;A&&(Os[h]=Os[sl[O]]=A),o=O;break}}else{if(sl.length==189)break;sl[o++]=h,sl[o++]=d,sl[o++]=l}else if((y=Os[h])==2||y==1){let O=y==r;l=O?0:1;for(let S=o-3;S>=0;S-=3){let A=sl[S+2];if(A&2)break;if(O)sl[S+2]|=2;else{if(A&4)break;sl[S+2]|=4}}}}}function cte(n,e,t,s){for(let r=0,a=s;r<=t.length;r++){let i=r?t[r-1].to:n,o=r<t.length?t[r].from:e;for(let l=i;l<o;){let c=Os[l];if(c==256){let u=l+1;for(;;)if(u==o){if(r==t.length)break;u=t[r++].to,o=r<t.length?t[r].from:e}else if(Os[u]==256)u++;else break;let h=a==1,d=(u<e?Os[u]:s)==1,m=h==d?h?1:2:s;for(let y=u,O=r,S=O?t[O-1].to:n;y>l;)y==S&&(y=t[--O].from,S=O?t[O-1].to:n),Os[--y]=m;l=u}else a=c,l++}}}function Ek(n,e,t,s,r,a,i){let o=s%2?2:1;if(s%2==r%2)for(let l=e,c=0;l<t;){let u=!0,h=!1;if(c==a.length||l<a[c].from){let O=Os[l];O!=o&&(u=!1,h=O==16)}let d=!u&&o==1?[]:null,m=u?s:s+1,y=l;e:for(;;)if(c<a.length&&y==a[c].from){if(h)break e;let O=a[c];if(!u)for(let S=O.to,A=c+1;;){if(S==t)break e;if(A<a.length&&a[A].from==S)S=a[A++].to;else{if(Os[S]==o)break e;break}}if(c++,d)d.push(O);else{O.from>l&&i.push(new xl(l,O.from,m));let S=O.direction==fh!=!(m%2);Mk(n,S?s+1:s,r,O.inner,O.from,O.to,i),l=O.to}y=O.to}else{if(y==t||(u?Os[y]!=o:Os[y]==o))break;y++}d?Ek(n,l,y,s+1,r,d,i):l<y&&i.push(new xl(l,y,m)),l=y}else for(let l=t,c=a.length;l>e;){let u=!0,h=!1;if(!c||l>a[c-1].to){let O=Os[l-1];O!=o&&(u=!1,h=O==16)}let d=!u&&o==1?[]:null,m=u?s:s+1,y=l;e:for(;;)if(c&&y==a[c-1].to){if(h)break e;let O=a[--c];if(!u)for(let S=O.from,A=c;;){if(S==e)break e;if(A&&a[A-1].to==S)S=a[--A].from;else{if(Os[S-1]==o)break e;break}}if(d)d.push(O);else{O.to<l&&i.push(new xl(O.to,l,m));let S=O.direction==fh!=!(m%2);Mk(n,S?s+1:s,r,O.inner,O.from,O.to,i),l=O.from}y=O.from}else{if(y==e||(u?Os[y-1]!=o:Os[y-1]==o))break;y--}d?Ek(n,y,l,s+1,r,d,i):y<l&&i.push(new xl(y,l,m)),l=y}}function Mk(n,e,t,s,r,a,i){let o=e%2?2:1;ote(n,r,a,s,o),lte(n,r,a,s,o),cte(r,a,s,o),Ek(n,r,a,e,t,s,i)}function ute(n,e,t){if(!n)return[new xl(0,0,e==GC?1:0)];if(e==fh&&!t.length&&!ite.test(n))return XB(n.length);if(t.length)for(;n.length>Os.length;)Os[Os.length]=256;let s=[],r=e==fh?0:1;return Mk(n,r,r,t,0,n.length,s),s}function XB(n){return[new xl(0,n,0)]}let HB="";function hte(n,e,t,s,r){var a;let i=s.head-n.from,o=xl.find(e,i,(a=s.bidiLevel)!==null&&a!==void 0?a:-1,s.assoc),l=e[o],c=l.side(r,t);if(i==c){let d=o+=r?1:-1;if(d<0||d>=e.length)return null;l=e[o=d],i=l.side(!r,t),c=l.side(r,t)}let u=Rr(n.text,i,l.forward(r,t));(u<l.from||u>l.to)&&(u=c),HB=n.text.slice(Math.min(i,u),Math.max(i,u));let h=o==(r?e.length-1:0)?null:e[o+(r?1:-1)];return h&&u==c&&h.level+(r?0:1)<l.level?Le.cursor(h.side(!r,t)+n.from,h.forward(r,t)?1:-1,h.level):Le.cursor(u+n.from,l.forward(r,t)?-1:1,l.level)}function dte(n,e,t){for(let s=e;s<t;s++){let r=WB(n.charCodeAt(s));if(r==1)return fh;if(r==2||r==4)return GC}return fh}const YB=Dt.define(),KB=Dt.define(),JB=Dt.define(),eF=Dt.define(),Dk=Dt.define(),tF=Dt.define(),nF=Dt.define(),XC=Dt.define(),HC=Dt.define(),sF=Dt.define({combine:n=>n.some(e=>e)}),rF=Dt.define({combine:n=>n.some(e=>e)}),aF=Dt.define();class id{constructor(e,t="nearest",s="nearest",r=5,a=5,i=!1){this.range=e,this.y=t,this.x=s,this.yMargin=r,this.xMargin=a,this.isSnapshot=i}map(e){return e.empty?this:new id(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new id(Le.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Cg=rn.define({map:(n,e)=>n.map(e)}),iF=rn.define();function ei(n,e,t){let s=n.facet(eF);s.length?s[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const oc=Dt.define({combine:n=>n.length?n[0]:!0});let pte=0;const Wh=Dt.define({combine(n){return n.filter((e,t)=>{for(let s=0;s<t;s++)if(n[s].plugin==e.plugin)return!1;return!0})}});class Ns{constructor(e,t,s,r,a){this.id=e,this.create=t,this.domEventHandlers=s,this.domEventObservers=r,this.baseExtensions=a(this),this.extension=this.baseExtensions.concat(Wh.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Wh.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:s,eventObservers:r,provide:a,decorations:i}=t||{};return new Ns(pte++,e,s,r,o=>{let l=[];return i&&l.push(X1.of(c=>{let u=c.plugin(o);return u?i(u):At.none})),a&&l.push(a(o)),l})}static fromClass(e,t){return Ns.define((s,r)=>new e(s,r),t)}}class wO{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(s){if(ei(t.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){ei(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(s){ei(e.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const oF=Dt.define(),YC=Dt.define(),X1=Dt.define(),lF=Dt.define(),KC=Dt.define(),qf=Dt.define(),cF=Dt.define();function ZM(n,e){let t=n.state.facet(cF);if(!t.length)return t;let s=t.map(a=>a instanceof Function?a(n):a),r=[];return Zn.spans(s,e.from,e.to,{point(){},span(a,i,o,l){let c=a-e.from,u=i-e.from,h=r;for(let d=o.length-1;d>=0;d--,l--){let m=o[d].spec.bidiIsolate,y;if(m==null&&(m=dte(e.text,c,u)),l>0&&h.length&&(y=h[h.length-1]).to==c&&y.direction==m)y.to=u,h=y.inner;else{let O={from:c,to:u,direction:m,inner:[]};h.push(O),h=O.inner}}}}),r}const uF=Dt.define();function JC(n){let e=0,t=0,s=0,r=0;for(let a of n.state.facet(uF)){let i=a(n);i&&(i.left!=null&&(e=Math.max(e,i.left)),i.right!=null&&(t=Math.max(t,i.right)),i.top!=null&&(s=Math.max(s,i.top)),i.bottom!=null&&(r=Math.max(r,i.bottom)))}return{left:e,right:t,top:s,bottom:r}}const rm=Dt.define();class Ki{constructor(e,t,s,r){this.fromA=e,this.toA=t,this.fromB=s,this.toB=r}join(e){return new Ki(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,s=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>s.toA)){if(r.toA<s.fromA)break;s=s.join(r),e.splice(t-1,1)}}return e.splice(t,0,s),e}static extendWithRanges(e,t){if(t.length==0)return e;let s=[];for(let r=0,a=0,i=0;;){let o=r<e.length?e[r].fromB:1e9,l=a<t.length?t[a]:1e9,c=Math.min(o,l);if(c==1e9)break;let u=c+i,h=c,d=u;for(;;)if(a<t.length&&t[a]<=h){let m=t[a+1];a+=2,h=Math.max(h,m);for(let y=r;y<e.length&&e[y].fromB<=h;y++)i=e[y].toA-e[y].toB;d=Math.max(d,m+i)}else if(r<e.length&&e[r].fromB<=h){let m=e[r++];h=Math.max(h,m.toB),d=Math.max(d,m.toA),i=m.toA-m.toB}else break;s.push(new Ki(u,d,c,h))}return s}}class Ib{constructor(e,t,s){this.view=e,this.state=t,this.transactions=s,this.flags=0,this.startState=e.state,this.changes=xr.empty(this.startState.doc.length);for(let a of s)this.changes=this.changes.compose(a.changes);let r=[];this.changes.iterChangedRanges((a,i,o,l)=>r.push(new Ki(a,i,o,l))),this.changedRanges=r}static create(e,t,s){return new Ib(e,t,s)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const mte=[];class vr{constructor(e,t,s=0){this.dom=e,this.length=t,this.flags=s,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return mte}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let t=this.domAttrs;t&&Xee(this.dom,t)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let s=t;for(let r of this.children){if(r==e)return s;s+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let s=uu(this.dom),r=this.length?e>0:t>0;return new Io(this.parent.dom,s+(r?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof Y1)return e;return null}static get(e){return e.cmTile}}class H1 extends vr{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let t=this.dom,s=null,r,a=(e==null?void 0:e.node)==t?e:null,i=0;for(let o of this.children){if(o.sync(e),i+=o.length+o.breakAfter,r=s?s.nextSibling:t.firstChild,a&&r!=o.dom&&(a.written=!0),o.dom.parentNode==t)for(;r&&r!=o.dom;)r=zM(r);else t.insertBefore(o.dom,r);s=o.dom}for(r=s?s.nextSibling:t.firstChild,a&&r&&(a.written=!0);r;)r=zM(r);this.length=i}}function zM(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Y1 extends H1{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=vr.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],s=this,r=0,a=0;;)if(r==s.children.length){if(!t.length)return;s=s.parent,s.breakAfter&&a++,r=t.pop()}else{let i=s.children[r++];if(i instanceof pc)t.push(r),s=i,r=0;else{let o=a+i.length,l=e(i,a);if(l!==void 0)return l;a=o+i.breakAfter}}}resolveBlock(e,t){let s,r=-1,a,i=-1;if(this.blockTiles((o,l)=>{let c=l+o.length;if(e>=l&&e<=c){if(o.isWidget()&&t>=-1&&t<=1){if(o.flags&32)return!0;o.flags&16&&(s=void 0)}(l<e||e==c&&(t<-1?o.length:o.covers(1)))&&(!s||!o.isWidget()&&s.isWidget())&&(s=o,r=e-l),(c>e||e==l&&(t>1?o.length:o.covers(-1)))&&(!a||!o.isWidget()&&a.isWidget())&&(a=o,i=e-l)}}),!s&&!a)throw new Error("No tile at position "+e);return s&&t<0||!a?{tile:s,offset:r}:{tile:a,offset:i}}}class pc extends H1{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,t){let s=new pc(t||document.createElement(e.tagName),e);return t||(s.flags|=4),s}}class Ad extends H1{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,s){let r=new Ad(t||document.createElement("div"),e);return(!t||!s)&&(r.flags|=4),r}get domAttrs(){return this.attrs}resolveInline(e,t,s){let r=null,a=-1,i=null,o=-1;function l(u,h){for(let d=0,m=0;d<u.children.length&&m<=h;d++){let y=u.children[d],O=m+y.length;O>=h&&(y.isComposite()?l(y,h-m):(!i||i.isHidden&&(t>0||s&&gte(i,y)))&&(O>h||y.flags&32)?(i=y,o=h-m):(m<h||y.flags&16&&!y.isHidden)&&(r=y,a=h-m)),m=O}}l(this,e);let c=(t<0?r:i)||r||i;return c?{tile:c,offset:c==r?a:o}:null}coordsIn(e,t){let s=this.resolveInline(e,t,!0);return s?s.tile.coordsIn(Math.max(0,s.offset),t):fte(this)}domIn(e,t){let s=this.resolveInline(e,t);if(s){let{tile:r,offset:a}=s;if(this.dom.contains(r.dom))return r.isText()?new Io(r.dom,Math.min(r.dom.nodeValue.length,a)):r.domPosFor(a,r.flags&16?1:r.flags&32?-1:t);let i=s.tile.parent,o=!1;for(let l of i.children){if(o)return new Io(l.dom,0);l==s.tile&&(o=!0)}}return new Io(this.dom,0)}}function fte(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=G0(e);return t[t.length-1]||null}function gte(n,e){let t=n.coordsIn(0,1),s=e.coordsIn(0,1);return t&&s&&s.top<t.bottom}class Ja extends H1{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let s=new Ja(t||document.createElement(e.tagName),e);return t||(s.flags|=4),s}}class Hu extends vr{constructor(e,t){super(e,t.length),this.text=t}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let s=this.dom.nodeValue.length;e>s&&(e=s);let r=e,a=e,i=0;e==0&&t<0||e==s&&t>=0?Bt.chrome||Bt.gecko||(e?(r--,i=1):a<s&&(a++,i=-1)):t<0?r--:a<s&&a++;let o=Hm(this.dom,r,a).getClientRects();if(!o.length)return null;let l=o[(i?i<0:t>=0)?0:o.length-1];return Bt.safari&&!i&&l.width==0&&(l=Array.prototype.find.call(o,c=>c.width)||l),i?Rb(l,i<0):l||null}static of(e,t){let s=new Hu(t||document.createTextNode(e),e);return t||(s.flags|=2),s}}class gh extends vr{constructor(e,t,s,r){super(e,t,r),this.widget=s}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,s){let r=this.widget.coordsAt(this.dom,e,t);if(r)return r;if(s)return Rb(this.dom.getBoundingClientRect(),this.length?e==0:t<=0);{let a=this.dom.getClientRects(),i=null;if(!a.length)return null;let o=this.flags&16?!0:this.flags&32?!1:e>0;for(let l=o?a.length-1:0;i=a[l],!(e>0?l==0:l==a.length-1||i.top<i.bottom);l+=o?-1:1);return Rb(i,!o)}}get overrideDOMText(){if(!this.length)return us.empty;let{root:e}=this;if(!e)return us.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,s,r,a){return a||(a=e.toDOM(t),e.editable||(a.contentEditable="false")),new gh(a,s,e,r)}}class Lb extends vr{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return us.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class bte{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,s){let{tile:r,index:a,beforeBreak:i,parents:o}=this;for(;e||t>0;)if(r.isComposite())if(i){if(!e)break;s&&s.break(),e--,i=!1}else if(a==r.children.length){if(!e&&!o.length)break;s&&s.leave(r),i=!!r.breakAfter,{tile:r,index:a}=o.pop(),a++}else{let l=r.children[a],c=l.breakAfter;(t>0?l.length<=e:l.length<e)&&(!s||s.skip(l,0,l.length)!==!1||!l.isComposite)?(i=!!c,a++,e-=l.length):(o.push({tile:r,index:a}),r=l,a=0,s&&l.isComposite()&&s.enter(l))}else if(a==r.length)i=!!r.breakAfter,{tile:r,index:a}=o.pop(),a++;else if(e){let l=Math.min(e,r.length-a);s&&s.skip(r,a,a+l),e-=l,a+=l}else break;return this.tile=r,this.index=a,this.beforeBreak=i,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class yte{constructor(e,t,s,r){this.from=e,this.to=t,this.wrapper=s,this.rank=r}}class vte{constructor(e,t,s){this.cache=e,this.root=t,this.blockWrappers=s,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,s,r){var a;this.flushBuffer();let i=this.ensureMarks(t,s),o=i.lastChild;if(o&&o.isText()&&!(o.flags&8)&&o.length+e.length<512){this.cache.reused.set(o,2);let l=i.children[i.children.length-1]=new Hu(o.dom,o.text+e);l.parent=i}else i.append(r||Hu.of(e,(a=this.cache.find(Hu))===null||a===void 0?void 0:a.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let s=this.curLine;s.dom!=t.line.dom&&(s.setDOM(this.cache.reused.has(t.line)?xO(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let r=s;for(let o=t.marks.length-1;o>=0;o--){let l=t.marks[o],c=r.lastChild;if(c instanceof Ja&&c.mark.eq(l.mark))c.dom!=l.dom&&c.setDOM(xO(l.dom)),r=c;else{if(this.cache.reused.get(l)){let h=vr.get(l.dom);h&&h.setDOM(xO(l.dom))}let u=Ja.of(l.mark,l.dom);r.append(u),r=u}this.cache.reused.set(l,2)}let a=vr.get(e.text);a&&this.cache.reused.set(a,2);let i=new Hu(e.text,e.text.nodeValue);i.flags|=8,r.append(i)}addInlineWidget(e,t,s){let r=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);r||this.flushBuffer();let a=this.ensureMarks(t,s);!r&&!(e.flags&16)&&a.append(this.getBuffer(1)),a.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,s){this.flushBuffer(),this.ensureMarks(t,s).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var s;e||(e=hF);let r=Ad.start(e,t||((s=this.cache.find(Ad))===null||s===void 0?void 0:s.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=r)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var s;let r=this.curLine;for(let a=e.length-1;a>=0;a--){let i=e[a],o;if(t>0&&(o=r.lastChild)&&o instanceof Ja&&o.mark.eq(i))r=o,t--;else{let l=Ja.of(i,(s=this.cache.find(Ja,c=>c.mark.eq(i)))===null||s===void 0?void 0:s.dom);r.append(l),r=l,t=0}}return r}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!qM(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(Bt.ios&&qM(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(kO,0,32)||new gh(kO.toDOM(),0,kO,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new yte(e.from,e.to,e.value,e.rank),s=this.wrappers.length;for(;s>0&&(this.wrappers[s-1].rank-t.rank||this.wrappers[s-1].to-t.to)<0;)s--;this.wrappers.splice(s,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let s of this.wrappers){let r=t.lastChild;if(s.from<this.pos&&r instanceof pc&&r.wrapper.eq(s.wrapper))t=r;else{let a=pc.of(s.wrapper,(e=this.cache.find(pc,i=>i.wrapper.eq(s.wrapper)))===null||e===void 0?void 0:e.dom);t.append(a),t=a}}return t}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let t=2|(e<0?16:32),s=this.cache.find(Lb,void 0,1);return s&&(s.flags=t),s||new Lb(t)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class Ote{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:r,lineBreak:a,done:i}=this.cursor.next(this.skipCount);if(this.skipCount=0,i)throw new Error("Ran out of text content when drawing inline views");this.text=r;let o=this.textOff=Math.min(e,r.length);return a?null:r.slice(0,o)}let t=Math.min(this.text.length,this.textOff+e),s=this.text.slice(this.textOff,t);return this.textOff=t,s}}const Qb=[gh,Ad,Hu,Ja,Lb,pc,Y1];for(let n=0;n<Qb.length;n++)Qb[n].bucket=n;class wte{constructor(e){this.view=e,this.buckets=Qb.map(()=>[]),this.index=Qb.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,s=this.buckets[t];s.length<6?s.push(e):s[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,s=2){let r=e.bucket,a=this.buckets[r],i=this.index[r];for(let o=a.length-1;o>=0;o--){let l=(o+i)%a.length,c=a[l];if((!t||t(c))&&!this.reused.has(c))return a.splice(l,1),l<i&&this.index[r]--,this.reused.set(c,s),c}return null}findWidget(e,t,s){let r=this.buckets[0];if(r.length)for(let a=0,i=0;;a++){if(a==r.length){if(i)return null;i=1,a=0}let o=r[a];if(!this.reused.has(o)&&(i==0?o.widget.compare(e):o.widget.constructor==e.constructor&&e.updateDOM(o.dom,this.view)))return r.splice(a,1),a<this.index[0]&&this.index[0]--,o.widget==e&&o.length==t&&(o.flags&497)==s?(this.reused.set(o,1),o):(this.reused.set(o,2),new gh(o.dom,t,e,o.flags&-498|s))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class xte{constructor(e,t,s,r,a){this.view=e,this.decorations=r,this.disallowBlockEffectsFor=a,this.openWidget=!1,this.openMarks=0,this.cache=new wte(e),this.text=new Ote(e.state.doc),this.builder=new vte(this.cache,new Y1(e,e.contentDOM),Zn.iter(s)),this.cache.reused.set(t,2),this.old=new bte(t),this.reuseWalker={skip:(i,o,l)=>{if(this.cache.add(i),i.isComposite())return!1},enter:i=>this.cache.add(i),leave:()=>{},break:()=>{}}}run(e,t){let s=t&&this.getCompositionContext(t.text);for(let r=0,a=0,i=0;;){let o=i<e.length?e[i++]:null,l=o?o.fromA:this.old.root.length;if(l>r){let c=l-r;this.preserve(c,!i,!o),r=l,a+=c}if(!o)break;t&&o.fromA<=t.range.fromA&&o.toA>=t.range.toA?(this.forward(o.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(a,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,s),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,o.toA),this.emit(t.range.toB,o.toB)):(this.forward(o.fromA,o.toA),this.emit(a,o.toB)),a=o.toB,r=o.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,s){let r=Cte(this.old),a=this.openMarks;this.old.advance(e,s?1:-1,{skip:(i,o,l)=>{if(i.isWidget())if(this.openWidget)this.builder.continueWidget(l-o);else{let c=l>0||o<i.length?gh.of(i.widget,this.view,l-o,i.flags&496,this.cache.maybeReuse(i)):this.cache.reuse(i);c.flags&256?(c.flags&=-2,this.builder.addBlockWidget(c)):(this.builder.ensureLine(null),this.builder.addInlineWidget(c,r,a),a=r.length)}else if(i.isText())this.builder.ensureLine(null),!o&&l==i.length?this.builder.addText(i.text,r,a,this.cache.reuse(i)):(this.cache.add(i),this.builder.addText(i.text.slice(o,l),r,a)),a=r.length;else if(i.isLine())i.flags&=-2,this.cache.reused.set(i,1),this.builder.addLine(i);else if(i instanceof Lb)this.cache.add(i);else if(i instanceof Ja)this.builder.ensureLine(null),this.builder.addMark(i,r,a),this.cache.reused.set(i,1),a=r.length;else return!1;this.openWidget=!1},enter:i=>{i.isLine()?this.builder.addLineStart(i.attrs,this.cache.maybeReuse(i)):(this.cache.add(i),i instanceof Ja&&r.unshift(i.mark)),this.openWidget=!1},leave:i=>{i.isLine()?r.length&&(r.length=a=0):i instanceof Ja&&(r.shift(),a=Math.min(a,r.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let s=null,r=this.builder,a=0,i=Zn.spans(this.decorations,e,t,{point:(o,l,c,u,h,d)=>{if(c instanceof mh){if(this.disallowBlockEffectsFor[d]){if(c.block)throw new RangeError("Block decorations may not be specified via plugins");if(l>this.view.state.doc.lineAt(o).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(a=u.length,h>u.length)r.continueWidget(l-o);else{let m=c.widget||(c.block?Ed.block:Ed.inline),y=kte(c),O=this.cache.findWidget(m,l-o,y)||gh.of(m,this.view,l-o,y);c.block?(c.startSide>0&&r.addLineStartIfNotCovered(s),r.addBlockWidget(O)):(r.ensureLine(s),r.addInlineWidget(O,u,h))}s=null}else s=Ste(s,c);l>o&&this.text.skip(l-o)},span:(o,l,c,u)=>{for(let h=o;h<l;){let d=this.text.next(Math.min(512,l-h));d==null?(r.addLineStartIfNotCovered(s),r.addBreak(),h++):(r.ensureLine(s),r.addText(d,c,h==o?u:c.length),h+=d.length),s=null}}});r.addLineStartIfNotCovered(s),this.openWidget=i>a,this.openMarks=i}forward(e,t,s=1){t-e<=10?this.old.advance(t-e,s,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,s,this.reuseWalker))}getCompositionContext(e){let t=[],s=null;for(let r=e.parentNode;;r=r.parentNode){let a=vr.get(r);if(r==this.view.contentDOM)break;a instanceof Ja?t.push(a):a!=null&&a.isLine()?s=a:a instanceof pc||(r.nodeName=="DIV"&&!s&&r!=this.view.contentDOM?s=new Ad(r,hF):s||t.push(Ja.of(new Zf({tagName:r.nodeName.toLowerCase(),attributes:Hee(r)}),r)))}return{line:s,marks:t}}}function qM(n,e){let t=s=>{for(let r of s.children)if((e?r.isText():r.length)||t(r))return!0;return!1};return t(n)}function kte(n){let e=n.isReplace?(n.startSide<0?64:0)|(n.endSide>0?128:0):n.startSide>0?32:16;return n.block&&(e|=256),e}const hF={class:"cm-line"};function Ste(n,e){let t=e.spec.attributes,s=e.spec.class;return!t&&!s||(n||(n={class:"cm-line"}),t&&UC(t,n),s&&(n.class+=" "+s)),n}function Cte(n){let e=[];for(let t=n.parents.length;t>1;t--){let s=t==n.parents.length?n.tile:n.parents[t].tile;s instanceof Ja&&e.push(s.mark)}return e}function xO(n){let e=vr.get(n);return e&&e.setDOM(n.cloneNode()),n}class Ed extends ho{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Ed.inline=new Ed("span");Ed.block=new Ed("div");const kO=new class extends ho{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class UM{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=At.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new Y1(e,e.contentDOM),this.updateInner([new Ki(0,0,0,e.state.doc.length)],null)}update(e){var t;let s=e.changedRanges;this.minWidth>0&&s.length&&(s.every(({fromA:u,toA:h})=>h<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?r=this.domChanged.newSel.head:!$te(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let a=r>-1?Ate(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){let{from:u,to:h}=this.hasComposition;s=new Ki(u,h,e.changes.mapPos(u,-1),e.changes.mapPos(h,1)).addToSet(s.slice())}this.hasComposition=a?{from:a.range.fromB,to:a.range.toB}:null,(Bt.ie||Bt.chrome)&&!a&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,o=this.blockWrappers;this.updateDeco();let l=Dte(i,this.decorations,e.changes);l.length&&(s=Ki.extendWithRanges(s,l));let c=Bte(o,this.blockWrappers,e.changes);return c.length&&(s=Ki.extendWithRanges(s,c)),a&&!s.some(u=>u.fromA<=a.range.fromA&&u.toA>=a.range.toA)&&(s=a.range.addToSet(s.slice())),this.tile.flags&2&&s.length==0?!1:(this.updateInner(s,a),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:s}=this.view;s.ignore(()=>{if(t||e.length){let i=this.tile,o=new xte(this.view,i,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=o.run(e,t),Tk(i,o.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let a=Bt.chrome||Bt.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(a),a&&(a.written||s.selectionRange.focusNode!=a.node||!this.tile.dom.contains(a.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let a of this.tile.children)a.isWidget()&&a.widget instanceof SO&&r.push(a.dom);s.updateGaps(r)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let s of t.effects)s.is(iF)&&(this.editContextFormatting=s.value)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:s}=this.tile,r=this.view.root.activeElement,a=r==s,i=!a&&!(this.view.state.facet(oc)||s.tabIndex>-1)&&Pm(s,this.view.observer.selectionRange)&&!(r&&s.contains(r));if(!(a||t||i))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,c,u;if(l.empty?u=c=this.inlineDOMNearPos(l.anchor,l.assoc||1):(u=this.inlineDOMNearPos(l.head,l.head==l.from?1:-1),c=this.inlineDOMNearPos(l.anchor,l.anchor==l.from?1:-1)),Bt.gecko&&l.empty&&!this.hasComposition&&Pte(c)){let d=document.createTextNode("");this.view.observer.ignore(()=>c.node.insertBefore(d,c.node.childNodes[c.offset]||null)),c=u=new Io(d,0),o=!0}let h=this.view.observer.selectionRange;(o||!h.focusNode||(!Am(c.node,c.offset,h.anchorNode,h.anchorOffset)||!Am(u.node,u.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,l))&&(this.view.observer.ignore(()=>{Bt.android&&Bt.chrome&&s.contains(h.focusNode)&&Fte(h.focusNode,s)&&(s.blur(),s.focus({preventScroll:!0}));let d=Xm(this.view.root);if(d)if(l.empty){if(Bt.gecko){let m=Ete(c.node,c.offset);if(m&&m!=3){let y=(m==1?zB:qB)(c.node,c.offset);y&&(c=new Io(y.node,y.offset))}}d.collapse(c.node,c.offset),l.bidiLevel!=null&&d.caretBidiLevel!==void 0&&(d.caretBidiLevel=l.bidiLevel)}else if(d.extend){d.collapse(c.node,c.offset);try{d.extend(u.node,u.offset)}catch{}}else{let m=document.createRange();l.anchor>l.head&&([c,u]=[u,c]),m.setEnd(u.node,u.offset),m.setStart(c.node,c.offset),d.removeAllRanges(),d.addRange(m)}i&&this.view.root.activeElement==s&&(s.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(c,u)),this.impreciseAnchor=c.precise?null:new Io(h.anchorNode,h.anchorOffset),this.impreciseHead=u.precise?null:new Io(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Am(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,s=Xm(e.root),{anchorNode:r,anchorOffset:a}=e.observer.selectionRange;if(!s||!t.empty||!t.assoc||!s.modify)return;let i=this.lineAt(t.head,t.assoc);if(!i)return;let o=i.posAtStart;if(t.head==o||t.head==o+i.length)return;let l=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(t.head+t.assoc,t.assoc);s.collapse(u.node,u.offset),s.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&s.collapse(r,a)}posFromDOM(e,t){let s=this.tile.nearest(e);if(!s)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let r=s.posAtStart;if(s.isComposite()){let a;if(e==s.dom)a=s.dom.childNodes[t];else{let i=bc(e)==0?0:t==0?-1:1;for(;;){let o=e.parentNode;if(o==s.dom)break;i==0&&o.firstChild!=o.lastChild&&(e==o.firstChild?i=-1:i=1),e=o}i<0?a=e:a=e.nextSibling}if(a==s.dom.firstChild)return r;for(;a&&!vr.get(a);)a=a.nextSibling;if(!a)return r+s.length;for(let i=0,o=r;;i++){let l=s.children[i];if(l.dom==a)return o;o+=l.length+l.breakAfter}}else return s.isText()?e==s.dom?r+t:r+(t?s.length:0):r}domAtPos(e,t){let{tile:s,offset:r}=this.tile.resolveBlock(e,t);return s.isWidget()?s.domPosFor(e,t):s.domIn(r,t)}inlineDOMNearPos(e,t){let s,r=-1,a=!1,i,o=-1,l=!1;return this.tile.blockTiles((c,u)=>{if(c.isWidget()){if(c.flags&32&&u>=e)return!0;c.flags&16&&(a=!0)}else{let h=u+c.length;if(u<=e&&(s=c,r=e-u,a=h<e),h>=e&&!i&&(i=c,o=e-u,l=u>e),u>e&&i)return!0}}),!s&&!i?this.domAtPos(e,t):(a&&i?s=null:l&&s&&(i=null),s&&t<0||!i?s.domIn(r,t):i.domIn(o,t))}coordsAt(e,t){let{tile:s,offset:r}=this.tile.resolveBlock(e,t);return s.isWidget()?s.widget instanceof SO?null:s.coordsInWidget(r,t,!0):s.coordsIn(r,t)}lineAt(e,t){let{tile:s}=this.tile.resolveBlock(e,t);return s.isLine()?s:null}coordsForChar(e){let{tile:t,offset:s}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;function r(a,i){if(a.isComposite())for(let o of a.children){if(o.length>=i){let l=r(o,i);if(l)return l}if(i-=o.length,i<0)break}else if(a.isText()&&i<a.length){let o=Rr(a.text,i);if(o==i)return null;let l=Hm(a.dom,i,o).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(c==l.length-1||u.top<u.bottom&&u.left<u.right)return u}}return null}return r(t,s)}measureVisibleLineHeights(e){let t=[],{from:s,to:r}=e,a=this.view.contentDOM.clientWidth,i=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==fs.LTR,c=0,u=(h,d,m)=>{for(let y=0;y<h.children.length&&!(d>r);y++){let O=h.children[y],S=d+O.length,A=O.dom.getBoundingClientRect(),{height:F}=A;if(m&&!y&&(c+=A.top-m.top),O instanceof pc)S>s&&u(O,d,A);else if(d>=s&&(c>0&&t.push(-c),t.push(F+c),c=0,i)){let j=O.dom.lastChild,N=j?G0(j):[];if(N.length){let $=N[N.length-1],L=l?$.right-A.left:A.right-$.left;L>o&&(o=L,this.minWidth=a,this.minWidthFrom=d,this.minWidthTo=S)}}m&&y==h.children.length-1&&(c+=m.bottom-A.bottom),d=S+O.breakAfter}};return u(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return getComputedStyle(t.dom).direction=="rtl"?fs.RTL:fs.LTR}measureTextSize(){let e=this.tile.blockTiles(i=>{if(i.isLine()&&i.children.length&&i.length<=20){let o=0,l;for(let c of i.children){if(!c.isText()||/[^ -~]/.test(c.text))return;let u=G0(c.dom);if(u.length!=1)return;o+=u[0].width,l=u[0].height}if(o)return{lineHeight:i.dom.getBoundingClientRect().height,charWidth:o/i.length,textHeight:l}}});if(e)return e;let t=document.createElement("div"),s,r,a;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let i=G0(t.firstChild)[0];s=t.getBoundingClientRect().height,r=i&&i.width?i.width/27:7,a=i&&i.height?i.height:s,t.remove()}),{lineHeight:s,charWidth:r,textHeight:a}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let s=0,r=0;;r++){let a=r==t.viewports.length?null:t.viewports[r],i=a?a.from-1:this.view.state.doc.length;if(i>s){let o=(t.lineBlockAt(i).bottom-t.lineBlockAt(s).top)/this.view.scaleY;e.push(At.replace({widget:new SO(o),block:!0,inclusive:!0,isBlockGap:!0}).range(s,i))}if(!a)break;s=a.to+1}return At.set(e)}updateDeco(){let e=1,t=this.view.state.facet(X1).map(a=>(this.dynamicDecorationMap[e++]=typeof a=="function")?a(this.view):a),s=!1,r=this.view.state.facet(KC).map((a,i)=>{let o=typeof a=="function";return o&&(s=!0),o?a(this.view):a});for(r.length&&(this.dynamicDecorationMap[e++]=s,t.push(Zn.join(r))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(lF).map(a=>typeof a=="function"?a(this.view):a)}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(aF))try{if(c(this.view,e.range,e))return!0}catch(u){ei(this.view.state,u,"scroll handler")}let{range:t}=e,s=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!s)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(s={left:Math.min(s.left,r.left),top:Math.min(s.top,r.top),right:Math.max(s.right,r.right),bottom:Math.max(s.bottom,r.bottom)});let a=JC(this.view),i={left:s.left-a.left,top:s.top-a.top,right:s.right+a.right,bottom:s.bottom+a.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;if(Jee(this.view.scrollDOM,i,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==fs.LTR),window.visualViewport&&window.innerHeight-window.visualViewport.height>1&&(s.top>window.pageYOffset+window.visualViewport.offsetTop+window.visualViewport.height||s.bottom<window.pageYOffset+window.visualViewport.offsetTop)){let c=this.view.docView.lineAt(t.head,1);c&&c.dom.scrollIntoView({block:"nearest"})}}lineHasWidget(e){let t=s=>s.isWidget()||s.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){Tk(this.tile)}}function Tk(n,e){let t=e==null?void 0:e.get(n);if(t!=1){t==null&&n.destroy();for(let s of n.children)Tk(s,e)}}function Pte(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function dF(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let s=zB(t.focusNode,t.focusOffset),r=qB(t.focusNode,t.focusOffset),a=s||r;if(r&&s&&r.node!=s.node){let o=vr.get(r.node);if(!o||o.isText()&&o.text!=r.node.nodeValue)a=r;else if(n.docView.lastCompositionAfterCursor){let l=vr.get(s.node);!l||l.isText()&&l.text!=s.node.nodeValue||(a=r)}}if(n.docView.lastCompositionAfterCursor=a!=s,!a)return null;let i=e-a.offset;return{from:i,to:i+a.node.nodeValue.length,node:a.node}}function Ate(n,e,t){let s=dF(n,t);if(!s)return null;let{node:r,from:a,to:i}=s,o=r.nodeValue;if(/[\n\r]/.test(o)||n.state.doc.sliceString(s.from,s.to)!=o)return null;let l=e.invertedDesc;return{range:new Ki(l.mapPos(a),l.mapPos(i),a,i),text:r}}function Ete(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let Mte=class{constructor(){this.changes=[]}compareRange(e,t){rd(e,t,this.changes)}comparePoint(e,t){rd(e,t,this.changes)}boundChange(e){rd(e,e,this.changes)}};function Dte(n,e,t){let s=new Mte;return Zn.compare(n,e,t,s),s.changes}class Tte{constructor(){this.changes=[]}compareRange(e,t){rd(e,t,this.changes)}comparePoint(){}boundChange(e){rd(e,e,this.changes)}}function Bte(n,e,t){let s=new Tte;return Zn.compare(n,e,t,s),s.changes}function Fte(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function $te(n,e){let t=!1;return e&&n.iterChangedRanges((s,r)=>{s<e.to&&r>e.from&&(t=!0)}),t}class SO extends ho{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function Nte(n,e,t=1){let s=n.charCategorizer(e),r=n.doc.lineAt(e),a=e-r.from;if(r.length==0)return Le.cursor(e);a==0?t=1:a==r.length&&(t=-1);let i=a,o=a;t<0?i=Rr(r.text,a,!1):o=Rr(r.text,a);let l=s(r.text.slice(i,o));for(;i>0;){let c=Rr(r.text,i,!1);if(s(r.text.slice(c,i))!=l)break;i=c}for(;o<r.length;){let c=Rr(r.text,o);if(s(r.text.slice(o,c))!=l)break;o=c}return Le.range(i+r.from,o+r.from)}function _te(n,e,t,s,r){let a=Math.round((s-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let o=n.viewState.heightOracle.textHeight,l=Math.floor((r-t.top-(n.defaultLineHeight-o)*.5)/o);a+=l*n.viewState.heightOracle.lineLength}let i=n.state.sliceDoc(t.from,t.to);return t.from+vk(i,a,n.state.tabSize)}function Bk(n,e,t){let s=n.lineBlockAt(e);if(Array.isArray(s.type)){let r;for(let a of s.type){if(a.from>e)break;if(!(a.to<e)){if(a.from<e&&a.to>e)return a;(!r||a.type==Ur.Text&&(r.type!=a.type||(t<0?a.from<e:a.to>e)))&&(r=a)}}return r||s}return s}function Rte(n,e,t,s){let r=Bk(n,e.head,e.assoc||-1),a=!s||r.type!=Ur.Text||!(n.lineWrapping||r.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(a){let i=n.dom.getBoundingClientRect(),o=n.textDirectionAt(r.from),l=n.posAtCoords({x:t==(o==fs.LTR)?i.right-1:i.left+1,y:(a.top+a.bottom)/2});if(l!=null)return Le.cursor(l,t?-1:1)}return Le.cursor(t?r.to:r.from,t?-1:1)}function WM(n,e,t,s){let r=n.state.doc.lineAt(e.head),a=n.bidiSpans(r),i=n.textDirectionAt(r.from);for(let o=e,l=null;;){let c=hte(r,a,i,o,t),u=HB;if(!c){if(r.number==(t?n.state.doc.lines:1))return o;u=`
`,r=n.state.doc.line(r.number+(t?1:-1)),a=n.bidiSpans(r),c=n.visualLineSide(r,!t)}if(l){if(!l(u))return o}else{if(!s)return c;l=s(u)}o=c}}function Ite(n,e,t){let s=n.state.charCategorizer(e),r=s(t);return a=>{let i=s(a);return r==zs.Space&&(r=i),r==i}}function Lte(n,e,t,s){let r=e.head,a=t?1:-1;if(r==(t?n.state.doc.length:0))return Le.cursor(r,e.assoc);let i=e.goalColumn,o,l=n.contentDOM.getBoundingClientRect(),c=n.coordsAtPos(r,(e.empty?e.assoc:0)||(t?1:-1)),u=n.documentTop;if(c)i==null&&(i=c.left-l.left),o=a<0?c.top:c.bottom;else{let y=n.viewState.lineBlockAt(r);i==null&&(i=Math.min(l.right-l.left,n.defaultCharacterWidth*(r-y.from))),o=(a<0?y.top:y.bottom)+u}let h=l.left+i,d=s??n.viewState.heightOracle.textHeight>>1,m=Fk(n,{x:h,y:o+d*a},!1,a);return Le.cursor(m.pos,m.assoc,void 0,i)}function Em(n,e,t){for(;;){let s=0;for(let r of n)r.between(e-1,e+1,(a,i,o)=>{if(e>a&&e<i){let l=s||t||(e-a<i-e?-1:1);e=l<0?a:i,s=l}});if(!s)return e}}function pF(n,e){let t=null;for(let s=0;s<e.ranges.length;s++){let r=e.ranges[s],a=null;if(r.empty){let i=Em(n,r.from,0);i!=r.from&&(a=Le.cursor(i,-1))}else{let i=Em(n,r.from,-1),o=Em(n,r.to,1);(i!=r.from||o!=r.to)&&(a=Le.range(r.from==r.anchor?i:o,r.from==r.head?i:o))}a&&(t||(t=e.ranges.slice()),t[s]=a)}return t?Le.create(t,e.mainIndex):e}function CO(n,e,t){let s=Em(n.state.facet(qf).map(r=>r(n)),t.from,e.head>t.from?-1:1);return s==t.from?t:Le.cursor(s,s<t.from?1:-1)}class gl{constructor(e,t){this.pos=e,this.assoc=t}}function Fk(n,e,t,s){let r=n.contentDOM.getBoundingClientRect(),a=r.top+n.viewState.paddingTop,{x:i,y:o}=e,l=o-a,c;for(;;){if(l<0)return new gl(0,1);if(l>n.viewState.docHeight)return new gl(n.state.doc.length,-1);if(c=n.elementAtHeight(l),s==null)break;if(c.type==Ur.Text){if(s<0?c.to<n.viewport.from:c.from>n.viewport.to)break;let d=n.docView.coordsAt(s<0?c.from:c.to,s>0?-1:1);if(d&&(s<0?d.top<=l+a:d.bottom>=l+a))break}let h=n.viewState.heightOracle.textHeight/2;l=s>0?c.bottom+h:c.top-h}if(n.viewport.from>=c.to||n.viewport.to<=c.from){if(t)return null;if(c.type==Ur.Text){let h=_te(n,r,c,i,o);return new gl(h,h==c.from?1:-1)}}if(c.type!=Ur.Text)return l<(c.top+c.bottom)/2?new gl(c.from,1):new gl(c.to,-1);let u=n.docView.lineAt(c.from,2);return(!u||u.length!=c.length)&&(u=n.docView.lineAt(c.from,-2)),new Qte(n,i,o,n.textDirectionAt(c.from)).scanTile(u,c.from)}class Qte{constructor(e,t,s,r){this.view=e,this.x=t,this.y=s,this.baseDir=r,this.line=null,this.spans=null}bidiSpansAt(e){return(!this.line||this.line.from>e||this.line.to<e)&&(this.line=this.view.state.doc.lineAt(e),this.spans=this.view.bidiSpans(this.line)),this}baseDirAt(e,t){let{line:s,spans:r}=this.bidiSpansAt(e);return r[xl.find(r,e-s.from,-1,t)].level==this.baseDir}dirAt(e,t){let{line:s,spans:r}=this.bidiSpansAt(e);return r[xl.find(r,e-s.from,-1,t)].dir}bidiIn(e,t){let{spans:s,line:r}=this.bidiSpansAt(e);return s.length>1||s.length&&(s[0].level!=this.baseDir||s[0].to+r.from<t)}scan(e,t){let s=0,r=e.length-1,a=new Set,i=this.bidiIn(e[0],e[r]),o,l,c=-1,u=1e9,h;e:for(;s<r;){let m=r-s,y=s+r>>1;t:if(a.has(y)){let S=s+Math.floor(Math.random()*m);for(let A=0;A<m;A++){if(!a.has(S)){y=S;break t}S++,S==r&&(S=s)}break e}a.add(y);let O=t(y);if(O)for(let S=0;S<O.length;S++){let A=O[S],F=0;if(A.bottom<this.y)(!o||o.bottom<A.bottom)&&(o=A),F=1;else if(A.top>this.y)(!l||l.top>A.top)&&(l=A),F=-1;else{let j=A.left>this.x?this.x-A.left:A.right<this.x?this.x-A.right:0,N=Math.abs(j);N<u&&(c=y,u=N,h=A),j&&(F=j<0==(this.baseDir==fs.LTR)?-1:1)}F==-1&&(!i||this.baseDirAt(e[y],1))?r=y:F==1&&(!i||this.baseDirAt(e[y+1],-1))&&(s=y+1)}}if(!h){let m=o&&(!l||this.y-o.bottom<l.top-this.y)?o:l;return this.y=(m.top+m.bottom)/2,this.scan(e,t)}let d=(i?this.dirAt(e[c],1):this.baseDir)==fs.LTR;return{i:c,after:this.x>(h.left+h.right)/2==d}}scanText(e,t){let s=[];for(let a=0;a<e.length;a=Rr(e.text,a))s.push(t+a);s.push(t+e.length);let r=this.scan(s,a=>{let i=s[a]-t,o=s[a+1]-t;return Hm(e.dom,i,o).getClientRects()});return r.after?new gl(s[r.i+1],-1):new gl(s[r.i],1)}scanTile(e,t){if(!e.length)return new gl(t,1);if(e.children.length==1){let o=e.children[0];if(o.isText())return this.scanText(o,t);if(o.isComposite())return this.scanTile(o,t)}let s=[t];for(let o=0,l=t;o<e.children.length;o++)s.push(l+=e.children[o].length);let r=this.scan(s,o=>{let l=e.children[o];return l.flags&48?null:(l.dom.nodeType==1?l.dom:Hm(l.dom,0,l.length)).getClientRects()}),a=e.children[r.i],i=s[r.i];return a.isText()?this.scanText(a,i):a.isComposite()?this.scanTile(a,i):r.after?new gl(s[r.i+1],-1):new gl(i,1)}}const am="￿";class jte{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(ls.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=am}readRange(e,t){if(!e)return this;let s=e.parentNode;for(let r=e;;){this.findPointBefore(s,r);let a=this.text.length;this.readNode(r);let i=vr.get(r),o=r.nextSibling;if(o==t){i!=null&&i.breakAfter&&!o&&s!=this.view.contentDOM&&this.lineBreak();break}let l=vr.get(o);(i&&l?i.breakAfter:(i?i.breakAfter:_b(r))||_b(o)&&(r.nodeName!="BR"||i!=null&&i.isWidget())&&this.text.length>a)&&!Zte(o,t)&&this.lineBreak(),r=o}return this.findPointBefore(s,t),this}readTextNode(e){let t=e.nodeValue;for(let s of this.points)s.node==e&&(s.pos=this.text.length+Math.min(s.offset,t.length));for(let s=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let a=-1,i=1,o;if(this.lineSeparator?(a=t.indexOf(this.lineSeparator,s),i=this.lineSeparator.length):(o=r.exec(t))&&(a=o.index,i=o[0].length),this.append(t.slice(s,a<0?t.length:a)),a<0)break;if(this.lineBreak(),i>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=i-1);s=a+i}}readNode(e){let t=vr.get(e),s=t&&t.overrideDOMText;if(s!=null){this.findPointInside(e,s.length);for(let r=s.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let s of this.points)s.node==e&&e.childNodes[s.offset]==t&&(s.pos=this.text.length)}findPointInside(e,t){for(let s of this.points)(e.nodeType==3?s.node==e:e.contains(s.node))&&(s.pos=this.text.length+(Vte(e,s.node,s.offset)?t:0))}}function Vte(n,e,t){for(;;){if(!e||t<bc(e))return!1;if(e==n)return!0;t=uu(e)+1,e=e.parentNode}}function Zte(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let s=vr.get(n);if(!(s!=null&&s.isWidget()))return!1;s&&(t||(t=[])).push(s)}if(t)for(let s of t){let r=s.overrideDOMText;if(r!=null&&r.length)return!1}return!0}class GM{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class zte{constructor(e,t,s,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:a,impreciseAnchor:i}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=mF(e.docView.tile,t,s,0))){let o=a||i?[]:Ute(e),l=new jte(o,e);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=Wte(o,this.bounds.from)}else{let o=e.observer.selectionRange,l=a&&a.node==o.focusNode&&a.offset==o.focusOffset||!Pk(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),c=i&&i.node==o.anchorNode&&i.offset==o.anchorOffset||!Pk(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),u=e.viewport;if((Bt.ios||Bt.chrome)&&e.state.selection.main.empty&&l!=c&&(u.from>0||u.to<e.state.doc.length)){let h=Math.min(l,c),d=Math.max(l,c),m=u.from-h,y=u.to-d;(m==0||m==1||h==0)&&(y==0||y==-1||d==e.state.doc.length)&&(l=0,c=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(Le.range(c,l)):this.newSel=Le.single(c,l)}}}function mF(n,e,t,s){if(n.isComposite()){let r=-1,a=-1,i=-1,o=-1;for(let l=0,c=s,u=s;l<n.children.length;l++){let h=n.children[l],d=c+h.length;if(c<e&&d>t)return mF(h,e,t,c);if(d>=e&&r==-1&&(r=l,a=c),c>t&&h.dom.parentNode==n.dom){i=l,o=u;break}u=d,c=d+h.breakAfter}return{from:a,to:o<0?s+n.length:o,startDOM:(r?n.children[r-1].dom.nextSibling:null)||n.dom.firstChild,endDOM:i<n.children.length&&i>=0?n.children[i].dom:null}}else return n.isText()?{from:s,to:s+n.length,startDOM:n.dom,endDOM:n.dom.nextSibling}:null}function fF(n,e){let t,{newSel:s}=e,r=n.state.selection.main,a=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:i,to:o}=e.bounds,l=r.from,c=null;(a===8||Bt.android&&e.text.length<o-i)&&(l=r.to,c="end");let u=gF(n.state.doc.sliceString(i,o,am),e.text,l-i,c);u&&(Bt.chrome&&a==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==am+am&&u.toB--,t={from:i+u.from,to:i+u.toA,insert:us.of(e.text.slice(u.from,u.toB).split(am))})}else s&&(!n.hasFocus&&n.state.facet(oc)||jb(s,r))&&(s=null);if(!t&&!s)return!1;if(!t&&e.typeOver&&!r.empty&&s&&s.main.empty?t={from:r.from,to:r.to,insert:n.state.doc.slice(r.from,r.to)}:(Bt.mac||Bt.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(s&&t.insert.length==2&&(s=Le.single(s.main.anchor-1,s.main.head-1)),t={from:t.from,to:t.to,insert:us.of([t.insert.toString().replace("."," ")])}):t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:n.state.doc.slice(r.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,r.to))}:n.state.doc.lineAt(r.from).to<r.to&&n.docView.lineHasWidget(r.to)&&n.inputState.insertingTextAt>Date.now()-50?t={from:r.from,to:r.to,insert:n.state.toText(n.inputState.insertingText)}:Bt.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(s&&(s=Le.single(s.main.anchor-1,s.main.head-1)),t={from:r.from,to:r.to,insert:us.of([" "])}),t)return eP(n,t,s,a);if(s&&!jb(s,r)){let i=!1,o="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(i=!0),o=n.inputState.lastSelectionOrigin,o=="select.pointer"&&(s=pF(n.state.facet(qf).map(l=>l(n)),s))),n.dispatch({selection:s,scrollIntoView:i,userEvent:o}),!0}else return!1}function eP(n,e,t,s=-1){if(Bt.ios&&n.inputState.flushIOSKey(e))return!0;let r=n.state.selection.main;if(Bt.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&n.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&ad(n.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||s==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&ad(n.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&ad(n.contentDOM,"Delete",46)))return!0;let a=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let i,o=()=>i||(i=qte(n,e,t));return n.state.facet(tF).some(l=>l(n,e.from,e.to,a,o))||n.dispatch(o()),!0}function qte(n,e,t){let s,r=n.state,a=r.selection.main,i=-1;if(e.from==e.to&&e.from<a.from||e.from>a.to){let l=e.from<a.from?-1:1,c=l<0?a.from:a.to,u=Em(r.facet(qf).map(h=>h(n)),c,l);e.from==u&&(i=u)}if(i>-1)s={changes:e,selection:Le.cursor(e.from+e.insert.length,-1)};else if(e.from>=a.from&&e.to<=a.to&&e.to-e.from>=(a.to-a.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let l=a.from<e.from?r.sliceDoc(a.from,e.from):"",c=a.to>e.to?r.sliceDoc(e.to,a.to):"";s=r.replaceSelection(n.state.toText(l+e.insert.sliceString(0,void 0,n.state.lineBreak)+c))}else{let l=r.changes(e),c=t&&t.main.to<=l.newLength?t.main:void 0;if(r.selection.ranges.length>1&&(n.inputState.composing>=0||n.inputState.compositionPendingChange)&&e.to<=a.to+10&&e.to>=a.to-10){let u=n.state.sliceDoc(e.from,e.to),h,d=t&&dF(n,t.main.head);if(d){let y=e.insert.length-(e.to-e.from);h={from:d.from,to:d.to-y}}else h=n.state.doc.lineAt(a.head);let m=a.to-e.to;s=r.changeByRange(y=>{if(y.from==a.from&&y.to==a.to)return{changes:l,range:c||y.map(l)};let O=y.to-m,S=O-u.length;if(n.state.sliceDoc(S,O)!=u||O>=h.from&&S<=h.to)return{range:y};let A=r.changes({from:S,to:O,insert:e.insert}),F=y.to-a.to;return{changes:A,range:c?Le.range(Math.max(0,c.anchor+F),Math.max(0,c.head+F)):y.map(A)}})}else s={changes:l,selection:c&&r.selection.replaceRange(c)}}let o="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,o+=".compose",n.inputState.compositionFirstChange&&(o+=".start",n.inputState.compositionFirstChange=!1)),r.update(s,{userEvent:o,scrollIntoView:!0})}function gF(n,e,t,s){let r=Math.min(n.length,e.length),a=0;for(;a<r&&n.charCodeAt(a)==e.charCodeAt(a);)a++;if(a==r&&n.length==e.length)return null;let i=n.length,o=e.length;for(;i>0&&o>0&&n.charCodeAt(i-1)==e.charCodeAt(o-1);)i--,o--;if(s=="end"){let l=Math.max(0,a-Math.min(i,o));t-=i+l-a}if(i<a&&n.length<e.length){let l=t<=a&&t>=i?a-t:0;a-=l,o=a+(o-i),i=a}else if(o<a){let l=t<=a&&t>=o?a-t:0;a-=l,i=a+(i-o),o=a}return{from:a,toA:i,toB:o}}function Ute(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:s,focusNode:r,focusOffset:a}=n.observer.selectionRange;return t&&(e.push(new GM(t,s)),(r!=t||a!=s)&&e.push(new GM(r,a))),e}function Wte(n,e){if(n.length==0)return null;let t=n[0].pos,s=n.length==2?n[1].pos:t;return t>-1&&s>-1?Le.single(t+e,s+e):null}function jb(n,e){return e.head==n.main.head&&e.anchor==n.main.anchor}class Gte{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Bt.safari&&e.contentDOM.addEventListener("input",()=>null),Bt.gecko&&cne(e.contentDOM.ownerDocument)}handleEvent(e){!nne(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let s=this.handlers[e];if(s){for(let r of s.observers)r(this.view,t);for(let r of s.handlers){if(t.defaultPrevented)break;if(r(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=Xte(e),s=this.handlers,r=this.view.contentDOM;for(let a in t)if(a!="scroll"){let i=!t[a].handlers.length,o=s[a];o&&i!=!o.handlers.length&&(r.removeEventListener(a,this.handleEvent),o=null),o||r.addEventListener(a,this.handleEvent,{passive:i})}for(let a in s)a!="scroll"&&!t[a]&&r.removeEventListener(a,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&yF.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Bt.android&&Bt.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return Bt.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=bF.find(s=>s.keyCode==e.keyCode))&&!e.ctrlKey||Hte.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,ad(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:Bt.safari&&!Bt.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function XM(n,e){return(t,s)=>{try{return e.call(n,s,t)}catch(r){ei(t.state,r)}}}function Xte(n){let e=Object.create(null);function t(s){return e[s]||(e[s]={observers:[],handlers:[]})}for(let s of n){let r=s.spec,a=r&&r.plugin.domEventHandlers,i=r&&r.plugin.domEventObservers;if(a)for(let o in a){let l=a[o];l&&t(o).handlers.push(XM(s.value,l))}if(i)for(let o in i){let l=i[o];l&&t(o).observers.push(XM(s.value,l))}}for(let s in Uo)t(s).handlers.push(Uo[s]);for(let s in lo)t(s).observers.push(lo[s]);return e}const bF=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Hte="dthko",yF=[16,17,18,20,91,92,224,225],Pg=6;function Ag(n){return Math.max(0,n)*.7+8}function Yte(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class Kte{constructor(e,t,s,r){this.view=e,this.startEvent=t,this.style=s,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=ete(e.contentDOM),this.atoms=e.state.facet(qf).map(i=>i(e));let a=e.contentDOM.ownerDocument;a.addEventListener("mousemove",this.move=this.move.bind(this)),a.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ls.allowMultipleSelections)&&Jte(e,t),this.dragging=tne(e,t)&&wF(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Yte(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,s=0,r=0,a=0,i=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:i}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:a,bottom:o}=this.scrollParents.y.getBoundingClientRect());let l=JC(this.view);e.clientX-l.left<=r+Pg?t=-Ag(r-e.clientX):e.clientX+l.right>=i-Pg&&(t=Ag(e.clientX-i)),e.clientY-l.top<=a+Pg?s=-Ag(a-e.clientY):e.clientY+l.bottom>=o-Pg&&(s=Ag(e.clientY-o)),this.setScrollSpeed(t,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,s=pF(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!s.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:s,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Jte(n,e){let t=n.state.facet(YB);return t.length?t[0](e):Bt.mac?e.metaKey:e.ctrlKey}function ene(n,e){let t=n.state.facet(KB);return t.length?t[0](e):Bt.mac?!e.altKey:!e.ctrlKey}function tne(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let s=Xm(n.root);if(!s||s.rangeCount==0)return!0;let r=s.getRangeAt(0).getClientRects();for(let a=0;a<r.length;a++){let i=r[a];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}function nne(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,s;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(s=vr.get(t))&&s.isWidget()&&!s.isHidden&&s.widget.ignoreEvent(e))return!1;return!0}const Uo=Object.create(null),lo=Object.create(null),vF=Bt.ie&&Bt.ie_version<15||Bt.ios&&Bt.webkit_version<604;function sne(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),OF(n,t.value)},50)}function K1(n,e,t){for(let s of n.facet(e))t=s(t,n);return t}function OF(n,e){e=K1(n.state,XC,e);let{state:t}=n,s,r=1,a=t.toText(e),i=a.lines==t.selection.ranges.length;if($k!=null&&t.selection.ranges.every(l=>l.empty)&&$k==a.toString()){let l=-1;s=t.changeByRange(c=>{let u=t.doc.lineAt(c.from);if(u.from==l)return{range:c};l=u.from;let h=t.toText((i?a.line(r++).text:e)+t.lineBreak);return{changes:{from:u.from,insert:h},range:Le.cursor(c.from+h.length)}})}else i?s=t.changeByRange(l=>{let c=a.line(r++);return{changes:{from:l.from,to:l.to,insert:c.text},range:Le.cursor(l.from+c.length)}}):s=t.replaceSelection(a);n.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}lo.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Uo.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);lo.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};lo.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Uo.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let s of n.state.facet(JB))if(t=s(n,e),t)break;if(!t&&e.button==0&&(t=ane(n,e)),t){let s=!n.hasFocus;n.inputState.startMouseSelection(new Kte(n,e,t,s)),s&&n.observer.ignore(()=>{VB(n.contentDOM);let a=n.root.activeElement;a&&!a.contains(n.contentDOM)&&a.blur()});let r=n.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function HM(n,e,t,s){if(s==1)return Le.cursor(e,t);if(s==2)return Nte(n.state,e,t);{let r=n.docView.lineAt(e,t),a=n.state.doc.lineAt(r?r.posAtEnd:e),i=r?r.posAtStart:a.from,o=r?r.posAtEnd:a.to;return o<n.state.doc.length&&o==a.to&&o++,Le.range(i,o)}}const rne=Bt.ie&&Bt.ie_version<=11;let YM=null,KM=0,JM=0;function wF(n){if(!rne)return n.detail;let e=YM,t=JM;return YM=n,JM=Date.now(),KM=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(KM+1)%3:1}function ane(n,e){let t=n.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),s=wF(e),r=n.state.selection;return{update(a){a.docChanged&&(t.pos=a.changes.mapPos(t.pos),r=r.map(a.changes))},get(a,i,o){let l=n.posAndSideAtCoords({x:a.clientX,y:a.clientY},!1),c,u=HM(n,l.pos,l.assoc,s);if(t.pos!=l.pos&&!i){let h=HM(n,t.pos,t.assoc,s),d=Math.min(h.from,u.from),m=Math.max(h.to,u.to);u=d<u.from?Le.range(d,m):Le.range(m,d)}return i?r.replaceRange(r.main.extend(u.from,u.to)):o&&s==1&&r.ranges.length>1&&(c=ine(r,l.pos))?c:o?r.addRange(u):Le.create([u])}}}function ine(n,e){for(let t=0;t<n.ranges.length;t++){let{from:s,to:r}=n.ranges[t];if(s<=e&&r>=e)return Le.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}Uo.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let r=n.docView.tile.nearest(e.target);if(r&&r.isWidget()){let a=r.posAtStart,i=a+r.length;(a>=t.to||i<=t.from)&&(t=Le.range(a,i))}}let{inputState:s}=n;return s.mouseSelection&&(s.mouseSelection.dragging=!0),s.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",K1(n.state,HC,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Uo.dragend=n=>(n.inputState.draggedContent=null,!1);function e3(n,e,t,s){if(t=K1(n.state,XC,t),!t)return;let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:a}=n.inputState,i=s&&a&&ene(n,e)?{from:a.from,to:a.to}:null,o={from:r,insert:t},l=n.state.changes(i?[i,o]:o);n.focus(),n.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:i?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Uo.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let s=Array(t.length),r=0,a=()=>{++r==t.length&&e3(n,e,s.filter(i=>i!=null).join(n.state.lineBreak),!1)};for(let i=0;i<t.length;i++){let o=new FileReader;o.onerror=a,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(s[i]=o.result),a()},o.readAsText(t[i])}return!0}else{let s=e.dataTransfer.getData("Text");if(s)return e3(n,e,s,!0),!0}return!1};Uo.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=vF?null:e.clipboardData;return t?(OF(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(sne(n),!1)};function one(n,e){let t=n.dom.parentNode;if(!t)return;let s=t.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=e,s.focus(),s.selectionEnd=e.length,s.selectionStart=0,setTimeout(()=>{s.remove(),n.focus()},50)}function lne(n){let e=[],t=[],s=!1;for(let r of n.selection.ranges)r.empty||(e.push(n.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:a}of n.selection.ranges){let i=n.doc.lineAt(a);i.number>r&&(e.push(i.text),t.push({from:i.from,to:Math.min(n.doc.length,i.to+1)})),r=i.number}s=!0}return{text:K1(n,HC,e.join(n.lineBreak)),ranges:t,linewise:s}}let $k=null;Uo.copy=Uo.cut=(n,e)=>{if(!Pm(n.contentDOM,n.observer.selectionRange))return!1;let{text:t,ranges:s,linewise:r}=lne(n.state);if(!t&&!r)return!1;$k=r?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let a=vF?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",t),!0):(one(n,t),!1)};const xF=Cc.define();function kF(n,e){let t=[];for(let s of n.facet(nF)){let r=s(n,e);r&&t.push(r)}return t.length?n.update({effects:t,annotations:xF.of(!0)}):null}function SF(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=kF(n.state,e);t?n.dispatch(t):n.update([])}},10)}lo.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),SF(n)};lo.blur=n=>{n.observer.clearSelectionRange(),SF(n)};lo.compositionstart=lo.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};lo.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Bt.chrome&&Bt.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};lo.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Uo.beforeinput=(n,e)=>{var t,s;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(n.inputState.insertingText=e.data,n.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&n.observer.editContext){let a=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),i=e.getTargetRanges();if(a&&i.length){let o=i[0],l=n.posAtDOM(o.startContainer,o.startOffset),c=n.posAtDOM(o.endContainer,o.endOffset);return eP(n,{from:l,to:c,insert:n.state.toText(a)},null),!0}}let r;if(Bt.chrome&&Bt.android&&(r=bF.find(a=>a.inputType==e.inputType))&&(n.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let a=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var i;(((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0)>a+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Bt.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),Bt.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>lo.compositionend(n,e),20),!1};const t3=new Set;function cne(n){t3.has(n)||(t3.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const n3=["pre-wrap","normal","pre-line","break-spaces"];let Md=!1;function s3(){Md=!1}class une{constructor(e){this.lineWrapping=e,this.doc=us.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let s=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((t-e-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return n3.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let s=0;s<e.length;s++){let r=e[s];r<0?s++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,s,r,a,i){let o=n3.indexOf(e)>-1,l=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=o||Math.abs(s-this.charWidth)>.1;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=s,this.textHeight=r,this.lineLength=a,l){this.heightSamples={};for(let c=0;c<i.length;c++){let u=i[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class hne{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class $o{constructor(e,t,s,r,a){this.from=e,this.length=t,this.top=s,this.height=r,this._content=a}get type(){return typeof this._content=="number"?Ur.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof mh?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new $o(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Bs=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(Bs||(Bs={}));const X0=.001;class xa{constructor(e,t,s=2){this.length=e,this.height=t,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>X0&&(Md=!0),this.height=e)}replace(e,t,s){return xa.of(s)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,s,r){let a=this,i=s.doc;for(let o=r.length-1;o>=0;o--){let{fromA:l,toA:c,fromB:u,toB:h}=r[o],d=a.lineAt(l,Bs.ByPosNoHeight,s.setDoc(t),0,0),m=d.to>=c?d:a.lineAt(c,Bs.ByPosNoHeight,s,0,0);for(h+=m.to-c,c=m.to;o>0&&d.from<=r[o-1].toA;)l=r[o-1].fromA,u=r[o-1].fromB,o--,l<d.from&&(d=a.lineAt(l,Bs.ByPosNoHeight,s,0,0));u+=d.from-l,l=d.from;let y=tP.build(s.setDoc(i),e,u,h);a=Vb(a,a.replace(l,c,y))}return a.updateHeight(s,0)}static empty(){return new Pi(0,0,0)}static of(e){if(e.length==1)return e[0];let t=0,s=e.length,r=0,a=0;for(;;)if(t==s)if(r>a*2){let o=e[t-1];o.break?e.splice(--t,1,o.left,null,o.right):e.splice(--t,1,o.left,o.right),s+=1+o.break,r-=o.size}else if(a>r*2){let o=e[s];o.break?e.splice(s,1,o.left,null,o.right):e.splice(s,1,o.left,o.right),s+=2+o.break,a-=o.size}else break;else if(r<a){let o=e[t++];o&&(r+=o.size)}else{let o=e[--s];o&&(a+=o.size)}let i=0;return e[t-1]==null?(i=1,t--):e[t]==null&&(i=1,s++),new pne(xa.of(e.slice(0,t)),i,xa.of(e.slice(s)))}}function Vb(n,e){return n==e?n:(n.constructor!=e.constructor&&(Md=!0),e)}xa.prototype.size=1;const dne=At.replace({});class CF extends xa{constructor(e,t,s){super(e,t),this.deco=s,this.spaceAbove=0}mainBlock(e,t){return new $o(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,s,r){return this.spaceAbove&&e<s+this.spaceAbove?new $o(r,0,s,this.spaceAbove,dne):this.mainBlock(s,r)}lineAt(e,t,s,r,a){let i=this.mainBlock(r,a);return this.spaceAbove?this.blockAt(0,s,r,a).join(i):i}forEachLine(e,t,s,r,a,i){e<=a+this.length&&t>=a&&i(this.lineAt(0,Bs.ByPos,s,r,a))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,s=!1,r){return r&&r.from<=t&&r.more&&this.setMeasuredHeight(r),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Pi extends CF{constructor(e,t,s){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=s}mainBlock(e,t){return new $o(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,s){let r=s[0];return s.length==1&&(r instanceof Pi||r instanceof jr&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof jr?r=new Pi(r.length,this.height,this.spaceAbove):r.height=this.height,this.outdated||(r.outdated=!1),r):xa.of(s)}updateHeight(e,t=0,s=!1,r){return r&&r.from<=t&&r.more?this.setMeasuredHeight(r):(s||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class jr extends xa{constructor(e){super(e,0)}heightMetrics(e,t){let s=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,a=r-s+1,i,o=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*a);i=l/a,this.length>a+1&&(o=(this.height-l)/(this.length-a-1))}else i=this.height/a;return{firstLine:s,lastLine:r,perLine:i,perChar:o}}blockAt(e,t,s,r){let{firstLine:a,lastLine:i,perLine:o,perChar:l}=this.heightMetrics(t,r);if(t.lineWrapping){let c=r+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-s)/this.height))*this.length)),u=t.doc.lineAt(c),h=o+u.length*l,d=Math.max(s,e-h/2);return new $o(u.from,u.length,d,h,0)}else{let c=Math.max(0,Math.min(i-a,Math.floor((e-s)/o))),{from:u,length:h}=t.doc.line(a+c);return new $o(u,h,s+o*c,o,0)}}lineAt(e,t,s,r,a){if(t==Bs.ByHeight)return this.blockAt(e,s,r,a);if(t==Bs.ByPosNoHeight){let{from:m,to:y}=s.doc.lineAt(e);return new $o(m,y-m,0,0,0)}let{firstLine:i,perLine:o,perChar:l}=this.heightMetrics(s,a),c=s.doc.lineAt(e),u=o+c.length*l,h=c.number-i,d=r+o*h+l*(c.from-a-h);return new $o(c.from,c.length,Math.max(r,Math.min(d,r+this.height-u)),u,0)}forEachLine(e,t,s,r,a,i){e=Math.max(e,a),t=Math.min(t,a+this.length);let{firstLine:o,perLine:l,perChar:c}=this.heightMetrics(s,a);for(let u=e,h=r;u<=t;){let d=s.doc.lineAt(u);if(u==e){let y=d.number-o;h+=l*y+c*(e-a-y)}let m=l+c*d.length;i(new $o(d.from,d.length,h,m,0)),h+=m,u=d.to+1}}replace(e,t,s){let r=this.length-t;if(r>0){let a=s[s.length-1];a instanceof jr?s[s.length-1]=new jr(a.length+r):s.push(null,new jr(r-1))}if(e>0){let a=s[0];a instanceof jr?s[0]=new jr(e+a.length):s.unshift(new jr(e-1),null)}return xa.of(s)}decomposeLeft(e,t){t.push(new jr(e-1),null)}decomposeRight(e,t){t.push(null,new jr(this.length-e-1))}updateHeight(e,t=0,s=!1,r){let a=t+this.length;if(r&&r.from<=t+this.length&&r.more){let i=[],o=Math.max(t,r.from),l=-1;for(r.from>t&&i.push(new jr(r.from-t-1).updateHeight(e,t));o<=a&&r.more;){let u=e.doc.lineAt(o).length;i.length&&i.push(null);let h=r.heights[r.index++],d=0;h<0&&(d=-h,h=r.heights[r.index++]),l==-1?l=h:Math.abs(h-l)>=X0&&(l=-2);let m=new Pi(u,h,d);m.outdated=!1,i.push(m),o+=u+1}o<=a&&i.push(null,new jr(a-o).updateHeight(e,o));let c=xa.of(i);return(l<0||Math.abs(c.height-this.height)>=X0||Math.abs(l-this.heightMetrics(e,t).perLine)>=X0)&&(Md=!0),Vb(this,c)}else(s||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class pne extends xa{constructor(e,t,s){super(e.length+t+s.length,e.height+s.height,t|(e.outdated||s.outdated?2:0)),this.left=e,this.right=s,this.size=e.size+s.size}get break(){return this.flags&1}blockAt(e,t,s,r){let a=s+this.left.height;return e<a?this.left.blockAt(e,t,s,r):this.right.blockAt(e,t,a,r+this.left.length+this.break)}lineAt(e,t,s,r,a){let i=r+this.left.height,o=a+this.left.length+this.break,l=t==Bs.ByHeight?e<i:e<o,c=l?this.left.lineAt(e,t,s,r,a):this.right.lineAt(e,t,s,i,o);if(this.break||(l?c.to<o:c.from>o))return c;let u=t==Bs.ByPosNoHeight?Bs.ByPosNoHeight:Bs.ByPos;return l?c.join(this.right.lineAt(o,u,s,i,o)):this.left.lineAt(o,u,s,r,a).join(c)}forEachLine(e,t,s,r,a,i){let o=r+this.left.height,l=a+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,s,r,a,i),t>=l&&this.right.forEachLine(e,t,s,o,l,i);else{let c=this.lineAt(l,Bs.ByPos,s,r,a);e<c.from&&this.left.forEachLine(e,c.from-1,s,r,a,i),c.to>=e&&c.from<=t&&i(c),t>c.to&&this.right.forEachLine(c.to+1,t,s,o,l,i)}}replace(e,t,s){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,s),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,s));let a=[];e>0&&this.decomposeLeft(e,a);let i=a.length;for(let o of s)a.push(o);if(e>0&&r3(a,i-1),t<this.length){let o=a.length;this.decomposeRight(t,a),r3(a,o)}return xa.of(a)}decomposeLeft(e,t){let s=this.left.length;if(e<=s)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(s++,e>=s&&t.push(null)),e>s&&this.right.decomposeLeft(e-s,t)}decomposeRight(e,t){let s=this.left.length,r=s+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<s&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?xa.of(this.break?[e,null,t]:[e,t]):(this.left=Vb(this.left,e),this.right=Vb(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,s=!1,r){let{left:a,right:i}=this,o=t+a.length+this.break,l=null;return r&&r.from<=t+a.length&&r.more?l=a=a.updateHeight(e,t,s,r):a.updateHeight(e,t,s),r&&r.from<=o+i.length&&r.more?l=i=i.updateHeight(e,o,s,r):i.updateHeight(e,o,s),l?this.balanced(a,i):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function r3(n,e){let t,s;n[e]==null&&(t=n[e-1])instanceof jr&&(s=n[e+1])instanceof jr&&n.splice(e-1,3,new jr(t.length+1+s.length))}const mne=5;class tP{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let s=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Pi?r.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new Pi(s-this.pos,-1,0)),this.writtenTo=s,t>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,s){if(e<t||s.heightRelevant){let r=s.widget?s.widget.estimatedHeight:0,a=s.widget?s.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let i=t-e;s.block?this.addBlock(new CF(i,r,s)):(i||a||r>=mne)&&this.addLineDeco(r,a,i)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Pi(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let s=new jr(t-e);return this.oracle.doc.lineAt(e).to==t&&(s.flags|=4),s}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Pi)return e;let t=new Pi(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,s){let r=this.ensureLine();r.length+=s,r.collapsed+=s,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+s}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Pi)&&!this.isCovered?this.nodes.push(new Pi(0,-1,0)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=e;for(let r of this.nodes)r instanceof Pi&&r.updateHeight(this.oracle,s),s+=r?r.length:1;return this.nodes}static build(e,t,s,r){let a=new tP(s,e);return Zn.spans(t,s,r,a,0),a.finish(s)}}function fne(n,e,t){let s=new gne;return Zn.compare(n,e,t,s,0),s.changes}class gne{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,s,r){(e<t||s&&s.heightRelevant||r&&r.heightRelevant)&&rd(e,t,this.changes,5)}}function bne(n,e){let t=n.getBoundingClientRect(),s=n.ownerDocument,r=s.defaultView||window,a=Math.max(0,t.left),i=Math.min(r.innerWidth,t.right),o=Math.max(0,t.top),l=Math.min(r.innerHeight,t.bottom);for(let c=n.parentNode;c&&c!=s.body;)if(c.nodeType==1){let u=c,h=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&h.overflow!="visible"){let d=u.getBoundingClientRect();a=Math.max(a,d.left),i=Math.min(i,d.right),o=Math.max(o,d.top),l=Math.min(c==n.parentNode?r.innerHeight:l,d.bottom)}c=h.position=="absolute"||h.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:a-t.left,right:Math.max(a,i)-t.left,top:o-(t.top+e),bottom:Math.max(o,l)-(t.top+e)}}function yne(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function vne(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class PO{constructor(e,t,s,r){this.from=e,this.to=t,this.size=s,this.displaySize=r}static same(e,t){if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++){let r=e[s],a=t[s];if(r.from!=a.from||r.to!=a.to||r.size!=a.size)return!1}return!0}draw(e,t){return At.replace({widget:new One(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class One extends ho{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class a3{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=i3,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=fs.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(YC).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new une(t),this.stateDeco=o3(e),this.heightMap=xa.empty().applyChanges(this.stateDeco,us.empty,this.heightOracle.setDoc(e.doc),[new Ki(0,0,0,e.doc.length)]);for(let s=0;s<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());s++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=At.set(this.lineGaps.map(s=>s.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let s=0;s<=1;s++){let r=s?t.head:t.anchor;if(!e.some(({from:a,to:i})=>r>=a&&r<=i)){let{from:a,to:i}=this.lineBlockAt(r);e.push(new Eg(a,i))}}return this.viewports=e.sort((s,r)=>s.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?i3:new nP(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(im(e,this.scaler))})}update(e,t=null){this.state=e.state;let s=this.stateDeco;this.stateDeco=o3(this.state);let r=e.changedRanges,a=Ki.extendWithRanges(r,fne(s,this.stateDeco,e?e.changes:xr.empty(this.state.doc.length))),i=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);s3(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),(this.heightMap.height!=i||Md)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=i);let l=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(rF)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,s=window.getComputedStyle(t),r=this.heightOracle,a=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?fs.RTL:fs.LTR;let i=this.heightOracle.mustRefreshForWrapping(a)||this.mustMeasureContent==="refresh",o=t.getBoundingClientRect(),l=i||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let c=0,u=0;if(o.width&&o.height){let{scaleX:N,scaleY:$}=jB(t,o);(N>.005&&Math.abs(this.scaleX-N)>.005||$>.005&&Math.abs(this.scaleY-$)>.005)&&(this.scaleX=N,this.scaleY=$,c|=16,i=l=!0)}let h=(parseInt(s.paddingTop)||0)*this.scaleY,d=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=d)&&(this.paddingTop=h,this.paddingBottom=d,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let m=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=m&&(this.scrollAnchorHeight=-1,this.scrollTop=m),this.scrolledToBottom=ZB(e.scrollDOM);let y=(this.printing?vne:bne)(t,this.paddingTop),O=y.top-this.pixelViewport.top,S=y.bottom-this.pixelViewport.bottom;this.pixelViewport=y;let A=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(A!=this.inView&&(this.inView=A,A&&(l=!0)),!this.inView&&!this.scrollTarget&&!yne(e.dom))return 0;let F=o.width;if((this.contentDOMWidth!=F||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let N=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(N)&&(i=!0),i||r.lineWrapping&&Math.abs(F-this.contentDOMWidth)>r.charWidth){let{lineHeight:$,charWidth:L,textHeight:I}=e.docView.measureTextSize();i=$>0&&r.refresh(a,$,L,I,Math.max(5,F/L),N),i&&(e.docView.minWidth=0,c|=16)}O>0&&S>0?u=Math.max(O,S):O<0&&S<0&&(u=Math.min(O,S)),s3();for(let $ of this.viewports){let L=$.from==this.viewport.from?N:e.docView.measureVisibleLineHeights($);this.heightMap=(i?xa.empty().applyChanges(this.stateDeco,us.empty,this.heightOracle,[new Ki(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,i,new hne($.from,L))}Md&&(c|=2)}let j=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return j&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||j)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(i?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let s=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,a=this.heightOracle,{visibleTop:i,visibleBottom:o}=this,l=new Eg(r.lineAt(i-s*1e3,Bs.ByHeight,a,0,0).from,r.lineAt(o+(1-s)*1e3,Bs.ByHeight,a,0,0).to);if(t){let{head:c}=t.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=r.lineAt(c,Bs.ByPos,a,0,0),d;t.y=="center"?d=(h.top+h.bottom)/2-u/2:t.y=="start"||t.y=="nearest"&&c<l.from?d=h.top:d=h.bottom-u,l=new Eg(r.lineAt(d-1e3/2,Bs.ByHeight,a,0,0).from,r.lineAt(d+u+1e3/2,Bs.ByHeight,a,0,0).to)}}return l}mapViewport(e,t){let s=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new Eg(this.heightMap.lineAt(s,Bs.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,Bs.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},s=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Bs.ByPos,this.heightOracle,0,0),{bottom:a}=this.heightMap.lineAt(t,Bs.ByPos,this.heightOracle,0,0),{visibleTop:i,visibleBottom:o}=this;return(e==0||r<=i-Math.max(10,Math.min(-s,250)))&&(t==this.state.doc.length||a>=o+Math.max(10,Math.min(s,250)))&&r>i-2*1e3&&a<o+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let s=[];for(let r of e)t.touchesRange(r.from,r.to)||s.push(new PO(t.mapPos(r.from),t.mapPos(r.to),r.size,r.displaySize));return s}ensureLineGaps(e,t){let s=this.heightOracle.lineWrapping,r=s?1e4:2e3,a=r>>1,i=r<<1;if(this.defaultTextDirection!=fs.LTR&&!s)return[];let o=[],l=(u,h,d,m)=>{if(h-u<a)return;let y=this.state.selection.main,O=[y.from];y.empty||O.push(y.to);for(let A of O)if(A>u&&A<h){l(u,A-10,d,m),l(A+10,h,d,m);return}let S=xne(e,A=>A.from>=d.from&&A.to<=d.to&&Math.abs(A.from-u)<a&&Math.abs(A.to-h)<a&&!O.some(F=>A.from<F&&A.to>F));if(!S){if(h<d.to&&t&&s&&t.visibleRanges.some(j=>j.from<=h&&j.to>=h)){let j=t.moveToLineBoundary(Le.cursor(h),!1,!0).head;j>u&&(h=j)}let A=this.gapSize(d,u,h,m),F=s||A<2e6?A:2e6;S=new PO(u,h,A,F)}o.push(S)},c=u=>{if(u.length<i||u.type!=Ur.Text)return;let h=wne(u.from,u.to,this.stateDeco);if(h.total<i)return;let d=this.scrollTarget?this.scrollTarget.range.head:null,m,y;if(s){let O=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,S,A;if(d!=null){let F=Dg(h,d),j=((this.visibleBottom-this.visibleTop)/2+O)/u.height;S=F-j,A=F+j}else S=(this.visibleTop-u.top-O)/u.height,A=(this.visibleBottom-u.top+O)/u.height;m=Mg(h,S),y=Mg(h,A)}else{let O=h.total*this.heightOracle.charWidth,S=r*this.heightOracle.charWidth,A=0;if(O>2e6)for(let L of e)L.from>=u.from&&L.from<u.to&&L.size!=L.displaySize&&L.from*this.heightOracle.charWidth+A<this.pixelViewport.left&&(A=L.size-L.displaySize);let F=this.pixelViewport.left+A,j=this.pixelViewport.right+A,N,$;if(d!=null){let L=Dg(h,d),I=((j-F)/2+S)/O;N=L-I,$=L+I}else N=(F-S)/O,$=(j+S)/O;m=Mg(h,N),y=Mg(h,$)}m>u.from&&l(u.from,m,u,h),y<u.to&&l(y,u.to,u,h)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return o}gapSize(e,t,s,r){let a=Dg(r,s)-Dg(r,t);return this.heightOracle.lineWrapping?e.height*a:r.total*this.heightOracle.charWidth*a}updateLineGaps(e){PO.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=At.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let s=[];Zn.spans(t,this.viewport.from,this.viewport.to,{span(a,i){s.push({from:a,to:i})},point(){}},20);let r=0;if(s.length!=this.visibleRanges.length)r=12;else for(let a=0;a<s.length&&!(r&8);a++){let i=this.visibleRanges[a],o=s[a];(i.from!=o.from||i.to!=o.to)&&(r|=4,e&&e.mapPos(i.from,-1)==o.from&&e.mapPos(i.to,1)==o.to||(r|=8))}return this.visibleRanges=s,r}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||im(this.heightMap.lineAt(e,Bs.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||im(this.heightMap.lineAt(this.scaler.fromDOM(e),Bs.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return im(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Eg{constructor(e,t){this.from=e,this.to=t}}function wne(n,e,t){let s=[],r=n,a=0;return Zn.spans(t,n,e,{span(){},point(i,o){i>r&&(s.push({from:r,to:i}),a+=i-r),r=o}},20),r<e&&(s.push({from:r,to:e}),a+=e-r),{total:a,ranges:s}}function Mg({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let s=Math.floor(n*t);for(let r=0;;r++){let{from:a,to:i}=e[r],o=i-a;if(s<=o)return a+s;s-=o}}function Dg(n,e){let t=0;for(let{from:s,to:r}of n.ranges){if(e<=r){t+=e-s;break}t+=r-s}return t/n.total}function xne(n,e){for(let t of n)if(e(t))return t}const i3={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};function o3(n){let e=n.facet(X1).filter(s=>typeof s!="function"),t=n.facet(KC).filter(s=>typeof s!="function");return t.length&&e.push(Zn.join(t)),e}class nP{constructor(e,t,s){let r=0,a=0,i=0;this.viewports=s.map(({from:o,to:l})=>{let c=t.lineAt(o,Bs.ByPos,e,0,0).top,u=t.lineAt(l,Bs.ByPos,e,0,0).bottom;return r+=u-c,{from:o,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let o of this.viewports)o.domTop=i+(o.top-a)*this.scale,i=o.domBottom=o.domTop+(o.bottom-o.top),a=o.bottom}toDOM(e){for(let t=0,s=0,r=0;;t++){let a=t<this.viewports.length?this.viewports[t]:null;if(!a||e<a.top)return r+(e-s)*this.scale;if(e<=a.bottom)return a.domTop+(e-a.top);s=a.bottom,r=a.domBottom}}fromDOM(e){for(let t=0,s=0,r=0;;t++){let a=t<this.viewports.length?this.viewports[t]:null;if(!a||e<a.domTop)return s+(e-r)/this.scale;if(e<=a.domBottom)return a.top+(e-a.domTop);s=a.bottom,r=a.domBottom}}eq(e){return e instanceof nP?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,s)=>t.from==e.viewports[s].from&&t.to==e.viewports[s].to):!1}}function im(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),s=e.toDOM(n.bottom);return new $o(n.from,n.length,t,s-t,Array.isArray(n._content)?n._content.map(r=>im(r,e)):n._content)}const Tg=Dt.define({combine:n=>n.join(" ")}),Nk=Dt.define({combine:n=>n.indexOf(!0)>-1}),_k=lu.newName(),PF=lu.newName(),AF=lu.newName(),EF={"&light":"."+PF,"&dark":"."+AF};function Rk(n,e,t){return new lu(e,{finish(s){return/&/.test(s)?s.replace(/&\w*/,r=>{if(r=="&")return n;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):n+" "+s}})}const kne=Rk("."+_k,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},EF),Sne={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},AO=Bt.ie&&Bt.ie_version<=11;class Cne{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new tte,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let s of t)this.queue.push(s);(Bt.ie&&Bt.ie_version<=11||Bt.ios&&e.composing)&&t.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&Bt.android&&e.constructor.EDIT_CONTEXT!==!1&&!(Bt.chrome&&Bt.chrome_version<126)&&(this.editContext=new Ane(e),e.state.facet(oc)&&(e.contentDOM.editContext=this.editContext.editContext)),AO&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,s)=>t!=e[s]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,r=this.selectionRange;if(s.state.facet(oc)?s.root.activeElement!=this.dom:!Pm(this.dom,r))return;let a=r.anchorNode&&s.docView.tile.nearest(r.anchorNode);if(a&&a.isWidget()&&a.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Bt.ie&&Bt.ie_version<=11||Bt.android&&Bt.chrome)&&!s.state.selection.main.empty&&r.focusNode&&Am(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Xm(e.root);if(!t)return!1;let s=Bt.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&Pne(this.view,t)||t;if(!s||this.selectionRange.eq(s))return!1;let r=Pm(this.dom,s);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&ste(this.dom,s)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(s),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let s=this.dom;s;)if(s.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==s?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=t)s.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Sne),AO&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),AO&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var s;if(!this.delayedAndroidKey){let r=()=>{let a=this.delayedAndroidKey;a&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=a.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&a.force&&ad(this.dom,a.key,a.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,s=-1,r=!1;for(let a of e){let i=this.readMutation(a);i&&(i.typeOver&&(r=!0),t==-1?{from:t,to:s}=i:(t=Math.min(i.from,t),s=Math.max(i.to,s)))}return{from:t,to:s,typeOver:r}}readChange(){let{from:e,to:t,typeOver:s}=this.processRecords(),r=this.selectionChanged&&Pm(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let a=new zte(this.view,e,t,s);return this.view.docView.domChanged={newSel:a.newSel?a.newSel.main:null},a}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let s=this.view.state,r=fF(this.view,t);return this.view.state==s&&(t.domChanged||t.newSel&&!jb(this.view.state.selection,t.newSel.main))&&this.view.update([]),r}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty(e.type=="attributes"),e.type=="childList"){let s=l3(t,e.previousSibling||e.target.previousSibling,-1),r=l3(t,e.nextSibling||e.target.nextSibling,1);return{from:s?t.posAfter(s):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(oc)!=e.state.facet(oc)&&(e.view.contentDOM.editContext=e.state.facet(oc)?this.editContext.editContext:null))}destroy(){var e,t,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function l3(n,e,t){for(;e;){let s=vr.get(e);if(s&&s.parent==n)return s;let r=e.parentNode;e=r!=n.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function c3(n,e){let t=e.startContainer,s=e.startOffset,r=e.endContainer,a=e.endOffset,i=n.docView.domAtPos(n.state.selection.main.anchor,1);return Am(i.node,i.offset,r,a)&&([t,s,r,a]=[r,a,t,s]),{anchorNode:t,anchorOffset:s,focusNode:r,focusOffset:a}}function Pne(n,e){if(e.getComposedRanges){let r=e.getComposedRanges(n.root)[0];if(r)return c3(n,r)}let t=null;function s(r){r.preventDefault(),r.stopImmediatePropagation(),t=r.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",s,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",s,!0),t?c3(n,t):null}class Ane{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=s=>{let r=e.state.selection.main,{anchor:a,head:i}=r,o=this.toEditorPos(s.updateRangeStart),l=this.toEditorPos(s.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:s.updateRangeStart,editorBase:o,drifted:!1});let c=l-o>s.text.length;o==this.from&&a<this.from?o=a:l==this.to&&a>this.to&&(l=a);let u=gF(e.state.sliceDoc(o,l),s.text,(c?r.from:r.to)-o,c?"end":null);if(!u){let d=Le.single(this.toEditorPos(s.selectionStart),this.toEditorPos(s.selectionEnd));jb(d,r)||e.dispatch({selection:d,userEvent:"select"});return}let h={from:u.from+o,to:u.toA+o,insert:us.of(s.text.slice(u.from,u.toB).split(`
`))};if((Bt.mac||Bt.android)&&h.from==i-1&&/^\. ?$/.test(s.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(h={from:o,to:l,insert:us.of([s.text.replace("."," ")])}),this.pendingContextChange=h,!e.state.readOnly){let d=this.to-this.from+(h.to-h.from+h.insert.length);eP(e,h,Le.single(this.toEditorPos(s.selectionStart,d),this.toEditorPos(s.selectionEnd,d)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),h.from<h.to&&!h.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,s.updateRangeStart-1),Math.min(t.text.length,s.updateRangeStart+1)))&&this.handlers.compositionend(s)},this.handlers.characterboundsupdate=s=>{let r=[],a=null;for(let i=this.toEditorPos(s.rangeStart),o=this.toEditorPos(s.rangeEnd);i<o;i++){let l=e.coordsForChar(i);a=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||a||new DOMRect,r.push(a)}t.updateCharacterBounds(s.rangeStart,r)},this.handlers.textformatupdate=s=>{let r=[];for(let a of s.getTextFormats()){let i=a.underlineStyle,o=a.underlineThickness;if(!/none/i.test(i)&&!/none/i.test(o)){let l=this.toEditorPos(a.rangeStart),c=this.toEditorPos(a.rangeEnd);if(l<c){let u=`text-decoration: underline ${/^[a-z]/.test(i)?i+" ":i=="Dashed"?"dashed ":i=="Squiggle"?"wavy ":""}${/thin/i.test(o)?1:2}px`;r.push(At.mark({attributes:{style:u}}).range(l,c))}}}e.dispatch({effects:iF.of(At.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:s}=this.composing;this.composing=null,s&&this.reset(e.state)}};for(let s in this.handlers)t.addEventListener(s,this.handlers[s]);this.measureReq={read:s=>{this.editContext.updateControlBounds(s.contentDOM.getBoundingClientRect());let r=Xm(s.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,s=!1,r=this.pendingContextChange;return e.changes.iterChanges((a,i,o,l,c)=>{if(s)return;let u=c.length-(i-a);if(r&&i>=r.to)if(r.from==a&&r.to==i&&r.insert.eq(c)){r=this.pendingContextChange=null,t+=u,this.to+=u;return}else r=null,this.revertPending(e.state);if(a+=t,i+=t,i<=this.from)this.from+=u,this.to+=u;else if(a<this.to){if(a<this.from||i>this.to||this.to-this.from+c.length>3e4){s=!0;return}this.editContext.updateText(this.toContextPos(a),this.toContextPos(i),c.toString()),this.to+=u}t+=u}),r&&!s&&this.revertPending(e.state),!s}update(e){let t=this.pendingContextChange,s=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(s.from,s.to)&&e.transactions.some(r=>!r.isUserEvent("input.type")&&r.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,s=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),r=this.toContextPos(t.head);(this.editContext.selectionStart!=s||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(s,r)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let s=this.composing;return s&&s.drifted?s.editorBase+(e-s.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class lt{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:s}=e;this.dispatchTransactions=e.dispatchTransactions||s&&(r=>r.forEach(a=>s(a,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||nte(e.parent)||document,this.viewState=new a3(e.state||ls.create(e)),e.scrollTo&&e.scrollTo.is(Cg)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Wh).map(r=>new wO(r));for(let r of this.plugins)r.update(this);this.observer=new Cne(this),this.inputState=new Gte(this),this.inputState.ensureHandlers(this.plugins),this.docView=new UM(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent="refresh",this.requestMeasure()})}dispatch(...e){let t=e.length==1&&e[0]instanceof fr?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,s=!1,r,a=this.state;for(let d of e){if(d.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=d.state}if(this.destroyed){this.viewState.state=a;return}let i=this.hasFocus,o=0,l=null;e.some(d=>d.annotation(xF))?(this.inputState.notifiedFocused=i,o=1):i!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=i,l=kF(a,i),l||(o=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(u=null)):this.observer.clear(),a.facet(ls.phrases)!=this.state.facet(ls.phrases))return this.setState(a);r=Ib.create(this,a,e),r.flags|=o;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let d of e){if(h&&(h=h.map(d.changes)),d.scrollIntoView){let{main:m}=d.state.selection;h=new id(m.empty?m:Le.cursor(m.head,m.head>m.anchor?-1:1))}for(let m of d.effects)m.is(Cg)&&(h=m.value.clip(this.state))}this.viewState.update(r,h),this.bidiCache=Zb.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(rm)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(d=>d.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Tg)!=r.state.facet(Tg)&&(this.viewState.mustMeasureContent=!0),(t||s||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!r.empty)for(let d of this.state.facet(Dk))try{d(r)}catch(m){ei(this.state,m,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!fF(this,u)&&c.force&&ad(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new a3(e),this.plugins=e.facet(Wh).map(s=>new wO(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView.destroy(),this.docView=new UM(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Wh),s=e.state.facet(Wh);if(t!=s){let r=[];for(let a of s){let i=t.indexOf(a);if(i<0)r.push(new wO(a));else{let o=this.plugins[i];o.mustUpdate=e,r.push(o)}}for(let a of this.plugins)a.mustUpdate!=e&&a.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);t!=s&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(s){ei(this.state,s,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,s=this.scrollDOM,r=s.scrollTop*this.scaleY,{scrollAnchorPos:a,scrollAnchorHeight:i}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(i=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(i<0)if(ZB(s))a=-1,i=this.viewState.heightMap.height;else{let m=this.viewState.scrollAnchorAt(r);a=m.from,i=m.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(m=>{try{return m.read(this)}catch(y){return ei(this.state,y),u3}}),h=Ib.create(this,this.state,[]),d=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),d=this.docView.update(h),d&&this.docViewUpdate());for(let m=0;m<c.length;m++)if(u[m]!=u3)try{let y=c[m];y.write&&y.write(u[m],this)}catch(y){ei(this.state,y)}if(d&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,i=-1;continue}else{let y=(a<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(a).top)-i;if(y>1||y<-1){r=r+y,s.scrollTop=r/this.scaleY,i=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let o of this.state.facet(Dk))o(t)}get themeClasses(){return _k+" "+(this.state.facet(Nk)?AF:PF)+" "+this.state.facet(Tg)}updateAttrs(){let e=h3(this,oF,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(oc)?"true":"false",class:"cm-content",style:`${Bt.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),h3(this,YC,t);let s=this.observer.ignore(()=>{let r=QM(this.contentDOM,this.contentAttrs,t),a=QM(this.dom,this.editorAttrs,e);return r||a});return this.editorAttrs=e,this.contentAttrs=t,s}showAnnouncements(e){let t=!0;for(let s of e)for(let r of s.effects)if(r.is(lt.announce)){t&&(this.announceDOM.textContent=""),t=!1;let a=this.announceDOM.appendChild(document.createElement("div"));a.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(rm);let e=this.state.facet(lt.cspNonce);lu.mount(this.root,this.styleModules.concat(kne).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(s=>s.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,s){return CO(this,e,WM(this,e,t,s))}moveByGroup(e,t){return CO(this,e,WM(this,e,t,s=>Ite(this,e.head,s)))}visualLineSide(e,t){let s=this.bidiSpans(e),r=this.textDirectionAt(e.from),a=s[t?s.length-1:0];return Le.cursor(a.side(t,r)+e.from,a.forward(!t,r)?1:-1)}moveToLineBoundary(e,t,s=!0){return Rte(this,e,t,s)}moveVertically(e,t,s){return CO(this,e,Lte(this,e,t,s))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let s=Fk(this,e,t);return s&&s.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),Fk(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let s=this.docView.coordsAt(e,t);if(!s||s.left==s.right)return s;let r=this.state.doc.lineAt(e),a=this.bidiSpans(r),i=a[xl.find(a,e-r.from,-1,t)];return Rb(s,i.dir==fs.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(sF)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Ene)return XB(e.length);let t=this.textDirectionAt(e.from),s;for(let a of this.bidiCache)if(a.from==e.from&&a.dir==t&&(a.fresh||GB(a.isolates,s=ZM(this,e))))return a.order;s||(s=ZM(this,e));let r=ute(e.text,t,s);return this.bidiCache.push(new Zb(e.from,e.to,t,s,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Bt.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{VB(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Cg.of(new id(typeof e=="number"?Le.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,s=this.viewState.scrollAnchorAt(e);return Cg.of(new id(Le.cursor(s.from),"start","start",s.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Ns.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Ns.define(()=>({}),{eventObservers:e})}static theme(e,t){let s=lu.newName(),r=[Tg.of(s),rm.of(Rk(`.${s}`,e))];return t&&t.dark&&r.push(Nk.of(!0)),r}static baseTheme(e){return Fi.lowest(rm.of(Rk("."+_k,e,EF)))}static findFromDOM(e){var t;let s=e.querySelector(".cm-content"),r=s&&vr.get(s)||vr.get(e);return((t=r==null?void 0:r.root)===null||t===void 0?void 0:t.view)||null}}lt.styleModule=rm;lt.inputHandler=tF;lt.clipboardInputFilter=XC;lt.clipboardOutputFilter=HC;lt.scrollHandler=aF;lt.focusChangeEffect=nF;lt.perLineTextDirection=sF;lt.exceptionSink=eF;lt.updateListener=Dk;lt.editable=oc;lt.mouseSelectionStyle=JB;lt.dragMovesSelection=KB;lt.clickAddsSelectionRange=YB;lt.decorations=X1;lt.blockWrappers=lF;lt.outerDecorations=KC;lt.atomicRanges=qf;lt.bidiIsolatedRanges=cF;lt.scrollMargins=uF;lt.darkTheme=Nk;lt.cspNonce=Dt.define({combine:n=>n.length?n[0]:""});lt.contentAttributes=YC;lt.editorAttributes=oF;lt.lineWrapping=lt.contentAttributes.of({class:"cm-lineWrapping"});lt.announce=rn.define();const Ene=4096,u3={};class Zb{constructor(e,t,s,r,a,i){this.from=e,this.to=t,this.dir=s,this.isolates=r,this.fresh=a,this.order=i}static update(e,t){if(t.empty&&!e.some(a=>a.fresh))return e;let s=[],r=e.length?e[e.length-1].dir:fs.LTR;for(let a=Math.max(0,e.length-10);a<e.length;a++){let i=e[a];i.dir==r&&!t.touchesRange(i.from,i.to)&&s.push(new Zb(t.mapPos(i.from,1),t.mapPos(i.to,-1),i.dir,i.isolates,!1,i.order))}return s}}function h3(n,e,t){for(let s=n.state.facet(e),r=s.length-1;r>=0;r--){let a=s[r],i=typeof a=="function"?a(n):a;i&&UC(i,t)}return t}const Mne=Bt.mac?"mac":Bt.windows?"win":Bt.linux?"linux":"key";function Dne(n,e){const t=n.split(/-(?!$)/);let s=t[t.length-1];s=="Space"&&(s=" ");let r,a,i,o;for(let l=0;l<t.length-1;++l){const c=t[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))a=!0;else if(/^s(hift)?$/i.test(c))i=!0;else if(/^mod$/i.test(c))e=="mac"?o=!0:a=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(s="Alt-"+s),a&&(s="Ctrl-"+s),o&&(s="Meta-"+s),i&&(s="Shift-"+s),s}function Bg(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const Tne=Fi.default(lt.domEventHandlers({keydown(n,e){return DF(MF(e.state),n,e,"editor")}})),Pc=Dt.define({enables:Tne}),d3=new WeakMap;function MF(n){let e=n.facet(Pc),t=d3.get(e);return t||d3.set(e,t=Fne(e.reduce((s,r)=>s.concat(r),[]))),t}function Lu(n,e,t){return DF(MF(n.state),e,n,t)}let jc=null;const Bne=4e3;function Fne(n,e=Mne){let t=Object.create(null),s=Object.create(null),r=(i,o)=>{let l=s[i];if(l==null)s[i]=o;else if(l!=o)throw new Error("Key binding "+i+" is used both as a regular binding and as a multi-stroke prefix")},a=(i,o,l,c,u)=>{var h,d;let m=t[i]||(t[i]=Object.create(null)),y=o.split(/ (?!$)/).map(A=>Dne(A,e));for(let A=1;A<y.length;A++){let F=y.slice(0,A).join(" ");r(F,!0),m[F]||(m[F]={preventDefault:!0,stopPropagation:!1,run:[j=>{let N=jc={view:j,prefix:F,scope:i};return setTimeout(()=>{jc==N&&(jc=null)},Bne),!0}]})}let O=y.join(" ");r(O,!1);let S=m[O]||(m[O]={preventDefault:!1,stopPropagation:!1,run:((d=(h=m._any)===null||h===void 0?void 0:h.run)===null||d===void 0?void 0:d.slice())||[]});l&&S.run.push(l),c&&(S.preventDefault=!0),u&&(S.stopPropagation=!0)};for(let i of n){let o=i.scope?i.scope.split(" "):["editor"];if(i.any)for(let c of o){let u=t[c]||(t[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=i;for(let d in u)u[d].run.push(m=>h(m,Ik))}let l=i[e]||i.key;if(l)for(let c of o)a(c,l,i.run,i.preventDefault,i.stopPropagation),i.shift&&a(c,"Shift-"+l,i.shift,i.preventDefault,i.stopPropagation)}return t}let Ik=null;function DF(n,e,t,s){Ik=e;let r=Wee(e),a=Ha(r,0),i=fl(a)==r.length&&r!=" ",o="",l=!1,c=!1,u=!1;jc&&jc.view==t&&jc.scope==s&&(o=jc.prefix+" ",yF.indexOf(e.keyCode)<0&&(c=!0,jc=null));let h=new Set,d=S=>{if(S){for(let A of S.run)if(!h.has(A)&&(h.add(A),A(t)))return S.stopPropagation&&(u=!0),!0;S.preventDefault&&(S.stopPropagation&&(u=!0),c=!0)}return!1},m=n[s],y,O;return m&&(d(m[o+Bg(r,e,!i)])?l=!0:i&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Bt.windows&&e.ctrlKey&&e.altKey)&&!(Bt.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(y=cu[e.keyCode])&&y!=r?(d(m[o+Bg(y,e,!0)])||e.shiftKey&&(O=Wm[e.keyCode])!=r&&O!=y&&d(m[o+Bg(O,e,!1)]))&&(l=!0):i&&e.shiftKey&&d(m[o+Bg(r,e,!0)])&&(l=!0),!l&&d(m._any)&&(l=!0)),c&&(l=!0),l&&u&&e.stopPropagation(),Ik=null,l}class Uf{constructor(e,t,s,r,a){this.className=e,this.left=t,this.top=s,this.width=r,this.height=a}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,s){if(s.empty){let r=e.coordsAtPos(s.head,s.assoc||1);if(!r)return[];let a=TF(e);return[new Uf(t,r.left-a.left,r.top-a.top,null,r.bottom-r.top)]}else return $ne(e,t,s)}}function TF(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==fs.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function p3(n,e,t,s){let r=n.coordsAtPos(e,t*2);if(!r)return s;let a=n.dom.getBoundingClientRect(),i=(r.top+r.bottom)/2,o=n.posAtCoords({x:a.left+1,y:i}),l=n.posAtCoords({x:a.right-1,y:i});return o==null||l==null?s:{from:Math.max(s.from,Math.min(o,l)),to:Math.min(s.to,Math.max(o,l))}}function $ne(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let s=Math.max(t.from,n.viewport.from),r=Math.min(t.to,n.viewport.to),a=n.textDirection==fs.LTR,i=n.contentDOM,o=i.getBoundingClientRect(),l=TF(n),c=i.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),h=o.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),d=o.right-(u?parseInt(u.paddingRight):0),m=Bk(n,s,1),y=Bk(n,r,-1),O=m.type==Ur.Text?m:null,S=y.type==Ur.Text?y:null;if(O&&(n.lineWrapping||m.widgetLineBreaks)&&(O=p3(n,s,1,O)),S&&(n.lineWrapping||y.widgetLineBreaks)&&(S=p3(n,r,-1,S)),O&&S&&O.from==S.from&&O.to==S.to)return F(j(t.from,t.to,O));{let $=O?j(t.from,null,O):N(m,!1),L=S?j(null,t.to,S):N(y,!0),I=[];return(O||m).to<(S||y).from-(O&&S?1:0)||m.widgetLineBreaks>1&&$.bottom+n.defaultLineHeight/2<L.top?I.push(A(h,$.bottom,d,L.top)):$.bottom<L.top&&n.elementAtHeight(($.bottom+L.top)/2).type==Ur.Text&&($.bottom=L.top=($.bottom+L.top)/2),F($).concat(I).concat(F(L))}function A($,L,I,q){return new Uf(e,$-l.left,L-l.top,Math.max(0,I-$),q-L)}function F({top:$,bottom:L,horizontal:I}){let q=[];for(let ce=0;ce<I.length;ce+=2)q.push(A(I[ce],$,I[ce+1],L));return q}function j($,L,I){let q=1e9,ce=-1e9,ee=[];function he(Oe,Pe,De,Se,ae){let Ee=n.coordsAtPos(Oe,Oe==I.to?-2:2),Qe=n.coordsAtPos(De,De==I.from?2:-2);!Ee||!Qe||(q=Math.min(Ee.top,Qe.top,q),ce=Math.max(Ee.bottom,Qe.bottom,ce),ae==fs.LTR?ee.push(a&&Pe?h:Ee.left,a&&Se?d:Qe.right):ee.push(!a&&Se?h:Qe.left,!a&&Pe?d:Ee.right))}let H=$??I.from,me=L??I.to;for(let Oe of n.visibleRanges)if(Oe.to>H&&Oe.from<me)for(let Pe=Math.max(Oe.from,H),De=Math.min(Oe.to,me);;){let Se=n.state.doc.lineAt(Pe);for(let ae of n.bidiSpans(Se)){let Ee=ae.from+Se.from,Qe=ae.to+Se.from;if(Ee>=De)break;Qe>Pe&&he(Math.max(Ee,Pe),$==null&&Ee<=H,Math.min(Qe,De),L==null&&Qe>=me,ae.dir)}if(Pe=Se.to+1,Pe>=De)break}return ee.length==0&&he(H,$==null,me,L==null,n.textDirection),{top:q,bottom:ce,horizontal:ee}}function N($,L){let I=o.top+(L?$.top:$.bottom);return{top:I,bottom:I,horizontal:[]}}}function Nne(n,e){return n.constructor==e.constructor&&n.eq(e)}class _ne{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(H0)!=e.state.facet(H0)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,s=e.facet(H0);for(;t<s.length&&s[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,s)=>!Nne(t,this.drawn[s]))){let t=this.dom.firstChild,s=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[s].constructor&&r.update(t,this.drawn[s])?(t=t.nextSibling,s++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e,Bt.safari&&Bt.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const H0=Dt.define();function BF(n){return[Ns.define(e=>new _ne(e,n)),H0.of(n)]}const Dd=Dt.define({combine(n){return Ll(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function Rne(n={}){return[Dd.of(n),Ine,Lne,Qne,rF.of(!0)]}function FF(n){return n.facet(Dd)}function $F(n){return n.startState.facet(Dd)!=n.state.facet(Dd)}const Ine=BF({above:!0,markers(n){let{state:e}=n,t=e.facet(Dd),s=[];for(let r of e.selection.ranges){let a=r==e.selection.main;if(r.empty||t.drawRangeCursor){let i=a?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=r.empty?r:Le.cursor(r.head,r.head>r.anchor?-1:1);for(let l of Uf.forRange(n,i,o))s.push(l)}}return s},update(n,e){n.transactions.some(s=>s.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=$F(n);return t&&m3(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){m3(e.state,n)},class:"cm-cursorLayer"});function m3(n,e){e.style.animationDuration=n.facet(Dd).cursorBlinkRate+"ms"}const Lne=BF({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Uf.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||$F(n)},class:"cm-selectionLayer"}),Qne=Fi.highest(lt.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),NF=rn.define({map(n,e){return n==null?null:e.mapPos(n)}}),om=qs.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,s)=>s.is(NF)?s.value:t,n)}}),jne=Ns.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(om);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(om)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(om),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let s=n.scrollDOM.getBoundingClientRect();return{left:t.left-s.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-s.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(om)!=n&&this.view.dispatch({effects:NF.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Vne(){return[om,jne]}function f3(n,e,t,s,r){e.lastIndex=0;for(let a=n.iterRange(t,s),i=t,o;!a.next().done;i+=a.value.length)if(!a.lineBreak)for(;o=e.exec(a.value);)r(i+o.index,o)}function Zne(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let s=[];for(let{from:r,to:a}of t)r=Math.max(n.state.doc.lineAt(r).from,r-e),a=Math.min(n.state.doc.lineAt(a).to,a+e),s.length&&s[s.length-1].to>=r?s[s.length-1].to=a:s.push({from:r,to:a});return s}class zne{constructor(e){const{regexp:t,decoration:s,decorate:r,boundary:a,maxLength:i=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(o,l,c,u)=>r(u,c,c+o[0].length,o,l);else if(typeof s=="function")this.addMatch=(o,l,c,u)=>{let h=s(o,l,c);h&&u(c,c+o[0].length,h)};else if(s)this.addMatch=(o,l,c,u)=>u(c,c+o[0].length,s);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=a,this.maxLength=i}createDeco(e){let t=new qo,s=t.add.bind(t);for(let{from:r,to:a}of Zne(e,this.maxLength))f3(e.state.doc,this.regexp,r,a,(i,o)=>this.addMatch(o,e,i,s));return t.finish()}updateDeco(e,t){let s=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((a,i,o,l)=>{l>=e.view.viewport.from&&o<=e.view.viewport.to&&(s=Math.min(o,s),r=Math.max(l,r))}),e.viewportMoved||r-s>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),s,r):t}updateRange(e,t,s,r){for(let a of e.visibleRanges){let i=Math.max(a.from,s),o=Math.min(a.to,r);if(o>=i){let l=e.state.doc.lineAt(i),c=l.to<o?e.state.doc.lineAt(o):l,u=Math.max(a.from,l.from),h=Math.min(a.to,c.to);if(this.boundary){for(;i>l.from;i--)if(this.boundary.test(l.text[i-1-l.from])){u=i;break}for(;o<c.to;o++)if(this.boundary.test(c.text[o-c.from])){h=o;break}}let d=[],m,y=(O,S,A)=>d.push(A.range(O,S));if(l==c)for(this.regexp.lastIndex=u-l.from;(m=this.regexp.exec(l.text))&&m.index<h-l.from;)this.addMatch(m,e,m.index+l.from,y);else f3(e.state.doc,this.regexp,u,h,(O,S)=>this.addMatch(S,e,O,y));t=t.update({filterFrom:u,filterTo:h,filter:(O,S)=>O<u||S>h,add:d})}}return t}}const Lk=/x/.unicode!=null?"gu":"g",qne=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,Lk),Une={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let EO=null;function Wne(){var n;if(EO==null&&typeof document<"u"&&document.body){let e=document.body.style;EO=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return EO||!1}const Y0=Dt.define({combine(n){let e=Ll(n,{render:null,specialChars:qne,addSpecialChars:null});return(e.replaceTabs=!Wne())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Lk)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Lk)),e}});function _F(n={}){return[Y0.of(n),Gne()]}let g3=null;function Gne(){return g3||(g3=Ns.fromClass(class{constructor(n){this.view=n,this.decorations=At.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(Y0)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new zne({regexp:n.specialChars,decoration:(e,t,s)=>{let{doc:r}=t.state,a=Ha(e[0],0);if(a==9){let i=r.lineAt(s),o=t.state.tabSize,l=tp(i.text,o,s-i.from);return At.replace({widget:new Kne((o-l%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[a]||(this.decorationCache[a]=At.replace({widget:new Yne(n,a)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(Y0);n.startState.facet(Y0)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const Xne="•";function Hne(n){return n>=32?Xne:n==10?"␤":String.fromCharCode(9216+n)}class Yne extends ho{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Hne(this.code),s=e.state.phrase("Control character")+" "+(Une[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,s,t);if(r)return r;let a=document.createElement("span");return a.textContent=t,a.title=s,a.setAttribute("aria-label",s),a.className="cm-specialChar",a}ignoreEvent(){return!1}}class Kne extends ho{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Jne(){return tse}const ese=At.line({class:"cm-activeLine"}),tse=Ns.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let s of n.state.selection.ranges){let r=n.lineBlockAt(s.head);r.from>e&&(t.push(ese.range(r.from)),e=r.from)}return At.set(t)}},{decorations:n=>n.decorations}),Qk=2e3;function nse(n,e,t){let s=Math.min(e.line,t.line),r=Math.max(e.line,t.line),a=[];if(e.off>Qk||t.off>Qk||e.col<0||t.col<0){let i=Math.min(e.off,t.off),o=Math.max(e.off,t.off);for(let l=s;l<=r;l++){let c=n.doc.line(l);c.length<=o&&a.push(Le.range(c.from+i,c.to+o))}}else{let i=Math.min(e.col,t.col),o=Math.max(e.col,t.col);for(let l=s;l<=r;l++){let c=n.doc.line(l),u=vk(c.text,i,n.tabSize,!0);if(u<0)a.push(Le.cursor(c.to));else{let h=vk(c.text,o,n.tabSize);a.push(Le.range(c.from+u,c.from+h))}}}return a}function sse(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function b3(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),s=n.state.doc.lineAt(t),r=t-s.from,a=r>Qk?-1:r==s.length?sse(n,e.clientX):tp(s.text,n.state.tabSize,t-s.from);return{line:s.number,col:a,off:r}}function rse(n,e){let t=b3(n,e),s=n.state.selection;return t?{update(r){if(r.docChanged){let a=r.changes.mapPos(r.startState.doc.line(t.line).from),i=r.state.doc.lineAt(a);t={line:i.number,col:t.col,off:Math.min(t.off,i.length)},s=s.map(r.changes)}},get(r,a,i){let o=b3(n,r);if(!o)return s;let l=nse(n.state,t,o);return l.length?i?Le.create(l.concat(s.ranges)):Le.create(l):s}}:null}function ase(n){let e=(t=>t.altKey&&t.button==0);return lt.mouseSelectionStyle.of((t,s)=>e(s)?rse(t,s):null)}const ise={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},ose={style:"cursor: crosshair"};function lse(n={}){let[e,t]=ise[n.key||"Alt"],s=Ns.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[s,lt.contentAttributes.of(r=>{var a;return!((a=r.plugin(s))===null||a===void 0)&&a.isDown?ose:null})]}const Fg="-10000px";class RF{constructor(e,t,s,r){this.facet=t,this.createTooltipView=s,this.removeTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(i=>i);let a=null;this.tooltipViews=this.tooltips.map(i=>a=s(i,a))}update(e,t){var s;let r=e.state.facet(this.facet),a=r.filter(l=>l);if(r===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let i=[],o=t?[]:null;for(let l=0;l<a.length;l++){let c=a[l],u=-1;if(c){for(let h=0;h<this.tooltips.length;h++){let d=this.tooltips[h];d&&d.create==c.create&&(u=h)}if(u<0)i[l]=this.createTooltipView(c,l?i[l-1]:null),o&&(o[l]=!!c.above);else{let h=i[l]=this.tooltipViews[u];o&&(o[l]=t[u]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)i.indexOf(l)<0&&(this.removeTooltipView(l),(s=l.destroy)===null||s===void 0||s.call(l));return t&&(o.forEach((l,c)=>t[c]=l),t.length=o.length),this.input=r,this.tooltips=a,this.tooltipViews=i,!0}}function cse(n){let e=n.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const MO=Dt.define({combine:n=>{var e,t,s;return{position:Bt.ios?"absolute":((e=n.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((s=n.find(r=>r.tooltipSpace))===null||s===void 0?void 0:s.tooltipSpace)||cse}}}),y3=new WeakMap,sP=Ns.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(MO);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new RF(n,rP,(t,s)=>this.createTooltip(t,s),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,s=n.state.facet(MO);if(s.position!=this.position&&!this.madeAbsolute){this.position=s.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(s.parent!=this.parent){this.parent&&this.container.remove(),this.parent=s.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),s=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",t.dom.appendChild(r)}return t.dom.style.position=this.position,t.dom.style.top=Fg,t.dom.style.left="0px",this.container.insertBefore(t.dom,s),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let s of this.manager.tooltipViews)s.dom.remove(),(n=s.destroy)===null||n===void 0||n.call(s);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:a}=this.manager.tooltipViews[0];if(Bt.safari){let i=a.getBoundingClientRect();t=Math.abs(i.top+1e4)>1||Math.abs(i.left)>1}else t=!!a.offsetParent&&a.offsetParent!=this.container.ownerDocument.body}if(t||this.position=="absolute")if(this.parent){let a=this.parent.getBoundingClientRect();a.width&&a.height&&(n=a.width/this.parent.offsetWidth,e=a.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let s=this.view.scrollDOM.getBoundingClientRect(),r=JC(this.view);return{visible:{left:s.left+r.left,top:s.top+r.top,right:s.right-r.right,bottom:s.bottom-r.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((a,i)=>{let o=this.manager.tooltipViews[i];return o.getCoords?o.getCoords(a.pos):this.view.coordsAtPos(a.pos)}),size:this.manager.tooltipViews.map(({dom:a})=>a.getBoundingClientRect()),space:this.view.state.facet(MO).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let o of this.manager.tooltipViews)o.dom.style.position="absolute"}let{visible:t,space:s,scaleX:r,scaleY:a}=n,i=[];for(let o=0;o<this.manager.tooltips.length;o++){let l=this.manager.tooltips[o],c=this.manager.tooltipViews[o],{dom:u}=c,h=n.pos[o],d=n.size[o];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,s.top)||h.top>=Math.min(t.bottom,s.bottom)||h.right<Math.max(t.left,s.left)-.1||h.left>Math.min(t.right,s.right)+.1)){u.style.top=Fg;continue}let m=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,y=m?7:0,O=d.right-d.left,S=(e=y3.get(c))!==null&&e!==void 0?e:d.bottom-d.top,A=c.offset||hse,F=this.view.textDirection==fs.LTR,j=d.width>s.right-s.left?F?s.left:s.right-d.width:F?Math.max(s.left,Math.min(h.left-(m?14:0)+A.x,s.right-O)):Math.min(Math.max(s.left,h.left-O+(m?14:0)-A.x),s.right-O),N=this.above[o];!l.strictSide&&(N?h.top-S-y-A.y<s.top:h.bottom+S+y+A.y>s.bottom)&&N==s.bottom-h.bottom>h.top-s.top&&(N=this.above[o]=!N);let $=(N?h.top-s.top:s.bottom-h.bottom)-y;if($<S&&c.resize!==!1){if($<this.view.defaultLineHeight){u.style.top=Fg;continue}y3.set(c,S),u.style.height=(S=$)/a+"px"}else u.style.height&&(u.style.height="");let L=N?h.top-S-y-A.y:h.bottom+y+A.y,I=j+O;if(c.overlap!==!0)for(let q of i)q.left<I&&q.right>j&&q.top<L+S&&q.bottom>L&&(L=N?q.top-S-2-y:q.bottom+y+2);if(this.position=="absolute"?(u.style.top=(L-n.parent.top)/a+"px",v3(u,(j-n.parent.left)/r)):(u.style.top=L/a+"px",v3(u,j/r)),m){let q=h.left+(F?A.x:-A.x)-(j+14-7);m.style.left=q/r+"px"}c.overlap!==!0&&i.push({left:j,top:L,right:I,bottom:L+S}),u.classList.toggle("cm-tooltip-above",N),u.classList.toggle("cm-tooltip-below",!N),c.positioned&&c.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Fg}},{eventObservers:{scroll(){this.maybeMeasure()}}});function v3(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const use=lt.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),hse={x:0,y:0},rP=Dt.define({enables:[sP,use]}),zb=Dt.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class J1{static create(e){return new J1(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new RF(e,zb,(t,s)=>this.createHostedView(t,s),t=>t.dom.remove())}createHostedView(e,t){let s=e.create(this.view);return s.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(s.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&s.mount&&s.mount(this.view),s}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let s of this.manager.tooltipViews){let r=s[e];if(r!==void 0){if(t===void 0)t=r;else if(t!==r)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const dse=rP.compute([zb],n=>{let e=n.facet(zb);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var s;return(s=t.end)!==null&&s!==void 0?s:t.pos})),create:J1.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class pse{constructor(e,t,s,r,a){this.view=e,this.source=t,this.field=s,this.setHover=r,this.hoverTime=a,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,s=e.docView.tile.nearest(t.target);if(!s)return;let r,a=1;if(s.isWidget())r=s.posAtStart;else{if(r=e.posAtCoords(t),r==null)return;let o=e.coordsAtPos(r);if(!o||t.y<o.top||t.y>o.bottom||t.x<o.left-e.defaultCharacterWidth||t.x>o.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(r)).find(u=>u.from<=r&&u.to>=r),c=l&&l.dir==fs.RTL?-1:1;a=t.x<o.left?-c:c}let i=this.source(e,r,a);if(i!=null&&i.then){let o=this.pending={pos:r};i.then(l=>{this.pending==o&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>ei(e.state,l,"hover tooltip"))}else i&&!(Array.isArray(i)&&!i.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(i)?i:[i])})}get tooltip(){let e=this.view.plugin(sP),t=e?e.manager.tooltips.findIndex(s=>s.create==J1.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,s;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:a}=this;if(r.length&&a&&!mse(a.dom,e)||this.pending){let{pos:i}=r[0]||this.pending,o=(s=(t=r[0])===null||t===void 0?void 0:t.end)!==null&&s!==void 0?s:i;(i==o?this.view.posAtCoords(this.lastMove)!=i:!fse(this.view,i,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:s}=this;s&&s.dom.contains(e.relatedTarget)?this.watchTooltipLeave(s.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=s=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(s.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const $g=4;function mse(n,e){let{left:t,right:s,top:r,bottom:a}=n.getBoundingClientRect(),i;if(i=n.querySelector(".cm-tooltip-arrow")){let o=i.getBoundingClientRect();r=Math.min(o.top,r),a=Math.max(o.bottom,a)}return e.clientX>=t-$g&&e.clientX<=s+$g&&e.clientY>=r-$g&&e.clientY<=a+$g}function fse(n,e,t,s,r,a){let i=n.scrollDOM.getBoundingClientRect(),o=n.documentTop+n.documentPadding.top+n.contentHeight;if(i.left>s||i.right<s||i.top>r||Math.min(i.bottom,o)<r)return!1;let l=n.posAtCoords({x:s,y:r},!1);return l>=e&&l<=t}function IF(n,e={}){let t=rn.define(),s=qs.define({create(){return[]},update(r,a){if(r.length&&(e.hideOnChange&&(a.docChanged||a.selection)?r=[]:e.hideOn&&(r=r.filter(i=>!e.hideOn(a,i))),a.docChanged)){let i=[];for(let o of r){let l=a.changes.mapPos(o.pos,-1,pr.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),o);c.pos=l,c.end!=null&&(c.end=a.changes.mapPos(c.end)),i.push(c)}}r=i}for(let i of a.effects)i.is(t)&&(r=i.value),i.is(gse)&&(r=[]);return r},provide:r=>zb.from(r)});return{active:s,extension:[s,Ns.define(r=>new pse(r,n,s,t,e.hoverTime||300)),dse]}}function LF(n,e){let t=n.plugin(sP);if(!t)return null;let s=t.manager.tooltips.indexOf(e);return s<0?null:t.manager.tooltipViews[s]}const gse=rn.define(),O3=Dt.define({combine(n){let e,t;for(let s of n)e=e||s.topContainer,t=t||s.bottomContainer;return{topContainer:e,bottomContainer:t}}});function aP(n,e){let t=n.plugin(QF),s=t?t.specs.indexOf(e):-1;return s>-1?t.panels[s]:null}const QF=Ns.fromClass(class{constructor(n){this.input=n.state.facet(hu),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(O3);this.top=new Ng(n,!0,e.topContainer),this.bottom=new Ng(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(O3);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Ng(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Ng(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(hu);if(t!=this.input){let s=t.filter(l=>l),r=[],a=[],i=[],o=[];for(let l of s){let c=this.specs.indexOf(l),u;c<0?(u=l(n.view),o.push(u)):(u=this.panels[c],u.update&&u.update(n)),r.push(u),(u.top?a:i).push(u)}this.specs=s,this.panels=r,this.top.sync(a),this.bottom.sync(i);for(let l of o)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let s of this.panels)s.update&&s.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>lt.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Ng{constructor(e,t,s){this.view=e,this.top=t,this.container=s,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=w3(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=w3(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function w3(n){let e=n.nextSibling;return n.remove(),e}const hu=Dt.define({enables:QF});function bse(n,e){let t,s=new Promise(i=>t=i),r=i=>yse(i,e,t);n.state.field(DO,!1)?n.dispatch({effects:jF.of(r)}):n.dispatch({effects:rn.appendConfig.of(DO.init(()=>[r]))});let a=VF.of(r);return{close:a,result:s.then(i=>((n.win.queueMicrotask||(l=>n.win.setTimeout(l,10)))(()=>{n.state.field(DO).indexOf(r)>-1&&n.dispatch({effects:a})}),i))}}const DO=qs.define({create(){return[]},update(n,e){for(let t of e.effects)t.is(jF)?n=[t.value].concat(n):t.is(VF)&&(n=n.filter(s=>s!=t.value));return n},provide:n=>hu.computeN([n],e=>e.field(n))}),jF=rn.define(),VF=rn.define();function yse(n,e,t){let s=e.content?e.content(n,()=>i(null)):null;if(!s){if(s=bs("form"),e.input){let o=bs("input",e.input);/^(text|password|number|email|tel|url)$/.test(o.type)&&o.classList.add("cm-textfield"),o.name||(o.name="input"),s.appendChild(bs("label",(e.label||"")+": ",o))}else s.appendChild(document.createTextNode(e.label||""));s.appendChild(document.createTextNode(" ")),s.appendChild(bs("button",{class:"cm-button",type:"submit"},e.submitLabel||"OK"))}let r=s.nodeName=="FORM"?[s]:s.querySelectorAll("form");for(let o=0;o<r.length;o++){let l=r[o];l.addEventListener("keydown",c=>{c.keyCode==27?(c.preventDefault(),i(null)):c.keyCode==13&&(c.preventDefault(),i(l))}),l.addEventListener("submit",c=>{c.preventDefault(),i(l)})}let a=bs("div",s,bs("button",{onclick:()=>i(null),"aria-label":n.state.phrase("close"),class:"cm-dialog-close",type:"button"},["×"]));e.class&&(a.className=e.class),a.classList.add("cm-dialog");function i(o){a.contains(a.ownerDocument.activeElement)&&n.focus(),t(o)}return{dom:a,top:e.top,mount:()=>{if(e.focus){let o;typeof e.focus=="string"?o=s.querySelector(e.focus):o=s.querySelector("input")||s.querySelector("button"),o&&"select"in o?o.select():o&&"focus"in o&&o.focus()}}}}class yc extends ou{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}yc.prototype.elementClass="";yc.prototype.toDOM=void 0;yc.prototype.mapMode=pr.TrackBefore;yc.prototype.startSide=yc.prototype.endSide=-1;yc.prototype.point=!0;const K0=Dt.define(),vse=Dt.define(),Ose={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Zn.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Mm=Dt.define();function wse(n){return[ZF(),Mm.of({...Ose,...n})]}const x3=Dt.define({combine:n=>n.some(e=>e)});function ZF(n){return[xse]}const xse=Ns.fromClass(class{constructor(n){this.view=n,this.domAfter=null,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(Mm).map(e=>new S3(n,e)),this.fixed=!n.state.facet(x3);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,s=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(s<(t.to-t.from)*.8)}if(n.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(x3)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=Zn.iter(this.view.state.facet(K0),this.view.viewport.from),s=[],r=this.gutters.map(a=>new kse(a,this.view.viewport,-this.view.documentPadding.top));for(let a of this.view.viewportLineBlocks)if(s.length&&(s=[]),Array.isArray(a.type)){let i=!0;for(let o of a.type)if(o.type==Ur.Text&&i){jk(t,s,o.from);for(let l of r)l.line(this.view,o,s);i=!1}else if(o.widget)for(let l of r)l.widget(this.view,o)}else if(a.type==Ur.Text){jk(t,s,a.from);for(let i of r)i.line(this.view,a,s)}else if(a.widget)for(let i of r)i.widget(this.view,a);for(let a of r)a.finish();n&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(n){let e=n.startState.facet(Mm),t=n.state.facet(Mm),s=n.docChanged||n.heightChanged||n.viewportChanged||!Zn.eq(n.startState.facet(K0),n.state.facet(K0),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(n)&&(s=!0);else{s=!0;let r=[];for(let a of t){let i=e.indexOf(a);i<0?r.push(new S3(this.view,a)):(this.gutters[i].update(n),r.push(this.gutters[i]))}for(let a of this.gutters)a.dom.remove(),r.indexOf(a)<0&&a.destroy();for(let a of r)a.config.side=="after"?this.getDOMAfter().appendChild(a.dom):this.dom.appendChild(a.dom);this.gutters=r}return s}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:n=>lt.scrollMargins.of(e=>{let t=e.plugin(n);if(!t||t.gutters.length==0||!t.fixed)return null;let s=t.dom.offsetWidth*e.scaleX,r=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==fs.LTR?{left:s,right:r}:{right:s,left:r}})});function k3(n){return Array.isArray(n)?n:[n]}function jk(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class kse{constructor(e,t,s){this.gutter=e,this.height=s,this.i=0,this.cursor=Zn.iter(e.markers,t.from)}addElement(e,t,s){let{gutter:r}=this,a=(t.top-this.height)/e.scaleY,i=t.height/e.scaleY;if(this.i==r.elements.length){let o=new zF(e,i,a,s);r.elements.push(o),r.dom.appendChild(o.dom)}else r.elements[this.i].update(e,i,a,s);this.height=t.bottom,this.i++}line(e,t,s){let r=[];jk(this.cursor,r,t.from),s.length&&(r=r.concat(s));let a=this.gutter.config.lineMarker(e,t,r);a&&r.unshift(a);let i=this.gutter;r.length==0&&!i.config.renderEmptyElements||this.addElement(e,t,r)}widget(e,t){let s=this.gutter.config.widgetMarker(e,t.widget,t),r=s?[s]:null;for(let a of e.state.facet(vse)){let i=a(e,t.widget,t);i&&(r||(r=[])).push(i)}r&&this.addElement(e,t,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class S3{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in t.domEventHandlers)this.dom.addEventListener(s,r=>{let a=r.target,i;if(a!=this.dom&&this.dom.contains(a)){for(;a.parentNode!=this.dom;)a=a.parentNode;let l=a.getBoundingClientRect();i=(l.top+l.bottom)/2}else i=r.clientY;let o=e.lineBlockAtHeight(i-e.documentTop);t.domEventHandlers[s](e,o,r)&&r.preventDefault()});this.markers=k3(t.markers(e)),t.initialSpacer&&(this.spacer=new zF(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=k3(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let s=e.view.viewport;return!Zn.eq(this.markers,t,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class zF{constructor(e,t,s,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,s,r)}update(e,t,s,r){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),Sse(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let s="cm-gutterElement",r=this.dom.firstChild;for(let a=0,i=0;;){let o=i,l=a<t.length?t[a++]:null,c=!1;if(l){let u=l.elementClass;u&&(s+=" "+u);for(let h=i;h<this.markers.length;h++)if(this.markers[h].compare(l)){o=h,c=!0;break}}else o=this.markers.length;for(;i<o;){let u=this.markers[i++];if(u.toDOM){u.destroy(r);let h=r.nextSibling;r.remove(),r=h}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),c&&i++}this.dom.className=s,this.markers=t}destroy(){this.setMarkers(null,[])}}function Sse(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const Cse=Dt.define(),Pse=Dt.define(),Gh=Dt.define({combine(n){return Ll(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let s=Object.assign({},e);for(let r in t){let a=s[r],i=t[r];s[r]=a?(o,l,c)=>a(o,l,c)||i(o,l,c):i}return s}})}});class TO extends yc{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function BO(n,e){return n.state.facet(Gh).formatNumber(e,n.state)}const Ase=Mm.compute([Gh],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(Cse)},lineMarker(e,t,s){return s.some(r=>r.toDOM)?null:new TO(BO(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,s)=>{for(let r of e.state.facet(Pse)){let a=r(e,t,s);if(a)return a}return null},lineMarkerChange:e=>e.startState.facet(Gh)!=e.state.facet(Gh),initialSpacer(e){return new TO(BO(e,C3(e.state.doc.lines)))},updateSpacer(e,t){let s=BO(t.view,C3(t.view.state.doc.lines));return s==e.number?e:new TO(s)},domEventHandlers:n.facet(Gh).domEventHandlers,side:"before"}));function Vk(n={}){return[Gh.of(n),ZF(),Ase]}function C3(n){let e=9;for(;e<n;)e=e*10+9;return e}const Ese=new class extends yc{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Mse=K0.compute(["selection"],n=>{let e=[],t=-1;for(let s of n.selection.ranges){let r=n.doc.lineAt(s.head).from;r>t&&(t=r,e.push(Ese.range(r)))}return Zn.of(e)});function Dse(){return Mse}const qF=1024;let Tse=0;class FO{constructor(e,t){this.from=e,this.to=t}}class Qn{constructor(e={}){this.id=Tse++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ii.match(e)),t=>{let s=e(t);return s===void 0?null:[this,s]}}}Qn.closedBy=new Qn({deserialize:n=>n.split(" ")});Qn.openedBy=new Qn({deserialize:n=>n.split(" ")});Qn.group=new Qn({deserialize:n=>n.split(" ")});Qn.isolate=new Qn({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Qn.contextHash=new Qn({perNode:!0});Qn.lookAhead=new Qn({perNode:!0});Qn.mounted=new Qn({perNode:!0});class Dm{constructor(e,t,s,r=!1){this.tree=e,this.overlay=t,this.parser=s,this.bracketed=r}static get(e){return e&&e.props&&e.props[Qn.mounted.id]}}const Bse=Object.create(null);class ii{constructor(e,t,s,r=0){this.name=e,this.props=t,this.id=s,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Bse,s=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new ii(e.name||"",t,e.id,s);if(e.props){for(let a of e.props)if(Array.isArray(a)||(a=a(r)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[a[0].id]=a[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Qn.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let s in e)for(let r of s.split(" "))t[r]=e[s];return s=>{for(let r=s.prop(Qn.group),a=-1;a<(r?r.length:0);a++){let i=t[a<0?s.name:r[a]];if(i)return i}}}}ii.none=new ii("",Object.create(null),0,8);class iP{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let s of this.types){let r=null;for(let a of e){let i=a(s);if(i){r||(r=Object.assign({},s.props));let o=i[1],l=i[0];l.combine&&l.id in r&&(o=l.combine(r[l.id],o)),r[l.id]=o}}t.push(r?new ii(s.name,r,s.id,s.flags):s)}return new iP(t)}}const _g=new WeakMap,P3=new WeakMap;var Gs;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays",n[n.EnterBracketed=16]="EnterBracketed"})(Gs||(Gs={}));class lr{constructor(e,t,s,r,a){if(this.type=e,this.children=t,this.positions=s,this.length=r,this.props=null,a&&a.length){this.props=Object.create(null);for(let[i,o]of a)this.props[typeof i=="number"?i:i.id]=o}}toString(){let e=Dm.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let s of this.children){let r=s.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new zk(this.topNode,e)}cursorAt(e,t=0,s=0){let r=_g.get(this)||this.topNode,a=new zk(r);return a.moveTo(e,t),_g.set(this,a._tree),a}get topNode(){return new ri(this,0,0,null)}resolve(e,t=0){let s=Ym(_g.get(this)||this.topNode,e,t,!1);return _g.set(this,s),s}resolveInner(e,t=0){let s=Ym(P3.get(this)||this.topNode,e,t,!0);return P3.set(this,s),s}resolveStack(e,t=0){return Nse(this,e,t)}iterate(e){let{enter:t,leave:s,from:r=0,to:a=this.length}=e,i=e.mode||0,o=(i&Gs.IncludeAnonymous)>0;for(let l=this.cursor(i|Gs.IncludeAnonymous);;){let c=!1;if(l.from<=a&&l.to>=r&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&s&&(o||!l.type.isAnonymous)&&s(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:cP(ii.none,this.children,this.positions,0,this.children.length,0,this.length,(t,s,r)=>new lr(this.type,t,s,r,this.propValues),e.makeTree||((t,s,r)=>new lr(ii.none,t,s,r)))}static build(e){return _se(e)}}lr.empty=new lr(ii.none,[],[],0);class oP{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new oP(this.buffer,this.index)}}class du{constructor(e,t,s){this.buffer=e,this.length=t,this.set=s}get type(){return ii.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],s=this.buffer[e+3],r=this.set.types[t],a=r.name;if(/\W/.test(a)&&!r.isError&&(a=JSON.stringify(a)),e+=4,s==e)return a;let i=[];for(;e<s;)i.push(this.childString(e)),e=this.buffer[e+3];return a+"("+i.join(",")+")"}findChild(e,t,s,r,a){let{buffer:i}=this,o=-1;for(let l=e;l!=t&&!(UF(a,r,i[l+1],i[l+2])&&(o=l,s>0));l=i[l+3]);return o}slice(e,t,s){let r=this.buffer,a=new Uint16Array(t-e),i=0;for(let o=e,l=0;o<t;){a[l++]=r[o++],a[l++]=r[o++]-s;let c=a[l++]=r[o++]-s;a[l++]=r[o++]-e,i=Math.max(i,c)}return new du(a,i,this.set)}}function UF(n,e,t,s){switch(n){case-2:return t<e;case-1:return s>=e&&t<e;case 0:return t<e&&s>e;case 1:return t<=e&&s>e;case 2:return s>e;case 4:return!0}}function Ym(n,e,t,s){for(var r;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let i=!s&&n instanceof ri&&n.index<0?null:n.parent;if(!i)return n;n=i}let a=s?0:Gs.IgnoreOverlays;if(s)for(let i=n,o=i.parent;o;i=o,o=i.parent)i instanceof ri&&i.index<0&&((r=o.enter(e,t,a))===null||r===void 0?void 0:r.from)!=i.from&&(n=o);for(;;){let i=n.enter(e,t,a);if(!i)return n;n=i}}class WF{cursor(e=0){return new zk(this,e)}getChild(e,t=null,s=null){let r=A3(this,e,t,s);return r.length?r[0]:null}getChildren(e,t=null,s=null){return A3(this,e,t,s)}resolve(e,t=0){return Ym(this,e,t,!1)}resolveInner(e,t=0){return Ym(this,e,t,!0)}matchContext(e){return Zk(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),s=this;for(;t;){let r=t.lastChild;if(!r||r.to!=t.to)break;r.type.isError&&r.from==r.to?(s=t,t=r.prevSibling):t=r}return s}get node(){return this}get next(){return this.parent}}class ri extends WF{constructor(e,t,s,r){super(),this._tree=e,this.from=t,this.index=s,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,s,r,a=0){for(let i=this;;){for(let{children:o,positions:l}=i._tree,c=t>0?o.length:-1;e!=c;e+=t){let u=o[e],h=l[e]+i.from,d;if(!(!(a&Gs.EnterBracketed&&u instanceof lr&&(d=Dm.get(u))&&!d.overlay&&d.bracketed&&s>=h&&s<=h+u.length)&&!UF(r,s,h,h+u.length))){if(u instanceof du){if(a&Gs.ExcludeBuffers)continue;let m=u.findChild(0,u.buffer.length,t,s-h,r);if(m>-1)return new kl(new Fse(i,u,e,h),null,m)}else if(a&Gs.IncludeAnonymous||!u.type.isAnonymous||lP(u)){let m;if(!(a&Gs.IgnoreMounts)&&(m=Dm.get(u))&&!m.overlay)return new ri(m.tree,h,e,i);let y=new ri(u,h,e,i);return a&Gs.IncludeAnonymous||!y.type.isAnonymous?y:y.nextChild(t<0?u.children.length-1:0,t,s,r,a)}}}if(a&Gs.IncludeAnonymous||!i.type.isAnonymous||(i.index>=0?e=i.index+t:e=t<0?-1:i._parent._tree.children.length,i=i._parent,!i))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,s=0){let r;if(!(s&Gs.IgnoreOverlays)&&(r=Dm.get(this._tree))&&r.overlay){let a=e-this.from,i=s&Gs.EnterBracketed&&r.bracketed;for(let{from:o,to:l}of r.overlay)if((t>0||i?o<=a:o<a)&&(t<0||i?l>=a:l>a))return new ri(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,s)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function A3(n,e,t,s){let r=n.cursor(),a=[];if(!r.firstChild())return a;if(t!=null){for(let i=!1;!i;)if(i=r.type.is(t),!r.nextSibling())return a}for(;;){if(s!=null&&r.type.is(s))return a;if(r.type.is(e)&&a.push(r.node),!r.nextSibling())return s==null?a:[]}}function Zk(n,e,t=e.length-1){for(let s=n;t>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(e[t]&&e[t]!=s.name)return!1;t--}}return!0}class Fse{constructor(e,t,s,r){this.parent=e,this.buffer=t,this.index=s,this.start=r}}class kl extends WF{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,s){super(),this.context=e,this._parent=t,this.index=s,this.type=e.buffer.set.types[e.buffer.buffer[s]]}child(e,t,s){let{buffer:r}=this.context,a=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,s);return a<0?null:new kl(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,s=0){if(s&Gs.ExcludeBuffers)return null;let{buffer:r}=this.context,a=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return a<0?null:new kl(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new kl(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new kl(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:s}=this.context,r=this.index+4,a=s.buffer[this.index+3];if(a>r){let i=s.buffer[this.index+1];e.push(s.slice(r,a,i)),t.push(0)}return new lr(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function GF(n){if(!n.length)return null;let e=0,t=n[0];for(let a=1;a<n.length;a++){let i=n[a];(i.from>t.from||i.to<t.to)&&(t=i,e=a)}let s=t instanceof ri&&t.index<0?null:t.parent,r=n.slice();return s?r[e]=s:r.splice(e,1),new $se(r,t)}class $se{constructor(e,t){this.heads=e,this.node=t}get next(){return GF(this.heads)}}function Nse(n,e,t){let s=n.resolveInner(e,t),r=null;for(let a=s instanceof ri?s:s.context.parent;a;a=a.parent)if(a.index<0){let i=a.parent;(r||(r=[s])).push(i.resolve(e,t)),a=i}else{let i=Dm.get(a.tree);if(i&&i.overlay&&i.overlay[0].from<=e&&i.overlay[i.overlay.length-1].to>=e){let o=new ri(i.tree,i.overlay[0].from+a.from,-1,a);(r||(r=[s])).push(Ym(o,e,t,!1))}}return r?GF(r):s}class zk{get name(){return this.type.name}constructor(e,t=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~Gs.EnterBracketed,e instanceof ri)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let s=e._parent;s;s=s._parent)this.stack.unshift(s.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:s,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=s+r.buffer[e+1],this.to=s+r.buffer[e+2],!0}yield(e){return e?e instanceof ri?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,s){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,s,this.mode));let{buffer:r}=this.buffer,a=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,s);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,s=this.mode){return this.buffer?s&Gs.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,s))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Gs.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Gs.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,s=this.stack.length-1;if(e<0){let r=s<0?0:this.stack[s]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(s<0?t.buffer.length:t.buffer[this.stack[s]+3]))return this.yieldBuf(r)}return s<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,s,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(r.buffer.buffer[a+3]<this.index)return!1;({index:t,parent:s}=r)}else({index:t,_parent:s}=this._tree);for(;s;{index:t,_parent:s}=s)if(t>-1)for(let a=t+e,i=e<0?-1:s._tree.children.length;a!=i;a+=e){let o=s._tree.children[a];if(this.mode&Gs.IncludeAnonymous||o instanceof du||!o.type.isAnonymous||lP(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,s=0;if(e&&e.context==this.buffer)e:for(let r=this.index,a=this.stack.length;a>=0;){for(let i=e;i;i=i._parent)if(i.index==r){if(r==this.index)return i;t=i,s=a+1;break e}r=this.stack[--a]}for(let r=s;r<this.stack.length;r++)t=new kl(this.buffer,t,this.stack[r]);return this.bufferNode=new kl(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let s=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){s++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&t&&t(this),r=this.type.isAnonymous,!s)return;if(this.nextSibling())break;this.parent(),s--,r=!0}}}matchContext(e){if(!this.buffer)return Zk(this.node.parent,e);let{buffer:t}=this.buffer,{types:s}=t.set;for(let r=e.length-1,a=this.stack.length-1;r>=0;a--){if(a<0)return Zk(this._tree,e,r);let i=s[t.buffer[this.stack[a]]];if(!i.isAnonymous){if(e[r]&&e[r]!=i.name)return!1;r--}}return!0}}function lP(n){return n.children.some(e=>e instanceof du||!e.type.isAnonymous||lP(e))}function _se(n){var e;let{buffer:t,nodeSet:s,maxBufferLength:r=qF,reused:a=[],minRepeatType:i=s.types.length}=n,o=Array.isArray(t)?new oP(t,t.length):t,l=s.types,c=0,u=0;function h($,L,I,q,ce,ee){let{id:he,start:H,end:me,size:Oe}=o,Pe=u,De=c;if(Oe<0)if(o.next(),Oe==-1){let Ke=a[he];I.push(Ke),q.push(H-$);return}else if(Oe==-3){c=he;return}else if(Oe==-4){u=he;return}else throw new RangeError(`Unrecognized record size: ${Oe}`);let Se=l[he],ae,Ee,Qe=H-$;if(me-H<=r&&(Ee=S(o.pos-L,ce))){let Ke=new Uint16Array(Ee.size-Ee.skip),ge=o.pos-Ee.size,Ye=Ke.length;for(;o.pos>ge;)Ye=A(Ee.start,Ke,Ye);ae=new du(Ke,me-Ee.start,s),Qe=Ee.start-$}else{let Ke=o.pos-Oe;o.next();let ge=[],Ye=[],yt=he>=i?he:-1,Xe=0,Ge=me;for(;o.pos>Ke;)yt>=0&&o.id==yt&&o.size>=0?(o.end<=Ge-r&&(y(ge,Ye,H,Xe,o.end,Ge,yt,Pe,De),Xe=ge.length,Ge=o.end),o.next()):ee>2500?d(H,Ke,ge,Ye):h(H,Ke,ge,Ye,yt,ee+1);if(yt>=0&&Xe>0&&Xe<ge.length&&y(ge,Ye,H,Xe,H,Ge,yt,Pe,De),ge.reverse(),Ye.reverse(),yt>-1&&Xe>0){let Ct=m(Se,De);ae=cP(Se,ge,Ye,0,ge.length,0,me-H,Ct,Ct)}else ae=O(Se,ge,Ye,me-H,Pe-me,De)}I.push(ae),q.push(Qe)}function d($,L,I,q){let ce=[],ee=0,he=-1;for(;o.pos>L;){let{id:H,start:me,end:Oe,size:Pe}=o;if(Pe>4)o.next();else{if(he>-1&&me<he)break;he<0&&(he=Oe-r),ce.push(H,me,Oe),ee++,o.next()}}if(ee){let H=new Uint16Array(ee*4),me=ce[ce.length-2];for(let Oe=ce.length-3,Pe=0;Oe>=0;Oe-=3)H[Pe++]=ce[Oe],H[Pe++]=ce[Oe+1]-me,H[Pe++]=ce[Oe+2]-me,H[Pe++]=Pe;I.push(new du(H,ce[2]-me,s)),q.push(me-$)}}function m($,L){return(I,q,ce)=>{let ee=0,he=I.length-1,H,me;if(he>=0&&(H=I[he])instanceof lr){if(!he&&H.type==$&&H.length==ce)return H;(me=H.prop(Qn.lookAhead))&&(ee=q[he]+H.length+me)}return O($,I,q,ce,ee,L)}}function y($,L,I,q,ce,ee,he,H,me){let Oe=[],Pe=[];for(;$.length>q;)Oe.push($.pop()),Pe.push(L.pop()+I-ce);$.push(O(s.types[he],Oe,Pe,ee-ce,H-ee,me)),L.push(ce-I)}function O($,L,I,q,ce,ee,he){if(ee){let H=[Qn.contextHash,ee];he=he?[H].concat(he):[H]}if(ce>25){let H=[Qn.lookAhead,ce];he=he?[H].concat(he):[H]}return new lr($,L,I,q,he)}function S($,L){let I=o.fork(),q=0,ce=0,ee=0,he=I.end-r,H={size:0,start:0,skip:0};e:for(let me=I.pos-$;I.pos>me;){let Oe=I.size;if(I.id==L&&Oe>=0){H.size=q,H.start=ce,H.skip=ee,ee+=4,q+=4,I.next();continue}let Pe=I.pos-Oe;if(Oe<0||Pe<me||I.start<he)break;let De=I.id>=i?4:0,Se=I.start;for(I.next();I.pos>Pe;){if(I.size<0)if(I.size==-3||I.size==-4)De+=4;else break e;else I.id>=i&&(De+=4);I.next()}ce=Se,q+=Oe,ee+=De}return(L<0||q==$)&&(H.size=q,H.start=ce,H.skip=ee),H.size>4?H:void 0}function A($,L,I){let{id:q,start:ce,end:ee,size:he}=o;if(o.next(),he>=0&&q<i){let H=I;if(he>4){let me=o.pos-(he-4);for(;o.pos>me;)I=A($,L,I)}L[--I]=H,L[--I]=ee-$,L[--I]=ce-$,L[--I]=q}else he==-3?c=q:he==-4&&(u=q);return I}let F=[],j=[];for(;o.pos>0;)h(n.start||0,n.bufferStart||0,F,j,-1,0);let N=(e=n.length)!==null&&e!==void 0?e:F.length?j[0]+F[0].length:0;return new lr(l[n.topID],F.reverse(),j.reverse(),N)}const E3=new WeakMap;function J0(n,e){if(!n.isAnonymous||e instanceof du||e.type!=n)return 1;let t=E3.get(e);if(t==null){t=1;for(let s of e.children){if(s.type!=n||!(s instanceof lr)){t=1;break}t+=J0(n,s)}E3.set(e,t)}return t}function cP(n,e,t,s,r,a,i,o,l){let c=0;for(let y=s;y<r;y++)c+=J0(n,e[y]);let u=Math.ceil(c*1.5/8),h=[],d=[];function m(y,O,S,A,F){for(let j=S;j<A;){let N=j,$=O[j],L=J0(n,y[j]);for(j++;j<A;j++){let I=J0(n,y[j]);if(L+I>=u)break;L+=I}if(j==N+1){if(L>u){let I=y[N];m(I.children,I.positions,0,I.children.length,O[N]+F);continue}h.push(y[N])}else{let I=O[j-1]+y[j-1].length-$;h.push(cP(n,y,O,N,j,$,I,null,l))}d.push($+F-a)}}return m(e,t,s,r,0),(o||l)(h,d,i)}class Rse{constructor(){this.map=new WeakMap}setBuffer(e,t,s){let r=this.map.get(e);r||this.map.set(e,r=new Map),r.set(t,s)}getBuffer(e,t){let s=this.map.get(e);return s&&s.get(t)}set(e,t){e instanceof kl?this.setBuffer(e.context.buffer,e.index,t):e instanceof ri&&this.map.set(e.tree,t)}get(e){return e instanceof kl?this.getBuffer(e.context.buffer,e.index):e instanceof ri?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class ih{constructor(e,t,s,r,a=!1,i=!1){this.from=e,this.to=t,this.tree=s,this.offset=r,this.open=(a?1:0)|(i?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],s=!1){let r=[new ih(0,e.length,e,0,!1,s)];for(let a of t)a.to>e.length&&r.push(a);return r}static applyChanges(e,t,s=128){if(!t.length)return e;let r=[],a=1,i=e.length?e[0]:null;for(let o=0,l=0,c=0;;o++){let u=o<t.length?t[o]:null,h=u?u.fromA:1e9;if(h-l>=s)for(;i&&i.from<h;){let d=i;if(l>=d.from||h<=d.to||c){let m=Math.max(d.from,l)-c,y=Math.min(d.to,h)-c;d=m>=y?null:new ih(m,y,d.tree,d.offset+c,o>0,!!u)}if(d&&r.push(d),i.to>h)break;i=a<e.length?e[a++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return r}}let XF=class{startParse(e,t,s){return typeof e=="string"&&(e=new Ise(e)),s=s?s.length?s.map(r=>new FO(r.from,r.to)):[new FO(0,0)]:[new FO(0,e.length)],this.createParse(e,t||[],s)}parse(e,t,s){let r=this.startParse(e,t,s);for(;;){let a=r.advance();if(a)return a}}};class Ise{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Qn({perNode:!0});var M3={};class qb{constructor(e,t,s,r,a,i,o,l,c,u=0,h){this.p=e,this.stack=t,this.state=s,this.reducePos=r,this.pos=a,this.score=i,this.buffer=o,this.bufferBase=l,this.curContext=c,this.lookAhead=u,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,s=0){let r=e.parser.context;return new qb(e,[],t,s,s,0,[],0,r?new D3(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let s=e>>19,r=e&65535,{parser:a}=this.p,i=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),o=a.dynamicPrecedence(r);if(o&&(this.score+=o),s==0){this.pushState(a.getGoto(this.state,r,!0),this.reducePos),r<a.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,i?8:4,!0),this.reduceContext(r,this.reducePos);return}let l=this.stack.length-(s-1)*3-(e&262144?6:0),c=l?this.stack[l-2]:this.p.ranges[0].from,u=this.reducePos-c;u>=2e3&&!(!((t=this.p.parser.nodeSet.types[r])===null||t===void 0)&&t.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=u):this.p.lastBigReductionSize<u&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=u));let h=l?this.stack[l-1]:0,d=this.bufferBase+this.buffer.length-h;if(r<a.minRepeatTerm||e&131072){let m=a.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,c,m,d+4,!0)}if(e&262144)this.state=this.stack[l];else{let m=this.stack[l-3];this.state=a.getGoto(m,r,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(r,c)}storeNode(e,t,s,r=4,a=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let i=this,o=this.buffer.length;if(o==0&&i.parent&&(o=i.bufferBase-i.parent.bufferBase,i=i.parent),o>0&&i.buffer[o-4]==0&&i.buffer[o-1]>-1){if(t==s)return;if(i.buffer[o-2]>=t){i.buffer[o-2]=s;return}}}if(!a||this.pos==s)this.buffer.push(e,t,s,r);else{let i=this.buffer.length;if(i>0&&(this.buffer[i-4]!=0||this.buffer[i-1]<0)){let o=!1;for(let l=i;l>0&&this.buffer[l-2]>s;l-=4)if(this.buffer[l-1]>=0){o=!0;break}if(o)for(;i>0&&this.buffer[i-2]>s;)this.buffer[i]=this.buffer[i-4],this.buffer[i+1]=this.buffer[i-3],this.buffer[i+2]=this.buffer[i-2],this.buffer[i+3]=this.buffer[i-1],i-=4,r>4&&(r-=4)}this.buffer[i]=e,this.buffer[i+1]=t,this.buffer[i+2]=s,this.buffer[i+3]=r}}shift(e,t,s,r){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let a=e,{parser:i}=this.p;this.pos=r;let o=i.stateFlag(a,1);!o&&(r>s||t<=i.maxNode)&&(this.reducePos=r),this.pushState(a,o?s:Math.min(s,this.reducePos)),this.shiftContext(t,s),t<=i.maxNode&&this.buffer.push(t,s,r,4)}else this.pos=r,this.shiftContext(t,s),t<=this.p.parser.maxNode&&this.buffer.push(t,s,r,4)}apply(e,t,s,r){e&65536?this.reduce(e):this.shift(e,t,s,r)}useNode(e,t){let s=this.p.reused.length-1;(s<0||this.p.reused[s]!=e)&&(this.p.reused.push(e),s++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(s,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let s=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new qb(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,s,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let s=e<=this.p.parser.maxNode;s&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,s?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new Lse(this);;){let s=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(s==0)return!1;if((s&65536)==0)return!0;t.reduce(s)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let r=[];for(let a=0,i;a<t.length;a+=2)(i=t[a+1])!=this.state&&this.p.parser.hasAction(i,e)&&r.push(t[a],i);if(this.stack.length<120)for(let a=0;r.length<8&&a<t.length;a+=2){let i=t[a+1];r.some((o,l)=>l&1&&o==i)||r.push(t[a],i)}t=r}let s=[];for(let r=0;r<t.length&&s.length<4;r+=2){let a=t[r+1];if(a==this.state)continue;let i=this.split();i.pushState(a,this.pos),i.storeNode(0,i.pos,i.pos,4,!0),i.shiftContext(t[r],this.pos),i.reducePos=this.pos,i.score-=200,s.push(i)}return s}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let s=t>>19,r=t&65535,a=this.stack.length-s*3;if(a<0||e.getGoto(this.stack[a],r,!1)<0){let i=this.findForcedReduction();if(i==null)return!1;t=i}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],s=(r,a)=>{if(!t.includes(r))return t.push(r),e.allActions(r,i=>{if(!(i&393216))if(i&65536){let o=(i>>19)-a;if(o>1){let l=i&65535,c=this.stack.length-o*3;if(c>=0&&e.getGoto(this.stack[c],l,!1)>=0)return o<<19|65536|l}}else{let o=s(i,a+1);if(o!=null)return o}})};return s(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new D3(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){return e<=this.lookAhead?!1:(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class D3{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class Lse{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,s=e>>19;s==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(s-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r}}class Ub{constructor(e,t,s){this.stack=e,this.pos=t,this.index=s,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Ub(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Ub(this.stack,this.pos,this.index)}}function lm(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let s=0,r=0;s<n.length;){let a=0;for(;;){let i=n.charCodeAt(s++),o=!1;if(i==126){a=65535;break}i>=92&&i--,i>=34&&i--;let l=i-32;if(l>=46&&(l-=46,o=!0),a+=l,o)break;a*=46}t?t[r++]=a:t=new e(a)}return t}class eb{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const T3=new eb;class Qse{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=T3,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let s=this.range,r=this.rangeIndex,a=this.pos+e;for(;a<s.from;){if(!r)return null;let i=this.ranges[--r];a-=s.from-i.to,s=i}for(;t<0?a>s.to:a>=s.to;){if(r==this.ranges.length-1)return null;let i=this.ranges[++r];a+=i.from-s.to,s=i}return a}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,s,r;if(t>=0&&t<this.chunk.length)s=this.pos+e,r=this.chunk.charCodeAt(t);else{let a=this.resolveOffset(e,1);if(a==null)return-1;if(s=a,s>=this.chunk2Pos&&s<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(s-this.chunk2Pos);else{let i=this.rangeIndex,o=this.range;for(;o.to<=s;)o=this.ranges[++i];this.chunk2=this.input.chunk(this.chunk2Pos=s),s+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-s)),r=this.chunk2.charCodeAt(0)}}return s>=this.token.lookAhead&&(this.token.lookAhead=s+1),r}acceptToken(e,t=0){let s=t?this.resolveOffset(t,-1):this.pos;if(s==null||s<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=s}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=T3,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let s="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(s+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return s}}class od{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:s}=t.p;HF(this.data,e,t,this.id,s.data,s.tokenPrecTable)}}od.prototype.contextual=od.prototype.fallback=od.prototype.extend=!1;class qk{constructor(e,t,s){this.precTable=t,this.elseToken=s,this.data=typeof e=="string"?lm(e):e}token(e,t){let s=e.pos,r=0;for(;;){let a=e.next<0,i=e.resolveOffset(1,1);if(HF(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(a||r++,i==null)break;e.reset(i,e.token)}r&&(e.reset(s,e.token),e.acceptToken(this.elseToken,r))}}qk.prototype.contextual=od.prototype.fallback=od.prototype.extend=!1;class Wf{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function HF(n,e,t,s,r,a){let i=0,o=1<<s,{dialect:l}=t.p.parser;e:for(;(o&n[i])!=0;){let c=n[i+1];for(let m=i+3;m<c;m+=2)if((n[m+1]&o)>0){let y=n[m];if(l.allows(y)&&(e.token.value==-1||e.token.value==y||jse(y,e.token.value,r,a))){e.acceptToken(y);break}}let u=e.next,h=0,d=n[i+2];if(e.next<0&&d>h&&n[c+d*3-3]==65535){i=n[c+d*3-1];continue e}for(;h<d;){let m=h+d>>1,y=c+m+(m<<1),O=n[y],S=n[y+1]||65536;if(u<O)d=m;else if(u>=S)h=m+1;else{i=n[y+2],e.advance();continue e}}break}}function B3(n,e,t){for(let s=e,r;(r=n[s])!=65535;s++)if(r==t)return s-e;return-1}function jse(n,e,t,s){let r=B3(t,s,e);return r<0||B3(t,s,n)<r}const fi=typeof process<"u"&&M3&&/\bparse\b/.test(M3.LOG);let $O=null;function F3(n,e,t){let s=n.cursor(Gs.IncludeAnonymous);for(s.moveTo(e);;)if(!(t<0?s.childBefore(e):s.childAfter(e)))for(;;){if((t<0?s.to<e:s.from>e)&&!s.type.isError)return t<0?Math.max(0,Math.min(s.to-1,e-25)):Math.min(n.length,Math.max(s.from+1,e+25));if(t<0?s.prevSibling():s.nextSibling())break;if(!s.parent())return t<0?0:n.length}}class Vse{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?F3(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?F3(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let s=this.trees[t],r=this.index[t];if(r==s.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let a=s.children[r],i=this.start[t]+s.positions[r];if(i>e)return this.nextStart=i,null;if(a instanceof lr){if(i==e){if(i<this.safeFrom)return null;let o=i+a.length;if(o<=this.safeTo){let l=a.prop(Qn.lookAhead);if(!l||o+l<this.fragment.to)return a}}this.index[t]++,i+a.length>=Math.max(this.safeFrom,e)&&(this.trees.push(a),this.start.push(i),this.index.push(0))}else this.index[t]++,this.nextStart=i+a.length}}}class Zse{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(s=>new eb)}getActions(e){let t=0,s=null,{parser:r}=e.p,{tokenizers:a}=r,i=r.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,l=0;for(let c=0;c<a.length;c++){if((1<<c&i)==0)continue;let u=a[c],h=this.tokens[c];if(!(s&&!u.fallback)&&((u.contextual||h.start!=e.pos||h.mask!=i||h.context!=o)&&(this.updateCachedToken(h,u,e),h.mask=i,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let d=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!u.extend&&(s=h,t>d))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!s&&e.pos==this.stream.end&&(s=new eb,s.value=e.p.parser.eofTerm,s.start=s.end=e.pos,t=this.addActions(e,s.value,s.end,t)),this.mainToken=s,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new eb,{pos:s,p:r}=e;return t.start=s,t.end=Math.min(s+1,r.stream.end),t.value=s==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,s){let r=this.stream.clipPos(s.pos);if(t.token(this.stream.reset(r,e),s),e.value>-1){let{parser:a}=s.p;for(let i=0;i<a.specialized.length;i++)if(a.specialized[i]==e.value){let o=a.specializers[i](this.stream.read(e.start,e.end),s);if(o>=0&&s.p.parser.dialect.allows(o>>1)){(o&1)==0?e.value=o>>1:e.extended=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,t,s,r){for(let a=0;a<r;a+=3)if(this.actions[a]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=s,r}addActions(e,t,s,r){let{state:a}=e,{parser:i}=e.p,{data:o}=i;for(let l=0;l<2;l++)for(let c=i.stateSlot(a,l?2:1);;c+=3){if(o[c]==65535)if(o[c+1]==1)c=rc(o,c+2);else{r==0&&o[c+1]==2&&(r=this.putAction(rc(o,c+2),t,s,r));break}o[c]==t&&(r=this.putAction(rc(o,c+1),t,s,r))}return r}}class zse{constructor(e,t,s,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new Qse(t,r),this.tokens=new Zse(e,this.stream),this.topTerm=e.top[1];let{from:a}=r[0];this.stacks=[qb.start(this,e.top[0],a)],this.fragments=s.length&&this.stream.end-a>e.bufferLength*4?new Vse(s,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,s=this.stacks=[],r,a;if(this.bigReductionCount>300&&e.length==1){let[i]=e;for(;i.forceReduce()&&i.stack.length&&i.stack[i.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let i=0;i<e.length;i++){let o=e[i];for(;;){if(this.tokens.mainToken=null,o.pos>t)s.push(o);else{if(this.advanceStack(o,s,e))continue;{r||(r=[],a=[]),r.push(o);let l=this.tokens.getMainToken(o);a.push(l.value,l.end)}}break}}if(!s.length){let i=r&&Wse(r);if(i)return fi&&console.log("Finish with "+this.stackID(i)),this.stackToTree(i);if(this.parser.strict)throw fi&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&r){let i=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,a,s);if(i)return fi&&console.log("Force-finish "+this.stackID(i)),this.stackToTree(i.forceAll())}if(this.recovering){let i=this.recovering==1?1:this.recovering*3;if(s.length>i)for(s.sort((o,l)=>l.score-o.score);s.length>i;)s.pop();s.some(o=>o.reducePos>t)&&this.recovering--}else if(s.length>1){e:for(let i=0;i<s.length-1;i++){let o=s[i];for(let l=i+1;l<s.length;l++){let c=s[l];if(o.sameState(c)||o.buffer.length>500&&c.buffer.length>500)if((o.score-c.score||o.buffer.length-c.buffer.length)>0)s.splice(l--,1);else{s.splice(i--,1);continue e}}}s.length>12&&(s.sort((i,o)=>o.score-i.score),s.splice(12,s.length-12))}this.minStackPos=s[0].pos;for(let i=1;i<s.length;i++)s[i].pos<this.minStackPos&&(this.minStackPos=s[i].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,s){let r=e.pos,{parser:a}=this,i=fi?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let c=e.curContext&&e.curContext.tracker.strict,u=c?e.curContext.hash:0;for(let h=this.fragments.nodeAt(r);h;){let d=this.parser.nodeSet.types[h.type.id]==h.type?a.getGoto(e.state,h.type.id):-1;if(d>-1&&h.length&&(!c||(h.prop(Qn.contextHash)||0)==u))return e.useNode(h,d),fi&&console.log(i+this.stackID(e)+` (via reuse of ${a.getName(h.type.id)})`),!0;if(!(h instanceof lr)||h.children.length==0||h.positions[0]>0)break;let m=h.children[0];if(m instanceof lr&&h.positions[0]==0)h=m;else break}}let o=a.stateSlot(e.state,4);if(o>0)return e.reduce(o),fi&&console.log(i+this.stackID(e)+` (via always-reduce ${a.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let c=0;c<l.length;){let u=l[c++],h=l[c++],d=l[c++],m=c==l.length||!s,y=m?e:e.split(),O=this.tokens.mainToken;if(y.apply(u,h,O?O.start:y.pos,d),fi&&console.log(i+this.stackID(y)+` (via ${(u&65536)==0?"shift":`reduce of ${a.getName(u&65535)}`} for ${a.getName(h)} @ ${r}${y==e?"":", split"})`),m)return!0;y.pos>r?t.push(y):s.push(y)}return!1}advanceFully(e,t){let s=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>s)return $3(e,t),!0}}runRecovery(e,t,s){let r=null,a=!1;for(let i=0;i<e.length;i++){let o=e[i],l=t[i<<1],c=t[(i<<1)+1],u=fi?this.stackID(o)+" -> ":"";if(o.deadEnd&&(a||(a=!0,o.restart(),fi&&console.log(u+this.stackID(o)+" (restarted)"),this.advanceFully(o,s))))continue;let h=o.split(),d=u;for(let m=0;m<10&&h.forceReduce()&&(fi&&console.log(d+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,s));m++)fi&&(d=this.stackID(h)+" -> ");for(let m of o.recoverByInsert(l))fi&&console.log(u+this.stackID(m)+" (via recover-insert)"),this.advanceFully(m,s);this.stream.end>o.pos?(c==o.pos&&(c++,l=0),o.recoverByDelete(l,c),fi&&console.log(u+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),$3(o,s)):(!r||r.score<h.score)&&(r=h)}return r}stackToTree(e){return e.close(),lr.build({buffer:Ub.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=($O||($O=new WeakMap)).get(e);return t||$O.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function $3(n,e){for(let t=0;t<e.length;t++){let s=e[t];if(s.pos==n.pos&&s.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class qse{constructor(e,t,s){this.source=e,this.flags=t,this.disabled=s}allows(e){return!this.disabled||this.disabled[e]==0}}const NO=n=>n;class Use{constructor(e){this.start=e.start,this.shift=e.shift||NO,this.reduce=e.reduce||NO,this.reuse=e.reuse||NO,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class Wb extends XF{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let o=0;o<e.repeatNodeCount;o++)t.push("");let s=Object.keys(e.topRules).map(o=>e.topRules[o][1]),r=[];for(let o=0;o<t.length;o++)r.push([]);function a(o,l,c){r[o].push([l,l.deserialize(String(c))])}if(e.nodeProps)for(let o of e.nodeProps){let l=o[0];typeof l=="string"&&(l=Qn[l]);for(let c=1;c<o.length;){let u=o[c++];if(u>=0)a(u,l,o[c++]);else{let h=o[c+-u];for(let d=-u;d>0;d--)a(o[c++],l,h);c++}}}this.nodeSet=new iP(t.map((o,l)=>ii.define({name:l>=this.minRepeatTerm?void 0:o,id:l,props:r[l],top:s.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=qF;let i=lm(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(N3),this.states=lm(e.states,Uint32Array),this.data=lm(e.stateData),this.goto=lm(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new od(i,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,s){let r=new zse(this,e,t,s);for(let a of this.wrappers)r=a(r,e,t,s);return r}getGoto(e,t,s=!1){let r=this.goto;if(t>=r[0])return-1;for(let a=r[t+1];;){let i=r[a++],o=i&1,l=r[a++];if(o&&s)return l;for(let c=a+(i>>1);a<c;a++)if(r[a]==e)return l;if(o)return-1}}hasAction(e,t){let s=this.data;for(let r=0;r<2;r++)for(let a=this.stateSlot(e,r?2:1),i;;a+=3){if((i=s[a])==65535)if(s[a+1]==1)i=s[a=rc(s,a+2)];else{if(s[a+1]==2)return rc(s,a+2);break}if(i==t||i==0)return rc(s,a+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,s=>s==t?!0:null)}allActions(e,t){let s=this.stateSlot(e,4),r=s?t(s):void 0;for(let a=this.stateSlot(e,1);r==null;a+=3){if(this.data[a]==65535)if(this.data[a+1]==1)a=rc(this.data,a+2);else break;r=t(rc(this.data,a+1))}return r}nextStates(e){let t=[];for(let s=this.stateSlot(e,1);;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=rc(this.data,s+2);else break;if((this.data[s+2]&1)==0){let r=this.data[s+1];t.some((a,i)=>i&1&&a==r)||t.push(this.data[s],r)}}return t}configure(e){let t=Object.assign(Object.create(Wb.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let s=this.topRules[e.top];if(!s)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=s}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(s=>{let r=e.tokenizers.find(a=>a.from==s);return r?r.to:s})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((s,r)=>{let a=e.specializers.find(o=>o.from==s.external);if(!a)return s;let i=Object.assign(Object.assign({},s),{external:a.to});return t.specializers[r]=N3(i),i})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),s=t.map(()=>!1);if(e)for(let a of e.split(" ")){let i=t.indexOf(a);i>=0&&(s[i]=!0)}let r=null;for(let a=0;a<t.length;a++)if(!s[a])for(let i=this.dialects[t[a]],o;(o=this.data[i++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[o]=1;return new qse(e,s,r)}static deserialize(e){return new Wb(e)}}function rc(n,e){return n[e]|n[e+1]<<16}function Wse(n){let e=null;for(let t of n){let s=t.p.stoppedAt;(t.pos==t.p.stream.end||s!=null&&t.pos>s)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function N3(n){if(n.external){let e=n.extend?1:0;return(t,s)=>n.external(t,s)<<1|e}return n.get}let Gse=0;class Ui{constructor(e,t,s,r){this.name=e,this.set=t,this.base=s,this.modified=r,this.id=Gse++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let s=typeof e=="string"?e:"?";if(e instanceof Ui&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let r=new Ui(s,[],null,[]);if(r.set.push(r),t)for(let a of t.set)r.set.push(a);return r}static defineModifier(e){let t=new Gb(e);return s=>s.modified.indexOf(t)>-1?s:Gb.get(s.base||s,s.modified.concat(t).sort((r,a)=>r.id-a.id))}}let Xse=0;class Gb{constructor(e){this.name=e,this.instances=[],this.id=Xse++}static get(e,t){if(!t.length)return e;let s=t[0].instances.find(o=>o.base==e&&Hse(t,o.modified));if(s)return s;let r=[],a=new Ui(e.name,r,e,t);for(let o of t)o.instances.push(a);let i=Yse(t);for(let o of e.set)if(!o.modified.length)for(let l of i)r.push(Gb.get(o,l));return a}}function Hse(n,e){return n.length==e.length&&n.every((t,s)=>t==e[s])}function Yse(n){let e=[[]];for(let t=0;t<n.length;t++)for(let s=0,r=e.length;s<r;s++)e.push(e[s].concat(n[t]));return e.sort((t,s)=>s.length-t.length)}function YF(n){let e=Object.create(null);for(let t in n){let s=n[t];Array.isArray(s)||(s=[s]);for(let r of t.split(" "))if(r){let a=[],i=2,o=r;for(let h=0;;){if(o=="..."&&h>0&&h+3==r.length){i=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!d)throw new RangeError("Invalid path: "+r);if(a.push(d[0]=="*"?"":d[0][0]=='"'?JSON.parse(d[0]):d[0]),h+=d[0].length,h==r.length)break;let m=r[h++];if(h==r.length&&m=="!"){i=0;break}if(m!="/")throw new RangeError("Invalid path: "+r);o=r.slice(h)}let l=a.length-1,c=a[l];if(!c)throw new RangeError("Invalid path: "+r);let u=new Km(s,i,l>0?a.slice(0,l):null);e[c]=u.sort(e[c])}}return KF.add(e)}const KF=new Qn({combine(n,e){let t,s,r;for(;n||e;){if(!n||e&&n.depth>=e.depth?(r=e,e=e.next):(r=n,n=n.next),t&&t.mode==r.mode&&!r.context&&!t.context)continue;let a=new Km(r.tags,r.mode,r.context);t?t.next=a:s=a,t=a}return s}});class Km{constructor(e,t,s,r){this.tags=e,this.mode=t,this.context=s,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Km.empty=new Km([],2,null);function JF(n,e){let t=Object.create(null);for(let a of n)if(!Array.isArray(a.tag))t[a.tag.id]=a.class;else for(let i of a.tag)t[i.id]=a.class;let{scope:s,all:r=null}=e||{};return{style:a=>{let i=r;for(let o of a)for(let l of o.set){let c=t[l.id];if(c){i=i?i+" "+c:c;break}}return i},scope:s}}function Kse(n,e){let t=null;for(let s of n){let r=s.style(e);r&&(t=t?t+" "+r:r)}return t}function Jse(n,e,t,s=0,r=n.length){let a=new ere(s,Array.isArray(e)?e:[e],t);a.highlightRange(n.cursor(),s,r,"",a.highlighters),a.flush(r)}class ere{constructor(e,t,s){this.at=e,this.highlighters=t,this.span=s,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,s,r,a){let{type:i,from:o,to:l}=e;if(o>=s||l<=t)return;i.isTop&&(a=this.highlighters.filter(m=>!m.scope||m.scope(i)));let c=r,u=tre(e)||Km.empty,h=Kse(a,u.tags);if(h&&(c&&(c+=" "),c+=h,u.mode==1&&(r+=(r?" ":"")+h)),this.startSpan(Math.max(t,o),c),u.opaque)return;let d=e.tree&&e.tree.prop(Qn.mounted);if(d&&d.overlay){let m=e.node.enter(d.overlay[0].from+o,1),y=this.highlighters.filter(S=>!S.scope||S.scope(d.tree.type)),O=e.firstChild();for(let S=0,A=o;;S++){let F=S<d.overlay.length?d.overlay[S]:null,j=F?F.from+o:l,N=Math.max(t,A),$=Math.min(s,j);if(N<$&&O)for(;e.from<$&&(this.highlightRange(e,N,$,r,a),this.startSpan(Math.min($,e.to),c),!(e.to>=j||!e.nextSibling())););if(!F||j>s)break;A=F.to+o,A>t&&(this.highlightRange(m.cursor(),Math.max(t,F.from+o),Math.min(s,A),"",y),this.startSpan(Math.min(s,A),c))}O&&e.parent()}else if(e.firstChild()){d&&(r="");do if(!(e.to<=t)){if(e.from>=s)break;this.highlightRange(e,t,s,r,a),this.startSpan(Math.min(s,e.to),c)}while(e.nextSibling());e.parent()}}}function tre(n){let e=n.type.prop(KF);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const wt=Ui.define,Rg=wt(),_c=wt(),_3=wt(_c),R3=wt(_c),Rc=wt(),Ig=wt(Rc),_O=wt(Rc),cl=wt(),Fu=wt(cl),rl=wt(),al=wt(),Uk=wt(),Dp=wt(Uk),Lg=wt(),g={comment:Rg,lineComment:wt(Rg),blockComment:wt(Rg),docComment:wt(Rg),name:_c,variableName:wt(_c),typeName:_3,tagName:wt(_3),propertyName:R3,attributeName:wt(R3),className:wt(_c),labelName:wt(_c),namespace:wt(_c),macroName:wt(_c),literal:Rc,string:Ig,docString:wt(Ig),character:wt(Ig),attributeValue:wt(Ig),number:_O,integer:wt(_O),float:wt(_O),bool:wt(Rc),regexp:wt(Rc),escape:wt(Rc),color:wt(Rc),url:wt(Rc),keyword:rl,self:wt(rl),null:wt(rl),atom:wt(rl),unit:wt(rl),modifier:wt(rl),operatorKeyword:wt(rl),controlKeyword:wt(rl),definitionKeyword:wt(rl),moduleKeyword:wt(rl),operator:al,derefOperator:wt(al),arithmeticOperator:wt(al),logicOperator:wt(al),bitwiseOperator:wt(al),compareOperator:wt(al),updateOperator:wt(al),definitionOperator:wt(al),typeOperator:wt(al),controlOperator:wt(al),punctuation:Uk,separator:wt(Uk),bracket:Dp,angleBracket:wt(Dp),squareBracket:wt(Dp),paren:wt(Dp),brace:wt(Dp),content:cl,heading:Fu,heading1:wt(Fu),heading2:wt(Fu),heading3:wt(Fu),heading4:wt(Fu),heading5:wt(Fu),heading6:wt(Fu),contentSeparator:wt(cl),list:wt(cl),quote:wt(cl),emphasis:wt(cl),strong:wt(cl),link:wt(cl),monospace:wt(cl),strikethrough:wt(cl),inserted:wt(),deleted:wt(),changed:wt(),invalid:wt(),meta:Lg,documentMeta:wt(Lg),annotation:wt(Lg),processingInstruction:wt(Lg),definition:Ui.defineModifier("definition"),constant:Ui.defineModifier("constant"),function:Ui.defineModifier("function"),standard:Ui.defineModifier("standard"),local:Ui.defineModifier("local"),special:Ui.defineModifier("special")};for(let n in g){let e=g[n];e instanceof Ui&&(e.name=n)}JF([{tag:g.link,class:"tok-link"},{tag:g.heading,class:"tok-heading"},{tag:g.emphasis,class:"tok-emphasis"},{tag:g.strong,class:"tok-strong"},{tag:g.keyword,class:"tok-keyword"},{tag:g.atom,class:"tok-atom"},{tag:g.bool,class:"tok-bool"},{tag:g.url,class:"tok-url"},{tag:g.labelName,class:"tok-labelName"},{tag:g.inserted,class:"tok-inserted"},{tag:g.deleted,class:"tok-deleted"},{tag:g.literal,class:"tok-literal"},{tag:g.string,class:"tok-string"},{tag:g.number,class:"tok-number"},{tag:[g.regexp,g.escape,g.special(g.string)],class:"tok-string2"},{tag:g.variableName,class:"tok-variableName"},{tag:g.local(g.variableName),class:"tok-variableName tok-local"},{tag:g.definition(g.variableName),class:"tok-variableName tok-definition"},{tag:g.special(g.variableName),class:"tok-variableName2"},{tag:g.definition(g.propertyName),class:"tok-propertyName tok-definition"},{tag:g.typeName,class:"tok-typeName"},{tag:g.namespace,class:"tok-namespace"},{tag:g.className,class:"tok-className"},{tag:g.macroName,class:"tok-macroName"},{tag:g.propertyName,class:"tok-propertyName"},{tag:g.operator,class:"tok-operator"},{tag:g.comment,class:"tok-comment"},{tag:g.meta,class:"tok-meta"},{tag:g.invalid,class:"tok-invalid"},{tag:g.punctuation,class:"tok-punctuation"}]);const nre=316,sre=317,I3=1,rre=2,are=3,ire=4,ore=318,lre=320,cre=321,ure=5,hre=6,dre=0,Wk=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],e$=125,pre=59,Gk=47,mre=42,fre=43,gre=45,bre=60,yre=44,vre=63,Ore=46,wre=91,xre=new Use({start:!1,shift(n,e){return e==ure||e==hre||e==lre?n:e==cre},strict:!1}),kre=new Wf((n,e)=>{let{next:t}=n;(t==e$||t==-1||e.context)&&n.acceptToken(ore)},{contextual:!0,fallback:!0}),Sre=new Wf((n,e)=>{let{next:t}=n,s;Wk.indexOf(t)>-1||t==Gk&&((s=n.peek(1))==Gk||s==mre)||t!=e$&&t!=pre&&t!=-1&&!e.context&&n.acceptToken(nre)},{contextual:!0}),Cre=new Wf((n,e)=>{n.next==wre&&!e.context&&n.acceptToken(sre)},{contextual:!0}),Pre=new Wf((n,e)=>{let{next:t}=n;if(t==fre||t==gre){if(n.advance(),t==n.next){n.advance();let s=!e.context&&e.canShift(I3);n.acceptToken(s?I3:rre)}}else t==vre&&n.peek(1)==Ore&&(n.advance(),n.advance(),(n.next<48||n.next>57)&&n.acceptToken(are))},{contextual:!0});function RO(n,e){return n>=65&&n<=90||n>=97&&n<=122||n==95||n>=192||!e&&n>=48&&n<=57}const Are=new Wf((n,e)=>{if(n.next!=bre||!e.dialectEnabled(dre)||(n.advance(),n.next==Gk))return;let t=0;for(;Wk.indexOf(n.next)>-1;)n.advance(),t++;if(RO(n.next,!0)){for(n.advance(),t++;RO(n.next,!1);)n.advance(),t++;for(;Wk.indexOf(n.next)>-1;)n.advance(),t++;if(n.next==yre)return;for(let s=0;;s++){if(s==7){if(!RO(n.next,!0))return;break}if(n.next!="extends".charCodeAt(s))break;n.advance(),t++}}n.acceptToken(ire,-t)}),Ere=YF({"get set async static":g.modifier,"for while do if else switch try catch finally return throw break continue default case defer":g.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":g.operatorKeyword,"let var const using function class extends":g.definitionKeyword,"import export from":g.moduleKeyword,"with debugger new":g.keyword,TemplateString:g.special(g.string),super:g.atom,BooleanLiteral:g.bool,this:g.self,null:g.null,Star:g.modifier,VariableName:g.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":g.function(g.variableName),VariableDefinition:g.definition(g.variableName),Label:g.labelName,PropertyName:g.propertyName,PrivatePropertyName:g.special(g.propertyName),"CallExpression/MemberExpression/PropertyName":g.function(g.propertyName),"FunctionDeclaration/VariableDefinition":g.function(g.definition(g.variableName)),"ClassDeclaration/VariableDefinition":g.definition(g.className),"NewExpression/VariableName":g.className,PropertyDefinition:g.definition(g.propertyName),PrivatePropertyDefinition:g.definition(g.special(g.propertyName)),UpdateOp:g.updateOperator,"LineComment Hashbang":g.lineComment,BlockComment:g.blockComment,Number:g.number,String:g.string,Escape:g.escape,ArithOp:g.arithmeticOperator,LogicOp:g.logicOperator,BitOp:g.bitwiseOperator,CompareOp:g.compareOperator,RegExp:g.regexp,Equals:g.definitionOperator,Arrow:g.function(g.punctuation),": Spread":g.punctuation,"( )":g.paren,"[ ]":g.squareBracket,"{ }":g.brace,"InterpolationStart InterpolationEnd":g.special(g.brace),".":g.derefOperator,", ;":g.separator,"@":g.meta,TypeName:g.typeName,TypeDefinition:g.definition(g.typeName),"type enum interface implements namespace module declare":g.definitionKeyword,"abstract global Privacy readonly override":g.modifier,"is keyof unique infer asserts":g.operatorKeyword,JSXAttributeValue:g.attributeValue,JSXText:g.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":g.angleBracket,"JSXIdentifier JSXNameSpacedName":g.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":g.attributeName,"JSXBuiltin/JSXIdentifier":g.standard(g.tagName)}),Mre={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},Dre={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},Tre={__proto__:null,"<":193},Bre=Wb.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:xre,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[Ere],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[Sre,Cre,Pre,Are,2,3,4,5,6,7,8,9,10,11,12,13,14,kre,new qk("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new qk("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:n=>Mre[n]||-1},{term:343,get:n=>Dre[n]||-1},{term:95,get:n=>Tre[n]||-1}],tokenPrec:15201});var IO;const Xh=new Qn;function t$(n){return Dt.define({combine:n?e=>e.concat(n):void 0})}const uP=new Qn;class Ji{constructor(e,t,s=[],r=""){this.data=e,this.name=r,ls.prototype.hasOwnProperty("tree")||Object.defineProperty(ls.prototype,"tree",{get(){return Ar(this)}}),this.parser=t,this.extension=[pu.of(this),ls.languageData.of((a,i,o)=>{let l=L3(a,i,o),c=l.type.prop(Xh);if(!c)return[];let u=a.facet(c),h=l.type.prop(uP);if(h){let d=l.resolve(i-l.from,o);for(let m of h)if(m.test(d,a)){let y=a.facet(m.facet);return m.type=="replace"?y:y.concat(u)}}return u})].concat(s)}isActiveAt(e,t,s=-1){return L3(e,t,s).type.prop(Xh)==this.data}findRegions(e){let t=e.facet(pu);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let s=[],r=(a,i)=>{if(a.prop(Xh)==this.data){s.push({from:i,to:i+a.length});return}let o=a.prop(Qn.mounted);if(o){if(o.tree.prop(Xh)==this.data){if(o.overlay)for(let l of o.overlay)s.push({from:l.from+i,to:l.to+i});else s.push({from:i,to:i+a.length});return}else if(o.overlay){let l=s.length;if(r(o.tree,o.overlay[0].from+i),s.length>l)return}}for(let l=0;l<a.children.length;l++){let c=a.children[l];c instanceof lr&&r(c,a.positions[l]+i)}};return r(Ar(e),0),s}get allowsNesting(){return!0}}Ji.setState=rn.define();function L3(n,e,t){let s=n.facet(pu),r=Ar(n).topNode;if(!s||s.allowsNesting)for(let a=r;a;a=a.enter(e,t,Gs.ExcludeBuffers|Gs.EnterBracketed))a.type.isTop&&(r=a);return r}class Xb extends Ji{constructor(e,t,s){super(e,t,[],s),this.parser=t}static define(e){let t=t$(e.languageData);return new Xb(t,e.parser.configure({props:[Xh.add(s=>s.isTop?t:void 0)]}),e.name)}configure(e,t){return new Xb(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ar(n){let e=n.field(Ji.state,!1);return e?e.tree:lr.empty}function n$(n,e,t=50){var s;let r=(s=n.field(Ji.state,!1))===null||s===void 0?void 0:s.context;if(!r)return null;let a=r.viewport;r.updateViewport({from:0,to:e});let i=r.isDone(e)||r.work(t,e)?r.tree:null;return r.updateViewport(a),i}class Fre{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let s=this.cursorPos-this.string.length;return e<s||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-s,t-s)}}let Tp=null;class Hb{constructor(e,t,s=[],r,a,i,o,l){this.parser=e,this.state=t,this.fragments=s,this.tree=r,this.treeLen=a,this.viewport=i,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,s){return new Hb(e,t,[],lr.empty,0,s,[],null)}startParse(){return this.parser.startParse(new Fre(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=lr.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var s;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(ih.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(s=this.parse.stoppedAt)!==null&&s!==void 0?s:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(ih.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Tp;Tp=this;try{return e()}finally{Tp=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Q3(e,t.from,t.to);return e}changes(e,t){let{fragments:s,tree:r,treeLen:a,viewport:i,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,u,h,d)=>l.push({fromA:c,toA:u,fromB:h,toB:d})),s=ih.applyChanges(s,l),r=lr.empty,a=0,i={from:e.mapPos(i.from,-1),to:e.mapPos(i.to,1)},this.skipped.length){o=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),h=e.mapPos(c.to,-1);u<h&&o.push({from:u,to:h})}}}return new Hb(this.parser,t,s,r,a,i,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:r,to:a}=this.skipped[s];r<e.to&&a>e.from&&(this.fragments=Q3(this.fragments,r,a),this.skipped.splice(s--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends XF{createParse(t,s,r){let a=r[0].from,i=r[r.length-1].to;return{parsedPos:a,advance(){let l=Tp;if(l){for(let c of r)l.tempSkipped.push(c);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=i,new lr(ii.none,[],[],i-a)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Tp}}function Q3(n,e,t){return ih.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Td{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),s=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,s)||t.takeTree(),new Td(t)}static init(e){let t=Math.min(3e3,e.doc.length),s=Hb.create(e.facet(pu).parser,e,{from:0,to:t});return s.work(20,t)||s.takeTree(),new Td(s)}}Ji.state=qs.define({create:Td.init,update(n,e){for(let t of e.effects)if(t.is(Ji.setState))return t.value;return e.startState.facet(pu)!=e.state.facet(pu)?Td.init(e.state):n.apply(e)}});let s$=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(s$=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const LO=typeof navigator<"u"&&(!((IO=navigator.scheduling)===null||IO===void 0)&&IO.isInputPending)?()=>navigator.scheduling.isInputPending():null,$re=Ns.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Ji.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Ji.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=s$(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:s,viewport:{to:r}}=this.view,a=s.field(Ji.state);if(a.tree==a.context.tree&&a.context.isDone(r+1e5))return;let i=Date.now()+Math.min(this.chunkBudget,100,e&&!LO?Math.max(25,e.timeRemaining()-5):1e9),o=a.context.treeLen<r&&s.doc.length>r+1e3,l=a.context.work(()=>LO&&LO()||Date.now()>i,r+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(a.context.takeTree(),this.view.dispatch({effects:Ji.setState.of(new Td(a.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(a.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>ei(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),pu=Dt.define({combine(n){return n.length?n[0]:null},enables:n=>[Ji.state,$re,lt.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class Nre{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const _re=Dt.define(),Bd=Dt.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function Yb(n){let e=n.facet(Bd);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function Kb(n,e){let t="",s=n.tabSize,r=n.facet(Bd)[0];if(r=="	"){for(;e>=s;)t+="	",e-=s;r=" "}for(let a=0;a<e;a++)t+=r;return t}function r$(n,e){n instanceof ls&&(n=new ev(n));for(let s of n.state.facet(_re)){let r=s(n,e);if(r!==void 0)return r}let t=Ar(n.state);return t.length>=e?Rre(n,t,e):null}class ev{constructor(e,t={}){this.state=e,this.options=t,this.unit=Yb(e)}lineAt(e,t=1){let s=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:a}=this.options;return r!=null&&r>=s.from&&r<=s.to?a&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:s.text.slice(r-s.from),from:r}:{text:s.text.slice(0,r-s.from),from:s.from}:s}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:s,from:r}=this.lineAt(e,t);return s.slice(e-r,Math.min(s.length,e+100-r))}column(e,t=1){let{text:s,from:r}=this.lineAt(e,t),a=this.countColumn(s,e-r),i=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return i>-1&&(a+=i-this.countColumn(s,s.search(/\S|$/))),a}countColumn(e,t=e.length){return tp(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:s,from:r}=this.lineAt(e,t),a=this.options.overrideIndentation;if(a){let i=a(r);if(i>-1)return i}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const a$=new Qn;function Rre(n,e,t){let s=e.resolveStack(t),r=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(r!=s.node){let a=[];for(let i=r;i&&!(i.from<s.node.from||i.to>s.node.to||i.from==s.node.from&&i.type==s.node.type);i=i.parent)a.push(i);for(let i=a.length-1;i>=0;i--)s={node:a[i],next:s}}return i$(s,n,t)}function i$(n,e,t){for(let s=n;s;s=s.next){let r=Lre(s.node);if(r)return r(hP.create(e,t,s))}return 0}function Ire(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function Lre(n){let e=n.type.prop(a$);if(e)return e;let t=n.firstChild,s;if(t&&(s=t.type.prop(Qn.closedBy))){let r=n.lastChild,a=r&&s.indexOf(r.name)>-1;return i=>o$(i,!0,1,void 0,a&&!Ire(i)?r.from:void 0)}return n.parent==null?Qre:null}function Qre(){return 0}class hP extends ev{constructor(e,t,s){super(e.state,e.options),this.base=e,this.pos=t,this.context=s}get node(){return this.context.node}static create(e,t,s){return new hP(e,t,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let s=e.resolve(t.from);for(;s.parent&&s.parent.from==s.from;)s=s.parent;if(jre(s,e))break;t=this.state.doc.lineAt(s.from)}return this.lineIndent(t.from)}continue(){return i$(this.context.next,this.base,this.pos)}}function jre(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function Vre(n){let e=n.node,t=e.childAfter(e.from),s=e.lastChild;if(!t)return null;let r=n.options.simulateBreak,a=n.state.doc.lineAt(t.from),i=r==null||r<=a.from?a.to:Math.min(a.to,r);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==s)return null;if(!l.type.isSkipped){if(l.from>=i)return null;let c=/^ */.exec(a.text.slice(t.to-a.from))[0].length;return{from:t.from,to:t.to+c}}o=l.to}}function Zre({closing:n,align:e=!0,units:t=1}){return s=>o$(s,e,t,n)}function o$(n,e,t,s,r){let a=n.textAfter,i=a.match(/^\s*/)[0].length,o=s&&a.slice(i,i+s.length)==s||r==n.pos+i,l=e?Vre(n):null;return l?o?n.column(l.from):n.column(l.to):n.baseIndent+(o?0:n.unit*t)}const zre=n=>n.baseIndent;function QO({except:n,units:e=1}={}){return t=>{let s=n&&n.test(t.textAfter);return t.baseIndent+(s?0:e*t.unit)}}const qre=Dt.define(),l$=new Qn;function Ure(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function Wre(n,e,t){let s=Ar(n);if(s.length<t)return null;let r=s.resolveStack(t,1),a=null;for(let i=r;i;i=i.next){let o=i.node;if(o.to<=t||o.from>t)continue;if(a&&o.from<e)break;let l=o.type.prop(l$);if(l&&(o.to<s.length-50||s.length==n.doc.length||!Gre(o))){let c=l(o,n);c&&c.from<=t&&c.from>=e&&c.to>t&&(a=c)}}return a}function Gre(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function Jb(n,e,t){for(let s of n.facet(qre)){let r=s(n,e,t);if(r)return r}return Wre(n,e,t)}function c$(n,e){let t=e.mapPos(n.from,1),s=e.mapPos(n.to,-1);return t>=s?void 0:{from:t,to:s}}const tv=rn.define({map:c$}),Gf=rn.define({map:c$});function u$(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(s=>s.from<=t&&s.to>=t)||e.push(n.lineBlockAt(t));return e}const bh=qs.define({create(){return At.none},update(n,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,s)=>n=j3(n,t,s)),n=n.map(e.changes);for(let t of e.effects)if(t.is(tv)&&!Xre(n,t.value.from,t.value.to)){let{preparePlaceholder:s}=e.state.facet(g$),r=s?At.replace({widget:new Kre(s(e.state,t.value))}):V3;n=n.update({add:[r.range(t.value.from,t.value.to)]})}else t.is(Gf)&&(n=n.update({filter:(s,r)=>t.value.from!=s||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(n=j3(n,e.selection.main.head)),n},provide:n=>lt.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(s,r)=>{t.push(s,r)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let s=n[t++],r=n[t++];if(typeof s!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(V3.range(s,r))}return At.set(e,!0)}});function j3(n,e,t=e){let s=!1;return n.between(e,t,(r,a)=>{r<t&&a>e&&(s=!0)}),s?n.update({filterFrom:e,filterTo:t,filter:(r,a)=>r>=t||a<=e}):n}function ey(n,e,t){var s;let r=null;return(s=n.field(bh,!1))===null||s===void 0||s.between(e,t,(a,i)=>{(!r||r.from>a)&&(r={from:a,to:i})}),r}function Xre(n,e,t){let s=!1;return n.between(e,e,(r,a)=>{r==e&&a==t&&(s=!0)}),s}function h$(n,e){return n.field(bh,!1)?e:e.concat(rn.appendConfig.of(b$()))}const dP=n=>{for(let e of u$(n)){let t=Jb(n.state,e.from,e.to);if(t)return n.dispatch({effects:h$(n.state,[tv.of(t),p$(n,t)])}),!0}return!1},d$=n=>{if(!n.state.field(bh,!1))return!1;let e=[];for(let t of u$(n)){let s=ey(n.state,t.from,t.to);s&&e.push(Gf.of(s),p$(n,s,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function p$(n,e,t=!0){let s=n.state.doc.lineAt(e.from).number,r=n.state.doc.lineAt(e.to).number;return lt.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${s} ${n.state.phrase("to")} ${r}.`)}const m$=n=>{let{state:e}=n,t=[];for(let s=0;s<e.doc.length;){let r=n.lineBlockAt(s),a=Jb(e,r.from,r.to);a&&t.push(tv.of(a)),s=(a?n.lineBlockAt(a.to):r).to+1}return t.length&&n.dispatch({effects:h$(n.state,t)}),!!t.length},f$=n=>{let e=n.state.field(bh,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(s,r)=>{t.push(Gf.of({from:s,to:r}))}),n.dispatch({effects:t}),!0},Hre=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:dP},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:d$},{key:"Ctrl-Alt-[",run:m$},{key:"Ctrl-Alt-]",run:f$}],Yre={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},g$=Dt.define({combine(n){return Ll(n,Yre)}});function b$(n){return[bh,tae]}function y$(n,e){let{state:t}=n,s=t.facet(g$),r=i=>{let o=n.lineBlockAt(n.posAtDOM(i.target)),l=ey(n.state,o.from,o.to);l&&n.dispatch({effects:Gf.of(l)}),i.preventDefault()};if(s.placeholderDOM)return s.placeholderDOM(n,r,e);let a=document.createElement("span");return a.textContent=s.placeholderText,a.setAttribute("aria-label",t.phrase("folded code")),a.title=t.phrase("unfold"),a.className="cm-foldPlaceholder",a.onclick=r,a}const V3=At.replace({widget:new class extends ho{toDOM(n){return y$(n,null)}}});class Kre extends ho{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return y$(e,this.value)}}const Jre={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class jO extends yc{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function eae(n={}){let e={...Jre,...n},t=new jO(e,!0),s=new jO(e,!1),r=Ns.fromClass(class{constructor(i){this.from=i.viewport.from,this.markers=this.buildMarkers(i)}update(i){(i.docChanged||i.viewportChanged||i.startState.facet(pu)!=i.state.facet(pu)||i.startState.field(bh,!1)!=i.state.field(bh,!1)||Ar(i.startState)!=Ar(i.state)||e.foldingChanged(i))&&(this.markers=this.buildMarkers(i.view))}buildMarkers(i){let o=new qo;for(let l of i.viewportLineBlocks){let c=ey(i.state,l.from,l.to)?s:Jb(i.state,l.from,l.to)?t:null;c&&o.add(l.from,l.from,c)}return o.finish()}}),{domEventHandlers:a}=e;return[r,wse({class:"cm-foldGutter",markers(i){var o;return((o=i.plugin(r))===null||o===void 0?void 0:o.markers)||Zn.empty},initialSpacer(){return new jO(e,!1)},domEventHandlers:{...a,click:(i,o,l)=>{if(a.click&&a.click(i,o,l))return!0;let c=ey(i.state,o.from,o.to);if(c)return i.dispatch({effects:Gf.of(c)}),!0;let u=Jb(i.state,o.from,o.to);return u?(i.dispatch({effects:tv.of(u)}),!0):!1}}}),b$()]}const tae=lt.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class np{constructor(e,t){this.specs=e;let s;function r(o){let l=lu.newName();return(s||(s=Object.create(null)))["."+l]=o,l}const a=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,i=t.scope;this.scope=i instanceof Ji?o=>o.prop(Xh)==i.data:i?o=>o==i:void 0,this.style=JF(e.map(o=>({tag:o.tag,class:o.class||r(Object.assign({},o,{tag:null}))})),{all:a}).style,this.module=s?new lu(s):null,this.themeType=t.themeType}static define(e,t){return new np(e,t||{})}}const Xk=Dt.define(),v$=Dt.define({combine(n){return n.length?[n[0]]:null}});function VO(n){let e=n.facet(Xk);return e.length?e:n.facet(v$)}function nv(n,e){let t=[sae],s;return n instanceof np&&(n.module&&t.push(lt.styleModule.of(n.module)),s=n.themeType),e!=null&&e.fallback?t.push(v$.of(n)):s?t.push(Xk.computeN([lt.darkTheme],r=>r.facet(lt.darkTheme)==(s=="dark")?[n]:[])):t.push(Xk.of(n)),t}class nae{constructor(e){this.markCache=Object.create(null),this.tree=Ar(e.state),this.decorations=this.buildDeco(e,VO(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Ar(e.state),s=VO(e.state),r=s!=VO(e.startState),{viewport:a}=e.view,i=e.changes.mapPos(this.decoratedTo,1);t.length<a.to&&!r&&t.type==this.tree.type&&i>=a.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=i):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,s),this.decoratedTo=a.to)}buildDeco(e,t){if(!t||!this.tree.length)return At.none;let s=new qo;for(let{from:r,to:a}of e.visibleRanges)Jse(this.tree,t,(i,o,l)=>{s.add(i,o,this.markCache[l]||(this.markCache[l]=At.mark({class:l})))},r,a);return s.finish()}}const sae=Fi.high(Ns.fromClass(nae,{decorations:n=>n.decorations})),O$=np.define([{tag:g.meta,color:"#404740"},{tag:g.link,textDecoration:"underline"},{tag:g.heading,textDecoration:"underline",fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.strong,fontWeight:"bold"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.keyword,color:"#708"},{tag:[g.atom,g.bool,g.url,g.contentSeparator,g.labelName],color:"#219"},{tag:[g.literal,g.inserted],color:"#164"},{tag:[g.string,g.deleted],color:"#a11"},{tag:[g.regexp,g.escape,g.special(g.string)],color:"#e40"},{tag:g.definition(g.variableName),color:"#00f"},{tag:g.local(g.variableName),color:"#30a"},{tag:[g.typeName,g.namespace],color:"#085"},{tag:g.className,color:"#167"},{tag:[g.special(g.variableName),g.macroName],color:"#256"},{tag:g.definition(g.propertyName),color:"#00c"},{tag:g.comment,color:"#940"},{tag:g.invalid,color:"#f00"}]),rae=lt.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),w$=1e4,x$="()[]{}",k$=Dt.define({combine(n){return Ll(n,{afterCursor:!0,brackets:x$,maxScanDistance:w$,renderMatch:oae})}}),aae=At.mark({class:"cm-matchingBracket"}),iae=At.mark({class:"cm-nonmatchingBracket"});function oae(n){let e=[],t=n.matched?aae:iae;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}function Z3(n){let e=[],t=n.facet(k$);for(let s of n.selection.ranges){if(!s.empty)continue;let r=eo(n,s.head,-1,t)||s.head>0&&eo(n,s.head-1,1,t)||t.afterCursor&&(eo(n,s.head,1,t)||s.head<n.doc.length&&eo(n,s.head+1,-1,t));r&&(e=e.concat(t.renderMatch(r,n)))}return At.set(e,!0)}const lae=Ns.fromClass(class{constructor(n){this.paused=!1,this.decorations=Z3(n.state)}update(n){(n.docChanged||n.selectionSet||this.paused)&&(n.view.composing?(this.decorations=this.decorations.map(n.changes),this.paused=!0):(this.decorations=Z3(n.state),this.paused=!1))}},{decorations:n=>n.decorations}),cae=[lae,rae];function S$(n={}){return[k$.of(n),cae]}const uae=new Qn;function Hk(n,e,t){let s=n.prop(e<0?Qn.openedBy:Qn.closedBy);if(s)return s;if(n.name.length==1){let r=t.indexOf(n.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function Yk(n){let e=n.type.prop(uae);return e?e(n.node):n}function eo(n,e,t,s={}){let r=s.maxScanDistance||w$,a=s.brackets||x$,i=Ar(n),o=i.resolveInner(e,t);for(let l=o;l;l=l.parent){let c=Hk(l.type,t,a);if(c&&l.from<l.to){let u=Yk(l);if(u&&(t>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return hae(n,e,t,l,u,c,a)}}return dae(n,e,t,i,o.type,r,a)}function hae(n,e,t,s,r,a,i){let o=s.parent,l={from:r.from,to:r.to},c=0,u=o==null?void 0:o.cursor();if(u&&(t<0?u.childBefore(s.from):u.childAfter(s.to)))do if(t<0?u.to<=s.from:u.from>=s.to){if(c==0&&a.indexOf(u.type.name)>-1&&u.from<u.to){let h=Yk(u);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(Hk(u.type,t,i))c++;else if(Hk(u.type,-t,i)){if(c==0){let h=Yk(u);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}c--}}while(t<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function dae(n,e,t,s,r,a,i){let o=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),l=i.indexOf(o);if(l<0||l%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},u=n.doc.iterRange(e,t>0?n.doc.length:0),h=0;for(let d=0;!u.next().done&&d<=a;){let m=u.value;t<0&&(d+=m.length);let y=e+d*t;for(let O=t>0?0:m.length-1,S=t>0?m.length:-1;O!=S;O+=t){let A=i.indexOf(m[O]);if(!(A<0||s.resolveInner(y+O,1).type!=r))if(A%2==0==t>0)h++;else{if(h==1)return{start:c,end:{from:y+O,to:y+O+1},matched:A>>1==l>>1};h--}}t>0&&(d+=m.length)}return u.done?{start:c,matched:!1}:null}function z3(n,e,t,s=0,r=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let a=r;for(let i=s;i<e;i++)n.charCodeAt(i)==9?a+=t-a%t:a++;return a}class pae{constructor(e,t,s,r){this.string=e,this.tabSize=t,this.indentUnit=s,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),s;if(typeof e=="string"?s=t==e:s=t&&(e instanceof RegExp?e.test(t):e(t)),s)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=z3(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:z3(this.string,null,this.tabSize)}match(e,t,s){if(typeof e=="string"){let r=i=>s?i.toLowerCase():i,a=this.string.substr(this.pos,e.length);return r(a)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}const mae=Object.create(null),q3=[ii.none],U3=[],W3=Object.create(null),fae=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])fae[n]=gae(mae,e);function ZO(n,e){U3.indexOf(n)>-1||(U3.push(n),console.warn(e))}function gae(n,e){let t=[];for(let o of e.split(" ")){let l=[];for(let c of o.split(".")){let u=n[c]||g[c];u?typeof u=="function"?l.length?l=l.map(u):ZO(c,`Modifier ${c} used at start of tag`):l.length?ZO(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:ZO(c,`Unknown highlighting tag ${c}`)}for(let c of l)t.push(c)}if(!t.length)return 0;let s=e.replace(/ /g,"_"),r=s+" "+t.map(o=>o.id),a=W3[r];if(a)return a.id;let i=W3[r]=ii.define({id:q3.length,name:s,props:[YF({[s]:t})]});return q3.push(i),i.id}fs.RTL,fs.LTR;class C${constructor(e,t,s,r){this.state=e,this.pos=t,this.explicit=s,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Ar(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),s=Math.max(t.from,this.pos-250),r=t.text.slice(s-t.from,this.pos-t.from),a=r.search(A$(e,!1));return a<0?null:{from:s+a,to:this.pos,text:r.slice(a)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,s){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),s&&s.onDocChange&&(this.abortOnDocChange=!0))}}function G3(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function bae(n){let e=Object.create(null),t=Object.create(null);for(let{label:r}of n){e[r[0]]=!0;for(let a=1;a<r.length;a++)t[r[a]]=!0}let s=G3(e)+G3(t)+"*$";return[new RegExp("^"+s),new RegExp(s)]}function P$(n){let e=n.map(r=>typeof r=="string"?{label:r}:r),[t,s]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:bae(e);return r=>{let a=r.matchBefore(s);return a||r.explicit?{from:a?a.from:r.pos,options:e,validFor:t}:null}}function yae(n,e){return t=>{for(let s=Ar(t.state).resolveInner(t.pos,-1);s;s=s.parent){if(n.indexOf(s.name)>-1)return null;if(s.type.isTop)break}return e(t)}}class X3{constructor(e,t,s,r){this.completion=e,this.source=t,this.match=s,this.score=r}}function oh(n){return n.selection.main.from}function A$(n,e){var t;let{source:s}=n,r=e&&s[0]!="^",a=s[s.length-1]!="$";return!r&&!a?n:new RegExp(`${r?"^":""}(?:${s})${a?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const pP=Cc.define();function vae(n,e,t,s){let{main:r}=n.selection,a=t-r.from,i=s-r.from;return{...n.changeByRange(o=>{if(o!=r&&t!=s&&n.sliceDoc(o.from+a,o.from+i)!=n.sliceDoc(t,s))return{range:o};let l=n.toText(e);return{changes:{from:o.from+a,to:s==r.from?o.to:o.from+i,insert:l},range:Le.cursor(o.from+a+l.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const H3=new WeakMap;function Oae(n){if(!Array.isArray(n))return n;let e=H3.get(n);return e||H3.set(n,e=P$(n)),e}const ty=rn.define(),Jm=rn.define();class wae{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let s=Ha(e,t),r=fl(s);this.chars.push(s);let a=e.slice(t,t+r),i=a.toUpperCase();this.folded.push(Ha(i==a?a.toLowerCase():i,0)),t+=r}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:s,any:r,precise:a,byWord:i}=this;if(t.length==1){let F=Ha(e,0),j=fl(F),N=j==e.length?0:-100;if(F!=t[0])if(F==s[0])N+=-200;else return null;return this.ret(N,[0,j])}let o=e.indexOf(this.pattern);if(o==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,c=0;if(o<0){for(let F=0,j=Math.min(e.length,200);F<j&&c<l;){let N=Ha(e,F);(N==t[c]||N==s[c])&&(r[c++]=F),F+=fl(N)}if(c<l)return null}let u=0,h=0,d=!1,m=0,y=-1,O=-1,S=/[a-z]/.test(e),A=!0;for(let F=0,j=Math.min(e.length,200),N=0;F<j&&h<l;){let $=Ha(e,F);o<0&&(u<l&&$==t[u]&&(a[u++]=F),m<l&&($==t[m]||$==s[m]?(m==0&&(y=F),O=F+1,m++):m=0));let L,I=$<255?$>=48&&$<=57||$>=97&&$<=122?2:$>=65&&$<=90?1:0:(L=jC($))!=L.toLowerCase()?1:L!=L.toUpperCase()?2:0;(!F||I==1&&S||N==0&&I!=0)&&(t[h]==$||s[h]==$&&(d=!0)?i[h++]=F:i.length&&(A=!1)),N=I,F+=fl($)}return h==l&&i[0]==0&&A?this.result(-100+(d?-200:0),i,e):m==l&&y==0?this.ret(-200-e.length+(O==e.length?0:-100),[0,O]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):m==l?this.ret(-900-e.length,[y,O]):h==l?this.result(-100+(d?-200:0)+-700+(A?0:-1100),i,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,s){let r=[],a=0;for(let i of t){let o=i+(this.astral?fl(Ha(s,i)):1);a&&r[a-1]==i?r[a-1]=o:(r[a++]=i,r[a++]=o)}return this.ret(e-s.length,r)}}class xae{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),s=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return s==null?null:(this.matched=[0,t.length],this.score=s+(e.length==this.pattern.length?0:-100),this)}}const Nr=Dt.define({combine(n){return Ll(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:kae,filterStrict:!1,compareCompletions:(e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>s=>Y3(e(s),t(s)),optionClass:(e,t)=>s=>Y3(e(s),t(s)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function Y3(n,e){return n?e?n+" "+e:n:e}function kae(n,e,t,s,r,a){let i=n.textDirection==fs.RTL,o=i,l=!1,c="top",u,h,d=e.left-r.left,m=r.right-e.right,y=s.right-s.left,O=s.bottom-s.top;if(o&&d<Math.min(y,m)?o=!1:!o&&m<Math.min(y,d)&&(o=!0),y<=(o?d:m))u=Math.max(r.top,Math.min(t.top,r.bottom-O))-e.top,h=Math.min(400,o?d:m);else{l=!0,h=Math.min(400,(i?e.right:r.right-e.left)-30);let F=r.bottom-e.bottom;F>=O||F>e.top?u=t.bottom-e.top:(c="bottom",u=e.bottom-t.top)}let S=(e.bottom-e.top)/a.offsetHeight,A=(e.right-e.left)/a.offsetWidth;return{style:`${c}: ${u/S}px; max-width: ${h/A}px`,class:"cm-completionInfo-"+(l?i?"left-narrow":"right-narrow":o?"left":"right")}}function Sae(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let s=document.createElement("div");return s.classList.add("cm-completionIcon"),t.type&&s.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),s.setAttribute("aria-hidden","true"),s},position:20}),e.push({render(t,s,r,a){let i=document.createElement("span");i.className="cm-completionLabel";let o=t.displayLabel||t.label,l=0;for(let c=0;c<a.length;){let u=a[c++],h=a[c++];u>l&&i.appendChild(document.createTextNode(o.slice(l,u)));let d=i.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(o.slice(u,h))),d.className="cm-completionMatchedText",l=h}return l<o.length&&i.appendChild(document.createTextNode(o.slice(l))),i},position:50},{render(t){if(!t.detail)return null;let s=document.createElement("span");return s.className="cm-completionDetail",s.textContent=t.detail,s},position:80}),e.sort((t,s)=>t.position-s.position).map(t=>t.render)}function zO(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let s=Math.floor((n-e)/t);return{from:n-(s+1)*t,to:n-s*t}}class Cae{constructor(e,t,s){this.view=e,this.stateField=t,this.applyCompletion=s,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let r=e.state.field(t),{options:a,selected:i}=r.open,o=e.state.facet(Nr);this.optionContent=Sae(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=zO(a.length,i,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(t).open;for(let u=l.target,h;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(h=/-(\d+)$/.exec(u.id))&&+h[1]<c.length){this.applyCompletion(e,c[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(Nr).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Jm.of(null)})}),this.showOptions(a,r.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let s=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),s!=r){let{options:a,selected:i,disabled:o}=s.open;(!r.open||r.open.options!=a)&&(this.range=zO(a.length,i,e.state.facet(Nr).maxRenderedOptions),this.showOptions(a,s.id)),this.updateSel(),o!=((t=r.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let s of this.currentClass.split(" "))s&&this.dom.classList.remove(s);for(let s of t.split(" "))s&&this.dom.classList.add(s);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=zO(t.options.length,t.selected,this.view.state.facet(Nr).maxRenderedOptions),this.showOptions(t.options,e.id));let s=this.updateSelectedOption(t.selected);if(s){this.destroyInfo();let{completion:r}=t.options[t.selected],{info:a}=r;if(!a)return;let i=typeof a=="string"?document.createTextNode(a):a(r);if(!i)return;"then"in i?i.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,r)}).catch(o=>ei(this.view.state,o,"completion info")):(this.addInfoPane(i,r),s.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let s=this.info=document.createElement("div");if(s.className="cm-tooltip cm-completionInfo",s.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)s.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:a}=e;s.appendChild(r),this.infoDestroy=a||null}this.dom.appendChild(s),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let s=this.list.firstChild,r=this.range.from;s;s=s.nextSibling,r++)s.nodeName!="LI"||!s.id?r--:r==e?s.hasAttribute("aria-selected")||(s.setAttribute("aria-selected","true"),t=s):s.hasAttribute("aria-selected")&&(s.removeAttribute("aria-selected"),s.removeAttribute("aria-describedby"));return t&&Aae(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),s=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),a=this.space;if(!a){let i=this.dom.ownerDocument.documentElement;a={left:0,top:0,right:i.clientWidth,bottom:i.clientHeight}}return r.top>Math.min(a.bottom,t.bottom)-10||r.bottom<Math.max(a.top,t.top)+10?null:this.view.state.facet(Nr).positionInfo(this.view,t,r,s,a,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,s){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions")),r.addEventListener("mousedown",i=>{i.target==r&&i.preventDefault()});let a=null;for(let i=s.from;i<s.to;i++){let{completion:o,match:l}=e[i],{section:c}=o;if(c){let d=typeof c=="string"?c:c.name;if(d!=a&&(i>s.from||s.from==0))if(a=d,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let m=r.appendChild(document.createElement("completion-section"));m.textContent=d}}const u=r.appendChild(document.createElement("li"));u.id=t+"-"+i,u.setAttribute("role","option");let h=this.optionClass(o);h&&(u.className=h);for(let d of this.optionContent){let m=d(o,this.view.state,this.view,l);m&&u.appendChild(m)}}return s.from&&r.classList.add("cm-completionListIncompleteTop"),s.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Pae(n,e){return t=>new Cae(t,n,e)}function Aae(n,e){let t=n.getBoundingClientRect(),s=e.getBoundingClientRect(),r=t.height/n.offsetHeight;s.top<t.top?n.scrollTop-=(t.top-s.top)/r:s.bottom>t.bottom&&(n.scrollTop+=(s.bottom-t.bottom)/r)}function K3(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function Eae(n,e){let t=[],s=null,r=null,a=u=>{t.push(u);let{section:h}=u.completion;if(h){s||(s=[]);let d=typeof h=="string"?h:h.name;s.some(m=>m.name==d)||s.push(typeof h=="string"?{name:d}:h)}},i=e.facet(Nr);for(let u of n)if(u.hasResult()){let h=u.result.getMatch;if(u.result.filter===!1)for(let d of u.result.options)a(new X3(d,u.source,h?h(d):[],1e9-t.length));else{let d=e.sliceDoc(u.from,u.to),m,y=i.filterStrict?new xae(d):new wae(d);for(let O of u.result.options)if(m=y.match(O.label)){let S=O.displayLabel?h?h(O,m.matched):[]:m.matched,A=m.score+(O.boost||0);if(a(new X3(O,u.source,S,A)),typeof O.section=="object"&&O.section.rank==="dynamic"){let{name:F}=O.section;r||(r=Object.create(null)),r[F]=Math.max(A,r[F]||-1e9)}}}}if(s){let u=Object.create(null),h=0,d=(m,y)=>(m.rank==="dynamic"&&y.rank==="dynamic"?r[y.name]-r[m.name]:0)||(typeof m.rank=="number"?m.rank:1e9)-(typeof y.rank=="number"?y.rank:1e9)||(m.name<y.name?-1:1);for(let m of s.sort(d))h-=1e5,u[m.name]=h;for(let m of t){let{section:y}=m.completion;y&&(m.score+=u[typeof y=="string"?y:y.name])}}let o=[],l=null,c=i.compareCompletions;for(let u of t.sort((h,d)=>d.score-h.score||c(h.completion,d.completion))){let h=u.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?o.push(u):K3(u.completion)>K3(l)&&(o[o.length-1]=u),l=u.completion}return o}class Hh{constructor(e,t,s,r,a,i){this.options=e,this.attrs=t,this.tooltip=s,this.timestamp=r,this.selected=a,this.disabled=i}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Hh(this.options,J3(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,s,r,a,i){if(r&&!i&&e.some(c=>c.isPending))return r.setDisabled();let o=Eae(e,t);if(!o.length)return r&&e.some(c=>c.isPending)?r.setDisabled():null;let l=t.facet(Nr).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let c=r.options[r.selected].completion;for(let u=0;u<o.length;u++)if(o[u].completion==c){l=u;break}}return new Hh(o,J3(s,l),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:$ae,above:a.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new Hh(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new Hh(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class ny{constructor(e,t,s){this.active=e,this.id=t,this.open=s}static start(){return new ny(Bae,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,s=t.facet(Nr),a=(s.override||t.languageDataAt("autocomplete",oh(t)).map(Oae)).map(l=>(this.active.find(u=>u.source==l)||new to(l,this.active.some(u=>u.state!=0)?1:0)).update(e,s));a.length==this.active.length&&a.every((l,c)=>l==this.active[c])&&(a=this.active);let i=this.open,o=e.effects.some(l=>l.is(mP));i&&e.docChanged&&(i=i.map(e.changes)),e.selection||a.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!Mae(a,this.active)||o?i=Hh.build(a,t,this.id,i,s,o):i&&i.disabled&&!a.some(l=>l.isPending)&&(i=null),!i&&a.every(l=>!l.isPending)&&a.some(l=>l.hasResult())&&(a=a.map(l=>l.hasResult()?new to(l.source,0):l));for(let l of e.effects)l.is(M$)&&(i=i&&i.setSelected(l.value,this.id));return a==this.active&&i==this.open?this:new ny(a,this.id,i)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Dae:Tae}}function Mae(n,e){if(n==e)return!0;for(let t=0,s=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;s<e.length&&!e[s].hasResult();)s++;let r=t==n.length,a=s==e.length;if(r||a)return r==a;if(n[t++].result!=e[s++].result)return!1}}const Dae={"aria-autocomplete":"list"},Tae={};function J3(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const Bae=[];function E$(n,e){if(n.isUserEvent("input.complete")){let s=n.annotation(pP);if(s&&e.activateOnCompletion(s))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class to{constructor(e,t,s=!1){this.source=e,this.state=t,this.explicit=s}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let s=E$(e,t),r=this;(s&8||s&16&&this.touches(e))&&(r=new to(r.source,0)),s&4&&r.state==0&&(r=new to(this.source,1)),r=r.updateFor(e,s);for(let a of e.effects)if(a.is(ty))r=new to(r.source,1,a.value);else if(a.is(Jm))r=new to(r.source,0);else if(a.is(mP))for(let i of a.value)i.source==r.source&&(r=i);return r}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(oh(e.state))}}class ld extends to{constructor(e,t,s,r,a,i){super(e,3,t),this.limit=s,this.result=r,this.from=a,this.to=i}hasResult(){return!0}updateFor(e,t){var s;if(!(t&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let a=e.changes.mapPos(this.from),i=e.changes.mapPos(this.to,1),o=oh(e.state);if(o>i||!r||t&2&&(oh(e.startState)==this.from||o<this.limit))return new to(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return Fae(r.validFor,e.state,a,i)?new ld(this.source,this.explicit,l,r,a,i):r.update&&(r=r.update(r,a,i,new C$(e.state,o,!1)))?new ld(this.source,this.explicit,l,r,r.from,(s=r.to)!==null&&s!==void 0?s:oh(e.state)):new to(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new ld(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new to(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Fae(n,e,t,s){if(!n)return!1;let r=e.sliceDoc(t,s);return typeof n=="function"?n(r,t,s,e):A$(n,!0).test(r)}const mP=rn.define({map(n,e){return n.map(t=>t.map(e))}}),M$=rn.define(),va=qs.define({create(){return ny.start()},update(n,e){return n.update(e)},provide:n=>[rP.from(n,e=>e.tooltip),lt.contentAttributes.from(n,e=>e.attrs)]});function fP(n,e){const t=e.completion.apply||e.completion.label;let s=n.state.field(va).active.find(r=>r.source==e.source);return s instanceof ld?(typeof t=="string"?n.dispatch({...vae(n.state,t,s.from,s.to),annotations:pP.of(e.completion)}):t(n,e.completion,s.from,s.to),!0):!1}const $ae=Pae(va,fP);function zc(n,e="option"){return t=>{let s=t.state.field(va,!1);if(!s||!s.open||s.open.disabled||Date.now()-s.open.timestamp<t.state.facet(Nr).interactionDelay)return!1;let r=1,a;e=="page"&&(a=LF(t,s.open.tooltip))&&(r=Math.max(2,Math.floor(a.dom.offsetHeight/a.dom.querySelector("li").offsetHeight)-1));let{length:i}=s.open.options,o=s.open.selected>-1?s.open.selected+r*(n?1:-1):n?0:i-1;return o<0?o=e=="page"?0:i-1:o>=i&&(o=e=="page"?i-1:0),t.dispatch({effects:M$.of(o)}),!0}}const Kk=n=>{let e=n.state.field(va,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(Nr).interactionDelay?!1:fP(n,e.open.options[e.open.selected])},tb=n=>n.state.field(va,!1)?(n.dispatch({effects:ty.of(!0)}),!0):!1,D$=n=>{let e=n.state.field(va,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:Jm.of(null)}),!0)};class Nae{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const _ae=50,Rae=1e3,Iae=Ns.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(va).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(va),t=n.state.facet(Nr);if(!n.selectionSet&&!n.docChanged&&n.startState.field(va)==e)return;let s=n.transactions.some(a=>{let i=E$(a,t);return i&8||(a.selection||a.docChanged)&&!(i&3)});for(let a=0;a<this.running.length;a++){let i=this.running[a];if(s||i.context.abortOnDocChange&&n.docChanged||i.updates.length+n.transactions.length>_ae&&Date.now()-i.time>Rae){for(let o of i.context.abortListeners)try{o()}catch(l){ei(this.view.state,l)}i.context.abortListeners=null,this.running.splice(a--,1)}else i.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(a=>a.effects.some(i=>i.is(ty)))&&(this.pendingStart=!0);let r=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(a=>a.isPending&&!this.running.some(i=>i.active.source==a.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let a of n.transactions)a.isUserEvent("input.type")?this.composing=2:this.composing==2&&a.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(va);for(let t of e.active)t.isPending&&!this.running.some(s=>s.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Nr).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=oh(e),s=new C$(e,t,n.explicit,this.view),r=new Nae(n,s);this.running.push(r),Promise.resolve(n.source(s)).then(a=>{r.context.aborted||(r.done=a||null,this.scheduleAccept())},a=>{this.view.dispatch({effects:Jm.of(null)}),ei(this.view.state,a)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Nr).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Nr),s=this.view.state.field(va);for(let r=0;r<this.running.length;r++){let a=this.running[r];if(a.done===void 0)continue;if(this.running.splice(r--,1),a.done){let o=oh(a.updates.length?a.updates[0].startState:this.view.state),l=Math.min(o,a.done.from+(a.active.explicit?0:1)),c=new ld(a.active.source,a.active.explicit,l,a.done,a.done.from,(n=a.done.to)!==null&&n!==void 0?n:o);for(let u of a.updates)c=c.update(u,t);if(c.hasResult()){e.push(c);continue}}let i=s.active.find(o=>o.source==a.active.source);if(i&&i.isPending)if(a.done==null){let o=new to(a.active.source,0);for(let l of a.updates)o=o.update(l,t);o.isPending||e.push(o)}else this.startQuery(i)}(e.length||s.open&&s.open.disabled)&&this.view.dispatch({effects:mP.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(va,!1);if(e&&e.tooltip&&this.view.state.facet(Nr).closeOnBlur){let t=e.open&&LF(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Jm.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:ty.of(!1)}),20),this.composing=0}}}),Lae=typeof navigator=="object"&&/Win/.test(navigator.platform),Qae=Fi.highest(lt.domEventHandlers({keydown(n,e){let t=e.state.field(va,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(Lae&&n.altKey)||n.metaKey)return!1;let s=t.open.options[t.open.selected],r=t.active.find(i=>i.source==s.source),a=s.completion.commitCharacters||r.result.commitCharacters;return a&&a.indexOf(n.key)>-1&&fP(e,s),!1}})),T$=lt.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class jae{constructor(e,t,s,r){this.field=e,this.line=t,this.from=s,this.to=r}}class gP{constructor(e,t,s){this.field=e,this.from=t,this.to=s}map(e){let t=e.mapPos(this.from,-1,pr.TrackDel),s=e.mapPos(this.to,1,pr.TrackDel);return t==null||s==null?null:new gP(this.field,t,s)}}class bP{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let s=[],r=[t],a=e.doc.lineAt(t),i=/^\s*/.exec(a.text)[0];for(let l of this.lines){if(s.length){let c=i,u=/^\t*/.exec(l)[0].length;for(let h=0;h<u;h++)c+=e.facet(Bd);r.push(t+c.length-u),l=c+l.slice(u)}s.push(l),t+=l.length+1}let o=this.fieldPositions.map(l=>new gP(l.field,r[l.line]+l.from,r[l.line]+l.to));return{text:s,ranges:o}}static parse(e){let t=[],s=[],r=[],a;for(let i of e.split(/\r\n?|\n/)){for(;a=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(i);){let o=a[1]?+a[1]:null,l=a[2]||a[3]||"",c=-1,u=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<t.length;h++)(o!=null?t[h].seq==o:u&&t[h].name==u)&&(c=h);if(c<0){let h=0;for(;h<t.length&&(o==null||t[h].seq!=null&&t[h].seq<o);)h++;t.splice(h,0,{seq:o,name:u}),c=h;for(let d of r)d.field>=c&&d.field++}for(let h of r)if(h.line==s.length&&h.from>a.index){let d=a[2]?3+(a[1]||"").length:2;h.from-=d,h.to-=d}r.push(new jae(c,s.length,a.index,a.index+u.length)),i=i.slice(0,a.index)+l+i.slice(a.index+a[0].length)}i=i.replace(/\\([{}])/g,(o,l,c)=>{for(let u of r)u.line==s.length&&u.from>c&&(u.from--,u.to--);return l}),s.push(i)}return new bP(s,r)}}let Vae=At.widget({widget:new class extends ho{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),Zae=At.mark({class:"cm-snippetField"});class sp{constructor(e,t){this.ranges=e,this.active=t,this.deco=At.set(e.map(s=>(s.from==s.to?Vae:Zae).range(s.from,s.to)),!0)}map(e){let t=[];for(let s of this.ranges){let r=s.map(e);if(!r)return null;t.push(r)}return new sp(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(s=>s.field==this.active&&s.from<=t.from&&s.to>=t.to))}}const Xf=rn.define({map(n,e){return n&&n.map(e)}}),zae=rn.define(),ef=qs.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(Xf))return t.value;if(t.is(zae)&&n)return new sp(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>lt.decorations.from(n,e=>e?e.deco:At.none)});function yP(n,e){return Le.create(n.filter(t=>t.field==e).map(t=>Le.range(t.from,t.to)))}function qae(n){let e=bP.parse(n);return(t,s,r,a)=>{let{text:i,ranges:o}=e.instantiate(t.state,r),{main:l}=t.state.selection,c={changes:{from:r,to:a==l.from?l.to:a,insert:us.of(i)},scrollIntoView:!0,annotations:s?[pP.of(s),fr.userEvent.of("input.complete")]:void 0};if(o.length&&(c.selection=yP(o,0)),o.some(u=>u.field>0)){let u=new sp(o,0),h=c.effects=[Xf.of(u)];t.state.field(ef,!1)===void 0&&h.push(rn.appendConfig.of([ef,Hae,Yae,T$]))}t.dispatch(t.state.update(c))}}function B$(n){return({state:e,dispatch:t})=>{let s=e.field(ef,!1);if(!s||n<0&&s.active==0)return!1;let r=s.active+n,a=n>0&&!s.ranges.some(i=>i.field==r+n);return t(e.update({selection:yP(s.ranges,r),effects:Xf.of(a?null:new sp(s.ranges,r)),scrollIntoView:!0})),!0}}const Uae=({state:n,dispatch:e})=>n.field(ef,!1)?(e(n.update({effects:Xf.of(null)})),!0):!1,Wae=B$(1),Gae=B$(-1),Xae=[{key:"Tab",run:Wae,shift:Gae},{key:"Escape",run:Uae}],e5=Dt.define({combine(n){return n.length?n[0]:Xae}}),Hae=Fi.highest(Pc.compute([e5],n=>n.facet(e5)));function Na(n,e){return{...e,apply:qae(n)}}const Yae=lt.domEventHandlers({mousedown(n,e){let t=e.state.field(ef,!1),s;if(!t||(s=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let r=t.ranges.find(a=>a.from<=s&&a.to>=s);return!r||r.field==t.active?!1:(e.dispatch({selection:yP(t.ranges,r.field),effects:Xf.of(t.ranges.some(a=>a.field>r.field)?new sp(t.ranges,r.field):null),scrollIntoView:!0}),!0)}}),tf={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Yu=rn.define({map(n,e){let t=e.mapPos(n,-1,pr.TrackAfter);return t??void 0}}),vP=new class extends ou{};vP.startSide=1;vP.endSide=-1;const F$=qs.define({create(){return Zn.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:s=>s>=t.from&&s<=t.to})}for(let t of e.effects)t.is(Yu)&&(n=n.update({add:[vP.range(t.value,t.value+1)]}));return n}});function $$(){return[Jae,F$]}const qO="()[]{}<>«»»«［］｛｝";function N$(n){for(let e=0;e<qO.length;e+=2)if(qO.charCodeAt(e)==n)return qO.charAt(e+1);return jC(n<128?n:n+1)}function _$(n,e){return n.languageDataAt("closeBrackets",e)[0]||tf}const Kae=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Jae=lt.inputHandler.of((n,e,t,s)=>{if((Kae?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let r=n.state.selection.main;if(s.length>2||s.length==2&&fl(Ha(s,0))==1||e!=r.from||t!=r.to)return!1;let a=eie(n.state,s);return a?(n.dispatch(a),!0):!1}),R$=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let s=_$(n,n.selection.main.head).brackets||tf.brackets,r=null,a=n.changeByRange(i=>{if(i.empty){let o=tie(n.doc,i.head);for(let l of s)if(l==o&&sv(n.doc,i.head)==N$(Ha(l,0)))return{changes:{from:i.head-l.length,to:i.head+l.length},range:Le.cursor(i.head-l.length)}}return{range:r=i}});return r||e(n.update(a,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},I$=[{key:"Backspace",run:R$}];function eie(n,e){let t=_$(n,n.selection.main.head),s=t.brackets||tf.brackets;for(let r of s){let a=N$(Ha(r,0));if(e==r)return a==r?rie(n,r,s.indexOf(r+r+r)>-1,t):nie(n,r,a,t.before||tf.before);if(e==a&&L$(n,n.selection.main.from))return sie(n,r,a)}return null}function L$(n,e){let t=!1;return n.field(F$).between(0,n.doc.length,s=>{s==e&&(t=!0)}),t}function sv(n,e){let t=n.sliceString(e,e+2);return t.slice(0,fl(Ha(t,0)))}function tie(n,e){let t=n.sliceString(e-2,e);return fl(Ha(t,0))==t.length?t:t.slice(1)}function nie(n,e,t,s){let r=null,a=n.changeByRange(i=>{if(!i.empty)return{changes:[{insert:e,from:i.from},{insert:t,from:i.to}],effects:Yu.of(i.to+e.length),range:Le.range(i.anchor+e.length,i.head+e.length)};let o=sv(n.doc,i.head);return!o||/\s/.test(o)||s.indexOf(o)>-1?{changes:{insert:e+t,from:i.head},effects:Yu.of(i.head+e.length),range:Le.cursor(i.head+e.length)}:{range:r=i}});return r?null:n.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function sie(n,e,t){let s=null,r=n.changeByRange(a=>a.empty&&sv(n.doc,a.head)==t?{changes:{from:a.head,to:a.head+t.length,insert:t},range:Le.cursor(a.head+t.length)}:s={range:a});return s?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function rie(n,e,t,s){let r=s.stringPrefixes||tf.stringPrefixes,a=null,i=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:e,from:o.to}],effects:Yu.of(o.to+e.length),range:Le.range(o.anchor+e.length,o.head+e.length)};let l=o.head,c=sv(n.doc,l),u;if(c==e){if(t5(n,l))return{changes:{insert:e+e,from:l},effects:Yu.of(l+e.length),range:Le.cursor(l+e.length)};if(L$(n,l)){let d=t&&n.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+d.length,insert:d},range:Le.cursor(l+d.length)}}}else{if(t&&n.sliceDoc(l-2*e.length,l)==e+e&&(u=n5(n,l-2*e.length,r))>-1&&t5(n,u))return{changes:{insert:e+e+e+e,from:l},effects:Yu.of(l+e.length),range:Le.cursor(l+e.length)};if(n.charCategorizer(l)(c)!=zs.Word&&n5(n,l,r)>-1&&!aie(n,l,e,r))return{changes:{insert:e+e,from:l},effects:Yu.of(l+e.length),range:Le.cursor(l+e.length)}}return{range:a=o}});return a?null:n.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function t5(n,e){let t=Ar(n).resolveInner(e+1);return t.parent&&t.from==e}function aie(n,e,t,s){let r=Ar(n).resolveInner(e,-1),a=s.reduce((i,o)=>Math.max(i,o.length),0);for(let i=0;i<5;i++){let o=n.sliceDoc(r.from,Math.min(r.to,r.from+t.length+a)),l=o.indexOf(t);if(!l||l>-1&&s.indexOf(o.slice(0,l))>-1){let u=r.firstChild;for(;u&&u.from==r.from&&u.to-u.from>t.length+l;){if(n.sliceDoc(u.to-t.length,u.to)==t)return!1;u=u.firstChild}return!0}let c=r.to==e&&r.parent;if(!c)break;r=c}return!1}function n5(n,e,t){let s=n.charCategorizer(e);if(s(n.sliceDoc(e-1,e))!=zs.Word)return e;for(let r of t){let a=e-r.length;if(n.sliceDoc(a,e)==r&&s(n.sliceDoc(a-1,a))!=zs.Word)return a}return-1}function iie(n={}){return[Qae,va,Nr.of(n),Iae,lie,T$]}const oie=[{key:"Ctrl-Space",run:tb},{mac:"Alt-`",run:tb},{mac:"Alt-i",run:tb},{key:"Escape",run:D$},{key:"ArrowDown",run:zc(!0)},{key:"ArrowUp",run:zc(!1)},{key:"PageDown",run:zc(!0,"page")},{key:"PageUp",run:zc(!1,"page")},{key:"Enter",run:Kk}],lie=Fi.highest(Pc.computeN([Nr],n=>n.facet(Nr).defaultKeymap?[oie]:[]));function cie(n){let e=n.field(va,!1);return e&&e.active.some(t=>t.isPending)?"pending":e&&e.active.some(t=>t.state!=0)?"active":null}const Q$=[Na("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Na("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Na("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Na("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Na("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Na(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Na("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Na(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Na(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Na('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Na('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],uie=Q$.concat([Na("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Na("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Na("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),s5=new Rse,j$=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Bp(n){return(e,t)=>{let s=e.node.getChild("VariableDefinition");return s&&t(s,n),!0}}const hie=["FunctionDeclaration"],die={FunctionDeclaration:Bp("function"),ClassDeclaration:Bp("class"),ClassExpression:()=>!0,EnumDeclaration:Bp("constant"),TypeAliasDeclaration:Bp("type"),NamespaceDeclaration:Bp("namespace"),VariableDefinition(n,e){n.matchContext(hie)||e(n,"variable")},TypeDefinition(n,e){e(n,"type")},__proto__:null};function V$(n,e){let t=s5.get(e);if(t)return t;let s=[],r=!0;function a(i,o){let l=n.sliceString(i.from,i.to);s.push({label:l,type:o})}return e.cursor(Gs.IncludeAnonymous).iterate(i=>{if(r)r=!1;else if(i.name){let o=die[i.name];if(o&&o(i,a)||j$.has(i.name))return!1}else if(i.to-i.from>8192){for(let o of V$(n,i.node))s.push(o);return!1}}),s5.set(e,s),s}const r5=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Z$=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function pie(n){let e=Ar(n.state).resolveInner(n.pos,-1);if(Z$.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&r5.test(n.state.sliceDoc(e.from,e.to));if(!t&&!n.explicit)return null;let s=[];for(let r=e;r;r=r.parent)j$.has(r.name)&&(s=s.concat(V$(n.state.doc,r)));return{options:s,from:t?e.from:n.pos,validFor:r5}}const Kc=Xb.define({name:"javascript",parser:Bre.configure({props:[a$.add({IfStatement:QO({except:/^\s*({|else\b)/}),TryStatement:QO({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:zre,SwitchBody:n=>{let e=n.textAfter,t=/^\s*\}/.test(e),s=/^\s*(case|default)\b/.test(e);return n.baseIndent+(t?0:s?1:2)*n.unit},Block:Zre({closing:"}"}),ArrowFunction:n=>n.baseIndent+n.unit,"TemplateString BlockComment":()=>null,"Statement Property":QO({except:/^\s*{/}),JSXElement(n){let e=/^\s*<\//.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},JSXEscape(n){let e=/\s*\}/.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},"JSXOpenTag JSXSelfClosingTag"(n){return n.column(n.node.from)+n.unit}}),l$.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":Ure,BlockComment(n){return{from:n.from+2,to:n.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),z$={test:n=>/^JSX/.test(n.name),facet:t$({commentTokens:{block:{open:"{/*",close:"*/}"}}})},mie=Kc.configure({dialect:"ts"},"typescript"),fie=Kc.configure({dialect:"jsx",props:[uP.add(n=>n.isTop?[z$]:void 0)]}),gie=Kc.configure({dialect:"jsx ts",props:[uP.add(n=>n.isTop?[z$]:void 0)]},"typescript");let q$=n=>({label:n,type:"keyword"});const U$="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(q$),bie=U$.concat(["declare","implements","private","protected","public"].map(q$));function yie(n={}){let e=n.jsx?n.typescript?gie:fie:n.typescript?mie:Kc,t=n.typescript?uie.concat(bie):Q$.concat(U$);return new Nre(e,[Kc.data.of({autocomplete:yae(Z$,P$(t))}),Kc.data.of({autocomplete:pie}),n.jsx?wie:[]])}function vie(n){for(;;){if(n.name=="JSXOpenTag"||n.name=="JSXSelfClosingTag"||n.name=="JSXFragmentTag")return n;if(n.name=="JSXEscape"||!n.parent)return null;n=n.parent}}function a5(n,e,t=n.length){for(let s=e==null?void 0:e.firstChild;s;s=s.nextSibling)if(s.name=="JSXIdentifier"||s.name=="JSXBuiltin"||s.name=="JSXNamespacedName"||s.name=="JSXMemberExpression")return n.sliceString(s.from,Math.min(s.to,t));return""}const Oie=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),wie=lt.inputHandler.of((n,e,t,s,r)=>{if((Oie?n.composing:n.compositionStarted)||n.state.readOnly||e!=t||s!=">"&&s!="/"||!Kc.isActiveAt(n.state,e,-1))return!1;let a=r(),{state:i}=a,o=i.changeByRange(l=>{var c;let{head:u}=l,h=Ar(i).resolveInner(u-1,-1),d;if(h.name=="JSXStartTag"&&(h=h.parent),!(i.doc.sliceString(u-1,u)!=s||h.name=="JSXAttributeValue"&&h.to>u)){if(s==">"&&h.name=="JSXFragmentTag")return{range:l,changes:{from:u,insert:"</>"}};if(s=="/"&&h.name=="JSXStartCloseTag"){let m=h.parent,y=m.parent;if(y&&m.from==u-2&&((d=a5(i.doc,y.firstChild,u))||((c=y.firstChild)===null||c===void 0?void 0:c.name)=="JSXFragmentTag")){let O=`${d}>`;return{range:Le.cursor(u+O.length,-1),changes:{from:u,insert:O}}}}else if(s==">"){let m=vie(h);if(m&&m.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(i.doc.sliceString(u,u+2))&&(d=a5(i.doc,m,u)))return{range:l,changes:{from:u,insert:`</${d}>`}}}}return{range:l}});return o.changes.empty?!1:(n.dispatch([a,i.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),xie="#e5c07b",i5="#e06c75",kie="#56b6c2",Sie="#ffffff",nb="#abb2bf",Jk="#7d8799",Cie="#61afef",Pie="#98c379",o5="#d19a66",Aie="#c678dd",Eie="#21252b",l5="#2c313a",c5="#282c34",UO="#353a42",Mie="#3E4451",u5="#528bff",Die=lt.theme({"&":{color:nb,backgroundColor:c5},".cm-content":{caretColor:u5},".cm-cursor, .cm-dropCursor":{borderLeftColor:u5},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Mie},".cm-panels":{backgroundColor:Eie,color:nb},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:c5,color:Jk,border:"none"},".cm-activeLineGutter":{backgroundColor:l5},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:UO},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:UO,borderBottomColor:UO},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:l5,color:nb}}},{dark:!0}),Tie=np.define([{tag:g.keyword,color:Aie},{tag:[g.name,g.deleted,g.character,g.propertyName,g.macroName],color:i5},{tag:[g.function(g.variableName),g.labelName],color:Cie},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:o5},{tag:[g.definition(g.name),g.separator],color:nb},{tag:[g.typeName,g.className,g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:xie},{tag:[g.operator,g.operatorKeyword,g.url,g.escape,g.regexp,g.link,g.special(g.string)],color:kie},{tag:[g.meta,g.comment],color:Jk},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.link,color:Jk,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:i5},{tag:[g.atom,g.bool,g.special(g.variableName)],color:o5},{tag:[g.processingInstruction,g.string,g.inserted],color:Pie},{tag:g.invalid,color:Sie}]),Bie=[Die,nv(Tie)],OP=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),s=wP(n.state,t.from);return s.line?Fie(n):s.block?_ie(n):!1};function Hf(n,e){return({state:t,dispatch:s})=>{if(t.readOnly)return!1;let r=n(e,t);return r?(s(t.update(r)),!0):!1}}const Fie=Hf(xP,0),$ie=Hf(xP,1),Nie=Hf(xP,2),W$=Hf(G$,0),_ie=Hf((n,e)=>G$(n,e,Iie(e)),0);function wP(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const Fp=50;function Rie(n,{open:e,close:t},s,r){let a=n.sliceDoc(s-Fp,s),i=n.sliceDoc(r,r+Fp),o=/\s*$/.exec(a)[0].length,l=/^\s*/.exec(i)[0].length,c=a.length-o;if(a.slice(c-e.length,c)==e&&i.slice(l,l+t.length)==t)return{open:{pos:s-o,margin:o&&1},close:{pos:r+l,margin:l&&1}};let u,h;r-s<=2*Fp?u=h=n.sliceDoc(s,r):(u=n.sliceDoc(s,s+Fp),h=n.sliceDoc(r-Fp,r));let d=/^\s*/.exec(u)[0].length,m=/\s*$/.exec(h)[0].length,y=h.length-m-t.length;return u.slice(d,d+e.length)==e&&h.slice(y,y+t.length)==t?{open:{pos:s+d+e.length,margin:/\s/.test(u.charAt(d+e.length))?1:0},close:{pos:r-m-t.length,margin:/\s/.test(h.charAt(y-1))?1:0}}:null}function Iie(n){let e=[];for(let t of n.selection.ranges){let s=n.doc.lineAt(t.from),r=t.to<=s.to?s:n.doc.lineAt(t.to);r.from>s.from&&r.from==t.to&&(r=t.to==s.to+1?s:n.doc.lineAt(t.to-1));let a=e.length-1;a>=0&&e[a].to>s.from?e[a].to=r.to:e.push({from:s.from+/^\s*/.exec(s.text)[0].length,to:r.to})}return e}function G$(n,e,t=e.selection.ranges){let s=t.map(a=>wP(e,a.from).block);if(!s.every(a=>a))return null;let r=t.map((a,i)=>Rie(e,s[i],a.from,a.to));if(n!=2&&!r.every(a=>a))return{changes:e.changes(t.map((a,i)=>r[i]?[]:[{from:a.from,insert:s[i].open+" "},{from:a.to,insert:" "+s[i].close}]))};if(n!=1&&r.some(a=>a)){let a=[];for(let i=0,o;i<r.length;i++)if(o=r[i]){let l=s[i],{open:c,close:u}=o;a.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:a}}return null}function xP(n,e,t=e.selection.ranges){let s=[],r=-1;e:for(let{from:a,to:i}of t){let o=s.length,l=1e9,c;for(let u=a;u<=i;){let h=e.doc.lineAt(u);if(c==null&&(c=wP(e,h.from).line,!c))continue e;if(h.from>r&&(a==i||i>h.from)){r=h.from;let d=/^\s*/.exec(h.text)[0].length,m=d==h.length,y=h.text.slice(d,d+c.length)==c?d:-1;d<h.text.length&&d<l&&(l=d),s.push({line:h,comment:y,token:c,indent:d,empty:m,single:!1})}u=h.to+1}if(l<1e9)for(let u=o;u<s.length;u++)s[u].indent<s[u].line.text.length&&(s[u].indent=l);s.length==o+1&&(s[o].single=!0)}if(n!=2&&s.some(a=>a.comment<0&&(!a.empty||a.single))){let a=[];for(let{line:o,token:l,indent:c,empty:u,single:h}of s)(h||!u)&&a.push({from:o.from+c,insert:l+" "});let i=e.changes(a);return{changes:i,selection:e.selection.map(i,1)}}else if(n!=1&&s.some(a=>a.comment>=0)){let a=[];for(let{line:i,comment:o,token:l}of s)if(o>=0){let c=i.from+o,u=c+l.length;i.text[u-i.from]==" "&&u++,a.push({from:c,to:u})}return{changes:a}}return null}const e2=Cc.define(),Lie=Cc.define(),Qie=Dt.define(),X$=Dt.define({combine(n){return Ll(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(s,r)=>e(s,r)||t(s,r)})}}),H$=qs.define({create(){return Sl.empty},update(n,e){let t=e.state.facet(X$),s=e.annotation(e2);if(s){let l=ti.fromTransaction(e,s.selection),c=s.side,u=c==0?n.undone:n.done;return l?u=sy(u,u.length,t.minDepth,l):u=J$(u,e.startState.selection),new Sl(c==0?s.rest:u,c==0?u:s.rest)}let r=e.annotation(Lie);if((r=="full"||r=="before")&&(n=n.isolate()),e.annotation(fr.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let a=ti.fromTransaction(e),i=e.annotation(fr.time),o=e.annotation(fr.userEvent);return a?n=n.addChanges(a,i,o,t,e):e.selection&&(n=n.addSelection(e.startState.selection,i,o,t.newGroupDelay)),(r=="full"||r=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Sl(n.done.map(ti.fromJSON),n.undone.map(ti.fromJSON))}});function kP(n={}){return[H$,X$.of(n),lt.domEventHandlers({beforeinput(e,t){let s=e.inputType=="historyUndo"?av:e.inputType=="historyRedo"?Fd:null;return s?(e.preventDefault(),s(t)):!1}})]}function rv(n,e){return function({state:t,dispatch:s}){if(!e&&t.readOnly)return!1;let r=t.field(H$,!1);if(!r)return!1;let a=r.pop(n,t,e);return a?(s(a),!0):!1}}const av=rv(0,!1),Fd=rv(1,!1),Y$=rv(0,!0),jie=rv(1,!0);class ti{constructor(e,t,s,r,a){this.changes=e,this.effects=t,this.mapped=s,this.startSelection=r,this.selectionsAfter=a}setSelAfter(e){return new ti(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,s;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(s=this.startSelection)===null||s===void 0?void 0:s.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new ti(e.changes&&xr.fromJSON(e.changes),[],e.mapped&&El.fromJSON(e.mapped),e.startSelection&&Le.fromJSON(e.startSelection),e.selectionsAfter.map(Le.fromJSON))}static fromTransaction(e,t){let s=no;for(let r of e.startState.facet(Qie)){let a=r(e);a.length&&(s=s.concat(a))}return!s.length&&e.changes.empty?null:new ti(e.changes.invert(e.startState.doc),s,void 0,t||e.startState.selection,no)}static selection(e){return new ti(void 0,no,void 0,void 0,e)}}function sy(n,e,t,s){let r=e+1>t+20?e-t-1:0,a=n.slice(r,e);return a.push(s),a}function Vie(n,e){let t=[],s=!1;return n.iterChangedRanges((r,a)=>t.push(r,a)),e.iterChangedRanges((r,a,i,o)=>{for(let l=0;l<t.length;){let c=t[l++],u=t[l++];o>=c&&i<=u&&(s=!0)}}),s}function Zie(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,s)=>t.empty!=e.ranges[s].empty).length===0}function K$(n,e){return n.length?e.length?n.concat(e):n:e}const no=[],zie=200;function J$(n,e){if(n.length){let t=n[n.length-1],s=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-zie));return s.length&&s[s.length-1].eq(e)?n:(s.push(e),sy(n,n.length-1,1e9,t.setSelAfter(s)))}else return[ti.selection([e])]}function qie(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function WO(n,e){if(!n.length)return n;let t=n.length,s=no;for(;t;){let r=Uie(n[t-1],e,s);if(r.changes&&!r.changes.empty||r.effects.length){let a=n.slice(0,t);return a[t-1]=r,a}else e=r.mapped,t--,s=r.selectionsAfter}return s.length?[ti.selection(s)]:no}function Uie(n,e,t){let s=K$(n.selectionsAfter.length?n.selectionsAfter.map(o=>o.map(e)):no,t);if(!n.changes)return ti.selection(s);let r=n.changes.map(e),a=e.mapDesc(n.changes,!0),i=n.mapped?n.mapped.composeDesc(a):a;return new ti(r,rn.mapEffects(n.effects,e),i,n.startSelection.map(a),s)}const Wie=/^(input\.type|delete)($|\.)/;class Sl{constructor(e,t,s=0,r=void 0){this.done=e,this.undone=t,this.prevTime=s,this.prevUserEvent=r}isolate(){return this.prevTime?new Sl(this.done,this.undone):this}addChanges(e,t,s,r,a){let i=this.done,o=i[i.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!s||Wie.test(s))&&(!o.selectionsAfter.length&&t-this.prevTime<r.newGroupDelay&&r.joinToEvent(a,Vie(o.changes,e.changes))||s=="input.type.compose")?i=sy(i,i.length-1,r.minDepth,new ti(e.changes.compose(o.changes),K$(rn.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,no)):i=sy(i,i.length,r.minDepth,e),new Sl(i,no,t,s)}addSelection(e,t,s,r){let a=this.done.length?this.done[this.done.length-1].selectionsAfter:no;return a.length>0&&t-this.prevTime<r&&s==this.prevUserEvent&&s&&/^select($|\.)/.test(s)&&Zie(a[a.length-1],e)?this:new Sl(J$(this.done,e),this.undone,t,s)}addMapping(e){return new Sl(WO(this.done,e),WO(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,s){let r=e==0?this.done:this.undone;if(r.length==0)return null;let a=r[r.length-1],i=a.selectionsAfter[0]||(a.startSelection?a.startSelection.map(a.changes.invertedDesc,1):t.selection);if(s&&a.selectionsAfter.length)return t.update({selection:a.selectionsAfter[a.selectionsAfter.length-1],annotations:e2.of({side:e,rest:qie(r),selection:i}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(a.changes){let o=r.length==1?no:r.slice(0,r.length-1);return a.mapped&&(o=WO(o,a.mapped)),t.update({changes:a.changes,selection:a.startSelection,effects:a.effects,annotations:e2.of({side:e,rest:o,selection:i}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Sl.empty=new Sl(no,no);const SP=[{key:"Mod-z",run:av,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Fd,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Fd,preventDefault:!0},{key:"Mod-u",run:Y$,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:jie,preventDefault:!0}];function rp(n,e){return Le.create(n.ranges.map(e),n.mainIndex)}function Ko(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Jo({state:n,dispatch:e},t){let s=rp(n.selection,t);return s.eq(n.selection,!0)?!1:(e(Ko(n,s)),!0)}function iv(n,e){return Le.cursor(e?n.to:n.from)}function CP(n,e){return Jo(n,t=>t.empty?n.moveByChar(t,e):iv(t,e))}function ca(n){return n.textDirectionAt(n.state.selection.main.head)==fs.LTR}const nf=n=>CP(n,!ca(n)),ry=n=>CP(n,ca(n)),Gie=n=>CP(n,!1);function e8(n,e){return Jo(n,t=>t.empty?n.moveByGroup(t,e):iv(t,e))}const t8=n=>e8(n,!ca(n)),n8=n=>e8(n,ca(n));function Xie(n,e,t){if(e.type.prop(t))return!0;let s=e.to-e.from;return s&&(s>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function ov(n,e,t){let s=Ar(n).resolveInner(e.head),r=t?Qn.closedBy:Qn.openedBy;for(let l=e.head;;){let c=t?s.childAfter(l):s.childBefore(l);if(!c)break;Xie(n,c,r)?s=c:l=t?c.to:c.from}let a=s.type.prop(r),i,o;return a&&(i=t?eo(n,s.from,1):eo(n,s.to,-1))&&i.matched?o=t?i.end.to:i.end.from:o=t?s.to:s.from,Le.cursor(o,t?-1:1)}const Hie=n=>Jo(n,e=>ov(n.state,e,!ca(n))),Yie=n=>Jo(n,e=>ov(n.state,e,ca(n)));function s8(n,e){return Jo(n,t=>{if(!t.empty)return iv(t,e);let s=n.moveVertically(t,e);return s.head!=t.head?s:n.moveToLineBoundary(t,e)})}const ay=n=>s8(n,!1),iy=n=>s8(n,!0);function r8(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,s=0,r;if(e){for(let a of n.state.facet(lt.scrollMargins)){let i=a(n);i!=null&&i.top&&(t=Math.max(i==null?void 0:i.top,t)),i!=null&&i.bottom&&(s=Math.max(i==null?void 0:i.bottom,s))}r=n.scrollDOM.clientHeight-t-s}else r=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:s,selfScroll:e,height:Math.max(n.defaultLineHeight,r-5)}}function a8(n,e){let t=r8(n),{state:s}=n,r=rp(s.selection,i=>i.empty?n.moveVertically(i,e,t.height):iv(i,e));if(r.eq(s.selection))return!1;let a;if(t.selfScroll){let i=n.coordsAtPos(s.selection.main.head),o=n.scrollDOM.getBoundingClientRect(),l=o.top+t.marginTop,c=o.bottom-t.marginBottom;i&&i.top>l&&i.bottom<c&&(a=lt.scrollIntoView(r.main.head,{y:"start",yMargin:i.top-l}))}return n.dispatch(Ko(s,r),{effects:a}),!0}const Tm=n=>a8(n,!1),cd=n=>a8(n,!0);function Cu(n,e,t){let s=n.lineBlockAt(e.head),r=n.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?s.to:s.from)&&(r=n.moveToLineBoundary(e,t,!1)),!t&&r.head==s.from&&s.length){let a=/^\s*/.exec(n.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;a&&e.head!=s.from+a&&(r=Le.cursor(s.from+a))}return r}const oy=n=>Jo(n,e=>Cu(n,e,!0)),ly=n=>Jo(n,e=>Cu(n,e,!1)),Kie=n=>Jo(n,e=>Cu(n,e,!ca(n))),Jie=n=>Jo(n,e=>Cu(n,e,ca(n))),i8=n=>Jo(n,e=>Le.cursor(n.lineBlockAt(e.head).from,1)),o8=n=>Jo(n,e=>Le.cursor(n.lineBlockAt(e.head).to,-1));function eoe(n,e,t){let s=!1,r=rp(n.selection,a=>{let i=eo(n,a.head,-1)||eo(n,a.head,1)||a.head>0&&eo(n,a.head-1,1)||a.head<n.doc.length&&eo(n,a.head+1,-1);if(!i||!i.end)return a;s=!0;let o=i.start.from==a.head?i.end.to:i.end.from;return Le.cursor(o)});return s?(e(Ko(n,r)),!0):!1}const l8=({state:n,dispatch:e})=>eoe(n,e);function po(n,e){let t=rp(n.state.selection,s=>{let r=e(s);return Le.range(s.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(Ko(n.state,t)),!0)}function c8(n,e){return po(n,t=>n.moveByChar(t,e))}const cy=n=>c8(n,!ca(n)),uy=n=>c8(n,ca(n));function u8(n,e){return po(n,t=>n.moveByGroup(t,e))}const h8=n=>u8(n,!ca(n)),d8=n=>u8(n,ca(n)),toe=n=>po(n,e=>ov(n.state,e,!ca(n))),noe=n=>po(n,e=>ov(n.state,e,ca(n)));function p8(n,e){return po(n,t=>n.moveVertically(t,e))}const hy=n=>p8(n,!1),dy=n=>p8(n,!0);function m8(n,e){return po(n,t=>n.moveVertically(t,e,r8(n).height))}const py=n=>m8(n,!1),my=n=>m8(n,!0),t2=n=>po(n,e=>Cu(n,e,!0)),n2=n=>po(n,e=>Cu(n,e,!1)),soe=n=>po(n,e=>Cu(n,e,!ca(n))),roe=n=>po(n,e=>Cu(n,e,ca(n))),f8=n=>po(n,e=>Le.cursor(n.lineBlockAt(e.head).from)),g8=n=>po(n,e=>Le.cursor(n.lineBlockAt(e.head).to)),fy=({state:n,dispatch:e})=>(e(Ko(n,{anchor:0})),!0),gy=({state:n,dispatch:e})=>(e(Ko(n,{anchor:n.doc.length})),!0),by=({state:n,dispatch:e})=>(e(Ko(n,{anchor:n.selection.main.anchor,head:0})),!0),yy=({state:n,dispatch:e})=>(e(Ko(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),b8=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),y8=({state:n,dispatch:e})=>{let t=lv(n).map(({from:s,to:r})=>Le.range(s,Math.min(r+1,n.doc.length)));return e(n.update({selection:Le.create(t),userEvent:"select"})),!0},aoe=({state:n,dispatch:e})=>{let t=rp(n.selection,s=>{let r=Ar(n),a=r.resolveStack(s.from,1);if(s.empty){let i=r.resolveStack(s.from,-1);i.node.from>=a.node.from&&i.node.to<=a.node.to&&(a=i)}for(let i=a;i;i=i.next){let{node:o}=i;if((o.from<s.from&&o.to>=s.to||o.to>s.to&&o.from<=s.from)&&i.next)return Le.range(o.to,o.from)}return s});return t.eq(n.selection)?!1:(e(Ko(n,t)),!0)};function v8(n,e){let{state:t}=n,s=t.selection,r=t.selection.ranges.slice();for(let a of t.selection.ranges){let i=t.doc.lineAt(a.head);if(e?i.to<n.state.doc.length:i.from>0)for(let o=a;;){let l=n.moveVertically(o,e);if(l.head<i.from||l.head>i.to){r.some(c=>c.head==l.head)||r.push(l);break}else{if(l.head==o.head)break;o=l}}}return r.length==s.ranges.length?!1:(n.dispatch(Ko(t,Le.create(r,r.length-1))),!0)}const ioe=n=>v8(n,!1),ooe=n=>v8(n,!0),loe=({state:n,dispatch:e})=>{let t=n.selection,s=null;return t.ranges.length>1?s=Le.create([t.main]):t.main.empty||(s=Le.create([Le.cursor(t.main.head)])),s?(e(Ko(n,s)),!0):!1};function ap(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:s}=n,r=s.changeByRange(a=>{let{from:i,to:o}=a;if(i==o){let l=e(a);l<i?(t="delete.backward",l=Qg(n,l,!1)):l>i&&(t="delete.forward",l=Qg(n,l,!0)),i=Math.min(i,l),o=Math.max(o,l)}else i=Qg(n,i,!1),o=Qg(n,o,!0);return i==o?{range:a}:{changes:{from:i,to:o},range:Le.cursor(i,i<a.head?-1:1)}});return r.changes.empty?!1:(n.dispatch(s.update(r,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?lt.announce.of(s.phrase("Selection deleted")):void 0})),!0)}function Qg(n,e,t){if(n instanceof lt)for(let s of n.state.facet(lt.atomicRanges).map(r=>r(n)))s.between(e,e,(r,a)=>{r<e&&a>e&&(e=t?a:r)});return e}const O8=(n,e,t)=>ap(n,s=>{let r=s.from,{state:a}=n,i=a.doc.lineAt(r),o,l;if(t&&!e&&r>i.from&&r<i.from+200&&!/[^ \t]/.test(o=i.text.slice(0,r-i.from))){if(o[o.length-1]=="	")return r-1;let c=tp(o,a.tabSize),u=c%Yb(a)||Yb(a);for(let h=0;h<u&&o[o.length-1-h]==" ";h++)r--;l=r}else l=Rr(i.text,r-i.from,e,e)+i.from,l==r&&i.number!=(e?a.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(i.text.slice(l-i.from,r-i.from))&&(l=Rr(i.text,l-i.from,!1,!1)+i.from);return l}),ud=n=>O8(n,!1,!0),vy=n=>O8(n,!0,!1),w8=(n,e)=>ap(n,t=>{let s=t.head,{state:r}=n,a=r.doc.lineAt(s),i=r.charCategorizer(s);for(let o=null;;){if(s==(e?a.to:a.from)){s==t.head&&a.number!=(e?r.doc.lines:1)&&(s+=e?1:-1);break}let l=Rr(a.text,s-a.from,e)+a.from,c=a.text.slice(Math.min(s,l)-a.from,Math.max(s,l)-a.from),u=i(c);if(o!=null&&u!=o)break;(c!=" "||s!=t.head)&&(o=u),s=l}return s}),Oy=n=>w8(n,!1),x8=n=>w8(n,!0),s2=n=>ap(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),coe=n=>ap(n,e=>{let t=n.lineBlockAt(e.head).from;return e.head>t?t:Math.max(0,e.head-1)}),uoe=n=>ap(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),hoe=n=>ap(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),PP=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:us.of(["",""])},range:Le.cursor(s.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},k8=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(s=>{if(!s.empty||s.from==0||s.from==n.doc.length)return{range:s};let r=s.from,a=n.doc.lineAt(r),i=r==a.from?r-1:Rr(a.text,r-a.from,!1)+a.from,o=r==a.to?r+1:Rr(a.text,r-a.from,!0)+a.from;return{changes:{from:i,to:o,insert:n.doc.slice(r,o).append(n.doc.slice(i,r))},range:Le.cursor(o)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function lv(n){let e=[],t=-1;for(let s of n.selection.ranges){let r=n.doc.lineAt(s.from),a=n.doc.lineAt(s.to);if(!s.empty&&s.to==a.from&&(a=n.doc.lineAt(s.to-1)),t>=r.number){let i=e[e.length-1];i.to=a.to,i.ranges.push(s)}else e.push({from:r.from,to:a.to,ranges:[s]});t=a.number+1}return e}function S8(n,e,t){if(n.readOnly)return!1;let s=[],r=[];for(let a of lv(n)){if(t?a.to==n.doc.length:a.from==0)continue;let i=n.doc.lineAt(t?a.to+1:a.from-1),o=i.length+1;if(t){s.push({from:a.to,to:i.to},{from:a.from,insert:i.text+n.lineBreak});for(let l of a.ranges)r.push(Le.range(Math.min(n.doc.length,l.anchor+o),Math.min(n.doc.length,l.head+o)))}else{s.push({from:i.from,to:a.from},{from:a.to,insert:n.lineBreak+i.text});for(let l of a.ranges)r.push(Le.range(l.anchor-o,l.head-o))}}return s.length?(e(n.update({changes:s,scrollIntoView:!0,selection:Le.create(r,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const C8=({state:n,dispatch:e})=>S8(n,e,!1),P8=({state:n,dispatch:e})=>S8(n,e,!0);function A8(n,e,t){if(n.readOnly)return!1;let s=[];for(let a of lv(n))t?s.push({from:a.from,insert:n.doc.slice(a.from,a.to)+n.lineBreak}):s.push({from:a.to,insert:n.lineBreak+n.doc.slice(a.from,a.to)});let r=n.changes(s);return e(n.update({changes:r,selection:n.selection.map(r,t?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const E8=({state:n,dispatch:e})=>A8(n,e,!1),M8=({state:n,dispatch:e})=>A8(n,e,!0),D8=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(lv(e).map(({from:r,to:a})=>(r>0?r--:a<e.doc.length&&a++,{from:r,to:a}))),s=rp(e.selection,r=>{let a;if(n.lineWrapping){let i=n.lineBlockAt(r.head),o=n.coordsAtPos(r.head,r.assoc||1);o&&(a=i.bottom+n.documentTop-o.bottom+n.defaultLineHeight/2)}return n.moveVertically(r,!0,a)}).map(t);return n.dispatch({changes:t,selection:s,scrollIntoView:!0,userEvent:"delete.line"}),!0};function doe(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Ar(n).resolveInner(e),s=t.childBefore(e),r=t.childAfter(e),a;return s&&r&&s.to<=e&&r.from>=e&&(a=s.type.prop(Qn.closedBy))&&a.indexOf(r.name)>-1&&n.doc.lineAt(s.to).from==n.doc.lineAt(r.from).from&&!/\S/.test(n.sliceDoc(s.to,r.from))?{from:s.to,to:r.from}:null}const sf=T8(!1),poe=T8(!0);function T8(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let s=e.changeByRange(r=>{let{from:a,to:i}=r,o=e.doc.lineAt(a),l=!n&&a==i&&doe(e,a);n&&(a=i=(i<=o.to?o:e.doc.lineAt(i)).to);let c=new ev(e,{simulateBreak:a,simulateDoubleBreak:!!l}),u=r$(c,a);for(u==null&&(u=tp(/^\s*/.exec(e.doc.lineAt(a).text)[0],e.tabSize));i<o.to&&/\s/.test(o.text[i-o.from]);)i++;l?{from:a,to:i}=l:a>o.from&&a<o.from+100&&!/\S/.test(o.text.slice(0,a))&&(a=o.from);let h=["",Kb(e,u)];return l&&h.push(Kb(e,c.lineIndent(o.from,-1))),{changes:{from:a,to:i,insert:us.of(h)},range:Le.cursor(a+1+h[1].length)}});return t(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function AP(n,e){let t=-1;return n.changeByRange(s=>{let r=[];for(let i=s.from;i<=s.to;){let o=n.doc.lineAt(i);o.number>t&&(s.empty||s.to>o.from)&&(e(o,r,s),t=o.number),i=o.to+1}let a=n.changes(r);return{changes:r,range:Le.range(a.mapPos(s.anchor,1),a.mapPos(s.head,1))}})}const B8=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),s=new ev(n,{overrideIndentation:a=>{let i=t[a];return i??-1}}),r=AP(n,(a,i,o)=>{let l=r$(s,a.from);if(l==null)return;/\S/.test(a.text)||(l=0);let c=/^\s*/.exec(a.text)[0],u=Kb(n,l);(c!=u||o.from<a.from+c.length)&&(t[a.from]=l,i.push({from:a.from,to:a.from+c.length,insert:u}))});return r.changes.empty||e(n.update(r,{userEvent:"indent"})),!0},rf=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(AP(n,(t,s)=>{s.push({from:t.from,insert:n.facet(Bd)})}),{userEvent:"input.indent"})),!0),af=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(AP(n,(t,s)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let a=tp(r,n.tabSize),i=0,o=Kb(n,Math.max(0,a-Yb(n)));for(;i<r.length&&i<o.length&&r.charCodeAt(i)==o.charCodeAt(i);)i++;s.push({from:t.from+i,to:t.from+r.length,insert:o.slice(i)})}),{userEvent:"delete.dedent"})),!0),moe=n=>(n.setTabFocusMode(),!0),foe=[{key:"Ctrl-b",run:nf,shift:cy,preventDefault:!0},{key:"Ctrl-f",run:ry,shift:uy},{key:"Ctrl-p",run:ay,shift:hy},{key:"Ctrl-n",run:iy,shift:dy},{key:"Ctrl-a",run:i8,shift:f8},{key:"Ctrl-e",run:o8,shift:g8},{key:"Ctrl-d",run:vy},{key:"Ctrl-h",run:ud},{key:"Ctrl-k",run:s2},{key:"Ctrl-Alt-h",run:Oy},{key:"Ctrl-o",run:PP},{key:"Ctrl-t",run:k8},{key:"Ctrl-v",run:cd}],goe=[{key:"ArrowLeft",run:nf,shift:cy,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t8,shift:h8,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Kie,shift:soe,preventDefault:!0},{key:"ArrowRight",run:ry,shift:uy,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:n8,shift:d8,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Jie,shift:roe,preventDefault:!0},{key:"ArrowUp",run:ay,shift:hy,preventDefault:!0},{mac:"Cmd-ArrowUp",run:fy,shift:by},{mac:"Ctrl-ArrowUp",run:Tm,shift:py},{key:"ArrowDown",run:iy,shift:dy,preventDefault:!0},{mac:"Cmd-ArrowDown",run:gy,shift:yy},{mac:"Ctrl-ArrowDown",run:cd,shift:my},{key:"PageUp",run:Tm,shift:py},{key:"PageDown",run:cd,shift:my},{key:"Home",run:ly,shift:n2,preventDefault:!0},{key:"Mod-Home",run:fy,shift:by},{key:"End",run:oy,shift:t2,preventDefault:!0},{key:"Mod-End",run:gy,shift:yy},{key:"Enter",run:sf,shift:sf},{key:"Mod-a",run:b8},{key:"Backspace",run:ud,shift:ud,preventDefault:!0},{key:"Delete",run:vy,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Oy,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:x8,preventDefault:!0},{mac:"Mod-Backspace",run:uoe,preventDefault:!0},{mac:"Mod-Delete",run:hoe,preventDefault:!0}].concat(foe.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),cv=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Hie,shift:toe},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Yie,shift:noe},{key:"Alt-ArrowUp",run:C8},{key:"Shift-Alt-ArrowUp",run:E8},{key:"Alt-ArrowDown",run:P8},{key:"Shift-Alt-ArrowDown",run:M8},{key:"Mod-Alt-ArrowUp",run:ioe},{key:"Mod-Alt-ArrowDown",run:ooe},{key:"Escape",run:loe},{key:"Mod-Enter",run:poe},{key:"Alt-l",mac:"Ctrl-l",run:y8},{key:"Mod-i",run:aoe,preventDefault:!0},{key:"Mod-[",run:af},{key:"Mod-]",run:rf},{key:"Mod-Alt-\\",run:B8},{key:"Shift-Mod-k",run:D8},{key:"Shift-Mod-\\",run:l8},{key:"Mod-/",run:OP},{key:"Alt-A",run:W$},{key:"Ctrl-m",mac:"Shift-Alt-m",run:moe}].concat(goe),boe={key:"Tab",run:rf,shift:af},h5=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class $d{constructor(e,t,s=0,r=e.length,a,i){this.test=i,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(s,r),this.bufferStart=s,this.normalize=a?o=>a(h5(o)):h5,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ha(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=jC(e),s=this.bufferStart+this.bufferPos;this.bufferPos+=fl(e);let r=this.normalize(t);if(r.length)for(let a=0,i=s;;a++){let o=r.charCodeAt(a),l=this.match(o,i,this.bufferPos+this.bufferStart);if(a==r.length-1){if(l)return this.value=l,this;break}i==s&&a<t.length&&t.charCodeAt(a)==o&&i++}}}match(e,t,s){let r=null;for(let a=0;a<this.matches.length;a+=2){let i=this.matches[a],o=!1;this.query.charCodeAt(i)==e&&(i==this.query.length-1?r={from:this.matches[a+1],to:s}:(this.matches[a]++,o=!0)),o||(this.matches.splice(a,2),a-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:t,to:s}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&($d.prototype[Symbol.iterator]=function(){return this});const F8={from:-1,to:-1,match:/.*/.exec("")},EP="gm"+(/x/.unicode==null?"":"u");class MP{constructor(e,t,s,r=0,a=e.length){if(this.text=e,this.to=a,this.curLine="",this.done=!1,this.value=F8,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new $8(e,t,s,r,a);this.re=new RegExp(t,EP+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.iter=e.iter();let i=e.lineAt(r);this.curLineStart=i.from,this.matchPos=wy(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let s=this.curLineStart+t.index,r=s+t[0].length;if(this.matchPos=wy(this.text,r+(s==r?1:0)),s==this.curLineStart+this.curLine.length&&this.nextLine(),(s<r||s>this.value.to)&&(!this.test||this.test(s,r,t)))return this.value={from:s,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const GO=new WeakMap;class hd{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,s){let r=GO.get(e);if(!r||r.from>=s||r.to<=t){let o=new hd(t,e.sliceString(t,s));return GO.set(e,o),o}if(r.from==t&&r.to==s)return r;let{text:a,from:i}=r;return i>t&&(a=e.sliceString(t,i)+a,i=t),r.to<s&&(a+=e.sliceString(r.to,s)),GO.set(e,new hd(i,a)),new hd(t,a.slice(t-i,s-i))}}class $8{constructor(e,t,s,r,a){this.text=e,this.to=a,this.done=!1,this.value=F8,this.matchPos=wy(e,r),this.re=new RegExp(t,EP+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.flat=hd.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let s=this.flat.from+t.index,r=s+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(s,r,t)))return this.value={from:s,to:r,match:t},this.matchPos=wy(this.text,r+(s==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=hd.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(MP.prototype[Symbol.iterator]=$8.prototype[Symbol.iterator]=function(){return this});function yoe(n){try{return new RegExp(n,EP),!0}catch{return!1}}function wy(n,e){if(e>=n.length)return e;let t=n.lineAt(e),s;for(;e<t.to&&(s=t.text.charCodeAt(e-t.from))>=56320&&s<57344;)e++;return e}const voe=n=>{let{state:e}=n,t=String(e.doc.lineAt(n.state.selection.main.head).number),{close:s,result:r}=bse(n,{label:e.phrase("Go to line"),input:{type:"text",name:"line",value:t},focus:!0,submitLabel:e.phrase("go")});return r.then(a=>{let i=a&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(a.elements.line.value);if(!i){n.dispatch({effects:s});return}let o=e.doc.lineAt(e.selection.main.head),[,l,c,u,h]=i,d=u?+u.slice(1):0,m=c?+c:o.number;if(c&&h){let S=m/100;l&&(S=S*(l=="-"?-1:1)+o.number/e.doc.lines),m=Math.round(e.doc.lines*S)}else c&&l&&(m=m*(l=="-"?-1:1)+o.number);let y=e.doc.line(Math.max(1,Math.min(e.doc.lines,m))),O=Le.cursor(y.from+Math.max(0,Math.min(d,y.length)));n.dispatch({effects:[s,lt.scrollIntoView(O.from,{y:"center"})],selection:O})}),!0},Ooe={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},woe=Dt.define({combine(n){return Ll(n,Ooe,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function xoe(n){return[Aoe,Poe]}const koe=At.mark({class:"cm-selectionMatch"}),Soe=At.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function d5(n,e,t,s){return(t==0||n(e.sliceDoc(t-1,t))!=zs.Word)&&(s==e.doc.length||n(e.sliceDoc(s,s+1))!=zs.Word)}function Coe(n,e,t,s){return n(e.sliceDoc(t,t+1))==zs.Word&&n(e.sliceDoc(s-1,s))==zs.Word}const Poe=Ns.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(woe),{state:t}=n,s=t.selection;if(s.ranges.length>1)return At.none;let r=s.main,a,i=null;if(r.empty){if(!e.highlightWordAroundCursor)return At.none;let l=t.wordAt(r.head);if(!l)return At.none;i=t.charCategorizer(r.head),a=t.sliceDoc(l.from,l.to)}else{let l=r.to-r.from;if(l<e.minSelectionLength||l>200)return At.none;if(e.wholeWords){if(a=t.sliceDoc(r.from,r.to),i=t.charCategorizer(r.head),!(d5(i,t,r.from,r.to)&&Coe(i,t,r.from,r.to)))return At.none}else if(a=t.sliceDoc(r.from,r.to),!a)return At.none}let o=[];for(let l of n.visibleRanges){let c=new $d(t.doc,a,l.from,l.to);for(;!c.next().done;){let{from:u,to:h}=c.value;if((!i||d5(i,t,u,h))&&(r.empty&&u<=r.from&&h>=r.to?o.push(Soe.range(u,h)):(u>=r.to||h<=r.from)&&o.push(koe.range(u,h)),o.length>e.maxMatches))return At.none}}return At.set(o)}},{decorations:n=>n.decorations}),Aoe=lt.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Eoe=({state:n,dispatch:e})=>{let{selection:t}=n,s=Le.create(t.ranges.map(r=>n.wordAt(r.head)||Le.cursor(r.head)),t.mainIndex);return s.eq(t)?!1:(e(n.update({selection:s})),!0)};function Moe(n,e){let{main:t,ranges:s}=n.selection,r=n.wordAt(t.head),a=r&&r.from==t.from&&r.to==t.to;for(let i=!1,o=new $d(n.doc,e,s[s.length-1].to);;)if(o.next(),o.done){if(i)return null;o=new $d(n.doc,e,0,Math.max(0,s[s.length-1].from-1)),i=!0}else{if(i&&s.some(l=>l.from==o.value.from))continue;if(a){let l=n.wordAt(o.value.from);if(!l||l.from!=o.value.from||l.to!=o.value.to)continue}return o.value}}const Doe=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(a=>a.from===a.to))return Eoe({state:n,dispatch:e});let s=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(a=>n.sliceDoc(a.from,a.to)!=s))return!1;let r=Moe(n,s);return r?(e(n.update({selection:n.selection.addRange(Le.range(r.from,r.to),!1),effects:lt.scrollIntoView(r.to)})),!0):!1},ip=Dt.define({combine(n){return Ll(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new joe(e),scrollToMatch:e=>lt.scrollIntoView(e)})}});class DP{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||yoe(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,s)=>s=="n"?`
`:s=="r"?"\r":s=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new _oe(this):new Foe(this)}getCursor(e,t=0,s){let r=e.doc?e:ls.create({doc:e});return s==null&&(s=r.doc.length),this.regexp?Lh(this,r,t,s):Ih(this,r,t,s)}}class N8{constructor(e){this.spec=e}}function Toe(n,e,t){return(s,r,a,i)=>{if(t&&!t(s,r,a,i))return!1;let o=s>=i&&r<=i+a.length?a.slice(s-i,r-i):e.doc.sliceString(s,r);return n(o,e,s,r)}}function Ih(n,e,t,s){let r;return n.wholeWord&&(r=Boe(e.doc,e.charCategorizer(e.selection.main.head))),n.test&&(r=Toe(n.test,e,r)),new $d(e.doc,n.unquoted,t,s,n.caseSensitive?void 0:a=>a.toLowerCase(),r)}function Boe(n,e){return(t,s,r,a)=>((a>t||a+r.length<s)&&(a=Math.max(0,t-2),r=n.sliceString(a,Math.min(n.length,s+2))),(e(xy(r,t-a))!=zs.Word||e(ky(r,t-a))!=zs.Word)&&(e(ky(r,s-a))!=zs.Word||e(xy(r,s-a))!=zs.Word))}class Foe extends N8{constructor(e){super(e)}nextMatch(e,t,s){let r=Ih(this.spec,e,s,e.doc.length).nextOverlapping();if(r.done){let a=Math.min(e.doc.length,t+this.spec.unquoted.length);r=Ih(this.spec,e,0,a).nextOverlapping()}return r.done||r.value.from==t&&r.value.to==s?null:r.value}prevMatchInRange(e,t,s){for(let r=s;;){let a=Math.max(t,r-1e4-this.spec.unquoted.length),i=Ih(this.spec,e,a,r),o=null;for(;!i.nextOverlapping().done;)o=i.value;if(o)return o;if(a==t)return null;r-=1e4}}prevMatch(e,t,s){let r=this.prevMatchInRange(e,0,t);return r||(r=this.prevMatchInRange(e,Math.max(0,s-this.spec.unquoted.length),e.doc.length)),r&&(r.from!=t||r.to!=s)?r:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let s=Ih(this.spec,e,0,e.doc.length),r=[];for(;!s.next().done;){if(r.length>=t)return null;r.push(s.value)}return r}highlight(e,t,s,r){let a=Ih(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(s+this.spec.unquoted.length,e.doc.length));for(;!a.next().done;)r(a.value.from,a.value.to)}}function $oe(n,e,t){return(s,r,a)=>(!t||t(s,r,a))&&n(a[0],e,s,r)}function Lh(n,e,t,s){let r;return n.wholeWord&&(r=Noe(e.charCategorizer(e.selection.main.head))),n.test&&(r=$oe(n.test,e,r)),new MP(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:r},t,s)}function xy(n,e){return n.slice(Rr(n,e,!1),e)}function ky(n,e){return n.slice(e,Rr(n,e))}function Noe(n){return(e,t,s)=>!s[0].length||(n(xy(s.input,s.index))!=zs.Word||n(ky(s.input,s.index))!=zs.Word)&&(n(ky(s.input,s.index+s[0].length))!=zs.Word||n(xy(s.input,s.index+s[0].length))!=zs.Word)}class _oe extends N8{nextMatch(e,t,s){let r=Lh(this.spec,e,s,e.doc.length).next();return r.done&&(r=Lh(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,s){for(let r=1;;r++){let a=Math.max(t,s-r*1e4),i=Lh(this.spec,e,a,s),o=null;for(;!i.next().done;)o=i.value;if(o&&(a==t||o.from>a+10))return o;if(a==t)return null}}prevMatch(e,t,s){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,s,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,s)=>{if(s=="&")return e.match[0];if(s=="$")return"$";for(let r=s.length;r>0;r--){let a=+s.slice(0,r);if(a>0&&a<e.match.length)return e.match[a]+s.slice(r)}return t})}matchAll(e,t){let s=Lh(this.spec,e,0,e.doc.length),r=[];for(;!s.next().done;){if(r.length>=t)return null;r.push(s.value)}return r}highlight(e,t,s,r){let a=Lh(this.spec,e,Math.max(0,t-250),Math.min(s+250,e.doc.length));for(;!a.next().done;)r(a.value.from,a.value.to)}}const mu=rn.define(),TP=rn.define(),Jc=qs.define({create(n){return new XO(r2(n).create(),null)},update(n,e){for(let t of e.effects)t.is(mu)?n=new XO(t.value.create(),n.panel):t.is(TP)&&(n=new XO(n.query,t.value?BP:null));return n},provide:n=>hu.from(n,e=>e.panel)});class XO{constructor(e,t){this.query=e,this.panel=t}}const Roe=At.mark({class:"cm-searchMatch"}),Ioe=At.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Loe=Ns.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(Jc))}update(n){let e=n.state.field(Jc);(e!=n.startState.field(Jc)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return At.none;let{view:t}=this,s=new qo;for(let r=0,a=t.visibleRanges,i=a.length;r<i;r++){let{from:o,to:l}=a[r];for(;r<i-1&&l>a[r+1].from-500;)l=a[++r].to;n.highlight(t.state,o,l,(c,u)=>{let h=t.state.selection.ranges.some(d=>d.from==c&&d.to==u);s.add(c,u,h?Ioe:Roe)})}return s.finish()}},{decorations:n=>n.decorations});function Yf(n){return e=>{let t=e.state.field(Jc,!1);return t&&t.query.spec.valid?n(e,t):Q8(e)}}const p5=Yf((n,{query:e})=>{let{to:t}=n.state.selection.main,s=e.nextMatch(n.state,t,t);if(!s)return!1;let r=Le.single(s.from,s.to),a=n.state.facet(ip);return n.dispatch({selection:r,effects:[FP(n,s),a.scrollToMatch(r.main,n)],userEvent:"select.search"}),L8(n),!0}),m5=Yf((n,{query:e})=>{let{state:t}=n,{from:s}=t.selection.main,r=e.prevMatch(t,s,s);if(!r)return!1;let a=Le.single(r.from,r.to),i=n.state.facet(ip);return n.dispatch({selection:a,effects:[FP(n,r),i.scrollToMatch(a.main,n)],userEvent:"select.search"}),L8(n),!0}),_8=Yf((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:Le.create(t.map(s=>Le.range(s.from,s.to))),userEvent:"select.search.matches"}),!0)}),Qoe=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:s,to:r}=t.main,a=[],i=0;for(let o=new $d(n.doc,n.sliceDoc(s,r));!o.next().done;){if(a.length>1e3)return!1;o.value.from==s&&(i=a.length),a.push(Le.range(o.value.from,o.value.to))}return e(n.update({selection:Le.create(a,i),userEvent:"select.search.matches"})),!0},f5=Yf((n,{query:e})=>{let{state:t}=n,{from:s,to:r}=t.selection.main;if(t.readOnly)return!1;let a=e.nextMatch(t,s,s);if(!a)return!1;let i=a,o=[],l,c,u=[];i.from==s&&i.to==r&&(c=t.toText(e.getReplacement(i)),o.push({from:i.from,to:i.to,insert:c}),i=e.nextMatch(t,i.from,i.to),u.push(lt.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(s).number)+".")));let h=n.state.changes(o);return i&&(l=Le.single(i.from,i.to).map(h),u.push(FP(n,i)),u.push(t.facet(ip).scrollToMatch(l.main,n))),n.dispatch({changes:h,selection:l,effects:u,userEvent:"input.replace"}),!0}),R8=Yf((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(r=>{let{from:a,to:i}=r;return{from:a,to:i,insert:e.getReplacement(r)}});if(!t.length)return!1;let s=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:lt.announce.of(s),userEvent:"input.replace.all"}),!0});function BP(n){return n.state.facet(ip).createPanel(n)}function r2(n,e){var t,s,r,a,i;let o=n.selection.main,l=o.empty||o.to>o.from+100?"":n.sliceDoc(o.from,o.to);if(e&&!l)return e;let c=n.facet(ip);return new DP({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(s=e==null?void 0:e.caseSensitive)!==null&&s!==void 0?s:c.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:c.literal,regexp:(a=e==null?void 0:e.regexp)!==null&&a!==void 0?a:c.regexp,wholeWord:(i=e==null?void 0:e.wholeWord)!==null&&i!==void 0?i:c.wholeWord})}function I8(n){let e=aP(n,BP);return e&&e.dom.querySelector("[main-field]")}function L8(n){let e=I8(n);e&&e==n.root.activeElement&&e.select()}const Q8=n=>{let e=n.state.field(Jc,!1);if(e&&e.panel){let t=I8(n);if(t&&t!=n.root.activeElement){let s=r2(n.state,e.query.spec);s.valid&&n.dispatch({effects:mu.of(s)}),t.focus(),t.select()}}else n.dispatch({effects:[TP.of(!0),e?mu.of(r2(n.state,e.query.spec)):rn.appendConfig.of(Zoe)]});return!0},j8=n=>{let e=n.state.field(Jc,!1);if(!e||!e.panel)return!1;let t=aP(n,BP);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:TP.of(!1)}),!0};class joe{constructor(e){this.view=e;let t=this.query=e.state.field(Jc).query.spec;this.commit=this.commit.bind(this),this.searchField=bs("input",{value:t.search,placeholder:gi(e,"Find"),"aria-label":gi(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=bs("input",{value:t.replace,placeholder:gi(e,"Replace"),"aria-label":gi(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=bs("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=bs("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=bs("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function s(r,a,i){return bs("button",{class:"cm-button",name:r,onclick:a,type:"button"},i)}this.dom=bs("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,s("next",()=>p5(e),[gi(e,"next")]),s("prev",()=>m5(e),[gi(e,"previous")]),s("select",()=>_8(e),[gi(e,"all")]),bs("label",null,[this.caseField,gi(e,"match case")]),bs("label",null,[this.reField,gi(e,"regexp")]),bs("label",null,[this.wordField,gi(e,"by word")]),...e.state.readOnly?[]:[bs("br"),this.replaceField,s("replace",()=>f5(e),[gi(e,"replace")]),s("replaceAll",()=>R8(e),[gi(e,"replace all")])],bs("button",{name:"close",onclick:()=>j8(e),"aria-label":gi(e,"close"),type:"button"},["×"])])}commit(){let e=new DP({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:mu.of(e)}))}keydown(e){Lu(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?m5:p5)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),f5(this.view))}update(e){for(let t of e.transactions)for(let s of t.effects)s.is(mu)&&!s.value.eq(this.query)&&this.setQuery(s.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(ip).top}}function gi(n,e){return n.state.phrase(e)}const jg=30,Vg=/[\s\.,:;?!]/;function FP(n,{from:e,to:t}){let s=n.state.doc.lineAt(e),r=n.state.doc.lineAt(t).to,a=Math.max(s.from,e-jg),i=Math.min(r,t+jg),o=n.state.sliceDoc(a,i);if(a!=s.from){for(let l=0;l<jg;l++)if(!Vg.test(o[l+1])&&Vg.test(o[l])){o=o.slice(l);break}}if(i!=r){for(let l=o.length-1;l>o.length-jg;l--)if(!Vg.test(o[l-1])&&Vg.test(o[l])){o=o.slice(0,l);break}}return lt.announce.of(`${n.state.phrase("current match")}. ${o} ${n.state.phrase("on line")} ${s.number}.`)}const Voe=lt.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Zoe=[Jc,Fi.low(Loe),Voe];var zoe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qoe(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var HO={},$u={},$p={},g5;function V8(){if(g5)return $p;g5=1,$p.__esModule=!0,$p.getBestVoicing=void 0;function n(e){var t=e.chord,s=e.range,r=e.finder,a=e.picker,i=e.lastVoicing,o=r(t,s);return o.length?a(o,i):[]}return $p.getBestVoicing=n,$p}var Np={};const Z8=qoe(kee);var _p={},b5;function z8(){if(b5)return _p;b5=1,_p.__esModule=!0,_p.tokenizeChord=void 0;function n(e){var t=(e||"").match(/^([A-G][b#]*)([^\/]*)[\/]?([A-G][b#]*)?$/);return t?t.slice(1):[]}return _p.tokenizeChord=n,_p}var y5;function Uoe(){if(y5)return Np;y5=1,Np.__esModule=!0,Np.voicingsInRange=void 0;var n=Z8,e=q8(),t=z8();function s(r,a,i){a===void 0&&(a=e.lefthand),i===void 0&&(i=["D3","A4"]);var o=(0,t.tokenizeChord)(r),l=o[0],c=o[1];if(!a[c])return[];var u=a[c].map(function(d){return d.split(" ")}),h=n.Range.chromatic(i);return u.reduce(function(d,m){var y=m.map(function(F){return n.Interval.substract(F,m[0])}),O=n.Note.transpose(l,m[0]),S=h.filter(function(F){return n.Note.chroma(F)===n.Note.chroma(O)}).filter(function(F){return n.Note.midi(n.Note.transpose(F,y[y.length-1]))<=n.Note.midi(i[1])}).map(function(F){return n.Note.enharmonic(F,O)}),A=S.map(function(F){return y.map(function(j){return n.Note.transpose(F,j)})});return d.concat(A)},[])}return Np.voicingsInRange=s,Np}var v5;function q8(){return v5||(v5=1,(function(n){var e=$u&&$u.__assign||function(){return e=Object.assign||function(o){for(var l,c=1,u=arguments.length;c<u;c++){l=arguments[c];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(o[h]=l[h])}return o},e.apply(this,arguments)},t=$u&&$u.__rest||function(o,l){var c={};for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&l.indexOf(u)<0&&(c[u]=o[u]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,u=Object.getOwnPropertySymbols(o);h<u.length;h++)l.indexOf(u[h])<0&&Object.prototype.propertyIsEnumerable.call(o,u[h])&&(c[u[h]]=o[u[h]]);return c};n.__esModule=!0,n.dictionaryVoicing=n.dictionaryVoicingFinder=n.triads=n.guidetones=n.lefthand=void 0;var s=V8(),r=Uoe();n.lefthand={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},n.guidetones={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},n.triads={M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]};var a=function(o){return function(l,c){return(0,r.voicingsInRange)(l,o,c)}};n.dictionaryVoicingFinder=a;var i=function(o){var l=o.dictionary,c=o.range,u=t(o,["dictionary","range"]);return(0,s.getBestVoicing)(e(e({},u),{range:c,finder:(0,n.dictionaryVoicingFinder)(l)}))};n.dictionaryVoicing=i})($u)),$u}var Rp={},O5;function Woe(){if(O5)return Rp;O5=1,Rp.__esModule=!0,Rp.minTopNoteDiff=void 0;var n=Z8;function e(t,s){if(!s)return t[0];var r=function(a){return Math.abs(n.Note.midi(s[s.length-1])-n.Note.midi(a[a.length-1]))};return t.reduce(function(a,i){return r(i)<r(a)?i:a},t[0])}return Rp.minTopNoteDiff=e,Rp}var w5;function Goe(){return w5||(w5=1,(function(n){n.__esModule=!0;var e=q8(),t=Woe(),s=V8(),r=z8();n.default={tokenizeChord:r.tokenizeChord,getBestVoicing:s.getBestVoicing,dictionaryVoicing:e.dictionaryVoicing,dictionaryVoicingFinder:e.dictionaryVoicingFinder,lefthand:e.lefthand,guidetones:e.guidetones,triads:e.triads,minTopNoteDiff:t.minTopNoteDiff}})(HO)),HO}var x5=Goe();const Xoe=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Hoe=["c","db","d","eb","e","f","gb","g","ab","a","bb","b"],Yoe=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Koe={b:-1,"#":1},Joe=n=>{const[e,...t]=n.split("");return Hoe.indexOf(e.toLowerCase())+t.reduce((s,r)=>s+Koe[r],0)};function ele(n){const e=(n||"").match(/^([A-G][b#]*)([^/]*)[/]?([A-G][b#]*)?$/);return e?e.slice(1):[]}const a2=n=>n%12,U8=n=>{let e=Number(n);return isNaN(e)?au.semitones(n):e},i2=(n,e)=>{if(typeof n=="number")return n;if(typeof n=="string")return Ab(n,e)},tle=(n,e=!1)=>{const t=Math.floor(n/12)-1;return(e?Yoe:Xoe)[n%12]+t};function nle(n,e,t=1){n=n.map(r=>typeof r=="string"?Ab(r):r);const s=Math.floor(e/n.length)*t*12;return e=dh(e,n.length),n[e]+s}function W8(n,e,t){let s=0,r=1/0;return e.forEach((a,i)=>{const o=Math.abs(a-n);(!t&&o<r||t&&o<=r)&&(s=i,r=o)}),s}let YO={};function sle(n,e,t,s){const[r,a]=_o.tokenize(e),i=i2(r),o=a2(i);if(!YO[a]){const{intervals:h}=_o.get(`C ${a}`);YO[a]=h.map(U8)}const l=YO[a];if(!l)return null;let c=i;if(t){t=i2(t,3);const h=a2(t),d=dh(h-o,12),m=W8(d,l,s);n=n+m,c=t-d}const u=Math.floor(n/l.length)*12;return n=dh(n,l.length),l[n]+c+u}let k5={below:n=>n.slice(-1)[0],duck:n=>n.slice(-1)[0],above:n=>n[0],root:n=>n[0]};function rle({chord:n,dictionary:e,offset:t=0,n:s,mode:r="below",anchor:a="c5",octaves:i=1}){const[o,l]=ele(n),c=Joe(o);a=i2((a==null?void 0:a.note)||a,4);const u=a2(a),h=e[l].map(L=>(typeof L=="string"?L.split(" "):L).map(U8));let d,m,y=h.map((L,I)=>{const q=k5[r](L),ce=dh(u-q-c,12);return(d===void 0||ce<d)&&(d=ce,m=I),ce});r==="root"&&(m=0);const O=Math.ceil(t/h.length)*12,S=dh(m+t,h.length),A=h[S],F=k5[r](A),j=a-y[S]+O,N=A.map(L=>j-F+L);let $=N.map(L=>tle(L));return r==="duck"&&($=$.filter((L,I)=>N[I]!==a)),s!==void 0?[nle($,s,i)]:$}const ale=n=>(n<=0?-1:1)+n*7+"P";function $P(n){n=n.replaceAll(":"," ");const e=_o.get(n),{tonic:t,empty:s}=e;if(s&&pC(n)||s&&!t)throw new Error(`Scale name ${n} is incomplete. Make sure to use ":" instead of spaces, example: .scale("C:major")`);if(s)throw new Error(`Invalid scale name "${n}"`);return e}function ile(n,e){n=Math.ceil(n);let{intervals:t,tonic:s}=$P(e);s=s||"C";const{pc:r,oct:a=3}=oa.get(s),i=Math.floor(n/t.length),o=dh(n,t.length),l=au.add(t[o],ale(i));return oa.transpose(r+a,l)}function S5(n,e,t){let{notes:s}=$P(n);if(s=s.map(h=>oa.get(h).pc),e=Number(e),isNaN(e))throw new Error(`scale offset "${e}" not a number`);const{pc:r,oct:a=3}=oa.get(t),i=s.indexOf(r);if(i===-1)throw new Error(`note "${t}" is not in scale "${n}"`);let o=i,l=a,c=r;const u=Math.sign(e);for(;Math.abs(o-i)<Math.abs(e);){o+=u;const h=dh(o,s.length);u<0&&c[0]==="C"&&(l+=u),c=s[h],u>0&&c[0]==="C"&&(l+=u)}return c+l}const{transpose:ole,trans:lle}=Hd(["transpose","trans"],function(n,e){return e.withHap(t=>{const s=t.value.note??t.value;if(typeof s=="number"){let i;typeof n=="number"?i=n:typeof n=="string"&&(i=au.semitones(n)||0);const o=s+i;return typeof t.value=="object"?t.withValue(()=>({...t.value,note:o})):t.withValue(()=>o)}if(typeof s!="string"||!pC(s))return mC(`[tonal] transpose: not a note "${s}"`,"warning"),t;const r=isNaN(Number(n))?String(n):au.fromSemitones(n),a=oa.transpose(s,r);return typeof t.value=="object"?t.withValue(()=>({...t.value,note:a})):t.withValue(()=>a)})}),{scaleTranspose:cle,scaleTrans:ule,strans:hle}=Hd(["scaleTranspose","scaleTrans","strans"],function(n,e){return e.withHap(t=>{if(!t.context.scale)throw new Error("can only use scaleTranspose after .scale");if(typeof t.value=="object")return t.withValue(()=>({...t.value,note:S5(t.context.scale,Number(n),t.value.note)}));if(typeof t.value!="string")throw new Error("can only use scaleTranspose with notes");return t.withValue(()=>S5(t.context.scale,Number(n),t.value))})});function dle(n){let e=Number(n),t=0;if(isNaN(e)){n=String(n);const s=/^(-?\d+)([#bsf]*)$/.exec(n);if(!s)throw new Error(`invalid scale step "${n}", expected number or integer with optional # b suffixes`);e=Number(s[1]);const r=s[2]||"";t=HG(r)}return[e,t]}let KO={};function ple(n,e,t=!0){let s=typeof e=="string"?Ab(e):e;if(KO[n]===void 0){const{intervals:h,tonic:d}=$P(n),{pc:m}=oa.get(d),y=h.concat("8P").map(S=>oa.transpose(m+"0",S)),O=y.map(Ab);KO[n]=[O,y]}const[r,a]=KO[n],i=r[0],o=Math.floor((s-i)/12),l=r.map(h=>h+12*o),c=W8(s,l,t),u=a[c];return oa.transpose(u,au.fromSemitones(12*o))}const mle=Hd("scale",function(n,e){return Array.isArray(n)&&(n=n.flat().join(" ")),e.withHaps(t=>(t=t.map(s=>{let r=s.value;const a=typeof r=="object";r=a?r:{n:r};const{note:i,n:o,value:l,...c}=r,u=i??o??l;if(u===void 0)return mC(`[tonal] Invalid value format for 'scale'. Value must contain n, note, or value but received keys [${Object.keys(r).join(", ")}]`,"error"),s;let h;if(pC(u))h=ple(n,u),s.value={...c,note:h};else try{const[d,m]=dle(u);c.anchor?h=sle(d,n,c.anchor):h=ile(d,n),m!=0&&(h=oa.transpose(h,au.fromSemitones(m)))}catch(d){GG(d,"tonal");return}return s.value=a?{...c,note:h}:h,s.setContext({...s.context,scale:n})}),XG(t)))},!0,!0),Ku={2:["1P 5P 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P"],5:["1P 5P 8P 12P","5P 8P 12P 15P"],6:["1P 5P 6M 8P 10M","1P 5P 8P 10M 13M","3M 5P 8P 10M 13M","5P 8P 10M 12P 13M"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M"],9:["1P 5P 7m 9M 10M","1P 7m 9M 10M 12P","3M 7m 8P 9M 12P","7m 9M 10M 14m 15P","3M 7m 8P 12P 16M","7m 10M 12P 15P 16M"],11:["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],13:["1P 6M 7m 9M 10M","1P 7m 9M 10M 13M","3M 7m 8P 9M 13M","7m 8P 9M 10M 13M","7m 9M 10M 13M 15P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 8P 9M 13M","5P 8P 9M 10M 13M"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 12P 17M"],"+":["1P 3M 6m 8P 10M","1P 6m 8P 10M 13m","3M 6m 8P 10M 13m","3M 8P 10M 13m 15P","6m 8P 10M 13m 15P","6m 10M 13m 15P 17M"],o:["1P 5d 8P 10m 12d","3m 8P 10m 12d 15P","5d 8P 10m 12d 15P"],h:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P","1P 4P 5P 8P 11P","5P 8P 11P 12P","5P 8P 11P 12P 15P"],"^":["1P 5P 8P 10M","1P 5P 8P 10M 12P","3M 5P 8P 10M 12P","3M 8P 10M 12P 15P","5P 8P 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 5P 8P 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 5P 7M 10M 12P","1P 10M 12P 14M","3M 8P 10M 12P 14M","5P 8P 10M 12P 14M","5P 8P 10M 14M 17M"],"-7":["1P 3m 5P 7m 10m","1P 5P 7m 10m 12P","3m 7m 8P 10m 12P","3m 7m 8P 10m 14m","5P 7m 8P 10m 14m","7m 10m 12P 14m 15P","5P 8P 10m 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 5P 7m 8P 11P","5P 8P 11P 12P 14m","7m 8P 11P 12P 14m","7m 11P 12P 14m 18P"],h7:["3m 5d 7m 8P 10m","1P 5d 7m 10m 12d","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 5P 7M 9M 10M","1P 7M 9M 10M 12P","3M 7M 8P 9M 12P","3M 7M 8P 12P 16M","5P 8P 10M 14M 16M","7M 8P 10M 12P 16M"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 8P 13M 16M","7M 8P 10M 13M 16M"],"^7#11":["1P 5P 7M 10M 12d","3M 7M 8P 10M 12d","1P 7M 10M 12d 14M","3M 7M 8P 12d 14M","5P 8P 10M 12d 14M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 8P 9M 12d","3M 8P 9M 12d 14M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 8P 10M 13m","6m 7M 8P 10M 13m"],"-6":["1P 3m 5P 6M 8P","1P 5P 6M 8P 10m","3m 5P 6M 8P 10m","1P 5P 8P 10m 13M","3m 5P 8P 10m 13M","5P 8P 10m 12P 13M","5P 8P 10m 13M 15P"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 10m","1P 5P 7M 10m 12P","3m 7M 8P 10m 12P","5P 7M 8P 10m 14M","5P 8P 10m 14M 17m"],"-^9":["1P 3m 5P 7M 9M","1P 7M 9M 10m 12P","3m 7M 8P 9M 12P","5P 8P 9M 10m 14M"],"-9":["1P 3m 5P 7m 9M","3m 5P 7m 8P 9M","3m 7m 8P 9M 12P","5P 8P 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 12P 15P 16M"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["1P 3m 7m 9M 11P","3m 7m 8P 9M 11P","1P 4P 7m 10m 12P","5P 8P 11P 14m","3m 7m 9M 11P 15P","5P 8P 11P 14m 16M","7m 10m 12P 15P 18P"],"-7b5":["3m 5d 7m 8P 10m","1P 7m 10m 12d","1P 5d 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 7m 8P 10m 14m","5d 8P 10m 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["1P 7m 9M 10m 12d","3m 7m 8P 9M 12d","5d 8P 9M 10m 14m","7m 10m 12d 15P 16M"],"-b6":["1P 5P 6m 8P 10m","1P 5P 8P 10m 13m","3m 5P 8P 10m 13m","5P 8P 10m 13m","5P 8P 10m 13m 15P"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 10m 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 8P 10m 14m","7m 10m 10M 14m 15P"],"7#11":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7b5":["1P 3M 7m 10M 12d","3M 7m 8P 10M 12d","7m 10M 12d 14m 15P"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P"],"7#9#5":["1P 3M 7m 10m 13m","3M 7m 10m 13m 15P","7m 10M 13m 15P 17m"],"7#9b5":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7#9#11":["1P 3M 7m 10m 12d","3M 7m 10m 12d 15P","7m 10M 12d 15P 17m"],"7b9#11":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9b5":["1P 7m 9m 10M 12d","3M 7m 8P 9m 12d","7m 8P 10M 12d 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 8P 9m 10m","7m 8P 10M 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 8P 9m 13m","7m 9m 10M 13m 15P"],"7alt":["3M 7m 8P 9m 12d","1P 7m 10m 10M 13m","3M 7m 8P 10m 13m","3M 7m 9m 12d 15P","3M 7m 10m 13m 15P","7m 10M 12d 15P 17m","7m 10M 13m 15P 17m"],"13#11":["1P 6M 7m 10M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["1P 3M 6M 7m 9m","1P 6M 7m 9m 10M","3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["1P 3M 6M 7m 10m","3M 7m 8P 10m 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 5P 7m 9M 11P","5P 7m 8P 9M 11P","7m 8P 9M 11P 12P","7m 8P 11P 12P 16M"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","5P 7m 9M 11P 13M","7m 9M 11P 13M 15P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},lh={2:["1P 5P 6M 8P 9M","1P 5P 8P 9M 12P","5P 8P 9M 12P 13M","5P 8P 9M 12P 15P"],5:["1P 5P 8P 12P","1P 5P 8P 9M 12P","5P 8P 12P 15P","5P 8P 12P 15P 16M"],6:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],7:["1P 5P 7m 8P 10M","1P 7m 8P 10M 12P","3M 7m 8P 10M 12P","3M 7m 8P 10M 14m","3M 7m 10M 12P 15P","7m 10M 12P 14m 15P","7m 10M 12P 15P 17M","7m 10M 14m 17M 19P"],9:["1P 6M 7m 9M 10M","3M 7m 9M 10M 12P","1P 7m 9M 10M 13M","3M 7m 9M 10M 13M","3M 7m 9M 12P 15P","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],11:["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],13:["3M 7m 9M 10M 13M","3M 7m 9M 13M 15P","3M 7m 10M 13M 16M","7m 10M 12P 13M 16M","7m 10M 13M 16M 17M","7m 10M 13M 16M 19P"],69:["1P 5P 6M 9M 10M","1P 5P 9M 10M 13M","3M 5P 9M 10M 13M","5P 8P 9M 10M 13M","3M 6M 9M 12P 15P"],add9:["1P 5P 8P 9M 10M","1P 5P 9M 10M 12P","3M 8P 9M 10M 12P","3M 8P 9M 12P 15P","5P 8P 9M 10M 15P","5P 8P 9M 12P 17M"],"+":["1P 6m 8P 9M 10M","1P 6m 8P 10M 13m","3M 8P 9M 10M 13m","3M 8P 10M 13m 15P","6m 10M 13m 15P 16M","6m 10M 13m 15P 17M"],o:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],h:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],sus:["1P 4P 5P 8P 9M","1P 4P 5P 8P 11P","1P 5P 8P 9M 11P","5P 8P 9M 11P 12P","5P 8P 11P 12P 13M","5P 8P 11P 13M 15P"],"^":["1P 3M 5P 6M 9M","1P 5P 8P 10M 12P","3M 5P 9M 10M 12P","1P 5P 8P 10M 13M","3M 8P 10M 13M 15P","5P 9M 10M 12P 15P"],"-":["1P 3m 5P 8P 10m","1P 3m 5P 9M 11P","3m 5P 8P 9M 11P","5P 8P 9M 10m 11P","1P 5P 9M 10m 12P","3m 5P 8P 10m 12P","5P 8P 10m 12P 15P"],"^7":["1P 6M 7M 9M 10M","3M 7M 9M 10M 12P","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"-7":["1P 3m 5P 7m 9M","1P 3m 5P 7m 10m","1P 5P 7m 10m 11P","3m 7m 8P 10m 11P","1P 5P 7m 10m 12P","3m 7m 9M 10m 12P","3m 7m 8P 10m 14m","5P 7m 9M 10m 14m","7m 10m 11P 14m 15P","7m 10m 12P 15P 16M","5P 8P 11P 14m 17m","7m 10m 12P 15P 17m"],"7sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],h7:["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],o7:["1P 6M 8P 10m 12d","1P 6M 10m 12d 13M","3m 8P 10m 12d 13M","3m 8P 12d 13M 15P","5d 10m 12d 13M 15P","5d 10m 13M 15P 17m","6M 12d 13M 15P 17m","6M 12d 15P 17m 19d"],"^9":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^13":["1P 6M 7M 9M 10M","1P 7M 9M 10M 13M","3M 7M 9M 12P 13M","3M 7M 9M 10M 13M","3M 7M 8P 9M 13M","3M 7M 9M 13M 14M","3M 7M 10M 13M 16M","7M 10M 13M 14M 16M","7M 10M 13M 16M 17M","7M 10M 13M 16M 19P"],"^7#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 10M 12d 14M","7M 10M 12d 13M 14M","7M 10M 12d 13M 16M","7M 10M 12d 14M 17M"],"^9#11":["1P 3M 5d 7M 9M","1P 7M 9M 10M 12d","3M 7M 9M 10M 12d","3M 7M 9M 12d 13M","3M 7M 9M 12d 14M","7M 10M 12d 14M 16M","7M 10M 12d 13M 16M"],"^7#5":["1P 6m 7M 10M 13m","3M 7M 9M 10M 13m","3M 7M 10M 13m 14M","7M 10M 13m 14M 16M","7M 10M 13m 14M 17M"],"-6":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","1P 5P 6M 10m 11P","3m 5P 6M 8P 11P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 10m 11P 13M","5P 8P 10m 13M 16M"],"-69":["1P 3m 5P 6M 9M","3m 5P 6M 8P 9M","3m 6M 9M 10m 12P","1P 5P 9M 10m 13M","3m 5P 8P 9M 13M","5P 8P 9M 10m 13M","5P 8P 10m 13M 16M"],"-^7":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-^9":["1P 3m 5P 7M 9M","1P 5P 7M 10m 11P","3m 7M 9M 10m 11P","3m 7M 9M 10m 12P","3m 7M 9M 12P 14M","7M 10m 11P 12P 14M","7M 10m 12P 14M 16M"],"-9":["1P 3m 5P 7m 9M","1P 3m 7m 9M 11P","3m 7m 9M 10m 11P","3m 7m 9M 10m 12P","3m 7m 9M 10m 14m","3m 7m 9M 12P 15P","7m 10m 11P 14m 16M","7m 10m 12P 16M 18P"],"-add9":["1P 2M 3m 5P 8P","1P 3m 5P 9M","3m 5P 8P 9M 12P","5P 8P 9M 10m 12P"],"-11":["3m 5P 7m 9M 11P","7m 9M 10m 11P","1P 4P 7m 10m 12P","3m 7m 9M 11P 12P","7m 9M 10m 11P 12P","3m 7m 9M 11P 14m","4P 10m 12P 14m","5P 8P 11P 14m","5P 8P 11P 14m 16M","7m 10m 12P 16M 18P","7m 10m 11P 16M 21m"],"-7b5":["1P 5d 7m 10m 11P","3m 5d 7m 8P 11P","5d 7m 8P 10m 11P","1P 7m 10m 12d","3m 7m 8P 10m 12d","3m 7m 8P 12d 14m","5d 8P 10m 11P 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 15P","5d 8P 10m 14m 17m"],h9:["3m 5d 7m 9M 11P","1P 7m 9M 10m 12d","3m 7m 9M 12d 14m","5d 8P 9M 10m 14m","7m 10m 11P 12d 14m","7m 10m 12d 14m 16M"],"-b6":["1P 3m 5P 6m 8P","3m 5P 8P 11P 13m","5P 8P 10m 11P 13m"],"-#5":["1P 6m 8P 10m 13m","3m 6m 8P 11P 13m","6m 8P 10m 13m 15P"],"7b9":["1P 3M 7m 9m 10M","3M 7m 8P 9m 10M","3M 7m 8P 9m 14m","7m 9m 10M 14m 15P"],"7#9":["1P 3M 7m 10m","3M 7m 10m 10M 12P","3M 7m 10m 12P 14m","7m 10M 12P 14m 17m"],"7#11":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7b5":["1P 3M 7m 9M 12d","3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"7#5":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"9#11":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9b5":["1P 7m 9M 10M 12d","3M 7m 8P 9M 12d","7m 10M 12d 15P 16M"],"9#5":["1P 7m 9M 10M 13m","3M 7m 9M 10M 13m","3M 7m 9M 13m 14m","7m 10M 13m 14m 16M","7m 10M 13m 16M 17M"],"7b13":["1P 3M 7m 10M 13m","3M 7m 8P 10M 13m","3M 7m 8P 13m 14m","7m 10M 13m 14m 15P","7m 10M 13m 14m 17M"],"7#9#5":["3M 7m 10m 10M 13m","3M 7m 10m 13m 14m","7m 10M 13m 14m 17m"],"7#9b5":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7#9#11":["3M 7m 10m 10M 12d","3M 7m 10m 12d 14m","7m 10M 12d 14m 17m"],"7b9#11":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9b5":["3M 7m 9m 10M 12d","3M 7m 9m 12d 14m","7m 8P 10M 12d 16m","7m 10M 12d 14m 16m"],"7b9#5":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7b9#9":["1P 3M 7m 9m 10m","3M 7m 10m 13m 16m","7m 10M 13m 16m 17m"],"7b9b13":["1P 7m 9m 10M 13m","3M 7m 9m 10M 13m","3M 7m 10M 13m 16m","7m 10M 13m 14m 16m","7m 10M 13m 16m 17M"],"7alt":["3M 7m 8P 10m 13m","3M 7m 9m 12d 13m","3M 7m 9m 10m 13m","3M 7m 10m 13m 14m","3M 7m 9m 12d 14m","3M 7m 10m 13m 15P","3M 7m 10m 13m 16m","7m 10M 12d 14m 16m","7m 10M 12d 13m 16m","7m 10M 13m 15P 17m","7m 10M 13m 16m 17m","7m 10M 13m 16m 19d"],"13#11":["3M 7m 9M 12d 13M","7m 10M 12d 13M 16M"],"13b9":["3M 7m 9m 10M 13M","3M 7m 10M 13M 16m","7m 10M 13M 16m 17M"],"13#9":["3M 7m 10m 10M 13M","7m 10M 13M 14m 17m"],"7b9sus":["1P 5P 7m 9m 11P","5P 7m 8P 9m 11P","7m 8P 11P 14m 16m"],"7susadd3":["1P 4P 5P 7m 10M","5P 8P 10M 11P 14m","7m 11P 12P 15P 17M"],"9sus":["1P 4P 6M 7m 9M","1P 5P 7m 9M 11P","4P 6M 7m 9M 11P","5P 8P 9M 11P 14m","7m 9M 11P 13M 15P","7m 11P 12P 14m 18P"],"13sus":["1P 4P 6M 7m 9M","1P 7m 9M 11P 13M","4P 7m 9M 11P 13M","7m 9M 11P 13M 15P","7m 11P 13M 14m 16M","7m 11P 13M 16M 18P"],"7b13sus":["1P 5P 7m 11P 13m","5P 7m 8P 11P 13m","7m 11P 13m 14m 15P"]},{dictionaryVoicing:fle,minTopNoteDiff:gle}=x5.default||x5,ble={m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},yle={m7:["3m 7m","7m 10m"],m9:["3m 7m","7m 10m"],7:["3M 7m","7m 10M"],"^7":["3M 7M","7M 10M"],"^9":["3M 7M","7M 10M"],69:["3M 6M"],6:["3M 6M","6M 10M"],m7b5:["3m 7m","7m 10m"],"7b9":["3M 7m","7m 10M"],"7b13":["3M 7m","7m 10M"],o7:["3m 6M","6M 10m"],"7#11":["3M 7m","7m 10M"],"7#9":["3M 7m","7m 10M"],mM7:["3m 7M","7M 10m"],m6:["3m 6M","6M 10m"]},vle={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"]},Ole={"":["1P 3M 5P","3M 5P 8P","5P 8P 10M"],M:["1P 3M 5P","3M 5P 8P","5P 8P 10M"],m:["1P 3m 5P","3m 5P 8P","5P 8P 10m"],o:["1P 3m 5d","3m 5d 8P","5d 8P 10m"],aug:["1P 3m 5A","3m 5A 8P","5A 8P 10m"],m7:["3m 5P 7m 9M","7m 9M 10m 12P"],7:["3M 6M 7m 9M","7m 9M 10M 13M"],"^7":["3M 5P 7M 9M","7M 9M 10M 12P"],69:["3M 5P 6A 9M"],m7b5:["3m 5d 7m 8P","7m 8P 10m 12d"],"7b9":["3M 6m 7m 9m","7m 9m 10M 13m"],"7b13":["3M 6m 7m 9m","7m 9m 10M 13m"],o7:["1P 3m 5d 6M","5d 6M 8P 10m"],"7#11":["7m 9M 11A 13A"],"7#9":["3M 7m 9A"],mM7:["3m 5P 7M 9M","7M 9M 10m 12P"],m6:["3m 5P 6M 9M","6M 9M 10m 12P"]},op={lefthand:{dictionary:ble,range:["F3","A4"],mode:"below",anchor:"a4"},triads:{dictionary:vle,mode:"below",anchor:"a4"},guidetones:{dictionary:yle,mode:"above",anchor:"a4"},legacy:{dictionary:Ole,mode:"below",anchor:"a4"}};let G8="ireal";const X8=n=>G8=n,wle=(n,e)=>H8(n,op[n].dictionary,e),H8=(n,e,t=["F3","A4"])=>{Object.assign(op,{[n]:{dictionary:e,range:t}})},NP=(n,e,t={})=>{Object.assign(op,{[n]:{dictionary:e,...t}})},xle=(n,e,t)=>{const{dictionary:s,range:r}=op[e];return fle({chord:n,dictionary:s,range:r,picker:gle,lastVoicing:t})};let sb;const kle=Hd("voicings",function(n,e){return e.fmap(t=>(sb=xle(t,n,sb),km(...sb))).outerJoin()}),Sle=Hd("rootNotes",function(n,e){return e.fmap(t=>{const s=(t.chord||t).match(/^([a-gA-G][b#]?).*$/)[1]+n;return t.chord?{note:s}:s})}),Cle=Hd("voicing",function(n){return n.fmap(e=>{e=typeof e=="string"?{chord:e}:e;let{dictionary:t=G8,chord:s,anchor:r,offset:a,mode:i,n:o,octaves:l,...c}=e;t=typeof t=="string"?op[t]:{dictionary:t,mode:"below",anchor:"c5"};try{let u=rle({...t,chord:s,anchor:r,offset:a,mode:i,n:o,octaves:l});return km(...u).note().set(c)}catch{return mC(`[voicing]: unknown chord "${s}"`),Xx}}).outerJoin()});function Bm(n,e,t){t=Array.isArray(t)?t:[t],t.forEach(s=>{s[e]=s[n]})}Bm("^","",[Ku,lh]);Object.keys(Ku).forEach(n=>{if(n.includes("-")){let e=n.replace("-","m");Bm(n,e,[lh,Ku])}if(n.includes("^")){let e=n.replace("^","M");Bm(n,e,[lh,Ku])}if(n.includes("+")){let e=n.replace("+","aug");Bm(n,e,[lh,Ku])}});NP("ireal",Ku);NP("ireal-ext",lh);function Ple(){sb=void 0,X8("ireal")}const Ale="@strudel/tonal",Ele=Object.freeze(Object.defineProperty({__proto__:null,addVoicings:H8,complex:lh,packageName:Ale,registerVoicings:NP,resetVoicings:Ple,rootNotes:Sle,scale:mle,scaleTrans:ule,scaleTranspose:cle,setDefaultVoicings:X8,setVoicingRange:wle,simple:Ku,strans:hle,trans:lle,transpose:ole,voicing:Cle,voicingAlias:Bm,voicingRegistry:op,voicings:kle},Symbol.toStringTag,{value:"Module"}));let o2=FF||(function(){let n={cursorBlinkRate:1200};return function(){return n}})(),Mle=class{constructor(e,t,s,r,a,i,o,l,c,u){this.left=e,this.top=t,this.height=s,this.fontFamily=r,this.fontSize=a,this.fontWeight=i,this.color=o,this.className=l,this.letter=c,this.partial=u}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.height=this.height+"px",e.style.lineHeight=this.height+"px",e.style.fontFamily=this.fontFamily,e.style.fontSize=this.fontSize,e.style.fontWeight=this.fontWeight,e.style.color=this.partial?"transparent":this.color,e.className=this.className,e.textContent=this.letter}eq(e){return this.left==e.left&&this.top==e.top&&this.height==e.height&&this.fontFamily==e.fontFamily&&this.fontSize==e.fontSize&&this.fontWeight==e.fontWeight&&this.color==e.color&&this.className==e.className&&this.letter==e.letter}},Dle=class{constructor(e,t){this.view=e,this.rangePieces=[],this.cursors=[],this.em=t,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let t=o2(this.view.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=t+"ms"}update(e){(e.selectionSet||e.geometryChanged||e.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),Tle(e)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:e}=this.view,t=[];for(let s of e.selection.ranges){let r=s==e.selection.main,a=Nle(this.em,this.view,s,r);a&&t.push(a)}return{cursors:t}}drawSel({cursors:e}){if(e.length!=this.cursors.length||e.some((t,s)=>!t.eq(this.cursors[s]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const s of e)this.cursorLayer.appendChild(s.draw())}else e.forEach((s,r)=>s.adjust(t[r]));this.cursors=e}}destroy(){this.cursorLayer.remove()}};function Tle(n){return o2(n.startState)!=o2(n.state)}const Ble={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}},Fle=Fi.highest(lt.theme(Ble));function $le(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==fs.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function Nle(n,e,t,s){var r,a;let i=t.head,o=1;(n.$data.count||n.$data.keyChain)&&(o=.5);{let c=i<e.state.doc.length&&e.state.sliceDoc(i,i+1);c&&/[\uDC00-\uDFFF]/.test(c)&&i>1&&(i--,c=e.state.sliceDoc(i,i+1));let u=e.coordsAtPos(i,1);if(!u)return null;let h=$le(e),d=e.domAtPos(i),m=d?d.node:e.contentDOM;for(;d&&d.node instanceof HTMLElement;)m=d.node,d={node:d.node.childNodes[d.offset],offset:0};if(!(m instanceof HTMLElement)){if(!m.parentNode)return null;m=m.parentNode}let y=getComputedStyle(m),O=u.left,S=(a=(r=e).coordsForChar)===null||a===void 0?void 0:a.call(r,i);if(S&&(O=S.left),!c||c==`
`||c=="\r")c=" ";else if(c=="	"){c=" ";var l=e.coordsAtPos(i+1,-1);l&&(O=l.left-(l.left-u.left)/parseInt(y.tabSize))}else/[\uD800-\uDBFF]/.test(c)&&i<e.state.doc.length-1&&(c+=e.state.sliceDoc(i+1,i+2));let A=u.bottom-u.top;return new Mle(O-h.left,u.top-h.top+A*(1-o),A*o,y.fontFamily,y.fontSize,y.fontWeight,y.color,s?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",c,o!=1)}}const _le=lt.theme({".cm-emacsMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"5px 10px",backgroundColor:"#fffa8f",fontFamily:"monospace"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"#fffa8f"}}),Rle=Ns.fromClass(class{constructor(n){this.status="",this.view=n,this.em=new Ju(n),this.blockCursor=new Dle(n,this.em),this.view.scrollDOM.classList.add("cm-emacsMode")}update(n){n.docChanged&&(this.em.$emacsMark=null,this.em.updateMarksOnChange(n.changes)),this.blockCursor.update(n)}destroy(){this.view.scrollDOM.classList.remove("cm-emacsMode"),this.blockCursor.destroy()}},{eventHandlers:{keydown:function(n,e){var t=this.em.handleKeyboard(n);return t&&this.blockCursor.scheduleRedraw(),!!t},mousedown:function(){this.em.$emacsMark=null}}}),Ile=rn.define(),Lle=qs.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(Ile)&&(n=t.value);return n},provide:n=>hu.from(n,e=>e?Qle:null)});function Qle(n){let e=document.createElement("div");return e.className="cm-vim-panel",{top:!1,dom:e}}function jle(n={}){return[_le,Rle,Fle,Lle]}var Vle={Return:"Return",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Return",Divide:"/",Slash:"/",Multiply:"*",Subtract:"-",Minus:"-",Equal:"="},Zle={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1};const JO={};class Ju{constructor(e){this.view=e,this.$data={count:0,keyChain:"",lastCommand:""},this.$emacsMarkRing=[],this.$emacsMark=null}static bindKey(e,t){e.split("|").forEach(function(s){let r="",a=s.split(/\s+/);a.forEach(function(i,o){let l=i.split(/-(?=.)/),c=l.pop();l.length&&(r+=l.sort().join("-")+"-"),r+=c,o===a.length-1?JO[r]=t:(JO[r]="null",r+=" ")})})}static getKey(e){var t=e.code,s=e.key;if(Zle[s])return["","",""];t.length>1&&(t[0]=="N"&&(t=t.replace(/^Numpad/,"")),t[0]=="K"&&(t=t.replace(/^Key/,""))),t=Vle[t]||t,t.length==1&&(t=t.toLowerCase());var r="";return e.ctrlKey&&(r+="C-"),e.metaKey&&(r+="CMD-"),e.altKey&&(r+="M-"),e.shiftKey&&(r+="S-"),[t,r,s]}static addCommands(e){Object.keys(e).forEach(function(t){var s=e[t];typeof s=="function"&&(s={exec:s}),Ju.commands[t]=s})}static execCommand(e,t,s,r=1){var a=void 0;if(r<0&&(r=-r),typeof e=="function")for(var i=0;i<r;i++)e(t.view);else if(e!=="null")if(e.exec){r>1&&e.handlesCount&&(s||(s={}),typeof s=="object"&&(s.count=r),r=1);for(var i=0;i<r;i++)a=e.exec(t,s||{})}else throw new Error("missformed command");return a}handleKeyboard(e){var t=Ju.getKey(e),s=this.findCommand(t);if(!(/Up|Down/.test(t==null?void 0:t[0])&&cie(this.view.state))){if(s&&s.command){var r=Ju.execCommand(s.command,this,s.args,s.count);if(r===!1)return}return s}}findCommand([e,t,s]){if(e){var r=this,a=this.$data;if(!t&&e.length==1&&(r.pushEmacsMark(),a.count)){var i=new Array(a.count+1).join(s);return a.count=null,{command:"insertstring",args:i}}if(t=="C-"||a.count){var c=parseInt(e[e.length-1]);if(typeof c=="number"&&!isNaN(c))return a.count=Math.max(a.count||0,0),a.count=10*a.count+c,{command:"null"}}t&&(e=t+e),a.keyChain&&(e=a.keyChain+=" "+e);var o=JO[e];if(a.keyChain=o=="null"?e:"",!!o){if(o==="null")return{command:"null"};if(o==="universalArgument")return a.count=-4,{command:"null"};var l;if(typeof o!="string"&&(l=o.args,o.command&&(o=o.command)),(o==="insertstring"||o===PP||o===OP)&&r.pushEmacsMark(),!(typeof o=="string"&&(o=Ju.commands[o],!o))){!o.readOnly&&!o.keepLastCommand&&(a.lastCommand=null);var c=a.count||1;return a.count&&(a.count=0),{command:o,args:l,count:c}}}}}showCommandLine(e){console.error("TODO")}updateMarksOnChange(e){this.$emacsMark&&(this.$emacsMark=this.updateMark(this.$emacsMark,e)),this.$emacsMarkRing=this.$emacsMarkRing.map(t=>this.updateMark(t,e)).filter(Boolean)}updateMark(e,t){if(e){var s=e.map(function(r){return t.mapPos(r,1,pr.TrackDel)}).filter(r=>r!=null);return s.length==0?null:s}}emacsMark(){return this.$emacsMark}setEmacsMark(e){this.$emacsMark=e}pushEmacsMark(e,t){var s=this.$emacsMark;s&&C5(this.$emacsMarkRing,s),!e||t?this.setEmacsMark(e):C5(this.$emacsMarkRing,e)}popEmacsMark(){var e=this.emacsMark();return e?(this.setEmacsMark(null),e):this.$emacsMarkRing.pop()}getLastEmacsMark(){return this.$emacsMark||this.$emacsMarkRing.slice(-1)[0]}getCopyText(){var e=this.view.state;return e.selection.ranges.map(t=>e.sliceDoc(t.from,t.to)).join(`
`)}clearSelection(){var e=this.view,t=e.state.selection,s=!t.ranges.some(a=>a.from!=a.to);if(s)return!1;var r=t.ranges.map(a=>Le.range(a.head,a.head));return e.dispatch({selection:Le.create(r,t.mainIndex)}),!0}onPaste(e){var t=this.view,s=t.state.selection,r;if(s.ranges.length>1){var a=e.split(`
`);a.length==s.ranges.length&&(r=a)}var i=0,o=t.state.changeByRange(l=>{var c=r?r[i]:e;return i++,{changes:{from:l.from,to:l.to,insert:c},range:Le.cursor(l.from+c.length)}});t.dispatch(o)}selectionToEmacsMark(){var e=this.view.state.selection;return e.ranges.map(t=>t.head)}}Ju.commands={};function C5(n,e){n.length&&n[n.length-1]+""==e+""||n.push(e)}function zle(n){var e=n.Pos;function t(p,f,v){if(f.line===v.line&&f.ch>=v.ch-1){var C=p.getLine(f.line),E=C.charCodeAt(f.ch);55296<=E&&E<=55551&&(v.ch+=1)}return{start:f,end:v}}var s=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"g<Up>",type:"keyToKey",toKeys:"gk"},{keys:"g<Down>",type:"keyToKey",toKeys:"gj"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h"},{keys:"<Del>",type:"keyToKey",toKeys:"x"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"keyToKey",toKeys:"i",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"g$",type:"motion",motion:"moveToEndOfDisplayLine"},{keys:"g^",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"g0",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"gn",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!0}},{keys:"gN",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!1}},{keys:"gq",type:"operator",operator:"hardWrap"},{keys:"gw",type:"operator",operator:"hardWrap",operatorArgs:{keepCursor:!0}},{keys:"g?",type:"operator",operator:"rot13"},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-u>",type:"operatorMotion",operator:"delete",motion:"moveToStartOfLine",context:"insert"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"gi",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"lastEdit"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"gI",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"bol"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"gJ",type:"action",action:"joinLines",actionArgs:{keepSpaces:!0},isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<register>",type:"action",action:"replayMacro"},{keys:"q<register>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0},context:"normal"},{keys:"R",type:"operator",operator:"change",operatorArgs:{linewise:!0,fullLine:!0},context:"visual",exitVisualBlock:!0},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<register>",type:"action",action:"setMark"},{keys:'"<register>',type:"action",action:"setRegister"},{keys:"<C-r><register>",type:"action",action:"insertRegister",context:"insert",isEdit:!0},{keys:"<C-o>",type:"action",action:"oneNormalCommand",context:"insert"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<register>",type:"motion",motion:"textObjectManipulation"},{keys:"i<register>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],r=Object.create(null),a=s.length,i=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"omap",shortName:"om"},{name:"noremap",shortName:"no"},{name:"nnoremap",shortName:"nn"},{name:"vnoremap",shortName:"vn"},{name:"inoremap",shortName:"ino"},{name:"onoremap",shortName:"ono"},{name:"unmap"},{name:"mapclear",shortName:"mapc"},{name:"nmapclear",shortName:"nmapc"},{name:"vmapclear",shortName:"vmapc"},{name:"imapclear",shortName:"imapc"},{name:"omapclear",shortName:"omapc"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"startinsert",shortName:"start"},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"marks",excludeFromCommandHistory:!0},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"vglobal",shortName:"v"},{name:"delete",shortName:"d"},{name:"join",shortName:"j"},{name:"normal",shortName:"norm"},{name:"global",shortName:"g"}],o=un("");function l(p){p.setOption("disableInput",!0),p.setOption("showCursorWhenSelecting",!1),n.signal(p,"vim-mode-change",{mode:"normal"}),p.on("cursorActivity",hn),Se(p),n.on(p.getInputField(),"paste",u(p))}function c(p){p.setOption("disableInput",!1),p.off("cursorActivity",hn),n.off(p.getInputField(),"paste",u(p)),p.state.vim=null,pa&&clearTimeout(pa)}function u(p){var f=p.state.vim;return f.onPasteFn||(f.onPasteFn=function(){f.insertMode||(p.setCursor(It(p.getCursor(),0,1)),_e.enterInsertMode(p,{},f))}),f.onPasteFn}var h=/[\d]/,d=[n.isWordChar,function(p){return p&&!n.isWordChar(p)&&!/\s/.test(p)}],m=[function(p){return/\S/.test(p)}],y=["<",">"],O=["-",'"',".",":","_","/","+"],S=/^\w$/,A=/^[A-Z]$/;try{A=new RegExp("^[\\p{Lu}]$","u")}catch{}function F(p,f){return f>=p.firstLine()&&f<=p.lastLine()}function j(p){return/^[a-z]$/.test(p)}function N(p){return"()[]{}".indexOf(p)!=-1}function $(p){return h.test(p)}function L(p){return A.test(p)}function I(p){return/^\s*$/.test(p)}function q(p){return".?!".indexOf(p)!=-1}function ce(p,f){for(var v=0;v<f.length;v++)if(f[v]==p)return!0;return!1}var ee={};function he(p,f,v,C,E){if(f===void 0&&!E)throw Error("defaultValue is required unless callback is provided");if(v||(v="string"),ee[p]={type:v,defaultValue:f,callback:E},C)for(var D=0;D<C.length;D++)ee[C[D]]=ee[p];f&&H(p,f)}function H(p,f,v,C){var E=ee[p];C=C||{};var D=C.scope;if(!E)return new Error("Unknown option: "+p);if(E.type=="boolean"){if(f&&f!==!0)return new Error("Invalid argument: "+p+"="+f);f!==!1&&(f=!0)}E.callback?(D!=="local"&&E.callback(f,void 0),D!=="global"&&v&&E.callback(f,v)):(D!=="local"&&(E.value=E.type=="boolean"?!!f:f),D!=="global"&&v&&(v.state.vim.options[p]={value:f}))}function me(p,f,v){var C=ee[p];v=v||{};var E=v.scope;if(!C)return new Error("Unknown option: "+p);if(C.callback){let D=f&&C.callback(void 0,f);return E!=="global"&&D!==void 0?D:E!=="local"?C.callback():void 0}else return(E!=="global"&&f&&f.state.vim.options[p]||E!=="local"&&C||{}).value}he("filetype",void 0,"string",["ft"],function(p,f){if(f!==void 0)if(p===void 0){let v=f.getOption("mode");return v=="null"?"":v}else{let v=p==""?"null":p;f.setOption("mode",v)}}),he("textwidth",80,"number",["tw"],function(p,f){if(f!==void 0)if(p===void 0){var v=f.getOption("textwidth");return v}else{var C=Math.round(p);C>1&&f.setOption("textwidth",C)}});var Oe=function(){var p=100,f=-1,v=0,C=0,E=new Array(p);function D(W,G,X){var re=f%p,de=E[re];function pe(Ce){var Be=++f%p,je=E[Be];je&&je.clear(),E[Be]=W.setBookmark(Ce)}if(de){var ye=de.find();ye&&!xn(ye,G)&&pe(G)}else pe(G);pe(X),v=f,C=f-p+1,C<0&&(C=0)}function Q(W,G){f+=G,f>v?f=v:f<C&&(f=C);var X=E[(p+f)%p];if(X&&!X.find()){var re=G>0?1:-1,de,pe=W.getCursor();do if(f+=re,X=E[(p+f)%p],X&&(de=X.find())&&!xn(pe,de))break;while(f<v&&f>C)}return X}function z(W,G){var X=f,re=Q(W,G);return f=X,re&&re.find()}return{cachedCursor:void 0,add:D,find:z,move:Q}},Pe=function(p){return p?{changes:p.changes,expectCursorActivityForChange:p.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};class De{constructor(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=Pe()}exitMacroRecordMode(){var f=ae.macroModeState;f.onRecordingDone&&f.onRecordingDone(),f.onRecordingDone=void 0,f.isRecording=!1}enterMacroRecordMode(f,v){var C=ae.registerController.getRegister(v);if(C){if(C.clear(),this.latestRegister=v,f.openDialog){var E=wr("span",{class:"cm-vim-message"},"recording @"+v);this.onRecordingDone=f.openDialog(E,function(){},{bottom:!0})}this.isRecording=!0}}}function Se(p){return p.state.vim||(p.state.vim={inputState:new Rt,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeReturn:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:void 0,sel:{anchor:new e(0,0),head:new e(0,0)},options:{},expectLiteralNext:!1,status:""}),p.state.vim}var ae;function Ee(){ae={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:Oe(),macroModeState:new De,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new rt({}),searchHistoryController:new Pn,exCommandHistoryController:new Pn};for(var p in ee){var f=ee[p];f.value=f.defaultValue}}class Qe{constructor(f,v){this.keyName=f,this.key=v.key,this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.metaKey=v.metaKey,this.shiftKey=v.shiftKey}}var Ke,ge={enterVimMode:l,leaveVimMode:c,buildKeyMap:function(){},getRegisterController:function(){return ae.registerController},resetVimGlobalState_:Ee,getVimGlobalState_:function(){return ae},maybeInitVimState_:Se,suppressErrorLogging:!1,InsertModeKey:Qe,map:function(p,f,v){Ze.map(p,f,v)},unmap:function(p,f){return Ze.unmap(p,f)},noremap:function(p,f,v){Ze.map(p,f,v,!0)},mapclear:function(p){var f=s.length,v=a,C=s.slice(0,f-v);if(s=s.slice(f-v),p)for(var E=C.length-1;E>=0;E--){var D=C[E];if(p!==D.context)if(D.context)this._mapCommand(D);else{var Q=["normal","insert","visual"];for(var z in Q)if(Q[z]!==p){var W=Object.assign({},D);W.context=Q[z],this._mapCommand(W)}}}},langmap:cn,vimKeyFromEvent:qn,setOption:H,getOption:me,defineOption:he,defineEx:function(p,f,v){if(!f)f=p;else if(p.indexOf(f)!==0)throw new Error('(Vim.defineEx) "'+f+'" is not a prefix of "'+p+'", command not registered');Fe[p]=v,Ze.commandMap_[f]={name:p,shortName:f,type:"api"}},handleKey:function(p,f,v){var C=this.findKey(p,f,v);if(typeof C=="function")return C()},multiSelectHandleKey:T,findKey:function(p,f,v){var C=Se(p),E=p;function D(){var X=ae.macroModeState;if(X.isRecording){if(f=="q")return X.exitMacroRecordMode(),Kt(E),!0;v!="mapping"&&Me(X,f)}}function Q(){if(f=="<Esc>"){if(C.visualMode)Re(E);else if(C.insertMode)Ne(E);else return;return Kt(E),!0}}function z(){if(Q())return!0;C.inputState.keyBuffer.push(f);var X=C.inputState.keyBuffer.join(""),re=f.length==1,de=pt.matchCommand(X,s,C.inputState,"insert"),pe=C.inputState.changeQueue;if(de.type=="none")return Kt(E),!1;if(de.type=="partial"){if(de.expectLiteralNext&&(C.expectLiteralNext=!0),Ke&&window.clearTimeout(Ke),Ke=re&&window.setTimeout(function(){C.insertMode&&C.inputState.keyBuffer.length&&Kt(E)},me("insertModeEscKeysTimeout")),re){var ye=E.listSelections();(!pe||pe.removed.length!=ye.length)&&(pe=C.inputState.changeQueue=new Un),pe.inserted+=f;for(var Ce=0;Ce<ye.length;Ce++){var Be=Gt(ye[Ce].anchor,ye[Ce].head),je=an(ye[Ce].anchor,ye[Ce].head),Ie=E.getRange(Be,E.state.overwrite?It(je,0,1):je);pe.removed[Ce]=(pe.removed[Ce]||"")+Ie}}return!re}else de.type=="full"&&(C.inputState.keyBuffer.length=0);if(C.expectLiteralNext=!1,Ke&&window.clearTimeout(Ke),de.command&&pe){for(var ye=E.listSelections(),Ce=0;Ce<ye.length;Ce++){var nt=ye[Ce].head;E.replaceRange(pe.removed[Ce]||"",It(nt,0,-pe.inserted.length),nt,"+input")}ae.macroModeState.lastInsertModeChanges.changes.pop()}return de.command||Kt(E),de.command}function W(){if(D()||Q())return!0;C.inputState.keyBuffer.push(f);var X=C.inputState.keyBuffer.join("");if(/^[1-9]\d*$/.test(X))return!0;var re=/^(\d*)(.*)$/.exec(X);if(!re)return Kt(E),!1;var de=C.visualMode?"visual":"normal",pe=re[2]||re[1];C.inputState.operatorShortcut&&C.inputState.operatorShortcut.slice(-1)==pe&&(pe=C.inputState.operatorShortcut);var ye=pt.matchCommand(pe,s,C.inputState,de);return ye.type=="none"?(Kt(E),!1):ye.type=="partial"?(ye.expectLiteralNext&&(C.expectLiteralNext=!0),!0):ye.type=="clear"?(Kt(E),!0):(C.expectLiteralNext=!1,C.inputState.keyBuffer.length=0,re=/^(\d*)(.*)$/.exec(X),re&&re[1]&&re[1]!="0"&&C.inputState.pushRepeatDigit(re[1]),ye.command)}var G=C.insertMode?z():W();if(G===!1)return!C.insertMode&&(f.length===1||n.isMac&&/<A-.>/.test(f))?function(){return!0}:void 0;if(G===!0)return function(){return!0};if(G)return function(){return E.operation(function(){E.curOp.isVimOp=!0;try{if(typeof G!="object")return;G.type=="keyToKey"?Ct(E,G.toKeys,G):pt.processCommand(E,C,G)}catch(X){throw E.state.vim=void 0,Se(E),ge.suppressErrorLogging||console.log(X),X}return!0})}},handleEx:function(p,f){Ze.processCommand(p,f)},defineMotion:Zt,defineAction:Lt,defineOperator:Ft,mapCommand:Ue,_mapCommand:ot,defineRegister:bn,exitVisualMode:Re,exitInsertMode:Ne},Ye=[],yt=!1,Xe;function Ge(p){if(!Xe)throw new Error("No prompt to send key to");if(p[0]=="<"){var f=p.toLowerCase().slice(1,-1),v=f.split("-");if(f=v.pop()||"",f=="lt")p="<";else if(f=="space")p=" ";else if(f=="cr")p=`
`;else if(On[f]){var C=Xe.value||"",E={key:On[f],target:{value:C,selectionEnd:C.length,selectionStart:C.length}};Xe.onKeyDown&&Xe.onKeyDown(E,Xe.value,Q),Xe&&Xe.onKeyUp&&Xe.onKeyUp(E,Xe.value,Q);return}}if(p==`
`){var D=Xe;Xe=null,D.onClose&&D.onClose(D.value)}else Xe.value=(Xe.value||"")+p;function Q(z){Xe&&(typeof z=="string"?Xe.value=z:Xe=null)}}function Ct(p,f,v){var C=yt;if(v){if(Ye.indexOf(v)!=-1)return;Ye.push(v),yt=v.noremap!=!1}try{for(var E=Se(p),D=/<(?:[CSMA]-)*\w+>|./gi,Q;Q=D.exec(f);){var z=Q[0],W=E.insertMode;if(Xe){Ge(z);continue}var G=ge.handleKey(p,z,"mapping");if(!G&&W&&E.insertMode){if(z[0]=="<"){var X=z.toLowerCase().slice(1,-1),re=X.split("-");if(X=re.pop()||"",X=="lt")z="<";else if(X=="space")z=" ";else if(X=="cr")z=`
`;else if(On.hasOwnProperty(X)){z=On[X],Ps(p,z);continue}else z=z[0],D.lastIndex=Q.index+1}p.replaceSelection(z)}}}finally{if(Ye.pop(),yt=Ye.length?C:!1,!Ye.length&&Xe){var de=Xe;Xe=null,Kr(p,de)}}}var Et={Return:"CR",Backspace:"BS",Delete:"Del",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"CR"," ":"Space"},gn={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1,AltGraph:1,Dead:1,Unidentified:1},On={};"Left|Right|Up|Down|End|Home".split("|").concat(Object.keys(Et)).forEach(function(p){On[(Et[p]||"").toLowerCase()]=On[p.toLowerCase()]=p});function qn(p,f){var D;var v=p.key;if(!gn[v]){v.length>1&&v[0]=="n"&&(v=v.replace("Numpad","")),v=Et[v]||v;var C="";if(p.ctrlKey&&(C+="C-"),p.altKey&&(C+="A-"),p.metaKey&&(C+="M-"),n.isMac&&C=="A-"&&v.length==1&&(C=C.slice(2)),(C||v.length>1)&&p.shiftKey&&(C+="S-"),f&&!f.expectLiteralNext&&v.length==1){if(o.keymap&&v in o.keymap)(o.remapCtrl!=!1||!C)&&(v=o.keymap[v]);else if(v.charCodeAt(0)>128&&!r[v]){var E=((D=p.code)==null?void 0:D.slice(-1))||"";p.shiftKey||(E=E.toLowerCase()),E&&(v=E,!C&&p.altKey&&(C="A-"))}}return C+=v,C.length>1&&(C="<"+C+">"),C}}function cn(p,f){o.string!==p&&(o=un(p)),o.remapCtrl=f}function un(p){let f={};if(!p)return{keymap:f,string:""};function v(C){return C.split(/\\?(.)/).filter(Boolean)}return p.split(/((?:[^\\,]|\\.)+),/).map(C=>{if(!C)return;const E=C.split(/((?:[^\\;]|\\.)+);/);if(E.length==3){const D=v(E[1]),Q=v(E[2]);if(D.length!==Q.length)return;for(let z=0;z<D.length;++z)f[D[z]]=Q[z]}else if(E.length==1){const D=v(C);if(D.length%2!==0)return;for(let Q=0;Q<D.length;Q+=2)f[D[Q]]=D[Q+1]}}),{keymap:f,string:p}}he("langmap",void 0,"string",["lmap"],function(p,f){if(p===void 0)return o.string;cn(p)});class Rt{constructor(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=void 0,this.changeQueue=null}pushRepeatDigit(f){this.operator?this.motionRepeat=this.motionRepeat.concat(f):this.prefixRepeat=this.prefixRepeat.concat(f)}getRepeat(){var f=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(f=1,this.prefixRepeat.length>0&&(f*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(f*=parseInt(this.motionRepeat.join(""),10))),f}}function Kt(p,f){p.state.vim.inputState=new Rt,p.state.vim.expectLiteralNext=!1,n.signal(p,"vim-command-done",f)}function Un(){this.removed=[],this.inserted=""}class Wn{constructor(f,v,C){this.clear(),this.keyBuffer=[f||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!v,this.blockwise=!!C}setText(f,v,C){this.keyBuffer=[f||""],this.linewise=!!v,this.blockwise=!!C}pushText(f,v){v&&(this.linewise||this.keyBuffer.push(`
`),this.linewise=!0),this.keyBuffer.push(f)}pushInsertModeChanges(f){this.insertModeChanges.push(Pe(f))}pushSearchQuery(f){this.searchQueries.push(f)}clear(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1}toString(){return this.keyBuffer.join("")}}function bn(p,f){var v=ae.registerController.registers;if(!p||p.length!=1)throw Error("Register name must be 1 character");if(v[p])throw Error("Register already defined "+p);v[p]=f,O.push(p)}class rt{constructor(f){this.registers=f,this.unnamedRegister=f['"']=new Wn,f["."]=new Wn,f[":"]=new Wn,f["/"]=new Wn,f["+"]=new Wn}pushText(f,v,C,E,D){if(f!=="_"){E&&C.charAt(C.length-1)!==`
`&&(C+=`
`);var Q=this.isValidRegister(f)?this.getRegister(f):null;if(!Q||!f){switch(v){case"yank":this.registers[0]=new Wn(C,E,D);break;case"delete":case"change":C.indexOf(`
`)==-1?this.registers["-"]=new Wn(C,E):(this.shiftNumericRegisters_(),this.registers[1]=new Wn(C,E));break}this.unnamedRegister.setText(C,E,D);return}var z=L(f);z?Q.pushText(C,E):Q.setText(C,E,D),f==="+"&&navigator.clipboard.writeText(C),this.unnamedRegister.setText(Q.toString(),E)}}getRegister(f){return this.isValidRegister(f)?(f=f.toLowerCase(),this.registers[f]||(this.registers[f]=new Wn),this.registers[f]):this.unnamedRegister}isValidRegister(f){return f&&(ce(f,O)||S.test(f))}shiftNumericRegisters_(){for(var f=9;f>=2;f--)this.registers[f]=this.getRegister(""+(f-1))}}class Pn{constructor(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}nextMatch(f,v){var C=this.historyBuffer,E=v?-1:1;this.initialPrefix===null&&(this.initialPrefix=f);for(var D=this.iterator+E;v?D>=0:D<C.length;D+=E)for(var Q=C[D],z=0;z<=Q.length;z++)if(this.initialPrefix==Q.substring(0,z))return this.iterator=D,Q;if(D>=C.length)return this.iterator=C.length,this.initialPrefix;if(D<0)return f}pushInput(f){var v=this.historyBuffer.indexOf(f);v>-1&&this.historyBuffer.splice(v,1),f.length&&this.historyBuffer.push(f)}reset(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}}var pt={matchCommand:function(p,f,v,C){var E=Dn(p,f,C,v),D=E.full[0];if(!D)return E.partial.length?{type:"partial",expectLiteralNext:E.partial.length==1&&E.partial[0].keys.slice(-11)=="<character>"}:{type:"none"};if(D.keys.slice(-11)=="<character>"||D.keys.slice(-10)=="<register>"){var Q=Wt(p);if(!Q||Q.length>1)return{type:"clear"};v.selectedCharacter=Q}return{type:"full",command:D}},processCommand:function(p,f,v){switch(f.inputState.repeatOverride=v.repeatOverride,v.type){case"motion":this.processMotion(p,f,v);break;case"operator":this.processOperator(p,f,v);break;case"operatorMotion":this.processOperatorMotion(p,f,v);break;case"action":this.processAction(p,f,v);break;case"search":this.processSearch(p,f,v);break;case"ex":case"keyToEx":this.processEx(p,f,v);break}},processMotion:function(p,f,v){f.inputState.motion=v.motion,f.inputState.motionArgs=is(v.motionArgs),this.evalInput(p,f)},processOperator:function(p,f,v){var C=f.inputState;if(C.operator)if(C.operator==v.operator){C.motion="expandToLine",C.motionArgs={linewise:!0,repeat:1},this.evalInput(p,f);return}else Kt(p);C.operator=v.operator,C.operatorArgs=is(v.operatorArgs),v.keys.length>1&&(C.operatorShortcut=v.keys),v.exitVisualBlock&&(f.visualBlock=!1,te(p)),f.visualMode&&this.evalInput(p,f)},processOperatorMotion:function(p,f,v){var C=f.visualMode,E=is(v.operatorMotionArgs);E&&C&&E.visualLine&&(f.visualLine=!0),this.processOperator(p,f,v),C||this.processMotion(p,f,v)},processAction:function(p,f,v){var C=f.inputState,E=C.getRepeat(),D=!!E,Q=is(v.actionArgs)||{repeat:1};C.selectedCharacter&&(Q.selectedCharacter=C.selectedCharacter),v.operator&&this.processOperator(p,f,v),v.motion&&this.processMotion(p,f,v),(v.motion||v.operator)&&this.evalInput(p,f),Q.repeat=E||1,Q.repeatIsExplicit=D,Q.registerName=C.registerName,Kt(p),f.lastMotion=null,v.isEdit&&this.recordLastEdit(f,C,v),_e[v.action](p,Q,f)},processSearch:function(p,f,v){if(!p.getSearchCursor)return;var C=v.searchArgs.forward,E=v.searchArgs.wholeWordOnly;Fs(p).setReversed(!C);var D=C?"/":"?",Q=Fs(p).getQuery(),z=p.getScrollInfo(),W="";function G(Ie,nt,Nt){ae.searchHistoryController.pushInput(Ie),ae.searchHistoryController.reset();try{Tr(p,Ie,nt,Nt)}catch{fn(p,"Invalid regex: "+Ie),Kt(p);return}pt.processMotion(p,f,{keys:"",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:v.searchArgs.toJumplist}})}function X(Ie){p.scrollTo(z.left,z.top),G(Ie,!0,!0);var nt=ae.macroModeState;nt.isRecording&&zt(nt,Ie)}function re(){return me("pcre")?"(JavaScript regexp: set pcre)":"(Vim regexp: set nopcre)"}function de(Ie,nt,Nt){var ht=qn(Ie),Ot,Ut;ht=="<Up>"||ht=="<Down>"?(Ot=ht=="<Up>",Ut=Ie.target?Ie.target.selectionEnd:0,nt=ae.searchHistoryController.nextMatch(nt,Ot)||"",Nt(nt),Ut&&Ie.target&&(Ie.target.selectionEnd=Ie.target.selectionStart=Math.min(Ut,Ie.target.value.length))):ht&&ht!="<Left>"&&ht!="<Right>"&&ae.searchHistoryController.reset(),W=nt,pe()}function pe(){var Ie;try{Ie=Tr(p,W,!0,!0)}catch{}Ie?p.scrollIntoView(J(p,!C,Ie),30):(M(p),p.scrollTo(z.left,z.top))}function ye(Ie,nt,Nt){var ht=qn(Ie);ht=="<Esc>"||ht=="<C-c>"||ht=="<C-[>"||ht=="<BS>"&&nt==""?(ae.searchHistoryController.pushInput(nt),ae.searchHistoryController.reset(),Tr(p,(Q==null?void 0:Q.source)||""),M(p),p.scrollTo(z.left,z.top),n.e_stop(Ie),Kt(p),Nt(),p.focus()):ht=="<Up>"||ht=="<Down>"?n.e_stop(Ie):ht=="<C-u>"&&(n.e_stop(Ie),Nt(""))}switch(v.searchArgs.querySrc){case"prompt":var Ce=ae.macroModeState;if(Ce.isPlaying){let nt=Ce.replaySearchQueries.shift();G(nt||"",!0,!1)}else Kr(p,{onClose:X,prefix:D,desc:wr("span",{$cursor:"pointer",onmousedown:function(nt){nt.preventDefault(),H("pcre",!me("pcre")),this.textContent=re(),pe()}},re()),onKeyUp:de,onKeyDown:ye});break;case"wordUnderCursor":var Be=Is(p,{noSymbol:!0}),je=!0;if(Be||(Be=Is(p,{noSymbol:!1}),je=!1),!Be){fn(p,"No word under cursor"),Kt(p);return}let Ie=p.getLine(Be.start.line).substring(Be.start.ch,Be.end.ch);je&&E?Ie="\\b"+Ie+"\\b":Ie=Ys(Ie),ae.jumpList.cachedCursor=p.getCursor(),p.setCursor(Be.start),G(Ie,!0,!1);break}},processEx:function(p,f,v){function C(z){ae.exCommandHistoryController.pushInput(z),ae.exCommandHistoryController.reset(),Ze.processCommand(p,z),p.state.vim&&Kt(p),M(p)}function E(z,W,G){var X=qn(z),re,de;(X=="<Esc>"||X=="<C-c>"||X=="<C-[>"||X=="<BS>"&&W=="")&&(ae.exCommandHistoryController.pushInput(W),ae.exCommandHistoryController.reset(),n.e_stop(z),Kt(p),M(p),G(),p.focus()),X=="<Up>"||X=="<Down>"?(n.e_stop(z),re=X=="<Up>",de=z.target?z.target.selectionEnd:0,W=ae.exCommandHistoryController.nextMatch(W,re)||"",G(W),de&&z.target&&(z.target.selectionEnd=z.target.selectionStart=Math.min(de,z.target.value.length))):X=="<C-u>"?(n.e_stop(z),G("")):X&&X!="<Left>"&&X!="<Right>"&&ae.exCommandHistoryController.reset()}function D(z,W){var G=new n.StringStream(W),X={};try{if(Ze.parseInput_(p,G,X),X.commandName!="s"){M(p);return}var re=Ze.matchCommand_(X.commandName);if(!re||(Ze.parseCommandArgs_(G,X,re),!X.argString))return;var de=Tn(X.argString.slice(1),!0,!0);de&&K(p,de)}catch{}}if(v.type=="keyToEx")Ze.processCommand(p,v.exArgs.input);else{var Q={onClose:C,onKeyDown:E,onKeyUp:D,prefix:":"};f.visualMode&&(Q.value="'<,'>",Q.selectValueOnOpen=!1),Kr(p,Q)}},evalInput:function(p,f){var v=f.inputState,C=v.motion,E=v.motionArgs||{repeat:1},D=v.operator,Q=v.operatorArgs||{},z=v.registerName,W=f.sel,G=$t(f.visualMode?et(p,W.head):p.getCursor("head")),X=$t(f.visualMode?et(p,W.anchor):p.getCursor("anchor")),re=$t(G),de=$t(X),pe,ye,Ce;if(D&&this.recordLastEdit(f,v),v.repeatOverride!==void 0?Ce=v.repeatOverride:Ce=v.getRepeat(),Ce>0&&E.explicitRepeat?E.repeatIsExplicit=!0:(E.noRepeat||!E.explicitRepeat&&Ce===0)&&(Ce=1,E.repeatIsExplicit=!1),v.selectedCharacter&&(E.selectedCharacter=Q.selectedCharacter=v.selectedCharacter),E.repeat=Ce,Kt(p),C){var Be=Vt[C](p,G,E,f,v);if(f.lastMotion=Vt[C],!Be)return;if(E.toJumplist){var je=ae.jumpList,Ie=je.cachedCursor;Ie?(Jt(p,Ie,Be),delete je.cachedCursor):Jt(p,G,Be)}Be instanceof Array?(ye=Be[0],pe=Be[1]):pe=Be,pe||(pe=$t(G)),f.visualMode?(f.visualBlock&&pe.ch===1/0||(pe=et(p,pe,re)),ye&&(ye=et(p,ye)),ye=ye||de,W.anchor=ye,W.head=pe,te(p),Dr(p,f,"<",st(ye,pe)?ye:pe),Dr(p,f,">",st(ye,pe)?pe:ye)):D||(pe=et(p,pe,re),p.setCursor(pe.line,pe.ch))}if(D){if(Q.lastSel){ye=de;var nt=Q.lastSel,Nt=Math.abs(nt.head.line-nt.anchor.line),ht=Math.abs(nt.head.ch-nt.anchor.ch);nt.visualLine?pe=new e(de.line+Nt,de.ch):nt.visualBlock?pe=new e(de.line+Nt,de.ch+ht):nt.head.line==nt.anchor.line?pe=new e(de.line,de.ch+ht):pe=new e(de.line+Nt,de.ch),f.visualMode=!0,f.visualLine=nt.visualLine,f.visualBlock=nt.visualBlock,W=f.sel={anchor:ye,head:pe},te(p)}else f.visualMode&&(Q.lastSel={anchor:$t(W.anchor),head:$t(W.head),visualBlock:f.visualBlock,visualLine:f.visualLine});var Ot,Ut,Ht,ct,dn;if(f.visualMode){Ot=Gt(W.head,W.anchor),Ut=an(W.head,W.anchor),Ht=f.visualLine||Q.linewise,ct=f.visualBlock?"block":Ht?"line":"char";var Gn=t(p,Ot,Ut);if(dn=be(p,{anchor:Gn.start,head:Gn.end},ct),Ht){var An=dn.ranges;if(ct=="block")for(var Rn=0;Rn<An.length;Rn++)An[Rn].head.ch=Vn(p,An[Rn].head.line);else ct=="line"&&(An[0].head=new e(An[0].head.line+1,0))}}else{if(Ot=$t(ye||de),Ut=$t(pe||re),st(Ut,Ot)){var er=Ot;Ot=Ut,Ut=er}Ht=E.linewise||Q.linewise,Ht?on(p,Ot,Ut):E.forward&&ut(p,Ot,Ut),ct="char";var ur=!E.inclusive||Ht,Gn=t(p,Ot,Ut);dn=be(p,{anchor:Gn.start,head:Gn.end},ct,ur)}p.setSelections(dn.ranges,dn.primary),f.lastMotion=null,Q.repeat=Ce,Q.registerName=z,Q.linewise=Ht;var sr=it[D](p,Q,dn.ranges,de,pe);f.visualMode&&Re(p,sr!=null),sr&&p.setCursor(sr)}},recordLastEdit:function(p,f,v){var C=ae.macroModeState;C.isPlaying||(p.lastEditInputState=f,p.lastEditActionCommand=v,C.lastInsertModeChanges.changes=[],C.lastInsertModeChanges.expectCursorActivityForChange=!1,C.lastInsertModeChanges.visualBlock=p.visualBlock?p.sel.head.line-p.sel.anchor.line:0)}},Vt={moveToTopLine:function(p,f,v){var C=we(p).top+v.repeat-1;return new e(C,Yn(p.getLine(C)))},moveToMiddleLine:function(p){var f=we(p),v=Math.floor((f.top+f.bottom)*.5);return new e(v,Yn(p.getLine(v)))},moveToBottomLine:function(p,f,v){var C=we(p).bottom-v.repeat+1;return new e(C,Yn(p.getLine(C)))},expandToLine:function(p,f,v){var C=f;return new e(C.line+v.repeat-1,1/0)},findNext:function(p,f,v){var C=Fs(p),E=C.getQuery();if(E){var D=!v.forward;D=C.isReversed()?!D:D,K(p,E);var Q=J(p,D,E,v.repeat);return Q||fn(p,"No match found "+E+(me("pcre")?" (set nopcre to use Vim regexps)":"")),Q}},findAndSelectNextInclusive:function(p,f,v,C,E){var D=Fs(p),Q=D.getQuery();if(Q){var z=!v.forward;z=D.isReversed()?!z:z;var W=ne(p,z,Q,v.repeat,C);if(W){if(E.operator)return W;var G=W[0],X=new e(W[1].line,W[1].ch-1);if(C.visualMode){(C.visualLine||C.visualBlock)&&(C.visualLine=!1,C.visualBlock=!1,n.signal(p,"vim-mode-change",{mode:"visual",subMode:""}));var re=C.sel.anchor;if(re)return D.isReversed()?v.forward?[re,G]:[re,X]:v.forward?[re,X]:[re,G]}else C.visualMode=!0,C.visualLine=!1,C.visualBlock=!1,n.signal(p,"vim-mode-change",{mode:"visual",subMode:""});return z?[X,G]:[G,X]}}},goToMark:function(p,f,v,C){var E=xe(p,C,v.selectedCharacter||"");return E?v.linewise?{line:E.line,ch:Yn(p.getLine(E.line))}:E:null},moveToOtherHighlightedEnd:function(p,f,v,C){var E=C.sel;return C.visualBlock&&v.sameLine?[et(p,new e(E.anchor.line,E.head.ch)),et(p,new e(E.head.line,E.anchor.ch))]:[E.head,E.anchor]},jumpToMark:function(p,f,v,C){for(var E=f,D=0;D<v.repeat;D++){var Q=E;for(var z in C.marks)if(j(z)){var W=C.marks[z].find(),G=v.forward?st(W,Q):st(Q,W);if(!G&&!(v.linewise&&W.line==Q.line)){var X=xn(Q,E),re=v.forward?vs(Q,W,E):vs(E,W,Q);(X||re)&&(E=W)}}}return v.linewise&&(E=new e(E.line,Yn(p.getLine(E.line)))),E},moveByCharacters:function(p,f,v){var C=f,E=v.repeat,D=v.forward?C.ch+E:C.ch-E;return new e(C.line,D)},moveByLines:function(p,f,v,C){var E=f,D=E.ch;switch(C.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:D=C.lastHPos;break;default:C.lastHPos=D}var Q=v.repeat+(v.repeatOffset||0),z=v.forward?E.line+Q:E.line-Q,W=p.firstLine(),G=p.lastLine(),X=p.findPosV(E,v.forward?Q:-Q,"line",C.lastHSPos),re=v.forward?X.line>z:X.line<z;return re&&(z=X.line,D=X.ch),z<W&&E.line==W?this.moveToStartOfLine(p,f,v,C):z>G&&E.line==G?di(p,f,v,C,!0):(v.toFirstChar&&(D=Yn(p.getLine(z)),C.lastHPos=D),C.lastHSPos=p.charCoords(new e(z,D),"div").left,new e(z,D))},moveByDisplayLines:function(p,f,v,C){var E=f;switch(C.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:C.lastHSPos=p.charCoords(E,"div").left}var D=v.repeat,Q=p.findPosV(E,v.forward?D:-D,"line",C.lastHSPos);if(Q.hitSide)if(v.forward){var z=p.charCoords(Q,"div"),W={top:z.top+8,left:C.lastHSPos};Q=p.coordsChar(W,"div")}else{var G=p.charCoords(new e(p.firstLine(),0),"div");G.left=C.lastHSPos,Q=p.coordsChar(G,"div")}return C.lastHPos=Q.ch,Q},moveByPage:function(p,f,v){var C=f,E=v.repeat;return p.findPosV(C,v.forward?E:-E,"page")},moveByParagraph:function(p,f,v){var C=v.forward?1:-1;return Ni(p,f,v.repeat,C).start},moveBySentence:function(p,f,v){var C=v.forward?1:-1;return Ul(p,f,v.repeat,C)},moveByScroll:function(p,f,v,C){var E=p.getScrollInfo(),D=null,Q=v.repeat;Q||(Q=E.clientHeight/(2*p.defaultTextHeight()));var z=p.charCoords(f,"local");if(v.repeat=Q,D=Vt.moveByDisplayLines(p,f,v,C),!D)return null;var W=p.charCoords(D,"local");return p.scrollTo(null,E.top+W.top-z.top),D},moveByWords:function(p,f,v){return hi(p,f,v.repeat,!!v.forward,!!v.wordEnd,!!v.bigWord)},moveTillCharacter:function(p,f,v){var C=v.repeat,E=Ls(p,C,v.forward,v.selectedCharacter,f),D=v.forward?-1:1;return sn(D,v),E?(E.ch+=D,E):null},moveToCharacter:function(p,f,v){var C=v.repeat;return sn(0,v),Ls(p,C,v.forward,v.selectedCharacter,f)||f},moveToSymbol:function(p,f,v){var C=v.repeat;return v.selectedCharacter&&$i(p,C,v.forward,v.selectedCharacter)||f},moveToColumn:function(p,f,v,C){var E=v.repeat;return C.lastHPos=E-1,C.lastHSPos=p.charCoords(f,"div").left,ql(p,E)},moveToEol:function(p,f,v,C){return di(p,f,v,C,!1)},moveToFirstNonWhiteSpaceCharacter:function(p,f){var v=f;return new e(v.line,Yn(p.getLine(v.line)))},moveToMatchedSymbol:function(p,f){for(var v=f,C=v.line,E=v.ch,D=p.getLine(C),Q;E<D.length;E++)if(Q=D.charAt(E),Q&&N(Q)){var z=p.getTokenTypeAt(new e(C,E+1));if(z!=="string"&&z!=="comment")break}if(E<D.length){var W=Q==="<"||Q===">"?/[(){}[\]<>]/:/[(){}[\]]/,G=p.findMatchingBracket(new e(C,E),{bracketRegex:W});return G.to}else return v},moveToStartOfLine:function(p,f){return new e(f.line,0)},moveToLineOrEdgeOfDocument:function(p,f,v){var C=v.forward?p.lastLine():p.firstLine();return v.repeatIsExplicit&&(C=v.repeat-p.getOption("firstLineNumber")),new e(C,Yn(p.getLine(C)))},moveToStartOfDisplayLine:function(p){return p.execCommand("goLineLeft"),p.getCursor()},moveToEndOfDisplayLine:function(p){p.execCommand("goLineRight");var f=p.getCursor();return f.sticky=="before"&&f.ch--,f},textObjectManipulation:function(p,f,v,C){var E={"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"},D={"'":!0,'"':!0,"`":!0},Q=v.selectedCharacter||"";Q=="b"?Q="(":Q=="B"&&(Q="{");var z=!v.textObjectInner,W,G;if(E[Q]){if(G=!0,W=_i(p,f,Q,z),!W){var X=p.getSearchCursor(new RegExp("\\"+Q,"g"),f);X.find()&&(W=_i(p,X.from(),Q,z))}}else if(D[Q])G=!0,W=Ks(p,f,Q,z);else if(Q==="W"||Q==="w")for(var re=v.repeat||1;re-- >0;){var de=Is(p,{inclusive:z,innerWord:!z,bigWord:Q==="W",noSymbol:Q==="W",multiline:!0},W&&W.end);de&&(W||(W=de),W.end=de.end)}else if(Q==="p")if(W=Ni(p,f,v.repeat,0,z),v.linewise=!0,C.visualMode)C.visualLine||(C.visualLine=!0);else{var pe=C.inputState.operatorArgs;pe&&(pe.linewise=!0),W.end.line--}else if(Q==="t")W=mn(p,f,z);else if(Q==="s"){var ye=p.getLine(f.line);f.ch>0&&q(ye[f.ch])&&(f.ch-=1);var Ce=Xr(p,f,v.repeat,1,z),Be=Xr(p,f,v.repeat,-1,z);I(p.getLine(Be.line)[Be.ch])&&I(p.getLine(Ce.line)[Ce.ch-1])&&(Be={line:Be.line,ch:Be.ch+1}),W={start:Be,end:Ce}}return W?p.state.vim.visualMode?se(p,W.start,W.end,G):[W.start,W.end]:null},repeatLastCharacterSearch:function(p,f,v){var C=ae.lastCharacterSearch,E=v.repeat,D=v.forward===C.forward,Q=(C.increment?1:0)*(D?-1:1);p.moveH(-Q,"char"),v.inclusive=!!D;var z=Ls(p,E,D,C.selectedCharacter);return z?(z.ch+=Q,z):(p.moveH(Q,"char"),f)}};function Zt(p,f){Vt[p]=f}function _n(p,f){for(var v=[],C=0;C<f;C++)v.push(p);return v}var it={change:function(p,f,v){var C,E,D=p.state.vim,Q=v[0].anchor,z=v[0].head;if(D.visualMode)if(f.fullLine)z.ch=Number.MAX_VALUE,z.line--,p.setSelection(Q,z),E=p.getSelection(),p.replaceSelection(""),C=Q;else{E=p.getSelection();var X=_n("",v.length);p.replaceSelections(X),C=Gt(v[0].head,v[0].anchor)}else{E=p.getRange(Q,z);var W=D.lastEditInputState;if((W==null?void 0:W.motion)=="moveByWords"&&!I(E)){var G=/\s+$/.exec(E);G&&W.motionArgs&&W.motionArgs.forward&&(z=It(z,0,-G[0].length),E=E.slice(0,-G[0].length))}f.linewise&&(Q=new e(Q.line,Yn(p.getLine(Q.line))),z.line>Q.line&&(z=new e(z.line-1,Number.MAX_VALUE))),p.replaceRange("",Q,z),C=Q}ae.registerController.pushText(f.registerName,"change",E,f.linewise,v.length>1),_e.enterInsertMode(p,{head:C},p.state.vim)},delete:function(p,f,v){var C,E,D=p.state.vim;if(D.visualBlock){E=p.getSelection();var W=_n("",v.length);p.replaceSelections(W),C=Gt(v[0].head,v[0].anchor)}else{var Q=v[0].anchor,z=v[0].head;f.linewise&&z.line!=p.firstLine()&&Q.line==p.lastLine()&&Q.line==z.line-1&&(Q.line==p.firstLine()?Q.ch=0:Q=new e(Q.line-1,Vn(p,Q.line-1))),E=p.getRange(Q,z),p.replaceRange("",Q,z),C=Q,f.linewise&&(C=Vt.moveToFirstNonWhiteSpaceCharacter(p,Q))}return ae.registerController.pushText(f.registerName,"delete",E,f.linewise,D.visualBlock),et(p,C)},indent:function(p,f,v){var C=p.state.vim,E=C.visualMode&&f.repeat||1;if(C.visualBlock){for(var D=p.getOption("tabSize"),Q=p.getOption("indentWithTabs")?"	":" ".repeat(D),z,W=v.length-1;W>=0;W--)if(z=Gt(v[W].anchor,v[W].head),f.indentRight)p.replaceRange(Q.repeat(E),z,z);else{for(var G=p.getLine(z.line),X=0,re=0;re<E;re++){var de=G[z.ch+X];if(de=="	")X++;else if(de==" "){X++;for(var pe=1;pe<Q.length&&(de=G[z.ch+X],de===" ");pe++)X++}else break}p.replaceRange("",z,It(z,0,X))}return z}else if(p.indentMore)for(var re=0;re<E;re++)f.indentRight?p.indentMore():p.indentLess();else{var ye=v[0].anchor.line,Ce=C.visualBlock?v[v.length-1].anchor.line:v[0].head.line;f.linewise&&Ce--;for(var W=ye;W<=Ce;W++)for(var re=0;re<E;re++)p.indentLine(W,f.indentRight)}return Vt.moveToFirstNonWhiteSpaceCharacter(p,v[0].anchor)},indentAuto:function(p,f,v){return p.execCommand("indentAuto"),Vt.moveToFirstNonWhiteSpaceCharacter(p,v[0].anchor)},hardWrap:function(p,f,v,C){if(p.hardWrap){var E=v[0].anchor.line,D=v[0].head.line;f.linewise&&D--;var Q=p.hardWrap({from:E,to:D});return Q>E&&f.linewise&&Q--,f.keepCursor?C:new e(Q,0)}},changeCase:function(p,f,v,C,E){for(var D=p.getSelections(),Q=[],z=f.toLower,W=0;W<D.length;W++){var G=D[W],X="";if(z===!0)X=G.toLowerCase();else if(z===!1)X=G.toUpperCase();else for(var re=0;re<G.length;re++){var de=G.charAt(re);X+=L(de)?de.toLowerCase():de.toUpperCase()}Q.push(X)}return p.replaceSelections(Q),f.shouldMoveCursor?E:!p.state.vim.visualMode&&f.linewise&&v[0].anchor.line+1==v[0].head.line?Vt.moveToFirstNonWhiteSpaceCharacter(p,C):f.linewise?C:Gt(v[0].anchor,v[0].head)},yank:function(p,f,v,C){var E=p.state.vim,D=p.getSelection(),Q=E.visualMode?Gt(E.sel.anchor,E.sel.head,v[0].head,v[0].anchor):C;return ae.registerController.pushText(f.registerName,"yank",D,f.linewise,E.visualBlock),Q},rot13:function(p,f,v,C,E){for(var D=p.getSelections(),Q=[],z=0;z<D.length;z++){const W=D[z].split("").map(G=>{const X=G.charCodeAt(0);return X>=65&&X<=90?String.fromCharCode(65+(X-65+13)%26):X>=97&&X<=122?String.fromCharCode(97+(X-97+13)%26):G}).join("");Q.push(W)}return p.replaceSelections(Q),f.shouldMoveCursor?E:!p.state.vim.visualMode&&f.linewise&&v[0].anchor.line+1==v[0].head.line?Vt.moveToFirstNonWhiteSpaceCharacter(p,C):f.linewise?C:Gt(v[0].anchor,v[0].head)}};function Ft(p,f){it[p]=f}var _e={jumpListWalk:function(p,f,v){if(!v.visualMode){var C=f.repeat||1,E=f.forward,D=ae.jumpList,Q=D.move(p,E?C:-C),z=Q?Q.find():void 0;z=z||p.getCursor(),p.setCursor(z)}},scroll:function(p,f,v){if(!v.visualMode){var C=f.repeat||1,E=p.defaultTextHeight(),D=p.getScrollInfo().top,Q=E*C,z=f.forward?D+Q:D-Q,W=$t(p.getCursor()),G=p.charCoords(W,"local");if(f.forward)z>G.top?(W.line+=(z-G.top)/E,W.line=Math.ceil(W.line),p.setCursor(W),G=p.charCoords(W,"local"),p.scrollTo(null,G.top)):p.scrollTo(null,z);else{var X=z+p.getScrollInfo().clientHeight;X<G.bottom?(W.line-=(G.bottom-X)/E,W.line=Math.floor(W.line),p.setCursor(W),G=p.charCoords(W,"local"),p.scrollTo(null,G.bottom-p.getScrollInfo().clientHeight)):p.scrollTo(null,z)}}},scrollToCursor:function(p,f){var v=p.getCursor().line,C=p.charCoords(new e(v,0),"local"),E=p.getScrollInfo().clientHeight,D=C.top;switch(f.position){case"center":D=C.bottom-E/2;break;case"bottom":var Q=new e(v,p.getLine(v).length-1),z=p.charCoords(Q,"local"),W=z.bottom-D;D=D-E+W;break}p.scrollTo(null,D)},replayMacro:function(p,f,v){var C=f.selectedCharacter||"",E=f.repeat||1,D=ae.macroModeState;for(C=="@"?C=D.latestRegister||"":D.latestRegister=C;E--;)Je(p,v,D,C)},enterMacroRecordMode:function(p,f){var v=ae.macroModeState,C=f.selectedCharacter;ae.registerController.isValidRegister(C)&&v.enterMacroRecordMode(p,C)},toggleOverwrite:function(p){p.state.overwrite?(p.toggleOverwrite(!1),p.setOption("keyMap","vim-insert"),n.signal(p,"vim-mode-change",{mode:"insert"})):(p.toggleOverwrite(!0),p.setOption("keyMap","vim-replace"),n.signal(p,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(p,f,v){if(!p.getOption("readOnly")){v.insertMode=!0,v.insertModeRepeat=f&&f.repeat||1;var C=f?f.insertAt:null,E=v.sel,D=f.head||p.getCursor("head"),Q=p.listSelections().length;if(C=="eol")D=new e(D.line,Vn(p,D.line));else if(C=="bol")D=new e(D.line,0);else if(C=="charAfter"){var z=t(p,D,It(D,0,1));D=z.end}else if(C=="firstNonBlank"){var z=t(p,D,Vt.moveToFirstNonWhiteSpaceCharacter(p,D));D=z.end}else if(C=="startOfSelectedArea"){if(!v.visualMode)return;v.visualBlock?(D=new e(Math.min(E.head.line,E.anchor.line),Math.min(E.head.ch,E.anchor.ch)),Q=Math.abs(E.head.line-E.anchor.line)+1):E.head.line<E.anchor.line?D=E.head:D=new e(E.anchor.line,0)}else if(C=="endOfSelectedArea"){if(!v.visualMode)return;v.visualBlock?(D=new e(Math.min(E.head.line,E.anchor.line),Math.max(E.head.ch,E.anchor.ch)+1),Q=Math.abs(E.head.line-E.anchor.line)+1):E.head.line>=E.anchor.line?D=It(E.head,0,1):D=new e(E.anchor.line,0)}else if(C=="inplace"){if(v.visualMode)return}else C=="lastEdit"&&(D=Ae(p)||D);p.setOption("disableInput",!1),f&&f.replace?(p.toggleOverwrite(!0),p.setOption("keyMap","vim-replace"),n.signal(p,"vim-mode-change",{mode:"replace"})):(p.toggleOverwrite(!1),p.setOption("keyMap","vim-insert"),n.signal(p,"vim-mode-change",{mode:"insert"})),ae.macroModeState.isPlaying||(p.on("change",Tt),v.insertEnd&&v.insertEnd.clear(),v.insertEnd=p.setBookmark(D,{insertLeft:!0}),n.on(p.getInputField(),"keydown",wn)),v.visualMode&&Re(p),B(p,D,Q)}},toggleVisualMode:function(p,f,v){var C=f.repeat,E=p.getCursor(),D;if(v.visualMode)v.visualLine!=!!f.linewise||v.visualBlock!=!!f.blockwise?(v.visualLine=!!f.linewise,v.visualBlock=!!f.blockwise,n.signal(p,"vim-mode-change",{mode:"visual",subMode:v.visualLine?"linewise":v.visualBlock?"blockwise":""}),te(p)):Re(p);else{v.visualMode=!0,v.visualLine=!!f.linewise,v.visualBlock=!!f.blockwise,D=et(p,new e(E.line,E.ch+C-1));var Q=t(p,E,D);v.sel={anchor:Q.start,head:Q.end},n.signal(p,"vim-mode-change",{mode:"visual",subMode:v.visualLine?"linewise":v.visualBlock?"blockwise":""}),te(p),Dr(p,v,"<",Gt(E,D)),Dr(p,v,">",an(E,D))}},reselectLastSelection:function(p,f,v){var C=v.lastSelection;if(v.visualMode&&Y(p,v),C){var E=C.anchorMark.find(),D=C.headMark.find();if(!E||!D)return;v.sel={anchor:E,head:D},v.visualMode=!0,v.visualLine=C.visualLine,v.visualBlock=C.visualBlock,te(p),Dr(p,v,"<",Gt(E,D)),Dr(p,v,">",an(E,D)),n.signal(p,"vim-mode-change",{mode:"visual",subMode:v.visualLine?"linewise":v.visualBlock?"blockwise":""})}},joinLines:function(p,f,v){var C,E;if(v.visualMode){if(C=p.getCursor("anchor"),E=p.getCursor("head"),st(E,C)){var D=E;E=C,C=D}E.ch=Vn(p,E.line)-1}else{var Q=Math.max(f.repeat,2);C=p.getCursor(),E=et(p,new e(C.line+Q-1,1/0))}for(var z=0,W=C.line;W<E.line;W++){z=Vn(p,C.line);var G="",X=0;if(!f.keepSpaces){var re=p.getLine(C.line+1);X=re.search(/\S/),X==-1?X=re.length:G=" "}p.replaceRange(G,new e(C.line,z),new e(C.line+1,X))}var de=et(p,new e(C.line,z));v.visualMode&&Re(p,!1),p.setCursor(de)},newLineAndEnterInsertMode:function(p,f,v){v.insertMode=!0;var C=$t(p.getCursor());if(C.line===p.firstLine()&&!f.after)p.replaceRange(`
`,new e(p.firstLine(),0)),p.setCursor(p.firstLine(),0);else{C.line=f.after?C.line:C.line-1,C.ch=Vn(p,C.line),p.setCursor(C);var E=n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent;E(p)}this.enterInsertMode(p,{repeat:f.repeat},v)},paste:function(p,f,v){var C=ae.registerController.getRegister(f.registerName);if(f.registerName==="+")navigator.clipboard.readText().then(D=>{this.continuePaste(p,f,v,D,C)});else{var E=C.toString();this.continuePaste(p,f,v,E,C)}},continuePaste:function(p,f,v,C,E){var D=$t(p.getCursor());if(C){if(f.matchIndent){var Q=p.getOption("tabSize"),z=function(An){var Rn=An.split("	").length-1,er=An.split(" ").length-1;return Rn*Q+er*1},W=p.getLine(p.getCursor().line),G=z(W.match(/^\s*/)[0]),X=C.replace(/\n$/,""),re=C!==X,de=z(C.match(/^\s*/)[0]),C=X.replace(/^\s*/gm,function(An){var Rn=G+(z(An)-de);if(Rn<0)return"";if(p.getOption("indentWithTabs")){var er=Math.floor(Rn/Q);return Array(er+1).join("	")}else return Array(Rn+1).join(" ")});C+=re?`
`:""}f.repeat>1&&(C=Array(f.repeat+1).join(C));var pe=E.linewise,ye=E.blockwise,Ce=ye?C.split(`
`):void 0;if(Ce){pe&&Ce.pop();for(var Be=0;Be<Ce.length;Be++)Ce[Be]=Ce[Be]==""?" ":Ce[Be];D.ch+=f.after?1:0,D.ch=Math.min(Vn(p,D.line),D.ch)}else pe?v.visualMode?C=v.visualLine?C.slice(0,-1):`
`+C.slice(0,C.length-1)+`
`:f.after?(C=`
`+C.slice(0,C.length-1),D.ch=Vn(p,D.line)):D.ch=0:D.ch+=f.after?1:0;var je;if(v.visualMode){v.lastPastedText=C;var Ie,nt=Z(p),Nt=nt[0],ht=nt[1],Ot=p.getSelection(),Ut=p.listSelections(),Ht=new Array(Ut.length).join("1").split("1");v.lastSelection&&(Ie=v.lastSelection.headMark.find()),ae.registerController.unnamedRegister.setText(Ot),ye?(p.replaceSelections(Ht),ht=new e(Nt.line+C.length-1,Nt.ch),p.setCursor(Nt),_(p,ht),p.replaceSelections(C),je=Nt):v.visualBlock?(p.replaceSelections(Ht),p.setCursor(Nt),p.replaceRange(C,Nt,Nt),je=Nt):(p.replaceRange(C,Nt,ht),je=p.posFromIndex(p.indexFromPos(Nt)+C.length-1)),Ie&&(v.lastSelection.headMark=p.setBookmark(Ie)),pe&&(je.ch=0)}else if(ye&&Ce){p.setCursor(D);for(var Be=0;Be<Ce.length;Be++){var ct=D.line+Be;ct>p.lastLine()&&p.replaceRange(`
`,new e(ct,0));var dn=Vn(p,ct);dn<D.ch&&w(p,ct,D.ch)}p.setCursor(D),_(p,new e(D.line+Ce.length-1,D.ch)),p.replaceSelections(Ce),je=D}else if(p.replaceRange(C,D),pe){var ct=f.after?D.line+1:D.line;je=new e(ct,Yn(p.getLine(ct)))}else je=$t(D),/\n/.test(C)||(je.ch+=C.length-(f.after?1:0));v.visualMode&&Re(p,!1),p.setCursor(je)}},undo:function(p,f){p.operation(function(){Pt(p,n.commands.undo,f.repeat)(),p.setCursor(et(p,p.getCursor("start")))})},redo:function(p,f){Pt(p,n.commands.redo,f.repeat)()},setRegister:function(p,f,v){v.inputState.registerName=f.selectedCharacter},insertRegister:function(p,f,v){var C=f.selectedCharacter,E=ae.registerController.getRegister(C),D=E&&E.toString();D&&p.replaceSelection(D)},oneNormalCommand:function(p,f,v){Ne(p,!0),v.insertModeReturn=!0,n.on(p,"vim-command-done",function C(){v.visualMode||(v.insertModeReturn&&(v.insertModeReturn=!1,v.insertMode||_e.enterInsertMode(p,{},v)),n.off(p,"vim-command-done",C))})},setMark:function(p,f,v){var C=f.selectedCharacter;C&&Dr(p,v,C,p.getCursor())},replace:function(p,f,v){var C=f.selectedCharacter||"",E=p.getCursor(),D,Q,z=p.listSelections();if(v.visualMode)E=p.getCursor("start"),Q=p.getCursor("end");else{var W=p.getLine(E.line);D=E.ch+f.repeat,D>W.length&&(D=W.length),Q=new e(E.line,D)}var G=t(p,E,Q);if(E=G.start,Q=G.end,C==`
`)v.visualMode||p.replaceRange("",E,Q),(n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent)(p);else{var X=p.getRange(E,Q);if(X=X.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,C),X=X.replace(/[^\n]/g,C),v.visualBlock){var re=new Array(p.getOption("tabSize")+1).join(" ");X=p.getSelection(),X=X.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,C);var de=X.replace(/\t/g,re).replace(/[^\n]/g,C).split(`
`);p.replaceSelections(de)}else p.replaceRange(X,E,Q);v.visualMode?(E=st(z[0].anchor,z[0].head)?z[0].anchor:z[0].head,p.setCursor(E),Re(p,!1)):p.setCursor(It(Q,0,-1))}},incrementNumberToken:function(p,f){for(var v=p.getCursor(),C=p.getLine(v.line),E=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi,D,Q,z,W;(D=E.exec(C))!==null&&(Q=D.index,z=Q+D[0].length,!(v.ch<z)););if(!(!f.backtrack&&z<=v.ch)){if(D){var G=D[2]||D[4],X=D[3]||D[5],re=f.increase?1:-1,de={"0b":2,0:8,"":10,"0x":16}[G.toLowerCase()],pe=parseInt(D[1]+X,de)+re*f.repeat;W=pe.toString(de);var ye=G?new Array(X.length-W.length+1+D[1].length).join("0"):"";W.charAt(0)==="-"?W="-"+G+ye+W.substr(1):W=G+ye+W;var Ce=new e(v.line,Q),Be=new e(v.line,z);p.replaceRange(W,Ce,Be)}else return;p.setCursor(new e(v.line,Q+W.length-1))}},repeatLastEdit:function(p,f,v){var C=v.lastEditInputState;if(C){var E=f.repeat;E&&f.repeatIsExplicit?C.repeatOverride=E:E=C.repeatOverride||E,os(p,v,E,!1)}},indent:function(p,f){p.indentLine(p.getCursor().line,f.indentRight)},exitInsertMode:function(p,f){Ne(p)}};function Lt(p,f){_e[p]=f}function et(p,f,v){var C=p.state.vim,E=C.insertMode||C.visualMode,D=Math.min(Math.max(p.firstLine(),f.line),p.lastLine()),Q=p.getLine(D),z=Q.length-1+ +!!E,W=Math.min(Math.max(0,f.ch),z),G=Q.charCodeAt(W);if(56320<=G&&G<=57343){var X=1;v&&v.line==D&&v.ch>W&&(X=-1),W+=X,W>z&&(W-=2)}return new e(D,W)}function is(p){var f={};for(var v in p)Object.prototype.hasOwnProperty.call(p,v)&&(f[v]=p[v]);return f}function It(p,f,v){return typeof f=="object"&&(v=f.ch,f=f.line),new e(p.line+f,p.ch+v)}function Dn(p,f,v,C){C.operator&&(v="operatorPending");for(var E,D=[],Q=[],z=yt?f.length-a:0,W=z;W<f.length;W++){var G=f[W];v=="insert"&&G.context!="insert"||G.context&&G.context!=v||C.operator&&G.type=="action"||!(E=Cs(p,G.keys))||(E=="partial"&&D.push(G),E=="full"&&Q.push(G))}return{partial:D,full:Q}}function Cs(p,f){const v=f.slice(-11)=="<character>",C=f.slice(-10)=="<register>";if(v||C){var E=f.length-(v?11:10),D=p.slice(0,E),Q=f.slice(0,E);return D==Q&&p.length>E?"full":Q.indexOf(D)==0?"partial":!1}else return p==f?"full":f.indexOf(p)==0?"partial":!1}function Wt(p){var f=/^.*(<[^>]+>)$/.exec(p),v=f?f[1]:p.slice(-1);if(v.length>1)switch(v){case"<CR>":case"<S-CR>":v=`
`;break;case"<Space>":case"<S-Space>":v=" ";break;default:v="";break}return v}function Pt(p,f,v){return function(){for(var C=0;C<v;C++)f(p)}}function $t(p){return new e(p.line,p.ch)}function xn(p,f){return p.ch==f.ch&&p.line==f.line}function st(p,f){return p.line<f.line||p.line==f.line&&p.ch<f.ch}function Gt(p,f){return arguments.length>2&&(f=Gt.apply(void 0,Array.prototype.slice.call(arguments,1))),st(p,f)?p:f}function an(p,f){return arguments.length>2&&(f=an.apply(void 0,Array.prototype.slice.call(arguments,1))),st(p,f)?f:p}function vs(p,f,v){var C=st(p,f),E=st(f,v);return C&&E}function Vn(p,f){return p.getLine(f).length}function Hs(p){return p.trim?p.trim():p.replace(/^\s+|\s+$/g,"")}function Ys(p){return p.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function w(p,f,v){var C=Vn(p,f),E=new Array(v-C+1).join(" ");p.setCursor(new e(f,C)),p.replaceRange(E,p.getCursor())}function _(p,f){var v=[],C=p.listSelections(),E=$t(p.clipPos(f)),D=!xn(f,E),Q=p.getCursor("head"),z=R(C,Q),W=xn(C[z].head,C[z].anchor),G=C.length-1,X=G-z>z?G:0,re=C[X].anchor,de=Math.min(re.line,E.line),pe=Math.max(re.line,E.line),ye=re.ch,Ce=E.ch,Be=C[X].head.ch-ye,je=Ce-ye;Be>0&&je<=0?(ye++,D||Ce--):Be<0&&je>=0?(ye--,W||Ce++):Be<0&&je==-1&&(ye--,Ce++);for(var Ie=de;Ie<=pe;Ie++){var nt={anchor:new e(Ie,ye),head:new e(Ie,Ce)};v.push(nt)}return p.setSelections(v),f.ch=Ce,re.ch=ye,re}function B(p,f,v){for(var C=[],E=0;E<v;E++){var D=It(f,E,0);C.push({anchor:D,head:D})}p.setSelections(C,0)}function R(p,f,v){for(var C=0;C<p.length;C++){var E=xn(p[C].anchor,f),D=xn(p[C].head,f);if(E||D)return C}return-1}function Z(p,f){var v=p.listSelections(),C=v[0],E=v[v.length-1],D=st(C.anchor,C.head)?C.anchor:C.head,Q=st(E.anchor,E.head)?E.head:E.anchor;return[D,Q]}function Y(p,f){var v=f.sel.anchor,C=f.sel.head;f.lastPastedText&&(C=p.posFromIndex(p.indexFromPos(v)+f.lastPastedText.length),f.lastPastedText=void 0),f.lastSelection={anchorMark:p.setBookmark(v),headMark:p.setBookmark(C),anchor:$t(v),head:$t(C),visualMode:f.visualMode,visualLine:f.visualLine,visualBlock:f.visualBlock}}function se(p,f,v,C){var E=p.state.vim.sel,D=C?f:E.head,Q=C?f:E.anchor,z;return st(v,f)&&(z=v,v=f,f=z),st(D,Q)?(D=Gt(f,D),Q=an(Q,v)):(Q=Gt(f,Q),D=an(D,v),D=It(D,0,-1),D.ch==-1&&D.line!=p.firstLine()&&(D=new e(D.line-1,Vn(p,D.line-1)))),[Q,D]}function te(p,f,v){var C=p.state.vim;f=f||C.sel,v||(v=C.visualLine?"line":C.visualBlock?"block":"char");var E=be(p,f,v);p.setSelections(E.ranges,E.primary)}function be(p,f,v,C){var E=$t(f.head),D=$t(f.anchor);if(v=="char"){var Q=!C&&!st(f.head,f.anchor)?1:0,z=st(f.head,f.anchor)?1:0;return E=It(f.head,0,Q),D=It(f.anchor,0,z),{ranges:[{anchor:D,head:E}],primary:0}}else if(v=="line"){if(st(f.head,f.anchor))E.ch=0,D.ch=Vn(p,D.line);else{D.ch=0;var W=p.lastLine();E.line>W&&(E.line=W),E.ch=Vn(p,E.line)}return{ranges:[{anchor:D,head:E}],primary:0}}else if(v=="block"){var G=Math.min(D.line,E.line),X=D.ch,re=Math.max(D.line,E.line),de=E.ch;X<de?de+=1:X+=1;for(var pe=re-G+1,ye=E.line==G?0:pe-1,Ce=[],Be=0;Be<pe;Be++)Ce.push({anchor:new e(G+Be,X),head:new e(G+Be,de)});return{ranges:Ce,primary:ye}}throw"never happens"}function $e(p){var f=p.getCursor("head");return p.getSelection().length==1&&(f=Gt(f,p.getCursor("anchor"))),f}function Re(p,f){var v=p.state.vim;f!==!1&&p.setCursor(et(p,v.sel.head)),Y(p,v),v.visualMode=!1,v.visualLine=!1,v.visualBlock=!1,v.insertMode||n.signal(p,"vim-mode-change",{mode:"normal"})}function ut(p,f,v){var C=p.getRange(f,v);if(/\n\s*$/.test(C)){var E=C.split(`
`);E.pop();for(var D=E.pop();E.length>0&&D&&I(D);D=E.pop())v.line--,v.ch=0;D?(v.line--,v.ch=Vn(p,v.line)):v.ch=0}}function on(p,f,v){f.ch=0,v.ch=0,v.line++}function Yn(p){if(!p)return 0;var f=p.search(/\S/);return f==-1?p.length:f}function Is(p,{inclusive:f,innerWord:v,bigWord:C,noSymbol:E,multiline:D},Q){var z=Q||$e(p),W=p.getLine(z.line),G=W,X=z.line,re=X,de=z.ch,pe,ye=E?d[0]:m[0];if(v&&/\s/.test(W.charAt(de)))ye=function(Nt){return/\s/.test(Nt)};else{for(;!ye(W.charAt(de));)if(de++,de>=W.length){if(!D)return null;de--,pe=Gr(p,z,!0,C,!0);break}C?ye=m[0]:(ye=d[0],ye(W.charAt(de))||(ye=d[1]))}for(var Ce=de,Be=de;ye(W.charAt(Be))&&Be>=0;)Be--;if(Be++,pe)Ce=pe.to,re=pe.line,G=p.getLine(re),!G&&Ce==0&&Ce++;else for(;ye(W.charAt(Ce))&&Ce<W.length;)Ce++;if(f){var je=Ce,Ie=z.ch<=Be&&/\s/.test(W.charAt(z.ch));if(!Ie)for(;/\s/.test(G.charAt(Ce))&&Ce<G.length;)Ce++;if(je==Ce||Ie){for(var nt=Be;/\s/.test(W.charAt(Be-1))&&Be>0;)Be--;!Be&&!Ie&&(Be=nt)}}return{start:new e(X,Be),end:new e(re,Ce)}}function mn(p,f,v){var C=f;if(!n.findMatchingTag||!n.findEnclosingTag)return{start:C,end:C};var E=n.findMatchingTag(p,f)||n.findEnclosingTag(p,f);return!E||!E.open||!E.close?{start:C,end:C}:v?{start:E.open.from,end:E.close.to}:{start:E.open.to,end:E.close.from}}function Jt(p,f,v){xn(f,v)||ae.jumpList.add(p,f,v)}function sn(p,f){ae.lastCharacterSearch.increment=p,ae.lastCharacterSearch.forward=f.forward,ae.lastCharacterSearch.selectedCharacter=f.selectedCharacter}var ps={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},cr={bracket:{isComplete:function(p){if(p.nextCh===p.symb){if(p.depth++,p.depth>=1)return!0}else p.nextCh===p.reverseSymb&&p.depth--;return!1}},section:{init:function(p){p.curMoveThrough=!0,p.symb=(p.forward?"]":"[")===p.symb?"{":"}"},isComplete:function(p){return p.index===0&&p.nextCh===p.symb}},comment:{isComplete:function(p){var f=p.lastCh==="*"&&p.nextCh==="/";return p.lastCh=p.nextCh,f}},method:{init:function(p){p.symb=p.symb==="m"?"{":"}",p.reverseSymb=p.symb==="{"?"}":"{"},isComplete:function(p){return p.nextCh===p.symb}},preprocess:{init:function(p){p.index=0},isComplete:function(p){var v;if(p.nextCh==="#"){var f=(v=p.lineText.match(/^#(\w+)/))==null?void 0:v[1];if(f==="endif"){if(p.forward&&p.depth===0)return!0;p.depth++}else if(f==="if"){if(!p.forward&&p.depth===0)return!0;p.depth--}if(f==="else"&&p.depth===0)return!0}return!1}}};function $i(p,f,v,C){var E=$t(p.getCursor()),D=v?1:-1,Q=v?p.lineCount():-1,z=E.ch,W=E.line,G=p.getLine(W),X={lineText:G,nextCh:G.charAt(z),lastCh:null,index:z,symb:C,reverseSymb:(v?{")":"(","}":"{"}:{"(":")","{":"}"})[C],forward:v,depth:0,curMoveThrough:!1},re=ps[C];if(!re)return E;var de=cr[re].init,pe=cr[re].isComplete;for(de&&de(X);W!==Q&&f;){if(X.index+=D,X.nextCh=X.lineText.charAt(X.index),!X.nextCh){if(W+=D,X.lineText=p.getLine(W)||"",D>0)X.index=0;else{var ye=X.lineText.length;X.index=ye>0?ye-1:0}X.nextCh=X.lineText.charAt(X.index)}pe(X)&&(E.line=W,E.ch=X.index,f--)}return X.nextCh||X.curMoveThrough?new e(W,X.index):E}function Gr(p,f,v,C,E){var D=f.line,Q=f.ch,z=p.getLine(D),W=v?1:-1,G=C?m:d;if(E&&z==""){if(D+=W,z=p.getLine(D),!F(p,D))return null;Q=v?0:z.length}for(;;){if(E&&z=="")return{from:0,to:0,line:D};for(var X=W>0?z.length:-1,re=X,de=X;Q!=X;){for(var pe=!1,ye=0;ye<G.length&&!pe;++ye)if(G[ye](z.charAt(Q))){for(re=Q;Q!=X&&G[ye](z.charAt(Q));)Q+=W;if(de=Q,pe=re!=de,re==f.ch&&D==f.line&&de==re+W)continue;return{from:Math.min(re,de+1),to:Math.max(re,de),line:D}}pe||(Q+=W)}if(D+=W,!F(p,D))return null;z=p.getLine(D),Q=W>0?0:z.length}}function hi(p,f,v,C,E,D){var Q=$t(f),z=[];(C&&!E||!C&&E)&&v++;for(var W=!(C&&E),G=0;G<v;G++){var X=Gr(p,f,C,D,W);if(!X){var re=Vn(p,p.lastLine());z.push(C?{line:p.lastLine(),from:re,to:re}:{line:0,from:0,to:0});break}z.push(X),f=new e(X.line,C?X.to-1:X.from)}var de=z.length!=v,pe=z[0],ye=z.pop();return C&&!E?(!de&&(pe.from!=Q.ch||pe.line!=Q.line)&&(ye=z.pop()),ye&&new e(ye.line,ye.from)):C&&E?ye&&new e(ye.line,ye.to-1):!C&&E?(!de&&(pe.to!=Q.ch||pe.line!=Q.line)&&(ye=z.pop()),ye&&new e(ye.line,ye.to)):ye&&new e(ye.line,ye.from)}function di(p,f,v,C,E){var D=f,Q=new e(D.line+v.repeat-1,1/0),z=p.clipPos(Q);return z.ch--,E||(C.lastHPos=1/0,C.lastHSPos=p.charCoords(z,"div").left),Q}function Ls(p,f,v,C,E){if(C){for(var D=E||p.getCursor(),Q=D.ch,z,W=0;W<f;W++){var G=p.getLine(D.line);if(z=nl(Q,G,C,v),z==-1)return;Q=z}if(z!=null)return new e(p.getCursor().line,z)}}function ql(p,f){var v=p.getCursor().line;return et(p,new e(v,f-1))}function Dr(p,f,v,C){!ce(v,y)&&!S.test(v)||(f.marks[v]&&f.marks[v].clear(),f.marks[v]=p.setBookmark(C))}function nl(p,f,v,C,E){var D;return C?D=f.indexOf(v,p+1):D=f.lastIndexOf(v,p-1),D}function Ni(p,f,v,C,E){var D=f.line,Q=p.firstLine(),z=p.lastLine(),W,G,X=D;function re(Be){return!p.getLine(Be)}function de(Be,je,Ie){return Ie?re(Be)!=re(Be+je):!re(Be)&&re(Be+je)}if(C){for(;Q<=X&&X<=z&&v>0;)de(X,C)&&v--,X+=C;return{start:new e(X,0),end:f}}var pe=p.state.vim;if(pe.visualLine&&de(D,1,!0)){var ye=pe.sel.anchor;de(ye.line,-1,!0)&&(!E||ye.line!=D)&&(D+=1)}var Ce=re(D);for(X=D;X<=z&&v;X++)de(X,1,!0)&&(!E||re(X)!=Ce)&&v--;for(G=new e(X,0),X>z&&!Ce?Ce=!0:E=!1,X=D;X>Q&&!((!E||re(X)==Ce||X==D)&&de(X,-1,!0));X--);return W=new e(X,0),{start:W,end:G}}function Xr(p,f,v,C,E){function D(G){G.line!==null&&(G.pos+G.dir<0||G.pos+G.dir>=G.line.length?G.line=null:G.pos+=G.dir)}function Q(G,X,re,de){var pe=G.getLine(X),ye={line:pe,ln:X,pos:re,dir:de};if(ye.line==="")return{ln:ye.ln,pos:ye.pos};var Ce=ye.pos;for(D(ye);ye.line!==null;){if(Ce=ye.pos,q(ye.line[ye.pos]))if(E){for(D(ye);ye.line!==null&&I(ye.line[ye.pos]);)Ce=ye.pos,D(ye);return{ln:ye.ln,pos:Ce+1}}else return{ln:ye.ln,pos:ye.pos+1};D(ye)}return{ln:ye.ln,pos:Ce+1}}function z(G,X,re,de){var pe=G.getLine(X),ye={line:pe,ln:X,pos:re,dir:de};if(ye.line==="")return{ln:ye.ln,pos:ye.pos};var Ce=ye.pos;for(D(ye);ye.line!==null;){if(!I(ye.line[ye.pos])&&!q(ye.line[ye.pos]))Ce=ye.pos;else if(q(ye.line[ye.pos]))return E?I(ye.line[ye.pos+1])?{ln:ye.ln,pos:ye.pos+1}:{ln:ye.ln,pos:Ce}:{ln:ye.ln,pos:Ce};D(ye)}return ye.line=pe,E&&I(ye.line[ye.pos])?{ln:ye.ln,pos:ye.pos}:{ln:ye.ln,pos:Ce}}for(var W={ln:f.line,pos:f.ch};v>0;)C<0?W=z(p,W.ln,W.pos,C):W=Q(p,W.ln,W.pos,C),v--;return new e(W.ln,W.pos)}function Ul(p,f,v,C){function E(W,G){if(G.line!==null)if(G.pos+G.dir<0||G.pos+G.dir>=G.line.length){if(G.ln+=G.dir,!F(W,G.ln)){G.line=null;return}G.line=W.getLine(G.ln),G.pos=G.dir>0?0:G.line.length-1}else G.pos+=G.dir}function D(W,G,X,re){var Be=W.getLine(G),de=Be==="",pe={line:Be,ln:G,pos:X,dir:re},ye={ln:pe.ln,pos:pe.pos},Ce=pe.line==="";for(E(W,pe);pe.line!==null;){if(ye.ln=pe.ln,ye.pos=pe.pos,pe.line===""&&!Ce)return{ln:pe.ln,pos:pe.pos};if(de&&pe.line!==""&&!I(pe.line[pe.pos]))return{ln:pe.ln,pos:pe.pos};q(pe.line[pe.pos])&&!de&&(pe.pos===pe.line.length-1||I(pe.line[pe.pos+1]))&&(de=!0),E(W,pe)}var Be=W.getLine(ye.ln);ye.pos=0;for(var je=Be.length-1;je>=0;--je)if(!I(Be[je])){ye.pos=je;break}return ye}function Q(W,G,X,re){var Be=W.getLine(G),de={line:Be,ln:G,pos:X,dir:re},pe=de.ln,ye=null,Ce=de.line==="";for(E(W,de);de.line!==null;){if(de.line===""&&!Ce)return ye!==null?{ln:pe,pos:ye}:{ln:de.ln,pos:de.pos};if(q(de.line[de.pos])&&ye!==null&&!(de.ln===pe&&de.pos+1===ye))return{ln:pe,pos:ye};de.line!==""&&!I(de.line[de.pos])&&(Ce=!1,pe=de.ln,ye=de.pos),E(W,de)}var Be=W.getLine(pe);ye=0;for(var je=0;je<Be.length;++je)if(!I(Be[je])){ye=je;break}return{ln:pe,pos:ye}}for(var z={ln:f.line,pos:f.ch};v>0;)C<0?z=Q(p,z.ln,z.pos,C):z=D(p,z.ln,z.pos,C),v--;return new e(z.ln,z.pos)}function _i(p,f,v,C){var E=f,D={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[v],Q={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"}[v],z=p.getLine(E.line).charAt(E.ch),W=z===Q?1:0,G=p.scanForBracket(new e(E.line,E.ch+W),-1,void 0,{bracketRegex:D}),X=p.scanForBracket(new e(E.line,E.ch+W),1,void 0,{bracketRegex:D});if(!G||!X)return null;var re=G.pos,de=X.pos;if(re.line==de.line&&re.ch>de.ch||re.line>de.line){var pe=re;re=de,de=pe}return C?de.ch+=1:re.ch+=1,{start:re,end:de}}function Ks(p,f,v,C){var E=$t(f),D=p.getLine(E.line),Q=D.split(""),z,W,G,X,re=Q.indexOf(v);if(E.ch<re)E.ch=re;else if(re<E.ch&&Q[E.ch]==v){var de=/string/.test(p.getTokenTypeAt(It(f,0,1))),pe=/string/.test(p.getTokenTypeAt(f)),ye=de&&!pe;ye||(W=E.ch,--E.ch)}if(Q[E.ch]==v&&!W)z=E.ch+1;else for(G=E.ch;G>-1&&!z;G--)Q[G]==v&&(z=G+1);if(z&&!W)for(G=z,X=Q.length;G<X&&!W;G++)Q[G]==v&&(W=G);return!z||!W?{start:E,end:E}:(C&&(--z,++W),{start:new e(E.line,z),end:new e(E.line,W)})}he("pcre",!0,"boolean");class Da{constructor(){this.highlightTimeout}getQuery(){return ae.query}setQuery(f){ae.query=f}getOverlay(){return this.searchOverlay}setOverlay(f){this.searchOverlay=f}isReversed(){return ae.isReversed}setReversed(f){ae.isReversed=f}getScrollbarAnnotate(){return this.annotate}setScrollbarAnnotate(f){this.annotate=f}}function Fs(p){var f=p.state.vim;return f.searchState_||(f.searchState_=new Da)}function Js(p){return Ta(p,"/")}function da(p){return Hr(p,"/")}function Ta(p,f){var v=Hr(p,f)||[];if(!v.length)return[];var C=[];if(v[0]===0){for(var E=0;E<v.length;E++)typeof v[E]=="number"&&C.push(p.substring(v[E]+1,v[E+1]));return C}}function Hr(p,f){f||(f="/");for(var v=!1,C=[],E=0;E<p.length;E++){var D=p.charAt(E);!v&&D==f&&C.push(E),v=!v&&D=="\\"}return C}function Ba(p){var f={V:"|(){+?*.[$^",M:"|(){+?*.[",m:"|(){+?",v:"<>"},v={">":"(?<=[\\w])(?=[^\\w]|$)","<":"(?<=[^\\w]|^)(?=[\\w])"},C=f.m,E=p.replace(/\\.|[\[|(){+*?.$^<>]/g,function(Q){if(Q[0]==="\\"){var z=Q[1];return z==="}"||C.indexOf(z)!=-1?z:z in f?(C=f[z],""):z in v?v[z]:Q}else return C.indexOf(Q)!=-1?v[Q]||"\\"+Q:Q}),D=E.indexOf("\\zs");return D!=-1&&(E="(?<="+E.slice(0,D)+")"+E.slice(D+3)),D=E.indexOf("\\ze"),D!=-1&&(E=E.slice(0,D)+"(?="+E.slice(D+3)+")"),E}var Yr={"\\n":`
`,"\\r":"\r","\\t":"	"};function Wl(p){for(var f=!1,v=[],C=-1;C<p.length;C++){var E=p.charAt(C)||"",D=p.charAt(C+1)||"";Yr[E+D]?(v.push(Yr[E+D]),C++):f?(v.push(E),f=!1):E==="\\"?(f=!0,$(D)||D==="$"?v.push("$"):D!=="/"&&D!=="\\"&&v.push("\\")):(E==="$"&&v.push("$"),v.push(E),D==="/"&&v.push("\\"))}return v.join("")}var Ir={"\\/":"/","\\\\":"\\","\\n":`
`,"\\r":"\r","\\t":"	","\\&":"&"};function Or(p){for(var f=new n.StringStream(p),v=[];!f.eol();){for(;f.peek()&&f.peek()!="\\";)v.push(f.next());var C=!1;for(var E in Ir)if(f.match(E,!0)){C=!0,v.push(Ir[E]);break}C||v.push(f.next())}return v.join("")}function Tn(p,f,v){var C=ae.registerController.getRegister("/");C.setText(p);var E=da(p),D,Q;if(!E.length)D=p;else{D=p.substring(0,E[0]);var z=p.substring(E[0]);Q=z.indexOf("i")!=-1}if(!D)return null;me("pcre")||(D=Ba(D)),v&&(f=/^[^A-Z]*$/.test(D));var W=new RegExp(D,f||Q?"im":"m");return W}function wr(p){typeof p=="string"&&(p=document.createElement(p));for(var f=1;f<arguments.length;f++){var v=arguments[f];if(v)if(typeof v!="object"&&(v=document.createTextNode(v)),v.nodeType)p.appendChild(v);else for(var C in v)Object.prototype.hasOwnProperty.call(v,C)&&(C[0]==="$"?p.style[C.slice(1)]=v[C]:typeof v[C]=="function"?p[C]=v[C]:p.setAttribute(C,v[C]))}return p}function fn(p,f,v){var C=wr("div",{$color:"red",$whiteSpace:"pre",class:"cm-vim-message"},f);p.openNotification?v?(C=wr("div",{},C,wr("div",{},"Press ENTER or type command to continue")),p.state.closeVimNotification&&p.state.closeVimNotification(),p.state.closeVimNotification=p.openNotification(C,{bottom:!0,duration:0})):p.openNotification(C,{bottom:!0,duration:15e3}):alert(C.innerText)}function Oo(p,f){return wr("div",{$display:"flex",$flex:1},wr("span",{$fontFamily:"monospace",$whiteSpace:"pre",$flex:1,$display:"flex"},p,wr("input",{type:"text",autocorrect:"off",autocapitalize:"off",spellcheck:"false",$flex:1})),f&&wr("span",{$color:"#888"},f))}function Kr(p,f){var E;if(Ye.length){f.value||(f.value=""),Xe=f;return}var v=Oo(f.prefix,f.desc);if(p.openDialog)p.openDialog(v,f.onClose,{onKeyDown:f.onKeyDown,onKeyUp:f.onKeyUp,bottom:!0,selectValueOnOpen:!1,value:f.value});else{var C="";typeof f.prefix!="string"&&f.prefix&&(C+=f.prefix.textContent),f.desc&&(C+=" "+f.desc),(E=f.onClose)==null||E.call(f,prompt(C,""))}}function Gl(p,f){return p instanceof RegExp&&f instanceof RegExp?p.flags==f.flags&&p.source==f.source:!1}function Tr(p,f,v,C){if(f){var E=Fs(p),D=Tn(f,!!v,!!C);if(D)return K(p,D),Gl(D,E.getQuery())||E.setQuery(D),D}}function wo(p){if(p.source.charAt(0)=="^")var f=!0;return{token:function(v){if(f&&!v.sol()){v.skipToEnd();return}var C=v.match(p,!1);if(C)return C[0].length==0?(v.next(),"searching"):!v.sol()&&(v.backUp(1),!p.exec(v.next()+C[0]))?(v.next(),null):(v.match(p),"searching");for(;!v.eol()&&(v.next(),!v.match(p,!1)););},query:p}}var pa=0;function K(p,f){clearTimeout(pa);var v=Fs(p);v.highlightTimeout=pa,pa=setTimeout(function(){if(p.state.vim){var C=Fs(p);C.highlightTimeout=void 0;var E=C.getOverlay();(!E||f!=E.query)&&(E&&p.removeOverlay(E),E=wo(f),p.addOverlay(E),p.showMatchesOnScrollbar&&(C.getScrollbarAnnotate()&&C.getScrollbarAnnotate().clear(),C.setScrollbarAnnotate(p.showMatchesOnScrollbar(f))),C.setOverlay(E))}},50)}function J(p,f,v,C){return p.operation(function(){C===void 0&&(C=1);for(var E=p.getCursor(),D=p.getSearchCursor(v,E),Q=0;Q<C;Q++){var z=D.find(f);if(Q==0&&z&&xn(D.from(),E)){var W=f?D.from():D.to();z=D.find(f),z&&!z[0]&&xn(D.from(),W)&&p.getLine(W.line).length==W.ch&&(z=D.find(f))}if(!z&&(D=p.getSearchCursor(v,f?new e(p.lastLine()):new e(p.firstLine(),0)),!D.find(f)))return}return D.from()})}function ne(p,f,v,C,E){return p.operation(function(){C===void 0&&(C=1);var D=p.getCursor(),Q=p.getSearchCursor(v,D),z=Q.find(!f);!E.visualMode&&z&&xn(Q.from(),D)&&Q.find(!f);for(var W=0;W<C;W++)if(z=Q.find(f),!z&&(Q=p.getSearchCursor(v,f?new e(p.lastLine()):new e(p.firstLine(),0)),!Q.find(f)))return;var G=Q.from(),X=Q.to();return G&&X&&[G,X]})}function M(p){var f=Fs(p);f.highlightTimeout&&(clearTimeout(f.highlightTimeout),f.highlightTimeout=void 0),p.removeOverlay(Fs(p).getOverlay()),f.setOverlay(null),f.getScrollbarAnnotate()&&(f.getScrollbarAnnotate().clear(),f.setScrollbarAnnotate(null))}function ue(p,f,v){return typeof p!="number"&&(p=p.line),f instanceof Array?ce(p,f):typeof v=="number"?p>=f&&p<=v:p==f}function we(p){var f=p.getScrollInfo(),v=6,C=10,E=p.coordsChar({left:0,top:v+f.top},"local"),D=f.clientHeight-C+f.top,Q=p.coordsChar({left:0,top:D},"local");return{top:E.line,bottom:Q.line}}function xe(p,f,v){if(v=="'"||v=="`")return ae.jumpList.find(p,-1)||new e(0,0);if(v==".")return Ae(p);var C=f.marks[v];return C&&C.find()}function Ae(p){if(p.getLastEditEnd)return p.getLastEditEnd();for(var f=p.doc.history.done,v=f.length;v--;)if(f[v].changes)return $t(f[v].changes[0].to)}class fe{constructor(){this.commandMap_,this.buildCommandMap_()}processCommand(f,v,C){var E=this;f.operation(function(){f.curOp&&(f.curOp.isVimOp=!0),E._processCommand(f,v,C)})}_processCommand(f,v,C){var E=f.state.vim,D=ae.registerController.getRegister(":"),Q=D.toString(),z=new n.StringStream(v);D.setText(v);var W=C||{};W.input=v;try{this.parseInput_(f,z,W)}catch(re){throw fn(f,re+""),re}E.visualMode&&Re(f);var G,X;if(!W.commandName)W.line!==void 0&&(X="move");else if(G=this.matchCommand_(W.commandName),G){if(X=G.name,G.excludeFromCommandHistory&&D.setText(Q),this.parseCommandArgs_(z,W,G),G.type=="exToKey"){Ct(f,G.toKeys||"",G);return}else if(G.type=="exToEx"){this.processCommand(f,G.toInput||"");return}}if(!X){fn(f,'Not an editor command ":'+v+'"');return}try{Fe[X](f,W),(!G||!G.possiblyAsync)&&W.callback&&W.callback()}catch(re){throw fn(f,re+""),re}}parseInput_(f,v,C){var D,Q;v.eatWhile(":"),v.eat("%")?(C.line=f.firstLine(),C.lineEnd=f.lastLine()):(C.line=this.parseLineSpec_(f,v),C.line!==void 0&&v.eat(",")&&(C.lineEnd=this.parseLineSpec_(f,v))),C.line==null?f.state.vim.visualMode?(C.selectionLine=(D=xe(f,f.state.vim,"<"))==null?void 0:D.line,C.selectionLineEnd=(Q=xe(f,f.state.vim,">"))==null?void 0:Q.line):C.selectionLine=f.getCursor().line:(C.selectionLine=C.line,C.selectionLineEnd=C.lineEnd);var E=v.match(/^(\w+|!!|@@|[!#&*<=>@~])/);return E?C.commandName=E[1]:C.commandName=(v.match(/.*/)||[""])[0],C}parseLineSpec_(f,v){var C=v.match(/^(\d+)/);if(C)return parseInt(C[1],10)-1;switch(v.next()){case".":return this.parseLineSpecOffset_(v,f.getCursor().line);case"$":return this.parseLineSpecOffset_(v,f.lastLine());case"'":var E=v.next()||"",D=xe(f,f.state.vim,E);if(!D)throw new Error("Mark not set");return this.parseLineSpecOffset_(v,D.line);case"-":case"+":return v.backUp(1),this.parseLineSpecOffset_(v,f.getCursor().line);default:v.backUp(1);return}}parseLineSpecOffset_(f,v){var C=f.match(/^([+-])?(\d+)/);if(C){var E=parseInt(C[2],10);C[1]=="-"?v-=E:v+=E}return v}parseCommandArgs_(f,v,C){var Q;if(!f.eol()){v.argString=(Q=f.match(/.*/))==null?void 0:Q[0];var E=C.argDelimiter||/\s+/,D=Hs(v.argString||"").split(E);D.length&&D[0]&&(v.args=D)}}matchCommand_(f){for(var v=f.length;v>0;v--){var C=f.substring(0,v);if(this.commandMap_[C]){var E=this.commandMap_[C];if(E.name.indexOf(f)===0)return E}}}buildCommandMap_(){this.commandMap_={};for(var f=0;f<i.length;f++){var v=i[f],C=v.shortName||v.name;this.commandMap_[C]=v}}map(f,v,C,E){if(f!=":"&&f.charAt(0)==":"){if(C)throw Error("Mode not supported for ex mappings");var D=f.substring(1);v!=":"&&v.charAt(0)==":"?this.commandMap_[D]={name:D,type:"exToEx",toInput:v.substring(1),user:!0}:this.commandMap_[D]={name:D,type:"exToKey",toKeys:v,user:!0}}else{var Q={keys:f,type:"keyToKey",toKeys:v,noremap:!!E};C&&(Q.context=C),ot(Q)}}unmap(f,v){if(f!=":"&&f.charAt(0)==":"){if(v)throw Error("Mode not supported for ex mappings");var C=f.substring(1);if(this.commandMap_[C]&&this.commandMap_[C].user)return delete this.commandMap_[C],!0}else for(var E=f,D=0;D<s.length;D++)if(E==s[D].keys&&s[D].context===v)return s.splice(D,1),tt(E),!0}}var Fe={colorscheme:function(p,f){if(!f.args||f.args.length<1){fn(p,p.getOption("theme"));return}p.setOption("theme",f.args[0])},map:function(p,f,v,C){var E=f.args;if(!E||E.length<2){p&&fn(p,"Invalid mapping: "+f.input);return}Ze.map(E[0],E[1],v,C)},imap:function(p,f){this.map(p,f,"insert")},nmap:function(p,f){this.map(p,f,"normal")},vmap:function(p,f){this.map(p,f,"visual")},omap:function(p,f){this.map(p,f,"operatorPending")},noremap:function(p,f){this.map(p,f,void 0,!0)},inoremap:function(p,f){this.map(p,f,"insert",!0)},nnoremap:function(p,f){this.map(p,f,"normal",!0)},vnoremap:function(p,f){this.map(p,f,"visual",!0)},onoremap:function(p,f){this.map(p,f,"operatorPending",!0)},unmap:function(p,f,v){var C=f.args;(!C||C.length<1||!Ze.unmap(C[0],v))&&p&&fn(p,"No such mapping: "+f.input)},mapclear:function(p,f){ge.mapclear()},imapclear:function(p,f){ge.mapclear("insert")},nmapclear:function(p,f){ge.mapclear("normal")},vmapclear:function(p,f){ge.mapclear("visual")},omapclear:function(p,f){ge.mapclear("operatorPending")},move:function(p,f){pt.processCommand(p,p.state.vim,{keys:"",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:f.line+1})},set:function(p,f){var v=f.args,C=f.setCfg||{};if(!v||v.length<1){p&&fn(p,"Invalid mapping: "+f.input);return}var E=v[0].split("="),D=E.shift()||"",Q=E.length>0?E.join("="):void 0,z=!1,W=!1;if(D.charAt(D.length-1)=="?"){if(Q)throw Error("Trailing characters: "+f.argString);D=D.substring(0,D.length-1),z=!0}else D.charAt(D.length-1)=="!"&&(D=D.substring(0,D.length-1),W=!0);Q===void 0&&D.substring(0,2)=="no"&&(D=D.substring(2),Q=!1);var G=ee[D]&&ee[D].type=="boolean";if(G&&(W?Q=!me(D,p,C):Q==null&&(Q=!0)),!G&&Q===void 0||z){var X=me(D,p,C);X instanceof Error?fn(p,X.message):X===!0||X===!1?fn(p," "+(X?"":"no")+D):fn(p,"  "+D+"="+X)}else{var re=H(D,Q,p,C);re instanceof Error&&fn(p,re.message)}},setlocal:function(p,f){f.setCfg={scope:"local"},this.set(p,f)},setglobal:function(p,f){f.setCfg={scope:"global"},this.set(p,f)},registers:function(p,f){var v=f.args,C=ae.registerController.registers,E=`----------Registers----------

`;if(v)for(var z=v.join(""),W=0;W<z.length;W++){var D=z.charAt(W);if(ae.registerController.isValidRegister(D)){var G=C[D]||new Wn;E+='"'+D+"    "+G.toString()+`
`}}else for(var D in C){var Q=C[D].toString();Q.length&&(E+='"'+D+"    "+Q+`
`)}fn(p,E,!0)},marks:function(p,f){var v=f.args,C=p.state.vim.marks,E=`-----------Marks-----------
mark	line	col

`;if(v)for(var z=v.join(""),W=0;W<z.length;W++){var D=z.charAt(W),Q=C[D]&&C[D].find();Q&&(E+=D+"	"+Q.line+"	"+Q.ch+`
`)}else for(var D in C){var Q=C[D]&&C[D].find();Q&&(E+=D+"	"+Q.line+"	"+Q.ch+`
`)}fn(p,E,!0)},sort:function(p,f){var v,C,E,D,Q;function z(){if(f.argString){var Ht=new n.StringStream(f.argString);if(Ht.eat("!")&&(v=!0),Ht.eol())return;if(!Ht.eatSpace())return"Invalid arguments";var ct=Ht.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!ct||!Ht.eol())return"Invalid arguments";if(ct[1]){C=ct[1].indexOf("i")!=-1,E=ct[1].indexOf("u")!=-1;var dn=ct[1].indexOf("d")!=-1||ct[1].indexOf("n")!=-1,Gn=ct[1].indexOf("x")!=-1,An=ct[1].indexOf("o")!=-1;if(Number(dn)+Number(Gn)+Number(An)>1)return"Invalid arguments";D=dn&&"decimal"||Gn&&"hex"||An&&"octal"}ct[2]&&(Q=new RegExp(ct[2].substr(1,ct[2].length-2),C?"i":""))}}var W=z();if(W){fn(p,W+": "+f.argString);return}var G=f.line||p.firstLine(),X=f.lineEnd||f.line||p.lastLine();if(G==X)return;var re=new e(G,0),de=new e(X,Vn(p,X)),pe=p.getRange(re,de).split(`
`),ye=D=="decimal"?/(-?)([\d]+)/:D=="hex"?/(-?)(?:0x)?([0-9a-f]+)/i:D=="octal"?/([0-7]+)/:null,Ce=D=="decimal"?10:D=="hex"?16:D=="octal"?8:void 0,Be=[],je=[];if(D||Q)for(var Ie=0;Ie<pe.length;Ie++){var nt=Q?pe[Ie].match(Q):null;nt&&nt[0]!=""?Be.push(nt):ye&&ye.exec(pe[Ie])?Be.push(pe[Ie]):je.push(pe[Ie])}else je=pe;function Nt(Ht,ct){if(v){var dn;dn=Ht,Ht=ct,ct=dn}C&&(Ht=Ht.toLowerCase(),ct=ct.toLowerCase());var Gn=ye&&ye.exec(Ht),An=ye&&ye.exec(ct);if(!Gn||!An)return Ht<ct?-1:1;var Rn=parseInt((Gn[1]+Gn[2]).toLowerCase(),Ce),er=parseInt((An[1]+An[2]).toLowerCase(),Ce);return Rn-er}function ht(Ht,ct){if(v){var dn;dn=Ht,Ht=ct,ct=dn}return C&&(Ht[0]=Ht[0].toLowerCase(),ct[0]=ct[0].toLowerCase()),Ht[0]<ct[0]?-1:1}if(Be.sort(Q?ht:Nt),Q)for(var Ie=0;Ie<Be.length;Ie++)Be[Ie]=Be[Ie].input;else D||je.sort(Nt);if(pe=v?Be.concat(je):je.concat(Be),E){var Ot=pe,Ut;pe=[];for(var Ie=0;Ie<Ot.length;Ie++)Ot[Ie]!=Ut&&pe.push(Ot[Ie]),Ut=Ot[Ie]}p.replaceRange(pe.join(`
`),re,de)},vglobal:function(p,f){this.global(p,f)},normal:function(p,f){var v=!1,C=f.argString;if(C&&C[0]=="!"&&(C=C.slice(1),v=!0),C=C.trimStart(),!C){fn(p,"Argument is required.");return}var E=f.line;if(typeof E=="number")for(var D=isNaN(f.lineEnd)?E:f.lineEnd,Q=E;Q<=D;Q++)p.setCursor(Q,0),Ct(p,f.argString.trimStart(),{noremap:v}),p.state.vim.insertMode&&Ne(p,!0);else Ct(p,f.argString.trimStart(),{noremap:v}),p.state.vim.insertMode&&Ne(p,!0)},global:function(p,f){var v=f.argString;if(!v){fn(p,"Regular Expression missing from global");return}var C=f.commandName[0]==="v";v[0]==="!"&&f.commandName[0]==="g"&&(C=!0,v=v.slice(1));var E=f.line!==void 0?f.line:p.firstLine(),D=f.lineEnd||f.line||p.lastLine(),Q=Js(v),z=v,W="";if(Q&&Q.length&&(z=Q[0],W=Q.slice(1,Q.length).join("/")),z)try{Tr(p,z,!0,!0)}catch{fn(p,"Invalid regex: "+z);return}for(var G=Fs(p).getQuery(),X=[],re=E;re<=D;re++){var de=p.getLine(re),pe=G.test(de);pe!==C&&X.push(W?p.getLineHandle(re):de)}if(!W){fn(p,X.join(`
`));return}var ye=0,Ce=function(){if(ye<X.length){var Be=X[ye++],je=p.getLineNumber(Be);if(je==null){Ce();return}var Ie=je+1+W;Ze.processCommand(p,Ie,{callback:Ce})}else p.releaseLineHandles&&p.releaseLineHandles()};Ce()},substitute:function(p,f){if(!p.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var v=f.argString,C=v?Ta(v,v[0]):[],E="",D="",Q,z,W,G=!1,X=!1;if(C&&C.length)E=C[0],me("pcre")&&E!==""&&(E=new RegExp(E).source),D=C[1],D!==void 0&&(me("pcre")?D=Or(D.replace(/([^\\])&/g,"$1$$&")):D=Wl(D),ae.lastSubstituteReplacePart=D),Q=C[2]?C[2].split(" "):[];else if(v&&v.length){fn(p,"Substitutions should be of the form :s/pattern/replace/");return}if(Q&&(z=Q[0],W=parseInt(Q[1]),z&&(z.indexOf("c")!=-1&&(G=!0),z.indexOf("g")!=-1&&(X=!0),me("pcre")?E=E+"/"+z:E=E.replace(/\//g,"\\/")+"/"+z)),E)try{Tr(p,E,!0,!0)}catch{fn(p,"Invalid regex: "+E);return}if(D=D||ae.lastSubstituteReplacePart,D===void 0){fn(p,"No previous substitute regular expression");return}var re=Fs(p),de=re.getQuery(),pe=f.line!==void 0?f.line:p.getCursor().line,ye=f.lineEnd||pe;pe==p.firstLine()&&ye==p.lastLine()&&(ye=1/0),W&&(pe=ye,ye=pe+W-1);var Ce=et(p,new e(pe,0)),Be=p.getSearchCursor(de,Ce);Te(p,G,X,pe,ye,Be,de,D,f.callback)},startinsert:function(p,f){Ct(p,f.argString=="!"?"A":"i",{})},redo:n.commands.redo,undo:n.commands.undo,write:function(p){n.commands.save?n.commands.save(p):p.save&&p.save()},nohlsearch:function(p){M(p)},yank:function(p){var f=$t(p.getCursor()),v=f.line,C=p.getLine(v);ae.registerController.pushText("0","yank",C,!0,!0)},delete:function(p,f){var v=f.selectionLine,C=isNaN(f.selectionLineEnd)?v:f.selectionLineEnd;it.delete(p,{linewise:!0},[{anchor:new e(v,0),head:new e(C+1,0)}])},join:function(p,f){var v=f.selectionLine,C=isNaN(f.selectionLineEnd)?v:f.selectionLineEnd;p.setCursor(new e(v,0)),_e.joinLines(p,{repeat:C-v},p.state.vim)},delmarks:function(p,f){if(!f.argString||!Hs(f.argString)){fn(p,"Argument required");return}for(var v=p.state.vim,C=new n.StringStream(Hs(f.argString));!C.eol();){C.eatSpace();var E=C.pos;if(!C.match(/[a-zA-Z]/,!1)){fn(p,"Invalid argument: "+f.argString.substring(E));return}var D=C.next();if(C.match("-",!0)){if(!C.match(/[a-zA-Z]/,!1)){fn(p,"Invalid argument: "+f.argString.substring(E));return}var Q=D,z=C.next();if(Q&&z&&j(Q)==j(z)){var W=Q.charCodeAt(0),G=z.charCodeAt(0);if(W>=G){fn(p,"Invalid argument: "+f.argString.substring(E));return}for(var X=0;X<=G-W;X++){var re=String.fromCharCode(W+X);delete v.marks[re]}}else{fn(p,"Invalid argument: "+Q+"-");return}}else D&&delete v.marks[D]}}},Ze=new fe;ge.defineEx("version","ve",p=>{fn(p,"Codemirror-vim version: 6.3.0")});function Te(p,f,v,C,E,D,Q,z,W){p.state.vim.exMode=!0;var G=!1,X=0,re,de,pe;function ye(){p.operation(function(){for(;!G;)Ce(),je();Ie()})}function Ce(){var Nt="",ht=D.match||D.pos&&D.pos.match;if(ht)Nt=z.replace(/\$(\d{1,3}|[$&])/g,function(Ht,ct){if(ct=="$")return"$";if(ct=="&")return ht[0];for(var dn=ct;parseInt(dn)>=ht.length&&dn.length>0;)dn=dn.slice(0,dn.length-1);return dn?ht[dn]+ct.slice(dn.length,ct.length):Ht});else{var Ot=p.getRange(D.from(),D.to());Nt=Ot.replace(Q,z)}var Ut=D.to().line;D.replace(Nt),de=D.to().line,E+=de-Ut,pe=de<Ut}function Be(){var Nt=re&&$t(D.to()),ht=D.findNext();return ht&&!ht[0]&&Nt&&xn(D.from(),Nt)&&(ht=D.findNext()),ht&&X++,ht}function je(){for(;Be()&&ue(D.from(),C,E);)if(!(!v&&D.from().line==de&&!pe)){p.scrollIntoView(D.from(),30),p.setSelection(D.from(),D.to()),re=D.from(),G=!1;return}G=!0}function Ie(Nt){if(Nt&&Nt(),p.focus(),re){p.setCursor(re);var ht=p.state.vim;ht.exMode=!1,ht.lastHPos=ht.lastHSPos=re.ch}W?W():G&&fn(p,(X?"Found "+X+" matches":"No matches found")+" for pattern: "+Q+(me("pcre")?" (set nopcre to use Vim regexps)":""))}function nt(Nt,ht,Ot){n.e_stop(Nt);var Ut=qn(Nt);switch(Ut){case"y":Ce(),je();break;case"n":je();break;case"a":var Ht=W;W=void 0,p.operation(ye),W=Ht;break;case"l":Ce();case"q":case"<Esc>":case"<C-c>":case"<C-[>":Ie(Ot);break}return G&&Ie(Ot),!0}if(je(),G){fn(p,"No matches for "+Q+(me("pcre")?" (set nopcre to use vim regexps)":""));return}if(!f){ye(),W&&W();return}Kr(p,{prefix:wr("span","replace with ",wr("strong",z)," (y/n/a/q/l)"),onKeyDown:nt})}function Ne(p,f){var v=p.state.vim,C=ae.macroModeState,E=ae.registerController.getRegister("."),D=C.isPlaying,Q=C.lastInsertModeChanges;D||(p.off("change",Tt),v.insertEnd&&v.insertEnd.clear(),v.insertEnd=void 0,n.off(p.getInputField(),"keydown",wn)),!D&&v.insertModeRepeat&&v.insertModeRepeat>1&&(os(p,v,v.insertModeRepeat-1,!0),v.lastEditInputState.repeatOverride=v.insertModeRepeat),delete v.insertModeRepeat,v.insertMode=!1,f||p.setCursor(p.getCursor().line,p.getCursor().ch-1),p.setOption("keyMap","vim"),p.setOption("disableInput",!0),p.toggleOverwrite(!1),E.setText(Q.changes.join("")),n.signal(p,"vim-mode-change",{mode:"normal"}),C.isRecording&&He(C)}function ot(p){s.unshift(p),p.keys&&at(p.keys)}function at(p){p.split(/(<(?:[CSMA]-)*\w+>|.)/i).forEach(function(f){f&&(r[f]||(r[f]=0),r[f]++)})}function tt(p){p.split(/(<(?:[CSMA]-)*\w+>|.)/i).forEach(function(f){r[f]&&r[f]--})}function Ue(p,f,v,C,E){var D={keys:p,type:f};D[f]=v,D[f+"Args"]=C;for(var Q in E)D[Q]=E[Q];ot(D)}he("insertModeEscKeysTimeout",200,"number");function Je(p,f,v,C){var E=ae.registerController.getRegister(C);if(C==":"){E.keyBuffer[0]&&Ze.processCommand(p,E.keyBuffer[0]),v.isPlaying=!1;return}var D=E.keyBuffer,Q=0;v.isPlaying=!0,v.replaySearchQueries=E.searchQueries.slice(0);for(var z=0;z<D.length;z++)for(var W=D[z],G,X,re=/<(?:[CSMA]-)*\w+>|./gi;G=re.exec(W);)if(X=G[0],ge.handleKey(p,X,"macro"),f.insertMode){var de=E.insertModeChanges[Q++].changes;ae.macroModeState.lastInsertModeChanges.changes=de,x(p,de,1),Ne(p)}v.isPlaying=!1}function Me(p,f){if(!p.isPlaying){var v=p.latestRegister,C=ae.registerController.getRegister(v);C&&C.pushText(f)}}function He(p){if(!p.isPlaying){var f=p.latestRegister,v=ae.registerController.getRegister(f);v&&v.pushInsertModeChanges&&v.pushInsertModeChanges(p.lastInsertModeChanges)}}function zt(p,f){if(!p.isPlaying){var v=p.latestRegister,C=ae.registerController.getRegister(v);C&&C.pushSearchQuery&&C.pushSearchQuery(f)}}function Tt(p,f){var v=ae.macroModeState,C=v.lastInsertModeChanges;if(!v.isPlaying)for(var E=p.state.vim;f;){if(C.expectCursorActivityForChange=!0,C.ignoreCount>1)C.ignoreCount--;else if(f.origin=="+input"||f.origin=="paste"||f.origin===void 0){var D=p.listSelections().length;D>1&&(C.ignoreCount=D);var Q=f.text.join(`
`);if(C.maybeReset&&(C.changes=[],C.maybeReset=!1),Q)if(p.state.overwrite&&!/\n/.test(Q))C.changes.push([Q]);else{if(Q.length>1){var z=E&&E.insertEnd&&E.insertEnd.find(),W=p.getCursor();if(z&&z.line==W.line){var G=z.ch-W.ch;G>0&&G<Q.length&&(C.changes.push([Q,G]),Q="")}}Q&&C.changes.push(Q)}}f=f.next}}function hn(p){var E;var f=p.state.vim;if(f.insertMode){var v=ae.macroModeState;if(v.isPlaying)return;var C=v.lastInsertModeChanges;C.expectCursorActivityForChange?C.expectCursorActivityForChange=!1:(C.maybeReset=!0,f.insertEnd&&f.insertEnd.clear(),f.insertEnd=p.setBookmark(p.getCursor(),{insertLeft:!0}))}else(E=p.curOp)!=null&&E.isVimOp||Bn(p,f)}function Bn(p,f){var v=p.getCursor("anchor"),C=p.getCursor("head");if(f.visualMode&&!p.somethingSelected()?Re(p,!1):!f.visualMode&&!f.insertMode&&p.somethingSelected()&&(f.visualMode=!0,f.visualLine=!1,n.signal(p,"vim-mode-change",{mode:"visual"})),f.visualMode){var E=st(C,v)?0:-1,D=st(C,v)?-1:0;C=It(C,0,E),v=It(v,0,D),f.sel={anchor:v,head:C},Dr(p,f,"<",Gt(C,v)),Dr(p,f,">",an(C,v))}else f.insertMode||(f.lastHPos=p.getCursor().ch)}function wn(p){var f=ae.macroModeState,v=f.lastInsertModeChanges,C=n.keyName?n.keyName(p):p.key;C&&(C.indexOf("Delete")!=-1||C.indexOf("Backspace")!=-1)&&(v.maybeReset&&(v.changes=[],v.maybeReset=!1),v.changes.push(new Qe(C,p)))}function os(p,f,v,C){var E=ae.macroModeState;E.isPlaying=!0;var D=f.lastEditActionCommand,Q=f.inputState;function z(){D?pt.processAction(p,f,D):pt.evalInput(p,f)}function W(X){if(E.lastInsertModeChanges.changes.length>0){X=f.lastEditActionCommand?X:1;var re=E.lastInsertModeChanges;x(p,re.changes,X)}}if(f.inputState=f.lastEditInputState,D&&D.interlaceInsertRepeat)for(var G=0;G<v;G++)z(),W(1);else C||z(),W(v);f.inputState=Q,f.insertMode&&!C&&Ne(p),E.isPlaying=!1}function Ps(p,f){n.lookupKey(f,"vim-insert",function(C){return typeof C=="string"?n.commands[C](p):C(p),!0})}function x(p,f,v){var C=p.getCursor("head"),E=ae.macroModeState.lastInsertModeChanges.visualBlock;E&&(B(p,C,E+1),v=p.listSelections().length,p.setCursor(C));for(var D=0;D<v;D++){E&&p.setCursor(It(C,D,0));for(var Q=0;Q<f.length;Q++){var z=f[Q];if(z instanceof Qe)Ps(p,z.keyName);else if(typeof z=="string")p.replaceSelection(z);else{var W=p.getCursor(),G=It(W,0,z[0].length-(z[1]||0));p.replaceRange(z[0],W,z[1]?W:G),p.setCursor(G)}}}E&&p.setCursor(It(C,0,1))}function P(p){var f=new p.constructor;return Object.keys(p).forEach(function(v){if(v!="insertEnd"){var C=p[v];Array.isArray(C)?C=C.slice():C&&typeof C=="object"&&C.constructor!=Object&&(C=P(C)),f[v]=C}}),p.sel&&(f.sel={head:p.sel.head&&$t(p.sel.head),anchor:p.sel.anchor&&$t(p.sel.anchor)}),f}function T(p,f,v){var D=Se(p),C=p,E=!1,D=ge.maybeInitVimState_(C),Q=D.visualBlock||D.wasInVisualBlock;if(C.state.closeVimNotification){var z=C.state.closeVimNotification;if(C.state.closeVimNotification=null,z(),f=="<CR>")return Kt(C),!0}var W=C.isInMultiSelectMode();if(D.wasInVisualBlock&&!W?D.wasInVisualBlock=!1:W&&D.visualBlock&&(D.wasInVisualBlock=!0),f=="<Esc>"&&!D.insertMode&&!D.visualMode&&W&&D.status=="<Esc>")Kt(C);else if(Q||!W||C.inVirtualSelectionMode)E=ge.handleKey(C,f,v);else{var G=P(D),X=D.inputState.changeQueueList||[];C.operation(function(){var de;C.curOp&&(C.curOp.isVimOp=!0);var re=0;C.forEachSelection(function(){C.state.vim.inputState.changeQueue=X[re];var pe=C.getCursor("head"),ye=C.getCursor("anchor"),Ce=st(pe,ye)?0:-1,Be=st(pe,ye)?-1:0;pe=It(pe,0,Ce),ye=It(ye,0,Be),C.state.vim.sel.head=pe,C.state.vim.sel.anchor=ye,E=ge.handleKey(C,f,v),C.virtualSelection&&(X[re]=C.state.vim.inputState.changeQueue,C.state.vim=P(G)),re++}),(de=C.curOp)!=null&&de.cursorActivity&&!E&&(C.curOp.cursorActivity=!1),C.state.vim=D,D.inputState.changeQueueList=X,D.inputState.changeQueue=null},!0)}return E&&!D.visualMode&&!D.insertMode&&D.visualMode!=C.somethingSelected()&&Bn(C,D),E}return Ee(),ge}function bi(n,e){var t=e.ch,s=e.line+1;s<1&&(s=1,t=0),s>n.lines&&(s=n.lines,t=Number.MAX_VALUE);var r=n.line(s);return Math.min(r.from+Math.max(0,t),r.to)}function Zi(n,e){let t=n.lineAt(e);return{line:t.number-1,ch:e-t.from}}class hl{constructor(e,t){this.line=e,this.ch=t}}function Y8(n,e,t){if(n.addEventListener)n.addEventListener(e,t,!1);else{var s=n._handlers||(n._handlers={});s[e]=(s[e]||[]).concat(t)}}function K8(n,e,t){if(n.removeEventListener)n.removeEventListener(e,t,!1);else{var s=n._handlers,r=s&&s[e];if(r){var a=r.indexOf(t);a>-1&&(s[e]=r.slice(0,a).concat(r.slice(a+1)))}}}function J8(n,e,...t){var s,r=(s=n._handlers)===null||s===void 0?void 0:s[e];if(r)for(var a=0;a<r.length;++a)r[a](...t)}function P5(n,...e){if(n)for(var t=0;t<n.length;++t)n[t](...e)}let l2;try{l2=new RegExp("[\\w\\p{Alphabetic}\\p{Number}_]","u")}catch{l2=/[\w]/}function cm(n,e){var t=n.cm6;if(!t.state.readOnly){var s="input.type.compose";if(n.curOp&&(n.curOp.lastChange||(s="input.type.compose.start")),e.annotations)try{e.annotations.some(function(r){r.value=="input"&&(r.value=s)})}catch(r){console.error(r)}else e.userEvent=s;return t.dispatch(e)}}function A5(n,e){var t;n.curOp&&(n.curOp.$changeStart=void 0),(e?av:Fd)(n.cm6);let s=(t=n.curOp)===null||t===void 0?void 0:t.$changeStart;s!=null&&n.cm6.dispatch({selection:{anchor:s}})}var qle={Left:n=>Lu(n.cm6,{key:"Left"},"editor"),Right:n=>Lu(n.cm6,{key:"Right"},"editor"),Up:n=>Lu(n.cm6,{key:"Up"},"editor"),Down:n=>Lu(n.cm6,{key:"Down"},"editor"),Backspace:n=>Lu(n.cm6,{key:"Backspace"},"editor"),Delete:n=>Lu(n.cm6,{key:"Delete"},"editor")};class En{openDialog(e,t,s){return Wle(this,e,t,s)}openNotification(e,t){return Ule(this,e,t)}constructor(e){this.state={},this.marks=Object.create(null),this.$mid=0,this.options={},this._handlers={},this.$lastChangeEndOffset=0,this.virtualSelection=null,this.cm6=e,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this)}on(e,t){Y8(this,e,t)}off(e,t){K8(this,e,t)}signal(e,t,s){J8(this,e,t,s)}indexFromPos(e){return bi(this.cm6.state.doc,e)}posFromIndex(e){return Zi(this.cm6.state.doc,e)}foldCode(e){let t=this.cm6,s=t.state.selection.ranges,r=this.cm6.state.doc,a=bi(r,e),i=Le.create([Le.range(a,a)],0).ranges;t.state.selection.ranges=i,dP(t),t.state.selection.ranges=s}firstLine(){return 0}lastLine(){return this.cm6.state.doc.lines-1}lineCount(){return this.cm6.state.doc.lines}setCursor(e,t){typeof e=="object"&&(t=e.ch,e=e.line);var s=bi(this.cm6.state.doc,{line:e,ch:t||0});this.cm6.dispatch({selection:{anchor:s}},{scrollIntoView:!this.curOp}),this.curOp&&!this.curOp.isVimOp&&this.onBeforeEndOperation()}getCursor(e){var t=this.cm6.state.selection.main,s=e=="head"||!e?t.head:e=="anchor"?t.anchor:e=="start"?t.from:e=="end"?t.to:null;if(s==null)throw new Error("Invalid cursor type");return this.posFromIndex(s)}listSelections(){var e=this.cm6.state.doc;return this.cm6.state.selection.ranges.map(t=>({anchor:Zi(e,t.anchor),head:Zi(e,t.head)}))}setSelections(e,t){var s=this.cm6.state.doc,r=e.map(a=>{var i=bi(s,a.head),o=bi(s,a.anchor);return i==o?Le.cursor(i,1):Le.range(o,i)});this.cm6.dispatch({selection:Le.create(r,t)})}setSelection(e,t,s){this.setSelections([{anchor:e,head:t}],0),s&&s.origin=="*mouse"&&this.onBeforeEndOperation()}getLine(e){var t=this.cm6.state.doc;return e<0||e>=t.lines?"":this.cm6.state.doc.line(e+1).text}getLineHandle(e){return this.$lineHandleChanges||(this.$lineHandleChanges=[]),{row:e,index:this.indexFromPos(new hl(e,0))}}getLineNumber(e){var t=this.$lineHandleChanges;if(!t)return null;for(var s=e.index,r=0;r<t.length;r++)if(s=t[r].changes.mapPos(s,1,pr.TrackAfter),s==null)return null;var a=this.posFromIndex(s);return a.ch==0?a.line:null}releaseLineHandles(){this.$lineHandleChanges=void 0}getRange(e,t){var s=this.cm6.state.doc;return this.cm6.state.sliceDoc(bi(s,e),bi(s,t))}replaceRange(e,t,s,r){s||(s=t);var a=this.cm6.state.doc,i=bi(a,t),o=bi(a,s);cm(this,{changes:{from:i,to:o,insert:e}})}replaceSelection(e){cm(this,this.cm6.state.replaceSelection(e))}replaceSelections(e){var t=this.cm6.state.selection.ranges,s=t.map((r,a)=>({from:r.from,to:r.to,insert:e[a]||""}));cm(this,{changes:s})}getSelection(){return this.getSelections().join(`
`)}getSelections(){var e=this.cm6;return e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to))}somethingSelected(){return this.cm6.state.selection.ranges.some(e=>!e.empty)}getInputField(){return this.cm6.contentDOM}clipPos(e){var t=this.cm6.state.doc,s=e.ch,r=e.line+1;r<1&&(r=1,s=0),r>t.lines&&(r=t.lines,s=Number.MAX_VALUE);var a=t.line(r);return s=Math.min(Math.max(0,s),a.to-a.from),new hl(r-1,s)}getValue(){return this.cm6.state.doc.toString()}setValue(e){var t=this.cm6;return t.dispatch({changes:{from:0,to:t.state.doc.length,insert:e},selection:Le.range(0,0)})}focus(){return this.cm6.focus()}blur(){return this.cm6.contentDOM.blur()}defaultTextHeight(){return this.cm6.defaultLineHeight}findMatchingBracket(e,t){var s=this.cm6.state,r=bi(s.doc,e),a=eo(s,r+1,-1);return a&&a.end?{to:Zi(s.doc,a.end.from)}:(a=eo(s,r,1),a&&a.end?{to:Zi(s.doc,a.end.from)}:{to:void 0})}scanForBracket(e,t,s,r){return Hle(this,e,t,s,r)}indentLine(e,t){t?this.indentMore():this.indentLess()}indentMore(){rf(this.cm6)}indentLess(){af(this.cm6)}execCommand(e){if(e=="indentAuto")En.commands.indentAuto(this);else if(e=="goLineLeft")ly(this.cm6);else if(e=="goLineRight"){oy(this.cm6);let t=this.cm6.state,s=t.selection.main.head;s<t.doc.length&&t.sliceDoc(s,s+1)!==`
`&&Gie(this.cm6)}else console.log(e+" is not implemented")}setBookmark(e,t){var s=t!=null&&t.insertLeft?1:-1,r=this.indexFromPos(e),a=new Jle(this,r,s);return a}addOverlay({query:e}){let t=new DP({regexp:!0,search:e.source,caseSensitive:!/i/.test(e.flags)});if(t.valid){t.forVim=!0,this.cm6Query=t;let s=mu.of(t);return this.cm6.dispatch({effects:s}),t}}removeOverlay(e){if(!this.cm6Query)return;this.cm6Query.forVim=!1;let t=mu.of(this.cm6Query);this.cm6.dispatch({effects:t})}getSearchCursor(e,t){var s=this,r=null,a=null,i=!1;t.ch==null&&(t.ch=Number.MAX_VALUE);var o=bi(s.cm6.state.doc,t),l=e.source.replace(/(\\.|{(?:\d+(?:,\d*)?|,\d+)})|[{}]/g,function(m,y){return y||"\\"+m});function c(m,y=0,O=m.length){return new MP(m,l,{ignoreCase:e.ignoreCase},y,O)}function u(m){var y=s.cm6.state.doc;if(m>y.length)return null;let O=c(y,m).next();return O.done?null:O.value}var h=1e4;function d(m,y){var O=s.cm6.state.doc;for(let S=1;;S++){let A=Math.max(m,y-S*h),F=c(O,A,y),j=null;for(;!F.next().done;)j=F.value;if(j&&(A==m||j.from>A+10))return j;if(A==m)return null}}return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(m){var y=s.cm6.state.doc;if(m){let O=r?i?r.to-1:r.from:o;r=d(0,O)}else{let O=r?i?r.to+1:r.to:o;r=u(O)}return a=r&&{from:Zi(y,r.from),to:Zi(y,r.to),match:r.match},i=r?r.from==r.to:!1,r&&r.match},from:function(){return a==null?void 0:a.from},to:function(){return a==null?void 0:a.to},replace:function(m){r&&(cm(s,{changes:{from:r.from,to:r.to,insert:m}}),r.to=r.from+m.length,a&&(a.to=Zi(s.cm6.state.doc,r.to)))},get match(){return a&&a.match}}}findPosV(e,t,s,r){let{cm6:a}=this;const i=a.state.doc;let o=s=="page"?a.dom.clientHeight:0;const l=bi(i,e);let c=Le.cursor(l,1,void 0,r),u=Math.round(Math.abs(t));for(let d=0;d<u;d++)s=="page"?c=a.moveVertically(c,t>0,o):s=="line"&&(c=a.moveVertically(c,t>0));let h=Zi(i,c.head);return(t<0&&c.head==0&&r!=0&&e.line==0&&e.ch!=0||t>0&&c.head==i.length&&h.ch!=r&&e.line==h.line)&&(h.hitSide=!0),h}charCoords(e,t){var s=this.cm6.contentDOM.getBoundingClientRect(),r=bi(this.cm6.state.doc,e),a=this.cm6.coordsAtPos(r),i=-s.top;return{left:((a==null?void 0:a.left)||0)-s.left,top:((a==null?void 0:a.top)||0)+i,bottom:((a==null?void 0:a.bottom)||0)+i}}coordsChar(e,t){var s=this.cm6.contentDOM.getBoundingClientRect(),r=this.cm6.posAtCoords({x:e.left+s.left,y:e.top+s.top})||0;return Zi(this.cm6.state.doc,r)}getScrollInfo(){var e=this.cm6.scrollDOM;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight,width:e.scrollWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}scrollTo(e,t){e!=null&&(this.cm6.scrollDOM.scrollLeft=e),t!=null&&(this.cm6.scrollDOM.scrollTop=t)}scrollIntoView(e,t){if(e){var s=this.indexFromPos(e);this.cm6.dispatch({effects:lt.scrollIntoView(s)})}else this.cm6.dispatch({scrollIntoView:!0,userEvent:"scroll"})}getWrapperElement(){return this.cm6.dom}getMode(){return{name:this.getOption("mode")}}setSize(e,t){this.cm6.dom.style.width=e+4+"px",this.cm6.dom.style.height=t+"px",this.refresh()}refresh(){this.cm6.measure()}destroy(){this.removeOverlay()}getLastEditEnd(){return this.posFromIndex(this.$lastChangeEndOffset)}onChange(e){this.$lineHandleChanges&&this.$lineHandleChanges.push(e);for(let s in this.marks)this.marks[s].update(e.changes);this.virtualSelection&&(this.virtualSelection.ranges=this.virtualSelection.ranges.map(s=>s.map(e.changes)));var t=this.curOp=this.curOp||{};e.changes.iterChanges((s,r,a,i,o)=>{(t.$changeStart==null||t.$changeStart>a)&&(t.$changeStart=a),this.$lastChangeEndOffset=i;var l={text:o.toJSON()};t.lastChange?t.lastChange.next=t.lastChange=l:t.lastChange=t.change=l},!0),t.changeHandlers||(t.changeHandlers=this._handlers.change&&this._handlers.change.slice())}onSelectionChange(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._handlers.cursorActivity&&this._handlers.cursorActivity.slice()),this.curOp.cursorActivity=!0}operation(e,t){this.curOp||(this.curOp={$d:0}),this.curOp.$d++;try{var s=e()}finally{this.curOp&&(this.curOp.$d--,this.curOp.$d||this.onBeforeEndOperation())}return s}onBeforeEndOperation(){var e=this.curOp,t=!1;e&&(e.change&&P5(e.changeHandlers,this,e.change),e&&e.cursorActivity&&(P5(e.cursorActivityHandlers,this,null),e.isVimOp&&(t=!0)),this.curOp=null),t&&this.scrollIntoView()}moveH(e,t){if(t=="char"){var s=this.getCursor();this.setCursor(s.line,s.ch+e)}}setOption(e,t){switch(e){case"keyMap":this.state.keyMap=t;break;case"textwidth":this.state.textwidth=t;break}}getOption(e){switch(e){case"firstLineNumber":return 1;case"tabSize":return this.cm6.state.tabSize||4;case"readOnly":return this.cm6.state.readOnly;case"indentWithTabs":return this.cm6.state.facet(Bd)=="	";case"indentUnit":return this.cm6.state.facet(Bd).length||2;case"textwidth":return this.state.textwidth;case"keyMap":return this.state.keyMap||"vim"}}toggleOverwrite(e){this.state.overwrite=e}getTokenTypeAt(e){var t,s=this.indexFromPos(e),r=n$(this.cm6.state,s),a=r==null?void 0:r.resolve(s),i=((t=a==null?void 0:a.type)===null||t===void 0?void 0:t.name)||"";return/comment/i.test(i)?"comment":/string/i.test(i)?"string":""}overWriteSelection(e){var t=this.cm6.state.doc,s=this.cm6.state.selection,r=s.ranges.map(a=>{if(a.empty){var i=a.to<t.length?t.sliceString(a.from,a.to+1):"";if(i&&!/\n/.test(i))return Le.range(a.from,a.to+1)}return a});this.cm6.dispatch({selection:Le.create(r,s.mainIndex)}),this.replaceSelection(e)}isInMultiSelectMode(){return this.cm6.state.selection.ranges.length>1}virtualSelectionMode(){return!!this.virtualSelection}forEachSelection(e){var t=this.cm6.state.selection;this.virtualSelection=Le.create(t.ranges,t.mainIndex);for(var s=0;s<this.virtualSelection.ranges.length;s++){var r=this.virtualSelection.ranges[s];r&&(this.cm6.dispatch({selection:Le.create([r])}),e(),this.virtualSelection.ranges[s]=this.cm6.state.selection.ranges[0])}this.cm6.dispatch({selection:this.virtualSelection}),this.virtualSelection=null}hardWrap(e){return ece(this,e)}}En.isMac=typeof navigator<"u"&&/Mac/.test(navigator.platform);En.Pos=hl;En.StringStream=pae;En.commands={cursorCharLeft:function(n){nf(n.cm6)},redo:function(n){A5(n,!1)},undo:function(n){A5(n,!0)},newlineAndIndent:function(n){sf({state:n.cm6.state,dispatch:e=>cm(n,e)})},indentAuto:function(n){B8(n.cm6)},newlineAndIndentContinueComment:void 0,save:void 0};En.isWordChar=function(n){return l2.test(n)};En.keys=qle;En.addClass=function(n,e){};En.rmClass=function(n,e){};En.e_preventDefault=function(n){n.preventDefault()};En.e_stop=function(n){var e,t;(e=n==null?void 0:n.stopPropagation)===null||e===void 0||e.call(n),(t=n==null?void 0:n.preventDefault)===null||t===void 0||t.call(n)};En.lookupKey=function(e,t,s){var r=En.keys[e];!r&&/^Arrow/.test(e)&&(r=En.keys[e.slice(5)]),r&&s(r)};En.on=Y8;En.off=K8;En.signal=J8;En.findMatchingTag=Yle;En.findEnclosingTag=Kle;En.keyName=void 0;function e6(n,e,t){var s=document.createElement("div");return s.appendChild(e),s}function t6(n,e){n.state.currentNotificationClose&&n.state.currentNotificationClose(),n.state.currentNotificationClose=e}function Ule(n,e,t){t6(n,o);var s=e6(n,e,t&&t.bottom),r=!1,a,i=t&&typeof t.duration<"u"?t.duration:5e3;function o(){r||(r=!0,clearTimeout(a),s.remove(),s6(n,s))}return s.onclick=function(l){l.preventDefault(),o()},n6(n,s),i&&(a=setTimeout(o,i)),o}function n6(n,e){var t=n.state.dialog;n.state.dialog=e,e.style.flex="1",e&&t!==e&&(t&&t.contains(document.activeElement)&&n.focus(),t&&t.parentElement?t.parentElement.replaceChild(e,t):t&&t.remove(),En.signal(n,"dialog"))}function s6(n,e){n.state.dialog==e&&(n.state.dialog=null,En.signal(n,"dialog"))}function Wle(n,e,t,s){s||(s={}),t6(n,void 0);var r=e6(n,e,s.bottom),a=!1;n6(n,r);function i(l){if(typeof l=="string")o.value=l;else{if(a)return;a=!0,s6(n,r),n.state.dialog||n.focus(),s.onClose&&s.onClose(r)}}var o=r.getElementsByTagName("input")[0];return o&&(s.value&&(o.value=s.value,s.selectValueOnOpen!==!1&&o.select()),s.onInput&&En.on(o,"input",function(l){s.onInput(l,o.value,i)}),s.onKeyUp&&En.on(o,"keyup",function(l){s.onKeyUp(l,o.value,i)}),En.on(o,"keydown",function(l){s&&s.onKeyDown&&s.onKeyDown(l,o.value,i)||(l.keyCode==13&&t&&t(o.value),(l.keyCode==27||s.closeOnEnter!==!1&&l.keyCode==13)&&(o.blur(),En.e_stop(l),i()))}),s.closeOnBlur!==!1&&En.on(o,"blur",function(){setTimeout(function(){document.activeElement!==o&&i()})}),o.focus()),i}var Gle={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function Xle(n){return n&&n.bracketRegex||/[(){}[\]]/}function Hle(n,e,t,s,r){for(var a=r&&r.maxScanLineLength||1e4,i=r&&r.maxScanLines||1e3,o=[],l=Xle(r),c=t>0?Math.min(e.line+i,n.lastLine()+1):Math.max(n.firstLine()-1,e.line-i),u=e.line;u!=c;u+=t){var h=n.getLine(u);if(h){var d=t>0?0:h.length-1,m=t>0?h.length:-1;if(!(h.length>a))for(u==e.line&&(d=e.ch-(t<0?1:0));d!=m;d+=t){var y=h.charAt(d);if(l.test(y)){var O=Gle[y];if(O&&O.charAt(1)==">"==t>0)o.push(y);else if(o.length)o.pop();else return{pos:new hl(u,d),ch:y}}}}}return u-t==(t>0?n.lastLine():n.firstLine())?!1:null}function Yle(n,e){return null}function Kle(n,e){var t,s,r=n.cm6.state,a=n.indexFromPos(e);if(a<r.doc.length){var i=r.sliceDoc(a,a+1);i=="<"&&a++}for(var o=n$(r,a),l=(o==null?void 0:o.resolve(a))||null;l;){if(((t=l.firstChild)===null||t===void 0?void 0:t.type.name)=="OpenTag"&&((s=l.lastChild)===null||s===void 0?void 0:s.type.name)=="CloseTag")return{open:E5(r.doc,l.firstChild),close:E5(r.doc,l.lastChild)};l=l.parent}}function E5(n,e){return{from:Zi(n,e.from),to:Zi(n,e.to)}}class Jle{constructor(e,t,s){this.cm=e,this.id=e.$mid++,this.offset=t,this.assoc=s,e.marks[this.id]=this}clear(){delete this.cm.marks[this.id]}find(){return this.offset==null?null:this.cm.posFromIndex(this.offset)}update(e){this.offset!=null&&(this.offset=e.mapPos(this.offset,this.assoc,pr.TrackDel))}}function ece(n,e){for(var t,s=e.column||n.getOption("textwidth")||80,r=e.allowMerge!=!1,a=Math.min(e.from,e.to),i=Math.max(e.from,e.to);a<=i;){var o=n.getLine(a);if(o.length>s){var l=y(o,s,5);if(l){var c=(t=/^\s*/.exec(o))===null||t===void 0?void 0:t[0];n.replaceRange(`
`+c,new hl(a,l.start),new hl(a,l.end))}i++}else if(r&&/\S/.test(o)&&a!=i){var u=n.getLine(a+1);if(u&&/\S/.test(u)){var h=o.replace(/\s+$/,""),d=u.replace(/^\s+/,""),m=h+" "+d,l=y(m,s,5);l&&l.start>h.length||m.length<s?(n.replaceRange(" ",new hl(a,h.length),new hl(a+1,u.length-d.length)),a--,i--):h.length<o.length&&n.replaceRange("",new hl(a,h.length),new hl(a,o.length))}}a++}return a;function y(O,S,A){if(!(O.length<S)){var F=O.slice(0,S),j=O.slice(S),N=/^(?:(\s+)|(\S+)(\s+))/.exec(j),$=/(?:(\s+)|(\s+)(\S+))$/.exec(F),L=0,I=0;if($&&!$[2]&&(L=S-$[1].length,I=S),N&&!N[2]&&(L||(L=S),I=S+N[1].length),L)return{start:L,end:I};if($&&$[2]&&$.index>A)return{start:$.index,end:$.index+$[2].length};if(N&&N[2])return L=S+N[2].length,{start:L,end:L+N[3].length}}}}let c2=FF||(function(){let n={cursorBlinkRate:1200};return function(){return n}})();class tce{constructor(e,t,s,r,a,i,o,l,c,u){this.left=e,this.top=t,this.height=s,this.fontFamily=r,this.fontSize=a,this.fontWeight=i,this.color=o,this.className=l,this.letter=c,this.partial=u}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.height=this.height+"px",e.style.lineHeight=this.height+"px",e.style.fontFamily=this.fontFamily,e.style.fontSize=this.fontSize,e.style.fontWeight=this.fontWeight,e.style.color=this.partial?"transparent":this.color,e.className=this.className,e.textContent=this.letter}eq(e){return this.left==e.left&&this.top==e.top&&this.height==e.height&&this.fontFamily==e.fontFamily&&this.fontSize==e.fontSize&&this.fontWeight==e.fontWeight&&this.color==e.color&&this.className==e.className&&this.letter==e.letter}}class nce{constructor(e,t){this.view=e,this.rangePieces=[],this.cursors=[],this.cm=t,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let t=c2(this.cm.cm6.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=t+"ms"}update(e){(e.selectionSet||e.geometryChanged||e.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),sce(e)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:e}=this.view,t=[];for(let s of e.selection.ranges){let r=s==e.selection.main,a=oce(this.cm,this.view,s,r);a&&t.push(a)}return{cursors:t}}drawSel({cursors:e}){if(e.length!=this.cursors.length||e.some((t,s)=>!t.eq(this.cursors[s]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const s of e)this.cursorLayer.appendChild(s.draw())}else e.forEach((s,r)=>s.adjust(t[r]));this.cursors=e}}destroy(){this.cursorLayer.remove()}}function sce(n){return c2(n.startState)!=c2(n.state)}const rce={".cm-vimMode .cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}},ace=Fi.highest(lt.theme(rce));function ice(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==fs.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function oce(n,e,t,s){var r,a,i,o;let l=t.head,c=!1,u=1,h=n.state.vim;if(h&&(!h.insertMode||n.state.overwrite)){if(c=!0,h.visualBlock&&!s)return null;t.anchor<t.head&&(l<e.state.doc.length&&e.state.sliceDoc(l,l+1))!=`
`&&l--,n.state.overwrite?u=.2:h.status&&(u=.5)}if(c){let m=l<e.state.doc.length&&e.state.sliceDoc(l,l+1);m&&/[\uDC00-\uDFFF]/.test(m)&&l>1&&(l--,m=e.state.sliceDoc(l,l+1));let y=e.coordsAtPos(l,1);if(!y)return null;let O=ice(e),S=e.domAtPos(l),A=S?S.node:e.contentDOM;for(A instanceof Text&&S.offset>=A.data.length&&!((r=A.parentElement)===null||r===void 0)&&r.nextSibling&&(A=(a=A.parentElement)===null||a===void 0?void 0:a.nextSibling,S={node:A,offset:0});S&&S.node instanceof HTMLElement;)A=S.node,S={node:S.node.childNodes[S.offset],offset:0};if(!(A instanceof HTMLElement)){if(!A.parentNode)return null;A=A.parentNode}let F=getComputedStyle(A),j=y.left,N=(o=(i=e).coordsForChar)===null||o===void 0?void 0:o.call(i,l);if(N&&(j=N.left),!m||m==`
`||m=="\r")m=" ";else if(m=="	"){m=" ";var d=e.coordsAtPos(l+1,-1);d&&(j=d.left-(d.left-y.left)/parseInt(F.tabSize))}else/[\uD800-\uDBFF]/.test(m)&&l<e.state.doc.length-1&&(m+=e.state.sliceDoc(l+1,l+2));let $=y.bottom-y.top;return new tce((j-O.left)/e.scaleX,(y.top-O.top+$*(1-u))/e.scaleY,$*u/e.scaleY,F.fontFamily,F.fontSize,F.fontWeight,F.color,s?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",m,u!=1)}else return null}var lce=typeof navigator<"u"&&/linux/i.test(navigator.platform)&&/ Gecko\/\d+/.exec(navigator.userAgent);const Nu=zle(En),cce=250,uce=lt.baseTheme({".cm-vimMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"0px 10px",fontFamily:"monospace",minHeight:"1.3em",display:"flex"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"inherit"},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"}}),hce=Ns.fromClass(class{constructor(n){this.status="",this.query=null,this.decorations=At.none,this.waitForCopy=!1,this.lastKeydown="",this.useNextTextInput=!1,this.compositionText="",this.view=n;const e=this.cm=new En(n);Nu.enterVimMode(this.cm),this.view.cm=this.cm,this.cm.state.vimPlugin=this,this.blockCursor=new nce(n,e),this.updateClass(),this.cm.on("vim-command-done",()=>{e.state.vim&&(e.state.vim.status=""),this.blockCursor.scheduleRedraw(),this.updateStatus()}),this.cm.on("vim-mode-change",t=>{e.state.vim&&(e.state.vim.mode=t.mode,t.subMode&&(e.state.vim.mode+=" block"),e.state.vim.status="",this.blockCursor.scheduleRedraw(),this.updateClass(),this.updateStatus())}),this.cm.on("dialog",()=>{this.cm.state.statusbar?this.updateStatus():n.dispatch({effects:r6.of(!!this.cm.state.dialog)})}),this.dom=document.createElement("span"),this.spacer=document.createElement("span"),this.spacer.style.flex="1",this.statusButton=document.createElement("span"),this.statusButton.onclick=t=>{Nu.handleKey(this.cm,"<Esc>","user"),this.cm.focus()},this.statusButton.style.cssText="cursor: pointer"}update(n){var e;if((n.viewportChanged||n.docChanged)&&this.query&&this.highlight(this.query),n.docChanged&&this.cm.onChange(n),n.selectionSet&&this.cm.onSelectionChange(),n.viewportChanged,this.cm.curOp&&!this.cm.curOp.isVimOp&&this.cm.onBeforeEndOperation(),n.transactions){for(let t of n.transactions)for(let s of t.effects)if(s.is(mu))if(!((e=s.value)===null||e===void 0?void 0:e.forVim))this.highlight(null);else{let a=s.value.create();this.highlight(a)}}this.blockCursor.update(n)}updateClass(){const n=this.cm.state;!n.vim||n.vim.insertMode&&!n.overwrite?this.view.scrollDOM.classList.remove("cm-vimMode"):this.view.scrollDOM.classList.add("cm-vimMode")}updateStatus(){let n=this.cm.state.statusbar,e=this.cm.state.vim;if(!n||!e)return;let t=this.cm.state.dialog;if(t)t.parentElement!=n&&(n.textContent="",n.appendChild(t));else{n.textContent="";var s=(e.mode||"normal").toUpperCase();e.insertModeReturn&&(s+="(C-O)"),this.statusButton.textContent=`--${s}--`,n.appendChild(this.statusButton),n.appendChild(this.spacer)}this.dom.textContent=e.status,n.appendChild(this.dom)}destroy(){Nu.leaveVimMode(this.cm),this.updateClass(),this.blockCursor.destroy(),delete this.view.cm}highlight(n){if(this.query=n,!n)return this.decorations=At.none;let{view:e}=this,t=new qo;for(let s=0,r=e.visibleRanges,a=r.length;s<a;s++){let{from:i,to:o}=r[s];for(;s<a-1&&o>r[s+1].from-2*cce;)o=r[++s].to;n.highlight(e.state,i,o,(l,c)=>{t.add(l,c,pce)})}return this.decorations=t.finish()}handleKey(n,e){const t=this.cm;let s=t.state.vim;if(!s)return;const r=Nu.vimKeyFromEvent(n,s);if(En.signal(this.cm,"inputEvent",{type:"handleKey",key:r}),!r)return;if(r=="<Esc>"&&!s.insertMode&&!s.visualMode&&this.query){const o=s.searchState_;o&&(t.removeOverlay(o.getOverlay()),o.setOverlay(null))}if(r==="<C-c>"&&!En.isMac&&t.somethingSelected())return this.waitForCopy=!0,!0;s.status=(s.status||"")+r;let i=Nu.multiSelectHandleKey(t,r,"user");return s=Nu.maybeInitVimState_(t),!i&&s.insertMode&&t.state.overwrite&&(n.key&&n.key.length==1&&!/\n/.test(n.key)?(i=!0,t.overWriteSelection(n.key)):n.key=="Backspace"&&(i=!0,En.commands.cursorCharLeft(t))),i&&(En.signal(this.cm,"vim-keypress",r),n.preventDefault(),n.stopPropagation(),this.blockCursor.scheduleRedraw()),this.updateStatus(),!!i}},{eventHandlers:{copy:function(n,e){this.waitForCopy&&(this.waitForCopy=!1,Promise.resolve().then(()=>{var t=this.cm,s=t.state.vim;s&&(s.insertMode?t.setSelection(t.getCursor(),t.getCursor()):t.operation(()=>{t.curOp&&(t.curOp.isVimOp=!0),Nu.handleKey(t,"<Esc>","user")}))}))},compositionstart:function(n,e){this.useNextTextInput=!0,En.signal(this.cm,"inputEvent",n)},compositionupdate:function(n,e){En.signal(this.cm,"inputEvent",n)},compositionend:function(n,e){En.signal(this.cm,"inputEvent",n)},keypress:function(n,e){En.signal(this.cm,"inputEvent",n),this.lastKeydown=="Dead"&&this.handleKey(n,e)},keydown:function(n,e){En.signal(this.cm,"inputEvent",n),this.lastKeydown=n.key,this.lastKeydown=="Unidentified"||this.lastKeydown=="Process"||this.lastKeydown=="Dead"?this.useNextTextInput=!0:(this.useNextTextInput=!1,this.handleKey(n,e))}},provide:()=>[lt.inputHandler.of((n,e,t,s)=>{var r,a,i=yce(n);if(!i)return!1;var o=(r=i.state)===null||r===void 0?void 0:r.vim,l=i.state.vimPlugin;if(o&&!o.insertMode&&!(!((a=i.curOp)===null||a===void 0)&&a.isVimOp)){if(s==="\0\0")return!0;if(En.signal(i,"inputEvent",{type:"text",text:s,from:e,to:t}),s.length==1&&l.useNextTextInput){if(o.expectLiteralNext&&n.composing)return l.compositionText=s,!1;if(l.compositionText){var c=l.compositionText;l.compositionText="";var u=n.state.selection.main.head,h=n.state.sliceDoc(u-c.length,u);if(c===h){var d=i.getCursor();i.replaceRange("",i.posFromIndex(u-c.length),d)}}return l.handleKey({key:s,preventDefault:()=>{},stopPropagation:()=>{}}),dce(n),!0}}return!1})],decorations:n=>n.decorations});function dce(n){var e=n.scrollDOM.parentElement;if(e){if(lce){n.contentDOM.textContent="\0\0",n.contentDOM.dispatchEvent(new CustomEvent("compositionend"));return}var t=n.scrollDOM.nextSibling,s=window.getSelection(),r=s&&{anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset};n.scrollDOM.remove(),e.insertBefore(n.scrollDOM,t);try{r&&s&&(s.setPosition(r.anchorNode,r.anchorOffset),r.focusNode&&s.extend(r.focusNode,r.focusOffset))}catch(a){console.error(a)}n.focus(),n.contentDOM.dispatchEvent(new CustomEvent("compositionend"))}}const pce=At.mark({class:"cm-searchMatch"}),r6=rn.define(),mce=qs.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(r6)&&(n=t.value);return n},provide:n=>hu.from(n,e=>e?fce:null)});function fce(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.dialog&&e.appendChild(t.state.dialog),{top:!1,dom:e}}function gce(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.statusbar=e,t.state.vimPlugin.updateStatus(),{dom:e}}function bce(n={}){return[uce,hce,ace,n.status?hu.of(gce):mce]}function yce(n){return n.cm||null}class M5{constructor(e,t,s){this.from=e,this.to=t,this.diagnostic=s}}class Vu{constructor(e,t,s){this.diagnostics=e,this.panel=t,this.selected=s}static init(e,t,s){let r=s.facet(of).markerFilter;r&&(e=r(e,s));let a=e.slice().sort((m,y)=>m.from-y.from||m.to-y.to),i=new qo,o=[],l=0,c=s.doc.iter(),u=0,h=s.doc.length;for(let m=0;;){let y=m==a.length?null:a[m];if(!y&&!o.length)break;let O,S;if(o.length)O=l,S=o.reduce((j,N)=>Math.min(j,N.to),y&&y.from>O?y.from:1e8);else{if(O=y.from,O>h)break;S=y.to,o.push(y),m++}for(;m<a.length;){let j=a[m];if(j.from==O&&(j.to>j.from||j.to==O))o.push(j),m++,S=Math.min(j.to,S);else{S=Math.min(j.from,S);break}}S=Math.min(S,h);let A=!1;if(o.some(j=>j.from==O&&(j.to==S||S==h))&&(A=O==S,!A&&S-O<10)){let j=O-(u+c.value.length);j>0&&(c.next(j),u=O);for(let N=O;;){if(N>=S){A=!0;break}if(!c.lineBreak&&u+c.value.length>N)break;N=u+c.value.length,u+=c.value.length,c.next()}}let F=Dce(o);if(A)i.add(O,O,At.widget({widget:new Pce(F),diagnostics:o.slice()}));else{let j=o.reduce((N,$)=>$.markClass?N+" "+$.markClass:N,"");i.add(O,S,At.mark({class:"cm-lintRange cm-lintRange-"+F+j,diagnostics:o.slice(),inclusiveEnd:o.some(N=>N.to>S)}))}if(l=S,l==h)break;for(let j=0;j<o.length;j++)o[j].to<=l&&o.splice(j--,1)}let d=i.finish();return new Vu(d,t,fu(d))}}function fu(n,e=null,t=0){let s=null;return n.between(t,1e9,(r,a,{spec:i})=>{if(!(e&&i.diagnostics.indexOf(e)<0))if(!s)s=new M5(r,a,e||i.diagnostics[0]);else{if(i.diagnostics.indexOf(s.diagnostic)<0)return!1;s=new M5(s.from,a,s.diagnostic)}}),s}function vce(n,e){let t=e.pos,s=e.end||t,r=n.state.facet(of).hideOn(n,t,s);if(r!=null)return r;let a=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(i=>i.is(a6))||n.changes.touchesRange(a.from,Math.max(a.to,s)))}function Oce(n,e){return n.field(Di,!1)?e:e.concat(rn.appendConfig.of(Tce))}const a6=rn.define(),_P=rn.define(),i6=rn.define(),Di=qs.define({create(){return new Vu(At.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),s=null,r=n.panel;if(n.selected){let a=e.changes.mapPos(n.selected.from,1);s=fu(t,n.selected.diagnostic,a)||fu(t,null,a)}!t.size&&r&&e.state.facet(of).autoPanel&&(r=null),n=new Vu(t,r,s)}for(let t of e.effects)if(t.is(a6)){let s=e.state.facet(of).autoPanel?t.value.length?lf.open:null:n.panel;n=Vu.init(t.value,s,e.state)}else t.is(_P)?n=new Vu(n.diagnostics,t.value?lf.open:null,n.selected):t.is(i6)&&(n=new Vu(n.diagnostics,n.panel,t.value));return n},provide:n=>[hu.from(n,e=>e.panel),lt.decorations.from(n,e=>e.diagnostics)]}),wce=At.mark({class:"cm-lintRange cm-lintRange-active"});function xce(n,e,t){let{diagnostics:s}=n.state.field(Di),r,a=-1,i=-1;s.between(e-(t<0?1:0),e+(t>0?1:0),(l,c,{spec:u})=>{if(e>=l&&e<=c&&(l==c||(e>l||t>0)&&(e<c||t<0)))return r=u.diagnostics,a=l,i=c,!1});let o=n.state.facet(of).tooltipFilter;return r&&o&&(r=o(r,n.state)),r?{pos:a,end:i,above:n.state.doc.lineAt(a).to<i,create(){return{dom:kce(n,r)}}}:null}function kce(n,e){return bs("ul",{class:"cm-tooltip-lint"},e.map(t=>l6(n,t,!1)))}const Sce=n=>{let e=n.state.field(Di,!1);(!e||!e.panel)&&n.dispatch({effects:Oce(n.state,[_P.of(!0)])});let t=aP(n,lf.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},D5=n=>{let e=n.state.field(Di,!1);return!e||!e.panel?!1:(n.dispatch({effects:_P.of(!1)}),!0)},Cce=n=>{let e=n.state.field(Di,!1);if(!e)return!1;let t=n.state.selection.main,s=fu(e.diagnostics,null,t.to+1);return!s&&(s=fu(e.diagnostics,null,0),!s||s.from==t.from&&s.to==t.to)?!1:(n.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0}),!0)},of=Dt.define({combine(n){return{sources:n.map(e=>e.source).filter(e=>e!=null),...Ll(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:T5,tooltipFilter:T5,needsRefresh:(e,t)=>e?t?s=>e(s)||t(s):e:t,hideOn:(e,t)=>e?t?(s,r,a)=>e(s,r,a)||t(s,r,a):e:t,autoPanel:(e,t)=>e||t})}}});function T5(n,e){return n?e?(t,s)=>e(n(t,s),s):n:e}function o6(n){let e=[];if(n)e:for(let{name:t}of n){for(let s=0;s<t.length;s++){let r=t[s];if(/[a-zA-Z]/.test(r)&&!e.some(a=>a.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function l6(n,e,t){var s;let r=t?o6(e.actions):[];return bs("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},bs("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(s=e.actions)===null||s===void 0?void 0:s.map((a,i)=>{let o=!1,l=m=>{if(m.preventDefault(),o)return;o=!0;let y=fu(n.state.field(Di).diagnostics,e);y&&a.apply(n,y.from,y.to)},{name:c}=a,u=r[i]?c.indexOf(r[i]):-1,h=u<0?c:[c.slice(0,u),bs("u",c.slice(u,u+1)),c.slice(u+1)],d=a.markClass?" "+a.markClass:"";return bs("button",{type:"button",class:"cm-diagnosticAction"+d,onclick:l,onmousedown:l,"aria-label":` Action: ${c}${u<0?"":` (access key "${r[i]})"`}.`},h)}),e.source&&bs("div",{class:"cm-diagnosticSource"},e.source))}class Pce extends ho{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return bs("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class B5{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=l6(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class lf{constructor(e){this.view=e,this.items=[];let t=r=>{if(!(r.ctrlKey||r.altKey||r.metaKey)){if(r.keyCode==27)D5(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:a}=this.items[this.selectedIndex],i=o6(a.actions);for(let o=0;o<i.length;o++)if(i[o].toUpperCase().charCodeAt(0)==r.keyCode){let l=fu(this.view.state.field(Di).diagnostics,a);l&&a.actions[o].apply(e,l.from,l.to)}}else return;r.preventDefault()}},s=r=>{for(let a=0;a<this.items.length;a++)this.items[a].dom.contains(r.target)&&this.moveSelection(a)};this.list=bs("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:s}),this.dom=bs("div",{class:"cm-panel-lint"},this.list,bs("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>D5(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Di).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Di),s=0,r=!1,a=null,i=new Set;for(e.between(0,this.view.state.doc.length,(o,l,{spec:c})=>{for(let u of c.diagnostics){if(i.has(u))continue;i.add(u);let h=-1,d;for(let m=s;m<this.items.length;m++)if(this.items[m].diagnostic==u){h=m;break}h<0?(d=new B5(this.view,u),this.items.splice(s,0,d),r=!0):(d=this.items[h],h>s&&(this.items.splice(s,h-s),r=!0)),t&&d.diagnostic==t.diagnostic?d.dom.hasAttribute("aria-selected")||(d.dom.setAttribute("aria-selected","true"),a=d):d.dom.hasAttribute("aria-selected")&&d.dom.removeAttribute("aria-selected"),s++}});s<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new B5(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),a?(this.list.setAttribute("aria-activedescendant",a.id),this.view.requestMeasure({key:this,read:()=>({sel:a.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let c=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/c:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let s=e;e=s.nextSibling,s.remove()}for(let s of this.items)if(s.dom.parentNode==this.list){for(;e!=s.dom;)t();e=s.dom.nextSibling}else this.list.insertBefore(s.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Di),s=fu(t.diagnostics,this.items[e].diagnostic);s&&this.view.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:i6.of(s)})}static open(e){return new lf(e)}}function Ace(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function Zg(n){return Ace(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Ece=lt.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Zg("#d11")},".cm-lintRange-warning":{backgroundImage:Zg("orange")},".cm-lintRange-info":{backgroundImage:Zg("#999")},".cm-lintRange-hint":{backgroundImage:Zg("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function Mce(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function Dce(n){let e="hint",t=1;for(let s of n){let r=Mce(s.severity);r>t&&(t=r,e=s.severity)}return e}const Tce=[Di,lt.decorations.compute([Di],n=>{let{selected:e,panel:t}=n.field(Di);return!e||!t||e.from==e.to?At.none:At.set([wce.range(e.from,e.to)])}),IF(xce,{hideOn:vce}),Ece],c6=n=>e=>{const t=n==="down";let s=e.state.selection;for(const r of s.ranges)s=s.addRange(e.moveVertically(r,t));return e.dispatch({selection:s}),!0},Bce=c6("up"),Fce=c6("down"),$ce=n=>{let e=null;for(const t of n.state.selection.ranges)if(!t.empty)for(let s=t.from;s<=t.to;){const r=n.state.doc.lineAt(s),a=Math.min(r.to,t.to);e?e=e.addRange(Le.range(a,a)):e=Le.single(a),s=r.to+1}return e?(n.dispatch({selection:e}),!0):!1},Nce=[{key:"Ctrl-Space",run:tb},{key:"Escape",run:D$},{key:"ArrowDown",run:zc(!0)},{key:"ArrowUp",run:zc(!1)},{key:"PageDown",run:zc(!0,"page")},{key:"PageUp",run:zc(!1,"page")},{key:"Enter",run:Kk},{key:"Tab",run:Kk},{key:"Mod-f",run:Q8,scope:"editor search-panel"},{key:"Escape",run:j8,scope:"editor search-panel"},{key:"Alt-Enter",run:_8,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:R8,scope:"editor search-panel"},{key:"Ctrl-g",run:voe},{key:"Mod-d",run:Doe,preventDefault:!0},{key:"Shift-Mod-l",run:Qoe},{key:"Enter",run:sf,shift:sf},{key:"ArrowLeft",run:nf,shift:cy,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t8,shift:h8},{key:"ArrowRight",run:ry,shift:uy,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:n8,shift:d8},{key:"ArrowUp",run:ay,shift:hy,preventDefault:!0},{key:"ArrowDown",run:iy,shift:dy,preventDefault:!0},{key:"Home",run:ly,shift:n2},{mac:"Cmd-ArrowLeft",run:ly,shift:n2},{key:"Mod-Home",run:fy,shift:by},{mac:"Cmd-ArrowUp",run:fy,shift:by},{key:"PageUp",run:Tm,shift:py},{mac:"Ctrl-ArrowUp",run:Tm,shift:py},{key:"PageDown",run:cd,shift:my},{mac:"Ctrl-ArrowDown",run:cd,shift:my},{key:"End",run:oy,shift:t2},{mac:"Cmd-ArrowRight",run:oy,shift:t2},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:Bce,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:Fce,preventDefault:!0},{key:"Shift-Alt-i",run:$ce},{key:"Mod-End",run:gy,shift:yy},{mac:"Cmd-ArrowDown",run:gy,shift:yy},{key:"Mod-a",run:b8},{key:"Backspace",run:R$},{key:"Backspace",run:ud,shift:ud},{key:"Delete",run:vy},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Oy},{key:"Mod-Delete",mac:"Alt-Delete",run:x8},{mac:"Mod-Backspace",run:coe},{mac:"Mod-Delete",run:s2},{mac:"Ctrl-b",run:nf,shift:cy,preventDefault:!0},{mac:"Ctrl-f",run:ry,shift:uy},{mac:"Ctrl-p",run:ay,shift:hy},{mac:"Ctrl-n",run:iy,shift:dy},{mac:"Ctrl-a",run:i8,shift:f8},{mac:"Ctrl-e",run:o8,shift:g8},{mac:"Ctrl-d",run:vy},{mac:"Ctrl-h",run:ud},{mac:"Ctrl-k",run:s2},{mac:"Ctrl-Alt-h",run:Oy},{mac:"Ctrl-o",run:PP},{mac:"Ctrl-t",run:k8},{mac:"Ctrl-v",run:cd},{mac:"Alt-v",run:Tm},{key:"Shift-Mod-k",run:D8},{key:"Alt-ArrowDown",run:P8},{key:"Alt-ArrowUp",run:C8},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:M8},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:E8},{key:"Mod-l",run:y8,preventDefault:!0},{key:"Shift-Mod-\\",run:l8},{key:"Tab",run:rf,shift:af,preventDefault:!0},{key:"Mod-[",run:af},{key:"Mod-]",run:rf},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:dP},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:d$},{key:"Mod-k Mod-0",run:m$},{key:"Mod-k Mod-j",run:f$},{key:"Mod-k Mod-c",run:$ie},{key:"Mod-k Mod-u",run:Nie},{key:"Mod-/",run:OP},{key:"Shift-Alt-a",run:W$},{key:"Mod-z",run:av,preventDefault:!0},{key:"Mod-y",run:Fd,preventDefault:!0},{key:"Mod-Shift-z",run:Fd,preventDefault:!0},{key:"Mod-u",run:Y$,preventDefault:!0},{key:"Mod-Shift-m",run:Sce},{key:"F8",run:Cce}];function _ce(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function Nd(n,e,t,s){var r=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(r,Nd.prototype),r.expected=e,r.found=t,r.location=s,r.name="SyntaxError",r}_ce(Nd,Error);function ew(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}Nd.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,s;for(s=0;s<n.length;s++)if(n[s].source===this.location.source){t=n[s].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,a=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(r):r,i=this.location.source+":"+a.line+":"+a.column;if(t){var o=this.location.end,l=ew("",a.line.toString().length," "),c=t[r.line-1],u=r.line===o.line?o.column:c.length+1,h=u-r.column||1;e+=`
 --> `+i+`
`+l+` |
`+a.line+" | "+c+`
`+l+" | "+ew("",r.column-1," ")+ew("",h,"^")}else e+=`
 at `+i}return e};Nd.buildMessage=function(n,e){var t={literal:function(c){return'"'+r(c.text)+'"'},class:function(c){var u=c.parts.map(function(h){return Array.isArray(h)?a(h[0])+"-"+a(h[1]):a(h)});return"["+(c.inverted?"^":"")+u.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(c){return c.description}};function s(c){return c.charCodeAt(0).toString(16).toUpperCase()}function r(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+s(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+s(u)})}function a(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+s(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+s(u)})}function i(c){return t[c.type](c)}function o(c){var u=c.map(i),h,d;if(u.sort(),u.length>0){for(h=1,d=1;h<u.length;h++)u[h-1]!==u[h]&&(u[d]=u[h],d++);u.length=d}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function l(c){return c?'"'+r(c)+'"':"end of input"}return"Expected "+o(n)+" but "+l(e)+" found."};function Rce(n,e){e=e!==void 0?e:{};var t={},s=e.grammarSource,r={start:zt},a=zt,i=".",o="-",l="0",c=",",u="|",h="[",d="]",m="{",y="}",O="%",S="<",A=">",F="!",j="(",N=")",$="/",L="*",I="?",q=":",ce="..",ee="^",he="struct",H="target",me="euclid",Oe="slow",Pe="rotL",De="rotR",Se="fast",ae="scale",Ee="//",Qe="cat",Ke="$",ge="setcps",Ye="setbpm",yt="hush",Xe=/^[1-9]/,Ge=/^[eE]/,Ct=/^[+\-]/,Et=/^[0-9]/,gn=/^[ \n\r\t\xA0]/,On=/^["']/,qn=/^[#\--.0-9A-Z\^-_a-z~\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u09FC\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD-\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,cn=/^[@_]/,un=/^[^\n]/,Rt=tt("number"),Kt=Ne(".",!1),Un=ot([["1","9"]],!1,!1),Wn=ot(["e","E"],!1,!1),bn=ot(["+","-"],!1,!1),rt=Ne("-",!1),Pn=Ne("0",!1),pt=ot([["0","9"]],!1,!1),Vt=tt("whitespace"),Zt=ot([" ",`
`,"\r","	"," "],!1,!1),_n=Ne(",",!1),it=Ne("|",!1),Ft=ot(['"',"'"],!1,!1),_e=tt('a letter, a number, "-", "#", ".", "^", "_"'),Lt=ot(["#",["-","."],["0","9"],["A","Z"],["^","_"],["a","z"],"~","ª","µ","º",["À","Ö"],["Ø","ö"],["ø","ˁ"],["ˆ","ˑ"],["ˠ","ˤ"],"ˬ","ˮ",["Ͱ","ʹ"],["Ͷ","ͷ"],["ͺ","ͽ"],"Ϳ","Ά",["Έ","Ί"],"Ό",["Ύ","Ρ"],["Σ","ϵ"],["Ϸ","ҁ"],["Ҋ","ԯ"],["Ա","Ֆ"],"ՙ",["ՠ","ֈ"],["א","ת"],["ׯ","ײ"],["ؠ","ي"],["ٮ","ٯ"],["ٱ","ۓ"],"ە",["ۥ","ۦ"],["ۮ","ۯ"],["ۺ","ۼ"],"ۿ","ܐ",["ܒ","ܯ"],["ݍ","ޥ"],"ޱ",["ߊ","ߪ"],["ߴ","ߵ"],"ߺ",["ࠀ","ࠕ"],"ࠚ","ࠤ","ࠨ",["ࡀ","ࡘ"],["ࡠ","ࡪ"],["ࢠ","ࢴ"],["ࢶ","ࢽ"],["ऄ","ह"],"ऽ","ॐ",["क़","ॡ"],["ॱ","ঀ"],["অ","ঌ"],["এ","ঐ"],["ও","ন"],["প","র"],"ল",["শ","হ"],"ঽ","ৎ",["ড়","ঢ়"],["য়","ৡ"],["ৰ","ৱ"],"ৼ",["ਅ","ਊ"],["ਏ","ਐ"],["ਓ","ਨ"],["ਪ","ਰ"],["ਲ","ਲ਼"],["ਵ","ਸ਼"],["ਸ","ਹ"],["ਖ਼","ੜ"],"ਫ਼",["ੲ","ੴ"],["અ","ઍ"],["એ","ઑ"],["ઓ","ન"],["પ","ર"],["લ","ળ"],["વ","હ"],"ઽ","ૐ",["ૠ","ૡ"],"ૹ",["ଅ","ଌ"],["ଏ","ଐ"],["ଓ","ନ"],["ପ","ର"],["ଲ","ଳ"],["ଵ","ହ"],"ଽ",["ଡ଼","ଢ଼"],["ୟ","ୡ"],"ୱ","ஃ",["அ","ஊ"],["எ","ஐ"],["ஒ","க"],["ங","ச"],"ஜ",["ஞ","ட"],["ண","த"],["ந","ப"],["ம","ஹ"],"ௐ",["అ","ఌ"],["ఎ","ఐ"],["ఒ","న"],["ప","హ"],"ఽ",["ౘ","ౚ"],["ౠ","ౡ"],"ಀ",["ಅ","ಌ"],["ಎ","ಐ"],["ಒ","ನ"],["ಪ","ಳ"],["ವ","ಹ"],"ಽ","ೞ",["ೠ","ೡ"],["ೱ","ೲ"],["അ","ഌ"],["എ","ഐ"],["ഒ","ഺ"],"ഽ","ൎ",["ൔ","ൖ"],["ൟ","ൡ"],["ൺ","ൿ"],["අ","ඖ"],["ක","න"],["ඳ","ර"],"ල",["ව","ෆ"],["ก","ะ"],["า","ำ"],["เ","ๆ"],["ກ","ຂ"],"ຄ",["ງ","ຈ"],"ຊ","ຍ",["ດ","ທ"],["ນ","ຟ"],["ມ","ຣ"],"ລ","ວ",["ສ","ຫ"],["ອ","ະ"],["າ","ຳ"],"ຽ",["ເ","ໄ"],"ໆ",["ໜ","ໟ"],"ༀ",["ཀ","ཇ"],["ཉ","ཬ"],["ྈ","ྌ"],["က","ဪ"],"ဿ",["ၐ","ၕ"],["ၚ","ၝ"],"ၡ",["ၥ","ၦ"],["ၮ","ၰ"],["ၵ","ႁ"],"ႎ",["Ⴀ","Ⴥ"],"Ⴧ","Ⴭ",["ა","ჺ"],["ჼ","ቈ"],["ቊ","ቍ"],["ቐ","ቖ"],"ቘ",["ቚ","ቝ"],["በ","ኈ"],["ኊ","ኍ"],["ነ","ኰ"],["ኲ","ኵ"],["ኸ","ኾ"],"ዀ",["ዂ","ዅ"],["ወ","ዖ"],["ዘ","ጐ"],["ጒ","ጕ"],["ጘ","ፚ"],["ᎀ","ᎏ"],["Ꭰ","Ᏽ"],["ᏸ","ᏽ"],["ᐁ","ᙬ"],["ᙯ","ᙿ"],["ᚁ","ᚚ"],["ᚠ","ᛪ"],["ᛮ","ᛸ"],["ᜀ","ᜌ"],["ᜎ","ᜑ"],["ᜠ","ᜱ"],["ᝀ","ᝑ"],["ᝠ","ᝬ"],["ᝮ","ᝰ"],["ក","ឳ"],"ៗ","ៜ",["ᠠ","ᡸ"],["ᢀ","ᢄ"],["ᢇ","ᢨ"],"ᢪ",["ᢰ","ᣵ"],["ᤀ","ᤞ"],["ᥐ","ᥭ"],["ᥰ","ᥴ"],["ᦀ","ᦫ"],["ᦰ","ᧉ"],["ᨀ","ᨖ"],["ᨠ","ᩔ"],"ᪧ",["ᬅ","ᬳ"],["ᭅ","ᭋ"],["ᮃ","ᮠ"],["ᮮ","ᮯ"],["ᮺ","ᯥ"],["ᰀ","ᰣ"],["ᱍ","ᱏ"],["ᱚ","ᱽ"],["ᲀ","ᲈ"],["Ა","Ჺ"],["Ჽ","Ჿ"],["ᳩ","ᳬ"],["ᳮ","ᳱ"],["ᳵ","ᳶ"],["ᴀ","ᶿ"],["Ḁ","ἕ"],["Ἐ","Ἕ"],["ἠ","ὅ"],["Ὀ","Ὅ"],["ὐ","ὗ"],"Ὑ","Ὓ","Ὕ",["Ὗ","ώ"],["ᾀ","ᾴ"],["ᾶ","ᾼ"],"ι",["ῂ","ῄ"],["ῆ","ῌ"],["ῐ","ΐ"],["ῖ","Ί"],["ῠ","Ῥ"],["ῲ","ῴ"],["ῶ","ῼ"],"ⁱ","ⁿ",["ₐ","ₜ"],"ℂ","ℇ",["ℊ","ℓ"],"ℕ",["ℙ","ℝ"],"ℤ","Ω","ℨ",["K","ℭ"],["ℯ","ℹ"],["ℼ","ℿ"],["ⅅ","ⅉ"],"ⅎ",["Ⅰ","ↈ"],["Ⰰ","Ⱞ"],["ⰰ","ⱞ"],["Ⱡ","ⳤ"],["Ⳬ","ⳮ"],["Ⳳ","ⳳ"],["ⴀ","ⴥ"],"ⴧ","ⴭ",["ⴰ","ⵧ"],"ⵯ",["ⶀ","ⶖ"],["ⶠ","ⶦ"],["ⶨ","ⶮ"],["ⶰ","ⶶ"],["ⶸ","ⶾ"],["ⷀ","ⷆ"],["ⷈ","ⷎ"],["ⷐ","ⷖ"],["ⷘ","ⷞ"],"ⸯ",["々","〇"],["〡","〩"],["〱","〵"],["〸","〼"],["ぁ","ゖ"],["ゝ","ゟ"],["ァ","ヺ"],["ー","ヿ"],["ㄅ","ㄯ"],["ㄱ","ㆎ"],["ㆠ","ㆺ"],["ㇰ","ㇿ"],["㐀","䶵"],["一","鿯"],["ꀀ","ꒌ"],["ꓐ","ꓽ"],["ꔀ","ꘌ"],["ꘐ","ꘟ"],["ꘪ","ꘫ"],["Ꙁ","ꙮ"],["ꙿ","ꚝ"],["ꚠ","ꛯ"],["ꜗ","ꜟ"],["Ꜣ","ꞈ"],["Ꞌ","ꞹ"],["ꟷ","ꠁ"],["ꠃ","ꠅ"],["ꠇ","ꠊ"],["ꠌ","ꠢ"],["ꡀ","ꡳ"],["ꢂ","ꢳ"],["ꣲ","ꣷ"],"ꣻ",["ꣽ","ꣾ"],["ꤊ","ꤥ"],["ꤰ","ꥆ"],["ꥠ","ꥼ"],["ꦄ","ꦲ"],"ꧏ",["ꧠ","ꧤ"],["ꧦ","ꧯ"],["ꧺ","ꧾ"],["ꨀ","ꨨ"],["ꩀ","ꩂ"],["ꩄ","ꩋ"],["ꩠ","ꩶ"],"ꩺ",["ꩾ","ꪯ"],"ꪱ",["ꪵ","ꪶ"],["ꪹ","ꪽ"],"ꫀ","ꫂ",["ꫛ","ꫝ"],["ꫠ","ꫪ"],["ꫲ","ꫴ"],["ꬁ","ꬆ"],["ꬉ","ꬎ"],["ꬑ","ꬖ"],["ꬠ","ꬦ"],["ꬨ","ꬮ"],["ꬰ","ꭚ"],["ꭜ","ꭥ"],["ꭰ","ꯢ"],["가","힣"],["ힰ","ퟆ"],["ퟋ","ퟻ"],["豈","舘"],["並","龎"],["ﬀ","ﬆ"],["ﬓ","ﬗ"],"יִ",["ײַ","ﬨ"],["שׁ","זּ"],["טּ","לּ"],"מּ",["נּ","סּ"],["ףּ","פּ"],["צּ","ﮱ"],["ﯓ","ﴽ"],["ﵐ","ﶏ"],["ﶒ","ﷇ"],["ﷰ","ﷻ"],["ﹰ","ﹴ"],["ﹶ","ﻼ"],["Ａ","Ｚ"],["ａ","ｚ"],["ｦ","ﾾ"],["ￂ","ￇ"],["ￊ","ￏ"],["ￒ","ￗ"],["ￚ","ￜ"]],!1,!1),et=Ne("[",!1),is=Ne("]",!1),It=Ne("{",!1),Dn=Ne("}",!1),Cs=Ne("%",!1),Wt=Ne("<",!1),Pt=Ne(">",!1),$t=ot(["@","_"],!1,!1),xn=Ne("!",!1),st=Ne("(",!1),Gt=Ne(")",!1),an=Ne("/",!1),vs=Ne("*",!1),Vn=Ne("?",!1),Hs=Ne(":",!1),Ys=Ne("..",!1),w=Ne("^",!1),_=Ne("struct",!1),B=Ne("target",!1),R=Ne("euclid",!1),Z=Ne("slow",!1),Y=Ne("rotL",!1),se=Ne("rotR",!1),te=Ne("fast",!1),be=Ne("scale",!1),$e=Ne("//",!1),Re=ot([`
`],!0,!1),ut=Ne("cat",!1),on=Ne("$",!1),Yn=Ne("setcps",!1),Is=Ne("setbpm",!1),mn=Ne("hush",!1),Jt=function(){return parseFloat(Ze())},sn=function(k){const V=k.join("");return V==="."||V==="_"},ps=function(k){return new cO(k.join(""))},cr=function(k){return k},$i=function(k,V){return k.arguments_.stepsPerCycle=V,k},Gr=function(k){return k},hi=function(k){return k.arguments_.alignment="polymeter_slowcat",k},di=function(k){return V=>V.options_.weight=(V.options_.weight??1)+(k??2)-1},Ls=function(k){return V=>{const U=(V.options_.reps??1)+(k??2)-1;V.options_.reps=U,V.options_.ops=V.options_.ops.filter(ve=>ve.type_!=="replicate"),V.options_.ops.push({type_:"replicate",arguments_:{amount:U}}),V.options_.weight=U}},ql=function(k,V,U){return ve=>ve.options_.ops.push({type_:"bjorklund",arguments_:{pulse:k,step:V,rotation:U}})},Dr=function(k){return V=>V.options_.ops.push({type_:"stretch",arguments_:{amount:k,type:"slow"}})},nl=function(k){return V=>V.options_.ops.push({type_:"stretch",arguments_:{amount:k,type:"fast"}})},Ni=function(k){return V=>V.options_.ops.push({type_:"degradeBy",arguments_:{amount:k,seed:Bu++}})},Xr=function(k){return V=>V.options_.ops.push({type_:"tail",arguments_:{element:k}})},Ul=function(k){return V=>V.options_.ops.push({type_:"range",arguments_:{element:k}})},_i=function(k,V){const U=new hO(k,{ops:[],weight:1,reps:1});for(const ve of V)ve(U);return U},Ks=function(k,V){return new Hl(V,"fastcat",void 0,!!k)},Da=function(k){return{alignment:"stack",list:k}},Fs=function(k){return{alignment:"rand",list:k,seed:Bu++}},Js=function(k){return{alignment:"feet",list:k,seed:Bu++}},da=function(k,V){return V&&V.list.length>0?new Hl([k,...V.list],V.alignment,V.seed):k},Ta=function(k,V){return new Hl(V?[k,...V.list]:[k],"polymeter")},Hr=function(k){return k},Ba=function(k){return{name:"struct",args:{mini:k}}},Yr=function(k){return{name:"target",args:{name:k}}},Wl=function(k,V,U){return{name:"bjorklund",args:{pulse:k,step:parseInt(V)}}},Ir=function(k){return{name:"stretch",args:{amount:k}}},Or=function(k){return{name:"shift",args:{amount:"-"+k}}},Tn=function(k){return{name:"shift",args:{amount:k}}},wr=function(k){return{name:"stretch",args:{amount:"1/"+k}}},fn=function(k){return{name:"scale",args:{scale:k.join("")}}},Oo=function(k,V){return V},Kr=function(k,V){return V.unshift(k),new Hl(V,"slowcat")},Gl=function(k){return k},Tr=function(k,V){return new uO(k.name,k.args,V)},wo=function(k){return k},pa=function(k){return k},K=function(k){return new Tu("setcps",{value:k})},J=function(k){return new Tu("setcps",{value:k/120/2})},ne=function(){return new Tu("hush")},M=e.peg$currPos|0,ue=M,we=[{line:1,column:1}],xe=M,Ae=e.peg$maxFailExpected||[],fe=e.peg$silentFails|0,Fe;if(e.startRule){if(!(e.startRule in r))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');a=r[e.startRule]}function Ze(){return n.substring(ue,M)}function Te(){return Je(ue,M)}function Ne(k,V){return{type:"literal",text:k,ignoreCase:V}}function ot(k,V,U){return{type:"class",parts:k,inverted:V,ignoreCase:U}}function at(){return{type:"end"}}function tt(k){return{type:"other",description:k}}function Ue(k){var V=we[k],U;if(V)return V;if(k>=we.length)U=we.length-1;else for(U=k;!we[--U];);for(V=we[U],V={line:V.line,column:V.column};U<k;)n.charCodeAt(U)===10?(V.line++,V.column=1):V.column++,U++;return we[k]=V,V}function Je(k,V,U){var ve=Ue(k),We=Ue(V),pn={source:s,start:{offset:k,line:ve.line,column:ve.column},end:{offset:V,line:We.line,column:We.column}};return pn}function Me(k){M<xe||(M>xe&&(xe=M,Ae=[]),Ae.push(k))}function He(k,V,U){return new Nd(Nd.buildMessage(k,V),k,V,U)}function zt(){var k;return k=lO(),k}function Tt(){var k,V;return fe++,k=M,P(),V=x(),V!==t?(Ps(),os(),ue=k,k=Jt()):(M=k,k=t),fe--,k===t&&fe===0&&Me(Rt),k}function hn(){var k;return n.charCodeAt(M)===46?(k=i,M++):(k=t,fe===0&&Me(Kt)),k}function Bn(){var k;return k=n.charAt(M),Xe.test(k)?M++:(k=t,fe===0&&Me(Un)),k}function wn(){var k;return k=n.charAt(M),Ge.test(k)?M++:(k=t,fe===0&&Me(Wn)),k}function os(){var k,V,U,ve,We;if(k=M,V=wn(),V!==t){if(U=n.charAt(M),Ct.test(U)?M++:(U=t,fe===0&&Me(bn)),U===t&&(U=null),ve=[],We=p(),We!==t)for(;We!==t;)ve.push(We),We=p();else ve=t;ve!==t?(V=[V,U,ve],k=V):(M=k,k=t)}else M=k,k=t;return k}function Ps(){var k,V,U,ve;if(k=M,V=hn(),V!==t){if(U=[],ve=p(),ve!==t)for(;ve!==t;)U.push(ve),ve=p();else U=t;U!==t?(V=[V,U],k=V):(M=k,k=t)}else M=k,k=t;return k}function x(){var k,V,U,ve;if(k=T(),k===t)if(k=M,V=Bn(),V!==t){for(U=[],ve=p();ve!==t;)U.push(ve),ve=p();V=[V,U],k=V}else M=k,k=t;return k}function P(){var k;return n.charCodeAt(M)===45?(k=o,M++):(k=t,fe===0&&Me(rt)),k}function T(){var k;return n.charCodeAt(M)===48?(k=l,M++):(k=t,fe===0&&Me(Pn)),k}function p(){var k;return k=n.charAt(M),Et.test(k)?M++:(k=t,fe===0&&Me(pt)),k}function f(){var k,V;for(fe++,k=[],V=n.charAt(M),gn.test(V)?M++:(V=t,fe===0&&Me(Zt));V!==t;)k.push(V),V=n.charAt(M),gn.test(V)?M++:(V=t,fe===0&&Me(Zt));return fe--,V=t,fe===0&&Me(Vt),k}function v(){var k,V,U,ve;return k=M,V=f(),n.charCodeAt(M)===44?(U=c,M++):(U=t,fe===0&&Me(_n)),U!==t?(ve=f(),V=[V,U,ve],k=V):(M=k,k=t),k}function C(){var k,V,U,ve;return k=M,V=f(),n.charCodeAt(M)===124?(U=u,M++):(U=t,fe===0&&Me(it)),U!==t?(ve=f(),V=[V,U,ve],k=V):(M=k,k=t),k}function E(){var k,V,U,ve;return k=M,V=f(),n.charCodeAt(M)===46?(U=i,M++):(U=t,fe===0&&Me(Kt)),U!==t?(ve=f(),V=[V,U,ve],k=V):(M=k,k=t),k}function D(){var k;return k=n.charAt(M),On.test(k)?M++:(k=t,fe===0&&Me(Ft)),k}function Q(){var k;return fe++,k=n.charAt(M),qn.test(k)?M++:(k=t,fe===0&&Me(Lt)),fe--,k===t&&fe===0&&Me(_e),k}function z(){var k,V,U,ve;if(k=M,f(),V=[],U=Q(),U!==t)for(;U!==t;)V.push(U),U=Q();else V=t;return V!==t?(U=f(),ue=M,ve=sn(V),ve?ve=t:ve=void 0,ve!==t?(ue=k,k=ps(V)):(M=k,k=t)):(M=k,k=t),k}function W(){var k,V,U,ve;return k=M,f(),n.charCodeAt(M)===91?(V=h,M++):(V=t,fe===0&&Me(et)),V!==t?(f(),U=Gn(),U!==t?(f(),n.charCodeAt(M)===93?(ve=d,M++):(ve=t,fe===0&&Me(is)),ve!==t?(f(),ue=k,k=cr(U)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function G(){var k,V,U,ve,We;return k=M,f(),n.charCodeAt(M)===123?(V=m,M++):(V=t,fe===0&&Me(It)),V!==t?(f(),U=An(),U!==t?(f(),n.charCodeAt(M)===125?(ve=y,M++):(ve=t,fe===0&&Me(Dn)),ve!==t?(We=X(),We===t&&(We=null),f(),ue=k,k=$i(U,We)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function X(){var k,V,U;return k=M,n.charCodeAt(M)===37?(V=O,M++):(V=t,fe===0&&Me(Cs)),V!==t?(U=de(),U!==t?(ue=k,k=Gr(U)):(M=k,k=t)):(M=k,k=t),k}function re(){var k,V,U,ve;return k=M,f(),n.charCodeAt(M)===60?(V=S,M++):(V=t,fe===0&&Me(Wt)),V!==t?(f(),U=An(),U!==t?(f(),n.charCodeAt(M)===62?(ve=A,M++):(ve=t,fe===0&&Me(Pt)),ve!==t?(f(),ue=k,k=hi(U)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function de(){var k;return k=z(),k===t&&(k=W(),k===t&&(k=G(),k===t&&(k=re()))),k}function pe(){var k;return k=ye(),k===t&&(k=Be(),k===t&&(k=je(),k===t&&(k=Ie(),k===t&&(k=Ce(),k===t&&(k=nt(),k===t&&(k=Nt(),k===t&&(k=ht()))))))),k}function ye(){var k,V,U;return k=M,f(),V=n.charAt(M),cn.test(V)?M++:(V=t,fe===0&&Me($t)),V!==t?(U=Tt(),U===t&&(U=null),ue=k,k=di(U)):(M=k,k=t),k}function Ce(){var k,V,U;return k=M,f(),n.charCodeAt(M)===33?(V=F,M++):(V=t,fe===0&&Me(xn)),V!==t?(U=Tt(),U===t&&(U=null),ue=k,k=Ls(U)):(M=k,k=t),k}function Be(){var k,V,U,ve,We,pn,Ws;return k=M,n.charCodeAt(M)===40?(V=j,M++):(V=t,fe===0&&Me(st)),V!==t?(f(),U=Ot(),U!==t?(f(),ve=v(),ve!==t?(f(),We=Ot(),We!==t?(f(),v(),f(),pn=Ot(),pn===t&&(pn=null),f(),n.charCodeAt(M)===41?(Ws=N,M++):(Ws=t,fe===0&&Me(Gt)),Ws!==t?(ue=k,k=ql(U,We,pn)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function je(){var k,V,U;return k=M,n.charCodeAt(M)===47?(V=$,M++):(V=t,fe===0&&Me(an)),V!==t?(U=de(),U!==t?(ue=k,k=Dr(U)):(M=k,k=t)):(M=k,k=t),k}function Ie(){var k,V,U;return k=M,n.charCodeAt(M)===42?(V=L,M++):(V=t,fe===0&&Me(vs)),V!==t?(U=de(),U!==t?(ue=k,k=nl(U)):(M=k,k=t)):(M=k,k=t),k}function nt(){var k,V,U;return k=M,n.charCodeAt(M)===63?(V=I,M++):(V=t,fe===0&&Me(Vn)),V!==t?(U=Tt(),U===t&&(U=null),ue=k,k=Ni(U)):(M=k,k=t),k}function Nt(){var k,V,U;return k=M,n.charCodeAt(M)===58?(V=q,M++):(V=t,fe===0&&Me(Hs)),V!==t?(U=de(),U!==t?(ue=k,k=Xr(U)):(M=k,k=t)):(M=k,k=t),k}function ht(){var k,V,U;return k=M,n.substr(M,2)===ce?(V=ce,M+=2):(V=t,fe===0&&Me(Ys)),V!==t?(U=de(),U!==t?(ue=k,k=Ul(U)):(M=k,k=t)):(M=k,k=t),k}function Ot(){var k,V,U,ve;if(k=M,V=de(),V!==t){for(U=[],ve=pe();ve!==t;)U.push(ve),ve=pe();ue=k,k=_i(V,U)}else M=k,k=t;return k}function Ut(){var k,V,U,ve;if(k=M,n.charCodeAt(M)===94?(V=ee,M++):(V=t,fe===0&&Me(w)),V===t&&(V=null),U=[],ve=Ot(),ve!==t)for(;ve!==t;)U.push(ve),ve=Ot();else U=t;return U!==t?(ue=k,k=Ks(V,U)):(M=k,k=t),k}function Ht(){var k,V,U,ve,We;if(k=M,V=[],U=M,ve=v(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t),U!==t)for(;U!==t;)V.push(U),U=M,ve=v(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t);else V=t;return V!==t&&(ue=k,V=Da(V)),k=V,k}function ct(){var k,V,U,ve,We;if(k=M,V=[],U=M,ve=C(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t),U!==t)for(;U!==t;)V.push(U),U=M,ve=C(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t);else V=t;return V!==t&&(ue=k,V=Fs(V)),k=V,k}function dn(){var k,V,U,ve,We;if(k=M,V=[],U=M,ve=E(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t),U!==t)for(;U!==t;)V.push(U),U=M,ve=E(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t);else V=t;return V!==t&&(ue=k,V=Js(V)),k=V,k}function Gn(){var k,V,U;return k=M,V=Ut(),V!==t?(U=Ht(),U===t&&(U=ct(),U===t&&(U=dn())),U===t&&(U=null),ue=k,k=da(V,U)):(M=k,k=t),k}function An(){var k,V,U;return k=M,V=Ut(),V!==t?(U=Ht(),U===t&&(U=null),ue=k,k=Ta(V,U)):(M=k,k=t),k}function Rn(){var k,V,U,ve;return k=M,f(),V=D(),V!==t?(f(),U=Gn(),U!==t?(f(),ve=D(),ve!==t?(ue=k,k=Hr(U)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function er(){var k;return k=Jv(),k===t&&(k=Jr(),k===t&&(k=Kv(),k===t&&(k=sr(),k===t&&(k=rr(),k===t&&(k=ur(),k===t&&(k=Yv(),k===t&&(k=Xl()))))))),k}function ur(){var k,V,U;return k=M,n.substr(M,6)===he?(V=he,M+=6):(V=t,fe===0&&Me(_)),V!==t?(f(),U=pi(),U!==t?(ue=k,k=Ba(U)):(M=k,k=t)):(M=k,k=t),k}function sr(){var k,V,U,ve,We;return k=M,n.substr(M,6)===H?(V=H,M+=6):(V=t,fe===0&&Me(B)),V!==t?(f(),U=D(),U!==t?(ve=z(),ve!==t?(We=D(),We!==t?(ue=k,k=Yr(ve)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function rr(){var k,V,U,ve;return k=M,n.substr(M,6)===me?(V=me,M+=6):(V=t,fe===0&&Me(R)),V!==t?(f(),U=x(),U!==t?(f(),ve=x(),ve!==t?(f(),x(),ue=k,k=Wl(U,ve)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function Jr(){var k,V,U;return k=M,n.substr(M,4)===Oe?(V=Oe,M+=4):(V=t,fe===0&&Me(Z)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=Ir(U)):(M=k,k=t)):(M=k,k=t),k}function Xl(){var k,V,U;return k=M,n.substr(M,4)===Pe?(V=Pe,M+=4):(V=t,fe===0&&Me(Y)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=Or(U)):(M=k,k=t)):(M=k,k=t),k}function Yv(){var k,V,U;return k=M,n.substr(M,4)===De?(V=De,M+=4):(V=t,fe===0&&Me(se)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=Tn(U)):(M=k,k=t)):(M=k,k=t),k}function Kv(){var k,V,U;return k=M,n.substr(M,4)===Se?(V=Se,M+=4):(V=t,fe===0&&Me(te)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=wr(U)):(M=k,k=t)):(M=k,k=t),k}function Jv(){var k,V,U,ve,We;if(k=M,n.substr(M,5)===ae?(V=ae,M+=5):(V=t,fe===0&&Me(be)),V!==t)if(f(),U=D(),U!==t){if(ve=[],We=Q(),We!==t)for(;We!==t;)ve.push(We),We=Q();else ve=t;ve!==t?(We=D(),We!==t?(ue=k,k=fn(ve)):(M=k,k=t)):(M=k,k=t)}else M=k,k=t;else M=k,k=t;return k}function Du(){var k,V,U,ve;if(k=M,n.substr(M,2)===Ee?(V=Ee,M+=2):(V=t,fe===0&&Me($e)),V!==t){for(U=[],ve=n.charAt(M),un.test(ve)?M++:(ve=t,fe===0&&Me(Re));ve!==t;)U.push(ve),ve=n.charAt(M),un.test(ve)?M++:(ve=t,fe===0&&Me(Re));V=[V,U],k=V}else M=k,k=t;return k}function eO(){var k,V,U,ve,We,pn,Ws,mi;if(k=M,n.substr(M,3)===Qe?(V=Qe,M+=3):(V=t,fe===0&&Me(ut)),V!==t)if(f(),n.charCodeAt(M)===91?(U=h,M++):(U=t,fe===0&&Me(et)),U!==t)if(f(),ve=pi(),ve!==t){for(We=[],pn=M,Ws=v(),Ws!==t?(mi=pi(),mi!==t?(ue=pn,pn=Oo(ve,mi)):(M=pn,pn=t)):(M=pn,pn=t);pn!==t;)We.push(pn),pn=M,Ws=v(),Ws!==t?(mi=pi(),mi!==t?(ue=pn,pn=Oo(ve,mi)):(M=pn,pn=t)):(M=pn,pn=t);pn=f(),n.charCodeAt(M)===93?(Ws=d,M++):(Ws=t,fe===0&&Me(is)),Ws!==t?(ue=k,k=Kr(ve,We)):(M=k,k=t)}else M=k,k=t;else M=k,k=t;else M=k,k=t;return k}function tO(){var k;return k=eO(),k===t&&(k=Rn()),k}function pi(){var k,V,U,ve,We;if(k=M,V=tO(),V!==t){for(f(),U=[],ve=Du();ve!==t;)U.push(ve),ve=Du();ue=k,k=Gl(V)}else M=k,k=t;return k===t&&(k=M,V=er(),V!==t?(f(),n.charCodeAt(M)===36?(U=Ke,M++):(U=t,fe===0&&Me(on)),U!==t?(ve=f(),We=pi(),We!==t?(ue=k,k=Tr(V,We)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t)),k}function nO(){var k,V;return k=M,V=pi(),V!==t&&(ue=k,V=wo(V)),k=V,k===t&&(k=Du()),k}function sO(){var k;return k=nO(),k}function rO(){var k,V;return k=M,f(),V=aO(),V===t&&(V=iO(),V===t&&(V=oO())),V!==t?(f(),ue=k,k=pa(V)):(M=k,k=t),k}function aO(){var k,V,U;return k=M,n.substr(M,6)===ge?(V=ge,M+=6):(V=t,fe===0&&Me(Yn)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=K(U)):(M=k,k=t)):(M=k,k=t),k}function iO(){var k,V,U;return k=M,n.substr(M,6)===Ye?(V=Ye,M+=6):(V=t,fe===0&&Me(Is)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=J(U)):(M=k,k=t)):(M=k,k=t),k}function oO(){var k,V;return k=M,n.substr(M,4)===yt?(V=yt,M+=4):(V=t,fe===0&&Me(mn)),V!==t&&(ue=k,V=ne()),k=V,k}function lO(){var k;return k=sO(),k===t&&(k=rO()),k}var cO=function(k){this.type_="atom",this.source_=k,this.location_=Te()},Hl=function(k,V,U,ve){this.type_="pattern",this.arguments_={alignment:V,_steps:ve},U!==void 0&&(this.arguments_.seed=U),this.source_=k},uO=function(k,V,U){this.type_=k,this.arguments_=V,this.source_=U},hO=function(k,V){this.type_="element",this.source_=k,this.options_=V,this.location_=Te()},Tu=function(k,V){this.type_="command",this.name_=k,this.options_=V},Bu=0;if(Fe=a(),e.peg$library)return{peg$result:Fe,peg$currPos:M,peg$FAILED:t,peg$maxFailExpected:Ae,peg$maxFailPos:xe};if(Fe!==t&&M===n.length)return Fe;throw Fe!==t&&M<n.length&&Me(at()),He(Ae,xe<n.length?n.charAt(xe):null,xe<n.length?Je(xe,xe+1):Je(xe,xe))}typeof BigInt>"u"&&(BigInt=function(n){if(isNaN(n))throw new Error("");return n});const en=BigInt(0),kn=BigInt(1),cf=BigInt(2),u2=BigInt(5),Qa=BigInt(10),Ice=2e3,kt={s:kn,n:en,d:kn};function Kl(n,e){try{n=BigInt(n)}catch{throw $c()}return n*e}function xo(n){return typeof n=="bigint"?n:Math.floor(n)}function Qs(n,e){if(e===en)throw RP();const t=Object.create(_s.prototype);t.s=n<en?-kn:kn,n=n<en?-n:n;const s=Zu(n,e);return t.n=n/s,t.d=e/s,t}function Th(n){const e={};let t=n,s=cf,r=u2-kn;for(;r<=t;){for(;t%s===en;)t/=s,e[s]=(e[s]||en)+kn;r+=kn+cf*s++}return t!==n?t>1&&(e[t]=(e[t]||en)+kn):e[n]=(e[n]||en)+kn,e}const Fr=function(n,e){let t=en,s=kn,r=kn;if(n!=null)if(e!==void 0){if(typeof n=="bigint")t=n;else{if(isNaN(n))throw $c();if(n%1!==0)throw F5();t=BigInt(n)}if(typeof e=="bigint")s=e;else{if(isNaN(e))throw $c();if(e%1!==0)throw F5();s=BigInt(e)}r=t*s}else if(typeof n=="object"){if("d"in n&&"n"in n)t=BigInt(n.n),s=BigInt(n.d),"s"in n&&(t*=BigInt(n.s));else if(0 in n)t=BigInt(n[0]),1 in n&&(s=BigInt(n[1]));else if(typeof n=="bigint")t=n;else throw $c();r=t*s}else if(typeof n=="number"){if(isNaN(n))throw $c();if(n<0&&(r=-kn,n=-n),n%1===0)t=BigInt(n);else if(n>0){let a=1,i=0,o=1,l=1,c=1,u=1e7;for(n>=1&&(a=10**Math.floor(1+Math.log10(n)),n/=a);o<=u&&c<=u;){let h=(i+l)/(o+c);if(n===h){o+c<=u?(t=i+l,s=o+c):c>o?(t=l,s=c):(t=i,s=o);break}else n>h?(i+=l,o+=c):(l+=i,c+=o),o>u?(t=l,s=c):(t=i,s=o)}t=BigInt(t)*BigInt(a),s=BigInt(s)}}else if(typeof n=="string"){let a=0,i=en,o=en,l=en,c=kn,u=kn,h=n.replace(/_/g,"").match(/\d+|./g);if(h===null)throw $c();if(h[a]==="-"?(r=-kn,a++):h[a]==="+"&&a++,h.length===a+1?o=Kl(h[a++],r):h[a+1]==="."||h[a]==="."?(h[a]!=="."&&(i=Kl(h[a++],r)),a++,(a+1===h.length||h[a+1]==="("&&h[a+3]===")"||h[a+1]==="'"&&h[a+3]==="'")&&(o=Kl(h[a],r),c=Qa**BigInt(h[a].length),a++),(h[a]==="("&&h[a+2]===")"||h[a]==="'"&&h[a+2]==="'")&&(l=Kl(h[a+1],r),u=Qa**BigInt(h[a+1].length)-kn,a+=3)):h[a+1]==="/"||h[a+1]===":"?(o=Kl(h[a],r),c=Kl(h[a+2],kn),a+=3):h[a+3]==="/"&&h[a+1]===" "&&(i=Kl(h[a],r),o=Kl(h[a+2],r),c=Kl(h[a+4],kn),a+=5),h.length<=a)s=c*u,r=t=l+s*i+u*o;else throw $c()}else if(typeof n=="bigint")t=n,r=n,s=kn;else throw $c();if(s===en)throw RP();kt.s=r<en?-kn:kn,kt.n=t<en?-t:t,kt.d=s<en?-s:s};function Lce(n,e,t){let s=kn;for(;e>en;n=n*n%t,e>>=kn)e&kn&&(s=s*n%t);return s}function Qce(n,e){for(;e%cf===en;e/=cf);for(;e%u2===en;e/=u2);if(e===kn)return en;let t=Qa%e,s=1;for(;t!==kn;s++)if(t=t*Qa%e,s>Ice)return en;return BigInt(s)}function jce(n,e,t){let s=kn,r=Lce(Qa,t,e);for(let a=0;a<300;a++){if(s===r)return BigInt(a);s=s*Qa%e,r=r*Qa%e}return 0}function Zu(n,e){if(!n)return e;if(!e)return n;for(;;){if(n%=e,!n)return e;if(e%=n,!e)return n}}function _s(n,e){if(Fr(n,e),this instanceof _s)n=Zu(kt.d,kt.n),this.s=kt.s,this.n=kt.n/n,this.d=kt.d/n;else return Qs(kt.s*kt.n,kt.d)}var RP=function(){return new Error("Division by Zero")},$c=function(){return new Error("Invalid argument")},F5=function(){return new Error("Parameters must be integer")};_s.prototype={s:kn,n:en,d:kn,abs:function(){return Qs(this.n,this.d)},neg:function(){return Qs(-this.s*this.n,this.d)},add:function(n,e){return Fr(n,e),Qs(this.s*this.n*kt.d+kt.s*this.d*kt.n,this.d*kt.d)},sub:function(n,e){return Fr(n,e),Qs(this.s*this.n*kt.d-kt.s*this.d*kt.n,this.d*kt.d)},mul:function(n,e){return Fr(n,e),Qs(this.s*kt.s*this.n*kt.n,this.d*kt.d)},div:function(n,e){return Fr(n,e),Qs(this.s*kt.s*this.n*kt.d,this.d*kt.n)},clone:function(){return Qs(this.s*this.n,this.d)},mod:function(n,e){if(n===void 0)return Qs(this.s*this.n%this.d,kn);if(Fr(n,e),en===kt.n*this.d)throw RP();return Qs(this.s*(kt.d*this.n)%(kt.n*this.d),kt.d*this.d)},gcd:function(n,e){return Fr(n,e),Qs(Zu(kt.n,this.n)*Zu(kt.d,this.d),kt.d*this.d)},lcm:function(n,e){return Fr(n,e),kt.n===en&&this.n===en?Qs(en,kn):Qs(kt.n*this.n,Zu(kt.n,this.n)*Zu(kt.d,this.d))},inverse:function(){return Qs(this.s*this.d,this.n)},pow:function(n,e){if(Fr(n,e),kt.d===kn)return kt.s<en?Qs((this.s*this.d)**kt.n,this.n**kt.n):Qs((this.s*this.n)**kt.n,this.d**kt.n);if(this.s<en)return null;let t=Th(this.n),s=Th(this.d),r=kn,a=kn;for(let i in t)if(i!=="1"){if(i==="0"){r=en;break}if(t[i]*=kt.n,t[i]%kt.d===en)t[i]/=kt.d;else return null;r*=BigInt(i)**t[i]}for(let i in s)if(i!=="1"){if(s[i]*=kt.n,s[i]%kt.d===en)s[i]/=kt.d;else return null;a*=BigInt(i)**s[i]}return kt.s<en?Qs(a,r):Qs(r,a)},log:function(n,e){if(Fr(n,e),this.s<=en||kt.s<=en)return null;const t={},s=Th(kt.n),r=Th(kt.d),a=Th(this.n),i=Th(this.d);for(const c in r)s[c]=(s[c]||en)-r[c];for(const c in i)a[c]=(a[c]||en)-i[c];for(const c in s)c!=="1"&&(t[c]=!0);for(const c in a)c!=="1"&&(t[c]=!0);let o=null,l=null;for(const c in t){const u=s[c]||en,h=a[c]||en;if(u===en){if(h!==en)return null;continue}let d=h,m=u;const y=Zu(d,m);if(d/=y,m/=y,o===null&&l===null)o=d,l=m;else if(d*l!==o*m)return null}return o!==null&&l!==null?Qs(o,l):null},equals:function(n,e){return Fr(n,e),this.s*this.n*kt.d===kt.s*kt.n*this.d},lt:function(n,e){return Fr(n,e),this.s*this.n*kt.d<kt.s*kt.n*this.d},lte:function(n,e){return Fr(n,e),this.s*this.n*kt.d<=kt.s*kt.n*this.d},gt:function(n,e){return Fr(n,e),this.s*this.n*kt.d>kt.s*kt.n*this.d},gte:function(n,e){return Fr(n,e),this.s*this.n*kt.d>=kt.s*kt.n*this.d},compare:function(n,e){Fr(n,e);let t=this.s*this.n*kt.d-kt.s*kt.n*this.d;return(en<t)-(t<en)},ceil:function(n){return n=Qa**BigInt(n||0),Qs(xo(this.s*n*this.n/this.d)+(n*this.n%this.d>en&&this.s>=en?kn:en),n)},floor:function(n){return n=Qa**BigInt(n||0),Qs(xo(this.s*n*this.n/this.d)-(n*this.n%this.d>en&&this.s<en?kn:en),n)},round:function(n){return n=Qa**BigInt(n||0),Qs(xo(this.s*n*this.n/this.d)+this.s*((this.s>=en?kn:en)+cf*(n*this.n%this.d)>this.d?kn:en),n)},roundTo:function(n,e){Fr(n,e);const t=this.n*kt.d,s=this.d*kt.n,r=t%s;let a=xo(t/s);return r+r>=s&&a++,Qs(this.s*a*kt.n,kt.d)},divisible:function(n,e){return Fr(n,e),!(!(kt.n*this.d)||this.n*kt.d%(kt.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(n){let e=this.n,t=this.d;n=n||15;let s=Qce(e,t),r=jce(e,t,s),a=this.s<en?"-":"";if(a+=xo(e/t),e%=t,e*=Qa,e&&(a+="."),s){for(let i=r;i--;)a+=xo(e/t),e%=t,e*=Qa;a+="(";for(let i=s;i--;)a+=xo(e/t),e%=t,e*=Qa;a+=")"}else for(let i=n;e&&i--;)a+=xo(e/t),e%=t,e*=Qa;return a},toFraction:function(n){let e=this.n,t=this.d,s=this.s<en?"-":"";if(t===kn)s+=e;else{let r=xo(e/t);n&&r>en&&(s+=r,s+=" ",e%=t),s+=e,s+="/",s+=t}return s},toLatex:function(n){let e=this.n,t=this.d,s=this.s<en?"-":"";if(t===kn)s+=e;else{let r=xo(e/t);n&&r>en&&(s+=r,e%=t),s+="\\frac{",s+=e,s+="}{",s+=t,s+="}"}return s},toContinued:function(){let n=this.n,e=this.d,t=[];do{t.push(xo(n/e));let s=n%e;n=e,e=s}while(n!==kn);return t},simplify:function(n){const e=BigInt(1/(n||.001)|0),t=this.abs(),s=t.toContinued();for(let r=1;r<s.length;r++){let a=Qs(s[r-1],kn);for(let o=r-2;o>=0;o--)a=a.inverse().add(s[o]);let i=a.sub(t);if(i.n*e<i.d)return a.mul(this.s)}return this}};let Vce=class tc{constructor(e,t){this.begin=qc(e),this.end=qc(t)}get spanCycles(){const e=[];var t=this.begin;const s=this.end,r=s.sam();if(t.equals(s))return[new tc(t,s)];for(;s.gt(t);){if(t.sam().equals(r)){e.push(new tc(t,this.end));break}const a=t.nextSam();e.push(new tc(t,a)),t=a}return e}get duration(){return this.end.sub(this.begin)}cycleArc(){const e=this.begin.cyclePos(),t=e.add(this.duration);return new tc(e,t)}withTime(e){return new tc(e(this.begin),e(this.end))}withEnd(e){return new tc(this.begin,e(this.end))}withCycle(e){const t=this.begin.sam(),s=t.add(e(this.begin.sub(t))),r=t.add(e(this.end.sub(t)));return new tc(s,r)}intersection(e){const t=this.begin.max(e.begin),s=this.end.min(e.end);if(!t.gt(s)&&!(t.equals(s)&&(t.equals(this.end)&&this.begin.lt(this.end)||t.equals(e.end)&&e.begin.lt(e.end))))return new tc(t,s)}intersection_e(e){const t=this.intersection(e);if(t==null)throw"TimeSpans do not intersect";return t}midpoint(){return this.begin.add(this.duration.div(qc(2)))}equals(e){return this.begin.equals(e.begin)&&this.end.equals(e.end)}show(){return this.begin.show()+" → "+this.end.show()}};const Zce=n=>n.filter(e=>e!=null);_s.prototype.sam=function(){return this.floor()};_s.prototype.nextSam=function(){return this.sam().add(1)};_s.prototype.wholeCycle=function(){return new Vce(this.sam(),this.nextSam())};_s.prototype.cyclePos=function(){return this.sub(this.sam())};_s.prototype.lt=function(n){return this.compare(n)<0};_s.prototype.gt=function(n){return this.compare(n)>0};_s.prototype.lte=function(n){return this.compare(n)<=0};_s.prototype.gte=function(n){return this.compare(n)>=0};_s.prototype.eq=function(n){return this.compare(n)==0};_s.prototype.ne=function(n){return this.compare(n)!=0};_s.prototype.max=function(n){return this.gt(n)?this:n};_s.prototype.maximum=function(...n){return n=n.map(e=>new _s(e)),n.reduce((e,t)=>t.max(e),this)};_s.prototype.min=function(n){return this.lt(n)?this:n};_s.prototype.mulmaybe=function(n){return n!==void 0?this.mul(n):void 0};_s.prototype.divmaybe=function(n){return n!==void 0?this.div(n):void 0};_s.prototype.addmaybe=function(n){return n!==void 0?this.add(n):void 0};_s.prototype.submaybe=function(n){return n!==void 0?this.sub(n):void 0};_s.prototype.show=function(){return this.s*this.n+"/"+this.d};_s.prototype.or=function(n){return this.eq(0)?n:this};const qc=n=>_s(n),zg=(...n)=>{if(n=Zce(n),n.length===0)return;const e=n.pop();return n.reduce((t,s)=>t===void 0||s===void 0?void 0:t.lcm(s),e)};qc._original=_s;const u6=3e-4,zce=(n,e)=>(t,s)=>{var i;const r=(i=n.source_[s].options_)==null?void 0:i.ops,a=t.__steps_source;if(r)for(const o of r)switch(o.type_){case"stretch":{const l=["fast","slow"],{type:c,amount:u}=o.arguments_;if(!l.includes(c))throw new Error(`mini: stretch: type must be one of ${l.join("|")} but got ${c}`);t=wg(t)[c](e(u));break}case"replicate":{const{amount:l}=o.arguments_;t=wg(t),t=t._repeatCycles(l)._fast(l);break}case"bjorklund":{o.arguments_.rotation?t=t.euclidRot(e(o.arguments_.pulse),e(o.arguments_.step),e(o.arguments_.rotation)):t=t.euclid(e(o.arguments_.pulse),e(o.arguments_.step));break}case"degradeBy":{t=wg(t)._degradeByWith(J7.early(u6*o.arguments_.seed),o.arguments_.amount??.5);break}case"tail":{const l=e(o.arguments_.element);t=t.fmap(c=>u=>Array.isArray(c)?[...c,u]:[c,u]).appLeft(l);break}case"range":{const l=e(o.arguments_.element);t=wg(t);const c=(u,h,d=1)=>Array.from({length:Math.abs(h-u)/d+1},(m,y)=>u<h?u+y*d:u-y*d);t=((u,h)=>u.squeezeBind(d=>h.bind(m=>K7(...c(d,m)))))(t,l);break}default:console.warn(`operator "${o.type_}" not implemented`)}return t.__steps_source=t.__steps_source||a,t};function h6(n,e,t,s=0){t==null||t(n);const r=a=>h6(a,e,t,s);switch(n.type_){case"pattern":{const a=n.source_.map(c=>r(c)).map(zce(n,r)),i=n.arguments_.alignment,o=a.filter(c=>c.__steps_source);let l;switch(i){case"stack":{l=km(...a),o.length&&(l._steps=zg(...o.map(c=>qc(c._steps))));break}case"polymeter_slowcat":{l=km(...a.map(c=>c._slow(c.__weight))),o.length&&(l._steps=zg(...o.map(c=>qc(c._steps))));break}case"polymeter":{const c=n.arguments_.stepsPerCycle?r(n.arguments_.stepsPerCycle).fmap(h=>Ap(h)):dO(Ap(a.length>0?a[0].__weight:1)),u=a.map(h=>h.fast(c.fmap(d=>d.div(h.__weight))));l=km(...u);break}case"rand":{l=JG(J7.early(u6*n.arguments_.seed).segment(1),a),o.length&&(l._steps=zg(...o.map(c=>qc(c._steps))));break}case"feet":{l=K7(...a);break}default:{if(n.source_.some(c=>{var u;return!!((u=c.options_)!=null&&u.weight)})){const c=n.source_.reduce((u,h)=>{var d;return u.add(((d=h.options_)==null?void 0:d.weight)||Ap(1))},Ap(0));l=YG(...n.source_.map((u,h)=>{var d;return[((d=u.options_)==null?void 0:d.weight)||Ap(1),a[h]]})),l.__weight=c,l._steps=c,o.length&&(l._steps=l._steps.mul(zg(...o.map(u=>qc(u._steps)))))}else l=KG(...a),l._steps=a.length;n.arguments_._steps&&(l.__steps_source=!0)}}return o.length&&(l.__steps_source=!0),l}case"element":return r(n.source_);case"atom":{if(n.source_==="~"||n.source_==="-")return Xx;if(!n.location_)return console.warn("no location for",n),n.source_;const a=isNaN(Number(n.source_))?n.source_:Number(n.source_);if(s===-1)return dO(a);const[i,o]=d6(e,n,s);return dO(a).withLoc(i,o)}case"stretch":return r(n.source_).slow(r(n.arguments_.amount));default:return console.warn(`node type "${n.type_}" not implemented -> returning silence`),Xx}}const d6=(n,e,t=0)=>{const{start:s,end:r}=e.location_,a=n==null?void 0:n.split("").slice(s.offset,r.offset).join(""),[i=0,o=0]=a?a.split(e.source_).map(l=>l.split("").filter(c=>c===" ").length):[];return[s.offset+i+t,r.offset-o+t]},qce=(n,e=0,t=n)=>{try{return Rce(n)}catch(s){const r=[s.location.start.offset+e,s.location.end.offset+e],a=t.slice(0,r[0]).split(`
`).length;throw new Error(`[mini] parse error at line ${a}: ${s.message}`)}},Uce=(n,e,t)=>{const s=qce(n,e,t);let r=[];return h6(s,n,a=>{a.type_==="atom"&&r.push(a)},-1),r},p6=(n,e=0,t)=>Uce(n,e,t).map(s=>d6(n,s,e));var Wce=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,78,5,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,199,7,137,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,55,9,266,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,233,0,3,0,8,1,6,0,475,6,110,6,6,9,4759,9,787719,239],m6=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,7,25,39,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,5,57,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,24,43,261,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,33,24,3,24,45,74,6,0,67,12,65,1,2,0,15,4,10,7381,42,31,98,114,8702,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,208,30,2,2,2,1,2,6,3,4,10,1,225,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4381,3,5773,3,7472,16,621,2467,541,1507,4938,6,8489],Gce="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-᫝᫠-᫫ᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",f6="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-࢏ࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚ౜ౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽ೜-ೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-Ƛ꟱-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",tw={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},nw="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Xce={5:nw,"5module":nw+" export import",6:nw+" const class extends export import super"},g6=/^in(stanceof)?$/,Hce=new RegExp("["+f6+"]"),Yce=new RegExp("["+f6+Gce+"]");function h2(n,e){for(var t=65536,s=0;s<e.length;s+=2){if(t+=e[s],t>n)return!1;if(t+=e[s+1],t>=n)return!0}return!1}function Nl(n,e){return n<65?n===36:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&Hce.test(String.fromCharCode(n)):e===!1?!1:h2(n,m6)}function gu(n,e){return n<48?n===36:n<58?!0:n<65?!1:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&Yce.test(String.fromCharCode(n)):e===!1?!1:h2(n,m6)||h2(n,Wce)}var ns=function(e,t){t===void 0&&(t={}),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function Ri(n,e){return new ns(n,{beforeExpr:!0,binop:e})}var Ii={beforeExpr:!0},Fa={startsExpr:!0},IP={};function Kn(n,e){return e===void 0&&(e={}),e.keyword=n,IP[n]=new ns(n,e)}var ie={num:new ns("num",Fa),regexp:new ns("regexp",Fa),string:new ns("string",Fa),name:new ns("name",Fa),privateId:new ns("privateId",Fa),eof:new ns("eof"),bracketL:new ns("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ns("]"),braceL:new ns("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ns("}"),parenL:new ns("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ns(")"),comma:new ns(",",Ii),semi:new ns(";",Ii),colon:new ns(":",Ii),dot:new ns("."),question:new ns("?",Ii),questionDot:new ns("?."),arrow:new ns("=>",Ii),template:new ns("template"),invalidTemplate:new ns("invalidTemplate"),ellipsis:new ns("...",Ii),backQuote:new ns("`",Fa),dollarBraceL:new ns("${",{beforeExpr:!0,startsExpr:!0}),eq:new ns("=",{beforeExpr:!0,isAssign:!0}),assign:new ns("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ns("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ns("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Ri("||",1),logicalAND:Ri("&&",2),bitwiseOR:Ri("|",3),bitwiseXOR:Ri("^",4),bitwiseAND:Ri("&",5),equality:Ri("==/!=/===/!==",6),relational:Ri("</>/<=/>=",7),bitShift:Ri("<</>>/>>>",8),plusMin:new ns("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Ri("%",10),star:Ri("*",10),slash:Ri("/",10),starstar:new ns("**",{beforeExpr:!0}),coalesce:Ri("??",1),_break:Kn("break"),_case:Kn("case",Ii),_catch:Kn("catch"),_continue:Kn("continue"),_debugger:Kn("debugger"),_default:Kn("default",Ii),_do:Kn("do",{isLoop:!0,beforeExpr:!0}),_else:Kn("else",Ii),_finally:Kn("finally"),_for:Kn("for",{isLoop:!0}),_function:Kn("function",Fa),_if:Kn("if"),_return:Kn("return",Ii),_switch:Kn("switch"),_throw:Kn("throw",Ii),_try:Kn("try"),_var:Kn("var"),_const:Kn("const"),_while:Kn("while",{isLoop:!0}),_with:Kn("with"),_new:Kn("new",{beforeExpr:!0,startsExpr:!0}),_this:Kn("this",Fa),_super:Kn("super",Fa),_class:Kn("class",Fa),_extends:Kn("extends",Ii),_export:Kn("export"),_import:Kn("import",Fa),_null:Kn("null",Fa),_true:Kn("true",Fa),_false:Kn("false",Fa),_in:Kn("in",{beforeExpr:!0,binop:7}),_instanceof:Kn("instanceof",{beforeExpr:!0,binop:7}),_typeof:Kn("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Kn("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Kn("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},oi=/\r\n?|\n|\u2028|\u2029/,Kce=new RegExp(oi.source,"g");function lp(n){return n===10||n===13||n===8232||n===8233}function b6(n,e,t){t===void 0&&(t=n.length);for(var s=e;s<t;s++){var r=n.charCodeAt(s);if(lp(r))return s<t-1&&r===13&&n.charCodeAt(s+1)===10?s+2:s+1}return-1}var y6=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,aa=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,v6=Object.prototype,Jce=v6.hasOwnProperty,eue=v6.toString,cp=Object.hasOwn||(function(n,e){return Jce.call(n,e)}),$5=Array.isArray||(function(n){return eue.call(n)==="[object Array]"}),N5=Object.create(null);function Uc(n){return N5[n]||(N5[n]=new RegExp("^(?:"+n.replace(/ /g,"|")+")$"))}function vc(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}var tue=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,uf=function(e,t){this.line=e,this.column=t};uf.prototype.offset=function(e){return new uf(this.line,this.column+e)};var uv=function(e,t,s){this.start=t,this.end=s,e.sourceFile!==null&&(this.source=e.sourceFile)};function O6(n,e){for(var t=1,s=0;;){var r=b6(n,s,e);if(r<0)return new uf(t,e-s);++t,s=r}}var d2={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},_5=!1;function nue(n){var e={};for(var t in d2)e[t]=n&&cp(n,t)?n[t]:d2[t];if(e.ecmaVersion==="latest"?e.ecmaVersion=1e8:e.ecmaVersion==null?(!_5&&typeof console=="object"&&console.warn&&(_5=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),e.allowReserved==null&&(e.allowReserved=e.ecmaVersion<5),(!n||n.allowHashBang==null)&&(e.allowHashBang=e.ecmaVersion>=14),$5(e.onToken)){var s=e.onToken;e.onToken=function(r){return s.push(r)}}if($5(e.onComment)&&(e.onComment=sue(e,e.onComment)),e.sourceType==="commonjs"&&e.allowAwaitOutsideFunction)throw new Error("Cannot use allowAwaitOutsideFunction with sourceType: commonjs");return e}function sue(n,e){return function(t,s,r,a,i,o){var l={type:t?"Block":"Line",value:s,start:r,end:a};n.locations&&(l.loc=new uv(this,i,o)),n.ranges&&(l.range=[r,a]),e.push(l)}}var yh=1,Ah=2,LP=4,w6=8,QP=16,x6=32,hv=64,k6=128,Eh=256,Kf=512,S6=1024,dv=yh|Ah|Eh;function jP(n,e){return Ah|(n?LP:0)|(e?w6:0)}var Sy=0,VP=1,Ac=2,C6=3,P6=4,A6=5,Er=function(e,t,s){this.options=e=nue(e),this.sourceFile=e.sourceFile,this.keywords=Uc(Xce[e.ecmaVersion>=6?6:e.sourceType==="module"?"5module":5]);var r="";e.allowReserved!==!0&&(r=tw[e.ecmaVersion>=6?6:e.ecmaVersion===5?5:3],e.sourceType==="module"&&(r+=" await")),this.reservedWords=Uc(r);var a=(r?r+" ":"")+tw.strict;this.reservedWordsStrict=Uc(a),this.reservedWordsStrictBind=Uc(a+" "+tw.strictBind),this.input=String(t),this.containsEsc=!1,s?(this.pos=s,this.lineStart=this.input.lastIndexOf(`
`,s-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(oi).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=ie.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=e.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&e.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(this.options.sourceType==="commonjs"?Ah:yh),this.regexpState=null,this.privateNameStack=[]},mo={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowReturn:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},allowUsing:{configurable:!0},inClassStaticBlock:{configurable:!0}};Er.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)};mo.inFunction.get=function(){return(this.currentVarScope().flags&Ah)>0};mo.inGenerator.get=function(){return(this.currentVarScope().flags&w6)>0};mo.inAsync.get=function(){return(this.currentVarScope().flags&LP)>0};mo.canAwait.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var e=this.scopeStack[n],t=e.flags;if(t&(Eh|Kf))return!1;if(t&Ah)return(t&LP)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};mo.allowReturn.get=function(){return!!(this.inFunction||this.options.allowReturnOutsideFunction&&this.currentVarScope().flags&yh)};mo.allowSuper.get=function(){var n=this.currentThisScope(),e=n.flags;return(e&hv)>0||this.options.allowSuperOutsideMethod};mo.allowDirectSuper.get=function(){return(this.currentThisScope().flags&k6)>0};mo.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};mo.allowNewDotTarget.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var e=this.scopeStack[n],t=e.flags;if(t&(Eh|Kf)||t&Ah&&!(t&QP))return!0}return!1};mo.allowUsing.get=function(){var n=this.currentScope(),e=n.flags;return!(e&S6||!this.inModule&&e&yh)};mo.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Eh)>0};Er.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var s=this,r=0;r<e.length;r++)s=e[r](s);return s};Er.parse=function(e,t){return new this(t,e).parse()};Er.parseExpressionAt=function(e,t,s){var r=new this(s,e,t);return r.nextToken(),r.parseExpression()};Er.tokenizer=function(e,t){return new this(t,e)};Object.defineProperties(Er.prototype,mo);var Ea=Er.prototype,rue=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Ea.strictDirective=function(n){if(this.options.ecmaVersion<5)return!1;for(;;){aa.lastIndex=n,n+=aa.exec(this.input)[0].length;var e=rue.exec(this.input.slice(n));if(!e)return!1;if((e[1]||e[2])==="use strict"){aa.lastIndex=n+e[0].length;var t=aa.exec(this.input),s=t.index+t[0].length,r=this.input.charAt(s);return r===";"||r==="}"||oi.test(t[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||r==="!"&&this.input.charAt(s+1)==="=")}n+=e[0].length,aa.lastIndex=n,n+=aa.exec(this.input)[0].length,this.input[n]===";"&&n++}};Ea.eat=function(n){return this.type===n?(this.next(),!0):!1};Ea.isContextual=function(n){return this.type===ie.name&&this.value===n&&!this.containsEsc};Ea.eatContextual=function(n){return this.isContextual(n)?(this.next(),!0):!1};Ea.expectContextual=function(n){this.eatContextual(n)||this.unexpected()};Ea.canInsertSemicolon=function(){return this.type===ie.eof||this.type===ie.braceR||oi.test(this.input.slice(this.lastTokEnd,this.start))};Ea.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Ea.semicolon=function(){!this.eat(ie.semi)&&!this.insertSemicolon()&&this.unexpected()};Ea.afterTrailingComma=function(n,e){if(this.type===n)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0};Ea.expect=function(n){this.eat(n)||this.unexpected()};Ea.unexpected=function(n){this.raise(n??this.start,"Unexpected token")};var pv=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Ea.checkPatternErrors=function(n,e){if(n){n.trailingComma>-1&&this.raiseRecoverable(n.trailingComma,"Comma is not permitted after the rest element");var t=e?n.parenthesizedAssign:n.parenthesizedBind;t>-1&&this.raiseRecoverable(t,e?"Assigning to rvalue":"Parenthesized pattern")}};Ea.checkExpressionErrors=function(n,e){if(!n)return!1;var t=n.shorthandAssign,s=n.doubleProto;if(!e)return t>=0||s>=0;t>=0&&this.raise(t,"Shorthand property assignments are valid only in destructuring patterns"),s>=0&&this.raiseRecoverable(s,"Redefinition of __proto__ property")};Ea.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Ea.isSimpleAssignTarget=function(n){return n.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(n.expression):n.type==="Identifier"||n.type==="MemberExpression"};var qt=Er.prototype;qt.parseTopLevel=function(n){var e=Object.create(null);for(n.body||(n.body=[]);this.type!==ie.eof;){var t=this.parseStatement(null,!0,e);n.body.push(t)}if(this.inModule)for(var s=0,r=Object.keys(this.undefinedExports);s<r.length;s+=1){var a=r[s];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(n.body),this.next(),n.sourceType=this.options.sourceType==="commonjs"?"script":this.options.sourceType,this.finishNode(n,"Program")};var ZP={kind:"loop"},aue={kind:"switch"};qt.isLet=function(n){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;aa.lastIndex=this.pos;var e=aa.exec(this.input),t=this.pos+e[0].length,s=this.fullCharCodeAt(t);if(s===91||s===92)return!0;if(n)return!1;if(s===123)return!0;if(Nl(s)){var r=t;do t+=s<=65535?1:2;while(gu(s=this.fullCharCodeAt(t)));if(s===92)return!0;var a=this.input.slice(r,t);if(!g6.test(a))return!0}return!1};qt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;aa.lastIndex=this.pos;var n=aa.exec(this.input),e=this.pos+n[0].length,t;return!oi.test(this.input.slice(this.pos,e))&&this.input.slice(e,e+8)==="function"&&(e+8===this.input.length||!(gu(t=this.fullCharCodeAt(e+8))||t===92))};qt.isUsingKeyword=function(n,e){if(this.options.ecmaVersion<17||!this.isContextual(n?"await":"using"))return!1;aa.lastIndex=this.pos;var t=aa.exec(this.input),s=this.pos+t[0].length;if(oi.test(this.input.slice(this.pos,s)))return!1;if(n){var r=s+5,a;if(this.input.slice(s,r)!=="using"||r===this.input.length||gu(a=this.fullCharCodeAt(r))||a===92)return!1;aa.lastIndex=r;var i=aa.exec(this.input);if(s=r+i[0].length,i&&oi.test(this.input.slice(r,s)))return!1}var o=this.fullCharCodeAt(s);if(!Nl(o)&&o!==92)return!1;var l=s;do s+=o<=65535?1:2;while(gu(o=this.fullCharCodeAt(s)));if(o===92)return!0;var c=this.input.slice(l,s);return!(g6.test(c)||e&&c==="of")};qt.isAwaitUsing=function(n){return this.isUsingKeyword(!0,n)};qt.isUsing=function(n){return this.isUsingKeyword(!1,n)};qt.parseStatement=function(n,e,t){var s=this.type,r=this.startNode(),a;switch(this.isLet(n)&&(s=ie._var,a="let"),s){case ie._break:case ie._continue:return this.parseBreakContinueStatement(r,s.keyword);case ie._debugger:return this.parseDebuggerStatement(r);case ie._do:return this.parseDoStatement(r);case ie._for:return this.parseForStatement(r);case ie._function:return n&&(this.strict||n!=="if"&&n!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(r,!1,!n);case ie._class:return n&&this.unexpected(),this.parseClass(r,!0);case ie._if:return this.parseIfStatement(r);case ie._return:return this.parseReturnStatement(r);case ie._switch:return this.parseSwitchStatement(r);case ie._throw:return this.parseThrowStatement(r);case ie._try:return this.parseTryStatement(r);case ie._const:case ie._var:return a=a||this.value,n&&a!=="var"&&this.unexpected(),this.parseVarStatement(r,a);case ie._while:return this.parseWhileStatement(r);case ie._with:return this.parseWithStatement(r);case ie.braceL:return this.parseBlock(!0,r);case ie.semi:return this.parseEmptyStatement(r);case ie._export:case ie._import:if(this.options.ecmaVersion>10&&s===ie._import){aa.lastIndex=this.pos;var i=aa.exec(this.input),o=this.pos+i[0].length,l=this.input.charCodeAt(o);if(l===40||l===46)return this.parseExpressionStatement(r,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),s===ie._import?this.parseImport(r):this.parseExport(r,t);default:if(this.isAsyncFunction())return n&&this.unexpected(),this.next(),this.parseFunctionStatement(r,!0,!n);var c=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(c)return this.allowUsing||this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script` or in the bare case statement"),c==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(r,!1,c),this.semicolon(),this.finishNode(r,"VariableDeclaration");var u=this.value,h=this.parseExpression();return s===ie.name&&h.type==="Identifier"&&this.eat(ie.colon)?this.parseLabeledStatement(r,u,h,n):this.parseExpressionStatement(r,h)}};qt.parseBreakContinueStatement=function(n,e){var t=e==="break";this.next(),this.eat(ie.semi)||this.insertSemicolon()?n.label=null:this.type!==ie.name?this.unexpected():(n.label=this.parseIdent(),this.semicolon());for(var s=0;s<this.labels.length;++s){var r=this.labels[s];if((n.label==null||r.name===n.label.name)&&(r.kind!=null&&(t||r.kind==="loop")||n.label&&t))break}return s===this.labels.length&&this.raise(n.start,"Unsyntactic "+e),this.finishNode(n,t?"BreakStatement":"ContinueStatement")};qt.parseDebuggerStatement=function(n){return this.next(),this.semicolon(),this.finishNode(n,"DebuggerStatement")};qt.parseDoStatement=function(n){return this.next(),this.labels.push(ZP),n.body=this.parseStatement("do"),this.labels.pop(),this.expect(ie._while),n.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(ie.semi):this.semicolon(),this.finishNode(n,"DoWhileStatement")};qt.parseForStatement=function(n){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(ZP),this.enterScope(0),this.expect(ie.parenL),this.type===ie.semi)return e>-1&&this.unexpected(e),this.parseFor(n,null);var t=this.isLet();if(this.type===ie._var||this.type===ie._const||t){var s=this.startNode(),r=t?"let":this.value;return this.next(),this.parseVar(s,!0,r),this.finishNode(s,"VariableDeclaration"),this.parseForAfterInit(n,s,e)}var a=this.isContextual("let"),i=!1,o=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(o){var l=this.startNode();return this.next(),o==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.parseVar(l,!0,o),this.finishNode(l,"VariableDeclaration"),this.parseForAfterInit(n,l,e)}var c=this.containsEsc,u=new pv,h=this.start,d=e>-1?this.parseExprSubscripts(u,"await"):this.parseExpression(!0,u);return this.type===ie._in||(i=this.options.ecmaVersion>=6&&this.isContextual("of"))?(e>-1?(this.type===ie._in&&this.unexpected(e),n.await=!0):i&&this.options.ecmaVersion>=8&&(d.start===h&&!c&&d.type==="Identifier"&&d.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(n.await=!1)),a&&i&&this.raise(d.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(d,!1,u),this.checkLValPattern(d),this.parseForIn(n,d)):(this.checkExpressionErrors(u,!0),e>-1&&this.unexpected(e),this.parseFor(n,d))};qt.parseForAfterInit=function(n,e,t){return(this.type===ie._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&e.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===ie._in?t>-1&&this.unexpected(t):n.await=t>-1),this.parseForIn(n,e)):(t>-1&&this.unexpected(t),this.parseFor(n,e))};qt.parseFunctionStatement=function(n,e,t){return this.next(),this.parseFunction(n,Fm|(t?0:p2),!1,e)};qt.parseIfStatement=function(n){return this.next(),n.test=this.parseParenExpression(),n.consequent=this.parseStatement("if"),n.alternate=this.eat(ie._else)?this.parseStatement("if"):null,this.finishNode(n,"IfStatement")};qt.parseReturnStatement=function(n){return this.allowReturn||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(ie.semi)||this.insertSemicolon()?n.argument=null:(n.argument=this.parseExpression(),this.semicolon()),this.finishNode(n,"ReturnStatement")};qt.parseSwitchStatement=function(n){this.next(),n.discriminant=this.parseParenExpression(),n.cases=[],this.expect(ie.braceL),this.labels.push(aue),this.enterScope(S6);for(var e,t=!1;this.type!==ie.braceR;)if(this.type===ie._case||this.type===ie._default){var s=this.type===ie._case;e&&this.finishNode(e,"SwitchCase"),n.cases.push(e=this.startNode()),e.consequent=[],this.next(),s?e.test=this.parseExpression():(t&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),t=!0,e.test=null),this.expect(ie.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(n,"SwitchStatement")};qt.parseThrowStatement=function(n){return this.next(),oi.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),n.argument=this.parseExpression(),this.semicolon(),this.finishNode(n,"ThrowStatement")};var iue=[];qt.parseCatchClauseParam=function(){var n=this.parseBindingAtom(),e=n.type==="Identifier";return this.enterScope(e?x6:0),this.checkLValPattern(n,e?P6:Ac),this.expect(ie.parenR),n};qt.parseTryStatement=function(n){if(this.next(),n.block=this.parseBlock(),n.handler=null,this.type===ie._catch){var e=this.startNode();this.next(),this.eat(ie.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),n.handler=this.finishNode(e,"CatchClause")}return n.finalizer=this.eat(ie._finally)?this.parseBlock():null,!n.handler&&!n.finalizer&&this.raise(n.start,"Missing catch or finally clause"),this.finishNode(n,"TryStatement")};qt.parseVarStatement=function(n,e,t){return this.next(),this.parseVar(n,!1,e,t),this.semicolon(),this.finishNode(n,"VariableDeclaration")};qt.parseWhileStatement=function(n){return this.next(),n.test=this.parseParenExpression(),this.labels.push(ZP),n.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(n,"WhileStatement")};qt.parseWithStatement=function(n){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),n.object=this.parseParenExpression(),n.body=this.parseStatement("with"),this.finishNode(n,"WithStatement")};qt.parseEmptyStatement=function(n){return this.next(),this.finishNode(n,"EmptyStatement")};qt.parseLabeledStatement=function(n,e,t,s){for(var r=0,a=this.labels;r<a.length;r+=1){var i=a[r];i.name===e&&this.raise(t.start,"Label '"+e+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===ie._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===n.start)c.statementStart=this.start,c.kind=o;else break}return this.labels.push({name:e,kind:o,statementStart:this.start}),n.body=this.parseStatement(s?s.indexOf("label")===-1?s+"label":s:"label"),this.labels.pop(),n.label=t,this.finishNode(n,"LabeledStatement")};qt.parseExpressionStatement=function(n,e){return n.expression=e,this.semicolon(),this.finishNode(n,"ExpressionStatement")};qt.parseBlock=function(n,e,t){for(n===void 0&&(n=!0),e===void 0&&(e=this.startNode()),e.body=[],this.expect(ie.braceL),n&&this.enterScope(0);this.type!==ie.braceR;){var s=this.parseStatement(null);e.body.push(s)}return t&&(this.strict=!1),this.next(),n&&this.exitScope(),this.finishNode(e,"BlockStatement")};qt.parseFor=function(n,e){return n.init=e,this.expect(ie.semi),n.test=this.type===ie.semi?null:this.parseExpression(),this.expect(ie.semi),n.update=this.type===ie.parenR?null:this.parseExpression(),this.expect(ie.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,"ForStatement")};qt.parseForIn=function(n,e){var t=this.type===ie._in;return this.next(),e.type==="VariableDeclaration"&&e.declarations[0].init!=null&&(!t||this.options.ecmaVersion<8||this.strict||e.kind!=="var"||e.declarations[0].id.type!=="Identifier")&&this.raise(e.start,(t?"for-in":"for-of")+" loop variable declaration may not have an initializer"),n.left=e,n.right=t?this.parseExpression():this.parseMaybeAssign(),this.expect(ie.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,t?"ForInStatement":"ForOfStatement")};qt.parseVar=function(n,e,t,s){for(n.declarations=[],n.kind=t;;){var r=this.startNode();if(this.parseVarId(r,t),this.eat(ie.eq)?r.init=this.parseMaybeAssign(e):!s&&t==="const"&&!(this.type===ie._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!s&&(t==="using"||t==="await using")&&this.options.ecmaVersion>=17&&this.type!==ie._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+t+" declaration"):!s&&r.id.type!=="Identifier"&&!(e&&(this.type===ie._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):r.init=null,n.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(ie.comma))break}return n};qt.parseVarId=function(n,e){n.id=e==="using"||e==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(n.id,e==="var"?VP:Ac,!1)};var Fm=1,p2=2,E6=4;qt.parseFunction=function(n,e,t,s,r){this.initFunction(n),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!s)&&(this.type===ie.star&&e&p2&&this.unexpected(),n.generator=this.eat(ie.star)),this.options.ecmaVersion>=8&&(n.async=!!s),e&Fm&&(n.id=e&E6&&this.type!==ie.name?null:this.parseIdent(),n.id&&!(e&p2)&&this.checkLValSimple(n.id,this.strict||n.generator||n.async?this.treatFunctionsAsVar?VP:Ac:C6));var a=this.yieldPos,i=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(jP(n.async,n.generator)),e&Fm||(n.id=this.type===ie.name?this.parseIdent():null),this.parseFunctionParams(n),this.parseFunctionBody(n,t,!1,r),this.yieldPos=a,this.awaitPos=i,this.awaitIdentPos=o,this.finishNode(n,e&Fm?"FunctionDeclaration":"FunctionExpression")};qt.parseFunctionParams=function(n){this.expect(ie.parenL),n.params=this.parseBindingList(ie.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};qt.parseClass=function(n,e){this.next();var t=this.strict;this.strict=!0,this.parseClassId(n,e),this.parseClassSuper(n);var s=this.enterClassBody(),r=this.startNode(),a=!1;for(r.body=[],this.expect(ie.braceL);this.type!==ie.braceR;){var i=this.parseClassElement(n.superClass!==null);i&&(r.body.push(i),i.type==="MethodDefinition"&&i.kind==="constructor"?(a&&this.raiseRecoverable(i.start,"Duplicate constructor in the same class"),a=!0):i.key&&i.key.type==="PrivateIdentifier"&&oue(s,i)&&this.raiseRecoverable(i.key.start,"Identifier '#"+i.key.name+"' has already been declared"))}return this.strict=t,this.next(),n.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(n,e?"ClassDeclaration":"ClassExpression")};qt.parseClassElement=function(n){if(this.eat(ie.semi))return null;var e=this.options.ecmaVersion,t=this.startNode(),s="",r=!1,a=!1,i="method",o=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(ie.braceL))return this.parseClassStaticBlock(t),t;this.isClassElementNameStart()||this.type===ie.star?o=!0:s="static"}if(t.static=o,!s&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===ie.star)&&!this.canInsertSemicolon()?a=!0:s="async"),!s&&(e>=9||!a)&&this.eat(ie.star)&&(r=!0),!s&&!a&&!r){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?i=l:s=l)}if(s?(t.computed=!1,t.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),t.key.name=s,this.finishNode(t.key,"Identifier")):this.parseClassElementName(t),e<13||this.type===ie.parenL||i!=="method"||r||a){var c=!t.static&&Cy(t,"constructor"),u=c&&n;c&&i!=="method"&&this.raise(t.key.start,"Constructor can't have get/set modifier"),t.kind=c?"constructor":i,this.parseClassMethod(t,r,a,u)}else this.parseClassField(t);return t};qt.isClassElementNameStart=function(){return this.type===ie.name||this.type===ie.privateId||this.type===ie.num||this.type===ie.string||this.type===ie.bracketL||this.type.keyword};qt.parseClassElementName=function(n){this.type===ie.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),n.computed=!1,n.key=this.parsePrivateIdent()):this.parsePropertyName(n)};qt.parseClassMethod=function(n,e,t,s){var r=n.key;n.kind==="constructor"?(e&&this.raise(r.start,"Constructor can't be a generator"),t&&this.raise(r.start,"Constructor can't be an async method")):n.static&&Cy(n,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var a=n.value=this.parseMethod(e,t,s);return n.kind==="get"&&a.params.length!==0&&this.raiseRecoverable(a.start,"getter should have no params"),n.kind==="set"&&a.params.length!==1&&this.raiseRecoverable(a.start,"setter should have exactly one param"),n.kind==="set"&&a.params[0].type==="RestElement"&&this.raiseRecoverable(a.params[0].start,"Setter cannot use rest params"),this.finishNode(n,"MethodDefinition")};qt.parseClassField=function(n){return Cy(n,"constructor")?this.raise(n.key.start,"Classes can't have a field named 'constructor'"):n.static&&Cy(n,"prototype")&&this.raise(n.key.start,"Classes can't have a static field named 'prototype'"),this.eat(ie.eq)?(this.enterScope(Kf|hv),n.value=this.parseMaybeAssign(),this.exitScope()):n.value=null,this.semicolon(),this.finishNode(n,"PropertyDefinition")};qt.parseClassStaticBlock=function(n){n.body=[];var e=this.labels;for(this.labels=[],this.enterScope(Eh|hv);this.type!==ie.braceR;){var t=this.parseStatement(null);n.body.push(t)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(n,"StaticBlock")};qt.parseClassId=function(n,e){this.type===ie.name?(n.id=this.parseIdent(),e&&this.checkLValSimple(n.id,Ac,!1)):(e===!0&&this.unexpected(),n.id=null)};qt.parseClassSuper=function(n){n.superClass=this.eat(ie._extends)?this.parseExprSubscripts(null,!1):null};qt.enterClassBody=function(){var n={declared:Object.create(null),used:[]};return this.privateNameStack.push(n),n.declared};qt.exitClassBody=function(){var n=this.privateNameStack.pop(),e=n.declared,t=n.used;if(this.options.checkPrivateFields)for(var s=this.privateNameStack.length,r=s===0?null:this.privateNameStack[s-1],a=0;a<t.length;++a){var i=t[a];cp(e,i.name)||(r?r.used.push(i):this.raiseRecoverable(i.start,"Private field '#"+i.name+"' must be declared in an enclosing class"))}};function oue(n,e){var t=e.key.name,s=n[t],r="true";return e.type==="MethodDefinition"&&(e.kind==="get"||e.kind==="set")&&(r=(e.static?"s":"i")+e.kind),s==="iget"&&r==="iset"||s==="iset"&&r==="iget"||s==="sget"&&r==="sset"||s==="sset"&&r==="sget"?(n[t]="true",!1):s?!0:(n[t]=r,!1)}function Cy(n,e){var t=n.computed,s=n.key;return!t&&(s.type==="Identifier"&&s.name===e||s.type==="Literal"&&s.value===e)}qt.parseExportAllDeclaration=function(n,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(n.exported=this.parseModuleExportName(),this.checkExport(e,n.exported,this.lastTokStart)):n.exported=null),this.expectContextual("from"),this.type!==ie.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ExportAllDeclaration")};qt.parseExport=function(n,e){if(this.next(),this.eat(ie.star))return this.parseExportAllDeclaration(n,e);if(this.eat(ie._default))return this.checkExport(e,"default",this.lastTokStart),n.declaration=this.parseExportDefaultDeclaration(),this.finishNode(n,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())n.declaration=this.parseExportDeclaration(n),n.declaration.type==="VariableDeclaration"?this.checkVariableExport(e,n.declaration.declarations):this.checkExport(e,n.declaration.id,n.declaration.id.start),n.specifiers=[],n.source=null,this.options.ecmaVersion>=16&&(n.attributes=[]);else{if(n.declaration=null,n.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==ie.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause());else{for(var t=0,s=n.specifiers;t<s.length;t+=1){var r=s[t];this.checkUnreserved(r.local),this.checkLocalExport(r.local),r.local.type==="Literal"&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}n.source=null,this.options.ecmaVersion>=16&&(n.attributes=[])}this.semicolon()}return this.finishNode(n,"ExportNamedDeclaration")};qt.parseExportDeclaration=function(n){return this.parseStatement(null)};qt.parseExportDefaultDeclaration=function(){var n;if(this.type===ie._function||(n=this.isAsyncFunction())){var e=this.startNode();return this.next(),n&&this.next(),this.parseFunction(e,Fm|E6,!1,n)}else if(this.type===ie._class){var t=this.startNode();return this.parseClass(t,"nullableID")}else{var s=this.parseMaybeAssign();return this.semicolon(),s}};qt.checkExport=function(n,e,t){n&&(typeof e!="string"&&(e=e.type==="Identifier"?e.name:e.value),cp(n,e)&&this.raiseRecoverable(t,"Duplicate export '"+e+"'"),n[e]=!0)};qt.checkPatternExport=function(n,e){var t=e.type;if(t==="Identifier")this.checkExport(n,e,e.start);else if(t==="ObjectPattern")for(var s=0,r=e.properties;s<r.length;s+=1){var a=r[s];this.checkPatternExport(n,a)}else if(t==="ArrayPattern")for(var i=0,o=e.elements;i<o.length;i+=1){var l=o[i];l&&this.checkPatternExport(n,l)}else t==="Property"?this.checkPatternExport(n,e.value):t==="AssignmentPattern"?this.checkPatternExport(n,e.left):t==="RestElement"&&this.checkPatternExport(n,e.argument)};qt.checkVariableExport=function(n,e){if(n)for(var t=0,s=e;t<s.length;t+=1){var r=s[t];this.checkPatternExport(n,r.id)}};qt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};qt.parseExportSpecifier=function(n){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(n,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")};qt.parseExportSpecifiers=function(n){var e=[],t=!0;for(this.expect(ie.braceL);!this.eat(ie.braceR);){if(t)t=!1;else if(this.expect(ie.comma),this.afterTrailingComma(ie.braceR))break;e.push(this.parseExportSpecifier(n))}return e};qt.parseImport=function(n){return this.next(),this.type===ie.string?(n.specifiers=iue,n.source=this.parseExprAtom()):(n.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),n.source=this.type===ie.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ImportDeclaration")};qt.parseImportSpecifier=function(){var n=this.startNode();return n.imported=this.parseModuleExportName(),this.eatContextual("as")?n.local=this.parseIdent():(this.checkUnreserved(n.imported),n.local=n.imported),this.checkLValSimple(n.local,Ac),this.finishNode(n,"ImportSpecifier")};qt.parseImportDefaultSpecifier=function(){var n=this.startNode();return n.local=this.parseIdent(),this.checkLValSimple(n.local,Ac),this.finishNode(n,"ImportDefaultSpecifier")};qt.parseImportNamespaceSpecifier=function(){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLValSimple(n.local,Ac),this.finishNode(n,"ImportNamespaceSpecifier")};qt.parseImportSpecifiers=function(){var n=[],e=!0;if(this.type===ie.name&&(n.push(this.parseImportDefaultSpecifier()),!this.eat(ie.comma)))return n;if(this.type===ie.star)return n.push(this.parseImportNamespaceSpecifier()),n;for(this.expect(ie.braceL);!this.eat(ie.braceR);){if(e)e=!1;else if(this.expect(ie.comma),this.afterTrailingComma(ie.braceR))break;n.push(this.parseImportSpecifier())}return n};qt.parseWithClause=function(){var n=[];if(!this.eat(ie._with))return n;this.expect(ie.braceL);for(var e={},t=!0;!this.eat(ie.braceR);){if(t)t=!1;else if(this.expect(ie.comma),this.afterTrailingComma(ie.braceR))break;var s=this.parseImportAttribute(),r=s.key.type==="Identifier"?s.key.name:s.key.value;cp(e,r)&&this.raiseRecoverable(s.key.start,"Duplicate attribute key '"+r+"'"),e[r]=!0,n.push(s)}return n};qt.parseImportAttribute=function(){var n=this.startNode();return n.key=this.type===ie.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(ie.colon),this.type!==ie.string&&this.unexpected(),n.value=this.parseExprAtom(),this.finishNode(n,"ImportAttribute")};qt.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===ie.string){var n=this.parseLiteral(this.value);return tue.test(n.value)&&this.raise(n.start,"An export name cannot include a lone surrogate."),n}return this.parseIdent(!0)};qt.adaptDirectivePrologue=function(n){for(var e=0;e<n.length&&this.isDirectiveCandidate(n[e]);++e)n[e].directive=n[e].expression.raw.slice(1,-1)};qt.isDirectiveCandidate=function(n){return this.options.ecmaVersion>=5&&n.type==="ExpressionStatement"&&n.expression.type==="Literal"&&typeof n.expression.value=="string"&&(this.input[n.start]==='"'||this.input[n.start]==="'")};var fo=Er.prototype;fo.toAssignable=function(n,e,t){if(this.options.ecmaVersion>=6&&n)switch(n.type){case"Identifier":this.inAsync&&n.name==="await"&&this.raise(n.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":n.type="ObjectPattern",t&&this.checkPatternErrors(t,!0);for(var s=0,r=n.properties;s<r.length;s+=1){var a=r[s];this.toAssignable(a,e),a.type==="RestElement"&&(a.argument.type==="ArrayPattern"||a.argument.type==="ObjectPattern")&&this.raise(a.argument.start,"Unexpected token")}break;case"Property":n.kind!=="init"&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,e);break;case"ArrayExpression":n.type="ArrayPattern",t&&this.checkPatternErrors(t,!0),this.toAssignableList(n.elements,e);break;case"SpreadElement":n.type="RestElement",this.toAssignable(n.argument,e),n.argument.type==="AssignmentPattern"&&this.raise(n.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":n.operator!=="="&&this.raise(n.left.end,"Only '=' operator can be used for specifying default value."),n.type="AssignmentPattern",delete n.operator,this.toAssignable(n.left,e);break;case"ParenthesizedExpression":this.toAssignable(n.expression,e,t);break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(n.start,"Assigning to rvalue")}else t&&this.checkPatternErrors(t,!0);return n};fo.toAssignableList=function(n,e){for(var t=n.length,s=0;s<t;s++){var r=n[s];r&&this.toAssignable(r,e)}if(t){var a=n[t-1];this.options.ecmaVersion===6&&e&&a&&a.type==="RestElement"&&a.argument.type!=="Identifier"&&this.unexpected(a.argument.start)}return n};fo.parseSpread=function(n){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,n),this.finishNode(e,"SpreadElement")};fo.parseRestBinding=function(){var n=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==ie.name&&this.unexpected(),n.argument=this.parseBindingAtom(),this.finishNode(n,"RestElement")};fo.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case ie.bracketL:var n=this.startNode();return this.next(),n.elements=this.parseBindingList(ie.bracketR,!0,!0),this.finishNode(n,"ArrayPattern");case ie.braceL:return this.parseObj(!0)}return this.parseIdent()};fo.parseBindingList=function(n,e,t,s){for(var r=[],a=!0;!this.eat(n);)if(a?a=!1:this.expect(ie.comma),e&&this.type===ie.comma)r.push(null);else{if(t&&this.afterTrailingComma(n))break;if(this.type===ie.ellipsis){var i=this.parseRestBinding();this.parseBindingListItem(i),r.push(i),this.type===ie.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(n);break}else r.push(this.parseAssignableListItem(s))}return r};fo.parseAssignableListItem=function(n){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e};fo.parseBindingListItem=function(n){return n};fo.parseMaybeDefault=function(n,e,t){if(t=t||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(ie.eq))return t;var s=this.startNodeAt(n,e);return s.left=t,s.right=this.parseMaybeAssign(),this.finishNode(s,"AssignmentPattern")};fo.checkLValSimple=function(n,e,t){e===void 0&&(e=Sy);var s=e!==Sy;switch(n.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(n.name)&&this.raiseRecoverable(n.start,(s?"Binding ":"Assigning to ")+n.name+" in strict mode"),s&&(e===Ac&&n.name==="let"&&this.raiseRecoverable(n.start,"let is disallowed as a lexically bound name"),t&&(cp(t,n.name)&&this.raiseRecoverable(n.start,"Argument name clash"),t[n.name]=!0),e!==A6&&this.declareName(n.name,e,n.start));break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":s&&this.raiseRecoverable(n.start,"Binding member expression");break;case"ParenthesizedExpression":return s&&this.raiseRecoverable(n.start,"Binding parenthesized expression"),this.checkLValSimple(n.expression,e,t);default:this.raise(n.start,(s?"Binding":"Assigning to")+" rvalue")}};fo.checkLValPattern=function(n,e,t){switch(e===void 0&&(e=Sy),n.type){case"ObjectPattern":for(var s=0,r=n.properties;s<r.length;s+=1){var a=r[s];this.checkLValInnerPattern(a,e,t)}break;case"ArrayPattern":for(var i=0,o=n.elements;i<o.length;i+=1){var l=o[i];l&&this.checkLValInnerPattern(l,e,t)}break;default:this.checkLValSimple(n,e,t)}};fo.checkLValInnerPattern=function(n,e,t){switch(e===void 0&&(e=Sy),n.type){case"Property":this.checkLValInnerPattern(n.value,e,t);break;case"AssignmentPattern":this.checkLValPattern(n.left,e,t);break;case"RestElement":this.checkLValPattern(n.argument,e,t);break;default:this.checkLValPattern(n,e,t)}};var Ao=function(e,t,s,r,a){this.token=e,this.isExpr=!!t,this.preserveSpace=!!s,this.override=r,this.generator=!!a},Vs={b_stat:new Ao("{",!1),b_expr:new Ao("{",!0),b_tmpl:new Ao("${",!1),p_stat:new Ao("(",!1),p_expr:new Ao("(",!0),q_tmpl:new Ao("`",!0,!0,function(n){return n.tryReadTemplateToken()}),f_stat:new Ao("function",!1),f_expr:new Ao("function",!0),f_expr_gen:new Ao("function",!0,!1,null,!0),f_gen:new Ao("function",!1,!1,null,!0)},up=Er.prototype;up.initialContext=function(){return[Vs.b_stat]};up.curContext=function(){return this.context[this.context.length-1]};up.braceIsBlock=function(n){var e=this.curContext();return e===Vs.f_expr||e===Vs.f_stat?!0:n===ie.colon&&(e===Vs.b_stat||e===Vs.b_expr)?!e.isExpr:n===ie._return||n===ie.name&&this.exprAllowed?oi.test(this.input.slice(this.lastTokEnd,this.start)):n===ie._else||n===ie.semi||n===ie.eof||n===ie.parenR||n===ie.arrow?!0:n===ie.braceL?e===Vs.b_stat:n===ie._var||n===ie._const||n===ie.name?!1:!this.exprAllowed};up.inGeneratorContext=function(){for(var n=this.context.length-1;n>=1;n--){var e=this.context[n];if(e.token==="function")return e.generator}return!1};up.updateContext=function(n){var e,t=this.type;t.keyword&&n===ie.dot?this.exprAllowed=!1:(e=t.updateContext)?e.call(this,n):this.exprAllowed=t.beforeExpr};up.overrideContext=function(n){this.curContext()!==n&&(this.context[this.context.length-1]=n)};ie.parenR.updateContext=ie.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var n=this.context.pop();n===Vs.b_stat&&this.curContext().token==="function"&&(n=this.context.pop()),this.exprAllowed=!n.isExpr};ie.braceL.updateContext=function(n){this.context.push(this.braceIsBlock(n)?Vs.b_stat:Vs.b_expr),this.exprAllowed=!0};ie.dollarBraceL.updateContext=function(){this.context.push(Vs.b_tmpl),this.exprAllowed=!0};ie.parenL.updateContext=function(n){var e=n===ie._if||n===ie._for||n===ie._with||n===ie._while;this.context.push(e?Vs.p_stat:Vs.p_expr),this.exprAllowed=!0};ie.incDec.updateContext=function(){};ie._function.updateContext=ie._class.updateContext=function(n){n.beforeExpr&&n!==ie._else&&!(n===ie.semi&&this.curContext()!==Vs.p_stat)&&!(n===ie._return&&oi.test(this.input.slice(this.lastTokEnd,this.start)))&&!((n===ie.colon||n===ie.braceL)&&this.curContext()===Vs.b_stat)?this.context.push(Vs.f_expr):this.context.push(Vs.f_stat),this.exprAllowed=!1};ie.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};ie.backQuote.updateContext=function(){this.curContext()===Vs.q_tmpl?this.context.pop():this.context.push(Vs.q_tmpl),this.exprAllowed=!1};ie.star.updateContext=function(n){if(n===ie._function){var e=this.context.length-1;this.context[e]===Vs.f_expr?this.context[e]=Vs.f_expr_gen:this.context[e]=Vs.f_gen}this.exprAllowed=!0};ie.name.updateContext=function(n){var e=!1;this.options.ecmaVersion>=6&&n!==ie.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var yn=Er.prototype;yn.checkPropClash=function(n,e,t){if(!(this.options.ecmaVersion>=9&&n.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(n.computed||n.method||n.shorthand))){var s=n.key,r;switch(s.type){case"Identifier":r=s.name;break;case"Literal":r=String(s.value);break;default:return}var a=n.kind;if(this.options.ecmaVersion>=6){r==="__proto__"&&a==="init"&&(e.proto&&(t?t.doubleProto<0&&(t.doubleProto=s.start):this.raiseRecoverable(s.start,"Redefinition of __proto__ property")),e.proto=!0);return}r="$"+r;var i=e[r];if(i){var o;a==="init"?o=this.strict&&i.init||i.get||i.set:o=i.init||i[a],o&&this.raiseRecoverable(s.start,"Redefinition of property")}else i=e[r]={init:!1,get:!1,set:!1};i[a]=!0}};yn.parseExpression=function(n,e){var t=this.start,s=this.startLoc,r=this.parseMaybeAssign(n,e);if(this.type===ie.comma){var a=this.startNodeAt(t,s);for(a.expressions=[r];this.eat(ie.comma);)a.expressions.push(this.parseMaybeAssign(n,e));return this.finishNode(a,"SequenceExpression")}return r};yn.parseMaybeAssign=function(n,e,t){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(n);this.exprAllowed=!1}var s=!1,r=-1,a=-1,i=-1;e?(r=e.parenthesizedAssign,a=e.trailingComma,i=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new pv,s=!0);var o=this.start,l=this.startLoc;(this.type===ie.parenL||this.type===ie.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=n==="await");var c=this.parseMaybeConditional(n,e);if(t&&(c=t.call(this,c,o,l)),this.type.isAssign){var u=this.startNodeAt(o,l);return u.operator=this.value,this.type===ie.eq&&(c=this.toAssignable(c,!1,e)),s||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=c.start&&(e.shorthandAssign=-1),this.type===ie.eq?this.checkLValPattern(c):this.checkLValSimple(c),u.left=c,this.next(),u.right=this.parseMaybeAssign(n),i>-1&&(e.doubleProto=i),this.finishNode(u,"AssignmentExpression")}else s&&this.checkExpressionErrors(e,!0);return r>-1&&(e.parenthesizedAssign=r),a>-1&&(e.trailingComma=a),c};yn.parseMaybeConditional=function(n,e){var t=this.start,s=this.startLoc,r=this.parseExprOps(n,e);if(this.checkExpressionErrors(e))return r;if(this.eat(ie.question)){var a=this.startNodeAt(t,s);return a.test=r,a.consequent=this.parseMaybeAssign(),this.expect(ie.colon),a.alternate=this.parseMaybeAssign(n),this.finishNode(a,"ConditionalExpression")}return r};yn.parseExprOps=function(n,e){var t=this.start,s=this.startLoc,r=this.parseMaybeUnary(e,!1,!1,n);return this.checkExpressionErrors(e)||r.start===t&&r.type==="ArrowFunctionExpression"?r:this.parseExprOp(r,t,s,-1,n)};yn.parseExprOp=function(n,e,t,s,r){var a=this.type.binop;if(a!=null&&(!r||this.type!==ie._in)&&a>s){var i=this.type===ie.logicalOR||this.type===ie.logicalAND,o=this.type===ie.coalesce;o&&(a=ie.logicalAND.binop);var l=this.value;this.next();var c=this.start,u=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),c,u,a,r),d=this.buildBinary(e,t,n,h,l,i||o);return(i&&this.type===ie.coalesce||o&&(this.type===ie.logicalOR||this.type===ie.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,e,t,s,r)}return n};yn.buildBinary=function(n,e,t,s,r,a){s.type==="PrivateIdentifier"&&this.raise(s.start,"Private identifier can only be left side of binary expression");var i=this.startNodeAt(n,e);return i.left=t,i.operator=r,i.right=s,this.finishNode(i,a?"LogicalExpression":"BinaryExpression")};yn.parseMaybeUnary=function(n,e,t,s){var r=this.start,a=this.startLoc,i;if(this.isContextual("await")&&this.canAwait)i=this.parseAwait(s),e=!0;else if(this.type.prefix){var o=this.startNode(),l=this.type===ie.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0,l,s),this.checkExpressionErrors(n,!0),l?this.checkLValSimple(o.argument):this.strict&&o.operator==="delete"&&M6(o.argument)?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):o.operator==="delete"&&m2(o.argument)?this.raiseRecoverable(o.start,"Private fields can not be deleted"):e=!0,i=this.finishNode(o,l?"UpdateExpression":"UnaryExpression")}else if(!e&&this.type===ie.privateId)(s||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),i=this.parsePrivateIdent(),this.type!==ie._in&&this.unexpected();else{if(i=this.parseExprSubscripts(n,s),this.checkExpressionErrors(n))return i;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(r,a);c.operator=this.value,c.prefix=!1,c.argument=i,this.checkLValSimple(i),this.next(),i=this.finishNode(c,"UpdateExpression")}}if(!t&&this.eat(ie.starstar))if(e)this.unexpected(this.lastTokStart);else return this.buildBinary(r,a,i,this.parseMaybeUnary(null,!1,!1,s),"**",!1);else return i};function M6(n){return n.type==="Identifier"||n.type==="ParenthesizedExpression"&&M6(n.expression)}function m2(n){return n.type==="MemberExpression"&&n.property.type==="PrivateIdentifier"||n.type==="ChainExpression"&&m2(n.expression)||n.type==="ParenthesizedExpression"&&m2(n.expression)}yn.parseExprSubscripts=function(n,e){var t=this.start,s=this.startLoc,r=this.parseExprAtom(n,e);if(r.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return r;var a=this.parseSubscripts(r,t,s,!1,e);return n&&a.type==="MemberExpression"&&(n.parenthesizedAssign>=a.start&&(n.parenthesizedAssign=-1),n.parenthesizedBind>=a.start&&(n.parenthesizedBind=-1),n.trailingComma>=a.start&&(n.trailingComma=-1)),a};yn.parseSubscripts=function(n,e,t,s,r){for(var a=this.options.ecmaVersion>=8&&n.type==="Identifier"&&n.name==="async"&&this.lastTokEnd===n.end&&!this.canInsertSemicolon()&&n.end-n.start===5&&this.potentialArrowAt===n.start,i=!1;;){var o=this.parseSubscript(n,e,t,s,a,i,r);if(o.optional&&(i=!0),o===n||o.type==="ArrowFunctionExpression"){if(i){var l=this.startNodeAt(e,t);l.expression=o,o=this.finishNode(l,"ChainExpression")}return o}n=o}};yn.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(ie.arrow)};yn.parseSubscriptAsyncArrow=function(n,e,t,s){return this.parseArrowExpression(this.startNodeAt(n,e),t,!0,s)};yn.parseSubscript=function(n,e,t,s,r,a,i){var o=this.options.ecmaVersion>=11,l=o&&this.eat(ie.questionDot);s&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(ie.bracketL);if(c||l&&this.type!==ie.parenL&&this.type!==ie.backQuote||this.eat(ie.dot)){var u=this.startNodeAt(e,t);u.object=n,c?(u.property=this.parseExpression(),this.expect(ie.bracketR)):this.type===ie.privateId&&n.type!=="Super"?u.property=this.parsePrivateIdent():u.property=this.parseIdent(this.options.allowReserved!=="never"),u.computed=!!c,o&&(u.optional=l),n=this.finishNode(u,"MemberExpression")}else if(!s&&this.eat(ie.parenL)){var h=new pv,d=this.yieldPos,m=this.awaitPos,y=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var O=this.parseExprList(ie.parenR,this.options.ecmaVersion>=8,!1,h);if(r&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=d,this.awaitPos=m,this.awaitIdentPos=y,this.parseSubscriptAsyncArrow(e,t,O,i);this.checkExpressionErrors(h,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=m||this.awaitPos,this.awaitIdentPos=y||this.awaitIdentPos;var S=this.startNodeAt(e,t);S.callee=n,S.arguments=O,o&&(S.optional=l),n=this.finishNode(S,"CallExpression")}else if(this.type===ie.backQuote){(l||a)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var A=this.startNodeAt(e,t);A.tag=n,A.quasi=this.parseTemplate({isTagged:!0}),n=this.finishNode(A,"TaggedTemplateExpression")}return n};yn.parseExprAtom=function(n,e,t){this.type===ie.slash&&this.readRegexp();var s,r=this.potentialArrowAt===this.start;switch(this.type){case ie._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),s=this.startNode(),this.next(),this.type===ie.parenL&&!this.allowDirectSuper&&this.raise(s.start,"super() call outside constructor of a subclass"),this.type!==ie.dot&&this.type!==ie.bracketL&&this.type!==ie.parenL&&this.unexpected(),this.finishNode(s,"Super");case ie._this:return s=this.startNode(),this.next(),this.finishNode(s,"ThisExpression");case ie.name:var a=this.start,i=this.startLoc,o=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!o&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(ie._function))return this.overrideContext(Vs.f_expr),this.parseFunction(this.startNodeAt(a,i),0,!1,!0,e);if(r&&!this.canInsertSemicolon()){if(this.eat(ie.arrow))return this.parseArrowExpression(this.startNodeAt(a,i),[l],!1,e);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===ie.name&&!o&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(ie.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(a,i),[l],!0,e)}return l;case ie.regexp:var c=this.value;return s=this.parseLiteral(c.value),s.regex={pattern:c.pattern,flags:c.flags},s;case ie.num:case ie.string:return this.parseLiteral(this.value);case ie._null:case ie._true:case ie._false:return s=this.startNode(),s.value=this.type===ie._null?null:this.type===ie._true,s.raw=this.type.keyword,this.next(),this.finishNode(s,"Literal");case ie.parenL:var u=this.start,h=this.parseParenAndDistinguishExpression(r,e);return n&&(n.parenthesizedAssign<0&&!this.isSimpleAssignTarget(h)&&(n.parenthesizedAssign=u),n.parenthesizedBind<0&&(n.parenthesizedBind=u)),h;case ie.bracketL:return s=this.startNode(),this.next(),s.elements=this.parseExprList(ie.bracketR,!0,!0,n),this.finishNode(s,"ArrayExpression");case ie.braceL:return this.overrideContext(Vs.b_expr),this.parseObj(!1,n);case ie._function:return s=this.startNode(),this.next(),this.parseFunction(s,0);case ie._class:return this.parseClass(this.startNode(),!1);case ie._new:return this.parseNew();case ie.backQuote:return this.parseTemplate();case ie._import:return this.options.ecmaVersion>=11?this.parseExprImport(t):this.unexpected();default:return this.parseExprAtomDefault()}};yn.parseExprAtomDefault=function(){this.unexpected()};yn.parseExprImport=function(n){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===ie.parenL&&!n)return this.parseDynamicImport(e);if(this.type===ie.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);return t.name="import",e.meta=this.finishNode(t,"Identifier"),this.parseImportMeta(e)}else this.unexpected()};yn.parseDynamicImport=function(n){if(this.next(),n.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(ie.parenR)?n.options=null:(this.expect(ie.comma),this.afterTrailingComma(ie.parenR)?n.options=null:(n.options=this.parseMaybeAssign(),this.eat(ie.parenR)||(this.expect(ie.comma),this.afterTrailingComma(ie.parenR)||this.unexpected())));else if(!this.eat(ie.parenR)){var e=this.start;this.eat(ie.comma)&&this.eat(ie.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(n,"ImportExpression")};yn.parseImportMeta=function(n){this.next();var e=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="meta"&&this.raiseRecoverable(n.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(n.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(n.start,"Cannot use 'import.meta' outside a module"),this.finishNode(n,"MetaProperty")};yn.parseLiteral=function(n){var e=this.startNode();return e.value=n,e.raw=this.input.slice(this.start,this.end),e.raw.charCodeAt(e.raw.length-1)===110&&(e.bigint=e.value!=null?e.value.toString():e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")};yn.parseParenExpression=function(){this.expect(ie.parenL);var n=this.parseExpression();return this.expect(ie.parenR),n};yn.shouldParseArrow=function(n){return!this.canInsertSemicolon()};yn.parseParenAndDistinguishExpression=function(n,e){var t=this.start,s=this.startLoc,r,a=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var i=this.start,o=this.startLoc,l=[],c=!0,u=!1,h=new pv,d=this.yieldPos,m=this.awaitPos,y;for(this.yieldPos=0,this.awaitPos=0;this.type!==ie.parenR;)if(c?c=!1:this.expect(ie.comma),a&&this.afterTrailingComma(ie.parenR,!0)){u=!0;break}else if(this.type===ie.ellipsis){y=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===ie.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,h,this.parseParenItem));var O=this.lastTokEnd,S=this.lastTokEndLoc;if(this.expect(ie.parenR),n&&this.shouldParseArrow(l)&&this.eat(ie.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=m,this.parseParenArrowList(t,s,l,e);(!l.length||u)&&this.unexpected(this.lastTokStart),y&&this.unexpected(y),this.checkExpressionErrors(h,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=m||this.awaitPos,l.length>1?(r=this.startNodeAt(i,o),r.expressions=l,this.finishNodeAt(r,"SequenceExpression",O,S)):r=l[0]}else r=this.parseParenExpression();if(this.options.preserveParens){var A=this.startNodeAt(t,s);return A.expression=r,this.finishNode(A,"ParenthesizedExpression")}else return r};yn.parseParenItem=function(n){return n};yn.parseParenArrowList=function(n,e,t,s){return this.parseArrowExpression(this.startNodeAt(n,e),t,!1,s)};var lue=[];yn.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var n=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===ie.dot){var e=this.startNodeAt(n.start,n.loc&&n.loc.start);e.name="new",n.meta=this.finishNode(e,"Identifier"),this.next();var t=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="target"&&this.raiseRecoverable(n.property.start,"The only valid meta property for new is 'new.target'"),t&&this.raiseRecoverable(n.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(n.start,"'new.target' can only be used in functions and class static block"),this.finishNode(n,"MetaProperty")}var s=this.start,r=this.startLoc;return n.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),s,r,!0,!1),this.eat(ie.parenL)?n.arguments=this.parseExprList(ie.parenR,this.options.ecmaVersion>=8,!1):n.arguments=lue,this.finishNode(n,"NewExpression")};yn.parseTemplateElement=function(n){var e=n.isTagged,t=this.startNode();return this.type===ie.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),t.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),t.tail=this.type===ie.backQuote,this.finishNode(t,"TemplateElement")};yn.parseTemplate=function(n){n===void 0&&(n={});var e=n.isTagged;e===void 0&&(e=!1);var t=this.startNode();this.next(),t.expressions=[];var s=this.parseTemplateElement({isTagged:e});for(t.quasis=[s];!s.tail;)this.type===ie.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(ie.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(ie.braceR),t.quasis.push(s=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(t,"TemplateLiteral")};yn.isAsyncProp=function(n){return!n.computed&&n.key.type==="Identifier"&&n.key.name==="async"&&(this.type===ie.name||this.type===ie.num||this.type===ie.string||this.type===ie.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===ie.star)&&!oi.test(this.input.slice(this.lastTokEnd,this.start))};yn.parseObj=function(n,e){var t=this.startNode(),s=!0,r={};for(t.properties=[],this.next();!this.eat(ie.braceR);){if(s)s=!1;else if(this.expect(ie.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(ie.braceR))break;var a=this.parseProperty(n,e);n||this.checkPropClash(a,r,e),t.properties.push(a)}return this.finishNode(t,n?"ObjectPattern":"ObjectExpression")};yn.parseProperty=function(n,e){var t=this.startNode(),s,r,a,i;if(this.options.ecmaVersion>=9&&this.eat(ie.ellipsis))return n?(t.argument=this.parseIdent(!1),this.type===ie.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(t,"RestElement")):(t.argument=this.parseMaybeAssign(!1,e),this.type===ie.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(t,"SpreadElement"));this.options.ecmaVersion>=6&&(t.method=!1,t.shorthand=!1,(n||e)&&(a=this.start,i=this.startLoc),n||(s=this.eat(ie.star)));var o=this.containsEsc;return this.parsePropertyName(t),!n&&!o&&this.options.ecmaVersion>=8&&!s&&this.isAsyncProp(t)?(r=!0,s=this.options.ecmaVersion>=9&&this.eat(ie.star),this.parsePropertyName(t)):r=!1,this.parsePropertyValue(t,n,s,r,a,i,e,o),this.finishNode(t,"Property")};yn.parseGetterSetter=function(n){var e=n.key.name;this.parsePropertyName(n),n.value=this.parseMethod(!1),n.kind=e;var t=n.kind==="get"?0:1;if(n.value.params.length!==t){var s=n.value.start;n.kind==="get"?this.raiseRecoverable(s,"getter should have no params"):this.raiseRecoverable(s,"setter should have exactly one param")}else n.kind==="set"&&n.value.params[0].type==="RestElement"&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params")};yn.parsePropertyValue=function(n,e,t,s,r,a,i,o){(t||s)&&this.type===ie.colon&&this.unexpected(),this.eat(ie.colon)?(n.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,i),n.kind="init"):this.options.ecmaVersion>=6&&this.type===ie.parenL?(e&&this.unexpected(),n.method=!0,n.value=this.parseMethod(t,s),n.kind="init"):!e&&!o&&this.options.ecmaVersion>=5&&!n.computed&&n.key.type==="Identifier"&&(n.key.name==="get"||n.key.name==="set")&&this.type!==ie.comma&&this.type!==ie.braceR&&this.type!==ie.eq?((t||s)&&this.unexpected(),this.parseGetterSetter(n)):this.options.ecmaVersion>=6&&!n.computed&&n.key.type==="Identifier"?((t||s)&&this.unexpected(),this.checkUnreserved(n.key),n.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=r),e?n.value=this.parseMaybeDefault(r,a,this.copyNode(n.key)):this.type===ie.eq&&i?(i.shorthandAssign<0&&(i.shorthandAssign=this.start),n.value=this.parseMaybeDefault(r,a,this.copyNode(n.key))):n.value=this.copyNode(n.key),n.kind="init",n.shorthand=!0):this.unexpected()};yn.parsePropertyName=function(n){if(this.options.ecmaVersion>=6){if(this.eat(ie.bracketL))return n.computed=!0,n.key=this.parseMaybeAssign(),this.expect(ie.bracketR),n.key;n.computed=!1}return n.key=this.type===ie.num||this.type===ie.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};yn.initFunction=function(n){n.id=null,this.options.ecmaVersion>=6&&(n.generator=n.expression=!1),this.options.ecmaVersion>=8&&(n.async=!1)};yn.parseMethod=function(n,e,t){var s=this.startNode(),r=this.yieldPos,a=this.awaitPos,i=this.awaitIdentPos;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=n),this.options.ecmaVersion>=8&&(s.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(jP(e,s.generator)|hv|(t?k6:0)),this.expect(ie.parenL),s.params=this.parseBindingList(ie.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(s,!1,!0,!1),this.yieldPos=r,this.awaitPos=a,this.awaitIdentPos=i,this.finishNode(s,"FunctionExpression")};yn.parseArrowExpression=function(n,e,t,s){var r=this.yieldPos,a=this.awaitPos,i=this.awaitIdentPos;return this.enterScope(jP(t,!1)|QP),this.initFunction(n),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,n.params=this.toAssignableList(e,!0),this.parseFunctionBody(n,!0,!1,s),this.yieldPos=r,this.awaitPos=a,this.awaitIdentPos=i,this.finishNode(n,"ArrowFunctionExpression")};yn.parseFunctionBody=function(n,e,t,s){var r=e&&this.type!==ie.braceL,a=this.strict,i=!1;if(r)n.body=this.parseMaybeAssign(s),n.expression=!0,this.checkParams(n,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(n.params);(!a||o)&&(i=this.strictDirective(this.end),i&&o&&this.raiseRecoverable(n.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],i&&(this.strict=!0),this.checkParams(n,!a&&!i&&!e&&!t&&this.isSimpleParamList(n.params)),this.strict&&n.id&&this.checkLValSimple(n.id,A6),n.body=this.parseBlock(!1,void 0,i&&!a),n.expression=!1,this.adaptDirectivePrologue(n.body.body),this.labels=l}this.exitScope()};yn.isSimpleParamList=function(n){for(var e=0,t=n;e<t.length;e+=1){var s=t[e];if(s.type!=="Identifier")return!1}return!0};yn.checkParams=function(n,e){for(var t=Object.create(null),s=0,r=n.params;s<r.length;s+=1){var a=r[s];this.checkLValInnerPattern(a,VP,e?null:t)}};yn.parseExprList=function(n,e,t,s){for(var r=[],a=!0;!this.eat(n);){if(a)a=!1;else if(this.expect(ie.comma),e&&this.afterTrailingComma(n))break;var i=void 0;t&&this.type===ie.comma?i=null:this.type===ie.ellipsis?(i=this.parseSpread(s),s&&this.type===ie.comma&&s.trailingComma<0&&(s.trailingComma=this.start)):i=this.parseMaybeAssign(!1,s),r.push(i)}return r};yn.checkUnreserved=function(n){var e=n.start,t=n.end,s=n.name;if(this.inGenerator&&s==="yield"&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&dv)&&s==="arguments"&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(s==="arguments"||s==="await")&&this.raise(e,"Cannot use "+s+" in class static initialization block"),this.keywords.test(s)&&this.raise(e,"Unexpected keyword '"+s+"'"),!(this.options.ecmaVersion<6&&this.input.slice(e,t).indexOf("\\")!==-1)){var r=this.strict?this.reservedWordsStrict:this.reservedWords;r.test(s)&&(!this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+s+"' is reserved"))}};yn.parseIdent=function(n){var e=this.parseIdentNode();return this.next(!!n),this.finishNode(e,"Identifier"),n||(this.checkUnreserved(e),e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=e.start)),e};yn.parseIdentNode=function(){var n=this.startNode();return this.type===ie.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,(n.name==="class"||n.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=ie.name):this.unexpected(),n};yn.parsePrivateIdent=function(){var n=this.startNode();return this.type===ie.privateId?n.name=this.value:this.unexpected(),this.next(),this.finishNode(n,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(n.start,"Private field '#"+n.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(n)),n};yn.parseYield=function(n){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===ie.semi||this.canInsertSemicolon()||this.type!==ie.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(ie.star),e.argument=this.parseMaybeAssign(n)),this.finishNode(e,"YieldExpression")};yn.parseAwait=function(n){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,n),this.finishNode(e,"AwaitExpression")};var Py=Er.prototype;Py.raise=function(n,e){var t=O6(this.input,n);e+=" ("+t.line+":"+t.column+")",this.sourceFile&&(e+=" in "+this.sourceFile);var s=new SyntaxError(e);throw s.pos=n,s.loc=t,s.raisedAt=this.pos,s};Py.raiseRecoverable=Py.raise;Py.curPosition=function(){if(this.options.locations)return new uf(this.curLine,this.pos-this.lineStart)};var Pu=Er.prototype,cue=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[]};Pu.enterScope=function(n){this.scopeStack.push(new cue(n))};Pu.exitScope=function(){this.scopeStack.pop()};Pu.treatFunctionsAsVarInScope=function(n){return n.flags&Ah||!this.inModule&&n.flags&yh};Pu.declareName=function(n,e,t){var s=!1;if(e===Ac){var r=this.currentScope();s=r.lexical.indexOf(n)>-1||r.functions.indexOf(n)>-1||r.var.indexOf(n)>-1,r.lexical.push(n),this.inModule&&r.flags&yh&&delete this.undefinedExports[n]}else if(e===P6){var a=this.currentScope();a.lexical.push(n)}else if(e===C6){var i=this.currentScope();this.treatFunctionsAsVar?s=i.lexical.indexOf(n)>-1:s=i.lexical.indexOf(n)>-1||i.var.indexOf(n)>-1,i.functions.push(n)}else for(var o=this.scopeStack.length-1;o>=0;--o){var l=this.scopeStack[o];if(l.lexical.indexOf(n)>-1&&!(l.flags&x6&&l.lexical[0]===n)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(n)>-1){s=!0;break}if(l.var.push(n),this.inModule&&l.flags&yh&&delete this.undefinedExports[n],l.flags&dv)break}s&&this.raiseRecoverable(t,"Identifier '"+n+"' has already been declared")};Pu.checkLocalExport=function(n){this.scopeStack[0].lexical.indexOf(n.name)===-1&&this.scopeStack[0].var.indexOf(n.name)===-1&&(this.undefinedExports[n.name]=n)};Pu.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Pu.currentVarScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&(dv|Kf|Eh))return e}};Pu.currentThisScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&(dv|Kf|Eh)&&!(e.flags&QP))return e}};var mv=function(e,t,s){this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new uv(e,s)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])},Jf=Er.prototype;Jf.startNode=function(){return new mv(this,this.start,this.startLoc)};Jf.startNodeAt=function(n,e){return new mv(this,n,e)};function D6(n,e,t,s){return n.type=e,n.end=t,this.options.locations&&(n.loc.end=s),this.options.ranges&&(n.range[1]=t),n}Jf.finishNode=function(n,e){return D6.call(this,n,e,this.lastTokEnd,this.lastTokEndLoc)};Jf.finishNodeAt=function(n,e,t,s){return D6.call(this,n,e,t,s)};Jf.copyNode=function(n){var e=new mv(this,n.start,this.startLoc);for(var t in n)e[t]=n[t];return e};var uue="Berf Beria_Erfe Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sidetic Sidt Sunu Sunuwar Tai_Yo Tayo Todhri Todr Tolong_Siki Tols Tulu_Tigalari Tutg Unknown Zzzz",T6="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",B6=T6+" Extended_Pictographic",F6=B6,$6=F6+" EBase EComp EMod EPres ExtPict",N6=$6,hue=N6,due={9:T6,10:B6,11:F6,12:$6,13:N6,14:hue},pue="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",mue={9:"",10:"",11:"",12:"",13:"",14:pue},R5="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",_6="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",R6=_6+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",I6=R6+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",L6=I6+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",Q6=L6+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",fue=Q6+" "+uue,gue={9:_6,10:R6,11:I6,12:L6,13:Q6,14:fue},j6={};function bue(n){var e=j6[n]={binary:Uc(due[n]+" "+R5),binaryOfStrings:Uc(mue[n]),nonBinary:{General_Category:Uc(R5),Script:Uc(gue[n])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(var sw=0,I5=[9,10,11,12,13,14];sw<I5.length;sw+=1){var yue=I5[sw];bue(yue)}var Qt=Er.prototype,Ay=function(e,t){this.parent=e,this.base=t||this};Ay.prototype.separatedFrom=function(e){for(var t=this;t;t=t.parent)for(var s=e;s;s=s.parent)if(t.base===s.base&&t!==s)return!0;return!1};Ay.prototype.sibling=function(){return new Ay(this.parent,this.base)};var Ql=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":"")+(e.options.ecmaVersion>=13?"d":"")+(e.options.ecmaVersion>=15?"v":""),this.unicodeProperties=j6[e.options.ecmaVersion>=14?14:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Ql.prototype.reset=function(e,t,s){var r=s.indexOf("v")!==-1,a=s.indexOf("u")!==-1;this.start=e|0,this.source=t+"",this.flags=s,r&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=a&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=a&&this.parser.options.ecmaVersion>=9)};Ql.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)};Ql.prototype.at=function(e,t){t===void 0&&(t=!1);var s=this.source,r=s.length;if(e>=r)return-1;var a=s.charCodeAt(e);if(!(t||this.switchU)||a<=55295||a>=57344||e+1>=r)return a;var i=s.charCodeAt(e+1);return i>=56320&&i<=57343?(a<<10)+i-56613888:a};Ql.prototype.nextIndex=function(e,t){t===void 0&&(t=!1);var s=this.source,r=s.length;if(e>=r)return r;var a=s.charCodeAt(e),i;return!(t||this.switchU)||a<=55295||a>=57344||e+1>=r||(i=s.charCodeAt(e+1))<56320||i>57343?e+1:e+2};Ql.prototype.current=function(e){return e===void 0&&(e=!1),this.at(this.pos,e)};Ql.prototype.lookahead=function(e){return e===void 0&&(e=!1),this.at(this.nextIndex(this.pos,e),e)};Ql.prototype.advance=function(e){e===void 0&&(e=!1),this.pos=this.nextIndex(this.pos,e)};Ql.prototype.eat=function(e,t){return t===void 0&&(t=!1),this.current(t)===e?(this.advance(t),!0):!1};Ql.prototype.eatChars=function(e,t){t===void 0&&(t=!1);for(var s=this.pos,r=0,a=e;r<a.length;r+=1){var i=a[r],o=this.at(s,t);if(o===-1||o!==i)return!1;s=this.nextIndex(s,t)}return this.pos=s,!0};Qt.validateRegExpFlags=function(n){for(var e=n.validFlags,t=n.flags,s=!1,r=!1,a=0;a<t.length;a++){var i=t.charAt(a);e.indexOf(i)===-1&&this.raise(n.start,"Invalid regular expression flag"),t.indexOf(i,a+1)>-1&&this.raise(n.start,"Duplicate regular expression flag"),i==="u"&&(s=!0),i==="v"&&(r=!0)}this.options.ecmaVersion>=15&&s&&r&&this.raise(n.start,"Invalid regular expression flag")};function vue(n){for(var e in n)return!0;return!1}Qt.validateRegExpPattern=function(n){this.regexp_pattern(n),!n.switchN&&this.options.ecmaVersion>=9&&vue(n.groupNames)&&(n.switchN=!0,this.regexp_pattern(n))};Qt.regexp_pattern=function(n){n.pos=0,n.lastIntValue=0,n.lastStringValue="",n.lastAssertionIsQuantifiable=!1,n.numCapturingParens=0,n.maxBackReference=0,n.groupNames=Object.create(null),n.backReferenceNames.length=0,n.branchID=null,this.regexp_disjunction(n),n.pos!==n.source.length&&(n.eat(41)&&n.raise("Unmatched ')'"),(n.eat(93)||n.eat(125))&&n.raise("Lone quantifier brackets")),n.maxBackReference>n.numCapturingParens&&n.raise("Invalid escape");for(var e=0,t=n.backReferenceNames;e<t.length;e+=1){var s=t[e];n.groupNames[s]||n.raise("Invalid named capture referenced")}};Qt.regexp_disjunction=function(n){var e=this.options.ecmaVersion>=16;for(e&&(n.branchID=new Ay(n.branchID,null)),this.regexp_alternative(n);n.eat(124);)e&&(n.branchID=n.branchID.sibling()),this.regexp_alternative(n);e&&(n.branchID=n.branchID.parent),this.regexp_eatQuantifier(n,!0)&&n.raise("Nothing to repeat"),n.eat(123)&&n.raise("Lone quantifier brackets")};Qt.regexp_alternative=function(n){for(;n.pos<n.source.length&&this.regexp_eatTerm(n););};Qt.regexp_eatTerm=function(n){return this.regexp_eatAssertion(n)?(n.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(n)&&n.switchU&&n.raise("Invalid quantifier"),!0):(n.switchU?this.regexp_eatAtom(n):this.regexp_eatExtendedAtom(n))?(this.regexp_eatQuantifier(n),!0):!1};Qt.regexp_eatAssertion=function(n){var e=n.pos;if(n.lastAssertionIsQuantifiable=!1,n.eat(94)||n.eat(36))return!0;if(n.eat(92)){if(n.eat(66)||n.eat(98))return!0;n.pos=e}if(n.eat(40)&&n.eat(63)){var t=!1;if(this.options.ecmaVersion>=9&&(t=n.eat(60)),n.eat(61)||n.eat(33))return this.regexp_disjunction(n),n.eat(41)||n.raise("Unterminated group"),n.lastAssertionIsQuantifiable=!t,!0}return n.pos=e,!1};Qt.regexp_eatQuantifier=function(n,e){return e===void 0&&(e=!1),this.regexp_eatQuantifierPrefix(n,e)?(n.eat(63),!0):!1};Qt.regexp_eatQuantifierPrefix=function(n,e){return n.eat(42)||n.eat(43)||n.eat(63)||this.regexp_eatBracedQuantifier(n,e)};Qt.regexp_eatBracedQuantifier=function(n,e){var t=n.pos;if(n.eat(123)){var s=0,r=-1;if(this.regexp_eatDecimalDigits(n)&&(s=n.lastIntValue,n.eat(44)&&this.regexp_eatDecimalDigits(n)&&(r=n.lastIntValue),n.eat(125)))return r!==-1&&r<s&&!e&&n.raise("numbers out of order in {} quantifier"),!0;n.switchU&&!e&&n.raise("Incomplete quantifier"),n.pos=t}return!1};Qt.regexp_eatAtom=function(n){return this.regexp_eatPatternCharacters(n)||n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)};Qt.regexp_eatReverseSolidusAtomEscape=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatAtomEscape(n))return!0;n.pos=e}return!1};Qt.regexp_eatUncapturingGroup=function(n){var e=n.pos;if(n.eat(40)){if(n.eat(63)){if(this.options.ecmaVersion>=16){var t=this.regexp_eatModifiers(n),s=n.eat(45);if(t||s){for(var r=0;r<t.length;r++){var a=t.charAt(r);t.indexOf(a,r+1)>-1&&n.raise("Duplicate regular expression modifiers")}if(s){var i=this.regexp_eatModifiers(n);!t&&!i&&n.current()===58&&n.raise("Invalid regular expression modifiers");for(var o=0;o<i.length;o++){var l=i.charAt(o);(i.indexOf(l,o+1)>-1||t.indexOf(l)>-1)&&n.raise("Duplicate regular expression modifiers")}}}}if(n.eat(58)){if(this.regexp_disjunction(n),n.eat(41))return!0;n.raise("Unterminated group")}}n.pos=e}return!1};Qt.regexp_eatCapturingGroup=function(n){if(n.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(n):n.current()===63&&n.raise("Invalid group"),this.regexp_disjunction(n),n.eat(41))return n.numCapturingParens+=1,!0;n.raise("Unterminated group")}return!1};Qt.regexp_eatModifiers=function(n){for(var e="",t=0;(t=n.current())!==-1&&Oue(t);)e+=vc(t),n.advance();return e};function Oue(n){return n===105||n===109||n===115}Qt.regexp_eatExtendedAtom=function(n){return n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)||this.regexp_eatInvalidBracedQuantifier(n)||this.regexp_eatExtendedPatternCharacter(n)};Qt.regexp_eatInvalidBracedQuantifier=function(n){return this.regexp_eatBracedQuantifier(n,!0)&&n.raise("Nothing to repeat"),!1};Qt.regexp_eatSyntaxCharacter=function(n){var e=n.current();return V6(e)?(n.lastIntValue=e,n.advance(),!0):!1};function V6(n){return n===36||n>=40&&n<=43||n===46||n===63||n>=91&&n<=94||n>=123&&n<=125}Qt.regexp_eatPatternCharacters=function(n){for(var e=n.pos,t=0;(t=n.current())!==-1&&!V6(t);)n.advance();return n.pos!==e};Qt.regexp_eatExtendedPatternCharacter=function(n){var e=n.current();return e!==-1&&e!==36&&!(e>=40&&e<=43)&&e!==46&&e!==63&&e!==91&&e!==94&&e!==124?(n.advance(),!0):!1};Qt.regexp_groupSpecifier=function(n){if(n.eat(63)){this.regexp_eatGroupName(n)||n.raise("Invalid group");var e=this.options.ecmaVersion>=16,t=n.groupNames[n.lastStringValue];if(t)if(e)for(var s=0,r=t;s<r.length;s+=1){var a=r[s];a.separatedFrom(n.branchID)||n.raise("Duplicate capture group name")}else n.raise("Duplicate capture group name");e?(t||(n.groupNames[n.lastStringValue]=[])).push(n.branchID):n.groupNames[n.lastStringValue]=!0}};Qt.regexp_eatGroupName=function(n){if(n.lastStringValue="",n.eat(60)){if(this.regexp_eatRegExpIdentifierName(n)&&n.eat(62))return!0;n.raise("Invalid capture group name")}return!1};Qt.regexp_eatRegExpIdentifierName=function(n){if(n.lastStringValue="",this.regexp_eatRegExpIdentifierStart(n)){for(n.lastStringValue+=vc(n.lastIntValue);this.regexp_eatRegExpIdentifierPart(n);)n.lastStringValue+=vc(n.lastIntValue);return!0}return!1};Qt.regexp_eatRegExpIdentifierStart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,s=n.current(t);return n.advance(t),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(s=n.lastIntValue),wue(s)?(n.lastIntValue=s,!0):(n.pos=e,!1)};function wue(n){return Nl(n,!0)||n===36||n===95}Qt.regexp_eatRegExpIdentifierPart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,s=n.current(t);return n.advance(t),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(s=n.lastIntValue),xue(s)?(n.lastIntValue=s,!0):(n.pos=e,!1)};function xue(n){return gu(n,!0)||n===36||n===95||n===8204||n===8205}Qt.regexp_eatAtomEscape=function(n){return this.regexp_eatBackReference(n)||this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)||n.switchN&&this.regexp_eatKGroupName(n)?!0:(n.switchU&&(n.current()===99&&n.raise("Invalid unicode escape"),n.raise("Invalid escape")),!1)};Qt.regexp_eatBackReference=function(n){var e=n.pos;if(this.regexp_eatDecimalEscape(n)){var t=n.lastIntValue;if(n.switchU)return t>n.maxBackReference&&(n.maxBackReference=t),!0;if(t<=n.numCapturingParens)return!0;n.pos=e}return!1};Qt.regexp_eatKGroupName=function(n){if(n.eat(107)){if(this.regexp_eatGroupName(n))return n.backReferenceNames.push(n.lastStringValue),!0;n.raise("Invalid named reference")}return!1};Qt.regexp_eatCharacterEscape=function(n){return this.regexp_eatControlEscape(n)||this.regexp_eatCControlLetter(n)||this.regexp_eatZero(n)||this.regexp_eatHexEscapeSequence(n)||this.regexp_eatRegExpUnicodeEscapeSequence(n,!1)||!n.switchU&&this.regexp_eatLegacyOctalEscapeSequence(n)||this.regexp_eatIdentityEscape(n)};Qt.regexp_eatCControlLetter=function(n){var e=n.pos;if(n.eat(99)){if(this.regexp_eatControlLetter(n))return!0;n.pos=e}return!1};Qt.regexp_eatZero=function(n){return n.current()===48&&!fv(n.lookahead())?(n.lastIntValue=0,n.advance(),!0):!1};Qt.regexp_eatControlEscape=function(n){var e=n.current();return e===116?(n.lastIntValue=9,n.advance(),!0):e===110?(n.lastIntValue=10,n.advance(),!0):e===118?(n.lastIntValue=11,n.advance(),!0):e===102?(n.lastIntValue=12,n.advance(),!0):e===114?(n.lastIntValue=13,n.advance(),!0):!1};Qt.regexp_eatControlLetter=function(n){var e=n.current();return Z6(e)?(n.lastIntValue=e%32,n.advance(),!0):!1};function Z6(n){return n>=65&&n<=90||n>=97&&n<=122}Qt.regexp_eatRegExpUnicodeEscapeSequence=function(n,e){e===void 0&&(e=!1);var t=n.pos,s=e||n.switchU;if(n.eat(117)){if(this.regexp_eatFixedHexDigits(n,4)){var r=n.lastIntValue;if(s&&r>=55296&&r<=56319){var a=n.pos;if(n.eat(92)&&n.eat(117)&&this.regexp_eatFixedHexDigits(n,4)){var i=n.lastIntValue;if(i>=56320&&i<=57343)return n.lastIntValue=(r-55296)*1024+(i-56320)+65536,!0}n.pos=a,n.lastIntValue=r}return!0}if(s&&n.eat(123)&&this.regexp_eatHexDigits(n)&&n.eat(125)&&kue(n.lastIntValue))return!0;s&&n.raise("Invalid unicode escape"),n.pos=t}return!1};function kue(n){return n>=0&&n<=1114111}Qt.regexp_eatIdentityEscape=function(n){if(n.switchU)return this.regexp_eatSyntaxCharacter(n)?!0:n.eat(47)?(n.lastIntValue=47,!0):!1;var e=n.current();return e!==99&&(!n.switchN||e!==107)?(n.lastIntValue=e,n.advance(),!0):!1};Qt.regexp_eatDecimalEscape=function(n){n.lastIntValue=0;var e=n.current();if(e>=49&&e<=57){do n.lastIntValue=10*n.lastIntValue+(e-48),n.advance();while((e=n.current())>=48&&e<=57);return!0}return!1};var z6=0,Oc=1,Hi=2;Qt.regexp_eatCharacterClassEscape=function(n){var e=n.current();if(Sue(e))return n.lastIntValue=-1,n.advance(),Oc;var t=!1;if(n.switchU&&this.options.ecmaVersion>=9&&((t=e===80)||e===112)){n.lastIntValue=-1,n.advance();var s;if(n.eat(123)&&(s=this.regexp_eatUnicodePropertyValueExpression(n))&&n.eat(125))return t&&s===Hi&&n.raise("Invalid property name"),s;n.raise("Invalid property name")}return z6};function Sue(n){return n===100||n===68||n===115||n===83||n===119||n===87}Qt.regexp_eatUnicodePropertyValueExpression=function(n){var e=n.pos;if(this.regexp_eatUnicodePropertyName(n)&&n.eat(61)){var t=n.lastStringValue;if(this.regexp_eatUnicodePropertyValue(n)){var s=n.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(n,t,s),Oc}}if(n.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(n)){var r=n.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(n,r)}return z6};Qt.regexp_validateUnicodePropertyNameAndValue=function(n,e,t){cp(n.unicodeProperties.nonBinary,e)||n.raise("Invalid property name"),n.unicodeProperties.nonBinary[e].test(t)||n.raise("Invalid property value")};Qt.regexp_validateUnicodePropertyNameOrValue=function(n,e){if(n.unicodeProperties.binary.test(e))return Oc;if(n.switchV&&n.unicodeProperties.binaryOfStrings.test(e))return Hi;n.raise("Invalid property name")};Qt.regexp_eatUnicodePropertyName=function(n){var e=0;for(n.lastStringValue="";q6(e=n.current());)n.lastStringValue+=vc(e),n.advance();return n.lastStringValue!==""};function q6(n){return Z6(n)||n===95}Qt.regexp_eatUnicodePropertyValue=function(n){var e=0;for(n.lastStringValue="";Cue(e=n.current());)n.lastStringValue+=vc(e),n.advance();return n.lastStringValue!==""};function Cue(n){return q6(n)||fv(n)}Qt.regexp_eatLoneUnicodePropertyNameOrValue=function(n){return this.regexp_eatUnicodePropertyValue(n)};Qt.regexp_eatCharacterClass=function(n){if(n.eat(91)){var e=n.eat(94),t=this.regexp_classContents(n);return n.eat(93)||n.raise("Unterminated character class"),e&&t===Hi&&n.raise("Negated character class may contain strings"),!0}return!1};Qt.regexp_classContents=function(n){return n.current()===93?Oc:n.switchV?this.regexp_classSetExpression(n):(this.regexp_nonEmptyClassRanges(n),Oc)};Qt.regexp_nonEmptyClassRanges=function(n){for(;this.regexp_eatClassAtom(n);){var e=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassAtom(n)){var t=n.lastIntValue;n.switchU&&(e===-1||t===-1)&&n.raise("Invalid character class"),e!==-1&&t!==-1&&e>t&&n.raise("Range out of order in character class")}}};Qt.regexp_eatClassAtom=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatClassEscape(n))return!0;if(n.switchU){var t=n.current();(t===99||G6(t))&&n.raise("Invalid class escape"),n.raise("Invalid escape")}n.pos=e}var s=n.current();return s!==93?(n.lastIntValue=s,n.advance(),!0):!1};Qt.regexp_eatClassEscape=function(n){var e=n.pos;if(n.eat(98))return n.lastIntValue=8,!0;if(n.switchU&&n.eat(45))return n.lastIntValue=45,!0;if(!n.switchU&&n.eat(99)){if(this.regexp_eatClassControlLetter(n))return!0;n.pos=e}return this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)};Qt.regexp_classSetExpression=function(n){var e=Oc,t;if(!this.regexp_eatClassSetRange(n))if(t=this.regexp_eatClassSetOperand(n)){t===Hi&&(e=Hi);for(var s=n.pos;n.eatChars([38,38]);){if(n.current()!==38&&(t=this.regexp_eatClassSetOperand(n))){t!==Hi&&(e=Oc);continue}n.raise("Invalid character in character class")}if(s!==n.pos)return e;for(;n.eatChars([45,45]);)this.regexp_eatClassSetOperand(n)||n.raise("Invalid character in character class");if(s!==n.pos)return e}else n.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(n)){if(t=this.regexp_eatClassSetOperand(n),!t)return e;t===Hi&&(e=Hi)}};Qt.regexp_eatClassSetRange=function(n){var e=n.pos;if(this.regexp_eatClassSetCharacter(n)){var t=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassSetCharacter(n)){var s=n.lastIntValue;return t!==-1&&s!==-1&&t>s&&n.raise("Range out of order in character class"),!0}n.pos=e}return!1};Qt.regexp_eatClassSetOperand=function(n){return this.regexp_eatClassSetCharacter(n)?Oc:this.regexp_eatClassStringDisjunction(n)||this.regexp_eatNestedClass(n)};Qt.regexp_eatNestedClass=function(n){var e=n.pos;if(n.eat(91)){var t=n.eat(94),s=this.regexp_classContents(n);if(n.eat(93))return t&&s===Hi&&n.raise("Negated character class may contain strings"),s;n.pos=e}if(n.eat(92)){var r=this.regexp_eatCharacterClassEscape(n);if(r)return r;n.pos=e}return null};Qt.regexp_eatClassStringDisjunction=function(n){var e=n.pos;if(n.eatChars([92,113])){if(n.eat(123)){var t=this.regexp_classStringDisjunctionContents(n);if(n.eat(125))return t}else n.raise("Invalid escape");n.pos=e}return null};Qt.regexp_classStringDisjunctionContents=function(n){for(var e=this.regexp_classString(n);n.eat(124);)this.regexp_classString(n)===Hi&&(e=Hi);return e};Qt.regexp_classString=function(n){for(var e=0;this.regexp_eatClassSetCharacter(n);)e++;return e===1?Oc:Hi};Qt.regexp_eatClassSetCharacter=function(n){var e=n.pos;if(n.eat(92))return this.regexp_eatCharacterEscape(n)||this.regexp_eatClassSetReservedPunctuator(n)?!0:n.eat(98)?(n.lastIntValue=8,!0):(n.pos=e,!1);var t=n.current();return t<0||t===n.lookahead()&&Pue(t)||Aue(t)?!1:(n.advance(),n.lastIntValue=t,!0)};function Pue(n){return n===33||n>=35&&n<=38||n>=42&&n<=44||n===46||n>=58&&n<=64||n===94||n===96||n===126}function Aue(n){return n===40||n===41||n===45||n===47||n>=91&&n<=93||n>=123&&n<=125}Qt.regexp_eatClassSetReservedPunctuator=function(n){var e=n.current();return Eue(e)?(n.lastIntValue=e,n.advance(),!0):!1};function Eue(n){return n===33||n===35||n===37||n===38||n===44||n===45||n>=58&&n<=62||n===64||n===96||n===126}Qt.regexp_eatClassControlLetter=function(n){var e=n.current();return fv(e)||e===95?(n.lastIntValue=e%32,n.advance(),!0):!1};Qt.regexp_eatHexEscapeSequence=function(n){var e=n.pos;if(n.eat(120)){if(this.regexp_eatFixedHexDigits(n,2))return!0;n.switchU&&n.raise("Invalid escape"),n.pos=e}return!1};Qt.regexp_eatDecimalDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;fv(t=n.current());)n.lastIntValue=10*n.lastIntValue+(t-48),n.advance();return n.pos!==e};function fv(n){return n>=48&&n<=57}Qt.regexp_eatHexDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;U6(t=n.current());)n.lastIntValue=16*n.lastIntValue+W6(t),n.advance();return n.pos!==e};function U6(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function W6(n){return n>=65&&n<=70?10+(n-65):n>=97&&n<=102?10+(n-97):n-48}Qt.regexp_eatLegacyOctalEscapeSequence=function(n){if(this.regexp_eatOctalDigit(n)){var e=n.lastIntValue;if(this.regexp_eatOctalDigit(n)){var t=n.lastIntValue;e<=3&&this.regexp_eatOctalDigit(n)?n.lastIntValue=e*64+t*8+n.lastIntValue:n.lastIntValue=e*8+t}else n.lastIntValue=e;return!0}return!1};Qt.regexp_eatOctalDigit=function(n){var e=n.current();return G6(e)?(n.lastIntValue=e-48,n.advance(),!0):(n.lastIntValue=0,!1)};function G6(n){return n>=48&&n<=55}Qt.regexp_eatFixedHexDigits=function(n,e){var t=n.pos;n.lastIntValue=0;for(var s=0;s<e;++s){var r=n.current();if(!U6(r))return n.pos=t,!1;n.lastIntValue=16*n.lastIntValue+W6(r),n.advance()}return!0};var zP=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new uv(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},zn=Er.prototype;zn.next=function(n){!n&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new zP(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};zn.getToken=function(){return this.next(),new zP(this)};typeof Symbol<"u"&&(zn[Symbol.iterator]=function(){var n=this;return{next:function(){var e=n.getToken();return{done:e.type===ie.eof,value:e}}}});zn.nextToken=function(){var n=this.curContext();if((!n||!n.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(ie.eof);if(n.override)return n.override(this);this.readToken(this.fullCharCodeAtPos())};zn.readToken=function(n){return Nl(n,this.options.ecmaVersion>=6)||n===92?this.readWord():this.getTokenFromCode(n)};zn.fullCharCodeAt=function(n){var e=this.input.charCodeAt(n);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(n+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888};zn.fullCharCodeAtPos=function(){return this.fullCharCodeAt(this.pos)};zn.skipBlockComment=function(){var n=this.options.onComment&&this.curPosition(),e=this.pos,t=this.input.indexOf("*/",this.pos+=2);if(t===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=t+2,this.options.locations)for(var s=void 0,r=e;(s=b6(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=s;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,t),e,this.pos,n,this.curPosition())};zn.skipLineComment=function(n){for(var e=this.pos,t=this.options.onComment&&this.curPosition(),s=this.input.charCodeAt(this.pos+=n);this.pos<this.input.length&&!lp(s);)s=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+n,this.pos),e,this.pos,t,this.curPosition())};zn.skipSpace=function(){e:for(;this.pos<this.input.length;){var n=this.input.charCodeAt(this.pos);switch(n){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(n>8&&n<14||n>=5760&&y6.test(String.fromCharCode(n)))++this.pos;else break e}}};zn.finishToken=function(n,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var t=this.type;this.type=n,this.value=e,this.updateContext(t)};zn.readToken_dot=function(){var n=this.input.charCodeAt(this.pos+1);if(n>=48&&n<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&n===46&&e===46?(this.pos+=3,this.finishToken(ie.ellipsis)):(++this.pos,this.finishToken(ie.dot))};zn.readToken_slash=function(){var n=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):n===61?this.finishOp(ie.assign,2):this.finishOp(ie.slash,1)};zn.readToken_mult_modulo_exp=function(n){var e=this.input.charCodeAt(this.pos+1),t=1,s=n===42?ie.star:ie.modulo;return this.options.ecmaVersion>=7&&n===42&&e===42&&(++t,s=ie.starstar,e=this.input.charCodeAt(this.pos+2)),e===61?this.finishOp(ie.assign,t+1):this.finishOp(s,t)};zn.readToken_pipe_amp=function(n){var e=this.input.charCodeAt(this.pos+1);if(e===n){if(this.options.ecmaVersion>=12){var t=this.input.charCodeAt(this.pos+2);if(t===61)return this.finishOp(ie.assign,3)}return this.finishOp(n===124?ie.logicalOR:ie.logicalAND,2)}return e===61?this.finishOp(ie.assign,2):this.finishOp(n===124?ie.bitwiseOR:ie.bitwiseAND,1)};zn.readToken_caret=function(){var n=this.input.charCodeAt(this.pos+1);return n===61?this.finishOp(ie.assign,2):this.finishOp(ie.bitwiseXOR,1)};zn.readToken_plus_min=function(n){var e=this.input.charCodeAt(this.pos+1);return e===n?e===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||oi.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(ie.incDec,2):e===61?this.finishOp(ie.assign,2):this.finishOp(ie.plusMin,1)};zn.readToken_lt_gt=function(n){var e=this.input.charCodeAt(this.pos+1),t=1;return e===n?(t=n===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+t)===61?this.finishOp(ie.assign,t+1):this.finishOp(ie.bitShift,t)):e===33&&n===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(e===61&&(t=2),this.finishOp(ie.relational,t))};zn.readToken_eq_excl=function(n){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(ie.equality,this.input.charCodeAt(this.pos+2)===61?3:2):n===61&&e===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(ie.arrow)):this.finishOp(n===61?ie.eq:ie.prefix,1)};zn.readToken_question=function(){var n=this.options.ecmaVersion;if(n>=11){var e=this.input.charCodeAt(this.pos+1);if(e===46){var t=this.input.charCodeAt(this.pos+2);if(t<48||t>57)return this.finishOp(ie.questionDot,2)}if(e===63){if(n>=12){var s=this.input.charCodeAt(this.pos+2);if(s===61)return this.finishOp(ie.assign,3)}return this.finishOp(ie.coalesce,2)}}return this.finishOp(ie.question,1)};zn.readToken_numberSign=function(){var n=this.options.ecmaVersion,e=35;if(n>=13&&(++this.pos,e=this.fullCharCodeAtPos(),Nl(e,!0)||e===92))return this.finishToken(ie.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+vc(e)+"'")};zn.getTokenFromCode=function(n){switch(n){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(ie.parenL);case 41:return++this.pos,this.finishToken(ie.parenR);case 59:return++this.pos,this.finishToken(ie.semi);case 44:return++this.pos,this.finishToken(ie.comma);case 91:return++this.pos,this.finishToken(ie.bracketL);case 93:return++this.pos,this.finishToken(ie.bracketR);case 123:return++this.pos,this.finishToken(ie.braceL);case 125:return++this.pos,this.finishToken(ie.braceR);case 58:return++this.pos,this.finishToken(ie.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(ie.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(e===120||e===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(e===111||e===79)return this.readRadixNumber(8);if(e===98||e===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(n);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(n);case 124:case 38:return this.readToken_pipe_amp(n);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(n);case 60:case 62:return this.readToken_lt_gt(n);case 61:case 33:return this.readToken_eq_excl(n);case 63:return this.readToken_question();case 126:return this.finishOp(ie.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+vc(n)+"'")};zn.finishOp=function(n,e){var t=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(n,t)};zn.readRegexp=function(){for(var n,e,t=this.pos;;){this.pos>=this.input.length&&this.raise(t,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(oi.test(s)&&this.raise(t,"Unterminated regular expression"),n)n=!1;else{if(s==="[")e=!0;else if(s==="]"&&e)e=!1;else if(s==="/"&&!e)break;n=s==="\\"}++this.pos}var r=this.input.slice(t,this.pos);++this.pos;var a=this.pos,i=this.readWord1();this.containsEsc&&this.unexpected(a);var o=this.regexpState||(this.regexpState=new Ql(this));o.reset(t,r,i),this.validateRegExpFlags(o),this.validateRegExpPattern(o);var l=null;try{l=new RegExp(r,i)}catch{}return this.finishToken(ie.regexp,{pattern:r,flags:i,value:l})};zn.readInt=function(n,e,t){for(var s=this.options.ecmaVersion>=12&&e===void 0,r=t&&this.input.charCodeAt(this.pos)===48,a=this.pos,i=0,o=0,l=0,c=e??1/0;l<c;++l,++this.pos){var u=this.input.charCodeAt(this.pos),h=void 0;if(s&&u===95){r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),o===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),o=u;continue}if(u>=97?h=u-97+10:u>=65?h=u-65+10:u>=48&&u<=57?h=u-48:h=1/0,h>=n)break;o=u,i=i*n+h}return s&&o===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===a||e!=null&&this.pos-a!==e?null:i};function Mue(n,e){return e?parseInt(n,8):parseFloat(n.replace(/_/g,""))}function X6(n){return typeof BigInt!="function"?null:BigInt(n.replace(/_/g,""))}zn.readRadixNumber=function(n){var e=this.pos;this.pos+=2;var t=this.readInt(n);return t==null&&this.raise(this.start+2,"Expected number in radix "+n),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(t=X6(this.input.slice(e,this.pos)),++this.pos):Nl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ie.num,t)};zn.readNumber=function(n){var e=this.pos;!n&&this.readInt(10,void 0,!0)===null&&this.raise(e,"Invalid number");var t=this.pos-e>=2&&this.input.charCodeAt(e)===48;t&&this.strict&&this.raise(e,"Invalid number");var s=this.input.charCodeAt(this.pos);if(!t&&!n&&this.options.ecmaVersion>=11&&s===110){var r=X6(this.input.slice(e,this.pos));return++this.pos,Nl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ie.num,r)}t&&/[89]/.test(this.input.slice(e,this.pos))&&(t=!1),s===46&&!t&&(++this.pos,this.readInt(10),s=this.input.charCodeAt(this.pos)),(s===69||s===101)&&!t&&(s=this.input.charCodeAt(++this.pos),(s===43||s===45)&&++this.pos,this.readInt(10)===null&&this.raise(e,"Invalid number")),Nl(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a=Mue(this.input.slice(e,this.pos),t);return this.finishToken(ie.num,a)};zn.readCodePoint=function(){var n=this.input.charCodeAt(this.pos),e;if(n===123){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e};zn.readString=function(n){for(var e="",t=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var s=this.input.charCodeAt(this.pos);if(s===n)break;s===92?(e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!1),t=this.pos):s===8232||s===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(lp(s)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(t,this.pos++),this.finishToken(ie.string,e)};var H6={};zn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(n){if(n===H6)this.readInvalidTemplateToken();else throw n}this.inTemplateElement=!1};zn.invalidStringToken=function(n,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw H6;this.raise(n,e)};zn.readTmplToken=function(){for(var n="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var t=this.input.charCodeAt(this.pos);if(t===96||t===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===ie.template||this.type===ie.invalidTemplate)?t===36?(this.pos+=2,this.finishToken(ie.dollarBraceL)):(++this.pos,this.finishToken(ie.backQuote)):(n+=this.input.slice(e,this.pos),this.finishToken(ie.template,n));if(t===92)n+=this.input.slice(e,this.pos),n+=this.readEscapedChar(!0),e=this.pos;else if(lp(t)){switch(n+=this.input.slice(e,this.pos),++this.pos,t){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:n+=`
`;break;default:n+=String.fromCharCode(t);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}};zn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(ie.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};zn.readEscapedChar=function(n){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return vc(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),n){var t=this.pos-1;this.invalidStringToken(t,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(s,8);return r>255&&(s=s.slice(0,-1),r=parseInt(s,8)),this.pos+=s.length-1,e=this.input.charCodeAt(this.pos),(s!=="0"||e===56||e===57)&&(this.strict||n)&&this.invalidStringToken(this.pos-1-s.length,n?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return lp(e)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(e)}};zn.readHexChar=function(n){var e=this.pos,t=this.readInt(16,n);return t===null&&this.invalidStringToken(e,"Bad character escape sequence"),t};zn.readWord1=function(){this.containsEsc=!1;for(var n="",e=!0,t=this.pos,s=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(gu(r,s))this.pos+=r<=65535?1:2;else if(r===92){this.containsEsc=!0,n+=this.input.slice(t,this.pos);var a=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var i=this.readCodePoint();(e?Nl:gu)(i,s)||this.invalidStringToken(a,"Invalid Unicode escape"),n+=vc(i),t=this.pos}else break;e=!1}return n+this.input.slice(t,this.pos)};zn.readWord=function(){var n=this.readWord1(),e=ie.name;return this.keywords.test(n)&&(e=IP[n]),this.finishToken(e,n)};var Due="8.16.0";Er.acorn={Parser:Er,version:Due,defaultOptions:d2,Position:uf,SourceLocation:uv,getLineInfo:O6,Node:mv,TokenType:ns,tokTypes:ie,keywordTypes:IP,TokContext:Ao,tokContexts:Vs,isIdentifierChar:gu,isIdentifierStart:Nl,Token:zP,isNewLine:lp,lineBreak:oi,lineBreakG:Kce,nonASCIIwhitespace:y6};function Tue(n,e){return Er.parse(n,e)}var rw={},aw={},L5;function Bue(){return L5||(L5=1,(function(n){(function e(t){var s,r,a,i,o,l;function c($){var L={},I,q;for(I in $)$.hasOwnProperty(I)&&(q=$[I],typeof q=="object"&&q!==null?L[I]=c(q):L[I]=q);return L}function u($,L){var I,q,ce,ee;for(q=$.length,ce=0;q;)I=q>>>1,ee=ce+I,L($[ee])?q=I:(ce=ee+1,q-=I+1);return ce}s={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},a={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},i={},o={},l={},r={Break:i,Skip:o,Remove:l};function h($,L){this.parent=$,this.key=L}h.prototype.replace=function(L){this.parent[this.key]=L},h.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function d($,L,I,q){this.node=$,this.path=L,this.wrap=I,this.ref=q}function m(){}m.prototype.path=function(){var L,I,q,ce,ee,he;function H(me,Oe){if(Array.isArray(Oe))for(q=0,ce=Oe.length;q<ce;++q)me.push(Oe[q]);else me.push(Oe)}if(!this.__current.path)return null;for(ee=[],L=2,I=this.__leavelist.length;L<I;++L)he=this.__leavelist[L],H(ee,he.path);return H(ee,this.__current.path),ee},m.prototype.type=function(){var $=this.current();return $.type||this.__current.wrap},m.prototype.parents=function(){var L,I,q;for(q=[],L=1,I=this.__leavelist.length;L<I;++L)q.push(this.__leavelist[L].node);return q},m.prototype.current=function(){return this.__current.node},m.prototype.__execute=function(L,I){var q,ce;return ce=void 0,q=this.__current,this.__current=I,this.__state=null,L&&(ce=L.call(this,I.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=q,ce},m.prototype.notify=function(L){this.__state=L},m.prototype.skip=function(){this.notify(o)},m.prototype.break=function(){this.notify(i)},m.prototype.remove=function(){this.notify(l)},m.prototype.__initialize=function($,L){this.visitor=L,this.root=$,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,L.fallback==="iteration"?this.__fallback=Object.keys:typeof L.fallback=="function"&&(this.__fallback=L.fallback),this.__keys=a,L.keys&&(this.__keys=Object.assign(Object.create(this.__keys),L.keys))};function y($){return $==null?!1:typeof $=="object"&&typeof $.type=="string"}function O($,L){return($===s.ObjectExpression||$===s.ObjectPattern)&&L==="properties"}function S($,L){for(var I=$.length-1;I>=0;--I)if($[I].node===L)return!0;return!1}m.prototype.traverse=function(L,I){var q,ce,ee,he,H,me,Oe,Pe,De,Se,ae,Ee;for(this.__initialize(L,I),Ee={},q=this.__worklist,ce=this.__leavelist,q.push(new d(L,null,null,null)),ce.push(new d(null,null,null,null));q.length;){if(ee=q.pop(),ee===Ee){if(ee=ce.pop(),me=this.__execute(I.leave,ee),this.__state===i||me===i)return;continue}if(ee.node){if(me=this.__execute(I.enter,ee),this.__state===i||me===i)return;if(q.push(Ee),ce.push(ee),this.__state===o||me===o)continue;if(he=ee.node,H=he.type||ee.wrap,Se=this.__keys[H],!Se)if(this.__fallback)Se=this.__fallback(he);else throw new Error("Unknown node type "+H+".");for(Pe=Se.length;(Pe-=1)>=0;)if(Oe=Se[Pe],ae=he[Oe],!!ae){if(Array.isArray(ae)){for(De=ae.length;(De-=1)>=0;)if(ae[De]&&!S(ce,ae[De])){if(O(H,Se[Pe]))ee=new d(ae[De],[Oe,De],"Property",null);else if(y(ae[De]))ee=new d(ae[De],[Oe,De],null,null);else continue;q.push(ee)}}else if(y(ae)){if(S(ce,ae))continue;q.push(new d(ae,Oe,null,null))}}}}},m.prototype.replace=function(L,I){var q,ce,ee,he,H,me,Oe,Pe,De,Se,ae,Ee,Qe;function Ke(ge){var Ye,yt,Xe,Ge;if(ge.ref.remove()){for(yt=ge.ref.key,Ge=ge.ref.parent,Ye=q.length;Ye--;)if(Xe=q[Ye],Xe.ref&&Xe.ref.parent===Ge){if(Xe.ref.key<yt)break;--Xe.ref.key}}}for(this.__initialize(L,I),ae={},q=this.__worklist,ce=this.__leavelist,Ee={root:L},me=new d(L,null,null,new h(Ee,"root")),q.push(me),ce.push(me);q.length;){if(me=q.pop(),me===ae){if(me=ce.pop(),H=this.__execute(I.leave,me),H!==void 0&&H!==i&&H!==o&&H!==l&&me.ref.replace(H),(this.__state===l||H===l)&&Ke(me),this.__state===i||H===i)return Ee.root;continue}if(H=this.__execute(I.enter,me),H!==void 0&&H!==i&&H!==o&&H!==l&&(me.ref.replace(H),me.node=H),(this.__state===l||H===l)&&(Ke(me),me.node=null),this.__state===i||H===i)return Ee.root;if(ee=me.node,!!ee&&(q.push(ae),ce.push(me),!(this.__state===o||H===o))){if(he=ee.type||me.wrap,De=this.__keys[he],!De)if(this.__fallback)De=this.__fallback(ee);else throw new Error("Unknown node type "+he+".");for(Oe=De.length;(Oe-=1)>=0;)if(Qe=De[Oe],Se=ee[Qe],!!Se)if(Array.isArray(Se)){for(Pe=Se.length;(Pe-=1)>=0;)if(Se[Pe]){if(O(he,De[Oe]))me=new d(Se[Pe],[Qe,Pe],"Property",new h(Se,Pe));else if(y(Se[Pe]))me=new d(Se[Pe],[Qe,Pe],null,new h(Se,Pe));else continue;q.push(me)}}else y(Se)&&q.push(new d(Se,Qe,null,new h(ee,Qe)))}}return Ee.root};function A($,L){var I=new m;return I.traverse($,L)}function F($,L){var I=new m;return I.replace($,L)}function j($,L){var I;return I=u(L,function(ce){return ce.range[0]>$.range[0]}),$.extendedRange=[$.range[0],$.range[1]],I!==L.length&&($.extendedRange[1]=L[I].range[0]),I-=1,I>=0&&($.extendedRange[0]=L[I].range[1]),$}function N($,L,I){var q=[],ce,ee,he,H;if(!$.range)throw new Error("attachComments needs range information");if(!I.length){if(L.length){for(he=0,ee=L.length;he<ee;he+=1)ce=c(L[he]),ce.extendedRange=[0,$.range[0]],q.push(ce);$.leadingComments=q}return $}for(he=0,ee=L.length;he<ee;he+=1)q.push(j(c(L[he]),I));return H=0,A($,{enter:function(me){for(var Oe;H<q.length&&(Oe=q[H],!(Oe.extendedRange[1]>me.range[0]));)Oe.extendedRange[1]===me.range[0]?(me.leadingComments||(me.leadingComments=[]),me.leadingComments.push(Oe),q.splice(H,1)):H+=1;if(H===q.length)return r.Break;if(q[H].extendedRange[0]>me.range[1])return r.Skip}}),H=0,A($,{leave:function(me){for(var Oe;H<q.length&&(Oe=q[H],!(me.range[1]<Oe.extendedRange[0]));)me.range[1]===Oe.extendedRange[0]?(me.trailingComments||(me.trailingComments=[]),me.trailingComments.push(Oe),q.splice(H,1)):H+=1;if(H===q.length)return r.Break;if(q[H].extendedRange[0]>me.range[1])return r.Skip}}),$}return t.Syntax=s,t.traverse=A,t.replace=F,t.attachComments=N,t.VisitorKeys=a,t.VisitorOption=r,t.Controller=m,t.cloneEnvironment=function(){return e({})},t})(n)})(aw)),aw}var Ip={},iw={exports:{}},Q5;function Fue(){return Q5||(Q5=1,(function(){function n(i){if(i==null)return!1;switch(i.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function e(i){if(i==null)return!1;switch(i.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function t(i){if(i==null)return!1;switch(i.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function s(i){return t(i)||i!=null&&i.type==="FunctionDeclaration"}function r(i){switch(i.type){case"IfStatement":return i.alternate!=null?i.alternate:i.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return i.body}return null}function a(i){var o;if(i.type!=="IfStatement"||i.alternate==null)return!1;o=i.consequent;do{if(o.type==="IfStatement"&&o.alternate==null)return!0;o=r(o)}while(o);return!1}iw.exports={isExpression:n,isStatement:t,isIterationStatement:e,isSourceElement:s,isProblematicIfStatement:a,trailingStatement:r}})()),iw.exports}var ow={exports:{}},j5;function Y6(){return j5||(j5=1,(function(){var n,e,t,s,r,a;e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},n={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function i(S){return 48<=S&&S<=57}function o(S){return 48<=S&&S<=57||97<=S&&S<=102||65<=S&&S<=70}function l(S){return S>=48&&S<=55}t=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function c(S){return S===32||S===9||S===11||S===12||S===160||S>=5760&&t.indexOf(S)>=0}function u(S){return S===10||S===13||S===8232||S===8233}function h(S){if(S<=65535)return String.fromCharCode(S);var A=String.fromCharCode(Math.floor((S-65536)/1024)+55296),F=String.fromCharCode((S-65536)%1024+56320);return A+F}for(s=new Array(128),a=0;a<128;++a)s[a]=a>=97&&a<=122||a>=65&&a<=90||a===36||a===95;for(r=new Array(128),a=0;a<128;++a)r[a]=a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===36||a===95;function d(S){return S<128?s[S]:e.NonAsciiIdentifierStart.test(h(S))}function m(S){return S<128?r[S]:e.NonAsciiIdentifierPart.test(h(S))}function y(S){return S<128?s[S]:n.NonAsciiIdentifierStart.test(h(S))}function O(S){return S<128?r[S]:n.NonAsciiIdentifierPart.test(h(S))}ow.exports={isDecimalDigit:i,isHexDigit:o,isOctalDigit:l,isWhiteSpace:c,isLineTerminator:u,isIdentifierStartES5:d,isIdentifierPartES5:m,isIdentifierStartES6:y,isIdentifierPartES6:O}})()),ow.exports}var lw={exports:{}},V5;function $ue(){return V5||(V5=1,(function(){var n=Y6();function e(d){switch(d){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function t(d,m){return!m&&d==="yield"?!1:s(d,m)}function s(d,m){if(m&&e(d))return!0;switch(d.length){case 2:return d==="if"||d==="in"||d==="do";case 3:return d==="var"||d==="for"||d==="new"||d==="try";case 4:return d==="this"||d==="else"||d==="case"||d==="void"||d==="with"||d==="enum";case 5:return d==="while"||d==="break"||d==="catch"||d==="throw"||d==="const"||d==="yield"||d==="class"||d==="super";case 6:return d==="return"||d==="typeof"||d==="delete"||d==="switch"||d==="export"||d==="import";case 7:return d==="default"||d==="finally"||d==="extends";case 8:return d==="function"||d==="continue"||d==="debugger";case 10:return d==="instanceof";default:return!1}}function r(d,m){return d==="null"||d==="true"||d==="false"||t(d,m)}function a(d,m){return d==="null"||d==="true"||d==="false"||s(d,m)}function i(d){return d==="eval"||d==="arguments"}function o(d){var m,y,O;if(d.length===0||(O=d.charCodeAt(0),!n.isIdentifierStartES5(O)))return!1;for(m=1,y=d.length;m<y;++m)if(O=d.charCodeAt(m),!n.isIdentifierPartES5(O))return!1;return!0}function l(d,m){return(d-55296)*1024+(m-56320)+65536}function c(d){var m,y,O,S,A;if(d.length===0)return!1;for(A=n.isIdentifierStartES6,m=0,y=d.length;m<y;++m){if(O=d.charCodeAt(m),55296<=O&&O<=56319){if(++m,m>=y||(S=d.charCodeAt(m),!(56320<=S&&S<=57343)))return!1;O=l(O,S)}if(!A(O))return!1;A=n.isIdentifierPartES6}return!0}function u(d,m){return o(d)&&!r(d,m)}function h(d,m){return c(d)&&!a(d,m)}lw.exports={isKeywordES5:t,isKeywordES6:s,isReservedWordES5:r,isReservedWordES6:a,isRestrictedWord:i,isIdentifierNameES5:o,isIdentifierNameES6:c,isIdentifierES5:u,isIdentifierES6:h}})()),lw.exports}var Z5;function Nue(){return Z5||(Z5=1,(function(){Ip.ast=Fue(),Ip.code=Y6(),Ip.keyword=$ue()})()),Ip}var Lp={},cw={},qg={},Ug={},z5;function _ue(){if(z5)return Ug;z5=1;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return Ug.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},Ug.decode=function(e){var t=65,s=90,r=97,a=122,i=48,o=57,l=43,c=47,u=26,h=52;return t<=e&&e<=s?e-t:r<=e&&e<=a?e-r+u:i<=e&&e<=o?e-i+h:e==l?62:e==c?63:-1},Ug}var q5;function K6(){if(q5)return qg;q5=1;var n=_ue(),e=5,t=1<<e,s=t-1,r=t;function a(o){return o<0?(-o<<1)+1:(o<<1)+0}function i(o){var l=(o&1)===1,c=o>>1;return l?-c:c}return qg.encode=function(l){var c="",u,h=a(l);do u=h&s,h>>>=e,h>0&&(u|=r),c+=n.encode(u);while(h>0);return c},qg.decode=function(l,c,u){var h=l.length,d=0,m=0,y,O;do{if(c>=h)throw new Error("Expected more digits in base 64 VLQ value.");if(O=n.decode(l.charCodeAt(c++)),O===-1)throw new Error("Invalid base64 digit: "+l.charAt(c-1));y=!!(O&r),O&=s,d=d+(O<<m),m+=e}while(y);u.value=i(d),u.rest=c},qg}var uw={},U5;function eg(){return U5||(U5=1,(function(n){function e(N,$,L){if($ in N)return N[$];if(arguments.length===3)return L;throw new Error('"'+$+'" is a required argument.')}n.getArg=e;var t=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,s=/^data:.+\,.+$/;function r(N){var $=N.match(t);return $?{scheme:$[1],auth:$[2],host:$[3],port:$[4],path:$[5]}:null}n.urlParse=r;function a(N){var $="";return N.scheme&&($+=N.scheme+":"),$+="//",N.auth&&($+=N.auth+"@"),N.host&&($+=N.host),N.port&&($+=":"+N.port),N.path&&($+=N.path),$}n.urlGenerate=a;function i(N){var $=N,L=r(N);if(L){if(!L.path)return N;$=L.path}for(var I=n.isAbsolute($),q=$.split(/\/+/),ce,ee=0,he=q.length-1;he>=0;he--)ce=q[he],ce==="."?q.splice(he,1):ce===".."?ee++:ee>0&&(ce===""?(q.splice(he+1,ee),ee=0):(q.splice(he,2),ee--));return $=q.join("/"),$===""&&($=I?"/":"."),L?(L.path=$,a(L)):$}n.normalize=i;function o(N,$){N===""&&(N="."),$===""&&($=".");var L=r($),I=r(N);if(I&&(N=I.path||"/"),L&&!L.scheme)return I&&(L.scheme=I.scheme),a(L);if(L||$.match(s))return $;if(I&&!I.host&&!I.path)return I.host=$,a(I);var q=$.charAt(0)==="/"?$:i(N.replace(/\/+$/,"")+"/"+$);return I?(I.path=q,a(I)):q}n.join=o,n.isAbsolute=function(N){return N.charAt(0)==="/"||t.test(N)};function l(N,$){N===""&&(N="."),N=N.replace(/\/$/,"");for(var L=0;$.indexOf(N+"/")!==0;){var I=N.lastIndexOf("/");if(I<0||(N=N.slice(0,I),N.match(/^([^\/]+:\/)?\/*$/)))return $;++L}return Array(L+1).join("../")+$.substr(N.length+1)}n.relative=l;var c=(function(){var N=Object.create(null);return!("__proto__"in N)})();function u(N){return N}function h(N){return m(N)?"$"+N:N}n.toSetString=c?u:h;function d(N){return m(N)?N.slice(1):N}n.fromSetString=c?u:d;function m(N){if(!N)return!1;var $=N.length;if($<9||N.charCodeAt($-1)!==95||N.charCodeAt($-2)!==95||N.charCodeAt($-3)!==111||N.charCodeAt($-4)!==116||N.charCodeAt($-5)!==111||N.charCodeAt($-6)!==114||N.charCodeAt($-7)!==112||N.charCodeAt($-8)!==95||N.charCodeAt($-9)!==95)return!1;for(var L=$-10;L>=0;L--)if(N.charCodeAt(L)!==36)return!1;return!0}function y(N,$,L){var I=S(N.source,$.source);return I!==0||(I=N.originalLine-$.originalLine,I!==0)||(I=N.originalColumn-$.originalColumn,I!==0||L)||(I=N.generatedColumn-$.generatedColumn,I!==0)||(I=N.generatedLine-$.generatedLine,I!==0)?I:S(N.name,$.name)}n.compareByOriginalPositions=y;function O(N,$,L){var I=N.generatedLine-$.generatedLine;return I!==0||(I=N.generatedColumn-$.generatedColumn,I!==0||L)||(I=S(N.source,$.source),I!==0)||(I=N.originalLine-$.originalLine,I!==0)||(I=N.originalColumn-$.originalColumn,I!==0)?I:S(N.name,$.name)}n.compareByGeneratedPositionsDeflated=O;function S(N,$){return N===$?0:N===null?1:$===null?-1:N>$?1:-1}function A(N,$){var L=N.generatedLine-$.generatedLine;return L!==0||(L=N.generatedColumn-$.generatedColumn,L!==0)||(L=S(N.source,$.source),L!==0)||(L=N.originalLine-$.originalLine,L!==0)||(L=N.originalColumn-$.originalColumn,L!==0)?L:S(N.name,$.name)}n.compareByGeneratedPositionsInflated=A;function F(N){return JSON.parse(N.replace(/^\)]}'[^\n]*\n/,""))}n.parseSourceMapInput=F;function j(N,$,L){if($=$||"",N&&(N[N.length-1]!=="/"&&$[0]!=="/"&&(N+="/"),$=N+$),L){var I=r(L);if(!I)throw new Error("sourceMapURL could not be parsed");if(I.path){var q=I.path.lastIndexOf("/");q>=0&&(I.path=I.path.substring(0,q+1))}$=o(a(I),$)}return i($)}n.computeSourceURL=j})(uw)),uw}var hw={},W5;function J6(){if(W5)return hw;W5=1;var n=eg(),e=Object.prototype.hasOwnProperty,t=typeof Map<"u";function s(){this._array=[],this._set=t?new Map:Object.create(null)}return s.fromArray=function(a,i){for(var o=new s,l=0,c=a.length;l<c;l++)o.add(a[l],i);return o},s.prototype.size=function(){return t?this._set.size:Object.getOwnPropertyNames(this._set).length},s.prototype.add=function(a,i){var o=t?a:n.toSetString(a),l=t?this.has(a):e.call(this._set,o),c=this._array.length;(!l||i)&&this._array.push(a),l||(t?this._set.set(a,c):this._set[o]=c)},s.prototype.has=function(a){if(t)return this._set.has(a);var i=n.toSetString(a);return e.call(this._set,i)},s.prototype.indexOf=function(a){if(t){var i=this._set.get(a);if(i>=0)return i}else{var o=n.toSetString(a);if(e.call(this._set,o))return this._set[o]}throw new Error('"'+a+'" is not in the set.')},s.prototype.at=function(a){if(a>=0&&a<this._array.length)return this._array[a];throw new Error("No element indexed by "+a)},s.prototype.toArray=function(){return this._array.slice()},hw.ArraySet=s,hw}var dw={},G5;function Rue(){if(G5)return dw;G5=1;var n=eg();function e(s,r){var a=s.generatedLine,i=r.generatedLine,o=s.generatedColumn,l=r.generatedColumn;return i>a||i==a&&l>=o||n.compareByGeneratedPositionsInflated(s,r)<=0}function t(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return t.prototype.unsortedForEach=function(r,a){this._array.forEach(r,a)},t.prototype.add=function(r){e(this._last,r)?(this._last=r,this._array.push(r)):(this._sorted=!1,this._array.push(r))},t.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},dw.MappingList=t,dw}var X5;function eN(){if(X5)return cw;X5=1;var n=K6(),e=eg(),t=J6().ArraySet,s=Rue().MappingList;function r(a){a||(a={}),this._file=e.getArg(a,"file",null),this._sourceRoot=e.getArg(a,"sourceRoot",null),this._skipValidation=e.getArg(a,"skipValidation",!1),this._sources=new t,this._names=new t,this._mappings=new s,this._sourcesContents=null}return r.prototype._version=3,r.fromSourceMap=function(i){var o=i.sourceRoot,l=new r({file:i.file,sourceRoot:o});return i.eachMapping(function(c){var u={generated:{line:c.generatedLine,column:c.generatedColumn}};c.source!=null&&(u.source=c.source,o!=null&&(u.source=e.relative(o,u.source)),u.original={line:c.originalLine,column:c.originalColumn},c.name!=null&&(u.name=c.name)),l.addMapping(u)}),i.sources.forEach(function(c){var u=c;o!==null&&(u=e.relative(o,c)),l._sources.has(u)||l._sources.add(u);var h=i.sourceContentFor(c);h!=null&&l.setSourceContent(c,h)}),l},r.prototype.addMapping=function(i){var o=e.getArg(i,"generated"),l=e.getArg(i,"original",null),c=e.getArg(i,"source",null),u=e.getArg(i,"name",null);this._skipValidation||this._validateMapping(o,l,c,u),c!=null&&(c=String(c),this._sources.has(c)||this._sources.add(c)),u!=null&&(u=String(u),this._names.has(u)||this._names.add(u)),this._mappings.add({generatedLine:o.line,generatedColumn:o.column,originalLine:l!=null&&l.line,originalColumn:l!=null&&l.column,source:c,name:u})},r.prototype.setSourceContent=function(i,o){var l=i;this._sourceRoot!=null&&(l=e.relative(this._sourceRoot,l)),o!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(l)]=o):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(l)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},r.prototype.applySourceMap=function(i,o,l){var c=o;if(o==null){if(i.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);c=i.file}var u=this._sourceRoot;u!=null&&(c=e.relative(u,c));var h=new t,d=new t;this._mappings.unsortedForEach(function(m){if(m.source===c&&m.originalLine!=null){var y=i.originalPositionFor({line:m.originalLine,column:m.originalColumn});y.source!=null&&(m.source=y.source,l!=null&&(m.source=e.join(l,m.source)),u!=null&&(m.source=e.relative(u,m.source)),m.originalLine=y.line,m.originalColumn=y.column,y.name!=null&&(m.name=y.name))}var O=m.source;O!=null&&!h.has(O)&&h.add(O);var S=m.name;S!=null&&!d.has(S)&&d.add(S)},this),this._sources=h,this._names=d,i.sources.forEach(function(m){var y=i.sourceContentFor(m);y!=null&&(l!=null&&(m=e.join(l,m)),u!=null&&(m=e.relative(u,m)),this.setSourceContent(m,y))},this)},r.prototype._validateMapping=function(i,o,l,c){if(o&&typeof o.line!="number"&&typeof o.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(i&&"line"in i&&"column"in i&&i.line>0&&i.column>=0&&!o&&!l&&!c)){if(i&&"line"in i&&"column"in i&&o&&"line"in o&&"column"in o&&i.line>0&&i.column>=0&&o.line>0&&o.column>=0&&l)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:i,source:l,original:o,name:c}))}},r.prototype._serializeMappings=function(){for(var i=0,o=1,l=0,c=0,u=0,h=0,d="",m,y,O,S,A=this._mappings.toArray(),F=0,j=A.length;F<j;F++){if(y=A[F],m="",y.generatedLine!==o)for(i=0;y.generatedLine!==o;)m+=";",o++;else if(F>0){if(!e.compareByGeneratedPositionsInflated(y,A[F-1]))continue;m+=","}m+=n.encode(y.generatedColumn-i),i=y.generatedColumn,y.source!=null&&(S=this._sources.indexOf(y.source),m+=n.encode(S-h),h=S,m+=n.encode(y.originalLine-1-c),c=y.originalLine-1,m+=n.encode(y.originalColumn-l),l=y.originalColumn,y.name!=null&&(O=this._names.indexOf(y.name),m+=n.encode(O-u),u=O)),d+=m}return d},r.prototype._generateSourcesContent=function(i,o){return i.map(function(l){if(!this._sourcesContents)return null;o!=null&&(l=e.relative(o,l));var c=e.toSetString(l);return Object.prototype.hasOwnProperty.call(this._sourcesContents,c)?this._sourcesContents[c]:null},this)},r.prototype.toJSON=function(){var i={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(i.file=this._file),this._sourceRoot!=null&&(i.sourceRoot=this._sourceRoot),this._sourcesContents&&(i.sourcesContent=this._generateSourcesContent(i.sources,i.sourceRoot)),i},r.prototype.toString=function(){return JSON.stringify(this.toJSON())},cw.SourceMapGenerator=r,cw}var Qp={},pw={},H5;function Iue(){return H5||(H5=1,(function(n){n.GREATEST_LOWER_BOUND=1,n.LEAST_UPPER_BOUND=2;function e(t,s,r,a,i,o){var l=Math.floor((s-t)/2)+t,c=i(r,a[l],!0);return c===0?l:c>0?s-l>1?e(l,s,r,a,i,o):o==n.LEAST_UPPER_BOUND?s<a.length?s:-1:l:l-t>1?e(t,l,r,a,i,o):o==n.LEAST_UPPER_BOUND?l:t<0?-1:t}n.search=function(s,r,a,i){if(r.length===0)return-1;var o=e(-1,r.length,s,r,a,i||n.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&a(r[o],r[o-1],!0)===0;)--o;return o}})(pw)),pw}var mw={},Y5;function Lue(){if(Y5)return mw;Y5=1;function n(s,r,a){var i=s[r];s[r]=s[a],s[a]=i}function e(s,r){return Math.round(s+Math.random()*(r-s))}function t(s,r,a,i){if(a<i){var o=e(a,i),l=a-1;n(s,o,i);for(var c=s[i],u=a;u<i;u++)r(s[u],c)<=0&&(l+=1,n(s,l,u));n(s,l+1,u);var h=l+1;t(s,r,a,h-1),t(s,r,h+1,i)}}return mw.quickSort=function(s,r){t(s,r,0,s.length-1)},mw}var K5;function Que(){if(K5)return Qp;K5=1;var n=eg(),e=Iue(),t=J6().ArraySet,s=K6(),r=Lue().quickSort;function a(c,u){var h=c;return typeof c=="string"&&(h=n.parseSourceMapInput(c)),h.sections!=null?new l(h,u):new i(h,u)}a.fromSourceMap=function(c,u){return i.fromSourceMap(c,u)},a.prototype._version=3,a.prototype.__generatedMappings=null,Object.defineProperty(a.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),a.prototype.__originalMappings=null,Object.defineProperty(a.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),a.prototype._charIsMappingSeparator=function(u,h){var d=u.charAt(h);return d===";"||d===","},a.prototype._parseMappings=function(u,h){throw new Error("Subclasses must implement _parseMappings")},a.GENERATED_ORDER=1,a.ORIGINAL_ORDER=2,a.GREATEST_LOWER_BOUND=1,a.LEAST_UPPER_BOUND=2,a.prototype.eachMapping=function(u,h,d){var m=h||null,y=d||a.GENERATED_ORDER,O;switch(y){case a.GENERATED_ORDER:O=this._generatedMappings;break;case a.ORIGINAL_ORDER:O=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var S=this.sourceRoot;O.map(function(A){var F=A.source===null?null:this._sources.at(A.source);return F=n.computeSourceURL(S,F,this._sourceMapURL),{source:F,generatedLine:A.generatedLine,generatedColumn:A.generatedColumn,originalLine:A.originalLine,originalColumn:A.originalColumn,name:A.name===null?null:this._names.at(A.name)}},this).forEach(u,m)},a.prototype.allGeneratedPositionsFor=function(u){var h=n.getArg(u,"line"),d={source:n.getArg(u,"source"),originalLine:h,originalColumn:n.getArg(u,"column",0)};if(d.source=this._findSourceIndex(d.source),d.source<0)return[];var m=[],y=this._findMapping(d,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(y>=0){var O=this._originalMappings[y];if(u.column===void 0)for(var S=O.originalLine;O&&O.originalLine===S;)m.push({line:n.getArg(O,"generatedLine",null),column:n.getArg(O,"generatedColumn",null),lastColumn:n.getArg(O,"lastGeneratedColumn",null)}),O=this._originalMappings[++y];else for(var A=O.originalColumn;O&&O.originalLine===h&&O.originalColumn==A;)m.push({line:n.getArg(O,"generatedLine",null),column:n.getArg(O,"generatedColumn",null),lastColumn:n.getArg(O,"lastGeneratedColumn",null)}),O=this._originalMappings[++y]}return m},Qp.SourceMapConsumer=a;function i(c,u){var h=c;typeof c=="string"&&(h=n.parseSourceMapInput(c));var d=n.getArg(h,"version"),m=n.getArg(h,"sources"),y=n.getArg(h,"names",[]),O=n.getArg(h,"sourceRoot",null),S=n.getArg(h,"sourcesContent",null),A=n.getArg(h,"mappings"),F=n.getArg(h,"file",null);if(d!=this._version)throw new Error("Unsupported version: "+d);O&&(O=n.normalize(O)),m=m.map(String).map(n.normalize).map(function(j){return O&&n.isAbsolute(O)&&n.isAbsolute(j)?n.relative(O,j):j}),this._names=t.fromArray(y.map(String),!0),this._sources=t.fromArray(m,!0),this._absoluteSources=this._sources.toArray().map(function(j){return n.computeSourceURL(O,j,u)}),this.sourceRoot=O,this.sourcesContent=S,this._mappings=A,this._sourceMapURL=u,this.file=F}i.prototype=Object.create(a.prototype),i.prototype.consumer=a,i.prototype._findSourceIndex=function(c){var u=c;if(this.sourceRoot!=null&&(u=n.relative(this.sourceRoot,u)),this._sources.has(u))return this._sources.indexOf(u);var h;for(h=0;h<this._absoluteSources.length;++h)if(this._absoluteSources[h]==c)return h;return-1},i.fromSourceMap=function(u,h){var d=Object.create(i.prototype),m=d._names=t.fromArray(u._names.toArray(),!0),y=d._sources=t.fromArray(u._sources.toArray(),!0);d.sourceRoot=u._sourceRoot,d.sourcesContent=u._generateSourcesContent(d._sources.toArray(),d.sourceRoot),d.file=u._file,d._sourceMapURL=h,d._absoluteSources=d._sources.toArray().map(function(L){return n.computeSourceURL(d.sourceRoot,L,h)});for(var O=u._mappings.toArray().slice(),S=d.__generatedMappings=[],A=d.__originalMappings=[],F=0,j=O.length;F<j;F++){var N=O[F],$=new o;$.generatedLine=N.generatedLine,$.generatedColumn=N.generatedColumn,N.source&&($.source=y.indexOf(N.source),$.originalLine=N.originalLine,$.originalColumn=N.originalColumn,N.name&&($.name=m.indexOf(N.name)),A.push($)),S.push($)}return r(d.__originalMappings,n.compareByOriginalPositions),d},i.prototype._version=3,Object.defineProperty(i.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function o(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}i.prototype._parseMappings=function(u,h){for(var d=1,m=0,y=0,O=0,S=0,A=0,F=u.length,j=0,N={},$={},L=[],I=[],q,ce,ee,he,H;j<F;)if(u.charAt(j)===";")d++,j++,m=0;else if(u.charAt(j)===",")j++;else{for(q=new o,q.generatedLine=d,he=j;he<F&&!this._charIsMappingSeparator(u,he);he++);if(ce=u.slice(j,he),ee=N[ce],ee)j+=ce.length;else{for(ee=[];j<he;)s.decode(u,j,$),H=$.value,j=$.rest,ee.push(H);if(ee.length===2)throw new Error("Found a source, but no line and column");if(ee.length===3)throw new Error("Found a source and line, but no column");N[ce]=ee}q.generatedColumn=m+ee[0],m=q.generatedColumn,ee.length>1&&(q.source=S+ee[1],S+=ee[1],q.originalLine=y+ee[2],y=q.originalLine,q.originalLine+=1,q.originalColumn=O+ee[3],O=q.originalColumn,ee.length>4&&(q.name=A+ee[4],A+=ee[4])),I.push(q),typeof q.originalLine=="number"&&L.push(q)}r(I,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=I,r(L,n.compareByOriginalPositions),this.__originalMappings=L},i.prototype._findMapping=function(u,h,d,m,y,O){if(u[d]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+u[d]);if(u[m]<0)throw new TypeError("Column must be greater than or equal to 0, got "+u[m]);return e.search(u,h,y,O)},i.prototype.computeColumnSpans=function(){for(var u=0;u<this._generatedMappings.length;++u){var h=this._generatedMappings[u];if(u+1<this._generatedMappings.length){var d=this._generatedMappings[u+1];if(h.generatedLine===d.generatedLine){h.lastGeneratedColumn=d.generatedColumn-1;continue}}h.lastGeneratedColumn=1/0}},i.prototype.originalPositionFor=function(u){var h={generatedLine:n.getArg(u,"line"),generatedColumn:n.getArg(u,"column")},d=this._findMapping(h,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(u,"bias",a.GREATEST_LOWER_BOUND));if(d>=0){var m=this._generatedMappings[d];if(m.generatedLine===h.generatedLine){var y=n.getArg(m,"source",null);y!==null&&(y=this._sources.at(y),y=n.computeSourceURL(this.sourceRoot,y,this._sourceMapURL));var O=n.getArg(m,"name",null);return O!==null&&(O=this._names.at(O)),{source:y,line:n.getArg(m,"originalLine",null),column:n.getArg(m,"originalColumn",null),name:O}}}return{source:null,line:null,column:null,name:null}},i.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(u){return u==null}):!1},i.prototype.sourceContentFor=function(u,h){if(!this.sourcesContent)return null;var d=this._findSourceIndex(u);if(d>=0)return this.sourcesContent[d];var m=u;this.sourceRoot!=null&&(m=n.relative(this.sourceRoot,m));var y;if(this.sourceRoot!=null&&(y=n.urlParse(this.sourceRoot))){var O=m.replace(/^file:\/\//,"");if(y.scheme=="file"&&this._sources.has(O))return this.sourcesContent[this._sources.indexOf(O)];if((!y.path||y.path=="/")&&this._sources.has("/"+m))return this.sourcesContent[this._sources.indexOf("/"+m)]}if(h)return null;throw new Error('"'+m+'" is not in the SourceMap.')},i.prototype.generatedPositionFor=function(u){var h=n.getArg(u,"source");if(h=this._findSourceIndex(h),h<0)return{line:null,column:null,lastColumn:null};var d={source:h,originalLine:n.getArg(u,"line"),originalColumn:n.getArg(u,"column")},m=this._findMapping(d,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(u,"bias",a.GREATEST_LOWER_BOUND));if(m>=0){var y=this._originalMappings[m];if(y.source===d.source)return{line:n.getArg(y,"generatedLine",null),column:n.getArg(y,"generatedColumn",null),lastColumn:n.getArg(y,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},Qp.BasicSourceMapConsumer=i;function l(c,u){var h=c;typeof c=="string"&&(h=n.parseSourceMapInput(c));var d=n.getArg(h,"version"),m=n.getArg(h,"sections");if(d!=this._version)throw new Error("Unsupported version: "+d);this._sources=new t,this._names=new t;var y={line:-1,column:0};this._sections=m.map(function(O){if(O.url)throw new Error("Support for url field in sections not implemented.");var S=n.getArg(O,"offset"),A=n.getArg(S,"line"),F=n.getArg(S,"column");if(A<y.line||A===y.line&&F<y.column)throw new Error("Section offsets must be ordered and non-overlapping.");return y=S,{generatedOffset:{generatedLine:A+1,generatedColumn:F+1},consumer:new a(n.getArg(O,"map"),u)}})}return l.prototype=Object.create(a.prototype),l.prototype.constructor=a,l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){for(var c=[],u=0;u<this._sections.length;u++)for(var h=0;h<this._sections[u].consumer.sources.length;h++)c.push(this._sections[u].consumer.sources[h]);return c}}),l.prototype.originalPositionFor=function(u){var h={generatedLine:n.getArg(u,"line"),generatedColumn:n.getArg(u,"column")},d=e.search(h,this._sections,function(y,O){var S=y.generatedLine-O.generatedOffset.generatedLine;return S||y.generatedColumn-O.generatedOffset.generatedColumn}),m=this._sections[d];return m?m.consumer.originalPositionFor({line:h.generatedLine-(m.generatedOffset.generatedLine-1),column:h.generatedColumn-(m.generatedOffset.generatedLine===h.generatedLine?m.generatedOffset.generatedColumn-1:0),bias:u.bias}):{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(u){return u.consumer.hasContentsOfAllSources()})},l.prototype.sourceContentFor=function(u,h){for(var d=0;d<this._sections.length;d++){var m=this._sections[d],y=m.consumer.sourceContentFor(u,!0);if(y)return y}if(h)return null;throw new Error('"'+u+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(u){for(var h=0;h<this._sections.length;h++){var d=this._sections[h];if(d.consumer._findSourceIndex(n.getArg(u,"source"))!==-1){var m=d.consumer.generatedPositionFor(u);if(m){var y={line:m.line+(d.generatedOffset.generatedLine-1),column:m.column+(d.generatedOffset.generatedLine===m.line?d.generatedOffset.generatedColumn-1:0)};return y}}}return{line:null,column:null}},l.prototype._parseMappings=function(u,h){this.__generatedMappings=[],this.__originalMappings=[];for(var d=0;d<this._sections.length;d++)for(var m=this._sections[d],y=m.consumer._generatedMappings,O=0;O<y.length;O++){var S=y[O],A=m.consumer._sources.at(S.source);A=n.computeSourceURL(m.consumer.sourceRoot,A,this._sourceMapURL),this._sources.add(A),A=this._sources.indexOf(A);var F=null;S.name&&(F=m.consumer._names.at(S.name),this._names.add(F),F=this._names.indexOf(F));var j={source:A,generatedLine:S.generatedLine+(m.generatedOffset.generatedLine-1),generatedColumn:S.generatedColumn+(m.generatedOffset.generatedLine===S.generatedLine?m.generatedOffset.generatedColumn-1:0),originalLine:S.originalLine,originalColumn:S.originalColumn,name:F};this.__generatedMappings.push(j),typeof j.originalLine=="number"&&this.__originalMappings.push(j)}r(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),r(this.__originalMappings,n.compareByOriginalPositions)},Qp.IndexedSourceMapConsumer=l,Qp}var fw={},J5;function jue(){if(J5)return fw;J5=1;var n=eN().SourceMapGenerator,e=eg(),t=/(\r?\n)/,s=10,r="$$$isSourceNode$$$";function a(i,o,l,c,u){this.children=[],this.sourceContents={},this.line=i??null,this.column=o??null,this.source=l??null,this.name=u??null,this[r]=!0,c!=null&&this.add(c)}return a.fromStringWithSourceMap=function(o,l,c){var u=new a,h=o.split(t),d=0,m=function(){var F=N(),j=N()||"";return F+j;function N(){return d<h.length?h[d++]:void 0}},y=1,O=0,S=null;return l.eachMapping(function(F){if(S!==null)if(y<F.generatedLine)A(S,m()),y++,O=0;else{var j=h[d]||"",N=j.substr(0,F.generatedColumn-O);h[d]=j.substr(F.generatedColumn-O),O=F.generatedColumn,A(S,N),S=F;return}for(;y<F.generatedLine;)u.add(m()),y++;if(O<F.generatedColumn){var j=h[d]||"";u.add(j.substr(0,F.generatedColumn)),h[d]=j.substr(F.generatedColumn),O=F.generatedColumn}S=F},this),d<h.length&&(S&&A(S,m()),u.add(h.splice(d).join(""))),l.sources.forEach(function(F){var j=l.sourceContentFor(F);j!=null&&(c!=null&&(F=e.join(c,F)),u.setSourceContent(F,j))}),u;function A(F,j){if(F===null||F.source===void 0)u.add(j);else{var N=c?e.join(c,F.source):F.source;u.add(new a(F.originalLine,F.originalColumn,N,j,F.name))}}},a.prototype.add=function(o){if(Array.isArray(o))o.forEach(function(l){this.add(l)},this);else if(o[r]||typeof o=="string")o&&this.children.push(o);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+o);return this},a.prototype.prepend=function(o){if(Array.isArray(o))for(var l=o.length-1;l>=0;l--)this.prepend(o[l]);else if(o[r]||typeof o=="string")this.children.unshift(o);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+o);return this},a.prototype.walk=function(o){for(var l,c=0,u=this.children.length;c<u;c++)l=this.children[c],l[r]?l.walk(o):l!==""&&o(l,{source:this.source,line:this.line,column:this.column,name:this.name})},a.prototype.join=function(o){var l,c,u=this.children.length;if(u>0){for(l=[],c=0;c<u-1;c++)l.push(this.children[c]),l.push(o);l.push(this.children[c]),this.children=l}return this},a.prototype.replaceRight=function(o,l){var c=this.children[this.children.length-1];return c[r]?c.replaceRight(o,l):typeof c=="string"?this.children[this.children.length-1]=c.replace(o,l):this.children.push("".replace(o,l)),this},a.prototype.setSourceContent=function(o,l){this.sourceContents[e.toSetString(o)]=l},a.prototype.walkSourceContents=function(o){for(var l=0,c=this.children.length;l<c;l++)this.children[l][r]&&this.children[l].walkSourceContents(o);for(var u=Object.keys(this.sourceContents),l=0,c=u.length;l<c;l++)o(e.fromSetString(u[l]),this.sourceContents[u[l]])},a.prototype.toString=function(){var o="";return this.walk(function(l){o+=l}),o},a.prototype.toStringWithSourceMap=function(o){var l={code:"",line:1,column:0},c=new n(o),u=!1,h=null,d=null,m=null,y=null;return this.walk(function(O,S){l.code+=O,S.source!==null&&S.line!==null&&S.column!==null?((h!==S.source||d!==S.line||m!==S.column||y!==S.name)&&c.addMapping({source:S.source,original:{line:S.line,column:S.column},generated:{line:l.line,column:l.column},name:S.name}),h=S.source,d=S.line,m=S.column,y=S.name,u=!0):u&&(c.addMapping({generated:{line:l.line,column:l.column}}),h=null,u=!1);for(var A=0,F=O.length;A<F;A++)O.charCodeAt(A)===s?(l.line++,l.column=0,A+1===F?(h=null,u=!1):u&&c.addMapping({source:S.source,original:{line:S.line,column:S.column},generated:{line:l.line,column:l.column},name:S.name})):l.column++}),this.walkSourceContents(function(O,S){c.setSourceContent(O,S)}),{code:l.code,map:c}},fw.SourceNode=a,fw}var eD;function Vue(){return eD||(eD=1,Lp.SourceMapGenerator=eN().SourceMapGenerator,Lp.SourceMapConsumer=Que().SourceMapConsumer,Lp.SourceNode=jue().SourceNode),Lp}const Zue="2.1.0",zue={version:Zue};var tD;function que(){return tD||(tD=1,(function(n){(function(){var e,t,s,r,a,i,o,l,c,u,h,d,m,y,O,S,A,F,j,N,$,L,I,q,ce,ee;a=Bue(),i=Nue(),e=a.Syntax;function he(w){return st.Expression.hasOwnProperty(w.type)}function H(w){return st.Statement.hasOwnProperty(w.type)}t={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},s={"??":t.Coalesce,"||":t.LogicalOR,"&&":t.LogicalAND,"|":t.BitwiseOR,"^":t.BitwiseXOR,"&":t.BitwiseAND,"==":t.Equality,"!=":t.Equality,"===":t.Equality,"!==":t.Equality,is:t.Equality,isnt:t.Equality,"<":t.Relational,">":t.Relational,"<=":t.Relational,">=":t.Relational,in:t.Relational,instanceof:t.Relational,"<<":t.BitwiseSHIFT,">>":t.BitwiseSHIFT,">>>":t.BitwiseSHIFT,"+":t.Additive,"-":t.Additive,"*":t.Multiplicative,"%":t.Multiplicative,"/":t.Multiplicative,"**":t.Exponentiation};var me=1,Oe=2,Pe=4,De=8,Se=16,ae=32,Ee=64,Qe=Oe|Pe,Ke=me|Oe,ge=me|Oe|Pe,Ye=me,yt=Pe,Xe=me|Pe,Ge=me,Ct=me|ae,Et=0,gn=me|Se,On=me|De;function qn(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function cn(w,_){var B="";for(_|=0;_>0;_>>>=1,w+=w)_&1&&(B+=w);return B}function un(w){return/[\r\n]/g.test(w)}function Rt(w){var _=w.length;return _&&i.code.isLineTerminator(w.charCodeAt(_-1))}function Kt(w,_){var B;for(B in _)_.hasOwnProperty(B)&&(w[B]=_[B]);return w}function Un(w,_){var B,R;function Z(Y){return typeof Y=="object"&&Y instanceof Object&&!(Y instanceof RegExp)}for(B in _)_.hasOwnProperty(B)&&(R=_[B],Z(R)?Z(w[B])?Un(w[B],R):w[B]=Un({},R):w[B]=R);return w}function Wn(w){var _,B,R,Z,Y;if(w!==w)throw new Error("Numeric literal whose value is NaN");if(w<0||w===0&&1/w<0)throw new Error("Numeric literal whose value is negative");if(w===1/0)return c?"null":u?"1e400":"1e+400";if(_=""+w,!u||_.length<3)return _;for(B=_.indexOf("."),!c&&_.charCodeAt(0)===48&&B===1&&(B=0,_=_.slice(1)),R=_,_=_.replace("e+","e"),Z=0,(Y=R.indexOf("e"))>0&&(Z=+R.slice(Y+1),R=R.slice(0,Y)),B>=0&&(Z-=R.length-B-1,R=+(R.slice(0,B)+R.slice(B+1))+""),Y=0;R.charCodeAt(R.length+Y-1)===48;)--Y;return Y!==0&&(Z-=Y,R=R.slice(0,Y)),Z!==0&&(R+="e"+Z),(R.length<_.length||h&&w>1e12&&Math.floor(w)===w&&(R="0x"+w.toString(16)).length<_.length)&&+R===w&&(_=R),_}function bn(w,_){return(w&-2)===8232?(_?"u":"\\u")+(w===8232?"2028":"2029"):w===10||w===13?(_?"":"\\")+(w===10?"n":"r"):String.fromCharCode(w)}function rt(w){var _,B,R,Z,Y,se,te,be;if(B=w.toString(),w.source){if(_=B.match(/\/([^/]*)$/),!_)return B;for(R=_[1],B="",te=!1,be=!1,Z=0,Y=w.source.length;Z<Y;++Z)se=w.source.charCodeAt(Z),be?(B+=bn(se,be),be=!1):(te?se===93&&(te=!1):se===47?B+="\\":se===91&&(te=!0),B+=bn(se,be),be=se===92);return"/"+B+"/"+R}return B}function Pn(w,_){var B;return w===8?"\\b":w===12?"\\f":w===9?"\\t":(B=w.toString(16).toUpperCase(),c||w>255?"\\u"+"0000".slice(B.length)+B:w===0&&!i.code.isDecimalDigit(_)?"\\0":w===11?"\\x0B":"\\x"+"00".slice(B.length)+B)}function pt(w){if(w===92)return"\\\\";if(w===10)return"\\n";if(w===13)return"\\r";if(w===8232)return"\\u2028";if(w===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function Vt(w){var _,B,R,Z;for(Z=d==="double"?'"':"'",_=0,B=w.length;_<B;++_)if(R=w.charCodeAt(_),R===39){Z='"';break}else if(R===34){Z="'";break}else R===92&&++_;return Z+w+Z}function Zt(w){var _="",B,R,Z,Y=0,se=0,te,be;for(B=0,R=w.length;B<R;++B){if(Z=w.charCodeAt(B),Z===39)++Y;else if(Z===34)++se;else if(Z===47&&c)_+="\\";else if(i.code.isLineTerminator(Z)||Z===92){_+=pt(Z);continue}else if(!i.code.isIdentifierPartES5(Z)&&(c&&Z<32||!c&&!m&&(Z<32||Z>126))){_+=Pn(Z,w.charCodeAt(B+1));continue}_+=String.fromCharCode(Z)}if(te=!(d==="double"||d==="auto"&&se<Y),be=te?"'":'"',!(te?Y:se))return be+_+be;for(w=_,_=be,B=0,R=w.length;B<R;++B)Z=w.charCodeAt(B),(Z===39&&te||Z===34&&!te)&&(_+="\\"),_+=String.fromCharCode(Z);return _+be}function _n(w){var _,B,R,Z="";for(_=0,B=w.length;_<B;++_)R=w[_],Z+=Array.isArray(R)?_n(R):R;return Z}function it(w,_){if(!L)return Array.isArray(w)?_n(w):w;if(_==null){if(w instanceof r)return w;_={}}return _.loc==null?new r(null,null,L,w,_.name||null):new r(_.loc.start.line,_.loc.start.column,L===!0?_.loc.source||null:L,w,_.name||null)}function Ft(){return O||" "}function _e(w,_){var B,R,Z,Y;return B=it(w).toString(),B.length===0?[_]:(R=it(_).toString(),R.length===0?[w]:(Z=B.charCodeAt(B.length-1),Y=R.charCodeAt(0),(Z===43||Z===45)&&Z===Y||i.code.isIdentifierPartES5(Z)&&i.code.isIdentifierPartES5(Y)||Z===47&&Y===105?[w,Ft(),_]:i.code.isWhiteSpace(Z)||i.code.isLineTerminator(Z)||i.code.isWhiteSpace(Y)||i.code.isLineTerminator(Y)?[w,_]:[w,O,_]))}function Lt(w){return[o,w]}function et(w){var _;_=o,o+=l,w(o),o=_}function is(w){var _;for(_=w.length-1;_>=0&&!i.code.isLineTerminator(w.charCodeAt(_));--_);return w.length-1-_}function It(w,_){var B,R,Z,Y,se,te,be,$e;for(B=w.split(/\r\n|[\r\n]/),te=Number.MAX_VALUE,R=1,Z=B.length;R<Z;++R){for(Y=B[R],se=0;se<Y.length&&i.code.isWhiteSpace(Y.charCodeAt(se));)++se;te>se&&(te=se)}for(typeof _<"u"?(be=o,B[1][te]==="*"&&(_+=" "),o=_):(te&1&&--te,be=o),R=1,Z=B.length;R<Z;++R)$e=it(Lt(B[R].slice(te))),B[R]=L?$e.join(""):$e;return o=be,B.join(`
`)}function Dn(w,_){if(w.type==="Line"){if(Rt(w.value))return"//"+w.value;var B="//"+w.value;return q||(B+=`
`),B}return N.format.indent.adjustMultilineComment&&/[\n\r]/.test(w.value)?It("/*"+w.value+"*/",_):"/*"+w.value+"*/"}function Cs(w,_){var B,R,Z,Y,se,te,be,$e,Re,ut,on,Yn,Is,mn;if(w.leadingComments&&w.leadingComments.length>0){if(Y=_,q){for(Z=w.leadingComments[0],_=[],$e=Z.extendedRange,Re=Z.range,on=I.substring($e[0],Re[0]),mn=(on.match(/\n/g)||[]).length,mn>0?(_.push(cn(`
`,mn)),_.push(Lt(Dn(Z)))):(_.push(on),_.push(Dn(Z))),ut=Re,B=1,R=w.leadingComments.length;B<R;B++)Z=w.leadingComments[B],Re=Z.range,Yn=I.substring(ut[1],Re[0]),mn=(Yn.match(/\n/g)||[]).length,_.push(cn(`
`,mn)),_.push(Lt(Dn(Z))),ut=Re;Is=I.substring(Re[1],$e[1]),mn=(Is.match(/\n/g)||[]).length,_.push(cn(`
`,mn))}else for(Z=w.leadingComments[0],_=[],F&&w.type===e.Program&&w.body.length===0&&_.push(`
`),_.push(Dn(Z)),Rt(it(_).toString())||_.push(`
`),B=1,R=w.leadingComments.length;B<R;++B)Z=w.leadingComments[B],be=[Dn(Z)],Rt(it(be).toString())||be.push(`
`),_.push(Lt(be));_.push(Lt(Y))}if(w.trailingComments)if(q)Z=w.trailingComments[0],$e=Z.extendedRange,Re=Z.range,on=I.substring($e[0],Re[0]),mn=(on.match(/\n/g)||[]).length,mn>0?(_.push(cn(`
`,mn)),_.push(Lt(Dn(Z)))):(_.push(on),_.push(Dn(Z)));else for(se=!Rt(it(_).toString()),te=cn(" ",is(it([o,_,l]).toString())),B=0,R=w.trailingComments.length;B<R;++B)Z=w.trailingComments[B],se?(B===0?_=[_,l]:_=[_,te],_.push(Dn(Z,te))):_=[_,Lt(Dn(Z))],B!==R-1&&!Rt(it(_).toString())&&(_=[_,`
`]);return _}function Wt(w,_,B){var R,Z=0;for(R=w;R<_;R++)I[R]===`
`&&Z++;for(R=1;R<Z;R++)B.push(y)}function Pt(w,_,B){return _<B?["(",w,")"]:w}function $t(w){var _,B,R;for(R=w.split(/\r\n|\n/),_=1,B=R.length;_<B;_++)R[_]=y+o+R[_];return R}function xn(w,_){var B,R,Z;return B=w[N.verbatim],typeof B=="string"?R=Pt($t(B),t.Sequence,_):(R=$t(B.content),Z=B.precedence!=null?B.precedence:t.Sequence,R=Pt(R,Z,_)),it(R,w)}function st(){}st.prototype.maybeBlock=function(w,_){var B,R,Z=this;return R=!N.comment||!w.leadingComments,w.type===e.BlockStatement&&R?[O,this.generateStatement(w,_)]:w.type===e.EmptyStatement&&R?";":(et(function(){B=[y,Lt(Z.generateStatement(w,_))]}),B)},st.prototype.maybeBlockSuffix=function(w,_){var B=Rt(it(_).toString());return w.type===e.BlockStatement&&(!N.comment||!w.leadingComments)&&!B?[_,O]:B?[_,o]:[_,y,o]};function Gt(w){return it(w.name,w)}function an(w,_){return w.async?"async"+(_?Ft():O):""}function vs(w){var _=w.generator&&!N.moz.starlessGenerator;return _?"*"+O:""}function Vn(w){var _=w.value,B="";return _.async&&(B+=an(_,!w.computed)),_.generator&&(B+=vs(_)?"*":""),B}st.prototype.generatePattern=function(w,_,B){return w.type===e.Identifier?Gt(w):this.generateExpression(w,_,B)},st.prototype.generateFunctionParams=function(w){var _,B,R,Z;if(Z=!1,w.type===e.ArrowFunctionExpression&&!w.rest&&(!w.defaults||w.defaults.length===0)&&w.params.length===1&&w.params[0].type===e.Identifier)R=[an(w,!0),Gt(w.params[0])];else{for(R=w.type===e.ArrowFunctionExpression?[an(w,!1)]:[],R.push("("),w.defaults&&(Z=!0),_=0,B=w.params.length;_<B;++_)Z&&w.defaults[_]?R.push(this.generateAssignment(w.params[_],w.defaults[_],"=",t.Assignment,ge)):R.push(this.generatePattern(w.params[_],t.Assignment,ge)),_+1<B&&R.push(","+O);w.rest&&(w.params.length&&R.push(","+O),R.push("..."),R.push(Gt(w.rest))),R.push(")")}return R},st.prototype.generateFunctionBody=function(w){var _,B;return _=this.generateFunctionParams(w),w.type===e.ArrowFunctionExpression&&(_.push(O),_.push("=>")),w.expression?(_.push(O),B=this.generateExpression(w.body,t.Assignment,ge),B.toString().charAt(0)==="{"&&(B=["(",B,")"]),_.push(B)):_.push(this.maybeBlock(w.body,On)),_},st.prototype.generateIterationForStatement=function(w,_,B){var R=["for"+(_.await?Ft()+"await":"")+O+"("],Z=this;return et(function(){_.left.type===e.VariableDeclaration?et(function(){R.push(_.left.kind+Ft()),R.push(Z.generateStatement(_.left.declarations[0],Et))}):R.push(Z.generateExpression(_.left,t.Call,ge)),R=_e(R,w),R=[_e(R,Z.generateExpression(_.right,t.Assignment,ge)),")"]}),R.push(this.maybeBlock(_.body,B)),R},st.prototype.generatePropertyKey=function(w,_){var B=[];return _&&B.push("["),B.push(this.generateExpression(w,t.Assignment,ge)),_&&B.push("]"),B},st.prototype.generateAssignment=function(w,_,B,R,Z){return t.Assignment<R&&(Z|=me),Pt([this.generateExpression(w,t.Call,Z),O+B+O,this.generateExpression(_,t.Assignment,Z)],t.Assignment,R)},st.prototype.semicolon=function(w){return!A&&w&ae?"":";"},st.Statement={BlockStatement:function(w,_){var B,R,Z=["{",y],Y=this;return et(function(){w.body.length===0&&q&&(B=w.range,B[1]-B[0]>2&&(R=I.substring(B[0]+1,B[1]-1),R[0]===`
`&&(Z=["{"]),Z.push(R)));var se,te,be,$e;for($e=Ge,_&De&&($e|=Se),se=0,te=w.body.length;se<te;++se)q&&(se===0&&(w.body[0].leadingComments&&(B=w.body[0].leadingComments[0].extendedRange,R=I.substring(B[0],B[1]),R[0]===`
`&&(Z=["{"])),w.body[0].leadingComments||Wt(w.range[0],w.body[0].range[0],Z)),se>0&&!w.body[se-1].trailingComments&&!w.body[se].leadingComments&&Wt(w.body[se-1].range[1],w.body[se].range[0],Z)),se===te-1&&($e|=ae),w.body[se].leadingComments&&q?be=Y.generateStatement(w.body[se],$e):be=Lt(Y.generateStatement(w.body[se],$e)),Z.push(be),Rt(it(be).toString())||q&&se<te-1&&w.body[se+1].leadingComments||Z.push(y),q&&se===te-1&&(w.body[se].trailingComments||Wt(w.body[se].range[1],w.range[1],Z))}),Z.push(Lt("}")),Z},BreakStatement:function(w,_){return w.label?"break "+w.label.name+this.semicolon(_):"break"+this.semicolon(_)},ContinueStatement:function(w,_){return w.label?"continue "+w.label.name+this.semicolon(_):"continue"+this.semicolon(_)},ClassBody:function(w,_){var B=["{",y],R=this;return et(function(Z){var Y,se;for(Y=0,se=w.body.length;Y<se;++Y)B.push(Z),B.push(R.generateExpression(w.body[Y],t.Sequence,ge)),Y+1<se&&B.push(y)}),Rt(it(B).toString())||B.push(y),B.push(o),B.push("}"),B},ClassDeclaration:function(w,_){var B,R;return B=["class"],w.id&&(B=_e(B,this.generateExpression(w.id,t.Sequence,ge))),w.superClass&&(R=_e("extends",this.generateExpression(w.superClass,t.Unary,ge)),B=_e(B,R)),B.push(O),B.push(this.generateStatement(w.body,Ct)),B},DirectiveStatement:function(w,_){return N.raw&&w.raw?w.raw+this.semicolon(_):Vt(w.directive)+this.semicolon(_)},DoWhileStatement:function(w,_){var B=_e("do",this.maybeBlock(w.body,Ge));return B=this.maybeBlockSuffix(w.body,B),_e(B,["while"+O+"(",this.generateExpression(w.test,t.Sequence,ge),")"+this.semicolon(_)])},CatchClause:function(w,_){var B,R=this;return et(function(){var Z;w.param?(B=["catch"+O+"(",R.generateExpression(w.param,t.Sequence,ge),")"],w.guard&&(Z=R.generateExpression(w.guard,t.Sequence,ge),B.splice(2,0," if ",Z))):B=["catch"]}),B.push(this.maybeBlock(w.body,Ge)),B},DebuggerStatement:function(w,_){return"debugger"+this.semicolon(_)},EmptyStatement:function(w,_){return";"},ExportDefaultDeclaration:function(w,_){var B=["export"],R;return R=_&ae?Ct:Ge,B=_e(B,"default"),H(w.declaration)?B=_e(B,this.generateStatement(w.declaration,R)):B=_e(B,this.generateExpression(w.declaration,t.Assignment,ge)+this.semicolon(_)),B},ExportNamedDeclaration:function(w,_){var B=["export"],R,Z=this;return R=_&ae?Ct:Ge,w.declaration?_e(B,this.generateStatement(w.declaration,R)):(w.specifiers&&(w.specifiers.length===0?B=_e(B,"{"+O+"}"):w.specifiers[0].type===e.ExportBatchSpecifier?B=_e(B,this.generateExpression(w.specifiers[0],t.Sequence,ge)):(B=_e(B,"{"),et(function(Y){var se,te;for(B.push(y),se=0,te=w.specifiers.length;se<te;++se)B.push(Y),B.push(Z.generateExpression(w.specifiers[se],t.Sequence,ge)),se+1<te&&B.push(","+y)}),Rt(it(B).toString())||B.push(y),B.push(o+"}")),w.source?B=_e(B,["from"+O,this.generateExpression(w.source,t.Sequence,ge),this.semicolon(_)]):B.push(this.semicolon(_))),B)},ExportAllDeclaration:function(w,_){return["export"+O,"*"+O,"from"+O,this.generateExpression(w.source,t.Sequence,ge),this.semicolon(_)]},ExpressionStatement:function(w,_){var B,R;function Z(te){var be;return te.slice(0,5)!=="class"?!1:(be=te.charCodeAt(5),be===123||i.code.isWhiteSpace(be)||i.code.isLineTerminator(be))}function Y(te){var be;return te.slice(0,8)!=="function"?!1:(be=te.charCodeAt(8),be===40||i.code.isWhiteSpace(be)||be===42||i.code.isLineTerminator(be))}function se(te){var be,$e,Re;if(te.slice(0,5)!=="async"||!i.code.isWhiteSpace(te.charCodeAt(5)))return!1;for($e=6,Re=te.length;$e<Re&&i.code.isWhiteSpace(te.charCodeAt($e));++$e);return $e===Re||te.slice($e,$e+8)!=="function"?!1:(be=te.charCodeAt($e+8),be===40||i.code.isWhiteSpace(be)||be===42||i.code.isLineTerminator(be))}return B=[this.generateExpression(w.expression,t.Sequence,ge)],R=it(B).toString(),R.charCodeAt(0)===123||Z(R)||Y(R)||se(R)||j&&_&Se&&w.expression.type===e.Literal&&typeof w.expression.value=="string"?B=["(",B,")"+this.semicolon(_)]:B.push(this.semicolon(_)),B},ImportDeclaration:function(w,_){var B,R,Z=this;return w.specifiers.length===0?["import",O,this.generateExpression(w.source,t.Sequence,ge),this.semicolon(_)]:(B=["import"],R=0,w.specifiers[R].type===e.ImportDefaultSpecifier&&(B=_e(B,[this.generateExpression(w.specifiers[R],t.Sequence,ge)]),++R),w.specifiers[R]&&(R!==0&&B.push(","),w.specifiers[R].type===e.ImportNamespaceSpecifier?B=_e(B,[O,this.generateExpression(w.specifiers[R],t.Sequence,ge)]):(B.push(O+"{"),w.specifiers.length-R===1?(B.push(O),B.push(this.generateExpression(w.specifiers[R],t.Sequence,ge)),B.push(O+"}"+O)):(et(function(Y){var se,te;for(B.push(y),se=R,te=w.specifiers.length;se<te;++se)B.push(Y),B.push(Z.generateExpression(w.specifiers[se],t.Sequence,ge)),se+1<te&&B.push(","+y)}),Rt(it(B).toString())||B.push(y),B.push(o+"}"+O)))),B=_e(B,["from"+O,this.generateExpression(w.source,t.Sequence,ge),this.semicolon(_)]),B)},VariableDeclarator:function(w,_){var B=_&me?ge:Qe;return w.init?[this.generateExpression(w.id,t.Assignment,B),O,"=",O,this.generateExpression(w.init,t.Assignment,B)]:this.generatePattern(w.id,t.Assignment,B)},VariableDeclaration:function(w,_){var B,R,Z,Y,se,te=this;B=[w.kind],se=_&me?Ge:Et;function be(){for(Y=w.declarations[0],N.comment&&Y.leadingComments?(B.push(`
`),B.push(Lt(te.generateStatement(Y,se)))):(B.push(Ft()),B.push(te.generateStatement(Y,se))),R=1,Z=w.declarations.length;R<Z;++R)Y=w.declarations[R],N.comment&&Y.leadingComments?(B.push(","+y),B.push(Lt(te.generateStatement(Y,se)))):(B.push(","+O),B.push(te.generateStatement(Y,se)))}return w.declarations.length>1?et(be):be(),B.push(this.semicolon(_)),B},ThrowStatement:function(w,_){return[_e("throw",this.generateExpression(w.argument,t.Sequence,ge)),this.semicolon(_)]},TryStatement:function(w,_){var B,R,Z,Y;if(B=["try",this.maybeBlock(w.block,Ge)],B=this.maybeBlockSuffix(w.block,B),w.handlers)for(R=0,Z=w.handlers.length;R<Z;++R)B=_e(B,this.generateStatement(w.handlers[R],Ge)),(w.finalizer||R+1!==Z)&&(B=this.maybeBlockSuffix(w.handlers[R].body,B));else{for(Y=w.guardedHandlers||[],R=0,Z=Y.length;R<Z;++R)B=_e(B,this.generateStatement(Y[R],Ge)),(w.finalizer||R+1!==Z)&&(B=this.maybeBlockSuffix(Y[R].body,B));if(w.handler)if(Array.isArray(w.handler))for(R=0,Z=w.handler.length;R<Z;++R)B=_e(B,this.generateStatement(w.handler[R],Ge)),(w.finalizer||R+1!==Z)&&(B=this.maybeBlockSuffix(w.handler[R].body,B));else B=_e(B,this.generateStatement(w.handler,Ge)),w.finalizer&&(B=this.maybeBlockSuffix(w.handler.body,B))}return w.finalizer&&(B=_e(B,["finally",this.maybeBlock(w.finalizer,Ge)])),B},SwitchStatement:function(w,_){var B,R,Z,Y,se,te=this;if(et(function(){B=["switch"+O+"(",te.generateExpression(w.discriminant,t.Sequence,ge),")"+O+"{"+y]}),w.cases)for(se=Ge,Z=0,Y=w.cases.length;Z<Y;++Z)Z===Y-1&&(se|=ae),R=Lt(this.generateStatement(w.cases[Z],se)),B.push(R),Rt(it(R).toString())||B.push(y);return B.push(Lt("}")),B},SwitchCase:function(w,_){var B,R,Z,Y,se,te=this;return et(function(){for(w.test?B=[_e("case",te.generateExpression(w.test,t.Sequence,ge)),":"]:B=["default:"],Z=0,Y=w.consequent.length,Y&&w.consequent[0].type===e.BlockStatement&&(R=te.maybeBlock(w.consequent[0],Ge),B.push(R),Z=1),Z!==Y&&!Rt(it(B).toString())&&B.push(y),se=Ge;Z<Y;++Z)Z===Y-1&&_&ae&&(se|=ae),R=Lt(te.generateStatement(w.consequent[Z],se)),B.push(R),Z+1!==Y&&!Rt(it(R).toString())&&B.push(y)}),B},IfStatement:function(w,_){var B,R,Z,Y=this;return et(function(){B=["if"+O+"(",Y.generateExpression(w.test,t.Sequence,ge),")"]}),Z=_&ae,R=Ge,Z&&(R|=ae),w.alternate?(B.push(this.maybeBlock(w.consequent,Ge)),B=this.maybeBlockSuffix(w.consequent,B),w.alternate.type===e.IfStatement?B=_e(B,["else ",this.generateStatement(w.alternate,R)]):B=_e(B,_e("else",this.maybeBlock(w.alternate,R)))):B.push(this.maybeBlock(w.consequent,R)),B},ForStatement:function(w,_){var B,R=this;return et(function(){B=["for"+O+"("],w.init?w.init.type===e.VariableDeclaration?B.push(R.generateStatement(w.init,Et)):(B.push(R.generateExpression(w.init,t.Sequence,Qe)),B.push(";")):B.push(";"),w.test&&(B.push(O),B.push(R.generateExpression(w.test,t.Sequence,ge))),B.push(";"),w.update&&(B.push(O),B.push(R.generateExpression(w.update,t.Sequence,ge))),B.push(")")}),B.push(this.maybeBlock(w.body,_&ae?Ct:Ge)),B},ForInStatement:function(w,_){return this.generateIterationForStatement("in",w,_&ae?Ct:Ge)},ForOfStatement:function(w,_){return this.generateIterationForStatement("of",w,_&ae?Ct:Ge)},LabeledStatement:function(w,_){return[w.label.name+":",this.maybeBlock(w.body,_&ae?Ct:Ge)]},Program:function(w,_){var B,R,Z,Y,se;for(Y=w.body.length,B=[F&&Y>0?`
`:""],se=gn,Z=0;Z<Y;++Z)!F&&Z===Y-1&&(se|=ae),q&&(Z===0&&(w.body[0].leadingComments||Wt(w.range[0],w.body[Z].range[0],B)),Z>0&&!w.body[Z-1].trailingComments&&!w.body[Z].leadingComments&&Wt(w.body[Z-1].range[1],w.body[Z].range[0],B)),R=Lt(this.generateStatement(w.body[Z],se)),B.push(R),Z+1<Y&&!Rt(it(R).toString())&&(q&&w.body[Z+1].leadingComments||B.push(y)),q&&Z===Y-1&&(w.body[Z].trailingComments||Wt(w.body[Z].range[1],w.range[1],B));return B},FunctionDeclaration:function(w,_){return[an(w,!0),"function",vs(w)||Ft(),w.id?Gt(w.id):"",this.generateFunctionBody(w)]},ReturnStatement:function(w,_){return w.argument?[_e("return",this.generateExpression(w.argument,t.Sequence,ge)),this.semicolon(_)]:["return"+this.semicolon(_)]},WhileStatement:function(w,_){var B,R=this;return et(function(){B=["while"+O+"(",R.generateExpression(w.test,t.Sequence,ge),")"]}),B.push(this.maybeBlock(w.body,_&ae?Ct:Ge)),B},WithStatement:function(w,_){var B,R=this;return et(function(){B=["with"+O+"(",R.generateExpression(w.object,t.Sequence,ge),")"]}),B.push(this.maybeBlock(w.body,_&ae?Ct:Ge)),B}},Kt(st.prototype,st.Statement),st.Expression={SequenceExpression:function(w,_,B){var R,Z,Y;for(t.Sequence<_&&(B|=me),R=[],Z=0,Y=w.expressions.length;Z<Y;++Z)R.push(this.generateExpression(w.expressions[Z],t.Assignment,B)),Z+1<Y&&R.push(","+O);return Pt(R,t.Sequence,_)},AssignmentExpression:function(w,_,B){return this.generateAssignment(w.left,w.right,w.operator,_,B)},ArrowFunctionExpression:function(w,_,B){return Pt(this.generateFunctionBody(w),t.ArrowFunction,_)},ConditionalExpression:function(w,_,B){return t.Conditional<_&&(B|=me),Pt([this.generateExpression(w.test,t.Coalesce,B),O+"?"+O,this.generateExpression(w.consequent,t.Assignment,B),O+":"+O,this.generateExpression(w.alternate,t.Assignment,B)],t.Conditional,_)},LogicalExpression:function(w,_,B){return w.operator==="??"&&(B|=Ee),this.BinaryExpression(w,_,B)},BinaryExpression:function(w,_,B){var R,Z,Y,se,te,be;return se=s[w.operator],Z=w.operator==="**"?t.Postfix:se,Y=w.operator==="**"?se:se+1,se<_&&(B|=me),te=this.generateExpression(w.left,Z,B),be=te.toString(),be.charCodeAt(be.length-1)===47&&i.code.isIdentifierPartES5(w.operator.charCodeAt(0))?R=[te,Ft(),w.operator]:R=_e(te,w.operator),te=this.generateExpression(w.right,Y,B),w.operator==="/"&&te.toString().charAt(0)==="/"||w.operator.slice(-1)==="<"&&te.toString().slice(0,3)==="!--"?(R.push(Ft()),R.push(te)):R=_e(R,te),w.operator==="in"&&!(B&me)?["(",R,")"]:(w.operator==="||"||w.operator==="&&")&&B&Ee?["(",R,")"]:Pt(R,se,_)},CallExpression:function(w,_,B){var R,Z,Y;for(R=[this.generateExpression(w.callee,t.Call,Ke)],w.optional&&R.push("?."),R.push("("),Z=0,Y=w.arguments.length;Z<Y;++Z)R.push(this.generateExpression(w.arguments[Z],t.Assignment,ge)),Z+1<Y&&R.push(","+O);return R.push(")"),B&Oe?Pt(R,t.Call,_):["(",R,")"]},ChainExpression:function(w,_,B){t.OptionalChaining<_&&(B|=Oe);var R=this.generateExpression(w.expression,t.OptionalChaining,B);return Pt(R,t.OptionalChaining,_)},NewExpression:function(w,_,B){var R,Z,Y,se,te;if(Z=w.arguments.length,te=B&Pe&&!S&&Z===0?Xe:Ye,R=_e("new",this.generateExpression(w.callee,t.New,te)),!(B&Pe)||S||Z>0){for(R.push("("),Y=0,se=Z;Y<se;++Y)R.push(this.generateExpression(w.arguments[Y],t.Assignment,ge)),Y+1<se&&R.push(","+O);R.push(")")}return Pt(R,t.New,_)},MemberExpression:function(w,_,B){var R,Z;return R=[this.generateExpression(w.object,t.Call,B&Oe?Ke:Ye)],w.computed?(w.optional&&R.push("?."),R.push("["),R.push(this.generateExpression(w.property,t.Sequence,B&Oe?ge:Xe)),R.push("]")):(!w.optional&&w.object.type===e.Literal&&typeof w.object.value=="number"&&(Z=it(R).toString(),Z.indexOf(".")<0&&!/[eExX]/.test(Z)&&i.code.isDecimalDigit(Z.charCodeAt(Z.length-1))&&!(Z.length>=2&&Z.charCodeAt(0)===48)&&R.push(" ")),R.push(w.optional?"?.":"."),R.push(Gt(w.property))),Pt(R,t.Member,_)},MetaProperty:function(w,_,B){var R;return R=[],R.push(typeof w.meta=="string"?w.meta:Gt(w.meta)),R.push("."),R.push(typeof w.property=="string"?w.property:Gt(w.property)),Pt(R,t.Member,_)},UnaryExpression:function(w,_,B){var R,Z,Y,se,te;return Z=this.generateExpression(w.argument,t.Unary,ge),O===""?R=_e(w.operator,Z):(R=[w.operator],w.operator.length>2?R=_e(R,Z):(se=it(R).toString(),te=se.charCodeAt(se.length-1),Y=Z.toString().charCodeAt(0),((te===43||te===45)&&te===Y||i.code.isIdentifierPartES5(te)&&i.code.isIdentifierPartES5(Y))&&R.push(Ft()),R.push(Z))),Pt(R,t.Unary,_)},YieldExpression:function(w,_,B){var R;return w.delegate?R="yield*":R="yield",w.argument&&(R=_e(R,this.generateExpression(w.argument,t.Yield,ge))),Pt(R,t.Yield,_)},AwaitExpression:function(w,_,B){var R=_e(w.all?"await*":"await",this.generateExpression(w.argument,t.Await,ge));return Pt(R,t.Await,_)},UpdateExpression:function(w,_,B){return w.prefix?Pt([w.operator,this.generateExpression(w.argument,t.Unary,ge)],t.Unary,_):Pt([this.generateExpression(w.argument,t.Postfix,ge),w.operator],t.Postfix,_)},FunctionExpression:function(w,_,B){var R=[an(w,!0),"function"];return w.id?(R.push(vs(w)||Ft()),R.push(Gt(w.id))):R.push(vs(w)||O),R.push(this.generateFunctionBody(w)),R},ArrayPattern:function(w,_,B){return this.ArrayExpression(w,_,B,!0)},ArrayExpression:function(w,_,B,R){var Z,Y,se=this;return w.elements.length?(Y=R?!1:w.elements.length>1,Z=["[",Y?y:""],et(function(te){var be,$e;for(be=0,$e=w.elements.length;be<$e;++be)w.elements[be]?(Z.push(Y?te:""),Z.push(se.generateExpression(w.elements[be],t.Assignment,ge))):(Y&&Z.push(te),be+1===$e&&Z.push(",")),be+1<$e&&Z.push(","+(Y?y:O))}),Y&&!Rt(it(Z).toString())&&Z.push(y),Z.push(Y?o:""),Z.push("]"),Z):"[]"},RestElement:function(w,_,B){return"..."+this.generatePattern(w.argument)},ClassExpression:function(w,_,B){var R,Z;return R=["class"],w.id&&(R=_e(R,this.generateExpression(w.id,t.Sequence,ge))),w.superClass&&(Z=_e("extends",this.generateExpression(w.superClass,t.Unary,ge)),R=_e(R,Z)),R.push(O),R.push(this.generateStatement(w.body,Ct)),R},MethodDefinition:function(w,_,B){var R,Z;return w.static?R=["static"+O]:R=[],w.kind==="get"||w.kind==="set"?Z=[_e(w.kind,this.generatePropertyKey(w.key,w.computed)),this.generateFunctionBody(w.value)]:Z=[Vn(w),this.generatePropertyKey(w.key,w.computed),this.generateFunctionBody(w.value)],_e(R,Z)},Property:function(w,_,B){return w.kind==="get"||w.kind==="set"?[w.kind,Ft(),this.generatePropertyKey(w.key,w.computed),this.generateFunctionBody(w.value)]:w.shorthand?w.value.type==="AssignmentPattern"?this.AssignmentPattern(w.value,t.Sequence,ge):this.generatePropertyKey(w.key,w.computed):w.method?[Vn(w),this.generatePropertyKey(w.key,w.computed),this.generateFunctionBody(w.value)]:[this.generatePropertyKey(w.key,w.computed),":"+O,this.generateExpression(w.value,t.Assignment,ge)]},ObjectExpression:function(w,_,B){var R,Z,Y,se=this;return w.properties.length?(R=w.properties.length>1,et(function(){Y=se.generateExpression(w.properties[0],t.Sequence,ge)}),!R&&!un(it(Y).toString())?["{",O,Y,O,"}"]:(et(function(te){var be,$e;if(Z=["{",y,te,Y],R)for(Z.push(","+y),be=1,$e=w.properties.length;be<$e;++be)Z.push(te),Z.push(se.generateExpression(w.properties[be],t.Sequence,ge)),be+1<$e&&Z.push(","+y)}),Rt(it(Z).toString())||Z.push(y),Z.push(o),Z.push("}"),Z)):"{}"},AssignmentPattern:function(w,_,B){return this.generateAssignment(w.left,w.right,"=",_,B)},ObjectPattern:function(w,_,B){var R,Z,Y,se,te,be=this;if(!w.properties.length)return"{}";if(se=!1,w.properties.length===1)te=w.properties[0],te.type===e.Property&&te.value.type!==e.Identifier&&(se=!0);else for(Z=0,Y=w.properties.length;Z<Y;++Z)if(te=w.properties[Z],te.type===e.Property&&!te.shorthand){se=!0;break}return R=["{",se?y:""],et(function($e){var Re,ut;for(Re=0,ut=w.properties.length;Re<ut;++Re)R.push(se?$e:""),R.push(be.generateExpression(w.properties[Re],t.Sequence,ge)),Re+1<ut&&R.push(","+(se?y:O))}),se&&!Rt(it(R).toString())&&R.push(y),R.push(se?o:""),R.push("}"),R},ThisExpression:function(w,_,B){return"this"},Super:function(w,_,B){return"super"},Identifier:function(w,_,B){return Gt(w)},ImportDefaultSpecifier:function(w,_,B){return Gt(w.id||w.local)},ImportNamespaceSpecifier:function(w,_,B){var R=["*"],Z=w.id||w.local;return Z&&R.push(O+"as"+Ft()+Gt(Z)),R},ImportSpecifier:function(w,_,B){var R=w.imported,Z=[R.name],Y=w.local;return Y&&Y.name!==R.name&&Z.push(Ft()+"as"+Ft()+Gt(Y)),Z},ExportSpecifier:function(w,_,B){var R=w.local,Z=[R.name],Y=w.exported;return Y&&Y.name!==R.name&&Z.push(Ft()+"as"+Ft()+Gt(Y)),Z},Literal:function(w,_,B){var R;if(w.hasOwnProperty("raw")&&$&&N.raw)try{if(R=$(w.raw).body[0].expression,R.type===e.Literal&&R.value===w.value)return w.raw}catch{}return w.regex?"/"+w.regex.pattern+"/"+w.regex.flags:typeof w.value=="bigint"?w.value.toString()+"n":w.bigint?w.bigint+"n":w.value===null?"null":typeof w.value=="string"?Zt(w.value):typeof w.value=="number"?Wn(w.value):typeof w.value=="boolean"?w.value?"true":"false":rt(w.value)},GeneratorExpression:function(w,_,B){return this.ComprehensionExpression(w,_,B)},ComprehensionExpression:function(w,_,B){var R,Z,Y,se,te=this;return R=w.type===e.GeneratorExpression?["("]:["["],N.moz.comprehensionExpressionStartsWithAssignment&&(se=this.generateExpression(w.body,t.Assignment,ge),R.push(se)),w.blocks&&et(function(){for(Z=0,Y=w.blocks.length;Z<Y;++Z)se=te.generateExpression(w.blocks[Z],t.Sequence,ge),Z>0||N.moz.comprehensionExpressionStartsWithAssignment?R=_e(R,se):R.push(se)}),w.filter&&(R=_e(R,"if"+O),se=this.generateExpression(w.filter,t.Sequence,ge),R=_e(R,["(",se,")"])),N.moz.comprehensionExpressionStartsWithAssignment||(se=this.generateExpression(w.body,t.Assignment,ge),R=_e(R,se)),R.push(w.type===e.GeneratorExpression?")":"]"),R},ComprehensionBlock:function(w,_,B){var R;return w.left.type===e.VariableDeclaration?R=[w.left.kind,Ft(),this.generateStatement(w.left.declarations[0],Et)]:R=this.generateExpression(w.left,t.Call,ge),R=_e(R,w.of?"of":"in"),R=_e(R,this.generateExpression(w.right,t.Sequence,ge)),["for"+O+"(",R,")"]},SpreadElement:function(w,_,B){return["...",this.generateExpression(w.argument,t.Assignment,ge)]},TaggedTemplateExpression:function(w,_,B){var R=Ke;B&Oe||(R=Ye);var Z=[this.generateExpression(w.tag,t.Call,R),this.generateExpression(w.quasi,t.Primary,yt)];return Pt(Z,t.TaggedTemplate,_)},TemplateElement:function(w,_,B){return w.value.raw},TemplateLiteral:function(w,_,B){var R,Z,Y;for(R=["`"],Z=0,Y=w.quasis.length;Z<Y;++Z)R.push(this.generateExpression(w.quasis[Z],t.Primary,ge)),Z+1<Y&&(R.push("${"+O),R.push(this.generateExpression(w.expressions[Z],t.Sequence,ge)),R.push(O+"}"));return R.push("`"),R},ModuleSpecifier:function(w,_,B){return this.Literal(w,_,B)},ImportExpression:function(w,_,B){return Pt(["import(",this.generateExpression(w.source,t.Assignment,ge),")"],t.Call,_)}},Kt(st.prototype,st.Expression),st.prototype.generateExpression=function(w,_,B){var R,Z;return Z=w.type||e.Property,N.verbatim&&w.hasOwnProperty(N.verbatim)?xn(w,_):(R=this[Z](w,_,B),N.comment&&(R=Cs(w,R)),it(R,w))},st.prototype.generateStatement=function(w,_){var B,R;return B=this[w.type](w,_),N.comment&&(B=Cs(w,B)),R=it(B).toString(),w.type===e.Program&&!F&&y===""&&R.charAt(R.length-1)===`
`&&(B=L?it(B).replaceRight(/\s+$/,""):R.replace(/\s+$/,"")),it(B,w)};function Hs(w){var _;if(_=new st,H(w))return _.generateStatement(w,Ge);if(he(w))return _.generateExpression(w,t.Sequence,ge);throw new Error("Unknown node type: "+w.type)}function Ys(w,_){var B=qn(),R,Z;return _!=null?(typeof _.indent=="string"&&(B.format.indent.style=_.indent),typeof _.base=="number"&&(B.format.indent.base=_.base),_=Un(B,_),l=_.format.indent.style,typeof _.base=="string"?o=_.base:o=cn(l,_.format.indent.base)):(_=B,l=_.format.indent.style,o=cn(l,_.format.indent.base)),c=_.format.json,u=_.format.renumber,h=c?!1:_.format.hexadecimal,d=c?"double":_.format.quotes,m=_.format.escapeless,y=_.format.newline,O=_.format.space,_.format.compact&&(y=O=l=o=""),S=_.format.parentheses,A=_.format.semicolons,F=_.format.safeConcatenation,j=_.directive,$=c?null:_.parse,L=_.sourceMap,I=_.sourceCode,q=_.format.preserveBlankLines&&I!==null,N=_,L&&(n.browser?r=zoe.sourceMap.SourceNode:r=Vue().SourceNode),R=Hs(w),L?(Z=R.toStringWithSourceMap({file:_.file,sourceRoot:_.sourceMapRoot}),_.sourceContent&&Z.map.setSourceContent(_.sourceMap,_.sourceContent),_.sourceMapWithCode?Z:Z.map.toString()):(Z={code:R.toString(),map:null},_.sourceMapWithCode?Z:Z.code)}ce={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},ee=qn().format,n.version=zue.version,n.generate=Ys,n.attachComments=a.attachComments,n.Precedence=Un({},t),n.browser=!1,n.FORMAT_MINIFY=ce,n.FORMAT_DEFAULTS=ee})()})(rw)),rw}var tN=que();class Uue{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:e=>this.replacement=e}}replace(e,t,s,r){e&&t&&(s!=null?e[t][s]=r:e[t]=r)}remove(e,t,s){e&&t&&(s!=null?e[t].splice(s,1):delete e[t])}}class Wue extends Uue{constructor(e,t){super(),this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:s=>this.replacement=s},this.enter=e,this.leave=t}visit(e,t,s,r){if(e){if(this.enter){const i=this.should_skip,o=this.should_remove,l=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,e,t,s,r),this.replacement&&(e=this.replacement,this.replace(t,s,r,e)),this.should_remove&&this.remove(t,s,r);const c=this.should_skip,u=this.should_remove;if(this.should_skip=i,this.should_remove=o,this.replacement=l,c)return e;if(u)return null}let a;for(a in e){const i=e[a];if(i&&typeof i=="object")if(Array.isArray(i)){const o=i;for(let l=0;l<o.length;l+=1){const c=o[l];nD(c)&&(this.visit(c,e,a,l)||l--)}}else nD(i)&&this.visit(i,e,a,null)}if(this.leave){const i=this.replacement,o=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,e,t,s,r),this.replacement&&(e=this.replacement,this.replace(t,s,r,e)),this.should_remove&&this.remove(t,s,r);const l=this.should_remove;if(this.replacement=i,this.should_remove=o,l)return null}}return e}}function nD(n){return n!==null&&typeof n=="object"&&"type"in n&&typeof n.type=="string"}function nN(n,{enter:e,leave:t}){return new Wue(e,t).visit(n,null)}let sN=[];function rN(n){sN.push(n)}let _d=new Map;function Gue(n,e){_d.set(n,e)}function aN(n,e={}){var y;const{wrapAsync:t=!1,addReturn:s=!0,emitMiniLocations:r=!0,emitWidgets:a=!0}=e,i=[];let o=Tue(n,{ecmaVersion:2022,allowAwaitOutsideFunction:!0,locations:!0,onComment:i});const l=yhe(i,n.length);let c=[];const u=(O,S)=>{const A=_d.get("minilang");if(A){const F=`[${O}]`,j=A.getLocations(F,S.start);c=c.concat(j)}else{const F=p6(`"${O}"`,S.start,n);c=c.concat(F)}};let h=[];nN(o,{enter(O,S){var A,F,j;if(phe(O)){const{name:N}=O.tag,$=_d.get(N),L=O.quasi.quasis[0].value.raw,I=O.quasi.start+1;if(r){const q=$.getLocations(L,I);c=c.concat(q)}return this.skip(),this.replace(bhe(N,L,I))}if(mhe(O,"tidal")){const N=O.quasi.quasis[0].value.raw,$=O.quasi.start+1;if(r){const L=fhe(N,$);c=c.concat(L)}return this.skip(),this.replace(ghe(N,$))}if(rhe(O,S)){if(oD(O.start,l))return;const{quasis:N}=O,{raw:$}=N[0].value;return this.skip(),r&&u($,O),this.replace(iD($,O))}if(she(O)){if(oD(O.start,l))return;const{value:N}=O;return this.skip(),r&&u(N,O),this.replace(iD(N,O))}if(ahe(O))return a&&h.push({from:O.arguments[0].start,to:O.arguments[0].end,value:O.arguments[0].raw,min:((A=O.arguments[1])==null?void 0:A.value)??0,max:((F=O.arguments[2])==null?void 0:F.value)??1,step:(j=O.arguments[3])==null?void 0:j.value,type:"slider"}),this.replace(ohe(O));if(ihe(O)){const N=O.callee.property.name,$=h.filter(I=>I.type===N).length,L={to:O.end,index:$,type:N,id:e.id};return a&&h.push(L),this.replace(lhe(O,L))}if(che(O,S))return this.replace(uhe(O));if(hhe(O))return this.replace(dhe(O))},leave(O,S,A,F){if(!Xue(O))return;let[j,...N]=O.arguments;if(!j)throw new Error("K(...) requires an expression");Hue(j)&&(j={type:"CallExpression",callee:j,arguments:[],optional:!1});const{template:$,patternExprs:L}=Yue(j);if(L.length){const ce=[{type:"Literal",value:$},...L,...N];let ee=O.callee;return ee.type==="ChainExpression"&&(ee=ee.expression),ee.type==="MemberExpression"?this.replace({type:"CallExpression",callee:aD(ee.object),arguments:ce,optional:!1}):this.replace({type:"CallExpression",callee:{type:"Identifier",name:"worklet"},arguments:ce,optional:!1})}const I=[{type:"Literal",value:f2(j)},...N];let q=O.callee;return q.type==="ChainExpression"&&(q=q.expression),q.type==="MemberExpression"?this.replace({type:"CallExpression",callee:aD(q.object),arguments:I,optional:!1}):this.replace({type:"CallExpression",callee:{type:"Identifier",name:"worklet"},arguments:I,optional:!1})}});let{body:d}=o;if(!d.length)console.warn("empty body -> fallback to silence"),d.push({type:"ExpressionStatement",expression:{type:"Identifier",name:"silence"}});else if(!((y=d==null?void 0:d[d.length-1])!=null&&y.expression))throw new Error("unexpected ast format without body expression");if(s){const{expression:O}=d[d.length-1];d[d.length-1]={type:"ReturnStatement",argument:O}}let m=tN.generate(o);return t&&(m=`(async ()=>{${m}})()`),r?{output:m,miniLocations:c,widgets:h}:{output:m}}function Xue(n){var t;if(n.type!=="CallExpression")return!1;let e=n.callee;return e.type==="ChainExpression"&&(e=e.expression),e.type==="MemberExpression"?!e.computed&&((t=e.property)==null?void 0:t.name)==="K":e.type==="Identifier"&&e.name==="K"}function Hue(n){var e;return n.type!=="ArrowFunctionExpression"&&n.type!=="FunctionExpression"||n.params.length?!1:((e=n.body)==null?void 0:e.type)==="BlockStatement"}function f2(n){return tN.generate(n,{format:{semicolons:!1}})}function Yue(n){const e=rD(n),t=new Map,s=[];if(nN(e,{enter(i,o,l,c){t.set(i,{parent:o,prop:l,index:c});const u=Kue(i);u&&(s.push({node:i,patternExpr:u}),this.skip())}}),!s.length)return{template:f2(e),patternExprs:[]};s.sort((i,o)=>sD(i.node)-sD(o.node));const r=s.map(({patternExpr:i})=>rD(i));let a=e;return s.forEach(({node:i},o)=>{a=nhe(i,the(o),t,a)}),{template:f2(a),patternExprs:r}}function Kue(n){var e;if(Jue(n)){const t=(e=n.arguments)==null?void 0:e[0];if(!t)throw new Error("S(...) requires an argument");return t}return iN(n)?n:null}function Jue(n){var t;if(n.type!=="CallExpression")return!1;const e=n.callee;return e.type==="Identifier"?e.name==="S":e.type==="MemberExpression"&&!e.computed?((t=e.property)==null?void 0:t.name)==="S":!1}function ehe(){var n;return((n=_d.get("minilang"))==null?void 0:n.name)||"m"}function iN(n){var s;if(n.type!=="CallExpression")return!1;const e=n.callee;if(e.type!=="Identifier"||e.name!==ehe())return!1;const t=(s=n.arguments)==null?void 0:s[0];return(t==null?void 0:t.type)==="Literal"&&typeof t.value=="string"}function sD(n){var e;if(typeof n.start=="number")return n.start;if(iN(n)){const t=(e=n.arguments)==null?void 0:e[1];if((t==null?void 0:t.type)==="Literal"&&typeof t.value=="number")return t.value}return 0}function the(n){return{type:"MemberExpression",object:{type:"Identifier",name:"pat"},property:{type:"Literal",value:n},computed:!0,optional:!1}}function nhe(n,e,t,s){const r=t.get(n);if(!r||!r.parent)return e;const{parent:a,prop:i,index:o}=r;return Array.isArray(a[i])?a[i][o]=e:a[i]=e,t.set(e,{parent:a,prop:i,index:o}),s}function rD(n){return JSON.parse(JSON.stringify(n))}function aD(n){return{type:"MemberExpression",object:n,property:{type:"Identifier",name:"worklet"},computed:!1,optional:!1}}function she(n,e,t){return n.type!=="Literal"?!1:n.raw[0]==='"'}function rhe(n,e){return n.type==="TemplateLiteral"&&e.type!=="TaggedTemplateExpression"}function iD(n,e){const{start:t}=e,s=_d.get("minilang");let r="m";return s&&s.name&&(r=s.name),{type:"CallExpression",callee:{type:"Identifier",name:r},arguments:[{type:"Literal",value:n},{type:"Literal",value:t}],optional:!1}}function ahe(n){return n.type==="CallExpression"&&n.callee.name==="slider"}function ihe(n){var e;return n.type==="CallExpression"&&sN.includes((e=n.callee.property)==null?void 0:e.name)}function ohe(n){const e="slider_"+n.arguments[0].start;return n.arguments.unshift({type:"Literal",value:e,raw:e}),n.callee.name="sliderWithID",n}function qP(n){return`${n.id||""}_widget_${n.type}_${n.index}`}function lhe(n,e){const t=qP(e);return n.arguments.unshift({type:"Literal",value:t,raw:t}),n}function che(n,e){return n.type==="CallExpression"&&n.callee.name==="samples"&&e.type!=="AwaitExpression"}function uhe(n){return{type:"AwaitExpression",argument:n}}function hhe(n){return n.type==="LabeledStatement"}function dhe(n){return{type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"MemberExpression",object:n.body.expression,property:{type:"Identifier",name:"p"}},arguments:[{type:"Literal",value:n.label.name,raw:`'${n.label.name}'`}]}}}function phe(n){return n.type==="TaggedTemplateExpression"&&_d.has(n.tag.name)}function mhe(n,e){return n.type==="TaggedTemplateExpression"&&n.tag.name===e}function fhe(n,e){return n.split("").reduce((t,s,r)=>(s!=='"'||(!t.length||t[t.length-1].length>1?t.push([r+1]):t[t.length-1].push(r)),t),[]).map(([t,s])=>{const r=n.slice(t,s);return p6(`"${r}"`,e+t-1)}).flat()}function ghe(n,e){return{type:"CallExpression",callee:{type:"Identifier",name:"tidal"},arguments:[{type:"Literal",value:n},{type:"Literal",value:e}],optional:!1}}function bhe(n,e,t){return{type:"CallExpression",callee:{type:"Identifier",name:n},arguments:[{type:"Literal",value:e},{type:"Literal",value:t}],optional:!1}}function yhe(n,e){const t=[],s=[];for(const r of n){const a=r.value.trim();if(a.startsWith("mini-off"))s.push(r.start);else if(a.startsWith("mini-on")){const i=s.pop();t.push([i,r.end])}}for(;s.length;){const r=s.pop();t.push([r,e])}return t}function oD(n,e){for(const[t,s]of e)if(n>=t&&n<s)return!0;return!1}const vhe=n=>eX(n,aN),Ohe=Object.freeze(Object.defineProperty({__proto__:null,evaluate:vhe,getWidgetID:qP,registerLanguage:Gue,registerWidgetType:rN,transpiler:aN},Symbol.toStringTag,{value:"Module"}));let lD=n=>n,Qh={},g2={addEventListener(){},removeEventListener(){}};function whe(){try{return typeof localStorage<"u"}catch{return!1}}whe()&&(Qh=localStorage);let xhe={addEventListener(n,e,t){window.addEventListener("storage",e),window.addEventListener("pageshow",t)},removeEventListener(n,e,t){window.removeEventListener("storage",e),window.removeEventListener("pageshow",t)}};typeof window<"u"&&(g2=xhe);function khe(n,e=void 0,t={}){let s=t.encode||lD,r=t.decode||lD,a=rX(e),i=a.set;a.set=c=>{typeof c>"u"?delete Qh[n]:Qh[n]=s(c),i(c)};function o(c){c.key===n?c.newValue===null?i(void 0):i(r(c.newValue)):Qh[n]||i(void 0)}function l(){a.set(Qh[n]?r(Qh[n]):e)}return sX(a,()=>{if(l(),t.listen!==!1)return g2.addEventListener(n,o,l),()=>{g2.removeEventListener(n,o,l)}}),a}const She=JSON.parse(`[{"comment":"/**\\n * Overrides the css of highlighted events. Make sure to use single quotes!\\n * @name markcss\\n * @example\\n * note(\\"c a f e\\")\\n * .markcss('text-decoration:underline')\\n */","meta":{"filename":"codemirror.mjs","lineno":379,"columnno":0,"path":"/home/alex/src/strudel/packages/codemirror","code":{}},"description":"<p>Overrides the css of highlighted events. Make sure to use single quotes!</p>","name":"markcss","examples":["note(\\"c a f e\\")\\n.markcss('text-decoration:underline')"],"longname":"markcss","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a slider widget to allow the user manipulate a value\\n *\\n * @name slider\\n * @param {number} value Initial value\\n * @param {number} min Minimum value - optional, defaults to 0\\n * @param {number} max Maximum value - optional, defaults to 1\\n * @param {number} step Step size - optional\\n */","meta":{"filename":"slider.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/codemirror","code":{}},"description":"<p>Displays a slider widget to allow the user manipulate a value</p>","name":"slider","params":[{"type":{"names":["number"]},"description":"<p>Initial value</p>","name":"value"},{"type":{"names":["number"]},"description":"<p>Minimum value - optional, defaults to 0</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>Maximum value - optional, defaults to 1</p>","name":"max"},{"type":{"names":["number"]},"description":"<p>Step size - optional</p>","name":"step"}],"longname":"slider","kind":"member","scope":"global"},{"comment":"/**\\n * Select a sound / sample by name. When using mininotation, you can also optionally supply 'n' and 'gain' parameters\\n * separated by ':'.\\n *\\n * @name s\\n * @param {string | Pattern} sound The sound / pattern of sounds to pick\\n * @synonyms sound\\n * @example\\n * s(\\"bd hh\\")\\n * @example\\n * s(\\"bd:0 bd:1 bd:0:0.3 bd:1:1.4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":75,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Select a sound / sample by name. When using mininotation, you can also optionally supply 'n' and 'gain' parameters\\nseparated by ':'.</p>","name":"s","params":[{"type":{"names":["string","Pattern"]},"description":"<p>The sound / pattern of sounds to pick</p>","name":"sound"}],"synonyms_text":"sound","synonyms":["sound"],"examples":["s(\\"bd hh\\")","s(\\"bd:0 bd:1 bd:0:0.3 bd:1:1.4\\")"],"longname":"s","kind":"member","scope":"global"},{"comment":"/**\\n * Position in the wavetable of the wavetable oscillator\\n *\\n * @name wt\\n * @param {number | Pattern} position Position in the wavetable from 0 to 1\\n * @synonyms wavetablePosition\\n * @example\\n * s(\\"squelch\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").wt(\\"0 0.25 0.5 0.75 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":90,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Position in the wavetable of the wavetable oscillator</p>","name":"wt","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Position in the wavetable from 0 to 1</p>","name":"position"}],"synonyms_text":"wavetablePosition","synonyms":["wavetablePosition"],"examples":["s(\\"squelch\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").wt(\\"0 0.25 0.5 0.75 1\\")"],"longname":"wt","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of envelope applied wavetable oscillator's position envelope\\n *\\n * @name wtenv\\n * @param {number | Pattern} amount between 0 and 1\\n */","meta":{"filename":"controls.mjs","lineno":101,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of envelope applied wavetable oscillator's position envelope</p>","name":"wtenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"amount"}],"longname":"wtenv","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of the wavetable oscillator's position envelope\\n *\\n * @name wtattack\\n * @synonyms wtatt\\n * @param {number | Pattern} time attack time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":108,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of the wavetable oscillator's position envelope</p>","name":"wtattack","synonyms_text":"wtatt","synonyms":["wtatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"}],"longname":"wtattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of the wavetable oscillator's position envelope\\n *\\n * @name wtdecay\\n * @synonyms wtdec\\n * @param {number | Pattern} time decay time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":117,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of the wavetable oscillator's position envelope</p>","name":"wtdecay","synonyms_text":"wtdec","synonyms":["wtdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"longname":"wtdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain time of the wavetable oscillator's position envelope\\n *\\n * @name wtsustain\\n * @synonyms wtsus\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n */","meta":{"filename":"controls.mjs","lineno":126,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain time of the wavetable oscillator's position envelope</p>","name":"wtsustain","synonyms_text":"wtsus","synonyms":["wtsus"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"}],"longname":"wtsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of the wavetable oscillator's position envelope\\n *\\n * @name wtrelease\\n * @synonyms wtrel\\n * @param {number | Pattern} time release time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":135,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of the wavetable oscillator's position envelope</p>","name":"wtrelease","synonyms_text":"wtrel","synonyms":["wtrel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"longname":"wtrelease","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of the LFO for the wavetable oscillator's position\\n *\\n * @name wtrate\\n * @param {number | Pattern} rate rate in hertz\\n */","meta":{"filename":"controls.mjs","lineno":144,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of the LFO for the wavetable oscillator's position</p>","name":"wtrate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in hertz</p>","name":"rate"}],"longname":"wtrate","kind":"member","scope":"global"},{"comment":"/**\\n * cycle synced rate of the LFO for the wavetable oscillator's position\\n *\\n * @name wtsync\\n * @param {number | Pattern} rate rate in cycles\\n */","meta":{"filename":"controls.mjs","lineno":151,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>cycle synced rate of the LFO for the wavetable oscillator's position</p>","name":"wtsync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in cycles</p>","name":"rate"}],"longname":"wtsync","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of the LFO for the wavetable oscillator's position\\n *\\n * @name wtdepth\\n * @param {number | Pattern} depth depth of modulation\\n */","meta":{"filename":"controls.mjs","lineno":159,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of the LFO for the wavetable oscillator's position</p>","name":"wtdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation</p>","name":"depth"}],"longname":"wtdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of the LFO for the wavetable oscillator's position\\n *\\n * @name wtshape\\n * @param {number | Pattern} shape Shape of the lfo (0, 1, 2, ..)\\n */","meta":{"filename":"controls.mjs","lineno":167,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of the LFO for the wavetable oscillator's position</p>","name":"wtshape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Shape of the lfo (0, 1, 2, ..)</p>","name":"shape"}],"longname":"wtshape","kind":"member","scope":"global"},{"comment":"/**\\n * DC offset of the LFO for the wavetable oscillator's position\\n *\\n * @name wtdc\\n * @param {number | Pattern} dcoffset dc offset. set to 0 for unipolar\\n */","meta":{"filename":"controls.mjs","lineno":175,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DC offset of the LFO for the wavetable oscillator's position</p>","name":"wtdc","params":[{"type":{"names":["number","Pattern"]},"description":"<p>dc offset. set to 0 for unipolar</p>","name":"dcoffset"}],"longname":"wtdc","kind":"member","scope":"global"},{"comment":"/**\\n * Skew of the LFO for the wavetable oscillator's position\\n *\\n * @name wtskew\\n * @param {number | Pattern} skew How much to bend the LFO shape\\n */","meta":{"filename":"controls.mjs","lineno":183,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Skew of the LFO for the wavetable oscillator's position</p>","name":"wtskew","params":[{"type":{"names":["number","Pattern"]},"description":"<p>How much to bend the LFO shape</p>","name":"skew"}],"longname":"wtskew","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of warp (alteration of the waveform) to apply to the wavetable oscillator\\n *\\n * @name warp\\n * @param {number | Pattern} amount Warp of the wavetable from 0 to 1\\n * @synonyms wavetableWarp\\n * @example\\n * s(\\"basique\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n *   .warpmode(\\"spin\\")\\n */","meta":{"filename":"controls.mjs","lineno":191,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of warp (alteration of the waveform) to apply to the wavetable oscillator</p>","name":"warp","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Warp of the wavetable from 0 to 1</p>","name":"amount"}],"synonyms_text":"wavetableWarp","synonyms":["wavetableWarp"],"examples":["s(\\"basique\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n  .warpmode(\\"spin\\")"],"longname":"warp","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of the wavetable oscillator's warp envelope\\n *\\n * @name warpattack\\n * @synonyms warpatt\\n * @param {number | Pattern} time attack time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":203,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of the wavetable oscillator's warp envelope</p>","name":"warpattack","synonyms_text":"warpatt","synonyms":["warpatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"}],"longname":"warpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of the wavetable oscillator's warp envelope\\n *\\n * @name warpdecay\\n * @synonyms warpdec\\n * @param {number | Pattern} time decay time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of the wavetable oscillator's warp envelope</p>","name":"warpdecay","synonyms_text":"warpdec","synonyms":["warpdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"longname":"warpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain time of the wavetable oscillator's warp envelope\\n *\\n * @name warpsustain\\n * @synonyms warpsus\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n */","meta":{"filename":"controls.mjs","lineno":221,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain time of the wavetable oscillator's warp envelope</p>","name":"warpsustain","synonyms_text":"warpsus","synonyms":["warpsus"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"}],"longname":"warpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of the wavetable oscillator's warp envelope\\n *\\n * @name warprelease\\n * @synonyms warprel\\n * @param {number | Pattern} time release time in seconds\\n */","meta":{"filename":"controls.mjs","lineno":230,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of the wavetable oscillator's warp envelope</p>","name":"warprelease","synonyms_text":"warprel","synonyms":["warprel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"longname":"warprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of the LFO for the wavetable oscillator's warp\\n *\\n * @name warprate\\n * @param {number | Pattern} rate rate in hertz\\n */","meta":{"filename":"controls.mjs","lineno":239,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of the LFO for the wavetable oscillator's warp</p>","name":"warprate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in hertz</p>","name":"rate"}],"longname":"warprate","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpdepth\\n * @param {number | Pattern} depth depth of modulation\\n */","meta":{"filename":"controls.mjs","lineno":247,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of the LFO for the wavetable oscillator's warp</p>","name":"warpdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation</p>","name":"depth"}],"longname":"warpdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpshape\\n * @param {number | Pattern} shape Shape of the lfo (0, 1, 2, ..)\\n */","meta":{"filename":"controls.mjs","lineno":255,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of the LFO for the wavetable oscillator's warp</p>","name":"warpshape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Shape of the lfo (0, 1, 2, ..)</p>","name":"shape"}],"longname":"warpshape","kind":"member","scope":"global"},{"comment":"/**\\n * DC offset of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpdc\\n * @param {number | Pattern} dcoffset dc offset. set to 0 for unipolar\\n */","meta":{"filename":"controls.mjs","lineno":263,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DC offset of the LFO for the wavetable oscillator's warp</p>","name":"warpdc","params":[{"type":{"names":["number","Pattern"]},"description":"<p>dc offset. set to 0 for unipolar</p>","name":"dcoffset"}],"longname":"warpdc","kind":"member","scope":"global"},{"comment":"/**\\n * Skew of the LFO for the wavetable oscillator's warp\\n *\\n * @name warpskew\\n * @param {number | Pattern} skew How much to bend the LFO shape\\n */","meta":{"filename":"controls.mjs","lineno":271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Skew of the LFO for the wavetable oscillator's warp</p>","name":"warpskew","params":[{"type":{"names":["number","Pattern"]},"description":"<p>How much to bend the LFO shape</p>","name":"skew"}],"longname":"warpskew","kind":"member","scope":"global"},{"comment":"/**\\n * Type of warp (alteration of the waveform) to apply to the wavetable oscillator.\\n *\\n * The current options are: none, asym, bendp, bendm, bendmp, sync, quant, fold, pwm, orbit,\\n * spin, chaos, primes, binary, brownian, reciprocal, wormhole, logistic, sigmoid, fractal, flip\\n *\\n * @name warpmode\\n * @param {number | string | Pattern} mode Warp mode\\n * @synonyms wavetableWarpMode\\n * @example\\n * s(\\"morgana\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n *   .warpmode(\\"<asym bendp spin logistic sync wormhole brownian>*2\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":279,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Type of warp (alteration of the waveform) to apply to the wavetable oscillator.</p>\\n<p>The current options are: none, asym, bendp, bendm, bendmp, sync, quant, fold, pwm, orbit,\\nspin, chaos, primes, binary, brownian, reciprocal, wormhole, logistic, sigmoid, fractal, flip</p>","name":"warpmode","params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>Warp mode</p>","name":"mode"}],"synonyms_text":"wavetableWarpMode","synonyms":["wavetableWarpMode"],"examples":["s(\\"morgana\\").bank(\\"wt_digital\\").seg(8).note(\\"F1\\").warp(\\"0 0.25 0.5 0.75 1\\")\\n  .warpmode(\\"<asym bendp spin logistic sync wormhole brownian>*2\\")"],"longname":"warpmode","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of randomness of the initial phase of the wavetable oscillator.\\n *\\n * @name wtphaserand\\n * @param {number | Pattern} amount Randomness of the initial phase. Between 0 (not random) and 1 (fully random)\\n * @synonyms wavetablePhaseRand\\n * @example\\n * s(\\"basique\\").bank(\\"wt_digital\\").seg(16).wtphaserand(\\"<0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":295,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of randomness of the initial phase of the wavetable oscillator.</p>","name":"wtphaserand","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Randomness of the initial phase. Between 0 (not random) and 1 (fully random)</p>","name":"amount"}],"synonyms_text":"wavetablePhaseRand","synonyms":["wavetablePhaseRand"],"examples":["s(\\"basique\\").bank(\\"wt_digital\\").seg(16).wtphaserand(\\"<0 1>\\")"],"longname":"wtphaserand","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of envelope applied wavetable oscillator's position envelope\\n *\\n * @name warpenv\\n * @param {number | Pattern} amount between 0 and 1\\n */","meta":{"filename":"controls.mjs","lineno":307,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of envelope applied wavetable oscillator's position envelope</p>","name":"warpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"amount"}],"longname":"warpenv","kind":"member","scope":"global"},{"comment":"/**\\n * cycle synced rate of the LFO for the wavetable warp position\\n *\\n * @name warpsync\\n * @param {number | Pattern} rate rate in cycles\\n */","meta":{"filename":"controls.mjs","lineno":315,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>cycle synced rate of the LFO for the wavetable warp position</p>","name":"warpsync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>rate in cycles</p>","name":"rate"}],"longname":"warpsync","kind":"member","scope":"global"},{"comment":"/**\\n * Define a custom webaudio node to use as a sound source.\\n *\\n * @name source\\n * @synonyms src\\n * @param {function} getSource\\n * @synonyms src\\n *\\n */","meta":{"filename":"controls.mjs","lineno":323,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Define a custom webaudio node to use as a sound source.</p>","name":"source","synonyms_text":"src","synonyms":["src"],"params":[{"type":{"names":["function"]},"name":"getSource"}],"longname":"source","kind":"member","scope":"global"},{"comment":"/**\\n * Selects the given index from the sample map.\\n * Numbers too high will wrap around.\\n * \`n\` can also be used to play midi numbers, but it is recommended to use \`note\` instead.\\n *\\n * @name n\\n * @param {number | Pattern} value sample index starting from 0\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").n(\\"<0 1>\\")\\n */","meta":{"filename":"controls.mjs","lineno":333,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Selects the given index from the sample map.\\nNumbers too high will wrap around.\\n<code>n</code> can also be used to play midi numbers, but it is recommended to use <code>note</code> instead.</p>","name":"n","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sample index starting from 0</p>","name":"value"}],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").n(\\"<0 1>\\")"],"longname":"n","kind":"member","scope":"global"},{"comment":"/**\\n * Plays the given note name or midi number. A note name consists of\\n *\\n * - a letter (a-g or A-G)\\n * - optional accidentals (b or #)\\n * - optional (possibly negative) octave number (0-9). Defaults to 3\\n *\\n * Examples of valid note names: \`c\`, \`bb\`, \`Bb\`, \`f#\`, \`c3\`, \`A4\`, \`Eb2\`, \`c#5\`\\n *\\n * You can also use midi numbers instead of note names, where 69 is mapped to A4 440Hz in 12EDO.\\n *\\n * @name note\\n * @example\\n * note(\\"c a f e\\")\\n * @example\\n * note(\\"c4 a4 f4 e4\\")\\n * @example\\n * note(\\"60 69 65 64\\")\\n * @example\\n * note(\\"fbb1 a#0 cbbb-1 e##-2\\").sound(\\"saw\\")\\n */","meta":{"filename":"controls.mjs","lineno":345,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Plays the given note name or midi number. A note name consists of</p>\\n<ul>\\n<li>a letter (a-g or A-G)</li>\\n<li>optional accidentals (b or #)</li>\\n<li>optional (possibly negative) octave number (0-9). Defaults to 3</li>\\n</ul>\\n<p>Examples of valid note names: <code>c</code>, <code>bb</code>, <code>Bb</code>, <code>f#</code>, <code>c3</code>, <code>A4</code>, <code>Eb2</code>, <code>c#5</code></p>\\n<p>You can also use midi numbers instead of note names, where 69 is mapped to A4 440Hz in 12EDO.</p>","name":"note","examples":["note(\\"c a f e\\")","note(\\"c4 a4 f4 e4\\")","note(\\"60 69 65 64\\")","note(\\"fbb1 a#0 cbbb-1 e##-2\\").sound(\\"saw\\")"],"longname":"note","kind":"member","scope":"global"},{"comment":"/**\\n * A pattern of numbers that speed up (or slow down) samples while they play. Currently only supported by osc / superdirt.\\n *\\n * @name accelerate\\n * @param {number | Pattern} amount acceleration.\\n * @superdirtOnly\\n * @example\\n * s(\\"sax\\").accelerate(\\"<0 1 2 4 8 16>\\").slow(2).osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":368,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A pattern of numbers that speed up (or slow down) samples while they play. Currently only supported by osc / superdirt.</p>","name":"accelerate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>acceleration.</p>","name":"amount"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"sax\\").accelerate(\\"<0 1 2 4 8 16>\\").slow(2).osc()"],"longname":"accelerate","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the velocity from 0 to 1. Is multiplied together with gain.\\n *\\n * @name velocity\\n * @example\\n * s(\\"hh*8\\")\\n * .gain(\\".4!2 1 .4!2 1 .4 1\\")\\n * .velocity(\\".4 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":379,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the velocity from 0 to 1. Is multiplied together with gain.</p>","name":"velocity","examples":["s(\\"hh*8\\")\\n.gain(\\".4!2 1 .4!2 1 .4 1\\")\\n.velocity(\\".4 1\\")"],"longname":"velocity","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the gain by an exponential amount.\\n *\\n * @name gain\\n * @param {number | Pattern} amount gain.\\n * @example\\n * s(\\"hh*8\\").gain(\\".4!2 1 .4!2 1 .4 1\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":389,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the gain by an exponential amount.</p>","name":"gain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>gain.</p>","name":"amount"}],"examples":["s(\\"hh*8\\").gain(\\".4!2 1 .4!2 1 .4 1\\").fast(2)"],"longname":"gain","kind":"member","scope":"global"},{"comment":"/**\\n * Gain applied after all effects have been processed.\\n *\\n * @name postgain\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\")\\n * .compressor(\\"-20:20:10:.002:.02\\").postgain(1.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":399,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Gain applied after all effects have been processed.</p>","name":"postgain","examples":["s(\\"bd sd [~ bd] sd,hh*8\\")\\n.compressor(\\"-20:20:10:.002:.02\\").postgain(1.5)"],"longname":"postgain","kind":"member","scope":"global"},{"comment":"/**\\n * Like \`gain\`, but linear.\\n *\\n * @name amp\\n * @param {number | Pattern} amount gain.\\n * @superdirtOnly\\n * @example\\n * s(\\"bd*8\\").amp(\\".1*2 .5 .1*2 .5 .1 .5\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":409,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>gain</code>, but linear.</p>","name":"amp","params":[{"type":{"names":["number","Pattern"]},"description":"<p>gain.</p>","name":"amount"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"bd*8\\").amp(\\".1*2 .5 .1*2 .5 .1 .5\\").osc()"],"longname":"amp","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope attack time: Specifies how long it takes for the sound to reach its peak value, relative to the onset.\\n *\\n * @name attack\\n * @param {number | Pattern} attack time in seconds.\\n * @synonyms att\\n * @example\\n * note(\\"c3 e3 f3 g3\\").attack(\\"<0 .1 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":420,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope attack time: Specifies how long it takes for the sound to reach its peak value, relative to the onset.</p>","name":"attack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds.</p>","name":"attack"}],"synonyms_text":"att","synonyms":["att"],"examples":["note(\\"c3 e3 f3 g3\\").attack(\\"<0 .1 .5>\\")"],"longname":"attack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the Frequency Modulation Harmonicity Ratio.\\n * Controls the timbre of the sound.\\n * Whole numbers and simple ratios sound more natural,\\n * while decimal numbers and complex ratios sound metallic.\\n *\\n * @name fmh\\n * @param {number | Pattern} harmonicity\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmh(\\"<1 2 1.5 1.61>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":432,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the Frequency Modulation Harmonicity Ratio.\\nControls the timbre of the sound.\\nWhole numbers and simple ratios sound more natural,\\nwhile decimal numbers and complex ratios sound metallic.</p>","name":"fmh","params":[{"type":{"names":["number","Pattern"]},"name":"harmonicity"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmh(\\"<1 2 1.5 1.61>\\")\\n._scope()"],"longname":"fmh","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the Frequency Modulation of the synth.\\n * Controls the modulation index, which defines the brightness of the sound.\\n *\\n * @name fm\\n * @param {number | Pattern} brightness modulation index\\n * @synonyms fmi\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(\\"<0 1 2 8 32>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the Frequency Modulation of the synth.\\nControls the modulation index, which defines the brightness of the sound.</p>","name":"fm","params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation index</p>","name":"brightness"}],"synonyms_text":"fmi","synonyms":["fmi"],"examples":["note(\\"c e g b g e\\")\\n.fm(\\"<0 1 2 8 32>\\")\\n._scope()"],"longname":"fm","kind":"member","scope":"global"},{"comment":"/**\\n * Ramp type of fm envelope. Exp might be a bit broken..\\n *\\n * @name fmenv\\n * @param {number | Pattern} type lin | exp\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(.2)\\n * .fmsustain(0)\\n * .fmenv(\\"<exp lin>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":463,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Ramp type of fm envelope. Exp might be a bit broken..</p>","name":"fmenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>lin | exp</p>","name":"type"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(.2)\\n.fmsustain(0)\\n.fmenv(\\"<exp lin>\\")\\n._scope()"],"longname":"fmenv","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time for the FM envelope: time it takes to reach maximum modulation\\n *\\n * @name fmattack\\n * @param {number | Pattern} time attack time\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmattack(\\"<0 .05 .1 .2>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":478,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time for the FM envelope: time it takes to reach maximum modulation</p>","name":"fmattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time</p>","name":"time"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmattack(\\"<0 .05 .1 .2>\\")\\n._scope()"],"longname":"fmattack","kind":"member","scope":"global"},{"comment":"/**\\n * Waveform of the fm modulator\\n *\\n * @name fmwave\\n * @param {number | Pattern} wave waveform\\n * @example\\n * n(\\"0 1 2 3\\".fast(4)).scale(\\"d:minor\\").s(\\"sine\\").fmwave(\\"<sine square sawtooth crackle>\\").fm(4).fmh(2.01)\\n * @example\\n * n(\\"0 1 2 3\\".fast(4)).chord(\\"<Dm Am F G>\\").voicing().s(\\"sawtooth\\").fmwave(\\"brown\\").fm(.6)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":492,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Waveform of the fm modulator</p>","name":"fmwave","params":[{"type":{"names":["number","Pattern"]},"description":"<p>waveform</p>","name":"wave"}],"examples":["n(\\"0 1 2 3\\".fast(4)).scale(\\"d:minor\\").s(\\"sine\\").fmwave(\\"<sine square sawtooth crackle>\\").fm(4).fmh(2.01)","n(\\"0 1 2 3\\".fast(4)).chord(\\"<Dm Am F G>\\").voicing().s(\\"sawtooth\\").fmwave(\\"brown\\").fm(.6)"],"longname":"fmwave","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time for the FM envelope: seconds until the sustain level is reached after the attack phase.\\n *\\n * @name fmdecay\\n * @param {number | Pattern} time decay time\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(\\"<.01 .05 .1 .2>\\")\\n * .fmsustain(.4)\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":505,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time for the FM envelope: seconds until the sustain level is reached after the attack phase.</p>","name":"fmdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time</p>","name":"time"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(\\"<.01 .05 .1 .2>\\")\\n.fmsustain(.4)\\n._scope()"],"longname":"fmdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain level for the FM envelope: how much modulation is applied after the decay phase\\n *\\n * @name fmsustain\\n * @param {number | Pattern} level sustain level\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(.1)\\n * .fmsustain(\\"<1 .75 .5 0>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":519,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sustain level for the FM envelope: how much modulation is applied after the decay phase</p>","name":"fmsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level</p>","name":"level"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(.1)\\n.fmsustain(\\"<1 .75 .5 0>\\")\\n._scope()"],"longname":"fmsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Select the sound bank to use. To be used together with \`s\`. The bank name (+ \\"_\\") will be prepended to the value of \`s\`.\\n *\\n * @name bank\\n * @param {string | Pattern} bank the name of the bank\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").bank('RolandTR909') // = s(\\"RolandTR909_bd RolandTR909_sd\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":537,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Select the sound bank to use. To be used together with <code>s</code>. The bank name (+ &quot;_&quot;) will be prepended to the value of <code>s</code>.</p>","name":"bank","params":[{"type":{"names":["string","Pattern"]},"description":"<p>the name of the bank</p>","name":"bank"}],"examples":["s(\\"bd sd [~ bd] sd\\").bank('RolandTR909') // = s(\\"RolandTR909_bd RolandTR909_sd\\")"],"longname":"bank","kind":"member","scope":"global"},{"comment":"/**\\n * mix control for the chorus effect\\n *\\n * @name chorus\\n * @param {string | Pattern} chorus mix amount between 0 and 1\\n * @example\\n * note(\\"d d a# a\\").s(\\"sawtooth\\").chorus(.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":548,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>mix control for the chorus effect</p>","name":"chorus","params":[{"type":{"names":["string","Pattern"]},"description":"<p>mix amount between 0 and 1</p>","name":"chorus"}],"examples":["note(\\"d d a# a\\").s(\\"sawtooth\\").chorus(.5)"],"longname":"chorus","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope decay time: the time it takes after the attack time to reach the sustain level.\\n * Note that the decay is only audible if the sustain value is lower than 1.\\n *\\n * @name decay\\n * @param {number | Pattern} time decay time in seconds\\n * @synonyms dec\\n * @example\\n * note(\\"c3 e3 f3 g3\\").decay(\\"<.1 .2 .3 .4>\\").sustain(0)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":564,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope decay time: the time it takes after the attack time to reach the sustain level.\\nNote that the decay is only audible if the sustain value is lower than 1.</p>","name":"decay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"synonyms_text":"dec","synonyms":["dec"],"examples":["note(\\"c3 e3 f3 g3\\").decay(\\"<.1 .2 .3 .4>\\").sustain(0)"],"longname":"decay","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope sustain level: The level which is reached after attack / decay, being sustained until the offset.\\n *\\n * @name sustain\\n * @param {number | Pattern} gain sustain level between 0 and 1\\n * @synonyms sus\\n * @example\\n * note(\\"c3 e3 f3 g3\\").decay(.2).sustain(\\"<0 .1 .4 .6 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":576,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope sustain level: The level which is reached after attack / decay, being sustained until the offset.</p>","name":"sustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level between 0 and 1</p>","name":"gain"}],"synonyms_text":"sus","synonyms":["sus"],"examples":["note(\\"c3 e3 f3 g3\\").decay(.2).sustain(\\"<0 .1 .4 .6 1>\\")"],"longname":"sustain","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope release time: The time it takes after the offset to go from sustain level to zero.\\n *\\n * @name release\\n * @param {number | Pattern} time release time in seconds\\n * @synonyms rel\\n * @example\\n * note(\\"c3 e3 g3 c4\\").release(\\"<0 .1 .4 .6 1>/2\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":587,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope release time: The time it takes after the offset to go from sustain level to zero.</p>","name":"release","params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"synonyms_text":"rel","synonyms":["rel"],"examples":["note(\\"c3 e3 g3 c4\\").release(\\"<0 .1 .4 .6 1>/2\\")"],"longname":"release","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the center frequency of the **b**and-**p**ass **f**ilter. When using mininotation, you\\n * can also optionally supply the 'bpq' parameter separated by ':'.\\n *\\n * @name bpf\\n * @param {number | Pattern} frequency center frequency\\n * @synonyms bandf, bp\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").bpf(\\"<1000 2000 4000 8000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":600,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the center frequency of the <strong>b</strong>and-<strong>p</strong>ass <strong>f</strong>ilter. When using mininotation, you\\ncan also optionally supply the 'bpq' parameter separated by ':'.</p>","name":"bpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>center frequency</p>","name":"frequency"}],"synonyms_text":"bandf, bp","synonyms":["bandf","bp"],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").bpf(\\"<1000 2000 4000 8000>\\")"],"longname":"bpf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the **b**and-**p**ass **q**-factor (resonance).\\n *\\n * @name bpq\\n * @param {number | Pattern} q q factor\\n * @synonyms bandq\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").bpf(500).bpq(\\"<0 1 2 3>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":613,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the <strong>b</strong>and-<strong>p</strong>ass <strong>q</strong>-factor (resonance).</p>","name":"bpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>q factor</p>","name":"q"}],"synonyms_text":"bandq","synonyms":["bandq"],"examples":["s(\\"bd sd [~ bd] sd\\").bpf(500).bpq(\\"<0 1 2 3>\\")"],"longname":"bpq","kind":"member","scope":"global"},{"comment":"/**\\n * A pattern of numbers from 0 to 1. Skips the beginning of each sample, e.g. \`0.25\` to cut off the first quarter from each sample.\\n *\\n * @memberof Pattern\\n * @name begin\\n * @param {number | Pattern} amount between 0 and 1, where 1 is the length of the sample\\n * @example\\n * samples({ rave: 'rave/AREUREADY.wav' }, 'github:tidalcycles/dirt-samples')\\n * s(\\"rave\\").begin(\\"<0 .25 .5 .75>\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":626,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A pattern of numbers from 0 to 1. Skips the beginning of each sample, e.g. <code>0.25</code> to cut off the first quarter from each sample.</p>","memberof":"Pattern","name":"begin","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"amount"}],"examples":["samples({ rave: 'rave/AREUREADY.wav' }, 'github:tidalcycles/dirt-samples')\\ns(\\"rave\\").begin(\\"<0 .25 .5 .75>\\").fast(2)"],"scope":"static","longname":"Pattern.begin","kind":"member"},{"comment":"/**\\n * The same as .begin, but cuts off the end off each sample.\\n *\\n * @memberof Pattern\\n * @name end\\n * @param {number | Pattern} length 1 = whole sample, .5 = half sample, .25 = quarter sample etc..\\n * @example\\n * s(\\"bd*2,oh*4\\").end(\\"<.1 .2 .5 1>\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The same as .begin, but cuts off the end off each sample.</p>","memberof":"Pattern","name":"end","params":[{"type":{"names":["number","Pattern"]},"description":"<p>1 = whole sample, .5 = half sample, .25 = quarter sample etc..</p>","name":"length"}],"examples":["s(\\"bd*2,oh*4\\").end(\\"<.1 .2 .5 1>\\").fast(2)"],"scope":"static","longname":"Pattern.end","kind":"member"},{"comment":"/**\\n * Loops the sample.\\n * Note that the tempo of the loop is not synced with the cycle tempo.\\n * To change the loop region, use loopBegin / loopEnd.\\n *\\n * @name loop\\n * @param {number | Pattern} on If 1, the sample is looped\\n * @example\\n * s(\\"casio\\").loop(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":649,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Loops the sample.\\nNote that the tempo of the loop is not synced with the cycle tempo.\\nTo change the loop region, use loopBegin / loopEnd.</p>","name":"loop","params":[{"type":{"names":["number","Pattern"]},"description":"<p>If 1, the sample is looped</p>","name":"on"}],"examples":["s(\\"casio\\").loop(1)"],"longname":"loop","kind":"member","scope":"global"},{"comment":"/**\\n * Begin to loop at a specific point in the sample (inbetween \`begin\` and \`end\`).\\n * Note that the loop point must be inbetween \`begin\` and \`end\`, and before \`loopEnd\`!\\n * Note: Samples starting with wt_ will automatically loop! (wt = wavetable)\\n *\\n * @name loopBegin\\n * @param {number | Pattern} time between 0 and 1, where 1 is the length of the sample\\n * @synonyms loopb\\n * @example\\n * s(\\"space\\").loop(1)\\n * .loopBegin(\\"<0 .125 .25>\\")._scope()\\n */","meta":{"filename":"controls.mjs","lineno":661,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Begin to loop at a specific point in the sample (inbetween <code>begin</code> and <code>end</code>).\\nNote that the loop point must be inbetween <code>begin</code> and <code>end</code>, and before <code>loopEnd</code>!\\nNote: Samples starting with wt_ will automatically loop! (wt = wavetable)</p>","name":"loopBegin","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"time"}],"synonyms_text":"loopb","synonyms":["loopb"],"examples":["s(\\"space\\").loop(1)\\n.loopBegin(\\"<0 .125 .25>\\")._scope()"],"longname":"loopBegin","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * End the looping section at a specific point in the sample (inbetween \`begin\` and \`end\`).\\n * Note that the loop point must be inbetween \`begin\` and \`end\`, and after \`loopBegin\`!\\n *\\n * @name loopEnd\\n * @param {number | Pattern} time between 0 and 1, where 1 is the length of the sample\\n * @synonyms loope\\n * @example\\n * s(\\"space\\").loop(1)\\n * .loopEnd(\\"<1 .75 .5 .25>\\")._scope()\\n */","meta":{"filename":"controls.mjs","lineno":674,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>End the looping section at a specific point in the sample (inbetween <code>begin</code> and <code>end</code>).\\nNote that the loop point must be inbetween <code>begin</code> and <code>end</code>, and after <code>loopBegin</code>!</p>","name":"loopEnd","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"time"}],"synonyms_text":"loope","synonyms":["loope"],"examples":["s(\\"space\\").loop(1)\\n.loopEnd(\\"<1 .75 .5 .25>\\")._scope()"],"longname":"loopEnd","kind":"member","scope":"global"},{"comment":"/**\\n * Bit crusher effect.\\n *\\n * @name crush\\n * @param {number | Pattern} depth between 1 (for drastic reduction in bit-depth) to 16 (for barely no reduction).\\n * @example\\n * s(\\"<bd sd>,hh*3\\").fast(2).crush(\\"<16 8 7 6 5 4 3 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":687,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Bit crusher effect.</p>","name":"crush","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 1 (for drastic reduction in bit-depth) to 16 (for barely no reduction).</p>","name":"depth"}],"examples":["s(\\"<bd sd>,hh*3\\").fast(2).crush(\\"<16 8 7 6 5 4 3 2>\\")"],"longname":"crush","kind":"member","scope":"global"},{"comment":"/**\\n * Fake-resampling for lowering the sample rate. Caution: This effect seems to only work in chromium based browsers\\n *\\n * @name coarse\\n * @param {number | Pattern} factor 1 for original 2 for half, 3 for a third and so on.\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").coarse(\\"<1 4 8 16 32>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":698,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Fake-resampling for lowering the sample rate. Caution: This effect seems to only work in chromium based browsers</p>","name":"coarse","params":[{"type":{"names":["number","Pattern"]},"description":"<p>1 for original 2 for half, 3 for a third and so on.</p>","name":"factor"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").coarse(\\"<1 4 8 16 32>\\")"],"longname":"coarse","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of a sound with a continuous waveform\\n *\\n * @name tremolo\\n * @synonyms trem\\n * @param {number | Pattern} speed modulation speed in HZ\\n * @example\\n * note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolo(\\"<3 2 100> \\").tremoloskew(\\"<.5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":709,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of a sound with a continuous waveform</p>","name":"tremolo","synonyms_text":"trem","synonyms":["trem"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation speed in HZ</p>","name":"speed"}],"examples":["note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolo(\\"<3 2 100> \\").tremoloskew(\\"<.5>\\")"],"longname":"tremolo","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of a sound with a continuous waveform\\n *\\n * @name tremolosync\\n * @synonyms tremsync\\n * @param {number | Pattern} cycles modulation speed in cycles\\n * @example\\n * note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolosync(\\"4\\").tremoloskew(\\"<1 .5 0>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":721,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of a sound with a continuous waveform</p>","name":"tremolosync","synonyms_text":"tremsync","synonyms":["tremsync"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation speed in cycles</p>","name":"cycles"}],"examples":["note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolosync(\\"4\\").tremoloskew(\\"<1 .5 0>\\")"],"longname":"tremolosync","kind":"member","scope":"global"},{"comment":"/**\\n * Depth of amplitude modulation\\n *\\n * @name tremolodepth\\n * @synonyms tremdepth\\n * @param {number | Pattern} depth\\n * @example\\n * note(\\"a1 a1 a#1 a1\\".fast(4)).s(\\"pulse\\").tremsync(4).tremolodepth(\\"<1 2 .7>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":736,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Depth of amplitude modulation</p>","name":"tremolodepth","synonyms_text":"tremdepth","synonyms":["tremdepth"],"params":[{"type":{"names":["number","Pattern"]},"name":"depth"}],"examples":["note(\\"a1 a1 a#1 a1\\".fast(4)).s(\\"pulse\\").tremsync(4).tremolodepth(\\"<1 2 .7>\\")"],"longname":"tremolodepth","kind":"member","scope":"global"},{"comment":"/**\\n * Alter the shape of the modulation waveform\\n *\\n * @name tremoloskew\\n * @synonyms tremskew\\n * @param {number | Pattern} amount between 0 & 1, the shape of the waveform\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremoloskew(\\"<.5 0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":747,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Alter the shape of the modulation waveform</p>","name":"tremoloskew","synonyms_text":"tremskew","synonyms":["tremskew"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 &amp; 1, the shape of the waveform</p>","name":"amount"}],"examples":["note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremoloskew(\\"<.5 0 1>\\")"],"longname":"tremoloskew","kind":"member","scope":"global"},{"comment":"/**\\n * Alter the phase of the modulation waveform\\n *\\n * @name tremolophase\\n * @synonyms tremphase\\n * @param {number | Pattern} offset the offset in cycles of the modulation\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremolophase(\\"<0 .25 .66>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":759,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Alter the phase of the modulation waveform</p>","name":"tremolophase","synonyms_text":"tremphase","synonyms":["tremphase"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>the offset in cycles of the modulation</p>","name":"offset"}],"examples":["note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremolophase(\\"<0 .25 .66>\\")"],"longname":"tremolophase","kind":"member","scope":"global"},{"comment":"/**\\n * Shape of amplitude modulation\\n *\\n * @name tremoloshape\\n * @synonyms tremshape\\n * @param {number | Pattern} shape tri | square | sine | saw | ramp\\n * @example\\n * note(\\"{f g c d}%16\\").tremsync(4).tremoloshape(\\"<sine tri square>\\").s(\\"sawtooth\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":771,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shape of amplitude modulation</p>","name":"tremoloshape","synonyms_text":"tremshape","synonyms":["tremshape"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>tri | square | sine | saw | ramp</p>","name":"shape"}],"examples":["note(\\"{f g c d}%16\\").tremsync(4).tremoloshape(\\"<sine tri square>\\").s(\\"sawtooth\\")"],"longname":"tremoloshape","kind":"member","scope":"global"},{"comment":"/**\\n * Filter overdrive for supported filter types\\n *\\n * @name drive\\n * @param {number | Pattern} amount\\n * @example\\n * note(\\"{f g g c d a a#}%16\\".sub(17)).s(\\"supersaw\\").lpenv(8).lpf(150).lpq(.8).ftype('ladder').drive(\\"<.5 4>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":782,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filter overdrive for supported filter types</p>","name":"drive","params":[{"type":{"names":["number","Pattern"]},"name":"amount"}],"examples":["note(\\"{f g g c d a a#}%16\\".sub(17)).s(\\"supersaw\\").lpenv(8).lpf(150).lpq(.8).ftype('ladder').drive(\\"<.5 4>\\")"],"longname":"drive","kind":"member","scope":"global"},{"comment":"/**\\n * Modulate the amplitude of an orbit to create a \\"sidechain\\" like effect.\\n *\\n * Can be applied to multiple orbits with the ':' mininotation, e.g. \`duckorbit(\\"2:3\\")\`\\n *\\n * @name duckorbit\\n * @synonyms duck\\n * @param {number | Pattern} orbit target orbit\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(1)\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"hh*16\\").orbit(3)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":793,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Modulate the amplitude of an orbit to create a &quot;sidechain&quot; like effect.</p>\\n<p>Can be applied to multiple orbits with the ':' mininotation, e.g. <code>duckorbit(&quot;2:3&quot;)</code></p>","name":"duckorbit","synonyms_text":"duck","synonyms":["duck"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>target orbit</p>","name":"orbit"}],"examples":["$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(1)","$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"hh*16\\").orbit(3)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(1)"],"longname":"duckorbit","kind":"member","scope":"global"},{"comment":"/**\\n * The amount of ducking applied to target orbit\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckdepth(\\"0.3:0.1\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckdepth\\n * @param {number | Pattern} depth depth of modulation from 0 to 1\\n * @example\\n * stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(\\"<1 .9 .6 0>\\"))\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"hh*16\\").orbit(3)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(\\"1:0.5\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":812,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The amount of ducking applied to target orbit</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckdepth(&quot;0.3:0.1&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation from 0 to 1</p>","name":"depth"}],"examples":["stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(\\"<1 .9 .6 0>\\"))","$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"hh*16\\").orbit(3)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:3\\").duckattack(0.2).duckdepth(\\"1:0.5\\")"],"longname":"duckdepth","kind":"member","scope":"global"},{"comment":"/**\\n * The time required for the ducked signal(s) to reach their lowest volume.\\n * Can be used to prevent clicking or for creative rhythmic effects.\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckonset(\\"0:0.003\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckonset\\n * @synonyms duckons\\n *\\n * @param {number | Pattern} time The onset time in seconds\\n * @example\\n * // Clicks\\n * sound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\n * duckerWithClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0).postgain(0)\\n * @example\\n * // No clicks\\n * sound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\n * duckerWithoutClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0.01).postgain(0)\\n * @example\\n * // Rhythmic\\n * noise: s(\\"pink\\").distort(\\"2:1\\").orbit(4) // used rhythmically with 0.3 onset below\\n * hhat: s(\\"hh*16\\").orbit(7)\\n * ducker: s(\\"bd*4\\").bank(\\"tr909\\").duckorbit(\\"4:7\\").duckonset(\\"0.3:0.003\\").duckattack(0.25)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":830,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The time required for the ducked signal(s) to reach their lowest volume.\\nCan be used to prevent clicking or for creative rhythmic effects.</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckonset(&quot;0:0.003&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckonset","synonyms_text":"duckons","synonyms":["duckons"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>The onset time in seconds</p>","name":"time"}],"examples":["// Clicks\\nsound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\nduckerWithClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0).postgain(0)","// No clicks\\nsound: freq(\\"63.2388\\").s(\\"sine\\").orbit(2).gain(4)\\nduckerWithoutClick: s(\\"bd*4\\").duckorbit(2).duckattack(0.3).duckonset(0.01).postgain(0)","// Rhythmic\\nnoise: s(\\"pink\\").distort(\\"2:1\\").orbit(4) // used rhythmically with 0.3 onset below\\nhhat: s(\\"hh*16\\").orbit(7)\\nducker: s(\\"bd*4\\").bank(\\"tr909\\").duckorbit(\\"4:7\\").duckonset(\\"0.3:0.003\\").duckattack(0.25)"],"longname":"duckonset","kind":"member","scope":"global"},{"comment":"/**\\n * The time required for the ducked signal(s) to return to their normal volume.\\n *\\n * Can vary across orbits with the ':' mininotation, e.g. \`duckonset(\\"0:0.003\\")\`.\\n * Note: this requires first applying the effect to multiple orbits with e.g. \`duckorbit(\\"2:3\\")\`.\\n *\\n * @name duckattack\\n * @synonyms duckatt\\n *\\n * @param {number | Pattern} time The attack time in seconds\\n * @example\\n * sound: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * ducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(\\"<0.2 0 0.4>\\").duckdepth(1)\\n * @example\\n * moreduck: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * lessduck: s(\\"hh*16\\").orbit(5)\\n * ducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:5\\").duckattack(\\"0.4:0.1\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":858,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The time required for the ducked signal(s) to return to their normal volume.</p>\\n<p>Can vary across orbits with the ':' mininotation, e.g. <code>duckonset(&quot;0:0.003&quot;)</code>.\\nNote: this requires first applying the effect to multiple orbits with e.g. <code>duckorbit(&quot;2:3&quot;)</code>.</p>","name":"duckattack","synonyms_text":"duckatt","synonyms":["duckatt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>The attack time in seconds</p>","name":"time"}],"examples":["sound: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\nducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(\\"<0.2 0 0.4>\\").duckdepth(1)","moreduck: n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\nlessduck: s(\\"hh*16\\").orbit(5)\\nducker: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(\\"2:5\\").duckattack(\\"0.4:0.1\\")"],"longname":"duckattack","kind":"member","scope":"global"},{"comment":"/**\\n * Create byte beats with custom expressions\\n *\\n * @name byteBeatExpression\\n * @synonyms bbexpr\\n *\\n * @param {number | Pattern} byteBeatExpression bitwise expression for creating bytebeat\\n * @example\\n * s(\\"bytebeat\\").bbexpr('t*(t>>15^t>>66)')\\n *\\n */","meta":{"filename":"controls.mjs","lineno":879,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Create byte beats with custom expressions</p>","name":"byteBeatExpression","synonyms_text":"bbexpr","synonyms":["bbexpr"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>bitwise expression for creating bytebeat</p>","name":"byteBeatExpression"}],"examples":["s(\\"bytebeat\\").bbexpr('t*(t>>15^t>>66)')"],"longname":"byteBeatExpression","kind":"member","scope":"global"},{"comment":"/**\\n * Create byte beats with custom expressions\\n *\\n * @name byteBeatStartTime\\n * @synonyms bbst\\n *\\n * @param {number | Pattern} byteBeatStartTime in samples (t)\\n * @example\\n * note(\\"c3!8\\".add(\\"{0 0 12 0 7 5 3}%8\\")).s(\\"bytebeat:5\\").bbst(\\"<3 1>\\".mul(10000))._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":892,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Create byte beats with custom expressions</p>","name":"byteBeatStartTime","synonyms_text":"bbst","synonyms":["bbst"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>in samples (t)</p>","name":"byteBeatStartTime"}],"examples":["note(\\"c3!8\\".add(\\"{0 0 12 0 7 5 3}%8\\")).s(\\"bytebeat:5\\").bbst(\\"<3 1>\\".mul(10000))._scope()"],"longname":"byteBeatStartTime","kind":"member","scope":"global"},{"comment":"/**\\n * Allows you to set the output channels on the interface\\n *\\n * @name channels\\n * @synonyms ch\\n *\\n * @param {number | Pattern} channels pattern the output channels\\n * @example\\n * note(\\"e a d b g\\").channels(\\"3:4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":905,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows you to set the output channels on the interface</p>","name":"channels","synonyms_text":"ch","synonyms":["ch"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>pattern the output channels</p>","name":"channels"}],"examples":["note(\\"e a d b g\\").channels(\\"3:4\\")"],"longname":"channels","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the pulsewidth of the pulse oscillator\\n *\\n * @name pw\\n * @param {number | Pattern} pulsewidth\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"pulse\\").pw(\\".8:1:.2\\")\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0 .75 .5 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":918,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the pulsewidth of the pulse oscillator</p>","name":"pw","params":[{"type":{"names":["number","Pattern"]},"name":"pulsewidth"}],"examples":["note(\\"{f a c e}%16\\").s(\\"pulse\\").pw(\\".8:1:.2\\")","n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0 .75 .5 1\\")"],"longname":"pw","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the lfo rate for the pulsewidth of the pulse oscillator\\n *\\n * @name pwrate\\n * @param {number | Pattern} rate\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")\\n\\n *\\n */","meta":{"filename":"controls.mjs","lineno":930,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the lfo rate for the pulsewidth of the pulse oscillator</p>","name":"pwrate","params":[{"type":{"names":["number","Pattern"]},"name":"rate"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")"],"longname":"pwrate","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the lfo sweep for the pulsewidth of the pulse oscillator\\n *\\n * @name pwsweep\\n * @param {number | Pattern} sweep\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":942,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the lfo sweep for the pulsewidth of the pulse oscillator</p>","name":"pwsweep","params":[{"type":{"names":["number","Pattern"]},"name":"sweep"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")"],"longname":"pwsweep","kind":"member","scope":"global"},{"comment":"/**\\n * Phaser audio effect that approximates popular guitar pedals.\\n *\\n * @name phaser\\n * @synonyms ph\\n * @param {number | Pattern} speed speed of modulation\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(\\"<1 2 4 8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":953,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Phaser audio effect that approximates popular guitar pedals.</p>","name":"phaser","synonyms_text":"ph","synonyms":["ph"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>speed of modulation</p>","name":"speed"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(\\"<1 2 4 8>\\")"],"longname":"phaser","kind":"member","scope":"global"},{"comment":"/**\\n * The frequency sweep range of the lfo for the phaser effect. Defaults to 2000\\n *\\n * @name phasersweep\\n * @synonyms phs\\n * @param {number | Pattern} phasersweep most useful values are between 0 and 4000\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phasersweep(\\"<800 2000 4000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":970,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The frequency sweep range of the lfo for the phaser effect. Defaults to 2000</p>","name":"phasersweep","synonyms_text":"phs","synonyms":["phs"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>most useful values are between 0 and 4000</p>","name":"phasersweep"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phasersweep(\\"<800 2000 4000>\\")"],"longname":"phasersweep","kind":"member","scope":"global"},{"comment":"/**\\n * The center frequency of the phaser in HZ. Defaults to 1000\\n *\\n * @name phasercenter\\n * @synonyms phc\\n * @param {number | Pattern} centerfrequency in HZ\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phasercenter(\\"<800 2000 4000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":983,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The center frequency of the phaser in HZ. Defaults to 1000</p>","name":"phasercenter","synonyms_text":"phc","synonyms":["phc"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>in HZ</p>","name":"centerfrequency"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phasercenter(\\"<800 2000 4000>\\")"],"longname":"phasercenter","kind":"member","scope":"global"},{"comment":"/**\\n * The amount the signal is affected by the phaser effect. Defaults to 0.75\\n *\\n * @name phaserdepth\\n * @synonyms phd, phasdp\\n * @param {number | Pattern} depth number between 0 and 1\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phaserdepth(\\"<0 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":997,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The amount the signal is affected by the phaser effect. Defaults to 0.75</p>","name":"phaserdepth","synonyms_text":"phd, phasdp","synonyms":["phd","phasdp"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>number between 0 and 1</p>","name":"depth"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phaserdepth(\\"<0 .5 .75 1>\\")"],"longname":"phaserdepth","kind":"member","scope":"global"},{"comment":"/**\\n * Choose the channel the pattern is sent to in superdirt\\n *\\n * @name channel\\n * @param {number | Pattern} channel channel number\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1011,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Choose the channel the pattern is sent to in superdirt</p>","name":"channel","params":[{"type":{"names":["number","Pattern"]},"description":"<p>channel number</p>","name":"channel"}],"longname":"channel","kind":"member","scope":"global"},{"comment":"/**\\n * In the style of classic drum-machines, \`cut\` will stop a playing sample as soon as another samples with in same cutgroup is to be played. An example would be an open hi-hat followed by a closed one, essentially muting the open.\\n *\\n * @name cut\\n * @param {number | Pattern} group cut group number\\n * @example\\n * s(\\"[oh hh]*4\\").cut(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1019,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>In the style of classic drum-machines, <code>cut</code> will stop a playing sample as soon as another samples with in same cutgroup is to be played. An example would be an open hi-hat followed by a closed one, essentially muting the open.</p>","name":"cut","params":[{"type":{"names":["number","Pattern"]},"description":"<p>cut group number</p>","name":"group"}],"examples":["s(\\"[oh hh]*4\\").cut(1)"],"longname":"cut","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the cutoff frequency of the **l**ow-**p**ass **f**ilter.\\n *\\n * When using mininotation, you can also optionally add the 'lpq' parameter, separated by ':'.\\n *\\n * @name lpf\\n * @param {number | Pattern} frequency audible between 0 and 20000\\n * @synonyms cutoff, ctf, lp\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").lpf(\\"<4000 2000 1000 500 200 100>\\")\\n * @example\\n * s(\\"bd*16\\").lpf(\\"1000:0 1000:10 1000:20 1000:30\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1029,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the cutoff frequency of the <strong>l</strong>ow-<strong>p</strong>ass <strong>f</strong>ilter.</p>\\n<p>When using mininotation, you can also optionally add the 'lpq' parameter, separated by ':'.</p>","name":"lpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>audible between 0 and 20000</p>","name":"frequency"}],"synonyms_text":"cutoff, ctf, lp","synonyms":["cutoff","ctf","lp"],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").lpf(\\"<4000 2000 1000 500 200 100>\\")","s(\\"bd*16\\").lpf(\\"1000:0 1000:10 1000:20 1000:30\\")"],"longname":"lpf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the lowpass filter envelope modulation depth.\\n * @name lpenv\\n * @param {number | Pattern} modulation depth of the lowpass filter envelope between 0 and _n_\\n * @synonyms lpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpa(.5)\\n * .lpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1045,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the lowpass filter envelope modulation depth.</p>","name":"lpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the lowpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"lpe","synonyms":["lpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpa(.5)\\n.lpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"lpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the highpass filter envelope modulation depth.\\n * @name hpenv\\n * @param {number | Pattern} modulation depth of the highpass filter envelope between 0 and _n_\\n * @synonyms hpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpa(.5)\\n * .hpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1058,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the highpass filter envelope modulation depth.</p>","name":"hpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the highpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"hpe","synonyms":["hpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpa(.5)\\n.hpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"hpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the bandpass filter envelope modulation depth.\\n * @name bpenv\\n * @param {number | Pattern} modulation depth of the bandpass filter envelope between 0 and _n_\\n * @synonyms bpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpa(.5)\\n * .bpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":1071,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the bandpass filter envelope modulation depth.</p>","name":"bpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the bandpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"bpe","synonyms":["bpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpa(.5)\\n.bpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"bpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the lowpass filter envelope.\\n * @name lpattack\\n * @param {number | Pattern} attack time of the filter envelope\\n * @synonyms lpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpa(\\"<.5 .25 .1 .01>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1084,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the lowpass filter envelope.</p>","name":"lpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"attack"}],"synonyms_text":"lpa","synonyms":["lpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpa(\\"<.5 .25 .1 .01>/4\\")\\n.lpenv(4)"],"longname":"lpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the highpass filter envelope.\\n * @name hpattack\\n * @param {number | Pattern} attack time of the highpass filter envelope\\n * @synonyms hpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpa(\\"<.5 .25 .1 .01>/4\\")\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1097,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the highpass filter envelope.</p>","name":"hpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"attack"}],"synonyms_text":"hpa","synonyms":["hpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpa(\\"<.5 .25 .1 .01>/4\\")\\n.hpenv(4)"],"longname":"hpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the bandpass filter envelope.\\n * @name bpattack\\n * @param {number | Pattern} attack time of the bandpass filter envelope\\n * @synonyms bpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpa(\\"<.5 .25 .1 .01>/4\\")\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1110,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the bandpass filter envelope.</p>","name":"bpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"attack"}],"synonyms_text":"bpa","synonyms":["bpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpa(\\"<.5 .25 .1 .01>/4\\")\\n.bpenv(4)"],"longname":"bpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the lowpass filter envelope.\\n * @name lpdecay\\n * @param {number | Pattern} decay time of the filter envelope\\n * @synonyms lpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpd(\\"<.5 .25 .1 0>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1123,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the lowpass filter envelope.</p>","name":"lpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"decay"}],"synonyms_text":"lpd","synonyms":["lpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpd(\\"<.5 .25 .1 0>/4\\")\\n.lpenv(4)"],"longname":"lpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the highpass filter envelope.\\n * @name hpdecay\\n * @param {number | Pattern} decay time of the highpass filter envelope\\n * @synonyms hpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpd(\\"<.5 .25 .1 0>/4\\")\\n * .hps(0.2)\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1136,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the highpass filter envelope.</p>","name":"hpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"decay"}],"synonyms_text":"hpd","synonyms":["hpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpd(\\"<.5 .25 .1 0>/4\\")\\n.hps(0.2)\\n.hpenv(4)"],"longname":"hpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the bandpass filter envelope.\\n * @name bpdecay\\n * @param {number | Pattern} decay time of the bandpass filter envelope\\n * @synonyms bpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpd(\\"<.5 .25 .1 0>/4\\")\\n * .bps(0.2)\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1150,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the bandpass filter envelope.</p>","name":"bpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"decay"}],"synonyms_text":"bpd","synonyms":["bpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpd(\\"<.5 .25 .1 0>/4\\")\\n.bps(0.2)\\n.bpenv(4)"],"longname":"bpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the lowpass filter envelope.\\n * @name lpsustain\\n * @param {number | Pattern} sustain amplitude of the lowpass filter envelope\\n * @synonyms lps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpd(.5)\\n * .lps(\\"<0 .25 .5 1>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1164,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the lowpass filter envelope.</p>","name":"lpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the lowpass filter envelope</p>","name":"sustain"}],"synonyms_text":"lps","synonyms":["lps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpd(.5)\\n.lps(\\"<0 .25 .5 1>/4\\")\\n.lpenv(4)"],"longname":"lpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the highpass filter envelope.\\n * @name hpsustain\\n * @param {number | Pattern} sustain amplitude of the highpass filter envelope\\n * @synonyms hps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpd(.5)\\n * .hps(\\"<0 .25 .5 1>/4\\")\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1178,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the highpass filter envelope.</p>","name":"hpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the highpass filter envelope</p>","name":"sustain"}],"synonyms_text":"hps","synonyms":["hps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpd(.5)\\n.hps(\\"<0 .25 .5 1>/4\\")\\n.hpenv(4)"],"longname":"hpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the bandpass filter envelope.\\n * @name bpsustain\\n * @param {number | Pattern} sustain amplitude of the bandpass filter envelope\\n * @synonyms bps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpd(.5)\\n * .bps(\\"<0 .25 .5 1>/4\\")\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":1192,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the bandpass filter envelope.</p>","name":"bpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the bandpass filter envelope</p>","name":"sustain"}],"synonyms_text":"bps","synonyms":["bps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpd(.5)\\n.bps(\\"<0 .25 .5 1>/4\\")\\n.bpenv(4)"],"longname":"bpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the lowpass filter envelope.\\n * @name lprelease\\n * @param {number | Pattern} release time of the filter envelope\\n * @synonyms lpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .lpf(300)\\n * .lpenv(4)\\n * .lpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1206,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the lowpass filter envelope.</p>","name":"lprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"release"}],"synonyms_text":"lpr","synonyms":["lpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.lpf(300)\\n.lpenv(4)\\n.lpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"lprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the highpass filter envelope.\\n * @name hprelease\\n * @param {number | Pattern} release time of the highpass filter envelope\\n * @synonyms hpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .hpf(500)\\n * .hpenv(4)\\n * .hpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1221,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the highpass filter envelope.</p>","name":"hprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"release"}],"synonyms_text":"hpr","synonyms":["hpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.hpf(500)\\n.hpenv(4)\\n.hpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"hprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the bandpass filter envelope.\\n * @name bprelease\\n * @param {number | Pattern} release time of the bandpass filter envelope\\n * @synonyms bpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .bpf(500)\\n * .bpenv(4)\\n * .bpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":1236,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the bandpass filter envelope.</p>","name":"bprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"release"}],"synonyms_text":"bpr","synonyms":["bpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.bpf(500)\\n.bpenv(4)\\n.bpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"bprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the filter type. The ladder filter is more aggressive. More types might be added in the future.\\n * @name ftype\\n * @param {number | Pattern} type 12db (0), ladder (1), or 24db (2)\\n * @example\\n * note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpenv(4).lpf(500).ftype(\\"<0 1 2>\\").lpq(1)\\n * @example\\n * note(\\"c f g g a c d4\\").fast(2)\\n * .sound('sawtooth')\\n * .lpf(200).fanchor(0)\\n * .lpenv(3).lpq(1)\\n * .ftype(\\"<ladder 12db 24db>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1251,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the filter type. The ladder filter is more aggressive. More types might be added in the future.</p>","name":"ftype","params":[{"type":{"names":["number","Pattern"]},"description":"<p>12db (0), ladder (1), or 24db (2)</p>","name":"type"}],"examples":["note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpenv(4).lpf(500).ftype(\\"<0 1 2>\\").lpq(1)","note(\\"c f g g a c d4\\").fast(2)\\n.sound('sawtooth')\\n.lpf(200).fanchor(0)\\n.lpenv(3).lpq(1)\\n.ftype(\\"<ladder 12db 24db>\\")"],"longname":"ftype","kind":"member","scope":"global"},{"comment":"/**\\n * controls the center of the filter envelope. 0 is unipolar positive, .5 is bipolar, 1 is unipolar negative\\n * @name fanchor\\n * @param {number | Pattern} center 0 to 1\\n * @example\\n * note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpf(\\"{1000}%2\\")\\n * .lpenv(8).fanchor(\\"<0 .5 1>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1266,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>controls the center of the filter envelope. 0 is unipolar positive, .5 is bipolar, 1 is unipolar negative</p>","name":"fanchor","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 to 1</p>","name":"center"}],"examples":["note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpf(\\"{1000}%2\\")\\n.lpenv(8).fanchor(\\"<0 .5 1>\\")"],"longname":"fanchor","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the cutoff frequency of the **h**igh-**p**ass **f**ilter.\\n *\\n * When using mininotation, you can also optionally add the 'hpq' parameter, separated by ':'.\\n *\\n * @name hpf\\n * @param {number | Pattern} frequency audible between 0 and 20000\\n * @synonyms hp, hcutoff\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<4000 2000 1000 500 200 100>\\")\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<2000 2000:25>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1275,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the cutoff frequency of the <strong>h</strong>igh-<strong>p</strong>ass <strong>f</strong>ilter.</p>\\n<p>When using mininotation, you can also optionally add the 'hpq' parameter, separated by ':'.</p>","name":"hpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>audible between 0 and 20000</p>","name":"frequency"}],"synonyms_text":"hp, hcutoff","synonyms":["hp","hcutoff"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<4000 2000 1000 500 200 100>\\")","s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<2000 2000:25>\\")"],"longname":"hpf","kind":"member","scope":"global"},{"comment":"/**\\n * Applies a vibrato to the frequency of the oscillator.\\n *\\n * @name vib\\n * @synonyms vibrato, v\\n * @param {number | Pattern} frequency of the vibrato in hertz\\n * @example\\n * note(\\"a e\\")\\n * .vib(\\"<.5 1 2 4 8 16>\\")\\n * ._scope()\\n * @example\\n * // change the modulation depth with \\":\\"\\n * note(\\"a e\\")\\n * .vib(\\"<.5 1 2 4 8 16>:12\\")\\n * ._scope()\\n */","meta":{"filename":"controls.mjs","lineno":1291,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies a vibrato to the frequency of the oscillator.</p>","name":"vib","synonyms_text":"vibrato, v","synonyms":["vibrato","v"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>of the vibrato in hertz</p>","name":"frequency"}],"examples":["note(\\"a e\\")\\n.vib(\\"<.5 1 2 4 8 16>\\")\\n._scope()","// change the modulation depth with \\":\\"\\nnote(\\"a e\\")\\n.vib(\\"<.5 1 2 4 8 16>:12\\")\\n._scope()"],"longname":"vib","kind":"member","scope":"global"},{"comment":"/**\\n * Adds pink noise to the mix\\n *\\n * @name noise\\n * @param {number | Pattern} wet wet amount\\n * @example\\n * sound(\\"<white pink brown>/2\\")\\n */","meta":{"filename":"controls.mjs","lineno":1308,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Adds pink noise to the mix</p>","name":"noise","params":[{"type":{"names":["number","Pattern"]},"description":"<p>wet amount</p>","name":"wet"}],"examples":["sound(\\"<white pink brown>/2\\")"],"longname":"noise","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the vibrato depth in semitones. Only has an effect if \`vibrato\` | \`vib\` | \`v\` is is also set\\n *\\n * @name vibmod\\n * @synonyms vmod\\n * @param {number | Pattern} depth of vibrato (in semitones)\\n * @example\\n * note(\\"a e\\").vib(4)\\n * .vibmod(\\"<.25 .5 1 2 12>\\")\\n * ._scope()\\n * @example\\n * // change the vibrato frequency with \\":\\"\\n * note(\\"a e\\")\\n * .vibmod(\\"<.25 .5 1 2 12>:8\\")\\n * ._scope()\\n */","meta":{"filename":"controls.mjs","lineno":1317,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the vibrato depth in semitones. Only has an effect if <code>vibrato</code> | <code>vib</code> | <code>v</code> is is also set</p>","name":"vibmod","synonyms_text":"vmod","synonyms":["vmod"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>of vibrato (in semitones)</p>","name":"depth"}],"examples":["note(\\"a e\\").vib(4)\\n.vibmod(\\"<.25 .5 1 2 12>\\")\\n._scope()","// change the vibrato frequency with \\":\\"\\nnote(\\"a e\\")\\n.vibmod(\\"<.25 .5 1 2 12>:8\\")\\n._scope()"],"longname":"vibmod","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the **h**igh-**p**ass **q**-value.\\n *\\n * @name hpq\\n * @param {number | Pattern} q resonance factor between 0 and 50\\n * @synonyms hresonance\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(2000).hpq(\\"<0 10 20 30>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1335,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the <strong>h</strong>igh-<strong>p</strong>ass <strong>q</strong>-value.</p>","name":"hpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>resonance factor between 0 and 50</p>","name":"q"}],"synonyms_text":"hresonance","synonyms":["hresonance"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").hpf(2000).hpq(\\"<0 10 20 30>\\")"],"longname":"hpq","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the **l**ow-**p**ass **q**-value.\\n *\\n * @name lpq\\n * @param {number | Pattern} q resonance factor between 0 and 50\\n * @synonyms resonance\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").lpf(2000).lpq(\\"<0 10 20 30>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1346,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Controls the <strong>l</strong>ow-<strong>p</strong>ass <strong>q</strong>-value.</p>","name":"lpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>resonance factor between 0 and 50</p>","name":"q"}],"synonyms_text":"resonance","synonyms":["resonance"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").lpf(2000).lpq(\\"<0 10 20 30>\\")"],"longname":"lpq","kind":"member","scope":"global"},{"comment":"/**\\n * DJ filter, below 0.5 is low pass filter, above is high pass filter.\\n *\\n * @name djf\\n * @param {number | Pattern} cutoff below 0.5 is low pass filter, above is high pass filter\\n * @example\\n * n(irand(16).seg(8)).scale(\\"d:phrygian\\").s(\\"supersaw\\").djf(\\"<.5 .3 .2 .75>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1358,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>DJ filter, below 0.5 is low pass filter, above is high pass filter.</p>","name":"djf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>below 0.5 is low pass filter, above is high pass filter</p>","name":"cutoff"}],"examples":["n(irand(16).seg(8)).scale(\\"d:phrygian\\").s(\\"supersaw\\").djf(\\"<.5 .3 .2 .75>\\")"],"longname":"djf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the delay signal.\\n *\\n * When using mininotation, you can also optionally add the 'delaytime' and 'delayfeedback' parameter,\\n * separated by ':'.\\n *\\n *\\n * @name delay\\n * @param {number | Pattern} level between 0 and 1\\n * @example\\n * s(\\"bd bd\\").delay(\\"<0 .25 .5 1>\\")\\n * @example\\n * s(\\"bd bd\\").delay(\\"0.65:0.25:0.9 0.65:0.125:0.7\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1370,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the delay signal.</p>\\n<p>When using mininotation, you can also optionally add the 'delaytime' and 'delayfeedback' parameter,\\nseparated by ':'.</p>","name":"delay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"level"}],"examples":["s(\\"bd bd\\").delay(\\"<0 .25 .5 1>\\")","s(\\"bd bd\\").delay(\\"0.65:0.25:0.9 0.65:0.125:0.7\\")"],"longname":"delay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the signal that is fed back into the delay.\\n * Caution: Values >= 1 will result in a signal that gets louder and louder! Don't do it\\n *\\n * @name delayfeedback\\n * @param {number | Pattern} feedback between 0 and 1\\n * @synonyms delayfb, dfb\\n * @example\\n * s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the signal that is fed back into the delay.\\nCaution: Values &gt;= 1 will result in a signal that gets louder and louder! Don't do it</p>","name":"delayfeedback","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"feedback"}],"synonyms_text":"delayfb, dfb","synonyms":["delayfb","dfb"],"examples":["s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")"],"longname":"delayfeedback","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the signal that is fed back into the delay.\\n * Caution: Values >= 1 will result in a signal that gets louder and louder! Don't do it\\n *\\n * @name delayfeedback\\n * @param {number | Pattern} feedback between 0 and 1\\n * @synonyms delayfb, dfb\\n * @example\\n * s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1399,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of the signal that is fed back into the delay.\\nCaution: Values &gt;= 1 will result in a signal that gets louder and louder! Don't do it</p>","name":"delayfeedback","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"feedback"}],"synonyms_text":"delayfb, dfb","synonyms":["delayfb","dfb"],"examples":["s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")"],"longname":"delayfeedback","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the time of the delay effect.\\n *\\n * @name delayspeed\\n * @param {number | Pattern} delayspeed controls the pitch of the delay feedback\\n * @synonyms delayt, dt\\n * @example\\n * note(\\"d d a# a\\".fast(2)).s(\\"sawtooth\\").delay(.8).delaytime(1/2).delayspeed(\\"<2 .5 -1 -2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1411,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the time of the delay effect.</p>","name":"delayspeed","params":[{"type":{"names":["number","Pattern"]},"description":"<p>controls the pitch of the delay feedback</p>","name":"delayspeed"}],"synonyms_text":"delayt, dt","synonyms":["delayt","dt"],"examples":["note(\\"d d a# a\\".fast(2)).s(\\"sawtooth\\").delay(.8).delaytime(1/2).delayspeed(\\"<2 .5 -1 -2>\\")"],"longname":"delayspeed","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the time of the delay effect in cycles.\\n *\\n * @name delaysync\\n * @param {number | Pattern} cycles delay length in cycles\\n * @synonyms delayt, dt\\n * @example\\n * s(\\"bd bd\\").delay(.25).delaysync(\\"<1 2 3 5>\\".div(8))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1423,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the time of the delay effect in cycles.</p>","name":"delaysync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>delay length in cycles</p>","name":"cycles"}],"synonyms_text":"delayt, dt","synonyms":["delayt","dt"],"examples":["s(\\"bd bd\\").delay(.25).delaysync(\\"<1 2 3 5>\\".div(8))"],"longname":"delaysync","kind":"member","scope":"global"},{"comment":"/**\\n * Specifies whether delaytime is calculated relative to cps.\\n *\\n * @name lock\\n * @param {number | Pattern} enable When set to 1, delaytime is a direct multiple of a cycle.\\n * @superdirtOnly\\n * @example\\n * s(\\"sd\\").delay().lock(1).osc()\\n *\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1435,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Specifies whether delaytime is calculated relative to cps.</p>","name":"lock","params":[{"type":{"names":["number","Pattern"]},"description":"<p>When set to 1, delaytime is a direct multiple of a cycle.</p>","name":"enable"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"sd\\").delay().lock(1).osc()"],"longname":"lock","kind":"member","scope":"global"},{"comment":"/**\\n * Set detune for stacked voices of supported oscillators\\n *\\n * @name detune\\n * @param {number | Pattern} amount\\n * @synonyms det\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").detune(\\"<.1 .2 .5 24.1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set detune for stacked voices of supported oscillators</p>","name":"detune","params":[{"type":{"names":["number","Pattern"]},"name":"amount"}],"synonyms_text":"det","synonyms":["det"],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").detune(\\"<.1 .2 .5 24.1>\\")"],"longname":"detune","kind":"member","scope":"global"},{"comment":"/**\\n * Set number of stacked voices for supported oscillators\\n *\\n * @name unison\\n * @param {number | Pattern} numvoices\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").unison(\\"<1 2 7>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1459,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set number of stacked voices for supported oscillators</p>","name":"unison","params":[{"type":{"names":["number","Pattern"]},"name":"numvoices"}],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").unison(\\"<1 2 7>\\")"],"longname":"unison","kind":"member","scope":"global"},{"comment":"/**\\n * Set the stereo pan spread for supported oscillators\\n *\\n * @name spread\\n * @param {number | Pattern} spread between 0 and 1\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").spread(\\"<0 .3 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1470,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set the stereo pan spread for supported oscillators</p>","name":"spread","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"spread"}],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").spread(\\"<0 .3 1>\\")"],"longname":"spread","kind":"member","scope":"global"},{"comment":"/**\\n * Set dryness of reverb. See \`room\` and \`size\` for more information about reverb.\\n *\\n * @name dry\\n * @param {number | Pattern} dry 0 = wet, 1 = dry\\n * @example\\n * n(\\"[0,3,7](3,8)\\").s(\\"superpiano\\").room(.7).dry(\\"<0 .5 .75 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1480,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set dryness of reverb. See <code>room</code> and <code>size</code> for more information about reverb.</p>","name":"dry","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 = wet, 1 = dry</p>","name":"dry"}],"examples":["n(\\"[0,3,7](3,8)\\").s(\\"superpiano\\").room(.7).dry(\\"<0 .5 .75 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"dry","kind":"member","scope":"global"},{"comment":"/**\\n * Set frequency of sound.\\n *\\n * @name freq\\n * @param {number | Pattern} frequency in Hz. the audible range is between 20 and 20000 Hz\\n * @example\\n * freq(\\"220 110 440 110\\").s(\\"superzow\\").osc()\\n * @example\\n * freq(\\"110\\".mul.out(\\".5 1.5 .6 [2 3]\\")).s(\\"superzow\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1505,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Set frequency of sound.</p>","name":"freq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>in Hz. the audible range is between 20 and 20000 Hz</p>","name":"frequency"}],"examples":["freq(\\"220 110 440 110\\").s(\\"superzow\\").osc()","freq(\\"110\\".mul.out(\\".5 1.5 .6 [2 3]\\")).s(\\"superzow\\").osc()"],"longname":"freq","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of pitch envelope.\\n *\\n * @name pattack\\n * @synonyms patt\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"c eb g bb\\").pattack(\\"0 .1 .25 .5\\").slow(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1518,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Attack time of pitch envelope.</p>","name":"pattack","synonyms_text":"patt","synonyms":["patt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"c eb g bb\\").pattack(\\"0 .1 .25 .5\\").slow(2)"],"longname":"pattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of pitch envelope.\\n *\\n * @name pdecay\\n * @synonyms pdec\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"<c eb g bb>\\").pdecay(\\"<0 .1 .25 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1529,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Decay time of pitch envelope.</p>","name":"pdecay","synonyms_text":"pdec","synonyms":["pdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"<c eb g bb>\\").pdecay(\\"<0 .1 .25 .5>\\")"],"longname":"pdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of pitch envelope\\n *\\n * @name prelease\\n * @synonyms prel\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"<c eb g bb> ~\\")\\n * .release(.5) // to hear the pitch release\\n * .prelease(\\"<0 .1 .25 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1542,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Release time of pitch envelope</p>","name":"prelease","synonyms_text":"prel","synonyms":["prel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"<c eb g bb> ~\\")\\n.release(.5) // to hear the pitch release\\n.prelease(\\"<0 .1 .25 .5>\\")"],"longname":"prelease","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of pitch envelope. Negative values will flip the envelope.\\n * If you don't set other pitch envelope controls, \`pattack:.2\` will be the default.\\n *\\n * @name penv\\n * @param {number | Pattern} semitones change in semitones\\n * @example\\n * note(\\"c\\")\\n * .penv(\\"<12 7 1 .5 0 -1 -7 -12>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1555,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Amount of pitch envelope. Negative values will flip the envelope.\\nIf you don't set other pitch envelope controls, <code>pattack:.2</code> will be the default.</p>","name":"penv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>change in semitones</p>","name":"semitones"}],"examples":["note(\\"c\\")\\n.penv(\\"<12 7 1 .5 0 -1 -7 -12>\\")"],"longname":"penv","kind":"member","scope":"global"},{"comment":"/**\\n * Curve of envelope. Defaults to linear. exponential is good for kicks\\n *\\n * @name pcurve\\n * @param {number | Pattern} type 0 = linear, 1 = exponential\\n * @example\\n * note(\\"g1*4\\")\\n * .s(\\"sine\\").pdec(.5)\\n * .penv(32)\\n * .pcurve(\\"<0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1567,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Curve of envelope. Defaults to linear. exponential is good for kicks</p>","name":"pcurve","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 = linear, 1 = exponential</p>","name":"type"}],"examples":["note(\\"g1*4\\")\\n.s(\\"sine\\").pdec(.5)\\n.penv(32)\\n.pcurve(\\"<0 1>\\")"],"longname":"pcurve","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the range anchor of the envelope:\\n * - anchor 0: range = [note, note + penv]\\n * - anchor 1: range = [note - penv, note]\\n * If you don't set an anchor, the value will default to the psustain value.\\n *\\n * @name panchor\\n * @param {number | Pattern} anchor anchor offset\\n * @example\\n * note(\\"c c4\\").penv(12).panchor(\\"<0 .5 1 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1580,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the range anchor of the envelope:</p>\\n<ul>\\n<li>anchor 0: range = [note, note + penv]</li>\\n<li>anchor 1: range = [note - penv, note]\\nIf you don't set an anchor, the value will default to the psustain value.</li>\\n</ul>","name":"panchor","params":[{"type":{"names":["number","Pattern"]},"description":"<p>anchor offset</p>","name":"anchor"}],"examples":["note(\\"c c4\\").penv(12).panchor(\\"<0 .5 1 .5>\\")"],"longname":"panchor","kind":"member","scope":"global"},{"comment":"/**\\n * Emulation of a Leslie speaker: speakers rotating in a wooden amplified cabinet.\\n *\\n * @name leslie\\n * @param {number | Pattern} wet between 0 and 1\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(\\"<0 .4 .6 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1604,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Emulation of a Leslie speaker: speakers rotating in a wooden amplified cabinet.</p>","name":"leslie","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"wet"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(\\"<0 .4 .6 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"leslie","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of modulation / rotation for leslie effect\\n *\\n * @name lrate\\n * @param {number | Pattern} rate 6.7 for fast, 0.7 for slow\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(\\"<1 2 4 8>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1615,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Rate of modulation / rotation for leslie effect</p>","name":"lrate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>6.7 for fast, 0.7 for slow</p>","name":"rate"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(\\"<1 2 4 8>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"lrate","kind":"member","scope":"global"},{"comment":"/**\\n * Physical size of the cabinet in meters. Be careful, it might be slightly larger than your computer. Affects the Doppler amount (pitch warble)\\n *\\n * @name lsize\\n * @param {number | Pattern} meters somewhere between 0 and 1\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(2).lsize(\\"<.1 .5 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1627,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Physical size of the cabinet in meters. Be careful, it might be slightly larger than your computer. Affects the Doppler amount (pitch warble)</p>","name":"lsize","params":[{"type":{"names":["number","Pattern"]},"description":"<p>somewhere between 0 and 1</p>","name":"meters"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(2).lsize(\\"<.1 .5 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"lsize","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the displayed text for an event on the pianoroll\\n *\\n * @name label\\n * @param {string} label text to display\\n */","meta":{"filename":"controls.mjs","lineno":1638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the displayed text for an event on the pianoroll</p>","name":"label","params":[{"type":{"names":["string"]},"description":"<p>text to display</p>","name":"label"}],"longname":"label","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the default octave of a synth.\\n *\\n * @name octave\\n * @param {number | Pattern} octave octave number\\n * @example\\n * n(\\"0,4,7\\").s('supersquare').octave(\\"<3 4 5 6>\\").osc()\\n * @superDirtOnly\\n */","meta":{"filename":"controls.mjs","lineno":1674,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the default octave of a synth.</p>","name":"octave","params":[{"type":{"names":["number","Pattern"]},"description":"<p>octave number</p>","name":"octave"}],"examples":["n(\\"0,4,7\\").s('supersquare').octave(\\"<3 4 5 6>\\").osc()"],"tags":[{"originalTitle":"superDirtOnly","title":"superdirtonly","text":""}],"longname":"octave","kind":"member","scope":"global"},{"comment":"/**\\n * An \`orbit\` is a global parameter context for patterns. Patterns with the same orbit will share the same global effects.\\n *\\n * @name orbit\\n * @param {number | Pattern} number\\n * @example\\n * stack(\\n *   s(\\"hh*6\\").delay(.5).delaytime(.25).orbit(1),\\n *   s(\\"~ sd ~ sd\\").delay(.5).delaytime(.125).orbit(2)\\n * )\\n */","meta":{"filename":"controls.mjs","lineno":1687,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>An <code>orbit</code> is a global parameter context for patterns. Patterns with the same orbit will share the same global effects.</p>","name":"orbit","params":[{"type":{"names":["number","Pattern"]},"name":"number"}],"examples":["stack(\\n  s(\\"hh*6\\").delay(.5).delaytime(.25).orbit(1),\\n  s(\\"~ sd ~ sd\\").delay(.5).delaytime(.125).orbit(2)\\n)"],"longname":"orbit","kind":"member","scope":"global"},{"comment":"/**\\n * Sets position in stereo.\\n *\\n * @name pan\\n * @param {number | Pattern} pan between 0 and 1, from left to right (assuming stereo), once round a circle (assuming multichannel)\\n * @example\\n * s(\\"[bd hh]*2\\").pan(\\"<.5 1 .5 0>\\")\\n * @example\\n * s(\\"bd rim sd rim bd ~ cp rim\\").pan(sine.slow(2))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1703,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets position in stereo.</p>","name":"pan","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, from left to right (assuming stereo), once round a circle (assuming multichannel)</p>","name":"pan"}],"examples":["s(\\"[bd hh]*2\\").pan(\\"<.5 1 .5 0>\\")","s(\\"bd rim sd rim bd ~ cp rim\\").pan(sine.slow(2))"],"longname":"pan","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of reverb.\\n *\\n * When using mininotation, you can also optionally add the 'size' parameter, separated by ':'.\\n *\\n * @name room\\n * @param {number | Pattern} level between 0 and 1\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(\\"<0 .2 .4 .6 .8 1>\\")\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(\\"<0.9:1 0.9:4>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1766,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the level of reverb.</p>\\n<p>When using mininotation, you can also optionally add the 'size' parameter, separated by ':'.</p>","name":"room","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"level"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(\\"<0 .2 .4 .6 .8 1>\\")","s(\\"bd sd [~ bd] sd\\").room(\\"<0.9:1 0.9:4>\\")"],"longname":"room","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb lowpass starting frequency (in hertz).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomlp\\n * @synonyms rlp\\n * @param {number} frequency between 0 and 20000hz\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000)\\n */","meta":{"filename":"controls.mjs","lineno":1780,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb lowpass starting frequency (in hertz).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomlp","synonyms_text":"rlp","synonyms":["rlp"],"params":[{"type":{"names":["number"]},"description":"<p>between 0 and 20000hz</p>","name":"frequency"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000)"],"longname":"roomlp","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb lowpass frequency at -60dB (in hertz).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomdim\\n * @synonyms rdim\\n * @param {number} frequency between 0 and 20000hz\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rdim(8000)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rdim(400)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1793,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb lowpass frequency at -60dB (in hertz).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomdim","synonyms_text":"rdim","synonyms":["rdim"],"params":[{"type":{"names":["number"]},"description":"<p>between 0 and 20000hz</p>","name":"frequency"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rdim(8000)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rdim(400)"],"longname":"roomdim","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb fade time (in seconds).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomfade\\n * @synonyms rfade\\n * @param {number} seconds for the reverb to fade\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rfade(0.5)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rfade(4)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1807,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverb fade time (in seconds).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomfade","synonyms_text":"rfade","synonyms":["rfade"],"params":[{"type":{"names":["number"]},"description":"<p>for the reverb to fade</p>","name":"seconds"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rfade(0.5)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rfade(4)"],"longname":"roomfade","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sample to use as an impulse response for the reverb.\\n * @name iresponse\\n * @param {string | Pattern} sample to use as an impulse response\\n * @synonyms ir\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).ir(\\"<shaker_large:0 shaker_large:2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1821,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the sample to use as an impulse response for the reverb.</p>","name":"iresponse","params":[{"type":{"names":["string","Pattern"]},"description":"<p>to use as an impulse response</p>","name":"sample"}],"synonyms_text":"ir","synonyms":["ir"],"examples":["s(\\"bd sd [~ bd] sd\\").room(.8).ir(\\"<shaker_large:0 shaker_large:2>\\")"],"longname":"iresponse","kind":"member","scope":"global"},{"comment":"/**\\n * Sets speed of the sample for the impulse response.\\n * @name irspeed\\n * @param {string | Pattern} speed\\n * @example\\n * samples('github:switchangel/pad')\\n * $: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.2).irspeed(\\"<2 1 .5>/2\\").irbegin(.5).roomsize(.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets speed of the sample for the impulse response.</p>","name":"irspeed","params":[{"type":{"names":["string","Pattern"]},"name":"speed"}],"examples":["samples('github:switchangel/pad')\\n$: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.2).irspeed(\\"<2 1 .5>/2\\").irbegin(.5).roomsize(.5)"],"longname":"irspeed","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the beginning of the IR response sample\\n * @name irbegin\\n * @param {string | Pattern} begin between 0 and 1\\n * @synonyms ir\\n * @example\\n * samples('github:switchangel/pad')\\n * $: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.65).irspeed(\\"-2\\").irbegin(\\"<0 .5 .75>/2\\").roomsize(.6)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1843,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the beginning of the IR response sample</p>","name":"irbegin","params":[{"type":{"names":["string","Pattern"]},"description":"<p>between 0 and 1</p>","name":"begin"}],"synonyms_text":"ir","synonyms":["ir"],"examples":["samples('github:switchangel/pad')\\n$: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.65).irspeed(\\"-2\\").irbegin(\\"<0 .5 .75>/2\\").roomsize(.6)"],"longname":"irbegin","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the room size of the reverb, see \`room\`.\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomsize\\n * @param {number | Pattern} size between 0 and 10\\n * @synonyms rsize, sz, size\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).rsize(1)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).rsize(4)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1854,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the room size of the reverb, see <code>room</code>.\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomsize","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 10</p>","name":"size"}],"synonyms_text":"rsize, sz, size","synonyms":["rsize","sz","size"],"examples":["s(\\"bd sd [~ bd] sd\\").room(.8).rsize(1)","s(\\"bd sd [~ bd] sd\\").room(.8).rsize(4)"],"longname":"roomsize","kind":"member","scope":"global"},{"comment":"/**\\n * (Deprecated) Wave shaping distortion. WARNING: can suddenly get unpredictably loud.\\n * Please use distort instead, which has a more predictable response curve\\n * second option in optional array syntax (ex: \\".9:.5\\") applies a postgain to the output\\n *\\n *\\n * @name shape\\n * @param {number | Pattern} distortion between 0 and 1\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").shape(\\"<0 .2 .4 .6 .8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1875,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>(Deprecated) Wave shaping distortion. WARNING: can suddenly get unpredictably loud.\\nPlease use distort instead, which has a more predictable response curve\\nsecond option in optional array syntax (ex: &quot;.9:.5&quot;) applies a postgain to the output</p>","name":"shape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"distortion"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").shape(\\"<0 .2 .4 .6 .8>\\")"],"longname":"shape","kind":"member","scope":"global"},{"comment":"/**\\n * Wave shaping distortion. CAUTION: it can get loud.\\n * Second option in optional array syntax (ex: \\".9:.5\\") applies a postgain to the output. Third option sets the waveshaping type.\\n * Most useful values are usually between 0 and 10 (depending on source gain). If you are feeling adventurous, you can turn it up to 11 and beyond ;)\\n *\\n * @name distort\\n * @synonyms dist\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n * @param {number | string | Pattern} type type of distortion to apply\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").distort(\\"<0 2 3 10:.5>\\")\\n * @example\\n * note(\\"d1!8\\").s(\\"sine\\").penv(36).pdecay(.12).decay(.23).distort(\\"8:.4\\")\\n * @example\\n * s(\\"bd:4*4\\").bank(\\"tr808\\").distort(\\"3:0.5:diode\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1888,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wave shaping distortion. CAUTION: it can get loud.\\nSecond option in optional array syntax (ex: &quot;.9:.5&quot;) applies a postgain to the output. Third option sets the waveshaping type.\\nMost useful values are usually between 0 and 10 (depending on source gain). If you are feeling adventurous, you can turn it up to 11 and beyond ;)</p>","name":"distort","synonyms_text":"dist","synonyms":["dist"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"},{"type":{"names":["number","string","Pattern"]},"description":"<p>type of distortion to apply</p>","name":"type"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").distort(\\"<0 2 3 10:.5>\\")","note(\\"d1!8\\").s(\\"sine\\").penv(36).pdecay(.12).decay(.23).distort(\\"8:.4\\")","s(\\"bd:4*4\\").bank(\\"tr808\\").distort(\\"3:0.5:diode\\")"],"longname":"distort","kind":"member","scope":"global"},{"comment":"/**\\n * Postgain for waveshaping distortion.\\n *\\n * @name distortvol\\n * @synonyms distvol\\n * @param {number | Pattern} volume linear postgain of the distortion\\n * @example\\n * s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distortvol(0.8)\\n */","meta":{"filename":"controls.mjs","lineno":1908,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Postgain for waveshaping distortion.</p>","name":"distortvol","synonyms_text":"distvol","synonyms":["distvol"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"examples":["s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distortvol(0.8)"],"longname":"distortvol","kind":"member","scope":"global"},{"comment":"/**\\n * Type of waveshaping distortion to apply.\\n *\\n * @name distorttype\\n * @synonyms disttype\\n * @param {number | string | Pattern} type type of distortion to apply\\n * @example\\n * s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distorttype(\\"<0 1 2>\\")\\n *\\n * @example\\n * s(\\"sine\\").note(\\"F1*2\\").release(1)\\n *   .penv(24).pdecay(0.05)\\n *   .distort(rand.range(1, 8))\\n *   .distorttype(\\"<fold chebyshev scurve diode asym sinefold>\\")\\n */","meta":{"filename":"controls.mjs","lineno":1919,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Type of waveshaping distortion to apply.</p>","name":"distorttype","synonyms_text":"disttype","synonyms":["disttype"],"params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>type of distortion to apply</p>","name":"type"}],"examples":["s(\\"bd*4\\").bank(\\"tr909\\").distort(2).distorttype(\\"<0 1 2>\\")","s(\\"sine\\").note(\\"F1*2\\").release(1)\\n  .penv(24).pdecay(0.05)\\n  .distort(rand.range(1, 8))\\n  .distorttype(\\"<fold chebyshev scurve diode asym sinefold>\\")"],"longname":"distorttype","kind":"member","scope":"global"},{"comment":"/**\\n * Dynamics Compressor. The params are \`compressor(\\"threshold:ratio:knee:attack:release\\")\`\\n * More info [here](https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode?retiredLocale=de#instance_properties)\\n *\\n * @name compressor\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\")\\n * .compressor(\\"-20:20:10:.002:.02\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1936,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Dynamics Compressor. The params are <code>compressor(&quot;threshold:ratio:knee:attack:release&quot;)</code>\\nMore info <a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode?retiredLocale=de#instance_properties\\">here</a></p>","name":"compressor","examples":["s(\\"bd sd [~ bd] sd,hh*8\\")\\n.compressor(\\"-20:20:10:.002:.02\\")"],"longname":"compressor","kind":"member","scope":"global"},{"comment":"/**\\n * Changes the speed of sample playback, i.e. a cheap way of changing pitch.\\n *\\n * @name speed\\n * @param {number | Pattern} speed -inf to inf, negative numbers play the sample backwards.\\n * @example\\n * s(\\"bd*6\\").speed(\\"1 2 4 1 -2 -4\\")\\n * @example\\n * speed(\\"1 1.5*2 [2 1.1]\\").s(\\"piano\\").clip(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1957,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the speed of sample playback, i.e. a cheap way of changing pitch.</p>","name":"speed","params":[{"type":{"names":["number","Pattern"]},"description":"<p>inf to inf, negative numbers play the sample backwards.</p>","name":"speed"}],"examples":["s(\\"bd*6\\").speed(\\"1 2 4 1 -2 -4\\")","speed(\\"1 1.5*2 [2 1.1]\\").s(\\"piano\\").clip(1)"],"longname":"speed","kind":"member","scope":"global"},{"comment":"/**\\n * Changes the speed of sample playback, i.e. a cheap way of changing pitch.\\n *\\n * @name stretch\\n * @param {number | Pattern} factor -inf to inf, negative numbers play the sample backwards.\\n * @example\\n * s(\\"gm_flute\\").stretch(\\"1 2 .5\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1970,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the speed of sample playback, i.e. a cheap way of changing pitch.</p>","name":"stretch","params":[{"type":{"names":["number","Pattern"]},"description":"<p>inf to inf, negative numbers play the sample backwards.</p>","name":"factor"}],"examples":["s(\\"gm_flute\\").stretch(\\"1 2 .5\\")"],"longname":"stretch","kind":"member","scope":"global"},{"comment":"/**\\n * Used in conjunction with \`speed\`, accepts values of \\"r\\" (rate, default behavior), \\"c\\" (cycles), or \\"s\\" (seconds). Using \`unit \\"c\\"\` means \`speed\` will be interpreted in units of cycles, e.g. \`speed \\"1\\"\` means samples will be stretched to fill a cycle. Using \`unit \\"s\\"\` means the playback speed will be adjusted so that the duration is the number of seconds specified by \`speed\`.\\n *\\n * @name unit\\n * @param {number | string | Pattern} unit see description above\\n * @example\\n * speed(\\"1 2 .5 3\\").s(\\"bd\\").unit(\\"c\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1980,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Used in conjunction with <code>speed</code>, accepts values of &quot;r&quot; (rate, default behavior), &quot;c&quot; (cycles), or &quot;s&quot; (seconds). Using <code>unit &quot;c&quot;</code> means <code>speed</code> will be interpreted in units of cycles, e.g. <code>speed &quot;1&quot;</code> means samples will be stretched to fill a cycle. Using <code>unit &quot;s&quot;</code> means the playback speed will be adjusted so that the duration is the number of seconds specified by <code>speed</code>.</p>","name":"unit","params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>see description above</p>","name":"unit"}],"examples":["speed(\\"1 2 .5 3\\").s(\\"bd\\").unit(\\"c\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"unit","kind":"member","scope":"global"},{"comment":"/**\\n * Made by Calum Gunn. Reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter. The SuperCollider manual defines Squiz as:\\n *\\n * \\"A simplistic pitch-raising algorithm. It's not meant to sound natural; its sound is reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter, depending on the input. The algorithm works by cutting the signal into fragments (delimited by upwards-going zero-crossings) and squeezing those fragments in the time domain (i.e. simply playing them back faster than they came in), leaving silences inbetween. All the parameters apart from memlen can be modulated.\\"\\n *\\n * @name squiz\\n * @param {number | Pattern} squiz Try passing multiples of 2 to it - 2, 4, 8 etc.\\n * @example\\n * squiz(\\"2 4/2 6 [8 16]\\").s(\\"bd\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1992,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Made by Calum Gunn. Reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter. The SuperCollider manual defines Squiz as:</p>\\n<p>&quot;A simplistic pitch-raising algorithm. It's not meant to sound natural; its sound is reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter, depending on the input. The algorithm works by cutting the signal into fragments (delimited by upwards-going zero-crossings) and squeezing those fragments in the time domain (i.e. simply playing them back faster than they came in), leaving silences inbetween. All the parameters apart from memlen can be modulated.&quot;</p>","name":"squiz","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Try passing multiples of 2 to it - 2, 4, 8 etc.</p>","name":"squiz"}],"examples":["squiz(\\"2 4/2 6 [8 16]\\").s(\\"bd\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"squiz","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Formant filter to make things sound like vowels.\\n *\\n * @name vowel\\n * @param {string | Pattern} vowel You can use a e i o u ae aa oe ue y uh un en an on, corresponding to [a] [e] [i] [o] [u] [æ] [ɑ] [ø] [y] [ɯ] [ʌ] [œ̃] [ɛ̃] [ɑ̃] [ɔ̃]. Aliases: aa = å = ɑ, oe = ø = ö, y = ı, ae = æ.\\n * @example\\n * note(\\"[c2 <eb2 <g2 g1>>]*2\\").s('sawtooth')\\n * .vowel(\\"<a e i <o u>>\\")\\n * @example\\n * s(\\"bd sd mt ht bd [~ cp] ht lt\\").vowel(\\"[a|e|i|o|u]\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2017,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Formant filter to make things sound like vowels.</p>","name":"vowel","params":[{"type":{"names":["string","Pattern"]},"description":"<p>You can use a e i o u ae aa oe ue y uh un en an on, corresponding to [a] [e] [i] [o] [u] [æ] [ɑ] [ø] [y] [ɯ] [ʌ] [œ̃] [ɛ̃] [ɑ̃] [ɔ̃]. Aliases: aa = å = ɑ, oe = ø = ö, y = ı, ae = æ.</p>","name":"vowel"}],"examples":["note(\\"[c2 <eb2 <g2 g1>>]*2\\").s('sawtooth')\\n.vowel(\\"<a e i <o u>>\\")","s(\\"bd sd mt ht bd [~ cp] ht lt\\").vowel(\\"[a|e|i|o|u]\\")"],"longname":"vowel","kind":"member","scope":"global"},{"comment":"/**\\n * Noise crackle density\\n *\\n * @name density\\n * @param {number | Pattern} density between 0 and x\\n * @example\\n * s(\\"crackle*4\\").density(\\"<0.01 0.04 0.2 0.5>\\".slow(4))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2042,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Noise crackle density</p>","name":"density","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and x</p>","name":"density"}],"examples":["s(\\"crackle*4\\").density(\\"<0.01 0.04 0.2 0.5>\\".slow(4))"],"longname":"density","kind":"member","scope":"global"},{"comment":"/**\\n * Multiplies the duration with the given number. Also cuts samples off at the end if they exceed the duration.\\n *\\n * @name clip\\n * @synonyms legato\\n * @param {number | Pattern} factor >= 0\\n * @example\\n * note(\\"c a f e\\").s(\\"piano\\").clip(\\"<.5 1 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2092,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Multiplies the duration with the given number. Also cuts samples off at the end if they exceed the duration.</p>","name":"clip","synonyms_text":"legato","synonyms":["legato"],"params":[{"type":{"names":["number","Pattern"]},"description":"<blockquote>\\n<p>= 0</p>\\n</blockquote>","name":"factor"}],"examples":["note(\\"c a f e\\").s(\\"piano\\").clip(\\"<.5 1 2>\\")"],"longname":"clip","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the duration of the event in cycles. Similar to clip / legato, it also cuts samples off at the end if they exceed the duration.\\n *\\n * @name duration\\n * @synonyms dur\\n * @param {number | Pattern} seconds >= 0\\n * @example\\n * note(\\"c a f e\\").s(\\"piano\\").dur(\\"<.5 1 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":2104,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the duration of the event in cycles. Similar to clip / legato, it also cuts samples off at the end if they exceed the duration.</p>","name":"duration","synonyms_text":"dur","synonyms":["dur"],"params":[{"type":{"names":["number","Pattern"]},"description":"<blockquote>\\n<p>= 0</p>\\n</blockquote>","name":"seconds"}],"examples":["note(\\"c a f e\\").s(\\"piano\\").dur(\\"<.5 1 2>\\")"],"longname":"duration","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the color of the hap in visualizations like pianoroll or highlighting.\\n * @name color\\n * @synonyms colour\\n * @param {string} color Hexadecimal or CSS color name\\n */","meta":{"filename":"controls.mjs","lineno":2133,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets the color of the hap in visualizations like pianoroll or highlighting.</p>","name":"color","synonyms_text":"colour","synonyms":["colour"],"params":[{"type":{"names":["string"]},"description":"<p>Hexadecimal or CSS color name</p>","name":"color"}],"longname":"color","kind":"member","scope":"global"},{"comment":"/**\\n * ADSR envelope: Combination of Attack, Decay, Sustain, and Release.\\n *\\n * @name adsr\\n * @param {number | Pattern} time attack time in seconds\\n * @param {number | Pattern} time decay time in seconds\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n * @param {number | Pattern} time release time in seconds\\n * @example\\n * note(\\"[c3 bb2 f3 eb3]*2\\").sound(\\"sawtooth\\").lpf(600).adsr(\\".1:.1:.5:.2\\")\\n */","meta":{"filename":"controls.mjs","lineno":2146,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>ADSR envelope: Combination of Attack, Decay, Sustain, and Release.</p>","name":"adsr","params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"},{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"},{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"},{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"examples":["note(\\"[c3 bb2 f3 eb3]*2\\").sound(\\"sawtooth\\").lpf(600).adsr(\\".1:.1:.5:.2\\")"],"longname":"adsr","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI channel: Sets the MIDI channel for the event.\\n *\\n * @name midichan\\n * @param {number | Pattern} channel MIDI channel number (0-15)\\n * @example\\n * note(\\"c4\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2180,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI channel: Sets the MIDI channel for the event.</p>","name":"midichan","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI channel number (0-15)</p>","name":"channel"}],"examples":["note(\\"c4\\").midichan(1).midi()"],"longname":"midichan","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI port: Sets the MIDI port for the event.\\n *\\n * @name midiport\\n * @param {number | Pattern} port MIDI port\\n * @example\\n * note(\\"c a f e\\").midiport(\\"<0 1 2 3>\\").midi()\\n */","meta":{"filename":"controls.mjs","lineno":2192,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI port: Sets the MIDI port for the event.</p>","name":"midiport","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI port</p>","name":"port"}],"examples":["note(\\"c a f e\\").midiport(\\"<0 1 2 3>\\").midi()"],"longname":"midiport","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI command: Sends a MIDI command message.\\n *\\n * @name midicmd\\n * @param {number | Pattern} command MIDI command\\n * @example\\n * midicmd(\\"clock*48,<start stop>/2\\").midi()\\n */","meta":{"filename":"controls.mjs","lineno":2202,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI command: Sends a MIDI command message.</p>","name":"midicmd","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI command</p>","name":"command"}],"examples":["midicmd(\\"clock*48,<start stop>/2\\").midi()"],"longname":"midicmd","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control: Sends a MIDI control change message.\\n *\\n * @name control\\n * @param {number | Pattern}  MIDI control number (0-127)\\n * @param {number | Pattern}  MIDI controller value (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control: Sends a MIDI control change message.</p>","name":"control","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control number (0-127)</p>","name":"MIDI"},{"type":{"names":["number","Pattern"]},"description":"<p>controller value (0-127)</p>","name":"MIDI"}],"longname":"control","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control number: Sends a MIDI control change message.\\n *\\n * @name ccn\\n * @param {number | Pattern}  MIDI control number (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2227,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control number: Sends a MIDI control change message.</p>","name":"ccn","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control number (0-127)</p>","name":"MIDI"}],"longname":"ccn","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control value: Sends a MIDI control change message.\\n *\\n * @name ccv\\n * @param {number | Pattern}  MIDI control value (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":2234,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI control value: Sends a MIDI control change message.</p>","name":"ccv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control value (0-127)</p>","name":"MIDI"}],"longname":"ccv","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI NRPN non-registered parameter number: Sends a MIDI NRPN non-registered parameter number message.\\n * @name nrpnn\\n * @param {number | Pattern} nrpnn MIDI NRPN non-registered parameter number (0-127)\\n * @example\\n * note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2244,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI NRPN non-registered parameter number: Sends a MIDI NRPN non-registered parameter number message.</p>","name":"nrpnn","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI NRPN non-registered parameter number (0-127)</p>","name":"nrpnn"}],"examples":["note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()"],"longname":"nrpnn","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI NRPN non-registered parameter value: Sends a MIDI NRPN non-registered parameter value message.\\n * @name nrpv\\n * @param {number | Pattern} nrpv MIDI NRPN non-registered parameter value (0-127)\\n * @example\\n * note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2252,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI NRPN non-registered parameter value: Sends a MIDI NRPN non-registered parameter value message.</p>","name":"nrpv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI NRPN non-registered parameter value (0-127)</p>","name":"nrpv"}],"examples":["note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()"],"longname":"nrpv","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI program number: Sends a MIDI program change message.\\n *\\n * @name progNum\\n * @param {number | Pattern} program MIDI program number (0-127)\\n * @example\\n * note(\\"c4\\").progNum(10).midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2261,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI program number: Sends a MIDI program change message.</p>","name":"progNum","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI program number (0-127)</p>","name":"program"}],"examples":["note(\\"c4\\").progNum(10).midichan(1).midi()"],"longname":"progNum","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex: Sends a MIDI sysex message.\\n * @name sysex\\n * @param {number | Pattern} id Sysex ID\\n * @param {number | Pattern} data Sysex data\\n * @example\\n * note(\\"c4\\").sysex([\\"0x77\\", \\"0x01:0x02:0x03:0x04\\"]).midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex: Sends a MIDI sysex message.</p>","name":"sysex","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex ID</p>","name":"id"},{"type":{"names":["number","Pattern"]},"description":"<p>Sysex data</p>","name":"data"}],"examples":["note(\\"c4\\").sysex([\\"0x77\\", \\"0x01:0x02:0x03:0x04\\"]).midichan(1).midi()"],"longname":"sysex","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex ID: Sends a MIDI sysex identifier message.\\n * @name sysexid\\n * @param {number | Pattern} id Sysex ID\\n * @example\\n * note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2286,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex ID: Sends a MIDI sysex identifier message.</p>","name":"sysexid","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex ID</p>","name":"id"}],"examples":["note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()"],"longname":"sysexid","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex data: Sends a MIDI sysex message.\\n * @name sysexdata\\n * @param {number | Pattern} data Sysex data\\n * @example\\n * note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2294,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI sysex data: Sends a MIDI sysex message.</p>","name":"sysexdata","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex data</p>","name":"data"}],"examples":["note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()"],"longname":"sysexdata","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI pitch bend: Sends a MIDI pitch bend message.\\n * @name midibend\\n * @param {number | Pattern} midibend MIDI pitch bend (-1 - 1)\\n * @example\\n * note(\\"c4\\").midibend(sine.slow(4).range(-0.4,0.4)).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2303,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI pitch bend: Sends a MIDI pitch bend message.</p>","name":"midibend","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI pitch bend (-1 - 1)</p>","name":"midibend"}],"examples":["note(\\"c4\\").midibend(sine.slow(4).range(-0.4,0.4)).midi()"],"longname":"midibend","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI key after touch: Sends a MIDI key after touch message.\\n * @name miditouch\\n * @param {number | Pattern} miditouch MIDI key after touch (0-1)\\n * @example\\n * note(\\"c4\\").miditouch(sine.slow(4).range(0,1)).midi()\\n */","meta":{"filename":"controls.mjs","lineno":2311,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>MIDI key after touch: Sends a MIDI key after touch message.</p>","name":"miditouch","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI key after touch (0-1)</p>","name":"miditouch"}],"examples":["note(\\"c4\\").miditouch(sine.slow(4).range(0,1)).midi()"],"longname":"miditouch","kind":"member","scope":"global"},{"comment":"/**\\n * The host to send open sound control messages to. Requires running the OSC bridge.\\n * @name oschost\\n * @param {string | Pattern} oschost e.g. 'localhost'\\n * @example\\n * note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();\\n */","meta":{"filename":"controls.mjs","lineno":2323,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The host to send open sound control messages to. Requires running the OSC bridge.</p>","name":"oschost","params":[{"type":{"names":["string","Pattern"]},"description":"<p>e.g. 'localhost'</p>","name":"oschost"}],"examples":["note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();"],"longname":"oschost","kind":"member","scope":"global"},{"comment":"/**\\n * The port to send open sound control messages to. Requires running the OSC bridge.\\n * @name oscport\\n * @param {number | Pattern} oscport e.g. 57120\\n * @example\\n * note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();\\n */","meta":{"filename":"controls.mjs","lineno":2332,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The port to send open sound control messages to. Requires running the OSC bridge.</p>","name":"oscport","params":[{"type":{"names":["number","Pattern"]},"description":"<p>e.g. 57120</p>","name":"oscport"}],"examples":["note(\\"c4\\").oschost('127.0.0.1').oscport(57120).osc();"],"longname":"oscport","kind":"member","scope":"global"},{"comment":"/**\\n * Sets properties in a batch.\\n *\\n * @name as\\n * @param {String | Array} mapping the control names that are set\\n * @example\\n * \\"c:.5 a:1 f:.25 e:.8\\".as(\\"note:clip\\")\\n * @example\\n * \\"{0@2 0.25 0 0.5 .3 .5}%8\\".as(\\"begin\\").s(\\"sax_vib\\").clip(1)\\n */","meta":{"filename":"controls.mjs","lineno":2348,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Sets properties in a batch.</p>","name":"as","params":[{"type":{"names":["String","Array"]},"description":"<p>the control names that are set</p>","name":"mapping"}],"examples":["\\"c:.5 a:1 f:.25 e:.8\\".as(\\"note:clip\\")","\\"{0@2 0.25 0 0.5 .3 .5}%8\\".as(\\"begin\\").s(\\"sax_vib\\").clip(1)"],"longname":"as","kind":"member","scope":"global"},{"comment":"/**\\n * Allows you to scrub an audio file like a tape loop by passing values that represents the position in the audio file\\n * in the optional array syntax ex: \\"0.5:2\\", the second value controls the speed of playback\\n * @name scrub\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples('github:switchangel/pad')\\n * s(\\"swpad:0\\").scrub(\\"{0.1!2 .25@3 0.7!2 <0.8:1.5>}%8\\")\\n * @example\\n * samples('github:yaxu/clean-breaks/main');\\n * s(\\"amen/4\\").fit().scrub(\\"{0@3 0@2 4@3}%8\\".div(16))\\n */","meta":{"filename":"controls.mjs","lineno":2367,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows you to scrub an audio file like a tape loop by passing values that represents the position in the audio file\\nin the optional array syntax ex: &quot;0.5:2&quot;, the second value controls the speed of playback</p>","name":"scrub","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples('github:switchangel/pad')\\ns(\\"swpad:0\\").scrub(\\"{0.1!2 .25@3 0.7!2 <0.8:1.5>}%8\\")","samples('github:yaxu/clean-breaks/main');\\ns(\\"amen/4\\").fit().scrub(\\"{0@3 0@2 4@3}%8\\".div(16))"],"scope":"static","longname":"Pattern.scrub","kind":"member"},{"comment":"/**\\n * Intended for a debugging, drawLine renders the pattern as a string, where each character represents the same time span.\\n * Should only be used with single characters as values, otherwise the character slots will be messed up.\\n * Character legend:\\n *\\n * - \\"|\\" cycle separator\\n * - \\"-\\" hold previous value\\n * - \\".\\" silence\\n *\\n * @param {Pattern} pattern the pattern to use\\n * @param {number} chars max number of characters (approximately)\\n * @returns string\\n * @example\\n * const line = drawLine(\\"0 [1 2 3]\\", 10); // |0--123|0--123\\n * console.log(line);\\n * silence;\\n */","meta":{"range":[1426,2796],"filename":"drawLine.mjs","lineno":26,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100021770","name":"drawLine","type":"FunctionDeclaration","paramnames":["pat","chars"]},"vars":{"cycle":"drawLine~cycle","pos":"drawLine~pos","lines":"drawLine~lines","emptyLine":"drawLine~emptyLine","haps":"drawLine~haps","durations":"drawLine~durations","":null,"charFraction":"drawLine~charFraction","totalSlots":"drawLine~totalSlots","i":"drawLine~i","undefined":null,"matches":"drawLine~matches","missingLines":"drawLine~missingLines"}},"description":"<p>Intended for a debugging, drawLine renders the pattern as a string, where each character represents the same time span.\\nShould only be used with single characters as values, otherwise the character slots will be messed up.\\nCharacter legend:</p>\\n<ul>\\n<li>&quot;|&quot; cycle separator</li>\\n<li>&quot;-&quot; hold previous value</li>\\n<li>&quot;.&quot; silence</li>\\n</ul>","params":[{"type":{"names":["Pattern"]},"description":"<p>the pattern to use</p>","name":"pattern"},{"type":{"names":["number"]},"description":"<p>max number of characters (approximately)</p>","name":"chars"}],"returns":[{"description":"<p>string</p>"}],"examples":["const line = drawLine(\\"0 [1 2 3]\\", 10); // |0--123|0--123\\nconsole.log(line);\\nsilence;"],"name":"drawLine","longname":"drawLine","kind":"function","scope":"global"},{"comment":"/**\\n * Changes the structure of the pattern to form an Euclidean rhythm.\\n * Euclidean rhythms are rhythms obtained using the greatest common\\n * divisor of two numbers.  They were described in 2004 by Godfried\\n * Toussaint, a Canadian computer scientist.  Euclidean rhythms are\\n * really useful for computer/algorithmic music because they can\\n * describe a large number of rhythms with a couple of numbers.\\n *\\n * @memberof Pattern\\n * @name euclid\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @returns Pattern\\n * @example\\n * // The Cuban tresillo pattern.\\n * note(\\"c3\\").euclid(3,8)\\n */","meta":{"filename":"euclid.mjs","lineno":54,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the structure of the pattern to form an Euclidean rhythm.\\nEuclidean rhythms are rhythms obtained using the greatest common\\ndivisor of two numbers.  They were described in 2004 by Godfried\\nToussaint, a Canadian computer scientist.  Euclidean rhythms are\\nreally useful for computer/algorithmic music because they can\\ndescribe a large number of rhythms with a couple of numbers.</p>","memberof":"Pattern","name":"euclid","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["// The Cuban tresillo pattern.\\nnote(\\"c3\\").euclid(3,8)"],"scope":"static","longname":"Pattern.euclid","kind":"member"},{"comment":"/**\\n * Like \`euclid\`, but has an additional parameter for 'rotating' the resulting sequence.\\n * @memberof Pattern\\n * @name euclidRot\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param {number} rotation offset in steps\\n * @returns Pattern\\n * @example\\n * // A Samba rhythm necklace from Brazil\\n * note(\\"c3\\").euclidRot(3,16,14)\\n */","meta":{"filename":"euclid.mjs","lineno":72,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>euclid</code>, but has an additional parameter for 'rotating' the resulting sequence.</p>","memberof":"Pattern","name":"euclidRot","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>offset in steps</p>","name":"rotation"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["// A Samba rhythm necklace from Brazil\\nnote(\\"c3\\").euclidRot(3,16,14)"],"scope":"static","longname":"Pattern.euclidRot","kind":"member"},{"comment":"/**\\n * @example // A thirteenth-century Persian rhythm called Khafif-e-ramal.\\n * note(\\"c3\\").euclid(2,5)\\n * @example // The archetypal pattern of the Cumbia from Colombia, as well as a Calypso rhythm from Trinidad.\\n * note(\\"c3\\").euclid(3,4)\\n * @example // Another thirteenth century Persian rhythm by the name of Khafif-e-ramal, as well as a Rumanian folk-dance rhythm.\\n * note(\\"c3\\").euclidRot(3,5,2)\\n * @example // A Ruchenitza rhythm used in a Bulgarian folk dance.\\n * note(\\"c3\\").euclid(3,7)\\n * @example // The Cuban tresillo pattern.\\n * note(\\"c3\\").euclid(3,8)\\n * @example // Another Ruchenitza Bulgarian folk-dance rhythm.\\n * note(\\"c3\\").euclid(4,7)\\n * @example // The Aksak rhythm of Turkey.\\n * note(\\"c3\\").euclid(4,9)\\n * @example // The metric pattern used by Frank Zappa in his piece titled Outside Now.\\n * note(\\"c3\\").euclid(4,11)\\n * @example // Yields the York-Samai pattern, a popular Arab rhythm.\\n * note(\\"c3\\").euclid(5,6)\\n * @example // The Nawakhat pattern, another popular Arab rhythm.\\n * note(\\"c3\\").euclid(5,7)\\n * @example // The Cuban cinquillo pattern.\\n * note(\\"c3\\").euclid(5,8)\\n * @example // A popular Arab rhythm called Agsag-Samai.\\n * note(\\"c3\\").euclid(5,9)\\n * @example // The metric pattern used by Moussorgsky in Pictures at an Exhibition.\\n * note(\\"c3\\").euclid(5,11)\\n * @example // The Venda clapping pattern of a South African children’s song.\\n * note(\\"c3\\").euclid(5,12)\\n * @example // The Bossa-Nova rhythm necklace of Brazil.\\n * note(\\"c3\\").euclid(5,16)\\n * @example // A typical rhythm played on the Bendir (frame drum).\\n * note(\\"c3\\").euclid(7,8)\\n * @example // A common West African bell pattern.\\n * note(\\"c3\\").euclid(7,12)\\n * @example // A Samba rhythm necklace from Brazil.\\n * note(\\"c3\\").euclidRot(7,16,14)\\n * @example // A rhythm necklace used in the Central African Republic.\\n * note(\\"c3\\").euclid(9,16)\\n * @example // A rhythm necklace of the Aka Pygmies of Central Africa.\\n * note(\\"c3\\").euclidRot(11,24,14)\\n * @example // Another rhythm necklace of the Aka Pygmies of the upper Sangha.\\n * note(\\"c3\\").euclidRot(13,24,5)\\n */","meta":{"range":[5307,5459],"filename":"euclid.mjs","lineno":130,"columnno":6,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100022275","name":"_euclidRot","type":"FunctionExpression"},"vars":{"b":"_euclidRot~b"}},"examples":["// A thirteenth-century Persian rhythm called Khafif-e-ramal.\\nnote(\\"c3\\").euclid(2,5)","// The archetypal pattern of the Cumbia from Colombia, as well as a Calypso rhythm from Trinidad.\\nnote(\\"c3\\").euclid(3,4)","// Another thirteenth century Persian rhythm by the name of Khafif-e-ramal, as well as a Rumanian folk-dance rhythm.\\nnote(\\"c3\\").euclidRot(3,5,2)","// A Ruchenitza rhythm used in a Bulgarian folk dance.\\nnote(\\"c3\\").euclid(3,7)","// The Cuban tresillo pattern.\\nnote(\\"c3\\").euclid(3,8)","// Another Ruchenitza Bulgarian folk-dance rhythm.\\nnote(\\"c3\\").euclid(4,7)","// The Aksak rhythm of Turkey.\\nnote(\\"c3\\").euclid(4,9)","// The metric pattern used by Frank Zappa in his piece titled Outside Now.\\nnote(\\"c3\\").euclid(4,11)","// Yields the York-Samai pattern, a popular Arab rhythm.\\nnote(\\"c3\\").euclid(5,6)","// The Nawakhat pattern, another popular Arab rhythm.\\nnote(\\"c3\\").euclid(5,7)","// The Cuban cinquillo pattern.\\nnote(\\"c3\\").euclid(5,8)","// A popular Arab rhythm called Agsag-Samai.\\nnote(\\"c3\\").euclid(5,9)","// The metric pattern used by Moussorgsky in Pictures at an Exhibition.\\nnote(\\"c3\\").euclid(5,11)","// The Venda clapping pattern of a South African children’s song.\\nnote(\\"c3\\").euclid(5,12)","// The Bossa-Nova rhythm necklace of Brazil.\\nnote(\\"c3\\").euclid(5,16)","// A typical rhythm played on the Bendir (frame drum).\\nnote(\\"c3\\").euclid(7,8)","// A common West African bell pattern.\\nnote(\\"c3\\").euclid(7,12)","// A Samba rhythm necklace from Brazil.\\nnote(\\"c3\\").euclidRot(7,16,14)","// A rhythm necklace used in the Central African Republic.\\nnote(\\"c3\\").euclid(9,16)","// A rhythm necklace of the Aka Pygmies of Central Africa.\\nnote(\\"c3\\").euclidRot(11,24,14)","// Another rhythm necklace of the Aka Pygmies of the upper Sangha.\\nnote(\\"c3\\").euclidRot(13,24,5)"],"name":"_euclidRot","longname":"_euclidRot","kind":"function","scope":"global","params":[]},{"comment":"/**\\n * Similar to \`euclid\`, but each pulse is held until the next pulse,\\n * so there will be no gaps.\\n * @name euclidLegato\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param rotation offset in steps\\n * @param pat\\n * @example\\n * note(\\"c3\\").euclidLegato(3,8)\\n */","meta":{"filename":"euclid.mjs","lineno":154,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Similar to <code>euclid</code>, but each pulse is held until the next pulse,\\nso there will be no gaps.</p>","name":"euclidLegato","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"description":"<p>offset in steps</p>","name":"rotation"},{"name":"pat"}],"examples":["note(\\"c3\\").euclidLegato(3,8)"],"scope":"static","longname":"Pattern.euclidLegato","kind":"member"},{"comment":"/**\\n * Similar to \`euclid\`, but each pulse is held until the next pulse,\\n * so there will be no gaps, and has an additional parameter for 'rotating'\\n * the resulting sequence\\n * @name euclidLegatoRot\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param {number} rotation offset in steps\\n * @example\\n * note(\\"c3\\").euclidLegatoRot(3,5,2)\\n */","meta":{"filename":"euclid.mjs","lineno":184,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Similar to <code>euclid</code>, but each pulse is held until the next pulse,\\nso there will be no gaps, and has an additional parameter for 'rotating'\\nthe resulting sequence</p>","name":"euclidLegatoRot","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>offset in steps</p>","name":"rotation"}],"examples":["note(\\"c3\\").euclidLegatoRot(3,5,2)"],"scope":"static","longname":"Pattern.euclidLegatoRot","kind":"member"},{"comment":"/**\\n * A 'euclid' variant with an additional parameter that morphs the resulting\\n * rhythm from 0 (no morphing) to 1 (completely 'even'). For example\\n * \`sound(\\"bd\\").euclidish(3,8,0)\` would be the same as\\n * \`sound(\\"bd\\").euclid(3,8)\`, and \`sound(\\"bd\\").euclidish(3,8,1)\` would be the\\n * same as \`sound(\\"bd bd bd\\")\`. \`sound(\\"bd\\").euclidish(3,8,0.5)\` would have a\\n * groove somewhere between.\\n * Inspired by the work of Malcom Braff.\\n * @name euclidish\\n * @synonyms eish\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets\\n * @param {number} steps the number of steps to fill\\n * @param {number} groove exists between the extremes of 0 (straight euclidian) and 1 (straight pulse)\\n * @example\\n * sound(\\"hh\\").euclidish(7,12,sine.slow(8))\\n * .pan(sine.slow(8))\\n */","meta":{"filename":"euclid.mjs","lineno":200,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A 'euclid' variant with an additional parameter that morphs the resulting\\nrhythm from 0 (no morphing) to 1 (completely 'even'). For example\\n<code>sound(&quot;bd&quot;).euclidish(3,8,0)</code> would be the same as\\n<code>sound(&quot;bd&quot;).euclid(3,8)</code>, and <code>sound(&quot;bd&quot;).euclidish(3,8,1)</code> would be the\\nsame as <code>sound(&quot;bd bd bd&quot;)</code>. <code>sound(&quot;bd&quot;).euclidish(3,8,0.5)</code> would have a\\ngroove somewhere between.\\nInspired by the work of Malcom Braff.</p>","name":"euclidish","synonyms_text":"eish","synonyms":["eish"],"memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>exists between the extremes of 0 (straight euclidian) and 1 (straight pulse)</p>","name":"groove"}],"examples":["sound(\\"hh\\").euclidish(7,12,sine.slow(8))\\n.pan(sine.slow(8))"],"scope":"static","longname":"Pattern.euclidish","kind":"member"},{"comment":"/** @class Class representing a pattern. */","meta":{"range":[1713,27921],"filename":"pattern.mjs","lineno":44,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100024880","name":"exports.Pattern","type":"ClassDeclaration"}},"name":"Pattern","longname":"Pattern","kind":"class","classdesc":"<p>Class representing a pattern.</p>","scope":"global","description":"<p>Create a pattern. As an end user, you will most likely not create a Pattern directly.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"memberof":"Pattern","params":[{"type":{"names":["function"]},"description":"<p>The function that maps a <code>State</code> to an array of <code>Hap</code>.</p>","name":"query"}]},{"comment":"/**\\n   * Returns a new pattern, with the function applied to the value of\\n   * each hap. It has the alias \`fmap\`.\\n   * @synonyms fmap\\n   * @param {Function} func to to apply to the value\\n   * @returns Pattern\\n   * @example\\n   * \\"0 1 2\\".withValue(v => v + 10).log()\\n   */","meta":{"range":[3020,3189],"filename":"pattern.mjs","lineno":93,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100024988","name":"Pattern#withValue","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern, with the function applied to the value of\\neach hap. It has the alias <code>fmap</code>.</p>","synonyms_text":"fmap","synonyms":["fmap"],"params":[{"type":{"names":["function"]},"description":"<p>to to apply to the value</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2\\".withValue(v => v + 10).log()"],"name":"withValue","longname":"Pattern#withValue","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * see \`withValue\`\\n   * @noAutocomplete\\n   */","meta":{"range":[3362,3411],"filename":"pattern.mjs","lineno":108,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025042","name":"Pattern#fmap","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>see <code>withValue</code></p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"fmap","longname":"Pattern#fmap","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Assumes 'this' is a pattern of functions, and given a function to\\n   * resolve wholes, applies a given pattern of values to that\\n   * pattern of functions.\\n   * @param {Function} whole_func\\n   * @param {Function} func\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[3693,4435],"filename":"pattern.mjs","lineno":121,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025053","name":"Pattern#appWhole","type":"MethodDefinition","paramnames":["whole_func","pat_val"]},"vars":{"":null}},"description":"<p>Assumes 'this' is a pattern of functions, and given a function to\\nresolve wholes, applies a given pattern of values to that\\npattern of functions.</p>","params":[{"type":{"names":["function"]},"name":"whole_func"},{"type":{"names":["function"]},"name":"func"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appWhole","longname":"Pattern#appWhole","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * When this method is called on a pattern of functions, it matches its haps\\n   * with those in the given pattern of values.  A new pattern is returned, with\\n   * each matching value applied to the corresponding function.\\n   *\\n   * In this \`_appBoth\` variant, where timespans of the function and value haps\\n   * are not the same but do intersect, the resulting hap has a timespan of the\\n   * intersection. This applies to both the part and the whole timespan.\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[4986,5410],"filename":"pattern.mjs","lineno":157,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025160","name":"Pattern#appBoth","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>When this method is called on a pattern of functions, it matches its haps\\nwith those in the given pattern of values.  A new pattern is returned, with\\neach matching value applied to the corresponding function.</p>\\n<p>In this <code>_appBoth</code> variant, where timespans of the function and value haps\\nare not the same but do intersect, the resulting hap has a timespan of the\\nintersection. This applies to both the part and the whole timespan.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appBoth","longname":"Pattern#appBoth","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`appBoth\`, but the \`whole\` timespan is not the intersection,\\n   * but the timespan from the function of patterns that this method is called\\n   * on. In practice, this means that the pattern structure, including onsets,\\n   * are preserved from the pattern of functions (often referred to as the left\\n   * hand or inner pattern).\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[5840,6644],"filename":"pattern.mjs","lineno":184,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025220","name":"Pattern#appLeft","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>As with <code>appBoth</code>, but the <code>whole</code> timespan is not the intersection,\\nbut the timespan from the function of patterns that this method is called\\non. In practice, this means that the pattern structure, including onsets,\\nare preserved from the pattern of functions (often referred to as the left\\nhand or inner pattern).</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appLeft","longname":"Pattern#appLeft","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`appLeft\`, but \`whole\` timespans are instead taken from the\\n   * pattern of values, i.e. structure is preserved from the right hand/outer\\n   * pattern.\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[6898,7706],"filename":"pattern.mjs","lineno":217,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100025342","name":"Pattern#appRight","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>As with <code>appLeft</code>, but <code>whole</code> timespans are instead taken from the\\npattern of values, i.e. structure is preserved from the right hand/outer\\npattern.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appRight","longname":"Pattern#appRight","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Query haps inside the given time span.\\n   *\\n   * @param {Fraction | number} begin from time\\n   * @param {Fraction | number} end to time\\n   * @returns Hap[]\\n   * @example\\n   * const pattern = sequence('a', ['b', 'c'])\\n   * const haps = pattern.queryArc(0, 1)\\n   * console.log(haps)\\n   * silence\\n   * @noAutocomplete\\n   */","meta":{"range":[13342,13558],"filename":"pattern.mjs","lineno":413,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026022","name":"Pattern#queryArc","type":"MethodDefinition","paramnames":["begin","end","controls"]},"vars":{"":null}},"description":"<p>Query haps inside the given time span.</p>","params":[{"type":{"names":["Fraction","number"]},"description":"<p>from time</p>","name":"begin"},{"type":{"names":["Fraction","number"]},"description":"<p>to time</p>","name":"end"}],"returns":[{"description":"<p>Hap[]</p>"}],"examples":["const pattern = sequence('a', ['b', 'c'])\\nconst haps = pattern.queryArc(0, 1)\\nconsole.log(haps)\\nsilence"],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"queryArc","longname":"Pattern#queryArc","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern, with queries split at cycle boundaries. This makes\\n   * some calculations easier to express, as all haps are then constrained to\\n   * happen within a cycle.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[13802,14002],"filename":"pattern.mjs","lineno":429,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026058","name":"Pattern#splitQueries","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with queries split at cycle boundaries. This makes\\nsome calculations easier to express, as all haps are then constrained to\\nhappen within a cycle.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"splitQueries","longname":"Pattern#splitQueries","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, where the given function is applied to the query\\n   * timespan before passing it to the original pattern.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[14245,14339],"filename":"pattern.mjs","lineno":444,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026098","name":"Pattern#withQuerySpan","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern, where the given function is applied to the query\\ntimespan before passing it to the original pattern.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withQuerySpan","longname":"Pattern#withQuerySpan","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withQuerySpan\`, but the function is applied to both the\\n   * begin and end time of the query timespan.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[14799,14918],"filename":"pattern.mjs","lineno":466,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026154","name":"Pattern#withQueryTime","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withQuerySpan</code>, but the function is applied to both the\\nbegin and end time of the query timespan.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withQueryTime","longname":"Pattern#withQueryTime","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Similar to \`withQuerySpan\`, but the function is applied to the timespans\\n   * of all haps returned by pattern queries (both \`part\` timespans, and where\\n   * present, \`whole\` timespans).\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15196,15306],"filename":"pattern.mjs","lineno":478,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026179","name":"Pattern#withHapSpan","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Similar to <code>withQuerySpan</code>, but the function is applied to the timespans\\nof all haps returned by pattern queries (both <code>part</code> timespans, and where\\npresent, <code>whole</code> timespans).</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHapSpan","longname":"Pattern#withHapSpan","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withHapSpan\`, but the function is applied to both the\\n   * begin and end time of the hap timespans.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15529,15612],"filename":"pattern.mjs","lineno":489,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026204","name":"Pattern#withHapTime","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withHapSpan</code>, but the function is applied to both the\\nbegin and end time of the hap timespans.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHapTime","longname":"Pattern#withHapTime","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the given function applied to the list of haps returned by every query.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15803,15950],"filename":"pattern.mjs","lineno":499,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026221","name":"Pattern#withHaps","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given function applied to the list of haps returned by every query.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHaps","longname":"Pattern#withHaps","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withHaps\`, but applies the function to every hap, rather than every list of haps.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16133,16204],"filename":"pattern.mjs","lineno":511,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026251","name":"Pattern#withHap","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withHaps</code>, but applies the function to every hap, rather than every list of haps.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHap","longname":"Pattern#withHap","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the context field set to every hap set to the given value.\\n   * @param {*} context\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16378,16462],"filename":"pattern.mjs","lineno":521,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026268","name":"Pattern#setContext","type":"MethodDefinition","paramnames":["context"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the context field set to every hap set to the given value.</p>","params":[{"type":{"names":["*"]},"name":"context"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"setContext","longname":"Pattern#setContext","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the given function applied to the context field of every hap.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16643,16883],"filename":"pattern.mjs","lineno":531,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026285","name":"Pattern#withContext","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given function applied to the context field of every hap.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withContext","longname":"Pattern#withContext","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the context field of every hap set to an empty object.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17029,17103],"filename":"pattern.mjs","lineno":545,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026333","name":"Pattern#stripContext","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern with the context field of every hap set to an empty object.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"stripContext","longname":"Pattern#stripContext","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern with the given location information added to the\\n   * context of every hap.\\n   * @param {Number} start start offset\\n   * @param {Number} end end offset\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17341,17708],"filename":"pattern.mjs","lineno":557,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026349","name":"Pattern#withLoc","type":"MethodDefinition","paramnames":["start","end"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given location information added to the\\ncontext of every hap.</p>","params":[{"type":{"names":["Number"]},"description":"<p>start offset</p>","name":"start"},{"type":{"names":["Number"]},"description":"<p>end offset</p>","name":"end"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withLoc","longname":"Pattern#withLoc","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new Pattern, which only returns haps that meet the given test.\\n   * @param {Function} hap_test - a function which returns false for haps to be removed from the pattern\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17950,18047],"filename":"pattern.mjs","lineno":579,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026413","name":"Pattern#filterHaps","type":"MethodDefinition","paramnames":["hap_test"]},"vars":{"":null}},"description":"<p>Returns a new Pattern, which only returns haps that meet the given test.</p>","params":[{"type":{"names":["function"]},"description":"<p>a function which returns false for haps to be removed from the pattern</p>","name":"hap_test"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"filterHaps","longname":"Pattern#filterHaps","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`filterHaps\`, but the function is applied to values\\n   * inside haps.\\n   * @param {Function} value_test\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18223,18368],"filename":"pattern.mjs","lineno":590,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026432","name":"Pattern#filterValues","type":"MethodDefinition","paramnames":["value_test"]},"vars":{"":null}},"description":"<p>As with <code>filterHaps</code>, but the function is applied to values\\ninside haps.</p>","params":[{"type":{"names":["function"]},"name":"value_test"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"filterValues","longname":"Pattern#filterValues","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern, with haps containing undefined values removed from\\n   * query results.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18526,18607],"filename":"pattern.mjs","lineno":600,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026463","name":"Pattern#removeUndefineds","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with haps containing undefined values removed from\\nquery results.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"removeUndefineds","longname":"Pattern#removeUndefineds","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, with all haps without onsets filtered out. A hap\\n   * with an onset is one with a \`whole\` timespan that begins at the same time\\n   * as its \`part\` timespan.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18851,19116],"filename":"pattern.mjs","lineno":611,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026477","name":"Pattern#onsetsOnly","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with all haps without onsets filtered out. A hap\\nwith an onset is one with a <code>whole</code> timespan that begins at the same time\\nas its <code>part</code> timespan.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"onsetsOnly","longname":"Pattern#onsetsOnly","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, with 'continuous' haps (those without 'whole'\\n   * timespans) removed from query results.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[19293,19427],"filename":"pattern.mjs","lineno":624,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026492","name":"Pattern#discreteOnly","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with 'continuous' haps (those without 'whole'\\ntimespans) removed from query results.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"discreteOnly","longname":"Pattern#discreteOnly","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Combines adjacent haps with the same value and whole.  Only\\n   * intended for use in tests.\\n   * @noAutocomplete\\n   */","meta":{"range":[19561,21006],"filename":"pattern.mjs","lineno":634,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026506","name":"Pattern#defragmentHaps","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Combines adjacent haps with the same value and whole.  Only\\nintended for use in tests.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"defragmentHaps","longname":"Pattern#defragmentHaps","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Queries the pattern for the first cycle, returning Haps. Mainly of use when\\n   * debugging a pattern.\\n   * @param {Boolean} with_context - set to true, otherwise the context field\\n   * will be stripped from the resulting haps.\\n   * @returns [Hap]\\n   * @noAutocomplete\\n   */","meta":{"range":[21295,21493],"filename":"pattern.mjs","lineno":689,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026737","name":"Pattern#firstCycle","type":"MethodDefinition","paramnames":["with_context"]},"vars":{"":null}},"description":"<p>Queries the pattern for the first cycle, returning Haps. Mainly of use when\\ndebugging a pattern.</p>","params":[{"type":{"names":["Boolean"]},"description":"<p>set to true, otherwise the context field\\nwill be stripped from the resulting haps.</p>","name":"with_context","defaultvalue":false}],"returns":[{"description":"<p>[Hap]</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"firstCycle","longname":"Pattern#firstCycle","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Accessor for a list of values returned by querying the first cycle.\\n   * @noAutocomplete\\n   */","meta":{"range":[21603,21685],"filename":"pattern.mjs","lineno":701,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026774","name":"Pattern#firstCycleValues","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Accessor for a list of values returned by querying the first cycle.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"firstCycleValues","longname":"Pattern#firstCycleValues","kind":"member","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * More human-readable version of the \`firstCycleValues\` accessor.\\n   * @noAutocomplete\\n   */","meta":{"range":[21791,21954],"filename":"pattern.mjs","lineno":709,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026791","name":"Pattern#showFirstCycle","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>More human-readable version of the <code>firstCycleValues</code> accessor.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"showFirstCycle","longname":"Pattern#showFirstCycle","kind":"member","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, which returns haps sorted in temporal order. Mainly\\n   * of use when comparing two patterns for equality, in tests.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[22157,22430],"filename":"pattern.mjs","lineno":721,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100026829","name":"Pattern#sortHapsByPart","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, which returns haps sorted in temporal order. Mainly\\nof use when comparing two patterns for equality, in tests.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"sortHapsByPart","longname":"Pattern#sortHapsByPart","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Layers the result of the given function(s). Like \`superimpose\`, but without the original pattern:\\n   * @name layer\\n   * @memberof Pattern\\n   * @synonyms apply\\n   * @returns Pattern\\n   * @example\\n   * \\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n   *   .layer(x=>x.add(\\"0,2\\"))\\n   *   .scale('C minor').note()\\n   */","meta":{"filename":"pattern.mjs","lineno":779,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Layers the result of the given function(s). Like <code>superimpose</code>, but without the original pattern:</p>","name":"layer","memberof":"Pattern","synonyms_text":"apply","synonyms":["apply"],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n  .layer(x=>x.add(\\"0,2\\"))\\n  .scale('C minor').note()"],"scope":"static","longname":"Pattern.layer","kind":"member"},{"comment":"/**\\n   * Superimposes the result of the given function(s) on top of the original pattern:\\n   * @name superimpose\\n   * @memberof Pattern\\n   * @returns Pattern\\n   * @example\\n   * \\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n   *   .superimpose(x=>x.add(2))\\n   *   .scale('C minor').note()\\n   */","meta":{"filename":"pattern.mjs","lineno":794,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimposes the result of the given function(s) on top of the original pattern:</p>","name":"superimpose","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n  .superimpose(x=>x.add(2))\\n  .scale('C minor').note()"],"scope":"static","longname":"Pattern.superimpose","kind":"member"},{"comment":"/**\\n   * Writes the content of the current event to the console (visible in the side menu).\\n   * @name log\\n   * @memberof Pattern\\n   * @example\\n   * s(\\"bd sd\\").log()\\n   */","meta":{"filename":"pattern.mjs","lineno":854,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Writes the content of the current event to the console (visible in the side menu).</p>","name":"log","memberof":"Pattern","examples":["s(\\"bd sd\\").log()"],"scope":"static","longname":"Pattern.log","kind":"member"},{"comment":"/**\\n   * A simplified version of \`log\` which writes all \\"values\\" (various configurable parameters)\\n   * within the event to the console (visible in the side menu).\\n   * @name logValues\\n   * @memberof Pattern\\n   * @example\\n   * s(\\"bd sd\\").gain(\\"0.25 0.5 1\\").n(\\"2 1 0\\").logValues()\\n   */","meta":{"filename":"pattern.mjs","lineno":867,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A simplified version of <code>log</code> which writes all &quot;values&quot; (various configurable parameters)\\nwithin the event to the console (visible in the side menu).</p>","name":"logValues","memberof":"Pattern","examples":["s(\\"bd sd\\").gain(\\"0.25 0.5 1\\").n(\\"2 1 0\\").logValues()"],"scope":"static","longname":"Pattern.logValues","kind":"member"},{"comment":"/**\\n   * Breaks a pattern into pieces according to the structure of a given pattern.\\n   * True values in the given pattern cause the corresponding subcycle of the\\n   * source pattern to be looped, and for an (optional) given function to be\\n   * applied. False values result in the corresponding part of the source pattern\\n   * to be played unchanged.\\n   * @name into\\n   * @memberof Pattern\\n   * @example\\n   * sound(\\"bd sd ht lt\\").into(\\"1 0\\", hurry(2))\\n   */","meta":{"filename":"pattern.mjs","lineno":897,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Breaks a pattern into pieces according to the structure of a given pattern.\\nTrue values in the given pattern cause the corresponding subcycle of the\\nsource pattern to be looped, and for an (optional) given function to be\\napplied. False values result in the corresponding part of the source pattern\\nto be played unchanged.</p>","name":"into","memberof":"Pattern","examples":["sound(\\"bd sd ht lt\\").into(\\"1 0\\", hurry(2))"],"scope":"static","longname":"Pattern.into","kind":"member"},{"comment":"/**\\n * Selects indices in in stacked notes.\\n * @example\\n * note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n * .arpWith(haps => haps[2])\\n * */","meta":{"range":[28891,29121],"filename":"pattern.mjs","lineno":946,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100027543","name":"exports.arpWith","type":"VariableDeclaration"}},"description":"<p>Selects indices in in stacked notes.</p>","examples":["note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n.arpWith(haps => haps[2])"],"name":"arpWith","longname":"arpWith","kind":"constant","scope":"global"},{"comment":"/**\\n * Selects indices in in stacked notes.\\n * @example\\n * note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n * .arp(\\"0 [0,2] 1 [0,2]\\")\\n * */","meta":{"range":[29254,29397],"filename":"pattern.mjs","lineno":960,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100027597","name":"exports.arp","type":"VariableDeclaration"}},"description":"<p>Selects indices in in stacked notes.</p>","examples":["note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n.arp(\\"0 [0,2] 1 [0,2]\\")"],"name":"arp","longname":"arp","kind":"constant","scope":"global"},{"comment":"/**\\n     *\\n     * Assumes a pattern of numbers. Adds the given number to each item in the pattern.\\n     * @name add\\n     * @memberof Pattern\\n     * @example\\n     * // Here, the triad 0, 2, 4 is shifted by different amounts\\n     * n(\\"0 2 4\\".add(\\"<0 3 4 0>\\")).scale(\\"C:major\\")\\n     * // Without add, the equivalent would be:\\n     * // n(\\"<[0 2 4] [3 5 7] [4 6 8] [0 2 4]>\\").scale(\\"C:major\\")\\n     * @example\\n     * // You can also use add with notes:\\n     * note(\\"c3 e3 g3\\".add(\\"<0 5 7 0>\\"))\\n     * // Behind the scenes, the notes are converted to midi numbers:\\n     * // note(\\"48 52 55\\".add(\\"<0 5 7 0>\\"))\\n     */","meta":{"filename":"pattern.mjs","lineno":1023,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a pattern of numbers. Adds the given number to each item in the pattern.</p>","name":"add","memberof":"Pattern","examples":["// Here, the triad 0, 2, 4 is shifted by different amounts\\nn(\\"0 2 4\\".add(\\"<0 3 4 0>\\")).scale(\\"C:major\\")\\n// Without add, the equivalent would be:\\n// n(\\"<[0 2 4] [3 5 7] [4 6 8] [0 2 4]>\\").scale(\\"C:major\\")","// You can also use add with notes:\\nnote(\\"c3 e3 g3\\".add(\\"<0 5 7 0>\\"))\\n// Behind the scenes, the notes are converted to midi numbers:\\n// note(\\"48 52 55\\".add(\\"<0 5 7 0>\\"))"],"scope":"static","longname":"Pattern.add","kind":"member"},{"comment":"/**\\n     *\\n     * Like add, but the given numbers are subtracted.\\n     * @name sub\\n     * @memberof Pattern\\n     * @example\\n     * n(\\"0 2 4\\".sub(\\"<0 1 2 3>\\")).scale(\\"C4:minor\\")\\n     * // See add for more information.\\n     */","meta":{"filename":"pattern.mjs","lineno":1040,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like add, but the given numbers are subtracted.</p>","name":"sub","memberof":"Pattern","examples":["n(\\"0 2 4\\".sub(\\"<0 1 2 3>\\")).scale(\\"C4:minor\\")\\n// See add for more information."],"scope":"static","longname":"Pattern.sub","kind":"member"},{"comment":"/**\\n     *\\n     * Multiplies each number by the given factor.\\n     * @name mul\\n     * @memberof Pattern\\n     * @example\\n     * \\"<1 1.5 [1.66, <2 2.33>]>*4\\".mul(150).freq()\\n     */","meta":{"filename":"pattern.mjs","lineno":1050,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Multiplies each number by the given factor.</p>","name":"mul","memberof":"Pattern","examples":["\\"<1 1.5 [1.66, <2 2.33>]>*4\\".mul(150).freq()"],"scope":"static","longname":"Pattern.mul","kind":"member"},{"comment":"/**\\n     *\\n     * Divides each number by the given factor.\\n     * @name div\\n     * @memberof Pattern\\n     */","meta":{"filename":"pattern.mjs","lineno":1059,"columnno":4,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides each number by the given factor.</p>","name":"div","memberof":"Pattern","scope":"static","longname":"Pattern.div","kind":"member"},{"comment":"/**\\n   * Applies the given structure to the pattern:\\n   *\\n   * @example\\n   * note(\\"c,eb,g\\")\\n   *   .struct(\\"x ~ x ~ ~ x ~ x ~ ~ ~ x ~ x ~ ~\\")\\n   *   .slow(2)\\n   */","meta":{"range":[35283,35371],"filename":"pattern.mjs","lineno":1155,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028142","name":"Pattern.prototype.struct","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Applies the given structure to the pattern:</p>","examples":["note(\\"c,eb,g\\")\\n  .struct(\\"x ~ x ~ ~ x ~ x ~ ~ ~ x ~ x ~ ~\\")\\n  .slow(2)"],"name":"struct","longname":"Pattern#struct","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns silence when mask is 0 or \\"~\\"\\n   *\\n   * @example\\n   * note(\\"c [eb,g] d [eb,g]\\").mask(\\"<1 [0 1]>\\")\\n   */","meta":{"range":[35591,35676],"filename":"pattern.mjs","lineno":1167,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028182","name":"Pattern.prototype.mask","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Returns silence when mask is 0 or &quot;~&quot;</p>","examples":["note(\\"c [eb,g] d [eb,g]\\").mask(\\"<1 [0 1]>\\")"],"name":"mask","longname":"Pattern#mask","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Resets the pattern to the start of the cycle for each onset of the reset pattern.\\n   *\\n   * @example\\n   * s(\\"[<bd lt> sd]*2, hh*8\\").reset(\\"<x@3 x(5,8)>\\")\\n   */","meta":{"range":[35941,36030],"filename":"pattern.mjs","lineno":1179,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028222","name":"Pattern.prototype.reset","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Resets the pattern to the start of the cycle for each onset of the reset pattern.</p>","examples":["s(\\"[<bd lt> sd]*2, hh*8\\").reset(\\"<x@3 x(5,8)>\\")"],"name":"reset","longname":"Pattern#reset","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Restarts the pattern for each onset of the restart pattern.\\n   * While reset will only reset the current cycle, restart will start from cycle 0.\\n   *\\n   * @example\\n   * s(\\"[<bd lt> sd]*2, hh*8\\").restart(\\"<x@3 x(5,8)>\\")\\n   */","meta":{"range":[36364,36457],"filename":"pattern.mjs","lineno":1192,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028262","name":"Pattern.prototype.restart","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Restarts the pattern for each onset of the restart pattern.\\nWhile reset will only reset the current cycle, restart will start from cycle 0.</p>","examples":["s(\\"[<bd lt> sd]*2, hh*8\\").restart(\\"<x@3 x(5,8)>\\")"],"name":"restart","longname":"Pattern#restart","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Does absolutely nothing, but with a given metrical 'steps'\\n * @name gap\\n * @param  {number} steps\\n * @example\\n * gap(3) // \\"~@3\\"\\n */","meta":{"filename":"pattern.mjs","lineno":1226,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Does absolutely nothing, but with a given metrical 'steps'</p>","name":"gap","params":[{"type":{"names":["number"]},"name":"steps"}],"examples":["gap(3) // \\"~@3\\""],"longname":"gap","kind":"member","scope":"global"},{"comment":"/**\\n * Does absolutely nothing..\\n * @name silence\\n * @example\\n * silence // \\"~\\"\\n */","meta":{"filename":"pattern.mjs","lineno":1235,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Does absolutely nothing..</p>","name":"silence","examples":["silence // \\"~\\""],"longname":"silence","kind":"member","scope":"global"},{"comment":"/**\\n * A discrete value that repeats once per cycle.\\n *\\n * @returns {Pattern}\\n * @example\\n * pure('e4') // \\"e4\\"\\n * @noAutocomplete\\n */","meta":{"range":[37708,37965],"filename":"pattern.mjs","lineno":1254,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028341","name":"exports.pure","type":"FunctionDeclaration","paramnames":["value"]}},"description":"<p>A discrete value that repeats once per cycle.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["pure('e4') // \\"e4\\""],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"pure","longname":"pure","kind":"function","scope":"global"},{"comment":"/** Takes a list of patterns, and returns a pattern of lists.\\n */","meta":{"range":[38970,39150],"filename":"pattern.mjs","lineno":1292,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028431","name":"exports.sequenceP","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Takes a list of patterns, and returns a pattern of lists.</p>","name":"sequenceP","longname":"sequenceP","kind":"function","scope":"global"},{"comment":"/**\\n * The given items are played at the same time at the same length.\\n *\\n * @return {Pattern}\\n * @synonyms polyrhythm, pr\\n * @example\\n * stack(\\"g3\\", \\"b3\\", [\\"e4\\", \\"d4\\"]).note()\\n * // \\"g3,b3,[e4 d4]\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").stack(\\n *   note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[39452,39830],"filename":"pattern.mjs","lineno":1315,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028471","name":"exports.stack","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>The given items are played at the same time at the same length.</p>","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"polyrhythm, pr","synonyms":["polyrhythm","pr"],"examples":["stack(\\"g3\\", \\"b3\\", [\\"e4\\", \\"d4\\"]).note()\\n// \\"g3,b3,[e4 d4]\\".note()","// As a chained function:\\ns(\\"hh*4\\").stack(\\n  note(\\"c4(5,8)\\")\\n)"],"name":"stack","longname":"stack","kind":"function","scope":"global"},{"comment":"/**\\n * Concatenation: combines a list of patterns, switching between them successively, one per cycle.\\n *\\n * @return {Pattern}\\n * @synonyms cat\\n * @example\\n * slowcat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"])\\n *\\n */","meta":{"range":[41498,42548],"filename":"pattern.mjs","lineno":1393,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028835","name":"exports.slowcat","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Concatenation: combines a list of patterns, switching between them successively, one per cycle.</p>","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"cat","synonyms":["cat"],"examples":["slowcat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"])"],"name":"slowcat","longname":"slowcat","kind":"function","scope":"global"},{"comment":"/** Concatenation: combines a list of patterns, switching between them successively, one per cycle. Unlike slowcat, this version will skip cycles.\\n * @param {...any} items - The items to concatenate\\n * @return {Pattern}\\n */","meta":{"range":[42774,43147],"filename":"pattern.mjs","lineno":1423,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100028995","name":"exports.slowcatPrime","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Concatenation: combines a list of patterns, switching between them successively, one per cycle. Unlike slowcat, this version will skip cycles.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>The items to concatenate</p>","name":"items"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"slowcatPrime","longname":"slowcatPrime","kind":"function","scope":"global"},{"comment":"/** The given items are con**cat**enated, where each one takes one cycle.\\n *\\n * @param {...any} items - The items to concatenate\\n * @synonyms slowcat\\n * @return {Pattern}\\n * @example\\n * cat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n * // \\"<e5 b4 [d5 c5]>\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").cat(\\n *    note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[43496,43555],"filename":"pattern.mjs","lineno":1448,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029048","name":"exports.cat","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>The given items are con<strong>cat</strong>enated, where each one takes one cycle.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>The items to concatenate</p>","name":"items"}],"synonyms_text":"slowcat","synonyms":["slowcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["cat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n// \\"<e5 b4 [d5 c5]>\\".note()","// As a chained function:\\ns(\\"hh*4\\").cat(\\n   note(\\"c4(5,8)\\")\\n)"],"name":"cat","longname":"cat","kind":"function","scope":"global"},{"comment":"/**\\n * Allows to arrange multiple patterns together over multiple cycles.\\n * Takes a variable number of arrays with two elements specifying the number of cycles and the pattern to use.\\n *\\n * @return {Pattern}\\n * @example\\n * arrange(\\n *   [4, \\"<c a f e>(3,8)\\"],\\n *   [2, \\"<g a>(5,8)\\"]\\n * ).note()\\n */","meta":{"range":[43857,44091],"filename":"pattern.mjs","lineno":1463,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029059","name":"exports.arrange","type":"FunctionDeclaration","paramnames":["sections"]}},"description":"<p>Allows to arrange multiple patterns together over multiple cycles.\\nTakes a variable number of arrays with two elements specifying the number of cycles and the pattern to use.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["arrange(\\n  [4, \\"<c a f e>(3,8)\\"],\\n  [2, \\"<g a>(5,8)\\"]\\n).note()"],"name":"arrange","longname":"arrange","kind":"function","scope":"global"},{"comment":"/**\\n * Similarly to \`arrange\`, allows you to arrange multiple patterns together over multiple cycles.\\n * Unlike \`arrange\`, you specify a start and stop time for each pattern rather than duration, which\\n * means that patterns can overlap.\\n * @return {Pattern}\\n * @example\\nseqPLoop([0, 2, \\"bd(3,8)\\"],\\n         [1, 3, \\"cp(3,8)\\"]\\n        )\\n  .sound()\\n */","meta":{"range":[44444,44868],"filename":"pattern.mjs","lineno":1480,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029104","name":"exports.seqPLoop","type":"FunctionDeclaration","paramnames":["parts"]}},"description":"<p>Similarly to <code>arrange</code>, allows you to arrange multiple patterns together over multiple cycles.\\nUnlike <code>arrange</code>, you specify a start and stop time for each pattern rather than duration, which\\nmeans that patterns can overlap.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["seqPLoop([0, 2, \\"bd(3,8)\\"],\\n         [1, 3, \\"cp(3,8)\\"]\\n        )\\n  .sound()"],"name":"seqPLoop","longname":"seqPLoop","kind":"function","scope":"global"},{"comment":"/** See \`fastcat\` */","meta":{"range":[45171,45235],"filename":"pattern.mjs","lineno":1512,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029247","name":"exports.sequence","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>See <code>fastcat</code></p>","name":"sequence","longname":"sequence","kind":"function","scope":"global"},{"comment":"/** Like **cat**, but the items are crammed into one cycle.\\n * @synonyms sequence, fastcat\\n * @example\\n * seq(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n * // \\"e5 b4 [d5 c5]\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").seq(\\n *   note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[45502,45561],"filename":"pattern.mjs","lineno":1529,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029258","name":"exports.seq","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Like <strong>cat</strong>, but the items are crammed into one cycle.</p>","synonyms_text":"sequence, fastcat","synonyms":["sequence","fastcat"],"examples":["seq(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n// \\"e5 b4 [d5 c5]\\".note()","// As a chained function:\\ns(\\"hh*4\\").seq(\\n  note(\\"c4(5,8)\\")\\n)"],"name":"seq","longname":"seq","kind":"function","scope":"global"},{"comment":"/**\\n * Registers a new pattern method. The method is added to the Pattern class + the standalone function is returned from register.\\n *\\n * @param {string | string[]} name name of the function, or an array of names to be used as synonyms\\n * @param {function} func function with 1 or more params, where last is the current pattern\\n * @noAutocomplete\\n *\\n */","meta":{"range":[48191,50867],"filename":"pattern.mjs","lineno":1593,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100029890","name":"exports.register","type":"FunctionDeclaration","paramnames":["name","func","patternify","preserveSteps","join"]}},"description":"<p>Registers a new pattern method. The method is added to the Pattern class + the standalone function is returned from register.</p>","params":[{"type":{"names":["string","Array.<string>"]},"description":"<p>name of the function, or an array of names to be used as synonyms</p>","name":"name"},{"type":{"names":["function"]},"description":"<p>function with 1 or more params, where last is the current pattern</p>","name":"func"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"register","longname":"register","kind":"function","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values rounded\\n * to the nearest integer.\\n * @name round\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * n(\\"0.5 1.5 2.5\\".round()).scale(\\"C:major\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1686,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values rounded\\nto the nearest integer.</p>","name":"round","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0.5 1.5 2.5\\".round()).scale(\\"C:major\\")"],"scope":"static","longname":"Pattern.round","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values set to\\n * their mathematical floor. E.g. \`3.7\` replaced with to \`3\`, and \`-4.2\`\\n * replaced with \`-5\`.\\n * @name floor\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"42 42.1 42.5 43\\".floor())\\n */","meta":{"filename":"pattern.mjs","lineno":1699,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values set to\\ntheir mathematical floor. E.g. <code>3.7</code> replaced with to <code>3</code>, and <code>-4.2</code>\\nreplaced with <code>-5</code>.</p>","name":"floor","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"42 42.1 42.5 43\\".floor())"],"scope":"static","longname":"Pattern.floor","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values set to\\n * their mathematical ceiling. E.g. \`3.2\` replaced with \`4\`, and \`-4.2\`\\n * replaced with \`-4\`.\\n * @name ceil\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"42 42.1 42.5 43\\".ceil())\\n */","meta":{"filename":"pattern.mjs","lineno":1713,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values set to\\ntheir mathematical ceiling. E.g. <code>3.2</code> replaced with <code>4</code>, and <code>-4.2</code>\\nreplaced with <code>-4</code>.</p>","name":"ceil","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"42 42.1 42.5 43\\".ceil())"],"scope":"static","longname":"Pattern.ceil","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 ..\\n * 1. Returns a new pattern with values scaled to the bipolar range -1 .. 1\\n * @returns Pattern\\n * @noAutocomplete\\n */","meta":{"range":[52512,52616],"filename":"pattern.mjs","lineno":1732,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030406","name":"exports.toBipolar","type":"VariableDeclaration"}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 ..</p>\\n<ol>\\n<li>Returns a new pattern with values scaled to the bipolar range -1 .. 1</li>\\n</ol>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"toBipolar","longname":"toBipolar","kind":"constant","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\n * Returns a new pattern with values scaled to the unipolar range 0 .. 1\\n * @returns Pattern\\n * @noAutocomplete\\n */","meta":{"range":[52817,52927],"filename":"pattern.mjs","lineno":1742,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030428","name":"exports.fromBipolar","type":"VariableDeclaration"}},"description":"<p>Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\nReturns a new pattern with values scaled to the unipolar range 0 .. 1</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"fromBipolar","longname":"fromBipolar","kind":"constant","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 .. 1.\\n * Returns a new pattern with values scaled to the given min/max range.\\n * Most useful in combination with continuous patterns.\\n * @name range\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine.range(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1746,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 .. 1.\\nReturns a new pattern with values scaled to the given min/max range.\\nMost useful in combination with continuous patterns.</p>","name":"range","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine.range(500,4000))"],"scope":"static","longname":"Pattern.range","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 .. 1\\n * Returns a new pattern with values scaled to the given min/max range,\\n * following an exponential curve.\\n * @name rangex\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine.rangex(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1761,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 .. 1\\nReturns a new pattern with values scaled to the given min/max range,\\nfollowing an exponential curve.</p>","name":"rangex","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine.rangex(500,4000))"],"scope":"static","longname":"Pattern.rangex","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\n * Returns a new pattern with values scaled to the given min/max range.\\n * @name range2\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine2.range2(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1776,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\nReturns a new pattern with values scaled to the given min/max range.</p>","name":"range2","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine2.range2(500,4000))"],"scope":"static","longname":"Pattern.range2","kind":"member"},{"comment":"/**\\n * Allows dividing numbers via list notation using \\":\\".\\n * Returns a new pattern with just numbers.\\n * @name ratio\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * ratio(\\"1, 5:4, 3:2\\").mul(110)\\n * .freq().s(\\"piano\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1790,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Allows dividing numbers via list notation using &quot;:&quot;.\\nReturns a new pattern with just numbers.</p>","name":"ratio","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["ratio(\\"1, 5:4, 3:2\\").mul(110)\\n.freq().s(\\"piano\\")"],"scope":"static","longname":"Pattern.ratio","kind":"member"},{"comment":"/** Compress each cycle into the given timespan, leaving a gap\\n * @example\\n * cat(\\n *   s(\\"bd sd\\").compress(.25,.75),\\n *   s(\\"~ bd sd ~\\")\\n * )\\n */","meta":{"range":[54920,55173],"filename":"pattern.mjs","lineno":1819,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030573","name":"exports.compress","type":"VariableDeclaration"}},"description":"<p>Compress each cycle into the given timespan, leaving a gap</p>","examples":["cat(\\n  s(\\"bd sd\\").compress(.25,.75),\\n  s(\\"~ bd sd ~\\")\\n)"],"name":"compress","longname":"compress","kind":"constant","scope":"global"},{"comment":"/**\\n * speeds up a pattern like fast, but rather than it playing multiple times as fast would it instead leaves a gap in the remaining space of the cycle. For example, the following will play the sound pattern \\"bd sn\\" only once but compressed into the first half of the cycle, i.e. twice as fast.\\n * @name fastGap\\n * @synonyms fastgap\\n * @example\\n * s(\\"bd sd\\").fastGap(2)\\n */","meta":{"filename":"pattern.mjs","lineno":1832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>speeds up a pattern like fast, but rather than it playing multiple times as fast would it instead leaves a gap in the remaining space of the cycle. For example, the following will play the sound pattern &quot;bd sn&quot; only once but compressed into the first half of the cycle, i.e. twice as fast.</p>","name":"fastGap","synonyms_text":"fastgap","synonyms":["fastgap"],"examples":["s(\\"bd sd\\").fastGap(2)"],"longname":"fastGap","kind":"member","scope":"global"},{"comment":"/**\\n * Similar to \`compress\`, but doesn't leave gaps, and the 'focus' can be bigger than a cycle\\n * @example\\n * s(\\"bd hh sd hh\\").focus(1/4, 3/4)\\n */","meta":{"range":[57064,57254],"filename":"pattern.mjs","lineno":1874,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030915","name":"exports.focus","type":"VariableDeclaration"}},"description":"<p>Similar to <code>compress</code>, but doesn't leave gaps, and the 'focus' can be bigger than a cycle</p>","examples":["s(\\"bd hh sd hh\\").focus(1/4, 3/4)"],"name":"focus","longname":"focus","kind":"constant","scope":"global"},{"comment":"/** The ply function repeats each event the given number of times.\\n * @example\\n * s(\\"bd ~ sd cp\\").ply(\\"<1 2 3>\\")\\n */","meta":{"range":[57521,57752],"filename":"pattern.mjs","lineno":1891,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100030994","name":"exports.ply","type":"VariableDeclaration"}},"description":"<p>The ply function repeats each event the given number of times.</p>","examples":["s(\\"bd ~ sd cp\\").ply(\\"<1 2 3>\\")"],"name":"ply","longname":"ply","kind":"constant","scope":"global"},{"comment":"/**\\n * Speed up a pattern by the given factor. Used by \\"*\\" in mini notation.\\n *\\n * @name fast\\n * @synonyms density\\n * @memberof Pattern\\n * @param {number | Pattern} factor speed up factor\\n * @returns Pattern\\n * @example\\n * s(\\"bd hh sd hh\\").fast(2) // s(\\"[bd hh sd hh]*2\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1899,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Speed up a pattern by the given factor. Used by &quot;*&quot; in mini notation.</p>","name":"fast","synonyms_text":"density","synonyms":["density"],"memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>speed up factor</p>","name":"factor"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd hh sd hh\\").fast(2) // s(\\"[bd hh sd hh]*2\\")"],"scope":"static","longname":"Pattern.fast","kind":"member"},{"comment":"/**\\n * Both speeds up the pattern (like 'fast') and the sample playback (like 'speed').\\n * @example\\n * s(\\"bd sd:2\\").hurry(\\"<1 2 4 3>\\").slow(1.5)\\n */","meta":{"range":[58520,58629],"filename":"pattern.mjs","lineno":1929,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031107","name":"exports.hurry","type":"VariableDeclaration"}},"description":"<p>Both speeds up the pattern (like 'fast') and the sample playback (like 'speed').</p>","examples":["s(\\"bd sd:2\\").hurry(\\"<1 2 4 3>\\").slow(1.5)"],"name":"hurry","longname":"hurry","kind":"constant","scope":"global"},{"comment":"/**\\n * Slow down a pattern over the given number of cycles. Like the \\"/\\" operator in mini notation.\\n *\\n * @name slow\\n * @synonyms sparsity\\n * @memberof Pattern\\n * @param {number | Pattern} factor slow down factor\\n * @returns Pattern\\n * @example\\n * s(\\"bd hh sd hh\\").slow(2) // s(\\"[bd hh sd hh]/2\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1933,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slow down a pattern over the given number of cycles. Like the &quot;/&quot; operator in mini notation.</p>","name":"slow","synonyms_text":"sparsity","synonyms":["sparsity"],"memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>slow down factor</p>","name":"factor"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd hh sd hh\\").slow(2) // s(\\"[bd hh sd hh]/2\\")"],"scope":"static","longname":"Pattern.slow","kind":"member"},{"comment":"/**\\n * Carries out an operation 'inside' a cycle.\\n * @example\\n * \\"0 1 2 3 4 3 2 1\\".inside(4, rev).scale('C major').note()\\n * // \\"0 1 2 3 4 3 2 1\\".slow(4).rev().fast(4).scale('C major').note()\\n */","meta":{"range":[59314,59431],"filename":"pattern.mjs","lineno":1957,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031168","name":"exports.inside","type":"VariableDeclaration"}},"description":"<p>Carries out an operation 'inside' a cycle.</p>","examples":["\\"0 1 2 3 4 3 2 1\\".inside(4, rev).scale('C major').note()\\n// \\"0 1 2 3 4 3 2 1\\".slow(4).rev().fast(4).scale('C major').note()"],"name":"inside","longname":"inside","kind":"constant","scope":"global"},{"comment":"/**\\n * Carries out an operation 'outside' a cycle.\\n * @example\\n * \\"<[0 1] 2 [3 4] 5>\\".outside(4, rev).scale('C major').note()\\n * // \\"<[0 1] 2 [3 4] 5>\\".fast(4).rev().slow(4).scale('C major').note()\\n */","meta":{"range":[59635,59754],"filename":"pattern.mjs","lineno":1967,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031192","name":"exports.outside","type":"VariableDeclaration"}},"description":"<p>Carries out an operation 'outside' a cycle.</p>","examples":["\\"<[0 1] 2 [3 4] 5>\\".outside(4, rev).scale('C major').note()\\n// \\"<[0 1] 2 [3 4] 5>\\".fast(4).rev().slow(4).scale('C major').note()"],"name":"outside","longname":"outside","kind":"constant","scope":"global"},{"comment":"/**\\n * Applies the given function every n cycles, starting from the last cycle.\\n * @name lastOf\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").lastOf(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1971,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function every n cycles, starting from the last cycle.</p>","name":"lastOf","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").lastOf(4, x=>x.rev())"],"scope":"static","longname":"Pattern.lastOf","kind":"member"},{"comment":"/**\\n * Applies the given function every n cycles, starting from the first cycle.\\n * @name firstOf\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").firstOf(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1987,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function every n cycles, starting from the first cycle.</p>","name":"firstOf","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").firstOf(4, x=>x.rev())"],"scope":"static","longname":"Pattern.firstOf","kind":"member"},{"comment":"/**\\n * An alias for \`firstOf\`\\n * @name every\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").every(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1998,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>An alias for <code>firstOf</code></p>","name":"every","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").every(4, x=>x.rev())"],"scope":"static","longname":"Pattern.every","kind":"member"},{"comment":"/**\\n * Like layer, but with a single function:\\n * @name apply\\n * @memberof Pattern\\n * @example\\n * \\"<c3 eb3 g3>\\".scale('C minor').apply(scaleTranspose(\\"0,2,4\\")).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2014,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like layer, but with a single function:</p>","name":"apply","memberof":"Pattern","examples":["\\"<c3 eb3 g3>\\".scale('C minor').apply(scaleTranspose(\\"0,2,4\\")).note()"],"scope":"static","longname":"Pattern.apply","kind":"member"},{"comment":"/**\\n * Plays the pattern at the given cycles per minute.\\n * @deprecated\\n * @example\\n * s(\\"<bd sd>,hh*2\\").cpm(90) // = 90 bpm\\n */","meta":{"range":[61398,61492],"filename":"pattern.mjs","lineno":2033,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031311","name":"exports.cpm","type":"VariableDeclaration"}},"description":"<p>Plays the pattern at the given cycles per minute.</p>","deprecated":true,"examples":["s(\\"<bd sd>,hh*2\\").cpm(90) // = 90 bpm"],"name":"cpm","longname":"cpm","kind":"constant","scope":"global"},{"comment":"/**\\n * Nudge a pattern to start earlier in time. Equivalent of Tidal's <~ operator\\n *\\n * @name early\\n * @memberof Pattern\\n * @param {number | Pattern} cycles number of cycles to nudge left\\n * @returns Pattern\\n * @example\\n * \\"bd ~\\".stack(\\"hh ~\\".early(.1)).s()\\n */","meta":{"filename":"pattern.mjs","lineno":2037,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Nudge a pattern to start earlier in time. Equivalent of Tidal's &lt;~ operator</p>","name":"early","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>number of cycles to nudge left</p>","name":"cycles"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"bd ~\\".stack(\\"hh ~\\".early(.1)).s()"],"scope":"static","longname":"Pattern.early","kind":"member"},{"comment":"/**\\n * Nudge a pattern to start later in time. Equivalent of Tidal's ~> operator\\n *\\n * @name late\\n * @memberof Pattern\\n * @param {number | Pattern} cycles number of cycles to nudge right\\n * @returns Pattern\\n * @example\\n * \\"bd ~\\".stack(\\"hh ~\\".late(.1)).s()\\n */","meta":{"filename":"pattern.mjs","lineno":2057,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Nudge a pattern to start later in time. Equivalent of Tidal's ~&gt; operator</p>","name":"late","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>number of cycles to nudge right</p>","name":"cycles"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"bd ~\\".stack(\\"hh ~\\".late(.1)).s()"],"scope":"static","longname":"Pattern.late","kind":"member"},{"comment":"/**\\n * Plays a portion of a pattern, specified by the beginning and end of a time span. The new resulting pattern is played over the time period of the original pattern:\\n *\\n * @example\\n * s(\\"bd*2 hh*3 [sd bd]*2 perc\\").zoom(0.25, 0.75)\\n * // s(\\"hh*3 [sd bd]*2\\") // equivalent\\n */","meta":{"range":[62678,63097],"filename":"pattern.mjs","lineno":2084,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031404","name":"exports.zoom","type":"VariableDeclaration"}},"description":"<p>Plays a portion of a pattern, specified by the beginning and end of a time span. The new resulting pattern is played over the time period of the original pattern:</p>","examples":["s(\\"bd*2 hh*3 [sd bd]*2 perc\\").zoom(0.25, 0.75)\\n// s(\\"hh*3 [sd bd]*2\\") // equivalent"],"name":"zoom","longname":"zoom","kind":"constant","scope":"global"},{"comment":"/**\\n * Splits a pattern into the given number of slices, and plays them according to a pattern of slice numbers.\\n * Similar to \`slice\`, but slices up patterns rather than sound samples.\\n * @param {number} number of slices\\n * @param {number} slices to play\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale('c:mixolydian'))\\n *.bite(4, \\"3 2 1 0\\")\\n * @example\\n * sound(\\"bd - bd bd*2, - sd:6 - sd:5 sd:1 - [- sd:2] -, hh [- cp:7]\\")\\n  .bank(\\"RolandTR909\\").speed(1.2)\\n  .bite(4, \\"0 0 [1 2] <3 2> 0 0 [2 1] 3\\")\\n */","meta":{"range":[63730,64028],"filename":"pattern.mjs","lineno":2116,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031529","name":"exports.bite","type":"VariableDeclaration"}},"description":"<p>Splits a pattern into the given number of slices, and plays them according to a pattern of slice numbers.\\nSimilar to <code>slice</code>, but slices up patterns rather than sound samples.</p>","params":[{"type":{"names":["number"]},"description":"<p>of slices</p>","name":"number"},{"type":{"names":["number"]},"description":"<p>to play</p>","name":"slices"}],"examples":["note(\\"0 1 2 3 4 5 6 7\\".scale('c:mixolydian'))\\n.bite(4, \\"3 2 1 0\\")","sound(\\"bd - bd bd*2, - sd:6 - sd:5 sd:1 - [- sd:2] -, hh [- cp:7]\\")\\n  .bank(\\"RolandTR909\\").speed(1.2)\\n  .bite(4, \\"0 0 [1 2] <3 2> 0 0 [2 1] 3\\")"],"name":"bite","longname":"bite","kind":"constant","scope":"global"},{"comment":"/**\\n * Selects the given fraction of the pattern and repeats that part to fill the remainder of the cycle.\\n * @param {number} fraction fraction to select\\n * @example\\n * s(\\"lt ht mt cp, [hh oh]*2\\").linger(\\"<1 .5 .25 .125>\\")\\n */","meta":{"range":[64257,64499],"filename":"pattern.mjs","lineno":2137,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031594","name":"exports.linger","type":"VariableDeclaration"}},"description":"<p>Selects the given fraction of the pattern and repeats that part to fill the remainder of the cycle.</p>","params":[{"type":{"names":["number"]},"description":"<p>fraction to select</p>","name":"fraction"}],"examples":["s(\\"lt ht mt cp, [hh oh]*2\\").linger(\\"<1 .5 .25 .125>\\")"],"name":"linger","longname":"linger","kind":"constant","scope":"global"},{"comment":"/**\\n * Samples the pattern at a rate of n events per cycle. Useful for turning a continuous pattern into a discrete one.\\n * @name segment\\n * @synonyms seg\\n * @param {number} segments number of segments per cycle\\n * @example\\n * note(saw.range(40,52).segment(24))\\n */","meta":{"filename":"pattern.mjs","lineno":2151,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Samples the pattern at a rate of n events per cycle. Useful for turning a continuous pattern into a discrete one.</p>","name":"segment","synonyms_text":"seg","synonyms":["seg"],"params":[{"type":{"names":["number"]},"description":"<p>number of segments per cycle</p>","name":"segments"}],"examples":["note(saw.range(40,52).segment(24))"],"longname":"segment","kind":"member","scope":"global"},{"comment":"/**\\n * The function \`swingBy x n\` breaks each cycle into \`n\` slices, and then delays events in the second half of each slice by the amount \`x\`, which is relative to the size of the (half) slice. So if \`x\` is 0 it does nothing, \`0.5\` delays for half the note duration, and 1 will wrap around to doing nothing again. The end result is a shuffle or swing-like rhythm\\n * @param {number} subdivision\\n * @param {number} offset\\n * @example\\n * s(\\"hh*8\\").swingBy(1/3, 4)\\n */","meta":{"range":[65382,65484],"filename":"pattern.mjs","lineno":2170,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031678","name":"exports.swingBy","type":"VariableDeclaration"}},"description":"<p>The function <code>swingBy x n</code> breaks each cycle into <code>n</code> slices, and then delays events in the second half of each slice by the amount <code>x</code>, which is relative to the size of the (half) slice. So if <code>x</code> is 0 it does nothing, <code>0.5</code> delays for half the note duration, and 1 will wrap around to doing nothing again. The end result is a shuffle or swing-like rhythm</p>","params":[{"type":{"names":["number"]},"name":"subdivision"},{"type":{"names":["number"]},"name":"offset"}],"examples":["s(\\"hh*8\\").swingBy(1/3, 4)"],"name":"swingBy","longname":"swingBy","kind":"constant","scope":"global"},{"comment":"/**\\n * Shorthand for swingBy with 1/3:\\n * @param {number} subdivision\\n * @example\\n * s(\\"hh*8\\").swing(4)\\n * // s(\\"hh*8\\").swingBy(1/3, 4)\\n */","meta":{"range":[65626,65700],"filename":"pattern.mjs","lineno":2179,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031702","name":"exports.swing","type":"VariableDeclaration"}},"description":"<p>Shorthand for swingBy with 1/3:</p>","params":[{"type":{"names":["number"]},"name":"subdivision"}],"examples":["s(\\"hh*8\\").swing(4)\\n// s(\\"hh*8\\").swingBy(1/3, 4)"],"name":"swing","longname":"swing","kind":"constant","scope":"global"},{"comment":"/**\\n * Swaps 1s and 0s in a binary pattern.\\n * @name invert\\n * @synonyms inv\\n * @example\\n * s(\\"bd\\").struct(\\"1 0 0 1 0 0 1 0\\".lastOf(4, invert))\\n */","meta":{"filename":"pattern.mjs","lineno":2181,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Swaps 1s and 0s in a binary pattern.</p>","name":"invert","synonyms_text":"inv","synonyms":["inv"],"examples":["s(\\"bd\\").struct(\\"1 0 0 1 0 0 1 0\\".lastOf(4, invert))"],"longname":"invert","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the given function whenever the given pattern is in a true state.\\n * @name when\\n * @memberof Pattern\\n * @param {Pattern} binary_pat\\n * @param {function} func\\n * @returns Pattern\\n * @example\\n * \\"c3 eb3 g3\\".when(\\"<0 1>/2\\", x=>x.sub(\\"5\\")).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2198,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function whenever the given pattern is in a true state.</p>","name":"when","memberof":"Pattern","params":[{"type":{"names":["Pattern"]},"name":"binary_pat"},{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"c3 eb3 g3\\".when(\\"<0 1>/2\\", x=>x.sub(\\"5\\")).note()"],"scope":"static","longname":"Pattern.when","kind":"member"},{"comment":"/**\\n * Superimposes the function result on top of the original pattern, delayed by the given time.\\n * @name off\\n * @memberof Pattern\\n * @param {Pattern | number} time offset time\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * \\"c3 eb3 g3\\".off(1/8, x=>x.add(7)).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2212,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimposes the function result on top of the original pattern, delayed by the given time.</p>","name":"off","memberof":"Pattern","params":[{"type":{"names":["Pattern","number"]},"description":"<p>offset time</p>","name":"time"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"c3 eb3 g3\\".off(1/8, x=>x.add(7)).note()"],"scope":"static","longname":"Pattern.off","kind":"member"},{"comment":"/**\\n * Returns a new pattern where every other cycle is played once, twice as\\n * fast, and offset in time by one quarter of a cycle. Creates a kind of\\n * breakbeat feel.\\n * @returns Pattern\\n */","meta":{"range":[67010,67148],"filename":"pattern.mjs","lineno":2232,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031789","name":"exports.brak","type":"VariableDeclaration"}},"description":"<p>Returns a new pattern where every other cycle is played once, twice as\\nfast, and offset in time by one quarter of a cycle. Creates a kind of\\nbreakbeat feel.</p>","returns":[{"description":"<p>Pattern</p>"}],"name":"brak","longname":"brak","kind":"constant","scope":"global"},{"comment":"/**\\n * Reverse all haps in a pattern\\n *\\n * @name rev\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"c d e g\\").rev()\\n */","meta":{"filename":"pattern.mjs","lineno":2236,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Reverse all haps in a pattern</p>","name":"rev","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c d e g\\").rev()"],"scope":"static","longname":"Pattern.rev","kind":"member"},{"comment":"/** Like press, but allows you to specify the amount by which each\\n * event is shifted. pressBy(0.5) is the same as press, while\\n * pressBy(1/3) shifts each event by a third of its timespan.\\n * @example\\n * stack(s(\\"hh*4\\"),\\n *       s(\\"bd mt sd ht\\").pressBy(\\"<0 0.5 0.25>\\")\\n *      ).slow(2)\\n */","meta":{"range":[68356,68486],"filename":"pattern.mjs","lineno":2277,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031939","name":"exports.pressBy","type":"VariableDeclaration"}},"description":"<p>Like press, but allows you to specify the amount by which each\\nevent is shifted. pressBy(0.5) is the same as press, while\\npressBy(1/3) shifts each event by a third of its timespan.</p>","examples":["stack(s(\\"hh*4\\"),\\n      s(\\"bd mt sd ht\\").pressBy(\\"<0 0.5 0.25>\\")\\n     ).slow(2)"],"name":"pressBy","longname":"pressBy","kind":"constant","scope":"global"},{"comment":"/**\\n * Syncopates a rhythm, by shifting each event halfway into its timespan.\\n * @example\\n * stack(s(\\"hh*4\\"),\\n *       s(\\"bd mt sd ht\\").every(4, press)\\n *      ).slow(2)\\n */","meta":{"range":[68662,68749],"filename":"pattern.mjs","lineno":2288,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031968","name":"exports.press","type":"VariableDeclaration"}},"description":"<p>Syncopates a rhythm, by shifting each event halfway into its timespan.</p>","examples":["stack(s(\\"hh*4\\"),\\n      s(\\"bd mt sd ht\\").every(4, press)\\n     ).slow(2)"],"name":"press","longname":"press","kind":"constant","scope":"global"},{"comment":"/**\\n * Silences a pattern.\\n * @example\\n * stack(\\n *   s(\\"bd\\").hush(),\\n *   s(\\"hh*3\\")\\n * )\\n */","meta":{"range":[68845,68903],"filename":"pattern.mjs","lineno":2300,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031985","name":"Pattern.prototype.hush","type":"FunctionExpression","paramnames":[]}},"description":"<p>Silences a pattern.</p>","examples":["stack(\\n  s(\\"bd\\").hush(),\\n  s(\\"hh*3\\")\\n)"],"name":"hush","longname":"Pattern#hush","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Applies \`rev\` to a pattern every other cycle, so that the pattern alternates between forwards and backwards.\\n * @example\\n * note(\\"c d e g\\").palindrome()\\n */","meta":{"range":[69070,69195],"filename":"pattern.mjs","lineno":2309,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100031995","name":"exports.palindrome","type":"VariableDeclaration"}},"description":"<p>Applies <code>rev</code> to a pattern every other cycle, so that the pattern alternates between forwards and backwards.</p>","examples":["note(\\"c d e g\\").palindrome()"],"name":"palindrome","longname":"palindrome","kind":"constant","scope":"global"},{"comment":"/**\\n * Jux with adjustable stereo width. 0 = mono, 1 = full stereo.\\n * @name juxBy\\n * @synonyms juxby\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").juxBy(\\"<0 .5 1>/2\\", rev)\\n */","meta":{"filename":"pattern.mjs","lineno":2318,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Jux with adjustable stereo width. 0 = mono, 1 = full stereo.</p>","name":"juxBy","synonyms_text":"juxby","synonyms":["juxby"],"examples":["s(\\"bd lt [~ ht] mt cp ~ bd hh\\").juxBy(\\"<0 .5 1>/2\\", rev)"],"longname":"juxBy","kind":"member","scope":"global"},{"comment":"/**\\n * The jux function creates strange stereo effects, by applying a function to a pattern, but only in the right-hand channel.\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(rev)\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(press)\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(iter(4))\\n */","meta":{"range":[70214,70310],"filename":"pattern.mjs","lineno":2348,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100032124","name":"exports.jux","type":"VariableDeclaration"}},"description":"<p>The jux function creates strange stereo effects, by applying a function to a pattern, but only in the right-hand channel.</p>","examples":["s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(rev)","s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(press)","s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(iter(4))"],"name":"jux","longname":"jux","kind":"constant","scope":"global"},{"comment":"/**\\n * Superimpose and offset multiple times, applying the given function each time.\\n * @name echoWith\\n * @synonyms echowith, stutWith, stutwith\\n * @param {number} times how many times to repeat\\n * @param {number} time cycle offset between iterations\\n * @param {function} func function to apply, given the pattern and the iteration index\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .echoWith(4, 1/8, (p,n) => p.add(n*2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2352,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimpose and offset multiple times, applying the given function each time.</p>","name":"echoWith","synonyms_text":"echowith, stutWith, stutwith","synonyms":["echowith","stutWith","stutwith"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern and the iteration index</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.echoWith(4, 1/8, (p,n) => p.add(n*2))\\n.scale(\\"C:minor\\").note()"],"longname":"echoWith","kind":"member","scope":"global"},{"comment":"/**\\n * Superimpose and offset multiple times, gradually decreasing the velocity\\n * @name echo\\n * @memberof Pattern\\n * @returns Pattern\\n * @param {number} times how many times to repeat\\n * @param {number} time cycle offset between iterations\\n * @param {number} feedback velocity multiplicator for each iteration\\n * @example\\n * s(\\"bd sd\\").echo(3, 1/6, .8)\\n */","meta":{"filename":"pattern.mjs","lineno":2371,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Superimpose and offset multiple times, gradually decreasing the velocity</p>","name":"echo","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"},{"type":{"names":["number"]},"description":"<p>velocity multiplicator for each iteration</p>","name":"feedback"}],"examples":["s(\\"bd sd\\").echo(3, 1/6, .8)"],"scope":"static","longname":"Pattern.echo","kind":"member"},{"comment":"/**\\n * Deprecated. Like echo, but the last 2 parameters are flipped.\\n * @name stut\\n * @param {number} times how many times to repeat\\n * @param {number} feedback velocity multiplicator for each iteration\\n * @param {number} time cycle offset between iterations\\n * @example\\n * s(\\"bd sd\\").stut(3, .8, 1/6)\\n */","meta":{"filename":"pattern.mjs","lineno":2386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Deprecated. Like echo, but the last 2 parameters are flipped.</p>","name":"stut","params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>velocity multiplicator for each iteration</p>","name":"feedback"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"}],"examples":["s(\\"bd sd\\").stut(3, .8, 1/6)"],"longname":"stut","kind":"member","scope":"global"},{"comment":"/**\\n * The plyWith function repeats each event the given number of times, applying the given function to each event.\\\\n\\n * @name plyWith\\n * @synonyms plywith\\n * @param {number} factor how many times to repeat\\n * @param {function} func function to apply, given the pattern\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .plyWith(4, (p) => p.add(2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2407,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The plyWith function repeats each event the given number of times, applying the given function to each event.\\\\n</p>","name":"plyWith","synonyms_text":"plywith","synonyms":["plywith"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"factor"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.plyWith(4, (p) => p.add(2))\\n.scale(\\"C:minor\\").note()"],"longname":"plyWith","kind":"member","scope":"global"},{"comment":"/**\\n * The plyForEach function repeats each event the given number of times, applying the given function to each event.\\n * This version of ply uses the iteration index as an argument to the function, similar to echoWith.\\n * @name plyForEach\\n * @synonyms plyforeach\\n * @param {number} factor how many times to repeat\\n * @param {function} func function to apply, given the pattern and the iteration index\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .plyForEach(4, (p,n) => p.add(n*2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2428,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The plyForEach function repeats each event the given number of times, applying the given function to each event.\\nThis version of ply uses the iteration index as an argument to the function, similar to echoWith.</p>","name":"plyForEach","synonyms_text":"plyforeach","synonyms":["plyforeach"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"factor"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern and the iteration index</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.plyForEach(4, (p,n) => p.add(n*2))\\n.scale(\\"C:minor\\").note()"],"longname":"plyForEach","kind":"member","scope":"global"},{"comment":"/**\\n * Divides a pattern into a given number of subdivisions, plays the subdivisions in order, but increments the starting subdivision each cycle. The pattern wraps to the first subdivision after the last subdivision is played.\\n * @name iter\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"0 1 2 3\\".scale('A minor')).iter(4)\\n */","meta":{"filename":"pattern.mjs","lineno":2450,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides a pattern into a given number of subdivisions, plays the subdivisions in order, but increments the starting subdivision each cycle. The pattern wraps to the first subdivision after the last subdivision is played.</p>","name":"iter","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"0 1 2 3\\".scale('A minor')).iter(4)"],"scope":"static","longname":"Pattern.iter","kind":"member"},{"comment":"/**\\n * Like \`iter\`, but plays the subdivisions in reverse order. Known as iter' in tidalcycles\\n * @name iterBack\\n * @synonyms iterback\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"0 1 2 3\\".scale('A minor')).iterBack(4)\\n */","meta":{"filename":"pattern.mjs","lineno":2477,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>iter</code>, but plays the subdivisions in reverse order. Known as iter' in tidalcycles</p>","name":"iterBack","synonyms_text":"iterback","synonyms":["iterback"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"0 1 2 3\\".scale('A minor')).iterBack(4)"],"scope":"static","longname":"Pattern.iterBack","kind":"member"},{"comment":"/**\\n * Repeats each cycle the given number of times.\\n * @name repeatCycles\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(irand(12).add(34)).segment(4).repeatCycles(2).s(\\"gm_acoustic_guitar_nylon\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2495,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Repeats each cycle the given number of times.</p>","name":"repeatCycles","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(irand(12).add(34)).segment(4).repeatCycles(2).s(\\"gm_acoustic_guitar_nylon\\")"],"scope":"static","longname":"Pattern.repeatCycles","kind":"member"},{"comment":"/**\\n * Divides a pattern into a given number of parts, then cycles through those parts in turn, applying the given function to each part in turn (one part per cycle).\\n * @name chunk\\n * @synonyms slowChunk, slowchunk\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"0 1 2 3\\".chunk(4, x=>x.add(7))\\n * .scale(\\"A:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2518,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Divides a pattern into a given number of parts, then cycles through those parts in turn, applying the given function to each part in turn (one part per cycle).</p>","name":"chunk","synonyms_text":"slowChunk, slowchunk","synonyms":["slowChunk","slowchunk"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2 3\\".chunk(4, x=>x.add(7))\\n.scale(\\"A:minor\\").note()"],"scope":"static","longname":"Pattern.chunk","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but cycles through the parts in reverse order. Known as chunk' in tidalcycles\\n * @name chunkBack\\n * @synonyms chunkback\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"0 1 2 3\\".chunkBack(4, x=>x.add(7))\\n * .scale(\\"A:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2549,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but cycles through the parts in reverse order. Known as chunk' in tidalcycles</p>","name":"chunkBack","synonyms_text":"chunkback","synonyms":["chunkback"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2 3\\".chunkBack(4, x=>x.add(7))\\n.scale(\\"A:minor\\").note()"],"scope":"static","longname":"Pattern.chunkBack","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but the cycles of the source pattern aren't repeated\\n * for each set of chunks.\\n * @name fastChunk\\n * @synonyms fastchunk\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"<0 8> 1 2 3 4 5 6 7\\"\\n * .fastChunk(4, x => x.color('red')).slow(2)\\n * .scale(\\"C2:major\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2568,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but the cycles of the source pattern aren't repeated\\nfor each set of chunks.</p>","name":"fastChunk","synonyms_text":"fastchunk","synonyms":["fastchunk"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 8> 1 2 3 4 5 6 7\\"\\n.fastChunk(4, x => x.color('red')).slow(2)\\n.scale(\\"C2:major\\").note()"],"scope":"static","longname":"Pattern.fastChunk","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but the function is applied to a looped subcycle of the source pattern.\\n * @name chunkInto\\n * @synonyms chunkinto\\n * @memberof Pattern\\n * @example\\n * sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n *   .bank(\\"tr909\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2589,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but the function is applied to a looped subcycle of the source pattern.</p>","name":"chunkInto","synonyms_text":"chunkinto","synonyms":["chunkinto"],"memberof":"Pattern","examples":["sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n  .bank(\\"tr909\\")"],"scope":"static","longname":"Pattern.chunkInto","kind":"member"},{"comment":"/**\\n * Like \`chunkInto\`, but moves backwards through the chunks.\\n * @name chunkBackInto\\n * @synonyms chunkbackinto\\n * @memberof Pattern\\n * @example\\n * sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n *   .bank(\\"tr909\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2602,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Like <code>chunkInto</code>, but moves backwards through the chunks.</p>","name":"chunkBackInto","synonyms_text":"chunkbackinto","synonyms":["chunkbackinto"],"memberof":"Pattern","examples":["sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n  .bank(\\"tr909\\")"],"scope":"static","longname":"Pattern.chunkBackInto","kind":"member"},{"comment":"/**\\n * Loops the pattern inside an \`offset\` for \`cycles\`.\\n * If you think of the entire span of time in cycles as a ribbon, you can cut a single piece and loop it.\\n * @name ribbon\\n * @synonyms rib\\n * @param {number} offset start point of loop in cycles\\n * @param {number} cycles loop length in cycles\\n * @example\\n * note(\\"<c d e f>\\").ribbon(1, 2)\\n * @example\\n * // Looping a portion of randomness\\n * n(irand(8).segment(4)).scale(\\"c:pentatonic\\").ribbon(1337, 2)\\n * @example\\n * // rhythm generator\\n * s(\\"bd!16?\\").ribbon(29,.5)\\n */","meta":{"filename":"pattern.mjs","lineno":2631,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Loops the pattern inside an <code>offset</code> for <code>cycles</code>.\\nIf you think of the entire span of time in cycles as a ribbon, you can cut a single piece and loop it.</p>","name":"ribbon","synonyms_text":"rib","synonyms":["rib"],"params":[{"type":{"names":["number"]},"description":"<p>start point of loop in cycles</p>","name":"offset"},{"type":{"names":["number"]},"description":"<p>loop length in cycles</p>","name":"cycles"}],"examples":["note(\\"<c d e f>\\").ribbon(1, 2)","// Looping a portion of randomness\\nn(irand(8).segment(4)).scale(\\"c:pentatonic\\").ribbon(1337, 2)","// rhythm generator\\ns(\\"bd!16?\\").ribbon(29,.5)"],"longname":"ribbon","kind":"member","scope":"global"},{"comment":"/**\\n * Tags each Hap with an identifier. Good for filtering. The function populates Hap.context.tags (Array).\\n * @name tag\\n * @noAutocomplete\\n * @param {string} tag anything unique\\n */","meta":{"filename":"pattern.mjs","lineno":2659,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Tags each Hap with an identifier. Good for filtering. The function populates Hap.context.tags (Array).</p>","name":"tag","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"params":[{"type":{"names":["string"]},"description":"<p>anything unique</p>","name":"tag"}],"longname":"tag","kind":"member","scope":"global"},{"comment":"/**\\n * Filters haps using the given function\\n * @name filter\\n * @param {Function} test function to test Hap\\n * @example\\n * s(\\"hh!7 oh\\").filter(hap => hap.value.s==='hh')\\n */","meta":{"filename":"pattern.mjs","lineno":2669,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filters haps using the given function</p>","name":"filter","params":[{"type":{"names":["function"]},"description":"<p>function to test Hap</p>","name":"test"}],"examples":["s(\\"hh!7 oh\\").filter(hap => hap.value.s==='hh')"],"longname":"filter","kind":"member","scope":"global"},{"comment":"/**\\n * Filters haps by their begin time\\n * @name filterWhen\\n * @noAutocomplete\\n * @param {Function} test function to test Hap.whole.begin\\n */","meta":{"filename":"pattern.mjs","lineno":2678,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Filters haps by their begin time</p>","name":"filterWhen","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"params":[{"type":{"names":["function"]},"description":"<p>function to test Hap.whole.begin</p>","name":"test"}],"longname":"filterWhen","kind":"member","scope":"global"},{"comment":"/**\\n * Use within to apply a function to only a part of a pattern.\\n * @name within\\n * @param {number} start start within cycle (0 - 1)\\n * @param {number} end end within cycle (0 - 1). Must be > start\\n * @param {Function} func function to be applied to the sub-pattern\\n */","meta":{"filename":"pattern.mjs","lineno":2686,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Use within to apply a function to only a part of a pattern.</p>","name":"within","params":[{"type":{"names":["number"]},"description":"<p>start within cycle (0 - 1)</p>","name":"start"},{"type":{"names":["number"]},"description":"<p>end within cycle (0 - 1). Must be &gt; start</p>","name":"end"},{"type":{"names":["function"]},"description":"<p>function to be applied to the sub-pattern</p>","name":"func"}],"longname":"within","kind":"member","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Speeds a pattern up or down, to fit to the given number of steps per cycle.\\n * @example\\n * sound(\\"bd sd cp\\").pace(4)\\n * // The same as sound(\\"{bd sd cp}%4\\") or sound(\\"<bd sd cp>*4\\")\\n */","meta":{"range":[83036,83331],"filename":"pattern.mjs","lineno":2767,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100033504","name":"exports.pace","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Speeds a pattern up or down, to fit to the given number of steps per cycle.</p>","examples":["sound(\\"bd sd cp\\").pace(4)\\n// The same as sound(\\"{bd sd cp}%4\\") or sound(\\"<bd sd cp>*4\\")"],"name":"pace","longname":"pace","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Aligns the steps of the patterns, creating polymeters. The patterns are repeated until they all fit the cycle. For example, in the below the first pattern is repeated twice, and the second is repeated three times, to fit the lowest common multiple of six steps.\\n * @synonyms pm\\n * @example\\n * // The same as note(\\"{c eb g, c2 g2}%6\\")\\n * polymeter(\\"c eb g\\", \\"c2 g2\\").note()\\n *\\n */","meta":{"range":[84209,84717],"filename":"pattern.mjs","lineno":2810,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100033657","name":"exports.polymeter","type":"FunctionDeclaration","paramnames":["args"]}},"description":"<p><em>Experimental</em></p>\\n<p>Aligns the steps of the patterns, creating polymeters. The patterns are repeated until they all fit the cycle. For example, in the below the first pattern is repeated twice, and the second is repeated three times, to fit the lowest common multiple of six steps.</p>","synonyms_text":"pm","synonyms":["pm"],"examples":["// The same as note(\\"{c eb g, c2 g2}%6\\")\\npolymeter(\\"c eb g\\", \\"c2 g2\\").note()"],"name":"polymeter","longname":"polymeter","kind":"function","scope":"global"},{"comment":"/** 'Concatenates' patterns like \`fastcat\`, but proportional to a number of steps per cycle.\\n * The steps can either be inferred from the pattern, or provided as a [length, pattern] pair.\\n * Has the alias \`timecat\`.\\n * @name stepcat\\n * @synonyms timeCat, timecat\\n * @return {Pattern}\\n * @example\\n * stepcat([3,\\"e3\\"],[1, \\"g3\\"]).note()\\n * // the same as \\"e3@3 g3\\".note()\\n * @example\\n * stepcat(\\"bd sd cp\\",\\"hh hh\\").sound()\\n * // the same as \\"bd sd cp hh hh\\".sound()\\n */","meta":{"filename":"pattern.mjs","lineno":2832,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>'Concatenates' patterns like <code>fastcat</code>, but proportional to a number of steps per cycle.\\nThe steps can either be inferred from the pattern, or provided as a [length, pattern] pair.\\nHas the alias <code>timecat</code>.</p>","name":"stepcat","synonyms_text":"timeCat, timecat","synonyms":["timeCat","timecat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["stepcat([3,\\"e3\\"],[1, \\"g3\\"]).note()\\n// the same as \\"e3@3 g3\\".note()","stepcat(\\"bd sd cp\\",\\"hh hh\\").sound()\\n// the same as \\"bd sd cp hh hh\\".sound()"],"longname":"stepcat","kind":"member","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Concatenates patterns stepwise, according to an inferred 'steps per cycle'.\\n * Similar to \`stepcat\`, but if an argument is a list, the whole pattern will alternate between the elements in the list.\\n *\\n * @return {Pattern}\\n * @example\\n * stepalt([\\"bd cp\\", \\"mt\\"], \\"bd\\").sound()\\n * // The same as \\"bd cp bd mt bd\\".sound()\\n */","meta":{"range":[86781,87328],"filename":"pattern.mjs","lineno":2898,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034028","name":"exports.stepalt","type":"FunctionDeclaration","paramnames":["groups"]}},"description":"<p><em>Experimental</em></p>\\n<p>Concatenates patterns stepwise, according to an inferred 'steps per cycle'.\\nSimilar to <code>stepcat</code>, but if an argument is a list, the whole pattern will alternate between the elements in the list.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["stepalt([\\"bd cp\\", \\"mt\\"], \\"bd\\").sound()\\n// The same as \\"bd cp bd mt bd\\".sound()"],"name":"stepalt","longname":"stepalt","kind":"function","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Takes the given number of steps from a pattern (dropping the rest).\\n * A positive number will take steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"bd cp ht mt\\".take(\\"2\\").sound()\\n * // The same as \\"bd cp\\".sound()\\n * @example\\n * \\"bd cp ht mt\\".take(\\"1 2 3\\").sound()\\n * // The same as \\"bd bd cp bd cp ht\\".sound()\\n * @example\\n * \\"bd cp ht mt\\".take(\\"-1 -2 -3\\").sound()\\n * // The same as \\"mt ht mt cp ht mt\\".sound()\\n */","meta":{"range":[87831,88323],"filename":"pattern.mjs","lineno":2930,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034169","name":"exports.take","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Takes the given number of steps from a pattern (dropping the rest).\\nA positive number will take steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"bd cp ht mt\\".take(\\"2\\").sound()\\n// The same as \\"bd cp\\".sound()","\\"bd cp ht mt\\".take(\\"1 2 3\\").sound()\\n// The same as \\"bd bd cp bd cp ht\\".sound()","\\"bd cp ht mt\\".take(\\"-1 -2 -3\\").sound()\\n// The same as \\"mt ht mt cp ht mt\\".sound()"],"name":"take","longname":"take","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Drops the given number of steps from a pattern.\\n * A positive number will drop steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"1\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"-1\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"0 1 2 3\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"0 -1 -2 -3\\").sound().bank(\\"mridangam\\")\\n */","meta":{"range":[88824,89071],"filename":"pattern.mjs","lineno":2973,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034281","name":"exports.drop","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Drops the given number of steps from a pattern.\\nA positive number will drop steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".drop(\\"1\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"-1\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"0 1 2 3\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"0 -1 -2 -3\\").sound().bank(\\"mridangam\\")"],"name":"drop","longname":"drop","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * \`extend\` is similar to \`fast\` in that it increases its density, but it also increases the step count\\n * accordingly. So \`stepcat(\\"a b\\".extend(2), \\"c d\\")\` would be the same as \`\\"a b a b c d\\"\`, whereas\\n * \`stepcat(\\"a b\\".fast(2), \\"c d\\")\` would be the same as \`\\"[a b] [a b] c d\\"\`.\\n * @example\\n * stepcat(\\n *   sound(\\"bd bd - cp\\").extend(2),\\n *   sound(\\"bd - sd -\\")\\n * ).pace(8)\\n */","meta":{"range":[89479,89594],"filename":"pattern.mjs","lineno":2997,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034343","name":"exports.extend","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p><code>extend</code> is similar to <code>fast</code> in that it increases its density, but it also increases the step count\\naccordingly. So <code>stepcat(&quot;a b&quot;.extend(2), &quot;c d&quot;)</code> would be the same as <code>&quot;a b a b c d&quot;</code>, whereas\\n<code>stepcat(&quot;a b&quot;.fast(2), &quot;c d&quot;)</code> would be the same as <code>&quot;[a b] [a b] c d&quot;</code>.</p>","examples":["stepcat(\\n  sound(\\"bd bd - cp\\").extend(2),\\n  sound(\\"bd - sd -\\")\\n).pace(8)"],"name":"extend","longname":"extend","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * \`replicate\` is similar to \`fast\` in that it increases its density, but it also increases the step count\\n * accordingly. So \`stepcat(\\"a b\\".replicate(2), \\"c d\\")\` would be the same as \`\\"a b a b c d\\"\`, whereas\\n * \`stepcat(\\"a b\\".fast(2), \\"c d\\")\` would be the same as \`\\"[a b] [a b] c d\\"\`.\\n *\\n * TODO: find out how this function differs from extend\\n * @example\\n * stepcat(\\n *   sound(\\"bd bd - cp\\").replicate(2),\\n *   sound(\\"bd - sd -\\")\\n * ).pace(8)\\n */","meta":{"range":[90070,90212],"filename":"pattern.mjs","lineno":3015,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034364","name":"exports.replicate","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p><code>replicate</code> is similar to <code>fast</code> in that it increases its density, but it also increases the step count\\naccordingly. So <code>stepcat(&quot;a b&quot;.replicate(2), &quot;c d&quot;)</code> would be the same as <code>&quot;a b a b c d&quot;</code>, whereas\\n<code>stepcat(&quot;a b&quot;.fast(2), &quot;c d&quot;)</code> would be the same as <code>&quot;[a b] [a b] c d&quot;</code>.</p>\\n<p>TODO: find out how this function differs from extend</p>","examples":["stepcat(\\n  sound(\\"bd bd - cp\\").replicate(2),\\n  sound(\\"bd - sd -\\")\\n).pace(8)"],"name":"replicate","longname":"replicate","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Expands the step size of the pattern by the given factor.\\n * @example\\n * sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").expand(\\"3 2 1 1 2 3\\").pace(8)\\n */","meta":{"range":[90393,90522],"filename":"pattern.mjs","lineno":3026,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034389","name":"exports.expand","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Expands the step size of the pattern by the given factor.</p>","examples":["sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").expand(\\"3 2 1 1 2 3\\").pace(8)"],"name":"expand","longname":"expand","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Contracts the step size of the pattern by the given factor. See also \`expand\`.\\n * @example\\n * sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").contract(\\"3 2 1 1 2 3\\").pace(8)\\n */","meta":{"range":[90726,90859],"filename":"pattern.mjs","lineno":3037,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034414","name":"exports.contract","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Contracts the step size of the pattern by the given factor. See also <code>expand</code>.</p>","examples":["sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").contract(\\"3 2 1 1 2 3\\").pace(8)"],"name":"contract","longname":"contract","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Progressively shrinks the pattern by 'n' steps until there's nothing left, or if a second value is given (using mininotation list syntax with \`:\`),\\n * that number of times.\\n * A positive number will progressively drop steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"-1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .shrink(\\"1 -1\\").pace(8)\\n\\n */","meta":{"range":[92508,92890],"filename":"pattern.mjs","lineno":3103,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034654","name":"exports.shrink","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Progressively shrinks the pattern by 'n' steps until there's nothing left, or if a second value is given (using mininotation list syntax with <code>:</code>),\\nthat number of times.\\nA positive number will progressively drop steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".shrink(\\"1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".shrink(\\"-1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".shrink(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)","note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .shrink(\\"1 -1\\").pace(8)"],"name":"shrink","longname":"shrink","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Progressively grows the pattern by 'n' steps until the full pattern is played, or if a second value is given (using mininotation list syntax with \`:\`),\\n * that number of times.\\n * A positive number will progressively grow steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"-1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .grow(\\"1 -1\\").pace(8)\\n */","meta":{"range":[93570,93985],"filename":"pattern.mjs","lineno":3141,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034720","name":"exports.grow","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Progressively grows the pattern by 'n' steps until the full pattern is played, or if a second value is given (using mininotation list syntax with <code>:</code>),\\nthat number of times.\\nA positive number will progressively grow steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".grow(\\"1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".grow(\\"-1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".grow(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)","note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .grow(\\"1 -1\\").pace(8)"],"name":"grow","longname":"grow","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n * \\n * Inserts a pattern into a list of patterns. On the first repetition it will be inserted at the end of the list, then moved backwards through the list \\n * on successive repetitions. The patterns are added together stepwise, with all repetitions taking place over a single cycle. Using \`pace\` to set the \\n * number of steps per cycle is therefore usually recommended.\\n * \\n * @return {Pattern}\\n * @example\\n * \\"[c g]\\".tour(\\"e f\\", \\"e f g\\", \\"g f e c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)\\n */","meta":{"range":[94506,94582],"filename":"pattern.mjs","lineno":3173,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034797","name":"exports.tour","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Inserts a pattern into a list of patterns. On the first repetition it will be inserted at the end of the list, then moved backwards through the list\\non successive repetitions. The patterns are added together stepwise, with all repetitions taking place over a single cycle. Using <code>pace</code> to set the\\nnumber of steps per cycle is therefore usually recommended.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"[c g]\\".tour(\\"e f\\", \\"e f g\\", \\"g f e c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)"],"name":"tour","longname":"tour","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n * \\n * 'zips' together the steps of the provided patterns. This can create a long repetition, taking place over a single, dense cycle. \\n * Using \`pace\` to set the number of steps per cycle is therefore usually recommended.\\n * \\n * @returns {Pattern}\\n * @example\\n * zip(\\"e f\\", \\"e f g\\", \\"g [f e] a f4 c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)\\n */","meta":{"range":[95182,95437],"filename":"pattern.mjs","lineno":3199,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034866","name":"exports.zip","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>'zips' together the steps of the provided patterns. This can create a long repetition, taking place over a single, dense cycle.\\nUsing <code>pace</code> to set the number of steps per cycle is therefore usually recommended.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["zip(\\"e f\\", \\"e f g\\", \\"g [f e] a f4 c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)"],"name":"zip","longname":"zip","kind":"constant","scope":"global"},{"comment":"/** Aliases for \`stepcat\` */","meta":{"range":[95468,95499],"filename":"pattern.mjs","lineno":3207,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100034930","name":"exports.timecat","type":"VariableDeclaration"}},"description":"<p>Aliases for <code>stepcat</code></p>","name":"timecat","longname":"timecat","kind":"constant","scope":"global"},{"comment":"/**\\n * Cuts each sample into the given number of parts, allowing you to explore a technique known as 'granular synthesis'.\\n * It turns a pattern of samples into a pattern of parts of samples.\\n * @name chop\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\")\\n *  .chop(4)\\n *  .rev() // reverse order of chops\\n *  .loopAt(2) // fit sample into 2 cycles\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3240,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cuts each sample into the given number of parts, allowing you to explore a technique known as 'granular synthesis'.\\nIt turns a pattern of samples into a pattern of parts of samples.</p>","name":"chop","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\")\\n .chop(4)\\n .rev() // reverse order of chops\\n .loopAt(2) // fit sample into 2 cycles"],"scope":"static","longname":"Pattern.chop","kind":"member"},{"comment":"/**\\n * Cuts each sample into the given number of parts, triggering progressive portions of each sample at each loop.\\n * @name striate\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"numbers:0 numbers:1 numbers:2\\").striate(6).slow(3)\\n */","meta":{"filename":"pattern.mjs","lineno":3271,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cuts each sample into the given number of parts, triggering progressive portions of each sample at each loop.</p>","name":"striate","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"numbers:0 numbers:1 numbers:2\\").striate(6).slow(3)"],"scope":"static","longname":"Pattern.striate","kind":"member"},{"comment":"/**\\n * Makes the sample fit the given number of cycles by changing the speed.\\n * @name loopAt\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\").loopAt(2)\\n */","meta":{"filename":"pattern.mjs","lineno":3289,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit the given number of cycles by changing the speed.</p>","name":"loopAt","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\").loopAt(2)"],"scope":"static","longname":"Pattern.loopAt","kind":"member"},{"comment":"/**\\n * Chops samples into the given number of slices, triggering those slices with a given pattern of slice numbers.\\n * Instead of a number, it also accepts a list of numbers from 0 to 1 to slice at specific points.\\n * @name slice\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks165\\").slice(8, \\"0 1 <2 2*2> 3 [4 0] 5 6 7\\".every(3, rev)).slow(0.75)\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks125\\").fit().slice([0,.25,.5,.75], \\"0 1 1 <2 3>\\")\\n */","meta":{"filename":"pattern.mjs","lineno":3306,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Chops samples into the given number of slices, triggering those slices with a given pattern of slice numbers.\\nInstead of a number, it also accepts a list of numbers from 0 to 1 to slice at specific points.</p>","name":"slice","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks165\\").slice(8, \\"0 1 <2 2*2> 3 [4 0] 5 6 7\\".every(3, rev)).slow(0.75)","samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks125\\").fit().slice([0,.25,.5,.75], \\"0 1 1 <2 3>\\")"],"scope":"static","longname":"Pattern.slice","kind":"member"},{"comment":"/**\\n *\\n * make something happen on event time\\n * uses browser timeout which is innacurate for audio tasks\\n * @name onTriggerTime\\n * @memberof Pattern\\n *  @returns Pattern\\n * @example\\n * s(\\"bd!8\\").onTriggerTime((hap) => {console.log(hap)})\\n */","meta":{"filename":"pattern.mjs","lineno":3340,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>make something happen on event time\\nuses browser timeout which is innacurate for audio tasks</p>","name":"onTriggerTime","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd!8\\").onTriggerTime((hap) => {console.log(hap)})"],"scope":"static","longname":"Pattern.onTriggerTime","kind":"member"},{"comment":"/**\\n * Works the same as slice, but changes the playback speed of each slice to match the duration of its step.\\n * @name splice\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks165\\")\\n * .splice(8,  \\"0 1 [2 3 0]@2 3 0@2 7\\")\\n */","meta":{"filename":"pattern.mjs","lineno":3359,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Works the same as slice, but changes the playback speed of each slice to match the duration of its step.</p>","name":"splice","examples":["samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks165\\")\\n.splice(8,  \\"0 1 [2 3 0]@2 3 0@2 7\\")"],"longname":"splice","kind":"member","scope":"global"},{"comment":"/**\\n * Makes the sample fit its event duration. Good for rhythmical loops like drum breaks.\\n * Similar to \`loopAt\`.\\n * @name fit\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes/2\\").fit()\\n */","meta":{"filename":"pattern.mjs","lineno":3395,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit its event duration. Good for rhythmical loops like drum breaks.\\nSimilar to <code>loopAt</code>.</p>","name":"fit","examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes/2\\").fit()"],"longname":"fit","kind":"member","scope":"global"},{"comment":"/**\\n * Makes the sample fit the given number of cycles and cps value, by\\n * changing the speed. Please note that at some point cps will be\\n * given by a global clock and this function will be\\n * deprecated/removed.\\n * @name loopAtCps\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\").loopAtCps(4,1.5).cps(1.5)\\n */","meta":{"filename":"pattern.mjs","lineno":3418,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit the given number of cycles and cps value, by\\nchanging the speed. Please note that at some point cps will be\\ngiven by a global clock and this function will be\\ndeprecated/removed.</p>","name":"loopAtCps","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\").loopAtCps(4,1.5).cps(1.5)"],"scope":"static","longname":"Pattern.loopAtCps","kind":"member"},{"comment":"/** exposes a custom value at query time. basically allows mutating state without evaluation */","meta":{"range":[102969,103069],"filename":"pattern.mjs","lineno":3436,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100035770","name":"exports.ref","type":"VariableDeclaration"}},"description":"<p>exposes a custom value at query time. basically allows mutating state without evaluation</p>","name":"ref","longname":"ref","kind":"constant","scope":"global"},{"comment":"/**\\n * Cross-fades between left and right from 0 to 1:\\n * - 0 = (full left, no right)\\n * - .5 = (both equal)\\n * - 1 = (no left, full right)\\n *\\n * @name xfade\\n * @example\\n * xfade(s(\\"bd*2\\"), \\"<0 .25 .5 .75 1>\\", s(\\"hh*8\\"))\\n */","meta":{"filename":"pattern.mjs","lineno":3443,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cross-fades between left and right from 0 to 1:</p>\\n<ul>\\n<li>0 = (full left, no right)</li>\\n<li>.5 = (both equal)</li>\\n<li>1 = (no left, full right)</li>\\n</ul>","name":"xfade","examples":["xfade(s(\\"bd*2\\"), \\"<0 .25 .5 .75 1>\\", s(\\"hh*8\\"))"],"longname":"xfade","kind":"member","scope":"global"},{"comment":"/**\\n * creates a structure pattern from divisions of a cycle\\n * especially useful for creating rhythms\\n * @name beat\\n * @example\\n * s(\\"bd\\").beat(\\"0,7,10\\", 16)\\n * @example\\n * s(\\"sd\\").beat(\\"4,12\\", 16)\\n */","meta":{"filename":"pattern.mjs","lineno":3467,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>creates a structure pattern from divisions of a cycle\\nespecially useful for creating rhythms</p>","name":"beat","examples":["s(\\"bd\\").beat(\\"0,7,10\\", 16)","s(\\"sd\\").beat(\\"4,12\\", 16)"],"longname":"beat","kind":"member","scope":"global"},{"comment":"/**\\n * Takes two binary rhythms represented as lists of 1s and 0s, and a number\\n * between 0 and 1 that morphs between them. The two lists should contain the same\\n * number of true values.\\n * @example\\n * sound(\\"hh\\").struct(morph([1,0,1,0,1,0,1,0], // straight rhythm\\n *                          [1,1,0,1,0,1,0], // wonky rhythm\\n *                          0.25 // creates a slightly wonky rhythm\\n *                         )\\n *                   )\\n * @example\\n * sound(\\"hh\\").struct(morph(\\"1:0:1:0:1:0:1:0\\", // straight rhythm\\n *                          \\"1:1:0:1:0:1:0\\", // wonky rhythm\\n *                          sine.slow(8) // slowly morph between the rhythms\\n *                         )\\n *                   )\\n */","meta":{"range":[106043,106281],"filename":"pattern.mjs","lineno":3548,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036170","name":"exports.morph","type":"VariableDeclaration"}},"description":"<p>Takes two binary rhythms represented as lists of 1s and 0s, and a number\\nbetween 0 and 1 that morphs between them. The two lists should contain the same\\nnumber of true values.</p>","examples":["sound(\\"hh\\").struct(morph([1,0,1,0,1,0,1,0], // straight rhythm\\n                         [1,1,0,1,0,1,0], // wonky rhythm\\n                         0.25 // creates a slightly wonky rhythm\\n                        )\\n                  )","sound(\\"hh\\").struct(morph(\\"1:0:1:0:1:0:1:0\\", // straight rhythm\\n                         \\"1:1:0:1:0:1:0\\", // wonky rhythm\\n                         sine.slow(8) // slowly morph between the rhythms\\n                        )\\n                  )"],"name":"morph","longname":"morph","kind":"constant","scope":"global"},{"comment":"/**\\n * Soft-clipping distortion\\n *\\n * @name soft\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3555,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Soft-clipping distortion</p>","name":"soft","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"soft","kind":"member","scope":"global"},{"comment":"/**\\n * Hard-clipping distortion\\n *\\n * @name hard\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3563,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Hard-clipping distortion</p>","name":"hard","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"hard","kind":"member","scope":"global"},{"comment":"/**\\n * Cubic polynomial distortion\\n *\\n * @name cubic\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3571,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Cubic polynomial distortion</p>","name":"cubic","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"cubic","kind":"member","scope":"global"},{"comment":"/**\\n * Diode-emulating distortion\\n *\\n * @name diode\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3579,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Diode-emulating distortion</p>","name":"diode","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"diode","kind":"member","scope":"global"},{"comment":"/**\\n * Asymmetrical diode distortion\\n *\\n * @name asym\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3587,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Asymmetrical diode distortion</p>","name":"asym","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"asym","kind":"member","scope":"global"},{"comment":"/**\\n * Wavefolding distortion\\n *\\n * @name fold\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3595,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wavefolding distortion</p>","name":"fold","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"fold","kind":"member","scope":"global"},{"comment":"/**\\n * Wavefolding distortion composed with sinusoid\\n *\\n * @name sinefold\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3603,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Wavefolding distortion composed with sinusoid</p>","name":"sinefold","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"sinefold","kind":"member","scope":"global"},{"comment":"/**\\n * Distortion via Chebyshev polynomials\\n *\\n * @name chebyshev\\n * @param {number | Pattern} distortion amount of distortion to apply\\n * @param {number | Pattern} volume linear postgain of the distortion\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3611,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Distortion via Chebyshev polynomials</p>","name":"chebyshev","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amount of distortion to apply</p>","name":"distortion"},{"type":{"names":["number","Pattern"]},"description":"<p>linear postgain of the distortion</p>","name":"volume"}],"longname":"chebyshev","kind":"member","scope":"global"},{"comment":"/** * Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\n * Similar to \`inhabit\`, but maintains the structure of the original patterns.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(\\"<0 1 2!2 3>\\".pick([\\"g a\\", \\"e f\\", \\"f g f g\\" , \\"g c d\\"]))\\n * @example\\n * sound(\\"<0 1 [2,0]>\\".pick([\\"bd sd\\", \\"cp cp\\", \\"hh hh\\"]))\\n * @example\\n * sound(\\"<0!2 [0,1] 1>\\".pick([\\"bd(3,8)\\", \\"sd sd\\"]))\\n * @example\\n * s(\\"<a!2 [a,b] b>\\".pick({a: \\"bd(3,8)\\", b: \\"sd sd\\"}))\\n */","meta":{"range":[1892,2094],"filename":"pick.mjs","lineno":44,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036387","name":"exports.pick","type":"VariableDeclaration"}},"description":"<p>Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\nSimilar to <code>inhabit</code>, but maintains the structure of the original patterns.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<0 1 2!2 3>\\".pick([\\"g a\\", \\"e f\\", \\"f g f g\\" , \\"g c d\\"]))","sound(\\"<0 1 [2,0]>\\".pick([\\"bd sd\\", \\"cp cp\\", \\"hh hh\\"]))","sound(\\"<0!2 [0,1] 1>\\".pick([\\"bd(3,8)\\", \\"sd sd\\"]))","s(\\"<a!2 [a,b] b>\\".pick({a: \\"bd(3,8)\\", b: \\"sd sd\\"}))"],"name":"pick","longname":"pick","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pick\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * For example, if you pick the fifth pattern of a list of three, you'll get the\\n * second one.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[2519,2637],"filename":"pick.mjs","lineno":65,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036432","name":"exports.pickmod","type":"VariableDeclaration"}},"description":"<p>The same as <code>pick</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.\\nFor example, if you pick the fifth pattern of a list of three, you'll get the\\nsecond one.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmod","longname":"pickmod","kind":"constant","scope":"global"},{"comment":"/** * pickF lets you use a pattern of numbers to pick which function to apply to another pattern.\\n * @param {Pattern} pat\\n * @param {Pattern} lookup a pattern of indices\\n * @param {function[]} funcs the array of functions from which to pull\\n * @returns {Pattern}\\n * @example\\n * s(\\"bd [rim hh]\\").pickF(\\"<0 1 2>\\", [rev,jux(rev),fast(2)])\\n * @example\\n * note(\\"<c2 d2>(3,8)\\").s(\\"square\\")\\n *     .pickF(\\"<0 2> 1\\", [jux(rev),fast(2),x=>x.lpf(800)])\\n */","meta":{"range":[3086,3201],"filename":"pick.mjs","lineno":80,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036452","name":"exports.pickF","type":"VariableDeclaration"}},"description":"<p>pickF lets you use a pattern of numbers to pick which function to apply to another pattern.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["Pattern"]},"description":"<p>a pattern of indices</p>","name":"lookup"},{"type":{"names":["Array.<function()>"]},"description":"<p>the array of functions from which to pull</p>","name":"funcs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["s(\\"bd [rim hh]\\").pickF(\\"<0 1 2>\\", [rev,jux(rev),fast(2)])","note(\\"<c2 d2>(3,8)\\").s(\\"square\\")\\n    .pickF(\\"<0 2> 1\\", [jux(rev),fast(2),x=>x.lpf(800)])"],"name":"pickF","longname":"pickF","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickF\`, but if you pick a number greater than the size of the functions list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {Pattern} lookup a pattern of indices\\n * @param {function[]} funcs the array of functions from which to pull\\n * @returns {Pattern}\\n */","meta":{"range":[3532,3656],"filename":"pick.mjs","lineno":91,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036473","name":"exports.pickmodF","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickF</code>, but if you pick a number greater than the size of the functions list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["Pattern"]},"description":"<p>a pattern of indices</p>","name":"lookup"},{"type":{"names":["Array.<function()>"]},"description":"<p>the array of functions from which to pull</p>","name":"funcs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodF","longname":"pickmodF","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but it applies an outerJoin instead of an innerJoin.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[3803,3922],"filename":"pick.mjs","lineno":100,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036494","name":"exports.pickOut","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but it applies an outerJoin instead of an innerJoin.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickOut","longname":"pickOut","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickOut\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[4143,4267],"filename":"pick.mjs","lineno":110,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036514","name":"exports.pickmodOut","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickOut</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodOut","longname":"pickmodOut","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but the choosen pattern is restarted when its index is triggered.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[4427,4556],"filename":"pick.mjs","lineno":119,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036534","name":"exports.pickRestart","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but the choosen pattern is restarted when its index is triggered.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickRestart","longname":"pickRestart","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickRestart\`, but if you pick a number greater than the size of the list,\\n   * it wraps around, rather than sticking at the maximum value.\\n   * @param {Pattern} pat\\n   * @param {*} xs\\n   * @returns {Pattern}\\n   * @example\\n   * \\"<a@2 b@2 c@2 d@2>\\".pickRestart({\\n        a: n(\\"0 1 2 0\\"),\\n        b: n(\\"2 3 4 ~\\"),\\n        c: n(\\"[4 5] [4 3] 2 0\\"),\\n        d: n(\\"0 -3 0 ~\\")\\n      }).scale(\\"C:major\\").s(\\"piano\\")\\n   */","meta":{"range":[4989,5123],"filename":"pick.mjs","lineno":136,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036554","name":"exports.pickmodRestart","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickRestart</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"<a@2 b@2 c@2 d@2>\\".pickRestart({\\n        a: n(\\"0 1 2 0\\"),\\n        b: n(\\"2 3 4 ~\\"),\\n        c: n(\\"[4 5] [4 3] 2 0\\"),\\n        d: n(\\"0 -3 0 ~\\")\\n      }).scale(\\"C:major\\").s(\\"piano\\")"],"name":"pickmodRestart","longname":"pickmodRestart","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but the choosen pattern is reset when its index is triggered.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[5279,5402],"filename":"pick.mjs","lineno":145,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036574","name":"exports.pickReset","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but the choosen pattern is reset when its index is triggered.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickReset","longname":"pickReset","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickReset\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[5625,5753],"filename":"pick.mjs","lineno":155,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036594","name":"exports.pickmodReset","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickReset</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodReset","longname":"pickmodReset","kind":"constant","scope":"global"},{"comment":"/** Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\n   * Similar to \`pick\`, but cycles are squeezed into the target ('inhabited') pattern.\\n   * @name inhabit\\n   * @synonyms pickSqueeze\\n   * @param {Pattern} pat\\n   * @param {*} xs\\n   * @returns {Pattern}\\n   * @example\\n   * \\"<a b [a,b]>\\".inhabit({a: s(\\"bd(3,8)\\"),\\n                            b: s(\\"cp sd\\")\\n                           })\\n   * @example\\n   * s(\\"a@2 [a b] a\\".inhabit({a: \\"bd(3,8)\\", b: \\"sd sd\\"})).slow(4)\\n   */","meta":{"filename":"pick.mjs","lineno":159,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\nSimilar to <code>pick</code>, but cycles are squeezed into the target ('inhabited') pattern.</p>","name":"inhabit","synonyms_text":"pickSqueeze","synonyms":["pickSqueeze"],"params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"<a b [a,b]>\\".inhabit({a: s(\\"bd(3,8)\\"),\\n                            b: s(\\"cp sd\\")\\n                           })","s(\\"a@2 [a b] a\\".inhabit({a: \\"bd(3,8)\\", b: \\"sd sd\\"})).slow(4)"],"longname":"inhabit","kind":"member","scope":"global"},{"comment":"/** * The same as \`inhabit\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * For example, if you pick the fifth pattern of a list of three, you'll get the\\n * second one.\\n * @name inhabitmod\\n * @synonyms pickmodSqueeze\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"filename":"pick.mjs","lineno":177,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The same as <code>inhabit</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.\\nFor example, if you pick the fifth pattern of a list of three, you'll get the\\nsecond one.</p>","name":"inhabitmod","synonyms_text":"pickmodSqueeze","synonyms":["pickmodSqueeze"],"params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"longname":"inhabitmod","kind":"member","scope":"global"},{"comment":"/**\\n * Pick from the list of values (or patterns of values) via the index using the given\\n * pattern of integers. The selected pattern will be compressed to fit the duration of the selecting event\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(squeeze(\\"<0@2 [1!2] 2>\\", [\\"g a\\", \\"f g f g\\" , \\"g a c d\\"]))\\n */","meta":{"range":[7302,7543],"filename":"pick.mjs","lineno":202,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100036666","name":"exports.squeeze","type":"VariableDeclaration"}},"description":"<p>Pick from the list of values (or patterns of values) via the index using the given\\npattern of integers. The selected pattern will be compressed to fit the duration of the selecting event</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(squeeze(\\"<0@2 [1!2] 2>\\", [\\"g a\\", \\"f g f g\\" , \\"g a c d\\"]))"],"name":"squeeze","longname":"squeeze","kind":"constant","scope":"global"},{"comment":"/**\\n   * Changes the global tempo to the given cycles per minute\\n   *\\n   * @name setcpm\\n   * @alias setCpm\\n   * @param {number} cpm cycles per minute\\n   * @example\\n   * setcpm(140/4) // =140 bpm in 4/4\\n   * $: s(\\"bd*4,[- sd]*2\\").bank('tr707')\\n   */","meta":{"filename":"repl.mjs","lineno":101,"columnno":2,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Changes the global tempo to the given cycles per minute</p>","name":"setcpm","alias":"setCpm","params":[{"type":{"names":["number"]},"description":"<p>cycles per minute</p>","name":"cpm"}],"examples":["setcpm(140/4) // =140 bpm in 4/4\\n$: s(\\"bd*4,[- sd]*2\\").bank('tr707')"],"longname":"setcpm","kind":"member","scope":"global"},{"comment":"/** Applies a function to all the running patterns. Note that the patterns are groups together into a single \`stack\` before the function is applied. This is probably what you want, but see \`each\` for\\n   * a version that applies the function to each pattern separately.\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * all(fast(\\"<2 3>\\"))\\n   * \`\`\`\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * all(x => x.pianoroll())\\n   * \`\`\`\\n   */","meta":{"range":[3428,3446],"filename":"repl.mjs","lineno":131,"columnno":6,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037065","name":"allTransforms","type":"ArrayExpression","value":"[]"}},"description":"<p>Applies a function to all the running patterns. Note that the patterns are groups together into a single <code>stack</code> before the function is applied. This is probably what you want, but see <code>each</code> for\\na version that applies the function to each pattern separately.</p>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\nall(fast(&quot;&lt;2 3>&quot;))\\n</code></pre>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\nall(x => x.pianoroll())\\n</code></pre>","name":"allTransforms","longname":"repl~allTransforms","kind":"member","memberof":"repl","scope":"inner","params":[]},{"comment":"/** Applies a function to each of the running patterns separately. This is intended for future use with upcoming 'stepwise' features. See \`all\` for a version that applies the function to all the patterns stacked together into a single pattern.\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * each(fast(\\"<2 3>\\"))\\n   * \`\`\`\\n   */","meta":{"range":[3898,3982],"filename":"repl.mjs","lineno":143,"columnno":8,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037083","name":"each","type":"FunctionExpression"},"vars":{"eachTransform":"repl~each~eachTransform"}},"description":"<p>Applies a function to each of the running patterns separately. This is intended for future use with upcoming 'stepwise' features. See <code>all</code> for a version that applies the function to all the patterns stacked together into a single pattern.</p>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\neach(fast(&quot;&lt;2 3>&quot;))\\n</code></pre>","name":"each","longname":"repl~each","kind":"function","memberof":"repl","scope":"inner","params":[]},{"comment":"/**\\n *  A sawtooth signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n * .clip(saw.slow(2))\\n * @example\\n * n(saw.range(0,8).segment(8))\\n * .scale('C major')\\n *\\n */","meta":{"range":[1533,1573],"filename":"signal.mjs","lineno":35,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037731","name":"exports.saw","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n.clip(saw.slow(2))","n(saw.range(0,8).segment(8))\\n.scale('C major')"],"name":"saw","longname":"saw","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between -1 and 1 (like \`saw\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[1673,1709],"filename":"signal.mjs","lineno":42,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037742","name":"exports.saw2","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between -1 and 1 (like <code>saw</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"saw2","longname":"saw2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between 1 and 0 (like \`saw\`, but flipped).\\n *\\n * @return {Pattern}\\n * @example\\n * note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n * .clip(isaw.slow(2))\\n * @example\\n * n(isaw.range(0,8).segment(8))\\n * .scale('C major')\\n *\\n */","meta":{"range":[1951,1998],"filename":"signal.mjs","lineno":56,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037750","name":"exports.isaw","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 1 and 0 (like <code>saw</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n.clip(isaw.slow(2))","n(isaw.range(0,8).segment(8))\\n.scale('C major')"],"name":"isaw","longname":"isaw","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between 1 and -1 (like \`saw2\`, but flipped).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2099,2137],"filename":"signal.mjs","lineno":63,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037763","name":"exports.isaw2","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 1 and -1 (like <code>saw2</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"isaw2","longname":"isaw2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sine signal between -1 and 1 (like \`sine\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2234,2296],"filename":"signal.mjs","lineno":70,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037771","name":"exports.sine2","type":"VariableDeclaration"}},"description":"<p>A sine signal between -1 and 1 (like <code>sine</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"sine2","longname":"sine2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sine signal between 0 and 1.\\n * @return {Pattern}\\n * @example\\n * n(sine.segment(16).range(0,15))\\n * .scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2433,2473],"filename":"signal.mjs","lineno":80,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037790","name":"exports.sine","type":"VariableDeclaration"}},"description":"<p>A sine signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(sine.segment(16).range(0,15))\\n.scale(\\"C:minor\\")"],"name":"sine","longname":"sine","kind":"constant","scope":"global"},{"comment":"/**\\n *  A cosine signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * n(stack(sine,cosine).segment(16).range(0,15))\\n * .scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2629,2683],"filename":"signal.mjs","lineno":91,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037798","name":"exports.cosine","type":"VariableDeclaration"}},"description":"<p>A cosine signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(stack(sine,cosine).segment(16).range(0,15))\\n.scale(\\"C:minor\\")"],"name":"cosine","longname":"cosine","kind":"constant","scope":"global"},{"comment":"/**\\n *  A cosine signal between -1 and 1 (like \`cosine\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2784,2840],"filename":"signal.mjs","lineno":98,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037813","name":"exports.cosine2","type":"VariableDeclaration"}},"description":"<p>A cosine signal between -1 and 1 (like <code>cosine</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"cosine2","longname":"cosine2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A square signal between 0 and 1.\\n * @return {Pattern}\\n * @example\\n * n(square.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2975,3036],"filename":"signal.mjs","lineno":107,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037828","name":"exports.square","type":"VariableDeclaration"}},"description":"<p>A square signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(square.segment(4).range(0,7)).scale(\\"C:minor\\")"],"name":"square","longname":"square","kind":"constant","scope":"global"},{"comment":"/**\\n *  A square signal between -1 and 1 (like \`square\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3137,3179],"filename":"signal.mjs","lineno":114,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037845","name":"exports.square2","type":"VariableDeclaration"}},"description":"<p>A square signal between -1 and 1 (like <code>square</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"square2","longname":"square2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A triangle signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * n(tri.segment(8).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[3316,3354],"filename":"signal.mjs","lineno":124,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037853","name":"exports.tri","type":"VariableDeclaration"}},"description":"<p>A triangle signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(tri.segment(8).range(0,7)).scale(\\"C:minor\\")"],"name":"tri","longname":"tri","kind":"constant","scope":"global"},{"comment":"/**\\n *  A triangle signal between -1 and 1 (like \`tri\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3454,3495],"filename":"signal.mjs","lineno":131,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037861","name":"exports.tri2","type":"VariableDeclaration"}},"description":"<p>A triangle signal between -1 and 1 (like <code>tri</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"tri2","longname":"tri2","kind":"constant","scope":"global"},{"comment":"/**\\n *  An inverted triangle signal between 1 and 0 (like \`tri\`, but flipped).\\n *\\n * @return {Pattern}\\n * @example\\n * n(itri.segment(8).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[3669,3708],"filename":"signal.mjs","lineno":141,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037869","name":"exports.itri","type":"VariableDeclaration"}},"description":"<p>An inverted triangle signal between 1 and 0 (like <code>tri</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(itri.segment(8).range(0,7)).scale(\\"C:minor\\")"],"name":"itri","longname":"itri","kind":"constant","scope":"global"},{"comment":"/**\\n *  An inverted triangle signal between -1 and 1 (like \`itri\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3819,3861],"filename":"signal.mjs","lineno":148,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037877","name":"exports.itri2","type":"VariableDeclaration"}},"description":"<p>An inverted triangle signal between -1 and 1 (like <code>itri</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"itri2","longname":"itri2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A signal representing the cycle time.\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3937,3968],"filename":"signal.mjs","lineno":155,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100037885","name":"exports.time","type":"VariableDeclaration"}},"description":"<p>A signal representing the cycle time.</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"time","longname":"time","kind":"constant","scope":"global"},{"comment":"/**\\n *  The mouse's x position value ranges from 0 to 1.\\n * @name mousex\\n * @return {Pattern}\\n * @example\\n * n(mousex.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":157,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The mouse's x position value ranges from 0 to 1.</p>","name":"mousex","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(mousex.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"mousex","kind":"member","scope":"global"},{"comment":"/**\\n *  The mouse's y position value ranges from 0 to 1.\\n * @name mousey\\n * @return {Pattern}\\n * @example\\n * n(mousey.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":166,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>The mouse's y position value ranges from 0 to 1.</p>","name":"mousey","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(mousey.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"mousey","kind":"member","scope":"global"},{"comment":"/**\\n * A discrete pattern of numbers from 0 to n-1\\n * @example\\n * n(run(4)).scale(\\"C4:pentatonic\\")\\n * // n(\\"0 1 2 3\\").scale(\\"C4:pentatonic\\")\\n */","meta":{"range":[5663,5724],"filename":"signal.mjs","lineno":228,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038102","name":"exports.run","type":"VariableDeclaration"}},"description":"<p>A discrete pattern of numbers from 0 to n-1</p>","examples":["n(run(4)).scale(\\"C4:pentatonic\\")\\n// n(\\"0 1 2 3\\").scale(\\"C4:pentatonic\\")"],"name":"run","longname":"run","kind":"constant","scope":"global"},{"comment":"/**\\n * Creates a pattern from a binary number.\\n *\\n * @name binary\\n * @param {number} n - input number to convert to binary\\n * @example\\n * \\"hh\\".s().struct(binary(5))\\n * // \\"hh\\".s().struct(\\"1 0 1\\")\\n */","meta":{"filename":"signal.mjs","lineno":230,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Creates a pattern from a binary number.</p>","name":"binary","params":[{"type":{"names":["number"]},"description":"<p>input number to convert to binary</p>","name":"n"}],"examples":["\\"hh\\".s().struct(binary(5))\\n// \\"hh\\".s().struct(\\"1 0 1\\")"],"longname":"binary","kind":"member","scope":"global"},{"comment":"/**\\n * Creates a pattern from a binary number, padded to n bits long.\\n *\\n * @name binaryN\\n * @param {number} n - input number to convert to binary\\n * @param {number} nBits - pattern length, defaults to 16\\n * @example\\n * \\"hh\\".s().struct(binaryN(55532, 16))\\n * // \\"hh\\".s().struct(\\"1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 0\\")\\n */","meta":{"filename":"signal.mjs","lineno":244,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Creates a pattern from a binary number, padded to n bits long.</p>","name":"binaryN","params":[{"type":{"names":["number"]},"description":"<p>input number to convert to binary</p>","name":"n"},{"type":{"names":["number"]},"description":"<p>pattern length, defaults to 16</p>","name":"nBits"}],"examples":["\\"hh\\".s().struct(binaryN(55532, 16))\\n// \\"hh\\".s().struct(\\"1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 0\\")"],"longname":"binaryN","kind":"member","scope":"global"},{"comment":"/**\\n * Slices a pattern into the given number of parts, then plays those parts in random order.\\n * Each part will be played exactly once per cycle.\\n * @name shuffle\\n * @example\\n * note(\\"c d e f\\").sound(\\"piano\\").shuffle(4)\\n * @example\\n * seq(\\"c d e f\\".shuffle(4), \\"g\\").note().sound(\\"piano\\")\\n */","meta":{"filename":"signal.mjs","lineno":279,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slices a pattern into the given number of parts, then plays those parts in random order.\\nEach part will be played exactly once per cycle.</p>","name":"shuffle","examples":["note(\\"c d e f\\").sound(\\"piano\\").shuffle(4)","seq(\\"c d e f\\".shuffle(4), \\"g\\").note().sound(\\"piano\\")"],"longname":"shuffle","kind":"member","scope":"global"},{"comment":"/**\\n * Slices a pattern into the given number of parts, then plays those parts at random. Similar to \`shuffle\`,\\n * but parts might be played more than once, or not at all, per cycle.\\n * @name scramble\\n * @example\\n * note(\\"c d e f\\").sound(\\"piano\\").scramble(4)\\n * @example\\n * seq(\\"c d e f\\".scramble(4), \\"g\\").note().sound(\\"piano\\")\\n */","meta":{"filename":"signal.mjs","lineno":292,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Slices a pattern into the given number of parts, then plays those parts at random. Similar to <code>shuffle</code>,\\nbut parts might be played more than once, or not at all, per cycle.</p>","name":"scramble","examples":["note(\\"c d e f\\").sound(\\"piano\\").scramble(4)","seq(\\"c d e f\\".scramble(4), \\"g\\").note().sound(\\"piano\\")"],"longname":"scramble","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random numbers, between 0 and 1.\\n *\\n * @name rand\\n * @example\\n * // randomly change the cutoff\\n * s(\\"bd*4,hh*8\\").cutoff(rand.range(500,8000))\\n *\\n */","meta":{"filename":"signal.mjs","lineno":305,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of random numbers, between 0 and 1.</p>","name":"rand","examples":["// randomly change the cutoff\\ns(\\"bd*4,hh*8\\").cutoff(rand.range(500,8000))"],"longname":"rand","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random numbers, between -1 and 1\\n */","meta":{"range":[8355,8393],"filename":"signal.mjs","lineno":318,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038410","name":"exports.rand2","type":"VariableDeclaration"}},"description":"<p>A continuous pattern of random numbers, between -1 and 1</p>","name":"rand2","longname":"rand2","kind":"constant","scope":"global"},{"comment":"/**\\n * A continuous pattern of 0 or 1 (binary random), with a probability for the value being 1\\n *\\n * @name brandBy\\n * @param {number} probability - a number between 0 and 1\\n * @example\\n * s(\\"hh*10\\").pan(brandBy(0.2))\\n */","meta":{"filename":"signal.mjs","lineno":322,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of 0 or 1 (binary random), with a probability for the value being 1</p>","name":"brandBy","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"probability"}],"examples":["s(\\"hh*10\\").pan(brandBy(0.2))"],"longname":"brandBy","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of 0 or 1 (binary random)\\n *\\n * @name brand\\n * @example\\n * s(\\"hh*10\\").pan(brand)\\n */","meta":{"filename":"signal.mjs","lineno":332,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of 0 or 1 (binary random)</p>","name":"brand","examples":["s(\\"hh*10\\").pan(brand)"],"longname":"brand","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random integers, between 0 and n-1.\\n *\\n * @name irand\\n * @param {number} n max value (exclusive)\\n * @example\\n * // randomly select scale notes from 0 - 7 (= C to C)\\n * n(irand(8)).struct(\\"x x*2 x x*3\\").scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":343,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of random integers, between 0 and n-1.</p>","name":"irand","params":[{"type":{"names":["number"]},"description":"<p>max value (exclusive)</p>","name":"n"}],"examples":["// randomly select scale notes from 0 - 7 (= C to C)\\nn(irand(8)).struct(\\"x x*2 x x*3\\").scale(\\"C:minor\\")"],"longname":"irand","kind":"member","scope":"global"},{"comment":"/**\\n * Choose from the list of values (or patterns of values) using the given\\n * pattern of numbers, which should be in the range of 0..1\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(chooseWith(sine.fast(2), [\\"sawtooth\\", \\"triangle\\", \\"bd:6\\"]))\\n */","meta":{"range":[9855,9942],"filename":"signal.mjs","lineno":375,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038557","name":"exports.chooseWith","type":"VariableDeclaration"}},"description":"<p>Choose from the list of values (or patterns of values) using the given\\npattern of numbers, which should be in the range of 0..1</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(chooseWith(sine.fast(2), [\\"sawtooth\\", \\"triangle\\", \\"bd:6\\"]))"],"name":"chooseWith","longname":"chooseWith","kind":"constant","scope":"global"},{"comment":"/**\\n * As with {chooseWith}, but the structure comes from the chosen values, rather\\n * than the pattern you're using to choose with.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[10144,10233],"filename":"signal.mjs","lineno":386,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038573","name":"exports.chooseInWith","type":"VariableDeclaration"}},"description":"<p>As with {chooseWith}, but the structure comes from the chosen values, rather\\nthan the pattern you're using to choose with.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"chooseInWith","longname":"chooseInWith","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses randomly from the given list of elements.\\n * @param  {...any} xs values / patterns to choose from.\\n * @returns {Pattern} - a continuous pattern.\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(choose(\\"sine\\", \\"triangle\\", \\"bd:6\\"))\\n */","meta":{"range":[10474,10528],"filename":"signal.mjs","lineno":397,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038589","name":"exports.choose","type":"VariableDeclaration"}},"description":"<p>Chooses randomly from the given list of elements.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>values / patterns to choose from.</p>","name":"xs"}],"returns":[{"type":{"names":["Pattern"]},"description":"<ul>\\n<li>a continuous pattern.</li>\\n</ul>"}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(choose(\\"sine\\", \\"triangle\\", \\"bd:6\\"))"],"name":"choose","longname":"choose","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses from the given list of values (or patterns of values), according\\n * to the pattern that the method is called on. The pattern should be in\\n * the range 0 .. 1.\\n * @param  {...any} xs\\n * @returns {Pattern}\\n */","meta":{"range":[10859,10937],"filename":"signal.mjs","lineno":410,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038617","name":"Pattern.prototype.choose","type":"FunctionExpression","paramnames":["xs"]}},"description":"<p>Chooses from the given list of values (or patterns of values), according\\nto the pattern that the method is called on. The pattern should be in\\nthe range 0 .. 1.</p>","params":[{"type":{"names":["any"]},"variable":true,"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"choose","longname":"Pattern#choose","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * As with choose, but the pattern that this method is called on should be\\n * in the range -1 .. 1\\n * @param  {...any} xs\\n * @returns {Pattern}\\n */","meta":{"range":[11092,11185],"filename":"signal.mjs","lineno":420,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038633","name":"Pattern.prototype.choose2","type":"FunctionExpression","paramnames":["xs"]}},"description":"<p>As with choose, but the pattern that this method is called on should be\\nin the range -1 .. 1</p>","params":[{"type":{"names":["any"]},"variable":true,"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"choose2","longname":"Pattern#choose2","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Picks one of the elements at random each cycle.\\n * @synonyms randcat\\n * @returns {Pattern}\\n * @example\\n * chooseCycles(\\"bd\\", \\"hh\\", \\"sd\\").s().fast(8)\\n * @example\\n * s(\\"bd | hh | sd\\").fast(8)\\n */","meta":{"range":[11389,11462],"filename":"signal.mjs","lineno":433,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038651","name":"exports.chooseCycles","type":"VariableDeclaration"}},"description":"<p>Picks one of the elements at random each cycle.</p>","synonyms_text":"randcat","synonyms":["randcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["chooseCycles(\\"bd\\", \\"hh\\", \\"sd\\").s().fast(8)","s(\\"bd | hh | sd\\").fast(8)"],"name":"chooseCycles","longname":"chooseCycles","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses randomly from the given list of elements by giving a probability to each element\\n * @param {...any} pairs arrays of value and weight\\n * @returns {Pattern} - a continuous pattern.\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(wchoose([\\"sine\\",10], [\\"triangle\\",1], [\\"bd:6\\",1]))\\n */","meta":{"range":[12754,12819],"filename":"signal.mjs","lineno":473,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038789","name":"exports.wchoose","type":"VariableDeclaration"}},"description":"<p>Chooses randomly from the given list of elements by giving a probability to each element</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>arrays of value and weight</p>","name":"pairs"}],"returns":[{"type":{"names":["Pattern"]},"description":"<ul>\\n<li>a continuous pattern.</li>\\n</ul>"}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(wchoose([\\"sine\\",10], [\\"triangle\\",1], [\\"bd:6\\",1]))"],"name":"wchoose","longname":"wchoose","kind":"constant","scope":"global"},{"comment":"/**\\n * Picks one of the elements at random each cycle by giving a probability to each element\\n * @synonyms wrandcat\\n * @returns {Pattern}\\n * @example\\n * wchooseCycles([\\"bd\\",10], [\\"hh\\",1], [\\"sd\\",1]).s().fast(8)\\n * @example\\n * wchooseCycles([\\"bd bd bd\\",5], [\\"hh hh hh\\",3], [\\"sd sd sd\\",1]).fast(4).s()\\n * @example\\n * // The probability can itself be a pattern\\n * wchooseCycles([\\"bd(3,8)\\",\\"<5 0>\\"], [\\"hh hh hh\\",3]).fast(4).s()\\n */","meta":{"range":[13248,13343],"filename":"signal.mjs","lineno":487,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100038801","name":"exports.wchooseCycles","type":"VariableDeclaration"}},"description":"<p>Picks one of the elements at random each cycle by giving a probability to each element</p>","synonyms_text":"wrandcat","synonyms":["wrandcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["wchooseCycles([\\"bd\\",10], [\\"hh\\",1], [\\"sd\\",1]).s().fast(8)","wchooseCycles([\\"bd bd bd\\",5], [\\"hh hh hh\\",3], [\\"sd sd sd\\",1]).fast(4).s()","// The probability can itself be a pattern\\nwchooseCycles([\\"bd(3,8)\\",\\"<5 0>\\"], [\\"hh hh hh\\",3]).fast(4).s()"],"name":"wchooseCycles","longname":"wchooseCycles","kind":"constant","scope":"global"},{"comment":"/**\\n * Generates a continuous pattern of [perlin noise](https://en.wikipedia.org/wiki/Perlin_noise), in the range 0..1.\\n *\\n * @name perlin\\n * @example\\n * // randomly change the cutoff\\n * s(\\"bd*4,hh*8\\").cutoff(perlin.range(500,8000))\\n *\\n */","meta":{"filename":"signal.mjs","lineno":521,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Generates a continuous pattern of <a href=\\"https://en.wikipedia.org/wiki/Perlin_noise\\">perlin noise</a>, in the range 0..1.</p>","name":"perlin","examples":["// randomly change the cutoff\\ns(\\"bd*4,hh*8\\").cutoff(perlin.range(500,8000))"],"longname":"perlin","kind":"member","scope":"global"},{"comment":"/**\\n * Generates a continuous pattern of [berlin noise](conceived by Jame Coyne and Jade Rowland as a joke but turned out to be surprisingly cool and useful,\\n * like perlin noise but with sawtooth waves), in the range 0..1.\\n *\\n * @name berlin\\n * @example\\n * // ascending arpeggios\\n * n(\\"0!16\\".add(berlin.fast(4).mul(14))).scale(\\"d:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":532,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Generates a continuous pattern of [berlin noise](conceived by Jame Coyne and Jade Rowland as a joke but turned out to be surprisingly cool and useful,\\nlike perlin noise but with sawtooth waves), in the range 0..1.</p>","name":"berlin","examples":["// ascending arpeggios\\nn(\\"0!16\\".add(berlin.fast(4).mul(14))).scale(\\"d:minor\\")"],"longname":"berlin","kind":"member","scope":"global"},{"comment":"/**\\n * Randomly removes events from the pattern by a given amount.\\n * 0 = 0% chance of removal\\n * 1 = 100% chance of removal\\n *\\n * @name degradeBy\\n * @memberof Pattern\\n * @param {number} amount - a number between 0 and 1\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").degradeBy(0.2)\\n * @example\\n * s(\\"[hh?0.2]*8\\")\\n * @example\\n * //beat generator\\n * s(\\"bd\\").segment(16).degradeBy(.5).ribbon(16,1)\\n */","meta":{"filename":"signal.mjs","lineno":551,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly removes events from the pattern by a given amount.\\n0 = 0% chance of removal\\n1 = 100% chance of removal</p>","name":"degradeBy","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").degradeBy(0.2)","s(\\"[hh?0.2]*8\\")","//beat generator\\ns(\\"bd\\").segment(16).degradeBy(.5).ribbon(16,1)"],"scope":"static","longname":"Pattern.degradeBy","kind":"member"},{"comment":"/**\\n *\\n * Randomly removes 50% of events from the pattern. Shorthand for \`.degradeBy(0.5)\`\\n *\\n * @name degrade\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").degrade()\\n * @example\\n * s(\\"[hh?]*8\\")\\n */","meta":{"filename":"signal.mjs","lineno":577,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly removes 50% of events from the pattern. Shorthand for <code>.degradeBy(0.5)</code></p>","name":"degrade","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").degrade()","s(\\"[hh?]*8\\")"],"scope":"static","longname":"Pattern.degrade","kind":"member"},{"comment":"/**\\n * Inverse of \`degradeBy\`: Randomly removes events from the pattern by a given amount.\\n * 0 = 100% chance of removal\\n * 1 = 0% chance of removal\\n * Events that would be removed by degradeBy are let through by undegradeBy and vice versa (see second example).\\n *\\n * @name undegradeBy\\n * @memberof Pattern\\n * @param {number} amount - a number between 0 and 1\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").undegradeBy(0.2)\\n * @example\\n * s(\\"hh*10\\").layer(\\n *   x => x.degradeBy(0.2).pan(0),\\n *   x => x.undegradeBy(0.8).pan(1)\\n * )\\n */","meta":{"filename":"signal.mjs","lineno":591,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Inverse of <code>degradeBy</code>: Randomly removes events from the pattern by a given amount.\\n0 = 100% chance of removal\\n1 = 0% chance of removal\\nEvents that would be removed by degradeBy are let through by undegradeBy and vice versa (see second example).</p>","name":"undegradeBy","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").undegradeBy(0.2)","s(\\"hh*10\\").layer(\\n  x => x.degradeBy(0.2).pan(0),\\n  x => x.undegradeBy(0.8).pan(1)\\n)"],"scope":"static","longname":"Pattern.undegradeBy","kind":"member"},{"comment":"/**\\n * Inverse of \`degrade\`: Randomly removes 50% of events from the pattern. Shorthand for \`.undegradeBy(0.5)\`\\n * Events that would be removed by degrade are let through by undegrade and vice versa (see second example).\\n *\\n * @name undegrade\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").undegrade()\\n * @example\\n * s(\\"hh*10\\").layer(\\n *   x => x.degrade().pan(0),\\n *   x => x.undegrade().pan(1)\\n * )\\n */","meta":{"filename":"signal.mjs","lineno":621,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Inverse of <code>degrade</code>: Randomly removes 50% of events from the pattern. Shorthand for <code>.undegradeBy(0.5)</code>\\nEvents that would be removed by degrade are let through by undegrade and vice versa (see second example).</p>","name":"undegrade","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").undegrade()","s(\\"hh*10\\").layer(\\n  x => x.degrade().pan(0),\\n  x => x.undegrade().pan(1)\\n)"],"scope":"static","longname":"Pattern.undegrade","kind":"member"},{"comment":"/**\\n *\\n * Randomly applies the given function by the given probability.\\n * Similar to \`someCyclesBy\`\\n *\\n * @name sometimesBy\\n * @memberof Pattern\\n * @param {number | Pattern} probability - a number between 0 and 1\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").sometimesBy(.4, x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":638,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly applies the given function by the given probability.\\nSimilar to <code>someCyclesBy</code></p>","name":"sometimesBy","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>a number between 0 and 1</p>","name":"probability"},{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").sometimesBy(.4, x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.sometimesBy","kind":"member"},{"comment":"/**\\n *\\n * Applies the given function with a 50% chance\\n *\\n * @name sometimes\\n * @memberof Pattern\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").sometimes(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":658,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Applies the given function with a 50% chance</p>","name":"sometimes","memberof":"Pattern","params":[{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").sometimes(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.sometimes","kind":"member"},{"comment":"/**\\n *\\n * Randomly applies the given function by the given probability on a cycle by cycle basis.\\n * Similar to \`sometimesBy\`\\n *\\n * @name someCyclesBy\\n * @memberof Pattern\\n * @param {number | Pattern} probability - a number between 0 and 1\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"bd,hh*8\\").someCyclesBy(.3, x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":673,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Randomly applies the given function by the given probability on a cycle by cycle basis.\\nSimilar to <code>sometimesBy</code></p>","name":"someCyclesBy","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>a number between 0 and 1</p>","name":"probability"},{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd,hh*8\\").someCyclesBy(.3, x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.someCyclesBy","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.someCyclesBy(0.5, fn)\`\\n *\\n * @name someCycles\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"bd,hh*8\\").someCycles(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":698,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.someCyclesBy(0.5, fn)</code></p>","name":"someCycles","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd,hh*8\\").someCycles(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.someCycles","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.75, fn)\`\\n *\\n * @name often\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").often(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":712,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.75, fn)</code></p>","name":"often","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").often(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.often","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.25, fn)\`\\n *\\n * @name rarely\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").rarely(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":726,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.25, fn)</code></p>","name":"rarely","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").rarely(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.rarely","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.1, fn)\`\\n *\\n * @name almostNever\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").almostNever(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":740,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.1, fn)</code></p>","name":"almostNever","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").almostNever(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.almostNever","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.9, fn)\`\\n *\\n * @name almostAlways\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").almostAlways(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":754,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.9, fn)</code></p>","name":"almostAlways","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").almostAlways(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.almostAlways","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0, fn)\` (never calls fn)\\n *\\n * @name never\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").never(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":768,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0, fn)</code> (never calls fn)</p>","name":"never","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").never(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.never","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(1, fn)\` (always calls fn)\\n *\\n * @name always\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").always(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":782,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(1, fn)</code> (always calls fn)</p>","name":"always","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").always(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.always","kind":"member"},{"comment":"/**\\n *\\n * Do something on a keypress, or array of keypresses\\n * [Key name reference](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values)\\n *\\n * @name whenKey\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"bd(5,8)\\").whenKey(\\"Control:j\\", x => x.segment(16).color(\\"red\\")).whenKey(\\"Control:i\\", x => x.fast(2).color(\\"blue\\"))\\n */","meta":{"filename":"signal.mjs","lineno":809,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>Do something on a keypress, or array of keypresses\\n<a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\\">Key name reference</a></p>","name":"whenKey","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd(5,8)\\").whenKey(\\"Control:j\\", x => x.segment(16).color(\\"red\\")).whenKey(\\"Control:i\\", x => x.fast(2).color(\\"blue\\"))"],"scope":"static","longname":"Pattern.whenKey","kind":"member"},{"comment":"/**\\n *\\n * returns true when a key or array of keys is held\\n * [Key name reference](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values)\\n *\\n * @name keyDown\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * keyDown(\\"Control:j\\").pick([s(\\"bd(5,8)\\"), s(\\"cp(3,8)\\")])\\n */","meta":{"filename":"signal.mjs","lineno":825,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{}},"description":"<p>returns true when a key or array of keys is held\\n<a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\\">Key name reference</a></p>","name":"keyDown","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["keyDown(\\"Control:j\\").pick([s(\\"bd(5,8)\\"), s(\\"cp(3,8)\\")])"],"scope":"static","longname":"Pattern.keyDown","kind":"member"},{"comment":"/**\\n * @deprecated does not appear to be referenced or invoked anywhere in the codebase\\n * @noAutocomplete\\n */","meta":{"range":[2816,2983],"filename":"util.mjs","lineno":73,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100052618","name":"exports.getFreq","type":"VariableDeclaration"}},"deprecated":"does not appear to be referenced or invoked anywhere in the codebase","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"getFreq","longname":"getFreq","kind":"constant","scope":"global"},{"comment":"/**\\n * @deprecated only used in workshop (first-notes)\\n * @noAutocomplete\\n */","meta":{"range":[3142,3261],"filename":"util.mjs","lineno":85,"columnno":0,"path":"/home/alex/src/strudel/packages/core","code":{"id":"astnode100052657","name":"exports.midi2note","type":"VariableDeclaration"}},"deprecated":"only used in workshop (first-notes)","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"midi2note","longname":"midi2note","kind":"constant","scope":"global"},{"comment":"/**\\n * Sends notes to Csound for rendering with MIDI semantics. The hap value is\\n * translated to these Csound pfields:\\n *\\n *  p1 -- Csound instrument either as a number (1-based, can be a fraction),\\n *        or as a string name.\\n *  p2 -- time in beats (usually seconds) from start of performance.\\n *  p3 -- duration in beats (usually seconds).\\n *  p4 -- MIDI key number (as a real number, not an integer but in [0, 127].\\n *  p5 -- MIDI velocity (as a real number, not an integer but in [0, 127].\\n *  p6 -- Strudel controls, as a string.\\n */","meta":{"range":[4679,6063],"filename":"index.mjs","lineno":139,"columnno":0,"path":"/home/alex/src/strudel/packages/csound","code":{"id":"astnode100055261","name":"exports.csoundm","type":"VariableDeclaration"}},"description":"<p>Sends notes to Csound for rendering with MIDI semantics. The hap value is\\ntranslated to these Csound pfields:</p>\\n<p>p1 -- Csound instrument either as a number (1-based, can be a fraction),\\nor as a string name.\\np2 -- time in beats (usually seconds) from start of performance.\\np3 -- duration in beats (usually seconds).\\np4 -- MIDI key number (as a real number, not an integer but in [0, 127].\\np5 -- MIDI velocity (as a real number, not an integer but in [0, 127].\\np6 -- Strudel controls, as a string.</p>","name":"csoundm","longname":"csoundm","kind":"constant","scope":"global"},{"comment":"/**\\n * Visualises a pattern as a scrolling 'pianoroll', displayed in the background of the editor. To show a pianoroll for all running patterns, use \`all(pianoroll)\`. To have a pianoroll appear below\\n * a pattern instead, prefix with \`_\`, e.g.: \`sound(\\"bd sd\\")._pianoroll()\`.\\n *\\n * @name pianoroll\\n * @synonyms punchcard\\n * @param {Object} options Object containing all the optional following parameters as key value pairs:\\n * @param {integer} cycles number of cycles to be displayed at the same time - defaults to 4\\n * @param {number} playhead location of the active notes on the time axis - 0 to 1, defaults to 0.5\\n * @param {boolean} vertical displays the roll vertically - 0 by default\\n * @param {boolean} labels displays labels on individual notes (see the label function) - 0 by default\\n * @param {boolean} flipTime reverse the direction of the roll - 0 by default\\n * @param {boolean} flipValues reverse the relative location of notes on the value axis - 0 by default\\n * @param {number} overscan lookup X cycles outside of the cycles window to display notes in advance - 1 by default\\n * @param {boolean} hideNegative hide notes with negative time (before starting playing the pattern) - 0 by default\\n * @param {boolean} smear notes leave a solid trace - 0 by default\\n * @param {boolean} fold notes takes the full value axis width - 0 by default\\n * @param {string} active hexadecimal or CSS color of the active notes - defaults to #FFCA28\\n * @param {string} inactive hexadecimal or CSS color of the inactive notes - defaults to #7491D2\\n * @param {string} background hexadecimal or CSS color of the background - defaults to transparent\\n * @param {string} playheadColor hexadecimal or CSS color of the line representing the play head - defaults to white\\n * @param {boolean} fill notes are filled with color (otherwise only the label is displayed) - 0 by default\\n * @param {boolean} fillActive active notes are filled with color - 0 by default\\n * @param {boolean} stroke notes are shown with colored borders - 0 by default\\n * @param {boolean} strokeActive active notes are shown with colored borders - 0 by default\\n * @param {boolean} hideInactive only active notes are shown - 0 by default\\n * @param {boolean} colorizeInactive use note color for inactive notes - 1 by default\\n * @param {string} fontFamily define the font used by notes labels - defaults to 'monospace'\\n * @param {integer} minMidi minimum note value to display on the value axis - defaults to 10\\n * @param {integer} maxMidi maximum note value to display on the value axis - defaults to 90\\n * @param {boolean} autorange automatically calculate the minMidi and maxMidi parameters - 0 by default\\n * @see _pianoroll\\n * @example\\n * note(\\"c2 a2 eb2\\")\\n * .euclid(5,8)\\n * .s('sawtooth')\\n * .lpenv(4).lpf(300)\\n * .pianoroll({ labels: 1 })\\n */","meta":{"filename":"pianoroll.mjs","lineno":39,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Visualises a pattern as a scrolling 'pianoroll', displayed in the background of the editor. To show a pianoroll for all running patterns, use <code>all(pianoroll)</code>. To have a pianoroll appear below\\na pattern instead, prefix with <code>_</code>, e.g.: <code>sound(&quot;bd sd&quot;)._pianoroll()</code>.</p>","name":"pianoroll","synonyms_text":"punchcard","synonyms":["punchcard"],"params":[{"type":{"names":["Object"]},"description":"<p>Object containing all the optional following parameters as key value pairs:</p>","name":"options"},{"type":{"names":["integer"]},"description":"<p>number of cycles to be displayed at the same time - defaults to 4</p>","name":"cycles"},{"type":{"names":["number"]},"description":"<p>location of the active notes on the time axis - 0 to 1, defaults to 0.5</p>","name":"playhead"},{"type":{"names":["boolean"]},"description":"<p>displays the roll vertically - 0 by default</p>","name":"vertical"},{"type":{"names":["boolean"]},"description":"<p>displays labels on individual notes (see the label function) - 0 by default</p>","name":"labels"},{"type":{"names":["boolean"]},"description":"<p>reverse the direction of the roll - 0 by default</p>","name":"flipTime"},{"type":{"names":["boolean"]},"description":"<p>reverse the relative location of notes on the value axis - 0 by default</p>","name":"flipValues"},{"type":{"names":["number"]},"description":"<p>lookup X cycles outside of the cycles window to display notes in advance - 1 by default</p>","name":"overscan"},{"type":{"names":["boolean"]},"description":"<p>hide notes with negative time (before starting playing the pattern) - 0 by default</p>","name":"hideNegative"},{"type":{"names":["boolean"]},"description":"<p>notes leave a solid trace - 0 by default</p>","name":"smear"},{"type":{"names":["boolean"]},"description":"<p>notes takes the full value axis width - 0 by default</p>","name":"fold"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the active notes - defaults to #FFCA28</p>","name":"active"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the inactive notes - defaults to #7491D2</p>","name":"inactive"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the background - defaults to transparent</p>","name":"background"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the line representing the play head - defaults to white</p>","name":"playheadColor"},{"type":{"names":["boolean"]},"description":"<p>notes are filled with color (otherwise only the label is displayed) - 0 by default</p>","name":"fill"},{"type":{"names":["boolean"]},"description":"<p>active notes are filled with color - 0 by default</p>","name":"fillActive"},{"type":{"names":["boolean"]},"description":"<p>notes are shown with colored borders - 0 by default</p>","name":"stroke"},{"type":{"names":["boolean"]},"description":"<p>active notes are shown with colored borders - 0 by default</p>","name":"strokeActive"},{"type":{"names":["boolean"]},"description":"<p>only active notes are shown - 0 by default</p>","name":"hideInactive"},{"type":{"names":["boolean"]},"description":"<p>use note color for inactive notes - 1 by default</p>","name":"colorizeInactive"},{"type":{"names":["string"]},"description":"<p>define the font used by notes labels - defaults to 'monospace'</p>","name":"fontFamily"},{"type":{"names":["integer"]},"description":"<p>minimum note value to display on the value axis - defaults to 10</p>","name":"minMidi"},{"type":{"names":["integer"]},"description":"<p>maximum note value to display on the value axis - defaults to 90</p>","name":"maxMidi"},{"type":{"names":["boolean"]},"description":"<p>automatically calculate the minMidi and maxMidi parameters - 0 by default</p>","name":"autorange"}],"see":["_pianoroll"],"examples":["note(\\"c2 a2 eb2\\")\\n.euclid(5,8)\\n.s('sawtooth')\\n.lpenv(4).lpf(300)\\n.pianoroll({ labels: 1 })"],"longname":"pianoroll","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a vertical pianoroll with event labels.\\n * Supports all the same options as pianoroll.\\n *\\n * @name wordfall\\n */","meta":{"filename":"pianoroll.mjs","lineno":297,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Displays a vertical pianoroll with event labels.\\nSupports all the same options as pianoroll.</p>","name":"wordfall","longname":"wordfall","kind":"member","scope":"global"},{"comment":"/**\\n * Renders a pitch circle to visualize frequencies within one octave\\n * @name pitchwheel\\n * @param {number} hapcircles\\n * @param {number} circle\\n * @param {number} edo\\n * @param {string} root\\n * @param {number} thickness\\n * @param {number} hapRadius\\n * @param {string} mode\\n * @param {number} margin\\n * @example\\n * n(\\"0 .. 12\\").scale(\\"C:chromatic\\")\\n * .s(\\"sawtooth\\")\\n * .lpf(500)\\n * ._pitchwheel()\\n */","meta":{"filename":"pitchwheel.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Renders a pitch circle to visualize frequencies within one octave</p>","name":"pitchwheel","params":[{"type":{"names":["number"]},"name":"hapcircles"},{"type":{"names":["number"]},"name":"circle"},{"type":{"names":["number"]},"name":"edo"},{"type":{"names":["string"]},"name":"root"},{"type":{"names":["number"]},"name":"thickness"},{"type":{"names":["number"]},"name":"hapRadius"},{"type":{"names":["string"]},"name":"mode"},{"type":{"names":["number"]},"name":"margin"}],"examples":["n(\\"0 .. 12\\").scale(\\"C:chromatic\\")\\n.s(\\"sawtooth\\")\\n.lpf(500)\\n._pitchwheel()"],"longname":"pitchwheel","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a spiral visual.\\n *\\n * @name spiral\\n * @param {Object} options Object containing all the optional following parameters as key value pairs:\\n * @param {number} stretch controls the rotations per cycle ratio, where 1 = 1 cycle / 360 degrees\\n * @param {number} size the diameter of the spiral\\n * @param {number} thickness line thickness\\n * @param {string} cap style of line ends: butt (default), round, square\\n * @param {string} inset number of rotations before spiral starts (default 3)\\n * @param {string} playheadColor color of playhead, defaults to white\\n * @param {number} playheadLength length of playhead in rotations, defaults to 0.02\\n * @param {number} playheadThickness thickness of playheadrotations, defaults to thickness\\n * @param {number} padding space around spiral\\n * @param {number} steady steadyness of spiral vs playhead. 1 = spiral doesn't move, playhead does.\\n * @param {number} activeColor color of active segment. defaults to foreground of theme\\n * @param {number} inactiveColor color of inactive segments. defaults to gutterForeground of theme\\n * @param {boolean} colorizeInactive wether or not to colorize inactive segments, defaults to 0\\n * @param {boolean} fade wether or not past and future should fade out. defaults to 1\\n * @param {boolean} logSpiral wether or not the spiral should be logarithmic. defaults to 0\\n * @example\\n * note(\\"c2 a2 eb2\\")\\n * .euclid(5,8)\\n * .s('sawtooth')\\n * .lpenv(4).lpf(300)\\n * ._spiral({ steady: .96 })\\n */","meta":{"filename":"spiral.mjs","lineno":128,"columnno":0,"path":"/home/alex/src/strudel/packages/draw","code":{}},"description":"<p>Displays a spiral visual.</p>","name":"spiral","params":[{"type":{"names":["Object"]},"description":"<p>Object containing all the optional following parameters as key value pairs:</p>","name":"options"},{"type":{"names":["number"]},"description":"<p>controls the rotations per cycle ratio, where 1 = 1 cycle / 360 degrees</p>","name":"stretch"},{"type":{"names":["number"]},"description":"<p>the diameter of the spiral</p>","name":"size"},{"type":{"names":["number"]},"description":"<p>line thickness</p>","name":"thickness"},{"type":{"names":["string"]},"description":"<p>style of line ends: butt (default), round, square</p>","name":"cap"},{"type":{"names":["string"]},"description":"<p>number of rotations before spiral starts (default 3)</p>","name":"inset"},{"type":{"names":["string"]},"description":"<p>color of playhead, defaults to white</p>","name":"playheadColor"},{"type":{"names":["number"]},"description":"<p>length of playhead in rotations, defaults to 0.02</p>","name":"playheadLength"},{"type":{"names":["number"]},"description":"<p>thickness of playheadrotations, defaults to thickness</p>","name":"playheadThickness"},{"type":{"names":["number"]},"description":"<p>space around spiral</p>","name":"padding"},{"type":{"names":["number"]},"description":"<p>steadyness of spiral vs playhead. 1 = spiral doesn't move, playhead does.</p>","name":"steady"},{"type":{"names":["number"]},"description":"<p>color of active segment. defaults to foreground of theme</p>","name":"activeColor"},{"type":{"names":["number"]},"description":"<p>color of inactive segments. defaults to gutterForeground of theme</p>","name":"inactiveColor"},{"type":{"names":["boolean"]},"description":"<p>wether or not to colorize inactive segments, defaults to 0</p>","name":"colorizeInactive"},{"type":{"names":["boolean"]},"description":"<p>wether or not past and future should fade out. defaults to 1</p>","name":"fade"},{"type":{"names":["boolean"]},"description":"<p>wether or not the spiral should be logarithmic. defaults to 0</p>","name":"logSpiral"}],"examples":["note(\\"c2 a2 eb2\\")\\n.euclid(5,8)\\n.s('sawtooth')\\n.lpenv(4).lpf(300)\\n._spiral({ steady: .96 })"],"longname":"spiral","kind":"member","scope":"global"},{"comment":"/**\\n * configures the default midimap, which is used when no \\"midimap\\" port is set\\n * @example\\n * defaultmidimap({ lpf: 74 })\\n * $: note(\\"c a f e\\").midi();\\n * $: lpf(sine.slow(4).segment(16)).midi();\\n */","meta":{"range":[4416,4515],"filename":"midi.mjs","lineno":131,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063183","name":"exports.defaultmidimap","type":"FunctionDeclaration","paramnames":["mapping"]}},"description":"<p>configures the default midimap, which is used when no &quot;midimap&quot; port is set</p>","examples":["defaultmidimap({ lpf: 74 })\\n$: note(\\"c a f e\\").midi();\\n$: lpf(sine.slow(4).segment(16)).midi();"],"name":"defaultmidimap","longname":"defaultmidimap","kind":"function","scope":"global"},{"comment":"/**\\n * Adds midimaps to the registry. Inside each midimap, control names (e.g. lpf) are mapped to cc numbers.\\n * @example\\n * midimaps({ mymap: { lpf: 74 } })\\n * $: note(\\"c a f e\\")\\n * .lpf(sine.slow(4))\\n * .midimap('mymap')\\n * .midi()\\n * @example\\n * midimaps({ mymap: {\\n *   lpf: { ccn: 74, min: 0, max: 20000, exp: 0.5 }\\n * }})\\n * $: note(\\"c a f e\\")\\n * .lpf(sine.slow(2).range(400,2000))\\n * .midimap('mymap')\\n * .midi()\\n */","meta":{"range":[4962,5392],"filename":"midi.mjs","lineno":154,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063201","name":"exports.midimaps","type":"FunctionDeclaration","paramnames":["map"]}},"description":"<p>Adds midimaps to the registry. Inside each midimap, control names (e.g. lpf) are mapped to cc numbers.</p>","examples":["midimaps({ mymap: { lpf: 74 } })\\n$: note(\\"c a f e\\")\\n.lpf(sine.slow(4))\\n.midimap('mymap')\\n.midi()","midimaps({ mymap: {\\n  lpf: { ccn: 74, min: 0, max: 20000, exp: 0.5 }\\n}})\\n$: note(\\"c a f e\\")\\n.lpf(sine.slow(2).range(400,2000))\\n.midimap('mymap')\\n.midi()"],"name":"midimaps","longname":"midimaps","kind":"function","scope":"global"},{"comment":"/**\\n * MIDI output: Opens a MIDI output port.\\n * @param {string | number} midiport MIDI device name or index defaulting to 0\\n * @param {object} options Additional MIDI configuration options\\n * @example\\n * note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1')\\n * @example\\n * note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1', { controller: true, latency: 50 })\\n */","meta":{"range":[10343,16473],"filename":"midi.mjs","lineno":289,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100063852","name":"Pattern.prototype.midi","type":"FunctionExpression","paramnames":["midiport","options"]},"vars":{"undefined":null,"options":"Pattern#midi~options","midiport":"Pattern#midi~midiport","midiConfig":"Pattern#midi~midiConfig","":null}},"description":"<p>MIDI output: Opens a MIDI output port.</p>","params":[{"type":{"names":["string","number"]},"description":"<p>MIDI device name or index defaulting to 0</p>","name":"midiport"},{"type":{"names":["object"]},"description":"<p>Additional MIDI configuration options</p>","name":"options"}],"examples":["note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1')","note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1', { controller: true, latency: 50 })"],"name":"midi","longname":"Pattern#midi","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * MIDI input: Opens a MIDI input port to receive MIDI control change messages.\\n * @param {string | number} input MIDI device name or index defaulting to 0\\n * @returns {Function}\\n * @example\\n * let cc = await midin('IAC Driver Bus 1')\\n * note(\\"c a f e\\").lpf(cc(0).range(0, 1000)).lpq(cc(1).range(0, 10)).sound(\\"sawtooth\\")\\n */","meta":{"range":[16844,18118],"filename":"midi.mjs","lineno":474,"columnno":0,"path":"/home/alex/src/strudel/packages/midi","code":{"id":"astnode100064501","name":"exports.midin","type":"FunctionDeclaration","paramnames":["input"]}},"description":"<p>MIDI input: Opens a MIDI input port to receive MIDI control change messages.</p>","params":[{"type":{"names":["string","number"]},"description":"<p>MIDI device name or index defaulting to 0</p>","name":"input"}],"returns":[{"type":{"names":["function"]}}],"examples":["let cc = await midin('IAC Driver Bus 1')\\nnote(\\"c a f e\\").lpf(cc(0).range(0, 1000)).lpq(cc(1).range(0, 10)).sound(\\"sawtooth\\")"],"name":"midin","longname":"midin","kind":"function","scope":"global"},{"comment":"/**\\n *  The accelerometer's x-axis value ranges from 0 to 1.\\n * @name accelerationX\\n * @return {Pattern}\\n * @synonyms accX\\n * @example\\n * n(accelerationX.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":5,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's x-axis value ranges from 0 to 1.</p>","name":"accelerationX","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accX","synonyms":["accX"],"examples":["n(accelerationX.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationX","kind":"member","scope":"global"},{"comment":"/**\\n *  The accelerometer's y-axis value ranges from 0 to 1.\\n * @name accelerationY\\n * @return {Pattern}\\n * @synonyms accY\\n * @example\\n * n(accelerationY.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":15,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's y-axis value ranges from 0 to 1.</p>","name":"accelerationY","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accY","synonyms":["accY"],"examples":["n(accelerationY.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationY","kind":"member","scope":"global"},{"comment":"/**\\n *  The accelerometer's z-axis value ranges from 0 to 1.\\n * @name accelerationZ\\n * @return {Pattern}\\n * @synonyms accZ\\n * @example\\n * n(accelerationZ.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":25,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's z-axis value ranges from 0 to 1.</p>","name":"accelerationZ","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accZ","synonyms":["accZ"],"examples":["n(accelerationZ.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationZ","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity x-axis value ranges from 0 to 1.\\n * @name gravityX\\n * @return {Pattern}\\n * @synonyms gravX\\n * @example\\n * n(gravityX.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":35,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity x-axis value ranges from 0 to 1.</p>","name":"gravityX","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravX","synonyms":["gravX"],"examples":["n(gravityX.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityX","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity y-axis value ranges from 0 to 1.\\n * @name gravityY\\n * @return {Pattern}\\n * @synonyms gravY\\n * @example\\n * n(gravityY.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":45,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity y-axis value ranges from 0 to 1.</p>","name":"gravityY","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravY","synonyms":["gravY"],"examples":["n(gravityY.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityY","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity z-axis value ranges from 0 to 1.\\n * @name gravityZ\\n * @return {Pattern}\\n * @synonyms gravZ\\n * @example\\n * n(gravityZ.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":55,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's gravity z-axis value ranges from 0 to 1.</p>","name":"gravityZ","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravZ","synonyms":["gravZ"],"examples":["n(gravityZ.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityZ","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the alpha-axis value ranges from 0 to 1.\\n * @name rotationAlpha\\n * @return {Pattern}\\n * @synonyms rotA, rotZ, rotationZ\\n * @example\\n * n(rotationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":65,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the alpha-axis value ranges from 0 to 1.</p>","name":"rotationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotA, rotZ, rotationZ","synonyms":["rotA","rotZ","rotationZ"],"examples":["n(rotationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the beta-axis value ranges from 0 to 1.\\n * @name rotationBeta\\n * @return {Pattern}\\n * @synonyms rotB, rotX, rotationX\\n * @example\\n * n(rotationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":75,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the beta-axis value ranges from 0 to 1.</p>","name":"rotationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotB, rotX, rotationX","synonyms":["rotB","rotX","rotationX"],"examples":["n(rotationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the gamma-axis value ranges from 0 to 1.\\n * @name rotationGamma\\n * @return {Pattern}\\n * @synonyms rotG, rotY, rotationY\\n * @example\\n * n(rotationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":85,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the gamma-axis value ranges from 0 to 1.</p>","name":"rotationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotG, rotY, rotationY","synonyms":["rotG","rotY","rotationY"],"examples":["n(rotationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation alpha value ranges from 0 to 1.\\n * @name orientationAlpha\\n * @return {Pattern}\\n * @synonyms oriA, oriZ, orientationZ\\n * @example\\n * n(orientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":95,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation alpha value ranges from 0 to 1.</p>","name":"orientationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriA, oriZ, orientationZ","synonyms":["oriA","oriZ","orientationZ"],"examples":["n(orientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation beta value ranges from 0 to 1.\\n * @name orientationBeta\\n * @return {Pattern}\\n * @synonyms oriB, oriX, orientationX\\n * @example\\n * n(orientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":105,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation beta value ranges from 0 to 1.</p>","name":"orientationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriB, oriX, orientationX","synonyms":["oriB","oriX","orientationX"],"examples":["n(orientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation gamma value ranges from 0 to 1.\\n * @name orientationGamma\\n * @return {Pattern}\\n * @synonyms oriG, oriY, orientationY\\n * @example\\n * n(orientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":115,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's orientation gamma value ranges from 0 to 1.</p>","name":"orientationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriG, oriY, orientationY","synonyms":["oriG","oriY","orientationY"],"examples":["n(orientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation alpha value ranges from 0 to 1.\\n * @name absoluteOrientationAlpha\\n * @return {Pattern}\\n * @synonyms absOriA, absOriZ, absoluteOrientationZ\\n * @example\\n * n(absoluteOrientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":125,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation alpha value ranges from 0 to 1.</p>","name":"absoluteOrientationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriA, absOriZ, absoluteOrientationZ","synonyms":["absOriA","absOriZ","absoluteOrientationZ"],"examples":["n(absoluteOrientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation beta value ranges from 0 to 1.\\n * @name absoluteOrientationBeta\\n * @return {Pattern}\\n * @synonyms absOriB, absOriX, absoluteOrientationX\\n * @example\\n * n(absoluteOrientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":135,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation beta value ranges from 0 to 1.</p>","name":"absoluteOrientationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriB, absOriX, absoluteOrientationX","synonyms":["absOriB","absOriX","absoluteOrientationX"],"examples":["n(absoluteOrientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation gamma value ranges from 0 to 1.\\n * @name absoluteOrientationGamma\\n * @return {Pattern}\\n * @synonyms absOriG, absOriY, absoluteOrientationY\\n * @example\\n * n(absoluteOrientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":145,"columnno":0,"path":"/home/alex/src/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation gamma value ranges from 0 to 1.</p>","name":"absoluteOrientationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriG, absOriY, absoluteOrientationY","synonyms":["absOriG","absOriY","absoluteOrientationY"],"examples":["n(absoluteOrientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Sends each hap as an OSC message, which can be picked up by SuperCollider or any other OSC-enabled software.\\n * For more info, read [MIDI & OSC in the docs](https://strudel.cc/learn/input-output/)\\n *\\n * @name osc\\n * @memberof Pattern\\n * @returns Pattern\\n */","meta":{"filename":"osc.mjs","lineno":76,"columnno":0,"path":"/home/alex/src/strudel/packages/osc","code":{}},"description":"<p>Sends each hap as an OSC message, which can be picked up by SuperCollider or any other OSC-enabled software.\\nFor more info, read <a href=\\"https://strudel.cc/learn/input-output/\\">MIDI &amp; OSC in the docs</a></p>","name":"osc","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"scope":"static","longname":"Pattern.osc","kind":"member"},{"comment":"/** Overlap-Add Node */","meta":{"range":[150,6513],"filename":"ola-processor.js","lineno":7,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101520","name":"OLAProcessor","type":"ClassDeclaration","paramnames":["options"]}},"name":"OLAProcessor","longname":"OLAProcessor","kind":"class","classdesc":"<p>Overlap-Add Node</p>","scope":"global"},{"comment":"/** Handles dynamic reallocation of input/output channels buffer\\n     (channel numbers may lety during lifecycle) **/","meta":{"range":[1429,1897],"filename":"ola-processor.js","lineno":39,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101673","name":"OLAProcessor#reallocateChannelsIfNeeded","type":"MethodDefinition","paramnames":["inputs","outputs"]},"vars":{"":null}},"description":"<p>Handles dynamic reallocation of input/output channels buffer\\n(channel numbers may lety during lifecycle)</p>","name":"reallocateChannelsIfNeeded","longname":"OLAProcessor#reallocateChannelsIfNeeded","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Read next web audio block to input buffers **/","meta":{"range":[3534,4122],"filename":"ola-processor.js","lineno":92,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100101980","name":"OLAProcessor#readInputs","type":"MethodDefinition","paramnames":["inputs"]},"vars":{"":null}},"description":"<p>Read next web audio block to input buffers</p>","name":"readInputs","longname":"OLAProcessor#readInputs","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Write next web audio block from output buffers **/","meta":{"range":[4183,4461],"filename":"ola-processor.js","lineno":112,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102101","name":"OLAProcessor#writeOutputs","type":"MethodDefinition","paramnames":["outputs"]},"vars":{"":null}},"description":"<p>Write next web audio block from output buffers</p>","name":"writeOutputs","longname":"OLAProcessor#writeOutputs","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Shift left content of input buffers to receive new web audio block **/","meta":{"range":[4542,4757],"filename":"ola-processor.js","lineno":122,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102161","name":"OLAProcessor#shiftInputBuffers","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Shift left content of input buffers to receive new web audio block</p>","name":"shiftInputBuffers","longname":"OLAProcessor#shiftInputBuffers","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Shift left content of output buffers to receive new web audio block **/","meta":{"range":[4839,5147],"filename":"ola-processor.js","lineno":131,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102208","name":"OLAProcessor#shiftOutputBuffers","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Shift left content of output buffers to receive new web audio block</p>","name":"shiftOutputBuffers","longname":"OLAProcessor#shiftOutputBuffers","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Copy contents of input buffers to buffer actually sent to process **/","meta":{"range":[5227,5454],"filename":"ola-processor.js","lineno":141,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102275","name":"OLAProcessor#prepareInputBuffersToSend","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Copy contents of input buffers to buffer actually sent to process</p>","name":"prepareInputBuffersToSend","longname":"OLAProcessor#prepareInputBuffersToSend","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Add contents of output buffers just processed to output buffers **/","meta":{"range":[5532,5852],"filename":"ola-processor.js","lineno":150,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102327","name":"OLAProcessor#handleOutputBuffersToRetrieve","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Add contents of output buffers just processed to output buffers</p>","name":"handleOutputBuffersToRetrieve","longname":"OLAProcessor#handleOutputBuffersToRetrieve","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Generates a reverb impulse response.\\n\\n @param {!Object} params TODO: Document the properties.\\n @param {!function(!AudioBuffer)} callback Function to call when\\n  the impulse response has been generated. The impulse response\\n  is passed to this function as its parameter. May be called\\n  immediately within the current execution context, or later. */","meta":{"range":[969,2138],"filename":"reverbGen.mjs","lineno":24,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102812","name":"reverbGen.generateReverb","type":"FunctionExpression","paramnames":["params","callback"]},"vars":{"audioContext":"reverbGen.generateReverb~audioContext","sampleRate":"reverbGen.generateReverb~sampleRate","numChannels":"reverbGen.generateReverb~numChannels","totalTime":"reverbGen.generateReverb~totalTime","decaySampleFrames":"reverbGen.generateReverb~decaySampleFrames","numSampleFrames":"reverbGen.generateReverb~numSampleFrames","fadeInSampleFrames":"reverbGen.generateReverb~fadeInSampleFrames","decayBase":"reverbGen.generateReverb~decayBase","reverbIR":"reverbGen.generateReverb~reverbIR","i":"reverbGen.generateReverb~i","chan":"reverbGen.generateReverb~chan","j":"reverbGen.generateReverb~j","chan[undefined]":"reverbGen.generateReverb~chan.undefined]"}},"description":"<p>Generates a reverb impulse response.</p>","params":[{"type":{"names":["Object"]},"nullable":false,"description":"<p>TODO: Document the properties.</p>","name":"params"},{"type":{"names":["function"]},"nullable":false,"description":"<p>Function to call when\\nthe impulse response has been generated. The impulse response\\nis passed to this function as its parameter. May be called\\nimmediately within the current execution context, or later.</p>","name":"callback"}],"name":"generateReverb","longname":"reverbGen.generateReverb","kind":"function","memberof":"reverbGen","scope":"static"},{"comment":"/** Creates a canvas element showing a graph of the given data.\\n\\n\\n @param {!Float32Array} data An array of numbers, or a Float32Array.\\n @param {number} width Width in pixels of the canvas.\\n @param {number} height Height in pixels of the canvas.\\n @param {number} min Minimum value of data for the graph (lower edge).\\n @param {number} max Maximum value of data in the graph (upper edge).\\n @return {!CanvasElement} The generated canvas element. */","meta":{"range":[2586,3097],"filename":"reverbGen.mjs","lineno":58,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100102992","name":"reverbGen.generateGraph","type":"FunctionExpression","paramnames":["data","width","height","min","max"]},"vars":{"canvas":"reverbGen.generateGraph~canvas","canvas.width":"reverbGen.generateGraph~canvas.width","canvas.height":"reverbGen.generateGraph~canvas.height","gc":"reverbGen.generateGraph~gc","gc.fillStyle":"reverbGen.generateGraph~gc.fillStyle","xscale":"reverbGen.generateGraph~xscale","yscale":"reverbGen.generateGraph~yscale","i":"reverbGen.generateGraph~i"}},"description":"<p>Creates a canvas element showing a graph of the given data.</p>","params":[{"type":{"names":["Float32Array"]},"nullable":false,"description":"<p>An array of numbers, or a Float32Array.</p>","name":"data"},{"type":{"names":["number"]},"description":"<p>Width in pixels of the canvas.</p>","name":"width"},{"type":{"names":["number"]},"description":"<p>Height in pixels of the canvas.</p>","name":"height"},{"type":{"names":["number"]},"description":"<p>Minimum value of data for the graph (lower edge).</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>Maximum value of data in the graph (upper edge).</p>","name":"max"}],"returns":[{"type":{"names":["CanvasElement"]},"nullable":false,"description":"<p>The generated canvas element.</p>"}],"name":"generateGraph","longname":"reverbGen.generateGraph","kind":"function","memberof":"reverbGen","scope":"static"},{"comment":"/** Applies a constantly changing lowpass filter to the given sound.\\n\\n @private\\n @param {!AudioBuffer} input\\n @param {number} lpFreqStart\\n @param {number} lpFreqEnd\\n @param {number} lpFreqEndAt\\n @param {!function(!AudioBuffer)} callback May be called\\n  immediately within the current execution context, or later.*/","meta":{"range":[3419,4357],"filename":"reverbGen.mjs","lineno":83,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103107","name":"applyGradualLowpass","type":"FunctionExpression"},"vars":{"channelData":"applyGradualLowpass~channelData","context":"applyGradualLowpass~context","player":"applyGradualLowpass~player","player.buffer":"applyGradualLowpass~player.buffer","filter":"applyGradualLowpass~filter","lpFreqStart":"applyGradualLowpass~lpFreqStart","lpFreqEnd":"applyGradualLowpass~lpFreqEnd","filter.type":"applyGradualLowpass~filter.type","filter.Q.value":"applyGradualLowpass~filter.Q.value","context.oncomplete":"applyGradualLowpass~context.oncomplete","":null,"window.filterNode":"window.filterNode"}},"description":"<p>Applies a constantly changing lowpass filter to the given sound.</p>","access":"private","params":[{"type":{"names":["AudioBuffer"]},"nullable":false,"name":"input"},{"type":{"names":["number"]},"name":"lpFreqStart"},{"type":{"names":["number"]},"name":"lpFreqEnd"},{"type":{"names":["number"]},"name":"lpFreqEndAt"},{"type":{"names":["function"]},"nullable":false,"description":"<p>May be called\\nimmediately within the current execution context, or later.</p>","name":"callback"}],"name":"applyGradualLowpass","longname":"applyGradualLowpass","kind":"function","scope":"global"},{"comment":"/** @private\\n @param {!AudioBuffer} buffer\\n @return {!Array.<!Float32Array>} An array containing the Float32Array of each channel's samples. */","meta":{"range":[4508,4691],"filename":"reverbGen.mjs","lineno":116,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103271","name":"getAllChannelData","type":"FunctionExpression"},"vars":{"channels":"getAllChannelData~channels","i":"getAllChannelData~i","channels[undefined]":"getAllChannelData~channels.undefined]"}},"access":"private","params":[{"type":{"names":["AudioBuffer"]},"nullable":false,"name":"buffer"}],"returns":[{"type":{"names":["Array.<!Float32Array>"]},"nullable":false,"description":"<p>An array containing the Float32Array of each channel's samples.</p>"}],"name":"getAllChannelData","longname":"getAllChannelData","kind":"function","scope":"global"},{"comment":"/** @private\\n @return {number} A random number from -1 to 1. */","meta":{"range":[4762,4824],"filename":"reverbGen.mjs","lineno":126,"columnno":4,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100103306","name":"randomSample","type":"FunctionExpression"}},"access":"private","returns":[{"type":{"names":["number"]},"description":"<p>A random number from -1 to 1.</p>"}],"name":"randomSample","longname":"randomSample","kind":"function","scope":"global","params":[]},{"comment":"/**\\n * Loads a collection of samples to use with \`s\`\\n * @example\\n * samples('github:tidalcycles/dirt-samples');\\n * s(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")\\n * @example\\n * samples({\\n *  bd: '808bd/BD0000.WAV',\\n *  sd: '808sd/SD0010.WAV'\\n *  }, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');\\n * s(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")\\n * @example\\n * samples('shabda:noise,chimp:2')\\n * s(\\"noise <chimp:0*2 chimp:1>\\")\\n * @example\\n * samples('shabda/speech/fr-FR/f:chocolat')\\n * s(\\"chocolat*4\\")\\n */","meta":{"range":[8306,8738],"filename":"sampler.mjs","lineno":247,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100104489","name":"exports.samples","type":"VariableDeclaration"}},"description":"<p>Loads a collection of samples to use with <code>s</code></p>","examples":["samples('github:tidalcycles/dirt-samples');\\ns(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")","samples({\\n bd: '808bd/BD0000.WAV',\\n sd: '808sd/SD0010.WAV'\\n }, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');\\ns(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")","samples('shabda:noise,chimp:2')\\ns(\\"noise <chimp:0*2 chimp:1>\\")","samples('shabda/speech/fr-FR/f:chocolat')\\ns(\\"chocolat*4\\")"],"name":"samples","longname":"samples","kind":"constant","scope":"global"},{"comment":"/**\\n * Register an alias for a bank of sounds.\\n * Optionally accepts a single argument map of bank aliases.\\n * Optionally accepts a single argument string of a path to a JSON file containing bank aliases.\\n * @param {string} bank - The bank to alias\\n * @param {string} alias - The alias to use for the bank\\n */","meta":{"range":[3606,3993],"filename":"superdough.mjs","lineno":96,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100105237","name":"exports.aliasBank","type":"FunctionDeclaration","paramnames":["args"]}},"description":"<p>Register an alias for a bank of sounds.\\nOptionally accepts a single argument map of bank aliases.\\nOptionally accepts a single argument string of a path to a JSON file containing bank aliases.</p>","params":[{"type":{"names":["string"]},"description":"<p>The bank to alias</p>","name":"bank"},{"type":{"names":["string"]},"description":"<p>The alias to use for the bank</p>","name":"alias"}],"name":"aliasBank","longname":"aliasBank","kind":"function","scope":"global"},{"comment":"/**\\n * Register an alias for a sound.\\n * @param {string} original - The original sound name\\n * @param {string} alias - The alias to use for the sound\\n */","meta":{"range":[4149,4346],"filename":"superdough.mjs","lineno":116,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100105289","name":"exports.soundAlias","type":"FunctionDeclaration","paramnames":["original","alias"]}},"description":"<p>Register an alias for a sound.</p>","params":[{"type":{"names":["string"]},"description":"<p>The original sound name</p>","name":"original"},{"type":{"names":["string"]},"description":"<p>The alias to use for the sound</p>","name":"alias"}],"name":"soundAlias","longname":"soundAlias","kind":"function","scope":"global"},{"comment":"/**\\n * Loads a collection of wavetables to use with \`s\`\\n *\\n * @name tables\\n */","meta":{"filename":"wavetable.mjs","lineno":180,"columnno":0,"path":"/home/alex/src/strudel/packages/superdough","code":{}},"description":"<p>Loads a collection of wavetables to use with <code>s</code></p>","name":"tables","longname":"tables","kind":"member","scope":"global"},{"comment":"/** Apply Hann window in-place */","meta":{"range":[17486,17622],"filename":"worklets.mjs","lineno":640,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116136","name":"PhaseVocoderProcessor#applyHannWindow","type":"MethodDefinition","paramnames":["input"]},"vars":{"":null}},"description":"<p>Apply Hann window in-place</p>","name":"applyHannWindow","longname":"PhaseVocoderProcessor#applyHannWindow","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Compute squared magnitudes for peak finding **/","meta":{"range":[17680,17992],"filename":"worklets.mjs","lineno":647,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116170","name":"PhaseVocoderProcessor#computeMagnitudes","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Compute squared magnitudes for peak finding</p>","name":"computeMagnitudes","longname":"PhaseVocoderProcessor#computeMagnitudes","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Find peaks in spectrum magnitudes **/","meta":{"range":[18040,18511],"filename":"worklets.mjs","lineno":661,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116230","name":"PhaseVocoderProcessor#findPeaks","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Find peaks in spectrum magnitudes</p>","name":"findPeaks","longname":"PhaseVocoderProcessor#findPeaks","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Shift peaks and regions of influence by pitchFactor into new specturm */","meta":{"range":[18594,20657],"filename":"worklets.mjs","lineno":685,"columnno":2,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100116336","name":"PhaseVocoderProcessor#shiftPeaks","type":"MethodDefinition","paramnames":["pitchFactor"]},"vars":{"":null}},"description":"<p>Shift peaks and regions of influence by pitchFactor into new specturm</p>","name":"shiftPeaks","longname":"PhaseVocoderProcessor#shiftPeaks","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/**  BYTE BEATS */","meta":{"range":[23715,24646],"filename":"worklets.mjs","lineno":848,"columnno":6,"path":"/home/alex/src/strudel/packages/superdough","code":{"id":"astnode100117050","name":"chyx","type":"ObjectExpression","value":"{\\"bitC\\":\\"\\",\\"br\\":\\"\\",\\"sinf\\":\\"\\",\\"cosf\\":\\"\\",\\"tanf\\":\\"\\",\\"regG\\":\\"\\"}"}},"description":"<p>BYTE BEATS</p>","name":"chyx","longname":"chyx","kind":"constant","scope":"global","params":[]},{"comment":"/**\\n * Equal Power Crossfade function.\\n * Smoothly transitions between signals A and B, maintaining consistent perceived loudness.\\n *\\n * @param {number} a - Signal A (can be a single value or an array value in buffer processing).\\n * @param {number} b - Signal B (can be a single value or an array value in buffer processing).\\n * @param {number} m - Crossfade parameter (0.0 = all A, 1.0 = all B, 0.5 = equal mix).\\n * @returns {number} Crossfaded output value.\\n */","meta":{"range":[850,1009],"filename":"dough.mjs","lineno":23,"columnno":0,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100121405","name":"crossfade","type":"FunctionDeclaration","paramnames":["a","b","m"]},"vars":{"aGain":"crossfade~aGain","bGain":"crossfade~bGain"}},"description":"<p>Equal Power Crossfade function.\\nSmoothly transitions between signals A and B, maintaining consistent perceived loudness.</p>","params":[{"type":{"names":["number"]},"description":"<p>Signal A (can be a single value or an array value in buffer processing).</p>","name":"a"},{"type":{"names":["number"]},"description":"<p>Signal B (can be a single value or an array value in buffer processing).</p>","name":"b"},{"type":{"names":["number"]},"description":"<p>Crossfade parameter (0.0 = all A, 1.0 = all B, 0.5 = equal mix).</p>","name":"m"}],"returns":[{"type":{"names":["number"]},"description":"<p>Crossfaded output value.</p>"}],"name":"crossfade","longname":"crossfade","kind":"function","scope":"global"},{"comment":"/** @type {number} */","meta":{"range":[16818,16825],"filename":"dough.mjs","lineno":660,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124364","name":"id","type":"ClassProperty"}},"type":{"names":["number"]},"name":"id","longname":"DoughVoice#id","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number[]} */","meta":{"range":[16854,16867],"filename":"dough.mjs","lineno":662,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124366","name":"out","type":"ClassProperty"}},"type":{"names":["Array.<number>"]},"name":"out","longname":"DoughVoice#out","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16907,16914],"filename":"dough.mjs","lineno":665,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124370","name":"attack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"attack","longname":"DoughVoice#attack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16953,16959],"filename":"dough.mjs","lineno":667,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124371","name":"decay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"decay","longname":"DoughVoice#decay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[16998,17006],"filename":"dough.mjs","lineno":669,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124372","name":"sustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"sustain","longname":"DoughVoice#sustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17033,17041],"filename":"dough.mjs","lineno":671,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124373","name":"release","type":"ClassProperty"}},"type":{"names":["number"]},"name":"release","longname":"DoughVoice#release","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17068,17075],"filename":"dough.mjs","lineno":673,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124374","name":"_begin","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_begin","longname":"DoughVoice#_begin","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17102,17112],"filename":"dough.mjs","lineno":675,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124375","name":"_duration","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_duration","longname":"DoughVoice#_duration","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {any} */","meta":{"range":[17137,17144],"filename":"dough.mjs","lineno":678,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124376","name":"_sound","type":"ClassProperty"}},"type":{"names":["any"]},"name":"_sound","longname":"DoughVoice#_sound","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[17171,17185],"filename":"dough.mjs","lineno":680,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124377","name":"_channels","type":"ClassProperty"}},"type":{"names":["number"]},"name":"_channels","longname":"DoughVoice#_channels","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {BufferPlayer[] | undefined} */","meta":{"range":[17232,17241],"filename":"dough.mjs","lineno":682,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124379","name":"_buffers","type":"ClassProperty"}},"type":{"names":["Array.<BufferPlayer>","undefined"]},"name":"_buffers","longname":"DoughVoice#_buffers","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {string | undefined} */","meta":{"range":[17280,17285],"filename":"dough.mjs","lineno":684,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124380","name":"unit","type":"ClassProperty"}},"type":{"names":["string","undefined"]},"name":"unit","longname":"DoughVoice#unit","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[17323,17329],"filename":"dough.mjs","lineno":687,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124381","name":"_penv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_penv","longname":"DoughVoice#_penv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17368,17373],"filename":"dough.mjs","lineno":689,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124382","name":"penv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"penv","longname":"DoughVoice#penv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17412,17420],"filename":"dough.mjs","lineno":691,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124383","name":"pattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"pattack","longname":"DoughVoice#pattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17459,17466],"filename":"dough.mjs","lineno":693,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124384","name":"pdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"pdecay","longname":"DoughVoice#pdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17505,17514],"filename":"dough.mjs","lineno":695,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124385","name":"psustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"psustain","longname":"DoughVoice#psustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17553,17562],"filename":"dough.mjs","lineno":697,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124386","name":"prelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"prelease","longname":"DoughVoice#prelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17602,17606],"filename":"dough.mjs","lineno":700,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124387","name":"vib","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"vib","longname":"DoughVoice#vib","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17654,17661],"filename":"dough.mjs","lineno":704,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124389","name":"vibmod","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"vibmod","longname":"DoughVoice#vibmod","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {SineOsc | undefined} */","meta":{"range":[17702,17706],"filename":"dough.mjs","lineno":707,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124390","name":"_fm","type":"ClassProperty"}},"type":{"names":["SineOsc","undefined"]},"name":"_fm","longname":"DoughVoice#_fm","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17745,17749],"filename":"dough.mjs","lineno":709,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124391","name":"fmh","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmh","longname":"DoughVoice#fmh","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17788,17792],"filename":"dough.mjs","lineno":711,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124392","name":"fmi","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmi","longname":"DoughVoice#fmi","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[17830,17837],"filename":"dough.mjs","lineno":714,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124393","name":"_fmenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_fmenv","longname":"DoughVoice#_fmenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17876,17885],"filename":"dough.mjs","lineno":716,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124394","name":"fmattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmattack","longname":"DoughVoice#fmattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17924,17932],"filename":"dough.mjs","lineno":718,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124395","name":"fmdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmdecay","longname":"DoughVoice#fmdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[17971,17981],"filename":"dough.mjs","lineno":720,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124396","name":"fmsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmsustain","longname":"DoughVoice#fmsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18020,18030],"filename":"dough.mjs","lineno":722,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124397","name":"fmrelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"fmrelease","longname":"DoughVoice#fmrelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18068,18075],"filename":"dough.mjs","lineno":725,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124398","name":"_lpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_lpenv","longname":"DoughVoice#_lpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18123,18132],"filename":"dough.mjs","lineno":728,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124400","name":"lpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpattack","longname":"DoughVoice#lpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18171,18179],"filename":"dough.mjs","lineno":730,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124401","name":"lpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpdecay","longname":"DoughVoice#lpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18218,18228],"filename":"dough.mjs","lineno":732,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124402","name":"lpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lpsustain","longname":"DoughVoice#lpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18267,18277],"filename":"dough.mjs","lineno":734,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124403","name":"lprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"lprelease","longname":"DoughVoice#lprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18315,18322],"filename":"dough.mjs","lineno":737,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124404","name":"_hpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_hpenv","longname":"DoughVoice#_hpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18361,18367],"filename":"dough.mjs","lineno":739,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124405","name":"hpenv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpenv","longname":"DoughVoice#hpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18406,18415],"filename":"dough.mjs","lineno":741,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124406","name":"hpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpattack","longname":"DoughVoice#hpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18454,18462],"filename":"dough.mjs","lineno":743,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124407","name":"hpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpdecay","longname":"DoughVoice#hpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18501,18511],"filename":"dough.mjs","lineno":745,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124408","name":"hpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hpsustain","longname":"DoughVoice#hpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18550,18560],"filename":"dough.mjs","lineno":747,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124409","name":"hprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hprelease","longname":"DoughVoice#hprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {ADSR | undefined} */","meta":{"range":[18598,18605],"filename":"dough.mjs","lineno":750,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124410","name":"_bpenv","type":"ClassProperty"}},"type":{"names":["ADSR","undefined"]},"name":"_bpenv","longname":"DoughVoice#_bpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18644,18650],"filename":"dough.mjs","lineno":752,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124411","name":"bpenv","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpenv","longname":"DoughVoice#bpenv","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18689,18698],"filename":"dough.mjs","lineno":754,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124412","name":"bpattack","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpattack","longname":"DoughVoice#bpattack","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18737,18745],"filename":"dough.mjs","lineno":756,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124413","name":"bpdecay","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpdecay","longname":"DoughVoice#bpdecay","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18784,18794],"filename":"dough.mjs","lineno":758,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124414","name":"bpsustain","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bpsustain","longname":"DoughVoice#bpsustain","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18833,18843],"filename":"dough.mjs","lineno":760,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124415","name":"bprelease","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bprelease","longname":"DoughVoice#bprelease","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18883,18890],"filename":"dough.mjs","lineno":763,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124416","name":"cutoff","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"cutoff","longname":"DoughVoice#cutoff","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18929,18937],"filename":"dough.mjs","lineno":765,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124417","name":"hcutoff","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"hcutoff","longname":"DoughVoice#hcutoff","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[18976,18982],"filename":"dough.mjs","lineno":767,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124418","name":"bandf","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"bandf","longname":"DoughVoice#bandf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19021,19028],"filename":"dough.mjs","lineno":769,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124419","name":"coarse","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"coarse","longname":"DoughVoice#coarse","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19067,19073],"filename":"dough.mjs","lineno":771,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124420","name":"crush","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"crush","longname":"DoughVoice#crush","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number | undefined} */","meta":{"range":[19112,19120],"filename":"dough.mjs","lineno":773,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124421","name":"distort","type":"ClassProperty"}},"type":{"names":["number","undefined"]},"name":"distort","longname":"DoughVoice#distort","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {number} */","meta":{"range":[19148,19153],"filename":"dough.mjs","lineno":776,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124422","name":"freq","type":"ClassProperty"}},"type":{"names":["number"]},"name":"freq","longname":"DoughVoice#freq","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {string | undefined} */","meta":{"range":[19192,19197],"filename":"dough.mjs","lineno":778,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124423","name":"note","type":"ClassProperty"}},"type":{"names":["string","undefined"]},"name":"note","longname":"DoughVoice#note","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19253,19258],"filename":"dough.mjs","lineno":781,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124424","name":"_lpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_lpf","longname":"DoughVoice#_lpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19313,19318],"filename":"dough.mjs","lineno":783,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124425","name":"_hpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_hpf","longname":"DoughVoice#_hpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {TwoPoleFilter[] | null | undefined} */","meta":{"range":[19373,19378],"filename":"dough.mjs","lineno":785,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124426","name":"_bpf","type":"ClassProperty"}},"type":{"names":["Array.<TwoPoleFilter>","null","undefined"]},"name":"_bpf","longname":"DoughVoice#_bpf","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Chorus[] | null | undefined} */","meta":{"range":[19426,19434],"filename":"dough.mjs","lineno":787,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124427","name":"_chorus","type":"ClassProperty"}},"type":{"names":["Array.<Chorus>","null","undefined"]},"name":"_chorus","longname":"DoughVoice#_chorus","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Coarse[] | null | undefined} */","meta":{"range":[19482,19490],"filename":"dough.mjs","lineno":789,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124428","name":"_coarse","type":"ClassProperty"}},"type":{"names":["Array.<Coarse>","null","undefined"]},"name":"_coarse","longname":"DoughVoice#_coarse","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Crush[] | null | undefined} */","meta":{"range":[19537,19544],"filename":"dough.mjs","lineno":791,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124429","name":"_crush","type":"ClassProperty"}},"type":{"names":["Array.<Crush>","null","undefined"]},"name":"_crush","longname":"DoughVoice#_crush","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/** @type {Distort[] | null | undefined} */","meta":{"range":[19593,19602],"filename":"dough.mjs","lineno":793,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124430","name":"_distort","type":"ClassProperty"}},"type":{"names":["Array.<Distort>","null","undefined"]},"name":"_distort","longname":"DoughVoice#_distort","kind":"member","memberof":"DoughVoice","scope":"instance"},{"comment":"/**\\n   * @param {DoughVoice} value\\n   */","meta":{"range":[19649,24138],"filename":"dough.mjs","lineno":798,"columnno":2,"path":"/home/alex/src/strudel/packages/supradough","code":{"id":"astnode100124431","name":"exports.DoughVoice","type":"MethodDefinition","paramnames":["value"]},"vars":{"":null}},"params":[{"type":{"names":["DoughVoice"]},"name":"value"}],"name":"DoughVoice","longname":"DoughVoice#DoughVoice","kind":"class","memberof":"DoughVoice","scope":"instance"},{"comment":"/**\\n * Change the pitch of each value by the given amount. Expects numbers or note strings as values.\\n * The amount can be given as a number of semitones or as a string in interval short notation.\\n * If you don't care about enharmonic correctness, just use numbers. Otherwise, pass the interval of\\n * the form: ST where S is the degree number and T the type of interval with\\n *\\n * - M = major\\n * - m = minor\\n * - P = perfect\\n * - A = augmented\\n * - d = diminished\\n *\\n * Examples intervals:\\n *\\n * - 1P = unison\\n * - 3M = major third\\n * - 3m = minor third\\n * - 4P = perfect fourth\\n * - 4A = augmented fourth\\n * - 5P = perfect fifth\\n * - 5d = diminished fifth\\n *\\n * @param {string | number} amount Either number of semitones or interval string.\\n * @returns Pattern\\n * @memberof Pattern\\n * @name transpose\\n * @synonyms trans\\n * @example\\n * \\"c2 c3\\".fast(2).transpose(\\"<0 -2 5 3>\\".slow(2)).note()\\n * @example\\n * \\"c2 c3\\".fast(2).transpose(\\"<1P -2M 4P 3m>\\".slow(2)).note()\\n */","meta":{"filename":"tonal.mjs","lineno":73,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Change the pitch of each value by the given amount. Expects numbers or note strings as values.\\nThe amount can be given as a number of semitones or as a string in interval short notation.\\nIf you don't care about enharmonic correctness, just use numbers. Otherwise, pass the interval of\\nthe form: ST where S is the degree number and T the type of interval with</p>\\n<ul>\\n<li>M = major</li>\\n<li>m = minor</li>\\n<li>P = perfect</li>\\n<li>A = augmented</li>\\n<li>d = diminished</li>\\n</ul>\\n<p>Examples intervals:</p>\\n<ul>\\n<li>1P = unison</li>\\n<li>3M = major third</li>\\n<li>3m = minor third</li>\\n<li>4P = perfect fourth</li>\\n<li>4A = augmented fourth</li>\\n<li>5P = perfect fifth</li>\\n<li>5d = diminished fifth</li>\\n</ul>","params":[{"type":{"names":["string","number"]},"description":"<p>Either number of semitones or interval string.</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"memberof":"Pattern","name":"transpose","synonyms_text":"trans","synonyms":["trans"],"examples":["\\"c2 c3\\".fast(2).transpose(\\"<0 -2 5 3>\\".slow(2)).note()","\\"c2 c3\\".fast(2).transpose(\\"<1P -2M 4P 3m>\\".slow(2)).note()"],"scope":"static","longname":"Pattern.transpose","kind":"member"},{"comment":"/**\\n * Transposes notes inside the scale by the number of steps.\\n * Expected to be called on a Pattern which already has a {@link Pattern#scale}\\n *\\n * @memberof Pattern\\n * @name scaleTranspose\\n * @param {offset} offset number of steps inside the scale\\n * @returns Pattern\\n * @synonyms scaleTrans, strans\\n * @example\\n * \\"-8 [2,4,6]\\"\\n * .scale('C4 bebop major')\\n * .scaleTranspose(\\"<0 -1 -2 -3 -4 -5 -6 -4>\\")\\n * .note()\\n */","meta":{"filename":"tonal.mjs","lineno":143,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Transposes notes inside the scale by the number of steps.\\nExpected to be called on a Pattern which already has a {@link Pattern#scale}</p>","memberof":"Pattern","name":"scaleTranspose","params":[{"type":{"names":["offset"]},"description":"<p>number of steps inside the scale</p>","name":"offset"}],"returns":[{"description":"<p>Pattern</p>"}],"synonyms_text":"scaleTrans, strans","synonyms":["scaleTrans","strans"],"examples":["\\"-8 [2,4,6]\\"\\n.scale('C4 bebop major')\\n.scaleTranspose(\\"<0 -1 -2 -3 -4 -5 -6 -4>\\")\\n.note()"],"scope":"static","longname":"Pattern.scaleTranspose","kind":"member"},{"comment":"/**\\n * Turns numbers into notes in the scale (zero indexed) or quantizes notes to a scale.\\n *\\n * When describing notes via numbers, note that negative numbers can be used to wrap backwards\\n * in the scale as well as sharps or flats (but not both) to produce notes outside of the scale.\\n *\\n * Also sets scale for other scale operations, like {@link Pattern#scaleTranspose}.\\n *\\n * A scale consists of a root note (e.g. \`c4\`, \`c\`, \`f#\`, \`bb4\`) followed by semicolon (':') and then a [scale type](https://github.com/tonaljs/tonal/blob/main/packages/scale-type/data.ts).\\n *\\n * The root note defaults to octave 3, if no octave number is given.\\n *\\n * @name scale\\n * @param {string} scale Name of scale\\n * @returns Pattern\\n * @example\\n * n(\\"0 2 4 6 4 2\\").scale(\\"C:major\\")\\n * @example\\n * n(\\"[0,7] 4 [2,7] 4\\")\\n * .scale(\\"C:<major minor>/2\\")\\n * .s(\\"piano\\")\\n * @example\\n * n(rand.range(0,12).segment(8))\\n * .scale(\\"C:ritusen\\")\\n * .s(\\"piano\\")\\n * @example\\n * n(\\"<[0,7b] [-4# -4] [-2,7##] 4 [0,7] [-4# -4b] [-2,7###] 4b>*4\\")\\n * .scale(\\"C:<major minor>/2\\")\\n * .s(\\"piano\\")\\n * @example\\n * note(\\"C1*16\\").transpose(irand(36)).scale('Cb2 major').scaleTranspose(3)\\n */","meta":{"filename":"tonal.mjs","lineno":225,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Turns numbers into notes in the scale (zero indexed) or quantizes notes to a scale.</p>\\n<p>When describing notes via numbers, note that negative numbers can be used to wrap backwards\\nin the scale as well as sharps or flats (but not both) to produce notes outside of the scale.</p>\\n<p>Also sets scale for other scale operations, like {@link Pattern#scaleTranspose}.</p>\\n<p>A scale consists of a root note (e.g. <code>c4</code>, <code>c</code>, <code>f#</code>, <code>bb4</code>) followed by semicolon (':') and then a <a href=\\"https://github.com/tonaljs/tonal/blob/main/packages/scale-type/data.ts\\">scale type</a>.</p>\\n<p>The root note defaults to octave 3, if no octave number is given.</p>","name":"scale","params":[{"type":{"names":["string"]},"description":"<p>Name of scale</p>","name":"scale"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0 2 4 6 4 2\\").scale(\\"C:major\\")","n(\\"[0,7] 4 [2,7] 4\\")\\n.scale(\\"C:<major minor>/2\\")\\n.s(\\"piano\\")","n(rand.range(0,12).segment(8))\\n.scale(\\"C:ritusen\\")\\n.s(\\"piano\\")","n(\\"<[0,7b] [-4# -4] [-2,7##] 4 [0,7] [-4# -4b] [-2,7###] 4b>*4\\")\\n.scale(\\"C:<major minor>/2\\")\\n.s(\\"piano\\")","note(\\"C1*16\\").transpose(irand(36)).scale('Cb2 major').scaleTranspose(3)"],"longname":"scale","kind":"member","scope":"global"},{"comment":"/**\\n * Adds a new custom voicing dictionary.\\n *\\n * @name addVoicings\\n * @memberof Pattern\\n * @param {string} name identifier for the voicing dictionary\\n * @param {Object} dictionary maps chord symbol to possible voicings\\n * @param {Array} range min, max note\\n * @returns Pattern\\n * @example\\n * addVoicings('cookie', {\\n *   7: ['3M 7m 9M 12P 15P', '7m 10M 13M 16M 19P'],\\n *   '^7': ['3M 6M 9M 12P 14M', '7M 10M 13M 16M 19P'],\\n *   m7: ['8P 11P 14m 17m 19P', '5P 8P 11P 14m 17m'],\\n *   m7b5: ['3m 5d 8P 11P 14m', '5d 8P 11P 14m 17m'],\\n *   o7: ['3m 6M 9M 11A 15P'],\\n *   '7alt': ['3M 7m 10m 13m 15P'],\\n *   '7#11': ['7m 10m 13m 15P 17m'],\\n * }, ['C3', 'C6'])\\n * \\"<C^7 A7 Dm7 G7>\\".voicings('cookie').note()\\n */","meta":{"filename":"voicings.mjs","lineno":89,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Adds a new custom voicing dictionary.</p>","name":"addVoicings","memberof":"Pattern","params":[{"type":{"names":["string"]},"description":"<p>identifier for the voicing dictionary</p>","name":"name"},{"type":{"names":["Object"]},"description":"<p>maps chord symbol to possible voicings</p>","name":"dictionary"},{"type":{"names":["Array"]},"description":"<p>min, max note</p>","name":"range"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["addVoicings('cookie', {\\n  7: ['3M 7m 9M 12P 15P', '7m 10M 13M 16M 19P'],\\n  '^7': ['3M 6M 9M 12P 14M', '7M 10M 13M 16M 19P'],\\n  m7: ['8P 11P 14m 17m 19P', '5P 8P 11P 14m 17m'],\\n  m7b5: ['3m 5d 8P 11P 14m', '5d 8P 11P 14m 17m'],\\n  o7: ['3m 6M 9M 11A 15P'],\\n  '7alt': ['3M 7m 10m 13m 15P'],\\n  '7#11': ['7m 10m 13m 15P 17m'],\\n}, ['C3', 'C6'])\\n\\"<C^7 A7 Dm7 G7>\\".voicings('cookie').note()"],"scope":"static","longname":"Pattern.addVoicings","kind":"member"},{"comment":"/**\\n * DEPRECATED: still works, but it is recommended you use .voicing instead (without s).\\n * Turns chord symbols into voicings, using the smoothest voice leading possible.\\n * Uses [chord-voicings package](https://github.com/felixroos/chord-voicings#chord-voicings).\\n *\\n * @name voicings\\n * @memberof Pattern\\n * @param {string} dictionary which voicing dictionary to use.\\n * @returns Pattern\\n * @example\\n * stack(\\"<C^7 A7 Dm7 G7>\\".voicings('lefthand'), \\"<C3 A2 D3 G2>\\").note()\\n */","meta":{"filename":"voicings.mjs","lineno":130,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>DEPRECATED: still works, but it is recommended you use .voicing instead (without s).\\nTurns chord symbols into voicings, using the smoothest voice leading possible.\\nUses <a href=\\"https://github.com/felixroos/chord-voicings#chord-voicings\\">chord-voicings package</a>.</p>","name":"voicings","memberof":"Pattern","params":[{"type":{"names":["string"]},"description":"<p>which voicing dictionary to use.</p>","name":"dictionary"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["stack(\\"<C^7 A7 Dm7 G7>\\".voicings('lefthand'), \\"<C3 A2 D3 G2>\\").note()"],"scope":"static","longname":"Pattern.voicings","kind":"member"},{"comment":"/**\\n * Maps the chords of the incoming pattern to root notes in the given octave.\\n *\\n * @name rootNotes\\n * @memberof Pattern\\n * @param {octave} octave octave to use\\n * @returns Pattern\\n * @example\\n * \\"<C^7 A7 Dm7 G7>\\".rootNotes(2).note()\\n */","meta":{"filename":"voicings.mjs","lineno":156,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Maps the chords of the incoming pattern to root notes in the given octave.</p>","name":"rootNotes","memberof":"Pattern","params":[{"type":{"names":["octave"]},"description":"<p>octave to use</p>","name":"octave"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<C^7 A7 Dm7 G7>\\".rootNotes(2).note()"],"scope":"static","longname":"Pattern.rootNotes","kind":"member"},{"comment":"/**\\n * Turns chord symbols into voicings. You can use the following control params:\\n *\\n * - \`chord\`: Note, followed by chord symbol, e.g. C Am G7 Bb^7\\n * - \`dict\`: voicing dictionary to use, falls back to default dictionary\\n * - \`anchor\`: the note that is used to align the chord\\n * - \`mode\`: how the voicing is aligned to the anchor\\n *   - \`below\`: top note <= anchor\\n *   - \`duck\`: top note <= anchor, anchor excluded\\n *   - \`above\`: bottom note >= anchor\\n * - \`offset\`: whole number that shifts the voicing up or down to the next voicing\\n * - \`n\`: if set, the voicing is played like a scale. Overshooting numbers will be octaved\\n *\\n * All of the above controls are optional, except \`chord\`.\\n * If you pass a pattern of strings to voicing, they will be interpreted as chords.\\n *\\n * @name voicing\\n * @returns Pattern\\n * @example\\n * n(\\"0 1 2 3\\").chord(\\"<C Am F G>\\").voicing()\\n */","meta":{"filename":"voicings.mjs","lineno":175,"columnno":0,"path":"/home/alex/src/strudel/packages/tonal","code":{}},"description":"<p>Turns chord symbols into voicings. You can use the following control params:</p>\\n<ul>\\n<li><code>chord</code>: Note, followed by chord symbol, e.g. C Am G7 Bb^7</li>\\n<li><code>dict</code>: voicing dictionary to use, falls back to default dictionary</li>\\n<li><code>anchor</code>: the note that is used to align the chord</li>\\n<li><code>mode</code>: how the voicing is aligned to the anchor\\n<ul>\\n<li><code>below</code>: top note &lt;= anchor</li>\\n<li><code>duck</code>: top note &lt;= anchor, anchor excluded</li>\\n<li><code>above</code>: bottom note &gt;= anchor</li>\\n</ul>\\n</li>\\n<li><code>offset</code>: whole number that shifts the voicing up or down to the next voicing</li>\\n<li><code>n</code>: if set, the voicing is played like a scale. Overshooting numbers will be octaved</li>\\n</ul>\\n<p>All of the above controls are optional, except <code>chord</code>.\\nIf you pass a pattern of strings to voicing, they will be interpreted as chords.</p>","name":"voicing","returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0 1 2 3\\").chord(\\"<C Am F G>\\").voicing()"],"longname":"voicing","kind":"member","scope":"global"},{"comment":"/**\\n * Renders an oscilloscope for the frequency domain of the audio signal.\\n * @name fscope\\n * @param {string} color line color as hex or color name. defaults to white.\\n * @param {number} scale scales the y-axis. Defaults to 0.25\\n * @param {number} pos y-position relative to screen height. 0 = top, 1 = bottom of screen\\n * @param {number} lean y-axis alignment where 0 = top and 1 = bottom\\n * @param {number} min min value\\n * @param {number} max max value\\n * @example\\n * s(\\"sawtooth\\").fscope()\\n */","meta":{"filename":"scope.mjs","lineno":98,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders an oscilloscope for the frequency domain of the audio signal.</p>","name":"fscope","params":[{"type":{"names":["string"]},"description":"<p>line color as hex or color name. defaults to white.</p>","name":"color"},{"type":{"names":["number"]},"description":"<p>scales the y-axis. Defaults to 0.25</p>","name":"scale"},{"type":{"names":["number"]},"description":"<p>y-position relative to screen height. 0 = top, 1 = bottom of screen</p>","name":"pos"},{"type":{"names":["number"]},"description":"<p>y-axis alignment where 0 = top and 1 = bottom</p>","name":"lean"},{"type":{"names":["number"]},"description":"<p>min value</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>max value</p>","name":"max"}],"examples":["s(\\"sawtooth\\").fscope()"],"longname":"fscope","kind":"member","scope":"global"},{"comment":"/**\\n * Renders an oscilloscope for the time domain of the audio signal.\\n * @name scope\\n * @synonyms tscope\\n * @param {object} config optional config with options:\\n * @param {boolean} align if 1, the scope will be aligned to the first zero crossing. defaults to 1\\n * @param {string} color line color as hex or color name. defaults to white.\\n * @param {number} thickness line thickness. defaults to 3\\n * @param {number} scale scales the y-axis. Defaults to 0.25\\n * @param {number} pos y-position relative to screen height. 0 = top, 1 = bottom of screen\\n * @param {number} trigger amplitude value that is used to align the scope. defaults to 0.\\n * @example\\n * s(\\"sawtooth\\")._scope()\\n */","meta":{"filename":"scope.mjs","lineno":121,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders an oscilloscope for the time domain of the audio signal.</p>","name":"scope","synonyms_text":"tscope","synonyms":["tscope"],"params":[{"type":{"names":["object"]},"description":"<p>optional config with options:</p>","name":"config"},{"type":{"names":["boolean"]},"description":"<p>if 1, the scope will be aligned to the first zero crossing. defaults to 1</p>","name":"align"},{"type":{"names":["string"]},"description":"<p>line color as hex or color name. defaults to white.</p>","name":"color"},{"type":{"names":["number"]},"description":"<p>line thickness. defaults to 3</p>","name":"thickness"},{"type":{"names":["number"]},"description":"<p>scales the y-axis. Defaults to 0.25</p>","name":"scale"},{"type":{"names":["number"]},"description":"<p>y-position relative to screen height. 0 = top, 1 = bottom of screen</p>","name":"pos"},{"type":{"names":["number"]},"description":"<p>amplitude value that is used to align the scope. defaults to 0.</p>","name":"trigger"}],"examples":["s(\\"sawtooth\\")._scope()"],"longname":"scope","kind":"member","scope":"global"},{"comment":"/**\\n * Renders a spectrum analyzer for the incoming audio signal.\\n * @name spectrum\\n * @param {object} config optional config with options:\\n * @param {integer} thickness line thickness in px (default 3)\\n * @param {integer} speed scroll speed (default 1)\\n * @param {integer} min min db (default -80)\\n * @param {integer} max max db (default 0)\\n * @example\\n * n(\\"<0 4 <2 3> 1>*3\\")\\n * .off(1/8, add(n(5)))\\n * .off(1/5, add(n(7)))\\n * .scale(\\"d3:minor:pentatonic\\")\\n * .s('sine')\\n * .dec(.3).room(.5)\\n * ._spectrum()\\n */","meta":{"filename":"spectrum.mjs","lineno":5,"columnno":0,"path":"/home/alex/src/strudel/packages/webaudio","code":{}},"description":"<p>Renders a spectrum analyzer for the incoming audio signal.</p>","name":"spectrum","params":[{"type":{"names":["object"]},"description":"<p>optional config with options:</p>","name":"config"},{"type":{"names":["integer"]},"description":"<p>line thickness in px (default 3)</p>","name":"thickness"},{"type":{"names":["integer"]},"description":"<p>scroll speed (default 1)</p>","name":"speed"},{"type":{"names":["integer"]},"description":"<p>min db (default -80)</p>","name":"min"},{"type":{"names":["integer"]},"description":"<p>max db (default 0)</p>","name":"max"}],"examples":["n(\\"<0 4 <2 3> 1>*3\\")\\n.off(1/8, add(n(5)))\\n.off(1/5, add(n(7)))\\n.scale(\\"d3:minor:pentatonic\\")\\n.s('sine')\\n.dec(.3).room(.5)\\n._spectrum()"],"longname":"spectrum","kind":"member","scope":"global"},{"kind":"package","longname":"package:undefined","files":["/home/alex/src/strudel/packages/codemirror/autocomplete.mjs","/home/alex/src/strudel/packages/codemirror/basicSetup.mjs","/home/alex/src/strudel/packages/codemirror/codemirror.mjs","/home/alex/src/strudel/packages/codemirror/flash.mjs","/home/alex/src/strudel/packages/codemirror/highlight.mjs","/home/alex/src/strudel/packages/codemirror/html.mjs","/home/alex/src/strudel/packages/codemirror/index.mjs","/home/alex/src/strudel/packages/codemirror/keybindings.mjs","/home/alex/src/strudel/packages/codemirror/slider.mjs","/home/alex/src/strudel/packages/codemirror/themes/CutiePi.mjs","/home/alex/src/strudel/packages/codemirror/themes/algoboy.mjs","/home/alex/src/strudel/packages/codemirror/themes/androidstudio.mjs","/home/alex/src/strudel/packages/codemirror/themes/archBtw.mjs","/home/alex/src/strudel/packages/codemirror/themes/atomone.mjs","/home/alex/src/strudel/packages/codemirror/themes/aura.mjs","/home/alex/src/strudel/packages/codemirror/themes/bbedit.mjs","/home/alex/src/strudel/packages/codemirror/themes/blackscreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/bluescreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/bluescreenlight.mjs","/home/alex/src/strudel/packages/codemirror/themes/darcula.mjs","/home/alex/src/strudel/packages/codemirror/themes/dracula.mjs","/home/alex/src/strudel/packages/codemirror/themes/duotoneDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/duotoneLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/eclipse.mjs","/home/alex/src/strudel/packages/codemirror/themes/fruitDaw.mjs","/home/alex/src/strudel/packages/codemirror/themes/githubDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/githubLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/green-text.mjs","/home/alex/src/strudel/packages/codemirror/themes/gruvboxDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/gruvboxLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/materialDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/materialLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/monokai.mjs","/home/alex/src/strudel/packages/codemirror/themes/noctisLilac.mjs","/home/alex/src/strudel/packages/codemirror/themes/nord.mjs","/home/alex/src/strudel/packages/codemirror/themes/red-text.mjs","/home/alex/src/strudel/packages/codemirror/themes/solarizedDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/solarizedLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/sonic-pink.mjs","/home/alex/src/strudel/packages/codemirror/themes/strudel-theme.mjs","/home/alex/src/strudel/packages/codemirror/themes/sublime.mjs","/home/alex/src/strudel/packages/codemirror/themes/teletext.mjs","/home/alex/src/strudel/packages/codemirror/themes/terminal.mjs","/home/alex/src/strudel/packages/codemirror/themes/theme-helper.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokioNightStorm.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokyoNight.mjs","/home/alex/src/strudel/packages/codemirror/themes/tokyoNightDay.mjs","/home/alex/src/strudel/packages/codemirror/themes/vscodeDark.mjs","/home/alex/src/strudel/packages/codemirror/themes/vscodeLight.mjs","/home/alex/src/strudel/packages/codemirror/themes/whitescreen.mjs","/home/alex/src/strudel/packages/codemirror/themes/xcodeLight.mjs","/home/alex/src/strudel/packages/codemirror/themes.mjs","/home/alex/src/strudel/packages/codemirror/tooltip.mjs","/home/alex/src/strudel/packages/codemirror/vite.config.js","/home/alex/src/strudel/packages/codemirror/widget.mjs","/home/alex/src/strudel/packages/core/bench/pattern.bench.mjs","/home/alex/src/strudel/packages/core/clockworker.js","/home/alex/src/strudel/packages/core/controls.mjs","/home/alex/src/strudel/packages/core/cyclist.mjs","/home/alex/src/strudel/packages/core/drawLine.mjs","/home/alex/src/strudel/packages/core/euclid.mjs","/home/alex/src/strudel/packages/core/evaluate.mjs","/home/alex/src/strudel/packages/core/fraction.mjs","/home/alex/src/strudel/packages/core/hap.mjs","/home/alex/src/strudel/packages/core/index.mjs","/home/alex/src/strudel/packages/core/logger.mjs","/home/alex/src/strudel/packages/core/neocyclist.mjs","/home/alex/src/strudel/packages/core/pattern.mjs","/home/alex/src/strudel/packages/core/pick.mjs","/home/alex/src/strudel/packages/core/repl.mjs","/home/alex/src/strudel/packages/core/signal.mjs","/home/alex/src/strudel/packages/core/speak.mjs","/home/alex/src/strudel/packages/core/state.mjs","/home/alex/src/strudel/packages/core/test/controls.test.mjs","/home/alex/src/strudel/packages/core/test/drawLine.test.mjs","/home/alex/src/strudel/packages/core/test/euclid.test.js","/home/alex/src/strudel/packages/core/test/fraction.test.mjs","/home/alex/src/strudel/packages/core/test/pattern.test.mjs","/home/alex/src/strudel/packages/core/test/solmization.test.js","/home/alex/src/strudel/packages/core/test/util.test.mjs","/home/alex/src/strudel/packages/core/test/value.test.mjs","/home/alex/src/strudel/packages/core/time.mjs","/home/alex/src/strudel/packages/core/timespan.mjs","/home/alex/src/strudel/packages/core/ui.mjs","/home/alex/src/strudel/packages/core/util.mjs","/home/alex/src/strudel/packages/core/value.mjs","/home/alex/src/strudel/packages/core/vite.config.js","/home/alex/src/strudel/packages/core/zyklus.mjs","/home/alex/src/strudel/packages/csound/index.mjs","/home/alex/src/strudel/packages/csound/vite.config.js","/home/alex/src/strudel/packages/desktopbridge/index.mjs","/home/alex/src/strudel/packages/desktopbridge/loggerbridge.mjs","/home/alex/src/strudel/packages/desktopbridge/midibridge.mjs","/home/alex/src/strudel/packages/desktopbridge/oscbridge.mjs","/home/alex/src/strudel/packages/desktopbridge/utils.mjs","/home/alex/src/strudel/packages/draw/animate.mjs","/home/alex/src/strudel/packages/draw/color.mjs","/home/alex/src/strudel/packages/draw/draw.mjs","/home/alex/src/strudel/packages/draw/index.mjs","/home/alex/src/strudel/packages/draw/pianoroll.mjs","/home/alex/src/strudel/packages/draw/pitchwheel.mjs","/home/alex/src/strudel/packages/draw/spiral.mjs","/home/alex/src/strudel/packages/draw/vite.config.js","/home/alex/src/strudel/packages/embed/embed.js","/home/alex/src/strudel/packages/gamepad/gamepad.mjs","/home/alex/src/strudel/packages/gamepad/index.mjs","/home/alex/src/strudel/packages/gamepad/vite.config.js","/home/alex/src/strudel/packages/hs2js/src/hs2js.mjs","/home/alex/src/strudel/packages/hs2js/src/index.mjs","/home/alex/src/strudel/packages/hs2js/src/parser.mjs","/home/alex/src/strudel/packages/hs2js/vite.config.js","/home/alex/src/strudel/packages/hydra/hydra.mjs","/home/alex/src/strudel/packages/hydra/vite.config.js","/home/alex/src/strudel/packages/midi/index.mjs","/home/alex/src/strudel/packages/midi/midi.mjs","/home/alex/src/strudel/packages/midi/vite.config.js","/home/alex/src/strudel/packages/mini/bench/mini.bench.mjs","/home/alex/src/strudel/packages/mini/index.mjs","/home/alex/src/strudel/packages/mini/krill-parser.js","/home/alex/src/strudel/packages/mini/mini.mjs","/home/alex/src/strudel/packages/mini/test/mini.test.mjs","/home/alex/src/strudel/packages/mini/vite.config.js","/home/alex/src/strudel/packages/mondo/mondo.mjs","/home/alex/src/strudel/packages/mondo/test/mondo.test.mjs","/home/alex/src/strudel/packages/mondo/vite.config.js","/home/alex/src/strudel/packages/mondough/mondough.mjs","/home/alex/src/strudel/packages/mondough/vite.config.js","/home/alex/src/strudel/packages/motion/index.mjs","/home/alex/src/strudel/packages/motion/motion.mjs","/home/alex/src/strudel/packages/motion/vite.config.js","/home/alex/src/strudel/packages/mqtt/mqtt.mjs","/home/alex/src/strudel/packages/mqtt/vite.config.js","/home/alex/src/strudel/packages/osc/osc.mjs","/home/alex/src/strudel/packages/osc/server.js","/home/alex/src/strudel/packages/osc/superdirtoutput.js","/home/alex/src/strudel/packages/osc/tidal-sniffer.js","/home/alex/src/strudel/packages/osc/vite.config.js","/home/alex/src/strudel/packages/reference/index.mjs","/home/alex/src/strudel/packages/reference/vite.config.js","/home/alex/src/strudel/packages/repl/index.mjs","/home/alex/src/strudel/packages/repl/prebake.mjs","/home/alex/src/strudel/packages/repl/repl-component.mjs","/home/alex/src/strudel/packages/repl/vite.config.js","/home/alex/src/strudel/packages/sampler/sample-server.mjs","/home/alex/src/strudel/packages/serial/serial.mjs","/home/alex/src/strudel/packages/serial/vite.config.js","/home/alex/src/strudel/packages/soundfonts/convert.js","/home/alex/src/strudel/packages/soundfonts/fontloader.mjs","/home/alex/src/strudel/packages/soundfonts/gm.mjs","/home/alex/src/strudel/packages/soundfonts/index.mjs","/home/alex/src/strudel/packages/soundfonts/list.mjs","/home/alex/src/strudel/packages/soundfonts/sfumato.mjs","/home/alex/src/strudel/packages/soundfonts/vite.config.js","/home/alex/src/strudel/packages/superdough/audioContext.mjs","/home/alex/src/strudel/packages/superdough/dspworklet.mjs","/home/alex/src/strudel/packages/superdough/feedbackdelay.mjs","/home/alex/src/strudel/packages/superdough/fft.js","/home/alex/src/strudel/packages/superdough/helpers.mjs","/home/alex/src/strudel/packages/superdough/index.mjs","/home/alex/src/strudel/packages/superdough/logger.mjs","/home/alex/src/strudel/packages/superdough/noise.mjs","/home/alex/src/strudel/packages/superdough/ola-processor.js","/home/alex/src/strudel/packages/superdough/reverb.mjs","/home/alex/src/strudel/packages/superdough/reverbGen.mjs","/home/alex/src/strudel/packages/superdough/sampler.mjs","/home/alex/src/strudel/packages/superdough/superdough.mjs","/home/alex/src/strudel/packages/superdough/superdoughoutput.mjs","/home/alex/src/strudel/packages/superdough/synth.mjs","/home/alex/src/strudel/packages/superdough/util.mjs","/home/alex/src/strudel/packages/superdough/vite.config.js","/home/alex/src/strudel/packages/superdough/vowel.mjs","/home/alex/src/strudel/packages/superdough/wavetable.mjs","/home/alex/src/strudel/packages/superdough/worklets.mjs","/home/alex/src/strudel/packages/superdough/zzfx.mjs","/home/alex/src/strudel/packages/superdough/zzfx_fork.mjs","/home/alex/src/strudel/packages/supradough/dough-export.mjs","/home/alex/src/strudel/packages/supradough/dough-worklet.mjs","/home/alex/src/strudel/packages/supradough/dough.mjs","/home/alex/src/strudel/packages/supradough/index.mjs","/home/alex/src/strudel/packages/tidal/tidal.mjs","/home/alex/src/strudel/packages/tonal/index.mjs","/home/alex/src/strudel/packages/tonal/ireal.mjs","/home/alex/src/strudel/packages/tonal/test/tonal.test.mjs","/home/alex/src/strudel/packages/tonal/test/tonleiter.test.mjs","/home/alex/src/strudel/packages/tonal/tonal.mjs","/home/alex/src/strudel/packages/tonal/tonleiter.mjs","/home/alex/src/strudel/packages/tonal/vite.config.js","/home/alex/src/strudel/packages/tonal/voicings.mjs","/home/alex/src/strudel/packages/transpiler/index.mjs","/home/alex/src/strudel/packages/transpiler/test/transpiler.test.mjs","/home/alex/src/strudel/packages/transpiler/transpiler.mjs","/home/alex/src/strudel/packages/transpiler/vite.config.js","/home/alex/src/strudel/packages/vite-plugin-bundle-audioworklet/vite-plugin-bundle-audioworklet.js","/home/alex/src/strudel/packages/web/vite.config.js","/home/alex/src/strudel/packages/web/web.mjs","/home/alex/src/strudel/packages/webaudio/index.mjs","/home/alex/src/strudel/packages/webaudio/scope.mjs","/home/alex/src/strudel/packages/webaudio/spectrum.mjs","/home/alex/src/strudel/packages/webaudio/supradough.mjs","/home/alex/src/strudel/packages/webaudio/vite.config.js","/home/alex/src/strudel/packages/webaudio/webaudio.mjs","/home/alex/src/strudel/packages/xen/index.mjs","/home/alex/src/strudel/packages/xen/test/xen.test.mjs","/home/alex/src/strudel/packages/xen/tune.mjs","/home/alex/src/strudel/packages/xen/tunejs.js","/home/alex/src/strudel/packages/xen/vite.config.js","/home/alex/src/strudel/packages/xen/xen.mjs"]}]`),b2={docs:She};let Che=n=>{const e=document.createElement("template");return e.innerHTML=n.trim(),e.content.childNodes},cD=n=>Array.isArray(n)?n.flat().join(""):n===void 0?"":n,Phe=(n,...e)=>{let t="";for(let s in n)t+=cD(n[s]),t+=cD(e[s]);return Che(t)};const Ahe=n=>{const e=document.createElement("div");return e.innerText=n,e.innerHTML},Ehe=n=>{const e=document.createElement("div");return e.innerHTML=n,e.textContent||e.innerText||""},gv=n=>n.name||n.longname,Mhe=n=>n!=null&&n.length?`
    <div class="autocomplete-info-params-section">
      <h4 class="autocomplete-info-section-title">Parameters</h4>
      <ul class="autocomplete-info-params-list">
        ${n.map(({name:e,type:t,description:s})=>{var r;return`
          <li class="autocomplete-info-param-item">
            <span class="autocomplete-info-param-name">${e}</span>
            <span class="autocomplete-info-param-type">${(r=t.names)==null?void 0:r.join(" | ")}</span>
            ${s?`<div class="autocomplete-info-param-desc">${Ehe(s)}</div>`:""}
          </li>
        `}).join("")}
      </ul>
    </div>
  `:"",Dhe=n=>n!=null&&n.length?`
    <div class="autocomplete-info-examples-section">
      <h4 class="autocomplete-info-section-title">Examples</h4>
      ${n.map(e=>`
        <pre class="autocomplete-info-example-code">${Ahe(e)}</pre>
      `).join("")}
    </div>
  `:"",oN=n=>Phe`
  <div class="autocomplete-info-container">
    <div class="autocomplete-info-tooltip">
      <h3 class="autocomplete-info-function-name">${gv(n)}</h3>
      ${n.synonyms_text?`<div class="autocomplete-info-function-synonyms">Synonyms: ${n.synonyms_text}</div>`:""}
      ${n.description?`<div class="autocomplete-info-function-description">${n.description}</div>`:""}
      ${Mhe(n.params)}
      ${Dhe(n.examples)}
    </div>
  </div>
`[0],The=n=>{const e=gv(n);return e&&!e.startsWith("_")&&!["package"].includes(n.kind)},Bhe=n=>["superdirtOnly","noAutocomplete"].some(e=>{var t;return(t=n.tags)==null?void 0:t.find(s=>s.originalTitle===e)});function Fhe(){const n=e9.get(),e=new Set;for(const t of Object.keys(n)){const[s,r]=t.split("_");r&&s&&e.add(s)}return Array.from(e).sort().map(t=>({label:t,type:"bank"}))}let lN=[];try{lN=(_o.names?_o.names():[]).map(n=>({label:n,type:"scale"}))}catch(n){console.warn("[autocomplete] Could not load scale names from Tonal:",n)}const $he=[{label:"below",type:"mode"},{label:"above",type:"mode"},{label:"duck",type:"mode"},{label:"root",type:"mode"}],Nhe=["",...Object.keys(lh)].sort(),_he=Nhe.map(n=>n===""?{label:"major",apply:"",type:"chord-symbol"}:{label:n,apply:n,type:"chord-symbol"}),cN=(n,e)=>{const t=n.synonyms||[],s=[gv(n),...t].filter(r=>r&&r!==e);return{...n,name:e,longname:e,synonyms:s,synonyms_text:s.join(", ")}},Rhe=(()=>{const n=new Set,e=[];for(const t of b2.docs){if(!The(t)||Bhe(t))continue;const s=gv(t),r=t.synonyms||[];let a=[s,...r];for(const i of a)i&&!n.has(i)&&(n.add(i),e.push({label:i,info:()=>oN(cN(t,i)),type:"function"}))}return e})(),Ey=["C","C#","Db","D","D#","Eb","E","E#","Fb","F","F#","Gb","G","G#","Ab","A","A#","Bb","B","B#","Cb"],Ihe=/scale\(\s*$/,Lhe=/scale\(\s*['"][^'"]*:[^'"]*$/,Qhe=/scale\(\s*['"][^'"]*$/,jhe=/([A-Ga-g][#b]*)?$/,Vhe=/\s+/g;function Zhe(n){let e=n.matchBefore(Ihe);if(e)return{from:e.to,options:[]};let t=n.matchBefore(Lhe);if(t){const r=t.text,a=r.lastIndexOf(":");if(a!==-1){const i=r.slice(a+1),o=lN.filter(l=>l.label.startsWith(i)).map(l=>({...l,apply:l.label.replace(Vhe,":")}));return{from:t.from+a+1,options:o}}}let s=n.matchBefore(Qhe);if(s&&!s.text.includes(":"))if(n.explicit){const r=s.text.match(jhe),a=r?r[0]:"",i=Ey.filter(c=>c.toLowerCase().startsWith(a.toLowerCase())),o=s.to-a.length,l=i.map(c=>({label:c,type:"pitch"}));return{from:o,options:l}}else return{from:s.to,options:[]};return null}const zhe=/(s|sound)\(\s*$/,qhe=/(s|sound)\(\s*['"][^'"]*$/,Uhe=/(?:[\s[{(<])([\w]*)$/;function Whe(n){let e=n.matchBefore(zhe);if(e)return{from:e.to,options:[]};let t=n.matchBefore(qhe);if(!t)return null;const s=t.text,r=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(r===-1)return null;const a=s.slice(r+1),i=a.match(Uhe),o=i?i[1]:a;let l=Object.keys(e9.get()).sort().filter(c=>c.includes(o)).map(c=>({label:c,type:"sound"}));return{from:t.to-o.length,options:l}}const Ghe=/bank\(\s*$/,Xhe=/bank\(\s*['"][^'"]*$/;function Hhe(n){let e=n.matchBefore(Ghe);if(e)return{from:e.to,options:[]};let t=n.matchBefore(Xhe);if(!t)return null;const s=t.text,r=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(r===-1)return null;const a=s.slice(r+1),i=Fhe().filter(o=>o.label.startsWith(a));return{from:t.to-a.length,options:i}}const Yhe=/mode\(\s*$/,Khe=/mode\(\s*['"][^'"]*:[^'"]*$/,Jhe=/mode\(\s*['"][^'"]*$/,ede=/(?:[\s[{(<])([\w:]*)$/;function tde(n){let e=n.matchBefore(Yhe);if(e)return{from:e.to,options:[]};let t=n.matchBefore(Khe);if(t){const u=t.text,h=u.lastIndexOf(":");if(h!==-1){const d=u.slice(h+1),m=Ey.filter(y=>y.toLowerCase().startsWith(d.toLowerCase())).map(y=>({label:y,type:"pitch"}));return{from:t.from+h+1,options:m}}}let s=n.matchBefore(Jhe);if(!s)return null;const r=s.text,a=Math.max(r.lastIndexOf('"'),r.lastIndexOf("'"));if(a===-1)return null;const i=r.slice(a+1),o=i.match(ede),l=o?o[1]:i,c=$he.filter(u=>u.label.startsWith(l));return{from:s.to-l.length,options:c}}const nde=/chord\(\s*$/,sde=/chord\(\s*['"][^'"]*$/,rde=/(?:[\s[{(<])([\w#b+^:-]*)$/;function ade(n){let e=n.matchBefore(nde);if(e)return{from:e.to,options:[]};let t=n.matchBefore(sde);if(!t)return null;const s=t.text,r=Math.max(s.lastIndexOf('"'),s.lastIndexOf("'"));if(r===-1)return null;const a=s.slice(r+1),i=a.match(rde),o=i?i[1]:a;let l=null,c=o;for(const u of Ey)if(o.toLowerCase().startsWith(u.toLowerCase())){l=u,c=o.slice(u.length);break}if(l){const u=_he.filter(h=>h.label.toLowerCase().startsWith(c.toLowerCase()));return{from:t.to-c.length,options:u}}else{const u=Ey.filter(h=>h.toLowerCase().startsWith(o.toLowerCase())).map(h=>({label:h,type:"pitch"}));return{from:t.to-o.length,options:u}}}const ide=/\w*/;function ode(n){const e=n.matchBefore(ide);return e&&e.from===e.to&&!n.explicit?null:e?{from:e.from,options:Rhe}:null}const lde=[Whe,Hhe,ade,Zhe,tde,ode],cde=n=>{for(const e of lde){const t=e(n);if(t)return t}return null},ude=n=>n?[iie({override:[cde],closeOnBlur:!1})]:[],hde=n=>n.name||n.longname;let y2=!1;typeof window<"u"&&(window.addEventListener("keyup",function(n){n.key=="Control"&&(y2=!1)},!0),window.addEventListener("keydown",function(n){n.key=="Control"&&(y2=!0)},!0));const dde=IF((n,e,t)=>{if(!y2)return null;let{from:s,to:r,text:a}=n.state.doc.lineAt(e),i=e,o=e;for(;i>s&&/\w/.test(a[i-s-1]);)i--;for(;o<r&&/\w/.test(a[o-s]);)o++;if(i==e&&t<0||o==e&&t>0)return null;let l=a.slice(i-s,o-s),c=b2.docs.filter(u=>hde(u)===l)[0];if(!c){const u=b2.docs.filter(h=>h.synonyms&&h.synonyms.includes(l))[0];if(!u)return null;c=cN(u,l)}return{pos:i,end:o,above:!1,arrow:!0,create(u){let h=document.createElement("div");h.className="strudel-tooltip";const d=oN(c);return h.appendChild(d),{dom:h}}}},{hoverTime:10}),pde=n=>n?dde:[],mde=rn.define(),fde=qs.define({create(){return At.none},update(n,e){try{for(let t of e.effects)if(t.is(mde))if(t.value&&e.newDoc.length>0){const s=At.mark({attributes:{style:"background-color: rgba(255,255,255, .4); filter: invert(10%)"}});n=At.set([s.range(0,e.newDoc.length)])}else n=At.set([]);return n}catch(t){return console.warn("flash error",t),n}},provide:n=>lt.decorations.from(n)}),gde=n=>n?fde:[],uN=rn.define(),hN=rn.define(),bde=(n,e)=>{n.dispatch({effects:uN.of(e)})},gw=(n,e,t)=>{n.dispatch({effects:hN.of({atTime:e,haps:t})})},v2=qs.define({create(){return At.none},update(n,e){e.docChanged&&(n=n.map(e.changes));for(let t of e.effects)if(t.is(uN)){const s=t.value.filter(([r])=>r<e.newDoc.length).map(([r,a])=>[r,Math.min(a,e.newDoc.length)]).map(r=>At.mark({id:r.join(":"),attributes:{style:"background-color: #00CA2880"}}).range(...r));n=At.set(s,!0)}return n}}),O2=qs.define({create(){return{atTime:0,haps:new Map}},update(n,e){var t;for(let s of e.effects)if(s.is(hN)){const r=new Map;for(let a of s.value.haps)if(!(!((t=a.context)!=null&&t.locations)||!a.whole))for(let{start:i,end:o}of a.context.locations){let l=`${i}:${o}`;(!r.has(l)||r.get(l).whole.begin.lt(a.whole.begin))&&r.set(l,a)}n={atTime:s.value.atTime,haps:r}}return n}}),yde=lt.decorations.compute([v2,O2],n=>{var r,a;const e=n.field(v2).iter(),{haps:t}=n.field(O2),s=new qo;for(;e.value;){const{from:i,to:o,value:{spec:{id:l}}}=e;if(t.has(l)){const c=t.get(l),u=((r=c.value)==null?void 0:r.color)??"var(--foreground)",h=((a=c.value)==null?void 0:a.markcss)||`outline: solid 2px ${u}`;s.add(i,o,At.mark({attributes:{style:h}}))}e.next()}return s.finish()}),vde=[v2,O2,yde],w2=(n,e)=>(n&&e&&setTimeout(()=>{bde(e.editor,e.miniLocations)},100),n?Fi.highest(vde):[]),Ode=Ns.fromClass(class{constructor(){}},{provide:()=>Fi.highest(Pc.of([...Nce]))}),wde=n=>[Ode].concat(n??[]),xde={vim:bce,emacs:jle,codemirror:()=>Pc.of(cv),vscode:wde};function kde(n){const e=xde[n];return[e?Fi.high(e()):[]]}const $n=({theme:n,settings:e,styles:t})=>{const s=lt.theme({"&":{color:e.foreground,backgroundColor:e.background},".cm-gutters":{backgroundColor:e.gutterBackground,color:e.gutterForeground},".cm-content":{caretColor:e.caret},".cm-cursor, .cm-dropCursor":{borderLeftColor:e.caret},".cm-activeLineGutter":{backgroundColor:e.lineHighlight},".cm-activeLine":{backgroundColor:e.lineHighlight},"&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection":{background:e.selection+" !important"},"& .cm-selectionMatch":{backgroundColor:e.selectionMatch}},{dark:n==="dark"}),r=np.define(t);return[s,nv(r)]},Sde={background:"#222",foreground:"#fff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},Cde=$n({theme:"dark",settings:Sde,styles:[{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#89ddff"},{tag:g.labelName,color:"#89ddff"},{tag:g.keyword,color:"#c792ea"},{tag:g.operator,color:"#89ddff"},{tag:g.special(g.variableName),color:"#eeffff"},{tag:g.typeName,color:"#c3e88d"},{tag:g.atom,color:"#f78c6c"},{tag:g.number,color:"#c3e88d"},{tag:g.definition(g.variableName),color:"#82aaff"},{tag:g.string,color:"#c3e88d"},{tag:g.special(g.string),color:"#c3e88d"},{tag:g.comment,color:"#7d8799"},{tag:g.variableName,color:"#c792ea"},{tag:g.tagName,color:"#c3e88d"},{tag:g.bracket,color:"#525154"},{tag:g.meta,color:"#ffcb6b"},{tag:g.attributeName,color:"#c792ea"},{tag:g.propertyName,color:"#c792ea"},{tag:g.className,color:"#decb6b"},{tag:g.invalid,color:"#ffffff"},{tag:[g.unit,g.punctuation],color:"#82aaff"}]}),Pde={background:"#051DB5",foreground:"white",caret:"white",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},Ade=$n({theme:"dark",settings:Pde,styles:[{tag:g.labelName,color:"inherit"},{tag:g.keyword,color:"inherit"},{tag:g.operator,color:"inherit"},{tag:g.special(g.variableName),color:"inherit"},{tag:g.typeName,color:"inherit"},{tag:g.atom,color:"inherit"},{tag:g.number,color:"inherit"},{tag:g.definition(g.variableName),color:"inherit"},{tag:g.string,color:"inherit"},{tag:g.special(g.string),color:"inherit"},{tag:g.comment,color:"inherit"},{tag:g.variableName,color:"inherit"},{tag:g.tagName,color:"inherit"},{tag:g.bracket,color:"inherit"},{tag:g.meta,color:"inherit"},{tag:g.attributeName,color:"inherit"},{tag:g.propertyName,color:"inherit"},{tag:g.className,color:"inherit"},{tag:g.invalid,color:"inherit"},{tag:[g.unit,g.punctuation],color:"inherit"}]}),Ede={background:"black",foreground:"white",caret:"white",selection:"#ffffff20",selectionMatch:"#036dd626",lineHighlight:"#ffffff10",gutterBackground:"transparent",gutterForeground:"#8a919966"},Mde=$n({theme:"dark",settings:Ede,styles:[{tag:g.labelName,color:"inherit"},{tag:g.keyword,color:"inherit"},{tag:g.operator,color:"inherit"},{tag:g.special(g.variableName),color:"inherit"},{tag:g.typeName,color:"inherit"},{tag:g.atom,color:"inherit"},{tag:g.number,color:"inherit"},{tag:g.definition(g.variableName),color:"inherit"},{tag:g.string,color:"inherit"},{tag:g.special(g.string),color:"inherit"},{tag:g.comment,color:"inherit"},{tag:g.variableName,color:"inherit"},{tag:g.tagName,color:"inherit"},{tag:g.bracket,color:"inherit"},{tag:g.meta,color:"inherit"},{tag:g.attributeName,color:"inherit"},{tag:g.propertyName,color:"inherit"},{tag:g.className,color:"inherit"},{tag:g.invalid,color:"inherit"},{tag:[g.unit,g.punctuation],color:"inherit"}]}),Dde={background:"white",foreground:"black",caret:"black",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#ffffff26",lineHighlight:"#cccccc50",gutterBackground:"transparent",gutterForeground:"black"},Tde=$n({theme:"light",settings:Dde,styles:[{tag:g.labelName,color:"inherit"},{tag:g.keyword,color:"inherit"},{tag:g.operator,color:"inherit"},{tag:g.special(g.variableName),color:"inherit"},{tag:g.typeName,color:"inherit"},{tag:g.atom,color:"inherit"},{tag:g.number,color:"inherit"},{tag:g.definition(g.variableName),color:"inherit"},{tag:g.string,color:"inherit"},{tag:g.special(g.string),color:"inherit"},{tag:g.comment,color:"inherit"},{tag:g.variableName,color:"inherit"},{tag:g.tagName,color:"inherit"},{tag:g.bracket,color:"inherit"},{tag:g.meta,color:"inherit"},{tag:g.attributeName,color:"inherit"},{tag:g.propertyName,color:"inherit"},{tag:g.className,color:"inherit"},{tag:g.invalid,color:"inherit"}]});let ki="#6edee4",dN="white",pN="red",mN="#f8fc55";const Bde={background:"#000000",foreground:ki,caret:pN,selection:mN,selectionMatch:ki,lineHighlight:"#6edee440",gutterBackground:"transparent",gutterForeground:"#8a919966"};let bw=mN,Wg=dN;const Fde=$n({theme:"dark",settings:Bde,styles:[{tag:g.labelName,color:dN},{tag:g.keyword,color:ki},{tag:g.operator,color:Wg},{tag:g.special(g.variableName),color:ki},{tag:g.typeName,color:ki},{tag:g.atom,color:ki},{tag:g.number,color:Wg},{tag:g.definition(g.variableName),color:ki},{tag:g.string,color:Wg},{tag:g.special(g.string),color:Wg},{tag:g.comment,color:bw},{tag:g.variableName,color:ki},{tag:g.tagName,color:ki},{tag:g.bracket,color:bw},{tag:g.meta,color:ki},{tag:g.attributeName,color:ki},{tag:g.propertyName,color:ki},{tag:g.className,color:ki},{tag:g.invalid,color:pN},{tag:[g.unit,g.punctuation],color:bw}]}),$de={"Sour Watermelon B":["#996666","#6B4747","#3D2929","#0F0A0A"]},ma=$de["Sour Watermelon B"],Nde={background:ma[3],foreground:ma[1],caret:ma[0],selection:ma[0],selectionMatch:ma[1],lineHighlight:ma[3],gutterBackground:"transparent",gutterForeground:ma[0]},_de=$n({theme:"dark",settings:Nde,styles:[{tag:g.comment,color:ma[2]},{tag:g.string,color:ma[1]},{tag:[g.atom,g.number],color:ma[1]},{tag:[g.meta,g.labelName,g.variableName],color:ma[0]},{tag:[g.keyword,g.tagName,g.arithmeticOperator],color:ma[1]},{tag:[g.atom,g.bool,g.special(g.variableName)],color:ma[0]},{tag:[g.function(g.variableName),g.propertyName],color:ma[0]},{tag:g.atom,color:ma[1]}]}),x2="#5c019a",Rde="#fbeffc",fN="#272C35",Ide="#fee1ff",Lde="#465063",Qde="#9acd3f",jde="#97a1b7",Vde="#f6a6fd",uD={background:"white",foreground:x2,caret:"#797977",selection:Rde,selectionMatch:"#2B323D",gutterBackground:fN,gutterForeground:Lde,lineHighlight:Ide},Zde=$n({theme:"light",settings:uD,styles:[{tag:[g.function(g.variableName),g.function(g.propertyName),g.url,g.processingInstruction],color:x2},{tag:[g.tagName,g.heading],color:uD.foreground},{tag:g.comment,color:jde},{tag:[g.variableName,g.propertyName,g.labelName],color:Vde},{tag:[g.attributeName,g.number],color:"#d19a66"},{tag:g.className,color:fN},{tag:g.keyword,color:x2},{tag:[g.string,g.regexp,g.special(g.propertyName)],color:Qde}]}),To=["#1e1e1e","#fbde2d","#ff1493","#4c83ff","#ededed","#cccccc","#ffffff30","#dc2f8c"],zde={background:"#000000",foreground:To[4],selection:To[6],gutterBackground:To[0],gutterForeground:To[5],lineHighlight:To[0]},qde=$n({theme:"dark",settings:zde,styles:[{tag:[g.function(g.variableName),g.function(g.propertyName),g.url,g.processingInstruction],color:To[4]},{tag:[g.atom,g.bool,g.special(g.variableName)],color:To[3]},{tag:g.comment,color:"#54636D"},{tag:[g.variableName,g.propertyName,g.labelName],color:To[4]},{tag:[g.attributeName,g.number],color:To[3]},{tag:g.keyword,color:To[1]},{tag:[g.string,g.regexp,g.special(g.propertyName)],color:To[2]}]}),ja=["#000000","#ff5356","#bd312a","#54636D","#171717"],Ude={background:ja[0],foreground:ja[2],selection:ja[4],selectionMatch:ja[0],gutterBackground:ja[0],gutterForeground:ja[3],lineHighlight:ja[0]},Wde=$n({theme:"dark",settings:Ude,styles:[{tag:[g.function(g.variableName),g.function(g.propertyName),g.url,g.processingInstruction],color:ja[2]},{tag:[g.atom,g.bool,g.special(g.variableName)],color:ja[1]},{tag:g.comment,color:ja[3]},{tag:[g.variableName,g.propertyName,g.labelName],color:ja[2]},{tag:[g.attributeName,g.number],color:ja[1]},{tag:g.keyword,color:ja[2]},{tag:[g.string,g.regexp,g.special(g.propertyName)],color:ja[1]}]}),Va=["#000000","#8ed675","#56bd2a","#54636D","#171717"],Gde={background:Va[0],foreground:Va[2],selection:Va[4],selectionMatch:Va[0],gutterBackground:Va[0],gutterForeground:Va[3],lineHighlight:Va[0]},Xde=$n({theme:"dark",settings:Gde,styles:[{tag:[g.function(g.variableName),g.function(g.propertyName),g.url,g.processingInstruction],color:Va[2]},{tag:[g.atom,g.bool,g.special(g.variableName)],color:Va[1]},{tag:g.comment,color:Va[3]},{tag:[g.variableName,g.propertyName,g.labelName],color:Va[2]},{tag:[g.attributeName,g.number],color:Va[1]},{tag:g.keyword,color:Va[2]},{tag:[g.string,g.regexp,g.special(g.propertyName)],color:Va[1]}]}),Za=["rgb(0, 0, 0)","rgb(82, 208, 250)","rgba(113, 208, 250, .4)","rgba(113, 208, 250, .15)"],Hde={background:Za[0],foreground:Za[1],selection:Za[2],selectionMatch:Za[0],gutterBackground:Za[0],gutterForeground:Za[2],lineHighlight:Za[0]},Yde=$n({theme:"dark",settings:Hde,styles:[{tag:[g.function(g.variableName),g.function(g.propertyName),g.url,g.processingInstruction],color:Za[1]},{tag:[g.atom,g.bool,g.special(g.variableName)],color:Za[1]},{tag:[g.comment,g.brace,g.bracket],color:Za[2]},{tag:[g.variableName,g.propertyName,g.labelName],color:Za[1]},{tag:[g.attributeName,g.number],color:Za[1]},{tag:g.keyword,color:Za[1]},{tag:[g.string,g.regexp,g.special(g.propertyName)],color:Za[1]}]}),fa=["rgb(84, 93, 98)","rgb(255, 255, 255)","rgba(255, 255, 255, .25)","rgb(67, 76, 81)","rgb(186, 230, 115)","rgb(252, 184, 67)","rgb(124, 206, 254)","rgb(83, 101, 102)","rgba(46, 62, 72,.5)","rgb(94, 100, 108)","rgb(167, 216, 177)"],Kde={background:fa[0],foreground:fa[10],selection:fa[8],selectionMatch:fa[0],gutterBackground:fa[3],gutterForeground:fa[2],lineHighlight:fa[3]},Jde=$n({theme:"dark",settings:Kde,styles:[{tag:[g.function(g.variableName),g.function(g.propertyName),g.url,g.processingInstruction],color:fa[1]},{tag:[g.bool,g.special(g.variableName)],color:fa[1]},{tag:[g.comment,g.brace,g.bracket],color:fa[2]},{tag:[g.variableName],color:fa[1]},{tag:[g.labelName,g.propertyName,g.self,g.atom],color:fa[5]},{tag:[g.attributeName,g.number],color:fa[6]},{tag:g.keyword,color:fa[5]},{tag:[g.string,g.regexp,g.special(g.propertyName)],color:fa[4]}]}),za=["rgb(75, 130, 247)","rgb(47, 108, 246)","rgb(255, 255, 255)","rgba(255, 255, 255,.3)"],epe={background:za[0],foreground:za[2],selection:za[3],selectionMatch:za[0],gutterBackground:za[0],gutterForeground:za[2],lineHighlight:za[1]},tpe=$n({theme:"dark",settings:epe,styles:[{tag:[g.function(g.variableName),g.function(g.propertyName),g.url,g.processingInstruction],color:za[2]},{tag:[g.atom,g.bool,g.special(g.variableName)],color:za[2]},{tag:[g.comment,g.bracket,g.brace,g.compareOperator],color:za[3]},{tag:[g.variableName,g.propertyName,g.labelName],color:za[2]},{tag:[g.attributeName,g.number],color:za[2]},{tag:g.keyword,color:za[2]},{tag:[g.string,g.regexp,g.special(g.propertyName)],color:za[2]}]}),npe=$n({theme:"dark",settings:{background:"#282b2e",foreground:"#a9b7c6",caret:"#00FF00",selection:"#4e5254",selectionMatch:"#4e5254",gutterForeground:"#cccccc50",lineHighlight:"#7f85891f"},styles:[{tag:g.labelName,color:"inherit"},{tag:[g.keyword,g.deleted,g.className],color:"#a9b7c6"},{tag:[g.number,g.literal],color:"#6897bb"},{tag:[g.link,g.variableName],color:"#a9b7c6"},{tag:[g.comment,g.quote],color:"grey"},{tag:[g.meta,g.documentMeta],color:"#bbb529"},{tag:[g.propertyName,g.attributeValue],color:"#a9b7c6"},{tag:[g.string],color:"#6a8759"},{tag:[g.heading,g.typeName],color:"#ffc66d"},{tag:[g.attributeName],color:"#a9b7c6"},{tag:[g.emphasis],fontStyle:"italic"}]}),spe=$n({theme:"dark",settings:{background:"#272C35",foreground:"#9d9b97",caret:"#797977",selection:"#3d4c64",selectionMatch:"#3d4c64",gutterBackground:"#272C35",gutterForeground:"#465063",lineHighlight:"#2e3f5940"},styles:[{tag:[g.function(g.variableName),g.function(g.propertyName),g.url,g.processingInstruction],color:"hsl(207, 82%, 66%)"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"hsl( 29, 54%, 61%)"},{tag:[g.tagName,g.heading],color:"#e06c75"},{tag:g.comment,color:"#54636D"},{tag:[g.variableName,g.propertyName,g.labelName],color:"hsl(220, 14%, 71%)"},{tag:[g.attributeName,g.number],color:"hsl( 29, 54%, 61%)"},{tag:g.className,color:"hsl( 39, 67%, 69%)"},{tag:g.keyword,color:"hsl(286, 60%, 67%)"},{tag:[g.string,g.regexp,g.special(g.propertyName)],color:"#98c379"}]}),rpe=$n({theme:"dark",settings:{background:"#21202e",foreground:"#edecee",caret:"#a277ff",selection:"#5a51898f",selectionMatch:"#5a51898f",gutterBackground:"#21202e",gutterForeground:"#edecee",lineHighlight:"#a394f033"},styles:[{tag:g.keyword,color:"#a277ff"},{tag:[g.name,g.deleted,g.character,g.macroName],color:"#edecee"},{tag:[g.propertyName],color:"#ffca85"},{tag:[g.processingInstruction,g.string,g.inserted,g.special(g.string)],color:"#61ffca"},{tag:[g.function(g.variableName),g.labelName],color:"#ffca85"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#61ffca"},{tag:[g.definition(g.name),g.separator],color:"#edecee"},{tag:[g.className],color:"#82e2ff"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#61ffca"},{tag:[g.typeName],color:"#82e2ff"},{tag:[g.operator,g.operatorKeyword],color:"#a277ff"},{tag:[g.url,g.escape,g.regexp,g.link],color:"#61ffca"},{tag:[g.meta,g.comment],color:"#6d6d6d"},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.link,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:"#a277ff"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#edecee"},{tag:g.invalid,color:"#ff6767"},{tag:g.strikethrough,textDecoration:"line-through"}]}),ape=$n({theme:"dark",settings:{background:"#242424",foreground:"#f8f8f2",caret:"#FFFFFF",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"transparent",gutterForeground:"#999",lineHighlight:"rgba(255, 255, 255, 0.1)"},styles:[{tag:g.labelName,color:"#CCCCCC"},{tag:[g.atom,g.number],color:"#7A9EC2"},{tag:[g.comment],color:"#707070"},{tag:[g.string],color:"#6A8759"},{tag:[g.variableName,g.operator],color:"#CCCCCC"},{tag:[g.function(g.variableName),g.propertyName],color:"#FFC66D"},{tag:[g.meta,g.className],color:"#FFC66D"},{tag:[g.propertyName],color:"#FFC66D"},{tag:[g.keyword],color:"#CC7832"},{tag:[g.tagName],color:"#ff79c6"},{tag:[g.typeName],color:"#ffb86c"}]}),ipe="#BD93F9",ope=$n({theme:"dark",settings:{background:"#282a36",foreground:"#f8f8f2",caret:"#f8f8f0",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"#282a36",gutterForeground:"#6272a4",lineHighlight:"rgba(255, 255, 255, 0.1)"},styles:[{tag:g.comment,color:"#6272a4"},{tag:g.string,color:"#f1fa8c"},{tag:[g.atom,g.number],color:ipe},{tag:[g.meta,g.labelName,g.variableName],color:"#f8f8f2"},{tag:[g.keyword,g.tagName,g.arithmeticOperator],color:"#ff79c6"},{tag:[g.function(g.variableName),g.propertyName],color:"#50fa7b"},{tag:g.atom,color:"#bd93f9"}]}),lpe=$n({theme:"dark",settings:{background:"#2a2734",foreground:"#6c6783",caret:"#ffad5c",selection:"#9a86fd",selectionMatch:"#9a86fd",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},styles:[{tag:[g.comment,g.bracket,g.operator],color:"#6c6783"},{tag:[g.atom,g.number,g.keyword,g.link,g.attributeName,g.quote],color:"#ffcc99"},{tag:[g.emphasis,g.heading,g.tagName,g.propertyName,g.className,g.variableName],color:"#eeebff"},{tag:[g.typeName,g.url],color:"#eeebff"},{tag:g.string,color:"#ffb870"},{tag:[g.propertyName],color:"#eeebff"},{tag:g.labelName,color:"#eeebff"}]}),cpe=$n({theme:"light",settings:{background:"#fff",foreground:"#000",caret:"#FFFFFF",selection:"#d7d4f0",selectionMatch:"#d7d4f0",gutterBackground:"#f7f7f7",gutterForeground:"#999",lineHighlight:"#006fff1c"},styles:[{tag:[g.comment],color:"#3F7F5F"},{tag:[g.documentMeta],color:"#FF1717"},{tag:g.keyword,color:"#7F0055",fontWeight:"bold"},{tag:g.atom,color:"#00f"},{tag:g.number,color:"#164"},{tag:g.propertyName,color:"#164"},{tag:[g.variableName,g.definition(g.variableName)],color:"#0000C0"},{tag:g.function(g.variableName),color:"#0000C0"},{tag:g.string,color:"#2A00FF"},{tag:g.operator,color:"black"},{tag:g.tagName,color:"#170"},{tag:g.attributeName,color:"#00c"},{tag:g.link,color:"#219"}]}),upe=$n({theme:"dark",settings:{background:"#0d1117",foreground:"#c9d1d9",caret:"#c9d1d9",selection:"#003d73",selectionMatch:"#003d73",lineHighlight:"#36334280"},styles:[{tag:g.labelName,color:"#d2a8ff"},{tag:[g.standard(g.tagName),g.tagName],color:"#7ee787"},{tag:[g.comment,g.bracket],color:"#8b949e"},{tag:[g.className,g.propertyName],color:"#d2a8ff"},{tag:[g.variableName,g.attributeName],color:"#d2a8ff"},{tag:[g.number,g.operator],color:"#79c0ff"},{tag:[g.keyword,g.typeName,g.typeOperator,g.typeName],color:"#ff7b72"},{tag:[g.string,g.meta,g.regexp],color:"#a5d6ff"},{tag:[g.name,g.quote],color:"#7ee787"},{tag:[g.heading,g.strong],color:"#d2a8ff",fontWeight:"bold"},{tag:[g.emphasis],color:"#d2a8ff",fontStyle:"italic"},{tag:[g.deleted],color:"#ffdcd7",backgroundColor:"ffeef0"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#ffab70"},{tag:g.link,textDecoration:"underline"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.invalid,color:"#f97583"}]}),hpe=$n({theme:"light",settings:{background:"#fff",foreground:"#24292e",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#6e7781"},styles:[{tag:[g.standard(g.tagName),g.tagName],color:"#116329"},{tag:[g.comment,g.bracket],color:"#6a737d"},{tag:[g.className,g.propertyName],color:"#6f42c1"},{tag:[g.variableName,g.attributeName,g.number,g.operator],color:"#005cc5"},{tag:[g.keyword,g.typeName,g.typeOperator,g.typeName],color:"#d73a49"},{tag:[g.string,g.meta,g.regexp],color:"#032f62"},{tag:[g.name,g.quote],color:"#22863a"},{tag:[g.heading,g.strong],color:"#24292e",fontWeight:"bold"},{tag:[g.emphasis],color:"#24292e",fontStyle:"italic"},{tag:[g.deleted],color:"#b31d28",backgroundColor:"ffeef0"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#e36209"},{tag:[g.url,g.escape,g.regexp,g.link],color:"#032f62"},{tag:g.link,textDecoration:"underline"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.invalid,color:"#cb2431"}]}),dpe=$n({theme:"dark",settings:{background:"#282828",foreground:"#ebdbb2",caret:"#ebdbb2",selection:"#b99d555c",selectionMatch:"#b99d555c",lineHighlight:"#baa1602b",gutterBackground:"#282828",gutterForeground:"#7c6f64"},styles:[{tag:g.keyword,color:"#fb4934"},{tag:[g.name,g.deleted,g.character,g.propertyName,g.macroName],color:"#8ec07c"},{tag:[g.variableName],color:"#83a598"},{tag:[g.function(g.variableName)],color:"#8ec07c",fontStyle:"bold"},{tag:[g.labelName],color:"#ebdbb2"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#d3869b"},{tag:[g.definition(g.name),g.separator],color:"#ebdbb2"},{tag:[g.brace],color:"#ebdbb2"},{tag:[g.annotation],color:"#fb4934d"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#d3869b"},{tag:[g.typeName,g.className],color:"#fabd2f"},{tag:[g.operatorKeyword],color:"#fb4934"},{tag:[g.tagName],color:"#8ec07c",fontStyle:"bold"},{tag:[g.squareBracket],color:"#fe8019"},{tag:[g.angleBracket],color:"#83a598"},{tag:[g.attributeName],color:"#8ec07c"},{tag:[g.regexp],color:"#8ec07c"},{tag:[g.quote],color:"#928374"},{tag:[g.string],color:"#ebdbb2"},{tag:g.link,color:"#a89984",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[g.url,g.escape,g.special(g.string)],color:"#d3869b"},{tag:[g.meta],color:"#fabd2f"},{tag:[g.comment],color:"#928374",fontStyle:"italic"},{tag:g.strong,fontWeight:"bold",color:"#fe8019"},{tag:g.emphasis,fontStyle:"italic",color:"#b8bb26"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.heading,fontWeight:"bold",color:"#b8bb26"},{tag:[g.heading1,g.heading2],fontWeight:"bold",color:"#b8bb26"},{tag:[g.heading3,g.heading4],fontWeight:"bold",color:"#fabd2f"},{tag:[g.heading5,g.heading6],color:"#fabd2f"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#d3869b"},{tag:[g.processingInstruction,g.inserted],color:"#83a598"},{tag:[g.contentSeparator],color:"#fb4934"},{tag:g.invalid,color:"#fe8019",borderBottom:"1px dotted #fb4934d"}]}),ppe=$n({theme:"light",settings:{background:"#fbf1c7",foreground:"#3c3836",caret:"#af3a03",selection:"#bdae9391",selectionMatch:"#bdae9391",lineHighlight:"#a37f2238",gutterBackground:"#ebdbb2",gutterForeground:"#665c54"},styles:[{tag:g.keyword,color:"#9d0006"},{tag:[g.name,g.deleted,g.character,g.propertyName,g.macroName],color:"#427b58"},{tag:[g.variableName],color:"#076678"},{tag:[g.function(g.variableName)],color:"#79740e",fontStyle:"bold"},{tag:[g.labelName],color:"#3c3836"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#8f3f71"},{tag:[g.definition(g.name),g.separator],color:"#3c3836"},{tag:[g.brace],color:"#3c3836"},{tag:[g.annotation],color:"#9d0006"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#8f3f71"},{tag:[g.typeName,g.className],color:"#b57614"},{tag:[g.operator,g.operatorKeyword],color:"#9d0006"},{tag:[g.tagName],color:"#427b58",fontStyle:"bold"},{tag:[g.squareBracket],color:"#af3a03"},{tag:[g.angleBracket],color:"#076678"},{tag:[g.attributeName],color:"#427b58"},{tag:[g.regexp],color:"#427b58"},{tag:[g.quote],color:"#928374"},{tag:[g.string],color:"#3c3836"},{tag:g.link,color:"#7c6f64",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[g.url,g.escape,g.special(g.string)],color:"#8f3f71"},{tag:[g.meta],color:"#b57614"},{tag:[g.comment],color:"#928374",fontStyle:"italic"},{tag:g.strong,fontWeight:"bold",color:"#af3a03"},{tag:g.emphasis,fontStyle:"italic",color:"#79740e"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.heading,fontWeight:"bold",color:"#79740e"},{tag:[g.heading1,g.heading2],fontWeight:"bold",color:"#79740e"},{tag:[g.heading3,g.heading4],fontWeight:"bold",color:"#b57614"},{tag:[g.heading5,g.heading6],color:"#b57614"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#8f3f71"},{tag:[g.processingInstruction,g.inserted],color:"#076678"},{tag:[g.contentSeparator],color:"#9d0006"},{tag:g.invalid,color:"#af3a03",borderBottom:"1px dotted #9d0006"}]}),mpe=$n({theme:"dark",settings:{background:"#212121",foreground:"#bdbdbd",caret:"#a0a4ae",selection:"#d7d4f063",selectionMatch:"#d7d4f063",gutterBackground:"#212121",gutterForeground:"#999",lineHighlight:"#333333"},styles:[{tag:g.keyword,color:"#cf6edf"},{tag:[g.name,g.deleted,g.character,g.macroName],color:"#56c8d8"},{tag:[g.propertyName],color:"#82AAFF"},{tag:[g.variableName],color:"#bdbdbd"},{tag:[g.function(g.variableName)],color:"#82AAFF"},{tag:[g.labelName],color:"#cf6edf"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#facf4e"},{tag:[g.definition(g.name),g.separator],color:"#56c8d8"},{tag:[g.brace],color:"#cf6edf"},{tag:[g.annotation],color:"#f07178"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#f07178"},{tag:[g.typeName,g.className],color:"#f07178"},{tag:[g.operator,g.operatorKeyword],color:"#82AAFF"},{tag:[g.tagName],color:"#99d066"},{tag:[g.squareBracket],color:"#f07178"},{tag:[g.angleBracket],color:"#606f7a"},{tag:[g.attributeName],color:"#bdbdbd"},{tag:[g.regexp],color:"#f07178"},{tag:[g.quote],color:"#6abf69"},{tag:[g.string],color:"#99d066"},{tag:g.link,color:"#56c8d8",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[g.url,g.escape,g.special(g.string)],color:"#facf4e"},{tag:[g.meta],color:"#707d8b"},{tag:[g.comment],color:"#707d8b",fontStyle:"italic"},{tag:g.monospace,color:"#bdbdbd"},{tag:g.strong,fontWeight:"bold",color:"#f07178"},{tag:g.emphasis,fontStyle:"italic",color:"#99d066"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.heading,fontWeight:"bold",color:"#facf4e"},{tag:g.heading1,fontWeight:"bold",color:"#facf4e"},{tag:[g.heading2,g.heading3,g.heading4],fontWeight:"bold",color:"#facf4e"},{tag:[g.heading5,g.heading6],color:"#facf4e"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#56c8d8"},{tag:[g.processingInstruction,g.inserted],color:"#f07178"},{tag:[g.contentSeparator],color:"#56c8d8"},{tag:g.invalid,color:"#606f7a",borderBottom:"1px dotted #f07178"}]}),fpe=$n({theme:"light",settings:{background:"#FAFAFA",foreground:"#90A4AE",caret:"#272727",selection:"#80CBC440",selectionMatch:"#80CBC440",gutterBackground:"#FAFAFA",gutterForeground:"#90A4AE",lineHighlight:"#CCD7DA50"},styles:[{tag:g.keyword,color:"#39ADB5"},{tag:[g.name,g.deleted,g.character,g.macroName],color:"#90A4AE"},{tag:[g.propertyName],color:"#6182B8"},{tag:[g.processingInstruction,g.string,g.inserted,g.special(g.string)],color:"#91B859"},{tag:[g.function(g.variableName),g.labelName],color:"#6182B8"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#39ADB5"},{tag:[g.definition(g.name),g.separator],color:"#90A4AE"},{tag:[g.className],color:"#E2931D"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#F76D47"},{tag:[g.typeName],color:"#E2931D",fontStyle:"#E2931D"},{tag:[g.operator,g.operatorKeyword],color:"#39ADB5"},{tag:[g.url,g.escape,g.regexp,g.link],color:"#91B859"},{tag:[g.meta,g.comment],color:"#90A4AE"},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.link,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:"#39ADB5"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#90A4AE"},{tag:g.invalid,color:"#E5393570"},{tag:g.strikethrough,textDecoration:"line-through"}]}),gpe=$n({theme:"dark",settings:{background:"#2e3440",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#00000073",selectionMatch:"#00000073",gutterBackground:"#2e3440",gutterForeground:"#4c566a",lineHighlight:"#4c566a29"},styles:[{tag:g.keyword,color:"#5e81ac"},{tag:[g.name,g.deleted,g.character,g.propertyName,g.macroName],color:"#88c0d0"},{tag:[g.variableName],color:"#8fbcbb"},{tag:[g.function(g.variableName)],color:"#8fbcbb"},{tag:[g.labelName],color:"#81a1c1"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#5e81ac"},{tag:[g.definition(g.name),g.separator],color:"#a3be8c"},{tag:[g.brace],color:"#8fbcbb"},{tag:[g.annotation],color:"#d30102"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#b48ead"},{tag:[g.typeName,g.className],color:"#ebcb8b"},{tag:[g.operator,g.operatorKeyword],color:"#a3be8c"},{tag:[g.tagName],color:"#b48ead"},{tag:[g.squareBracket],color:"#bf616a"},{tag:[g.angleBracket],color:"#d08770"},{tag:[g.attributeName],color:"#ebcb8b"},{tag:[g.regexp],color:"#5e81ac"},{tag:[g.quote],color:"#b48ead"},{tag:[g.string],color:"#a3be8c"},{tag:g.link,color:"#a3be8c",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[g.url,g.escape,g.special(g.string)],color:"#8fbcbb"},{tag:[g.meta],color:"#88c0d0"},{tag:[g.monospace],color:"#d8dee9",fontStyle:"italic"},{tag:[g.comment],color:"#4c566a",fontStyle:"italic"},{tag:g.strong,fontWeight:"bold",color:"#5e81ac"},{tag:g.emphasis,fontStyle:"italic",color:"#5e81ac"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:g.heading,fontWeight:"bold",color:"#5e81ac"},{tag:g.special(g.heading1),fontWeight:"bold",color:"#5e81ac"},{tag:g.heading1,fontWeight:"bold",color:"#5e81ac"},{tag:[g.heading2,g.heading3,g.heading4],fontWeight:"bold",color:"#5e81ac"},{tag:[g.heading5,g.heading6],color:"#5e81ac"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#d08770"},{tag:[g.processingInstruction,g.inserted],color:"#8fbcbb"},{tag:[g.contentSeparator],color:"#ebcb8b"},{tag:g.invalid,color:"#434c5e",borderBottom:"1px dotted #d30102"}]}),bpe=$n({theme:"dark",settings:{background:"#272822",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#49483E",selectionMatch:"#49483E",gutterBackground:"#272822",gutterForeground:"#FFFFFF70",lineHighlight:"#0000003b"},styles:[{tag:g.labelName,color:"#bababa"},{tag:[g.comment,g.documentMeta],color:"#8292a2"},{tag:[g.number,g.bool,g.null,g.atom],color:"#ae81ff"},{tag:[g.attributeValue,g.className,g.name],color:"#e6db74"},{tag:[g.propertyName,g.attributeName],color:"#a6e22e"},{tag:[g.variableName],color:"#9effff"},{tag:[g.squareBracket],color:"#bababa"},{tag:[g.string,g.special(g.brace)],color:"#e6db74"},{tag:[g.regexp,g.className,g.typeName,g.definition(g.typeName)],color:"#66d9ef"},{tag:[g.definition(g.variableName),g.definition(g.propertyName),g.function(g.variableName)],color:"#a6e22e"},{tag:[g.keyword,g.definitionKeyword,g.modifier,g.tagName,g.angleBracket],color:"#f92672"}]}),As={background:"#002B36",foreground:"#839496",selection:"#004454AA",cursor:"#D30102",activeLine:"#00cafe11",keyword:"#859900",variable:"#268BD2",function:"#268BD2",string:"#2AA198",constant:"#CB4B16",type:"#859900",class:"#268BD2",number:"#D33682",comment:"#586E75",heading:"#268BD2",invalid:"#DC322F",regexp:"#DC322F",tag:"#268BD2"},ype=$n({theme:"dark",settings:{background:As.background,foreground:As.foreground,caret:As.cursor,selection:As.selection,selectionMatch:As.selection,gutterBackground:As.background,gutterForeground:As.foreground,lineHighlight:As.activeLine},styles:[{tag:g.keyword,color:As.keyword},{tag:[g.name,g.deleted,g.character,g.macroName],color:As.variable},{tag:[g.propertyName],color:As.function},{tag:[g.processingInstruction,g.string,g.inserted,g.special(g.string)],color:As.string},{tag:[g.function(g.variableName),g.labelName],color:As.function},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:As.constant},{tag:[g.definition(g.name),g.separator],color:As.variable},{tag:[g.className],color:As.class},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:As.number},{tag:[g.typeName],color:As.type,fontStyle:As.type},{tag:[g.operator,g.operatorKeyword],color:As.keyword},{tag:[g.url,g.escape,g.regexp,g.link],color:As.regexp},{tag:[g.meta,g.comment],color:As.comment},{tag:g.tagName,color:As.tag},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.link,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:As.heading},{tag:[g.atom,g.bool,g.special(g.variableName)],color:As.variable},{tag:g.invalid,color:As.invalid},{tag:g.strikethrough,textDecoration:"line-through"}]}),Es={background:"#FDF6E3",foreground:"#657B83",selection:"#EEE8D5",selectionMatch:"#EEE8D5",cursor:"#657B83",activeLine:"#3d392d11",keyword:"#859900",variable:"#268BD2",function:"#268BD2",string:"#2AA198",constant:"#CB4B16",type:"#859900",class:"#268BD2",number:"#D33682",comment:"#93A1A1",heading:"#268BD2",invalid:"#DC322F",regexp:"#DC322F",tag:"#268BD2"},vpe=$n({theme:"light",settings:{background:Es.background,foreground:Es.foreground,caret:Es.cursor,selection:Es.selection,selectionMatch:Es.selectionMatch,gutterBackground:Es.background,gutterForeground:Es.foreground,lineHighlight:Es.activeLine},styles:[{tag:g.keyword,color:Es.keyword},{tag:[g.name,g.deleted,g.character,g.macroName],color:Es.variable},{tag:[g.propertyName],color:Es.function},{tag:[g.processingInstruction,g.string,g.inserted,g.special(g.string)],color:Es.string},{tag:[g.function(g.variableName),g.labelName],color:Es.function},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:Es.constant},{tag:[g.definition(g.name),g.separator],color:Es.variable},{tag:[g.className],color:Es.class},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:Es.number},{tag:[g.typeName],color:Es.type,fontStyle:Es.type},{tag:[g.operator,g.operatorKeyword],color:Es.keyword},{tag:[g.url,g.escape,g.regexp,g.link],color:Es.regexp},{tag:[g.meta,g.comment],color:Es.comment},{tag:g.tagName,color:Es.tag},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.link,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:Es.heading},{tag:[g.atom,g.bool,g.special(g.variableName)],color:Es.variable},{tag:g.invalid,color:Es.invalid},{tag:g.strikethrough,textDecoration:"line-through"}]}),Ope=$n({theme:"dark",settings:{background:"#303841",foreground:"#FFFFFF",caret:"#FBAC52",selection:"#4C5964",selectionMatch:"#3A546E",gutterBackground:"#303841",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},styles:[{tag:g.labelName,color:"#A2A9B5"},{tag:[g.meta,g.comment],color:"#A2A9B5"},{tag:[g.attributeName,g.keyword],color:"#B78FBA"},{tag:g.function(g.variableName),color:"#5AB0B0"},{tag:[g.string,g.regexp,g.attributeValue],color:"#99C592"},{tag:g.operator,color:"#f47954"},{tag:[g.tagName,g.modifier],color:"#E35F63"},{tag:[g.number,g.definition(g.tagName),g.className,g.definition(g.variableName)],color:"#fbac52"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#E35F63"},{tag:g.variableName,color:"#539ac4"},{tag:[g.propertyName,g.typeName],color:"#629ccd"},{tag:g.propertyName,color:"#36b7b5"}]}),wpe=$n({theme:"dark",settings:{background:"#1a1b26",foreground:"#787c99",caret:"#c0caf5",selection:"#515c7e40",selectionMatch:"#16161e",gutterBackground:"#1a1b26",gutterForeground:"#787c99",lineHighlight:"#474b6611"},styles:[{tag:g.keyword,color:"#bb9af7"},{tag:[g.name,g.deleted,g.character,g.macroName],color:"#c0caf5"},{tag:[g.propertyName],color:"#7aa2f7"},{tag:[g.processingInstruction,g.string,g.inserted,g.special(g.string)],color:"#9ece6a"},{tag:[g.function(g.variableName),g.labelName],color:"#7aa2f7"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#bb9af7"},{tag:[g.definition(g.name),g.separator],color:"#c0caf5"},{tag:[g.className],color:"#c0caf5"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#ff9e64"},{tag:[g.typeName],color:"#0db9d7"},{tag:[g.operator,g.operatorKeyword],color:"#bb9af7"},{tag:[g.url,g.escape,g.regexp,g.link],color:"#b4f9f8"},{tag:[g.meta,g.comment],color:"#444b6a"},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.link,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:"#89ddff"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#c0caf5"},{tag:g.invalid,color:"#ff5370"},{tag:g.strikethrough,textDecoration:"line-through"}]}),xpe=$n({theme:"dark",settings:{background:"#24283b",foreground:"#7982a9",caret:"#c0caf5",selection:"#6f7bb630",selectionMatch:"#343b5f",gutterBackground:"#24283b",gutterForeground:"#7982a9",lineHighlight:"#292e427a"},styles:[{tag:g.keyword,color:"#bb9af7"},{tag:[g.name,g.deleted,g.character,g.macroName],color:"#c0caf5"},{tag:[g.propertyName],color:"#7aa2f7"},{tag:[g.processingInstruction,g.string,g.inserted,g.special(g.string)],color:"#9ece6a"},{tag:[g.function(g.variableName),g.labelName],color:"#7aa2f7"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#bb9af7"},{tag:[g.definition(g.name),g.separator],color:"#c0caf5"},{tag:[g.className],color:"#c0caf5"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#ff9e64"},{tag:[g.typeName],color:"#2ac3de",fontStyle:"#2ac3de"},{tag:[g.operator,g.operatorKeyword],color:"#bb9af7"},{tag:[g.url,g.escape,g.regexp,g.link],color:"#b4f9f8"},{tag:[g.meta,g.comment],color:"#565f89"},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.link,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:"#89ddff"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#c0caf5"},{tag:g.invalid,color:"#ff5370"},{tag:g.strikethrough,textDecoration:"line-through"}]}),kpe=$n({theme:"light",settings:{background:"#e1e2e7",foreground:"#3760bf",caret:"#3760bf",selection:"#99a7df",selectionMatch:"#99a7df",gutterBackground:"#e1e2e7",gutterForeground:"#3760bf",lineHighlight:"#5f5faf11"},styles:[{tag:g.keyword,color:"#007197"},{tag:[g.name,g.deleted,g.character,g.macroName],color:"#3760bf"},{tag:[g.propertyName],color:"#3760bf"},{tag:[g.processingInstruction,g.string,g.inserted,g.special(g.string)],color:"#587539"},{tag:[g.function(g.variableName),g.labelName],color:"#3760bf"},{tag:[g.color,g.constant(g.name),g.standard(g.name)],color:"#3760bf"},{tag:[g.definition(g.name),g.separator],color:"#3760bf"},{tag:[g.className],color:"#3760bf"},{tag:[g.number,g.changed,g.annotation,g.modifier,g.self,g.namespace],color:"#b15c00"},{tag:[g.typeName],color:"#007197",fontStyle:"#007197"},{tag:[g.operator,g.operatorKeyword],color:"#007197"},{tag:[g.url,g.escape,g.regexp,g.link],color:"#587539"},{tag:[g.meta,g.comment],color:"#848cb5"},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.link,textDecoration:"underline"},{tag:g.heading,fontWeight:"bold",color:"#b15c00"},{tag:[g.atom,g.bool,g.special(g.variableName)],color:"#3760bf"},{tag:g.invalid,color:"#f52a65"},{tag:g.strikethrough,textDecoration:"line-through"}]}),Spe=$n({theme:"dark",settings:{background:"#1e1e1e",foreground:"#fff",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383"},styles:[{tag:[g.keyword,g.operatorKeyword,g.modifier,g.color,g.constant(g.name),g.standard(g.name),g.standard(g.tagName),g.special(g.brace),g.atom,g.bool,g.special(g.variableName)],color:"#569cd6"},{tag:[g.controlKeyword,g.moduleKeyword],color:"#c586c0"},{tag:[g.name,g.deleted,g.character,g.macroName,g.propertyName,g.variableName,g.labelName,g.definition(g.name)],color:"#9cdcfe"},{tag:g.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[g.typeName,g.className,g.tagName,g.number,g.changed,g.annotation,g.self,g.namespace],color:"#4ec9b0"},{tag:[g.function(g.variableName),g.function(g.propertyName)],color:"#dcdcaa"},{tag:[g.number],color:"#b5cea8"},{tag:[g.operator,g.punctuation,g.separator,g.url,g.escape,g.regexp],color:"#d4d4d4"},{tag:[g.regexp],color:"#d16969"},{tag:[g.special(g.string),g.processingInstruction,g.string,g.inserted],color:"#ce9178"},{tag:[g.angleBracket],color:"#808080"},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:[g.meta,g.comment],color:"#6a9955"},{tag:g.link,color:"#6a9955",textDecoration:"underline"},{tag:g.invalid,color:"#ff0000"}]}),Cpe=$n({theme:"light",settings:{background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893"},styles:[{tag:[g.keyword,g.operatorKeyword,g.modifier,g.color,g.constant(g.name),g.standard(g.name),g.standard(g.tagName),g.special(g.brace),g.atom,g.bool,g.special(g.variableName)],color:"#0000ff"},{tag:[g.moduleKeyword,g.controlKeyword],color:"#af00db"},{tag:[g.name,g.deleted,g.character,g.macroName,g.propertyName,g.variableName,g.labelName,g.definition(g.name)],color:"#0070c1"},{tag:g.heading,fontWeight:"bold",color:"#0070c1"},{tag:[g.typeName,g.className,g.tagName,g.number,g.changed,g.annotation,g.self,g.namespace],color:"#267f99"},{tag:[g.function(g.variableName),g.function(g.propertyName)],color:"#795e26"},{tag:[g.number],color:"#098658"},{tag:[g.operator,g.punctuation,g.separator,g.url,g.escape,g.regexp],color:"#383a42"},{tag:[g.regexp],color:"#af00db"},{tag:[g.special(g.string),g.processingInstruction,g.string,g.inserted],color:"#a31515"},{tag:[g.angleBracket],color:"#383a42"},{tag:g.strong,fontWeight:"bold"},{tag:g.emphasis,fontStyle:"italic"},{tag:g.strikethrough,textDecoration:"line-through"},{tag:[g.meta,g.comment],color:"#008000"},{tag:g.link,color:"#4078f2",textDecoration:"underline"},{tag:g.invalid,color:"#e45649"}]}),Ppe=$n({theme:"light",settings:{background:"#fff",foreground:"#3D3D3D",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#AFAFAF",lineHighlight:"#d5e6ff69"},styles:[{tag:[g.comment,g.quote],color:"#707F8D"},{tag:[g.typeName,g.typeOperator],color:"#aa0d91"},{tag:[g.keyword],color:"#aa0d91",fontWeight:"bold"},{tag:[g.string,g.meta],color:"#D23423"},{tag:[g.name],color:"#032f62"},{tag:[g.typeName],color:"#522BB2"},{tag:[g.variableName],color:"#23575C"},{tag:[g.definition(g.variableName)],color:"#327A9E"},{tag:[g.regexp,g.link],color:"#0e0eff"}]}),Ape=$n({theme:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#FBAC52",selection:"#FFD420",selectionMatch:"#FFD420",gutterBackground:"#f5f5f5",gutterForeground:"#4D4D4C",lineHighlight:"#00000012"},styles:[{tag:[g.meta,g.comment],color:"#804000"},{tag:[g.keyword,g.strong],color:"#0000FF"},{tag:[g.number],color:"#FF0080"},{tag:[g.string],color:"#FF0080"},{tag:[g.variableName],color:"#006600"},{tag:[g.escape],color:"#33CC33"},{tag:[g.tagName],color:"#1C02FF"},{tag:[g.heading],color:"#0C07FF"},{tag:[g.quote],color:"#000000"},{tag:[g.list],color:"#B90690"},{tag:[g.documentMeta],color:"#888888"},{tag:[g.function(g.variableName)],color:"#0000A2"},{tag:[g.definition(g.typeName),g.typeName],color:"#6D79DE"}]}),Epe=$n({theme:"light",settings:{background:"#f2f1f8",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",selectionMatch:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#16067911"},styles:[{tag:g.comment,color:"#9995b7"},{tag:g.keyword,color:"#ff5792",fontWeight:"bold"},{tag:[g.definitionKeyword,g.modifier],color:"#ff5792"},{tag:[g.className,g.tagName,g.definition(g.typeName)],color:"#0094f0"},{tag:[g.number,g.bool,g.null,g.special(g.brace)],color:"#5842ff"},{tag:[g.definition(g.propertyName),g.function(g.variableName)],color:"#0095a8"},{tag:g.typeName,color:"#b3694d"},{tag:[g.propertyName,g.variableName],color:"#fa8900"},{tag:g.operator,color:"#ff5792"},{tag:g.self,color:"#e64100"},{tag:[g.string,g.regexp],color:"#00b368"},{tag:[g.paren,g.bracket],color:"#0431fa"},{tag:g.labelName,color:"#00bdd6"},{tag:g.attributeName,color:"#e64100"},{tag:g.angleBracket,color:"#9995b7"}]}),hD={strudelTheme:Cde,algoboy:_de,archBtw:Yde,androidstudio:npe,atomone:spe,aura:rpe,bbedit:Ape,blackscreen:Mde,bluescreen:Ade,bluescreenlight:tpe,CutiePi:Zde,darcula:ape,dracula:ope,duotoneDark:lpe,eclipse:cpe,fruitDaw:Jde,githubDark:upe,githubLight:hpe,greenText:Xde,gruvboxDark:dpe,gruvboxLight:ppe,sonicPink:qde,materialDark:mpe,materialLight:fpe,monokai:bpe,noctisLilac:Epe,nord:gpe,redText:Wde,solarizedDark:ype,solarizedLight:vpe,sublime:Ope,teletext:Fde,tokyoNight:wpe,tokyoNightDay:kpe,tokyoNightStorm:xpe,vscodeDark:Spe,vscodeLight:Cpe,whitescreen:Tde,xcodeLight:Ppe},Mpe=n=>hD[n]||hD.strudelTheme;let yw={};const Dpe=n=>`slider_${n}`;let Tpe=class extends ho{constructor(e,t,s,r,a,i,o){super(),this.value=e,this.min=t,this.max=s,this.from=r,this.originalFrom=r,this.to=a,this.step=i,this.view=o}eq(){return!1}toDOM(){let e=document.createElement("span");e.setAttribute("aria-hidden","true"),e.className="cm-slider";let t=e.appendChild(document.createElement("input"));return t.type="range",t.min=this.min,t.max=this.max,t.step=this.step??(this.max-this.min)/1e3,t.originalValue=this.value,t.value=t.originalValue,t.from=this.from,t.originalFrom=this.originalFrom,t.to=this.to,t.style="width:64px;margin-right:4px;transform:translateY(4px)",this.slider=t,t.addEventListener("input",s=>{const r=s.target.value;let a=r;const i=t.from+t.originalValue.length;let o={from:t.from,to:i,insert:a};t.originalValue=a,t.value=a,this.view.dispatch({changes:o});const l=Dpe(t.originalFrom);window.postMessage({type:"cm-slider",value:Number(r),id:l})}),e}ignoreEvent(e){return!0}};const Bpe=rn.define();function Fpe(n,e){return n.filter(t=>t.type==="slider").map(({from:t,to:s,value:r,min:a,max:i,step:o})=>At.widget({widget:new Tpe(r,a,i,t,s,o,e),side:0}).range(t))}Ns.fromClass(class{constructor(n){Yl(this,"decorations");this.decorations=At.set([])}update(n){n.transactions.forEach(e=>{var t,s;if(e.docChanged){this.decorations=this.decorations.map(e.changes);const r=this.decorations.iter();for(;r.value;)(s=(t=r.value)==null?void 0:t.widget)!=null&&s.slider&&(r.value.widget.slider.from=r.from,r.value.widget.slider.to=r.to),r.next()}for(let r of e.effects)r.is(Bpe)&&(this.decorations=At.set(Fpe(r.value,n.view)))})}},{decorations:n=>n.decorations});typeof window<"u"&&window.addEventListener("message",n=>{n.data.type==="cm-slider"&&(yw[n.data.id]!==void 0?yw[n.data.id]=n.data.value:console.warn(`slider with id "${n.data.id}" is not registered. Only ${Object.keys(yw)}`))});const $pe=rn.define({map:({from:n,to:e},t)=>({from:t.mapPos(n),to:t.mapPos(e)})});function Npe(n){return n.sort((e,t)=>e.to-t.to).map(e=>At.widget({widget:new Rpe(e),side:0,block:!0}).range(e.to))}qs.define({create(){return At.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is($pe))try{n=n.update({filter:()=>!1,add:Npe(t.value)})}catch(s){console.log("err",s)}return n},provide:n=>lt.decorations.from(n)});const gN={};function _pe(n,e){gN[n]=e,e.id=n}let Rpe=class extends ho{constructor(e){super(),this.widgetConfig=e}eq(){return!0}toDOM(){const e=qP(this.widgetConfig);return gN[e]}ignoreEvent(e){return!0}};function hp(n,e){rN(n),e&&(nX.prototype[n]=function(t,s={fold:1}){return e(t,s,this)})}function dp(n,e={}){const{width:t=500,height:s=60,pixelRatio:r=window.devicePixelRatio}=e;let a=document.getElementById(n)||document.createElement("canvas");return a.width=t*r,a.height=s*r,a.style.width=t+"px",a.style.height=s+"px",_pe(n,a),a}hp("_pianoroll",(n,e={},t)=>{const s=dp(n,e).getContext("2d");return t.tag(n).pianoroll({fold:1,...e,ctx:s,id:n})});hp("_punchcard",(n,e={},t)=>{const s=dp(n,e).getContext("2d");return t.tag(n).punchcard({fold:1,...e,ctx:s,id:n})});hp("_spiral",(n,e={},t)=>{let s=e.size||275;e={width:s,height:s,...e,size:s/5};const r=dp(n,e).getContext("2d");return t.tag(n).spiral({...e,ctx:r,id:n})});hp("_scope",(n,e={},t)=>{e={width:500,height:60,pos:.5,scale:1,...e};const s=dp(n,e).getContext("2d");return t.tag(n).scope({...e,ctx:s,id:n})});hp("_pitchwheel",(n,e={},t)=>{let s=e.size||200;e={width:s,height:s,...e,size:s/5};const r=dp(n,e).getContext("2d");return t.pitchwheel({...e,ctx:r,id:n})});hp("_spectrum",(n,e={},t)=>{let s=e.size||200;e={width:s,height:s,...e,size:s/5};const r=dp(n,e).getContext("2d");return t.spectrum({...e,ctx:r,id:n})});_F(),kP(),Vne(),ase(),lse(),Pc.of([...I$,...cv,...SP]);_F(),kP(),Rne(),nv(O$,{fallback:!0}),Pc.of([...cv,...SP]);const Ipe={isLineWrappingEnabled:n=>n?lt.lineWrapping:[],isBracketMatchingEnabled:n=>n?S$({brackets:"()[]{}<>"}):[],isBracketClosingEnabled:n=>n?$$():[],isLineNumbersDisplayed:n=>n?Vk():[],theme:Mpe,isAutoCompletionEnabled:ude,isTooltipEnabled:pde,isPatternHighlightingEnabled:w2,isActiveLineHighlighted:n=>n?[Jne(),Dse()]:[],isFlashEnabled:gde,keybindings:kde,isTabIndentationEnabled:n=>n?Pc.of([boe]):[],isMultiCursorEnabled:n=>n?[ls.allowMultipleSelections.of(!0),lt.clickAddsSelectionRange.of(e=>e.metaKey||e.ctrlKey)]:[]};Object.fromEntries(Object.keys(Ipe).map(n=>[n,new Vf]));const Lpe={keybindings:"codemirror",isBracketMatchingEnabled:!1,isBracketClosingEnabled:!0,isLineNumbersDisplayed:!0,isActiveLineHighlighted:!1,isAutoCompletionEnabled:!1,isPatternHighlightingEnabled:!0,isFlashEnabled:!0,isTooltipEnabled:!1,isLineWrappingEnabled:!1,isTabIndentationEnabled:!1,isMultiCursorEnabled:!1,theme:"strudelTheme",fontFamily:"monospace",fontSize:18};khe("codemirror-settings",Lpe,{encode:JSON.stringify,decode:JSON.parse});tX("markcss");const Qpe=new Map,k2=rn.define(),bN=qs.define({create(){return At.none},update(n,e){e.docChanged&&(n=n.map(e.changes));for(const t of e.effects)if(t.is(k2))return t.value;return n},provide:n=>lt.decorations.from(n)}),jpe=At.mark({class:"cm-master-highlight"});function Vpe(n,e={}){const{theme:t="light",placeholder:s="",lineNumbers:r=!0,autofocus:a=!1,onUpdate:i=null}=e,o=n.value||"",l=[r?Vk():[],kP(),eae(),S$(),$$(),xoe(),Pc.of([...I$,...cv,...SP,...Hre]),yie(),Kc.data.of({closeBrackets:{brackets:["(","[","{","'",'"',"<"]},bracketMatching:{brackets:["(","[","{","'",'"',"<"]}}),nv(O$),lt.lineWrapping,lt.updateListener.of(u=>{if(u.docChanged&&i){const h=u.state.doc.toString();i(h)}if(u.docChanged){const h=u.state.doc.toString();n.value=h;const d=new Event("input",{bubbles:!0});n.dispatchEvent(d)}}),lt.contentAttributes.of({"data-placeholder":s}),lt.baseTheme({"&.cm-editor":{outline:"none",position:"relative",boxSizing:"border-box"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:"1.4",height:"100%",overflowX:"auto",position:"relative",zIndex:"0"},".cm-content":{margin:"0",flexGrow:"2",flexShrink:"0",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none",minHeight:"120px"},".cm-lineWrapping":{whiteSpace:"pre-wrap",overflowWrap:"anywhere"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-gutters":{flexShrink:"0",display:"flex",height:"100%",boxSizing:"border-box",left:"0",zIndex:"200"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:"0",boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",color:"#999",whiteSpace:"nowrap"}}),lt.theme({"&.cm-editor":{fontSize:"14px",fontFamily:"'Courier New', Courier, monospace",border:"1px solid rgba(102, 126, 234, 0.25)",borderRadius:"12px",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"inset 0 0 0 1px rgba(255, 255, 255, 0.5)",overflow:"hidden"},".cm-content":{minHeight:"120px",padding:"8px",caretColor:"#000"},".cm-focused":{outline:"none"},".cm-editor.cm-focused":{borderColor:"#667eea",backgroundColor:"#fff",boxShadow:"inset 0 0 0 1px rgba(255, 255, 255, 0.5), 0 0 0 2px rgba(102, 126, 234, 0.2)"},".cm-placeholder":{color:"#999",fontStyle:"italic"},".cm-gutters":{backgroundColor:"rgba(245, 245, 245, 0.5)",color:"#999",border:"none",borderRight:"1px solid rgba(102, 126, 234, 0.15)"},".cm-kn":{color:"#002610"},".cm-kl":{color:"#002610"},".cm-kq":{color:"#400707"},".cm-jz":{color:"#400707"},".cm-kv":{color:"#400707"},".cm-kh":{color:"#400707"},".cm-string":{color:"#1a1a1a"},".cm-string1":{color:"#1a1a1a"},".cm-string2":{color:"#1a1a1a"}})];l.push(bN),t==="dark"&&l.push(Bie),Vk||l.push(lt.lineWrapping);let c;try{c=new lt({doc:o,extensions:l}),n.style.display="none",n.parentNode.insertBefore(c.dom,n),console.log(`✅ Editor created and inserted for ${n.id||"textarea"}`)}catch(u){return console.error("❌ Error creating Strudel REPL editor:",u),console.error("   Error details:",u.message,u.stack),null}return c&&(c.getTextarea=()=>n,c.getValue=()=>c.state.doc.toString(),c.setValue=u=>{if(c.state.doc.toString()!==u){c.dispatch({changes:{from:0,to:c.state.doc.length,insert:u||""}}),n.value=u||"";const d=new Event("input",{bubbles:!0});n.dispatchEvent(d)}}),a&&c.focus(),c}function Zpe(){try{console.log("🎨 Initializing Strudel REPL editors...");const n=document.querySelectorAll("strudel-editor[data-strudel-repl], strudel-editor#master-pattern");if(console.log(`   Found ${n.length} strudel-editor components`),n.forEach(e=>{if(e.editor)console.log(`✅ strudel-editor already initialized for ${e.id||"unnamed"}`);else{const t=setInterval(()=>{e.editor&&(console.log(`✅ strudel-editor ready for ${e.id||"unnamed"}`),clearInterval(t))},100);setTimeout(()=>clearInterval(t),5e3)}}),typeof lt<"u"){const e=document.querySelectorAll("textarea[data-strudel-repl], textarea#modal-pattern");console.log(`   Found ${e.length} textareas to initialize:`,Array.from(e).map(t=>t.id||"unnamed")),e.forEach(t=>{if(t.tagName==="TEXTAREA"&&!t.dataset.strudelReplInitialized){const s=t.id==="modal-pattern";console.log(`   Initializing editor for: ${t.id||"unnamed textarea"}`);const r=t.placeholder||"";try{const a=Vpe(t,{theme:"light",placeholder:r,lineNumbers:!0,autofocus:!1,onUpdate:i=>{t.value=i}});a?(t.dataset.strudelReplInitialized="true",t._strudelEditor=a,Qpe.set(t.id,a),console.log(`   ✅ Successfully created editor for ${t.id||"textarea"}`)):console.warn(`   ⚠️ Editor creation returned null for ${t.id||"textarea"}`)}catch(a){console.error(`   ❌ Error creating editor for ${t.id||"textarea"}:`,a)}}else t.dataset.strudelReplInitialized&&console.log(`   ⏭️ Skipping ${t.id||"unnamed"} - already initialized`)})}else console.warn("⚠️ CodeMirror EditorView is not available - textarea editors will not be initialized");console.log("✅ Strudel REPL editors initialization complete")}catch(n){console.error("❌ Error initializing Strudel REPL editors:",n)}}function tg(n){const e=typeof n=="string"?document.getElementById(n):n;return e?e.tagName==="STRUDEL-EDITOR"&&e.editor?e.editor:e._strudelEditor?e._strudelEditor:null:null}function In(n){const e=tg(n);if(e){if(e.getCode&&typeof e.getCode=="function")return e.getCode();if(e.getValue&&typeof e.getValue=="function")return e.getValue()}const t=typeof n=="string"?document.getElementById(n):n;return t?t.tagName==="STRUDEL-EDITOR"?t.getAttribute("code")||"":t.value||"":""}function Ln(n,e){const t=tg(n);if(t){if(t.setCode&&typeof t.setCode=="function"){t.setCode(e);return}if(t.setValue&&typeof t.setValue=="function"){t.setValue(e);return}}const s=typeof n=="string"?document.getElementById(n):n;if(s){if(s.tagName==="STRUDEL-EDITOR"){s.setAttribute("code",e);return}s.value=e;const r=new Event("input",{bubbles:!0});s.dispatchEvent(r)}}function zpe(n,e){const t=tg(n),s=document.getElementById(n);t&&t.contentDOM&&(t.contentDOM.setAttribute("contenteditable",e?"true":"false"),t.dom.classList.toggle("cm-readonly",!e)),s&&(s.readOnly=!e,s.classList.toggle("pattern-editor-readonly",!e))}function yN(n,e=[]){const t=tg(n);if(!t){console.warn(`⚠️ CodeMirror editor not found for ${n}`);return}const s=t.editor?t.editor:t;if(!s||!s.state||!s.state.doc){console.warn(`⚠️ CodeMirror EditorView not available for ${n}`);return}let r=!1;try{r=s.state.field(bN)!==void 0}catch{r=!1}if(typeof gw=="function"&&w2&&w2())try{const l=e.map(c=>({start:c.from,end:c.to}));if(l.length>0){gw(s,l),console.log(`✅ Applied ${e.length} highlight range(s) using Strudel's built-in highlighting`);return}else{gw(s,[]);return}}catch(l){console.warn("⚠️ Strudel built-in highlighting failed, falling back to custom:",l)}if(!r){if(e.length===0)return;console.warn("⚠️ highlightField not registered on editor. Cannot apply custom highlights.");return}const a=s.state.doc,i=[];Array.isArray(e)&&e.forEach(l=>{if(!l||typeof l.from!="number"||typeof l.to!="number")return;const c=Math.max(0,Math.min(a.length,Math.floor(l.from))),u=Math.max(c,Math.min(a.length,Math.ceil(l.to)));c!==u&&i.push(jpe.range(c,u))});const o=i.length>0?At.set(i.sort((l,c)=>l.from-c.from)):At.none;try{s.dispatch({effects:k2.of(o)}),e.length>0?console.log(`✅ Applied ${e.length} highlight range(s) to CodeMirror editor (custom system)`):s.dispatch({effects:k2.of(At.none)})}catch(l){console.warn("⚠️ Error applying highlights to CodeMirror editor:",l)}}function dD(n,e,t={}){if(!e||typeof e!="string")return;const s=typeof t.cursorOffset=="number"?t.cursorOffset:null,r=tg(n);if(r){const m=r,{state:y}=m,O=y.selection.main,S=O.from,A=O.to,F=pD(e,()=>{let N=S;for(;N>0;){const $=y.doc.sliceString(N-1,N);if(N-=1,!/\s/.test($))return $}return""}),j=s!==null?s:F.endsWith("()")||F.endsWith("{}")?1:0;m.dispatch({changes:{from:S,to:A,insert:F},selection:Le.cursor(Math.max(S+F.length-j,0)),scrollIntoView:!0}),m.focus();return}const a=document.getElementById(n);if(!a)return;const i=typeof a.selectionStart=="number"?a.selectionStart:a.value.length,o=typeof a.selectionEnd=="number"?a.selectionEnd:a.value.length,l=a.value.slice(0,i),c=a.value.slice(o),u=pD(e,()=>{let m=i;for(;m>0;){const y=a.value.charAt(m-1);if(m-=1,!/\s/.test(y))return y}return""});a.value=`${l}${u}${c}`;const h=s!==null?s:u.endsWith("()")||u.endsWith("{}")?1:0,d=Math.max(i+u.length-h,0);typeof a.setSelectionRange=="function"&&a.setSelectionRange(d,d),a.dispatchEvent(new Event("input",{bubbles:!0})),a.focus()}function pD(n,e){if(!n||n.trimStart().startsWith(".")||/^\s/.test(n))return n;const s=typeof e=="function"?e():"";return!s||s==="."||/\s/.test(s)||/[\(\[\{,]/.test(s)?n:`.${n}`}const UP="master-pattern";let eu=null,My=!1,vw=!1;function qpe(n){const e=[],t=new Set;if(!Array.isArray(n))return e;const s=In(UP)||"";if(!s)return e;const r=vN(s);return n.forEach((a,i)=>{var l;const o=(l=a==null?void 0:a.context)==null?void 0:l.locations;if(!Array.isArray(o)){Math.random()<.1&&i===0&&console.log("🔍 Debug collectActiveRanges: Hap has no locations array",{hasContext:!!(a!=null&&a.context),contextKeys:a!=null&&a.context?Object.keys(a.context):[],locationsType:typeof o,locationsValue:o,fullContext:a==null?void 0:a.context});return}o.forEach((c,u)=>{if(typeof(c==null?void 0:c.start)!="number"&&typeof(c==null?void 0:c.from)!="number"){Math.random()<.01&&i===0&&u===0&&console.log("🔍 Debug: Location has unexpected structure",{location:c,locationKeys:c?Object.keys(c):[],hasStart:typeof(c==null?void 0:c.start)=="number",hasFrom:typeof(c==null?void 0:c.from)=="number",hasEnd:typeof(c==null?void 0:c.end)=="number",hasTo:typeof(c==null?void 0:c.to)=="number"});return}const h=c.start??c.from,d=c.end??c.to;if(typeof h!="number"||typeof d!="number")return;let m=Math.max(0,Math.min(h,d)),y=Math.max(m,Math.max(h,d));const O=r.length;if(m>O)return;y=Math.min(y,O);const S=Upe(m,y,r,s),A=`${S.from}:${S.to}`;t.has(A)||(t.add(A),e.push({from:S.from,to:S.to}))})}),e}function vN(n){if(!n)return"";const e="// Controls Selected Tempo:";let t=n.split(`
`).filter(s=>!s.trim().startsWith(e)).join(`
`);return t=t.replace(/\/\/.*$/gm,""),t=t.replace(/\/\*[\s\S]*?\*\//g,s=>/\/\*\s*Channel\s+\d+\s*\*\//i.test(s)?s:""),t=t.replace(/\n\s*\n\s*\n/g,`

`).trim(),t}function Upe(n,e,t,s){if(t===s)return{from:n,to:e};const r=new Map;let a=0,i=0,o=0;for(;o<s.length&&a<t.length;){const m=s.substring(o);if(m.startsWith("//")){const S=m.indexOf(`
`);if(S!==-1)o+=S+1,i+=S+1;else break;continue}if(m.startsWith("/*")){const S=m.indexOf("*/");if(S!==-1){const A=m.substring(0,S+2);if(/\/\*\s*Channel\s+\d+\s*\*\//i.test(A)){for(let j=0;j<A.length&&a<t.length;j++)t[a]===A[j]&&(r.set(a,i+j),a++);o+=A.length,i+=A.length}else o+=S+2,i+=S+2;continue}else break}const y=s[o],O=t[a];y===O||/\s/.test(y)&&/\s/.test(O)?(r.set(a,i),a++,i++,o++):/\s/.test(y)?(i++,o++):/\s/.test(O)?a++:(a++,i++,o++)}const l=r.get(n),c=r.get(e);if(l!==void 0&&c!==void 0)return{from:l,to:c};if(r.size>0){let m=-1,y=-1,O=1/0,S=1/0;for(const[A,F]of r.entries())A<=n&&A>m&&(m=A,y=F),A>=n&&A<O&&(O=A,S=F);if(m>=0){const A=y-m;return{from:n+A,to:e+A}}if(O<1/0){const A=S-O;return{from:n+A,to:e+A}}}const u=s.split(`
`);let h=0,d=!1;for(let m=0;m<u.length&&!d;m++){const y=u[m],O=y.trim(),S=vN(y);O.startsWith("//")||O.startsWith("/*")||O.startsWith("*")||O===""&&!d||S.trim()===""&&O!==""?h+=y.length+1:S.trim()!==""&&(d=!0)}return{from:n+h,to:e+h}}function S2(){var t;if(!My){eu=null;return}const n=(t=window==null?void 0:window.strudel)==null?void 0:t.scheduler,e=n==null?void 0:n.pattern;if(!n||typeof n.now!="function"||!e||typeof e.queryArc!="function"){vw||(console.warn("⚠️ Unable to update highlights - Strudel scheduler not ready."),vw=!0),eu=requestAnimationFrame(S2);return}vw=!1;try{const a=n.now(),i=Math.max(0,a-.05),o=a+.05,l=e.queryArc(i,o)||[];l.length>0&&l.length<=5&&(l.some(h=>{var d,m;return((m=(d=h==null?void 0:h.context)==null?void 0:d.locations)==null?void 0:m.length)>0})||(console.warn("⚠️ Haps found but no location data. Pattern may not have withLoc enabled or locations not preserved."),console.log("Sample hap:",l[0])));const c=qpe(l);if(c.length>0)console.log(`🎯 Highlighting ${c.length} active range(s) at time ${a.toFixed(3)}`,c);else if(l.length>0&&Math.random()<.1&&(console.log(`ℹ️ Found ${l.length} hap(s) but no highlight ranges (missing location data?)`),l[0])){const u=l[0],h=u.context||{},d=h.locations;let m="Unable to serialize";try{m=JSON.stringify({hapKeys:Object.keys(u),context:h,value:u.value,whole:u.whole?{begin:u.whole.begin,end:u.whole.end}:null,part:u.part?{begin:u.part.begin,end:u.part.end}:null},null,2).substring(0,1e3)}catch(y){m=`Serialization error: ${y.message}`}console.log("🔍 Sample hap structure:",{hasContext:!!u.context,contextKeys:u.context?Object.keys(u.context):[],hasLocations:!!d,locationType:typeof d,isArray:Array.isArray(d),locationCount:Array.isArray(d)?d.length:0,firstLocation:Array.isArray(d)&&d.length>0?d[0]:null,fullStructure:m}),console.log("🔍 Raw hap object:",u)}yN(UP,c)}catch(s){console.warn("⚠️ Unable to update code highlights:",s)}eu=requestAnimationFrame(S2)}function Ow(){My||(My=!0,console.log("✅ Starting master pattern highlighting"),eu||(eu=requestAnimationFrame(S2)))}function ww(){My=!1,eu&&(cancelAnimationFrame(eu),eu=null),yN(UP,[])}const Wpe=new URL("../../",import.meta.url);function ON(n){if(!n||typeof n!="string")return"";const e=n.replace(/^\/+/,"");return new URL(e,Wpe).href}function Li(n=[]){return Array.isArray(n)?n.map(e=>ON(e)):[]}let xw=null,mD=null,fD=null,gD=null,bD=null,C2=null,yD=null;const Gpe=(n,e)=>{if(!n||!e)return n;try{return new URL(n,e).toString()}catch{return n}},P2=(n,e)=>{if(typeof n=="string")return Gpe(n,e);if(Array.isArray(n))return n.map(t=>P2(t,e));if(n&&typeof n=="object"){const t={};return Object.entries(n).forEach(([s,r])=>{t[s]=P2(r,e)}),t}return n},Xpe=n=>{if(!n||typeof n!="object")return n;const e=n._base||"",t={};return Object.entries(n).forEach(([s,r])=>{s!=="_base"&&(t[s]=P2(r,e))}),t},kw="https://raw.githubusercontent.com/felixroos/dough-samples/main";async function nc(){return xw||(xw=Promise.all([ds(()=>import("./strudel-core-Cml4IbyB.js").then(n=>n.A),[]),ds(()=>import("./strudel-web-Ddx65js9.js").then(n=>n.b),__vite__mapDeps([0,1])),ds(()=>import("./strudel-web-Ddx65js9.js").then(n=>n.c),__vite__mapDeps([0,1])),ds(()=>Promise.resolve().then(()=>Ele),void 0),ds(()=>import("./index-yklpTfks.js"),__vite__mapDeps([2,1,0])).catch(()=>null)]).then(n=>(mD=n[0],gD=n[1],fD=n[2],bD=n[3],C2=n[4],yD=null,{coreModule:mD,webModule:gD,webaudioModule:fD,tonalModule:bD,midiModule:C2,samplerModule:yD}))),xw}const um={superpiano:"piano",wood:"jazz"};function Sw(n){if(!n||typeof n!="string")return n;let e=n;for(const[t,s]of Object.entries(um)){const r=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=new RegExp(`(\\.s\\(["'])${r}(["']\\))`,"gi");e=e.replace(a,(o,l,c)=>`${l}${s}${c}`);const i=new RegExp(`(sound\\(["'])${r}(["']\\))`,"gi");e=e.replace(i,(o,l,c)=>`${l}${s}${c}`)}return e}const Cw={major:"major",minor:"minor",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic",ionian:"major",aeolian:"minor","melodic minor":"melodic minor","dorian b2":"dorian b2","lydian augmented":"lydian augmented","lydian dominant":"lydian dominant","mixolydian b6":"mixolydian b6","locrian #2":"locrian #2",altered:"altered","harmonic minor":"harmonic minor","locrian #6":"locrian #6","ionian #5":"ionian #5","dorian #4":"dorian #4","phrygian dominant":"phrygian dominant","lydian #2":"lydian #2",ultralocrian:"ultralocrian","harmonic major":"harmonic major","dorian b5":"dorian b5","phrygian b4":"phrygian b4","lydian b3":"lydian b3","mixolydian b2":"mixolydian b2","lydian augmented #2":"lydian augmented #2","locrian bb7":"locrian bb7","major pentatonic":"major pentatonic","suspended pentatonic":"suspended pentatonic","man gong":"man gong",ritusen:"ritusen","minor pentatonic mode 5":"minor pentatonic","minor pentatonic":"minor pentatonic","blues minor pentatonic":"minor pentatonic","major pentatonic mode 3":"major pentatonic",egyptian:"egyptian","minor pentatonic mode 5":"minor pentatonic","whole tone":"whole tone","half-whole diminished":"dominant diminished","whole-half diminished":"diminished","minor blues":"blues"};function vD(n){const e=/(\s+|[,;:<>()[\]{}|\\/]+|\*+)/g,t=n.split(e);let s=!1,r=null;for(let a=0;a<t.length;a++){const i=t[a];if(!i||e.test(i)){e.lastIndex=0;continue}const o=i.match(/^([a-gA-G])([#b]?)(-?\d+)?(@[\d.]+)?$/);if(!o){e.lastIndex=0;continue}const l=o[1].toUpperCase(),c=o[2]||"",u=o[3]?parseInt(o[3],10):null,h=o[4]||"",d=[];u!==null&&!Number.isNaN(u)&&d.push(u),r!==null&&(d.push(Math.round(r/12)-1),d.push(Math.round(r/12)),d.push(Math.round(r/12)+1)),d.push(3,4,5);let m=null;for(const S of d){const A=`${l}${c}${S}`,F=oa.get(A);if(F&&Number.isFinite(F.midi)){m=F;break}}if(!m||!Number.isFinite(m.midi))return null;const y=Math.round(m.midi);r===null&&(r=y);const O=y-r;t[a]=String(O)+h,s=!0,e.lastIndex=0}return s?t.join(""):null}function OD(n){if(!n||typeof n!="string")return n;const e=/\bnote\s*\(\s*([a-gA-G][^'"()]*?)\s*\)/gi;let t=n.replace(e,(r,a)=>{const i=(a||"").trim();if(!i)return r;const o=vD(i);return o===null?r:`n("${o}")`});const s=/\bnote\s*\(\s*(['"])([\s\S]*?)\1\s*\)/gi;return t=t.replace(s,(r,a,i)=>{const o=vD(i);return o===null?r:`n(${a}${o}${a})`}),t}let wD=!1,Pw=null,Aw=null;function Qu(){if(wD)return;wD=!0,Pw=Pw||console.error,Aw=Aw||console.warn;const n=e=>{if(e&&e.length>0){let t="",s=null;if(typeof e[0]=="string"?t=e[0]:e[0]instanceof Error||typeof e[0]=="object"&&e[0]!==null?(t=e[0].message||String(e[0]),s=e[0]):t=String(e[0]),t.includes("AudioContext")&&(t.includes("not allowed")||t.includes("start")||t.includes("resume")||t.includes("user gesture"))||t.includes("@strudel/core was loaded more than once")||t.includes("undefined instead of pattern")||t.includes('got "undefined" instead of pattern')||t.includes("got undefined instead of pattern")||t.includes("Pattern evaluation failed: got undefined"))return!0;let r=t;for(let i=0;i<e.length;i++)(typeof e[i]=="string"||e[i]&&e[i].toString)&&(r+=" "+String(e[i]));const a=r.toLowerCase();if(r.includes("not found! Is it loaded?")||r.includes("not found")||a.includes("not found")||r.includes("sound ")&&r.includes("not found")||r.includes("[getTrigger] error")||r.includes("[getTrigger]")||t.includes("[getTrigger]")||r.includes("[eval] error")||r.includes("[eval]")||t.includes("[eval]")||r.includes("Unexpected token")||r.includes("createPeriodicWave")||r.includes("length of the real array provided (0)")||r.includes("minimum bound (2)")||r.includes('got "undefined" instead of pattern')||r.includes("got undefined instead of pattern")||r.includes("undefined instead of pattern")||a.includes("undefined instead of pattern")||t.includes("undefined instead of pattern")||r.includes("RolandTR909")||r.includes("RolandTR808")||r.includes("RolandTR")||a.includes("rolandtr")||t.includes("RolandTR")||r.includes("[superdough]")||r.includes("cannot schedule sounds in the past")||t.includes("[superdough]")||t.includes("cannot schedule sounds in the past")||(t.includes("SyntaxError")||r.includes("SyntaxError"))&&(t.includes("JSON")||r.includes("JSON"))||t.includes("<!DOCTYPE")||r.includes("<!DOCTYPE")||t.includes("Unexpected token")&&t.includes("<")||r.includes("Unexpected token")&&r.includes("<")||t.includes("is not valid JSON")||r.includes("is not valid JSON")||r.includes("Unexpected non-whitespace character after JSON")||r.includes("Unexpected token")&&r.includes("JSON")||r.includes("error loading")&&(r.includes("CycleTones")||r.includes("strudel.json"))||r.includes("Failed to load default sound banks")||t.includes("Failed to load default sound banks")||s&&s.isUndefinedPattern===!0)return!0}return!1};console.error=(...e)=>{const t=n(e);if(!t&&e.length>0){const s=e[0],r=typeof s=="string"?s:String(s);if(r.includes("[eval]")||r.includes("[getTrigger]")||r.includes("RolandTR")||r.includes("undefined instead of pattern")||r.includes("not found")||r.includes("createPeriodicWave")||r.includes("length of the real array provided (0)")||r.includes("minimum bound (2)")||r.includes("Unexpected token"))return}t||Pw.apply(console,e)},console.warn=(...e)=>{const t=n(e);if(!t&&e.length>0){const s=e[0],r=typeof s=="string"?s:String(s);if(r.includes("[eval]")||r.includes("[getTrigger]")||r.includes("RolandTR")||r.includes("undefined instead of pattern")||r.includes("not found")||r.includes("[superdough]")||r.includes("cannot schedule sounds in the past")||r.includes("CycleTones not available")||r.includes("falling back to dirt-samples")||r.includes("createPeriodicWave")||r.includes("length of the real array provided (0)")||r.includes("minimum bound (2)")||r.includes("Unexpected token"))return}t||Aw.apply(console,e)}}Qu();function Br(n,...e){try{n&&typeof n._logRoute=="function"&&n._logRoute(...e)}catch{}}class Hpe{constructor(){this.audioContext=null,this.appInstance=null,this.volume=hs.defaults.volume,this.activeSounds=new Map,this.audioBuffers=new Map,this.oscillators=new Map,this.elementGainNodes=new Map,this.elementPanNodes=new Map,this.elementGainValues=new Map,this.elementPanValues=new Map,this.currentEvaluatingSlot=null,this.initialized=!1,this.strudelSoundBanksLoaded=!1,this.strudelSoundBankLoading=!1,this.soundsPreloaded=!1,this.onSoundsReadyCallback=null,this.onMasterPatternUpdateCallback=null,this.onMasterStateChangeCallback=null,this.strudelLoading=!1,this.strudelLoaded=!1,this.strudelPatternSlots=new Map,this.patternSlotToElementId=new Map,this.nextPatternSlot=1,this.previewSlotName="d16",this.reservedSlots=new Set([this.previewSlotName]),this.loadedBanks=new Set,this.defaultTempo=120,this.currentTempo=this.defaultTempo,this.tempoUserAdjusted=!1,this.currentKey="C",this.currentScale="chromatic",this.currentTimeSignature="",this.patternCache=new Map,this.masterGainNode=null,this._manualStrudelOutputNode=null,this._manualStrudelOutputDisabled=!1,this.masterPanNode=null,this.masterFilterNode=null,this.masterDryGainNode=null,this.masterDelayNode=null,this.masterReverbNode=null,this.masterDelayGainNode=null,this.masterDelayFeedbackGainNode=null,this.masterReverbGainNode=null,this.editorHighlightingEnabled=!1,this.masterVolume=.7,this.masterPan=0,this.masterMuted=!1,this.masterVolumeBeforeMute=.7,this.masterFilterEnabled=!1,this.masterFilterFrequency=2e3,this.masterFilterResonance=.7,this.masterFilterMinHz=80,this.masterFilterMaxHz=8e3,this.masterFilterBypassHz=2e4,this.masterFilterMinQ=.1,this.masterFilterMaxQ=5,this.masterFilterSmoothing=.05,this.masterFilterMinUpdateMs=16,this._lastMasterFilterUpdateTime=0,this._masterFilterUpdateTimeout=null,this.masterDelayAmount=0,this.masterDelayFeedback=.5,this.masterDelayTime=.25,this.masterReverbAmount=0,this.masterReverbRoomSize=.5,this.visualizerAnalyser=null,this.visualizerAnalyserTapGain=null,this.visualizerAnalyserTapGainConnected=!1,this.debugAudioRouting=!1,this._logRoute=(...e)=>{this.debugAudioRouting&&console.log(...e)},this._verifyMasterChainConnection=()=>{var r,a,i,o,l,c;if(!this.masterGainNode||!this._realDestination)return console.error("❌ CRITICAL: Master chain incomplete - masterGainNode or _realDestination missing"),!1;const e=this.masterGainNode.gain.value,t=this.masterMuted;e===0&&!t&&console.warn("⚠️ Master gain is 0 - audio will be silent"),t&&console.warn("⚠️ Master is muted - audio will be silent");const s={masterPanNode:!!this.masterPanNode,masterFilterNode:!!this.masterFilterNode,masterDryGainNode:!!this.masterDryGainNode,masterGainNode:!!this.masterGainNode,realDestination:!!this._realDestination,masterGain:e,masterDryGain:((a=(r=this.masterDryGainNode)==null?void 0:r.gain)==null?void 0:a.value)??"N/A",masterPan:((o=(i=this.masterPanNode)==null?void 0:i.pan)==null?void 0:o.value)??"N/A",masterFilterFreq:((c=(l=this.masterFilterNode)==null?void 0:l.frequency)==null?void 0:c.value)??"N/A",muted:t};console.log("🎚️ Master chain verification:",s),this.masterDryGainNode&&this.masterDryGainNode.gain.value===0&&console.warn("⚠️ Master dry gain is 0 - audio will be silent!");try{this.masterGainNode.__originalConnect?this.masterGainNode.__originalConnect.call(this.masterGainNode,this._realDestination):this.masterGainNode.connect(this._realDestination),console.log("✅ Verified masterGainNode -> destination connection")}catch(u){if(u.message&&u.message.includes("already connected"))console.log("✅ masterGainNode -> destination already connected");else return console.error("❌ Failed to connect masterGainNode -> destination:",u.message),!1}return!0},this._routingBypass=!1,this.masterPattern="",this.masterSlot="d0",this.trackedPatterns=new Map,this.masterActive=!1,this.masterPatternManualOverride=!1,this.masterPlaybackStartTime=null,this.masterPlaybackSpeed=1,this.masterPlaybackTempo=this.currentTempo,this.masterOnlyPlayback=!0,this.previewElementIds=new Set,this.sampleNameToSpecialtyBank=new Map,this.specialtyManifests=new Map,this._pendingMasterPatternRefreshReason=null,this._masterPatternRefreshTimer=null,this._masterPatternEvalPromise=Promise.resolve(),this._cachedScaleContext=null,this._cachedScaleKey="",this.mediaRecorder=null,this.recordedChunks=[],this.isRecording=!1,this.midiEnabled=!1,this.midiOutputs=new Map,this.selectedMidiOutput=null,this.activeMidiNotes=new Set,this.midiChannel=0,this._midiFallbackLogged=!1}getPatternSlot(e){if(e==="modal-preview"){const s=this.previewSlotName,r=this.patternSlotToElementId.get(s);return r&&r!==e&&(console.log(`⚠️ Preview slot ${s} previously mapped to ${r}, reassigning...`),this.strudelPatternSlots.delete(r),this.patternSlotToElementId.delete(s),this.getPatternSlot(r)),this.strudelPatternSlots.set(e,s),this.patternSlotToElementId.set(s,e),s}if(!this.strudelPatternSlots.has(e)){let s=this.nextPatternSlot,r=`d${s}`;for(;this.reservedSlots.has(r);)s++,s>16&&(s=1),r=`d${s}`;this.strudelPatternSlots.set(e,r),this.patternSlotToElementId.set(r,e),console.log(`🎵 Assigned ${e} to pattern slot ${r}`),s++,s>16&&(s=1),this.nextPatternSlot=s}const t=this.strudelPatternSlots.get(e);return console.log(`🎵 ${e} using slot ${t}`),t}onSoundsReady(e){this.onSoundsReadyCallback=e}onMasterPatternUpdate(e){this.onMasterPatternUpdateCallback=e}onMasterStateChange(e){this.onMasterStateChangeCallback=e}setEditorHighlightingEnabled(e){const t=!!e;this.editorHighlightingEnabled!==t&&(this.editorHighlightingEnabled=t,this.editorHighlightingEnabled?this.masterActive&&Ow():this.editorHighlightingEnabled&&ww())}async initializeStrudelAndSounds(){try{if(console.log("📦 Loading Strudel from CDN..."),!window.strudel||!window.strudel.evaluate||typeof globalThis.silence!="object"||typeof globalThis.sound!="function"?(console.log("Loading Strudel (window.strudel exists:",!!window.strudel,", functions exposed:",typeof globalThis.sound=="function",")"),await this.loadStrudelFromCDN()):console.log("Strudel already loaded and functions exposed"),!window.strudel||!window.strudel.evaluate)return console.error("Strudel failed to load properly"),!1;if(typeof globalThis.silence!="object"||typeof globalThis.sound!="function")return console.error("Strudel loaded but functions not exposed to globalThis!"),console.log("  typeof globalThis.silence:",typeof globalThis.silence,"(should be object)"),console.log("  typeof globalThis.sound:",typeof globalThis.sound,"(should be function)"),console.log("  typeof globalThis.note:",typeof globalThis.note,"(should be function)"),!1;if(console.log("✅ Strudel loaded successfully with functions exposed"),console.log("🔇 Ensuring all patterns are silent..."),globalThis.silence&&typeof globalThis.silence=="object")for(let s=1;s<=16;s++)try{window.strudel.evaluate(`d${s} = silence`).catch(()=>{})}catch{}else console.warn("⚠️ silence pattern not available yet - skipping pattern slot initialization");return console.log("📦 Loading sound banks..."),await this.ensureDefaultSoundBanks()?console.log("✅ Default sound banks loaded"):console.warn("⚠️ Default sound banks failed to load"),console.log("📦 Preloading all sounds..."),await this.preloadAllCommonDrumSounds(),console.log("📦 Pre-loading all configured patterns..."),this.preloadAllPatterns().catch(s=>{console.log("⚠️ Pattern pre-loading failed:",s)}),this.soundsPreloaded=!0,console.log("✅✅✅ All sounds ready and preloaded!"),!0}catch(e){return console.error("Error initializing Strudel/sounds:",e),!1}}async initialize(){var e;if(this.initialized&&this.audioContext&&this.audioContext.state==="running")return!0;try{if(this.audioContext&&this.audioContext.state==="closed"&&(this.audioContext=null),!this.audioContext){const t=window.AudioContext||window.webkitAudioContext;window.__OriginalAudioContext||(window.__OriginalAudioContext=t),this.audioContext=new t;const s=this.audioContext,r=function(){return Br(this,"🎚️ AudioContext constructor hijacked - returning our shared context"),s};r.prototype=t.prototype,r.__proto__=t,window.AudioContext=r,window.webkitAudioContext&&(window.webkitAudioContext=r),window.__hijackedAudioContext=s,this.audioContext.__masterPanNode=!0,console.log("✅ AudioContext hijacked - all future AudioContext creations will use our shared context"),this.masterPanNode=this.audioContext.createStereoPanner(),this.masterFilterNode=this.audioContext.createBiquadFilter(),this.masterFilterNode.type="lowpass",this.masterFilterNode.frequency.value=this.masterFilterFrequency,this.masterFilterNode.Q.value=this.masterFilterResonance,this.masterDryGainNode=this.audioContext.createGain(),this.masterDryGainNode.gain.value=1,this.masterDelayNode=this.audioContext.createDelay(1),this.masterDelayNode.delayTime.value=this.masterDelayTime,this.masterDelayGainNode=this.audioContext.createGain(),this.masterDelayGainNode.gain.value=this.masterDelayAmount,this.masterDelayFeedbackGainNode=this.audioContext.createGain(),this.masterDelayFeedbackGainNode.gain.value=this.masterDelayFeedback,this.masterReverbNode=this.audioContext.createConvolver(),this.masterReverbGainNode=this.audioContext.createGain(),this.masterReverbGainNode.gain.value=this.masterReverbAmount,this._createReverbImpulseResponse(),this.masterGainNode=this.audioContext.createGain(),this._realDestination=this.audioContext.destination,this.masterPanNode.connect(this.masterFilterNode),this.masterFilterNode.connect(this.masterDryGainNode),this.masterDryGainNode.connect(this.masterGainNode),console.log(`🎚️ Dry path: masterPan -> masterFilter (freq=${this.masterFilterNode.frequency.value}Hz) -> masterDryGain (gain=${this.masterDryGainNode.gain.value}) -> masterGain -> destination`),this.masterFilterNode.connect(this.masterDelayNode),this.masterDelayNode.connect(this.masterDelayGainNode),this.masterDelayGainNode.connect(this.masterGainNode),this.masterDelayNode.connect(this.masterDelayFeedbackGainNode),this.masterDelayFeedbackGainNode.connect(this.masterDelayNode),this.masterFilterNode.connect(this.masterReverbNode),this.masterReverbNode.connect(this.masterReverbGainNode),this.masterReverbGainNode.connect(this.masterGainNode);try{this.masterGainNode.connect(this._realDestination),console.log("✅ Connected masterGainNode -> _realDestination (initial setup)")}catch(i){console.error("❌ Failed to connect masterGainNode -> _realDestination:",i)}const a=this.audioContext.createGain();if(a.gain.value=1,a.connect(this.masterPanNode),console.log("✅ Created destination wrapper (GainNode) -> masterPanNode"),this.destinationWrapper=new Proxy(a,{set:(i,o,l)=>{if(o==="channelCount"&&(l===0||l<1))return console.warn(`🛡️ BLOCKED: superdough tried to set channelCount=${l} (invalid, must be >= 1)`),!0;try{i[o]=l}catch(c){console.warn(`⚠️ Could not set ${o}=${l}:`,c.message)}return!0},get:(i,o)=>{const l=i[o];return typeof l=="function"?l.bind(i):l}}),Object.defineProperty(this.audioContext,"destination",{get:()=>this.destinationWrapper,configurable:!0,enumerable:!0}),Br(this,`🎚️ ✅ INITIAL: Connected masterPan -> masterFilter -> masterDryGain -> masterGain -> destination (gain=${this.masterGainNode.gain.value.toFixed(3)})`),this.masterDryGainNode&&(this.masterDryGainNode.gain.value=1,console.log("🎚️ Dry path gain set to 1.0 (always audible)")),this.masterFilterNode&&this.masterFilterNode.frequency.value<20&&(console.warn(`⚠️ Filter frequency is very low (${this.masterFilterNode.frequency.value}Hz), might block audio. Setting to 2000Hz.`),this.masterFilterNode.frequency.value=2e3),this._requestMasterFilterUpdate(!0),this.masterGainNode.gain.value=this.masterVolume,this.masterPanNode.pan.value=this.masterPan,this._verifyMasterChainConnection(),this.gainNode=this.masterGainNode,console.log("💡 Master channel ready - will route Strudel through it during init"),!AudioNode.prototype.__originalConnect){AudioNode.prototype.__originalConnect=AudioNode.prototype.connect;const i=this.masterPanNode,o=this.masterFilterNode,l=this.masterGainNode,c=this.audioContext,u=this,h=this._realDestination;AudioNode.prototype.connect=function(d,m,y){var H,me,Oe,Pe,De,Se,ae,Ee,Qe,Ke,ge,Ye,yt,Xe,Ge,Ct,Et,gn,On,qn,cn,un,Rt,Kt,Un,Wn;if(u&&u._routingBypass===!0)return this.__originalConnect.call(this,d,m,y);const O=this.context,S=d==null?void 0:d.context,A=O&&O===c,F=S&&S===c,j=d===h||d===c.destination;if(!A||!(F||d&&!S&&j))return this.__originalConnect.call(this,d,m,y);const $=bn=>!!(bn&&bn.__strudelVisualizerNode);if($(this)||$(d))return this.__originalConnect.call(this,d,m,y);if(u&&u.masterActive){const bn=this.constructor.name,rt=((H=d==null?void 0:d.constructor)==null?void 0:H.name)||"unknown",Pn=d===h||d===c.destination||((me=d==null?void 0:d.constructor)==null?void 0:me.name)==="AudioDestinationNode",pt=d===((Pe=(Oe=window.strudel)==null?void 0:Oe.scheduler)==null?void 0:Pe.output),Vt=d===(u==null?void 0:u.masterPanNode),Zt=pt?"(scheduler.output!)":Vt?"(masterPanNode!)":"";u._allConnectionsDebugLogged||(u._allConnectionsDebugLogged=new Set);const _n=`${bn}->${rt}`;u._allConnectionsDebugLogged.has(_n)||(console.log(`🔊 CONNECTION DEBUG: ${bn} -> ${rt}${Zt}, isDestination=${Pn}, context=${this.context===c?"OUR":"OTHER"}`),u._allConnectionsDebugLogged.add(_n))}const L=this.constructor.name==="AnalyserNode",I=d===h||d===c.destination||u&&d===u.masterPanNode,q=d&&d.constructor&&d.constructor.name==="AudioDestinationNode";if((I||q)&&!L){u._allDestConnectionsLogged||(u._allDestConnectionsLogged=new Set);const bn=`${this.constructor.name}->${(De=d==null?void 0:d.constructor)==null?void 0:De.name}`;u._allDestConnectionsLogged.has(bn)||(u._logRoute(`🎚️ 🔴 DESTINATION CONNECTION: ${this.constructor.name} -> ${(Se=d==null?void 0:d.constructor)==null?void 0:Se.name}, masterActive=${u.masterActive}, trackedPatterns=${u.trackedPatterns.size}`),u._allDestConnectionsLogged.add(bn))}if(u.masterActive&&!L){u._allConnectionsLogged||(u._allConnectionsLogged=new Set);const bn=`${this.constructor.name}->${(ae=d==null?void 0:d.constructor)==null?void 0:ae.name}`;u._allConnectionsLogged.has(bn)||(u._logRoute(`🎚️ Connection attempt: ${this.constructor.name} -> ${(Ee=d==null?void 0:d.constructor)==null?void 0:Ee.name}, isMasterDest=${I}, isAnyDest=${q}, masterActive=${u.masterActive}`),u._allConnectionsLogged.add(bn))}const ce=(I||q)&&!L,ee=u.masterActive&&u.trackedPatterns.size>0,he=ee;if(d&&d.constructor&&d.constructor.name==="StereoPannerNode"&&(u._debugStereoPanConnectionLogged||(console.log(`🔍 DEBUG: ${this.constructor.name} -> StereoPannerNode connection attempt`),console.log(`  isMasterDestination: ${I}`),console.log(`  isAnyAudioContextDestination: ${q}`),console.log(`  isAnalyserNode: ${L}`),console.log(`  shouldIntercept: ${ce}`),console.log(`  destination === realDestination: ${d===h}`),console.log(`  destination === audioContextInstance.destination: ${d===c.destination}`),console.log(`  destination === soundManagerInstance.masterPanNode: ${d===u.masterPanNode}`),u._debugStereoPanConnectionLogged=!0)),ce&&d===u.masterPanNode&&d!==h){u._masterPanConnectionsLogged||(u._masterPanConnectionsLogged=new Set);const bn=`${this.constructor.name}->${d.constructor.name}`;return u._masterPanConnectionsLogged.has(bn)||(console.log(`🎚️ ✅ Allowing ${this.constructor.name} to connect naturally to masterPanNode (master chain will handle routing)`),console.log(`🎚️ ✅ Master chain: masterPan(${((Ke=(Qe=u.masterPanNode)==null?void 0:Qe.pan)==null?void 0:Ke.value)||"N/A"}) -> masterFilter(${((Ye=(ge=u.masterFilterNode)==null?void 0:ge.frequency)==null?void 0:Ye.value)||"N/A"}Hz) -> masterDryGain(${((Xe=(yt=u.masterDryGainNode)==null?void 0:yt.gain)==null?void 0:Xe.value)||"N/A"}) -> masterGain(${((Ct=(Ge=u.masterGainNode)==null?void 0:Ge.gain)==null?void 0:Ct.value)||"N/A"}) -> destination`),u._masterPanConnectionsLogged.add(bn)),this.__originalConnect.call(this,d,m,y)}if(ce){u._masterDestinationConnectLogged||(u._logRoute(`🎚️ ✅ INTERCEPTING connection to destination: ${this.constructor.name} -> ${(Et=d==null?void 0:d.constructor)==null?void 0:Et.name}, masterActive=${u.masterActive}, trackedPatterns=${u.trackedPatterns.size}`),u._masterDestinationConnectLogged=!0),u._nodeTypeConnectLogged||(u._nodeTypeConnectLogged=new Set);const bn=this.constructor.name;u._nodeTypeConnectLogged.has(bn)||(u._logRoute(`🎚️ Intercepting ${bn} connecting to ${(gn=d==null?void 0:d.constructor)==null?void 0:gn.name}`),u._nodeTypeConnectLogged.add(bn));let rt=null;if(!he&&u.masterActive&&u.trackedPatterns.size>0){const pt=Array.from(u.trackedPatterns.keys());if(pt.length===1)rt=pt[0],u._singleElementMasterRoutingLogged||(u._logRoute(`🎚️ Single element master detected, routing through ${rt} (trackedPatterns.size=${u.trackedPatterns.size})`),u._logRoute(`🎚️ currentEvaluatingSlot=${u.currentEvaluatingSlot}, patternSlotToElementId mapping:`,Array.from(u.patternSlotToElementId.entries())),u._singleElementMasterRoutingLogged=!0);else if(u.currentEvaluatingSlot){const Vt=u.patternSlotToElementId.get(u.currentEvaluatingSlot);Vt&&pt.includes(Vt)&&(rt=Vt,u._logRoute(`🎚️ Multi-element evaluate: routing via currentEvaluatingSlot ${u.currentEvaluatingSlot} -> ${rt}`))}}if(u.masterActive&&!rt&&u.currentEvaluatingSlot&&(rt=u.patternSlotToElementId.get(u.currentEvaluatingSlot),rt?u._logRoute(`🎚️ Found element from currentEvaluatingSlot: ${rt} (slot: ${u.currentEvaluatingSlot})`):u._logRoute(`🎚️ currentEvaluatingSlot=${u.currentEvaluatingSlot} but no mapping found. Available mappings:`,Array.from(u.patternSlotToElementId.entries()))),!rt)for(const[pt,Vt]of u.patternSlotToElementId.entries())try{const Zt=globalThis[pt];if(Zt&&Zt!==globalThis.silence){rt=Vt,u._logRoute(`🎚️ Found element from active slot: ${rt} (slot: ${pt})`);break}}catch{}if(rt){const pt=u.getElementAudioNodes(rt);if(pt&&pt.gainNode){const Vt=pt.panNode;if(this.__punchcardMasterRouted&&this.__punchcardMasterConnectionNode&&typeof this.disconnect=="function"){try{this.disconnect(this.__punchcardMasterConnectionNode),u._logRoute(`🎚️ Disconnected ${this.constructor.name} from master fallback before routing through element chain`)}catch{}this.__punchcardMasterRouted=!1,this.__punchcardMasterConnectionNode=null}if(Vt)if(u.masterPanNode||u.masterGainNode)try{u._panNodeConnectedToMaster||(u._panNodeConnectedToMaster=new Set);const _e=`${rt}-${u.masterPanNode?"pan":"gain"}`;if(!u._panNodeConnectedToMaster.has(_e)){let Lt=!1;if(u.masterPanNode)try{Vt.connect(u.masterPanNode),Lt=!0,u._panNodeConnectedToMaster.add(_e),u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.has(rt)||(u._logRoute(`🎚️ ✅ Connected ${rt} panNode -> masterPanNode`),u._panNodeConnectedLogged.add(rt))}catch(et){if(et.message.includes("already connected")||et.message.includes("already been connected"))u._panNodeConnectedToMaster.add(_e),Lt=!0;else throw et}else if(u.masterGainNode)try{Vt.connect(u.masterGainNode),Lt=!0,u._panNodeConnectedToMaster.add(_e),u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.has(rt)||(u._logRoute(`🎚️ ✅ Connected ${rt} panNode -> masterGainNode (fallback)`),u._panNodeConnectedLogged.add(rt))}catch(et){if(et.message.includes("already connected")||et.message.includes("already been connected"))u._panNodeConnectedToMaster.add(_e),Lt=!0;else throw et}Lt||console.error(`❌ ${rt} panNode: Master nodes exist but connection failed!`)}}catch(_e){u._panNodeConnectionErrorLogged||(u._panNodeConnectionErrorLogged=new Set),u._panNodeConnectionErrorLogged.has(rt)||(console.error(`❌ Failed to connect ${rt} panNode to master chain:`,_e.message),console.error("   panNode:",Vt),console.error("   masterPanNode:",u.masterPanNode),console.error("   masterGainNode:",u.masterGainNode),u._panNodeConnectionErrorLogged.add(rt))}else u._panNodeNotConnectedLogged||(u._panNodeNotConnectedLogged=new Set),u._panNodeNotConnectedLogged.has(rt)||(console.warn(`⚠️ ${rt} panNode: Master nodes not available yet (will connect when available)`),u._panNodeNotConnectedLogged.add(rt));let Zt=[];Zt.push(`gainNode: gain=${pt.gainNode.gain.value.toFixed(3)}, inputs=${pt.gainNode.numberOfInputs}, outputs=${pt.gainNode.numberOfOutputs}`),Vt?Zt.push(`panNode: pan=${Vt.pan.value.toFixed(3)}, inputs=${Vt.numberOfInputs}, outputs=${Vt.numberOfOutputs}`):Zt.push("panNode: MISSING"),u.masterPanNode?Zt.push(`masterPanNode: inputs=${u.masterPanNode.numberOfInputs}, outputs=${u.masterPanNode.numberOfOutputs}`):Zt.push("masterPanNode: MISSING"),u.masterGainNode?Zt.push(`masterGainNode: gain=${u.masterGainNode.gain.value.toFixed(3)}, inputs=${u.masterGainNode.numberOfInputs}, outputs=${u.masterGainNode.numberOfOutputs}`):Zt.push("masterGainNode: MISSING"),u._chainVerificationLogged||(u._chainVerificationLogged=new Set),u._chainVerificationLogged.has(rt)||(u._logRoute(`🎚️ INTERCEPTED: Routing ${rt} audio through element gain node (${this.constructor.name} -> ${pt.gainNode.constructor.name})`),u._logRoute(`🎚️ Audio chain verification for ${rt}:`,Zt.join(", ")),u._chainVerificationLogged.add(rt));const _n=pt.panNode;if(_n&&!((On=u._panNodeConnectedLogged)!=null&&On.has(rt)))try{if(u.masterPanNode)try{_n.connect(u.masterPanNode),u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.add(rt),u._logRoute(`🎚️ ✅ CRITICAL: Connected ${rt} panNode -> masterPanNode`)}catch{u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.add(rt)}else if(u.masterGainNode)try{_n.connect(u.masterGainNode),u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.add(rt),u._logRoute(`🎚️ ✅ CRITICAL: Connected ${rt} panNode -> masterGainNode (fallback)`)}catch{u._panNodeConnectedLogged||(u._panNodeConnectedLogged=new Set),u._panNodeConnectedLogged.add(rt)}}catch(Ft){console.error(`❌ CRITICAL: Failed to connect ${rt} panNode: ${Ft.message}`)}try{typeof this.disconnect=="function"&&this.disconnect(pt.gainNode)}catch{}const it=this.__originalConnect.call(this,pt.gainNode,m,y);if(u._masterGainDestVerifiedAfterRouting||(u._masterGainDestVerifiedAfterRouting=new Set),!u._masterGainDestVerifiedAfterRouting.has(rt))if(u._masterGainDestVerifiedAfterRouting.add(rt),u._logRoute(`🎚️ 🔍 VERIFYING: masterGainNode=${!!u.masterGainNode}, _realDestination=${!!u._realDestination}, gain=${((un=(cn=(qn=u.masterGainNode)==null?void 0:qn.gain)==null?void 0:cn.value)==null?void 0:un.toFixed(3))||"N/A"}, muted=${u.masterMuted}`),u.masterGainNode&&u._realDestination)try{u.masterGainNode.__originalConnect?u.masterGainNode.__originalConnect.call(u.masterGainNode,u._realDestination):u.masterGainNode.connect(u._realDestination),u._logRoute(`🎚️ ✅ CRITICAL: Connected masterGainNode -> destination after routing ${rt} (gain=${u.masterGainNode.gain.value.toFixed(3)}, muted=${u.masterMuted})`)}catch(Ft){u._logRoute(`🎚️ ✅ CRITICAL: masterGainNode -> destination already connected for ${rt} (${Ft.message})`)}else console.error(`❌ CRITICAL: Cannot verify masterGainNode -> destination: masterGainNode=${!!u.masterGainNode}, _realDestination=${!!u._realDestination}`);return u._connectionSuccessLogged||(u._connectionSuccessLogged=new Set),u._connectionSuccessLogged.has(rt)||(u._logRoute(`🎚️ Connection result for ${rt}: ${it?"SUCCESS":"FAILED"}, source inputs now: ${pt.gainNode.numberOfInputs}`),u._connectionSuccessLogged.add(rt)),this.__punchcardElementRouted!==!0&&(this.__punchcardElementRouted=!0),it}else console.error(`❌ CRITICAL: Element ${rt} found but no gain node available - elementNodes=${!!pt}, gainNode=${!!(pt!=null&&pt.gainNode)}`),console.error("❌ This means audio will bypass element controls!"),rt=null}else{if(ee){u._stackMasterRoutingLogged||(console.log(`🎚️ Stack() pattern: Routing through master chain (${u.trackedPatterns.size} elements)`),console.log(`🎚️ Stack() routing: masterPanNode=${!!i}, masterFilterNode=${!!o}, masterGainNode=${!!l}, gain=${((Kt=(Rt=l==null?void 0:l.gain)==null?void 0:Rt.value)==null?void 0:Kt.toFixed(3))||"N/A"}, muted=${u.masterMuted}`),u._stackMasterRoutingLogged=!0);const Vt=i||o||l;if(Vt){if(l&&u._realDestination&&!u._stackRoutingVerified)try{l.__originalConnect.call(l,u._realDestination),console.log(`🎚️ ✅ Stack() routing: Verified masterGainNode -> destination connection (gain=${l.gain.value.toFixed(3)})`),u._stackRoutingVerified=!0}catch(Zt){Zt.message&&Zt.message.includes("already connected")?u._stackRoutingVerified||(console.log("🎚️ ✅ Stack() routing: masterGainNode -> destination already connected"),u._stackRoutingVerified=!0):console.error("❌ Stack() routing: Failed to connect masterGainNode -> destination:",Zt.message)}return this.__originalConnect.call(this,Vt,m,y)}}u._noElementRoutingLogged||(u._logRoute(`🎚️ No element found for routing - trackedPatterns.size=${u.trackedPatterns.size}, currentEvaluatingSlot=${u.currentEvaluatingSlot}`),u._logRoute("🎚️ Available pattern slot mappings:",Array.from(u.patternSlotToElementId.entries())),u._logRoute("🎚️ Tracked elements:",Array.from(u.trackedPatterns.keys())),u._noElementRoutingLogged=!0)}if(!rt&&i)return u._masterFallbackRoutingLogged||(u._logRoute(`🎚️ ⚠️ FALLBACK: No element found, routing through master chain: ${this.constructor.name} -> masterPanNode`),u._masterFallbackRoutingLogged=!0),this.__punchcardMasterRouted=!0,this.__punchcardMasterConnectionNode=i,this.__originalConnect.call(this,i,m,y);if(u.masterActive&&u.trackedPatterns.size===1&&!rt){const pt=Array.from(u.trackedPatterns.keys());u._logRoute(`🎚️ 🔍 FALLBACK CHECK: trackedPatterns.size=${u.trackedPatterns.size}, elementId=${rt}, trackedElementIds=${pt.join(", ")}`),pt.length===1?(rt=pt[0],u._logRoute(`🎚️ ⚠️ Fallback: Using tracked element ${rt} for routing (elementId was null)`)):console.warn(`🎚️ ⚠️ Fallback: trackedElementIds.length=${pt.length}, expected 1`)}else u.trackedPatterns.size!==1?console.log(`🎚️ 🔍 FALLBACK SKIP: trackedPatterns.size=${u.trackedPatterns.size}, elementId=${rt} (not single element, skipping fallback)`):rt&&console.log(`🎚️ 🔍 FALLBACK SKIP: trackedPatterns.size=${u.trackedPatterns.size}, elementId=${rt} (elementId already set, skipping fallback)`);if(rt){console.log(`🎚️ 🔍 FALLBACK ROUTING ATTEMPT: elementId=${rt}, attempting to get elementNodes...`);const pt=u.getElementAudioNodes(rt);if(console.log(`🎚️ 🔍 FALLBACK ROUTING: elementNodes=${!!pt}, gainNode=${!!(pt!=null&&pt.gainNode)}, panNode=${!!(pt!=null&&pt.panNode)}`),pt&&pt.gainNode){const Vt=pt.panNode;if(Vt&&i)try{try{Vt.disconnect(i)}catch{}Vt.connect(i)}catch{}return console.log(`🎚️ ✅ FALLBACK ROUTING: Routing ${this.constructor.name} through ${rt} element chain (gain=${pt.gainNode.gain.value.toFixed(3)})`),this.__originalConnect.call(this,pt.gainNode,m,y)}else console.error(`❌ CRITICAL FALLBACK: Element ${rt} found but elementNodes or gainNode is missing - elementNodes=${!!pt}, gainNode=${!!(pt!=null&&pt.gainNode)}`),console.error("❌ Audio will route through master chain, bypassing element controls!")}else console.log("🎚️ 🔍 FALLBACK ROUTING SKIP: elementId is null, will route through master chain");const Pn=i||o||l;if(Pn&&!rt){if(this.__punchcardElementRouted)return console.log(`🎚️ Skipping master fallback for ${this.constructor.name} (already routed through element chain)`),this.__originalConnect.call(this,d,m,y);u._masterRoutingLogged||(u._masterRoutingLogged=new Set);const pt=`master-${Pn.constructor.name}`;if(!u._masterRoutingLogged.has(pt)){if(u._masterRoutingLogged.add(pt),console.log(`🎚️ ⚠️ FALLBACK: Routing ${this.constructor.name} through master chain (${Pn.constructor.name}) - element routing not available`),console.log(`🎚️ ⚠️ FALLBACK: masterGainNode.gain=${((Wn=(Un=l==null?void 0:l.gain)==null?void 0:Un.value)==null?void 0:Wn.toFixed(3))||"N/A"}, muted=${u.masterMuted}, connected to destination=${!!u._realDestination}`),i&&l)try{i.connect(l),console.log("🎚️ ✅ FALLBACK: Verified masterPanNode -> masterGainNode connection")}catch(Zt){Zt.message.includes("already connected")||Zt.message.includes("already been connected")?console.log("🎚️ ✅ FALLBACK: masterPanNode -> masterGainNode already connected"):console.warn(`⚠️ FALLBACK: Could not connect masterPanNode -> masterGainNode: ${Zt.message}`)}if(l&&u._realDestination)try{l.__originalConnect?l.__originalConnect.call(l,u._realDestination):l.connect(u._realDestination),console.log(`🎚️ ✅ FALLBACK: Ensured masterGainNode -> destination connection (gain=${l.gain.value.toFixed(3)})`)}catch(Zt){Zt.message&&Zt.message.includes("already connected")?console.log("🎚️ ✅ FALLBACK: masterGainNode -> destination already connected"):console.warn(`⚠️ FALLBACK: Could not connect masterGainNode -> destination: ${Zt.message}`)}}const Vt=this.__originalConnect.call(this,Pn,m,y);return this.__punchcardMasterRouted=!0,this.__punchcardMasterConnectionNode=Pn,Vt}if(!i&&!l&&console.warn("⚠️ No master nodes available, allowing direct connection to destination"),l&&h&&!u._masterGainDestVerified)try{l.__originalConnect?l.__originalConnect.call(l,h):l.connect(h),console.log("🎚️ ✅ Ensured masterGainNode -> destination connection (critical for audio output)"),u._masterGainDestVerified=!0}catch(pt){pt.message&&pt.message.includes("already connected")?console.log("🎚️ ✅ masterGainNode -> destination already connected"):console.log(`🎚️ masterGainNode -> destination: ${pt.message||"connection verified"}`),u._masterGainDestVerified=!0}}return this.__originalConnect.call(this,d,m,y)},console.log("🎚️ Patched AudioNode.prototype.connect to route through element gain nodes or master channel"),console.log("🎚️ Hijacking verification: AudioNode.prototype.__originalConnect exists:",!!AudioNode.prototype.__originalConnect),console.log("🎚️ Hijacking verification: AudioNode.prototype.connect is patched:",AudioNode.prototype.connect!==AudioNode.prototype.__originalConnect)}this.audioContext.__masterPanNode=this.masterPanNode,console.log("Audio context created with master channel, state:",this.audioContext.state),this.strudelLoaded||(Br(this,"🎚️ Loading Strudel after hijacking AudioContext and connect() (master nodes ready)..."),await this.loadStrudelFromCDN()),Br(this,`🎚️ Master initialized: volume=${(this.masterVolume*100).toFixed(0)}%, pan=${this.masterPan.toFixed(2)}`)}if(this.audioContext.state==="suspended")try{Qu(),await this.audioContext.resume(),this.audioContext.state==="running"?console.log("Audio context resumed successfully"):console.log("Audio context state:",this.audioContext.state)}catch(t){return t.message&&t.message.includes("user gesture")||console.error("Cannot resume audio context:",t),!1}return this.audioContext&&this.audioContext.state==="running"?(this.initialized=!0,console.log("Sound Manager initialized successfully"),this.masterGainNode&&(this.masterGainNode.gain.value=this.masterVolume),this.masterPanNode&&(this.masterPanNode.pan.value=this.masterPan),Br(this,`🎚️ Master values set: volume=${(this.masterVolume*100).toFixed(0)}%, pan=${this.masterPan.toFixed(2)}`),this._verifyMasterChainConnection(),console.log("🎵 Starting Strudel initialization and sound bank loading..."),this.initializeStrudelAndSounds().catch(t=>{console.error("Failed to initialize Strudel/sounds:",t)}),this.preloadAudioFiles().catch(t=>{console.log("Background audio preload failed:",t)}),!0):(console.warn("Audio context not in running state:",(e=this.audioContext)==null?void 0:e.state),!1)}catch(t){return console.error("Failed to initialize audio context:",t),this.initialized=!1,!1}}async preloadAudioFiles(){const e=hs.getAudioElements();for(const t of e)if(t.audioFile)try{(await fetch(t.audioFile,{method:"HEAD"})).ok?await this.loadAudioFile(t.id,t.audioFile):console.log(`Skipping preload for ${t.id} (file not found): ${t.audioFile}`)}catch{}}async loadAudioFile(e,t){try{const s=await fetch(t);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const r=await s.arrayBuffer(),a=await this.audioContext.decodeAudioData(r);return this.audioBuffers.set(e,a),a}catch(s){throw console.error(`Error loading audio file ${t}:`,s),s}}setVolume(e){this.volume=Math.max(0,Math.min(1,e)),this.gainNode&&(this.gainNode.gain.value=this.volume)}setMasterVolume(e){this.masterVolume=Math.max(0,Math.min(1,e)),this.masterGainNode?(this.masterGainNode.gain.value=this.masterVolume,Br(this,`🎚️ Master volume set to ${(this.masterVolume*100).toFixed(0)}% (gainNode instant via Web Audio API)`)):Br(this,`🎚️ Master volume stored as ${(this.masterVolume*100).toFixed(0)}% (gainNode not ready yet)`)}setMasterPan(e){this.masterPan=Math.max(-1,Math.min(1,e)),this.masterPanNode?(this.masterPanNode.pan.value=this.masterPan,Br(this,`🎚️ Master pan set to ${this.masterPan.toFixed(2)} (panNode instant via Web Audio API)`)):Br(this,`🎚️ Master pan stored as ${this.masterPan.toFixed(2)} (panNode not ready yet)`)}enableMasterFilter(e){const t=!!e;this.masterFilterEnabled!==t&&(this.masterFilterEnabled=t,this._requestMasterFilterUpdate(!0))}setMasterFilterFrequency(e,t=!1){const s=Number(e);if(Number.isFinite(s)){const r=Math.max(this.masterFilterMinHz,Math.min(this.masterFilterMaxHz,s));this.masterFilterFrequency=r,this._requestMasterFilterUpdate(t)}}setMasterFilterResonance(e,t=!1){const s=Number(e);if(Number.isFinite(s)){const r=Math.max(this.masterFilterMinQ,Math.min(this.masterFilterMaxQ,s));this.masterFilterResonance=r,this._requestMasterFilterUpdate(t)}}setMasterDelayAmount(e){const t=Number(e);if(Number.isFinite(t)&&this.masterDelayGainNode){const s=Math.max(0,Math.min(1,t));this.masterDelayAmount=s,this.masterDelayGainNode.gain.value=s}}setMasterDelayFeedback(e){const t=Number(e);if(Number.isFinite(t)&&this.masterDelayFeedbackGainNode){const s=Math.max(0,Math.min(1,t));this.masterDelayFeedback=s,this.masterDelayFeedbackGainNode.gain.value=s}}setMasterReverbAmount(e){const t=Number(e);if(Number.isFinite(t)&&this.masterReverbGainNode){const s=Math.max(0,Math.min(5,t));this.masterReverbAmount=s,this.masterReverbGainNode.gain.value=s}}setMasterReverbRoomSize(e){const t=Number(e);if(Number.isFinite(t)){const s=Math.max(0,Math.min(4,t));this.masterReverbRoomSize=s,this._createReverbImpulseResponse()}}_createReverbImpulseResponse(){if(!this.audioContext||!this.masterReverbNode)return;const e=this.audioContext.sampleRate,t=e*2,s=this.audioContext.createBuffer(2,t,e),r=this.masterReverbRoomSize;for(let a=0;a<2;a++){const i=s.getChannelData(a);for(let o=0;o<t;o++){const l=t-o,c=Math.pow(1-l/t,2),u=Math.pow(c,1+r);i[o]=(Math.random()*2-1)*u}}this.masterReverbNode.buffer=s}_requestMasterFilterUpdate(e=!1){if(!this.masterFilterNode||!this.audioContext)return;if(e){this._masterFilterUpdateTimeout&&(clearTimeout(this._masterFilterUpdateTimeout),this._masterFilterUpdateTimeout=null),this._lastMasterFilterUpdateTime=typeof performance<"u"?performance.now():Date.now(),this._updateMasterFilterNode(!0);return}const t=typeof performance<"u"?performance.now():Date.now(),s=Math.max(8,this.masterFilterMinUpdateMs||0),r=t-(this._lastMasterFilterUpdateTime||0);if(r>=s){this._lastMasterFilterUpdateTime=t,this._updateMasterFilterNode(!1);return}if(this._masterFilterUpdateTimeout)return;const a=Math.max(4,s-r);this._masterFilterUpdateTimeout=setTimeout(()=>{this._masterFilterUpdateTimeout=null,this._lastMasterFilterUpdateTime=typeof performance<"u"?performance.now():Date.now(),this._updateMasterFilterNode(!1)},a)}_updateMasterFilterNode(e=!1){if(!this.masterFilterNode||!this.audioContext)return;const t=this.audioContext.currentTime||0,s=this.masterFilterEnabled?Math.max(this.masterFilterMinHz,Math.min(this.masterFilterMaxHz,this.masterFilterFrequency||this.masterFilterMaxHz)):this.masterFilterBypassHz,r=this.masterFilterEnabled?Math.max(this.masterFilterMinQ,Math.min(this.masterFilterMaxQ,this.masterFilterResonance||this.masterFilterMinQ)):this.masterFilterMinQ,a=this.masterFilterNode.frequency,i=this.masterFilterNode.Q;if(e)a.cancelScheduledValues(t),i.cancelScheduledValues(t),a.setValueAtTime(s,t),i.setValueAtTime(r,t);else{const o=Math.max(.01,this.masterFilterSmoothing||.05);a.cancelScheduledValues(t),i.cancelScheduledValues(t),a.setTargetAtTime(s,t,o),i.setTargetAtTime(r,t,o)}}toggleMasterMute(){return this.masterMuted=!this.masterMuted,this.masterMuted?(this.masterVolumeBeforeMute=this.masterVolume,this.masterGainNode&&(this.masterGainNode.gain.value=0),console.log("🔇 Master muted (instant via Web Audio API)")):(this.masterGainNode&&(this.masterGainNode.gain.value=this.masterVolumeBeforeMute),this.masterVolume=this.masterVolumeBeforeMute,console.log(`🔊 Master unmuted (volume: ${(this.masterVolume*100).toFixed(0)}%) (instant via Web Audio API)`)),this.masterMuted}getElementAudioNodes(e){if(!this.audioContext)return null;if(!this.elementGainNodes.has(e)){const t=this.audioContext.createGain(),s=this.audioContext.createStereoPanner(),r=this.elementGainValues.get(e)||.8,a=this.elementPanValues.get(e)||0;this.elementGainNodes.set(e,t),this.elementPanNodes.set(e,s),this.elementGainValues.set(e,r),this.elementPanValues.set(e,a),t.gain.value=r*this.volume,s.pan.value=a,t.connect(s);let i=!1;if(this.masterPanNode)try{s.connect(this.masterPanNode),i=!0,Br(this,`🎚️ ${e}: Connected panNode to masterPanNode during node creation`)}catch(o){console.warn(`⚠️ ${e}: Failed to connect panNode to masterPanNode:`,o.message)}else if(this.masterGainNode)try{s.connect(this.masterGainNode),i=!0,Br(this,`🎚️ ${e}: Connected panNode to masterGainNode during node creation`)}catch(o){console.warn(`⚠️ ${e}: Failed to connect panNode to masterGainNode:`,o.message)}else if(this.gainNode)try{s.connect(this.gainNode),i=!0,Br(this,`🎚️ ${e}: Connected panNode to gainNode during node creation`)}catch(o){console.warn(`⚠️ ${e}: Failed to connect panNode to gainNode:`,o.message)}i||console.warn(`⚠️ ${e}: panNode not connected to master chain (master nodes may not exist yet - will connect on first audio connection)`),Br(this,`🎚️ Element audio chain for ${e}:`),console.log(`   gainNode (${t.numberOfInputs} inputs, ${t.numberOfOutputs} outputs)`),console.log(`   panNode (${s.numberOfInputs} inputs, ${s.numberOfOutputs} outputs)`),console.log(`   masterPanNode (${this.masterPanNode?this.masterPanNode.numberOfInputs:"N/A"} inputs)`),Br(this,`🎚️ Created element audio chain for ${e}: gain -> pan -> master`)}return{gainNode:this.elementGainNodes.get(e),panNode:this.elementPanNodes.get(e)}}disposeElementAudioNodes(e){if(!e)return;const t=this.elementGainNodes.get(e),s=this.elementPanNodes.get(e);if(t){try{t.disconnect()}catch{}this.elementGainNodes.delete(e)}if(s){try{s.disconnect()}catch{}this.elementPanNodes.delete(e)}this.elementGainValues.delete(e),this.elementPanValues.delete(e),this._panNodeConnectedToMaster&&(this._panNodeConnectedToMaster.delete(`${e}-pan`),this._panNodeConnectedToMaster.delete(`${e}-gain`))}isNotePattern(e){return!e||typeof e!="string"?!1:/\b(note|n)\s*\(/.test(e)}applyElementGainPanToPattern(e,t,s={}){const{applyGainInPattern:r=!0,applyPanInPattern:a=!0,applyTempoInPattern:i=!0}=s,o=this.elementGainValues.get(t)||.8,l=this.elementPanValues.get(t)||0,c=this.currentTempo||120;let u=e;u=u.replace(/\.postgain\s*\([^)]*\)/g,""),u=u.replace(/\.pan\s*\([^)]*\)/g,""),u=u.replace(/\.\.+/g,".").trim(),u=u.replace(/\.+$/,"").trim(),r&&(/\.postgain\s*\([^)]*\)\s*$/i.test(u)?u=u.replace(/\.postgain\s*\([^)]*\)\s*$/i,`.postgain(${o})`):u=`${u}.postgain(${o})`),a&&l!==0&&(u+=`.pan(${l})`);const h=c/120;return i&&(h>1?u+=`.fast(${h})`:h<1&&(u+=`.slow(${1/h})`)),console.log(`Applied gain=${o.toFixed(2)}, pan=${l.toFixed(2)}, tempo=${c} BPM (speed=${h.toFixed(2)}x) to ${t}`),u}async processPattern(e,t,s={}){const{preserveBanks:r=!1,attemptBankLoad:a=!1}=s||{};if(!e||typeof e!="string"||e.trim()==="")return null;let i=e.replace(/\r/g,"").split(`
`).map(c=>c.replace(/[ \t]+$/g,"")).join(`
`).trim();if(i=i.replace(/[ \t]+\./g,".").trim(),i=i.replace(/\n+\s*\./g,"."),i=i.replace(/\.\.+/g,".").trim(),i=i.replace(/\.(cpm|fast|slow)\([^)]*\)/g,"").trim(),i=i.replace(/\.\.+/g,".").trim(),i=Sw(i),!i||i==="")return console.warn(`[${t}] Pattern became empty after processing - cannot process`),null;const o=i.match(/\.bank\(["']([^"']+)["']\)/g);if(o){const c=o.map(h=>h.match(/\.bank\(["']([^"']+)["']\)/)[1]);console.log(`[${t}] Pattern uses bank(s):`,c);let u=!1;for(const h of c){const d=h,y=["RolandTR808","RolandTR909","RolandTR707","RhythmAce","AkaiLinn","ViscoSpaceDrum","CasioRZ1"].includes(d);let O=this.loadedBanks.has(d)||y;if(!O&&a&&typeof this.loadBank=="function")try{console.log(`[${t}] Attempting to load bank "${d}" for pattern processing`),await this.loadBank(d)?(this.loadedBanks.add(d),O=!0,console.log(`[${t}] Bank "${d}" loaded successfully for pattern processing`)):console.warn(`[${t}] Bank "${d}" could not be loaded on demand`)}catch(S){console.warn(`[${t}] Error loading bank "${d}":`,S)}!O&&!r?(console.warn(`⚠️ Bank "${d}" not loaded - removing .bank() modifier from pattern`),i=i.replace(new RegExp(`\\.bank(["']${d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}["'])`,"g"),""),u=!0):!O&&r?console.warn(`⚠️ Bank "${d}" is not loaded but preserving .bank() for preview`):y&&(console.log(`[${t}] Bank "${d}" is built-in - keeping .bank() modifier`),this.loadedBanks.add(d))}if(i=i.replace(/\.+$/,"").trim(),u&&!r&&(!i||i.trim()===""))return console.warn("⚠️ Pattern became empty after removing unloaded banks"),null;console.log(`[${t}] Pattern after bank cleanup:`,i.substring(0,100))}const l=s.applyGainInPattern!==void 0?s.applyGainInPattern:this.masterActive;return i=this.applyElementGainPanToPattern(i,t,{applyGainInPattern:l}),!i||i.trim()===""?(console.warn(`[${t}] Pattern became empty after applying gain/pan - cannot process`),null):i}async preEvaluatePattern(e,t){if(!window.strudel||!window.strudel.evaluate)return console.log(`[${e}] Cannot pre-evaluate: Strudel not ready`),!1;if(!t||typeof t!="string"||t.trim()==="")return console.log(`[${e}] No pattern to pre-evaluate`),this.patternCache.set(e,{processedPattern:null,patternSlot:this.getPatternSlot(e),isPreEvaluated:!1,originalPattern:t||""}),!1;const s=await this.processPattern(t,e);if(!s)return console.warn(`[${e}] Pattern processing failed - cannot cache`),this.patternCache.set(e,{processedPattern:null,patternSlot:this.getPatternSlot(e),isPreEvaluated:!1,originalPattern:t}),!1;const r=this.getPatternSlot(e);try{const a=`${r} = silence`;return await window.strudel.evaluate(a),this.patternCache.set(e,{processedPattern:s,patternSlot:r,isPreEvaluated:!0,originalPattern:t}),console.log(`✅ Pre-evaluated and cached pattern for ${e} in ${r} (silent, ready for manual trigger)`),!0}catch(a){return console.warn(`[${e}] Failed to pre-evaluate pattern:`,a),this.patternCache.set(e,{processedPattern:s,patternSlot:r,isPreEvaluated:!1,originalPattern:t}),!1}}invalidatePatternCache(e){this.patternCache.delete(e),console.log(`🗑️ Invalidated pattern cache for ${e}`)}async preloadAllPatterns(){if(!window.strudel||!window.strudel.evaluate){console.log("Cannot preload patterns: Strudel not ready");return}console.log("📦 Pre-loading all configured patterns...");const e=hs.elements||[];let t=0,s=0;for(const r of e){const a=r.id;let i=null;try{const l=localStorage.getItem(`element-config-${a}`);l&&(i=JSON.parse(l))}catch{}const o=(i==null?void 0:i.pattern)||(r==null?void 0:r.pattern)||"";o&&o.trim()!==""&&(await this.preEvaluatePattern(a,o)?t++:s++)}console.log(`✅ Pre-loaded ${t} patterns${s>0?`, ${s} failed`:""}`)}async setElementGain(e,t){const s=Math.max(0,Math.min(1,t)),r=this.elementGainValues.get(e);this.elementGainValues.set(e,s),console.log(`[${e}] Gain set to ${s.toFixed(2)}`);const a=this.elementGainNodes.get(e);a&&(a.gain.value=s*this.volume,Br(this,`🎚️ Updated ${e} gain node to ${(s*this.volume).toFixed(2)}`)),r!==s&&(this.patternCache.get(e)&&(this.patternCache.delete(e),console.log(`🗑️ Invalidated pattern cache for ${e} (gain changed)`)),this.trackedPatterns.has(e)&&await this.updateTrackedElementGain(e,s)),this.isPlaying(e)&&!this.masterActive&&r!==s&&this.updatePlayingPattern(e)}async setElementPan(e,t){const s=Math.max(-1,Math.min(1,t)),r=this.elementPanValues.get(e);this.elementPanValues.set(e,s),console.log(`[${e}] Pan set to ${s.toFixed(2)}`);const a=this.elementPanNodes.get(e);a&&(a.pan.value=s,Br(this,`🎚️ Updated ${e} pan node to ${s.toFixed(2)}`)),r!==s&&(this.patternCache.get(e)&&(this.patternCache.delete(e),console.log(`🗑️ Invalidated pattern cache for ${e} (pan changed)`)),this.trackedPatterns.has(e)&&await this.updateTrackedElementPan(e,s)),this.isPlaying(e)&&!this.masterActive&&r!==s&&this.updatePlayingPattern(e)}async updatePlayingPattern(e){const t=this.activeSounds.get(e);if(!t||t.type!=="strudel")return;const s=this.elementGainValues.get(e)||.8;if(s<=.001){console.log(`[${e}] Gain is ${s} (effectively muted) - stopping playback`),this.stopSound(e);return}const r=this.strudelPatternSlots.get(e);if(!(!r||!window.strudel||!window.strudel.evaluate))try{const a=hs.getElementConfig(e);if(!a||!a.pattern)return;let i=a.pattern.replace(/\._scope\(\)/g,"");i=this.applyElementGainPanToPattern(i,e,{applyGainInPattern:!1}),await window.strudel.evaluate(`${r} = ${i}`),console.log(`✅ Updated ${r} with new gain/pan`)}catch(a){console.warn(`Could not update pattern for ${e}:`,a)}}async updatePatternInPlace(e,t){if(this.trackedPatterns.has(e)){const a=this.trackedPatterns.get(e),i=t.replace(/[""]/g,'"').replace(/['']/g,"'");a.rawPattern=i,a.pattern=this.convertPatternForScale(i)||i,Br(this,`🎚️ Updated tracked pattern for ${e} in master: ${t.substring(0,60)}...`),await this.updateMasterPattern(this.soloedElements,this.mutedElements),this.masterActive&&this.scheduleMasterPatternRefresh(`pattern-update:${e}`)}const s=this.activeSounds.get(e);if(!s||s.type!=="strudel")return;const r=this.strudelPatternSlots.get(e);if(!(!r||!window.strudel||!window.strudel.evaluate)){this._lastAppliedPatterns=this._lastAppliedPatterns||new Map;try{let a=t.replace(/\s+/g," ").trim();a=a.replace(/\s+\./g,".").trim(),a=a.replace(/\.\.+/g,".").trim(),a=a.replace(/\.(cpm|fast|slow)\([^)]*\)/g,"").trim(),a=a.replace(/\.\.+/g,".").trim();const i=a.match(/\.bank\(["']([^"']+)["']\)/g);if(i){const l=i.map(c=>c.match(/\.bank\(["']([^"']+)["']\)/)[1]);for(const c of l)this.loadedBanks.has(c)||(a=a.replace(new RegExp(`\\.bank(["']${c}["'])`,"g"),""));a=a.replace(/\.+$/,"").trim()}if(a=this.applyElementGainPanToPattern(a,e,{applyGainInPattern:this.masterActive}),this._lastAppliedPatterns.get(e)===a){Br(this,`⚡ Skipping re-evaluation for ${e}; pattern unchanged.`);return}await window.strudel.evaluate(`${r} = ${a}`),console.log(`✅ Updated ${r} pattern in place: ${a.substring(0,60)}...`),this._lastAppliedPatterns.set(e,a)}catch(a){console.warn(`Could not update pattern in place for ${e}:`,a)}}}getElementGain(e){return this.elementGainValues.get(e)||.8}getElementPan(e){return this.elementPanValues.get(e)||0}async playSynthesizedSound(e,t){if(!this.initialized||!this.audioContext){console.log("Audio not initialized - waiting for user interaction");return}if(this.audioContext.state==="suspended")try{if(Qu(),await this.audioContext.resume(),this.audioContext.state!=="running"){console.log("Audio context not running - user interaction required");return}}catch{console.log("Audio context needs user interaction");return}this.stopSound(e);const s=this.parsePattern(t);if(s.sounds.length===0){console.warn(`No sounds parsed from pattern: ${t}`);return}console.log(`Playing pattern for ${e}:`,t,s);try{const r=this.createOscillatorForPattern(s,e);r&&r.gain?(this.activeSounds.set(e,{type:"synthesized",oscillator:r,gain:r.gain}),console.log(`Sound started for ${e}`)):console.error(`Failed to create oscillator for ${e}`)}catch(r){console.error(`Error playing sound for ${e}:`,r)}}parsePattern(e){let t=e;const s=e.match(/(?:sound|s)\(["']([^"']+)["']\)/);s&&(t=s[1]);const r={bd:{freq:60,duration:.1,type:"sine"},sd:{freq:200,duration:.05,type:"noise"},hh:{freq:800,duration:.02,type:"square"},cp:{freq:400,duration:.08,type:"triangle"},misc:{freq:300,duration:.06,type:"triangle"}},a=[];if(t.split(",").forEach((l,c)=>{let u=l.trim();u=u.replace(/(\w+)\*(\d+)/g,(m,y,O)=>Array(parseInt(O)).fill(y).join(" ")),u=u.replace(/\[([^\]]+)\]/g,(m,y)=>y.trim());const h=u.trim().split(/\s+/);let d=0;for(const m of h){if(m==="~"||m===""){d++;continue}r[m]&&a.push({...r[m],time:d*.25}),d++}}),a.length===0)return console.warn(`No sounds found in pattern: ${e}`),{sounds:[],duration:0};a.sort((l,c)=>l.time-c.time);const o=Math.max(...a.map(l=>l.time+l.duration));return{sounds:a,duration:Math.max(o,.5)}}parseIndexPattern(e){const t=[];let s=e.replace(/<([^>]+)>/g,(a,i)=>i.trim().split(/\s+/)[0]);s=s.replace(/\[([^\]]+)\]/g,(a,i)=>i.trim()),s=s.replace(/(\d+)\*(\d+)/g,(a,i,o)=>Array(parseInt(o)).fill(i).join(" "));const r=s.trim().split(/\s+/);for(const a of r){const i=parseInt(a);isNaN(i)||t.push(i)}return t}createPatternFromIndices(e){const t=["bd","sd","hh","cp","bd","sd","hh","cp"];return`sound("${e.map(r=>t[r%t.length]||"~").join(" ")}")`}createPatternFromSampleName(e){return e.includes("break")||e.includes("165")?'sound("bd ~ sd ~ bd ~ sd hh")':'sound("bd sd hh ~ cp ~ hh ~")'}createOscillatorForPattern(e,t){if(!this.audioContext)return console.error("Audio context not initialized"),{gain:null,stop:()=>{}};const s=this.audioContext.createGain(),r=t?this.getElementAudioNodes(t):null;r?(s.connect(r.gainNode),s.gain.value=1):(s.connect(this.gainNode),s.gain.value=this.volume);const a=this.audioContext.currentTime;e.sounds.forEach((o,l)=>{const c=a+o.time;if(o.type==="noise"){const u=Math.floor(this.audioContext.sampleRate*o.duration),h=this.audioContext.createBuffer(1,u,this.audioContext.sampleRate),d=h.getChannelData(0);for(let O=0;O<u;O++)d[O]=Math.random()*2-1;const m=this.audioContext.createBufferSource();m.buffer=h;const y=this.audioContext.createGain();m.connect(y),y.connect(s),y.gain.setValueAtTime(0,c),y.gain.linearRampToValueAtTime(.3,c+.01),y.gain.exponentialRampToValueAtTime(.01,c+o.duration),m.start(c),m.stop(c+o.duration)}else{const u=this.audioContext.createOscillator();u.type=o.type,u.frequency.value=o.freq;const h=this.audioContext.createGain();u.connect(h),h.connect(s),h.gain.setValueAtTime(0,c),h.gain.linearRampToValueAtTime(.5,c+.01),h.gain.exponentialRampToValueAtTime(.01,c+o.duration),u.start(c),u.stop(c+o.duration)}});const i=a+e.duration;return s.gain.setValueAtTime(this.volume,i),s.gain.exponentialRampToValueAtTime(.01,i+.1),{gain:s,stop:()=>{try{s.gain.cancelScheduledValues(this.audioContext.currentTime),s.gain.setValueAtTime(s.gain.value,this.audioContext.currentTime),s.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.1),setTimeout(()=>s.disconnect(),150)}catch(o){console.error("Error stopping sound:",o)}}}}playAudioFile(e,t){if(!this.initialized||!this.audioContext){console.warn("Audio not initialized yet. Please click anywhere first to enable audio.");return}this.audioContext.state==="suspended"&&(Qu(),this.audioContext.resume().catch(r=>{console.error("Failed to resume audio context:",r)})),this.stopSound(e);const s=this.audioBuffers.get(e);s?this.playAudioBuffer(e,s):this.loadAudioFile(e,t).then(r=>{this.playAudioBuffer(e,r)}).catch(r=>{console.error(`Failed to play audio for ${e}:`,r)})}playAudioBuffer(e,t){const s=this.audioContext.createBufferSource();s.buffer=t;const r=this.audioContext.createGain();s.connect(r);const a=this.getElementAudioNodes(e);a?(r.connect(a.gainNode),r.gain.value=1):(r.connect(this.gainNode),r.gain.value=this.volume);const i=a?1:this.volume;r.gain.setValueAtTime(0,this.audioContext.currentTime),r.gain.linearRampToValueAtTime(i,this.audioContext.currentTime+hs.defaults.fadeInTime),s.onended=()=>{this.activeSounds.delete(e)},s.start(0),this.activeSounds.set(e,{type:"audio",source:s,gain:r})}async playStrudelPattern(e,t,s,r=!1){var o;if(!t||typeof t!="string"||t.trim()===""){console.log(`[${e}] No pattern assigned - skipping playback`);return}const a=this.elementGainValues.get(e)||.8;if(a<=.001){console.log(`[${e}] Gain is ${a} (effectively muted) - stopping playback`),this.stopSound(e);return}if(this.masterOnlyPlayback){const l=typeof e=="string"&&e.toLowerCase().includes("preview"),c=l,u=await this.routePatternThroughMaster(e,t,{isPreview:l,autoStart:c});return console.log(`🎚️ Routed ${e} through master-only playback`,u),u}if(!r){const l=document.querySelector(`[data-sound-id="${e}"]`);if(l){const c=l.querySelector(".loop-button");if((c==null?void 0:c.classList.contains("active"))&&this.isPlaying(e)){console.log(`🔄 ${e} has loop active and is playing - skipping sound trigger to prevent layering`);return}}}if(!this.initialized||!this.audioContext){console.log("Audio not initialized - attempting to initialize now...");try{await this.initialize()||console.warn("⚠️ Audio initialization failed - sounds may not play until user clicks")}catch(l){console.warn("⚠️ Error initializing audio:",l)}}if(this.strudelSoundBanksLoaded||console.log(`⏳ Sound banks not fully loaded yet for ${e}, but attempting to play anyway...`),this.audioContext.state==="suspended"){console.log(`🔄 Audio context is suspended for ${e}, attempting to resume...`);try{Qu(),await this.audioContext.resume(),await new Promise(l=>setTimeout(l,50)),this.audioContext.state!=="running"?(console.warn(`⚠️ Audio context not running after resume attempt - state: ${this.audioContext.state}`),console.warn("   User interaction (click) may be required to resume audio")):console.log(`✅ Audio context resumed successfully for ${e}`)}catch(l){console.warn("⚠️ Failed to resume audio context:",l),console.warn("   User interaction (click) may be required to resume audio")}}this.stopSound(e),window.strudel&&window.strudel.scheduler&&!window.strudel.scheduler.started&&(console.log(`▶️ Starting scheduler for ${e} playback...`),await window.strudel.scheduler.start()),console.log(`Playing Strudel pattern for ${e}:`,t);try{if(window.strudel||await this.loadStrudelFromCDN(),!window.strudel||!window.strudel.evaluate||typeof window.strudel.evaluate!="function")throw console.error("❌ window.strudel.evaluate is not available"),console.error("window.strudel:",window.strudel),new Error("Strudel REPL evaluate function is not available. Strudel may not have initialized correctly.");if(console.log("Strudel evaluate is available..."),typeof globalThis.note=="function"&&typeof globalThis.sound=="function")console.log("✅ Core functions verified and available");else{const h=new Error("Core functions not available");console.warn("Core functions not available, attempting to load...");try{const{coreModule:d}=await nc();window.__coreModule=d,await window.strudel.evaluate(`
            (function() {
              const core = window.__coreModule || {};
              if (core && typeof core === 'object') {
                Object.assign(globalThis, core);
              }
              globalThis.__core_loaded = true;
            })();
          `);for(let m=0;m<20;m++){try{if(await window.strudel.evaluate("globalThis.__core_loaded === true")&&typeof globalThis.note=="function"){console.log("✅ Core functions loaded into REPL");break}}catch{}await new Promise(y=>setTimeout(y,100))}}catch(d){console.warn("Could not load core functions:",d)}}await this.ensureDefaultSoundBanks()||console.warn("⚠️ Continuing without default sound banks - patterns may fail");try{console.log("Registering sawtooth sound...");try{const{webaudioModule:h}=await nc(),d=`
                (function() {
                  const webaudio = window.__webaudioModule || {};
                  const { registerSound, getAudioContext } = webaudio;
                  
                  registerSound('sawtooth', (time, value, onended) => {
                    let { freq } = value;
                    const ctx = getAudioContext();
                    const o = new OscillatorNode(ctx, { type: 'sawtooth', frequency: Number(freq) || 440 });
                    o.start(time);
                    const g = new GainNode(ctx, { gain: 0.3 });
                    o.connect(g);
                    const stop = (time) => {
                      o.stop(time);
                      o.disconnect();
                      g.disconnect();
                      onended();
                    };
                    o.addEventListener('ended', () => {
                      o.disconnect();
                      g.disconnect();
                      onended();
                    });
                    return { node: g, stop };
                  }, { type: 'synth' });
                  
                  // Make registerSound and getAudioContext available globally for future use
                  globalThis.registerSound = registerSound;
                  globalThis.getAudioContext = getAudioContext;
                })();
              `;window.__webaudioModule=h,await window.strudel.evaluate(d),await new Promise(m=>setTimeout(m,200)),console.log("✅ Sawtooth sound registered (will be verified on first use)")}catch(h){console.warn("Could not use webaudio module:",h);try{const{webaudioModule:d}=await nc();window.__webaudioModule=d,await window.strudel.evaluate(`
                  (function() {
                    const webaudio = window.__webaudioModule || {};
                    const { registerSound, getAudioContext } = webaudio;
                  
                  if (registerSound && getAudioContext) {
                    registerSound('sawtooth', (time, value, onended) => {
                      let { freq } = value;
                      const ctx = getAudioContext();
                      const o = new OscillatorNode(ctx, { type: 'sawtooth', frequency: Number(freq) || 440 });
                      o.start(time);
                      const g = new GainNode(ctx, { gain: 0.3 });
                      o.connect(g);
                      const stop = (time) => {
                        o.stop(time);
                      };
                      o.addEventListener('ended', () => {
                        o.disconnect();
                        g.disconnect();
                        onended();
                      });
                      return { node: g, stop };
                    }, { type: 'synth' });
                  }
                })();
              `),await new Promise(y=>setTimeout(y,200)),console.log("✅ Sawtooth sound registered via REPL")}catch(d){console.warn("Could not register sawtooth via fallback:",d)}}}catch(h){console.warn("Could not register sawtooth sound:",h),console.warn("Pattern may still work if sawtooth is a default sound")}if(s){const h=window.strudel.samples||globalThis.samples;if(h&&typeof h=="function")try{if(typeof s=="string")console.log("Loading custom samples with string:",s),await h(s),console.log("Custom samples loaded successfully");else if(typeof s=="object"&&s!==null){const d=hs.getElementConfig(e),m=(d==null?void 0:d.samplesBaseUrl)||"";console.log("Loading custom samples:",s),console.log("Base URL:",m),await h(s,{baseUrl:m}),console.log("Custom samples loaded successfully")}}catch(d){console.error("Error loading custom samples:",d)}}try{if(typeof globalThis.note=="function"&&typeof globalThis.sound=="function")console.log("✅ Verified core functions are available");else{const S=new Error("Core functions not available");console.warn("Core functions check failed, attempting to load..."),console.warn("⚠️ Core functions not available, attempting to load now...");try{const{coreModule:A}=await nc();window.__coreModule=A,await window.strudel.evaluate(`
              (function() {
                const core = window.__coreModule || {};
                if (core && typeof core === 'object') {
                  Object.assign(globalThis, core);
                }
                globalThis.__core_loaded = true;
              })();
            `);for(let F=0;F<20;F++){try{if(await window.strudel.evaluate("globalThis.__core_loaded === true")&&typeof globalThis.note=="function")break}catch{}await new Promise(j=>setTimeout(j,100))}}catch(A){throw console.error("❌ Failed to load core functions:",A),new Error("Core Strudel functions (note, samples, etc.) are not available in REPL context. Pattern evaluation will fail.")}}if(console.log("Evaluating pattern:",t),window.strudel&&window.strudel.evaluate)try{const S=[];let A=0;for(;;){const F=t.indexOf("samples(",A);if(F===-1)break;let j=0,N=!1,$="",L=F+8;for(;L<t.length&&/\s/.test(t[L]);)L++;if(L<t.length&&t[L]==="{"){const I=L;for(j=1,L++;L<t.length&&j>0;){const q=t[L];N?q===$&&t[L-1]!=="\\"&&(N=!1):q==='"'||q==="'"?(N=!0,$=q):q==="{"?j++:q==="}"&&j--,L++}if(j===0){const q=t.substring(I,L);for(;L<t.length&&(/\s/.test(t[L])||t[L]===",");)L++;let ce=null;if(L<t.length&&(t[L]==='"'||t[L]==="'")){const ee=t[L],he=L;for(L++;L<t.length;){if(t[L]==="\\"){L+=2;continue}if(t[L]===ee){ce=t.substring(he,L+1),L++;break}L++}}for(;L<t.length&&/\s/.test(t[L]);)L++;if(L<t.length&&t[L]===")"){const ee=t.substring(F,L+1);S.push({fullCall:ee,samplesObj:q,secondParam:ce}),A=L+1;continue}else if(L<t.length){const ee=t.substring(F,L);S.push({fullCall:ee,samplesObj:q,secondParam:ce}),A=L;continue}}}A=F+1}for(const F of S){const j=F.fullCall,N=F.samplesObj,$=F.secondParam;S.push({fullCall:j,samplesObj:N,secondParam:$})}for(const F of S)try{console.log("📦 Pre-loading samples() call in REPL:",F.fullCall),await window.strudel.evaluate(F.fullCall),console.log("✅ Samples loaded via REPL evaluation"),await new Promise(j=>setTimeout(j,500))}catch(j){console.warn("Could not evaluate samples() call in REPL:",j);try{const N=((o=window.strudel)==null?void 0:o.samples)||globalThis.samples;if(N&&typeof N=="function"){let $={};try{$=new Function("return "+F.samplesObj)()}catch(L){console.warn("Could not parse samples object:",L);continue}if(Object.keys($).length>0){if(console.log("📦 Loading samples directly as fallback:",$),F.secondParam){let L=null;try{const I=F.secondParam.trim();I.startsWith("{")?L=new Function("return "+I)():L=I.replace(/^["']|["']$/g,""),await N($,L)}catch{const q=F.secondParam.trim().replace(/^["']|["']$/g,"");await N($,q)}}else await N($);await new Promise(L=>setTimeout(L,500))}}}catch(N){console.warn("Fallback samples loading also failed:",N)}}S.length>0&&console.log(`✅ Pre-loaded ${S.length} samples() call(s) - pattern will be evaluated with samples already loaded`)}catch(S){console.warn("Error pre-loading samples from pattern:",S)}const h=this.getPatternSlot(e);console.log(`Assigning pattern to ${h} for element ${e}`);const d=this.getElementAudioNodes(e);(!d||!d.gainNode)&&console.warn(`⚠️ Could not prepare audio nodes for ${e} (pattern slot ${h})`),this.currentEvaluatingSlot=h;let m=null;const y=this.patternCache.get(e);if(y&&y.originalPattern===t&&y.processedPattern)m=y.processedPattern,console.log(`⚡ Using cached pattern for ${e} (instant trigger)`),m=this.applyElementGainPanToPattern(y.processedPattern.replace(/\.gain\([^)]*\)/g,"").replace(/\.pan\([^)]*\)/g,"").replace(/\.fast\([^)]*\)/g,"").replace(/\.slow\([^)]*\)/g,"").trim(),e,{applyGainInPattern:this.masterActive});else{if(console.log(`📝 Processing pattern for ${e} (not cached)`),m=await this.processPattern(t,e,{applyGainInPattern:this.masterActive}),!m){console.warn(`[${e}] Pattern processing failed - cannot evaluate`);try{const S=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(S);return}catch(S){console.error(`Failed to set ${h} to silence:`,S);return}}this.patternCache.set(e,{processedPattern:m,patternSlot:h,isPreEvaluated:!1,originalPattern:t})}if(!m||m.trim()===""){console.warn(`[${e}] Pattern became empty - cannot evaluate`);return}m.includes("undefined")&&!m.includes("globalThis.undefined")&&(console.warn("⚠️ Pattern contains 'undefined' - might be from removed samples() call"),m=m.replace(/undefined\s*[,\n;]/g,"").trim(),m=m.replace(/,\s*undefined/g,"").trim(),m=m.replace(/undefined\s*\./g,"").trim());const O=`${h} = ${m}`;console.log(`🎼 ${e} → ${h}:`),console.log(`   Full Pattern: ${m.substring(0,200)}${m.length>200?"...":""}`),console.log(`   Assignment: ${O.substring(0,200)}${O.length>200?"...":""}`);try{window.strudel&&window.strudel.scheduler&&!window.strudel.scheduler.started&&(console.log(`▶️ Starting scheduler for ${e} pattern evaluation...`),await window.strudel.scheduler.start());const S=await window.strudel.evaluate(O);this.currentEvaluatingSlot=h;const A=this.soundsPreloaded?500:1e3;if(setTimeout(()=>{this.currentEvaluatingSlot===h&&(this.currentEvaluatingSlot=null)},A),S&&typeof S=="object"&&S.message&&S.message.includes("undefined instead of pattern")){console.warn("⚠️ Pattern returned undefined - setting to silence");try{const F=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(F);return}catch(F){console.error(`Failed to set ${h} to silence:`,F);return}}console.log(`✅ Pattern assignment attempted for ${h}`)}catch(S){if(S.message&&S.message.includes("undefined instead of pattern")){console.error("❌ Pattern evaluation failed: pattern returned undefined"),console.error("   This usually means:"),console.error("   - Bank samples aren't loaded (check .bank() usage)"),console.error("   - Pattern syntax is invalid"),console.error("   - Required samples/sounds aren't available"),console.error(`   Pattern: ${m.substring(0,100)}`);try{const A=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(A),console.log(`✅ Set ${h} to silence due to pattern error`)}catch(A){console.error(`Failed to set ${h} to silence:`,A)}return}if(S.message.includes("not defined")||S.message.includes("ReferenceError")){console.log(`Slot ${h} doesn't exist, creating it...`);try{const A=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(A),await window.strudel.evaluate(O),console.log(`✅ Pattern assigned to ${h} after slot creation`)}catch(A){if(console.error(`❌ Failed to assign pattern to ${h} even after creating slot:`,A),A.message&&A.message.includes("undefined instead of pattern")){console.error("   Pattern still invalid - setting to silence");try{const F=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(F)}catch(F){console.error(`Failed to set ${h} to silence:`,F)}return}throw A}}else{console.error(`❌ Failed to assign pattern to ${h}:`,S);try{const A=typeof globalThis.silence=="object"?`${h} = globalThis.silence`:`${h} = silence`;await window.strudel.evaluate(A),console.log(`✅ Set ${h} to silence as fallback`)}catch(A){console.error(`Failed to set ${h} to silence:`,A)}return}}}catch(h){if(console.error("❌ Error evaluating pattern:",h),console.error("Pattern was:",t),console.error("Error details:",h.message),h.message&&h.message.includes("undefined instead of pattern")||h.isUndefinedPattern===!0){console.warn("⚠️ Pattern evaluation returned undefined"),console.warn("   This usually means:"),console.warn("   - Bank samples aren't loaded (check .bank() usage)"),console.warn("   - Pattern syntax is invalid"),console.warn("   - Required samples/sounds aren't available"),console.warn(`   Pattern: ${t.substring(0,100)}`);const d=this.getPatternSlot(e);try{await window.strudel.evaluate(`${d} = silence`),console.log(`✅ Set ${d} to silence due to pattern error`)}catch(m){console.warn(`⚠️ Failed to set ${d} to silence:`,m.message)}return}throw(h.message.includes("note is not defined")||h.message.includes("s is not defined"))&&(console.error("❌ Core Strudel functions (note, s, etc.) are not available in REPL context"),console.error("This means Strudel REPL was not properly initialized with core functions"),console.error("Pattern cannot be evaluated without core functions - NOT using fallback")),h}console.log(`Strudel pattern started for ${e}`),this.currentEvaluatingSlot=null;const c=this.strudelPatternSlots.get(e);if(typeof e=="string"&&e.toLowerCase().includes("preview"))this.trackedPatterns.has(e)&&(this.trackedPatterns.delete(e),console.log(`🗑️ Removed preview element ${e} from master tracking`),await this.updateMasterPattern(this.soloedElements,this.mutedElements));else if(!this.trackedPatterns.has(e)){const h=this.getElementGain(e)||.8,d=this.getElementPan(e)||0,m=t.replace(/[""]/g,'"').replace(/['']/g,"'");this.trackedPatterns.set(e,{pattern:m,gain:h,pan:d,muted:!1,soloed:!1}),console.log(`➕ Auto-added ${e} to master tracked patterns`),await this.updateMasterPattern(this.soloedElements,this.mutedElements)}this.activeSounds.set(e,{type:"strudel",patternSlot:c,stop:()=>{window.strudel.evaluate&&c&&(console.log(`🔇 Stopping ${e} (${c}) - setting to silence`),window.strudel.evaluate(`${c} = silence`).then(()=>{console.log(`✅ ${c} silenced`)}).catch(h=>{console.error(`❌ Error stopping pattern in ${c}:`,h)}))}});return}catch(l){console.warn("Failed to load Strudel from local packages:",l)}console.warn("Using simplified pattern parsing as fallback...");const i=t.match(/s\(["']([^"']+)["']\)/);if(i){const l=i[1],c=t.match(/\.slice\((\d+)\s*,\s*"([^"]+)"\)/);if(c){const u=this.parseIndexPattern(c[2]),h=this.createPatternFromIndices(u);await this.playSynthesizedSound(e,h)}else{const u=this.createPatternFromSampleName(l);await this.playSynthesizedSound(e,u)}}else await this.playSynthesizedSound(e,t)}async loadStrudelFromCDN(){var s,r,a,i,o,l,c,u,h;const e=typeof globalThis.silence=="object"&&typeof globalThis.sound=="function"&&typeof globalThis.note=="function";if(this.strudelLoaded&&window.strudel&&window.strudel.evaluate&&e){console.log("Strudel already loaded, initialized, and functions exposed");return}if(e||console.log("Functions not exposed, need to reload/expose:",{silence:typeof globalThis.silence+" (should be object)",sound:typeof globalThis.sound+" (should be function)",note:typeof globalThis.note+" (should be function)"}),this.strudelLoading){for(console.log("Strudel is currently loading, waiting...");this.strudelLoading;)await new Promise(d=>setTimeout(d,100));if(this.strudelLoaded&&window.strudel){console.log("Strudel loading completed by another call");return}}this.strudelLoading=!0,console.log("Loading Strudel...");try{const{webModule:d,coreModule:m,webaudioModule:y,tonalModule:O}=await nc(),S=d;console.log("✅ Loaded Strudel from local packages");let A=null,F=null,j=!1,N=y.webaudioOutput||((s=y.default)==null?void 0:s.webaudioOutput)||(S==null?void 0:S.webaudioOutput);!N&&typeof y=="function"&&(N=y),!N&&typeof y.default=="function"&&(N=y.default);const $=S.repl||d.repl,L=S.initStrudel||d.initStrudel;if(!$&&!L)throw new Error("Strudel REPL not available");if(console.log("Available initialization methods:",{hasRepl:!!$,hasInitStrudel:!!L}),!N||typeof N!="function")throw console.error("webaudioModule structure:",Object.keys(y||{})),console.error("webaudioOutput type:",typeof N),new Error("Strudel webaudioOutput not available or not a function");console.log("✅ Core module loaded, available functions:",Object.keys(m).filter(ee=>typeof m[ee]=="function").slice(0,15)),console.log("webaudioOutput type:",typeof N),this.strudelOutputFactory=N,console.log("Merging modules..."),console.log("  coreModule keys:",m?Object.keys(m).length:0),console.log("  tonalModule keys:",O?Object.keys(O).length:0),console.log("  webaudioModule keys:",y?Object.keys(y).length:0),console.log("  webModule keys:",d?Object.keys(d).length:0);const I={...m||{},...O||{},...y||{},...d||{},...C2||{}};if(Object.keys(I).forEach(ee=>{I[ee]===void 0&&delete I[ee]}),console.log("After merge - allModules total keys:",Object.keys(I).length),console.log("After merge - function count:",Object.keys(I).filter(ee=>typeof I[ee]=="function").length),typeof globalThis.silence=="object"&&typeof globalThis.sound=="function"&&typeof globalThis.note=="function"?(console.log("Strudel functions already properly exposed to globalThis, skipping..."),console.log("Verification - typeof globalThis.silence:",typeof globalThis.silence,"(Pattern object)"),console.log("Verification - typeof globalThis.sound:",typeof globalThis.sound,"(function)"),console.log("Verification - typeof globalThis.note:",typeof globalThis.note,"(function)")):(console.log("Exposing all Strudel functions to globalThis..."),console.log("allModules keys:",Object.keys(I).length),console.log("Sample functions:",Object.keys(I).filter(ee=>typeof I[ee]=="function").slice(0,10)),Object.assign(globalThis,I),globalThis.__strudelModulesExposed=!0,console.log("✅ Exposed",Object.keys(I).filter(ee=>typeof I[ee]=="function").length,"functions to globalThis"),console.log("Verification - typeof globalThis.silence:",typeof globalThis.silence,"(Pattern object)"),console.log("Verification - typeof globalThis.sound:",typeof globalThis.sound,"(function)"),console.log("Verification - typeof globalThis.note:",typeof globalThis.note,"(function)")),F=d.samples||y.samples||S.samples,F?(globalThis.samples=F,console.log("✅ Samples function exposed to globalThis")):console.warn("⚠️ No samples function found in any module"),this.ensurePatternMidiMethodsRegistered("pre-init module exposure"),(d.getAudioContext||y.getAudioContext)&&console.log("✅ Audio context getter available"),console.log("🎚️ Using element channel routing:",!!(this.masterPanNode&&this.masterGainNode)),!globalThis.__strudelPatternsPreInitialized){console.log("🎰 PRE-REPL: Initializing pattern slots d0-d16 on globalThis...");const ee=I.silence||globalThis.silence;if(ee&&typeof ee=="object"){for(let he=0;he<=16;he++)globalThis[`d${he}`]=ee;console.log("✅ PRE-REPL: Pattern slots initialized with silence pattern")}else{console.warn("⚠️ PRE-REPL: silence pattern not available, creating empty pattern objects");const he={_type:"pattern",query:()=>[],firstCycle:()=>[]};for(let H=0;H<=16;H++)globalThis[`d${H}`]=he}globalThis.__strudelPatternsPreInitialized=!0,console.log("✅ PRE-REPL: Pattern slots are now defined on globalThis")}if(L&&typeof L=="function"){console.log("Using initStrudel for proper initialization...");try{if(this.midiEnabled)console.log("✅ MIDI already enabled, ensuring midiOutput handler is connected");else try{await this.initializeMIDI()}catch(Oe){console.warn("⚠️ MIDI initialization failed, continuing without MIDI:",Oe)}console.log("🔧 Creating fallback scheduler.output before initStrudel...");const ee=this.audioContext.createGain();ee.connect(this.masterPanNode),console.log("✅ Created fallback output (GainNode) connected to masterPanNode"),console.log("🎯 Keeping destination override active - Strudel will see masterPanNode as destination");const he={audioContext:this.audioContext,getTime:()=>this.audioContext?this.audioContext.currentTime:0,editPattern:()=>{},setUrl:()=>{},withLoc:!0,midiOutput:Oe=>{this.midiEnabled&&this.selectedMidiOutput&&this.sendMIDIMessage(Oe)}};console.log("🎚️ initStrudel options:",Object.keys(he)),console.log("📍 withLoc enabled for code highlighting"),console.log("🎚️ audioContext.destination (overridden to masterPanNode):",((a=(r=this.audioContext.destination)==null?void 0:r.constructor)==null?void 0:a.name)||typeof this.audioContext.destination);const H=await L(he);(i=H.scheduler)!=null&&i.output?console.log("✅ Strudel created scheduler.output, and it should route through masterPanNode naturally"):(console.log("🔧 initStrudel did not create output, using fallback"),H.scheduler.output=ee,console.log("✅ Assigned fallback output to scheduler.output")),A=H.repl||H,console.log("✅ initStrudel completed, replInstance:",!!A),window.strudel=window.strudel||{},H.scheduler&&(window.strudel.scheduler=H.scheduler,console.log("✅ Stored scheduler in window.strudel"),H.scheduler.output?console.log("✅ scheduler.output exists:",((l=(o=H.scheduler.output)==null?void 0:o.constructor)==null?void 0:l.name)||typeof H.scheduler.output):H.output?(console.log("✅ Found output in strudelContext.output, assigning to scheduler.output"),H.scheduler.output=H.output,console.log("✅ Assigned strudelContext.output to scheduler.output")):(console.warn("⚠️ scheduler.output is missing - Strudel should create it automatically from audioContext"),console.warn("⚠️ Audio may not play if scheduler.output is not set up"),console.warn("⚠️ Note: Manual creation requires internal Strudel functions that are not available"),setTimeout(()=>{var Pe,De,Se,ae;H.output&&!H.scheduler.output&&(console.log("✅ Found output in strudelContext.output (delayed check), assigning to scheduler.output"),H.scheduler.output=H.output);const Oe=((Pe=window.strudel)==null?void 0:Pe.webaudio)||(H==null?void 0:H.webaudio)||((De=H==null?void 0:H.scheduler)==null?void 0:De.webaudio);if(Oe&&!H.scheduler.output){const Ee=Oe.output||Oe.outputNode;Ee&&(console.log("✅ Found output in webaudio, assigning to scheduler.output"),H.scheduler.output=Ee)}if(H.scheduler.output)console.log("✅ scheduler.output is now set:",((ae=(Se=H.scheduler.output)==null?void 0:Se.constructor)==null?void 0:ae.name)||typeof H.scheduler.output);else if(console.warn("⚠️ scheduler.output still missing after delayed check"),console.log("🔧 Attempting to create output using webaudioOutput factory..."),this.strudelOutputFactory&&typeof this.strudelOutputFactory=="function")try{const Ee=this.strudelOutputFactory({audioContext:this.audioContext,destination:this.audioContext.destination});if(Ee)H.scheduler.output=Ee,console.log("✅ Created scheduler.output using webaudioOutput factory");else throw new Error("Factory returned null/undefined")}catch(Ee){console.warn("⚠️ Factory creation failed, creating minimal wrapper:",Ee.message);try{const Qe=this.audioContext.createGain();Qe.connect(this.masterPanNode);const Ke=Qe;Object.defineProperty(Ke,"output",{value:Qe,writable:!1,enumerable:!0}),Object.defineProperty(Ke,"outputNode",{value:Qe,writable:!1,enumerable:!0}),H.scheduler.output=Ke,window.strudel&&window.strudel.scheduler&&(window.strudel.scheduler.output=Ke),console.log("✅ Created minimal output (GainNode) connected to masterPanNode"),console.log("✅ Assigned to strudelContext.scheduler.output and window.strudel.scheduler.output"),console.log("✅ Output type:",Ke.constructor.name,"is AudioNode:",Ke instanceof AudioNode)}catch(Qe){console.error("❌ Failed to create minimal output wrapper:",Qe)}}else console.error("❌ Cannot create output - strudelOutputFactory not available")},500))),window.soundManager=this,this.ensurePatternMidiMethodsRegistered("post-init initStrudel"),this.midiEnabled&&(this.setupStrudelMIDIOutput(),setTimeout(async()=>{var Oe,Pe,De;if(this.ensurePatternMidiMethodsRegistered("delayed post-init check"),A&&A.evaluate)try{const{webaudioModule:Se}=await nc(),ae=((Oe=window.strudel)==null?void 0:Oe.scheduler)||(H==null?void 0:H.scheduler);let Ee=(ae==null?void 0:ae.webaudio)||((Pe=window.strudel)==null?void 0:Pe.webaudio)||(H==null?void 0:H.webaudio)||((De=H==null?void 0:H.output)==null?void 0:De.webaudio)||ae&&ae.output&&ae.output.webaudio;if(!Ee&&ae&&ae.output&&(console.log("   Checking scheduler.output for webaudio..."),typeof ae.output.midiOutput=="function"?(console.log("   scheduler.output has midiOutput, treating as webaudio"),Ee=ae.output,window.strudel.webaudio=Ee):ae.output.webaudio&&(Ee=ae.output.webaudio,window.strudel.webaudio=Ee)),!Ee&&H&&H.output&&(console.log("   Checking strudelContext.output for webaudio..."),typeof H.output.midiOutput=="function"?(console.log("   strudelContext.output has midiOutput, treating as webaudio"),Ee=H.output,window.strudel.webaudio=Ee):H.output.webaudio&&(Ee=H.output.webaudio,window.strudel.webaudio=Ee)),!Ee&&(console.log("   Checking strudelContext for webaudio in various locations..."),console.log("   strudelContext keys:",H?Object.keys(H).slice(0,10):[]),ae)){console.log("   scheduler keys:",Object.keys(ae));for(const Qe of Object.keys(ae)){const Ke=ae[Qe];if(Ke&&typeof Ke=="object"){if(typeof Ke.midiOutput=="function"){console.log(`   ✅ Found midiOutput in scheduler.${Qe} - treating as webaudio`),Ee=Ke,window.strudel.webaudio=Ee;break}else if(Ke.webaudio){console.log(`   ✅ Found webaudio in scheduler.${Qe}.webaudio`),Ee=Ke.webaudio,window.strudel.webaudio=Ee;break}}}}Ee||console.log("   ℹ️ webaudio not found, but MIDI will work via soundManager fallback"),console.log("🔍 Checking for scheduler/webaudio after delay:",{hasScheduler:!!ae,hasWebaudio:!!Ee,midiOutputType:Ee?typeof Ee.midiOutput:"N/A",schedulerKeys:ae?Object.keys(ae).slice(0,10):[],strudelContextKeys:H?Object.keys(H).slice(0,10):[],hasSoundManager:!!window.soundManager,hasMidiOutputs:!!(window.soundManager&&window.soundManager.midiOutputs),midiOutputsCount:window.soundManager&&window.soundManager.midiOutputs?window.soundManager.midiOutputs.size:0}),await A.evaluate(`
                  (function() {
                    // Verify MIDI methods are available on Pattern.prototype
                    if (typeof Pattern !== 'undefined' && Pattern.prototype) {
                      const hasMidi = typeof Pattern.prototype.midi === 'function';
                      const hasMidiport = typeof Pattern.prototype.midiport === 'function';
                      console.log('🔍 MIDI methods on Pattern.prototype:', { midi: hasMidi, midiport: hasMidiport });
                      
                      if (hasMidi && hasMidiport) {
                        console.log('✅ MIDI methods (.midi(), .midiport()) are available on patterns');
                        console.log('   MIDI will work via soundManager fallback even without webaudio');
                        if (window.soundManager && window.soundManager.midiOutputs) {
                          const ports = Array.from(window.soundManager.midiOutputs.keys());
                          console.log('   Available MIDI ports:', ports.length > 0 ? ports.join(', ') : 'none');
                        }
                      } else {
                        console.warn('⚠️ MIDI methods not found on Pattern.prototype.');
                        console.warn('   They should have been registered early (before initStrudel).');
                        console.warn('   This may indicate a registration timing issue.');
                      }
                    } else {
                      console.warn('⚠️ Pattern class not found in REPL context');
                    }
                  })()
                `)}catch(Se){console.warn("⚠️ Could not verify/register MIDI methods in REPL context:",Se)}},500));try{const Oe=await fetch("/strudel.json");if(Oe.ok){const Pe=await Oe.json();if(Pe.samples){const De=((c=window.strudel)==null?void 0:c.samples)||globalThis.samples;De&&typeof De=="function"&&(console.log("📦 Loading samples from strudel.json"),await De(Pe.samples),console.log("✅ Samples loaded from strudel.json"))}}}catch{console.log("ℹ️ No strudel.json found or error loading it (this is optional)")}try{await this.preloadPresetSamples()}catch(Oe){console.warn("⚠️ Error pre-loading preset samples:",Oe)}if(this.midiEnabled)try{this.setupStrudelMIDIOutput(),setTimeout(async()=>{try{await this.ensureMIDIFunctionsAvailable()}catch(Oe){console.warn("⚠️ Error ensuring MIDI functions available:",Oe)}},1e3)}catch(Oe){console.warn("⚠️ Error setting up MIDI functions:",Oe)}else console.log("ℹ️ MIDI not enabled; skipping Strudel MIDI wiring to avoid spurious warnings");console.log("replInstance type:",typeof A),console.log("replInstance.evaluate available:",typeof(A==null?void 0:A.evaluate)),console.log("strudelContext keys:",Object.keys(H)),console.log("🔍 Checking strudelContext for webaudio output...");const me=["strudelContext.webaudio","strudelContext.scheduler.webaudio","replInstance.webaudio","replInstance.scheduler.webaudio","strudelContext.output","replInstance.output"];H.scheduler&&(window.strudel=window.strudel||{},window.strudel.scheduler=H.scheduler,console.log("✅ Stored scheduler from strudelContext to window.strudel.scheduler"),H.scheduler.webaudio?(console.log("✅ Found webaudio in strudelContext.scheduler.webaudio"),window.strudel.webaudio=H.scheduler.webaudio):H.scheduler.output&&(console.log("✅ Found output in scheduler, checking for webaudio..."),H.scheduler.output.webaudio?(console.log("✅ Found webaudio in scheduler.output.webaudio"),window.strudel.webaudio=H.scheduler.output.webaudio):(console.log("   scheduler.output might be webaudio, storing it"),window.strudel.webaudio=H.scheduler.output))),H.webaudio&&(console.log("✅ Found webaudio in strudelContext.webaudio"),window.strudel=window.strudel||{},window.strudel.webaudio=H.webaudio),H.output&&(console.log("✅ Found output in strudelContext, checking if it's webaudio..."),H.output.webaudio?(console.log("✅ Found webaudio in strudelContext.output.webaudio"),window.strudel.webaudio=H.output.webaudio):typeof H.output.midiOutput=="function"&&(console.log("✅ strudelContext.output has midiOutput, treating as webaudio"),window.strudel.webaudio=H.output)),A&&A.scheduler&&(console.log("✅ Found scheduler in replInstance"),A.scheduler.webaudio&&console.log("✅ Found webaudio in replInstance.scheduler.webaudio")),(!A||typeof A.evaluate!="function")&&(console.warn("replInstance.evaluate not available, creating REPL manually..."),A=$({audioContext:this.audioContext,getTime:()=>this.audioContext.currentTime,withLoc:!0}),console.log("Created manual REPL, evaluate available:",typeof A.evaluate))}catch(ee){console.warn("initStrudel failed, falling back to manual REPL:",ee),A=$({audioContext:this.audioContext,getTime:()=>this.audioContext.currentTime})}}else console.log("Creating REPL manually (initStrudel not available)..."),A=$({audioContext:this.audioContext,getTime:()=>this.audioContext.currentTime,withLoc:!0});console.log("🎰 Checking if pattern slots need initialization..."),console.log("   replInstance:",!!A),console.log("   replInstance.evaluate:",typeof(A==null?void 0:A.evaluate)),console.log("   __strudelPatternsInitialized:",!!globalThis.__strudelPatternsInitialized),!globalThis.__strudelPatternsInitialized&&A&&A.evaluate?(console.log("🎰 Initializing pattern slots d0-d16..."),await(async()=>{for(let he=0;he<=16;he++)try{await A.evaluate(`d${he} = silence`),console.log(`  ✓ d${he} initialized with silence`)}catch{try{await A.evaluate(`d${he} = stack()`),console.log(`  ✓ d${he} initialized with stack()`)}catch(me){console.error(`  ✗ Failed to initialize d${he}:`,me.message)}}})(),console.log("✅ Pattern slot initialization complete"),globalThis.__strudelPatternsInitialized=!0,A.scheduler&&(console.log("⏸️ Scheduler NOT auto-started - will start when user presses play/preview"),setTimeout(()=>{const he=A.scheduler;if(he.webaudio||he._webaudio){const H=he.webaudio||he._webaudio;if(H.output||H.outputNode){const me=H.output||H.outputNode;try{me.disconnect(),me.connect(this.masterPanNode),console.log("✅ Connected webaudio output to master")}catch(Oe){console.warn("⚠️ Could not connect webaudio output:",Oe)}}}},500))):globalThis.__strudelPatternsInitialized?console.log("✅ Pattern slots already initialized"):console.warn("⚠️ Cannot initialize pattern slots - replInstance not available"),console.log("✅ REPL initialized - functions available via globalThis");try{let ee=null;try{ee=await ds(()=>import("./strudel-web-Ddx65js9.js").then(H=>H.i),__vite__mapDeps([0,1])),console.log("✅ Draw module imported from local packages")}catch{ee=await ds(()=>import("https://unpkg.com/@strudel/draw@1.2.4/dist/index.mjs"),[]),console.log("✅ Draw module imported from CDN")}const he=((u=m==null?void 0:m.Pattern)==null?void 0:u.prototype)||(typeof Pattern<"u"?Pattern.prototype:null)||(globalThis.Pattern?globalThis.Pattern.prototype:null);if(he&&(!he._spectrum&&he.spectrum&&(he._spectrum=he.spectrum),!he._pianoroll&&he.pianoroll&&(he._pianoroll=he.pianoroll)),ee&&A&&A.evaluate){const H="https://unpkg.com/@strudel/draw@1.2.4/dist/index.mjs";try{await A.evaluate(`
              (async function() {
                // Import the draw module - this automatically adds methods to Pattern.prototype
                const draw = await import('${H}')
                // Export getDrawContext for use in visualizers
                if (draw.getDrawContext) {
                  globalThis.getDrawContext = draw.getDrawContext
                }
                if (typeof Pattern !== 'undefined') {
                  if (!Pattern.prototype._spectrum && Pattern.prototype.spectrum) {
                    Pattern.prototype._spectrum = Pattern.prototype.spectrum;
                  }
                  if (!Pattern.prototype._pianoroll && Pattern.prototype.pianoroll) {
                    Pattern.prototype._pianoroll = Pattern.prototype.pianoroll;
                  }
                }
              })()
            `),await new Promise(me=>setTimeout(me,300))}catch(me){console.warn("⚠️ Could not load @strudel/draw in REPL context:",me)}}}catch(ee){console.warn("⚠️ Could not load @strudel/draw functions:",ee)}if(this.strudelRepl=A,this.audioContext&&(d.getAudioContext||y.getAudioContext)&&typeof(d.getAudioContext||y.getAudioContext)=="function")try{d.getAudioContext&&Object.defineProperty(d,"getAudioContext",{value:()=>(console.log("🎚️ Strudel getAudioContext() called - returning our shared context"),this.audioContext),writable:!0,configurable:!0}),y.getAudioContext&&Object.defineProperty(y,"getAudioContext",{value:()=>(console.log("🎚️ Strudel webaudio getAudioContext() called - returning our shared context"),this.audioContext),writable:!0,configurable:!0}),console.log("✅ Patched Strudel getAudioContext() to return our shared context")}catch(he){he.message.includes("Cannot redefine property")||console.warn("⚠️ Could not patch getAudioContext (module may be read-only):",he.message)}if(A&&A.scheduler){const ee=A.scheduler;ee.audioContext&&ee.audioContext!==this.audioContext&&(console.log("🎚️ Replacing scheduler audioContext with our shared context"),ee.audioContext=this.audioContext),ee.superdough&&ee.superdough.audioContext&&ee.superdough.audioContext!==this.audioContext&&(console.log("🎚️ Replacing superdough audioContext with our shared context"),ee.superdough.audioContext=this.audioContext)}if(this.exposeSampleListHelper(y,d),A&&A.scheduler&&this.masterPanNode&&this.masterGainNode)try{const ee=A.scheduler;if(console.log("🔍 Checking for scheduler output..."),console.log("  scheduler.output:",!!ee.output),console.log("  scheduler keys:",Object.keys(ee).slice(0,15)),ee.output){console.log("  scheduler.output type:",ee.output.constructor.name);try{ee.output.disconnect(),ee.output.connect(this.masterPanNode),console.log("✅ Connected scheduler.output to masterPanNode")}catch(he){console.warn("⚠️ Could not connect scheduler.output:",he)}}if((h=ee.superdough)!=null&&h.output){const he=ee.superdough.output;if(console.log("  Found superdough.output:",he?he.constructor.name:"null"),he&&typeof he.connect=="function")try{he.disconnect(),he.connect(this.masterPanNode),console.log("✅ Connected superdough.output to masterPanNode")}catch(H){console.warn("⚠️ Could not connect superdough.output:",H)}}if(ee.audioContext){const he=ee.audioContext.destination;try{Object.defineProperty(ee.audioContext,"destination",{get:()=>this.destinationWrapper||this.masterPanNode||he,configurable:!0}),console.log("🎚️ Patched scheduler audioContext.destination to use destinationWrapper")}catch(H){console.warn("⚠️ Could not patch scheduler audioContext:",H)}}}catch(ee){console.warn("⚠️ Could not intercept scheduler output:",ee)}if(A&&A.scheduler){console.log("⏸️ REPL scheduler found (will be started after pattern slots are initialized)...");const ee=(he=1,H=1e3)=>{setTimeout(()=>{var Se,ae,Ee,Qe;const me=A.scheduler,Oe={"scheduler.superdough":me.superdough,"scheduler.output":me.output,"window.superdough":window.superdough,"window.strudel.superdough":(Se=window.strudel)==null?void 0:Se.superdough,"replInstance.superdough":A.superdough},Pe=me.output;let De=!1;if((ae=me.superdough)!=null&&ae.output&&this.masterPanNode){console.log(`🔍 [DELAYED CHECK ${he}] Found scheduler.superdough.output`),console.log("  superdough.output type:",me.superdough.output.constructor.name);try{me.superdough.output.disconnect(),me.superdough.output.connect(this.masterPanNode),console.log(`✅ [DELAYED CHECK ${he}] Connected scheduler.superdough.output to masterPanNode`),De=!0}catch(Ke){console.warn(`⚠️ [DELAYED CHECK ${he}] Could not connect scheduler.superdough.output:`,Ke)}}else if(Pe&&Pe.constructor.name==="GainNode"&&Pe!==this.masterPanNode)console.log(`🔍 [DELAYED CHECK ${he}] Checking if scheduler.output is superdough output`),console.log("  scheduler.output type:",Pe.constructor.name),console.log(`ℹ️ [DELAYED CHECK ${he}] scheduler.output (GainNode) already connected to masterPanNode from initialization`),De=!0;else{console.log(`ℹ️ [DELAYED CHECK ${he}] Superdough output search (waited ${H}ms):`);for(const[Ke,ge]of Object.entries(Oe))console.log(`  ${Ke}:`,ge?((Ee=ge.constructor)==null?void 0:Ee.name)||typeof ge:"undefined"),ge&&typeof ge=="object"&&ge.output&&console.log(`    ${Ke}.output:`,(Qe=ge.output.constructor)==null?void 0:Qe.name);console.log("  scheduler keys:",Object.keys(me).slice(0,20)),he<5&&ee(he+1,H+1e3)}},H)};ee(1,1e3)}const ce=async ee=>{try{const he=await A.evaluate(ee);return he===void 0&&ee.includes("=")&&!ee.trim().startsWith("//")&&(/^d\d+\s*=\s*/.test(ee.trim())||/\w+\s*=\s*s\(|sound\(|note\(/.test(ee))&&(console.warn(`⚠️ Pattern assignment returned undefined: ${ee.substring(0,80)}`),console.warn("   This usually means the pattern is invalid or samples aren't loaded")),(he!==void 0||!ee.includes("="))&&console.log(`Eval result for "${ee.substring(0,50)}...":`,typeof he,he),he}catch(he){if(he.message&&he.message.includes("undefined instead of pattern")){const H=new Error("Pattern evaluation failed: got undefined instead of pattern");throw H.originalError=he,H.code=ee,H.isUndefinedPattern=!0,console.warn("⚠️ Pattern evaluation error: got undefined instead of pattern"),console.warn(`   Code: ${ee.substring(0,100)}`),console.warn("   This usually means:"),console.warn("   - Bank samples aren't loaded (check .bank() usage)"),console.warn("   - Pattern syntax is invalid"),console.warn("   - Required samples/sounds aren't available"),H}throw console.error("Evaluation error:",he),he}};F||(F=d.samples||S.samples||A&&A.samples),window.strudel={initialized:!0,evaluate:ce,samples:F||(()=>{}),repl:A,scheduler:A==null?void 0:A.scheduler},this.strudelLoaded=!0,this.strudelLoading=!1,console.log("Checking Strudel functions availability..."),console.log("  typeof silence:",typeof globalThis.silence),console.log("  typeof sound:",typeof globalThis.sound),console.log("  typeof note:",typeof globalThis.note),console.log("✅ REPL ready (functions available via globalThis)"),this.currentTempo=120;try{await window.strudel.evaluate("cps = 1"),console.log("✅ Initial tempo set to 120 BPM (base cps=1, using .fast()/.slow() on patterns)")}catch(ee){console.warn("⚠️ Could not set initial cps:",ee)}return}catch(d){console.error("Failed to load Strudel module:",d),this.strudelLoading=!1}const t=["https://unpkg.com/@strudel/web@1.2.5/dist/index.mjs","https://cdn.jsdelivr.net/npm/@strudel/web@1.2.5/dist/index.mjs","https://esm.sh/@strudel/web@1.2.5"];for(const d of t)try{console.log(`Trying to load Strudel from: ${d}`);const m=await import(d),y=m.repl,O=m.samples;if(!y){console.warn("Strudel module missing repl. Available exports:",Object.keys(m));continue}const S=m.initStrudel;S&&S({audioContext:this.audioContext,output:this.audioContext,withLoc:!0});let A=null;try{A=(await nc()).coreModule,console.log("✅ Core module from cached getStrudelModules()"),console.log("Available exports:",Object.keys(A).slice(0,10))}catch(j){console.warn("Could not get core module from cache, trying direct import:",j);try{A=await ds(()=>import("./strudel-core-Cml4IbyB.js").then(N=>N.A),[]),console.log("✅ Core module imported directly (fallback)")}catch(N){console.warn("Could not import core module:",N)}}const F=y({getTime:()=>this.audioContext.currentTime,withLoc:!0,scope:A?{...A}:void 0});if(A)try{await F.evaluate(`
              (async function() {
                const core = await import('https://unpkg.com/@strudel/core@1.2.5/dist/index.mjs')
                Object.assign(globalThis, core)
              })()
            `),await new Promise(N=>setTimeout(N,300)),console.log("✅ Core functions also loaded via evaluation")}catch(j){console.warn("Could not load core functions via evaluation:",j)}try{let j=null;try{j=await ds(()=>import("./strudel-web-Ddx65js9.js").then(N=>N.i),__vite__mapDeps([0,1])),console.log("✅ Draw module imported from local packages")}catch{j=await ds(()=>import("https://unpkg.com/@strudel/draw@1.2.4/dist/index.mjs"),[]),console.log("✅ Draw module imported from CDN")}if(j){const N="https://unpkg.com/@strudel/draw@1.2.4/dist/index.mjs";await F.evaluate(`
              (async function() {
                // Import the draw module - this automatically adds methods to Pattern.prototype
                await import('${N}')
                // Also export getDrawContext for use in visualizers
                const draw = await import('${N}')
                if (draw.getDrawContext) {
                  const originalGetDrawContext = draw.getDrawContext;
                  // Patch getDrawContext to use our canvas when available
                  globalThis.getDrawContext = function(id, options) {
                    // If no ID or default ID, try to use our canvas context
                    if ((!id || id === 'test-canvas') && window.__strudelVisualizerCtx) {
                      return window.__strudelVisualizerCtx;
                    }
                    // Otherwise use original function
                    return originalGetDrawContext(id, options);
                  };
                }
              })()
            `),await new Promise($=>setTimeout($,300))}}catch(j){console.warn("⚠️ Could not load @strudel/draw functions:",j)}window.strudel={initialized:!0,evaluate:F.evaluate,samples:O},this.strudelLoaded=!0,this.strudelLoading=!1,console.log("Strudel loaded from CDN successfully");return}catch(m){console.warn(`Failed to load from ${d}:`,m.message);continue}throw this.strudelLoading=!1,new Error("Failed to load Strudel from all CDN sources")}async triggerSound(e){let t=null;try{const o=localStorage.getItem(`element-config-${e}`);o&&(t=JSON.parse(o))}catch(o){console.error(`Error loading custom config for ${e}:`,o)}const s=hs.getElementConfig(e);if(!s&&!t){console.warn(`No config found for element: ${e}`);return}const r=t&&typeof t.sampleUrl=="string"&&t.sampleUrl.trim()!==""?t.sampleUrl.trim():s&&s.audioFile&&typeof s.audioFile=="string"&&s.audioFile.trim()!==""?s.audioFile.trim():null;if(r){try{await this.initialize()||console.warn("⚠️ Audio engine not fully initialized; attempting custom sample playback anyway.")}catch(o){console.warn("⚠️ Unable to initialize audio engine for custom sample playback:",o)}this.stopSound(e),console.log(`🔊 Playing custom sample for ${e}`),this.playAudioFile(e,r);return}let a=(t==null?void 0:t.pattern)!==void 0?t.pattern:s==null?void 0:s.pattern;const i=(s==null?void 0:s.type)||"strudel";if(!a||typeof a=="string"&&a.trim()===""){console.log(`[${e}] No pattern assigned - skipping sound trigger`);return}if(this.appInstance&&i==="strudel"){const o=this.appInstance.getPatternWithEffects(e,a);o!==a&&(console.log(`   Applying effects to ${e} for individual playback`),a=o)}console.log(`Triggering sound for ${e} (type: ${i})`),t!=null&&t.sampleUrl&&await this.loadCustomSample(e,t.sampleUrl),i==="synthesized"?await this.playSynthesizedSound(e,a):i==="strudel"?await this.playStrudelPattern(e,a,s==null?void 0:s.samples):i==="audio"&&this.playAudioFile(e,(s==null?void 0:s.audioFile)||(t==null?void 0:t.sampleUrl))}async loadCustomSample(e,t){console.log(`Loading custom sample for ${e} from ${t.substring(0,50)}...`)}pauseSound(e){if(this.masterOnlyPlayback){this.removeElementFromMaster(e).success&&this.masterActive&&this.playMasterPattern().catch(r=>console.warn("⚠️ Failed to refresh master after pause:",r)),this.activeSounds.delete(e);return}const t=this.strudelPatternSlots.get(e);if(t&&window.strudel&&window.strudel.evaluate)try{const s=typeof globalThis.silence=="object"?`${t} = globalThis.silence`:`${t} = silence`;window.strudel.evaluate(s),console.log(`⏸️ Paused ${e} (set ${t} to silence)`)}catch(s){console.error(`Error pausing sound for ${e}:`,s)}this.activeSounds.delete(e)}stopSound(e){if(this.masterOnlyPlayback){this.removeElementFromMaster(e).success&&this.masterActive&&this.playMasterPattern().catch(a=>console.warn("⚠️ Failed to refresh master after stop:",a)),this.activeSounds.delete(e);return}const t=this.activeSounds.get(e),s=typeof e=="string"&&e.toLowerCase().includes("preview");if(window.strudel&&window.strudel.evaluate)try{const r=this.getPatternSlot(e),a=typeof globalThis.silence=="object"?`${r} = globalThis.silence`:`${r} = silence`;window.strudel.evaluate(a).catch(i=>{console.log(`Cleared pattern slot ${r} for ${e}`)})}catch{}if(t){if(t.type==="synthesized"&&t.oscillator)t.oscillator.stop&&t.oscillator.stop();else if(t.type==="strudel"&&t.stop)t.stop(),this.activeSounds.delete(e);else if(t.type==="audio"&&t.source){const r=t.gain,a=this.audioContext.currentTime;r.gain.cancelScheduledValues(a),r.gain.setValueAtTime(r.gain.value,a),r.gain.linearRampToValueAtTime(0,a+hs.defaults.fadeOutTime),setTimeout(()=>{t.source.stop(),this.activeSounds.delete(e)},hs.defaults.fadeOutTime*1e3+50);return}else if(t.type==="sustaining"){this.stopSustainingTone(e);return}this.activeSounds.delete(e)}if(s){const r=this.strudelPatternSlots.get(e);r&&(this.patternSlotToElementId.delete(r),this.strudelPatternSlots.delete(e),console.log(`🧹 Cleared preview slot mapping (${r}) for ${e}`)),this.disposeElementAudioNodes(e),console.log(`🧹 Disposed preview audio nodes for ${e}`)}}async stopAllSounds(){var r;if(this._stoppingAllSounds)return;this._stoppingAllSounds=!0,console.log("🛑🛑🛑 EMERGENCY STOP - Killing all audio 🛑🛑🛑");const e=((r=this.audioContext)==null?void 0:r.currentTime)||0;this.masterGainNode?(this.masterGainNode.gain.setValueAtTime(0,e),console.log("✓ Master gain set to 0 (immediate)"),setTimeout(()=>{var a;this.masterGainNode&&!this.masterMuted&&(this.masterGainNode.gain.setValueAtTime(this.masterVolume,((a=this.audioContext)==null?void 0:a.currentTime)||0),console.log(`✓ Master gain restored to ${(this.masterVolume*100).toFixed(0)}%`))},100)):this.gainNode&&(this.gainNode.gain.setValueAtTime(0,e),console.log("✓ Gain set to 0 (immediate)"),setTimeout(()=>{var a;this.gainNode&&(this.gainNode.gain.setValueAtTime(this.volume,((a=this.audioContext)==null?void 0:a.currentTime)||0),console.log(`✓ Gain restored to ${(this.volume*100).toFixed(0)}%`))},100));let t=!1;if(window.strudel&&window.strudel.repl&&window.strudel.repl.scheduler)try{const a=window.strudel.repl.scheduler;typeof a.stop=="function"&&(a.stop(),t=!0,console.log("✓ Stopped REPL scheduler (immediate)"))}catch{}if(window.strudel&&window.strudel.evaluate){console.log("🔇 Silencing all Strudel pattern slots (d1-d16)...");const a=[];for(let i=0;i<=16;i++){const o=`d${i}`;try{a.push(window.strudel.evaluate(`${o} = silence`).catch(()=>{}))}catch{}}try{await Promise.all(a),console.log("✅ All pattern slots silenced")}catch{}}const s=Array.from(this.activeSounds.keys());console.log(`🔇 Stopping ${s.length} tracked sounds`);for(const a of s)try{this.stopSound(a),console.log(`✓ Stopped ${a}`)}catch{console.log(`Could not stop ${a}`)}this.activeSounds.clear(),this.oscillators.forEach((a,i)=>{try{a.stop&&a.stop(),a.disconnect&&a.disconnect(),console.log(`✓ Disconnected oscillator ${i}`)}catch{}}),this.oscillators.clear(),this.masterActive=!1,this.currentEvaluatingSlot=null,this.masterPattern="",this.trackedPatterns&&this.trackedPatterns.clear&&this.trackedPatterns.clear(),console.log("✅✅✅ EMERGENCY STOP COMPLETE ✅✅✅ (audio context left running, master muted)"),this._stoppingAllSounds=!1}async setTempo(e){this.currentTempo=e,this.masterPlaybackTempo=e,this.tempoUserAdjusted=!0;const t=Number.isFinite(e)&&e>0?e/120:1;if(this.masterActive&&this.masterPlaybackStartTime!=null){const s=this.audioContext,r=s?s.currentTime:performance.now()/1e3,a=this.masterPlaybackSpeed||1,i=Math.max(0,r-this.masterPlaybackStartTime),o=a>0?i*a%1:0;this.masterPlaybackSpeed=t>0?t:1,this.masterPlaybackStartTime=r-o/this.masterPlaybackSpeed}else this.masterPlaybackSpeed=t>0?t:1;if(!window.strudel||!window.strudel.evaluate){console.warn("⚠️ Strudel not loaded yet - cannot set tempo");return}console.log(`🎚️ Tempo set to ${e} BPM (using .cpm() on patterns)`),await this.updateAllPatternsWithNewTempo(),this.trackedPatterns.size>0&&(console.log("🔄 Updating master with new tempo"),this.updateMasterPattern())}async ensureStrudelWorkletsReady(e,t=!1){try{if(!window.strudel||!window.strudel.repl||!window.strudel.repl.scheduler)return;const r=window.strudel.repl.scheduler.superdough;if(!r||!(t||typeof e=="string"&&/\b(supersaw|pulse)\b/i.test(e))||this._workletsLoaded)return;typeof r.loadWorklets=="function"&&(console.log("⏳ Loading Strudel AudioWorklets..."),await r.loadWorklets(),this._workletsLoaded=!0,console.log("✅ Strudel AudioWorklets loaded"))}catch(s){console.warn("⚠️ Could not load Strudel AudioWorklets:",(s==null?void 0:s.message)||s)}}setKey(e){this.currentKey=e||"",this._cachedScaleContext=null,this._cachedScaleKey="",this.currentKey?console.log(`🎹 Key set to ${e}`):console.log("🎹 Key cleared (no key selected)"),this.updateAllPatternsWithNewScale()}updateAllPatternsWithNewScale(){this.trackedPatterns.size>0&&(console.log("🔄 Updating master with new key/scale"),this.updateMasterPattern());for(const[e,t]of this.trackedPatterns.entries()){if(!t)continue;const s=t.pattern||t.rawPattern;if(!s)continue;const r=this.convertPatternForScale(s);t.pattern=r||s}for(const[e,t]of this.activeSounds.entries()){if(t.type!=="strudel")continue;const s=this.loadElementConfig?this.loadElementConfig(e):null,r=(s==null?void 0:s.pattern)||t.originalPattern||"";if(!r)continue;const i=this.convertPatternForScale(r)||r;this.updatePatternInPlace(e,i).catch(()=>{})}}setScale(e){this.currentScale=(e||"").trim()||"chromatic",this._cachedScaleContext=null,this._cachedScaleKey="",this.currentScale?console.log(`🎼 Scale set to ${this.currentScale}`):console.log("🎼 Scale cleared (no scale selected)"),this.updateAllPatternsWithNewScale()}setTimeSignature(e){this.currentTimeSignature=e,console.log(`🎵 Time signature set to ${e}`);const[t,s]=e.split("/").map(Number);this.currentBeats=t,this.currentNoteValue=s,console.log(`   ${t} beats per measure, ${s} note gets the beat`),this.trackedPatterns.size>0&&(console.log("🔄 Updating master with new time signature"),this.updateMasterPattern())}extractChannelNumber(e,t=0){if(!e||typeof e!="string")return t+1;const s=e.match(/(\d+)$/);if(s&&s[1]){const r=parseInt(s[1],10);if(Number.isFinite(r)&&r>0)return r}return t+1}formatNumberForPattern(e,t=6){return!Number.isFinite(e)||e===0?"0":e.toFixed(t).replace(/(\.\d*?[1-9])0+$/,"$1").replace(/\.0+$/,"").replace(/^-0$/,"0")}getScaleConversionContext(){return null}convertPatternForScale(e){if(!e||typeof e!="string")return e;const t=this.patternHasNoteNames(e),s=this.patternHasNumericNotePattern(e);return t&&!s?(console.log("📝 convertPatternForScale: Pattern uses note names, preserving format"),e):OD(e)}convertNoteNamesToSemitones(e){return!e||typeof e!="string"?e:OD(e)}convertNoteNamesToScaleDegrees(e,t,s){if(!e||typeof e!="string")return e;const r=t&&t.trim()||"C",a=s&&s.trim()||"chromatic",i=this.getScaleSemitoneSteps(r,a);if(!i||!i.length)return e;const l=`${r.replace(/\s+/g,"").toUpperCase()}`.match(/^([A-G])([#B]?)/i);if(!l)return e;const c=`${l[1].toUpperCase()}${l[2]||""}`,u=oa.get(`${c}4`),h=Number.isFinite(u.midi)?u.midi:60,d=O=>{const S=/(\s+|[,;:<>()[\]{}|\\/]+|\*+)/g,A=[];let F=0,j;for(;(j=S.exec(O))!==null;)j.index>F&&A.push({type:"note",value:O.substring(F,j.index)}),A.push({type:"separator",value:j[0]}),F=j.index+j[0].length;F<O.length&&A.push({type:"note",value:O.substring(F)});let N=!1;for(let $=0;$<A.length;$++){const L=A[$];if(L.type==="separator")continue;const I=L.value.trim();if(!I)continue;const q=I.match(/^([a-gA-G])([#b]?)(-?\d+)?(@[\d.]+)?$/);if(!q)continue;const ce=q[1].toUpperCase(),ee=q[2]||"",he=q[3]?parseInt(q[3],10):null,H=q[4]||"",me=[];he!==null&&!Number.isNaN(he)&&me.push(he);const Oe=u.oct||4;me.push(Oe,Oe-1,Oe+1,3,4,5);let Pe=null;for(const Ke of me){const ge=oa.get(`${ce}${ee}${Ke}`);if(ge&&Number.isFinite(ge.midi)){Pe=ge.midi;break}}if(Pe===null)return null;const De=Pe-h,Se=(De%12+12)%12,ae=i.indexOf(Se);if(ae===-1)return null;const Qe=Math.floor((De-i[ae])/12)*i.length+ae;A[$]={type:"note",value:`${Qe}${H}`},N=!0}return N?A.map($=>$.value).join(""):null},m=/\bnote\s*\(\s*(["'])([\s\S]*?)\1\s*\)/gi;return e.replace(m,(O,S,A)=>{const F=d(A);return F===null?O:`n(${S}${F}${S})`})}getScaleSemitoneSteps(e,t){const s=e&&typeof e=="string"?e.trim():"",r=t&&typeof t=="string"?t.trim():"",a=Cw[r]||r||"chromatic";let i="C";if(s){const u=s.match(/^([a-gA-G])([#b]?)/);u?i=`${u[1].toUpperCase()}${u[2]||""}`:i=s}const o=_o.get(`${i} ${a}`);if(!o||!Array.isArray(o.intervals)||o.intervals.length===0)return null;const l=o.intervals.map(u=>{const h=au.semitones(u);return Number.isFinite(h)?h:null}).filter(u=>u!==null);if(!l.length)return null;const c=Array.from(new Set(l)).sort((u,h)=>u-h);return c[0]!==0&&c.unshift(0),c}patternHasNoteNames(e){if(!e||typeof e!="string")return!1;const t=/\b(note|n)\s*\(\s*["']([^"']+)["']/gi;let s;for(;(s=t.exec(e))!==null;){const r=s[2];if(/[a-gA-G][#b]?\d/.test(r)||/[a-gA-G][#b]?\s/.test(r))return!0}return!1}patternHasNumericNotePattern(e){if(!e||typeof e!="string")return!1;const t=/\b(note|n)\s*\(\s*["']([^"']+)["']/gi;let s,r=!1;for(;(s=t.exec(e))!==null;){r=!0;let a=s[2].replace(/[<>\[\]\{\}\|,]/g," ").trim();if(a&&(/[a-gA-G]/.test(a)||!/^[\d\s~\-\/]+$/.test(a)))return!1}return r}_ensureMasterPatternSanitized(){if(!this.masterPattern||typeof this.masterPattern!="string")return"";const e=this._sanitizePatternExpression(this.masterPattern);return e!==this.masterPattern&&(console.log("🧼 Sanitized master pattern before evaluation"),this.masterPattern=e),this.masterPattern}_repairBrokenSampleStrings(e){if(!e||typeof e!="string")return e;const t=/samples\s*\(\s*\{([\s\S]*?)\}\s*,\s*\{([\s\S]*?)\}\s*\)/g;return e.replace(t,(s,r,a)=>{var m,y;const i=/"([^"]+)"\s*:\s*"([\s\S]*?)"/g,o=[];let l;for(;(l=i.exec(r))!==null;){const O=(m=l[1])==null?void 0:m.trim(),S=(y=l[2])==null?void 0:y.replace(/[\r\n]+/g,"").trim();!O||!S||o.push([O,S])}if(!o.length)return s;const c=a.match(/baseUrl\s*:\s*"([\s\S]*?)"/),u=c?c[1].replace(/[\r\n]+/g,"").trim():"./";return`samples({
${o.map(([O,S])=>`  "${O}": "${S}"`).join(`,
`)}
}, { baseUrl: "${u||"./"}" })`})}_findMatchingParenIndex(e,t){let s=0,r=!1,a=!1,i=!1,o=!1,l=!1,c=!1;for(let u=t;u<e.length;u+=1){const h=e[u],d=e[u+1];if(c){c=!1;continue}if(l){h===`
`&&(l=!1);continue}if(o){h==="*"&&d==="/"&&(o=!1,u+=1);continue}if(h==="\\"){c=!0;continue}if(r){h==="'"&&(r=!1);continue}if(a){h==='"'&&(a=!1);continue}if(i){h==="`"&&(i=!1);continue}if(h==="'"&&!a&&!i){r=!0;continue}if(h==='"'&&!r&&!i){a=!0;continue}if(h==="`"&&!r&&!a){i=!0;continue}if(h==="/"&&d==="*"){o=!0,u+=1;continue}if(h==="/"&&d==="/"){l=!0,u+=1;continue}if(h==="("){s+=1;continue}if(h===")"){if(s-=1,s===0)return u;if(s<0)return-1}}return-1}_repairLeadingSampleStatements(e){if(!e||typeof e!="string")return e;const t=e.trimStart();if(t.startsWith("(() =>")||t.startsWith("(()=>"))return e;const s=e.slice(0,e.length-t.length),r=t.match(/^(?:\/\*[\s\S]*?\*\/\s*|\/\/[^\n]*\n\s*)+/),a=r?r[0]:"";let i=t.slice(a.length).trimStart();if(!i.startsWith("samples"))return e;const o=[];let l=0;for(;i.startsWith("samples",l);){const m=l,y=i.indexOf("(",m);if(y===-1)break;const O=this._findMatchingParenIndex(i,y);if(O===-1)break;const S=i.slice(m,O+1).trim();for(o.push(S),l=O+1;l<i.length&&/\s/.test(i[l]);)l+=1}if(!o.length)return e;const c=i.slice(l).trim();if(!c)return e;const u=o.map(m=>`  ${m};`).join(`
`),h=c.split(`
`).map(m=>`    ${m}`).join(`
`),d=`(() => {
${u}
  return (
${h}
  );
})()`;return`${s}${a}${d}`}_repairStringPatternOperators(e){if(!e||typeof e!="string")return e;let t="",s=0;const r=e.length,a=i=>i?/[,\(\{\[=:+\-*\/!&|?;%]/.test(i):!0;for(;s<r;){const i=e[s];if(i==='"'||i==="'"){const o=i;let l=s+1,c=!1;for(;l<r;){const S=e[l];if(!c&&S===o)break;!c&&S==="\\"?c=!0:c=!1,l+=1}if(l>=r){t+=e.slice(s);break}const u=e.slice(s,l+1);let h=s-1;for(;h>=0&&/\s/.test(e[h]);)h-=1;const d=h>=0?e[h]:"";let m=l+1;for(;m<r&&/\s/.test(e[m]);)m+=1;const y=e.startsWith(".div",m),O=a(d);y&&O?t+=`pattern(${u})`:t+=u,s=l+1;continue}t+=i,s+=1}return t}_sanitizePatternExpression(e){if(!e||typeof e!="string")return e;let t=e;return/"[^"\r\n]*[\r\n]+[^"]*"/.test(t)&&(t=this._repairBrokenSampleStrings(t)),t=this._repairLeadingSampleStatements(t),t=this._repairStringPatternOperators(t),t}applyMasterMixModifiers(e,t={}){if(!e||typeof e!="string"||e.trim()==="")return e;const{wrapStack:s=!1}=t;let r=e;if(s){const j=r.match(/stack\s*\(/);if(j){let N=j.index+j[0].length-1,$=1,L=N+1,I=!1,q=null;for(;L<r.length&&$>0;){const ce=r[L];!I&&(ce==='"'||ce==="'")?(I=!0,q=ce):I&&ce===q&&r[L-1]!=="\\"&&(I=!1,q=null),I||(ce==="("?$++:ce===")"&&$--),$>0&&L++}$===0&&(r=r.substring(0,L+1).trimEnd())}}else r=r.replace(/\.gain\s*\([^)]*\)/g,""),r=r.replace(/\.pan\s*\([^)]*\)/g,""),r=r.replace(/\.cpm\s*\([^)]*\)/g,""),r=r.replace(/\.\.+/g,".").replace(/\.\s*$/,"").trim();r=r.replace(/\.\.+/g,".").replace(/\.\s*$/,"").trim();let a=e;if(s){const j=e.match(/stack\s*\(/);if(j){let N=j.index+j[0].length-1,$=1,L=N+1,I=!1,q=null;for(;L<e.length&&$>0;){const ce=e[L];!I&&(ce==='"'||ce==="'")?(I=!0,q=ce):I&&ce===q&&e[L-1]!=="\\"&&(I=!1,q=null),I||(ce==="("?$++:ce===")"&&$--),$>0&&L++}$===0&&(a=e.substring(L+1))}}const i=[...a.matchAll(/\.gain\s*\(\s*([^)]+)\s*\)/g)];if(i.length>0){const j=i[i.length-1],N=parseFloat(j[1]);Number.isFinite(N)&&(this.masterVolume=N)}const o=[...a.matchAll(/\.pan\s*\(\s*([^)]+)\s*\)/g)];if(o.length>0){const j=o[o.length-1],N=parseFloat(j[1]);Number.isFinite(N)&&(this.masterPan=N)}const l=[];Number.isFinite(this.masterVolume)&&Math.abs(this.masterVolume-1)>1e-6&&l.push(`.gain(${this.formatNumberForPattern(this.masterVolume,4)})`),Number.isFinite(this.masterPan)&&Math.abs(this.masterPan)>1e-6&&l.push(`.pan(${this.formatNumberForPattern(this.masterPan,4)})`);const c=Number.isFinite(this.currentTempo)&&this.currentTempo>0?this.currentTempo:120;if(Math.abs(c-120)>1e-6){const j=c/4;l.push(`.cpm(${this.formatNumberForPattern(j,6)})`)}if(!l.length)return r;e=r;const u=l,h=e.match(/^(\s*\/\/[^\n]*\n)+/);let d="",m=e;h&&(d=h[0],m=e.slice(d.length));const y=m.match(/\s*$/),O=y?y[0]:"",S=m.trim();if(!S)return e;if(s){const j=S.match(/stack\s*\(/);if(j){let $=j.index+j[0].length-1,L=1,I=$+1,q=!1,ce=null;for(;I<S.length&&L>0;){const ee=S[I];!q&&(ee==='"'||ee==="'")?(q=!0,ce=ee):q&&ee===ce&&S[I-1]!=="\\"&&(q=!1,ce=null),q||(ee==="("?L++:ee===")"&&L--),L>0&&I++}if(L===0){const ee=S.slice(0,I+1);let H=S.slice(I+1).trim(),me=H.length,Oe=0;for(;Oe<10&&(H=H.replace(/\.(gain|pan|cpm)\s*\([^)]*\)/g,""),H=H.replace(/\.\s*\(\s*(gain|pan|cpm)\s*\([^)]*\)\s*\)/g,""),H=H.replace(/\s*\(\s*(gain|pan|cpm)\s*\([^)]*\)\s*\)/g,""),H=H.replace(/\s*(gain|pan|cpm)\s*\([^)]*\)/g,""),H=H.replace(/\.\.+/g,".").replace(/\.\s*$/,"").replace(/^\s*\./,"").trim(),H.length!==me);)me=H.length,Oe++;(H.match(/(gain|pan|cpm)\s*\(/)||H.match(/[().]/))&&(H="");const Pe=ee+(u.length>0?u.join(""):"");return`${d}${Pe}${O}`}}const N=S.lastIndexOf(")");if(N!==-1){const $=S.slice(0,N+1);let I=S.slice(N+1).trim(),q=I.length,ce=0;for(;ce<10&&(I=I.replace(/\.(gain|pan|cpm)\s*\([^)]*\)/g,""),I=I.replace(/\.\s*\(\s*(gain|pan|cpm)\s*\([^)]*\)\s*\)/g,""),I=I.replace(/\s*\(\s*(gain|pan|cpm)\s*\([^)]*\)\s*\)/g,""),I=I.replace(/\s*(gain|pan|cpm)\s*\([^)]*\)/g,""),I=I.replace(/\.\.+/g,".").replace(/\.\s*$/,"").replace(/^\s*\./,"").trim(),I.length!==q);)q=I.length,ce++;(I.match(/(gain|pan|cpm)\s*\(/)||I.match(/[().]/))&&(I="");const ee=$+(u.length>0?u.join(""):"");return`${d}${ee}${O}`}}const A=S.startsWith("(")&&S.endsWith(")"),F=u.length>0?A?`${S}${u.join("")}`:`(${S})${u.join("")}`:S;return`${d}${F}${O}`}applyGlobalSettingsToPattern(e,t=!1,s=!1,r=null,a=null){if(!e||e==="silence")return e;let i=e,o=t;const l=/\b(note|n)\s*\(/.test(i),c=this.patternHasNoteNames(i),u=/\b(note|n)\s*\(\s*["'][a-g][#b]?[a-z0-9]*\s*[a-z]/.test(i)||/\b(note|n)\s*\(\s*["'][^"']*\b(maj|min|m|dim|aug|sus|add|7|9|11|13)\b/i.test(i),h=/\.\s*chord\s*\(/i.test(i),d=/\b(note|n)\s*\(\s*["'][^"']*[a-g][#b]?\s/.test(i),m=c||u||d||h,y=this.patternHasNumericNotePattern(i),O=l&&!m&&!h&&y,S=r!==null?r:this.currentKey&&this.currentKey.trim()!==""?this.currentKey.trim():"",A=a!==null?a:this.currentScale&&this.currentScale.trim()!==""?this.currentScale.trim():"",F=S&&S.trim()!=="",j=A&&A.trim()!==""?A.trim():"";let N="",$="";if(F){const L=S.toLowerCase();L.includes("m")&&!L.includes("major")?(N=L.replace("m","").trim(),$="minor"):(N=L.replace("major","").trim(),$="major"),N||(N=L.trim())}if(O){let L="";if(F){const q=j||$||"major",ce=Cw[q]||q,ee=N||S.trim().toLowerCase();L=ee?`${ee}:${ce}`:ce}else j&&(L=Cw[j]||j);const I=/\.\s*scale\s*\(/i.test(i);if(I&&(i=i.replace(/\.\s*scale\s*\((['"])(?:(?=(\\?))\2.)*?\1\)/gi,""),i=i.replace(/\.\s*scale\s*\([^)]*\)/gi,""),i=i.replace(/\.+/g,".").replace(/\.\s*\./g,".").trim(),i=i.replace(/\.+$/,"").trim(),console.log("  🔄 Removed existing scale modifier")),L&&!h){const q=`.scale('${L}')`,ce=i.search(/\.(s|sound)\s*\(/);if(ce!==-1){const ee=i.slice(0,ce),he=i.slice(ce);i=`${ee}${q}${he}`}else o?i=`${i}${q}`:(i=`(${i})${q}`,o=!0);console.log(`  🎼 Applied scale: ${L}`)}else(F||j)&&console.log(h?"  ⏭️  Skipped scale application (pattern uses .chord() modifier)":I?"  ⏭️  Skipped scale application (pattern already has scale)":"  ⏭️  Skipped scale application (pattern not compatible with key/scale settings)")}else if(m&&(F||j)){let L="note name";h?L="chord modifier (.chord())":u&&(L="chord"),console.log(`  ⏭️  Skipped scale for ${L} pattern (use numeric n() for scale/key changes)`)}else!l&&(F||j)&&console.log(`  ⏭️  Skipped scale for non-note pattern (Key: ${S||"none"}, Scale: ${j||"none"})`);return i}async updateAllPatternsWithNewTempo(){for(const[e,t]of this.activeSounds.entries())if(t.type==="strudel")try{const s=localStorage.getItem(`element-config-${e}`);if(s){const r=JSON.parse(s);r.pattern&&r.pattern.trim()!==""&&await this.updatePatternInPlace(e,r.pattern)}}catch{}}isPlaying(e){return this.activeSounds.has(e)}getAudioContext(){return this.audioContext}isAudioReady(){return this.initialized&&this.audioContext&&(this.audioContext.state==="running"||this.audioContext.state==="suspended")}playSustainingTone(e,t,s,r,a=null){if(!this.initialized||!this.audioContext)return;this.audioContext.state==="suspended"&&(Qu(),this.audioContext.resume().catch(d=>{console.error("Failed to resume audio context:",d)}));const i=(t-s)/(r-s),o=160,c=o*Math.pow(1e4/o,i);this.stopSustainingTone(e);const u=this.audioContext.createOscillator(),h=this.audioContext.createGain();if(u.type="sine",u.frequency.value=c,u.connect(h),a){const d=this.getElementAudioNodes(a);d?(h.connect(d.gainNode),h.gain.value=.3):(h.connect(this.gainNode),h.gain.value=this.volume*.3)}else h.connect(this.gainNode),h.gain.value=this.volume*.3;u.start(0),this.activeSounds.set(e,{type:"sustaining",oscillator:u,gain:h,frequency:c})}updateSustainingToneFrequency(e,t,s,r,a=null){if(!this.audioContext)return;this.audioContext.state==="suspended"&&(Qu(),this.audioContext.resume().catch(o=>{console.error("Failed to resume audio context:",o)}));const i=this.activeSounds.get(e);if(i&&i.type==="sustaining"&&i.oscillator)try{const o=(t-s)/(r-s),l=160,u=l*Math.pow(1e4/l,o);i.oscillator.frequency.setValueAtTime(u,this.audioContext.currentTime),i.frequency=u}catch(o){console.error("Error updating sustaining tone frequency:",o),this.playSustainingTone(e,t,s,r,a)}else this.playSustainingTone(e,t,s,r,a)}async checkSoundBanksStatus(){if(!window.strudel||!window.strudel.evaluate)return{loaded:!1,error:"Strudel not initialized"};try{return{loaded:(typeof globalThis.s=="function"&&typeof globalThis.sound=="function")===!0}}catch(e){return{loaded:!1,error:e.message}}}async ensureDefaultSoundBanks(){var e;if(!window.strudel||!window.strudel.evaluate){try{this.strudelLoaded||await this.initializeStrudelAndSounds()}catch{}if(!window.strudel||!window.strudel.evaluate)return!1}if(this.strudelSoundBanksLoaded)return!0;if(this.strudelSoundBankLoading){for(;this.strudelSoundBankLoading;)await new Promise(t=>setTimeout(t,100));return this.strudelSoundBanksLoaded}this.strudelSoundBankLoading=!0;try{if(console.log("📦 Loading default Strudel sound banks (dirt-samples)..."),typeof document<"u"){const r=document.getElementById("status-text");r&&(r.textContent="📦 Loading default drum samples...")}const t=((e=window.strudel)==null?void 0:e.samples)||globalThis.samples;if(t&&typeof t=="function")try{console.log("📦 Loading default Strudel samples from dough-samples CDN...");const r=kw,a={tidalDrums:!1,piano:!1,dirt:!1,vcsl:!1,mridangam:!1};if(await Promise.all([t(`${r}/tidal-drum-machines.json`).then(()=>{console.log("  ✅ Tidal drum machines loaded (TR-808, TR-909, TR-707, RhythmAce, AkaiLinn, etc.)"),a.tidalDrums=!0}).catch(i=>{console.warn("  ⚠️ Could not load tidal-drum-machines from CDN:",i.message),console.log("  📁 Will use local TR-808/TR-909 samples as fallback")}),t(`${r}/piano.json`).then(()=>{console.log("  ✅ Piano samples loaded"),a.piano=!0}).catch(i=>console.warn("  ⚠️ Could not load piano:",i.message)),t(`${r}/Dirt-Samples.json`).then(()=>{console.log("  ✅ Dirt-Samples loaded"),a.dirt=!0}).catch(i=>console.warn("  ⚠️ Could not load Dirt-Samples:",i.message)),t(`${r}/vcsl.json`).then(()=>{console.log("  ✅ VCSL (vocal) samples loaded"),a.vcsl=!0}).catch(i=>console.warn("  ⚠️ Could not load VCSL:",i.message)),t(`${r}/mridangam.json`).then(()=>{console.log("  ✅ Mridangam (percussion) samples loaded"),a.mridangam=!0}).catch(i=>console.warn("  ⚠️ Could not load mridangam:",i.message))]),console.log("✅ Default Strudel samples loaded from dough-samples CDN"),a.tidalDrums)console.log("📝 Note: TR-808 and TR-909 loaded from CDN (local samples available as backup)");else{console.log("📁 Loading local TR-808 and TR-909 samples as fallback...");try{await this.loadBank("RolandTR808"),await this.loadBank("RolandTR909"),console.log("✅ Local TR-808 and TR-909 samples loaded successfully")}catch(i){console.warn("⚠️ Could not load local TR-808/TR-909 samples:",i)}}}catch(r){console.warn("⚠️ Error loading samples from dough-samples:",r),console.log("   Attempting to load local TR-808/TR-909 samples...");try{await this.loadBank("RolandTR808"),await this.loadBank("RolandTR909"),console.log("✅ Local TR-808 and TR-909 samples loaded as fallback")}catch(a){console.warn("⚠️ Could not load local samples either:",a)}}this.strudelSoundBanksLoaded=!0,this.strudelSoundBankLoading=!1,console.log("✅ Default sound banks ready"),console.log("📦 Available: Piano, Dirt-Samples, VCSL, Mridangam, Drum Machines (TR-808, TR-909, TR-707, etc.)"),console.log("🧪 Testing pattern evaluation...");let s=!1;if(typeof globalThis.silence=="object"&&typeof globalThis.sound=="function"&&typeof globalThis.note=="function"){console.log("✅ Pattern functions available in globalThis");try{await window.strudel.evaluate("d16 = silence"),console.log("✅ Pattern assignment test passed"),s=!0}catch(r){console.warn("⚠️ Pattern assignment test failed:",r),await new Promise(a=>setTimeout(a,1e3));try{await window.strudel.evaluate("d16 = silence"),console.log("✅ Pattern assignment test passed on retry"),s=!0}catch(a){console.error("❌ Pattern assignment still failing:",a)}}}else console.error("❌ Pattern functions not available in globalThis"),console.log("  silence:",typeof globalThis.silence,"(should be object)"),console.log("  sound:",typeof globalThis.sound,"(should be function)"),console.log("  note:",typeof globalThis.note,"(should be function)");if(s&&this.onSoundsReadyCallback?(console.log("🔔 Notifying app that sounds are ready..."),this.onSoundsReadyCallback()):s||console.warn("⚠️ Sounds loaded but patterns not ready - dots will stay red"),typeof document<"u"){const r=document.getElementById("status-text");r&&(r.textContent="✅ Samples loaded - Ready!",setTimeout(()=>{r.textContent.includes("Samples loaded")&&(r.textContent="Ready - Click elements to start/stop patterns (Press Escape to stop all)")},2e3))}return!0}catch(t){return this.strudelSoundBankLoading=!1,t.message&&t.message.includes("CycleTones")?(console.log("⚠️ CycleTones not available - patterns will use dirt-samples if loaded"),!1):(console.error("❌ Failed to load default sound banks:",t),console.error("Error details:",t.message,t.stack),console.error("Strudel patterns may not work without default sound banks"),!1)}}async preloadAllCommonDrumSounds(){return console.log("📦 Preloading skipped (silent mode) - no audible patterns will be evaluated"),!0}exposeSampleListHelper(e,t){globalThis.getLoadedSamples=()=>{try{let s=null,r="";const a=(e==null?void 0:e.soundMap)||(t==null?void 0:t.soundMap);if(a&&(s=typeof a.get=="function"?a.get():a,s&&typeof s=="object"&&(r="webaudioModule/webModule.soundMap")),(!s||Object.keys(s).length===0)&&this.strudelRepl){const l=this.strudelRepl;if(l.scheduler){const c=l.scheduler;if(c.soundMap&&(s=typeof c.soundMap.get=="function"?c.soundMap.get():c.soundMap,s&&typeof s=="object"&&(r="repl.scheduler.soundMap")),(!s||Object.keys(s).length===0)&&c.context){const u=c.context;u.soundMap&&(s=typeof u.soundMap.get=="function"?u.soundMap.get():u.soundMap,s&&typeof s=="object"&&(r="repl.scheduler.context.soundMap"))}}}if((!s||Object.keys(s).length===0)&&window.strudel&&window.strudel.repl&&window.strudel.repl.scheduler){const l=window.strudel.repl.scheduler;l.soundMap&&(s=typeof l.soundMap.get=="function"?l.soundMap.get():l.soundMap,s&&typeof s=="object"&&(r="window.strudel.repl.scheduler.soundMap"))}if(!s||Object.keys(s).length===0){const l=(e==null?void 0:e.getSound)||(t==null?void 0:t.getSound);if(l&&typeof l=="function"){console.log("🔍 Attempting to detect samples via getSound function...");const c=["bd","sd","hh","cp","oh","cr","rim","tr808_bd","tr909_bd","RolandTR808_bd","RolandTR909_bd"],u=[];c.forEach(h=>{try{const d=l(h);d&&d!=="triangle"&&u.push(h)}catch{}}),u.length>0&&(console.log(`📊 Found ${u.length} samples via getSound:`,u),r="getSound detection")}}if((!s||Object.keys(s).length===0)&&this.strudelRepl){const l=this.strudelRepl;console.log("🔍 Checking REPL properties for sample registry..."),console.log("   REPL keys:",Object.keys(l).slice(0,20)),l.scheduler&&(console.log("   Scheduler keys:",Object.keys(l.scheduler).slice(0,20)),l.scheduler.context&&console.log("   Scheduler.context keys:",Object.keys(l.scheduler.context).slice(0,20))),l.samples&&typeof l.samples=="object"&&(s=l.samples,r="repl.samples",console.log("✅ Found samples in repl.samples"))}if((!s||Object.keys(s).length===0)&&window.strudel&&window.strudel.evaluate){console.log("🔍 Testing pattern evaluation to detect available samples...");const l=['s("bd")','s("bd").bank("tr808")','s("bd").bank("tr909")','sound("bd")'];for(const c of l)try{const u=window.strudel.evaluate(c);console.log(`   Pattern "${c}" evaluated successfully`)}catch(u){u.message&&(u.message.includes("not found")||u.message.includes("not loaded"))?console.log(`   Pattern "${c}" - sample not found (expected)`):console.log(`   Pattern "${c}" - error:`,u.message)}}if(!s||Object.keys(s).length===0){const l=Object.keys(globalThis).filter(c=>c.toLowerCase().includes("sample")||c.toLowerCase().includes("sound")||c.toLowerCase().includes("bank"));l.length>0&&(console.log("🔍 Found potential sample-related globals:",l),l.forEach(c=>{try{const u=globalThis[c];if(typeof u=="object"&&u!==null&&!Array.isArray(u)){const h=Object.keys(u);h.length>0&&(console.log(`   ${c} has ${h.length} keys:`,h.slice(0,10)),(!s||Object.keys(s).length===0)&&(s=u,r=`globalThis.${c}`))}}catch{}}))}if(!s||typeof s!="object"||Object.keys(s).length===0)return console.log("⚠️ soundMap not found or empty"),console.log("   Tried: webaudioModule, webModule, repl.scheduler, window.strudel"),console.log("   This might mean samples are loaded but not yet registered"),console.log("   Try loading a bank first, then check again"),{total:0,keys:[],byBank:{},source:"none",note:"No samples found. Samples may need to be loaded first."};const i=Object.keys(s);console.log(`📊 Total loaded samples: ${i.length} (from ${r})`),console.log("📋 All loaded sample names:",i);const o={};return i.forEach(l=>{const c=l.split("_");if(c.length>1){const u=c[0],h=c.slice(1).join("_");o[u]||(o[u]=[]),o[u].push(h)}else o.default||(o.default=[]),o.default.push(l)}),Object.keys(o).length>0&&(console.log("📦 Samples grouped by bank:"),Object.entries(o).forEach(([l,c])=>{console.log(`  ${l}: ${c.length} sounds`,c.slice(0,20))})),{total:i.length,keys:i,byBank:o,source:r}}catch(s){return console.error("❌ Error getting loaded samples:",s),console.error("   Stack:",s.stack),null}},console.log("✅ Helper function available: getLoadedSamples()"),console.log("   Call getLoadedSamples() in console to see all loaded samples")}async loadBank(e){var u,h,d,m,y;if(!window.strudel||!window.strudel.evaluate)throw console.warn("Cannot load bank: Strudel not initialized"),new Error("Strudel not initialized");if(!e||typeof e!="string")return console.warn("Cannot load bank: invalid name",e),!1;if(e=e.trim(),!e)return console.warn("Cannot load bank: empty name after trimming"),!1;const t=e.toLowerCase();if(new Set(["sine","square","triangle","sawtooth","supersaw","pulse","saw","saw2","saw3","saw4","saw8"]).has(e.toLowerCase()))return console.log(`⏭️ Skipping built-in oscillator synth "${e}" (no loading needed)`),this.loadedBanks.add(e.toLowerCase()),this.loadedBanks.add(e),!0;const r={RolandTR909:{RolandTR909_bd:Li(["assets/sounds/Kicks/ESWTR909 Kick 01.wav","assets/sounds/Kicks/ESWTR909 Kick 02.wav","assets/sounds/Kicks/ESWTR909 Kick 03.wav","assets/sounds/Kicks/ESWTR909 Kick 04.wav","assets/sounds/Kicks/ESWTR909 Kick 05.wav","assets/sounds/Kicks/ESWTR909 Kick 06.wav","assets/sounds/Kicks/ESWTR909 Kick 07.wav","assets/sounds/Kicks/ESWTR909 Kick 08.wav","assets/sounds/Kicks/ESWTR909 Kick 09.wav","assets/sounds/Kicks/ESWTR909 Kick 10.wav"]),RolandTR909_sd:Li(["assets/sounds/Snares/ESWTR909 Snare 01.wav","assets/sounds/Snares/ESWTR909 Snare 02.wav","assets/sounds/Snares/ESWTR909 Snare 03.wav","assets/sounds/Snares/ESWTR909 Snare 04.wav","assets/sounds/Snares/ESWTR909 Snare 05.wav","assets/sounds/Snares/ESWTR909 Snare 06.wav","assets/sounds/Snares/ESWTR909 Snare 07.wav","assets/sounds/Snares/ESWTR909 Snare 08.wav","assets/sounds/Snares/ESWTR909 Snare 09.wav","assets/sounds/Snares/ESWTR909 Snare 10.wav","assets/sounds/Snares/ESWTR909 Snare 11.wav","assets/sounds/Snares/ESWTR909 Snare 12.wav"]),RolandTR909_hh:Li(["assets/sounds/Hats/ESWTR909 HH Closed 01.wav","assets/sounds/Hats/ESWTR909 HH Closed 02.wav","assets/sounds/Hats/ESWTR909 HH Closed 03.wav","assets/sounds/Hats/ESWTR909 HH Closed 04.wav","assets/sounds/Hats/ESWTR909 HH Closed 05.wav","assets/sounds/Hats/ESWTR909 HH Closed 06.wav","assets/sounds/Hats/ESWTR909 HH Closed 07.wav","assets/sounds/Hats/ESWTR909 HH Closed 08.wav","assets/sounds/Hats/ESWTR909 HH Closed 09.wav","assets/sounds/Hats/ESWTR909 HH Closed 10.wav"]),RolandTR909_oh:Li(["assets/sounds/Hats/ESWTR909 HH Open 01.wav","assets/sounds/Hats/ESWTR909 HH Open 02.wav","assets/sounds/Hats/ESWTR909 HH Open 03.wav","assets/sounds/Hats/ESWTR909 HH Open 04.wav","assets/sounds/Hats/ESWTR909 HH Open 05.wav","assets/sounds/Hats/ESWTR909 HH Open 06.wav","assets/sounds/Hats/ESWTR909 HH Open 07.wav","assets/sounds/Hats/ESWTR909 HH Open 08.wav"]),RolandTR909_cp:Li(["assets/sounds/Claps/ESWTR909 Clap 01.wav","assets/sounds/Claps/ESWTR909 Clap 02.wav","assets/sounds/Claps/ESWTR909 Clap 03.wav","assets/sounds/Claps/ESWTR909 Clap 04.wav","assets/sounds/Claps/ESWTR909 Clap 05.wav"]),RolandTR909_cr:Li(["assets/sounds/Hats/ESWTR909 HH Crash 01.wav","assets/sounds/Hats/ESWTR909 HH Crash 02.wav","assets/sounds/Hats/ESWTR909 HH Crash 03.wav","assets/sounds/Hats/ESWTR909 HH Crash 04.wav","assets/sounds/Hats/ESWTR909 HH Crash 05.wav"]),RolandTR909_lt:Li(["assets/sounds/Toms/ESWTR909 Tom 01.wav","assets/sounds/Toms/ESWTR909 Tom 02.wav","assets/sounds/Toms/ESWTR909 Tom 03.wav","assets/sounds/Toms/ESWTR909 Tom 04.wav","assets/sounds/Toms/ESWTR909 Tom 05.wav"]),RolandTR909_mt:Li(["assets/sounds/Toms/ESWTR909 Tom 06.wav","assets/sounds/Toms/ESWTR909 Tom 07.wav","assets/sounds/Toms/ESWTR909 Tom 08.wav","assets/sounds/Toms/ESWTR909 Tom 09.wav","assets/sounds/Toms/ESWTR909 Tom 10.wav"]),RolandTR909_ht:Li(["assets/sounds/Toms/ESWTR909 Tom 11.wav","assets/sounds/Toms/ESWTR909 Tom 12.wav","assets/sounds/Toms/ESWTR909 Tom 13.wav","assets/sounds/Toms/ESWTR909 Tom 14.wav","assets/sounds/Toms/ESWTR909 Tom 15.wav"])},RolandTR808:{RolandTR808_bd:Li(["assets/sounds/Kicks/ESW909X Kick 01.wav","assets/sounds/Kicks/ESW909X Kick 02.wav","assets/sounds/Kicks/ESW909X Kick 03.wav","assets/sounds/Kicks/ESW909X Kick 04.wav","assets/sounds/Kicks/ESW909X Kick 05.wav"]),RolandTR808_sd:Li(["assets/sounds/Snares/ESW909X Snare 01.wav","assets/sounds/Snares/ESW909X Snare 02.wav","assets/sounds/Snares/ESW909X Snare 03.wav","assets/sounds/Snares/ESW909X Snare 04.wav","assets/sounds/Snares/ESW909X Snare 05.wav"]),RolandTR808_cp:Li(["assets/sounds/Claps/ESW909X Clap 01.wav","assets/sounds/Claps/ESW909X Clap 02.wav","assets/sounds/Claps/ESW909X Clap 03.wav","assets/sounds/Claps/ESW909X Clap 04.wav","assets/sounds/Claps/ESW909X Clap 05.wav"])}},a=["RolandTR707","RhythmAce","AkaiLinn","ViscoSpaceDrum","CasioRZ1"],i=["piano","superpiano","jazz","supersaw","folkharp","casio","insect","wind","wood","metal","east","crow","space","numbers","sawtooth","sine","square","triangle","saw","saw2","saw3","saw4","saw8","gtr"],o={mridangam:`${kw}/mridangam.json`,vcsl:`${kw}/vcsl.json`};if(o[t]){const O=((u=window.strudel)==null?void 0:u.samples)||globalThis.samples;if(!O||typeof O!="function")return console.warn(`⚠️ samples() function not available for specialty bank "${t}"`),!1;try{console.log(`📦 Loading specialty sample bank "${t}" from dough-samples`);let S=this.specialtyManifests.get(t);if(!S){const j=await fetch(o[t]);if(!j.ok)throw new Error(`HTTP ${j.status}`);const N=await j.json();S=Xpe(N),this.specialtyManifests.set(t,S)}const A={...S},F=Object.keys(S||{});return F.forEach(j=>{const N=`${t}_${j}`;A[N]||(A[N]=S[j])}),await O(A),F.forEach(j=>{const N=j.toLowerCase();this.sampleNameToSpecialtyBank.set(N,t),this.sampleNameToSpecialtyBank.set(`${t}_${N}`,t),this.loadedBanks.add(N),this.loadedBanks.add(j),this.loadedBanks.add(`${t}_${N}`),this.loadedBanks.add(`${t}_${j}`)}),this.loadedBanks.add(t),this.loadedBanks.add(e),console.log(`✅ Specialty bank "${t}" loaded`),!0}catch(S){return console.warn(`⚠️ Failed to load specialty bank "${t}":`,S.message||S),!1}}if(r[e]){console.log(`📦 Loading local custom bank "${e}" from assets folder...`);const O=((h=window.strudel)==null?void 0:h.samples)||globalThis.samples;if(O&&typeof O=="function")try{const S={...r[e]},A=`${e}_`.toLowerCase();return Object.entries(r[e]).forEach(([F,j])=>{if(S[F]=j,F.toLowerCase().startsWith(A)){const N=F.slice(A.length);N&&!S[N]&&(S[N]=j)}}),await O(S),Object.keys(S).forEach(F=>this.loadedBanks.add(F)),this.loadedBanks.add(e),console.log(`✅ Local custom bank "${e}" loaded successfully from assets`),!0}catch(S){return console.error(`❌ Failed to load local bank "${e}":`,S),!1}else return console.error("❌ samples() function not available"),!1}if(a.includes(e)){console.log(`📦 Ensuring built-in drum bank "${e}" samples are loaded...`);try{const S=`d15 = s("bd sd hh cp oh cr rd ht mt lt sh cb tb pe").bank("${e}")`;if(await window.strudel.evaluate(S),window.strudel.scheduler&&typeof window.strudel.scheduler.tick=="function")for(let A=0;A<4;A++)window.strudel.scheduler.tick(),await new Promise(F=>setTimeout(F,50));else await new Promise(A=>setTimeout(A,200));return await window.strudel.evaluate("d15 = silence"),this.loadedBanks.add(e),console.log(`✅ Built-in drum bank "${e}" ready`),!0}catch(O){return console.warn(`⚠️ Could not preload built-in bank "${e}":`,O),this.loadedBanks.add(e),!0}}let l=t;if(um[t]&&(l=um[t],console.log(`🔄 Normalizing bank name "${e}" to "${l}"`)),i.includes(l)){const O=((d=window.strudel)==null?void 0:d.samples)||globalThis.samples;if(O&&typeof O=="function")try{return console.log(`📦 Loading sample bank "${l}" via samples()`),await O(l),this.loadedBanks.add(l),this.loadedBanks.add(t),console.log(`✅ Sample bank "${l}" loaded`),!0}catch(S){return console.warn(`⚠️ Failed to load sample bank "${l}":`,S.message||S),this.loadedBanks.add(l),this.loadedBanks.add(t),!1}else return console.warn(`⚠️ samples() function not available for loading "${l}"`),!1}if(e.startsWith("github:")){const O=((m=window.strudel)==null?void 0:m.samples)||globalThis.samples;if(!O||typeof O!="function")throw console.error("samples function not available!"),new Error("samples function not available");console.log(`📦 Loading bank via samples(): ${e}`);try{const S=await O(e);return console.log("samples() call completed, result:",S),console.log("⏳ Waiting for samples to load..."),await new Promise(A=>setTimeout(A,2e3)),console.log(`✅ Bank loaded: ${e}`),!0}catch(S){throw console.error(`❌ Failed to load bank ${e}:`,S),S}}else{console.log(`📦 Bank "${e}" is a predefined bank name`);const O=((y=window.strudel)==null?void 0:y.samples)||globalThis.samples;if(!O||typeof O!="function")return console.warn(`⚠️ samples function not available for loading bank "${e}"`),console.log(`   Bank "${e}" may need to be loaded manually`),!1;const S=[e];let A=!1;const F=console.error;console.error=(...N)=>{let $="";for(let q=0;q<N.length;q++)typeof N[q]=="string"?$+=" "+N[q]:N[q]&&N[q].toString&&($+=" "+String(N[q]));const L=String(N[0]||""),I=$.toLowerCase();L.includes("JSON")||L.includes("SyntaxError")||L.includes("not found")||L.includes("RolandTR")||L.includes("404")||L.includes("Failed")||L.includes("<!DOCTYPE")||L.includes("Unexpected token")||L.includes("is not valid JSON")||L.includes("Unexpected non-whitespace")||$.includes("JSON")||$.includes("SyntaxError")||$.includes("not found")||$.includes("RolandTR")||$.includes("404")||$.includes("<!DOCTYPE")||$.includes("Unexpected token")||$.includes("is not valid JSON")||I.includes("json")||I.includes("syntaxerror")||I.includes("rolandtr")||F.apply(console,N)};try{for(const N of S)try{console.log(`   Trying to load from: ${N}`);const $=await O(N);console.log(`   ✅ Successfully called samples() with: ${N}`),A=!0;break}catch{console.log(`   ✗ Path "${N}" not available`);continue}}finally{console.error=F}return A?(console.log("⏳ Waiting for samples to load..."),await new Promise(N=>setTimeout(N,3e3)),console.log(`✅ Bank "${e}" loading initiated`),this.loadedBanks.add(e)):(console.log(`⚠️ Could not load "${e}" from any known path`),console.log(`   Bank "${e}" may be embedded in Strudel or unavailable`),console.log(`   To use this bank in patterns (if available), use: .bank("${e}")`),console.log(`   Example: sound("bd hh").bank("${e}")`)),A}}async initializeMIDI(){try{if(await ft.enable(),this.midiEnabled=!0,console.log("✅ WebMidi enabled"),ft.outputs.forEach(e=>{this.midiOutputs.set(e.name,e),console.log(`🎹 MIDI Output available: ${e.name}`)}),this.midiOutputs.size>0){const e=Array.from(this.midiOutputs.values())[0];this.selectedMidiOutput=e,console.log(`✅ Auto-selected MIDI output: ${e.name}`)}ft.addListener("connected",e=>{e.port.type==="output"&&(this.midiOutputs.set(e.port.name,e.port),console.log(`🎹 MIDI Output connected: ${e.port.name}`),this.selectedMidiOutput||(this.selectedMidiOutput=e.port,console.log(`✅ Auto-selected MIDI output: ${e.port.name}`)))}),ft.addListener("disconnected",e=>{e.port.type==="output"&&(this.midiOutputs.delete(e.port.name),console.log(`🎹 MIDI Output disconnected: ${e.port.name}`),this.selectedMidiOutput===e.port&&(this.selectedMidiOutput=null,this.midiOutputs.size>0&&(this.selectedMidiOutput=Array.from(this.midiOutputs.values())[0],console.log(`✅ Auto-selected new MIDI output: ${this.selectedMidiOutput.name}`))))}),this.setupStrudelMIDIOutput(),this.ensurePatternMidiMethodsRegistered("initializeMIDI")}catch(e){console.warn("⚠️ WebMidi initialization failed:",e),this.midiEnabled=!1}}setupStrudelMIDIOutput(){var e,t;if(!(!this.midiEnabled||!window.strudel))try{const s=(e=window.strudel)==null?void 0:e.scheduler,r=(s==null?void 0:s.webaudio)||((t=window.strudel)==null?void 0:t.webaudio);if(r)if(r.midiOutput){const a=r.midiOutput;r.midiOutput=i=>{this.sendMIDIMessage(i),a&&typeof a=="function"&&a(i)},console.log("✅ Connected Strudel webaudio.midiOutput to WebMidi")}else r.midiOutput=a=>{this.sendMIDIMessage(a)},console.log("✅ Created Strudel webaudio.midiOutput handler"),console.log("ℹ️ MIDI modifiers (.midi(), .midiport()) should now be available on patterns");if(window.strudel.midiOutput){const a=window.strudel.midiOutput;window.strudel.midiOutput=i=>{this.sendMIDIMessage(i),a&&typeof a=="function"&&a(i)}}else window.strudel.midiOutput=a=>{this.sendMIDIMessage(a)};setTimeout(()=>{this.selectIACDriver()},500),this.ensurePatternMidiMethodsRegistered("setupStrudelMIDIOutput"),console.log("✅ Strudel MIDI output handler set up")}catch(s){console.warn("⚠️ Failed to set up Strudel MIDI output:",s)}}selectIACDriver(){const e=["IAC Driver Bus 1","IAC Driver Bus 2","IAC Driver","IAC Bus 1","IAC Bus 2","loopMIDI","Virtual MIDI"];for(const t of e)for(const[s,r]of this.midiOutputs.entries())if(s===t||t.toLowerCase().includes("iac")&&s.toLowerCase().includes("iac")){this.selectMIDIOutput(s),console.log(`✅ Auto-selected IAC Driver: ${s}`);return}this.midiOutputs.size>0?(console.log("ℹ️ IAC Driver not found. Available MIDI outputs:",Array.from(this.midiOutputs.keys()).join(", ")),console.log('ℹ️ You can manually select a MIDI output using: soundManager.selectMIDIOutput("port name")')):console.log("ℹ️ No MIDI outputs available. Make sure IAC Driver is enabled in Audio MIDI Setup on macOS.")}sendMIDIMessageToPort(e,t=null){if(!this.midiEnabled)return;let s=null;if(t&&this.midiOutputs&&this.midiOutputs.has(t)?s=this.midiOutputs.get(t):this.selectedMidiOutput&&(s=this.selectedMidiOutput),!s){this._midiFallbackLogged||(console.log("ℹ️ MIDI message received but no hardware output is configured yet. Message will be ignored until a MIDI port is selected."),this._midiFallbackLogged=!0);return}this._midiFallbackLogged=!1;const r=this.selectedMidiOutput;this.selectedMidiOutput=s;try{this.sendMIDIMessage(e)}finally{this.selectedMidiOutput=r}}sendMIDIMessage(e){if(!this.midiEnabled||!this.selectedMidiOutput){this._midiFallbackLogged||(console.log("ℹ️ MIDI message received but no hardware output is configured yet. Message will be ignored until a MIDI port is selected."),this._midiFallbackLogged=!0);return}this._midiFallbackLogged=!1;try{let t=this.midiChannel,s=null,r=127,a=null;switch(e.channel!==void 0?t=e.channel:e.port!==void 0&&(t=e.port),e.note!==void 0?s=e.note:e.number!==void 0&&(s=e.number),e.velocity!==void 0?r=e.velocity:e.value!==void 0&&e.type==="noteon"&&(r=e.value),e.type?a=e.type.toLowerCase():s!==null&&(a="noteon"),t=Math.max(0,Math.min(15,t)),a){case"noteon":case"noteon":if(s!==null){const i=Math.max(0,Math.min(1,r/127));this.selectedMidiOutput.playNote(s,{channel:t+1,attack:i});const o=`${s}:${t}`;this.activeMidiNotes.add(o)}break;case"noteoff":case"noteoff":if(s!==null){this.selectedMidiOutput.stopNote(s,{channel:t+1});const i=`${s}:${t}`;this.activeMidiNotes.delete(i)}break;case"cc":case"controlchange":e.controller!==void 0&&e.value!==void 0&&this.selectedMidiOutput.sendControlChange(e.controller,e.value,{channel:t+1});break;case"programchange":e.program!==void 0&&this.selectedMidiOutput.sendProgramChange(e.program,{channel:t+1});break;case"pitchbend":e.value!==void 0&&this.selectedMidiOutput.sendPitchBend(e.value,{channel:t+1});break;default:if(e.data&&Array.isArray(e.data))this.selectedMidiOutput.send(e.data);else if(s!==null){const i=Math.max(0,Math.min(1,r/127));this.selectedMidiOutput.playNote(s,{channel:t+1,attack:i});const o=`${s}:${t}`;this.activeMidiNotes.add(o)}}}catch(t){console.warn("⚠️ Failed to send MIDI message:",t,e)}}ensurePatternMidiMethodsRegistered(e="unspecified"){try{const t=this._gatherPatternConstructors();let s=0;t.forEach(r=>{this._installMidiMethodsOnPatternCtor(r,e)&&(s+=1)}),s>0&&console.log(`✅ Registered MIDI methods on ${s} Pattern constructor(s) (${e})`)}catch(t){console.warn("⚠️ Failed to ensure MIDI methods on Pattern prototypes:",t)}}_gatherPatternConstructors(){var a,i;const e=new Set,t=o=>{o&&typeof o=="function"&&o.prototype&&e.add(o)};t(globalThis.Pattern),t((a=window==null?void 0:window.strudel)==null?void 0:a.Pattern);const s=globalThis.silence;s&&s.constructor&&t(s.constructor);const r=globalThis.note||((i=window==null?void 0:window.strudel)==null?void 0:i.note);if(typeof r=="function")try{const o=r("c");o&&o.constructor&&t(o.constructor)}catch{}return Array.isArray(this._knownPatternConstructors)&&this._knownPatternConstructors.forEach(t),this._knownPatternConstructors=Array.from(e),e}_installMidiMethodsOnPatternCtor(e,t){if(!e||!e.prototype)return!1;const s=e.prototype;let r=!1;if((typeof s.midi!="function"||!s.midi.__soundManagerInjected)&&(s.midi=this._getPatternMidiMethod(),s.midi.__soundManagerInjected=!0,r=!0),(typeof s.midiport!="function"||!s.midiport.__soundManagerInjected)&&(s.midiport=this._getPatternMidiportMethod(),s.midiport.__soundManagerInjected=!0,r=!0),r){const a=e.name||"AnonymousPattern";console.log(`🎛️ MIDI methods installed on Pattern prototype (${a}, reason: ${t})`)}return r}_getPatternMidiMethod(){if(this._patternMidiMethod)return this._patternMidiMethod;const e=this;return this._patternMidiMethod=function(s){return this.fmap((r,a={})=>{var o;const i=s??((o=a==null?void 0:a.context)==null?void 0:o.midiport)??null;return e._processPatternValueForMIDI(r,a==null?void 0:a.time,i),r})},this._patternMidiMethod}_getPatternMidiportMethod(){return this._patternMidiportMethod?this._patternMidiportMethod:(this._patternMidiportMethod=function(t){return this.fmap(s=>(s&&typeof s=="object"&&(s.midiport=t),s))},this._patternMidiportMethod)}_processPatternValueForMIDI(e,t,s){const r=this._convertValueToMidiMessage(e,t);if(!r){Math.random()<.1&&console.log("🔍 MIDI: Could not convert value to MIDI message:",{value:e,valueType:typeof e,isObject:typeof e=="object"&&e!==null,keys:typeof e=="object"&&e!==null?Object.keys(e).slice(0,10):[],hasNote:e==null?void 0:e.note,hasNumber:e==null?void 0:e.number,hasMidi:e==null?void 0:e.midi});return}const a=this._getMidiOutputForPattern(s);if(a)try{a(r),Math.random()<.05&&console.log("🎹 MIDI sent:",{note:r.note,velocity:r.velocity,channel:r.channel,port:s||"default"})}catch(i){console.warn("⚠️ MIDI send error:",i,r)}else this._midiOutputMissingWarned||(this._midiOutputMissingWarned=!0,console.warn("⚠️ MIDI output handler not available. Select a MIDI output or enable WebMidi."))}_getMidiOutputForPattern(e){var r,a;const t=(r=window.strudel)==null?void 0:r.scheduler,s=(t==null?void 0:t.webaudio)||((a=window.strudel)==null?void 0:a.webaudio);if(s&&typeof s.midiOutput=="function")return i=>{try{s.midiOutput(i)}catch(o){console.warn("⚠️ webaudio.midiOutput error:",o)}};if(this.midiEnabled&&typeof this.sendMIDIMessageToPort=="function"){if(e&&this.midiOutputs&&this.midiOutputs.has(e))return i=>{try{this.sendMIDIMessageToPort(i,e)}catch(o){console.warn("⚠️ sendMIDIMessageToPort error:",o)}};if(this.selectedMidiOutput)return i=>{try{this.sendMIDIMessageToPort(i,null)}catch(o){console.warn("⚠️ sendMIDIMessageToPort error:",o)}}}return this.midiEnabled&&typeof this.sendMIDIMessage=="function"&&this.selectedMidiOutput?i=>{try{this.sendMIDIMessage(i)}catch(o){console.warn("⚠️ sendMIDIMessage error:",o)}}:null}_convertValueToMidiMessage(e,t=0){let s=null,r=100,a=0;if(e&&typeof e=="object"){if(e.note!==void 0)s=e.note;else if(e.number!==void 0)s=e.number;else if(e.midi!==void 0)s=e.midi;else if(e.sound!==void 0||e.name!==void 0){const i=e.sound||e.name;if(typeof i=="string"){const o={bd:36,sd:38,hh:42,oh:46,cp:49,ride:51,tom:48,kick:36,snare:38,hat:42,crash:49},l=i.toLowerCase();if(o[l])s=o[l];else{const c=i.match(/(\d+)/);if(c){const u=parseInt(c[1],10);u>=0&&u<=127&&(s=u)}}}}e.velocity!==void 0&&(r=e.velocity),e.channel!==void 0?a=e.channel:e.port!==void 0&&(a=e.port)}else typeof e=="number"?s=e:typeof e=="string"&&(s=this._noteNameToMidi(e));return typeof s!="number"||Number.isNaN(s)?null:{type:"noteOn",note:Math.round(s),velocity:Math.max(1,Math.min(127,Math.round(r))),channel:Math.max(0,Math.min(15,Math.round(a))),time:t}}_noteNameToMidi(e){if(!e||typeof e!="string")return null;try{const t=oa.get(e);if(t&&typeof t.midi=="number")return Math.round(t.midi)}catch{}return null}getMIDIOutputs(){return Array.from(this.midiOutputs.keys())}selectMIDIOutput(e){return this.midiOutputs.has(e)?(this.selectedMidiOutput=this.midiOutputs.get(e),console.log(`✅ Selected MIDI output: ${e}`),!0):(console.warn(`⚠️ MIDI output not found: ${e}`),!1)}setMIDIChannel(e){e>=0&&e<=15&&(this.midiChannel=e,console.log(`✅ MIDI channel set to: ${e+1}`))}stopAllMIDINotes(){if(!(!this.midiEnabled||!this.selectedMidiOutput||this.activeMidiNotes.size===0))try{const e=this.activeMidiNotes.size;for(const t of this.activeMidiNotes){const[s,r]=t.split(":"),a=parseInt(s,10),i=parseInt(r,10);if(!isNaN(a)&&!isNaN(i))try{this.selectedMidiOutput.stopNote(a,{channel:i+1})}catch{}}this.activeMidiNotes.clear(),e>0&&console.log(`✅ Stopped ${e} active MIDI note(s)`)}catch(e){console.warn("⚠️ Error stopping MIDI notes:",e)}}async ensureMIDIFunctionsAvailable(){if(!this.midiEnabled)return;try{await nc()}catch(s){console.warn("⚠️ Unable to load Strudel modules for MIDI check:",s)}const e=typeof globalThis.note=="function"?(...s)=>globalThis.note(...s):null,t=()=>{if(!e)return!1;try{const s=e("c");return!!s&&typeof s.midi=="function"}catch{return!1}};t()||this.ensurePatternMidiMethodsRegistered("ensureMIDIFunctionsAvailable"),t()?console.log("✅ MIDI pattern modifiers are available"):(console.warn("⚠️ MIDI pattern modifiers (.midi(), .midiport()) are still unavailable"),console.warn("   Patterns using .midi() will fail until the modifiers are registered"),console.warn("   Please verify that WebMidi is enabled and try selecting a MIDI output again"))}async preloadPresetSamples(){var s;const e=((s=window.strudel)==null?void 0:s.samples)||globalThis.samples;if(!e||typeof e!="function"){console.warn("⚠️ samples() function not available for pre-loading preset samples");return}const t=["github:tidalcycles/dirt-samples","github:switchangel/pad","github:yaxu/clean-breaks/main","github:tidalcycles/uzu-drumkit","github:yaxu/mrid","github:Bubobubobubobubo/Dough-Amiga","github:Bubobubobubobubo/Dough-Fox","github:Bubobubobubobubo/Dough-Amen","github:Bubobubobubobubo/Dough-Juj","github:mot4i/garden","github:mot4i/loom","github:heavy-lifting/a-maze","github:eddyflux/crate","github:ibleedicare/strudel-bank","github:Prof12200/strudel_repo","github:creativenucleus/strudel-m8-168-dnb-jungle"];console.log("📦 Pre-loading samples from Sampler Effects presets...");for(const r of t)try{console.log(`   Loading: ${r}`),await e(r),console.log(`   ✅ Loaded: ${r}`),await new Promise(a=>setTimeout(a,200))}catch(a){console.warn(`   ⚠️ Failed to load ${r}:`,a.message)}console.log("✅ Finished pre-loading preset samples")}async ensurePatternResourcesLoaded(e){var c;if(!e||typeof e!="string"||typeof this.loadBank!="function")return;const t=this._sanitizePatternExpression(e)||e,s=new Set(["sine","square","triangle","sawtooth","supersaw","pulse","saw","saw2","saw3","saw4","saw8"]),r=new Set,a=/\.bank\(["']([^"']+)["']\)/g;let i;for(;(i=a.exec(t))!==null;)i[1]&&r.add(i[1]);const o=/\.s\(["']([^"']+)["']\)/g;for(;(i=o.exec(t))!==null;){const u=i[1];u&&(/\s|~|\[|\]|,/.test(u)||s.has(u.toLowerCase())||r.add(u))}const l=/\.sound\(["']([^"']+)["']\)/g;for(;(i=l.exec(t))!==null;){const u=i[1];u&&(s.has(u.toLowerCase())||r.add(u))}for(const u of r){if(this.loadedBanks.has(u)||!u)continue;const h=u.toLowerCase();if(s.has(h)){console.log(`⏭️ Skipping built-in oscillator synth "${u}" (no loading needed)`),this.loadedBanks.add(h),this.loadedBanks.add(u);continue}const d=(c=this.sampleNameToSpecialtyBank)==null?void 0:c.get(h);if(d){if(console.log(`⏭️ "${u}" is provided by specialty bank "${d}"`),!this.loadedBanks.has(d))try{await this.loadBank(d)}catch(y){console.warn(`⚠️ Could not ensure specialty bank "${d}" for "${u}":`,y)}this.loadedBanks.add(h),this.loadedBanks.add(u);continue}let m=h;if(um[h]&&(m=um[h],console.log(`🔄 Normalizing "${u}" to "${m}" for loading`)),this.loadedBanks.has(m)){console.log(`✅ Resource "${u}" already loaded as "${m}"`),this.loadedBanks.add(u);continue}try{console.log(`🎚️ ensurePatternResourcesLoaded: loading "${m}" for playback`),await this.loadBank(m)?(this.loadedBanks.add(m),this.loadedBanks.add(u),console.log(`✅ Resource "${m}" loaded`)):console.warn(`⚠️ Could not load resource "${m}" (continuing anyway)`)}catch(y){console.warn(`⚠️ Error loading resource "${m}" (continuing anyway):`,y.message||y)}}}stopSustainingTone(e){const t=this.activeSounds.get(e);if(t&&t.type==="sustaining"&&t.oscillator)try{const s=t.gain,r=this.audioContext.currentTime;s.gain.cancelScheduledValues(r),s.gain.setValueAtTime(s.gain.value,r),s.gain.linearRampToValueAtTime(0,r+.1),setTimeout(()=>{t.oscillator.stop(),this.activeSounds.delete(e)},100)}catch(s){console.error("Error stopping sustaining tone:",s),this.activeSounds.delete(e)}}saveElementToMaster(e,t,s,r,a={}){const{isPreview:i=!1}=a;try{console.log(`💾 Saving ${e} to master: pattern="${t==null?void 0:t.substring(0,50)}...", gain=${s}, pan=${r}`);const o=(t||"").replace(/[""]/g,'"').replace(/['']/g,"'"),l=this._sanitizePatternExpression(o),c=this.patternHasNoteNames(l),u=this.patternHasNumericNotePattern(l);let h=l;if(/\bnote\s*\(/i.test(o)){const m=/\bnote\s*\(\s*(["'])([^"']*)\1/gi;let y=!1;h=h.replace(m,(O,S,A)=>{const F=A.replace(/[<>\[\]\{\}\|,]/g," ").trim();return F&&!/[a-gA-G]/.test(F)&&/^[\d\s~\-\/]+$/.test(F)?(y=!0,`n(${S}${A}${S}`):O}),y&&console.log(`🔄 Converted note() with semitones to n() for ${e}`)}return this.trackedPatterns.set(e,{rawPattern:h,pattern:h,gain:s||.8,pan:r||0,muted:!1,soloed:!1}),this.audioContext&&this.getElementAudioNodes(e)&&console.log(`  🎚️ Created audio nodes for ${e}`),this.masterActive&&!i&&this.scheduleMasterPatternRefresh(`save:${e}`),console.log(`✅ Saved ${e} to master. Total tracks: ${this.trackedPatterns.size}`),{success:!0}}catch(o){return console.error(`❌ Error saving ${e} to master:`,o),{success:!1,error:o.message}}}async routePatternThroughMaster(e,t,{isPreview:s=!1,autoStart:r=!1}={}){if(!this.masterOnlyPlayback)return{success:!1,error:"Master-only playback is disabled"};const a=typeof t=="string"?t:"";if(!a.trim())return console.warn(`⚠️ Empty pattern for ${e}, removing from master`),this.removeElementFromMaster(e),this.masterActive&&await this.playMasterPattern(),{success:!1,error:"Pattern empty"};const o=this.getElementGain(e),l=this.getElementPan(e),c=this.saveElementToMaster(e,a,o,l,{isPreview:s});return c.success?(s?this.previewElementIds.add(e):this.previewElementIds.delete(e),this.updateMasterPattern(this.soloedElements,this.mutedElements),this.masterActive?(this.scheduleMasterPatternRefresh(`route:${e}${s?":preview":""}`),{success:!0,autoRefreshed:!0}):r?this.playMasterPattern():{success:!0,autoStarted:!1}):c}removeElementFromMaster(e){try{return this.previewElementIds.delete(e),this.trackedPatterns.has(e)&&(this.trackedPatterns.delete(e),console.log(`🗑️ Removed ${e} from master. Remaining tracks: ${this.trackedPatterns.size}`),this.updateMasterPattern(),this.masterOnlyPlayback&&(this.masterPattern&&this.masterPattern.trim()?this.masterActive&&this.playMasterPattern().catch(t=>console.warn("⚠️ Failed to refresh master after removal:",t)):this.masterActive&&this.stopMasterPattern().catch(t=>console.warn("⚠️ Failed to stop master after removal:",t)))),{success:!0}}catch(t){return console.error(`❌ Error removing ${e} from master:`,t),{success:!1,error:t.message}}}async updateTrackedElementGain(e,t){if(this.trackedPatterns.has(e)){const s=this.trackedPatterns.get(e);return s.gain=t,console.log(`🎚️ Updated ${e} gain in master: ${t.toFixed(2)}`),await this.updateMasterPattern(this.soloedElements,this.mutedElements),this.scheduleMasterPatternRefresh(`gain change: ${e}`),{success:!0}}return{success:!1,reason:"Element not tracked in master"}}async updateTrackedElementPan(e,t){if(this.trackedPatterns.has(e)){const s=this.trackedPatterns.get(e);return s.pan=t,console.log(`🎚️ Updated ${e} pan in master: ${t.toFixed(2)}`),await this.updateMasterPattern(this.soloedElements,this.mutedElements),this.scheduleMasterPatternRefresh(`pan change: ${e}`),{success:!0}}return{success:!1,reason:"Element not tracked in master"}}scheduleMasterPatternRefresh(e="unspecified"){this._pendingMasterPatternRefreshReason=e,!this._masterPatternRefreshTimer&&(this._masterPatternRefreshTimer=setTimeout(()=>{this._masterPatternRefreshTimer=null,this._performScheduledMasterPatternRefresh()},60))}async _performScheduledMasterPatternRefresh(){if(!this.masterPattern||this.masterPattern.trim()===""){this._pendingMasterPatternRefreshReason=null;return}if(!this.masterActive){console.log(`🔁 Master refresh skipped (not active). Pending reason: ${this._pendingMasterPatternRefreshReason||"unspecified"}`),this._pendingMasterPatternRefreshReason=null;return}const e=this._pendingMasterPatternRefreshReason||"unspecified";this._pendingMasterPatternRefreshReason=null,this._masterPatternEvalPromise=this._masterPatternEvalPromise.catch(()=>{}).then(()=>this._reEvaluateMasterPattern(e));try{await this._masterPatternEvalPromise}catch(t){console.warn(`⚠️ Master pattern refresh failed (${e}):`,t)}}formatMasterPatternWithTempoComment(e){if(!e||typeof e!="string"||e.trim()==="")return e;const t=this.currentTempo||this.defaultTempo||120,s="// Controls Selected Tempo:",a=e.split(`
`).filter(o=>!o.trim().startsWith(s)).join(`
`).trimEnd(),i=this._sanitizePatternExpression(a);return i!==a&&console.log("🧼 Sanitized master pattern when formatting tempo comment"),!this.tempoUserAdjusted&&t===(this.defaultTempo||120)?i:`${i}

${s} ${t} BPM`}async updateMasterPattern(e=new Set,t=new Set){var s,r,a,i;try{console.log(`🎛️ Updating master pattern. Tracks: ${this.trackedPatterns.size}, Solo: ${e.size}, Muted: ${t.size}`);const o=[],l=[],c=[],u=e.size>0,h=this.getScaleConversionContext();let d=0;for(const[y,O]of this.trackedPatterns.entries()){const S=t.has(y),A=e.has(y),F=this.extractChannelNumber(y,d);if(d+=1,S||u&&!A){console.log(`  ⏭️ Skipping ${y} (muted: ${S}, solo active but not soloed: ${u&&!A})`);continue}if(O.gain<=0){console.log(`  ⏭️ Skipping ${y} (gain is ${O.gain})`);continue}const j=O.pattern||O.rawPattern||"";let N=this._sanitizePatternExpression(j);if(N!==j&&(O.pattern=N,O.rawPattern=N),!N||N.trim()===""){console.log(`  ⏭️ Skipping ${y} (empty pattern)`);continue}if(N.includes("setDefaultVoicings")){const De=/setDefaultVoicings\s*\(\s*(['"]([^'"]*)['"]|([^)]+))\s*\)/g,Se=[];let ae;for(;(ae=De.exec(N))!==null;)Se.push({fullMatch:ae[0],arg:ae[2]||ae[3],isQuoted:!!ae[2]});for(const Ee of Se)try{const Qe=Ee.isQuoted?`setDefaultVoicings('${Ee.arg}')`:`setDefaultVoicings(${Ee.arg})`;window.strudel&&window.strudel.evaluate&&(await window.strudel.evaluate(Qe),console.log(`  ✅ Evaluated ${Qe} from ${y}`))}catch(Qe){console.warn(`  ⚠️ Could not evaluate setDefaultVoicings from ${y}:`,Qe.message)}Se.length>0&&(N=N.split(`
`).filter(Ke=>!Ke.trim().includes("setDefaultVoicings")).join(`
`).replace(/\n{3,}/g,`

`).trim(),O.pattern=N,O.rawPattern=N)}const $=this.patternHasNoteNames(N),L=this.patternHasNumericNotePattern(N);let I=N;$&&!L?(I=N,console.log(`  📝 Preserving note names format for ${y}: ${N.substring(0,50)}...`)):L&&!$?(I=N,console.log(`  📝 Preserving semitones format for ${y}: ${N.substring(0,50)}...`)):(I=N,console.log(`  📝 Preserving pattern format as-is for ${y}: ${N.substring(0,50)}...`)),O.pattern=I;let q=(I||"").trim();if(q=q.replace(/[""]/g,'"').replace(/['']/g,"'"),(()=>{const De=/\/\*\s*Channel\s+\d+\s*\*\//i.test(q),Se=/\bstack\s*\(/i.test(q);return!(De||Se)})())for(;q.startsWith("(")&&q.endsWith(")");){let De=0,Se=!0;for(let ae=0;ae<q.length;ae++)if(q[ae]==="("?De++:q[ae]===")"&&De--,De===0&&ae<q.length-1){Se=!1;break}if(Se&&De===0)q=q.slice(1,-1).trim();else break}if(q.startsWith("(")){let De=0,Se=-1;for(let ae=0;ae<q.length;ae++)if(q[ae]==="("&&De++,q[ae]===")"&&De--,De===0){Se=ae;break}Se===-1&&(q=q.substring(1),console.log("  🔧 Stripped unmatched opening paren from pattern"))}q=Sw(q),q=q.replace(/\.postgain\s*\([^)]*\)/gi,""),q=q.replace(/\.pan\s*\([^)]*\)/gi,""),q=q.replace(/\.\.+/g,"."),q=q.replace(/\s+\./g,"."),q=q.replace(/\.\s*$/,""),q=q.trim(),(s=this.appInstance)!=null&&s.getPatternWithMidi&&(q=this.appInstance.getPatternWithMidi(y,q)),q=`${q.trim()}.postgain(${O.gain.toFixed(2)})`,O.pan!==0&&(q=`${q}.pan(${O.pan.toFixed(2)})`);const he=((a=(r=this.appInstance)==null?void 0:r.loadElementConfig)==null?void 0:a.call(r,y))||{};let H=he.key||null,me=he.scale||null;if((!H||!me)&&q.includes(".scale(")){const De=q.match(/\.\s*scale\s*\(\s*['"]([^'"]+)['"]\s*\)/i);if(De&&De[1]){const Se=De[1];if(Se.includes(":")){const[ae,Ee]=Se.split(":");H=H||ae.trim(),me=me||Ee.trim(),console.log(`  🎼 Extracted scale from pattern: ${H}:${me}`)}else me=me||Se.trim(),H=H||"C",console.log(`  🎼 Extracted scale from pattern: ${H}:${me}`)}}const Oe=q.trim(),Pe=Oe.startsWith("(")&&Oe.endsWith(")");if(q=this.applyGlobalSettingsToPattern(q,Pe,!1,H,me),O.pan===0){let De=q.trim();(()=>{for(;De.startsWith("(")&&De.endsWith(")");){let ae=0,Ee=!0;for(let Qe=0;Qe<De.length;Qe++){const Ke=De[Qe];if(Ke==="("?ae++:Ke===")"&&ae--,ae===0&&Qe<De.length-1){Ee=!1;break}}if(!Ee||ae!==0)break;De=De.slice(1,-1).trim()}})(),q=De}o.push(q),c.push(F),l.push(`Channel ${F}`),console.log(`  ✅ Added ${y}: ${q.substring(0,100)}...`)}if(o.length===0)this.masterPattern="",this.masterPatternManualOverride=!1,console.log("🔇 No active patterns - master pattern cleared");else{if(this.masterPatternManualOverride&&this.masterPattern&&this.masterPattern.trim()!==""){console.log("📝 Using manual override pattern - skipping stack() wrapping and master mix modifiers");return}let O=`stack(
${o.map((L,I)=>`  /* Channel ${c[I]??I+1} */
  ${L}`).join(`,

`)}
)`;O=this.applyMasterMixModifiers(O,{wrapStack:!0}),this.masterPattern=O,this.masterPatternManualOverride=!1;let S=0,A=!1,F=null,j=!1;for(let L=0;L<this.masterPattern.length;L++){const I=this.masterPattern[L],q=this.masterPattern[L+1];if(!A&&I==="/"&&q==="/"){j=!0,L++;continue}if(j&&I===`
`){j=!1;continue}if(!j){if(!j&&(I==='"'||I==="'")){A?I===F&&this.masterPattern[L-1]!=="\\"&&(A=!1,F=null):(A=!0,F=I);continue}if(!A&&!j){if(I==="(")S++;else if(I===")"&&(S--,S<0)){console.error(`  ⚠️ UNBALANCED PARENTHESES! Extra closing paren at position ${L}`);break}}}}const N=(this.masterPattern.match(/\(/g)||[]).length,$=(this.masterPattern.match(/\)/g)||[]).length;if(console.log(`🎵 Master pattern (stack): ${this.masterPattern.substring(0,150)}...`),console.log(`  📊 Parentheses: ${N} open, ${$} close, depth=${S}, balanced: ${S===0}`),S!==0)if(console.error(`  ⚠️ UNBALANCED PARENTHESES! Depth=${S}, fixing...`),console.log(`  🧾 Master pattern before fix:
`,this.masterPattern),S>0)this.masterPattern+=")".repeat(S),console.log(`  ✅ Added ${S} closing paren(s)`);else{const L=Math.abs(S);let I=0;for(let q=this.masterPattern.length-1;q>=0&&I<L;q--)this.masterPattern[q]===")"&&(this.masterPattern=this.masterPattern.substring(0,q)+this.masterPattern.substring(q+1),I++);console.log(`  ✅ Removed ${I} extra closing paren(s)`)}}if(this.masterPattern&&((i=window.__patternHistory)!=null&&i.saveMasterVersion))try{window.__patternHistory.saveMasterVersion(this.masterPattern)}catch(y){console.warn("⚠️ Unable to record master history entry:",y)}const m=this.masterPattern;if(m&&m.trim()!==""){let y=this.convertPatternForScale(m)||m;this.masterPattern=this.formatMasterPatternWithTempoComment(y)}return console.log(`🎛️ Applied global settings to master pattern (Key: ${this.currentKey||"none"}, Scale: ${this.currentScale||(this.currentKey?"derived":"none")}, Time Sig: ${this.currentTimeSignature||"none"}, Volume: ${this.formatNumberForPattern(this.masterVolume,4)}, Pan: ${this.formatNumberForPattern(this.masterPan,4)}, Tempo: ${this.currentTempo||120} BPM)`),this.onMasterPatternUpdateCallback&&this.onMasterPatternUpdateCallback(),{success:!0,pattern:this.masterPattern}}catch(o){return console.error("❌ Error updating master pattern:",o),{success:!1,error:o.message}}}setupVisualizerAnalyser(){var s,r;if(!this.audioContext||!window.strudel)return;const e="master-punchcard-canvas",t=((s=window.strudel)==null?void 0:s.getAnalyserById)||globalThis.getAnalyserById;if(!t||typeof t!="function"){console.warn("⚠️ getAnalyserById not available - visualizers may not work");return}try{let a=null;try{a=t(e,2048,.8),a&&a.context!==this.audioContext&&(console.warn("⚠️ Analyser from getAnalyserById is in different audio context, creating new one"),a=null)}catch(i){console.warn("⚠️ Could not get analyser from getAnalyserById:",i.message)}if(!a){a=this.audioContext.createAnalyser(),a.fftSize=2048,a.smoothingTimeConstant=.8,a.__strudelVisualizerNode=!0;const i=t,o=a;window.strudel&&(window.strudel.analysers&&typeof window.strudel.analysers=="object"&&(window.strudel.analysers[e]=a,console.log(`✅ Stored analyser "${e}" in Strudel's analyser registry`)),window.strudel.getAnalyserById=function(l,c,u){return l===e?o:i(l,c,u)}),globalThis.getAnalyserById&&(globalThis.getAnalyserById=function(l,c,u){return l===e?o:i(l,c,u)}),globalThis.analysers||(globalThis.analysers={}),globalThis.analysers[e]=a,console.log(`✅ Created analyser "${e}" in our audio context and patched getAnalyserById`)}if(this.visualizerAnalyser=a,this.visualizerAnalyser&&(this.visualizerAnalyser.__strudelVisualizerNode=!0),this.masterGainNode&&a){const i=this._realDestination||((r=this.audioContext)==null?void 0:r.destination);if(!i)console.warn("⚠️ Cannot connect analyser - destination unavailable");else try{if(!this.visualizerAnalyserTapGain&&this.audioContext&&(this.visualizerAnalyserTapGain=this.audioContext.createGain(),this.visualizerAnalyserTapGain.gain.value=0,this.visualizerAnalyserTapGain.__strudelVisualizerNode=!0),this.visualizerAnalyserTapGain){try{this.visualizerAnalyserTapGain.disconnect()}catch{}this.visualizerAnalyserTapGain.connect(i)}try{a.disconnect()}catch{}try{this.masterGainNode.disconnect(a)}catch{}this.masterGainNode.connect(a),this.visualizerAnalyserTapGain&&a.connect(this.visualizerAnalyserTapGain),console.log(`✅ Connected visualizer analyser "${e}" with silent tap to destination`),setTimeout(()=>{try{const o=new Uint8Array(a.frequencyBinCount);a.getByteFrequencyData(o);const l=o.some(h=>h>0),c=Math.max(...o);console.log(`🔍 Analyser data check: hasData=${l}, maxValue=${c}, frequencyBinCount=${a.frequencyBinCount}`);const u=document.getElementById(e);u?console.log(`🔍 Canvas check: found canvas with ID "${e}", width=${u.width}, height=${u.height}`):console.warn(`⚠️ Canvas with ID "${e}" not found!`)}catch(o){console.warn("⚠️ Could not check analyser data:",o)}},500)}catch(o){console.warn(`⚠️ Failed to connect analyser "${e}":`,o.message)}}else console.warn(`⚠️ Cannot connect analyser - masterGainNode: ${!!this.masterGainNode}, analyser: ${!!a}`)}catch(a){console.warn("⚠️ Failed to setup visualizer analyser:",a)}}applyVisualizerTargetsToPattern(e){if(!e||typeof e!="string")return e;const s="master-punchcard-canvas",r="window.__strudelVisualizerCtx || (document.getElementById('master-punchcard-canvas') && document.getElementById('master-punchcard-canvas').getContext && document.getElementById('master-punchcard-canvas').getContext('2d'))",a=["spectrum","scope","tscope","fscope","visual","pianoroll","barchart"];let i=e;const o=new RegExp(`\\.\\s*_(${a.join("|")})\\s*\\(`,"gi");i=i.replace(o,(u,h)=>u.replace(`_${h}`,h));const l=["spectrum","scope","tscope","fscope"],c=["visual","barchart","pianoroll"];return l.forEach(u=>{const h=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=new RegExp(`\\.\\s*_?${h}\\s*\\(\\s*\\)`,"gi");i=i.replace(d,y=>y.replace(/\(\s*\)/,`({ id: '${s}' })`));const m=new RegExp(`\\.\\s*_?${h}\\s*\\(\\s*\\{([^}]*)\\}\\s*\\)`,"gi");i=i.replace(m,(y,O)=>{let S=O.trim();return/(^|,)\s*id\s*:/.test(S)||(S=S.length>0?`${S}, id: '${s}'`:`id: '${s}'`),y.replace(O,S)})}),c.forEach(u=>{const h=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=new RegExp(`\\.\\s*_?${h}\\s*\\(\\s*\\)`,"gi");i=i.replace(d,y=>y.replace(/\(\s*\)/,`({ id: '${s}', ctx: ${r} })`));const m=new RegExp(`\\.\\s*_?${h}\\s*\\(\\s*\\{([^}]*)\\}\\s*\\)`,"gi");i=i.replace(m,(y,O)=>{let S=O.trim();const A=/(^|,)\s*id\s*:/.test(S),F=/(^|,)\s*ctx\s*:/.test(S);return A||(S=S.length>0?`${S}, id: '${s}'`:`id: '${s}'`),F||(S=S.length>0?`${S}, ctx: ${r}`:`ctx: ${r}`),y.replace(O,S)})}),i!==e&&(console.log("🎨 Injected canvas ID into visualizer methods"),console.log(`   Before: ${e.substring(0,150)}...`),console.log(`   After: ${i.substring(0,150)}...`)),i}async _reEvaluateMasterPattern(e="manual"){var r;if(!this.masterPattern||this.masterPattern.trim()==="")return console.log("⚠️ No master pattern to re-evaluate"),{success:!1,error:"No pattern to re-evaluate"};if(!window.strudel||typeof window.strudel.evaluate!="function")return{success:!1,error:"Strudel evaluate unavailable"};if(window.strudel.scheduler&&!window.strudel.scheduler.started){console.log(`🔄 Scheduler stopped, restarting before re-evaluation (${e})...`);try{await window.strudel.scheduler.start(),console.log("✅ Scheduler restarted")}catch(a){console.warn("⚠️ Could not restart scheduler:",a.message)}}const t=this.masterSlot||"d0";try{await window.strudel.evaluate(`${t} = silence`),await new Promise(a=>setTimeout(a,10))}catch(a){console.warn("⚠️ Could not clean up old pattern:",a.message)}if(this.masterGainNode){const a=((r=this.audioContext)==null?void 0:r.currentTime)||0;this.masterGainNode.gain.setValueAtTime(this.masterVolume,a)}this._ensureMasterPatternSanitized();let s=this.masterPattern.trim();try{const a=/setDefaultVoicings\s*\(\s*(['"]([^'"]*)['"]|([^)]+))\s*\)/g,i=[];let o;for(;(o=a.exec(s))!==null;)i.push({fullMatch:o[0],arg:o[2]||o[3],isQuoted:!!o[2]});for(const h of i)try{const d=h.isQuoted?`setDefaultVoicings('${h.arg}')`:`setDefaultVoicings(${h.arg})`;await window.strudel.evaluate(d),console.log(`✅ Evaluated ${d} before pattern`)}catch(d){console.warn("⚠️ Could not evaluate setDefaultVoicings:",d.message)}if(i.length>0&&(s=s.split(`
`).filter(m=>!m.trim().includes("setDefaultVoicings")).join(`
`),s=s.replace(/\n\s*\n\s*\n+/g,`

`).trim(),s.startsWith("stack("))){let m=0,y=!1,O=null;for(let S=0;S<s.length;S++){const A=s[S];!y&&(A==='"'||A==="'")?(y=!0,O=A):y&&A===O&&s[S-1]!=="\\"&&(y=!1,O=null),y||(A==="("?m++:A===")"&&m--)}m!==0?(console.warn(`⚠️ Pattern structure may be broken after removing setDefaultVoicings (depth: ${m})`),console.log(`   Pattern preview: ${s.substring(0,200)}...`)):console.log("✅ Pattern structure validated after removing setDefaultVoicings")}if(this.masterPatternManualOverride){const{setupCode:h,finalExpression:d}=this._splitManualOverridePattern(s);if(h)try{await window.strudel.evaluate(h)}catch(m){console.warn("⚠️ Manual override setup code failed:",m.message)}if(d){const m=`${t} = ${d}`;console.log(`🔄 Re-evaluating manual override pattern (${e})...`),await window.strudel.evaluate(m);try{const y=await window.strudel.evaluate(t);y&&typeof y.queryArc=="function"&&(window.strudel.scheduler.pattern=y,console.log("✅ Set scheduler.pattern for manual override"))}catch(y){console.warn("⚠️ Could not set scheduler.pattern for manual override:",y.message)}if(window.strudel.scheduler&&!window.strudel.scheduler.started){console.log("🔄 Scheduler stopped after manual override, restarting...");try{await window.strudel.scheduler.start(),console.log("✅ Scheduler restarted after manual override")}catch(y){console.warn("⚠️ Could not restart scheduler after manual override:",y.message)}}return console.log(`✅ Manual override pattern re-evaluated (${e})`),{success:!0,slot:t}}else console.warn("⚠️ Manual override pattern missing final expression - falling back to multi-statement evaluation")}const l=s.split(`
`).filter(h=>h.trim()&&!h.trim().startsWith("//")),c=l.length>1&&s.match(/^[a-zA-Z_$][a-zA-Z0-9_$]*\s*:/m),u=s.trim().match(/^(stack|all)\s*\(/);if(c&&l.length>1&&!u){const h=l.slice(0,-1).join(`
`);if(h.trim())try{await window.strudel.evaluate(h)}catch(y){console.warn("⚠️ Could not evaluate setup statements:",y.message)}const d=l[l.length-1].trim(),m=`${t} = ${d}`;try{console.log(`🔄 Re-evaluating master pattern (${e}) with multi-statement support...`),await window.strudel.evaluate(m)}catch(y){console.warn("⚠️ Failed to evaluate as multi-statement, trying as single expression:",y.message);const O=`${t} = ${s}`;await window.strudel.evaluate(O)}}else{const h=`${t} = ${s}`;console.log(`🔄 Re-evaluating master pattern (${e})...`),await window.strudel.evaluate(h)}try{const h=await window.strudel.evaluate(t);if(h&&typeof h.queryArc=="function"){window.strudel.scheduler.pattern=h,console.log("✅ Set scheduler.pattern for highlighting (re-evaluation)");try{const d=h.queryArc(0,.1)||[];d.length>0&&(d.some(y=>{var O,S;return((S=(O=y==null?void 0:y.context)==null?void 0:O.locations)==null?void 0:S.length)>0})?console.log("✅ Pattern has location data - highlighting should work"):console.warn("⚠️ Pattern set on scheduler but haps have no location data. withLoc may not be working correctly."))}catch{}}}catch(h){console.warn("⚠️ Could not set scheduler.pattern for highlighting:",h.message)}if(window.strudel.scheduler&&!window.strudel.scheduler.started){console.log("🔄 Scheduler stopped after re-evaluation, restarting...");try{await window.strudel.scheduler.start(),console.log("✅ Scheduler restarted after re-evaluation")}catch(h){console.warn("⚠️ Could not restart scheduler after re-evaluation:",h.message)}}return console.log(`✅ Master pattern re-evaluated (${e})`),{success:!0,slot:t}}catch(a){return console.error("❌ Failed to re-evaluate master pattern:",a),{success:!1,error:a.message}}}async _playMasterPatternSimple(){var a,i,o,l,c,u,h,d,m;if(!this.masterPattern||this.masterPattern.trim()==="")return console.log("⚠️ No master pattern to play (master-only mode)"),this.masterActive?await this._stopMasterPatternSimple():this.masterActive=!1,{success:!1,error:"No pattern to play"};console.log("🔍 [PLAY-TIME CHECK] Searching for superdough output...");const e=(a=window.strudel)==null?void 0:a.scheduler;if(e){if(console.log("  scheduler.output type:",(o=(i=e.output)==null?void 0:i.constructor)==null?void 0:o.name),console.log("  scheduler.superdough:",!!e.superdough),console.log("  scheduler keys:",Object.keys(e).slice(0,20)),e.webaudio){if(console.log("  ✅ Found scheduler.webaudio!"),console.log("    webaudio type:",(c=(l=e.webaudio)==null?void 0:l.constructor)==null?void 0:c.name),console.log("    webaudio keys:",Object.keys(e.webaudio||{}).slice(0,20)),e.webaudio.node&&this.masterPanNode){console.log("  🎯 Found scheduler.webaudio.node (the REAL output!)");try{e.webaudio.node.disconnect(),e.webaudio.node.connect(this.masterPanNode),console.log("✅ [PLAY-TIME CHECK] Connected scheduler.webaudio.node to masterPanNode - THIS IS THE KEY!")}catch(y){console.warn("⚠️ [PLAY-TIME CHECK] Could not connect scheduler.webaudio.node:",y)}}}else if(console.log("  ⚠️ scheduler.webaudio does NOT exist!"),console.log("  🔍 Checking if scheduler.output is connected to anything..."),e.output&&e.output!==this.masterPanNode)try{console.log("  🔧 Attempting to connect scheduler.output to masterPanNode..."),e.output.disconnect(),e.output.connect(this.masterPanNode),console.log("  ✅ Connected scheduler.output to masterPanNode!")}catch(y){console.warn("  ⚠️ Could not connect scheduler.output:",y)}else console.log("  ℹ️ scheduler.output is already masterPanNode or does not exist");if((u=e.superdough)!=null&&u.output&&this.masterPanNode){console.log("  ✅ Found scheduler.superdough.output");try{e.superdough.output.disconnect(),e.superdough.output.connect(this.masterPanNode),console.log("✅ [PLAY-TIME CHECK] Connected scheduler.superdough.output to masterPanNode")}catch(y){console.warn("⚠️ [PLAY-TIME CHECK] Could not connect scheduler.superdough.output:",y)}}else e.webaudio||console.log("  ℹ️ No scheduler.superdough.output or scheduler.webaudio found")}else console.log("  ⚠️ No scheduler found at window.strudel.scheduler");if(await this.initialize(),this.strudelLoaded||await this.initializeStrudelAndSounds(),this.masterGainNode){const y=((h=this.audioContext)==null?void 0:h.currentTime)||0;this.masterGainNode.gain.setValueAtTime(this.masterVolume,y)}if(this.masterPanNode&&this.masterPanNode.pan.setValueAtTime(this.masterPan,((d=this.audioContext)==null?void 0:d.currentTime)||0),!window.strudel||typeof window.strudel.evaluate!="function")return{success:!1,error:"Strudel evaluate unavailable"};this._ensureMasterPatternSanitized();const t=this.masterSlot||"d0",s=this.masterPattern.trim(),r=this.masterPatternManualOverride;try{if(r){const{setupCode:y,finalExpression:O}=this._splitManualOverridePattern(s);if(y)try{await window.strudel.evaluate(y)}catch(S){console.warn("⚠️ Manual override setup code failed:",S)}O?await window.strudel.evaluate(`${t} = ${O}`):(console.warn("⚠️ Manual override missing final expression, falling back to default evaluation"),await window.strudel.evaluate(`${t} = ${s}`))}else{const{setupStatements:y,patternExpression:O}=this.parseMultiStatementPattern(s);for(const A of y)try{await window.strudel.evaluate(A)}catch(F){console.warn(`⚠️ Setup statement evaluation warning: ${F.message}`)}const S=O||s;await window.strudel.evaluate(`${t} = ${S}`)}if(window.strudel.scheduler){window.strudel.scheduler.started||await window.strudel.scheduler.start();try{const y=await window.strudel.evaluate(t);if(y&&typeof y.queryArc=="function"){window.strudel.scheduler.pattern=y,console.log("✅ Set scheduler.pattern for highlighting");try{const O=y.queryArc(0,.1)||[];O.length>0&&(O.some(A=>{var F,j;return((j=(F=A==null?void 0:A.context)==null?void 0:F.locations)==null?void 0:j.length)>0})?console.log("✅ Pattern has location data - highlighting should work"):console.warn("⚠️ Pattern set on scheduler but haps have no location data. withLoc may not be working correctly."))}catch{}}}catch(y){console.warn("⚠️ Could not set scheduler.pattern for highlighting:",y.message)}}else console.warn("⚠️ Strudel scheduler missing - cannot ensure playback");return this.masterActive=!0,this.masterPlaybackStartTime=((m=this.audioContext)==null?void 0:m.currentTime)||performance.now(),this.onMasterStateChangeCallback&&this.onMasterStateChangeCallback(!0,Array.from(this.trackedPatterns.keys())),this.editorHighlightingEnabled&&Ow(),{success:!0,slot:t}}catch(y){return console.error("❌ Failed to evaluate master pattern:",y),{success:!1,error:y.message}}}parseMultiStatementPattern(e){if(!e||typeof e!="string")return{setupStatements:[],patternExpression:e||""};const t=[];let s="",r=!1,a="",i=0,o=0,l=0;for(let d=0;d<e.length;d++){const m=e[d],y=d>0?e[d-1]:"";if((m==='"'||m==="'"||m==="`")&&y!=="\\"&&(r?m===a&&(r=!1,a=""):(r=!0,a=m)),r||(m==="("?i++:m===")"?i--:m==="{"?o++:m==="}"?o--:m==="["?l++:m==="]"&&l--),!r&&i===0&&o===0&&l===0&&(m===`
`||m===";")){s.trim()&&t.push(s.trim()),s="";continue}s+=m}s.trim()&&t.push(s.trim());const c=[];let u="";const h=[/^\s*samples\s*\(/i,/^\s*setcps\s*\(/i,/^\s*setcpm\s*\(/i,/^\s*setbpm\s*\(/i,/^\s*(let|const|var)\s+\w+/i,/^\s*await\s+samples\s*\(/i];for(let d=0;d<t.length;d++){const m=t[d];if(!m||m.startsWith("//")||m.startsWith("/*"))continue;h.some(O=>O.test(m))?c.push(m):!u||d===t.length-1?u=m:u=u?`${u}
${m}`:m}return!u&&t.length>0&&(u=t[t.length-1]),t.length===1&&c.length===0&&(u=t[0]),{setupStatements:c,patternExpression:u}}async playMasterPattern(){var e,t,s,r,a,i,o,l,c,u,h,d,m,y,O,S,A,F,j,N,$,L,I,q,ce,ee,he,H,me,Oe,Pe,De,Se,ae,Ee,Qe,Ke,ge,Ye,yt,Xe,Ge,Ct,Et,gn,On,qn,cn,un,Rt,Kt,Un,Wn,bn,rt,Pn,pt,Vt,Zt,_n,it,Ft,_e,Lt,et;if(this.masterOnlyPlayback)return this._playMasterPatternSimple();try{console.log("▶️ Playing master pattern..."),console.log("🔍 [PLAY-TIME CHECK] Searching for superdough output...");const is=(e=window.strudel)==null?void 0:e.scheduler;if(is)if(console.log("  scheduler.output type:",(s=(t=is.output)==null?void 0:t.constructor)==null?void 0:s.name),console.log("  scheduler.superdough:",!!is.superdough),console.log("  scheduler keys:",Object.keys(is).slice(0,20)),(r=is.superdough)!=null&&r.output&&this.masterPanNode){console.log("  ✅ Found scheduler.superdough.output");try{is.superdough.output.disconnect(),is.superdough.output.connect(this.masterPanNode),console.log("✅ [PLAY-TIME CHECK] Connected scheduler.superdough.output to masterPanNode")}catch(It){console.warn("⚠️ [PLAY-TIME CHECK] Could not connect scheduler.superdough.output:",It)}}else console.log("  ℹ️ scheduler.superdough.output not found - scheduler.output should already be connected");else console.log("  ⚠️ No scheduler found at window.strudel.scheduler");if(this.masterActive=!0,console.log("🎚️ masterActive set to TRUE before pattern evaluation"),console.log("🔍 PRE-PLAY: Verifying audio routing hijacking is active..."),console.log("   AudioNode.prototype.__originalConnect exists:",!!AudioNode.prototype.__originalConnect),console.log("   AudioNode.prototype.connect is patched:",AudioNode.prototype.connect!==AudioNode.prototype.__originalConnect),console.log("   masterActive:",this.masterActive),console.log("   trackedPatterns.size:",this.trackedPatterns.size),console.log("   masterPanNode exists:",!!this.masterPanNode),console.log("   masterGainNode exists:",!!this.masterGainNode),this.masterGainNode&&this.masterGainNode.gain.setValueAtTime(this.masterVolume,((a=this.audioContext)==null?void 0:a.currentTime)||0),(!this.audioContext||this.audioContext.state==="suspended")&&await this.initialize(),this.strudelLoaded||(console.log("⏳ Waiting for Strudel to initialize..."),await this.initializeStrudelAndSounds()),this._ensureMasterPatternSanitized(),this.setupVisualizerAnalyser(),!this.masterPattern||this.masterPattern.trim()==="")return console.log("⚠️ No master pattern to play"),this.masterActive=!1,{success:!1,error:"No pattern to play"};if(this.audioContext)if(this.audioContext.state!=="running"){console.log(`🔊 Audio context state: ${this.audioContext.state}, resuming...`);try{await this.audioContext.resume();let It=0;for(;this.audioContext.state!=="running"&&It<10;)await new Promise(Dn=>setTimeout(Dn,50)),It++;this.audioContext.state==="running"?console.log(`✅ Audio context resumed successfully, state: ${this.audioContext.state}`):console.warn(`⚠️ Audio context not running after resume, state: ${this.audioContext.state}`)}catch(It){console.warn("⚠️ Could not resume audio context:",It)}}else console.log("✅ Audio context already running");else return console.error("❌ Audio context does not exist"),{success:!1,error:"Audio context not initialized"};if(window.strudel&&window.strudel.evaluate){let It=this.masterPattern.trim();if(!It||It==="")return console.error("❌ Master pattern is empty, cannot evaluate"),{success:!1,error:"Master pattern is empty"};console.log("🎼 Master pattern before processing:",It.substring(0,200)),It=Sw(It),It=this.applyVisualizerTargetsToPattern(It),console.log("🎼 Master pattern after visualizer injection:",It.substring(0,200)),await this.ensureStrudelWorkletsReady(It);const Dn=It.match(/\.bank\(["']([^"']+)["']\)/g);if(Dn&&typeof this.loadBank=="function"){const Y=[...new Set(Dn.map(se=>{const te=se.match(/\.bank\(["']([^"']+)["']\)/);return te?te[1]:null}).filter(Boolean))];for(const se of Y)if(!this.loadedBanks.has(se))try{console.log(`🎚️ Master: ensuring bank "${se}" is loaded before playback`),await this.loadBank(se)?(this.loadedBanks.add(se),console.log(`✅ Master: bank "${se}" loaded`)):console.warn(`⚠️ Master: bank "${se}" could not be loaded (continuing anyway)`)}catch(te){console.warn(`⚠️ Master: error loading bank "${se}":`,te)}}await this.ensurePatternResourcesLoaded(It),It=It.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\n\s*\n/g,`
`).trim();const Cs=It;It=It.replace(/[""]/g,'"').replace(/['']/g,"'"),Cs!==It&&(console.log("🔧 Normalized quotes in master pattern"),console.log(`  Before: ${Cs.substring(0,100)}...`),console.log(`  After:  ${It.substring(0,100)}...`)),!It.includes(".loop(")&&!It.includes(".loop()")&&(It=`${It}.loop()`,console.log("🔄 Added .loop() to master pattern for continuous playback")),this.masterActive=!0,console.log("🎚️ masterActive set to TRUE before pattern evaluation"),this._masterDestinationConnectLogged=!1,this._singleElementMasterRoutingLogged=!1,this._noElementRoutingLogged=!1,this._nodeTypeConnectLogged=new Set,this._stackMasterRoutingLogged=!1,this._masterRoutingLogged=!1,this._panNodeConnectedToMaster=new Set,this._gainConnectDebugged=!1,this._stackElementRoutingLogged=new Set,this._chainVerificationLogged=new Set,this._connectionSuccessLogged=new Set,this._allConnectionsLogged=new Set,this._allDestConnectionsLogged=new Set,this._panNodeConnectedLogged=new Set,this._panNodeNotConnectedLogged=new Set,this._panNodeConnectionErrorLogged=new Set,this._masterGainDestVerifiedAfterRouting=new Set,this._masterGainDestVerified=!1,this._stackConnectionCount&&this._stackConnectionCount.set("total",0);const Wt=this.masterSlot;this.currentEvaluatingSlot=Wt,console.log(`🎚️ Master stack evaluation slot: ${Wt}`),console.log(`🔧 Ensuring audio nodes exist for ${this.trackedPatterns.size} tracked elements...`);for(const[Y]of this.trackedPatterns.entries()){const se=this.getElementAudioNodes(Y);if(se){const te=this.elementGainValues.get(Y)||.8;se.gainNode.gain.value=te*this.volume;let be=[];be.push(`gainNode: gain=${se.gainNode.gain.value.toFixed(3)}`),be.push(`panNode: pan=${se.panNode.pan.value.toFixed(3)}`),console.log(`  ✅ ${Y}: ${be.join(", ")}`)}else console.warn(`  ⚠️ ${Y}: Failed to create audio nodes`)}if(this.visualizerAnalyser&&this.masterGainNode){try{this.masterGainNode.disconnect(this.visualizerAnalyser)}catch{}try{this.masterGainNode.connect(this.visualizerAnalyser),console.log("✅ Reconnected visualizer analyser to master gain node")}catch(Y){console.warn("⚠️ Could not reconnect visualizer analyser:",Y)}}if(window.strudel&&window.strudel.scheduler){if(window.strudel.scheduler.started)console.log("✅ Strudel scheduler already started");else{console.log("▶️ Starting Strudel scheduler BEFORE pattern evaluation...");try{await window.strudel.scheduler.start(),window.strudel.scheduler.started?console.log("✅ Strudel scheduler started successfully"):(console.error("❌ Strudel scheduler start() returned but scheduler.started is still false"),await window.strudel.scheduler.start(),window.strudel.scheduler.started?console.log("✅ Strudel scheduler started on retry"):console.error("❌ Strudel scheduler failed to start after retry"))}catch(te){console.error("❌ Failed to start scheduler:",te);try{await window.strudel.scheduler.start(),console.log("✅ Strudel scheduler started on second attempt")}catch(be){console.error("❌ Failed to start scheduler on retry:",be)}}}const Y=window.strudel.scheduler;console.log("🔍 POST-START: Checking scheduler for webaudio output..."),console.log(`   scheduler keys: ${Object.keys(Y).slice(0,15).join(", ")}`);let se=Y.webaudio||Y._webaudio;if(!se&&window.strudel.webaudio&&(se=window.strudel.webaudio,console.log("   ✅ Found webaudio in window.strudel.webaudio")),se){console.log(`   ✅ Found webaudio, keys: ${Object.keys(se).slice(0,10).join(", ")}`);const te=se.output||se.outputNode;if(te){if(console.log(`   ✅ Found output node: ${te.constructor.name}`),this.trackedPatterns.size>0){const be=Array.from(this.trackedPatterns.keys())[0],$e=this.getElementAudioNodes(be);if($e!=null&&$e.gainNode)try{te.disconnect(),te.connect($e.gainNode),console.log(`   ✅ Routed webaudio output to ${be} gainNode`)}catch(Re){console.log(`   ✅ webaudio output already routed (${Re.message})`)}}else if(this.masterPanNode)try{te.disconnect(),te.connect(this.masterPanNode),console.log("   ✅ Routed webaudio output to masterPanNode (fallback)")}catch(be){console.log(`   ✅ webaudio output already routed to master (${be.message})`)}}else console.log("   ⚠️ webaudio found but no output node")}else console.log("   ⚠️ No webaudio found in scheduler or window.strudel");if(Y.superdough){const te=Y.superdough;console.log(`   ✅ Found superdough, keys: ${Object.keys(te).slice(0,20).join(", ")}`),te.audioContext&&(console.log(`   🔍 superdough.audioContext: ${te.audioContext===this.audioContext?"OUR CONTEXT ✅":"DIFFERENT CONTEXT ⚠️"}`),console.log(`   🔍 superdough.audioContext.state: ${te.audioContext.state}`));const be=["output","outputNode","_output","destination","_destination","gain","masterGain"];for(const $e of be)if(te[$e]&&te[$e]instanceof AudioNode){if(console.log(`   ✅ Found AudioNode at superdough.${$e}: ${te[$e].constructor.name}`),this.trackedPatterns.size>0){const Re=Array.from(this.trackedPatterns.keys())[0],ut=this.getElementAudioNodes(Re);if(ut!=null&&ut.gainNode)try{te[$e].disconnect(),te[$e].connect(ut.gainNode),console.log(`   ✅ Routed superdough.${$e} to ${Re} gainNode`)}catch(on){console.log(`   ✅ superdough.${$e} already routed (${on.message})`)}}else if(this.masterPanNode)try{te[$e].disconnect(),te[$e].connect(this.masterPanNode),console.log(`   ✅ Routed superdough.${$e} to masterPanNode`)}catch(Re){console.log(`   ✅ superdough.${$e} already routed to master (${Re.message})`)}}}}else if(window.strudel&&window.strudel.scheduler&&window.strudel.scheduler.started){console.log("✅ Strudel scheduler already running");const Y=window.strudel.scheduler;console.log("🔍 ALREADY-RUNNING: Checking scheduler for webaudio output..."),console.log(`   scheduler keys: ${Object.keys(Y).slice(0,15).join(", ")}`);const se=Y.webaudio||Y._webaudio;if(se){console.log(`   ✅ Found webaudio, keys: ${Object.keys(se).slice(0,10).join(", ")}`);const te=se.output||se.outputNode;if(te){if(console.log(`   ✅ Found output node: ${te.constructor.name}`),this.trackedPatterns.size>0){const be=Array.from(this.trackedPatterns.keys())[0],$e=this.getElementAudioNodes(be);if($e!=null&&$e.gainNode)try{te.disconnect(),te.connect($e.gainNode),console.log(`   ✅ Routed webaudio output to ${be} gainNode`)}catch(Re){console.log(`   ✅ webaudio output already routed (${Re.message})`)}}else if(this.masterPanNode)try{te.disconnect(),te.connect(this.masterPanNode),console.log("   ✅ Routed webaudio output to masterPanNode (fallback)")}catch(be){console.log(`   ✅ webaudio output already routed to master (${be.message})`)}}else console.log("   ⚠️ webaudio found but no output node")}else console.log("   ⚠️ No webaudio found in scheduler");if(Y.superdough){const te=Y.superdough;console.log(`   ✅ Found superdough, keys: ${Object.keys(te).slice(0,20).join(", ")}`),te.audioContext&&(console.log(`   🔍 superdough.audioContext: ${te.audioContext===this.audioContext?"OUR CONTEXT ✅":"DIFFERENT CONTEXT ⚠️"}`),console.log(`   🔍 superdough.audioContext.state: ${te.audioContext.state}`));const be=["output","outputNode","_output","destination","_destination","gain","masterGain"];for(const $e of be)if(te[$e]&&te[$e]instanceof AudioNode){if(console.log(`   ✅ Found AudioNode at superdough.${$e}: ${te[$e].constructor.name}`),this.trackedPatterns.size>0){const Re=Array.from(this.trackedPatterns.keys())[0],ut=this.getElementAudioNodes(Re);if(ut!=null&&ut.gainNode)try{te[$e].disconnect(),te[$e].connect(ut.gainNode),console.log(`   ✅ Routed superdough.${$e} to ${Re} gainNode`)}catch(on){console.log(`   ✅ superdough.${$e} already routed (${on.message})`)}}else if(this.masterPanNode)try{te[$e].disconnect(),te[$e].connect(this.masterPanNode),console.log(`   ✅ Routed superdough.${$e} to masterPanNode`)}catch(Re){console.log(`   ✅ superdough.${$e} already routed to master (${Re.message})`)}}}else console.log("   ⚠️ No superdough found in scheduler")}else return console.error("❌ Strudel scheduler not available"),{success:!1,error:"Strudel scheduler not available"};const{setupStatements:Pt,patternExpression:$t}=this.parseMultiStatementPattern(It);Pt.length>0&&(console.log("🎼 Multi-statement pattern detected:"),console.log(`   Setup statements (${Pt.length}): ${Pt.map(Y=>Y.substring(0,40)+"...").join(", ")}`),console.log(`   Pattern expression: ${$t.substring(0,100)}...`));for(const Y of Pt)try{console.log(`   ⚙️ Evaluating setup: ${Y.substring(0,60)}...`),await window.strudel.evaluate(Y)}catch(se){console.warn(`   ⚠️ Setup statement evaluation warning: ${se.message}`)}const st=`${Wt} = ${$t||It}`;console.log("🎼 Evaluating master pattern:"),console.log(`   Full code: ${st}`),console.log(`   Code length: ${st.length} characters`),console.log(`   Evaluation slot: ${Wt}`);const Gt=((i=window.strudel)==null?void 0:i.repl)||window.strudel;if((o=Gt==null?void 0:Gt.scheduler)!=null&&o.superdough){const Y=Gt.scheduler.superdough;if(Y.audioWorkletsLoaded===!1||Y.audioWorkletsLoaded===void 0){console.log("⏳ Waiting for AudioWorklets to load...");let se=0;for(;(Y.audioWorkletsLoaded===!1||Y.audioWorkletsLoaded===void 0)&&se<50;)await new Promise(te=>setTimeout(te,100)),se++;Y.audioWorkletsLoaded===!0?console.log(`✅ AudioWorklets loaded after ${se*100}ms`):console.warn(`⚠️ AudioWorklets may not be loaded after ${se*100}ms - proceeding anyway`)}else console.log("✅ AudioWorklets already loaded")}const an=/\.scope\s*\(/.test(st),vs=/\.spectrum\s*\(/.test(st),Vn=/\.spiral\s*\(/.test(st),Hs=/\._?pianoroll\s*\(/.test(st),Ys=/\._?barchart\s*\(/.test(st);if(an||vs||Vn||Hs||Ys){console.log(`   📊 Visualizer methods detected: scope=${an}, spectrum=${vs}, spiral=${Vn}, pianoroll=${Hs}, barchart=${Ys}`);const Y=/master-punchcard-canvas/.test(st);console.log(`   🎯 Canvas ID present in pattern: ${Y}`);const se=st.match(/\.scope\([^)]*\)/),te=st.match(/\.spectrum\([^)]*\)/),be=st.match(/\.spiral\([^)]*\)/),$e=st.match(/\._?pianoroll\([^)]*\)/),Re=st.match(/\._?barchart\([^)]*\)/);se&&console.log(`   📊 Scope call: ${se[0]}`),te&&console.log(`   📊 Spectrum call: ${te[0]}`),be&&console.log(`   📊 Spiral call: ${be[0]}`),$e&&console.log(`   📊 Pianoroll call: ${$e[0]}`),Re&&console.log(`   📊 Barchart call: ${Re[0]}`)}let w;try{if(w=await window.strudel.evaluate(st),console.log(`✅ Master pattern evaluated successfully, result type: ${typeof w}`),this.audioContext&&this.audioContext.state!=="running"){console.warn(`⚠️ Audio context not running after evaluation (${this.audioContext.state}), resuming...`);try{await this.audioContext.resume(),await new Promise(Y=>setTimeout(Y,50)),this.audioContext.state==="running"?console.log("✅ Audio context resumed after evaluation"):console.error(`❌ Audio context still not running: ${this.audioContext.state}`)}catch(Y){console.error("❌ Failed to resume audio context after evaluation:",Y)}}if(window.strudel&&window.strudel.scheduler)if(window.strudel.scheduler.started)console.log("✅ Scheduler is running");else{console.warn("⚠️ Scheduler not started after evaluation, starting...");try{await window.strudel.scheduler.start(),console.log("✅ Scheduler started after evaluation")}catch(Y){console.error("❌ Failed to start scheduler:",Y)}}}catch(Y){console.warn("⚠️ Pattern evaluation warning:",Y.message),console.warn(`⚠️ Pattern code that failed: ${st.substring(0,300)}`)}try{const Y=(l=window.strudel)==null?void 0:l.scheduler,se=globalThis==null?void 0:globalThis[Wt];if(Y&&se){console.log("🔍 PRE-PATTERN-SET: Checking scheduler state..."),console.log(`   scheduler.started: ${Y.started}`),console.log(`   scheduler.pattern: ${Y.pattern?"exists":"null"}`),console.log(`   scheduler keys before: ${Object.keys(Y).slice(0,15).join(", ")}`);const te=["webaudio","_webaudio","superdough","_superdough","output","outputNode","audioContext"];for(const be of te)Y[be]&&(console.log(`   ✅ Found ${be} in scheduler: ${typeof Y[be]}`),Y[be]instanceof AudioNode&&console.log(`      → AudioNode: ${Y[be].constructor.name}`));try{if(Y.pattern=se,console.log(`🎚️ Scheduler pattern set directly to ${Wt}`),!Y.started){console.warn("⚠️ Scheduler not started after setting pattern, starting...");try{await Y.start(),console.log("✅ Scheduler started after pattern set")}catch(be){console.error("❌ Failed to start scheduler after pattern set:",be)}}if(this.audioContext&&this.audioContext.state!=="running"){console.warn(`⚠️ Audio context not running after pattern set (${this.audioContext.state}), resuming...`);try{await this.audioContext.resume(),await new Promise(be=>setTimeout(be,50)),this.audioContext.state==="running"?console.log("✅ Audio context resumed after pattern set"):console.error(`❌ Audio context still not running: ${this.audioContext.state}`)}catch(be){console.error("❌ Failed to resume audio context:",be)}}console.log("🔍 POST-PATTERN-SET: Checking scheduler state after pattern assignment..."),console.log(`   scheduler.pattern: ${Y.pattern?"exists":"null"}`),console.log(`   scheduler.started: ${Y.started}`),console.log(`   audioContext.state: ${((c=this.audioContext)==null?void 0:c.state)||"N/A"}`),await new Promise(be=>setTimeout(be,100));for(const be of te)if(Y[be]&&!Y[`_checked_${be}`]){if(console.log(`   ✅ Found ${be} after pattern set: ${typeof Y[be]}`),Y[be]instanceof AudioNode&&(console.log(`      → AudioNode: ${Y[be].constructor.name}`),this.trackedPatterns.size>0)){const $e=Array.from(this.trackedPatterns.keys())[0],Re=this.getElementAudioNodes($e);if(Re!=null&&Re.gainNode)try{Y[be].disconnect(),Y[be].connect(Re.gainNode),console.log(`      ✅ Routed scheduler.${be} to ${$e} gainNode`)}catch(ut){console.log(`      ✅ scheduler.${be} already routed (${ut.message})`)}}Y[`_checked_${be}`]=!0}}catch{await window.strudel.evaluate(`pattern = ${Wt}`),console.log(`🎚️ Scheduler pattern set via REPL to ${Wt}`)}}else console.log("ℹ️ Could not set scheduler pattern directly (scheduler/slot missing)")}catch(Y){console.warn(`⚠️ Failed to set scheduler pattern to ${Wt}:`,(Y==null?void 0:Y.message)||Y)}console.log(`🔍 POST-EVALUATION: trackedPatterns.size=${this.trackedPatterns.size}`),console.log("🔍 POST-EVALUATION: Searching for audio nodes connected to destination...");try{if(this._realDestination&&this._realDestination._inputs){const Y=this._realDestination._inputs;console.log(`   Found ${Y.length} input(s) to destination`);for(let se=0;se<Y.length;se++){const te=Y[se];if(te&&te._node){const be=te._node;if(console.log(`   Input ${se}: ${be.constructor.name}`),this.trackedPatterns.size>0){const $e=Array.from(this.trackedPatterns.keys())[0],Re=this.getElementAudioNodes($e);if(Re!=null&&Re.gainNode)try{be.disconnect(this._realDestination),be.connect(Re.gainNode),console.log(`   ✅ Rerouted ${be.constructor.name} through ${$e} gainNode`)}catch(ut){console.log(`   ⚠️ Could not reroute ${be.constructor.name}: ${ut.message}`)}}}}}else console.log("   ⚠️ Cannot access destination inputs (might be browser-specific)")}catch(Y){console.log(`   ⚠️ Error checking destination inputs: ${Y.message}`)}if(console.log(`🔍 POST-EVALUATION: Audio context state=${((u=this.audioContext)==null?void 0:u.state)||"unknown"}`),console.log(`🔍 POST-EVALUATION: masterGainNode.gain=${((m=(d=(h=this.masterGainNode)==null?void 0:h.gain)==null?void 0:d.value)==null?void 0:m.toFixed(3))||"N/A"}, muted=${this.masterMuted}`),console.log(`🔍 POST-EVALUATION: masterVolume=${this.masterVolume}, volume=${this.volume}`),this.trackedPatterns.size>=1){const Y=Array.from(this.trackedPatterns.keys());console.log(`🔍 POST-EVALUATION: elementIds=${Y.join(", ")}`);for(const se of Y){const te=this.elementGainValues.get(se)||.8,be=this.getElementAudioNodes(se),$e=((O=(y=be==null?void 0:be.gainNode)==null?void 0:y.gain)==null?void 0:O.value)||0;console.log(`🔍 POST-EVALUATION: ${se} - storedGain=${te.toFixed(3)}, actualGain=${$e.toFixed(3)}, volume=${this.volume.toFixed(3)}, totalGain=${($e*((A=(S=this.masterGainNode)==null?void 0:S.gain)==null?void 0:A.value)||0).toFixed(3)}`)}try{const se=((F=window.strudel)==null?void 0:F.repl)||window.strudel;if(se!=null&&se.scheduler){const te=se.scheduler;console.log("🔍 POST-EVALUATION: Exploring scheduler object..."),console.log(`   scheduler keys: ${Object.keys(te).slice(0,20).join(", ")}`);let be=te.webaudio||te._webaudio,$e=null;if(be)$e=be.output||be.outputNode,console.log(`🔍 POST-EVALUATION: Found webaudio, outputNode=${$e?$e.constructor.name:"null"}`);else{console.log("🔍 POST-EVALUATION: webaudio not found, searching scheduler for output node...");for(const Re of Object.keys(te)){const ut=te[Re];if(ut&&typeof ut=="object"){if(ut.output&&ut.output instanceof AudioNode){console.log(`🔍 POST-EVALUATION: Found output node in scheduler.${Re}.output`),$e=ut.output;break}if(ut.outputNode&&ut.outputNode instanceof AudioNode){console.log(`🔍 POST-EVALUATION: Found output node in scheduler.${Re}.outputNode`),$e=ut.outputNode;break}}}}console.log(`🎚️ 🔍 POST-EVALUATION: Final outputNode=${$e?$e.constructor.name:"null"}`);for(const Re of Y){const ut=this.getElementAudioNodes(Re);if(console.log(`🎚️ 🔍 POST-EVALUATION: ${Re}: elementNodes=${!!ut}, gainNode=${!!(ut!=null&&ut.gainNode)}`),ut&&ut.gainNode){if($e)try{$e.disconnect(),$e.connect(ut.gainNode),console.log(`🎚️ ✅ POST-EVALUATION: Reconnected Strudel output -> ${Re} gainNode`)}catch(Yn){console.warn(`⚠️ POST-EVALUATION: Could not reconnect Strudel output: ${Yn.message}`)}else console.warn("⚠️ POST-EVALUATION: Output node not found - audio may not route through element chain");const on=ut.panNode;if(on&&this.masterPanNode)try{try{on.disconnect(this.masterPanNode)}catch{}on.connect(this.masterPanNode),console.log(`🎚️ ✅ POST-EVALUATION: Verified ${Re} panNode -> masterPanNode`)}catch(Yn){console.warn(`⚠️ POST-EVALUATION: Could not verify panNode: ${Yn.message}`)}}}if(this.masterGainNode&&this._realDestination)try{this.masterGainNode.connect(this._realDestination),console.log(`🎚️ ✅ POST-EVALUATION: Verified masterGainNode -> destination (gain=${this.masterGainNode.gain.value.toFixed(3)}, muted=${this.masterMuted})`)}catch(Re){Re.message.includes("already connected")||Re.message.includes("already been connected")?console.log(`🎚️ ✅ POST-EVALUATION: masterGainNode -> destination already connected (gain=${this.masterGainNode.gain.value.toFixed(3)}, muted=${this.masterMuted})`):console.warn(`⚠️ POST-EVALUATION: Could not verify masterGainNode -> destination: ${Re.message}`)}}else console.warn("⚠️ POST-EVALUATION: Could not find scheduler")}catch(se){console.warn(`⚠️ POST-EVALUATION: Error reconnecting Strudel output: ${se.message}`)}}if(setTimeout(()=>{this.currentEvaluatingSlot===this.masterSlot&&(this.currentEvaluatingSlot=null)},this.soundsPreloaded?100:500),this.trackedPatterns.size===1){const Y=Array.from(this.trackedPatterns.keys())[0],se=this.getElementAudioNodes(Y);console.log(`🔍 AUDIO CHAIN VERIFICATION for ${Y}:`),console.log("   📊 AUDIO ROUTING CHAIN (simplified, no masterAnalyser):"),console.log(`      1. Strudel output -> elementGainNode (gain=${(($=(N=(j=se==null?void 0:se.gainNode)==null?void 0:j.gain)==null?void 0:N.value)==null?void 0:$.toFixed(3))||"N/A"})`),console.log(`      2. elementGainNode -> elementPanNode (pan=${((q=(I=(L=se==null?void 0:se.panNode)==null?void 0:L.pan)==null?void 0:I.value)==null?void 0:q.toFixed(3))||"N/A"})`),console.log("      3. elementPanNode -> masterPanNode"),console.log(`      4. masterPanNode -> masterGainNode (gain=${((he=(ee=(ce=this.masterGainNode)==null?void 0:ce.gain)==null?void 0:ee.value)==null?void 0:he.toFixed(3))||"N/A"}, muted=${this.masterMuted})`),console.log("      5. masterGainNode -> destination (audio output)"),console.log("      6. masterGainNode -> visualizerAnalyser (parallel, for visualization)"),console.log("   ✅ SIMPLIFIED CHAIN: element gain -> element pan -> master pan -> master gain -> destination"),console.log(`   elementGainNode: ${se!=null&&se.gainNode?"EXISTS":"MISSING"} (gain=${((Oe=(me=(H=se==null?void 0:se.gainNode)==null?void 0:H.gain)==null?void 0:me.value)==null?void 0:Oe.toFixed(3))||"N/A"})`),console.log(`   elementPanNode: ${se!=null&&se.panNode?"EXISTS":"MISSING"} (pan=${((Se=(De=(Pe=se==null?void 0:se.panNode)==null?void 0:Pe.pan)==null?void 0:De.value)==null?void 0:Se.toFixed(3))||"N/A"})`),console.log(`   masterPanNode: ${this.masterPanNode?"EXISTS":"MISSING"}`),console.log(`   masterGainNode: ${this.masterGainNode?"EXISTS":"MISSING"} (gain=${((Qe=(Ee=(ae=this.masterGainNode)==null?void 0:ae.gain)==null?void 0:Ee.value)==null?void 0:Qe.toFixed(3))||"N/A"}, muted=${this.masterMuted})`),console.log(`   visualizerAnalyser: ${this.visualizerAnalyser?"EXISTS":"MISSING"}`),console.log(`   destination: ${this._realDestination?"EXISTS":"MISSING"}`),console.log(`   TOTAL GAIN: ${((((ge=(Ke=se==null?void 0:se.gainNode)==null?void 0:Ke.gain)==null?void 0:ge.value)||0)*(((yt=(Ye=this.masterGainNode)==null?void 0:Ye.gain)==null?void 0:yt.value)||0)).toFixed(3)} (element=${((Ct=(Ge=(Xe=se==null?void 0:se.gainNode)==null?void 0:Xe.gain)==null?void 0:Ge.value)==null?void 0:Ct.toFixed(3))||"0"} * master=${((On=(gn=(Et=this.masterGainNode)==null?void 0:Et.gain)==null?void 0:gn.value)==null?void 0:On.toFixed(3))||"0"})`);try{const te=((qn=window.strudel)==null?void 0:qn.repl)||window.strudel;if(te!=null&&te.scheduler){const be=te.scheduler,$e=be.webaudio||be._webaudio;if($e){const Re=$e.output||$e.outputNode;Re?(console.log(`   Strudel outputNode: EXISTS (${Re.constructor.name})`),se!=null&&se.gainNode&&console.log("   ✅ Chain should be: Strudel output -> elementGain -> elementPan -> masterPan -> masterGain -> destination")):console.warn("   ⚠️ Strudel outputNode: NOT FOUND")}else console.warn("   ⚠️ Strudel webaudio: NOT FOUND")}}catch(te){console.warn(`   ⚠️ Could not verify Strudel output: ${te.message}`)}if(console.log("   🔍 VERIFYING MASTER CHAIN:"),console.log(`      masterPanNode: ${this.masterPanNode?"EXISTS":"MISSING"}`),console.log(`      masterFilterNode: ${this.masterFilterNode?"EXISTS":"MISSING"} (enabled=${this.masterFilterEnabled})`),console.log(`      masterGainNode: ${this.masterGainNode?"EXISTS":"MISSING"} (gain=${((Rt=(un=(cn=this.masterGainNode)==null?void 0:cn.gain)==null?void 0:un.value)==null?void 0:Rt.toFixed(3))||"N/A"})`),console.log(`      destination: ${this._realDestination?"EXISTS":"MISSING"}`),this.masterPanNode&&this.masterFilterNode)try{this.masterPanNode.connect(this.masterFilterNode),console.log("   ✅ VERIFIED: masterPanNode -> masterFilterNode")}catch(te){te.message.includes("already connected")||te.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterPanNode -> masterFilterNode (already connected)"):console.warn(`   ⚠️ Could not verify masterPanNode -> masterFilterNode: ${te.message}`)}if(this.masterFilterNode&&this.masterDryGainNode)try{this.masterFilterNode.connect(this.masterDryGainNode),console.log("   ✅ VERIFIED: masterFilterNode -> masterDryGainNode")}catch(te){te.message.includes("already connected")||te.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterFilterNode -> masterDryGainNode (already connected)"):console.warn(`   ⚠️ Could not verify masterFilterNode -> masterDryGainNode: ${te.message}`)}if(this.masterDryGainNode&&this.masterGainNode)try{this.masterDryGainNode.connect(this.masterGainNode),console.log("   ✅ VERIFIED: masterDryGainNode -> masterGainNode")}catch(te){te.message.includes("already connected")||te.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterDryGainNode -> masterGainNode (already connected)"):console.warn(`   ⚠️ Could not verify masterDryGainNode -> masterGainNode: ${te.message}`)}if(this.masterFilterNode&&this.masterDelayNode)try{this.masterFilterNode.connect(this.masterDelayNode),console.log("   ✅ VERIFIED: masterFilterNode -> masterDelayNode")}catch(te){te.message.includes("already connected")||te.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterFilterNode -> masterDelayNode (already connected)"):console.warn(`   ⚠️ Could not verify masterFilterNode -> masterDelayNode: ${te.message}`)}if(this.masterReverbGainNode&&this.masterGainNode)try{this.masterReverbGainNode.connect(this.masterGainNode),console.log("   ✅ VERIFIED: masterReverbGainNode -> masterGainNode")}catch(te){te.message.includes("already connected")||te.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterReverbGainNode -> masterGainNode (already connected)"):console.warn(`   ⚠️ Could not verify masterReverbGainNode -> masterGainNode: ${te.message}`)}if(this.masterGainNode&&this._realDestination)try{this.masterGainNode.connect(this._realDestination),console.log("   ✅ CONNECTED: masterGainNode -> destination (CRITICAL for audio output)")}catch(te){if(te.message&&te.message.includes("already connected")||te.message.includes("InvalidStateError"))console.log("   ✅ VERIFIED: masterGainNode -> destination (already connected)");else try{this.masterGainNode.connect(this._realDestination),console.log("   ✅ RECONNECTED: masterGainNode -> destination")}catch(be){be.message.includes("already connected")||be.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterGainNode -> destination (already connected)"):console.error(`   ❌ FAILED: Could not connect masterGainNode -> destination: ${be.message}`)}}else console.warn(`   ⚠️ Cannot verify masterGainNode->destination: masterGainNode=${!!this.masterGainNode}, destination=${!!this._realDestination}`)}if(console.log("🔍 FINAL CHAIN VERIFICATION:"),this.trackedPatterns.size>0){const Y=Array.from(this.trackedPatterns.keys());for(const se of Y){const te=this.getElementAudioNodes(se);console.log(`   ${se}:`),console.log(`      elementGain: ${te!=null&&te.gainNode?"EXISTS":"MISSING"} (gain=${((Wn=(Un=(Kt=te==null?void 0:te.gainNode)==null?void 0:Kt.gain)==null?void 0:Un.value)==null?void 0:Wn.toFixed(3))||"N/A"})`),console.log(`      elementPan: ${te!=null&&te.panNode?"EXISTS":"MISSING"} (pan=${((Pn=(rt=(bn=te==null?void 0:te.panNode)==null?void 0:bn.pan)==null?void 0:rt.value)==null?void 0:Pn.toFixed(3))||"N/A"})`)}}if(console.log(`   masterPanNode: ${this.masterPanNode?"EXISTS":"MISSING"}`),console.log(`   masterGainNode: ${this.masterGainNode?"EXISTS":"MISSING"} (gain=${((Zt=(Vt=(pt=this.masterGainNode)==null?void 0:pt.gain)==null?void 0:Vt.value)==null?void 0:Zt.toFixed(3))||"N/A"}, muted=${this.masterMuted})`),console.log(`   visualizerAnalyser: ${this.visualizerAnalyser?"EXISTS":"MISSING"}`),console.log(`   destination: ${this._realDestination?"EXISTS":"MISSING"}`),this.masterPanNode&&this.masterFilterNode)try{this.masterPanNode.connect(this.masterFilterNode),console.log("   ✅ VERIFIED: masterPanNode -> masterFilterNode (reconnected)")}catch(Y){Y.message.includes("already connected")||Y.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterPanNode -> masterFilterNode (already connected)"):console.warn(`   ⚠️ Could not verify masterPanNode -> masterFilterNode: ${Y.message}`)}if(this.masterFilterNode&&this.masterGainNode)try{this.masterDelayNode&&this.masterReverbNode?(this.masterFilterNode.connect(this.masterDelayNode),this.masterDelayNode.connect(this.masterDelayGainNode),this.masterDelayGainNode.connect(this.masterReverbNode),this.masterReverbNode.connect(this.masterReverbGainNode),this.masterReverbGainNode.connect(this.masterGainNode),this.masterDelayNode.connect(this.masterDelayFeedbackGainNode),this.masterDelayFeedbackGainNode.connect(this.masterDelayNode),console.log("   ✅ VERIFIED: masterFilterNode -> masterDelayNode -> masterReverbNode -> masterGainNode (reconnected)")):(this.masterFilterNode.connect(this.masterGainNode),console.log("   ✅ VERIFIED: masterFilterNode -> masterGainNode (reconnected, delay/reverb not available)"))}catch(Y){Y.message.includes("already connected")||Y.message.includes("already been connected")?console.log("   ✅ VERIFIED: masterFilterNode -> masterGainNode (already connected)"):console.warn(`   ⚠️ Could not verify masterFilterNode -> masterGainNode: ${Y.message}`)}if(this.masterGainNode&&this._realDestination)try{this.masterGainNode.connect(this._realDestination),console.log(`   ✅ VERIFIED: masterGainNode -> destination (reconnected, gain=${this.masterGainNode.gain.value.toFixed(3)})`)}catch(Y){Y.message.includes("already connected")||Y.message.includes("already been connected")?console.log(`   ✅ VERIFIED: masterGainNode -> destination (already connected, gain=${this.masterGainNode.gain.value.toFixed(3)})`):console.warn(`   ⚠️ Could not verify masterGainNode -> destination: ${Y.message}`)}console.log("   🔍 FINAL: Searching for Strudel output node...");try{const Y=((_n=window.strudel)==null?void 0:_n.repl)||window.strudel;if(console.log(`   🔍 FINAL: replInstance=${!!Y}`),Y!=null&&Y.scheduler){const se=Y.scheduler;console.log(`   🔍 FINAL: scheduler=${!!se}, keys=${Object.keys(se).slice(0,10).join(", ")}`);let te=null,be=null;const $e=se.webaudio||se._webaudio;if($e&&(te=$e.output||$e.outputNode,te&&(be="scheduler.webaudio")),!te&&se.superdough){const Re=se.superdough;if(console.log(`   🔍 FINAL: superdough found, keys=${Object.keys(Re).slice(0,20).join(", ")}`),te=Re.output||Re.outputNode||Re._output||Re.destination||Re._destination,te&&(be="scheduler.superdough"),!te&&Re.webaudio&&(console.log(`   🔍 FINAL: superdough.webaudio found, keys=${Object.keys(Re.webaudio).slice(0,10).join(", ")}`),te=Re.webaudio.output||Re.webaudio.outputNode||Re.webaudio.destination,te&&(be="scheduler.superdough.webaudio")),!te&&Re.audioContext&&console.log("   🔍 FINAL: superdough.audioContext found"),!te)for(const ut of Object.keys(Re)){const on=Re[ut];if(on&&typeof on=="object"&&(((it=on.constructor)==null?void 0:it.name)==="GainNode"||((Ft=on.constructor)==null?void 0:Ft.name)==="AudioNode"||on instanceof AudioNode)){console.log(`   🔍 FINAL: Found potential output node at superdough.${ut} (${on.constructor.name})`),te=on,be=`scheduler.superdough.${ut}`;break}}}if(!te&&se._superdough){const Re=se._superdough;te=Re.output||Re.outputNode||Re._output,te&&(be="scheduler._superdough")}if(console.log(`   🔍 FINAL: outputNode=${te?te.constructor.name:"null"}, source=${be||"not found"}`),te&&this.trackedPatterns.size>0){const Re=Array.from(this.trackedPatterns.keys())[0],ut=this.getElementAudioNodes(Re);if(console.log(`   🔍 FINAL: ${Re}, elementNodes=${!!ut}, gainNode=${!!(ut!=null&&ut.gainNode)}`),ut!=null&&ut.gainNode)try{te.disconnect(),te.connect(ut.gainNode),console.log(`   ✅ FINAL: Reconnected Strudel output (${be}) -> ${Re} gainNode (THIS IS CRITICAL FOR AUDIO)`)}catch(on){console.log(`   ✅ FINAL: Strudel output already routed to ${Re} gainNode (${on.message})`)}else console.error("   ❌ FINAL: Cannot reconnect - elementNodes or gainNode missing!")}else if(console.warn(`   ⚠️ FINAL: Cannot reconnect - outputNode=${!!te}, trackedPatterns.size=${this.trackedPatterns.size}`),!te&&(console.warn("   ⚠️ FINAL: Strudel output node not found in any expected location."),console.warn("   ⚠️ FINAL: This might mean Strudel creates audio nodes dynamically. Audio routing hijacking should catch connections."),console.warn('   ⚠️ FINAL: If you see "DESTINATION CONNECTION" logs, the hijacking is working. If not, Strudel might be using a different routing mechanism.'),console.log("   🔧 FINAL: Ensuring master chain is connected (fallback for dynamic audio nodes)..."),this.masterPanNode&&this.masterGainNode&&this._realDestination))try{this.masterGainNode.connect(this._realDestination),console.log(`   ✅ FINAL: Master chain verified and connected (gain=${this.masterGainNode.gain.value.toFixed(3)})`)}catch(Re){console.log(`   ✅ FINAL: Master chain already connected (${Re.message})`)}}else console.warn("   ⚠️ FINAL: scheduler not found in replInstance")}catch(Y){console.error(`   ❌ FINAL: Error reconnecting Strudel output: ${Y.message}`),console.error(`   ❌ FINAL: Stack: ${Y.stack}`)}const _=this.audioContext?this.audioContext.currentTime:performance.now()/1e3;this.masterPlaybackStartTime=_,this.masterPlaybackTempo=this.currentTempo||120;const B=this.masterPlaybackTempo/120;this.masterPlaybackSpeed=Number.isFinite(B)&&B>0?B:1,console.log(`✅ Master pattern playing on ${this.masterSlot} (volume/pan/mute via Web Audio API)`),console.log(`🔊 Audio context state: ${((_e=this.audioContext)==null?void 0:_e.state)||"unknown"}`),console.log(`🔊 Master gain value: ${((et=(Lt=this.masterGainNode)==null?void 0:Lt.gain)==null?void 0:et.value)||"unknown"}`),console.log(`🔊 Master muted: ${this.masterMuted||!1}`),console.log("ℹ️ Note: If you see createPeriodicWave errors, they are suppressed but may affect audio playback"),this._audioNodeMonitorInterval&&clearInterval(this._audioNodeMonitorInterval);let R=0;const Z=20;return this._audioNodeMonitorInterval=setInterval(()=>{var Y;if(R++,R>Z){clearInterval(this._audioNodeMonitorInterval),this._audioNodeMonitorInterval=null,console.log(`🔍 Audio node monitoring stopped after ${Z} checks`);return}try{const se=(Y=window.strudel)==null?void 0:Y.scheduler;if(se){const te=["webaudio","_webaudio","superdough","_superdough","output","outputNode"];for(const be of te)if(se[be]&&!se[`_monitored_${be}`]){if(console.log(`🔍 MONITOR: Found ${be} in scheduler at check ${R}: ${typeof se[be]}`),se[be]instanceof AudioNode&&(console.log(`   → AudioNode: ${se[be].constructor.name}`),this.trackedPatterns.size>0)){const $e=Array.from(this.trackedPatterns.keys())[0],Re=this.getElementAudioNodes($e);if(Re!=null&&Re.gainNode)try{se[be].disconnect(),se[be].connect(Re.gainNode),console.log(`   ✅ MONITOR: Routed scheduler.${be} to ${$e} gainNode`)}catch(ut){console.log(`   ✅ MONITOR: scheduler.${be} already routed (${ut.message})`)}}se[`_monitored_${be}`]=!0}if(se.superdough&&!se._monitored_superdough){const be=se.superdough;console.log(`🔍 MONITOR: Found superdough at check ${R}, keys: ${Object.keys(be).slice(0,10).join(", ")}`);const $e=["output","outputNode","_output","destination","_destination","gain","masterGain"];for(const Re of $e)if(be[Re]&&be[Re]instanceof AudioNode&&(console.log(`   → Found AudioNode at superdough.${Re}: ${be[Re].constructor.name}`),this.trackedPatterns.size>0)){const ut=Array.from(this.trackedPatterns.keys())[0],on=this.getElementAudioNodes(ut);if(on!=null&&on.gainNode)try{be[Re].disconnect(),be[Re].connect(on.gainNode),console.log(`   ✅ MONITOR: Routed superdough.${Re} to ${ut} gainNode`)}catch(Yn){console.log(`   ✅ MONITOR: superdough.${Re} already routed (${Yn.message})`)}}se._monitored_superdough=!0}}}catch(se){console.warn(`🔍 MONITOR: Error checking scheduler: ${se.message}`)}},100),this.audioContext&&this.audioContext.state==="suspended"&&(console.warn("⚠️ AUDIO CONTEXT SUSPENDED: Audio context is suspended - attempting to resume..."),this.audioContext.resume().then(()=>{console.log("✅ Audio context resumed successfully")}).catch(Y=>{console.error(`❌ Failed to resume audio context: ${Y.message}`)})),this._audioChainCheckInterval&&clearInterval(this._audioChainCheckInterval),this._zeroGainLogged=!1,this._mutedLogged=!1,this._audioChainCheckInterval=setInterval(()=>{if(this.masterActive&&this.masterGainNode&&this._realDestination){try{this.masterGainNode.connect(this._realDestination)}catch{}this.masterGainNode.gain.value===0&&!this._zeroGainLogged&&(console.warn("⚠️ AUDIO CHAIN CHECK: masterGainNode.gain.value is 0 - no audio will play!"),this._zeroGainLogged=!0),this.masterMuted&&!this._mutedLogged&&(console.warn("⚠️ AUDIO CHAIN CHECK: masterGainNode is muted - no audio will play!"),this._mutedLogged=!0)}else this._audioChainCheckInterval&&(clearInterval(this._audioChainCheckInterval),this._audioChainCheckInterval=null)},1e3),this.onMasterStateChangeCallback&&this.onMasterStateChangeCallback(!0,Array.from(this.trackedPatterns.keys())),this.editorHighlightingEnabled&&Ow(),{success:!0}}else return console.error("❌ Strudel not properly initialized"),{success:!1,error:"Strudel not initialized"}}catch(is){return console.error("❌ Error playing master pattern:",is),{success:!1,error:is.message}}}async _stopMasterPatternSimple(){var e;try{if(window.strudel&&typeof window.strudel.evaluate=="function"){const t=this.masterSlot||"d0";await window.strudel.evaluate(`${t} = silence`),window.strudel.scheduler&&window.strudel.scheduler.started&&typeof window.strudel.scheduler.stop=="function"&&await window.strudel.scheduler.stop()}return this.masterActive=!1,ww(),this.masterPlaybackStartTime=null,this.stopAllMIDINotes(),this.masterGainNode&&this.masterGainNode.gain.setValueAtTime(0,((e=this.audioContext)==null?void 0:e.currentTime)||0),this.onMasterStateChangeCallback&&this.onMasterStateChangeCallback(!1,[]),{success:!0}}catch(t){return console.error("❌ Error stopping master (simple mode):",t),{success:!1,error:t.message}}}async stopMasterPattern(){var e;if(this.masterOnlyPlayback)return this._stopMasterPatternSimple();try{if(console.log("⏹️ Stopping master pattern..."),window.strudel&&window.strudel.evaluate){window.strudel.repl&&window.strudel.repl.scheduler&&typeof window.strudel.repl.scheduler.stop=="function"&&(window.strudel.repl.scheduler.stop(),console.log("✓ Stopped REPL scheduler"));const t=`${this.masterSlot} = silence`;return await window.strudel.evaluate(t),window.strudel.repl&&window.strudel.repl.scheduler&&typeof window.strudel.repl.scheduler.start=="function"&&(window.strudel.repl.scheduler.start(),console.log("✓ Restarted REPL scheduler")),this.masterPlaybackStartTime=null,this.masterActive=!1,this.editorHighlightingEnabled&&ww(),this.masterGainNode&&this.masterGainNode.gain.setValueAtTime(0,((e=this.audioContext)==null?void 0:e.currentTime)||0),this._audioChainCheckInterval&&(clearInterval(this._audioChainCheckInterval),this._audioChainCheckInterval=null),this.stopAllMIDINotes(),console.log("✅ Master pattern stopped"),this._masterTapLogged=!1,this._masterTapSuccess=new Set,this.onMasterStateChangeCallback&&this.onMasterStateChangeCallback(!1,[]),{success:!0}}else return console.error("❌ Strudel not available"),{success:!1,error:"Strudel not available"}}catch(t){return console.error("❌ Error stopping master pattern:",t),{success:!1,error:t.message}}}getMasterPatternCode(){if(this.masterPattern&&this.masterPattern.trim()!==""){const e="// Controls Selected Tempo:";this.masterPattern.split(`
`).some(s=>s.trim().startsWith(e))||(this.masterPattern=this.formatMasterPatternWithTempoComment(this.masterPattern))}return this._ensureMasterPatternSanitized(),this.masterPattern}isMasterActive(){return!!this.masterActive}getMasterPlaybackInfo(){return{isPlaying:!!this.masterActive,startTime:this.masterPlaybackStartTime,speed:this.masterPlaybackSpeed||1,tempo:this.masterPlaybackTempo||this.currentTempo||120}}_isCompletePattern(e){if(!e||typeof e!="string")return!1;const t=e.trim();if(t.includes("all(")&&!t.startsWith("stack("))return!0;const r=t.split(`
`).filter(i=>i.trim()&&!i.trim().startsWith("//")).length>1,a=t.match(/^[a-zA-Z_$][a-zA-Z0-9_$]*\s*:/m);return!!(r&&a)}_splitManualOverridePattern(e){if(!e||typeof e!="string")return{setupCode:"",finalExpression:""};const t=e.replace(/\r/g,"").trim();if(!t)return{setupCode:"",finalExpression:""};const s=[];let r=[];const a=()=>{r.length>0&&(s.push(r.join(`
`).trim()),r=[])};if(t.split(`
`).forEach(c=>{c.trim()===""?a():r.push(c)}),a(),!s.length)return{setupCode:"",finalExpression:t};let i=s.pop();return/^[a-zA-Z_$][a-zA-Z0-9_$]*\s*:/.test(i)&&(s.push(i),i=""),{setupCode:s.join(`

`).trim(),finalExpression:i.trim()}}async setMasterPatternCode(e){try{if(console.log(`✏️ Setting master pattern code: ${e.substring(0,100)}...`),e&&e.trim()!==""){this.masterPatternManualOverride=this._isCompletePattern(e),this.masterPatternManualOverride&&console.log("📝 Detected complete pattern - will use as-is without stack() wrapping");let t=e.trim();const s=/setDefaultVoicings\s*\(\s*(['"]([^'"]*)['"]|([^)]+))\s*\)/g,r=[];let a;for(;(a=s.exec(t))!==null;)r.push({fullMatch:a[0],arg:a[2]||a[3],isQuoted:!!a[2]});for(const i of r)try{const o=i.isQuoted?`setDefaultVoicings('${i.arg}')`:`setDefaultVoicings(${i.arg})`;window.strudel&&window.strudel.evaluate&&(await window.strudel.evaluate(o),console.log(`✅ Evaluated ${o} before storing pattern`))}catch(o){console.warn("⚠️ Could not evaluate setDefaultVoicings:",o.message)}r.length>0&&(t=t.split(`
`).filter(l=>!l.trim().includes("setDefaultVoicings")).join(`
`).replace(/\n{3,}/g,`

`).trim()),this.masterPattern=this.formatMasterPatternWithTempoComment(t)}else this.masterPattern="";if(this._ensureMasterPatternSanitized(),this.appInstance&&typeof this.appInstance.syncElementsFromMasterPattern=="function")try{this.appInstance.syncElementsFromMasterPattern(this.masterPattern)}catch(t){console.warn("⚠️ Failed to sync elements from master pattern:",t)}if(this.masterActive){console.log("🔄 Master is active - re-evaluating with updated pattern (no stop).");try{await this._reEvaluateMasterPattern("master code update")}catch(t){console.warn("⚠️ Could not re-evaluate master after code update:",t.message)}}return{success:!0}}catch(t){return console.error("❌ Error setting master pattern code:",t),{success:!1,error:t.message}}}async previewPattern(e,t="preview",s=null){var r,a,i;if(this.masterOnlyPlayback)return console.log(`👀 Preview via master stack (${t})`),this.routePatternThroughMaster(t,e,{isPreview:!0,autoStart:!0});try{console.log(`👀 Previewing pattern (received): ${e.substring(0,100)}...`),console.log(`👀 Full pattern to preview: ${e}`);const o="d16";if(this.currentEvaluatingSlot=o,this.patternSlotToElementId.set(o,t),console.log(`🎵 Preview: Mapped slot ${o} to elementId ${t} for audio routing`),window.strudel&&window.strudel.evaluate)try{await window.strudel.evaluate(`${o} = silence`),console.log(`✅ Preview slot ${o} cleared`)}catch(u){console.warn("⚠️ Error clearing preview slot:",u.message)}if((!this.audioContext||this.audioContext.state==="suspended")&&await this.initialize(),this.audioContext&&this.audioContext.state==="suspended"){console.log("🔊 Audio context suspended for preview, resuming...");try{await this.audioContext.resume(),console.log(`✅ Audio context resumed for preview, state: ${this.audioContext.state}`)}catch(u){console.warn("⚠️ Could not resume audio context for preview:",u)}}const l=this.getElementAudioNodes(t);(!l||!l.gainNode)&&console.warn(`⚠️ Could not prepare audio nodes for preview element ${t}`),this.strudelLoaded||(console.log("⏳ Waiting for Strudel to initialize..."),await this.initializeStrudelAndSounds()),await this.ensurePatternResourcesLoaded(e),console.log(`🔍 Preview - Original pattern: ${e}`),console.log(`🔍 Preview - Pattern type check: isNotePattern=${this.isNotePattern(e)}, contains s(${e.includes("s(")}, contains sound(${e.includes("sound(")}, contains note(${/\bnote\s*\(/i.test(e)})`);let c=await this.processPattern(e,t,{preserveBanks:!0,attemptBankLoad:!0,applyGainInPattern:!1});if(!c)return console.error("❌ Pattern processing failed for preview"),{success:!1,error:"Pattern processing failed"};if(console.log(`🔍 Preview - After processPattern: ${c}`),console.log(`🔍 Preview - Processed pattern type check: isNotePattern=${this.isNotePattern(c)}, contains s(${c.includes("s(")}, contains sound(${c.includes("sound(")}, contains note(${/\bnote\s*\(/i.test(c)})`),!c.includes(".loop(")&&!c.includes(".loop()")&&(c=`${c}.loop()`,console.log("🔄 Added .loop() to preview pattern for continuous playback")),window.strudel&&window.strudel.evaluate){const u=`${o} = ${c}`;console.log(`🎼 Preview evaluating: ${u.substring(0,300)}...`),console.log(`🔍 Preview - Full pattern code (${u.length} chars): ${u}`);const h=u.match(/\.s\(["']([^"']+)["']\)/),d=u.match(/\.sound\(["']([^"']+)["']\)/),m=d?d[1]:h?h[1]:"unknown";console.log(`🎵 Preview waveform: ${m}`);try{if(await window.strudel.evaluate(u),console.log("✅ Preview pattern evaluated successfully"),window.strudel.scheduler&&(window.strudel.scheduler.started?console.log("🔄 Scheduler already running, ensuring pattern is active..."):(console.log("▶️ Starting Strudel scheduler for preview..."),await window.strudel.scheduler.start())),this.soundsPreloaded)await new Promise(O=>setTimeout(O,50)),setTimeout(()=>{this.currentEvaluatingSlot===o&&(this.currentEvaluatingSlot=null)},500);else{if(window.strudel.scheduler&&window.strudel.scheduler.tick)try{for(let O=0;O<2;O++)window.strudel.scheduler.tick(),await new Promise(S=>setTimeout(S,10))}catch(O){console.warn("⚠️ Could not trigger scheduler tick:",O)}await new Promise(O=>setTimeout(O,200)),setTimeout(()=>{this.currentEvaluatingSlot===o&&(this.currentEvaluatingSlot=null)},1e3)}}catch(O){return console.error("❌ Preview pattern evaluation error:",O.message),console.error(`❌ Failed pattern code: ${u}`),{success:!1,error:O.message}}console.log(`✅ Preview pattern is playing on ${o}`),console.log(`🔊 Audio context state: ${((r=this.audioContext)==null?void 0:r.state)||"unknown"}`),console.log(`🔊 Master gain value: ${((i=(a=this.masterGainNode)==null?void 0:a.gain)==null?void 0:i.value)||"unknown"}`),console.log(`🔊 Master muted: ${this.masterMuted||!1}`);const y=c.includes(".s(")||c.includes(".sound(");return console.log(`🔍 Preview pattern waveform check: ${y?"Has waveform (.s() or .sound())":"No waveform found"}`),{success:!0,previewSlot:o}}else return console.error("❌ Strudel not properly initialized"),{success:!1,error:"Strudel not initialized"}}catch(o){return console.error("❌ Error previewing pattern:",o),{success:!1,error:o.message}}}async stopPreview(){if(this.masterOnlyPlayback){console.log("⏹️ Stopping preview routed through master");for(const e of this.previewElementIds)this.removeElementFromMaster(e);return this.previewElementIds.clear(),this.masterActive&&(!this.masterPattern||!this.masterPattern.trim())?await this.stopMasterPattern():this.masterActive&&await this.playMasterPattern(),{success:!0}}try{return console.log("⏹️ Stopping preview..."),window.strudel&&window.strudel.evaluate?(await window.strudel.evaluate("d16 = silence"),console.log("✅ Preview stopped"),{success:!0}):{success:!1,error:"Strudel not available"}}catch(e){return console.error("❌ Error stopping preview:",e),{success:!1,error:e.message}}}async exportAudioWAV(e=16,t=44100){try{if(console.log(`📦 Exporting master pattern as WAV (${e} seconds)...`),!this.masterPattern||this.masterPattern.trim()==="")return{success:!1,error:"No master pattern to export"};this.strudelLoaded||await this.initializeStrudelAndSounds();const r=new OfflineAudioContext(2,t*e,t).destination;return window.strudel&&window.strudel.repl&&window.strudel.repl.audioContext?(console.log("⚠️ Using MediaRecorder fallback for audio export"),await this.exportAudioMediaRecorder(e)):await this.exportAudioMediaRecorder(e)}catch(s){return console.error("❌ Error exporting WAV:",s),{success:!1,error:s.message}}}async exportAudioMediaRecorder(e=16){return new Promise(t=>{try{if(!this.audioContext){t({success:!1,error:"Audio context not initialized"});return}if(!this.masterGainNode||!this.masterPanNode){t({success:!1,error:"Master audio nodes not found"});return}const s=this.audioContext.sampleRate,r=Math.floor(s*e),a=2,i=4096,o=[];let l=!1,c=null;try{c=this.audioContext.createScriptProcessor(i,a,a);let d=0;c.onaudioprocess=m=>{d++;const y=m.inputBuffer,O=m.outputBuffer;for(let j=0;j<a;j++){const N=y.getChannelData(j);O.getChannelData(j).set(N)}const S=Math.max(...Array.from(y.getChannelData(0).map(Math.abs)));if((d<=5||d%50===0)&&console.log(`🔍 ScriptProcessor call #${d}: max amplitude = ${S.toFixed(6)}, isRecording = ${l}`),!l)return;const A=[];for(let j=0;j<a;j++){const N=y.getChannelData(j);A.push(new Float32Array(N))}const F=Math.max(...A[0].map(Math.abs));F>1e-4?(o.length%10===0||o.length<5)&&console.log(`📦 Recording chunk ${o.length}: max amplitude = ${F.toFixed(6)}`):o.length<5&&console.log(`📦 Recording chunk ${o.length}: SILENT (max amplitude = ${F.toFixed(6)})`),o.push(A)},console.log("✅ ScriptProcessorNode created")}catch(d){console.error("❌ Failed to create ScriptProcessorNode:",d),t({success:!1,error:"ScriptProcessorNode not supported: "+d.message});return}const u=this.masterActive;console.log("▶️ Setting up recording..."),console.log("🔍 Pattern code:",this.masterPattern.substring(0,100)),console.log("🔍 Pattern already playing:",u);let h;u?(console.log("▶️ Pattern already playing, ensuring scheduler is running..."),h=Promise.resolve().then(async()=>(window.strudel&&window.strudel.scheduler&&!window.strudel.scheduler.started&&(console.log("▶️ Starting Strudel scheduler..."),await window.strudel.scheduler.start()),{success:!0}))):(console.log("▶️ Pattern not playing, starting it now..."),h=this.playMasterPattern()),h.then(()=>{setTimeout(()=>{console.log("🔧 Setting up recording routing..."),console.log("🔍 Master active:",this.masterActive),console.log("🔍 Audio context state:",this.audioContext.state);try{this.masterGainNode.disconnect(),console.log("✅ Disconnected all connections from masterGainNode")}catch(d){console.warn("⚠️ Could not disconnect all:",d);try{this.masterGainNode.disconnect(this._realDestination),console.log("✅ Disconnected masterGainNode from destination")}catch(m){console.warn("⚠️ Could not disconnect from destination:",m)}}this.masterGainNode.connect(c),c.connect(this._realDestination),console.log("✅ Connected audio routing: masterGainNode -> scriptProcessor -> destination"),console.log("🔍 Verifying connections:"),console.log("  masterGainNode numberOfOutputs:",this.masterGainNode.numberOfOutputs),console.log("  scriptProcessor inputs:",c.numberOfInputs,"outputs:",c.numberOfOutputs),console.log("  Waiting for audio to flow through scriptProcessor..."),setTimeout(()=>{console.log(`🎙️ Recording started for ${e} seconds...`),console.log("🔍 Master active:",this.masterActive),console.log("🔍 Audio context state:",this.audioContext.state),console.log("🔍 ScriptProcessor connected - waiting for audio chunks..."),l=!0,setTimeout(()=>{var I;console.log(`⏹️ Stopping recording after ${e} seconds...`),console.log(`📦 Total chunks captured: ${o.length}`),l=!1;try{try{c.disconnect(this._realDestination)}catch{}try{this.masterGainNode.disconnect(c)}catch{}try{this.masterGainNode.connect(this._realDestination)}catch{try{this.masterGainNode.disconnect(this._realDestination),this.masterGainNode.connect(this._realDestination)}catch(ce){console.warn("Could not restore connection:",ce)}}console.log("✅ Restored original audio routing: masterGainNode -> destination")}catch(q){console.warn("Error restoring audio routing:",q);try{this.masterGainNode.connect(this._realDestination)}catch(ce){console.error("Failed to restore connection:",ce)}}if(u?console.log("✅ Pattern was already playing, leaving it running"):this.stopMasterPattern(),o.length===0){console.error("❌ No audio data recorded"),console.error("🔍 Debug info:"),console.error("  Master active:",this.masterActive),console.error("  Audio context state:",this.audioContext.state),console.error("  Master gain node:",!!this.masterGainNode),console.error("  Master pan node:",!!this.masterPanNode),console.error("  Script processor:",!!c),console.error("  Is recording flag:",l),console.error("  Pattern code length:",((I=this.masterPattern)==null?void 0:I.length)||0),t({success:!1,error:"No audio data was recorded. ScriptProcessorNode may not be receiving audio. Check console for debug info."});return}console.log(`📦 Recorded ${o.length} chunks`);const d=o.reduce((q,ce)=>q+ce[0].length,0);console.log(`📦 Total samples: ${d} (expected: ~${r})`);const m=new Float32Array(d),y=new Float32Array(d);let O=0;for(const q of o){const ce=q[0].length;m.set(q[0],O),q[1]?y.set(q[1],O):y.set(q[0],O),O+=ce}let S=0,A=0;const F=Math.max(1,Math.floor(d/1e3));for(let q=0;q<d;q+=F){const ce=Math.abs(m[q]),ee=Math.abs(y[q]),he=Math.max(ce,ee);S=Math.max(S,he),he>1e-4&&A++}console.log(`🔍 Audio analysis: max amplitude = ${S.toFixed(6)}, non-zero samples = ${A}`);const j=[],N=[];for(let q=0;q<Math.min(10,d);q++)j.push(Math.abs(m[q]));for(let q=Math.max(0,d-10);q<d;q++)N.push(Math.abs(m[q]));console.log(`🔍 First 10 samples: ${j.map(q=>q.toFixed(4)).join(", ")}`),console.log(`🔍 Last 10 samples: ${N.map(q=>q.toFixed(4)).join(", ")}`),S<1e-4&&(console.warn("⚠️ Audio appears to be silent (all zeros or very quiet)"),console.warn("⚠️ Master volume:",this.masterVolume),console.warn("⚠️ Master muted:",this.masterMuted),console.warn("⚠️ This might indicate that audio is not reaching masterPanNode"));const $=this.audioContext.createBuffer(a,d,s);$.getChannelData(0).set(m),$.getChannelData(1).set(y);const L=this.audioBufferToWAV($);if(console.log(`✅ WAV blob created: ${L.size} bytes`),L.size===0){t({success:!1,error:"WAV blob is empty"});return}this.downloadBlob(L,"master-pattern.wav","audio/wav"),S<1e-4?t({success:!0,format:"wav",warning:"Audio file created but appears to be silent. Check that the pattern is playing and master volume is not muted."}):t({success:!0,format:"wav"})},e*1e3)},200)},500)}).catch(d=>{console.error("❌ Failed to start pattern for recording:",d);try{this.masterGainNode.disconnect(c),c.disconnect(this._realDestination),this.masterGainNode.connect(this._realDestination)}catch{}t({success:!1,error:"Failed to start pattern: "+d.message})})}catch(s){console.error("❌ Error in audio export:",s),t({success:!1,error:s.message})}})}parsePatternToMIDI(e){const t=[];this.currentTempo;const i=16*480;let o=[e];if(e.includes("stack(")){const c=e.match(/stack\s*\(([^)]+)\)/);if(c){const u=c[1];o=this.splitStackPatterns(u)}}const l={bd:36,kick:36,kickdrum:36,sd:38,snare:38,snaredrum:38,hh:42,hihat:42,closedhihat:42,oh:46,openhihat:46,cr:49,crash:49,rd:51,ride:51,ht:48,hightom:48,mt:47,midtom:47,lt:45,lowtom:45,cp:39,clap:39,rim:37,rimshot:37};return o.forEach((c,u)=>{const h=/note\s*\(["']([^"']+)["']\)/g;let d;const m=[];for(;(d=h.exec(c))!==null;){const O=d[1].split(/\s+/).filter(S=>S.trim());m.push(...O)}if(m.length>0){const y=i/m.length;m.forEach((O,S)=>{const A=this.noteToMIDI(O);if(A!==null){const F=Math.round(S*y),j=Math.round(y*.8);t.push({type:"noteOn",tick:F,channel:u%16,note:A,velocity:100}),t.push({type:"noteOff",tick:F+j,channel:u%16,note:A,velocity:0})}})}else{const y=/(?:sound|s)\s*\(["']([^"']+)["']\)/g;let O;for(;(O=y.exec(c))!==null;){const A=O[1].split(/\s+/).filter(j=>j.trim()),F=i/A.length;A.forEach((j,N)=>{const $=l[j.toLowerCase()]||36,L=Math.round(N*F),I=Math.round(F*.3);t.push({type:"noteOn",tick:L,channel:9,note:$,velocity:100}),t.push({type:"noteOff",tick:L+I,channel:9,note:$,velocity:0})})}}}),t.sort((c,u)=>c.tick-u.tick),t}splitStackPatterns(e){const t=[];let s="",r=0;for(let a=0;a<e.length;a++){const i=e[a];i==="("?(r++,s+=i):i===")"?(r--,s+=i):i===","&&r===0?(t.push(s.trim()),s=""):s+=i}return s.trim()&&t.push(s.trim()),t}noteToMIDI(e){const t=e.match(/^([a-gA-G])([#b]?)(\d+)$/);if(!t)return null;const[,s,r,a]=t,o=["c","d","e","f","g","a","b"].indexOf(s.toLowerCase());if(o===-1)return null;let l=12+parseInt(a)*12+o;return r==="#"?l+=1:r==="b"&&(l-=1),Math.max(0,Math.min(127,l))}createMIDIFile(e){const t=this.currentTempo||120,s=new Uint8Array([77,84,104,100,0,0,0,6,0,1,0,1,1,224]),r=[],a=Math.round(6e7/t);r.push({deltaTime:0,type:255,metaType:81,data:[a>>16&255,a>>8&255,a&255]});let i=0;e.forEach(h=>{const d=h.tick-i;i=h.tick,h.type==="noteOn"?r.push({deltaTime:d,type:144|h.channel,data:[h.note,h.velocity]}):h.type==="noteOff"&&r.push({deltaTime:d,type:128|h.channel,data:[h.note,h.velocity]})}),r.push({deltaTime:0,type:255,metaType:47,data:[]});const o=[];r.forEach(h=>{let d=h.deltaTime;const m=[];do{let y=d&127;d>>=7,m.length>0&&(y|=128),m.push(y)}while(d>0);o.push(...m),o.push(h.type),h.metaType!==void 0&&(o.push(h.metaType),o.push(h.data.length)),o.push(...h.data)});const l=o.length,c=new Uint8Array([77,84,114,107,l>>24&255,l>>16&255,l>>8&255,l&255,...o]),u=new Uint8Array(s.length+c.length);return u.set(s,0),u.set(c,s.length),new Blob([u],{type:"audio/midi"})}downloadBlob(e,t,s){const r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}async blobToAudioBuffer(e){const t=await e.arrayBuffer();return await this.audioContext.decodeAudioData(t)}audioBufferToWAV(e){const t=e.numberOfChannels,s=e.sampleRate,r=1,a=16,i=a/8,o=t*i,l=s*o,c=e.length*o,u=44+c,h=new ArrayBuffer(u),d=new DataView(h),m=(S,A)=>{for(let F=0;F<A.length;F++)d.setUint8(S+F,A.charCodeAt(F))};m(0,"RIFF"),d.setUint32(4,u-8,!0),m(8,"WAVE"),m(12,"fmt "),d.setUint32(16,16,!0),d.setUint16(20,r,!0),d.setUint16(22,t,!0),d.setUint32(24,s,!0),d.setUint32(28,l,!0),d.setUint16(32,o,!0),d.setUint16(34,a,!0),m(36,"data"),d.setUint32(40,c,!0);let y=44;const O=[];for(let S=0;S<t;S++)O.push(e.getChannelData(S));for(let S=0;S<e.length;S++)for(let A=0;A<t;A++){const F=Math.max(-1,Math.min(1,O[A][S]));d.setInt16(y,F<0?F*32768:F*32767,!0),y+=2}return new Blob([h],{type:"audio/wav"})}async exportAudioWAVOffline(e=16,t=44100){try{return console.log("📦 Exporting master pattern as WAV using OfflineAudioContext..."),!this.masterPattern||this.masterPattern.trim()===""?{success:!1,error:"No master pattern to export"}:(this.strudelLoaded||await this.initializeStrudelAndSounds(),await this.exportAudioMediaRecorder(e))}catch(s){return console.error("❌ Error exporting WAV offline:",s),{success:!1,error:s.message}}}}const le=new Hpe;typeof window<"u"&&(window.soundManager=le);class Ype{constructor(){this.updateCallbacks=new Map,this.soundTrigger=null,this.controlSoundTimers=new Map,this.activeSliders=new Set,this.tempoSliderActivated=!1,this.tapTimes=[],this.tapTimeout=null,this.tapTimeoutDelay=2e3,this.initializeControls()}setSoundTrigger(e){this.soundTrigger=e}triggerControlSound(e){if(!this.soundTrigger)return;const t=this.controlSoundTimers.get(e);t&&clearTimeout(t);const s=setTimeout(()=>{this.controlSoundTimers.delete(e);const r=hs.getControlConfig(e);if(r&&r.type){const a=`control-${e}`;this.soundTrigger(a,r)}},100);this.controlSoundTimers.set(e,s)}initializeControls(){const e=document.getElementById("tempo-slider"),t=document.getElementById("tempo-value");if(e&&t){e.classList.add("inactive"),t.classList.add("inactive");const i=()=>this.markTempoSliderActive(e,t);e.addEventListener&&(e.addEventListener("pointerdown",i,{once:!0}),e.addEventListener("focus",i,{once:!0})),e.addEventListener("input",o=>{i();const l=parseInt(o.target.value);t.textContent=l,this.notify("tempo",l)})}const s=document.getElementById("tap-tempo-btn");s&&s.addEventListener("click",()=>{this.handleTapTempo(e,t,s)});const r=document.getElementById("key-select");r&&r.addEventListener("change",i=>{const o=i.target.value;o!==""&&this.notify("key",o)});const a=document.getElementById("scale-select");a&&a.addEventListener("change",i=>{const o=i.target.value;if(o===""){this.notify("scale","chromatic");return}this.notify("scale",o)})}markTempoSliderActive(e,t){this.tempoSliderActivated||(this.tempoSliderActivated=!0,e&&e.classList.remove("inactive"),t&&t.classList.remove("inactive"))}handleTapTempo(e,t,s){this.markTempoSliderActive(e,t);const r=Date.now();if(this.tapTimeout&&(clearTimeout(this.tapTimeout),this.tapTimeout=null),this.tapTimes.push(r),this.tapTimes.length>=3){const a=[];for(let l=1;l<this.tapTimes.length;l++)a.push(this.tapTimes[l]-this.tapTimes[l-1]);const i=a.reduce((l,c)=>l+c,0)/a.length;let o=Math.round(6e4/i);o=Math.max(60,Math.min(240,o)),e&&(e.value=o),t&&(t.textContent=o),this.notify("tempo",o),this.tapTimes.length>4&&(this.tapTimes=this.tapTimes.slice(-4))}else{const a=3-this.tapTimes.length;if(s){const i=s.textContent;s.textContent=`${a} more`,setTimeout(()=>{s.textContent=i},500)}}this.tapTimeout=setTimeout(()=>{this.tapTimes=[],this.tapTimeout=null,s&&(s.textContent="TAP")},this.tapTimeoutDelay)}onUpdate(e,t){this.updateCallbacks.has(e)||this.updateCallbacks.set(e,[]),this.updateCallbacks.get(e).push(t)}notify(e,t){const s=this.updateCallbacks.get(e);s&&s.forEach(r=>r(t))}updateStatus(e){const t=document.getElementById("status-text");t&&(t.textContent=e)}updateActiveElements(e){const t=document.getElementById("active-elements");t&&(e.length===0?t.textContent="None":t.textContent=e.join(", "))}setElementState(e,t){const s=e.querySelector(".element-indicator");s&&(s.className="element-indicator",t==="hover"?s.classList.add("hover"):t==="proximity"&&s.classList.add("proximity")),e.className="sound-element",t==="hover"?e.classList.add("is-hovered"):t==="proximity"&&e.classList.add("is-proximity")}}const gs=new Ype;var xD={};typeof BigInt>"u"&&(BigInt=function(n){if(isNaN(n))throw new Error("");return n});const tn=BigInt(0),Sn=BigInt(1),hf=BigInt(2),A2=BigInt(5),qa=BigInt(10),Kpe=2e3,St={s:Sn,n:tn,d:Sn};function Jl(n,e){try{n=BigInt(n)}catch{throw Nc()}return n*e}function ko(n){return typeof n=="bigint"?n:Math.floor(n)}function js(n,e){if(e===tn)throw WP();const t=Object.create(Rs.prototype);t.s=n<tn?-Sn:Sn,n=n<tn?-n:n;const s=zu(n,e);return t.n=n/s,t.d=e/s,t}function Bh(n){const e={};let t=n,s=hf,r=A2-Sn;for(;r<=t;){for(;t%s===tn;)t/=s,e[s]=(e[s]||tn)+Sn;r+=Sn+hf*s++}return t!==n?t>1&&(e[t]=(e[t]||tn)+Sn):e[n]=(e[n]||tn)+Sn,e}const $r=function(n,e){let t=tn,s=Sn,r=Sn;if(n!=null)if(e!==void 0){if(typeof n=="bigint")t=n;else{if(isNaN(n))throw Nc();if(n%1!==0)throw kD();t=BigInt(n)}if(typeof e=="bigint")s=e;else{if(isNaN(e))throw Nc();if(e%1!==0)throw kD();s=BigInt(e)}r=t*s}else if(typeof n=="object"){if("d"in n&&"n"in n)t=BigInt(n.n),s=BigInt(n.d),"s"in n&&(t*=BigInt(n.s));else if(0 in n)t=BigInt(n[0]),1 in n&&(s=BigInt(n[1]));else if(typeof n=="bigint")t=n;else throw Nc();r=t*s}else if(typeof n=="number"){if(isNaN(n))throw Nc();if(n<0&&(r=-Sn,n=-n),n%1===0)t=BigInt(n);else if(n>0){let a=1,i=0,o=1,l=1,c=1,u=1e7;for(n>=1&&(a=10**Math.floor(1+Math.log10(n)),n/=a);o<=u&&c<=u;){let h=(i+l)/(o+c);if(n===h){o+c<=u?(t=i+l,s=o+c):c>o?(t=l,s=c):(t=i,s=o);break}else n>h?(i+=l,o+=c):(l+=i,c+=o),o>u?(t=l,s=c):(t=i,s=o)}t=BigInt(t)*BigInt(a),s=BigInt(s)}}else if(typeof n=="string"){let a=0,i=tn,o=tn,l=tn,c=Sn,u=Sn,h=n.replace(/_/g,"").match(/\d+|./g);if(h===null)throw Nc();if(h[a]==="-"?(r=-Sn,a++):h[a]==="+"&&a++,h.length===a+1?o=Jl(h[a++],r):h[a+1]==="."||h[a]==="."?(h[a]!=="."&&(i=Jl(h[a++],r)),a++,(a+1===h.length||h[a+1]==="("&&h[a+3]===")"||h[a+1]==="'"&&h[a+3]==="'")&&(o=Jl(h[a],r),c=qa**BigInt(h[a].length),a++),(h[a]==="("&&h[a+2]===")"||h[a]==="'"&&h[a+2]==="'")&&(l=Jl(h[a+1],r),u=qa**BigInt(h[a+1].length)-Sn,a+=3)):h[a+1]==="/"||h[a+1]===":"?(o=Jl(h[a],r),c=Jl(h[a+2],Sn),a+=3):h[a+3]==="/"&&h[a+1]===" "&&(i=Jl(h[a],r),o=Jl(h[a+2],r),c=Jl(h[a+4],Sn),a+=5),h.length<=a)s=c*u,r=t=l+s*i+u*o;else throw Nc()}else if(typeof n=="bigint")t=n,r=n,s=Sn;else throw Nc();if(s===tn)throw WP();St.s=r<tn?-Sn:Sn,St.n=t<tn?-t:t,St.d=s<tn?-s:s};function Jpe(n,e,t){let s=Sn;for(;e>tn;n=n*n%t,e>>=Sn)e&Sn&&(s=s*n%t);return s}function eme(n,e){for(;e%hf===tn;e/=hf);for(;e%A2===tn;e/=A2);if(e===Sn)return tn;let t=qa%e,s=1;for(;t!==Sn;s++)if(t=t*qa%e,s>Kpe)return tn;return BigInt(s)}function tme(n,e,t){let s=Sn,r=Jpe(qa,t,e);for(let a=0;a<300;a++){if(s===r)return BigInt(a);s=s*qa%e,r=r*qa%e}return 0}function zu(n,e){if(!n)return e;if(!e)return n;for(;;){if(n%=e,!n)return e;if(e%=n,!e)return n}}function Rs(n,e){if($r(n,e),this instanceof Rs)n=zu(St.d,St.n),this.s=St.s,this.n=St.n/n,this.d=St.d/n;else return js(St.s*St.n,St.d)}var WP=function(){return new Error("Division by Zero")},Nc=function(){return new Error("Invalid argument")},kD=function(){return new Error("Parameters must be integer")};Rs.prototype={s:Sn,n:tn,d:Sn,abs:function(){return js(this.n,this.d)},neg:function(){return js(-this.s*this.n,this.d)},add:function(n,e){return $r(n,e),js(this.s*this.n*St.d+St.s*this.d*St.n,this.d*St.d)},sub:function(n,e){return $r(n,e),js(this.s*this.n*St.d-St.s*this.d*St.n,this.d*St.d)},mul:function(n,e){return $r(n,e),js(this.s*St.s*this.n*St.n,this.d*St.d)},div:function(n,e){return $r(n,e),js(this.s*St.s*this.n*St.d,this.d*St.n)},clone:function(){return js(this.s*this.n,this.d)},mod:function(n,e){if(n===void 0)return js(this.s*this.n%this.d,Sn);if($r(n,e),tn===St.n*this.d)throw WP();return js(this.s*(St.d*this.n)%(St.n*this.d),St.d*this.d)},gcd:function(n,e){return $r(n,e),js(zu(St.n,this.n)*zu(St.d,this.d),St.d*this.d)},lcm:function(n,e){return $r(n,e),St.n===tn&&this.n===tn?js(tn,Sn):js(St.n*this.n,zu(St.n,this.n)*zu(St.d,this.d))},inverse:function(){return js(this.s*this.d,this.n)},pow:function(n,e){if($r(n,e),St.d===Sn)return St.s<tn?js((this.s*this.d)**St.n,this.n**St.n):js((this.s*this.n)**St.n,this.d**St.n);if(this.s<tn)return null;let t=Bh(this.n),s=Bh(this.d),r=Sn,a=Sn;for(let i in t)if(i!=="1"){if(i==="0"){r=tn;break}if(t[i]*=St.n,t[i]%St.d===tn)t[i]/=St.d;else return null;r*=BigInt(i)**t[i]}for(let i in s)if(i!=="1"){if(s[i]*=St.n,s[i]%St.d===tn)s[i]/=St.d;else return null;a*=BigInt(i)**s[i]}return St.s<tn?js(a,r):js(r,a)},log:function(n,e){if($r(n,e),this.s<=tn||St.s<=tn)return null;const t={},s=Bh(St.n),r=Bh(St.d),a=Bh(this.n),i=Bh(this.d);for(const c in r)s[c]=(s[c]||tn)-r[c];for(const c in i)a[c]=(a[c]||tn)-i[c];for(const c in s)c!=="1"&&(t[c]=!0);for(const c in a)c!=="1"&&(t[c]=!0);let o=null,l=null;for(const c in t){const u=s[c]||tn,h=a[c]||tn;if(u===tn){if(h!==tn)return null;continue}let d=h,m=u;const y=zu(d,m);if(d/=y,m/=y,o===null&&l===null)o=d,l=m;else if(d*l!==o*m)return null}return o!==null&&l!==null?js(o,l):null},equals:function(n,e){return $r(n,e),this.s*this.n*St.d===St.s*St.n*this.d},lt:function(n,e){return $r(n,e),this.s*this.n*St.d<St.s*St.n*this.d},lte:function(n,e){return $r(n,e),this.s*this.n*St.d<=St.s*St.n*this.d},gt:function(n,e){return $r(n,e),this.s*this.n*St.d>St.s*St.n*this.d},gte:function(n,e){return $r(n,e),this.s*this.n*St.d>=St.s*St.n*this.d},compare:function(n,e){$r(n,e);let t=this.s*this.n*St.d-St.s*St.n*this.d;return(tn<t)-(t<tn)},ceil:function(n){return n=qa**BigInt(n||0),js(ko(this.s*n*this.n/this.d)+(n*this.n%this.d>tn&&this.s>=tn?Sn:tn),n)},floor:function(n){return n=qa**BigInt(n||0),js(ko(this.s*n*this.n/this.d)-(n*this.n%this.d>tn&&this.s<tn?Sn:tn),n)},round:function(n){return n=qa**BigInt(n||0),js(ko(this.s*n*this.n/this.d)+this.s*((this.s>=tn?Sn:tn)+hf*(n*this.n%this.d)>this.d?Sn:tn),n)},roundTo:function(n,e){$r(n,e);const t=this.n*St.d,s=this.d*St.n,r=t%s;let a=ko(t/s);return r+r>=s&&a++,js(this.s*a*St.n,St.d)},divisible:function(n,e){return $r(n,e),!(!(St.n*this.d)||this.n*St.d%(St.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(n){let e=this.n,t=this.d;n=n||15;let s=eme(e,t),r=tme(e,t,s),a=this.s<tn?"-":"";if(a+=ko(e/t),e%=t,e*=qa,e&&(a+="."),s){for(let i=r;i--;)a+=ko(e/t),e%=t,e*=qa;a+="(";for(let i=s;i--;)a+=ko(e/t),e%=t,e*=qa;a+=")"}else for(let i=n;e&&i--;)a+=ko(e/t),e%=t,e*=qa;return a},toFraction:function(n){let e=this.n,t=this.d,s=this.s<tn?"-":"";if(t===Sn)s+=e;else{let r=ko(e/t);n&&r>tn&&(s+=r,s+=" ",e%=t),s+=e,s+="/",s+=t}return s},toLatex:function(n){let e=this.n,t=this.d,s=this.s<tn?"-":"";if(t===Sn)s+=e;else{let r=ko(e/t);n&&r>tn&&(s+=r,e%=t),s+="\\frac{",s+=e,s+="}{",s+=t,s+="}"}return s},toContinued:function(){let n=this.n,e=this.d,t=[];do{t.push(ko(n/e));let s=n%e;n=e,e=s}while(n!==Sn);return t},simplify:function(n){const e=BigInt(1/(n||.001)|0),t=this.abs(),s=t.toContinued();for(let r=1;r<s.length;r++){let a=js(s[r-1],Sn);for(let o=r-2;o>=0;o--)a=a.inverse().add(s[o]);let i=a.sub(t);if(i.n*e<i.d)return a.mul(this.s)}return this}};const GP="strudel.log";let nme=1e3,SD,CD;function XP(n,e="cyclist"){ka(`[${e}] error: ${n.message}`)}function ka(n,e,t={}){let s=performance.now();SD===n&&s-CD<nme||(SD=n,CD=s,console.log(`%c${n}`,"background-color: black;color:white;border-radius:15px"),typeof document<"u"&&typeof CustomEvent<"u"&&document.dispatchEvent(new CustomEvent(GP,{detail:{message:n,type:e,data:t}})))}ka.key=GP;const sme=n=>/^[a-gA-G][#bs]*[0-9]$/.test(n),bv=n=>/^[a-gA-G][#bsf]*[0-9]?$/.test(n),wN=n=>{var r;if(typeof n!="string")return[];const[e,t="",s]=((r=n.match(/^([a-gA-G])([#bsf]*)([0-9]*)$/))==null?void 0:r.slice(1))||[];return e?[e,t,s?Number(s):void 0]:[]},rme={c:0,d:2,e:4,f:5,g:7,a:9,b:11},ame={"#":1,b:-1,s:1,f:-1},Mh=(n,e=3)=>{const[t,s,r=e]=wN(n);if(!t)throw new Error('not a note: "'+n+'"');const a=rme[t.toLowerCase()],i=(s==null?void 0:s.split("").reduce((o,l)=>o+ame[l],0))||0;return(Number(r)+1)*12+a+i},Rd=n=>Math.pow(2,(n-69)/12)*440,HP=n=>12*Math.log(n/440)/Math.LN2+69,xN=(n,e)=>{if(typeof n!="object")throw new Error("valueToMidi: expected object value");let{freq:t,note:s}=n;if(typeof t=="number")return HP(t);if(typeof s=="string")return Mh(s);if(typeof s=="number")return s;if(!e)throw new Error("valueToMidi: expected freq or note to be set");return e},ime=(n,e)=>(n-e)*1e3,kN=n=>Rd(typeof n=="number"?n:Mh(n)),ome=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],lme=n=>{const e=Math.floor(n/12)-1;return ome[n%12]+e},ng=(n,e)=>(n%e+e)%e,SN=n=>n.reduce((e,t)=>e+t)/n.length;function CN(n,e=0){return isNaN(Number(n))?(ka(`"${n}" is not a number, falling back to ${e}`,"warning"),e):n}const cme=(n,e)=>ng(Math.round(CN(n??0,0)),e),ume=n=>{let{value:e,context:t}=n,s=e;if(typeof s=="object"&&!Array.isArray(s)&&(s=s.note||s.n||s.value,s===void 0))throw new Error(`cannot find a playable note for ${JSON.stringify(e)}`);if(typeof s=="number"&&t.type!=="frequency")s=Rd(n.value);else if(typeof s=="number"&&t.type==="frequency")s=n.value;else if(typeof s!="string"||!bv(s))throw new Error("not a note: "+JSON.stringify(s));return s},PN=n=>{let{value:e,context:t}=n;if(typeof e=="object")return e.freq?e.freq:kN(e.note||e.n||e.value);if(typeof e=="number"&&t.type!=="frequency")e=Rd(n.value);else if(typeof e=="string"&&bv(e))e=Rd(Mh(n.value));else if(typeof e!="number")throw new Error("not a note or frequency: "+e);return e},AN=(n,e)=>n.slice(e).concat(n.slice(0,e)),EN=(...n)=>n.reduce((e,t)=>(...s)=>e(t(...s)),e=>e),hme=(...n)=>EN(...n.reverse()),pp=n=>n.filter(e=>e!=null),uc=n=>[].concat(...n),Yh=n=>n,dme=(n,e)=>n,YP=(n,e)=>Array.from({length:e-n+1},(t,s)=>s+n);function Mn(n,e,t=n.length){const s=function r(...a){if(a.length>=t)return n.apply(this,a);{const i=function(...o){return r.apply(this,a.concat(o))};return e&&e(i,a),i}};return e&&e(s,[]),s}function KP(n){const e=Number(n);if(!isNaN(e))return e;if(bv(n))return Mh(n);throw new Error(`cannot parse as numeral: "${n}"`)}function JP(n,e){return(...t)=>n(...t.map(e))}function wi(n){return JP(n,KP)}function MN(n){const e=Number(n);if(!isNaN(e))return e;const t={pi:Math.PI,w:1,h:.5,q:.25,e:.125,s:.0625,t:1/3,f:.2,x:1/6}[n];if(typeof t<"u")return t;throw new Error(`cannot parse as fractional: "${n}"`)}const pme=n=>JP(n,MN),eA=function(n,e){return[e.slice(0,n),e.slice(n)]},yv=(n,e,t)=>e.map((s,r)=>n(s,t[r])),DN=function(n){const e=[];for(let t=0;t<n.length-1;++t)e.push([n[t],n[t+1]]);return e},vv=(n,e,t)=>Math.min(Math.max(n,e),t),mme=["Do","Reb","Re","Mib","Mi","Fa","Solb","Sol","Lab","La","Sib","Si"],fme=["Sa","Re","Ga","Ma","Pa","Dha","Ni"],gme=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Hb","H"],bme=["Ni","Pab","Pa","Voub","Vou","Ga","Dib","Di","Keb","Ke","Zob","Zo"],yme=["I","Ro","Ha","Ni","Ho","He","To"],vme=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Ome=(n,e="letters")=>{const t=(e==="solfeggio"?mme:e==="indian"?fme:e==="german"?gme:e==="byzantine"?bme:e==="japanese"?yme:vme)[n%12],s=Math.floor(n/12)-1;return t+s};function wme(n){var e={};return n.filter(function(t){return e.hasOwn(t)?!1:e[t]=!0})}function xme(n){return n.sort().filter(function(e,t,s){return!t||e!=s[t-1]})}function TN(n){return n.sort((e,t)=>e.compare(t)).filter(function(e,t,s){return!t||e.ne(s[t-1])})}function BN(n){const e=new TextEncoder().encode(n);return btoa(String.fromCharCode(...e))}function FN(n){const e=new Uint8Array(atob(n).split("").map(t=>t.charCodeAt(0)));return new TextDecoder().decode(e)}function kme(n){return encodeURIComponent(BN(n))}function Sme(n){return FN(decodeURIComponent(n))}function $N(n,e){return Array.isArray(n)?n.map(e):Object.fromEntries(Object.entries(n).map(([t,s],r)=>[t,e(s,t,r)]))}function E2(n,e){return n/e}class NN{constructor({getTargetClockTime:e=Pme,weight:t=16,offsetDelta:s=.005,checkAfterTime:r=2,resetAfterTime:a=8}){this.offsetTime,this.timeAtPrevOffsetSample,this.prevOffsetTimes=[],this.getTargetClockTime=e,this.weight=t,this.offsetDelta=s,this.checkAfterTime=r,this.resetAfterTime=a,this.reset=()=>{this.prevOffsetTimes=[],this.offsetTime=null,this.timeAtPrevOffsetSample=null}}calculateOffset(e){const t=this.getTargetClockTime(),s=t-this.timeAtPrevOffsetSample,r=t-e;if(s>this.resetAfterTime&&this.reset(),this.offsetTime==null&&(this.offsetTime=r),this.prevOffsetTimes.push(r),this.prevOffsetTimes.length>this.weight&&this.prevOffsetTimes.shift(),this.timeAtPrevOffsetSample==null||s>this.checkAfterTime){this.timeAtPrevOffsetSample=t;const a=SN(this.prevOffsetTimes);Math.abs(a-this.offsetTime)>this.offsetDelta&&(this.offsetTime=a)}return this.offsetTime}calculateTimestamp(e,t){return this.calculateOffset(e)+t}}function Cme(){return performance.now()*.001}function Pme(){return Date.now()*.001}const _N=new Map([["control","Control"],["ctrl","Control"],["alt","Alt"],["shift","Shift"],["down","ArrowDown"],["up","ArrowUp"],["left","ArrowLeft"],["right","ArrowRight"]]);let jp;function RN(){if(jp==null){if(typeof window>"u")return;jp={},window.addEventListener("keydown",n=>{jp[n.key]=!0}),window.addEventListener("keyup",n=>{jp[n.key]=!1})}return{...jp}}function tA(n,e=!1){return typeof n=="object"?e?JSON.stringify(n).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(n):n}Rs.prototype.sam=function(){return this.floor()};Rs.prototype.nextSam=function(){return this.sam().add(1)};Rs.prototype.wholeCycle=function(){return new or(this.sam(),this.nextSam())};Rs.prototype.cyclePos=function(){return this.sub(this.sam())};Rs.prototype.lt=function(n){return this.compare(n)<0};Rs.prototype.gt=function(n){return this.compare(n)>0};Rs.prototype.lte=function(n){return this.compare(n)<=0};Rs.prototype.gte=function(n){return this.compare(n)>=0};Rs.prototype.eq=function(n){return this.compare(n)==0};Rs.prototype.ne=function(n){return this.compare(n)!=0};Rs.prototype.max=function(n){return this.gt(n)?this:n};Rs.prototype.maximum=function(...n){return n=n.map(e=>new Rs(e)),n.reduce((e,t)=>t.max(e),this)};Rs.prototype.min=function(n){return this.lt(n)?this:n};Rs.prototype.mulmaybe=function(n){return n!==void 0?this.mul(n):void 0};Rs.prototype.divmaybe=function(n){return n!==void 0?this.div(n):void 0};Rs.prototype.addmaybe=function(n){return n!==void 0?this.add(n):void 0};Rs.prototype.submaybe=function(n){return n!==void 0?this.sub(n):void 0};Rs.prototype.show=function(){return this.s*this.n+"/"+this.d};Rs.prototype.or=function(n){return this.eq(0)?n:this};const dt=n=>Rs(n),Ame=(...n)=>{if(n=pp(n),n.length!==0)return n.reduce((e,t)=>e.gcd(t),dt(1))},Lo=(...n)=>{if(n=pp(n),n.length===0)return;const e=n.pop();return n.reduce((t,s)=>t===void 0||s===void 0?void 0:t.lcm(s),e)};dt._original=Rs;class or{constructor(e,t){this.begin=dt(e),this.end=dt(t)}get spanCycles(){const e=[];var t=this.begin;const s=this.end,r=s.sam();if(t.equals(s))return[new or(t,s)];for(;s.gt(t);){if(t.sam().equals(r)){e.push(new or(t,this.end));break}const a=t.nextSam();e.push(new or(t,a)),t=a}return e}get duration(){return this.end.sub(this.begin)}cycleArc(){const e=this.begin.cyclePos(),t=e.add(this.duration);return new or(e,t)}withTime(e){return new or(e(this.begin),e(this.end))}withEnd(e){return new or(this.begin,e(this.end))}withCycle(e){const t=this.begin.sam(),s=t.add(e(this.begin.sub(t))),r=t.add(e(this.end.sub(t)));return new or(s,r)}intersection(e){const t=this.begin.max(e.begin),s=this.end.min(e.end);if(!t.gt(s)&&!(t.equals(s)&&(t.equals(this.end)&&this.begin.lt(this.end)||t.equals(e.end)&&e.begin.lt(e.end))))return new or(t,s)}intersection_e(e){const t=this.intersection(e);if(t==null)throw"TimeSpans do not intersect";return t}midpoint(){return this.begin.add(this.duration.div(dt(2)))}equals(e){return this.begin.equals(e.begin)&&this.end.equals(e.end)}show(){return this.begin.show()+" → "+this.end.show()}}class tr{constructor(e,t,s,r={},a=!1){this.whole=e,this.part=t,this.value=s,this.context=r,this.stateful=a,a&&console.assert(typeof this.value=="function","Stateful values must be functions")}get duration(){var t,s;let e;return typeof((t=this.value)==null?void 0:t.duration)=="number"?e=dt(this.value.duration):e=this.whole.end.sub(this.whole.begin),typeof((s=this.value)==null?void 0:s.clip)=="number"?e.mul(this.value.clip):e}get endClipped(){return this.whole.begin.add(this.duration)}isActive(e){return this.whole.begin<=e&&this.endClipped>=e}isInPast(e){return e>this.endClipped}isInNearPast(e,t){return t-e<=this.endClipped}isInFuture(e){return e<this.whole.begin}isInNearFuture(e,t){return t<this.whole.begin&&t>this.whole.begin-e}isWithinTime(e,t){return this.whole.begin<=t&&this.endClipped>=e}wholeOrPart(){return this.whole?this.whole:this.part}withSpan(e){const t=this.whole?e(this.whole):void 0;return new tr(t,e(this.part),this.value,this.context)}withValue(e){return new tr(this.whole,this.part,e(this.value),this.context)}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}hasTag(e){var t;return(t=this.context.tags)==null?void 0:t.includes(e)}resolveState(e){if(this.stateful&&this.hasOnset()){console.log("stateful");const t=this.value,[s,r]=t(e);return[s,new tr(this.whole,this.part,r,this.context,!1)]}return[e,this]}spanEquals(e){return this.whole==null&&e.whole==null||this.whole.equals(e.whole)}equals(e){return this.spanEquals(e)&&this.part.equals(e.part)&&this.value===e.value}show(e=!1){const t=typeof this.value=="object"?e?JSON.stringify(this.value).slice(1,-1).replaceAll('"',"").replaceAll(","," "):JSON.stringify(this.value):this.value;var s="";if(this.whole==null)s="~"+this.part.show;else{var r=this.whole.begin.equals(this.part.begin)&&this.whole.end.equals(this.part.end);this.whole.begin.equals(this.part.begin)||(s=this.whole.begin.show()+" ⇜ "),r||(s+="("),s+=this.part.show(),r||(s+=")"),this.whole.end.equals(this.part.end)||(s+=" ⇝ "+this.whole.end.show())}return"[ "+s+" | "+t+" ]"}showWhole(e=!1){return`${this.whole==null?"~":this.whole.show()}: ${tA(this.value,e)}`}combineContext(e){const t=this;return{...t.context,...e.context,locations:(t.context.locations||[]).concat(e.context.locations||[])}}setContext(e){return new tr(this.whole,this.part,this.value,e)}ensureObjectValue(){if(typeof this.value!="object")throw new Error(`expected hap.value to be an object, but got "${this.value}". Hint: append .note() or .s() to the end`,"error")}}class Id{constructor(e,t={}){this.span=e,this.controls=t}setSpan(e){return new Id(e,this.controls)}withSpan(e){return this.setSpan(e(this.span))}setControls(e){return new Id(this.span,e)}}function Eme(n,e,t){if((e==null?void 0:e.value)!==void 0&&Object.keys(e).length===1)return ka("[warn]: Can't do arithmetic on control pattern."),n;const s=Object.keys(n).filter(r=>Object.keys(e).includes(r));return Object.assign({},n,e,Object.fromEntries(s.map(r=>[r,t(n[r],e[r])])))}Mn((n,e)=>n*e);Mn((n,e)=>e.map(n));function IN(n,e=60){let t=0,s=dt(0),r=[""],a="";for(;r[0].length<e;){const i=n.queryArc(t,t+1),o=i.filter(u=>u.hasOnset()).map(u=>u.duration),l=Ame(...o),c=l.inverse();r=r.map(u=>u+"|"),a+="|";for(let u=0;u<c;u++){const[h,d]=[s,s.add(l)],m=i.filter(O=>O.whole.begin.lte(h)&&O.whole.end.gte(d)),y=m.length-r.length;y>0&&(r=r.concat(Array(y).fill(a))),r=r.map((O,S)=>{const A=m[S];if(A){const F=A.whole.begin.eq(h)?""+A.value:"-";return O+F}return O+"."}),a+=".",s=s.add(l)}t++}return r.join(`
`)}let M2,Wo=!0;const Mme=function(n){Wo=!!n},LN=n=>M2=n;let mt=class Lr{constructor(e,t=void 0){Yl(this,"polyJoin",function(){const e=this;return e.fmap(t=>t.extend(e._steps.div(t._steps))).outerJoin()});this.query=e,this._Pattern=!0,this._steps=t}get _steps(){return this.__steps}set _steps(e){this.__steps=e===void 0?void 0:dt(e)}setSteps(e){return this._steps=e,this}withSteps(e){return Wo?new Lr(this.query,this._steps===void 0?void 0:e(this._steps)):this}get hasSteps(){return this._steps!==void 0}withValue(e){const t=new Lr(s=>this.query(s).map(r=>r.withValue(e)));return t._steps=this._steps,t}withState(e){return this.withHaps((t,s)=>(e(s),t))}fmap(e){return this.withValue(e)}appWhole(e,t){const s=this,r=function(a){const i=s.query(a),o=t.query(a),l=function(c,u){const h=c.part.intersection(u.part);if(h!=null)return new tr(e(c.whole,u.whole),h,c.value(u.value),u.combineContext(c))};return uc(i.map(c=>pp(o.map(u=>l(c,u)))))};return new Lr(r)}appBoth(e){const t=this,s=function(a,i){if(!(a==null||i==null))return a.intersection_e(i)},r=t.appWhole(s,e);return Wo&&(r._steps=Lo(e._steps,t._steps)),r}appLeft(e){const t=this,s=function(a){const i=[];for(const o of t.query(a)){const l=e.query(a.setSpan(o.wholeOrPart()));for(const c of l){const u=o.whole,h=o.part.intersection(c.part);if(h){const d=o.value(c.value),m=c.combineContext(o),y=new tr(u,h,d,m);i.push(y)}}}return i},r=new Lr(s);return r._steps=this._steps,r}appRight(e){const t=this,s=function(a){const i=[];for(const o of e.query(a)){const l=t.query(a.setSpan(o.wholeOrPart()));for(const c of l){const u=o.whole,h=c.part.intersection(o.part);if(h){const d=c.value(o.value),m=o.combineContext(c),y=new tr(u,h,d,m);i.push(y)}}}return i},r=new Lr(s);return r._steps=e._steps,r}bindWhole(e,t){const s=this,r=function(a){const i=function(l,c){return new tr(e(l.whole,c.whole),c.part,c.value,Object.assign({},l.context,c.context,{locations:(l.context.locations||[]).concat(c.context.locations||[])}))},o=function(l){return t(l.value).query(a.setSpan(l.part)).map(c=>i(l,c))};return uc(s.query(a).map(l=>o(l)))};return new Lr(r)}bind(e){const t=function(s,r){if(!(s==null||r==null))return s.intersection_e(r)};return this.bindWhole(t,e)}join(){return this.bind(Yh)}outerBind(e){return this.bindWhole(t=>t,e).setSteps(this._steps)}outerJoin(){return this.outerBind(Yh)}innerBind(e){return this.bindWhole((t,s)=>s,e)}innerJoin(){return this.innerBind(Yh)}resetJoin(e=!1){const t=this;return new Lr(s=>t.discreteOnly().query(s).map(r=>r.value.late(e?r.whole.begin:r.whole.begin.cyclePos()).query(s).map(a=>new tr(a.whole?a.whole.intersection(r.whole):void 0,a.part.intersection(r.part),a.value).setContext(r.combineContext(a))).filter(a=>a.part)).flat())}restartJoin(){return this.resetJoin(!0)}squeezeJoin(){const e=this;function t(s){const r=e.discreteOnly().query(s);function a(i){const o=i.value._focusSpan(i.wholeOrPart()).query(s.setSpan(i.part));function l(c,u){let h;if(u.whole&&c.whole&&(h=u.whole.intersection(c.whole),!h))return;const d=u.part.intersection(c.part);if(!d)return;const m=u.combineContext(c);return new tr(h,d,u.value,m)}return o.map(c=>l(i,c))}return uc(r.map(a)).filter(i=>i)}return new Lr(t)}squeezeBind(e){return this.fmap(e).squeezeJoin()}polyBind(e){return this.fmap(e).polyJoin()}queryArc(e,t,s={}){try{return this.query(new Id(new or(e,t),s))}catch(r){return ka(`[query]: ${r.message}`,"error"),[]}}splitQueries(){const e=this,t=s=>uc(s.span.spanCycles.map(r=>e.query(s.setSpan(r))));return new Lr(t)}withQuerySpan(e){return new Lr(t=>this.query(t.withSpan(e)))}withQuerySpanMaybe(e){const t=this;return new Lr(s=>{const r=s.withSpan(e);return r.span?t.query(r):[]})}withQueryTime(e){return new Lr(t=>this.query(t.withSpan(s=>s.withTime(e))))}withHapSpan(e){return new Lr(t=>this.query(t).map(s=>s.withSpan(e)))}withHapTime(e){return this.withHapSpan(t=>t.withTime(e))}withHaps(e){const t=new Lr(s=>e(this.query(s),s));return t._steps=this._steps,t}withHap(e){return this.withHaps(t=>t.map(e))}setContext(e){return this.withHap(t=>t.setContext(e))}withContext(e){const t=this.withHap(s=>s.setContext(e(s.context)));return this.__pure!==void 0&&(t.__pure=this.__pure,t.__pure_loc=this.__pure_loc),t}stripContext(){return this.withHap(e=>e.setContext({}))}withLoc(e,t){const s={start:e,end:t},r=this.withContext(a=>{const i=(a.locations||[]).concat([s]);return{...a,locations:i}});return this.__pure&&(r.__pure=this.__pure,r.__pure_loc=s),r}filterHaps(e){return new Lr(t=>this.query(t).filter(e))}filterValues(e){return new Lr(t=>this.query(t).filter(s=>e(s.value))).setSteps(this._steps)}removeUndefineds(){return this.filterValues(e=>e!=null)}onsetsOnly(){return this.filterHaps(e=>e.hasOnset())}discreteOnly(){return this.filterHaps(e=>e.whole)}defragmentHaps(){return this.discreteOnly().withHaps(e=>{const t=[];for(var s=0;s<e.length;++s){for(var r=!0,a=e[s];r;){const l=JSON.stringify(e[s].value);for(var i=!1,o=s+1;o<e.length;o++){const c=e[o];if(a.whole.equals(c.whole)){if(a.part.begin.eq(c.part.end)){if(l===JSON.stringify(c.value)){a=new tr(a.whole,new or(c.part.begin,a.part.end),a.value),e.splice(o,1),i=!0;break}}else if(c.part.begin.eq(a.part.end)&&l==JSON.stringify(c.value)){a=new tr(a.whole,new or(a.part.begin,c.part.end),a.value),e.splice(o,1),i=!0;break}}}r=i}t.push(a)}return t})}firstCycle(e=!1){var t=this;return e||(t=t.stripContext()),t.query(new Id(new or(dt(0),dt(1))))}get firstCycleValues(){return this.firstCycle().map(e=>e.value)}get showFirstCycle(){return this.firstCycle().map(e=>`${e.value}: ${e.whole.begin.toFraction()} - ${e.whole.end.toFraction()}`)}sortHapsByPart(){return this.withHaps(e=>e.sort((t,s)=>t.part.begin.sub(s.part.begin).or(t.part.end.sub(s.part.end)).or(t.whole.begin.sub(s.whole.begin).or(t.whole.end.sub(s.whole.end)))))}asNumber(){return this.fmap(KP)}_opIn(e,t){return this.fmap(t).appLeft(bt(e))}_opOut(e,t){return this.fmap(t).appRight(bt(e))}_opMix(e,t){return this.fmap(t).appBoth(bt(e))}_opSqueeze(e,t){const s=bt(e);return this.fmap(r=>s.fmap(a=>t(r)(a))).squeezeJoin()}_opSqueezeOut(e,t){const s=this;return bt(e).fmap(r=>s.fmap(a=>t(a)(r))).squeezeJoin()}_opReset(e,t){return bt(e).fmap(s=>this.fmap(r=>t(r)(s))).resetJoin()}_opRestart(e,t){return bt(e).fmap(s=>this.fmap(r=>t(r)(s))).restartJoin()}_opPoly(e,t){const s=bt(e);return this.fmap(r=>s.fmap(a=>t(a)(r))).polyJoin()}layer(...e){return Xs(...e.map(t=>t(this)))}superimpose(...e){return this.stack(...e.map(t=>t(this)))}stack(...e){return Xs(this,...e)}sequence(...e){return Xo(this,...e)}seq(...e){return Xo(this,...e)}cat(...e){return zN(this,...e)}fastcat(...e){return ua(this,...e)}slowcat(...e){return Au(this,...e)}onTrigger(e,t=!0){return this.withHap(s=>s.setContext({...s.context,onTrigger:(...r)=>{var a,i;(i=(a=s.context).onTrigger)==null||i.call(a,...r),e(...r)},dominantTrigger:s.context.dominantTrigger||t}))}log(e=s=>`[hap] ${s.showWhole(!0)}`,t=s=>({hap:s})){return this.onTrigger((...s)=>{ka(e(...s),void 0,t(...s))},!1)}logValues(e=t=>`[hap] ${tA(t,!0)}`){return this.log(t=>e(t.value))}drawLine(){return console.log(IN(this)),this}unjoin(e,t=Yh){return e.withHap(s=>s.withValue(r=>r?t(this.ribbon(s.whole.begin,s.whole.duration)):this))}into(e,t){return this.unjoin(e,t).innerJoin()}};function Dme(n,e){let t=[];return e.forEach(s=>{const r=t.findIndex(([a])=>n(s,a));r===-1?t.push([s]):t[r].push(s)}),t}const Tme=(n,e)=>n.spanEquals(e);mt.prototype.collect=function(){return this.withHaps(n=>Dme(Tme,n).map(e=>new tr(e[0].whole,e[0].part,e,{})))};const Bme=ze("arpWith",(n,e)=>e.collect().fmap(t=>bt(n(t))).innerJoin().withHap(t=>new tr(t.whole,t.part,t.value.value,t.combineContext(t.value)))),Fme=ze("arp",(n,e)=>e.arpWith(t=>bt(n).fmap(s=>t[s%t.length])),!1);function Gg(n){return!Array.isArray(n)&&typeof n=="object"}function $me(n,e,t){return Gg(n)||Gg(e)?(Gg(n)||(n={value:n}),Gg(e)||(e={value:e}),Eme(n,e,t)):t(n,e)}(function(){const n={set:[(t,s)=>s],keep:[t=>t],keepif:[(t,s)=>s?t:void 0],add:[wi((t,s)=>t+s)],sub:[wi((t,s)=>t-s)],mul:[wi((t,s)=>t*s)],div:[wi((t,s)=>t/s)],mod:[wi(ng)],pow:[wi(Math.pow)],log2:[wi(Math.log2)],band:[wi((t,s)=>t&s)],bor:[wi((t,s)=>t|s)],bxor:[wi((t,s)=>t^s)],blshift:[wi((t,s)=>t<<s)],brshift:[wi((t,s)=>t>>s)],lt:[(t,s)=>t<s],gt:[(t,s)=>t>s],lte:[(t,s)=>t<=s],gte:[(t,s)=>t>=s],eq:[(t,s)=>t==s],eqt:[(t,s)=>t===s],ne:[(t,s)=>t!=s],net:[(t,s)=>t!==s],and:[(t,s)=>t&&s],or:[(t,s)=>t||s],func:[(t,s)=>s(t)]},e=["In","Out","Mix","Squeeze","SqueezeOut","Reset","Restart","Poly"];for(const[t,[s,r]]of Object.entries(n)){mt.prototype["_"+t]=function(a){return this.fmap(i=>s(i,a))},Object.defineProperty(mt.prototype,t,{get:function(){const a=this,i=(...o)=>a[t].in(...o);for(const o of e)i[o.toLowerCase()]=function(...l){var c=a;l=Xo(l),r&&(c=r(c),l=r(l));var u;return t==="keepif"?(u=c["_op"+o](l,h=>d=>s(h,d)),u=u.removeUndefineds()):u=c["_op"+o](l,h=>d=>$me(h,d,s)),u};return i.squeezein=i.squeeze,i}});for(const a of e)mt.prototype[a.toLowerCase()]=function(...i){return this.set[a.toLowerCase()](i)}}mt.prototype.struct=function(...t){return this.keepif.out(...t)},mt.prototype.structAll=function(...t){return this.keep.out(...t)},mt.prototype.mask=function(...t){return this.keepif.in(...t)},mt.prototype.maskAll=function(...t){return this.keep.in(...t)},mt.prototype.reset=function(...t){return this.keepif.reset(...t)},mt.prototype.resetAll=function(...t){return this.keep.reset(...t)},mt.prototype.restart=function(...t){return this.keepif.restart(...t)},mt.prototype.restartAll=function(...t){return this.keep.restart(...t)}})();const Nme=Xs,_me=Xs,Rme=wv,mp=n=>new mt(()=>[],n),xs=mp(1),Go=mp(0);function Cr(n){function e(s){return s.span.spanCycles.map(r=>new tr(dt(r.begin).wholeCycle(),r,n))}const t=new mt(e,1);return t.__pure=n,t}function Ov(n){return n instanceof mt||(n==null?void 0:n._Pattern)}function bt(n){return Ov(n)?n:M2&&typeof n=="string"?M2(n):Cr(n)}function QN(n){let e=Cr([]);for(const t of n)e=e.bind(s=>t.fmap(r=>s.concat([r])));return e}function Xs(...n){n=n.map(s=>Array.isArray(s)?Xo(...s):bt(s));const e=s=>uc(n.map(r=>r.query(s))),t=new mt(e);return Wo&&(t._steps=Lo(...n.map(s=>s._steps))),t}function nA(n,e){if(e=e.map(a=>Array.isArray(a)?Xo(...a):bt(a)),e.length===0)return xs;if(e.length===1)return e[0];const[t,...s]=e.map(a=>a._steps),r=Wo?t.maximum(...s):void 0;return Xs(...n(r,e))}function jN(...n){return nA((e,t)=>t.map(s=>s._steps.eq(e)?s:li(s,mp(e.sub(s._steps)))),n)}function VN(...n){return nA((e,t)=>t.map(s=>s._steps.eq(e)?s:li(mp(e.sub(s._steps)),s)),n)}function ZN(...n){return nA((e,t)=>t.map(s=>{if(s._steps.eq(e))return s;const r=mp(e.sub(s._steps).div(2));return li(r,s,r)}),n)}function Ime(n,...e){const[t,...s]=e.map(i=>i._steps),r=t.maximum(...s),a={centre:ZN,left:jN,right:VN,expand:Xs,repeat:(...i)=>wv(...i).steps(r)};return n.inhabit(a).fmap(i=>i(...e)).innerJoin().setSteps(r)}function Au(...n){if(n=n.map(s=>Array.isArray(s)?ua(...s):bt(s)),n.length==1)return n[0];const e=function(s){const r=s.span,a=ng(r.begin.sam(),n.length),i=n[a];if(!i)return[];const o=r.begin.floor().sub(r.begin.div(n.length).floor());return i.withHapTime(l=>l.add(o)).query(s.setSpan(r.withTime(l=>l.sub(o))))},t=Wo?Lo(...n.map(s=>s._steps)):void 0;return new mt(e).splitQueries().setSteps(t)}function sA(...n){n=n.map(bt);const e=function(t){var r;const s=Math.floor(t.span.begin)%n.length;return((r=n[s])==null?void 0:r.query(t))||[]};return new mt(e).splitQueries()}function zN(...n){return Au(...n)}function Lme(...n){const e=n.reduce((t,[s])=>t+s,0);return n=n.map(([t,s])=>[t,s.fast(t)]),li(...n).slow(e)}function Qme(...n){let e=dt(0);for(let t of n)t.length==2&&t.unshift(e),e=t[1];return Xs(...n.map(([t,s,r])=>Cr(bt(r)).compress(dt(t).div(e),dt(s).div(e)))).slow(e).innerJoin()}function ua(...n){let e=Au(...n);return n.length>1&&(e=e._fast(n.length),e._steps=n.length),n.length==1&&n[0].__steps_source&&(n._steps=n[0]._steps),e}function Xo(...n){return ua(...n)}function qN(...n){return ua(...n)}function D2(n){return Array.isArray(n)?n.length==0?[xs,0]:n.length==1?D2(n[0]):[ua(...n.map(e=>D2(e)[0])),n.length]:[bt(n),1]}const jme=Mn((n,e)=>bt(e).mask(n)),Vme=Mn((n,e)=>bt(e).struct(n)),Zme=Mn((n,e)=>bt(e).superimpose(...n)),zme=Mn((n,e)=>bt(e).withValue(n)),qme=Mn((n,e)=>bt(e).bind(n)),Ume=Mn((n,e)=>bt(e).innerBind(n)),Wme=Mn((n,e)=>bt(e).outerBind(n)),Gme=Mn((n,e)=>bt(e).squeezeBind(n)),Xme=Mn((n,e)=>bt(e).stepBind(n)),Hme=Mn((n,e)=>bt(e).polyBind(n)),Yme=Mn((n,e)=>bt(e).set(n)),Kme=Mn((n,e)=>bt(e).keep(n)),Jme=Mn((n,e)=>bt(e).keepif(n)),efe=Mn((n,e)=>bt(e).add(n)),tfe=Mn((n,e)=>bt(e).sub(n)),nfe=Mn((n,e)=>bt(e).mul(n)),sfe=Mn((n,e)=>bt(e).div(n)),rfe=Mn((n,e)=>bt(e).mod(n)),afe=Mn((n,e)=>bt(e).pow(n)),ife=Mn((n,e)=>bt(e).band(n)),ofe=Mn((n,e)=>bt(e).bor(n)),lfe=Mn((n,e)=>bt(e).bxor(n)),cfe=Mn((n,e)=>bt(e).blshift(n)),ufe=Mn((n,e)=>bt(e).brshift(n)),hfe=Mn((n,e)=>bt(e).lt(n)),dfe=Mn((n,e)=>bt(e).gt(n)),pfe=Mn((n,e)=>bt(e).lte(n)),mfe=Mn((n,e)=>bt(e).gte(n)),ffe=Mn((n,e)=>bt(e).eq(n)),gfe=Mn((n,e)=>bt(e).eqt(n)),bfe=Mn((n,e)=>bt(e).ne(n)),yfe=Mn((n,e)=>bt(e).net(n)),vfe=Mn((n,e)=>bt(e).and(n)),Ofe=Mn((n,e)=>bt(e).or(n)),wfe=Mn((n,e)=>bt(e).func(n));function ze(n,e,t=!0,s=!1,r=a=>a.innerJoin()){if(Array.isArray(n)){const o={};for(const l of n)o[l]=ze(l,e,t,s,r);return o}const a=e.length;var i;return t?i=function(...o){o=o.map(bt);const l=o[o.length-1];let c;if(a===1)c=e(l);else{const u=o.slice(0,-1);if(u.every(h=>h.__pure!=null)){const h=u.map(m=>m.__pure),d=u.filter(m=>m.__pure_loc).map(m=>m.__pure_loc);c=e(...h,l),c=c.withContext(m=>{const y=(m.locations||[]).concat(d);return{...m,locations:y}})}else{const[h,...d]=u;let m=(...y)=>e(...y,l);m=Mn(m,null,a-1),c=r(d.reduce((y,O)=>y.appLeft(O),h.fmap(m)))}}return s&&(c._steps=l._steps),c}:i=function(...o){o=o.map(bt);const l=e(...o);return s&&(l._steps=o[o.length-1]._steps),l},mt.prototype[n]=function(...o){if(a===2&&o.length!==1)o=[Xo(...o)];else if(a!==o.length+1)throw new Error(`.${n}() expects ${a-1} inputs but got ${o.length}.`);return o=o.map(bt),i(...o,this)},a>1&&(mt.prototype["_"+n]=function(...o){const l=e(...o,this);return s&&l.setSteps(this._steps),l}),Mn(i,null,a)}function sg(n,e,t=!0,s=!1,r=a=>a.stepJoin()){return ze(n,e,t,s,r)}const xfe=ze("round",function(n){return n.asNumber().fmap(e=>Math.round(e))}),kfe=ze("floor",function(n){return n.asNumber().fmap(e=>Math.floor(e))}),Sfe=ze("ceil",function(n){return n.asNumber().fmap(e=>Math.ceil(e))}),Cfe=ze("toBipolar",function(n){return n.fmap(e=>e*2-1)}),Pfe=ze("fromBipolar",function(n){return n.fmap(e=>(e+1)/2)}),Afe=ze("range",function(n,e,t){return t.mul(e-n).add(n)}),Efe=ze("rangex",function(n,e,t){return t._range(Math.log(n),Math.log(e)).fmap(Math.exp)}),Mfe=ze("range2",function(n,e,t){return t.fromBipolar()._range(n,e)}),Dfe=ze("ratio",n=>n.fmap(e=>Array.isArray(e)?e.slice(1).reduce((t,s)=>t/s,e[0]):e)),Tfe=ze("compress",function(n,e,t){return n=dt(n),e=dt(e),n.gt(e)||n.gt(1)||e.gt(1)||n.lt(0)||e.lt(0)?xs:t._fastGap(dt(1).div(e.sub(n)))._late(n)}),{compressSpan:Bfe,compressspan:Ffe}=ze(["compressSpan","compressspan"],function(n,e){return e._compress(n.begin,n.end)}),{fastGap:$fe,fastgap:Nfe}=ze(["fastGap","fastgap"],function(n,e){const t=function(r){const a=r.begin.sam(),i=r.begin.sub(a).mul(n).min(1),o=r.end.sub(a).mul(n).min(1);if(!(i>=1))return new or(a.add(i),a.add(o))},s=function(r){const a=r.part.begin,i=r.part.end,o=a.sam(),l=a.sub(o).div(n).min(1),c=i.sub(o).div(n).min(1),u=new or(o.add(l),o.add(c)),h=r.whole?new or(u.begin.sub(a.sub(r.whole.begin).div(n)),u.end.add(r.whole.end.sub(i).div(n))):void 0;return new tr(h,u,r.value,r.context)};return e.withQuerySpanMaybe(t).withHap(s).splitQueries()}),_fe=ze("focus",function(n,e,t){return n=dt(n),e=dt(e),t._early(n.sam())._fast(dt(1).div(e.sub(n)))._late(n)}),{focusSpan:Rfe,focusspan:Ife}=ze(["focusSpan","focusspan"],function(n,e){return e._focus(n.begin,n.end)}),Lfe=ze("ply",function(n,e){const t=e.fmap(s=>Cr(s)._fast(n)).squeezeJoin();return Wo&&(t._steps=dt(n).mulmaybe(e._steps)),t}),{fast:Qfe,density:p5e}=ze(["fast","density"],function(n,e){return n===0?xs:(n=dt(n),e.withQueryTime(t=>t.mul(n)).withHapTime(t=>t.div(n)).setSteps(e._steps))},!0,!0),jfe=ze("hurry",function(n,e){return e._fast(n).mul(Cr({speed:n}))}),{slow:Vfe,sparsity:Zfe}=ze(["slow","sparsity"],function(n,e){return n===0?xs:e._fast(dt(1).div(n))}),zfe=ze("inside",function(n,e,t){return e(t._slow(n))._fast(n)}),qfe=ze("outside",function(n,e,t){return e(t._fast(n))._slow(n)}),Ufe=ze("lastOf",function(n,e,t){const s=Array(n-1).fill(t);return s.push(e(t)),sA(...s)}),{firstOf:Wfe,every:Gfe}=ze(["firstOf","every"],function(n,e,t){const s=Array(n-1).fill(t);return s.unshift(e(t)),sA(...s)}),Xfe=ze("apply",function(n,e){return n(e)}),Hfe=ze("cpm",function(n,e){return e._fast(n/60/1)}),Yfe=ze("early",function(n,e){return n=dt(n),e.withQueryTime(t=>t.add(n)).withHapTime(t=>t.sub(n))},!0,!0),UN=ze("late",function(n,e){return n=dt(n),e._early(dt(0).sub(n))},!0,!0),Kfe=ze("zoom",function(n,e,t){var a;if(e=dt(e),n=dt(n),n.gte(e))return Go;const s=e.sub(n),r=Wo?(a=t._steps)==null?void 0:a.mulmaybe(s):void 0;return t.withQuerySpan(i=>i.withCycle(o=>o.mul(s).add(n))).withHapSpan(i=>i.withCycle(o=>o.sub(n).div(s))).splitQueries().setSteps(r)}),{zoomArc:Jfe,zoomarc:ege}=ze(["zoomArc","zoomarc"],function(n,e){return e.zoom(n.begin,n.end)}),tge=ze("bite",(n,e,t)=>e.fmap(s=>r=>{const a=dt(s).div(r).mod(1),i=a.add(dt(1).div(r));return t.zoom(a,i)}).appLeft(n).squeezeJoin(),!1),nge=ze("linger",function(n,e){return n==0?xs:n<0?e._zoom(n.add(1),1)._slow(n):e._zoom(0,n)._slow(n)},!0,!0),{segment:sge,seg:rge}=ze(["segment","seg"],function(n,e){return e.struct(Cr(!0)._fast(n)).setSteps(n)}),age=ze("swingBy",(n,e,t)=>t.inside(e,UN(qN(0,n/2)))),ige=ze("swing",(n,e)=>e.swingBy(1/3,n)),{invert:oge,inv:lge}=ze(["invert","inv"],function(n){return n.fmap(e=>!e)},!0,!0),cge=ze("when",function(n,e,t){return n?e(t):t}),uge=ze("off",function(n,e,t){return Xs(t,e(t.late(n)))}),hge=ze("brak",function(n){return n.when(Au(!1,!0),e=>ua(e,xs)._late(.25))}),WN=ze("rev",function(n){const e=function(t){const s=t.span,r=s.begin.sam(),a=s.begin.nextSam(),i=function(o){const l=o.withTime(u=>r.add(a.sub(u))),c=l.begin;return l.begin=l.end,l.end=c,l};return n.query(t.setSpan(i(s))).map(o=>o.withSpan(i))};return new mt(e).splitQueries()},!1,!0),dge=ze("pressBy",function(n,e){return e.fmap(t=>Cr(t).compress(n,1)).squeezeJoin()}),pge=ze("press",function(n){return n._pressBy(.5)});mt.prototype.hush=function(){return xs};const mge=ze("palindrome",function(n){return n.lastOf(2,WN)},!0,!0),{juxBy:fge,juxby:gge}=ze(["juxBy","juxby"],function(n,e,t){n/=2;const s=function(i,o,l){return o in i?i[o]:l},r=t.withValue(i=>Object.assign({},i,{pan:s(i,"pan",.5)-n})),a=e(t.withValue(i=>Object.assign({},i,{pan:s(i,"pan",.5)+n})));return Xs(r,a).setSteps(Wo?Lo(r._steps,a._steps):void 0)}),bge=ze("jux",function(n,e){return e._juxBy(1,n,e)}),{echoWith:yge,echowith:vge,stutWith:Oge,stutwith:wge}=ze(["echoWith","echowith","stutWith","stutwith"],function(n,e,t,s){return Xs(...YP(0,n-1).map(r=>t(s.late(dt(e).mul(r)),r)))}),xge=ze("echo",function(n,e,t,s){return s._echoWith(n,e,(r,a)=>r.gain(Math.pow(t,a)))}),kge=ze("stut",function(n,e,t,s){return s._echoWith(n,t,(r,a)=>r.gain(Math.pow(e,a)))}),rA=function(n,e,t=!1){return n=dt(n),Au(...YP(0,n.sub(1)).map(s=>t?e.late(dt(s).div(n)):e.early(dt(s).div(n))))},Sge=ze("iter",function(n,e){return rA(n,e,!1)},!0,!0),{iterBack:Cge,iterback:Pge}=ze(["iterBack","iterback"],function(n,e){return rA(n,e,!0)},!0,!0),{repeatCycles:Age}=ze("repeatCycles",function(n,e){return new mt(function(t){const s=t.span.begin.sam(),r=s.div(n).sam(),a=s.sub(r);return t=t.withSpan(i=>i.withTime(o=>o.sub(a))),e.query(t).map(i=>i.withSpan(o=>o.withTime(l=>l.add(a))))}).splitQueries()},!0,!0),aA=function(n,e,t,s=!1,r=!1){const a=Array(n-1).fill(!1);a.unshift(!0);const i=rA(n,Xo(...a),!s);return r||(t=t.repeatCycles(n)),t.when(i,e)},{chunk:Ege,slowchunk:Mge,slowChunk:Dge}=ze(["chunk","slowchunk","slowChunk"],function(n,e,t){return aA(n,e,t,!1,!1)},!0,!0),{chunkBack:Tge,chunkback:Bge}=ze(["chunkBack","chunkback"],function(n,e,t){return aA(n,e,t,!0)},!0,!0),{fastchunk:Fge,fastChunk:$ge}=ze(["fastchunk","fastChunk"],function(n,e,t){return aA(n,e,t,!1,!0)},!0,!0),{chunkinto:Nge,chunkInto:_ge}=ze(["chunkinto","chunkInto"],function(n,e,t){return t.into(ua(!0,...Array(n-1).fill(!1))._iterback(n),e)}),{chunkbackinto:Rge,chunkBackInto:Ige}=ze(["chunkbackinto","chunkBackInto"],function(n,e,t){return t.into(ua(!0,...Array(n-1).fill(!1))._iter(n)._early(1),e)}),Lge=ze("bypass",function(n,e){return n=!!parseInt(n),n?xs:e},!0,!0),{ribbon:Qge,rib:jge}=ze(["ribbon","rib"],(n,e,t)=>t.early(n).restart(Cr(1).slow(e))),Vge=ze("hsla",(n,e,t,s,r)=>r.color(`hsla(${n}turn,${e*100}%,${t*100}%,${s})`)),Zge=ze("hsl",(n,e,t,s)=>s.color(`hsl(${n}turn,${e*100}%,${t*100}%)`));mt.prototype.tag=function(n){return this.withContext(e=>({...e,tags:(e.tags||[]).concat([n])}))};const zge=ze("filter",(n,e)=>e.withHaps(t=>t.filter(n))),qge=ze("filterWhen",(n,e)=>e.filter(t=>n(t.whole.begin))),Uge=ze("within",(n,e,t,s)=>Xs(t(s.filterWhen(r=>r.cyclePos()>=n&&r.cyclePos()<=e)),s.filterWhen(r=>r.cyclePos()<n||r.cyclePos()>e)));mt.prototype.stepJoin=function(){const n=this,e=li(...T2(B2(n.queryArc(0,1))))._steps,t=function(s){const r=n.early(s.span.begin.sam()).query(s.setSpan(new or(dt(0),dt(1))));return li(...T2(B2(r))).query(s)};return new mt(t,e)};mt.prototype.stepBind=function(n){return this.fmap(n).stepJoin()};function T2(n){const e=n.filter((a,i)=>i.hasSteps).reduce((a,i)=>a.add(i),dt(0)),t=pp(n.map((a,i)=>i._steps)).reduce((a,i)=>a.add(i),dt(0)),s=e.eq(0)?void 0:t.div(e);function r(a,i){return i._steps===void 0?[a.mulmaybe(s),i]:[i._steps,i]}return n.map(a=>r(...a))}function B2(n){const e=uc(n.map(s=>[s.part.begin,s.part.end])),t=TN([dt(0),dt(1),...e]);return DN(t).map(s=>[s[1].sub(s[0]),Xs(...GN(new or(...s),n).map(r=>r.value.withHap(a=>a.setContext(a.combineContext(r)))))])}function GN(n,e){return pp(e.map(t=>XN(n,t)))}function XN(n,e){const t=n.intersection(e.part);if(t!=null)return new tr(e.whole,t,e.value,e.context)}const HN=ze("pace",function(n,e){return e._steps===void 0?e:e._steps.eq(dt(0))?Go:e._fast(dt(n).div(e._steps)).setSteps(n)});function YN(n,...e){const t=e.map(r=>D2(r));if(t.length==0)return xs;n==0&&(n=t[0][1]);const s=[];for(const r of t)r[1]!=0&&(n==r[1]?s.push(r[0]):s.push(r[0]._fast(dt(n).div(dt(r[1])))));return Xs(...s)}function wv(...n){if(Array.isArray(n[0]))return YN(0,...n);if(n=n.filter(s=>s.hasSteps),n.length==0)return xs;const e=Lo(...n.map(s=>s._steps));if(e.eq(dt(0)))return Go;const t=Xs(...n.map(s=>s.pace(e)));return t._steps=e,t}function li(...n){if(n.length===0)return Go;const e=i=>Array.isArray(i)?i:[i._steps??1,i];if(n=n.map(e),n.find(i=>i[0]===void 0)){const i=n.map(l=>l[0]).filter(l=>l!==void 0);if(i.length===0)return ua(...n.map(l=>l[1]));if(i.length===n.length)return Go;const o=i.reduce((l,c)=>l.add(c),dt(0)).div(i.length);for(let l of n)l[0]===void 0&&(l[0]=o)}if(n.length==1)return bt(n[0][1]).withSteps(i=>n[0][0]);const t=n.map(i=>i[0]).reduce((i,o)=>i.add(o),dt(0));let s=dt(0);const r=[];for(const[i,o]of n){if(dt(i).eq(0))continue;const l=s.add(i);r.push(bt(o)._compress(s.div(t),l.div(t))),s=l}const a=Xs(...r);return a._steps=t,a}function KN(...n){n=n.map(r=>Array.isArray(r)?r.map(bt):[bt(r)]);const e=Lo(...n.map(r=>dt(r.length)));let t=[];for(let r=0;r<e;++r)t.push(...n.map(a=>a.length==0?xs:a[r%a.length]));t=t.filter(r=>r.hasSteps&&r._steps>0);const s=t.reduce((r,a)=>r.add(a._steps),dt(0));return t=li(...t),t._steps=s,t}const JN=sg("take",function(n,e){if(!e.hasSteps||e._steps.lte(0)||(n=dt(n),n.eq(0)))return Go;const t=n<0;t&&(n=n.abs());const s=n.div(e._steps);return s.lte(0)?Go:s.gte(1)?e:t?e.zoom(dt(1).sub(s),1):e.zoom(0,s)}),e_=sg("drop",function(n,e){return e.hasSteps?(n=dt(n),n.lt(0)?e.take(e._steps.add(n)):e.take(dt(0).sub(e._steps.sub(n)))):Go}),t_=sg("extend",function(n,e){return e.fast(n).expand(n)}),n_=sg("expand",function(n,e){return e.withSteps(t=>t.mul(dt(n)))}),s_=sg("contract",function(n,e){return e.withSteps(t=>t.div(dt(n)))});mt.prototype.shrinklist=function(n){const e=this;if(!e.hasSteps)return[e];let[t,s]=Array.isArray(n)?n:[n,e._steps];if(t=dt(t),s===0||t===0)return[e];const r=t>0,a=[];if(r){const i=dt(1).div(e._steps).mul(t);for(let o=0;o<s;++o){const l=i.mul(o);if(l.gt(1))break;a.push([l,1])}}else{t=dt(0).sub(t);const i=dt(1).div(e._steps).mul(t);for(let o=0;o<s;++o){const l=dt(1).sub(i.mul(o));if(l.lt(0))break;a.push([dt(0),l])}}return a.map(i=>e.zoom(...i))};const r_=(n,e)=>e.shrinklist(n),a_=ze("shrink",function(n,e){if(!e.hasSteps)return Go;const t=e.shrinklist(n),s=li(...t);return s._steps=t.reduce((r,a)=>r.add(a._steps),dt(0)),s},!0,!1,n=>n.stepJoin()),Wge=ze("grow",function(n,e){if(!e.hasSteps)return Go;const t=e.shrinklist(dt(0).sub(n));t.reverse();const s=li(...t);return s._steps=t.reduce((r,a)=>r.add(a._steps),dt(0)),s},!0,!1,n=>n.stepJoin()),i_=function(n,...e){return n.tour(...e)};mt.prototype.tour=function(...n){return li(...[].concat(...n.map((e,t)=>[...n.slice(0,n.length-t),this,...n.slice(n.length-t)]),this,...n))};const o_=function(...n){n=n.filter(s=>s.hasSteps);const e=Au(...n.map(s=>s._slow(s._steps))),t=Lo(...n.map(s=>s._steps));return e._fast(t).setSteps(t)},Gge=li,iA=li,Xge=li,Hge=KN,Yge=wv;mt.prototype.s_polymeter=mt.prototype.polymeter;const Kge=a_;mt.prototype.s_taper=mt.prototype.shrink;const Jge=r_;mt.prototype.s_taperlist=mt.prototype.shrinklist;const e0e=JN;mt.prototype.s_add=mt.prototype.take;const t0e=e_;mt.prototype.s_sub=mt.prototype.drop;const n0e=n_;mt.prototype.s_expand=mt.prototype.expand;const s0e=t_;mt.prototype.s_extend=mt.prototype.extend;const r0e=s_;mt.prototype.s_contract=mt.prototype.contract;const a0e=i_;mt.prototype.s_tour=mt.prototype.tour;const i0e=o_;mt.prototype.s_zip=mt.prototype.zip;const o0e=HN;mt.prototype.steps=mt.prototype.pace;const l0e=ze("chop",function(n,e){const t=Array.from({length:n},(a,i)=>i).map(a=>({begin:a/n,end:(a+1)/n})),s=function(a,i){if("begin"in a&&"end"in a&&a.begin!==void 0&&a.end!==void 0){const o=a.end-a.begin;i={begin:a.begin+i.begin*o,end:a.begin+i.end*o}}return Object.assign({},a,i)},r=function(a){return Xo(t.map(i=>s(a,i)))};return e.squeezeBind(r).setSteps(Wo?dt(n).mulmaybe(e._steps):void 0)}),c0e=ze("striate",function(n,e){const t=Array.from({length:n},(r,a)=>a).map(r=>({begin:r/n,end:(r+1)/n})),s=Au(...t);return e.set(s)._fast(n).setSteps(Wo?dt(n).mulmaybe(e._steps):void 0)}),l_=function(n,e,t=.5){return e.speed(1/n*t).unit("c").slow(n)},c_=ze("slice",function(n,e,t){return n.innerBind(s=>e.outerBind(r=>t.outerBind(a=>{a=a instanceof Object?a:{s:a};const i=Array.isArray(s)?s[r]:r/s,o=Array.isArray(s)?s[r+1]:(r+1)/s;return Cr({begin:i,end:o,_slices:s,...a})}))).setSteps(e._steps)},!1);mt.prototype.onTriggerTime=function(n){return this.onTrigger((e,t,s,r)=>{const a=r-t;window.setTimeout(()=>{n(e)},a*1e3)},!1)};const u0e=ze("splice",function(n,e,t){const s=c_(n,e,t);return new mt(r=>{const a=r.controls._cps||1;return s.query(r).map(i=>i.withValue(o=>({speed:a/o._slices/i.whole.duration*(o.speed||1),unit:"c",...o})))}).setSteps(e._steps)},!1),{loopAt:h0e,loopat:d0e}=ze(["loopAt","loopat"],function(n,e){const t=e._steps?e._steps.div(n):void 0;return new mt(s=>l_(n,e,s.controls._cps).query(s),t)}),p0e=ze("fit",n=>n.withHaps((e,t)=>e.map(s=>s.withValue(r=>{const a=("end"in r?r.end:1)-("begin"in r?r.begin:0);return{...r,speed:(t.controls._cps||1)/s.whole.duration*a,unit:"c"}})))),{loopAtCps:m0e,loopatcps:f0e}=ze(["loopAtCps","loopatcps"],function(n,e,t){return l_(n,t,e)}),u_=n=>Cr(1).withValue(()=>bt(n())).innerJoin();let PD=n=>n<.5?1:1-(n-.5)/.5,h_=(n,e,t)=>{e=bt(e),n=bt(n),t=bt(t);let s=e.fmap(a=>({gain:PD(a)})),r=e.fmap(a=>({gain:PD(1-a)}));return Xs(n.mul(s),t.mul(r))};mt.prototype.xfade=function(n,e){return h_(this,n,e)};const g0e=n=>(e,t,s)=>{e=dt(e).mod(t),t=dt(t);const r=e.div(t),a=e.add(1).div(t);return n(s.fmap(i=>Cr(i)._compress(r,a)))},{beat:b0e}=ze(["beat"],g0e(n=>n.innerJoin())),oA=(n,e,t)=>{t=dt(t);const s=dt(1).div(n.length),r=o=>{const l=[];for(const[c,u]of o.entries())u&&l.push([dt(c).div(o.length),u]);return l},a=yv(([o,l],[c,u])=>{const h=t.mul(c-o).add(o),d=h.add(s);return new or(h,d)},r(n),r(e));function i(o){const l=o.span.begin.sam(),c=o.span.cycleArc(),u=[];for(const h of a){const d=h.intersection(c);d!==void 0&&u.push(new tr(h.withTime(m=>m.add(l)),d.withTime(m=>m.add(l)),!0))}return u}return new mt(i).splitQueries()},y0e=(n,e,t)=>(n=bt(n),e=bt(e),t=bt(t),n.innerBind(s=>e.innerBind(r=>t.innerBind(a=>oA(s,r,a)))));function xv(n){let e=Array.isArray(n);n=e?n:[n];const t=n[0],s=a=>{let i;if(typeof a=="object"&&a.value!==void 0&&(i={...a},a=a.value,delete i.value),e&&Array.isArray(a)){const o=i||{};return a.forEach((l,c)=>{c<n.length&&(o[n[c]]=l)}),o}else return i?(i[t]=a,i):{[t]:a}},r=function(a,i){return i?typeof a>"u"?i.fmap(s):i.set(bt(a).withValue(s)):bt(a).withValue(s)};return mt.prototype[t]=function(a){return r(a,this)},r}const df=new Map;function d_(n){return df.has(n)}function ke(n,...e){const t=Array.isArray(n)?n[0]:n;let s={};return s[t]=xv(n),df.set(t,t),e.forEach(r=>{s[r]=s[t],df.set(r,t),mt.prototype[r]=mt.prototype[t]}),s}const{s:p_,sound:m_}=ke(["s","n","gain"],"sound"),{source:f_,src:g_}=ke("source","src"),{n:b_}=ke("n"),{note:y_}=ke(["note","n"]),{accelerate:v_}=ke("accelerate"),{velocity:O_}=ke("velocity"),{gain:w_}=ke("gain"),{postgain:x_}=ke("postgain"),{amp:k_}=ke("amp"),{attack:S_,att:C_}=ke("attack","att"),{fmh:P_}=ke(["fmh","fmi"],"fmh"),{fmi:A_,fm:E_}=ke(["fmi","fmh"],"fm"),{fmenv:M_}=ke("fmenv"),{fmattack:D_}=ke("fmattack"),{fmwave:T_}=ke("fmwave"),{fmdecay:B_}=ke("fmdecay"),{fmsustain:F_}=ke("fmsustain"),{fmrelease:$_}=ke("fmrelease"),{fmvelocity:N_}=ke("fmvelocity"),{bank:__}=ke("bank"),{analyze:R_}=ke("analyze"),{fft:I_}=ke("fft"),{decay:L_,dec:Q_}=ke("decay","dec"),{sustain:j_,sus:V_}=ke("sustain","sus"),{release:Z_,rel:z_}=ke("release","rel"),{hold:q_}=ke("hold"),{bandf:U_,bpf:W_,bp:G_}=ke(["bandf","bandq","bpenv"],"bpf","bp"),{bandq:X_,bpq:H_}=ke("bandq","bpq"),{begin:Y_}=ke("begin"),{end:K_}=ke("end"),{loop:J_}=ke("loop"),{loopBegin:eR,loopb:tR}=ke("loopBegin","loopb"),{loopEnd:nR,loope:sR}=ke("loopEnd","loope"),{crush:rR}=ke("crush"),{coarse:aR}=ke("coarse"),{tremolo:iR}=ke(["tremolo","tremolodepth","tremoloskew","tremolophase"],"trem"),{tremolosync:oR}=ke(["tremolosync","tremolodepth","tremoloskew","tremolophase"],"tremsync"),{tremolodepth:lR}=ke("tremolodepth","tremdepth"),{tremoloskew:cR}=ke("tremoloskew","tremskew"),{tremolophase:uR}=ke("tremolophase","tremphase"),{tremoloshape:hR}=ke("tremoloshape","tremshape"),{duck:dR}=ke("duckorbit","duck"),{duckdepth:pR}=ke("duckdepth"),{duckattack:mR}=ke("duckattack","duckatt"),{drive:fR}=ke("drive"),{byteBeatExpression:gR,bbexpr:bR}=ke("byteBeatExpression","bbexpr"),{byteBeatStartTime:yR,bbst:vR}=ke("byteBeatStartTime","bbst"),{channels:OR,ch:wR}=ke("channels","ch"),{pw:xR}=ke(["pw","pwrate","pwsweep"]),{pwrate:kR}=ke("pwrate"),{pwsweep:SR}=ke("pwsweep"),{phaserrate:CR,ph:PR,phaser:AR}=ke(["phaserrate","phaserdepth","phasercenter","phasersweep"],"ph","phaser"),{phasersweep:ER,phs:MR}=ke("phasersweep","phs"),{phasercenter:DR,phc:TR}=ke("phasercenter","phc"),{phaserdepth:BR,phd:FR,phasdp:$R}=ke("phaserdepth","phd","phasdp"),{channel:NR}=ke("channel"),{cut:_R}=ke("cut"),{cutoff:RR,ctf:IR,lpf:LR,lp:QR}=ke(["cutoff","resonance","lpenv"],"ctf","lpf","lp"),{lpenv:jR,lpe:VR}=ke("lpenv","lpe"),{hpenv:ZR,hpe:zR}=ke("hpenv","hpe"),{bpenv:qR,bpe:UR}=ke("bpenv","bpe"),{lpattack:WR,lpa:GR}=ke("lpattack","lpa"),{hpattack:XR,hpa:HR}=ke("hpattack","hpa"),{bpattack:YR,bpa:KR}=ke("bpattack","bpa"),{lpdecay:JR,lpd:eI}=ke("lpdecay","lpd"),{hpdecay:tI,hpd:nI}=ke("hpdecay","hpd"),{bpdecay:sI,bpd:rI}=ke("bpdecay","bpd"),{lpsustain:aI,lps:iI}=ke("lpsustain","lps"),{hpsustain:oI,hps:lI}=ke("hpsustain","hps"),{bpsustain:cI,bps:uI}=ke("bpsustain","bps"),{lprelease:hI,lpr:dI}=ke("lprelease","lpr"),{hprelease:pI,hpr:mI}=ke("hprelease","hpr"),{bprelease:fI,bpr:gI}=ke("bprelease","bpr"),{ftype:bI}=ke("ftype"),{fanchor:yI}=ke("fanchor"),{vib:vI,vibrato:OI,v:wI}=ke(["vib","vibmod"],"vibrato","v"),{noise:xI}=ke("noise"),{vibmod:kI,vmod:SI}=ke(["vibmod","vib"],"vmod"),{hcutoff:CI,hpf:PI,hp:AI}=ke(["hcutoff","hresonance","hpenv"],"hpf","hp"),{hresonance:EI,hpq:MI}=ke("hresonance","hpq"),{resonance:DI,lpq:TI}=ke("resonance","lpq"),{djf:BI}=ke("djf"),{delay:FI}=ke(["delay","delaytime","delayfeedback"]),{delayfeedback:$I,delayfb:NI,dfb:_I}=ke("delayfeedback","delayfb","dfb"),{delaytime:RI,delayt:II,dt:LI}=ke("delaytime","delayt","dt"),{delaysync:QI}=ke("delaysync"),{lock:jI}=ke("lock"),{detune:VI,det:ZI}=ke("detune","det"),{unison:zI}=ke("unison"),{spread:qI}=ke("spread"),{dry:UI}=ke("dry"),{fadeTime:WI,fadeOutTime:GI}=ke("fadeTime","fadeOutTime"),{fadeInTime:XI}=ke("fadeInTime"),{freq:HI}=ke("freq"),{pattack:YI,patt:KI}=ke("pattack","patt"),{pdecay:JI,pdec:eL}=ke("pdecay","pdec"),{psustain:tL,psus:nL}=ke("psustain","psus"),{prelease:sL,prel:rL}=ke("prelease","prel"),{penv:aL}=ke("penv"),{pcurve:iL}=ke("pcurve"),{panchor:oL}=ke("panchor"),{gate:lL,gat:cL}=ke("gate","gat"),{leslie:uL}=ke("leslie"),{lrate:hL}=ke("lrate"),{lsize:dL}=ke("lsize"),{activeLabel:pL}=ke("activeLabel"),{label:mL}=ke(["label","activeLabel"]),{degree:fL}=ke("degree"),{mtranspose:gL}=ke("mtranspose"),{ctranspose:bL}=ke("ctranspose"),{harmonic:yL}=ke("harmonic"),{stepsPerOctave:vL}=ke("stepsPerOctave"),{octaveR:OL}=ke("octaveR"),{nudge:wL}=ke("nudge"),{octave:xL}=ke("octave"),{orbit:kL}=ke("orbit"),{overgain:SL}=ke("overgain"),{overshape:CL}=ke("overshape"),{pan:PL}=ke("pan"),{panspan:AL}=ke("panspan"),{pansplay:EL}=ke("pansplay"),{panwidth:ML}=ke("panwidth"),{panorient:DL}=ke("panorient"),{rate:TL}=ke("rate"),{slide:BL}=ke("slide"),{semitone:FL}=ke("semitone"),{voice:$L}=ke("voice"),{chord:NL}=ke("chord"),{dictionary:_L,dict:RL}=ke("dictionary","dict"),{anchor:IL}=ke("anchor"),{offset:LL}=ke("offset"),{octaves:QL}=ke("octaves"),{mode:jL}=ke(["mode","anchor"]),{room:VL}=ke(["room","size"]),{roomlp:ZL,rlp:zL}=ke("roomlp","rlp"),{roomdim:qL,rdim:UL}=ke("roomdim","rdim"),{roomfade:WL,rfade:GL}=ke("roomfade","rfade"),{ir:XL,iresponse:HL}=ke(["ir","i"],"iresponse"),{irspeed:YL}=ke("irspeed"),{irbegin:KL}=ke("irbegin"),{roomsize:JL,size:eQ,sz:tQ,rsize:nQ}=ke("roomsize","size","sz","rsize"),{shape:sQ}=ke(["shape","shapevol"]),{distort:rQ,dist:aQ}=ke(["distort","distortvol"],"dist"),{compressor:iQ}=ke(["compressor","compressorRatio","compressorKnee","compressorAttack","compressorRelease"]),{compressorKnee:oQ}=ke("compressorKnee"),{compressorRatio:lQ}=ke("compressorRatio"),{compressorAttack:cQ}=ke("compressorAttack"),{compressorRelease:uQ}=ke("compressorRelease"),{speed:lA}=ke("speed"),{stretch:hQ}=ke("stretch"),{unit:dQ}=ke("unit"),{squiz:pQ}=ke("squiz"),{vowel:mQ}=ke("vowel"),{waveloss:fQ}=ke("waveloss"),{density:v0e}=ke("density"),{expression:gQ}=ke("expression"),{sustainpedal:bQ}=ke("sustainpedal"),{fshift:yQ}=ke("fshift"),{fshiftnote:vQ}=ke("fshiftnote"),{fshiftphase:OQ}=ke("fshiftphase"),{triode:wQ}=ke("triode"),{krush:xQ}=ke("krush"),{kcutoff:kQ}=ke("kcutoff"),{octer:SQ}=ke("octer"),{octersub:CQ}=ke("octersub"),{octersubsub:PQ}=ke("octersubsub"),{ring:AQ}=ke("ring"),{ringf:EQ}=ke("ringf"),{ringdf:MQ}=ke("ringdf"),{freeze:DQ}=ke("freeze"),{xsdelay:TQ}=ke("xsdelay"),{tsdelay:BQ}=ke("tsdelay"),{real:FQ}=ke("real"),{imag:$Q}=ke("imag"),{enhance:NQ}=ke("enhance"),{partials:_Q}=ke("partials"),{comb:RQ}=ke("comb"),{smear:IQ}=ke("smear"),{scram:LQ}=ke("scram"),{binshift:QQ}=ke("binshift"),{hbrick:jQ}=ke("hbrick"),{lbrick:VQ}=ke("lbrick"),{frameRate:ZQ}=ke("frameRate"),{frames:zQ}=ke("frames"),{hours:qQ}=ke("hours"),{minutes:UQ}=ke("minutes"),{seconds:WQ}=ke("seconds"),{songPtr:GQ}=ke("songPtr"),{uid:XQ}=ke("uid"),{val:HQ}=ke("val"),{cps:YQ}=ke("cps"),{clip:KQ,legato:JQ}=ke("clip","legato"),{duration:ej,dur:tj}=ke("duration","dur"),{zrand:nj}=ke("zrand"),{curve:sj}=ke("curve"),{deltaSlide:rj}=ke("deltaSlide"),{pitchJump:aj}=ke("pitchJump"),{pitchJumpTime:ij}=ke("pitchJumpTime"),{lfo:oj,repeatTime:lj}=ke("lfo","repeatTime"),{znoise:cj}=ke("znoise"),{zmod:uj}=ke("zmod"),{zcrush:hj}=ke("zcrush"),{zdelay:dj}=ke("zdelay"),{zzfx:pj}=ke("zzfx"),{color:mj,colour:fj}=ke(["color","colour"]);let cA=(...n)=>n.reduce((e,t)=>Object.assign(e,{[t]:xv(t)}),{});const gj=ze("adsr",(n,e)=>{n=Array.isArray(n)?n:[n];const[t,s,r,a]=n;return e.set({attack:t,decay:s,sustain:r,release:a})}),bj=ze("ad",(n,e)=>{n=Array.isArray(n)?n:[n];const[t,s=t]=n;return e.attack(t).decay(s)}),yj=ze("ds",(n,e)=>{n=Array.isArray(n)?n:[n];const[t,s=0]=n;return e.set({decay:t,sustain:s})}),vj=ze("ar",(n,e)=>{n=Array.isArray(n)?n:[n];const[t,s=t]=n;return e.set({attack:t,release:s})}),{midichan:Oj}=ke("midichan"),{midimap:wj}=ke("midimap"),{midiport:xj}=ke("midiport"),{midicmd:kj}=ke("midicmd"),Sj=ze("control",(n,e)=>{if(!Array.isArray(n))throw new Error("control expects an array of [ccn, ccv]");const[t,s]=n;return e.ccn(t).ccv(s)}),{ccn:Cj}=ke("ccn"),{ccv:Pj}=ke("ccv"),{ctlNum:Aj}=ke("ctlNum"),{nrpnn:Ej}=ke("nrpnn"),{nrpv:Mj}=ke("nrpv"),{progNum:Dj}=ke("progNum"),Tj=ze("sysex",(n,e)=>{if(!Array.isArray(n))throw new Error("sysex expects an array of [id, data]");const[t,s]=n;return e.sysexid(t).sysexdata(s)}),{sysexid:Bj}=ke("sysexid"),{sysexdata:Fj}=ke("sysexdata"),{midibend:$j}=ke("midibend"),{miditouch:Nj}=ke("miditouch"),{polyTouch:_j}=ke("polyTouch"),uA=n=>df.has(n)?df.get(n):n,Rj=ze("as",(n,e)=>(n=Array.isArray(n)?n:[n],e.fmap(t=>(t=Array.isArray(t)?t:[t],t=Object.fromEntries(n.map((s,r)=>[uA(s),t[r]])),t)))),Ij=ze("scrub",(n,e)=>n.outerBind(t=>{Array.isArray(t)||(t=[t]);const[s,r=1]=t;return e.begin(s).mul(lA(r)).clip(1)}),!1),O0e=Object.freeze(Object.defineProperty({__proto__:null,accelerate:v_,activeLabel:pL,ad:bj,adsr:gj,amp:k_,analyze:R_,anchor:IL,ar:vj,as:Rj,att:C_,attack:S_,bandf:U_,bandq:X_,bank:__,bbexpr:bR,bbst:vR,begin:Y_,binshift:QQ,bp:G_,bpa:KR,bpattack:YR,bpd:rI,bpdecay:sI,bpe:UR,bpenv:qR,bpf:W_,bpq:H_,bpr:gI,bprelease:fI,bps:uI,bpsustain:cI,byteBeatExpression:gR,byteBeatStartTime:yR,ccn:Cj,ccv:Pj,ch:wR,channel:NR,channels:OR,chord:NL,clip:KQ,coarse:aR,color:mj,colour:fj,comb:RQ,compressor:iQ,compressorAttack:cQ,compressorKnee:oQ,compressorRatio:lQ,compressorRelease:uQ,control:Sj,cps:YQ,createParam:xv,createParams:cA,crush:rR,ctf:IR,ctlNum:Aj,ctranspose:bL,curve:sj,cut:_R,cutoff:RR,dec:Q_,decay:L_,degree:fL,delay:FI,delayfb:NI,delayfeedback:$I,delaysync:QI,delayt:II,delaytime:RI,deltaSlide:rj,density:v0e,det:ZI,detune:VI,dfb:_I,dict:RL,dictionary:_L,dist:aQ,distort:rQ,djf:BI,drive:fR,dry:UI,ds:yj,dt:LI,duck:dR,duckattack:mR,duckdepth:pR,dur:tj,duration:ej,end:K_,enhance:NQ,expression:gQ,fadeInTime:XI,fadeOutTime:GI,fadeTime:WI,fanchor:yI,fft:I_,fm:E_,fmattack:D_,fmdecay:B_,fmenv:M_,fmh:P_,fmi:A_,fmrelease:$_,fmsustain:F_,fmvelocity:N_,fmwave:T_,frameRate:ZQ,frames:zQ,freeze:DQ,freq:HI,fshift:yQ,fshiftnote:vQ,fshiftphase:OQ,ftype:bI,gain:w_,gat:cL,gate:lL,getControlName:uA,harmonic:yL,hbrick:jQ,hcutoff:CI,hold:q_,hours:qQ,hp:AI,hpa:HR,hpattack:XR,hpd:nI,hpdecay:tI,hpe:zR,hpenv:ZR,hpf:PI,hpq:MI,hpr:mI,hprelease:pI,hps:lI,hpsustain:oI,hresonance:EI,imag:$Q,ir:XL,irbegin:KL,iresponse:HL,irspeed:YL,isControlName:d_,kcutoff:kQ,krush:xQ,label:mL,lbrick:VQ,legato:JQ,leslie:uL,lfo:oj,lock:jI,loop:J_,loopBegin:eR,loopEnd:nR,loopb:tR,loope:sR,lp:QR,lpa:GR,lpattack:WR,lpd:eI,lpdecay:JR,lpe:VR,lpenv:jR,lpf:LR,lpq:TI,lpr:dI,lprelease:hI,lps:iI,lpsustain:aI,lrate:hL,lsize:dL,midibend:$j,midichan:Oj,midicmd:kj,midimap:wj,midiport:xj,miditouch:Nj,minutes:UQ,mode:jL,mtranspose:gL,n:b_,noise:xI,note:y_,nrpnn:Ej,nrpv:Mj,nudge:wL,octave:xL,octaveR:OL,octaves:QL,octer:SQ,octersub:CQ,octersubsub:PQ,offset:LL,orbit:kL,overgain:SL,overshape:CL,pan:PL,panchor:oL,panorient:DL,panspan:AL,pansplay:EL,panwidth:ML,partials:_Q,patt:KI,pattack:YI,pcurve:iL,pdec:eL,pdecay:JI,penv:aL,ph:PR,phasdp:$R,phaser:AR,phasercenter:DR,phaserdepth:BR,phaserrate:CR,phasersweep:ER,phc:TR,phd:FR,phs:MR,pitchJump:aj,pitchJumpTime:ij,polyTouch:_j,postgain:x_,prel:rL,prelease:sL,progNum:Dj,psus:nL,psustain:tL,pw:xR,pwrate:kR,pwsweep:SR,rate:TL,rdim:UL,real:FQ,registerControl:ke,rel:z_,release:Z_,repeatTime:lj,resonance:DI,rfade:GL,ring:AQ,ringdf:MQ,ringf:EQ,rlp:zL,room:VL,roomdim:qL,roomfade:WL,roomlp:ZL,roomsize:JL,rsize:nQ,s:p_,scram:LQ,scrub:Ij,seconds:WQ,semitone:FL,shape:sQ,size:eQ,slide:BL,smear:IQ,songPtr:GQ,sound:m_,source:f_,speed:lA,spread:qI,squiz:pQ,src:g_,stepsPerOctave:vL,stretch:hQ,sus:V_,sustain:j_,sustainpedal:bQ,sysex:Tj,sysexdata:Fj,sysexid:Bj,sz:tQ,tremolo:iR,tremolodepth:lR,tremolophase:uR,tremoloshape:hR,tremoloskew:cR,tremolosync:oR,triode:wQ,tsdelay:BQ,uid:XQ,unison:zI,unit:dQ,v:wI,val:HQ,velocity:O_,vib:vI,vibmod:kI,vibrato:OI,vmod:SI,voice:$L,vowel:mQ,waveloss:fQ,xsdelay:TQ,zcrush:hj,zdelay:dj,zmod:uj,znoise:cj,zrand:nj,zzfx:pj},Symbol.toStringTag,{value:"Module"})),w0e=function(n,e){const[t,s]=n,[r,a]=e,[i,o]=eA(s,r);return[[s,t-s],[yv((l,c)=>l.concat(c),i,a),o]]},x0e=function(n,e){const[t,s]=n,[r,a]=e,[i,o]=eA(t,a);return[[t,s-t],[yv((l,c)=>l.concat(c),r,i),o]]},Lj=function(n,e){const[t,s]=n;return Math.min(t,s)<=1?[n,e]:Lj(...t>s?w0e(n,e):x0e(n,e))},hA=function(n,e){const t=n<0,s=Math.abs(n),r=e-s,a=Array(s).fill([1]),i=Array(r).fill([0]),o=Lj([s,r],[a,i]),l=uc(o[1][0]).concat(uc(o[1][1]));return t?l.map(c=>1-c):l},kv=function(n,e,t){const s=hA(n,e);return t?AN(s,-t):s},k0e=ze("euclid",function(n,e,t){return t.struct(kv(n,e,0))}),S0e=ze("e",function(n,e){Array.isArray(n)||(n=[n]);const[t,s=t,r=0]=n;return e.struct(kv(t,s,r))}),{euclidrot:C0e,euclidRot:P0e}=ze(["euclidrot","euclidRot"],function(n,e,t,s){return s.struct(kv(n,e,t))}),Qj=function(n,e,t,s){if(n<1)return xs;const r=kv(n,e,0).join("").split("1").slice(1).map(a=>[a.length+1,!0]);return s.struct(iA(...r)).late(dt(t).div(e))},A0e=ze(["euclidLegato"],function(n,e,t){return Qj(n,e,0,t)}),E0e=ze(["euclidLegatoRot"],function(n,e,t,s){return Qj(n,e,t,s)}),{euclidish:M0e,eish:D0e}=ze(["euclidish","eish"],function(n,e,t,s){const r=oA(hA(n,e),new Array(n).fill(1),t);return s.struct(r).setSteps(e)});function jj(n,e,t=.05,s=.1,r=.1,a=globalThis.setInterval,i=globalThis.clearInterval,o=!0){let l=0,c=0,u=10**4,h=.01;const d=A=>t=A(t);r=r||s/2;const m=()=>{const A=n(),F=A+s+r;for(c===0&&(c=A+h);c<F;)c=o?Math.round(c*u)/u:c,e(c,t,l,A),c+=t,l++};let y;const O=()=>{S(),m(),y=a(m,s*1e3)},S=()=>{y!==void 0&&i(y),y=void 0};return{setDuration:d,start:O,stop:()=>{l=0,c=0,S()},pause:()=>S(),duration:t,interval:s,getPhase:()=>c,minLatency:h}}function T0e(n){return new mt(e=>[new tr(void 0,e.span,n)])}const go=n=>{const e=t=>[new tr(void 0,t.span,n(t.span.begin))];return new mt(e)},rg=go(n=>n%1),dA=rg.toBipolar(),Sv=go(n=>1-n%1),pA=Sv.toBipolar(),mA=go(n=>Math.sin(Math.PI*2*n)),Vj=mA.fromBipolar(),B0e=Vj._early(dt(1).div(4)),F0e=mA._early(dt(1).div(4)),Zj=go(n=>Math.floor(n*2%2)),$0e=Zj.toBipolar(),N0e=ua(rg,Sv),_0e=ua(dA,pA),R0e=ua(Sv,rg),I0e=ua(pA,dA),fA=go(Yh);let gA=0,bA=0;typeof window<"u"&&document.addEventListener("mousemove",n=>{gA=n.clientY/document.body.clientHeight,bA=n.clientX/document.body.clientWidth});const L0e=go(()=>gA),Q0e=go(()=>gA),j0e=go(()=>bA),V0e=go(()=>bA),zj=n=>{const e=n<<13^n,t=e>>17^e;return t<<5^t},Z0e=n=>n-Math.trunc(n),qj=n=>zj(Math.trunc(Z0e(n/300)*536870912)),Uj=n=>n%536870912/536870912,pf=n=>Math.abs(Uj(qj(n))),z0e=(n,e)=>{const t=[];for(let s=0;s<e;++s)t.push(Uj(n)),n=zj(n);return t},q0e=(n,e)=>z0e(qj(n),e),Wj=n=>rg.range(0,n).round().segment(n),U0e=n=>{const e=bt(n).log2(0).floor().add(1);return Gj(n,e)},Gj=(n,e=16)=>{e=bt(e);const t=Wj(e).mul(-1).add(e.sub(1));return bt(n).segment(e).brshift(t).band(Cr(1))},Xj=n=>go(e=>{const t=q0e(e.floor().add(.5),n).map((r,a)=>[r,a]).sort((r,a)=>(r[0]>a[0])-(r[0]<a[0])).map(r=>r[1]),s=e.cyclePos().mul(n).floor()%n;return t[s]})._segment(n),Hj=(n,e,t)=>{const s=[...Array(e).keys()].map(r=>t.zoom(dt(r).div(e),dt(r+1).div(e)));return n.fmap(r=>s[r].repeatCycles(e)._fast(e)).innerJoin()},W0e=ze("shuffle",(n,e)=>Hj(Xj(n),n,e)),G0e=ze("scramble",(n,e)=>Hj(vA(n)._segment(n),n,e)),Aa=go(pf),X0e=Aa.toBipolar(),yA=n=>Aa.fmap(e=>e<n),H0e=n=>bt(n).fmap(yA).innerJoin(),Y0e=yA(.5),vA=n=>Aa.fmap(e=>Math.trunc(e*n)),K0e=n=>bt(n).fmap(vA).innerJoin(),OA=(n,e)=>(e=e.map(bt),e.length==0?xs:n.range(0,e.length).fmap(t=>{const s=Math.min(Math.max(Math.floor(t),0),e.length-1);return e[s]})),Cv=(n,e)=>OA(n,e).outerJoin(),Pv=(n,e)=>OA(n,e).innerJoin(),Yj=(...n)=>Cv(Aa,n),J0e=(...n)=>Pv(Aa,n),ebe=Yj;mt.prototype.choose=function(...n){return Cv(this,n)};mt.prototype.choose2=function(...n){return Cv(this.fromBipolar(),n)};const Kj=(...n)=>Pv(Aa.segment(1),n),tbe=Kj,Jj=function(n,...e){const t=e.map(o=>bt(o[0])),s=[];let r=Cr(0);for(const o of e)r=r.add(o[1]),s.push(r);const a=QN(s),i=function(o){const l=r.mul(o);return a.fmap(c=>u=>t[c.findIndex(h=>h>u,c)]).appLeft(l)};return n.bind(i)},nbe=(...n)=>Jj(...n).outerJoin(),sbe=(...n)=>nbe(Aa,...n),eV=(...n)=>Jj(Aa.segment(1),...n).innerJoin(),rbe=eV;function abe(n){let e=Math.floor(n),t=e+1;const s=r=>6*r**5-15*r**4+10*r**3;return(r=>a=>i=>a+s(r)*(i-a))(n-e)(pf(e))(pf(t))}const tV=n=>n.fmap(abe);function ibe(n){const e=Math.floor(n),t=e+1,s=pf(e),r=pf(t)+s,a=(n-e)/(t-e);return((i,o,l)=>i+(o-i)*l)(s,r,a)/2}const nV=n=>n.fmap(ibe),obe=tV(fA.fmap(n=>Number(n))),lbe=nV(fA.fmap(n=>Number(n))),cbe=ze("degradeByWith",(n,e,t)=>t.fmap(s=>r=>s).appLeft(n.filterValues(s=>s>e)),!0,!0),ube=ze("degradeBy",function(n,e){return e._degradeByWith(Aa,n)},!0,!0),hbe=ze("degrade",n=>n._degradeBy(.5),!0,!0),dbe=ze("undegradeBy",function(n,e){return e._degradeByWith(Aa.fmap(t=>1-t),n)},!0,!0),pbe=ze("undegrade",n=>n._undegradeBy(.5),!0,!0),mbe=ze("sometimesBy",function(n,e,t){return bt(n).fmap(s=>Xs(t._degradeBy(s),e(t._undegradeBy(1-s)))).innerJoin()}),fbe=ze("sometimes",function(n,e){return e._sometimesBy(.5,n)}),gbe=ze("someCyclesBy",function(n,e,t){return bt(n).fmap(s=>Xs(t._degradeByWith(Aa._segment(1),s),e(t._degradeByWith(Aa.fmap(r=>1-r)._segment(1),1-s)))).innerJoin()}),bbe=ze("someCycles",function(n,e){return e._someCyclesBy(.5,n)}),ybe=ze("often",function(n,e){return e.sometimesBy(.75,n)}),vbe=ze("rarely",function(n,e){return e.sometimesBy(.25,n)}),Obe=ze("almostNever",function(n,e){return e.sometimesBy(.1,n)}),wbe=ze("almostAlways",function(n,e){return e.sometimesBy(.9,n)}),xbe=ze("never",function(n,e){return e}),kbe=ze("always",function(n,e){return n(e)});function wA(n){Array.isArray(n)===!1&&(n=[n]);const e=RN();return n.every(t=>{const s=_N.get(t)??t;return e[s]})}const Sbe=ze("whenKey",function(n,e,t){return t.when(wA(n),e)}),Cbe=ze("keyDown",function(n){return n.fmap(wA)}),jl=function(n,e,t=!0){const s=Array.isArray(n),r=Object.keys(n).length;return n=$N(n,bt),r===0?xs:e.fmap(a=>{let i=a;return s&&(i=t?Math.round(i)%r:vv(Math.round(i),0,n.length-1)),n[i]})},sV=function(n,e){return Array.isArray(e)&&([e,n]=[n,e]),Pbe(n,e)},Pbe=ze("pick",function(n,e){return jl(n,e,!1).innerJoin()}),rV=ze("pickmod",function(n,e){return jl(n,e,!0).innerJoin()}),Abe=ze("pickF",function(n,e,t){return t.apply(sV(n,e))}),Ebe=ze("pickmodF",function(n,e,t){return t.apply(rV(n,e))}),Mbe=ze("pickOut",function(n,e){return jl(n,e,!1).outerJoin()}),Dbe=ze("pickmodOut",function(n,e){return jl(n,e,!0).outerJoin()}),Tbe=ze("pickRestart",function(n,e){return jl(n,e,!1).restartJoin()}),Bbe=ze("pickmodRestart",function(n,e){return jl(n,e,!0).restartJoin()}),Fbe=ze("pickReset",function(n,e){return jl(n,e,!1).resetJoin()}),$be=ze("pickmodReset",function(n,e){return jl(n,e,!0).resetJoin()}),{inhabit:Nbe,pickSqueeze:_be}=ze(["inhabit","pickSqueeze"],function(n,e){return jl(n,e,!1).squeezeJoin()}),{inhabitmod:Rbe,pickmodSqueeze:Ibe}=ze(["inhabitmod","pickmodSqueeze"],function(n,e){return jl(n,e,!0).squeezeJoin()}),Lbe=(n,e)=>(e=e.map(bt),e.length==0?xs:n.fmap(t=>{const s=ng(Math.round(t),e.length);return e[s]}).squeezeJoin());let dd;try{dd=window==null?void 0:window.speechSynthesis}catch{console.warn("cannot use window: not in browser?")}let AD=dd==null?void 0:dd.getVoices();function Qbe(n,e,t){dd.cancel();const s=new SpeechSynthesisUtterance(n);s.lang=e,AD=dd.getVoices();const r=AD.filter(a=>a.lang.includes(e));typeof t=="number"?s.voice=r[t%r.length]:typeof t=="string"&&(s.voice=r.find(a=>a.name===a)),speechSynthesis.speak(s)}const jbe=ze("speak",function(n,e,t){return t.onTrigger(s=>{Qbe(s.value,n,e)})}),aV={},xA=async(...n)=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="fulfilled").map(s=>s.value);return e.forEach((s,r)=>{s.status==="rejected"&&console.warn(`evalScope: module with index ${r} could not be loaded:`,s.reason)}),t.forEach(s=>{Object.entries(s).forEach(([r,a])=>{globalThis[r]=a,aV[r]=a})}),t};function Vbe(n,e={}){const{wrapExpression:t=!0,wrapAsync:s=!0}=e;t&&(n=`{${n}}`),s&&(n=`(async ()=>${n})()`);const r=`"use strict";return (${n})`;return Function(r)()}const iV=async(n,e,t)=>{let s={};if(e){const r=e(n,t);n=r.output,s=r}return{mode:"javascript",pattern:await Vbe(n,{wrapExpression:!!e}),meta:s}};class Zbe{constructor({onTrigger:e,onToggle:t,getTime:s}){this.started=!1,this.cps=.5,this.getTime=s,this.time_at_last_tick_message=0,this.collator=new NN({getTargetClockTime:s}),this.onToggle=t,this.latency=.1,this.cycle=0,this.id=Math.round(Date.now()*Math.random()),this.worker=new SharedWorker(new URL(""+new URL("data:text/javascript;base64,KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIEwoKXtyZXR1cm4gcGVyZm9ybWFuY2Uubm93KCkqLjAwMX1sZXQgXz0wLHI9MCxvPS41O2NvbnN0IGg9bmV3IE1hcCxtPS4xLE09bmV3IEJyb2FkY2FzdENoYW5uZWwoInN0cnVkZWx0aWNrIiksYj0ocyxlKT0+e00ucG9zdE1lc3NhZ2Uoe3R5cGU6cyxwYXlsb2FkOmV9KX0sQz1FKEwsKHMsZSx0LG4pPT57Y29uc3QgaT1yKmUsZD1zLW4sYz1uK2QsdT1pKm8sbD1fK3UsZz1uLWMtZSxmPWUqbyxwPWwrZix5PWwrZypvO2IoInRpY2siLHtiZWdpbjpsLGVuZDpwLGNwczpvLHRpbWU6bixjeWNsZTp5fSkscisrfSxtKTtsZXQgaz0hMTtjb25zdCBJPXM9PntoLnNldChzLHtzdGFydGVkOiEwfSksIWsmJihDLnN0YXJ0KCksaz0hMCl9LEE9YXN5bmMgcz0+e2guc2V0KHMse3N0YXJ0ZWQ6ITF9KTtjb25zdCBlPUFycmF5LmZyb20oaC52YWx1ZXMoKSkuc29tZSh0PT50LnN0YXJ0ZWQpOyFrfHxlfHwoQy5zdG9wKCksdygwKSxrPSExKX0sdz1zPT57cj0wLF89c30sRD1zPT57Y29uc3R7dHlwZTplLHBheWxvYWQ6dH09cztzd2l0Y2goZSl7Y2FzZSJjcHNjaGFuZ2UiOntpZih0LmNwcyE9PW8pe2NvbnN0IG49ciptO189XytuKm8sbz10LmNwcyxyPTB9YnJlYWt9Y2FzZSJzZXRjeWNsZSI6e3codC5jeWNsZSk7YnJlYWt9Y2FzZSJ0b2dnbGUiOnt0LnN0YXJ0ZWQ/SShzLmlkKTpBKHMuaWQpO2JyZWFrfX19O3NlbGYub25jb25uZWN0PWZ1bmN0aW9uKHMpe2NvbnN0IGU9cy5wb3J0c1swXTtlLmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLGZ1bmN0aW9uKHQpe0QodC5kYXRhKX0pLGUuc3RhcnQoKX07ZnVuY3Rpb24gRShzLGUsdD0uMDUsbj0uMSxpPS4xKXtsZXQgZD0wLGM9MCx1PTEwKio0LGw9LjAxO2NvbnN0IGc9YT0+dD1hKHQpO2k9aXx8bi8yO2NvbnN0IGY9KCk9Pntjb25zdCBhPXMoKSxPPWErbitpO2ZvcihjPT09MCYmKGM9YStsKTtjPE87KWM9TWF0aC5yb3VuZChjKnUpL3UsYz49YSYmZShjLHQsZCxhKSxjPGEmJmNvbnNvbGUubG9nKCJUT08gTEFURSIsYyksYys9dCxkKyt9O2xldCBwO2NvbnN0IHk9KCk9PntUKCksZigpLHA9c2V0SW50ZXJ2YWwoZixuKjFlMyl9LFQ9KCk9PnAhPT12b2lkIDAmJmNsZWFySW50ZXJ2YWwocCk7cmV0dXJue3NldER1cmF0aW9uOmcsc3RhcnQ6eSxzdG9wOigpPT57ZD0wLGM9MCxUKCl9LHBhdXNlOigpPT5UKCksZHVyYXRpb246dCxpbnRlcnZhbDpuLGdldFBoYXNlOigpPT5jLG1pbkxhdGVuY3k6bH19fSkoKTsK",import.meta.url).href,import.meta.url)),this.worker.port.start(),this.channel=new BroadcastChannel("strudeltick");const r=i=>{const{cps:o,begin:l,end:c,cycle:u,time:h}=i;this.cps=o,this.cycle=u;const d=this.collator.calculateOffset(h)+h;a(l,c,d),this.time_at_last_tick_message=d},a=(i,o,l)=>{this.started!==!1&&this.pattern.queryArc(i,o,{_cps:this.cps}).forEach(c=>{if(c.hasOnset()){const u=E2(c.whole.begin-this.cycle,this.cps)+l+this.latency,h=E2(c.duration,this.cps);e==null||e(c,0,h,this.cps,u)}})};this.channel.onmessage=i=>{if(!this.started)return;const{payload:o,type:l}=i.data;switch(l){case"tick":r(o)}}}sendMessage(e,t){this.worker.port.postMessage({type:e,payload:t,id:this.id})}now(){const e=(this.getTime()-this.time_at_last_tick_message)*this.cps;return this.cycle+e}setCps(e=1){this.sendMessage("cpschange",{cps:e})}setCycle(e){this.sendMessage("setcycle",{cycle:e})}setStarted(e){var t;this.sendMessage("toggle",{started:e}),this.started=e,(t=this.onToggle)==null||t.call(this,e)}start(){ka("[cyclist] start"),this.setStarted(!0)}stop(){ka("[cyclist] stop"),this.collator.reset(),this.setStarted(!1)}setPattern(e,t=!1){this.pattern=e,t&&!this.started&&this.start()}log(e,t,s){const r=s.filter(a=>a.hasOnset());console.log(`${e.toFixed(4)} - ${t.toFixed(4)} ${Array(r.length).fill("I").join("")}`)}}class oV{constructor({interval:e,onTrigger:t,onToggle:s,onError:r,getTime:a,latency:i=.1,setInterval:o,clearInterval:l,beforeStart:c}){this.started=!1,this.beforeStart=c,this.cps=.5,this.num_ticks_since_cps_change=0,this.lastTick=0,this.lastBegin=0,this.lastEnd=0,this.getTime=a,this.num_cycles_at_cps_change=0,this.seconds_at_cps_change,this.onToggle=s,this.latency=i,this.clock=jj(a,(u,h,d,m)=>{this.num_ticks_since_cps_change===0&&(this.num_cycles_at_cps_change=this.lastEnd,this.seconds_at_cps_change=u),this.num_ticks_since_cps_change++;const y=this.num_ticks_since_cps_change*h*this.cps;try{const O=this.lastEnd;this.lastBegin=O;const S=this.num_cycles_at_cps_change+y;if(this.lastEnd=S,this.lastTick=u,u<m){console.log("skip query: too late");return}this.pattern.queryArc(O,S,{_cps:this.cps}).forEach(A=>{if(A.hasOnset()){const F=(A.whole.begin-this.num_cycles_at_cps_change)/this.cps+this.seconds_at_cps_change+i,j=A.duration/this.cps,N=F-u;t==null||t(A,N,j,this.cps,F),A.value.cps!==void 0&&this.cps!=A.value.cps&&(this.cps=A.value.cps,this.num_ticks_since_cps_change=0)}})}catch(O){XP(O),r==null||r(O)}},e,.1,.1,o,l)}now(){if(!this.started)return 0;const e=this.getTime()-this.lastTick-this.clock.duration;return this.lastBegin+e*this.cps}setStarted(e){var t;this.started=e,(t=this.onToggle)==null||t.call(this,e)}async start(){var e;if(await((e=this.beforeStart)==null?void 0:e.call(this)),this.num_ticks_since_cps_change=0,this.num_cycles_at_cps_change=0,!this.pattern)throw new Error("Scheduler: no pattern set! call .setPattern first.");ka("[cyclist] start"),this.clock.start(),this.setStarted(!0)}pause(){ka("[cyclist] pause"),this.clock.pause(),this.setStarted(!1)}stop(){ka("[cyclist] stop"),this.clock.stop(),this.lastEnd=0,this.setStarted(!1)}async setPattern(e,t=!1){this.pattern=e,t&&!this.started&&await this.start()}setCps(e=.5){this.cps!==e&&(this.cps=e,this.num_ticks_since_cps_change=0)}log(e,t,s){const r=s.filter(a=>a.hasOnset());console.log(`${e.toFixed(4)} - ${t.toFixed(4)} ${Array(r.length).fill("I").join("")}`)}}let F2;function $2(){if(!F2)throw new Error("no time set! use setTime to define a time source");return F2()}function N2(n){F2=n}function lV({defaultOutput:n,onEvalError:e,beforeEval:t,beforeStart:s,afterEval:r,getTime:a,transpiler:i,onToggle:o,editPattern:l,onUpdateState:c,sync:u=!1,setInterval:h,clearInterval:d,id:m,mondo:y=!1}){const O={schedulerError:void 0,evalError:void 0,code:"// LOADING",activeCode:"// LOADING",pattern:void 0,miniLocations:[],widgets:[],pending:!1,started:!1},S={id:m},A=Ee=>{Object.assign(O,Ee),O.isDirty=O.code!==O.activeCode,O.error=O.evalError||O.schedulerError,c==null||c(O)},F={onTrigger:cV({defaultOutput:n,getTime:a}),getTime:a,onToggle:Ee=>{A({started:Ee}),o==null||o(Ee)},setInterval:h,clearInterval:d,beforeStart:s},j=u&&typeof SharedWorker<"u"?new Zbe(F):new oV(F);let N={},$=0,L;const I=function(){return N={},$=0,L=void 0,xs},q=async(Ee,Qe=!0)=>(Ee=(l==null?void 0:l(Ee))||Ee,await j.setPattern(Ee,Qe),Ee);N2(()=>j.now());const ce=()=>j.stop(),ee=()=>j.start(),he=()=>j.pause(),H=()=>j.toggle(),me=Ee=>j.setCps(Ee),Oe=Ee=>j.setCps(Ee/60);let Pe=[];const De=function(Ee){return Pe.push(Ee),xs},Se=function(Ee){return L=Ee,xs},ae=()=>{mt.prototype.p=function(Qe){return typeof Qe=="string"&&(Qe.startsWith("_")||Qe.endsWith("_"))?xs:(Qe==="$"&&(Qe=`$${$}`,$++),N[Qe]=this,this)},mt.prototype.q=function(Qe){return xs};try{for(let Qe=1;Qe<10;++Qe)Object.defineProperty(mt.prototype,`d${Qe}`,{get(){return this.p(Qe)},configurable:!0}),Object.defineProperty(mt.prototype,`p${Qe}`,{get(){return this.p(Qe)},configurable:!0}),mt.prototype[`q${Qe}`]=xs}catch(Qe){console.warn("injectPatternMethods: error:",Qe)}const Ee=ze("cpm",function(Qe,Ke){return Ke._fast(Qe/60/j.cps)});return xA({all:De,each:Se,hush:I,cpm:Ee,setCps:me,setcps:me,setCpm:Oe,setcpm:Oe})};return{scheduler:j,evaluate:async(Ee,Qe=!0,Ke=!0)=>{if(!Ee)throw new Error("no code to evaluate");try{A({code:Ee,pending:!0}),await ae(),N2(()=>j.now()),await(t==null?void 0:t({code:Ee})),Pe=[],Ke&&I(),y&&(Ee=`mondolang\`${Ee}\``);let{pattern:ge,meta:Ye}=await iV(Ee,i,S);if(Object.keys(N).length){let yt=Object.values(N);L&&(yt=yt.map(Xe=>L(Xe))),ge=Xs(...yt)}else L&&(ge=L(ge));if(Pe.length)for(let yt in Pe)ge=Pe[yt](ge);if(!Ov(ge)){const yt=`got "${typeof evaluated}" instead of pattern`;throw new Error(yt+(typeof evaluated=="function"?", did you forget to call a function?":"."))}return ka("[eval] code updated"),ge=await q(ge,Qe),A({miniLocations:(Ye==null?void 0:Ye.miniLocations)||[],widgets:(Ye==null?void 0:Ye.widgets)||[],activeCode:Ee,pattern:ge,evalError:void 0,schedulerError:void 0,pending:!1}),r==null||r({code:Ee,pattern:ge,meta:Ye}),ge}catch(ge){ka(`[eval] error: ${ge.message}`,"error"),console.error(ge),A({evalError:ge,pending:!1}),e==null||e(ge)}},start:ee,stop:ce,pause:he,setCps:me,setPattern:q,setCode:Ee=>A({code:Ee}),toggle:H,state:O}}const cV=({getTime:n,defaultOutput:e})=>async(t,s,r,a,i)=>{try{(!t.context.onTrigger||!t.context.dominantTrigger)&&await e(t,s,r,a,i),t.context.onTrigger&&await t.context.onTrigger(t,n(),a,i)}catch(o){XP(o,"getTrigger")}},zbe=function(n,e={}){const t=document.getElementById("code"),s="background-image:url("+n+");background-size:contain;";t.style=s;const{className:r}=t,a=(o,l)=>{({style:()=>t.style=s+";"+l,className:()=>t.className=l+" "+r})[o]()},i=Object.entries(e).filter(([o,l])=>typeof l=="function");Object.entries(e).filter(([o,l])=>typeof l=="string").forEach(([o,l])=>a(o,l)),i.length},qbe=()=>{const n=document.getElementById("code");n&&(n.style="")};ka("🌀 @strudel/core loaded 🌀");globalThis._strudelLoaded&&console.warn(`@strudel/core was loaded more than once...
This might happen when you have multiple versions of strudel installed. 
Please check with "npm ls @strudel/core".`);globalThis._strudelLoaded=!0;const uV=Object.freeze(Object.defineProperty({__proto__:null,ClockCollator:NN,Cyclist:oV,Fraction:dt,Hap:tr,Pattern:mt,State:Id,TimeSpan:or,__chooseWith:OA,_brandBy:yA,_fitslice:GN,_irand:vA,_keyDown:wA,_match:XN,_mod:ng,_morph:oA,_polymeterListSteps:YN,_retime:T2,_slices:B2,accelerate:v_,activeLabel:pL,ad:bj,add:efe,adsr:gj,almostAlways:wbe,almostNever:Obe,always:kbe,amp:k_,analyze:R_,anchor:IL,and:vfe,apply:Xfe,ar:vj,arp:Fme,arpWith:Bme,arrange:Lme,as:Rj,att:C_,attack:S_,averageArray:SN,backgroundImage:zbe,band:ife,bandf:U_,bandq:X_,bank:__,base64ToUnicode:FN,bbexpr:bR,bbst:vR,beat:b0e,begin:Y_,berlin:lbe,berlinWith:nV,binary:U0e,binaryN:Gj,bind:qme,binshift:QQ,bite:tge,bjork:hA,blshift:cfe,bor:ofe,bp:G_,bpa:KR,bpattack:YR,bpd:rI,bpdecay:sI,bpe:UR,bpenv:qR,bpf:W_,bpq:H_,bpr:gI,bprelease:fI,bps:uI,bpsustain:cI,brak:hge,brand:Y0e,brandBy:H0e,brshift:ufe,bxor:lfe,bypass:Lge,byteBeatExpression:gR,byteBeatStartTime:yR,calculateSteps:Mme,cat:zN,ccn:Cj,ccv:Pj,ceil:Sfe,ch:wR,channel:NR,channels:OR,choose:Yj,chooseCycles:Kj,chooseIn:J0e,chooseInWith:Pv,chooseOut:ebe,chooseWith:Cv,chop:l0e,chord:NL,chunk:Ege,chunkBack:Tge,chunkBackInto:Ige,chunkInto:_ge,chunkback:Bge,chunkbackinto:Rge,chunkinto:Nge,clamp:vv,cleanupUi:qbe,clip:KQ,coarse:aR,code2hash:kme,color:mj,colour:fj,comb:RQ,compose:hme,compress:Tfe,compressSpan:Bfe,compressor:iQ,compressorAttack:cQ,compressorKnee:oQ,compressorRatio:lQ,compressorRelease:uQ,compressspan:Ffe,constant:dme,contract:s_,control:Sj,controls:O0e,cosine:B0e,cosine2:F0e,cpm:Hfe,cps:YQ,createClock:jj,createParam:xv,createParams:cA,crush:rR,ctf:IR,ctlNum:Aj,ctranspose:bL,curry:Mn,curve:sj,cut:_R,cutoff:RR,cycleToSeconds:E2,dec:Q_,decay:L_,degrade:hbe,degradeBy:ube,degradeByWith:cbe,degree:fL,delay:FI,delayfb:NI,delayfeedback:$I,delaysync:QI,delayt:II,delaytime:RI,deltaSlide:rj,det:ZI,detune:VI,dfb:_I,dict:RL,dictionary:_L,dist:aQ,distort:rQ,div:sfe,djf:BI,drawLine:IN,drive:fR,drop:e_,dry:UI,ds:yj,dt:LI,duck:dR,duckattack:mR,duckdepth:pR,dur:tj,duration:ej,e:S0e,early:Yfe,echo:xge,echoWith:yge,echowith:vge,eish:D0e,end:K_,enhance:NQ,eq:ffe,eqt:gfe,errorLogger:XP,euclid:k0e,euclidLegato:A0e,euclidLegatoRot:E0e,euclidRot:P0e,euclidish:M0e,euclidrot:C0e,evalScope:xA,evaluate:iV,every:Gfe,expand:n_,expression:gQ,extend:t_,fadeInTime:XI,fadeOutTime:GI,fadeTime:WI,fanchor:yI,fast:Qfe,fastChunk:$ge,fastGap:$fe,fastcat:ua,fastchunk:Fge,fastgap:Nfe,fft:I_,filter:zge,filterWhen:qge,firstOf:Wfe,fit:p0e,flatten:uc,floor:kfe,fm:E_,fmattack:D_,fmdecay:B_,fmenv:M_,fmh:P_,fmi:A_,fmrelease:$_,fmsustain:F_,fmvelocity:N_,fmwave:T_,focus:_fe,focusSpan:Rfe,focusspan:Ife,fractionalArgs:pme,frameRate:ZQ,frames:zQ,freeze:DQ,freq:HI,freqToMidi:HP,fromBipolar:Pfe,fshift:yQ,fshiftnote:vQ,fshiftphase:OQ,ftype:bI,func:wfe,gain:w_,gap:mp,gat:cL,gate:lL,getControlName:uA,getCurrentKeyboardState:RN,getEventOffsetMs:ime,getFreq:kN,getFrequency:PN,getPerformanceTimeSeconds:Cme,getPlayableNoteValue:ume,getSoundIndex:cme,getTime:$2,getTrigger:cV,grow:Wge,gt:dfe,gte:mfe,harmonic:yL,hash2code:Sme,hbrick:jQ,hcutoff:CI,hold:q_,hours:qQ,hp:AI,hpa:HR,hpattack:XR,hpd:nI,hpdecay:tI,hpe:zR,hpenv:ZR,hpf:PI,hpq:MI,hpr:mI,hprelease:pI,hps:lI,hpsustain:oI,hresonance:EI,hsl:Zge,hsla:Vge,hurry:jfe,id:Yh,imag:$Q,inhabit:Nbe,inhabitmod:Rbe,innerBind:Ume,inside:zfe,inv:lge,invert:oge,ir:XL,irand:K0e,irbegin:KL,iresponse:HL,irspeed:YL,isControlName:d_,isNote:bv,isNoteWithOctave:sme,isPattern:Ov,isaw:Sv,isaw2:pA,iter:Sge,iterBack:Cge,iterback:Pge,itri:R0e,itri2:I0e,jux:bge,juxBy:fge,juxby:gge,kcutoff:kQ,keep:Kme,keepif:Jme,keyAlias:_N,keyDown:Cbe,krush:xQ,label:mL,lastOf:Ufe,late:UN,lbrick:VQ,legato:JQ,leslie:uL,lfo:oj,linger:nge,listRange:YP,lock:jI,logKey:GP,logger:ka,loop:J_,loopAt:h0e,loopAtCps:m0e,loopBegin:eR,loopEnd:nR,loopat:d0e,loopatcps:f0e,loopb:tR,loope:sR,lp:QR,lpa:GR,lpattack:WR,lpd:eI,lpdecay:JR,lpe:VR,lpenv:jR,lpf:LR,lpq:TI,lpr:dI,lprelease:hI,lps:iI,lpsustain:aI,lrate:hL,lsize:dL,lt:hfe,lte:pfe,mapArgs:JP,mask:jme,midi2note:lme,midiToFreq:Rd,midibend:$j,midichan:Oj,midicmd:kj,midimap:wj,midiport:xj,miditouch:Nj,minutes:UQ,mod:rfe,mode:jL,morph:y0e,mouseX:V0e,mouseY:Q0e,mousex:j0e,mousey:L0e,mtranspose:gL,mul:nfe,n:b_,nanFallback:CN,ne:bfe,net:yfe,never:xbe,noise:xI,note:y_,noteToMidi:Mh,nothing:Go,nrpnn:Ej,nrpv:Mj,nudge:wL,numeralArgs:wi,objectMap:$N,octave:xL,octaveR:OL,octaves:QL,octer:SQ,octersub:CQ,octersubsub:PQ,off:uge,offset:LL,often:ybe,or:Ofe,orbit:kL,outerBind:Wme,outside:qfe,overgain:SL,overshape:CL,pace:HN,pairs:DN,palindrome:mge,pan:PL,panchor:oL,panorient:DL,panspan:AL,pansplay:EL,panwidth:ML,parseFractional:MN,parseNumeral:KP,partials:_Q,patt:KI,pattack:YI,pcurve:iL,pdec:eL,pdecay:JI,penv:aL,perlin:obe,perlinWith:tV,ph:PR,phasdp:$R,phaser:AR,phasercenter:DR,phaserdepth:BR,phaserrate:CR,phasersweep:ER,phc:TR,phd:FR,phs:MR,pick:sV,pickF:Abe,pickOut:Mbe,pickReset:Fbe,pickRestart:Tbe,pickSqueeze:_be,pickmod:rV,pickmodF:Ebe,pickmodOut:Dbe,pickmodReset:$be,pickmodRestart:Bbe,pickmodSqueeze:Ibe,pipe:EN,pitchJump:aj,pitchJumpTime:ij,ply:Lfe,pm:Rme,polyBind:Hme,polyTouch:_j,polymeter:wv,polyrhythm:Nme,postgain:x_,pow:afe,pr:_me,prel:rL,prelease:sL,press:pge,pressBy:dge,progNum:Dj,psus:nL,psustain:tL,pure:Cr,pw:xR,pwrate:kR,pwsweep:SR,rand:Aa,rand2:X0e,randcat:tbe,randrun:Xj,range:Afe,range2:Mfe,rangex:Efe,rarely:vbe,rate:TL,ratio:Dfe,rdim:UL,real:FQ,ref:u_,register:ze,registerControl:ke,reify:bt,rel:z_,release:Z_,removeUndefineds:pp,repeatCycles:Age,repeatTime:lj,repl:lV,resonance:DI,rev:WN,rfade:GL,rib:jge,ribbon:Qge,ring:AQ,ringdf:MQ,ringf:EQ,rlp:zL,room:VL,roomdim:qL,roomfade:WL,roomlp:ZL,roomsize:JL,rotate:AN,round:xfe,rsize:nQ,run:Wj,s:p_,s_add:e0e,s_alt:Hge,s_cat:Xge,s_contract:r0e,s_expand:n0e,s_extend:s0e,s_polymeter:Yge,s_sub:t0e,s_taper:Kge,s_taperlist:Jge,s_tour:a0e,s_zip:i0e,saw:rg,saw2:dA,scram:LQ,scramble:G0e,scrub:Ij,seconds:WQ,seg:rge,segment:sge,semitone:FL,seq:qN,seqPLoop:Qme,sequence:Xo,sequenceP:QN,set:Yme,setStringParser:LN,setTime:N2,shape:sQ,shrink:a_,shrinklist:r_,shuffle:W0e,signal:go,silence:xs,sine:Vj,sine2:mA,size:eQ,slice:c_,slide:BL,slow:Vfe,slowChunk:Dge,slowcat:Au,slowcatPrime:sA,slowchunk:Mge,smear:IQ,sol2note:Ome,someCycles:bbe,someCyclesBy:gbe,sometimes:fbe,sometimesBy:mbe,songPtr:GQ,sound:m_,source:f_,sparsity:Zfe,speak:jbe,speed:lA,splice:u0e,splitAt:eA,spread:qI,square:Zj,square2:$0e,squeeze:Lbe,squeezeBind:Gme,squiz:pQ,src:g_,stack:Xs,stackBy:Ime,stackCentre:ZN,stackLeft:jN,stackRight:VN,steady:T0e,stepBind:Xme,stepalt:KN,stepcat:li,steps:o0e,stepsPerOctave:vL,stretch:hQ,striate:c0e,stringifyValues:tA,struct:Vme,strudelScope:aV,stut:kge,stutWith:Oge,stutwith:wge,sub:tfe,superimpose:Zme,sus:V_,sustain:j_,sustainpedal:bQ,swing:ige,swingBy:age,sysex:Tj,sysexdata:Fj,sysexid:Bj,sz:tQ,take:JN,time:fA,timeCat:iA,timecat:Gge,toBipolar:Cfe,tokenizeNote:wN,tour:i_,tremolo:iR,tremolodepth:lR,tremolophase:uR,tremoloshape:hR,tremoloskew:cR,tremolosync:oR,tri:N0e,tri2:_0e,triode:wQ,tsdelay:BQ,uid:XQ,undegrade:pbe,undegradeBy:dbe,unicodeToBase64:BN,uniq:wme,uniqsort:xme,uniqsortr:TN,unison:zI,unit:dQ,v:wI,val:HQ,valueToMidi:xN,velocity:O_,vib:vI,vibmod:kI,vibrato:OI,vmod:SI,voice:$L,vowel:mQ,waveloss:fQ,wchoose:sbe,wchooseCycles:eV,when:cge,whenKey:Sbe,withValue:zme,within:Uge,wrandcat:rbe,xfade:h_,xsdelay:TQ,zcrush:hj,zdelay:dj,zip:o_,zipWith:yv,zmod:uj,znoise:cj,zoom:Kfe,zoomArc:Jfe,zoomarc:ege,zrand:nj,zzfx:pj},Symbol.toStringTag,{value:"Module"})),Ec=(n="test-canvas",e)=>{let{contextType:t="2d",pixelated:s=!1,pixelRatio:r=window.devicePixelRatio}=e||{},a=document.querySelector("#"+n);if(!a){a=document.createElement("canvas"),a.id=n,a.width=window.innerWidth*r,a.height=window.innerHeight*r,a.style="pointer-events:none;width:100%;height:100%;position:fixed;top:0;left:0",s&&(a.style.imageRendering="pixelated"),document.body.prepend(a);let i;window.addEventListener("resize",()=>{i&&clearTimeout(i),i=setTimeout(()=>{a.width=window.innerWidth*r,a.height=window.innerHeight*r},200)})}return a.getContext(t,{willReadFrequently:!0})};let pd={};function hV(n){pd[n]!==void 0&&(cancelAnimationFrame(pd[n]),delete pd[n])}function Ube(n){Object.keys(pd).forEach(e=>(!n||e.startsWith(n))&&hV(e))}let ec={};mt.prototype.draw=function(n,e){if(typeof window>"u")return this;let{id:t=1,lookbehind:s=0,lookahead:r=0}=e,a=Math.max($2(),0);hV(t),s=Math.abs(s),ec[t]=(ec[t]||[]).filter(c=>!c.isInFuture(a));let i=this.queryArc(a,a+r).filter(c=>c.hasOnset());ec[t]=ec[t].concat(i);let o;const l=()=>{const c=$2(),u=c+r;ec[t]=ec[t].filter(m=>m.isInNearPast(s,c));let h=Math.max(o||u,u-1/10);const d=this.queryArc(h,u).filter(m=>m.hasOnset());ec[t]=ec[t].concat(d),o=u,n(ec[t],c,u,this),pd[t]=requestAnimationFrame(l)};return pd[t]=requestAnimationFrame(l),this};const ED=(n=!0,e)=>{const t=Ec();n&&t.clearRect(0,0,t.canvas.width,t.canvas.height),Ube(e)};mt.prototype.onPaint=function(n){return this.withState(e=>{e.controls.painters||(e.controls.painters=[]),e.controls.painters.push(n)})};mt.prototype.getPainters=function(){let n=[];return this.queryArc(0,0,{painters:n}),n};class Wbe{constructor(e,t){this.onFrame=e,this.onError=t}start(){const e=this;let t=requestAnimationFrame(function s(r){try{e.onFrame(r)}catch(a){e.onError(a)}t=requestAnimationFrame(s)});e.cancel=()=>{cancelAnimationFrame(t)}}stop(){this.cancel&&this.cancel()}}class Gbe{constructor(e,t){this.visibleHaps=[],this.lastFrame=null,this.drawTime=t,this.painters=[],this.framer=new Wbe(()=>{if(!this.scheduler){console.warn("Drawer: no scheduler");return}const s=Math.abs(this.drawTime[0]),r=this.drawTime[1],a=this.scheduler.now()+r;if(this.lastFrame===null){this.lastFrame=a;return}const i=this.scheduler.pattern.queryArc(Math.max(this.lastFrame,a-1/10),a);this.lastFrame=a,this.visibleHaps=(this.visibleHaps||[]).filter(l=>l.whole&&l.endClipped>=a-s-r).concat(i.filter(l=>l.hasOnset()));const o=a-r;e(this.visibleHaps,o,this,this.painters)},s=>{console.warn("draw error",s)})}setDrawTime(e){this.drawTime=e}invalidate(e=this.scheduler,t){if(!e)return;t=t??e.now(),this.scheduler=e;let[s,r]=this.drawTime;const[a,i]=[Math.max(t,0),t+r+.1];this.visibleHaps=this.visibleHaps.filter(l=>{var c;return((c=l.whole)==null?void 0:c.begin)<t}),this.painters=[];const o=e.pattern.queryArc(a,i,{painters:this.painters});this.visibleHaps=this.visibleHaps.concat(o)}start(e){this.scheduler=e,this.invalidate(),this.framer.start()}stop(){this.framer&&this.framer.stop()}}function m5e(n){return typeof window>"u"?"#fff":getComputedStyle(document.documentElement).getPropertyValue(n)}let dV={background:"#222",foreground:"#75baff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"};function mc(){return dV}function Xbe(n){dV=n}let MD="#22222210";mt.prototype.animate=function({callback:n,sync:e=!1,smear:t=.5}={}){window.frame&&cancelAnimationFrame(window.frame);const s=Ec();let{clientWidth:r,clientHeight:a}=s.canvas;r*=window.devicePixelRatio,a*=window.devicePixelRatio;let i=t===0?"99":Number((1-t)*100).toFixed(0);i=i.length===1?`0${i}`:i,MD=`#200010${i}`;const o=l=>{let c;l=Math.round(l),c=this.slow(1e3).queryArc(l,l),s.fillStyle=MD,s.fillRect(0,0,r,a),c.forEach(u=>{let{x:h,y:d,w:m,h:y,s:O,r:S,angle:A=0,fill:F="darkseagreen"}=u.value;if(m*=r,y*=a,S!==void 0&&A!==void 0){const N=A*2*Math.PI,[$,L]=[(r-m)/2,(a-y)/2];h=$+Math.cos(N)*S*$,d=L+Math.sin(N)*S*L}else h*=r-m,d*=a-y;const j={...u.value,x:h,y:d,w:m,h:y};s.fillStyle=F,O==="rect"?s.fillRect(h,d,m,y):O==="ellipse"&&(s.beginPath(),s.ellipse(h+m/2,d+y/2,m/2,y/2,0,0,2*Math.PI),s.fill()),n&&n(s,j,u)}),window.frame=requestAnimationFrame(o)};return window.frame=requestAnimationFrame(o),xs};const{x:pV,y:f5e,w:g5e,h:b5e,angle:y5e,r:v5e,fill:O5e,smear:w5e}=cA("x","y","w","h","angle","r","fill","smear"),x5e=ze("rescale",function(n,e){return e.mul(pV(n).w(n).y(n).h(n))}),k5e=ze("moveXY",function(n,e,t){return t.add(pV(n).y(e))}),S5e=ze("zoomIn",function(n,e){const t=Cr(1).sub(n).div(2);return e.rescale(n).move(t,t)}),Vp=(n,e,t)=>n*(t-e)+e,DD=n=>{let{value:e}=n;typeof n.value!="object"&&(e={value:e});let{note:t,n:s,freq:r,s:a}=e;if(r)return HP(r);if(t=t??s,typeof t=="string")try{return Mh(t)}catch{return 0}return typeof t=="number"?t:a?"_"+a:e};mt.prototype.pianoroll=function(n={}){let{cycles:e=4,playhead:t=.5,overscan:s=0,hideNegative:r=!1,ctx:a=Ec(),id:i=1}=n,o=-e*t,l=e*(1-t);const c=(u,h)=>(!r||u.whole.begin>=0)&&u.isWithinTime(h+o,h+l);return this.draw((u,h)=>{kA({...n,time:h,ctx:a,haps:u.filter(d=>c(d,h))})},{lookbehind:o-s,lookahead:l+s,id:i}),this};function C5e(n){return Ov(n)?n.pianoroll():e=>e.pianoroll(n)}function kA({time:n,haps:e,cycles:t=4,playhead:s=.5,flipTime:r=0,flipValues:a=0,hideNegative:i=!1,inactive:o=mc().foreground,active:l=mc().foreground,background:c="transparent",smear:u=0,playheadColor:h=mc().foreground,minMidi:d=10,maxMidi:m=90,autorange:y=0,timeframe:O,fold:S=1,vertical:A=0,labels:F=!1,fill:j=1,fillActive:N=!1,strokeActive:$=!0,stroke:L,hideInactive:I=0,colorizeInactive:q=1,fontFamily:ce,ctx:ee,id:he}={}){const H=ee.canvas.width,me=ee.canvas.height;let Oe=-t*s,Pe=t*(1-s);he&&(e=e.filter(Et=>Et.hasTag(he))),O&&(console.warn("timeframe is deprecated! use from/to instead"),Oe=0,Pe=O);const De=A?me:H,Se=A?H:me;let ae=A?[De,0]:[0,De];const Ee=Pe-Oe,Qe=A?[0,Se]:[Se,0];let Ke=m-d+1,ge=Se/Ke,Ye=[];r&&ae.reverse(),a&&Qe.reverse();const{min:yt,max:Xe,values:Ge}=e.reduce(({min:Et,max:gn,values:On},qn)=>{const cn=DD(qn);return{min:cn<Et?cn:Et,max:cn>gn?cn:gn,values:On.includes(cn)?On:[...On,cn]}},{min:1/0,max:-1/0,values:[]});y&&(d=yt,m=Xe,Ke=m-d+1),Ye=Ge.sort((Et,gn)=>typeof Et=="number"&&typeof gn=="number"?Et-gn:typeof Et=="number"?1:String(Et).localeCompare(String(gn))),ge=S?Se/Ye.length:Se/Ke,ee.fillStyle=c,ee.globalAlpha=1,u||(ee.clearRect(0,0,H,me),ee.fillRect(0,0,H,me)),e.forEach(Et=>{var _n;const gn=Et.whole.begin<=n&&Et.endClipped>n;let On=L??($&&gn),qn=!gn&&j||gn&&N;if(I&&!gn)return;let cn=(_n=Et.value)==null?void 0:_n.color;l=cn||l,o=q&&cn||o,cn=gn?l:o,ee.fillStyle=qn?cn:"transparent",ee.strokeStyle=cn;const{velocity:un=1,gain:Rt=1}=Et.value||{};ee.globalAlpha=un*Rt;const Kt=(Et.whole.begin-(r?Pe:Oe))/Ee,Un=Vp(Kt,...ae);let Wn=Vp(Et.duration/Ee,0,De);const bn=DD(Et),rt=S?Ye.indexOf(bn)/Ye.length:(Number(bn)-d)/Ke,Pn=Vp(rt,...Qe);let pt=0;const Vt=Vp(n/Ee,...ae);let Zt;if(A?Zt=[Pn+1-(a?ge:0),De-Vt+Un+pt+1-(r?0:Wn),ge-2,Wn-2]:Zt=[Un-Vt+pt+1-(r?Wn:0),Pn+1-(a?0:ge),Wn-2,ge-2],On&&ee.strokeRect(...Zt),qn&&ee.fillRect(...Zt),F){const it=Et.value.note??Et.value.s+(Et.value.n?`:${Et.value.n}`:""),{label:Ft,activeLabel:_e}=Et.value,Lt=(gn&&_e||Ft)??it;let et=A?Wn:ge*.75;ee.font=`${et}px ${ce||"monospace"}`,ee.fillStyle=qn?"black":cn,ee.textBaseline="top",ee.fillText(Lt,...Zt)}}),ee.globalAlpha=1;const Ct=Vp(-Oe/Ee,...ae);return ee.strokeStyle=h,ee.beginPath(),A?(ee.moveTo(0,Ct),ee.lineTo(Se,Ct)):(ee.moveTo(Ct,0),ee.lineTo(Ct,Se)),ee.stroke(),this}function mV(n,e={}){let[t,s]=n;t=Math.abs(t);const r=s+t,a=r!==0?t/r:0;return{fold:1,...e,cycles:r,playhead:a}}const Hbe=(n={})=>(e,t,s,r)=>kA({ctx:e,time:t,haps:s,...mV(r,n)});mt.prototype.punchcard=function(n){return this.onPaint(Hbe(n))};mt.prototype.wordfall=function(n){return this.punchcard({vertical:1,labels:1,stroke:0,fillActive:1,active:"white",...n})};function P5e(n){const{drawTime:e,...t}=n;kA({...mV(e),...t})}function Ybe(n,e,t,s){const r=(n-90)*Math.PI/180;return[t+Math.cos(r)*e,s+Math.sin(r)*e]}const TD=(n,e,t,s,r=0)=>Ybe((n+r)*360,e*n,t,s);function BD(n){let{ctx:e,from:t=0,to:s=3,margin:r=50,cx:a=100,cy:i=100,rotate:o=0,thickness:l=r/2,color:c=mc().foreground,cap:u="round",stretch:h=1,fromOpacity:d=1,toOpacity:m=1}=n;t*=h,s*=h,o*=h,e.lineWidth=l,e.lineCap=u,e.strokeStyle=c,e.globalAlpha=d,e.beginPath();let[y,O]=TD(t,r,a,i,o);e.moveTo(y,O);const S=1/60;let A=t;for(;A<=s;){const[F,j]=TD(A,r,a,i,o);e.globalAlpha=(A-t)/(s-t)*m,e.lineTo(F,j),A+=S}e.stroke()}function Kbe(n){let{stretch:e=1,size:t=80,thickness:s=t/2,cap:r="butt",inset:a=3,playheadColor:i="#ffffff",playheadLength:o=.02,playheadThickness:l=s,padding:c=0,steady:u=1,activeColor:h=mc().foreground,inactiveColor:d=mc().gutterForeground,colorizeInactive:m=0,fade:y=!0,ctx:O,time:S,haps:A,drawTime:F,id:j}=n;j&&(A=A.filter(H=>H.hasTag(j)));const[N,$]=[O.canvas.width,O.canvas.height];O.clearRect(0,0,N*2,$*2);const[L,I]=[N/2,$/2],q={margin:t/e,cx:L,cy:I,stretch:e,cap:r,thickness:s},ce={...q,thickness:l,from:a-o,to:a,color:i},[ee]=F,he=u*S;A.forEach(H=>{var Ee;const me=H.whole.begin<=S&&H.endClipped>S,Oe=H.whole.begin-S+a,Pe=H.endClipped-S+a-c,De=((Ee=H.value)==null?void 0:Ee.color)||h,Se=m||me?De:d,ae=y?1-Math.abs((H.whole.begin-S)/ee):1;BD({ctx:O,...q,from:Oe,to:Pe,rotate:he,color:Se,fromOpacity:ae,toOpacity:ae})}),BD({ctx:O,...ce,rotate:he})}mt.prototype.spiral=function(n={}){return this.onPaint((e,t,s,r)=>Kbe({ctx:e,time:t,haps:s,drawTime:r,...n}))};const Jbe=Rd(36),FD=(n,e,t,s)=>{s=s*Math.PI*2;const r=Math.sin(s)*t+n,a=Math.cos(s)*t+e;return[r,a]},$D=(n,e)=>.5-Math.log2(n/e)%1;function eye({haps:n,ctx:e,id:t,hapcircles:s=1,circle:r=0,edo:a=12,root:i=Jbe,thickness:o=3,hapRadius:l=6,mode:c="flake",margin:u=10}={}){const h=c==="polygon",d=c==="flake",m=e.canvas.width,y=e.canvas.height;e.clearRect(0,0,m,y);const O=mc().foreground,S=Math.min(m,y)/2-o/2-l-u,A=m/2,F=y/2;t&&(n=n.filter(N=>N.hasTag(t))),e.strokeStyle=O,e.fillStyle=O,e.globalAlpha=1,e.lineWidth=o,r&&(e.beginPath(),e.arc(A,F,S,0,2*Math.PI),e.stroke()),a&&(Array.from({length:a},(N,$)=>{const L=$D(i*Math.pow(2,$/a),i),[I,q]=FD(A,F,S,L);e.beginPath(),e.arc(I,q,l,0,2*Math.PI),e.fill()}),e.stroke());let j=[];e.lineWidth=l,n.forEach(N=>{let $;try{$=PN(N)}catch{return}const L=$D($,i),[I,q]=FD(A,F,S,L),ce=N.value.color||O;e.strokeStyle=ce,e.fillStyle=ce;const{velocity:ee=1,gain:he=1}=N.value||{},H=ee*he;e.globalAlpha=H,j.push([I,q,L,ce,H]),e.beginPath(),s&&(e.moveTo(I+l,q),e.arc(I,q,l,0,2*Math.PI),e.fill()),d&&(e.moveTo(A,F),e.lineTo(I,q)),e.stroke()}),e.strokeStyle=O,e.globalAlpha=1,h&&j.length&&(j=j.sort((N,$)=>N[2]-$[2]),e.beginPath(),e.moveTo(j[0][0],j[0][1]),j.forEach(([N,$,L,I,q])=>{e.strokeStyle=I,e.globalAlpha=q,e.lineTo(N,$)}),e.lineTo(j[0][0],j[0][1]),e.stroke())}mt.prototype.pitchwheel=function(n={}){let{ctx:e=Ec(),id:t=1}=n;return this.tag(t).onPaint((s,r,a)=>eye({...n,ctx:e,haps:a.filter(i=>i.isActive(r)),id:t}))};function tye(n,e){function t(){this.constructor=n}t.prototype=e.prototype,n.prototype=new t}function vh(n,e,t,s){var r=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(r,vh.prototype),r.expected=e,r.found=t,r.location=s,r.name="SyntaxError",r}tye(vh,Error);function Ew(n,e,t){return t=t||" ",n.length>e?n:(e-=n.length,t+=t.repeat(e),n+t.slice(0,e))}vh.prototype.format=function(n){var e="Error: "+this.message;if(this.location){var t=null,s;for(s=0;s<n.length;s++)if(n[s].source===this.location.source){t=n[s].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,a=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(r):r,i=this.location.source+":"+a.line+":"+a.column;if(t){var o=this.location.end,l=Ew("",a.line.toString().length," "),c=t[r.line-1],u=r.line===o.line?o.column:c.length+1,h=u-r.column||1;e+=`
 --> `+i+`
`+l+` |
`+a.line+" | "+c+`
`+l+" | "+Ew("",r.column-1," ")+Ew("",h,"^")}else e+=`
 at `+i}return e};vh.buildMessage=function(n,e){var t={literal:function(c){return'"'+r(c.text)+'"'},class:function(c){var u=c.parts.map(function(h){return Array.isArray(h)?a(h[0])+"-"+a(h[1]):a(h)});return"["+(c.inverted?"^":"")+u.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(c){return c.description}};function s(c){return c.charCodeAt(0).toString(16).toUpperCase()}function r(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+s(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+s(u)})}function a(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(u){return"\\x0"+s(u)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(u){return"\\x"+s(u)})}function i(c){return t[c.type](c)}function o(c){var u=c.map(i),h,d;if(u.sort(),u.length>0){for(h=1,d=1;h<u.length;h++)u[h-1]!==u[h]&&(u[d]=u[h],d++);u.length=d}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}function l(c){return c?'"'+r(c)+'"':"end of input"}return"Expected "+o(n)+" but "+l(e)+" found."};function fV(n,e){e=e!==void 0?e:{};var t={},s=e.grammarSource,r={start:zt},a=zt,i=".",o="-",l="0",c=",",u="|",h="[",d="]",m="{",y="}",O="%",S="<",A=">",F="!",j="(",N=")",$="/",L="*",I="?",q=":",ce="..",ee="^",he="struct",H="target",me="euclid",Oe="slow",Pe="rotL",De="rotR",Se="fast",ae="scale",Ee="//",Qe="cat",Ke="$",ge="setcps",Ye="setbpm",yt="hush",Xe=/^[1-9]/,Ge=/^[eE]/,Ct=/^[+\-]/,Et=/^[0-9]/,gn=/^[ \n\r\t\xA0]/,On=/^["']/,qn=/^[#\--.0-9A-Z\^-_a-z~\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u09FC\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7B9\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD-\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,cn=/^[@_]/,un=/^[^\n]/,Rt=tt("number"),Kt=Ne(".",!1),Un=ot([["1","9"]],!1,!1),Wn=ot(["e","E"],!1,!1),bn=ot(["+","-"],!1,!1),rt=Ne("-",!1),Pn=Ne("0",!1),pt=ot([["0","9"]],!1,!1),Vt=tt("whitespace"),Zt=ot([" ",`
`,"\r","	"," "],!1,!1),_n=Ne(",",!1),it=Ne("|",!1),Ft=ot(['"',"'"],!1,!1),_e=tt('a letter, a number, "-", "#", ".", "^", "_"'),Lt=ot(["#",["-","."],["0","9"],["A","Z"],["^","_"],["a","z"],"~","ª","µ","º",["À","Ö"],["Ø","ö"],["ø","ˁ"],["ˆ","ˑ"],["ˠ","ˤ"],"ˬ","ˮ",["Ͱ","ʹ"],["Ͷ","ͷ"],["ͺ","ͽ"],"Ϳ","Ά",["Έ","Ί"],"Ό",["Ύ","Ρ"],["Σ","ϵ"],["Ϸ","ҁ"],["Ҋ","ԯ"],["Ա","Ֆ"],"ՙ",["ՠ","ֈ"],["א","ת"],["ׯ","ײ"],["ؠ","ي"],["ٮ","ٯ"],["ٱ","ۓ"],"ە",["ۥ","ۦ"],["ۮ","ۯ"],["ۺ","ۼ"],"ۿ","ܐ",["ܒ","ܯ"],["ݍ","ޥ"],"ޱ",["ߊ","ߪ"],["ߴ","ߵ"],"ߺ",["ࠀ","ࠕ"],"ࠚ","ࠤ","ࠨ",["ࡀ","ࡘ"],["ࡠ","ࡪ"],["ࢠ","ࢴ"],["ࢶ","ࢽ"],["ऄ","ह"],"ऽ","ॐ",["क़","ॡ"],["ॱ","ঀ"],["অ","ঌ"],["এ","ঐ"],["ও","ন"],["প","র"],"ল",["শ","হ"],"ঽ","ৎ",["ড়","ঢ়"],["য়","ৡ"],["ৰ","ৱ"],"ৼ",["ਅ","ਊ"],["ਏ","ਐ"],["ਓ","ਨ"],["ਪ","ਰ"],["ਲ","ਲ਼"],["ਵ","ਸ਼"],["ਸ","ਹ"],["ਖ਼","ੜ"],"ਫ਼",["ੲ","ੴ"],["અ","ઍ"],["એ","ઑ"],["ઓ","ન"],["પ","ર"],["લ","ળ"],["વ","હ"],"ઽ","ૐ",["ૠ","ૡ"],"ૹ",["ଅ","ଌ"],["ଏ","ଐ"],["ଓ","ନ"],["ପ","ର"],["ଲ","ଳ"],["ଵ","ହ"],"ଽ",["ଡ଼","ଢ଼"],["ୟ","ୡ"],"ୱ","ஃ",["அ","ஊ"],["எ","ஐ"],["ஒ","க"],["ங","ச"],"ஜ",["ஞ","ட"],["ண","த"],["ந","ப"],["ம","ஹ"],"ௐ",["అ","ఌ"],["ఎ","ఐ"],["ఒ","న"],["ప","హ"],"ఽ",["ౘ","ౚ"],["ౠ","ౡ"],"ಀ",["ಅ","ಌ"],["ಎ","ಐ"],["ಒ","ನ"],["ಪ","ಳ"],["ವ","ಹ"],"ಽ","ೞ",["ೠ","ೡ"],["ೱ","ೲ"],["അ","ഌ"],["എ","ഐ"],["ഒ","ഺ"],"ഽ","ൎ",["ൔ","ൖ"],["ൟ","ൡ"],["ൺ","ൿ"],["අ","ඖ"],["ක","න"],["ඳ","ර"],"ල",["ව","ෆ"],["ก","ะ"],["า","ำ"],["เ","ๆ"],["ກ","ຂ"],"ຄ",["ງ","ຈ"],"ຊ","ຍ",["ດ","ທ"],["ນ","ຟ"],["ມ","ຣ"],"ລ","ວ",["ສ","ຫ"],["ອ","ະ"],["າ","ຳ"],"ຽ",["ເ","ໄ"],"ໆ",["ໜ","ໟ"],"ༀ",["ཀ","ཇ"],["ཉ","ཬ"],["ྈ","ྌ"],["က","ဪ"],"ဿ",["ၐ","ၕ"],["ၚ","ၝ"],"ၡ",["ၥ","ၦ"],["ၮ","ၰ"],["ၵ","ႁ"],"ႎ",["Ⴀ","Ⴥ"],"Ⴧ","Ⴭ",["ა","ჺ"],["ჼ","ቈ"],["ቊ","ቍ"],["ቐ","ቖ"],"ቘ",["ቚ","ቝ"],["በ","ኈ"],["ኊ","ኍ"],["ነ","ኰ"],["ኲ","ኵ"],["ኸ","ኾ"],"ዀ",["ዂ","ዅ"],["ወ","ዖ"],["ዘ","ጐ"],["ጒ","ጕ"],["ጘ","ፚ"],["ᎀ","ᎏ"],["Ꭰ","Ᏽ"],["ᏸ","ᏽ"],["ᐁ","ᙬ"],["ᙯ","ᙿ"],["ᚁ","ᚚ"],["ᚠ","ᛪ"],["ᛮ","ᛸ"],["ᜀ","ᜌ"],["ᜎ","ᜑ"],["ᜠ","ᜱ"],["ᝀ","ᝑ"],["ᝠ","ᝬ"],["ᝮ","ᝰ"],["ក","ឳ"],"ៗ","ៜ",["ᠠ","ᡸ"],["ᢀ","ᢄ"],["ᢇ","ᢨ"],"ᢪ",["ᢰ","ᣵ"],["ᤀ","ᤞ"],["ᥐ","ᥭ"],["ᥰ","ᥴ"],["ᦀ","ᦫ"],["ᦰ","ᧉ"],["ᨀ","ᨖ"],["ᨠ","ᩔ"],"ᪧ",["ᬅ","ᬳ"],["ᭅ","ᭋ"],["ᮃ","ᮠ"],["ᮮ","ᮯ"],["ᮺ","ᯥ"],["ᰀ","ᰣ"],["ᱍ","ᱏ"],["ᱚ","ᱽ"],["ᲀ","ᲈ"],["Ა","Ჺ"],["Ჽ","Ჿ"],["ᳩ","ᳬ"],["ᳮ","ᳱ"],["ᳵ","ᳶ"],["ᴀ","ᶿ"],["Ḁ","ἕ"],["Ἐ","Ἕ"],["ἠ","ὅ"],["Ὀ","Ὅ"],["ὐ","ὗ"],"Ὑ","Ὓ","Ὕ",["Ὗ","ώ"],["ᾀ","ᾴ"],["ᾶ","ᾼ"],"ι",["ῂ","ῄ"],["ῆ","ῌ"],["ῐ","ΐ"],["ῖ","Ί"],["ῠ","Ῥ"],["ῲ","ῴ"],["ῶ","ῼ"],"ⁱ","ⁿ",["ₐ","ₜ"],"ℂ","ℇ",["ℊ","ℓ"],"ℕ",["ℙ","ℝ"],"ℤ","Ω","ℨ",["K","ℭ"],["ℯ","ℹ"],["ℼ","ℿ"],["ⅅ","ⅉ"],"ⅎ",["Ⅰ","ↈ"],["Ⰰ","Ⱞ"],["ⰰ","ⱞ"],["Ⱡ","ⳤ"],["Ⳬ","ⳮ"],["Ⳳ","ⳳ"],["ⴀ","ⴥ"],"ⴧ","ⴭ",["ⴰ","ⵧ"],"ⵯ",["ⶀ","ⶖ"],["ⶠ","ⶦ"],["ⶨ","ⶮ"],["ⶰ","ⶶ"],["ⶸ","ⶾ"],["ⷀ","ⷆ"],["ⷈ","ⷎ"],["ⷐ","ⷖ"],["ⷘ","ⷞ"],"ⸯ",["々","〇"],["〡","〩"],["〱","〵"],["〸","〼"],["ぁ","ゖ"],["ゝ","ゟ"],["ァ","ヺ"],["ー","ヿ"],["ㄅ","ㄯ"],["ㄱ","ㆎ"],["ㆠ","ㆺ"],["ㇰ","ㇿ"],["㐀","䶵"],["一","鿯"],["ꀀ","ꒌ"],["ꓐ","ꓽ"],["ꔀ","ꘌ"],["ꘐ","ꘟ"],["ꘪ","ꘫ"],["Ꙁ","ꙮ"],["ꙿ","ꚝ"],["ꚠ","ꛯ"],["ꜗ","ꜟ"],["Ꜣ","ꞈ"],["Ꞌ","ꞹ"],["ꟷ","ꠁ"],["ꠃ","ꠅ"],["ꠇ","ꠊ"],["ꠌ","ꠢ"],["ꡀ","ꡳ"],["ꢂ","ꢳ"],["ꣲ","ꣷ"],"ꣻ",["ꣽ","ꣾ"],["ꤊ","ꤥ"],["ꤰ","ꥆ"],["ꥠ","ꥼ"],["ꦄ","ꦲ"],"ꧏ",["ꧠ","ꧤ"],["ꧦ","ꧯ"],["ꧺ","ꧾ"],["ꨀ","ꨨ"],["ꩀ","ꩂ"],["ꩄ","ꩋ"],["ꩠ","ꩶ"],"ꩺ",["ꩾ","ꪯ"],"ꪱ",["ꪵ","ꪶ"],["ꪹ","ꪽ"],"ꫀ","ꫂ",["ꫛ","ꫝ"],["ꫠ","ꫪ"],["ꫲ","ꫴ"],["ꬁ","ꬆ"],["ꬉ","ꬎ"],["ꬑ","ꬖ"],["ꬠ","ꬦ"],["ꬨ","ꬮ"],["ꬰ","ꭚ"],["ꭜ","ꭥ"],["ꭰ","ꯢ"],["가","힣"],["ힰ","ퟆ"],["ퟋ","ퟻ"],["豈","舘"],["並","龎"],["ﬀ","ﬆ"],["ﬓ","ﬗ"],"יִ",["ײַ","ﬨ"],["שׁ","זּ"],["טּ","לּ"],"מּ",["נּ","סּ"],["ףּ","פּ"],["צּ","ﮱ"],["ﯓ","ﴽ"],["ﵐ","ﶏ"],["ﶒ","ﷇ"],["ﷰ","ﷻ"],["ﹰ","ﹴ"],["ﹶ","ﻼ"],["Ａ","Ｚ"],["ａ","ｚ"],["ｦ","ﾾ"],["ￂ","ￇ"],["ￊ","ￏ"],["ￒ","ￗ"],["ￚ","ￜ"]],!1,!1),et=Ne("[",!1),is=Ne("]",!1),It=Ne("{",!1),Dn=Ne("}",!1),Cs=Ne("%",!1),Wt=Ne("<",!1),Pt=Ne(">",!1),$t=ot(["@","_"],!1,!1),xn=Ne("!",!1),st=Ne("(",!1),Gt=Ne(")",!1),an=Ne("/",!1),vs=Ne("*",!1),Vn=Ne("?",!1),Hs=Ne(":",!1),Ys=Ne("..",!1),w=Ne("^",!1),_=Ne("struct",!1),B=Ne("target",!1),R=Ne("euclid",!1),Z=Ne("slow",!1),Y=Ne("rotL",!1),se=Ne("rotR",!1),te=Ne("fast",!1),be=Ne("scale",!1),$e=Ne("//",!1),Re=ot([`
`],!0,!1),ut=Ne("cat",!1),on=Ne("$",!1),Yn=Ne("setcps",!1),Is=Ne("setbpm",!1),mn=Ne("hush",!1),Jt=function(){return parseFloat(Ze())},sn=function(k){const V=k.join("");return V==="."||V==="_"},ps=function(k){return new cO(k.join(""))},cr=function(k){return k},$i=function(k,V){return k.arguments_.stepsPerCycle=V,k},Gr=function(k){return k},hi=function(k){return k.arguments_.alignment="polymeter_slowcat",k},di=function(k){return V=>V.options_.weight=(V.options_.weight??1)+(k??2)-1},Ls=function(k){return V=>{const U=(V.options_.reps??1)+(k??2)-1;V.options_.reps=U,V.options_.ops=V.options_.ops.filter(ve=>ve.type_!=="replicate"),V.options_.ops.push({type_:"replicate",arguments_:{amount:U}}),V.options_.weight=U}},ql=function(k,V,U){return ve=>ve.options_.ops.push({type_:"bjorklund",arguments_:{pulse:k,step:V,rotation:U}})},Dr=function(k){return V=>V.options_.ops.push({type_:"stretch",arguments_:{amount:k,type:"slow"}})},nl=function(k){return V=>V.options_.ops.push({type_:"stretch",arguments_:{amount:k,type:"fast"}})},Ni=function(k){return V=>V.options_.ops.push({type_:"degradeBy",arguments_:{amount:k,seed:Bu++}})},Xr=function(k){return V=>V.options_.ops.push({type_:"tail",arguments_:{element:k}})},Ul=function(k){return V=>V.options_.ops.push({type_:"range",arguments_:{element:k}})},_i=function(k,V){const U=new hO(k,{ops:[],weight:1,reps:1});for(const ve of V)ve(U);return U},Ks=function(k,V){return new Hl(V,"fastcat",void 0,!!k)},Da=function(k){return{alignment:"stack",list:k}},Fs=function(k){return{alignment:"rand",list:k,seed:Bu++}},Js=function(k){return{alignment:"feet",list:k,seed:Bu++}},da=function(k,V){return V&&V.list.length>0?new Hl([k,...V.list],V.alignment,V.seed):k},Ta=function(k,V){return new Hl(V?[k,...V.list]:[k],"polymeter")},Hr=function(k){return k},Ba=function(k){return{name:"struct",args:{mini:k}}},Yr=function(k){return{name:"target",args:{name:k}}},Wl=function(k,V,U){return{name:"bjorklund",args:{pulse:k,step:parseInt(V)}}},Ir=function(k){return{name:"stretch",args:{amount:k}}},Or=function(k){return{name:"shift",args:{amount:"-"+k}}},Tn=function(k){return{name:"shift",args:{amount:k}}},wr=function(k){return{name:"stretch",args:{amount:"1/"+k}}},fn=function(k){return{name:"scale",args:{scale:k.join("")}}},Oo=function(k,V){return V},Kr=function(k,V){return V.unshift(k),new Hl(V,"slowcat")},Gl=function(k){return k},Tr=function(k,V){return new uO(k.name,k.args,V)},wo=function(k){return k},pa=function(k){return k},K=function(k){return new Tu("setcps",{value:k})},J=function(k){return new Tu("setcps",{value:k/120/2})},ne=function(){return new Tu("hush")},M=e.peg$currPos|0,ue=M,we=[{line:1,column:1}],xe=M,Ae=e.peg$maxFailExpected||[],fe=e.peg$silentFails|0,Fe;if(e.startRule){if(!(e.startRule in r))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');a=r[e.startRule]}function Ze(){return n.substring(ue,M)}function Te(){return Je(ue,M)}function Ne(k,V){return{type:"literal",text:k,ignoreCase:V}}function ot(k,V,U){return{type:"class",parts:k,inverted:V,ignoreCase:U}}function at(){return{type:"end"}}function tt(k){return{type:"other",description:k}}function Ue(k){var V=we[k],U;if(V)return V;if(k>=we.length)U=we.length-1;else for(U=k;!we[--U];);for(V=we[U],V={line:V.line,column:V.column};U<k;)n.charCodeAt(U)===10?(V.line++,V.column=1):V.column++,U++;return we[k]=V,V}function Je(k,V,U){var ve=Ue(k),We=Ue(V),pn={source:s,start:{offset:k,line:ve.line,column:ve.column},end:{offset:V,line:We.line,column:We.column}};return pn}function Me(k){M<xe||(M>xe&&(xe=M,Ae=[]),Ae.push(k))}function He(k,V,U){return new vh(vh.buildMessage(k,V),k,V,U)}function zt(){var k;return k=lO(),k}function Tt(){var k,V;return fe++,k=M,P(),V=x(),V!==t?(Ps(),os(),ue=k,k=Jt()):(M=k,k=t),fe--,k===t&&fe===0&&Me(Rt),k}function hn(){var k;return n.charCodeAt(M)===46?(k=i,M++):(k=t,fe===0&&Me(Kt)),k}function Bn(){var k;return k=n.charAt(M),Xe.test(k)?M++:(k=t,fe===0&&Me(Un)),k}function wn(){var k;return k=n.charAt(M),Ge.test(k)?M++:(k=t,fe===0&&Me(Wn)),k}function os(){var k,V,U,ve,We;if(k=M,V=wn(),V!==t){if(U=n.charAt(M),Ct.test(U)?M++:(U=t,fe===0&&Me(bn)),U===t&&(U=null),ve=[],We=p(),We!==t)for(;We!==t;)ve.push(We),We=p();else ve=t;ve!==t?(V=[V,U,ve],k=V):(M=k,k=t)}else M=k,k=t;return k}function Ps(){var k,V,U,ve;if(k=M,V=hn(),V!==t){if(U=[],ve=p(),ve!==t)for(;ve!==t;)U.push(ve),ve=p();else U=t;U!==t?(V=[V,U],k=V):(M=k,k=t)}else M=k,k=t;return k}function x(){var k,V,U,ve;if(k=T(),k===t)if(k=M,V=Bn(),V!==t){for(U=[],ve=p();ve!==t;)U.push(ve),ve=p();V=[V,U],k=V}else M=k,k=t;return k}function P(){var k;return n.charCodeAt(M)===45?(k=o,M++):(k=t,fe===0&&Me(rt)),k}function T(){var k;return n.charCodeAt(M)===48?(k=l,M++):(k=t,fe===0&&Me(Pn)),k}function p(){var k;return k=n.charAt(M),Et.test(k)?M++:(k=t,fe===0&&Me(pt)),k}function f(){var k,V;for(fe++,k=[],V=n.charAt(M),gn.test(V)?M++:(V=t,fe===0&&Me(Zt));V!==t;)k.push(V),V=n.charAt(M),gn.test(V)?M++:(V=t,fe===0&&Me(Zt));return fe--,V=t,fe===0&&Me(Vt),k}function v(){var k,V,U,ve;return k=M,V=f(),n.charCodeAt(M)===44?(U=c,M++):(U=t,fe===0&&Me(_n)),U!==t?(ve=f(),V=[V,U,ve],k=V):(M=k,k=t),k}function C(){var k,V,U,ve;return k=M,V=f(),n.charCodeAt(M)===124?(U=u,M++):(U=t,fe===0&&Me(it)),U!==t?(ve=f(),V=[V,U,ve],k=V):(M=k,k=t),k}function E(){var k,V,U,ve;return k=M,V=f(),n.charCodeAt(M)===46?(U=i,M++):(U=t,fe===0&&Me(Kt)),U!==t?(ve=f(),V=[V,U,ve],k=V):(M=k,k=t),k}function D(){var k;return k=n.charAt(M),On.test(k)?M++:(k=t,fe===0&&Me(Ft)),k}function Q(){var k;return fe++,k=n.charAt(M),qn.test(k)?M++:(k=t,fe===0&&Me(Lt)),fe--,k===t&&fe===0&&Me(_e),k}function z(){var k,V,U,ve;if(k=M,f(),V=[],U=Q(),U!==t)for(;U!==t;)V.push(U),U=Q();else V=t;return V!==t?(U=f(),ue=M,ve=sn(V),ve?ve=t:ve=void 0,ve!==t?(ue=k,k=ps(V)):(M=k,k=t)):(M=k,k=t),k}function W(){var k,V,U,ve;return k=M,f(),n.charCodeAt(M)===91?(V=h,M++):(V=t,fe===0&&Me(et)),V!==t?(f(),U=Gn(),U!==t?(f(),n.charCodeAt(M)===93?(ve=d,M++):(ve=t,fe===0&&Me(is)),ve!==t?(f(),ue=k,k=cr(U)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function G(){var k,V,U,ve,We;return k=M,f(),n.charCodeAt(M)===123?(V=m,M++):(V=t,fe===0&&Me(It)),V!==t?(f(),U=An(),U!==t?(f(),n.charCodeAt(M)===125?(ve=y,M++):(ve=t,fe===0&&Me(Dn)),ve!==t?(We=X(),We===t&&(We=null),f(),ue=k,k=$i(U,We)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function X(){var k,V,U;return k=M,n.charCodeAt(M)===37?(V=O,M++):(V=t,fe===0&&Me(Cs)),V!==t?(U=de(),U!==t?(ue=k,k=Gr(U)):(M=k,k=t)):(M=k,k=t),k}function re(){var k,V,U,ve;return k=M,f(),n.charCodeAt(M)===60?(V=S,M++):(V=t,fe===0&&Me(Wt)),V!==t?(f(),U=An(),U!==t?(f(),n.charCodeAt(M)===62?(ve=A,M++):(ve=t,fe===0&&Me(Pt)),ve!==t?(f(),ue=k,k=hi(U)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function de(){var k;return k=z(),k===t&&(k=W(),k===t&&(k=G(),k===t&&(k=re()))),k}function pe(){var k;return k=ye(),k===t&&(k=Be(),k===t&&(k=je(),k===t&&(k=Ie(),k===t&&(k=Ce(),k===t&&(k=nt(),k===t&&(k=Nt(),k===t&&(k=ht()))))))),k}function ye(){var k,V,U;return k=M,f(),V=n.charAt(M),cn.test(V)?M++:(V=t,fe===0&&Me($t)),V!==t?(U=Tt(),U===t&&(U=null),ue=k,k=di(U)):(M=k,k=t),k}function Ce(){var k,V,U;return k=M,f(),n.charCodeAt(M)===33?(V=F,M++):(V=t,fe===0&&Me(xn)),V!==t?(U=Tt(),U===t&&(U=null),ue=k,k=Ls(U)):(M=k,k=t),k}function Be(){var k,V,U,ve,We,pn,Ws;return k=M,n.charCodeAt(M)===40?(V=j,M++):(V=t,fe===0&&Me(st)),V!==t?(f(),U=Ot(),U!==t?(f(),ve=v(),ve!==t?(f(),We=Ot(),We!==t?(f(),v(),f(),pn=Ot(),pn===t&&(pn=null),f(),n.charCodeAt(M)===41?(Ws=N,M++):(Ws=t,fe===0&&Me(Gt)),Ws!==t?(ue=k,k=ql(U,We,pn)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function je(){var k,V,U;return k=M,n.charCodeAt(M)===47?(V=$,M++):(V=t,fe===0&&Me(an)),V!==t?(U=de(),U!==t?(ue=k,k=Dr(U)):(M=k,k=t)):(M=k,k=t),k}function Ie(){var k,V,U;return k=M,n.charCodeAt(M)===42?(V=L,M++):(V=t,fe===0&&Me(vs)),V!==t?(U=de(),U!==t?(ue=k,k=nl(U)):(M=k,k=t)):(M=k,k=t),k}function nt(){var k,V,U;return k=M,n.charCodeAt(M)===63?(V=I,M++):(V=t,fe===0&&Me(Vn)),V!==t?(U=Tt(),U===t&&(U=null),ue=k,k=Ni(U)):(M=k,k=t),k}function Nt(){var k,V,U;return k=M,n.charCodeAt(M)===58?(V=q,M++):(V=t,fe===0&&Me(Hs)),V!==t?(U=de(),U!==t?(ue=k,k=Xr(U)):(M=k,k=t)):(M=k,k=t),k}function ht(){var k,V,U;return k=M,n.substr(M,2)===ce?(V=ce,M+=2):(V=t,fe===0&&Me(Ys)),V!==t?(U=de(),U!==t?(ue=k,k=Ul(U)):(M=k,k=t)):(M=k,k=t),k}function Ot(){var k,V,U,ve;if(k=M,V=de(),V!==t){for(U=[],ve=pe();ve!==t;)U.push(ve),ve=pe();ue=k,k=_i(V,U)}else M=k,k=t;return k}function Ut(){var k,V,U,ve;if(k=M,n.charCodeAt(M)===94?(V=ee,M++):(V=t,fe===0&&Me(w)),V===t&&(V=null),U=[],ve=Ot(),ve!==t)for(;ve!==t;)U.push(ve),ve=Ot();else U=t;return U!==t?(ue=k,k=Ks(V,U)):(M=k,k=t),k}function Ht(){var k,V,U,ve,We;if(k=M,V=[],U=M,ve=v(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t),U!==t)for(;U!==t;)V.push(U),U=M,ve=v(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t);else V=t;return V!==t&&(ue=k,V=Da(V)),k=V,k}function ct(){var k,V,U,ve,We;if(k=M,V=[],U=M,ve=C(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t),U!==t)for(;U!==t;)V.push(U),U=M,ve=C(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t);else V=t;return V!==t&&(ue=k,V=Fs(V)),k=V,k}function dn(){var k,V,U,ve,We;if(k=M,V=[],U=M,ve=E(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t),U!==t)for(;U!==t;)V.push(U),U=M,ve=E(),ve!==t?(We=Ut(),We!==t?U=We:(M=U,U=t)):(M=U,U=t);else V=t;return V!==t&&(ue=k,V=Js(V)),k=V,k}function Gn(){var k,V,U;return k=M,V=Ut(),V!==t?(U=Ht(),U===t&&(U=ct(),U===t&&(U=dn())),U===t&&(U=null),ue=k,k=da(V,U)):(M=k,k=t),k}function An(){var k,V,U;return k=M,V=Ut(),V!==t?(U=Ht(),U===t&&(U=null),ue=k,k=Ta(V,U)):(M=k,k=t),k}function Rn(){var k,V,U,ve;return k=M,f(),V=D(),V!==t?(f(),U=Gn(),U!==t?(f(),ve=D(),ve!==t?(ue=k,k=Hr(U)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function er(){var k;return k=Jv(),k===t&&(k=Jr(),k===t&&(k=Kv(),k===t&&(k=sr(),k===t&&(k=rr(),k===t&&(k=ur(),k===t&&(k=Yv(),k===t&&(k=Xl()))))))),k}function ur(){var k,V,U;return k=M,n.substr(M,6)===he?(V=he,M+=6):(V=t,fe===0&&Me(_)),V!==t?(f(),U=pi(),U!==t?(ue=k,k=Ba(U)):(M=k,k=t)):(M=k,k=t),k}function sr(){var k,V,U,ve,We;return k=M,n.substr(M,6)===H?(V=H,M+=6):(V=t,fe===0&&Me(B)),V!==t?(f(),U=D(),U!==t?(ve=z(),ve!==t?(We=D(),We!==t?(ue=k,k=Yr(ve)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function rr(){var k,V,U,ve;return k=M,n.substr(M,6)===me?(V=me,M+=6):(V=t,fe===0&&Me(R)),V!==t?(f(),U=x(),U!==t?(f(),ve=x(),ve!==t?(f(),x(),ue=k,k=Wl(U,ve)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t),k}function Jr(){var k,V,U;return k=M,n.substr(M,4)===Oe?(V=Oe,M+=4):(V=t,fe===0&&Me(Z)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=Ir(U)):(M=k,k=t)):(M=k,k=t),k}function Xl(){var k,V,U;return k=M,n.substr(M,4)===Pe?(V=Pe,M+=4):(V=t,fe===0&&Me(Y)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=Or(U)):(M=k,k=t)):(M=k,k=t),k}function Yv(){var k,V,U;return k=M,n.substr(M,4)===De?(V=De,M+=4):(V=t,fe===0&&Me(se)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=Tn(U)):(M=k,k=t)):(M=k,k=t),k}function Kv(){var k,V,U;return k=M,n.substr(M,4)===Se?(V=Se,M+=4):(V=t,fe===0&&Me(te)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=wr(U)):(M=k,k=t)):(M=k,k=t),k}function Jv(){var k,V,U,ve,We;if(k=M,n.substr(M,5)===ae?(V=ae,M+=5):(V=t,fe===0&&Me(be)),V!==t)if(f(),U=D(),U!==t){if(ve=[],We=Q(),We!==t)for(;We!==t;)ve.push(We),We=Q();else ve=t;ve!==t?(We=D(),We!==t?(ue=k,k=fn(ve)):(M=k,k=t)):(M=k,k=t)}else M=k,k=t;else M=k,k=t;return k}function Du(){var k,V,U,ve;if(k=M,n.substr(M,2)===Ee?(V=Ee,M+=2):(V=t,fe===0&&Me($e)),V!==t){for(U=[],ve=n.charAt(M),un.test(ve)?M++:(ve=t,fe===0&&Me(Re));ve!==t;)U.push(ve),ve=n.charAt(M),un.test(ve)?M++:(ve=t,fe===0&&Me(Re));V=[V,U],k=V}else M=k,k=t;return k}function eO(){var k,V,U,ve,We,pn,Ws,mi;if(k=M,n.substr(M,3)===Qe?(V=Qe,M+=3):(V=t,fe===0&&Me(ut)),V!==t)if(f(),n.charCodeAt(M)===91?(U=h,M++):(U=t,fe===0&&Me(et)),U!==t)if(f(),ve=pi(),ve!==t){for(We=[],pn=M,Ws=v(),Ws!==t?(mi=pi(),mi!==t?(ue=pn,pn=Oo(ve,mi)):(M=pn,pn=t)):(M=pn,pn=t);pn!==t;)We.push(pn),pn=M,Ws=v(),Ws!==t?(mi=pi(),mi!==t?(ue=pn,pn=Oo(ve,mi)):(M=pn,pn=t)):(M=pn,pn=t);pn=f(),n.charCodeAt(M)===93?(Ws=d,M++):(Ws=t,fe===0&&Me(is)),Ws!==t?(ue=k,k=Kr(ve,We)):(M=k,k=t)}else M=k,k=t;else M=k,k=t;else M=k,k=t;return k}function tO(){var k;return k=eO(),k===t&&(k=Rn()),k}function pi(){var k,V,U,ve,We;if(k=M,V=tO(),V!==t){for(f(),U=[],ve=Du();ve!==t;)U.push(ve),ve=Du();ue=k,k=Gl(V)}else M=k,k=t;return k===t&&(k=M,V=er(),V!==t?(f(),n.charCodeAt(M)===36?(U=Ke,M++):(U=t,fe===0&&Me(on)),U!==t?(ve=f(),We=pi(),We!==t?(ue=k,k=Tr(V,We)):(M=k,k=t)):(M=k,k=t)):(M=k,k=t)),k}function nO(){var k,V;return k=M,V=pi(),V!==t&&(ue=k,V=wo(V)),k=V,k===t&&(k=Du()),k}function sO(){var k;return k=nO(),k}function rO(){var k,V;return k=M,f(),V=aO(),V===t&&(V=iO(),V===t&&(V=oO())),V!==t?(f(),ue=k,k=pa(V)):(M=k,k=t),k}function aO(){var k,V,U;return k=M,n.substr(M,6)===ge?(V=ge,M+=6):(V=t,fe===0&&Me(Yn)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=K(U)):(M=k,k=t)):(M=k,k=t),k}function iO(){var k,V,U;return k=M,n.substr(M,6)===Ye?(V=Ye,M+=6):(V=t,fe===0&&Me(Is)),V!==t?(f(),U=Tt(),U!==t?(ue=k,k=J(U)):(M=k,k=t)):(M=k,k=t),k}function oO(){var k,V;return k=M,n.substr(M,4)===yt?(V=yt,M+=4):(V=t,fe===0&&Me(mn)),V!==t&&(ue=k,V=ne()),k=V,k}function lO(){var k;return k=sO(),k===t&&(k=rO()),k}var cO=function(k){this.type_="atom",this.source_=k,this.location_=Te()},Hl=function(k,V,U,ve){this.type_="pattern",this.arguments_={alignment:V,_steps:ve},U!==void 0&&(this.arguments_.seed=U),this.source_=k},uO=function(k,V,U){this.type_=k,this.arguments_=V,this.source_=U},hO=function(k,V){this.type_="element",this.source_=k,this.options_=V,this.location_=Te()},Tu=function(k,V){this.type_="command",this.name_=k,this.options_=V},Bu=0;if(Fe=a(),e.peg$library)return{peg$result:Fe,peg$currPos:M,peg$FAILED:t,peg$maxFailExpected:Ae,peg$maxFailPos:xe};if(Fe!==t&&M===n.length)return Fe;throw Fe!==t&&M<n.length&&Me(at()),He(Ae,xe<n.length?n.charAt(xe):null,xe<n.length?Je(xe,xe+1):Je(xe,xe))}const nye=["start"],gV=3e-4,sye=(n,e)=>(t,s)=>{var i;const r=(i=n.source_[s].options_)==null?void 0:i.ops,a=t.__steps_source;if(r)for(const o of r)switch(o.type_){case"stretch":{const l=["fast","slow"],{type:c,amount:u}=o.arguments_;if(!l.includes(c))throw new Error(`mini: stretch: type must be one of ${l.join("|")} but got ${c}`);t=bt(t)[c](e(u));break}case"replicate":{const{amount:l}=o.arguments_;t=bt(t),t=t._repeatCycles(l)._fast(l);break}case"bjorklund":{o.arguments_.rotation?t=t.euclidRot(e(o.arguments_.pulse),e(o.arguments_.step),e(o.arguments_.rotation)):t=t.euclid(e(o.arguments_.pulse),e(o.arguments_.step));break}case"degradeBy":{t=bt(t)._degradeByWith(Aa.early(gV*o.arguments_.seed),o.arguments_.amount??.5);break}case"tail":{const l=e(o.arguments_.element);t=t.fmap(c=>u=>Array.isArray(c)?[...c,u]:[c,u]).appLeft(l);break}case"range":{const l=e(o.arguments_.element);t=bt(t);const c=(u,h,d=1)=>Array.from({length:Math.abs(h-u)/d+1},(m,y)=>u<h?u+y*d:u-y*d);t=((u,h)=>u.squeezeBind(d=>h.bind(m=>ua(...c(d,m)))))(t,l);break}default:console.warn(`operator "${o.type_}" not implemented`)}return t.__steps_source=t.__steps_source||a,t};function fp(n,e,t,s=0){t==null||t(n);const r=a=>fp(a,e,t,s);switch(n.type_){case"pattern":{const a=n.source_.map(c=>r(c)).map(sye(n,r)),i=n.arguments_.alignment,o=a.filter(c=>c.__steps_source);let l;switch(i){case"stack":{l=Xs(...a),o.length&&(l._steps=Lo(...o.map(c=>dt(c._steps))));break}case"polymeter_slowcat":{l=Xs(...a.map(c=>c._slow(c.__weight))),o.length&&(l._steps=Lo(...o.map(c=>dt(c._steps))));break}case"polymeter":{const c=n.arguments_.stepsPerCycle?r(n.arguments_.stepsPerCycle).fmap(h=>dt(h)):Cr(dt(a.length>0?a[0].__weight:1)),u=a.map(h=>h.fast(c.fmap(d=>d.div(h.__weight))));l=Xs(...u);break}case"rand":{l=Pv(Aa.early(gV*n.arguments_.seed).segment(1),a),o.length&&(l._steps=Lo(...o.map(c=>dt(c._steps))));break}case"feet":{l=ua(...a);break}default:{if(n.source_.some(c=>{var u;return!!((u=c.options_)!=null&&u.weight)})){const c=n.source_.reduce((u,h)=>{var d;return u.add(((d=h.options_)==null?void 0:d.weight)||dt(1))},dt(0));l=iA(...n.source_.map((u,h)=>{var d;return[((d=u.options_)==null?void 0:d.weight)||dt(1),a[h]]})),l.__weight=c,l._steps=c,o.length&&(l._steps=l._steps.mul(Lo(...o.map(u=>dt(u._steps)))))}else l=Xo(...a),l._steps=a.length;n.arguments_._steps&&(l.__steps_source=!0)}}return o.length&&(l.__steps_source=!0),l}case"element":return r(n.source_);case"atom":{if(n.source_==="~"||n.source_==="-")return xs;if(!n.location_)return console.warn("no location for",n),n.source_;const a=isNaN(Number(n.source_))?n.source_:Number(n.source_);if(s===-1)return Cr(a);const[i,o]=SA(e,n,s);return Cr(a).withLoc(i,o)}case"stretch":return r(n.source_).slow(r(n.arguments_.amount));default:return console.warn(`node type "${n.type_}" not implemented -> returning silence`),xs}}const SA=(n,e,t=0)=>{const{start:s,end:r}=e.location_,a=n==null?void 0:n.split("").slice(s.offset,r.offset).join(""),[i=0,o=0]=a?a.split(e.source_).map(l=>l.split("").filter(c=>c===" ").length):[];return[s.offset+i+t,r.offset-o+t]},ag=(n,e=0,t=n)=>{try{return fV(n)}catch(s){const r=[s.location.start.offset+e,s.location.end.offset+e],a=t.slice(0,r[0]).split(`
`).length;throw new Error(`[mini] parse error at line ${a}: ${s.message}`)}},bV=(n,e,t)=>{const s=ag(n,e,t);let r=[];return fp(s,n,a=>{a.type_==="atom"&&r.push(a)},-1),r},CA=(n,e=0,t)=>bV(n,e,t).map(s=>SA(n,s,e)),PA=(...n)=>{const e=n.map(t=>{const s=`"${t}"`,r=ag(s);return fp(r,s)});return Xo(...e)},rye=(n,e)=>{const t=`"${n}"`,s=ag(t);return fp(s,t,null,e)},aye=n=>{const e=ag(n);return fp(e,n)};function iye(n){return typeof n=="string"?PA(n):bt(n)}function oye(){LN(PA)}const lye=Object.freeze(Object.defineProperty({__proto__:null,StartRules:nye,SyntaxError:vh,getLeafLocation:SA,getLeafLocations:CA,getLeaves:bV,h:aye,m:rye,mini:PA,mini2ast:ag,miniAllStrings:oye,minify:iye,parse:fV,patternifyAST:fp},Symbol.toStringTag,{value:"Module"}));var cye=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],yV=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],uye="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",vV="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Mw={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},Dw="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",hye={5:Dw,"5module":Dw+" export import",6:Dw+" const class extends export import super"},dye=/^in(stanceof)?$/,pye=new RegExp("["+vV+"]"),mye=new RegExp("["+vV+uye+"]");function _2(n,e){for(var t=65536,s=0;s<e.length;s+=2){if(t+=e[s],t>n)return!1;if(t+=e[s+1],t>=n)return!0}return!1}function wc(n,e){return n<65?n===36:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&pye.test(String.fromCharCode(n)):e===!1?!1:_2(n,yV)}function Ld(n,e){return n<48?n===36:n<58?!0:n<65?!1:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&mye.test(String.fromCharCode(n)):e===!1?!1:_2(n,yV)||_2(n,cye)}var ss=function(n,e){e===void 0&&(e={}),this.label=n,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function Qi(n,e){return new ss(n,{beforeExpr:!0,binop:e})}var ji={beforeExpr:!0},$a={startsExpr:!0},AA={};function Jn(n,e){return e===void 0&&(e={}),e.keyword=n,AA[n]=new ss(n,e)}var oe={num:new ss("num",$a),regexp:new ss("regexp",$a),string:new ss("string",$a),name:new ss("name",$a),privateId:new ss("privateId",$a),eof:new ss("eof"),bracketL:new ss("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ss("]"),braceL:new ss("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ss("}"),parenL:new ss("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ss(")"),comma:new ss(",",ji),semi:new ss(";",ji),colon:new ss(":",ji),dot:new ss("."),question:new ss("?",ji),questionDot:new ss("?."),arrow:new ss("=>",ji),template:new ss("template"),invalidTemplate:new ss("invalidTemplate"),ellipsis:new ss("...",ji),backQuote:new ss("`",$a),dollarBraceL:new ss("${",{beforeExpr:!0,startsExpr:!0}),eq:new ss("=",{beforeExpr:!0,isAssign:!0}),assign:new ss("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ss("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ss("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Qi("||",1),logicalAND:Qi("&&",2),bitwiseOR:Qi("|",3),bitwiseXOR:Qi("^",4),bitwiseAND:Qi("&",5),equality:Qi("==/!=/===/!==",6),relational:Qi("</>/<=/>=",7),bitShift:Qi("<</>>/>>>",8),plusMin:new ss("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Qi("%",10),star:Qi("*",10),slash:Qi("/",10),starstar:new ss("**",{beforeExpr:!0}),coalesce:Qi("??",1),_break:Jn("break"),_case:Jn("case",ji),_catch:Jn("catch"),_continue:Jn("continue"),_debugger:Jn("debugger"),_default:Jn("default",ji),_do:Jn("do",{isLoop:!0,beforeExpr:!0}),_else:Jn("else",ji),_finally:Jn("finally"),_for:Jn("for",{isLoop:!0}),_function:Jn("function",$a),_if:Jn("if"),_return:Jn("return",ji),_switch:Jn("switch"),_throw:Jn("throw",ji),_try:Jn("try"),_var:Jn("var"),_const:Jn("const"),_while:Jn("while",{isLoop:!0}),_with:Jn("with"),_new:Jn("new",{beforeExpr:!0,startsExpr:!0}),_this:Jn("this",$a),_super:Jn("super",$a),_class:Jn("class",$a),_extends:Jn("extends",ji),_export:Jn("export"),_import:Jn("import",$a),_null:Jn("null",$a),_true:Jn("true",$a),_false:Jn("false",$a),_in:Jn("in",{beforeExpr:!0,binop:7}),_instanceof:Jn("instanceof",{beforeExpr:!0,binop:7}),_typeof:Jn("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Jn("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Jn("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},bo=/\r\n?|\n|\u2028|\u2029/,fye=new RegExp(bo.source,"g");function gp(n){return n===10||n===13||n===8232||n===8233}function OV(n,e,t){t===void 0&&(t=n.length);for(var s=e;s<t;s++){var r=n.charCodeAt(s);if(gp(r))return s<t-1&&r===13&&n.charCodeAt(s+1)===10?s+2:s+1}return-1}var wV=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Wi=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,xV=Object.prototype,gye=xV.hasOwnProperty,bye=xV.toString,bp=Object.hasOwn||function(n,e){return gye.call(n,e)},ND=Array.isArray||function(n){return bye.call(n)==="[object Array]"},_D=Object.create(null);function Wc(n){return _D[n]||(_D[n]=new RegExp("^(?:"+n.replace(/ /g,"|")+")$"))}function xc(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}var yye=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,mf=function(n,e){this.line=n,this.column=e};mf.prototype.offset=function(n){return new mf(this.line,this.column+n)};var Av=function(n,e,t){this.start=e,this.end=t,n.sourceFile!==null&&(this.source=n.sourceFile)};function kV(n,e){for(var t=1,s=0;;){var r=OV(n,s,e);if(r<0)return new mf(t,e-s);++t,s=r}}var R2={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},RD=!1;function vye(n){var e={};for(var t in R2)e[t]=n&&bp(n,t)?n[t]:R2[t];if(e.ecmaVersion==="latest"?e.ecmaVersion=1e8:e.ecmaVersion==null?(!RD&&typeof console=="object"&&console.warn&&(RD=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),e.allowReserved==null&&(e.allowReserved=e.ecmaVersion<5),(!n||n.allowHashBang==null)&&(e.allowHashBang=e.ecmaVersion>=14),ND(e.onToken)){var s=e.onToken;e.onToken=function(r){return s.push(r)}}return ND(e.onComment)&&(e.onComment=Oye(e,e.onComment)),e}function Oye(n,e){return function(t,s,r,a,i,o){var l={type:t?"Block":"Line",value:s,start:r,end:a};n.locations&&(l.loc=new Av(this,i,o)),n.ranges&&(l.range=[r,a]),e.push(l)}}var ff=1,yp=2,EA=4,SV=8,CV=16,PV=32,MA=64,AV=128,ig=256,DA=ff|yp|ig;function TA(n,e){return yp|(n?EA:0)|(e?SV:0)}var Dy=0,BA=1,Mc=2,EV=3,MV=4,DV=5,Mr=function(n,e,t){this.options=n=vye(n),this.sourceFile=n.sourceFile,this.keywords=Wc(hye[n.ecmaVersion>=6?6:n.sourceType==="module"?"5module":5]);var s="";n.allowReserved!==!0&&(s=Mw[n.ecmaVersion>=6?6:n.ecmaVersion===5?5:3],n.sourceType==="module"&&(s+=" await")),this.reservedWords=Wc(s);var r=(s?s+" ":"")+Mw.strict;this.reservedWordsStrict=Wc(r),this.reservedWordsStrictBind=Wc(r+" "+Mw.strictBind),this.input=String(e),this.containsEsc=!1,t?(this.pos=t,this.lineStart=this.input.lastIndexOf(`
`,t-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(bo).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=oe.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=n.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&n.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(ff),this.regexpState=null,this.privateNameStack=[]},Vl={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Mr.prototype.parse=function(){var n=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(n)};Vl.inFunction.get=function(){return(this.currentVarScope().flags&yp)>0};Vl.inGenerator.get=function(){return(this.currentVarScope().flags&SV)>0&&!this.currentVarScope().inClassFieldInit};Vl.inAsync.get=function(){return(this.currentVarScope().flags&EA)>0&&!this.currentVarScope().inClassFieldInit};Vl.canAwait.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var e=this.scopeStack[n];if(e.inClassFieldInit||e.flags&ig)return!1;if(e.flags&yp)return(e.flags&EA)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};Vl.allowSuper.get=function(){var n=this.currentThisScope(),e=n.flags,t=n.inClassFieldInit;return(e&MA)>0||t||this.options.allowSuperOutsideMethod};Vl.allowDirectSuper.get=function(){return(this.currentThisScope().flags&AV)>0};Vl.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};Vl.allowNewDotTarget.get=function(){var n=this.currentThisScope(),e=n.flags,t=n.inClassFieldInit;return(e&(yp|ig))>0||t};Vl.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&ig)>0};Mr.extend=function(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];for(var t=this,s=0;s<n.length;s++)t=n[s](t);return t};Mr.parse=function(n,e){return new this(e,n).parse()};Mr.parseExpressionAt=function(n,e,t){var s=new this(t,n,e);return s.nextToken(),s.parseExpression()};Mr.tokenizer=function(n,e){return new this(e,n)};Object.defineProperties(Mr.prototype,Vl);var Ma=Mr.prototype,wye=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Ma.strictDirective=function(n){if(this.options.ecmaVersion<5)return!1;for(;;){Wi.lastIndex=n,n+=Wi.exec(this.input)[0].length;var e=wye.exec(this.input.slice(n));if(!e)return!1;if((e[1]||e[2])==="use strict"){Wi.lastIndex=n+e[0].length;var t=Wi.exec(this.input),s=t.index+t[0].length,r=this.input.charAt(s);return r===";"||r==="}"||bo.test(t[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||r==="!"&&this.input.charAt(s+1)==="=")}n+=e[0].length,Wi.lastIndex=n,n+=Wi.exec(this.input)[0].length,this.input[n]===";"&&n++}};Ma.eat=function(n){return this.type===n?(this.next(),!0):!1};Ma.isContextual=function(n){return this.type===oe.name&&this.value===n&&!this.containsEsc};Ma.eatContextual=function(n){return this.isContextual(n)?(this.next(),!0):!1};Ma.expectContextual=function(n){this.eatContextual(n)||this.unexpected()};Ma.canInsertSemicolon=function(){return this.type===oe.eof||this.type===oe.braceR||bo.test(this.input.slice(this.lastTokEnd,this.start))};Ma.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Ma.semicolon=function(){!this.eat(oe.semi)&&!this.insertSemicolon()&&this.unexpected()};Ma.afterTrailingComma=function(n,e){if(this.type===n)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0};Ma.expect=function(n){this.eat(n)||this.unexpected()};Ma.unexpected=function(n){this.raise(n??this.start,"Unexpected token")};var Ev=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Ma.checkPatternErrors=function(n,e){if(n){n.trailingComma>-1&&this.raiseRecoverable(n.trailingComma,"Comma is not permitted after the rest element");var t=e?n.parenthesizedAssign:n.parenthesizedBind;t>-1&&this.raiseRecoverable(t,e?"Assigning to rvalue":"Parenthesized pattern")}};Ma.checkExpressionErrors=function(n,e){if(!n)return!1;var t=n.shorthandAssign,s=n.doubleProto;if(!e)return t>=0||s>=0;t>=0&&this.raise(t,"Shorthand property assignments are valid only in destructuring patterns"),s>=0&&this.raiseRecoverable(s,"Redefinition of __proto__ property")};Ma.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Ma.isSimpleAssignTarget=function(n){return n.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(n.expression):n.type==="Identifier"||n.type==="MemberExpression"};var Xt=Mr.prototype;Xt.parseTopLevel=function(n){var e=Object.create(null);for(n.body||(n.body=[]);this.type!==oe.eof;){var t=this.parseStatement(null,!0,e);n.body.push(t)}if(this.inModule)for(var s=0,r=Object.keys(this.undefinedExports);s<r.length;s+=1){var a=r[s];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(n.body),this.next(),n.sourceType=this.options.sourceType,this.finishNode(n,"Program")};var FA={kind:"loop"},xye={kind:"switch"};Xt.isLet=function(n){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Wi.lastIndex=this.pos;var e=Wi.exec(this.input),t=this.pos+e[0].length,s=this.input.charCodeAt(t);if(s===91||s===92)return!0;if(n)return!1;if(s===123||s>55295&&s<56320)return!0;if(wc(s,!0)){for(var r=t+1;Ld(s=this.input.charCodeAt(r),!0);)++r;if(s===92||s>55295&&s<56320)return!0;var a=this.input.slice(t,r);if(!dye.test(a))return!0}return!1};Xt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Wi.lastIndex=this.pos;var n=Wi.exec(this.input),e=this.pos+n[0].length,t;return!bo.test(this.input.slice(this.pos,e))&&this.input.slice(e,e+8)==="function"&&(e+8===this.input.length||!(Ld(t=this.input.charCodeAt(e+8))||t>55295&&t<56320))};Xt.parseStatement=function(n,e,t){var s=this.type,r=this.startNode(),a;switch(this.isLet(n)&&(s=oe._var,a="let"),s){case oe._break:case oe._continue:return this.parseBreakContinueStatement(r,s.keyword);case oe._debugger:return this.parseDebuggerStatement(r);case oe._do:return this.parseDoStatement(r);case oe._for:return this.parseForStatement(r);case oe._function:return n&&(this.strict||n!=="if"&&n!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(r,!1,!n);case oe._class:return n&&this.unexpected(),this.parseClass(r,!0);case oe._if:return this.parseIfStatement(r);case oe._return:return this.parseReturnStatement(r);case oe._switch:return this.parseSwitchStatement(r);case oe._throw:return this.parseThrowStatement(r);case oe._try:return this.parseTryStatement(r);case oe._const:case oe._var:return a=a||this.value,n&&a!=="var"&&this.unexpected(),this.parseVarStatement(r,a);case oe._while:return this.parseWhileStatement(r);case oe._with:return this.parseWithStatement(r);case oe.braceL:return this.parseBlock(!0,r);case oe.semi:return this.parseEmptyStatement(r);case oe._export:case oe._import:if(this.options.ecmaVersion>10&&s===oe._import){Wi.lastIndex=this.pos;var i=Wi.exec(this.input),o=this.pos+i[0].length,l=this.input.charCodeAt(o);if(l===40||l===46)return this.parseExpressionStatement(r,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),s===oe._import?this.parseImport(r):this.parseExport(r,t);default:if(this.isAsyncFunction())return n&&this.unexpected(),this.next(),this.parseFunctionStatement(r,!0,!n);var c=this.value,u=this.parseExpression();return s===oe.name&&u.type==="Identifier"&&this.eat(oe.colon)?this.parseLabeledStatement(r,c,u,n):this.parseExpressionStatement(r,u)}};Xt.parseBreakContinueStatement=function(n,e){var t=e==="break";this.next(),this.eat(oe.semi)||this.insertSemicolon()?n.label=null:this.type!==oe.name?this.unexpected():(n.label=this.parseIdent(),this.semicolon());for(var s=0;s<this.labels.length;++s){var r=this.labels[s];if((n.label==null||r.name===n.label.name)&&(r.kind!=null&&(t||r.kind==="loop")||n.label&&t))break}return s===this.labels.length&&this.raise(n.start,"Unsyntactic "+e),this.finishNode(n,t?"BreakStatement":"ContinueStatement")};Xt.parseDebuggerStatement=function(n){return this.next(),this.semicolon(),this.finishNode(n,"DebuggerStatement")};Xt.parseDoStatement=function(n){return this.next(),this.labels.push(FA),n.body=this.parseStatement("do"),this.labels.pop(),this.expect(oe._while),n.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(oe.semi):this.semicolon(),this.finishNode(n,"DoWhileStatement")};Xt.parseForStatement=function(n){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(FA),this.enterScope(0),this.expect(oe.parenL),this.type===oe.semi)return e>-1&&this.unexpected(e),this.parseFor(n,null);var t=this.isLet();if(this.type===oe._var||this.type===oe._const||t){var s=this.startNode(),r=t?"let":this.value;return this.next(),this.parseVar(s,!0,r),this.finishNode(s,"VariableDeclaration"),(this.type===oe._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&s.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===oe._in?e>-1&&this.unexpected(e):n.await=e>-1),this.parseForIn(n,s)):(e>-1&&this.unexpected(e),this.parseFor(n,s))}var a=this.isContextual("let"),i=!1,o=this.containsEsc,l=new Ev,c=this.start,u=e>-1?this.parseExprSubscripts(l,"await"):this.parseExpression(!0,l);return this.type===oe._in||(i=this.options.ecmaVersion>=6&&this.isContextual("of"))?(e>-1?(this.type===oe._in&&this.unexpected(e),n.await=!0):i&&this.options.ecmaVersion>=8&&(u.start===c&&!o&&u.type==="Identifier"&&u.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(n.await=!1)),a&&i&&this.raise(u.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(u,!1,l),this.checkLValPattern(u),this.parseForIn(n,u)):(this.checkExpressionErrors(l,!0),e>-1&&this.unexpected(e),this.parseFor(n,u))};Xt.parseFunctionStatement=function(n,e,t){return this.next(),this.parseFunction(n,$m|(t?0:I2),!1,e)};Xt.parseIfStatement=function(n){return this.next(),n.test=this.parseParenExpression(),n.consequent=this.parseStatement("if"),n.alternate=this.eat(oe._else)?this.parseStatement("if"):null,this.finishNode(n,"IfStatement")};Xt.parseReturnStatement=function(n){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(oe.semi)||this.insertSemicolon()?n.argument=null:(n.argument=this.parseExpression(),this.semicolon()),this.finishNode(n,"ReturnStatement")};Xt.parseSwitchStatement=function(n){this.next(),n.discriminant=this.parseParenExpression(),n.cases=[],this.expect(oe.braceL),this.labels.push(xye),this.enterScope(0);for(var e,t=!1;this.type!==oe.braceR;)if(this.type===oe._case||this.type===oe._default){var s=this.type===oe._case;e&&this.finishNode(e,"SwitchCase"),n.cases.push(e=this.startNode()),e.consequent=[],this.next(),s?e.test=this.parseExpression():(t&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),t=!0,e.test=null),this.expect(oe.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(n,"SwitchStatement")};Xt.parseThrowStatement=function(n){return this.next(),bo.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),n.argument=this.parseExpression(),this.semicolon(),this.finishNode(n,"ThrowStatement")};var kye=[];Xt.parseCatchClauseParam=function(){var n=this.parseBindingAtom(),e=n.type==="Identifier";return this.enterScope(e?PV:0),this.checkLValPattern(n,e?MV:Mc),this.expect(oe.parenR),n};Xt.parseTryStatement=function(n){if(this.next(),n.block=this.parseBlock(),n.handler=null,this.type===oe._catch){var e=this.startNode();this.next(),this.eat(oe.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),n.handler=this.finishNode(e,"CatchClause")}return n.finalizer=this.eat(oe._finally)?this.parseBlock():null,!n.handler&&!n.finalizer&&this.raise(n.start,"Missing catch or finally clause"),this.finishNode(n,"TryStatement")};Xt.parseVarStatement=function(n,e,t){return this.next(),this.parseVar(n,!1,e,t),this.semicolon(),this.finishNode(n,"VariableDeclaration")};Xt.parseWhileStatement=function(n){return this.next(),n.test=this.parseParenExpression(),this.labels.push(FA),n.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(n,"WhileStatement")};Xt.parseWithStatement=function(n){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),n.object=this.parseParenExpression(),n.body=this.parseStatement("with"),this.finishNode(n,"WithStatement")};Xt.parseEmptyStatement=function(n){return this.next(),this.finishNode(n,"EmptyStatement")};Xt.parseLabeledStatement=function(n,e,t,s){for(var r=0,a=this.labels;r<a.length;r+=1){var i=a[r];i.name===e&&this.raise(t.start,"Label '"+e+"' is already declared")}for(var o=this.type.isLoop?"loop":this.type===oe._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===n.start)c.statementStart=this.start,c.kind=o;else break}return this.labels.push({name:e,kind:o,statementStart:this.start}),n.body=this.parseStatement(s?s.indexOf("label")===-1?s+"label":s:"label"),this.labels.pop(),n.label=t,this.finishNode(n,"LabeledStatement")};Xt.parseExpressionStatement=function(n,e){return n.expression=e,this.semicolon(),this.finishNode(n,"ExpressionStatement")};Xt.parseBlock=function(n,e,t){for(n===void 0&&(n=!0),e===void 0&&(e=this.startNode()),e.body=[],this.expect(oe.braceL),n&&this.enterScope(0);this.type!==oe.braceR;){var s=this.parseStatement(null);e.body.push(s)}return t&&(this.strict=!1),this.next(),n&&this.exitScope(),this.finishNode(e,"BlockStatement")};Xt.parseFor=function(n,e){return n.init=e,this.expect(oe.semi),n.test=this.type===oe.semi?null:this.parseExpression(),this.expect(oe.semi),n.update=this.type===oe.parenR?null:this.parseExpression(),this.expect(oe.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,"ForStatement")};Xt.parseForIn=function(n,e){var t=this.type===oe._in;return this.next(),e.type==="VariableDeclaration"&&e.declarations[0].init!=null&&(!t||this.options.ecmaVersion<8||this.strict||e.kind!=="var"||e.declarations[0].id.type!=="Identifier")&&this.raise(e.start,(t?"for-in":"for-of")+" loop variable declaration may not have an initializer"),n.left=e,n.right=t?this.parseExpression():this.parseMaybeAssign(),this.expect(oe.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,t?"ForInStatement":"ForOfStatement")};Xt.parseVar=function(n,e,t,s){for(n.declarations=[],n.kind=t;;){var r=this.startNode();if(this.parseVarId(r,t),this.eat(oe.eq)?r.init=this.parseMaybeAssign(e):!s&&t==="const"&&!(this.type===oe._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!s&&r.id.type!=="Identifier"&&!(e&&(this.type===oe._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):r.init=null,n.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(oe.comma))break}return n};Xt.parseVarId=function(n,e){n.id=this.parseBindingAtom(),this.checkLValPattern(n.id,e==="var"?BA:Mc,!1)};var $m=1,I2=2,TV=4;Xt.parseFunction=function(n,e,t,s,r){this.initFunction(n),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!s)&&(this.type===oe.star&&e&I2&&this.unexpected(),n.generator=this.eat(oe.star)),this.options.ecmaVersion>=8&&(n.async=!!s),e&$m&&(n.id=e&TV&&this.type!==oe.name?null:this.parseIdent(),n.id&&!(e&I2)&&this.checkLValSimple(n.id,this.strict||n.generator||n.async?this.treatFunctionsAsVar?BA:Mc:EV));var a=this.yieldPos,i=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(TA(n.async,n.generator)),e&$m||(n.id=this.type===oe.name?this.parseIdent():null),this.parseFunctionParams(n),this.parseFunctionBody(n,t,!1,r),this.yieldPos=a,this.awaitPos=i,this.awaitIdentPos=o,this.finishNode(n,e&$m?"FunctionDeclaration":"FunctionExpression")};Xt.parseFunctionParams=function(n){this.expect(oe.parenL),n.params=this.parseBindingList(oe.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Xt.parseClass=function(n,e){this.next();var t=this.strict;this.strict=!0,this.parseClassId(n,e),this.parseClassSuper(n);var s=this.enterClassBody(),r=this.startNode(),a=!1;for(r.body=[],this.expect(oe.braceL);this.type!==oe.braceR;){var i=this.parseClassElement(n.superClass!==null);i&&(r.body.push(i),i.type==="MethodDefinition"&&i.kind==="constructor"?(a&&this.raiseRecoverable(i.start,"Duplicate constructor in the same class"),a=!0):i.key&&i.key.type==="PrivateIdentifier"&&Sye(s,i)&&this.raiseRecoverable(i.key.start,"Identifier '#"+i.key.name+"' has already been declared"))}return this.strict=t,this.next(),n.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(n,e?"ClassDeclaration":"ClassExpression")};Xt.parseClassElement=function(n){if(this.eat(oe.semi))return null;var e=this.options.ecmaVersion,t=this.startNode(),s="",r=!1,a=!1,i="method",o=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(oe.braceL))return this.parseClassStaticBlock(t),t;this.isClassElementNameStart()||this.type===oe.star?o=!0:s="static"}if(t.static=o,!s&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===oe.star)&&!this.canInsertSemicolon()?a=!0:s="async"),!s&&(e>=9||!a)&&this.eat(oe.star)&&(r=!0),!s&&!a&&!r){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?i=l:s=l)}if(s?(t.computed=!1,t.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),t.key.name=s,this.finishNode(t.key,"Identifier")):this.parseClassElementName(t),e<13||this.type===oe.parenL||i!=="method"||r||a){var c=!t.static&&Ty(t,"constructor"),u=c&&n;c&&i!=="method"&&this.raise(t.key.start,"Constructor can't have get/set modifier"),t.kind=c?"constructor":i,this.parseClassMethod(t,r,a,u)}else this.parseClassField(t);return t};Xt.isClassElementNameStart=function(){return this.type===oe.name||this.type===oe.privateId||this.type===oe.num||this.type===oe.string||this.type===oe.bracketL||this.type.keyword};Xt.parseClassElementName=function(n){this.type===oe.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),n.computed=!1,n.key=this.parsePrivateIdent()):this.parsePropertyName(n)};Xt.parseClassMethod=function(n,e,t,s){var r=n.key;n.kind==="constructor"?(e&&this.raise(r.start,"Constructor can't be a generator"),t&&this.raise(r.start,"Constructor can't be an async method")):n.static&&Ty(n,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var a=n.value=this.parseMethod(e,t,s);return n.kind==="get"&&a.params.length!==0&&this.raiseRecoverable(a.start,"getter should have no params"),n.kind==="set"&&a.params.length!==1&&this.raiseRecoverable(a.start,"setter should have exactly one param"),n.kind==="set"&&a.params[0].type==="RestElement"&&this.raiseRecoverable(a.params[0].start,"Setter cannot use rest params"),this.finishNode(n,"MethodDefinition")};Xt.parseClassField=function(n){if(Ty(n,"constructor")?this.raise(n.key.start,"Classes can't have a field named 'constructor'"):n.static&&Ty(n,"prototype")&&this.raise(n.key.start,"Classes can't have a static field named 'prototype'"),this.eat(oe.eq)){var e=this.currentThisScope(),t=e.inClassFieldInit;e.inClassFieldInit=!0,n.value=this.parseMaybeAssign(),e.inClassFieldInit=t}else n.value=null;return this.semicolon(),this.finishNode(n,"PropertyDefinition")};Xt.parseClassStaticBlock=function(n){n.body=[];var e=this.labels;for(this.labels=[],this.enterScope(ig|MA);this.type!==oe.braceR;){var t=this.parseStatement(null);n.body.push(t)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(n,"StaticBlock")};Xt.parseClassId=function(n,e){this.type===oe.name?(n.id=this.parseIdent(),e&&this.checkLValSimple(n.id,Mc,!1)):(e===!0&&this.unexpected(),n.id=null)};Xt.parseClassSuper=function(n){n.superClass=this.eat(oe._extends)?this.parseExprSubscripts(null,!1):null};Xt.enterClassBody=function(){var n={declared:Object.create(null),used:[]};return this.privateNameStack.push(n),n.declared};Xt.exitClassBody=function(){var n=this.privateNameStack.pop(),e=n.declared,t=n.used;if(this.options.checkPrivateFields)for(var s=this.privateNameStack.length,r=s===0?null:this.privateNameStack[s-1],a=0;a<t.length;++a){var i=t[a];bp(e,i.name)||(r?r.used.push(i):this.raiseRecoverable(i.start,"Private field '#"+i.name+"' must be declared in an enclosing class"))}};function Sye(n,e){var t=e.key.name,s=n[t],r="true";return e.type==="MethodDefinition"&&(e.kind==="get"||e.kind==="set")&&(r=(e.static?"s":"i")+e.kind),s==="iget"&&r==="iset"||s==="iset"&&r==="iget"||s==="sget"&&r==="sset"||s==="sset"&&r==="sget"?(n[t]="true",!1):s?!0:(n[t]=r,!1)}function Ty(n,e){var t=n.computed,s=n.key;return!t&&(s.type==="Identifier"&&s.name===e||s.type==="Literal"&&s.value===e)}Xt.parseExportAllDeclaration=function(n,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(n.exported=this.parseModuleExportName(),this.checkExport(e,n.exported,this.lastTokStart)):n.exported=null),this.expectContextual("from"),this.type!==oe.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ExportAllDeclaration")};Xt.parseExport=function(n,e){if(this.next(),this.eat(oe.star))return this.parseExportAllDeclaration(n,e);if(this.eat(oe._default))return this.checkExport(e,"default",this.lastTokStart),n.declaration=this.parseExportDefaultDeclaration(),this.finishNode(n,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())n.declaration=this.parseExportDeclaration(n),n.declaration.type==="VariableDeclaration"?this.checkVariableExport(e,n.declaration.declarations):this.checkExport(e,n.declaration.id,n.declaration.id.start),n.specifiers=[],n.source=null;else{if(n.declaration=null,n.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==oe.string&&this.unexpected(),n.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause());else{for(var t=0,s=n.specifiers;t<s.length;t+=1){var r=s[t];this.checkUnreserved(r.local),this.checkLocalExport(r.local),r.local.type==="Literal"&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}n.source=null}this.semicolon()}return this.finishNode(n,"ExportNamedDeclaration")};Xt.parseExportDeclaration=function(n){return this.parseStatement(null)};Xt.parseExportDefaultDeclaration=function(){var n;if(this.type===oe._function||(n=this.isAsyncFunction())){var e=this.startNode();return this.next(),n&&this.next(),this.parseFunction(e,$m|TV,!1,n)}else if(this.type===oe._class){var t=this.startNode();return this.parseClass(t,"nullableID")}else{var s=this.parseMaybeAssign();return this.semicolon(),s}};Xt.checkExport=function(n,e,t){n&&(typeof e!="string"&&(e=e.type==="Identifier"?e.name:e.value),bp(n,e)&&this.raiseRecoverable(t,"Duplicate export '"+e+"'"),n[e]=!0)};Xt.checkPatternExport=function(n,e){var t=e.type;if(t==="Identifier")this.checkExport(n,e,e.start);else if(t==="ObjectPattern")for(var s=0,r=e.properties;s<r.length;s+=1){var a=r[s];this.checkPatternExport(n,a)}else if(t==="ArrayPattern")for(var i=0,o=e.elements;i<o.length;i+=1){var l=o[i];l&&this.checkPatternExport(n,l)}else t==="Property"?this.checkPatternExport(n,e.value):t==="AssignmentPattern"?this.checkPatternExport(n,e.left):t==="RestElement"&&this.checkPatternExport(n,e.argument)};Xt.checkVariableExport=function(n,e){if(n)for(var t=0,s=e;t<s.length;t+=1){var r=s[t];this.checkPatternExport(n,r.id)}};Xt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Xt.parseExportSpecifier=function(n){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(n,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")};Xt.parseExportSpecifiers=function(n){var e=[],t=!0;for(this.expect(oe.braceL);!this.eat(oe.braceR);){if(t)t=!1;else if(this.expect(oe.comma),this.afterTrailingComma(oe.braceR))break;e.push(this.parseExportSpecifier(n))}return e};Xt.parseImport=function(n){return this.next(),this.type===oe.string?(n.specifiers=kye,n.source=this.parseExprAtom()):(n.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),n.source=this.type===oe.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(n.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(n,"ImportDeclaration")};Xt.parseImportSpecifier=function(){var n=this.startNode();return n.imported=this.parseModuleExportName(),this.eatContextual("as")?n.local=this.parseIdent():(this.checkUnreserved(n.imported),n.local=n.imported),this.checkLValSimple(n.local,Mc),this.finishNode(n,"ImportSpecifier")};Xt.parseImportDefaultSpecifier=function(){var n=this.startNode();return n.local=this.parseIdent(),this.checkLValSimple(n.local,Mc),this.finishNode(n,"ImportDefaultSpecifier")};Xt.parseImportNamespaceSpecifier=function(){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLValSimple(n.local,Mc),this.finishNode(n,"ImportNamespaceSpecifier")};Xt.parseImportSpecifiers=function(){var n=[],e=!0;if(this.type===oe.name&&(n.push(this.parseImportDefaultSpecifier()),!this.eat(oe.comma)))return n;if(this.type===oe.star)return n.push(this.parseImportNamespaceSpecifier()),n;for(this.expect(oe.braceL);!this.eat(oe.braceR);){if(e)e=!1;else if(this.expect(oe.comma),this.afterTrailingComma(oe.braceR))break;n.push(this.parseImportSpecifier())}return n};Xt.parseWithClause=function(){var n=[];if(!this.eat(oe._with))return n;this.expect(oe.braceL);for(var e={},t=!0;!this.eat(oe.braceR);){if(t)t=!1;else if(this.expect(oe.comma),this.afterTrailingComma(oe.braceR))break;var s=this.parseImportAttribute(),r=s.key.type==="Identifier"?s.key.name:s.key.value;bp(e,r)&&this.raiseRecoverable(s.key.start,"Duplicate attribute key '"+r+"'"),e[r]=!0,n.push(s)}return n};Xt.parseImportAttribute=function(){var n=this.startNode();return n.key=this.type===oe.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(oe.colon),this.type!==oe.string&&this.unexpected(),n.value=this.parseExprAtom(),this.finishNode(n,"ImportAttribute")};Xt.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===oe.string){var n=this.parseLiteral(this.value);return yye.test(n.value)&&this.raise(n.start,"An export name cannot include a lone surrogate."),n}return this.parseIdent(!0)};Xt.adaptDirectivePrologue=function(n){for(var e=0;e<n.length&&this.isDirectiveCandidate(n[e]);++e)n[e].directive=n[e].expression.raw.slice(1,-1)};Xt.isDirectiveCandidate=function(n){return this.options.ecmaVersion>=5&&n.type==="ExpressionStatement"&&n.expression.type==="Literal"&&typeof n.expression.value=="string"&&(this.input[n.start]==='"'||this.input[n.start]==="'")};var yo=Mr.prototype;yo.toAssignable=function(n,e,t){if(this.options.ecmaVersion>=6&&n)switch(n.type){case"Identifier":this.inAsync&&n.name==="await"&&this.raise(n.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":n.type="ObjectPattern",t&&this.checkPatternErrors(t,!0);for(var s=0,r=n.properties;s<r.length;s+=1){var a=r[s];this.toAssignable(a,e),a.type==="RestElement"&&(a.argument.type==="ArrayPattern"||a.argument.type==="ObjectPattern")&&this.raise(a.argument.start,"Unexpected token")}break;case"Property":n.kind!=="init"&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,e);break;case"ArrayExpression":n.type="ArrayPattern",t&&this.checkPatternErrors(t,!0),this.toAssignableList(n.elements,e);break;case"SpreadElement":n.type="RestElement",this.toAssignable(n.argument,e),n.argument.type==="AssignmentPattern"&&this.raise(n.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":n.operator!=="="&&this.raise(n.left.end,"Only '=' operator can be used for specifying default value."),n.type="AssignmentPattern",delete n.operator,this.toAssignable(n.left,e);break;case"ParenthesizedExpression":this.toAssignable(n.expression,e,t);break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(n.start,"Assigning to rvalue")}else t&&this.checkPatternErrors(t,!0);return n};yo.toAssignableList=function(n,e){for(var t=n.length,s=0;s<t;s++){var r=n[s];r&&this.toAssignable(r,e)}if(t){var a=n[t-1];this.options.ecmaVersion===6&&e&&a&&a.type==="RestElement"&&a.argument.type!=="Identifier"&&this.unexpected(a.argument.start)}return n};yo.parseSpread=function(n){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,n),this.finishNode(e,"SpreadElement")};yo.parseRestBinding=function(){var n=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==oe.name&&this.unexpected(),n.argument=this.parseBindingAtom(),this.finishNode(n,"RestElement")};yo.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case oe.bracketL:var n=this.startNode();return this.next(),n.elements=this.parseBindingList(oe.bracketR,!0,!0),this.finishNode(n,"ArrayPattern");case oe.braceL:return this.parseObj(!0)}return this.parseIdent()};yo.parseBindingList=function(n,e,t,s){for(var r=[],a=!0;!this.eat(n);)if(a?a=!1:this.expect(oe.comma),e&&this.type===oe.comma)r.push(null);else{if(t&&this.afterTrailingComma(n))break;if(this.type===oe.ellipsis){var i=this.parseRestBinding();this.parseBindingListItem(i),r.push(i),this.type===oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(n);break}else r.push(this.parseAssignableListItem(s))}return r};yo.parseAssignableListItem=function(n){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e};yo.parseBindingListItem=function(n){return n};yo.parseMaybeDefault=function(n,e,t){if(t=t||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(oe.eq))return t;var s=this.startNodeAt(n,e);return s.left=t,s.right=this.parseMaybeAssign(),this.finishNode(s,"AssignmentPattern")};yo.checkLValSimple=function(n,e,t){e===void 0&&(e=Dy);var s=e!==Dy;switch(n.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(n.name)&&this.raiseRecoverable(n.start,(s?"Binding ":"Assigning to ")+n.name+" in strict mode"),s&&(e===Mc&&n.name==="let"&&this.raiseRecoverable(n.start,"let is disallowed as a lexically bound name"),t&&(bp(t,n.name)&&this.raiseRecoverable(n.start,"Argument name clash"),t[n.name]=!0),e!==DV&&this.declareName(n.name,e,n.start));break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":s&&this.raiseRecoverable(n.start,"Binding member expression");break;case"ParenthesizedExpression":return s&&this.raiseRecoverable(n.start,"Binding parenthesized expression"),this.checkLValSimple(n.expression,e,t);default:this.raise(n.start,(s?"Binding":"Assigning to")+" rvalue")}};yo.checkLValPattern=function(n,e,t){switch(e===void 0&&(e=Dy),n.type){case"ObjectPattern":for(var s=0,r=n.properties;s<r.length;s+=1){var a=r[s];this.checkLValInnerPattern(a,e,t)}break;case"ArrayPattern":for(var i=0,o=n.elements;i<o.length;i+=1){var l=o[i];l&&this.checkLValInnerPattern(l,e,t)}break;default:this.checkLValSimple(n,e,t)}};yo.checkLValInnerPattern=function(n,e,t){switch(e===void 0&&(e=Dy),n.type){case"Property":this.checkLValInnerPattern(n.value,e,t);break;case"AssignmentPattern":this.checkLValPattern(n.left,e,t);break;case"RestElement":this.checkLValPattern(n.argument,e,t);break;default:this.checkLValPattern(n,e,t)}};var Eo=function(n,e,t,s,r){this.token=n,this.isExpr=!!e,this.preserveSpace=!!t,this.override=s,this.generator=!!r},Zs={b_stat:new Eo("{",!1),b_expr:new Eo("{",!0),b_tmpl:new Eo("${",!1),p_stat:new Eo("(",!1),p_expr:new Eo("(",!0),q_tmpl:new Eo("`",!0,!0,function(n){return n.tryReadTemplateToken()}),f_stat:new Eo("function",!1),f_expr:new Eo("function",!0),f_expr_gen:new Eo("function",!0,!1,null,!0),f_gen:new Eo("function",!1,!1,null,!0)},vp=Mr.prototype;vp.initialContext=function(){return[Zs.b_stat]};vp.curContext=function(){return this.context[this.context.length-1]};vp.braceIsBlock=function(n){var e=this.curContext();return e===Zs.f_expr||e===Zs.f_stat?!0:n===oe.colon&&(e===Zs.b_stat||e===Zs.b_expr)?!e.isExpr:n===oe._return||n===oe.name&&this.exprAllowed?bo.test(this.input.slice(this.lastTokEnd,this.start)):n===oe._else||n===oe.semi||n===oe.eof||n===oe.parenR||n===oe.arrow?!0:n===oe.braceL?e===Zs.b_stat:n===oe._var||n===oe._const||n===oe.name?!1:!this.exprAllowed};vp.inGeneratorContext=function(){for(var n=this.context.length-1;n>=1;n--){var e=this.context[n];if(e.token==="function")return e.generator}return!1};vp.updateContext=function(n){var e,t=this.type;t.keyword&&n===oe.dot?this.exprAllowed=!1:(e=t.updateContext)?e.call(this,n):this.exprAllowed=t.beforeExpr};vp.overrideContext=function(n){this.curContext()!==n&&(this.context[this.context.length-1]=n)};oe.parenR.updateContext=oe.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var n=this.context.pop();n===Zs.b_stat&&this.curContext().token==="function"&&(n=this.context.pop()),this.exprAllowed=!n.isExpr};oe.braceL.updateContext=function(n){this.context.push(this.braceIsBlock(n)?Zs.b_stat:Zs.b_expr),this.exprAllowed=!0};oe.dollarBraceL.updateContext=function(){this.context.push(Zs.b_tmpl),this.exprAllowed=!0};oe.parenL.updateContext=function(n){var e=n===oe._if||n===oe._for||n===oe._with||n===oe._while;this.context.push(e?Zs.p_stat:Zs.p_expr),this.exprAllowed=!0};oe.incDec.updateContext=function(){};oe._function.updateContext=oe._class.updateContext=function(n){n.beforeExpr&&n!==oe._else&&!(n===oe.semi&&this.curContext()!==Zs.p_stat)&&!(n===oe._return&&bo.test(this.input.slice(this.lastTokEnd,this.start)))&&!((n===oe.colon||n===oe.braceL)&&this.curContext()===Zs.b_stat)?this.context.push(Zs.f_expr):this.context.push(Zs.f_stat),this.exprAllowed=!1};oe.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};oe.backQuote.updateContext=function(){this.curContext()===Zs.q_tmpl?this.context.pop():this.context.push(Zs.q_tmpl),this.exprAllowed=!1};oe.star.updateContext=function(n){if(n===oe._function){var e=this.context.length-1;this.context[e]===Zs.f_expr?this.context[e]=Zs.f_expr_gen:this.context[e]=Zs.f_gen}this.exprAllowed=!0};oe.name.updateContext=function(n){var e=!1;this.options.ecmaVersion>=6&&n!==oe.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var vn=Mr.prototype;vn.checkPropClash=function(n,e,t){if(!(this.options.ecmaVersion>=9&&n.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(n.computed||n.method||n.shorthand))){var s=n.key,r;switch(s.type){case"Identifier":r=s.name;break;case"Literal":r=String(s.value);break;default:return}var a=n.kind;if(this.options.ecmaVersion>=6){r==="__proto__"&&a==="init"&&(e.proto&&(t?t.doubleProto<0&&(t.doubleProto=s.start):this.raiseRecoverable(s.start,"Redefinition of __proto__ property")),e.proto=!0);return}r="$"+r;var i=e[r];if(i){var o;a==="init"?o=this.strict&&i.init||i.get||i.set:o=i.init||i[a],o&&this.raiseRecoverable(s.start,"Redefinition of property")}else i=e[r]={init:!1,get:!1,set:!1};i[a]=!0}};vn.parseExpression=function(n,e){var t=this.start,s=this.startLoc,r=this.parseMaybeAssign(n,e);if(this.type===oe.comma){var a=this.startNodeAt(t,s);for(a.expressions=[r];this.eat(oe.comma);)a.expressions.push(this.parseMaybeAssign(n,e));return this.finishNode(a,"SequenceExpression")}return r};vn.parseMaybeAssign=function(n,e,t){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(n);this.exprAllowed=!1}var s=!1,r=-1,a=-1,i=-1;e?(r=e.parenthesizedAssign,a=e.trailingComma,i=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new Ev,s=!0);var o=this.start,l=this.startLoc;(this.type===oe.parenL||this.type===oe.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=n==="await");var c=this.parseMaybeConditional(n,e);if(t&&(c=t.call(this,c,o,l)),this.type.isAssign){var u=this.startNodeAt(o,l);return u.operator=this.value,this.type===oe.eq&&(c=this.toAssignable(c,!1,e)),s||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=c.start&&(e.shorthandAssign=-1),this.type===oe.eq?this.checkLValPattern(c):this.checkLValSimple(c),u.left=c,this.next(),u.right=this.parseMaybeAssign(n),i>-1&&(e.doubleProto=i),this.finishNode(u,"AssignmentExpression")}else s&&this.checkExpressionErrors(e,!0);return r>-1&&(e.parenthesizedAssign=r),a>-1&&(e.trailingComma=a),c};vn.parseMaybeConditional=function(n,e){var t=this.start,s=this.startLoc,r=this.parseExprOps(n,e);if(this.checkExpressionErrors(e))return r;if(this.eat(oe.question)){var a=this.startNodeAt(t,s);return a.test=r,a.consequent=this.parseMaybeAssign(),this.expect(oe.colon),a.alternate=this.parseMaybeAssign(n),this.finishNode(a,"ConditionalExpression")}return r};vn.parseExprOps=function(n,e){var t=this.start,s=this.startLoc,r=this.parseMaybeUnary(e,!1,!1,n);return this.checkExpressionErrors(e)||r.start===t&&r.type==="ArrowFunctionExpression"?r:this.parseExprOp(r,t,s,-1,n)};vn.parseExprOp=function(n,e,t,s,r){var a=this.type.binop;if(a!=null&&(!r||this.type!==oe._in)&&a>s){var i=this.type===oe.logicalOR||this.type===oe.logicalAND,o=this.type===oe.coalesce;o&&(a=oe.logicalAND.binop);var l=this.value;this.next();var c=this.start,u=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),c,u,a,r),d=this.buildBinary(e,t,n,h,l,i||o);return(i&&this.type===oe.coalesce||o&&(this.type===oe.logicalOR||this.type===oe.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,e,t,s,r)}return n};vn.buildBinary=function(n,e,t,s,r,a){s.type==="PrivateIdentifier"&&this.raise(s.start,"Private identifier can only be left side of binary expression");var i=this.startNodeAt(n,e);return i.left=t,i.operator=r,i.right=s,this.finishNode(i,a?"LogicalExpression":"BinaryExpression")};vn.parseMaybeUnary=function(n,e,t,s){var r=this.start,a=this.startLoc,i;if(this.isContextual("await")&&this.canAwait)i=this.parseAwait(s),e=!0;else if(this.type.prefix){var o=this.startNode(),l=this.type===oe.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0,l,s),this.checkExpressionErrors(n,!0),l?this.checkLValSimple(o.argument):this.strict&&o.operator==="delete"&&BV(o.argument)?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):o.operator==="delete"&&L2(o.argument)?this.raiseRecoverable(o.start,"Private fields can not be deleted"):e=!0,i=this.finishNode(o,l?"UpdateExpression":"UnaryExpression")}else if(!e&&this.type===oe.privateId)(s||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),i=this.parsePrivateIdent(),this.type!==oe._in&&this.unexpected();else{if(i=this.parseExprSubscripts(n,s),this.checkExpressionErrors(n))return i;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(r,a);c.operator=this.value,c.prefix=!1,c.argument=i,this.checkLValSimple(i),this.next(),i=this.finishNode(c,"UpdateExpression")}}if(!t&&this.eat(oe.starstar))if(e)this.unexpected(this.lastTokStart);else return this.buildBinary(r,a,i,this.parseMaybeUnary(null,!1,!1,s),"**",!1);else return i};function BV(n){return n.type==="Identifier"||n.type==="ParenthesizedExpression"&&BV(n.expression)}function L2(n){return n.type==="MemberExpression"&&n.property.type==="PrivateIdentifier"||n.type==="ChainExpression"&&L2(n.expression)||n.type==="ParenthesizedExpression"&&L2(n.expression)}vn.parseExprSubscripts=function(n,e){var t=this.start,s=this.startLoc,r=this.parseExprAtom(n,e);if(r.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return r;var a=this.parseSubscripts(r,t,s,!1,e);return n&&a.type==="MemberExpression"&&(n.parenthesizedAssign>=a.start&&(n.parenthesizedAssign=-1),n.parenthesizedBind>=a.start&&(n.parenthesizedBind=-1),n.trailingComma>=a.start&&(n.trailingComma=-1)),a};vn.parseSubscripts=function(n,e,t,s,r){for(var a=this.options.ecmaVersion>=8&&n.type==="Identifier"&&n.name==="async"&&this.lastTokEnd===n.end&&!this.canInsertSemicolon()&&n.end-n.start===5&&this.potentialArrowAt===n.start,i=!1;;){var o=this.parseSubscript(n,e,t,s,a,i,r);if(o.optional&&(i=!0),o===n||o.type==="ArrowFunctionExpression"){if(i){var l=this.startNodeAt(e,t);l.expression=o,o=this.finishNode(l,"ChainExpression")}return o}n=o}};vn.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(oe.arrow)};vn.parseSubscriptAsyncArrow=function(n,e,t,s){return this.parseArrowExpression(this.startNodeAt(n,e),t,!0,s)};vn.parseSubscript=function(n,e,t,s,r,a,i){var o=this.options.ecmaVersion>=11,l=o&&this.eat(oe.questionDot);s&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(oe.bracketL);if(c||l&&this.type!==oe.parenL&&this.type!==oe.backQuote||this.eat(oe.dot)){var u=this.startNodeAt(e,t);u.object=n,c?(u.property=this.parseExpression(),this.expect(oe.bracketR)):this.type===oe.privateId&&n.type!=="Super"?u.property=this.parsePrivateIdent():u.property=this.parseIdent(this.options.allowReserved!=="never"),u.computed=!!c,o&&(u.optional=l),n=this.finishNode(u,"MemberExpression")}else if(!s&&this.eat(oe.parenL)){var h=new Ev,d=this.yieldPos,m=this.awaitPos,y=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var O=this.parseExprList(oe.parenR,this.options.ecmaVersion>=8,!1,h);if(r&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=d,this.awaitPos=m,this.awaitIdentPos=y,this.parseSubscriptAsyncArrow(e,t,O,i);this.checkExpressionErrors(h,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=m||this.awaitPos,this.awaitIdentPos=y||this.awaitIdentPos;var S=this.startNodeAt(e,t);S.callee=n,S.arguments=O,o&&(S.optional=l),n=this.finishNode(S,"CallExpression")}else if(this.type===oe.backQuote){(l||a)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var A=this.startNodeAt(e,t);A.tag=n,A.quasi=this.parseTemplate({isTagged:!0}),n=this.finishNode(A,"TaggedTemplateExpression")}return n};vn.parseExprAtom=function(n,e,t){this.type===oe.slash&&this.readRegexp();var s,r=this.potentialArrowAt===this.start;switch(this.type){case oe._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),s=this.startNode(),this.next(),this.type===oe.parenL&&!this.allowDirectSuper&&this.raise(s.start,"super() call outside constructor of a subclass"),this.type!==oe.dot&&this.type!==oe.bracketL&&this.type!==oe.parenL&&this.unexpected(),this.finishNode(s,"Super");case oe._this:return s=this.startNode(),this.next(),this.finishNode(s,"ThisExpression");case oe.name:var a=this.start,i=this.startLoc,o=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!o&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(oe._function))return this.overrideContext(Zs.f_expr),this.parseFunction(this.startNodeAt(a,i),0,!1,!0,e);if(r&&!this.canInsertSemicolon()){if(this.eat(oe.arrow))return this.parseArrowExpression(this.startNodeAt(a,i),[l],!1,e);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===oe.name&&!o&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(oe.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(a,i),[l],!0,e)}return l;case oe.regexp:var c=this.value;return s=this.parseLiteral(c.value),s.regex={pattern:c.pattern,flags:c.flags},s;case oe.num:case oe.string:return this.parseLiteral(this.value);case oe._null:case oe._true:case oe._false:return s=this.startNode(),s.value=this.type===oe._null?null:this.type===oe._true,s.raw=this.type.keyword,this.next(),this.finishNode(s,"Literal");case oe.parenL:var u=this.start,h=this.parseParenAndDistinguishExpression(r,e);return n&&(n.parenthesizedAssign<0&&!this.isSimpleAssignTarget(h)&&(n.parenthesizedAssign=u),n.parenthesizedBind<0&&(n.parenthesizedBind=u)),h;case oe.bracketL:return s=this.startNode(),this.next(),s.elements=this.parseExprList(oe.bracketR,!0,!0,n),this.finishNode(s,"ArrayExpression");case oe.braceL:return this.overrideContext(Zs.b_expr),this.parseObj(!1,n);case oe._function:return s=this.startNode(),this.next(),this.parseFunction(s,0);case oe._class:return this.parseClass(this.startNode(),!1);case oe._new:return this.parseNew();case oe.backQuote:return this.parseTemplate();case oe._import:return this.options.ecmaVersion>=11?this.parseExprImport(t):this.unexpected();default:return this.parseExprAtomDefault()}};vn.parseExprAtomDefault=function(){this.unexpected()};vn.parseExprImport=function(n){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===oe.parenL&&!n)return this.parseDynamicImport(e);if(this.type===oe.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);return t.name="import",e.meta=this.finishNode(t,"Identifier"),this.parseImportMeta(e)}else this.unexpected()};vn.parseDynamicImport=function(n){if(this.next(),n.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(oe.parenR)?n.options=null:(this.expect(oe.comma),this.afterTrailingComma(oe.parenR)?n.options=null:(n.options=this.parseMaybeAssign(),this.eat(oe.parenR)||(this.expect(oe.comma),this.afterTrailingComma(oe.parenR)||this.unexpected())));else if(!this.eat(oe.parenR)){var e=this.start;this.eat(oe.comma)&&this.eat(oe.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(n,"ImportExpression")};vn.parseImportMeta=function(n){this.next();var e=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="meta"&&this.raiseRecoverable(n.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(n.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(n.start,"Cannot use 'import.meta' outside a module"),this.finishNode(n,"MetaProperty")};vn.parseLiteral=function(n){var e=this.startNode();return e.value=n,e.raw=this.input.slice(this.start,this.end),e.raw.charCodeAt(e.raw.length-1)===110&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")};vn.parseParenExpression=function(){this.expect(oe.parenL);var n=this.parseExpression();return this.expect(oe.parenR),n};vn.shouldParseArrow=function(n){return!this.canInsertSemicolon()};vn.parseParenAndDistinguishExpression=function(n,e){var t=this.start,s=this.startLoc,r,a=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var i=this.start,o=this.startLoc,l=[],c=!0,u=!1,h=new Ev,d=this.yieldPos,m=this.awaitPos,y;for(this.yieldPos=0,this.awaitPos=0;this.type!==oe.parenR;)if(c?c=!1:this.expect(oe.comma),a&&this.afterTrailingComma(oe.parenR,!0)){u=!0;break}else if(this.type===oe.ellipsis){y=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,h,this.parseParenItem));var O=this.lastTokEnd,S=this.lastTokEndLoc;if(this.expect(oe.parenR),n&&this.shouldParseArrow(l)&&this.eat(oe.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=m,this.parseParenArrowList(t,s,l,e);(!l.length||u)&&this.unexpected(this.lastTokStart),y&&this.unexpected(y),this.checkExpressionErrors(h,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=m||this.awaitPos,l.length>1?(r=this.startNodeAt(i,o),r.expressions=l,this.finishNodeAt(r,"SequenceExpression",O,S)):r=l[0]}else r=this.parseParenExpression();if(this.options.preserveParens){var A=this.startNodeAt(t,s);return A.expression=r,this.finishNode(A,"ParenthesizedExpression")}else return r};vn.parseParenItem=function(n){return n};vn.parseParenArrowList=function(n,e,t,s){return this.parseArrowExpression(this.startNodeAt(n,e),t,!1,s)};var Cye=[];vn.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var n=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===oe.dot){var e=this.startNodeAt(n.start,n.loc&&n.loc.start);e.name="new",n.meta=this.finishNode(e,"Identifier"),this.next();var t=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="target"&&this.raiseRecoverable(n.property.start,"The only valid meta property for new is 'new.target'"),t&&this.raiseRecoverable(n.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(n.start,"'new.target' can only be used in functions and class static block"),this.finishNode(n,"MetaProperty")}var s=this.start,r=this.startLoc;return n.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),s,r,!0,!1),this.eat(oe.parenL)?n.arguments=this.parseExprList(oe.parenR,this.options.ecmaVersion>=8,!1):n.arguments=Cye,this.finishNode(n,"NewExpression")};vn.parseTemplateElement=function(n){var e=n.isTagged,t=this.startNode();return this.type===oe.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),t.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),t.tail=this.type===oe.backQuote,this.finishNode(t,"TemplateElement")};vn.parseTemplate=function(n){n===void 0&&(n={});var e=n.isTagged;e===void 0&&(e=!1);var t=this.startNode();this.next(),t.expressions=[];var s=this.parseTemplateElement({isTagged:e});for(t.quasis=[s];!s.tail;)this.type===oe.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(oe.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(oe.braceR),t.quasis.push(s=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(t,"TemplateLiteral")};vn.isAsyncProp=function(n){return!n.computed&&n.key.type==="Identifier"&&n.key.name==="async"&&(this.type===oe.name||this.type===oe.num||this.type===oe.string||this.type===oe.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===oe.star)&&!bo.test(this.input.slice(this.lastTokEnd,this.start))};vn.parseObj=function(n,e){var t=this.startNode(),s=!0,r={};for(t.properties=[],this.next();!this.eat(oe.braceR);){if(s)s=!1;else if(this.expect(oe.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(oe.braceR))break;var a=this.parseProperty(n,e);n||this.checkPropClash(a,r,e),t.properties.push(a)}return this.finishNode(t,n?"ObjectPattern":"ObjectExpression")};vn.parseProperty=function(n,e){var t=this.startNode(),s,r,a,i;if(this.options.ecmaVersion>=9&&this.eat(oe.ellipsis))return n?(t.argument=this.parseIdent(!1),this.type===oe.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(t,"RestElement")):(t.argument=this.parseMaybeAssign(!1,e),this.type===oe.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(t,"SpreadElement"));this.options.ecmaVersion>=6&&(t.method=!1,t.shorthand=!1,(n||e)&&(a=this.start,i=this.startLoc),n||(s=this.eat(oe.star)));var o=this.containsEsc;return this.parsePropertyName(t),!n&&!o&&this.options.ecmaVersion>=8&&!s&&this.isAsyncProp(t)?(r=!0,s=this.options.ecmaVersion>=9&&this.eat(oe.star),this.parsePropertyName(t)):r=!1,this.parsePropertyValue(t,n,s,r,a,i,e,o),this.finishNode(t,"Property")};vn.parseGetterSetter=function(n){n.kind=n.key.name,this.parsePropertyName(n),n.value=this.parseMethod(!1);var e=n.kind==="get"?0:1;if(n.value.params.length!==e){var t=n.value.start;n.kind==="get"?this.raiseRecoverable(t,"getter should have no params"):this.raiseRecoverable(t,"setter should have exactly one param")}else n.kind==="set"&&n.value.params[0].type==="RestElement"&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params")};vn.parsePropertyValue=function(n,e,t,s,r,a,i,o){(t||s)&&this.type===oe.colon&&this.unexpected(),this.eat(oe.colon)?(n.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,i),n.kind="init"):this.options.ecmaVersion>=6&&this.type===oe.parenL?(e&&this.unexpected(),n.kind="init",n.method=!0,n.value=this.parseMethod(t,s)):!e&&!o&&this.options.ecmaVersion>=5&&!n.computed&&n.key.type==="Identifier"&&(n.key.name==="get"||n.key.name==="set")&&this.type!==oe.comma&&this.type!==oe.braceR&&this.type!==oe.eq?((t||s)&&this.unexpected(),this.parseGetterSetter(n)):this.options.ecmaVersion>=6&&!n.computed&&n.key.type==="Identifier"?((t||s)&&this.unexpected(),this.checkUnreserved(n.key),n.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=r),n.kind="init",e?n.value=this.parseMaybeDefault(r,a,this.copyNode(n.key)):this.type===oe.eq&&i?(i.shorthandAssign<0&&(i.shorthandAssign=this.start),n.value=this.parseMaybeDefault(r,a,this.copyNode(n.key))):n.value=this.copyNode(n.key),n.shorthand=!0):this.unexpected()};vn.parsePropertyName=function(n){if(this.options.ecmaVersion>=6){if(this.eat(oe.bracketL))return n.computed=!0,n.key=this.parseMaybeAssign(),this.expect(oe.bracketR),n.key;n.computed=!1}return n.key=this.type===oe.num||this.type===oe.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};vn.initFunction=function(n){n.id=null,this.options.ecmaVersion>=6&&(n.generator=n.expression=!1),this.options.ecmaVersion>=8&&(n.async=!1)};vn.parseMethod=function(n,e,t){var s=this.startNode(),r=this.yieldPos,a=this.awaitPos,i=this.awaitIdentPos;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=n),this.options.ecmaVersion>=8&&(s.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(TA(e,s.generator)|MA|(t?AV:0)),this.expect(oe.parenL),s.params=this.parseBindingList(oe.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(s,!1,!0,!1),this.yieldPos=r,this.awaitPos=a,this.awaitIdentPos=i,this.finishNode(s,"FunctionExpression")};vn.parseArrowExpression=function(n,e,t,s){var r=this.yieldPos,a=this.awaitPos,i=this.awaitIdentPos;return this.enterScope(TA(t,!1)|CV),this.initFunction(n),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,n.params=this.toAssignableList(e,!0),this.parseFunctionBody(n,!0,!1,s),this.yieldPos=r,this.awaitPos=a,this.awaitIdentPos=i,this.finishNode(n,"ArrowFunctionExpression")};vn.parseFunctionBody=function(n,e,t,s){var r=e&&this.type!==oe.braceL,a=this.strict,i=!1;if(r)n.body=this.parseMaybeAssign(s),n.expression=!0,this.checkParams(n,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(n.params);(!a||o)&&(i=this.strictDirective(this.end),i&&o&&this.raiseRecoverable(n.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],i&&(this.strict=!0),this.checkParams(n,!a&&!i&&!e&&!t&&this.isSimpleParamList(n.params)),this.strict&&n.id&&this.checkLValSimple(n.id,DV),n.body=this.parseBlock(!1,void 0,i&&!a),n.expression=!1,this.adaptDirectivePrologue(n.body.body),this.labels=l}this.exitScope()};vn.isSimpleParamList=function(n){for(var e=0,t=n;e<t.length;e+=1){var s=t[e];if(s.type!=="Identifier")return!1}return!0};vn.checkParams=function(n,e){for(var t=Object.create(null),s=0,r=n.params;s<r.length;s+=1){var a=r[s];this.checkLValInnerPattern(a,BA,e?null:t)}};vn.parseExprList=function(n,e,t,s){for(var r=[],a=!0;!this.eat(n);){if(a)a=!1;else if(this.expect(oe.comma),e&&this.afterTrailingComma(n))break;var i=void 0;t&&this.type===oe.comma?i=null:this.type===oe.ellipsis?(i=this.parseSpread(s),s&&this.type===oe.comma&&s.trailingComma<0&&(s.trailingComma=this.start)):i=this.parseMaybeAssign(!1,s),r.push(i)}return r};vn.checkUnreserved=function(n){var e=n.start,t=n.end,s=n.name;if(this.inGenerator&&s==="yield"&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&s==="arguments"&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(s==="arguments"||s==="await")&&this.raise(e,"Cannot use "+s+" in class static initialization block"),this.keywords.test(s)&&this.raise(e,"Unexpected keyword '"+s+"'"),!(this.options.ecmaVersion<6&&this.input.slice(e,t).indexOf("\\")!==-1)){var r=this.strict?this.reservedWordsStrict:this.reservedWords;r.test(s)&&(!this.inAsync&&s==="await"&&this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+s+"' is reserved"))}};vn.parseIdent=function(n){var e=this.parseIdentNode();return this.next(!!n),this.finishNode(e,"Identifier"),n||(this.checkUnreserved(e),e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=e.start)),e};vn.parseIdentNode=function(){var n=this.startNode();return this.type===oe.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,(n.name==="class"||n.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=oe.name):this.unexpected(),n};vn.parsePrivateIdent=function(){var n=this.startNode();return this.type===oe.privateId?n.name=this.value:this.unexpected(),this.next(),this.finishNode(n,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(n.start,"Private field '#"+n.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(n)),n};vn.parseYield=function(n){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===oe.semi||this.canInsertSemicolon()||this.type!==oe.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(oe.star),e.argument=this.parseMaybeAssign(n)),this.finishNode(e,"YieldExpression")};vn.parseAwait=function(n){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,n),this.finishNode(e,"AwaitExpression")};var By=Mr.prototype;By.raise=function(n,e){var t=kV(this.input,n);e+=" ("+t.line+":"+t.column+")";var s=new SyntaxError(e);throw s.pos=n,s.loc=t,s.raisedAt=this.pos,s};By.raiseRecoverable=By.raise;By.curPosition=function(){if(this.options.locations)return new mf(this.curLine,this.pos-this.lineStart)};var Eu=Mr.prototype,Pye=function(n){this.flags=n,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};Eu.enterScope=function(n){this.scopeStack.push(new Pye(n))};Eu.exitScope=function(){this.scopeStack.pop()};Eu.treatFunctionsAsVarInScope=function(n){return n.flags&yp||!this.inModule&&n.flags&ff};Eu.declareName=function(n,e,t){var s=!1;if(e===Mc){var r=this.currentScope();s=r.lexical.indexOf(n)>-1||r.functions.indexOf(n)>-1||r.var.indexOf(n)>-1,r.lexical.push(n),this.inModule&&r.flags&ff&&delete this.undefinedExports[n]}else if(e===MV){var a=this.currentScope();a.lexical.push(n)}else if(e===EV){var i=this.currentScope();this.treatFunctionsAsVar?s=i.lexical.indexOf(n)>-1:s=i.lexical.indexOf(n)>-1||i.var.indexOf(n)>-1,i.functions.push(n)}else for(var o=this.scopeStack.length-1;o>=0;--o){var l=this.scopeStack[o];if(l.lexical.indexOf(n)>-1&&!(l.flags&PV&&l.lexical[0]===n)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(n)>-1){s=!0;break}if(l.var.push(n),this.inModule&&l.flags&ff&&delete this.undefinedExports[n],l.flags&DA)break}s&&this.raiseRecoverable(t,"Identifier '"+n+"' has already been declared")};Eu.checkLocalExport=function(n){this.scopeStack[0].lexical.indexOf(n.name)===-1&&this.scopeStack[0].var.indexOf(n.name)===-1&&(this.undefinedExports[n.name]=n)};Eu.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Eu.currentVarScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&DA)return e}};Eu.currentThisScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&DA&&!(e.flags&CV))return e}};var Mv=function(n,e,t){this.type="",this.start=e,this.end=0,n.options.locations&&(this.loc=new Av(n,t)),n.options.directSourceFile&&(this.sourceFile=n.options.directSourceFile),n.options.ranges&&(this.range=[e,0])},og=Mr.prototype;og.startNode=function(){return new Mv(this,this.start,this.startLoc)};og.startNodeAt=function(n,e){return new Mv(this,n,e)};function FV(n,e,t,s){return n.type=e,n.end=t,this.options.locations&&(n.loc.end=s),this.options.ranges&&(n.range[1]=t),n}og.finishNode=function(n,e){return FV.call(this,n,e,this.lastTokEnd,this.lastTokEndLoc)};og.finishNodeAt=function(n,e,t,s){return FV.call(this,n,e,t,s)};og.copyNode=function(n){var e=new Mv(this,n.start,this.startLoc);for(var t in n)e[t]=n[t];return e};var Aye="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",$V="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",NV=$V+" Extended_Pictographic",_V=NV,RV=_V+" EBase EComp EMod EPres ExtPict",IV=RV,Eye=IV,Mye={9:$V,10:NV,11:_V,12:RV,13:IV,14:Eye},Dye="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",Tye={9:"",10:"",11:"",12:"",13:"",14:Dye},ID="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",LV="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",QV=LV+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",jV=QV+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",VV=jV+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",ZV=VV+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",Bye=ZV+" "+Aye,Fye={9:LV,10:QV,11:jV,12:VV,13:ZV,14:Bye},zV={};function $ye(n){var e=zV[n]={binary:Wc(Mye[n]+" "+ID),binaryOfStrings:Wc(Tye[n]),nonBinary:{General_Category:Wc(ID),Script:Wc(Fye[n])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(var Tw=0,LD=[9,10,11,12,13,14];Tw<LD.length;Tw+=1){var Nye=LD[Tw];$ye(Nye)}var jt=Mr.prototype,Fy=function(n,e){this.parent=n,this.base=e||this};Fy.prototype.separatedFrom=function(n){for(var e=this;e;e=e.parent)for(var t=n;t;t=t.parent)if(e.base===t.base&&e!==t)return!0;return!1};Fy.prototype.sibling=function(){return new Fy(this.parent,this.base)};var Zl=function(n){this.parser=n,this.validFlags="gim"+(n.options.ecmaVersion>=6?"uy":"")+(n.options.ecmaVersion>=9?"s":"")+(n.options.ecmaVersion>=13?"d":"")+(n.options.ecmaVersion>=15?"v":""),this.unicodeProperties=zV[n.options.ecmaVersion>=14?14:n.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Zl.prototype.reset=function(n,e,t){var s=t.indexOf("v")!==-1,r=t.indexOf("u")!==-1;this.start=n|0,this.source=e+"",this.flags=t,s&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=r&&this.parser.options.ecmaVersion>=9)};Zl.prototype.raise=function(n){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+n)};Zl.prototype.at=function(n,e){e===void 0&&(e=!1);var t=this.source,s=t.length;if(n>=s)return-1;var r=t.charCodeAt(n);if(!(e||this.switchU)||r<=55295||r>=57344||n+1>=s)return r;var a=t.charCodeAt(n+1);return a>=56320&&a<=57343?(r<<10)+a-56613888:r};Zl.prototype.nextIndex=function(n,e){e===void 0&&(e=!1);var t=this.source,s=t.length;if(n>=s)return s;var r=t.charCodeAt(n),a;return!(e||this.switchU)||r<=55295||r>=57344||n+1>=s||(a=t.charCodeAt(n+1))<56320||a>57343?n+1:n+2};Zl.prototype.current=function(n){return n===void 0&&(n=!1),this.at(this.pos,n)};Zl.prototype.lookahead=function(n){return n===void 0&&(n=!1),this.at(this.nextIndex(this.pos,n),n)};Zl.prototype.advance=function(n){n===void 0&&(n=!1),this.pos=this.nextIndex(this.pos,n)};Zl.prototype.eat=function(n,e){return e===void 0&&(e=!1),this.current(e)===n?(this.advance(e),!0):!1};Zl.prototype.eatChars=function(n,e){e===void 0&&(e=!1);for(var t=this.pos,s=0,r=n;s<r.length;s+=1){var a=r[s],i=this.at(t,e);if(i===-1||i!==a)return!1;t=this.nextIndex(t,e)}return this.pos=t,!0};jt.validateRegExpFlags=function(n){for(var e=n.validFlags,t=n.flags,s=!1,r=!1,a=0;a<t.length;a++){var i=t.charAt(a);e.indexOf(i)===-1&&this.raise(n.start,"Invalid regular expression flag"),t.indexOf(i,a+1)>-1&&this.raise(n.start,"Duplicate regular expression flag"),i==="u"&&(s=!0),i==="v"&&(r=!0)}this.options.ecmaVersion>=15&&s&&r&&this.raise(n.start,"Invalid regular expression flag")};function _ye(n){for(var e in n)return!0;return!1}jt.validateRegExpPattern=function(n){this.regexp_pattern(n),!n.switchN&&this.options.ecmaVersion>=9&&_ye(n.groupNames)&&(n.switchN=!0,this.regexp_pattern(n))};jt.regexp_pattern=function(n){n.pos=0,n.lastIntValue=0,n.lastStringValue="",n.lastAssertionIsQuantifiable=!1,n.numCapturingParens=0,n.maxBackReference=0,n.groupNames=Object.create(null),n.backReferenceNames.length=0,n.branchID=null,this.regexp_disjunction(n),n.pos!==n.source.length&&(n.eat(41)&&n.raise("Unmatched ')'"),(n.eat(93)||n.eat(125))&&n.raise("Lone quantifier brackets")),n.maxBackReference>n.numCapturingParens&&n.raise("Invalid escape");for(var e=0,t=n.backReferenceNames;e<t.length;e+=1){var s=t[e];n.groupNames[s]||n.raise("Invalid named capture referenced")}};jt.regexp_disjunction=function(n){var e=this.options.ecmaVersion>=16;for(e&&(n.branchID=new Fy(n.branchID,null)),this.regexp_alternative(n);n.eat(124);)e&&(n.branchID=n.branchID.sibling()),this.regexp_alternative(n);e&&(n.branchID=n.branchID.parent),this.regexp_eatQuantifier(n,!0)&&n.raise("Nothing to repeat"),n.eat(123)&&n.raise("Lone quantifier brackets")};jt.regexp_alternative=function(n){for(;n.pos<n.source.length&&this.regexp_eatTerm(n););};jt.regexp_eatTerm=function(n){return this.regexp_eatAssertion(n)?(n.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(n)&&n.switchU&&n.raise("Invalid quantifier"),!0):(n.switchU?this.regexp_eatAtom(n):this.regexp_eatExtendedAtom(n))?(this.regexp_eatQuantifier(n),!0):!1};jt.regexp_eatAssertion=function(n){var e=n.pos;if(n.lastAssertionIsQuantifiable=!1,n.eat(94)||n.eat(36))return!0;if(n.eat(92)){if(n.eat(66)||n.eat(98))return!0;n.pos=e}if(n.eat(40)&&n.eat(63)){var t=!1;if(this.options.ecmaVersion>=9&&(t=n.eat(60)),n.eat(61)||n.eat(33))return this.regexp_disjunction(n),n.eat(41)||n.raise("Unterminated group"),n.lastAssertionIsQuantifiable=!t,!0}return n.pos=e,!1};jt.regexp_eatQuantifier=function(n,e){return e===void 0&&(e=!1),this.regexp_eatQuantifierPrefix(n,e)?(n.eat(63),!0):!1};jt.regexp_eatQuantifierPrefix=function(n,e){return n.eat(42)||n.eat(43)||n.eat(63)||this.regexp_eatBracedQuantifier(n,e)};jt.regexp_eatBracedQuantifier=function(n,e){var t=n.pos;if(n.eat(123)){var s=0,r=-1;if(this.regexp_eatDecimalDigits(n)&&(s=n.lastIntValue,n.eat(44)&&this.regexp_eatDecimalDigits(n)&&(r=n.lastIntValue),n.eat(125)))return r!==-1&&r<s&&!e&&n.raise("numbers out of order in {} quantifier"),!0;n.switchU&&!e&&n.raise("Incomplete quantifier"),n.pos=t}return!1};jt.regexp_eatAtom=function(n){return this.regexp_eatPatternCharacters(n)||n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)};jt.regexp_eatReverseSolidusAtomEscape=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatAtomEscape(n))return!0;n.pos=e}return!1};jt.regexp_eatUncapturingGroup=function(n){var e=n.pos;if(n.eat(40)){if(n.eat(63)){if(this.options.ecmaVersion>=16){var t=this.regexp_eatModifiers(n),s=n.eat(45);if(t||s){for(var r=0;r<t.length;r++){var a=t.charAt(r);t.indexOf(a,r+1)>-1&&n.raise("Duplicate regular expression modifiers")}if(s){var i=this.regexp_eatModifiers(n);!t&&!i&&n.current()===58&&n.raise("Invalid regular expression modifiers");for(var o=0;o<i.length;o++){var l=i.charAt(o);(i.indexOf(l,o+1)>-1||t.indexOf(l)>-1)&&n.raise("Duplicate regular expression modifiers")}}}}if(n.eat(58)){if(this.regexp_disjunction(n),n.eat(41))return!0;n.raise("Unterminated group")}}n.pos=e}return!1};jt.regexp_eatCapturingGroup=function(n){if(n.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(n):n.current()===63&&n.raise("Invalid group"),this.regexp_disjunction(n),n.eat(41))return n.numCapturingParens+=1,!0;n.raise("Unterminated group")}return!1};jt.regexp_eatModifiers=function(n){for(var e="",t=0;(t=n.current())!==-1&&Rye(t);)e+=xc(t),n.advance();return e};function Rye(n){return n===105||n===109||n===115}jt.regexp_eatExtendedAtom=function(n){return n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)||this.regexp_eatInvalidBracedQuantifier(n)||this.regexp_eatExtendedPatternCharacter(n)};jt.regexp_eatInvalidBracedQuantifier=function(n){return this.regexp_eatBracedQuantifier(n,!0)&&n.raise("Nothing to repeat"),!1};jt.regexp_eatSyntaxCharacter=function(n){var e=n.current();return qV(e)?(n.lastIntValue=e,n.advance(),!0):!1};function qV(n){return n===36||n>=40&&n<=43||n===46||n===63||n>=91&&n<=94||n>=123&&n<=125}jt.regexp_eatPatternCharacters=function(n){for(var e=n.pos,t=0;(t=n.current())!==-1&&!qV(t);)n.advance();return n.pos!==e};jt.regexp_eatExtendedPatternCharacter=function(n){var e=n.current();return e!==-1&&e!==36&&!(e>=40&&e<=43)&&e!==46&&e!==63&&e!==91&&e!==94&&e!==124?(n.advance(),!0):!1};jt.regexp_groupSpecifier=function(n){if(n.eat(63)){this.regexp_eatGroupName(n)||n.raise("Invalid group");var e=this.options.ecmaVersion>=16,t=n.groupNames[n.lastStringValue];if(t)if(e)for(var s=0,r=t;s<r.length;s+=1){var a=r[s];a.separatedFrom(n.branchID)||n.raise("Duplicate capture group name")}else n.raise("Duplicate capture group name");e?(t||(n.groupNames[n.lastStringValue]=[])).push(n.branchID):n.groupNames[n.lastStringValue]=!0}};jt.regexp_eatGroupName=function(n){if(n.lastStringValue="",n.eat(60)){if(this.regexp_eatRegExpIdentifierName(n)&&n.eat(62))return!0;n.raise("Invalid capture group name")}return!1};jt.regexp_eatRegExpIdentifierName=function(n){if(n.lastStringValue="",this.regexp_eatRegExpIdentifierStart(n)){for(n.lastStringValue+=xc(n.lastIntValue);this.regexp_eatRegExpIdentifierPart(n);)n.lastStringValue+=xc(n.lastIntValue);return!0}return!1};jt.regexp_eatRegExpIdentifierStart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,s=n.current(t);return n.advance(t),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(s=n.lastIntValue),Iye(s)?(n.lastIntValue=s,!0):(n.pos=e,!1)};function Iye(n){return wc(n,!0)||n===36||n===95}jt.regexp_eatRegExpIdentifierPart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,s=n.current(t);return n.advance(t),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(s=n.lastIntValue),Lye(s)?(n.lastIntValue=s,!0):(n.pos=e,!1)};function Lye(n){return Ld(n,!0)||n===36||n===95||n===8204||n===8205}jt.regexp_eatAtomEscape=function(n){return this.regexp_eatBackReference(n)||this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)||n.switchN&&this.regexp_eatKGroupName(n)?!0:(n.switchU&&(n.current()===99&&n.raise("Invalid unicode escape"),n.raise("Invalid escape")),!1)};jt.regexp_eatBackReference=function(n){var e=n.pos;if(this.regexp_eatDecimalEscape(n)){var t=n.lastIntValue;if(n.switchU)return t>n.maxBackReference&&(n.maxBackReference=t),!0;if(t<=n.numCapturingParens)return!0;n.pos=e}return!1};jt.regexp_eatKGroupName=function(n){if(n.eat(107)){if(this.regexp_eatGroupName(n))return n.backReferenceNames.push(n.lastStringValue),!0;n.raise("Invalid named reference")}return!1};jt.regexp_eatCharacterEscape=function(n){return this.regexp_eatControlEscape(n)||this.regexp_eatCControlLetter(n)||this.regexp_eatZero(n)||this.regexp_eatHexEscapeSequence(n)||this.regexp_eatRegExpUnicodeEscapeSequence(n,!1)||!n.switchU&&this.regexp_eatLegacyOctalEscapeSequence(n)||this.regexp_eatIdentityEscape(n)};jt.regexp_eatCControlLetter=function(n){var e=n.pos;if(n.eat(99)){if(this.regexp_eatControlLetter(n))return!0;n.pos=e}return!1};jt.regexp_eatZero=function(n){return n.current()===48&&!Dv(n.lookahead())?(n.lastIntValue=0,n.advance(),!0):!1};jt.regexp_eatControlEscape=function(n){var e=n.current();return e===116?(n.lastIntValue=9,n.advance(),!0):e===110?(n.lastIntValue=10,n.advance(),!0):e===118?(n.lastIntValue=11,n.advance(),!0):e===102?(n.lastIntValue=12,n.advance(),!0):e===114?(n.lastIntValue=13,n.advance(),!0):!1};jt.regexp_eatControlLetter=function(n){var e=n.current();return UV(e)?(n.lastIntValue=e%32,n.advance(),!0):!1};function UV(n){return n>=65&&n<=90||n>=97&&n<=122}jt.regexp_eatRegExpUnicodeEscapeSequence=function(n,e){e===void 0&&(e=!1);var t=n.pos,s=e||n.switchU;if(n.eat(117)){if(this.regexp_eatFixedHexDigits(n,4)){var r=n.lastIntValue;if(s&&r>=55296&&r<=56319){var a=n.pos;if(n.eat(92)&&n.eat(117)&&this.regexp_eatFixedHexDigits(n,4)){var i=n.lastIntValue;if(i>=56320&&i<=57343)return n.lastIntValue=(r-55296)*1024+(i-56320)+65536,!0}n.pos=a,n.lastIntValue=r}return!0}if(s&&n.eat(123)&&this.regexp_eatHexDigits(n)&&n.eat(125)&&Qye(n.lastIntValue))return!0;s&&n.raise("Invalid unicode escape"),n.pos=t}return!1};function Qye(n){return n>=0&&n<=1114111}jt.regexp_eatIdentityEscape=function(n){if(n.switchU)return this.regexp_eatSyntaxCharacter(n)?!0:n.eat(47)?(n.lastIntValue=47,!0):!1;var e=n.current();return e!==99&&(!n.switchN||e!==107)?(n.lastIntValue=e,n.advance(),!0):!1};jt.regexp_eatDecimalEscape=function(n){n.lastIntValue=0;var e=n.current();if(e>=49&&e<=57){do n.lastIntValue=10*n.lastIntValue+(e-48),n.advance();while((e=n.current())>=48&&e<=57);return!0}return!1};var WV=0,kc=1,Yi=2;jt.regexp_eatCharacterClassEscape=function(n){var e=n.current();if(jye(e))return n.lastIntValue=-1,n.advance(),kc;var t=!1;if(n.switchU&&this.options.ecmaVersion>=9&&((t=e===80)||e===112)){n.lastIntValue=-1,n.advance();var s;if(n.eat(123)&&(s=this.regexp_eatUnicodePropertyValueExpression(n))&&n.eat(125))return t&&s===Yi&&n.raise("Invalid property name"),s;n.raise("Invalid property name")}return WV};function jye(n){return n===100||n===68||n===115||n===83||n===119||n===87}jt.regexp_eatUnicodePropertyValueExpression=function(n){var e=n.pos;if(this.regexp_eatUnicodePropertyName(n)&&n.eat(61)){var t=n.lastStringValue;if(this.regexp_eatUnicodePropertyValue(n)){var s=n.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(n,t,s),kc}}if(n.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(n)){var r=n.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(n,r)}return WV};jt.regexp_validateUnicodePropertyNameAndValue=function(n,e,t){bp(n.unicodeProperties.nonBinary,e)||n.raise("Invalid property name"),n.unicodeProperties.nonBinary[e].test(t)||n.raise("Invalid property value")};jt.regexp_validateUnicodePropertyNameOrValue=function(n,e){if(n.unicodeProperties.binary.test(e))return kc;if(n.switchV&&n.unicodeProperties.binaryOfStrings.test(e))return Yi;n.raise("Invalid property name")};jt.regexp_eatUnicodePropertyName=function(n){var e=0;for(n.lastStringValue="";GV(e=n.current());)n.lastStringValue+=xc(e),n.advance();return n.lastStringValue!==""};function GV(n){return UV(n)||n===95}jt.regexp_eatUnicodePropertyValue=function(n){var e=0;for(n.lastStringValue="";Vye(e=n.current());)n.lastStringValue+=xc(e),n.advance();return n.lastStringValue!==""};function Vye(n){return GV(n)||Dv(n)}jt.regexp_eatLoneUnicodePropertyNameOrValue=function(n){return this.regexp_eatUnicodePropertyValue(n)};jt.regexp_eatCharacterClass=function(n){if(n.eat(91)){var e=n.eat(94),t=this.regexp_classContents(n);return n.eat(93)||n.raise("Unterminated character class"),e&&t===Yi&&n.raise("Negated character class may contain strings"),!0}return!1};jt.regexp_classContents=function(n){return n.current()===93?kc:n.switchV?this.regexp_classSetExpression(n):(this.regexp_nonEmptyClassRanges(n),kc)};jt.regexp_nonEmptyClassRanges=function(n){for(;this.regexp_eatClassAtom(n);){var e=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassAtom(n)){var t=n.lastIntValue;n.switchU&&(e===-1||t===-1)&&n.raise("Invalid character class"),e!==-1&&t!==-1&&e>t&&n.raise("Range out of order in character class")}}};jt.regexp_eatClassAtom=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatClassEscape(n))return!0;if(n.switchU){var t=n.current();(t===99||YV(t))&&n.raise("Invalid class escape"),n.raise("Invalid escape")}n.pos=e}var s=n.current();return s!==93?(n.lastIntValue=s,n.advance(),!0):!1};jt.regexp_eatClassEscape=function(n){var e=n.pos;if(n.eat(98))return n.lastIntValue=8,!0;if(n.switchU&&n.eat(45))return n.lastIntValue=45,!0;if(!n.switchU&&n.eat(99)){if(this.regexp_eatClassControlLetter(n))return!0;n.pos=e}return this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)};jt.regexp_classSetExpression=function(n){var e=kc,t;if(!this.regexp_eatClassSetRange(n))if(t=this.regexp_eatClassSetOperand(n)){t===Yi&&(e=Yi);for(var s=n.pos;n.eatChars([38,38]);){if(n.current()!==38&&(t=this.regexp_eatClassSetOperand(n))){t!==Yi&&(e=kc);continue}n.raise("Invalid character in character class")}if(s!==n.pos)return e;for(;n.eatChars([45,45]);)this.regexp_eatClassSetOperand(n)||n.raise("Invalid character in character class");if(s!==n.pos)return e}else n.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(n)){if(t=this.regexp_eatClassSetOperand(n),!t)return e;t===Yi&&(e=Yi)}};jt.regexp_eatClassSetRange=function(n){var e=n.pos;if(this.regexp_eatClassSetCharacter(n)){var t=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassSetCharacter(n)){var s=n.lastIntValue;return t!==-1&&s!==-1&&t>s&&n.raise("Range out of order in character class"),!0}n.pos=e}return!1};jt.regexp_eatClassSetOperand=function(n){return this.regexp_eatClassSetCharacter(n)?kc:this.regexp_eatClassStringDisjunction(n)||this.regexp_eatNestedClass(n)};jt.regexp_eatNestedClass=function(n){var e=n.pos;if(n.eat(91)){var t=n.eat(94),s=this.regexp_classContents(n);if(n.eat(93))return t&&s===Yi&&n.raise("Negated character class may contain strings"),s;n.pos=e}if(n.eat(92)){var r=this.regexp_eatCharacterClassEscape(n);if(r)return r;n.pos=e}return null};jt.regexp_eatClassStringDisjunction=function(n){var e=n.pos;if(n.eatChars([92,113])){if(n.eat(123)){var t=this.regexp_classStringDisjunctionContents(n);if(n.eat(125))return t}else n.raise("Invalid escape");n.pos=e}return null};jt.regexp_classStringDisjunctionContents=function(n){for(var e=this.regexp_classString(n);n.eat(124);)this.regexp_classString(n)===Yi&&(e=Yi);return e};jt.regexp_classString=function(n){for(var e=0;this.regexp_eatClassSetCharacter(n);)e++;return e===1?kc:Yi};jt.regexp_eatClassSetCharacter=function(n){var e=n.pos;if(n.eat(92))return this.regexp_eatCharacterEscape(n)||this.regexp_eatClassSetReservedPunctuator(n)?!0:n.eat(98)?(n.lastIntValue=8,!0):(n.pos=e,!1);var t=n.current();return t<0||t===n.lookahead()&&Zye(t)||zye(t)?!1:(n.advance(),n.lastIntValue=t,!0)};function Zye(n){return n===33||n>=35&&n<=38||n>=42&&n<=44||n===46||n>=58&&n<=64||n===94||n===96||n===126}function zye(n){return n===40||n===41||n===45||n===47||n>=91&&n<=93||n>=123&&n<=125}jt.regexp_eatClassSetReservedPunctuator=function(n){var e=n.current();return qye(e)?(n.lastIntValue=e,n.advance(),!0):!1};function qye(n){return n===33||n===35||n===37||n===38||n===44||n===45||n>=58&&n<=62||n===64||n===96||n===126}jt.regexp_eatClassControlLetter=function(n){var e=n.current();return Dv(e)||e===95?(n.lastIntValue=e%32,n.advance(),!0):!1};jt.regexp_eatHexEscapeSequence=function(n){var e=n.pos;if(n.eat(120)){if(this.regexp_eatFixedHexDigits(n,2))return!0;n.switchU&&n.raise("Invalid escape"),n.pos=e}return!1};jt.regexp_eatDecimalDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;Dv(t=n.current());)n.lastIntValue=10*n.lastIntValue+(t-48),n.advance();return n.pos!==e};function Dv(n){return n>=48&&n<=57}jt.regexp_eatHexDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;XV(t=n.current());)n.lastIntValue=16*n.lastIntValue+HV(t),n.advance();return n.pos!==e};function XV(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function HV(n){return n>=65&&n<=70?10+(n-65):n>=97&&n<=102?10+(n-97):n-48}jt.regexp_eatLegacyOctalEscapeSequence=function(n){if(this.regexp_eatOctalDigit(n)){var e=n.lastIntValue;if(this.regexp_eatOctalDigit(n)){var t=n.lastIntValue;e<=3&&this.regexp_eatOctalDigit(n)?n.lastIntValue=e*64+t*8+n.lastIntValue:n.lastIntValue=e*8+t}else n.lastIntValue=e;return!0}return!1};jt.regexp_eatOctalDigit=function(n){var e=n.current();return YV(e)?(n.lastIntValue=e-48,n.advance(),!0):(n.lastIntValue=0,!1)};function YV(n){return n>=48&&n<=55}jt.regexp_eatFixedHexDigits=function(n,e){var t=n.pos;n.lastIntValue=0;for(var s=0;s<e;++s){var r=n.current();if(!XV(r))return n.pos=t,!1;n.lastIntValue=16*n.lastIntValue+HV(r),n.advance()}return!0};var $A=function(n){this.type=n.type,this.value=n.value,this.start=n.start,this.end=n.end,n.options.locations&&(this.loc=new Av(n,n.startLoc,n.endLoc)),n.options.ranges&&(this.range=[n.start,n.end])},Hn=Mr.prototype;Hn.next=function(n){!n&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new $A(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};Hn.getToken=function(){return this.next(),new $A(this)};typeof Symbol<"u"&&(Hn[Symbol.iterator]=function(){var n=this;return{next:function(){var e=n.getToken();return{done:e.type===oe.eof,value:e}}}});Hn.nextToken=function(){var n=this.curContext();if((!n||!n.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(oe.eof);if(n.override)return n.override(this);this.readToken(this.fullCharCodeAtPos())};Hn.readToken=function(n){return wc(n,this.options.ecmaVersion>=6)||n===92?this.readWord():this.getTokenFromCode(n)};Hn.fullCharCodeAtPos=function(){var n=this.input.charCodeAt(this.pos);if(n<=55295||n>=56320)return n;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?n:(n<<10)+e-56613888};Hn.skipBlockComment=function(){var n=this.options.onComment&&this.curPosition(),e=this.pos,t=this.input.indexOf("*/",this.pos+=2);if(t===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=t+2,this.options.locations)for(var s=void 0,r=e;(s=OV(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=s;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,t),e,this.pos,n,this.curPosition())};Hn.skipLineComment=function(n){for(var e=this.pos,t=this.options.onComment&&this.curPosition(),s=this.input.charCodeAt(this.pos+=n);this.pos<this.input.length&&!gp(s);)s=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+n,this.pos),e,this.pos,t,this.curPosition())};Hn.skipSpace=function(){e:for(;this.pos<this.input.length;){var n=this.input.charCodeAt(this.pos);switch(n){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(n>8&&n<14||n>=5760&&wV.test(String.fromCharCode(n)))++this.pos;else break e}}};Hn.finishToken=function(n,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var t=this.type;this.type=n,this.value=e,this.updateContext(t)};Hn.readToken_dot=function(){var n=this.input.charCodeAt(this.pos+1);if(n>=48&&n<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&n===46&&e===46?(this.pos+=3,this.finishToken(oe.ellipsis)):(++this.pos,this.finishToken(oe.dot))};Hn.readToken_slash=function(){var n=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):n===61?this.finishOp(oe.assign,2):this.finishOp(oe.slash,1)};Hn.readToken_mult_modulo_exp=function(n){var e=this.input.charCodeAt(this.pos+1),t=1,s=n===42?oe.star:oe.modulo;return this.options.ecmaVersion>=7&&n===42&&e===42&&(++t,s=oe.starstar,e=this.input.charCodeAt(this.pos+2)),e===61?this.finishOp(oe.assign,t+1):this.finishOp(s,t)};Hn.readToken_pipe_amp=function(n){var e=this.input.charCodeAt(this.pos+1);if(e===n){if(this.options.ecmaVersion>=12){var t=this.input.charCodeAt(this.pos+2);if(t===61)return this.finishOp(oe.assign,3)}return this.finishOp(n===124?oe.logicalOR:oe.logicalAND,2)}return e===61?this.finishOp(oe.assign,2):this.finishOp(n===124?oe.bitwiseOR:oe.bitwiseAND,1)};Hn.readToken_caret=function(){var n=this.input.charCodeAt(this.pos+1);return n===61?this.finishOp(oe.assign,2):this.finishOp(oe.bitwiseXOR,1)};Hn.readToken_plus_min=function(n){var e=this.input.charCodeAt(this.pos+1);return e===n?e===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||bo.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(oe.incDec,2):e===61?this.finishOp(oe.assign,2):this.finishOp(oe.plusMin,1)};Hn.readToken_lt_gt=function(n){var e=this.input.charCodeAt(this.pos+1),t=1;return e===n?(t=n===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+t)===61?this.finishOp(oe.assign,t+1):this.finishOp(oe.bitShift,t)):e===33&&n===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(e===61&&(t=2),this.finishOp(oe.relational,t))};Hn.readToken_eq_excl=function(n){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(oe.equality,this.input.charCodeAt(this.pos+2)===61?3:2):n===61&&e===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(oe.arrow)):this.finishOp(n===61?oe.eq:oe.prefix,1)};Hn.readToken_question=function(){var n=this.options.ecmaVersion;if(n>=11){var e=this.input.charCodeAt(this.pos+1);if(e===46){var t=this.input.charCodeAt(this.pos+2);if(t<48||t>57)return this.finishOp(oe.questionDot,2)}if(e===63){if(n>=12){var s=this.input.charCodeAt(this.pos+2);if(s===61)return this.finishOp(oe.assign,3)}return this.finishOp(oe.coalesce,2)}}return this.finishOp(oe.question,1)};Hn.readToken_numberSign=function(){var n=this.options.ecmaVersion,e=35;if(n>=13&&(++this.pos,e=this.fullCharCodeAtPos(),wc(e,!0)||e===92))return this.finishToken(oe.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+xc(e)+"'")};Hn.getTokenFromCode=function(n){switch(n){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(oe.parenL);case 41:return++this.pos,this.finishToken(oe.parenR);case 59:return++this.pos,this.finishToken(oe.semi);case 44:return++this.pos,this.finishToken(oe.comma);case 91:return++this.pos,this.finishToken(oe.bracketL);case 93:return++this.pos,this.finishToken(oe.bracketR);case 123:return++this.pos,this.finishToken(oe.braceL);case 125:return++this.pos,this.finishToken(oe.braceR);case 58:return++this.pos,this.finishToken(oe.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(oe.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(e===120||e===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(e===111||e===79)return this.readRadixNumber(8);if(e===98||e===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(n);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(n);case 124:case 38:return this.readToken_pipe_amp(n);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(n);case 60:case 62:return this.readToken_lt_gt(n);case 61:case 33:return this.readToken_eq_excl(n);case 63:return this.readToken_question();case 126:return this.finishOp(oe.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+xc(n)+"'")};Hn.finishOp=function(n,e){var t=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(n,t)};Hn.readRegexp=function(){for(var n,e,t=this.pos;;){this.pos>=this.input.length&&this.raise(t,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(bo.test(s)&&this.raise(t,"Unterminated regular expression"),n)n=!1;else{if(s==="[")e=!0;else if(s==="]"&&e)e=!1;else if(s==="/"&&!e)break;n=s==="\\"}++this.pos}var r=this.input.slice(t,this.pos);++this.pos;var a=this.pos,i=this.readWord1();this.containsEsc&&this.unexpected(a);var o=this.regexpState||(this.regexpState=new Zl(this));o.reset(t,r,i),this.validateRegExpFlags(o),this.validateRegExpPattern(o);var l=null;try{l=new RegExp(r,i)}catch{}return this.finishToken(oe.regexp,{pattern:r,flags:i,value:l})};Hn.readInt=function(n,e,t){for(var s=this.options.ecmaVersion>=12&&e===void 0,r=t&&this.input.charCodeAt(this.pos)===48,a=this.pos,i=0,o=0,l=0,c=e??1/0;l<c;++l,++this.pos){var u=this.input.charCodeAt(this.pos),h=void 0;if(s&&u===95){r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),o===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),o=u;continue}if(u>=97?h=u-97+10:u>=65?h=u-65+10:u>=48&&u<=57?h=u-48:h=1/0,h>=n)break;o=u,i=i*n+h}return s&&o===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===a||e!=null&&this.pos-a!==e?null:i};function Uye(n,e){return e?parseInt(n,8):parseFloat(n.replace(/_/g,""))}function KV(n){return typeof BigInt!="function"?null:BigInt(n.replace(/_/g,""))}Hn.readRadixNumber=function(n){var e=this.pos;this.pos+=2;var t=this.readInt(n);return t==null&&this.raise(this.start+2,"Expected number in radix "+n),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(t=KV(this.input.slice(e,this.pos)),++this.pos):wc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(oe.num,t)};Hn.readNumber=function(n){var e=this.pos;!n&&this.readInt(10,void 0,!0)===null&&this.raise(e,"Invalid number");var t=this.pos-e>=2&&this.input.charCodeAt(e)===48;t&&this.strict&&this.raise(e,"Invalid number");var s=this.input.charCodeAt(this.pos);if(!t&&!n&&this.options.ecmaVersion>=11&&s===110){var r=KV(this.input.slice(e,this.pos));return++this.pos,wc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(oe.num,r)}t&&/[89]/.test(this.input.slice(e,this.pos))&&(t=!1),s===46&&!t&&(++this.pos,this.readInt(10),s=this.input.charCodeAt(this.pos)),(s===69||s===101)&&!t&&(s=this.input.charCodeAt(++this.pos),(s===43||s===45)&&++this.pos,this.readInt(10)===null&&this.raise(e,"Invalid number")),wc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a=Uye(this.input.slice(e,this.pos),t);return this.finishToken(oe.num,a)};Hn.readCodePoint=function(){var n=this.input.charCodeAt(this.pos),e;if(n===123){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e};Hn.readString=function(n){for(var e="",t=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var s=this.input.charCodeAt(this.pos);if(s===n)break;s===92?(e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!1),t=this.pos):s===8232||s===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(gp(s)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(t,this.pos++),this.finishToken(oe.string,e)};var JV={};Hn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(n){if(n===JV)this.readInvalidTemplateToken();else throw n}this.inTemplateElement=!1};Hn.invalidStringToken=function(n,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw JV;this.raise(n,e)};Hn.readTmplToken=function(){for(var n="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var t=this.input.charCodeAt(this.pos);if(t===96||t===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===oe.template||this.type===oe.invalidTemplate)?t===36?(this.pos+=2,this.finishToken(oe.dollarBraceL)):(++this.pos,this.finishToken(oe.backQuote)):(n+=this.input.slice(e,this.pos),this.finishToken(oe.template,n));if(t===92)n+=this.input.slice(e,this.pos),n+=this.readEscapedChar(!0),e=this.pos;else if(gp(t)){switch(n+=this.input.slice(e,this.pos),++this.pos,t){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:n+=`
`;break;default:n+=String.fromCharCode(t);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}};Hn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(oe.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};Hn.readEscapedChar=function(n){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return xc(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),n){var t=this.pos-1;this.invalidStringToken(t,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(s,8);return r>255&&(s=s.slice(0,-1),r=parseInt(s,8)),this.pos+=s.length-1,e=this.input.charCodeAt(this.pos),(s!=="0"||e===56||e===57)&&(this.strict||n)&&this.invalidStringToken(this.pos-1-s.length,n?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return gp(e)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(e)}};Hn.readHexChar=function(n){var e=this.pos,t=this.readInt(16,n);return t===null&&this.invalidStringToken(e,"Bad character escape sequence"),t};Hn.readWord1=function(){this.containsEsc=!1;for(var n="",e=!0,t=this.pos,s=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(Ld(r,s))this.pos+=r<=65535?1:2;else if(r===92){this.containsEsc=!0,n+=this.input.slice(t,this.pos);var a=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var i=this.readCodePoint();(e?wc:Ld)(i,s)||this.invalidStringToken(a,"Invalid Unicode escape"),n+=xc(i),t=this.pos}else break;e=!1}return n+this.input.slice(t,this.pos)};Hn.readWord=function(){var n=this.readWord1(),e=oe.name;return this.keywords.test(n)&&(e=AA[n]),this.finishToken(e,n)};var Wye="8.14.0";Mr.acorn={Parser:Mr,version:Wye,defaultOptions:R2,Position:mf,SourceLocation:Av,getLineInfo:kV,Node:Mv,TokenType:ss,tokTypes:oe,keywordTypes:AA,TokContext:Eo,tokContexts:Zs,isIdentifierChar:Ld,isIdentifierStart:wc,Token:$A,isNewLine:gp,lineBreak:bo,lineBreakG:fye,nonASCIIwhitespace:wV};function Gye(n,e){return Mr.parse(n,e)}var Xye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hye(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function A5e(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var QD={},jD={},VD;function Yye(){return VD||(VD=1,(function(n){(function e(t){var s,r,a,i,o,l;function c($){var L={},I,q;for(I in $)$.hasOwnProperty(I)&&(q=$[I],typeof q=="object"&&q!==null?L[I]=c(q):L[I]=q);return L}function u($,L){var I,q,ce,ee;for(q=$.length,ce=0;q;)I=q>>>1,ee=ce+I,L($[ee])?q=I:(ce=ee+1,q-=I+1);return ce}s={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},a={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},i={},o={},l={},r={Break:i,Skip:o,Remove:l};function h($,L){this.parent=$,this.key=L}h.prototype.replace=function($){this.parent[this.key]=$},h.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function d($,L,I,q){this.node=$,this.path=L,this.wrap=I,this.ref=q}function m(){}m.prototype.path=function(){var $,L,I,q,ce,ee;function he(H,me){if(Array.isArray(me))for(I=0,q=me.length;I<q;++I)H.push(me[I]);else H.push(me)}if(!this.__current.path)return null;for(ce=[],$=2,L=this.__leavelist.length;$<L;++$)ee=this.__leavelist[$],he(ce,ee.path);return he(ce,this.__current.path),ce},m.prototype.type=function(){var $=this.current();return $.type||this.__current.wrap},m.prototype.parents=function(){var $,L,I;for(I=[],$=1,L=this.__leavelist.length;$<L;++$)I.push(this.__leavelist[$].node);return I},m.prototype.current=function(){return this.__current.node},m.prototype.__execute=function($,L){var I,q;return q=void 0,I=this.__current,this.__current=L,this.__state=null,$&&(q=$.call(this,L.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=I,q},m.prototype.notify=function($){this.__state=$},m.prototype.skip=function(){this.notify(o)},m.prototype.break=function(){this.notify(i)},m.prototype.remove=function(){this.notify(l)},m.prototype.__initialize=function($,L){this.visitor=L,this.root=$,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,L.fallback==="iteration"?this.__fallback=Object.keys:typeof L.fallback=="function"&&(this.__fallback=L.fallback),this.__keys=a,L.keys&&(this.__keys=Object.assign(Object.create(this.__keys),L.keys))};function y($){return $==null?!1:typeof $=="object"&&typeof $.type=="string"}function O($,L){return($===s.ObjectExpression||$===s.ObjectPattern)&&L==="properties"}function S($,L){for(var I=$.length-1;I>=0;--I)if($[I].node===L)return!0;return!1}m.prototype.traverse=function($,L){var I,q,ce,ee,he,H,me,Oe,Pe,De,Se,ae;for(this.__initialize($,L),ae={},I=this.__worklist,q=this.__leavelist,I.push(new d($,null,null,null)),q.push(new d(null,null,null,null));I.length;){if(ce=I.pop(),ce===ae){if(ce=q.pop(),H=this.__execute(L.leave,ce),this.__state===i||H===i)return;continue}if(ce.node){if(H=this.__execute(L.enter,ce),this.__state===i||H===i)return;if(I.push(ae),q.push(ce),this.__state===o||H===o)continue;if(ee=ce.node,he=ee.type||ce.wrap,De=this.__keys[he],!De)if(this.__fallback)De=this.__fallback(ee);else throw new Error("Unknown node type "+he+".");for(Oe=De.length;(Oe-=1)>=0;)if(me=De[Oe],Se=ee[me],!!Se){if(Array.isArray(Se)){for(Pe=Se.length;(Pe-=1)>=0;)if(Se[Pe]&&!S(q,Se[Pe])){if(O(he,De[Oe]))ce=new d(Se[Pe],[me,Pe],"Property",null);else if(y(Se[Pe]))ce=new d(Se[Pe],[me,Pe],null,null);else continue;I.push(ce)}}else if(y(Se)){if(S(q,Se))continue;I.push(new d(Se,me,null,null))}}}}},m.prototype.replace=function($,L){var I,q,ce,ee,he,H,me,Oe,Pe,De,Se,ae,Ee;function Qe(Ke){var ge,Ye,yt,Xe;if(Ke.ref.remove()){for(Ye=Ke.ref.key,Xe=Ke.ref.parent,ge=I.length;ge--;)if(yt=I[ge],yt.ref&&yt.ref.parent===Xe){if(yt.ref.key<Ye)break;--yt.ref.key}}}for(this.__initialize($,L),Se={},I=this.__worklist,q=this.__leavelist,ae={root:$},H=new d($,null,null,new h(ae,"root")),I.push(H),q.push(H);I.length;){if(H=I.pop(),H===Se){if(H=q.pop(),he=this.__execute(L.leave,H),he!==void 0&&he!==i&&he!==o&&he!==l&&H.ref.replace(he),(this.__state===l||he===l)&&Qe(H),this.__state===i||he===i)return ae.root;continue}if(he=this.__execute(L.enter,H),he!==void 0&&he!==i&&he!==o&&he!==l&&(H.ref.replace(he),H.node=he),(this.__state===l||he===l)&&(Qe(H),H.node=null),this.__state===i||he===i)return ae.root;if(ce=H.node,!!ce&&(I.push(Se),q.push(H),!(this.__state===o||he===o))){if(ee=ce.type||H.wrap,Pe=this.__keys[ee],!Pe)if(this.__fallback)Pe=this.__fallback(ce);else throw new Error("Unknown node type "+ee+".");for(me=Pe.length;(me-=1)>=0;)if(Ee=Pe[me],De=ce[Ee],!!De)if(Array.isArray(De)){for(Oe=De.length;(Oe-=1)>=0;)if(De[Oe]){if(O(ee,Pe[me]))H=new d(De[Oe],[Ee,Oe],"Property",new h(De,Oe));else if(y(De[Oe]))H=new d(De[Oe],[Ee,Oe],null,new h(De,Oe));else continue;I.push(H)}}else y(De)&&I.push(new d(De,Ee,null,new h(ce,Ee)))}}return ae.root};function A($,L){var I=new m;return I.traverse($,L)}function F($,L){var I=new m;return I.replace($,L)}function j($,L){var I;return I=u(L,function(q){return q.range[0]>$.range[0]}),$.extendedRange=[$.range[0],$.range[1]],I!==L.length&&($.extendedRange[1]=L[I].range[0]),I-=1,I>=0&&($.extendedRange[0]=L[I].range[1]),$}function N($,L,I){var q=[],ce,ee,he,H;if(!$.range)throw new Error("attachComments needs range information");if(!I.length){if(L.length){for(he=0,ee=L.length;he<ee;he+=1)ce=c(L[he]),ce.extendedRange=[0,$.range[0]],q.push(ce);$.leadingComments=q}return $}for(he=0,ee=L.length;he<ee;he+=1)q.push(j(c(L[he]),I));return H=0,A($,{enter:function(me){for(var Oe;H<q.length&&(Oe=q[H],!(Oe.extendedRange[1]>me.range[0]));)Oe.extendedRange[1]===me.range[0]?(me.leadingComments||(me.leadingComments=[]),me.leadingComments.push(Oe),q.splice(H,1)):H+=1;if(H===q.length)return r.Break;if(q[H].extendedRange[0]>me.range[1])return r.Skip}}),H=0,A($,{leave:function(me){for(var Oe;H<q.length&&(Oe=q[H],!(me.range[1]<Oe.extendedRange[0]));)me.range[1]===Oe.extendedRange[0]?(me.trailingComments||(me.trailingComments=[]),me.trailingComments.push(Oe),q.splice(H,1)):H+=1;if(H===q.length)return r.Break;if(q[H].extendedRange[0]>me.range[1])return r.Skip}}),$}return t.Syntax=s,t.traverse=A,t.replace=F,t.attachComments=N,t.VisitorKeys=a,t.VisitorOption=r,t.Controller=m,t.cloneEnvironment=function(){return e({})},t})(n)})(jD)),jD}var Xg={},ZD={exports:{}},zD;function Kye(){return zD||(zD=1,(function(){function n(i){if(i==null)return!1;switch(i.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function e(i){if(i==null)return!1;switch(i.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function t(i){if(i==null)return!1;switch(i.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function s(i){return t(i)||i!=null&&i.type==="FunctionDeclaration"}function r(i){switch(i.type){case"IfStatement":return i.alternate!=null?i.alternate:i.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return i.body}return null}function a(i){var o;if(i.type!=="IfStatement"||i.alternate==null)return!1;o=i.consequent;do{if(o.type==="IfStatement"&&o.alternate==null)return!0;o=r(o)}while(o);return!1}ZD.exports={isExpression:n,isStatement:t,isIterationStatement:e,isSourceElement:s,isProblematicIfStatement:a,trailingStatement:r}})()),ZD.exports}var qD={exports:{}},UD;function eZ(){return UD||(UD=1,(function(){var n,e,t,s,r,a;e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},n={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function i(S){return 48<=S&&S<=57}function o(S){return 48<=S&&S<=57||97<=S&&S<=102||65<=S&&S<=70}function l(S){return S>=48&&S<=55}t=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function c(S){return S===32||S===9||S===11||S===12||S===160||S>=5760&&t.indexOf(S)>=0}function u(S){return S===10||S===13||S===8232||S===8233}function h(S){if(S<=65535)return String.fromCharCode(S);var A=String.fromCharCode(Math.floor((S-65536)/1024)+55296),F=String.fromCharCode((S-65536)%1024+56320);return A+F}for(s=new Array(128),a=0;a<128;++a)s[a]=a>=97&&a<=122||a>=65&&a<=90||a===36||a===95;for(r=new Array(128),a=0;a<128;++a)r[a]=a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===36||a===95;function d(S){return S<128?s[S]:e.NonAsciiIdentifierStart.test(h(S))}function m(S){return S<128?r[S]:e.NonAsciiIdentifierPart.test(h(S))}function y(S){return S<128?s[S]:n.NonAsciiIdentifierStart.test(h(S))}function O(S){return S<128?r[S]:n.NonAsciiIdentifierPart.test(h(S))}qD.exports={isDecimalDigit:i,isHexDigit:o,isOctalDigit:l,isWhiteSpace:c,isLineTerminator:u,isIdentifierStartES5:d,isIdentifierPartES5:m,isIdentifierStartES6:y,isIdentifierPartES6:O}})()),qD.exports}var WD={exports:{}},GD;function Jye(){return GD||(GD=1,(function(){var n=eZ();function e(d){switch(d){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function t(d,m){return!m&&d==="yield"?!1:s(d,m)}function s(d,m){if(m&&e(d))return!0;switch(d.length){case 2:return d==="if"||d==="in"||d==="do";case 3:return d==="var"||d==="for"||d==="new"||d==="try";case 4:return d==="this"||d==="else"||d==="case"||d==="void"||d==="with"||d==="enum";case 5:return d==="while"||d==="break"||d==="catch"||d==="throw"||d==="const"||d==="yield"||d==="class"||d==="super";case 6:return d==="return"||d==="typeof"||d==="delete"||d==="switch"||d==="export"||d==="import";case 7:return d==="default"||d==="finally"||d==="extends";case 8:return d==="function"||d==="continue"||d==="debugger";case 10:return d==="instanceof";default:return!1}}function r(d,m){return d==="null"||d==="true"||d==="false"||t(d,m)}function a(d,m){return d==="null"||d==="true"||d==="false"||s(d,m)}function i(d){return d==="eval"||d==="arguments"}function o(d){var m,y,O;if(d.length===0||(O=d.charCodeAt(0),!n.isIdentifierStartES5(O)))return!1;for(m=1,y=d.length;m<y;++m)if(O=d.charCodeAt(m),!n.isIdentifierPartES5(O))return!1;return!0}function l(d,m){return(d-55296)*1024+(m-56320)+65536}function c(d){var m,y,O,S,A;if(d.length===0)return!1;for(A=n.isIdentifierStartES6,m=0,y=d.length;m<y;++m){if(O=d.charCodeAt(m),55296<=O&&O<=56319){if(++m,m>=y||(S=d.charCodeAt(m),!(56320<=S&&S<=57343)))return!1;O=l(O,S)}if(!A(O))return!1;A=n.isIdentifierPartES6}return!0}function u(d,m){return o(d)&&!r(d,m)}function h(d,m){return c(d)&&!a(d,m)}WD.exports={isKeywordES5:t,isKeywordES6:s,isReservedWordES5:r,isReservedWordES6:a,isRestrictedWord:i,isIdentifierNameES5:o,isIdentifierNameES6:c,isIdentifierES5:u,isIdentifierES6:h}})()),WD.exports}var XD;function e1e(){return XD||(XD=1,(function(){Xg.ast=Kye(),Xg.code=eZ(),Xg.keyword=Jye()})()),Xg}var Hg={},Bw={},Yg={},Kg={},HD;function t1e(){if(HD)return Kg;HD=1;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return Kg.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},Kg.decode=function(e){var t=65,s=90,r=97,a=122,i=48,o=57,l=43,c=47,u=26,h=52;return t<=e&&e<=s?e-t:r<=e&&e<=a?e-r+u:i<=e&&e<=o?e-i+h:e==l?62:e==c?63:-1},Kg}var YD;function tZ(){if(YD)return Yg;YD=1;var n=t1e(),e=5,t=1<<e,s=t-1,r=t;function a(o){return o<0?(-o<<1)+1:(o<<1)+0}function i(o){var l=(o&1)===1,c=o>>1;return l?-c:c}return Yg.encode=function(o){var l="",c,u=a(o);do c=u&s,u>>>=e,u>0&&(c|=r),l+=n.encode(c);while(u>0);return l},Yg.decode=function(o,l,c){var u=o.length,h=0,d=0,m,y;do{if(l>=u)throw new Error("Expected more digits in base 64 VLQ value.");if(y=n.decode(o.charCodeAt(l++)),y===-1)throw new Error("Invalid base64 digit: "+o.charAt(l-1));m=!!(y&r),y&=s,h=h+(y<<d),d+=e}while(m);c.value=i(h),c.rest=l},Yg}var KD={},JD;function lg(){return JD||(JD=1,(function(n){function e(N,$,L){if($ in N)return N[$];if(arguments.length===3)return L;throw new Error('"'+$+'" is a required argument.')}n.getArg=e;var t=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,s=/^data:.+\,.+$/;function r(N){var $=N.match(t);return $?{scheme:$[1],auth:$[2],host:$[3],port:$[4],path:$[5]}:null}n.urlParse=r;function a(N){var $="";return N.scheme&&($+=N.scheme+":"),$+="//",N.auth&&($+=N.auth+"@"),N.host&&($+=N.host),N.port&&($+=":"+N.port),N.path&&($+=N.path),$}n.urlGenerate=a;function i(N){var $=N,L=r(N);if(L){if(!L.path)return N;$=L.path}for(var I=n.isAbsolute($),q=$.split(/\/+/),ce,ee=0,he=q.length-1;he>=0;he--)ce=q[he],ce==="."?q.splice(he,1):ce===".."?ee++:ee>0&&(ce===""?(q.splice(he+1,ee),ee=0):(q.splice(he,2),ee--));return $=q.join("/"),$===""&&($=I?"/":"."),L?(L.path=$,a(L)):$}n.normalize=i;function o(N,$){N===""&&(N="."),$===""&&($=".");var L=r($),I=r(N);if(I&&(N=I.path||"/"),L&&!L.scheme)return I&&(L.scheme=I.scheme),a(L);if(L||$.match(s))return $;if(I&&!I.host&&!I.path)return I.host=$,a(I);var q=$.charAt(0)==="/"?$:i(N.replace(/\/+$/,"")+"/"+$);return I?(I.path=q,a(I)):q}n.join=o,n.isAbsolute=function(N){return N.charAt(0)==="/"||t.test(N)};function l(N,$){N===""&&(N="."),N=N.replace(/\/$/,"");for(var L=0;$.indexOf(N+"/")!==0;){var I=N.lastIndexOf("/");if(I<0||(N=N.slice(0,I),N.match(/^([^\/]+:\/)?\/*$/)))return $;++L}return Array(L+1).join("../")+$.substr(N.length+1)}n.relative=l;var c=(function(){var N=Object.create(null);return!("__proto__"in N)})();function u(N){return N}function h(N){return m(N)?"$"+N:N}n.toSetString=c?u:h;function d(N){return m(N)?N.slice(1):N}n.fromSetString=c?u:d;function m(N){if(!N)return!1;var $=N.length;if($<9||N.charCodeAt($-1)!==95||N.charCodeAt($-2)!==95||N.charCodeAt($-3)!==111||N.charCodeAt($-4)!==116||N.charCodeAt($-5)!==111||N.charCodeAt($-6)!==114||N.charCodeAt($-7)!==112||N.charCodeAt($-8)!==95||N.charCodeAt($-9)!==95)return!1;for(var L=$-10;L>=0;L--)if(N.charCodeAt(L)!==36)return!1;return!0}function y(N,$,L){var I=S(N.source,$.source);return I!==0||(I=N.originalLine-$.originalLine,I!==0)||(I=N.originalColumn-$.originalColumn,I!==0||L)||(I=N.generatedColumn-$.generatedColumn,I!==0)||(I=N.generatedLine-$.generatedLine,I!==0)?I:S(N.name,$.name)}n.compareByOriginalPositions=y;function O(N,$,L){var I=N.generatedLine-$.generatedLine;return I!==0||(I=N.generatedColumn-$.generatedColumn,I!==0||L)||(I=S(N.source,$.source),I!==0)||(I=N.originalLine-$.originalLine,I!==0)||(I=N.originalColumn-$.originalColumn,I!==0)?I:S(N.name,$.name)}n.compareByGeneratedPositionsDeflated=O;function S(N,$){return N===$?0:N===null?1:$===null?-1:N>$?1:-1}function A(N,$){var L=N.generatedLine-$.generatedLine;return L!==0||(L=N.generatedColumn-$.generatedColumn,L!==0)||(L=S(N.source,$.source),L!==0)||(L=N.originalLine-$.originalLine,L!==0)||(L=N.originalColumn-$.originalColumn,L!==0)?L:S(N.name,$.name)}n.compareByGeneratedPositionsInflated=A;function F(N){return JSON.parse(N.replace(/^\)]}'[^\n]*\n/,""))}n.parseSourceMapInput=F;function j(N,$,L){if($=$||"",N&&(N[N.length-1]!=="/"&&$[0]!=="/"&&(N+="/"),$=N+$),L){var I=r(L);if(!I)throw new Error("sourceMapURL could not be parsed");if(I.path){var q=I.path.lastIndexOf("/");q>=0&&(I.path=I.path.substring(0,q+1))}$=o(a(I),$)}return i($)}n.computeSourceURL=j})(KD)),KD}var Fw={},eT;function nZ(){if(eT)return Fw;eT=1;var n=lg(),e=Object.prototype.hasOwnProperty,t=typeof Map<"u";function s(){this._array=[],this._set=t?new Map:Object.create(null)}return s.fromArray=function(r,a){for(var i=new s,o=0,l=r.length;o<l;o++)i.add(r[o],a);return i},s.prototype.size=function(){return t?this._set.size:Object.getOwnPropertyNames(this._set).length},s.prototype.add=function(r,a){var i=t?r:n.toSetString(r),o=t?this.has(r):e.call(this._set,i),l=this._array.length;(!o||a)&&this._array.push(r),o||(t?this._set.set(r,l):this._set[i]=l)},s.prototype.has=function(r){if(t)return this._set.has(r);var a=n.toSetString(r);return e.call(this._set,a)},s.prototype.indexOf=function(r){if(t){var a=this._set.get(r);if(a>=0)return a}else{var i=n.toSetString(r);if(e.call(this._set,i))return this._set[i]}throw new Error('"'+r+'" is not in the set.')},s.prototype.at=function(r){if(r>=0&&r<this._array.length)return this._array[r];throw new Error("No element indexed by "+r)},s.prototype.toArray=function(){return this._array.slice()},Fw.ArraySet=s,Fw}var $w={},tT;function n1e(){if(tT)return $w;tT=1;var n=lg();function e(s,r){var a=s.generatedLine,i=r.generatedLine,o=s.generatedColumn,l=r.generatedColumn;return i>a||i==a&&l>=o||n.compareByGeneratedPositionsInflated(s,r)<=0}function t(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return t.prototype.unsortedForEach=function(s,r){this._array.forEach(s,r)},t.prototype.add=function(s){e(this._last,s)?(this._last=s,this._array.push(s)):(this._sorted=!1,this._array.push(s))},t.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},$w.MappingList=t,$w}var nT;function sZ(){if(nT)return Bw;nT=1;var n=tZ(),e=lg(),t=nZ().ArraySet,s=n1e().MappingList;function r(a){a||(a={}),this._file=e.getArg(a,"file",null),this._sourceRoot=e.getArg(a,"sourceRoot",null),this._skipValidation=e.getArg(a,"skipValidation",!1),this._sources=new t,this._names=new t,this._mappings=new s,this._sourcesContents=null}return r.prototype._version=3,r.fromSourceMap=function(a){var i=a.sourceRoot,o=new r({file:a.file,sourceRoot:i});return a.eachMapping(function(l){var c={generated:{line:l.generatedLine,column:l.generatedColumn}};l.source!=null&&(c.source=l.source,i!=null&&(c.source=e.relative(i,c.source)),c.original={line:l.originalLine,column:l.originalColumn},l.name!=null&&(c.name=l.name)),o.addMapping(c)}),a.sources.forEach(function(l){var c=l;i!==null&&(c=e.relative(i,l)),o._sources.has(c)||o._sources.add(c);var u=a.sourceContentFor(l);u!=null&&o.setSourceContent(l,u)}),o},r.prototype.addMapping=function(a){var i=e.getArg(a,"generated"),o=e.getArg(a,"original",null),l=e.getArg(a,"source",null),c=e.getArg(a,"name",null);this._skipValidation||this._validateMapping(i,o,l,c),l!=null&&(l=String(l),this._sources.has(l)||this._sources.add(l)),c!=null&&(c=String(c),this._names.has(c)||this._names.add(c)),this._mappings.add({generatedLine:i.line,generatedColumn:i.column,originalLine:o!=null&&o.line,originalColumn:o!=null&&o.column,source:l,name:c})},r.prototype.setSourceContent=function(a,i){var o=a;this._sourceRoot!=null&&(o=e.relative(this._sourceRoot,o)),i!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(o)]=i):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(o)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},r.prototype.applySourceMap=function(a,i,o){var l=i;if(i==null){if(a.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);l=a.file}var c=this._sourceRoot;c!=null&&(l=e.relative(c,l));var u=new t,h=new t;this._mappings.unsortedForEach(function(d){if(d.source===l&&d.originalLine!=null){var m=a.originalPositionFor({line:d.originalLine,column:d.originalColumn});m.source!=null&&(d.source=m.source,o!=null&&(d.source=e.join(o,d.source)),c!=null&&(d.source=e.relative(c,d.source)),d.originalLine=m.line,d.originalColumn=m.column,m.name!=null&&(d.name=m.name))}var y=d.source;y!=null&&!u.has(y)&&u.add(y);var O=d.name;O!=null&&!h.has(O)&&h.add(O)},this),this._sources=u,this._names=h,a.sources.forEach(function(d){var m=a.sourceContentFor(d);m!=null&&(o!=null&&(d=e.join(o,d)),c!=null&&(d=e.relative(c,d)),this.setSourceContent(d,m))},this)},r.prototype._validateMapping=function(a,i,o,l){if(i&&typeof i.line!="number"&&typeof i.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(a&&"line"in a&&"column"in a&&a.line>0&&a.column>=0&&!i&&!o&&!l)){if(a&&"line"in a&&"column"in a&&i&&"line"in i&&"column"in i&&a.line>0&&a.column>=0&&i.line>0&&i.column>=0&&o)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:a,source:o,original:i,name:l}))}},r.prototype._serializeMappings=function(){for(var a=0,i=1,o=0,l=0,c=0,u=0,h="",d,m,y,O,S=this._mappings.toArray(),A=0,F=S.length;A<F;A++){if(m=S[A],d="",m.generatedLine!==i)for(a=0;m.generatedLine!==i;)d+=";",i++;else if(A>0){if(!e.compareByGeneratedPositionsInflated(m,S[A-1]))continue;d+=","}d+=n.encode(m.generatedColumn-a),a=m.generatedColumn,m.source!=null&&(O=this._sources.indexOf(m.source),d+=n.encode(O-u),u=O,d+=n.encode(m.originalLine-1-l),l=m.originalLine-1,d+=n.encode(m.originalColumn-o),o=m.originalColumn,m.name!=null&&(y=this._names.indexOf(m.name),d+=n.encode(y-c),c=y)),h+=d}return h},r.prototype._generateSourcesContent=function(a,i){return a.map(function(o){if(!this._sourcesContents)return null;i!=null&&(o=e.relative(i,o));var l=e.toSetString(o);return Object.prototype.hasOwnProperty.call(this._sourcesContents,l)?this._sourcesContents[l]:null},this)},r.prototype.toJSON=function(){var a={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(a.file=this._file),this._sourceRoot!=null&&(a.sourceRoot=this._sourceRoot),this._sourcesContents&&(a.sourcesContent=this._generateSourcesContent(a.sources,a.sourceRoot)),a},r.prototype.toString=function(){return JSON.stringify(this.toJSON())},Bw.SourceMapGenerator=r,Bw}var Zp={},sT={},rT;function s1e(){return rT||(rT=1,(function(n){n.GREATEST_LOWER_BOUND=1,n.LEAST_UPPER_BOUND=2;function e(t,s,r,a,i,o){var l=Math.floor((s-t)/2)+t,c=i(r,a[l],!0);return c===0?l:c>0?s-l>1?e(l,s,r,a,i,o):o==n.LEAST_UPPER_BOUND?s<a.length?s:-1:l:l-t>1?e(t,l,r,a,i,o):o==n.LEAST_UPPER_BOUND?l:t<0?-1:t}n.search=function(t,s,r,a){if(s.length===0)return-1;var i=e(-1,s.length,t,s,r,a||n.GREATEST_LOWER_BOUND);if(i<0)return-1;for(;i-1>=0&&r(s[i],s[i-1],!0)===0;)--i;return i}})(sT)),sT}var Nw={},aT;function r1e(){if(aT)return Nw;aT=1;function n(s,r,a){var i=s[r];s[r]=s[a],s[a]=i}function e(s,r){return Math.round(s+Math.random()*(r-s))}function t(s,r,a,i){if(a<i){var o=e(a,i),l=a-1;n(s,o,i);for(var c=s[i],u=a;u<i;u++)r(s[u],c)<=0&&(l+=1,n(s,l,u));n(s,l+1,u);var h=l+1;t(s,r,a,h-1),t(s,r,h+1,i)}}return Nw.quickSort=function(s,r){t(s,r,0,s.length-1)},Nw}var iT;function a1e(){if(iT)return Zp;iT=1;var n=lg(),e=s1e(),t=nZ().ArraySet,s=tZ(),r=r1e().quickSort;function a(c,u){var h=c;return typeof c=="string"&&(h=n.parseSourceMapInput(c)),h.sections!=null?new l(h,u):new i(h,u)}a.fromSourceMap=function(c,u){return i.fromSourceMap(c,u)},a.prototype._version=3,a.prototype.__generatedMappings=null,Object.defineProperty(a.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),a.prototype.__originalMappings=null,Object.defineProperty(a.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),a.prototype._charIsMappingSeparator=function(c,u){var h=c.charAt(u);return h===";"||h===","},a.prototype._parseMappings=function(c,u){throw new Error("Subclasses must implement _parseMappings")},a.GENERATED_ORDER=1,a.ORIGINAL_ORDER=2,a.GREATEST_LOWER_BOUND=1,a.LEAST_UPPER_BOUND=2,a.prototype.eachMapping=function(c,u,h){var d=u||null,m=h||a.GENERATED_ORDER,y;switch(m){case a.GENERATED_ORDER:y=this._generatedMappings;break;case a.ORIGINAL_ORDER:y=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var O=this.sourceRoot;y.map(function(S){var A=S.source===null?null:this._sources.at(S.source);return A=n.computeSourceURL(O,A,this._sourceMapURL),{source:A,generatedLine:S.generatedLine,generatedColumn:S.generatedColumn,originalLine:S.originalLine,originalColumn:S.originalColumn,name:S.name===null?null:this._names.at(S.name)}},this).forEach(c,d)},a.prototype.allGeneratedPositionsFor=function(c){var u=n.getArg(c,"line"),h={source:n.getArg(c,"source"),originalLine:u,originalColumn:n.getArg(c,"column",0)};if(h.source=this._findSourceIndex(h.source),h.source<0)return[];var d=[],m=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(m>=0){var y=this._originalMappings[m];if(c.column===void 0)for(var O=y.originalLine;y&&y.originalLine===O;)d.push({line:n.getArg(y,"generatedLine",null),column:n.getArg(y,"generatedColumn",null),lastColumn:n.getArg(y,"lastGeneratedColumn",null)}),y=this._originalMappings[++m];else for(var S=y.originalColumn;y&&y.originalLine===u&&y.originalColumn==S;)d.push({line:n.getArg(y,"generatedLine",null),column:n.getArg(y,"generatedColumn",null),lastColumn:n.getArg(y,"lastGeneratedColumn",null)}),y=this._originalMappings[++m]}return d},Zp.SourceMapConsumer=a;function i(c,u){var h=c;typeof c=="string"&&(h=n.parseSourceMapInput(c));var d=n.getArg(h,"version"),m=n.getArg(h,"sources"),y=n.getArg(h,"names",[]),O=n.getArg(h,"sourceRoot",null),S=n.getArg(h,"sourcesContent",null),A=n.getArg(h,"mappings"),F=n.getArg(h,"file",null);if(d!=this._version)throw new Error("Unsupported version: "+d);O&&(O=n.normalize(O)),m=m.map(String).map(n.normalize).map(function(j){return O&&n.isAbsolute(O)&&n.isAbsolute(j)?n.relative(O,j):j}),this._names=t.fromArray(y.map(String),!0),this._sources=t.fromArray(m,!0),this._absoluteSources=this._sources.toArray().map(function(j){return n.computeSourceURL(O,j,u)}),this.sourceRoot=O,this.sourcesContent=S,this._mappings=A,this._sourceMapURL=u,this.file=F}i.prototype=Object.create(a.prototype),i.prototype.consumer=a,i.prototype._findSourceIndex=function(c){var u=c;if(this.sourceRoot!=null&&(u=n.relative(this.sourceRoot,u)),this._sources.has(u))return this._sources.indexOf(u);var h;for(h=0;h<this._absoluteSources.length;++h)if(this._absoluteSources[h]==c)return h;return-1},i.fromSourceMap=function(c,u){var h=Object.create(i.prototype),d=h._names=t.fromArray(c._names.toArray(),!0),m=h._sources=t.fromArray(c._sources.toArray(),!0);h.sourceRoot=c._sourceRoot,h.sourcesContent=c._generateSourcesContent(h._sources.toArray(),h.sourceRoot),h.file=c._file,h._sourceMapURL=u,h._absoluteSources=h._sources.toArray().map(function($){return n.computeSourceURL(h.sourceRoot,$,u)});for(var y=c._mappings.toArray().slice(),O=h.__generatedMappings=[],S=h.__originalMappings=[],A=0,F=y.length;A<F;A++){var j=y[A],N=new o;N.generatedLine=j.generatedLine,N.generatedColumn=j.generatedColumn,j.source&&(N.source=m.indexOf(j.source),N.originalLine=j.originalLine,N.originalColumn=j.originalColumn,j.name&&(N.name=d.indexOf(j.name)),S.push(N)),O.push(N)}return r(h.__originalMappings,n.compareByOriginalPositions),h},i.prototype._version=3,Object.defineProperty(i.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function o(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}i.prototype._parseMappings=function(c,u){for(var h=1,d=0,m=0,y=0,O=0,S=0,A=c.length,F=0,j={},N={},$=[],L=[],I,q,ce,ee,he;F<A;)if(c.charAt(F)===";")h++,F++,d=0;else if(c.charAt(F)===",")F++;else{for(I=new o,I.generatedLine=h,ee=F;ee<A&&!this._charIsMappingSeparator(c,ee);ee++);if(q=c.slice(F,ee),ce=j[q],ce)F+=q.length;else{for(ce=[];F<ee;)s.decode(c,F,N),he=N.value,F=N.rest,ce.push(he);if(ce.length===2)throw new Error("Found a source, but no line and column");if(ce.length===3)throw new Error("Found a source and line, but no column");j[q]=ce}I.generatedColumn=d+ce[0],d=I.generatedColumn,ce.length>1&&(I.source=O+ce[1],O+=ce[1],I.originalLine=m+ce[2],m=I.originalLine,I.originalLine+=1,I.originalColumn=y+ce[3],y=I.originalColumn,ce.length>4&&(I.name=S+ce[4],S+=ce[4])),L.push(I),typeof I.originalLine=="number"&&$.push(I)}r(L,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=L,r($,n.compareByOriginalPositions),this.__originalMappings=$},i.prototype._findMapping=function(c,u,h,d,m,y){if(c[h]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+c[h]);if(c[d]<0)throw new TypeError("Column must be greater than or equal to 0, got "+c[d]);return e.search(c,u,m,y)},i.prototype.computeColumnSpans=function(){for(var c=0;c<this._generatedMappings.length;++c){var u=this._generatedMappings[c];if(c+1<this._generatedMappings.length){var h=this._generatedMappings[c+1];if(u.generatedLine===h.generatedLine){u.lastGeneratedColumn=h.generatedColumn-1;continue}}u.lastGeneratedColumn=1/0}},i.prototype.originalPositionFor=function(c){var u={generatedLine:n.getArg(c,"line"),generatedColumn:n.getArg(c,"column")},h=this._findMapping(u,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(c,"bias",a.GREATEST_LOWER_BOUND));if(h>=0){var d=this._generatedMappings[h];if(d.generatedLine===u.generatedLine){var m=n.getArg(d,"source",null);m!==null&&(m=this._sources.at(m),m=n.computeSourceURL(this.sourceRoot,m,this._sourceMapURL));var y=n.getArg(d,"name",null);return y!==null&&(y=this._names.at(y)),{source:m,line:n.getArg(d,"originalLine",null),column:n.getArg(d,"originalColumn",null),name:y}}}return{source:null,line:null,column:null,name:null}},i.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(c){return c==null}):!1},i.prototype.sourceContentFor=function(c,u){if(!this.sourcesContent)return null;var h=this._findSourceIndex(c);if(h>=0)return this.sourcesContent[h];var d=c;this.sourceRoot!=null&&(d=n.relative(this.sourceRoot,d));var m;if(this.sourceRoot!=null&&(m=n.urlParse(this.sourceRoot))){var y=d.replace(/^file:\/\//,"");if(m.scheme=="file"&&this._sources.has(y))return this.sourcesContent[this._sources.indexOf(y)];if((!m.path||m.path=="/")&&this._sources.has("/"+d))return this.sourcesContent[this._sources.indexOf("/"+d)]}if(u)return null;throw new Error('"'+d+'" is not in the SourceMap.')},i.prototype.generatedPositionFor=function(c){var u=n.getArg(c,"source");if(u=this._findSourceIndex(u),u<0)return{line:null,column:null,lastColumn:null};var h={source:u,originalLine:n.getArg(c,"line"),originalColumn:n.getArg(c,"column")},d=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(c,"bias",a.GREATEST_LOWER_BOUND));if(d>=0){var m=this._originalMappings[d];if(m.source===h.source)return{line:n.getArg(m,"generatedLine",null),column:n.getArg(m,"generatedColumn",null),lastColumn:n.getArg(m,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},Zp.BasicSourceMapConsumer=i;function l(c,u){var h=c;typeof c=="string"&&(h=n.parseSourceMapInput(c));var d=n.getArg(h,"version"),m=n.getArg(h,"sections");if(d!=this._version)throw new Error("Unsupported version: "+d);this._sources=new t,this._names=new t;var y={line:-1,column:0};this._sections=m.map(function(O){if(O.url)throw new Error("Support for url field in sections not implemented.");var S=n.getArg(O,"offset"),A=n.getArg(S,"line"),F=n.getArg(S,"column");if(A<y.line||A===y.line&&F<y.column)throw new Error("Section offsets must be ordered and non-overlapping.");return y=S,{generatedOffset:{generatedLine:A+1,generatedColumn:F+1},consumer:new a(n.getArg(O,"map"),u)}})}return l.prototype=Object.create(a.prototype),l.prototype.constructor=a,l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){for(var c=[],u=0;u<this._sections.length;u++)for(var h=0;h<this._sections[u].consumer.sources.length;h++)c.push(this._sections[u].consumer.sources[h]);return c}}),l.prototype.originalPositionFor=function(c){var u={generatedLine:n.getArg(c,"line"),generatedColumn:n.getArg(c,"column")},h=e.search(u,this._sections,function(m,y){var O=m.generatedLine-y.generatedOffset.generatedLine;return O||m.generatedColumn-y.generatedOffset.generatedColumn}),d=this._sections[h];return d?d.consumer.originalPositionFor({line:u.generatedLine-(d.generatedOffset.generatedLine-1),column:u.generatedColumn-(d.generatedOffset.generatedLine===u.generatedLine?d.generatedOffset.generatedColumn-1:0),bias:c.bias}):{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(c){return c.consumer.hasContentsOfAllSources()})},l.prototype.sourceContentFor=function(c,u){for(var h=0;h<this._sections.length;h++){var d=this._sections[h],m=d.consumer.sourceContentFor(c,!0);if(m)return m}if(u)return null;throw new Error('"'+c+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(c){for(var u=0;u<this._sections.length;u++){var h=this._sections[u];if(h.consumer._findSourceIndex(n.getArg(c,"source"))!==-1){var d=h.consumer.generatedPositionFor(c);if(d){var m={line:d.line+(h.generatedOffset.generatedLine-1),column:d.column+(h.generatedOffset.generatedLine===d.line?h.generatedOffset.generatedColumn-1:0)};return m}}}return{line:null,column:null}},l.prototype._parseMappings=function(c,u){this.__generatedMappings=[],this.__originalMappings=[];for(var h=0;h<this._sections.length;h++)for(var d=this._sections[h],m=d.consumer._generatedMappings,y=0;y<m.length;y++){var O=m[y],S=d.consumer._sources.at(O.source);S=n.computeSourceURL(d.consumer.sourceRoot,S,this._sourceMapURL),this._sources.add(S),S=this._sources.indexOf(S);var A=null;O.name&&(A=d.consumer._names.at(O.name),this._names.add(A),A=this._names.indexOf(A));var F={source:S,generatedLine:O.generatedLine+(d.generatedOffset.generatedLine-1),generatedColumn:O.generatedColumn+(d.generatedOffset.generatedLine===O.generatedLine?d.generatedOffset.generatedColumn-1:0),originalLine:O.originalLine,originalColumn:O.originalColumn,name:A};this.__generatedMappings.push(F),typeof F.originalLine=="number"&&this.__originalMappings.push(F)}r(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),r(this.__originalMappings,n.compareByOriginalPositions)},Zp.IndexedSourceMapConsumer=l,Zp}var _w={},oT;function i1e(){if(oT)return _w;oT=1;var n=sZ().SourceMapGenerator,e=lg(),t=/(\r?\n)/,s=10,r="$$$isSourceNode$$$";function a(i,o,l,c,u){this.children=[],this.sourceContents={},this.line=i??null,this.column=o??null,this.source=l??null,this.name=u??null,this[r]=!0,c!=null&&this.add(c)}return a.fromStringWithSourceMap=function(i,o,l){var c=new a,u=i.split(t),h=0,d=function(){var A=j(),F=j()||"";return A+F;function j(){return h<u.length?u[h++]:void 0}},m=1,y=0,O=null;return o.eachMapping(function(A){if(O!==null)if(m<A.generatedLine)S(O,d()),m++,y=0;else{var F=u[h]||"",j=F.substr(0,A.generatedColumn-y);u[h]=F.substr(A.generatedColumn-y),y=A.generatedColumn,S(O,j),O=A;return}for(;m<A.generatedLine;)c.add(d()),m++;if(y<A.generatedColumn){var F=u[h]||"";c.add(F.substr(0,A.generatedColumn)),u[h]=F.substr(A.generatedColumn),y=A.generatedColumn}O=A},this),h<u.length&&(O&&S(O,d()),c.add(u.splice(h).join(""))),o.sources.forEach(function(A){var F=o.sourceContentFor(A);F!=null&&(l!=null&&(A=e.join(l,A)),c.setSourceContent(A,F))}),c;function S(A,F){if(A===null||A.source===void 0)c.add(F);else{var j=l?e.join(l,A.source):A.source;c.add(new a(A.originalLine,A.originalColumn,j,F,A.name))}}},a.prototype.add=function(i){if(Array.isArray(i))i.forEach(function(o){this.add(o)},this);else if(i[r]||typeof i=="string")i&&this.children.push(i);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+i);return this},a.prototype.prepend=function(i){if(Array.isArray(i))for(var o=i.length-1;o>=0;o--)this.prepend(i[o]);else if(i[r]||typeof i=="string")this.children.unshift(i);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+i);return this},a.prototype.walk=function(i){for(var o,l=0,c=this.children.length;l<c;l++)o=this.children[l],o[r]?o.walk(i):o!==""&&i(o,{source:this.source,line:this.line,column:this.column,name:this.name})},a.prototype.join=function(i){var o,l,c=this.children.length;if(c>0){for(o=[],l=0;l<c-1;l++)o.push(this.children[l]),o.push(i);o.push(this.children[l]),this.children=o}return this},a.prototype.replaceRight=function(i,o){var l=this.children[this.children.length-1];return l[r]?l.replaceRight(i,o):typeof l=="string"?this.children[this.children.length-1]=l.replace(i,o):this.children.push("".replace(i,o)),this},a.prototype.setSourceContent=function(i,o){this.sourceContents[e.toSetString(i)]=o},a.prototype.walkSourceContents=function(i){for(var o=0,l=this.children.length;o<l;o++)this.children[o][r]&&this.children[o].walkSourceContents(i);for(var c=Object.keys(this.sourceContents),o=0,l=c.length;o<l;o++)i(e.fromSetString(c[o]),this.sourceContents[c[o]])},a.prototype.toString=function(){var i="";return this.walk(function(o){i+=o}),i},a.prototype.toStringWithSourceMap=function(i){var o={code:"",line:1,column:0},l=new n(i),c=!1,u=null,h=null,d=null,m=null;return this.walk(function(y,O){o.code+=y,O.source!==null&&O.line!==null&&O.column!==null?((u!==O.source||h!==O.line||d!==O.column||m!==O.name)&&l.addMapping({source:O.source,original:{line:O.line,column:O.column},generated:{line:o.line,column:o.column},name:O.name}),u=O.source,h=O.line,d=O.column,m=O.name,c=!0):c&&(l.addMapping({generated:{line:o.line,column:o.column}}),u=null,c=!1);for(var S=0,A=y.length;S<A;S++)y.charCodeAt(S)===s?(o.line++,o.column=0,S+1===A?(u=null,c=!1):c&&l.addMapping({source:O.source,original:{line:O.line,column:O.column},generated:{line:o.line,column:o.column},name:O.name})):o.column++}),this.walkSourceContents(function(y,O){l.setSourceContent(y,O)}),{code:o.code,map:l}},_w.SourceNode=a,_w}var lT;function o1e(){return lT||(lT=1,Hg.SourceMapGenerator=sZ().SourceMapGenerator,Hg.SourceMapConsumer=a1e().SourceMapConsumer,Hg.SourceNode=i1e().SourceNode),Hg}const l1e="2.1.0",c1e={version:l1e};var cT;function u1e(){return cT||(cT=1,(function(n){(function(){var e,t,s,r,a,i,o,l,c,u,h,d,m,y,O,S,A,F,j,N,$,L,I,q,ce,ee;a=Yye(),i=e1e(),e=a.Syntax;function he(w){return st.Expression.hasOwnProperty(w.type)}function H(w){return st.Statement.hasOwnProperty(w.type)}t={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},s={"??":t.Coalesce,"||":t.LogicalOR,"&&":t.LogicalAND,"|":t.BitwiseOR,"^":t.BitwiseXOR,"&":t.BitwiseAND,"==":t.Equality,"!=":t.Equality,"===":t.Equality,"!==":t.Equality,is:t.Equality,isnt:t.Equality,"<":t.Relational,">":t.Relational,"<=":t.Relational,">=":t.Relational,in:t.Relational,instanceof:t.Relational,"<<":t.BitwiseSHIFT,">>":t.BitwiseSHIFT,">>>":t.BitwiseSHIFT,"+":t.Additive,"-":t.Additive,"*":t.Multiplicative,"%":t.Multiplicative,"/":t.Multiplicative,"**":t.Exponentiation};var me=1,Oe=2,Pe=4,De=8,Se=16,ae=32,Ee=64,Qe=Oe|Pe,Ke=me|Oe,ge=me|Oe|Pe,Ye=me,yt=Pe,Xe=me|Pe,Ge=me,Ct=me|ae,Et=0,gn=me|Se,On=me|De;function qn(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function cn(w,_){var B="";for(_|=0;_>0;_>>>=1,w+=w)_&1&&(B+=w);return B}function un(w){return/[\r\n]/g.test(w)}function Rt(w){var _=w.length;return _&&i.code.isLineTerminator(w.charCodeAt(_-1))}function Kt(w,_){var B;for(B in _)_.hasOwnProperty(B)&&(w[B]=_[B]);return w}function Un(w,_){var B,R;function Z(Y){return typeof Y=="object"&&Y instanceof Object&&!(Y instanceof RegExp)}for(B in _)_.hasOwnProperty(B)&&(R=_[B],Z(R)?Z(w[B])?Un(w[B],R):w[B]=Un({},R):w[B]=R);return w}function Wn(w){var _,B,R,Z,Y;if(w!==w)throw new Error("Numeric literal whose value is NaN");if(w<0||w===0&&1/w<0)throw new Error("Numeric literal whose value is negative");if(w===1/0)return c?"null":u?"1e400":"1e+400";if(_=""+w,!u||_.length<3)return _;for(B=_.indexOf("."),!c&&_.charCodeAt(0)===48&&B===1&&(B=0,_=_.slice(1)),R=_,_=_.replace("e+","e"),Z=0,(Y=R.indexOf("e"))>0&&(Z=+R.slice(Y+1),R=R.slice(0,Y)),B>=0&&(Z-=R.length-B-1,R=+(R.slice(0,B)+R.slice(B+1))+""),Y=0;R.charCodeAt(R.length+Y-1)===48;)--Y;return Y!==0&&(Z-=Y,R=R.slice(0,Y)),Z!==0&&(R+="e"+Z),(R.length<_.length||h&&w>1e12&&Math.floor(w)===w&&(R="0x"+w.toString(16)).length<_.length)&&+R===w&&(_=R),_}function bn(w,_){return(w&-2)===8232?(_?"u":"\\u")+(w===8232?"2028":"2029"):w===10||w===13?(_?"":"\\")+(w===10?"n":"r"):String.fromCharCode(w)}function rt(w){var _,B,R,Z,Y,se,te,be;if(B=w.toString(),w.source){if(_=B.match(/\/([^/]*)$/),!_)return B;for(R=_[1],B="",te=!1,be=!1,Z=0,Y=w.source.length;Z<Y;++Z)se=w.source.charCodeAt(Z),be?(B+=bn(se,be),be=!1):(te?se===93&&(te=!1):se===47?B+="\\":se===91&&(te=!0),B+=bn(se,be),be=se===92);return"/"+B+"/"+R}return B}function Pn(w,_){var B;return w===8?"\\b":w===12?"\\f":w===9?"\\t":(B=w.toString(16).toUpperCase(),c||w>255?"\\u"+"0000".slice(B.length)+B:w===0&&!i.code.isDecimalDigit(_)?"\\0":w===11?"\\x0B":"\\x"+"00".slice(B.length)+B)}function pt(w){if(w===92)return"\\\\";if(w===10)return"\\n";if(w===13)return"\\r";if(w===8232)return"\\u2028";if(w===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function Vt(w){var _,B,R,Z;for(Z=d==="double"?'"':"'",_=0,B=w.length;_<B;++_)if(R=w.charCodeAt(_),R===39){Z='"';break}else if(R===34){Z="'";break}else R===92&&++_;return Z+w+Z}function Zt(w){var _="",B,R,Z,Y=0,se=0,te,be;for(B=0,R=w.length;B<R;++B){if(Z=w.charCodeAt(B),Z===39)++Y;else if(Z===34)++se;else if(Z===47&&c)_+="\\";else if(i.code.isLineTerminator(Z)||Z===92){_+=pt(Z);continue}else if(!i.code.isIdentifierPartES5(Z)&&(c&&Z<32||!c&&!m&&(Z<32||Z>126))){_+=Pn(Z,w.charCodeAt(B+1));continue}_+=String.fromCharCode(Z)}if(te=!(d==="double"||d==="auto"&&se<Y),be=te?"'":'"',!(te?Y:se))return be+_+be;for(w=_,_=be,B=0,R=w.length;B<R;++B)Z=w.charCodeAt(B),(Z===39&&te||Z===34&&!te)&&(_+="\\"),_+=String.fromCharCode(Z);return _+be}function _n(w){var _,B,R,Z="";for(_=0,B=w.length;_<B;++_)R=w[_],Z+=Array.isArray(R)?_n(R):R;return Z}function it(w,_){if(!L)return Array.isArray(w)?_n(w):w;if(_==null){if(w instanceof r)return w;_={}}return _.loc==null?new r(null,null,L,w,_.name||null):new r(_.loc.start.line,_.loc.start.column,L===!0?_.loc.source||null:L,w,_.name||null)}function Ft(){return O||" "}function _e(w,_){var B,R,Z,Y;return B=it(w).toString(),B.length===0?[_]:(R=it(_).toString(),R.length===0?[w]:(Z=B.charCodeAt(B.length-1),Y=R.charCodeAt(0),(Z===43||Z===45)&&Z===Y||i.code.isIdentifierPartES5(Z)&&i.code.isIdentifierPartES5(Y)||Z===47&&Y===105?[w,Ft(),_]:i.code.isWhiteSpace(Z)||i.code.isLineTerminator(Z)||i.code.isWhiteSpace(Y)||i.code.isLineTerminator(Y)?[w,_]:[w,O,_]))}function Lt(w){return[o,w]}function et(w){var _;_=o,o+=l,w(o),o=_}function is(w){var _;for(_=w.length-1;_>=0&&!i.code.isLineTerminator(w.charCodeAt(_));--_);return w.length-1-_}function It(w,_){var B,R,Z,Y,se,te,be,$e;for(B=w.split(/\r\n|[\r\n]/),te=Number.MAX_VALUE,R=1,Z=B.length;R<Z;++R){for(Y=B[R],se=0;se<Y.length&&i.code.isWhiteSpace(Y.charCodeAt(se));)++se;te>se&&(te=se)}for(typeof _<"u"?(be=o,B[1][te]==="*"&&(_+=" "),o=_):(te&1&&--te,be=o),R=1,Z=B.length;R<Z;++R)$e=it(Lt(B[R].slice(te))),B[R]=L?$e.join(""):$e;return o=be,B.join(`
`)}function Dn(w,_){if(w.type==="Line"){if(Rt(w.value))return"//"+w.value;var B="//"+w.value;return q||(B+=`
`),B}return N.format.indent.adjustMultilineComment&&/[\n\r]/.test(w.value)?It("/*"+w.value+"*/",_):"/*"+w.value+"*/"}function Cs(w,_){var B,R,Z,Y,se,te,be,$e,Re,ut,on,Yn,Is,mn;if(w.leadingComments&&w.leadingComments.length>0){if(Y=_,q){for(Z=w.leadingComments[0],_=[],$e=Z.extendedRange,Re=Z.range,on=I.substring($e[0],Re[0]),mn=(on.match(/\n/g)||[]).length,mn>0?(_.push(cn(`
`,mn)),_.push(Lt(Dn(Z)))):(_.push(on),_.push(Dn(Z))),ut=Re,B=1,R=w.leadingComments.length;B<R;B++)Z=w.leadingComments[B],Re=Z.range,Yn=I.substring(ut[1],Re[0]),mn=(Yn.match(/\n/g)||[]).length,_.push(cn(`
`,mn)),_.push(Lt(Dn(Z))),ut=Re;Is=I.substring(Re[1],$e[1]),mn=(Is.match(/\n/g)||[]).length,_.push(cn(`
`,mn))}else for(Z=w.leadingComments[0],_=[],F&&w.type===e.Program&&w.body.length===0&&_.push(`
`),_.push(Dn(Z)),Rt(it(_).toString())||_.push(`
`),B=1,R=w.leadingComments.length;B<R;++B)Z=w.leadingComments[B],be=[Dn(Z)],Rt(it(be).toString())||be.push(`
`),_.push(Lt(be));_.push(Lt(Y))}if(w.trailingComments)if(q)Z=w.trailingComments[0],$e=Z.extendedRange,Re=Z.range,on=I.substring($e[0],Re[0]),mn=(on.match(/\n/g)||[]).length,mn>0?(_.push(cn(`
`,mn)),_.push(Lt(Dn(Z)))):(_.push(on),_.push(Dn(Z)));else for(se=!Rt(it(_).toString()),te=cn(" ",is(it([o,_,l]).toString())),B=0,R=w.trailingComments.length;B<R;++B)Z=w.trailingComments[B],se?(B===0?_=[_,l]:_=[_,te],_.push(Dn(Z,te))):_=[_,Lt(Dn(Z))],B!==R-1&&!Rt(it(_).toString())&&(_=[_,`
`]);return _}function Wt(w,_,B){var R,Z=0;for(R=w;R<_;R++)I[R]===`
`&&Z++;for(R=1;R<Z;R++)B.push(y)}function Pt(w,_,B){return _<B?["(",w,")"]:w}function $t(w){var _,B,R;for(R=w.split(/\r\n|\n/),_=1,B=R.length;_<B;_++)R[_]=y+o+R[_];return R}function xn(w,_){var B,R,Z;return B=w[N.verbatim],typeof B=="string"?R=Pt($t(B),t.Sequence,_):(R=$t(B.content),Z=B.precedence!=null?B.precedence:t.Sequence,R=Pt(R,Z,_)),it(R,w)}function st(){}st.prototype.maybeBlock=function(w,_){var B,R,Z=this;return R=!N.comment||!w.leadingComments,w.type===e.BlockStatement&&R?[O,this.generateStatement(w,_)]:w.type===e.EmptyStatement&&R?";":(et(function(){B=[y,Lt(Z.generateStatement(w,_))]}),B)},st.prototype.maybeBlockSuffix=function(w,_){var B=Rt(it(_).toString());return w.type===e.BlockStatement&&(!N.comment||!w.leadingComments)&&!B?[_,O]:B?[_,o]:[_,y,o]};function Gt(w){return it(w.name,w)}function an(w,_){return w.async?"async"+(_?Ft():O):""}function vs(w){var _=w.generator&&!N.moz.starlessGenerator;return _?"*"+O:""}function Vn(w){var _=w.value,B="";return _.async&&(B+=an(_,!w.computed)),_.generator&&(B+=vs(_)?"*":""),B}st.prototype.generatePattern=function(w,_,B){return w.type===e.Identifier?Gt(w):this.generateExpression(w,_,B)},st.prototype.generateFunctionParams=function(w){var _,B,R,Z;if(Z=!1,w.type===e.ArrowFunctionExpression&&!w.rest&&(!w.defaults||w.defaults.length===0)&&w.params.length===1&&w.params[0].type===e.Identifier)R=[an(w,!0),Gt(w.params[0])];else{for(R=w.type===e.ArrowFunctionExpression?[an(w,!1)]:[],R.push("("),w.defaults&&(Z=!0),_=0,B=w.params.length;_<B;++_)Z&&w.defaults[_]?R.push(this.generateAssignment(w.params[_],w.defaults[_],"=",t.Assignment,ge)):R.push(this.generatePattern(w.params[_],t.Assignment,ge)),_+1<B&&R.push(","+O);w.rest&&(w.params.length&&R.push(","+O),R.push("..."),R.push(Gt(w.rest))),R.push(")")}return R},st.prototype.generateFunctionBody=function(w){var _,B;return _=this.generateFunctionParams(w),w.type===e.ArrowFunctionExpression&&(_.push(O),_.push("=>")),w.expression?(_.push(O),B=this.generateExpression(w.body,t.Assignment,ge),B.toString().charAt(0)==="{"&&(B=["(",B,")"]),_.push(B)):_.push(this.maybeBlock(w.body,On)),_},st.prototype.generateIterationForStatement=function(w,_,B){var R=["for"+(_.await?Ft()+"await":"")+O+"("],Z=this;return et(function(){_.left.type===e.VariableDeclaration?et(function(){R.push(_.left.kind+Ft()),R.push(Z.generateStatement(_.left.declarations[0],Et))}):R.push(Z.generateExpression(_.left,t.Call,ge)),R=_e(R,w),R=[_e(R,Z.generateExpression(_.right,t.Assignment,ge)),")"]}),R.push(this.maybeBlock(_.body,B)),R},st.prototype.generatePropertyKey=function(w,_){var B=[];return _&&B.push("["),B.push(this.generateExpression(w,t.Assignment,ge)),_&&B.push("]"),B},st.prototype.generateAssignment=function(w,_,B,R,Z){return t.Assignment<R&&(Z|=me),Pt([this.generateExpression(w,t.Call,Z),O+B+O,this.generateExpression(_,t.Assignment,Z)],t.Assignment,R)},st.prototype.semicolon=function(w){return!A&&w&ae?"":";"},st.Statement={BlockStatement:function(w,_){var B,R,Z=["{",y],Y=this;return et(function(){w.body.length===0&&q&&(B=w.range,B[1]-B[0]>2&&(R=I.substring(B[0]+1,B[1]-1),R[0]===`
`&&(Z=["{"]),Z.push(R)));var se,te,be,$e;for($e=Ge,_&De&&($e|=Se),se=0,te=w.body.length;se<te;++se)q&&(se===0&&(w.body[0].leadingComments&&(B=w.body[0].leadingComments[0].extendedRange,R=I.substring(B[0],B[1]),R[0]===`
`&&(Z=["{"])),w.body[0].leadingComments||Wt(w.range[0],w.body[0].range[0],Z)),se>0&&!w.body[se-1].trailingComments&&!w.body[se].leadingComments&&Wt(w.body[se-1].range[1],w.body[se].range[0],Z)),se===te-1&&($e|=ae),w.body[se].leadingComments&&q?be=Y.generateStatement(w.body[se],$e):be=Lt(Y.generateStatement(w.body[se],$e)),Z.push(be),Rt(it(be).toString())||q&&se<te-1&&w.body[se+1].leadingComments||Z.push(y),q&&se===te-1&&(w.body[se].trailingComments||Wt(w.body[se].range[1],w.range[1],Z))}),Z.push(Lt("}")),Z},BreakStatement:function(w,_){return w.label?"break "+w.label.name+this.semicolon(_):"break"+this.semicolon(_)},ContinueStatement:function(w,_){return w.label?"continue "+w.label.name+this.semicolon(_):"continue"+this.semicolon(_)},ClassBody:function(w,_){var B=["{",y],R=this;return et(function(Z){var Y,se;for(Y=0,se=w.body.length;Y<se;++Y)B.push(Z),B.push(R.generateExpression(w.body[Y],t.Sequence,ge)),Y+1<se&&B.push(y)}),Rt(it(B).toString())||B.push(y),B.push(o),B.push("}"),B},ClassDeclaration:function(w,_){var B,R;return B=["class"],w.id&&(B=_e(B,this.generateExpression(w.id,t.Sequence,ge))),w.superClass&&(R=_e("extends",this.generateExpression(w.superClass,t.Unary,ge)),B=_e(B,R)),B.push(O),B.push(this.generateStatement(w.body,Ct)),B},DirectiveStatement:function(w,_){return N.raw&&w.raw?w.raw+this.semicolon(_):Vt(w.directive)+this.semicolon(_)},DoWhileStatement:function(w,_){var B=_e("do",this.maybeBlock(w.body,Ge));return B=this.maybeBlockSuffix(w.body,B),_e(B,["while"+O+"(",this.generateExpression(w.test,t.Sequence,ge),")"+this.semicolon(_)])},CatchClause:function(w,_){var B,R=this;return et(function(){var Z;w.param?(B=["catch"+O+"(",R.generateExpression(w.param,t.Sequence,ge),")"],w.guard&&(Z=R.generateExpression(w.guard,t.Sequence,ge),B.splice(2,0," if ",Z))):B=["catch"]}),B.push(this.maybeBlock(w.body,Ge)),B},DebuggerStatement:function(w,_){return"debugger"+this.semicolon(_)},EmptyStatement:function(w,_){return";"},ExportDefaultDeclaration:function(w,_){var B=["export"],R;return R=_&ae?Ct:Ge,B=_e(B,"default"),H(w.declaration)?B=_e(B,this.generateStatement(w.declaration,R)):B=_e(B,this.generateExpression(w.declaration,t.Assignment,ge)+this.semicolon(_)),B},ExportNamedDeclaration:function(w,_){var B=["export"],R,Z=this;return R=_&ae?Ct:Ge,w.declaration?_e(B,this.generateStatement(w.declaration,R)):(w.specifiers&&(w.specifiers.length===0?B=_e(B,"{"+O+"}"):w.specifiers[0].type===e.ExportBatchSpecifier?B=_e(B,this.generateExpression(w.specifiers[0],t.Sequence,ge)):(B=_e(B,"{"),et(function(Y){var se,te;for(B.push(y),se=0,te=w.specifiers.length;se<te;++se)B.push(Y),B.push(Z.generateExpression(w.specifiers[se],t.Sequence,ge)),se+1<te&&B.push(","+y)}),Rt(it(B).toString())||B.push(y),B.push(o+"}")),w.source?B=_e(B,["from"+O,this.generateExpression(w.source,t.Sequence,ge),this.semicolon(_)]):B.push(this.semicolon(_))),B)},ExportAllDeclaration:function(w,_){return["export"+O,"*"+O,"from"+O,this.generateExpression(w.source,t.Sequence,ge),this.semicolon(_)]},ExpressionStatement:function(w,_){var B,R;function Z(te){var be;return te.slice(0,5)!=="class"?!1:(be=te.charCodeAt(5),be===123||i.code.isWhiteSpace(be)||i.code.isLineTerminator(be))}function Y(te){var be;return te.slice(0,8)!=="function"?!1:(be=te.charCodeAt(8),be===40||i.code.isWhiteSpace(be)||be===42||i.code.isLineTerminator(be))}function se(te){var be,$e,Re;if(te.slice(0,5)!=="async"||!i.code.isWhiteSpace(te.charCodeAt(5)))return!1;for($e=6,Re=te.length;$e<Re&&i.code.isWhiteSpace(te.charCodeAt($e));++$e);return $e===Re||te.slice($e,$e+8)!=="function"?!1:(be=te.charCodeAt($e+8),be===40||i.code.isWhiteSpace(be)||be===42||i.code.isLineTerminator(be))}return B=[this.generateExpression(w.expression,t.Sequence,ge)],R=it(B).toString(),R.charCodeAt(0)===123||Z(R)||Y(R)||se(R)||j&&_&Se&&w.expression.type===e.Literal&&typeof w.expression.value=="string"?B=["(",B,")"+this.semicolon(_)]:B.push(this.semicolon(_)),B},ImportDeclaration:function(w,_){var B,R,Z=this;return w.specifiers.length===0?["import",O,this.generateExpression(w.source,t.Sequence,ge),this.semicolon(_)]:(B=["import"],R=0,w.specifiers[R].type===e.ImportDefaultSpecifier&&(B=_e(B,[this.generateExpression(w.specifiers[R],t.Sequence,ge)]),++R),w.specifiers[R]&&(R!==0&&B.push(","),w.specifiers[R].type===e.ImportNamespaceSpecifier?B=_e(B,[O,this.generateExpression(w.specifiers[R],t.Sequence,ge)]):(B.push(O+"{"),w.specifiers.length-R===1?(B.push(O),B.push(this.generateExpression(w.specifiers[R],t.Sequence,ge)),B.push(O+"}"+O)):(et(function(Y){var se,te;for(B.push(y),se=R,te=w.specifiers.length;se<te;++se)B.push(Y),B.push(Z.generateExpression(w.specifiers[se],t.Sequence,ge)),se+1<te&&B.push(","+y)}),Rt(it(B).toString())||B.push(y),B.push(o+"}"+O)))),B=_e(B,["from"+O,this.generateExpression(w.source,t.Sequence,ge),this.semicolon(_)]),B)},VariableDeclarator:function(w,_){var B=_&me?ge:Qe;return w.init?[this.generateExpression(w.id,t.Assignment,B),O,"=",O,this.generateExpression(w.init,t.Assignment,B)]:this.generatePattern(w.id,t.Assignment,B)},VariableDeclaration:function(w,_){var B,R,Z,Y,se,te=this;B=[w.kind],se=_&me?Ge:Et;function be(){for(Y=w.declarations[0],N.comment&&Y.leadingComments?(B.push(`
`),B.push(Lt(te.generateStatement(Y,se)))):(B.push(Ft()),B.push(te.generateStatement(Y,se))),R=1,Z=w.declarations.length;R<Z;++R)Y=w.declarations[R],N.comment&&Y.leadingComments?(B.push(","+y),B.push(Lt(te.generateStatement(Y,se)))):(B.push(","+O),B.push(te.generateStatement(Y,se)))}return w.declarations.length>1?et(be):be(),B.push(this.semicolon(_)),B},ThrowStatement:function(w,_){return[_e("throw",this.generateExpression(w.argument,t.Sequence,ge)),this.semicolon(_)]},TryStatement:function(w,_){var B,R,Z,Y;if(B=["try",this.maybeBlock(w.block,Ge)],B=this.maybeBlockSuffix(w.block,B),w.handlers)for(R=0,Z=w.handlers.length;R<Z;++R)B=_e(B,this.generateStatement(w.handlers[R],Ge)),(w.finalizer||R+1!==Z)&&(B=this.maybeBlockSuffix(w.handlers[R].body,B));else{for(Y=w.guardedHandlers||[],R=0,Z=Y.length;R<Z;++R)B=_e(B,this.generateStatement(Y[R],Ge)),(w.finalizer||R+1!==Z)&&(B=this.maybeBlockSuffix(Y[R].body,B));if(w.handler)if(Array.isArray(w.handler))for(R=0,Z=w.handler.length;R<Z;++R)B=_e(B,this.generateStatement(w.handler[R],Ge)),(w.finalizer||R+1!==Z)&&(B=this.maybeBlockSuffix(w.handler[R].body,B));else B=_e(B,this.generateStatement(w.handler,Ge)),w.finalizer&&(B=this.maybeBlockSuffix(w.handler.body,B))}return w.finalizer&&(B=_e(B,["finally",this.maybeBlock(w.finalizer,Ge)])),B},SwitchStatement:function(w,_){var B,R,Z,Y,se,te=this;if(et(function(){B=["switch"+O+"(",te.generateExpression(w.discriminant,t.Sequence,ge),")"+O+"{"+y]}),w.cases)for(se=Ge,Z=0,Y=w.cases.length;Z<Y;++Z)Z===Y-1&&(se|=ae),R=Lt(this.generateStatement(w.cases[Z],se)),B.push(R),Rt(it(R).toString())||B.push(y);return B.push(Lt("}")),B},SwitchCase:function(w,_){var B,R,Z,Y,se,te=this;return et(function(){for(w.test?B=[_e("case",te.generateExpression(w.test,t.Sequence,ge)),":"]:B=["default:"],Z=0,Y=w.consequent.length,Y&&w.consequent[0].type===e.BlockStatement&&(R=te.maybeBlock(w.consequent[0],Ge),B.push(R),Z=1),Z!==Y&&!Rt(it(B).toString())&&B.push(y),se=Ge;Z<Y;++Z)Z===Y-1&&_&ae&&(se|=ae),R=Lt(te.generateStatement(w.consequent[Z],se)),B.push(R),Z+1!==Y&&!Rt(it(R).toString())&&B.push(y)}),B},IfStatement:function(w,_){var B,R,Z,Y=this;return et(function(){B=["if"+O+"(",Y.generateExpression(w.test,t.Sequence,ge),")"]}),Z=_&ae,R=Ge,Z&&(R|=ae),w.alternate?(B.push(this.maybeBlock(w.consequent,Ge)),B=this.maybeBlockSuffix(w.consequent,B),w.alternate.type===e.IfStatement?B=_e(B,["else ",this.generateStatement(w.alternate,R)]):B=_e(B,_e("else",this.maybeBlock(w.alternate,R)))):B.push(this.maybeBlock(w.consequent,R)),B},ForStatement:function(w,_){var B,R=this;return et(function(){B=["for"+O+"("],w.init?w.init.type===e.VariableDeclaration?B.push(R.generateStatement(w.init,Et)):(B.push(R.generateExpression(w.init,t.Sequence,Qe)),B.push(";")):B.push(";"),w.test&&(B.push(O),B.push(R.generateExpression(w.test,t.Sequence,ge))),B.push(";"),w.update&&(B.push(O),B.push(R.generateExpression(w.update,t.Sequence,ge))),B.push(")")}),B.push(this.maybeBlock(w.body,_&ae?Ct:Ge)),B},ForInStatement:function(w,_){return this.generateIterationForStatement("in",w,_&ae?Ct:Ge)},ForOfStatement:function(w,_){return this.generateIterationForStatement("of",w,_&ae?Ct:Ge)},LabeledStatement:function(w,_){return[w.label.name+":",this.maybeBlock(w.body,_&ae?Ct:Ge)]},Program:function(w,_){var B,R,Z,Y,se;for(Y=w.body.length,B=[F&&Y>0?`
`:""],se=gn,Z=0;Z<Y;++Z)!F&&Z===Y-1&&(se|=ae),q&&(Z===0&&(w.body[0].leadingComments||Wt(w.range[0],w.body[Z].range[0],B)),Z>0&&!w.body[Z-1].trailingComments&&!w.body[Z].leadingComments&&Wt(w.body[Z-1].range[1],w.body[Z].range[0],B)),R=Lt(this.generateStatement(w.body[Z],se)),B.push(R),Z+1<Y&&!Rt(it(R).toString())&&(q&&w.body[Z+1].leadingComments||B.push(y)),q&&Z===Y-1&&(w.body[Z].trailingComments||Wt(w.body[Z].range[1],w.range[1],B));return B},FunctionDeclaration:function(w,_){return[an(w,!0),"function",vs(w)||Ft(),w.id?Gt(w.id):"",this.generateFunctionBody(w)]},ReturnStatement:function(w,_){return w.argument?[_e("return",this.generateExpression(w.argument,t.Sequence,ge)),this.semicolon(_)]:["return"+this.semicolon(_)]},WhileStatement:function(w,_){var B,R=this;return et(function(){B=["while"+O+"(",R.generateExpression(w.test,t.Sequence,ge),")"]}),B.push(this.maybeBlock(w.body,_&ae?Ct:Ge)),B},WithStatement:function(w,_){var B,R=this;return et(function(){B=["with"+O+"(",R.generateExpression(w.object,t.Sequence,ge),")"]}),B.push(this.maybeBlock(w.body,_&ae?Ct:Ge)),B}},Kt(st.prototype,st.Statement),st.Expression={SequenceExpression:function(w,_,B){var R,Z,Y;for(t.Sequence<_&&(B|=me),R=[],Z=0,Y=w.expressions.length;Z<Y;++Z)R.push(this.generateExpression(w.expressions[Z],t.Assignment,B)),Z+1<Y&&R.push(","+O);return Pt(R,t.Sequence,_)},AssignmentExpression:function(w,_,B){return this.generateAssignment(w.left,w.right,w.operator,_,B)},ArrowFunctionExpression:function(w,_,B){return Pt(this.generateFunctionBody(w),t.ArrowFunction,_)},ConditionalExpression:function(w,_,B){return t.Conditional<_&&(B|=me),Pt([this.generateExpression(w.test,t.Coalesce,B),O+"?"+O,this.generateExpression(w.consequent,t.Assignment,B),O+":"+O,this.generateExpression(w.alternate,t.Assignment,B)],t.Conditional,_)},LogicalExpression:function(w,_,B){return w.operator==="??"&&(B|=Ee),this.BinaryExpression(w,_,B)},BinaryExpression:function(w,_,B){var R,Z,Y,se,te,be;return se=s[w.operator],Z=w.operator==="**"?t.Postfix:se,Y=w.operator==="**"?se:se+1,se<_&&(B|=me),te=this.generateExpression(w.left,Z,B),be=te.toString(),be.charCodeAt(be.length-1)===47&&i.code.isIdentifierPartES5(w.operator.charCodeAt(0))?R=[te,Ft(),w.operator]:R=_e(te,w.operator),te=this.generateExpression(w.right,Y,B),w.operator==="/"&&te.toString().charAt(0)==="/"||w.operator.slice(-1)==="<"&&te.toString().slice(0,3)==="!--"?(R.push(Ft()),R.push(te)):R=_e(R,te),w.operator==="in"&&!(B&me)?["(",R,")"]:(w.operator==="||"||w.operator==="&&")&&B&Ee?["(",R,")"]:Pt(R,se,_)},CallExpression:function(w,_,B){var R,Z,Y;for(R=[this.generateExpression(w.callee,t.Call,Ke)],w.optional&&R.push("?."),R.push("("),Z=0,Y=w.arguments.length;Z<Y;++Z)R.push(this.generateExpression(w.arguments[Z],t.Assignment,ge)),Z+1<Y&&R.push(","+O);return R.push(")"),B&Oe?Pt(R,t.Call,_):["(",R,")"]},ChainExpression:function(w,_,B){t.OptionalChaining<_&&(B|=Oe);var R=this.generateExpression(w.expression,t.OptionalChaining,B);return Pt(R,t.OptionalChaining,_)},NewExpression:function(w,_,B){var R,Z,Y,se,te;if(Z=w.arguments.length,te=B&Pe&&!S&&Z===0?Xe:Ye,R=_e("new",this.generateExpression(w.callee,t.New,te)),!(B&Pe)||S||Z>0){for(R.push("("),Y=0,se=Z;Y<se;++Y)R.push(this.generateExpression(w.arguments[Y],t.Assignment,ge)),Y+1<se&&R.push(","+O);R.push(")")}return Pt(R,t.New,_)},MemberExpression:function(w,_,B){var R,Z;return R=[this.generateExpression(w.object,t.Call,B&Oe?Ke:Ye)],w.computed?(w.optional&&R.push("?."),R.push("["),R.push(this.generateExpression(w.property,t.Sequence,B&Oe?ge:Xe)),R.push("]")):(!w.optional&&w.object.type===e.Literal&&typeof w.object.value=="number"&&(Z=it(R).toString(),Z.indexOf(".")<0&&!/[eExX]/.test(Z)&&i.code.isDecimalDigit(Z.charCodeAt(Z.length-1))&&!(Z.length>=2&&Z.charCodeAt(0)===48)&&R.push(" ")),R.push(w.optional?"?.":"."),R.push(Gt(w.property))),Pt(R,t.Member,_)},MetaProperty:function(w,_,B){var R;return R=[],R.push(typeof w.meta=="string"?w.meta:Gt(w.meta)),R.push("."),R.push(typeof w.property=="string"?w.property:Gt(w.property)),Pt(R,t.Member,_)},UnaryExpression:function(w,_,B){var R,Z,Y,se,te;return Z=this.generateExpression(w.argument,t.Unary,ge),O===""?R=_e(w.operator,Z):(R=[w.operator],w.operator.length>2?R=_e(R,Z):(se=it(R).toString(),te=se.charCodeAt(se.length-1),Y=Z.toString().charCodeAt(0),((te===43||te===45)&&te===Y||i.code.isIdentifierPartES5(te)&&i.code.isIdentifierPartES5(Y))&&R.push(Ft()),R.push(Z))),Pt(R,t.Unary,_)},YieldExpression:function(w,_,B){var R;return w.delegate?R="yield*":R="yield",w.argument&&(R=_e(R,this.generateExpression(w.argument,t.Yield,ge))),Pt(R,t.Yield,_)},AwaitExpression:function(w,_,B){var R=_e(w.all?"await*":"await",this.generateExpression(w.argument,t.Await,ge));return Pt(R,t.Await,_)},UpdateExpression:function(w,_,B){return w.prefix?Pt([w.operator,this.generateExpression(w.argument,t.Unary,ge)],t.Unary,_):Pt([this.generateExpression(w.argument,t.Postfix,ge),w.operator],t.Postfix,_)},FunctionExpression:function(w,_,B){var R=[an(w,!0),"function"];return w.id?(R.push(vs(w)||Ft()),R.push(Gt(w.id))):R.push(vs(w)||O),R.push(this.generateFunctionBody(w)),R},ArrayPattern:function(w,_,B){return this.ArrayExpression(w,_,B,!0)},ArrayExpression:function(w,_,B,R){var Z,Y,se=this;return w.elements.length?(Y=R?!1:w.elements.length>1,Z=["[",Y?y:""],et(function(te){var be,$e;for(be=0,$e=w.elements.length;be<$e;++be)w.elements[be]?(Z.push(Y?te:""),Z.push(se.generateExpression(w.elements[be],t.Assignment,ge))):(Y&&Z.push(te),be+1===$e&&Z.push(",")),be+1<$e&&Z.push(","+(Y?y:O))}),Y&&!Rt(it(Z).toString())&&Z.push(y),Z.push(Y?o:""),Z.push("]"),Z):"[]"},RestElement:function(w,_,B){return"..."+this.generatePattern(w.argument)},ClassExpression:function(w,_,B){var R,Z;return R=["class"],w.id&&(R=_e(R,this.generateExpression(w.id,t.Sequence,ge))),w.superClass&&(Z=_e("extends",this.generateExpression(w.superClass,t.Unary,ge)),R=_e(R,Z)),R.push(O),R.push(this.generateStatement(w.body,Ct)),R},MethodDefinition:function(w,_,B){var R,Z;return w.static?R=["static"+O]:R=[],w.kind==="get"||w.kind==="set"?Z=[_e(w.kind,this.generatePropertyKey(w.key,w.computed)),this.generateFunctionBody(w.value)]:Z=[Vn(w),this.generatePropertyKey(w.key,w.computed),this.generateFunctionBody(w.value)],_e(R,Z)},Property:function(w,_,B){return w.kind==="get"||w.kind==="set"?[w.kind,Ft(),this.generatePropertyKey(w.key,w.computed),this.generateFunctionBody(w.value)]:w.shorthand?w.value.type==="AssignmentPattern"?this.AssignmentPattern(w.value,t.Sequence,ge):this.generatePropertyKey(w.key,w.computed):w.method?[Vn(w),this.generatePropertyKey(w.key,w.computed),this.generateFunctionBody(w.value)]:[this.generatePropertyKey(w.key,w.computed),":"+O,this.generateExpression(w.value,t.Assignment,ge)]},ObjectExpression:function(w,_,B){var R,Z,Y,se=this;return w.properties.length?(R=w.properties.length>1,et(function(){Y=se.generateExpression(w.properties[0],t.Sequence,ge)}),!R&&!un(it(Y).toString())?["{",O,Y,O,"}"]:(et(function(te){var be,$e;if(Z=["{",y,te,Y],R)for(Z.push(","+y),be=1,$e=w.properties.length;be<$e;++be)Z.push(te),Z.push(se.generateExpression(w.properties[be],t.Sequence,ge)),be+1<$e&&Z.push(","+y)}),Rt(it(Z).toString())||Z.push(y),Z.push(o),Z.push("}"),Z)):"{}"},AssignmentPattern:function(w,_,B){return this.generateAssignment(w.left,w.right,"=",_,B)},ObjectPattern:function(w,_,B){var R,Z,Y,se,te,be=this;if(!w.properties.length)return"{}";if(se=!1,w.properties.length===1)te=w.properties[0],te.type===e.Property&&te.value.type!==e.Identifier&&(se=!0);else for(Z=0,Y=w.properties.length;Z<Y;++Z)if(te=w.properties[Z],te.type===e.Property&&!te.shorthand){se=!0;break}return R=["{",se?y:""],et(function($e){var Re,ut;for(Re=0,ut=w.properties.length;Re<ut;++Re)R.push(se?$e:""),R.push(be.generateExpression(w.properties[Re],t.Sequence,ge)),Re+1<ut&&R.push(","+(se?y:O))}),se&&!Rt(it(R).toString())&&R.push(y),R.push(se?o:""),R.push("}"),R},ThisExpression:function(w,_,B){return"this"},Super:function(w,_,B){return"super"},Identifier:function(w,_,B){return Gt(w)},ImportDefaultSpecifier:function(w,_,B){return Gt(w.id||w.local)},ImportNamespaceSpecifier:function(w,_,B){var R=["*"],Z=w.id||w.local;return Z&&R.push(O+"as"+Ft()+Gt(Z)),R},ImportSpecifier:function(w,_,B){var R=w.imported,Z=[R.name],Y=w.local;return Y&&Y.name!==R.name&&Z.push(Ft()+"as"+Ft()+Gt(Y)),Z},ExportSpecifier:function(w,_,B){var R=w.local,Z=[R.name],Y=w.exported;return Y&&Y.name!==R.name&&Z.push(Ft()+"as"+Ft()+Gt(Y)),Z},Literal:function(w,_,B){var R;if(w.hasOwnProperty("raw")&&$&&N.raw)try{if(R=$(w.raw).body[0].expression,R.type===e.Literal&&R.value===w.value)return w.raw}catch{}return w.regex?"/"+w.regex.pattern+"/"+w.regex.flags:typeof w.value=="bigint"?w.value.toString()+"n":w.bigint?w.bigint+"n":w.value===null?"null":typeof w.value=="string"?Zt(w.value):typeof w.value=="number"?Wn(w.value):typeof w.value=="boolean"?w.value?"true":"false":rt(w.value)},GeneratorExpression:function(w,_,B){return this.ComprehensionExpression(w,_,B)},ComprehensionExpression:function(w,_,B){var R,Z,Y,se,te=this;return R=w.type===e.GeneratorExpression?["("]:["["],N.moz.comprehensionExpressionStartsWithAssignment&&(se=this.generateExpression(w.body,t.Assignment,ge),R.push(se)),w.blocks&&et(function(){for(Z=0,Y=w.blocks.length;Z<Y;++Z)se=te.generateExpression(w.blocks[Z],t.Sequence,ge),Z>0||N.moz.comprehensionExpressionStartsWithAssignment?R=_e(R,se):R.push(se)}),w.filter&&(R=_e(R,"if"+O),se=this.generateExpression(w.filter,t.Sequence,ge),R=_e(R,["(",se,")"])),N.moz.comprehensionExpressionStartsWithAssignment||(se=this.generateExpression(w.body,t.Assignment,ge),R=_e(R,se)),R.push(w.type===e.GeneratorExpression?")":"]"),R},ComprehensionBlock:function(w,_,B){var R;return w.left.type===e.VariableDeclaration?R=[w.left.kind,Ft(),this.generateStatement(w.left.declarations[0],Et)]:R=this.generateExpression(w.left,t.Call,ge),R=_e(R,w.of?"of":"in"),R=_e(R,this.generateExpression(w.right,t.Sequence,ge)),["for"+O+"(",R,")"]},SpreadElement:function(w,_,B){return["...",this.generateExpression(w.argument,t.Assignment,ge)]},TaggedTemplateExpression:function(w,_,B){var R=Ke;B&Oe||(R=Ye);var Z=[this.generateExpression(w.tag,t.Call,R),this.generateExpression(w.quasi,t.Primary,yt)];return Pt(Z,t.TaggedTemplate,_)},TemplateElement:function(w,_,B){return w.value.raw},TemplateLiteral:function(w,_,B){var R,Z,Y;for(R=["`"],Z=0,Y=w.quasis.length;Z<Y;++Z)R.push(this.generateExpression(w.quasis[Z],t.Primary,ge)),Z+1<Y&&(R.push("${"+O),R.push(this.generateExpression(w.expressions[Z],t.Sequence,ge)),R.push(O+"}"));return R.push("`"),R},ModuleSpecifier:function(w,_,B){return this.Literal(w,_,B)},ImportExpression:function(w,_,B){return Pt(["import(",this.generateExpression(w.source,t.Assignment,ge),")"],t.Call,_)}},Kt(st.prototype,st.Expression),st.prototype.generateExpression=function(w,_,B){var R,Z;return Z=w.type||e.Property,N.verbatim&&w.hasOwnProperty(N.verbatim)?xn(w,_):(R=this[Z](w,_,B),N.comment&&(R=Cs(w,R)),it(R,w))},st.prototype.generateStatement=function(w,_){var B,R;return B=this[w.type](w,_),N.comment&&(B=Cs(w,B)),R=it(B).toString(),w.type===e.Program&&!F&&y===""&&R.charAt(R.length-1)===`
`&&(B=L?it(B).replaceRight(/\s+$/,""):R.replace(/\s+$/,"")),it(B,w)};function Hs(w){var _;if(_=new st,H(w))return _.generateStatement(w,Ge);if(he(w))return _.generateExpression(w,t.Sequence,ge);throw new Error("Unknown node type: "+w.type)}function Ys(w,_){var B=qn(),R,Z;return _!=null?(typeof _.indent=="string"&&(B.format.indent.style=_.indent),typeof _.base=="number"&&(B.format.indent.base=_.base),_=Un(B,_),l=_.format.indent.style,typeof _.base=="string"?o=_.base:o=cn(l,_.format.indent.base)):(_=B,l=_.format.indent.style,o=cn(l,_.format.indent.base)),c=_.format.json,u=_.format.renumber,h=c?!1:_.format.hexadecimal,d=c?"double":_.format.quotes,m=_.format.escapeless,y=_.format.newline,O=_.format.space,_.format.compact&&(y=O=l=o=""),S=_.format.parentheses,A=_.format.semicolons,F=_.format.safeConcatenation,j=_.directive,$=c?null:_.parse,L=_.sourceMap,I=_.sourceCode,q=_.format.preserveBlankLines&&I!==null,N=_,L&&(n.browser?r=Xye.sourceMap.SourceNode:r=o1e().SourceNode),R=Hs(w),L?(Z=R.toStringWithSourceMap({file:_.file,sourceRoot:_.sourceMapRoot}),_.sourceContent&&Z.map.setSourceContent(_.sourceMap,_.sourceContent),_.sourceMapWithCode?Z:Z.map.toString()):(Z={code:R.toString(),map:null},_.sourceMapWithCode?Z:Z.code)}ce={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},ee=qn().format,n.version=c1e.version,n.generate=Ys,n.attachComments=a.attachComments,n.Precedence=Un({},t),n.browser=!1,n.FORMAT_MINIFY=ce,n.FORMAT_DEFAULTS=ee})()})(QD)),QD}var h1e=u1e();const d1e=Hye(h1e);class p1e{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:e=>this.replacement=e}}replace(e,t,s,r){e&&t&&(s!=null?e[t][s]=r:e[t]=r)}remove(e,t,s){e&&t&&(s!=null?e[t].splice(s,1):delete e[t])}}class m1e extends p1e{constructor(e,t){super(),this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:s=>this.replacement=s},this.enter=e,this.leave=t}visit(e,t,s,r){if(e){if(this.enter){const i=this.should_skip,o=this.should_remove,l=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,e,t,s,r),this.replacement&&(e=this.replacement,this.replace(t,s,r,e)),this.should_remove&&this.remove(t,s,r);const c=this.should_skip,u=this.should_remove;if(this.should_skip=i,this.should_remove=o,this.replacement=l,c)return e;if(u)return null}let a;for(a in e){const i=e[a];if(i&&typeof i=="object")if(Array.isArray(i)){const o=i;for(let l=0;l<o.length;l+=1){const c=o[l];uT(c)&&(this.visit(c,e,a,l)||l--)}}else uT(i)&&this.visit(i,e,a,null)}if(this.leave){const i=this.replacement,o=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,e,t,s,r),this.replacement&&(e=this.replacement,this.replace(t,s,r,e)),this.should_remove&&this.remove(t,s,r);const l=this.should_remove;if(this.replacement=i,this.should_remove=o,l)return null}}return e}}function uT(n){return n!==null&&typeof n=="object"&&"type"in n&&typeof n.type=="string"}function f1e(n,{enter:e,leave:t}){return new m1e(e,t).visit(n,null)}let rZ=[];function g1e(n){rZ.push(n)}let $y=new Map;function b1e(n,e={}){var d;const{wrapAsync:t=!1,addReturn:s=!0,emitMiniLocations:r=!0,emitWidgets:a=!0}=e;let i=Gye(n,{ecmaVersion:2022,allowAwaitOutsideFunction:!0,locations:!0}),o=[];const l=(m,y)=>{const O=$y.get("minilang");if(O){const S=`[${m}]`,A=O.getLocations(S,y.start);o=o.concat(A)}else{const S=CA(`"${m}"`,y.start,n);o=o.concat(S)}};let c=[];f1e(i,{enter(m,y){var O,S,A;if(E1e(m)){const{name:F}=m.tag,j=$y.get(F),N=m.quasi.quasis[0].value.raw,$=m.quasi.start+1;if(r){const L=j.getLocations(N,$);o=o.concat(L)}return this.skip(),this.replace(B1e(F,N,$))}if(M1e(m,"tidal")){const F=m.quasi.quasis[0].value.raw,j=m.quasi.start+1;if(r){const N=D1e(F,j);o=o.concat(N)}return this.skip(),this.replace(T1e(F,j))}if(v1e(m,y)){const{quasis:F}=m,{raw:j}=F[0].value;return this.skip(),r&&l(j,m),this.replace(hT(j,m))}if(y1e(m)){const{value:F}=m;return this.skip(),r&&l(F,m),this.replace(hT(F,m))}if(O1e(m))return a&&c.push({from:m.arguments[0].start,to:m.arguments[0].end,value:m.arguments[0].raw,min:((O=m.arguments[1])==null?void 0:O.value)??0,max:((S=m.arguments[2])==null?void 0:S.value)??1,step:(A=m.arguments[3])==null?void 0:A.value,type:"slider"}),this.replace(x1e(m));if(w1e(m)){const F=m.callee.property.name,j=c.filter($=>$.type===F).length,N={to:m.end,index:j,type:F,id:e.id};return a&&c.push(N),this.replace(k1e(m,N))}if(S1e(m,y))return this.replace(C1e(m));if(P1e(m))return this.replace(A1e(m))},leave(m,y,O,S){}});let{body:u}=i;if(!u.length)console.warn("empty body -> fallback to silence"),u.push({type:"ExpressionStatement",expression:{type:"Identifier",name:"silence"}});else if(!((d=u==null?void 0:u[u.length-1])!=null&&d.expression))throw new Error("unexpected ast format without body expression");if(s){const{expression:m}=u[u.length-1];u[u.length-1]={type:"ReturnStatement",argument:m}}let h=d1e.generate(i);return t&&(h=`(async ()=>{${h}})()`),r?{output:h,miniLocations:o,widgets:c}:{output:h}}function y1e(n,e,t){return n.type!=="Literal"?!1:n.raw[0]==='"'}function v1e(n,e){return n.type==="TemplateLiteral"&&e.type!=="TaggedTemplateExpression"}function hT(n,e){const{start:t}=e,s=$y.get("minilang");let r="m";return s&&s.name&&(r=s.name),{type:"CallExpression",callee:{type:"Identifier",name:r},arguments:[{type:"Literal",value:n},{type:"Literal",value:t}],optional:!1}}function O1e(n){return n.type==="CallExpression"&&n.callee.name==="slider"}function w1e(n){var e;return n.type==="CallExpression"&&rZ.includes((e=n.callee.property)==null?void 0:e.name)}function x1e(n){const e="slider_"+n.arguments[0].start;return n.arguments.unshift({type:"Literal",value:e,raw:e}),n.callee.name="sliderWithID",n}function aZ(n){return`${n.id||""}_widget_${n.type}_${n.index}`}function k1e(n,e){const t=aZ(e);return n.arguments.unshift({type:"Literal",value:t,raw:t}),n}function S1e(n,e){return n.type==="CallExpression"&&n.callee.name==="samples"&&e.type!=="AwaitExpression"}function C1e(n){return{type:"AwaitExpression",argument:n}}function P1e(n){return n.type==="LabeledStatement"}function A1e(n){return{type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"MemberExpression",object:n.body.expression,property:{type:"Identifier",name:"p"}},arguments:[{type:"Literal",value:n.label.name,raw:`'${n.label.name}'`}]}}}function E1e(n){return n.type==="TaggedTemplateExpression"&&$y.has(n.tag.name)}function M1e(n,e){return n.type==="TaggedTemplateExpression"&&n.tag.name===e}function D1e(n,e){return n.split("").reduce((t,s,r)=>(s!=='"'||(!t.length||t[t.length-1].length>1?t.push([r+1]):t[t.length-1].push(r)),t),[]).map(([t,s])=>{const r=n.slice(t,s);return CA(`"${r}"`,e+t-1)}).flat()}function T1e(n,e){return{type:"CallExpression",callee:{type:"Identifier",name:"tidal"},arguments:[{type:"Literal",value:n},{type:"Literal",value:e}],optional:!1}}function B1e(n,e,t){return{type:"CallExpression",callee:{type:"Identifier",name:n},arguments:[{type:"Literal",value:e},{type:"Literal",value:t}],optional:!1}}if(typeof DelayNode<"u"){class n extends DelayNode{constructor(t,s,r,a){super(t),s=Math.abs(s),this.delayTime.value=r;const i=t.createGain();i.gain.value=Math.min(Math.abs(a),.995),this.feedback=i.gain;const o=t.createGain();return o.gain.value=s,this.delayGain=o,this.connect(i),this.connect(o),i.connect(this),this.connect=l=>o.connect(l),this}start(t){this.delayGain.gain.setValueAtTime(this.delayGain.gain.value,t+this.delayTime.value)}}AudioContext.prototype.createFeedbackDelay=function(e,t,s){return new n(this,e,t,s)}}var NA={};NA.generateReverb=function(n,e){for(var t=n.audioContext||new AudioContext,s=t.sampleRate,r=n.numChannels||2,a=n.decayTime*1.5,i=Math.round(n.decayTime*s),o=Math.round(a*s),l=Math.round((n.fadeInTime||0)*s),c=Math.pow(1/1e3,1/i),u=t.createBuffer(r,o,s),h=0;h<r;h++){for(var d=u.getChannelData(h),m=0;m<o;m++)d[m]=N1e()*Math.pow(c,m);for(var m=0;m<l;m++)d[m]*=m/l}F1e(u,n.lpFreqStart||0,n.lpFreqEnd||0,n.decayTime,e)};NA.generateGraph=function(n,e,t,s,r){var a=document.createElement("canvas");a.width=e,a.height=t;var i=a.getContext("2d");i.fillStyle="#000",i.fillRect(0,0,a.width,a.height),i.fillStyle="#fff";for(var o=e/n.length,l=t/(r-s),c=0;c<n.length;c++)i.fillRect(c*o,t-(n[c]-s)*l,1,1);return a};var F1e=function(n,e,t,s,r){if(e==0){r(n);return}var a=$1e(n),i=new OfflineAudioContext(n.numberOfChannels,a[0].length,n.sampleRate),o=i.createBufferSource();o.buffer=n;var l=i.createBiquadFilter();e=Math.min(e,n.sampleRate/2),t=Math.min(t,n.sampleRate/2),l.type="lowpass",l.Q.value=1e-4,l.frequency.setValueAtTime(e,0),l.frequency.linearRampToValueAtTime(t,s),o.connect(l),l.connect(i.destination),o.start(),i.oncomplete=function(c){r(c.renderedBuffer)},i.startRendering(),window.filterNode=l},$1e=function(n){for(var e=[],t=0;t<n.numberOfChannels;t++)e[t]=n.getChannelData(t);return e},N1e=function(){return Math.random()*2-1};let iZ=n=>console.log(n);function _A(n,e="cyclist"){Mi(`[${e}] error: ${n.message}`)}const Mi=(...n)=>iZ(...n),oZ=n=>{iZ=n},_1e=n=>{var r;if(typeof n!="string")return[];const[e,t="",s]=((r=n.match(/^([a-gA-G])([#bsf]*)([0-9]*)$/))==null?void 0:r.slice(1))||[];return e?[e,t,s?Number(s):void 0]:[]},R1e={c:0,d:2,e:4,f:5,g:7,a:9,b:11},I1e={"#":1,b:-1,s:1,f:-1},Tv=(n,e=3)=>{const[t,s,r=e]=_1e(n);if(!t)throw new Error('not a note: "'+n+'"');const a=R1e[t.toLowerCase()],i=(s==null?void 0:s.split("").reduce((o,l)=>o+I1e[l],0))||0;return(Number(r)+1)*12+a+i},lZ=n=>Math.pow(2,(n-69)/12)*440,Oh=(n,e,t)=>Math.min(Math.max(n,e),t),L1e=n=>12*Math.log(n/440)/Math.LN2+69,Q1e=(n,e)=>{if(typeof n!="object")throw new Error("valueToMidi: expected object value");let{freq:t,note:s}=n;return typeof t=="number"?L1e(t):typeof s=="string"?Tv(s):typeof s=="number"?s:e};function hc(n,e=0,t){return isNaN(Number(n))?(!t&&Mi(`"${n}" is not a number, falling back to ${e}`,"warning"),e):n}const cZ=(n,e)=>(n%e+e)%e,dT=(n,e)=>cZ(Math.round(hc(n,0)),e);function j1e(n,e){return n/e}typeof AudioContext<"u"&&(AudioContext.prototype.adjustLength=function(n,e,t=1,s=0){const r=Math.floor(Oh(s,0,1)*e.length),a=e.sampleRate*n,i=this.createBuffer(e.numberOfChannels,e.length,e.sampleRate);for(let o=0;o<e.numberOfChannels;o++){let l=e.getChannelData(o),c=i.getChannelData(o);for(let u=0;u<a;u++){let h=(r+u*Math.abs(t))%l.length;t<1&&(h=h*-1),c[u]=l.at(h)||0}}return i},AudioContext.prototype.createReverb=function(n,e,t,s,r,a,i){const o=this.createConvolver();return o.generate=(l=2,c=.1,u=15e3,h=1e3,d,m,y)=>{o.duration=l,o.fade=c,o.lp=u,o.dim=h,o.ir=d,o.irspeed=m,o.irbegin=y,d?o.buffer=this.adjustLength(l,d,m,y):NA.generateReverb({audioContext:this,numChannels:2,decayTime:l,fadeInTime:c,lpFreqStart:u,lpFreqEnd:h},O=>{o.buffer=O})},o.generate(n,e,t,s,r,a,i),o});var pT={a:{freqs:[660,1120,2750,3e3,3350],gains:[1,.5012,.0708,.0631,.0126],qs:[80,90,120,130,140]},e:{freqs:[440,1800,2700,3e3,3300],gains:[1,.1995,.1259,.1,.1],qs:[70,80,100,120,120]},i:{freqs:[270,1850,2900,3350,3590],gains:[1,.0631,.0631,.0158,.0158],qs:[40,90,100,120,120]},o:{freqs:[430,820,2700,3e3,3300],gains:[1,.3162,.0501,.0794,.01995],qs:[40,80,100,120,120]},u:{freqs:[370,630,2750,3e3,3400],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},ae:{freqs:[650,1515,2400,3e3,3350],gains:[1,.5,.1008,.0631,.0126],qs:[80,90,120,130,140]},aa:{freqs:[560,900,2570,3e3,3300],gains:[1,.5,.0708,.0631,.0126],qs:[80,90,120,130,140]},oe:{freqs:[500,1430,2300,3e3,3300],gains:[1,.2,.0708,.0316,.01995],qs:[40,60,100,120,120]},ue:{freqs:[250,1750,2150,3200,3300],gains:[1,.1,.0708,.0316,.01995],qs:[40,60,100,120,120]},y:{freqs:[400,1460,2400,3e3,3300],gains:[1,.2,.0708,.0316,.02995],qs:[40,60,100,120,120]},uh:{freqs:[600,1250,2100,3100,3500],gains:[1,.3,.0608,.0316,.01995],qs:[40,70,100,120,130]},un:{freqs:[500,1240,2280,3e3,3500],gains:[1,.1,.1708,.0216,.02995],qs:[40,60,100,120,120]},en:{freqs:[600,1480,2450,3200,3300],gains:[1,.15,.0708,.0316,.02995],qs:[40,60,100,120,120]},an:{freqs:[700,1050,2500,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},on:{freqs:[500,1080,2350,3e3,3300],gains:[1,.1,.0708,.0316,.02995],qs:[40,60,100,120,120]},get æ(){return this.ae},get ø(){return this.oe},get ɑ(){return this.aa},get å(){return this.aa},get ö(){return this.oe},get ü(){return this.ue},get ı(){return this.y}};if(typeof GainNode<"u"){class n extends GainNode{constructor(t,s){if(super(t),!pT[s])throw new Error("vowel: unknown vowel "+s);const{gains:r,qs:a,freqs:i}=pT[s],o=t.createGain();for(let l=0;l<5;l++){const c=t.createGain();c.gain.value=r[l];const u=t.createBiquadFilter();u.type="bandpass",u.Q.value=a[l],u.frequency.value=i[l],this.connect(u),u.connect(c),c.connect(o)}return o.gain.value=8,this.connect=l=>o.connect(l),this}}AudioContext.prototype.createVowelFilter=function(e){return new n(this,e)}}const V1e="data:text/javascript;base64,KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NsYXNzIGd0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuc3RhcnRlZD0hMSx0aGlzLm5iSW5wdXRzPXQubnVtYmVyT2ZJbnB1dHMsdGhpcy5uYk91dHB1dHM9dC5udW1iZXJPZk91dHB1dHMsdGhpcy5ibG9ja1NpemU9dC5wcm9jZXNzb3JPcHRpb25zLmJsb2NrU2l6ZSx0aGlzLmhvcFNpemU9MTI4LHRoaXMubmJPdmVybGFwcz10aGlzLmJsb2NrU2l6ZS90aGlzLmhvcFNpemUsdGhpcy5pbnB1dEJ1ZmZlcnM9bmV3IEFycmF5KHRoaXMubmJJbnB1dHMpLHRoaXMuaW5wdXRCdWZmZXJzSGVhZD1uZXcgQXJyYXkodGhpcy5uYklucHV0cyksdGhpcy5pbnB1dEJ1ZmZlcnNUb1NlbmQ9bmV3IEFycmF5KHRoaXMubmJJbnB1dHMpO2ZvcihsZXQgZT0wO2U8dGhpcy5uYklucHV0cztlKyspdGhpcy5hbGxvY2F0ZUlucHV0Q2hhbm5lbHMoZSwxKTt0aGlzLm91dHB1dEJ1ZmZlcnM9bmV3IEFycmF5KHRoaXMubmJPdXRwdXRzKSx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlPW5ldyBBcnJheSh0aGlzLm5iT3V0cHV0cyk7Zm9yKGxldCBlPTA7ZTx0aGlzLm5iT3V0cHV0cztlKyspdGhpcy5hbGxvY2F0ZU91dHB1dENoYW5uZWxzKGUsMSl9cmVhbGxvY2F0ZUNoYW5uZWxzSWZOZWVkZWQodCxlKXtmb3IobGV0IHM9MDtzPHRoaXMubmJJbnB1dHM7cysrKXtsZXQgcj10W3NdLmxlbmd0aDtyIT10aGlzLmlucHV0QnVmZmVyc1tzXS5sZW5ndGgmJnRoaXMuYWxsb2NhdGVJbnB1dENoYW5uZWxzKHMscil9Zm9yKGxldCBzPTA7czx0aGlzLm5iT3V0cHV0cztzKyspe2xldCByPWVbc10ubGVuZ3RoO3IhPXRoaXMub3V0cHV0QnVmZmVyc1tzXS5sZW5ndGgmJnRoaXMuYWxsb2NhdGVPdXRwdXRDaGFubmVscyhzLHIpfX1hbGxvY2F0ZUlucHV0Q2hhbm5lbHModCxlKXt0aGlzLmlucHV0QnVmZmVyc1t0XT1uZXcgQXJyYXkoZSk7Zm9yKGxldCBzPTA7czxlO3MrKyl0aGlzLmlucHV0QnVmZmVyc1t0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKzEyOCksdGhpcy5pbnB1dEJ1ZmZlcnNbdF1bc10uZmlsbCgwKTt0aGlzLmlucHV0QnVmZmVyc0hlYWRbdF09bmV3IEFycmF5KGUpLHRoaXMuaW5wdXRCdWZmZXJzVG9TZW5kW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMuaW5wdXRCdWZmZXJzSGVhZFt0XVtzXT10aGlzLmlucHV0QnVmZmVyc1t0XVtzXS5zdWJhcnJheSgwLHRoaXMuYmxvY2tTaXplKSx0aGlzLmlucHV0QnVmZmVyc1RvU2VuZFt0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKX1hbGxvY2F0ZU91dHB1dENoYW5uZWxzKHQsZSl7dGhpcy5vdXRwdXRCdWZmZXJzW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMub3V0cHV0QnVmZmVyc1t0XVtzXT1uZXcgRmxvYXQzMkFycmF5KHRoaXMuYmxvY2tTaXplKSx0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bc10uZmlsbCgwKTt0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdPW5ldyBBcnJheShlKTtmb3IobGV0IHM9MDtzPGU7cysrKXRoaXMub3V0cHV0QnVmZmVyc1RvUmV0cmlldmVbdF1bc109bmV3IEZsb2F0MzJBcnJheSh0aGlzLmJsb2NrU2l6ZSksdGhpcy5vdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZVt0XVtzXS5maWxsKDApfXJlYWRJbnB1dHModCl7aWYodFswXS5sZW5ndGgmJnRbMF1bMF0ubGVuZ3RoPT0wKXtmb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl0aGlzLmlucHV0QnVmZmVyc1tlXVtzXS5maWxsKDAsdGhpcy5ibG9ja1NpemUpO3JldHVybn1mb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl7bGV0IHI9dFtlXVtzXTt0aGlzLmlucHV0QnVmZmVyc1tlXVtzXS5zZXQocix0aGlzLmJsb2NrU2l6ZSl9fXdyaXRlT3V0cHV0cyh0KXtmb3IobGV0IGU9MDtlPHRoaXMubmJJbnB1dHM7ZSsrKWZvcihsZXQgcz0wO3M8dGhpcy5pbnB1dEJ1ZmZlcnNbZV0ubGVuZ3RoO3MrKyl7bGV0IHI9dGhpcy5vdXRwdXRCdWZmZXJzW2VdW3NdLnN1YmFycmF5KDAsMTI4KTt0W2VdW3NdLnNldChyKX19c2hpZnRJbnB1dEJ1ZmZlcnMoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJJbnB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5pbnB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKyl0aGlzLmlucHV0QnVmZmVyc1t0XVtlXS5jb3B5V2l0aGluKDAsMTI4KX1zaGlmdE91dHB1dEJ1ZmZlcnMoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJPdXRwdXRzO3QrKylmb3IobGV0IGU9MDtlPHRoaXMub3V0cHV0QnVmZmVyc1t0XS5sZW5ndGg7ZSsrKXRoaXMub3V0cHV0QnVmZmVyc1t0XVtlXS5jb3B5V2l0aGluKDAsMTI4KSx0aGlzLm91dHB1dEJ1ZmZlcnNbdF1bZV0uc3ViYXJyYXkodGhpcy5ibG9ja1NpemUtMTI4KS5maWxsKDApfXByZXBhcmVJbnB1dEJ1ZmZlcnNUb1NlbmQoKXtmb3IobGV0IHQ9MDt0PHRoaXMubmJJbnB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5pbnB1dEJ1ZmZlcnNbdF0ubGVuZ3RoO2UrKyl0aGlzLmlucHV0QnVmZmVyc1RvU2VuZFt0XVtlXS5zZXQodGhpcy5pbnB1dEJ1ZmZlcnNIZWFkW3RdW2VdKX1oYW5kbGVPdXRwdXRCdWZmZXJzVG9SZXRyaWV2ZSgpe2ZvcihsZXQgdD0wO3Q8dGhpcy5uYk91dHB1dHM7dCsrKWZvcihsZXQgZT0wO2U8dGhpcy5vdXRwdXRCdWZmZXJzW3RdLmxlbmd0aDtlKyspZm9yKGxldCBzPTA7czx0aGlzLmJsb2NrU2l6ZTtzKyspdGhpcy5vdXRwdXRCdWZmZXJzW3RdW2VdW3NdKz10aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlW3RdW2VdW3NdL3RoaXMubmJPdmVybGFwc31wcm9jZXNzKHQsZSxzKXtjb25zdCBvPXRbMF1bMF0hPT12b2lkIDA7cmV0dXJuIHRoaXMuc3RhcnRlZCYmIW8/ITE6KHRoaXMuc3RhcnRlZD1vLHRoaXMucmVhbGxvY2F0ZUNoYW5uZWxzSWZOZWVkZWQodCxlKSx0aGlzLnJlYWRJbnB1dHModCksdGhpcy5zaGlmdElucHV0QnVmZmVycygpLHRoaXMucHJlcGFyZUlucHV0QnVmZmVyc1RvU2VuZCgpLHRoaXMucHJvY2Vzc09MQSh0aGlzLmlucHV0QnVmZmVyc1RvU2VuZCx0aGlzLm91dHB1dEJ1ZmZlcnNUb1JldHJpZXZlLHMpLHRoaXMuaGFuZGxlT3V0cHV0QnVmZmVyc1RvUmV0cmlldmUoKSx0aGlzLndyaXRlT3V0cHV0cyhlKSx0aGlzLnNoaWZ0T3V0cHV0QnVmZmVycygpLCEwKX1wcm9jZXNzT0xBKHQsZSxzKXtjb25zb2xlLmFzc2VydCghMSwiTm90IG92ZXJyaWRlbiIpfX1jbGFzcyBJdHtjb25zdHJ1Y3Rvcih0KXtpZih0aGlzLnNpemU9dHwwLHRoaXMuc2l6ZTw9MXx8dGhpcy5zaXplJnRoaXMuc2l6ZS0xKXRocm93IG5ldyBFcnJvcigiRkZUIHNpemUgbXVzdCBiZSBhIHBvd2VyIG9mIHR3byBhbmQgYmlnZ2VyIHRoYW4gMSIpO3RoaXMuX2NzaXplPXQ8PDE7Zm9yKHZhciBlPW5ldyBBcnJheSh0aGlzLnNpemUqMikscz0wO3M8ZS5sZW5ndGg7cys9Mil7Y29uc3QgYT1NYXRoLlBJKnMvdGhpcy5zaXplO2Vbc109TWF0aC5jb3MoYSksZVtzKzFdPS1NYXRoLnNpbihhKX10aGlzLnRhYmxlPWU7Zm9yKHZhciByPTAsbz0xO3RoaXMuc2l6ZT5vO288PD0xKXIrKzt0aGlzLl93aWR0aD1yJTI9PT0wP3ItMTpyLHRoaXMuX2JpdHJldj1uZXcgQXJyYXkoMTw8dGhpcy5fd2lkdGgpO2Zvcih2YXIgaT0wO2k8dGhpcy5fYml0cmV2Lmxlbmd0aDtpKyspe3RoaXMuX2JpdHJldltpXT0wO2Zvcih2YXIgdT0wO3U8dGhpcy5fd2lkdGg7dSs9Mil7dmFyIGM9dGhpcy5fd2lkdGgtdS0yO3RoaXMuX2JpdHJldltpXXw9KGk+Pj51JjMpPDxjfX10aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGwsdGhpcy5faW52PTB9ZnJvbUNvbXBsZXhBcnJheSh0LGUpe2Zvcih2YXIgcz1lfHxuZXcgQXJyYXkodC5sZW5ndGg+Pj4xKSxyPTA7cjx0Lmxlbmd0aDtyKz0yKXNbcj4+PjFdPXRbcl07cmV0dXJuIHN9Y3JlYXRlQ29tcGxleEFycmF5KCl7Y29uc3QgdD1uZXcgQXJyYXkodGhpcy5fY3NpemUpO2Zvcih2YXIgZT0wO2U8dC5sZW5ndGg7ZSsrKXRbZV09MDtyZXR1cm4gdH10b0NvbXBsZXhBcnJheSh0LGUpe2Zvcih2YXIgcz1lfHx0aGlzLmNyZWF0ZUNvbXBsZXhBcnJheSgpLHI9MDtyPHMubGVuZ3RoO3IrPTIpc1tyXT10W3I+Pj4xXSxzW3IrMV09MDtyZXR1cm4gc31jb21wbGV0ZVNwZWN0cnVtKHQpe2Zvcih2YXIgZT10aGlzLl9jc2l6ZSxzPWU+Pj4xLHI9MjtyPHM7cis9Mil0W2Utcl09dFtyXSx0W2UtcisxXT0tdFtyKzFdfXRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0wLHRoaXMuX3RyYW5zZm9ybTQoKSx0aGlzLl9vdXQ9bnVsbCx0aGlzLl9kYXRhPW51bGx9cmVhbFRyYW5zZm9ybSh0LGUpe2lmKHQ9PT1lKXRocm93IG5ldyBFcnJvcigiSW5wdXQgYW5kIG91dHB1dCBidWZmZXJzIG11c3QgYmUgZGlmZmVyZW50Iik7dGhpcy5fb3V0PXQsdGhpcy5fZGF0YT1lLHRoaXMuX2ludj0wLHRoaXMuX3JlYWxUcmFuc2Zvcm00KCksdGhpcy5fb3V0PW51bGwsdGhpcy5fZGF0YT1udWxsfWludmVyc2VUcmFuc2Zvcm0odCxlKXtpZih0PT09ZSl0aHJvdyBuZXcgRXJyb3IoIklucHV0IGFuZCBvdXRwdXQgYnVmZmVycyBtdXN0IGJlIGRpZmZlcmVudCIpO3RoaXMuX291dD10LHRoaXMuX2RhdGE9ZSx0aGlzLl9pbnY9MSx0aGlzLl90cmFuc2Zvcm00KCk7Zm9yKHZhciBzPTA7czx0Lmxlbmd0aDtzKyspdFtzXS89dGhpcy5zaXplO3RoaXMuX291dD1udWxsLHRoaXMuX2RhdGE9bnVsbH1fdHJhbnNmb3JtNCgpe3ZhciB0PXRoaXMuX291dCxlPXRoaXMuX2NzaXplLHM9dGhpcy5fd2lkdGgscj0xPDxzLG89ZS9yPDwxLGksdSxjPXRoaXMuX2JpdHJldjtpZihvPT09NClmb3IoaT0wLHU9MDtpPGU7aSs9byx1Kyspe2NvbnN0IGQ9Y1t1XTt0aGlzLl9zaW5nbGVUcmFuc2Zvcm0yKGksZCxyKX1lbHNlIGZvcihpPTAsdT0wO2k8ZTtpKz1vLHUrKyl7Y29uc3QgZD1jW3VdO3RoaXMuX3NpbmdsZVRyYW5zZm9ybTQoaSxkLHIpfXZhciBhPXRoaXMuX2ludj8tMToxLGg9dGhpcy50YWJsZTtmb3Iocj4+PTI7cj49MjtyPj49Mil7bz1lL3I8PDE7dmFyIG09bz4+PjI7Zm9yKGk9MDtpPGU7aSs9bylmb3IodmFyIHA9aSttLGw9aSxmPTA7bDxwO2wrPTIsZis9cil7Y29uc3QgZD1sLHY9ZCttLGc9dittLEk9ZyttLGI9dFtkXSxCPXRbZCsxXSxfPXRbdl0sdz10W3YrMV0sVD10W2ddLFA9dFtnKzFdLHk9dFtJXSxBPXRbSSsxXSx4PWIsVj1CLEY9aFtmXSxNPWEqaFtmKzFdLE89XypGLXcqTSxOPV8qTSt3KkYsWT1oWzIqZl0sTD1hKmhbMipmKzFdLEg9VCpZLVAqTCxVPVQqTCtQKlksSz1oWzMqZl0sWj1hKmhbMypmKzFdLCQ9eSpLLUEqWixHPXkqWitBKkssaj14K0gsaz1WK1Usej14LUgsSj1WLVUsUT1PKyQsRT1OK0csUj1hKihPLSQpLFg9YSooTi1HKSxzdD1qK1EsaXQ9aytFLG90PWotUSxhdD1rLUUsdXQ9eitYLGh0PUotUixjdD16LVgsbHQ9SitSO3RbZF09c3QsdFtkKzFdPWl0LHRbdl09dXQsdFt2KzFdPWh0LHRbZ109b3QsdFtnKzFdPWF0LHRbSV09Y3QsdFtJKzFdPWx0fX19X3NpbmdsZVRyYW5zZm9ybTIodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LG89dGhpcy5fZGF0YSxpPW9bZV0sdT1vW2UrMV0sYz1vW2Urc10sYT1vW2UrcysxXSxoPWkrYyxtPXUrYSxwPWktYyxsPXUtYTtyW3RdPWgsclt0KzFdPW0sclt0KzJdPXAsclt0KzNdPWx9X3NpbmdsZVRyYW5zZm9ybTQodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LG89dGhpcy5fZGF0YSxpPXRoaXMuX2ludj8tMToxLHU9cyoyLGM9cyozLGE9b1tlXSxoPW9bZSsxXSxtPW9bZStzXSxwPW9bZStzKzFdLGw9b1tlK3VdLGY9b1tlK3UrMV0sZD1vW2UrY10sdj1vW2UrYysxXSxnPWErbCxJPWgrZixiPWEtbCxCPWgtZixfPW0rZCx3PXArdixUPWkqKG0tZCksUD1pKihwLXYpLHk9ZytfLEE9SSt3LHg9YitQLFY9Qi1ULEY9Zy1fLE09SS13LE89Yi1QLE49QitUO3JbdF09eSxyW3QrMV09QSxyW3QrMl09eCxyW3QrM109VixyW3QrNF09RixyW3QrNV09TSxyW3QrNl09TyxyW3QrN109Tn1fcmVhbFRyYW5zZm9ybTQoKXt2YXIgdD10aGlzLl9vdXQsZT10aGlzLl9jc2l6ZSxzPXRoaXMuX3dpZHRoLHI9MTw8cyxvPWUvcjw8MSxpLHUsYz10aGlzLl9iaXRyZXY7aWYobz09PTQpZm9yKGk9MCx1PTA7aTxlO2krPW8sdSsrKXtjb25zdCBmdD1jW3VdO3RoaXMuX3NpbmdsZVJlYWxUcmFuc2Zvcm0yKGksZnQ+Pj4xLHI+Pj4xKX1lbHNlIGZvcihpPTAsdT0wO2k8ZTtpKz1vLHUrKyl7Y29uc3QgZnQ9Y1t1XTt0aGlzLl9zaW5nbGVSZWFsVHJhbnNmb3JtNChpLGZ0Pj4+MSxyPj4+MSl9dmFyIGE9dGhpcy5faW52Py0xOjEsaD10aGlzLnRhYmxlO2ZvcihyPj49MjtyPj0yO3I+Pj0yKXtvPWUvcjw8MTt2YXIgbT1vPj4+MSxwPW0+Pj4xLGw9cD4+PjE7Zm9yKGk9MDtpPGU7aSs9bylmb3IodmFyIGY9MCxkPTA7Zjw9bDtmKz0yLGQrPXIpe3ZhciB2PWkrZixnPXYrcCxJPWcrcCxiPUkrcCxCPXRbdl0sXz10W3YrMV0sdz10W2ddLFQ9dFtnKzFdLFA9dFtJXSx5PXRbSSsxXSxBPXRbYl0seD10W2IrMV0sVj1CLEY9XyxNPWhbZF0sTz1hKmhbZCsxXSxOPXcqTS1UKk8sWT13Kk8rVCpNLEw9aFsyKmRdLEg9YSpoWzIqZCsxXSxVPVAqTC15KkgsSz1QKkgreSpMLFo9aFszKmRdLCQ9YSpoWzMqZCsxXSxHPUEqWi14KiQsaj1BKiQreCpaLGs9VitVLHo9RitLLEo9Vi1VLFE9Ri1LLEU9TitHLFI9WStqLFg9YSooTi1HKSxzdD1hKihZLWopLGl0PWsrRSxvdD16K1IsYXQ9SitzdCx1dD1RLVg7aWYodFt2XT1pdCx0W3YrMV09b3QsdFtnXT1hdCx0W2crMV09dXQsZj09PTApe3ZhciBodD1rLUUsY3Q9ei1SO3RbSV09aHQsdFtJKzFdPWN0O2NvbnRpbnVlfWlmKGYhPT1sKXt2YXIgbHQ9SixFdD0tUSxSdD1rLER0PS16LHF0PS1hKnN0LFd0PS1hKlgsWXQ9LWEqUixMdD0tYSpFLEh0PWx0K3F0LFV0PUV0K1d0LEt0PVJ0K0x0LFp0PUR0LVl0LG10PWkrcC1mLHZ0PWkrbS1mO3RbbXRdPUh0LHRbbXQrMV09VXQsdFt2dF09S3QsdFt2dCsxXT1adH19fX1fc2luZ2xlUmVhbFRyYW5zZm9ybTIodCxlLHMpe2NvbnN0IHI9dGhpcy5fb3V0LG89dGhpcy5fZGF0YSxpPW9bZV0sdT1vW2Urc10sYz1pK3UsYT1pLXU7clt0XT1jLHJbdCsxXT0wLHJbdCsyXT1hLHJbdCszXT0wfV9zaW5nbGVSZWFsVHJhbnNmb3JtNCh0LGUscyl7Y29uc3Qgcj10aGlzLl9vdXQsbz10aGlzLl9kYXRhLGk9dGhpcy5faW52Py0xOjEsdT1zKjIsYz1zKjMsYT1vW2VdLGg9b1tlK3NdLG09b1tlK3VdLHA9b1tlK2NdLGw9YSttLGY9YS1tLGQ9aCtwLHY9aSooaC1wKSxnPWwrZCxJPWYsYj0tdixCPWwtZCxfPWYsdz12O3JbdF09ZyxyW3QrMV09MCxyW3QrMl09SSxyW3QrM109YixyW3QrNF09QixyW3QrNV09MCxyW3QrNl09XyxyW3QrN109d319Y29uc3QgQz0obix0LGUpPT5NYXRoLm1pbihNYXRoLm1heChuLHQpLGUpLHB0PShuLHQpPT4obiV0K3QpJXQ7ZnVuY3Rpb24gYnQobix0PTEpe3JldHVybiBuPj10P24tPXQ6bjwwJiYobis9dCksbn1jb25zdCBEPTEyODtmdW5jdGlvbiBCdChuLHQpe3JldHVybiB0PU1hdGgubWluKHQsMS10KSxuPHQ/KG4vPXQsbituLW4qbi0xKTpuPjEtdD8obj0obi0xKS90LG4qbituK24rMSk6MH1jb25zdCBydD17dHJpKG4sdD0uNSl7Y29uc3QgZT0xLXQ7cmV0dXJuIG4+PXQ/MS9lLW4vZTpuL3R9LHNpbmUobil7cmV0dXJuIE1hdGguc2luKE1hdGguUEkqMipuKSouNSsuNX0scmFtcChuKXtyZXR1cm4gbn0sc2F3KG4pe3JldHVybiAxLW59LHNxdWFyZShuLHQ9LjUpe3JldHVybiBuPj10PzA6MX0sY3VzdG9tKG4sdD1bMCwxXSl7Y29uc3QgZT10Lmxlbmd0aC0xLHM9TWF0aC5mbG9vcihuKmUpLHI9MS9lLG89Qyh0W3NdLDAsMSksdT1DKHRbcysxXSwwLDEpLGM9byxhPTAsaD1yO3JldHVybih1LWMpLyhoLWEpKihuLXIqcykrb30sc2F3YmxlcChuLHQpe3JldHVybiAyKm4tMS1CdChuLHQpfX07ZnVuY3Rpb24gcShuLHQpe3JldHVybiB0Lmxlbmd0aD4xP3Rbbl06dFswXX1jb25zdCBfdD1PYmplY3Qua2V5cyhydCk7Y2xhc3Mgd3QgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToidGltZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6LjV9LHtuYW1lOiJza2V3IixkZWZhdWx0VmFsdWU6LjV9LHtuYW1lOiJkZXB0aCIsZGVmYXVsdFZhbHVlOjF9LHtuYW1lOiJwaGFzZW9mZnNldCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJzaGFwZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJjdXJ2ZSIsZGVmYXVsdFZhbHVlOjF9LHtuYW1lOiJkY29mZnNldCIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJtaW4iLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToibWF4IixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnBoYXNlfWluY3JlbWVudFBoYXNlKHQpe3RoaXMucGhhc2UrPXQsdGhpcy5waGFzZT4xJiYodGhpcy5waGFzZT10aGlzLnBoYXNlLTEpfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9cy5iZWdpblswXTtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXIpcmV0dXJuITA7Y29uc3Qgbz1lWzBdLGk9cy5mcmVxdWVuY3lbMF0sdT1zLnRpbWVbMF0sYz1zLmRlcHRoWzBdLGE9cy5za2V3WzBdLGg9cy5waGFzZW9mZnNldFswXSxtPXMuY3VydmVbMF0scD1zLmRjb2Zmc2V0WzBdLGw9cy5taW5bMF0sZj1zLm1heFswXSxkPV90W3Muc2hhcGVbMF1dLHY9b1swXS5sZW5ndGg/PzA7dGhpcy5waGFzZT09bnVsbCYmKHRoaXMucGhhc2U9cHQodSppK2gsMSkpO2NvbnN0IGc9aS9zYW1wbGVSYXRlO2ZvcihsZXQgST0wO0k8djtJKyspe2ZvcihsZXQgYj0wO2I8by5sZW5ndGg7YisrKXtsZXQgQj0ocnRbZF0odGhpcy5waGFzZSxhKStwKSpjO0I9TWF0aC5wb3coQixtKSxvW2JdW0ldPUMoQixsLGYpfXRoaXMuaW5jcmVtZW50UGhhc2UoZyl9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJsZm8tcHJvY2Vzc29yIix3dCk7Y2xhc3MgU3QgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY29hcnNlIixkZWZhdWx0VmFsdWU6MX1dfWNvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnN0YXJ0ZWQ9ITF9cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLG89ZVswXSxpPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhaSlyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9aTtsZXQgdT1zLmNvYXJzZVswXT8/MDt1PU1hdGgubWF4KDEsdSk7Zm9yKGxldCBjPTA7YzxEO2MrKylmb3IobGV0IGE9MDthPHIubGVuZ3RoO2ErKylvW2FdW2NdPWMldT09PTA/clthXVtjXTpvW2FdW2MtMV07cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjb2Fyc2UtcHJvY2Vzc29yIixTdCk7Y2xhc3MgVHQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiY3J1c2giLGRlZmF1bHRWYWx1ZTowfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuc3RhcnRlZD0hMX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0sbz1lWzBdLGk9clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFpKXJldHVybiExO3RoaXMuc3RhcnRlZD1pO2xldCB1PXMuY3J1c2hbMF0/Pzg7dT1NYXRoLm1heCgxLHUpO2ZvcihsZXQgYz0wO2M8RDtjKyspZm9yKGxldCBhPTA7YTxyLmxlbmd0aDthKyspe2NvbnN0IGg9TWF0aC5wb3coMix1LTEpO29bYV1bY109TWF0aC5yb3VuZChyW2FdW2NdKmgpL2h9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJjcnVzaC1wcm9jZXNzb3IiLFR0KTtjbGFzcyBQdCBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcntzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJzaGFwZSIsZGVmYXVsdFZhbHVlOjB9LHtuYW1lOiJwb3N0Z2FpbiIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExfXByb2Nlc3ModCxlLHMpe2NvbnN0IHI9dFswXSxvPWVbMF0saT1yWzBdIT09dm9pZCAwO2lmKHRoaXMuc3RhcnRlZCYmIWkpcmV0dXJuITE7dGhpcy5zdGFydGVkPWk7bGV0IHU9cy5zaGFwZVswXTt1PXU8MT91OjEtNGUtMTAsdT0yKnUvKDEtdSk7Y29uc3QgYz1NYXRoLm1heCguMDAxLE1hdGgubWluKDEscy5wb3N0Z2FpblswXSkpO2ZvcihsZXQgYT0wO2E8RDthKyspZm9yKGxldCBoPTA7aDxyLmxlbmd0aDtoKyspb1toXVthXT0oMSt1KSpyW2hdW2FdLygxK3UqTWF0aC5hYnMocltoXVthXSkpKmM7cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJzaGFwZS1wcm9jZXNzb3IiLFB0KTtmdW5jdGlvbiBTKG4pe2NvbnN0IHQ9bipuO3JldHVybiBuKigyNyt0KS8oMjcrOSp0KX1jb25zdCBkdD0zLjE0MTU5MjY1MzU5O2NsYXNzIHl0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImZyZXF1ZW5jeSIsZGVmYXVsdFZhbHVlOjUwMH0se25hbWU6InEiLGRlZmF1bHRWYWx1ZToxfSx7bmFtZToiZHJpdmUiLGRlZmF1bHRWYWx1ZTouNjl9XX1jb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5zdGFydGVkPSExLHRoaXMucDA9WzAsMF0sdGhpcy5wMT1bMCwwXSx0aGlzLnAyPVswLDBdLHRoaXMucDM9WzAsMF0sdGhpcy5wMzI9WzAsMF0sdGhpcy5wMzM9WzAsMF0sdGhpcy5wMzQ9WzAsMF19cHJvY2Vzcyh0LGUscyl7Y29uc3Qgcj10WzBdLG89ZVswXSxpPXJbMF0hPT12b2lkIDA7aWYodGhpcy5zdGFydGVkJiYhaSlyZXR1cm4hMTt0aGlzLnN0YXJ0ZWQ9aTtjb25zdCB1PXMucVswXSxjPUMoTWF0aC5leHAocy5kcml2ZVswXSksLjEsMmUzKTtsZXQgYT1zLmZyZXF1ZW5jeVswXTthPWEqMipkdC9zYW1wbGVSYXRlLGE9YT4xPzE6YTtjb25zdCBoPU1hdGgubWluKDgsdSouMTMpO2xldCBtPTEvYypNYXRoLm1pbigxLjc1LDEraCk7Zm9yKGxldCBwPTA7cDxEO3ArKylmb3IobGV0IGw9MDtsPHIubGVuZ3RoO2wrKyl7Y29uc3QgZj10aGlzLnAzW2xdKi4zNjA4OTErdGhpcy5wMzJbbF0qLjQxNzI5K3RoaXMucDMzW2xdKi4xNzc4OTYrdGhpcy5wMzRbbF0qLjA0Mzk3MjU7dGhpcy5wMzRbbF09dGhpcy5wMzNbbF0sdGhpcy5wMzNbbF09dGhpcy5wMzJbbF0sdGhpcy5wMzJbbF09dGhpcy5wM1tsXSx0aGlzLnAwW2xdKz0oUyhyW2xdW3BdKmMtaCpmKS1TKHRoaXMucDBbbF0pKSphLHRoaXMucDFbbF0rPShTKHRoaXMucDBbbF0pLVModGhpcy5wMVtsXSkpKmEsdGhpcy5wMltsXSs9KFModGhpcy5wMVtsXSktUyh0aGlzLnAyW2xdKSkqYSx0aGlzLnAzW2xdKz0oUyh0aGlzLnAyW2xdKS1TKHRoaXMucDNbbF0pKSphLG9bbF1bcF09ZiptfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigibGFkZGVyLXByb2Nlc3NvciIseXQpO2NsYXNzIEF0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye3N0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImRpc3RvcnQiLGRlZmF1bHRWYWx1ZTowfSx7bmFtZToicG9zdGdhaW4iLGRlZmF1bHRWYWx1ZToxfV19Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuc3RhcnRlZD0hMX1wcm9jZXNzKHQsZSxzKXtjb25zdCByPXRbMF0sbz1lWzBdLGk9clswXSE9PXZvaWQgMDtpZih0aGlzLnN0YXJ0ZWQmJiFpKXJldHVybiExO3RoaXMuc3RhcnRlZD1pO2NvbnN0IHU9TWF0aC5leHBtMShzLmRpc3RvcnRbMF0pLGM9TWF0aC5tYXgoLjAwMSxNYXRoLm1pbigxLHMucG9zdGdhaW5bMF0pKTtmb3IobGV0IGE9MDthPEQ7YSsrKWZvcihsZXQgaD0wO2g8ci5sZW5ndGg7aCsrKW9baF1bYV09KDErdSkqcltoXVthXS8oMSt1Kk1hdGguYWJzKHJbaF1bYV0pKSpjO3JldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiZGlzdG9ydC1wcm9jZXNzb3IiLEF0KTtmdW5jdGlvbiB4dChuLHQsZSl7cmV0dXJuIGUqKHQtbikrbn1mdW5jdGlvbiBWdChuLHQsZSl7cmV0dXJuIG48Mj8wOnh0KC10Ki41LHQqLjUsZS8obi0xKSl9ZnVuY3Rpb24gdHQobix0KXtyZXR1cm4gbipNYXRoLnBvdygyLHQvMTIpfWNsYXNzIEZ0IGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29ye2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLnBoYXNlPVtdfXN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG1pbjowfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG1pbjowfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6InBhbnNwcmVhZCIsZGVmYXVsdFZhbHVlOi40LG1pbjowLG1heDoxfSx7bmFtZToiZnJlcXNwcmVhZCIsZGVmYXVsdFZhbHVlOi4yLG1pbjowfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46MH0se25hbWU6InZvaWNlcyIsZGVmYXVsdFZhbHVlOjUsbWluOjF9XX1wcm9jZXNzKHQsZSxzKXtpZihjdXJyZW50VGltZTw9cy5iZWdpblswXSlyZXR1cm4hMDtpZihjdXJyZW50VGltZT49cy5lbmRbMF0pcmV0dXJuITE7Y29uc3Qgcj1lWzBdLG89cy52b2ljZXNbMF0saT1zLmZyZXFzcHJlYWRbMF0sdT1zLnBhbnNwcmVhZFswXSouNSsuNSxjPU1hdGguc3FydCgxLXUpLGE9TWF0aC5zcXJ0KHUpO2ZvcihsZXQgaD0wO2g8bztoKyspe2NvbnN0IG09KGgmMSk9PTE7bGV0IHA9YyxsPWE7bSYmKHA9YSxsPWMpO2ZvcihsZXQgZj0wO2Y8clswXS5sZW5ndGg7ZisrKXtsZXQgZD10dChzLmZyZXF1ZW5jeVtmXT8/cy5mcmVxdWVuY3lbMF0scy5kZXR1bmVbMF0vMTAwKTtkPXR0KGQsVnQobyxpLGgpKTtjb25zdCB2PXB0KGQvc2FtcGxlUmF0ZSwxKTt0aGlzLnBoYXNlW2hdPXRoaXMucGhhc2VbaF0/P01hdGgucmFuZG9tKCk7Y29uc3QgZz1ydC5zYXdibGVwKHRoaXMucGhhc2VbaF0sdik7clswXVtmXT1yWzBdW2ZdK2cqcCxyWzFdW2ZdPXJbMV1bZl0rZypsLHRoaXMucGhhc2VbaF09YnQodGhpcy5waGFzZVtoXSt2KX19cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJzdXBlcnNhdy1vc2NpbGxhdG9yIixGdCk7Y29uc3QgTXQ9MjA0ODtmdW5jdGlvbiBPdChuKXtsZXQgdD1uZXcgRmxvYXQzMkFycmF5KG4pO2Zvcih2YXIgZT0wO2U8bjtlKyspdFtlXT0uNSooMS1NYXRoLmNvcygyKk1hdGguUEkqZS9uKSk7cmV0dXJuIHR9Y2xhc3MgTnQgZXh0ZW5kcyBndHtzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCl7cmV0dXJuW3tuYW1lOiJwaXRjaEZhY3RvciIsZGVmYXVsdFZhbHVlOjF9XX1jb25zdHJ1Y3Rvcih0KXt0LnByb2Nlc3Nvck9wdGlvbnM9e2Jsb2NrU2l6ZTpNdH0sc3VwZXIodCksdGhpcy5mZnRTaXplPXRoaXMuYmxvY2tTaXplLHRoaXMudGltZUN1cnNvcj0wLHRoaXMuaGFubldpbmRvdz1PdCh0aGlzLmJsb2NrU2l6ZSksdGhpcy5mZnQ9bmV3IEl0KHRoaXMuZmZ0U2l6ZSksdGhpcy5mcmVxQ29tcGxleEJ1ZmZlcj10aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKSx0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZD10aGlzLmZmdC5jcmVhdGVDb21wbGV4QXJyYXkoKSx0aGlzLnRpbWVDb21wbGV4QnVmZmVyPXRoaXMuZmZ0LmNyZWF0ZUNvbXBsZXhBcnJheSgpLHRoaXMubWFnbml0dWRlcz1uZXcgRmxvYXQzMkFycmF5KHRoaXMuZmZ0U2l6ZS8yKzEpLHRoaXMucGVha0luZGV4ZXM9bmV3IEludDMyQXJyYXkodGhpcy5tYWduaXR1ZGVzLmxlbmd0aCksdGhpcy5uYlBlYWtzPTB9cHJvY2Vzc09MQSh0LGUscyl7bGV0IHI9cy5waXRjaEZhY3RvcltzLnBpdGNoRmFjdG9yLmxlbmd0aC0xXTtyPDAmJihyPXIqLjI1KSxyPU1hdGgubWF4KDAscisxKTtmb3IodmFyIG89MDtvPHRoaXMubmJJbnB1dHM7bysrKWZvcih2YXIgaT0wO2k8dFtvXS5sZW5ndGg7aSsrKXt2YXIgdT10W29dW2ldLGM9ZVtvXVtpXTt0aGlzLmFwcGx5SGFubldpbmRvdyh1KSx0aGlzLmZmdC5yZWFsVHJhbnNmb3JtKHRoaXMuZnJlcUNvbXBsZXhCdWZmZXIsdSksdGhpcy5jb21wdXRlTWFnbml0dWRlcygpLHRoaXMuZmluZFBlYWtzKCksdGhpcy5zaGlmdFBlYWtzKHIpLHRoaXMuZmZ0LmNvbXBsZXRlU3BlY3RydW0odGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWQpLHRoaXMuZmZ0LmludmVyc2VUcmFuc2Zvcm0odGhpcy50aW1lQ29tcGxleEJ1ZmZlcix0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZCksdGhpcy5mZnQuZnJvbUNvbXBsZXhBcnJheSh0aGlzLnRpbWVDb21wbGV4QnVmZmVyLGMpLHRoaXMuYXBwbHlIYW5uV2luZG93KGMpfXRoaXMudGltZUN1cnNvcis9dGhpcy5ob3BTaXplfWFwcGx5SGFubldpbmRvdyh0KXtmb3IodmFyIGU9MDtlPHRoaXMuYmxvY2tTaXplO2UrKyl0W2VdPXRbZV0qdGhpcy5oYW5uV2luZG93W2VdKjEuNjJ9Y29tcHV0ZU1hZ25pdHVkZXMoKXtmb3IodmFyIHQ9MCxlPTA7dDx0aGlzLm1hZ25pdHVkZXMubGVuZ3RoOyl7bGV0IHM9dGhpcy5mcmVxQ29tcGxleEJ1ZmZlcltlXSxyPXRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbZSsxXTt0aGlzLm1hZ25pdHVkZXNbdF09cyoqMityKioyLHQrPTEsZSs9Mn19ZmluZFBlYWtzKCl7dGhpcy5uYlBlYWtzPTA7dmFyIHQ9MjtsZXQgZT10aGlzLm1hZ25pdHVkZXMubGVuZ3RoLTI7Zm9yKDt0PGU7KXtsZXQgcz10aGlzLm1hZ25pdHVkZXNbdF07aWYodGhpcy5tYWduaXR1ZGVzW3QtMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0LTJdPj1zKXt0Kys7Y29udGludWV9aWYodGhpcy5tYWduaXR1ZGVzW3QrMV0+PXN8fHRoaXMubWFnbml0dWRlc1t0KzJdPj1zKXt0Kys7Y29udGludWV9dGhpcy5wZWFrSW5kZXhlc1t0aGlzLm5iUGVha3NdPXQsdGhpcy5uYlBlYWtzKyssdCs9Mn19c2hpZnRQZWFrcyh0KXt0aGlzLmZyZXFDb21wbGV4QnVmZmVyU2hpZnRlZC5maWxsKDApO2Zvcih2YXIgZT0wO2U8dGhpcy5uYlBlYWtzO2UrKyl7bGV0IGk9dGhpcy5wZWFrSW5kZXhlc1tlXSx1PU1hdGgucm91bmQoaSp0KTtpZih1PnRoaXMubWFnbml0dWRlcy5sZW5ndGgpYnJlYWs7dmFyIHM9MCxyPXRoaXMuZmZ0U2l6ZTtpZihlPjApe2xldCBoPXRoaXMucGVha0luZGV4ZXNbZS0xXTtzPWktTWF0aC5mbG9vcigoaS1oKS8yKX1pZihlPHRoaXMubmJQZWFrcy0xKXtsZXQgaD10aGlzLnBlYWtJbmRleGVzW2UrMV07cj1pK01hdGguY2VpbCgoaC1pKS8yKX1sZXQgYz1zLWksYT1yLWk7Zm9yKHZhciBvPWM7bzxhO28rKyl7bGV0IGg9aStvLG09dStvO2lmKG0+PXRoaXMubWFnbml0dWRlcy5sZW5ndGgpYnJlYWs7bGV0IHA9MipNYXRoLlBJKihtLWgpL3RoaXMuZmZ0U2l6ZSxsPU1hdGguY29zKHAqdGhpcy50aW1lQ3Vyc29yKSxmPU1hdGguc2luKHAqdGhpcy50aW1lQ3Vyc29yKSxkPWgqMix2PWQrMSxnPXRoaXMuZnJlcUNvbXBsZXhCdWZmZXJbZF0sST10aGlzLmZyZXFDb21wbGV4QnVmZmVyW3ZdLGI9ZypsLUkqZixCPWcqZitJKmwsXz1tKjIsdz1fKzE7dGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWRbX10rPWIsdGhpcy5mcmVxQ29tcGxleEJ1ZmZlclNoaWZ0ZWRbd10rPUJ9fX19cmVnaXN0ZXJQcm9jZXNzb3IoInBoYXNlLXZvY29kZXItcHJvY2Vzc29yIixOdCk7Y2xhc3MgQ3QgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMucGk9ZHQsdGhpcy5waGk9LXRoaXMucGksdGhpcy5ZMD0wLHRoaXMuWTE9MCx0aGlzLlBXPXRoaXMucGksdGhpcy5CPTIuMyx0aGlzLmRwaGlmPTAsdGhpcy5lbnZmPTB9c3RhdGljIGdldCBwYXJhbWV0ZXJEZXNjcmlwdG9ycygpe3JldHVyblt7bmFtZToiYmVnaW4iLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJlbmQiLGRlZmF1bHRWYWx1ZTowLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksbWluOjB9LHtuYW1lOiJmcmVxdWVuY3kiLGRlZmF1bHRWYWx1ZTo0NDAsbWluOk51bWJlci5FUFNJTE9OfSx7bmFtZToiZGV0dW5lIixkZWZhdWx0VmFsdWU6MCxtaW46TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLG1heDpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9LHtuYW1lOiJwdWxzZXdpZHRoIixkZWZhdWx0VmFsdWU6MSxtaW46MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfV19cHJvY2Vzcyh0LGUscyl7aWYodGhpcy5kaXNjb25uZWN0ZWQpcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO2NvbnN0IHI9ZVswXTtsZXQgbz0xLGk7Zm9yKGxldCB1PTA7dTwoclswXS5sZW5ndGg/PzApO3UrKyl7Y29uc3QgYz0oMS1DKHEodSxzLnB1bHNld2lkdGgpLC0uOTksLjk5KSkqdGhpcy5waSxhPXEodSxzLmRldHVuZSksaD10dChxKHUscy5mcmVxdWVuY3kpLGEvMTAwKTtpPWgqKHRoaXMucGkvKHNhbXBsZVJhdGUqLjUpKSx0aGlzLmRwaGlmKz0uMSooaS10aGlzLmRwaGlmKSxvKj0uOTk5OCx0aGlzLmVudmYrPS4xKihvLXRoaXMuZW52ZiksdGhpcy5CPTIuMyooMS0xZS00KmgpLHRoaXMuQjwwJiYodGhpcy5CPTApLHRoaXMucGhpKz10aGlzLmRwaGlmLHRoaXMucGhpPj10aGlzLnBpJiYodGhpcy5waGktPTIqdGhpcy5waSk7bGV0IG09TWF0aC5jb3ModGhpcy5waGkrdGhpcy5CKnRoaXMuWTApO3RoaXMuWTA9LjUqKG0rdGhpcy5ZMCk7bGV0IHA9TWF0aC5jb3ModGhpcy5waGkrdGhpcy5CKnRoaXMuWTErYyk7dGhpcy5ZMT0uNSoocCt0aGlzLlkxKTtmb3IobGV0IGw9MDtsPHIubGVuZ3RoO2wrKylyW2xdW3VdPS4xNSoobS1wKSp0aGlzLmVudmZ9cmV0dXJuITB9fXJlZ2lzdGVyUHJvY2Vzc29yKCJwdWxzZS1vc2NpbGxhdG9yIixDdCk7Y29uc3QgbnQ9e2JpdEM6ZnVuY3Rpb24obix0LGUpe3JldHVybiBuJnQ/ZTowfSxicjpmdW5jdGlvbihuLHQ9OCl7aWYodD4zMil0aHJvdyBuZXcgRXJyb3IoImJyKCkgU2l6ZSBjYW5ub3QgYmUgZ3JlYXRlciB0aGFuIDMyIik7e2xldCBlPTA7Zm9yKGxldCBzPTA7czx0LTA7cysrKWUrPW50LmJpdEMobiwyKipzLDIqKih0LShzKzEpKSk7cmV0dXJuIGV9fSxzaW5mOmZ1bmN0aW9uKG4pe3JldHVybiBNYXRoLnNpbihuLygxMjgvTWF0aC5QSSkpfSxjb3NmOmZ1bmN0aW9uKG4pe3JldHVybiBNYXRoLmNvcyhuLygxMjgvTWF0aC5QSSkpfSx0YW5mOmZ1bmN0aW9uKG4pe3JldHVybiBNYXRoLnRhbihuLygxMjgvTWF0aC5QSSkpfSxyZWdHOmZ1bmN0aW9uKG4sdCl7cmV0dXJuIHQudGVzdChuLnRvU3RyaW5nKDIpKX19O2xldCBXLGV0O2Z1bmN0aW9uIGt0KG4pe2lmKChXfHxldCk9PW51bGwpe1c9T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTWF0aCksZXQ9Vy5tYXAocz0+TWF0aFtzXSk7Y29uc3QgdD1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhudCksZT10Lm1hcChzPT5udFtzXSk7Vy5wdXNoKCJpbnQiLCJ3aW5kb3ciLC4uLnQpLGV0LnB1c2goTWF0aC5mbG9vcixnbG9iYWxUaGlzLC4uLmUpfXJldHVybiBuZXcgRnVuY3Rpb24oLi4uVywidCIsYHJldHVybiAwLAoke258fDB9O2ApLmJpbmQoZ2xvYmFsVGhpcywuLi5ldCl9Y2xhc3MgenQgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3J7Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMucG9ydC5vbm1lc3NhZ2U9dD0+e2xldHtjb2RlVGV4dDplfT10LmRhdGE7Y29uc3R7Ynl0ZUJlYXRTdGFydFRpbWU6c309dC5kYXRhO3MhPW51bGwmJih0aGlzLnQ9MCx0aGlzLmluaXRpYWxPZmZzZXQ9TWF0aC5mbG9vcihzKSksZT1lLnRyaW0oKS5yZXBsYWNlKC9eZXZhbFwodW5lc2NhcGVcKGVzY2FwZSg/OmB8XCgnfFwoInxcKGApKC4qPykoPzpgfCdcKXwiXCl8YFwpKS5yZXBsYWNlXChcL3VcKFwuXC5cKVwvZyxbIidgXVwkMSVbIidgXVwpXClcKSQvLChyLG8pPT51bmVzY2FwZShlc2NhcGUobykucmVwbGFjZSgvdSguLikvZywiJDElIikpKSx0aGlzLmZ1bmM9a3QoZSl9LHRoaXMuaW5pdGlhbE9mZnNldD1udWxsLHRoaXMudD1udWxsLHRoaXMuZnVuYz1udWxsfXN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKXtyZXR1cm5be25hbWU6ImJlZ2luIixkZWZhdWx0VmFsdWU6MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG1pbjowfSx7bmFtZToiZnJlcXVlbmN5IixkZWZhdWx0VmFsdWU6NDQwLG1pbjpOdW1iZXIuRVBTSUxPTn0se25hbWU6ImRldHVuZSIsZGVmYXVsdFZhbHVlOjAsbWluOk51bWJlci5ORUdBVElWRV9JTkZJTklUWSxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfSx7bmFtZToiZW5kIixkZWZhdWx0VmFsdWU6MCxtYXg6TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG1pbjowfV19cHJvY2Vzcyh0LGUscyl7aWYodGhpcy5kaXNjb25uZWN0ZWQpcmV0dXJuITE7aWYoY3VycmVudFRpbWU8PXMuYmVnaW5bMF0pcmV0dXJuITA7aWYoY3VycmVudFRpbWU+PXMuZW5kWzBdKXJldHVybiExO3RoaXMudD09bnVsbCYmKHRoaXMudD1zLmJlZ2luWzBdKnNhbXBsZVJhdGUpO2NvbnN0IHI9ZVswXTtmb3IobGV0IG89MDtvPHJbMF0ubGVuZ3RoO28rKyl7Y29uc3QgaT1xKG8scy5kZXR1bmUpLHU9dHQocShvLHMuZnJlcXVlbmN5KSxpLzEwMCk7bGV0IGM9dGhpcy50LyhzYW1wbGVSYXRlLzI1NikqdSt0aGlzLmluaXRpYWxPZmZzZXQ7Y29uc3QgbT0oKHRoaXMuZnVuYyhjKSYyNTUpLzEyNy41LTEpKi4yO2ZvcihsZXQgcD0wO3A8ci5sZW5ndGg7cCsrKXJbcF1bb109QyhtLC0uNCwuNCk7dGhpcy50PXRoaXMudCsxfXJldHVybiEwfX1yZWdpc3RlclByb2Nlc3NvcigiYnl0ZS1iZWF0LXByb2Nlc3NvciIsenQpfSkoKTsK";let Rw={};function uZ(n,e){const t=Xn();if(Rw[n])return Rw[n];const s=2*t.sampleRate,r=t.createBuffer(1,s,t.sampleRate),a=r.getChannelData(0);let i=0,o,l,c,u,h,d,m;o=l=c=u=h=d=m=0;for(let y=0;y<s;y++)if(n==="white")a[y]=Math.random()*2-1;else if(n==="brown"){let O=Math.random()*2-1;a[y]=(i+.02*O)/1.02,i=a[y]}else if(n==="pink"){let O=Math.random()*2-1;o=.99886*o+O*.0555179,l=.99332*l+O*.0750759,c=.969*c+O*.153852,u=.8665*u+O*.3104856,h=.55*h+O*.5329522,d=-.7616*d-O*.016898,a[y]=o+l+c+u+h+d+m+O*.5362,a[y]*=.11,m=O*.115926}else if(n==="crackle"){const O=e*.01;Math.random()<O?a[y]=Math.random()*2-1:a[y]=0}return n!=="crackle"&&(Rw[n]=r),r}function Q2(n="white",e,t=.02){const s=Xn().createBufferSource();return s.buffer=uZ(n,t),s.loop=!0,s.start(e),{node:s,stop:r=>s.stop(r)}}function Z1e(n,e,t){const s=Q2("pink",t);return{node:dZ(n,s.node,e),stop:r=>s==null?void 0:s.stop(r)}}const RA=["pink","white","brown","crackle"];function Ia(n){const e=Xn().createGain();return e.gain.value=n,e}const mT=(n,e,t,s)=>s-t===0?0:(e-n)/(s-t);function No(n,e,t,s){const r=new AudioWorkletNode(n,e,s);return Object.entries(t).forEach(([a,i])=>{r.parameters.get(a).value=i}),r}const bl=(n,e,t,s,r,a,i,o,l,c="exponential")=>{e=hc(e),t=hc(t),s=hc(s),r=hc(r);const u=c==="exponential"?"exponentialRampToValueAtTime":"linearRampToValueAtTime";c==="exponential"&&(a=a===0?.001:a,i=i===0?.001:i);const h=i-a,d=i,m=a+s*h,y=l-o,O=S=>{let A;if(e>S){let F=mT(a,d,0,e);A=S*F+(a>d?a:0)}else A=(S-e)*mT(d,m,0,t)+d;return c==="exponential"&&(A=A||.001),A};n.setValueAtTime(a,o),e>y?n[u](O(y),l):e+t>y?(n[u](O(e),o+e),n[u](O(y),l)):(n[u](O(e),o+e),n[u](O(e+t),o+e+t),n.setValueAtTime(m,l)),n[u](a,l+r)};function hZ(n,e,t,s,r,a){const i={threshold:e??-3,ratio:t??10,knee:s??10,attack:r??.005,release:a??.05};return new DynamicsCompressorNode(n,i)}const yl=(n,e="linear",t)=>{const[s,r,a,i]=n;if(s==null&&r==null&&a==null&&i==null)return t??[.001,.001,1,.01];const o=a??(s!=null&&r==null||s==null&&r==null?1:.001);return[Math.max(s??0,.001),Math.max(r??0,.001),Math.min(o,1),Math.max(i??0,.01)]};function rb(n,e,t,s,r,a,i,o,l,c,u,h,d,m){const y="exponential",[O,S,A,F]=yl([r,a,i,o],y,[.005,.14,0,.1]);let j,N;if(d==="ladder"?(j=No(n,"ladder-processor",{frequency:t,q:s,drive:m}),N=j.parameters.get("frequency")):(j=n.createBiquadFilter(),j.type=e,j.Q.value=s,j.frequency.value=t,N=j.frequency),(r??a??i??o??l)!==void 0){l=hc(l,1,!0),h=hc(h,0,!0);const $=Math.abs(l),L=$*h;let I=Oh(2**-L*t,0,2e4),q=Oh(2**($-L)*t,0,2e4);return l<0&&([I,q]=[q,I]),bl(N,O,S,A,F,I,q,c,u,y),j}return j}let fT=n=>n<.5?1:1-(n-.5)/.5;function dZ(n,e,t=0){const s=Xn();if(!t)return n;let r=s.createGain(),a=s.createGain();n.connect(r),e.connect(a),r.gain.value=fT(t),a.gain.value=fT(1-t);let i=s.createGain();return r.connect(i),a.connect(i),i}let z1e=["linear","exponential"];function gf(n,e,t,s){if(!(e.pattack??e.pdecay??e.psustain??e.prelease??e.penv))return;const r=hc(e.penv,1,!0),a=z1e[e.pcurve??0];let[i,o,l,c]=yl([e.pattack,e.pdecay,e.psustain,e.prelease],a,[.2,.001,1,.001]),u=e.panchor??l;const h=r*100,d=0-h*u,m=h-h*u;bl(n,i,o,l,c,d,m,t,s,a)}function bf(n,e,t){const{vibmod:s=.5,vib:r}=e;let a;if(r>0){a=Xn().createOscillator(),a.frequency.value=r;const i=Xn().createGain();return i.gain.value=s*100,a.connect(i),i.connect(n),a.start(t),a}}function Nm(n,e,t,s){const r=new ConstantSourceNode(n),a=Ia(0);return a.connect(n.destination),r.connect(a),r.onended=()=>{try{a.disconnect()}catch{}try{r.disconnect()}catch{}e()},r.start(t),r.stop(s),r}const q1e=(n,e=1,t="sine")=>{const s=Xn();let r;RA.includes(t)?(r=s.createBufferSource(),r.buffer=uZ(t,2),r.loop=!0):(r=s.createOscillator(),r.type=t,r.frequency.value=n),r.start();const a=new GainNode(s,{gain:e});return r.connect(a),{node:a,stop:i=>r.stop(i)}},U1e=(n,e,t,s="sine")=>{const r=n.value*e,a=r*t;return q1e(r,a,s)};function Ny(n,e,t){const{fmh:s=1,fmi:r,fmenv:a="exp",fmattack:i,fmdecay:o,fmsustain:l,fmrelease:c,fmvelocity:u,fmwave:h="sine",duration:d}=e;let m,y=()=>{};if(r){const O=Xn().createGain(),S=U1e(n,s,r,h);if(m=S.node,y=S.stop,![i,o,l,c,u].some(A=>A!==void 0))m.connect(n);else{const[A,F,j,N]=yl([i,o,l,c]),$=t+d;bl(O.gain,A,F,j,N,0,1,t,$,a==="exp"?"exponential":"linear"),m.connect(O),O.connect(n)}}return{stop:y}}let So=[],Fc=0;const Jg=4;let pZ=n=>{let e=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(s){return t.lc=e.push(s),()=>{for(let a=Fc+Jg;a<So.length;)So[a]===s?So.splice(a,Jg):a+=Jg;let r=e.indexOf(s);~r&&(e.splice(r,1),--t.lc||t.off())}},notify(s,r){let a=!So.length;for(let i of e)So.push(i,t.value,s,r);if(a){for(Fc=0;Fc<So.length;Fc+=Jg)So[Fc](So[Fc+1],So[Fc+2],So[Fc+3]);So.length=0}},off(){},set(s){let r=t.value;r!==s&&(t.value=s,t.notify(r))},subscribe(s){let r=t.listen(s);return s(t.value),r},value:n};return t};const W1e=5,e0=6,t0=10;let G1e=(n,e,t,s)=>(n.events=n.events||{},n.events[t+t0]||(n.events[t+t0]=s(r=>{n.events[t].reduceRight((a,i)=>(i(a),a),{shared:{},...r})})),n.events[t]=n.events[t]||[],n.events[t].push(e),()=>{let r=n.events[t],a=r.indexOf(e);r.splice(a,1),r.length||(delete n.events[t],n.events[t+t0](),delete n.events[t+t0])}),X1e=1e3,H1e=(n,e)=>G1e(n,t=>{let s=e(t);s&&n.events[e0].push(s)},W1e,t=>{let s=n.listen;n.listen=(...a)=>(!n.lc&&!n.active&&(n.active=!0,t()),s(...a));let r=n.off;return n.events[e0]=[],n.off=()=>{r(),setTimeout(()=>{if(n.active&&!n.lc){n.active=!1;for(let a of n.events[e0])a();n.events[e0]=[]}},X1e)},()=>{n.listen=s,n.off=r}}),Y1e=(n={})=>{let e=pZ(n);return e.setKey=function(t,s){let r=e.value;typeof s>"u"&&t in e.value?(e.value={...e.value},delete e.value[t],e.notify(r,t)):e.value[t]!==s&&(e.value={...e.value,[t]:s},e.notify(r,t))},e};const IA={},Iw={},K1e=n=>IA[n];function J1e(n,e){var t=1024;if(n<t)return n+" B";var s=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=-1;do n/=t,++r;while(n>=t);return n.toFixed(1)+" "+s[r]}function mZ(n,e){const{s:t,n:s=0,speed:r=1}=n;let a=Q1e(n,36),i=a-36,o,l=0;if(Array.isArray(e))l=dT(s,e.length),o=e[l];else{const h=m=>Tv(m)-a,d=Object.keys(e).filter(m=>!m.startsWith("_")).reduce((m,y,O)=>!m||Math.abs(h(y))<Math.abs(h(m))?y:m,null);i=-h(d),l=dT(s,e[d].length),o=e[d][l]}const c=`${t}:${l}`;let u=Math.abs(r)*Math.pow(2,i/12);return{transpose:i,sampleUrl:o,index:l,midi:a,label:c,playbackRate:u}}const fZ=async(n,e,t)=>{let{sampleUrl:s,label:r,playbackRate:a}=mZ(n,e);t&&(s=await t(s));const i=Xn(),o=await LA(s,i,r);return n.unit==="c"&&(a=a*o.duration),{buffer:o,playbackRate:a}},gZ=async(n,e,t)=>{let{buffer:s,playbackRate:r}=await fZ(n,e,t);n.speed<0&&(s=bZ(s));const a=Xn().createBufferSource();a.buffer=s,a.playbackRate.value=r;const{s:i,loopBegin:o=0,loopEnd:l=1,begin:c=0,end:u=1}=n,h=c*a.buffer.duration;(i.startsWith("wt_")||n.loop)&&(a.loop=!0,a.loopStart=o*a.buffer.duration-h,a.loopEnd=l*a.buffer.duration-h);const d=a.buffer.duration/a.playbackRate.value,m=(u-c)*d;return{bufferSource:a,offset:h,bufferDuration:d,sliceDuration:m}},LA=(n,e,t,s=0)=>{const r=t?`sound "${t}:${s}"`:"sample";if(n=n.replace("#","%23"),!Iw[n]){Mi(`[sampler] load ${r}..`,"load-sample",{url:n});const a=Date.now();Iw[n]=fetch(n).then(i=>i.arrayBuffer()).then(async i=>{const o=Date.now()-a,l=J1e(i.byteLength);Mi(`[sampler] load ${r}... done! loaded ${l} in ${o}ms`,"loaded-sample",{url:n});const c=await e.decodeAudioData(i);return IA[n]=c,c})}return Iw[n]};function bZ(n){const e=Xn(),t=e.createBuffer(n.numberOfChannels,n.length,e.sampleRate);for(let s=0;s<n.numberOfChannels;s++)t.copyToChannel(n.getChannelData(s).slice().reverse(),s,s);return t}const eve=n=>IA[n];function yZ(n){if(n.startsWith("bubo:")){const[e,t]=n.split(":");n=`github:Bubobubobubobubo/dough-${t}`}return n}function vZ(n,e=""){if(!n.startsWith("github:"))throw new Error('expected "github:" at the start of pseudoUrl');let[t,s]=n.split("github:");return s=s.endsWith("/")?s.slice(0,-1):s,s.split("/").length===2&&(s+="/main"),`https://raw.githubusercontent.com/${s}/${e}`}const OZ=(n,e,t=n._base||"")=>Object.entries(n).forEach(([s,r])=>{if(typeof r=="string"&&(r=[r]),typeof r!="object")throw new Error("wrong sample map format for "+s);t=r._base||t,t=yZ(t),t.startsWith("github:")&&(t=vZ(t,""));const a=i=>t+i;Array.isArray(r)?r=r.map(a):r=Object.fromEntries(Object.entries(r).map(([i,o])=>[i,(typeof o=="string"?[o]:o).map(a)])),e(s,r)});let wZ={};function tve(n,e){wZ[n]=e}function nve(n){const e=Object.entries(wZ).find(([t])=>n.startsWith(t));if(e)return e[1]}const Ic=async(n,e=n._base||"",t={})=>{if(typeof n=="string"){const a=nve(n);if(a)return a(n);if(n=yZ(n),n.startsWith("github:")&&(n=vZ(n,"strudel.json")),n.startsWith("local:")&&(n="http://localhost:5432"),n.startsWith("shabda:")){let[o,l]=n.split("shabda:");n=`https://shabda.ndre.gr/${l}.json?strudel=1`}if(n.startsWith("shabda/speech")){let[o,l]=n.split("shabda/speech");l=l.startsWith("/")?l.substring(1):l;let[c,u]=l.split(":"),h="f",d="en-GB";c&&([d,h]=c.split("/")),n=`https://shabda.ndre.gr/speech/${u}.json?gender=${h}&language=${d}&strudel=1'`}if(typeof fetch!="function")return;const i=n.split("/").slice(0,-1).join("/");return typeof fetch>"u"?void 0:fetch(n).then(o=>o.json()).then(o=>Ic(o,e||o._base||i,t)).catch(o=>{throw console.error(o),new Error(`error loading "${n}"`)})}const{prebake:s,tag:r}=t;OZ(n,(a,i)=>ac(a,(o,l,c)=>xZ(o,l,c,i),{type:"sample",samples:i,baseUrl:e,prebake:s,tag:r}),e)},gT=[];async function xZ(n,e,t,s,r){let{s:a,nudge:i=0,cut:o,loop:l,clip:c=void 0,n:u=0,speed:h=1,duration:d}=e;if(h===0)return;const m=Xn();let[y,O,S,A]=yl([e.attack,e.decay,e.sustain,e.release]);const{bufferSource:F,sliceDuration:j,offset:N}=await gZ(e,s,r);if(m.currentTime>n){Mi(`[sampler] still loading sound "${a}:${u}"`,"highlight");return}if(!F){Mi(`[sampler] could not load "${a}:${u}"`,"error");return}let $=bf(F.detune,e,n);const L=n+i;F.start(L,N);const I=m.createGain(),q=F.connect(I);c==null&&l==null&&e.release==null&&(d=j);let ce=n+d;bl(q.gain,y,O,S,A,0,1,n,ce,"linear"),gf(F.detune,e,n,ce);const ee=m.createGain();q.connect(ee),F.onended=function(){F.disconnect(),$==null||$.stop(),q.disconnect(),ee.disconnect(),t()};let he=ce+A+.01;F.stop(he);const H={node:ee,bufferSource:F,stop:me=>{F.stop(me)}};if(o!==void 0){const me=gT[o];me&&(me.node.gain.setValueAtTime(1,L),me.node.gain.linearRampToValueAtTime(0,L+.01)),gT[o]=H}return H}const QA=128,j2="System Standard";let kZ=QA;function SZ(n){kZ=parseInt(n)??QA}let CZ=!1;function PZ(n){CZ=n==!0}function sve(n){return typeof n=="number"?n%5:{tri:0,triangle:0,sine:1,ramp:2,saw:3,square:4}[n]??0}const Ml=Y1e();function ac(n,e,t={}){n=n.toLowerCase().replace(/\s+/g,"_"),Ml.setKey(n,{onTrigger:e,data:t})}let AZ=n=>n;function sc(n){return AZ(n)}function rve(n){AZ=n}function V2(n){for(const t in n)n[t.toLowerCase()]=n[t];const e=Ml.get();for(const t in e){const[s,r]=t.split("_");if(!r)continue;const a=n[s];if(a){if(typeof a=="string")e[`${a}_${r}`.toLowerCase()]=e[t];else if(Array.isArray(a))for(const i of a)e[`${i}_${r}`.toLowerCase()]=e[t]}}Ml.set({...e})}async function ave(n){const e=await(await fetch(n)).json();V2(e)}async function EZ(...n){switch(n.length){case 1:return typeof n[0]=="string"?ave(n[0]):V2(n[0]);case 2:return V2({[n[0]]:n[1]});default:throw new Error("aliasMap expects 1 or 2 arguments, received "+n.length)}}function ab(n){return typeof n!="string"?(console.warn(`getSound: expected string got "${n}". fall back to triangle`),Ml.get().triangle):Ml.get()[n.toLowerCase()]}const MZ=async()=>{await navigator.mediaDevices.getUserMedia({audio:!0});let n=await navigator.mediaDevices.enumerateDevices();n=n.filter(t=>t.kind==="audiooutput"&&t.deviceId!=="default");const e=new Map;return e.set(j2,""),n.forEach(t=>{e.set(t.label,t.deviceId)}),e};let cg={s:"triangle",gain:.8,postgain:1,density:".03",ftype:"12db",fanchor:0,resonance:1,hresonance:1,bandq:1,channels:[1,2],phaserdepth:.75,shapevol:1,distortvol:1,delay:0,byteBeatExpression:"0",delayfeedback:.5,delaysync:3/16,orbit:1,i:1,velocity:1,fft:8};const ive=Object.freeze({...cg});function ove(n,e){cg[n]=e}function lve(){cg={...ive}}let jA=new Map(Object.entries(cg));function VA(n,e){jA.set(n,e)}function hr(n){return jA.get(n)}function cve(n){Object.keys(n).forEach(e=>{VA(e,n[e])})}function DZ(){jA=new Map(Object.entries(cg))}function uve(n){DZ(),n==="1.0"&&VA("fanchor",.5)}const hve=()=>Ml.set({});let Z2;const TZ=()=>(Z2=new AudioContext,Z2),Xn=()=>Z2||TZ();function dve(){return Xn().currentTime}let Lw;function pve(){return Lw||(Lw=Xn().audioWorklet.addModule(V1e)),Lw}async function BZ(n={}){const{disableWorklets:e=!1,maxPolyphony:t,audioDeviceName:s=j2,multiChannelOrbits:r=!1}=n;if(SZ(t),PZ(r),typeof window>"u")return;const a=Xn();if(s!=null&&s!=j2)try{const i=(await MZ()).get(s),o=(i??"").length>0;a.sinkId!==i&&o&&await a.setSinkId(i),Mi(`[superdough] Audio Device set to ${s}, it might take a few seconds before audio plays on all output channels`)}catch{Mi("[superdough] failed to set audio interface","warning")}if(await a.resume(),e){Mi("[superdough]: AudioWorklets disabled with disableWorklets");return}try{await pve(),Mi("[superdough] AudioWorklets loaded")}catch(i){console.warn("could not load AudioWorklet effects",i)}Mi("[superdough] ready")}let Qw;async function mve(n){return Qw||(Qw=new Promise(e=>{document.addEventListener("click",async function t(){document.removeEventListener("click",t),await BZ(n),e()})})),Qw}let _y,md;function FZ(){const n=Xn(),e=n.destination.maxChannelCount;n.destination.channelCount=e,_y=new ChannelMergerNode(n,{numberOfInputs:n.destination.channelCount}),md=new GainNode(n),_y.connect(md),md.connect(n.destination)}const $Z=(n,e=[0,1])=>{const t=Xn();_y==null&&FZ();const s=new StereoPannerNode(t);n.connect(s);const r=new ChannelSplitterNode(t,{numberOfOutputs:s.channelCount});s.connect(r),e.forEach((a,i)=>{r.connect(_y,i%s.channelCount,a%t.destination.channelCount)})},fve=()=>{md!=null&&(md.gain.linearRampToValueAtTime(0,Xn().currentTime+.01),md=null)};function gve(n,e,t,s){var r;if(t=Oh(t,0,.98),!ms[n].delayNode){const a=Xn().createFeedbackDelay(1,e,t);(r=a.start)==null||r.call(a,s),Ry(a,n),ms[n].delayNode=a}return ms[n].delayNode.delayTime.value!==e&&ms[n].delayNode.delayTime.setValueAtTime(e,s),ms[n].delayNode.feedback.value!==t&&ms[n].delayNode.feedback.setValueAtTime(t,s),ms[n].delayNode}function Bv(n,e,t,s={}){const{shape:r=0,...a}=s,{dcoffset:i=-.5,depth:o=1}=s,l={frequency:1,depth:o,skew:.5,phaseoffset:0,time:e,begin:e,end:t,shape:sve(r),dcoffset:i,min:i*o,max:i*o+o,curve:1,...a};return No(n,"lfo-processor",l)}function bve(n,e,t=1,s=.5,r=1e3,a=2e3){const i=Xn(),o=Bv(i,n,e,{frequency:t,depth:a*2}),l=2;let c=0;const u=[];for(let h=0;h<l;h++){const d=i.createBiquadFilter();d.type="notch",d.gain.value=1,d.frequency.value=r+c,d.Q.value=2-Math.min(Math.max(s*2,0),1.9),o.connect(d.detune),c+=282,h>0&&u[h-1].connect(d),u.push(d)}return u[u.length-1]}function yve(n){n=n??0;const e=["12db","ladder","24db"];return typeof n=="number"?e[Math.floor(cZ(n,e.length))]:n}let ms={};function Ry(n,e){ms[e]==null&&_A(new Error("target orbit does not exist"),"superdough"),n.connect(ms[e].gain)}function vve(n,e,t){ms[e]==null&&(ms[e]={gain:new GainNode(n,{gain:1,channelCount:2,channelCountMode:"explicit"})},$Z(ms[e].gain,t))}function Ove(n,e,t,s=.1,r=1){[e].flat().forEach(a=>{if(ms[a]==null){_A(new Error(`duck target orbit ${a} does not exist`),"superdough");return}Nm(n,()=>{ms[a].gain.gain.cancelScheduledValues(t);const i=ms[a].gain.gain.value;ms[a].gain.gain.linearRampToValueAtTime(Oh(1-Math.pow(r,.5),.01,i),t),ms[a].gain.gain.exponentialRampToValueAtTime(1,t+Math.max(.002,s))},0,t-.01)})}let Fh=(n,e)=>n!==void 0&&n!==e;function wve(n,e,t,s,r,a,i,o){if(!ms[n].reverbNode){const l=Xn().createReverb(e,t,s,r,a,i,o);Ry(l,n),ms[n].reverbNode=l}return(Fh(e,ms[n].reverbNode.duration)||Fh(t,ms[n].reverbNode.fade)||Fh(s,ms[n].reverbNode.lp)||Fh(r,ms[n].reverbNode.dim)||Fh(i,ms[n].reverbNode.irspeed)||Fh(o,ms[n].reverbNode.irbegin)||ms[n].reverbNode.ir!==a)&&ms[n].reverbNode.generate(e,t,s,r,a,i,o),ms[n].reverbNode}let ya={},ch={};function NZ(n,e=1024,t=.5){if(!ya[n]){const s=Xn().createAnalyser();s.fftSize=e,s.smoothingTimeConstant=t,ya[n]=s,ch[n]=new Float32Array(ya[n].frequencyBinCount)}return ya[n].fftSize!==e&&(ya[n].fftSize=e,ch[n]=new Float32Array(ya[n].frequencyBinCount)),ya[n]}function Fv(n="time",e=1){const t={time:()=>{var s;return(s=ya[e])==null?void 0:s.getFloatTimeDomainData(ch[e])},frequency:()=>{var s;return(s=ya[e])==null?void 0:s.getFloatFrequencyData(ch[e])}}[n];if(!t)throw new Error(`getAnalyzerData: ${n} not supported. use one of ${Object.keys(t).join(", ")}`);return t(),ch[e]}function jw(n,e,t){const s=Ia(t);return n.connect(s),s.connect(e),s}function xve(){ms={},ya={},ch={}}let zp=new Map;function bT(n){return(Array.isArray(n)?n:[n]).map(e=>e-1)}const ZA=async(n,e,t,s=.5,r=.5)=>{var Yn,Is,mn;const a=Xn();let{stretch:i}=n;if(i!=null&&(e=e-.04),typeof n!="object")throw new Error(`expected hap.value to be an object, but got "${n}". Hint: append .note() or .s() to the end`,"error");if(n.duration=t,e<a.currentTime){console.warn(`[superdough]: cannot schedule sounds in the past (target: ${e.toFixed(2)}, now: ${a.currentTime.toFixed(2)})`);return}let{tremolo:o,tremolosync:l,tremolodepth:c=1,tremoloskew:u,tremolophase:h=0,tremoloshape:d,s:m=hr("s"),bank:y,source:O,gain:S=hr("gain"),postgain:A=hr("postgain"),density:F=hr("density"),duckorbit:j,duckattack:N,duckdepth:$,fanchor:L=hr("fanchor"),drive:I=.69,release:q=0,cutoff:ce,lpenv:ee,lpattack:he,lpdecay:H,lpsustain:me,lprelease:Oe,resonance:Pe=hr("resonance"),hpenv:De,hcutoff:Se,hpattack:ae,hpdecay:Ee,hpsustain:Qe,hprelease:Ke,hresonance:ge=hr("hresonance"),bpenv:Ye,bandf:yt,bpattack:Xe,bpdecay:Ge,bpsustain:Ct,bprelease:Et,bandq:gn=hr("bandq"),phaserrate:On,phaserdepth:qn=hr("phaserdepth"),phasersweep:cn,phasercenter:un,coarse:Rt,crush:Kt,dry:Un,shape:Wn,shapevol:bn=hr("shapevol"),distort:rt,distortvol:Pn=hr("distortvol"),pan:pt,vowel:Vt,delay:Zt=hr("delay"),delayfeedback:_n=hr("delayfeedback"),delaysync:it=hr("delaysync"),delaytime:Ft,orbit:_e=hr("orbit"),room:Lt,roomfade:et,roomlp:is,roomdim:It,roomsize:Dn,ir:Cs,irspeed:Wt,irbegin:Pt,i:$t=hr("i"),velocity:xn=hr("velocity"),analyze:st,fft:Gt=hr("fft"),compressor:an,compressorRatio:vs,compressorKnee:Vn,compressorAttack:Hs,compressorRelease:Ys}=n;Ft=Ft??j1e(it,s);const w=bT(CZ&&_e>0?[_e*2-1,_e*2]:hr("channels")),_=n.channels!=null?bT(n.channels):w;vve(a,_e,_),j!=null&&Ove(a,j,e,N,$),S=sc(hc(S,1)),A=sc(A),bn=sc(bn),Pn=sc(Pn),Zt=sc(Zt),xn=sc(xn),c=sc(c),S*=xn;const B=e+t,R=B+q,Z=Math.round(Math.random()*1e6);for(let Jt=0;Jt<=zp.size-kZ;Jt++){const sn=zp.entries().next(),ps=sn.value[1],cr=sn.value[0],$i=e+.25;(Is=(Yn=ps==null?void 0:ps.node)==null?void 0:Yn.gain)==null||Is.linearRampToValueAtTime(0,$i),(mn=ps==null?void 0:ps.stop)==null||mn.call(ps,$i),zp.delete(cr)}let Y=[];if(["-","~","_"].includes(m))return;y&&m&&(m=`${y}_${m}`,n.s=m);let se;if(O)se=O(e,n,t,s);else if(ab(m)){const{onTrigger:Jt}=ab(m),sn=await Jt(e,n,()=>{Y.forEach(ps=>ps==null?void 0:ps.disconnect()),zp.delete(Z)});sn&&(se=sn.node,zp.set(Z,sn))}else throw new Error(`sound ${m} not found! Is it loaded?`);if(!se)return;if(a.currentTime>e){Mi("[webaudio] skip hap: still loading",a.currentTime-e);return}const te=[];te.push(se),i!==void 0&&te.push(No(a,"phase-vocoder-processor",{pitchFactor:i})),te.push(Ia(S));const be=yve(n.ftype);if(ce!==void 0){let Jt=()=>rb(a,"lowpass",ce,Pe,he,H,me,Oe,ee,e,B,L,be,I);te.push(Jt()),be==="24db"&&te.push(Jt())}if(Se!==void 0){let Jt=()=>rb(a,"highpass",Se,ge,ae,Ee,Qe,Ke,De,e,B,L);te.push(Jt()),be==="24db"&&te.push(Jt())}if(yt!==void 0){let Jt=()=>rb(a,"bandpass",yt,gn,Xe,Ge,Ct,Et,Ye,e,B,L);te.push(Jt()),be==="24db"&&te.push(Jt())}if(Vt!==void 0){const Jt=a.createVowelFilter(Vt);te.push(Jt)}if(Rt!==void 0&&te.push(No(a,"coarse-processor",{coarse:Rt})),Kt!==void 0&&te.push(No(a,"crush-processor",{crush:Kt})),Wn!==void 0&&te.push(No(a,"shape-processor",{shape:Wn,postgain:bn})),rt!==void 0&&te.push(No(a,"distort-processor",{distort:rt,postgain:Pn})),l!=null&&(o=s*l),o!==void 0){const Jt=Math.max(1-c,0),sn=new GainNode(a,{gain:Jt}),ps=r/s;Bv(a,e,R,{skew:u??(d!=null?.5:1),frequency:o,depth:c,time:ps,dcoffset:0,shape:d,phaseoffset:h,min:0,max:1,curve:1.5}).connect(sn.gain),te.push(sn)}if(an!==void 0&&te.push(hZ(a,an,vs,Vn,Hs,Ys)),pt!==void 0){const Jt=a.createStereoPanner();Jt.pan.value=2*pt-1,te.push(Jt)}if(On!==void 0&&qn>0){const Jt=bve(e,R,On,qn,un,cn);te.push(Jt)}const $e=new GainNode(a,{gain:A});te.push($e);let Re;if(Zt>0&&Ft>0&&_n>0){const Jt=gve(_e,Ft,_n,e);Re=jw($e,Jt,Zt),Y.push(Re)}let ut;if(Lt>0){let Jt;if(Cs!==void 0){let ps,cr=ab(Cs);Array.isArray(cr)?ps=cr.data.samples[$t%cr.data.samples.length]:typeof cr=="object"&&(ps=Object.values(cr.data.samples).flat()[$t%Object.values(cr.data.samples).length]),Jt=await LA(ps,a,Cs,0)}const sn=wve(_e,Dn,et,is,It,Jt,Wt,Pt);ut=jw($e,sn,Lt),Y.push(ut)}let on;if(st){const Jt=NZ(st,2**(Gt+5));on=jw($e,Jt,1),Y.push(on)}if(Un!=null){Un=sc(Un);const Jt=new GainNode(a,{gain:Un});te.push(Jt),Ry(Jt,_e)}else Ry($e,_e);te.slice(1).reduce((Jt,sn)=>Jt.connect(sn),te[0]),Y=Y.concat(te)},kve=(n,e,t,s)=>{ZA(e,n-t,e.duration/s,s)},hm=(n,e=36)=>{let{note:t,freq:s}=n;return t=t||e,typeof t=="string"&&(t=Tv(t)),!s&&typeof t=="number"&&(s=lZ(t)),Number(s)};function n0(n){var e;n!=null&&(n.disconnect(),(e=n.parameters.get("end"))==null||e.setValueAtTime(0,0))}const Sve=["triangle","square","sawtooth","sine"],Cve=[["tri","triangle"],["sqr","square"],["saw","sawtooth"],["sin","sine"]];function Pve(n,e){const t=n,s=new Float32Array(e);for(let r=0;r<e;r++){const a=r*2/e-1;s[r]=Math.tanh(a*t)}return s}function _Z(){[...Sve].forEach(n=>{ac(n,(e,t,s)=>{const[r,a,i,o]=yl([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]);let l=IZ(n,e,t),{node:c,stop:u,triggerRelease:h}=l;const d=Ia(.3),{duration:m}=t;c.onended=()=>{c.disconnect(),d.disconnect(),s()};const y=Ia(1);let O=c.connect(d).connect(y);const S=e+m;bl(O.gain,r,a,i,o,0,1,e,S,"linear");const A=S+o+.01;return h==null||h(A),u(A),{node:O,stop:F=>{u(F)}}},{type:"synth",prebake:!0})}),ac("sbd",(n,e,t)=>{const{duration:s,decay:r=.5,pdecay:a=.5,penv:i=36,clip:o}=e,l=Xn(),c=.02,u=1.2,h=.025,d=1,m=l.createOscillator();m.type="triangle",m.frequency.value=hm(e,29),m.detune.setValueAtTime(i*100,0),m.detune.setValueAtTime(i*100,n),m.detune.exponentialRampToValueAtTime(.001,n+a);const y=Ia(1);y.gain.setValueAtTime(1,n+c),y.gain.exponentialRampToValueAtTime(.001,n+c+r),m.start(n);const O=Q2("brown",n,2),S=Ia(1);S.gain.setValueAtTime(u,n),S.gain.exponentialRampToValueAtTime(.001,n+h);const A=new WaveShaperNode(l);A.curve=Pve(2,l.sampleRate);const F=Ia(d);m.onended=()=>{m.disconnect(),y.disconnect(),A.disconnect(),O.node.disconnect(),S.disconnect(),F.disconnect(),t()};const j=m.connect(A).connect(y).connect(F);O.node.connect(S).connect(F);let N=n+r+.01;return o!=null&&(N=Math.min(n+o*s,N)),F.gain.setValueAtTime(d,N-.01),F.gain.linearRampToValueAtTime(0,N),m.stop(N),O.stop(N),{node:j,stop:$=>{m.stop($)}}},{type:"synth",prebake:!0}),ac("supersaw",(n,e,t)=>{const s=Xn();let{duration:r,n:a,unison:i=5,spread:o=.6,detune:l}=e;l=l??a??.18;const c=hm(e),[u,h,d,m]=yl([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),y=n+r,O=y+m+.01,S=Oh(i,1,100);let A=S>1?Oh(o,0,1):0,F=No(s,"supersaw-oscillator",{frequency:c,begin:n,end:O,freqspread:l,voices:S,panspread:A},{outputChannelCount:[2]});const j=1/Math.sqrt(S);gf(F.parameters.get("detune"),e,n,y);const N=bf(F.parameters.get("detune"),e,n),$=Ny(F.parameters.get("frequency"),e,n);let L=Ia(1);L=F.connect(L),bl(L.gain,u,h,d,m,0,.3*j,n,y,"linear");let I=Nm(s,()=>{n0(F),L.disconnect(),t(),$==null||$.stop(),N==null||N.stop()},n,O);return{node:L,stop:q=>{I.stop(q)}}},{prebake:!0,type:"synth"}),ac("bytebeat",(n,e,t)=>{const s=["(t%255 >= t/255%255)*255","(t*(t*8%60 <= 300)|(-t)*(t*4%512 < 256))+t/400","t","t*(t >> 10^t)","t&128","t&t>>8","((t%255+t%128+t%64+t%32+t%16+t%127.8+t%64.8+t%32.8+t%16.8)/3)","((t%64+t%63.8+t%64.15+t%64.35+t%63.5)/1.25)","(t&(t>>7)-t)","(sin(t*PI/128)*127+127)","((t^t/2+t+64*(sin((t*PI/64)+(t*PI/32768))+64))%128*2)","((t^t/2+t+64*(cos >> 0))%127.85*2)","((t^t/2+t+64)%128*2)","(((t * .25)^(t * .25)/100+(t * .25))%128)*2","((t^t/2+t+64)%7 * 24)"],{n:r=0}=e,a=hm(e),{byteBeatExpression:i=s[r%s.length],byteBeatStartTime:o}=e,l=Xn();let{duration:c}=e;const[u,h,d,m]=yl([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),y=n+c,O=y+m+.01;let S=No(l,"byte-beat-processor",{frequency:a,begin:n,end:O},{outputChannelCount:[2]});S.port.postMessage({codeText:i,byteBeatStartTime:o,frequency:a});let A=Ia(1);A=S.connect(A),bl(A.gain,u,h,d,m,0,1,n,y,"linear");let F=Nm(l,()=>{n0(S),A.disconnect(),t()},n,O);return{node:A,stop:j=>{F.stop(j)}}},{prebake:!0,type:"synth"}),ac("pulse",(n,e,t)=>{const s=Xn();let{pwrate:r,pwsweep:a}=e;a==null&&(r!=null?a=.3:a=0),r==null&&a!=null&&(r=1);let{duration:i,pw:o=.5}=e;const l=hm(e),[c,u,h,d]=yl([e.attack,e.decay,e.sustain,e.release],"linear",[.001,.05,.6,.01]),m=n+i,y=m+d+.01;let O=No(s,"pulse-oscillator",{frequency:l,begin:n,end:y,pulsewidth:o},{outputChannelCount:[2]});gf(O.parameters.get("detune"),e,n,m);const S=bf(O.parameters.get("detune"),e,n),A=Ny(O.parameters.get("frequency"),e,n);let F=Ia(1);F=O.connect(F),bl(F.gain,c,u,h,d,0,1,n,m,"linear");let j;a!=0&&(j=Bv(s,n,y,{frequency:r,depth:a}),j.connect(O.parameters.get("pulsewidth")));let N=Nm(s,()=>{n0(O),n0(j),F.disconnect(),t(),A==null||A.stop(),S==null||S.stop()},n,y);return{node:F,stop:$=>{N.stop($)}}},{prebake:!0,type:"synth"}),[...RA].forEach(n=>{ac(n,(e,t,s)=>{const[r,a,i,o]=yl([t.attack,t.decay,t.sustain,t.release],"linear",[.001,.05,.6,.01]);let l,{density:c}=t;l=Q2(n,e,c);let{node:u,stop:h,triggerRelease:d}=l;const m=Ia(.3),{duration:y}=t;u.onended=()=>{u.disconnect(),m.disconnect(),s()};const O=Ia(1);let S=u.connect(m).connect(O);const A=e+y;bl(S.gain,r,a,i,o,0,1,e,A,"linear");const F=A+o+.01;return d==null||d(F),h(F),{node:S,stop:j=>{h(j)}}},{type:"synth",prebake:!0})}),Cve.forEach(([n,e])=>Ml.set({...Ml.get(),[n]:Ml.get()[e]}))}function RZ(n,e){const t=new Float32Array(n+1),s=new Float32Array(n+1),r=Xn(),a=r.createOscillator(),i={sawtooth:c=>[0,-1/c],square:c=>[0,c%2===0?0:1/c],triangle:c=>[c%2===0?0:1/(c*c),0]};if(!i[e])throw new Error(`unknown wave type ${e}`);t[0]=0,s[0]=0;let o=1;for(;o<=n;){const[c,u]=i[e](o);t[o]=c,s[o]=u,o++}const l=r.createPeriodicWave(t,s);return a.setPeriodicWave(l),a}function IZ(n,e,t){let{n:s,duration:r,noise:a=0}=t,i;!s||n==="sine"?(i=Xn().createOscillator(),i.type=n||"triangle"):i=RZ(s,n),i.frequency.value=hm(t),i.start(e);let o=bf(i.detune,t,e);gf(i.detune,t,e,e+r);const l=Ny(i.frequency,t,e);let c;return a&&(c=Z1e(i,a,e)),{node:(c==null?void 0:c.node)||i,stop:u=>{l.stop(u),o==null||o.stop(u),c==null||c.stop(u),i.stop(u)},triggerRelease:u=>{}}}function Ave(n=1,e=.05,t=220,s=0,r=0,a=.1,i=0,o=1,l=0,c=0,u=0,h=0,d=0,m=0,y=0,O=0,S=0,A=1,F=0,j=0){let N=Math.PI*2,$=Xn().sampleRate,L=Ee=>Ee>0?1:-1,I=l*=500*N/$/$,q=t*=(1+e*2*Math.random()-e)*N/$,ce=[],ee=0,he=0,H=0,me=1,Oe=0,Pe=0,De=0,Se,ae;for(s=s*$+9,F*=$,r*=$,a*=$,S*=$,c*=500*N/$**3,y*=N/$,u*=N/$,h*=$,d=d*$|0,ae=s+F+r+a+S|0;H<ae;ce[H++]=De)++Pe%(O*100|0)||(De=i?i>1?i>2?i>3?Math.sin((ee%N)**3):Math.max(Math.min(Math.tan(ee),1),-1):1-(2*ee/N%2+2)%2:1-4*Math.abs(Math.round(ee/N)-ee/N):Math.sin(ee),De=(d?1-j+j*Math.sin(N*H/d):1)*L(De)*Math.abs(De)**o*n*1*(H<s?H/s:H<s+F?1-(H-s)/F*(1-A):H<s+F+r?A:H<ae-S?(ae-H-S)/a*A:0),De=S?De/2+(S>H?0:(H<ae-S?1:(ae-H)/S)*ce[H-S|0]/2):De),Se=(t+=l+=c)*Math.cos(y*he++),ee+=Se-Se*m*(1-(Math.sin(H)+1)*1e9%2),me&&++me>h&&(t+=u,q+=u,me=0),d&&!(++Oe%d)&&(t=q,l=I,me||(me=1));return ce}const LZ=(n,e)=>{let{s:t,note:s=36,freq:r,zrand:a=0,attack:i=0,decay:o=0,sustain:l=.8,release:c=.1,curve:u=1,slide:h=0,deltaSlide:d=0,pitchJump:m=0,pitchJumpTime:y=0,lfo:O=0,znoise:S=0,zmod:A=0,zcrush:F=0,zdelay:j=0,tremolo:N=0,duration:$=.2,zzfx:L}=n;const I=Math.max($-i-o,0);typeof s=="string"&&(s=Tv(s)),!r&&typeof s=="number"&&(r=lZ(s)),t=t.replace("z_","");const q=["sine","triangle","sawtooth","tan","noise"].indexOf(t)||0;u=t==="square"?0:u;const ce=Ave(...L||[.25,a,r,i,I,c,q,u,h,d,m,y,O,S,A,F,j,l,o,N]),ee=Xn(),he=ee.createBuffer(1,ce.length,ee.sampleRate);he.getChannelData(0).set(ce);const H=Xn().createBufferSource();return H.buffer=he,H.start(e),{node:H}};function QZ(){["zzfx","z_sine","z_sawtooth","z_triangle","z_square","z_tan","z_noise"].forEach(n=>{ac(n,(e,t,s)=>{const{node:r}=LZ({s:n,...t},e);return r.onended=()=>{r.disconnect(),s()},{node:r,stop:()=>{}}},{type:"synth",prebake:!0})})}let qi;async function jZ(n,e){const t=`dsp-worklet-${Date.now()}`,s=`${e}
let __q = []; // trigger queue
class MyProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.t = 0;
    this.stopped = false;
    this.port.onmessage = (e) => {
      if(e.data==='stop') {
        this.stopped = true;
      } else if(e.data?.dough) {
        __q.push(e.data)
      } else {
        msg?.(e.data)
      }
    };
  }
  process(inputs, outputs, parameters) {
    const output = outputs[0];
    if(__q.length) {
      for(let i=0;i<__q.length;++i) {
        const deadline = __q[i].time-currentTime;
        if(deadline<=0) {
          trigger(__q[i].dough)
          __q.splice(i,1)
        }
      }
    }
    for (let i = 0; i < output[0].length; i++) {
      const out = dsp(this.t / sampleRate);
      output.forEach((channel) => {
        channel[i] = out;
      });
      this.t++;
    }
  return !this.stopped;
  }
}
registerProcessor('${t}', MyProcessor);
`,r=`data:text/javascript;base64,${btoa(s)}`;await n.audioWorklet.addModule(r);const a=new AudioWorkletNode(n,t);return{node:a,stop:()=>a.port.postMessage("stop")}}const VZ=()=>{var n;qi&&(qi==null||qi.stop(),(n=qi==null?void 0:qi.node)==null||n.disconnect())};typeof window<"u"&&window.addEventListener("message",n=>{var e;n.data==="strudel-stop"?VZ():(e=n.data)!=null&&e.dough&&(qi==null||qi.node.port.postMessage(n.data))});const Eve=async n=>{const e=Xn();VZ(),qi=await jZ(e,n),qi.node.connect(e.destination)};function ZZ(n,e,t,s){window.postMessage({time:s,dough:n.value,currentTime:e,duration:n.duration,cps:t})}const{Pattern:Mve,logger:Dve,repl:Tve}=uV;oZ(Dve);const Bve=n=>(n.ensureObjectValue(),n.value),zA=(n,e,t,s,r)=>{var a;return ZA(Bve(n),r,t,s,(a=n.whole)==null?void 0:a.begin.valueOf())};function Fve(n={}){return n={getTime:()=>Xn().currentTime,defaultOutput:zA,...n},Tve(n)}Mve.prototype.dough=function(){return this.onTrigger(ZZ,1)};function zZ(n,{align:e=!0,color:t="white",thickness:s=3,scale:r=.25,pos:a=.75,trigger:i=0,ctx:o=Ec(),id:l=1}={}){o.lineWidth=s,o.strokeStyle=t;let c=o.canvas;if(!n){o.beginPath();let O=a*c.height;o.moveTo(0,O),o.lineTo(c.width,O),o.stroke();return}const u=Fv("time",l);o.beginPath();const h=n.frequencyBinCount;let d=e?Array.from(u).findIndex((O,S,A)=>S&&A[S-1]>-i&&O<=-i):0;d=Math.max(d,0);const m=c.width*1/h;let y=0;for(let O=d;O<h;O++){const S=u[O]+1,A=(a-r*(S-1))*c.height;O===0?o.moveTo(y,A):o.lineTo(y,A),y+=m}o.stroke()}function qZ(n,{color:e="white",scale:t=.25,pos:s=.75,lean:r=.5,min:a=-150,max:i=0,ctx:o=Ec(),id:l=1}={}){if(!n){o.beginPath();let y=s*u.height;o.moveTo(0,y),o.lineTo(u.width,y),o.stroke();return}const c=Fv("frequency",l),u=o.canvas;o.fillStyle=e;const h=n.frequencyBinCount,d=u.width*1/h;let m=0;for(let y=0;y<h;y++){const O=vv((c[y]-a)/(i-a),0,1)*t,S=O*u.height,A=(s-O*r)*u.height;o.fillRect(m,A,Math.max(d,1),S),m+=d}}function UZ(n=0,e="0,0,0",t=Ec()){n?(t.fillStyle=`rgba(${e},${1-n})`,t.fillRect(0,0,t.canvas.width,t.canvas.height)):t.clearRect(0,0,t.canvas.width,t.canvas.height)}mt.prototype.fscope=function(n={}){let e=n.id??1;return this.analyze(e).draw(()=>{UZ(n.smear,"0,0,0",n.ctx),ya[e]&&qZ(ya[e],n)},{id:e})};mt.prototype.tscope=function(n={}){let e=n.id??1;return this.analyze(e).draw(t=>{var s,r;n.color=((r=(s=t[0])==null?void 0:s.value)==null?void 0:r.color)||mc().foreground,n.color,UZ(n.smear,"0,0,0",n.ctx),zZ(ya[e],n)},{id:e})};mt.prototype.scope=mt.prototype.tscope;let yT={};mt.prototype.spectrum=function(n={}){let e=n.id??1;return this.analyze(e).draw(t=>{var s,r;n.color=((r=(s=t[0])==null?void 0:s.value)==null?void 0:r.color)||yT[e]||mc().foreground,yT[e]=n.color,$ve(ya[e],n)},{id:e})};mt.prototype.scope=mt.prototype.tscope;const Vw=new Map;function $ve(n,{thickness:e=3,speed:t=1,min:s=-80,max:r=0,ctx:a=Ec(),id:i=1,color:o}={}){if(a.lineWidth=e,a.strokeStyle=o,!n)return;const l=t,c=Fv("frequency",i),u=a.canvas;a.fillStyle=o;const h=n.frequencyBinCount;let d=Vw.get(i)||a.getImageData(0,0,u.width,u.height);Vw.set(i,d),a.clearRect(0,0,a.canvas.width,a.canvas.height),a.putImageData(d,-l,0);let m=u.width-t;for(let y=0;y<h;y++){const O=vv((c[y]-s)/(r-s),0,1);a.globalAlpha=O;const S=Math.log(y+1)/Math.log(h)*u.height;a.fillRect(m,u.height-S,l,2)}Vw.set(i,a.getImageData(0,0,u.width,u.height))}const Nve=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_MAX_POLYPHONY:QA,aliasBank:EZ,get analysers(){return ya},get analysersData(){return ch},applyFM:Ny,applyGainCurve:sc,connectToDestination:$Z,createFilter:rb,dough:Eve,doughTrigger:ZZ,drawFrequencyScope:qZ,drawTimeScope:zZ,drywet:dZ,dspWorklet:jZ,errorLogger:_A,gainNode:Ia,getADSRValues:yl,getAnalyserById:NZ,getAnalyzerData:Fv,getAudioContext:Xn,getAudioContextCurrentTime:dve,getAudioDevices:MZ,getCachedBuffer:K1e,getCompressor:hZ,getDefaultValue:hr,getLfo:Bv,getLoadedBuffer:eve,getOscillator:IZ,getParamADSR:bl,getPitchEnvelope:gf,getSampleBuffer:fZ,getSampleBufferSource:gZ,getSampleInfo:mZ,getSound:ab,getVibratoOscillator:bf,getWorklet:No,getZZFX:LZ,initAudio:BZ,initAudioOnFirstClick:mve,initializeAudioOutput:FZ,loadBuffer:LA,logger:Mi,noises:RA,onTriggerSample:xZ,panic:fve,processSampleMap:OZ,registerSamplesPrefix:tve,registerSound:ac,registerSynthSounds:_Z,registerZZFXSounds:QZ,resetDefaultValues:DZ,resetDefaults:lve,resetGlobalEffects:xve,resetLoadedSounds:hve,reverseBuffer:bZ,samples:Ic,setDefault:ove,setDefaultAudioContext:TZ,setDefaultValue:VA,setDefaultValues:cve,setGainCurve:rve,setLogger:oZ,setMaxPolyphony:SZ,setMultiChannelOrbits:PZ,setVersionDefaults:uve,soundMap:Ml,superdough:ZA,superdoughTrigger:kve,waveformN:RZ,webAudioTimeout:Nm,webaudioOutput:zA,webaudioRepl:Fve},Symbol.toStringTag,{value:"Module"}));let z2=[],WZ=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?WZ:z2).push(t=t+n[e])})();function _ve(n){if(n<768)return!1;for(let e=0,t=z2.length;;){let s=e+t>>1;if(n<z2[s])t=s;else if(n>=WZ[s])e=s+1;else return!0;if(e==t)return!1}}function vT(n){return n>=127462&&n<=127487}const OT=8205;function Rve(n,e,t=!0,s=!0){return(t?GZ:Ive)(n,e,s)}function GZ(n,e,t){if(e==n.length)return e;e&&XZ(n.charCodeAt(e))&&HZ(n.charCodeAt(e-1))&&e--;let s=Zw(n,e);for(e+=wT(s);e<n.length;){let r=Zw(n,e);if(s==OT||r==OT||t&&_ve(r))e+=wT(r),s=r;else if(vT(r)){let a=0,i=e-2;for(;i>=0&&vT(Zw(n,i));)a++,i-=2;if(a%2==0)break;e+=2}else break}return e}function Ive(n,e,t){for(;e>0;){let s=GZ(n,e-2,t);if(s<e)return s;e--}return 0}function Zw(n,e){let t=n.charCodeAt(e);if(!HZ(t)||e+1==n.length)return t;let s=n.charCodeAt(e+1);return XZ(s)?(t-55296<<10)+(s-56320)+65536:t}function XZ(n){return n>=56320&&n<57344}function HZ(n){return n>=55296&&n<56320}function wT(n){return n<65536?1:2}class ts{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,s){[e,t]=Qd(this,e,t);let r=[];return this.decompose(0,e,r,2),s.length&&s.decompose(0,s.length,r,3),this.decompose(t,this.length,r,1),vl.from(r,this.length-(t-e)+s.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Qd(this,e,t);let s=[];return this.decompose(e,t,s,0),vl.from(s,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),s=this.length-this.scanIdentical(e,-1),r=new _m(this),a=new _m(e);for(let i=t,o=t;;){if(r.next(i),a.next(i),i=0,r.lineBreak!=a.lineBreak||r.done!=a.done||r.value!=a.value)return!1;if(o+=r.value.length,r.done||o>=s)return!0}}iter(e=1){return new _m(this,e)}iterRange(e,t=this.length){return new YZ(this,e,t)}iterLines(e,t){let s;if(e==null)s=this.iter();else{t==null&&(t=this.lines+1);let r=this.line(e).from;s=this.iterRange(r,Math.max(r,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new KZ(s)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?ts.empty:e.length<=32?new ir(e):vl.from(ir.split(e,[]))}}class ir extends ts{constructor(e,t=Lve(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,s,r){for(let a=0;;a++){let i=this.text[a],o=r+i.length;if((t?s:o)>=e)return new Qve(r,o,s,i);r=o+1,s++}}decompose(e,t,s,r){let a=e<=0&&t>=this.length?this:new ir(xT(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(r&1){let i=s.pop(),o=ib(a.text,i.text.slice(),0,a.length);if(o.length<=32)s.push(new ir(o,i.length+a.length));else{let l=o.length>>1;s.push(new ir(o.slice(0,l)),new ir(o.slice(l)))}}else s.push(a)}replace(e,t,s){if(!(s instanceof ir))return super.replace(e,t,s);[e,t]=Qd(this,e,t);let r=ib(this.text,ib(s.text,xT(this.text,0,e)),t),a=this.length+s.length-(t-e);return r.length<=32?new ir(r,a):vl.from(ir.split(r,[]),a)}sliceString(e,t=this.length,s=`
`){[e,t]=Qd(this,e,t);let r="";for(let a=0,i=0;a<=t&&i<this.text.length;i++){let o=this.text[i],l=a+o.length;a>e&&i&&(r+=s),e<l&&t>a&&(r+=o.slice(Math.max(0,e-a),t-a)),a=l+1}return r}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let s=[],r=-1;for(let a of e)s.push(a),r+=a.length+1,s.length==32&&(t.push(new ir(s,r)),s=[],r=-1);return r>-1&&t.push(new ir(s,r)),t}}class vl extends ts{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let s of e)this.lines+=s.lines}lineInner(e,t,s,r){for(let a=0;;a++){let i=this.children[a],o=r+i.length,l=s+i.lines-1;if((t?l:o)>=e)return i.lineInner(e,t,s,r);r=o+1,s=l+1}}decompose(e,t,s,r){for(let a=0,i=0;i<=t&&a<this.children.length;a++){let o=this.children[a],l=i+o.length;if(e<=l&&t>=i){let c=r&((i<=e?1:0)|(l>=t?2:0));i>=e&&l<=t&&!c?s.push(o):o.decompose(e-i,t-i,s,c)}i=l+1}}replace(e,t,s){if([e,t]=Qd(this,e,t),s.lines<this.lines)for(let r=0,a=0;r<this.children.length;r++){let i=this.children[r],o=a+i.length;if(e>=a&&t<=o){let l=i.replace(e-a,t-a,s),c=this.lines-i.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[r]=l,new vl(u,this.length-(t-e)+s.length)}return super.replace(a,o,l)}a=o+1}return super.replace(e,t,s)}sliceString(e,t=this.length,s=`
`){[e,t]=Qd(this,e,t);let r="";for(let a=0,i=0;a<this.children.length&&i<=t;a++){let o=this.children[a],l=i+o.length;i>e&&a&&(r+=s),e<l&&t>i&&(r+=o.sliceString(e-i,t-i,s)),i=l+1}return r}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof vl))return 0;let s=0,[r,a,i,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;r+=t,a+=t){if(r==i||a==o)return s;let l=this.children[r],c=e.children[a];if(l!=c)return s+l.scanIdentical(c,t);s+=l.length+1}}static from(e,t=e.reduce((s,r)=>s+r.length+1,-1)){let s=0;for(let m of e)s+=m.lines;if(s<32){let m=[];for(let y of e)y.flatten(m);return new ir(m,t)}let r=Math.max(32,s>>5),a=r<<1,i=r>>1,o=[],l=0,c=-1,u=[];function h(m){let y;if(m.lines>a&&m instanceof vl)for(let O of m.children)h(O);else m.lines>i&&(l>i||!l)?(d(),o.push(m)):m instanceof ir&&l&&(y=u[u.length-1])instanceof ir&&m.lines+y.lines<=32?(l+=m.lines,c+=m.length+1,u[u.length-1]=new ir(y.text.concat(m.text),y.length+1+m.length)):(l+m.lines>r&&d(),l+=m.lines,c+=m.length+1,u.push(m))}function d(){l!=0&&(o.push(u.length==1?u[0]:vl.from(u,c)),c=-1,l=u.length=0)}for(let m of e)h(m);return d(),o.length==1?o[0]:new vl(o,t)}}ts.empty=new ir([""],0);function Lve(n){let e=-1;for(let t of n)e+=t.length+1;return e}function ib(n,e,t=0,s=1e9){for(let r=0,a=0,i=!0;a<n.length&&r<=s;a++){let o=n[a],l=r+o.length;l>=t&&(l>s&&(o=o.slice(0,s-r)),r<t&&(o=o.slice(t-r)),i?(e[e.length-1]+=o,i=!1):e.push(o)),r=l+1}return e}function xT(n,e,t){return ib(n,[""],e,t)}class _m{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof ir?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let s=this.nodes.length-1,r=this.nodes[s],a=this.offsets[s],i=a>>1,o=r instanceof ir?r.text.length:r.children.length;if(i==(t>0?o:0)){if(s==0)return this.done=!0,this.value="",this;t>0&&this.offsets[s-1]++,this.nodes.pop(),this.offsets.pop()}else if((a&1)==(t>0?0:1)){if(this.offsets[s]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(r instanceof ir){let l=r.text[i+(t<0?-1:0)];if(this.offsets[s]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=r.children[i+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[s]+=t):(t<0&&this.offsets[s]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof ir?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class YZ{constructor(e,t,s){this.value="",this.done=!1,this.cursor=new _m(e,t>s?-1:1),this.pos=t>s?e.length:0,this.from=Math.min(t,s),this.to=Math.max(t,s)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let s=t<0?this.pos-this.from:this.to-this.pos;e>s&&(e=s),s-=e;let{value:r}=this.cursor.next(e);return this.pos+=(r.length+e)*t,this.value=r.length<=s?r:t<0?r.slice(r.length-s):r.slice(0,s),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class KZ{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:s,value:r}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):s?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=r,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(ts.prototype[Symbol.iterator]=function(){return this.iter()},_m.prototype[Symbol.iterator]=YZ.prototype[Symbol.iterator]=KZ.prototype[Symbol.iterator]=function(){return this});class Qve{constructor(e,t,s,r){this.from=e,this.to=t,this.number=s,this.text=r}get length(){return this.to-this.from}}function Qd(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function qr(n,e,t=!0,s=!0){return Rve(n,e,t,s)}function jve(n){return n>=56320&&n<57344}function Vve(n){return n>=55296&&n<56320}function Ya(n,e){let t=n.charCodeAt(e);if(!Vve(t)||e+1==n.length)return t;let s=n.charCodeAt(e+1);return jve(s)?(t-55296<<10)+(s-56320)+65536:t}function qA(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Ol(n){return n<65536?1:2}const q2=/\r\n?|\n/;var mr=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(mr||(mr={}));class Dl{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let s=this.sections[t+1];e+=s<0?this.sections[t]:s}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,s=0,r=0;t<this.sections.length;){let a=this.sections[t++],i=this.sections[t++];i<0?(e(s,r,a),r+=a):r+=i,s+=a}}iterChangedRanges(e,t=!1){U2(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let s=this.sections[t++],r=this.sections[t++];r<0?e.push(s,r):e.push(r,s)}return new Dl(e)}composeDesc(e){return this.empty?e:e.empty?this:JZ(this,e)}mapDesc(e,t=!1){return e.empty?this:W2(this,e,t)}mapPos(e,t=-1,s=mr.Simple){let r=0,a=0;for(let i=0;i<this.sections.length;){let o=this.sections[i++],l=this.sections[i++],c=r+o;if(l<0){if(c>e)return a+(e-r);a+=o}else{if(s!=mr.Simple&&c>=e&&(s==mr.TrackDel&&r<e&&c>e||s==mr.TrackBefore&&r<e||s==mr.TrackAfter&&c>e))return null;if(c>e||c==e&&t<0&&!o)return e==r||t<0?a:a+l;a+=l}r=c}if(e>r)throw new RangeError(`Position ${e} is out of range for changeset of length ${r}`);return a}touchesRange(e,t=e){for(let s=0,r=0;s<this.sections.length&&r<=t;){let a=this.sections[s++],i=this.sections[s++],o=r+a;if(i>=0&&r<=t&&o>=e)return r<e&&o>t?"cover":!0;r=o}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let s=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+s+(r>=0?":"+r:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Dl(e)}static create(e){return new Dl(e)}}class kr extends Dl{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return U2(this,(t,s,r,a,i)=>e=e.replace(r,r+(s-t),i),!1),e}mapDesc(e,t=!1){return W2(this,e,t,!0)}invert(e){let t=this.sections.slice(),s=[];for(let r=0,a=0;r<t.length;r+=2){let i=t[r],o=t[r+1];if(o>=0){t[r]=o,t[r+1]=i;let l=r>>1;for(;s.length<l;)s.push(ts.empty);s.push(i?e.slice(a,a+i):ts.empty)}a+=i}return new kr(t,s)}compose(e){return this.empty?e:e.empty?this:JZ(this,e,!0)}map(e,t=!1){return e.empty?this:W2(this,e,t,!0)}iterChanges(e,t=!1){U2(this,e,t)}get desc(){return Dl.create(this.sections)}filter(e){let t=[],s=[],r=[],a=new yf(this);e:for(let i=0,o=0;;){let l=i==e.length?1e9:e[i++];for(;o<l||o==l&&a.len==0;){if(a.done)break e;let u=Math.min(a.len,l-o);ra(r,u,-1);let h=a.ins==-1?-1:a.off==0?a.ins:0;ra(t,u,h),h>0&&Gc(s,t,a.text),a.forward(u),o+=u}let c=e[i++];for(;o<c;){if(a.done)break e;let u=Math.min(a.len,c-o);ra(t,u,-1),ra(r,u,a.ins==-1?-1:a.off==0?a.ins:0),a.forward(u),o+=u}}return{changes:new kr(t,s),filtered:Dl.create(r)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let s=this.sections[t],r=this.sections[t+1];r<0?e.push(s):r==0?e.push([s]):e.push([s].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,s){let r=[],a=[],i=0,o=null;function l(u=!1){if(!u&&!r.length)return;i<t&&ra(r,t-i,-1);let h=new kr(r,a);o=o?o.compose(h.map(o)):h,r=[],a=[],i=0}function c(u){if(Array.isArray(u))for(let h of u)c(h);else if(u instanceof kr){if(u.length!=t)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${t})`);l(),o=o?o.compose(u.map(o)):u}else{let{from:h,to:d=h,insert:m}=u;if(h>d||h<0||d>t)throw new RangeError(`Invalid change range ${h} to ${d} (in doc of length ${t})`);let y=m?typeof m=="string"?ts.of(m.split(s||q2)):m:ts.empty,O=y.length;if(h==d&&O==0)return;h<i&&l(),h>i&&ra(r,h-i,-1),ra(r,d-h,O),Gc(a,r,y),i=d}}return c(e),l(!o),o}static empty(e){return new kr(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],s=[];for(let r=0;r<e.length;r++){let a=e[r];if(typeof a=="number")t.push(a,-1);else{if(!Array.isArray(a)||typeof a[0]!="number"||a.some((i,o)=>o&&typeof i!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(a.length==1)t.push(a[0],0);else{for(;s.length<r;)s.push(ts.empty);s[r]=ts.of(a.slice(1)),t.push(a[0],s[r].length)}}}return new kr(t,s)}static createSet(e,t){return new kr(e,t)}}function ra(n,e,t,s=!1){if(e==0&&t<=0)return;let r=n.length-2;r>=0&&t<=0&&t==n[r+1]?n[r]+=e:r>=0&&e==0&&n[r]==0?n[r+1]+=t:s?(n[r]+=e,n[r+1]+=t):n.push(e,t)}function Gc(n,e,t){if(t.length==0)return;let s=e.length-2>>1;if(s<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<s;)n.push(ts.empty);n.push(t)}}function U2(n,e,t){let s=n.inserted;for(let r=0,a=0,i=0;i<n.sections.length;){let o=n.sections[i++],l=n.sections[i++];if(l<0)r+=o,a+=o;else{let c=r,u=a,h=ts.empty;for(;c+=o,u+=l,l&&s&&(h=h.append(s[i-2>>1])),!(t||i==n.sections.length||n.sections[i+1]<0);)o=n.sections[i++],l=n.sections[i++];e(r,c,a,u,h),r=c,a=u}}}function W2(n,e,t,s=!1){let r=[],a=s?[]:null,i=new yf(n),o=new yf(e);for(let l=-1;;){if(i.done&&o.len||o.done&&i.len)throw new Error("Mismatched change set lengths");if(i.ins==-1&&o.ins==-1){let c=Math.min(i.len,o.len);ra(r,c,-1),i.forward(c),o.forward(c)}else if(o.ins>=0&&(i.ins<0||l==i.i||i.off==0&&(o.len<i.len||o.len==i.len&&!t))){let c=o.len;for(ra(r,o.ins,-1);c;){let u=Math.min(i.len,c);i.ins>=0&&l<i.i&&i.len<=u&&(ra(r,0,i.ins),a&&Gc(a,r,i.text),l=i.i),i.forward(u),c-=u}o.next()}else if(i.ins>=0){let c=0,u=i.len;for(;u;)if(o.ins==-1){let h=Math.min(u,o.len);c+=h,u-=h,o.forward(h)}else if(o.ins==0&&o.len<u)u-=o.len,o.next();else break;ra(r,c,l<i.i?i.ins:0),a&&l<i.i&&Gc(a,r,i.text),l=i.i,i.forward(i.len-u)}else{if(i.done&&o.done)return a?kr.createSet(r,a):Dl.create(r);throw new Error("Mismatched change set lengths")}}}function JZ(n,e,t=!1){let s=[],r=t?[]:null,a=new yf(n),i=new yf(e);for(let o=!1;;){if(a.done&&i.done)return r?kr.createSet(s,r):Dl.create(s);if(a.ins==0)ra(s,a.len,0,o),a.next();else if(i.len==0&&!i.done)ra(s,0,i.ins,o),r&&Gc(r,s,i.text),i.next();else{if(a.done||i.done)throw new Error("Mismatched change set lengths");{let l=Math.min(a.len2,i.len),c=s.length;if(a.ins==-1){let u=i.ins==-1?-1:i.off?0:i.ins;ra(s,l,u,o),r&&u&&Gc(r,s,i.text)}else i.ins==-1?(ra(s,a.off?0:a.len,l,o),r&&Gc(r,s,a.textBit(l))):(ra(s,a.off?0:a.len,i.off?0:i.ins,o),r&&!i.off&&Gc(r,s,i.text));o=(a.ins>l||i.ins>=0&&i.len>l)&&(o||s.length>c),a.forward2(l),i.forward(l)}}}}class yf{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?ts.empty:e[t]}textBit(e){let{inserted:t}=this.set,s=this.i-2>>1;return s>=t.length&&!e?ts.empty:t[s].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class eh{constructor(e,t,s){this.from=e,this.to=t,this.flags=s}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let s,r;return this.empty?s=r=e.mapPos(this.from,t):(s=e.mapPos(this.from,1),r=e.mapPos(this.to,-1)),s==this.from&&r==this.to?this:new eh(s,r,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return Ve.range(e,t);let s=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Ve.range(this.anchor,s)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Ve.range(e.anchor,e.head)}static create(e,t,s){return new eh(e,t,s)}}class Ve{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:Ve.create(this.ranges.map(s=>s.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let s=0;s<this.ranges.length;s++)if(!this.ranges[s].eq(e.ranges[s],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Ve([this.main],0)}addRange(e,t=!0){return Ve.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let s=this.ranges.slice();return s[t]=e,Ve.create(s,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Ve(e.ranges.map(t=>eh.fromJSON(t)),e.main)}static single(e,t=e){return new Ve([Ve.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let s=0,r=0;r<e.length;r++){let a=e[r];if(a.empty?a.from<=s:a.from<s)return Ve.normalized(e.slice(),t);s=a.to}return new Ve(e,t)}static cursor(e,t=0,s,r){return eh.create(e,e,(t==0?0:t<0?8:16)|(s==null?7:Math.min(6,s))|(r??16777215)<<6)}static range(e,t,s,r){let a=(s??16777215)<<6|(r==null?7:Math.min(6,r));return t<e?eh.create(t,e,48|a):eh.create(e,t,(t>e?8:0)|a)}static normalized(e,t=0){let s=e[t];e.sort((r,a)=>r.from-a.from),t=e.indexOf(s);for(let r=1;r<e.length;r++){let a=e[r],i=e[r-1];if(a.empty?a.from<=i.to:a.from<i.to){let o=i.from,l=Math.max(a.to,i.to);r<=t&&t--,e.splice(--r,2,a.anchor>a.head?Ve.range(l,o):Ve.range(o,l))}}return new Ve(e,t)}}function ez(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let UA=0;class _t{constructor(e,t,s,r,a){this.combine=e,this.compareInput=t,this.compare=s,this.isStatic=r,this.id=UA++,this.default=e([]),this.extensions=typeof a=="function"?a(this):a}get reader(){return this}static define(e={}){return new _t(e.combine||(t=>t),e.compareInput||((t,s)=>t===s),e.compare||(e.combine?(t,s)=>t===s:WA),!!e.static,e.enables)}of(e){return new ob([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ob(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ob(e,this,2,t)}from(e,t){return t||(t=s=>s),this.compute([e],s=>t(s.field(e)))}}function WA(n,e){return n==e||n.length==e.length&&n.every((t,s)=>t===e[s])}class ob{constructor(e,t,s,r){this.dependencies=e,this.facet=t,this.type=s,this.value=r,this.id=UA++}dynamicSlot(e){var t;let s=this.value,r=this.facet.compareInput,a=this.id,i=e[a]>>1,o=this.type==2,l=!1,c=!1,u=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?c=!0:((t=e[h.id])!==null&&t!==void 0?t:1)&1||u.push(e[h.id]);return{create(h){return h.values[i]=s(h),1},update(h,d){if(l&&d.docChanged||c&&(d.docChanged||d.selection)||G2(h,u)){let m=s(h);if(o?!kT(m,h.values[i],r):!r(m,h.values[i]))return h.values[i]=m,1}return 0},reconfigure:(h,d)=>{let m,y=d.config.address[a];if(y!=null){let O=Ly(d,y);if(this.dependencies.every(S=>S instanceof _t?d.facet(S)===h.facet(S):S instanceof Us?d.field(S,!1)==h.field(S,!1):!0)||(o?kT(m=s(h),O,r):r(m=s(h),O)))return h.values[i]=O,0}else m=s(h);return h.values[i]=m,1}}}}function kT(n,e,t){if(n.length!=e.length)return!1;for(let s=0;s<n.length;s++)if(!t(n[s],e[s]))return!1;return!0}function G2(n,e){let t=!1;for(let s of e)Rm(n,s)&1&&(t=!0);return t}function Zve(n,e,t){let s=t.map(l=>n[l.id]),r=t.map(l=>l.type),a=s.filter(l=>!(l&1)),i=n[e.id]>>1;function o(l){let c=[];for(let u=0;u<s.length;u++){let h=Ly(l,s[u]);if(r[u]==2)for(let d of h)c.push(d);else c.push(h)}return e.combine(c)}return{create(l){for(let c of s)Rm(l,c);return l.values[i]=o(l),1},update(l,c){if(!G2(l,a))return 0;let u=o(l);return e.compare(u,l.values[i])?0:(l.values[i]=u,1)},reconfigure(l,c){let u=G2(l,s),h=c.config.facets[e.id],d=c.facet(e);if(h&&!u&&WA(t,h))return l.values[i]=d,0;let m=o(l);return e.compare(m,d)?(l.values[i]=d,0):(l.values[i]=m,1)}}}const ST=_t.define({static:!0});class Us{constructor(e,t,s,r,a){this.id=e,this.createF=t,this.updateF=s,this.compareF=r,this.spec=a,this.provides=void 0}static define(e){let t=new Us(UA++,e.create,e.update,e.compare||((s,r)=>s===r),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(ST).find(s=>s.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:s=>(s.values[t]=this.create(s),1),update:(s,r)=>{let a=s.values[t],i=this.updateF(a,r);return this.compareF(a,i)?0:(s.values[t]=i,1)},reconfigure:(s,r)=>r.config.address[this.id]!=null?(s.values[t]=r.field(this),0):(s.values[t]=this.create(s),1)}}init(e){return[this,ST.of({field:this,create:e})]}get extension(){return this}}const qu={lowest:4,low:3,default:2,high:1,highest:0};function qp(n){return e=>new tz(e,n)}const ui={highest:qp(qu.highest),high:qp(qu.high),default:qp(qu.default),low:qp(qu.low),lowest:qp(qu.lowest)};class tz{constructor(e,t){this.inner=e,this.prec=t}}class ug{of(e){return new X2(this,e)}reconfigure(e){return ug.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class X2{constructor(e,t){this.compartment=e,this.inner=t}}class Iy{constructor(e,t,s,r,a,i){for(this.base=e,this.compartments=t,this.dynamicSlots=s,this.address=r,this.staticValues=a,this.facets=i,this.statusTemplate=[];this.statusTemplate.length<s.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,s){let r=[],a=Object.create(null),i=new Map;for(let d of zve(e,t,i))d instanceof Us?r.push(d):(a[d.facet.id]||(a[d.facet.id]=[])).push(d);let o=Object.create(null),l=[],c=[];for(let d of r)o[d.id]=c.length<<1,c.push(m=>d.slot(m));let u=s==null?void 0:s.config.facets;for(let d in a){let m=a[d],y=m[0].facet,O=u&&u[d]||[];if(m.every(S=>S.type==0))if(o[y.id]=l.length<<1|1,WA(O,m))l.push(s.facet(y));else{let S=y.combine(m.map(A=>A.value));l.push(s&&y.compare(S,s.facet(y))?s.facet(y):S)}else{for(let S of m)S.type==0?(o[S.id]=l.length<<1|1,l.push(S.value)):(o[S.id]=c.length<<1,c.push(A=>S.dynamicSlot(A)));o[y.id]=c.length<<1,c.push(S=>Zve(S,y,m))}}let h=c.map(d=>d(o));return new Iy(e,i,h,o,l,a)}}function zve(n,e,t){let s=[[],[],[],[],[]],r=new Map;function a(i,o){let l=r.get(i);if(l!=null){if(l<=o)return;let c=s[l].indexOf(i);c>-1&&s[l].splice(c,1),i instanceof X2&&t.delete(i.compartment)}if(r.set(i,o),Array.isArray(i))for(let c of i)a(c,o);else if(i instanceof X2){if(t.has(i.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(i.compartment)||i.inner;t.set(i.compartment,c),a(c,o)}else if(i instanceof tz)a(i.inner,i.prec);else if(i instanceof Us)s[o].push(i),i.provides&&a(i.provides,o);else if(i instanceof ob)s[o].push(i),i.facet.extensions&&a(i.facet.extensions,qu.default);else{let c=i.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${i}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);a(c,o)}}return a(n,qu.default),s.reduce((i,o)=>i.concat(o))}function Rm(n,e){if(e&1)return 2;let t=e>>1,s=n.status[t];if(s==4)throw new Error("Cyclic dependency between fields and/or facets");if(s&2)return s;n.status[t]=4;let r=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|r}function Ly(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const nz=_t.define(),H2=_t.define({combine:n=>n.some(e=>e),static:!0}),sz=_t.define({combine:n=>n.length?n[0]:void 0,static:!0}),rz=_t.define(),az=_t.define(),iz=_t.define(),oz=_t.define({combine:n=>n.length?n[0]:!1});class Dc{constructor(e,t){this.type=e,this.value=t}static define(){return new qve}}class qve{of(e){return new Dc(this,e)}}class Uve{constructor(e){this.map=e}of(e){return new ln(this,e)}}class ln{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new ln(this.type,t)}is(e){return this.type==e}static define(e={}){return new Uve(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let s=[];for(let r of e){let a=r.map(t);a&&s.push(a)}return s}}ln.reconfigure=ln.define();ln.appendConfig=ln.define();let Sa=class dm{constructor(e,t,s,r,a,i){this.startState=e,this.changes=t,this.selection=s,this.effects=r,this.annotations=a,this.scrollIntoView=i,this._doc=null,this._state=null,s&&ez(s,t.newLength),a.some(o=>o.type==dm.time)||(this.annotations=a.concat(dm.time.of(Date.now())))}static create(e,t,s,r,a,i){return new dm(e,t,s,r,a,i)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(dm.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}};Sa.time=Dc.define();Sa.userEvent=Dc.define();Sa.addToHistory=Dc.define();Sa.remote=Dc.define();function Wve(n,e){let t=[];for(let s=0,r=0;;){let a,i;if(s<n.length&&(r==e.length||e[r]>=n[s]))a=n[s++],i=n[s++];else if(r<e.length)a=e[r++],i=e[r++];else return t;!t.length||t[t.length-1]<a?t.push(a,i):t[t.length-1]<i&&(t[t.length-1]=i)}}function lz(n,e,t){var s;let r,a,i;return t?(r=e.changes,a=kr.empty(e.changes.length),i=n.changes.compose(e.changes)):(r=e.changes.map(n.changes),a=n.changes.mapDesc(e.changes,!0),i=n.changes.compose(r)),{changes:i,selection:e.selection?e.selection.map(a):(s=n.selection)===null||s===void 0?void 0:s.map(r),effects:ln.mapEffects(n.effects,r).concat(ln.mapEffects(e.effects,a)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function Y2(n,e,t){let s=e.selection,r=fd(e.annotations);return e.userEvent&&(r=r.concat(Sa.userEvent.of(e.userEvent))),{changes:e.changes instanceof kr?e.changes:kr.of(e.changes||[],t,n.facet(sz)),selection:s&&(s instanceof Ve?s:Ve.single(s.anchor,s.head)),effects:fd(e.effects),annotations:r,scrollIntoView:!!e.scrollIntoView}}function cz(n,e,t){let s=Y2(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let a=1;a<e.length;a++){e[a].filter===!1&&(t=!1);let i=!!e[a].sequential;s=lz(s,Y2(n,e[a],i?s.changes.newLength:n.doc.length),i)}let r=Sa.create(n,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return Xve(t?Gve(r):r)}function Gve(n){let e=n.startState,t=!0;for(let r of e.facet(rz)){let a=r(n);if(a===!1){t=!1;break}Array.isArray(a)&&(t=t===!0?a:Wve(t,a))}if(t!==!0){let r,a;if(t===!1)a=n.changes.invertedDesc,r=kr.empty(e.doc.length);else{let i=n.changes.filter(t);r=i.changes,a=i.filtered.mapDesc(i.changes).invertedDesc}n=Sa.create(e,r,n.selection&&n.selection.map(a),ln.mapEffects(n.effects,a),n.annotations,n.scrollIntoView)}let s=e.facet(az);for(let r=s.length-1;r>=0;r--){let a=s[r](n);a instanceof Sa?n=a:Array.isArray(a)&&a.length==1&&a[0]instanceof Sa?n=a[0]:n=cz(e,fd(a),!1)}return n}function Xve(n){let e=n.startState,t=e.facet(iz),s=n;for(let r=t.length-1;r>=0;r--){let a=t[r](n);a&&Object.keys(a).length&&(s=lz(s,Y2(e,a,n.changes.newLength),!0))}return s==n?n:Sa.create(e,n.changes,n.selection,s.effects,s.annotations,s.scrollIntoView)}const Hve=[];function fd(n){return n==null?Hve:Array.isArray(n)?n:[n]}var gr=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(gr||(gr={}));const Yve=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let K2;try{K2=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Kve(n){if(K2)return K2.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||Yve.test(t)))return!0}return!1}function Jve(n){return e=>{if(!/\S/.test(e))return gr.Space;if(Kve(e))return gr.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return gr.Word;return gr.Other}}class rs{constructor(e,t,s,r,a,i){this.config=e,this.doc=t,this.selection=s,this.values=r,this.status=e.statusTemplate.slice(),this.computeSlot=a,i&&(i._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)Rm(this,o<<1);this.computeSlot=null}field(e,t=!0){let s=this.config.address[e.id];if(s==null){if(t)throw new RangeError("Field is not present in this state");return}return Rm(this,s),Ly(this,s)}update(...e){return cz(this,e,!0)}applyTransaction(e){let t=this.config,{base:s,compartments:r}=t;for(let o of e.effects)o.is(ug.reconfigure)?(t&&(r=new Map,t.compartments.forEach((l,c)=>r.set(c,l)),t=null),r.set(o.value.compartment,o.value.extension)):o.is(ln.reconfigure)?(t=null,s=o.value):o.is(ln.appendConfig)&&(t=null,s=fd(s).concat(o.value));let a;t?a=e.startState.values.slice():(t=Iy.resolve(s,r,this),a=new rs(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(o,l)=>l.reconfigure(o,this),null).values);let i=e.startState.facet(H2)?e.newSelection:e.newSelection.asSingle();new rs(t,e.newDoc,i,a,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:Ve.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,s=e(t.ranges[0]),r=this.changes(s.changes),a=[s.range],i=fd(s.effects);for(let o=1;o<t.ranges.length;o++){let l=e(t.ranges[o]),c=this.changes(l.changes),u=c.map(r);for(let d=0;d<o;d++)a[d]=a[d].map(u);let h=r.mapDesc(c,!0);a.push(l.range.map(h)),r=r.compose(u),i=ln.mapEffects(i,u).concat(ln.mapEffects(fd(l.effects),h))}return{changes:r,selection:Ve.create(a,t.mainIndex),effects:i}}changes(e=[]){return e instanceof kr?e:kr.of(e,this.doc.length,this.facet(rs.lineSeparator))}toText(e){return ts.of(e.split(this.facet(rs.lineSeparator)||q2))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Rm(this,t),Ly(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let s in e){let r=e[s];r instanceof Us&&this.config.address[r.id]!=null&&(t[s]=r.spec.toJSON(this.field(e[s]),this))}return t}static fromJSON(e,t={},s){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let r=[];if(s){for(let a in s)if(Object.prototype.hasOwnProperty.call(e,a)){let i=s[a],o=e[a];r.push(i.init(l=>i.spec.fromJSON(o,l)))}}return rs.create({doc:e.doc,selection:Ve.fromJSON(e.selection),extensions:t.extensions?r.concat([t.extensions]):r})}static create(e={}){let t=Iy.resolve(e.extensions||[],new Map),s=e.doc instanceof ts?e.doc:ts.of((e.doc||"").split(t.staticFacet(rs.lineSeparator)||q2)),r=e.selection?e.selection instanceof Ve?e.selection:Ve.single(e.selection.anchor,e.selection.head):Ve.single(0);return ez(r,s.length),t.staticFacet(H2)||(r=r.asSingle()),new rs(t,s,r,t.dynamicSlots.map(()=>null),(a,i)=>i.create(a),null)}get tabSize(){return this.facet(rs.tabSize)}get lineBreak(){return this.facet(rs.lineSeparator)||`
`}get readOnly(){return this.facet(oz)}phrase(e,...t){for(let s of this.facet(rs.phrases))if(Object.prototype.hasOwnProperty.call(s,e)){e=s[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(s,r)=>{if(r=="$")return"$";let a=+(r||1);return!a||a>t.length?s:t[a-1]})),e}languageDataAt(e,t,s=-1){let r=[];for(let a of this.facet(nz))for(let i of a(this,t,s))Object.prototype.hasOwnProperty.call(i,e)&&r.push(i[e]);return r}charCategorizer(e){return Jve(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:s,length:r}=this.doc.lineAt(e),a=this.charCategorizer(e),i=e-s,o=e-s;for(;i>0;){let l=qr(t,i,!1);if(a(t.slice(l,i))!=gr.Word)break;i=l}for(;o<r;){let l=qr(t,o);if(a(t.slice(o,l))!=gr.Word)break;o=l}return i==o?null:Ve.range(i+s,o+s)}}rs.allowMultipleSelections=H2;rs.tabSize=_t.define({combine:n=>n.length?n[0]:4});rs.lineSeparator=sz;rs.readOnly=oz;rs.phrases=_t.define({compare(n,e){let t=Object.keys(n),s=Object.keys(e);return t.length==s.length&&t.every(r=>n[r]==e[r])}});rs.languageData=nz;rs.changeFilter=rz;rs.transactionFilter=az;rs.transactionExtender=iz;ug.reconfigure=ln.define();function Tc(n,e,t={}){let s={};for(let r of n)for(let a of Object.keys(r)){let i=r[a],o=s[a];if(o===void 0)s[a]=i;else if(!(o===i||i===void 0))if(Object.hasOwnProperty.call(t,a))s[a]=t[a](o,i);else throw new Error("Config merge conflict for field "+a)}for(let r in e)s[r]===void 0&&(s[r]=e[r]);return s}class wh{eq(e){return this==e}range(e,t=e){return J2.create(e,t,this)}}wh.prototype.startSide=wh.prototype.endSide=0;wh.prototype.point=!1;wh.prototype.mapMode=mr.TrackDel;let J2=class uz{constructor(e,t,s){this.from=e,this.to=t,this.value=s}static create(e,t,s){return new uz(e,t,s)}};function eS(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class GA{constructor(e,t,s,r){this.from=e,this.to=t,this.value=s,this.maxPoint=r}get length(){return this.to[this.to.length-1]}findIndex(e,t,s,r=0){let a=s?this.to:this.from;for(let i=r,o=a.length;;){if(i==o)return i;let l=i+o>>1,c=a[l]-e||(s?this.value[l].endSide:this.value[l].startSide)-t;if(l==i)return c>=0?i:o;c>=0?o=l:i=l+1}}between(e,t,s,r){for(let a=this.findIndex(t,-1e9,!0),i=this.findIndex(s,1e9,!1,a);a<i;a++)if(r(this.from[a]+e,this.to[a]+e,this.value[a])===!1)return!1}map(e,t){let s=[],r=[],a=[],i=-1,o=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+e,h=this.to[l]+e,d,m;if(u==h){let y=t.mapPos(u,c.startSide,c.mapMode);if(y==null||(d=m=y,c.startSide!=c.endSide&&(m=t.mapPos(u,c.endSide),m<d)))continue}else if(d=t.mapPos(u,c.startSide),m=t.mapPos(h,c.endSide),d>m||d==m&&c.startSide>0&&c.endSide<=0)continue;(m-d||c.endSide-c.startSide)<0||(i<0&&(i=d),c.point&&(o=Math.max(o,m-d)),s.push(c),r.push(d-i),a.push(m-i))}return{mapped:s.length?new GA(r,a,s,o):null,pos:i}}}class cs{constructor(e,t,s,r){this.chunkPos=e,this.chunk=t,this.nextLayer=s,this.maxPoint=r}static create(e,t,s,r){return new cs(e,t,s,r)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:s=!1,filterFrom:r=0,filterTo:a=this.length}=e,i=e.filter;if(t.length==0&&!i)return this;if(s&&(t=t.slice().sort(eS)),this.isEmpty)return t.length?cs.of(t):this;let o=new hz(this,null,-1).goto(0),l=0,c=[],u=new _l;for(;o.value||l<t.length;)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let h=t[l++];u.addInner(h.from,h.to,h.value)||c.push(h)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!i||r>this.chunkEnd(o.chunkIndex)||a<this.chunkPos[o.chunkIndex])&&u.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!i||r>o.to||a<o.from||i(o.from,o.to,o.value))&&(u.addInner(o.from,o.to,o.value)||c.push(J2.create(o.from,o.to,o.value))),o.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?cs.empty:this.nextLayer.update({add:c,filter:i,filterFrom:r,filterTo:a}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],s=[],r=-1;for(let i=0;i<this.chunk.length;i++){let o=this.chunkPos[i],l=this.chunk[i],c=e.touchesRange(o,o+l.length);if(c===!1)r=Math.max(r,l.maxPoint),t.push(l),s.push(e.mapPos(o));else if(c===!0){let{mapped:u,pos:h}=l.map(o,e);u&&(r=Math.max(r,u.maxPoint),t.push(u),s.push(h))}}let a=this.nextLayer.map(e);return t.length==0?a:new cs(s,t,a||cs.empty,r)}between(e,t,s){if(!this.isEmpty){for(let r=0;r<this.chunk.length;r++){let a=this.chunkPos[r],i=this.chunk[r];if(t>=a&&e<=a+i.length&&i.between(a,e-a,t-a,s)===!1)return}this.nextLayer.between(e,t,s)}}iter(e=0){return vf.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return vf.from(e).goto(t)}static compare(e,t,s,r,a=-1){let i=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=a),o=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=a),l=CT(i,o,s),c=new Up(i,l,a),u=new Up(o,l,a);s.iterGaps((h,d,m)=>PT(c,h,u,d,m,r)),s.empty&&s.length==0&&PT(c,0,u,0,0,r)}static eq(e,t,s=0,r){r==null&&(r=999999999);let a=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0),i=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(a.length!=i.length)return!1;if(!a.length)return!0;let o=CT(a,i),l=new Up(a,o,0).goto(s),c=new Up(i,o,0).goto(s);for(;;){if(l.to!=c.to||!tS(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>r)return!0;l.next(),c.next()}}static spans(e,t,s,r,a=-1){let i=new Up(e,null,a).goto(t),o=t,l=i.openStart;for(;;){let c=Math.min(i.to,s);if(i.point){let u=i.activeForPoint(i.to),h=i.pointFrom<t?u.length+1:i.point.startSide<0?u.length:Math.min(u.length,l);r.point(o,c,i.point,u,h,i.pointRank),l=Math.min(i.openEnd(c),u.length)}else c>o&&(r.span(o,c,i.active,l),l=i.openEnd(c));if(i.to>s)return l+(i.point&&i.to>s?1:0);o=i.to,i.next()}}static of(e,t=!1){let s=new _l;for(let r of e instanceof J2?[e]:t?eOe(e):e)s.add(r.from,r.to,r.value);return s.finish()}static join(e){if(!e.length)return cs.empty;let t=e[e.length-1];for(let s=e.length-2;s>=0;s--)for(let r=e[s];r!=cs.empty;r=r.nextLayer)t=new cs(r.chunkPos,r.chunk,t,Math.max(r.maxPoint,t.maxPoint));return t}}cs.empty=new cs([],[],null,-1);function eOe(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let s=n[t];if(eS(e,s)>0)return n.slice().sort(eS);e=s}return n}cs.empty.nextLayer=cs.empty;class _l{finishChunk(e){this.chunks.push(new GA(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,s){this.addInner(e,t,s)||(this.nextLayer||(this.nextLayer=new _l)).add(e,t,s)}addInner(e,t,s){let r=e-this.lastTo||s.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||s.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return r<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=s,this.lastFrom=e,this.lastTo=t,this.value.push(s),s.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let s=t.value.length-1;return this.last=t.value[s],this.lastFrom=t.from[s]+e,this.lastTo=t.to[s]+e,!0}finish(){return this.finishInner(cs.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=cs.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function CT(n,e,t){let s=new Map;for(let a of n)for(let i=0;i<a.chunk.length;i++)a.chunk[i].maxPoint<=0&&s.set(a.chunk[i],a.chunkPos[i]);let r=new Set;for(let a of e)for(let i=0;i<a.chunk.length;i++){let o=s.get(a.chunk[i]);o!=null&&(t?t.mapPos(o):o)==a.chunkPos[i]&&!(t!=null&&t.touchesRange(o,o+a.chunk[i].length))&&r.add(a.chunk[i])}return r}class hz{constructor(e,t,s,r=0){this.layer=e,this.skip=t,this.minPoint=s,this.rank=r}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,s){for(;this.chunkIndex<this.layer.chunk.length;){let r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,s=!1}if(this.chunkIndex<this.layer.chunk.length){let r=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!s||this.rangeIndex<r)&&this.setRangeIndex(r)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],s=e+t.from[this.rangeIndex];if(this.from=s,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class vf{constructor(e){this.heap=e}static from(e,t=null,s=-1){let r=[];for(let a=0;a<e.length;a++)for(let i=e[a];!i.isEmpty;i=i.nextLayer)i.maxPoint>=s&&r.push(new hz(i,t,s,a));return r.length==1?r[0]:new vf(r)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let s of this.heap)s.goto(e,t);for(let s=this.heap.length>>1;s>=0;s--)zw(this.heap,s);return this.next(),this}forward(e,t){for(let s of this.heap)s.forward(e,t);for(let s=this.heap.length>>1;s>=0;s--)zw(this.heap,s);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),zw(this.heap,0)}}}function zw(n,e){for(let t=n[e];;){let s=(e<<1)+1;if(s>=n.length)break;let r=n[s];if(s+1<n.length&&r.compare(n[s+1])>=0&&(r=n[s+1],s++),t.compare(r)<0)break;n[s]=t,n[e]=r,e=s}}class Up{constructor(e,t,s){this.minPoint=s,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=vf.from(e,t,s)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){s0(this.active,e),s0(this.activeTo,e),s0(this.activeRank,e),this.minActive=AT(this.active,this.activeTo)}addActive(e){let t=0,{value:s,to:r,rank:a}=this.cursor;for(;t<this.activeRank.length&&(a-this.activeRank[t]||r-this.activeTo[t])>0;)t++;r0(this.active,t,s),r0(this.activeTo,t,r),r0(this.activeRank,t,a),e&&r0(e,t,this.cursor.from),this.minActive=AT(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let s=this.openStart<0?[]:null;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),s&&s0(s,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let a=this.cursor.value;if(!a.point)this.addActive(s),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=a,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=a.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(s){this.openStart=0;for(let r=s.length-1;r>=0&&s[r]<e;r--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let s=this.active.length-1;s>=0&&!(this.activeRank[s]<this.pointRank);s--)(this.activeTo[s]>e||this.activeTo[s]==e&&this.active[s].endSide>=this.point.endSide)&&t.push(this.active[s]);return t.reverse()}openEnd(e){let t=0;for(let s=this.activeTo.length-1;s>=0&&this.activeTo[s]>e;s--)t++;return t}}function PT(n,e,t,s,r,a){n.goto(e),t.goto(s);let i=s+r,o=s,l=s-e;for(;;){let c=n.to+l-t.to,u=c||n.endSide-t.endSide,h=u<0?n.to+l:t.to,d=Math.min(h,i);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&tS(n.activeForPoint(n.to),t.activeForPoint(t.to))||a.comparePoint(o,d,n.point,t.point):d>o&&!tS(n.active,t.active)&&a.compareRange(o,d,n.active,t.active),h>i)break;(c||n.openEnd!=t.openEnd)&&a.boundChange&&a.boundChange(h),o=h,u<=0&&n.next(),u>=0&&t.next()}}function tS(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function s0(n,e){for(let t=e,s=n.length-1;t<s;t++)n[t]=n[t+1];n.pop()}function r0(n,e,t){for(let s=n.length-1;s>=e;s--)n[s+1]=n[s];n[e]=t}function AT(n,e){let t=-1,s=1e9;for(let r=0;r<e.length;r++)(e[r]-s||n[r].endSide-n[t].endSide)<0&&(t=r,s=e[r]);return t}function Op(n,e,t=n.length){let s=0;for(let r=0;r<t&&r<n.length;)n.charCodeAt(r)==9?(s+=e-s%e,r++):(s++,r=qr(n,r));return s}function nS(n,e,t,s){for(let r=0,a=0;;){if(a>=e)return r;if(r==n.length)break;a+=n.charCodeAt(r)==9?t-a%t:1,r=qr(n,r)}return s===!0?-1:n.length}const sS="ͼ",ET=typeof Symbol>"u"?"__"+sS:Symbol.for(sS),rS=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),MT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class bu{constructor(e,t){this.rules=[];let{finish:s}=t||{};function r(i){return/^@/.test(i)?[i]:i.split(/,\s*/)}function a(i,o,l,c){let u=[],h=/^@(\w+)\b/.exec(i[0]),d=h&&h[1]=="keyframes";if(h&&o==null)return l.push(i[0]+";");for(let m in o){let y=o[m];if(/&/.test(m))a(m.split(/,\s*/).map(O=>i.map(S=>O.replace(/&/,S))).reduce((O,S)=>O.concat(S)),y,l);else if(y&&typeof y=="object"){if(!h)throw new RangeError("The value of a property ("+m+") should be a primitive value.");a(r(m),y,u,d)}else y!=null&&u.push(m.replace(/_.*/,"").replace(/[A-Z]/g,O=>"-"+O.toLowerCase())+": "+y+";")}(u.length||d)&&l.push((s&&!h&&!c?i.map(s):i).join(", ")+" {"+u.join(" ")+"}")}for(let i in e)a(r(i),e[i],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=MT[ET]||1;return MT[ET]=e+1,sS+e.toString(36)}static mount(e,t,s){let r=e[rS],a=s&&s.nonce;r?a&&r.setNonce(a):r=new tOe(e,a),r.mount(Array.isArray(t)?t:[t],e)}}let DT=new Map;class tOe{constructor(e,t){let s=e.ownerDocument||e,r=s.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let a=DT.get(s);if(a)return e[rS]=a;this.sheet=new r.CSSStyleSheet,DT.set(s,this)}else this.styleTag=s.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[rS]=this}mount(e,t){let s=this.sheet,r=0,a=0;for(let i=0;i<e.length;i++){let o=e[i],l=this.modules.indexOf(o);if(l<a&&l>-1&&(this.modules.splice(l,1),a--,l=-1),l==-1){if(this.modules.splice(a++,0,o),s)for(let c=0;c<o.rules.length;c++)s.insertRule(o.rules[c],r++)}else{for(;a<l;)r+=this.modules[a++].rules.length;r+=o.rules.length,a++}}if(s)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let i="";for(let l=0;l<this.modules.length;l++)i+=this.modules[l].getRules()+`
`;this.styleTag.textContent=i;let o=t.head||t;this.styleTag.parentNode!=o&&o.insertBefore(this.styleTag,o.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var yu={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Of={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},nOe=typeof navigator<"u"&&/Mac/.test(navigator.platform),sOe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var zr=0;zr<10;zr++)yu[48+zr]=yu[96+zr]=String(zr);for(var zr=1;zr<=24;zr++)yu[zr+111]="F"+zr;for(var zr=65;zr<=90;zr++)yu[zr]=String.fromCharCode(zr+32),Of[zr]=String.fromCharCode(zr);for(var qw in yu)Of.hasOwnProperty(qw)||(Of[qw]=yu[qw]);function rOe(n){var e=nOe&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||sOe&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Of:yu)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function wf(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function aS(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function lb(n,e){if(!e.anchorNode)return!1;try{return aS(n,e.anchorNode)}catch{return!1}}function xf(n){return n.nodeType==3?kh(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function Im(n,e,t,s){return t?TT(n,e,t,s,-1)||TT(n,e,t,s,1):!1}function xh(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Qy(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function TT(n,e,t,s,r){for(;;){if(n==t&&e==s)return!0;if(e==(r<0?0:Rl(n))){if(n.nodeName=="DIV")return!1;let a=n.parentNode;if(!a||a.nodeType!=1)return!1;e=xh(n)+(r<0?0:1),n=a}else if(n.nodeType==1){if(n=n.childNodes[e+(r<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=r<0?Rl(n):0}else return!1}}function Rl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function $v(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function aOe(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function dz(n,e){let t=e.width/n.offsetWidth,s=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(s>.995&&s<1.005||!isFinite(s)||Math.abs(e.height-n.offsetHeight)<1)&&(s=1),{scaleX:t,scaleY:s}}function iOe(n,e,t,s,r,a,i,o){let l=n.ownerDocument,c=l.defaultView||window;for(let u=n,h=!1;u&&!h;)if(u.nodeType==1){let d,m=u==l.body,y=1,O=1;if(m)d=aOe(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(h=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let F=u.getBoundingClientRect();({scaleX:y,scaleY:O}=dz(u,F)),d={left:F.left,right:F.left+u.clientWidth*y,top:F.top,bottom:F.top+u.clientHeight*O}}let S=0,A=0;if(r=="nearest")e.top<d.top?(A=-(d.top-e.top+i),t>0&&e.bottom>d.bottom+A&&(A=e.bottom-d.bottom+A+i)):e.bottom>d.bottom&&(A=e.bottom-d.bottom+i,t<0&&e.top-A<d.top&&(A=-(d.top+A-e.top+i)));else{let F=e.bottom-e.top,j=d.bottom-d.top;A=(r=="center"&&F<=j?e.top+F/2-j/2:r=="start"||r=="center"&&t<0?e.top-i:e.bottom-j+i)-d.top}if(s=="nearest"?e.left<d.left?(S=-(d.left-e.left+a),t>0&&e.right>d.right+S&&(S=e.right-d.right+S+a)):e.right>d.right&&(S=e.right-d.right+a,t<0&&e.left<d.left+S&&(S=-(d.left+S-e.left+a))):S=(s=="center"?e.left+(e.right-e.left)/2-(d.right-d.left)/2:s=="start"==o?e.left-a:e.right-(d.right-d.left)+a)-d.left,S||A)if(m)c.scrollBy(S,A);else{let F=0,j=0;if(A){let N=u.scrollTop;u.scrollTop+=A/O,j=(u.scrollTop-N)*O}if(S){let N=u.scrollLeft;u.scrollLeft+=S/y,F=(u.scrollLeft-N)*y}e={left:e.left-F,top:e.top-j,right:e.right-F,bottom:e.bottom-j},F&&Math.abs(F-S)<1&&(s="nearest"),j&&Math.abs(j-A)<1&&(r="nearest")}if(m)break;u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function oOe(n){let e=n.ownerDocument,t,s;for(let r=n.parentNode;r&&!(r==e.body||t&&s);)if(r.nodeType==1)!s&&r.scrollHeight>r.clientHeight&&(s=r),!t&&r.scrollWidth>r.clientWidth&&(t=r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;return{x:t,y:s}}class lOe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:s}=e;this.set(t,Math.min(e.anchorOffset,t?Rl(t):0),s,Math.min(e.focusOffset,s?Rl(s):0))}set(e,t,s,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=s,this.focusOffset=r}}let $h=null;function pz(n){if(n.setActive)return n.setActive();if($h)return n.focus($h);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus($h==null?{get preventScroll(){return $h={preventScroll:!0},!0}}:void 0),!$h){$h=!1;for(let t=0;t<e.length;){let s=e[t++],r=e[t++],a=e[t++];s.scrollTop!=r&&(s.scrollTop=r),s.scrollLeft!=a&&(s.scrollLeft=a)}}}let BT;function kh(n,e,t=e){let s=BT||(BT=document.createRange());return s.setEnd(n,t),s.setStart(n,e),s}function gd(n,e,t,s){let r={key:e,code:e,keyCode:t,which:t,cancelable:!0};s&&({altKey:r.altKey,ctrlKey:r.ctrlKey,shiftKey:r.shiftKey,metaKey:r.metaKey}=s);let a=new KeyboardEvent("keydown",r);a.synthetic=!0,n.dispatchEvent(a);let i=new KeyboardEvent("keyup",r);return i.synthetic=!0,n.dispatchEvent(i),a.defaultPrevented||i.defaultPrevented}function cOe(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function mz(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function uOe(n,e){let t=e.focusNode,s=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=s)return!1;for(s=Math.min(s,Rl(t));;)if(s){if(t.nodeType!=1)return!1;let r=t.childNodes[s-1];r.contentEditable=="false"?s--:(t=r,s=Rl(t))}else{if(t==n)return!0;s=xh(t),t=t.parentNode}}function fz(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function gz(n,e){for(let t=n,s=e;;){if(t.nodeType==3&&s>0)return{node:t,offset:s};if(t.nodeType==1&&s>0){if(t.contentEditable=="false")return null;t=t.childNodes[s-1],s=Rl(t)}else if(t.parentNode&&!Qy(t))s=xh(t),t=t.parentNode;else return null}}function bz(n,e){for(let t=n,s=e;;){if(t.nodeType==3&&s<t.nodeValue.length)return{node:t,offset:s};if(t.nodeType==1&&s<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[s],s=0}else if(t.parentNode&&!Qy(t))s=xh(t)+1,t=t.parentNode;else return null}}class ia{constructor(e,t,s=!0){this.node=e,this.offset=t,this.precise=s}static before(e,t){return new ia(e.parentNode,xh(e),t)}static after(e,t){return new ia(e.parentNode,xh(e)+1,t)}}const XA=[];class ks{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let s of this.children){if(s==e)return t;t+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let s=this.dom,r=null,a;for(let i of this.children){if(i.flags&7){if(!i.dom&&(a=r?r.nextSibling:s.firstChild)){let o=ks.get(a);(!o||!o.parent&&o.canReuseDOM(i))&&i.reuseDOM(a)}i.sync(e,t),i.flags&=-8}if(a=r?r.nextSibling:s.firstChild,t&&!t.written&&t.node==s&&a!=i.dom&&(t.written=!0),i.dom.parentNode==s)for(;a&&a!=i.dom;)a=FT(a);else s.insertBefore(i.dom,a);r=i.dom}for(a=r?r.nextSibling:s.firstChild,a&&t&&t.node==s&&(t.written=!0);a;)a=FT(a)}else if(this.flags&1)for(let s of this.children)s.flags&7&&(s.sync(e,t),s.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let s;if(e==this.dom)s=this.dom.childNodes[t];else{let r=Rl(e)==0?0:t==0?-1:1;for(;;){let a=e.parentNode;if(a==this.dom)break;r==0&&a.firstChild!=a.lastChild&&(e==a.firstChild?r=-1:r=1),e=a}r<0?s=e:s=e.nextSibling}if(s==this.dom.firstChild)return 0;for(;s&&!ks.get(s);)s=s.nextSibling;if(!s)return this.length;for(let r=0,a=0;;r++){let i=this.children[r];if(i.dom==s)return a;a+=i.length+i.breakAfter}}domBoundsAround(e,t,s=0){let r=-1,a=-1,i=-1,o=-1;for(let l=0,c=s,u=s;l<this.children.length;l++){let h=this.children[l],d=c+h.length;if(c<e&&d>t)return h.domBoundsAround(e,t,c);if(d>=e&&r==-1&&(r=l,a=c),c>t&&h.dom.parentNode==this.dom){i=l,o=u;break}u=d,c=d+h.breakAfter}return{from:a,to:o<0?s+this.length:o,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:i<this.children.length&&i>=0?this.children[i].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,s=XA){this.markDirty();for(let r=e;r<t;r++){let a=this.children[r];a.parent==this&&s.indexOf(a)<0&&a.destroy()}s.length<250?this.children.splice(e,t-e,...s):this.children=[].concat(this.children.slice(0,e),s,this.children.slice(t));for(let r=0;r<s.length;r++)s[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new yz(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,s,r,a,i){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}ks.prototype.breakAfter=0;function FT(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class yz{constructor(e,t,s){this.children=e,this.pos=t,this.i=s,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let s=this.children[--this.i];this.pos-=s.length+s.breakAfter}}}function vz(n,e,t,s,r,a,i,o,l){let{children:c}=n,u=c.length?c[e]:null,h=a.length?a[a.length-1]:null,d=h?h.breakAfter:i;if(!(e==s&&u&&!i&&!d&&a.length<2&&u.merge(t,r,a.length?h:null,t==0,o,l))){if(s<c.length){let m=c[s];m&&(r<m.length||m.breakAfter&&(h!=null&&h.breakAfter))?(e==s&&(m=m.split(r),r=0),!d&&h&&m.merge(0,r,h,!0,0,l)?a[a.length-1]=m:((r||m.children.length&&!m.children[0].length)&&m.merge(0,r,null,!1,0,l),a.push(m))):m!=null&&m.breakAfter&&(h?h.breakAfter=1:i=1),s++}for(u&&(u.breakAfter=i,t>0&&(!i&&a.length&&u.merge(t,u.length,a[0],!1,o,0)?u.breakAfter=a.shift().breakAfter:(t<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(t,u.length,null,!1,o,0),e++));e<s&&a.length;)if(c[s-1].become(a[a.length-1]))s--,a.pop(),l=a.length?0:o;else if(c[e].become(a[0]))e++,a.shift(),o=a.length?0:l;else break;!a.length&&e&&s<c.length&&!c[e-1].breakAfter&&c[s].merge(0,0,c[e-1],!1,o,l)&&e--,(e<s||a.length)&&n.replaceChildren(e,s,a)}}function Oz(n,e,t,s,r,a){let i=n.childCursor(),{i:o,off:l}=i.findPos(t,1),{i:c,off:u}=i.findPos(e,-1),h=e-t;for(let d of s)h+=d.length;n.length+=h,vz(n,c,u,o,l,s,0,r,a)}let Ka=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},iS=typeof document<"u"?document:{documentElement:{style:{}}};const oS=/Edge\/(\d+)/.exec(Ka.userAgent),wz=/MSIE \d/.test(Ka.userAgent),lS=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ka.userAgent),Nv=!!(wz||lS||oS),$T=!Nv&&/gecko\/(\d+)/i.test(Ka.userAgent),Uw=!Nv&&/Chrome\/(\d+)/.exec(Ka.userAgent),NT="webkitFontSmoothing"in iS.documentElement.style,xz=!Nv&&/Apple Computer/.test(Ka.vendor),_T=xz&&(/Mobile\/\w+/.test(Ka.userAgent)||Ka.maxTouchPoints>2);var Mt={mac:_T||/Mac/.test(Ka.platform),windows:/Win/.test(Ka.platform),linux:/Linux|X11/.test(Ka.platform),ie:Nv,ie_version:wz?iS.documentMode||6:lS?+lS[1]:oS?+oS[1]:0,gecko:$T,gecko_version:$T?+(/Firefox\/(\d+)/.exec(Ka.userAgent)||[0,0])[1]:0,chrome:!!Uw,chrome_version:Uw?+Uw[1]:0,ios:_T,android:/Android\b/.test(Ka.userAgent),webkit:NT,safari:xz,webkit_version:NT?+(/\bAppleWebKit\/(\d+)/.exec(Ka.userAgent)||[0,0])[1]:0,tabSize:iS.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const hOe=256;class Ho extends ks{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,s){return this.flags&8||s&&(!(s instanceof Ho)||this.length-(t-e)+s.length>hOe||s.flags&8)?!1:(this.text=this.text.slice(0,e)+(s?s.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new Ho(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new ia(this.dom,e)}domBoundsAround(e,t,s){return{from:s,to:s+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return dOe(this.dom,e,t)}}class Sc extends ks{constructor(e,t=[],s=0){super(),this.mark=e,this.children=t,this.length=s;for(let r of t)r.setParent(this)}setAttrs(e){if(mz(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,s,r,a,i){return s&&(!(s instanceof Sc&&s.mark.eq(this.mark))||e&&a<=0||t<this.length&&i<=0)?!1:(Oz(this,e,t,s?s.children.slice():[],a-1,i-1),this.markDirty(),!0)}split(e){let t=[],s=0,r=-1,a=0;for(let o of this.children){let l=s+o.length;l>e&&t.push(s<e?o.split(e-s):o),r<0&&s>=e&&(r=a),s=l,a++}let i=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Sc(this.mark,t,i)}domAtPos(e){return kz(this,e)}coordsAt(e,t){return Cz(this,e,t)}}function dOe(n,e,t){let s=n.nodeValue.length;e>s&&(e=s);let r=e,a=e,i=0;e==0&&t<0||e==s&&t>=0?Mt.chrome||Mt.gecko||(e?(r--,i=1):a<s&&(a++,i=-1)):t<0?r--:a<s&&a++;let o=kh(n,r,a).getClientRects();if(!o.length)return null;let l=o[(i?i<0:t>=0)?0:o.length-1];return Mt.safari&&!i&&l.width==0&&(l=Array.prototype.find.call(o,c=>c.width)||l),i?$v(l,i<0):l||null}class Xc extends ks{static create(e,t,s){return new Xc(e,t,s)}constructor(e,t,s){super(),this.widget=e,this.length=t,this.side=s,this.prevWidget=null}split(e){let t=Xc.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,s,r,a,i){return s&&(!(s instanceof Xc)||!this.widget.compare(s.widget)||e>0&&a<=0||t<this.length&&i<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-t),!0)}become(e){return e instanceof Xc&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return ts.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,s=t&&t.state.doc,r=this.posAtStart;return s?s.slice(r,r+this.length):ts.empty}domAtPos(e){return(this.length?e==0:this.side>0)?ia.before(this.dom):ia.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let s=this.widget.coordsAt(this.dom,e,t);if(s)return s;let r=this.dom.getClientRects(),a=null;if(!r.length)return null;let i=this.side?this.side<0:e>0;for(let o=i?r.length-1:0;a=r[o],!(e>0?o==0:o==r.length-1||a.top<a.bottom);o+=i?-1:1);return $v(a,!i)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class jd extends ks{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof jd&&e.side==this.side}split(){return new jd(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?ia.before(this.dom):ia.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ts.empty}get isHidden(){return!0}}Ho.prototype.children=Xc.prototype.children=jd.prototype.children=XA;function kz(n,e){let t=n.dom,{children:s}=n,r=0;for(let a=0;r<s.length;r++){let i=s[r],o=a+i.length;if(!(o==a&&i.getSide()<=0)){if(e>a&&e<o&&i.dom.parentNode==t)return i.domAtPos(e-a);if(e<=a)break;a=o}}for(let a=r;a>0;a--){let i=s[a-1];if(i.dom.parentNode==t)return i.domAtPos(i.length)}for(let a=r;a<s.length;a++){let i=s[a];if(i.dom.parentNode==t)return i.domAtPos(0)}return new ia(t,0)}function Sz(n,e,t){let s,{children:r}=n;t>0&&e instanceof Sc&&r.length&&(s=r[r.length-1])instanceof Sc&&s.mark.eq(e.mark)?Sz(s,e.children[0],t-1):(r.push(e),e.setParent(n)),n.length+=e.length}function Cz(n,e,t){let s=null,r=-1,a=null,i=-1;function o(c,u){for(let h=0,d=0;h<c.children.length&&d<=u;h++){let m=c.children[h],y=d+m.length;y>=u&&(m.children.length?o(m,u-d):(!a||a.isHidden&&t>0)&&(y>u||d==y&&m.getSide()>0)?(a=m,i=u-d):(d<u||d==y&&m.getSide()<0&&!m.isHidden)&&(s=m,r=u-d)),d=y}}o(n,e);let l=(t<0?s:a)||s||a;return l?l.coordsAt(Math.max(0,l==s?r:i),t):pOe(n)}function pOe(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=xf(e);return t[t.length-1]||null}function cS(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const RT=Object.create(null);function jy(n,e,t){if(n==e)return!0;n||(n=RT),e||(e=RT);let s=Object.keys(n),r=Object.keys(e);if(s.length-(t&&s.indexOf(t)>-1?1:0)!=r.length-(t&&r.indexOf(t)>-1?1:0))return!1;for(let a of s)if(a!=t&&(r.indexOf(a)==-1||n[a]!==e[a]))return!1;return!0}function uS(n,e,t){let s=!1;if(e)for(let r in e)t&&r in t||(s=!0,r=="style"?n.style.cssText="":n.removeAttribute(r));if(t)for(let r in t)e&&e[r]==t[r]||(s=!0,r=="style"?n.style.cssText=t[r]:n.setAttribute(r,t[r]));return s}function mOe(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let s=n.attributes[t];e[s.name]=s.value}return e}class el{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,s){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Ca=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(Ca||(Ca={}));class Yt extends wh{constructor(e,t,s,r){super(),this.startSide=e,this.endSide=t,this.widget=s,this.spec=r}get heightRelevant(){return!1}static mark(e){return new hg(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),s=!!e.block;return t+=s&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new vu(e,t,t,s,e.widget||null,!1)}static replace(e){let t=!!e.block,s,r;if(e.isBlockGap)s=-5e8,r=4e8;else{let{start:a,end:i}=Pz(e,t);s=(a?t?-3e8:-1:5e8)-1,r=(i?t?2e8:1:-6e8)+1}return new vu(e,s,r,t,e.widget||null,!0)}static line(e){return new dg(e)}static set(e,t=!1){return cs.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Yt.none=cs.empty;class hg extends Yt{constructor(e){let{start:t,end:s}=Pz(e);super(t?-1:5e8,s?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,s;return this==e||e instanceof hg&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((s=e.attrs)===null||s===void 0?void 0:s.class))&&jy(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}hg.prototype.point=!1;class dg extends Yt{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof dg&&this.spec.class==e.spec.class&&jy(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}dg.prototype.mapMode=mr.TrackBefore;dg.prototype.point=!0;class vu extends Yt{constructor(e,t,s,r,a,i){super(t,s,a,e),this.block=r,this.isReplace=i,this.mapMode=r?t<=0?mr.TrackBefore:mr.TrackAfter:mr.TrackDel}get type(){return this.startSide!=this.endSide?Ca.WidgetRange:this.startSide<=0?Ca.WidgetBefore:Ca.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof vu&&fOe(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}vu.prototype.point=!0;function Pz(n,e=!1){let{inclusiveStart:t,inclusiveEnd:s}=n;return t==null&&(t=n.inclusive),s==null&&(s=n.inclusive),{start:t??e,end:s??e}}function fOe(n,e){return n==e||!!(n&&e&&n.compare(e))}function cb(n,e,t,s=0){let r=t.length-1;r>=0&&t[r]+s>=n?t[r]=Math.max(t[r],e):t.push(n,e)}class dr extends ks{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,s,r,a,i){if(s){if(!(s instanceof dr))return!1;this.dom||s.transferDOM(this)}return r&&this.setDeco(s?s.attrs:null),Oz(this,e,t,s?s.children.slice():[],a,i),!0}split(e){let t=new dr;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:s,off:r}=this.childPos(e);r&&(t.append(this.children[s].split(r),0),this.children[s].merge(r,this.children[s].length,null,!1,0,0),s++);for(let a=s;a<this.children.length;a++)t.append(this.children[a],0);for(;s>0&&this.children[s-1].length==0;)this.children[--s].destroy();return this.children.length=s,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){jy(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Sz(this,e,t)}addLineDeco(e){let t=e.spec.attributes,s=e.spec.class;t&&(this.attrs=cS(t,this.attrs||{})),s&&(this.attrs=cS({class:s},this.attrs||{}))}domAtPos(e){return kz(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var s;this.dom?this.flags&4&&(mz(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(uS(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&ks.get(r)instanceof Sc;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((s=ks.get(r))===null||s===void 0?void 0:s.isEditable)==!1&&(!Mt.ios||!this.children.some(a=>a instanceof Ho))){let a=document.createElement("BR");a.cmIgnore=!0,this.dom.appendChild(a)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let s of this.children){if(!(s instanceof Ho)||/[^ -~]/.test(s.text))return null;let r=xf(s.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let s=Cz(this,e,t);if(!this.children.length&&s&&this.parent){let{heightOracle:r}=this.parent.view.viewState,a=s.bottom-s.top;if(Math.abs(a-r.lineHeight)<2&&r.textHeight<a){let i=(a-r.textHeight)/2;return{top:s.top+i,bottom:s.bottom-i,left:s.left,right:s.left}}}return s}become(e){return e instanceof dr&&this.children.length==0&&e.children.length==0&&jy(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let s=0,r=0;s<e.children.length;s++){let a=e.children[s],i=r+a.length;if(i>=t){if(a instanceof dr)return a;if(i>t)break}r=i+a.breakAfter}return null}}class fc extends ks{constructor(e,t,s){super(),this.widget=e,this.length=t,this.deco=s,this.breakAfter=0,this.prevWidget=null}merge(e,t,s,r,a,i){return s&&(!(s instanceof fc)||!this.widget.compare(s.widget)||e>0&&a<=0||t<this.length&&i<=0)?!1:(this.length=e+(s?s.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?ia.before(this.dom):ia.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let s=new fc(this.widget,t,this.deco);return s.breakAfter=this.breakAfter,s}get children(){return XA}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ts.empty}domBoundsAround(){return null}become(e){return e instanceof fc&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)||(this.widget instanceof hS?null:$v(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:s}=this.deco;return t==s?!1:e<0?t<0:s>0}}class hS extends el{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Lm{constructor(e,t,s,r){this.doc=e,this.pos=t,this.end=s,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof fc&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new dr),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(a0(new jd(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof fc)&&this.getLine()}buildText(e,t,s){for(;e>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:i,done:o}=this.cursor.next(this.skip);if(this.skip=0,o)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=a,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-s)),this.getLine().append(a0(new Ho(this.text.slice(this.textOff,this.textOff+r)),t),s),this.atCursorPos=!0,this.textOff+=r,e-=r,s=0}}span(e,t,s,r){this.buildText(t-e,s,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,s,r,a,i){if(this.disallowBlockEffectsFor[i]&&s instanceof vu){if(s.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(s instanceof vu)if(s.block)s.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new fc(s.widget||Vd.block,o,s));else{let l=Xc.create(s.widget||Vd.inline,o,o?0:s.startSide),c=this.atCursorPos&&!l.isEditable&&a<=r.length&&(e<t||s.startSide>0),u=!l.isEditable&&(e<t||a>r.length||s.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),c&&(h.append(a0(new jd(1),r),a),a=r.length+Math.max(0,a-r.length)),h.append(a0(l,r),a),this.atCursorPos=u,this.pendingBuffer=u?e<t||a>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(s);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=a)}static build(e,t,s,r,a){let i=new Lm(e,t,s,a);return i.openEnd=cs.spans(r,t,s,i),i.openStart<0&&(i.openStart=i.openEnd),i.finish(i.openEnd),i}}function a0(n,e){for(let t of e)n=new Sc(t,[n],n.length);return n}class Vd extends el{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Vd.inline=new Vd("span");Vd.block=new Vd("div");var Ss=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(Ss||(Ss={}));const Sh=Ss.LTR,HA=Ss.RTL;function Az(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const gOe=Az("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),bOe=Az("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),dS=Object.create(null),il=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);dS[e]=t,dS[t]=-e}function Ez(n){return n<=247?gOe[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?bOe[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const yOe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Hc{get dir(){return this.level%2?HA:Sh}constructor(e,t,s){this.from=e,this.to=t,this.level=s}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,s,r){let a=-1;for(let i=0;i<e.length;i++){let o=e[i];if(o.from<=t&&o.to>=t){if(o.level==s)return i;(a<0||(r!=0?r<0?o.from<t:o.to>t:e[a].level>o.level))&&(a=i)}}if(a<0)throw new RangeError("Index out of range");return a}}function Mz(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let s=n[t],r=e[t];if(s.from!=r.from||s.to!=r.to||s.direction!=r.direction||!Mz(s.inner,r.inner))return!1}return!0}const ws=[];function vOe(n,e,t,s,r){for(let a=0;a<=s.length;a++){let i=a?s[a-1].to:e,o=a<s.length?s[a].from:t,l=a?256:r;for(let c=i,u=l,h=l;c<o;c++){let d=Ez(n.charCodeAt(c));d==512?d=u:d==8&&h==4&&(d=16),ws[c]=d==4?2:d,d&7&&(h=d),u=d}for(let c=i,u=l,h=l;c<o;c++){let d=ws[c];if(d==128)c<o-1&&u==ws[c+1]&&u&24?d=ws[c]=u:ws[c]=256;else if(d==64){let m=c+1;for(;m<o&&ws[m]==64;)m++;let y=c&&u==8||m<t&&ws[m]==8?h==1?1:8:256;for(let O=c;O<m;O++)ws[O]=y;c=m-1}else d==8&&h==1&&(ws[c]=1);u=d,d&7&&(h=d)}}}function OOe(n,e,t,s,r){let a=r==1?2:1;for(let i=0,o=0,l=0;i<=s.length;i++){let c=i?s[i-1].to:e,u=i<s.length?s[i].from:t;for(let h=c,d,m,y;h<u;h++)if(m=dS[d=n.charCodeAt(h)])if(m<0){for(let O=o-3;O>=0;O-=3)if(il[O+1]==-m){let S=il[O+2],A=S&2?r:S&4?S&1?a:r:0;A&&(ws[h]=ws[il[O]]=A),o=O;break}}else{if(il.length==189)break;il[o++]=h,il[o++]=d,il[o++]=l}else if((y=ws[h])==2||y==1){let O=y==r;l=O?0:1;for(let S=o-3;S>=0;S-=3){let A=il[S+2];if(A&2)break;if(O)il[S+2]|=2;else{if(A&4)break;il[S+2]|=4}}}}}function wOe(n,e,t,s){for(let r=0,a=s;r<=t.length;r++){let i=r?t[r-1].to:n,o=r<t.length?t[r].from:e;for(let l=i;l<o;){let c=ws[l];if(c==256){let u=l+1;for(;;)if(u==o){if(r==t.length)break;u=t[r++].to,o=r<t.length?t[r].from:e}else if(ws[u]==256)u++;else break;let h=a==1,d=(u<e?ws[u]:s)==1,m=h==d?h?1:2:s;for(let y=u,O=r,S=O?t[O-1].to:n;y>l;)y==S&&(y=t[--O].from,S=O?t[O-1].to:n),ws[--y]=m;l=u}else a=c,l++}}}function pS(n,e,t,s,r,a,i){let o=s%2?2:1;if(s%2==r%2)for(let l=e,c=0;l<t;){let u=!0,h=!1;if(c==a.length||l<a[c].from){let O=ws[l];O!=o&&(u=!1,h=O==16)}let d=!u&&o==1?[]:null,m=u?s:s+1,y=l;e:for(;;)if(c<a.length&&y==a[c].from){if(h)break e;let O=a[c];if(!u)for(let S=O.to,A=c+1;;){if(S==t)break e;if(A<a.length&&a[A].from==S)S=a[A++].to;else{if(ws[S]==o)break e;break}}if(c++,d)d.push(O);else{O.from>l&&i.push(new Hc(l,O.from,m));let S=O.direction==Sh!=!(m%2);mS(n,S?s+1:s,r,O.inner,O.from,O.to,i),l=O.to}y=O.to}else{if(y==t||(u?ws[y]!=o:ws[y]==o))break;y++}d?pS(n,l,y,s+1,r,d,i):l<y&&i.push(new Hc(l,y,m)),l=y}else for(let l=t,c=a.length;l>e;){let u=!0,h=!1;if(!c||l>a[c-1].to){let O=ws[l-1];O!=o&&(u=!1,h=O==16)}let d=!u&&o==1?[]:null,m=u?s:s+1,y=l;e:for(;;)if(c&&y==a[c-1].to){if(h)break e;let O=a[--c];if(!u)for(let S=O.from,A=c;;){if(S==e)break e;if(A&&a[A-1].to==S)S=a[--A].from;else{if(ws[S-1]==o)break e;break}}if(d)d.push(O);else{O.to<l&&i.push(new Hc(O.to,l,m));let S=O.direction==Sh!=!(m%2);mS(n,S?s+1:s,r,O.inner,O.from,O.to,i),l=O.from}y=O.from}else{if(y==e||(u?ws[y-1]!=o:ws[y-1]==o))break;y--}d?pS(n,y,l,s+1,r,d,i):y<l&&i.push(new Hc(y,l,m)),l=y}}function mS(n,e,t,s,r,a,i){let o=e%2?2:1;vOe(n,r,a,s,o),OOe(n,r,a,s,o),wOe(r,a,s,o),pS(n,r,a,e,t,s,i)}function xOe(n,e,t){if(!n)return[new Hc(0,0,e==HA?1:0)];if(e==Sh&&!t.length&&!yOe.test(n))return Dz(n.length);if(t.length)for(;n.length>ws.length;)ws[ws.length]=256;let s=[],r=e==Sh?0:1;return mS(n,r,r,t,0,n.length,s),s}function Dz(n){return[new Hc(0,n,0)]}let Tz="";function kOe(n,e,t,s,r){var a;let i=s.head-n.from,o=Hc.find(e,i,(a=s.bidiLevel)!==null&&a!==void 0?a:-1,s.assoc),l=e[o],c=l.side(r,t);if(i==c){let d=o+=r?1:-1;if(d<0||d>=e.length)return null;l=e[o=d],i=l.side(!r,t),c=l.side(r,t)}let u=qr(n.text,i,l.forward(r,t));(u<l.from||u>l.to)&&(u=c),Tz=n.text.slice(Math.min(i,u),Math.max(i,u));let h=o==(r?e.length-1:0)?null:e[o+(r?1:-1)];return h&&u==c&&h.level+(r?0:1)<l.level?Ve.cursor(h.side(!r,t)+n.from,h.forward(r,t)?1:-1,h.level):Ve.cursor(u+n.from,l.forward(r,t)?-1:1,l.level)}function SOe(n,e,t){for(let s=e;s<t;s++){let r=Ez(n.charCodeAt(s));if(r==1)return Sh;if(r==2||r==4)return HA}return Sh}const Bz=_t.define(),Fz=_t.define(),$z=_t.define(),Nz=_t.define(),fS=_t.define(),_z=_t.define(),Rz=_t.define(),YA=_t.define(),KA=_t.define(),Iz=_t.define({combine:n=>n.some(e=>e)}),Lz=_t.define({combine:n=>n.some(e=>e)}),Qz=_t.define();class bd{constructor(e,t="nearest",s="nearest",r=5,a=5,i=!1){this.range=e,this.y=t,this.x=s,this.yMargin=r,this.xMargin=a,this.isSnapshot=i}map(e){return e.empty?this:new bd(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new bd(Ve.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const i0=ln.define({map:(n,e)=>n.map(e)}),jz=ln.define();function ni(n,e,t){let s=n.facet(Nz);s.length?s[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const lc=_t.define({combine:n=>n.length?n[0]:!0});let COe=0;const pm=_t.define();class nr{constructor(e,t,s,r,a){this.id=e,this.create=t,this.domEventHandlers=s,this.domEventObservers=r,this.extension=a(this)}static define(e,t){const{eventHandlers:s,eventObservers:r,provide:a,decorations:i}=t||{};return new nr(COe++,e,s,r,o=>{let l=[pm.of(o)];return i&&l.push(kf.of(c=>{let u=c.plugin(o);return u?i(u):Yt.none})),a&&l.push(a(o)),l})}static fromClass(e,t){return nr.define(s=>new e(s),t)}}class Ww{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(s){if(ni(t.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){ni(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(s){ni(e.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Vz=_t.define(),JA=_t.define(),kf=_t.define(),Zz=_t.define(),eE=_t.define(),zz=_t.define();function IT(n,e){let t=n.state.facet(zz);if(!t.length)return t;let s=t.map(a=>a instanceof Function?a(n):a),r=[];return cs.spans(s,e.from,e.to,{point(){},span(a,i,o,l){let c=a-e.from,u=i-e.from,h=r;for(let d=o.length-1;d>=0;d--,l--){let m=o[d].spec.bidiIsolate,y;if(m==null&&(m=SOe(e.text,c,u)),l>0&&h.length&&(y=h[h.length-1]).to==c&&y.direction==m)y.to=u,h=y.inner;else{let O={from:c,to:u,direction:m,inner:[]};h.push(O),h=O.inner}}}}),r}const qz=_t.define();function tE(n){let e=0,t=0,s=0,r=0;for(let a of n.state.facet(qz)){let i=a(n);i&&(i.left!=null&&(e=Math.max(e,i.left)),i.right!=null&&(t=Math.max(t,i.right)),i.top!=null&&(s=Math.max(s,i.top)),i.bottom!=null&&(r=Math.max(r,i.bottom)))}return{left:e,right:t,top:s,bottom:r}}const mm=_t.define();class oo{constructor(e,t,s,r){this.fromA=e,this.toA=t,this.fromB=s,this.toB=r}join(e){return new oo(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,s=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>s.toA)){if(r.toA<s.fromA)break;s=s.join(r),e.splice(t-1,1)}}return e.splice(t,0,s),e}static extendWithRanges(e,t){if(t.length==0)return e;let s=[];for(let r=0,a=0,i=0,o=0;;r++){let l=r==e.length?null:e[r],c=i-o,u=l?l.fromB:1e9;for(;a<t.length&&t[a]<u;){let h=t[a],d=t[a+1],m=Math.max(o,h),y=Math.min(u,d);if(m<=y&&new oo(m+c,y+c,m,y).addToSet(s),d>u)break;a+=2}if(!l)return s;new oo(l.fromA,l.toA,l.fromB,l.toB).addToSet(s),i=l.toA,o=l.toB}}}class Vy{constructor(e,t,s){this.view=e,this.state=t,this.transactions=s,this.flags=0,this.startState=e.state,this.changes=kr.empty(this.startState.doc.length);for(let a of s)this.changes=this.changes.compose(a.changes);let r=[];this.changes.iterChangedRanges((a,i,o,l)=>r.push(new oo(a,i,o,l))),this.changedRanges=r}static create(e,t,s){return new Vy(e,t,s)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class LT extends ks{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Yt.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new dr],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new oo(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let s=e.changedRanges;this.minWidth>0&&s.length&&(s.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let r=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?r=this.domChanged.newSel.head:!BOe(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let a=r>-1?AOe(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;s=new oo(c,u,e.changes.mapPos(c,-1),e.changes.mapPos(u,1)).addToSet(s.slice())}this.hasComposition=a?{from:a.range.fromB,to:a.range.toB}:null,(Mt.ie||Mt.chrome)&&!a&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,o=this.updateDeco(),l=DOe(i,o,e.changes);return s=oo.extendWithRanges(s,l),!(this.flags&7)&&s.length==0?!1:(this.updateInner(s,e.startState.doc.length,a),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,s){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,s);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let i=Mt.chrome||Mt.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,i),this.flags&=-8,i&&(i.written||r.selectionRange.focusNode!=i.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(i=>i.flags&=-9);let a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let i of this.children)i instanceof fc&&i.widget instanceof hS&&a.push(i.dom);r.updateGaps(a)}updateChildren(e,t,s){let r=s?s.range.addToSet(e.slice()):e,a=this.childCursor(t);for(let i=r.length-1;;i--){let o=i>=0?r[i]:null;if(!o)break;let{fromA:l,toA:c,fromB:u,toB:h}=o,d,m,y,O;if(s&&s.range.fromB<h&&s.range.toB>u){let N=Lm.build(this.view.state.doc,u,s.range.fromB,this.decorations,this.dynamicDecorationMap),$=Lm.build(this.view.state.doc,s.range.toB,h,this.decorations,this.dynamicDecorationMap);m=N.breakAtStart,y=N.openStart,O=$.openEnd;let L=this.compositionView(s);$.breakAtStart?L.breakAfter=1:$.content.length&&L.merge(L.length,L.length,$.content[0],!1,$.openStart,0)&&(L.breakAfter=$.content[0].breakAfter,$.content.shift()),N.content.length&&L.merge(0,0,N.content[N.content.length-1],!0,0,N.openEnd)&&N.content.pop(),d=N.content.concat(L).concat($.content)}else({content:d,breakAtStart:m,openStart:y,openEnd:O}=Lm.build(this.view.state.doc,u,h,this.decorations,this.dynamicDecorationMap));let{i:S,off:A}=a.findPos(c,1),{i:F,off:j}=a.findPos(l,-1);vz(this,F,j,S,A,d,m,y,O)}s&&this.fixCompositionDOM(s)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let s of t.effects)s.is(jz)&&(this.editContextFormatting=s.value)}compositionView(e){let t=new Ho(e.text.nodeValue);t.flags|=8;for(let{deco:r}of e.marks)t=new Sc(r,[t],t.length);let s=new dr;return s.append(t,0),s}fixCompositionDOM(e){let t=(a,i)=>{i.flags|=8|(i.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(i);let o=ks.get(a);o&&o!=i&&(o.dom=null),i.setDOM(a)},s=this.childPos(e.range.fromB,1),r=this.children[s.i];t(e.line,r);for(let a=e.marks.length-1;a>=-1;a--)s=r.childPos(s.off,1),r=r.children[s.i],t(a>=0?e.marks[a].node:e.text,r)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let s=this.view.root.activeElement,r=s==this.dom,a=!r&&!(this.view.state.facet(lc)||this.dom.tabIndex>-1)&&lb(this.dom,this.view.observer.selectionRange)&&!(s&&this.dom.contains(s));if(!(r||t||a))return;let i=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(o.anchor)),c=o.empty?l:this.moveToLine(this.domAtPos(o.head));if(Mt.gecko&&o.empty&&!this.hasComposition&&POe(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=c=new ia(h,0),i=!0}let u=this.view.observer.selectionRange;(i||!u.focusNode||(!Im(l.node,l.offset,u.anchorNode,u.anchorOffset)||!Im(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,o))&&(this.view.observer.ignore(()=>{Mt.android&&Mt.chrome&&this.dom.contains(u.focusNode)&&TOe(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=wf(this.view.root);if(h)if(o.empty){if(Mt.gecko){let d=EOe(l.node,l.offset);if(d&&d!=3){let m=(d==1?gz:bz)(l.node,l.offset);m&&(l=new ia(m.node,m.offset))}}h.collapse(l.node,l.offset),o.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=o.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(c.node,c.offset)}catch{}}else{let d=document.createRange();o.anchor>o.head&&([l,c]=[c,l]),d.setEnd(c.node,c.offset),d.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(d)}a&&this.view.root.activeElement==this.dom&&(this.dom.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new ia(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new ia(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Im(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,s=wf(e.root),{anchorNode:r,anchorOffset:a}=e.observer.selectionRange;if(!s||!t.empty||!t.assoc||!s.modify)return;let i=dr.find(this,t.head);if(!i)return;let o=i.posAtStart;if(t.head==o||t.head==o+i.length)return;let l=this.coordsAt(t.head,-1),c=this.coordsAt(t.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(t.head+t.assoc);s.collapse(u.node,u.offset),s.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&s.collapse(r,a)}moveToLine(e){let t=this.dom,s;if(e.node!=t)return e;for(let r=e.offset;!s&&r<t.childNodes.length;r++){let a=ks.get(t.childNodes[r]);a instanceof dr&&(s=a.domAtPos(0))}for(let r=e.offset-1;!s&&r>=0;r--){let a=ks.get(t.childNodes[r]);a instanceof dr&&(s=a.domAtPos(a.length))}return s?new ia(s.node,s.offset,!0):e}nearest(e){for(let t=e;t;){let s=ks.get(t);if(s&&s.rootView==this)return s;t=t.parentNode}return null}posFromDOM(e,t){let s=this.nearest(e);if(!s)throw new RangeError("Trying to find position for a DOM position outside of the document");return s.localPosFromDOM(e,t)+s.posAtStart}domAtPos(e){let{i:t,off:s}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(s<r.length||r instanceof dr)break;t++,s=0}return this.children[t].domAtPos(s)}coordsAt(e,t){let s=null,r=0;for(let a=this.length,i=this.children.length-1;i>=0;i--){let o=this.children[i],l=a-o.breakAfter,c=l-o.length;if(l<e)break;if(c<=e&&(c<e||o.covers(-1))&&(l>e||o.covers(1))&&(!s||o instanceof dr&&!(s instanceof dr&&t>=0)))s=o,r=c;else if(s&&c==e&&l==e&&o instanceof fc&&Math.abs(t)<2){if(o.deco.startSide<0)break;i&&(s=null)}a=c}return s?s.coordsAt(e-r,t):null}coordsForChar(e){let{i:t,off:s}=this.childPos(e,1),r=this.children[t];if(!(r instanceof dr))return null;for(;r.children.length;){let{i:o,off:l}=r.childPos(s,1);for(;;o++){if(o==r.children.length)return null;if((r=r.children[o]).length)break}s=l}if(!(r instanceof Ho))return null;let a=qr(r.text,s);if(a==s)return null;let i=kh(r.dom,s,a).getClientRects();for(let o=0;o<i.length;o++){let l=i[o];if(o==i.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:s,to:r}=e,a=this.view.contentDOM.clientWidth,i=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==Ss.LTR;for(let c=0,u=0;u<this.children.length;u++){let h=this.children[u],d=c+h.length;if(d>r)break;if(c>=s){let m=h.dom.getBoundingClientRect();if(t.push(m.height),i){let y=h.dom.lastChild,O=y?xf(y):[];if(O.length){let S=O[O.length-1],A=l?S.right-m.left:m.right-S.left;A>o&&(o=A,this.minWidth=a,this.minWidthFrom=c,this.minWidthTo=d)}}}c=d+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Ss.RTL:Ss.LTR}measureTextSize(){for(let a of this.children)if(a instanceof dr){let i=a.measureTextSize();if(i)return i}let e=document.createElement("div"),t,s,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let a=xf(e.firstChild)[0];t=e.getBoundingClientRect().height,s=a?a.width/27:7,r=a?a.height:t,e.remove()}),{lineHeight:t,charWidth:s,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new yz(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let s=0,r=0;;r++){let a=r==t.viewports.length?null:t.viewports[r],i=a?a.from-1:this.length;if(i>s){let o=(t.lineBlockAt(i).bottom-t.lineBlockAt(s).top)/this.view.scaleY;e.push(Yt.replace({widget:new hS(o),block:!0,inclusive:!0,isBlockGap:!0}).range(s,i))}if(!a)break;s=a.to+1}return Yt.set(e)}updateDeco(){let e=1,t=this.view.state.facet(kf).map(a=>(this.dynamicDecorationMap[e++]=typeof a=="function")?a(this.view):a),s=!1,r=this.view.state.facet(Zz).map((a,i)=>{let o=typeof a=="function";return o&&(s=!0),o?a(this.view):a});for(r.length&&(this.dynamicDecorationMap[e++]=s,t.push(cs.join(r))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(Qz))try{if(c(this.view,e.range,e))return!0}catch(u){ni(this.view.state,u,"scroll handler")}let{range:t}=e,s=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!s)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(s={left:Math.min(s.left,r.left),top:Math.min(s.top,r.top),right:Math.max(s.right,r.right),bottom:Math.max(s.bottom,r.bottom)});let a=tE(this.view),i={left:s.left-a.left,top:s.top-a.top,right:s.right+a.right,bottom:s.bottom+a.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;iOe(this.view.scrollDOM,i,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Ss.LTR)}}function POe(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function Uz(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let s=gz(t.focusNode,t.focusOffset),r=bz(t.focusNode,t.focusOffset),a=s||r;if(r&&s&&r.node!=s.node){let o=ks.get(r.node);if(!o||o instanceof Ho&&o.text!=r.node.nodeValue)a=r;else if(n.docView.lastCompositionAfterCursor){let l=ks.get(s.node);!l||l instanceof Ho&&l.text!=s.node.nodeValue||(a=r)}}if(n.docView.lastCompositionAfterCursor=a!=s,!a)return null;let i=e-a.offset;return{from:i,to:i+a.node.nodeValue.length,node:a.node}}function AOe(n,e,t){let s=Uz(n,t);if(!s)return null;let{node:r,from:a,to:i}=s,o=r.nodeValue;if(/[\n\r]/.test(o)||n.state.doc.sliceString(s.from,s.to)!=o)return null;let l=e.invertedDesc,c=new oo(l.mapPos(a),l.mapPos(i),a,i),u=[];for(let h=r.parentNode;;h=h.parentNode){let d=ks.get(h);if(d instanceof Sc)u.push({node:h,deco:d.mark});else{if(d instanceof dr||h.nodeName=="DIV"&&h.parentNode==n.contentDOM)return{range:c,text:r,marks:u,line:h};if(h!=n.contentDOM)u.push({node:h,deco:new hg({inclusive:!0,attributes:mOe(h),tagName:h.tagName.toLowerCase()})});else return null}}}function EOe(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let MOe=class{constructor(){this.changes=[]}compareRange(n,e){cb(n,e,this.changes)}comparePoint(n,e){cb(n,e,this.changes)}boundChange(n){cb(n,n,this.changes)}};function DOe(n,e,t){let s=new MOe;return cs.compare(n,e,t,s),s.changes}function TOe(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function BOe(n,e){let t=!1;return e&&n.iterChangedRanges((s,r)=>{s<e.to&&r>e.from&&(t=!0)}),t}function FOe(n,e,t=1){let s=n.charCategorizer(e),r=n.doc.lineAt(e),a=e-r.from;if(r.length==0)return Ve.cursor(e);a==0?t=1:a==r.length&&(t=-1);let i=a,o=a;t<0?i=qr(r.text,a,!1):o=qr(r.text,a);let l=s(r.text.slice(i,o));for(;i>0;){let c=qr(r.text,i,!1);if(s(r.text.slice(c,i))!=l)break;i=c}for(;o<r.length;){let c=qr(r.text,o);if(s(r.text.slice(o,c))!=l)break;o=c}return Ve.range(i+r.from,o+r.from)}function $Oe(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function NOe(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function Gw(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function QT(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function jT(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function gS(n,e,t){let s,r,a,i,o=!1,l,c,u,h;for(let y=n.firstChild;y;y=y.nextSibling){let O=xf(y);for(let S=0;S<O.length;S++){let A=O[S];r&&Gw(r,A)&&(A=QT(jT(A,r.bottom),r.top));let F=$Oe(e,A),j=NOe(t,A);if(F==0&&j==0)return y.nodeType==3?VT(y,e,t):gS(y,e,t);if(!s||i>j||i==j&&a>F){s=y,r=A,a=F,i=j;let N=j?t<A.top?-1:1:F?e<A.left?-1:1:0;o=!N||(N>0?S<O.length-1:S>0)}F==0?t>A.bottom&&(!u||u.bottom<A.bottom)?(l=y,u=A):t<A.top&&(!h||h.top>A.top)&&(c=y,h=A):u&&Gw(u,A)?u=jT(u,A.bottom):h&&Gw(h,A)&&(h=QT(h,A.top))}}if(u&&u.bottom>=t?(s=l,r=u):h&&h.top<=t&&(s=c,r=h),!s)return{node:n,offset:0};let d=Math.max(r.left,Math.min(r.right,e));if(s.nodeType==3)return VT(s,d,t);if(o&&s.contentEditable!="false")return gS(s,d,t);let m=Array.prototype.indexOf.call(n.childNodes,s)+(e>=(r.left+r.right)/2?1:0);return{node:n,offset:m}}function VT(n,e,t){let s=n.nodeValue.length,r=-1,a=1e9,i=0;for(let o=0;o<s;o++){let l=kh(n,o,o+1).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(u.top==u.bottom)continue;i||(i=e-u.left);let h=(u.top>t?u.top-t:t-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&h<a){let d=e>=(u.left+u.right)/2,m=d;if((Mt.chrome||Mt.gecko)&&kh(n,o).getBoundingClientRect().left==u.right&&(m=!d),h<=0)return{node:n,offset:o+(m?1:0)};r=o+(m?1:0),a=h}}}return{node:n,offset:r>-1?r:i>0?n.nodeValue.length:0}}function Wz(n,e,t,s=-1){var r,a;let i=n.contentDOM.getBoundingClientRect(),o=i.top+n.viewState.paddingTop,l,{docHeight:c}=n.viewState,{x:u,y:h}=e,d=h-o;if(d<0)return 0;if(d>c)return n.state.doc.length;for(let N=n.viewState.heightOracle.textHeight/2,$=!1;l=n.elementAtHeight(d),l.type!=Ca.Text;)for(;d=s>0?l.bottom+N:l.top-N,!(d>=0&&d<=c);){if($)return t?null:0;$=!0,s=-s}h=o+d;let m=l.from;if(m<n.viewport.from)return n.viewport.from==0?0:t?null:ZT(n,i,l,u,h);if(m>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:ZT(n,i,l,u,h);let y=n.dom.ownerDocument,O=n.root.elementFromPoint?n.root:y,S=O.elementFromPoint(u,h);S&&!n.contentDOM.contains(S)&&(S=null),S||(u=Math.max(i.left+1,Math.min(i.right-1,u)),S=O.elementFromPoint(u,h),S&&!n.contentDOM.contains(S)&&(S=null));let A,F=-1;if(S&&((r=n.docView.nearest(S))===null||r===void 0?void 0:r.isEditable)!=!1){if(y.caretPositionFromPoint){let N=y.caretPositionFromPoint(u,h);N&&({offsetNode:A,offset:F}=N)}else if(y.caretRangeFromPoint){let N=y.caretRangeFromPoint(u,h);N&&({startContainer:A,startOffset:F}=N,(!n.contentDOM.contains(A)||Mt.safari&&_Oe(A,F,u)||Mt.chrome&&ROe(A,F,u))&&(A=void 0))}A&&(F=Math.min(Rl(A),F))}if(!A||!n.docView.dom.contains(A)){let N=dr.find(n.docView,m);if(!N)return d>l.top+l.height/2?l.to:l.from;({node:A,offset:F}=gS(N.dom,u,h))}let j=n.docView.nearest(A);if(!j)return null;if(j.isWidget&&((a=j.dom)===null||a===void 0?void 0:a.nodeType)==1){let N=j.dom.getBoundingClientRect();return e.y<N.top||e.y<=N.bottom&&e.x<=(N.left+N.right)/2?j.posAtStart:j.posAtEnd}else return j.localPosFromDOM(A,F)+j.posAtStart}function ZT(n,e,t,s,r){let a=Math.round((s-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let o=n.viewState.heightOracle.textHeight,l=Math.floor((r-t.top-(n.defaultLineHeight-o)*.5)/o);a+=l*n.viewState.heightOracle.lineLength}let i=n.state.sliceDoc(t.from,t.to);return t.from+nS(i,a,n.state.tabSize)}function _Oe(n,e,t){let s;if(n.nodeType!=3||e!=(s=n.nodeValue.length))return!1;for(let r=n.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return kh(n,s-1,s).getBoundingClientRect().left>t}function ROe(n,e,t){if(e!=0)return!1;for(let r=n;;){let a=r.parentNode;if(!a||a.nodeType!=1||a.firstChild!=r)return!1;if(a.classList.contains("cm-line"))break;r=a}let s=n.nodeType==1?n.getBoundingClientRect():kh(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-s.left>5}function bS(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let s of t.type)if(s.to>e||s.to==e&&(s.to==t.to||s.type==Ca.Text))return s}return t}function IOe(n,e,t,s){let r=bS(n,e.head),a=!s||r.type!=Ca.Text||!(n.lineWrapping||r.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(a){let i=n.dom.getBoundingClientRect(),o=n.textDirectionAt(r.from),l=n.posAtCoords({x:t==(o==Ss.LTR)?i.right-1:i.left+1,y:(a.top+a.bottom)/2});if(l!=null)return Ve.cursor(l,t?-1:1)}return Ve.cursor(t?r.to:r.from,t?-1:1)}function zT(n,e,t,s){let r=n.state.doc.lineAt(e.head),a=n.bidiSpans(r),i=n.textDirectionAt(r.from);for(let o=e,l=null;;){let c=kOe(r,a,i,o,t),u=Tz;if(!c){if(r.number==(t?n.state.doc.lines:1))return o;u=`
`,r=n.state.doc.line(r.number+(t?1:-1)),a=n.bidiSpans(r),c=n.visualLineSide(r,!t)}if(l){if(!l(u))return o}else{if(!s)return c;l=s(u)}o=c}}function LOe(n,e,t){let s=n.state.charCategorizer(e),r=s(t);return a=>{let i=s(a);return r==gr.Space&&(r=i),r==i}}function QOe(n,e,t,s){let r=e.head,a=t?1:-1;if(r==(t?n.state.doc.length:0))return Ve.cursor(r,e.assoc);let i=e.goalColumn,o,l=n.contentDOM.getBoundingClientRect(),c=n.coordsAtPos(r,e.assoc||-1),u=n.documentTop;if(c)i==null&&(i=c.left-l.left),o=a<0?c.top:c.bottom;else{let m=n.viewState.lineBlockAt(r);i==null&&(i=Math.min(l.right-l.left,n.defaultCharacterWidth*(r-m.from))),o=(a<0?m.top:m.bottom)+u}let h=l.left+i,d=s??n.viewState.heightOracle.textHeight>>1;for(let m=0;;m+=10){let y=o+(d+m)*a,O=Wz(n,{x:h,y},!1,a);if(y<l.top||y>l.bottom||(a<0?O<r:O>r)){let S=n.docView.coordsForChar(O),A=!S||y<S.top?-1:1;return Ve.cursor(O,A,void 0,i)}}}function ub(n,e,t){for(;;){let s=0;for(let r of n)r.between(e-1,e+1,(a,i,o)=>{if(e>a&&e<i){let l=s||t||(e-a<i-e?-1:1);e=l<0?a:i,s=l}});if(!s)return e}}function Xw(n,e,t){let s=ub(n.state.facet(eE).map(r=>r(n)),t.from,e.head>t.from?-1:1);return s==t.from?t:Ve.cursor(s,s<t.from?1:-1)}const fm="￿";class jOe{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(rs.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=fm}readRange(e,t){if(!e)return this;let s=e.parentNode;for(let r=e;;){this.findPointBefore(s,r);let a=this.text.length;this.readNode(r);let i=r.nextSibling;if(i==t)break;let o=ks.get(r),l=ks.get(i);(o&&l?o.breakAfter:(o?o.breakAfter:Qy(r))||Qy(i)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>a)&&this.lineBreak(),r=i}return this.findPointBefore(s,t),this}readTextNode(e){let t=e.nodeValue;for(let s of this.points)s.node==e&&(s.pos=this.text.length+Math.min(s.offset,t.length));for(let s=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let a=-1,i=1,o;if(this.lineSeparator?(a=t.indexOf(this.lineSeparator,s),i=this.lineSeparator.length):(o=r.exec(t))&&(a=o.index,i=o[0].length),this.append(t.slice(s,a<0?t.length:a)),a<0)break;if(this.lineBreak(),i>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=i-1);s=a+i}}readNode(e){if(e.cmIgnore)return;let t=ks.get(e),s=t&&t.overrideDOMText;if(s!=null){this.findPointInside(e,s.length);for(let r=s.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let s of this.points)s.node==e&&e.childNodes[s.offset]==t&&(s.pos=this.text.length)}findPointInside(e,t){for(let s of this.points)(e.nodeType==3?s.node==e:e.contains(s.node))&&(s.pos=this.text.length+(VOe(e,s.node,s.offset)?t:0))}}function VOe(n,e,t){for(;;){if(!e||t<Rl(e))return!1;if(e==n)return!0;t=xh(e)+1,e=e.parentNode}}class qT{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class ZOe{constructor(e,t,s,r){this.typeOver=r,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:a,impreciseAnchor:i}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,s,0))){let o=a||i?[]:UOe(e),l=new jOe(o,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=WOe(o,this.bounds.from)}else{let o=e.observer.selectionRange,l=a&&a.node==o.focusNode&&a.offset==o.focusOffset||!aS(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),c=i&&i.node==o.anchorNode&&i.offset==o.anchorOffset||!aS(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),u=e.viewport;if((Mt.ios||Mt.chrome)&&e.state.selection.main.empty&&l!=c&&(u.from>0||u.to<e.state.doc.length)){let h=Math.min(l,c),d=Math.max(l,c),m=u.from-h,y=u.to-d;(m==0||m==1||h==0)&&(y==0||y==-1||d==e.state.doc.length)&&(l=0,c=e.state.doc.length)}this.newSel=Ve.single(c,l)}}}function Gz(n,e){let t,{newSel:s}=e,r=n.state.selection.main,a=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:i,to:o}=e.bounds,l=r.from,c=null;(a===8||Mt.android&&e.text.length<o-i)&&(l=r.to,c="end");let u=qOe(n.state.doc.sliceString(i,o,fm),e.text,l-i,c);u&&(Mt.chrome&&a==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==fm+fm&&u.toB--,t={from:i+u.from,to:i+u.toA,insert:ts.of(e.text.slice(u.from,u.toB).split(fm))})}else s&&(!n.hasFocus&&n.state.facet(lc)||s.main.eq(r))&&(s=null);if(!t&&!s)return!1;if(!t&&e.typeOver&&!r.empty&&s&&s.main.empty?t={from:r.from,to:r.to,insert:n.state.doc.slice(r.from,r.to)}:(Mt.mac||Mt.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(s&&t.insert.length==2&&(s=Ve.single(s.main.anchor-1,s.main.head-1)),t={from:t.from,to:t.to,insert:ts.of([t.insert.toString().replace("."," ")])}):t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:n.state.doc.slice(r.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,r.to))}:Mt.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(s&&(s=Ve.single(s.main.anchor-1,s.main.head-1)),t={from:r.from,to:r.to,insert:ts.of([" "])}),t)return nE(n,t,s,a);if(s&&!s.main.eq(r)){let i=!1,o="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(i=!0),o=n.inputState.lastSelectionOrigin),n.dispatch({selection:s,scrollIntoView:i,userEvent:o}),!0}else return!1}function nE(n,e,t,s=-1){if(Mt.ios&&n.inputState.flushIOSKey(e))return!0;let r=n.state.selection.main;if(Mt.android&&(e.to==r.to&&(e.from==r.from||e.from==r.from-1&&n.state.sliceDoc(e.from,r.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&gd(n.contentDOM,"Enter",13)||(e.from==r.from-1&&e.to==r.to&&e.insert.length==0||s==8&&e.insert.length<e.to-e.from&&e.to>r.head)&&gd(n.contentDOM,"Backspace",8)||e.from==r.from&&e.to==r.to+1&&e.insert.length==0&&gd(n.contentDOM,"Delete",46)))return!0;let a=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let i,o=()=>i||(i=zOe(n,e,t));return n.state.facet(_z).some(l=>l(n,e.from,e.to,a,o))||n.dispatch(o()),!0}function zOe(n,e,t){let s,r=n.state,a=r.selection.main;if(e.from>=a.from&&e.to<=a.to&&e.to-e.from>=(a.to-a.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let o=a.from<e.from?r.sliceDoc(a.from,e.from):"",l=a.to>e.to?r.sliceDoc(e.to,a.to):"";s=r.replaceSelection(n.state.toText(o+e.insert.sliceString(0,void 0,n.state.lineBreak)+l))}else{let o=r.changes(e),l=t&&t.main.to<=o.newLength?t.main:void 0;if(r.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=a.to&&e.to>=a.to-10){let c=n.state.sliceDoc(e.from,e.to),u,h=t&&Uz(n,t.main.head);if(h){let y=e.insert.length-(e.to-e.from);u={from:h.from,to:h.to-y}}else u=n.state.doc.lineAt(a.head);let d=a.to-e.to,m=a.to-a.from;s=r.changeByRange(y=>{if(y.from==a.from&&y.to==a.to)return{changes:o,range:l||y.map(o)};let O=y.to-d,S=O-c.length;if(y.to-y.from!=m||n.state.sliceDoc(S,O)!=c||y.to>=u.from&&y.from<=u.to)return{range:y};let A=r.changes({from:S,to:O,insert:e.insert}),F=y.to-a.to;return{changes:A,range:l?Ve.range(Math.max(0,l.anchor+F),Math.max(0,l.head+F)):y.map(A)}})}else s={changes:o,selection:l&&r.selection.replaceRange(l)}}let i="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,i+=".compose",n.inputState.compositionFirstChange&&(i+=".start",n.inputState.compositionFirstChange=!1)),r.update(s,{userEvent:i,scrollIntoView:!0})}function qOe(n,e,t,s){let r=Math.min(n.length,e.length),a=0;for(;a<r&&n.charCodeAt(a)==e.charCodeAt(a);)a++;if(a==r&&n.length==e.length)return null;let i=n.length,o=e.length;for(;i>0&&o>0&&n.charCodeAt(i-1)==e.charCodeAt(o-1);)i--,o--;if(s=="end"){let l=Math.max(0,a-Math.min(i,o));t-=i+l-a}if(i<a&&n.length<e.length){let l=t<=a&&t>=i?a-t:0;a-=l,o=a+(o-i),i=a}else if(o<a){let l=t<=a&&t>=o?a-t:0;a-=l,i=a+(i-o),o=a}return{from:a,toA:i,toB:o}}function UOe(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:s,focusNode:r,focusOffset:a}=n.observer.selectionRange;return t&&(e.push(new qT(t,s)),(r!=t||a!=s)&&e.push(new qT(r,a))),e}function WOe(n,e){if(n.length==0)return null;let t=n[0].pos,s=n.length==2?n[1].pos:t;return t>-1&&s>-1?Ve.single(t+e,s+e):null}class GOe{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Mt.safari&&e.contentDOM.addEventListener("input",()=>null),Mt.gecko&&uwe(e.contentDOM.ownerDocument)}handleEvent(e){!nwe(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let s=this.handlers[e];if(s){for(let r of s.observers)r(this.view,t);for(let r of s.handlers){if(t.defaultPrevented)break;if(r(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=XOe(e),s=this.handlers,r=this.view.contentDOM;for(let a in t)if(a!="scroll"){let i=!t[a].handlers.length,o=s[a];o&&i!=!o.handlers.length&&(r.removeEventListener(a,this.handleEvent),o=null),o||r.addEventListener(a,this.handleEvent,{passive:i})}for(let a in s)a!="scroll"&&!t[a]&&r.removeEventListener(a,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&Hz.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Mt.android&&Mt.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return Mt.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=Xz.find(s=>s.keyCode==e.keyCode))&&!e.ctrlKey||HOe.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,gd(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Mt.safari&&!Mt.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function UT(n,e){return(t,s)=>{try{return e.call(n,s,t)}catch(r){ni(t.state,r)}}}function XOe(n){let e=Object.create(null);function t(s){return e[s]||(e[s]={observers:[],handlers:[]})}for(let s of n){let r=s.spec;if(r&&r.domEventHandlers)for(let a in r.domEventHandlers){let i=r.domEventHandlers[a];i&&t(a).handlers.push(UT(s.value,i))}if(r&&r.domEventObservers)for(let a in r.domEventObservers){let i=r.domEventObservers[a];i&&t(a).observers.push(UT(s.value,i))}}for(let s in Yo)t(s).handlers.push(Yo[s]);for(let s in co)t(s).observers.push(co[s]);return e}const Xz=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],HOe="dthko",Hz=[16,17,18,20,91,92,224,225],o0=6;function l0(n){return Math.max(0,n)*.7+8}function YOe(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class KOe{constructor(e,t,s,r){this.view=e,this.startEvent=t,this.style=s,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=oOe(e.contentDOM),this.atoms=e.state.facet(eE).map(i=>i(e));let a=e.contentDOM.ownerDocument;a.addEventListener("mousemove",this.move=this.move.bind(this)),a.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(rs.allowMultipleSelections)&&JOe(e,t),this.dragging=twe(e,t)&&Jz(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&YOe(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,s=0,r=0,a=0,i=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:r,right:i}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:a,bottom:o}=this.scrollParents.y.getBoundingClientRect());let l=tE(this.view);e.clientX-l.left<=r+o0?t=-l0(r-e.clientX):e.clientX+l.right>=i-o0&&(t=l0(e.clientX-i)),e.clientY-l.top<=a+o0?s=-l0(a-e.clientY):e.clientY+l.bottom>=o-o0&&(s=l0(e.clientY-o)),this.setScrollSpeed(t,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let s=0;s<e.ranges.length;s++){let r=e.ranges[s],a=null;if(r.empty){let i=ub(this.atoms,r.from,0);i!=r.from&&(a=Ve.cursor(i,-1))}else{let i=ub(this.atoms,r.from,-1),o=ub(this.atoms,r.to,1);(i!=r.from||o!=r.to)&&(a=Ve.range(r.from==r.anchor?i:o,r.from==r.head?i:o))}a&&(t||(t=e.ranges.slice()),t[s]=a)}return t?Ve.create(t,e.mainIndex):e}select(e){let{view:t}=this,s=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!s.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:s,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function JOe(n,e){let t=n.state.facet(Bz);return t.length?t[0](e):Mt.mac?e.metaKey:e.ctrlKey}function ewe(n,e){let t=n.state.facet(Fz);return t.length?t[0](e):Mt.mac?!e.altKey:!e.ctrlKey}function twe(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let s=wf(n.root);if(!s||s.rangeCount==0)return!0;let r=s.getRangeAt(0).getClientRects();for(let a=0;a<r.length;a++){let i=r[a];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}function nwe(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,s;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(s=ks.get(t))&&s.ignoreEvent(e))return!1;return!0}const Yo=Object.create(null),co=Object.create(null),Yz=Mt.ie&&Mt.ie_version<15||Mt.ios&&Mt.webkit_version<604;function swe(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),Kz(n,t.value)},50)}function _v(n,e,t){for(let s of n.facet(e))t=s(t,n);return t}function Kz(n,e){e=_v(n.state,YA,e);let{state:t}=n,s,r=1,a=t.toText(e),i=a.lines==t.selection.ranges.length;if(yS!=null&&t.selection.ranges.every(o=>o.empty)&&yS==a.toString()){let o=-1;s=t.changeByRange(l=>{let c=t.doc.lineAt(l.from);if(c.from==o)return{range:l};o=c.from;let u=t.toText((i?a.line(r++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:u},range:Ve.cursor(l.from+u.length)}})}else i?s=t.changeByRange(o=>{let l=a.line(r++);return{changes:{from:o.from,to:o.to,insert:l.text},range:Ve.cursor(o.from+l.length)}}):s=t.replaceSelection(a);n.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}co.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Yo.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);co.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};co.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Yo.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let s of n.state.facet($z))if(t=s(n,e),t)break;if(!t&&e.button==0&&(t=iwe(n,e)),t){let s=!n.hasFocus;n.inputState.startMouseSelection(new KOe(n,e,t,s)),s&&n.observer.ignore(()=>{pz(n.contentDOM);let a=n.root.activeElement;a&&!a.contains(n.contentDOM)&&a.blur()});let r=n.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function WT(n,e,t,s){if(s==1)return Ve.cursor(e,t);if(s==2)return FOe(n.state,e,t);{let r=dr.find(n.docView,e),a=n.state.doc.lineAt(r?r.posAtEnd:e),i=r?r.posAtStart:a.from,o=r?r.posAtEnd:a.to;return o<n.state.doc.length&&o==a.to&&o++,Ve.range(i,o)}}let GT=(n,e,t)=>e>=t.top&&e<=t.bottom&&n>=t.left&&n<=t.right;function rwe(n,e,t,s){let r=dr.find(n.docView,e);if(!r)return 1;let a=e-r.posAtStart;if(a==0)return 1;if(a==r.length)return-1;let i=r.coordsAt(a,-1);if(i&&GT(t,s,i))return-1;let o=r.coordsAt(a,1);return o&&GT(t,s,o)?1:i&&i.bottom>=s?-1:1}function XT(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:rwe(n,t,e.clientX,e.clientY)}}const awe=Mt.ie&&Mt.ie_version<=11;let HT=null,YT=0,KT=0;function Jz(n){if(!awe)return n.detail;let e=HT,t=KT;return HT=n,KT=Date.now(),YT=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(YT+1)%3:1}function iwe(n,e){let t=XT(n,e),s=Jz(e),r=n.state.selection;return{update(a){a.docChanged&&(t.pos=a.changes.mapPos(t.pos),r=r.map(a.changes))},get(a,i,o){let l=XT(n,a),c,u=WT(n,l.pos,l.bias,s);if(t.pos!=l.pos&&!i){let h=WT(n,t.pos,t.bias,s),d=Math.min(h.from,u.from),m=Math.max(h.to,u.to);u=d<u.from?Ve.range(d,m):Ve.range(m,d)}return i?r.replaceRange(r.main.extend(u.from,u.to)):o&&s==1&&r.ranges.length>1&&(c=owe(r,l.pos))?c:o?r.addRange(u):Ve.create([u])}}}function owe(n,e){for(let t=0;t<n.ranges.length;t++){let{from:s,to:r}=n.ranges[t];if(s<=e&&r>=e)return Ve.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}Yo.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let r=n.docView.nearest(e.target);if(r&&r.isWidget){let a=r.posAtStart,i=a+r.length;(a>=t.to||i<=t.from)&&(t=Ve.range(a,i))}}let{inputState:s}=n;return s.mouseSelection&&(s.mouseSelection.dragging=!0),s.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",_v(n.state,KA,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Yo.dragend=n=>(n.inputState.draggedContent=null,!1);function JT(n,e,t,s){if(t=_v(n.state,YA,t),!t)return;let r=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:a}=n.inputState,i=s&&a&&ewe(n,e)?{from:a.from,to:a.to}:null,o={from:r,insert:t},l=n.state.changes(i?[i,o]:o);n.focus(),n.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:i?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Yo.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let s=Array(t.length),r=0,a=()=>{++r==t.length&&JT(n,e,s.filter(i=>i!=null).join(n.state.lineBreak),!1)};for(let i=0;i<t.length;i++){let o=new FileReader;o.onerror=a,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(s[i]=o.result),a()},o.readAsText(t[i])}return!0}else{let s=e.dataTransfer.getData("Text");if(s)return JT(n,e,s,!0),!0}return!1};Yo.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=Yz?null:e.clipboardData;return t?(Kz(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(swe(n),!1)};function lwe(n,e){let t=n.dom.parentNode;if(!t)return;let s=t.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=e,s.focus(),s.selectionEnd=e.length,s.selectionStart=0,setTimeout(()=>{s.remove(),n.focus()},50)}function cwe(n){let e=[],t=[],s=!1;for(let r of n.selection.ranges)r.empty||(e.push(n.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:a}of n.selection.ranges){let i=n.doc.lineAt(a);i.number>r&&(e.push(i.text),t.push({from:i.from,to:Math.min(n.doc.length,i.to+1)})),r=i.number}s=!0}return{text:_v(n,KA,e.join(n.lineBreak)),ranges:t,linewise:s}}let yS=null;Yo.copy=Yo.cut=(n,e)=>{let{text:t,ranges:s,linewise:r}=cwe(n.state);if(!t&&!r)return!1;yS=r?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let a=Yz?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",t),!0):(lwe(n,t),!1)};const eq=Dc.define();function tq(n,e){let t=[];for(let s of n.facet(Rz)){let r=s(n,e);r&&t.push(r)}return t?n.update({effects:t,annotations:eq.of(!0)}):null}function nq(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=tq(n.state,e);t?n.dispatch(t):n.update([])}},10)}co.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),nq(n)};co.blur=n=>{n.observer.clearSelectionRange(),nq(n)};co.compositionstart=co.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};co.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Mt.chrome&&Mt.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};co.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Yo.beforeinput=(n,e)=>{var t,s;if(e.inputType=="insertReplacementText"&&n.observer.editContext){let a=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),i=e.getTargetRanges();if(a&&i.length){let o=i[0],l=n.posAtDOM(o.startContainer,o.startOffset),c=n.posAtDOM(o.endContainer,o.endOffset);return nE(n,{from:l,to:c,insert:n.state.toText(a)},null),!0}}let r;if(Mt.chrome&&Mt.android&&(r=Xz.find(a=>a.inputType==e.inputType))&&(n.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let a=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var i;(((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0)>a+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Mt.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),Mt.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>co.compositionend(n,e),20),!1};const e4=new Set;function uwe(n){e4.has(n)||(e4.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const t4=["pre-wrap","normal","pre-line","break-spaces"];let Zd=!1;function n4(){Zd=!1}class hwe{constructor(e){this.lineWrapping=e,this.doc=ts.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let s=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((t-e-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return t4.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let s=0;s<e.length;s++){let r=e[s];r<0?s++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,s,r,a,i){let o=t4.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=s,this.textHeight=r,this.lineLength=a,l){this.heightSamples={};for(let c=0;c<i.length;c++){let u=i[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class dwe{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class wl{constructor(e,t,s,r,a){this.from=e,this.length=t,this.top=s,this.height=r,this._content=a}get type(){return typeof this._content=="number"?Ca.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof vu?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new wl(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var $s=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})($s||($s={}));const hb=.001;class Pa{constructor(e,t,s=2){this.length=e,this.height=t,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>hb&&(Zd=!0),this.height=e)}replace(e,t,s){return Pa.of(s)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,s,r){let a=this,i=s.doc;for(let o=r.length-1;o>=0;o--){let{fromA:l,toA:c,fromB:u,toB:h}=r[o],d=a.lineAt(l,$s.ByPosNoHeight,s.setDoc(t),0,0),m=d.to>=c?d:a.lineAt(c,$s.ByPosNoHeight,s,0,0);for(h+=m.to-c,c=m.to;o>0&&d.from<=r[o-1].toA;)l=r[o-1].fromA,u=r[o-1].fromB,o--,l<d.from&&(d=a.lineAt(l,$s.ByPosNoHeight,s,0,0));u+=d.from-l,l=d.from;let y=sE.build(s.setDoc(i),e,u,h);a=Zy(a,a.replace(l,c,y))}return a.updateHeight(s,0)}static empty(){return new Ai(0,0)}static of(e){if(e.length==1)return e[0];let t=0,s=e.length,r=0,a=0;for(;;)if(t==s)if(r>a*2){let o=e[t-1];o.break?e.splice(--t,1,o.left,null,o.right):e.splice(--t,1,o.left,o.right),s+=1+o.break,r-=o.size}else if(a>r*2){let o=e[s];o.break?e.splice(s,1,o.left,null,o.right):e.splice(s,1,o.left,o.right),s+=2+o.break,a-=o.size}else break;else if(r<a){let o=e[t++];o&&(r+=o.size)}else{let o=e[--s];o&&(a+=o.size)}let i=0;return e[t-1]==null?(i=1,t--):e[t]==null&&(i=1,s++),new pwe(Pa.of(e.slice(0,t)),i,Pa.of(e.slice(s)))}}function Zy(n,e){return n==e?n:(n.constructor!=e.constructor&&(Zd=!0),e)}Pa.prototype.size=1;class sq extends Pa{constructor(e,t,s){super(e,t),this.deco=s}blockAt(e,t,s,r){return new wl(r,this.length,s,this.height,this.deco||0)}lineAt(e,t,s,r,a){return this.blockAt(0,s,r,a)}forEachLine(e,t,s,r,a,i){e<=a+this.length&&t>=a&&i(this.blockAt(0,s,r,a))}updateHeight(e,t=0,s=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ai extends sq{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,s,r){return new wl(r,this.length,s,this.height,this.breaks)}replace(e,t,s){let r=s[0];return s.length==1&&(r instanceof Ai||r instanceof Vr&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Vr?r=new Ai(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Pa.of(s)}updateHeight(e,t=0,s=!1,r){return r&&r.from<=t&&r.more?this.setHeight(r.heights[r.index++]):(s||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Vr extends Pa{constructor(e){super(e,0)}heightMetrics(e,t){let s=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,a=r-s+1,i,o=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*a);i=l/a,this.length>a+1&&(o=(this.height-l)/(this.length-a-1))}else i=this.height/a;return{firstLine:s,lastLine:r,perLine:i,perChar:o}}blockAt(e,t,s,r){let{firstLine:a,lastLine:i,perLine:o,perChar:l}=this.heightMetrics(t,r);if(t.lineWrapping){let c=r+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-s)/this.height))*this.length)),u=t.doc.lineAt(c),h=o+u.length*l,d=Math.max(s,e-h/2);return new wl(u.from,u.length,d,h,0)}else{let c=Math.max(0,Math.min(i-a,Math.floor((e-s)/o))),{from:u,length:h}=t.doc.line(a+c);return new wl(u,h,s+o*c,o,0)}}lineAt(e,t,s,r,a){if(t==$s.ByHeight)return this.blockAt(e,s,r,a);if(t==$s.ByPosNoHeight){let{from:m,to:y}=s.doc.lineAt(e);return new wl(m,y-m,0,0,0)}let{firstLine:i,perLine:o,perChar:l}=this.heightMetrics(s,a),c=s.doc.lineAt(e),u=o+c.length*l,h=c.number-i,d=r+o*h+l*(c.from-a-h);return new wl(c.from,c.length,Math.max(r,Math.min(d,r+this.height-u)),u,0)}forEachLine(e,t,s,r,a,i){e=Math.max(e,a),t=Math.min(t,a+this.length);let{firstLine:o,perLine:l,perChar:c}=this.heightMetrics(s,a);for(let u=e,h=r;u<=t;){let d=s.doc.lineAt(u);if(u==e){let y=d.number-o;h+=l*y+c*(e-a-y)}let m=l+c*d.length;i(new wl(d.from,d.length,h,m,0)),h+=m,u=d.to+1}}replace(e,t,s){let r=this.length-t;if(r>0){let a=s[s.length-1];a instanceof Vr?s[s.length-1]=new Vr(a.length+r):s.push(null,new Vr(r-1))}if(e>0){let a=s[0];a instanceof Vr?s[0]=new Vr(e+a.length):s.unshift(new Vr(e-1),null)}return Pa.of(s)}decomposeLeft(e,t){t.push(new Vr(e-1),null)}decomposeRight(e,t){t.push(null,new Vr(this.length-e-1))}updateHeight(e,t=0,s=!1,r){let a=t+this.length;if(r&&r.from<=t+this.length&&r.more){let i=[],o=Math.max(t,r.from),l=-1;for(r.from>t&&i.push(new Vr(r.from-t-1).updateHeight(e,t));o<=a&&r.more;){let u=e.doc.lineAt(o).length;i.length&&i.push(null);let h=r.heights[r.index++];l==-1?l=h:Math.abs(h-l)>=hb&&(l=-2);let d=new Ai(u,h);d.outdated=!1,i.push(d),o+=u+1}o<=a&&i.push(null,new Vr(a-o).updateHeight(e,o));let c=Pa.of(i);return(l<0||Math.abs(c.height-this.height)>=hb||Math.abs(l-this.heightMetrics(e,t).perLine)>=hb)&&(Zd=!0),Zy(this,c)}else(s||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class pwe extends Pa{constructor(e,t,s){super(e.length+t+s.length,e.height+s.height,t|(e.outdated||s.outdated?2:0)),this.left=e,this.right=s,this.size=e.size+s.size}get break(){return this.flags&1}blockAt(e,t,s,r){let a=s+this.left.height;return e<a?this.left.blockAt(e,t,s,r):this.right.blockAt(e,t,a,r+this.left.length+this.break)}lineAt(e,t,s,r,a){let i=r+this.left.height,o=a+this.left.length+this.break,l=t==$s.ByHeight?e<i:e<o,c=l?this.left.lineAt(e,t,s,r,a):this.right.lineAt(e,t,s,i,o);if(this.break||(l?c.to<o:c.from>o))return c;let u=t==$s.ByPosNoHeight?$s.ByPosNoHeight:$s.ByPos;return l?c.join(this.right.lineAt(o,u,s,i,o)):this.left.lineAt(o,u,s,r,a).join(c)}forEachLine(e,t,s,r,a,i){let o=r+this.left.height,l=a+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,s,r,a,i),t>=l&&this.right.forEachLine(e,t,s,o,l,i);else{let c=this.lineAt(l,$s.ByPos,s,r,a);e<c.from&&this.left.forEachLine(e,c.from-1,s,r,a,i),c.to>=e&&c.from<=t&&i(c),t>c.to&&this.right.forEachLine(c.to+1,t,s,o,l,i)}}replace(e,t,s){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,s),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,s));let a=[];e>0&&this.decomposeLeft(e,a);let i=a.length;for(let o of s)a.push(o);if(e>0&&s4(a,i-1),t<this.length){let o=a.length;this.decomposeRight(t,a),s4(a,o)}return Pa.of(a)}decomposeLeft(e,t){let s=this.left.length;if(e<=s)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(s++,e>=s&&t.push(null)),e>s&&this.right.decomposeLeft(e-s,t)}decomposeRight(e,t){let s=this.left.length,r=s+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<s&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Pa.of(this.break?[e,null,t]:[e,t]):(this.left=Zy(this.left,e),this.right=Zy(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,s=!1,r){let{left:a,right:i}=this,o=t+a.length+this.break,l=null;return r&&r.from<=t+a.length&&r.more?l=a=a.updateHeight(e,t,s,r):a.updateHeight(e,t,s),r&&r.from<=o+i.length&&r.more?l=i=i.updateHeight(e,o,s,r):i.updateHeight(e,o,s),l?this.balanced(a,i):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function s4(n,e){let t,s;n[e]==null&&(t=n[e-1])instanceof Vr&&(s=n[e+1])instanceof Vr&&n.splice(e-1,3,new Vr(t.length+1+s.length))}const mwe=5;class sE{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let s=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof Ai?r.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new Ai(s-this.pos,-1)),this.writtenTo=s,t>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,s){if(e<t||s.heightRelevant){let r=s.widget?s.widget.estimatedHeight:0,a=s.widget?s.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let i=t-e;s.block?this.addBlock(new sq(i,r,s)):(i||a||r>=mwe)&&this.addLineDeco(r,a,i)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ai(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let s=new Vr(t-e);return this.oracle.doc.lineAt(e).to==t&&(s.flags|=4),s}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ai)return e;let t=new Ai(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,s){let r=this.ensureLine();r.length+=s,r.collapsed+=s,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+s}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Ai)&&!this.isCovered?this.nodes.push(new Ai(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=e;for(let r of this.nodes)r instanceof Ai&&r.updateHeight(this.oracle,s),s+=r?r.length:1;return this.nodes}static build(e,t,s,r){let a=new sE(s,e);return cs.spans(t,s,r,a,0),a.finish(s)}}function fwe(n,e,t){let s=new gwe;return cs.compare(n,e,t,s,0),s.changes}class gwe{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,s,r){(e<t||s&&s.heightRelevant||r&&r.heightRelevant)&&cb(e,t,this.changes,5)}}function bwe(n,e){let t=n.getBoundingClientRect(),s=n.ownerDocument,r=s.defaultView||window,a=Math.max(0,t.left),i=Math.min(r.innerWidth,t.right),o=Math.max(0,t.top),l=Math.min(r.innerHeight,t.bottom);for(let c=n.parentNode;c&&c!=s.body;)if(c.nodeType==1){let u=c,h=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&h.overflow!="visible"){let d=u.getBoundingClientRect();a=Math.max(a,d.left),i=Math.min(i,d.right),o=Math.max(o,d.top),l=Math.min(c==n.parentNode?r.innerHeight:l,d.bottom)}c=h.position=="absolute"||h.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:a-t.left,right:Math.max(a,i)-t.left,top:o-(t.top+e),bottom:Math.max(o,l)-(t.top+e)}}function ywe(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function vwe(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Hw{constructor(e,t,s,r){this.from=e,this.to=t,this.size=s,this.displaySize=r}static same(e,t){if(e.length!=t.length)return!1;for(let s=0;s<e.length;s++){let r=e[s],a=t[s];if(r.from!=a.from||r.to!=a.to||r.size!=a.size)return!1}return!0}draw(e,t){return Yt.replace({widget:new Owe(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Owe extends el{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class r4{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=a4,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ss.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(JA).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new hwe(t),this.stateDeco=e.facet(kf).filter(s=>typeof s!="function"),this.heightMap=Pa.empty().applyChanges(this.stateDeco,ts.empty,this.heightOracle.setDoc(e.doc),[new oo(0,0,0,e.doc.length)]);for(let s=0;s<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());s++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Yt.set(this.lineGaps.map(s=>s.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let s=0;s<=1;s++){let r=s?t.head:t.anchor;if(!e.some(({from:a,to:i})=>r>=a&&r<=i)){let{from:a,to:i}=this.lineBlockAt(r);e.push(new c0(a,i))}}return this.viewports=e.sort((s,r)=>s.from-r.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?a4:new rE(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(gm(e,this.scaler))})}update(e,t=null){this.state=e.state;let s=this.stateDeco;this.stateDeco=this.state.facet(kf).filter(u=>typeof u!="function");let r=e.changedRanges,a=oo.extendWithRanges(r,fwe(s,this.stateDeco,e?e.changes:kr.empty(this.state.doc.length))),i=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);n4(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),(this.heightMap.height!=i||Zd)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Lz)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,s=window.getComputedStyle(t),r=this.heightOracle,a=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?Ss.RTL:Ss.LTR;let i=this.heightOracle.mustRefreshForWrapping(a),o=t.getBoundingClientRect(),l=i||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let c=0,u=0;if(o.width&&o.height){let{scaleX:N,scaleY:$}=dz(t,o);(N>.005&&Math.abs(this.scaleX-N)>.005||$>.005&&Math.abs(this.scaleY-$)>.005)&&(this.scaleX=N,this.scaleY=$,c|=16,i=l=!0)}let h=(parseInt(s.paddingTop)||0)*this.scaleY,d=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=d)&&(this.paddingTop=h,this.paddingBottom=d,c|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=16);let m=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=m&&(this.scrollAnchorHeight=-1,this.scrollTop=m),this.scrolledToBottom=fz(e.scrollDOM);let y=(this.printing?vwe:bwe)(t,this.paddingTop),O=y.top-this.pixelViewport.top,S=y.bottom-this.pixelViewport.bottom;this.pixelViewport=y;let A=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(A!=this.inView&&(this.inView=A,A&&(l=!0)),!this.inView&&!this.scrollTarget&&!ywe(e.dom))return 0;let F=o.width;if((this.contentDOMWidth!=F||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,c|=16),l){let N=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(N)&&(i=!0),i||r.lineWrapping&&Math.abs(F-this.contentDOMWidth)>r.charWidth){let{lineHeight:$,charWidth:L,textHeight:I}=e.docView.measureTextSize();i=$>0&&r.refresh(a,$,L,I,F/L,N),i&&(e.docView.minWidth=0,c|=16)}O>0&&S>0?u=Math.max(O,S):O<0&&S<0&&(u=Math.min(O,S)),n4();for(let $ of this.viewports){let L=$.from==this.viewport.from?N:e.docView.measureVisibleLineHeights($);this.heightMap=(i?Pa.empty().applyChanges(this.stateDeco,ts.empty,this.heightOracle,[new oo(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,i,new dwe($.from,L))}Zd&&(c|=2)}let j=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return j&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||j)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(i?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let s=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,a=this.heightOracle,{visibleTop:i,visibleBottom:o}=this,l=new c0(r.lineAt(i-s*1e3,$s.ByHeight,a,0,0).from,r.lineAt(o+(1-s)*1e3,$s.ByHeight,a,0,0).to);if(t){let{head:c}=t.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=r.lineAt(c,$s.ByPos,a,0,0),d;t.y=="center"?d=(h.top+h.bottom)/2-u/2:t.y=="start"||t.y=="nearest"&&c<l.from?d=h.top:d=h.bottom-u,l=new c0(r.lineAt(d-1e3/2,$s.ByHeight,a,0,0).from,r.lineAt(d+u+1e3/2,$s.ByHeight,a,0,0).to)}}return l}mapViewport(e,t){let s=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new c0(this.heightMap.lineAt(s,$s.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,$s.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},s=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,$s.ByPos,this.heightOracle,0,0),{bottom:a}=this.heightMap.lineAt(t,$s.ByPos,this.heightOracle,0,0),{visibleTop:i,visibleBottom:o}=this;return(e==0||r<=i-Math.max(10,Math.min(-s,250)))&&(t==this.state.doc.length||a>=o+Math.max(10,Math.min(s,250)))&&r>i-2*1e3&&a<o+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let s=[];for(let r of e)t.touchesRange(r.from,r.to)||s.push(new Hw(t.mapPos(r.from),t.mapPos(r.to),r.size,r.displaySize));return s}ensureLineGaps(e,t){let s=this.heightOracle.lineWrapping,r=s?1e4:2e3,a=r>>1,i=r<<1;if(this.defaultTextDirection!=Ss.LTR&&!s)return[];let o=[],l=(u,h,d,m)=>{if(h-u<a)return;let y=this.state.selection.main,O=[y.from];y.empty||O.push(y.to);for(let A of O)if(A>u&&A<h){l(u,A-10,d,m),l(A+10,h,d,m);return}let S=xwe(e,A=>A.from>=d.from&&A.to<=d.to&&Math.abs(A.from-u)<a&&Math.abs(A.to-h)<a&&!O.some(F=>A.from<F&&A.to>F));if(!S){if(h<d.to&&t&&s&&t.visibleRanges.some(j=>j.from<=h&&j.to>=h)){let j=t.moveToLineBoundary(Ve.cursor(h),!1,!0).head;j>u&&(h=j)}let A=this.gapSize(d,u,h,m),F=s||A<2e6?A:2e6;S=new Hw(u,h,A,F)}o.push(S)},c=u=>{if(u.length<i||u.type!=Ca.Text)return;let h=wwe(u.from,u.to,this.stateDeco);if(h.total<i)return;let d=this.scrollTarget?this.scrollTarget.range.head:null,m,y;if(s){let O=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,S,A;if(d!=null){let F=h0(h,d),j=((this.visibleBottom-this.visibleTop)/2+O)/u.height;S=F-j,A=F+j}else S=(this.visibleTop-u.top-O)/u.height,A=(this.visibleBottom-u.top+O)/u.height;m=u0(h,S),y=u0(h,A)}else{let O=h.total*this.heightOracle.charWidth,S=r*this.heightOracle.charWidth,A=0;if(O>2e6)for(let L of e)L.from>=u.from&&L.from<u.to&&L.size!=L.displaySize&&L.from*this.heightOracle.charWidth+A<this.pixelViewport.left&&(A=L.size-L.displaySize);let F=this.pixelViewport.left+A,j=this.pixelViewport.right+A,N,$;if(d!=null){let L=h0(h,d),I=((j-F)/2+S)/O;N=L-I,$=L+I}else N=(F-S)/O,$=(j+S)/O;m=u0(h,N),y=u0(h,$)}m>u.from&&l(u.from,m,u,h),y<u.to&&l(y,u.to,u,h)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return o}gapSize(e,t,s,r){let a=h0(r,s)-h0(r,t);return this.heightOracle.lineWrapping?e.height*a:r.total*this.heightOracle.charWidth*a}updateLineGaps(e){Hw.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Yt.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let s=[];cs.spans(t,this.viewport.from,this.viewport.to,{span(a,i){s.push({from:a,to:i})},point(){}},20);let r=0;if(s.length!=this.visibleRanges.length)r=12;else for(let a=0;a<s.length&&!(r&8);a++){let i=this.visibleRanges[a],o=s[a];(i.from!=o.from||i.to!=o.to)&&(r|=4,e&&e.mapPos(i.from,-1)==o.from&&e.mapPos(i.to,1)==o.to||(r|=8))}return this.visibleRanges=s,r}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||gm(this.heightMap.lineAt(e,$s.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||gm(this.heightMap.lineAt(this.scaler.fromDOM(e),$s.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return gm(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class c0{constructor(e,t){this.from=e,this.to=t}}function wwe(n,e,t){let s=[],r=n,a=0;return cs.spans(t,n,e,{span(){},point(i,o){i>r&&(s.push({from:r,to:i}),a+=i-r),r=o}},20),r<e&&(s.push({from:r,to:e}),a+=e-r),{total:a,ranges:s}}function u0({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let s=Math.floor(n*t);for(let r=0;;r++){let{from:a,to:i}=e[r],o=i-a;if(s<=o)return a+s;s-=o}}function h0(n,e){let t=0;for(let{from:s,to:r}of n.ranges){if(e<=r){t+=e-s;break}t+=r-s}return t/n.total}function xwe(n,e){for(let t of n)if(e(t))return t}const a4={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};class rE{constructor(e,t,s){let r=0,a=0,i=0;this.viewports=s.map(({from:o,to:l})=>{let c=t.lineAt(o,$s.ByPos,e,0,0).top,u=t.lineAt(l,$s.ByPos,e,0,0).bottom;return r+=u-c,{from:o,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let o of this.viewports)o.domTop=i+(o.top-a)*this.scale,i=o.domBottom=o.domTop+(o.bottom-o.top),a=o.bottom}toDOM(e){for(let t=0,s=0,r=0;;t++){let a=t<this.viewports.length?this.viewports[t]:null;if(!a||e<a.top)return r+(e-s)*this.scale;if(e<=a.bottom)return a.domTop+(e-a.top);s=a.bottom,r=a.domBottom}}fromDOM(e){for(let t=0,s=0,r=0;;t++){let a=t<this.viewports.length?this.viewports[t]:null;if(!a||e<a.domTop)return s+(e-r)/this.scale;if(e<=a.domBottom)return a.top+(e-a.domTop);s=a.bottom,r=a.domBottom}}eq(e){return e instanceof rE?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,s)=>t.from==e.viewports[s].from&&t.to==e.viewports[s].to):!1}}function gm(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),s=e.toDOM(n.bottom);return new wl(n.from,n.length,t,s-t,Array.isArray(n._content)?n._content.map(r=>gm(r,e)):n._content)}const d0=_t.define({combine:n=>n.join(" ")}),vS=_t.define({combine:n=>n.indexOf(!0)>-1}),OS=bu.newName(),rq=bu.newName(),aq=bu.newName(),iq={"&light":"."+rq,"&dark":"."+aq};function wS(n,e,t){return new bu(e,{finish(s){return/&/.test(s)?s.replace(/&\w*/,r=>{if(r=="&")return n;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):n+" "+s}})}const kwe=wS("."+OS,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},iq),Swe={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Yw=Mt.ie&&Mt.ie_version<=11;class Cwe{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new lOe,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let s of t)this.queue.push(s);(Mt.ie&&Mt.ie_version<=11||Mt.ios&&e.composing)&&t.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(Mt.chrome&&Mt.chrome_version<126)&&(this.editContext=new Awe(e),e.state.facet(lc)&&(e.contentDOM.editContext=this.editContext.editContext)),Yw&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,s)=>t!=e[s]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,r=this.selectionRange;if(s.state.facet(lc)?s.root.activeElement!=this.dom:!lb(this.dom,r))return;let a=r.anchorNode&&s.docView.nearest(r.anchorNode);if(a&&a.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Mt.ie&&Mt.ie_version<=11||Mt.android&&Mt.chrome)&&!s.state.selection.main.empty&&r.focusNode&&Im(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=wf(e.root);if(!t)return!1;let s=Mt.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&Pwe(this.view,t)||t;if(!s||this.selectionRange.eq(s))return!1;let r=lb(this.dom,s);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&uOe(this.dom,s)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(s),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let s=this.dom;s;)if(s.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==s?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=t)s.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Swe),Yw&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Yw&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var s;if(!this.delayedAndroidKey){let r=()=>{let a=this.delayedAndroidKey;a&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=a.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&a.force&&gd(this.dom,a.key,a.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,s=-1,r=!1;for(let a of e){let i=this.readMutation(a);i&&(i.typeOver&&(r=!0),t==-1?{from:t,to:s}=i:(t=Math.min(i.from,t),s=Math.max(i.to,s)))}return{from:t,to:s,typeOver:r}}readChange(){let{from:e,to:t,typeOver:s}=this.processRecords(),r=this.selectionChanged&&lb(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let a=new ZOe(this.view,e,t,s);return this.view.docView.domChanged={newSel:a.newSel?a.newSel.main:null},a}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let s=this.view.state,r=Gz(this.view,t);return this.view.state==s&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let s=i4(t,e.previousSibling||e.target.previousSibling,-1),r=i4(t,e.nextSibling||e.target.nextSibling,1);return{from:s?t.posAfter(s):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(lc)!=e.state.facet(lc)&&(e.view.contentDOM.editContext=e.state.facet(lc)?this.editContext.editContext:null))}destroy(){var e,t,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function i4(n,e,t){for(;e;){let s=ks.get(e);if(s&&s.parent==n)return s;let r=e.parentNode;e=r!=n.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function o4(n,e){let t=e.startContainer,s=e.startOffset,r=e.endContainer,a=e.endOffset,i=n.docView.domAtPos(n.state.selection.main.anchor);return Im(i.node,i.offset,r,a)&&([t,s,r,a]=[r,a,t,s]),{anchorNode:t,anchorOffset:s,focusNode:r,focusOffset:a}}function Pwe(n,e){if(e.getComposedRanges){let r=e.getComposedRanges(n.root)[0];if(r)return o4(n,r)}let t=null;function s(r){r.preventDefault(),r.stopImmediatePropagation(),t=r.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",s,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",s,!0),t?o4(n,t):null}class Awe{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=s=>{let r=e.state.selection.main,{anchor:a,head:i}=r,o=this.toEditorPos(s.updateRangeStart),l=this.toEditorPos(s.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:s.updateRangeStart,editorBase:o,drifted:!1});let c={from:o,to:l,insert:ts.of(s.text.split(`
`))};if(c.from==this.from&&a<this.from?c.from=a:c.to==this.to&&a>this.to&&(c.to=a),c.from==c.to&&!c.insert.length){let u=Ve.single(this.toEditorPos(s.selectionStart),this.toEditorPos(s.selectionEnd));u.main.eq(r)||e.dispatch({selection:u,userEvent:"select"});return}if((Mt.mac||Mt.android)&&c.from==i-1&&/^\. ?$/.test(s.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:o,to:l,insert:ts.of([s.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let u=this.to-this.from+(c.to-c.from+c.insert.length);nE(e,c,Ve.single(this.toEditorPos(s.selectionStart,u),this.toEditorPos(s.selectionEnd,u)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=s=>{let r=[],a=null;for(let i=this.toEditorPos(s.rangeStart),o=this.toEditorPos(s.rangeEnd);i<o;i++){let l=e.coordsForChar(i);a=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||a||new DOMRect,r.push(a)}t.updateCharacterBounds(s.rangeStart,r)},this.handlers.textformatupdate=s=>{let r=[];for(let a of s.getTextFormats()){let i=a.underlineStyle,o=a.underlineThickness;if(i!="None"&&o!="None"){let l=this.toEditorPos(a.rangeStart),c=this.toEditorPos(a.rangeEnd);if(l<c){let u=`text-decoration: underline ${i=="Dashed"?"dashed ":i=="Squiggle"?"wavy ":""}${o=="Thin"?1:2}px`;r.push(Yt.mark({attributes:{style:u}}).range(l,c))}}}e.dispatch({effects:jz.of(Yt.set(r))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:s}=this.composing;this.composing=null,s&&this.reset(e.state)}};for(let s in this.handlers)t.addEventListener(s,this.handlers[s]);this.measureReq={read:s=>{this.editContext.updateControlBounds(s.contentDOM.getBoundingClientRect());let r=wf(s.root);r&&r.rangeCount&&this.editContext.updateSelectionBounds(r.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,s=!1,r=this.pendingContextChange;return e.changes.iterChanges((a,i,o,l,c)=>{if(s)return;let u=c.length-(i-a);if(r&&i>=r.to)if(r.from==a&&r.to==i&&r.insert.eq(c)){r=this.pendingContextChange=null,t+=u,this.to+=u;return}else r=null,this.revertPending(e.state);if(a+=t,i+=t,i<=this.from)this.from+=u,this.to+=u;else if(a<this.to){if(a<this.from||i>this.to||this.to-this.from+c.length>3e4){s=!0;return}this.editContext.updateText(this.toContextPos(a),this.toContextPos(i),c.toString()),this.to+=u}t+=u}),r&&!s&&this.revertPending(e.state),!s}update(e){let t=this.pendingContextChange;this.composing&&(this.composing.drifted||e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,s=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),r=this.toContextPos(t.head);(this.editContext.selectionStart!=s||this.editContext.selectionEnd!=r)&&this.editContext.updateSelection(s,r)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let s=this.composing;return s&&s.drifted?s.editorBase+(e-s.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class vt{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:s}=e;this.dispatchTransactions=e.dispatchTransactions||s&&(r=>r.forEach(a=>s(a,this)))||(r=>this.update(r)),this.dispatch=this.dispatch.bind(this),this._root=e.root||cOe(e.parent)||document,this.viewState=new r4(e.state||rs.create(e)),e.scrollTo&&e.scrollTo.is(i0)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(pm).map(r=>new Ww(r));for(let r of this.plugins)r.update(this);this.observer=new Cwe(this),this.inputState=new GOe(this),this.inputState.ensureHandlers(this.plugins),this.docView=new LT(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof Sa?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,s=!1,r,a=this.state;for(let d of e){if(d.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=d.state}if(this.destroyed){this.viewState.state=a;return}let i=this.hasFocus,o=0,l=null;e.some(d=>d.annotation(eq))?(this.inputState.notifiedFocused=i,o=1):i!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=i,l=tq(a,i),l||(o=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(u=null)):this.observer.clear(),a.facet(rs.phrases)!=this.state.facet(rs.phrases))return this.setState(a);r=Vy.create(this,a,e),r.flags|=o;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let d of e){if(h&&(h=h.map(d.changes)),d.scrollIntoView){let{main:m}=d.state.selection;h=new bd(m.empty?m:Ve.cursor(m.head,m.head>m.anchor?-1:1))}for(let m of d.effects)m.is(i0)&&(h=m.value.clip(this.state))}this.viewState.update(r,h),this.bidiCache=zy.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(mm)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(d=>d.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(d0)!=r.state.facet(d0)&&(this.viewState.mustMeasureContent=!0),(t||s||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!r.empty)for(let d of this.state.facet(fS))try{d(r)}catch(m){ni(this.state,m,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!Gz(this,u)&&c.force&&gd(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new r4(e),this.plugins=e.facet(pm).map(s=>new Ww(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView.destroy(),this.docView=new LT(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(pm),s=e.state.facet(pm);if(t!=s){let r=[];for(let a of s){let i=t.indexOf(a);if(i<0)r.push(new Ww(a));else{let o=this.plugins[i];o.mustUpdate=e,r.push(o)}}for(let a of this.plugins)a.mustUpdate!=e&&a.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);t!=s&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(s){ni(this.state,s,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,s=this.scrollDOM,r=s.scrollTop*this.scaleY,{scrollAnchorPos:a,scrollAnchorHeight:i}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(i=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(i<0)if(fz(s))a=-1,i=this.viewState.heightMap.height;else{let m=this.viewState.scrollAnchorAt(r);a=m.from,i=m.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(m=>{try{return m.read(this)}catch(y){return ni(this.state,y),l4}}),h=Vy.create(this,this.state,[]),d=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),d=this.docView.update(h),d&&this.docViewUpdate());for(let m=0;m<c.length;m++)if(u[m]!=l4)try{let y=c[m];y.write&&y.write(u[m],this)}catch(y){ni(this.state,y)}if(d&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,i=-1;continue}else{let m=(a<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(a).top)-i;if(m>1||m<-1){r=r+m,s.scrollTop=r/this.scaleY,i=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let o of this.state.facet(fS))o(t)}get themeClasses(){return OS+" "+(this.state.facet(vS)?aq:rq)+" "+this.state.facet(d0)}updateAttrs(){let e=c4(this,Vz,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(lc)?"true":"false",class:"cm-content",style:`${Mt.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),c4(this,JA,t);let s=this.observer.ignore(()=>{let r=uS(this.contentDOM,this.contentAttrs,t),a=uS(this.dom,this.editorAttrs,e);return r||a});return this.editorAttrs=e,this.contentAttrs=t,s}showAnnouncements(e){let t=!0;for(let s of e)for(let r of s.effects)if(r.is(vt.announce)){t&&(this.announceDOM.textContent=""),t=!1;let a=this.announceDOM.appendChild(document.createElement("div"));a.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(mm);let e=this.state.facet(vt.cspNonce);bu.mount(this.root,this.styleModules.concat(kwe).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(s=>s.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,s){return Xw(this,e,zT(this,e,t,s))}moveByGroup(e,t){return Xw(this,e,zT(this,e,t,s=>LOe(this,e.head,s)))}visualLineSide(e,t){let s=this.bidiSpans(e),r=this.textDirectionAt(e.from),a=s[t?s.length-1:0];return Ve.cursor(a.side(t,r)+e.from,a.forward(!t,r)?1:-1)}moveToLineBoundary(e,t,s=!0){return IOe(this,e,t,s)}moveVertically(e,t,s){return Xw(this,e,QOe(this,e,t,s))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Wz(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let s=this.docView.coordsAt(e,t);if(!s||s.left==s.right)return s;let r=this.state.doc.lineAt(e),a=this.bidiSpans(r),i=a[Hc.find(a,e-r.from,-1,t)];return $v(s,i.dir==Ss.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Iz)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Ewe)return Dz(e.length);let t=this.textDirectionAt(e.from),s;for(let a of this.bidiCache)if(a.from==e.from&&a.dir==t&&(a.fresh||Mz(a.isolates,s=IT(this,e))))return a.order;s||(s=IT(this,e));let r=xOe(e.text,t,s);return this.bidiCache.push(new zy(e.from,e.to,t,s,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Mt.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{pz(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return i0.of(new bd(typeof e=="number"?Ve.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,s=this.viewState.scrollAnchorAt(e);return i0.of(new bd(Ve.cursor(s.from),"start","start",s.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return nr.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return nr.define(()=>({}),{eventObservers:e})}static theme(e,t){let s=bu.newName(),r=[d0.of(s),mm.of(wS(`.${s}`,e))];return t&&t.dark&&r.push(vS.of(!0)),r}static baseTheme(e){return ui.lowest(mm.of(wS("."+OS,e,iq)))}static findFromDOM(e){var t;let s=e.querySelector(".cm-content"),r=s&&ks.get(s)||ks.get(e);return((t=r==null?void 0:r.rootView)===null||t===void 0?void 0:t.view)||null}}vt.styleModule=mm;vt.inputHandler=_z;vt.clipboardInputFilter=YA;vt.clipboardOutputFilter=KA;vt.scrollHandler=Qz;vt.focusChangeEffect=Rz;vt.perLineTextDirection=Iz;vt.exceptionSink=Nz;vt.updateListener=fS;vt.editable=lc;vt.mouseSelectionStyle=$z;vt.dragMovesSelection=Fz;vt.clickAddsSelectionRange=Bz;vt.decorations=kf;vt.outerDecorations=Zz;vt.atomicRanges=eE;vt.bidiIsolatedRanges=zz;vt.scrollMargins=qz;vt.darkTheme=vS;vt.cspNonce=_t.define({combine:n=>n.length?n[0]:""});vt.contentAttributes=JA;vt.editorAttributes=Vz;vt.lineWrapping=vt.contentAttributes.of({class:"cm-lineWrapping"});vt.announce=ln.define();const Ewe=4096,l4={};class zy{constructor(e,t,s,r,a,i){this.from=e,this.to=t,this.dir=s,this.isolates=r,this.fresh=a,this.order=i}static update(e,t){if(t.empty&&!e.some(a=>a.fresh))return e;let s=[],r=e.length?e[e.length-1].dir:Ss.LTR;for(let a=Math.max(0,e.length-10);a<e.length;a++){let i=e[a];i.dir==r&&!t.touchesRange(i.from,i.to)&&s.push(new zy(t.mapPos(i.from,1),t.mapPos(i.to,-1),i.dir,i.isolates,!1,i.order))}return s}}function c4(n,e,t){for(let s=n.state.facet(e),r=s.length-1;r>=0;r--){let a=s[r],i=typeof a=="function"?a(n):a;i&&cS(i,t)}return t}const Mwe=Mt.mac?"mac":Mt.windows?"win":Mt.linux?"linux":"key";function Dwe(n,e){const t=n.split(/-(?!$)/);let s=t[t.length-1];s=="Space"&&(s=" ");let r,a,i,o;for(let l=0;l<t.length-1;++l){const c=t[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))a=!0;else if(/^s(hift)?$/i.test(c))i=!0;else if(/^mod$/i.test(c))e=="mac"?o=!0:a=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(s="Alt-"+s),a&&(s="Ctrl-"+s),o&&(s="Meta-"+s),i&&(s="Shift-"+s),s}function p0(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const Twe=ui.default(vt.domEventHandlers({keydown(n,e){return lq(oq(e.state),n,e,"editor")}})),Bc=_t.define({enables:Twe}),u4=new WeakMap;function oq(n){let e=n.facet(Bc),t=u4.get(e);return t||u4.set(e,t=$we(e.reduce((s,r)=>s.concat(r),[]))),t}function Bwe(n,e,t){return lq(oq(n.state),e,n,t)}let Vc=null;const Fwe=4e3;function $we(n,e=Mwe){let t=Object.create(null),s=Object.create(null),r=(i,o)=>{let l=s[i];if(l==null)s[i]=o;else if(l!=o)throw new Error("Key binding "+i+" is used both as a regular binding and as a multi-stroke prefix")},a=(i,o,l,c,u)=>{var h,d;let m=t[i]||(t[i]=Object.create(null)),y=o.split(/ (?!$)/).map(A=>Dwe(A,e));for(let A=1;A<y.length;A++){let F=y.slice(0,A).join(" ");r(F,!0),m[F]||(m[F]={preventDefault:!0,stopPropagation:!1,run:[j=>{let N=Vc={view:j,prefix:F,scope:i};return setTimeout(()=>{Vc==N&&(Vc=null)},Fwe),!0}]})}let O=y.join(" ");r(O,!1);let S=m[O]||(m[O]={preventDefault:!1,stopPropagation:!1,run:((d=(h=m._any)===null||h===void 0?void 0:h.run)===null||d===void 0?void 0:d.slice())||[]});l&&S.run.push(l),c&&(S.preventDefault=!0),u&&(S.stopPropagation=!0)};for(let i of n){let o=i.scope?i.scope.split(" "):["editor"];if(i.any)for(let c of o){let u=t[c]||(t[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=i;for(let d in u)u[d].run.push(m=>h(m,xS))}let l=i[e]||i.key;if(l)for(let c of o)a(c,l,i.run,i.preventDefault,i.stopPropagation),i.shift&&a(c,"Shift-"+l,i.shift,i.preventDefault,i.stopPropagation)}return t}let xS=null;function lq(n,e,t,s){xS=e;let r=rOe(e),a=Ya(r,0),i=Ol(a)==r.length&&r!=" ",o="",l=!1,c=!1,u=!1;Vc&&Vc.view==t&&Vc.scope==s&&(o=Vc.prefix+" ",Hz.indexOf(e.keyCode)<0&&(c=!0,Vc=null));let h=new Set,d=S=>{if(S){for(let A of S.run)if(!h.has(A)&&(h.add(A),A(t)))return S.stopPropagation&&(u=!0),!0;S.preventDefault&&(S.stopPropagation&&(u=!0),c=!0)}return!1},m=n[s],y,O;return m&&(d(m[o+p0(r,e,!i)])?l=!0:i&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Mt.windows&&e.ctrlKey&&e.altKey)&&(y=yu[e.keyCode])&&y!=r?(d(m[o+p0(y,e,!0)])||e.shiftKey&&(O=Of[e.keyCode])!=r&&O!=y&&d(m[o+p0(O,e,!1)]))&&(l=!0):i&&e.shiftKey&&d(m[o+p0(r,e,!0)])&&(l=!0),!l&&d(m._any)&&(l=!0)),c&&(l=!0),l&&u&&e.stopPropagation(),xS=null,l}class pg{constructor(e,t,s,r,a){this.className=e,this.left=t,this.top=s,this.width=r,this.height=a}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,s){if(s.empty){let r=e.coordsAtPos(s.head,s.assoc||1);if(!r)return[];let a=cq(e);return[new pg(t,r.left-a.left,r.top-a.top,null,r.bottom-r.top)]}else return Nwe(e,t,s)}}function cq(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Ss.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function h4(n,e,t,s){let r=n.coordsAtPos(e,t*2);if(!r)return s;let a=n.dom.getBoundingClientRect(),i=(r.top+r.bottom)/2,o=n.posAtCoords({x:a.left+1,y:i}),l=n.posAtCoords({x:a.right-1,y:i});return o==null||l==null?s:{from:Math.max(s.from,Math.min(o,l)),to:Math.min(s.to,Math.max(o,l))}}function Nwe(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let s=Math.max(t.from,n.viewport.from),r=Math.min(t.to,n.viewport.to),a=n.textDirection==Ss.LTR,i=n.contentDOM,o=i.getBoundingClientRect(),l=cq(n),c=i.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),h=o.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),d=o.right-(u?parseInt(u.paddingRight):0),m=bS(n,s),y=bS(n,r),O=m.type==Ca.Text?m:null,S=y.type==Ca.Text?y:null;if(O&&(n.lineWrapping||m.widgetLineBreaks)&&(O=h4(n,s,1,O)),S&&(n.lineWrapping||y.widgetLineBreaks)&&(S=h4(n,r,-1,S)),O&&S&&O.from==S.from&&O.to==S.to)return F(j(t.from,t.to,O));{let $=O?j(t.from,null,O):N(m,!1),L=S?j(null,t.to,S):N(y,!0),I=[];return(O||m).to<(S||y).from-(O&&S?1:0)||m.widgetLineBreaks>1&&$.bottom+n.defaultLineHeight/2<L.top?I.push(A(h,$.bottom,d,L.top)):$.bottom<L.top&&n.elementAtHeight(($.bottom+L.top)/2).type==Ca.Text&&($.bottom=L.top=($.bottom+L.top)/2),F($).concat(I).concat(F(L))}function A($,L,I,q){return new pg(e,$-l.left,L-l.top,I-$,q-L)}function F({top:$,bottom:L,horizontal:I}){let q=[];for(let ce=0;ce<I.length;ce+=2)q.push(A(I[ce],$,I[ce+1],L));return q}function j($,L,I){let q=1e9,ce=-1e9,ee=[];function he(Oe,Pe,De,Se,ae){let Ee=n.coordsAtPos(Oe,Oe==I.to?-2:2),Qe=n.coordsAtPos(De,De==I.from?2:-2);!Ee||!Qe||(q=Math.min(Ee.top,Qe.top,q),ce=Math.max(Ee.bottom,Qe.bottom,ce),ae==Ss.LTR?ee.push(a&&Pe?h:Ee.left,a&&Se?d:Qe.right):ee.push(!a&&Se?h:Qe.left,!a&&Pe?d:Ee.right))}let H=$??I.from,me=L??I.to;for(let Oe of n.visibleRanges)if(Oe.to>H&&Oe.from<me)for(let Pe=Math.max(Oe.from,H),De=Math.min(Oe.to,me);;){let Se=n.state.doc.lineAt(Pe);for(let ae of n.bidiSpans(Se)){let Ee=ae.from+Se.from,Qe=ae.to+Se.from;if(Ee>=De)break;Qe>Pe&&he(Math.max(Ee,Pe),$==null&&Ee<=H,Math.min(Qe,De),L==null&&Qe>=me,ae.dir)}if(Pe=Se.to+1,Pe>=De)break}return ee.length==0&&he(H,$==null,me,L==null,n.textDirection),{top:q,bottom:ce,horizontal:ee}}function N($,L){let I=o.top+(L?$.top:$.bottom);return{top:I,bottom:I,horizontal:[]}}}function _we(n,e){return n.constructor==e.constructor&&n.eq(e)}class Rwe{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(db)!=e.state.facet(db)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,s=e.facet(db);for(;t<s.length&&s[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,s)=>!_we(t,this.drawn[s]))){let t=this.dom.firstChild,s=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[s].constructor&&r.update(t,this.drawn[s])?(t=t.nextSibling,s++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const db=_t.define();function uq(n){return[nr.define(e=>new Rwe(e,n)),db.of(n)]}const hq=!(Mt.ios&&Mt.webkit&&Mt.webkit_version<534),zd=_t.define({combine(n){return Tc(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function dq(n={}){return[zd.of(n),Iwe,Lwe,Qwe,Lz.of(!0)]}function pq(n){return n.facet(zd)}function mq(n){return n.startState.facet(zd)!=n.state.facet(zd)}const Iwe=uq({above:!0,markers(n){let{state:e}=n,t=e.facet(zd),s=[];for(let r of e.selection.ranges){let a=r==e.selection.main;if(r.empty?!a||hq:t.drawRangeCursor){let i=a?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=r.empty?r:Ve.cursor(r.head,r.head>r.anchor?-1:1);for(let l of pg.forRange(n,i,o))s.push(l)}}return s},update(n,e){n.transactions.some(s=>s.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=mq(n);return t&&d4(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){d4(e.state,n)},class:"cm-cursorLayer"});function d4(n,e){e.style.animationDuration=n.facet(zd).cursorBlinkRate+"ms"}const Lwe=uq({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:pg.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||mq(n)},class:"cm-selectionLayer"}),kS={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};hq&&(kS[".cm-line"].caretColor=kS[".cm-content"].caretColor="transparent !important");const Qwe=ui.highest(vt.theme(kS)),fq=ln.define({map(n,e){return n==null?null:e.mapPos(n)}}),bm=Us.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,s)=>s.is(fq)?s.value:t,n)}}),jwe=nr.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(bm);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(bm)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(bm),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let s=n.scrollDOM.getBoundingClientRect();return{left:t.left-s.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-s.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(bm)!=n&&this.view.dispatch({effects:fq.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Vwe(){return[bm,jwe]}function p4(n,e,t,s,r){e.lastIndex=0;for(let a=n.iterRange(t,s),i=t,o;!a.next().done;i+=a.value.length)if(!a.lineBreak)for(;o=e.exec(a.value);)r(i+o.index,o)}function Zwe(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let s=[];for(let{from:r,to:a}of t)r=Math.max(n.state.doc.lineAt(r).from,r-e),a=Math.min(n.state.doc.lineAt(a).to,a+e),s.length&&s[s.length-1].to>=r?s[s.length-1].to=a:s.push({from:r,to:a});return s}class zwe{constructor(e){const{regexp:t,decoration:s,decorate:r,boundary:a,maxLength:i=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(o,l,c,u)=>r(u,c,c+o[0].length,o,l);else if(typeof s=="function")this.addMatch=(o,l,c,u)=>{let h=s(o,l,c);h&&u(c,c+o[0].length,h)};else if(s)this.addMatch=(o,l,c,u)=>u(c,c+o[0].length,s);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=a,this.maxLength=i}createDeco(e){let t=new _l,s=t.add.bind(t);for(let{from:r,to:a}of Zwe(e,this.maxLength))p4(e.state.doc,this.regexp,r,a,(i,o)=>this.addMatch(o,e,i,s));return t.finish()}updateDeco(e,t){let s=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((a,i,o,l)=>{l>=e.view.viewport.from&&o<=e.view.viewport.to&&(s=Math.min(o,s),r=Math.max(l,r))}),e.viewportMoved||r-s>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),s,r):t}updateRange(e,t,s,r){for(let a of e.visibleRanges){let i=Math.max(a.from,s),o=Math.min(a.to,r);if(o>i){let l=e.state.doc.lineAt(i),c=l.to<o?e.state.doc.lineAt(o):l,u=Math.max(a.from,l.from),h=Math.min(a.to,c.to);if(this.boundary){for(;i>l.from;i--)if(this.boundary.test(l.text[i-1-l.from])){u=i;break}for(;o<c.to;o++)if(this.boundary.test(c.text[o-c.from])){h=o;break}}let d=[],m,y=(O,S,A)=>d.push(A.range(O,S));if(l==c)for(this.regexp.lastIndex=u-l.from;(m=this.regexp.exec(l.text))&&m.index<h-l.from;)this.addMatch(m,e,m.index+l.from,y);else p4(e.state.doc,this.regexp,u,h,(O,S)=>this.addMatch(S,e,O,y));t=t.update({filterFrom:u,filterTo:h,filter:(O,S)=>O<u||S>h,add:d})}}return t}}const SS=/x/.unicode!=null?"gu":"g",qwe=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,SS),Uwe={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Kw=null;function Wwe(){var n;if(Kw==null&&typeof document<"u"&&document.body){let e=document.body.style;Kw=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return Kw||!1}const pb=_t.define({combine(n){let e=Tc(n,{render:null,specialChars:qwe,addSpecialChars:null});return(e.replaceTabs=!Wwe())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,SS)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,SS)),e}});function gq(n={}){return[pb.of(n),Gwe()]}let m4=null;function Gwe(){return m4||(m4=nr.fromClass(class{constructor(n){this.view=n,this.decorations=Yt.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(pb)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new zwe({regexp:n.specialChars,decoration:(e,t,s)=>{let{doc:r}=t.state,a=Ya(e[0],0);if(a==9){let i=r.lineAt(s),o=t.state.tabSize,l=Op(i.text,o,s-i.from);return Yt.replace({widget:new Kwe((o-l%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[a]||(this.decorationCache[a]=Yt.replace({widget:new Ywe(n,a)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(pb);n.startState.facet(pb)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const Xwe="•";function Hwe(n){return n>=32?Xwe:n==10?"␤":String.fromCharCode(9216+n)}class Ywe extends el{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Hwe(this.code),s=e.state.phrase("Control character")+" "+(Uwe[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,s,t);if(r)return r;let a=document.createElement("span");return a.textContent=t,a.title=s,a.setAttribute("aria-label",s),a.className="cm-specialChar",a}ignoreEvent(){return!1}}class Kwe extends el{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Jwe(){return txe}const exe=Yt.line({class:"cm-activeLine"}),txe=nr.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let s of n.state.selection.ranges){let r=n.lineBlockAt(s.head);r.from>e&&(t.push(exe.range(r.from)),e=r.from)}return Yt.set(t)}},{decorations:n=>n.decorations}),CS=2e3;function nxe(n,e,t){let s=Math.min(e.line,t.line),r=Math.max(e.line,t.line),a=[];if(e.off>CS||t.off>CS||e.col<0||t.col<0){let i=Math.min(e.off,t.off),o=Math.max(e.off,t.off);for(let l=s;l<=r;l++){let c=n.doc.line(l);c.length<=o&&a.push(Ve.range(c.from+i,c.to+o))}}else{let i=Math.min(e.col,t.col),o=Math.max(e.col,t.col);for(let l=s;l<=r;l++){let c=n.doc.line(l),u=nS(c.text,i,n.tabSize,!0);if(u<0)a.push(Ve.cursor(c.to));else{let h=nS(c.text,o,n.tabSize);a.push(Ve.range(c.from+u,c.from+h))}}}return a}function sxe(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function f4(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),s=n.state.doc.lineAt(t),r=t-s.from,a=r>CS?-1:r==s.length?sxe(n,e.clientX):Op(s.text,n.state.tabSize,t-s.from);return{line:s.number,col:a,off:r}}function rxe(n,e){let t=f4(n,e),s=n.state.selection;return t?{update(r){if(r.docChanged){let a=r.changes.mapPos(r.startState.doc.line(t.line).from),i=r.state.doc.lineAt(a);t={line:i.number,col:t.col,off:Math.min(t.off,i.length)},s=s.map(r.changes)}},get(r,a,i){let o=f4(n,r);if(!o)return s;let l=nxe(n.state,t,o);return l.length?i?Ve.create(l.concat(s.ranges)):Ve.create(l):s}}:null}function axe(n){let e=t=>t.altKey&&t.button==0;return vt.mouseSelectionStyle.of((t,s)=>e(s)?rxe(t,s):null)}const ixe={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},oxe={style:"cursor: crosshair"};function lxe(n={}){let[e,t]=ixe[n.key||"Alt"],s=nr.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[s,vt.contentAttributes.of(r=>{var a;return!((a=r.plugin(s))===null||a===void 0)&&a.isDown?oxe:null})]}const Wp="-10000px";class bq{constructor(e,t,s,r){this.facet=t,this.createTooltipView=s,this.removeTooltipView=r,this.input=e.state.facet(t),this.tooltips=this.input.filter(i=>i);let a=null;this.tooltipViews=this.tooltips.map(i=>a=s(i,a))}update(e,t){var s;let r=e.state.facet(this.facet),a=r.filter(l=>l);if(r===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let i=[],o=t?[]:null;for(let l=0;l<a.length;l++){let c=a[l],u=-1;if(c){for(let h=0;h<this.tooltips.length;h++){let d=this.tooltips[h];d&&d.create==c.create&&(u=h)}if(u<0)i[l]=this.createTooltipView(c,l?i[l-1]:null),o&&(o[l]=!!c.above);else{let h=i[l]=this.tooltipViews[u];o&&(o[l]=t[u]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)i.indexOf(l)<0&&(this.removeTooltipView(l),(s=l.destroy)===null||s===void 0||s.call(l));return t&&(o.forEach((l,c)=>t[c]=l),t.length=o.length),this.input=r,this.tooltips=a,this.tooltipViews=i,!0}}function cxe(n){let{win:e}=n;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Jw=_t.define({combine:n=>{var e,t,s;return{position:Mt.ios?"absolute":((e=n.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((s=n.find(r=>r.tooltipSpace))===null||s===void 0?void 0:s.tooltipSpace)||cxe}}}),g4=new WeakMap,aE=nr.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(Jw);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new bq(n,iE,(t,s)=>this.createTooltip(t,s),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,s=n.state.facet(Jw);if(s.position!=this.position&&!this.madeAbsolute){this.position=s.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(s.parent!=this.parent){this.parent&&this.container.remove(),this.parent=s.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),s=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let r=document.createElement("div");r.className="cm-tooltip-arrow",t.dom.appendChild(r)}return t.dom.style.position=this.position,t.dom.style.top=Wp,t.dom.style.left="0px",this.container.insertBefore(t.dom,s),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let s of this.manager.tooltipViews)s.dom.remove(),(n=s.destroy)===null||n===void 0||n.call(s);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:a}=this.manager.tooltipViews[0];if(Mt.gecko)t=a.offsetParent!=this.container.ownerDocument.body;else if(a.style.top==Wp&&a.style.left=="0px"){let i=a.getBoundingClientRect();t=Math.abs(i.top+1e4)>1||Math.abs(i.left)>1}}if(t||this.position=="absolute")if(this.parent){let a=this.parent.getBoundingClientRect();a.width&&a.height&&(n=a.width/this.parent.offsetWidth,e=a.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let s=this.view.scrollDOM.getBoundingClientRect(),r=tE(this.view);return{visible:{left:s.left+r.left,top:s.top+r.top,right:s.right-r.right,bottom:s.bottom-r.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((a,i)=>{let o=this.manager.tooltipViews[i];return o.getCoords?o.getCoords(a.pos):this.view.coordsAtPos(a.pos)}),size:this.manager.tooltipViews.map(({dom:a})=>a.getBoundingClientRect()),space:this.view.state.facet(Jw).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let o of this.manager.tooltipViews)o.dom.style.position="absolute"}let{visible:t,space:s,scaleX:r,scaleY:a}=n,i=[];for(let o=0;o<this.manager.tooltips.length;o++){let l=this.manager.tooltips[o],c=this.manager.tooltipViews[o],{dom:u}=c,h=n.pos[o],d=n.size[o];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,s.top)||h.top>=Math.min(t.bottom,s.bottom)||h.right<Math.max(t.left,s.left)-.1||h.left>Math.min(t.right,s.right)+.1)){u.style.top=Wp;continue}let m=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,y=m?7:0,O=d.right-d.left,S=(e=g4.get(c))!==null&&e!==void 0?e:d.bottom-d.top,A=c.offset||hxe,F=this.view.textDirection==Ss.LTR,j=d.width>s.right-s.left?F?s.left:s.right-d.width:F?Math.max(s.left,Math.min(h.left-(m?14:0)+A.x,s.right-O)):Math.min(Math.max(s.left,h.left-O+(m?14:0)-A.x),s.right-O),N=this.above[o];!l.strictSide&&(N?h.top-S-y-A.y<s.top:h.bottom+S+y+A.y>s.bottom)&&N==s.bottom-h.bottom>h.top-s.top&&(N=this.above[o]=!N);let $=(N?h.top-s.top:s.bottom-h.bottom)-y;if($<S&&c.resize!==!1){if($<this.view.defaultLineHeight){u.style.top=Wp;continue}g4.set(c,S),u.style.height=(S=$)/a+"px"}else u.style.height&&(u.style.height="");let L=N?h.top-S-y-A.y:h.bottom+y+A.y,I=j+O;if(c.overlap!==!0)for(let q of i)q.left<I&&q.right>j&&q.top<L+S&&q.bottom>L&&(L=N?q.top-S-2-y:q.bottom+y+2);if(this.position=="absolute"?(u.style.top=(L-n.parent.top)/a+"px",b4(u,(j-n.parent.left)/r)):(u.style.top=L/a+"px",b4(u,j/r)),m){let q=h.left+(F?A.x:-A.x)-(j+14-7);m.style.left=q/r+"px"}c.overlap!==!0&&i.push({left:j,top:L,right:I,bottom:L+S}),u.classList.toggle("cm-tooltip-above",N),u.classList.toggle("cm-tooltip-below",!N),c.positioned&&c.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Wp}},{eventObservers:{scroll(){this.maybeMeasure()}}});function b4(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const uxe=vt.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),hxe={x:0,y:0},iE=_t.define({enables:[aE,uxe]}),qy=_t.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class Rv{static create(e){return new Rv(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new bq(e,qy,(t,s)=>this.createHostedView(t,s),t=>t.dom.remove())}createHostedView(e,t){let s=e.create(this.view);return s.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(s.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&s.mount&&s.mount(this.view),s}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let s of this.manager.tooltipViews){let r=s[e];if(r!==void 0){if(t===void 0)t=r;else if(t!==r)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const dxe=iE.compute([qy],n=>{let e=n.facet(qy);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var s;return(s=t.end)!==null&&s!==void 0?s:t.pos})),create:Rv.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class pxe{constructor(e,t,s,r,a){this.view=e,this.source=t,this.field=s,this.setHover=r,this.hoverTime=a,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,s=e.docView.nearest(t.target);if(!s)return;let r,a=1;if(s instanceof Xc)r=s.posAtStart;else{if(r=e.posAtCoords(t),r==null)return;let o=e.coordsAtPos(r);if(!o||t.y<o.top||t.y>o.bottom||t.x<o.left-e.defaultCharacterWidth||t.x>o.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(r)).find(u=>u.from<=r&&u.to>=r),c=l&&l.dir==Ss.RTL?-1:1;a=t.x<o.left?-c:c}let i=this.source(e,r,a);if(i!=null&&i.then){let o=this.pending={pos:r};i.then(l=>{this.pending==o&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>ni(e.state,l,"hover tooltip"))}else i&&!(Array.isArray(i)&&!i.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(i)?i:[i])})}get tooltip(){let e=this.view.plugin(aE),t=e?e.manager.tooltips.findIndex(s=>s.create==Rv.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,s;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:r,tooltip:a}=this;if(r.length&&a&&!mxe(a.dom,e)||this.pending){let{pos:i}=r[0]||this.pending,o=(s=(t=r[0])===null||t===void 0?void 0:t.end)!==null&&s!==void 0?s:i;(i==o?this.view.posAtCoords(this.lastMove)!=i:!fxe(this.view,i,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:s}=this;s&&s.dom.contains(e.relatedTarget)?this.watchTooltipLeave(s.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=s=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(s.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const m0=4;function mxe(n,e){let{left:t,right:s,top:r,bottom:a}=n.getBoundingClientRect(),i;if(i=n.querySelector(".cm-tooltip-arrow")){let o=i.getBoundingClientRect();r=Math.min(o.top,r),a=Math.max(o.bottom,a)}return e.clientX>=t-m0&&e.clientX<=s+m0&&e.clientY>=r-m0&&e.clientY<=a+m0}function fxe(n,e,t,s,r,a){let i=n.scrollDOM.getBoundingClientRect(),o=n.documentTop+n.documentPadding.top+n.contentHeight;if(i.left>s||i.right<s||i.top>r||Math.min(i.bottom,o)<r)return!1;let l=n.posAtCoords({x:s,y:r},!1);return l>=e&&l<=t}function yq(n,e={}){let t=ln.define(),s=Us.define({create(){return[]},update(r,a){if(r.length&&(e.hideOnChange&&(a.docChanged||a.selection)?r=[]:e.hideOn&&(r=r.filter(i=>!e.hideOn(a,i))),a.docChanged)){let i=[];for(let o of r){let l=a.changes.mapPos(o.pos,-1,mr.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),o);c.pos=l,c.end!=null&&(c.end=a.changes.mapPos(c.end)),i.push(c)}}r=i}for(let i of a.effects)i.is(t)&&(r=i.value),i.is(gxe)&&(r=[]);return r},provide:r=>qy.from(r)});return{active:s,extension:[s,nr.define(r=>new pxe(r,n,s,t,e.hoverTime||300)),dxe]}}function vq(n,e){let t=n.plugin(aE);if(!t)return null;let s=t.manager.tooltips.indexOf(e);return s<0?null:t.manager.tooltipViews[s]}const gxe=ln.define(),y4=_t.define({combine(n){let e,t;for(let s of n)e=e||s.topContainer,t=t||s.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Sf(n,e){let t=n.plugin(Oq),s=t?t.specs.indexOf(e):-1;return s>-1?t.panels[s]:null}const Oq=nr.fromClass(class{constructor(n){this.input=n.state.facet(Ou),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(y4);this.top=new f0(n,!0,e.topContainer),this.bottom=new f0(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(y4);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new f0(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new f0(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Ou);if(t!=this.input){let s=t.filter(l=>l),r=[],a=[],i=[],o=[];for(let l of s){let c=this.specs.indexOf(l),u;c<0?(u=l(n.view),o.push(u)):(u=this.panels[c],u.update&&u.update(n)),r.push(u),(u.top?a:i).push(u)}this.specs=s,this.panels=r,this.top.sync(a),this.bottom.sync(i);for(let l of o)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let s of this.panels)s.update&&s.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>vt.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class f0{constructor(e,t,s){this.view=e,this.top=t,this.container=s,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=v4(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=v4(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function v4(n){let e=n.nextSibling;return n.remove(),e}const Ou=_t.define({enables:Oq});class wu extends wh{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}wu.prototype.elementClass="";wu.prototype.toDOM=void 0;wu.prototype.mapMode=mr.TrackBefore;wu.prototype.startSide=wu.prototype.endSide=-1;wu.prototype.point=!0;const mb=_t.define(),bxe=_t.define(),fb=_t.define(),O4=_t.define({combine:n=>n.some(e=>e)});function yxe(n){return[vxe]}const vxe=nr.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(fb).map(e=>new x4(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(O4),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,s=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(s<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(O4)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=cs.iter(this.view.state.facet(mb),this.view.viewport.from),s=[],r=this.gutters.map(a=>new Oxe(a,this.view.viewport,-this.view.documentPadding.top));for(let a of this.view.viewportLineBlocks)if(s.length&&(s=[]),Array.isArray(a.type)){let i=!0;for(let o of a.type)if(o.type==Ca.Text&&i){PS(t,s,o.from);for(let l of r)l.line(this.view,o,s);i=!1}else if(o.widget)for(let l of r)l.widget(this.view,o)}else if(a.type==Ca.Text){PS(t,s,a.from);for(let i of r)i.line(this.view,a,s)}else if(a.widget)for(let i of r)i.widget(this.view,a);for(let a of r)a.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(fb),t=n.state.facet(fb),s=n.docChanged||n.heightChanged||n.viewportChanged||!cs.eq(n.startState.facet(mb),n.state.facet(mb),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(n)&&(s=!0);else{s=!0;let r=[];for(let a of t){let i=e.indexOf(a);i<0?r.push(new x4(this.view,a)):(this.gutters[i].update(n),r.push(this.gutters[i]))}for(let a of this.gutters)a.dom.remove(),r.indexOf(a)<0&&a.destroy();for(let a of r)this.dom.appendChild(a.dom);this.gutters=r}return s}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>vt.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==Ss.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function w4(n){return Array.isArray(n)?n:[n]}function PS(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class Oxe{constructor(e,t,s){this.gutter=e,this.height=s,this.i=0,this.cursor=cs.iter(e.markers,t.from)}addElement(e,t,s){let{gutter:r}=this,a=(t.top-this.height)/e.scaleY,i=t.height/e.scaleY;if(this.i==r.elements.length){let o=new wq(e,i,a,s);r.elements.push(o),r.dom.appendChild(o.dom)}else r.elements[this.i].update(e,i,a,s);this.height=t.bottom,this.i++}line(e,t,s){let r=[];PS(this.cursor,r,t.from),s.length&&(r=r.concat(s));let a=this.gutter.config.lineMarker(e,t,r);a&&r.unshift(a);let i=this.gutter;r.length==0&&!i.config.renderEmptyElements||this.addElement(e,t,r)}widget(e,t){let s=this.gutter.config.widgetMarker(e,t.widget,t),r=s?[s]:null;for(let a of e.state.facet(bxe)){let i=a(e,t.widget,t);i&&(r||(r=[])).push(i)}r&&this.addElement(e,t,r)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class x4{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in t.domEventHandlers)this.dom.addEventListener(s,r=>{let a=r.target,i;if(a!=this.dom&&this.dom.contains(a)){for(;a.parentNode!=this.dom;)a=a.parentNode;let l=a.getBoundingClientRect();i=(l.top+l.bottom)/2}else i=r.clientY;let o=e.lineBlockAtHeight(i-e.documentTop);t.domEventHandlers[s](e,o,r)&&r.preventDefault()});this.markers=w4(t.markers(e)),t.initialSpacer&&(this.spacer=new wq(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=w4(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let s=e.view.viewport;return!cs.eq(this.markers,t,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class wq{constructor(e,t,s,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,s,r)}update(e,t,s,r){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),wxe(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let s="cm-gutterElement",r=this.dom.firstChild;for(let a=0,i=0;;){let o=i,l=a<t.length?t[a++]:null,c=!1;if(l){let u=l.elementClass;u&&(s+=" "+u);for(let h=i;h<this.markers.length;h++)if(this.markers[h].compare(l)){o=h,c=!0;break}}else o=this.markers.length;for(;i<o;){let u=this.markers[i++];if(u.toDOM){u.destroy(r);let h=r.nextSibling;r.remove(),r=h}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),c&&i++}this.dom.className=s,this.markers=t}destroy(){this.setMarkers(null,[])}}function wxe(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const xxe=_t.define(),kxe=_t.define(),Kh=_t.define({combine(n){return Tc(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let s=Object.assign({},e);for(let r in t){let a=s[r],i=t[r];s[r]=a?(o,l,c)=>a(o,l,c)||i(o,l,c):i}return s}})}});class ex extends wu{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function tx(n,e){return n.state.facet(Kh).formatNumber(e,n.state)}const Sxe=fb.compute([Kh],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(xxe)},lineMarker(e,t,s){return s.some(r=>r.toDOM)?null:new ex(tx(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,s)=>{for(let r of e.state.facet(kxe)){let a=r(e,t,s);if(a)return a}return null},lineMarkerChange:e=>e.startState.facet(Kh)!=e.state.facet(Kh),initialSpacer(e){return new ex(tx(e,k4(e.state.doc.lines)))},updateSpacer(e,t){let s=tx(t.view,k4(t.view.state.doc.lines));return s==e.number?e:new ex(s)},domEventHandlers:n.facet(Kh).domEventHandlers}));function Cxe(n={}){return[Kh.of(n),yxe(),Sxe]}function k4(n){let e=9;for(;e<n;)e=e*10+9;return e}const Pxe=new class extends wu{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Axe=mb.compute(["selection"],n=>{let e=[],t=-1;for(let s of n.selection.ranges){let r=n.doc.lineAt(s.head).from;r>t&&(t=r,e.push(Pxe.range(r)))}return cs.of(e)});function Exe(){return Axe}const xq=1024;let Mxe=0;class nx{constructor(e,t){this.from=e,this.to=t}}class jn{constructor(e={}){this.id=Mxe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ci.match(e)),t=>{let s=e(t);return s===void 0?null:[this,s]}}}jn.closedBy=new jn({deserialize:n=>n.split(" ")});jn.openedBy=new jn({deserialize:n=>n.split(" ")});jn.group=new jn({deserialize:n=>n.split(" ")});jn.isolate=new jn({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});jn.contextHash=new jn({perNode:!0});jn.lookAhead=new jn({perNode:!0});jn.mounted=new jn({perNode:!0});class Uy{constructor(e,t,s){this.tree=e,this.overlay=t,this.parser=s}static get(e){return e&&e.props&&e.props[jn.mounted.id]}}const Dxe=Object.create(null);class ci{constructor(e,t,s,r=0){this.name=e,this.props=t,this.id=s,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Dxe,s=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new ci(e.name||"",t,e.id,s);if(e.props){for(let a of e.props)if(Array.isArray(a)||(a=a(r)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[a[0].id]=a[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(jn.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let s in e)for(let r of s.split(" "))t[r]=e[s];return s=>{for(let r=s.prop(jn.group),a=-1;a<(r?r.length:0);a++){let i=t[a<0?s.name:r[a]];if(i)return i}}}}ci.none=new ci("",Object.create(null),0,8);class oE{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let s of this.types){let r=null;for(let a of e){let i=a(s);i&&(r||(r=Object.assign({},s.props)),r[i[0].id]=i[1])}t.push(r?new ci(s.name,r,s.id,s.flags):s)}return new oE(t)}}const g0=new WeakMap,S4=new WeakMap;var Sr;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(Sr||(Sr={}));class br{constructor(e,t,s,r,a){if(this.type=e,this.children=t,this.positions=s,this.length=r,this.props=null,a&&a.length){this.props=Object.create(null);for(let[i,o]of a)this.props[typeof i=="number"?i:i.id]=o}}toString(){let e=Uy.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let s of this.children){let r=s.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new ES(this.topNode,e)}cursorAt(e,t=0,s=0){let r=g0.get(this)||this.topNode,a=new ES(r);return a.moveTo(e,t),g0.set(this,a._tree),a}get topNode(){return new ai(this,0,0,null)}resolve(e,t=0){let s=Cf(g0.get(this)||this.topNode,e,t,!1);return g0.set(this,s),s}resolveInner(e,t=0){let s=Cf(S4.get(this)||this.topNode,e,t,!0);return S4.set(this,s),s}resolveStack(e,t=0){return Fxe(this,e,t)}iterate(e){let{enter:t,leave:s,from:r=0,to:a=this.length}=e,i=e.mode||0,o=(i&Sr.IncludeAnonymous)>0;for(let l=this.cursor(i|Sr.IncludeAnonymous);;){let c=!1;if(l.from<=a&&l.to>=r&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&s&&(o||!l.type.isAnonymous)&&s(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:uE(ci.none,this.children,this.positions,0,this.children.length,0,this.length,(t,s,r)=>new br(this.type,t,s,r,this.propValues),e.makeTree||((t,s,r)=>new br(ci.none,t,s,r)))}static build(e){return $xe(e)}}br.empty=new br(ci.none,[],[],0);class lE{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new lE(this.buffer,this.index)}}class xu{constructor(e,t,s){this.buffer=e,this.length=t,this.set=s}get type(){return ci.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],s=this.buffer[e+3],r=this.set.types[t],a=r.name;if(/\W/.test(a)&&!r.isError&&(a=JSON.stringify(a)),e+=4,s==e)return a;let i=[];for(;e<s;)i.push(this.childString(e)),e=this.buffer[e+3];return a+"("+i.join(",")+")"}findChild(e,t,s,r,a){let{buffer:i}=this,o=-1;for(let l=e;l!=t&&!(kq(a,r,i[l+1],i[l+2])&&(o=l,s>0));l=i[l+3]);return o}slice(e,t,s){let r=this.buffer,a=new Uint16Array(t-e),i=0;for(let o=e,l=0;o<t;){a[l++]=r[o++],a[l++]=r[o++]-s;let c=a[l++]=r[o++]-s;a[l++]=r[o++]-e,i=Math.max(i,c)}return new xu(a,i,this.set)}}function kq(n,e,t,s){switch(n){case-2:return t<e;case-1:return s>=e&&t<e;case 0:return t<e&&s>e;case 1:return t<=e&&s>e;case 2:return s>e;case 4:return!0}}function Cf(n,e,t,s){for(var r;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let i=!s&&n instanceof ai&&n.index<0?null:n.parent;if(!i)return n;n=i}let a=s?0:Sr.IgnoreOverlays;if(s)for(let i=n,o=i.parent;o;i=o,o=i.parent)i instanceof ai&&i.index<0&&((r=o.enter(e,t,a))===null||r===void 0?void 0:r.from)!=i.from&&(n=o);for(;;){let i=n.enter(e,t,a);if(!i)return n;n=i}}class Sq{cursor(e=0){return new ES(this,e)}getChild(e,t=null,s=null){let r=C4(this,e,t,s);return r.length?r[0]:null}getChildren(e,t=null,s=null){return C4(this,e,t,s)}resolve(e,t=0){return Cf(this,e,t,!1)}resolveInner(e,t=0){return Cf(this,e,t,!0)}matchContext(e){return AS(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),s=this;for(;t;){let r=t.lastChild;if(!r||r.to!=t.to)break;r.type.isError&&r.from==r.to?(s=t,t=r.prevSibling):t=r}return s}get node(){return this}get next(){return this.parent}}class ai extends Sq{constructor(e,t,s,r){super(),this._tree=e,this.from=t,this.index=s,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,s,r,a=0){for(let i=this;;){for(let{children:o,positions:l}=i._tree,c=t>0?o.length:-1;e!=c;e+=t){let u=o[e],h=l[e]+i.from;if(kq(r,s,h,h+u.length)){if(u instanceof xu){if(a&Sr.ExcludeBuffers)continue;let d=u.findChild(0,u.buffer.length,t,s-h,r);if(d>-1)return new Cl(new Txe(i,u,e,h),null,d)}else if(a&Sr.IncludeAnonymous||!u.type.isAnonymous||cE(u)){let d;if(!(a&Sr.IgnoreMounts)&&(d=Uy.get(u))&&!d.overlay)return new ai(d.tree,h,e,i);let m=new ai(u,h,e,i);return a&Sr.IncludeAnonymous||!m.type.isAnonymous?m:m.nextChild(t<0?u.children.length-1:0,t,s,r)}}}if(a&Sr.IncludeAnonymous||!i.type.isAnonymous||(i.index>=0?e=i.index+t:e=t<0?-1:i._parent._tree.children.length,i=i._parent,!i))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,s=0){let r;if(!(s&Sr.IgnoreOverlays)&&(r=Uy.get(this._tree))&&r.overlay){let a=e-this.from;for(let{from:i,to:o}of r.overlay)if((t>0?i<=a:i<a)&&(t<0?o>=a:o>a))return new ai(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,s)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function C4(n,e,t,s){let r=n.cursor(),a=[];if(!r.firstChild())return a;if(t!=null){for(let i=!1;!i;)if(i=r.type.is(t),!r.nextSibling())return a}for(;;){if(s!=null&&r.type.is(s))return a;if(r.type.is(e)&&a.push(r.node),!r.nextSibling())return s==null?a:[]}}function AS(n,e,t=e.length-1){for(let s=n;t>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(e[t]&&e[t]!=s.name)return!1;t--}}return!0}class Txe{constructor(e,t,s,r){this.parent=e,this.buffer=t,this.index=s,this.start=r}}class Cl extends Sq{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,s){super(),this.context=e,this._parent=t,this.index=s,this.type=e.buffer.set.types[e.buffer.buffer[s]]}child(e,t,s){let{buffer:r}=this.context,a=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,s);return a<0?null:new Cl(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,s=0){if(s&Sr.ExcludeBuffers)return null;let{buffer:r}=this.context,a=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return a<0?null:new Cl(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Cl(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Cl(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:s}=this.context,r=this.index+4,a=s.buffer[this.index+3];if(a>r){let i=s.buffer[this.index+1];e.push(s.slice(r,a,i)),t.push(0)}return new br(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Cq(n){if(!n.length)return null;let e=0,t=n[0];for(let a=1;a<n.length;a++){let i=n[a];(i.from>t.from||i.to<t.to)&&(t=i,e=a)}let s=t instanceof ai&&t.index<0?null:t.parent,r=n.slice();return s?r[e]=s:r.splice(e,1),new Bxe(r,t)}class Bxe{constructor(e,t){this.heads=e,this.node=t}get next(){return Cq(this.heads)}}function Fxe(n,e,t){let s=n.resolveInner(e,t),r=null;for(let a=s instanceof ai?s:s.context.parent;a;a=a.parent)if(a.index<0){let i=a.parent;(r||(r=[s])).push(i.resolve(e,t)),a=i}else{let i=Uy.get(a.tree);if(i&&i.overlay&&i.overlay[0].from<=e&&i.overlay[i.overlay.length-1].to>=e){let o=new ai(i.tree,i.overlay[0].from+a.from,-1,a);(r||(r=[s])).push(Cf(o,e,t,!1))}}return r?Cq(r):s}class ES{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof ai)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let s=e._parent;s;s=s._parent)this.stack.unshift(s.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:s,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=s+r.buffer[e+1],this.to=s+r.buffer[e+2],!0}yield(e){return e?e instanceof ai?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,s){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,s,this.mode));let{buffer:r}=this.buffer,a=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,s);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,s=this.mode){return this.buffer?s&Sr.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,s))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Sr.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Sr.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,s=this.stack.length-1;if(e<0){let r=s<0?0:this.stack[s]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(s<0?t.buffer.length:t.buffer[this.stack[s]+3]))return this.yieldBuf(r)}return s<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,s,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(r.buffer.buffer[a+3]<this.index)return!1;({index:t,parent:s}=r)}else({index:t,_parent:s}=this._tree);for(;s;{index:t,_parent:s}=s)if(t>-1)for(let a=t+e,i=e<0?-1:s._tree.children.length;a!=i;a+=e){let o=s._tree.children[a];if(this.mode&Sr.IncludeAnonymous||o instanceof xu||!o.type.isAnonymous||cE(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,s=0;if(e&&e.context==this.buffer)e:for(let r=this.index,a=this.stack.length;a>=0;){for(let i=e;i;i=i._parent)if(i.index==r){if(r==this.index)return i;t=i,s=a+1;break e}r=this.stack[--a]}for(let r=s;r<this.stack.length;r++)t=new Cl(this.buffer,t,this.stack[r]);return this.bufferNode=new Cl(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let s=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){s++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&t&&t(this),r=this.type.isAnonymous,!s)return;if(this.nextSibling())break;this.parent(),s--,r=!0}}}matchContext(e){if(!this.buffer)return AS(this.node.parent,e);let{buffer:t}=this.buffer,{types:s}=t.set;for(let r=e.length-1,a=this.stack.length-1;r>=0;a--){if(a<0)return AS(this._tree,e,r);let i=s[t.buffer[this.stack[a]]];if(!i.isAnonymous){if(e[r]&&e[r]!=i.name)return!1;r--}}return!0}}function cE(n){return n.children.some(e=>e instanceof xu||!e.type.isAnonymous||cE(e))}function $xe(n){var e;let{buffer:t,nodeSet:s,maxBufferLength:r=xq,reused:a=[],minRepeatType:i=s.types.length}=n,o=Array.isArray(t)?new lE(t,t.length):t,l=s.types,c=0,u=0;function h($,L,I,q,ce,ee){let{id:he,start:H,end:me,size:Oe}=o,Pe=u,De=c;for(;Oe<0;)if(o.next(),Oe==-1){let Ke=a[he];I.push(Ke),q.push(H-$);return}else if(Oe==-3){c=he;return}else if(Oe==-4){u=he;return}else throw new RangeError(`Unrecognized record size: ${Oe}`);let Se=l[he],ae,Ee,Qe=H-$;if(me-H<=r&&(Ee=S(o.pos-L,ce))){let Ke=new Uint16Array(Ee.size-Ee.skip),ge=o.pos-Ee.size,Ye=Ke.length;for(;o.pos>ge;)Ye=A(Ee.start,Ke,Ye);ae=new xu(Ke,me-Ee.start,s),Qe=Ee.start-$}else{let Ke=o.pos-Oe;o.next();let ge=[],Ye=[],yt=he>=i?he:-1,Xe=0,Ge=me;for(;o.pos>Ke;)yt>=0&&o.id==yt&&o.size>=0?(o.end<=Ge-r&&(y(ge,Ye,H,Xe,o.end,Ge,yt,Pe,De),Xe=ge.length,Ge=o.end),o.next()):ee>2500?d(H,Ke,ge,Ye):h(H,Ke,ge,Ye,yt,ee+1);if(yt>=0&&Xe>0&&Xe<ge.length&&y(ge,Ye,H,Xe,H,Ge,yt,Pe,De),ge.reverse(),Ye.reverse(),yt>-1&&Xe>0){let Ct=m(Se,De);ae=uE(Se,ge,Ye,0,ge.length,0,me-H,Ct,Ct)}else ae=O(Se,ge,Ye,me-H,Pe-me,De)}I.push(ae),q.push(Qe)}function d($,L,I,q){let ce=[],ee=0,he=-1;for(;o.pos>L;){let{id:H,start:me,end:Oe,size:Pe}=o;if(Pe>4)o.next();else{if(he>-1&&me<he)break;he<0&&(he=Oe-r),ce.push(H,me,Oe),ee++,o.next()}}if(ee){let H=new Uint16Array(ee*4),me=ce[ce.length-2];for(let Oe=ce.length-3,Pe=0;Oe>=0;Oe-=3)H[Pe++]=ce[Oe],H[Pe++]=ce[Oe+1]-me,H[Pe++]=ce[Oe+2]-me,H[Pe++]=Pe;I.push(new xu(H,ce[2]-me,s)),q.push(me-$)}}function m($,L){return(I,q,ce)=>{let ee=0,he=I.length-1,H,me;if(he>=0&&(H=I[he])instanceof br){if(!he&&H.type==$&&H.length==ce)return H;(me=H.prop(jn.lookAhead))&&(ee=q[he]+H.length+me)}return O($,I,q,ce,ee,L)}}function y($,L,I,q,ce,ee,he,H,me){let Oe=[],Pe=[];for(;$.length>q;)Oe.push($.pop()),Pe.push(L.pop()+I-ce);$.push(O(s.types[he],Oe,Pe,ee-ce,H-ee,me)),L.push(ce-I)}function O($,L,I,q,ce,ee,he){if(ee){let H=[jn.contextHash,ee];he=he?[H].concat(he):[H]}if(ce>25){let H=[jn.lookAhead,ce];he=he?[H].concat(he):[H]}return new br($,L,I,q,he)}function S($,L){let I=o.fork(),q=0,ce=0,ee=0,he=I.end-r,H={size:0,start:0,skip:0};e:for(let me=I.pos-$;I.pos>me;){let Oe=I.size;if(I.id==L&&Oe>=0){H.size=q,H.start=ce,H.skip=ee,ee+=4,q+=4,I.next();continue}let Pe=I.pos-Oe;if(Oe<0||Pe<me||I.start<he)break;let De=I.id>=i?4:0,Se=I.start;for(I.next();I.pos>Pe;){if(I.size<0)if(I.size==-3)De+=4;else break e;else I.id>=i&&(De+=4);I.next()}ce=Se,q+=Oe,ee+=De}return(L<0||q==$)&&(H.size=q,H.start=ce,H.skip=ee),H.size>4?H:void 0}function A($,L,I){let{id:q,start:ce,end:ee,size:he}=o;if(o.next(),he>=0&&q<i){let H=I;if(he>4){let me=o.pos-(he-4);for(;o.pos>me;)I=A($,L,I)}L[--I]=H,L[--I]=ee-$,L[--I]=ce-$,L[--I]=q}else he==-3?c=q:he==-4&&(u=q);return I}let F=[],j=[];for(;o.pos>0;)h(n.start||0,n.bufferStart||0,F,j,-1,0);let N=(e=n.length)!==null&&e!==void 0?e:F.length?j[0]+F[0].length:0;return new br(l[n.topID],F.reverse(),j.reverse(),N)}const P4=new WeakMap;function gb(n,e){if(!n.isAnonymous||e instanceof xu||e.type!=n)return 1;let t=P4.get(e);if(t==null){t=1;for(let s of e.children){if(s.type!=n||!(s instanceof br)){t=1;break}t+=gb(n,s)}P4.set(e,t)}return t}function uE(n,e,t,s,r,a,i,o,l){let c=0;for(let y=s;y<r;y++)c+=gb(n,e[y]);let u=Math.ceil(c*1.5/8),h=[],d=[];function m(y,O,S,A,F){for(let j=S;j<A;){let N=j,$=O[j],L=gb(n,y[j]);for(j++;j<A;j++){let I=gb(n,y[j]);if(L+I>=u)break;L+=I}if(j==N+1){if(L>u){let I=y[N];m(I.children,I.positions,0,I.children.length,O[N]+F);continue}h.push(y[N])}else{let I=O[j-1]+y[j-1].length-$;h.push(uE(n,y,O,N,j,$,I,null,l))}d.push($+F-a)}}return m(e,t,s,r,0),(o||l)(h,d,i)}class Nxe{constructor(){this.map=new WeakMap}setBuffer(e,t,s){let r=this.map.get(e);r||this.map.set(e,r=new Map),r.set(t,s)}getBuffer(e,t){let s=this.map.get(e);return s&&s.get(t)}set(e,t){e instanceof Cl?this.setBuffer(e.context.buffer,e.index,t):e instanceof ai&&this.map.set(e.tree,t)}get(e){return e instanceof Cl?this.getBuffer(e.context.buffer,e.index):e instanceof ai?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class uh{constructor(e,t,s,r,a=!1,i=!1){this.from=e,this.to=t,this.tree=s,this.offset=r,this.open=(a?1:0)|(i?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],s=!1){let r=[new uh(0,e.length,e,0,!1,s)];for(let a of t)a.to>e.length&&r.push(a);return r}static applyChanges(e,t,s=128){if(!t.length)return e;let r=[],a=1,i=e.length?e[0]:null;for(let o=0,l=0,c=0;;o++){let u=o<t.length?t[o]:null,h=u?u.fromA:1e9;if(h-l>=s)for(;i&&i.from<h;){let d=i;if(l>=d.from||h<=d.to||c){let m=Math.max(d.from,l)-c,y=Math.min(d.to,h)-c;d=m>=y?null:new uh(m,y,d.tree,d.offset+c,o>0,!!u)}if(d&&r.push(d),i.to>h)break;i=a<e.length?e[a++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return r}}class Pq{startParse(e,t,s){return typeof e=="string"&&(e=new _xe(e)),s=s?s.length?s.map(r=>new nx(r.from,r.to)):[new nx(0,0)]:[new nx(0,e.length)],this.createParse(e,t||[],s)}parse(e,t,s){let r=this.startParse(e,t,s);for(;;){let a=r.advance();if(a)return a}}}class _xe{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new jn({perNode:!0});let Rxe=0;class Gi{constructor(e,t,s,r){this.name=e,this.set=t,this.base=s,this.modified=r,this.id=Rxe++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let s=typeof e=="string"?e:"?";if(e instanceof Gi&&(t=e),t==null?void 0:t.base)throw new Error("Can not derive from a modified tag");let r=new Gi(s,[],null,[]);if(r.set.push(r),t)for(let a of t.set)r.set.push(a);return r}static defineModifier(e){let t=new Wy(e);return s=>s.modified.indexOf(t)>-1?s:Wy.get(s.base||s,s.modified.concat(t).sort((r,a)=>r.id-a.id))}}let Ixe=0;class Wy{constructor(e){this.name=e,this.instances=[],this.id=Ixe++}static get(e,t){if(!t.length)return e;let s=t[0].instances.find(o=>o.base==e&&Lxe(t,o.modified));if(s)return s;let r=[],a=new Gi(e.name,r,e,t);for(let o of t)o.instances.push(a);let i=Qxe(t);for(let o of e.set)if(!o.modified.length)for(let l of i)r.push(Wy.get(o,l));return a}}function Lxe(n,e){return n.length==e.length&&n.every((t,s)=>t==e[s])}function Qxe(n){let e=[[]];for(let t=0;t<n.length;t++)for(let s=0,r=e.length;s<r;s++)e.push(e[s].concat(n[t]));return e.sort((t,s)=>s.length-t.length)}function Aq(n){let e=Object.create(null);for(let t in n){let s=n[t];Array.isArray(s)||(s=[s]);for(let r of t.split(" "))if(r){let a=[],i=2,o=r;for(let h=0;;){if(o=="..."&&h>0&&h+3==r.length){i=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!d)throw new RangeError("Invalid path: "+r);if(a.push(d[0]=="*"?"":d[0][0]=='"'?JSON.parse(d[0]):d[0]),h+=d[0].length,h==r.length)break;let m=r[h++];if(h==r.length&&m=="!"){i=0;break}if(m!="/")throw new RangeError("Invalid path: "+r);o=r.slice(h)}let l=a.length-1,c=a[l];if(!c)throw new RangeError("Invalid path: "+r);let u=new Gy(s,i,l>0?a.slice(0,l):null);e[c]=u.sort(e[c])}}return Eq.add(e)}const Eq=new jn;class Gy{constructor(e,t,s,r){this.tags=e,this.mode=t,this.context=s,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Gy.empty=new Gy([],2,null);function Mq(n,e){let t=Object.create(null);for(let a of n)if(!Array.isArray(a.tag))t[a.tag.id]=a.class;else for(let i of a.tag)t[i.id]=a.class;let{scope:s,all:r=null}=e||{};return{style:a=>{let i=r;for(let o of a)for(let l of o.set){let c=t[l.id];if(c){i=i?i+" "+c:c;break}}return i},scope:s}}function jxe(n,e){let t=null;for(let s of n){let r=s.style(e);r&&(t=t?t+" "+r:r)}return t}function Vxe(n,e,t,s=0,r=n.length){let a=new Zxe(s,Array.isArray(e)?e:[e],t);a.highlightRange(n.cursor(),s,r,"",a.highlighters),a.flush(r)}class Zxe{constructor(e,t,s){this.at=e,this.highlighters=t,this.span=s,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,s,r,a){let{type:i,from:o,to:l}=e;if(o>=s||l<=t)return;i.isTop&&(a=this.highlighters.filter(m=>!m.scope||m.scope(i)));let c=r,u=zxe(e)||Gy.empty,h=jxe(a,u.tags);if(h&&(c&&(c+=" "),c+=h,u.mode==1&&(r+=(r?" ":"")+h)),this.startSpan(Math.max(t,o),c),u.opaque)return;let d=e.tree&&e.tree.prop(jn.mounted);if(d&&d.overlay){let m=e.node.enter(d.overlay[0].from+o,1),y=this.highlighters.filter(S=>!S.scope||S.scope(d.tree.type)),O=e.firstChild();for(let S=0,A=o;;S++){let F=S<d.overlay.length?d.overlay[S]:null,j=F?F.from+o:l,N=Math.max(t,A),$=Math.min(s,j);if(N<$&&O)for(;e.from<$&&(this.highlightRange(e,N,$,r,a),this.startSpan(Math.min($,e.to),c),!(e.to>=j||!e.nextSibling())););if(!F||j>s)break;A=F.to+o,A>t&&(this.highlightRange(m.cursor(),Math.max(t,F.from+o),Math.min(s,A),"",y),this.startSpan(Math.min(s,A),c))}O&&e.parent()}else if(e.firstChild()){d&&(r="");do if(!(e.to<=t)){if(e.from>=s)break;this.highlightRange(e,t,s,r,a),this.startSpan(Math.min(s,e.to),c)}while(e.nextSibling());e.parent()}}}function zxe(n){let e=n.type.prop(Eq);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const xt=Gi.define,b0=xt(),Lc=xt(),A4=xt(Lc),E4=xt(Lc),Qc=xt(),y0=xt(Qc),sx=xt(Qc),ul=xt(),_u=xt(ul),ol=xt(),ll=xt(),MS=xt(),Gp=xt(MS),v0=xt(),b={comment:b0,lineComment:xt(b0),blockComment:xt(b0),docComment:xt(b0),name:Lc,variableName:xt(Lc),typeName:A4,tagName:xt(A4),propertyName:E4,attributeName:xt(E4),className:xt(Lc),labelName:xt(Lc),namespace:xt(Lc),macroName:xt(Lc),literal:Qc,string:y0,docString:xt(y0),character:xt(y0),attributeValue:xt(y0),number:sx,integer:xt(sx),float:xt(sx),bool:xt(Qc),regexp:xt(Qc),escape:xt(Qc),color:xt(Qc),url:xt(Qc),keyword:ol,self:xt(ol),null:xt(ol),atom:xt(ol),unit:xt(ol),modifier:xt(ol),operatorKeyword:xt(ol),controlKeyword:xt(ol),definitionKeyword:xt(ol),moduleKeyword:xt(ol),operator:ll,derefOperator:xt(ll),arithmeticOperator:xt(ll),logicOperator:xt(ll),bitwiseOperator:xt(ll),compareOperator:xt(ll),updateOperator:xt(ll),definitionOperator:xt(ll),typeOperator:xt(ll),controlOperator:xt(ll),punctuation:MS,separator:xt(MS),bracket:Gp,angleBracket:xt(Gp),squareBracket:xt(Gp),paren:xt(Gp),brace:xt(Gp),content:ul,heading:_u,heading1:xt(_u),heading2:xt(_u),heading3:xt(_u),heading4:xt(_u),heading5:xt(_u),heading6:xt(_u),contentSeparator:xt(ul),list:xt(ul),quote:xt(ul),emphasis:xt(ul),strong:xt(ul),link:xt(ul),monospace:xt(ul),strikethrough:xt(ul),inserted:xt(),deleted:xt(),changed:xt(),invalid:xt(),meta:v0,documentMeta:xt(v0),annotation:xt(v0),processingInstruction:xt(v0),definition:Gi.defineModifier("definition"),constant:Gi.defineModifier("constant"),function:Gi.defineModifier("function"),standard:Gi.defineModifier("standard"),local:Gi.defineModifier("local"),special:Gi.defineModifier("special")};for(let n in b){let e=b[n];e instanceof Gi&&(e.name=n)}Mq([{tag:b.link,class:"tok-link"},{tag:b.heading,class:"tok-heading"},{tag:b.emphasis,class:"tok-emphasis"},{tag:b.strong,class:"tok-strong"},{tag:b.keyword,class:"tok-keyword"},{tag:b.atom,class:"tok-atom"},{tag:b.bool,class:"tok-bool"},{tag:b.url,class:"tok-url"},{tag:b.labelName,class:"tok-labelName"},{tag:b.inserted,class:"tok-inserted"},{tag:b.deleted,class:"tok-deleted"},{tag:b.literal,class:"tok-literal"},{tag:b.string,class:"tok-string"},{tag:b.number,class:"tok-number"},{tag:[b.regexp,b.escape,b.special(b.string)],class:"tok-string2"},{tag:b.variableName,class:"tok-variableName"},{tag:b.local(b.variableName),class:"tok-variableName tok-local"},{tag:b.definition(b.variableName),class:"tok-variableName tok-definition"},{tag:b.special(b.variableName),class:"tok-variableName2"},{tag:b.definition(b.propertyName),class:"tok-propertyName tok-definition"},{tag:b.typeName,class:"tok-typeName"},{tag:b.namespace,class:"tok-namespace"},{tag:b.className,class:"tok-className"},{tag:b.macroName,class:"tok-macroName"},{tag:b.propertyName,class:"tok-propertyName"},{tag:b.operator,class:"tok-operator"},{tag:b.comment,class:"tok-comment"},{tag:b.meta,class:"tok-meta"},{tag:b.invalid,class:"tok-invalid"},{tag:b.punctuation,class:"tok-punctuation"}]);var rx;const Jh=new jn;function Dq(n){return _t.define({combine:n?e=>e.concat(n):void 0})}const hE=new jn;class so{constructor(e,t,s=[],r=""){this.data=e,this.name=r,rs.prototype.hasOwnProperty("tree")||Object.defineProperty(rs.prototype,"tree",{get(){return Wr(this)}}),this.parser=t,this.extension=[Ud.of(this),rs.languageData.of((a,i,o)=>{let l=M4(a,i,o),c=l.type.prop(Jh);if(!c)return[];let u=a.facet(c),h=l.type.prop(hE);if(h){let d=l.resolve(i-l.from,o);for(let m of h)if(m.test(d,a)){let y=a.facet(m.facet);return m.type=="replace"?y:y.concat(u)}}return u})].concat(s)}isActiveAt(e,t,s=-1){return M4(e,t,s).type.prop(Jh)==this.data}findRegions(e){let t=e.facet(Ud);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let s=[],r=(a,i)=>{if(a.prop(Jh)==this.data){s.push({from:i,to:i+a.length});return}let o=a.prop(jn.mounted);if(o){if(o.tree.prop(Jh)==this.data){if(o.overlay)for(let l of o.overlay)s.push({from:l.from+i,to:l.to+i});else s.push({from:i,to:i+a.length});return}else if(o.overlay){let l=s.length;if(r(o.tree,o.overlay[0].from+i),s.length>l)return}}for(let l=0;l<a.children.length;l++){let c=a.children[l];c instanceof br&&r(c,a.positions[l]+i)}};return r(Wr(e),0),s}get allowsNesting(){return!0}}so.setState=ln.define();function M4(n,e,t){let s=n.facet(Ud),r=Wr(n).topNode;if(!s||s.allowsNesting)for(let a=r;a;a=a.enter(e,t,Sr.ExcludeBuffers))a.type.isTop&&(r=a);return r}class Xy extends so{constructor(e,t,s){super(e,t,[],s),this.parser=t}static define(e){let t=Dq(e.languageData);return new Xy(t,e.parser.configure({props:[Jh.add(s=>s.isTop?t:void 0)]}),e.name)}configure(e,t){return new Xy(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Wr(n){let e=n.field(so.state,!1);return e?e.tree:br.empty}function Tq(n,e,t=50){var s;let r=(s=n.field(so.state,!1))===null||s===void 0?void 0:s.context;if(!r)return null;let a=r.viewport;r.updateViewport({from:0,to:e});let i=r.isDone(e)||r.work(t,e)?r.tree:null;return r.updateViewport(a),i}class qxe{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let s=this.cursorPos-this.string.length;return e<s||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-s,t-s)}}let Xp=null;class Hy{constructor(e,t,s=[],r,a,i,o,l){this.parser=e,this.state=t,this.fragments=s,this.tree=r,this.treeLen=a,this.viewport=i,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,s){return new Hy(e,t,[],br.empty,0,s,[],null)}startParse(){return this.parser.startParse(new qxe(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=br.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var s;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(uh.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(s=this.parse.stoppedAt)!==null&&s!==void 0?s:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(uh.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Xp;Xp=this;try{return e()}finally{Xp=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=D4(e,t.from,t.to);return e}changes(e,t){let{fragments:s,tree:r,treeLen:a,viewport:i,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,u,h,d)=>l.push({fromA:c,toA:u,fromB:h,toB:d})),s=uh.applyChanges(s,l),r=br.empty,a=0,i={from:e.mapPos(i.from,-1),to:e.mapPos(i.to,1)},this.skipped.length){o=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),h=e.mapPos(c.to,-1);u<h&&o.push({from:u,to:h})}}}return new Hy(this.parser,t,s,r,a,i,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:r,to:a}=this.skipped[s];r<e.to&&a>e.from&&(this.fragments=D4(this.fragments,r,a),this.skipped.splice(s--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Pq{createParse(t,s,r){let a=r[0].from,i=r[r.length-1].to;return{parsedPos:a,advance(){let o=Xp;if(o){for(let l of r)o.tempSkipped.push(l);e&&(o.scheduleOn=o.scheduleOn?Promise.all([o.scheduleOn,e]):e)}return this.parsedPos=i,new br(ci.none,[],[],i-a)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Xp}}function D4(n,e,t){return uh.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class qd{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),s=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,s)||t.takeTree(),new qd(t)}static init(e){let t=Math.min(3e3,e.doc.length),s=Hy.create(e.facet(Ud).parser,e,{from:0,to:t});return s.work(20,t)||s.takeTree(),new qd(s)}}so.state=Us.define({create:qd.init,update(n,e){for(let t of e.effects)if(t.is(so.setState))return t.value;return e.startState.facet(Ud)!=e.state.facet(Ud)?qd.init(e.state):n.apply(e)}});let Bq=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(Bq=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const ax=typeof navigator<"u"&&!((rx=navigator.scheduling)===null||rx===void 0)&&rx.isInputPending?()=>navigator.scheduling.isInputPending():null,Uxe=nr.fromClass(class{constructor(n){this.view=n,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(n){let e=this.view.state.field(so.state).context;(e.updateViewport(n.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(n.docChanged||n.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:n}=this.view,e=n.field(so.state);(e.tree!=e.context.tree||!e.context.isDone(n.doc.length))&&(this.working=Bq(this.work))}work(n){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:t,viewport:{to:s}}=this.view,r=t.field(so.state);if(r.tree==r.context.tree&&r.context.isDone(s+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,n&&!ax?Math.max(25,n.timeRemaining()-5):1e9),i=r.context.treeLen<s&&t.doc.length>s+1e3,o=r.context.work(()=>ax&&ax()||Date.now()>a,s+(i?0:1e5));this.chunkBudget-=Date.now()-e,(o||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:so.setState.of(new qd(r.context))})),this.chunkBudget>0&&!(o&&!i)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(n){n.scheduleOn&&(this.workScheduled++,n.scheduleOn.then(()=>this.scheduleWork()).catch(e=>ni(this.view.state,e)).then(()=>this.workScheduled--),n.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ud=_t.define({combine(n){return n.length?n[0]:null},enables:n=>[so.state,Uxe,vt.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class Wxe{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const Gxe=_t.define(),Wd=_t.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function Yy(n){let e=n.facet(Wd);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function Ky(n,e){let t="",s=n.tabSize,r=n.facet(Wd)[0];if(r=="	"){for(;e>=s;)t+="	",e-=s;r=" "}for(let a=0;a<e;a++)t+=r;return t}function Fq(n,e){n instanceof rs&&(n=new Iv(n));for(let s of n.state.facet(Gxe)){let r=s(n,e);if(r!==void 0)return r}let t=Wr(n.state);return t.length>=e?Xxe(n,t,e):null}class Iv{constructor(e,t={}){this.state=e,this.options=t,this.unit=Yy(e)}lineAt(e,t=1){let s=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:a}=this.options;return r!=null&&r>=s.from&&r<=s.to?a&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:s.text.slice(r-s.from),from:r}:{text:s.text.slice(0,r-s.from),from:s.from}:s}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:s,from:r}=this.lineAt(e,t);return s.slice(e-r,Math.min(s.length,e+100-r))}column(e,t=1){let{text:s,from:r}=this.lineAt(e,t),a=this.countColumn(s,e-r),i=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return i>-1&&(a+=i-this.countColumn(s,s.search(/\S|$/))),a}countColumn(e,t=e.length){return Op(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:s,from:r}=this.lineAt(e,t),a=this.options.overrideIndentation;if(a){let i=a(r);if(i>-1)return i}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const $q=new jn;function Xxe(n,e,t){let s=e.resolveStack(t),r=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(r!=s.node){let a=[];for(let i=r;i&&!(i.from==s.node.from&&i.type==s.node.type);i=i.parent)a.push(i);for(let i=a.length-1;i>=0;i--)s={node:a[i],next:s}}return Nq(s,n,t)}function Nq(n,e,t){for(let s=n;s;s=s.next){let r=Yxe(s.node);if(r)return r(dE.create(e,t,s))}return 0}function Hxe(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function Yxe(n){let e=n.type.prop($q);if(e)return e;let t=n.firstChild,s;if(t&&(s=t.type.prop(jn.closedBy))){let r=n.lastChild,a=r&&s.indexOf(r.name)>-1;return i=>_q(i,!0,1,void 0,a&&!Hxe(i)?r.from:void 0)}return n.parent==null?Kxe:null}function Kxe(){return 0}class dE extends Iv{constructor(e,t,s){super(e.state,e.options),this.base=e,this.pos=t,this.context=s}get node(){return this.context.node}static create(e,t,s){return new dE(e,t,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let s=e.resolve(t.from);for(;s.parent&&s.parent.from==s.from;)s=s.parent;if(Jxe(s,e))break;t=this.state.doc.lineAt(s.from)}return this.lineIndent(t.from)}continue(){return Nq(this.context.next,this.base,this.pos)}}function Jxe(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function eke(n){let e=n.node,t=e.childAfter(e.from),s=e.lastChild;if(!t)return null;let r=n.options.simulateBreak,a=n.state.doc.lineAt(t.from),i=r==null||r<=a.from?a.to:Math.min(a.to,r);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==s)return null;if(!l.type.isSkipped){if(l.from>=i)return null;let c=/^ */.exec(a.text.slice(t.to-a.from))[0].length;return{from:t.from,to:t.to+c}}o=l.to}}function tke({closing:n,align:e=!0,units:t=1}){return s=>_q(s,e,t,n)}function _q(n,e,t,s,r){let a=n.textAfter,i=a.match(/^\s*/)[0].length,o=s&&a.slice(i,i+s.length)==s||r==n.pos+i,l=e?eke(n):null;return l?o?n.column(l.from):n.column(l.to):n.baseIndent+(o?0:n.unit*t)}const nke=n=>n.baseIndent;function ix({except:n,units:e=1}={}){return t=>{let s=n&&n.test(t.textAfter);return t.baseIndent+(s?0:e*t.unit)}}const ske=_t.define(),Rq=new jn;function rke(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function ake(n,e,t){let s=Wr(n);if(s.length<t)return null;let r=s.resolveStack(t,1),a=null;for(let i=r;i;i=i.next){let o=i.node;if(o.to<=t||o.from>t)continue;if(a&&o.from<e)break;let l=o.type.prop(Rq);if(l&&(o.to<s.length-50||s.length==n.doc.length||!ike(o))){let c=l(o,n);c&&c.from<=t&&c.from>=e&&c.to>t&&(a=c)}}return a}function ike(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function Iq(n,e,t){for(let s of n.facet(ske)){let r=s(n,e,t);if(r)return r}return ake(n,e,t)}function Lq(n,e){let t=e.mapPos(n.from,1),s=e.mapPos(n.to,-1);return t>=s?void 0:{from:t,to:s}}const pE=ln.define({map:Lq}),Lv=ln.define({map:Lq});function Qq(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(s=>s.from<=t&&s.to>=t)||e.push(n.lineBlockAt(t));return e}const mg=Us.define({create(){return Yt.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(pE)&&!oke(n,t.value.from,t.value.to)){let{preparePlaceholder:s}=e.state.facet(qq),r=s?Yt.replace({widget:new pke(s(e.state,t.value))}):T4;n=n.update({add:[r.range(t.value.from,t.value.to)]})}else t.is(Lv)&&(n=n.update({filter:(s,r)=>t.value.from!=s||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:s}=e.selection.main;n.between(s,s,(r,a)=>{r<s&&a>s&&(t=!0)}),t&&(n=n.update({filterFrom:s,filterTo:s,filter:(r,a)=>a<=s||r>=s}))}return n},provide:n=>vt.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(s,r)=>{t.push(s,r)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let s=n[t++],r=n[t++];if(typeof s!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(T4.range(s,r))}return Yt.set(e,!0)}});function jq(n,e,t){var s;let r=null;return(s=n.field(mg,!1))===null||s===void 0||s.between(e,t,(a,i)=>{(!r||r.from>a)&&(r={from:a,to:i})}),r}function oke(n,e,t){let s=!1;return n.between(e,e,(r,a)=>{r==e&&a==t&&(s=!0)}),s}function Vq(n,e){return n.field(mg,!1)?e:e.concat(ln.appendConfig.of(dke()))}const Zq=n=>{for(let e of Qq(n)){let t=Iq(n.state,e.from,e.to);if(t)return n.dispatch({effects:Vq(n.state,[pE.of(t),zq(n,t)])}),!0}return!1},lke=n=>{if(!n.state.field(mg,!1))return!1;let e=[];for(let t of Qq(n)){let s=jq(n.state,t.from,t.to);s&&e.push(Lv.of(s),zq(n,s,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function zq(n,e,t=!0){let s=n.state.doc.lineAt(e.from).number,r=n.state.doc.lineAt(e.to).number;return vt.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${s} ${n.state.phrase("to")} ${r}.`)}const cke=n=>{let{state:e}=n,t=[];for(let s=0;s<e.doc.length;){let r=n.lineBlockAt(s),a=Iq(e,r.from,r.to);a&&t.push(pE.of(a)),s=(a?n.lineBlockAt(a.to):r).to+1}return t.length&&n.dispatch({effects:Vq(n.state,t)}),!!t.length},uke=n=>{let e=n.state.field(mg,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(s,r)=>{t.push(Lv.of({from:s,to:r}))}),n.dispatch({effects:t}),!0},hke={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},qq=_t.define({combine(n){return Tc(n,hke)}});function dke(n){return[mg,mke]}function Uq(n,e){let{state:t}=n,s=t.facet(qq),r=i=>{let o=n.lineBlockAt(n.posAtDOM(i.target)),l=jq(n.state,o.from,o.to);l&&n.dispatch({effects:Lv.of(l)}),i.preventDefault()};if(s.placeholderDOM)return s.placeholderDOM(n,r,e);let a=document.createElement("span");return a.textContent=s.placeholderText,a.setAttribute("aria-label",t.phrase("folded code")),a.title=t.phrase("unfold"),a.className="cm-foldPlaceholder",a.onclick=r,a}const T4=Yt.replace({widget:new class extends el{toDOM(n){return Uq(n,null)}}});class pke extends el{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return Uq(e,this.value)}}const mke=vt.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class fg{constructor(e,t){this.specs=e;let s;function r(o){let l=bu.newName();return(s||(s=Object.create(null)))["."+l]=o,l}const a=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,i=t.scope;this.scope=i instanceof so?o=>o.prop(Jh)==i.data:i?o=>o==i:void 0,this.style=Mq(e.map(o=>({tag:o.tag,class:o.class||r(Object.assign({},o,{tag:null}))})),{all:a}).style,this.module=s?new bu(s):null,this.themeType=t.themeType}static define(e,t){return new fg(e,t||{})}}const DS=_t.define(),Wq=_t.define({combine(n){return n.length?[n[0]]:null}});function ox(n){let e=n.facet(DS);return e.length?e:n.facet(Wq)}function mE(n,e){let t=[gke],s;return n instanceof fg&&(n.module&&t.push(vt.styleModule.of(n.module)),s=n.themeType),e!=null&&e.fallback?t.push(Wq.of(n)):s?t.push(DS.computeN([vt.darkTheme],r=>r.facet(vt.darkTheme)==(s=="dark")?[n]:[])):t.push(DS.of(n)),t}class fke{constructor(e){this.markCache=Object.create(null),this.tree=Wr(e.state),this.decorations=this.buildDeco(e,ox(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Wr(e.state),s=ox(e.state),r=s!=ox(e.startState),{viewport:a}=e.view,i=e.changes.mapPos(this.decoratedTo,1);t.length<a.to&&!r&&t.type==this.tree.type&&i>=a.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=i):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,s),this.decoratedTo=a.to)}buildDeco(e,t){if(!t||!this.tree.length)return Yt.none;let s=new _l;for(let{from:r,to:a}of e.visibleRanges)Vxe(this.tree,t,(i,o,l)=>{s.add(i,o,this.markCache[l]||(this.markCache[l]=Yt.mark({class:l})))},r,a);return s.finish()}}const gke=ui.high(nr.fromClass(fke,{decorations:n=>n.decorations})),Gq=fg.define([{tag:b.meta,color:"#404740"},{tag:b.link,textDecoration:"underline"},{tag:b.heading,textDecoration:"underline",fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.strong,fontWeight:"bold"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.keyword,color:"#708"},{tag:[b.atom,b.bool,b.url,b.contentSeparator,b.labelName],color:"#219"},{tag:[b.literal,b.inserted],color:"#164"},{tag:[b.string,b.deleted],color:"#a11"},{tag:[b.regexp,b.escape,b.special(b.string)],color:"#e40"},{tag:b.definition(b.variableName),color:"#00f"},{tag:b.local(b.variableName),color:"#30a"},{tag:[b.typeName,b.namespace],color:"#085"},{tag:b.className,color:"#167"},{tag:[b.special(b.variableName),b.macroName],color:"#256"},{tag:b.definition(b.propertyName),color:"#00c"},{tag:b.comment,color:"#940"},{tag:b.invalid,color:"#f00"}]),bke=vt.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Xq=1e4,Hq="()[]{}",Yq=_t.define({combine(n){return Tc(n,{afterCursor:!0,brackets:Hq,maxScanDistance:Xq,renderMatch:Oke})}}),yke=Yt.mark({class:"cm-matchingBracket"}),vke=Yt.mark({class:"cm-nonmatchingBracket"});function Oke(n){let e=[],t=n.matched?yke:vke;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const wke=Us.define({create(){return Yt.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],s=e.state.facet(Yq);for(let r of e.state.selection.ranges){if(!r.empty)continue;let a=ro(e.state,r.head,-1,s)||r.head>0&&ro(e.state,r.head-1,1,s)||s.afterCursor&&(ro(e.state,r.head,1,s)||r.head<e.state.doc.length&&ro(e.state,r.head+1,-1,s));a&&(t=t.concat(s.renderMatch(a,e.state)))}return Yt.set(t,!0)},provide:n=>vt.decorations.from(n)}),xke=[wke,bke];function kke(n={}){return[Yq.of(n),xke]}const Ske=new jn;function TS(n,e,t){let s=n.prop(e<0?jn.openedBy:jn.closedBy);if(s)return s;if(n.name.length==1){let r=t.indexOf(n.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function BS(n){let e=n.type.prop(Ske);return e?e(n.node):n}function ro(n,e,t,s={}){let r=s.maxScanDistance||Xq,a=s.brackets||Hq,i=Wr(n),o=i.resolveInner(e,t);for(let l=o;l;l=l.parent){let c=TS(l.type,t,a);if(c&&l.from<l.to){let u=BS(l);if(u&&(t>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return Cke(n,e,t,l,u,c,a)}}return Pke(n,e,t,i,o.type,r,a)}function Cke(n,e,t,s,r,a,i){let o=s.parent,l={from:r.from,to:r.to},c=0,u=o==null?void 0:o.cursor();if(u&&(t<0?u.childBefore(s.from):u.childAfter(s.to)))do if(t<0?u.to<=s.from:u.from>=s.to){if(c==0&&a.indexOf(u.type.name)>-1&&u.from<u.to){let h=BS(u);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(TS(u.type,t,i))c++;else if(TS(u.type,-t,i)){if(c==0){let h=BS(u);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}c--}}while(t<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function Pke(n,e,t,s,r,a,i){let o=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),l=i.indexOf(o);if(l<0||l%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},u=n.doc.iterRange(e,t>0?n.doc.length:0),h=0;for(let d=0;!u.next().done&&d<=a;){let m=u.value;t<0&&(d+=m.length);let y=e+d*t;for(let O=t>0?0:m.length-1,S=t>0?m.length:-1;O!=S;O+=t){let A=i.indexOf(m[O]);if(!(A<0||s.resolveInner(y+O,1).type!=r))if(A%2==0==t>0)h++;else{if(h==1)return{start:c,end:{from:y+O,to:y+O+1},matched:A>>1==l>>1};h--}}t>0&&(d+=m.length)}return u.done?{start:c,matched:!1}:null}function B4(n,e,t,s=0,r=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let a=r;for(let i=s;i<e;i++)n.charCodeAt(i)==9?a+=t-a%t:a++;return a}class Ake{constructor(e,t,s,r){this.string=e,this.tabSize=t,this.indentUnit=s,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),s;if(typeof e=="string"?s=t==e:s=t&&(e instanceof RegExp?e.test(t):e(t)),s)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B4(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:B4(this.string,null,this.tabSize)}match(e,t,s){if(typeof e=="string"){let r=i=>s?i.toLowerCase():i,a=this.string.substr(this.pos,e.length);return r(a)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}const Eke=Object.create(null),F4=[ci.none],$4=[],N4=Object.create(null),Mke=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Mke[n]=Dke(Eke,e);function lx(n,e){$4.indexOf(n)>-1||($4.push(n),console.warn(e))}function Dke(n,e){let t=[];for(let o of e.split(" ")){let l=[];for(let c of o.split(".")){let u=n[c]||b[c];u?typeof u=="function"?l.length?l=l.map(u):lx(c,`Modifier ${c} used at start of tag`):l.length?lx(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:lx(c,`Unknown highlighting tag ${c}`)}for(let c of l)t.push(c)}if(!t.length)return 0;let s=e.replace(/ /g,"_"),r=s+" "+t.map(o=>o.id),a=N4[r];if(a)return a.id;let i=N4[r]=ci.define({id:F4.length,name:s,props:[Aq({[s]:t})]});return F4.push(i),i.id}Ss.RTL,Ss.LTR;class Kq{constructor(e,t,s,r){this.state=e,this.pos=t,this.explicit=s,this.view=r,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Wr(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),s=Math.max(t.from,this.pos-250),r=t.text.slice(s-t.from,this.pos-t.from),a=r.search(eU(e,!1));return a<0?null:{from:s+a,to:this.pos,text:r.slice(a)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,s){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),s&&s.onDocChange&&(this.abortOnDocChange=!0))}}function _4(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Tke(n){let e=Object.create(null),t=Object.create(null);for(let{label:r}of n){e[r[0]]=!0;for(let a=1;a<r.length;a++)t[r[a]]=!0}let s=_4(e)+_4(t)+"*$";return[new RegExp("^"+s),new RegExp(s)]}function Jq(n){let e=n.map(r=>typeof r=="string"?{label:r}:r),[t,s]=e.every(r=>/^\w+$/.test(r.label))?[/\w*$/,/\w+$/]:Tke(e);return r=>{let a=r.matchBefore(s);return a||r.explicit?{from:a?a.from:r.pos,options:e,validFor:t}:null}}function Bke(n,e){return t=>{for(let s=Wr(t.state).resolveInner(t.pos,-1);s;s=s.parent){if(n.indexOf(s.name)>-1)return null;if(s.type.isTop)break}return e(t)}}class R4{constructor(e,t,s,r){this.completion=e,this.source=t,this.match=s,this.score=r}}function hh(n){return n.selection.main.from}function eU(n,e){var t;let{source:s}=n,r=e&&s[0]!="^",a=s[s.length-1]!="$";return!r&&!a?n:new RegExp(`${r?"^":""}(?:${s})${a?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const fE=Dc.define();function Fke(n,e,t,s){let{main:r}=n.selection,a=t-r.from,i=s-r.from;return Object.assign(Object.assign({},n.changeByRange(o=>{if(o!=r&&t!=s&&n.sliceDoc(o.from+a,o.from+i)!=n.sliceDoc(t,s))return{range:o};let l=n.toText(e);return{changes:{from:o.from+a,to:s==r.from?o.to:o.from+i,insert:l},range:Ve.cursor(o.from+a+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const I4=new WeakMap;function $ke(n){if(!Array.isArray(n))return n;let e=I4.get(n);return e||I4.set(n,e=Jq(n)),e}const Jy=ln.define(),Pf=ln.define();class Nke{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let s=Ya(e,t),r=Ol(s);this.chars.push(s);let a=e.slice(t,t+r),i=a.toUpperCase();this.folded.push(Ya(i==a?a.toLowerCase():i,0)),t+=r}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:s,any:r,precise:a,byWord:i}=this;if(t.length==1){let F=Ya(e,0),j=Ol(F),N=j==e.length?0:-100;if(F!=t[0])if(F==s[0])N+=-200;else return null;return this.ret(N,[0,j])}let o=e.indexOf(this.pattern);if(o==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,c=0;if(o<0){for(let F=0,j=Math.min(e.length,200);F<j&&c<l;){let N=Ya(e,F);(N==t[c]||N==s[c])&&(r[c++]=F),F+=Ol(N)}if(c<l)return null}let u=0,h=0,d=!1,m=0,y=-1,O=-1,S=/[a-z]/.test(e),A=!0;for(let F=0,j=Math.min(e.length,200),N=0;F<j&&h<l;){let $=Ya(e,F);o<0&&(u<l&&$==t[u]&&(a[u++]=F),m<l&&($==t[m]||$==s[m]?(m==0&&(y=F),O=F+1,m++):m=0));let L,I=$<255?$>=48&&$<=57||$>=97&&$<=122?2:$>=65&&$<=90?1:0:(L=qA($))!=L.toLowerCase()?1:L!=L.toUpperCase()?2:0;(!F||I==1&&S||N==0&&I!=0)&&(t[h]==$||s[h]==$&&(d=!0)?i[h++]=F:i.length&&(A=!1)),N=I,F+=Ol($)}return h==l&&i[0]==0&&A?this.result(-100+(d?-200:0),i,e):m==l&&y==0?this.ret(-200-e.length+(O==e.length?0:-100),[0,O]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):m==l?this.ret(-900-e.length,[y,O]):h==l?this.result(-100+(d?-200:0)+-700+(A?0:-1100),i,e):t.length==2?null:this.result((r[0]?-700:0)+-200+-1100,r,e)}result(e,t,s){let r=[],a=0;for(let i of t){let o=i+(this.astral?Ol(Ya(s,i)):1);a&&r[a-1]==i?r[a-1]=o:(r[a++]=i,r[a++]=o)}return this.ret(e-s.length,r)}}class _ke{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),s=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return s==null?null:(this.matched=[0,t.length],this.score=s+(e.length==this.pattern.length?0:-100),this)}}const _r=_t.define({combine(n){return Tc(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Rke,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>s=>L4(e(s),t(s)),optionClass:(e,t)=>s=>L4(e(s),t(s)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function L4(n,e){return n?e?n+" "+e:n:e}function Rke(n,e,t,s,r,a){let i=n.textDirection==Ss.RTL,o=i,l=!1,c="top",u,h,d=e.left-r.left,m=r.right-e.right,y=s.right-s.left,O=s.bottom-s.top;if(o&&d<Math.min(y,m)?o=!1:!o&&m<Math.min(y,d)&&(o=!0),y<=(o?d:m))u=Math.max(r.top,Math.min(t.top,r.bottom-O))-e.top,h=Math.min(400,o?d:m);else{l=!0,h=Math.min(400,(i?e.right:r.right-e.left)-30);let F=r.bottom-e.bottom;F>=O||F>e.top?u=t.bottom-e.top:(c="bottom",u=e.bottom-t.top)}let S=(e.bottom-e.top)/a.offsetHeight,A=(e.right-e.left)/a.offsetWidth;return{style:`${c}: ${u/S}px; max-width: ${h/A}px`,class:"cm-completionInfo-"+(l?i?"left-narrow":"right-narrow":o?"left":"right")}}function Ike(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let s=document.createElement("div");return s.classList.add("cm-completionIcon"),t.type&&s.classList.add(...t.type.split(/\s+/g).map(r=>"cm-completionIcon-"+r)),s.setAttribute("aria-hidden","true"),s},position:20}),e.push({render(t,s,r,a){let i=document.createElement("span");i.className="cm-completionLabel";let o=t.displayLabel||t.label,l=0;for(let c=0;c<a.length;){let u=a[c++],h=a[c++];u>l&&i.appendChild(document.createTextNode(o.slice(l,u)));let d=i.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(o.slice(u,h))),d.className="cm-completionMatchedText",l=h}return l<o.length&&i.appendChild(document.createTextNode(o.slice(l))),i},position:50},{render(t){if(!t.detail)return null;let s=document.createElement("span");return s.className="cm-completionDetail",s.textContent=t.detail,s},position:80}),e.sort((t,s)=>t.position-s.position).map(t=>t.render)}function cx(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let r=Math.floor(e/t);return{from:r*t,to:(r+1)*t}}let s=Math.floor((n-e)/t);return{from:n-(s+1)*t,to:n-s*t}}class Lke{constructor(e,t,s){this.view=e,this.stateField=t,this.applyCompletion=s,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let r=e.state.field(t),{options:a,selected:i}=r.open,o=e.state.facet(_r);this.optionContent=Ike(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=cx(a.length,i,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(t).open;for(let u=l.target,h;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(h=/-(\d+)$/.exec(u.id))&&+h[1]<c.length){this.applyCompletion(e,c[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(_r).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Pf.of(null)})}),this.showOptions(a,r.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let s=e.state.field(this.stateField),r=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),s!=r){let{options:a,selected:i,disabled:o}=s.open;(!r.open||r.open.options!=a)&&(this.range=cx(a.length,i,e.state.facet(_r).maxRenderedOptions),this.showOptions(a,s.id)),this.updateSel(),o!=((t=r.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let s of this.currentClass.split(" "))s&&this.dom.classList.remove(s);for(let s of t.split(" "))s&&this.dom.classList.add(s);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=cx(t.options.length,t.selected,this.view.state.facet(_r).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:s}=t.options[t.selected],{info:r}=s;if(!r)return;let a=typeof r=="string"?document.createTextNode(r):r(s);if(!a)return;"then"in a?a.then(i=>{i&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(i,s)}).catch(i=>ni(this.view.state,i,"completion info")):this.addInfoPane(a,s)}}addInfoPane(e,t){this.destroyInfo();let s=this.info=document.createElement("div");if(s.className="cm-tooltip cm-completionInfo",e.nodeType!=null)s.appendChild(e),this.infoDestroy=null;else{let{dom:r,destroy:a}=e;s.appendChild(r),this.infoDestroy=a||null}this.dom.appendChild(s),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let s=this.list.firstChild,r=this.range.from;s;s=s.nextSibling,r++)s.nodeName!="LI"||!s.id?r--:r==e?s.hasAttribute("aria-selected")||(s.setAttribute("aria-selected","true"),t=s):s.hasAttribute("aria-selected")&&s.removeAttribute("aria-selected");return t&&jke(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),s=this.info.getBoundingClientRect(),r=e.getBoundingClientRect(),a=this.space;if(!a){let i=this.dom.ownerDocument.defaultView||window;a={left:0,top:0,right:i.innerWidth,bottom:i.innerHeight}}return r.top>Math.min(a.bottom,t.bottom)-10||r.bottom<Math.max(a.top,t.top)+10?null:this.view.state.facet(_r).positionInfo(this.view,t,r,s,a,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,s){const r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions"));let a=null;for(let i=s.from;i<s.to;i++){let{completion:o,match:l}=e[i],{section:c}=o;if(c){let d=typeof c=="string"?c:c.name;if(d!=a&&(i>s.from||s.from==0))if(a=d,typeof c!="string"&&c.header)r.appendChild(c.header(c));else{let m=r.appendChild(document.createElement("completion-section"));m.textContent=d}}const u=r.appendChild(document.createElement("li"));u.id=t+"-"+i,u.setAttribute("role","option");let h=this.optionClass(o);h&&(u.className=h);for(let d of this.optionContent){let m=d(o,this.view.state,this.view,l);m&&u.appendChild(m)}}return s.from&&r.classList.add("cm-completionListIncompleteTop"),s.to<e.length&&r.classList.add("cm-completionListIncompleteBottom"),r}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Qke(n,e){return t=>new Lke(t,n,e)}function jke(n,e){let t=n.getBoundingClientRect(),s=e.getBoundingClientRect(),r=t.height/n.offsetHeight;s.top<t.top?n.scrollTop-=(t.top-s.top)/r:s.bottom>t.bottom&&(n.scrollTop+=(s.bottom-t.bottom)/r)}function Q4(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function Vke(n,e){let t=[],s=null,r=c=>{t.push(c);let{section:u}=c.completion;if(u){s||(s=[]);let h=typeof u=="string"?u:u.name;s.some(d=>d.name==h)||s.push(typeof u=="string"?{name:h}:u)}},a=e.facet(_r);for(let c of n)if(c.hasResult()){let u=c.result.getMatch;if(c.result.filter===!1)for(let h of c.result.options)r(new R4(h,c.source,u?u(h):[],1e9-t.length));else{let h=e.sliceDoc(c.from,c.to),d,m=a.filterStrict?new _ke(h):new Nke(h);for(let y of c.result.options)if(d=m.match(y.label)){let O=y.displayLabel?u?u(y,d.matched):[]:d.matched;r(new R4(y,c.source,O,d.score+(y.boost||0)))}}}if(s){let c=Object.create(null),u=0,h=(d,m)=>{var y,O;return((y=d.rank)!==null&&y!==void 0?y:1e9)-((O=m.rank)!==null&&O!==void 0?O:1e9)||(d.name<m.name?-1:1)};for(let d of s.sort(h))u-=1e5,c[d.name]=u;for(let d of t){let{section:m}=d.completion;m&&(d.score+=c[typeof m=="string"?m:m.name])}}let i=[],o=null,l=a.compareCompletions;for(let c of t.sort((u,h)=>h.score-u.score||l(u.completion,h.completion))){let u=c.completion;!o||o.label!=u.label||o.detail!=u.detail||o.type!=null&&u.type!=null&&o.type!=u.type||o.apply!=u.apply||o.boost!=u.boost?i.push(c):Q4(c.completion)>Q4(o)&&(i[i.length-1]=c),o=c.completion}return i}class ed{constructor(e,t,s,r,a,i){this.options=e,this.attrs=t,this.tooltip=s,this.timestamp=r,this.selected=a,this.disabled=i}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new ed(this.options,j4(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,s,r,a,i){if(r&&!i&&e.some(c=>c.isPending))return r.setDisabled();let o=Vke(e,t);if(!o.length)return r&&e.some(c=>c.isPending)?r.setDisabled():null;let l=t.facet(_r).selectOnOpen?0:-1;if(r&&r.selected!=l&&r.selected!=-1){let c=r.options[r.selected].completion;for(let u=0;u<o.length;u++)if(o[u].completion==c){l=u;break}}return new ed(o,j4(s,l),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:Gke,above:a.aboveCursor},r?r.timestamp:Date.now(),l,!1)}map(e){return new ed(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new ed(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class e1{constructor(e,t,s){this.active=e,this.id=t,this.open=s}static start(){return new e1(Uke,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,s=t.facet(_r),r=(s.override||t.languageDataAt("autocomplete",hh(t)).map($ke)).map(o=>(this.active.find(l=>l.source==o)||new ao(o,this.active.some(l=>l.state!=0)?1:0)).update(e,s));r.length==this.active.length&&r.every((o,l)=>o==this.active[l])&&(r=this.active);let a=this.open,i=e.effects.some(o=>o.is(gE));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||r.some(o=>o.hasResult()&&e.changes.touchesRange(o.from,o.to))||!Zke(r,this.active)||i?a=ed.build(r,t,this.id,a,s,i):a&&a.disabled&&!r.some(o=>o.isPending)&&(a=null),!a&&r.every(o=>!o.isPending)&&r.some(o=>o.hasResult())&&(r=r.map(o=>o.hasResult()?new ao(o.source,0):o));for(let o of e.effects)o.is(nU)&&(a=a&&a.setSelected(o.value,this.id));return r==this.active&&a==this.open?this:new e1(r,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?zke:qke}}function Zke(n,e){if(n==e)return!0;for(let t=0,s=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;s<e.length&&!e[s].hasResult();)s++;let r=t==n.length,a=s==e.length;if(r||a)return r==a;if(n[t++].result!=e[s++].result)return!1}}const zke={"aria-autocomplete":"list"},qke={};function j4(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const Uke=[];function tU(n,e){if(n.isUserEvent("input.complete")){let s=n.annotation(fE);if(s&&e.activateOnCompletion(s))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class ao{constructor(e,t,s=!1){this.source=e,this.state=t,this.explicit=s}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let s=tU(e,t),r=this;(s&8||s&16&&this.touches(e))&&(r=new ao(r.source,0)),s&4&&r.state==0&&(r=new ao(this.source,1)),r=r.updateFor(e,s);for(let a of e.effects)if(a.is(Jy))r=new ao(r.source,1,a.value);else if(a.is(Pf))r=new ao(r.source,0);else if(a.is(gE))for(let i of a.value)i.source==r.source&&(r=i);return r}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(hh(e.state))}}class yd extends ao{constructor(e,t,s,r,a,i){super(e,3,t),this.limit=s,this.result=r,this.from=a,this.to=i}hasResult(){return!0}updateFor(e,t){var s;if(!(t&3))return this.map(e.changes);let r=this.result;r.map&&!e.changes.empty&&(r=r.map(r,e.changes));let a=e.changes.mapPos(this.from),i=e.changes.mapPos(this.to,1),o=hh(e.state);if(o>i||!r||t&2&&(hh(e.startState)==this.from||o<this.limit))return new ao(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return Wke(r.validFor,e.state,a,i)?new yd(this.source,this.explicit,l,r,a,i):r.update&&(r=r.update(r,a,i,new Kq(e.state,o,!1)))?new yd(this.source,this.explicit,l,r,r.from,(s=r.to)!==null&&s!==void 0?s:hh(e.state)):new ao(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new yd(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ao(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Wke(n,e,t,s){if(!n)return!1;let r=e.sliceDoc(t,s);return typeof n=="function"?n(r,t,s,e):eU(n,!0).test(r)}const gE=ln.define({map(n,e){return n.map(t=>t.map(e))}}),nU=ln.define(),Oa=Us.define({create(){return e1.start()},update(n,e){return n.update(e)},provide:n=>[iE.from(n,e=>e.tooltip),vt.contentAttributes.from(n,e=>e.attrs)]});function bE(n,e){const t=e.completion.apply||e.completion.label;let s=n.state.field(Oa).active.find(r=>r.source==e.source);return s instanceof yd?(typeof t=="string"?n.dispatch(Object.assign(Object.assign({},Fke(n.state,t,s.from,s.to)),{annotations:fE.of(e.completion)})):t(n,e.completion,s.from,s.to),!0):!1}const Gke=Qke(Oa,bE);function Yc(n,e="option"){return t=>{let s=t.state.field(Oa,!1);if(!s||!s.open||s.open.disabled||Date.now()-s.open.timestamp<t.state.facet(_r).interactionDelay)return!1;let r=1,a;e=="page"&&(a=vq(t,s.open.tooltip))&&(r=Math.max(2,Math.floor(a.dom.offsetHeight/a.dom.querySelector("li").offsetHeight)-1));let{length:i}=s.open.options,o=s.open.selected>-1?s.open.selected+r*(n?1:-1):n?0:i-1;return o<0?o=e=="page"?0:i-1:o>=i&&(o=e=="page"?i-1:0),t.dispatch({effects:nU.of(o)}),!0}}const FS=n=>{let e=n.state.field(Oa,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(_r).interactionDelay?!1:bE(n,e.open.options[e.open.selected])},$S=n=>n.state.field(Oa,!1)?(n.dispatch({effects:Jy.of(!0)}),!0):!1,sU=n=>{let e=n.state.field(Oa,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:Pf.of(null)}),!0)};class Xke{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const Hke=50,Yke=1e3,Kke=nr.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(Oa).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(Oa),t=n.state.facet(_r);if(!n.selectionSet&&!n.docChanged&&n.startState.field(Oa)==e)return;let s=n.transactions.some(a=>{let i=tU(a,t);return i&8||(a.selection||a.docChanged)&&!(i&3)});for(let a=0;a<this.running.length;a++){let i=this.running[a];if(s||i.context.abortOnDocChange&&n.docChanged||i.updates.length+n.transactions.length>Hke&&Date.now()-i.time>Yke){for(let o of i.context.abortListeners)try{o()}catch(l){ni(this.view.state,l)}i.context.abortListeners=null,this.running.splice(a--,1)}else i.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(a=>a.effects.some(i=>i.is(Jy)))&&(this.pendingStart=!0);let r=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(a=>a.isPending&&!this.running.some(i=>i.active.source==a.source))?setTimeout(()=>this.startUpdate(),r):-1,this.composing!=0)for(let a of n.transactions)a.isUserEvent("input.type")?this.composing=2:this.composing==2&&a.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(Oa);for(let t of e.active)t.isPending&&!this.running.some(s=>s.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(_r).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=hh(e),s=new Kq(e,t,n.explicit,this.view),r=new Xke(n,s);this.running.push(r),Promise.resolve(n.source(s)).then(a=>{r.context.aborted||(r.done=a||null,this.scheduleAccept())},a=>{this.view.dispatch({effects:Pf.of(null)}),ni(this.view.state,a)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(_r).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(_r),s=this.view.state.field(Oa);for(let r=0;r<this.running.length;r++){let a=this.running[r];if(a.done===void 0)continue;if(this.running.splice(r--,1),a.done){let o=hh(a.updates.length?a.updates[0].startState:this.view.state),l=Math.min(o,a.done.from+(a.active.explicit?0:1)),c=new yd(a.active.source,a.active.explicit,l,a.done,a.done.from,(n=a.done.to)!==null&&n!==void 0?n:o);for(let u of a.updates)c=c.update(u,t);if(c.hasResult()){e.push(c);continue}}let i=s.active.find(o=>o.source==a.active.source);if(i&&i.isPending)if(a.done==null){let o=new ao(a.active.source,0);for(let l of a.updates)o=o.update(l,t);o.isPending||e.push(o)}else this.startQuery(i)}(e.length||s.open&&s.open.disabled)&&this.view.dispatch({effects:gE.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(Oa,!1);if(e&&e.tooltip&&this.view.state.facet(_r).closeOnBlur){let t=e.open&&vq(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Pf.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Jy.of(!1)}),20),this.composing=0}}}),Jke=typeof navigator=="object"&&/Win/.test(navigator.platform),e2e=ui.highest(vt.domEventHandlers({keydown(n,e){let t=e.state.field(Oa,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(Jke&&n.altKey)||n.metaKey)return!1;let s=t.open.options[t.open.selected],r=t.active.find(i=>i.source==s.source),a=s.completion.commitCharacters||r.result.commitCharacters;return a&&a.indexOf(n.key)>-1&&bE(e,s),!1}})),rU=vt.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class t2e{constructor(e,t,s,r){this.field=e,this.line=t,this.from=s,this.to=r}}class yE{constructor(e,t,s){this.field=e,this.from=t,this.to=s}map(e){let t=e.mapPos(this.from,-1,mr.TrackDel),s=e.mapPos(this.to,1,mr.TrackDel);return t==null||s==null?null:new yE(this.field,t,s)}}class vE{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let s=[],r=[t],a=e.doc.lineAt(t),i=/^\s*/.exec(a.text)[0];for(let l of this.lines){if(s.length){let c=i,u=/^\t*/.exec(l)[0].length;for(let h=0;h<u;h++)c+=e.facet(Wd);r.push(t+c.length-u),l=c+l.slice(u)}s.push(l),t+=l.length+1}let o=this.fieldPositions.map(l=>new yE(l.field,r[l.line]+l.from,r[l.line]+l.to));return{text:s,ranges:o}}static parse(e){let t=[],s=[],r=[],a;for(let i of e.split(/\r\n?|\n/)){for(;a=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(i);){let o=a[1]?+a[1]:null,l=a[2]||a[3]||"",c=-1,u=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<t.length;h++)(o!=null?t[h].seq==o:u&&t[h].name==u)&&(c=h);if(c<0){let h=0;for(;h<t.length&&(o==null||t[h].seq!=null&&t[h].seq<o);)h++;t.splice(h,0,{seq:o,name:u}),c=h;for(let d of r)d.field>=c&&d.field++}r.push(new t2e(c,s.length,a.index,a.index+u.length)),i=i.slice(0,a.index)+l+i.slice(a.index+a[0].length)}i=i.replace(/\\([{}])/g,(o,l,c)=>{for(let u of r)u.line==s.length&&u.from>c&&(u.from--,u.to--);return l}),s.push(i)}return new vE(s,r)}}let n2e=Yt.widget({widget:new class extends el{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),s2e=Yt.mark({class:"cm-snippetField"});class wp{constructor(e,t){this.ranges=e,this.active=t,this.deco=Yt.set(e.map(s=>(s.from==s.to?n2e:s2e).range(s.from,s.to)))}map(e){let t=[];for(let s of this.ranges){let r=s.map(e);if(!r)return null;t.push(r)}return new wp(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(s=>s.field==this.active&&s.from<=t.from&&s.to>=t.to))}}const gg=ln.define({map(n,e){return n&&n.map(e)}}),r2e=ln.define(),Af=Us.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(gg))return t.value;if(t.is(r2e)&&n)return new wp(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>vt.decorations.from(n,e=>e?e.deco:Yt.none)});function OE(n,e){return Ve.create(n.filter(t=>t.field==e).map(t=>Ve.range(t.from,t.to)))}function a2e(n){let e=vE.parse(n);return(t,s,r,a)=>{let{text:i,ranges:o}=e.instantiate(t.state,r),{main:l}=t.state.selection,c={changes:{from:r,to:a==l.from?l.to:a,insert:ts.of(i)},scrollIntoView:!0,annotations:s?[fE.of(s),Sa.userEvent.of("input.complete")]:void 0};if(o.length&&(c.selection=OE(o,0)),o.some(u=>u.field>0)){let u=new wp(o,0),h=c.effects=[gg.of(u)];t.state.field(Af,!1)===void 0&&h.push(ln.appendConfig.of([Af,u2e,h2e,rU]))}t.dispatch(t.state.update(c))}}function aU(n){return({state:e,dispatch:t})=>{let s=e.field(Af,!1);if(!s||n<0&&s.active==0)return!1;let r=s.active+n,a=n>0&&!s.ranges.some(i=>i.field==r+n);return t(e.update({selection:OE(s.ranges,r),effects:gg.of(a?null:new wp(s.ranges,r)),scrollIntoView:!0})),!0}}const i2e=({state:n,dispatch:e})=>n.field(Af,!1)?(e(n.update({effects:gg.of(null)})),!0):!1,o2e=aU(1),l2e=aU(-1),c2e=[{key:"Tab",run:o2e,shift:l2e},{key:"Escape",run:i2e}],V4=_t.define({combine(n){return n.length?n[0]:c2e}}),u2e=ui.highest(Bc.compute([V4],n=>n.facet(V4)));function _a(n,e){return Object.assign(Object.assign({},e),{apply:a2e(n)})}const h2e=vt.domEventHandlers({mousedown(n,e){let t=e.state.field(Af,!1),s;if(!t||(s=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let r=t.ranges.find(a=>a.from<=s&&a.to>=s);return!r||r.field==t.active?!1:(e.dispatch({selection:OE(t.ranges,r.field),effects:gg.of(t.ranges.some(a=>a.field>r.field)?new wp(t.ranges,r.field):null),scrollIntoView:!0}),!0)}}),Ef={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},th=ln.define({map(n,e){return e.mapPos(n,-1,mr.TrackAfter)??void 0}}),wE=new class extends wh{};wE.startSide=1;wE.endSide=-1;const iU=Us.define({create(){return cs.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:s=>s>=t.from&&s<=t.to})}for(let t of e.effects)t.is(th)&&(n=n.update({add:[wE.range(t.value,t.value+1)]}));return n}});function d2e(){return[m2e,iU]}const ux="()[]{}<>";function oU(n){for(let e=0;e<ux.length;e+=2)if(ux.charCodeAt(e)==n)return ux.charAt(e+1);return qA(n<128?n:n+1)}function lU(n,e){return n.languageDataAt("closeBrackets",e)[0]||Ef}const p2e=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),m2e=vt.inputHandler.of((n,e,t,s)=>{if((p2e?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let r=n.state.selection.main;if(s.length>2||s.length==2&&Ol(Ya(s,0))==1||e!=r.from||t!=r.to)return!1;let a=g2e(n.state,s);return a?(n.dispatch(a),!0):!1}),cU=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=lU(n,n.selection.main.head).brackets||Ef.brackets,s=null,r=n.changeByRange(a=>{if(a.empty){let i=b2e(n.doc,a.head);for(let o of t)if(o==i&&Qv(n.doc,a.head)==oU(Ya(o,0)))return{changes:{from:a.head-o.length,to:a.head+o.length},range:Ve.cursor(a.head-o.length)}}return{range:s=a}});return s||e(n.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},f2e=[{key:"Backspace",run:cU}];function g2e(n,e){let t=lU(n,n.selection.main.head),s=t.brackets||Ef.brackets;for(let r of s){let a=oU(Ya(r,0));if(e==r)return a==r?O2e(n,r,s.indexOf(r+r+r)>-1,t):y2e(n,r,a,t.before||Ef.before);if(e==a&&uU(n,n.selection.main.from))return v2e(n,r,a)}return null}function uU(n,e){let t=!1;return n.field(iU).between(0,n.doc.length,s=>{s==e&&(t=!0)}),t}function Qv(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Ol(Ya(t,0)))}function b2e(n,e){let t=n.sliceString(e-2,e);return Ol(Ya(t,0))==t.length?t:t.slice(1)}function y2e(n,e,t,s){let r=null,a=n.changeByRange(i=>{if(!i.empty)return{changes:[{insert:e,from:i.from},{insert:t,from:i.to}],effects:th.of(i.to+e.length),range:Ve.range(i.anchor+e.length,i.head+e.length)};let o=Qv(n.doc,i.head);return!o||/\s/.test(o)||s.indexOf(o)>-1?{changes:{insert:e+t,from:i.head},effects:th.of(i.head+e.length),range:Ve.cursor(i.head+e.length)}:{range:r=i}});return r?null:n.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function v2e(n,e,t){let s=null,r=n.changeByRange(a=>a.empty&&Qv(n.doc,a.head)==t?{changes:{from:a.head,to:a.head+t.length,insert:t},range:Ve.cursor(a.head+t.length)}:s={range:a});return s?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function O2e(n,e,t,s){let r=s.stringPrefixes||Ef.stringPrefixes,a=null,i=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:e,from:o.to}],effects:th.of(o.to+e.length),range:Ve.range(o.anchor+e.length,o.head+e.length)};let l=o.head,c=Qv(n.doc,l),u;if(c==e){if(Z4(n,l))return{changes:{insert:e+e,from:l},effects:th.of(l+e.length),range:Ve.cursor(l+e.length)};if(uU(n,l)){let h=t&&n.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+h.length,insert:h},range:Ve.cursor(l+h.length)}}}else{if(t&&n.sliceDoc(l-2*e.length,l)==e+e&&(u=z4(n,l-2*e.length,r))>-1&&Z4(n,u))return{changes:{insert:e+e+e+e,from:l},effects:th.of(l+e.length),range:Ve.cursor(l+e.length)};if(n.charCategorizer(l)(c)!=gr.Word&&z4(n,l,r)>-1&&!w2e(n,l,e,r))return{changes:{insert:e+e,from:l},effects:th.of(l+e.length),range:Ve.cursor(l+e.length)}}return{range:a=o}});return a?null:n.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function Z4(n,e){let t=Wr(n).resolveInner(e+1);return t.parent&&t.from==e}function w2e(n,e,t,s){let r=Wr(n).resolveInner(e,-1),a=s.reduce((i,o)=>Math.max(i,o.length),0);for(let i=0;i<5;i++){let o=n.sliceDoc(r.from,Math.min(r.to,r.from+t.length+a)),l=o.indexOf(t);if(!l||l>-1&&s.indexOf(o.slice(0,l))>-1){let u=r.firstChild;for(;u&&u.from==r.from&&u.to-u.from>t.length+l;){if(n.sliceDoc(u.to-t.length,u.to)==t)return!1;u=u.firstChild}return!0}let c=r.to==e&&r.parent;if(!c)break;r=c}return!1}function z4(n,e,t){let s=n.charCategorizer(e);if(s(n.sliceDoc(e-1,e))!=gr.Word)return e;for(let r of t){let a=e-r.length;if(n.sliceDoc(a,e)==r&&s(n.sliceDoc(a-1,a))!=gr.Word)return a}return-1}function x2e(n={}){return[e2e,Oa,_r.of(n),Kke,S2e,rU]}const k2e=[{key:"Ctrl-Space",run:$S},{mac:"Alt-`",run:$S},{key:"Escape",run:sU},{key:"ArrowDown",run:Yc(!0)},{key:"ArrowUp",run:Yc(!1)},{key:"PageDown",run:Yc(!0,"page")},{key:"PageUp",run:Yc(!1,"page")},{key:"Enter",run:FS}],S2e=ui.highest(Bc.computeN([_r],n=>n.facet(_r).defaultKeymap?[k2e]:[]));function C2e(n){let e=n.field(Oa,!1);return e&&e.active.some(t=>t.isPending)?"pending":e&&e.active.some(t=>t.state!=0)?"active":null}const jv=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),s=kE(n.state,t.from);return s.line?hU(n):s.block?dU(n):!1};function bg(n,e){return({state:t,dispatch:s})=>{if(t.readOnly)return!1;let r=n(e,t);return r?(s(t.update(r)),!0):!1}}const hU=bg(SE,0),P2e=bg(SE,1),A2e=bg(SE,2),xE=bg(pU,0),dU=bg((n,e)=>pU(n,e,M2e(e)),0);function kE(n,e){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const Hp=50;function E2e(n,{open:e,close:t},s,r){let a=n.sliceDoc(s-Hp,s),i=n.sliceDoc(r,r+Hp),o=/\s*$/.exec(a)[0].length,l=/^\s*/.exec(i)[0].length,c=a.length-o;if(a.slice(c-e.length,c)==e&&i.slice(l,l+t.length)==t)return{open:{pos:s-o,margin:o&&1},close:{pos:r+l,margin:l&&1}};let u,h;r-s<=2*Hp?u=h=n.sliceDoc(s,r):(u=n.sliceDoc(s,s+Hp),h=n.sliceDoc(r-Hp,r));let d=/^\s*/.exec(u)[0].length,m=/\s*$/.exec(h)[0].length,y=h.length-m-t.length;return u.slice(d,d+e.length)==e&&h.slice(y,y+t.length)==t?{open:{pos:s+d+e.length,margin:/\s/.test(u.charAt(d+e.length))?1:0},close:{pos:r-m-t.length,margin:/\s/.test(h.charAt(y-1))?1:0}}:null}function M2e(n){let e=[];for(let t of n.selection.ranges){let s=n.doc.lineAt(t.from),r=t.to<=s.to?s:n.doc.lineAt(t.to);r.from>s.from&&r.from==t.to&&(r=t.to==s.to+1?s:n.doc.lineAt(t.to-1));let a=e.length-1;a>=0&&e[a].to>s.from?e[a].to=r.to:e.push({from:s.from+/^\s*/.exec(s.text)[0].length,to:r.to})}return e}function pU(n,e,t=e.selection.ranges){let s=t.map(a=>kE(e,a.from).block);if(!s.every(a=>a))return null;let r=t.map((a,i)=>E2e(e,s[i],a.from,a.to));if(n!=2&&!r.every(a=>a))return{changes:e.changes(t.map((a,i)=>r[i]?[]:[{from:a.from,insert:s[i].open+" "},{from:a.to,insert:" "+s[i].close}]))};if(n!=1&&r.some(a=>a)){let a=[];for(let i=0,o;i<r.length;i++)if(o=r[i]){let l=s[i],{open:c,close:u}=o;a.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:a}}return null}function SE(n,e,t=e.selection.ranges){let s=[],r=-1;for(let{from:a,to:i}of t){let o=s.length,l=1e9,c=kE(e,a).line;if(c){for(let u=a;u<=i;){let h=e.doc.lineAt(u);if(h.from>r&&(a==i||i>h.from)){r=h.from;let d=/^\s*/.exec(h.text)[0].length,m=d==h.length,y=h.text.slice(d,d+c.length)==c?d:-1;d<h.text.length&&d<l&&(l=d),s.push({line:h,comment:y,token:c,indent:d,empty:m,single:!1})}u=h.to+1}if(l<1e9)for(let u=o;u<s.length;u++)s[u].indent<s[u].line.text.length&&(s[u].indent=l);s.length==o+1&&(s[o].single=!0)}}if(n!=2&&s.some(a=>a.comment<0&&(!a.empty||a.single))){let a=[];for(let{line:o,token:l,indent:c,empty:u,single:h}of s)(h||!u)&&a.push({from:o.from+c,insert:l+" "});let i=e.changes(a);return{changes:i,selection:e.selection.map(i,1)}}else if(n!=1&&s.some(a=>a.comment>=0)){let a=[];for(let{line:i,comment:o,token:l}of s)if(o>=0){let c=i.from+o,u=c+l.length;i.text[u-i.from]==" "&&u++,a.push({from:c,to:u})}return{changes:a}}return null}const NS=Dc.define(),D2e=Dc.define(),T2e=_t.define(),mU=_t.define({combine(n){return Tc(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(s,r)=>e(s,r)||t(s,r)})}}),fU=Us.define({create(){return Pl.empty},update(n,e){let t=e.state.facet(mU),s=e.annotation(NS);if(s){let l=si.fromTransaction(e,s.selection),c=s.side,u=c==0?n.undone:n.done;return l?u=t1(u,u.length,t.minDepth,l):u=vU(u,e.startState.selection),new Pl(c==0?s.rest:u,c==0?u:s.rest)}let r=e.annotation(D2e);if((r=="full"||r=="before")&&(n=n.isolate()),e.annotation(Sa.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let a=si.fromTransaction(e),i=e.annotation(Sa.time),o=e.annotation(Sa.userEvent);return a?n=n.addChanges(a,i,o,t,e):e.selection&&(n=n.addSelection(e.startState.selection,i,o,t.newGroupDelay)),(r=="full"||r=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Pl(n.done.map(si.fromJSON),n.undone.map(si.fromJSON))}});function gU(n={}){return[fU,mU.of(n),vt.domEventHandlers({beforeinput(e,t){let s=e.inputType=="historyUndo"?Zv:e.inputType=="historyRedo"?Gd:null;return s?(e.preventDefault(),s(t)):!1}})]}function Vv(n,e){return function({state:t,dispatch:s}){if(!e&&t.readOnly)return!1;let r=t.field(fU,!1);if(!r)return!1;let a=r.pop(n,t,e);return a?(s(a),!0):!1}}const Zv=Vv(0,!1),Gd=Vv(1,!1),bU=Vv(0,!0),B2e=Vv(1,!0);class si{constructor(e,t,s,r,a){this.changes=e,this.effects=t,this.mapped=s,this.startSelection=r,this.selectionsAfter=a}setSelAfter(e){return new si(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,s;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(s=this.startSelection)===null||s===void 0?void 0:s.toJSON(),selectionsAfter:this.selectionsAfter.map(r=>r.toJSON())}}static fromJSON(e){return new si(e.changes&&kr.fromJSON(e.changes),[],e.mapped&&Dl.fromJSON(e.mapped),e.startSelection&&Ve.fromJSON(e.startSelection),e.selectionsAfter.map(Ve.fromJSON))}static fromTransaction(e,t){let s=io;for(let r of e.startState.facet(T2e)){let a=r(e);a.length&&(s=s.concat(a))}return!s.length&&e.changes.empty?null:new si(e.changes.invert(e.startState.doc),s,void 0,t||e.startState.selection,io)}static selection(e){return new si(void 0,io,void 0,void 0,e)}}function t1(n,e,t,s){let r=e+1>t+20?e-t-1:0,a=n.slice(r,e);return a.push(s),a}function F2e(n,e){let t=[],s=!1;return n.iterChangedRanges((r,a)=>t.push(r,a)),e.iterChangedRanges((r,a,i,o)=>{for(let l=0;l<t.length;){let c=t[l++],u=t[l++];o>=c&&i<=u&&(s=!0)}}),s}function $2e(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,s)=>t.empty!=e.ranges[s].empty).length===0}function yU(n,e){return n.length?e.length?n.concat(e):n:e}const io=[],N2e=200;function vU(n,e){if(n.length){let t=n[n.length-1],s=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-N2e));return s.length&&s[s.length-1].eq(e)?n:(s.push(e),t1(n,n.length-1,1e9,t.setSelAfter(s)))}else return[si.selection([e])]}function _2e(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function hx(n,e){if(!n.length)return n;let t=n.length,s=io;for(;t;){let r=R2e(n[t-1],e,s);if(r.changes&&!r.changes.empty||r.effects.length){let a=n.slice(0,t);return a[t-1]=r,a}else e=r.mapped,t--,s=r.selectionsAfter}return s.length?[si.selection(s)]:io}function R2e(n,e,t){let s=yU(n.selectionsAfter.length?n.selectionsAfter.map(o=>o.map(e)):io,t);if(!n.changes)return si.selection(s);let r=n.changes.map(e),a=e.mapDesc(n.changes,!0),i=n.mapped?n.mapped.composeDesc(a):a;return new si(r,ln.mapEffects(n.effects,e),i,n.startSelection.map(a),s)}const I2e=/^(input\.type|delete)($|\.)/;class Pl{constructor(e,t,s=0,r=void 0){this.done=e,this.undone=t,this.prevTime=s,this.prevUserEvent=r}isolate(){return this.prevTime?new Pl(this.done,this.undone):this}addChanges(e,t,s,r,a){let i=this.done,o=i[i.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!s||I2e.test(s))&&(!o.selectionsAfter.length&&t-this.prevTime<r.newGroupDelay&&r.joinToEvent(a,F2e(o.changes,e.changes))||s=="input.type.compose")?i=t1(i,i.length-1,r.minDepth,new si(e.changes.compose(o.changes),yU(ln.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,io)):i=t1(i,i.length,r.minDepth,e),new Pl(i,io,t,s)}addSelection(e,t,s,r){let a=this.done.length?this.done[this.done.length-1].selectionsAfter:io;return a.length>0&&t-this.prevTime<r&&s==this.prevUserEvent&&s&&/^select($|\.)/.test(s)&&$2e(a[a.length-1],e)?this:new Pl(vU(this.done,e),this.undone,t,s)}addMapping(e){return new Pl(hx(this.done,e),hx(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,s){let r=e==0?this.done:this.undone;if(r.length==0)return null;let a=r[r.length-1],i=a.selectionsAfter[0]||t.selection;if(s&&a.selectionsAfter.length)return t.update({selection:a.selectionsAfter[a.selectionsAfter.length-1],annotations:NS.of({side:e,rest:_2e(r),selection:i}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(a.changes){let o=r.length==1?io:r.slice(0,r.length-1);return a.mapped&&(o=hx(o,a.mapped)),t.update({changes:a.changes,selection:a.startSelection,effects:a.effects,annotations:NS.of({side:e,rest:o,selection:i}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Pl.empty=new Pl(io,io);const OU=[{key:"Mod-z",run:Zv,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Gd,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Gd,preventDefault:!0},{key:"Mod-u",run:bU,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:B2e,preventDefault:!0}];function xp(n,e){return Ve.create(n.ranges.map(e),n.mainIndex)}function zl(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function tl({state:n,dispatch:e},t){let s=xp(n.selection,t);return s.eq(n.selection,!0)?!1:(e(zl(n,s)),!0)}function zv(n,e){return Ve.cursor(e?n.to:n.from)}function CE(n,e){return tl(n,t=>t.empty?n.moveByChar(t,e):zv(t,e))}function ha(n){return n.textDirectionAt(n.state.selection.main.head)==Ss.LTR}const Mf=n=>CE(n,!ha(n)),n1=n=>CE(n,ha(n)),L2e=n=>CE(n,!1);function wU(n,e){return tl(n,t=>t.empty?n.moveByGroup(t,e):zv(t,e))}const xU=n=>wU(n,!ha(n)),kU=n=>wU(n,ha(n));function Q2e(n,e,t){if(e.type.prop(t))return!0;let s=e.to-e.from;return s&&(s>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function qv(n,e,t){let s=Wr(n).resolveInner(e.head),r=t?jn.closedBy:jn.openedBy;for(let l=e.head;;){let c=t?s.childAfter(l):s.childBefore(l);if(!c)break;Q2e(n,c,r)?s=c:l=t?c.to:c.from}let a=s.type.prop(r),i,o;return a&&(i=t?ro(n,s.from,1):ro(n,s.to,-1))&&i.matched?o=t?i.end.to:i.end.from:o=t?s.to:s.from,Ve.cursor(o,t?-1:1)}const j2e=n=>tl(n,e=>qv(n.state,e,!ha(n))),V2e=n=>tl(n,e=>qv(n.state,e,ha(n)));function SU(n,e){return tl(n,t=>{if(!t.empty)return zv(t,e);let s=n.moveVertically(t,e);return s.head!=t.head?s:n.moveToLineBoundary(t,e)})}const s1=n=>SU(n,!1),r1=n=>SU(n,!0);function CU(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,s=0,r;if(e){for(let a of n.state.facet(vt.scrollMargins)){let i=a(n);i!=null&&i.top&&(t=Math.max(i==null?void 0:i.top,t)),i!=null&&i.bottom&&(s=Math.max(i==null?void 0:i.bottom,s))}r=n.scrollDOM.clientHeight-t-s}else r=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:s,selfScroll:e,height:Math.max(n.defaultLineHeight,r-5)}}function PU(n,e){let t=CU(n),{state:s}=n,r=xp(s.selection,i=>i.empty?n.moveVertically(i,e,t.height):zv(i,e));if(r.eq(s.selection))return!1;let a;if(t.selfScroll){let i=n.coordsAtPos(s.selection.main.head),o=n.scrollDOM.getBoundingClientRect(),l=o.top+t.marginTop,c=o.bottom-t.marginBottom;i&&i.top>l&&i.bottom<c&&(a=vt.scrollIntoView(r.main.head,{y:"start",yMargin:i.top-l}))}return n.dispatch(zl(s,r),{effects:a}),!0}const Qm=n=>PU(n,!1),vd=n=>PU(n,!0);function Mu(n,e,t){let s=n.lineBlockAt(e.head),r=n.moveToLineBoundary(e,t);if(r.head==e.head&&r.head!=(t?s.to:s.from)&&(r=n.moveToLineBoundary(e,t,!1)),!t&&r.head==s.from&&s.length){let a=/^\s*/.exec(n.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;a&&e.head!=s.from+a&&(r=Ve.cursor(s.from+a))}return r}const a1=n=>tl(n,e=>Mu(n,e,!0)),i1=n=>tl(n,e=>Mu(n,e,!1)),Z2e=n=>tl(n,e=>Mu(n,e,!ha(n))),z2e=n=>tl(n,e=>Mu(n,e,ha(n))),AU=n=>tl(n,e=>Ve.cursor(n.lineBlockAt(e.head).from,1)),EU=n=>tl(n,e=>Ve.cursor(n.lineBlockAt(e.head).to,-1));function q2e(n,e,t){let s=!1,r=xp(n.selection,a=>{let i=ro(n,a.head,-1)||ro(n,a.head,1)||a.head>0&&ro(n,a.head-1,1)||a.head<n.doc.length&&ro(n,a.head+1,-1);if(!i||!i.end)return a;s=!0;let o=i.start.from==a.head?i.end.to:i.end.from;return Ve.cursor(o)});return s?(e(zl(n,r)),!0):!1}const MU=({state:n,dispatch:e})=>q2e(n,e);function vo(n,e){let t=xp(n.state.selection,s=>{let r=e(s);return Ve.range(s.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(zl(n.state,t)),!0)}function DU(n,e){return vo(n,t=>n.moveByChar(t,e))}const o1=n=>DU(n,!ha(n)),l1=n=>DU(n,ha(n));function TU(n,e){return vo(n,t=>n.moveByGroup(t,e))}const BU=n=>TU(n,!ha(n)),FU=n=>TU(n,ha(n)),U2e=n=>vo(n,e=>qv(n.state,e,!ha(n))),W2e=n=>vo(n,e=>qv(n.state,e,ha(n)));function $U(n,e){return vo(n,t=>n.moveVertically(t,e))}const c1=n=>$U(n,!1),u1=n=>$U(n,!0);function NU(n,e){return vo(n,t=>n.moveVertically(t,e,CU(n).height))}const h1=n=>NU(n,!1),d1=n=>NU(n,!0),_S=n=>vo(n,e=>Mu(n,e,!0)),RS=n=>vo(n,e=>Mu(n,e,!1)),G2e=n=>vo(n,e=>Mu(n,e,!ha(n))),X2e=n=>vo(n,e=>Mu(n,e,ha(n))),_U=n=>vo(n,e=>Ve.cursor(n.lineBlockAt(e.head).from)),RU=n=>vo(n,e=>Ve.cursor(n.lineBlockAt(e.head).to)),p1=({state:n,dispatch:e})=>(e(zl(n,{anchor:0})),!0),m1=({state:n,dispatch:e})=>(e(zl(n,{anchor:n.doc.length})),!0),f1=({state:n,dispatch:e})=>(e(zl(n,{anchor:n.selection.main.anchor,head:0})),!0),g1=({state:n,dispatch:e})=>(e(zl(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),IU=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),LU=({state:n,dispatch:e})=>{let t=Uv(n).map(({from:s,to:r})=>Ve.range(s,Math.min(r+1,n.doc.length)));return e(n.update({selection:Ve.create(t),userEvent:"select"})),!0},H2e=({state:n,dispatch:e})=>{let t=xp(n.selection,s=>{let r=Wr(n),a=r.resolveStack(s.from,1);if(s.empty){let i=r.resolveStack(s.from,-1);i.node.from>=a.node.from&&i.node.to<=a.node.to&&(a=i)}for(let i=a;i;i=i.next){let{node:o}=i;if((o.from<s.from&&o.to>=s.to||o.to>s.to&&o.from<=s.from)&&i.next)return Ve.range(o.to,o.from)}return s});return t.eq(n.selection)?!1:(e(zl(n,t)),!0)},Y2e=({state:n,dispatch:e})=>{let t=n.selection,s=null;return t.ranges.length>1?s=Ve.create([t.main]):t.main.empty||(s=Ve.create([Ve.cursor(t.main.head)])),s?(e(zl(n,s)),!0):!1};function kp(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:s}=n,r=s.changeByRange(a=>{let{from:i,to:o}=a;if(i==o){let l=e(a);l<i?(t="delete.backward",l=O0(n,l,!1)):l>i&&(t="delete.forward",l=O0(n,l,!0)),i=Math.min(i,l),o=Math.max(o,l)}else i=O0(n,i,!1),o=O0(n,o,!0);return i==o?{range:a}:{changes:{from:i,to:o},range:Ve.cursor(i,i<a.head?-1:1)}});return r.changes.empty?!1:(n.dispatch(s.update(r,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?vt.announce.of(s.phrase("Selection deleted")):void 0})),!0)}function O0(n,e,t){if(n instanceof vt)for(let s of n.state.facet(vt.atomicRanges).map(r=>r(n)))s.between(e,e,(r,a)=>{r<e&&a>e&&(e=t?a:r)});return e}const QU=(n,e,t)=>kp(n,s=>{let r=s.from,{state:a}=n,i=a.doc.lineAt(r),o,l;if(t&&!e&&r>i.from&&r<i.from+200&&!/[^ \t]/.test(o=i.text.slice(0,r-i.from))){if(o[o.length-1]=="	")return r-1;let c=Op(o,a.tabSize),u=c%Yy(a)||Yy(a);for(let h=0;h<u&&o[o.length-1-h]==" ";h++)r--;l=r}else l=qr(i.text,r-i.from,e,e)+i.from,l==r&&i.number!=(e?a.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(i.text.slice(l-i.from,r-i.from))&&(l=qr(i.text,l-i.from,!1,!1)+i.from);return l}),Od=n=>QU(n,!1,!0),b1=n=>QU(n,!0,!1),jU=(n,e)=>kp(n,t=>{let s=t.head,{state:r}=n,a=r.doc.lineAt(s),i=r.charCategorizer(s);for(let o=null;;){if(s==(e?a.to:a.from)){s==t.head&&a.number!=(e?r.doc.lines:1)&&(s+=e?1:-1);break}let l=qr(a.text,s-a.from,e)+a.from,c=a.text.slice(Math.min(s,l)-a.from,Math.max(s,l)-a.from),u=i(c);if(o!=null&&u!=o)break;(c!=" "||s!=t.head)&&(o=u),s=l}return s}),y1=n=>jU(n,!1),VU=n=>jU(n,!0),IS=n=>kp(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),K2e=n=>kp(n,e=>{let t=n.lineBlockAt(e.head).from;return e.head>t?t:Math.max(0,e.head-1)}),J2e=n=>kp(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),eSe=n=>kp(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),PE=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:ts.of(["",""])},range:Ve.cursor(s.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},ZU=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(s=>{if(!s.empty||s.from==0||s.from==n.doc.length)return{range:s};let r=s.from,a=n.doc.lineAt(r),i=r==a.from?r-1:qr(a.text,r-a.from,!1)+a.from,o=r==a.to?r+1:qr(a.text,r-a.from,!0)+a.from;return{changes:{from:i,to:o,insert:n.doc.slice(r,o).append(n.doc.slice(i,r))},range:Ve.cursor(o)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Uv(n){let e=[],t=-1;for(let s of n.selection.ranges){let r=n.doc.lineAt(s.from),a=n.doc.lineAt(s.to);if(!s.empty&&s.to==a.from&&(a=n.doc.lineAt(s.to-1)),t>=r.number){let i=e[e.length-1];i.to=a.to,i.ranges.push(s)}else e.push({from:r.from,to:a.to,ranges:[s]});t=a.number+1}return e}function zU(n,e,t){if(n.readOnly)return!1;let s=[],r=[];for(let a of Uv(n)){if(t?a.to==n.doc.length:a.from==0)continue;let i=n.doc.lineAt(t?a.to+1:a.from-1),o=i.length+1;if(t){s.push({from:a.to,to:i.to},{from:a.from,insert:i.text+n.lineBreak});for(let l of a.ranges)r.push(Ve.range(Math.min(n.doc.length,l.anchor+o),Math.min(n.doc.length,l.head+o)))}else{s.push({from:i.from,to:a.from},{from:a.to,insert:n.lineBreak+i.text});for(let l of a.ranges)r.push(Ve.range(l.anchor-o,l.head-o))}}return s.length?(e(n.update({changes:s,scrollIntoView:!0,selection:Ve.create(r,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const qU=({state:n,dispatch:e})=>zU(n,e,!1),UU=({state:n,dispatch:e})=>zU(n,e,!0);function WU(n,e,t){if(n.readOnly)return!1;let s=[];for(let r of Uv(n))t?s.push({from:r.from,insert:n.doc.slice(r.from,r.to)+n.lineBreak}):s.push({from:r.to,insert:n.lineBreak+n.doc.slice(r.from,r.to)});return e(n.update({changes:s,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const GU=({state:n,dispatch:e})=>WU(n,e,!1),XU=({state:n,dispatch:e})=>WU(n,e,!0),HU=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Uv(e).map(({from:r,to:a})=>(r>0?r--:a<e.doc.length&&a++,{from:r,to:a}))),s=xp(e.selection,r=>{let a;if(n.lineWrapping){let i=n.lineBlockAt(r.head),o=n.coordsAtPos(r.head,r.assoc||1);o&&(a=i.bottom+n.documentTop-o.bottom+n.defaultLineHeight/2)}return n.moveVertically(r,!0,a)}).map(t);return n.dispatch({changes:t,selection:s,scrollIntoView:!0,userEvent:"delete.line"}),!0};function tSe(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Wr(n).resolveInner(e),s=t.childBefore(e),r=t.childAfter(e),a;return s&&r&&s.to<=e&&r.from>=e&&(a=s.type.prop(jn.closedBy))&&a.indexOf(r.name)>-1&&n.doc.lineAt(s.to).from==n.doc.lineAt(r.from).from&&!/\S/.test(n.sliceDoc(s.to,r.from))?{from:s.to,to:r.from}:null}const Df=YU(!1),nSe=YU(!0);function YU(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let s=e.changeByRange(r=>{let{from:a,to:i}=r,o=e.doc.lineAt(a),l=!n&&a==i&&tSe(e,a);n&&(a=i=(i<=o.to?o:e.doc.lineAt(i)).to);let c=new Iv(e,{simulateBreak:a,simulateDoubleBreak:!!l}),u=Fq(c,a);for(u==null&&(u=Op(/^\s*/.exec(e.doc.lineAt(a).text)[0],e.tabSize));i<o.to&&/\s/.test(o.text[i-o.from]);)i++;l?{from:a,to:i}=l:a>o.from&&a<o.from+100&&!/\S/.test(o.text.slice(0,a))&&(a=o.from);let h=["",Ky(e,u)];return l&&h.push(Ky(e,c.lineIndent(o.from,-1))),{changes:{from:a,to:i,insert:ts.of(h)},range:Ve.cursor(a+1+h[1].length)}});return t(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function AE(n,e){let t=-1;return n.changeByRange(s=>{let r=[];for(let i=s.from;i<=s.to;){let o=n.doc.lineAt(i);o.number>t&&(s.empty||s.to>o.from)&&(e(o,r,s),t=o.number),i=o.to+1}let a=n.changes(r);return{changes:r,range:Ve.range(a.mapPos(s.anchor,1),a.mapPos(s.head,1))}})}const KU=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),s=new Iv(n,{overrideIndentation:a=>t[a]??-1}),r=AE(n,(a,i,o)=>{let l=Fq(s,a.from);if(l==null)return;/\S/.test(a.text)||(l=0);let c=/^\s*/.exec(a.text)[0],u=Ky(n,l);(c!=u||o.from<a.from+c.length)&&(t[a.from]=l,i.push({from:a.from,to:a.from+c.length,insert:u}))});return r.changes.empty||e(n.update(r,{userEvent:"indent"})),!0},Tf=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(AE(n,(t,s)=>{s.push({from:t.from,insert:n.facet(Wd)})}),{userEvent:"input.indent"})),!0),Bf=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(AE(n,(t,s)=>{let r=/^\s*/.exec(t.text)[0];if(!r)return;let a=Op(r,n.tabSize),i=0,o=Ky(n,Math.max(0,a-Yy(n)));for(;i<r.length&&i<o.length&&r.charCodeAt(i)==o.charCodeAt(i);)i++;s.push({from:t.from+i,to:t.from+r.length,insert:o.slice(i)})}),{userEvent:"delete.dedent"})),!0),sSe=n=>(n.setTabFocusMode(),!0),rSe=[{key:"Ctrl-b",run:Mf,shift:o1,preventDefault:!0},{key:"Ctrl-f",run:n1,shift:l1},{key:"Ctrl-p",run:s1,shift:c1},{key:"Ctrl-n",run:r1,shift:u1},{key:"Ctrl-a",run:AU,shift:_U},{key:"Ctrl-e",run:EU,shift:RU},{key:"Ctrl-d",run:b1},{key:"Ctrl-h",run:Od},{key:"Ctrl-k",run:IS},{key:"Ctrl-Alt-h",run:y1},{key:"Ctrl-o",run:PE},{key:"Ctrl-t",run:ZU},{key:"Ctrl-v",run:vd}],aSe=[{key:"ArrowLeft",run:Mf,shift:o1,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:xU,shift:BU,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Z2e,shift:G2e,preventDefault:!0},{key:"ArrowRight",run:n1,shift:l1,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:kU,shift:FU,preventDefault:!0},{mac:"Cmd-ArrowRight",run:z2e,shift:X2e,preventDefault:!0},{key:"ArrowUp",run:s1,shift:c1,preventDefault:!0},{mac:"Cmd-ArrowUp",run:p1,shift:f1},{mac:"Ctrl-ArrowUp",run:Qm,shift:h1},{key:"ArrowDown",run:r1,shift:u1,preventDefault:!0},{mac:"Cmd-ArrowDown",run:m1,shift:g1},{mac:"Ctrl-ArrowDown",run:vd,shift:d1},{key:"PageUp",run:Qm,shift:h1},{key:"PageDown",run:vd,shift:d1},{key:"Home",run:i1,shift:RS,preventDefault:!0},{key:"Mod-Home",run:p1,shift:f1},{key:"End",run:a1,shift:_S,preventDefault:!0},{key:"Mod-End",run:m1,shift:g1},{key:"Enter",run:Df,shift:Df},{key:"Mod-a",run:IU},{key:"Backspace",run:Od,shift:Od},{key:"Delete",run:b1},{key:"Mod-Backspace",mac:"Alt-Backspace",run:y1},{key:"Mod-Delete",mac:"Alt-Delete",run:VU},{mac:"Mod-Backspace",run:J2e},{mac:"Mod-Delete",run:eSe}].concat(rSe.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),EE=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:j2e,shift:U2e},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:V2e,shift:W2e},{key:"Alt-ArrowUp",run:qU},{key:"Shift-Alt-ArrowUp",run:GU},{key:"Alt-ArrowDown",run:UU},{key:"Shift-Alt-ArrowDown",run:XU},{key:"Escape",run:Y2e},{key:"Mod-Enter",run:nSe},{key:"Alt-l",mac:"Ctrl-l",run:LU},{key:"Mod-i",run:H2e,preventDefault:!0},{key:"Mod-[",run:Bf},{key:"Mod-]",run:Tf},{key:"Mod-Alt-\\",run:KU},{key:"Shift-Mod-k",run:HU},{key:"Shift-Mod-\\",run:MU},{key:"Mod-/",run:jv},{key:"Alt-A",run:xE},{key:"Ctrl-m",mac:"Shift-Alt-m",run:sSe}].concat(aSe),iSe={key:"Tab",run:Tf,shift:Bf};class v1{constructor(e,t,s,r,a,i,o,l,c,u=0,h){this.p=e,this.stack=t,this.state=s,this.reducePos=r,this.pos=a,this.score=i,this.buffer=o,this.bufferBase=l,this.curContext=c,this.lookAhead=u,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,s=0){let r=e.parser.context;return new v1(e,[],t,s,s,0,[],0,r?new q4(r,r.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let s=e>>19,r=e&65535,{parser:a}=this.p,i=this.reducePos<this.pos-25;i&&this.setLookAhead(this.pos);let o=a.dynamicPrecedence(r);if(o&&(this.score+=o),s==0){this.pushState(a.getGoto(this.state,r,!0),this.reducePos),r<a.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,i?8:4,!0),this.reduceContext(r,this.reducePos);return}let l=this.stack.length-(s-1)*3-(e&262144?6:0),c=l?this.stack[l-2]:this.p.ranges[0].from,u=this.reducePos-c;u>=2e3&&!(!((t=this.p.parser.nodeSet.types[r])===null||t===void 0)&&t.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=u):this.p.lastBigReductionSize<u&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=u));let h=l?this.stack[l-1]:0,d=this.bufferBase+this.buffer.length-h;if(r<a.minRepeatTerm||e&131072){let m=a.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,c,m,d+4,!0)}if(e&262144)this.state=this.stack[l];else{let m=this.stack[l-3];this.state=a.getGoto(m,r,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(r,c)}storeNode(e,t,s,r=4,a=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let i=this,o=this.buffer.length;if(o==0&&i.parent&&(o=i.bufferBase-i.parent.bufferBase,i=i.parent),o>0&&i.buffer[o-4]==0&&i.buffer[o-1]>-1){if(t==s)return;if(i.buffer[o-2]>=t){i.buffer[o-2]=s;return}}}if(!a||this.pos==s)this.buffer.push(e,t,s,r);else{let i=this.buffer.length;if(i>0&&this.buffer[i-4]!=0){let o=!1;for(let l=i;l>0&&this.buffer[l-2]>s;l-=4)if(this.buffer[l-1]>=0){o=!0;break}if(o)for(;i>0&&this.buffer[i-2]>s;)this.buffer[i]=this.buffer[i-4],this.buffer[i+1]=this.buffer[i-3],this.buffer[i+2]=this.buffer[i-2],this.buffer[i+3]=this.buffer[i-1],i-=4,r>4&&(r-=4)}this.buffer[i]=e,this.buffer[i+1]=t,this.buffer[i+2]=s,this.buffer[i+3]=r}}shift(e,t,s,r){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=r,this.shiftContext(t,s),t<=this.p.parser.maxNode&&this.buffer.push(t,s,r,4);else{let a=e,{parser:i}=this.p;(r>this.pos||t<=i.maxNode)&&(this.pos=r,i.stateFlag(a,1)||(this.reducePos=r)),this.pushState(a,s),this.shiftContext(t,s),t<=i.maxNode&&this.buffer.push(t,s,r,4)}}apply(e,t,s,r){e&65536?this.reduce(e):this.shift(e,t,s,r)}useNode(e,t){let s=this.p.reused.length-1;(s<0||this.p.reused[s]!=e)&&(this.p.reused.push(e),s++);let r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(s,r,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let s=e.buffer.slice(t),r=e.bufferBase+t;for(;e&&r==e.bufferBase;)e=e.parent;return new v1(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,s,r,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let s=e<=this.p.parser.maxNode;s&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,s?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new oSe(this);;){let s=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(s==0)return!1;if(!(s&65536))return!0;t.reduce(s)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let r=[];for(let a=0,i;a<t.length;a+=2)(i=t[a+1])!=this.state&&this.p.parser.hasAction(i,e)&&r.push(t[a],i);if(this.stack.length<120)for(let a=0;r.length<8&&a<t.length;a+=2){let i=t[a+1];r.some((o,l)=>l&1&&o==i)||r.push(t[a],i)}t=r}let s=[];for(let r=0;r<t.length&&s.length<4;r+=2){let a=t[r+1];if(a==this.state)continue;let i=this.split();i.pushState(a,this.pos),i.storeNode(0,i.pos,i.pos,4,!0),i.shiftContext(t[r],this.pos),i.reducePos=this.pos,i.score-=200,s.push(i)}return s}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let s=t>>19,r=t&65535,a=this.stack.length-s*3;if(a<0||e.getGoto(this.stack[a],r,!1)<0){let i=this.findForcedReduction();if(i==null)return!1;t=i}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],s=(r,a)=>{if(!t.includes(r))return t.push(r),e.allActions(r,i=>{if(!(i&393216))if(i&65536){let o=(i>>19)-a;if(o>1){let l=i&65535,c=this.stack.length-o*3;if(c>=0&&e.getGoto(this.stack[c],l,!1)>=0)return o<<19|65536|l}}else{let o=s(i,a+1);if(o!=null)return o}})};return s(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new q4(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class q4{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class oSe{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,s=e>>19;s==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(s-1)*3;let r=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=r}}class O1{constructor(e,t,s){this.stack=e,this.pos=t,this.index=s,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new O1(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new O1(this.stack,this.pos,this.index)}}function ym(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let s=0,r=0;s<n.length;){let a=0;for(;;){let i=n.charCodeAt(s++),o=!1;if(i==126){a=65535;break}i>=92&&i--,i>=34&&i--;let l=i-32;if(l>=46&&(l-=46,o=!0),a+=l,o)break;a*=46}t?t[r++]=a:t=new e(a)}return t}class bb{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const U4=new bb;class lSe{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=U4,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let s=this.range,r=this.rangeIndex,a=this.pos+e;for(;a<s.from;){if(!r)return null;let i=this.ranges[--r];a-=s.from-i.to,s=i}for(;t<0?a>s.to:a>=s.to;){if(r==this.ranges.length-1)return null;let i=this.ranges[++r];a+=i.from-s.to,s=i}return a}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,s,r;if(t>=0&&t<this.chunk.length)s=this.pos+e,r=this.chunk.charCodeAt(t);else{let a=this.resolveOffset(e,1);if(a==null)return-1;if(s=a,s>=this.chunk2Pos&&s<this.chunk2Pos+this.chunk2.length)r=this.chunk2.charCodeAt(s-this.chunk2Pos);else{let i=this.rangeIndex,o=this.range;for(;o.to<=s;)o=this.ranges[++i];this.chunk2=this.input.chunk(this.chunk2Pos=s),s+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-s)),r=this.chunk2.charCodeAt(0)}}return s>=this.token.lookAhead&&(this.token.lookAhead=s+1),r}acceptToken(e,t=0){let s=t?this.resolveOffset(t,-1):this.pos;if(s==null||s<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=s}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=U4,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let s="";for(let r of this.ranges){if(r.from>=t)break;r.to>e&&(s+=this.input.read(Math.max(r.from,e),Math.min(r.to,t)))}return s}}class wd{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:s}=t.p;JU(this.data,e,t,this.id,s.data,s.tokenPrecTable)}}wd.prototype.contextual=wd.prototype.fallback=wd.prototype.extend=!1;class LS{constructor(e,t,s){this.precTable=t,this.elseToken=s,this.data=typeof e=="string"?ym(e):e}token(e,t){let s=e.pos,r=0;for(;;){let a=e.next<0,i=e.resolveOffset(1,1);if(JU(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(a||r++,i==null)break;e.reset(i,e.token)}r&&(e.reset(s,e.token),e.acceptToken(this.elseToken,r))}}LS.prototype.contextual=wd.prototype.fallback=wd.prototype.extend=!1;class yg{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function JU(n,e,t,s,r,a){let i=0,o=1<<s,{dialect:l}=t.p.parser;e:for(;o&n[i];){let c=n[i+1];for(let m=i+3;m<c;m+=2)if((n[m+1]&o)>0){let y=n[m];if(l.allows(y)&&(e.token.value==-1||e.token.value==y||cSe(y,e.token.value,r,a))){e.acceptToken(y);break}}let u=e.next,h=0,d=n[i+2];if(e.next<0&&d>h&&n[c+d*3-3]==65535){i=n[c+d*3-1];continue e}for(;h<d;){let m=h+d>>1,y=c+m+(m<<1),O=n[y],S=n[y+1]||65536;if(u<O)d=m;else if(u>=S)h=m+1;else{i=n[y+2],e.advance();continue e}}break}}function W4(n,e,t){for(let s=e,r;(r=n[s])!=65535;s++)if(r==t)return s-e;return-1}function cSe(n,e,t,s){let r=W4(t,s,e);return r<0||W4(t,s,n)<r}const yi=typeof process<"u"&&xD&&/\bparse\b/.test(xD.LOG);let dx=null;function G4(n,e,t){let s=n.cursor(Sr.IncludeAnonymous);for(s.moveTo(e);;)if(!(t<0?s.childBefore(e):s.childAfter(e)))for(;;){if((t<0?s.to<e:s.from>e)&&!s.type.isError)return t<0?Math.max(0,Math.min(s.to-1,e-25)):Math.min(n.length,Math.max(s.from+1,e+25));if(t<0?s.prevSibling():s.nextSibling())break;if(!s.parent())return t<0?0:n.length}}class uSe{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?G4(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?G4(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let s=this.trees[t],r=this.index[t];if(r==s.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let a=s.children[r],i=this.start[t]+s.positions[r];if(i>e)return this.nextStart=i,null;if(a instanceof br){if(i==e){if(i<this.safeFrom)return null;let o=i+a.length;if(o<=this.safeTo){let l=a.prop(jn.lookAhead);if(!l||o+l<this.fragment.to)return a}}this.index[t]++,i+a.length>=Math.max(this.safeFrom,e)&&(this.trees.push(a),this.start.push(i),this.index.push(0))}else this.index[t]++,this.nextStart=i+a.length}}}class hSe{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(s=>new bb)}getActions(e){let t=0,s=null,{parser:r}=e.p,{tokenizers:a}=r,i=r.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,l=0;for(let c=0;c<a.length;c++){if(!(1<<c&i))continue;let u=a[c],h=this.tokens[c];if(!(s&&!u.fallback)&&((u.contextual||h.start!=e.pos||h.mask!=i||h.context!=o)&&(this.updateCachedToken(h,u,e),h.mask=i,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let d=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!u.extend&&(s=h,t>d))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!s&&e.pos==this.stream.end&&(s=new bb,s.value=e.p.parser.eofTerm,s.start=s.end=e.pos,t=this.addActions(e,s.value,s.end,t)),this.mainToken=s,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new bb,{pos:s,p:r}=e;return t.start=s,t.end=Math.min(s+1,r.stream.end),t.value=s==r.stream.end?r.parser.eofTerm:0,t}updateCachedToken(e,t,s){let r=this.stream.clipPos(s.pos);if(t.token(this.stream.reset(r,e),s),e.value>-1){let{parser:a}=s.p;for(let i=0;i<a.specialized.length;i++)if(a.specialized[i]==e.value){let o=a.specializers[i](this.stream.read(e.start,e.end),s);if(o>=0&&s.p.parser.dialect.allows(o>>1)){o&1?e.extended=o>>1:e.value=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(r+1)}putAction(e,t,s,r){for(let a=0;a<r;a+=3)if(this.actions[a]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=s,r}addActions(e,t,s,r){let{state:a}=e,{parser:i}=e.p,{data:o}=i;for(let l=0;l<2;l++)for(let c=i.stateSlot(a,l?2:1);;c+=3){if(o[c]==65535)if(o[c+1]==1)c=ic(o,c+2);else{r==0&&o[c+1]==2&&(r=this.putAction(ic(o,c+2),t,s,r));break}o[c]==t&&(r=this.putAction(ic(o,c+1),t,s,r))}return r}}class dSe{constructor(e,t,s,r){this.parser=e,this.input=t,this.ranges=r,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new lSe(t,r),this.tokens=new hSe(e,this.stream),this.topTerm=e.top[1];let{from:a}=r[0];this.stacks=[v1.start(this,e.top[0],a)],this.fragments=s.length&&this.stream.end-a>e.bufferLength*4?new uSe(s,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,s=this.stacks=[],r,a;if(this.bigReductionCount>300&&e.length==1){let[i]=e;for(;i.forceReduce()&&i.stack.length&&i.stack[i.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let i=0;i<e.length;i++){let o=e[i];for(;;){if(this.tokens.mainToken=null,o.pos>t)s.push(o);else{if(this.advanceStack(o,s,e))continue;{r||(r=[],a=[]),r.push(o);let l=this.tokens.getMainToken(o);a.push(l.value,l.end)}}break}}if(!s.length){let i=r&&fSe(r);if(i)return yi&&console.log("Finish with "+this.stackID(i)),this.stackToTree(i);if(this.parser.strict)throw yi&&r&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&r){let i=this.stoppedAt!=null&&r[0].pos>this.stoppedAt?r[0]:this.runRecovery(r,a,s);if(i)return yi&&console.log("Force-finish "+this.stackID(i)),this.stackToTree(i.forceAll())}if(this.recovering){let i=this.recovering==1?1:this.recovering*3;if(s.length>i)for(s.sort((o,l)=>l.score-o.score);s.length>i;)s.pop();s.some(o=>o.reducePos>t)&&this.recovering--}else if(s.length>1){e:for(let i=0;i<s.length-1;i++){let o=s[i];for(let l=i+1;l<s.length;l++){let c=s[l];if(o.sameState(c)||o.buffer.length>500&&c.buffer.length>500)if((o.score-c.score||o.buffer.length-c.buffer.length)>0)s.splice(l--,1);else{s.splice(i--,1);continue e}}}s.length>12&&s.splice(12,s.length-12)}this.minStackPos=s[0].pos;for(let i=1;i<s.length;i++)s[i].pos<this.minStackPos&&(this.minStackPos=s[i].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,s){let r=e.pos,{parser:a}=this,i=yi?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&r>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let c=e.curContext&&e.curContext.tracker.strict,u=c?e.curContext.hash:0;for(let h=this.fragments.nodeAt(r);h;){let d=this.parser.nodeSet.types[h.type.id]==h.type?a.getGoto(e.state,h.type.id):-1;if(d>-1&&h.length&&(!c||(h.prop(jn.contextHash)||0)==u))return e.useNode(h,d),yi&&console.log(i+this.stackID(e)+` (via reuse of ${a.getName(h.type.id)})`),!0;if(!(h instanceof br)||h.children.length==0||h.positions[0]>0)break;let m=h.children[0];if(m instanceof br&&h.positions[0]==0)h=m;else break}}let o=a.stateSlot(e.state,4);if(o>0)return e.reduce(o),yi&&console.log(i+this.stackID(e)+` (via always-reduce ${a.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let c=0;c<l.length;){let u=l[c++],h=l[c++],d=l[c++],m=c==l.length||!s,y=m?e:e.split(),O=this.tokens.mainToken;if(y.apply(u,h,O?O.start:y.pos,d),yi&&console.log(i+this.stackID(y)+` (via ${u&65536?`reduce of ${a.getName(u&65535)}`:"shift"} for ${a.getName(h)} @ ${r}${y==e?"":", split"})`),m)return!0;y.pos>r?t.push(y):s.push(y)}return!1}advanceFully(e,t){let s=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>s)return X4(e,t),!0}}runRecovery(e,t,s){let r=null,a=!1;for(let i=0;i<e.length;i++){let o=e[i],l=t[i<<1],c=t[(i<<1)+1],u=yi?this.stackID(o)+" -> ":"";if(o.deadEnd&&(a||(a=!0,o.restart(),yi&&console.log(u+this.stackID(o)+" (restarted)"),this.advanceFully(o,s))))continue;let h=o.split(),d=u;for(let m=0;h.forceReduce()&&m<10&&(yi&&console.log(d+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,s));m++)yi&&(d=this.stackID(h)+" -> ");for(let m of o.recoverByInsert(l))yi&&console.log(u+this.stackID(m)+" (via recover-insert)"),this.advanceFully(m,s);this.stream.end>o.pos?(c==o.pos&&(c++,l=0),o.recoverByDelete(l,c),yi&&console.log(u+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),X4(o,s)):(!r||r.score<o.score)&&(r=o)}return r}stackToTree(e){return e.close(),br.build({buffer:O1.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(dx||(dx=new WeakMap)).get(e);return t||dx.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function X4(n,e){for(let t=0;t<e.length;t++){let s=e[t];if(s.pos==n.pos&&s.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class pSe{constructor(e,t,s){this.source=e,this.flags=t,this.disabled=s}allows(e){return!this.disabled||this.disabled[e]==0}}const px=n=>n;class mSe{constructor(e){this.start=e.start,this.shift=e.shift||px,this.reduce=e.reduce||px,this.reuse=e.reuse||px,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class w1 extends Pq{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let o=0;o<e.repeatNodeCount;o++)t.push("");let s=Object.keys(e.topRules).map(o=>e.topRules[o][1]),r=[];for(let o=0;o<t.length;o++)r.push([]);function a(o,l,c){r[o].push([l,l.deserialize(String(c))])}if(e.nodeProps)for(let o of e.nodeProps){let l=o[0];typeof l=="string"&&(l=jn[l]);for(let c=1;c<o.length;){let u=o[c++];if(u>=0)a(u,l,o[c++]);else{let h=o[c+-u];for(let d=-u;d>0;d--)a(o[c++],l,h);c++}}}this.nodeSet=new oE(t.map((o,l)=>ci.define({name:l>=this.minRepeatTerm?void 0:o,id:l,props:r[l],top:s.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=xq;let i=ym(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(H4),this.states=ym(e.states,Uint32Array),this.data=ym(e.stateData),this.goto=ym(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new wd(i,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,s){let r=new dSe(this,e,t,s);for(let a of this.wrappers)r=a(r,e,t,s);return r}getGoto(e,t,s=!1){let r=this.goto;if(t>=r[0])return-1;for(let a=r[t+1];;){let i=r[a++],o=i&1,l=r[a++];if(o&&s)return l;for(let c=a+(i>>1);a<c;a++)if(r[a]==e)return l;if(o)return-1}}hasAction(e,t){let s=this.data;for(let r=0;r<2;r++)for(let a=this.stateSlot(e,r?2:1),i;;a+=3){if((i=s[a])==65535)if(s[a+1]==1)i=s[a=ic(s,a+2)];else{if(s[a+1]==2)return ic(s,a+2);break}if(i==t||i==0)return ic(s,a+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,s=>s==t?!0:null)}allActions(e,t){let s=this.stateSlot(e,4),r=s?t(s):void 0;for(let a=this.stateSlot(e,1);r==null;a+=3){if(this.data[a]==65535)if(this.data[a+1]==1)a=ic(this.data,a+2);else break;r=t(ic(this.data,a+1))}return r}nextStates(e){let t=[];for(let s=this.stateSlot(e,1);;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=ic(this.data,s+2);else break;if(!(this.data[s+2]&1)){let r=this.data[s+1];t.some((a,i)=>i&1&&a==r)||t.push(this.data[s],r)}}return t}configure(e){let t=Object.assign(Object.create(w1.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let s=this.topRules[e.top];if(!s)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=s}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(s=>{let r=e.tokenizers.find(a=>a.from==s);return r?r.to:s})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((s,r)=>{let a=e.specializers.find(o=>o.from==s.external);if(!a)return s;let i=Object.assign(Object.assign({},s),{external:a.to});return t.specializers[r]=H4(i),i})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),s=t.map(()=>!1);if(e)for(let a of e.split(" ")){let i=t.indexOf(a);i>=0&&(s[i]=!0)}let r=null;for(let a=0;a<t.length;a++)if(!s[a])for(let i=this.dialects[t[a]],o;(o=this.data[i++])!=65535;)(r||(r=new Uint8Array(this.maxTerm+1)))[o]=1;return new pSe(e,s,r)}static deserialize(e){return new w1(e)}}function ic(n,e){return n[e]|n[e+1]<<16}function fSe(n){let e=null;for(let t of n){let s=t.p.stoppedAt;(t.pos==t.p.stream.end||s!=null&&t.pos>s)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function H4(n){if(n.external){let e=n.extend?1:0;return(t,s)=>n.external(t,s)<<1|e}return n.get}const gSe=314,bSe=315,Y4=1,ySe=2,vSe=3,OSe=4,wSe=316,xSe=318,kSe=319,SSe=5,CSe=6,PSe=0,QS=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],eW=125,ASe=59,jS=47,ESe=42,MSe=43,DSe=45,TSe=60,BSe=44,FSe=63,$Se=46,NSe=91,_Se=new mSe({start:!1,shift(n,e){return e==SSe||e==CSe||e==xSe?n:e==kSe},strict:!1}),RSe=new yg((n,e)=>{let{next:t}=n;(t==eW||t==-1||e.context)&&n.acceptToken(wSe)},{contextual:!0,fallback:!0}),ISe=new yg((n,e)=>{let{next:t}=n,s;QS.indexOf(t)>-1||t==jS&&((s=n.peek(1))==jS||s==ESe)||t!=eW&&t!=ASe&&t!=-1&&!e.context&&n.acceptToken(gSe)},{contextual:!0}),LSe=new yg((n,e)=>{n.next==NSe&&!e.context&&n.acceptToken(bSe)},{contextual:!0}),QSe=new yg((n,e)=>{let{next:t}=n;if(t==MSe||t==DSe){if(n.advance(),t==n.next){n.advance();let s=!e.context&&e.canShift(Y4);n.acceptToken(s?Y4:ySe)}}else t==FSe&&n.peek(1)==$Se&&(n.advance(),n.advance(),(n.next<48||n.next>57)&&n.acceptToken(vSe))},{contextual:!0});function mx(n,e){return n>=65&&n<=90||n>=97&&n<=122||n==95||n>=192||!e&&n>=48&&n<=57}const jSe=new yg((n,e)=>{if(n.next!=TSe||!e.dialectEnabled(PSe)||(n.advance(),n.next==jS))return;let t=0;for(;QS.indexOf(n.next)>-1;)n.advance(),t++;if(mx(n.next,!0)){for(n.advance(),t++;mx(n.next,!1);)n.advance(),t++;for(;QS.indexOf(n.next)>-1;)n.advance(),t++;if(n.next==BSe)return;for(let s=0;;s++){if(s==7){if(!mx(n.next,!0))return;break}if(n.next!="extends".charCodeAt(s))break;n.advance(),t++}}n.acceptToken(OSe,-t)}),VSe=Aq({"get set async static":b.modifier,"for while do if else switch try catch finally return throw break continue default case":b.controlKeyword,"in of await yield void typeof delete instanceof":b.operatorKeyword,"let var const using function class extends":b.definitionKeyword,"import export from":b.moduleKeyword,"with debugger as new":b.keyword,TemplateString:b.special(b.string),super:b.atom,BooleanLiteral:b.bool,this:b.self,null:b.null,Star:b.modifier,VariableName:b.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":b.function(b.variableName),VariableDefinition:b.definition(b.variableName),Label:b.labelName,PropertyName:b.propertyName,PrivatePropertyName:b.special(b.propertyName),"CallExpression/MemberExpression/PropertyName":b.function(b.propertyName),"FunctionDeclaration/VariableDefinition":b.function(b.definition(b.variableName)),"ClassDeclaration/VariableDefinition":b.definition(b.className),"NewExpression/VariableName":b.className,PropertyDefinition:b.definition(b.propertyName),PrivatePropertyDefinition:b.definition(b.special(b.propertyName)),UpdateOp:b.updateOperator,"LineComment Hashbang":b.lineComment,BlockComment:b.blockComment,Number:b.number,String:b.string,Escape:b.escape,ArithOp:b.arithmeticOperator,LogicOp:b.logicOperator,BitOp:b.bitwiseOperator,CompareOp:b.compareOperator,RegExp:b.regexp,Equals:b.definitionOperator,Arrow:b.function(b.punctuation),": Spread":b.punctuation,"( )":b.paren,"[ ]":b.squareBracket,"{ }":b.brace,"InterpolationStart InterpolationEnd":b.special(b.brace),".":b.derefOperator,", ;":b.separator,"@":b.meta,TypeName:b.typeName,TypeDefinition:b.definition(b.typeName),"type enum interface implements namespace module declare":b.definitionKeyword,"abstract global Privacy readonly override":b.modifier,"is keyof unique infer asserts":b.operatorKeyword,JSXAttributeValue:b.attributeValue,JSXText:b.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":b.angleBracket,"JSXIdentifier JSXNameSpacedName":b.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":b.attributeName,"JSXBuiltin/JSXIdentifier":b.standard(b.tagName)}),ZSe={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,const:52,extends:56,this:60,true:68,false:68,null:80,void:84,typeof:88,super:104,new:138,delete:150,yield:159,await:163,class:168,public:231,private:231,protected:231,readonly:233,instanceof:252,satisfies:255,in:256,import:290,keyof:347,unique:351,infer:357,asserts:393,is:395,abstract:415,implements:417,type:419,let:422,var:424,using:427,interface:433,enum:437,namespace:443,module:445,declare:449,global:453,for:472,of:481,while:484,with:488,do:492,if:496,else:498,switch:502,case:508,try:514,catch:518,finally:522,return:526,throw:530,break:534,continue:538,debugger:542},zSe={__proto__:null,async:125,get:127,set:129,declare:191,public:193,private:193,protected:193,static:195,abstract:197,override:199,readonly:205,accessor:207,new:399},qSe={__proto__:null,"<":189},USe=w1.deserialize({version:14,states:"$EOQ%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#D_O.QQlO'#DeO.bQlO'#DpO%[QlO'#DxO0fQlO'#EQOOQ!0Lf'#EY'#EYO1PQ`O'#EVOOQO'#En'#EnOOQO'#Ij'#IjO1XQ`O'#GrO1dQ`O'#EmO1iQ`O'#EmO3hQ!0MxO'#JpO6[Q!0MxO'#JqO6uQ`O'#F[O6zQ,UO'#FsOOQ!0Lf'#Fe'#FeO7VO7dO'#FeO7eQMhO'#F{O9UQ`O'#FzOOQ!0Lf'#Jq'#JqOOQ!0Lb'#Jp'#JpO9ZQ`O'#GvOOQ['#K]'#K]O9fQ`O'#IWO9kQ!0LrO'#IXOOQ['#J^'#J^OOQ['#I]'#I]Q`QlOOQ`QlOOO9sQ!L^O'#DtO9zQlO'#D|O:RQlO'#EOO9aQ`O'#GrO:YQMhO'#CoO:hQ`O'#ElO:sQ`O'#EwO:xQMhO'#FdO;gQ`O'#GrOOQO'#K^'#K^O;lQ`O'#K^O;zQ`O'#GzO;zQ`O'#G{O;zQ`O'#G}O9aQ`O'#HQO<qQ`O'#HTO>YQ`O'#CeO>jQ`O'#HaO>rQ`O'#HgO>rQ`O'#HiO`QlO'#HkO>rQ`O'#HmO>rQ`O'#HpO>wQ`O'#HvO>|Q!0LsO'#H|O%[QlO'#IOO?XQ!0LsO'#IQO?dQ!0LsO'#ISO9kQ!0LrO'#IUO?oQ!0MxO'#CiO@qQpO'#DjQOQ`OOO%[QlO'#EOOAXQ`O'#ERO:YQMhO'#ElOAdQ`O'#ElOAoQ!bO'#FdOOQ['#Cg'#CgOOQ!0Lb'#Do'#DoOOQ!0Lb'#Jt'#JtO%[QlO'#JtOOQO'#Jw'#JwOOQO'#If'#IfOBoQpO'#EeOOQ!0Lb'#Ed'#EdOOQ!0Lb'#J{'#J{OCkQ!0MSO'#EeOCuQpO'#EUOOQO'#Jv'#JvODZQpO'#JwOEhQpO'#EUOCuQpO'#EePEuO&2DjO'#CbPOOO)CD{)CD{OOOO'#I^'#I^OFQO#tO,59UOOQ!0Lh,59U,59UOOOO'#I_'#I_OF`O&jO,59UOFnQ!L^O'#DaOOOO'#Ia'#IaOFuO#@ItO,59yOOQ!0Lf,59y,59yOGTQlO'#IbOGhQ`O'#JrOIgQ!fO'#JrO+}QlO'#JrOInQ`O,5:POJUQ`O'#EnOJcQ`O'#KROJnQ`O'#KQOJnQ`O'#KQOJvQ`O,5;[OJ{Q`O'#KPOOQ!0Ln,5:[,5:[OKSQlO,5:[OMQQ!0MxO,5:dOMqQ`O,5:lON[Q!0LrO'#KOONcQ`O'#J}O9ZQ`O'#J}ONwQ`O'#J}O! PQ`O,5;ZO! UQ`O'#J}O!#ZQ!fO'#JqOOQ!0Lh'#Ci'#CiO%[QlO'#EQO!#yQ!fO,5:qOOQS'#Jx'#JxOOQO-E<h-E<hO9aQ`O,5=^O!$aQ`O,5=^O!$fQlO,5;XO!&iQMhO'#EiO!(SQ`O,5;XO!(XQlO'#DwO!(cQpO,5;bO!(kQpO,5;bO%[QlO,5;bOOQ['#FS'#FSOOQ['#FU'#FUO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cO%[QlO,5;cOOQ['#FY'#FYO!(yQlO,5;sOOQ!0Lf,5;x,5;xOOQ!0Lf,5;y,5;yOOQ!0Lf,5;{,5;{O%[QlO'#InO!*|Q!0LrO,5<hO%[QlO,5;cO!&iQMhO,5;cO!+kQMhO,5;cO!-]QMhO'#E[O%[QlO,5;vOOQ!0Lf,5;z,5;zO!-dQ,UO'#FiO!.aQ,UO'#KVO!-{Q,UO'#KVO!.hQ,UO'#KVOOQO'#KV'#KVO!.|Q,UO,5<ROOOW,5<_,5<_O!/_QlO'#FuOOOW'#Im'#ImO7VO7dO,5<PO!/fQ,UO'#FwOOQ!0Lf,5<P,5<PO!0VQ$IUO'#CwOOQ!0Lh'#C{'#C{O!0jO#@ItO'#DPO!1WQMjO,5<dO!1_Q`O,5<gO!2zQ(CWO'#GWO!3XQ`O'#GXO!3^Q`O'#GXO!4|Q(CWO'#G]O!6RQpO'#GaOOQO'#Gm'#GmO!+rQMhO'#GlOOQO'#Go'#GoO!+rQMhO'#GnO!6tQ$IUO'#JjOOQ!0Lh'#Jj'#JjO!7OQ`O'#JiO!7^Q`O'#JhO!7fQ`O'#CuOOQ!0Lh'#Cy'#CyO!7qQ`O'#C{OOQ!0Lh'#DT'#DTOOQ!0Lh'#DV'#DVO1SQ`O'#DXO!+rQMhO'#GOO!+rQMhO'#GQO!7vQ`O'#GSO!7{Q`O'#GTO!3^Q`O'#GZO!+rQMhO'#G`O;zQ`O'#JiO!8QQ`O'#EoO!8oQ`O,5<fOOQ!0Lb'#Cr'#CrO!8wQ`O'#EpO!9qQpO'#EqOOQ!0Lb'#KP'#KPO!9xQ!0LrO'#K_O9kQ!0LrO,5=bO`QlO,5>rOOQ['#Jf'#JfOOQ[,5>s,5>sOOQ[-E<Z-E<ZO!;wQ!0MxO,5:`O!9lQpO,5:^O!>bQ!0MxO,5:hO%[QlO,5:hO!@xQ!0MxO,5:jOOQO,5@x,5@xO!AiQMhO,5=^O!AwQ!0LrO'#JgO9UQ`O'#JgO!BYQ!0LrO,59ZO!BeQpO,59ZO!BmQMhO,59ZO:YQMhO,59ZO!BxQ`O,5;XO!CQQ`O'#H`O!CfQ`O'#KbO%[QlO,5;|O!9lQpO,5<OO!CnQ`O,5=yO!CsQ`O,5=yO!CxQ`O,5=yO9kQ!0LrO,5=yO;zQ`O,5=iOOQO'#Cw'#CwO!DWQpO,5=fO!D`QMhO,5=gO!DkQ`O,5=iO!DpQ!bO,5=lO!DxQ`O'#K^O>wQ`O'#HVO9aQ`O'#HXO!D}Q`O'#HXO:YQMhO'#HZO!ESQ`O'#HZOOQ[,5=o,5=oO!EXQ`O'#H[O!EjQ`O'#CoO!EoQ`O,59PO!EyQ`O,59PO!HOQlO,59POOQ[,59P,59PO!H`Q!0LrO,59PO%[QlO,59PO!JkQlO'#HcOOQ['#Hd'#HdOOQ['#He'#HeO`QlO,5={O!KRQ`O,5={O`QlO,5>RO`QlO,5>TO!KWQ`O,5>VO`QlO,5>XO!K]Q`O,5>[O!KbQlO,5>bOOQ[,5>h,5>hO%[QlO,5>hO9kQ!0LrO,5>jOOQ[,5>l,5>lO# lQ`O,5>lOOQ[,5>n,5>nO# lQ`O,5>nOOQ[,5>p,5>pO#!YQpO'#D]O%[QlO'#JtO#!{QpO'#JtO##VQpO'#DkO##hQpO'#DkO#%yQlO'#DkO#&QQ`O'#JsO#&YQ`O,5:UO#&_Q`O'#ErO#&mQ`O'#KSO#&uQ`O,5;]O#&zQpO'#DkO#'XQpO'#ETOOQ!0Lf,5:m,5:mO%[QlO,5:mO#'`Q`O,5:mO>wQ`O,5;WO!BeQpO,5;WO!BmQMhO,5;WO:YQMhO,5;WO#'hQ`O,5@`O#'mQ07dO,5:qOOQO-E<d-E<dO#(sQ!0MSO,5;POCuQpO,5:pO#(}QpO,5:pOCuQpO,5;PO!BYQ!0LrO,5:pOOQ!0Lb'#Eh'#EhOOQO,5;P,5;PO%[QlO,5;PO#)[Q!0LrO,5;PO#)gQ!0LrO,5;PO!BeQpO,5:pOOQO,5;V,5;VO#)uQ!0LrO,5;PPOOO'#I['#I[P#*ZO&2DjO,58|POOO,58|,58|OOOO-E<[-E<[OOQ!0Lh1G.p1G.pOOOO-E<]-E<]OOOO,59{,59{O#*fQ!bO,59{OOOO-E<_-E<_OOQ!0Lf1G/e1G/eO#*kQ!fO,5>|O+}QlO,5>|OOQO,5?S,5?SO#*uQlO'#IbOOQO-E<`-E<`O#+SQ`O,5@^O#+[Q!fO,5@^O#+cQ`O,5@lOOQ!0Lf1G/k1G/kO%[QlO,5@mO#+kQ`O'#IhOOQO-E<f-E<fO#+cQ`O,5@lOOQ!0Lb1G0v1G0vOOQ!0Ln1G/v1G/vOOQ!0Ln1G0W1G0WO%[QlO,5@jO#,PQ!0LrO,5@jO#,bQ!0LrO,5@jO#,iQ`O,5@iO9ZQ`O,5@iO#,qQ`O,5@iO#-PQ`O'#IkO#,iQ`O,5@iOOQ!0Lb1G0u1G0uO!(cQpO,5:sO!(nQpO,5:sOOQS,5:u,5:uO#-qQdO,5:uO#-yQMhO1G2xO9aQ`O1G2xOOQ!0Lf1G0s1G0sO#.XQ!0MxO1G0sO#/^Q!0MvO,5;TOOQ!0Lh'#GV'#GVO#/zQ!0MzO'#JjO!$fQlO1G0sO#2VQ!fO'#JuO%[QlO'#JuO#2aQ`O,5:cOOQ!0Lh'#D]'#D]OOQ!0Lf1G0|1G0|O%[QlO1G0|OOQ!0Lf1G1e1G1eO#2fQ`O1G0|O#4zQ!0MxO1G0}O#5RQ!0MxO1G0}O#7iQ!0MxO1G0}O#7pQ!0MxO1G0}O#:WQ!0MxO1G0}O#<nQ!0MxO1G0}O#<uQ!0MxO1G0}O#<|Q!0MxO1G0}O#?dQ!0MxO1G0}O#?kQ!0MxO1G0}O#AxQ?MtO'#CiO#CsQ?MtO1G1_O#CzQ?MtO'#JqO#D_Q!0MxO,5?YOOQ!0Lb-E<l-E<lO#FlQ!0MxO1G0}O#GiQ!0MzO1G0}OOQ!0Lf1G0}1G0}O#HlQMjO'#JzO#HvQ`O,5:vO#H{Q!0MxO1G1bO#IoQ,UO,5<VO#IwQ,UO,5<WO#JPQ,UO'#FnO#JhQ`O'#FmOOQO'#KW'#KWOOQO'#Il'#IlO#JmQ,UO1G1mOOQ!0Lf1G1m1G1mOOOW1G1x1G1xO#KOQ?MtO'#JpO#KYQ`O,5<aO!(yQlO,5<aOOOW-E<k-E<kOOQ!0Lf1G1k1G1kO#K_QpO'#KVOOQ!0Lf,5<c,5<cO#KgQpO,5<cO#KlQMhO'#DROOOO'#I`'#I`O#KsO#@ItO,59kOOQ!0Lh,59k,59kO%[QlO1G2OO!7{Q`O'#IpO#LOQ`O,5<yOOQ!0Lh,5<v,5<vO!+rQMhO'#IsO#LlQMjO,5=WO!+rQMhO'#IuO#M_QMjO,5=YO!&iQMhO,5=[OOQO1G2R1G2RO#MiQ!dO'#CrO#M|Q(CWO'#EpO$ RQpO'#GaO$ iQ!dO,5<rO$ pQ`O'#KYO9ZQ`O'#KYO$!OQ`O,5<tO!+rQMhO,5<sO$!TQ`O'#GYO$!fQ`O,5<sO$!kQ!dO'#GVO$!xQ!dO'#KZO$#SQ`O'#KZO!&iQMhO'#KZO$#XQ`O,5<wO$#^QlO'#JtO$#hQpO'#GbO##hQpO'#GbO$#yQ`O'#GfO!3^Q`O'#GjO$$OQ!0LrO'#IrO$$ZQpO,5<{OOQ!0Lp,5<{,5<{O$$bQpO'#GbO$$oQpO'#GcO$%QQpO'#GcO$%VQMjO,5=WO$%gQMjO,5=YOOQ!0Lh,5=],5=]O!+rQMhO,5@TO!+rQMhO,5@TO$%wQ`O'#IwO$&VQ`O,5@SO$&_Q`O,59aOOQ!0Lh,59g,59gO$'UQ$IYO,59sOOQ!0Lh'#Jn'#JnO$'wQMjO,5<jO$(jQMjO,5<lO@iQ`O,5<nOOQ!0Lh,5<o,5<oO$(tQ`O,5<uO$(yQMjO,5<zO$)ZQ`O,5@TO$)iQ`O'#J}O!$fQlO1G2QO$)nQ`O1G2QO9ZQ`O'#KQO9ZQ`O'#ErO%[QlO'#ErO9ZQ`O'#IyO$)sQ!0LrO,5@yOOQ[1G2|1G2|OOQ[1G4^1G4^OOQ!0Lf1G/z1G/zOOQ!0Lf1G/x1G/xO$+uQ!0MxO1G0SOOQ[1G2x1G2xO!&iQMhO1G2xO%[QlO1G2xO#-|Q`O1G2xO$-yQMhO'#EiOOQ!0Lb,5@R,5@RO$.WQ!0LrO,5@ROOQ[1G.u1G.uO!BYQ!0LrO1G.uO!BeQpO1G.uO!BmQMhO1G.uO$.iQ`O1G0sO$.nQ`O'#CiO$.yQ`O'#KcO$/RQ`O,5=zO$/WQ`O'#KcO$/]Q`O'#KcO$/kQ`O'#JPO$/yQ`O,5@|O$0RQ!fO1G1hOOQ!0Lf1G1j1G1jO9aQ`O1G3eO@iQ`O1G3eO$0YQ`O1G3eO$0_Q`O1G3eOOQ[1G3e1G3eO!DkQ`O1G3TO!&iQMhO1G3QO$0dQ`O1G3QOOQ[1G3R1G3RO!&iQMhO1G3RO$0iQ`O1G3RO$0qQpO'#HPOOQ[1G3T1G3TO!5|QpO'#I{O!DpQ!bO1G3WOOQ[1G3W1G3WOOQ[,5=q,5=qO$0yQMhO,5=sO9aQ`O,5=sO$#yQ`O,5=uO9UQ`O,5=uO!BeQpO,5=uO!BmQMhO,5=uO:YQMhO,5=uO$1XQ`O'#KaO$1dQ`O,5=vOOQ[1G.k1G.kO$1iQ!0LrO1G.kO@iQ`O1G.kO$1tQ`O1G.kO9kQ!0LrO1G.kO$3|Q!fO,5AOO$4ZQ`O,5AOO9ZQ`O,5AOO$4fQlO,5=}O$4mQ`O,5=}OOQ[1G3g1G3gO`QlO1G3gOOQ[1G3m1G3mOOQ[1G3o1G3oO>rQ`O1G3qO$4rQlO1G3sO$8vQlO'#HrOOQ[1G3v1G3vO$9TQ`O'#HxO>wQ`O'#HzOOQ[1G3|1G3|O$9]QlO1G3|O9kQ!0LrO1G4SOOQ[1G4U1G4UOOQ!0Lb'#G^'#G^O9kQ!0LrO1G4WO9kQ!0LrO1G4YO$=dQ`O,5@`O!(yQlO,5;^O9ZQ`O,5;^O>wQ`O,5:VO!(yQlO,5:VO!BeQpO,5:VO$=iQ?MtO,5:VOOQO,5;^,5;^O$=sQpO'#IcO$>ZQ`O,5@_OOQ!0Lf1G/p1G/pO$>cQpO'#IiO$>mQ`O,5@nOOQ!0Lb1G0w1G0wO##hQpO,5:VOOQO'#Ie'#IeO$>uQpO,5:oOOQ!0Ln,5:o,5:oO#'cQ`O1G0XOOQ!0Lf1G0X1G0XO%[QlO1G0XOOQ!0Lf1G0r1G0rO>wQ`O1G0rO!BeQpO1G0rO!BmQMhO1G0rOOQ!0Lb1G5z1G5zO!BYQ!0LrO1G0[OOQO1G0k1G0kO%[QlO1G0kO$>|Q!0LrO1G0kO$?XQ!0LrO1G0kO!BeQpO1G0[OCuQpO1G0[O$?gQ!0LrO1G0kOOQO1G0[1G0[O$?{Q!0MxO1G0kPOOO-E<Y-E<YPOOO1G.h1G.hOOOO1G/g1G/gO$@VQ!bO,5<hO$@_Q!fO1G4hOOQO1G4n1G4nO%[QlO,5>|O$@iQ`O1G5xO$@qQ`O1G6WO$@yQ!fO1G6XO9ZQ`O,5?SO$ATQ!0MxO1G6UO%[QlO1G6UO$AeQ!0LrO1G6UO$AvQ`O1G6TO$AvQ`O1G6TO9ZQ`O1G6TO$BOQ`O,5?VO9ZQ`O,5?VOOQO,5?V,5?VO$BdQ`O,5?VO$)iQ`O,5?VOOQO-E<i-E<iOOQS1G0_1G0_OOQS1G0a1G0aO#-tQ`O1G0aOOQ[7+(d7+(dO!&iQMhO7+(dO%[QlO7+(dO$BrQ`O7+(dO$B}QMhO7+(dO$C]Q!0MzO,5=WO$EhQ!0MzO,5=YO$GsQ!0MzO,5=WO$JUQ!0MzO,5=YO$LgQ!0MzO,59sO$NlQ!0MzO,5<jO%!wQ!0MzO,5<lO%%SQ!0MzO,5<zOOQ!0Lf7+&_7+&_O%'eQ!0MxO7+&_O%(XQlO'#IdO%(fQ`O,5@aO%(nQ!fO,5@aOOQ!0Lf1G/}1G/}O%(xQ`O7+&hOOQ!0Lf7+&h7+&hO%(}Q?MtO,5:dO%[QlO7+&yO%)XQ?MtO,5:`O%)fQ?MtO,5:hO%)pQ?MtO,5:jO%)zQMhO'#IgO%*UQ`O,5@fOOQ!0Lh1G0b1G0bOOQO1G1q1G1qOOQO1G1r1G1rO%*^Q!jO,5<YO!(yQlO,5<XOOQO-E<j-E<jOOQ!0Lf7+'X7+'XOOOW7+'d7+'dOOOW1G1{1G1{O%*iQ`O1G1{OOQ!0Lf1G1}1G1}OOOO,59m,59mO%*nQ!dO,59mOOOO-E<^-E<^OOQ!0Lh1G/V1G/VO%*uQ!0MxO7+'jOOQ!0Lh,5?[,5?[O%+iQMhO1G2eP%+pQ`O'#IpPOQ!0Lh-E<n-E<nO%,^QMjO,5?_OOQ!0Lh-E<q-E<qO%-PQMjO,5?aOOQ!0Lh-E<s-E<sO%-ZQ!dO1G2vO%-bQ!dO'#CrO%-xQMhO'#KQO$#^QlO'#JtOOQ!0Lh1G2^1G2^O%.PQ`O'#IoO%.eQ`O,5@tO%.eQ`O,5@tO%.mQ`O,5@tO%.xQ`O,5@tOOQO1G2`1G2`O%/WQMjO1G2_O!+rQMhO1G2_O%/hQ(CWO'#IqO%/uQ`O,5@uO!&iQMhO,5@uO%/}Q!dO,5@uOOQ!0Lh1G2c1G2cO%2_Q!fO'#CiO%2iQ`O,5=OOOQ!0Lb,5<|,5<|O%2qQpO,5<|OOQ!0Lb,5<},5<}OCfQ`O,5<|O%2|QpO,5<|OOQ!0Lb,5=Q,5=QO$)iQ`O,5=UOOQO,5?^,5?^OOQO-E<p-E<pOOQ!0Lp1G2g1G2gO##hQpO,5<|O$#^QlO,5=OO%3[Q`O,5<}O%3gQpO,5<}O!+rQMhO'#IsO%4aQMjO1G2rO!+rQMhO'#IuO%5SQMjO1G2tO%5^QMjO1G5oO%5hQMjO1G5oOOQO,5?c,5?cOOQO-E<u-E<uOOQO1G.{1G.{O!9lQpO,59uO%[QlO,59uOOQ!0Lh,5<i,5<iO%5uQ`O1G2YO!+rQMhO1G2aO!+rQMhO1G5oO!+rQMhO1G5oO%5zQ!0MxO7+'lOOQ!0Lf7+'l7+'lO!$fQlO7+'lO%6nQ`O,5;^OOQ!0Lb,5?e,5?eOOQ!0Lb-E<w-E<wO%6sQ!dO'#K[O#'cQ`O7+(dO4UQ!fO7+(dO$BuQ`O7+(dO%6}Q!0MvO'#CiO%7nQ!0LrO,5=RO%8PQ!0MvO,5=RO%8dQ`O,5=ROOQ!0Lb1G5m1G5mOOQ[7+$a7+$aO!BYQ!0LrO7+$aO!BeQpO7+$aO!$fQlO7+&_O%8lQ`O'#JOO%9TQ`O,5@}OOQO1G3f1G3fO9aQ`O,5@}O%9TQ`O,5@}O%9]Q`O,5@}OOQO,5?k,5?kOOQO-E<}-E<}OOQ!0Lf7+'S7+'SO%9bQ`O7+)PO9kQ!0LrO7+)PO9aQ`O7+)PO@iQ`O7+)POOQ[7+(o7+(oO%9gQ!0MvO7+(lO!&iQMhO7+(lO!DfQ`O7+(mOOQ[7+(m7+(mO!&iQMhO7+(mO%9qQ`O'#K`O%9|Q`O,5=kOOQO,5?g,5?gOOQO-E<y-E<yOOQ[7+(r7+(rO%;`QpO'#HYOOQ[1G3_1G3_O!&iQMhO1G3_O%[QlO1G3_O%;gQ`O1G3_O%;rQMhO1G3_O9kQ!0LrO1G3aO$#yQ`O1G3aO9UQ`O1G3aO!BeQpO1G3aO!BmQMhO1G3aO%<QQ`O'#I}O%<fQ`O,5@{O%<nQpO,5@{OOQ!0Lb1G3b1G3bOOQ[7+$V7+$VO@iQ`O7+$VO9kQ!0LrO7+$VO%<yQ`O7+$VO%[QlO1G6jO%[QlO1G6kO%=OQ!0LrO1G6jO%=YQlO1G3iO%=aQ`O1G3iO%=fQlO1G3iOOQ[7+)R7+)RO9kQ!0LrO7+)]O`QlO7+)_OOQ['#Kf'#KfOOQ['#JQ'#JQO%=mQlO,5>^OOQ[,5>^,5>^O%[QlO'#HsO%=zQ`O'#HuOOQ[,5>d,5>dO9ZQ`O,5>dOOQ[,5>f,5>fOOQ[7+)h7+)hOOQ[7+)n7+)nOOQ[7+)r7+)rOOQ[7+)t7+)tO%>PQpO1G5zO%>kQ?MtO1G0xO%>uQ`O1G0xOOQO1G/q1G/qO%?QQ?MtO1G/qO>wQ`O1G/qO!(yQlO'#DkOOQO,5>},5>}OOQO-E<a-E<aOOQO,5?T,5?TOOQO-E<g-E<gO!BeQpO1G/qOOQO-E<c-E<cOOQ!0Ln1G0Z1G0ZOOQ!0Lf7+%s7+%sO#'cQ`O7+%sOOQ!0Lf7+&^7+&^O>wQ`O7+&^O!BeQpO7+&^OOQO7+%v7+%vO$?{Q!0MxO7+&VOOQO7+&V7+&VO%[QlO7+&VO%?[Q!0LrO7+&VO!BYQ!0LrO7+%vO!BeQpO7+%vO%?gQ!0LrO7+&VO%?uQ!0MxO7++pO%[QlO7++pO%@VQ`O7++oO%@VQ`O7++oOOQO1G4q1G4qO9ZQ`O1G4qO%@_Q`O1G4qOOQS7+%{7+%{O#'cQ`O<<LOO4UQ!fO<<LOO%@mQ`O<<LOOOQ[<<LO<<LOO!&iQMhO<<LOO%[QlO<<LOO%@uQ`O<<LOO%AQQ!0MzO,5?_O%C]Q!0MzO,5?aO%EhQ!0MzO1G2_O%GyQ!0MzO1G2rO%JUQ!0MzO1G2tO%LaQ!fO,5?OO%[QlO,5?OOOQO-E<b-E<bO%LkQ`O1G5{OOQ!0Lf<<JS<<JSO%LsQ?MtO1G0sO%NzQ?MtO1G0}O& RQ?MtO1G0}O&#SQ?MtO1G0}O&#ZQ?MtO1G0}O&%[Q?MtO1G0}O&']Q?MtO1G0}O&'dQ?MtO1G0}O&'kQ?MtO1G0}O&)lQ?MtO1G0}O&)sQ?MtO1G0}O&)zQ!0MxO<<JeO&+rQ?MtO1G0}O&,oQ?MvO1G0}O&-rQ?MvO'#JjO&/xQ?MtO1G1bO&0VQ?MtO1G0SO&0aQMjO,5?ROOQO-E<e-E<eO!(yQlO'#FpOOQO'#KX'#KXOOQO1G1t1G1tO&0kQ`O1G1sO&0pQ?MtO,5?YOOOW7+'g7+'gOOOO1G/X1G/XO&0zQ!dO1G4vOOQ!0Lh7+(P7+(PP!&iQMhO,5?[O!+rQMhO7+(bO&1RQ`O,5?ZO9ZQ`O,5?ZOOQO-E<m-E<mO&1aQ`O1G6`O&1aQ`O1G6`O&1iQ`O1G6`O&1tQMjO7+'yO&2UQ!dO,5?]O&2`Q`O,5?]O!&iQMhO,5?]OOQO-E<o-E<oO&2eQ!dO1G6aO&2oQ`O1G6aO&2wQ`O1G2jO!&iQMhO1G2jOOQ!0Lb1G2h1G2hOOQ!0Lb1G2i1G2iO%2qQpO1G2hO!BeQpO1G2hOCfQ`O1G2hOOQ!0Lb1G2p1G2pO&2|QpO1G2hO&3[Q`O1G2jO$)iQ`O1G2iOCfQ`O1G2iO$#^QlO1G2jO&3dQ`O1G2iO&4WQMjO,5?_OOQ!0Lh-E<r-E<rO&4yQMjO,5?aOOQ!0Lh-E<t-E<tO!+rQMhO7++ZOOQ!0Lh1G/a1G/aO&5TQ`O1G/aOOQ!0Lh7+'t7+'tO&5YQMjO7+'{O&5jQMjO7++ZO&5tQMjO7++ZO&6RQ!0MxO<<KWOOQ!0Lf<<KW<<KWO&6uQ`O1G0xO!&iQMhO'#IxO&6zQ`O,5@vO&8|Q!fO<<LOO!&iQMhO1G2mO&9TQ!0LrO1G2mOOQ[<<G{<<G{O!BYQ!0LrO<<G{O&9fQ!0MxO<<IyOOQ!0Lf<<Iy<<IyOOQO,5?j,5?jO&:YQ`O,5?jO&:_Q`O,5?jOOQO-E<|-E<|O&:mQ`O1G6iO&:mQ`O1G6iO9aQ`O1G6iO@iQ`O<<LkOOQ[<<Lk<<LkO&:uQ`O<<LkO9kQ!0LrO<<LkOOQ[<<LW<<LWO%9gQ!0MvO<<LWOOQ[<<LX<<LXO!DfQ`O<<LXO&:zQpO'#IzO&;VQ`O,5@zO!(yQlO,5@zOOQ[1G3V1G3VOOQO'#I|'#I|O9kQ!0LrO'#I|O&;_QpO,5=tOOQ[,5=t,5=tO&;fQpO'#EeO&;mQpO'#GdO&;rQ`O7+(yO&;wQ`O7+(yOOQ[7+(y7+(yO!&iQMhO7+(yO%[QlO7+(yO&<PQ`O7+(yOOQ[7+({7+({O9kQ!0LrO7+({O$#yQ`O7+({O9UQ`O7+({O!BeQpO7+({O&<[Q`O,5?iOOQO-E<{-E<{OOQO'#H]'#H]O&<gQ`O1G6gO9kQ!0LrO<<GqOOQ[<<Gq<<GqO@iQ`O<<GqO&<oQ`O7+,UO&<tQ`O7+,VO%[QlO7+,UO%[QlO7+,VOOQ[7+)T7+)TO&<yQ`O7+)TO&=OQlO7+)TO&=VQ`O7+)TOOQ[<<Lw<<LwOOQ[<<Ly<<LyOOQ[-E=O-E=OOOQ[1G3x1G3xO&=[Q`O,5>_OOQ[,5>a,5>aO&=aQ`O1G4OO9ZQ`O7+&dO!(yQlO7+&dOOQO7+%]7+%]O&=fQ?MtO1G6XO>wQ`O7+%]OOQ!0Lf<<I_<<I_OOQ!0Lf<<Ix<<IxO>wQ`O<<IxOOQO<<Iq<<IqO$?{Q!0MxO<<IqO%[QlO<<IqOOQO<<Ib<<IbO!BYQ!0LrO<<IbO&=pQ!0LrO<<IqO&={Q!0MxO<= [O&>]Q`O<= ZOOQO7+*]7+*]O9ZQ`O7+*]OOQ[ANAjANAjO&>eQ!fOANAjO!&iQMhOANAjO#'cQ`OANAjO4UQ!fOANAjO&>lQ`OANAjO%[QlOANAjO&>tQ!0MzO7+'yO&AVQ!0MzO,5?_O&CbQ!0MzO,5?aO&EmQ!0MzO7+'{O&HOQ!fO1G4jO&HYQ?MtO7+&_O&J^Q?MvO,5=WO&LeQ?MvO,5=YO&LuQ?MvO,5=WO&MVQ?MvO,5=YO&MgQ?MvO,59sO' mQ?MvO,5<jO'#pQ?MvO,5<lO'&UQ?MvO,5<zO''zQ?MtO7+'jO'(XQ?MtO7+'lO'(fQ`O,5<[OOQO7+'_7+'_OOQ!0Lh7+*b7+*bO'(kQMjO<<K|OOQO1G4u1G4uO'(rQ`O1G4uO'(}Q`O1G4uO')]Q`O7++zO')]Q`O7++zO!&iQMhO1G4wO')eQ!dO1G4wO')oQ`O7++{O')wQ`O7+(UO'*SQ!dO7+(UOOQ!0Lb7+(S7+(SOOQ!0Lb7+(T7+(TO!BeQpO7+(SOCfQ`O7+(SO'*^Q`O7+(UO!&iQMhO7+(UO$)iQ`O7+(TO'*cQ`O7+(UOCfQ`O7+(TO'*kQMjO<<NuOOQ!0Lh7+${7+${O!+rQMhO<<NuO'*uQ!dO,5?dOOQO-E<v-E<vO'+PQ!0MvO7+(XO!&iQMhO7+(XOOQ[AN=gAN=gO9aQ`O1G5UOOQO1G5U1G5UO'+aQ`O1G5UO'+fQ`O7+,TO'+fQ`O7+,TO9kQ!0LrOANBVO@iQ`OANBVOOQ[ANBVANBVOOQ[ANArANArOOQ[ANAsANAsO'+nQ`O,5?fOOQO-E<x-E<xO'+yQ?MtO1G6fOOQO,5?h,5?hOOQO-E<z-E<zOOQ[1G3`1G3`O',TQ`O,5=OOOQ[<<Le<<LeO!&iQMhO<<LeO&;rQ`O<<LeO',YQ`O<<LeO%[QlO<<LeOOQ[<<Lg<<LgO9kQ!0LrO<<LgO$#yQ`O<<LgO9UQ`O<<LgO',bQpO1G5TO',mQ`O7+,ROOQ[AN=]AN=]O9kQ!0LrOAN=]OOQ[<= p<= pOOQ[<= q<= qO',uQ`O<= pO',zQ`O<= qOOQ[<<Lo<<LoO'-PQ`O<<LoO'-UQlO<<LoOOQ[1G3y1G3yO>wQ`O7+)jO'-]Q`O<<JOO'-hQ?MtO<<JOOOQO<<Hw<<HwOOQ!0LfAN?dAN?dOOQOAN?]AN?]O$?{Q!0MxOAN?]OOQOAN>|AN>|O%[QlOAN?]OOQO<<Mw<<MwOOQ[G27UG27UO!&iQMhOG27UO#'cQ`OG27UO'-rQ!fOG27UO4UQ!fOG27UO'-yQ`OG27UO'.RQ?MtO<<JeO'.`Q?MvO1G2_O'0UQ?MvO,5?_O'2XQ?MvO,5?aO'4[Q?MvO1G2rO'6_Q?MvO1G2tO'8bQ?MtO<<KWO'8oQ?MtO<<IyOOQO1G1v1G1vO!+rQMhOANAhOOQO7+*a7+*aO'8|Q`O7+*aO'9XQ`O<= fO'9aQ!dO7+*cOOQ!0Lb<<Kp<<KpO$)iQ`O<<KpOCfQ`O<<KpO'9kQ`O<<KpO!&iQMhO<<KpOOQ!0Lb<<Kn<<KnO!BeQpO<<KnO'9vQ!dO<<KpOOQ!0Lb<<Ko<<KoO':QQ`O<<KpO!&iQMhO<<KpO$)iQ`O<<KoO':VQMjOANDaO':aQ!0MvO<<KsOOQO7+*p7+*pO9aQ`O7+*pO':qQ`O<= oOOQ[G27qG27qO9kQ!0LrOG27qO!(yQlO1G5QO':yQ`O7+,QO';RQ`O1G2jO&;rQ`OANBPOOQ[ANBPANBPO!&iQMhOANBPO';WQ`OANBPOOQ[ANBRANBRO9kQ!0LrOANBRO$#yQ`OANBROOQO'#H^'#H^OOQO7+*o7+*oOOQ[G22wG22wOOQ[ANE[ANE[OOQ[ANE]ANE]OOQ[ANBZANBZO';`Q`OANBZOOQ[<<MU<<MUO!(yQlOAN?jOOQOG24wG24wO$?{Q!0MxOG24wO#'cQ`OLD,pOOQ[LD,pLD,pO!&iQMhOLD,pO';eQ!fOLD,pO';lQ?MvO7+'yO'=bQ?MvO,5?_O'?eQ?MvO,5?aO'AhQ?MvO7+'{O'C^QMjOG27SOOQO<<M{<<M{OOQ!0LbANA[ANA[O$)iQ`OANA[OCfQ`OANA[O'CnQ!dOANA[OOQ!0LbANAYANAYO'CuQ`OANA[O!&iQMhOANA[O'DQQ!dOANA[OOQ!0LbANAZANAZOOQO<<N[<<N[OOQ[LD-]LD-]O'D[Q?MtO7+*lOOQO'#Ge'#GeOOQ[G27kG27kO&;rQ`OG27kO!&iQMhOG27kOOQ[G27mG27mO9kQ!0LrOG27mOOQ[G27uG27uO'DfQ?MtOG25UOOQOLD*cLD*cOOQ[!$(![!$(![O#'cQ`O!$(![O!&iQMhO!$(![O'DpQ!0MzOG27SOOQ!0LbG26vG26vO$)iQ`OG26vO'GRQ`OG26vOCfQ`OG26vO'G^Q!dOG26vO!&iQMhOG26vOOQ[LD-VLD-VO&;rQ`OLD-VOOQ[LD-XLD-XOOQ[!)9Ev!)9EvO#'cQ`O!)9EvOOQ!0LbLD,bLD,bO$)iQ`OLD,bOCfQ`OLD,bO'GeQ`OLD,bO'GpQ!dOLD,bOOQ[!$(!q!$(!qOOQ[!.K;b!.K;bO'GwQ?MvOG27SOOQ!0Lb!$( |!$( |O$)iQ`O!$( |OCfQ`O!$( |O'ImQ`O!$( |OOQ!0Lb!)9Eh!)9EhO$)iQ`O!)9EhOCfQ`O!)9EhOOQ!0Lb!.K;S!.K;SO$)iQ`O!.K;SOOQ!0Lb!4/0n!4/0nO!(yQlO'#DxO1PQ`O'#EVO'IxQ!fO'#JpO'JPQ!L^O'#DtO'JWQlO'#D|O'J_Q!fO'#CiO'LuQ!fO'#CiO!(yQlO'#EOO'MVQlO,5;XO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO,5;cO!(yQlO'#InO( YQ`O,5<hO!(yQlO,5;cO( bQMhO,5;cO(!{QMhO,5;cO!(yQlO,5;vO!&iQMhO'#GlO( bQMhO'#GlO!&iQMhO'#GnO( bQMhO'#GnO1SQ`O'#DXO1SQ`O'#DXO!&iQMhO'#GOO( bQMhO'#GOO!&iQMhO'#GQO( bQMhO'#GQO!&iQMhO'#G`O( bQMhO'#G`O!(yQlO,5:hO(#SQpO'#D]O(#^QpO'#JtO!(yQlO,5@mO'MVQlO1G0sO(#hQ?MtO'#CiO!(yQlO1G2OO!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO(#rQ!dO'#CrO!&iQMhO,5<sO( bQMhO,5<sO'MVQlO1G2QO!(yQlO7+&yO!&iQMhO1G2_O( bQMhO1G2_O!&iQMhO'#IsO( bQMhO'#IsO!&iQMhO'#IuO( bQMhO'#IuO!&iQMhO1G2aO( bQMhO1G2aO'MVQlO7+'lO'MVQlO7+&_O!&iQMhOANAhO( bQMhOANAhO($VQ`O'#EmO($[Q`O'#EmO($dQ`O'#F[O($iQ`O'#EwO($nQ`O'#KRO($yQ`O'#KPO(%UQ`O,5;XO(%ZQMjO,5<dO(%bQ`O'#GXO(%gQ`O'#GXO(%lQ`O,5<fO(%tQ`O,5;XO(%|Q?MtO1G1_O(&TQ`O,5<sO(&YQ`O,5<sO(&_Q`O,5<uO(&dQ`O,5<uO(&iQ`O1G2QO(&nQ`O1G0sO(&sQMjO<<K|O(&zQMjO<<K|O7eQMhO'#F{O9UQ`O'#FzOAdQ`O'#ElO!(yQlO,5;sO!3^Q`O'#GXO!3^Q`O'#GXO!3^Q`O'#GZO!3^Q`O'#GZO!+rQMhO7+(bO!+rQMhO7+(bO%-ZQ!dO1G2vO%-ZQ!dO1G2vO!&iQMhO,5=[O!&iQMhO,5=[",stateData:"((P~O'zOS'{OSTOS'|RQ~OPYOQYOSfOY!VOaqOdzOeyOj!POnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!swO!vxO!z]O$V|O$miO%g}O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO&U!WO&[!XO&^!YO&`!ZO&b![O&e!]O&k!^O&q!_O&s!`O&u!aO&w!bO&y!cO(RSO(TTO(WUO(_VO(m[O~OWtO~P`OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa!wOq!nO!Q!oO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!xO#U!pO#V!pO#Y!zO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O'|!{O~OP]XR]X[]Xa]Xp]X!O]X!Q]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X'x]X(_]X(p]X(w]X(x]X~O!e%QX~P(qO_!}O(T#PO(U!}O(V#PO~O_#QO(V#PO(W#PO(X#QO~Ov#SO!S#TO(`#TO(a#VO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R;{O(TTO(WUO(_VO(m[O~O!Y#ZO!Z#WO!W(fP!W(tP~P+}O![#cO~P`OPYOQYOSfOd!jOe!iOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(TTO(WUO(_VO(m[O~On#mO!Y#iO!z]O#g#lO#h#iO(R;|O!i(qP~P.iO!j#oO(R#nO~O!v#sO!z]O%g#tO~O#i#uO~O!e#vO#i#uO~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z$_O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa(dX'x(dX'u(dX!i(dX!W(dX!](dX%h(dX!e(dX~P1qO#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX!](eX%h(eX~Oa(eX'x(eX'u(eX!W(eX!i(eXt(eX!e(eX~P4UO#^$eO~O$[$hO$^$gO$e$mO~OSfO!]$nO$h$oO$j$qO~Oh%VOj%cOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R$sO(TTO(WUO(_$uO(w$}O(x%POg([P~O!j%dO~O!Q%gO!]%hO(R%fO~O!e%lO~Oa%mO'x%mO~O!O%qO~P%[O(S!lO~P%[O%m%uO~P%[Oh%VO!j%dO(R%fO(S!lO~Oe%|O!j%dO(R%fO~O#t$RO~O!O&RO!]&OO!j&QO%i&UO(R%fO(S!lO(TTO(WUO`)UP~O!v#sO~O%r&WO!Q)QX!])QX(R)QX~O(R&XO~Oj!PO!s&^O%i!QO%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO~Od&cOe&bO!v&`O%g&aO%z&_O~P<POd&fOeyOj!PO!]&eO!s&^O!vxO!z]O%g}O%k!OO%l!OO%m!OO%p!RO%r!SO%u!TO%v!TO%x!UO~Ob&iO#^&lO%i&gO(S!lO~P=UO!j&mO!s&qO~O!j#oO~O!]XO~Oa%mO'v&yO'x%mO~Oa%mO'v&|O'x%mO~Oa%mO'v'OO'x%mO~O'u]X!W]Xt]X!i]X&Y]X!]]X%h]X!e]X~P(qO!`']O!a'UO!b'UO(S!lO(TTO(WUO~Oq'SO!Q'RO!Y'VO(c'QO![(gP![(vP~P@]Ol'`O!]'^O(R%fO~Oe'eO!j%dO(R%fO~O!O&RO!j&QO~Oq!nO!Q!oO!z;wO#R!pO#S!pO#U!pO#V!pO(S!lO(TTO(WUO(c!mO(m!sO~O!`'kO!a'jO!b'jO#T!pO#Y'lO#Z'lO~PAwOa%mOh%VO!e#vO!j%dO'x%mO(p'nO~O!n'rO#^'pO~PCVOq!nO!Q!oO(TTO(WUO(c!mO(m!sO~O!]XOq(kX!Q(kX!`(kX!a(kX!b(kX!z(kX#R(kX#S(kX#T(kX#U(kX#V(kX#Y(kX#Z(kX(S(kX(T(kX(W(kX(c(kX(m(kX~O!a'jO!b'jO(S!lO~PCuO'}'vO(O'vO(P'xO~O_!}O(T'zO(U!}O(V'zO~O_#QO(V'zO(W'zO(X#QO~Ot'|O~P%[Ov#SO!S#TO(`#TO(a(PO~O!Y(RO!W'UX!W'[X!Z'UX!Z'[X~P+}O!Z(TO!W(fX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!Z(TO!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~O!W(fX~PGpO!W(YO~O!W(sX!Z(sX!e(sX!i(sX(p(sX~O#^(sX#i#bX![(sX~PIsO#^(ZO!W(uX!Z(uX~O!Z([O!W(tX~O!W(_O~O#^$eO~PIsO![(`O~P`OR#zO!O#yO!Q#{O!j#xO(_VOP!la[!lap!la!Z!la!n!la#P!la#l!la#m!la#n!la#o!la#p!la#q!la#r!la#s!la#t!la#u!la#w!la#y!la#z!la(p!la(w!la(x!la~Oa!la'x!la'u!la!W!la!i!lat!la!]!la%h!la!e!la~PKZO!i(aO~O!e#vO#^(bO(p'nO!Z(rXa(rX'x(rX~O!i(rX~PMvO!Q%gO!]%hO!z]O#g(gO#h(fO(R%fO~O!Z(hO!i(qX~O!i(jO~O!Q%gO!]%hO#h(fO(R%fO~OP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#t(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O!e#vO!i(eX~P! dOR(lO!O(kO!j#xO#Q$dO!z!ya!Q!ya~O!v!ya%g!ya!]!ya#g!ya#h!ya(R!ya~P!#eO!v(pO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]XO!guO!jZO!mYO!nYO!oYO!qvO!s!gO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~O#i(vO~O!Y(xO!i(iP~P%[O(c(zO(m[O~O!Q(|O!j#xO(c(zO(m[O~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z$_Oa$pa'x$pa'u$pa!i$pa!W$pa!]$pa%h$pa!e$pa~Oj)bO~P!&iOh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|%[O!Q${O!]$|O!g%aO!j$xO#h%bO$V%_O$s%]O$u%^O$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Og(nP~P!+rO!O)gO!e)fO!]$]X$Y$]X$[$]X$^$]X$e$]X~O!e)fO!](yX$Y(yX$[(yX$^(yX$e(yX~O!O)gO~P!-{O!O)gO!](yX$Y(yX$[(yX$^(yX$e(yX~O!])iO$Y)mO$[)hO$^)hO$e)nO~O!Y)qO~P!(yO$[$hO$^$gO$e)uO~Ol$yX!O$yX#Q$yX'w$yX(w$yX(x$yX~OgkXg$yXlkX!ZkX#^kX~P!/qOv)wO(`)xO(a)zO~Ol*TO!O)|O'w)}O(w$}O(x%PO~Og){O~P!0uOg*UO~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q*WO!]*XO!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~O!Y*[O(R*VO!i(|P~P!1dO#i*^O~O!j*_O~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(R*aO(TTO(WUO(_$uO(w$}O(x%PO~O!Y*dO!W(}P~P!3cOp*pOq!nO!Q*fO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO(c!mO~O![*mO~P!5WO#Q$dOl(^X!O(^X'w(^X(w(^X(x(^X!Z(^X#^(^X~Og(^X#}(^X~P!6YOl*uO#^*tOg(]X!Z(]X~O!Z*vOg([X~Oj%cO(R&XOg([P~Oq*yO~O!j+OO~O(R(tO~On+TO!Q%gO!Y#iO!]%hO!z]O#g#lO#h#iO(R%fO!i(qP~O!e#vO#i+UO~O!Q%gO!Y+WO!Z([O!]%hO(R%fO!W(tP~Oq'YO!Q+YO!Y+XO(TTO(WUO(c(zO~O![(vP~P!9]O!Z+ZOa)RX'x)RX~OP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO#y$WO#z$XO(_VO(p$YO(w#|O(x#}O~Oa!ha!Z!ha'x!ha'u!ha!W!ha!i!hat!ha!]!ha%h!ha!e!ha~P!:TOR#zO!O#yO!Q#{O!j#xO(_VOP!pa[!pap!pa!Z!pa!n!pa#P!pa#l!pa#m!pa#n!pa#o!pa#p!pa#q!pa#r!pa#s!pa#t!pa#u!pa#w!pa#y!pa#z!pa(p!pa(w!pa(x!pa~Oa!pa'x!pa'u!pa!W!pa!i!pat!pa!]!pa%h!pa!e!pa~P!<kOR#zO!O#yO!Q#{O!j#xO(_VOP!ra[!rap!ra!Z!ra!n!ra#P!ra#l!ra#m!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#w!ra#y!ra#z!ra(p!ra(w!ra(x!ra~Oa!ra'x!ra'u!ra!W!ra!i!rat!ra!]!ra%h!ra!e!ra~P!?ROh%VOl+dO!]'^O%h+cO~O!e+fOa(ZX!](ZX'x(ZX!Z(ZX~Oa%mO!]XO'x%mO~Oh%VO!j%dO~Oh%VO!j%dO(R%fO~O!e#vO#i(vO~Ob+qO%i+rO(R+nO(TTO(WUO![)VP~O!Z+sO`)UX~O[+wO~O`+xO~O!]&OO(R%fO(S!lO`)UP~Oh%VO#^+}O~Oh%VOl,QO!]$|O~O!],SO~O!O,UO!]XO~O%m%uO~O!v,ZO~Oe,`O~Ob,aO(R#nO(TTO(WUO![)TP~Oe%|O~O%i!QO(R&XO~P=UO[,fO`,eO~OPYOQYOSfOdzOeyOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!guO!jZO!mYO!nYO!oYO!qvO!vxO!z]O$miO%g}O(TTO(WUO(_VO(m[O~O!]!eO!s!gO$V!kO(R!dO~P!FRO`,eOa%mO'x%mO~OPYOQYOSfOd!jOe!iOnkOpYOqkOrkOxkOzYO|YO!QWO!UkO!VkO!]!eO!guO!jZO!mYO!nYO!oYO!qvO!v!hO$V!kO$miO(R!dO(TTO(WUO(_VO(m[O~Oa,kOj!OO!swO%k!OO%l!OO%m!OO~P!HkO!j&mO~O&[,qO~O!],sO~O&m,uO&o,vOP&jaQ&jaS&jaY&jaa&jad&jae&jaj&jan&jap&jaq&jar&jax&jaz&ja|&ja!Q&ja!U&ja!V&ja!]&ja!g&ja!j&ja!m&ja!n&ja!o&ja!q&ja!s&ja!v&ja!z&ja$V&ja$m&ja%g&ja%i&ja%k&ja%l&ja%m&ja%p&ja%r&ja%u&ja%v&ja%x&ja&U&ja&[&ja&^&ja&`&ja&b&ja&e&ja&k&ja&q&ja&s&ja&u&ja&w&ja&y&ja'u&ja(R&ja(T&ja(W&ja(_&ja(m&ja![&ja&c&jab&ja&h&ja~O(R,{O~Oh!cX!Z!PX![!PX!e!PX!e!cX!j!cX#^!PX~O!Z!cX![!cX~P# qO!e-QO#^-POh(hX!Z#fX![#fX!e(hX!j(hX~O!Z(hX![(hX~P#!dOh%VO!e-SO!j%dO!Z!_X![!_X~Oq!nO!Q!oO(TTO(WUO(c!mO~OP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]!eO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(TTO(WUO(_VO(m[O~O(R<rO~P##yO!Z-WO![(gX~O![-YO~O!e-QO#^-PO!Z#fX![#fX~O!Z-ZO![(vX~O![-]O~O!a-^O!b-^O(S!lO~P##hO![-aO~P'_Ol-dO!]'^O~O!W-iO~Oq!ya!`!ya!a!ya!b!ya#R!ya#S!ya#T!ya#U!ya#V!ya#Y!ya#Z!ya(S!ya(T!ya(W!ya(c!ya(m!ya~P!#eO!n-nO#^-lO~PCVO!a-pO!b-pO(S!lO~PCuOa%mO#^-lO'x%mO~Oa%mO!e#vO#^-lO'x%mO~Oa%mO!e#vO!n-nO#^-lO'x%mO(p'nO~O'}'vO(O'vO(P-uO~Ot-vO~O!W'Ua!Z'Ua~P!:TO!Y-zO!W'UX!Z'UX~P%[O!Z(TO!W(fa~O!W(fa~PGpO!Z([O!W(ta~O!Q%gO!Y.OO!]%hO(R%fO!W'[X!Z'[X~O#^.QO!Z(ra!i(raa(ra'x(ra~O!e#vO~P#,PO!Z(hO!i(qa~O!Q%gO!]%hO#h.UO(R%fO~On.ZO!Q%gO!Y.WO!]%hO!z]O#g.YO#h.WO(R%fO!Z'_X!i'_X~OR._O!j#xO~Oh%VOl.bO!]'^O%h.aO~Oa#ai!Z#ai'x#ai'u#ai!W#ai!i#ait#ai!]#ai%h#ai!e#ai~P!:TOl=|O!O)|O'w)}O(w$}O(x%PO~O#i#]aa#]a#^#]a'x#]a!Z#]a!i#]a!]#]a!W#]a~P#.{O#i(^XP(^XR(^X[(^Xa(^Xp(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X'x(^X(_(^X(p(^X!i(^X!W(^X'u(^Xt(^X!](^X%h(^X!e(^X~P!6YO!Z.oO!i(iX~P!:TO!i.rO~O!W.tO~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kia#kip#ki!Z#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#l#ki~P#2kO#l$OO~P#2kOP$[OR#zOp$aO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO[#kia#ki!Z#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#p#ki~P#5YO#p$QO~P#5YOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO(_VOa#ki!Z#ki#w#ki#y#ki#z#ki'x#ki(p#ki(w#ki(x#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#u#ki~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO(_VO(x#}Oa#ki!Z#ki#y#ki#z#ki'x#ki(p#ki(w#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#w$UO~P#:_O#w#ki~P#:_O#u$SO~P#7wOP$[OR#zO[$cOp$aO!O#yO!Q#{O!j#xO!n$[O#P$RO#l$OO#m$PO#n$PO#o$PO#p$QO#q$RO#r$RO#s$bO#t$RO#u$SO#w$UO(_VO(w#|O(x#}Oa#ki!Z#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~O#y#ki~P#=TO#y$WO~P#=TOP]XR]X[]Xp]X!O]X!Q]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X!Z]X![]X~O#}]X~P#?rOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO#y<XO#z<YO(_VO(p$YO(w#|O(x#}O~O#}.vO~P#BPO#Q$dO#^<`O$P<`O#}(eX![(eX~P! dOa'ba!Z'ba'x'ba'u'ba!i'ba!W'bat'ba!]'ba%h'ba!e'ba~P!:TO[#kia#kip#ki!Z#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki'x#ki(p#ki'u#ki!W#ki!i#kit#ki!]#ki%h#ki!e#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l$OO#m$PO#n$PO#o$PO(_VO(w#ki(x#ki~P#EROl=|O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P#ERO!Z.zOg(nX~P!0uOg.|O~Oa$Oi!Z$Oi'x$Oi'u$Oi!W$Oi!i$Oit$Oi!]$Oi%h$Oi!e$Oi~P!:TO$[.}O$^.}O~O$[/OO$^/OO~O!e)fO#^/PO!]$bX$Y$bX$[$bX$^$bX$e$bX~O!Y/QO~O!])iO$Y/SO$[)hO$^)hO$e/TO~O!Z<ZO![(dX~P#BPO![/UO~O!e)fO$e(yX~O$e/WO~Ot/XO~P!&iOv)wO(`)xO(a/[O~O!Q/_O~O(w$}Ol%`a!O%`a'w%`a(x%`a!Z%`a#^%`a~Og%`a#}%`a~P#LTO(x%POl%ba!O%ba'w%ba(w%ba!Z%ba#^%ba~Og%ba#}%ba~P#LvO!ZfX!efX!ifX!i$yX(pfX~P!/qO!Y/hO!Z([O(R/gO!W(tP!W(}P~P!1dOp*pO!`*nO!a*hO!b*hO!j*_O#Y*oO%_*jO(S!lO(TTO(WUO~Oq<oO!Q/iO!Y+XO![*mO(c<nO![(vP~P#NaO!i/jO~P#.{O!Z/kO!e#vO(p'nO!i(|X~O!i/pO~O!Q%gO!Y*[O!]%hO(R%fO!i(|P~O#i/rO~O!W$yX!Z$yX!e%QX~P!/qO!Z/sO!W(}X~P#.{O!e/uO~O!W/wO~OnkO(R/xO~P.iOh%VOp/}O!e#vO!j%dO(p'nO~O!e+fO~Oa%mO!Z0RO'x%mO~O![0TO~P!5WO!a0UO!b0UO(S!lO~P##hOq!nO!Q0VO(TTO(WUO(c!mO~O#Y0XO~Og%`a!Z%`a#^%`a#}%`a~P!0uOg%ba!Z%ba#^%ba#}%ba~P!0uOj%cO(R&XOg'kX!Z'kX~O!Z*vOg([a~Og0bO~OR0cO!O0cO!Q0dO#Q$dOl{a'w{a(w{a(x{a!Z{a#^{a~Og{a#}{a~P$&dO!O)|O'w)}Ol$ra(w$ra(x$ra!Z$ra#^$ra~Og$ra#}$ra~P$'`O!O)|O'w)}Ol$ta(w$ta(x$ta!Z$ta#^$ta~Og$ta#}$ta~P$(RO#i0gO~Og%Sa!Z%Sa#^%Sa#}%Sa~P!0uOl0iO#^0hOg(]a!Z(]a~O!e#vO~O#i0lO~O!Z+ZOa)Ra'x)Ra~OR#zO!O#yO!Q#{O!j#xO(_VOP!pi[!pip!pi!Z!pi!n!pi#P!pi#l!pi#m!pi#n!pi#o!pi#p!pi#q!pi#r!pi#s!pi#t!pi#u!pi#w!pi#y!pi#z!pi(p!pi(w!pi(x!pi~Oa!pi'x!pi'u!pi!W!pi!i!pit!pi!]!pi%h!pi!e!pi~P$*OOh%VOp%XOq$tOr$tOx%YOz%ZO|<eO!Q${O!]$|O!g=vO!j$xO#h<kO$V%_O$s<gO$u<iO$x%`O(TTO(WUO(_$uO(w$}O(x%PO~On0vO%[0wO(R0tO~P$,fO!e+fOa(Za!](Za'x(Za!Z(Za~O#i0|O~O[]X!ZfX![fX~O!Z0}O![)VX~O![1PO~O[1QO~Ob1SO(R+nO(TTO(WUO~O!]&OO(R%fO`'sX!Z'sX~O!Z+sO`)Ua~O!i1VO~P!:TO[1YO~O`1ZO~O#^1^O~Ol1aO!]$|O~O(c(zO![)SP~Oh%VOl1jO!]1gO%h1iO~O[1tO!Z1rO![)TX~O![1uO~O`1wOa%mO'x%mO~O(R#nO(TTO(WUO~O#Q$dO#^$eO$P$eOP(eXR(eX[(eXp(eX!O(eX!Q(eX!Z(eX!j(eX!n(eX#P(eX#l(eX#m(eX#n(eX#o(eX#p(eX#q(eX#r(eX#s(eX#u(eX#w(eX#y(eX#z(eX(_(eX(p(eX(w(eX(x(eX~O#t1zO&Y1{Oa(eX~P$2PO#^$eO#t1zO&Y1{O~Oa1}O~P%[Oa2PO~O&c2SOP&aiQ&aiS&aiY&aia&aid&aie&aij&ain&aip&aiq&air&aix&aiz&ai|&ai!Q&ai!U&ai!V&ai!]&ai!g&ai!j&ai!m&ai!n&ai!o&ai!q&ai!s&ai!v&ai!z&ai$V&ai$m&ai%g&ai%i&ai%k&ai%l&ai%m&ai%p&ai%r&ai%u&ai%v&ai%x&ai&U&ai&[&ai&^&ai&`&ai&b&ai&e&ai&k&ai&q&ai&s&ai&u&ai&w&ai&y&ai'u&ai(R&ai(T&ai(W&ai(_&ai(m&ai![&aib&ai&h&ai~Ob2YO![2WO&h2XO~P`O!]XO!j2[O~O&o,vOP&jiQ&jiS&jiY&jia&jid&jie&jij&jin&jip&jiq&jir&jix&jiz&ji|&ji!Q&ji!U&ji!V&ji!]&ji!g&ji!j&ji!m&ji!n&ji!o&ji!q&ji!s&ji!v&ji!z&ji$V&ji$m&ji%g&ji%i&ji%k&ji%l&ji%m&ji%p&ji%r&ji%u&ji%v&ji%x&ji&U&ji&[&ji&^&ji&`&ji&b&ji&e&ji&k&ji&q&ji&s&ji&u&ji&w&ji&y&ji'u&ji(R&ji(T&ji(W&ji(_&ji(m&ji![&ji&c&jib&ji&h&ji~O!W2bO~O!Z!_a![!_a~P#BPOq!nO!Q!oO!Y2hO(c!mO!Z'VX!['VX~P@]O!Z-WO![(ga~O!Z']X![']X~P!9]O!Z-ZO![(va~O![2oO~P'_Oa%mO#^2xO'x%mO~Oa%mO!e#vO#^2xO'x%mO~Oa%mO!e#vO!n2|O#^2xO'x%mO(p'nO~Oa%mO'x%mO~P!:TO!Z$_Ot$pa~O!W'Ui!Z'Ui~P!:TO!Z(TO!W(fi~O!Z([O!W(ti~O!W(ui!Z(ui~P!:TO!Z(ri!i(ria(ri'x(ri~P!:TO#^3OO!Z(ri!i(ria(ri'x(ri~O!Z(hO!i(qi~O!Q%gO!]%hO!z]O#g3TO#h3SO(R%fO~O!Q%gO!]%hO#h3SO(R%fO~Ol3[O!]'^O%h3ZO~Oh%VOl3[O!]'^O%h3ZO~O#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`at%`a!]%`a%h%`a!e%`a~P#LTO#i%baP%baR%ba[%baa%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%bat%ba!]%ba%h%ba!e%ba~P#LvO#i%`aP%`aR%`a[%`aa%`ap%`a!Q%`a!Z%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a'x%`a(_%`a(p%`a!i%`a!W%`a'u%`a#^%`at%`a!]%`a%h%`a!e%`a~P#.{O#i%baP%baR%ba[%baa%bap%ba!Q%ba!Z%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba'x%ba(_%ba(p%ba!i%ba!W%ba'u%ba#^%bat%ba!]%ba%h%ba!e%ba~P#.{O#i{aP{a[{aa{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a'x{a(_{a(p{a!i{a!W{a'u{at{a!]{a%h{a!e{a~P$&dO#i$raP$raR$ra[$raa$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra'x$ra(_$ra(p$ra!i$ra!W$ra'u$rat$ra!]$ra%h$ra!e$ra~P$'`O#i$taP$taR$ta[$taa$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta'x$ta(_$ta(p$ta!i$ta!W$ta'u$tat$ta!]$ta%h$ta!e$ta~P$(RO#i%SaP%SaR%Sa[%Saa%Sap%Sa!Q%Sa!Z%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa'x%Sa(_%Sa(p%Sa!i%Sa!W%Sa'u%Sa#^%Sat%Sa!]%Sa%h%Sa!e%Sa~P#.{Oa#aq!Z#aq'x#aq'u#aq!W#aq!i#aqt#aq!]#aq%h#aq!e#aq~P!:TO!Y3dO!Z'WX!i'WX~P%[O!Z.oO!i(ia~O!Z.oO!i(ia~P!:TO!W3gO~O#}!la![!la~PKZO#}!ha!Z!ha![!ha~P#BPO#}!pa![!pa~P!<kO#}!ra![!ra~P!?ROg'ZX!Z'ZX~P!+rO!Z.zOg(na~OSfO!]3{O$c3|O~O![4QO~Ot4RO~P#.{Oa$lq!Z$lq'x$lq'u$lq!W$lq!i$lqt$lq!]$lq%h$lq!e$lq~P!:TO!W4TO~P!&iO!Q4UO~O!O)|O'w)}O(x%POl'ga(w'ga!Z'ga#^'ga~Og'ga#}'ga~P%+uO!O)|O'w)}Ol'ia(w'ia(x'ia!Z'ia#^'ia~Og'ia#}'ia~P%,hO(p$YO~P#.{O!WfX!W$yX!ZfX!Z$yX!e%QX#^fX~P!/qO(R<xO~P!1dO!Q%gO!Y4XO!]%hO(R%fO!Z'cX!i'cX~O!Z/kO!i(|a~O!Z/kO!e#vO!i(|a~O!Z/kO!e#vO(p'nO!i(|a~Og${i!Z${i#^${i#}${i~P!0uO!Y4aO!W'eX!Z'eX~P!3cO!Z/sO!W(}a~O!Z/sO!W(}a~P#.{OP]XR]X[]Xp]X!O]X!Q]X!W]X!Z]X!j]X!n]X#P]X#Q]X#^]X#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!e%XX#t%XX~P%0XO!e#vO#t4fO~Oh%VO!e#vO!j%dO~Oh%VOp4kO!j%dO(p'nO~Op4pO!e#vO(p'nO~Oq!nO!Q4qO(TTO(WUO(c!mO~O(w$}Ol%`i!O%`i'w%`i(x%`i!Z%`i#^%`i~Og%`i#}%`i~P%3xO(x%POl%bi!O%bi'w%bi(w%bi!Z%bi#^%bi~Og%bi#}%bi~P%4kOg(]i!Z(]i~P!0uO#^4wOg(]i!Z(]i~P!0uO!i4zO~Oa$nq!Z$nq'x$nq'u$nq!W$nq!i$nqt$nq!]$nq%h$nq!e$nq~P!:TO!W5QO~O!Z5RO!])OX~P#.{Oa]Xa$yX!]]X!]$yX%]]X'x]X'x$yX!Z]X!Z$yX~P!/qO%]5UOa%Za!]%Za'x%Za!Z%Za~OlmX!OmX'wmX(wmX(xmX~P%7nOn5VO(R#nO~Ob5]O%i5^O(R+nO(TTO(WUO!Z'rX!['rX~O!Z0}O![)Va~O[5bO~O`5cO~Oa%mO'x%mO~P#.{O!Z5kO#^5mO![)SX~O![5nO~Op5tOq!nO!Q*fO!`!yO!a!vO!b!vO!z;wO#R!pO#S!pO#T!pO#U!pO#V!pO#Y5sO#Z!zO(S!lO(TTO(WUO(c!mO(m!sO~O![5rO~P%:ROl5yO!]1gO%h5xO~Oh%VOl5yO!]1gO%h5xO~Ob6QO(R#nO(TTO(WUO!Z'qX!['qX~O!Z1rO![)Ta~O(TTO(WUO(c6SO~O`6WO~O#t6ZO&Y6[O~PMvO!i6]O~P%[Oa6_O~Oa6_O~P%[Ob2YO![6dO&h2XO~P`O!e6fO~O!e6hOh(hi!Z(hi![(hi!e(hi!j(hip(hi(p(hi~O!Z#fi![#fi~P#BPO#^6iO!Z#fi![#fi~O!Z!_i![!_i~P#BPOa%mO#^6rO'x%mO~Oa%mO!e#vO#^6rO'x%mO~O!Z(rq!i(rqa(rq'x(rq~P!:TO!Z(hO!i(qq~O!Q%gO!]%hO#h6yO(R%fO~O!]'^O%h6|O~Ol7QO!]'^O%h6|O~O#i'gaP'gaR'ga['gaa'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga'x'ga(_'ga(p'ga!i'ga!W'ga'u'gat'ga!]'ga%h'ga!e'ga~P%+uO#i'iaP'iaR'ia['iaa'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia'x'ia(_'ia(p'ia!i'ia!W'ia'u'iat'ia!]'ia%h'ia!e'ia~P%,hO#i${iP${iR${i[${ia${ip${i!Q${i!Z${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i'x${i(_${i(p${i!i${i!W${i'u${i#^${it${i!]${i%h${i!e${i~P#.{O#i%`iP%`iR%`i[%`ia%`ip%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i'x%`i(_%`i(p%`i!i%`i!W%`i'u%`it%`i!]%`i%h%`i!e%`i~P%3xO#i%biP%biR%bi[%bia%bip%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi'x%bi(_%bi(p%bi!i%bi!W%bi'u%bit%bi!]%bi%h%bi!e%bi~P%4kO!Z'Wa!i'Wa~P!:TO!Z.oO!i(ii~O#}#ai!Z#ai![#ai~P#BPOP$[OR#zO!O#yO!Q#{O!j#xO!n$[O(_VO[#kip#ki#P#ki#m#ki#n#ki#o#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#l#ki~P%MQO#l<PO~P%MQOP$[OR#zOp<]O!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO[#ki#P#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#p#ki~P& YO#p<RO~P& YOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO(_VO#w#ki#y#ki#z#ki#}#ki(p#ki(w#ki(x#ki!Z#ki![#ki~O#u#ki~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO(_VO(x#}O#y#ki#z#ki#}#ki(p#ki(w#ki!Z#ki![#ki~O#w<VO~P&%cO#w#ki~P&%cO#u<TO~P&#bOP$[OR#zO[<_Op<]O!O#yO!Q#{O!j#xO!n$[O#P<SO#l<PO#m<QO#n<QO#o<QO#p<RO#q<SO#r<SO#s<^O#t<SO#u<TO#w<VO(_VO(w#|O(x#}O#z#ki#}#ki(p#ki!Z#ki![#ki~O#y#ki~P&'rO#y<XO~P&'rOa#{y!Z#{y'x#{y'u#{y!W#{y!i#{yt#{y!]#{y%h#{y!e#{y~P!:TO[#kip#ki#P#ki#p#ki#q#ki#r#ki#s#ki#t#ki#u#ki#w#ki#y#ki#z#ki#}#ki(p#ki!Z#ki![#ki~OP$[OR#zO!O#yO!Q#{O!j#xO!n$[O#l<PO#m<QO#n<QO#o<QO(_VO(w#ki(x#ki~P&*nOl=}O!O)|O'w)}O(w$}O(x%POP#kiR#ki!Q#ki!j#ki!n#ki#l#ki#m#ki#n#ki#o#ki(_#ki~P&*nO#Q$dOP(^XR(^X[(^Xl(^Xp(^X!O(^X!Q(^X!j(^X!n(^X#P(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#s(^X#t(^X#u(^X#w(^X#y(^X#z(^X#}(^X'w(^X(_(^X(p(^X(w(^X(x(^X!Z(^X![(^X~O#}$Oi!Z$Oi![$Oi~P#BPO#}!pi![!pi~P$*OOg'Za!Z'Za~P!0uO![7dO~O!Z'ba!['ba~P#BPO!W7eO~P#.{O!e#vO(p'nO!Z'ca!i'ca~O!Z/kO!i(|i~O!Z/kO!e#vO!i(|i~Og${q!Z${q#^${q#}${q~P!0uO!W'ea!Z'ea~P#.{O!e7lO~O!Z/sO!W(}i~P#.{O!Z/sO!W(}i~O!W7oO~Oh%VOp7tO!j%dO(p'nO~O!e#vO#t7vO~Op7yO!e#vO(p'nO~O!O)|O'w)}O(x%POl'ha(w'ha!Z'ha#^'ha~Og'ha#}'ha~P&3oO!O)|O'w)}Ol'ja(w'ja(x'ja!Z'ja#^'ja~Og'ja#}'ja~P&4bO!W7{O~Og$}q!Z$}q#^$}q#}$}q~P!0uOg(]q!Z(]q~P!0uO#^7|Og(]q!Z(]q~P!0uOa$ny!Z$ny'x$ny'u$ny!W$ny!i$nyt$ny!]$ny%h$ny!e$ny~P!:TO!e6hO~O!Z5RO!])Oa~O!]'^OP$SaR$Sa[$Sap$Sa!O$Sa!Q$Sa!Z$Sa!j$Sa!n$Sa#P$Sa#l$Sa#m$Sa#n$Sa#o$Sa#p$Sa#q$Sa#r$Sa#s$Sa#t$Sa#u$Sa#w$Sa#y$Sa#z$Sa(_$Sa(p$Sa(w$Sa(x$Sa~O%h6|O~P&7SO%]8QOa%Zi!]%Zi'x%Zi!Z%Zi~Oa#ay!Z#ay'x#ay'u#ay!W#ay!i#ayt#ay!]#ay%h#ay!e#ay~P!:TO[8SO~Ob8UO(R+nO(TTO(WUO~O!Z0}O![)Vi~O`8YO~O(c(zO!Z'nX!['nX~O!Z5kO![)Sa~O![8cO~P%:RO(m!sO~P$$oO#Y8dO~O!]1gO~O!]1gO%h8fO~Ol8iO!]1gO%h8fO~O[8nO!Z'qa!['qa~O!Z1rO![)Ti~O!i8rO~O!i8sO~O!i8vO~O!i8vO~P%[Oa8xO~O!e8yO~O!i8zO~O!Z(ui![(ui~P#BPOa%mO#^9SO'x%mO~O!Z(ry!i(rya(ry'x(ry~P!:TO!Z(hO!i(qy~O%h9VO~P&7SO!]'^O%h9VO~O#i${qP${qR${q[${qa${qp${q!Q${q!Z${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q'x${q(_${q(p${q!i${q!W${q'u${q#^${qt${q!]${q%h${q!e${q~P#.{O#i'haP'haR'ha['haa'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha'x'ha(_'ha(p'ha!i'ha!W'ha'u'hat'ha!]'ha%h'ha!e'ha~P&3oO#i'jaP'jaR'ja['jaa'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja'x'ja(_'ja(p'ja!i'ja!W'ja'u'jat'ja!]'ja%h'ja!e'ja~P&4bO#i$}qP$}qR$}q[$}qa$}qp$}q!Q$}q!Z$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q'x$}q(_$}q(p$}q!i$}q!W$}q'u$}q#^$}qt$}q!]$}q%h$}q!e$}q~P#.{O!Z'Wi!i'Wi~P!:TO#}#aq!Z#aq![#aq~P#BPO(w$}OP%`aR%`a[%`ap%`a!Q%`a!j%`a!n%`a#P%`a#l%`a#m%`a#n%`a#o%`a#p%`a#q%`a#r%`a#s%`a#t%`a#u%`a#w%`a#y%`a#z%`a#}%`a(_%`a(p%`a!Z%`a![%`a~Ol%`a!O%`a'w%`a(x%`a~P&HgO(x%POP%baR%ba[%bap%ba!Q%ba!j%ba!n%ba#P%ba#l%ba#m%ba#n%ba#o%ba#p%ba#q%ba#r%ba#s%ba#t%ba#u%ba#w%ba#y%ba#z%ba#}%ba(_%ba(p%ba!Z%ba![%ba~Ol%ba!O%ba'w%ba(w%ba~P&JnOl=}O!O)|O'w)}O(x%PO~P&HgOl=}O!O)|O'w)}O(w$}O~P&JnOR0cO!O0cO!Q0dO#Q$dOP{a[{al{ap{a!j{a!n{a#P{a#l{a#m{a#n{a#o{a#p{a#q{a#r{a#s{a#t{a#u{a#w{a#y{a#z{a#}{a'w{a(_{a(p{a(w{a(x{a!Z{a![{a~O!O)|O'w)}OP$raR$ra[$ral$rap$ra!Q$ra!j$ra!n$ra#P$ra#l$ra#m$ra#n$ra#o$ra#p$ra#q$ra#r$ra#s$ra#t$ra#u$ra#w$ra#y$ra#z$ra#}$ra(_$ra(p$ra(w$ra(x$ra!Z$ra![$ra~O!O)|O'w)}OP$taR$ta[$tal$tap$ta!Q$ta!j$ta!n$ta#P$ta#l$ta#m$ta#n$ta#o$ta#p$ta#q$ta#r$ta#s$ta#t$ta#u$ta#w$ta#y$ta#z$ta#}$ta(_$ta(p$ta(w$ta(x$ta!Z$ta![$ta~Ol=}O!O)|O'w)}O(w$}O(x%PO~OP%SaR%Sa[%Sap%Sa!Q%Sa!j%Sa!n%Sa#P%Sa#l%Sa#m%Sa#n%Sa#o%Sa#p%Sa#q%Sa#r%Sa#s%Sa#t%Sa#u%Sa#w%Sa#y%Sa#z%Sa#}%Sa(_%Sa(p%Sa!Z%Sa![%Sa~P'%sO#}$lq!Z$lq![$lq~P#BPO#}$nq!Z$nq![$nq~P#BPO![9dO~O#}9eO~P!0uO!e#vO!Z'ci!i'ci~O!e#vO(p'nO!Z'ci!i'ci~O!Z/kO!i(|q~O!W'ei!Z'ei~P#.{O!Z/sO!W(}q~Op9lO!e#vO(p'nO~O[9nO!W9mO~P#.{O!W9mO~O!e#vO#t9tO~Og(]y!Z(]y~P!0uO!Z'la!]'la~P#.{Oa%Zq!]%Zq'x%Zq!Z%Zq~P#.{O[9yO~O!Z0}O![)Vq~O#^9}O!Z'na!['na~O!Z5kO![)Si~P#BPO!Q:PO~O!]1gO%h:SO~O(TTO(WUO(c:XO~O!Z1rO![)Tq~O!i:[O~O!i:]O~O!i:^O~O!i:^O~P%[O#^:aO!Z#fy![#fy~O!Z#fy![#fy~P#BPO%h:fO~P&7SO!]'^O%h:fO~O#}#{y!Z#{y![#{y~P#BPOP${iR${i[${ip${i!Q${i!j${i!n${i#P${i#l${i#m${i#n${i#o${i#p${i#q${i#r${i#s${i#t${i#u${i#w${i#y${i#z${i#}${i(_${i(p${i!Z${i![${i~P'%sO!O)|O'w)}O(x%POP'gaR'ga['gal'gap'ga!Q'ga!j'ga!n'ga#P'ga#l'ga#m'ga#n'ga#o'ga#p'ga#q'ga#r'ga#s'ga#t'ga#u'ga#w'ga#y'ga#z'ga#}'ga(_'ga(p'ga(w'ga!Z'ga!['ga~O!O)|O'w)}OP'iaR'ia['ial'iap'ia!Q'ia!j'ia!n'ia#P'ia#l'ia#m'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#w'ia#y'ia#z'ia#}'ia(_'ia(p'ia(w'ia(x'ia!Z'ia!['ia~O(w$}OP%`iR%`i[%`il%`ip%`i!O%`i!Q%`i!j%`i!n%`i#P%`i#l%`i#m%`i#n%`i#o%`i#p%`i#q%`i#r%`i#s%`i#t%`i#u%`i#w%`i#y%`i#z%`i#}%`i'w%`i(_%`i(p%`i(x%`i!Z%`i![%`i~O(x%POP%biR%bi[%bil%bip%bi!O%bi!Q%bi!j%bi!n%bi#P%bi#l%bi#m%bi#n%bi#o%bi#p%bi#q%bi#r%bi#s%bi#t%bi#u%bi#w%bi#y%bi#z%bi#}%bi'w%bi(_%bi(p%bi(w%bi!Z%bi![%bi~O#}$ny!Z$ny![$ny~P#BPO#}#ay!Z#ay![#ay~P#BPO!e#vO!Z'cq!i'cq~O!Z/kO!i(|y~O!W'eq!Z'eq~P#.{Op:pO!e#vO(p'nO~O[:tO!W:sO~P#.{O!W:sO~Og(]!R!Z(]!R~P!0uOa%Zy!]%Zy'x%Zy!Z%Zy~P#.{O!Z0}O![)Vy~O!Z5kO![)Sq~O(R:zO~O!]1gO%h:}O~O!i;QO~O%h;VO~P&7SOP${qR${q[${qp${q!Q${q!j${q!n${q#P${q#l${q#m${q#n${q#o${q#p${q#q${q#r${q#s${q#t${q#u${q#w${q#y${q#z${q#}${q(_${q(p${q!Z${q![${q~P'%sO!O)|O'w)}O(x%POP'haR'ha['hal'hap'ha!Q'ha!j'ha!n'ha#P'ha#l'ha#m'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#w'ha#y'ha#z'ha#}'ha(_'ha(p'ha(w'ha!Z'ha!['ha~O!O)|O'w)}OP'jaR'ja['jal'jap'ja!Q'ja!j'ja!n'ja#P'ja#l'ja#m'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#w'ja#y'ja#z'ja#}'ja(_'ja(p'ja(w'ja(x'ja!Z'ja!['ja~OP$}qR$}q[$}qp$}q!Q$}q!j$}q!n$}q#P$}q#l$}q#m$}q#n$}q#o$}q#p$}q#q$}q#r$}q#s$}q#t$}q#u$}q#w$}q#y$}q#z$}q#}$}q(_$}q(p$}q!Z$}q![$}q~P'%sOg%d!Z!Z%d!Z#^%d!Z#}%d!Z~P!0uO!W;ZO~P#.{Op;[O!e#vO(p'nO~O[;^O!W;ZO~P#.{O!Z'nq!['nq~P#BPO!Z#f!Z![#f!Z~P#BPO#i%d!ZP%d!ZR%d!Z[%d!Za%d!Zp%d!Z!Q%d!Z!Z%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z'x%d!Z(_%d!Z(p%d!Z!i%d!Z!W%d!Z'u%d!Z#^%d!Zt%d!Z!]%d!Z%h%d!Z!e%d!Z~P#.{Op;fO!e#vO(p'nO~O!W;gO~P#.{Op;nO!e#vO(p'nO~O!W;oO~P#.{OP%d!ZR%d!Z[%d!Zp%d!Z!Q%d!Z!j%d!Z!n%d!Z#P%d!Z#l%d!Z#m%d!Z#n%d!Z#o%d!Z#p%d!Z#q%d!Z#r%d!Z#s%d!Z#t%d!Z#u%d!Z#w%d!Z#y%d!Z#z%d!Z#}%d!Z(_%d!Z(p%d!Z!Z%d!Z![%d!Z~P'%sOp;rO!e#vO(p'nO~Ot(dX~P1qO!O%qO~P!(yO(S!lO~P!(yO!WfX!ZfX#^fX~P%0XOP]XR]X[]Xp]X!O]X!Q]X!Z]X!ZfX!j]X!n]X#P]X#Q]X#^]X#^fX#ifX#l]X#m]X#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#w]X#y]X#z]X$P]X(_]X(p]X(w]X(x]X~O!efX!i]X!ifX(pfX~P'JlOP;vOQ;vOSfOd=rOe!iOnkOp;vOqkOrkOxkOz;vO|;vO!QWO!UkO!VkO!]XO!g;yO!jZO!m;vO!n;vO!o;vO!q;zO!s;}O!v!hO$V!kO$m=pO(R)ZO(TTO(WUO(_VO(m[O~O!Z<ZO![$pa~Oh%VOn%WOp%XOq$tOr$tOx%YOz%ZO|<fO!Q${O!]$|O!g=wO!j$xO#h<lO$V%_O$s<hO$u<jO$x%`O(R(tO(TTO(WUO(_$uO(w$}O(x%PO~Oj)bO~P( bOp!cX(p!cX~P# qOp(hX(p(hX~P#!dO![]X![fX~P'JlO!WfX!W$yX!ZfX!Z$yX#^fX~P!/qO#i<OO~O!e#vO#i<OO~O#^<`O~O#t<SO~O#^<pO!Z(uX![(uX~O#^<`O!Z(sX![(sX~O#i<qO~Og<sO~P!0uO#i<yO~O#i<zO~O!e#vO#i<{O~O!e#vO#i<qO~O#}<|O~P#BPO#i<}O~O#i=OO~O#i=TO~O#i=UO~O#i=VO~O#i=WO~O#}=XO~P!0uO#}=YO~P!0uO#Q#R#S#U#V#Y#g#h#s$m$s$u$x%[%]%g%h%i%p%r%u%v%x%z~'|T#m!V'z(S#nq#l#op!O'{$['{(R$^(c~",goto:"$8f)ZPPPPPP)[PP)_P)pP+Q/VPPPP6aPP6wPP<oP@cP@yP@yPPP@yPCRP@yP@yP@yPCVPC[PCyPHsPPPHwPPPPHwKzPPPLQLrPHwPHwPP! QHwPPPHwPHwP!#XHwP!&o!'t!'}P!(q!(u!(q!,SPPPPPPP!,s!'tPP!-T!.uP!2RHwHw!2W!5d!:Q!:Q!>PPPP!>XHwPPPPPPPPPP!AhP!BuPPHw!DWPHwPHwHwHwHwHwPHw!EjP!HtP!KzP!LO!LY!L^!L^P!HqP!Lb!LbP# hP# lHwPHw# r#$wCV@yP@yP@y@yP#&U@y@y#(h@y#+`@y#-l@y@y#.[#0p#0p#0u#1O#0p#1ZPP#0pP@y#1s@y#5r@y@y6aPPP#9wPPP#:b#:bP#:bP#:x#:bPP#;OP#:uP#:u#;c#:u#;}#<T#<W)_#<Z)_P#<b#<b#<bP)_P)_P)_P)_PP)_P#<h#<kP#<k)_P#<oP#<rP)_P)_P)_P)_P)_P)_)_PP#<x#=O#=Z#=a#=g#=m#=s#>R#>X#>c#>i#>s#>y#?Z#?a#@R#@e#@k#@q#AP#Af#CZ#Ci#Cp#E[#Ej#G[#Gj#Gp#Gv#G|#HW#H^#Hd#Hn#IQ#IWPPPPPPPPPPP#I^PPPPPPP#JR#MY#Nr#Ny$ RPPP$&mP$&v$)o$0Y$0]$0`$1_$1b$1i$1qP$1w$1zP$2h$2l$3d$4r$4w$5_PP$5d$5j$5n$5q$5u$5y$6u$7^$7u$7y$7|$8P$8V$8Y$8^$8bR!|RoqOXst!Z#d%l&p&r&s&u,n,s2S2VY!vQ'^-`1g5qQ%svQ%{yQ&S|Q&h!VS'U!e-WQ'd!iS'j!r!yU*h$|*X*lQ+l%|Q+y&UQ,_&bQ-^']Q-h'eQ-p'kQ0U*nQ1q,`R<m;z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9SS#q];w!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU*{%[<e<fQ+q&OQ,a&eQ,h&mQ0r+dQ0u+fQ1S+rQ1y,fQ3W.bQ5V0wQ5]0}Q6Q1rQ7O3[Q8U5^R9Y7Q'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s!S!nQ!r!v!y!z$|'U']'^'j'k'l*h*l*n*o-W-^-`-p0U0X1g5q5s%[$ti#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q&V|Q'S!eS'Y%h-ZQ+q&OQ,a&eQ0f+OQ1S+rQ1X+xQ1x,eQ1y,fQ5]0}Q5f1ZQ6Q1rQ6T1tQ6U1wQ8U5^Q8X5cQ8q6WQ9|8YQ:Y8nR<o*XrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR,c&i&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=r=s[#]WZ#W#Z'V(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ%vxQ%zyS&P|&UQ&]!TQ'a!hQ'c!iQ(o#sS+k%{%|Q+o&OQ,Y&`Q,^&bS-g'd'eQ.d(pQ0{+lQ1R+rQ1T+sQ1W+wQ1l,ZS1p,_,`Q2t-hQ5[0}Q5`1QQ5e1YQ6P1qQ8T5^Q8W5bQ9x8SR:w9y!U$zi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y!^%xy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pQ+e%vQ,O&YQ,R&ZQ,]&bQ.c(oQ1k,YU1o,^,_,`Q3].dQ5z1lS6O1p1qQ8m6P#f=t#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o=u<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YW%Ti%V*v=pS&Y!Q&gQ&Z!RQ&[!SQ+S%cR+|&W%]%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}T)x$u)yV*{%[<e<fW'Y!e%h*X-ZS({#y#zQ+`%qQ+v&RS.](k(lQ1b,SQ4x0cR8^5k'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s$i$^c#Y#e%p%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.w.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ'W!eR2i-W!W!nQ!e!r!v!y!z$|'U']'^'j'k'l*X*h*l*n*o-W-^-`-p0U0X1g5q5sR1d,UnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&w!^Q't!xS(q#u<OQ+i%yQ,W&]Q,X&_Q-e'bQ-r'mS.m(v<qS0k+U<{Q0y+jQ1f,VQ2Z,uQ2],vQ2e-RQ2r-fQ2u-jS5P0l=VQ5W0zS5Z0|=WQ6j2gQ6n2sQ6s2zQ8R5XQ8}6lQ9O6oQ9R6tR:`8z$d$]c#Y#e%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gS(m#p'gQ(}#zS+_%p.wS.^(l(nR3U._'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS#q];wQ&r!XQ&s!YQ&u![Q&v!]R2R,qQ'_!hQ+b%vQ-c'aS.`(o+eQ2p-bW3Y.c.d0q0sQ6m2qW6z3V3X3]5TU9U6{6}7PU:e9W9X9ZS;T:d:gQ;b;UR;j;cU!wQ'^-`T5o1g5q!Q_OXZ`st!V!Z#d#h%d%l&g&i&p&r&s&u(h,n,s.V2S2V]!pQ!r'^-`1g5qT#q];w%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS({#y#zS.](k(l!s=^$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU$fd)],hS(n#p'gU*s%R(u3vU0e*z.i7]Q5T0rQ6{3WQ9X7OR:g9Ym!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sQ'r!uS(d#g1|S-n'i'uQ/n*ZQ/{*gQ2|-qQ4]/oQ4i/}Q4j0OQ4o0WQ7h4WS7s4k4mS7w4p4rQ9g7iQ9k7oQ9p7tQ9u7yS:o9l9mS;Y:p:sS;e;Z;[S;m;f;gS;q;n;oR;t;rQ#wbQ'q!uS(c#g1|S(e#m+TQ+V%eQ+g%wQ+m%}U-m'i'r'uQ.R(dQ/m*ZQ/|*gQ0P*iQ0x+hQ1m,[S2y-n-qQ3R.ZS4[/n/oQ4e/yS4h/{0WQ4l0QQ5|1nQ6u2|Q7g4WQ7k4]U7r4i4o4rQ7u4nQ8k5}S9f7h7iQ9j7oQ9r7wQ9s7xQ:V8lQ:m9gS:n9k9mQ:v9uQ;P:WS;X:o:sS;d;Y;ZS;l;e;gS;p;m;oQ;s;qQ;u;tQ=a=[Q=l=eR=m=fV!wQ'^-`%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS#wz!j!r=Z$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=a=r%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SQ%ej!^%wy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pS%}z!jQ+h%xQ,[&bW1n,],^,_,`U5}1o1p1qS8l6O6PQ:W8m!r=[$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ=e=qR=f=r%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SY#bWZ#W#Z(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ,i&m!p=]$Z$n)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=`'VU'Z!e%h*XR2k-Z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9S!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ,h&mQ0r+dQ3W.bQ7O3[R9Y7Q!b$Tc#Y%p(Q(W(r(w)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!P<U)[)o-U.w2c2f3h3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!f$Vc#Y%p(Q(W(r(w)U)V)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!T<W)[)o-U.w2c2f3h3n3o3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!^$Zc#Y%p(Q(W(r(w)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;xQ4V/fz=s)[)o-U.w2c2f3h3w4P6k7W7a7b8`8|9[9b9c:y;R=gQ=x=zR=y={'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS$oh$pR3|/P'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$kf$qQ$ifS)h$l)lR)t$qT$jf$qT)j$l)l'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$oh$pQ$rhR)s$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9S!s=q$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s#glOPXZst!Z!`!o#S#d#o#{$n%l&i&l&m&p&r&s&u&y'R'`(|)q*f+Y+d,k,n,s-d.b/Q/i0V0d1j1z1{1}2P2S2V2X3[3{4q5y6Z6[6_7Q8i8x!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}Q+P%`Q/^)|o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!U$yi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yQ*`$zU*i$|*X*lQ+Q%aQ0Q*j#f=c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n=d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YQ=h=tQ=i=uQ=j=vR=k=w!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YnoOXst!Z#d%l&p&r&s&u,n,s2S2VS*c${*WQ,|&|Q,}'OR4`/s%[%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q,P&ZQ1`,RQ5i1_R8]5jV*k$|*X*lU*k$|*X*lT5p1g5qS/y*f/iQ4n0VT7x4q:PQ+g%wQ0P*iQ0x+hQ1m,[Q5|1nQ8k5}Q:V8lR;P:W!U%Oi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yx*P$v)c*Q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=oS0Y*q0Z#f<a#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<b<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!d<t(s)a*Y*b.e.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={`<u3u7X7[7`9]:h:k;kS=P.g3aT=Q7Z9`!U%Qi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y|*R$v)c*S*q+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=oS0[*r0]#f<c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!h<v(s)a*Y*b.f.g.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={d<w3u7Y7Z7`9]9^:h:i:k;kS=R.h3bT=S7[9arnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ&d!UR,k&mrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR&d!UQ,T&[R1[+|snOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ1h,YS5w1k1lU8e5u5v5zS:R8g8hS:{:Q:TQ;_:|R;i;`Q&k!VR,d&gR6T1tR:Y8nS&P|&UR1T+sQ&p!WR,n&qR,t&vT2T,s2VR,x&wQ,w&wR2^,xQ'w!{R-t'wSsOtQ#dXT%os#dQ#OTR'y#OQ#RUR'{#RQ)y$uR/Z)yQ#UVR(O#UQ#XWU(U#X(V-{Q(V#YR-{(WQ-X'WR2j-XQ.p(wS3e.p3fR3f.qQ-`'^R2n-`Y!rQ'^-`1g5qR'h!rQ.{)cR3z.{U#_W%g*WU(]#_(^-|Q(^#`R-|(XQ-['ZR2l-[t`OXst!V!Z#d%l&g&i&p&r&s&u,n,s2S2VS#hZ%dU#r`#h.VR.V(hQ(i#jQ.S(eW.[(i.S3P6wQ3P.TR6w3QQ)l$lR/R)lQ$phR)r$pQ$`cU)_$`-w<[Q-w;xR<[)oQ/l*ZW4Y/l4Z7j9hU4Z/m/n/oS7j4[4]R9h7k$e*O$v(s)a)c*Y*b*q*r*|*}+R.g.h.j.k.l/Y/b/d/f/q/v0^0_0p1]3^3_3`3u3y4S4^4_4c4s4u4{4|4}5h7R7S7T7U7Z7[7^7_7`7f7m7p7z7}8P9]9^9_9i9q9v9w:h:i:j:k:l:q:u;W;];h;k=b=n=o=z={Q/t*bU4b/t4d7nQ4d/vR7n4cS*l$|*XR0S*lx*Q$v)c*q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=o!d.e(s)a*Y*b.g.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/c*Q.e7Xa7X3u7Z7[7`9]:h:k;kQ0Z*qQ3a.gU4t0Z3a9`R9`7Z|*S$v)c*q*r+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=o!h.f(s)a*Y*b.g.h.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/e*S.f7Ye7Y3u7Z7[7`9]9^:h:i:k;kQ0]*rQ3b.hU4v0]3b9aR9a7[Q*w%UR0a*wQ5S0pR8O5SQ+[%jR0o+[Q5l1bS8_5l:OR:O8`Q,V&]R1e,VQ5q1gR8b5qQ1s,aS6R1s8oR8o6TQ1O+oW5_1O5a8V9zQ5a1RQ8V5`R9z8WQ+t&PR1U+tQ2V,sR6c2VYrOXst#dQ&t!ZQ+^%lQ,m&pQ,o&rQ,p&sQ,r&uQ2Q,nS2T,s2VR6b2SQ%npQ&x!_Q&{!aQ&}!bQ'P!cQ'o!uQ+]%kQ+i%yQ+{&VQ,c&kQ,z&zW-k'i'q'r'uQ-r'mQ0R*kQ0y+jS1v,d,gQ2_,yQ2`,|Q2a,}Q2u-jW2w-m-n-q-sQ5W0zQ5d1XQ5g1]Q5{1mQ6V1xQ6a2RU6p2v2y2|Q6s2zQ8R5XQ8Z5fQ8[5hQ8a5pQ8j5|Q8p6US9P6q6uQ9R6tQ9{8XQ:U8kQ:Z8qQ:b9QQ:x9|Q;O:VQ;S:cR;a;PQ%yyQ'b!iQ'm!uU+j%z%{%|Q-R'TU-f'c'd'eS-j'i'sQ/z*gS0z+k+lQ2g-TS2s-g-hQ2z-oS4g/{0OQ5X0{Q6l2mQ6o2tQ6t2{U7q4i4j4mQ9o7sR:r9pS$wi=pR*x%VU%Ui%V=pR0`*vQ$viS(s#v+fS)a$b$cQ)c$dQ*Y$xS*b${*WQ*q%OQ*r%QQ*|%]Q*}%^Q+R%bQ.g<aQ.h<cQ.j<gQ.k<iQ.l<kQ/Y)wQ/b*PQ/d*RQ/f*TQ/q*^S/v*d/hQ0^*tQ0_*ul0p+c,Q.a1a1i3Z5x6|8f9V:S:f:};VQ1]+}Q3^<tQ3_<vQ3`<yS3u<^<_Q3y.zS4S/_4UQ4^/rQ4_/sQ4c/uQ4s0YQ4u0[Q4{0gQ4|0hQ4}0iQ5h1^Q7R<}Q7S=PQ7T=RQ7U=TQ7Z<bQ7[<dQ7^<hQ7_<jQ7`<lQ7f4VQ7m4aQ7p4fQ7z4wQ7}5RQ8P5UQ9]<zQ9^<uQ9_<wQ9i7lQ9q7vQ9v7|Q9w8QQ:h=OQ:i=QQ:j=SQ:k=UQ:l9eQ:q9nQ:u9tQ;W=XQ;]:tQ;h;^Q;k=YQ=b=pQ=n=xQ=o=yQ=z=|R={=}Q*z%[Q.i<eR7]<fnpOXst!Z#d%l&p&r&s&u,n,s2S2VQ!fPS#fZ#oQ&z!`W'f!o*f0V4qQ'}#SQ)O#{Q)p$nS,g&i&lQ,l&mQ,y&yS-O'R/iQ-b'`Q.s(|Q/V)qQ0m+YQ0s+dQ2O,kQ2q-dQ3X.bQ4O/QQ4y0dQ5v1jQ6X1zQ6Y1{Q6^1}Q6`2PQ6e2XQ7P3[Q7c3{Q8h5yQ8t6ZQ8u6[Q8w6_Q9Z7QQ:T8iR:_8x#[cOPXZst!Z!`!o#d#o#{%l&i&l&m&p&r&s&u&y'R'`(|*f+Y+d,k,n,s-d.b/i0V0d1j1z1{1}2P2S2V2X3[4q5y6Z6[6_7Q8i8xQ#YWQ#eYQ%puQ%rvS%tw!gS(Q#W(TQ(W#ZQ(r#uQ(w#xQ)P$OQ)Q$PQ)R$QQ)S$RQ)T$SQ)U$TQ)V$UQ)W$VQ)X$WQ)Y$XQ)[$ZQ)^$_Q)`$aQ)e$eW)o$n)q/Q3{Q+a%sQ+u&QS-U'V2hQ-s'pS-x(R-zQ-}(ZQ.P(bQ.n(vQ.q(xQ.u;vQ.w;yQ.x;zQ.y;}Q/]){Q0j+UQ2c-PQ2f-SQ2v-lQ2}.QQ3c.oQ3h<OQ3i<PQ3j<QQ3k<RQ3l<SQ3m<TQ3n<UQ3o<VQ3p<WQ3q<XQ3r<YQ3s.vQ3t<]Q3w<`Q3x<mQ4P<ZQ5O0lQ5Y0|Q6k<pQ6q2xQ6v3OQ7V3dQ7W<qQ7a<sQ7b<{Q8`5mQ8|6iQ9Q6rQ9[<|Q9b=VQ9c=WQ:c9SQ:y9}Q;R:aQ;x#SR=g=sR#[WR'X!el!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sS'T!e-WU*g$|*X*lS-T'U']S0O*h*nQ0W*oQ2m-^Q4m0UR4r0XR(y#xQ!fQT-_'^-`]!qQ!r'^-`1g5qQ#p]R'g;wR)d$dY!uQ'^-`1g5qQ'i!rS's!v!yS'u!z5sS-o'j'kQ-q'lR2{-pT#kZ%dS#jZ%dS%jm,jU(e#h#i#lS.T(f(gQ.X(hQ0n+ZQ3Q.UU3R.V.W.YS6x3S3TR9T6yd#^W#W#Z%g(R([*W+W.O/hr#gZm#h#i#l%d(f(g(h+Z.U.V.W.Y3S3T6yS*Z$x*_Q/o*[Q1|,jQ2d-QQ4W/kQ6g2[Q7i4XQ8{6hT=_'V+XV#aW%g*WU#`W%g*WS(S#W([U(X#Z+W/hS-V'V+XT-y(R.OV'[!e%h*XQ$lfR)v$qT)k$l)lR3}/PT*]$x*_T*e${*WQ0q+cQ1_,QQ3V.aQ5j1aQ5u1iQ6}3ZQ8g5xQ9W6|Q:Q8fQ:d9VQ:|:SQ;U:fQ;`:}R;c;VnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&j!VR,c&gtmOXst!U!V!Z#d%l&g&p&r&s&u,n,s2S2VR,j&mT%km,jR1c,SR,b&eQ&T|R+z&UR+p&OT&n!W&qT&o!W&qT2U,s2V",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:378,context:_Se,nodeProps:[["isolate",-8,5,6,14,35,37,49,51,53,""],["group",-26,9,17,19,66,206,210,214,215,217,220,223,233,235,241,243,245,247,250,256,262,264,266,268,270,272,273,"Statement",-34,13,14,30,33,34,40,49,52,53,55,60,68,70,74,78,80,82,83,108,109,118,119,135,138,140,141,142,143,144,146,147,166,168,170,"Expression",-23,29,31,35,39,41,43,172,174,176,177,179,180,181,183,184,185,187,188,189,200,202,204,205,"Type",-3,86,101,107,"ClassItem"],["openedBy",23,"<",36,"InterpolationStart",54,"[",58,"{",71,"(",159,"JSXStartCloseTag"],["closedBy",-2,24,167,">",38,"InterpolationEnd",48,"]",59,"}",72,")",164,"JSXEndTag"]],propSources:[VSe],skippedNodes:[0,5,6,276],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$h&j(Up(X!b'z0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(V#S$h&j'{0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$h&j(Up(X!b'{0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$h&j!n),Q(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#u(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(T':f$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$h&j(X!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$h&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$c`$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$c``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$c`$h&j(X!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(X!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$c`(X!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$h&j(Up(X!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$h&j(Up(X!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$h&j(X!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$h&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(X!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$h&j(UpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(UpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Up(X!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$h&j(m%1l(Up(X!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$h&j(Up(X!b$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$h&j(Up(X!b$[#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$h&j(Up(X!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$h&j$P(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(x+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$h&j#y(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(W';W$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$h&j(UpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$h&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$c`$h&j(UpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(UpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$c`(UpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!j/.^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!i!Lf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$h&j(Up(X!b(S%&f#o(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$h&j(Up(X!b#l(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$h&j(Up(X!bp+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!Z+Jf$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$h&j(Up(X!b!O.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_!Y!L^$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$h&j(Up(X!b#m(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$h&j(X!b!V7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$h&j!V7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$h&j!V7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!V7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!V7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$h&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$h&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$h&j(X!b!V7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(X!b!V7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(X!b!V7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(X!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$h&j(X!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$h&j(Up!V7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$h&j(Up!V7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Up!V7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Up!V7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(UpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$h&j(UpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$h&j(Up(X!b!V7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Up(X!b!V7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Up(X!b!V7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Up(X!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$h&j(Up(X!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$h&j(Up(X!b'|0/l!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$h&j(Up(X!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$h&j(X!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$h&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(X!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$h&j(UpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(UpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Up(X!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$h&j$P(Ch(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Y#t$h&j(Up(X!b!V7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$h&j(Up(X!bq'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!e$b$h&j#})Lv(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#P-<U(Up(X!b$m7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$j&j(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#p(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$P(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#q(Ch(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#^*!Y$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#i(Cl$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#q(Ch$e#|$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#q(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#p(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(p(Ct$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$h&j#z(Ch(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!z$Ip$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!Q0,v$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$h&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$h&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$h&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$h&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$h&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$h&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!W#)l$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#w(Ch$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$h&j(Up(X!b(_+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$h&j(Up(X!b(R,2j$^#t(c$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$h&j(Up(X!b$^#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!]#Hb(Up(X!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(w+JY$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_![(CdtBr$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!o7`$h&j(Up(X!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$h&j(Up(X!b'z0/l$[#t(R,2j(c$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$h&j(Up(X!b'{0/l$[#t(R,2j(c$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[ISe,LSe,QSe,jSe,2,3,4,5,6,7,8,9,10,11,12,13,14,RSe,new LS("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOv~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!S~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(a~~",141,338),new LS("j~RQYZXz{^~^O(O~~aP!P!Qd~iO(P~~",25,321)],topRules:{Script:[0,7],SingleExpression:[1,274],SingleClassItem:[2,275]},dialects:{jsx:0,ts:15091},dynamicPrecedences:{78:1,80:1,92:1,168:1,198:1},specialized:[{term:325,get:n=>ZSe[n]||-1},{term:341,get:n=>zSe[n]||-1},{term:93,get:n=>qSe[n]||-1}],tokenPrec:15116}),tW=[_a("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),_a("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),_a("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),_a("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),_a("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),_a(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),_a("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),_a(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),_a(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),_a('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),_a('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],WSe=tW.concat([_a("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),_a("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),_a("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),K4=new Nxe,nW=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Yp(n){return(e,t)=>{let s=e.node.getChild("VariableDefinition");return s&&t(s,n),!0}}const GSe=["FunctionDeclaration"],XSe={FunctionDeclaration:Yp("function"),ClassDeclaration:Yp("class"),ClassExpression:()=>!0,EnumDeclaration:Yp("constant"),TypeAliasDeclaration:Yp("type"),NamespaceDeclaration:Yp("namespace"),VariableDefinition(n,e){n.matchContext(GSe)||e(n,"variable")},TypeDefinition(n,e){e(n,"type")},__proto__:null};function sW(n,e){let t=K4.get(e);if(t)return t;let s=[],r=!0;function a(i,o){let l=n.sliceString(i.from,i.to);s.push({label:l,type:o})}return e.cursor(Sr.IncludeAnonymous).iterate(i=>{if(r)r=!1;else if(i.name){let o=XSe[i.name];if(o&&o(i,a)||nW.has(i.name))return!1}else if(i.to-i.from>8192){for(let o of sW(n,i.node))s.push(o);return!1}}),K4.set(e,s),s}const J4=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,rW=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function HSe(n){let e=Wr(n.state).resolveInner(n.pos,-1);if(rW.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&J4.test(n.state.sliceDoc(e.from,e.to));if(!t&&!n.explicit)return null;let s=[];for(let r=e;r;r=r.parent)nW.has(r.name)&&(s=s.concat(sW(n.state.doc,r)));return{options:s,from:t?e.from:n.pos,validFor:J4}}const tu=Xy.define({name:"javascript",parser:USe.configure({props:[$q.add({IfStatement:ix({except:/^\s*({|else\b)/}),TryStatement:ix({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:nke,SwitchBody:n=>{let e=n.textAfter,t=/^\s*\}/.test(e),s=/^\s*(case|default)\b/.test(e);return n.baseIndent+(t?0:s?1:2)*n.unit},Block:tke({closing:"}"}),ArrowFunction:n=>n.baseIndent+n.unit,"TemplateString BlockComment":()=>null,"Statement Property":ix({except:/^{/}),JSXElement(n){let e=/^\s*<\//.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},JSXEscape(n){let e=/\s*\}/.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},"JSXOpenTag JSXSelfClosingTag"(n){return n.column(n.node.from)+n.unit}}),Rq.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":rke,BlockComment(n){return{from:n.from+2,to:n.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),aW={test:n=>/^JSX/.test(n.name),facet:Dq({commentTokens:{block:{open:"{/*",close:"*/}"}}})},YSe=tu.configure({dialect:"ts"},"typescript"),KSe=tu.configure({dialect:"jsx",props:[hE.add(n=>n.isTop?[aW]:void 0)]}),JSe=tu.configure({dialect:"jsx ts",props:[hE.add(n=>n.isTop?[aW]:void 0)]},"typescript");let iW=n=>({label:n,type:"keyword"});const oW="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(iW),eCe=oW.concat(["declare","implements","private","protected","public"].map(iW));function tCe(n={}){let e=n.jsx?n.typescript?JSe:KSe:n.typescript?YSe:tu,t=n.typescript?WSe.concat(eCe):tW.concat(oW);return new Wxe(e,[tu.data.of({autocomplete:Bke(rW,Jq(t))}),tu.data.of({autocomplete:HSe}),n.jsx?rCe:[]])}function nCe(n){for(;;){if(n.name=="JSXOpenTag"||n.name=="JSXSelfClosingTag"||n.name=="JSXFragmentTag")return n;if(n.name=="JSXEscape"||!n.parent)return null;n=n.parent}}function e7(n,e,t=n.length){for(let s=e==null?void 0:e.firstChild;s;s=s.nextSibling)if(s.name=="JSXIdentifier"||s.name=="JSXBuiltin"||s.name=="JSXNamespacedName"||s.name=="JSXMemberExpression")return n.sliceString(s.from,Math.min(s.to,t));return""}const sCe=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),rCe=vt.inputHandler.of((n,e,t,s,r)=>{if((sCe?n.composing:n.compositionStarted)||n.state.readOnly||e!=t||s!=">"&&s!="/"||!tu.isActiveAt(n.state,e,-1))return!1;let a=r(),{state:i}=a,o=i.changeByRange(l=>{var c;let{head:u}=l,h=Wr(i).resolveInner(u-1,-1),d;if(h.name=="JSXStartTag"&&(h=h.parent),!(i.doc.sliceString(u-1,u)!=s||h.name=="JSXAttributeValue"&&h.to>u)){if(s==">"&&h.name=="JSXFragmentTag")return{range:l,changes:{from:u,insert:"</>"}};if(s=="/"&&h.name=="JSXStartCloseTag"){let m=h.parent,y=m.parent;if(y&&m.from==u-2&&((d=e7(i.doc,y.firstChild,u))||((c=y.firstChild)===null||c===void 0?void 0:c.name)=="JSXFragmentTag")){let O=`${d}>`;return{range:Ve.cursor(u+O.length,-1),changes:{from:u,insert:O}}}}else if(s==">"){let m=nCe(h);if(m&&m.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(i.doc.sliceString(u,u+2))&&(d=e7(i.doc,m,u)))return{range:l,changes:{from:u,insert:`</${d}>`}}}}return{range:l}});return o.changes.empty?!1:(n.dispatch([a,i.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),aCe=JSON.parse(`[{"comment":"/**\\n * Overrides the css of highlighted events. Make sure to use single quotes!\\n * @name markcss\\n * @example\\n * note(\\"c a f e\\")\\n * .markcss('text-decoration:underline')\\n */","meta":{"filename":"codemirror.mjs","lineno":374,"columnno":0,"path":"/Users/felix/projects/strudel/packages/codemirror","code":{}},"description":"<p>Overrides the css of highlighted events. Make sure to use single quotes!</p>","name":"markcss","examples":["note(\\"c a f e\\")\\n.markcss('text-decoration:underline')"],"longname":"markcss","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a slider widget to allow the user manipulate a value\\n *\\n * @name slider\\n * @param {number} value Initial value\\n * @param {number} min Minimum value - optional, defaults to 0\\n * @param {number} max Maximum value - optional, defaults to 1\\n * @param {number} step Step size - optional\\n */","meta":{"filename":"slider.mjs","lineno":116,"columnno":0,"path":"/Users/felix/projects/strudel/packages/codemirror","code":{}},"description":"<p>Displays a slider widget to allow the user manipulate a value</p>","name":"slider","params":[{"type":{"names":["number"]},"description":"<p>Initial value</p>","name":"value"},{"type":{"names":["number"]},"description":"<p>Minimum value - optional, defaults to 0</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>Maximum value - optional, defaults to 1</p>","name":"max"},{"type":{"names":["number"]},"description":"<p>Step size - optional</p>","name":"step"}],"longname":"slider","kind":"member","scope":"global"},{"comment":"/**\\n * Select a sound / sample by name. When using mininotation, you can also optionally supply 'n' and 'gain' parameters\\n * separated by ':'.\\n *\\n * @name s\\n * @param {string | Pattern} sound The sound / pattern of sounds to pick\\n * @synonyms sound\\n * @example\\n * s(\\"bd hh\\")\\n * @example\\n * s(\\"bd:0 bd:1 bd:0:0.3 bd:1:1.4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":75,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Select a sound / sample by name. When using mininotation, you can also optionally supply 'n' and 'gain' parameters\\nseparated by ':'.</p>","name":"s","params":[{"type":{"names":["string","Pattern"]},"description":"<p>The sound / pattern of sounds to pick</p>","name":"sound"}],"synonyms_text":"sound","synonyms":["sound"],"examples":["s(\\"bd hh\\")","s(\\"bd:0 bd:1 bd:0:0.3 bd:1:1.4\\")"],"longname":"s","kind":"member","scope":"global"},{"comment":"/**\\n * Define a custom webaudio node to use as a sound source.\\n *\\n * @name source\\n * @param {function} getSource\\n * @synonyms src\\n *\\n */","meta":{"filename":"controls.mjs","lineno":90,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Define a custom webaudio node to use as a sound source.</p>","name":"source","params":[{"type":{"names":["function"]},"name":"getSource"}],"synonyms_text":"src","synonyms":["src"],"longname":"source","kind":"member","scope":"global"},{"comment":"/**\\n * Selects the given index from the sample map.\\n * Numbers too high will wrap around.\\n * \`n\` can also be used to play midi numbers, but it is recommended to use \`note\` instead.\\n *\\n * @name n\\n * @param {number | Pattern} value sample index starting from 0\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").n(\\"<0 1>\\")\\n */","meta":{"filename":"controls.mjs","lineno":99,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Selects the given index from the sample map.\\nNumbers too high will wrap around.\\n<code>n</code> can also be used to play midi numbers, but it is recommended to use <code>note</code> instead.</p>","name":"n","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sample index starting from 0</p>","name":"value"}],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").n(\\"<0 1>\\")"],"longname":"n","kind":"member","scope":"global"},{"comment":"/**\\n * Plays the given note name or midi number. A note name consists of\\n *\\n * - a letter (a-g or A-G)\\n * - optional accidentals (b or #)\\n * - optional octave number (0-9). Defaults to 3\\n *\\n * Examples of valid note names: \`c\`, \`bb\`, \`Bb\`, \`f#\`, \`c3\`, \`A4\`, \`Eb2\`, \`c#5\`\\n *\\n * You can also use midi numbers instead of note names, where 69 is mapped to A4 440Hz in 12EDO.\\n *\\n * @name note\\n * @example\\n * note(\\"c a f e\\")\\n * @example\\n * note(\\"c4 a4 f4 e4\\")\\n * @example\\n * note(\\"60 69 65 64\\")\\n */","meta":{"filename":"controls.mjs","lineno":111,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Plays the given note name or midi number. A note name consists of</p>\\n<ul>\\n<li>a letter (a-g or A-G)</li>\\n<li>optional accidentals (b or #)</li>\\n<li>optional octave number (0-9). Defaults to 3</li>\\n</ul>\\n<p>Examples of valid note names: <code>c</code>, <code>bb</code>, <code>Bb</code>, <code>f#</code>, <code>c3</code>, <code>A4</code>, <code>Eb2</code>, <code>c#5</code></p>\\n<p>You can also use midi numbers instead of note names, where 69 is mapped to A4 440Hz in 12EDO.</p>","name":"note","examples":["note(\\"c a f e\\")","note(\\"c4 a4 f4 e4\\")","note(\\"60 69 65 64\\")"],"longname":"note","kind":"member","scope":"global"},{"comment":"/**\\n * A pattern of numbers that speed up (or slow down) samples while they play. Currently only supported by osc / superdirt.\\n *\\n * @name accelerate\\n * @param {number | Pattern} amount acceleration.\\n * @superdirtOnly\\n * @example\\n * s(\\"sax\\").accelerate(\\"<0 1 2 4 8 16>\\").slow(2).osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":132,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>A pattern of numbers that speed up (or slow down) samples while they play. Currently only supported by osc / superdirt.</p>","name":"accelerate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>acceleration.</p>","name":"amount"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"sax\\").accelerate(\\"<0 1 2 4 8 16>\\").slow(2).osc()"],"longname":"accelerate","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Sets the velocity from 0 to 1. Is multiplied together with gain.\\n * @name velocity\\n * @example\\n * s(\\"hh*8\\")\\n * .gain(\\".4!2 1 .4!2 1 .4 1\\")\\n * .velocity(\\".4 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":143,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the velocity from 0 to 1. Is multiplied together with gain.</p>","name":"velocity","examples":["s(\\"hh*8\\")\\n.gain(\\".4!2 1 .4!2 1 .4 1\\")\\n.velocity(\\".4 1\\")"],"longname":"velocity","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the gain by an exponential amount.\\n *\\n * @name gain\\n * @param {number | Pattern} amount gain.\\n * @example\\n * s(\\"hh*8\\").gain(\\".4!2 1 .4!2 1 .4 1\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":153,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Controls the gain by an exponential amount.</p>","name":"gain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>gain.</p>","name":"amount"}],"examples":["s(\\"hh*8\\").gain(\\".4!2 1 .4!2 1 .4 1\\").fast(2)"],"longname":"gain","kind":"member","scope":"global"},{"comment":"/**\\n * Gain applied after all effects have been processed.\\n *\\n * @name postgain\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\")\\n * .compressor(\\"-20:20:10:.002:.02\\").postgain(1.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":163,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Gain applied after all effects have been processed.</p>","name":"postgain","examples":["s(\\"bd sd [~ bd] sd,hh*8\\")\\n.compressor(\\"-20:20:10:.002:.02\\").postgain(1.5)"],"longname":"postgain","kind":"member","scope":"global"},{"comment":"/**\\n * Like \`gain\`, but linear.\\n *\\n * @name amp\\n * @param {number | Pattern} amount gain.\\n * @superdirtOnly\\n * @example\\n * s(\\"bd*8\\").amp(\\".1*2 .5 .1*2 .5 .1 .5\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":173,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like <code>gain</code>, but linear.</p>","name":"amp","params":[{"type":{"names":["number","Pattern"]},"description":"<p>gain.</p>","name":"amount"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"bd*8\\").amp(\\".1*2 .5 .1*2 .5 .1 .5\\").osc()"],"longname":"amp","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope attack time: Specifies how long it takes for the sound to reach its peak value, relative to the onset.\\n *\\n * @name attack\\n * @param {number | Pattern} attack time in seconds.\\n * @synonyms att\\n * @example\\n * note(\\"c3 e3 f3 g3\\").attack(\\"<0 .1 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":184,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope attack time: Specifies how long it takes for the sound to reach its peak value, relative to the onset.</p>","name":"attack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds.</p>","name":"attack"}],"synonyms_text":"att","synonyms":["att"],"examples":["note(\\"c3 e3 f3 g3\\").attack(\\"<0 .1 .5>\\")"],"longname":"attack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the Frequency Modulation Harmonicity Ratio.\\n * Controls the timbre of the sound.\\n * Whole numbers and simple ratios sound more natural,\\n * while decimal numbers and complex ratios sound metallic.\\n *\\n * @name fmh\\n * @param {number | Pattern} harmonicity\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmh(\\"<1 2 1.5 1.61>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":196,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the Frequency Modulation Harmonicity Ratio.\\nControls the timbre of the sound.\\nWhole numbers and simple ratios sound more natural,\\nwhile decimal numbers and complex ratios sound metallic.</p>","name":"fmh","params":[{"type":{"names":["number","Pattern"]},"name":"harmonicity"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmh(\\"<1 2 1.5 1.61>\\")\\n._scope()"],"longname":"fmh","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the Frequency Modulation of the synth.\\n * Controls the modulation index, which defines the brightness of the sound.\\n *\\n * @name fm\\n * @param {number | Pattern} brightness modulation index\\n * @synonyms fmi\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(\\"<0 1 2 8 32>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":212,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the Frequency Modulation of the synth.\\nControls the modulation index, which defines the brightness of the sound.</p>","name":"fm","params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation index</p>","name":"brightness"}],"synonyms_text":"fmi","synonyms":["fmi"],"examples":["note(\\"c e g b g e\\")\\n.fm(\\"<0 1 2 8 32>\\")\\n._scope()"],"longname":"fm","kind":"member","scope":"global"},{"comment":"/**\\n * Ramp type of fm envelope. Exp might be a bit broken..\\n *\\n * @name fmenv\\n * @param {number | Pattern} type lin | exp\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(.2)\\n * .fmsustain(0)\\n * .fmenv(\\"<exp lin>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":227,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Ramp type of fm envelope. Exp might be a bit broken..</p>","name":"fmenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>lin | exp</p>","name":"type"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(.2)\\n.fmsustain(0)\\n.fmenv(\\"<exp lin>\\")\\n._scope()"],"longname":"fmenv","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time for the FM envelope: time it takes to reach maximum modulation\\n *\\n * @name fmattack\\n * @param {number | Pattern} time attack time\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmattack(\\"<0 .05 .1 .2>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":242,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Attack time for the FM envelope: time it takes to reach maximum modulation</p>","name":"fmattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time</p>","name":"time"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmattack(\\"<0 .05 .1 .2>\\")\\n._scope()"],"longname":"fmattack","kind":"member","scope":"global"},{"comment":"/**\\n * waveform of the fm modulator\\n *\\n * @name fmwave\\n * @param {number | Pattern} wave waveform\\n * @example\\n * n(\\"0 1 2 3\\".fast(4)).scale(\\"d:minor\\").s(\\"sine\\").fmwave(\\"<sine square sawtooth crackle>\\").fm(4).fmh(2.01)\\n * @example\\n * n(\\"0 1 2 3\\".fast(4)).chord(\\"<Dm Am F G>\\").voicing().s(\\"sawtooth\\").fmwave(\\"brown\\").fm(.6)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":256,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>waveform of the fm modulator</p>","name":"fmwave","params":[{"type":{"names":["number","Pattern"]},"description":"<p>waveform</p>","name":"wave"}],"examples":["n(\\"0 1 2 3\\".fast(4)).scale(\\"d:minor\\").s(\\"sine\\").fmwave(\\"<sine square sawtooth crackle>\\").fm(4).fmh(2.01)","n(\\"0 1 2 3\\".fast(4)).chord(\\"<Dm Am F G>\\").voicing().s(\\"sawtooth\\").fmwave(\\"brown\\").fm(.6)"],"longname":"fmwave","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time for the FM envelope: seconds until the sustain level is reached after the attack phase.\\n *\\n * @name fmdecay\\n * @param {number | Pattern} time decay time\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(\\"<.01 .05 .1 .2>\\")\\n * .fmsustain(.4)\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":269,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Decay time for the FM envelope: seconds until the sustain level is reached after the attack phase.</p>","name":"fmdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time</p>","name":"time"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(\\"<.01 .05 .1 .2>\\")\\n.fmsustain(.4)\\n._scope()"],"longname":"fmdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sustain level for the FM envelope: how much modulation is applied after the decay phase\\n *\\n * @name fmsustain\\n * @param {number | Pattern} level sustain level\\n * @example\\n * note(\\"c e g b g e\\")\\n * .fm(4)\\n * .fmdecay(.1)\\n * .fmsustain(\\"<1 .75 .5 0>\\")\\n * ._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":283,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sustain level for the FM envelope: how much modulation is applied after the decay phase</p>","name":"fmsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level</p>","name":"level"}],"examples":["note(\\"c e g b g e\\")\\n.fm(4)\\n.fmdecay(.1)\\n.fmsustain(\\"<1 .75 .5 0>\\")\\n._scope()"],"longname":"fmsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Select the sound bank to use. To be used together with \`s\`. The bank name (+ \\"_\\") will be prepended to the value of \`s\`.\\n *\\n * @name bank\\n * @param {string | Pattern} bank the name of the bank\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").bank('RolandTR909') // = s(\\"RolandTR909_bd RolandTR909_sd\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":301,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Select the sound bank to use. To be used together with <code>s</code>. The bank name (+ &quot;_&quot;) will be prepended to the value of <code>s</code>.</p>","name":"bank","params":[{"type":{"names":["string","Pattern"]},"description":"<p>the name of the bank</p>","name":"bank"}],"examples":["s(\\"bd sd [~ bd] sd\\").bank('RolandTR909') // = s(\\"RolandTR909_bd RolandTR909_sd\\")"],"longname":"bank","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope decay time: the time it takes after the attack time to reach the sustain level.\\n * Note that the decay is only audible if the sustain value is lower than 1.\\n *\\n * @name decay\\n * @param {number | Pattern} time decay time in seconds\\n * @synonyms dec\\n * @example\\n * note(\\"c3 e3 f3 g3\\").decay(\\"<.1 .2 .3 .4>\\").sustain(0)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":317,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope decay time: the time it takes after the attack time to reach the sustain level.\\nNote that the decay is only audible if the sustain value is lower than 1.</p>","name":"decay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"}],"synonyms_text":"dec","synonyms":["dec"],"examples":["note(\\"c3 e3 f3 g3\\").decay(\\"<.1 .2 .3 .4>\\").sustain(0)"],"longname":"decay","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope sustain level: The level which is reached after attack / decay, being sustained until the offset.\\n *\\n * @name sustain\\n * @param {number | Pattern} gain sustain level between 0 and 1\\n * @synonyms sus\\n * @example\\n * note(\\"c3 e3 f3 g3\\").decay(.2).sustain(\\"<0 .1 .4 .6 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":329,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope sustain level: The level which is reached after attack / decay, being sustained until the offset.</p>","name":"sustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>sustain level between 0 and 1</p>","name":"gain"}],"synonyms_text":"sus","synonyms":["sus"],"examples":["note(\\"c3 e3 f3 g3\\").decay(.2).sustain(\\"<0 .1 .4 .6 1>\\")"],"longname":"sustain","kind":"member","scope":"global"},{"comment":"/**\\n * Amplitude envelope release time: The time it takes after the offset to go from sustain level to zero.\\n *\\n * @name release\\n * @param {number | Pattern} time release time in seconds\\n * @synonyms rel\\n * @example\\n * note(\\"c3 e3 g3 c4\\").release(\\"<0 .1 .4 .6 1>/2\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":340,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Amplitude envelope release time: The time it takes after the offset to go from sustain level to zero.</p>","name":"release","params":[{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"synonyms_text":"rel","synonyms":["rel"],"examples":["note(\\"c3 e3 g3 c4\\").release(\\"<0 .1 .4 .6 1>/2\\")"],"longname":"release","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the center frequency of the **b**and-**p**ass **f**ilter. When using mininotation, you\\n * can also optionally supply the 'bpq' parameter separated by ':'.\\n *\\n * @name bpf\\n * @param {number | Pattern} frequency center frequency\\n * @synonyms bandf, bp\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").bpf(\\"<1000 2000 4000 8000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":353,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the center frequency of the <strong>b</strong>and-<strong>p</strong>ass <strong>f</strong>ilter. When using mininotation, you\\ncan also optionally supply the 'bpq' parameter separated by ':'.</p>","name":"bpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>center frequency</p>","name":"frequency"}],"synonyms_text":"bandf, bp","synonyms":["bandf","bp"],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").bpf(\\"<1000 2000 4000 8000>\\")"],"longname":"bpf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the **b**and-**p**ass **q**-factor (resonance).\\n *\\n * @name bpq\\n * @param {number | Pattern} q q factor\\n * @synonyms bandq\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").bpf(500).bpq(\\"<0 1 2 3>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":366,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the <strong>b</strong>and-<strong>p</strong>ass <strong>q</strong>-factor (resonance).</p>","name":"bpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>q factor</p>","name":"q"}],"synonyms_text":"bandq","synonyms":["bandq"],"examples":["s(\\"bd sd [~ bd] sd\\").bpf(500).bpq(\\"<0 1 2 3>\\")"],"longname":"bpq","kind":"member","scope":"global"},{"comment":"/**\\n * a pattern of numbers from 0 to 1. Skips the beginning of each sample, e.g. \`0.25\` to cut off the first quarter from each sample.\\n *\\n * @memberof Pattern\\n * @name begin\\n * @param {number | Pattern} amount between 0 and 1, where 1 is the length of the sample\\n * @example\\n * samples({ rave: 'rave/AREUREADY.wav' }, 'github:tidalcycles/dirt-samples')\\n * s(\\"rave\\").begin(\\"<0 .25 .5 .75>\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":379,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>a pattern of numbers from 0 to 1. Skips the beginning of each sample, e.g. <code>0.25</code> to cut off the first quarter from each sample.</p>","memberof":"Pattern","name":"begin","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"amount"}],"examples":["samples({ rave: 'rave/AREUREADY.wav' }, 'github:tidalcycles/dirt-samples')\\ns(\\"rave\\").begin(\\"<0 .25 .5 .75>\\").fast(2)"],"scope":"static","longname":"Pattern.begin","kind":"member"},{"comment":"/**\\n * The same as .begin, but cuts off the end off each sample.\\n *\\n * @memberof Pattern\\n * @name end\\n * @param {number | Pattern} length 1 = whole sample, .5 = half sample, .25 = quarter sample etc..\\n * @example\\n * s(\\"bd*2,oh*4\\").end(\\"<.1 .2 .5 1>\\").fast(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":391,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>The same as .begin, but cuts off the end off each sample.</p>","memberof":"Pattern","name":"end","params":[{"type":{"names":["number","Pattern"]},"description":"<p>1 = whole sample, .5 = half sample, .25 = quarter sample etc..</p>","name":"length"}],"examples":["s(\\"bd*2,oh*4\\").end(\\"<.1 .2 .5 1>\\").fast(2)"],"scope":"static","longname":"Pattern.end","kind":"member"},{"comment":"/**\\n * Loops the sample.\\n * Note that the tempo of the loop is not synced with the cycle tempo.\\n * To change the loop region, use loopBegin / loopEnd.\\n *\\n * @name loop\\n * @param {number | Pattern} on If 1, the sample is looped\\n * @example\\n * s(\\"casio\\").loop(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":402,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Loops the sample.\\nNote that the tempo of the loop is not synced with the cycle tempo.\\nTo change the loop region, use loopBegin / loopEnd.</p>","name":"loop","params":[{"type":{"names":["number","Pattern"]},"description":"<p>If 1, the sample is looped</p>","name":"on"}],"examples":["s(\\"casio\\").loop(1)"],"longname":"loop","kind":"member","scope":"global"},{"comment":"/**\\n * Begin to loop at a specific point in the sample (inbetween \`begin\` and \`end\`).\\n * Note that the loop point must be inbetween \`begin\` and \`end\`, and before \`loopEnd\`!\\n * Note: Samples starting with wt_ will automatically loop! (wt = wavetable)\\n *\\n * @name loopBegin\\n * @param {number | Pattern} time between 0 and 1, where 1 is the length of the sample\\n * @synonyms loopb\\n * @example\\n * s(\\"space\\").loop(1)\\n * .loopBegin(\\"<0 .125 .25>\\")._scope()\\n */","meta":{"filename":"controls.mjs","lineno":414,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Begin to loop at a specific point in the sample (inbetween <code>begin</code> and <code>end</code>).\\nNote that the loop point must be inbetween <code>begin</code> and <code>end</code>, and before <code>loopEnd</code>!\\nNote: Samples starting with wt_ will automatically loop! (wt = wavetable)</p>","name":"loopBegin","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"time"}],"synonyms_text":"loopb","synonyms":["loopb"],"examples":["s(\\"space\\").loop(1)\\n.loopBegin(\\"<0 .125 .25>\\")._scope()"],"longname":"loopBegin","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * End the looping section at a specific point in the sample (inbetween \`begin\` and \`end\`).\\n * Note that the loop point must be inbetween \`begin\` and \`end\`, and after \`loopBegin\`!\\n *\\n * @name loopEnd\\n * @param {number | Pattern} time between 0 and 1, where 1 is the length of the sample\\n * @synonyms loope\\n * @example\\n * s(\\"space\\").loop(1)\\n * .loopEnd(\\"<1 .75 .5 .25>\\")._scope()\\n */","meta":{"filename":"controls.mjs","lineno":427,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>End the looping section at a specific point in the sample (inbetween <code>begin</code> and <code>end</code>).\\nNote that the loop point must be inbetween <code>begin</code> and <code>end</code>, and after <code>loopBegin</code>!</p>","name":"loopEnd","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, where 1 is the length of the sample</p>","name":"time"}],"synonyms_text":"loope","synonyms":["loope"],"examples":["s(\\"space\\").loop(1)\\n.loopEnd(\\"<1 .75 .5 .25>\\")._scope()"],"longname":"loopEnd","kind":"member","scope":"global"},{"comment":"/**\\n * bit crusher effect.\\n *\\n * @name crush\\n * @param {number | Pattern} depth between 1 (for drastic reduction in bit-depth) to 16 (for barely no reduction).\\n * @example\\n * s(\\"<bd sd>,hh*3\\").fast(2).crush(\\"<16 8 7 6 5 4 3 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":440,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>bit crusher effect.</p>","name":"crush","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 1 (for drastic reduction in bit-depth) to 16 (for barely no reduction).</p>","name":"depth"}],"examples":["s(\\"<bd sd>,hh*3\\").fast(2).crush(\\"<16 8 7 6 5 4 3 2>\\")"],"longname":"crush","kind":"member","scope":"global"},{"comment":"/**\\n * fake-resampling for lowering the sample rate. Caution: This effect seems to only work in chromium based browsers\\n *\\n * @name coarse\\n * @param {number | Pattern} factor 1 for original 2 for half, 3 for a third and so on.\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").coarse(\\"<1 4 8 16 32>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":451,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>fake-resampling for lowering the sample rate. Caution: This effect seems to only work in chromium based browsers</p>","name":"coarse","params":[{"type":{"names":["number","Pattern"]},"description":"<p>1 for original 2 for half, 3 for a third and so on.</p>","name":"factor"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").coarse(\\"<1 4 8 16 32>\\")"],"longname":"coarse","kind":"member","scope":"global"},{"comment":"/**\\n * modulate the amplitude of a sound with a continuous waveform\\n *\\n * @name tremolo\\n * @synonyms trem\\n * @param {number | Pattern} speed modulation speed in HZ\\n * @example\\n * note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolo(\\"<3 2 100> \\").tremoloskew(\\"<.5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":462,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>modulate the amplitude of a sound with a continuous waveform</p>","name":"tremolo","synonyms_text":"trem","synonyms":["trem"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation speed in HZ</p>","name":"speed"}],"examples":["note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolo(\\"<3 2 100> \\").tremoloskew(\\"<.5>\\")"],"longname":"tremolo","kind":"member","scope":"global"},{"comment":"/**\\n * modulate the amplitude of a sound with a continuous waveform\\n *\\n * @name tremolosync\\n * @synonyms tremsync\\n * @param {number | Pattern} cycles modulation speed in cycles\\n * @example\\n * note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolosync(\\"4\\").tremoloskew(\\"<1 .5 0>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":474,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>modulate the amplitude of a sound with a continuous waveform</p>","name":"tremolosync","synonyms_text":"tremsync","synonyms":["tremsync"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>modulation speed in cycles</p>","name":"cycles"}],"examples":["note(\\"d d d# d\\".fast(4)).s(\\"supersaw\\").tremolosync(\\"4\\").tremoloskew(\\"<1 .5 0>\\")"],"longname":"tremolosync","kind":"member","scope":"global"},{"comment":"/**\\n * depth of amplitude modulation\\n *\\n * @name tremolodepth\\n * @synonyms tremdepth\\n * @param {number | Pattern} depth\\n * @example\\n * note(\\"a1 a1 a#1 a1\\".fast(4)).s(\\"pulse\\").tremsync(4).tremolodepth(\\"<1 2 .7>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":489,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>depth of amplitude modulation</p>","name":"tremolodepth","synonyms_text":"tremdepth","synonyms":["tremdepth"],"params":[{"type":{"names":["number","Pattern"]},"name":"depth"}],"examples":["note(\\"a1 a1 a#1 a1\\".fast(4)).s(\\"pulse\\").tremsync(4).tremolodepth(\\"<1 2 .7>\\")"],"longname":"tremolodepth","kind":"member","scope":"global"},{"comment":"/**\\n * alter the shape of the modulation waveform\\n *\\n * @name tremoloskew\\n * @synonyms tremskew\\n * @param {number | Pattern} amount between 0 & 1, the shape of the waveform\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremoloskew(\\"<.5 0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":500,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>alter the shape of the modulation waveform</p>","name":"tremoloskew","synonyms_text":"tremskew","synonyms":["tremskew"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 &amp; 1, the shape of the waveform</p>","name":"amount"}],"examples":["note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremoloskew(\\"<.5 0 1>\\")"],"longname":"tremoloskew","kind":"member","scope":"global"},{"comment":"/**\\n * alter the phase of the modulation waveform\\n *\\n * @name tremolophase\\n * @synonyms tremphase\\n * @param {number | Pattern} offset the offset in cycles of the modulation\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremolophase(\\"<0 .25 .66>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":512,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>alter the phase of the modulation waveform</p>","name":"tremolophase","synonyms_text":"tremphase","synonyms":["tremphase"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>the offset in cycles of the modulation</p>","name":"offset"}],"examples":["note(\\"{f a c e}%16\\").s(\\"sawtooth\\").tremsync(4).tremolophase(\\"<0 .25 .66>\\")"],"longname":"tremolophase","kind":"member","scope":"global"},{"comment":"/**\\n * shape of amplitude modulation\\n *\\n * @name tremoloshape\\n * @param {number | Pattern} shape tri | square | sine | saw | ramp\\n * @example\\n * note(\\"{f g c d}%16\\").tremsync(4).tremoloshape(\\"<sine tri square>\\").s(\\"sawtooth\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":524,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>shape of amplitude modulation</p>","name":"tremoloshape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>tri | square | sine | saw | ramp</p>","name":"shape"}],"examples":["note(\\"{f g c d}%16\\").tremsync(4).tremoloshape(\\"<sine tri square>\\").s(\\"sawtooth\\")"],"longname":"tremoloshape","kind":"member","scope":"global"},{"comment":"/**\\n * filter overdrive for supported filter types\\n *\\n * @name drive\\n * @param {number | Pattern} amount\\n * @example\\n * note(\\"{f g g c d a a#}%16\\".sub(17)).s(\\"supersaw\\").lpenv(8).lpf(150).lpq(.8).ftype('ladder').drive(\\"<.5 4>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":534,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>filter overdrive for supported filter types</p>","name":"drive","params":[{"type":{"names":["number","Pattern"]},"name":"amount"}],"examples":["note(\\"{f g g c d a a#}%16\\".sub(17)).s(\\"supersaw\\").lpenv(8).lpf(150).lpq(.8).ftype('ladder').drive(\\"<.5 4>\\")"],"longname":"drive","kind":"member","scope":"global"},{"comment":"/**\\n * modulate the amplitude of an orbit to create a \\"sidechain\\" like effect\\n *\\n * @name duckorbit\\n * @param {number | Pattern} orbit target orbit\\n * @example\\n * $: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n * $: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":544,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>modulate the amplitude of an orbit to create a &quot;sidechain&quot; like effect</p>","name":"duckorbit","params":[{"type":{"names":["number","Pattern"]},"description":"<p>target orbit</p>","name":"orbit"}],"examples":["$: n(run(16)).scale(\\"c:minor:pentatonic\\").s(\\"sawtooth\\").delay(.7).orbit(2)\\n$: s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(1)"],"longname":"duckorbit","kind":"member","scope":"global"},{"comment":"/**\\n *  the amount of ducking applied to target orbit\\n *\\n * @name duckdepth\\n * @param {number | Pattern} depth depth of modulation from 0 to 1\\n * @example\\n * stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(\\"<1 .9 .6 0>\\"))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":556,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>the amount of ducking applied to target orbit</p>","name":"duckdepth","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of modulation from 0 to 1</p>","name":"depth"}],"examples":["stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(0.2).duckdepth(\\"<1 .9 .6 0>\\"))"],"longname":"duckdepth","kind":"member","scope":"global"},{"comment":"/**\\n *  the attack time of the duck effect\\n *\\n * @name duckattack\\n * @param {number | Pattern} time\\n * @example\\n * stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(\\"<0.2 0 0.4>\\").duckdepth(1))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":568,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>the attack time of the duck effect</p>","name":"duckattack","params":[{"type":{"names":["number","Pattern"]},"name":"time"}],"examples":["stack( n(run(8)).scale(\\"c:minor\\").s(\\"sawtooth\\").delay(.7).orbit(2), s(\\"bd:4!4\\").beat(\\"0,4,8,11,14\\",16).duckorbit(2).duckattack(\\"<0.2 0 0.4>\\").duckdepth(1))"],"longname":"duckattack","kind":"member","scope":"global"},{"comment":"/**\\n * Create byte beats with custom expressions\\n *\\n * @name byteBeatExpression\\n * @synonyms bbexpr\\n *\\n * @param {number | Pattern} byteBeatExpression bitwise expression for creating bytebeat\\n * @example\\n * s(\\"bytebeat\\").bbexpr('t*(t>>15^t>>66)')\\n *\\n */","meta":{"filename":"controls.mjs","lineno":581,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Create byte beats with custom expressions</p>","name":"byteBeatExpression","synonyms_text":"bbexpr","synonyms":["bbexpr"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>bitwise expression for creating bytebeat</p>","name":"byteBeatExpression"}],"examples":["s(\\"bytebeat\\").bbexpr('t*(t>>15^t>>66)')"],"longname":"byteBeatExpression","kind":"member","scope":"global"},{"comment":"/**\\n * Create byte beats with custom expressions\\n *\\n * @name byteBeatStartTime\\n * @synonyms bbst\\n *\\n * @param {number | Pattern} byteBeatStartTime in samples (t)\\n * @example\\n * note(\\"c3!8\\".add(\\"{0 0 12 0 7 5 3}%8\\")).s(\\"bytebeat:5\\").bbst(\\"<3 1>\\".mul(10000))._scope()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":594,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Create byte beats with custom expressions</p>","name":"byteBeatStartTime","synonyms_text":"bbst","synonyms":["bbst"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>in samples (t)</p>","name":"byteBeatStartTime"}],"examples":["note(\\"c3!8\\".add(\\"{0 0 12 0 7 5 3}%8\\")).s(\\"bytebeat:5\\").bbst(\\"<3 1>\\".mul(10000))._scope()"],"longname":"byteBeatStartTime","kind":"member","scope":"global"},{"comment":"/**\\n * Allows you to set the output channels on the interface\\n *\\n * @name channels\\n * @synonyms ch\\n *\\n * @param {number | Pattern} channels pattern the output channels\\n * @example\\n * note(\\"e a d b g\\").channels(\\"3:4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":607,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Allows you to set the output channels on the interface</p>","name":"channels","synonyms_text":"ch","synonyms":["ch"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>pattern the output channels</p>","name":"channels"}],"examples":["note(\\"e a d b g\\").channels(\\"3:4\\")"],"longname":"channels","kind":"member","scope":"global"},{"comment":"/**\\n * controls the pulsewidth of the pulse oscillator\\n *\\n * @name pw\\n * @param {number | Pattern} pulsewidth\\n * @example\\n * note(\\"{f a c e}%16\\").s(\\"pulse\\").pw(\\".8:1:.2\\")\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0 .75 .5 1\\")\\n */","meta":{"filename":"controls.mjs","lineno":620,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>controls the pulsewidth of the pulse oscillator</p>","name":"pw","params":[{"type":{"names":["number","Pattern"]},"name":"pulsewidth"}],"examples":["note(\\"{f a c e}%16\\").s(\\"pulse\\").pw(\\".8:1:.2\\")","n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0 .75 .5 1\\")"],"longname":"pw","kind":"member","scope":"global"},{"comment":"/**\\n * controls the lfo rate for the pulsewidth of the pulse oscillator\\n *\\n * @name pwrate\\n * @param {number | Pattern} rate\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")\\n\\n *\\n */","meta":{"filename":"controls.mjs","lineno":632,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>controls the lfo rate for the pulsewidth of the pulse oscillator</p>","name":"pwrate","params":[{"type":{"names":["number","Pattern"]},"name":"rate"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")"],"longname":"pwrate","kind":"member","scope":"global"},{"comment":"/**\\n * controls the lfo sweep for the pulsewidth of the pulse oscillator\\n *\\n * @name pwsweep\\n * @param {number | Pattern} sweep\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":644,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>controls the lfo sweep for the pulsewidth of the pulse oscillator</p>","name":"pwsweep","params":[{"type":{"names":["number","Pattern"]},"name":"sweep"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"pulse\\").pw(\\"0.5\\").pwrate(\\"<5 .1 25>\\").pwsweep(\\"<0.3 .8>\\")"],"longname":"pwsweep","kind":"member","scope":"global"},{"comment":"/**\\n * Phaser audio effect that approximates popular guitar pedals.\\n *\\n * @name phaser\\n * @synonyms ph\\n * @param {number | Pattern} speed speed of modulation\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(\\"<1 2 4 8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":655,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Phaser audio effect that approximates popular guitar pedals.</p>","name":"phaser","synonyms_text":"ph","synonyms":["ph"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>speed of modulation</p>","name":"speed"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(\\"<1 2 4 8>\\")"],"longname":"phaser","kind":"member","scope":"global"},{"comment":"/**\\n * The frequency sweep range of the lfo for the phaser effect. Defaults to 2000\\n *\\n * @name phasersweep\\n * @synonyms phs\\n * @param {number | Pattern} phasersweep most useful values are between 0 and 4000\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phasersweep(\\"<800 2000 4000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":672,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>The frequency sweep range of the lfo for the phaser effect. Defaults to 2000</p>","name":"phasersweep","synonyms_text":"phs","synonyms":["phs"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>most useful values are between 0 and 4000</p>","name":"phasersweep"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phasersweep(\\"<800 2000 4000>\\")"],"longname":"phasersweep","kind":"member","scope":"global"},{"comment":"/**\\n *  The center frequency of the phaser in HZ. Defaults to 1000\\n *\\n * @name phasercenter\\n * @synonyms phc\\n * @param {number | Pattern} centerfrequency in HZ\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phasercenter(\\"<800 2000 4000>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":685,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>The center frequency of the phaser in HZ. Defaults to 1000</p>","name":"phasercenter","synonyms_text":"phc","synonyms":["phc"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>in HZ</p>","name":"centerfrequency"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phasercenter(\\"<800 2000 4000>\\")"],"longname":"phasercenter","kind":"member","scope":"global"},{"comment":"/**\\n * The amount the signal is affected by the phaser effect. Defaults to 0.75\\n *\\n * @name phaserdepth\\n * @synonyms phd\\n * @param {number | Pattern} depth number between 0 and 1\\n * @example\\n * n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n * .phaser(2).phaserdepth(\\"<0 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":699,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>The amount the signal is affected by the phaser effect. Defaults to 0.75</p>","name":"phaserdepth","synonyms_text":"phd","synonyms":["phd"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>number between 0 and 1</p>","name":"depth"}],"examples":["n(run(8)).scale(\\"D:pentatonic\\").s(\\"sawtooth\\").release(0.5)\\n.phaser(2).phaserdepth(\\"<0 .5 .75 1>\\")"],"longname":"phaserdepth","kind":"member","scope":"global"},{"comment":"/**\\n * choose the channel the pattern is sent to in superdirt\\n *\\n * @name channel\\n * @param {number | Pattern} channel channel number\\n *\\n */","meta":{"filename":"controls.mjs","lineno":713,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>choose the channel the pattern is sent to in superdirt</p>","name":"channel","params":[{"type":{"names":["number","Pattern"]},"description":"<p>channel number</p>","name":"channel"}],"longname":"channel","kind":"member","scope":"global"},{"comment":"/**\\n * In the style of classic drum-machines, \`cut\` will stop a playing sample as soon as another samples with in same cutgroup is to be played. An example would be an open hi-hat followed by a closed one, essentially muting the open.\\n *\\n * @name cut\\n * @param {number | Pattern} group cut group number\\n * @example\\n * s(\\"[oh hh]*4\\").cut(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":721,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>In the style of classic drum-machines, <code>cut</code> will stop a playing sample as soon as another samples with in same cutgroup is to be played. An example would be an open hi-hat followed by a closed one, essentially muting the open.</p>","name":"cut","params":[{"type":{"names":["number","Pattern"]},"description":"<p>cut group number</p>","name":"group"}],"examples":["s(\\"[oh hh]*4\\").cut(1)"],"longname":"cut","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the cutoff frequency of the **l**ow-**p**ass **f**ilter.\\n *\\n * When using mininotation, you can also optionally add the 'lpq' parameter, separated by ':'.\\n *\\n * @name lpf\\n * @param {number | Pattern} frequency audible between 0 and 20000\\n * @synonyms cutoff, ctf, lp\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*6\\").lpf(\\"<4000 2000 1000 500 200 100>\\")\\n * @example\\n * s(\\"bd*16\\").lpf(\\"1000:0 1000:10 1000:20 1000:30\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":731,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Applies the cutoff frequency of the <strong>l</strong>ow-<strong>p</strong>ass <strong>f</strong>ilter.</p>\\n<p>When using mininotation, you can also optionally add the 'lpq' parameter, separated by ':'.</p>","name":"lpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>audible between 0 and 20000</p>","name":"frequency"}],"synonyms_text":"cutoff, ctf, lp","synonyms":["cutoff","ctf","lp"],"examples":["s(\\"bd sd [~ bd] sd,hh*6\\").lpf(\\"<4000 2000 1000 500 200 100>\\")","s(\\"bd*16\\").lpf(\\"1000:0 1000:10 1000:20 1000:30\\")"],"longname":"lpf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the lowpass filter envelope modulation depth.\\n * @name lpenv\\n * @param {number | Pattern} modulation depth of the lowpass filter envelope between 0 and _n_\\n * @synonyms lpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpa(.5)\\n * .lpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":747,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the lowpass filter envelope modulation depth.</p>","name":"lpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the lowpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"lpe","synonyms":["lpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpa(.5)\\n.lpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"lpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the highpass filter envelope modulation depth.\\n * @name hpenv\\n * @param {number | Pattern} modulation depth of the highpass filter envelope between 0 and _n_\\n * @synonyms hpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpa(.5)\\n * .hpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":760,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the highpass filter envelope modulation depth.</p>","name":"hpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the highpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"hpe","synonyms":["hpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpa(.5)\\n.hpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"hpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the bandpass filter envelope modulation depth.\\n * @name bpenv\\n * @param {number | Pattern} modulation depth of the bandpass filter envelope between 0 and _n_\\n * @synonyms bpe\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpa(.5)\\n * .bpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")\\n */","meta":{"filename":"controls.mjs","lineno":773,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the bandpass filter envelope modulation depth.</p>","name":"bpenv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>depth of the bandpass filter envelope between 0 and <em>n</em></p>","name":"modulation"}],"synonyms_text":"bpe","synonyms":["bpe"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpa(.5)\\n.bpenv(\\"<4 2 1 0 -1 -2 -4>/4\\")"],"longname":"bpenv","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the lowpass filter envelope.\\n * @name lpattack\\n * @param {number | Pattern} attack time of the filter envelope\\n * @synonyms lpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpa(\\"<.5 .25 .1 .01>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":786,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the lowpass filter envelope.</p>","name":"lpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"attack"}],"synonyms_text":"lpa","synonyms":["lpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpa(\\"<.5 .25 .1 .01>/4\\")\\n.lpenv(4)"],"longname":"lpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the highpass filter envelope.\\n * @name hpattack\\n * @param {number | Pattern} attack time of the highpass filter envelope\\n * @synonyms hpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpa(\\"<.5 .25 .1 .01>/4\\")\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":799,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the highpass filter envelope.</p>","name":"hpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"attack"}],"synonyms_text":"hpa","synonyms":["hpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpa(\\"<.5 .25 .1 .01>/4\\")\\n.hpenv(4)"],"longname":"hpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the attack duration for the bandpass filter envelope.\\n * @name bpattack\\n * @param {number | Pattern} attack time of the bandpass filter envelope\\n * @synonyms bpa\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpa(\\"<.5 .25 .1 .01>/4\\")\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":812,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the attack duration for the bandpass filter envelope.</p>","name":"bpattack","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"attack"}],"synonyms_text":"bpa","synonyms":["bpa"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpa(\\"<.5 .25 .1 .01>/4\\")\\n.bpenv(4)"],"longname":"bpattack","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the lowpass filter envelope.\\n * @name lpdecay\\n * @param {number | Pattern} decay time of the filter envelope\\n * @synonyms lpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpd(\\"<.5 .25 .1 0>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":825,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the lowpass filter envelope.</p>","name":"lpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"decay"}],"synonyms_text":"lpd","synonyms":["lpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpd(\\"<.5 .25 .1 0>/4\\")\\n.lpenv(4)"],"longname":"lpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the highpass filter envelope.\\n * @name hpdecay\\n * @param {number | Pattern} decay time of the highpass filter envelope\\n * @synonyms hpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpd(\\"<.5 .25 .1 0>/4\\")\\n * .hps(0.2)\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":838,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the highpass filter envelope.</p>","name":"hpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"decay"}],"synonyms_text":"hpd","synonyms":["hpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpd(\\"<.5 .25 .1 0>/4\\")\\n.hps(0.2)\\n.hpenv(4)"],"longname":"hpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the decay duration for the bandpass filter envelope.\\n * @name bpdecay\\n * @param {number | Pattern} decay time of the bandpass filter envelope\\n * @synonyms bpd\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpd(\\"<.5 .25 .1 0>/4\\")\\n * .bps(0.2)\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":852,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the decay duration for the bandpass filter envelope.</p>","name":"bpdecay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"decay"}],"synonyms_text":"bpd","synonyms":["bpd"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpd(\\"<.5 .25 .1 0>/4\\")\\n.bps(0.2)\\n.bpenv(4)"],"longname":"bpdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the lowpass filter envelope.\\n * @name lpsustain\\n * @param {number | Pattern} sustain amplitude of the lowpass filter envelope\\n * @synonyms lps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .lpf(300)\\n * .lpd(.5)\\n * .lps(\\"<0 .25 .5 1>/4\\")\\n * .lpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":866,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the lowpass filter envelope.</p>","name":"lpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the lowpass filter envelope</p>","name":"sustain"}],"synonyms_text":"lps","synonyms":["lps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.lpf(300)\\n.lpd(.5)\\n.lps(\\"<0 .25 .5 1>/4\\")\\n.lpenv(4)"],"longname":"lpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the highpass filter envelope.\\n * @name hpsustain\\n * @param {number | Pattern} sustain amplitude of the highpass filter envelope\\n * @synonyms hps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .hpf(500)\\n * .hpd(.5)\\n * .hps(\\"<0 .25 .5 1>/4\\")\\n * .hpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":880,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the highpass filter envelope.</p>","name":"hpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the highpass filter envelope</p>","name":"sustain"}],"synonyms_text":"hps","synonyms":["hps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.hpf(500)\\n.hpd(.5)\\n.hps(\\"<0 .25 .5 1>/4\\")\\n.hpenv(4)"],"longname":"hpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sustain amplitude for the bandpass filter envelope.\\n * @name bpsustain\\n * @param {number | Pattern} sustain amplitude of the bandpass filter envelope\\n * @synonyms bps\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .bpf(500)\\n * .bpd(.5)\\n * .bps(\\"<0 .25 .5 1>/4\\")\\n * .bpenv(4)\\n */","meta":{"filename":"controls.mjs","lineno":894,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the sustain amplitude for the bandpass filter envelope.</p>","name":"bpsustain","params":[{"type":{"names":["number","Pattern"]},"description":"<p>amplitude of the bandpass filter envelope</p>","name":"sustain"}],"synonyms_text":"bps","synonyms":["bps"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.bpf(500)\\n.bpd(.5)\\n.bps(\\"<0 .25 .5 1>/4\\")\\n.bpenv(4)"],"longname":"bpsustain","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the lowpass filter envelope.\\n * @name lprelease\\n * @param {number | Pattern} release time of the filter envelope\\n * @synonyms lpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .lpf(300)\\n * .lpenv(4)\\n * .lpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":908,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the lowpass filter envelope.</p>","name":"lprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the filter envelope</p>","name":"release"}],"synonyms_text":"lpr","synonyms":["lpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.lpf(300)\\n.lpenv(4)\\n.lpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"lprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the highpass filter envelope.\\n * @name hprelease\\n * @param {number | Pattern} release time of the highpass filter envelope\\n * @synonyms hpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .hpf(500)\\n * .hpenv(4)\\n * .hpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":923,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the highpass filter envelope.</p>","name":"hprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the highpass filter envelope</p>","name":"release"}],"synonyms_text":"hpr","synonyms":["hpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.hpf(500)\\n.hpenv(4)\\n.hpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"hprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the release time for the bandpass filter envelope.\\n * @name bprelease\\n * @param {number | Pattern} release time of the bandpass filter envelope\\n * @synonyms bpr\\n * @example\\n * note(\\"c2 e2 f2 g2\\")\\n * .sound('sawtooth')\\n * .clip(.5)\\n * .bpf(500)\\n * .bpenv(4)\\n * .bpr(\\"<.5 .25 .1 0>/4\\")\\n * .release(.5)\\n */","meta":{"filename":"controls.mjs","lineno":938,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the release time for the bandpass filter envelope.</p>","name":"bprelease","params":[{"type":{"names":["number","Pattern"]},"description":"<p>time of the bandpass filter envelope</p>","name":"release"}],"synonyms_text":"bpr","synonyms":["bpr"],"examples":["note(\\"c2 e2 f2 g2\\")\\n.sound('sawtooth')\\n.clip(.5)\\n.bpf(500)\\n.bpenv(4)\\n.bpr(\\"<.5 .25 .1 0>/4\\")\\n.release(.5)"],"longname":"bprelease","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the filter type. The ladder filter is more aggressive. More types might be added in the future.\\n * @name ftype\\n * @param {number | Pattern} type 12db (0), ladder (1), or 24db (2)\\n * @example\\n * note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpenv(4).lpf(500).ftype(\\"<0 1 2>\\").lpq(1)\\n * @example\\n * note(\\"c f g g a c d4\\").fast(2)\\n * .sound('sawtooth')\\n * .lpf(200).fanchor(0)\\n * .lpenv(3).lpq(1)\\n * .ftype(\\"<ladder 12db 24db>\\")\\n */","meta":{"filename":"controls.mjs","lineno":953,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the filter type. The ladder filter is more aggressive. More types might be added in the future.</p>","name":"ftype","params":[{"type":{"names":["number","Pattern"]},"description":"<p>12db (0), ladder (1), or 24db (2)</p>","name":"type"}],"examples":["note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpenv(4).lpf(500).ftype(\\"<0 1 2>\\").lpq(1)","note(\\"c f g g a c d4\\").fast(2)\\n.sound('sawtooth')\\n.lpf(200).fanchor(0)\\n.lpenv(3).lpq(1)\\n.ftype(\\"<ladder 12db 24db>\\")"],"longname":"ftype","kind":"member","scope":"global"},{"comment":"/**\\n * controls the center of the filter envelope. 0 is unipolar positive, .5 is bipolar, 1 is unipolar negative\\n * @name fanchor\\n * @param {number | Pattern} center 0 to 1\\n * @example\\n * note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpf(\\"{1000}%2\\")\\n * .lpenv(8).fanchor(\\"<0 .5 1>\\")\\n */","meta":{"filename":"controls.mjs","lineno":968,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>controls the center of the filter envelope. 0 is unipolar positive, .5 is bipolar, 1 is unipolar negative</p>","name":"fanchor","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 to 1</p>","name":"center"}],"examples":["note(\\"{f g g c d a a#}%8\\").s(\\"sawtooth\\").lpf(\\"{1000}%2\\")\\n.lpenv(8).fanchor(\\"<0 .5 1>\\")"],"longname":"fanchor","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the cutoff frequency of the **h**igh-**p**ass **f**ilter.\\n *\\n * When using mininotation, you can also optionally add the 'hpq' parameter, separated by ':'.\\n *\\n * @name hpf\\n * @param {number | Pattern} frequency audible between 0 and 20000\\n * @synonyms hp, hcutoff\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<4000 2000 1000 500 200 100>\\")\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<2000 2000:25>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":977,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Applies the cutoff frequency of the <strong>h</strong>igh-<strong>p</strong>ass <strong>f</strong>ilter.</p>\\n<p>When using mininotation, you can also optionally add the 'hpq' parameter, separated by ':'.</p>","name":"hpf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>audible between 0 and 20000</p>","name":"frequency"}],"synonyms_text":"hp, hcutoff","synonyms":["hp","hcutoff"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<4000 2000 1000 500 200 100>\\")","s(\\"bd sd [~ bd] sd,hh*8\\").hpf(\\"<2000 2000:25>\\")"],"longname":"hpf","kind":"member","scope":"global"},{"comment":"/**\\n * Applies a vibrato to the frequency of the oscillator.\\n *\\n * @name vib\\n * @synonyms vibrato, v\\n * @param {number | Pattern} frequency of the vibrato in hertz\\n * @example\\n * note(\\"a e\\")\\n * .vib(\\"<.5 1 2 4 8 16>\\")\\n * ._scope()\\n * @example\\n * // change the modulation depth with \\":\\"\\n * note(\\"a e\\")\\n * .vib(\\"<.5 1 2 4 8 16>:12\\")\\n * ._scope()\\n */","meta":{"filename":"controls.mjs","lineno":993,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Applies a vibrato to the frequency of the oscillator.</p>","name":"vib","synonyms_text":"vibrato, v","synonyms":["vibrato","v"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>of the vibrato in hertz</p>","name":"frequency"}],"examples":["note(\\"a e\\")\\n.vib(\\"<.5 1 2 4 8 16>\\")\\n._scope()","// change the modulation depth with \\":\\"\\nnote(\\"a e\\")\\n.vib(\\"<.5 1 2 4 8 16>:12\\")\\n._scope()"],"longname":"vib","kind":"member","scope":"global"},{"comment":"/**\\n * Adds pink noise to the mix\\n *\\n * @name noise\\n * @param {number | Pattern} wet wet amount\\n * @example\\n * sound(\\"<white pink brown>/2\\")\\n */","meta":{"filename":"controls.mjs","lineno":1010,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Adds pink noise to the mix</p>","name":"noise","params":[{"type":{"names":["number","Pattern"]},"description":"<p>wet amount</p>","name":"wet"}],"examples":["sound(\\"<white pink brown>/2\\")"],"longname":"noise","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the vibrato depth in semitones. Only has an effect if \`vibrato\` | \`vib\` | \`v\` is is also set\\n *\\n * @name vibmod\\n * @synonyms vmod\\n * @param {number | Pattern} depth of vibrato (in semitones)\\n * @example\\n * note(\\"a e\\").vib(4)\\n * .vibmod(\\"<.25 .5 1 2 12>\\")\\n * ._scope()\\n * @example\\n * // change the vibrato frequency with \\":\\"\\n * note(\\"a e\\")\\n * .vibmod(\\"<.25 .5 1 2 12>:8\\")\\n * ._scope()\\n */","meta":{"filename":"controls.mjs","lineno":1019,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the vibrato depth in semitones. Only has an effect if <code>vibrato</code> | <code>vib</code> | <code>v</code> is is also set</p>","name":"vibmod","synonyms_text":"vmod","synonyms":["vmod"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>of vibrato (in semitones)</p>","name":"depth"}],"examples":["note(\\"a e\\").vib(4)\\n.vibmod(\\"<.25 .5 1 2 12>\\")\\n._scope()","// change the vibrato frequency with \\":\\"\\nnote(\\"a e\\")\\n.vibmod(\\"<.25 .5 1 2 12>:8\\")\\n._scope()"],"longname":"vibmod","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the **h**igh-**p**ass **q**-value.\\n *\\n * @name hpq\\n * @param {number | Pattern} q resonance factor between 0 and 50\\n * @synonyms hresonance\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").hpf(2000).hpq(\\"<0 10 20 30>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1037,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Controls the <strong>h</strong>igh-<strong>p</strong>ass <strong>q</strong>-value.</p>","name":"hpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>resonance factor between 0 and 50</p>","name":"q"}],"synonyms_text":"hresonance","synonyms":["hresonance"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").hpf(2000).hpq(\\"<0 10 20 30>\\")"],"longname":"hpq","kind":"member","scope":"global"},{"comment":"/**\\n * Controls the **l**ow-**p**ass **q**-value.\\n *\\n * @name lpq\\n * @param {number | Pattern} q resonance factor between 0 and 50\\n * @synonyms resonance\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").lpf(2000).lpq(\\"<0 10 20 30>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1048,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Controls the <strong>l</strong>ow-<strong>p</strong>ass <strong>q</strong>-value.</p>","name":"lpq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>resonance factor between 0 and 50</p>","name":"q"}],"synonyms_text":"resonance","synonyms":["resonance"],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").lpf(2000).lpq(\\"<0 10 20 30>\\")"],"longname":"lpq","kind":"member","scope":"global"},{"comment":"/**\\n * DJ filter, below 0.5 is low pass filter, above is high pass filter.\\n *\\n * @name djf\\n * @param {number | Pattern} cutoff below 0.5 is low pass filter, above is high pass filter\\n * @example\\n * n(\\"0 3 7 [10,24]\\").s('superzow').octave(3).djf(\\"<.5 .25 .5 .75>\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1060,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>DJ filter, below 0.5 is low pass filter, above is high pass filter.</p>","name":"djf","params":[{"type":{"names":["number","Pattern"]},"description":"<p>below 0.5 is low pass filter, above is high pass filter</p>","name":"cutoff"}],"examples":["n(\\"0 3 7 [10,24]\\").s('superzow').octave(3).djf(\\"<.5 .25 .5 .75>\\").osc()"],"longname":"djf","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the delay signal.\\n *\\n * When using mininotation, you can also optionally add the 'delaytime' and 'delayfeedback' parameter,\\n * separated by ':'.\\n *\\n *\\n * @name delay\\n * @param {number | Pattern} level between 0 and 1\\n * @example\\n * s(\\"bd bd\\").delay(\\"<0 .25 .5 1>\\")\\n * @example\\n * s(\\"bd bd\\").delay(\\"0.65:0.25:0.9 0.65:0.125:0.7\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1072,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the level of the delay signal.</p>\\n<p>When using mininotation, you can also optionally add the 'delaytime' and 'delayfeedback' parameter,\\nseparated by ':'.</p>","name":"delay","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"level"}],"examples":["s(\\"bd bd\\").delay(\\"<0 .25 .5 1>\\")","s(\\"bd bd\\").delay(\\"0.65:0.25:0.9 0.65:0.125:0.7\\")"],"longname":"delay","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of the signal that is fed back into the delay.\\n * Caution: Values >= 1 will result in a signal that gets louder and louder! Don't do it\\n *\\n * @name delayfeedback\\n * @param {number | Pattern} feedback between 0 and 1\\n * @synonyms delayfb, dfb\\n * @example\\n * s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1088,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the level of the signal that is fed back into the delay.\\nCaution: Values &gt;= 1 will result in a signal that gets louder and louder! Don't do it</p>","name":"delayfeedback","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"feedback"}],"synonyms_text":"delayfb, dfb","synonyms":["delayfb","dfb"],"examples":["s(\\"bd\\").delay(.25).delayfeedback(\\"<.25 .5 .75 1>\\")"],"longname":"delayfeedback","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the time of the delay effect.\\n *\\n * @name delaytime\\n * @param {number | Pattern} seconds between 0 and Infinity\\n * @synonyms delayt, dt\\n * @example\\n * s(\\"bd bd\\").delay(.25).delaytime(\\"<.125 .25 .5 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1100,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the time of the delay effect.</p>","name":"delaytime","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and Infinity</p>","name":"seconds"}],"synonyms_text":"delayt, dt","synonyms":["delayt","dt"],"examples":["s(\\"bd bd\\").delay(.25).delaytime(\\"<.125 .25 .5 1>\\")"],"longname":"delaytime","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the time of the delay effect in cycles.\\n *\\n * @name delaysync\\n * @param {number | Pattern} cycles delay length in cycles\\n * @synonyms delayt, dt\\n * @example\\n * s(\\"bd bd\\").delay(.25).delaysync(\\"<1 2 3 5>\\".div(8))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1112,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the time of the delay effect in cycles.</p>","name":"delaysync","params":[{"type":{"names":["number","Pattern"]},"description":"<p>delay length in cycles</p>","name":"cycles"}],"synonyms_text":"delayt, dt","synonyms":["delayt","dt"],"examples":["s(\\"bd bd\\").delay(.25).delaysync(\\"<1 2 3 5>\\".div(8))"],"longname":"delaysync","kind":"member","scope":"global"},{"comment":"/**\\n * Specifies whether delaytime is calculated relative to cps.\\n *\\n * @name lock\\n * @param {number | Pattern} enable When set to 1, delaytime is a direct multiple of a cycle.\\n * @superdirtOnly\\n * @example\\n * s(\\"sd\\").delay().lock(1).osc()\\n *\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1124,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Specifies whether delaytime is calculated relative to cps.</p>","name":"lock","params":[{"type":{"names":["number","Pattern"]},"description":"<p>When set to 1, delaytime is a direct multiple of a cycle.</p>","name":"enable"}],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"examples":["s(\\"sd\\").delay().lock(1).osc()"],"longname":"lock","kind":"member","scope":"global"},{"comment":"/**\\n * Set detune for stacked voices of supported oscillators\\n *\\n * @name detune\\n * @param {number | Pattern} amount\\n * @synonyms det\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").detune(\\"<.1 .2 .5 24.1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1137,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Set detune for stacked voices of supported oscillators</p>","name":"detune","params":[{"type":{"names":["number","Pattern"]},"name":"amount"}],"synonyms_text":"det","synonyms":["det"],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").detune(\\"<.1 .2 .5 24.1>\\")"],"longname":"detune","kind":"member","scope":"global"},{"comment":"/**\\n * Set number of stacked voices for supported oscillators\\n *\\n * @name unison\\n * @param {number | Pattern} numvoices\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").unison(\\"<1 2 7>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1148,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Set number of stacked voices for supported oscillators</p>","name":"unison","params":[{"type":{"names":["number","Pattern"]},"name":"numvoices"}],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").unison(\\"<1 2 7>\\")"],"longname":"unison","kind":"member","scope":"global"},{"comment":"/**\\n * Set the stereo pan spread for supported oscillators\\n *\\n * @name spread\\n * @param {number | Pattern} spread between 0 and 1\\n * @example\\n * note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").spread(\\"<0 .3 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1159,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Set the stereo pan spread for supported oscillators</p>","name":"spread","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"spread"}],"examples":["note(\\"d f a a# a d3\\").fast(2).s(\\"supersaw\\").spread(\\"<0 .3 1>\\")"],"longname":"spread","kind":"member","scope":"global"},{"comment":"/**\\n * Set dryness of reverb. See \`room\` and \`size\` for more information about reverb.\\n *\\n * @name dry\\n * @param {number | Pattern} dry 0 = wet, 1 = dry\\n * @example\\n * n(\\"[0,3,7](3,8)\\").s(\\"superpiano\\").room(.7).dry(\\"<0 .5 .75 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1169,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Set dryness of reverb. See <code>room</code> and <code>size</code> for more information about reverb.</p>","name":"dry","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 = wet, 1 = dry</p>","name":"dry"}],"examples":["n(\\"[0,3,7](3,8)\\").s(\\"superpiano\\").room(.7).dry(\\"<0 .5 .75 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"dry","kind":"member","scope":"global"},{"comment":"/**\\n * Set frequency of sound.\\n *\\n * @name freq\\n * @param {number | Pattern} frequency in Hz. the audible range is between 20 and 20000 Hz\\n * @example\\n * freq(\\"220 110 440 110\\").s(\\"superzow\\").osc()\\n * @example\\n * freq(\\"110\\".mul.out(\\".5 1.5 .6 [2 3]\\")).s(\\"superzow\\").osc()\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1193,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Set frequency of sound.</p>","name":"freq","params":[{"type":{"names":["number","Pattern"]},"description":"<p>in Hz. the audible range is between 20 and 20000 Hz</p>","name":"frequency"}],"examples":["freq(\\"220 110 440 110\\").s(\\"superzow\\").osc()","freq(\\"110\\".mul.out(\\".5 1.5 .6 [2 3]\\")).s(\\"superzow\\").osc()"],"longname":"freq","kind":"member","scope":"global"},{"comment":"/**\\n * Attack time of pitch envelope.\\n *\\n * @name pattack\\n * @synonyms patt\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"c eb g bb\\").pattack(\\"0 .1 .25 .5\\").slow(2)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1206,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Attack time of pitch envelope.</p>","name":"pattack","synonyms_text":"patt","synonyms":["patt"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"c eb g bb\\").pattack(\\"0 .1 .25 .5\\").slow(2)"],"longname":"pattack","kind":"member","scope":"global"},{"comment":"/**\\n * Decay time of pitch envelope.\\n *\\n * @name pdecay\\n * @synonyms pdec\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"<c eb g bb>\\").pdecay(\\"<0 .1 .25 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1217,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Decay time of pitch envelope.</p>","name":"pdecay","synonyms_text":"pdec","synonyms":["pdec"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"<c eb g bb>\\").pdecay(\\"<0 .1 .25 .5>\\")"],"longname":"pdecay","kind":"member","scope":"global"},{"comment":"/**\\n * Release time of pitch envelope\\n *\\n * @name prelease\\n * @synonyms prel\\n * @param {number | Pattern} time time in seconds\\n * @example\\n * note(\\"<c eb g bb> ~\\")\\n * .release(.5) // to hear the pitch release\\n * .prelease(\\"<0 .1 .25 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1230,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Release time of pitch envelope</p>","name":"prelease","synonyms_text":"prel","synonyms":["prel"],"params":[{"type":{"names":["number","Pattern"]},"description":"<p>time in seconds</p>","name":"time"}],"examples":["note(\\"<c eb g bb> ~\\")\\n.release(.5) // to hear the pitch release\\n.prelease(\\"<0 .1 .25 .5>\\")"],"longname":"prelease","kind":"member","scope":"global"},{"comment":"/**\\n * Amount of pitch envelope. Negative values will flip the envelope.\\n * If you don't set other pitch envelope controls, \`pattack:.2\` will be the default.\\n *\\n * @name penv\\n * @param {number | Pattern} semitones change in semitones\\n * @example\\n * note(\\"c\\")\\n * .penv(\\"<12 7 1 .5 0 -1 -7 -12>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1243,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Amount of pitch envelope. Negative values will flip the envelope.\\nIf you don't set other pitch envelope controls, <code>pattack:.2</code> will be the default.</p>","name":"penv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>change in semitones</p>","name":"semitones"}],"examples":["note(\\"c\\")\\n.penv(\\"<12 7 1 .5 0 -1 -7 -12>\\")"],"longname":"penv","kind":"member","scope":"global"},{"comment":"/**\\n * Curve of envelope. Defaults to linear. exponential is good for kicks\\n *\\n * @name pcurve\\n * @param {number | Pattern} type 0 = linear, 1 = exponential\\n * @example\\n * note(\\"g1*4\\")\\n * .s(\\"sine\\").pdec(.5)\\n * .penv(32)\\n * .pcurve(\\"<0 1>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1255,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Curve of envelope. Defaults to linear. exponential is good for kicks</p>","name":"pcurve","params":[{"type":{"names":["number","Pattern"]},"description":"<p>0 = linear, 1 = exponential</p>","name":"type"}],"examples":["note(\\"g1*4\\")\\n.s(\\"sine\\").pdec(.5)\\n.penv(32)\\n.pcurve(\\"<0 1>\\")"],"longname":"pcurve","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the range anchor of the envelope:\\n * - anchor 0: range = [note, note + penv]\\n * - anchor 1: range = [note - penv, note]\\n * If you don't set an anchor, the value will default to the psustain value.\\n *\\n * @name panchor\\n * @param {number | Pattern} anchor anchor offset\\n * @example\\n * note(\\"c c4\\").penv(12).panchor(\\"<0 .5 1 .5>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1268,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the range anchor of the envelope:</p>\\n<ul>\\n<li>anchor 0: range = [note, note + penv]</li>\\n<li>anchor 1: range = [note - penv, note]\\nIf you don't set an anchor, the value will default to the psustain value.</li>\\n</ul>","name":"panchor","params":[{"type":{"names":["number","Pattern"]},"description":"<p>anchor offset</p>","name":"anchor"}],"examples":["note(\\"c c4\\").penv(12).panchor(\\"<0 .5 1 .5>\\")"],"longname":"panchor","kind":"member","scope":"global"},{"comment":"/**\\n * Emulation of a Leslie speaker: speakers rotating in a wooden amplified cabinet.\\n *\\n * @name leslie\\n * @param {number | Pattern} wet between 0 and 1\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(\\"<0 .4 .6 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1292,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Emulation of a Leslie speaker: speakers rotating in a wooden amplified cabinet.</p>","name":"leslie","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"wet"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(\\"<0 .4 .6 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"leslie","kind":"member","scope":"global"},{"comment":"/**\\n * Rate of modulation / rotation for leslie effect\\n *\\n * @name lrate\\n * @param {number | Pattern} rate 6.7 for fast, 0.7 for slow\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(\\"<1 2 4 8>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1303,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Rate of modulation / rotation for leslie effect</p>","name":"lrate","params":[{"type":{"names":["number","Pattern"]},"description":"<p>6.7 for fast, 0.7 for slow</p>","name":"rate"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(\\"<1 2 4 8>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"lrate","kind":"member","scope":"global"},{"comment":"/**\\n * Physical size of the cabinet in meters. Be careful, it might be slightly larger than your computer. Affects the Doppler amount (pitch warble)\\n *\\n * @name lsize\\n * @param {number | Pattern} meters somewhere between 0 and 1\\n * @example\\n * n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(2).lsize(\\"<.1 .5 1>\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1315,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Physical size of the cabinet in meters. Be careful, it might be slightly larger than your computer. Affects the Doppler amount (pitch warble)</p>","name":"lsize","params":[{"type":{"names":["number","Pattern"]},"description":"<p>somewhere between 0 and 1</p>","name":"meters"}],"examples":["n(\\"0,4,7\\").s(\\"supersquare\\").leslie(1).lrate(2).lsize(\\"<.1 .5 1>\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"lsize","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the displayed text for an event on the pianoroll\\n *\\n * @name label\\n * @param {string} label text to display\\n */","meta":{"filename":"controls.mjs","lineno":1326,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the displayed text for an event on the pianoroll</p>","name":"label","params":[{"type":{"names":["string"]},"description":"<p>text to display</p>","name":"label"}],"longname":"label","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the default octave of a synth.\\n *\\n * @name octave\\n * @param {number | Pattern} octave octave number\\n * @example\\n * n(\\"0,4,7\\").s('supersquare').octave(\\"<3 4 5 6>\\").osc()\\n * @superDirtOnly\\n */","meta":{"filename":"controls.mjs","lineno":1362,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the default octave of a synth.</p>","name":"octave","params":[{"type":{"names":["number","Pattern"]},"description":"<p>octave number</p>","name":"octave"}],"examples":["n(\\"0,4,7\\").s('supersquare').octave(\\"<3 4 5 6>\\").osc()"],"tags":[{"originalTitle":"superDirtOnly","title":"superdirtonly","text":""}],"longname":"octave","kind":"member","scope":"global"},{"comment":"/**\\n * An \`orbit\` is a global parameter context for patterns. Patterns with the same orbit will share the same global effects.\\n *\\n * @name orbit\\n * @param {number | Pattern} number\\n * @example\\n * stack(\\n *   s(\\"hh*6\\").delay(.5).delaytime(.25).orbit(1),\\n *   s(\\"~ sd ~ sd\\").delay(.5).delaytime(.125).orbit(2)\\n * )\\n */","meta":{"filename":"controls.mjs","lineno":1375,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>An <code>orbit</code> is a global parameter context for patterns. Patterns with the same orbit will share the same global effects.</p>","name":"orbit","params":[{"type":{"names":["number","Pattern"]},"name":"number"}],"examples":["stack(\\n  s(\\"hh*6\\").delay(.5).delaytime(.25).orbit(1),\\n  s(\\"~ sd ~ sd\\").delay(.5).delaytime(.125).orbit(2)\\n)"],"longname":"orbit","kind":"member","scope":"global"},{"comment":"/**\\n * Sets position in stereo.\\n *\\n * @name pan\\n * @param {number | Pattern} pan between 0 and 1, from left to right (assuming stereo), once round a circle (assuming multichannel)\\n * @example\\n * s(\\"[bd hh]*2\\").pan(\\"<.5 1 .5 0>\\")\\n * @example\\n * s(\\"bd rim sd rim bd ~ cp rim\\").pan(sine.slow(2))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1391,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets position in stereo.</p>","name":"pan","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1, from left to right (assuming stereo), once round a circle (assuming multichannel)</p>","name":"pan"}],"examples":["s(\\"[bd hh]*2\\").pan(\\"<.5 1 .5 0>\\")","s(\\"bd rim sd rim bd ~ cp rim\\").pan(sine.slow(2))"],"longname":"pan","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the level of reverb.\\n *\\n * When using mininotation, you can also optionally add the 'size' parameter, separated by ':'.\\n *\\n * @name room\\n * @param {number | Pattern} level between 0 and 1\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(\\"<0 .2 .4 .6 .8 1>\\")\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(\\"<0.9:1 0.9:4>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1454,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the level of reverb.</p>\\n<p>When using mininotation, you can also optionally add the 'size' parameter, separated by ':'.</p>","name":"room","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"level"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(\\"<0 .2 .4 .6 .8 1>\\")","s(\\"bd sd [~ bd] sd\\").room(\\"<0.9:1 0.9:4>\\")"],"longname":"room","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb lowpass starting frequency (in hertz).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomlp\\n * @synonyms rlp\\n * @param {number} frequency between 0 and 20000hz\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000)\\n */","meta":{"filename":"controls.mjs","lineno":1468,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Reverb lowpass starting frequency (in hertz).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomlp","synonyms_text":"rlp","synonyms":["rlp"],"params":[{"type":{"names":["number"]},"description":"<p>between 0 and 20000hz</p>","name":"frequency"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000)"],"longname":"roomlp","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb lowpass frequency at -60dB (in hertz).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomdim\\n * @synonyms rdim\\n * @param {number} frequency between 0 and 20000hz\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rdim(8000)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rdim(400)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1481,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Reverb lowpass frequency at -60dB (in hertz).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomdim","synonyms_text":"rdim","synonyms":["rdim"],"params":[{"type":{"names":["number"]},"description":"<p>between 0 and 20000hz</p>","name":"frequency"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rdim(8000)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rdim(400)"],"longname":"roomdim","kind":"member","scope":"global"},{"comment":"/**\\n * Reverb fade time (in seconds).\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomfade\\n * @synonyms rfade\\n * @param {number} seconds for the reverb to fade\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rfade(0.5)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rfade(4)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1495,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Reverb fade time (in seconds).\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomfade","synonyms_text":"rfade","synonyms":["rfade"],"params":[{"type":{"names":["number"]},"description":"<p>for the reverb to fade</p>","name":"seconds"}],"examples":["s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(10000).rfade(0.5)","s(\\"bd sd [~ bd] sd\\").room(0.5).rlp(5000).rfade(4)"],"longname":"roomfade","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the sample to use as an impulse response for the reverb.\\n * @name iresponse\\n * @param {string | Pattern} sample to use as an impulse response\\n * @synonyms ir\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).ir(\\"<shaker_large:0 shaker_large:2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1509,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the sample to use as an impulse response for the reverb.</p>","name":"iresponse","params":[{"type":{"names":["string","Pattern"]},"description":"<p>to use as an impulse response</p>","name":"sample"}],"synonyms_text":"ir","synonyms":["ir"],"examples":["s(\\"bd sd [~ bd] sd\\").room(.8).ir(\\"<shaker_large:0 shaker_large:2>\\")"],"longname":"iresponse","kind":"member","scope":"global"},{"comment":"/**\\n * Sets speed of the sample for the impulse response.\\n * @name irspeed\\n * @param {string | Pattern} speed\\n * @example\\n * samples('github:switchangel/pad')\\n * $: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.2).irspeed(\\"<2 1 .5>/2\\").irbegin(.5).roomsize(.5)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1520,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets speed of the sample for the impulse response.</p>","name":"irspeed","params":[{"type":{"names":["string","Pattern"]},"name":"speed"}],"examples":["samples('github:switchangel/pad')\\n$: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.2).irspeed(\\"<2 1 .5>/2\\").irbegin(.5).roomsize(.5)"],"longname":"irspeed","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the beginning of the IR response sample\\n * @name irbegin\\n * @param {string | Pattern} begin between 0 and 1\\n * @synonyms ir\\n * @example\\n * samples('github:switchangel/pad')\\n * $: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.65).irspeed(\\"-2\\").irbegin(\\"<0 .5 .75>/2\\").roomsize(.6)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1531,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the beginning of the IR response sample</p>","name":"irbegin","params":[{"type":{"names":["string","Pattern"]},"description":"<p>between 0 and 1</p>","name":"begin"}],"synonyms_text":"ir","synonyms":["ir"],"examples":["samples('github:switchangel/pad')\\n$: s(\\"brk/2\\").fit().scrub(irand(16).div(16).seg(8)).ir(\\"swpad:4\\").room(.65).irspeed(\\"-2\\").irbegin(\\"<0 .5 .75>/2\\").roomsize(.6)"],"longname":"irbegin","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the room size of the reverb, see \`room\`.\\n * When this property is changed, the reverb will be recaculated, so only change this sparsely..\\n *\\n * @name roomsize\\n * @param {number | Pattern} size between 0 and 10\\n * @synonyms rsize, sz, size\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).rsize(1)\\n * @example\\n * s(\\"bd sd [~ bd] sd\\").room(.8).rsize(4)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1542,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the room size of the reverb, see <code>room</code>.\\nWhen this property is changed, the reverb will be recaculated, so only change this sparsely..</p>","name":"roomsize","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 10</p>","name":"size"}],"synonyms_text":"rsize, sz, size","synonyms":["rsize","sz","size"],"examples":["s(\\"bd sd [~ bd] sd\\").room(.8).rsize(1)","s(\\"bd sd [~ bd] sd\\").room(.8).rsize(4)"],"longname":"roomsize","kind":"member","scope":"global"},{"comment":"/**\\n * (Deprecated) Wave shaping distortion. WARNING: can suddenly get unpredictably loud.\\n * Please use distort instead, which has a more predictable response curve\\n * second option in optional array syntax (ex: \\".9:.5\\") applies a postgain to the output\\n *\\n *\\n * @name shape\\n * @param {number | Pattern} distortion between 0 and 1\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").shape(\\"<0 .2 .4 .6 .8>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1563,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>(Deprecated) Wave shaping distortion. WARNING: can suddenly get unpredictably loud.\\nPlease use distort instead, which has a more predictable response curve\\nsecond option in optional array syntax (ex: &quot;.9:.5&quot;) applies a postgain to the output</p>","name":"shape","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and 1</p>","name":"distortion"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").shape(\\"<0 .2 .4 .6 .8>\\")"],"longname":"shape","kind":"member","scope":"global"},{"comment":"/**\\n * Wave shaping distortion. CAUTION: it can get loud.\\n * Second option in optional array syntax (ex: \\".9:.5\\") applies a postgain to the output.\\n * Most useful values are usually between 0 and 10 (depending on source gain). If you are feeling adventurous, you can turn it up to 11 and beyond ;)\\n *\\n * @name distort\\n * @synonyms dist\\n * @param {number | Pattern} distortion\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\").distort(\\"<0 2 3 10:.5>\\")\\n * @example\\n * note(\\"d1!8\\").s(\\"sine\\").penv(36).pdecay(.12).decay(.23).distort(\\"8:.4\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1576,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Wave shaping distortion. CAUTION: it can get loud.\\nSecond option in optional array syntax (ex: &quot;.9:.5&quot;) applies a postgain to the output.\\nMost useful values are usually between 0 and 10 (depending on source gain). If you are feeling adventurous, you can turn it up to 11 and beyond ;)</p>","name":"distort","synonyms_text":"dist","synonyms":["dist"],"params":[{"type":{"names":["number","Pattern"]},"name":"distortion"}],"examples":["s(\\"bd sd [~ bd] sd,hh*8\\").distort(\\"<0 2 3 10:.5>\\")","note(\\"d1!8\\").s(\\"sine\\").penv(36).pdecay(.12).decay(.23).distort(\\"8:.4\\")"],"longname":"distort","kind":"member","scope":"global"},{"comment":"/**\\n * Dynamics Compressor. The params are \`compressor(\\"threshold:ratio:knee:attack:release\\")\`\\n * More info [here](https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode?retiredLocale=de#instance_properties)\\n *\\n * @name compressor\\n * @example\\n * s(\\"bd sd [~ bd] sd,hh*8\\")\\n * .compressor(\\"-20:20:10:.002:.02\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1591,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Dynamics Compressor. The params are <code>compressor(&quot;threshold:ratio:knee:attack:release&quot;)</code>\\nMore info <a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode?retiredLocale=de#instance_properties\\">here</a></p>","name":"compressor","examples":["s(\\"bd sd [~ bd] sd,hh*8\\")\\n.compressor(\\"-20:20:10:.002:.02\\")"],"longname":"compressor","kind":"member","scope":"global"},{"comment":"/**\\n * Changes the speed of sample playback, i.e. a cheap way of changing pitch.\\n *\\n * @name speed\\n * @param {number | Pattern} speed -inf to inf, negative numbers play the sample backwards.\\n * @example\\n * s(\\"bd*6\\").speed(\\"1 2 4 1 -2 -4\\")\\n * @example\\n * speed(\\"1 1.5*2 [2 1.1]\\").s(\\"piano\\").clip(1)\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1612,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Changes the speed of sample playback, i.e. a cheap way of changing pitch.</p>","name":"speed","params":[{"type":{"names":["number","Pattern"]},"description":"<p>inf to inf, negative numbers play the sample backwards.</p>","name":"speed"}],"examples":["s(\\"bd*6\\").speed(\\"1 2 4 1 -2 -4\\")","speed(\\"1 1.5*2 [2 1.1]\\").s(\\"piano\\").clip(1)"],"longname":"speed","kind":"member","scope":"global"},{"comment":"/**\\n * Changes the speed of sample playback, i.e. a cheap way of changing pitch.\\n *\\n * @name stretch\\n * @param {number | Pattern} factor -inf to inf, negative numbers play the sample backwards.\\n * @example\\n * s(\\"gm_flute\\").stretch(\\"1 2 .5\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1625,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Changes the speed of sample playback, i.e. a cheap way of changing pitch.</p>","name":"stretch","params":[{"type":{"names":["number","Pattern"]},"description":"<p>inf to inf, negative numbers play the sample backwards.</p>","name":"factor"}],"examples":["s(\\"gm_flute\\").stretch(\\"1 2 .5\\")"],"longname":"stretch","kind":"member","scope":"global"},{"comment":"/**\\n * Used in conjunction with \`speed\`, accepts values of \\"r\\" (rate, default behavior), \\"c\\" (cycles), or \\"s\\" (seconds). Using \`unit \\"c\\"\` means \`speed\` will be interpreted in units of cycles, e.g. \`speed \\"1\\"\` means samples will be stretched to fill a cycle. Using \`unit \\"s\\"\` means the playback speed will be adjusted so that the duration is the number of seconds specified by \`speed\`.\\n *\\n * @name unit\\n * @param {number | string | Pattern} unit see description above\\n * @example\\n * speed(\\"1 2 .5 3\\").s(\\"bd\\").unit(\\"c\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1635,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Used in conjunction with <code>speed</code>, accepts values of &quot;r&quot; (rate, default behavior), &quot;c&quot; (cycles), or &quot;s&quot; (seconds). Using <code>unit &quot;c&quot;</code> means <code>speed</code> will be interpreted in units of cycles, e.g. <code>speed &quot;1&quot;</code> means samples will be stretched to fill a cycle. Using <code>unit &quot;s&quot;</code> means the playback speed will be adjusted so that the duration is the number of seconds specified by <code>speed</code>.</p>","name":"unit","params":[{"type":{"names":["number","string","Pattern"]},"description":"<p>see description above</p>","name":"unit"}],"examples":["speed(\\"1 2 .5 3\\").s(\\"bd\\").unit(\\"c\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"unit","kind":"member","scope":"global"},{"comment":"/**\\n * Made by Calum Gunn. Reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter. The SuperCollider manual defines Squiz as:\\n *\\n * \\"A simplistic pitch-raising algorithm. It's not meant to sound natural; its sound is reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter, depending on the input. The algorithm works by cutting the signal into fragments (delimited by upwards-going zero-crossings) and squeezing those fragments in the time domain (i.e. simply playing them back faster than they came in), leaving silences inbetween. All the parameters apart from memlen can be modulated.\\"\\n *\\n * @name squiz\\n * @param {number | Pattern} squiz Try passing multiples of 2 to it - 2, 4, 8 etc.\\n * @example\\n * squiz(\\"2 4/2 6 [8 16]\\").s(\\"bd\\").osc()\\n * @superdirtOnly\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1647,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Made by Calum Gunn. Reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter. The SuperCollider manual defines Squiz as:</p>\\n<p>&quot;A simplistic pitch-raising algorithm. It's not meant to sound natural; its sound is reminiscent of some weird mixture of filter, ring-modulator and pitch-shifter, depending on the input. The algorithm works by cutting the signal into fragments (delimited by upwards-going zero-crossings) and squeezing those fragments in the time domain (i.e. simply playing them back faster than they came in), leaving silences inbetween. All the parameters apart from memlen can be modulated.&quot;</p>","name":"squiz","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Try passing multiples of 2 to it - 2, 4, 8 etc.</p>","name":"squiz"}],"examples":["squiz(\\"2 4/2 6 [8 16]\\").s(\\"bd\\").osc()"],"tags":[{"originalTitle":"superdirtOnly","title":"superdirtonly","text":""}],"longname":"squiz","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Formant filter to make things sound like vowels.\\n *\\n * @name vowel\\n * @param {string | Pattern} vowel You can use a e i o u ae aa oe ue y uh un en an on, corresponding to [a] [e] [i] [o] [u] [æ] [ɑ] [ø] [y] [ɯ] [ʌ] [œ̃] [ɛ̃] [ɑ̃] [ɔ̃]. Aliases: aa = å = ɑ, oe = ø = ö, y = ı, ae = æ.\\n * @example\\n * note(\\"[c2 <eb2 <g2 g1>>]*2\\").s('sawtooth')\\n * .vowel(\\"<a e i <o u>>\\")\\n * @example\\n * s(\\"bd sd mt ht bd [~ cp] ht lt\\").vowel(\\"[a|e|i|o|u]\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1672,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Formant filter to make things sound like vowels.</p>","name":"vowel","params":[{"type":{"names":["string","Pattern"]},"description":"<p>You can use a e i o u ae aa oe ue y uh un en an on, corresponding to [a] [e] [i] [o] [u] [æ] [ɑ] [ø] [y] [ɯ] [ʌ] [œ̃] [ɛ̃] [ɑ̃] [ɔ̃]. Aliases: aa = å = ɑ, oe = ø = ö, y = ı, ae = æ.</p>","name":"vowel"}],"examples":["note(\\"[c2 <eb2 <g2 g1>>]*2\\").s('sawtooth')\\n.vowel(\\"<a e i <o u>>\\")","s(\\"bd sd mt ht bd [~ cp] ht lt\\").vowel(\\"[a|e|i|o|u]\\")"],"longname":"vowel","kind":"member","scope":"global"},{"comment":"/**\\n * Noise crackle density\\n *\\n * @name density\\n * @param {number | Pattern} density between 0 and x\\n * @example\\n * s(\\"crackle*4\\").density(\\"<0.01 0.04 0.2 0.5>\\".slow(4))\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1697,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Noise crackle density</p>","name":"density","params":[{"type":{"names":["number","Pattern"]},"description":"<p>between 0 and x</p>","name":"density"}],"examples":["s(\\"crackle*4\\").density(\\"<0.01 0.04 0.2 0.5>\\".slow(4))"],"longname":"density","kind":"member","scope":"global"},{"comment":"/**\\n * Multiplies the duration with the given number. Also cuts samples off at the end if they exceed the duration.\\n *\\n * @name clip\\n * @synonyms legato\\n * @param {number | Pattern} factor >= 0\\n * @example\\n * note(\\"c a f e\\").s(\\"piano\\").clip(\\"<.5 1 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1747,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Multiplies the duration with the given number. Also cuts samples off at the end if they exceed the duration.</p>","name":"clip","synonyms_text":"legato","synonyms":["legato"],"params":[{"type":{"names":["number","Pattern"]},"description":"<blockquote>\\n<p>= 0</p>\\n</blockquote>","name":"factor"}],"examples":["note(\\"c a f e\\").s(\\"piano\\").clip(\\"<.5 1 2>\\")"],"longname":"clip","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the duration of the event in cycles. Similar to clip / legato, it also cuts samples off at the end if they exceed the duration.\\n *\\n * @name duration\\n * @synonyms dur\\n * @param {number | Pattern} seconds >= 0\\n * @example\\n * note(\\"c a f e\\").s(\\"piano\\").dur(\\"<.5 1 2>\\")\\n *\\n */","meta":{"filename":"controls.mjs","lineno":1759,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the duration of the event in cycles. Similar to clip / legato, it also cuts samples off at the end if they exceed the duration.</p>","name":"duration","synonyms_text":"dur","synonyms":["dur"],"params":[{"type":{"names":["number","Pattern"]},"description":"<blockquote>\\n<p>= 0</p>\\n</blockquote>","name":"seconds"}],"examples":["note(\\"c a f e\\").s(\\"piano\\").dur(\\"<.5 1 2>\\")"],"longname":"duration","kind":"member","scope":"global"},{"comment":"/**\\n * Sets the color of the hap in visualizations like pianoroll or highlighting.\\n * @name color\\n * @synonyms colour\\n * @param {string} color Hexadecimal or CSS color name\\n */","meta":{"filename":"controls.mjs","lineno":1788,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets the color of the hap in visualizations like pianoroll or highlighting.</p>","name":"color","synonyms_text":"colour","synonyms":["colour"],"params":[{"type":{"names":["string"]},"description":"<p>Hexadecimal or CSS color name</p>","name":"color"}],"longname":"color","kind":"member","scope":"global"},{"comment":"/**\\n * ADSR envelope: Combination of Attack, Decay, Sustain, and Release.\\n *\\n * @name adsr\\n * @param {number | Pattern} time attack time in seconds\\n * @param {number | Pattern} time decay time in seconds\\n * @param {number | Pattern} gain sustain level (0 to 1)\\n * @param {number | Pattern} time release time in seconds\\n * @example\\n * note(\\"[c3 bb2 f3 eb3]*2\\").sound(\\"sawtooth\\").lpf(600).adsr(\\".1:.1:.5:.2\\")\\n */","meta":{"filename":"controls.mjs","lineno":1801,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>ADSR envelope: Combination of Attack, Decay, Sustain, and Release.</p>","name":"adsr","params":[{"type":{"names":["number","Pattern"]},"description":"<p>attack time in seconds</p>","name":"time"},{"type":{"names":["number","Pattern"]},"description":"<p>decay time in seconds</p>","name":"time"},{"type":{"names":["number","Pattern"]},"description":"<p>sustain level (0 to 1)</p>","name":"gain"},{"type":{"names":["number","Pattern"]},"description":"<p>release time in seconds</p>","name":"time"}],"examples":["note(\\"[c3 bb2 f3 eb3]*2\\").sound(\\"sawtooth\\").lpf(600).adsr(\\".1:.1:.5:.2\\")"],"longname":"adsr","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI channel: Sets the MIDI channel for the event.\\n *\\n * @name midichan\\n * @param {number | Pattern} channel MIDI channel number (0-15)\\n * @example\\n * note(\\"c4\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1835,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI channel: Sets the MIDI channel for the event.</p>","name":"midichan","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI channel number (0-15)</p>","name":"channel"}],"examples":["note(\\"c4\\").midichan(1).midi()"],"longname":"midichan","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI port: Sets the MIDI port for the event.\\n *\\n * @name midiport\\n * @param {number | Pattern} port MIDI port\\n * @example\\n * note(\\"c a f e\\").midiport(\\"<0 1 2 3>\\").midi()\\n */","meta":{"filename":"controls.mjs","lineno":1847,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI port: Sets the MIDI port for the event.</p>","name":"midiport","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI port</p>","name":"port"}],"examples":["note(\\"c a f e\\").midiport(\\"<0 1 2 3>\\").midi()"],"longname":"midiport","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI command: Sends a MIDI command message.\\n *\\n * @name midicmd\\n * @param {number | Pattern} command MIDI command\\n * @example\\n * midicmd(\\"clock*48,<start stop>/2\\").midi()\\n */","meta":{"filename":"controls.mjs","lineno":1857,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI command: Sends a MIDI command message.</p>","name":"midicmd","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI command</p>","name":"command"}],"examples":["midicmd(\\"clock*48,<start stop>/2\\").midi()"],"longname":"midicmd","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control: Sends a MIDI control change message.\\n *\\n * @name control\\n * @param {number | Pattern}  MIDI control number (0-127)\\n * @param {number | Pattern}  MIDI controller value (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":1867,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI control: Sends a MIDI control change message.</p>","name":"control","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control number (0-127)</p>","name":"MIDI"},{"type":{"names":["number","Pattern"]},"description":"<p>controller value (0-127)</p>","name":"MIDI"}],"longname":"control","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control number: Sends a MIDI control change message.\\n *\\n * @name ccn\\n * @param {number | Pattern}  MIDI control number (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":1882,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI control number: Sends a MIDI control change message.</p>","name":"ccn","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control number (0-127)</p>","name":"MIDI"}],"longname":"ccn","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI control value: Sends a MIDI control change message.\\n *\\n * @name ccv\\n * @param {number | Pattern}  MIDI control value (0-127)\\n */","meta":{"filename":"controls.mjs","lineno":1889,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI control value: Sends a MIDI control change message.</p>","name":"ccv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>control value (0-127)</p>","name":"MIDI"}],"longname":"ccv","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI NRPN non-registered parameter number: Sends a MIDI NRPN non-registered parameter number message.\\n * @name nrpnn\\n * @param {number | Pattern} nrpnn MIDI NRPN non-registered parameter number (0-127)\\n * @example\\n * note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1899,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI NRPN non-registered parameter number: Sends a MIDI NRPN non-registered parameter number message.</p>","name":"nrpnn","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI NRPN non-registered parameter number (0-127)</p>","name":"nrpnn"}],"examples":["note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()"],"longname":"nrpnn","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI NRPN non-registered parameter value: Sends a MIDI NRPN non-registered parameter value message.\\n * @name nrpv\\n * @param {number | Pattern} nrpv MIDI NRPN non-registered parameter value (0-127)\\n * @example\\n * note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1907,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI NRPN non-registered parameter value: Sends a MIDI NRPN non-registered parameter value message.</p>","name":"nrpv","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI NRPN non-registered parameter value (0-127)</p>","name":"nrpv"}],"examples":["note(\\"c4\\").nrpnn(\\"1:8\\").nrpv(\\"123\\").midichan(1).midi()"],"longname":"nrpv","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI program number: Sends a MIDI program change message.\\n *\\n * @name progNum\\n * @param {number | Pattern} program MIDI program number (0-127)\\n * @example\\n * note(\\"c4\\").progNum(10).midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1916,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI program number: Sends a MIDI program change message.</p>","name":"progNum","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI program number (0-127)</p>","name":"program"}],"examples":["note(\\"c4\\").progNum(10).midichan(1).midi()"],"longname":"progNum","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex: Sends a MIDI sysex message.\\n * @name sysex\\n * @param {number | Pattern} id Sysex ID\\n * @param {number | Pattern} data Sysex data\\n * @example\\n * note(\\"c4\\").sysex([\\"0x77\\", \\"0x01:0x02:0x03:0x04\\"]).midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1926,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI sysex: Sends a MIDI sysex message.</p>","name":"sysex","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex ID</p>","name":"id"},{"type":{"names":["number","Pattern"]},"description":"<p>Sysex data</p>","name":"data"}],"examples":["note(\\"c4\\").sysex([\\"0x77\\", \\"0x01:0x02:0x03:0x04\\"]).midichan(1).midi()"],"longname":"sysex","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex ID: Sends a MIDI sysex identifier message.\\n * @name sysexid\\n * @param {number | Pattern} id Sysex ID\\n * @example\\n * note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1941,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI sysex ID: Sends a MIDI sysex identifier message.</p>","name":"sysexid","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex ID</p>","name":"id"}],"examples":["note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()"],"longname":"sysexid","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI sysex data: Sends a MIDI sysex message.\\n * @name sysexdata\\n * @param {number | Pattern} data Sysex data\\n * @example\\n * note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1949,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI sysex data: Sends a MIDI sysex message.</p>","name":"sysexdata","params":[{"type":{"names":["number","Pattern"]},"description":"<p>Sysex data</p>","name":"data"}],"examples":["note(\\"c4\\").sysexid(\\"0x77\\").sysexdata(\\"0x01:0x02:0x03:0x04\\").midichan(1).midi()"],"longname":"sysexdata","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI pitch bend: Sends a MIDI pitch bend message.\\n * @name midibend\\n * @param {number | Pattern} midibend MIDI pitch bend (-1 - 1)\\n * @example\\n * note(\\"c4\\").midibend(sine.slow(4).range(-0.4,0.4)).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1958,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI pitch bend: Sends a MIDI pitch bend message.</p>","name":"midibend","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI pitch bend (-1 - 1)</p>","name":"midibend"}],"examples":["note(\\"c4\\").midibend(sine.slow(4).range(-0.4,0.4)).midi()"],"longname":"midibend","kind":"member","scope":"global"},{"comment":"/**\\n * MIDI key after touch: Sends a MIDI key after touch message.\\n * @name miditouch\\n * @param {number | Pattern} miditouch MIDI key after touch (0-1)\\n * @example\\n * note(\\"c4\\").miditouch(sine.slow(4).range(0,1)).midi()\\n */","meta":{"filename":"controls.mjs","lineno":1966,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>MIDI key after touch: Sends a MIDI key after touch message.</p>","name":"miditouch","params":[{"type":{"names":["number","Pattern"]},"description":"<p>MIDI key after touch (0-1)</p>","name":"miditouch"}],"examples":["note(\\"c4\\").miditouch(sine.slow(4).range(0,1)).midi()"],"longname":"miditouch","kind":"member","scope":"global"},{"comment":"/**\\n * Sets properties in a batch.\\n *\\n * @name as\\n * @param {String | Array} mapping the control names that are set\\n * @example\\n * \\"c:.5 a:1 f:.25 e:.8\\".as(\\"note:clip\\")\\n * @example\\n * \\"{0@2 0.25 0 0.5 .3 .5}%8\\".as(\\"begin\\").s(\\"sax_vib\\").clip(1)\\n */","meta":{"filename":"controls.mjs","lineno":1985,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Sets properties in a batch.</p>","name":"as","params":[{"type":{"names":["String","Array"]},"description":"<p>the control names that are set</p>","name":"mapping"}],"examples":["\\"c:.5 a:1 f:.25 e:.8\\".as(\\"note:clip\\")","\\"{0@2 0.25 0 0.5 .3 .5}%8\\".as(\\"begin\\").s(\\"sax_vib\\").clip(1)"],"longname":"as","kind":"member","scope":"global"},{"comment":"/**\\n * Allows you to scrub an audio file like a tape loop by passing values that represents the position in the audio file\\n * in the optional array syntax ex: \\"0.5:2\\", the second value controls the speed of playback\\n * @name scrub\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples('github:switchangel/pad')\\n * s(\\"swpad:0\\").scrub(\\"{0.1!2 .25@3 0.7!2 <0.8:1.5>}%8\\")\\n * @example\\n * samples('github:yaxu/clean-breaks/main');\\n * s(\\"amen/4\\").fit().scrub(\\"{0@3 0@2 4@3}%8\\".div(16))\\n */","meta":{"filename":"controls.mjs","lineno":2004,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Allows you to scrub an audio file like a tape loop by passing values that represents the position in the audio file\\nin the optional array syntax ex: &quot;0.5:2&quot;, the second value controls the speed of playback</p>","name":"scrub","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples('github:switchangel/pad')\\ns(\\"swpad:0\\").scrub(\\"{0.1!2 .25@3 0.7!2 <0.8:1.5>}%8\\")","samples('github:yaxu/clean-breaks/main');\\ns(\\"amen/4\\").fit().scrub(\\"{0@3 0@2 4@3}%8\\".div(16))"],"scope":"static","longname":"Pattern.scrub","kind":"member"},{"comment":"/**\\n * Intended for a debugging, drawLine renders the pattern as a string, where each character represents the same time span.\\n * Should only be used with single characters as values, otherwise the character slots will be messed up.\\n * Character legend:\\n *\\n * - \\"|\\" cycle separator\\n * - \\"-\\" hold previous value\\n * - \\".\\" silence\\n *\\n * @param {Pattern} pattern the pattern to use\\n * @param {number} chars max number of characters (approximately)\\n * @returns string\\n * @example\\n * const line = drawLine(\\"0 [1 2 3]\\", 10); // |0--123|0--123\\n * console.log(line);\\n * silence;\\n */","meta":{"range":[1426,2796],"filename":"drawLine.mjs","lineno":26,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100019901","name":"drawLine","type":"FunctionDeclaration","paramnames":["pat","chars"]},"vars":{"cycle":"drawLine~cycle","pos":"drawLine~pos","lines":"drawLine~lines","emptyLine":"drawLine~emptyLine","haps":"drawLine~haps","durations":"drawLine~durations","":null,"charFraction":"drawLine~charFraction","totalSlots":"drawLine~totalSlots","i":"drawLine~i","undefined":null,"matches":"drawLine~matches","missingLines":"drawLine~missingLines"}},"description":"<p>Intended for a debugging, drawLine renders the pattern as a string, where each character represents the same time span.\\nShould only be used with single characters as values, otherwise the character slots will be messed up.\\nCharacter legend:</p>\\n<ul>\\n<li>&quot;|&quot; cycle separator</li>\\n<li>&quot;-&quot; hold previous value</li>\\n<li>&quot;.&quot; silence</li>\\n</ul>","params":[{"type":{"names":["Pattern"]},"description":"<p>the pattern to use</p>","name":"pattern"},{"type":{"names":["number"]},"description":"<p>max number of characters (approximately)</p>","name":"chars"}],"returns":[{"description":"<p>string</p>"}],"examples":["const line = drawLine(\\"0 [1 2 3]\\", 10); // |0--123|0--123\\nconsole.log(line);\\nsilence;"],"name":"drawLine","longname":"drawLine","kind":"function","scope":"global"},{"comment":"/**\\n * Changes the structure of the pattern to form an Euclidean rhythm.\\n * Euclidean rhythms are rhythms obtained using the greatest common\\n * divisor of two numbers.  They were described in 2004 by Godfried\\n * Toussaint, a Canadian computer scientist.  Euclidean rhythms are\\n * really useful for computer/algorithmic music because they can\\n * describe a large number of rhythms with a couple of numbers.\\n *\\n * @memberof Pattern\\n * @name euclid\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @returns Pattern\\n * @example\\n * // The Cuban tresillo pattern.\\n * note(\\"c3\\").euclid(3,8)\\n */","meta":{"filename":"euclid.mjs","lineno":54,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Changes the structure of the pattern to form an Euclidean rhythm.\\nEuclidean rhythms are rhythms obtained using the greatest common\\ndivisor of two numbers.  They were described in 2004 by Godfried\\nToussaint, a Canadian computer scientist.  Euclidean rhythms are\\nreally useful for computer/algorithmic music because they can\\ndescribe a large number of rhythms with a couple of numbers.</p>","memberof":"Pattern","name":"euclid","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["// The Cuban tresillo pattern.\\nnote(\\"c3\\").euclid(3,8)"],"scope":"static","longname":"Pattern.euclid","kind":"member"},{"comment":"/**\\n * Like \`euclid\`, but has an additional parameter for 'rotating' the resulting sequence.\\n * @memberof Pattern\\n * @name euclidRot\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param {number} rotation offset in steps\\n * @returns Pattern\\n * @example\\n * // A Samba rhythm necklace from Brazil\\n * note(\\"c3\\").euclidRot(3,16,14)\\n */","meta":{"filename":"euclid.mjs","lineno":72,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like <code>euclid</code>, but has an additional parameter for 'rotating' the resulting sequence.</p>","memberof":"Pattern","name":"euclidRot","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>offset in steps</p>","name":"rotation"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["// A Samba rhythm necklace from Brazil\\nnote(\\"c3\\").euclidRot(3,16,14)"],"scope":"static","longname":"Pattern.euclidRot","kind":"member"},{"comment":"/**\\n * @example // A thirteenth-century Persian rhythm called Khafif-e-ramal.\\n * note(\\"c3\\").euclid(2,5)\\n * @example // The archetypal pattern of the Cumbia from Colombia, as well as a Calypso rhythm from Trinidad.\\n * note(\\"c3\\").euclid(3,4)\\n * @example // Another thirteenth century Persian rhythm by the name of Khafif-e-ramal, as well as a Rumanian folk-dance rhythm.\\n * note(\\"c3\\").euclidRot(3,5,2)\\n * @example // A Ruchenitza rhythm used in a Bulgarian folk dance.\\n * note(\\"c3\\").euclid(3,7)\\n * @example // The Cuban tresillo pattern.\\n * note(\\"c3\\").euclid(3,8)\\n * @example // Another Ruchenitza Bulgarian folk-dance rhythm.\\n * note(\\"c3\\").euclid(4,7)\\n * @example // The Aksak rhythm of Turkey.\\n * note(\\"c3\\").euclid(4,9)\\n * @example // The metric pattern used by Frank Zappa in his piece titled Outside Now.\\n * note(\\"c3\\").euclid(4,11)\\n * @example // Yields the York-Samai pattern, a popular Arab rhythm.\\n * note(\\"c3\\").euclid(5,6)\\n * @example // The Nawakhat pattern, another popular Arab rhythm.\\n * note(\\"c3\\").euclid(5,7)\\n * @example // The Cuban cinquillo pattern.\\n * note(\\"c3\\").euclid(5,8)\\n * @example // A popular Arab rhythm called Agsag-Samai.\\n * note(\\"c3\\").euclid(5,9)\\n * @example // The metric pattern used by Moussorgsky in Pictures at an Exhibition.\\n * note(\\"c3\\").euclid(5,11)\\n * @example // The Venda clapping pattern of a South African children’s song.\\n * note(\\"c3\\").euclid(5,12)\\n * @example // The Bossa-Nova rhythm necklace of Brazil.\\n * note(\\"c3\\").euclid(5,16)\\n * @example // A typical rhythm played on the Bendir (frame drum).\\n * note(\\"c3\\").euclid(7,8)\\n * @example // A common West African bell pattern.\\n * note(\\"c3\\").euclid(7,12)\\n * @example // A Samba rhythm necklace from Brazil.\\n * note(\\"c3\\").euclidRot(7,16,14)\\n * @example // A rhythm necklace used in the Central African Republic.\\n * note(\\"c3\\").euclid(9,16)\\n * @example // A rhythm necklace of the Aka Pygmies of Central Africa.\\n * note(\\"c3\\").euclidRot(11,24,14)\\n * @example // Another rhythm necklace of the Aka Pygmies of the upper Sangha.\\n * note(\\"c3\\").euclidRot(13,24,5)\\n */","meta":{"range":[5307,5459],"filename":"euclid.mjs","lineno":130,"columnno":6,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100020406","name":"_euclidRot","type":"FunctionExpression"},"vars":{"b":"_euclidRot~b"}},"examples":["// A thirteenth-century Persian rhythm called Khafif-e-ramal.\\nnote(\\"c3\\").euclid(2,5)","// The archetypal pattern of the Cumbia from Colombia, as well as a Calypso rhythm from Trinidad.\\nnote(\\"c3\\").euclid(3,4)","// Another thirteenth century Persian rhythm by the name of Khafif-e-ramal, as well as a Rumanian folk-dance rhythm.\\nnote(\\"c3\\").euclidRot(3,5,2)","// A Ruchenitza rhythm used in a Bulgarian folk dance.\\nnote(\\"c3\\").euclid(3,7)","// The Cuban tresillo pattern.\\nnote(\\"c3\\").euclid(3,8)","// Another Ruchenitza Bulgarian folk-dance rhythm.\\nnote(\\"c3\\").euclid(4,7)","// The Aksak rhythm of Turkey.\\nnote(\\"c3\\").euclid(4,9)","// The metric pattern used by Frank Zappa in his piece titled Outside Now.\\nnote(\\"c3\\").euclid(4,11)","// Yields the York-Samai pattern, a popular Arab rhythm.\\nnote(\\"c3\\").euclid(5,6)","// The Nawakhat pattern, another popular Arab rhythm.\\nnote(\\"c3\\").euclid(5,7)","// The Cuban cinquillo pattern.\\nnote(\\"c3\\").euclid(5,8)","// A popular Arab rhythm called Agsag-Samai.\\nnote(\\"c3\\").euclid(5,9)","// The metric pattern used by Moussorgsky in Pictures at an Exhibition.\\nnote(\\"c3\\").euclid(5,11)","// The Venda clapping pattern of a South African children’s song.\\nnote(\\"c3\\").euclid(5,12)","// The Bossa-Nova rhythm necklace of Brazil.\\nnote(\\"c3\\").euclid(5,16)","// A typical rhythm played on the Bendir (frame drum).\\nnote(\\"c3\\").euclid(7,8)","// A common West African bell pattern.\\nnote(\\"c3\\").euclid(7,12)","// A Samba rhythm necklace from Brazil.\\nnote(\\"c3\\").euclidRot(7,16,14)","// A rhythm necklace used in the Central African Republic.\\nnote(\\"c3\\").euclid(9,16)","// A rhythm necklace of the Aka Pygmies of Central Africa.\\nnote(\\"c3\\").euclidRot(11,24,14)","// Another rhythm necklace of the Aka Pygmies of the upper Sangha.\\nnote(\\"c3\\").euclidRot(13,24,5)"],"name":"_euclidRot","longname":"_euclidRot","kind":"function","scope":"global","params":[]},{"comment":"/**\\n * Similar to \`euclid\`, but each pulse is held until the next pulse,\\n * so there will be no gaps.\\n * @name euclidLegato\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param rotation offset in steps\\n * @param pat\\n * @example\\n * note(\\"c3\\").euclidLegato(3,8)\\n */","meta":{"filename":"euclid.mjs","lineno":154,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Similar to <code>euclid</code>, but each pulse is held until the next pulse,\\nso there will be no gaps.</p>","name":"euclidLegato","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"description":"<p>offset in steps</p>","name":"rotation"},{"name":"pat"}],"examples":["note(\\"c3\\").euclidLegato(3,8)"],"scope":"static","longname":"Pattern.euclidLegato","kind":"member"},{"comment":"/**\\n * Similar to \`euclid\`, but each pulse is held until the next pulse,\\n * so there will be no gaps, and has an additional parameter for 'rotating'\\n * the resulting sequence\\n * @name euclidLegatoRot\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets/beats\\n * @param {number} steps the number of steps to fill\\n * @param {number} rotation offset in steps\\n * @example\\n * note(\\"c3\\").euclidLegatoRot(3,5,2)\\n */","meta":{"filename":"euclid.mjs","lineno":184,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Similar to <code>euclid</code>, but each pulse is held until the next pulse,\\nso there will be no gaps, and has an additional parameter for 'rotating'\\nthe resulting sequence</p>","name":"euclidLegatoRot","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets/beats</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>offset in steps</p>","name":"rotation"}],"examples":["note(\\"c3\\").euclidLegatoRot(3,5,2)"],"scope":"static","longname":"Pattern.euclidLegatoRot","kind":"member"},{"comment":"/**\\n * A 'euclid' variant with an additional parameter that morphs the resulting\\n * rhythm from 0 (no morphing) to 1 (completely 'even'). For example\\n * \`sound(\\"bd\\").euclidish(3,8,0)\` would be the same as\\n * \`sound(\\"bd\\").euclid(3,8)\`, and \`sound(\\"bd\\").euclidish(3,8,1)\` would be the\\n * same as \`sound(\\"bd bd bd\\")\`. \`sound(\\"bd\\").euclidish(3,8,0.5)\` would have a\\n * groove somewhere between.\\n * Inspired by the work of Malcom Braff.\\n * @name euclidish\\n * @synonyms eish\\n * @memberof Pattern\\n * @param {number} pulses the number of onsets\\n * @param {number} steps the number of steps to fill\\n * @param {number} groove exists between the extremes of 0 (straight euclidian) and 1 (straight pulse)\\n * @example\\n * sound(\\"hh\\").euclidish(7,12,sine.slow(8))\\n * .pan(sine.slow(8))\\n */","meta":{"filename":"euclid.mjs","lineno":200,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>A 'euclid' variant with an additional parameter that morphs the resulting\\nrhythm from 0 (no morphing) to 1 (completely 'even'). For example\\n<code>sound(&quot;bd&quot;).euclidish(3,8,0)</code> would be the same as\\n<code>sound(&quot;bd&quot;).euclid(3,8)</code>, and <code>sound(&quot;bd&quot;).euclidish(3,8,1)</code> would be the\\nsame as <code>sound(&quot;bd bd bd&quot;)</code>. <code>sound(&quot;bd&quot;).euclidish(3,8,0.5)</code> would have a\\ngroove somewhere between.\\nInspired by the work of Malcom Braff.</p>","name":"euclidish","synonyms_text":"eish","synonyms":["eish"],"memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>the number of onsets</p>","name":"pulses"},{"type":{"names":["number"]},"description":"<p>the number of steps to fill</p>","name":"steps"},{"type":{"names":["number"]},"description":"<p>exists between the extremes of 0 (straight euclidian) and 1 (straight pulse)</p>","name":"groove"}],"examples":["sound(\\"hh\\").euclidish(7,12,sine.slow(8))\\n.pan(sine.slow(8))"],"scope":"static","longname":"Pattern.euclidish","kind":"member"},{"comment":"/** @class Class representing a pattern. */","meta":{"range":[1701,27939],"filename":"pattern.mjs","lineno":44,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100022983","name":"exports.Pattern","type":"ClassDeclaration"}},"name":"Pattern","longname":"Pattern","kind":"class","classdesc":"<p>Class representing a pattern.</p>","scope":"global","description":"<p>Create a pattern. As an end user, you will most likely not create a Pattern directly.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"memberof":"Pattern","params":[{"type":{"names":["function"]},"description":"<p>The function that maps a <code>State</code> to an array of <code>Hap</code>.</p>","name":"query"}]},{"comment":"/**\\n   * Returns a new pattern, with the function applied to the value of\\n   * each hap. It has the alias \`fmap\`.\\n   * @synonyms fmap\\n   * @param {Function} func to to apply to the value\\n   * @returns Pattern\\n   * @example\\n   * \\"0 1 2\\".withValue(v => v + 10).log()\\n   */","meta":{"range":[3008,3177],"filename":"pattern.mjs","lineno":93,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100023091","name":"Pattern#withValue","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern, with the function applied to the value of\\neach hap. It has the alias <code>fmap</code>.</p>","synonyms_text":"fmap","synonyms":["fmap"],"params":[{"type":{"names":["function"]},"description":"<p>to to apply to the value</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2\\".withValue(v => v + 10).log()"],"name":"withValue","longname":"Pattern#withValue","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * see \`withValue\`\\n   * @noAutocomplete\\n   */","meta":{"range":[3380,3429],"filename":"pattern.mjs","lineno":111,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100023148","name":"Pattern#fmap","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>see <code>withValue</code></p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"fmap","longname":"Pattern#fmap","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Assumes 'this' is a pattern of functions, and given a function to\\n   * resolve wholes, applies a given pattern of values to that\\n   * pattern of functions.\\n   * @param {Function} whole_func\\n   * @param {Function} func\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[3711,4453],"filename":"pattern.mjs","lineno":124,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100023159","name":"Pattern#appWhole","type":"MethodDefinition","paramnames":["whole_func","pat_val"]},"vars":{"":null}},"description":"<p>Assumes 'this' is a pattern of functions, and given a function to\\nresolve wholes, applies a given pattern of values to that\\npattern of functions.</p>","params":[{"type":{"names":["function"]},"name":"whole_func"},{"type":{"names":["function"]},"name":"func"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appWhole","longname":"Pattern#appWhole","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * When this method is called on a pattern of functions, it matches its haps\\n   * with those in the given pattern of values.  A new pattern is returned, with\\n   * each matching value applied to the corresponding function.\\n   *\\n   * In this \`_appBoth\` variant, where timespans of the function and value haps\\n   * are not the same but do intersect, the resulting hap has a timespan of the\\n   * intersection. This applies to both the part and the whole timespan.\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[5004,5428],"filename":"pattern.mjs","lineno":160,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100023266","name":"Pattern#appBoth","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>When this method is called on a pattern of functions, it matches its haps\\nwith those in the given pattern of values.  A new pattern is returned, with\\neach matching value applied to the corresponding function.</p>\\n<p>In this <code>_appBoth</code> variant, where timespans of the function and value haps\\nare not the same but do intersect, the resulting hap has a timespan of the\\nintersection. This applies to both the part and the whole timespan.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appBoth","longname":"Pattern#appBoth","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`appBoth\`, but the \`whole\` timespan is not the intersection,\\n   * but the timespan from the function of patterns that this method is called\\n   * on. In practice, this means that the pattern structure, including onsets,\\n   * are preserved from the pattern of functions (often referred to as the left\\n   * hand or inner pattern).\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[5858,6662],"filename":"pattern.mjs","lineno":187,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100023326","name":"Pattern#appLeft","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>As with <code>appBoth</code>, but the <code>whole</code> timespan is not the intersection,\\nbut the timespan from the function of patterns that this method is called\\non. In practice, this means that the pattern structure, including onsets,\\nare preserved from the pattern of functions (often referred to as the left\\nhand or inner pattern).</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appLeft","longname":"Pattern#appLeft","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`appLeft\`, but \`whole\` timespans are instead taken from the\\n   * pattern of values, i.e. structure is preserved from the right hand/outer\\n   * pattern.\\n   * @param {Pattern} pat_val\\n   * @noAutocomplete\\n   * @returns Pattern\\n   */","meta":{"range":[6916,7724],"filename":"pattern.mjs","lineno":220,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100023448","name":"Pattern#appRight","type":"MethodDefinition","paramnames":["pat_val"]},"vars":{"":null}},"description":"<p>As with <code>appLeft</code>, but <code>whole</code> timespans are instead taken from the\\npattern of values, i.e. structure is preserved from the right hand/outer\\npattern.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat_val"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"returns":[{"description":"<p>Pattern</p>"}],"name":"appRight","longname":"Pattern#appRight","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Query haps inside the given time span.\\n   *\\n   * @param {Fraction | number} begin from time\\n   * @param {Fraction | number} end to time\\n   * @returns Hap[]\\n   * @example\\n   * const pattern = sequence('a', ['b', 'c'])\\n   * const haps = pattern.queryArc(0, 1)\\n   * console.log(haps)\\n   * silence\\n   * @noAutocomplete\\n   */","meta":{"range":[13360,13576],"filename":"pattern.mjs","lineno":416,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024128","name":"Pattern#queryArc","type":"MethodDefinition","paramnames":["begin","end","controls"]},"vars":{"":null}},"description":"<p>Query haps inside the given time span.</p>","params":[{"type":{"names":["Fraction","number"]},"description":"<p>from time</p>","name":"begin"},{"type":{"names":["Fraction","number"]},"description":"<p>to time</p>","name":"end"}],"returns":[{"description":"<p>Hap[]</p>"}],"examples":["const pattern = sequence('a', ['b', 'c'])\\nconst haps = pattern.queryArc(0, 1)\\nconsole.log(haps)\\nsilence"],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"queryArc","longname":"Pattern#queryArc","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern, with queries split at cycle boundaries. This makes\\n   * some calculations easier to express, as all haps are then constrained to\\n   * happen within a cycle.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[13820,14020],"filename":"pattern.mjs","lineno":432,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024164","name":"Pattern#splitQueries","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with queries split at cycle boundaries. This makes\\nsome calculations easier to express, as all haps are then constrained to\\nhappen within a cycle.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"splitQueries","longname":"Pattern#splitQueries","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, where the given function is applied to the query\\n   * timespan before passing it to the original pattern.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[14263,14357],"filename":"pattern.mjs","lineno":447,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024204","name":"Pattern#withQuerySpan","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern, where the given function is applied to the query\\ntimespan before passing it to the original pattern.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withQuerySpan","longname":"Pattern#withQuerySpan","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withQuerySpan\`, but the function is applied to both the\\n   * begin and end time of the query timespan.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[14817,14936],"filename":"pattern.mjs","lineno":469,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024260","name":"Pattern#withQueryTime","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withQuerySpan</code>, but the function is applied to both the\\nbegin and end time of the query timespan.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withQueryTime","longname":"Pattern#withQueryTime","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Similar to \`withQuerySpan\`, but the function is applied to the timespans\\n   * of all haps returned by pattern queries (both \`part\` timespans, and where\\n   * present, \`whole\` timespans).\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15214,15324],"filename":"pattern.mjs","lineno":481,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024285","name":"Pattern#withHapSpan","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Similar to <code>withQuerySpan</code>, but the function is applied to the timespans\\nof all haps returned by pattern queries (both <code>part</code> timespans, and where\\npresent, <code>whole</code> timespans).</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHapSpan","longname":"Pattern#withHapSpan","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withHapSpan\`, but the function is applied to both the\\n   * begin and end time of the hap timespans.\\n   * @param {Function} func the function to apply\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15547,15630],"filename":"pattern.mjs","lineno":492,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024310","name":"Pattern#withHapTime","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withHapSpan</code>, but the function is applied to both the\\nbegin and end time of the hap timespans.</p>","params":[{"type":{"names":["function"]},"description":"<p>the function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHapTime","longname":"Pattern#withHapTime","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the given function applied to the list of haps returned by every query.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[15821,15968],"filename":"pattern.mjs","lineno":502,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024327","name":"Pattern#withHaps","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given function applied to the list of haps returned by every query.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHaps","longname":"Pattern#withHaps","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`withHaps\`, but applies the function to every hap, rather than every list of haps.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16151,16222],"filename":"pattern.mjs","lineno":514,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024357","name":"Pattern#withHap","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>As with <code>withHaps</code>, but applies the function to every hap, rather than every list of haps.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withHap","longname":"Pattern#withHap","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the context field set to every hap set to the given value.\\n   * @param {*} context\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16396,16480],"filename":"pattern.mjs","lineno":524,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024374","name":"Pattern#setContext","type":"MethodDefinition","paramnames":["context"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the context field set to every hap set to the given value.</p>","params":[{"type":{"names":["*"]},"name":"context"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"setContext","longname":"Pattern#setContext","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the given function applied to the context field of every hap.\\n   * @param {Function} func\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[16661,16901],"filename":"pattern.mjs","lineno":534,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024391","name":"Pattern#withContext","type":"MethodDefinition","paramnames":["func"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given function applied to the context field of every hap.</p>","params":[{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withContext","longname":"Pattern#withContext","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern with the context field of every hap set to an empty object.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17047,17121],"filename":"pattern.mjs","lineno":548,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024439","name":"Pattern#stripContext","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern with the context field of every hap set to an empty object.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"stripContext","longname":"Pattern#stripContext","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern with the given location information added to the\\n   * context of every hap.\\n   * @param {Number} start start offset\\n   * @param {Number} end end offset\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17359,17726],"filename":"pattern.mjs","lineno":560,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024455","name":"Pattern#withLoc","type":"MethodDefinition","paramnames":["start","end"]},"vars":{"":null}},"description":"<p>Returns a new pattern with the given location information added to the\\ncontext of every hap.</p>","params":[{"type":{"names":["Number"]},"description":"<p>start offset</p>","name":"start"},{"type":{"names":["Number"]},"description":"<p>end offset</p>","name":"end"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"withLoc","longname":"Pattern#withLoc","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new Pattern, which only returns haps that meet the given test.\\n   * @param {Function} hap_test - a function which returns false for haps to be removed from the pattern\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[17968,18065],"filename":"pattern.mjs","lineno":582,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024519","name":"Pattern#filterHaps","type":"MethodDefinition","paramnames":["hap_test"]},"vars":{"":null}},"description":"<p>Returns a new Pattern, which only returns haps that meet the given test.</p>","params":[{"type":{"names":["function"]},"description":"<p>a function which returns false for haps to be removed from the pattern</p>","name":"hap_test"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"filterHaps","longname":"Pattern#filterHaps","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * As with \`filterHaps\`, but the function is applied to values\\n   * inside haps.\\n   * @param {Function} value_test\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18241,18386],"filename":"pattern.mjs","lineno":593,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024538","name":"Pattern#filterValues","type":"MethodDefinition","paramnames":["value_test"]},"vars":{"":null}},"description":"<p>As with <code>filterHaps</code>, but the function is applied to values\\ninside haps.</p>","params":[{"type":{"names":["function"]},"name":"value_test"}],"returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"filterValues","longname":"Pattern#filterValues","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns a new pattern, with haps containing undefined values removed from\\n   * query results.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18544,18625],"filename":"pattern.mjs","lineno":603,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024569","name":"Pattern#removeUndefineds","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with haps containing undefined values removed from\\nquery results.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"removeUndefineds","longname":"Pattern#removeUndefineds","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, with all haps without onsets filtered out. A hap\\n   * with an onset is one with a \`whole\` timespan that begins at the same time\\n   * as its \`part\` timespan.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[18869,19134],"filename":"pattern.mjs","lineno":614,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024583","name":"Pattern#onsetsOnly","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with all haps without onsets filtered out. A hap\\nwith an onset is one with a <code>whole</code> timespan that begins at the same time\\nas its <code>part</code> timespan.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"onsetsOnly","longname":"Pattern#onsetsOnly","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, with 'continuous' haps (those without 'whole'\\n   * timespans) removed from query results.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[19311,19445],"filename":"pattern.mjs","lineno":627,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024598","name":"Pattern#discreteOnly","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, with 'continuous' haps (those without 'whole'\\ntimespans) removed from query results.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"discreteOnly","longname":"Pattern#discreteOnly","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Combines adjacent haps with the same value and whole.  Only\\n   * intended for use in tests.\\n   * @noAutocomplete\\n   */","meta":{"range":[19579,21024],"filename":"pattern.mjs","lineno":637,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024612","name":"Pattern#defragmentHaps","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Combines adjacent haps with the same value and whole.  Only\\nintended for use in tests.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"defragmentHaps","longname":"Pattern#defragmentHaps","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Queries the pattern for the first cycle, returning Haps. Mainly of use when\\n   * debugging a pattern.\\n   * @param {Boolean} with_context - set to true, otherwise the context field\\n   * will be stripped from the resulting haps.\\n   * @returns [Hap]\\n   * @noAutocomplete\\n   */","meta":{"range":[21313,21511],"filename":"pattern.mjs","lineno":692,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024843","name":"Pattern#firstCycle","type":"MethodDefinition","paramnames":["with_context"]},"vars":{"":null}},"description":"<p>Queries the pattern for the first cycle, returning Haps. Mainly of use when\\ndebugging a pattern.</p>","params":[{"type":{"names":["Boolean"]},"description":"<p>set to true, otherwise the context field\\nwill be stripped from the resulting haps.</p>","name":"with_context","defaultvalue":false}],"returns":[{"description":"<p>[Hap]</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"firstCycle","longname":"Pattern#firstCycle","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Accessor for a list of values returned by querying the first cycle.\\n   * @noAutocomplete\\n   */","meta":{"range":[21621,21703],"filename":"pattern.mjs","lineno":704,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024880","name":"Pattern#firstCycleValues","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Accessor for a list of values returned by querying the first cycle.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"firstCycleValues","longname":"Pattern#firstCycleValues","kind":"member","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * More human-readable version of the \`firstCycleValues\` accessor.\\n   * @noAutocomplete\\n   */","meta":{"range":[21809,21972],"filename":"pattern.mjs","lineno":712,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024897","name":"Pattern#showFirstCycle","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>More human-readable version of the <code>firstCycleValues</code> accessor.</p>","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"showFirstCycle","longname":"Pattern#showFirstCycle","kind":"member","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Returns a new pattern, which returns haps sorted in temporal order. Mainly\\n   * of use when comparing two patterns for equality, in tests.\\n   * @returns Pattern\\n   * @noAutocomplete\\n   */","meta":{"range":[22175,22448],"filename":"pattern.mjs","lineno":724,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100024935","name":"Pattern#sortHapsByPart","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Returns a new pattern, which returns haps sorted in temporal order. Mainly\\nof use when comparing two patterns for equality, in tests.</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"sortHapsByPart","longname":"Pattern#sortHapsByPart","kind":"function","memberof":"Pattern","scope":"instance","params":[]},{"comment":"/**\\n   * Layers the result of the given function(s). Like \`superimpose\`, but without the original pattern:\\n   * @name layer\\n   * @memberof Pattern\\n   * @synonyms apply\\n   * @returns Pattern\\n   * @example\\n   * \\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n   *   .layer(x=>x.add(\\"0,2\\"))\\n   *   .scale('C minor').note()\\n   */","meta":{"filename":"pattern.mjs","lineno":782,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Layers the result of the given function(s). Like <code>superimpose</code>, but without the original pattern:</p>","name":"layer","memberof":"Pattern","synonyms_text":"apply","synonyms":["apply"],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n  .layer(x=>x.add(\\"0,2\\"))\\n  .scale('C minor').note()"],"scope":"static","longname":"Pattern.layer","kind":"member"},{"comment":"/**\\n   * Superimposes the result of the given function(s) on top of the original pattern:\\n   * @name superimpose\\n   * @memberof Pattern\\n   * @returns Pattern\\n   * @example\\n   * \\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n   *   .superimpose(x=>x.add(2))\\n   *   .scale('C minor').note()\\n   */","meta":{"filename":"pattern.mjs","lineno":797,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Superimposes the result of the given function(s) on top of the original pattern:</p>","name":"superimpose","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 2 4 6 ~ 4 ~ 2 0!3 ~!5>*8\\"\\n  .superimpose(x=>x.add(2))\\n  .scale('C minor').note()"],"scope":"static","longname":"Pattern.superimpose","kind":"member"},{"comment":"/**\\n   * Writes the content of the current event to the console (visible in the side menu).\\n   * @name log\\n   * @memberof Pattern\\n   * @example\\n   * s(\\"bd sd\\").log()\\n   */","meta":{"filename":"pattern.mjs","lineno":857,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Writes the content of the current event to the console (visible in the side menu).</p>","name":"log","memberof":"Pattern","examples":["s(\\"bd sd\\").log()"],"scope":"static","longname":"Pattern.log","kind":"member"},{"comment":"/**\\n   * A simplified version of \`log\` which writes all \\"values\\" (various configurable parameters)\\n   * within the event to the console (visible in the side menu).\\n   * @name logValues\\n   * @memberof Pattern\\n   * @example\\n   * s(\\"bd sd\\").gain(\\"0.25 0.5 1\\").n(\\"2 1 0\\").logValues()\\n   */","meta":{"filename":"pattern.mjs","lineno":870,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>A simplified version of <code>log</code> which writes all &quot;values&quot; (various configurable parameters)\\nwithin the event to the console (visible in the side menu).</p>","name":"logValues","memberof":"Pattern","examples":["s(\\"bd sd\\").gain(\\"0.25 0.5 1\\").n(\\"2 1 0\\").logValues()"],"scope":"static","longname":"Pattern.logValues","kind":"member"},{"comment":"/**\\n   * Breaks a pattern into pieces according to the structure of a given pattern.\\n   * True values in the given pattern cause the corresponding subcycle of the\\n   * source pattern to be looped, and for an (optional) given function to be\\n   * applied. False values result in the corresponding part of the source pattern\\n   * to be played unchanged.\\n   * @name into\\n   * @memberof Pattern\\n   * @example\\n   * sound(\\"bd sd ht lt\\").into(\\"1 0\\", hurry(2))\\n   */","meta":{"filename":"pattern.mjs","lineno":900,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Breaks a pattern into pieces according to the structure of a given pattern.\\nTrue values in the given pattern cause the corresponding subcycle of the\\nsource pattern to be looped, and for an (optional) given function to be\\napplied. False values result in the corresponding part of the source pattern\\nto be played unchanged.</p>","name":"into","memberof":"Pattern","examples":["sound(\\"bd sd ht lt\\").into(\\"1 0\\", hurry(2))"],"scope":"static","longname":"Pattern.into","kind":"member"},{"comment":"/**\\n * Selects indices in in stacked notes.\\n * @example\\n * note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n * .arpWith(haps => haps[2])\\n * */","meta":{"range":[28909,29139],"filename":"pattern.mjs","lineno":949,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100025649","name":"exports.arpWith","type":"VariableDeclaration"}},"description":"<p>Selects indices in in stacked notes.</p>","examples":["note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n.arpWith(haps => haps[2])"],"name":"arpWith","longname":"arpWith","kind":"constant","scope":"global"},{"comment":"/**\\n * Selects indices in in stacked notes.\\n * @example\\n * note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n * .arp(\\"0 [0,2] 1 [0,2]\\")\\n * */","meta":{"range":[29272,29415],"filename":"pattern.mjs","lineno":963,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100025703","name":"exports.arp","type":"VariableDeclaration"}},"description":"<p>Selects indices in in stacked notes.</p>","examples":["note(\\"<[c,eb,g]!2 [c,f,ab] [d,f,ab]>\\")\\n.arp(\\"0 [0,2] 1 [0,2]\\")"],"name":"arp","longname":"arp","kind":"constant","scope":"global"},{"comment":"/**\\n     *\\n     * Assumes a pattern of numbers. Adds the given number to each item in the pattern.\\n     * @name add\\n     * @memberof Pattern\\n     * @example\\n     * // Here, the triad 0, 2, 4 is shifted by different amounts\\n     * n(\\"0 2 4\\".add(\\"<0 3 4 0>\\")).scale(\\"C:major\\")\\n     * // Without add, the equivalent would be:\\n     * // n(\\"<[0 2 4] [3 5 7] [4 6 8] [0 2 4]>\\").scale(\\"C:major\\")\\n     * @example\\n     * // You can also use add with notes:\\n     * note(\\"c3 e3 g3\\".add(\\"<0 5 7 0>\\"))\\n     * // Behind the scenes, the notes are converted to midi numbers:\\n     * // note(\\"48 52 55\\".add(\\"<0 5 7 0>\\"))\\n     */","meta":{"filename":"pattern.mjs","lineno":1026,"columnno":4,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Assumes a pattern of numbers. Adds the given number to each item in the pattern.</p>","name":"add","memberof":"Pattern","examples":["// Here, the triad 0, 2, 4 is shifted by different amounts\\nn(\\"0 2 4\\".add(\\"<0 3 4 0>\\")).scale(\\"C:major\\")\\n// Without add, the equivalent would be:\\n// n(\\"<[0 2 4] [3 5 7] [4 6 8] [0 2 4]>\\").scale(\\"C:major\\")","// You can also use add with notes:\\nnote(\\"c3 e3 g3\\".add(\\"<0 5 7 0>\\"))\\n// Behind the scenes, the notes are converted to midi numbers:\\n// note(\\"48 52 55\\".add(\\"<0 5 7 0>\\"))"],"scope":"static","longname":"Pattern.add","kind":"member"},{"comment":"/**\\n     *\\n     * Like add, but the given numbers are subtracted.\\n     * @name sub\\n     * @memberof Pattern\\n     * @example\\n     * n(\\"0 2 4\\".sub(\\"<0 1 2 3>\\")).scale(\\"C4:minor\\")\\n     * // See add for more information.\\n     */","meta":{"filename":"pattern.mjs","lineno":1043,"columnno":4,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like add, but the given numbers are subtracted.</p>","name":"sub","memberof":"Pattern","examples":["n(\\"0 2 4\\".sub(\\"<0 1 2 3>\\")).scale(\\"C4:minor\\")\\n// See add for more information."],"scope":"static","longname":"Pattern.sub","kind":"member"},{"comment":"/**\\n     *\\n     * Multiplies each number by the given factor.\\n     * @name mul\\n     * @memberof Pattern\\n     * @example\\n     * \\"<1 1.5 [1.66, <2 2.33>]>*4\\".mul(150).freq()\\n     */","meta":{"filename":"pattern.mjs","lineno":1053,"columnno":4,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Multiplies each number by the given factor.</p>","name":"mul","memberof":"Pattern","examples":["\\"<1 1.5 [1.66, <2 2.33>]>*4\\".mul(150).freq()"],"scope":"static","longname":"Pattern.mul","kind":"member"},{"comment":"/**\\n     *\\n     * Divides each number by the given factor.\\n     * @name div\\n     * @memberof Pattern\\n     */","meta":{"filename":"pattern.mjs","lineno":1062,"columnno":4,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Divides each number by the given factor.</p>","name":"div","memberof":"Pattern","scope":"static","longname":"Pattern.div","kind":"member"},{"comment":"/**\\n   * Applies the given structure to the pattern:\\n   *\\n   * @example\\n   * note(\\"c,eb,g\\")\\n   *   .struct(\\"x ~ x ~ ~ x ~ x ~ ~ ~ x ~ x ~ ~\\")\\n   *   .slow(2)\\n   */","meta":{"range":[35283,35371],"filename":"pattern.mjs","lineno":1158,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100026243","name":"Pattern.prototype.struct","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Applies the given structure to the pattern:</p>","examples":["note(\\"c,eb,g\\")\\n  .struct(\\"x ~ x ~ ~ x ~ x ~ ~ ~ x ~ x ~ ~\\")\\n  .slow(2)"],"name":"struct","longname":"Pattern#struct","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Returns silence when mask is 0 or \\"~\\"\\n   *\\n   * @example\\n   * note(\\"c [eb,g] d [eb,g]\\").mask(\\"<1 [0 1]>\\")\\n   */","meta":{"range":[35591,35676],"filename":"pattern.mjs","lineno":1170,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100026283","name":"Pattern.prototype.mask","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Returns silence when mask is 0 or &quot;~&quot;</p>","examples":["note(\\"c [eb,g] d [eb,g]\\").mask(\\"<1 [0 1]>\\")"],"name":"mask","longname":"Pattern#mask","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Resets the pattern to the start of the cycle for each onset of the reset pattern.\\n   *\\n   * @example\\n   * s(\\"[<bd lt> sd]*2, hh*8\\").reset(\\"<x@3 x(5,8)>\\")\\n   */","meta":{"range":[35941,36030],"filename":"pattern.mjs","lineno":1182,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100026323","name":"Pattern.prototype.reset","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Resets the pattern to the start of the cycle for each onset of the reset pattern.</p>","examples":["s(\\"[<bd lt> sd]*2, hh*8\\").reset(\\"<x@3 x(5,8)>\\")"],"name":"reset","longname":"Pattern#reset","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n   * Restarts the pattern for each onset of the restart pattern.\\n   * While reset will only reset the current cycle, restart will start from cycle 0.\\n   *\\n   * @example\\n   * s(\\"[<bd lt> sd]*2, hh*8\\").restart(\\"<x@3 x(5,8)>\\")\\n   */","meta":{"range":[36364,36457],"filename":"pattern.mjs","lineno":1195,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100026363","name":"Pattern.prototype.restart","type":"FunctionExpression","paramnames":["args"]}},"description":"<p>Restarts the pattern for each onset of the restart pattern.\\nWhile reset will only reset the current cycle, restart will start from cycle 0.</p>","examples":["s(\\"[<bd lt> sd]*2, hh*8\\").restart(\\"<x@3 x(5,8)>\\")"],"name":"restart","longname":"Pattern#restart","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Does absolutely nothing, but with a given metrical 'steps'\\n * @name gap\\n * @param  {number} steps\\n * @example\\n * gap(3) // \\"~@3\\"\\n */","meta":{"filename":"pattern.mjs","lineno":1229,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Does absolutely nothing, but with a given metrical 'steps'</p>","name":"gap","params":[{"type":{"names":["number"]},"name":"steps"}],"examples":["gap(3) // \\"~@3\\""],"longname":"gap","kind":"member","scope":"global"},{"comment":"/**\\n * Does absolutely nothing..\\n * @name silence\\n * @example\\n * silence // \\"~\\"\\n */","meta":{"filename":"pattern.mjs","lineno":1238,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Does absolutely nothing..</p>","name":"silence","examples":["silence // \\"~\\""],"longname":"silence","kind":"member","scope":"global"},{"comment":"/** A discrete value that repeats once per cycle.\\n *\\n * @returns {Pattern}\\n * @example\\n * pure('e4') // \\"e4\\"\\n * @noAutocomplete\\n */","meta":{"range":[37705,37962],"filename":"pattern.mjs","lineno":1256,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100026442","name":"exports.pure","type":"FunctionDeclaration","paramnames":["value"]}},"description":"<p>A discrete value that repeats once per cycle.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["pure('e4') // \\"e4\\""],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"pure","longname":"pure","kind":"function","scope":"global"},{"comment":"/** Takes a list of patterns, and returns a pattern of lists.\\n */","meta":{"range":[38967,39147],"filename":"pattern.mjs","lineno":1294,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100026532","name":"exports.sequenceP","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Takes a list of patterns, and returns a pattern of lists.</p>","name":"sequenceP","longname":"sequenceP","kind":"function","scope":"global"},{"comment":"/** The given items are played at the same time at the same length.\\n *\\n * @return {Pattern}\\n * @synonyms polyrhythm, pr\\n * @example\\n * stack(\\"g3\\", \\"b3\\", [\\"e4\\", \\"d4\\"]).note()\\n * // \\"g3,b3,[e4 d4]\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").stack(\\n *   note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[39446,39824],"filename":"pattern.mjs","lineno":1316,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100026572","name":"exports.stack","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>The given items are played at the same time at the same length.</p>","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"polyrhythm, pr","synonyms":["polyrhythm","pr"],"examples":["stack(\\"g3\\", \\"b3\\", [\\"e4\\", \\"d4\\"]).note()\\n// \\"g3,b3,[e4 d4]\\".note()","// As a chained function:\\ns(\\"hh*4\\").stack(\\n  note(\\"c4(5,8)\\")\\n)"],"name":"stack","longname":"stack","kind":"function","scope":"global"},{"comment":"/** Concatenation: combines a list of patterns, switching between them successively, one per cycle:\\n *\\n * synonyms: \`cat\`\\n *\\n * @return {Pattern}\\n * @example\\n * slowcat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"])\\n *\\n */","meta":{"range":[41494,42544],"filename":"pattern.mjs","lineno":1394,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100026936","name":"exports.slowcat","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Concatenation: combines a list of patterns, switching between them successively, one per cycle:</p>\\n<p>synonyms: <code>cat</code></p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["slowcat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"])"],"name":"slowcat","longname":"slowcat","kind":"function","scope":"global"},{"comment":"/** Concatenation: combines a list of patterns, switching between them successively, one per cycle. Unlike slowcat, this version will skip cycles.\\n * @param {...any} items - The items to concatenate\\n * @return {Pattern}\\n */","meta":{"range":[42770,43143],"filename":"pattern.mjs","lineno":1424,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100027096","name":"exports.slowcatPrime","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Concatenation: combines a list of patterns, switching between them successively, one per cycle. Unlike slowcat, this version will skip cycles.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>The items to concatenate</p>","name":"items"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"slowcatPrime","longname":"slowcatPrime","kind":"function","scope":"global"},{"comment":"/** The given items are con**cat**enated, where each one takes one cycle.\\n *\\n * @param {...any} items - The items to concatenate\\n * @synonyms slowcat\\n * @return {Pattern}\\n * @example\\n * cat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n * // \\"<e5 b4 [d5 c5]>\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").cat(\\n *    note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[43492,43551],"filename":"pattern.mjs","lineno":1449,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100027149","name":"exports.cat","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>The given items are con<strong>cat</strong>enated, where each one takes one cycle.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>The items to concatenate</p>","name":"items"}],"synonyms_text":"slowcat","synonyms":["slowcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["cat(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n// \\"<e5 b4 [d5 c5]>\\".note()","// As a chained function:\\ns(\\"hh*4\\").cat(\\n   note(\\"c4(5,8)\\")\\n)"],"name":"cat","longname":"cat","kind":"function","scope":"global"},{"comment":"/**\\n * Allows to arrange multiple patterns together over multiple cycles.\\n * Takes a variable number of arrays with two elements specifying the number of cycles and the pattern to use.\\n *\\n * @return {Pattern}\\n * @example\\n * arrange(\\n *   [4, \\"<c a f e>(3,8)\\"],\\n *   [2, \\"<g a>(5,8)\\"]\\n * ).note()\\n */","meta":{"range":[43853,44087],"filename":"pattern.mjs","lineno":1464,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100027160","name":"exports.arrange","type":"FunctionDeclaration","paramnames":["sections"]}},"description":"<p>Allows to arrange multiple patterns together over multiple cycles.\\nTakes a variable number of arrays with two elements specifying the number of cycles and the pattern to use.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["arrange(\\n  [4, \\"<c a f e>(3,8)\\"],\\n  [2, \\"<g a>(5,8)\\"]\\n).note()"],"name":"arrange","longname":"arrange","kind":"function","scope":"global"},{"comment":"/**\\n * Similarly to \`arrange\`, allows you to arrange multiple patterns together over multiple cycles.\\n * Unlike \`arrange\`, you specify a start and stop time for each pattern rather than duration, which\\n * means that patterns can overlap.\\n * @return {Pattern}\\n * @example\\nseqPLoop([0, 2, \\"bd(3,8)\\"],\\n         [1, 3, \\"cp(3,8)\\"]\\n        )\\n  .sound()\\n */","meta":{"range":[44440,44864],"filename":"pattern.mjs","lineno":1481,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100027205","name":"exports.seqPLoop","type":"FunctionDeclaration","paramnames":["parts"]}},"description":"<p>Similarly to <code>arrange</code>, allows you to arrange multiple patterns together over multiple cycles.\\nUnlike <code>arrange</code>, you specify a start and stop time for each pattern rather than duration, which\\nmeans that patterns can overlap.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["seqPLoop([0, 2, \\"bd(3,8)\\"],\\n         [1, 3, \\"cp(3,8)\\"]\\n        )\\n  .sound()"],"name":"seqPLoop","longname":"seqPLoop","kind":"function","scope":"global"},{"comment":"/** See \`fastcat\` */","meta":{"range":[45167,45231],"filename":"pattern.mjs","lineno":1513,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100027348","name":"exports.sequence","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>See <code>fastcat</code></p>","name":"sequence","longname":"sequence","kind":"function","scope":"global"},{"comment":"/** Like **cat**, but the items are crammed into one cycle.\\n * @synonyms sequence, fastcat\\n * @example\\n * seq(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n * // \\"e5 b4 [d5 c5]\\".note()\\n *\\n * @example\\n * // As a chained function:\\n * s(\\"hh*4\\").seq(\\n *   note(\\"c4(5,8)\\")\\n * )\\n */","meta":{"range":[45498,45557],"filename":"pattern.mjs","lineno":1530,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100027359","name":"exports.seq","type":"FunctionDeclaration","paramnames":["pats"]}},"description":"<p>Like <strong>cat</strong>, but the items are crammed into one cycle.</p>","synonyms_text":"sequence, fastcat","synonyms":["sequence","fastcat"],"examples":["seq(\\"e5\\", \\"b4\\", [\\"d5\\", \\"c5\\"]).note()\\n// \\"e5 b4 [d5 c5]\\".note()","// As a chained function:\\ns(\\"hh*4\\").seq(\\n  note(\\"c4(5,8)\\")\\n)"],"name":"seq","longname":"seq","kind":"function","scope":"global"},{"comment":"/**\\n * Registers a new pattern method. The method is added to the Pattern class + the standalone function is returned from register.\\n *\\n * @param {string | string[]} name name of the function, or an array of names to be used as synonyms\\n * @param {function} func function with 1 or more params, where last is the current pattern\\n * @noAutocomplete\\n *\\n */","meta":{"range":[48187,50863],"filename":"pattern.mjs","lineno":1594,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100027991","name":"exports.register","type":"FunctionDeclaration","paramnames":["name","func","patternify","preserveSteps","join"]}},"description":"<p>Registers a new pattern method. The method is added to the Pattern class + the standalone function is returned from register.</p>","params":[{"type":{"names":["string","Array.<string>"]},"description":"<p>name of the function, or an array of names to be used as synonyms</p>","name":"name"},{"type":{"names":["function"]},"description":"<p>function with 1 or more params, where last is the current pattern</p>","name":"func"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"register","longname":"register","kind":"function","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values rounded\\n * to the nearest integer.\\n * @name round\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * n(\\"0.5 1.5 2.5\\".round()).scale(\\"C:major\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1687,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values rounded\\nto the nearest integer.</p>","name":"round","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0.5 1.5 2.5\\".round()).scale(\\"C:major\\")"],"scope":"static","longname":"Pattern.round","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values set to\\n * their mathematical floor. E.g. \`3.7\` replaced with to \`3\`, and \`-4.2\`\\n * replaced with \`-5\`.\\n * @name floor\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"42 42.1 42.5 43\\".floor())\\n */","meta":{"filename":"pattern.mjs","lineno":1700,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values set to\\ntheir mathematical floor. E.g. <code>3.7</code> replaced with to <code>3</code>, and <code>-4.2</code>\\nreplaced with <code>-5</code>.</p>","name":"floor","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"42 42.1 42.5 43\\".floor())"],"scope":"static","longname":"Pattern.floor","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern. Returns a new pattern with all values set to\\n * their mathematical ceiling. E.g. \`3.2\` replaced with \`4\`, and \`-4.2\`\\n * replaced with \`-4\`.\\n * @name ceil\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"42 42.1 42.5 43\\".ceil())\\n */","meta":{"filename":"pattern.mjs","lineno":1714,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern. Returns a new pattern with all values set to\\ntheir mathematical ceiling. E.g. <code>3.2</code> replaced with <code>4</code>, and <code>-4.2</code>\\nreplaced with <code>-4</code>.</p>","name":"ceil","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"42 42.1 42.5 43\\".ceil())"],"scope":"static","longname":"Pattern.ceil","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 ..\\n * 1. Returns a new pattern with values scaled to the bipolar range -1 .. 1\\n * @returns Pattern\\n * @noAutocomplete\\n */","meta":{"range":[52508,52612],"filename":"pattern.mjs","lineno":1733,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100028507","name":"exports.toBipolar","type":"VariableDeclaration"}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 ..</p>\\n<ol>\\n<li>Returns a new pattern with values scaled to the bipolar range -1 .. 1</li>\\n</ol>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"toBipolar","longname":"toBipolar","kind":"constant","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\n * Returns a new pattern with values scaled to the unipolar range 0 .. 1\\n * @returns Pattern\\n * @noAutocomplete\\n */","meta":{"range":[52813,52923],"filename":"pattern.mjs","lineno":1743,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100028529","name":"exports.fromBipolar","type":"VariableDeclaration"}},"description":"<p>Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\nReturns a new pattern with values scaled to the unipolar range 0 .. 1</p>","returns":[{"description":"<p>Pattern</p>"}],"tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"fromBipolar","longname":"fromBipolar","kind":"constant","scope":"global"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 .. 1.\\n * Returns a new pattern with values scaled to the given min/max range.\\n * Most useful in combination with continuous patterns.\\n * @name range\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine.range(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1747,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 .. 1.\\nReturns a new pattern with values scaled to the given min/max range.\\nMost useful in combination with continuous patterns.</p>","name":"range","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine.range(500,4000))"],"scope":"static","longname":"Pattern.range","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing unipolar values in the range 0 .. 1\\n * Returns a new pattern with values scaled to the given min/max range,\\n * following an exponential curve.\\n * @name rangex\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine.rangex(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1762,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing unipolar values in the range 0 .. 1\\nReturns a new pattern with values scaled to the given min/max range,\\nfollowing an exponential curve.</p>","name":"rangex","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine.rangex(500,4000))"],"scope":"static","longname":"Pattern.rangex","kind":"member"},{"comment":"/**\\n * Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\n * Returns a new pattern with values scaled to the given min/max range.\\n * @name range2\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"[bd sd]*2,hh*8\\")\\n * .cutoff(sine2.range2(500,4000))\\n */","meta":{"filename":"pattern.mjs","lineno":1777,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Assumes a numerical pattern, containing bipolar values in the range -1 .. 1\\nReturns a new pattern with values scaled to the given min/max range.</p>","name":"range2","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"[bd sd]*2,hh*8\\")\\n.cutoff(sine2.range2(500,4000))"],"scope":"static","longname":"Pattern.range2","kind":"member"},{"comment":"/**\\n * Allows dividing numbers via list notation using \\":\\".\\n * Returns a new pattern with just numbers.\\n * @name ratio\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * ratio(\\"1, 5:4, 3:2\\").mul(110)\\n * .freq().s(\\"piano\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1791,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Allows dividing numbers via list notation using &quot;:&quot;.\\nReturns a new pattern with just numbers.</p>","name":"ratio","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["ratio(\\"1, 5:4, 3:2\\").mul(110)\\n.freq().s(\\"piano\\")"],"scope":"static","longname":"Pattern.ratio","kind":"member"},{"comment":"/** Compress each cycle into the given timespan, leaving a gap\\n * @example\\n * cat(\\n *   s(\\"bd sd\\").compress(.25,.75),\\n *   s(\\"~ bd sd ~\\")\\n * )\\n */","meta":{"range":[54916,55169],"filename":"pattern.mjs","lineno":1820,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100028674","name":"exports.compress","type":"VariableDeclaration"}},"description":"<p>Compress each cycle into the given timespan, leaving a gap</p>","examples":["cat(\\n  s(\\"bd sd\\").compress(.25,.75),\\n  s(\\"~ bd sd ~\\")\\n)"],"name":"compress","longname":"compress","kind":"constant","scope":"global"},{"comment":"/**\\n * speeds up a pattern like fast, but rather than it playing multiple times as fast would it instead leaves a gap in the remaining space of the cycle. For example, the following will play the sound pattern \\"bd sn\\" only once but compressed into the first half of the cycle, i.e. twice as fast.\\n * @name fastGap\\n * @synonyms fastgap\\n * @example\\n * s(\\"bd sd\\").fastGap(2)\\n */","meta":{"filename":"pattern.mjs","lineno":1833,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>speeds up a pattern like fast, but rather than it playing multiple times as fast would it instead leaves a gap in the remaining space of the cycle. For example, the following will play the sound pattern &quot;bd sn&quot; only once but compressed into the first half of the cycle, i.e. twice as fast.</p>","name":"fastGap","synonyms_text":"fastgap","synonyms":["fastgap"],"examples":["s(\\"bd sd\\").fastGap(2)"],"longname":"fastGap","kind":"member","scope":"global"},{"comment":"/**\\n * Similar to \`compress\`, but doesn't leave gaps, and the 'focus' can be bigger than a cycle\\n * @example\\n * s(\\"bd hh sd hh\\").focus(1/4, 3/4)\\n */","meta":{"range":[57060,57250],"filename":"pattern.mjs","lineno":1875,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029016","name":"exports.focus","type":"VariableDeclaration"}},"description":"<p>Similar to <code>compress</code>, but doesn't leave gaps, and the 'focus' can be bigger than a cycle</p>","examples":["s(\\"bd hh sd hh\\").focus(1/4, 3/4)"],"name":"focus","longname":"focus","kind":"constant","scope":"global"},{"comment":"/** The ply function repeats each event the given number of times.\\n * @example\\n * s(\\"bd ~ sd cp\\").ply(\\"<1 2 3>\\")\\n */","meta":{"range":[57517,57748],"filename":"pattern.mjs","lineno":1892,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029095","name":"exports.ply","type":"VariableDeclaration"}},"description":"<p>The ply function repeats each event the given number of times.</p>","examples":["s(\\"bd ~ sd cp\\").ply(\\"<1 2 3>\\")"],"name":"ply","longname":"ply","kind":"constant","scope":"global"},{"comment":"/**\\n * Speed up a pattern by the given factor. Used by \\"*\\" in mini notation.\\n *\\n * @name fast\\n * @synonyms density\\n * @memberof Pattern\\n * @param {number | Pattern} factor speed up factor\\n * @returns Pattern\\n * @example\\n * s(\\"bd hh sd hh\\").fast(2) // s(\\"[bd hh sd hh]*2\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1900,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Speed up a pattern by the given factor. Used by &quot;*&quot; in mini notation.</p>","name":"fast","synonyms_text":"density","synonyms":["density"],"memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>speed up factor</p>","name":"factor"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd hh sd hh\\").fast(2) // s(\\"[bd hh sd hh]*2\\")"],"scope":"static","longname":"Pattern.fast","kind":"member"},{"comment":"/**\\n * Both speeds up the pattern (like 'fast') and the sample playback (like 'speed').\\n * @example\\n * s(\\"bd sd:2\\").hurry(\\"<1 2 4 3>\\").slow(1.5)\\n */","meta":{"range":[58516,58625],"filename":"pattern.mjs","lineno":1930,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029208","name":"exports.hurry","type":"VariableDeclaration"}},"description":"<p>Both speeds up the pattern (like 'fast') and the sample playback (like 'speed').</p>","examples":["s(\\"bd sd:2\\").hurry(\\"<1 2 4 3>\\").slow(1.5)"],"name":"hurry","longname":"hurry","kind":"constant","scope":"global"},{"comment":"/**\\n * Slow down a pattern over the given number of cycles. Like the \\"/\\" operator in mini notation.\\n *\\n * @name slow\\n * @synonyms sparsity\\n * @memberof Pattern\\n * @param {number | Pattern} factor slow down factor\\n * @returns Pattern\\n * @example\\n * s(\\"bd hh sd hh\\").slow(2) // s(\\"[bd hh sd hh]/2\\")\\n */","meta":{"filename":"pattern.mjs","lineno":1934,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Slow down a pattern over the given number of cycles. Like the &quot;/&quot; operator in mini notation.</p>","name":"slow","synonyms_text":"sparsity","synonyms":["sparsity"],"memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>slow down factor</p>","name":"factor"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd hh sd hh\\").slow(2) // s(\\"[bd hh sd hh]/2\\")"],"scope":"static","longname":"Pattern.slow","kind":"member"},{"comment":"/**\\n * Carries out an operation 'inside' a cycle.\\n * @example\\n * \\"0 1 2 3 4 3 2 1\\".inside(4, rev).scale('C major').note()\\n * // \\"0 1 2 3 4 3 2 1\\".slow(4).rev().fast(4).scale('C major').note()\\n */","meta":{"range":[59310,59427],"filename":"pattern.mjs","lineno":1958,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029269","name":"exports.inside","type":"VariableDeclaration"}},"description":"<p>Carries out an operation 'inside' a cycle.</p>","examples":["\\"0 1 2 3 4 3 2 1\\".inside(4, rev).scale('C major').note()\\n// \\"0 1 2 3 4 3 2 1\\".slow(4).rev().fast(4).scale('C major').note()"],"name":"inside","longname":"inside","kind":"constant","scope":"global"},{"comment":"/**\\n * Carries out an operation 'outside' a cycle.\\n * @example\\n * \\"<[0 1] 2 [3 4] 5>\\".outside(4, rev).scale('C major').note()\\n * // \\"<[0 1] 2 [3 4] 5>\\".fast(4).rev().slow(4).scale('C major').note()\\n */","meta":{"range":[59631,59750],"filename":"pattern.mjs","lineno":1968,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029293","name":"exports.outside","type":"VariableDeclaration"}},"description":"<p>Carries out an operation 'outside' a cycle.</p>","examples":["\\"<[0 1] 2 [3 4] 5>\\".outside(4, rev).scale('C major').note()\\n// \\"<[0 1] 2 [3 4] 5>\\".fast(4).rev().slow(4).scale('C major').note()"],"name":"outside","longname":"outside","kind":"constant","scope":"global"},{"comment":"/**\\n * Applies the given function every n cycles, starting from the last cycle.\\n * @name lastOf\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").lastOf(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1972,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Applies the given function every n cycles, starting from the last cycle.</p>","name":"lastOf","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").lastOf(4, x=>x.rev())"],"scope":"static","longname":"Pattern.lastOf","kind":"member"},{"comment":"/**\\n * Applies the given function every n cycles, starting from the first cycle.\\n * @name firstOf\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").firstOf(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1988,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Applies the given function every n cycles, starting from the first cycle.</p>","name":"firstOf","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").firstOf(4, x=>x.rev())"],"scope":"static","longname":"Pattern.firstOf","kind":"member"},{"comment":"/**\\n * An alias for \`firstOf\`\\n * @name every\\n * @memberof Pattern\\n * @param {number} n how many cycles\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * note(\\"c3 d3 e3 g3\\").every(4, x=>x.rev())\\n */","meta":{"filename":"pattern.mjs","lineno":1999,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>An alias for <code>firstOf</code></p>","name":"every","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>how many cycles</p>","name":"n"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c3 d3 e3 g3\\").every(4, x=>x.rev())"],"scope":"static","longname":"Pattern.every","kind":"member"},{"comment":"/**\\n * Like layer, but with a single function:\\n * @name apply\\n * @memberof Pattern\\n * @example\\n * \\"<c3 eb3 g3>\\".scale('C minor').apply(scaleTranspose(\\"0,2,4\\")).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2015,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like layer, but with a single function:</p>","name":"apply","memberof":"Pattern","examples":["\\"<c3 eb3 g3>\\".scale('C minor').apply(scaleTranspose(\\"0,2,4\\")).note()"],"scope":"static","longname":"Pattern.apply","kind":"member"},{"comment":"/**\\n * Plays the pattern at the given cycles per minute.\\n * @deprecated\\n * @example\\n * s(\\"<bd sd>,hh*2\\").cpm(90) // = 90 bpm\\n */","meta":{"range":[61394,61488],"filename":"pattern.mjs","lineno":2034,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029412","name":"exports.cpm","type":"VariableDeclaration"}},"description":"<p>Plays the pattern at the given cycles per minute.</p>","deprecated":true,"examples":["s(\\"<bd sd>,hh*2\\").cpm(90) // = 90 bpm"],"name":"cpm","longname":"cpm","kind":"constant","scope":"global"},{"comment":"/**\\n * Nudge a pattern to start earlier in time. Equivalent of Tidal's <~ operator\\n *\\n * @name early\\n * @memberof Pattern\\n * @param {number | Pattern} cycles number of cycles to nudge left\\n * @returns Pattern\\n * @example\\n * \\"bd ~\\".stack(\\"hh ~\\".early(.1)).s()\\n */","meta":{"filename":"pattern.mjs","lineno":2038,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Nudge a pattern to start earlier in time. Equivalent of Tidal's &lt;~ operator</p>","name":"early","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>number of cycles to nudge left</p>","name":"cycles"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"bd ~\\".stack(\\"hh ~\\".early(.1)).s()"],"scope":"static","longname":"Pattern.early","kind":"member"},{"comment":"/**\\n * Nudge a pattern to start later in time. Equivalent of Tidal's ~> operator\\n *\\n * @name late\\n * @memberof Pattern\\n * @param {number | Pattern} cycles number of cycles to nudge right\\n * @returns Pattern\\n * @example\\n * \\"bd ~\\".stack(\\"hh ~\\".late(.1)).s()\\n */","meta":{"filename":"pattern.mjs","lineno":2058,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Nudge a pattern to start later in time. Equivalent of Tidal's ~&gt; operator</p>","name":"late","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>number of cycles to nudge right</p>","name":"cycles"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"bd ~\\".stack(\\"hh ~\\".late(.1)).s()"],"scope":"static","longname":"Pattern.late","kind":"member"},{"comment":"/**\\n * Plays a portion of a pattern, specified by the beginning and end of a time span. The new resulting pattern is played over the time period of the original pattern:\\n *\\n * @example\\n * s(\\"bd*2 hh*3 [sd bd]*2 perc\\").zoom(0.25, 0.75)\\n * // s(\\"hh*3 [sd bd]*2\\") // equivalent\\n */","meta":{"range":[62674,63093],"filename":"pattern.mjs","lineno":2085,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029505","name":"exports.zoom","type":"VariableDeclaration"}},"description":"<p>Plays a portion of a pattern, specified by the beginning and end of a time span. The new resulting pattern is played over the time period of the original pattern:</p>","examples":["s(\\"bd*2 hh*3 [sd bd]*2 perc\\").zoom(0.25, 0.75)\\n// s(\\"hh*3 [sd bd]*2\\") // equivalent"],"name":"zoom","longname":"zoom","kind":"constant","scope":"global"},{"comment":"/**\\n * Splits a pattern into the given number of slices, and plays them according to a pattern of slice numbers.\\n * Similar to \`slice\`, but slices up patterns rather than sound samples.\\n * @param {number} number of slices\\n * @param {number} slices to play\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale('c:mixolydian'))\\n *.bite(4, \\"3 2 1 0\\")\\n * @example\\n * sound(\\"bd - bd bd*2, - sd:6 - sd:5 sd:1 - [- sd:2] -, hh [- cp:7]\\")\\n  .bank(\\"RolandTR909\\").speed(1.2)\\n  .bite(4, \\"0 0 [1 2] <3 2> 0 0 [2 1] 3\\")\\n */","meta":{"range":[63726,64024],"filename":"pattern.mjs","lineno":2117,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029630","name":"exports.bite","type":"VariableDeclaration"}},"description":"<p>Splits a pattern into the given number of slices, and plays them according to a pattern of slice numbers.\\nSimilar to <code>slice</code>, but slices up patterns rather than sound samples.</p>","params":[{"type":{"names":["number"]},"description":"<p>of slices</p>","name":"number"},{"type":{"names":["number"]},"description":"<p>to play</p>","name":"slices"}],"examples":["note(\\"0 1 2 3 4 5 6 7\\".scale('c:mixolydian'))\\n.bite(4, \\"3 2 1 0\\")","sound(\\"bd - bd bd*2, - sd:6 - sd:5 sd:1 - [- sd:2] -, hh [- cp:7]\\")\\n  .bank(\\"RolandTR909\\").speed(1.2)\\n  .bite(4, \\"0 0 [1 2] <3 2> 0 0 [2 1] 3\\")"],"name":"bite","longname":"bite","kind":"constant","scope":"global"},{"comment":"/**\\n * Selects the given fraction of the pattern and repeats that part to fill the remainder of the cycle.\\n * @param {number} fraction fraction to select\\n * @example\\n * s(\\"lt ht mt cp, [hh oh]*2\\").linger(\\"<1 .5 .25 .125>\\")\\n */","meta":{"range":[64253,64495],"filename":"pattern.mjs","lineno":2138,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029695","name":"exports.linger","type":"VariableDeclaration"}},"description":"<p>Selects the given fraction of the pattern and repeats that part to fill the remainder of the cycle.</p>","params":[{"type":{"names":["number"]},"description":"<p>fraction to select</p>","name":"fraction"}],"examples":["s(\\"lt ht mt cp, [hh oh]*2\\").linger(\\"<1 .5 .25 .125>\\")"],"name":"linger","longname":"linger","kind":"constant","scope":"global"},{"comment":"/**\\n * Samples the pattern at a rate of n events per cycle. Useful for turning a continuous pattern into a discrete one.\\n * @name segment\\n * @synonyms seg\\n * @param {number} segments number of segments per cycle\\n * @example\\n * note(saw.range(40,52).segment(24))\\n */","meta":{"filename":"pattern.mjs","lineno":2152,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Samples the pattern at a rate of n events per cycle. Useful for turning a continuous pattern into a discrete one.</p>","name":"segment","synonyms_text":"seg","synonyms":["seg"],"params":[{"type":{"names":["number"]},"description":"<p>number of segments per cycle</p>","name":"segments"}],"examples":["note(saw.range(40,52).segment(24))"],"longname":"segment","kind":"member","scope":"global"},{"comment":"/**\\n * The function \`swingBy x n\` breaks each cycle into \`n\` slices, and then delays events in the second half of each slice by the amount \`x\`, which is relative to the size of the (half) slice. So if \`x\` is 0 it does nothing, \`0.5\` delays for half the note duration, and 1 will wrap around to doing nothing again. The end result is a shuffle or swing-like rhythm\\n * @param {number} subdivision\\n * @param {number} offset\\n * @example\\n * s(\\"hh*8\\").swingBy(1/3, 4)\\n */","meta":{"range":[65378,65480],"filename":"pattern.mjs","lineno":2171,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029779","name":"exports.swingBy","type":"VariableDeclaration"}},"description":"<p>The function <code>swingBy x n</code> breaks each cycle into <code>n</code> slices, and then delays events in the second half of each slice by the amount <code>x</code>, which is relative to the size of the (half) slice. So if <code>x</code> is 0 it does nothing, <code>0.5</code> delays for half the note duration, and 1 will wrap around to doing nothing again. The end result is a shuffle or swing-like rhythm</p>","params":[{"type":{"names":["number"]},"name":"subdivision"},{"type":{"names":["number"]},"name":"offset"}],"examples":["s(\\"hh*8\\").swingBy(1/3, 4)"],"name":"swingBy","longname":"swingBy","kind":"constant","scope":"global"},{"comment":"/**\\n * Shorthand for swingBy with 1/3:\\n * @param {number} subdivision\\n * @example\\n * s(\\"hh*8\\").swing(4)\\n * // s(\\"hh*8\\").swingBy(1/3, 4)\\n */","meta":{"range":[65622,65696],"filename":"pattern.mjs","lineno":2180,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029803","name":"exports.swing","type":"VariableDeclaration"}},"description":"<p>Shorthand for swingBy with 1/3:</p>","params":[{"type":{"names":["number"]},"name":"subdivision"}],"examples":["s(\\"hh*8\\").swing(4)\\n// s(\\"hh*8\\").swingBy(1/3, 4)"],"name":"swing","longname":"swing","kind":"constant","scope":"global"},{"comment":"/**\\n * Swaps 1s and 0s in a binary pattern.\\n * @name invert\\n * @synonyms inv\\n * @example\\n * s(\\"bd\\").struct(\\"1 0 0 1 0 0 1 0\\".lastOf(4, invert))\\n */","meta":{"filename":"pattern.mjs","lineno":2182,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Swaps 1s and 0s in a binary pattern.</p>","name":"invert","synonyms_text":"inv","synonyms":["inv"],"examples":["s(\\"bd\\").struct(\\"1 0 0 1 0 0 1 0\\".lastOf(4, invert))"],"longname":"invert","kind":"member","scope":"global"},{"comment":"/**\\n * Applies the given function whenever the given pattern is in a true state.\\n * @name when\\n * @memberof Pattern\\n * @param {Pattern} binary_pat\\n * @param {function} func\\n * @returns Pattern\\n * @example\\n * \\"c3 eb3 g3\\".when(\\"<0 1>/2\\", x=>x.sub(\\"5\\")).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2199,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Applies the given function whenever the given pattern is in a true state.</p>","name":"when","memberof":"Pattern","params":[{"type":{"names":["Pattern"]},"name":"binary_pat"},{"type":{"names":["function"]},"name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"c3 eb3 g3\\".when(\\"<0 1>/2\\", x=>x.sub(\\"5\\")).note()"],"scope":"static","longname":"Pattern.when","kind":"member"},{"comment":"/**\\n * Superimposes the function result on top of the original pattern, delayed by the given time.\\n * @name off\\n * @memberof Pattern\\n * @param {Pattern | number} time offset time\\n * @param {function} func function to apply\\n * @returns Pattern\\n * @example\\n * \\"c3 eb3 g3\\".off(1/8, x=>x.add(7)).note()\\n */","meta":{"filename":"pattern.mjs","lineno":2213,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Superimposes the function result on top of the original pattern, delayed by the given time.</p>","name":"off","memberof":"Pattern","params":[{"type":{"names":["Pattern","number"]},"description":"<p>offset time</p>","name":"time"},{"type":{"names":["function"]},"description":"<p>function to apply</p>","name":"func"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"c3 eb3 g3\\".off(1/8, x=>x.add(7)).note()"],"scope":"static","longname":"Pattern.off","kind":"member"},{"comment":"/**\\n * Returns a new pattern where every other cycle is played once, twice as\\n * fast, and offset in time by one quarter of a cycle. Creates a kind of\\n * breakbeat feel.\\n * @returns Pattern\\n */","meta":{"range":[67006,67144],"filename":"pattern.mjs","lineno":2233,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100029890","name":"exports.brak","type":"VariableDeclaration"}},"description":"<p>Returns a new pattern where every other cycle is played once, twice as\\nfast, and offset in time by one quarter of a cycle. Creates a kind of\\nbreakbeat feel.</p>","returns":[{"description":"<p>Pattern</p>"}],"name":"brak","longname":"brak","kind":"constant","scope":"global"},{"comment":"/**\\n * Reverse all haps in a pattern\\n *\\n * @name rev\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"c d e g\\").rev()\\n */","meta":{"filename":"pattern.mjs","lineno":2237,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Reverse all haps in a pattern</p>","name":"rev","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"c d e g\\").rev()"],"scope":"static","longname":"Pattern.rev","kind":"member"},{"comment":"/** Like press, but allows you to specify the amount by which each\\n * event is shifted. pressBy(0.5) is the same as press, while\\n * pressBy(1/3) shifts each event by a third of its timespan.\\n * @example\\n * stack(s(\\"hh*4\\"),\\n *       s(\\"bd mt sd ht\\").pressBy(\\"<0 0.5 0.25>\\")\\n *      ).slow(2)\\n */","meta":{"range":[68352,68482],"filename":"pattern.mjs","lineno":2278,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100030040","name":"exports.pressBy","type":"VariableDeclaration"}},"description":"<p>Like press, but allows you to specify the amount by which each\\nevent is shifted. pressBy(0.5) is the same as press, while\\npressBy(1/3) shifts each event by a third of its timespan.</p>","examples":["stack(s(\\"hh*4\\"),\\n      s(\\"bd mt sd ht\\").pressBy(\\"<0 0.5 0.25>\\")\\n     ).slow(2)"],"name":"pressBy","longname":"pressBy","kind":"constant","scope":"global"},{"comment":"/**\\n * Syncopates a rhythm, by shifting each event halfway into its timespan.\\n * @example\\n * stack(s(\\"hh*4\\"),\\n *       s(\\"bd mt sd ht\\").every(4, press)\\n *      ).slow(2)\\n */","meta":{"range":[68658,68745],"filename":"pattern.mjs","lineno":2289,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100030069","name":"exports.press","type":"VariableDeclaration"}},"description":"<p>Syncopates a rhythm, by shifting each event halfway into its timespan.</p>","examples":["stack(s(\\"hh*4\\"),\\n      s(\\"bd mt sd ht\\").every(4, press)\\n     ).slow(2)"],"name":"press","longname":"press","kind":"constant","scope":"global"},{"comment":"/**\\n * Silences a pattern.\\n * @example\\n * stack(\\n *   s(\\"bd\\").hush(),\\n *   s(\\"hh*3\\")\\n * )\\n */","meta":{"range":[68841,68899],"filename":"pattern.mjs","lineno":2301,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100030086","name":"Pattern.prototype.hush","type":"FunctionExpression","paramnames":[]}},"description":"<p>Silences a pattern.</p>","examples":["stack(\\n  s(\\"bd\\").hush(),\\n  s(\\"hh*3\\")\\n)"],"name":"hush","longname":"Pattern#hush","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Applies \`rev\` to a pattern every other cycle, so that the pattern alternates between forwards and backwards.\\n * @example\\n * note(\\"c d e g\\").palindrome()\\n */","meta":{"range":[69066,69191],"filename":"pattern.mjs","lineno":2310,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100030096","name":"exports.palindrome","type":"VariableDeclaration"}},"description":"<p>Applies <code>rev</code> to a pattern every other cycle, so that the pattern alternates between forwards and backwards.</p>","examples":["note(\\"c d e g\\").palindrome()"],"name":"palindrome","longname":"palindrome","kind":"constant","scope":"global"},{"comment":"/**\\n * Jux with adjustable stereo width. 0 = mono, 1 = full stereo.\\n * @name juxBy\\n * @synonyms juxby\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").juxBy(\\"<0 .5 1>/2\\", rev)\\n */","meta":{"filename":"pattern.mjs","lineno":2319,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Jux with adjustable stereo width. 0 = mono, 1 = full stereo.</p>","name":"juxBy","synonyms_text":"juxby","synonyms":["juxby"],"examples":["s(\\"bd lt [~ ht] mt cp ~ bd hh\\").juxBy(\\"<0 .5 1>/2\\", rev)"],"longname":"juxBy","kind":"member","scope":"global"},{"comment":"/**\\n * The jux function creates strange stereo effects, by applying a function to a pattern, but only in the right-hand channel.\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(rev)\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(press)\\n * @example\\n * s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(iter(4))\\n */","meta":{"range":[70210,70306],"filename":"pattern.mjs","lineno":2349,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100030225","name":"exports.jux","type":"VariableDeclaration"}},"description":"<p>The jux function creates strange stereo effects, by applying a function to a pattern, but only in the right-hand channel.</p>","examples":["s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(rev)","s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(press)","s(\\"bd lt [~ ht] mt cp ~ bd hh\\").jux(iter(4))"],"name":"jux","longname":"jux","kind":"constant","scope":"global"},{"comment":"/**\\n * Superimpose and offset multiple times, applying the given function each time.\\n * @name echoWith\\n * @synonyms echowith, stutWith, stutwith\\n * @param {number} times how many times to repeat\\n * @param {number} time cycle offset between iterations\\n * @param {function} func function to apply, given the pattern and the iteration index\\n * @example\\n * \\"<0 [2 4]>\\"\\n * .echoWith(4, 1/8, (p,n) => p.add(n*2))\\n * .scale(\\"C:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2353,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Superimpose and offset multiple times, applying the given function each time.</p>","name":"echoWith","synonyms_text":"echowith, stutWith, stutwith","synonyms":["echowith","stutWith","stutwith"],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"},{"type":{"names":["function"]},"description":"<p>function to apply, given the pattern and the iteration index</p>","name":"func"}],"examples":["\\"<0 [2 4]>\\"\\n.echoWith(4, 1/8, (p,n) => p.add(n*2))\\n.scale(\\"C:minor\\").note()"],"longname":"echoWith","kind":"member","scope":"global"},{"comment":"/**\\n * Superimpose and offset multiple times, gradually decreasing the velocity\\n * @name echo\\n * @memberof Pattern\\n * @returns Pattern\\n * @param {number} times how many times to repeat\\n * @param {number} time cycle offset between iterations\\n * @param {number} feedback velocity multiplicator for each iteration\\n * @example\\n * s(\\"bd sd\\").echo(3, 1/6, .8)\\n */","meta":{"filename":"pattern.mjs","lineno":2372,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Superimpose and offset multiple times, gradually decreasing the velocity</p>","name":"echo","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"},{"type":{"names":["number"]},"description":"<p>velocity multiplicator for each iteration</p>","name":"feedback"}],"examples":["s(\\"bd sd\\").echo(3, 1/6, .8)"],"scope":"static","longname":"Pattern.echo","kind":"member"},{"comment":"/**\\n * Deprecated. Like echo, but the last 2 parameters are flipped.\\n * @name stut\\n * @param {number} times how many times to repeat\\n * @param {number} feedback velocity multiplicator for each iteration\\n * @param {number} time cycle offset between iterations\\n * @example\\n * s(\\"bd sd\\").stut(3, .8, 1/6)\\n */","meta":{"filename":"pattern.mjs","lineno":2387,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Deprecated. Like echo, but the last 2 parameters are flipped.</p>","name":"stut","params":[{"type":{"names":["number"]},"description":"<p>how many times to repeat</p>","name":"times"},{"type":{"names":["number"]},"description":"<p>velocity multiplicator for each iteration</p>","name":"feedback"},{"type":{"names":["number"]},"description":"<p>cycle offset between iterations</p>","name":"time"}],"examples":["s(\\"bd sd\\").stut(3, .8, 1/6)"],"longname":"stut","kind":"member","scope":"global"},{"comment":"/**\\n * Divides a pattern into a given number of subdivisions, plays the subdivisions in order, but increments the starting subdivision each cycle. The pattern wraps to the first subdivision after the last subdivision is played.\\n * @name iter\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"0 1 2 3\\".scale('A minor')).iter(4)\\n */","meta":{"filename":"pattern.mjs","lineno":2400,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Divides a pattern into a given number of subdivisions, plays the subdivisions in order, but increments the starting subdivision each cycle. The pattern wraps to the first subdivision after the last subdivision is played.</p>","name":"iter","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"0 1 2 3\\".scale('A minor')).iter(4)"],"scope":"static","longname":"Pattern.iter","kind":"member"},{"comment":"/**\\n * Like \`iter\`, but plays the subdivisions in reverse order. Known as iter' in tidalcycles\\n * @name iterBack\\n * @synonyms iterback\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(\\"0 1 2 3\\".scale('A minor')).iterBack(4)\\n */","meta":{"filename":"pattern.mjs","lineno":2427,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like <code>iter</code>, but plays the subdivisions in reverse order. Known as iter' in tidalcycles</p>","name":"iterBack","synonyms_text":"iterback","synonyms":["iterback"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(\\"0 1 2 3\\".scale('A minor')).iterBack(4)"],"scope":"static","longname":"Pattern.iterBack","kind":"member"},{"comment":"/**\\n * Repeats each cycle the given number of times.\\n * @name repeatCycles\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * note(irand(12).add(34)).segment(4).repeatCycles(2).s(\\"gm_acoustic_guitar_nylon\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2445,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Repeats each cycle the given number of times.</p>","name":"repeatCycles","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["note(irand(12).add(34)).segment(4).repeatCycles(2).s(\\"gm_acoustic_guitar_nylon\\")"],"scope":"static","longname":"Pattern.repeatCycles","kind":"member"},{"comment":"/**\\n * Divides a pattern into a given number of parts, then cycles through those parts in turn, applying the given function to each part in turn (one part per cycle).\\n * @name chunk\\n * @synonyms slowChunk, slowchunk\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"0 1 2 3\\".chunk(4, x=>x.add(7))\\n * .scale(\\"A:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2468,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Divides a pattern into a given number of parts, then cycles through those parts in turn, applying the given function to each part in turn (one part per cycle).</p>","name":"chunk","synonyms_text":"slowChunk, slowchunk","synonyms":["slowChunk","slowchunk"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2 3\\".chunk(4, x=>x.add(7))\\n.scale(\\"A:minor\\").note()"],"scope":"static","longname":"Pattern.chunk","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but cycles through the parts in reverse order. Known as chunk' in tidalcycles\\n * @name chunkBack\\n * @synonyms chunkback\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"0 1 2 3\\".chunkBack(4, x=>x.add(7))\\n * .scale(\\"A:minor\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2499,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but cycles through the parts in reverse order. Known as chunk' in tidalcycles</p>","name":"chunkBack","synonyms_text":"chunkback","synonyms":["chunkback"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"0 1 2 3\\".chunkBack(4, x=>x.add(7))\\n.scale(\\"A:minor\\").note()"],"scope":"static","longname":"Pattern.chunkBack","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but the cycles of the source pattern aren't repeated\\n * for each set of chunks.\\n * @name fastChunk\\n * @synonyms fastchunk\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * \\"<0 8> 1 2 3 4 5 6 7\\"\\n * .fastChunk(4, x => x.color('red')).slow(2)\\n * .scale(\\"C2:major\\").note()\\n */","meta":{"filename":"pattern.mjs","lineno":2518,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but the cycles of the source pattern aren't repeated\\nfor each set of chunks.</p>","name":"fastChunk","synonyms_text":"fastchunk","synonyms":["fastchunk"],"memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<0 8> 1 2 3 4 5 6 7\\"\\n.fastChunk(4, x => x.color('red')).slow(2)\\n.scale(\\"C2:major\\").note()"],"scope":"static","longname":"Pattern.fastChunk","kind":"member"},{"comment":"/**\\n * Like \`chunk\`, but the function is applied to a looped subcycle of the source pattern.\\n * @name chunkInto\\n * @synonyms chunkinto\\n * @memberof Pattern\\n * @example\\n * sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n *   .bank(\\"tr909\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2539,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like <code>chunk</code>, but the function is applied to a looped subcycle of the source pattern.</p>","name":"chunkInto","synonyms_text":"chunkinto","synonyms":["chunkinto"],"memberof":"Pattern","examples":["sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n  .bank(\\"tr909\\")"],"scope":"static","longname":"Pattern.chunkInto","kind":"member"},{"comment":"/**\\n * Like \`chunkInto\`, but moves backwards through the chunks.\\n * @name chunkBackInto\\n * @synonyms chunkbackinto\\n * @memberof Pattern\\n * @example\\n * sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n *   .bank(\\"tr909\\")\\n */","meta":{"filename":"pattern.mjs","lineno":2552,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Like <code>chunkInto</code>, but moves backwards through the chunks.</p>","name":"chunkBackInto","synonyms_text":"chunkbackinto","synonyms":["chunkbackinto"],"memberof":"Pattern","examples":["sound(\\"bd sd ht lt bd - cp lt\\").chunkInto(4, hurry(2))\\n  .bank(\\"tr909\\")"],"scope":"static","longname":"Pattern.chunkBackInto","kind":"member"},{"comment":"/**\\n * Loops the pattern inside an \`offset\` for \`cycles\`.\\n * If you think of the entire span of time in cycles as a ribbon, you can cut a single piece and loop it.\\n * @name ribbon\\n * @synonyms rib\\n * @param {number} offset start point of loop in cycles\\n * @param {number} cycles loop length in cycles\\n * @example\\n * note(\\"<c d e f>\\").ribbon(1, 2)\\n * @example\\n * // Looping a portion of randomness\\n * n(irand(8).segment(4)).scale(\\"c:pentatonic\\").ribbon(1337, 2)\\n * @example\\n * // rhythm generator\\n * s(\\"bd!16?\\").ribbon(29,.5)\\n */","meta":{"filename":"pattern.mjs","lineno":2581,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Loops the pattern inside an <code>offset</code> for <code>cycles</code>.\\nIf you think of the entire span of time in cycles as a ribbon, you can cut a single piece and loop it.</p>","name":"ribbon","synonyms_text":"rib","synonyms":["rib"],"params":[{"type":{"names":["number"]},"description":"<p>start point of loop in cycles</p>","name":"offset"},{"type":{"names":["number"]},"description":"<p>loop length in cycles</p>","name":"cycles"}],"examples":["note(\\"<c d e f>\\").ribbon(1, 2)","// Looping a portion of randomness\\nn(irand(8).segment(4)).scale(\\"c:pentatonic\\").ribbon(1337, 2)","// rhythm generator\\ns(\\"bd!16?\\").ribbon(29,.5)"],"longname":"ribbon","kind":"member","scope":"global"},{"comment":"/**\\n * Tags each Hap with an identifier. Good for filtering. The function populates Hap.context.tags (Array).\\n * @name tag\\n * @noAutocomplete\\n * @param {string} tag anything unique\\n */","meta":{"filename":"pattern.mjs","lineno":2609,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Tags each Hap with an identifier. Good for filtering. The function populates Hap.context.tags (Array).</p>","name":"tag","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"params":[{"type":{"names":["string"]},"description":"<p>anything unique</p>","name":"tag"}],"longname":"tag","kind":"member","scope":"global"},{"comment":"/**\\n * Filters haps using the given function\\n * @name filter\\n * @param {Function} test function to test Hap\\n * @example\\n * s(\\"hh!7 oh\\").filter(hap => hap.value.s==='hh')\\n */","meta":{"filename":"pattern.mjs","lineno":2619,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Filters haps using the given function</p>","name":"filter","params":[{"type":{"names":["function"]},"description":"<p>function to test Hap</p>","name":"test"}],"examples":["s(\\"hh!7 oh\\").filter(hap => hap.value.s==='hh')"],"longname":"filter","kind":"member","scope":"global"},{"comment":"/**\\n * Filters haps by their begin time\\n * @name filterWhen\\n * @noAutocomplete\\n * @param {Function} test function to test Hap.whole.begin\\n */","meta":{"filename":"pattern.mjs","lineno":2628,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Filters haps by their begin time</p>","name":"filterWhen","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"params":[{"type":{"names":["function"]},"description":"<p>function to test Hap.whole.begin</p>","name":"test"}],"longname":"filterWhen","kind":"member","scope":"global"},{"comment":"/**\\n * Use within to apply a function to only a part of a pattern.\\n * @name within\\n * @param {number} start start within cycle (0 - 1)\\n * @param {number} end end within cycle (0 - 1). Must be > start\\n * @param {Function} func function to be applied to the sub-pattern\\n */","meta":{"filename":"pattern.mjs","lineno":2636,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Use within to apply a function to only a part of a pattern.</p>","name":"within","params":[{"type":{"names":["number"]},"description":"<p>start within cycle (0 - 1)</p>","name":"start"},{"type":{"names":["number"]},"description":"<p>end within cycle (0 - 1). Must be &gt; start</p>","name":"end"},{"type":{"names":["function"]},"description":"<p>function to be applied to the sub-pattern</p>","name":"func"}],"longname":"within","kind":"member","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Speeds a pattern up or down, to fit to the given number of steps per cycle.\\n * @example\\n * sound(\\"bd sd cp\\").pace(4)\\n * // The same as sound(\\"{bd sd cp}%4\\") or sound(\\"<bd sd cp>*4\\")\\n */","meta":{"range":[81328,81623],"filename":"pattern.mjs","lineno":2717,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100031428","name":"exports.pace","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Speeds a pattern up or down, to fit to the given number of steps per cycle.</p>","examples":["sound(\\"bd sd cp\\").pace(4)\\n// The same as sound(\\"{bd sd cp}%4\\") or sound(\\"<bd sd cp>*4\\")"],"name":"pace","longname":"pace","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Aligns the steps of the patterns, creating polymeters. The patterns are repeated until they all fit the cycle. For example, in the below the first pattern is repeated twice, and the second is repeated three times, to fit the lowest common multiple of six steps.\\n * @synonyms pm\\n * @example\\n * // The same as note(\\"{c eb g, c2 g2}%6\\")\\n * polymeter(\\"c eb g\\", \\"c2 g2\\").note()\\n *\\n */","meta":{"range":[82501,83009],"filename":"pattern.mjs","lineno":2760,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100031581","name":"exports.polymeter","type":"FunctionDeclaration","paramnames":["args"]}},"description":"<p><em>Experimental</em></p>\\n<p>Aligns the steps of the patterns, creating polymeters. The patterns are repeated until they all fit the cycle. For example, in the below the first pattern is repeated twice, and the second is repeated three times, to fit the lowest common multiple of six steps.</p>","synonyms_text":"pm","synonyms":["pm"],"examples":["// The same as note(\\"{c eb g, c2 g2}%6\\")\\npolymeter(\\"c eb g\\", \\"c2 g2\\").note()"],"name":"polymeter","longname":"polymeter","kind":"function","scope":"global"},{"comment":"/** 'Concatenates' patterns like \`fastcat\`, but proportional to a number of steps per cycle.\\n * The steps can either be inferred from the pattern, or provided as a [length, pattern] pair.\\n * Has the alias \`timecat\`.\\n * @name stepcat\\n * @synonyms timeCat, timecat\\n * @return {Pattern}\\n * @example\\n * stepcat([3,\\"e3\\"],[1, \\"g3\\"]).note()\\n * // the same as \\"e3@3 g3\\".note()\\n * @example\\n * stepcat(\\"bd sd cp\\",\\"hh hh\\").sound()\\n * // the same as \\"bd sd cp hh hh\\".sound()\\n */","meta":{"filename":"pattern.mjs","lineno":2782,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>'Concatenates' patterns like <code>fastcat</code>, but proportional to a number of steps per cycle.\\nThe steps can either be inferred from the pattern, or provided as a [length, pattern] pair.\\nHas the alias <code>timecat</code>.</p>","name":"stepcat","synonyms_text":"timeCat, timecat","synonyms":["timeCat","timecat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["stepcat([3,\\"e3\\"],[1, \\"g3\\"]).note()\\n// the same as \\"e3@3 g3\\".note()","stepcat(\\"bd sd cp\\",\\"hh hh\\").sound()\\n// the same as \\"bd sd cp hh hh\\".sound()"],"longname":"stepcat","kind":"member","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Concatenates patterns stepwise, according to an inferred 'steps per cycle'.\\n * Similar to \`stepcat\`, but if an argument is a list, the whole pattern will alternate between the elements in the list.\\n *\\n * @return {Pattern}\\n * @example\\n * stepalt([\\"bd cp\\", \\"mt\\"], \\"bd\\").sound()\\n * // The same as \\"bd cp bd mt bd\\".sound()\\n */","meta":{"range":[85073,85620],"filename":"pattern.mjs","lineno":2848,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100031952","name":"exports.stepalt","type":"FunctionDeclaration","paramnames":["groups"]}},"description":"<p><em>Experimental</em></p>\\n<p>Concatenates patterns stepwise, according to an inferred 'steps per cycle'.\\nSimilar to <code>stepcat</code>, but if an argument is a list, the whole pattern will alternate between the elements in the list.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["stepalt([\\"bd cp\\", \\"mt\\"], \\"bd\\").sound()\\n// The same as \\"bd cp bd mt bd\\".sound()"],"name":"stepalt","longname":"stepalt","kind":"function","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Takes the given number of steps from a pattern (dropping the rest).\\n * A positive number will take steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"bd cp ht mt\\".take(\\"2\\").sound()\\n * // The same as \\"bd cp\\".sound()\\n * @example\\n * \\"bd cp ht mt\\".take(\\"1 2 3\\").sound()\\n * // The same as \\"bd bd cp bd cp ht\\".sound()\\n * @example\\n * \\"bd cp ht mt\\".take(\\"-1 -2 -3\\").sound()\\n * // The same as \\"mt ht mt cp ht mt\\".sound()\\n */","meta":{"range":[86123,86615],"filename":"pattern.mjs","lineno":2880,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032093","name":"exports.take","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Takes the given number of steps from a pattern (dropping the rest).\\nA positive number will take steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"bd cp ht mt\\".take(\\"2\\").sound()\\n// The same as \\"bd cp\\".sound()","\\"bd cp ht mt\\".take(\\"1 2 3\\").sound()\\n// The same as \\"bd bd cp bd cp ht\\".sound()","\\"bd cp ht mt\\".take(\\"-1 -2 -3\\").sound()\\n// The same as \\"mt ht mt cp ht mt\\".sound()"],"name":"take","longname":"take","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Drops the given number of steps from a pattern.\\n * A positive number will drop steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"1\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"-1\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"0 1 2 3\\").sound().bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".drop(\\"0 -1 -2 -3\\").sound().bank(\\"mridangam\\")\\n */","meta":{"range":[87116,87363],"filename":"pattern.mjs","lineno":2923,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032205","name":"exports.drop","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Drops the given number of steps from a pattern.\\nA positive number will drop steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".drop(\\"1\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"-1\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"0 1 2 3\\").sound().bank(\\"mridangam\\")","\\"tha dhi thom nam\\".drop(\\"0 -1 -2 -3\\").sound().bank(\\"mridangam\\")"],"name":"drop","longname":"drop","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * \`extend\` is similar to \`fast\` in that it increases its density, but it also increases the step count\\n * accordingly. So \`stepcat(\\"a b\\".extend(2), \\"c d\\")\` would be the same as \`\\"a b a b c d\\"\`, whereas\\n * \`stepcat(\\"a b\\".fast(2), \\"c d\\")\` would be the same as \`\\"[a b] [a b] c d\\"\`.\\n * @example\\n * stepcat(\\n *   sound(\\"bd bd - cp\\").extend(2),\\n *   sound(\\"bd - sd -\\")\\n * ).pace(8)\\n */","meta":{"range":[87771,87886],"filename":"pattern.mjs","lineno":2947,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032267","name":"exports.extend","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p><code>extend</code> is similar to <code>fast</code> in that it increases its density, but it also increases the step count\\naccordingly. So <code>stepcat(&quot;a b&quot;.extend(2), &quot;c d&quot;)</code> would be the same as <code>&quot;a b a b c d&quot;</code>, whereas\\n<code>stepcat(&quot;a b&quot;.fast(2), &quot;c d&quot;)</code> would be the same as <code>&quot;[a b] [a b] c d&quot;</code>.</p>","examples":["stepcat(\\n  sound(\\"bd bd - cp\\").extend(2),\\n  sound(\\"bd - sd -\\")\\n).pace(8)"],"name":"extend","longname":"extend","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Expands the step size of the pattern by the given factor.\\n * @example\\n * sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").expand(\\"3 2 1 1 2 3\\").pace(8)\\n */","meta":{"range":[88067,88196],"filename":"pattern.mjs","lineno":2958,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032288","name":"exports.expand","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Expands the step size of the pattern by the given factor.</p>","examples":["sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").expand(\\"3 2 1 1 2 3\\").pace(8)"],"name":"expand","longname":"expand","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Contracts the step size of the pattern by the given factor. See also \`expand\`.\\n * @example\\n * sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").contract(\\"3 2 1 1 2 3\\").pace(8)\\n */","meta":{"range":[88400,88533],"filename":"pattern.mjs","lineno":2969,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032313","name":"exports.contract","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Contracts the step size of the pattern by the given factor. See also <code>expand</code>.</p>","examples":["sound(\\"tha dhi thom nam\\").bank(\\"mridangam\\").contract(\\"3 2 1 1 2 3\\").pace(8)"],"name":"contract","longname":"contract","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Progressively shrinks the pattern by 'n' steps until there's nothing left, or if a second value is given (using mininotation list syntax with \`:\`),\\n * that number of times.\\n * A positive number will progressively drop steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"-1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".shrink(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .shrink(\\"1 -1\\").pace(8)\\n\\n */","meta":{"range":[90182,90564],"filename":"pattern.mjs","lineno":3035,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032553","name":"exports.shrink","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Progressively shrinks the pattern by 'n' steps until there's nothing left, or if a second value is given (using mininotation list syntax with <code>:</code>),\\nthat number of times.\\nA positive number will progressively drop steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".shrink(\\"1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".shrink(\\"-1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".shrink(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)","note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .shrink(\\"1 -1\\").pace(8)"],"name":"shrink","longname":"shrink","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n *\\n * Progressively grows the pattern by 'n' steps until the full pattern is played, or if a second value is given (using mininotation list syntax with \`:\`),\\n * that number of times.\\n * A positive number will progressively grow steps from the start of a pattern, and a negative number from the end.\\n * @return {Pattern}\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"-1\\").sound()\\n * .bank(\\"mridangam\\")\\n * @example\\n * \\"tha dhi thom nam\\".grow(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)\\n * @example\\n * note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .grow(\\"1 -1\\").pace(8)\\n */","meta":{"range":[91244,91659],"filename":"pattern.mjs","lineno":3073,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032619","name":"exports.grow","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Progressively grows the pattern by 'n' steps until the full pattern is played, or if a second value is given (using mininotation list syntax with <code>:</code>),\\nthat number of times.\\nA positive number will progressively grow steps from the start of a pattern, and a negative number from the end.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"tha dhi thom nam\\".grow(\\"1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".grow(\\"-1\\").sound()\\n.bank(\\"mridangam\\")","\\"tha dhi thom nam\\".grow(\\"1 -1\\").sound().bank(\\"mridangam\\").pace(4)","note(\\"0 1 2 3 4 5 6 7\\".scale(\\"C:ritusen\\")).sound(\\"folkharp\\")\\n   .grow(\\"1 -1\\").pace(8)"],"name":"grow","longname":"grow","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n * \\n * Inserts a pattern into a list of patterns. On the first repetition it will be inserted at the end of the list, then moved backwards through the list \\n * on successive repetitions. The patterns are added together stepwise, with all repetitions taking place over a single cycle. Using \`pace\` to set the \\n * number of steps per cycle is therefore usually recommended.\\n * \\n * @return {Pattern}\\n * @example\\n * \\"[c g]\\".tour(\\"e f\\", \\"e f g\\", \\"g f e c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)\\n */","meta":{"range":[92180,92256],"filename":"pattern.mjs","lineno":3105,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032696","name":"exports.tour","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>Inserts a pattern into a list of patterns. On the first repetition it will be inserted at the end of the list, then moved backwards through the list\\non successive repetitions. The patterns are added together stepwise, with all repetitions taking place over a single cycle. Using <code>pace</code> to set the\\nnumber of steps per cycle is therefore usually recommended.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"[c g]\\".tour(\\"e f\\", \\"e f g\\", \\"g f e c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)"],"name":"tour","longname":"tour","kind":"constant","scope":"global"},{"comment":"/**\\n * *Experimental*\\n * \\n * 'zips' together the steps of the provided patterns. This can create a long repetition, taking place over a single, dense cycle. \\n * Using \`pace\` to set the number of steps per cycle is therefore usually recommended.\\n * \\n * @returns {Pattern}\\n * @example\\n * zip(\\"e f\\", \\"e f g\\", \\"g [f e] a f4 c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)\\n */","meta":{"range":[92856,93111],"filename":"pattern.mjs","lineno":3131,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032765","name":"exports.zip","type":"VariableDeclaration"}},"description":"<p><em>Experimental</em></p>\\n<p>'zips' together the steps of the provided patterns. This can create a long repetition, taking place over a single, dense cycle.\\nUsing <code>pace</code> to set the number of steps per cycle is therefore usually recommended.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["zip(\\"e f\\", \\"e f g\\", \\"g [f e] a f4 c\\").note()\\n   .sound(\\"folkharp\\")\\n   .pace(8)"],"name":"zip","longname":"zip","kind":"constant","scope":"global"},{"comment":"/** Aliases for \`stepcat\` */","meta":{"range":[93142,93173],"filename":"pattern.mjs","lineno":3139,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100032829","name":"exports.timecat","type":"VariableDeclaration"}},"description":"<p>Aliases for <code>stepcat</code></p>","name":"timecat","longname":"timecat","kind":"constant","scope":"global"},{"comment":"/**\\n * Cuts each sample into the given number of parts, allowing you to explore a technique known as 'granular synthesis'.\\n * It turns a pattern of samples into a pattern of parts of samples.\\n * @name chop\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\")\\n *  .chop(4)\\n *  .rev() // reverse order of chops\\n *  .loopAt(2) // fit sample into 2 cycles\\n *\\n */","meta":{"filename":"pattern.mjs","lineno":3172,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Cuts each sample into the given number of parts, allowing you to explore a technique known as 'granular synthesis'.\\nIt turns a pattern of samples into a pattern of parts of samples.</p>","name":"chop","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\")\\n .chop(4)\\n .rev() // reverse order of chops\\n .loopAt(2) // fit sample into 2 cycles"],"scope":"static","longname":"Pattern.chop","kind":"member"},{"comment":"/**\\n * Cuts each sample into the given number of parts, triggering progressive portions of each sample at each loop.\\n * @name striate\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"numbers:0 numbers:1 numbers:2\\").striate(6).slow(3)\\n */","meta":{"filename":"pattern.mjs","lineno":3203,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Cuts each sample into the given number of parts, triggering progressive portions of each sample at each loop.</p>","name":"striate","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"numbers:0 numbers:1 numbers:2\\").striate(6).slow(3)"],"scope":"static","longname":"Pattern.striate","kind":"member"},{"comment":"/**\\n * Makes the sample fit the given number of cycles by changing the speed.\\n * @name loopAt\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\").loopAt(2)\\n */","meta":{"filename":"pattern.mjs","lineno":3221,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit the given number of cycles by changing the speed.</p>","name":"loopAt","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\").loopAt(2)"],"scope":"static","longname":"Pattern.loopAt","kind":"member"},{"comment":"/**\\n * Chops samples into the given number of slices, triggering those slices with a given pattern of slice numbers.\\n * Instead of a number, it also accepts a list of numbers from 0 to 1 to slice at specific points.\\n * @name slice\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks165\\").slice(8, \\"0 1 <2 2*2> 3 [4 0] 5 6 7\\".every(3, rev)).slow(0.75)\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks125\\").fit().slice([0,.25,.5,.75], \\"0 1 1 <2 3>\\")\\n */","meta":{"filename":"pattern.mjs","lineno":3238,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Chops samples into the given number of slices, triggering those slices with a given pattern of slice numbers.\\nInstead of a number, it also accepts a list of numbers from 0 to 1 to slice at specific points.</p>","name":"slice","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks165\\").slice(8, \\"0 1 <2 2*2> 3 [4 0] 5 6 7\\".every(3, rev)).slow(0.75)","samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks125\\").fit().slice([0,.25,.5,.75], \\"0 1 1 <2 3>\\")"],"scope":"static","longname":"Pattern.slice","kind":"member"},{"comment":"/**\\n *\\n * make something happen on event time\\n * uses browser timeout which is innacurate for audio tasks\\n * @name onTriggerTime\\n * @memberof Pattern\\n *  @returns Pattern\\n * @example\\n * s(\\"bd!8\\").onTriggerTime((hap) => {console.log(hap)})\\n */","meta":{"filename":"pattern.mjs","lineno":3272,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>make something happen on event time\\nuses browser timeout which is innacurate for audio tasks</p>","name":"onTriggerTime","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd!8\\").onTriggerTime((hap) => {console.log(hap)})"],"scope":"static","longname":"Pattern.onTriggerTime","kind":"member"},{"comment":"/**\\n * Works the same as slice, but changes the playback speed of each slice to match the duration of its step.\\n * @name splice\\n * @example\\n * samples('github:tidalcycles/dirt-samples')\\n * s(\\"breaks165\\")\\n * .splice(8,  \\"0 1 [2 3 0]@2 3 0@2 7\\")\\n */","meta":{"filename":"pattern.mjs","lineno":3291,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Works the same as slice, but changes the playback speed of each slice to match the duration of its step.</p>","name":"splice","examples":["samples('github:tidalcycles/dirt-samples')\\ns(\\"breaks165\\")\\n.splice(8,  \\"0 1 [2 3 0]@2 3 0@2 7\\")"],"longname":"splice","kind":"member","scope":"global"},{"comment":"/**\\n * Makes the sample fit its event duration. Good for rhythmical loops like drum breaks.\\n * Similar to \`loopAt\`.\\n * @name fit\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes/2\\").fit()\\n */","meta":{"filename":"pattern.mjs","lineno":3327,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit its event duration. Good for rhythmical loops like drum breaks.\\nSimilar to <code>loopAt</code>.</p>","name":"fit","examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes/2\\").fit()"],"longname":"fit","kind":"member","scope":"global"},{"comment":"/**\\n * Makes the sample fit the given number of cycles and cps value, by\\n * changing the speed. Please note that at some point cps will be\\n * given by a global clock and this function will be\\n * deprecated/removed.\\n * @name loopAtCps\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\n * s(\\"rhodes\\").loopAtCps(4,1.5).cps(1.5)\\n */","meta":{"filename":"pattern.mjs","lineno":3350,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Makes the sample fit the given number of cycles and cps value, by\\nchanging the speed. Please note that at some point cps will be\\ngiven by a global clock and this function will be\\ndeprecated/removed.</p>","name":"loopAtCps","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["samples({ rhodes: 'https://cdn.freesound.org/previews/132/132051_316502-lq.mp3' })\\ns(\\"rhodes\\").loopAtCps(4,1.5).cps(1.5)"],"scope":"static","longname":"Pattern.loopAtCps","kind":"member"},{"comment":"/** exposes a custom value at query time. basically allows mutating state without evaluation */","meta":{"range":[100643,100743],"filename":"pattern.mjs","lineno":3368,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100033669","name":"exports.ref","type":"VariableDeclaration"}},"description":"<p>exposes a custom value at query time. basically allows mutating state without evaluation</p>","name":"ref","longname":"ref","kind":"constant","scope":"global"},{"comment":"/**\\n * Cross-fades between left and right from 0 to 1:\\n * - 0 = (full left, no right)\\n * - .5 = (both equal)\\n * - 1 = (no left, full right)\\n *\\n * @name xfade\\n * @example\\n * xfade(s(\\"bd*2\\"), \\"<0 .25 .5 .75 1>\\", s(\\"hh*8\\"))\\n */","meta":{"filename":"pattern.mjs","lineno":3375,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Cross-fades between left and right from 0 to 1:</p>\\n<ul>\\n<li>0 = (full left, no right)</li>\\n<li>.5 = (both equal)</li>\\n<li>1 = (no left, full right)</li>\\n</ul>","name":"xfade","examples":["xfade(s(\\"bd*2\\"), \\"<0 .25 .5 .75 1>\\", s(\\"hh*8\\"))"],"longname":"xfade","kind":"member","scope":"global"},{"comment":"/**\\n * creates a structure pattern from divisions of a cycle\\n * especially useful for creating rhythms\\n * @name beat\\n * @example\\n * s(\\"bd\\").beat(\\"0,7,10\\", 16)\\n * @example\\n * s(\\"sd\\").beat(\\"4,12\\", 16)\\n */","meta":{"filename":"pattern.mjs","lineno":3399,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>creates a structure pattern from divisions of a cycle\\nespecially useful for creating rhythms</p>","name":"beat","examples":["s(\\"bd\\").beat(\\"0,7,10\\", 16)","s(\\"sd\\").beat(\\"4,12\\", 16)"],"longname":"beat","kind":"member","scope":"global"},{"comment":"/**\\n * Takes two binary rhythms represented as lists of 1s and 0s, and a number\\n * between 0 and 1 that morphs between them. The two lists should contain the same\\n * number of true values.\\n * @example\\n * sound(\\"hh\\").struct(morph([1,0,1,0,1,0,1,0], // straight rhythm\\n *                          [1,1,0,1,0,1,0], // wonky rhythm\\n *                          0.25 // creates a slightly wonky rhythm\\n *                         )\\n *                   )\\n * @example\\n * sound(\\"hh\\").struct(morph(\\"1:0:1:0:1:0:1:0\\", // straight rhythm\\n *                          \\"1:1:0:1:0:1:0\\", // wonky rhythm\\n *                          sine.slow(8) // slowly morph between the rhythms\\n *                         )\\n *                   )\\n */","meta":{"range":[103717,103955],"filename":"pattern.mjs","lineno":3480,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034069","name":"exports.morph","type":"VariableDeclaration"}},"description":"<p>Takes two binary rhythms represented as lists of 1s and 0s, and a number\\nbetween 0 and 1 that morphs between them. The two lists should contain the same\\nnumber of true values.</p>","examples":["sound(\\"hh\\").struct(morph([1,0,1,0,1,0,1,0], // straight rhythm\\n                         [1,1,0,1,0,1,0], // wonky rhythm\\n                         0.25 // creates a slightly wonky rhythm\\n                        )\\n                  )","sound(\\"hh\\").struct(morph(\\"1:0:1:0:1:0:1:0\\", // straight rhythm\\n                         \\"1:1:0:1:0:1:0\\", // wonky rhythm\\n                         sine.slow(8) // slowly morph between the rhythms\\n                        )\\n                  )"],"name":"morph","longname":"morph","kind":"constant","scope":"global"},{"comment":"/** * Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\n * Similar to \`inhabit\`, but maintains the structure of the original patterns.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(\\"<0 1 2!2 3>\\".pick([\\"g a\\", \\"e f\\", \\"f g f g\\" , \\"g c d\\"]))\\n * @example\\n * sound(\\"<0 1 [2,0]>\\".pick([\\"bd sd\\", \\"cp cp\\", \\"hh hh\\"]))\\n * @example\\n * sound(\\"<0!2 [0,1] 1>\\".pick([\\"bd(3,8)\\", \\"sd sd\\"]))\\n * @example\\n * s(\\"<a!2 [a,b] b>\\".pick({a: \\"bd(3,8)\\", b: \\"sd sd\\"}))\\n */","meta":{"range":[1892,2094],"filename":"pick.mjs","lineno":44,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034226","name":"exports.pick","type":"VariableDeclaration"}},"description":"<p>Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\nSimilar to <code>inhabit</code>, but maintains the structure of the original patterns.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<0 1 2!2 3>\\".pick([\\"g a\\", \\"e f\\", \\"f g f g\\" , \\"g c d\\"]))","sound(\\"<0 1 [2,0]>\\".pick([\\"bd sd\\", \\"cp cp\\", \\"hh hh\\"]))","sound(\\"<0!2 [0,1] 1>\\".pick([\\"bd(3,8)\\", \\"sd sd\\"]))","s(\\"<a!2 [a,b] b>\\".pick({a: \\"bd(3,8)\\", b: \\"sd sd\\"}))"],"name":"pick","longname":"pick","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pick\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * For example, if you pick the fifth pattern of a list of three, you'll get the\\n * second one.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[2519,2637],"filename":"pick.mjs","lineno":65,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034271","name":"exports.pickmod","type":"VariableDeclaration"}},"description":"<p>The same as <code>pick</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.\\nFor example, if you pick the fifth pattern of a list of three, you'll get the\\nsecond one.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmod","longname":"pickmod","kind":"constant","scope":"global"},{"comment":"/** * pickF lets you use a pattern of numbers to pick which function to apply to another pattern.\\n * @param {Pattern} pat\\n * @param {Pattern} lookup a pattern of indices\\n * @param {function[]} funcs the array of functions from which to pull\\n * @returns {Pattern}\\n * @example\\n * s(\\"bd [rim hh]\\").pickF(\\"<0 1 2>\\", [rev,jux(rev),fast(2)])\\n * @example\\n * note(\\"<c2 d2>(3,8)\\").s(\\"square\\")\\n *     .pickF(\\"<0 2> 1\\", [jux(rev),fast(2),x=>x.lpf(800)])\\n */","meta":{"range":[3086,3201],"filename":"pick.mjs","lineno":80,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034291","name":"exports.pickF","type":"VariableDeclaration"}},"description":"<p>pickF lets you use a pattern of numbers to pick which function to apply to another pattern.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["Pattern"]},"description":"<p>a pattern of indices</p>","name":"lookup"},{"type":{"names":["Array.<function()>"]},"description":"<p>the array of functions from which to pull</p>","name":"funcs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["s(\\"bd [rim hh]\\").pickF(\\"<0 1 2>\\", [rev,jux(rev),fast(2)])","note(\\"<c2 d2>(3,8)\\").s(\\"square\\")\\n    .pickF(\\"<0 2> 1\\", [jux(rev),fast(2),x=>x.lpf(800)])"],"name":"pickF","longname":"pickF","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickF\`, but if you pick a number greater than the size of the functions list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {Pattern} lookup a pattern of indices\\n * @param {function[]} funcs the array of functions from which to pull\\n * @returns {Pattern}\\n */","meta":{"range":[3532,3656],"filename":"pick.mjs","lineno":91,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034312","name":"exports.pickmodF","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickF</code>, but if you pick a number greater than the size of the functions list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["Pattern"]},"description":"<p>a pattern of indices</p>","name":"lookup"},{"type":{"names":["Array.<function()>"]},"description":"<p>the array of functions from which to pull</p>","name":"funcs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodF","longname":"pickmodF","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but it applies an outerJoin instead of an innerJoin.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[3803,3922],"filename":"pick.mjs","lineno":100,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034333","name":"exports.pickOut","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but it applies an outerJoin instead of an innerJoin.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickOut","longname":"pickOut","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickOut\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[4143,4267],"filename":"pick.mjs","lineno":110,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034353","name":"exports.pickmodOut","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickOut</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodOut","longname":"pickmodOut","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but the choosen pattern is restarted when its index is triggered.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[4427,4556],"filename":"pick.mjs","lineno":119,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034373","name":"exports.pickRestart","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but the choosen pattern is restarted when its index is triggered.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickRestart","longname":"pickRestart","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickRestart\`, but if you pick a number greater than the size of the list,\\n   * it wraps around, rather than sticking at the maximum value.\\n   * @param {Pattern} pat\\n   * @param {*} xs\\n   * @returns {Pattern}\\n   * @example\\n   * \\"<a@2 b@2 c@2 d@2>\\".pickRestart({\\n        a: n(\\"0 1 2 0\\"),\\n        b: n(\\"2 3 4 ~\\"),\\n        c: n(\\"[4 5] [4 3] 2 0\\"),\\n        d: n(\\"0 -3 0 ~\\")\\n      }).scale(\\"C:major\\").s(\\"piano\\")\\n   */","meta":{"range":[4989,5123],"filename":"pick.mjs","lineno":136,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034393","name":"exports.pickmodRestart","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickRestart</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"<a@2 b@2 c@2 d@2>\\".pickRestart({\\n        a: n(\\"0 1 2 0\\"),\\n        b: n(\\"2 3 4 ~\\"),\\n        c: n(\\"[4 5] [4 3] 2 0\\"),\\n        d: n(\\"0 -3 0 ~\\")\\n      }).scale(\\"C:major\\").s(\\"piano\\")"],"name":"pickmodRestart","longname":"pickmodRestart","kind":"constant","scope":"global"},{"comment":"/** * Similar to \`pick\`, but the choosen pattern is reset when its index is triggered.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[5279,5402],"filename":"pick.mjs","lineno":145,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034413","name":"exports.pickReset","type":"VariableDeclaration"}},"description":"<p>Similar to <code>pick</code>, but the choosen pattern is reset when its index is triggered.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickReset","longname":"pickReset","kind":"constant","scope":"global"},{"comment":"/** * The same as \`pickReset\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[5625,5753],"filename":"pick.mjs","lineno":155,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034433","name":"exports.pickmodReset","type":"VariableDeclaration"}},"description":"<p>The same as <code>pickReset</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"pickmodReset","longname":"pickmodReset","kind":"constant","scope":"global"},{"comment":"/** Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\n   * Similar to \`pick\`, but cycles are squeezed into the target ('inhabited') pattern.\\n   * @name inhabit\\n   * @synonyms pickSqueeze\\n   * @param {Pattern} pat\\n   * @param {*} xs\\n   * @returns {Pattern}\\n   * @example\\n   * \\"<a b [a,b]>\\".inhabit({a: s(\\"bd(3,8)\\"),\\n                            b: s(\\"cp sd\\")\\n                           })\\n   * @example\\n   * s(\\"a@2 [a b] a\\".inhabit({a: \\"bd(3,8)\\", b: \\"sd sd\\"})).slow(4)\\n   */","meta":{"filename":"pick.mjs","lineno":159,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Picks patterns (or plain values) either from a list (by index) or a lookup table (by name).\\nSimilar to <code>pick</code>, but cycles are squeezed into the target ('inhabited') pattern.</p>","name":"inhabit","synonyms_text":"pickSqueeze","synonyms":["pickSqueeze"],"params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["\\"<a b [a,b]>\\".inhabit({a: s(\\"bd(3,8)\\"),\\n                            b: s(\\"cp sd\\")\\n                           })","s(\\"a@2 [a b] a\\".inhabit({a: \\"bd(3,8)\\", b: \\"sd sd\\"})).slow(4)"],"longname":"inhabit","kind":"member","scope":"global"},{"comment":"/** * The same as \`inhabit\`, but if you pick a number greater than the size of the list,\\n * it wraps around, rather than sticking at the maximum value.\\n * For example, if you pick the fifth pattern of a list of three, you'll get the\\n * second one.\\n * @name inhabitmod\\n * @synonyms pickmodSqueeze\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"filename":"pick.mjs","lineno":177,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>The same as <code>inhabit</code>, but if you pick a number greater than the size of the list,\\nit wraps around, rather than sticking at the maximum value.\\nFor example, if you pick the fifth pattern of a list of three, you'll get the\\nsecond one.</p>","name":"inhabitmod","synonyms_text":"pickmodSqueeze","synonyms":["pickmodSqueeze"],"params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"longname":"inhabitmod","kind":"member","scope":"global"},{"comment":"/**\\n * Pick from the list of values (or patterns of values) via the index using the given\\n * pattern of integers. The selected pattern will be compressed to fit the duration of the selecting event\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(squeeze(\\"<0@2 [1!2] 2>\\", [\\"g a\\", \\"f g f g\\" , \\"g a c d\\"]))\\n */","meta":{"range":[7302,7543],"filename":"pick.mjs","lineno":202,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034505","name":"exports.squeeze","type":"VariableDeclaration"}},"description":"<p>Pick from the list of values (or patterns of values) via the index using the given\\npattern of integers. The selected pattern will be compressed to fit the duration of the selecting event</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(squeeze(\\"<0@2 [1!2] 2>\\", [\\"g a\\", \\"f g f g\\" , \\"g a c d\\"]))"],"name":"squeeze","longname":"squeeze","kind":"constant","scope":"global"},{"comment":"/**\\n   * Changes the global tempo to the given cycles per minute\\n   *\\n   * @name setcpm\\n   * @alias setCpm\\n   * @param {number} cpm cycles per minute\\n   * @example\\n   * setcpm(140/4) // =140 bpm in 4/4\\n   * $: s(\\"bd*4,[- sd]*2\\").bank('tr707')\\n   */","meta":{"filename":"repl.mjs","lineno":90,"columnno":2,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Changes the global tempo to the given cycles per minute</p>","name":"setcpm","alias":"setCpm","params":[{"type":{"names":["number"]},"description":"<p>cycles per minute</p>","name":"cpm"}],"examples":["setcpm(140/4) // =140 bpm in 4/4\\n$: s(\\"bd*4,[- sd]*2\\").bank('tr707')"],"longname":"setcpm","kind":"member","scope":"global"},{"comment":"/** Applies a function to all the running patterns. Note that the patterns are groups together into a single \`stack\` before the function is applied. This is probably what you want, but see \`each\` for\\n   * a version that applies the function to each pattern separately.\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * all(fast(\\"<2 3>\\"))\\n   * \`\`\`\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * all(x => x.pianoroll())\\n   * \`\`\`\\n   */","meta":{"range":[3200,3218],"filename":"repl.mjs","lineno":117,"columnno":6,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034877","name":"allTransforms","type":"ArrayExpression","value":"[]"}},"description":"<p>Applies a function to all the running patterns. Note that the patterns are groups together into a single <code>stack</code> before the function is applied. This is probably what you want, but see <code>each</code> for\\na version that applies the function to each pattern separately.</p>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\nall(fast(&quot;&lt;2 3>&quot;))\\n</code></pre>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\nall(x => x.pianoroll())\\n</code></pre>","name":"allTransforms","longname":"repl~allTransforms","kind":"member","memberof":"repl","scope":"inner","params":[]},{"comment":"/** Applies a function to each of the running patterns separately. This is intended for future use with upcoming 'stepwise' features. See \`all\` for a version that applies the function to all the patterns stacked together into a single pattern.\\n   * \`\`\`\\n   * $: sound(\\"bd - cp sd\\")\\n   * $: sound(\\"hh*8\\")\\n   * each(fast(\\"<2 3>\\"))\\n   * \`\`\`\\n   */","meta":{"range":[3670,3754],"filename":"repl.mjs","lineno":129,"columnno":8,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100034895","name":"each","type":"FunctionExpression"},"vars":{"eachTransform":"repl~each~eachTransform"}},"description":"<p>Applies a function to each of the running patterns separately. This is intended for future use with upcoming 'stepwise' features. See <code>all</code> for a version that applies the function to all the patterns stacked together into a single pattern.</p>\\n<pre class=\\"prettyprint source\\"><code>$: sound(&quot;bd - cp sd&quot;)\\n$: sound(&quot;hh*8&quot;)\\neach(fast(&quot;&lt;2 3>&quot;))\\n</code></pre>","name":"each","longname":"repl~each","kind":"function","memberof":"repl","scope":"inner","params":[]},{"comment":"/**\\n *  A sawtooth signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n * .clip(saw.slow(2))\\n * @example\\n * n(saw.range(0,8).segment(8))\\n * .scale('C major')\\n *\\n */","meta":{"range":[1533,1573],"filename":"signal.mjs","lineno":35,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035519","name":"exports.saw","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n.clip(saw.slow(2))","n(saw.range(0,8).segment(8))\\n.scale('C major')"],"name":"saw","longname":"saw","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between -1 and 1 (like \`saw\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[1673,1709],"filename":"signal.mjs","lineno":42,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035530","name":"exports.saw2","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between -1 and 1 (like <code>saw</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"saw2","longname":"saw2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between 1 and 0 (like \`saw\`, but flipped).\\n *\\n * @return {Pattern}\\n * @example\\n * note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n * .clip(isaw.slow(2))\\n * @example\\n * n(isaw.range(0,8).segment(8))\\n * .scale('C major')\\n *\\n */","meta":{"range":[1951,1998],"filename":"signal.mjs","lineno":56,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035538","name":"exports.isaw","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 1 and 0 (like <code>saw</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"<c3 [eb3,g3] g2 [g3,bb3]>*8\\")\\n.clip(isaw.slow(2))","n(isaw.range(0,8).segment(8))\\n.scale('C major')"],"name":"isaw","longname":"isaw","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sawtooth signal between 1 and -1 (like \`saw2\`, but flipped).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2099,2137],"filename":"signal.mjs","lineno":63,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035551","name":"exports.isaw2","type":"VariableDeclaration"}},"description":"<p>A sawtooth signal between 1 and -1 (like <code>saw2</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"isaw2","longname":"isaw2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sine signal between -1 and 1 (like \`sine\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2234,2296],"filename":"signal.mjs","lineno":70,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035559","name":"exports.sine2","type":"VariableDeclaration"}},"description":"<p>A sine signal between -1 and 1 (like <code>sine</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"sine2","longname":"sine2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A sine signal between 0 and 1.\\n * @return {Pattern}\\n * @example\\n * n(sine.segment(16).range(0,15))\\n * .scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2433,2473],"filename":"signal.mjs","lineno":80,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035578","name":"exports.sine","type":"VariableDeclaration"}},"description":"<p>A sine signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(sine.segment(16).range(0,15))\\n.scale(\\"C:minor\\")"],"name":"sine","longname":"sine","kind":"constant","scope":"global"},{"comment":"/**\\n *  A cosine signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * n(stack(sine,cosine).segment(16).range(0,15))\\n * .scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2629,2683],"filename":"signal.mjs","lineno":91,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035586","name":"exports.cosine","type":"VariableDeclaration"}},"description":"<p>A cosine signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(stack(sine,cosine).segment(16).range(0,15))\\n.scale(\\"C:minor\\")"],"name":"cosine","longname":"cosine","kind":"constant","scope":"global"},{"comment":"/**\\n *  A cosine signal between -1 and 1 (like \`cosine\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[2784,2840],"filename":"signal.mjs","lineno":98,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035601","name":"exports.cosine2","type":"VariableDeclaration"}},"description":"<p>A cosine signal between -1 and 1 (like <code>cosine</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"cosine2","longname":"cosine2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A square signal between 0 and 1.\\n * @return {Pattern}\\n * @example\\n * n(square.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[2975,3036],"filename":"signal.mjs","lineno":107,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035616","name":"exports.square","type":"VariableDeclaration"}},"description":"<p>A square signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(square.segment(4).range(0,7)).scale(\\"C:minor\\")"],"name":"square","longname":"square","kind":"constant","scope":"global"},{"comment":"/**\\n *  A square signal between -1 and 1 (like \`square\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3137,3179],"filename":"signal.mjs","lineno":114,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035633","name":"exports.square2","type":"VariableDeclaration"}},"description":"<p>A square signal between -1 and 1 (like <code>square</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"square2","longname":"square2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A triangle signal between 0 and 1.\\n *\\n * @return {Pattern}\\n * @example\\n * n(tri.segment(8).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[3316,3354],"filename":"signal.mjs","lineno":124,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035641","name":"exports.tri","type":"VariableDeclaration"}},"description":"<p>A triangle signal between 0 and 1.</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(tri.segment(8).range(0,7)).scale(\\"C:minor\\")"],"name":"tri","longname":"tri","kind":"constant","scope":"global"},{"comment":"/**\\n *  A triangle signal between -1 and 1 (like \`tri\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3454,3495],"filename":"signal.mjs","lineno":131,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035649","name":"exports.tri2","type":"VariableDeclaration"}},"description":"<p>A triangle signal between -1 and 1 (like <code>tri</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"tri2","longname":"tri2","kind":"constant","scope":"global"},{"comment":"/**\\n *  An inverted triangle signal between 1 and 0 (like \`tri\`, but flipped).\\n *\\n * @return {Pattern}\\n * @example\\n * n(itri.segment(8).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"range":[3669,3708],"filename":"signal.mjs","lineno":141,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035657","name":"exports.itri","type":"VariableDeclaration"}},"description":"<p>An inverted triangle signal between 1 and 0 (like <code>tri</code>, but flipped).</p>","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(itri.segment(8).range(0,7)).scale(\\"C:minor\\")"],"name":"itri","longname":"itri","kind":"constant","scope":"global"},{"comment":"/**\\n *  An inverted triangle signal between -1 and 1 (like \`itri\`, but bipolar).\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3819,3861],"filename":"signal.mjs","lineno":148,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035665","name":"exports.itri2","type":"VariableDeclaration"}},"description":"<p>An inverted triangle signal between -1 and 1 (like <code>itri</code>, but bipolar).</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"itri2","longname":"itri2","kind":"constant","scope":"global"},{"comment":"/**\\n *  A signal representing the cycle time.\\n *\\n * @return {Pattern}\\n */","meta":{"range":[3937,3968],"filename":"signal.mjs","lineno":155,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035673","name":"exports.time","type":"VariableDeclaration"}},"description":"<p>A signal representing the cycle time.</p>","returns":[{"type":{"names":["Pattern"]}}],"name":"time","longname":"time","kind":"constant","scope":"global"},{"comment":"/**\\n *  The mouse's x position value ranges from 0 to 1.\\n * @name mousex\\n * @return {Pattern}\\n * @example\\n * n(mousex.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":157,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>The mouse's x position value ranges from 0 to 1.</p>","name":"mousex","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(mousex.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"mousex","kind":"member","scope":"global"},{"comment":"/**\\n *  The mouse's y position value ranges from 0 to 1.\\n * @name mousey\\n * @return {Pattern}\\n * @example\\n * n(mousey.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":166,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>The mouse's y position value ranges from 0 to 1.</p>","name":"mousey","returns":[{"type":{"names":["Pattern"]}}],"examples":["n(mousey.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"mousey","kind":"member","scope":"global"},{"comment":"/**\\n * A discrete pattern of numbers from 0 to n-1\\n * @example\\n * n(run(4)).scale(\\"C4:pentatonic\\")\\n * // n(\\"0 1 2 3\\").scale(\\"C4:pentatonic\\")\\n */","meta":{"range":[5663,5724],"filename":"signal.mjs","lineno":228,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100035890","name":"exports.run","type":"VariableDeclaration"}},"description":"<p>A discrete pattern of numbers from 0 to n-1</p>","examples":["n(run(4)).scale(\\"C4:pentatonic\\")\\n// n(\\"0 1 2 3\\").scale(\\"C4:pentatonic\\")"],"name":"run","longname":"run","kind":"constant","scope":"global"},{"comment":"/**\\n * Creates a pattern from a binary number.\\n *\\n * @name binary\\n * @param {number} n - input number to convert to binary\\n * @example\\n * \\"hh\\".s().struct(binary(5))\\n * // \\"hh\\".s().struct(\\"1 0 1\\")\\n */","meta":{"filename":"signal.mjs","lineno":230,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Creates a pattern from a binary number.</p>","name":"binary","params":[{"type":{"names":["number"]},"description":"<p>input number to convert to binary</p>","name":"n"}],"examples":["\\"hh\\".s().struct(binary(5))\\n// \\"hh\\".s().struct(\\"1 0 1\\")"],"longname":"binary","kind":"member","scope":"global"},{"comment":"/**\\n * Creates a pattern from a binary number, padded to n bits long.\\n *\\n * @name binaryN\\n * @param {number} n - input number to convert to binary\\n * @param {number} nBits - pattern length, defaults to 16\\n * @example\\n * \\"hh\\".s().struct(binaryN(55532, 16))\\n * // \\"hh\\".s().struct(\\"1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 0\\")\\n */","meta":{"filename":"signal.mjs","lineno":244,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Creates a pattern from a binary number, padded to n bits long.</p>","name":"binaryN","params":[{"type":{"names":["number"]},"description":"<p>input number to convert to binary</p>","name":"n"},{"type":{"names":["number"]},"description":"<p>pattern length, defaults to 16</p>","name":"nBits"}],"examples":["\\"hh\\".s().struct(binaryN(55532, 16))\\n// \\"hh\\".s().struct(\\"1 1 0 1 1 0 0 0 1 1 1 0 1 1 0 0\\")"],"longname":"binaryN","kind":"member","scope":"global"},{"comment":"/**\\n * Slices a pattern into the given number of parts, then plays those parts in random order.\\n * Each part will be played exactly once per cycle.\\n * @name shuffle\\n * @example\\n * note(\\"c d e f\\").sound(\\"piano\\").shuffle(4)\\n * @example\\n * seq(\\"c d e f\\".shuffle(4), \\"g\\").note().sound(\\"piano\\")\\n */","meta":{"filename":"signal.mjs","lineno":279,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Slices a pattern into the given number of parts, then plays those parts in random order.\\nEach part will be played exactly once per cycle.</p>","name":"shuffle","examples":["note(\\"c d e f\\").sound(\\"piano\\").shuffle(4)","seq(\\"c d e f\\".shuffle(4), \\"g\\").note().sound(\\"piano\\")"],"longname":"shuffle","kind":"member","scope":"global"},{"comment":"/**\\n * Slices a pattern into the given number of parts, then plays those parts at random. Similar to \`shuffle\`,\\n * but parts might be played more than once, or not at all, per cycle.\\n * @name scramble\\n * @example\\n * note(\\"c d e f\\").sound(\\"piano\\").scramble(4)\\n * @example\\n * seq(\\"c d e f\\".scramble(4), \\"g\\").note().sound(\\"piano\\")\\n */","meta":{"filename":"signal.mjs","lineno":292,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Slices a pattern into the given number of parts, then plays those parts at random. Similar to <code>shuffle</code>,\\nbut parts might be played more than once, or not at all, per cycle.</p>","name":"scramble","examples":["note(\\"c d e f\\").sound(\\"piano\\").scramble(4)","seq(\\"c d e f\\".scramble(4), \\"g\\").note().sound(\\"piano\\")"],"longname":"scramble","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random numbers, between 0 and 1.\\n *\\n * @name rand\\n * @example\\n * // randomly change the cutoff\\n * s(\\"bd*4,hh*8\\").cutoff(rand.range(500,8000))\\n *\\n */","meta":{"filename":"signal.mjs","lineno":305,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of random numbers, between 0 and 1.</p>","name":"rand","examples":["// randomly change the cutoff\\ns(\\"bd*4,hh*8\\").cutoff(rand.range(500,8000))"],"longname":"rand","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random numbers, between -1 and 1\\n */","meta":{"range":[8355,8393],"filename":"signal.mjs","lineno":318,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036198","name":"exports.rand2","type":"VariableDeclaration"}},"description":"<p>A continuous pattern of random numbers, between -1 and 1</p>","name":"rand2","longname":"rand2","kind":"constant","scope":"global"},{"comment":"/**\\n * A continuous pattern of 0 or 1 (binary random), with a probability for the value being 1\\n *\\n * @name brandBy\\n * @param {number} probability - a number between 0 and 1\\n * @example\\n * s(\\"hh*10\\").pan(brandBy(0.2))\\n */","meta":{"filename":"signal.mjs","lineno":322,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of 0 or 1 (binary random), with a probability for the value being 1</p>","name":"brandBy","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"probability"}],"examples":["s(\\"hh*10\\").pan(brandBy(0.2))"],"longname":"brandBy","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of 0 or 1 (binary random)\\n *\\n * @name brand\\n * @example\\n * s(\\"hh*10\\").pan(brand)\\n */","meta":{"filename":"signal.mjs","lineno":332,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of 0 or 1 (binary random)</p>","name":"brand","examples":["s(\\"hh*10\\").pan(brand)"],"longname":"brand","kind":"member","scope":"global"},{"comment":"/**\\n * A continuous pattern of random integers, between 0 and n-1.\\n *\\n * @name irand\\n * @param {number} n max value (exclusive)\\n * @example\\n * // randomly select scale notes from 0 - 7 (= C to C)\\n * n(irand(8)).struct(\\"x x*2 x x*3\\").scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":343,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>A continuous pattern of random integers, between 0 and n-1.</p>","name":"irand","params":[{"type":{"names":["number"]},"description":"<p>max value (exclusive)</p>","name":"n"}],"examples":["// randomly select scale notes from 0 - 7 (= C to C)\\nn(irand(8)).struct(\\"x x*2 x x*3\\").scale(\\"C:minor\\")"],"longname":"irand","kind":"member","scope":"global"},{"comment":"/**\\n * Choose from the list of values (or patterns of values) using the given\\n * pattern of numbers, which should be in the range of 0..1\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(chooseWith(sine.fast(2), [\\"sawtooth\\", \\"triangle\\", \\"bd:6\\"]))\\n */","meta":{"range":[9855,9942],"filename":"signal.mjs","lineno":375,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036345","name":"exports.chooseWith","type":"VariableDeclaration"}},"description":"<p>Choose from the list of values (or patterns of values) using the given\\npattern of numbers, which should be in the range of 0..1</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(chooseWith(sine.fast(2), [\\"sawtooth\\", \\"triangle\\", \\"bd:6\\"]))"],"name":"chooseWith","longname":"chooseWith","kind":"constant","scope":"global"},{"comment":"/**\\n * As with {chooseWith}, but the structure comes from the chosen values, rather\\n * than the pattern you're using to choose with.\\n * @param {Pattern} pat\\n * @param {*} xs\\n * @returns {Pattern}\\n */","meta":{"range":[10144,10233],"filename":"signal.mjs","lineno":386,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036361","name":"exports.chooseInWith","type":"VariableDeclaration"}},"description":"<p>As with {chooseWith}, but the structure comes from the chosen values, rather\\nthan the pattern you're using to choose with.</p>","params":[{"type":{"names":["Pattern"]},"name":"pat"},{"type":{"names":["*"]},"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"chooseInWith","longname":"chooseInWith","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses randomly from the given list of elements.\\n * @param  {...any} xs values / patterns to choose from.\\n * @returns {Pattern} - a continuous pattern.\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(choose(\\"sine\\", \\"triangle\\", \\"bd:6\\"))\\n */","meta":{"range":[10474,10528],"filename":"signal.mjs","lineno":397,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036377","name":"exports.choose","type":"VariableDeclaration"}},"description":"<p>Chooses randomly from the given list of elements.</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>values / patterns to choose from.</p>","name":"xs"}],"returns":[{"type":{"names":["Pattern"]},"description":"<ul>\\n<li>a continuous pattern.</li>\\n</ul>"}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(choose(\\"sine\\", \\"triangle\\", \\"bd:6\\"))"],"name":"choose","longname":"choose","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses from the given list of values (or patterns of values), according\\n * to the pattern that the method is called on. The pattern should be in\\n * the range 0 .. 1.\\n * @param  {...any} xs\\n * @returns {Pattern}\\n */","meta":{"range":[10859,10937],"filename":"signal.mjs","lineno":410,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036405","name":"Pattern.prototype.choose","type":"FunctionExpression","paramnames":["xs"]}},"description":"<p>Chooses from the given list of values (or patterns of values), according\\nto the pattern that the method is called on. The pattern should be in\\nthe range 0 .. 1.</p>","params":[{"type":{"names":["any"]},"variable":true,"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"choose","longname":"Pattern#choose","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * As with choose, but the pattern that this method is called on should be\\n * in the range -1 .. 1\\n * @param  {...any} xs\\n * @returns {Pattern}\\n */","meta":{"range":[11092,11185],"filename":"signal.mjs","lineno":420,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036421","name":"Pattern.prototype.choose2","type":"FunctionExpression","paramnames":["xs"]}},"description":"<p>As with choose, but the pattern that this method is called on should be\\nin the range -1 .. 1</p>","params":[{"type":{"names":["any"]},"variable":true,"name":"xs"}],"returns":[{"type":{"names":["Pattern"]}}],"name":"choose2","longname":"Pattern#choose2","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * Picks one of the elements at random each cycle.\\n * @synonyms randcat\\n * @returns {Pattern}\\n * @example\\n * chooseCycles(\\"bd\\", \\"hh\\", \\"sd\\").s().fast(8)\\n * @example\\n * s(\\"bd | hh | sd\\").fast(8)\\n */","meta":{"range":[11389,11462],"filename":"signal.mjs","lineno":433,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036439","name":"exports.chooseCycles","type":"VariableDeclaration"}},"description":"<p>Picks one of the elements at random each cycle.</p>","synonyms_text":"randcat","synonyms":["randcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["chooseCycles(\\"bd\\", \\"hh\\", \\"sd\\").s().fast(8)","s(\\"bd | hh | sd\\").fast(8)"],"name":"chooseCycles","longname":"chooseCycles","kind":"constant","scope":"global"},{"comment":"/**\\n * Chooses randomly from the given list of elements by giving a probability to each element\\n * @param {...any} pairs arrays of value and weight\\n * @returns {Pattern} - a continuous pattern.\\n * @example\\n * note(\\"c2 g2!2 d2 f1\\").s(wchoose([\\"sine\\",10], [\\"triangle\\",1], [\\"bd:6\\",1]))\\n */","meta":{"range":[12754,12819],"filename":"signal.mjs","lineno":473,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036577","name":"exports.wchoose","type":"VariableDeclaration"}},"description":"<p>Chooses randomly from the given list of elements by giving a probability to each element</p>","params":[{"type":{"names":["any"]},"variable":true,"description":"<p>arrays of value and weight</p>","name":"pairs"}],"returns":[{"type":{"names":["Pattern"]},"description":"<ul>\\n<li>a continuous pattern.</li>\\n</ul>"}],"examples":["note(\\"c2 g2!2 d2 f1\\").s(wchoose([\\"sine\\",10], [\\"triangle\\",1], [\\"bd:6\\",1]))"],"name":"wchoose","longname":"wchoose","kind":"constant","scope":"global"},{"comment":"/**\\n * Picks one of the elements at random each cycle by giving a probability to each element\\n * @synonyms wrandcat\\n * @returns {Pattern}\\n * @example\\n * wchooseCycles([\\"bd\\",10], [\\"hh\\",1], [\\"sd\\",1]).s().fast(8)\\n * @example\\n * wchooseCycles([\\"bd bd bd\\",5], [\\"hh hh hh\\",3], [\\"sd sd sd\\",1]).fast(4).s()\\n * @example\\n * // The probability can itself be a pattern\\n * wchooseCycles([\\"bd(3,8)\\",\\"<5 0>\\"], [\\"hh hh hh\\",3]).fast(4).s()\\n */","meta":{"range":[13248,13343],"filename":"signal.mjs","lineno":487,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100036589","name":"exports.wchooseCycles","type":"VariableDeclaration"}},"description":"<p>Picks one of the elements at random each cycle by giving a probability to each element</p>","synonyms_text":"wrandcat","synonyms":["wrandcat"],"returns":[{"type":{"names":["Pattern"]}}],"examples":["wchooseCycles([\\"bd\\",10], [\\"hh\\",1], [\\"sd\\",1]).s().fast(8)","wchooseCycles([\\"bd bd bd\\",5], [\\"hh hh hh\\",3], [\\"sd sd sd\\",1]).fast(4).s()","// The probability can itself be a pattern\\nwchooseCycles([\\"bd(3,8)\\",\\"<5 0>\\"], [\\"hh hh hh\\",3]).fast(4).s()"],"name":"wchooseCycles","longname":"wchooseCycles","kind":"constant","scope":"global"},{"comment":"/**\\n * Generates a continuous pattern of [perlin noise](https://en.wikipedia.org/wiki/Perlin_noise), in the range 0..1.\\n *\\n * @name perlin\\n * @example\\n * // randomly change the cutoff\\n * s(\\"bd*4,hh*8\\").cutoff(perlin.range(500,8000))\\n *\\n */","meta":{"filename":"signal.mjs","lineno":521,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Generates a continuous pattern of <a href=\\"https://en.wikipedia.org/wiki/Perlin_noise\\">perlin noise</a>, in the range 0..1.</p>","name":"perlin","examples":["// randomly change the cutoff\\ns(\\"bd*4,hh*8\\").cutoff(perlin.range(500,8000))"],"longname":"perlin","kind":"member","scope":"global"},{"comment":"/**\\n * Generates a continuous pattern of [berlin noise](conceived by Jame Coyne and Jade Rowland as a joke but turned out to be surprisingly cool and useful,\\n * like perlin noise but with sawtooth waves), in the range 0..1.\\n *\\n * @name berlin\\n * @example\\n * // ascending arpeggios\\n * n(\\"0!16\\".add(berlin.fast(4).mul(14))).scale(\\"d:minor\\")\\n *\\n */","meta":{"filename":"signal.mjs","lineno":532,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Generates a continuous pattern of [berlin noise](conceived by Jame Coyne and Jade Rowland as a joke but turned out to be surprisingly cool and useful,\\nlike perlin noise but with sawtooth waves), in the range 0..1.</p>","name":"berlin","examples":["// ascending arpeggios\\nn(\\"0!16\\".add(berlin.fast(4).mul(14))).scale(\\"d:minor\\")"],"longname":"berlin","kind":"member","scope":"global"},{"comment":"/**\\n * Randomly removes events from the pattern by a given amount.\\n * 0 = 0% chance of removal\\n * 1 = 100% chance of removal\\n *\\n * @name degradeBy\\n * @memberof Pattern\\n * @param {number} amount - a number between 0 and 1\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").degradeBy(0.2)\\n * @example\\n * s(\\"[hh?0.2]*8\\")\\n * @example\\n * //beat generator\\n * s(\\"bd\\").segment(16).degradeBy(.5).ribbon(16,1)\\n */","meta":{"filename":"signal.mjs","lineno":551,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Randomly removes events from the pattern by a given amount.\\n0 = 0% chance of removal\\n1 = 100% chance of removal</p>","name":"degradeBy","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").degradeBy(0.2)","s(\\"[hh?0.2]*8\\")","//beat generator\\ns(\\"bd\\").segment(16).degradeBy(.5).ribbon(16,1)"],"scope":"static","longname":"Pattern.degradeBy","kind":"member"},{"comment":"/**\\n *\\n * Randomly removes 50% of events from the pattern. Shorthand for \`.degradeBy(0.5)\`\\n *\\n * @name degrade\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").degrade()\\n * @example\\n * s(\\"[hh?]*8\\")\\n */","meta":{"filename":"signal.mjs","lineno":577,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Randomly removes 50% of events from the pattern. Shorthand for <code>.degradeBy(0.5)</code></p>","name":"degrade","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").degrade()","s(\\"[hh?]*8\\")"],"scope":"static","longname":"Pattern.degrade","kind":"member"},{"comment":"/**\\n * Inverse of \`degradeBy\`: Randomly removes events from the pattern by a given amount.\\n * 0 = 100% chance of removal\\n * 1 = 0% chance of removal\\n * Events that would be removed by degradeBy are let through by undegradeBy and vice versa (see second example).\\n *\\n * @name undegradeBy\\n * @memberof Pattern\\n * @param {number} amount - a number between 0 and 1\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").undegradeBy(0.2)\\n * @example\\n * s(\\"hh*10\\").layer(\\n *   x => x.degradeBy(0.2).pan(0),\\n *   x => x.undegradeBy(0.8).pan(1)\\n * )\\n */","meta":{"filename":"signal.mjs","lineno":591,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Inverse of <code>degradeBy</code>: Randomly removes events from the pattern by a given amount.\\n0 = 100% chance of removal\\n1 = 0% chance of removal\\nEvents that would be removed by degradeBy are let through by undegradeBy and vice versa (see second example).</p>","name":"undegradeBy","memberof":"Pattern","params":[{"type":{"names":["number"]},"description":"<p>a number between 0 and 1</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").undegradeBy(0.2)","s(\\"hh*10\\").layer(\\n  x => x.degradeBy(0.2).pan(0),\\n  x => x.undegradeBy(0.8).pan(1)\\n)"],"scope":"static","longname":"Pattern.undegradeBy","kind":"member"},{"comment":"/**\\n * Inverse of \`degrade\`: Randomly removes 50% of events from the pattern. Shorthand for \`.undegradeBy(0.5)\`\\n * Events that would be removed by degrade are let through by undegrade and vice versa (see second example).\\n *\\n * @name undegrade\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").undegrade()\\n * @example\\n * s(\\"hh*10\\").layer(\\n *   x => x.degrade().pan(0),\\n *   x => x.undegrade().pan(1)\\n * )\\n */","meta":{"filename":"signal.mjs","lineno":621,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Inverse of <code>degrade</code>: Randomly removes 50% of events from the pattern. Shorthand for <code>.undegradeBy(0.5)</code>\\nEvents that would be removed by degrade are let through by undegrade and vice versa (see second example).</p>","name":"undegrade","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").undegrade()","s(\\"hh*10\\").layer(\\n  x => x.degrade().pan(0),\\n  x => x.undegrade().pan(1)\\n)"],"scope":"static","longname":"Pattern.undegrade","kind":"member"},{"comment":"/**\\n *\\n * Randomly applies the given function by the given probability.\\n * Similar to \`someCyclesBy\`\\n *\\n * @name sometimesBy\\n * @memberof Pattern\\n * @param {number | Pattern} probability - a number between 0 and 1\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").sometimesBy(.4, x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":638,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Randomly applies the given function by the given probability.\\nSimilar to <code>someCyclesBy</code></p>","name":"sometimesBy","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>a number between 0 and 1</p>","name":"probability"},{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").sometimesBy(.4, x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.sometimesBy","kind":"member"},{"comment":"/**\\n *\\n * Applies the given function with a 50% chance\\n *\\n * @name sometimes\\n * @memberof Pattern\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").sometimes(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":658,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Applies the given function with a 50% chance</p>","name":"sometimes","memberof":"Pattern","params":[{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").sometimes(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.sometimes","kind":"member"},{"comment":"/**\\n *\\n * Randomly applies the given function by the given probability on a cycle by cycle basis.\\n * Similar to \`sometimesBy\`\\n *\\n * @name someCyclesBy\\n * @memberof Pattern\\n * @param {number | Pattern} probability - a number between 0 and 1\\n * @param {function} function - the transformation to apply\\n * @returns Pattern\\n * @example\\n * s(\\"bd,hh*8\\").someCyclesBy(.3, x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":673,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Randomly applies the given function by the given probability on a cycle by cycle basis.\\nSimilar to <code>sometimesBy</code></p>","name":"someCyclesBy","memberof":"Pattern","params":[{"type":{"names":["number","Pattern"]},"description":"<p>a number between 0 and 1</p>","name":"probability"},{"type":{"names":["function"]},"description":"<p>the transformation to apply</p>","name":"function"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd,hh*8\\").someCyclesBy(.3, x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.someCyclesBy","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.someCyclesBy(0.5, fn)\`\\n *\\n * @name someCycles\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"bd,hh*8\\").someCycles(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":698,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.someCyclesBy(0.5, fn)</code></p>","name":"someCycles","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd,hh*8\\").someCycles(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.someCycles","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.75, fn)\`\\n *\\n * @name often\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").often(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":712,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.75, fn)</code></p>","name":"often","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").often(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.often","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.25, fn)\`\\n *\\n * @name rarely\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").rarely(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":726,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.25, fn)</code></p>","name":"rarely","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").rarely(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.rarely","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.1, fn)\`\\n *\\n * @name almostNever\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").almostNever(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":740,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.1, fn)</code></p>","name":"almostNever","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").almostNever(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.almostNever","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0.9, fn)\`\\n *\\n * @name almostAlways\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").almostAlways(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":754,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0.9, fn)</code></p>","name":"almostAlways","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").almostAlways(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.almostAlways","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(0, fn)\` (never calls fn)\\n *\\n * @name never\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").never(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":768,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(0, fn)</code> (never calls fn)</p>","name":"never","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").never(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.never","kind":"member"},{"comment":"/**\\n *\\n * Shorthand for \`.sometimesBy(1, fn)\` (always calls fn)\\n *\\n * @name always\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"hh*8\\").always(x=>x.speed(\\"0.5\\"))\\n */","meta":{"filename":"signal.mjs","lineno":782,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Shorthand for <code>.sometimesBy(1, fn)</code> (always calls fn)</p>","name":"always","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"hh*8\\").always(x=>x.speed(\\"0.5\\"))"],"scope":"static","longname":"Pattern.always","kind":"member"},{"comment":"/**\\n *\\n * Do something on a keypress, or array of keypresses\\n * [Key name reference](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values)\\n *\\n * @name whenKey\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * s(\\"bd(5,8)\\").whenKey(\\"Control:j\\", x => x.segment(16).color(\\"red\\")).whenKey(\\"Control:i\\", x => x.fast(2).color(\\"blue\\"))\\n */","meta":{"filename":"signal.mjs","lineno":809,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>Do something on a keypress, or array of keypresses\\n<a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\\">Key name reference</a></p>","name":"whenKey","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["s(\\"bd(5,8)\\").whenKey(\\"Control:j\\", x => x.segment(16).color(\\"red\\")).whenKey(\\"Control:i\\", x => x.fast(2).color(\\"blue\\"))"],"scope":"static","longname":"Pattern.whenKey","kind":"member"},{"comment":"/**\\n *\\n * returns true when a key or array of keys is held\\n * [Key name reference](https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values)\\n *\\n * @name keyDown\\n * @memberof Pattern\\n * @returns Pattern\\n * @example\\n * keyDown(\\"Control:j\\").pick([s(\\"bd(5,8)\\"), s(\\"cp(3,8)\\")])\\n */","meta":{"filename":"signal.mjs","lineno":825,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{}},"description":"<p>returns true when a key or array of keys is held\\n<a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\\">Key name reference</a></p>","name":"keyDown","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"examples":["keyDown(\\"Control:j\\").pick([s(\\"bd(5,8)\\"), s(\\"cp(3,8)\\")])"],"scope":"static","longname":"Pattern.keyDown","kind":"member"},{"comment":"/**\\n * @deprecated does not appear to be referenced or invoked anywhere in the codebase\\n * @noAutocomplete\\n */","meta":{"range":[2812,2979],"filename":"util.mjs","lineno":73,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100050400","name":"exports.getFreq","type":"VariableDeclaration"}},"deprecated":"does not appear to be referenced or invoked anywhere in the codebase","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"getFreq","longname":"getFreq","kind":"constant","scope":"global"},{"comment":"/**\\n * @deprecated only used in workshop (first-notes)\\n * @noAutocomplete\\n */","meta":{"range":[3138,3257],"filename":"util.mjs","lineno":85,"columnno":0,"path":"/Users/felix/projects/strudel/packages/core","code":{"id":"astnode100050439","name":"exports.midi2note","type":"VariableDeclaration"}},"deprecated":"only used in workshop (first-notes)","tags":[{"originalTitle":"noAutocomplete","title":"noautocomplete","text":""}],"name":"midi2note","longname":"midi2note","kind":"constant","scope":"global"},{"comment":"/**\\n * Sends notes to Csound for rendering with MIDI semantics. The hap value is\\n * translated to these Csound pfields:\\n *\\n *  p1 -- Csound instrument either as a number (1-based, can be a fraction),\\n *        or as a string name.\\n *  p2 -- time in beats (usually seconds) from start of performance.\\n *  p3 -- duration in beats (usually seconds).\\n *  p4 -- MIDI key number (as a real number, not an integer but in [0, 127].\\n *  p5 -- MIDI velocity (as a real number, not an integer but in [0, 127].\\n *  p6 -- Strudel controls, as a string.\\n */","meta":{"range":[4679,6063],"filename":"index.mjs","lineno":139,"columnno":0,"path":"/Users/felix/projects/strudel/packages/csound","code":{"id":"astnode100053043","name":"exports.csoundm","type":"VariableDeclaration"}},"description":"<p>Sends notes to Csound for rendering with MIDI semantics. The hap value is\\ntranslated to these Csound pfields:</p>\\n<p>p1 -- Csound instrument either as a number (1-based, can be a fraction),\\nor as a string name.\\np2 -- time in beats (usually seconds) from start of performance.\\np3 -- duration in beats (usually seconds).\\np4 -- MIDI key number (as a real number, not an integer but in [0, 127].\\np5 -- MIDI velocity (as a real number, not an integer but in [0, 127].\\np6 -- Strudel controls, as a string.</p>","name":"csoundm","longname":"csoundm","kind":"constant","scope":"global"},{"comment":"/**\\n * Visualises a pattern as a scrolling 'pianoroll', displayed in the background of the editor. To show a pianoroll for all running patterns, use \`all(pianoroll)\`. To have a pianoroll appear below\\n * a pattern instead, prefix with \`_\`, e.g.: \`sound(\\"bd sd\\")._pianoroll()\`.\\n *\\n * @name pianoroll\\n * @synonyms punchcard\\n * @param {Object} options Object containing all the optional following parameters as key value pairs:\\n * @param {integer} cycles number of cycles to be displayed at the same time - defaults to 4\\n * @param {number} playhead location of the active notes on the time axis - 0 to 1, defaults to 0.5\\n * @param {boolean} vertical displays the roll vertically - 0 by default\\n * @param {boolean} labels displays labels on individual notes (see the label function) - 0 by default\\n * @param {boolean} flipTime reverse the direction of the roll - 0 by default\\n * @param {boolean} flipValues reverse the relative location of notes on the value axis - 0 by default\\n * @param {number} overscan lookup X cycles outside of the cycles window to display notes in advance - 1 by default\\n * @param {boolean} hideNegative hide notes with negative time (before starting playing the pattern) - 0 by default\\n * @param {boolean} smear notes leave a solid trace - 0 by default\\n * @param {boolean} fold notes takes the full value axis width - 0 by default\\n * @param {string} active hexadecimal or CSS color of the active notes - defaults to #FFCA28\\n * @param {string} inactive hexadecimal or CSS color of the inactive notes - defaults to #7491D2\\n * @param {string} background hexadecimal or CSS color of the background - defaults to transparent\\n * @param {string} playheadColor hexadecimal or CSS color of the line representing the play head - defaults to white\\n * @param {boolean} fill notes are filled with color (otherwise only the label is displayed) - 0 by default\\n * @param {boolean} fillActive active notes are filled with color - 0 by default\\n * @param {boolean} stroke notes are shown with colored borders - 0 by default\\n * @param {boolean} strokeActive active notes are shown with colored borders - 0 by default\\n * @param {boolean} hideInactive only active notes are shown - 0 by default\\n * @param {boolean} colorizeInactive use note color for inactive notes - 1 by default\\n * @param {string} fontFamily define the font used by notes labels - defaults to 'monospace'\\n * @param {integer} minMidi minimum note value to display on the value axis - defaults to 10\\n * @param {integer} maxMidi maximum note value to display on the value axis - defaults to 90\\n * @param {boolean} autorange automatically calculate the minMidi and maxMidi parameters - 0 by default\\n * @see _pianoroll\\n * @example\\n * note(\\"c2 a2 eb2\\")\\n * .euclid(5,8)\\n * .s('sawtooth')\\n * .lpenv(4).lpf(300)\\n * .pianoroll({ labels: 1 })\\n */","meta":{"filename":"pianoroll.mjs","lineno":39,"columnno":0,"path":"/Users/felix/projects/strudel/packages/draw","code":{}},"description":"<p>Visualises a pattern as a scrolling 'pianoroll', displayed in the background of the editor. To show a pianoroll for all running patterns, use <code>all(pianoroll)</code>. To have a pianoroll appear below\\na pattern instead, prefix with <code>_</code>, e.g.: <code>sound(&quot;bd sd&quot;)._pianoroll()</code>.</p>","name":"pianoroll","synonyms_text":"punchcard","synonyms":["punchcard"],"params":[{"type":{"names":["Object"]},"description":"<p>Object containing all the optional following parameters as key value pairs:</p>","name":"options"},{"type":{"names":["integer"]},"description":"<p>number of cycles to be displayed at the same time - defaults to 4</p>","name":"cycles"},{"type":{"names":["number"]},"description":"<p>location of the active notes on the time axis - 0 to 1, defaults to 0.5</p>","name":"playhead"},{"type":{"names":["boolean"]},"description":"<p>displays the roll vertically - 0 by default</p>","name":"vertical"},{"type":{"names":["boolean"]},"description":"<p>displays labels on individual notes (see the label function) - 0 by default</p>","name":"labels"},{"type":{"names":["boolean"]},"description":"<p>reverse the direction of the roll - 0 by default</p>","name":"flipTime"},{"type":{"names":["boolean"]},"description":"<p>reverse the relative location of notes on the value axis - 0 by default</p>","name":"flipValues"},{"type":{"names":["number"]},"description":"<p>lookup X cycles outside of the cycles window to display notes in advance - 1 by default</p>","name":"overscan"},{"type":{"names":["boolean"]},"description":"<p>hide notes with negative time (before starting playing the pattern) - 0 by default</p>","name":"hideNegative"},{"type":{"names":["boolean"]},"description":"<p>notes leave a solid trace - 0 by default</p>","name":"smear"},{"type":{"names":["boolean"]},"description":"<p>notes takes the full value axis width - 0 by default</p>","name":"fold"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the active notes - defaults to #FFCA28</p>","name":"active"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the inactive notes - defaults to #7491D2</p>","name":"inactive"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the background - defaults to transparent</p>","name":"background"},{"type":{"names":["string"]},"description":"<p>hexadecimal or CSS color of the line representing the play head - defaults to white</p>","name":"playheadColor"},{"type":{"names":["boolean"]},"description":"<p>notes are filled with color (otherwise only the label is displayed) - 0 by default</p>","name":"fill"},{"type":{"names":["boolean"]},"description":"<p>active notes are filled with color - 0 by default</p>","name":"fillActive"},{"type":{"names":["boolean"]},"description":"<p>notes are shown with colored borders - 0 by default</p>","name":"stroke"},{"type":{"names":["boolean"]},"description":"<p>active notes are shown with colored borders - 0 by default</p>","name":"strokeActive"},{"type":{"names":["boolean"]},"description":"<p>only active notes are shown - 0 by default</p>","name":"hideInactive"},{"type":{"names":["boolean"]},"description":"<p>use note color for inactive notes - 1 by default</p>","name":"colorizeInactive"},{"type":{"names":["string"]},"description":"<p>define the font used by notes labels - defaults to 'monospace'</p>","name":"fontFamily"},{"type":{"names":["integer"]},"description":"<p>minimum note value to display on the value axis - defaults to 10</p>","name":"minMidi"},{"type":{"names":["integer"]},"description":"<p>maximum note value to display on the value axis - defaults to 90</p>","name":"maxMidi"},{"type":{"names":["boolean"]},"description":"<p>automatically calculate the minMidi and maxMidi parameters - 0 by default</p>","name":"autorange"}],"see":["_pianoroll"],"examples":["note(\\"c2 a2 eb2\\")\\n.euclid(5,8)\\n.s('sawtooth')\\n.lpenv(4).lpf(300)\\n.pianoroll({ labels: 1 })"],"longname":"pianoroll","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a vertical pianoroll with event labels.\\n * Supports all the same options as pianoroll.\\n *\\n * @name wordfall\\n */","meta":{"filename":"pianoroll.mjs","lineno":297,"columnno":0,"path":"/Users/felix/projects/strudel/packages/draw","code":{}},"description":"<p>Displays a vertical pianoroll with event labels.\\nSupports all the same options as pianoroll.</p>","name":"wordfall","longname":"wordfall","kind":"member","scope":"global"},{"comment":"/**\\n * Renders a pitch circle to visualize frequencies within one octave\\n * @name pitchwheel\\n * @param {number} hapcircles\\n * @param {number} circle\\n * @param {number} edo\\n * @param {string} root\\n * @param {number} thickness\\n * @param {number} hapRadius\\n * @param {string} mode\\n * @param {number} margin\\n * @example\\n * n(\\"0 .. 12\\").scale(\\"C:chromatic\\")\\n * .s(\\"sawtooth\\")\\n * .lpf(500)\\n * ._pitchwheel()\\n */","meta":{"filename":"pitchwheel.mjs","lineno":116,"columnno":0,"path":"/Users/felix/projects/strudel/packages/draw","code":{}},"description":"<p>Renders a pitch circle to visualize frequencies within one octave</p>","name":"pitchwheel","params":[{"type":{"names":["number"]},"name":"hapcircles"},{"type":{"names":["number"]},"name":"circle"},{"type":{"names":["number"]},"name":"edo"},{"type":{"names":["string"]},"name":"root"},{"type":{"names":["number"]},"name":"thickness"},{"type":{"names":["number"]},"name":"hapRadius"},{"type":{"names":["string"]},"name":"mode"},{"type":{"names":["number"]},"name":"margin"}],"examples":["n(\\"0 .. 12\\").scale(\\"C:chromatic\\")\\n.s(\\"sawtooth\\")\\n.lpf(500)\\n._pitchwheel()"],"longname":"pitchwheel","kind":"member","scope":"global"},{"comment":"/**\\n * Displays a spiral visual.\\n *\\n * @name spiral\\n * @param {Object} options Object containing all the optional following parameters as key value pairs:\\n * @param {number} stretch controls the rotations per cycle ratio, where 1 = 1 cycle / 360 degrees\\n * @param {number} size the diameter of the spiral\\n * @param {number} thickness line thickness\\n * @param {string} cap style of line ends: butt (default), round, square\\n * @param {string} inset number of rotations before spiral starts (default 3)\\n * @param {string} playheadColor color of playhead, defaults to white\\n * @param {number} playheadLength length of playhead in rotations, defaults to 0.02\\n * @param {number} playheadThickness thickness of playheadrotations, defaults to thickness\\n * @param {number} padding space around spiral\\n * @param {number} steady steadyness of spiral vs playhead. 1 = spiral doesn't move, playhead does.\\n * @param {number} activeColor color of active segment. defaults to foreground of theme\\n * @param {number} inactiveColor color of inactive segments. defaults to gutterForeground of theme\\n * @param {boolean} colorizeInactive wether or not to colorize inactive segments, defaults to 0\\n * @param {boolean} fade wether or not past and future should fade out. defaults to 1\\n * @param {boolean} logSpiral wether or not the spiral should be logarithmic. defaults to 0\\n * @example\\n * note(\\"c2 a2 eb2\\")\\n * .euclid(5,8)\\n * .s('sawtooth')\\n * .lpenv(4).lpf(300)\\n * ._spiral({ steady: .96 })\\n */","meta":{"filename":"spiral.mjs","lineno":128,"columnno":0,"path":"/Users/felix/projects/strudel/packages/draw","code":{}},"description":"<p>Displays a spiral visual.</p>","name":"spiral","params":[{"type":{"names":["Object"]},"description":"<p>Object containing all the optional following parameters as key value pairs:</p>","name":"options"},{"type":{"names":["number"]},"description":"<p>controls the rotations per cycle ratio, where 1 = 1 cycle / 360 degrees</p>","name":"stretch"},{"type":{"names":["number"]},"description":"<p>the diameter of the spiral</p>","name":"size"},{"type":{"names":["number"]},"description":"<p>line thickness</p>","name":"thickness"},{"type":{"names":["string"]},"description":"<p>style of line ends: butt (default), round, square</p>","name":"cap"},{"type":{"names":["string"]},"description":"<p>number of rotations before spiral starts (default 3)</p>","name":"inset"},{"type":{"names":["string"]},"description":"<p>color of playhead, defaults to white</p>","name":"playheadColor"},{"type":{"names":["number"]},"description":"<p>length of playhead in rotations, defaults to 0.02</p>","name":"playheadLength"},{"type":{"names":["number"]},"description":"<p>thickness of playheadrotations, defaults to thickness</p>","name":"playheadThickness"},{"type":{"names":["number"]},"description":"<p>space around spiral</p>","name":"padding"},{"type":{"names":["number"]},"description":"<p>steadyness of spiral vs playhead. 1 = spiral doesn't move, playhead does.</p>","name":"steady"},{"type":{"names":["number"]},"description":"<p>color of active segment. defaults to foreground of theme</p>","name":"activeColor"},{"type":{"names":["number"]},"description":"<p>color of inactive segments. defaults to gutterForeground of theme</p>","name":"inactiveColor"},{"type":{"names":["boolean"]},"description":"<p>wether or not to colorize inactive segments, defaults to 0</p>","name":"colorizeInactive"},{"type":{"names":["boolean"]},"description":"<p>wether or not past and future should fade out. defaults to 1</p>","name":"fade"},{"type":{"names":["boolean"]},"description":"<p>wether or not the spiral should be logarithmic. defaults to 0</p>","name":"logSpiral"}],"examples":["note(\\"c2 a2 eb2\\")\\n.euclid(5,8)\\n.s('sawtooth')\\n.lpenv(4).lpf(300)\\n._spiral({ steady: .96 })"],"longname":"spiral","kind":"member","scope":"global"},{"comment":"/**\\n * configures the default midimap, which is used when no \\"midimap\\" port is set\\n * @example\\n * defaultmidimap({ lpf: 74 })\\n * $: note(\\"c a f e\\").midi();\\n * $: lpf(sine.slow(4).segment(16)).midi();\\n */","meta":{"range":[4416,4515],"filename":"midi.mjs","lineno":131,"columnno":0,"path":"/Users/felix/projects/strudel/packages/midi","code":{"id":"astnode100060963","name":"exports.defaultmidimap","type":"FunctionDeclaration","paramnames":["mapping"]}},"description":"<p>configures the default midimap, which is used when no &quot;midimap&quot; port is set</p>","examples":["defaultmidimap({ lpf: 74 })\\n$: note(\\"c a f e\\").midi();\\n$: lpf(sine.slow(4).segment(16)).midi();"],"name":"defaultmidimap","longname":"defaultmidimap","kind":"function","scope":"global"},{"comment":"/**\\n * Adds midimaps to the registry. Inside each midimap, control names (e.g. lpf) are mapped to cc numbers.\\n * @example\\n * midimaps({ mymap: { lpf: 74 } })\\n * $: note(\\"c a f e\\")\\n * .lpf(sine.slow(4))\\n * .midimap('mymap')\\n * .midi()\\n * @example\\n * midimaps({ mymap: {\\n *   lpf: { ccn: 74, min: 0, max: 20000, exp: 0.5 }\\n * }})\\n * $: note(\\"c a f e\\")\\n * .lpf(sine.slow(2).range(400,2000))\\n * .midimap('mymap')\\n * .midi()\\n */","meta":{"range":[4962,5392],"filename":"midi.mjs","lineno":154,"columnno":0,"path":"/Users/felix/projects/strudel/packages/midi","code":{"id":"astnode100060981","name":"exports.midimaps","type":"FunctionDeclaration","paramnames":["map"]}},"description":"<p>Adds midimaps to the registry. Inside each midimap, control names (e.g. lpf) are mapped to cc numbers.</p>","examples":["midimaps({ mymap: { lpf: 74 } })\\n$: note(\\"c a f e\\")\\n.lpf(sine.slow(4))\\n.midimap('mymap')\\n.midi()","midimaps({ mymap: {\\n  lpf: { ccn: 74, min: 0, max: 20000, exp: 0.5 }\\n}})\\n$: note(\\"c a f e\\")\\n.lpf(sine.slow(2).range(400,2000))\\n.midimap('mymap')\\n.midi()"],"name":"midimaps","longname":"midimaps","kind":"function","scope":"global"},{"comment":"/**\\n * MIDI output: Opens a MIDI output port.\\n * @param {string | number} midiport MIDI device name or index defaulting to 0\\n * @param {object} options Additional MIDI configuration options\\n * @example\\n * note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1')\\n * @example\\n * note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1', { controller: true, latency: 50 })\\n */","meta":{"range":[10343,16473],"filename":"midi.mjs","lineno":289,"columnno":0,"path":"/Users/felix/projects/strudel/packages/midi","code":{"id":"astnode100061632","name":"Pattern.prototype.midi","type":"FunctionExpression","paramnames":["midiport","options"]},"vars":{"undefined":null,"options":"Pattern#midi~options","midiport":"Pattern#midi~midiport","midiConfig":"Pattern#midi~midiConfig","":null}},"description":"<p>MIDI output: Opens a MIDI output port.</p>","params":[{"type":{"names":["string","number"]},"description":"<p>MIDI device name or index defaulting to 0</p>","name":"midiport"},{"type":{"names":["object"]},"description":"<p>Additional MIDI configuration options</p>","name":"options"}],"examples":["note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1')","note(\\"c4\\").midichan(1).midi('IAC Driver Bus 1', { controller: true, latency: 50 })"],"name":"midi","longname":"Pattern#midi","kind":"function","memberof":"Pattern","scope":"instance"},{"comment":"/**\\n * MIDI input: Opens a MIDI input port to receive MIDI control change messages.\\n * @param {string | number} input MIDI device name or index defaulting to 0\\n * @returns {Function}\\n * @example\\n * let cc = await midin('IAC Driver Bus 1')\\n * note(\\"c a f e\\").lpf(cc(0).range(0, 1000)).lpq(cc(1).range(0, 10)).sound(\\"sawtooth\\")\\n */","meta":{"range":[16844,18118],"filename":"midi.mjs","lineno":474,"columnno":0,"path":"/Users/felix/projects/strudel/packages/midi","code":{"id":"astnode100062281","name":"exports.midin","type":"FunctionDeclaration","paramnames":["input"]}},"description":"<p>MIDI input: Opens a MIDI input port to receive MIDI control change messages.</p>","params":[{"type":{"names":["string","number"]},"description":"<p>MIDI device name or index defaulting to 0</p>","name":"input"}],"returns":[{"type":{"names":["function"]}}],"examples":["let cc = await midin('IAC Driver Bus 1')\\nnote(\\"c a f e\\").lpf(cc(0).range(0, 1000)).lpq(cc(1).range(0, 10)).sound(\\"sawtooth\\")"],"name":"midin","longname":"midin","kind":"function","scope":"global"},{"comment":"/**\\n *  The accelerometer's x-axis value ranges from 0 to 1.\\n * @name accelerationX\\n * @return {Pattern}\\n * @synonyms accX\\n * @example\\n * n(accelerationX.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":5,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's x-axis value ranges from 0 to 1.</p>","name":"accelerationX","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accX","synonyms":["accX"],"examples":["n(accelerationX.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationX","kind":"member","scope":"global"},{"comment":"/**\\n *  The accelerometer's y-axis value ranges from 0 to 1.\\n * @name accelerationY\\n * @return {Pattern}\\n * @synonyms accY\\n * @example\\n * n(accelerationY.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":15,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's y-axis value ranges from 0 to 1.</p>","name":"accelerationY","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accY","synonyms":["accY"],"examples":["n(accelerationY.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationY","kind":"member","scope":"global"},{"comment":"/**\\n *  The accelerometer's z-axis value ranges from 0 to 1.\\n * @name accelerationZ\\n * @return {Pattern}\\n * @synonyms accZ\\n * @example\\n * n(accelerationZ.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":25,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The accelerometer's z-axis value ranges from 0 to 1.</p>","name":"accelerationZ","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"accZ","synonyms":["accZ"],"examples":["n(accelerationZ.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"accelerationZ","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity x-axis value ranges from 0 to 1.\\n * @name gravityX\\n * @return {Pattern}\\n * @synonyms gravX\\n * @example\\n * n(gravityX.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":35,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's gravity x-axis value ranges from 0 to 1.</p>","name":"gravityX","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravX","synonyms":["gravX"],"examples":["n(gravityX.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityX","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity y-axis value ranges from 0 to 1.\\n * @name gravityY\\n * @return {Pattern}\\n * @synonyms gravY\\n * @example\\n * n(gravityY.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":45,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's gravity y-axis value ranges from 0 to 1.</p>","name":"gravityY","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravY","synonyms":["gravY"],"examples":["n(gravityY.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityY","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's gravity z-axis value ranges from 0 to 1.\\n * @name gravityZ\\n * @return {Pattern}\\n * @synonyms gravZ\\n * @example\\n * n(gravityZ.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":55,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's gravity z-axis value ranges from 0 to 1.</p>","name":"gravityZ","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"gravZ","synonyms":["gravZ"],"examples":["n(gravityZ.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"gravityZ","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the alpha-axis value ranges from 0 to 1.\\n * @name rotationAlpha\\n * @return {Pattern}\\n * @synonyms rotA, rotZ, rotationZ\\n * @example\\n * n(rotationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":65,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the alpha-axis value ranges from 0 to 1.</p>","name":"rotationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotA, rotZ, rotationZ","synonyms":["rotA","rotZ","rotationZ"],"examples":["n(rotationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the beta-axis value ranges from 0 to 1.\\n * @name rotationBeta\\n * @return {Pattern}\\n * @synonyms rotB, rotX, rotationX\\n * @example\\n * n(rotationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":75,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the beta-axis value ranges from 0 to 1.</p>","name":"rotationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotB, rotX, rotationX","synonyms":["rotB","rotX","rotationX"],"examples":["n(rotationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's rotation around the gamma-axis value ranges from 0 to 1.\\n * @name rotationGamma\\n * @return {Pattern}\\n * @synonyms rotG, rotY, rotationY\\n * @example\\n * n(rotationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":85,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's rotation around the gamma-axis value ranges from 0 to 1.</p>","name":"rotationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"rotG, rotY, rotationY","synonyms":["rotG","rotY","rotationY"],"examples":["n(rotationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"rotationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation alpha value ranges from 0 to 1.\\n * @name orientationAlpha\\n * @return {Pattern}\\n * @synonyms oriA, oriZ, orientationZ\\n * @example\\n * n(orientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":95,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's orientation alpha value ranges from 0 to 1.</p>","name":"orientationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriA, oriZ, orientationZ","synonyms":["oriA","oriZ","orientationZ"],"examples":["n(orientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation beta value ranges from 0 to 1.\\n * @name orientationBeta\\n * @return {Pattern}\\n * @synonyms oriB, oriX, orientationX\\n * @example\\n * n(orientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":105,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's orientation beta value ranges from 0 to 1.</p>","name":"orientationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriB, oriX, orientationX","synonyms":["oriB","oriX","orientationX"],"examples":["n(orientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's orientation gamma value ranges from 0 to 1.\\n * @name orientationGamma\\n * @return {Pattern}\\n * @synonyms oriG, oriY, orientationY\\n * @example\\n * n(orientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":115,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's orientation gamma value ranges from 0 to 1.</p>","name":"orientationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"oriG, oriY, orientationY","synonyms":["oriG","oriY","orientationY"],"examples":["n(orientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"orientationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation alpha value ranges from 0 to 1.\\n * @name absoluteOrientationAlpha\\n * @return {Pattern}\\n * @synonyms absOriA, absOriZ, absoluteOrientationZ\\n * @example\\n * n(absoluteOrientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":125,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation alpha value ranges from 0 to 1.</p>","name":"absoluteOrientationAlpha","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriA, absOriZ, absoluteOrientationZ","synonyms":["absOriA","absOriZ","absoluteOrientationZ"],"examples":["n(absoluteOrientationAlpha.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationAlpha","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation beta value ranges from 0 to 1.\\n * @name absoluteOrientationBeta\\n * @return {Pattern}\\n * @synonyms absOriB, absOriX, absoluteOrientationX\\n * @example\\n * n(absoluteOrientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":135,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation beta value ranges from 0 to 1.</p>","name":"absoluteOrientationBeta","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriB, absOriX, absoluteOrientationX","synonyms":["absOriB","absOriX","absoluteOrientationX"],"examples":["n(absoluteOrientationBeta.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationBeta","kind":"member","scope":"global"},{"comment":"/**\\n *  The device's absolute orientation gamma value ranges from 0 to 1.\\n * @name absoluteOrientationGamma\\n * @return {Pattern}\\n * @synonyms absOriG, absOriY, absoluteOrientationY\\n * @example\\n * n(absoluteOrientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")\\n *\\n */","meta":{"filename":"motion.mjs","lineno":145,"columnno":0,"path":"/Users/felix/projects/strudel/packages/motion","code":{}},"description":"<p>The device's absolute orientation gamma value ranges from 0 to 1.</p>","name":"absoluteOrientationGamma","returns":[{"type":{"names":["Pattern"]}}],"synonyms_text":"absOriG, absOriY, absoluteOrientationY","synonyms":["absOriG","absOriY","absoluteOrientationY"],"examples":["n(absoluteOrientationGamma.segment(4).range(0,7)).scale(\\"C:minor\\")"],"longname":"absoluteOrientationGamma","kind":"member","scope":"global"},{"comment":"/**\\n *\\n * Sends each hap as an OSC message, which can be picked up by SuperCollider or any other OSC-enabled software.\\n * For more info, read [MIDI & OSC in the docs](https://strudel.cc/learn/input-output/)\\n *\\n * @name osc\\n * @memberof Pattern\\n * @returns Pattern\\n */","meta":{"filename":"osc.mjs","lineno":75,"columnno":0,"path":"/Users/felix/projects/strudel/packages/osc","code":{}},"description":"<p>Sends each hap as an OSC message, which can be picked up by SuperCollider or any other OSC-enabled software.\\nFor more info, read <a href=\\"https://strudel.cc/learn/input-output/\\">MIDI &amp; OSC in the docs</a></p>","name":"osc","memberof":"Pattern","returns":[{"description":"<p>Pattern</p>"}],"scope":"static","longname":"Pattern.osc","kind":"member"},{"comment":"/** Overlap-Add Node */","meta":{"range":[150,6513],"filename":"ola-processor.js","lineno":7,"columnno":0,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100098159","name":"OLAProcessor","type":"ClassDeclaration","paramnames":["options"]}},"name":"OLAProcessor","longname":"OLAProcessor","kind":"class","classdesc":"<p>Overlap-Add Node</p>","scope":"global"},{"comment":"/** Handles dynamic reallocation of input/output channels buffer\\n     (channel numbers may lety during lifecycle) **/","meta":{"range":[1429,1897],"filename":"ola-processor.js","lineno":39,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100098312","name":"OLAProcessor#reallocateChannelsIfNeeded","type":"MethodDefinition","paramnames":["inputs","outputs"]},"vars":{"":null}},"description":"<p>Handles dynamic reallocation of input/output channels buffer\\n(channel numbers may lety during lifecycle)</p>","name":"reallocateChannelsIfNeeded","longname":"OLAProcessor#reallocateChannelsIfNeeded","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Read next web audio block to input buffers **/","meta":{"range":[3534,4122],"filename":"ola-processor.js","lineno":92,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100098619","name":"OLAProcessor#readInputs","type":"MethodDefinition","paramnames":["inputs"]},"vars":{"":null}},"description":"<p>Read next web audio block to input buffers</p>","name":"readInputs","longname":"OLAProcessor#readInputs","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Write next web audio block from output buffers **/","meta":{"range":[4183,4461],"filename":"ola-processor.js","lineno":112,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100098740","name":"OLAProcessor#writeOutputs","type":"MethodDefinition","paramnames":["outputs"]},"vars":{"":null}},"description":"<p>Write next web audio block from output buffers</p>","name":"writeOutputs","longname":"OLAProcessor#writeOutputs","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Shift left content of input buffers to receive new web audio block **/","meta":{"range":[4542,4757],"filename":"ola-processor.js","lineno":122,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100098800","name":"OLAProcessor#shiftInputBuffers","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Shift left content of input buffers to receive new web audio block</p>","name":"shiftInputBuffers","longname":"OLAProcessor#shiftInputBuffers","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Shift left content of output buffers to receive new web audio block **/","meta":{"range":[4839,5147],"filename":"ola-processor.js","lineno":131,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100098847","name":"OLAProcessor#shiftOutputBuffers","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Shift left content of output buffers to receive new web audio block</p>","name":"shiftOutputBuffers","longname":"OLAProcessor#shiftOutputBuffers","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Copy contents of input buffers to buffer actually sent to process **/","meta":{"range":[5227,5454],"filename":"ola-processor.js","lineno":141,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100098914","name":"OLAProcessor#prepareInputBuffersToSend","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Copy contents of input buffers to buffer actually sent to process</p>","name":"prepareInputBuffersToSend","longname":"OLAProcessor#prepareInputBuffersToSend","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Add contents of output buffers just processed to output buffers **/","meta":{"range":[5532,5852],"filename":"ola-processor.js","lineno":150,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100098966","name":"OLAProcessor#handleOutputBuffersToRetrieve","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Add contents of output buffers just processed to output buffers</p>","name":"handleOutputBuffersToRetrieve","longname":"OLAProcessor#handleOutputBuffersToRetrieve","kind":"function","memberof":"OLAProcessor","scope":"instance","params":[]},{"comment":"/** Generates a reverb impulse response.\\n\\n @param {!Object} params TODO: Document the properties.\\n @param {!function(!AudioBuffer)} callback Function to call when\\n  the impulse response has been generated. The impulse response\\n  is passed to this function as its parameter. May be called\\n  immediately within the current execution context, or later. */","meta":{"range":[969,2138],"filename":"reverbGen.mjs","lineno":24,"columnno":0,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100099451","name":"reverbGen.generateReverb","type":"FunctionExpression","paramnames":["params","callback"]},"vars":{"audioContext":"reverbGen.generateReverb~audioContext","sampleRate":"reverbGen.generateReverb~sampleRate","numChannels":"reverbGen.generateReverb~numChannels","totalTime":"reverbGen.generateReverb~totalTime","decaySampleFrames":"reverbGen.generateReverb~decaySampleFrames","numSampleFrames":"reverbGen.generateReverb~numSampleFrames","fadeInSampleFrames":"reverbGen.generateReverb~fadeInSampleFrames","decayBase":"reverbGen.generateReverb~decayBase","reverbIR":"reverbGen.generateReverb~reverbIR","i":"reverbGen.generateReverb~i","chan":"reverbGen.generateReverb~chan","j":"reverbGen.generateReverb~j","chan[undefined]":"reverbGen.generateReverb~chan.undefined]"}},"description":"<p>Generates a reverb impulse response.</p>","params":[{"type":{"names":["Object"]},"nullable":false,"description":"<p>TODO: Document the properties.</p>","name":"params"},{"type":{"names":["function"]},"nullable":false,"description":"<p>Function to call when\\nthe impulse response has been generated. The impulse response\\nis passed to this function as its parameter. May be called\\nimmediately within the current execution context, or later.</p>","name":"callback"}],"name":"generateReverb","longname":"reverbGen.generateReverb","kind":"function","memberof":"reverbGen","scope":"static"},{"comment":"/** Creates a canvas element showing a graph of the given data.\\n\\n\\n @param {!Float32Array} data An array of numbers, or a Float32Array.\\n @param {number} width Width in pixels of the canvas.\\n @param {number} height Height in pixels of the canvas.\\n @param {number} min Minimum value of data for the graph (lower edge).\\n @param {number} max Maximum value of data in the graph (upper edge).\\n @return {!CanvasElement} The generated canvas element. */","meta":{"range":[2586,3097],"filename":"reverbGen.mjs","lineno":58,"columnno":0,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100099631","name":"reverbGen.generateGraph","type":"FunctionExpression","paramnames":["data","width","height","min","max"]},"vars":{"canvas":"reverbGen.generateGraph~canvas","canvas.width":"reverbGen.generateGraph~canvas.width","canvas.height":"reverbGen.generateGraph~canvas.height","gc":"reverbGen.generateGraph~gc","gc.fillStyle":"reverbGen.generateGraph~gc.fillStyle","xscale":"reverbGen.generateGraph~xscale","yscale":"reverbGen.generateGraph~yscale","i":"reverbGen.generateGraph~i"}},"description":"<p>Creates a canvas element showing a graph of the given data.</p>","params":[{"type":{"names":["Float32Array"]},"nullable":false,"description":"<p>An array of numbers, or a Float32Array.</p>","name":"data"},{"type":{"names":["number"]},"description":"<p>Width in pixels of the canvas.</p>","name":"width"},{"type":{"names":["number"]},"description":"<p>Height in pixels of the canvas.</p>","name":"height"},{"type":{"names":["number"]},"description":"<p>Minimum value of data for the graph (lower edge).</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>Maximum value of data in the graph (upper edge).</p>","name":"max"}],"returns":[{"type":{"names":["CanvasElement"]},"nullable":false,"description":"<p>The generated canvas element.</p>"}],"name":"generateGraph","longname":"reverbGen.generateGraph","kind":"function","memberof":"reverbGen","scope":"static"},{"comment":"/** Applies a constantly changing lowpass filter to the given sound.\\n\\n @private\\n @param {!AudioBuffer} input\\n @param {number} lpFreqStart\\n @param {number} lpFreqEnd\\n @param {number} lpFreqEndAt\\n @param {!function(!AudioBuffer)} callback May be called\\n  immediately within the current execution context, or later.*/","meta":{"range":[3419,4357],"filename":"reverbGen.mjs","lineno":83,"columnno":4,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100099746","name":"applyGradualLowpass","type":"FunctionExpression"},"vars":{"channelData":"applyGradualLowpass~channelData","context":"applyGradualLowpass~context","player":"applyGradualLowpass~player","player.buffer":"applyGradualLowpass~player.buffer","filter":"applyGradualLowpass~filter","lpFreqStart":"applyGradualLowpass~lpFreqStart","lpFreqEnd":"applyGradualLowpass~lpFreqEnd","filter.type":"applyGradualLowpass~filter.type","filter.Q.value":"applyGradualLowpass~filter.Q.value","context.oncomplete":"applyGradualLowpass~context.oncomplete","":null,"window.filterNode":"window.filterNode"}},"description":"<p>Applies a constantly changing lowpass filter to the given sound.</p>","access":"private","params":[{"type":{"names":["AudioBuffer"]},"nullable":false,"name":"input"},{"type":{"names":["number"]},"name":"lpFreqStart"},{"type":{"names":["number"]},"name":"lpFreqEnd"},{"type":{"names":["number"]},"name":"lpFreqEndAt"},{"type":{"names":["function"]},"nullable":false,"description":"<p>May be called\\nimmediately within the current execution context, or later.</p>","name":"callback"}],"name":"applyGradualLowpass","longname":"applyGradualLowpass","kind":"function","scope":"global"},{"comment":"/** @private\\n @param {!AudioBuffer} buffer\\n @return {!Array.<!Float32Array>} An array containing the Float32Array of each channel's samples. */","meta":{"range":[4508,4691],"filename":"reverbGen.mjs","lineno":116,"columnno":4,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100099910","name":"getAllChannelData","type":"FunctionExpression"},"vars":{"channels":"getAllChannelData~channels","i":"getAllChannelData~i","channels[undefined]":"getAllChannelData~channels.undefined]"}},"access":"private","params":[{"type":{"names":["AudioBuffer"]},"nullable":false,"name":"buffer"}],"returns":[{"type":{"names":["Array.<!Float32Array>"]},"nullable":false,"description":"<p>An array containing the Float32Array of each channel's samples.</p>"}],"name":"getAllChannelData","longname":"getAllChannelData","kind":"function","scope":"global"},{"comment":"/** @private\\n @return {number} A random number from -1 to 1. */","meta":{"range":[4762,4824],"filename":"reverbGen.mjs","lineno":126,"columnno":4,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100099945","name":"randomSample","type":"FunctionExpression"}},"access":"private","returns":[{"type":{"names":["number"]},"description":"<p>A random number from -1 to 1.</p>"}],"name":"randomSample","longname":"randomSample","kind":"function","scope":"global","params":[]},{"comment":"/**\\n * Loads a collection of samples to use with \`s\`\\n * @example\\n * samples('github:tidalcycles/dirt-samples');\\n * s(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")\\n * @example\\n * samples({\\n *  bd: '808bd/BD0000.WAV',\\n *  sd: '808sd/SD0010.WAV'\\n *  }, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');\\n * s(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")\\n * @example\\n * samples('shabda:noise,chimp:2')\\n * s(\\"noise <chimp:0*2 chimp:1>\\")\\n * @example\\n * samples('shabda/speech/fr-FR/f:chocolat')\\n * s(\\"chocolat*4\\")\\n */","meta":{"range":[7678,9659],"filename":"sampler.mjs","lineno":218,"columnno":0,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100100991","name":"exports.samples","type":"VariableDeclaration"}},"description":"<p>Loads a collection of samples to use with <code>s</code></p>","examples":["samples('github:tidalcycles/dirt-samples');\\ns(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")","samples({\\n bd: '808bd/BD0000.WAV',\\n sd: '808sd/SD0010.WAV'\\n }, 'https://raw.githubusercontent.com/tidalcycles/Dirt-Samples/master/');\\ns(\\"[bd ~]*2, [~ hh]*2, ~ sd\\")","samples('shabda:noise,chimp:2')\\ns(\\"noise <chimp:0*2 chimp:1>\\")","samples('shabda/speech/fr-FR/f:chocolat')\\ns(\\"chocolat*4\\")"],"name":"samples","longname":"samples","kind":"constant","scope":"global"},{"comment":"/**\\n * Register an alias for a bank of sounds.\\n * Optionally accepts a single argument map of bank aliases.\\n * Optionally accepts a single argument string of a path to a JSON file containing bank aliases.\\n * @param {string} bank - The bank to alias\\n * @param {string} alias - The alias to use for the bank\\n */","meta":{"range":[3683,4070],"filename":"superdough.mjs","lineno":101,"columnno":0,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100101918","name":"exports.aliasBank","type":"FunctionDeclaration","paramnames":["args"]}},"description":"<p>Register an alias for a bank of sounds.\\nOptionally accepts a single argument map of bank aliases.\\nOptionally accepts a single argument string of a path to a JSON file containing bank aliases.</p>","params":[{"type":{"names":["string"]},"description":"<p>The bank to alias</p>","name":"bank"},{"type":{"names":["string"]},"description":"<p>The alias to use for the bank</p>","name":"alias"}],"name":"aliasBank","longname":"aliasBank","kind":"function","scope":"global"},{"comment":"/** Apply Hann window in-place */","meta":{"range":[15251,15387],"filename":"worklets.mjs","lineno":571,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100110531","name":"PhaseVocoderProcessor#applyHannWindow","type":"MethodDefinition","paramnames":["input"]},"vars":{"":null}},"description":"<p>Apply Hann window in-place</p>","name":"applyHannWindow","longname":"PhaseVocoderProcessor#applyHannWindow","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Compute squared magnitudes for peak finding **/","meta":{"range":[15445,15757],"filename":"worklets.mjs","lineno":578,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100110565","name":"PhaseVocoderProcessor#computeMagnitudes","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Compute squared magnitudes for peak finding</p>","name":"computeMagnitudes","longname":"PhaseVocoderProcessor#computeMagnitudes","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Find peaks in spectrum magnitudes **/","meta":{"range":[15805,16276],"filename":"worklets.mjs","lineno":592,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100110625","name":"PhaseVocoderProcessor#findPeaks","type":"MethodDefinition","paramnames":[]},"vars":{"":null}},"description":"<p>Find peaks in spectrum magnitudes</p>","name":"findPeaks","longname":"PhaseVocoderProcessor#findPeaks","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/** Shift peaks and regions of influence by pitchFactor into new specturm */","meta":{"range":[16359,18422],"filename":"worklets.mjs","lineno":616,"columnno":2,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100110731","name":"PhaseVocoderProcessor#shiftPeaks","type":"MethodDefinition","paramnames":["pitchFactor"]},"vars":{"":null}},"description":"<p>Shift peaks and regions of influence by pitchFactor into new specturm</p>","name":"shiftPeaks","longname":"PhaseVocoderProcessor#shiftPeaks","kind":"function","memberof":"PhaseVocoderProcessor","scope":"instance","params":[]},{"comment":"/**  BYTE BEATS */","meta":{"range":[21480,22411],"filename":"worklets.mjs","lineno":779,"columnno":6,"path":"/Users/felix/projects/strudel/packages/superdough","code":{"id":"astnode100111445","name":"chyx","type":"ObjectExpression","value":"{\\"bitC\\":\\"\\",\\"br\\":\\"\\",\\"sinf\\":\\"\\",\\"cosf\\":\\"\\",\\"tanf\\":\\"\\",\\"regG\\":\\"\\"}"}},"description":"<p>BYTE BEATS</p>","name":"chyx","longname":"chyx","kind":"constant","scope":"global","params":[]},{"comment":"/**\\n * Change the pitch of each value by the given amount. Expects numbers or note strings as values.\\n * The amount can be given as a number of semitones or as a string in interval short notation.\\n * If you don't care about enharmonic correctness, just use numbers. Otherwise, pass the interval of\\n * the form: ST where S is the degree number and T the type of interval with\\n *\\n * - M = major\\n * - m = minor\\n * - P = perfect\\n * - A = augmented\\n * - d = diminished\\n *\\n * Examples intervals:\\n *\\n * - 1P = unison\\n * - 3M = major third\\n * - 3m = minor third\\n * - 4P = perfect fourth\\n * - 4A = augmented fourth\\n * - 5P = perfect fifth\\n * - 5d = diminished fifth\\n *\\n * @param {string | number} amount Either number of semitones or interval string.\\n * @returns Pattern\\n * @memberof Pattern\\n * @name transpose\\n * @synonyms trans\\n * @example\\n * \\"c2 c3\\".fast(2).transpose(\\"<0 -2 5 3>\\".slow(2)).note()\\n * @example\\n * \\"c2 c3\\".fast(2).transpose(\\"<1P -2M 4P 3m>\\".slow(2)).note()\\n */","meta":{"filename":"tonal.mjs","lineno":65,"columnno":0,"path":"/Users/felix/projects/strudel/packages/tonal","code":{}},"description":"<p>Change the pitch of each value by the given amount. Expects numbers or note strings as values.\\nThe amount can be given as a number of semitones or as a string in interval short notation.\\nIf you don't care about enharmonic correctness, just use numbers. Otherwise, pass the interval of\\nthe form: ST where S is the degree number and T the type of interval with</p>\\n<ul>\\n<li>M = major</li>\\n<li>m = minor</li>\\n<li>P = perfect</li>\\n<li>A = augmented</li>\\n<li>d = diminished</li>\\n</ul>\\n<p>Examples intervals:</p>\\n<ul>\\n<li>1P = unison</li>\\n<li>3M = major third</li>\\n<li>3m = minor third</li>\\n<li>4P = perfect fourth</li>\\n<li>4A = augmented fourth</li>\\n<li>5P = perfect fifth</li>\\n<li>5d = diminished fifth</li>\\n</ul>","params":[{"type":{"names":["string","number"]},"description":"<p>Either number of semitones or interval string.</p>","name":"amount"}],"returns":[{"description":"<p>Pattern</p>"}],"memberof":"Pattern","name":"transpose","synonyms_text":"trans","synonyms":["trans"],"examples":["\\"c2 c3\\".fast(2).transpose(\\"<0 -2 5 3>\\".slow(2)).note()","\\"c2 c3\\".fast(2).transpose(\\"<1P -2M 4P 3m>\\".slow(2)).note()"],"scope":"static","longname":"Pattern.transpose","kind":"member"},{"comment":"/**\\n * Transposes notes inside the scale by the number of steps.\\n * Expected to be called on a Pattern which already has a {@link Pattern#scale}\\n *\\n * @memberof Pattern\\n * @name scaleTranspose\\n * @param {offset} offset number of steps inside the scale\\n * @returns Pattern\\n * @synonyms scaleTrans, strans\\n * @example\\n * \\"-8 [2,4,6]\\"\\n * .scale('C4 bebop major')\\n * .scaleTranspose(\\"<0 -1 -2 -3 -4 -5 -6 -4>\\")\\n * .note()\\n */","meta":{"filename":"tonal.mjs","lineno":138,"columnno":0,"path":"/Users/felix/projects/strudel/packages/tonal","code":{}},"description":"<p>Transposes notes inside the scale by the number of steps.\\nExpected to be called on a Pattern which already has a {@link Pattern#scale}</p>","memberof":"Pattern","name":"scaleTranspose","params":[{"type":{"names":["offset"]},"description":"<p>number of steps inside the scale</p>","name":"offset"}],"returns":[{"description":"<p>Pattern</p>"}],"synonyms_text":"scaleTrans, strans","synonyms":["scaleTrans","strans"],"examples":["\\"-8 [2,4,6]\\"\\n.scale('C4 bebop major')\\n.scaleTranspose(\\"<0 -1 -2 -3 -4 -5 -6 -4>\\")\\n.note()"],"scope":"static","longname":"Pattern.scaleTranspose","kind":"member"},{"comment":"/**\\n * Turns numbers into notes in the scale (zero indexed). Also sets scale for other scale operations, like {@link Pattern#scaleTranspose}.\\n *\\n * A scale consists of a root note (e.g. \`c4\`, \`c\`, \`f#\`, \`bb4\`) followed by semicolon (':') and then a [scale type](https://github.com/tonaljs/tonal/blob/main/packages/scale-type/data.ts).\\n *\\n * The root note defaults to octave 3, if no octave number is given.\\n *\\n * @name scale\\n * @param {string} scale Name of scale\\n * @returns Pattern\\n * @example\\n * n(\\"0 2 4 6 4 2\\").scale(\\"C:major\\")\\n * @example\\n * n(\\"[0,7] 4 [2,7] 4\\")\\n * .scale(\\"C:<major minor>/2\\")\\n * .s(\\"piano\\")\\n * @example\\n * n(rand.range(0,12).segment(8))\\n * .scale(\\"C:ritusen\\")\\n * .s(\\"piano\\")\\n */","meta":{"filename":"tonal.mjs","lineno":174,"columnno":0,"path":"/Users/felix/projects/strudel/packages/tonal","code":{}},"description":"<p>Turns numbers into notes in the scale (zero indexed). Also sets scale for other scale operations, like {@link Pattern#scaleTranspose}.</p>\\n<p>A scale consists of a root note (e.g. <code>c4</code>, <code>c</code>, <code>f#</code>, <code>bb4</code>) followed by semicolon (':') and then a <a href=\\"https://github.com/tonaljs/tonal/blob/main/packages/scale-type/data.ts\\">scale type</a>.</p>\\n<p>The root note defaults to octave 3, if no octave number is given.</p>","name":"scale","params":[{"type":{"names":["string"]},"description":"<p>Name of scale</p>","name":"scale"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0 2 4 6 4 2\\").scale(\\"C:major\\")","n(\\"[0,7] 4 [2,7] 4\\")\\n.scale(\\"C:<major minor>/2\\")\\n.s(\\"piano\\")","n(rand.range(0,12).segment(8))\\n.scale(\\"C:ritusen\\")\\n.s(\\"piano\\")"],"longname":"scale","kind":"member","scope":"global"},{"comment":"/**\\n * Adds a new custom voicing dictionary.\\n *\\n * @name addVoicings\\n * @memberof Pattern\\n * @param {string} name identifier for the voicing dictionary\\n * @param {Object} dictionary maps chord symbol to possible voicings\\n * @param {Array} range min, max note\\n * @returns Pattern\\n * @example\\n * addVoicings('cookie', {\\n *   7: ['3M 7m 9M 12P 15P', '7m 10M 13M 16M 19P'],\\n *   '^7': ['3M 6M 9M 12P 14M', '7M 10M 13M 16M 19P'],\\n *   m7: ['8P 11P 14m 17m 19P', '5P 8P 11P 14m 17m'],\\n *   m7b5: ['3m 5d 8P 11P 14m', '5d 8P 11P 14m 17m'],\\n *   o7: ['3m 6M 9M 11A 15P'],\\n *   '7alt': ['3M 7m 10m 13m 15P'],\\n *   '7#11': ['7m 10m 13m 15P 17m'],\\n * }, ['C3', 'C6'])\\n * \\"<C^7 A7 Dm7 G7>\\".voicings('cookie').note()\\n */","meta":{"filename":"voicings.mjs","lineno":89,"columnno":0,"path":"/Users/felix/projects/strudel/packages/tonal","code":{}},"description":"<p>Adds a new custom voicing dictionary.</p>","name":"addVoicings","memberof":"Pattern","params":[{"type":{"names":["string"]},"description":"<p>identifier for the voicing dictionary</p>","name":"name"},{"type":{"names":["Object"]},"description":"<p>maps chord symbol to possible voicings</p>","name":"dictionary"},{"type":{"names":["Array"]},"description":"<p>min, max note</p>","name":"range"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["addVoicings('cookie', {\\n  7: ['3M 7m 9M 12P 15P', '7m 10M 13M 16M 19P'],\\n  '^7': ['3M 6M 9M 12P 14M', '7M 10M 13M 16M 19P'],\\n  m7: ['8P 11P 14m 17m 19P', '5P 8P 11P 14m 17m'],\\n  m7b5: ['3m 5d 8P 11P 14m', '5d 8P 11P 14m 17m'],\\n  o7: ['3m 6M 9M 11A 15P'],\\n  '7alt': ['3M 7m 10m 13m 15P'],\\n  '7#11': ['7m 10m 13m 15P 17m'],\\n}, ['C3', 'C6'])\\n\\"<C^7 A7 Dm7 G7>\\".voicings('cookie').note()"],"scope":"static","longname":"Pattern.addVoicings","kind":"member"},{"comment":"/**\\n * DEPRECATED: still works, but it is recommended you use .voicing instead (without s).\\n * Turns chord symbols into voicings, using the smoothest voice leading possible.\\n * Uses [chord-voicings package](https://github.com/felixroos/chord-voicings#chord-voicings).\\n *\\n * @name voicings\\n * @memberof Pattern\\n * @param {string} dictionary which voicing dictionary to use.\\n * @returns Pattern\\n * @example\\n * stack(\\"<C^7 A7 Dm7 G7>\\".voicings('lefthand'), \\"<C3 A2 D3 G2>\\").note()\\n */","meta":{"filename":"voicings.mjs","lineno":130,"columnno":0,"path":"/Users/felix/projects/strudel/packages/tonal","code":{}},"description":"<p>DEPRECATED: still works, but it is recommended you use .voicing instead (without s).\\nTurns chord symbols into voicings, using the smoothest voice leading possible.\\nUses <a href=\\"https://github.com/felixroos/chord-voicings#chord-voicings\\">chord-voicings package</a>.</p>","name":"voicings","memberof":"Pattern","params":[{"type":{"names":["string"]},"description":"<p>which voicing dictionary to use.</p>","name":"dictionary"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["stack(\\"<C^7 A7 Dm7 G7>\\".voicings('lefthand'), \\"<C3 A2 D3 G2>\\").note()"],"scope":"static","longname":"Pattern.voicings","kind":"member"},{"comment":"/**\\n * Maps the chords of the incoming pattern to root notes in the given octave.\\n *\\n * @name rootNotes\\n * @memberof Pattern\\n * @param {octave} octave octave to use\\n * @returns Pattern\\n * @example\\n * \\"<C^7 A7 Dm7 G7>\\".rootNotes(2).note()\\n */","meta":{"filename":"voicings.mjs","lineno":156,"columnno":0,"path":"/Users/felix/projects/strudel/packages/tonal","code":{}},"description":"<p>Maps the chords of the incoming pattern to root notes in the given octave.</p>","name":"rootNotes","memberof":"Pattern","params":[{"type":{"names":["octave"]},"description":"<p>octave to use</p>","name":"octave"}],"returns":[{"description":"<p>Pattern</p>"}],"examples":["\\"<C^7 A7 Dm7 G7>\\".rootNotes(2).note()"],"scope":"static","longname":"Pattern.rootNotes","kind":"member"},{"comment":"/**\\n * Turns chord symbols into voicings. You can use the following control params:\\n *\\n * - \`chord\`: Note, followed by chord symbol, e.g. C Am G7 Bb^7\\n * - \`dict\`: voicing dictionary to use, falls back to default dictionary\\n * - \`anchor\`: the note that is used to align the chord\\n * - \`mode\`: how the voicing is aligned to the anchor\\n *   - \`below\`: top note <= anchor\\n *   - \`duck\`: top note <= anchor, anchor excluded\\n *   - \`above\`: bottom note >= anchor\\n * - \`offset\`: whole number that shifts the voicing up or down to the next voicing\\n * - \`n\`: if set, the voicing is played like a scale. Overshooting numbers will be octaved\\n *\\n * All of the above controls are optional, except \`chord\`.\\n * If you pass a pattern of strings to voicing, they will be interpreted as chords.\\n *\\n * @name voicing\\n * @returns Pattern\\n * @example\\n * n(\\"0 1 2 3\\").chord(\\"<C Am F G>\\").voicing()\\n */","meta":{"filename":"voicings.mjs","lineno":175,"columnno":0,"path":"/Users/felix/projects/strudel/packages/tonal","code":{}},"description":"<p>Turns chord symbols into voicings. You can use the following control params:</p>\\n<ul>\\n<li><code>chord</code>: Note, followed by chord symbol, e.g. C Am G7 Bb^7</li>\\n<li><code>dict</code>: voicing dictionary to use, falls back to default dictionary</li>\\n<li><code>anchor</code>: the note that is used to align the chord</li>\\n<li><code>mode</code>: how the voicing is aligned to the anchor\\n<ul>\\n<li><code>below</code>: top note &lt;= anchor</li>\\n<li><code>duck</code>: top note &lt;= anchor, anchor excluded</li>\\n<li><code>above</code>: bottom note &gt;= anchor</li>\\n</ul>\\n</li>\\n<li><code>offset</code>: whole number that shifts the voicing up or down to the next voicing</li>\\n<li><code>n</code>: if set, the voicing is played like a scale. Overshooting numbers will be octaved</li>\\n</ul>\\n<p>All of the above controls are optional, except <code>chord</code>.\\nIf you pass a pattern of strings to voicing, they will be interpreted as chords.</p>","name":"voicing","returns":[{"description":"<p>Pattern</p>"}],"examples":["n(\\"0 1 2 3\\").chord(\\"<C Am F G>\\").voicing()"],"longname":"voicing","kind":"member","scope":"global"},{"comment":"/**\\n * Renders an oscilloscope for the frequency domain of the audio signal.\\n * @name fscope\\n * @param {string} color line color as hex or color name. defaults to white.\\n * @param {number} scale scales the y-axis. Defaults to 0.25\\n * @param {number} pos y-position relative to screen height. 0 = top, 1 = bottom of screen\\n * @param {number} lean y-axis alignment where 0 = top and 1 = bottom\\n * @param {number} min min value\\n * @param {number} max max value\\n * @example\\n * s(\\"sawtooth\\").fscope()\\n */","meta":{"filename":"scope.mjs","lineno":98,"columnno":0,"path":"/Users/felix/projects/strudel/packages/webaudio","code":{}},"description":"<p>Renders an oscilloscope for the frequency domain of the audio signal.</p>","name":"fscope","params":[{"type":{"names":["string"]},"description":"<p>line color as hex or color name. defaults to white.</p>","name":"color"},{"type":{"names":["number"]},"description":"<p>scales the y-axis. Defaults to 0.25</p>","name":"scale"},{"type":{"names":["number"]},"description":"<p>y-position relative to screen height. 0 = top, 1 = bottom of screen</p>","name":"pos"},{"type":{"names":["number"]},"description":"<p>y-axis alignment where 0 = top and 1 = bottom</p>","name":"lean"},{"type":{"names":["number"]},"description":"<p>min value</p>","name":"min"},{"type":{"names":["number"]},"description":"<p>max value</p>","name":"max"}],"examples":["s(\\"sawtooth\\").fscope()"],"longname":"fscope","kind":"member","scope":"global"},{"comment":"/**\\n * Renders an oscilloscope for the time domain of the audio signal.\\n * @name scope\\n * @synonyms tscope\\n * @param {object} config optional config with options:\\n * @param {boolean} align if 1, the scope will be aligned to the first zero crossing. defaults to 1\\n * @param {string} color line color as hex or color name. defaults to white.\\n * @param {number} thickness line thickness. defaults to 3\\n * @param {number} scale scales the y-axis. Defaults to 0.25\\n * @param {number} pos y-position relative to screen height. 0 = top, 1 = bottom of screen\\n * @param {number} trigger amplitude value that is used to align the scope. defaults to 0.\\n * @example\\n * s(\\"sawtooth\\")._scope()\\n */","meta":{"filename":"scope.mjs","lineno":121,"columnno":0,"path":"/Users/felix/projects/strudel/packages/webaudio","code":{}},"description":"<p>Renders an oscilloscope for the time domain of the audio signal.</p>","name":"scope","synonyms_text":"tscope","synonyms":["tscope"],"params":[{"type":{"names":["object"]},"description":"<p>optional config with options:</p>","name":"config"},{"type":{"names":["boolean"]},"description":"<p>if 1, the scope will be aligned to the first zero crossing. defaults to 1</p>","name":"align"},{"type":{"names":["string"]},"description":"<p>line color as hex or color name. defaults to white.</p>","name":"color"},{"type":{"names":["number"]},"description":"<p>line thickness. defaults to 3</p>","name":"thickness"},{"type":{"names":["number"]},"description":"<p>scales the y-axis. Defaults to 0.25</p>","name":"scale"},{"type":{"names":["number"]},"description":"<p>y-position relative to screen height. 0 = top, 1 = bottom of screen</p>","name":"pos"},{"type":{"names":["number"]},"description":"<p>amplitude value that is used to align the scope. defaults to 0.</p>","name":"trigger"}],"examples":["s(\\"sawtooth\\")._scope()"],"longname":"scope","kind":"member","scope":"global"},{"comment":"/**\\n * Renders a spectrum analyzer for the incoming audio signal.\\n * @name spectrum\\n * @param {object} config optional config with options:\\n * @param {integer} thickness line thickness in px (default 3)\\n * @param {integer} speed scroll speed (default 1)\\n * @param {integer} min min db (default -80)\\n * @param {integer} max max db (default 0)\\n * @example\\n * n(\\"<0 4 <2 3> 1>*3\\")\\n * .off(1/8, add(n(5)))\\n * .off(1/5, add(n(7)))\\n * .scale(\\"d3:minor:pentatonic\\")\\n * .s('sine')\\n * .dec(.3).room(.5)\\n * ._spectrum()\\n */","meta":{"filename":"spectrum.mjs","lineno":5,"columnno":0,"path":"/Users/felix/projects/strudel/packages/webaudio","code":{}},"description":"<p>Renders a spectrum analyzer for the incoming audio signal.</p>","name":"spectrum","params":[{"type":{"names":["object"]},"description":"<p>optional config with options:</p>","name":"config"},{"type":{"names":["integer"]},"description":"<p>line thickness in px (default 3)</p>","name":"thickness"},{"type":{"names":["integer"]},"description":"<p>scroll speed (default 1)</p>","name":"speed"},{"type":{"names":["integer"]},"description":"<p>min db (default -80)</p>","name":"min"},{"type":{"names":["integer"]},"description":"<p>max db (default 0)</p>","name":"max"}],"examples":["n(\\"<0 4 <2 3> 1>*3\\")\\n.off(1/8, add(n(5)))\\n.off(1/5, add(n(7)))\\n.scale(\\"d3:minor:pentatonic\\")\\n.s('sine')\\n.dec(.3).room(.5)\\n._spectrum()"],"longname":"spectrum","kind":"member","scope":"global"},{"kind":"package","longname":"package:undefined","files":["/Users/felix/projects/strudel/packages/codemirror/autocomplete.mjs","/Users/felix/projects/strudel/packages/codemirror/codemirror.mjs","/Users/felix/projects/strudel/packages/codemirror/flash.mjs","/Users/felix/projects/strudel/packages/codemirror/highlight.mjs","/Users/felix/projects/strudel/packages/codemirror/html.mjs","/Users/felix/projects/strudel/packages/codemirror/index.mjs","/Users/felix/projects/strudel/packages/codemirror/keybindings.mjs","/Users/felix/projects/strudel/packages/codemirror/slider.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/CutiePi.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/algoboy.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/androidstudio.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/archBtw.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/atomone.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/aura.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/bbedit.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/blackscreen.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/bluescreen.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/bluescreenlight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/darcula.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/dracula.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/duotoneDark.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/duotoneLight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/eclipse.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/fruitDaw.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/githubDark.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/githubLight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/green-text.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/gruvboxDark.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/gruvboxLight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/materialDark.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/materialLight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/monokai.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/noctisLilac.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/nord.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/red-text.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/solarizedDark.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/solarizedLight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/sonic-pink.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/strudel-theme.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/sublime.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/teletext.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/terminal.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/theme-helper.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/tokioNightStorm.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/tokyoNight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/tokyoNightDay.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/vscodeDark.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/vscodeLight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/whitescreen.mjs","/Users/felix/projects/strudel/packages/codemirror/themes/xcodeLight.mjs","/Users/felix/projects/strudel/packages/codemirror/themes.mjs","/Users/felix/projects/strudel/packages/codemirror/tooltip.mjs","/Users/felix/projects/strudel/packages/codemirror/vite.config.js","/Users/felix/projects/strudel/packages/codemirror/widget.mjs","/Users/felix/projects/strudel/packages/core/bench/pattern.bench.mjs","/Users/felix/projects/strudel/packages/core/clockworker.js","/Users/felix/projects/strudel/packages/core/controls.mjs","/Users/felix/projects/strudel/packages/core/cyclist.mjs","/Users/felix/projects/strudel/packages/core/drawLine.mjs","/Users/felix/projects/strudel/packages/core/euclid.mjs","/Users/felix/projects/strudel/packages/core/evaluate.mjs","/Users/felix/projects/strudel/packages/core/fraction.mjs","/Users/felix/projects/strudel/packages/core/hap.mjs","/Users/felix/projects/strudel/packages/core/index.mjs","/Users/felix/projects/strudel/packages/core/logger.mjs","/Users/felix/projects/strudel/packages/core/neocyclist.mjs","/Users/felix/projects/strudel/packages/core/pattern.mjs","/Users/felix/projects/strudel/packages/core/pick.mjs","/Users/felix/projects/strudel/packages/core/repl.mjs","/Users/felix/projects/strudel/packages/core/signal.mjs","/Users/felix/projects/strudel/packages/core/speak.mjs","/Users/felix/projects/strudel/packages/core/state.mjs","/Users/felix/projects/strudel/packages/core/test/controls.test.mjs","/Users/felix/projects/strudel/packages/core/test/drawLine.test.mjs","/Users/felix/projects/strudel/packages/core/test/euclid.test.js","/Users/felix/projects/strudel/packages/core/test/fraction.test.mjs","/Users/felix/projects/strudel/packages/core/test/pattern.test.mjs","/Users/felix/projects/strudel/packages/core/test/solmization.test.js","/Users/felix/projects/strudel/packages/core/test/util.test.mjs","/Users/felix/projects/strudel/packages/core/test/value.test.mjs","/Users/felix/projects/strudel/packages/core/time.mjs","/Users/felix/projects/strudel/packages/core/timespan.mjs","/Users/felix/projects/strudel/packages/core/ui.mjs","/Users/felix/projects/strudel/packages/core/util.mjs","/Users/felix/projects/strudel/packages/core/value.mjs","/Users/felix/projects/strudel/packages/core/vite.config.js","/Users/felix/projects/strudel/packages/core/zyklus.mjs","/Users/felix/projects/strudel/packages/csound/index.mjs","/Users/felix/projects/strudel/packages/csound/vite.config.js","/Users/felix/projects/strudel/packages/desktopbridge/index.mjs","/Users/felix/projects/strudel/packages/desktopbridge/loggerbridge.mjs","/Users/felix/projects/strudel/packages/desktopbridge/midibridge.mjs","/Users/felix/projects/strudel/packages/desktopbridge/oscbridge.mjs","/Users/felix/projects/strudel/packages/desktopbridge/utils.mjs","/Users/felix/projects/strudel/packages/draw/animate.mjs","/Users/felix/projects/strudel/packages/draw/color.mjs","/Users/felix/projects/strudel/packages/draw/draw.mjs","/Users/felix/projects/strudel/packages/draw/index.mjs","/Users/felix/projects/strudel/packages/draw/pianoroll.mjs","/Users/felix/projects/strudel/packages/draw/pitchwheel.mjs","/Users/felix/projects/strudel/packages/draw/spiral.mjs","/Users/felix/projects/strudel/packages/draw/vite.config.js","/Users/felix/projects/strudel/packages/embed/embed.js","/Users/felix/projects/strudel/packages/gamepad/gamepad.mjs","/Users/felix/projects/strudel/packages/gamepad/index.mjs","/Users/felix/projects/strudel/packages/gamepad/vite.config.js","/Users/felix/projects/strudel/packages/hs2js/src/hs2js.mjs","/Users/felix/projects/strudel/packages/hs2js/src/index.mjs","/Users/felix/projects/strudel/packages/hs2js/src/parser.mjs","/Users/felix/projects/strudel/packages/hs2js/vite.config.js","/Users/felix/projects/strudel/packages/hydra/hydra.mjs","/Users/felix/projects/strudel/packages/hydra/vite.config.js","/Users/felix/projects/strudel/packages/midi/index.mjs","/Users/felix/projects/strudel/packages/midi/midi.mjs","/Users/felix/projects/strudel/packages/midi/vite.config.js","/Users/felix/projects/strudel/packages/mini/bench/mini.bench.mjs","/Users/felix/projects/strudel/packages/mini/index.mjs","/Users/felix/projects/strudel/packages/mini/krill-parser.js","/Users/felix/projects/strudel/packages/mini/mini.mjs","/Users/felix/projects/strudel/packages/mini/test/mini.test.mjs","/Users/felix/projects/strudel/packages/mini/vite.config.js","/Users/felix/projects/strudel/packages/mondo/mondo.mjs","/Users/felix/projects/strudel/packages/mondo/test/mondo.test.mjs","/Users/felix/projects/strudel/packages/mondo/vite.config.js","/Users/felix/projects/strudel/packages/mondough/mondough.mjs","/Users/felix/projects/strudel/packages/mondough/vite.config.js","/Users/felix/projects/strudel/packages/motion/index.mjs","/Users/felix/projects/strudel/packages/motion/motion.mjs","/Users/felix/projects/strudel/packages/motion/vite.config.js","/Users/felix/projects/strudel/packages/mqtt/mqtt.mjs","/Users/felix/projects/strudel/packages/mqtt/vite.config.js","/Users/felix/projects/strudel/packages/osc/osc.mjs","/Users/felix/projects/strudel/packages/osc/server.js","/Users/felix/projects/strudel/packages/osc/superdirtoutput.js","/Users/felix/projects/strudel/packages/osc/tidal-sniffer.js","/Users/felix/projects/strudel/packages/osc/vite.config.js","/Users/felix/projects/strudel/packages/reference/index.mjs","/Users/felix/projects/strudel/packages/reference/vite.config.js","/Users/felix/projects/strudel/packages/repl/index.mjs","/Users/felix/projects/strudel/packages/repl/prebake.mjs","/Users/felix/projects/strudel/packages/repl/repl-component.mjs","/Users/felix/projects/strudel/packages/repl/vite.config.js","/Users/felix/projects/strudel/packages/sampler/sample-server.mjs","/Users/felix/projects/strudel/packages/serial/serial.mjs","/Users/felix/projects/strudel/packages/serial/vite.config.js","/Users/felix/projects/strudel/packages/soundfonts/convert.js","/Users/felix/projects/strudel/packages/soundfonts/fontloader.mjs","/Users/felix/projects/strudel/packages/soundfonts/gm.mjs","/Users/felix/projects/strudel/packages/soundfonts/index.mjs","/Users/felix/projects/strudel/packages/soundfonts/list.mjs","/Users/felix/projects/strudel/packages/soundfonts/sfumato.mjs","/Users/felix/projects/strudel/packages/soundfonts/vite.config.js","/Users/felix/projects/strudel/packages/superdough/dspworklet.mjs","/Users/felix/projects/strudel/packages/superdough/feedbackdelay.mjs","/Users/felix/projects/strudel/packages/superdough/fft.js","/Users/felix/projects/strudel/packages/superdough/helpers.mjs","/Users/felix/projects/strudel/packages/superdough/index.mjs","/Users/felix/projects/strudel/packages/superdough/logger.mjs","/Users/felix/projects/strudel/packages/superdough/noise.mjs","/Users/felix/projects/strudel/packages/superdough/ola-processor.js","/Users/felix/projects/strudel/packages/superdough/reverb.mjs","/Users/felix/projects/strudel/packages/superdough/reverbGen.mjs","/Users/felix/projects/strudel/packages/superdough/sampler.mjs","/Users/felix/projects/strudel/packages/superdough/superdough.mjs","/Users/felix/projects/strudel/packages/superdough/synth.mjs","/Users/felix/projects/strudel/packages/superdough/util.mjs","/Users/felix/projects/strudel/packages/superdough/vite.config.js","/Users/felix/projects/strudel/packages/superdough/vowel.mjs","/Users/felix/projects/strudel/packages/superdough/worklets.mjs","/Users/felix/projects/strudel/packages/superdough/zzfx.mjs","/Users/felix/projects/strudel/packages/superdough/zzfx_fork.mjs","/Users/felix/projects/strudel/packages/tidal/tidal.mjs","/Users/felix/projects/strudel/packages/tonal/index.mjs","/Users/felix/projects/strudel/packages/tonal/ireal.mjs","/Users/felix/projects/strudel/packages/tonal/test/tonal.test.mjs","/Users/felix/projects/strudel/packages/tonal/test/tonleiter.test.mjs","/Users/felix/projects/strudel/packages/tonal/tonal.mjs","/Users/felix/projects/strudel/packages/tonal/tonleiter.mjs","/Users/felix/projects/strudel/packages/tonal/vite.config.js","/Users/felix/projects/strudel/packages/tonal/voicings.mjs","/Users/felix/projects/strudel/packages/transpiler/index.mjs","/Users/felix/projects/strudel/packages/transpiler/test/transpiler.test.mjs","/Users/felix/projects/strudel/packages/transpiler/transpiler.mjs","/Users/felix/projects/strudel/packages/transpiler/vite.config.js","/Users/felix/projects/strudel/packages/vite-plugin-bundle-audioworklet/vite-plugin-bundle-audioworklet.js","/Users/felix/projects/strudel/packages/web/vite.config.js","/Users/felix/projects/strudel/packages/web/web.mjs","/Users/felix/projects/strudel/packages/webaudio/index.mjs","/Users/felix/projects/strudel/packages/webaudio/scope.mjs","/Users/felix/projects/strudel/packages/webaudio/spectrum.mjs","/Users/felix/projects/strudel/packages/webaudio/vite.config.js","/Users/felix/projects/strudel/packages/webaudio/webaudio.mjs","/Users/felix/projects/strudel/packages/xen/index.mjs","/Users/felix/projects/strudel/packages/xen/test/xen.test.mjs","/Users/felix/projects/strudel/packages/xen/tune.mjs","/Users/felix/projects/strudel/packages/xen/tunejs.js","/Users/felix/projects/strudel/packages/xen/vite.config.js","/Users/felix/projects/strudel/packages/xen/xen.mjs"]}]`),VS={docs:aCe},fx=typeof DOMParser<"u"?new DOMParser:null;let iCe=n=>fx==null?void 0:fx.parseFromString(n,"text/html").querySelectorAll("*"),t7=n=>Array.isArray(n)?n.flat().join(""):n===void 0?"":n,oCe=(n,...e)=>{let t="";for(let s in n)t+=t7(n[s]),t+=t7(e[s]);return iCe(t)};const lCe=n=>{const e=document.createElement("div");return e.innerText=n,e.innerHTML},cCe=n=>{const e=document.createElement("div");return e.innerHTML=n,e.textContent||e.innerText||""},ME=n=>n.name||n.longname,uCe=n=>n!=null&&n.length?`
    <div class="autocomplete-info-params-section">
      <h4 class="autocomplete-info-section-title">Parameters</h4>
      <ul class="autocomplete-info-params-list">
        ${n.map(({name:e,type:t,description:s})=>{var r;return`
          <li class="autocomplete-info-param-item">
            <span class="autocomplete-info-param-name">${e}</span>
            <span class="autocomplete-info-param-type">${(r=t.names)==null?void 0:r.join(" | ")}</span>
            ${s?`<div class="autocomplete-info-param-desc">${cCe(s)}</div>`:""}
          </li>
        `}).join("")}
      </ul>
    </div>
  `:"",hCe=n=>n!=null&&n.length?`
    <div class="autocomplete-info-examples-section">
      <h4 class="autocomplete-info-section-title">Examples</h4>
      ${n.map(e=>`
        <pre class="autocomplete-info-example-code">${lCe(e)}</pre>
      `).join("")}
    </div>
  `:"",lW=({doc:n,label:e})=>oCe`
  <div class="autocomplete-info-container">
    <div class="autocomplete-info-tooltip">
      <h3 class="autocomplete-info-function-name">${e||ME(n)}</h3>
      ${n.description?`<div class="autocomplete-info-function-description">${n.description}</div>`:""}
      ${uCe(n.params)}
      ${hCe(n.examples)}
    </div>
  </div>
`[0],dCe=n=>{const e=ME(n);return e&&!e.startsWith("_")&&!["package"].includes(n.kind)},pCe=n=>["superdirtOnly","noAutocomplete"].some(e=>{var t;return(t=n.tags)==null?void 0:t.find(s=>s.originalTitle===e)}),mCe=VS.docs.filter(n=>dCe(n)&&!pCe(n)).map(n=>({label:ME(n),info:()=>lW({doc:n}),type:"function"})),fCe=n=>{const e=n.matchBefore(/\w*/);return e.from===e.to&&!n.explicit?null:{from:e.from,options:mCe}},gCe=n=>n?[x2e({override:[fCe],closeOnBlur:!1})]:[],bCe=n=>n.name||n.longname;let ZS=!1;typeof window<"u"&&(window.addEventListener("keyup",function(n){n.key=="Control"&&(ZS=!1)},!0),window.addEventListener("keydown",function(n){n.key=="Control"&&(ZS=!0)},!0));const yCe=yq((n,e,t)=>{if(!ZS)return null;let{from:s,to:r,text:a}=n.state.doc.lineAt(e),i=e,o=e;for(;i>s&&/\w/.test(a[i-s-1]);)i--;for(;o<r&&/\w/.test(a[o-s]);)o++;if(i==e&&t<0||o==e&&t>0)return null;let l=a.slice(i-s,o-s),c=VS.docs.filter(u=>bCe(u)===l)[0];return!c&&(c=VS.docs.filter(u=>u.synonyms&&u.synonyms.includes(l))[0],!c)?null:{pos:i,end:o,above:!1,arrow:!0,create(u){let h=document.createElement("div");h.className="strudel-tooltip";const d=lW({doc:c,label:l});return h.appendChild(d),{dom:h}}}},{hoverTime:10}),vCe=n=>n?yCe:[],x1=ln.define(),cW=Us.define({create(){return Yt.none},update(n,e){try{for(let t of e.effects)if(t.is(x1))if(t.value&&e.newDoc.length>0){const s=Yt.mark({attributes:{style:"background-color: rgba(255,255,255, .4); filter: invert(10%)"}});n=Yt.set([s.range(0,e.newDoc.length)])}else n=Yt.set([]);return n}catch(t){return console.warn("flash error",t),n}},provide:n=>vt.decorations.from(n)}),uW=(n,e=200)=>{n.dispatch({effects:x1.of(!0)}),setTimeout(()=>{n.dispatch({effects:x1.of(!1)})},e)},hW=n=>n?cW:[],DE=ln.define(),TE=ln.define(),k1=(n,e)=>{n.dispatch({effects:DE.of(e)})},dW=(n,e,t)=>{n.dispatch({effects:TE.of({atTime:e,haps:t})})},zS=Us.define({create(){return Yt.none},update(n,e){e.docChanged&&(n=n.map(e.changes));for(let t of e.effects)if(t.is(DE)){const s=t.value.filter(([r])=>r<e.newDoc.length).map(([r,a])=>[r,Math.min(a,e.newDoc.length)]).map(r=>Yt.mark({id:r.join(":"),attributes:{style:"background-color: #00CA2880"}}).range(...r));n=Yt.set(s,!0)}return n}}),qS=Us.define({create(){return{atTime:0,haps:new Map}},update(n,e){var t;for(let s of e.effects)if(s.is(TE)){const r=new Map;for(let a of s.value.haps)if(!(!((t=a.context)!=null&&t.locations)||!a.whole))for(let{start:i,end:o}of a.context.locations){let l=`${i}:${o}`;(!r.has(l)||r.get(l).whole.begin.lt(a.whole.begin))&&r.set(l,a)}n={atTime:s.value.atTime,haps:r}}return n}}),OCe=vt.decorations.compute([zS,qS],n=>{var r,a;const e=n.field(zS).iter(),{haps:t}=n.field(qS),s=new _l;for(;e.value;){const{from:i,to:o,value:{spec:{id:l}}}=e;if(t.has(l)){const c=t.get(l),u=((r=c.value)==null?void 0:r.color)??"var(--foreground)",h=((a=c.value)==null?void 0:a.markcss)||`outline: solid 2px ${u}`;s.add(i,o,Yt.mark({attributes:{style:h}}))}e.next()}return s.finish()}),pW=[zS,qS,OCe],mW=(n,e)=>(n&&e&&setTimeout(()=>{k1(e.editor,e.miniLocations)},100),n?ui.highest(pW):[]);function Ts(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var r=t[s];typeof r=="string"?n.setAttribute(s,r):r!=null&&(n[s]=r)}e++}for(;e<arguments.length;e++)fW(n,arguments[e]);return n}function fW(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)fW(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}const n7=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Ff{constructor(e,t,s=0,r=e.length,a,i){this.test=i,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(s,r),this.bufferStart=s,this.normalize=a?o=>a(n7(o)):n7,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ya(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=qA(e),s=this.bufferStart+this.bufferPos;this.bufferPos+=Ol(e);let r=this.normalize(t);if(r.length)for(let a=0,i=s;;a++){let o=r.charCodeAt(a),l=this.match(o,i,this.bufferPos+this.bufferStart);if(a==r.length-1){if(l)return this.value=l,this;break}i==s&&a<t.length&&t.charCodeAt(a)==o&&i++}}}match(e,t,s){let r=null;for(let a=0;a<this.matches.length;a+=2){let i=this.matches[a],o=!1;this.query.charCodeAt(i)==e&&(i==this.query.length-1?r={from:this.matches[a+1],to:s}:(this.matches[a]++,o=!0)),o||(this.matches.splice(a,2),a-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:t,to:s}:this.matches.push(1,t)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferStart)&&(r=null),r}}typeof Symbol<"u"&&(Ff.prototype[Symbol.iterator]=function(){return this});const gW={from:-1,to:-1,match:/.*/.exec("")},BE="gm"+(/x/.unicode==null?"":"u");class FE{constructor(e,t,s,r=0,a=e.length){if(this.text=e,this.to=a,this.curLine="",this.done=!1,this.value=gW,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new bW(e,t,s,r,a);this.re=new RegExp(t,BE+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.iter=e.iter();let i=e.lineAt(r);this.curLineStart=i.from,this.matchPos=S1(e,r),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let s=this.curLineStart+t.index,r=s+t[0].length;if(this.matchPos=S1(this.text,r+(s==r?1:0)),s==this.curLineStart+this.curLine.length&&this.nextLine(),(s<r||s>this.value.to)&&(!this.test||this.test(s,r,t)))return this.value={from:s,to:r,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const gx=new WeakMap;class xd{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,s){let r=gx.get(e);if(!r||r.from>=s||r.to<=t){let o=new xd(t,e.sliceString(t,s));return gx.set(e,o),o}if(r.from==t&&r.to==s)return r;let{text:a,from:i}=r;return i>t&&(a=e.sliceString(t,i)+a,i=t),r.to<s&&(a+=e.sliceString(r.to,s)),gx.set(e,new xd(i,a)),new xd(t,a.slice(t-i,s-i))}}class bW{constructor(e,t,s,r,a){this.text=e,this.to=a,this.done=!1,this.value=gW,this.matchPos=S1(e,r),this.re=new RegExp(t,BE+(s!=null&&s.ignoreCase?"i":"")),this.test=s==null?void 0:s.test,this.flat=xd.get(e,r,this.chunkEnd(r+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let s=this.flat.from+t.index,r=s+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(s,r,t)))return this.value={from:s,to:r,match:t},this.matchPos=S1(this.text,r+(s==r?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=xd.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(FE.prototype[Symbol.iterator]=bW.prototype[Symbol.iterator]=function(){return this});function wCe(n){try{return new RegExp(n,BE),!0}catch{return!1}}function S1(n,e){if(e>=n.length)return e;let t=n.lineAt(e),s;for(;e<t.to&&(s=t.text.charCodeAt(e-t.from))>=56320&&s<57344;)e++;return e}function US(n){let e=String(n.state.doc.lineAt(n.state.selection.main.head).number),t=Ts("input",{class:"cm-textfield",name:"line",value:e}),s=Ts("form",{class:"cm-gotoLine",onkeydown:a=>{a.keyCode==27?(a.preventDefault(),n.dispatch({effects:C1.of(!1)}),n.focus()):a.keyCode==13&&(a.preventDefault(),r())},onsubmit:a=>{a.preventDefault(),r()}},Ts("label",n.state.phrase("Go to line"),": ",t)," ",Ts("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function r(){let a=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!a)return;let{state:i}=n,o=i.doc.lineAt(i.selection.main.head),[,l,c,u,h]=a,d=u?+u.slice(1):0,m=c?+c:o.number;if(c&&h){let S=m/100;l&&(S=S*(l=="-"?-1:1)+o.number/i.doc.lines),m=Math.round(i.doc.lines*S)}else c&&l&&(m=m*(l=="-"?-1:1)+o.number);let y=i.doc.line(Math.max(1,Math.min(i.doc.lines,m))),O=Ve.cursor(y.from+Math.max(0,Math.min(d,y.length)));n.dispatch({effects:[C1.of(!1),vt.scrollIntoView(O.from,{y:"center"})],selection:O}),n.focus()}return{dom:s}}const C1=ln.define(),s7=Us.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(C1)&&(n=t.value);return n},provide:n=>Ou.from(n,e=>e?US:null)}),xCe=n=>{let e=Sf(n,US);if(!e){let t=[C1.of(!0)];n.state.field(s7,!1)==null&&t.push(ln.appendConfig.of([s7,kCe])),n.dispatch({effects:t}),e=Sf(n,US)}return e&&e.dom.querySelector("input").select(),!0},kCe=vt.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),SCe=({state:n,dispatch:e})=>{let{selection:t}=n,s=Ve.create(t.ranges.map(r=>n.wordAt(r.head)||Ve.cursor(r.head)),t.mainIndex);return s.eq(t)?!1:(e(n.update({selection:s})),!0)};function CCe(n,e){let{main:t,ranges:s}=n.selection,r=n.wordAt(t.head),a=r&&r.from==t.from&&r.to==t.to;for(let i=!1,o=new Ff(n.doc,e,s[s.length-1].to);;)if(o.next(),o.done){if(i)return null;o=new Ff(n.doc,e,0,Math.max(0,s[s.length-1].from-1)),i=!0}else{if(i&&s.some(l=>l.from==o.value.from))continue;if(a){let l=n.wordAt(o.value.from);if(!l||l.from!=o.value.from||l.to!=o.value.to)continue}return o.value}}const PCe=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(a=>a.from===a.to))return SCe({state:n,dispatch:e});let s=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(a=>n.sliceDoc(a.from,a.to)!=s))return!1;let r=CCe(n,s);return r?(e(n.update({selection:n.selection.addRange(Ve.range(r.from,r.to),!1),effects:vt.scrollIntoView(r.to)})),!0):!1},Sp=_t.define({combine(n){return Tc(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new NCe(e),scrollToMatch:e=>vt.scrollIntoView(e)})}});class $E{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||wCe(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,s)=>s=="n"?`
`:s=="r"?"\r":s=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new DCe(this):new ECe(this)}getCursor(e,t=0,s){let r=e.doc?e:rs.create({doc:e});return s==null&&(s=r.doc.length),this.regexp?Vh(this,r,t,s):jh(this,r,t,s)}}class yW{constructor(e){this.spec=e}}function jh(n,e,t,s){return new Ff(e.doc,n.unquoted,t,s,n.caseSensitive?void 0:r=>r.toLowerCase(),n.wholeWord?ACe(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function ACe(n,e){return(t,s,r,a)=>((a>t||a+r.length<s)&&(a=Math.max(0,t-2),r=n.sliceString(a,Math.min(n.length,s+2))),(e(P1(r,t-a))!=gr.Word||e(A1(r,t-a))!=gr.Word)&&(e(A1(r,s-a))!=gr.Word||e(P1(r,s-a))!=gr.Word))}class ECe extends yW{constructor(e){super(e)}nextMatch(e,t,s){let r=jh(this.spec,e,s,e.doc.length).nextOverlapping();if(r.done){let a=Math.min(e.doc.length,t+this.spec.unquoted.length);r=jh(this.spec,e,0,a).nextOverlapping()}return r.done||r.value.from==t&&r.value.to==s?null:r.value}prevMatchInRange(e,t,s){for(let r=s;;){let a=Math.max(t,r-1e4-this.spec.unquoted.length),i=jh(this.spec,e,a,r),o=null;for(;!i.nextOverlapping().done;)o=i.value;if(o)return o;if(a==t)return null;r-=1e4}}prevMatch(e,t,s){let r=this.prevMatchInRange(e,0,t);return r||(r=this.prevMatchInRange(e,Math.max(0,s-this.spec.unquoted.length),e.doc.length)),r&&(r.from!=t||r.to!=s)?r:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let s=jh(this.spec,e,0,e.doc.length),r=[];for(;!s.next().done;){if(r.length>=t)return null;r.push(s.value)}return r}highlight(e,t,s,r){let a=jh(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(s+this.spec.unquoted.length,e.doc.length));for(;!a.next().done;)r(a.value.from,a.value.to)}}function Vh(n,e,t,s){return new FE(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?MCe(e.charCategorizer(e.selection.main.head)):void 0},t,s)}function P1(n,e){return n.slice(qr(n,e,!1),e)}function A1(n,e){return n.slice(e,qr(n,e))}function MCe(n){return(e,t,s)=>!s[0].length||(n(P1(s.input,s.index))!=gr.Word||n(A1(s.input,s.index))!=gr.Word)&&(n(A1(s.input,s.index+s[0].length))!=gr.Word||n(P1(s.input,s.index+s[0].length))!=gr.Word)}class DCe extends yW{nextMatch(e,t,s){let r=Vh(this.spec,e,s,e.doc.length).next();return r.done&&(r=Vh(this.spec,e,0,t).next()),r.done?null:r.value}prevMatchInRange(e,t,s){for(let r=1;;r++){let a=Math.max(t,s-r*1e4),i=Vh(this.spec,e,a,s),o=null;for(;!i.next().done;)o=i.value;if(o&&(a==t||o.from>a+10))return o;if(a==t)return null}}prevMatch(e,t,s){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,s,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(t,s)=>s=="$"?"$":s=="&"?e.match[0]:s!="0"&&+s<e.match.length?e.match[s]:t)}matchAll(e,t){let s=Vh(this.spec,e,0,e.doc.length),r=[];for(;!s.next().done;){if(r.length>=t)return null;r.push(s.value)}return r}highlight(e,t,s,r){let a=Vh(this.spec,e,Math.max(0,t-250),Math.min(s+250,e.doc.length));for(;!a.next().done;)r(a.value.from,a.value.to)}}const ku=ln.define(),NE=ln.define(),nu=Us.define({create(n){return new bx(WS(n).create(),null)},update(n,e){for(let t of e.effects)t.is(ku)?n=new bx(t.value.create(),n.panel):t.is(NE)&&(n=new bx(n.query,t.value?_E:null));return n},provide:n=>Ou.from(n,e=>e.panel)});class bx{constructor(e,t){this.query=e,this.panel=t}}const TCe=Yt.mark({class:"cm-searchMatch"}),BCe=Yt.mark({class:"cm-searchMatch cm-searchMatch-selected"}),FCe=nr.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(nu))}update(n){let e=n.state.field(nu);(e!=n.startState.field(nu)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Yt.none;let{view:t}=this,s=new _l;for(let r=0,a=t.visibleRanges,i=a.length;r<i;r++){let{from:o,to:l}=a[r];for(;r<i-1&&l>a[r+1].from-500;)l=a[++r].to;n.highlight(t.state,o,l,(c,u)=>{let h=t.state.selection.ranges.some(d=>d.from==c&&d.to==u);s.add(c,u,h?BCe:TCe)})}return s.finish()}},{decorations:n=>n.decorations});function vg(n){return e=>{let t=e.state.field(nu,!1);return t&&t.query.spec.valid?n(e,t):kW(e)}}const r7=vg((n,{query:e})=>{let{to:t}=n.state.selection.main,s=e.nextMatch(n.state,t,t);if(!s)return!1;let r=Ve.single(s.from,s.to),a=n.state.facet(Sp);return n.dispatch({selection:r,effects:[RE(n,s),a.scrollToMatch(r.main,n)],userEvent:"select.search"}),xW(n),!0}),a7=vg((n,{query:e})=>{let{state:t}=n,{from:s}=t.selection.main,r=e.prevMatch(t,s,s);if(!r)return!1;let a=Ve.single(r.from,r.to),i=n.state.facet(Sp);return n.dispatch({selection:a,effects:[RE(n,r),i.scrollToMatch(a.main,n)],userEvent:"select.search"}),xW(n),!0}),vW=vg((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:Ve.create(t.map(s=>Ve.range(s.from,s.to))),userEvent:"select.search.matches"}),!0)}),$Ce=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:s,to:r}=t.main,a=[],i=0;for(let o=new Ff(n.doc,n.sliceDoc(s,r));!o.next().done;){if(a.length>1e3)return!1;o.value.from==s&&(i=a.length),a.push(Ve.range(o.value.from,o.value.to))}return e(n.update({selection:Ve.create(a,i),userEvent:"select.search.matches"})),!0},i7=vg((n,{query:e})=>{let{state:t}=n,{from:s,to:r}=t.selection.main;if(t.readOnly)return!1;let a=e.nextMatch(t,s,s);if(!a)return!1;let i=a,o=[],l,c,u=[];if(i.from==s&&i.to==r&&(c=t.toText(e.getReplacement(i)),o.push({from:i.from,to:i.to,insert:c}),i=e.nextMatch(t,i.from,i.to),u.push(vt.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(s).number)+"."))),i){let h=o.length==0||o[0].from>=a.to?0:a.to-a.from-c.length;l=Ve.single(i.from-h,i.to-h),u.push(RE(n,i)),u.push(t.facet(Sp).scrollToMatch(l.main,n))}return n.dispatch({changes:o,selection:l,effects:u,userEvent:"input.replace"}),!0}),OW=vg((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(r=>{let{from:a,to:i}=r;return{from:a,to:i,insert:e.getReplacement(r)}});if(!t.length)return!1;let s=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:vt.announce.of(s),userEvent:"input.replace.all"}),!0});function _E(n){return n.state.facet(Sp).createPanel(n)}function WS(n,e){var t,s,r,a,i;let o=n.selection.main,l=o.empty||o.to>o.from+100?"":n.sliceDoc(o.from,o.to);if(e&&!l)return e;let c=n.facet(Sp);return new $E({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(s=e==null?void 0:e.caseSensitive)!==null&&s!==void 0?s:c.caseSensitive,literal:(r=e==null?void 0:e.literal)!==null&&r!==void 0?r:c.literal,regexp:(a=e==null?void 0:e.regexp)!==null&&a!==void 0?a:c.regexp,wholeWord:(i=e==null?void 0:e.wholeWord)!==null&&i!==void 0?i:c.wholeWord})}function wW(n){let e=Sf(n,_E);return e&&e.dom.querySelector("[main-field]")}function xW(n){let e=wW(n);e&&e==n.root.activeElement&&e.select()}const kW=n=>{let e=n.state.field(nu,!1);if(e&&e.panel){let t=wW(n);if(t&&t!=n.root.activeElement){let s=WS(n.state,e.query.spec);s.valid&&n.dispatch({effects:ku.of(s)}),t.focus(),t.select()}}else n.dispatch({effects:[NE.of(!0),e?ku.of(WS(n.state,e.query.spec)):ln.appendConfig.of(RCe)]});return!0},SW=n=>{let e=n.state.field(nu,!1);if(!e||!e.panel)return!1;let t=Sf(n,_E);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:NE.of(!1)}),!0};class NCe{constructor(e){this.view=e;let t=this.query=e.state.field(nu).query.spec;this.commit=this.commit.bind(this),this.searchField=Ts("input",{value:t.search,placeholder:vi(e,"Find"),"aria-label":vi(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Ts("input",{value:t.replace,placeholder:vi(e,"Replace"),"aria-label":vi(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Ts("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Ts("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Ts("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function s(r,a,i){return Ts("button",{class:"cm-button",name:r,onclick:a,type:"button"},i)}this.dom=Ts("div",{onkeydown:r=>this.keydown(r),class:"cm-search"},[this.searchField,s("next",()=>r7(e),[vi(e,"next")]),s("prev",()=>a7(e),[vi(e,"previous")]),s("select",()=>vW(e),[vi(e,"all")]),Ts("label",null,[this.caseField,vi(e,"match case")]),Ts("label",null,[this.reField,vi(e,"regexp")]),Ts("label",null,[this.wordField,vi(e,"by word")]),...e.state.readOnly?[]:[Ts("br"),this.replaceField,s("replace",()=>i7(e),[vi(e,"replace")]),s("replaceAll",()=>OW(e),[vi(e,"replace all")])],Ts("button",{name:"close",onclick:()=>SW(e),"aria-label":vi(e,"close"),type:"button"},["×"])])}commit(){let e=new $E({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:ku.of(e)}))}keydown(e){Bwe(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?a7:r7)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),i7(this.view))}update(e){for(let t of e.transactions)for(let s of t.effects)s.is(ku)&&!s.value.eq(this.query)&&this.setQuery(s.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Sp).top}}function vi(n,e){return n.state.phrase(e)}const w0=30,x0=/[\s\.,:;?!]/;function RE(n,{from:e,to:t}){let s=n.state.doc.lineAt(e),r=n.state.doc.lineAt(t).to,a=Math.max(s.from,e-w0),i=Math.min(r,t+w0),o=n.state.sliceDoc(a,i);if(a!=s.from){for(let l=0;l<w0;l++)if(!x0.test(o[l+1])&&x0.test(o[l])){o=o.slice(l);break}}if(i!=r){for(let l=o.length-1;l>o.length-w0;l--)if(!x0.test(o[l-1])&&x0.test(o[l])){o=o.slice(0,l);break}}return vt.announce.of(`${n.state.phrase("current match")}. ${o} ${n.state.phrase("on line")} ${s.number}.`)}const _Ce=vt.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),RCe=[nu,ui.low(FCe),_Ce];let GS=pq,ICe=class{constructor(n,e,t,s,r,a,i,o,l,c){this.left=n,this.top=e,this.height=t,this.fontFamily=s,this.fontSize=r,this.fontWeight=a,this.color=i,this.className=o,this.letter=l,this.partial=c}draw(){let n=document.createElement("div");return n.className=this.className,this.adjust(n),n}adjust(n){n.style.left=this.left+"px",n.style.top=this.top+"px",n.style.height=this.height+"px",n.style.lineHeight=this.height+"px",n.style.fontFamily=this.fontFamily,n.style.fontSize=this.fontSize,n.style.fontWeight=this.fontWeight,n.style.color=this.partial?"transparent":this.color,n.className=this.className,n.textContent=this.letter}eq(n){return this.left==n.left&&this.top==n.top&&this.height==n.height&&this.fontFamily==n.fontFamily&&this.fontSize==n.fontSize&&this.fontWeight==n.fontWeight&&this.color==n.color&&this.className==n.className&&this.letter==n.letter}},LCe=class{constructor(n,e){this.view=n,this.rangePieces=[],this.cursors=[],this.em=e,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=n.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),n.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let n=GS(this.view.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=n+"ms"}update(n){(n.selectionSet||n.geometryChanged||n.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),QCe(n)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:n}=this.view,e=[];for(let t of n.selection.ranges){let s=t==n.selection.main,r=zCe(this.em,this.view,t,s);r&&e.push(r)}return{cursors:e}}drawSel({cursors:n}){if(n.length!=this.cursors.length||n.some((e,t)=>!e.eq(this.cursors[t]))){let e=this.cursorLayer.children;if(e.length!==n.length){this.cursorLayer.textContent="";for(const t of n)this.cursorLayer.appendChild(t.draw())}else n.forEach((t,s)=>t.adjust(e[s]));this.cursors=n}}destroy(){this.cursorLayer.remove()}};function QCe(n){return GS(n.startState)!=GS(n.state)}const jCe={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}},VCe=ui.highest(vt.theme(jCe));function ZCe(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Ss.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function zCe(n,e,t,s){var r,a;let i=t.head,o=1;(n.$data.count||n.$data.keyChain)&&(o=.5);{let c=i<e.state.doc.length&&e.state.sliceDoc(i,i+1);c&&/[\uDC00-\uDFFF]/.test(c)&&i>1&&(i--,c=e.state.sliceDoc(i,i+1));let u=e.coordsAtPos(i,1);if(!u)return null;let h=ZCe(e),d=e.domAtPos(i),m=d?d.node:e.contentDOM;for(;d&&d.node instanceof HTMLElement;)m=d.node,d={node:d.node.childNodes[d.offset],offset:0};if(!(m instanceof HTMLElement)){if(!m.parentNode)return null;m=m.parentNode}let y=getComputedStyle(m),O=u.left,S=(a=(r=e).coordsForChar)===null||a===void 0?void 0:a.call(r,i);if(S&&(O=S.left),!c||c==`
`||c=="\r")c=" ";else if(c=="	"){c=" ";var l=e.coordsAtPos(i+1,-1);l&&(O=l.left-(l.left-u.left)/parseInt(y.tabSize))}else/[\uD800-\uDBFF]/.test(c)&&i<e.state.doc.length-1&&(c+=e.state.sliceDoc(i+1,i+2));let A=u.bottom-u.top;return new ICe(O-h.left,u.top-h.top+A*(1-o),A*o,y.fontFamily,y.fontSize,y.fontWeight,y.color,s?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",c,o!=1)}}const qCe=vt.theme({".cm-emacsMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"5px 10px",backgroundColor:"#fffa8f",fontFamily:"monospace"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"#fffa8f"}}),UCe=nr.fromClass(class{constructor(n){this.status="",this.view=n,this.em=new nh(n),this.blockCursor=new LCe(n,this.em),this.view.scrollDOM.classList.add("cm-emacsMode")}update(n){n.docChanged&&(this.em.$emacsMark=null,this.em.updateMarksOnChange(n.changes)),this.blockCursor.update(n)}destroy(){this.view.scrollDOM.classList.remove("cm-emacsMode"),this.blockCursor.destroy()}},{eventHandlers:{keydown:function(n,e){var t=this.em.handleKeyboard(n);return t&&this.blockCursor.scheduleRedraw(),!!t},mousedown:function(){this.em.$emacsMark=null}}}),WCe=ln.define(),GCe=Us.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(WCe)&&(n=t.value);return n},provide:n=>Ou.from(n,e=>e?XCe:null)});function XCe(n){let e=document.createElement("div");return e.className="cm-vim-panel",{top:!1,dom:e}}function HCe(n={}){return[qCe,UCe,VCe,GCe]}var YCe={Return:"Return",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"Return",Divide:"/",Slash:"/",Multiply:"*",Subtract:"-",Minus:"-",Equal:"="},KCe={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1};const yx={};class nh{constructor(e){this.view=e,this.$data={count:0,keyChain:"",lastCommand:""},this.$emacsMarkRing=[],this.$emacsMark=null}static bindKey(e,t){e.split("|").forEach(function(s){let r="",a=s.split(/\s+/);a.forEach(function(i,o){let l=i.split(/-(?=.)/),c=l.pop();l.length&&(r+=l.sort().join("-")+"-"),r+=c,o===a.length-1?yx[r]=t:(yx[r]="null",r+=" ")})})}static getKey(e){var t=e.code,s=e.key;if(KCe[s])return["","",""];t.length>1&&(t[0]=="N"&&(t=t.replace(/^Numpad/,"")),t[0]=="K"&&(t=t.replace(/^Key/,""))),t=YCe[t]||t,t.length==1&&(t=t.toLowerCase());var r="";return e.ctrlKey&&(r+="C-"),e.metaKey&&(r+="CMD-"),e.altKey&&(r+="M-"),e.shiftKey&&(r+="S-"),[t,r,s]}static addCommands(e){Object.keys(e).forEach(function(t){var s=e[t];typeof s=="function"&&(s={exec:s}),nh.commands[t]=s})}static execCommand(e,t,s,r=1){var a=void 0;if(r<0&&(r=-r),typeof e=="function")for(var i=0;i<r;i++)e(t.view);else if(e!=="null")if(e.exec){r>1&&e.handlesCount&&(s||(s={}),typeof s=="object"&&(s.count=r),r=1);for(var i=0;i<r;i++)a=e.exec(t,s||{})}else throw new Error("missformed command");return a}handleKeyboard(e){var t=nh.getKey(e),s=this.findCommand(t);if(!(/Up|Down/.test(t==null?void 0:t[0])&&C2e(this.view.state))){if(s&&s.command){var r=nh.execCommand(s.command,this,s.args,s.count);if(r===!1)return}return s}}findCommand([e,t,s]){if(e){var r=this,a=this.$data;if(!t&&e.length==1&&(r.pushEmacsMark(),a.count)){var i=new Array(a.count+1).join(s);return a.count=null,{command:"insertstring",args:i}}if(t=="C-"||a.count){var o=parseInt(e[e.length-1]);if(typeof o=="number"&&!isNaN(o))return a.count=Math.max(a.count||0,0),a.count=10*a.count+o,{command:"null"}}t&&(e=t+e),a.keyChain&&(e=a.keyChain+=" "+e);var l=yx[e];if(a.keyChain=l=="null"?e:"",!!l){if(l==="null")return{command:"null"};if(l==="universalArgument")return a.count=-4,{command:"null"};var c;if(typeof l!="string"&&(c=l.args,l.command&&(l=l.command)),(l==="insertstring"||l===PE||l===jv)&&r.pushEmacsMark(),!(typeof l=="string"&&(l=nh.commands[l],!l))){!l.readOnly&&!l.keepLastCommand&&(a.lastCommand=null);var o=a.count||1;return a.count&&(a.count=0),{command:l,args:c,count:o}}}}}showCommandLine(e){console.error("TODO")}updateMarksOnChange(e){this.$emacsMark&&(this.$emacsMark=this.updateMark(this.$emacsMark,e)),this.$emacsMarkRing=this.$emacsMarkRing.map(t=>this.updateMark(t,e)).filter(Boolean)}updateMark(e,t){if(e){var s=e.map(function(r){return t.mapPos(r,1,mr.TrackDel)}).filter(r=>r!=null);return s.length==0?null:s}}emacsMark(){return this.$emacsMark}setEmacsMark(e){this.$emacsMark=e}pushEmacsMark(e,t){var s=this.$emacsMark;s&&o7(this.$emacsMarkRing,s),!e||t?this.setEmacsMark(e):o7(this.$emacsMarkRing,e)}popEmacsMark(){var e=this.emacsMark();return e?(this.setEmacsMark(null),e):this.$emacsMarkRing.pop()}getLastEmacsMark(){return this.$emacsMark||this.$emacsMarkRing.slice(-1)[0]}getCopyText(){var e=this.view.state;return e.selection.ranges.map(t=>e.sliceDoc(t.from,t.to)).join(`
`)}clearSelection(){var e=this.view,t=e.state.selection,s=!t.ranges.some(a=>a.from!=a.to);if(s)return!1;var r=t.ranges.map(a=>Ve.range(a.head,a.head));return e.dispatch({selection:Ve.create(r,t.mainIndex)}),!0}onPaste(e){var t=this.view,s=t.state.selection,r;if(s.ranges.length>1){var a=e.split(`
`);a.length==s.ranges.length&&(r=a)}var i=0,o=t.state.changeByRange(l=>{var c=r?r[i]:e;return i++,{changes:{from:l.from,to:l.to,insert:c},range:Ve.cursor(l.from+c.length)}});t.dispatch(o)}selectionToEmacsMark(){var e=this.view.state.selection;return e.ranges.map(t=>t.head)}}nh.commands={};function o7(n,e){n.length&&n[n.length-1]+""==e+""||n.push(e)}function JCe(n){var e=n.Pos;function t(x,P,T){if(P.line===T.line&&P.ch>=T.ch-1){var p=x.getLine(P.line),f=p.charCodeAt(P.ch);55296<=f&&f<=55551&&(T.ch+=1)}return{start:P,end:T}}var s=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"g<Up>",type:"keyToKey",toKeys:"gk"},{keys:"g<Down>",type:"keyToKey",toKeys:"gj"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h"},{keys:"<Del>",type:"keyToKey",toKeys:"x"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"keyToKey",toKeys:"i",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"g$",type:"motion",motion:"moveToEndOfDisplayLine"},{keys:"g^",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"g0",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"gn",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!0}},{keys:"gN",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!1}},{keys:"gq",type:"operator",operator:"hardWrap"},{keys:"gw",type:"operator",operator:"hardWrap",operatorArgs:{keepCursor:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-u>",type:"operatorMotion",operator:"delete",motion:"moveToStartOfLine",context:"insert"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"gi",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"lastEdit"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"gI",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"bol"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"gJ",type:"action",action:"joinLines",actionArgs:{keepSpaces:!0},isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<register>",type:"action",action:"replayMacro"},{keys:"q<register>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0},context:"normal"},{keys:"R",type:"operator",operator:"change",operatorArgs:{linewise:!0,fullLine:!0},context:"visual",exitVisualBlock:!0},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<register>",type:"action",action:"setMark"},{keys:'"<register>',type:"action",action:"setRegister"},{keys:"<C-r><register>",type:"action",action:"insertRegister",context:"insert",isEdit:!0},{keys:"<C-o>",type:"action",action:"oneNormalCommand",context:"insert"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<register>",type:"motion",motion:"textObjectManipulation"},{keys:"i<register>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],r=s.length,a=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"omap",shortName:"om"},{name:"noremap",shortName:"no"},{name:"nnoremap",shortName:"nn"},{name:"vnoremap",shortName:"vn"},{name:"inoremap",shortName:"ino"},{name:"onoremap",shortName:"ono"},{name:"unmap"},{name:"mapclear",shortName:"mapc"},{name:"nmapclear",shortName:"nmapc"},{name:"vmapclear",shortName:"vmapc"},{name:"imapclear",shortName:"imapc"},{name:"omapclear",shortName:"omapc"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"startinsert",shortName:"start"},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"vglobal",shortName:"v"},{name:"delete",shortName:"d"},{name:"join",shortName:"j"},{name:"normal",shortName:"norm"},{name:"global",shortName:"g"}],i=qn("");function o(x){x.setOption("disableInput",!0),x.setOption("showCursorWhenSelecting",!1),n.signal(x,"vim-mode-change",{mode:"normal"}),x.on("cursorActivity",Me),De(x),n.on(x.getInputField(),"paste",c(x))}function l(x){x.setOption("disableInput",!1),x.off("cursorActivity",Me),n.off(x.getInputField(),"paste",c(x)),x.state.vim=null,Tr&&clearTimeout(Tr)}function c(x){var P=x.state.vim;return P.onPasteFn||(P.onPasteFn=function(){P.insertMode||(x.setCursor(et(x.getCursor(),0,1)),it.enterInsertMode(x,{},P))}),P.onPasteFn}var u=/[\d]/,h=[n.isWordChar,function(x){return x&&!n.isWordChar(x)&&!/\s/.test(x)}],d=[function(x){return/\S/.test(x)}],m=["<",">"],y=["-",'"',".",":","_","/","+"],O=/^\w$/,S;try{S=new RegExp("^[\\p{Lu}]$","u")}catch{S=/^[A-Z]$/}function A(x,P){return P>=x.firstLine()&&P<=x.lastLine()}function F(x){return/^[a-z]$/.test(x)}function j(x){return"()[]{}".indexOf(x)!=-1}function N(x){return u.test(x)}function $(x){return S.test(x)}function L(x){return/^\s*$/.test(x)}function I(x){return".?!".indexOf(x)!=-1}function q(x,P){for(var T=0;T<P.length;T++)if(P[T]==x)return!0;return!1}var ce={};function ee(x,P,T,p,f){if(P===void 0&&!f)throw Error("defaultValue is required unless callback is provided");if(T||(T="string"),ce[x]={type:T,defaultValue:P,callback:f},p)for(var v=0;v<p.length;v++)ce[p[v]]=ce[x];P&&he(x,P)}function he(x,P,T,p){var f=ce[x];p=p||{};var v=p.scope;if(!f)return new Error("Unknown option: "+x);if(f.type=="boolean"){if(P&&P!==!0)return new Error("Invalid argument: "+x+"="+P);P!==!1&&(P=!0)}f.callback?(v!=="local"&&f.callback(P,void 0),v!=="global"&&T&&f.callback(P,T)):(v!=="local"&&(f.value=f.type=="boolean"?!!P:P),v!=="global"&&T&&(T.state.vim.options[x]={value:P}))}function H(x,P,T){var p=ce[x];T=T||{};var f=T.scope;if(!p)return new Error("Unknown option: "+x);if(p.callback){let v=P&&p.callback(void 0,P);return f!=="global"&&v!==void 0?v:f!=="local"?p.callback():void 0}else return(f!=="global"&&P&&P.state.vim.options[x]||f!=="local"&&p||{}).value}ee("filetype",void 0,"string",["ft"],function(x,P){if(P!==void 0)if(x===void 0){let T=P.getOption("mode");return T=="null"?"":T}else{let T=x==""?"null":x;P.setOption("mode",T)}}),ee("textwidth",80,"number",["tw"],function(x,P){if(P!==void 0)if(x===void 0){var T=P.getOption("textwidth");return T}else{var p=Math.round(x);p>1&&P.setOption("textwidth",p)}});var me=function(){var x=100,P=-1,T=0,p=0,f=new Array(x);function v(D,Q,z){var W=P%x,G=f[W];function X(de){var pe=++P%x,ye=f[pe];ye&&ye.clear(),f[pe]=D.setBookmark(de)}if(G){var re=G.find();re&&!Pt(re,Q)&&X(Q)}else X(Q);X(z),T=P,p=P-x+1,p<0&&(p=0)}function C(D,Q){P+=Q,P>T?P=T:P<p&&(P=p);var z=f[(x+P)%x];if(z&&!z.find()){var W=Q>0?1:-1,G,X=D.getCursor();do if(P+=W,z=f[(x+P)%x],z&&(G=z.find())&&!Pt(X,G))break;while(P<T&&P>p)}return z}function E(D,Q){var z=P,W=C(D,Q);return P=z,W&&W.find()}return{cachedCursor:void 0,add:v,find:E,move:C}},Oe=function(x){return x?{changes:x.changes,expectCursorActivityForChange:x.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};class Pe{constructor(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=Oe()}exitMacroRecordMode(){var P=Se.macroModeState;P.onRecordingDone&&P.onRecordingDone(),P.onRecordingDone=void 0,P.isRecording=!1}enterMacroRecordMode(P,T){var p=Se.registerController.getRegister(T);if(p){if(p.clear(),this.latestRegister=T,P.openDialog){var f=Or("span",{class:"cm-vim-message"},"recording @"+T);this.onRecordingDone=P.openDialog(f,null,{bottom:!0})}this.isRecording=!0}}}function De(x){return x.state.vim||(x.state.vim={inputState:new cn,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeReturn:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{},expectLiteralNext:!1}),x.state.vim}var Se;function ae(){Se={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:me(),macroModeState:new Pe,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new Wn({}),searchHistoryController:new bn,exCommandHistoryController:new bn};for(var x in ce){var P=ce[x];P.value=P.defaultValue}}var Ee,Qe={enterVimMode:o,leaveVimMode:l,buildKeyMap:function(){},getRegisterController:function(){return Se.registerController},resetVimGlobalState_:ae,getVimGlobalState_:function(){return Se},maybeInitVimState_:De,suppressErrorLogging:!1,InsertModeKey:zt,map:function(x,P,T){fe.map(x,P,T)},unmap:function(x,P){return fe.unmap(x,P)},noremap:function(x,P,T){fe.map(x,P,T,!0)},mapclear:function(x){var P=s.length,T=r,p=s.slice(0,P-T);if(s=s.slice(P-T),x)for(var f=p.length-1;f>=0;f--){var v=p[f];if(x!==v.context)if(v.context)this._mapCommand(v);else{var C=["normal","insert","visual"];for(var E in C)if(C[E]!==x){var D=Object.assign({},v);D.context=C[E],this._mapCommand(D)}}}},langmap:On,vimKeyFromEvent:gn,setOption:he,getOption:H,defineOption:ee,defineEx:function(x,P,T){if(!P)P=x;else if(x.indexOf(P)!==0)throw new Error('(Vim.defineEx) "'+P+'" is not a prefix of "'+x+'", command not registered');Ae[x]=T,fe.commandMap_[P]={name:x,shortName:P,type:"api"}},handleKey:function(x,P,T){var p=this.findKey(x,P,T);if(typeof p=="function")return p()},multiSelectHandleKey:Ps,findKey:function(x,P,T){var p=De(x),f=x;function v(){var z=Se.macroModeState;if(z.isRecording){if(P=="q")return z.exitMacroRecordMode(),un(f),!0;T!="mapping"&&at(z,P)}}function C(){if(P=="<Esc>"){if(p.visualMode)be(f);else if(p.insertMode)Ze(f);else return;return un(f),!0}}function E(){if(C())return!0;p.inputState.keyBuffer.push(P);var z=p.inputState.keyBuffer.join(""),W=P.length==1,G=rt.matchCommand(z,s,p.inputState,"insert"),X=p.inputState.changeQueue;if(G.type=="none")return un(f),!1;if(G.type=="partial"){if(G.expectLiteralNext&&(p.expectLiteralNext=!0),Ee&&window.clearTimeout(Ee),Ee=W&&window.setTimeout(function(){p.insertMode&&p.inputState.keyBuffer.length&&un(f)},H("insertModeEscKeysTimeout")),W){var re=f.listSelections();(!X||X.removed.length!=re.length)&&(X=p.inputState.changeQueue=new Rt),X.inserted+=P;for(var de=0;de<re.length;de++){var pe=xn(re[de].anchor,re[de].head),ye=st(re[de].anchor,re[de].head),Ce=f.getRange(pe,f.state.overwrite?et(ye,0,1):ye);X.removed[de]=(X.removed[de]||"")+Ce}}return!W}if(p.expectLiteralNext=!1,Ee&&window.clearTimeout(Ee),G.command&&X){for(var re=f.listSelections(),de=0;de<re.length;de++){var Be=re[de].head;f.replaceRange(X.removed[de]||"",et(Be,0,-X.inserted.length),Be,"+input")}Se.macroModeState.lastInsertModeChanges.changes.pop()}return G.command||un(f),G.command}function D(){if(v()||C())return!0;p.inputState.keyBuffer.push(P);var z=p.inputState.keyBuffer.join("");if(/^[1-9]\d*$/.test(z))return!0;var W=/^(\d*)(.*)$/.exec(z);if(!W)return un(f),!1;var G=p.visualMode?"visual":"normal",X=W[2]||W[1];p.inputState.operatorShortcut&&p.inputState.operatorShortcut.slice(-1)==X&&(X=p.inputState.operatorShortcut);var re=rt.matchCommand(X,s,p.inputState,G);return re.type=="none"?(un(f),!1):re.type=="partial"?(re.expectLiteralNext&&(p.expectLiteralNext=!0),!0):re.type=="clear"?(un(f),!0):(p.expectLiteralNext=!1,p.inputState.keyBuffer.length=0,W=/^(\d*)(.*)$/.exec(z),W&&W[1]&&W[1]!="0"&&p.inputState.pushRepeatDigit(W[1]),re.command)}var Q;return p.insertMode?Q=E():Q=D(),Q===!1?!p.insertMode&&P.length===1?function(){return!0}:void 0:Q===!0?function(){return!0}:function(){return f.operation(function(){f.curOp.isVimOp=!0;try{Q.type=="keyToKey"?Xe(f,Q.toKeys,Q):rt.processCommand(f,p,Q)}catch(z){throw f.state.vim=void 0,De(f),Qe.suppressErrorLogging||console.log(z),z}return!0})}},handleEx:function(x,P){fe.processCommand(x,P)},defineMotion:pt,defineAction:Ft,defineOperator:_n,mapCommand:Ne,_mapCommand:Te,defineRegister:Un,exitVisualMode:be,exitInsertMode:Ze},Ke=[],ge=!1,Ye;function yt(x){if(x[0]=="<"){var P=x.toLowerCase().slice(1,-1),T=P.split("-");if(P=T.pop()||"",P=="lt")x="<";else if(P=="space")x=" ";else if(P=="cr")x=`
`;else if(Et[P]){var p=Ye.value,f={key:Et[P],target:{value:p,selectionEnd:p.length,selectionStart:p.length}};Ye.onKeyDown&&Ye.onKeyDown(f,Ye.value,C),Ye&&Ye.onKeyUp&&Ye.onKeyUp(f,Ye.value,C);return}}if(x==`
`){var v=Ye;Ye=null,v.onClose&&v.onClose(v.value)}else Ye.value=(Ye.value||"")+x;function C(E){typeof E=="string"?Ye.value=E:Ye=null}}function Xe(x,P,T){var p=ge;if(T){if(Ke.indexOf(T)!=-1)return;Ke.push(T),ge=T.noremap!=!1}try{for(var f=De(x),v=/<(?:[CSMA]-)*\w+>|./gi,C;C=v.exec(P);){var E=C[0],D=f.insertMode;if(Ye){yt(E);continue}var Q=Qe.handleKey(x,E,"mapping");if(!Q&&D&&f.insertMode){if(E[0]=="<"){var z=E.toLowerCase().slice(1,-1),W=z.split("-");if(z=W.pop()||"",z=="lt")E="<";else if(z=="space")E=" ";else if(z=="cr")E=`
`;else if(Et.hasOwnProperty(z)){E=Et[z],Bn(x,E);continue}else E=E[0],v.lastIndex=C.index+1}x.replaceSelection(E)}}}finally{if(Ke.pop(),ge=Ke.length?p:!1,!Ke.length&&Ye){var G=Ye;Ye=null,fn(x,G)}}}var Ge={Return:"CR",Backspace:"BS",Delete:"Del",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"CR"," ":"Space"},Ct={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1,AltGraph:1,Dead:1,Unidentified:1},Et={};"Left|Right|Up|Down|End|Home".split("|").concat(Object.keys(Ge)).forEach(function(x){Et[(Ge[x]||"").toLowerCase()]=Et[x.toLowerCase()]=x});function gn(x,P){var v;var T=x.key;if(!Ct[T]){T.length>1&&T[0]=="n"&&(T=T.replace("Numpad","")),T=Ge[T]||T;var p="";if(x.ctrlKey&&(p+="C-"),x.altKey&&(p+="A-"),x.metaKey&&(p+="M-"),n.isMac&&x.altKey&&!x.metaKey&&!x.ctrlKey&&(p=p.slice(2)),(p||T.length>1)&&x.shiftKey&&(p+="S-"),P&&!P.expectLiteralNext&&T.length==1){if(i.keymap&&T in i.keymap)(i.remapCtrl!=!1||!p)&&(T=i.keymap[T]);else if(T.charCodeAt(0)>255){var f=((v=x.code)==null?void 0:v.slice(-1))||"";x.shiftKey||(f=f.toLowerCase()),f&&(T=f)}}return p+=T,p.length>1&&(p="<"+p+">"),p}}function On(x,P){i.string!==x&&(i=qn(x)),i.remapCtrl=P}function qn(x){let P={};if(!x)return{keymap:P,string:""};function T(p){return p.split(/\\?(.)/).filter(Boolean)}return x.split(/((?:[^\\,]|\\.)+),/).map(p=>{if(!p)return;const f=p.split(/((?:[^\\;]|\\.)+);/);if(f.length==3){const v=T(f[1]),C=T(f[2]);if(v.length!==C.length)return;for(let E=0;E<v.length;++E)P[v[E]]=C[E]}else if(f.length==1){const v=T(p);if(v.length%2!==0)return;for(let C=0;C<v.length;C+=2)P[v[C]]=v[C+1]}}),{keymap:P,string:x}}ee("langmap",void 0,"string",["lmap"],function(x,P){if(x===void 0)return i.string;On(x)});class cn{constructor(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null,this.changeQueue=null}pushRepeatDigit(P){this.operator?this.motionRepeat=this.motionRepeat.concat(P):this.prefixRepeat=this.prefixRepeat.concat(P)}getRepeat(){var P=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(P=1,this.prefixRepeat.length>0&&(P*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(P*=parseInt(this.motionRepeat.join(""),10))),P}}function un(x,P){x.state.vim.inputState=new cn,x.state.vim.expectLiteralNext=!1,n.signal(x,"vim-command-done",P)}function Rt(){this.removed=[],this.inserted=""}class Kt{constructor(P,T,p){this.clear(),this.keyBuffer=[P||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!T,this.blockwise=!!p}setText(P,T,p){this.keyBuffer=[P||""],this.linewise=!!T,this.blockwise=!!p}pushText(P,T){T&&(this.linewise||this.keyBuffer.push(`
`),this.linewise=!0),this.keyBuffer.push(P)}pushInsertModeChanges(P){this.insertModeChanges.push(Oe(P))}pushSearchQuery(P){this.searchQueries.push(P)}clear(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1}toString(){return this.keyBuffer.join("")}}function Un(x,P){var T=Se.registerController.registers;if(!x||x.length!=1)throw Error("Register name must be 1 character");if(T[x])throw Error("Register already defined "+x);T[x]=P,y.push(x)}class Wn{constructor(P){this.registers=P,this.unnamedRegister=P['"']=new Kt,P["."]=new Kt,P[":"]=new Kt,P["/"]=new Kt,P["+"]=new Kt}pushText(P,T,p,f,v){if(P!=="_"){f&&p.charAt(p.length-1)!==`
`&&(p+=`
`);var C=this.isValidRegister(P)?this.getRegister(P):null;if(!C){switch(T){case"yank":this.registers[0]=new Kt(p,f,v);break;case"delete":case"change":p.indexOf(`
`)==-1?this.registers["-"]=new Kt(p,f):(this.shiftNumericRegisters_(),this.registers[1]=new Kt(p,f));break}this.unnamedRegister.setText(p,f,v);return}var E=$(P);E?C.pushText(p,f):C.setText(p,f,v),P==="+"&&navigator.clipboard.writeText(p),this.unnamedRegister.setText(C.toString(),f)}}getRegister(P){return this.isValidRegister(P)?(P=P.toLowerCase(),this.registers[P]||(this.registers[P]=new Kt),this.registers[P]):this.unnamedRegister}isValidRegister(P){return P&&(q(P,y)||O.test(P))}shiftNumericRegisters_(){for(var P=9;P>=2;P--)this.registers[P]=this.getRegister(""+(P-1))}}class bn{constructor(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}nextMatch(P,T){var p=this.historyBuffer,f=T?-1:1;this.initialPrefix===null&&(this.initialPrefix=P);for(var v=this.iterator+f;T?v>=0:v<p.length;v+=f)for(var C=p[v],E=0;E<=C.length;E++)if(this.initialPrefix==C.substring(0,E))return this.iterator=v,C;if(v>=p.length)return this.iterator=p.length,this.initialPrefix;if(v<0)return P}pushInput(P){var T=this.historyBuffer.indexOf(P);T>-1&&this.historyBuffer.splice(T,1),P.length&&this.historyBuffer.push(P)}reset(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}}var rt={matchCommand:function(x,P,T,p){var f=is(x,P,p,T);if(!f.full&&!f.partial)return{type:"none"};if(!f.full&&f.partial)return{type:"partial",expectLiteralNext:f.partial.length==1&&f.partial[0].keys.slice(-11)=="<character>"};for(var v,C=0;C<f.full.length;C++){var E=f.full[C];v||(v=E)}if(v.keys.slice(-11)=="<character>"||v.keys.slice(-10)=="<register>"){var D=Dn(x);if(!D||D.length>1)return{type:"clear"};T.selectedCharacter=D}return{type:"full",command:v}},processCommand:function(x,P,T){switch(P.inputState.repeatOverride=T.repeatOverride,T.type){case"motion":this.processMotion(x,P,T);break;case"operator":this.processOperator(x,P,T);break;case"operatorMotion":this.processOperatorMotion(x,P,T);break;case"action":this.processAction(x,P,T);break;case"search":this.processSearch(x,P,T);break;case"ex":case"keyToEx":this.processEx(x,P,T);break}},processMotion:function(x,P,T){P.inputState.motion=T.motion,P.inputState.motionArgs=Lt(T.motionArgs),this.evalInput(x,P)},processOperator:function(x,P,T){var p=P.inputState;if(p.operator)if(p.operator==T.operator){p.motion="expandToLine",p.motionArgs={linewise:!0,repeat:1},this.evalInput(x,P);return}else un(x);p.operator=T.operator,p.operatorArgs=Lt(T.operatorArgs),T.keys.length>1&&(p.operatorShortcut=T.keys),T.exitVisualBlock&&(P.visualBlock=!1,Y(x)),P.visualMode&&this.evalInput(x,P)},processOperatorMotion:function(x,P,T){var p=P.visualMode,f=Lt(T.operatorMotionArgs);f&&p&&f.visualLine&&(P.visualLine=!0),this.processOperator(x,P,T),p||this.processMotion(x,P,T)},processAction:function(x,P,T){var p=P.inputState,f=p.getRepeat(),v=!!f,C=Lt(T.actionArgs)||{repeat:1};p.selectedCharacter&&(C.selectedCharacter=p.selectedCharacter),T.operator&&this.processOperator(x,P,T),T.motion&&this.processMotion(x,P,T),(T.motion||T.operator)&&this.evalInput(x,P),C.repeat=f||1,C.repeatIsExplicit=v,C.registerName=p.registerName,un(x),P.lastMotion=null,T.isEdit&&this.recordLastEdit(P,p,T),it[T.action](x,C,P)},processSearch:function(x,P,T){if(!x.getSearchCursor)return;var p=T.searchArgs.forward,f=T.searchArgs.wholeWordOnly;Ks(x).setReversed(!p);var v=p?"/":"?",C=Ks(x).getQuery(),E=x.getScrollInfo();function D(de,pe,ye){Se.searchHistoryController.pushInput(de),Se.searchHistoryController.reset();try{Kr(x,de,pe,ye)}catch{Tn(x,"Invalid regex: "+de),un(x);return}rt.processMotion(x,P,{keys:"",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:T.searchArgs.toJumplist}})}function Q(de){x.scrollTo(E.left,E.top),D(de,!0,!0);var pe=Se.macroModeState;pe.isRecording&&Ue(pe,de)}function z(de,pe,ye){var Ce=gn(de),Be,je;Ce=="<Up>"||Ce=="<Down>"?(Be=Ce=="<Up>",je=de.target?de.target.selectionEnd:0,pe=Se.searchHistoryController.nextMatch(pe,Be)||"",ye(pe),je&&de.target&&(de.target.selectionEnd=de.target.selectionStart=Math.min(je,de.target.value.length))):Ce&&Ce!="<Left>"&&Ce!="<Right>"&&Se.searchHistoryController.reset();var Ie;try{Ie=Kr(x,pe,!0,!0)}catch{}Ie?x.scrollIntoView(pa(x,!p,Ie),30):(J(x),x.scrollTo(E.left,E.top))}function W(de,pe,ye){var Ce=gn(de);Ce=="<Esc>"||Ce=="<C-c>"||Ce=="<C-[>"||Ce=="<BS>"&&pe==""?(Se.searchHistoryController.pushInput(pe),Se.searchHistoryController.reset(),Kr(x,C),J(x),x.scrollTo(E.left,E.top),n.e_stop(de),un(x),ye(),x.focus()):Ce=="<Up>"||Ce=="<Down>"?n.e_stop(de):Ce=="<C-u>"&&(n.e_stop(de),ye(""))}switch(T.searchArgs.querySrc){case"prompt":var G=Se.macroModeState;if(G.isPlaying){let pe=G.replaySearchQueries.shift();D(pe,!0,!1)}else fn(x,{onClose:Q,prefix:v,desc:"(JavaScript regexp)",onKeyUp:z,onKeyDown:W});break;case"wordUnderCursor":var X=on(x,{noSymbol:!0}),re=!0;if(X||(X=on(x,{noSymbol:!1}),re=!1),!X){Tn(x,"No word under cursor"),un(x);return}let de=x.getLine(X.start.line).substring(X.start.ch,X.end.ch);re&&f?de="\\b"+de+"\\b":de=Vn(de),Se.jumpList.cachedCursor=x.getCursor(),x.setCursor(X.start),D(de,!0,!1);break}},processEx:function(x,P,T){function p(v){Se.exCommandHistoryController.pushInput(v),Se.exCommandHistoryController.reset(),fe.processCommand(x,v),x.state.vim&&un(x)}function f(v,C,E){var D=gn(v),Q,z;(D=="<Esc>"||D=="<C-c>"||D=="<C-[>"||D=="<BS>"&&C=="")&&(Se.exCommandHistoryController.pushInput(C),Se.exCommandHistoryController.reset(),n.e_stop(v),un(x),E(),x.focus()),D=="<Up>"||D=="<Down>"?(n.e_stop(v),Q=D=="<Up>",z=v.target?v.target.selectionEnd:0,C=Se.exCommandHistoryController.nextMatch(C,Q)||"",E(C),z&&v.target&&(v.target.selectionEnd=v.target.selectionStart=Math.min(z,v.target.value.length))):D=="<C-u>"?(n.e_stop(v),E("")):D&&D!="<Left>"&&D!="<Right>"&&Se.exCommandHistoryController.reset()}T.type=="keyToEx"?fe.processCommand(x,T.exArgs.input):P.visualMode?fn(x,{onClose:p,prefix:":",value:"'<,'>",onKeyDown:f,selectValueOnOpen:!1}):fn(x,{onClose:p,prefix:":",onKeyDown:f})},evalInput:function(x,P){var T=P.inputState,p=T.motion,f=T.motionArgs||{repeat:1},v=T.operator,C=T.operatorArgs||{},E=T.registerName,D=P.sel,Q=Wt(P.visualMode?_e(x,D.head):x.getCursor("head")),z=Wt(P.visualMode?_e(x,D.anchor):x.getCursor("anchor")),W=Wt(Q),G=Wt(z),X,re,de;if(v&&this.recordLastEdit(P,T),T.repeatOverride!==void 0?de=T.repeatOverride:de=T.getRepeat(),de>0&&f.explicitRepeat?f.repeatIsExplicit=!0:(f.noRepeat||!f.explicitRepeat&&de===0)&&(de=1,f.repeatIsExplicit=!1),T.selectedCharacter&&(f.selectedCharacter=C.selectedCharacter=T.selectedCharacter),f.repeat=de,un(x),p){var pe=Pn[p](x,Q,f,P,T);if(P.lastMotion=Pn[p],!pe)return;if(f.toJumplist){var ye=Se.jumpList,Ce=ye.cachedCursor;Ce?(Is(x,Ce,pe),delete ye.cachedCursor):Is(x,Q,pe)}pe instanceof Array?(re=pe[0],X=pe[1]):X=pe,X||(X=Wt(Q)),P.visualMode?(P.visualBlock&&X.ch===1/0||(X=_e(x,X,W)),re&&(re=_e(x,re)),re=re||G,D.anchor=re,D.head=X,Y(x),Ls(x,P,"<",$t(re,X)?re:X),Ls(x,P,">",$t(re,X)?X:re)):v||(X=_e(x,X,W),x.setCursor(X.line,X.ch))}if(v){if(C.lastSel){re=G;var Be=C.lastSel,je=Math.abs(Be.head.line-Be.anchor.line),Ie=Math.abs(Be.head.ch-Be.anchor.ch);Be.visualLine?X=new e(G.line+je,G.ch):Be.visualBlock?X=new e(G.line+je,G.ch+Ie):Be.head.line==Be.anchor.line?X=new e(G.line,G.ch+Ie):X=new e(G.line+je,G.ch),P.visualMode=!0,P.visualLine=Be.visualLine,P.visualBlock=Be.visualBlock,D=P.sel={anchor:re,head:X},Y(x)}else P.visualMode&&(C.lastSel={anchor:Wt(D.anchor),head:Wt(D.head),visualBlock:P.visualBlock,visualLine:P.visualLine});var nt,Nt,ht,Ot,Ut;if(P.visualMode){nt=xn(D.head,D.anchor),Nt=st(D.head,D.anchor),ht=P.visualLine||C.linewise,Ot=P.visualBlock?"block":ht?"line":"char";var Ht=t(x,nt,Nt);if(Ut=se(x,{anchor:Ht.start,head:Ht.end},Ot),ht){var ct=Ut.ranges;if(Ot=="block")for(var dn=0;dn<ct.length;dn++)ct[dn].head.ch=an(x,ct[dn].head.line);else Ot=="line"&&(ct[0].head=new e(ct[0].head.line+1,0))}}else{if(nt=Wt(re||G),Nt=Wt(X||W),$t(Nt,nt)){var Gn=nt;nt=Nt,Nt=Gn}ht=f.linewise||C.linewise,ht?Re(x,nt,Nt):f.forward&&$e(x,nt,Nt),Ot="char";var An=!f.inclusive||ht,Ht=t(x,nt,Nt);Ut=se(x,{anchor:Ht.start,head:Ht.end},Ot,An)}x.setSelections(Ut.ranges,Ut.primary),P.lastMotion=null,C.repeat=de,C.registerName=E,C.linewise=ht;var Rn=Zt[v](x,C,Ut.ranges,G,X);P.visualMode&&be(x,Rn!=null),Rn&&x.setCursor(Rn)}},recordLastEdit:function(x,P,T){var p=Se.macroModeState;p.isPlaying||(x.lastEditInputState=P,x.lastEditActionCommand=T,p.lastInsertModeChanges.changes=[],p.lastInsertModeChanges.expectCursorActivityForChange=!1,p.lastInsertModeChanges.visualBlock=x.visualBlock?x.sel.head.line-x.sel.anchor.line:0)}},Pn={moveToTopLine:function(x,P,T){var p=M(x).top+T.repeat-1;return new e(p,ut(x.getLine(p)))},moveToMiddleLine:function(x){var P=M(x),T=Math.floor((P.top+P.bottom)*.5);return new e(T,ut(x.getLine(T)))},moveToBottomLine:function(x,P,T){var p=M(x).bottom-T.repeat+1;return new e(p,ut(x.getLine(p)))},expandToLine:function(x,P,T){var p=P;return new e(p.line+T.repeat-1,1/0)},findNext:function(x,P,T){var p=Ks(x),f=p.getQuery();if(f){var v=!T.forward;return v=p.isReversed()?!v:v,wo(x,f),pa(x,v,f,T.repeat)}},findAndSelectNextInclusive:function(x,P,T,p,f){var v=Ks(x),C=v.getQuery();if(C){var E=!T.forward;E=v.isReversed()?!E:E;var D=K(x,E,C,T.repeat,p);if(D){if(f.operator)return D;var Q=D[0],z=new e(D[1].line,D[1].ch-1);if(p.visualMode){(p.visualLine||p.visualBlock)&&(p.visualLine=!1,p.visualBlock=!1,n.signal(x,"vim-mode-change",{mode:"visual",subMode:""}));var W=p.sel.anchor;if(W)return v.isReversed()?T.forward?[W,Q]:[W,z]:T.forward?[W,z]:[W,Q]}else p.visualMode=!0,p.visualLine=!1,p.visualBlock=!1,n.signal(x,"vim-mode-change",{mode:"visual",subMode:""});return E?[z,Q]:[Q,z]}}},goToMark:function(x,P,T,p){var f=ue(x,p,T.selectedCharacter||"");return f?T.linewise?{line:f.line,ch:ut(x.getLine(f.line))}:f:null},moveToOtherHighlightedEnd:function(x,P,T,p){if(p.visualBlock&&T.sameLine){var f=p.sel;return[_e(x,new e(f.anchor.line,f.head.ch)),_e(x,new e(f.head.line,f.anchor.ch))]}else return[p.sel.head,p.sel.anchor]},jumpToMark:function(x,P,T,p){for(var f=P,v=0;v<T.repeat;v++){var C=f;for(var E in p.marks)if(F(E)){var D=p.marks[E].find(),Q=T.forward?$t(D,C):$t(C,D);if(!Q&&!(T.linewise&&D.line==C.line)){var z=Pt(C,f),W=T.forward?Gt(C,D,f):Gt(f,D,C);(z||W)&&(f=D)}}}return T.linewise&&(f=new e(f.line,ut(x.getLine(f.line)))),f},moveByCharacters:function(x,P,T){var p=P,f=T.repeat,v=T.forward?p.ch+f:p.ch-f;return new e(p.line,v)},moveByLines:function(x,P,T,p){var f=P,v=f.ch;switch(p.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:v=p.lastHPos;break;default:p.lastHPos=v}var C=T.repeat+(T.repeatOffset||0),E=T.forward?f.line+C:f.line-C,D=x.firstLine(),Q=x.lastLine(),z=x.findPosV(f,T.forward?C:-C,"line",p.lastHSPos),W=T.forward?z.line>E:z.line<E;return W&&(E=z.line,v=z.ch),E<D&&f.line==D?this.moveToStartOfLine(x,P,T,p):E>Q&&f.line==Q?Gr(x,P,T,p,!0):(T.toFirstChar&&(v=ut(x.getLine(E)),p.lastHPos=v),p.lastHSPos=x.charCoords(new e(E,v),"div").left,new e(E,v))},moveByDisplayLines:function(x,P,T,p){var f=P;switch(p.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:p.lastHSPos=x.charCoords(f,"div").left}var v=T.repeat,C=x.findPosV(f,T.forward?v:-v,"line",p.lastHSPos);if(C.hitSide)if(T.forward){var E=x.charCoords(C,"div"),D={top:E.top+8,left:p.lastHSPos};C=x.coordsChar(D,"div")}else{var Q=x.charCoords(new e(x.firstLine(),0),"div");Q.left=p.lastHSPos,C=x.coordsChar(Q,"div")}return p.lastHPos=C.ch,C},moveByPage:function(x,P,T){var p=P,f=T.repeat;return x.findPosV(p,T.forward?f:-f,"page")},moveByParagraph:function(x,P,T){var p=T.forward?1:-1;return Dr(x,P,T.repeat,p).start},moveBySentence:function(x,P,T){var p=T.forward?1:-1;return Ni(x,P,T.repeat,p)},moveByScroll:function(x,P,T,p){var f=x.getScrollInfo(),v=null,C=T.repeat;C||(C=f.clientHeight/(2*x.defaultTextHeight()));var E=x.charCoords(P,"local");if(T.repeat=C,v=Pn.moveByDisplayLines(x,P,T,p),!v)return null;var D=x.charCoords(v,"local");return x.scrollTo(null,f.top+D.top-E.top),v},moveByWords:function(x,P,T){return $i(x,P,T.repeat,!!T.forward,!!T.wordEnd,!!T.bigWord)},moveTillCharacter:function(x,P,T){var p=T.repeat,f=hi(x,p,T.forward,T.selectedCharacter,P),v=T.forward?-1:1;return mn(v,T),f?(f.ch+=v,f):null},moveToCharacter:function(x,P,T){var p=T.repeat;return mn(0,T),hi(x,p,T.forward,T.selectedCharacter,P)||P},moveToSymbol:function(x,P,T){var p=T.repeat;return T.selectedCharacter&&ps(x,p,T.forward,T.selectedCharacter)||P},moveToColumn:function(x,P,T,p){var f=T.repeat;return p.lastHPos=f-1,p.lastHSPos=x.charCoords(P,"div").left,di(x,f)},moveToEol:function(x,P,T,p){return Gr(x,P,T,p,!1)},moveToFirstNonWhiteSpaceCharacter:function(x,P){var T=P;return new e(T.line,ut(x.getLine(T.line)))},moveToMatchedSymbol:function(x,P){for(var T=P,p=T.line,f=T.ch,v=x.getLine(p),C;f<v.length;f++)if(C=v.charAt(f),C&&j(C)){var E=x.getTokenTypeAt(new e(p,f+1));if(E!=="string"&&E!=="comment")break}if(f<v.length){var D=C==="<"||C===">"?/[(){}[\]<>]/:/[(){}[\]]/,Q=x.findMatchingBracket(new e(p,f),{bracketRegex:D});return Q.to}else return T},moveToStartOfLine:function(x,P){return new e(P.line,0)},moveToLineOrEdgeOfDocument:function(x,P,T){var p=T.forward?x.lastLine():x.firstLine();return T.repeatIsExplicit&&(p=T.repeat-x.getOption("firstLineNumber")),new e(p,ut(x.getLine(p)))},moveToStartOfDisplayLine:function(x){return x.execCommand("goLineLeft"),x.getCursor()},moveToEndOfDisplayLine:function(x){x.execCommand("goLineRight");var P=x.getCursor();return P.sticky=="before"&&P.ch--,P},textObjectManipulation:function(x,P,T,p){var f={"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"},v={"'":!0,'"':!0,"`":!0},C=T.selectedCharacter||"";C=="b"?C="(":C=="B"&&(C="{");var E=!T.textObjectInner,D,Q;if(f[C]){if(Q=!0,D=Xr(x,P,C,E),!D){var z=x.getSearchCursor(new RegExp("\\"+C,"g"),P);z.find()&&(D=Xr(x,z.from(),C,E))}}else if(v[C])Q=!0,D=Ul(x,P,C,E);else if(C==="W"||C==="w")for(var W=T.repeat||1;W-- >0;){var G=on(x,{inclusive:E,innerWord:!E,bigWord:C==="W",noSymbol:C==="W",multiline:!0},D&&D.end);G&&(D||(D=G),D.end=G.end)}else if(C==="p")if(D=Dr(x,P,T.repeat,0,E),T.linewise=!0,p.visualMode)p.visualLine||(p.visualLine=!0);else{var X=p.inputState.operatorArgs;X&&(X.linewise=!0),D.end.line--}else if(C==="t")D=Yn(x,P,E);else if(C==="s"){var re=x.getLine(P.line);P.ch>0&&I(re[P.ch])&&(P.ch-=1);var de=nl(x,P,T.repeat,1,E),pe=nl(x,P,T.repeat,-1,E);L(x.getLine(pe.line)[pe.ch])&&L(x.getLine(de.line)[de.ch-1])&&(pe={line:pe.line,ch:pe.ch+1}),D={start:pe,end:de}}return D?x.state.vim.visualMode?Z(x,D.start,D.end,Q):[D.start,D.end]:null},repeatLastCharacterSearch:function(x,P,T){var p=Se.lastCharacterSearch,f=T.repeat,v=T.forward===p.forward,C=(p.increment?1:0)*(v?-1:1);x.moveH(-C,"char"),T.inclusive=!!v;var E=hi(x,f,v,p.selectedCharacter);return E?(E.ch+=C,E):(x.moveH(C,"char"),P)}};function pt(x,P){Pn[x]=P}function Vt(x,P){for(var T=[],p=0;p<P;p++)T.push(x);return T}var Zt={change:function(x,P,T){var p,f,v=x.state.vim,C=T[0].anchor,E=T[0].head;if(v.visualMode)if(P.fullLine)E.ch=Number.MAX_VALUE,E.line--,x.setSelection(C,E),f=x.getSelection(),x.replaceSelection(""),p=C;else{f=x.getSelection();var D=Vt("",T.length);x.replaceSelections(D),p=xn(T[0].head,T[0].anchor)}else{f=x.getRange(C,E);var Q=v.lastEditInputState;if((Q==null?void 0:Q.motion)=="moveByWords"&&!L(f)){var z=/\s+$/.exec(f);z&&Q.motionArgs&&Q.motionArgs.forward&&(E=et(E,0,-z[0].length),f=f.slice(0,-z[0].length))}P.linewise&&(C=new e(C.line,ut(x.getLine(C.line))),E.line>C.line&&(E=new e(E.line-1,Number.MAX_VALUE))),x.replaceRange("",C,E),p=C}Se.registerController.pushText(P.registerName,"change",f,P.linewise,T.length>1),it.enterInsertMode(x,{head:p},x.state.vim)},delete:function(x,P,T){var p,f,v=x.state.vim;if(v.visualBlock){f=x.getSelection();var C=Vt("",T.length);x.replaceSelections(C),p=xn(T[0].head,T[0].anchor)}else{var E=T[0].anchor,D=T[0].head;P.linewise&&D.line!=x.firstLine()&&E.line==x.lastLine()&&E.line==D.line-1&&(E.line==x.firstLine()?E.ch=0:E=new e(E.line-1,an(x,E.line-1))),f=x.getRange(E,D),x.replaceRange("",E,D),p=E,P.linewise&&(p=Pn.moveToFirstNonWhiteSpaceCharacter(x,E))}return Se.registerController.pushText(P.registerName,"delete",f,P.linewise,v.visualBlock),_e(x,p)},indent:function(x,P,T){var p=x.state.vim,f=p.visualMode?P.repeat||0:1;if(x.indentMore)for(var v=0;v<f;v++)P.indentRight?x.indentMore():x.indentLess();else{var C=T[0].anchor.line,E=p.visualBlock?T[T.length-1].anchor.line:T[0].head.line;P.linewise&&E--;for(var D=C;D<=E;D++)for(var v=0;v<f;v++)x.indentLine(D,P.indentRight)}return Pn.moveToFirstNonWhiteSpaceCharacter(x,T[0].anchor)},indentAuto:function(x,P,T){return x.execCommand("indentAuto"),Pn.moveToFirstNonWhiteSpaceCharacter(x,T[0].anchor)},hardWrap:function(x,P,T,p){if(x.hardWrap){var f=T[0].anchor.line,v=T[0].head.line;P.linewise&&v--;var C=x.hardWrap({from:f,to:v});return C>f&&P.linewise&&C--,P.keepCursor?p:new e(C,0)}},changeCase:function(x,P,T,p,f){for(var v=x.getSelections(),C=[],E=P.toLower,D=0;D<v.length;D++){var Q=v[D],z="";if(E===!0)z=Q.toLowerCase();else if(E===!1)z=Q.toUpperCase();else for(var W=0;W<Q.length;W++){var G=Q.charAt(W);z+=$(G)?G.toLowerCase():G.toUpperCase()}C.push(z)}return x.replaceSelections(C),P.shouldMoveCursor?f:!x.state.vim.visualMode&&P.linewise&&T[0].anchor.line+1==T[0].head.line?Pn.moveToFirstNonWhiteSpaceCharacter(x,p):P.linewise?p:xn(T[0].anchor,T[0].head)},yank:function(x,P,T,p){var f=x.state.vim,v=x.getSelection(),C=f.visualMode?xn(f.sel.anchor,f.sel.head,T[0].head,T[0].anchor):p;return Se.registerController.pushText(P.registerName,"yank",v,P.linewise,f.visualBlock),C}};function _n(x,P){Zt[x]=P}var it={jumpListWalk:function(x,P,T){if(!T.visualMode){var p=P.repeat||1,f=P.forward,v=Se.jumpList,C=v.move(x,f?p:-p),E=C?C.find():void 0;E=E||x.getCursor(),x.setCursor(E)}},scroll:function(x,P,T){if(!T.visualMode){var p=P.repeat||1,f=x.defaultTextHeight(),v=x.getScrollInfo().top,C=f*p,E=P.forward?v+C:v-C,D=Wt(x.getCursor()),Q=x.charCoords(D,"local");if(P.forward)E>Q.top?(D.line+=(E-Q.top)/f,D.line=Math.ceil(D.line),x.setCursor(D),Q=x.charCoords(D,"local"),x.scrollTo(null,Q.top)):x.scrollTo(null,E);else{var z=E+x.getScrollInfo().clientHeight;z<Q.bottom?(D.line-=(Q.bottom-z)/f,D.line=Math.floor(D.line),x.setCursor(D),Q=x.charCoords(D,"local"),x.scrollTo(null,Q.bottom-x.getScrollInfo().clientHeight)):x.scrollTo(null,E)}}},scrollToCursor:function(x,P){var T=x.getCursor().line,p=x.charCoords(new e(T,0),"local"),f=x.getScrollInfo().clientHeight,v=p.top;switch(P.position){case"center":v=p.bottom-f/2;break;case"bottom":var C=new e(T,x.getLine(T).length-1),E=x.charCoords(C,"local"),D=E.bottom-v;v=v-f+D;break}x.scrollTo(null,v)},replayMacro:function(x,P,T){var p=P.selectedCharacter||"",f=P.repeat||1,v=Se.macroModeState;for(p=="@"?p=v.latestRegister:v.latestRegister=p;f--;)ot(x,T,v,p)},enterMacroRecordMode:function(x,P){var T=Se.macroModeState,p=P.selectedCharacter;Se.registerController.isValidRegister(p)&&T.enterMacroRecordMode(x,p)},toggleOverwrite:function(x){x.state.overwrite?(x.toggleOverwrite(!1),x.setOption("keyMap","vim-insert"),n.signal(x,"vim-mode-change",{mode:"insert"})):(x.toggleOverwrite(!0),x.setOption("keyMap","vim-replace"),n.signal(x,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(x,P,T){if(!x.getOption("readOnly")){T.insertMode=!0,T.insertModeRepeat=P&&P.repeat||1;var p=P?P.insertAt:null,f=T.sel,v=P.head||x.getCursor("head"),C=x.listSelections().length;if(p=="eol")v=new e(v.line,an(x,v.line));else if(p=="bol")v=new e(v.line,0);else if(p=="charAfter"){var E=t(x,v,et(v,0,1));v=E.end}else if(p=="firstNonBlank"){var E=t(x,v,Pn.moveToFirstNonWhiteSpaceCharacter(x,v));v=E.end}else if(p=="startOfSelectedArea"){if(!T.visualMode)return;T.visualBlock?(v=new e(Math.min(f.head.line,f.anchor.line),Math.min(f.head.ch,f.anchor.ch)),C=Math.abs(f.head.line-f.anchor.line)+1):f.head.line<f.anchor.line?v=f.head:v=new e(f.anchor.line,0)}else if(p=="endOfSelectedArea"){if(!T.visualMode)return;T.visualBlock?(v=new e(Math.min(f.head.line,f.anchor.line),Math.max(f.head.ch,f.anchor.ch)+1),C=Math.abs(f.head.line-f.anchor.line)+1):f.head.line>=f.anchor.line?v=et(f.head,0,1):v=new e(f.anchor.line,0)}else if(p=="inplace"){if(T.visualMode)return}else p=="lastEdit"&&(v=we(x)||v);x.setOption("disableInput",!1),P&&P.replace?(x.toggleOverwrite(!0),x.setOption("keyMap","vim-replace"),n.signal(x,"vim-mode-change",{mode:"replace"})):(x.toggleOverwrite(!1),x.setOption("keyMap","vim-insert"),n.signal(x,"vim-mode-change",{mode:"insert"})),Se.macroModeState.isPlaying||(x.on("change",Je),T.insertEnd&&T.insertEnd.clear(),T.insertEnd=x.setBookmark(v,{insertLeft:!0}),n.on(x.getInputField(),"keydown",Tt)),T.visualMode&&be(x),w(x,v,C)}},toggleVisualMode:function(x,P,T){var p=P.repeat,f=x.getCursor(),v;if(T.visualMode)T.visualLine!=!!P.linewise||T.visualBlock!=!!P.blockwise?(T.visualLine=!!P.linewise,T.visualBlock=!!P.blockwise,n.signal(x,"vim-mode-change",{mode:"visual",subMode:T.visualLine?"linewise":T.visualBlock?"blockwise":""}),Y(x)):be(x);else{T.visualMode=!0,T.visualLine=!!P.linewise,T.visualBlock=!!P.blockwise,v=_e(x,new e(f.line,f.ch+p-1));var C=t(x,f,v);T.sel={anchor:C.start,head:C.end},n.signal(x,"vim-mode-change",{mode:"visual",subMode:T.visualLine?"linewise":T.visualBlock?"blockwise":""}),Y(x),Ls(x,T,"<",xn(f,v)),Ls(x,T,">",st(f,v))}},reselectLastSelection:function(x,P,T){var p=T.lastSelection;if(T.visualMode&&R(x,T),p){var f=p.anchorMark.find(),v=p.headMark.find();if(!f||!v)return;T.sel={anchor:f,head:v},T.visualMode=!0,T.visualLine=p.visualLine,T.visualBlock=p.visualBlock,Y(x),Ls(x,T,"<",xn(f,v)),Ls(x,T,">",st(f,v)),n.signal(x,"vim-mode-change",{mode:"visual",subMode:T.visualLine?"linewise":T.visualBlock?"blockwise":""})}},joinLines:function(x,P,T){var p,f;if(T.visualMode){if(p=x.getCursor("anchor"),f=x.getCursor("head"),$t(f,p)){var v=f;f=p,p=v}f.ch=an(x,f.line)-1}else{var C=Math.max(P.repeat,2);p=x.getCursor(),f=_e(x,new e(p.line+C-1,1/0))}for(var E=0,D=p.line;D<f.line;D++){E=an(x,p.line);var Q="",z=0;if(!P.keepSpaces){var W=x.getLine(p.line+1);z=W.search(/\S/),z==-1?z=W.length:Q=" "}x.replaceRange(Q,new e(p.line,E),new e(p.line+1,z))}var G=_e(x,new e(p.line,E));T.visualMode&&be(x,!1),x.setCursor(G)},newLineAndEnterInsertMode:function(x,P,T){T.insertMode=!0;var p=Wt(x.getCursor());if(p.line===x.firstLine()&&!P.after)x.replaceRange(`
`,new e(x.firstLine(),0)),x.setCursor(x.firstLine(),0);else{p.line=P.after?p.line:p.line-1,p.ch=an(x,p.line),x.setCursor(p);var f=n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent;f(x)}this.enterInsertMode(x,{repeat:P.repeat},T)},paste:function(x,P,T){var p=Se.registerController.getRegister(P.registerName);if(P.registerName==="+")navigator.clipboard.readText().then(v=>{this.continuePaste(x,P,T,v,p)});else{var f=p.toString();this.continuePaste(x,P,T,f,p)}},continuePaste:function(x,P,T,p,f){var v=Wt(x.getCursor());if(p){if(P.matchIndent){var C=x.getOption("tabSize"),E=function(ct){var dn=ct.split("	").length-1,Gn=ct.split(" ").length-1;return dn*C+Gn*1},D=x.getLine(x.getCursor().line),Q=E(D.match(/^\s*/)[0]),z=p.replace(/\n$/,""),W=p!==z,G=E(p.match(/^\s*/)[0]),p=z.replace(/^\s*/gm,function(ct){var dn=Q+(E(ct)-G);if(dn<0)return"";if(x.getOption("indentWithTabs")){var Gn=Math.floor(dn/C);return Array(Gn+1).join("	")}else return Array(dn+1).join(" ")});p+=W?`
`:""}if(P.repeat>1)var p=Array(P.repeat+1).join(p);var X=f.linewise,re=f.blockwise;if(re){p=p.split(`
`),X&&p.pop();for(var de=0;de<p.length;de++)p[de]=p[de]==""?" ":p[de];v.ch+=P.after?1:0,v.ch=Math.min(an(x,v.line),v.ch)}else X?T.visualMode?p=T.visualLine?p.slice(0,-1):`
`+p.slice(0,p.length-1)+`
`:P.after?(p=`
`+p.slice(0,p.length-1),v.ch=an(x,v.line)):v.ch=0:v.ch+=P.after?1:0;var pe;if(T.visualMode){T.lastPastedText=p;var ye,Ce=B(x,T),Be=Ce[0],je=Ce[1],Ie=x.getSelection(),nt=x.listSelections(),Nt=new Array(nt.length).join("1").split("1");T.lastSelection&&(ye=T.lastSelection.headMark.find()),Se.registerController.unnamedRegister.setText(Ie),re?(x.replaceSelections(Nt),je=new e(Be.line+p.length-1,Be.ch),x.setCursor(Be),Ys(x,je),x.replaceSelections(p),pe=Be):T.visualBlock?(x.replaceSelections(Nt),x.setCursor(Be),x.replaceRange(p,Be,Be),pe=Be):(x.replaceRange(p,Be,je),pe=x.posFromIndex(x.indexFromPos(Be)+p.length-1)),ye&&(T.lastSelection.headMark=x.setBookmark(ye)),X&&(pe.ch=0)}else if(re){x.setCursor(v);for(var de=0;de<p.length;de++){var ht=v.line+de;ht>x.lastLine()&&x.replaceRange(`
`,new e(ht,0));var Ot=an(x,ht);Ot<v.ch&&Hs(x,ht,v.ch)}x.setCursor(v),Ys(x,new e(v.line+p.length-1,v.ch)),x.replaceSelections(p),pe=v}else if(x.replaceRange(p,v),X){var ht=P.after?v.line+1:v.line;pe=new e(ht,ut(x.getLine(ht)))}else pe=Wt(v),/\n/.test(p)||(pe.ch+=p.length-(P.after?1:0));T.visualMode&&be(x,!1),x.setCursor(pe)}},undo:function(x,P){x.operation(function(){Cs(x,n.commands.undo,P.repeat)(),x.setCursor(_e(x,x.getCursor("start")))})},redo:function(x,P){Cs(x,n.commands.redo,P.repeat)()},setRegister:function(x,P,T){T.inputState.registerName=P.selectedCharacter},insertRegister:function(x,P,T){var p=P.selectedCharacter,f=Se.registerController.getRegister(p),v=f&&f.toString();v&&x.replaceSelection(v)},oneNormalCommand:function(x,P,T){Ze(x,!0),T.insertModeReturn=!0,n.on(x,"vim-command-done",function p(){T.visualMode||(T.insertModeReturn&&(T.insertModeReturn=!1,T.insertMode||it.enterInsertMode(x,{},T)),n.off(x,"vim-command-done",p))})},setMark:function(x,P,T){var p=P.selectedCharacter;p&&Ls(x,T,p,x.getCursor())},replace:function(x,P,T){var p=P.selectedCharacter||"",f=x.getCursor(),v,C,E=x.listSelections();if(T.visualMode)f=x.getCursor("start"),C=x.getCursor("end");else{var D=x.getLine(f.line);v=f.ch+P.repeat,v>D.length&&(v=D.length),C=new e(f.line,v)}var Q=t(x,f,C);if(f=Q.start,C=Q.end,p==`
`)T.visualMode||x.replaceRange("",f,C),(n.commands.newlineAndIndentContinueComment||n.commands.newlineAndIndent)(x);else{var z=x.getRange(f,C);if(z=z.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,p),z=z.replace(/[^\n]/g,p),T.visualBlock){var W=new Array(x.getOption("tabSize")+1).join(" ");z=x.getSelection(),z=z.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,p);var G=z.replace(/\t/g,W).replace(/[^\n]/g,p).split(`
`);x.replaceSelections(G)}else x.replaceRange(z,f,C);T.visualMode?(f=$t(E[0].anchor,E[0].head)?E[0].anchor:E[0].head,x.setCursor(f),be(x,!1)):x.setCursor(et(C,0,-1))}},incrementNumberToken:function(x,P){for(var T=x.getCursor(),p=x.getLine(T.line),f=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi,v,C,E,D;(v=f.exec(p))!==null&&(C=v.index,E=C+v[0].length,!(T.ch<E)););if(!(!P.backtrack&&E<=T.ch)){if(v){var Q=v[2]||v[4],z=v[3]||v[5],W=P.increase?1:-1,G={"0b":2,0:8,"":10,"0x":16}[Q.toLowerCase()],X=parseInt(v[1]+z,G)+W*P.repeat;D=X.toString(G);var re=Q?new Array(z.length-D.length+1+v[1].length).join("0"):"";D.charAt(0)==="-"?D="-"+Q+re+D.substr(1):D=Q+re+D;var de=new e(T.line,C),pe=new e(T.line,E);x.replaceRange(D,de,pe)}else return;x.setCursor(new e(T.line,C+D.length-1))}},repeatLastEdit:function(x,P,T){var p=T.lastEditInputState;if(p){var f=P.repeat;f&&P.repeatIsExplicit?p.repeatOverride=f:f=p.repeatOverride||f,hn(x,T,f,!1)}},indent:function(x,P){x.indentLine(x.getCursor().line,P.indentRight)},exitInsertMode:function(x,P){Ze(x)}};function Ft(x,P){it[x]=P}function _e(x,P,T){var p=x.state.vim,f=p.insertMode||p.visualMode,v=Math.min(Math.max(x.firstLine(),P.line),x.lastLine()),C=x.getLine(v),E=C.length-1+ +!!f,D=Math.min(Math.max(0,P.ch),E),Q=C.charCodeAt(D);if(56320<=Q&&Q<=57343){var z=1;T&&T.line==v&&T.ch>D&&(z=-1),D+=z,D>E&&(D-=2)}return new e(v,D)}function Lt(x){var P={};for(var T in x)x.hasOwnProperty(T)&&(P[T]=x[T]);return P}function et(x,P,T){return typeof P=="object"&&(T=P.ch,P=P.line),new e(x.line+P,x.ch+T)}function is(x,P,T,p){p.operator&&(T="operatorPending");for(var f,v=[],C=[],E=ge?P.length-r:0,D=E;D<P.length;D++){var Q=P[D];T=="insert"&&Q.context!="insert"||Q.context&&Q.context!=T||p.operator&&Q.type=="action"||!(f=It(x,Q.keys))||(f=="partial"&&v.push(Q),f=="full"&&C.push(Q))}return{partial:v.length&&v,full:C.length&&C}}function It(x,P){const T=P.slice(-11)=="<character>",p=P.slice(-10)=="<register>";if(T||p){var f=P.length-(T?11:10),v=x.slice(0,f),C=P.slice(0,f);return v==C&&x.length>f?"full":C.indexOf(v)==0?"partial":!1}else return x==P?"full":P.indexOf(x)==0?"partial":!1}function Dn(x){var P=/^.*(<[^>]+>)$/.exec(x),T=P?P[1]:x.slice(-1);if(T.length>1)switch(T){case"<CR>":case"<S-CR>":T=`
`;break;case"<Space>":case"<S-Space>":T=" ";break;default:T="";break}return T}function Cs(x,P,T){return function(){for(var p=0;p<T;p++)P(x)}}function Wt(x){return new e(x.line,x.ch)}function Pt(x,P){return x.ch==P.ch&&x.line==P.line}function $t(x,P){return x.line<P.line||x.line==P.line&&x.ch<P.ch}function xn(x,P){return arguments.length>2&&(P=xn.apply(void 0,Array.prototype.slice.call(arguments,1))),$t(x,P)?x:P}function st(x,P){return arguments.length>2&&(P=st.apply(void 0,Array.prototype.slice.call(arguments,1))),$t(x,P)?P:x}function Gt(x,P,T){var p=$t(x,P),f=$t(P,T);return p&&f}function an(x,P){return x.getLine(P).length}function vs(x){return x.trim?x.trim():x.replace(/^\s+|\s+$/g,"")}function Vn(x){return x.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function Hs(x,P,T){var p=an(x,P),f=new Array(T-p+1).join(" ");x.setCursor(new e(P,p)),x.replaceRange(f,x.getCursor())}function Ys(x,P){var T=[],p=x.listSelections(),f=Wt(x.clipPos(P)),v=!Pt(P,f),C=x.getCursor("head"),E=_(p,C),D=Pt(p[E].head,p[E].anchor),Q=p.length-1,z=Q-E>E?Q:0,W=p[z].anchor,G=Math.min(W.line,f.line),X=Math.max(W.line,f.line),re=W.ch,de=f.ch,pe=p[z].head.ch-re,ye=de-re;pe>0&&ye<=0?(re++,v||de--):pe<0&&ye>=0?(re--,D||de++):pe<0&&ye==-1&&(re--,de++);for(var Ce=G;Ce<=X;Ce++){var Be={anchor:new e(Ce,re),head:new e(Ce,de)};T.push(Be)}return x.setSelections(T),P.ch=de,W.ch=re,W}function w(x,P,T){for(var p=[],f=0;f<T;f++){var v=et(P,f,0);p.push({anchor:v,head:v})}x.setSelections(p,0)}function _(x,P,T){for(var p=0;p<x.length;p++){var f=Pt(x[p].anchor,P),v=Pt(x[p].head,P);if(f||v)return p}return-1}function B(x,P){var T=P.lastSelection,p=function(){var v=x.listSelections(),C=v[0],E=v[v.length-1],D=$t(C.anchor,C.head)?C.anchor:C.head,Q=$t(E.anchor,E.head)?E.head:E.anchor;return[D,Q]},f=function(){var v=x.getCursor(),C=x.getCursor(),E=T.visualBlock;if(E){var D=E.width,Q=E.height;C=new e(v.line+Q,v.ch+D);for(var z=[],W=v.line;W<C.line;W++){var G=new e(W,v.ch),X=new e(W,C.ch),re={anchor:G,head:X};z.push(re)}x.setSelections(z)}else{var de=T.anchorMark.find(),pe=T.headMark.find(),ye=pe.line-de.line,Ce=pe.ch-de.ch;C={line:C.line+ye,ch:ye?C.ch:Ce+C.ch},T.visualLine&&(v=new e(v.line,0),C=new e(C.line,an(x,C.line))),x.setSelection(v,C)}return[v,C]};return P.visualMode?p():f()}function R(x,P){var T=P.sel.anchor,p=P.sel.head;P.lastPastedText&&(p=x.posFromIndex(x.indexFromPos(T)+P.lastPastedText.length),P.lastPastedText=null),P.lastSelection={anchorMark:x.setBookmark(T),headMark:x.setBookmark(p),anchor:Wt(T),head:Wt(p),visualMode:P.visualMode,visualLine:P.visualLine,visualBlock:P.visualBlock}}function Z(x,P,T,p){var f=x.state.vim.sel,v=p?P:f.head,C=p?P:f.anchor,E;return $t(T,P)&&(E=T,T=P,P=E),$t(v,C)?(v=xn(P,v),C=st(C,T)):(C=xn(P,C),v=st(v,T),v=et(v,0,-1),v.ch==-1&&v.line!=x.firstLine()&&(v=new e(v.line-1,an(x,v.line-1)))),[C,v]}function Y(x,P,T){var p=x.state.vim;P=P||p.sel,T||(T=p.visualLine?"line":p.visualBlock?"block":"char");var f=se(x,P,T);x.setSelections(f.ranges,f.primary)}function se(x,P,T,p){var f=Wt(P.head),v=Wt(P.anchor);if(T=="char"){var C=!p&&!$t(P.head,P.anchor)?1:0,E=$t(P.head,P.anchor)?1:0;return f=et(P.head,0,C),v=et(P.anchor,0,E),{ranges:[{anchor:v,head:f}],primary:0}}else if(T=="line"){if($t(P.head,P.anchor))f.ch=0,v.ch=an(x,v.line);else{v.ch=0;var D=x.lastLine();f.line>D&&(f.line=D),f.ch=an(x,f.line)}return{ranges:[{anchor:v,head:f}],primary:0}}else if(T=="block"){var Q=Math.min(v.line,f.line),z=v.ch,W=Math.max(v.line,f.line),G=f.ch;z<G?G+=1:z+=1;for(var X=W-Q+1,re=f.line==Q?0:X-1,de=[],pe=0;pe<X;pe++)de.push({anchor:new e(Q+pe,z),head:new e(Q+pe,G)});return{ranges:de,primary:re}}throw"never happens"}function te(x){var P=x.getCursor("head");return x.getSelection().length==1&&(P=xn(P,x.getCursor("anchor"))),P}function be(x,P){var T=x.state.vim;P!==!1&&x.setCursor(_e(x,T.sel.head)),R(x,T),T.visualMode=!1,T.visualLine=!1,T.visualBlock=!1,T.insertMode||n.signal(x,"vim-mode-change",{mode:"normal"})}function $e(x,P,T){var p=x.getRange(P,T);if(/\n\s*$/.test(p)){var f=p.split(`
`);f.pop();for(var v=f.pop();f.length>0&&v&&L(v);v=f.pop())T.line--,T.ch=0;v?(T.line--,T.ch=an(x,T.line)):T.ch=0}}function Re(x,P,T){P.ch=0,T.ch=0,T.line++}function ut(x){if(!x)return 0;var P=x.search(/\S/);return P==-1?x.length:P}function on(x,{inclusive:P,innerWord:T,bigWord:p,noSymbol:f,multiline:v},C){var E=C||te(x),D=x.getLine(E.line),Q=D,z=E.line,W=z,G=E.ch,X,re=f?h[0]:d[0];if(T&&/\s/.test(D.charAt(G)))re=function(je){return/\s/.test(je)};else{for(;!re(D.charAt(G));)if(G++,G>=D.length){if(!v)return null;G--,X=cr(x,E,!0,p,!0);break}p?re=d[0]:(re=h[0],re(D.charAt(G))||(re=h[1]))}for(var de=G,pe=G;re(D.charAt(pe))&&pe>=0;)pe--;if(pe++,X)de=X.to,W=X.line,Q=x.getLine(W),!Q&&de==0&&de++;else for(;re(D.charAt(de))&&de<D.length;)de++;if(P){var ye=de,Ce=E.ch<=pe&&/\s/.test(D.charAt(E.ch));if(!Ce)for(;/\s/.test(Q.charAt(de))&&de<Q.length;)de++;if(ye==de||Ce){for(var Be=pe;/\s/.test(D.charAt(pe-1))&&pe>0;)pe--;!pe&&!Ce&&(pe=Be)}}return{start:new e(z,pe),end:new e(W,de)}}function Yn(x,P,T){var p=P;if(!n.findMatchingTag||!n.findEnclosingTag)return{start:p,end:p};var f=n.findMatchingTag(x,P)||n.findEnclosingTag(x,P);return!f||!f.open||!f.close?{start:p,end:p}:T?{start:f.open.from,end:f.close.to}:{start:f.open.to,end:f.close.from}}function Is(x,P,T){Pt(P,T)||Se.jumpList.add(x,P,T)}function mn(x,P){Se.lastCharacterSearch.increment=x,Se.lastCharacterSearch.forward=P.forward,Se.lastCharacterSearch.selectedCharacter=P.selectedCharacter}var Jt={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},sn={bracket:{isComplete:function(x){if(x.nextCh===x.symb){if(x.depth++,x.depth>=1)return!0}else x.nextCh===x.reverseSymb&&x.depth--;return!1}},section:{init:function(x){x.curMoveThrough=!0,x.symb=(x.forward?"]":"[")===x.symb?"{":"}"},isComplete:function(x){return x.index===0&&x.nextCh===x.symb}},comment:{isComplete:function(x){var P=x.lastCh==="*"&&x.nextCh==="/";return x.lastCh=x.nextCh,P}},method:{init:function(x){x.symb=x.symb==="m"?"{":"}",x.reverseSymb=x.symb==="{"?"}":"{"},isComplete:function(x){return x.nextCh===x.symb}},preprocess:{init:function(x){x.index=0},isComplete:function(x){if(x.nextCh==="#"){var P=x.lineText.match(/^#(\w+)/)[1];if(P==="endif"){if(x.forward&&x.depth===0)return!0;x.depth++}else if(P==="if"){if(!x.forward&&x.depth===0)return!0;x.depth--}if(P==="else"&&x.depth===0)return!0}return!1}}};function ps(x,P,T,p){var f=Wt(x.getCursor()),v=T?1:-1,C=T?x.lineCount():-1,E=f.ch,D=f.line,Q=x.getLine(D),z={lineText:Q,nextCh:Q.charAt(E),lastCh:null,index:E,symb:p,reverseSymb:(T?{")":"(","}":"{"}:{"(":")","{":"}"})[p],forward:T,depth:0,curMoveThrough:!1},W=Jt[p];if(!W)return f;var G=sn[W].init,X=sn[W].isComplete;for(G&&G(z);D!==C&&P;){if(z.index+=v,z.nextCh=z.lineText.charAt(z.index),!z.nextCh){if(D+=v,z.lineText=x.getLine(D)||"",v>0)z.index=0;else{var re=z.lineText.length;z.index=re>0?re-1:0}z.nextCh=z.lineText.charAt(z.index)}X(z)&&(f.line=D,f.ch=z.index,P--)}return z.nextCh||z.curMoveThrough?new e(D,z.index):f}function cr(x,P,T,p,f){var v=P.line,C=P.ch,E=x.getLine(v),D=T?1:-1,Q=p?d:h;if(f&&E==""){if(v+=D,E=x.getLine(v),!A(x,v))return null;C=T?0:E.length}for(;;){if(f&&E=="")return{from:0,to:0,line:v};for(var z=D>0?E.length:-1,W=z,G=z;C!=z;){for(var X=!1,re=0;re<Q.length&&!X;++re)if(Q[re](E.charAt(C))){for(W=C;C!=z&&Q[re](E.charAt(C));)C+=D;if(G=C,X=W!=G,W==P.ch&&v==P.line&&G==W+D)continue;return{from:Math.min(W,G+1),to:Math.max(W,G),line:v}}X||(C+=D)}if(v+=D,!A(x,v))return null;E=x.getLine(v),C=D>0?0:E.length}}function $i(x,P,T,p,f,v){var C=Wt(P),E=[];(p&&!f||!p&&f)&&T++;for(var D=!(p&&f),Q=0;Q<T;Q++){var z=cr(x,P,p,v,D);if(!z){var W=an(x,x.lastLine());E.push(p?{line:x.lastLine(),from:W,to:W}:{line:0,from:0,to:0});break}E.push(z),P=new e(z.line,p?z.to-1:z.from)}var G=E.length!=T,X=E[0],re=E.pop();return p&&!f?(!G&&(X.from!=C.ch||X.line!=C.line)&&(re=E.pop()),re&&new e(re.line,re.from)):p&&f?re&&new e(re.line,re.to-1):!p&&f?(!G&&(X.to!=C.ch||X.line!=C.line)&&(re=E.pop()),re&&new e(re.line,re.to)):re&&new e(re.line,re.from)}function Gr(x,P,T,p,f){var v=P,C=new e(v.line+T.repeat-1,1/0),E=x.clipPos(C);return E.ch--,f||(p.lastHPos=1/0,p.lastHSPos=x.charCoords(E,"div").left),C}function hi(x,P,T,p,f){if(p){for(var v=f||x.getCursor(),C=v.ch,E,D=0;D<P;D++){var Q=x.getLine(v.line);if(E=ql(C,Q,p,T),E==-1)return;C=E}if(E!=null)return new e(x.getCursor().line,E)}}function di(x,P){var T=x.getCursor().line;return _e(x,new e(T,P-1))}function Ls(x,P,T,p){!q(T,m)&&!O.test(T)||(P.marks[T]&&P.marks[T].clear(),P.marks[T]=x.setBookmark(p))}function ql(x,P,T,p,f){var v;return p?v=P.indexOf(T,x+1):v=P.lastIndexOf(T,x-1),v}function Dr(x,P,T,p,f){var v=P.line,C=x.firstLine(),E=x.lastLine(),D,Q,z=v;function W(pe){return!x.getLine(pe)}function G(pe,ye,Ce){return Ce?W(pe)!=W(pe+ye):!W(pe)&&W(pe+ye)}if(p){for(;C<=z&&z<=E&&T>0;)G(z,p)&&T--,z+=p;return{start:new e(z,0),end:P}}var X=x.state.vim;if(X.visualLine&&G(v,1,!0)){var re=X.sel.anchor;G(re.line,-1,!0)&&(!f||re.line!=v)&&(v+=1)}var de=W(v);for(z=v;z<=E&&T;z++)G(z,1,!0)&&(!f||W(z)!=de)&&T--;for(Q=new e(z,0),z>E&&!de?de=!0:f=!1,z=v;z>C&&!((!f||W(z)==de||z==v)&&G(z,-1,!0));z--);return D=new e(z,0),{start:D,end:Q}}function nl(x,P,T,p,f){function v(Q){Q.pos+Q.dir<0||Q.pos+Q.dir>=Q.line.length?Q.line=null:Q.pos+=Q.dir}function C(Q,z,W,G){var X=Q.getLine(z),re={line:X,ln:z,pos:W,dir:G};if(re.line==="")return{ln:re.ln,pos:re.pos};var de=re.pos;for(v(re);re.line!==null;){if(de=re.pos,I(re.line[re.pos]))if(f){for(v(re);re.line!==null&&L(re.line[re.pos]);)de=re.pos,v(re);return{ln:re.ln,pos:de+1}}else return{ln:re.ln,pos:re.pos+1};v(re)}return{ln:re.ln,pos:de+1}}function E(Q,z,W,G){var X=Q.getLine(z),re={line:X,ln:z,pos:W,dir:G};if(re.line==="")return{ln:re.ln,pos:re.pos};var de=re.pos;for(v(re);re.line!==null;){if(!L(re.line[re.pos])&&!I(re.line[re.pos]))de=re.pos;else if(I(re.line[re.pos]))return f?L(re.line[re.pos+1])?{ln:re.ln,pos:re.pos+1}:{ln:re.ln,pos:de}:{ln:re.ln,pos:de};v(re)}return re.line=X,f&&L(re.line[re.pos])?{ln:re.ln,pos:re.pos}:{ln:re.ln,pos:de}}for(var D={ln:P.line,pos:P.ch};T>0;)p<0?D=E(x,D.ln,D.pos,p):D=C(x,D.ln,D.pos,p),T--;return new e(D.ln,D.pos)}function Ni(x,P,T,p){function f(D,Q){if(Q.pos+Q.dir<0||Q.pos+Q.dir>=Q.line.length){if(Q.ln+=Q.dir,!A(D,Q.ln)){Q.line=null,Q.ln=null,Q.pos=null;return}Q.line=D.getLine(Q.ln),Q.pos=Q.dir>0?0:Q.line.length-1}else Q.pos+=Q.dir}function v(D,Q,z,W){var pe=D.getLine(Q),G=pe==="",X={line:pe,ln:Q,pos:z,dir:W},re={ln:X.ln,pos:X.pos},de=X.line==="";for(f(D,X);X.line!==null;){if(re.ln=X.ln,re.pos=X.pos,X.line===""&&!de)return{ln:X.ln,pos:X.pos};if(G&&X.line!==""&&!L(X.line[X.pos]))return{ln:X.ln,pos:X.pos};I(X.line[X.pos])&&!G&&(X.pos===X.line.length-1||L(X.line[X.pos+1]))&&(G=!0),f(D,X)}var pe=D.getLine(re.ln);re.pos=0;for(var ye=pe.length-1;ye>=0;--ye)if(!L(pe[ye])){re.pos=ye;break}return re}function C(D,Q,z,W){var de=D.getLine(Q),G={line:de,ln:Q,pos:z,dir:W},X={ln:G.ln,pos:null},re=G.line==="";for(f(D,G);G.line!==null;){if(G.line===""&&!re)return X.pos!==null?X:{ln:G.ln,pos:G.pos};if(I(G.line[G.pos])&&X.pos!==null&&!(G.ln===X.ln&&G.pos+1===X.pos))return X;G.line!==""&&!L(G.line[G.pos])&&(re=!1,X={ln:G.ln,pos:G.pos}),f(D,G)}var de=D.getLine(X.ln);X.pos=0;for(var pe=0;pe<de.length;++pe)if(!L(de[pe])){X.pos=pe;break}return X}for(var E={ln:P.line,pos:P.ch};T>0;)p<0?E=C(x,E.ln,E.pos,p):E=v(x,E.ln,E.pos,p),T--;return new e(E.ln,E.pos)}function Xr(x,P,T,p){var f=P,v={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[T],C={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"}[T],E=x.getLine(f.line).charAt(f.ch),D=E===C?1:0,Q=x.scanForBracket(new e(f.line,f.ch+D),-1,void 0,{bracketRegex:v}),z=x.scanForBracket(new e(f.line,f.ch+D),1,void 0,{bracketRegex:v});if(!Q||!z)return null;var W=Q.pos,G=z.pos;if(W.line==G.line&&W.ch>G.ch||W.line>G.line){var X=W;W=G,G=X}return p?G.ch+=1:W.ch+=1,{start:W,end:G}}function Ul(x,P,T,p){var f=Wt(P),v=x.getLine(f.line),C=v.split(""),E,D,Q,z,W=C.indexOf(T);if(f.ch<W)f.ch=W;else if(W<f.ch&&C[f.ch]==T){var G=/string/.test(x.getTokenTypeAt(et(P,0,1))),X=/string/.test(x.getTokenTypeAt(P)),re=G&&!X;re||(D=f.ch,--f.ch)}if(C[f.ch]==T&&!D)E=f.ch+1;else for(Q=f.ch;Q>-1&&!E;Q--)C[Q]==T&&(E=Q+1);if(E&&!D)for(Q=E,z=C.length;Q<z&&!D;Q++)C[Q]==T&&(D=Q);return!E||!D?{start:f,end:f}:(p&&(--E,++D),{start:new e(f.line,E),end:new e(f.line,D)})}ee("pcre",!0,"boolean");class _i{getQuery(){return Se.query}setQuery(P){Se.query=P}getOverlay(){return this.searchOverlay}setOverlay(P){this.searchOverlay=P}isReversed(){return Se.isReversed}setReversed(P){Se.isReversed=P}getScrollbarAnnotate(){return this.annotate}setScrollbarAnnotate(P){this.annotate=P}}function Ks(x){var P=x.state.vim;return P.searchState_||(P.searchState_=new _i)}function Da(x){return Js(x,"/")}function Fs(x){return da(x,"/")}function Js(x,P){var T=da(x,P);if(!T.length)return[];var p=[];if(T[0]===0){for(var f=0;f<T.length;f++)typeof T[f]=="number"&&p.push(x.substring(T[f]+1,T[f+1]));return p}}function da(x,P){P||(P="/");for(var T=!1,p=[],f=0;f<x.length;f++){var v=x.charAt(f);!T&&v==P&&p.push(f),T=!T&&v=="\\"}return p}function Ta(x){for(var P="|(){",T="}",p=!1,f=[],v=-1;v<x.length;v++){var C=x.charAt(v)||"",E=x.charAt(v+1)||"",D=E&&P.indexOf(E)!=-1;p?((C!=="\\"||!D)&&f.push(C),p=!1):C==="\\"?(p=!0,E&&T.indexOf(E)!=-1&&(D=!0),(!D||E==="\\")&&f.push(C)):(f.push(C),D&&E!=="\\"&&f.push("\\"))}return f.join("")}var Hr={"\\n":`
`,"\\r":"\r","\\t":"	"};function Ba(x){for(var P=!1,T=[],p=-1;p<x.length;p++){var f=x.charAt(p)||"",v=x.charAt(p+1)||"";Hr[f+v]?(T.push(Hr[f+v]),p++):P?(T.push(f),P=!1):f==="\\"?(P=!0,N(v)||v==="$"?T.push("$"):v!=="/"&&v!=="\\"&&T.push("\\")):(f==="$"&&T.push("$"),T.push(f),v==="/"&&T.push("\\"))}return T.join("")}var Yr={"\\/":"/","\\\\":"\\","\\n":`
`,"\\r":"\r","\\t":"	","\\&":"&"};function Wl(x){for(var P=new n.StringStream(x),T=[];!P.eol();){for(;P.peek()&&P.peek()!="\\";)T.push(P.next());var p=!1;for(var f in Yr)if(P.match(f,!0)){p=!0,T.push(Yr[f]);break}p||T.push(P.next())}return T.join("")}function Ir(x,P,T){var p=Se.registerController.getRegister("/");if(p.setText(x),x instanceof RegExp)return x;var f=Fs(x),v,C;if(!f.length)v=x;else{v=x.substring(0,f[0]);var E=x.substring(f[0]);C=E.indexOf("i")!=-1}if(!v)return null;H("pcre")||(v=Ta(v)),T&&(P=/^[^A-Z]*$/.test(v));var D=new RegExp(v,P||C?"im":"m");return D}function Or(x){typeof x=="string"&&(x=document.createElement(x));for(var P,T=1;T<arguments.length;T++)if(P=arguments[T])if(typeof P!="object"&&(P=document.createTextNode(P)),P.nodeType)x.appendChild(P);else for(var p in P)Object.prototype.hasOwnProperty.call(P,p)&&(p[0]==="$"?x.style[p.slice(1)]=P[p]:x.setAttribute(p,P[p]));return x}function Tn(x,P){var T=Or("div",{$color:"red",$whiteSpace:"pre",class:"cm-vim-message"},P);x.openNotification?x.openNotification(T,{bottom:!0,duration:5e3}):alert(T.innerText)}function wr(x,P){return Or("div",{$display:"flex"},Or("span",{$fontFamily:"monospace",$whiteSpace:"pre",$flex:1},x,Or("input",{type:"text",autocorrect:"off",autocapitalize:"off",spellcheck:"false",$width:"100%"})),P&&Or("span",{$color:"#888"},P))}function fn(x,P){if(Ke.length){P.value||(P.value=""),Ye=P;return}var T=wr(P.prefix,P.desc);if(x.openDialog)x.openDialog(T,P.onClose,{onKeyDown:P.onKeyDown,onKeyUp:P.onKeyUp,bottom:!0,selectValueOnOpen:!1,value:P.value});else{var p="";typeof P.prefix!="string"&&P.prefix&&(p+=P.prefix.textContent),P.desc&&(p+=" "+P.desc),P.onClose(prompt(p,""))}}function Oo(x,P){if(x instanceof RegExp&&P instanceof RegExp){for(var T=["global","multiline","ignoreCase","source"],p=0;p<T.length;p++){var f=T[p];if(x[f]!==P[f])return!1}return!0}return!1}function Kr(x,P,T,p){if(P){var f=Ks(x),v=Ir(P,!!T,!!p);if(v)return wo(x,v),Oo(v,f.getQuery())||f.setQuery(v),v}}function Gl(x){if(x.source.charAt(0)=="^")var P=!0;return{token:function(T){if(P&&!T.sol()){T.skipToEnd();return}var p=T.match(x,!1);if(p)return p[0].length==0?(T.next(),"searching"):!T.sol()&&(T.backUp(1),!x.exec(T.next()+p[0]))?(T.next(),null):(T.match(x),"searching");for(;!T.eol()&&(T.next(),!T.match(x,!1)););},query:x}}var Tr=0;function wo(x,P){clearTimeout(Tr);var T=Ks(x);T.highlightTimeout=Tr,Tr=setTimeout(function(){if(x.state.vim){var p=Ks(x);p.highlightTimeout=null;var f=p.getOverlay();(!f||P!=f.query)&&(f&&x.removeOverlay(f),f=Gl(P),x.addOverlay(f),x.showMatchesOnScrollbar&&(p.getScrollbarAnnotate()&&p.getScrollbarAnnotate().clear(),p.setScrollbarAnnotate(x.showMatchesOnScrollbar(P))),p.setOverlay(f))}},50)}function pa(x,P,T,p){return x.operation(function(){p===void 0&&(p=1);for(var f=x.getCursor(),v=x.getSearchCursor(T,f),C=0;C<p;C++){var E=v.find(P);if(C==0&&E&&Pt(v.from(),f)){var D=P?v.from():v.to();E=v.find(P),E&&!E[0]&&Pt(v.from(),D)&&x.getLine(D.line).length==D.ch&&(E=v.find(P))}if(!E&&(v=x.getSearchCursor(T,P?new e(x.lastLine()):new e(x.firstLine(),0)),!v.find(P)))return}return v.from()})}function K(x,P,T,p,f){return x.operation(function(){p===void 0&&(p=1);var v=x.getCursor(),C=x.getSearchCursor(T,v),E=C.find(!P);!f.visualMode&&E&&Pt(C.from(),v)&&C.find(!P);for(var D=0;D<p;D++)if(E=C.find(P),!E&&(C=x.getSearchCursor(T,P?new e(x.lastLine()):new e(x.firstLine(),0)),!C.find(P)))return;return[C.from(),C.to()]})}function J(x){var P=Ks(x);P.highlightTimeout&&(clearTimeout(P.highlightTimeout),P.highlightTimeout=null),x.removeOverlay(Ks(x).getOverlay()),P.setOverlay(null),P.getScrollbarAnnotate()&&(P.getScrollbarAnnotate().clear(),P.setScrollbarAnnotate(null))}function ne(x,P,T){return typeof x!="number"&&(x=x.line),P instanceof Array?q(x,P):typeof T=="number"?x>=P&&x<=T:x==P}function M(x){var P=x.getScrollInfo(),T=6,p=10,f=x.coordsChar({left:0,top:T+P.top},"local"),v=P.clientHeight-p+P.top,C=x.coordsChar({left:0,top:v},"local");return{top:f.line,bottom:C.line}}function ue(x,P,T){if(T=="'"||T=="`")return Se.jumpList.find(x,-1)||new e(0,0);if(T==".")return we(x);var p=P.marks[T];return p&&p.find()}function we(x){if(x.getLastEditEnd)return x.getLastEditEnd();for(var P=x.doc.history.done,T=P.length;T--;)if(P[T].changes)return Wt(P[T].changes[0].to)}class xe{constructor(){this.commandMap_,this.buildCommandMap_()}processCommand(P,T,p){var f=this;P.operation(function(){P.curOp.isVimOp=!0,f._processCommand(P,T,p)})}_processCommand(P,T,p){var f=P.state.vim,v=Se.registerController.getRegister(":"),C=v.toString(),E=new n.StringStream(T);v.setText(T);var D=p||{};D.input=T;try{this.parseInput_(P,E,D)}catch(W){throw Tn(P,W+""),W}f.visualMode&&be(P);var Q,z;if(!D.commandName)D.line!==void 0&&(z="move");else if(Q=this.matchCommand_(D.commandName),Q){if(z=Q.name,Q.excludeFromCommandHistory&&v.setText(C),this.parseCommandArgs_(E,D,Q),Q.type=="exToKey"){Xe(P,Q.toKeys,Q);return}else if(Q.type=="exToEx"){this.processCommand(P,Q.toInput);return}}if(!z){Tn(P,'Not an editor command ":'+T+'"');return}try{Ae[z](P,D),(!Q||!Q.possiblyAsync)&&D.callback&&D.callback()}catch(W){throw Tn(P,W+""),W}}parseInput_(P,T,p){var v,C;T.eatWhile(":"),T.eat("%")?(p.line=P.firstLine(),p.lineEnd=P.lastLine()):(p.line=this.parseLineSpec_(P,T),p.line!==void 0&&T.eat(",")&&(p.lineEnd=this.parseLineSpec_(P,T))),p.line==null?P.state.vim.visualMode?(p.selectionLine=(v=ue(P,P.state.vim,"<"))==null?void 0:v.line,p.selectionLineEnd=(C=ue(P,P.state.vim,">"))==null?void 0:C.line):p.selectionLine=P.getCursor().line:(p.selectionLine=p.line,p.selectionLineEnd=p.lineEnd);var f=T.match(/^(\w+|!!|@@|[!#&*<=>@~])/);return f?p.commandName=f[1]:p.commandName=T.match(/.*/)[0],p}parseLineSpec_(P,T){var p=T.match(/^(\d+)/);if(p)return parseInt(p[1],10)-1;switch(T.next()){case".":return this.parseLineSpecOffset_(T,P.getCursor().line);case"$":return this.parseLineSpecOffset_(T,P.lastLine());case"'":var f=T.next(),v=ue(P,P.state.vim,f);if(!v)throw new Error("Mark not set");return this.parseLineSpecOffset_(T,v.line);case"-":case"+":return T.backUp(1),this.parseLineSpecOffset_(T,P.getCursor().line);default:T.backUp(1);return}}parseLineSpecOffset_(P,T){var p=P.match(/^([+-])?(\d+)/);if(p){var f=parseInt(p[2],10);p[1]=="-"?T-=f:T+=f}return T}parseCommandArgs_(P,T,p){if(!P.eol()){T.argString=P.match(/.*/)[0];var f=p.argDelimiter||/\s+/,v=vs(T.argString).split(f);v.length&&v[0]&&(T.args=v)}}matchCommand_(P){for(var T=P.length;T>0;T--){var p=P.substring(0,T);if(this.commandMap_[p]){var f=this.commandMap_[p];if(f.name.indexOf(P)===0)return f}}return null}buildCommandMap_(){this.commandMap_={};for(var P=0;P<a.length;P++){var T=a[P],p=T.shortName||T.name;this.commandMap_[p]=T}}map(P,T,p,f){if(P!=":"&&P.charAt(0)==":"){if(p)throw Error("Mode not supported for ex mappings");var v=P.substring(1);T!=":"&&T.charAt(0)==":"?this.commandMap_[v]={name:v,type:"exToEx",toInput:T.substring(1),user:!0}:this.commandMap_[v]={name:v,type:"exToKey",toKeys:T,user:!0}}else{var C={keys:P,type:"keyToKey",toKeys:T,noremap:!!f};p&&(C.context=p),s.unshift(C)}}unmap(P,T){if(P!=":"&&P.charAt(0)==":"){if(T)throw Error("Mode not supported for ex mappings");var p=P.substring(1);if(this.commandMap_[p]&&this.commandMap_[p].user)return delete this.commandMap_[p],!0}else for(var f=P,v=0;v<s.length;v++)if(f==s[v].keys&&s[v].context===T)return s.splice(v,1),!0}}var Ae={colorscheme:function(x,P){if(!P.args||P.args.length<1){Tn(x,x.getOption("theme"));return}x.setOption("theme",P.args[0])},map:function(x,P,T,p){var f=P.args;if(!f||f.length<2){x&&Tn(x,"Invalid mapping: "+P.input);return}fe.map(f[0],f[1],T,p)},imap:function(x,P){this.map(x,P,"insert")},nmap:function(x,P){this.map(x,P,"normal")},vmap:function(x,P){this.map(x,P,"visual")},omap:function(x,P){this.map(x,P,"operatorPending")},noremap:function(x,P){this.map(x,P,void 0,!0)},inoremap:function(x,P){this.map(x,P,"insert",!0)},nnoremap:function(x,P){this.map(x,P,"normal",!0)},vnoremap:function(x,P){this.map(x,P,"visual",!0)},onoremap:function(x,P){this.map(x,P,"operatorPending",!0)},unmap:function(x,P,T){var p=P.args;(!p||p.length<1||!fe.unmap(p[0],T))&&x&&Tn(x,"No such mapping: "+P.input)},mapclear:function(x,P){Qe.mapclear()},imapclear:function(x,P){Qe.mapclear("insert")},nmapclear:function(x,P){Qe.mapclear("normal")},vmapclear:function(x,P){Qe.mapclear("visual")},omapclear:function(x,P){Qe.mapclear("operatorPending")},move:function(x,P){rt.processCommand(x,x.state.vim,{keys:"",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:P.line+1})},set:function(x,P){var T=P.args,p=P.setCfg||{};if(!T||T.length<1){x&&Tn(x,"Invalid mapping: "+P.input);return}var f=T[0].split("="),v=f.shift()||"",C=f.length>0?f.join("="):void 0,E=!1,D=!1;if(v.charAt(v.length-1)=="?"){if(C)throw Error("Trailing characters: "+P.argString);v=v.substring(0,v.length-1),E=!0}else v.charAt(v.length-1)=="!"&&(v=v.substring(0,v.length-1),D=!0);C===void 0&&v.substring(0,2)=="no"&&(v=v.substring(2),C=!1);var Q=ce[v]&&ce[v].type=="boolean";if(Q&&(D?C=!H(v,x,p):C==null&&(C=!0)),!Q&&C===void 0||E){var z=H(v,x,p);z instanceof Error?Tn(x,z.message):z===!0||z===!1?Tn(x," "+(z?"":"no")+v):Tn(x,"  "+v+"="+z)}else{var W=he(v,C,x,p);W instanceof Error&&Tn(x,W.message)}},setlocal:function(x,P){P.setCfg={scope:"local"},this.set(x,P)},setglobal:function(x,P){P.setCfg={scope:"global"},this.set(x,P)},registers:function(x,P){var T=P.args,p=Se.registerController.registers,f=`----------Registers----------

`;if(T)for(var v=T.join(""),C=0;C<v.length;C++){var E=v.charAt(C);if(Se.registerController.isValidRegister(E)){var D=p[E]||new Kt;f+='"'+E+"    "+D.toString()+`
`}}else for(var E in p){var Q=p[E].toString();Q.length&&(f+='"'+E+"    "+Q+`
`)}Tn(x,f)},sort:function(x,P){var T,p,f,v,C;function E(){if(P.argString){var ht=new n.StringStream(P.argString);if(ht.eat("!")&&(T=!0),ht.eol())return;if(!ht.eatSpace())return"Invalid arguments";var Ot=ht.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!Ot||!ht.eol())return"Invalid arguments";if(Ot[1]){p=Ot[1].indexOf("i")!=-1,f=Ot[1].indexOf("u")!=-1;var Ut=Ot[1].indexOf("d")!=-1||Ot[1].indexOf("n")!=-1,Ht=Ot[1].indexOf("x")!=-1,ct=Ot[1].indexOf("o")!=-1;if(Number(Ut)+Number(Ht)+Number(ct)>1)return"Invalid arguments";v=Ut&&"decimal"||Ht&&"hex"||ct&&"octal"}Ot[2]&&(C=new RegExp(Ot[2].substr(1,Ot[2].length-2),p?"i":""))}}var D=E();if(D){Tn(x,D+": "+P.argString);return}var Q=P.line||x.firstLine(),z=P.lineEnd||P.line||x.lastLine();if(Q==z)return;var W=new e(Q,0),G=new e(z,an(x,z)),X=x.getRange(W,G).split(`
`),re=v=="decimal"?/(-?)([\d]+)/:v=="hex"?/(-?)(?:0x)?([0-9a-f]+)/i:v=="octal"?/([0-7]+)/:null,de=v=="decimal"?10:v=="hex"?16:v=="octal"?8:void 0,pe=[],ye=[];if(v||C)for(var Ce=0;Ce<X.length;Ce++){var Be=C?X[Ce].match(C):null;Be&&Be[0]!=""?pe.push(Be):re&&re.exec(X[Ce])?pe.push(X[Ce]):ye.push(X[Ce])}else ye=X;function je(ht,Ot){if(T){var Ut;Ut=ht,ht=Ot,Ot=Ut}p&&(ht=ht.toLowerCase(),Ot=Ot.toLowerCase());var Ht=re&&re.exec(ht),ct=re&&re.exec(Ot);if(!Ht||!ct)return ht<Ot?-1:1;var dn=parseInt((Ht[1]+Ht[2]).toLowerCase(),de),Gn=parseInt((ct[1]+ct[2]).toLowerCase(),de);return dn-Gn}function Ie(ht,Ot){if(T){var Ut;Ut=ht,ht=Ot,Ot=Ut}return p&&(ht[0]=ht[0].toLowerCase(),Ot[0]=Ot[0].toLowerCase()),ht[0]<Ot[0]?-1:1}if(pe.sort(C?Ie:je),C)for(var Ce=0;Ce<pe.length;Ce++)pe[Ce]=pe[Ce].input;else v||ye.sort(je);if(X=T?pe.concat(ye):ye.concat(pe),f){var nt=X,Nt;X=[];for(var Ce=0;Ce<nt.length;Ce++)nt[Ce]!=Nt&&X.push(nt[Ce]),Nt=nt[Ce]}x.replaceRange(X.join(`
`),W,G)},vglobal:function(x,P){this.global(x,P)},normal:function(x,P){var T=P.argString;if(T&&T[0]=="!"&&(T=T.slice(1),ge=!0),T=T.trimStart(),!T){Tn(x,"Argument is required.");return}var p=P.line;if(typeof p=="number")for(var f=isNaN(P.lineEnd)?p:P.lineEnd,v=p;v<=f;v++)x.setCursor(v,0),Xe(x,P.argString.trimStart()),x.state.vim.insertMode&&Ze(x,!0);else Xe(x,P.argString.trimStart()),x.state.vim.insertMode&&Ze(x,!0)},global:function(x,P){var T=P.argString;if(!T){Tn(x,"Regular Expression missing from global");return}var p=P.commandName[0]==="v";T[0]==="!"&&P.commandName[0]==="g"&&(p=!0,T=T.slice(1));var f=P.line!==void 0?P.line:x.firstLine(),v=P.lineEnd||P.line||x.lastLine(),C=Da(T),E=T,D="";if(C&&C.length&&(E=C[0],D=C.slice(1,C.length).join("/")),E)try{Kr(x,E,!0,!0)}catch{Tn(x,"Invalid regex: "+E);return}for(var Q=Ks(x).getQuery(),z=[],W=f;W<=v;W++){var G=x.getLine(W),X=Q.test(G);X!==p&&z.push(D?x.getLineHandle(W):G)}if(!D){Tn(x,z.join(`
`));return}var re=0,de=function(){if(re<z.length){var pe=z[re++],ye=x.getLineNumber(pe);if(ye==null){de();return}var Ce=ye+1+D;fe.processCommand(x,Ce,{callback:de})}else x.releaseLineHandles&&x.releaseLineHandles()};de()},substitute:function(x,P){if(!x.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var T=P.argString,p=T?Js(T,T[0]):[],f="",v="",C,E,D,Q=!1,z=!1;if(p&&p.length)f=p[0],H("pcre")&&f!==""&&(f=new RegExp(f).source),v=p[1],v!==void 0&&(H("pcre")?v=Wl(v.replace(/([^\\])&/g,"$1$$&")):v=Ba(v),Se.lastSubstituteReplacePart=v),C=p[2]?p[2].split(" "):[];else if(T&&T.length){Tn(x,"Substitutions should be of the form :s/pattern/replace/");return}if(C&&(E=C[0],D=parseInt(C[1]),E&&(E.indexOf("c")!=-1&&(Q=!0),E.indexOf("g")!=-1&&(z=!0),H("pcre")?f=f+"/"+E:f=f.replace(/\//g,"\\/")+"/"+E)),f)try{Kr(x,f,!0,!0)}catch{Tn(x,"Invalid regex: "+f);return}if(v=v||Se.lastSubstituteReplacePart,v===void 0){Tn(x,"No previous substitute regular expression");return}var W=Ks(x),G=W.getQuery(),X=P.line!==void 0?P.line:x.getCursor().line,re=P.lineEnd||X;X==x.firstLine()&&re==x.lastLine()&&(re=1/0),D&&(X=re,re=X+D-1);var de=_e(x,new e(X,0)),pe=x.getSearchCursor(G,de);Fe(x,Q,z,X,re,pe,G,v,P.callback)},startinsert:function(x,P){Xe(x,P.argString=="!"?"A":"i",{})},redo:n.commands.redo,undo:n.commands.undo,write:function(x){n.commands.save?n.commands.save(x):x.save&&x.save()},nohlsearch:function(x){J(x)},yank:function(x){var P=Wt(x.getCursor()),T=P.line,p=x.getLine(T);Se.registerController.pushText("0","yank",p,!0,!0)},delete:function(x,P){var T=P.selectionLine,p=isNaN(P.selectionLineEnd)?T:P.selectionLineEnd;Zt.delete(x,{linewise:!0},[{anchor:new e(T,0),head:new e(p+1,0)}])},join:function(x,P){var T=P.selectionLine,p=isNaN(P.selectionLineEnd)?T:P.selectionLineEnd;x.setCursor(new e(T,0)),it.joinLines(x,{repeat:p-T},x.state.vim)},delmarks:function(x,P){if(!P.argString||!vs(P.argString)){Tn(x,"Argument required");return}for(var T=x.state.vim,p=new n.StringStream(vs(P.argString));!p.eol();){p.eatSpace();var f=p.pos;if(!p.match(/[a-zA-Z]/,!1)){Tn(x,"Invalid argument: "+P.argString.substring(f));return}var v=p.next();if(p.match("-",!0)){if(!p.match(/[a-zA-Z]/,!1)){Tn(x,"Invalid argument: "+P.argString.substring(f));return}var C=v,E=p.next();if(C&&E&&F(C)==F(E)){var D=C.charCodeAt(0),Q=E.charCodeAt(0);if(D>=Q){Tn(x,"Invalid argument: "+P.argString.substring(f));return}for(var z=0;z<=Q-D;z++){var W=String.fromCharCode(D+z);delete T.marks[W]}}else{Tn(x,"Invalid argument: "+C+"-");return}}else v&&delete T.marks[v]}}},fe=new xe;function Fe(x,P,T,p,f,v,C,E,D){x.state.vim.exMode=!0;var Q=!1,z,W,G;function X(){x.operation(function(){for(;!Q;)re(),pe();ye()})}function re(){var Be=x.getRange(v.from(),v.to()),je=Be.replace(C,E),Ie=v.to().line;v.replace(je),W=v.to().line,f+=W-Ie,G=W<Ie}function de(){var Be=z&&Wt(v.to()),je=v.findNext();return je&&!je[0]&&Be&&Pt(v.from(),Be)&&(je=v.findNext()),je}function pe(){for(;de()&&ne(v.from(),p,f);)if(!(!T&&v.from().line==W&&!G)){x.scrollIntoView(v.from(),30),x.setSelection(v.from(),v.to()),z=v.from(),Q=!1;return}Q=!0}function ye(Be){if(Be&&Be(),x.focus(),z){x.setCursor(z);var je=x.state.vim;je.exMode=!1,je.lastHPos=je.lastHSPos=z.ch}D&&D()}function Ce(Be,je,Ie){n.e_stop(Be);var nt=gn(Be);switch(nt){case"y":re(),pe();break;case"n":pe();break;case"a":var Nt=D;D=void 0,x.operation(X),D=Nt;break;case"l":re();case"q":case"<Esc>":case"<C-c>":case"<C-[>":ye(Ie);break}return Q&&ye(Ie),!0}if(pe(),Q){Tn(x,"No matches for "+C.source);return}if(!P){X(),D&&D();return}fn(x,{prefix:Or("span","replace with ",Or("strong",E)," (y/n/a/q/l)"),onKeyDown:Ce})}function Ze(x,P){var T=x.state.vim,p=Se.macroModeState,f=Se.registerController.getRegister("."),v=p.isPlaying,C=p.lastInsertModeChanges;v||(x.off("change",Je),T.insertEnd&&T.insertEnd.clear(),T.insertEnd=void 0,n.off(x.getInputField(),"keydown",Tt)),!v&&T.insertModeRepeat>1&&(hn(x,T,T.insertModeRepeat-1,!0),T.lastEditInputState.repeatOverride=T.insertModeRepeat),delete T.insertModeRepeat,T.insertMode=!1,P||x.setCursor(x.getCursor().line,x.getCursor().ch-1),x.setOption("keyMap","vim"),x.setOption("disableInput",!0),x.toggleOverwrite(!1),f.setText(C.changes.join("")),n.signal(x,"vim-mode-change",{mode:"normal"}),p.isRecording&&tt(p)}function Te(x){s.unshift(x)}function Ne(x,P,T,p,f){var v={keys:x,type:P};v[P]=T,v[P+"Args"]=p;for(var C in f)v[C]=f[C];Te(v)}ee("insertModeEscKeysTimeout",200,"number");function ot(x,P,T,p){var f=Se.registerController.getRegister(p);if(p==":"){f.keyBuffer[0]&&fe.processCommand(x,f.keyBuffer[0]),T.isPlaying=!1;return}var v=f.keyBuffer,C=0;T.isPlaying=!0,T.replaySearchQueries=f.searchQueries.slice(0);for(var E=0;E<v.length;E++)for(var D=v[E],Q,z,W=/<(?:[CSMA]-)*\w+>|./gi;Q=W.exec(D);)if(z=Q[0],Qe.handleKey(x,z,"macro"),P.insertMode){var G=f.insertModeChanges[C++].changes;Se.macroModeState.lastInsertModeChanges.changes=G,wn(x,G,1),Ze(x)}T.isPlaying=!1}function at(x,P){if(!x.isPlaying){var T=x.latestRegister,p=Se.registerController.getRegister(T);p&&p.pushText(P)}}function tt(x){if(!x.isPlaying){var P=x.latestRegister,T=Se.registerController.getRegister(P);T&&T.pushInsertModeChanges&&T.pushInsertModeChanges(x.lastInsertModeChanges)}}function Ue(x,P){if(!x.isPlaying){var T=x.latestRegister,p=Se.registerController.getRegister(T);p&&p.pushSearchQuery&&p.pushSearchQuery(P)}}function Je(x,P){var T=Se.macroModeState,p=T.lastInsertModeChanges;if(!T.isPlaying)for(var f=x.state.vim;P;){if(p.expectCursorActivityForChange=!0,p.ignoreCount>1)p.ignoreCount--;else if(P.origin=="+input"||P.origin=="paste"||P.origin===void 0){var v=x.listSelections().length;v>1&&(p.ignoreCount=v);var C=P.text.join(`
`);if(p.maybeReset&&(p.changes=[],p.maybeReset=!1),C)if(x.state.overwrite&&!/\n/.test(C))p.changes.push([C]);else{if(C.length>1){var E=f&&f.insertEnd&&f.insertEnd.find(),D=x.getCursor();if(E&&E.line==D.line){var Q=E.ch-D.ch;Q>0&&Q<C.length&&(p.changes.push([C,Q]),C="")}}C&&p.changes.push(C)}}P=P.next}}function Me(x){var f;var P=x.state.vim;if(P.insertMode){var T=Se.macroModeState;if(T.isPlaying)return;var p=T.lastInsertModeChanges;p.expectCursorActivityForChange?p.expectCursorActivityForChange=!1:(p.maybeReset=!0,P.insertEnd&&P.insertEnd.clear(),P.insertEnd=x.setBookmark(x.getCursor(),{insertLeft:!0}))}else(f=x.curOp)!=null&&f.isVimOp||He(x,P)}function He(x,P){var T=x.getCursor("anchor"),p=x.getCursor("head");if(P.visualMode&&!x.somethingSelected()?be(x,!1):!P.visualMode&&!P.insertMode&&x.somethingSelected()&&(P.visualMode=!0,P.visualLine=!1,n.signal(x,"vim-mode-change",{mode:"visual"})),P.visualMode){var f=$t(p,T)?0:-1,v=$t(p,T)?-1:0;p=et(p,0,f),T=et(T,0,v),P.sel={anchor:T,head:p},Ls(x,P,"<",xn(p,T)),Ls(x,P,">",st(p,T))}else P.insertMode||(P.lastHPos=x.getCursor().ch)}function zt(x,P){this.keyName=x,this.key=P.key,this.ctrlKey=P.ctrlKey,this.altKey=P.altKey,this.metaKey=P.metaKey,this.shiftKey=P.shiftKey}function Tt(x){var P=Se.macroModeState,T=P.lastInsertModeChanges,p=n.keyName?n.keyName(x):x.key;p&&(p.indexOf("Delete")!=-1||p.indexOf("Backspace")!=-1)&&(T.maybeReset&&(T.changes=[],T.maybeReset=!1),T.changes.push(new zt(p,x)))}function hn(x,P,T,p){var f=Se.macroModeState;f.isPlaying=!0;var v=P.lastEditActionCommand,C=P.inputState;function E(){v?rt.processAction(x,P,v):rt.evalInput(x,P)}function D(z){if(f.lastInsertModeChanges.changes.length>0){z=P.lastEditActionCommand?z:1;var W=f.lastInsertModeChanges;wn(x,W.changes,z)}}if(P.inputState=P.lastEditInputState,v&&v.interlaceInsertRepeat)for(var Q=0;Q<T;Q++)E(),D(1);else p||E(),D(T);P.inputState=C,P.insertMode&&!p&&Ze(x),f.isPlaying=!1}function Bn(x,P){n.lookupKey(P,"vim-insert",function(T){return typeof T=="string"?n.commands[T](x):T(x),!0})}function wn(x,P,T){var p=x.getCursor("head"),f=Se.macroModeState.lastInsertModeChanges.visualBlock;f&&(w(x,p,f+1),T=x.listSelections().length,x.setCursor(p));for(var v=0;v<T;v++){f&&x.setCursor(et(p,v,0));for(var C=0;C<P.length;C++){var E=P[C];if(E instanceof zt)Bn(x,E.keyName);else if(typeof E=="string")x.replaceSelection(E);else{var D=x.getCursor(),Q=et(D,0,E[0].length-(E[1]||0));x.replaceRange(E[0],D,E[1]?D:Q),x.setCursor(Q)}}}f&&x.setCursor(et(p,0,1))}function os(x){var P=new x.constructor;return Object.keys(x).forEach(function(T){if(T!="insertEnd"){var p=x[T];Array.isArray(p)?p=p.slice():p&&typeof p=="object"&&p.constructor!=Object&&(p=os(p)),P[T]=p}}),x.sel&&(P.sel={head:x.sel.head&&Wt(x.sel.head),anchor:x.sel.anchor&&Wt(x.sel.anchor)}),P}function Ps(x,P,T){var v=De(x),p=x,f=!1,v=Qe.maybeInitVimState_(p),C=v.visualBlock||v.wasInVisualBlock,E=p.isInMultiSelectMode();if(v.wasInVisualBlock&&!E?v.wasInVisualBlock=!1:E&&v.visualBlock&&(v.wasInVisualBlock=!0),P=="<Esc>"&&!v.insertMode&&!v.visualMode&&E&&v.status=="<Esc>")un(p);else if(C||!E||p.inVirtualSelectionMode)f=Qe.handleKey(p,P,T);else{var D=os(v),Q=v.inputState.changeQueueList||[];p.operation(function(){var W;p.curOp&&(p.curOp.isVimOp=!0);var z=0;p.forEachSelection(function(){p.state.vim.inputState.changeQueue=Q[z];var G=p.getCursor("head"),X=p.getCursor("anchor"),re=$t(G,X)?0:-1,de=$t(G,X)?-1:0;G=et(G,0,re),X=et(X,0,de),p.state.vim.sel.head=G,p.state.vim.sel.anchor=X,f=Qe.handleKey(p,P,T),p.virtualSelection&&(Q[z]=p.state.vim.inputState.changeQueue,p.state.vim=os(D)),z++}),(W=p.curOp)!=null&&W.cursorActivity&&!f&&(p.curOp.cursorActivity=!1),p.state.vim=v,v.inputState.changeQueueList=Q,v.inputState.changeQueue=null},!0)}return f&&!v.visualMode&&!v.insert&&v.visualMode!=p.somethingSelected()&&He(p,v),f}return ae(),Qe}function Oi(n,e){var t=e.ch,s=e.line+1;s<1&&(s=1,t=0),s>n.lines&&(s=n.lines,t=Number.MAX_VALUE);var r=n.line(s);return Math.min(r.from+Math.max(0,t),r.to)}function zi(n,e){let t=n.lineAt(e);return{line:t.number-1,ch:e-t.from}}class dl{constructor(e,t){this.line=e,this.ch=t}}function CW(n,e,t){if(n.addEventListener)n.addEventListener(e,t,!1);else{var s=n._handlers||(n._handlers={});s[e]=(s[e]||[]).concat(t)}}function PW(n,e,t){if(n.removeEventListener)n.removeEventListener(e,t,!1);else{var s=n._handlers,r=s&&s[e];if(r){var a=r.indexOf(t);a>-1&&(s[e]=r.slice(0,a).concat(r.slice(a+1)))}}}function AW(n,e,...t){var s,r=(s=n._handlers)===null||s===void 0?void 0:s[e];if(r)for(var a=0;a<r.length;++a)r[a](...t)}function l7(n,...e){if(n)for(var t=0;t<n.length;++t)n[t](...e)}let XS;try{XS=new RegExp("[\\w\\p{Alphabetic}\\p{Number}_]","u")}catch{XS=/[\w]/}function vm(n,e){var t=n.cm6;if(!t.state.readOnly){var s="input.type.compose";if(n.curOp&&(n.curOp.lastChange||(s="input.type.compose.start")),e.annotations)try{e.annotations.some(function(r){r.value=="input"&&(r.value=s)})}catch(r){console.error(r)}else e.userEvent=s;return t.dispatch(e)}}function c7(n,e){var t;n.curOp&&(n.curOp.$changeStart=void 0),(e?Zv:Gd)(n.cm6);let s=(t=n.curOp)===null||t===void 0?void 0:t.$changeStart;s!=null&&n.cm6.dispatch({selection:{anchor:s}})}var ePe={};class Fn{constructor(e){this.state={},this.marks=Object.create(null),this.$mid=0,this.options={},this._handlers={},this.$lastChangeEndOffset=0,this.virtualSelection=null,this.cm6=e,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this)}openDialog(e,t,s){return nPe(this,e,t,s)}openNotification(e,t){return tPe(this,e,t)}on(e,t){CW(this,e,t)}off(e,t){PW(this,e,t)}signal(e,t,s){AW(this,e,t,s)}indexFromPos(e){return Oi(this.cm6.state.doc,e)}posFromIndex(e){return zi(this.cm6.state.doc,e)}foldCode(e){let t=this.cm6,s=t.state.selection.ranges,r=this.cm6.state.doc,a=Oi(r,e),i=Ve.create([Ve.range(a,a)],0).ranges;t.state.selection.ranges=i,Zq(t),t.state.selection.ranges=s}firstLine(){return 0}lastLine(){return this.cm6.state.doc.lines-1}lineCount(){return this.cm6.state.doc.lines}setCursor(e,t){typeof e=="object"&&(t=e.ch,e=e.line);var s=Oi(this.cm6.state.doc,{line:e,ch:t||0});this.cm6.dispatch({selection:{anchor:s}},{scrollIntoView:!this.curOp}),this.curOp&&!this.curOp.isVimOp&&this.onBeforeEndOperation()}getCursor(e){var t=this.cm6.state.selection.main,s=e=="head"||!e?t.head:e=="anchor"?t.anchor:e=="start"?t.from:e=="end"?t.to:null;if(s==null)throw new Error("Invalid cursor type");return this.posFromIndex(s)}listSelections(){var e=this.cm6.state.doc;return this.cm6.state.selection.ranges.map(t=>({anchor:zi(e,t.anchor),head:zi(e,t.head)}))}setSelections(e,t){var s=this.cm6.state.doc,r=e.map(a=>{var i=Oi(s,a.head),o=Oi(s,a.anchor);return i==o?Ve.cursor(i,1):Ve.range(o,i)});this.cm6.dispatch({selection:Ve.create(r,t)})}setSelection(e,t,s){this.setSelections([{anchor:e,head:t}],0),s&&s.origin=="*mouse"&&this.onBeforeEndOperation()}getLine(e){var t=this.cm6.state.doc;return e<0||e>=t.lines?"":this.cm6.state.doc.line(e+1).text}getLineHandle(e){return this.$lineHandleChanges||(this.$lineHandleChanges=[]),{row:e,index:this.indexFromPos(new dl(e,0))}}getLineNumber(e){var t=this.$lineHandleChanges;if(!t)return null;for(var s=e.index,r=0;r<t.length;r++)if(s=t[r].changes.mapPos(s,1,mr.TrackAfter),s==null)return null;var a=this.posFromIndex(s);return a.ch==0?a.line:null}releaseLineHandles(){this.$lineHandleChanges=void 0}getRange(e,t){var s=this.cm6.state.doc;return this.cm6.state.sliceDoc(Oi(s,e),Oi(s,t))}replaceRange(e,t,s,r){s||(s=t);var a=this.cm6.state.doc,i=Oi(a,t),o=Oi(a,s);vm(this,{changes:{from:i,to:o,insert:e}})}replaceSelection(e){vm(this,this.cm6.state.replaceSelection(e))}replaceSelections(e){var t=this.cm6.state.selection.ranges,s=t.map((r,a)=>({from:r.from,to:r.to,insert:e[a]||""}));vm(this,{changes:s})}getSelection(){return this.getSelections().join(`
`)}getSelections(){var e=this.cm6;return e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to))}somethingSelected(){return this.cm6.state.selection.ranges.some(e=>!e.empty)}getInputField(){return this.cm6.contentDOM}clipPos(e){var t=this.cm6.state.doc,s=e.ch,r=e.line+1;r<1&&(r=1,s=0),r>t.lines&&(r=t.lines,s=Number.MAX_VALUE);var a=t.line(r);return s=Math.min(Math.max(0,s),a.to-a.from),new dl(r-1,s)}getValue(){return this.cm6.state.doc.toString()}setValue(e){var t=this.cm6;return t.dispatch({changes:{from:0,to:t.state.doc.length,insert:e},selection:Ve.range(0,0)})}focus(){return this.cm6.focus()}blur(){return this.cm6.contentDOM.blur()}defaultTextHeight(){return this.cm6.defaultLineHeight}findMatchingBracket(e,t){var s=this.cm6.state,r=Oi(s.doc,e),a=ro(s,r+1,-1);return a&&a.end?{to:zi(s.doc,a.end.from)}:(a=ro(s,r,1),a&&a.end?{to:zi(s.doc,a.end.from)}:{to:void 0})}scanForBracket(e,t,s,r){return aPe(this,e,t,s,r)}indentLine(e,t){t?this.indentMore():this.indentLess()}indentMore(){Tf(this.cm6)}indentLess(){Bf(this.cm6)}execCommand(e){if(e=="indentAuto")Fn.commands.indentAuto(this);else if(e=="goLineLeft")i1(this.cm6);else if(e=="goLineRight"){a1(this.cm6);let t=this.cm6.state,s=t.selection.main.head;s<t.doc.length&&t.sliceDoc(s,s+1)!==`
`&&L2e(this.cm6)}else console.log(e+" is not implemented")}setBookmark(e,t){var s=t!=null&&t.insertLeft?1:-1,r=this.indexFromPos(e),a=new lPe(this,r,s);return a}addOverlay({query:e}){let t=new $E({regexp:!0,search:e.source,caseSensitive:!/i/.test(e.flags)});if(t.valid){t.forVim=!0,this.cm6Query=t;let s=ku.of(t);return this.cm6.dispatch({effects:s}),t}}removeOverlay(e){if(!this.cm6Query)return;this.cm6Query.forVim=!1;let t=ku.of(this.cm6Query);this.cm6.dispatch({effects:t})}getSearchCursor(e,t){var s=this,r=null,a=null;t.ch==null&&(t.ch=Number.MAX_VALUE);var i=Oi(s.cm6.state.doc,t),o=e.source.replace(/(\\.|{(?:\d+(?:,\d*)?|,\d+)})|[{}]/g,function(d,m){return m||"\\"+d});function l(d,m=0,y=d.length){return new FE(d,o,{ignoreCase:e.ignoreCase},m,y)}function c(d){var m=s.cm6.state.doc;if(d>m.length)return null;let y=l(m,d).next();return y.done?null:y.value}var u=1e4;function h(d,m){var y=s.cm6.state.doc;for(let O=1;;O++){let S=Math.max(d,m-O*u),A=l(y,S,m),F=null;for(;!A.next().done;)F=A.value;if(F&&(S==d||F.from>S+10))return F;if(S==d)return null}}return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(d){var m=s.cm6.state.doc;if(d){let y=r?r.from==r.to?r.to-1:r.from:i;r=h(0,y)}else{let y=r?r.from==r.to?r.to+1:r.to:i;r=c(y)}return a=r&&{from:zi(m,r.from),to:zi(m,r.to),match:r.match},r&&r.match},from:function(){return a==null?void 0:a.from},to:function(){return a==null?void 0:a.to},replace:function(d){r&&(vm(s,{changes:{from:r.from,to:r.to,insert:d}}),r.to=r.from+d.length,a&&(a.to=zi(s.cm6.state.doc,r.to)))}}}findPosV(e,t,s,r){let{cm6:a}=this;const i=a.state.doc;let o=s=="page"?a.dom.clientHeight:0;const l=Oi(i,e);let c=Ve.cursor(l,1,void 0,r),u=Math.round(Math.abs(t));for(let d=0;d<u;d++)s=="page"?c=a.moveVertically(c,t>0,o):s=="line"&&(c=a.moveVertically(c,t>0));let h=zi(i,c.head);return(t<0&&c.head==0&&r!=0&&e.line==0&&e.ch!=0||t>0&&c.head==i.length&&h.ch!=r&&e.line==h.line)&&(h.hitSide=!0),h}charCoords(e,t){var s=this.cm6.contentDOM.getBoundingClientRect(),r=Oi(this.cm6.state.doc,e),a=this.cm6.coordsAtPos(r),i=-s.top;return{left:((a==null?void 0:a.left)||0)-s.left,top:((a==null?void 0:a.top)||0)+i,bottom:((a==null?void 0:a.bottom)||0)+i}}coordsChar(e,t){var s=this.cm6.contentDOM.getBoundingClientRect(),r=this.cm6.posAtCoords({x:e.left+s.left,y:e.top+s.top})||0;return zi(this.cm6.state.doc,r)}getScrollInfo(){var e=this.cm6.scrollDOM;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight,width:e.scrollWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}scrollTo(e,t){e!=null&&(this.cm6.scrollDOM.scrollLeft=e),t!=null&&(this.cm6.scrollDOM.scrollTop=t)}scrollIntoView(e,t){if(e){var s=this.indexFromPos(e);this.cm6.dispatch({effects:vt.scrollIntoView(s)})}else this.cm6.dispatch({scrollIntoView:!0,userEvent:"scroll"})}getWrapperElement(){return this.cm6.dom}getMode(){return{name:this.getOption("mode")}}setSize(e,t){this.cm6.dom.style.width=e+4+"px",this.cm6.dom.style.height=t+"px",this.refresh()}refresh(){this.cm6.measure()}destroy(){this.removeOverlay()}getLastEditEnd(){return this.posFromIndex(this.$lastChangeEndOffset)}onChange(e){this.$lineHandleChanges&&this.$lineHandleChanges.push(e);for(let s in this.marks)this.marks[s].update(e.changes);this.virtualSelection&&(this.virtualSelection.ranges=this.virtualSelection.ranges.map(s=>s.map(e.changes)));var t=this.curOp=this.curOp||{};e.changes.iterChanges((s,r,a,i,o)=>{(t.$changeStart==null||t.$changeStart>a)&&(t.$changeStart=a),this.$lastChangeEndOffset=i;var l={text:o.toJSON()};t.lastChange?t.lastChange.next=t.lastChange=l:t.lastChange=t.change=l},!0),t.changeHandlers||(t.changeHandlers=this._handlers.change&&this._handlers.change.slice())}onSelectionChange(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._handlers.cursorActivity&&this._handlers.cursorActivity.slice()),this.curOp.cursorActivity=!0}operation(e,t){this.curOp||(this.curOp={$d:0}),this.curOp.$d++;try{var s=e()}finally{this.curOp&&(this.curOp.$d--,this.curOp.$d||this.onBeforeEndOperation())}return s}onBeforeEndOperation(){var e=this.curOp,t=!1;e&&(e.change&&l7(e.changeHandlers,this,e.change),e&&e.cursorActivity&&(l7(e.cursorActivityHandlers,this,null),e.isVimOp&&(t=!0)),this.curOp=null),t&&this.scrollIntoView()}moveH(e,t){if(t=="char"){var s=this.getCursor();this.setCursor(s.line,s.ch+e)}}setOption(e,t){switch(e){case"keyMap":this.state.keyMap=t;break;case"textwidth":this.state.textwidth=t;break}}getOption(e){switch(e){case"firstLineNumber":return 1;case"tabSize":return this.cm6.state.tabSize||4;case"readOnly":return this.cm6.state.readOnly;case"indentWithTabs":return this.cm6.state.facet(Wd)=="	";case"indentUnit":return this.cm6.state.facet(Wd).length||2;case"textwidth":return this.state.textwidth;case"keyMap":return this.state.keyMap||"vim"}}toggleOverwrite(e){this.state.overwrite=e}getTokenTypeAt(e){var t,s=this.indexFromPos(e),r=Tq(this.cm6.state,s),a=r==null?void 0:r.resolve(s),i=((t=a==null?void 0:a.type)===null||t===void 0?void 0:t.name)||"";return/comment/i.test(i)?"comment":/string/i.test(i)?"string":""}overWriteSelection(e){var t=this.cm6.state.doc,s=this.cm6.state.selection,r=s.ranges.map(a=>{if(a.empty){var i=a.to<t.length?t.sliceString(a.from,a.to+1):"";if(i&&!/\n/.test(i))return Ve.range(a.from,a.to+1)}return a});this.cm6.dispatch({selection:Ve.create(r,s.mainIndex)}),this.replaceSelection(e)}isInMultiSelectMode(){return this.cm6.state.selection.ranges.length>1}virtualSelectionMode(){return!!this.virtualSelection}forEachSelection(e){var t=this.cm6.state.selection;this.virtualSelection=Ve.create(t.ranges,t.mainIndex);for(var s=0;s<this.virtualSelection.ranges.length;s++){var r=this.virtualSelection.ranges[s];r&&(this.cm6.dispatch({selection:Ve.create([r])}),e(),this.virtualSelection.ranges[s]=this.cm6.state.selection.ranges[0])}this.cm6.dispatch({selection:this.virtualSelection}),this.virtualSelection=null}hardWrap(e){return cPe(this,e)}}Fn.isMac=typeof navigator<"u"&&/Mac/.test(navigator.platform);Fn.Pos=dl;Fn.StringStream=Ake;Fn.commands={cursorCharLeft:function(n){Mf(n.cm6)},redo:function(n){c7(n,!1)},undo:function(n){c7(n,!0)},newlineAndIndent:function(n){Df({state:n.cm6.state,dispatch:e=>vm(n,e)})},indentAuto:function(n){KU(n.cm6)},newlineAndIndentContinueComment:void 0,save:void 0};Fn.isWordChar=function(n){return XS.test(n)};Fn.keys=ePe;Fn.addClass=function(n,e){};Fn.rmClass=function(n,e){};Fn.e_preventDefault=function(n){n.preventDefault()};Fn.e_stop=function(n){var e,t;(e=n==null?void 0:n.stopPropagation)===null||e===void 0||e.call(n),(t=n==null?void 0:n.preventDefault)===null||t===void 0||t.call(n)};Fn.lookupKey=function(n,e,t){var s=Fn.keys[n];s&&t(s)};Fn.on=CW;Fn.off=PW;Fn.signal=AW;Fn.findMatchingTag=iPe;Fn.findEnclosingTag=oPe;Fn.keyName=void 0;function EW(n,e,t){var s=document.createElement("div");return s.appendChild(e),s}function MW(n,e){n.state.currentNotificationClose&&n.state.currentNotificationClose(),n.state.currentNotificationClose=e}function tPe(n,e,t){MW(n,o);var s=EW(n,e,t&&t.bottom),r=!1,a,i=t&&typeof t.duration<"u"?t.duration:5e3;function o(){r||(r=!0,clearTimeout(a),s.remove(),TW(n,s))}return s.onclick=function(l){l.preventDefault(),o()},DW(n,s),i&&(a=setTimeout(o,i)),o}function DW(n,e){var t=n.state.dialog;n.state.dialog=e,e&&t!==e&&(t&&t.contains(document.activeElement)&&n.focus(),t&&t.parentElement?t.parentElement.replaceChild(e,t):t&&t.remove(),Fn.signal(n,"dialog"))}function TW(n,e){n.state.dialog==e&&(n.state.dialog=null,Fn.signal(n,"dialog"))}function nPe(n,e,t,s){s||(s={}),MW(n,void 0);var r=EW(n,e,s.bottom),a=!1;DW(n,r);function i(l){if(typeof l=="string")o.value=l;else{if(a)return;a=!0,TW(n,r),n.state.dialog||n.focus(),s.onClose&&s.onClose(r)}}var o=r.getElementsByTagName("input")[0];return o&&(s.value&&(o.value=s.value,s.selectValueOnOpen!==!1&&o.select()),s.onInput&&Fn.on(o,"input",function(l){s.onInput(l,o.value,i)}),s.onKeyUp&&Fn.on(o,"keyup",function(l){s.onKeyUp(l,o.value,i)}),Fn.on(o,"keydown",function(l){s&&s.onKeyDown&&s.onKeyDown(l,o.value,i)||(l.keyCode==13&&t(o.value),(l.keyCode==27||s.closeOnEnter!==!1&&l.keyCode==13)&&(o.blur(),Fn.e_stop(l),i()))}),s.closeOnBlur!==!1&&Fn.on(o,"blur",function(){setTimeout(function(){document.activeElement!==o&&i()})}),o.focus()),i}var sPe={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function rPe(n){return n&&n.bracketRegex||/[(){}[\]]/}function aPe(n,e,t,s,r){for(var a=r&&r.maxScanLineLength||1e4,i=r&&r.maxScanLines||1e3,o=[],l=rPe(r),c=t>0?Math.min(e.line+i,n.lastLine()+1):Math.max(n.firstLine()-1,e.line-i),u=e.line;u!=c;u+=t){var h=n.getLine(u);if(h){var d=t>0?0:h.length-1,m=t>0?h.length:-1;if(!(h.length>a))for(u==e.line&&(d=e.ch-(t<0?1:0));d!=m;d+=t){var y=h.charAt(d);if(l.test(y)){var O=sPe[y];if(O&&O.charAt(1)==">"==t>0)o.push(y);else if(o.length)o.pop();else return{pos:new dl(u,d),ch:y}}}}}return u-t==(t>0?n.lastLine():n.firstLine())?!1:null}function iPe(n,e){}function oPe(n,e){var t,s,r=n.cm6.state,a=n.indexFromPos(e);if(a<r.doc.length){var i=r.sliceDoc(a,a+1);i=="<"&&a++}for(var o=Tq(r,a),l=(o==null?void 0:o.resolve(a))||null;l;){if(((t=l.firstChild)===null||t===void 0?void 0:t.type.name)=="OpenTag"&&((s=l.lastChild)===null||s===void 0?void 0:s.type.name)=="CloseTag")return{open:u7(r.doc,l.firstChild),close:u7(r.doc,l.lastChild)};l=l.parent}}function u7(n,e){return{from:zi(n,e.from),to:zi(n,e.to)}}class lPe{constructor(e,t,s){this.cm=e,this.id=e.$mid++,this.offset=t,this.assoc=s,e.marks[this.id]=this}clear(){delete this.cm.marks[this.id]}find(){return this.offset==null?null:this.cm.posFromIndex(this.offset)}update(e){this.offset!=null&&(this.offset=e.mapPos(this.offset,this.assoc,mr.TrackDel))}}function cPe(n,e){for(var t,s=e.column||n.getOption("textwidth")||80,r=e.allowMerge!=!1,a=Math.min(e.from,e.to),i=Math.max(e.from,e.to);a<=i;){var o=n.getLine(a);if(o.length>s){var l=y(o,s,5);if(l){var c=(t=/^\s*/.exec(o))===null||t===void 0?void 0:t[0];n.replaceRange(`
`+c,new dl(a,l.start),new dl(a,l.end))}i++}else if(r&&/\S/.test(o)&&a!=i){var u=n.getLine(a+1);if(u&&/\S/.test(u)){var h=o.replace(/\s+$/,""),d=u.replace(/^\s+/,""),m=h+" "+d,l=y(m,s,5);l&&l.start>h.length||m.length<s?(n.replaceRange(" ",new dl(a,h.length),new dl(a+1,u.length-d.length)),a--,i--):h.length<o.length&&n.replaceRange("",new dl(a,h.length),new dl(a,o.length))}}a++}return a;function y(O,S,A){if(!(O.length<S)){var F=O.slice(0,S),j=O.slice(S),N=/^(?:(\s+)|(\S+)(\s+))/.exec(j),$=/(?:(\s+)|(\s+)(\S+))$/.exec(F),L=0,I=0;if($&&!$[2]&&(L=S-$[1].length,I=S),N&&!N[2]&&(L||(L=S),I=S+N[1].length),L)return{start:L,end:I};if($&&$[2]&&$.index>A)return{start:$.index,end:$.index+$[2].length};if(N&&N[2])return L=S+N[2].length,{start:L,end:L+N[3].length}}}}let HS=pq;class uPe{constructor(e,t,s,r,a,i,o,l,c,u){this.left=e,this.top=t,this.height=s,this.fontFamily=r,this.fontSize=a,this.fontWeight=i,this.color=o,this.className=l,this.letter=c,this.partial=u}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.height=this.height+"px",e.style.lineHeight=this.height+"px",e.style.fontFamily=this.fontFamily,e.style.fontSize=this.fontSize,e.style.fontWeight=this.fontWeight,e.style.color=this.partial?"transparent":this.color,e.className=this.className,e.textContent=this.letter}eq(e){return this.left==e.left&&this.top==e.top&&this.height==e.height&&this.fontFamily==e.fontFamily&&this.fontSize==e.fontSize&&this.fontWeight==e.fontWeight&&this.color==e.color&&this.className==e.className&&this.letter==e.letter}}class hPe{constructor(e,t){this.view=e,this.rangePieces=[],this.cursors=[],this.cm=t,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let e=HS(this.cm.cm6.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=e+"ms"}update(e){(e.selectionSet||e.geometryChanged||e.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),dPe(e)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:e}=this.view,t=[];for(let s of e.selection.ranges){let r=s==e.selection.main,a=gPe(this.cm,this.view,s,r);a&&t.push(a)}return{cursors:t}}drawSel({cursors:e}){if(e.length!=this.cursors.length||e.some((t,s)=>!t.eq(this.cursors[s]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const s of e)this.cursorLayer.appendChild(s.draw())}else e.forEach((s,r)=>s.adjust(t[r]));this.cursors=e}}destroy(){this.cursorLayer.remove()}}function dPe(n){return HS(n.startState)!=HS(n.state)}const pPe={".cm-vimMode .cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}},mPe=ui.highest(vt.theme(pPe));function fPe(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Ss.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function gPe(n,e,t,s){var r,a;let i=t.head,o=!1,l=1,c=n.state.vim;if(c&&(!c.insertMode||n.state.overwrite)){if(o=!0,c.visualBlock&&!s)return null;t.anchor<t.head&&i--,n.state.overwrite?l=.2:c.status&&(l=.5)}if(o){let h=i<e.state.doc.length&&e.state.sliceDoc(i,i+1);h&&/[\uDC00-\uDFFF]/.test(h)&&i>1&&(i--,h=e.state.sliceDoc(i,i+1));let d=e.coordsAtPos(i,1);if(!d)return null;let m=fPe(e),y=e.domAtPos(i),O=y?y.node:e.contentDOM;for(;y&&y.node instanceof HTMLElement;)O=y.node,y={node:y.node.childNodes[y.offset],offset:0};if(!(O instanceof HTMLElement)){if(!O.parentNode)return null;O=O.parentNode}let S=getComputedStyle(O),A=d.left,F=(a=(r=e).coordsForChar)===null||a===void 0?void 0:a.call(r,i);if(F&&(A=F.left),!h||h==`
`||h=="\r")h=" ";else if(h=="	"){h=" ";var u=e.coordsAtPos(i+1,-1);u&&(A=u.left-(u.left-d.left)/parseInt(S.tabSize))}else/[\uD800-\uDBFF]/.test(h)&&i<e.state.doc.length-1&&(h+=e.state.sliceDoc(i+1,i+2));let j=d.bottom-d.top;return new uPe(A-m.left,d.top-m.top+j*(1-l),j*l,S.fontFamily,S.fontSize,S.fontWeight,S.color,s?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",h,l!=1)}else return null}var bPe=typeof navigator<"u"&&/linux/i.test(navigator.platform)&&/ Gecko\/\d+/.exec(navigator.userAgent);const Ru=JCe(Fn),yPe=250,vPe=vt.baseTheme({".cm-vimMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"0px 10px",fontFamily:"monospace",minHeight:"1.3em"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"inherit"},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"}}),OPe=nr.fromClass(class{constructor(n){this.status="",this.query=null,this.decorations=Yt.none,this.waitForCopy=!1,this.lastKeydown="",this.useNextTextInput=!1,this.compositionText="",this.view=n;const e=this.cm=new Fn(n);Ru.enterVimMode(this.cm),this.view.cm=this.cm,this.cm.state.vimPlugin=this,this.blockCursor=new hPe(n,e),this.updateClass(),this.cm.on("vim-command-done",()=>{e.state.vim&&(e.state.vim.status=""),this.blockCursor.scheduleRedraw(),this.updateStatus()}),this.cm.on("vim-mode-change",t=>{e.state.vim&&(e.state.vim.mode=t.mode,t.subMode&&(e.state.vim.mode+=" block"),e.state.vim.status="",this.blockCursor.scheduleRedraw(),this.updateClass(),this.updateStatus())}),this.cm.on("dialog",()=>{this.cm.state.statusbar?this.updateStatus():n.dispatch({effects:BW.of(!!this.cm.state.dialog)})}),this.dom=document.createElement("span"),this.dom.style.cssText="position: absolute; right: 10px; top: 1px",this.statusButton=document.createElement("span"),this.statusButton.onclick=t=>{Ru.handleKey(this.cm,"<Esc>","user"),this.cm.focus()},this.statusButton.style.cssText="cursor: pointer"}update(n){var e;if((n.viewportChanged||n.docChanged)&&this.query&&this.highlight(this.query),n.docChanged&&this.cm.onChange(n),n.selectionSet&&this.cm.onSelectionChange(),n.viewportChanged,this.cm.curOp&&!this.cm.curOp.isVimOp&&this.cm.onBeforeEndOperation(),n.transactions){for(let t of n.transactions)for(let s of t.effects)if(s.is(ku))if(!(!((e=s.value)===null||e===void 0)&&e.forVim))this.highlight(null);else{let r=s.value.create();this.highlight(r)}}this.blockCursor.update(n)}updateClass(){const n=this.cm.state;!n.vim||n.vim.insertMode&&!n.overwrite?this.view.scrollDOM.classList.remove("cm-vimMode"):this.view.scrollDOM.classList.add("cm-vimMode")}updateStatus(){let n=this.cm.state.statusbar,e=this.cm.state.vim;if(!n||!e)return;let t=this.cm.state.dialog;if(t)t.parentElement!=n&&(n.textContent="",n.appendChild(t));else{n.textContent="";var s=(e.mode||"normal").toUpperCase();e.insertModeReturn&&(s+="(C-O)"),this.statusButton.textContent=`--${s}--`,n.appendChild(this.statusButton)}this.dom.textContent=e.status,n.appendChild(this.dom)}destroy(){Ru.leaveVimMode(this.cm),this.updateClass(),this.blockCursor.destroy(),delete this.view.cm}highlight(n){if(this.query=n,!n)return this.decorations=Yt.none;let{view:e}=this,t=new _l;for(let s=0,r=e.visibleRanges,a=r.length;s<a;s++){let{from:i,to:o}=r[s];for(;s<a-1&&o>r[s+1].from-2*yPe;)o=r[++s].to;n.highlight(e.state,i,o,(l,c)=>{t.add(l,c,xPe)})}return this.decorations=t.finish()}handleKey(n,e){const t=this.cm;let s=t.state.vim;if(!s)return;const r=Ru.vimKeyFromEvent(n,s);if(Fn.signal(this.cm,"inputEvent",{type:"handleKey",key:r}),!r)return;if(r=="<Esc>"&&!s.insertMode&&!s.visualMode&&this.query){const i=s.searchState_;i&&(t.removeOverlay(i.getOverlay()),i.setOverlay(null))}if(r==="<C-c>"&&!Fn.isMac&&t.somethingSelected())return this.waitForCopy=!0,!0;s.status=(s.status||"")+r;let a=Ru.multiSelectHandleKey(t,r,"user");return s=Ru.maybeInitVimState_(t),!a&&s.insertMode&&t.state.overwrite&&(n.key&&n.key.length==1&&!/\n/.test(n.key)?(a=!0,t.overWriteSelection(n.key)):n.key=="Backspace"&&(a=!0,Fn.commands.cursorCharLeft(t))),a&&(Fn.signal(this.cm,"vim-keypress",r),n.preventDefault(),n.stopPropagation(),this.blockCursor.scheduleRedraw()),this.updateStatus(),!!a}},{eventHandlers:{copy:function(n,e){this.waitForCopy&&(this.waitForCopy=!1,Promise.resolve().then(()=>{var t=this.cm,s=t.state.vim;s&&(s.insertMode?t.setSelection(t.getCursor(),t.getCursor()):t.operation(()=>{t.curOp&&(t.curOp.isVimOp=!0),Ru.handleKey(t,"<Esc>","user")}))}))},compositionstart:function(n,e){this.useNextTextInput=!0,Fn.signal(this.cm,"inputEvent",n)},compositionupdate:function(n,e){Fn.signal(this.cm,"inputEvent",n)},compositionend:function(n,e){Fn.signal(this.cm,"inputEvent",n)},keypress:function(n,e){Fn.signal(this.cm,"inputEvent",n),this.lastKeydown=="Dead"&&this.handleKey(n,e)},keydown:function(n,e){Fn.signal(this.cm,"inputEvent",n),this.lastKeydown=n.key,this.lastKeydown=="Unidentified"||this.lastKeydown=="Process"||this.lastKeydown=="Dead"?this.useNextTextInput=!0:(this.useNextTextInput=!1,this.handleKey(n,e))}},provide:()=>[vt.inputHandler.of((n,e,t,s)=>{var r,a,i=APe(n);if(!i)return!1;var o=(r=i.state)===null||r===void 0?void 0:r.vim,l=i.state.vimPlugin;if(o&&!o.insertMode&&!(!((a=i.curOp)===null||a===void 0)&&a.isVimOp)){if(s==="\0\0")return!0;if(Fn.signal(i,"inputEvent",{type:"text",text:s,from:e,to:t}),s.length==1&&l.useNextTextInput){if(o.expectLiteralNext&&n.composing)return l.compositionText=s,!1;if(l.compositionText){var c=l.compositionText;l.compositionText="";var u=n.state.selection.main.head,h=n.state.sliceDoc(u-c.length,u);if(c===h){var d=i.getCursor();i.replaceRange("",i.posFromIndex(u-c.length),d)}}return l.handleKey({key:s,preventDefault:()=>{},stopPropagation:()=>{}}),wPe(n),!0}}return!1})],decorations:n=>n.decorations});function wPe(n){var e=n.scrollDOM.parentElement;if(e){if(bPe){n.contentDOM.textContent="\0\0",n.contentDOM.dispatchEvent(new CustomEvent("compositionend"));return}var t=n.scrollDOM.nextSibling,s=window.getSelection(),r=s&&{anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset};n.scrollDOM.remove(),e.insertBefore(n.scrollDOM,t);try{r&&s&&(s.setPosition(r.anchorNode,r.anchorOffset),r.focusNode&&s.extend(r.focusNode,r.focusOffset))}catch(a){console.error(a)}n.focus(),n.contentDOM.dispatchEvent(new CustomEvent("compositionend"))}}const xPe=Yt.mark({class:"cm-searchMatch"}),BW=ln.define(),kPe=Us.define({create:()=>!1,update(n,e){for(let t of e.effects)t.is(BW)&&(n=t.value);return n},provide:n=>Ou.from(n,e=>e?SPe:null)});function SPe(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.dialog&&e.appendChild(t.state.dialog),{top:!1,dom:e}}function CPe(n){let e=document.createElement("div");e.className="cm-vim-panel";let t=n.cm;return t.state.statusbar=e,t.state.vimPlugin.updateStatus(),{dom:e}}function PPe(n={}){return[vPe,OPe,mPe,n.status?Ou.of(CPe):kPe]}function APe(n){return n.cm||null}class h7{constructor(e,t,s){this.from=e,this.to=t,this.diagnostic=s}}class Uu{constructor(e,t,s){this.diagnostics=e,this.panel=t,this.selected=s}static init(e,t,s){let r=e,a=s.facet($f).markerFilter;a&&(r=a(r,s));let i=e.slice().sort((h,d)=>h.from-d.from||h.to-d.to),o=new _l,l=[],c=0;for(let h=0;;){let d=h==i.length?null:i[h];if(!d&&!l.length)break;let m,y;for(l.length?(m=c,y=l.reduce((S,A)=>Math.min(S,A.to),d&&d.from>m?d.from:1e8)):(m=d.from,y=d.to,l.push(d),h++);h<i.length;){let S=i[h];if(S.from==m&&(S.to>S.from||S.to==m))l.push(S),h++,y=Math.min(S.to,y);else{y=Math.min(S.from,y);break}}let O=LPe(l);if(l.some(S=>S.from==S.to||S.from==S.to-1&&s.doc.lineAt(S.from).to==S.from))o.add(m,m,Yt.widget({widget:new NPe(O),diagnostics:l.slice()}));else{let S=l.reduce((A,F)=>F.markClass?A+" "+F.markClass:A,"");o.add(m,y,Yt.mark({class:"cm-lintRange cm-lintRange-"+O+S,diagnostics:l.slice(),inclusiveEnd:l.some(A=>A.to>y)}))}c=y;for(let S=0;S<l.length;S++)l[S].to<=c&&l.splice(S--,1)}let u=o.finish();return new Uu(u,t,Xd(u))}}function Xd(n,e=null,t=0){let s=null;return n.between(t,1e9,(r,a,{spec:i})=>{if(!(e&&i.diagnostics.indexOf(e)<0))if(!s)s=new h7(r,a,e||i.diagnostics[0]);else{if(i.diagnostics.indexOf(s.diagnostic)<0)return!1;s=new h7(s.from,a,s.diagnostic)}}),s}function EPe(n,e){let t=e.pos,s=e.end||t,r=n.state.facet($f).hideOn(n,t,s);if(r!=null)return r;let a=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(i=>i.is(FW))||n.changes.touchesRange(a.from,Math.max(a.to,s)))}function MPe(n,e){return n.field(Ti,!1)?e:e.concat(ln.appendConfig.of(QPe))}const FW=ln.define(),IE=ln.define(),$W=ln.define(),Ti=Us.define({create(){return new Uu(Yt.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),s=null,r=n.panel;if(n.selected){let a=e.changes.mapPos(n.selected.from,1);s=Xd(t,n.selected.diagnostic,a)||Xd(t,null,a)}!t.size&&r&&e.state.facet($f).autoPanel&&(r=null),n=new Uu(t,r,s)}for(let t of e.effects)if(t.is(FW)){let s=e.state.facet($f).autoPanel?t.value.length?Nf.open:null:n.panel;n=Uu.init(t.value,s,e.state)}else t.is(IE)?n=new Uu(n.diagnostics,t.value?Nf.open:null,n.selected):t.is($W)&&(n=new Uu(n.diagnostics,n.panel,t.value));return n},provide:n=>[Ou.from(n,e=>e.panel),vt.decorations.from(n,e=>e.diagnostics)]}),DPe=Yt.mark({class:"cm-lintRange cm-lintRange-active"});function TPe(n,e,t){let{diagnostics:s}=n.state.field(Ti),r,a=-1,i=-1;s.between(e-(t<0?1:0),e+(t>0?1:0),(l,c,{spec:u})=>{if(e>=l&&e<=c&&(l==c||(e>l||t>0)&&(e<c||t<0)))return r=u.diagnostics,a=l,i=c,!1});let o=n.state.facet($f).tooltipFilter;return r&&o&&(r=o(r,n.state)),r?{pos:a,end:i,above:n.state.doc.lineAt(a).to<i,create(){return{dom:BPe(n,r)}}}:null}function BPe(n,e){return Ts("ul",{class:"cm-tooltip-lint"},e.map(t=>_W(n,t,!1)))}const FPe=n=>{let e=n.state.field(Ti,!1);(!e||!e.panel)&&n.dispatch({effects:MPe(n.state,[IE.of(!0)])});let t=Sf(n,Nf.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},d7=n=>{let e=n.state.field(Ti,!1);return!e||!e.panel?!1:(n.dispatch({effects:IE.of(!1)}),!0)},$Pe=n=>{let e=n.state.field(Ti,!1);if(!e)return!1;let t=n.state.selection.main,s=e.diagnostics.iter(t.to+1);return!s.value&&(s=e.diagnostics.iter(0),!s.value||s.from==t.from&&s.to==t.to)?!1:(n.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0}),!0)},$f=_t.define({combine(n){return Object.assign({sources:n.map(e=>e.source).filter(e=>e!=null)},Tc(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?s=>e(s)||t(s):e:t}))}});function NW(n){let e=[];if(n)e:for(let{name:t}of n){for(let s=0;s<t.length;s++){let r=t[s];if(/[a-zA-Z]/.test(r)&&!e.some(a=>a.toLowerCase()==r.toLowerCase())){e.push(r);continue e}}e.push("")}return e}function _W(n,e,t){var s;let r=t?NW(e.actions):[];return Ts("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Ts("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(s=e.actions)===null||s===void 0?void 0:s.map((a,i)=>{let o=!1,l=d=>{if(d.preventDefault(),o)return;o=!0;let m=Xd(n.state.field(Ti).diagnostics,e);m&&a.apply(n,m.from,m.to)},{name:c}=a,u=r[i]?c.indexOf(r[i]):-1,h=u<0?c:[c.slice(0,u),Ts("u",c.slice(u,u+1)),c.slice(u+1)];return Ts("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${c}${u<0?"":` (access key "${r[i]})"`}.`},h)}),e.source&&Ts("div",{class:"cm-diagnosticSource"},e.source))}class NPe extends el{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Ts("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class p7{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=_W(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Nf{constructor(e){this.view=e,this.items=[];let t=r=>{if(r.keyCode==27)d7(this.view),this.view.focus();else if(r.keyCode==38||r.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(r.keyCode==40||r.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(r.keyCode==36)this.moveSelection(0);else if(r.keyCode==35)this.moveSelection(this.items.length-1);else if(r.keyCode==13)this.view.focus();else if(r.keyCode>=65&&r.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:a}=this.items[this.selectedIndex],i=NW(a.actions);for(let o=0;o<i.length;o++)if(i[o].toUpperCase().charCodeAt(0)==r.keyCode){let l=Xd(this.view.state.field(Ti).diagnostics,a);l&&a.actions[o].apply(e,l.from,l.to)}}else return;r.preventDefault()},s=r=>{for(let a=0;a<this.items.length;a++)this.items[a].dom.contains(r.target)&&this.moveSelection(a)};this.list=Ts("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:s}),this.dom=Ts("div",{class:"cm-panel-lint"},this.list,Ts("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>d7(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Ti).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Ti),s=0,r=!1,a=null,i=new Set;for(e.between(0,this.view.state.doc.length,(o,l,{spec:c})=>{for(let u of c.diagnostics){if(i.has(u))continue;i.add(u);let h=-1,d;for(let m=s;m<this.items.length;m++)if(this.items[m].diagnostic==u){h=m;break}h<0?(d=new p7(this.view,u),this.items.splice(s,0,d),r=!0):(d=this.items[h],h>s&&(this.items.splice(s,h-s),r=!0)),t&&d.diagnostic==t.diagnostic?d.dom.hasAttribute("aria-selected")||(d.dom.setAttribute("aria-selected","true"),a=d):d.dom.hasAttribute("aria-selected")&&d.dom.removeAttribute("aria-selected"),s++}});s<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();this.items.length==0&&(this.items.push(new p7(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),a?(this.list.setAttribute("aria-activedescendant",a.id),this.view.requestMeasure({key:this,read:()=>({sel:a.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let c=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/c:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let s=e;e=s.nextSibling,s.remove()}for(let s of this.items)if(s.dom.parentNode==this.list){for(;e!=s.dom;)t();e=s.dom.nextSibling}else this.list.insertBefore(s.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Ti),s=Xd(t.diagnostics,this.items[e].diagnostic);s&&this.view.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:$W.of(s)})}static open(e){return new Nf(e)}}function _Pe(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function k0(n){return _Pe(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const RPe=vt.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:k0("#d11")},".cm-lintRange-warning":{backgroundImage:k0("orange")},".cm-lintRange-info":{backgroundImage:k0("#999")},".cm-lintRange-hint":{backgroundImage:k0("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function IPe(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function LPe(n){let e="hint",t=1;for(let s of n){let r=IPe(s.severity);r>t&&(t=r,e=s.severity)}return e}const QPe=[Ti,vt.decorations.compute([Ti],n=>{let{selected:e,panel:t}=n.field(Ti);return!e||!t||e.from==e.to?Yt.none:Yt.set([DPe.range(e.from,e.to)])}),yq(TPe,{hideOn:EPe}),RPe],RW=n=>e=>{const t=n==="down";let s=e.state.selection;for(const r of s.ranges)s=s.addRange(e.moveVertically(r,t));return e.dispatch({selection:s}),!0},jPe=RW("up"),VPe=RW("down"),ZPe=n=>{let e=null;for(const t of n.state.selection.ranges)if(!t.empty)for(let s=t.from;s<=t.to;){const r=n.state.doc.lineAt(s),a=Math.min(r.to,t.to);e?e=e.addRange(Ve.range(a,a)):e=Ve.single(a),s=r.to+1}return e?(n.dispatch({selection:e}),!0):!1},zPe=[{key:"Ctrl-Space",run:$S},{key:"Escape",run:sU},{key:"ArrowDown",run:Yc(!0)},{key:"ArrowUp",run:Yc(!1)},{key:"PageDown",run:Yc(!0,"page")},{key:"PageUp",run:Yc(!1,"page")},{key:"Enter",run:FS},{key:"Tab",run:FS},{key:"Mod-f",run:kW,scope:"editor search-panel"},{key:"Escape",run:SW,scope:"editor search-panel"},{key:"Alt-Enter",run:vW,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:OW,scope:"editor search-panel"},{key:"Ctrl-g",run:xCe},{key:"Mod-d",run:PCe,preventDefault:!0},{key:"Shift-Mod-l",run:$Ce},{key:"Enter",run:Df,shift:Df},{key:"ArrowLeft",run:Mf,shift:o1,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:xU,shift:BU},{key:"ArrowRight",run:n1,shift:l1,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:kU,shift:FU},{key:"ArrowUp",run:s1,shift:c1,preventDefault:!0},{key:"ArrowDown",run:r1,shift:u1,preventDefault:!0},{key:"Home",run:i1,shift:RS},{mac:"Cmd-ArrowLeft",run:i1,shift:RS},{key:"Mod-Home",run:p1,shift:f1},{mac:"Cmd-ArrowUp",run:p1,shift:f1},{key:"PageUp",run:Qm,shift:h1},{mac:"Ctrl-ArrowUp",run:Qm,shift:h1},{key:"PageDown",run:vd,shift:d1},{mac:"Ctrl-ArrowDown",run:vd,shift:d1},{key:"End",run:a1,shift:_S},{mac:"Cmd-ArrowRight",run:a1,shift:_S},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:jPe,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:VPe,preventDefault:!0},{key:"Shift-Alt-i",run:ZPe},{key:"Mod-End",run:m1,shift:g1},{mac:"Cmd-ArrowDown",run:m1,shift:g1},{key:"Mod-a",run:IU},{key:"Backspace",run:cU},{key:"Backspace",run:Od,shift:Od},{key:"Delete",run:b1},{key:"Mod-Backspace",mac:"Alt-Backspace",run:y1},{key:"Mod-Delete",mac:"Alt-Delete",run:VU},{mac:"Mod-Backspace",run:K2e},{mac:"Mod-Delete",run:IS},{mac:"Ctrl-b",run:Mf,shift:o1,preventDefault:!0},{mac:"Ctrl-f",run:n1,shift:l1},{mac:"Ctrl-p",run:s1,shift:c1},{mac:"Ctrl-n",run:r1,shift:u1},{mac:"Ctrl-a",run:AU,shift:_U},{mac:"Ctrl-e",run:EU,shift:RU},{mac:"Ctrl-d",run:b1},{mac:"Ctrl-h",run:Od},{mac:"Ctrl-k",run:IS},{mac:"Ctrl-Alt-h",run:y1},{mac:"Ctrl-o",run:PE},{mac:"Ctrl-t",run:ZU},{mac:"Ctrl-v",run:vd},{mac:"Alt-v",run:Qm},{key:"Shift-Mod-k",run:HU},{key:"Alt-ArrowDown",run:UU},{key:"Alt-ArrowUp",run:qU},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:XU},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:GU},{key:"Mod-l",run:LU,preventDefault:!0},{key:"Shift-Mod-\\",run:MU},{key:"Tab",run:Tf,shift:Bf,preventDefault:!0},{key:"Mod-[",run:Bf},{key:"Mod-]",run:Tf},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Zq},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:lke},{key:"Mod-k Mod-0",run:cke},{key:"Mod-k Mod-j",run:uke},{key:"Mod-k Mod-c",run:P2e},{key:"Mod-k Mod-u",run:A2e},{key:"Mod-/",run:jv},{key:"Shift-Alt-a",run:xE},{key:"Mod-z",run:Zv,preventDefault:!0},{key:"Mod-y",run:Gd,preventDefault:!0},{key:"Mod-Shift-z",run:Gd,preventDefault:!0},{key:"Mod-u",run:bU,preventDefault:!0},{key:"Mod-Shift-m",run:FPe},{key:"F8",run:$Pe}],qPe=nr.fromClass(class{constructor(){}},{provide:()=>ui.highest(Bc.of([...zPe]))}),UPe=n=>[qPe].concat(n??[]),WPe={vim:PPe,emacs:HCe,codemirror:()=>Bc.of(EE),vscode:UPe};function GPe(n){const e=WPe[n];return[e?ui.high(e()):[]]}const Nn=({theme:n,settings:e,styles:t})=>{const s=vt.theme({"&":{color:e.foreground,backgroundColor:e.background},".cm-gutters":{backgroundColor:e.gutterBackground,color:e.gutterForeground},".cm-content":{caretColor:e.caret},".cm-cursor, .cm-dropCursor":{borderLeftColor:e.caret},".cm-activeLineGutter":{backgroundColor:e.lineHighlight},".cm-activeLine":{backgroundColor:e.lineHighlight},"&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection":{background:e.selection+" !important"},"& .cm-selectionMatch":{backgroundColor:e.selectionMatch}},{dark:n==="dark"}),r=fg.define(t);return[s,mE(r)]},IW={background:"#222",lineBackground:"#22222299",foreground:"#fff",caret:"#ffcc00",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},XPe=Nn({theme:"dark",settings:IW,styles:[{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#89ddff"},{tag:b.labelName,color:"#89ddff"},{tag:b.keyword,color:"#c792ea"},{tag:b.operator,color:"#89ddff"},{tag:b.special(b.variableName),color:"#eeffff"},{tag:b.typeName,color:"#c3e88d"},{tag:b.atom,color:"#f78c6c"},{tag:b.number,color:"#c3e88d"},{tag:b.definition(b.variableName),color:"#82aaff"},{tag:b.string,color:"#c3e88d"},{tag:b.special(b.string),color:"#c3e88d"},{tag:b.comment,color:"#7d8799"},{tag:b.variableName,color:"#c792ea"},{tag:b.tagName,color:"#c3e88d"},{tag:b.bracket,color:"#525154"},{tag:b.meta,color:"#ffcb6b"},{tag:b.attributeName,color:"#c792ea"},{tag:b.propertyName,color:"#c792ea"},{tag:b.className,color:"#decb6b"},{tag:b.invalid,color:"#ffffff"},{tag:[b.unit,b.punctuation],color:"#82aaff"}]}),LW={background:"#051DB5",lineBackground:"#051DB550",foreground:"white",caret:"white",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#036dd626",lineHighlight:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},HPe=Nn({theme:"dark",settings:LW,styles:[{tag:b.labelName,color:"inherit"},{tag:b.keyword,color:"inherit"},{tag:b.operator,color:"inherit"},{tag:b.special(b.variableName),color:"inherit"},{tag:b.typeName,color:"inherit"},{tag:b.atom,color:"inherit"},{tag:b.number,color:"inherit"},{tag:b.definition(b.variableName),color:"inherit"},{tag:b.string,color:"inherit"},{tag:b.special(b.string),color:"inherit"},{tag:b.comment,color:"inherit"},{tag:b.variableName,color:"inherit"},{tag:b.tagName,color:"inherit"},{tag:b.bracket,color:"inherit"},{tag:b.meta,color:"inherit"},{tag:b.attributeName,color:"inherit"},{tag:b.propertyName,color:"inherit"},{tag:b.className,color:"inherit"},{tag:b.invalid,color:"inherit"},{tag:[b.unit,b.punctuation],color:"inherit"}]}),QW={background:"black",foreground:"white",caret:"white",selection:"#ffffff20",selectionMatch:"#036dd626",lineHighlight:"#ffffff10",lineBackground:"#00000050",gutterBackground:"transparent",gutterForeground:"#8a919966"},YPe=Nn({theme:"dark",settings:QW,styles:[{tag:b.labelName,color:"inherit"},{tag:b.keyword,color:"inherit"},{tag:b.operator,color:"inherit"},{tag:b.special(b.variableName),color:"inherit"},{tag:b.typeName,color:"inherit"},{tag:b.atom,color:"inherit"},{tag:b.number,color:"inherit"},{tag:b.definition(b.variableName),color:"inherit"},{tag:b.string,color:"inherit"},{tag:b.special(b.string),color:"inherit"},{tag:b.comment,color:"inherit"},{tag:b.variableName,color:"inherit"},{tag:b.tagName,color:"inherit"},{tag:b.bracket,color:"inherit"},{tag:b.meta,color:"inherit"},{tag:b.attributeName,color:"inherit"},{tag:b.propertyName,color:"inherit"},{tag:b.className,color:"inherit"},{tag:b.invalid,color:"inherit"},{tag:[b.unit,b.punctuation],color:"inherit"}]}),jW={background:"white",foreground:"black",caret:"black",selection:"rgba(128, 203, 196, 0.5)",selectionMatch:"#ffffff26",lineHighlight:"#cccccc50",lineBackground:"#ffffff50",gutterBackground:"transparent",gutterForeground:"black",light:!0},KPe=Nn({theme:"light",settings:jW,styles:[{tag:b.labelName,color:"inherit"},{tag:b.keyword,color:"inherit"},{tag:b.operator,color:"inherit"},{tag:b.special(b.variableName),color:"inherit"},{tag:b.typeName,color:"inherit"},{tag:b.atom,color:"inherit"},{tag:b.number,color:"inherit"},{tag:b.definition(b.variableName),color:"inherit"},{tag:b.string,color:"inherit"},{tag:b.special(b.string),color:"inherit"},{tag:b.comment,color:"inherit"},{tag:b.variableName,color:"inherit"},{tag:b.tagName,color:"inherit"},{tag:b.bracket,color:"inherit"},{tag:b.meta,color:"inherit"},{tag:b.attributeName,color:"inherit"},{tag:b.propertyName,color:"inherit"},{tag:b.className,color:"inherit"},{tag:b.invalid,color:"inherit"}]});let Si="#6edee4",VW="white",ZW="red",zW="#f8fc55";const qW={background:"#000000",foreground:Si,caret:ZW,selection:zW,selectionMatch:Si,lineHighlight:"#6edee440",lineBackground:"#00000040",gutterBackground:"transparent",gutterForeground:"#8a919966"};let vx=zW,S0=VW;const JPe=Nn({theme:"dark",settings:qW,styles:[{tag:b.labelName,color:VW},{tag:b.keyword,color:Si},{tag:b.operator,color:S0},{tag:b.special(b.variableName),color:Si},{tag:b.typeName,color:Si},{tag:b.atom,color:Si},{tag:b.number,color:S0},{tag:b.definition(b.variableName),color:Si},{tag:b.string,color:S0},{tag:b.special(b.string),color:S0},{tag:b.comment,color:vx},{tag:b.variableName,color:Si},{tag:b.tagName,color:Si},{tag:b.bracket,color:vx},{tag:b.meta,color:Si},{tag:b.attributeName,color:Si},{tag:b.propertyName,color:Si},{tag:b.className,color:Si},{tag:b.invalid,color:ZW},{tag:[b.unit,b.punctuation],color:vx}]}),eAe={"Sour Watermelon B":["#996666","#6B4747","#3D2929","#0F0A0A"]},na=eAe["Sour Watermelon B"],UW={background:na[3],foreground:na[1],caret:na[0],selection:na[0],selectionMatch:na[1],lineHighlight:na[3],lineBackground:na[3]+"90",gutterBackground:"transparent",gutterForeground:na[0],light:!1},tAe=Nn({theme:"dark",settings:UW,styles:[{tag:b.comment,color:na[2]},{tag:b.string,color:na[1]},{tag:[b.atom,b.number],color:na[1]},{tag:[b.meta,b.labelName,b.variableName],color:na[0]},{tag:[b.keyword,b.tagName,b.arithmeticOperator],color:na[1]},{tag:[b.atom,b.bool,b.special(b.variableName)],color:na[0]},{tag:[b.function(b.variableName),b.propertyName],color:na[0]},{tag:b.atom,color:na[1]}]}),YS="#5c019a",nAe="#fbeffc",WW="#272C35",sAe="#fee1ff",rAe="#465063",aAe="#9acd3f",iAe="#97a1b7",oAe="#f6a6fd",KS={background:"white",lineBackground:"transparent",foreground:YS,caret:"#797977",selection:nAe,selectionMatch:"#2B323D",gutterBackground:WW,gutterForeground:rAe,gutterBorder:"transparent",lineHighlight:sAe},lAe=Nn({theme:"light",settings:KS,styles:[{tag:[b.function(b.variableName),b.function(b.propertyName),b.url,b.processingInstruction],color:YS},{tag:[b.tagName,b.heading],color:KS.foreground},{tag:b.comment,color:iAe},{tag:[b.variableName,b.propertyName,b.labelName],color:oAe},{tag:[b.attributeName,b.number],color:"#d19a66"},{tag:b.className,color:WW},{tag:b.keyword,color:YS},{tag:[b.string,b.regexp,b.special(b.propertyName)],color:aAe}]}),Bo=["#1e1e1e","#fbde2d","#ff1493","#4c83ff","#ededed","#cccccc","#ffffff30","#dc2f8c"],GW={background:"#000000",lineBackground:"transparent",foreground:Bo[4],selection:Bo[6],gutterBackground:Bo[0],gutterForeground:Bo[5],gutterBorder:"transparent",lineHighlight:Bo[0]},cAe=Nn({theme:"dark",settings:GW,styles:[{tag:[b.function(b.variableName),b.function(b.propertyName),b.url,b.processingInstruction],color:Bo[4]},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Bo[3]},{tag:b.comment,color:"#54636D"},{tag:[b.variableName,b.propertyName,b.labelName],color:Bo[4]},{tag:[b.attributeName,b.number],color:Bo[3]},{tag:b.keyword,color:Bo[1]},{tag:[b.string,b.regexp,b.special(b.propertyName)],color:Bo[2]}]}),Ua=["#000000","#ff5356","#bd312a","#54636D","#171717"],XW={background:Ua[0],lineBackground:"transparent",foreground:Ua[2],selection:Ua[4],selectionMatch:Ua[0],gutterBackground:Ua[0],gutterForeground:Ua[3],gutterBorder:"transparent",lineHighlight:Ua[0]},uAe=Nn({theme:"dark",settings:XW,styles:[{tag:[b.function(b.variableName),b.function(b.propertyName),b.url,b.processingInstruction],color:Ua[2]},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Ua[1]},{tag:b.comment,color:Ua[3]},{tag:[b.variableName,b.propertyName,b.labelName],color:Ua[2]},{tag:[b.attributeName,b.number],color:Ua[1]},{tag:b.keyword,color:Ua[2]},{tag:[b.string,b.regexp,b.special(b.propertyName)],color:Ua[1]}]}),Wa=["#000000","#8ed675","#56bd2a","#54636D","#171717"],HW={background:Wa[0],lineBackground:"transparent",foreground:Wa[2],selection:Wa[4],selectionMatch:Wa[0],gutterBackground:Wa[0],gutterForeground:Wa[3],gutterBorder:"transparent",lineHighlight:Wa[0]},hAe=Nn({theme:"dark",settings:HW,styles:[{tag:[b.function(b.variableName),b.function(b.propertyName),b.url,b.processingInstruction],color:Wa[2]},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Wa[1]},{tag:b.comment,color:Wa[3]},{tag:[b.variableName,b.propertyName,b.labelName],color:Wa[2]},{tag:[b.attributeName,b.number],color:Wa[1]},{tag:b.keyword,color:Wa[2]},{tag:[b.string,b.regexp,b.special(b.propertyName)],color:Wa[1]}]}),Ga=["rgb(0, 0, 0)","rgb(82, 208, 250)","rgba(113, 208, 250, .4)","rgba(113, 208, 250, .15)"],YW={background:Ga[0],lineBackground:"transparent",foreground:Ga[1],selection:Ga[2],selectionMatch:Ga[0],gutterBackground:Ga[0],gutterForeground:Ga[2],gutterBorder:"transparent",lineHighlight:Ga[0]},dAe=Nn({theme:"dark",settings:YW,styles:[{tag:[b.function(b.variableName),b.function(b.propertyName),b.url,b.processingInstruction],color:Ga[1]},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Ga[1]},{tag:[b.comment,b.brace,b.bracket],color:Ga[2]},{tag:[b.variableName,b.propertyName,b.labelName],color:Ga[1]},{tag:[b.attributeName,b.number],color:Ga[1]},{tag:b.keyword,color:Ga[1]},{tag:[b.string,b.regexp,b.special(b.propertyName)],color:Ga[1]}]}),ga=["rgb(84, 93, 98)","rgb(255, 255, 255)","rgba(255, 255, 255, .25)","rgb(67, 76, 81)","rgb(186, 230, 115)","rgb(252, 184, 67)","rgb(124, 206, 254)","rgb(83, 101, 102)","rgba(46, 62, 72,.5)","rgb(94, 100, 108)","rgb(167, 216, 177)"],KW={background:ga[0],lineBackground:"transparent",foreground:ga[10],selection:ga[8],selectionMatch:ga[0],gutterBackground:ga[3],gutterForeground:ga[2],gutterBorder:"transparent",lineHighlight:ga[3]},pAe=Nn({theme:"dark",settings:KW,styles:[{tag:[b.function(b.variableName),b.function(b.propertyName),b.url,b.processingInstruction],color:ga[1]},{tag:[b.bool,b.special(b.variableName)],color:ga[1]},{tag:[b.comment,b.brace,b.bracket],color:ga[2]},{tag:[b.variableName],color:ga[1]},{tag:[b.labelName,b.propertyName,b.self,b.atom],color:ga[5]},{tag:[b.attributeName,b.number],color:ga[6]},{tag:b.keyword,color:ga[5]},{tag:[b.string,b.regexp,b.special(b.propertyName)],color:ga[4]}]}),Xa=["rgb(75, 130, 247)","rgb(47, 108, 246)","rgb(255, 255, 255)","rgba(255, 255, 255,.3)"],JW={background:Xa[0],lineBackground:"transparent",foreground:Xa[2],selection:Xa[3],selectionMatch:Xa[0],gutterBackground:Xa[0],gutterForeground:Xa[2],gutterBorder:"transparent",lineHighlight:Xa[1]},mAe=Nn({theme:"dark",settings:JW,styles:[{tag:[b.function(b.variableName),b.function(b.propertyName),b.url,b.processingInstruction],color:Xa[2]},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Xa[2]},{tag:[b.comment,b.bracket,b.brace,b.compareOperator],color:Xa[3]},{tag:[b.variableName,b.propertyName,b.labelName],color:Xa[2]},{tag:[b.attributeName,b.number],color:Xa[2]},{tag:b.keyword,color:Xa[2]},{tag:[b.string,b.regexp,b.special(b.propertyName)],color:Xa[2]}]}),fAe={background:"#282b2e",lineBackground:"#282b2e99",foreground:"#a9b7c6",caret:"#00FF00",selection:"#343739",selectionMatch:"#343739",lineHighlight:"#343739"},gAe=Nn({theme:"dark",settings:{background:"#282b2e",foreground:"#a9b7c6",caret:"#00FF00",selection:"#4e5254",selectionMatch:"#4e5254",gutterForeground:"#cccccc50",lineHighlight:"#7f85891f"},styles:[{tag:b.labelName,color:"inherit"},{tag:[b.keyword,b.deleted,b.className],color:"#a9b7c6"},{tag:[b.number,b.literal],color:"#6897bb"},{tag:[b.link,b.variableName],color:"#a9b7c6"},{tag:[b.comment,b.quote],color:"grey"},{tag:[b.meta,b.documentMeta],color:"#bbb529"},{tag:[b.propertyName,b.attributeValue],color:"#a9b7c6"},{tag:[b.string],color:"#6a8759"},{tag:[b.heading,b.typeName],color:"#ffc66d"},{tag:[b.attributeName],color:"#a9b7c6"},{tag:[b.emphasis],fontStyle:"italic"}]}),bAe={background:"#272C35",lineBackground:"#272C3599",foreground:"hsl(220, 14%, 71%)",caret:"#797977",selection:"#ffffff30",selectionMatch:"#2B323D",gutterBackground:"#272C35",gutterForeground:"#465063",gutterBorder:"transparent",lineHighlight:"#2B323D"},yAe=Nn({theme:"dark",settings:{background:"#272C35",foreground:"#9d9b97",caret:"#797977",selection:"#3d4c64",selectionMatch:"#3d4c64",gutterBackground:"#272C35",gutterForeground:"#465063",lineHighlight:"#2e3f5940"},styles:[{tag:[b.function(b.variableName),b.function(b.propertyName),b.url,b.processingInstruction],color:"hsl(207, 82%, 66%)"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"hsl( 29, 54%, 61%)"},{tag:[b.tagName,b.heading],color:"#e06c75"},{tag:b.comment,color:"#54636D"},{tag:[b.variableName,b.propertyName,b.labelName],color:"hsl(220, 14%, 71%)"},{tag:[b.attributeName,b.number],color:"hsl( 29, 54%, 61%)"},{tag:b.className,color:"hsl( 39, 67%, 69%)"},{tag:b.keyword,color:"hsl(286, 60%, 67%)"},{tag:[b.string,b.regexp,b.special(b.propertyName)],color:"#98c379"}]}),vAe={background:"#21202e",lineBackground:"#21202e99",foreground:"#edecee",caret:"#a277ff",selection:"#3d375e7f",selectionMatch:"#3d375e7f",gutterBackground:"#21202e",gutterForeground:"#edecee",gutterBorder:"transparent",lineHighlight:"#a394f033"},OAe=Nn({theme:"dark",settings:{background:"#21202e",foreground:"#edecee",caret:"#a277ff",selection:"#5a51898f",selectionMatch:"#5a51898f",gutterBackground:"#21202e",gutterForeground:"#edecee",lineHighlight:"#a394f033"},styles:[{tag:b.keyword,color:"#a277ff"},{tag:[b.name,b.deleted,b.character,b.macroName],color:"#edecee"},{tag:[b.propertyName],color:"#ffca85"},{tag:[b.processingInstruction,b.string,b.inserted,b.special(b.string)],color:"#61ffca"},{tag:[b.function(b.variableName),b.labelName],color:"#ffca85"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#61ffca"},{tag:[b.definition(b.name),b.separator],color:"#edecee"},{tag:[b.className],color:"#82e2ff"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#61ffca"},{tag:[b.typeName],color:"#82e2ff"},{tag:[b.operator,b.operatorKeyword],color:"#a277ff"},{tag:[b.url,b.escape,b.regexp,b.link],color:"#61ffca"},{tag:[b.meta,b.comment],color:"#6d6d6d"},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.link,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:"#a277ff"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#edecee"},{tag:b.invalid,color:"#ff6767"},{tag:b.strikethrough,textDecoration:"line-through"}]}),wAe={background:"#242424",lineBackground:"#24242499",foreground:"#f8f8f2",caret:"#FFFFFF",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"rgba(255, 255, 255, 0.1)",gutterForeground:"#999",gutterBorder:"transparent",lineHighlight:"rgba(255, 255, 255, 0.1)"},xAe=Nn({theme:"dark",settings:{background:"#242424",foreground:"#f8f8f2",caret:"#FFFFFF",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"transparent",gutterForeground:"#999",lineHighlight:"rgba(255, 255, 255, 0.1)"},styles:[{tag:b.labelName,color:"#CCCCCC"},{tag:[b.atom,b.number],color:"#7A9EC2"},{tag:[b.comment],color:"#707070"},{tag:[b.string],color:"#6A8759"},{tag:[b.variableName,b.operator],color:"#CCCCCC"},{tag:[b.function(b.variableName),b.propertyName],color:"#FFC66D"},{tag:[b.meta,b.className],color:"#FFC66D"},{tag:[b.propertyName],color:"#FFC66D"},{tag:[b.keyword],color:"#CC7832"},{tag:[b.tagName],color:"#ff79c6"},{tag:[b.typeName],color:"#ffb86c"}]}),kAe={background:"#282a36",lineBackground:"#282a3699",foreground:"#f8f8f2",caret:"#f8f8f0",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"#282a36",gutterForeground:"#6272a4",gutterBorder:"transparent",lineHighlight:"rgba(255, 255, 255, 0.1)"},SAe="#BD93F9",CAe=Nn({theme:"dark",settings:{background:"#282a36",foreground:"#f8f8f2",caret:"#f8f8f0",selection:"rgba(255, 255, 255, 0.1)",selectionMatch:"rgba(255, 255, 255, 0.2)",gutterBackground:"#282a36",gutterForeground:"#6272a4",lineHighlight:"rgba(255, 255, 255, 0.1)"},styles:[{tag:b.comment,color:"#6272a4"},{tag:b.string,color:"#f1fa8c"},{tag:[b.atom,b.number],color:SAe},{tag:[b.meta,b.labelName,b.variableName],color:"#f8f8f2"},{tag:[b.keyword,b.tagName,b.arithmeticOperator],color:"#ff79c6"},{tag:[b.function(b.variableName),b.propertyName],color:"#50fa7b"},{tag:b.atom,color:"#bd93f9"}]}),PAe={background:"#2a2734",lineBackground:"#2a273499",foreground:"#eeebff",caret:"#ffad5c",selection:"rgba(255, 255, 255, 0.1)",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},AAe=Nn({theme:"dark",settings:{background:"#2a2734",foreground:"#6c6783",caret:"#ffad5c",selection:"#9a86fd",selectionMatch:"#9a86fd",gutterBackground:"#2a2734",gutterForeground:"#545167",lineHighlight:"#36334280"},styles:[{tag:[b.comment,b.bracket,b.operator],color:"#6c6783"},{tag:[b.atom,b.number,b.keyword,b.link,b.attributeName,b.quote],color:"#ffcc99"},{tag:[b.emphasis,b.heading,b.tagName,b.propertyName,b.className,b.variableName],color:"#eeebff"},{tag:[b.typeName,b.url],color:"#eeebff"},{tag:b.string,color:"#ffb870"},{tag:[b.propertyName],color:"#eeebff"},{tag:b.labelName,color:"#eeebff"}]}),EAe={light:!0,background:"#fff",lineBackground:"#ffffff99",foreground:"#000",caret:"#FFFFFF",selection:"#d7d4f0",selectionMatch:"#d7d4f0",gutterBackground:"#f7f7f7",gutterForeground:"#999",lineHighlight:"#e8f2ff",gutterBorder:"transparent"},MAe=Nn({theme:"light",settings:{background:"#fff",foreground:"#000",caret:"#FFFFFF",selection:"#d7d4f0",selectionMatch:"#d7d4f0",gutterBackground:"#f7f7f7",gutterForeground:"#999",lineHighlight:"#006fff1c"},styles:[{tag:[b.comment],color:"#3F7F5F"},{tag:[b.documentMeta],color:"#FF1717"},{tag:b.keyword,color:"#7F0055",fontWeight:"bold"},{tag:b.atom,color:"#00f"},{tag:b.number,color:"#164"},{tag:b.propertyName,color:"#164"},{tag:[b.variableName,b.definition(b.variableName)],color:"#0000C0"},{tag:b.function(b.variableName),color:"#0000C0"},{tag:b.string,color:"#2A00FF"},{tag:b.operator,color:"black"},{tag:b.tagName,color:"#170"},{tag:b.attributeName,color:"#00c"},{tag:b.link,color:"#219"}]}),DAe={background:"#0d1117",lineBackground:"#0d111799",foreground:"#c9d1d9",caret:"#c9d1d9",selection:"#003d73",selectionMatch:"#003d73",lineHighlight:"#36334280"},TAe=Nn({theme:"dark",settings:{background:"#0d1117",foreground:"#c9d1d9",caret:"#c9d1d9",selection:"#003d73",selectionMatch:"#003d73",lineHighlight:"#36334280"},styles:[{tag:b.labelName,color:"#d2a8ff"},{tag:[b.standard(b.tagName),b.tagName],color:"#7ee787"},{tag:[b.comment,b.bracket],color:"#8b949e"},{tag:[b.className,b.propertyName],color:"#d2a8ff"},{tag:[b.variableName,b.attributeName],color:"#d2a8ff"},{tag:[b.number,b.operator],color:"#79c0ff"},{tag:[b.keyword,b.typeName,b.typeOperator,b.typeName],color:"#ff7b72"},{tag:[b.string,b.meta,b.regexp],color:"#a5d6ff"},{tag:[b.name,b.quote],color:"#7ee787"},{tag:[b.heading,b.strong],color:"#d2a8ff",fontWeight:"bold"},{tag:[b.emphasis],color:"#d2a8ff",fontStyle:"italic"},{tag:[b.deleted],color:"#ffdcd7",backgroundColor:"ffeef0"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#ffab70"},{tag:b.link,textDecoration:"underline"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.invalid,color:"#f97583"}]}),BAe={light:!0,background:"#fff",lineBackground:"#ffffff99",foreground:"#24292e",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#6e7781"},FAe=Nn({theme:"light",settings:{background:"#fff",foreground:"#24292e",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#6e7781"},styles:[{tag:[b.standard(b.tagName),b.tagName],color:"#116329"},{tag:[b.comment,b.bracket],color:"#6a737d"},{tag:[b.className,b.propertyName],color:"#6f42c1"},{tag:[b.variableName,b.attributeName,b.number,b.operator],color:"#005cc5"},{tag:[b.keyword,b.typeName,b.typeOperator,b.typeName],color:"#d73a49"},{tag:[b.string,b.meta,b.regexp],color:"#032f62"},{tag:[b.name,b.quote],color:"#22863a"},{tag:[b.heading,b.strong],color:"#24292e",fontWeight:"bold"},{tag:[b.emphasis],color:"#24292e",fontStyle:"italic"},{tag:[b.deleted],color:"#b31d28",backgroundColor:"ffeef0"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#e36209"},{tag:[b.url,b.escape,b.regexp,b.link],color:"#032f62"},{tag:b.link,textDecoration:"underline"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.invalid,color:"#cb2431"}]}),$Ae={background:"#282828",lineBackground:"#28282899",foreground:"#ebdbb2",caret:"#ebdbb2",selection:"#bdae93",selectionMatch:"#bdae93",lineHighlight:"#3c3836",gutterBackground:"#282828",gutterForeground:"#7c6f64"},NAe=Nn({theme:"dark",settings:{background:"#282828",foreground:"#ebdbb2",caret:"#ebdbb2",selection:"#b99d555c",selectionMatch:"#b99d555c",lineHighlight:"#baa1602b",gutterBackground:"#282828",gutterForeground:"#7c6f64"},styles:[{tag:b.keyword,color:"#fb4934"},{tag:[b.name,b.deleted,b.character,b.propertyName,b.macroName],color:"#8ec07c"},{tag:[b.variableName],color:"#83a598"},{tag:[b.function(b.variableName)],color:"#8ec07c",fontStyle:"bold"},{tag:[b.labelName],color:"#ebdbb2"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#d3869b"},{tag:[b.definition(b.name),b.separator],color:"#ebdbb2"},{tag:[b.brace],color:"#ebdbb2"},{tag:[b.annotation],color:"#fb4934d"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#d3869b"},{tag:[b.typeName,b.className],color:"#fabd2f"},{tag:[b.operatorKeyword],color:"#fb4934"},{tag:[b.tagName],color:"#8ec07c",fontStyle:"bold"},{tag:[b.squareBracket],color:"#fe8019"},{tag:[b.angleBracket],color:"#83a598"},{tag:[b.attributeName],color:"#8ec07c"},{tag:[b.regexp],color:"#8ec07c"},{tag:[b.quote],color:"#928374"},{tag:[b.string],color:"#ebdbb2"},{tag:b.link,color:"#a89984",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[b.url,b.escape,b.special(b.string)],color:"#d3869b"},{tag:[b.meta],color:"#fabd2f"},{tag:[b.comment],color:"#928374",fontStyle:"italic"},{tag:b.strong,fontWeight:"bold",color:"#fe8019"},{tag:b.emphasis,fontStyle:"italic",color:"#b8bb26"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.heading,fontWeight:"bold",color:"#b8bb26"},{tag:[b.heading1,b.heading2],fontWeight:"bold",color:"#b8bb26"},{tag:[b.heading3,b.heading4],fontWeight:"bold",color:"#fabd2f"},{tag:[b.heading5,b.heading6],color:"#fabd2f"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#d3869b"},{tag:[b.processingInstruction,b.inserted],color:"#83a598"},{tag:[b.contentSeparator],color:"#fb4934"},{tag:b.invalid,color:"#fe8019",borderBottom:"1px dotted #fb4934d"}]}),_Ae={light:!0,background:"#fbf1c7",lineBackground:"#fbf1c799",foreground:"#3c3836",caret:"#af3a03",selection:"#ebdbb2",selectionMatch:"#bdae93",lineHighlight:"#ebdbb2",gutterBackground:"#ebdbb2",gutterForeground:"#665c54",gutterBorder:"transparent"},RAe=Nn({theme:"light",settings:{background:"#fbf1c7",foreground:"#3c3836",caret:"#af3a03",selection:"#bdae9391",selectionMatch:"#bdae9391",lineHighlight:"#a37f2238",gutterBackground:"#ebdbb2",gutterForeground:"#665c54"},styles:[{tag:b.keyword,color:"#9d0006"},{tag:[b.name,b.deleted,b.character,b.propertyName,b.macroName],color:"#427b58"},{tag:[b.variableName],color:"#076678"},{tag:[b.function(b.variableName)],color:"#79740e",fontStyle:"bold"},{tag:[b.labelName],color:"#3c3836"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#8f3f71"},{tag:[b.definition(b.name),b.separator],color:"#3c3836"},{tag:[b.brace],color:"#3c3836"},{tag:[b.annotation],color:"#9d0006"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#8f3f71"},{tag:[b.typeName,b.className],color:"#b57614"},{tag:[b.operator,b.operatorKeyword],color:"#9d0006"},{tag:[b.tagName],color:"#427b58",fontStyle:"bold"},{tag:[b.squareBracket],color:"#af3a03"},{tag:[b.angleBracket],color:"#076678"},{tag:[b.attributeName],color:"#427b58"},{tag:[b.regexp],color:"#427b58"},{tag:[b.quote],color:"#928374"},{tag:[b.string],color:"#3c3836"},{tag:b.link,color:"#7c6f64",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[b.url,b.escape,b.special(b.string)],color:"#8f3f71"},{tag:[b.meta],color:"#b57614"},{tag:[b.comment],color:"#928374",fontStyle:"italic"},{tag:b.strong,fontWeight:"bold",color:"#af3a03"},{tag:b.emphasis,fontStyle:"italic",color:"#79740e"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.heading,fontWeight:"bold",color:"#79740e"},{tag:[b.heading1,b.heading2],fontWeight:"bold",color:"#79740e"},{tag:[b.heading3,b.heading4],fontWeight:"bold",color:"#b57614"},{tag:[b.heading5,b.heading6],color:"#b57614"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#8f3f71"},{tag:[b.processingInstruction,b.inserted],color:"#076678"},{tag:[b.contentSeparator],color:"#9d0006"},{tag:b.invalid,color:"#af3a03",borderBottom:"1px dotted #9d0006"}]}),IAe={background:"#212121",lineBackground:"#21212199",foreground:"#bdbdbd",caret:"#a0a4ae",selection:"#d7d4f0",selectionMatch:"#d7d4f0",gutterBackground:"#212121",gutterForeground:"#999",gutterActiveForeground:"#4f5b66",lineHighlight:"#111111"},LAe=Nn({theme:"dark",settings:{background:"#212121",foreground:"#bdbdbd",caret:"#a0a4ae",selection:"#d7d4f063",selectionMatch:"#d7d4f063",gutterBackground:"#212121",gutterForeground:"#999",lineHighlight:"#333333"},styles:[{tag:b.keyword,color:"#cf6edf"},{tag:[b.name,b.deleted,b.character,b.macroName],color:"#56c8d8"},{tag:[b.propertyName],color:"#82AAFF"},{tag:[b.variableName],color:"#bdbdbd"},{tag:[b.function(b.variableName)],color:"#82AAFF"},{tag:[b.labelName],color:"#cf6edf"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#facf4e"},{tag:[b.definition(b.name),b.separator],color:"#56c8d8"},{tag:[b.brace],color:"#cf6edf"},{tag:[b.annotation],color:"#f07178"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#f07178"},{tag:[b.typeName,b.className],color:"#f07178"},{tag:[b.operator,b.operatorKeyword],color:"#82AAFF"},{tag:[b.tagName],color:"#99d066"},{tag:[b.squareBracket],color:"#f07178"},{tag:[b.angleBracket],color:"#606f7a"},{tag:[b.attributeName],color:"#bdbdbd"},{tag:[b.regexp],color:"#f07178"},{tag:[b.quote],color:"#6abf69"},{tag:[b.string],color:"#99d066"},{tag:b.link,color:"#56c8d8",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[b.url,b.escape,b.special(b.string)],color:"#facf4e"},{tag:[b.meta],color:"#707d8b"},{tag:[b.comment],color:"#707d8b",fontStyle:"italic"},{tag:b.monospace,color:"#bdbdbd"},{tag:b.strong,fontWeight:"bold",color:"#f07178"},{tag:b.emphasis,fontStyle:"italic",color:"#99d066"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.heading,fontWeight:"bold",color:"#facf4e"},{tag:b.heading1,fontWeight:"bold",color:"#facf4e"},{tag:[b.heading2,b.heading3,b.heading4],fontWeight:"bold",color:"#facf4e"},{tag:[b.heading5,b.heading6],color:"#facf4e"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#56c8d8"},{tag:[b.processingInstruction,b.inserted],color:"#f07178"},{tag:[b.contentSeparator],color:"#56c8d8"},{tag:b.invalid,color:"#606f7a",borderBottom:"1px dotted #f07178"}]}),QAe={light:!0,background:"#FAFAFA",lineBackground:"#FAFAFA99",foreground:"#90A4AE",caret:"#272727",selection:"#80CBC440",selectionMatch:"#FAFAFA",gutterBackground:"#FAFAFA",gutterForeground:"#90A4AE",gutterBorder:"transparent",lineHighlight:"#CCD7DA50"},jAe=Nn({theme:"light",settings:{background:"#FAFAFA",foreground:"#90A4AE",caret:"#272727",selection:"#80CBC440",selectionMatch:"#80CBC440",gutterBackground:"#FAFAFA",gutterForeground:"#90A4AE",lineHighlight:"#CCD7DA50"},styles:[{tag:b.keyword,color:"#39ADB5"},{tag:[b.name,b.deleted,b.character,b.macroName],color:"#90A4AE"},{tag:[b.propertyName],color:"#6182B8"},{tag:[b.processingInstruction,b.string,b.inserted,b.special(b.string)],color:"#91B859"},{tag:[b.function(b.variableName),b.labelName],color:"#6182B8"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#39ADB5"},{tag:[b.definition(b.name),b.separator],color:"#90A4AE"},{tag:[b.className],color:"#E2931D"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#F76D47"},{tag:[b.typeName],color:"#E2931D",fontStyle:"#E2931D"},{tag:[b.operator,b.operatorKeyword],color:"#39ADB5"},{tag:[b.url,b.escape,b.regexp,b.link],color:"#91B859"},{tag:[b.meta,b.comment],color:"#90A4AE"},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.link,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:"#39ADB5"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#90A4AE"},{tag:b.invalid,color:"#E5393570"},{tag:b.strikethrough,textDecoration:"line-through"}]}),VAe={background:"#2e3440",lineBackground:"#2e344099",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#3b4252",selectionMatch:"#e5e9f0",gutterBackground:"#2e3440",gutterForeground:"#4c566a",gutterActiveForeground:"#d8dee9",lineHighlight:"#4c566a"},ZAe=Nn({theme:"dark",settings:{background:"#2e3440",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#00000073",selectionMatch:"#00000073",gutterBackground:"#2e3440",gutterForeground:"#4c566a",lineHighlight:"#4c566a29"},styles:[{tag:b.keyword,color:"#5e81ac"},{tag:[b.name,b.deleted,b.character,b.propertyName,b.macroName],color:"#88c0d0"},{tag:[b.variableName],color:"#8fbcbb"},{tag:[b.function(b.variableName)],color:"#8fbcbb"},{tag:[b.labelName],color:"#81a1c1"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#5e81ac"},{tag:[b.definition(b.name),b.separator],color:"#a3be8c"},{tag:[b.brace],color:"#8fbcbb"},{tag:[b.annotation],color:"#d30102"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#b48ead"},{tag:[b.typeName,b.className],color:"#ebcb8b"},{tag:[b.operator,b.operatorKeyword],color:"#a3be8c"},{tag:[b.tagName],color:"#b48ead"},{tag:[b.squareBracket],color:"#bf616a"},{tag:[b.angleBracket],color:"#d08770"},{tag:[b.attributeName],color:"#ebcb8b"},{tag:[b.regexp],color:"#5e81ac"},{tag:[b.quote],color:"#b48ead"},{tag:[b.string],color:"#a3be8c"},{tag:b.link,color:"#a3be8c",textDecoration:"underline",textUnderlinePosition:"under"},{tag:[b.url,b.escape,b.special(b.string)],color:"#8fbcbb"},{tag:[b.meta],color:"#88c0d0"},{tag:[b.monospace],color:"#d8dee9",fontStyle:"italic"},{tag:[b.comment],color:"#4c566a",fontStyle:"italic"},{tag:b.strong,fontWeight:"bold",color:"#5e81ac"},{tag:b.emphasis,fontStyle:"italic",color:"#5e81ac"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:b.heading,fontWeight:"bold",color:"#5e81ac"},{tag:b.special(b.heading1),fontWeight:"bold",color:"#5e81ac"},{tag:b.heading1,fontWeight:"bold",color:"#5e81ac"},{tag:[b.heading2,b.heading3,b.heading4],fontWeight:"bold",color:"#5e81ac"},{tag:[b.heading5,b.heading6],color:"#5e81ac"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#d08770"},{tag:[b.processingInstruction,b.inserted],color:"#8fbcbb"},{tag:[b.contentSeparator],color:"#ebcb8b"},{tag:b.invalid,color:"#434c5e",borderBottom:"1px dotted #d30102"}]}),zAe={background:"#272822",lineBackground:"#27282299",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#49483E",selectionMatch:"#49483E",gutterBackground:"#272822",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},qAe=Nn({theme:"dark",settings:{background:"#272822",foreground:"#FFFFFF",caret:"#FFFFFF",selection:"#49483E",selectionMatch:"#49483E",gutterBackground:"#272822",gutterForeground:"#FFFFFF70",lineHighlight:"#0000003b"},styles:[{tag:b.labelName,color:"#bababa"},{tag:[b.comment,b.documentMeta],color:"#8292a2"},{tag:[b.number,b.bool,b.null,b.atom],color:"#ae81ff"},{tag:[b.attributeValue,b.className,b.name],color:"#e6db74"},{tag:[b.propertyName,b.attributeName],color:"#a6e22e"},{tag:[b.variableName],color:"#9effff"},{tag:[b.squareBracket],color:"#bababa"},{tag:[b.string,b.special(b.brace)],color:"#e6db74"},{tag:[b.regexp,b.className,b.typeName,b.definition(b.typeName)],color:"#66d9ef"},{tag:[b.definition(b.variableName),b.definition(b.propertyName),b.function(b.variableName)],color:"#a6e22e"},{tag:[b.keyword,b.definitionKeyword,b.modifier,b.tagName,b.angleBracket],color:"#f92672"}]}),UAe={background:"#002b36",lineBackground:"#002b3699",foreground:"#93a1a1",caret:"#839496",selection:"#173541",selectionMatch:"#aafe661a",gutterBackground:"#00252f",gutterForeground:"#839496",lineHighlight:"#173541"},Ms={background:"#002B36",foreground:"#839496",selection:"#004454AA",cursor:"#D30102",activeLine:"#00cafe11",keyword:"#859900",variable:"#268BD2",function:"#268BD2",string:"#2AA198",constant:"#CB4B16",type:"#859900",class:"#268BD2",number:"#D33682",comment:"#586E75",heading:"#268BD2",invalid:"#DC322F",regexp:"#DC322F",tag:"#268BD2"},WAe=Nn({theme:"dark",settings:{background:Ms.background,foreground:Ms.foreground,caret:Ms.cursor,selection:Ms.selection,selectionMatch:Ms.selection,gutterBackground:Ms.background,gutterForeground:Ms.foreground,lineHighlight:Ms.activeLine},styles:[{tag:b.keyword,color:Ms.keyword},{tag:[b.name,b.deleted,b.character,b.macroName],color:Ms.variable},{tag:[b.propertyName],color:Ms.function},{tag:[b.processingInstruction,b.string,b.inserted,b.special(b.string)],color:Ms.string},{tag:[b.function(b.variableName),b.labelName],color:Ms.function},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:Ms.constant},{tag:[b.definition(b.name),b.separator],color:Ms.variable},{tag:[b.className],color:Ms.class},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:Ms.number},{tag:[b.typeName],color:Ms.type,fontStyle:Ms.type},{tag:[b.operator,b.operatorKeyword],color:Ms.keyword},{tag:[b.url,b.escape,b.regexp,b.link],color:Ms.regexp},{tag:[b.meta,b.comment],color:Ms.comment},{tag:b.tagName,color:Ms.tag},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.link,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:Ms.heading},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Ms.variable},{tag:b.invalid,color:Ms.invalid},{tag:b.strikethrough,textDecoration:"line-through"}]}),GAe={light:!0,background:"#fdf6e3",lineBackground:"#fdf6e399",foreground:"#657b83",caret:"#586e75",selection:"#dfd9c8",selectionMatch:"#dfd9c8",gutterBackground:"#00000010",gutterForeground:"#657b83",lineHighlight:"#dfd9c8"},Ds={background:"#FDF6E3",foreground:"#657B83",selection:"#EEE8D5",selectionMatch:"#EEE8D5",cursor:"#657B83",activeLine:"#3d392d11",keyword:"#859900",variable:"#268BD2",function:"#268BD2",string:"#2AA198",constant:"#CB4B16",type:"#859900",class:"#268BD2",number:"#D33682",comment:"#93A1A1",heading:"#268BD2",invalid:"#DC322F",regexp:"#DC322F",tag:"#268BD2"},XAe=Nn({theme:"light",settings:{background:Ds.background,foreground:Ds.foreground,caret:Ds.cursor,selection:Ds.selection,selectionMatch:Ds.selectionMatch,gutterBackground:Ds.background,gutterForeground:Ds.foreground,lineHighlight:Ds.activeLine},styles:[{tag:b.keyword,color:Ds.keyword},{tag:[b.name,b.deleted,b.character,b.macroName],color:Ds.variable},{tag:[b.propertyName],color:Ds.function},{tag:[b.processingInstruction,b.string,b.inserted,b.special(b.string)],color:Ds.string},{tag:[b.function(b.variableName),b.labelName],color:Ds.function},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:Ds.constant},{tag:[b.definition(b.name),b.separator],color:Ds.variable},{tag:[b.className],color:Ds.class},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:Ds.number},{tag:[b.typeName],color:Ds.type,fontStyle:Ds.type},{tag:[b.operator,b.operatorKeyword],color:Ds.keyword},{tag:[b.url,b.escape,b.regexp,b.link],color:Ds.regexp},{tag:[b.meta,b.comment],color:Ds.comment},{tag:b.tagName,color:Ds.tag},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.link,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:Ds.heading},{tag:[b.atom,b.bool,b.special(b.variableName)],color:Ds.variable},{tag:b.invalid,color:Ds.invalid},{tag:b.strikethrough,textDecoration:"line-through"}]}),HAe={background:"#303841",lineBackground:"#30384199",foreground:"#FFFFFF",caret:"#FBAC52",selection:"#4C5964",selectionMatch:"#3A546E",gutterBackground:"#303841",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},YAe=Nn({theme:"dark",settings:{background:"#303841",foreground:"#FFFFFF",caret:"#FBAC52",selection:"#4C5964",selectionMatch:"#3A546E",gutterBackground:"#303841",gutterForeground:"#FFFFFF70",lineHighlight:"#00000059"},styles:[{tag:b.labelName,color:"#A2A9B5"},{tag:[b.meta,b.comment],color:"#A2A9B5"},{tag:[b.attributeName,b.keyword],color:"#B78FBA"},{tag:b.function(b.variableName),color:"#5AB0B0"},{tag:[b.string,b.regexp,b.attributeValue],color:"#99C592"},{tag:b.operator,color:"#f47954"},{tag:[b.tagName,b.modifier],color:"#E35F63"},{tag:[b.number,b.definition(b.tagName),b.className,b.definition(b.variableName)],color:"#fbac52"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#E35F63"},{tag:b.variableName,color:"#539ac4"},{tag:[b.propertyName,b.typeName],color:"#629ccd"},{tag:b.propertyName,color:"#36b7b5"}]}),KAe={background:"#1a1b26",lineBackground:"#1a1b2699",foreground:"#787c99",caret:"#c0caf5",selection:"#515c7e40",selectionMatch:"#16161e",gutterBackground:"#1a1b26",gutterForeground:"#787c99",gutterBorder:"transparent",lineHighlight:"#1e202e"},JAe=Nn({theme:"dark",settings:{background:"#1a1b26",foreground:"#787c99",caret:"#c0caf5",selection:"#515c7e40",selectionMatch:"#16161e",gutterBackground:"#1a1b26",gutterForeground:"#787c99",lineHighlight:"#474b6611"},styles:[{tag:b.keyword,color:"#bb9af7"},{tag:[b.name,b.deleted,b.character,b.macroName],color:"#c0caf5"},{tag:[b.propertyName],color:"#7aa2f7"},{tag:[b.processingInstruction,b.string,b.inserted,b.special(b.string)],color:"#9ece6a"},{tag:[b.function(b.variableName),b.labelName],color:"#7aa2f7"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#bb9af7"},{tag:[b.definition(b.name),b.separator],color:"#c0caf5"},{tag:[b.className],color:"#c0caf5"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#ff9e64"},{tag:[b.typeName],color:"#0db9d7"},{tag:[b.operator,b.operatorKeyword],color:"#bb9af7"},{tag:[b.url,b.escape,b.regexp,b.link],color:"#b4f9f8"},{tag:[b.meta,b.comment],color:"#444b6a"},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.link,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:"#89ddff"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#c0caf5"},{tag:b.invalid,color:"#ff5370"},{tag:b.strikethrough,textDecoration:"line-through"}]}),eEe={background:"#24283b",lineBackground:"#24283b99",foreground:"#7982a9",caret:"#c0caf5",selection:"#6f7bb630",selectionMatch:"#1f2335",gutterBackground:"#24283b",gutterForeground:"#7982a9",gutterBorder:"transparent",lineHighlight:"#292e42"},tEe=Nn({theme:"dark",settings:{background:"#24283b",foreground:"#7982a9",caret:"#c0caf5",selection:"#6f7bb630",selectionMatch:"#343b5f",gutterBackground:"#24283b",gutterForeground:"#7982a9",lineHighlight:"#292e427a"},styles:[{tag:b.keyword,color:"#bb9af7"},{tag:[b.name,b.deleted,b.character,b.macroName],color:"#c0caf5"},{tag:[b.propertyName],color:"#7aa2f7"},{tag:[b.processingInstruction,b.string,b.inserted,b.special(b.string)],color:"#9ece6a"},{tag:[b.function(b.variableName),b.labelName],color:"#7aa2f7"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#bb9af7"},{tag:[b.definition(b.name),b.separator],color:"#c0caf5"},{tag:[b.className],color:"#c0caf5"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#ff9e64"},{tag:[b.typeName],color:"#2ac3de",fontStyle:"#2ac3de"},{tag:[b.operator,b.operatorKeyword],color:"#bb9af7"},{tag:[b.url,b.escape,b.regexp,b.link],color:"#b4f9f8"},{tag:[b.meta,b.comment],color:"#565f89"},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.link,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:"#89ddff"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#c0caf5"},{tag:b.invalid,color:"#ff5370"},{tag:b.strikethrough,textDecoration:"line-through"}]}),nEe={light:!0,background:"#e1e2e7",lineBackground:"#e1e2e799",foreground:"#3760bf",caret:"#3760bf",selection:"#99a7df",selectionMatch:"#99a7df",gutterBackground:"#e1e2e7",gutterForeground:"#3760bf",gutterBorder:"transparent",lineHighlight:"#5f5faf11"},sEe=Nn({theme:"light",settings:{background:"#e1e2e7",foreground:"#3760bf",caret:"#3760bf",selection:"#99a7df",selectionMatch:"#99a7df",gutterBackground:"#e1e2e7",gutterForeground:"#3760bf",lineHighlight:"#5f5faf11"},styles:[{tag:b.keyword,color:"#007197"},{tag:[b.name,b.deleted,b.character,b.macroName],color:"#3760bf"},{tag:[b.propertyName],color:"#3760bf"},{tag:[b.processingInstruction,b.string,b.inserted,b.special(b.string)],color:"#587539"},{tag:[b.function(b.variableName),b.labelName],color:"#3760bf"},{tag:[b.color,b.constant(b.name),b.standard(b.name)],color:"#3760bf"},{tag:[b.definition(b.name),b.separator],color:"#3760bf"},{tag:[b.className],color:"#3760bf"},{tag:[b.number,b.changed,b.annotation,b.modifier,b.self,b.namespace],color:"#b15c00"},{tag:[b.typeName],color:"#007197",fontStyle:"#007197"},{tag:[b.operator,b.operatorKeyword],color:"#007197"},{tag:[b.url,b.escape,b.regexp,b.link],color:"#587539"},{tag:[b.meta,b.comment],color:"#848cb5"},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.link,textDecoration:"underline"},{tag:b.heading,fontWeight:"bold",color:"#b15c00"},{tag:[b.atom,b.bool,b.special(b.variableName)],color:"#3760bf"},{tag:b.invalid,color:"#f52a65"},{tag:b.strikethrough,textDecoration:"line-through"}]}),rEe={background:"#1e1e1e",lineBackground:"#1e1e1e99",foreground:"#fff",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff"},aEe=Nn({theme:"dark",settings:{background:"#1e1e1e",foreground:"#fff",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383"},styles:[{tag:[b.keyword,b.operatorKeyword,b.modifier,b.color,b.constant(b.name),b.standard(b.name),b.standard(b.tagName),b.special(b.brace),b.atom,b.bool,b.special(b.variableName)],color:"#569cd6"},{tag:[b.controlKeyword,b.moduleKeyword],color:"#c586c0"},{tag:[b.name,b.deleted,b.character,b.macroName,b.propertyName,b.variableName,b.labelName,b.definition(b.name)],color:"#9cdcfe"},{tag:b.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[b.typeName,b.className,b.tagName,b.number,b.changed,b.annotation,b.self,b.namespace],color:"#4ec9b0"},{tag:[b.function(b.variableName),b.function(b.propertyName)],color:"#dcdcaa"},{tag:[b.number],color:"#b5cea8"},{tag:[b.operator,b.punctuation,b.separator,b.url,b.escape,b.regexp],color:"#d4d4d4"},{tag:[b.regexp],color:"#d16969"},{tag:[b.special(b.string),b.processingInstruction,b.string,b.inserted],color:"#ce9178"},{tag:[b.angleBracket],color:"#808080"},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:[b.meta,b.comment],color:"#6a9955"},{tag:b.link,color:"#6a9955",textDecoration:"underline"},{tag:b.invalid,color:"#ff0000"}]}),iEe={background:"#ffffff",lineBackground:"#ffffff50",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},oEe=Nn({theme:"light",settings:{background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893"},styles:[{tag:[b.keyword,b.operatorKeyword,b.modifier,b.color,b.constant(b.name),b.standard(b.name),b.standard(b.tagName),b.special(b.brace),b.atom,b.bool,b.special(b.variableName)],color:"#0000ff"},{tag:[b.moduleKeyword,b.controlKeyword],color:"#af00db"},{tag:[b.name,b.deleted,b.character,b.macroName,b.propertyName,b.variableName,b.labelName,b.definition(b.name)],color:"#0070c1"},{tag:b.heading,fontWeight:"bold",color:"#0070c1"},{tag:[b.typeName,b.className,b.tagName,b.number,b.changed,b.annotation,b.self,b.namespace],color:"#267f99"},{tag:[b.function(b.variableName),b.function(b.propertyName)],color:"#795e26"},{tag:[b.number],color:"#098658"},{tag:[b.operator,b.punctuation,b.separator,b.url,b.escape,b.regexp],color:"#383a42"},{tag:[b.regexp],color:"#af00db"},{tag:[b.special(b.string),b.processingInstruction,b.string,b.inserted],color:"#a31515"},{tag:[b.angleBracket],color:"#383a42"},{tag:b.strong,fontWeight:"bold"},{tag:b.emphasis,fontStyle:"italic"},{tag:b.strikethrough,textDecoration:"line-through"},{tag:[b.meta,b.comment],color:"#008000"},{tag:b.link,color:"#4078f2",textDecoration:"underline"},{tag:b.invalid,color:"#e45649"}]}),lEe={light:!0,background:"#fff",lineBackground:"#ffffff99",foreground:"#3D3D3D",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#AFAFAF",lineHighlight:"#EDF4FF"},cEe=Nn({theme:"light",settings:{background:"#fff",foreground:"#3D3D3D",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#AFAFAF",lineHighlight:"#d5e6ff69"},styles:[{tag:[b.comment,b.quote],color:"#707F8D"},{tag:[b.typeName,b.typeOperator],color:"#aa0d91"},{tag:[b.keyword],color:"#aa0d91",fontWeight:"bold"},{tag:[b.string,b.meta],color:"#D23423"},{tag:[b.name],color:"#032f62"},{tag:[b.typeName],color:"#522BB2"},{tag:[b.variableName],color:"#23575C"},{tag:[b.definition(b.variableName)],color:"#327A9E"},{tag:[b.regexp,b.link],color:"#0e0eff"}]}),uEe={light:!0,background:"#FFFFFF",lineBackground:"#FFFFFF99",foreground:"#000000",caret:"#FBAC52",selection:"#FFD420",selectionMatch:"#FFD420",gutterBackground:"#f5f5f5",gutterForeground:"#4D4D4C",gutterBorder:"transparent",lineHighlight:"#00000012"},hEe=Nn({theme:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#FBAC52",selection:"#FFD420",selectionMatch:"#FFD420",gutterBackground:"#f5f5f5",gutterForeground:"#4D4D4C",lineHighlight:"#00000012"},styles:[{tag:[b.meta,b.comment],color:"#804000"},{tag:[b.keyword,b.strong],color:"#0000FF"},{tag:[b.number],color:"#FF0080"},{tag:[b.string],color:"#FF0080"},{tag:[b.variableName],color:"#006600"},{tag:[b.escape],color:"#33CC33"},{tag:[b.tagName],color:"#1C02FF"},{tag:[b.heading],color:"#0C07FF"},{tag:[b.quote],color:"#000000"},{tag:[b.list],color:"#B90690"},{tag:[b.documentMeta],color:"#888888"},{tag:[b.function(b.variableName)],color:"#0000A2"},{tag:[b.definition(b.typeName),b.typeName],color:"#6D79DE"}]}),dEe={light:!0,background:"#f2f1f8",lineBackground:"#f2f1f899",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",selectionMatch:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#e1def3"},pEe=Nn({theme:"light",settings:{background:"#f2f1f8",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",selectionMatch:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#16067911"},styles:[{tag:b.comment,color:"#9995b7"},{tag:b.keyword,color:"#ff5792",fontWeight:"bold"},{tag:[b.definitionKeyword,b.modifier],color:"#ff5792"},{tag:[b.className,b.tagName,b.definition(b.typeName)],color:"#0094f0"},{tag:[b.number,b.bool,b.null,b.special(b.brace)],color:"#5842ff"},{tag:[b.definition(b.propertyName),b.function(b.variableName)],color:"#0095a8"},{tag:b.typeName,color:"#b3694d"},{tag:[b.propertyName,b.variableName],color:"#fa8900"},{tag:b.operator,color:"#ff5792"},{tag:b.self,color:"#e64100"},{tag:[b.string,b.regexp],color:"#00b368"},{tag:[b.paren,b.bracket],color:"#0431fa"},{tag:b.labelName,color:"#00bdd6"},{tag:b.attributeName,color:"#e64100"},{tag:b.angleBracket,color:"#9995b7"}]}),JS={strudelTheme:XPe,algoboy:tAe,archBtw:dAe,androidstudio:gAe,atomone:yAe,aura:OAe,bbedit:hEe,blackscreen:YPe,bluescreen:HPe,bluescreenlight:mAe,CutiePi:lAe,darcula:xAe,dracula:CAe,duotoneDark:AAe,eclipse:MAe,fruitDaw:pAe,githubDark:TAe,githubLight:FAe,greenText:hAe,gruvboxDark:NAe,gruvboxLight:RAe,sonicPink:cAe,materialDark:LAe,materialLight:jAe,monokai:qAe,noctisLilac:pEe,nord:ZAe,redText:uAe,solarizedDark:WAe,solarizedLight:XAe,sublime:YAe,teletext:JPe,tokyoNight:JAe,tokyoNightDay:sEe,tokyoNightStorm:tEe,vscodeDark:aEe,vscodeLight:oEe,whitescreen:KPe,xcodeLight:cEe},yb={strudelTheme:IW,bluescreen:LW,bluescreenlight:JW,blackscreen:QW,whitescreen:jW,teletext:qW,algoboy:UW,archBtw:YW,androidstudio:fAe,atomone:bAe,aura:vAe,bbedit:uEe,darcula:wAe,dracula:kAe,duotoneDark:PAe,eclipse:EAe,CutiePi:KS,sonicPink:GW,fruitDaw:KW,githubLight:BAe,githubDark:DAe,greenText:HW,gruvboxDark:$Ae,gruvboxLight:_Ae,materialDark:IAe,materialLight:QAe,noctisLilac:dEe,nord:VAe,monokai:zAe,redText:XW,solarizedLight:GAe,solarizedDark:UAe,sublime:HAe,tokyoNight:KAe,tokyoNightStorm:eEe,vscodeDark:rEe,vscodeLight:iEe,xcodeLight:lEe,tokyoNightDay:nEe};function mEe(n){const e=/#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})/g,t=[];let s;for(;(s=e.exec(n))!==null;){const r=s[0];t.includes(r)||t.push(r)}return t}function fEe(n){return mEe(bEe(n))}function gEe(){const n=new WeakSet;return(e,t)=>{if(typeof t=="object"&&t!==null){if(n.has(t))return;n.add(t)}return t}}function bEe(n){return JSON.stringify(n,gEe())}const eG=n=>JS[n]||JS.strudelTheme;function tG(n){const e=document.createElement("style");document.head.appendChild(e);const t=e.sheet,s=t.insertRule(n,0);return()=>t.deleteRule(s)}let m7,Kp,vb,f7="strudel-theme-vars";function nG(n){document.getElementById(f7)||(vb=document.createElement("style"),vb.id=f7,document.head.append(vb)),LE(n)}function LE(n){if(m7===n)return;m7=n,yb[n]||console.warn("theme",n,"has no settings.. defaulting to strudelTheme settings");const e=yb[n]||yb.strudelTheme;vb.innerHTML=`:root {
      ${Object.entries(e).map(([t,s])=>`--${t}: ${s} !important;`).join(`
`)}
    }`,Xbe(e),e.light?document.documentElement.classList.remove("dark"):document.documentElement.classList.add("dark"),Kp==null||Kp(),Kp=void 0,e.customStyle&&(Kp=tG(e.customStyle))}let kd={};const yEe=n=>`slider_${n}`;class sG extends el{constructor(e,t,s,r,a,i,o){super(),this.value=e,this.min=t,this.max=s,this.from=r,this.originalFrom=r,this.to=a,this.step=i,this.view=o}eq(){return!1}toDOM(){let e=document.createElement("span");e.setAttribute("aria-hidden","true"),e.className="cm-slider";let t=e.appendChild(document.createElement("input"));return t.type="range",t.min=this.min,t.max=this.max,t.step=this.step??(this.max-this.min)/1e3,t.originalValue=this.value,t.value=t.originalValue,t.from=this.from,t.originalFrom=this.originalFrom,t.to=this.to,t.style="width:64px;margin-right:4px;transform:translateY(4px)",this.slider=t,t.addEventListener("input",s=>{const r=s.target.value;let a=r;const i=t.from+t.originalValue.length;let o={from:t.from,to:i,insert:a};t.originalValue=a,t.value=a,this.view.dispatch({changes:o});const l=yEe(t.originalFrom);window.postMessage({type:"cm-slider",value:Number(r),id:l})}),e}ignoreEvent(e){return!0}}const QE=ln.define(),rG=(n,e)=>{n.dispatch({effects:QE.of(e)})};function vEe(n,e){return n.filter(t=>t.type==="slider").map(({from:t,to:s,value:r,min:a,max:i,step:o})=>Yt.widget({widget:new sG(r,a,i,t,s,o,e),side:0}).range(t))}const aG=nr.fromClass(class{constructor(n){Yl(this,"decorations");this.decorations=Yt.set([])}update(n){n.transactions.forEach(e=>{var t,s;if(e.docChanged){this.decorations=this.decorations.map(e.changes);const r=this.decorations.iter();for(;r.value;)(s=(t=r.value)==null?void 0:t.widget)!=null&&s.slider&&(r.value.widget.slider.from=r.from,r.value.widget.slider.to=r.to),r.next()}for(let r of e.effects)r.is(QE)&&(this.decorations=Yt.set(vEe(r.value,n.view)))})}},{decorations:n=>n.decorations});let OEe=n=>(console.warn("slider will only work when the transpiler is used... passing value as is"),Cr(n)),wEe=(n,e,t,s)=>(kd[n]=e,u_(()=>kd[n]));typeof window<"u"&&window.addEventListener("message",n=>{n.data.type==="cm-slider"&&(kd[n.data.id]!==void 0?kd[n.data.id]=n.data.value:console.warn(`slider with id "${n.data.id}" is not registered. Only ${Object.keys(kd)}`))});const jE=ln.define({map:({from:n,to:e},t)=>({from:t.mapPos(n),to:t.mapPos(e)})}),iG=(n,e)=>{n.dispatch({effects:jE.of(e)})};function xEe(n){return n.sort((e,t)=>e.to-t.to).map(e=>Yt.widget({widget:new cG(e),side:0,block:!0}).range(e.to))}const kEe=Us.define({create(){return Yt.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(jE))try{n=n.update({filter:()=>!1,add:xEe(t.value)})}catch(s){console.log("err",s)}return n},provide:n=>vt.decorations.from(n)}),oG={};function lG(n,e){oG[n]=e,e.id=n}class cG extends el{constructor(e){super(),this.widgetConfig=e}eq(){return!0}toDOM(){const e=aZ(this.widgetConfig);return oG[e]}ignoreEvent(e){return!0}}const uG=[kEe];function Dh(n,e){g1e(n),e&&(mt.prototype[n]=function(t,s={fold:1}){return e(t,s,this)})}function Cp(n,e={}){const{width:t=500,height:s=60,pixelRatio:r=window.devicePixelRatio}=e;let a=document.getElementById(n)||document.createElement("canvas");return a.width=t*r,a.height=s*r,a.style.width=t+"px",a.style.height=s+"px",lG(n,a),a}Dh("_pianoroll",(n,e={},t)=>{const s=Cp(n,e).getContext("2d");return t.tag(n).pianoroll({fold:1,...e,ctx:s,id:n})});Dh("_punchcard",(n,e={},t)=>{const s=Cp(n,e).getContext("2d");return t.tag(n).punchcard({fold:1,...e,ctx:s,id:n})});Dh("_spiral",(n,e={},t)=>{let s=e.size||275;e={width:s,height:s,...e,size:s/5};const r=Cp(n,e).getContext("2d");return t.tag(n).spiral({...e,ctx:r,id:n})});Dh("_scope",(n,e={},t)=>{e={width:500,height:60,pos:.5,scale:1,...e};const s=Cp(n,e).getContext("2d");return t.tag(n).scope({...e,ctx:s,id:n})});Dh("_pitchwheel",(n,e={},t)=>{let s=e.size||200;e={width:s,height:s,...e,size:s/5};const r=Cp(n,e).getContext("2d");return t.pitchwheel({...e,ctx:r,id:n})});Dh("_spectrum",(n,e={},t)=>{let s=e.size||200;e={width:s,height:s,...e,size:s/5};const r=Cp(n,e).getContext("2d");return t.spectrum({...e,ctx:r,id:n})});let g7=n=>n,Zh={},eC={addEventListener(){},removeEventListener(){}};function SEe(){try{return typeof localStorage<"u"}catch{return!1}}SEe()&&(Zh=localStorage);let CEe={addEventListener(n,e,t){window.addEventListener("storage",e),window.addEventListener("pageshow",t)},removeEventListener(n,e,t){window.removeEventListener("storage",e),window.removeEventListener("pageshow",t)}};typeof window<"u"&&(eC=CEe);function PEe(n,e=void 0,t={}){let s=t.encode||g7,r=t.decode||g7,a=pZ(e),i=a.set;a.set=c=>{typeof c>"u"?delete Zh[n]:Zh[n]=s(c),i(c)};function o(c){c.key===n?c.newValue===null?i(void 0):i(r(c.newValue)):Zh[n]||i(void 0)}function l(){a.set(Zh[n]?r(Zh[n]):e)}return H1e(a,()=>{if(l(),t.listen!==!1)return eC.addEventListener(n,o,l),()=>{eC.removeEventListener(n,o,l)}}),a}const AEe=[gq(),gU(),Vwe(),axe(),lxe(),Bc.of([...f2e,...EE,...OU])];gq(),gU(),dq(),mE(Gq,{fallback:!0}),Bc.of([...EE,...OU]);const td={isLineWrappingEnabled:n=>n?vt.lineWrapping:[],isBracketMatchingEnabled:n=>n?kke({brackets:"()[]{}<>"}):[],isBracketClosingEnabled:n=>n?d2e():[],isLineNumbersDisplayed:n=>n?Cxe():[],theme:eG,isAutoCompletionEnabled:gCe,isTooltipEnabled:vCe,isPatternHighlightingEnabled:mW,isActiveLineHighlighted:n=>n?[Jwe(),Exe()]:[],isFlashEnabled:hW,keybindings:GPe,isTabIndentationEnabled:n=>n?Bc.of([iSe]):[],isMultiCursorEnabled:n=>n?[rs.allowMultipleSelections.of(!0),vt.clickAddsSelectionRange.of(e=>e.metaKey||e.ctrlKey)]:[]},tC=Object.fromEntries(Object.keys(td).map(n=>[n,new ug])),hG={keybindings:"codemirror",isBracketMatchingEnabled:!1,isBracketClosingEnabled:!0,isLineNumbersDisplayed:!0,isActiveLineHighlighted:!1,isAutoCompletionEnabled:!1,isPatternHighlightingEnabled:!0,isFlashEnabled:!0,isTooltipEnabled:!1,isLineWrappingEnabled:!1,isTabIndentationEnabled:!1,isMultiCursorEnabled:!1,theme:"strudelTheme",fontFamily:"monospace",fontSize:18},Sd=PEe("codemirror-settings",hG,{encode:JSON.stringify,decode:JSON.parse});function dG({initialCode:n="",onChange:e,onEvaluate:t,onStop:s,root:r,mondo:a}){const i=Sd.get(),o=Object.keys(tC).map(c=>tC[c].of(td[c](mG(i[c]))));nG(i.theme);let l=rs.create({doc:n,extensions:[...o,AEe,a?[]:tCe(),tu.data.of({closeBrackets:{brackets:["(","[","{","'",'"',"<"]},bracketMatching:{brackets:["(","[","{","'",'"',"<"]}}),aG,uG,mE(Gq),vt.updateListener.of(c=>e(c)),dq({cursorBlinkRate:0}),ui.highest(Bc.of([{key:"Ctrl-Enter",run:()=>t==null?void 0:t()},{key:"Alt-Enter",run:()=>t==null?void 0:t()},{key:"Ctrl-.",run:()=>s==null?void 0:s()},{key:"Alt-.",preventDefault:!0,run:()=>s==null?void 0:s()}]))]});return new vt({state:l,parent:r})}class pG{constructor(e){const{root:t,id:s,initialCode:r="",onDraw:a,drawContext:i,drawTime:o=[0,0],autodraw:l,prebake:c,bgFill:u=!0,solo:h=!0,...d}=e;this.code=r,this.root=t,this.miniLocations=[],this.widgets=[],this.drawTime=o,this.drawContext=i,this.onDraw=a||this.draw,this.id=s||EEe(),this.solo=h,this.drawer=new Gbe((O,S,A,F)=>{const j=O.filter(N=>N.isActive(S));this.highlight(j,S),this.onDraw(O,S,F)},o),this.prebaked=c(),l&&this.drawFirstFrame(),this.repl=lV({...d,id:s,onToggle:O=>{var S;(S=d==null?void 0:d.onToggle)==null||S.call(d,O),O?(this.drawer.start(this.repl.scheduler),this.solo&&document.dispatchEvent(new CustomEvent("start-repl",{detail:this.id}))):(this.drawer.stop(),k1(this.editor,[]),ED(!0,s))},beforeEval:async()=>{var O;ED(!0,s),await this.prebaked,await((O=d==null?void 0:d.beforeEval)==null?void 0:O.call(d))},afterEval:O=>{var j,N,$;this.miniLocations=(j=O.meta)==null?void 0:j.miniLocations,this.widgets=(N=O.meta)==null?void 0:N.widgets;const S=this.widgets.filter(L=>L.type==="slider");rG(this.editor,S);const A=this.widgets.filter(L=>L.type!=="slider");iG(this.editor,A),k1(this.editor,this.miniLocations),($=d==null?void 0:d.afterEval)==null||$.call(d,O);const F=O.pattern.getPainters().length?this.drawTime:[0,0];this.drawer.setDrawTime(F),this.drawer.invalidate(this.repl.scheduler)}}),this.editor=dG({root:t,initialCode:r,onChange:O=>{var S,A;O.docChanged&&(this.code=O.state.doc.toString(),(A=(S=this.repl).setCode)==null||A.call(S,this.code))},onEvaluate:()=>this.evaluate(),onStop:()=>this.stop(),mondo:d.mondo});const m=this.root.querySelector(".cm-editor");m&&(this.root.style.display="block",u&&(this.root.style.backgroundColor="var(--background)"),m.style.backgroundColor="transparent");const y=Sd.get();this.setFontSize(y.fontSize),this.setFontFamily(y.fontFamily),this.onStartRepl=O=>{this.solo&&O.detail!==this.id&&this.stop()},document.addEventListener("start-repl",this.onStartRepl)}draw(e,t,s){s==null||s.forEach(r=>r(this.drawContext,t,e,this.drawTime))}async drawFirstFrame(){var e;if(this.onDraw){await this.prebaked;try{await this.repl.evaluate(this.code,!1),this.drawer.invalidate(this.repl.scheduler,-.001),(e=this.onDraw)==null||e.call(this,this.drawer.visibleHaps,-.001,this.drawer.painters)}catch{console.warn("first frame could not be painted")}}}async evaluate(){this.flash(),await this.repl.evaluate(this.code)}async stop(){this.repl.scheduler.stop()}async toggle(){this.repl.scheduler.started?this.repl.stop():this.evaluate()}flash(e){uW(this.editor,e)}highlight(e,t){dW(this.editor,t,e)}setFontSize(e){this.root.style.fontSize=e+"px"}setFontFamily(e){this.root.style.fontFamily=e;const t=this.root.querySelector(".cm-scroller");t&&(t.style.fontFamily=e)}reconfigureExtension(e,t){if(!td[e]){console.warn(`extension ${e} is not known`);return}t=mG(t);const s=td[e](t,this);this.editor.dispatch({effects:tC[e].reconfigure(s)}),e==="theme"&&LE(t)}setLineWrappingEnabled(e){this.reconfigureExtension("isLineWrappingEnabled",e)}setBracketMatchingEnabled(e){this.reconfigureExtension("isBracketMatchingEnabled",e)}setLineNumbersDisplayed(e){this.reconfigureExtension("isLineNumbersDisplayed",e)}setBracketClosingEnabled(e){this.reconfigureExtension("isBracketClosingEnabled",e)}setTheme(e){this.reconfigureExtension("theme",e)}setAutocompletionEnabled(e){this.reconfigureExtension("isAutoCompletionEnabled",e)}updateSettings(e){this.setFontSize(e.fontSize),this.setFontFamily(e.fontFamily);for(let s in td)this.reconfigureExtension(s,e[s]);const t={...Sd.get(),...e};Sd.set(t)}changeSetting(e,t){if(td[e]){this.reconfigureExtension(e,t);return}else e==="fontFamily"?this.setFontFamily(t):e==="fontSize"&&this.setFontSize(t)}setCode(e){const t={from:0,to:this.editor.state.doc.length,insert:e};this.editor.dispatch({changes:t})}clear(){this.onStartRepl&&document.removeEventListener("start-repl",this.onStartRepl)}getCursorLocation(){return this.editor.state.selection.main.head}setCursorLocation(e){return this.editor.dispatch({selection:{anchor:e}})}appendCode(e){const t=this.getCursorLocation();this.setCode(this.code+e),this.setCursorLocation(t)}}function mG(n){return{true:!0,false:!1}[n]??n}function EEe(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}const MEe=ke("markcss"),DEe=Object.freeze(Object.defineProperty({__proto__:null,BlockWidget:cG,SliderWidget:sG,StrudelMirror:pG,activateTheme:LE,addWidget:jE,codemirrorSettings:Sd,defaultSettings:hG,flash:uW,flashField:cW,highlightExtension:pW,highlightMiniLocations:dW,initEditor:dG,initTheme:nG,injectStyle:tG,isFlashEnabled:hW,isPatternHighlightingEnabled:mW,markcss:MEe,registerWidget:Dh,setFlash:x1,setMiniLocations:DE,setSliderWidgets:QE,setWidget:lG,settings:yb,showMiniLocations:TE,slider:OEe,sliderPlugin:aG,sliderValues:kd,sliderWithID:wEe,theme:eG,themeColors:fEe,themes:JS,toggleBlockComment:xE,toggleBlockCommentByLine:dU,toggleComment:jv,toggleLineComment:hU,updateMiniLocations:k1,updateSliderWidgets:rG,updateWidgets:iG,widgetPlugin:uG},Symbol.toStringTag,{value:"Module"}));async function TEe(){const n=xA(uV,ds(()=>import("./index-BlL7NNdw-BccxfaFl.js"),__vite__mapDeps([3,1,0])),Promise.resolve().then(()=>lye),ds(()=>import("./index-Dey5jBuS-BbPKYugp.js"),__vite__mapDeps([4,1,0])),Promise.resolve().then(()=>Nve),Promise.resolve().then(()=>DEe),ds(()=>import("./hydra-DKOnazUo-CxeqApDG.js"),__vite__mapDeps([5,1,0])),ds(()=>import("./index-A_ER2EO_-Ex0iZyga.js"),__vite__mapDeps([6,1,0])),ds(()=>import("./index-CGsTjduW-FbrGUNuc.js"),__vite__mapDeps([7,1,0]))),e="https://raw.githubusercontent.com/felixroos/dough-samples/main/";await Promise.all([n,_Z(),QZ(),ds(async()=>{const{registerSoundfonts:s}=await import("./index-A_ER2EO_-Ex0iZyga.js");return{registerSoundfonts:s}},__vite__mapDeps([6,1,0])).then(({registerSoundfonts:s})=>s()),Ic(`${e}/tidal-drum-machines.json`),Ic(`${e}/piano.json`),Ic(`${e}/Dirt-Samples.json`),Ic(`${e}/uzu-drumkit.json`),Ic(`${e}/vcsl.json`),Ic(`${e}/mridangam.json`)]),EZ("https://raw.githubusercontent.com/todepond/samples/main//tidal-drum-machines-alias.json")}const BEe=Mh("C8"),FEe=(n,e)=>n*e+(1-e)/2;mt.prototype.piano=function(){return this.fmap(n=>({...n,clip:n.clip??1})).s("piano").release(.1).fmap(n=>{const e=xN(n),t=FEe(Math.min(Math.round(e)/BEe,1),.5);return{...n,pan:(n.pan||1)*t}})};if(typeof HTMLElement<"u"){class n extends HTMLElement{constructor(){super();Yl(this,"settings",Sd.get());Yl(this,"editor",null);Yl(this,"sync",!1);Yl(this,"solo",!0)}attributeChangedCallback(s,r,a){var i;s==="code"&&(this.code=a,(i=this.editor)==null||i.setCode(a))}connectedCallback(){setTimeout(()=>{const i=(this.innerHTML+"").replace("<!--","").replace("-->","").trim();i&&this.setAttribute("code",i)});const s=document.createElement("div");this.parentElement.insertBefore(s,this.nextSibling);const r=Ec(),a=[-2,2];this.editor=new pG({defaultOutput:zA,getTime:()=>Xn().currentTime,transpiler:b1e,root:s,initialCode:"// LOADING",pattern:xs,drawTime:a,drawContext:r,prebake:TEe,onUpdateState:i=>{const o=new CustomEvent("update",{detail:i});this.dispatchEvent(o)},solo:this.solo,sync:this.sync}),this.editor.updateSettings(this.settings),this.editor.setCode(this.code)}}Yl(n,"observedAttributes",["code"]),customElements.define("strudel-editor",n)}const fG="/api";class Ox extends Error{constructor(e,t,s){super(e),this.status=t,this.data=s}}async function Cn(n,e={}){const t=`${fG}${n}`,s={...e,credentials:"include",headers:{"Content-Type":"application/json",...e.headers}};try{const r=await fetch(t,s),a=await r.json().catch(()=>({}));if(!r.ok)throw new Ox(a.error||"Request failed",r.status,a);return a}catch(r){throw r instanceof Ox?r:new Ox(r.message||"Network error",0,null)}}const Ei={async getCurrentUser(){return Cn("/auth/me")},async logout(){return Cn("/auth/logout",{method:"POST"})},getGoogleLoginUrl(){return`${fG}/auth/google`},async login(n,e){return Cn("/auth/login",{method:"POST",body:JSON.stringify({email:n,password:e})})},async register({email:n,password:e,name:t}){return Cn("/auth/register",{method:"POST",body:JSON.stringify({email:n,password:e,name:t})})},async verifyEmail(n){return Cn("/auth/verify-email",{method:"POST",body:JSON.stringify({token:n})})},async resendVerification(n){return Cn("/auth/resend-verification",{method:"POST",body:JSON.stringify({email:n})})},async requestPasswordReset(n){return Cn("/auth/request-password-reset",{method:"POST",body:JSON.stringify({email:n})})},async resetPassword(n,e){return Cn("/auth/reset-password",{method:"POST",body:JSON.stringify({token:n,password:e})})},async deleteAccount(){return Cn("/auth/delete-account",{method:"POST"})}},Qo={async listUsers(n="",e=50){const t=new URLSearchParams;return n&&t.append("search",n),t.append("limit",e),Cn(`/users?${t.toString()}`)},async getUser(n){return Cn(`/users/${n}`)},async updateUser(n,e){return Cn(`/users/${n}`,{method:"PUT",body:JSON.stringify(e)})},async searchUsers(n){return Cn(`/users/search/${encodeURIComponent(n)}`)},async listAdminUsers(){return Cn("/users/admin/all")},async blockUser(n){return Cn(`/users/${n}/block`,{method:"POST"})},async unblockUser(n){return Cn(`/users/${n}/unblock`,{method:"POST"})},async deleteUser(n){return Cn(`/users/${n}`,{method:"DELETE"})}},gc={async createPattern(n){return Cn("/patterns",{method:"POST",body:JSON.stringify(n)})},async getPatterns(n={}){const e=new URLSearchParams;n.type&&e.append("type",n.type),n.isPublic!==void 0&&e.append("isPublic",n.isPublic),n.shared!==void 0&&e.append("shared",n.shared);const t=e.toString();return Cn(`/patterns${t?`?${t}`:""}`)},async getPattern(n){return Cn(`/patterns/${n}`)},async updatePattern(n,e){return Cn(`/patterns/${n}`,{method:"PUT",body:JSON.stringify(e)})},async deletePattern(n){return Cn(`/patterns/${n}`,{method:"DELETE"})},async sharePattern(n,e){return Cn(`/patterns/${n}/share`,{method:"POST",body:JSON.stringify({userIds:e})})},async getPatternUsers(n){return Cn(`/patterns/${n}/users`)},async getTopTracks(n=5){const e=new URLSearchParams;return e.append("limit",n),Cn(`/patterns/top?${e.toString()}`)},async recordMasterLoad(n){if(!n)throw new Error("patternId is required");return Cn(`/patterns/${encodeURIComponent(n)}/master-load`,{method:"POST"})}},ea={async createSession(n){return Cn("/collab-sessions",{method:"POST",body:JSON.stringify({title:n})})},async getSession(n,{refresh:e=!1}={}){const t=e?"?refresh=true":"";return Cn(`/collab-sessions/${encodeURIComponent(n)}${t}`)},async getCpuStats(n){return Cn(`/collab-sessions/${encodeURIComponent(n)}/cpu`)},async joinSession(n){return Cn(`/collab-sessions/${encodeURIComponent(n)}/join`,{method:"POST"})},async leaveSession(n){return Cn(`/collab-sessions/${encodeURIComponent(n)}/leave`,{method:"POST"})},async getPendingInvites(){return Cn("/collab-sessions/invites")},async acceptInvite(n){return Cn(`/collab-sessions/invites/${encodeURIComponent(n)}/accept`,{method:"POST"})},async declineInvite(n){return Cn(`/collab-sessions/invites/${encodeURIComponent(n)}/decline`,{method:"POST"})},async listRecentSessions(){return Cn("/collab-sessions/recent")},async sendInvites(n,e){return Cn(`/collab-sessions/${encodeURIComponent(n)}/invite`,{method:"POST",body:JSON.stringify({inviteeIds:e})})},async saveChannel(n,e){return Cn(`/collab-sessions/${encodeURIComponent(n)}/channels`,{method:"POST",body:JSON.stringify(e)})},async publishChannel(n,e,t="live"){return Cn(`/collab-sessions/${encodeURIComponent(n)}/channels/${encodeURIComponent(e)}/publish`,{method:"POST",body:JSON.stringify({status:t})})},async overrideMaster(n,e){return Cn(`/collab-sessions/${encodeURIComponent(n)}/master`,{method:"POST",body:JSON.stringify({masterCode:e})})},async updateDelay(n,e){return Cn(`/collab-sessions/${encodeURIComponent(n)}/delay`,{method:"POST",body:JSON.stringify({applyDelayMs:e})})},async deleteSession(n){return Cn(`/collab-sessions/${encodeURIComponent(n)}`,{method:"DELETE"})}};async function gG(){try{return await Ei.getCurrentUser(),!0}catch{return!1}}async function su(){try{return await Ei.getCurrentUser()}catch{return null}}const $Ee={auth:Ei,users:Qo,patterns:gc,collab:ea,isAuthenticated:gG,getCurrentUser:su},dc=Object.freeze(Object.defineProperty({__proto__:null,authAPI:Ei,collabAPI:ea,default:$Ee,getCurrentUser:su,isAuthenticated:gG,patternsAPI:gc,usersAPI:Qo},Symbol.toStringTag,{value:"Module"})),_f=new Set;function Wv(){const n=document.body;if(!n){setTimeout(Wv,0);return}_f.size>0?n.style.overflow="hidden":n.style.overflow=""}function uo(n="global"){_f.add(n),Wv()}function Bi(n="global"){n?_f.delete(n):_f.clear(),Wv()}function Rf(){_f.clear(),Wv()}class NEe{constructor(){this.modal=null,this.onLoginSuccess=null,this.activeForm="login",this.statusEl=null}init(){this.createModal(),this.attachEventListeners(),this.checkAuthStatus()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="login-modal-overlay" id="login-modal-overlay" style="display: none;">
        <div class="login-modal">
          <div class="login-modal-header">
            <h2 class="login-logo">Sign in to Strudesk 4000</h2>
            <button class="login-modal-close" id="login-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="login-modal-body">
            <div class="login-tabs">
              <button type="button" class="login-tab active" data-auth-tab="login">Login</button>
              <button type="button" class="login-tab" data-auth-tab="signup">Create account</button>
            </div>

            <form id="login-email-form" data-auth-form="login" class="auth-form auth-form-active">
              <div class="form-group">
                <label for="login-email">Email</label>
                <input type="email" id="login-email" required placeholder="you@example.com" />
              </div>
              <div class="form-group">
                <label for="login-password">Password</label>
                <input type="password" id="login-password" required placeholder="••••••••" />
              </div>
              <button type="submit" class="btn-primary">Login</button>
              <div class="auth-links">
                <button type="button" data-show-form="reset-request">Forgot password?</button>
                <button type="button" data-show-form="verify-email">Verify email</button>
              </div>
            </form>

            <form id="signup-email-form" data-auth-form="signup" class="auth-form">
              <div class="form-group">
                <label for="signup-name">Name</label>
                <input type="text" id="signup-name" placeholder="Display name" />
              </div>
              <div class="form-group">
                <label for="signup-email">Email</label>
                <input type="email" id="signup-email" required placeholder="you@example.com" />
              </div>
              <div class="form-group">
                <label for="signup-password">Password</label>
                <input type="password" id="signup-password" required placeholder="Create a password" />
              </div>
              <button type="submit" class="btn-primary">Create account</button>
            </form>

            <form id="verify-email-form" data-auth-form="verify-email" class="auth-form">
              <div class="form-group">
                <label for="verify-token">Verification token</label>
                <input type="text" id="verify-token" placeholder="Paste token here" required />
              </div>
              <button type="submit" class="btn-primary">Verify email</button>
              <div class="auth-links">
                <button type="button" data-show-form="login">Back to login</button>
                <button type="button" data-resend-verification>Resend verification email</button>
              </div>
            </form>

            <form id="reset-request-form" data-auth-form="reset-request" class="auth-form">
              <div class="form-group">
                <label for="reset-email">Email</label>
                <input type="email" id="reset-email" required placeholder="you@example.com" />
              </div>
              <button type="submit" class="btn-primary">Send reset link</button>
              <div class="auth-links">
                <button type="button" data-show-form="reset-password">Have a reset token?</button>
                <button type="button" data-show-form="login">Back to login</button>
              </div>
            </form>

            <form id="reset-password-form" data-auth-form="reset-password" class="auth-form">
              <div class="form-group">
                <label for="reset-token">Reset token</label>
                <input type="text" id="reset-token" required placeholder="Token from email" />
              </div>
              <div class="form-group">
                <label for="reset-new-password">New password</label>
                <input type="password" id="reset-new-password" required placeholder="New password" />
              </div>
              <button type="submit" class="btn-primary">Update password</button>
              <div class="auth-links">
                <button type="button" data-show-form="login">Back to login</button>
              </div>
            </form>

            <div class="auth-status" id="login-status-message"></div>

            <div class="login-separator"><span>or</span></div>

            <div class="login-buttons">
              <button class="login-button login-button-google" id="login-google">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" aria-hidden="true">
                  <path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z" fill="#4285F4"/>
                  <path d="M9 18c2.43 0 4.467-.806 5.965-2.18l-2.908-2.258c-.806.54-1.837.86-3.057.86-2.35 0-4.34-1.587-5.053-3.72H.957v2.332C2.438 15.983 5.482 18 9 18z" fill="#34A853"/>
                  <path d="M3.947 10.712c-.18-.54-.282-1.117-.282-1.712s.102-1.172.282-1.712V4.956H.957C.348 6.174 0 7.55 0 9s.348 2.826.957 4.044l2.99-2.332z" fill="#FBBC05"/>
                  <path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.956L3.947 7.288C4.66 5.153 6.65 3.58 9 3.58z" fill="#EA4335"/>
                </svg>
                Continue with Google
              </button>
            </div>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("login-modal-overlay"),this.statusEl=document.getElementById("login-status-message")}attachEventListeners(){var m;const e=document.getElementById("login-modal-close");e==null||e.addEventListener("click",()=>this.hide()),(m=this.modal)==null||m.addEventListener("click",y=>{y.target===this.modal&&this.hide()}),document.querySelectorAll("[data-auth-tab]").forEach(y=>{y.addEventListener("click",()=>{this.setActiveForm(y.dataset.authTab)})}),document.querySelectorAll("[data-show-form]").forEach(y=>{y.addEventListener("click",()=>{this.setActiveForm(y.dataset.showForm)})});const t=document.querySelector("[data-resend-verification]");t==null||t.addEventListener("click",async()=>{var O,S;const y=((O=document.getElementById("signup-email"))==null?void 0:O.value)||((S=document.getElementById("login-email"))==null?void 0:S.value);if(!y){this.setStatus("Enter your email in the login or signup form first.","error");return}try{this.setStatus("Sending verification email...","info");const A=await Ei.resendVerification(y);if(A!=null&&A.verificationToken){const F=document.getElementById("verify-token");F&&(F.value=A.verificationToken),this.setStatus(A.note||"Verification token sent. Use the token below.","info")}else this.setStatus("Verification email sent.","success")}catch(A){this.setStatus(A.message||"Failed to resend verification email.","error")}});const s=document.getElementById("login-email-form");s==null||s.addEventListener("submit",async y=>{var A,F;y.preventDefault();const O=(A=document.getElementById("login-email"))==null?void 0:A.value.trim(),S=(F=document.getElementById("login-password"))==null?void 0:F.value;if(!(!O||!S))try{this.setStatus("Signing in...","info");let j=null;const N=await Ei.login(O,S);if(N!=null&&N.user)j=N.user;else{const{getCurrentUser:$}=await ds(async()=>{const{getCurrentUser:L}=await Promise.resolve().then(()=>dc);return{getCurrentUser:L}},void 0);j=await $()}this.setStatus("Login successful!","success"),j&&this.onLoginSuccess?this.onLoginSuccess(j,!0):await this.checkAuthStatus(!0),this.hide()}catch(j){this.setStatus(j.message||"Login failed.","error")}});const r=document.getElementById("signup-email-form");r==null||r.addEventListener("submit",async y=>{var F,j,N,$;y.preventDefault();const O=(F=document.getElementById("signup-name"))==null?void 0:F.value.trim(),S=(j=document.getElementById("signup-email"))==null?void 0:j.value.trim(),A=(N=document.getElementById("signup-password"))==null?void 0:N.value;if(!(!S||!A))try{this.setStatus("Creating account...","info");const L=await Ei.register({email:S,password:A,name:O});if(this.setActiveForm("verify-email"),document.getElementById("login-email").value=S,L!=null&&L.verificationToken){const I=document.getElementById("verify-token");I&&(I.value=L.verificationToken),this.setStatus(L.note||"Account created! Use the verification token below.","info")}else this.setStatus("Account created! Check your email for verification token.","success"),($=document.getElementById("verify-token"))==null||$.focus()}catch(L){this.setStatus(L.message||"Registration failed.","error")}});const a=document.getElementById("verify-email-form");a==null||a.addEventListener("submit",async y=>{var S;y.preventDefault();const O=(S=document.getElementById("verify-token"))==null?void 0:S.value.trim();if(O)try{this.setStatus("Verifying...","info");const A=await Ei.verifyEmail(O);this.setStatus("Email verified! You can now log in.","success"),A!=null&&A.user?(await this.checkAuthStatus(!0),this.hide()):this.setActiveForm("login")}catch(A){this.setStatus(A.message||"Verification failed.","error")}});const i=document.getElementById("reset-request-form");i==null||i.addEventListener("submit",async y=>{var S;y.preventDefault();const O=(S=document.getElementById("reset-email"))==null?void 0:S.value.trim();if(O)try{this.setStatus("Sending reset link...","info"),await Ei.requestPasswordReset(O),this.setStatus("Reset instructions sent (check server log in dev).","success")}catch(A){this.setStatus(A.message||"Failed to send reset email.","error")}});const o=document.getElementById("reset-password-form");o==null||o.addEventListener("submit",async y=>{var A,F;y.preventDefault();const O=(A=document.getElementById("reset-token"))==null?void 0:A.value.trim(),S=(F=document.getElementById("reset-new-password"))==null?void 0:F.value;if(!(!O||!S))try{this.setStatus("Updating password...","info"),await Ei.resetPassword(O,S),this.setStatus("Password updated. You can now log in.","success"),this.setActiveForm("login")}catch(j){this.setStatus(j.message||"Failed to update password.","error")}});const l=document.getElementById("login-google");l==null||l.addEventListener("click",async()=>{window.location.href=Ei.getGoogleLoginUrl()});const c=new URLSearchParams(window.location.search),u=c.get("auth"),h=()=>{Rf()},d=()=>{this.modal&&this.modal.style.display!=="none"?this.hide():h()};if(u==="success"){setTimeout(async()=>{console.log("🔍 Checking auth status after Google login redirect..."),await this.checkAuthStatus(!0)?(console.log("✅ Auth check successful after Google login"),d()):(console.log("⚠️ First auth check failed, retrying..."),setTimeout(async()=>{await this.checkAuthStatus(!0)?(console.log("✅ Auth check successful after Google login (retry)"),d()):(console.error("❌ Auth check failed after retry - session may not be set"),this.show(),this.setStatus("Login successful but session not established. Please refresh the page.","error"))},1e3))},500);const y=`${window.location.origin}${window.location.pathname}${window.location.hash}`;window.history.replaceState({},document.title,y)}else if(u==="error"){const y=c.get("message")||"Authentication failed";this.show(),this.setStatus(y,"error");const O=`${window.location.origin}${window.location.pathname}${window.location.hash}`;window.history.replaceState({},document.title,O)}}setActiveForm(e){this.activeForm=e,document.querySelectorAll(".auth-form").forEach(t=>{t.classList.toggle("auth-form-active",t.dataset.authForm===e)}),document.querySelectorAll("[data-auth-tab]").forEach(t=>{t.classList.toggle("active",t.dataset.authTab===e)}),this.clearStatus()}setStatus(e,t="info"){this.statusEl&&(this.statusEl.textContent=e,this.statusEl.dataset.statusType=t)}clearStatus(){this.statusEl&&(this.statusEl.textContent="",this.statusEl.dataset.statusType="")}async checkAuthStatus(e=!1){try{const{getCurrentUser:t}=await ds(async()=>{const{getCurrentUser:r}=await Promise.resolve().then(()=>dc);return{getCurrentUser:r}},void 0),s=await t();return s&&this.onLoginSuccess?(this.onLoginSuccess(s,e),!0):!!s}catch(t){return e&&this.setStatus(t.message||"Authentication failed.","error"),!1}}show(){this.modal&&(this.setActiveForm("login"),this.modal.style.display="flex",uo("login-modal"))}hide(){this.modal&&(this.modal.style.display="none",Bi("login-modal"),this.clearStatus())}setOnLoginSuccess(e){this.onLoginSuccess=e}}class _Ee{constructor(){this.modal=null,this.user=null,this.onUpdate=null}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="user-profile-modal-overlay" id="user-profile-modal-overlay" style="display: none;">
        <div class="user-profile-modal">
          <div class="user-profile-modal-header">
            <h2>Edit Profile</h2>
            <button class="user-profile-modal-close" id="user-profile-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="user-profile-modal-body">
            <form id="user-profile-form">
              <div class="form-group" id="profile-avatar-group">
                <label for="profile-avatar-url">Profile Image</label>
                <div class="avatar-preview-container">
                  <img id="profile-avatar-preview" src="" alt="Avatar preview" style="display: none; width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin-bottom: 10px; border: 2px solid #ddd;" />
                  <input type="url" id="profile-avatar-url" placeholder="https://example.com/your-image.jpg" />
                  <small id="profile-avatar-note">Enter a URL to your profile image</small>
                  <small id="profile-avatar-provider-note" style="display: none;">Your profile image is managed by Google and can be changed from your Google Account.</small>
                </div>
              </div>

              <div class="form-group">
                <label for="profile-artist-name">Artist Name (Pseudonym)</label>
                <input type="text" id="profile-artist-name" placeholder="Your artist name or pseudonym" />
                <small>This will be used as the default copyright holder for your patterns</small>
              </div>

              <div class="form-group">
                <label>Social Media Links</label>
                <div class="social-links-grid">
                  <div class="social-link-item">
                    <label for="social-twitter">Twitter/X</label>
                    <input type="url" id="social-twitter" placeholder="https://twitter.com/username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-facebook">Meta/Facebook</label>
                    <input type="url" id="social-facebook" placeholder="https://facebook.com/username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-instagram">Instagram</label>
                    <input type="url" id="social-instagram" placeholder="https://instagram.com/username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-soundcloud">SoundCloud</label>
                    <input type="url" id="social-soundcloud" placeholder="https://soundcloud.com/username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-bandcamp">Bandcamp</label>
                    <input type="url" id="social-bandcamp" placeholder="https://username.bandcamp.com" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-youtube">YouTube</label>
                    <input type="url" id="social-youtube" placeholder="https://youtube.com/@username" />
                  </div>
                  <div class="social-link-item">
                    <label for="social-spotify">Spotify</label>
                    <input type="url" id="social-spotify" placeholder="https://open.spotify.com/artist/..." />
                  </div>
                  <div class="social-link-item">
                    <label for="social-website">Website</label>
                    <input type="url" id="social-website" placeholder="https://yourwebsite.com" />
                  </div>
                </div>
              </div>

              <div class="form-group">
                <div class="user-profile-info">
                  <p><strong>Display Name:</strong> <span id="profile-display-name"></span></p>
                  <p><strong>Joined:</strong> <span id="profile-display-joined"></span></p>
                </div>
              </div>

              <div class="user-profile-optional">
                <div class="user-profile-optional-header">
                  <h3>Personal details (optional)</h3>
                  <p>These details stay private and help us personalize your experience.</p>
                </div>
                <div class="user-profile-optional-grid">
                  <div class="form-group user-profile-email-field">
                    <label>Email</label>
                    <div class="user-profile-email" id="profile-email-display">—</div>
                  </div>
                  <div class="form-group user-profile-birthdate-field">
                    <label for="profile-birth-date">Birth date</label>
                    <input type="date" id="profile-birth-date" />
                  </div>
                  <div class="form-group user-profile-first-name">
                    <label for="profile-first-name">First name</label>
                    <input type="text" id="profile-first-name" placeholder="First name" />
                  </div>
                  <div class="form-group user-profile-last-name">
                    <label for="profile-last-name">Last name</label>
                    <input type="text" id="profile-last-name" placeholder="Last name" />
                  </div>
                  <div class="form-group">
                    <label for="profile-city">City</label>
                    <input type="text" id="profile-city" placeholder="City" />
                  </div>
                  <div class="form-group">
                    <label for="profile-country">Country</label>
                    <input type="text" id="profile-country" placeholder="Country" />
                  </div>
                </div>
              </div>

              <div class="user-profile-modal-footer">
                <button
                  type="button"
                  class="user-profile-footer-btn user-profile-footer-btn--danger"
                  id="profile-delete-account-btn"
                >Delete Account</button>
                <button
                  type="button"
                  class="user-profile-footer-btn user-profile-footer-btn--neutral"
                  id="profile-cancel-btn"
                >Cancel</button>
                <button
                  type="submit"
                  class="user-profile-footer-btn user-profile-footer-btn--primary"
                  id="profile-save-btn"
                >Save Changes</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("user-profile-modal-overlay")}attachEventListeners(){const e=document.getElementById("user-profile-modal-close");e&&e.addEventListener("click",()=>this.hide());const t=document.getElementById("profile-delete-account-btn");t&&t.addEventListener("click",async()=>{if(confirm("Delete your account and all patterns? This action cannot be undone."))try{await Ei.deleteAccount(),window.location.reload()}catch(a){console.error("Delete account error:",a),alert(a.message||"Failed to delete account")}});const s=document.getElementById("profile-cancel-btn");s&&s.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",a=>{a.target===this.modal&&this.hide()});const r=document.getElementById("user-profile-form");r&&r.addEventListener("submit",async a=>{a.preventDefault(),await this.saveProfile()})}async loadUserData(){try{let e=this.user;if(e?console.log("loadUserData: using existing user:",e):(e=await su(),console.log("loadUserData: fetched user via API:",e)),!e)throw new Error("Not authenticated");if(!e.id)throw new Error("User object missing ID");this.user=e,console.log("loadUserData: this.user set to:",this.user);let t=e;try{t=await Qo.getUser(e.id),t&&e.oauthProvider&&!t.oauthProvider&&(t.oauthProvider=e.oauthProvider),this.user=t}catch(S){console.warn("Failed to fetch full user data, using current user data:",S)}if(!this.user)throw new Error("No user data available");const s=document.getElementById("profile-avatar-url"),r=document.getElementById("profile-avatar-preview");s&&(s.value=this.user.avatarUrl||"",s.dataset.listenerAttached||(s.dataset.listenerAttached="true",s.addEventListener("input",S=>{const A=S.target.value.trim();r&&(A?(r.src=A,r.style.display="block",r.onerror=()=>{r.style.display="none"}):r.style.display="none")})),this.user.avatarUrl&&r?(r.src=this.user.avatarUrl,r.style.display="block",r.onerror=()=>{r.style.display="none"}):r&&(r.style.display="none")),this.updateAvatarFieldState();const a=document.getElementById("profile-artist-name");a&&(a.value=this.user.artistName||"");const i=document.getElementById("profile-display-name");if(i){const S=this.user.artistName||this.user.name||"Not set";i.textContent=S}const o=document.getElementById("profile-display-joined");if(o&&this.user.createdAt){const S=new Date(this.user.createdAt);o.textContent=S.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}else o&&(o.textContent="Unknown");const l=document.getElementById("profile-email-display");l&&(l.textContent=this.user.email||"Not set");const c=document.getElementById("profile-first-name");c&&(c.value=this.user.firstName||"");const u=document.getElementById("profile-last-name");u&&(u.value=this.user.lastName||"");const h=document.getElementById("profile-city");h&&(h.value=this.user.city||"");const d=document.getElementById("profile-country");d&&(d.value=this.user.country||"");const m=document.getElementById("profile-birth-date");if(m)if(this.user.birthDate){const S=new Date(this.user.birthDate);Number.isNaN(S.getTime())?m.value="":m.value=S.toISOString().split("T")[0]}else m.value="";const y=this.user.socialLinks||{};return["twitter","facebook","instagram","soundcloud","bandcamp","youtube","spotify","website"].forEach(S=>{const A=document.getElementById(`social-${S}`);A&&(A.value=y[S]||"")}),this.user}catch(e){return console.error("Error loading user data:",e),this.user||alert("Failed to load profile data: "+(e.message||"Unknown error")),this.user||null}}isAvatarManagedExternally(){var e;return((e=this.user)==null?void 0:e.oauthProvider)==="google"}updateAvatarFieldState(){var o;const e=document.getElementById("profile-avatar-group"),t=document.getElementById("profile-avatar-url"),s=document.getElementById("profile-avatar-note"),r=document.getElementById("profile-avatar-provider-note"),a=document.getElementById("profile-avatar-preview"),i=this.isAvatarManagedExternally();e&&(e.classList.toggle("is-locked",i),i?(t&&(t.disabled=!0,t.style.display="none"),s&&(s.style.display="none"),r&&(r.style.display="block"),a&&((o=this.user)!=null&&o.avatarUrl?(a.src=this.user.avatarUrl,a.style.display="block"):a.style.display="none")):(t&&(t.disabled=!1,t.style.display=""),s&&(s.style.display="block"),r&&(r.style.display="none")))}async saveProfile(){var s,r,a,i,o,l;console.log("saveProfile called, this.user =",this.user);let e;try{if(e=await su(),!e||!e.id){alert("Your session has expired. Please log in again."),window.location.reload();return}}catch(c){console.error("saveProfile: Failed to verify authentication:",c),alert("Your session has expired. Please log in again."),window.location.reload();return}const t=e.id;if(!this.user||this.user.id!==t)try{await this.loadUserData(),(!this.user||this.user.id!==t)&&(this.user=e)}catch(c){console.warn("saveProfile: Failed to reload user data, using current user:",c),this.user=e}if(!this.user||!this.user.id){console.error("saveProfile: User ID missing",this.user),alert("User ID missing. Please try logging in again.");return}if(this.user.id!==t){alert("You can only edit your own profile. Please refresh the page.");return}try{const c=document.getElementById("profile-avatar-url"),u=c?c.value.trim():"",h=((s=document.getElementById("profile-artist-name"))==null?void 0:s.value.trim())||null,d=((r=document.getElementById("profile-first-name"))==null?void 0:r.value.trim())||"",m=((a=document.getElementById("profile-last-name"))==null?void 0:a.value.trim())||"",y=((i=document.getElementById("profile-birth-date"))==null?void 0:i.value)||"",O=((o=document.getElementById("profile-city"))==null?void 0:o.value.trim())||"",S=((l=document.getElementById("profile-country"))==null?void 0:l.value.trim())||"",A={};["twitter","facebook","instagram","soundcloud","bandcamp","youtube","spotify","website"].forEach(I=>{const q=document.getElementById(`social-${I}`);q&&q.value.trim()&&(A[I]=q.value.trim())});const j=I=>{const q=I==null?void 0:I.trim();return q||null};let N=null;if(y){const I=new Date(y);Number.isNaN(I.getTime())||(N=I.toISOString())}const $={artistName:h,socialLinks:A,firstName:j(d),lastName:j(m),city:j(O),country:j(S),birthDate:y?N:null};this.isAvatarManagedExternally()||($.avatarUrl=u||null);const L=await Qo.updateUser(t,$);this.user=L,this.onUpdate&&this.onUpdate(L),this.hide(),alert("Profile updated successfully!")}catch(c){console.error("Error saving profile:",c),c.status===401?(alert("Your session has expired. Please log in again."),window.location.reload()):alert("Failed to save profile: "+(c.message||"Unknown error"))}}async show(e=null){if(!this.modal){console.error("Profile modal not initialized");return}try{if(!e&&!this.user){const s=await su();if(!s)throw new Error("Please log in to view your profile.");this.user=s}if(e&&(this.user=e),!await this.loadUserData()&&!this.user){alert("Unable to load user profile. Please try logging in again.");return}this.modal.style.display="flex",uo("user-profile-modal")}catch(t){console.error("Error showing profile modal:",t),this.user||alert("Failed to load profile: "+(t.message||"Unknown error"))}}hide(){this.modal&&(this.modal.style.display="none",Bi("user-profile-modal"))}setOnUpdate(e){this.onUpdate=e}}class REe{constructor(){this.modal=null,this.users=[],this.searchTimeout=null}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="user-profiles-modal-overlay" id="user-profiles-modal-overlay" style="display: none;">
        <div class="user-profiles-modal">
          <div class="user-profiles-modal-header">
            <h2>User Profiles</h2>
            <button class="user-profiles-modal-close" id="user-profiles-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="user-profiles-modal-body">
            <div class="profiles-search-container">
              <input 
                type="text" 
                id="profiles-search-input" 
                placeholder="Search users by name, email, or artist name..." 
                class="profiles-search-input"
              />
            </div>
            <div class="profiles-list" id="profiles-list">
              <div class="profiles-loading">Loading profiles...</div>
            </div>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("user-profiles-modal-overlay")}attachEventListeners(){const e=document.getElementById("user-profiles-modal-close");e&&e.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",s=>{s.target===this.modal&&this.hide()});const t=document.getElementById("profiles-search-input");t&&t.addEventListener("input",s=>{const r=s.target.value.trim();clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.loadUsers(r)},300)})}async loadUsers(e=""){const t=document.getElementById("profiles-list");if(t)try{t.innerHTML='<div class="profiles-loading">Loading profiles...</div>';const s=await Qo.listUsers(e,100);if(this.users=s,s.length===0){t.innerHTML='<div class="profiles-empty">No users found.</div>';return}t.innerHTML=s.map(r=>this.renderUserCard(r)).join("")}catch(s){console.error("Error loading users:",s),t.innerHTML='<div class="profiles-error">Failed to load profiles. Please try again.</div>'}}renderUserCard(e){var c;const t=e.artistName&&e.artistName.trim()||e.name||e.email||"Unnamed Artist",s=t.charAt(0).toUpperCase(),r=e.avatarUrl||"https://via.placeholder.com/80?text="+encodeURIComponent(s),a=((c=e._count)==null?void 0:c.patterns)||0,i=e.socialLinks||{},o=this.renderSocialLinks(i);let l="";return e.createdAt&&(l=`<div class="user-card-date">Joined ${new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}</div>`),`
      <div class="user-card" data-user-id="${e.id}">
        <div class="user-card-avatar">
          <img src="${r}" alt="${this.escapeHtml(t)}" onerror="this.src='https://via.placeholder.com/80?text=' + encodeURIComponent('${this.escapeHtml(s)}')" />
        </div>
        <div class="user-card-info">
          <div class="user-card-name">${this.escapeHtml(t)}</div>
          ${l}
          <div class="user-card-stats">
            <span class="user-card-patterns">${a} pattern${a!==1?"s":""}</span>
          </div>
          ${o}
        </div>
      </div>
    `}getSocialIcon(e){return{twitter:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>',facebook:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>',instagram:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>',soundcloud:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M17.707 8.274A4.36 4.36 0 0 0 13.638 6a4.35 4.35 0 0 0-.947.112 4.989 4.989 0 0 0-9.79.654A3.52 3.52 0 0 0 3.507 16H19.23a3.307 3.307 0 1 0 .558-6.632h-.013a4.33 4.33 0 0 0-2.068-1.094z"/></svg>',bandcamp:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M2.4 6h7.4l5.8 6-5.8 6H2.4l5.8-6z"/></svg>',youtube:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>',spotify:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.84-.179-.84-.66 0-.419.36-.66.78-.54 4.56 1.021 8.52 1.561 11.64 1.92.42.06.66.36.6.78zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.42 1.56-.3.421-1.02.599-1.56.3z"/></svg>',website:'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM18.92 8h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"/></svg>'}[e]||'<svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg>'}renderSocialLinks(e){const t=[];return Object.entries(e).forEach(([s,r])=>{if(r){const a=this.getSocialIcon(s);t.push(`<a href="${this.escapeHtml(r)}" target="_blank" rel="noopener noreferrer" class="user-card-social-link" title="${s}">${a}</a>`)}}),t.length===0?"":`<div class="user-card-social">${t.join("")}</div>`}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}async show(){if(this.modal){this.modal.style.display="flex",uo("user-profiles-modal"),await this.loadUsers();const e=document.getElementById("profiles-search-input");e&&setTimeout(()=>e.focus(),100)}}hide(){if(this.modal){this.modal.style.display="none",Bi("user-profiles-modal");const e=document.getElementById("profiles-search-input");e&&(e.value="")}}}class IEe{constructor(){this.modal=null,this.user=null,this.patterns=[],this.currentEditingId=null}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="user-submissions-modal-overlay" id="user-submissions-modal-overlay" style="display: none;">
        <div class="user-submissions-modal">
          <div class="user-submissions-modal-header">
            <h2>My Submissions</h2>
            <button class="user-submissions-modal-close" id="user-submissions-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="user-submissions-modal-body">
            <div class="user-submissions-tabs">
              <button class="user-submissions-tab active" data-tab="all">All</button>
              <button class="user-submissions-tab" data-tab="master">Tracks</button>
              <button class="user-submissions-tab" data-tab="channel">Patterns</button>
            </div>
            <div class="user-submissions-content">
              <div class="user-submissions-loading" id="user-submissions-loading" style="display: none;">
                <p>Loading your submissions...</p>
              </div>
              <div class="user-submissions-empty" id="user-submissions-empty" style="display: none;">
                <p>You haven't submitted any patterns or tracks yet.</p>
              </div>
              <div class="user-submissions-list" id="user-submissions-list"></div>
            </div>
          </div>
          <div class="user-submissions-modal-footer">
            <button
              type="button"
              class="user-submissions-footer-btn user-submissions-footer-btn--neutral"
              id="user-submissions-close-btn"
            >Close</button>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("user-submissions-modal-overlay")}attachEventListeners(){var r;const e=document.getElementById("user-submissions-modal-close");e&&e.addEventListener("click",()=>this.hide());const t=document.getElementById("user-submissions-close-btn");t&&t.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",a=>{a.target===this.modal&&this.hide()});const s=(r=this.modal)==null?void 0:r.querySelectorAll(".user-submissions-tab");s==null||s.forEach(a=>{a.addEventListener("click",()=>{const i=a.dataset.tab;this.switchTab(i)})})}switchTab(e){var s;const t=(s=this.modal)==null?void 0:s.querySelectorAll(".user-submissions-tab");t==null||t.forEach(r=>{r.dataset.tab===e?r.classList.add("active"):r.classList.remove("active")}),this.loadPatterns(e==="all"?null:e)}async show(e){if(e||(e=await su()),!e){alert("Please log in to view your submissions.");return}this.user=e,this.currentEditingId=null,this.showModal(),await this.loadPatterns()}async loadPatterns(e=null){const t=document.getElementById("user-submissions-loading"),s=document.getElementById("user-submissions-empty"),r=document.getElementById("user-submissions-list");t&&(t.style.display="block"),s&&(s.style.display="none"),r&&(r.innerHTML="");try{const a={};e&&(a.type=e);let i=await gc.getPatterns(a);i=i.filter(o=>o.userId===this.user.id),this.patterns=i,t&&(t.style.display="none"),i.length===0?(s&&(s.style.display="block"),r&&(r.innerHTML="")):(s&&(s.style.display="none"),this.renderPatterns(i,r))}catch(a){console.error("Error loading patterns:",a),t&&(t.style.display="none"),r&&(r.innerHTML=`<p class="user-submissions-error">Error loading submissions: ${a.message||"Unknown error"}</p>`)}}renderPatterns(e,t){t&&(t.innerHTML="",e.forEach(s=>{const r=this.createPatternElement(s);t.appendChild(r)}))}createPatternElement(e){const t=document.createElement("div");t.className="user-submission-item",t.dataset.patternId=e.id;const s=this.currentEditingId===e.id,r=new Date(e.createdAt).toLocaleDateString(),a=new Date(e.updatedAt).toLocaleDateString(),i=e.type==="master"?"Track":"Pattern",o=e.isPublic?"Public":"Private";t.innerHTML=`
      <div class="user-submission-header">
        <div class="user-submission-info">
          <h3 class="user-submission-title">${e.title||"Untitled"} <span class="user-submission-type">${i}</span></h3>
          <div class="user-submission-meta">
            <span class="user-submission-date">Created: ${r}</span>
            <span class="user-submission-date">Updated: ${a}</span>
            <span class="user-submission-visibility">${o}</span>
            ${e.version>1?`<span class="user-submission-version">v${e.version}</span>`:""}
            ${e.versionName?`<span class="user-submission-version-name">${e.versionName}</span>`:""}
          </div>
        </div>
        <div class="user-submission-actions">
          ${s?`
            <button class="user-submission-btn user-submission-btn--save" data-action="save" data-pattern-id="${e.id}">Save</button>
            <button class="user-submission-btn user-submission-btn--cancel" data-action="cancel" data-pattern-id="${e.id}">Cancel</button>
          `:`
            <button class="user-submission-btn user-submission-btn--edit" data-action="edit" data-pattern-id="${e.id}">Edit</button>
            <button class="user-submission-btn user-submission-btn--delete" data-action="delete" data-pattern-id="${e.id}">Delete</button>
          `}
        </div>
      </div>
      ${s?this.createEditForm(e):this.createViewContent(e)}
    `;const l=t.querySelector('[data-action="edit"]'),c=t.querySelector('[data-action="delete"]'),u=t.querySelector('[data-action="save"]'),h=t.querySelector('[data-action="cancel"]');return l&&l.addEventListener("click",()=>this.startEdit(e.id)),c&&c.addEventListener("click",()=>this.deletePattern(e.id)),u&&u.addEventListener("click",()=>this.savePattern(e.id)),h&&h.addEventListener("click",()=>this.cancelEdit(e.id)),t}createViewContent(e){let t=e.patternCode||"";const s=t.split(`
`);let r=0;for(let a=0;a<s.length;a++)if(s[a].trim().startsWith("// Pattern code:")){r=a+1,r<s.length&&s[r].trim()===""&&r++;break}return r>0&&(t=s.slice(r).join(`
`).trim()),`
      <div class="user-submission-content">
        <div class="user-submission-field">
          <label>Title:</label>
          <div class="user-submission-value">${e.title||"Untitled"}</div>
        </div>
        ${e.artistName?`
          <div class="user-submission-field">
            <label>Artist:</label>
            <div class="user-submission-value">${e.artistName}</div>
          </div>
        `:""}
        ${e.genre?`
          <div class="user-submission-field">
            <label>Genre:</label>
            <div class="user-submission-value">${e.genre}</div>
          </div>
        `:""}
        <div class="user-submission-field">
          <label>Pattern Code:</label>
          <pre class="user-submission-code">${this.escapeHtml(t.substring(0,200))}${t.length>200?"...":""}</pre>
        </div>
      </div>
    `}createEditForm(e){let t=e.patternCode||"";const s=t.split(`
`);let r=0;for(let a=0;a<s.length;a++)if(s[a].trim().startsWith("// Pattern code:")){r=a+1,r<s.length&&s[r].trim()===""&&r++;break}return r>0&&(t=s.slice(r).join(`
`).trim()),`
      <div class="user-submission-edit-form">
        <div class="user-submission-edit-field">
          <label for="edit-title-${e.id}">Title:</label>
          <input type="text" id="edit-title-${e.id}" value="${this.escapeHtml(e.title||"")}" />
        </div>
        ${e.type==="master"?`
          <div class="user-submission-edit-field">
            <label for="edit-genre-${e.id}">Genre:</label>
            <input type="text" id="edit-genre-${e.id}" value="${this.escapeHtml(e.genre||"")}" />
          </div>
        `:""}
        <div class="user-submission-edit-field">
          <label for="edit-isPublic-${e.id}">Visibility:</label>
          <select id="edit-isPublic-${e.id}">
            <option value="true" ${e.isPublic?"selected":""}>Public</option>
            <option value="false" ${e.isPublic?"":"selected"}>Private</option>
          </select>
        </div>
        <div class="user-submission-edit-field">
          <label for="edit-code-${e.id}">Pattern Code:</label>
          <textarea id="edit-code-${e.id}" rows="8" class="user-submission-code-input">${this.escapeHtml(t)}</textarea>
        </div>
      </div>
    `}startEdit(e){this.currentEditingId=e,this.loadPatterns()}cancelEdit(e){this.currentEditingId=null,this.loadPatterns()}async savePattern(e){const t=this.patterns.find(y=>y.id===e);if(!t)return;const s=document.getElementById(`edit-title-${e}`),r=document.getElementById(`edit-code-${e}`),a=document.getElementById(`edit-isPublic-${e}`),i=document.getElementById(`edit-genre-${e}`);if(!s||!r||!a){alert("Error: Form elements not found");return}const o=s.value.trim();let l=r.value.trim();const c=a.value==="true",u=i?i.value.trim():null;if(!l){alert("Pattern code cannot be empty");return}const h=l.split(`
`);let d=0,m=h.length;for(let y=0;y<h.length;y++){const O=h[y].trim();if(!(O.startsWith("//")||O==="")){d=y;break}}for(let y=h.length-1;y>=d;y--){const O=h[y].trim();if(!(O===""||O.startsWith("//"))){m=y+1;break}}l=h.slice(d,m).join(`
`).trim();try{const y=this.formatPatternWithMetadata({patternCode:l,title:o,artistName:t.artistName,version:t.version,versionName:t.versionName}),O={title:o||null,patternCode:y,isPublic:c,...t.type==="master"&&u!==null?{genre:u}:{}};await gc.updatePattern(e,O),this.currentEditingId=null,await this.loadPatterns()}catch(y){console.error("Error saving pattern:",y),alert(`Error saving pattern: ${y.message||"Unknown error"}`)}}async deletePattern(e){const t=this.patterns.find(r=>r.id===e);if(!t)return;const s=t.title||"Untitled";if(confirm(`Are you sure you want to delete "${s}"? This action cannot be undone.`))try{await gc.deletePattern(e),await this.loadPatterns()}catch(r){console.error("Error deleting pattern:",r),alert(`Error deleting pattern: ${r.message||"Unknown error"}`)}}formatPatternWithMetadata({patternCode:e,title:t,artistName:s,version:r,versionName:a}){const i=[];return t&&s?i.push(`// "${t}" @by ${s}`):t&&i.push(`// "${t}"`),r&&i.push(`// @version ${r}`),s&&i.push(`// @copyright ${s}`),i.push(""),i.push(e),i.push(""),i.push("// Made with Strudesk 4000 by eKommissar."),i.join(`
`)}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}showModal(){this.modal&&(this.modal.style.display="flex",uo())}hide(){this.modal&&(this.modal.style.display="none",Bi()),this.currentEditingId=null}}class LEe{constructor(){this.modal=null,this.onSave=null,this.currentPattern=null,this.patternType=null,this.elementId=null,this.selectedUsers=[]}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="save-pattern-modal-overlay" id="save-pattern-modal-overlay" style="display: none;">
        <div class="save-pattern-modal">
          <div class="save-pattern-modal-header">
            <h2 id="save-pattern-modal-title">Save Track</h2>
            <button class="save-pattern-modal-close" id="save-pattern-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="save-pattern-modal-body">
            <form id="save-pattern-form">
              <div class="form-group">
                <label for="save-pattern-title">Track Title</label>
                <input type="text" id="save-pattern-title" placeholder="e.g., My Awesome Beat" required />
              </div>

              <div class="form-group">
                <label for="save-pattern-artist">Artist Name</label>
                <input type="text" id="save-pattern-artist" placeholder="Leave empty to use your default artist name" required />
                <small>Override your default artist name for this track</small>
              </div>

              <div class="form-group" id="save-pattern-image-group">
                <label for="save-pattern-image">Cover Image URL (optional)</label>
                <input type="url" id="save-pattern-image" placeholder="https://example.com/cover.jpg" />
                <small>Shown in the Top Tracks section when shared</small>
              </div>

              <div class="form-group">
                <label for="save-pattern-version-name">Version Name (optional)</label>
                <input type="text" id="save-pattern-version-name" placeholder="e.g., Remix, Live, Studio" />
                <small>Add a label to this version (version number is automatic)</small>
              </div>

              <div class="form-group" id="save-pattern-genre-group" style="display: none;">
                <label for="save-pattern-genre">Genre/Style (optional)</label>
                <select id="save-pattern-genre">
                  <option value="">Select a genre...</option>
                  <optgroup label="Electronic">
                    <option value="Techno">Techno</option>
                    <option value="House">House</option>
                    <option value="Trance">Trance</option>
                    <option value="Dubstep">Dubstep</option>
                    <option value="Drum & Bass">Drum & Bass</option>
                    <option value="Ambient">Ambient</option>
                    <option value="IDM">IDM</option>
                    <option value="Electro">Electro</option>
                    <option value="Synthwave">Synthwave</option>
                    <option value="Industrial">Industrial</option>
                  </optgroup>
                  <optgroup label="Hip Hop & Urban">
                    <option value="Hip Hop">Hip Hop</option>
                    <option value="Trap">Trap</option>
                    <option value="R&B">R&B</option>
                    <option value="Grime">Grime</option>
                    <option value="Drill">Drill</option>
                  </optgroup>
                  <optgroup label="Rock & Alternative">
                    <option value="Rock">Rock</option>
                    <option value="Alternative">Alternative</option>
                    <option value="Indie">Indie</option>
                    <option value="Punk">Punk</option>
                    <option value="Metal">Metal</option>
                    <option value="Post-Rock">Post-Rock</option>
                  </optgroup>
                  <optgroup label="Jazz & Blues">
                    <option value="Jazz">Jazz</option>
                    <option value="Blues">Blues</option>
                    <option value="Smooth Jazz">Smooth Jazz</option>
                    <option value="Bebop">Bebop</option>
                    <option value="Fusion">Fusion</option>
                  </optgroup>
                  <optgroup label="World & Folk">
                    <option value="World">World</option>
                    <option value="Folk">Folk</option>
                    <option value="Traditional">Traditional</option>
                    <option value="Ethnic">Ethnic</option>
                  </optgroup>
                  <optgroup label="Pop & Dance">
                    <option value="Pop">Pop</option>
                    <option value="Dance">Dance</option>
                    <option value="EDM">EDM</option>
                    <option value="Disco">Disco</option>
                    <option value="Funk">Funk</option>
                  </optgroup>
                  <optgroup label="Experimental">
                    <option value="Experimental">Experimental</option>
                    <option value="Noise">Noise</option>
                    <option value="Avant-garde">Avant-garde</option>
                    <option value="Minimal">Minimal</option>
                  </optgroup>
                  <optgroup label="Other">
                    <option value="Cinematic">Cinematic</option>
                    <option value="Game Music">Game Music</option>
                    <option value="Other">Other</option>
                  </optgroup>
                </select>
                <small>Select a genre to help with pattern matching and discovery</small>
              </div>

              <div class="form-group">
                <label class="privacy-toggle-label">
                  <input type="checkbox" id="save-pattern-public" />
                  <span>Make this track public</span>
                </label>
                <small>Public patterns can be seen and used by all users</small>
              </div>

              <div class="form-group" id="save-pattern-share-group" style="display: none;">
                <label>Share with specific users (optional)</label>
                <div class="user-search-container">
                  <input type="text" id="save-pattern-user-search" placeholder="Search users by name or email..." />
                  <div class="user-search-results" id="save-pattern-user-results"></div>
                </div>
                <div class="selected-users" id="save-pattern-selected-users"></div>
              </div>

              <div class="save-pattern-modal-footer">
                <button type="button" class="btn-cancel" id="save-pattern-cancel-btn">Cancel</button>
                <button type="submit" class="btn-save" id="save-pattern-save-btn">Save Track</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("save-pattern-modal-overlay")}attachEventListeners(){const e=document.getElementById("save-pattern-modal-close");e&&e.addEventListener("click",()=>this.hide());const t=document.getElementById("save-pattern-cancel-btn");t&&t.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",o=>{o.target===this.modal&&this.hide()});const s=document.getElementById("save-pattern-form");s&&s.addEventListener("submit",async o=>{o.preventDefault(),await this.savePattern()});const r=document.getElementById("save-pattern-public"),a=document.getElementById("save-pattern-share-group");r&&a&&r.addEventListener("change",o=>{o.target.checked?(a.style.display="none",this.selectedUsers=[],this.updateSelectedUsers()):a.style.display="block"});const i=document.getElementById("save-pattern-user-search");if(i){let o;i.addEventListener("input",l=>{clearTimeout(o);const c=l.target.value.trim();c.length>=2?o=setTimeout(()=>this.searchUsers(c),300):this.clearUserSearchResults()})}}async searchUsers(e){try{const{usersAPI:t}=await ds(async()=>{const{usersAPI:r}=await Promise.resolve().then(()=>dc);return{usersAPI:r}},void 0),s=await t.searchUsers(e);this.displayUserSearchResults(s)}catch(t){console.error("Error searching users:",t)}}displayUserSearchResults(e){const t=document.getElementById("save-pattern-user-results");if(t){if(e.length===0){t.innerHTML='<div class="user-search-no-results">No users found</div>';return}t.innerHTML=e.filter(s=>!this.selectedUsers.find(r=>r.id===s.id)).map(s=>`
        <div class="user-search-result-item" data-user-id="${s.id}">
          <img src="${s.avatarUrl||""}" alt="${s.name}" class="user-search-avatar" onerror="this.style.display='none'">
          <div class="user-search-result-info">
            <div class="user-search-result-name">${s.name}</div>
            <div class="user-search-result-email">${s.email}</div>
          </div>
          <button type="button" class="user-search-add-btn">Add</button>
        </div>
      `).join(""),t.querySelectorAll(".user-search-result-item").forEach(s=>{const r=s.querySelector(".user-search-add-btn"),a=s.dataset.userId,i=e.find(o=>o.id===a);r&&i&&r.addEventListener("click",()=>{this.addUserToShare(i),s.remove()})})}}clearUserSearchResults(){const e=document.getElementById("save-pattern-user-results");e&&(e.innerHTML="")}addUserToShare(e){this.selectedUsers.find(s=>s.id===e.id)||(this.selectedUsers.push(e),this.updateSelectedUsers());const t=document.getElementById("save-pattern-user-search");t&&(t.value=""),this.clearUserSearchResults()}removeUserFromShare(e){this.selectedUsers=this.selectedUsers.filter(t=>t.id!==e),this.updateSelectedUsers()}updateSelectedUsers(){const e=document.getElementById("save-pattern-selected-users");if(e){if(this.selectedUsers.length===0){e.innerHTML="";return}e.innerHTML=this.selectedUsers.map(t=>`
      <div class="selected-user-item">
        <img src="${t.avatarUrl||""}" alt="${t.name}" class="selected-user-avatar" onerror="this.style.display='none'">
        <span class="selected-user-name">${t.name}</span>
        <button type="button" class="selected-user-remove" data-user-id="${t.id}">&times;</button>
      </div>
    `).join(""),e.querySelectorAll(".selected-user-remove").forEach(t=>{t.addEventListener("click",()=>{this.removeUserFromShare(t.dataset.userId)})})}}async show(e,t,s=null){var m,y,O,S;if(!this.modal)return;this.currentPattern=e,this.patternType=t,this.elementId=s,this.selectedUsers=[];const r=t==="master",a=document.getElementById("save-pattern-modal-title"),i=document.getElementById("save-pattern-save-btn");a&&(a.textContent=r?"Save Track":"Save Pattern"),i&&(i.textContent=r?"Save Track":"Save Pattern");const o=document.getElementById("save-pattern-title"),l=document.getElementById("save-pattern-artist"),c=document.getElementById("save-pattern-image-group"),u=document.getElementById("save-pattern-image");o&&(o.required=r,o.placeholder=r?"Enter track title":"e.g., My Awesome Beat"),l&&(l.required=r,l.placeholder=r?"Enter artist name":"Leave empty to use your default artist name"),c&&(c.style.display=r?"block":"none");const h=document.getElementById("save-pattern-genre-group");h&&(h.style.display=r?"block":"none"),(m=document.getElementById("save-pattern-title"))!=null&&m.value&&(document.getElementById("save-pattern-title").value=""),(y=document.getElementById("save-pattern-artist"))!=null&&y.value&&(document.getElementById("save-pattern-artist").value=""),(O=document.getElementById("save-pattern-version-name"))!=null&&O.value&&(document.getElementById("save-pattern-version-name").value=""),u&&(u.value="");const d=document.getElementById("save-pattern-genre");d&&(d.value=""),(S=document.getElementById("save-pattern-public"))!=null&&S.checked&&(document.getElementById("save-pattern-public").checked=!1),this.updateSelectedUsers(),this.clearUserSearchResults(),this.modal.style.display="flex",uo("save-pattern-dialog")}hide(){this.modal&&(this.modal.style.display="none",Bi("save-pattern-dialog"))}async savePattern(){var e,t,s,r,a,i;if(!this.currentPattern){alert("No pattern to save");return}try{if(!await su()){alert("Please log in to save patterns");return}const l=((e=document.getElementById("save-pattern-title"))==null?void 0:e.value.trim())||null,c=((t=document.getElementById("save-pattern-artist"))==null?void 0:t.value.trim())||null,u=((s=document.getElementById("save-pattern-version-name"))==null?void 0:s.value.trim())||null,h=((r=document.getElementById("save-pattern-genre"))==null?void 0:r.value.trim())||null,d=((a=document.getElementById("save-pattern-public"))==null?void 0:a.checked)||!1,m=((i=document.getElementById("save-pattern-image"))==null?void 0:i.value.trim())||null;if(this.patternType==="master"){if(!l){alert("Track title is required.");return}if(!c){alert("Artist name is required.");return}}let y=this.currentPattern;const O=y.split(`
`);let S=0,A=O.length;for(let I=0;I<O.length;I++)if(O[I].trim()===""&&I>0&&O[I-1].trim().startsWith("//")){S=I+1;break}for(let I=O.length-1;I>=0;I--)if(O[I].includes("Made with Strudesk 4000")){A=I;break}y=O.slice(S,A).join(`
`).trim();let F=y,j="";for(;j!==F;)j=F,F=F.replace(/\.postgain\s*\([^)]*\)/gi,"");F=F.replace(/\.pan\s*\([^)]*\)/gi,""),F=F.replace(/\.fast\s*\([^)]*\)/gi,""),F=F.replace(/\.slow\s*\([^)]*\)/gi,""),F=F.replace(/\.cpm\s*\([^)]*\)/gi,""),F=F.replace(/\.\.+/g,".").trim(),F=F.replace(/\.+$/,"").trim(),F=F.replace(/\s+\./g,".");const N={};m&&(N.imageUrl=m);const $={type:this.patternType,elementId:this.elementId,patternCode:F,title:l,artistName:c,versionName:u,genre:this.patternType==="master"?h:null,isPublic:d,metadata:Object.keys(N).length?N:void 0},L=await gc.createPattern($);!d&&this.selectedUsers.length>0&&await gc.sharePattern(L.id,this.selectedUsers.map(I=>I.id)),this.onSave&&this.onSave(L),this.hide(),alert(this.patternType==="master"?"Track saved successfully!":"Pattern saved successfully!")}catch(o){console.error("Error saving pattern:",o),alert("Failed to save pattern: "+(o.message||"Unknown error"))}}setOnSave(e){this.onSave=e}}const Og={superpiano:"piano",wood:"jazz"},Om=["sine","square","triangle","sawtooth","supersaw","pulse"],zh=["piano","supersaw","gtr","casio","jazz","metal","folkharp"],bG=Object.keys(Og),VE=[{value:"RolandTR808",label:"Roland TR-808"},{value:"RolandTR909",label:"Roland TR-909"},{value:"RolandTR707",label:"Roland TR-707"},{value:"RhythmAce",label:"Rhythm Ace"},{value:"AkaiLinn",label:"Akai Linn"},{value:"ViscoSpaceDrum",label:"Visco Space Drum"},{value:"CasioRZ1",label:"Casio RZ-1"}],Mo=new Set(VE.map(n=>n.value)),QEe=[{value:"sine",label:"Sine"},{value:"square",label:"Square"},{value:"triangle",label:"Triangle"},{value:"sawtooth",label:"Sawtooth"},{value:"supersaw",label:"Supersaw"},{value:"pulse",label:"Pulse"}],jEe=[{value:"piano",label:"Piano"},{value:"supersaw",label:"Saw Synth"},{value:"gtr",label:"Guitar"},{value:"casio",label:"Casio"},{value:"jazz",label:"Jazz"},{value:"metal",label:"Metal"},{value:"folkharp",label:"Folk Harp"}];VE.reduce((n,e)=>(n[e.value]=e.label,n),{});const yG=[{group:"Drums",options:VE},{group:"Basic Waveforms",options:QEe},{group:"Sample-based Synths",options:jEe}],VEe=new Set(yG.flatMap(n=>n.options).map(n=>n.value)),E1="vcsl:",nd=n=>{if(!n||typeof n!="string")return{rawValue:"",bankValue:"",isVcslInstrument:!1,vcslInstrument:""};if(n.startsWith(E1)){const e=n.slice(E1.length);return{rawValue:n,bankValue:"vcsl",isVcslInstrument:!0,vcslInstrument:e}}return{rawValue:n,bankValue:n,isVcslInstrument:!1,vcslInstrument:""}},Al={cutoff:{id:"cutoff",label:"Filter Cutoff (Hz)",description:"Maps the X or Y axis to the master filter cutoff frequency.",defaultMin:80,defaultMax:8e3,defaultValue:2400,unit:"Hz",step:10},resonance:{id:"resonance",label:"Filter Resonance (Q)",description:"Controls the resonance (Q) of the master filter.",defaultMin:.1,defaultMax:5,defaultValue:.8,unit:"Q",step:.1},volume:{id:"volume",label:"Master Volume",description:"Adjusts the global master volume.",defaultMin:0,defaultMax:1,defaultValue:.7,unit:"",step:.01},pan:{id:"pan",label:"Master Pan",description:"Moves the master output left or right.",defaultMin:-1,defaultMax:1,defaultValue:0,unit:"",step:.01},delayAmount:{id:"delayAmount",label:"Delay Amount",description:"Controls the amount/wet level of the delay effect.",defaultMin:0,defaultMax:1,defaultValue:0,unit:"",step:.01},delayFeedback:{id:"delayFeedback",label:"Delay Feedback",description:"Controls the feedback level of the delay effect.",defaultMin:0,defaultMax:1,defaultValue:.5,unit:"",step:.01},reverbAmount:{id:"reverbAmount",label:"Reverb Amount",description:"Controls the amount/wet level of the reverb effect.",defaultMin:0,defaultMax:5,defaultValue:0,unit:"",step:.01},reverbRoomSize:{id:"reverbRoomSize",label:"Reverb Room Size",description:"Controls the room size of the reverb effect.",defaultMin:0,defaultMax:4,defaultValue:.5,unit:"",step:.01}},ZEe=Object.values(Al),If={x:{effect:"cutoff",min:Al.cutoff.defaultMin,max:Al.cutoff.defaultMax},y:{effect:"resonance",min:Al.resonance.defaultMin,max:Al.resonance.defaultMax}},vG="strudesk_settings_v1",zEe=new Set(["animated","solid","image"]),Ch={sampleBanks:{hidden:[]},chaospad:{axes:structuredClone(If)},styling:{backgroundType:"animated",backgroundColor:"#05060a",backgroundImage:""}};let Vo=qEe();const M1=new Set;function qEe(){try{const n=typeof localStorage<"u"?localStorage.getItem(vG):null;if(!n)return structuredClone(Ch);const e=JSON.parse(n);return wG(e)}catch(n){return console.warn("⚠️ Unable to read settings from storage, using defaults:",n),structuredClone(Ch)}}function OG(){if(!(typeof localStorage>"u"))try{localStorage.setItem(vG,JSON.stringify(Vo))}catch(n){console.warn("⚠️ Unable to persist settings:",n)}}function ZE(n,e){return typeof e!="object"||e===null||Object.keys(e).forEach(t=>{const s=e[t];if(Array.isArray(s)){n[t]=Array.from(s);return}if(s&&typeof s=="object"){n[t]=ZE(n[t]?{...n[t]}:{},s);return}n[t]=s}),n}function b7(n,e){const t=e||If.x,s=n!=null&&n.effect&&Al[n.effect]?n.effect:t.effect,r=Al[s]||Al[t.effect],a=Number.isFinite(n==null?void 0:n.min)?n.min:Number.isFinite(t==null?void 0:t.min)?t.min:r.defaultMin,i=Number.isFinite(n==null?void 0:n.max)?n.max:Number.isFinite(t==null?void 0:t.max)?t.max:r.defaultMax;let o=typeof a=="number"?a:r.defaultMin,l=typeof i=="number"?i:r.defaultMax;return l<=o&&(l=o+Math.abs(r.defaultMax-r.defaultMin)||o+1),{effect:s,min:o,max:l}}function wG(n){var r,a,i,o,l,c,u;const e=ZE(structuredClone(Ch),n||{}),t=Array.isArray((r=e.sampleBanks)==null?void 0:r.hidden)?e.sampleBanks.hidden:[];e.sampleBanks.hidden=Array.from(new Set(t.filter(h=>typeof h=="string"&&VEe.has(h)))),e.chaospad.axes={x:b7((i=(a=e.chaospad)==null?void 0:a.axes)==null?void 0:i.x,If.x),y:b7((l=(o=e.chaospad)==null?void 0:o.axes)==null?void 0:l.y,If.y)};const s=(c=e.styling)==null?void 0:c.backgroundType;return zEe.has(s)||(e.styling.backgroundType=(u=e.styling)!=null&&u.disableBubbles?"solid":"animated"),e.styling.backgroundColor=e.styling.backgroundColor||Ch.styling.backgroundColor,e.styling.backgroundImage=(e.styling.backgroundImage||"").trim(),"disableBubbles"in e.styling&&delete e.styling.disableBubbles,e}function wx(){return structuredClone(Ch)}function y7(){return Vo}function qh(n={}){const e=ZE(structuredClone(Vo),n);Vo=wG(e),OG(),M1.forEach(t=>t(Vo))}function xG(n){return typeof n!="function"?()=>{}:(M1.add(n),()=>M1.delete(n))}function UEe(){Vo=structuredClone(Ch),OG(),M1.forEach(n=>n(Vo))}function Ob(n,e=Vo){var s;return n?!(((s=e==null?void 0:e.sampleBanks)==null?void 0:s.hidden)||[]).includes(n):!0}function WEe(n=Vo){var e;return structuredClone(((e=n==null?void 0:n.chaospad)==null?void 0:e.axes)||If)}function GEe(n=Vo){return structuredClone((n==null?void 0:n.styling)||Ch.styling)}function XEe(n,e){var s;if(!n)return;const t=new Set(((s=Vo.sampleBanks)==null?void 0:s.hidden)||[]);e?t.delete(n):t.add(n),qh({sampleBanks:{hidden:Array.from(t)}})}const HEe=[{value:"animated",label:"Animated bubbles"},{value:"solid",label:"Solid color"},{value:"image",label:"Background image"}];class YEe{constructor(){this.overlay=null,this.unsubscribe=null,this.isOpen=!1,this.saveStatusTimeout=null}init(){this.render(),this.attachEventListeners(),this.syncUI(y7()),this.unsubscribe=xG(e=>this.syncUI(e))}render(){if(!this.overlay){const t=`
        <div class="settings-panel-overlay" id="settings-panel-overlay" style="display: none;">
          <div class="settings-panel" role="dialog" aria-modal="true" aria-labelledby="settings-panel-title">
            <div class="settings-panel-header">
              <div>
                <h2 id="settings-panel-title">Settings</h2>
                <p>Customize how Strudesk 4000 behaves for you.</p>
              </div>
              <div class="settings-panel-actions">
                <button type="button" class="settings-link" id="settings-reset-btn" aria-label="Reset settings to defaults">Reset</button>
                <button type="button" class="settings-save-btn" id="settings-save-btn" aria-label="Save and apply settings">Save</button>
                <button type="button" class="settings-panel-close" id="settings-panel-close" aria-label="Close settings">&times;</button>
              </div>
            </div>
            <div class="settings-panel-body">
              <section class="settings-section" id="settings-sample-banks">
                <div class="settings-section-header">
                  <div>
                    <h3>Sample Bank Visibility</h3>
                    <p>Hide the banks you never use to keep dropdowns tidy.</p>
                  </div>
                </div>
                ${this.renderSampleBankControls()}
              </section>

              <section class="settings-section" id="settings-chaospad">
                <div class="settings-section-header">
                  <div>
                    <h3>Chaospad Controls</h3>
                    <p>Pick an effect for each axis and fine-tune its response.</p>
                  </div>
                </div>
                <div class="settings-chaospad-grid">
                  ${this.renderChaospadAxisControls("x","Horizontal Axis (X)")}
                  ${this.renderChaospadAxisControls("y","Vertical Axis (Y)")}
                </div>
              </section>

              <section class="settings-section" id="settings-styling">
                <div class="settings-section-header">
                  <div>
                    <h3>Page Styling</h3>
                    <p>Switch off the animated background or bring your own visuals.</p>
                  </div>
                </div>
                <div class="settings-field settings-radio-group" role="radiogroup" aria-label="Page background mode">
                  ${HEe.map(({value:s,label:r})=>`
                    <label class="settings-radio">
                      <input type="radio" name="settings-bg-mode" value="${s}">
                      <span>${r}</span>
                    </label>
                  `).join("")}
                </div>
                <div class="settings-field">
                  <label for="settings-bg-color">Solid color</label>
                  <input type="color" id="settings-bg-color" value="#05060a">
                  <small>Applied for Solid or Image modes.</small>
                </div>
                <div class="settings-field">
                  <label for="settings-bg-image">Background image URL</label>
                  <input type="url" id="settings-bg-image" placeholder="https://example.com/texture.jpg" disabled>
                  <small>Used only when “Background image” mode is active.</small>
                </div>
              </section>
            </div>
            <div class="settings-panel-footer">
              <div class="settings-save-status" id="settings-save-status">
                <span class="settings-save-icon">✓</span>
                <span class="settings-save-text">Settings saved automatically</span>
              </div>
            </div>
          </div>
        </div>
      `;document.body.insertAdjacentHTML("beforeend",t),this.overlay=document.getElementById("settings-panel-overlay")}const e=document.getElementById("user-menu-dropdown");if(e){let t=e.querySelector("#user-settings-link");if(!t){const s=document.createElement("div");s.className="user-menu-divider",t=document.createElement("button"),t.id="user-settings-link",t.type="button",t.className="user-menu-item",t.textContent="Settings";const r=e.querySelector("#user-logout-btn");s&&r?(e.insertBefore(s,r),e.insertBefore(t,r)):(e.appendChild(s),e.appendChild(t))}t&&!t.dataset.listenerAttached&&(t.addEventListener("click",()=>{this.show(),e.classList.remove("active")}),t.dataset.listenerAttached="true")}}renderSampleBankControls(){return yG.map(({group:e,options:t})=>`
      <div class="settings-fieldset">
        <div class="settings-fieldset-heading">
          <div>
            <h4>${e}</h4>
            <p>${t.length} banks</p>
          </div>
        </div>
        <div class="settings-checkbox-grid">
          ${t.map(s=>`
            <label class="settings-checkbox">
              <input type="checkbox" class="settings-bank-toggle" data-bank-value="${s.value}">
              <span>${s.label}</span>
            </label>
          `).join("")}
        </div>
      </div>
    `).join("")}renderChaospadAxisControls(e,t){const s=ZEe.map(r=>`<option value="${r.id}">${r.label}</option>`).join("");return`
      <div class="settings-chaospad-card" data-axis="${e}">
        <header>
          <h4>${t}</h4>
          <p>Drag ${e==="x"?"left ↔ right":"up ↕ down"} on Chaospad to control this.</p>
        </header>
        <label class="settings-input-label">
          Effect
          <select data-chaospad-effect="${e}" id="settings-chaospad-${e}-effect">
            ${s}
          </select>
        </label>
        <div class="settings-range-field">
          <label>
            Min
            <input type="number" data-chaospad-min="${e}" step="0.01">
          </label>
          <label>
            Max
            <input type="number" data-chaospad-max="${e}" step="0.01">
          </label>
        </div>
      </div>
    `}attachEventListeners(){if(!this.overlay)return;const e=this.overlay.querySelector("#settings-panel-close");e==null||e.addEventListener("click",()=>this.hide()),this.overlay.addEventListener("click",i=>{i.target===this.overlay&&this.hide()}),document.addEventListener("keydown",i=>{this.isOpen&&i.key==="Escape"&&this.hide()}),this.overlay.querySelectorAll(".settings-bank-toggle").forEach(i=>{i.addEventListener("change",o=>{const l=o.target.dataset.bankValue;XEe(l,o.target.checked),this.showSaveStatus()})}),this.overlay.querySelectorAll("[data-chaospad-effect]").forEach(i=>{i.addEventListener("change",o=>{const l=o.target.dataset.chaospadEffect,c=o.target.value,u=Al[c];qh({chaospad:{axes:{[l]:{effect:c,min:(u==null?void 0:u.defaultMin)??0,max:(u==null?void 0:u.defaultMax)??1}}}}),this.showSaveStatus()})}),this.overlay.querySelectorAll("[data-chaospad-min]").forEach(i=>{i.addEventListener("change",o=>{this.handleChaospadRangeChange(o,"min"),this.showSaveStatus()})}),this.overlay.querySelectorAll("[data-chaospad-max]").forEach(i=>{i.addEventListener("change",o=>{this.handleChaospadRangeChange(o,"max"),this.showSaveStatus()})}),this.overlay.querySelectorAll('input[name="settings-bg-mode"]').forEach(i=>{i.addEventListener("change",o=>{o.target.checked&&(qh({styling:{backgroundType:o.target.value}}),this.showSaveStatus())})});const t=this.overlay.querySelector("#settings-bg-color");t==null||t.addEventListener("input",i=>{qh({styling:{backgroundColor:i.target.value||wx().styling.backgroundColor}}),this.showSaveStatus()});const s=this.overlay.querySelector("#settings-bg-image");s==null||s.addEventListener("change",i=>{qh({styling:{backgroundImage:(i.target.value||"").trim()}}),this.showSaveStatus()});const r=this.overlay.querySelector("#settings-reset-btn");r==null||r.addEventListener("click",()=>{UEe(),this.showSaveStatus(),this.applySettings()});const a=this.overlay.querySelector("#settings-save-btn");a==null||a.addEventListener("click",()=>{this.applySettings(),this.showSaveStatus()})}handleChaospadRangeChange(e,t){var l,c;const s=e.target.dataset[`chaospad${t==="min"?"Min":"Max"}`],r=parseFloat(e.target.value);if(!s||Number.isNaN(r))return;const a=y7(),o={...((c=(l=a==null?void 0:a.chaospad)==null?void 0:l.axes)==null?void 0:c[s])||{},[t]:r};t==="min"&&o.max!==void 0&&r>o.max&&(o.max=r),t==="max"&&o.min!==void 0&&r<o.min&&(o.min=r),qh({chaospad:{axes:{[s]:o}}})}syncUI(e){var o;if(!this.overlay)return;const t=new Set(((o=e==null?void 0:e.sampleBanks)==null?void 0:o.hidden)||[]);this.overlay.querySelectorAll(".settings-bank-toggle").forEach(l=>{const c=l.dataset.bankValue;l.checked=!t.has(c)}),["x","y"].forEach(l=>{var m,y;const c=(y=(m=e==null?void 0:e.chaospad)==null?void 0:m.axes)==null?void 0:y[l];if(!c)return;const u=this.overlay.querySelector(`[data-chaospad-effect="${l}"]`),h=this.overlay.querySelector(`[data-chaospad-min="${l}"]`),d=this.overlay.querySelector(`[data-chaospad-max="${l}"]`);u&&(u.value=c.effect),h&&(h.value=c.min),d&&(d.value=c.max),this.updateChaospadAxisInputs(l,c)});const s=(e==null?void 0:e.styling)||wx().styling,r=this.overlay.querySelector(`input[name="settings-bg-mode"][value="${s.backgroundType}"]`);r&&!r.checked&&(r.checked=!0);const a=this.overlay.querySelector("#settings-bg-color");a&&(a.value=s.backgroundColor||wx().styling.backgroundColor);const i=this.overlay.querySelector("#settings-bg-image");i&&(i.value=s.backgroundImage||"",i.disabled=s.backgroundType!=="image"),a.disabled=s.backgroundType==="animated"}updateChaospadAxisInputs(e,t){var i,o;const s=Al[t.effect],r=(i=this.overlay)==null?void 0:i.querySelector(`[data-chaospad-min="${e}"]`),a=(o=this.overlay)==null?void 0:o.querySelector(`[data-chaospad-max="${e}"]`);r&&s&&(r.step=s.step??r.step,r.placeholder=s.defaultMin),a&&s&&(a.step=s.step??a.step,a.placeholder=s.defaultMax)}show(){!this.overlay||this.isOpen||(this.overlay.style.display="flex",uo("settings-panel"),this.isOpen=!0)}hide(){!this.overlay||!this.isOpen||(this.overlay.style.display="none",Bi("settings-panel"),this.isOpen=!1)}applySettings(){typeof window<"u"&&window.dispatchEvent(new CustomEvent("settings-apply-requested"))}showSaveStatus(){var t;const e=(t=this.overlay)==null?void 0:t.querySelector("#settings-save-status");e&&(this.saveStatusTimeout&&clearTimeout(this.saveStatusTimeout),e.classList.add("settings-save-status--saved"),e.querySelector(".settings-save-text").textContent="Saved!",this.saveStatusTimeout=setTimeout(()=>{e.classList.remove("settings-save-status--saved"),e.querySelector(".settings-save-text").textContent="Settings saved automatically"},2e3))}destroy(){this.saveStatusTimeout&&(clearTimeout(this.saveStatusTimeout),this.saveStatusTimeout=null),this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null),this.overlay&&(this.overlay.remove(),this.overlay=null)}}class KEe{constructor(){this.modal=null,this.user=null,this.onComplete=null}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="profile-onboarding-overlay" id="profile-onboarding-overlay" style="display: none;">
        <div class="profile-onboarding-modal">
          <div class="profile-onboarding-header">
            <h2>Welcome! Let's complete your profile</h2>
            <p>Tell the community who you are. These details appear on your shared patterns.</p>
          </div>
          <form id="profile-onboarding-form" class="profile-onboarding-form">
            <div class="form-group">
              <label for="onboarding-name">Display Name</label>
              <input type="text" id="onboarding-name" placeholder="Your full name" required />
            </div>
            <div class="form-group">
              <label for="onboarding-artist">Artist / Producer Name</label>
              <input type="text" id="onboarding-artist" placeholder="e.g., Neon Skyline" required />
              <small>This name is shown on saved patterns. You can change it later.</small>
            </div>
            <div class="form-group">
              <label for="onboarding-avatar">Profile Image URL (optional)</label>
              <input type="url" id="onboarding-avatar" placeholder="https://example.com/avatar.jpg" />
            </div>
            <div class="profile-onboarding-actions">
              <button type="submit" class="btn-save">Save & Continue</button>
            </div>
            <div class="profile-onboarding-status" id="profile-onboarding-status"></div>
          </form>
        </div>
      </div>
    `),this.modal=document.getElementById("profile-onboarding-overlay")}attachEventListeners(){const e=document.getElementById("profile-onboarding-form");e&&e.addEventListener("submit",async t=>{t.preventDefault(),await this.saveProfile()})}async saveProfile(){var a,i,o;if(!this.user)return;const e=document.getElementById("profile-onboarding-status"),t=(a=document.getElementById("onboarding-name"))==null?void 0:a.value.trim(),s=(i=document.getElementById("onboarding-artist"))==null?void 0:i.value.trim(),r=((o=document.getElementById("onboarding-avatar"))==null?void 0:o.value.trim())||null;if(!t||!s){e&&(e.textContent="Please fill in both required fields.");return}try{e&&(e.textContent="Saving...");const l=await Qo.updateUser(this.user.id,{name:t,artistName:s,avatarUrl:r,profileCompleted:!0});e&&(e.textContent="Profile updated!"),this.hide(),this.onComplete&&this.onComplete(l)}catch(l){console.error("Onboarding save error:",l),e&&(e.textContent=l.message||"Failed to save profile.")}}async show(e){if(this.user=e,this.modal){const t=document.getElementById("onboarding-name"),s=document.getElementById("onboarding-artist"),r=document.getElementById("onboarding-avatar"),a=document.getElementById("profile-onboarding-status");t&&(t.value=(e==null?void 0:e.name)||""),s&&(s.value=(e==null?void 0:e.artistName)||""),r&&(r.value=(e==null?void 0:e.avatarUrl)||""),a&&(a.textContent=""),this.modal.style.display="flex",uo("profile-onboarding-modal")}}hide(){this.modal&&(this.modal.style.display="none",Bi("profile-onboarding-modal"))}setOnComplete(e){this.onComplete=e}}class JEe{constructor(){this.modal=null,this.tableBody=null,this.statusEl=null,this.users=[]}init(){this.createModal(),this.attachEventListeners()}createModal(){document.body.insertAdjacentHTML("beforeend",`
      <div class="admin-modal-overlay" id="admin-modal-overlay" style="display:none;">
        <div class="admin-modal">
          <div class="admin-modal-header">
            <h2>User Management</h2>
            <button class="admin-modal-close" id="admin-modal-close" aria-label="Close">&times;</button>
          </div>
          <div class="admin-modal-body">
            <div class="admin-status" id="admin-status"></div>
            <div class="admin-table-wrapper">
              <table class="admin-table">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th>Created</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="admin-users-body">
                  <tr><td colspan="6">Loading users...</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    `),this.modal=document.getElementById("admin-modal-overlay"),this.tableBody=document.getElementById("admin-users-body"),this.statusEl=document.getElementById("admin-status")}attachEventListeners(){const e=document.getElementById("admin-modal-close");e&&e.addEventListener("click",()=>this.hide()),this.modal&&this.modal.addEventListener("click",t=>{t.target===this.modal&&this.hide()}),this.tableBody&&this.tableBody.addEventListener("click",async t=>{const s=t.target.closest("[data-admin-action]");if(!s)return;const r=s.dataset.adminAction,a=s.dataset.userId;a&&(r==="block"?await this.blockUser(a):r==="unblock"?await this.unblockUser(a):r==="delete"&&confirm("Delete this user and all their data?")&&await this.deleteUser(a))})}async blockUser(e){await Qo.blockUser(e),this.setStatus("User blocked"),await this.loadUsers()}async unblockUser(e){await Qo.unblockUser(e),this.setStatus("User unblocked"),await this.loadUsers()}async deleteUser(e){await Qo.deleteUser(e),this.setStatus("User deleted"),await this.loadUsers()}setStatus(e,t="info"){this.statusEl&&(this.statusEl.textContent=e,this.statusEl.dataset.statusType=t)}renderRow(e){const t=new Date(e.createdAt).toLocaleDateString(),s=e.status==="blocked";return`
      <tr>
        <td>${this.escape(e.name||"")}</td>
        <td>${this.escape(e.email)}</td>
        <td>${e.role}</td>
        <td class="status-${e.status}">${e.status}</td>
        <td>${t}</td>
        <td class="admin-actions">
          ${s?`<button data-admin-action="unblock" data-user-id="${e.id}">Unblock</button>`:`<button data-admin-action="block" data-user-id="${e.id}">Block</button>`}
          <button data-admin-action="delete" data-user-id="${e.id}" class="danger">Delete</button>
        </td>
      </tr>
    `}escape(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}async loadUsers(){if(this.tableBody){this.tableBody.innerHTML='<tr><td colspan="6">Loading users...</td></tr>';try{const e=await Qo.listAdminUsers();if(this.users=e,!e.length){this.tableBody.innerHTML='<tr><td colspan="6">No users found.</td></tr>';return}this.tableBody.innerHTML=e.map(t=>this.renderRow(t)).join("")}catch(e){console.error("Admin load users error:",e),this.tableBody.innerHTML='<tr><td colspan="6">Failed to load users.</td></tr>'}}}async show(){this.modal&&(this.modal.style.display="flex",uo("admin-user-manager"),await this.loadUsers())}hide(){this.modal&&(this.modal.style.display="none",Bi("admin-user-manager"),this.setStatus(""))}}const Il=Object.create(null);Il.open="0";Il.close="1";Il.ping="2";Il.pong="3";Il.message="4";Il.upgrade="5";Il.noop="6";const wb=Object.create(null);Object.keys(Il).forEach(n=>{wb[Il[n]]=n});const nC={type:"error",data:"parser error"},kG=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",SG=typeof ArrayBuffer=="function",CG=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,zE=({type:n,data:e},t,s)=>kG&&e instanceof Blob?t?s(e):v7(e,s):SG&&(e instanceof ArrayBuffer||CG(e))?t?s(e):v7(new Blob([e]),s):s(Il[n]+(e||"")),v7=(n,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(n)};function O7(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let xx;function eMe(n,e){if(kG&&n.data instanceof Blob)return n.data.arrayBuffer().then(O7).then(e);if(SG&&(n.data instanceof ArrayBuffer||CG(n.data)))return e(O7(n.data));zE(n,!1,t=>{xx||(xx=new TextEncoder),e(xx.encode(t))})}const w7="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wm=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<w7.length;n++)wm[w7.charCodeAt(n)]=n;const tMe=n=>{let e=n.length*.75,t=n.length,s,r=0,a,i,o,l;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const c=new ArrayBuffer(e),u=new Uint8Array(c);for(s=0;s<t;s+=4)a=wm[n.charCodeAt(s)],i=wm[n.charCodeAt(s+1)],o=wm[n.charCodeAt(s+2)],l=wm[n.charCodeAt(s+3)],u[r++]=a<<2|i>>4,u[r++]=(i&15)<<4|o>>2,u[r++]=(o&3)<<6|l&63;return c},nMe=typeof ArrayBuffer=="function",qE=(n,e)=>{if(typeof n!="string")return{type:"message",data:PG(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:sMe(n.substring(1),e)}:wb[t]?n.length>1?{type:wb[t],data:n.substring(1)}:{type:wb[t]}:nC},sMe=(n,e)=>{if(nMe){const t=tMe(n);return PG(t,e)}else return{base64:!0,data:n}},PG=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},AG="",rMe=(n,e)=>{const t=n.length,s=new Array(t);let r=0;n.forEach((a,i)=>{zE(a,!1,o=>{s[i]=o,++r===t&&e(s.join(AG))})})},aMe=(n,e)=>{const t=n.split(AG),s=[];for(let r=0;r<t.length;r++){const a=qE(t[r],e);if(s.push(a),a.type==="error")break}return s};function iMe(){return new TransformStream({transform(n,e){eMe(n,t=>{const s=t.length;let r;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);const a=new DataView(r.buffer);a.setUint8(0,126),a.setUint16(1,s)}else{r=new Uint8Array(9);const a=new DataView(r.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(s))}n.data&&typeof n.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}let kx;function C0(n){return n.reduce((e,t)=>e+t.length,0)}function P0(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let s=0;for(let r=0;r<e;r++)t[r]=n[0][s++],s===n[0].length&&(n.shift(),s=0);return n.length&&s<n[0].length&&(n[0]=n[0].slice(s)),t}function oMe(n,e){kx||(kx=new TextDecoder);const t=[];let s=0,r=-1,a=!1;return new TransformStream({transform(i,o){for(t.push(i);;){if(s===0){if(C0(t)<1)break;const l=P0(t,1);a=(l[0]&128)===128,r=l[0]&127,r<126?s=3:r===126?s=1:s=2}else if(s===1){if(C0(t)<2)break;const l=P0(t,2);r=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),s=3}else if(s===2){if(C0(t)<8)break;const l=P0(t,8),c=new DataView(l.buffer,l.byteOffset,l.length),u=c.getUint32(0);if(u>Math.pow(2,21)-1){o.enqueue(nC);break}r=u*Math.pow(2,32)+c.getUint32(4),s=3}else{if(C0(t)<r)break;const l=P0(t,r);o.enqueue(qE(a?l:kx.decode(l),e)),s=0}if(r===0||r>n){o.enqueue(nC);break}}}})}const EG=4;function yr(n){if(n)return lMe(n)}function lMe(n){for(var e in yr.prototype)n[e]=yr.prototype[e];return n}yr.prototype.on=yr.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};yr.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};yr.prototype.off=yr.prototype.removeListener=yr.prototype.removeAllListeners=yr.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var s,r=0;r<t.length;r++)if(s=t[r],s===e||s.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+n],this};yr.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,r=t.length;s<r;++s)t[s].apply(this,e)}return this};yr.prototype.emitReserved=yr.prototype.emit;yr.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};yr.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Gv=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Xi=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),cMe="arraybuffer";function MG(n,...e){return e.reduce((t,s)=>(n.hasOwnProperty(s)&&(t[s]=n[s]),t),{})}const uMe=Xi.setTimeout,hMe=Xi.clearTimeout;function Xv(n,e){e.useNativeTimers?(n.setTimeoutFn=uMe.bind(Xi),n.clearTimeoutFn=hMe.bind(Xi)):(n.setTimeoutFn=Xi.setTimeout.bind(Xi),n.clearTimeoutFn=Xi.clearTimeout.bind(Xi))}const dMe=1.33;function pMe(n){return typeof n=="string"?mMe(n):Math.ceil((n.byteLength||n.size)*dMe)}function mMe(n){let e=0,t=0;for(let s=0,r=n.length;s<r;s++)e=n.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function DG(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function fMe(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function gMe(n){let e={},t=n.split("&");for(let s=0,r=t.length;s<r;s++){let a=t[s].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class bMe extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class UE extends yr{constructor(e){super(),this.writable=!1,Xv(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new bMe(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=qE(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=fMe(e);return t.length?"?"+t:""}}class yMe extends UE{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};aMe(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,rMe(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=DG()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let TG=!1;try{TG=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const vMe=TG;function OMe(){}class wMe extends yMe{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(r,a)=>{this.onError("xhr post error",r,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}class Tl extends yr{constructor(e,t,s){super(),this.createRequest=e,Xv(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=MG(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&s.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var r;s.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=Tl.requestsCount++,Tl.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=OMe,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Tl.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Tl.requestsCount=0;Tl.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",x7);else if(typeof addEventListener=="function"){const n="onpagehide"in Xi?"pagehide":"unload";addEventListener(n,x7,!1)}}function x7(){for(let n in Tl.requests)Tl.requests.hasOwnProperty(n)&&Tl.requests[n].abort()}const xMe=(function(){const n=BG({xdomain:!1});return n&&n.responseType!==null})();class kMe extends wMe{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=xMe&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Tl(BG,this.uri(),e)}}function BG(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||vMe))return new XMLHttpRequest}catch{}if(!e)try{return new Xi[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const FG=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class SMe extends UE{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=FG?{}:MG(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;zE(s,this.supportsBinary,a=>{try{this.doWrite(s,a)}catch{}r&&Gv(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=DG()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Sx=Xi.WebSocket||Xi.MozWebSocket;class CMe extends SMe{createSocket(e,t,s){return FG?new Sx(e,t,s):t?new Sx(e,t):new Sx(e)}doWrite(e,t){this.ws.send(t)}}class PMe extends UE{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=oMe(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),r=iMe();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const a=()=>{s.read().then(({done:o,value:l})=>{o||(this.onPacket(l),a())}).catch(o=>{})};a();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],r=t===e.length-1;this._writer.write(s).then(()=>{r&&Gv(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const AMe={websocket:CMe,webtransport:PMe,polling:kMe},EMe=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,MMe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function sC(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),s=n.indexOf("]");t!=-1&&s!=-1&&(n=n.substring(0,t)+n.substring(t,s).replace(/:/g,";")+n.substring(s,n.length));let r=EMe.exec(n||""),a={},i=14;for(;i--;)a[MMe[i]]=r[i]||"";return t!=-1&&s!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=DMe(a,a.path),a.queryKey=TMe(a,a.query),a}function DMe(n,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function TMe(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,r,a){r&&(t[r]=a)}),t}const rC=typeof addEventListener=="function"&&typeof removeEventListener=="function",xb=[];rC&&addEventListener("offline",()=>{xb.forEach(n=>n())},!1);class ru extends yr{constructor(e,t){if(super(),this.binaryType=cMe,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=sC(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=sC(t.host).host);Xv(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const r=s.prototype.name;this.transports.push(r),this._transportsByName[r]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=gMe(this.opts.query)),rC&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},xb.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=EG,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&ru.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",ru.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const r=this.writeBuffer[s].data;if(r&&(t+=pMe(r)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Gv(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,r){if(typeof t=="function"&&(r=t,t=void 0),typeof s=="function"&&(r=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const a={type:e,data:t,options:s};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(ru.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),rC&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=xb.indexOf(this._offlineEventListener);s!==-1&&xb.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}ru.protocol=EG;class BMe extends ru{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;ru.priorWebsocketSuccess=!1;const r=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",h=>{if(!s)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;ru.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const d=new Error("probe error");d.transport=t.name,this.emitReserved("upgradeError",d)}}))};function a(){s||(s=!0,u(),t.close(),t=null)}const i=h=>{const d=new Error("probe error: "+h);d.transport=t.name,a(),this.emitReserved("upgradeError",d)};function o(){i("transport closed")}function l(){i("socket closed")}function c(h){t&&h.name!==t.name&&a()}const u=()=>{t.removeListener("open",r),t.removeListener("error",i),t.removeListener("close",o),this.off("close",l),this.off("upgrading",c)};t.once("open",r),t.once("error",i),t.once("close",o),this.once("close",l),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let FMe=class extends BMe{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(r=>AMe[r]).filter(r=>!!r)),super(e,s)}};function $Me(n,e="",t){let s=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),s=sC(n)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const a=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+a+":"+s.port+e,s.href=s.protocol+"://"+a+(t&&t.port===s.port?"":":"+s.port),s}const NMe=typeof ArrayBuffer=="function",_Me=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,$G=Object.prototype.toString,RMe=typeof Blob=="function"||typeof Blob<"u"&&$G.call(Blob)==="[object BlobConstructor]",IMe=typeof File=="function"||typeof File<"u"&&$G.call(File)==="[object FileConstructor]";function WE(n){return NMe&&(n instanceof ArrayBuffer||_Me(n))||RMe&&n instanceof Blob||IMe&&n instanceof File}function kb(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,s=n.length;t<s;t++)if(kb(n[t]))return!0;return!1}if(WE(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return kb(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&kb(n[t]))return!0;return!1}function LMe(n){const e=[],t=n.data,s=n;return s.data=aC(t,e),s.attachments=e.length,{packet:s,buffers:e}}function aC(n,e){if(!n)return n;if(WE(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let s=0;s<n.length;s++)t[s]=aC(n[s],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=aC(n[s],e));return t}return n}function QMe(n,e){return n.data=iC(n.data,e),delete n.attachments,n}function iC(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=iC(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=iC(n[t],e));return n}const jMe=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];var es;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(es||(es={}));class VMe{constructor(e){this.replacer=e}encode(e){return(e.type===es.EVENT||e.type===es.ACK)&&kb(e)?this.encodeAsBinary({type:e.type===es.EVENT?es.BINARY_EVENT:es.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===es.BINARY_EVENT||e.type===es.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=LMe(e),s=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(s),r}}class GE extends yr{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===es.BINARY_EVENT;s||t.type===es.BINARY_ACK?(t.type=s?es.EVENT:es.ACK,this.reconstructor=new ZMe(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(WE(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(es[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===es.BINARY_EVENT||s.type===es.BINARY_ACK){const a=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const i=e.substring(a,t);if(i!=Number(i)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(i)}if(e.charAt(t+1)==="/"){const a=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(a,t)}else s.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const a=t+1;for(;++t;){const i=e.charAt(t);if(i==null||Number(i)!=i){--t;break}if(t===e.length)break}s.id=Number(e.substring(a,t+1))}if(e.charAt(++t)){const a=this.tryParse(e.substr(t));if(GE.isPayloadValid(s.type,a))s.data=a;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case es.CONNECT:return k7(t);case es.DISCONNECT:return t===void 0;case es.CONNECT_ERROR:return typeof t=="string"||k7(t);case es.EVENT:case es.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&jMe.indexOf(t[0])===-1);case es.ACK:case es.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ZMe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=QMe(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function k7(n){return Object.prototype.toString.call(n)==="[object Object]"}const zMe=Object.freeze(Object.defineProperty({__proto__:null,Decoder:GE,Encoder:VMe,get PacketType(){return es}},Symbol.toStringTag,{value:"Module"}));function Do(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const qMe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class NG extends yr{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Do(e,"open",this.onopen.bind(this)),Do(e,"packet",this.onpacket.bind(this)),Do(e,"error",this.onerror.bind(this)),Do(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,r,a;if(qMe.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const i={type:es.EVENT,data:t};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const u=this.ids++,h=t.pop();this._registerAckCallback(u,h),i.id=u}const o=(r=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||r===void 0?void 0:r.writable,l=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!o||(l?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){var s;const r=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===e&&this.sendBuffer.splice(o,1);t.call(this,new Error("operation has timed out"))},r),i=(...o)=>{this.io.clearTimeoutFn(a),t.apply(this,o)};i.withError=!0,this.acks[e]=i}emitWithAck(e,...t){return new Promise((s,r)=>{const a=(i,o)=>i?r(i):s(o);a.withError=!0,t.push(a),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...a)=>(this._queue[0],r!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...a)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:es.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case es.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case es.EVENT:case es.BINARY_EVENT:this.onevent(e);break;case es.ACK:case es.BINARY_ACK:this.onack(e);break;case es.DISCONNECT:this.ondisconnect();break;case es.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...r){s||(s=!0,t.packet({type:es.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:es.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function Pp(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Pp.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=(Math.floor(e*10)&1)==0?n-t:n+t}return Math.min(n,this.max)|0};Pp.prototype.reset=function(){this.attempts=0};Pp.prototype.setMin=function(n){this.ms=n};Pp.prototype.setMax=function(n){this.max=n};Pp.prototype.setJitter=function(n){this.jitter=n};class oC extends yr{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Xv(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Pp({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||zMe;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new FMe(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const r=Do(t,"open",function(){s.onopen(),e&&e()}),a=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),e?e(o):this.maybeReconnectOnOpen()},i=Do(t,"error",a);if(this._timeout!==!1){const o=this._timeout,l=this.setTimeoutFn(()=>{r(),a(new Error("timeout")),t.close()},o);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(r),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Do(e,"ping",this.onping.bind(this)),Do(e,"data",this.ondata.bind(this)),Do(e,"error",this.onerror.bind(this)),Do(e,"close",this.onclose.bind(this)),Do(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Gv(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new NG(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Jp={};function Sb(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=$Me(n,e.path||"/socket.io"),s=t.source,r=t.id,a=t.path,i=Jp[r]&&a in Jp[r].nsps,o=e.forceNew||e["force new connection"]||e.multiplex===!1||i;let l;return o?l=new oC(s,e):(Jp[r]||(Jp[r]=new oC(s,e)),l=Jp[r]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(Sb,{Manager:oC,Socket:NG,io:Sb,connect:Sb});const Cx={},UMe=(Cx==null?void 0:Cx.VITE_SOCKET_URL)||window.location.origin;class WMe{constructor(){this.socket=null,this.connected=!1,this.eventHandlers=new Map,this.currentSessionId=null,this.masterUpdateQueue=[],this.masterUpdateTimer=null}ensureSocket(){return this.socket?(!this.socket.connected&&!this.socket.connecting&&this.socket.connect(),this.socket):(this.socket=Sb(UMe,{withCredentials:!0,transports:["websocket"],autoConnect:!0,timeout:8e3}),this.socket.on("connect",()=>{this.connected=!0,this.emitLocal("connect"),this.currentSessionId&&this.joinSession(this.currentSessionId).catch(()=>{})}),this.socket.on("disconnect",e=>{this.connected=!1,this.emitLocal("disconnect",{reason:e})}),this.socket.on("session:snapshot",e=>{e!=null&&e.id&&(this.currentSessionId=e.id),this.emitLocal("session:snapshot",e)}),this.socket.on("session:participant-event",e=>{this.emitLocal("session:participant-event",e)}),this.socket.on("master:updated",e=>{this.queueMasterUpdate(e)}),this.socket.on("auth:error",e=>{this.emitLocal("auth:error",e)}),this.socket.on("connect_error",e=>{this.emitLocal("error",{message:e.message})}),this.socket)}on(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Set),this.eventHandlers.get(e).add(t),()=>this.off(e,t)}off(e,t){const s=this.eventHandlers.get(e);s&&(s.delete(t),s.size===0&&this.eventHandlers.delete(e))}emitLocal(e,t){const s=this.eventHandlers.get(e);s&&s.forEach(r=>{try{r(t)}catch(a){console.error(`CollaborationClient handler error for event ${e}:`,a)}})}queueMasterUpdate(e){e&&(this.masterUpdateQueue.push(e),!this.masterUpdateTimer&&(this.masterUpdateTimer=setTimeout(()=>{const t=this.masterUpdateQueue[this.masterUpdateQueue.length-1];this.masterUpdateQueue=[],this.masterUpdateTimer=null,this.emitLocal("master:updated",t)},120)))}async joinSession(e){if(!e)throw new Error("Session identifier is required");return this.ensureSocket(),new Promise((t,s)=>{this.socket.emit("session:join",{sessionId:e},r=>{var a;r!=null&&r.success?(this.currentSessionId=((a=r.snapshot)==null?void 0:a.id)||e,r.snapshot&&this.emitLocal("session:snapshot",r.snapshot),t(r.snapshot)):s(new Error((r==null?void 0:r.error)||"Failed to join session"))})})}async leaveSession(e=this.currentSessionId){if(!(!e||!this.socket))return new Promise(t=>{this.socket.emit("session:leave",{sessionId:e},()=>{e===this.currentSessionId&&(this.currentSessionId=null),t()})})}async pushChannelDraft(e={}){const t=e.sessionId||this.currentSessionId;if(!t)throw new Error("Join a session before pushing a channel");return this.ensureSocket(),new Promise((s,r)=>{this.socket.emit("channel:update",{...e,sessionId:t},a=>{a!=null&&a.success?s():r(new Error((a==null?void 0:a.error)||"Failed to push channel"))})})}async publishChannel({channelId:e,status:t="live",sessionId:s}={}){const r=s||this.currentSessionId;if(!r||!e)throw new Error("sessionId and channelId are required");return this.ensureSocket(),new Promise((a,i)=>{this.socket.emit("channel:publish",{sessionId:r,channelId:e,status:t},o=>{o!=null&&o.success?a():i(new Error((o==null?void 0:o.error)||"Failed to publish channel"))})})}async editMaster(e,t=this.currentSessionId){if(!t)throw new Error("Join a session before editing master");return this.ensureSocket(),new Promise((s,r)=>{this.socket.emit("master:edit",{sessionId:t,masterCode:e},a=>{a!=null&&a.success?s():r(new Error((a==null?void 0:a.error)||"Failed to update master"))})})}}const lC=new WMe,Hv={modal:{mountId:"modal-theory-block",timeGroupSelector:"#modal-time-signature-group",keyGroupSelector:"#modal-key-scale-group",chordSelectors:["#modal-scale-chord-suggestions"],timeGroupClass:"form-group",timeGroupId:"modal-time-signature-group",timeSelectId:"modal-time-signature-select",keyGridClass:"form-group",keyGridId:"modal-key-scale-group",keySelectId:"modal-key-select",scaleSelectId:"modal-scale-select",scaleNotesId:"modal-scale-notes-display",keyGridStyle:"display: none;",pianoElementId:"modal-piano"},collab:{mountId:"collab-theory-block",timeGroupSelector:"#collab-time-signature-group",keyGroupSelector:".collab-key-scale-grid",chordSelectors:[".collab-chord-tools"],timeGroupClass:"form-group collab-time-signature",timeGroupId:"collab-time-signature-group",timeSelectId:"collab-channel-time-signature",keyGridClass:"collab-key-scale-grid",keyGridId:"collab-key-scale-group",keySelectId:"collab-key-select",scaleSelectId:"collab-scale-select",scaleNotesId:"collab-scale-notes-display",keyGridStyle:"",pianoElementId:"collab-piano"}},GMe=["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B"],XMe=[{value:"4/4",label:"4/4 (Common Time)",selected:!0},{value:"3/4",label:"3/4 (Waltz)"},{value:"6/8",label:"6/8"},{value:"2/4",label:"2/4 (March)"},{value:"5/4",label:"5/4"},{value:"7/8",label:"7/8"},{value:"12/8",label:"12/8"},{value:"2/2",label:"2/2 (Cut Time)"},{value:"3/8",label:"3/8"},{value:"9/8",label:"9/8"},{value:"5/8",label:"5/8"},{value:"7/4",label:"7/4"}],HMe=[{label:"Diatonic (Major Scale) Modes",options:[{value:"ionian",label:"Ionian (Major)"},{value:"dorian",label:"Dorian"},{value:"phrygian",label:"Phrygian"},{value:"lydian",label:"Lydian"},{value:"mixolydian",label:"Mixolydian"},{value:"aeolian",label:"Aeolian (Natural Minor)"},{value:"locrian",label:"Locrian"}]},{label:"Melodic Minor Modes (Jazz Melodic Minor)",options:[{value:"melodic minor",label:"Melodic Minor (Jazz Minor)"},{value:"dorian b2",label:"Dorian ♭2"},{value:"lydian augmented",label:"Lydian Augmented"},{value:"lydian dominant",label:"Lydian Dominant"},{value:"mixolydian b6",label:"Mixolydian ♭6"},{value:"locrian #2",label:"Locrian ♮2"},{value:"altered",label:"Altered Scale (Super-Locrian)"}]},{label:"Harmonic Major Modes",options:[{value:"harmonic major",label:"Harmonic Major"},{value:"dorian b5",label:"Dorian ♭5"},{value:"phrygian b4",label:"Phrygian ♭4"},{value:"lydian b3",label:"Lydian ♭3"},{value:"mixolydian b2",label:"Mixolydian ♭2"},{value:"lydian augmented #2",label:"Lydian Augmented ♯2"},{value:"locrian bb7",label:"Locrian ♭♭7"}]},{label:"Harmonic Minor Modes",options:[{value:"harmonic minor",label:"Harmonic Minor"},{value:"locrian #6",label:"Locrian ♮6"},{value:"ionian #5",label:"Ionian ♯5"},{value:"dorian #4",label:"Dorian ♯4"},{value:"phrygian dominant",label:"Phrygian Dominant"},{value:"lydian #2",label:"Lydian ♯2"},{value:"ultralocrian",label:"Ultralocrian"}]},{label:"Pentatonic Modes (Major Pentatonic)",options:[{value:"major pentatonic",label:"Major Pentatonic"},{value:"suspended pentatonic",label:"Suspended Pentatonic"},{value:"man gong",label:"Man Gong"},{value:"ritusen",label:"Ritusen"},{value:"minor pentatonic mode 5",label:"Minor Pentatonic Mode 5"}]},{label:"Pentatonic Modes (Minor Pentatonic)",options:[{value:"minor pentatonic",label:"Minor Pentatonic"},{value:"blues minor pentatonic",label:"Blues Minor (no ♭5)"},{value:"major pentatonic mode 3",label:"Major Pentatonic Mode 3"},{value:"egyptian",label:"Egyptian"},{value:"minor pentatonic mode 5",label:"Minor Pentatonic Mode 5"}]},{label:"Other Scale Systems",options:[{value:"whole tone",label:"Whole Tone"},{value:"half-whole diminished",label:"Half–Whole"},{value:"whole-half diminished",label:"Whole–Half"},{value:"minor blues",label:"Minor Blues"}]}],YMe=[{value:"i-iv-v",label:"I · IV · V"},{value:"ii-v-i",label:"ii · V · I"},{value:"lofi-walk",label:"Lo-fi walk"}],KMe=`<option value="">Select Key</option>${GMe.map(n=>`<option value="${n}">${n}</option>`).join("")}`,JMe=XMe.map(n=>`<option value="${n.value}"${n.selected?" selected":""}>${n.label}</option>`).join(""),e3e=['<option value="chromatic" selected>Chromatic</option>',HMe.map(n=>{const e=n.options.map(t=>`<option value="${t.value}">${t.label}</option>`).join("");return`<optgroup label="${n.label}">${e}</optgroup>`}).join("")].join("");function S7(n){const e=Hv[n];return e?`
    <div class="${e.timeGroupClass}" id="${e.timeGroupId}">
      <label for="${e.timeSelectId}">Time Signature:</label>
      <select id="${e.timeSelectId}" class="control-select" aria-label="Time Signature">
        ${JMe}
      </select>
    </div>
  `:""}function C7(n){const e=Hv[n];if(!e)return"";const t=e.keyGridStyle?` style="${e.keyGridStyle}"`:"";return`
    <div class="${e.keyGridClass}" id="${e.keyGridId||""}"${t}>
      <div class="form-group">
        <label for="${e.keySelectId}">Key:</label>
        <select id="${e.keySelectId}" class="control-select" aria-label="Key">
          ${KMe}
        </select>
      </div>
      <div class="form-group">
        <label for="${e.scaleSelectId}">Scale:</label>
        <select id="${e.scaleSelectId}" class="control-select" aria-label="Scale">
          ${e3e}
        </select>
        <div id="${e.scaleNotesId}" class="theory-scale-notes-hint"></div>
      </div>
    </div>
  `}function t3e(){return`
    <div class="scale-chord-suggestions" id="modal-scale-chord-suggestions" aria-live="polite">
      <div class="scale-chord-suggestions__header">
        <p id="modal-scale-chord-title">Select a key and scale to view chord progressions.</p>
        <p id="modal-scale-characteristic" class="scale-chord-suggestions__characteristic"></p>
      </div>
      <div class="scale-chord-suggestions__dropdown-wrapper">
        <label for="modal-chord-progression-select" class="scale-chord-suggestions__label">Chord Progressions:</label>
        <select id="modal-chord-progression-select" class="scale-chord-suggestions__select">
          <option value="">Select a progression...</option>
        </select>
      </div>
    </div>
  `}function n3e(){return`
    <div class="collab-chord-tools">
      <label for="collab-chord-select">Chords</label>
      <div class="collab-chord-row">
        <select id="collab-chord-select" class="control-select">
          ${['<option value="">Add a chord progression…</option>',YMe.map(e=>`<option value="${e.value}">${e.label}</option>`).join("")].join("")}
        </select>
        <label class="collab-note-mode-toggle">
          <input type="checkbox" id="collab-note-mode-toggle" />
          <span id="collab-note-mode-label">Note names</span>
        </label>
      </div>
    </div>
  `}function P7(n){const e=Hv[n];if(!e)return"";const t=e.pianoElementId||`${n}-piano`;return`
    <div class="piano-section" data-piano-section data-piano-context="${n}" data-piano-element-id="${t}" hidden>
      <div class="piano-header">
        <h3>Interactive Piano</h3>
        <div class="piano-octave-controls">
          <label>Octave:</label>
          <button class="piano-octave-btn" data-piano-octave="1">1</button>
          <button class="piano-octave-btn" data-piano-octave="2">2</button>
          <button class="piano-octave-btn active" data-piano-octave="3">3</button>
          <button class="piano-octave-btn" data-piano-octave="4">4</button>
          <button class="piano-octave-btn" data-piano-octave="5">5</button>
        </div>
      </div>
      <div class="piano-keyboard" data-piano-keys>
        <button class="piano-key white" data-note="C">C</button>
        <button class="piano-key black" data-note="C#">C#</button>
        <button class="piano-key white" data-note="D">D</button>
        <button class="piano-key black" data-note="D#">D#</button>
        <button class="piano-key white" data-note="E">E</button>
        <button class="piano-key white" data-note="F">F</button>
        <button class="piano-key black" data-note="F#">F#</button>
        <button class="piano-key white" data-note="G">G</button>
        <button class="piano-key black" data-note="G#">G#</button>
        <button class="piano-key white" data-note="A">A</button>
        <button class="piano-key black" data-note="A#">A#</button>
        <button class="piano-key white" data-note="B">B</button>
      </div>
    </div>
  `}function _G(n){if(n==="modal")return[S7(n),C7(n),t3e(),P7(n)].join(`
`);if(n==="collab")return`
      <div class="collab-theory-block">
        <div class="collab-channel-editor-tools">
          <div class="form-group collab-mode-toggle-group">
            <label>Editor mode</label>
            <div class="collab-mode-switch">
              <span class="collab-mode-label collab-mode-label--code">Code</span>
              <label class="toggle-switch collab-mode-toggle">
                <input type="checkbox" id="collab-editor-mode-toggle" aria-label="Toggle step editor" />
                <span class="toggle-slider"></span>
              </label>
              <span class="collab-mode-label collab-mode-label--step">Step</span>
            </div>
          </div>
        </div>
        ${S7(n)}
        ${C7(n)}
        ${n3e()}
        ${P7(n)}
      </div>
    `;throw new Error(`Unknown theory block context: ${n}`)}function RG(n,{showTimeSignature:e,showKeyScale:t,showPiano:s}){const r=Hv[n];if(!r)return;const a=document.querySelector(r.timeGroupSelector);a&&(a.style.display=e?"":"none");const i=document.querySelector(r.keyGroupSelector);i&&(i.style.display=t?"":"none"),Array.isArray(r.chordSelectors)&&r.chordSelectors.forEach(c=>{const u=document.querySelector(c);u&&(u.style.display=t?"":"none")});const o=r.mountId?document.getElementById(r.mountId):null,l=o==null?void 0:o.querySelector("[data-piano-section]");l&&(!!s?(l.hidden=!1,l.classList.remove("piano-section--hidden"),l.style.removeProperty("display")):(l.hidden=!0,l.classList.add("piano-section--hidden"),l.style.setProperty("display","none","important")))}const A0=3,s3e={modal:{textareaSelector:"#modal-pattern",keySelector:"#modal-key-select",scaleSelector:"#modal-scale-select",resolveNoteMode(){return"note"}},collab:{textareaSelector:"#collab-channel-code",keySelector:"#collab-key-select",scaleSelector:"#collab-scale-select",resolveNoteMode(){const n=document.getElementById("collab-note-mode-toggle");return n!=null&&n.checked?"semitone":"note"}}};function r3e(n){return!n||!n.textareaSelector?null:document.querySelector(n.textareaSelector)}function A7(n,e=""){if(!n)return e;const t=document.querySelector(n);return t&&t.value||e}function IG(n){return!n||typeof n!="string"?"C":n.trim()||"C"}function a3e(n){return!n||typeof n!="string"?"chromatic":n.trim()||"chromatic"}function i3e(n){const e=IG(n),t=oa.get(`${e}4`);return Number.isFinite(t.midi)?t.midi:60}function o3e(n,e){if(!(le!=null&&le.getScaleSemitoneSteps))return null;const t=le.getScaleSemitoneSteps(IG(n),a3e(e));return Array.isArray(t)&&t.length>0?t:null}function l3e(n,e,t,s){const r=oa.get(`${n}${e}`);if(!r||!Number.isFinite(r.midi))return null;const a=i3e(t),i=o3e(t,s),o=r.midi-a;if(!i||!i.length)return o;const l=(o%12+12)%12,c=i.indexOf(l);return c===-1?null:Math.floor((o-i[c])/12)*i.length+c}function c3e(n,e,t){const s=n||"",r=t==="n"?/\bn\s*\(\s*(["'])([\s\S]*?)\1\s*\)/:/\bnote\s*\(\s*(["'])([\s\S]*?)\1\s*\)/,a=s.match(r);if(a){const[c,u,h]=a,d=h.trim(),m=d?`${d} ${e}`:e,y=`${t}(${u}${m}${u})`,O=a.index??0;return`${s.slice(0,O)}${y}${s.slice(O+c.length)}`}const i=t==="n"?`n("${e}")`:`note("${e}")`,o=s.trimEnd();return`${o}${o?`
`:""}${i}
`}function u3e(n,e){return/\bn\s*\(/i.test(n)?"n":/\bnote\s*\(/i.test(n)?"note":e==="semitone"?"n":"note"}function h3e(n,e,t){var d;const s=s3e[n];if(!s)return!1;const r=r3e(s);if(!r)return!1;const a=A7(s.keySelector,"C"),i=A7(s.scaleSelector,"chromatic"),o=((d=s.resolveNoteMode)==null?void 0:d.call(s))==="semitone"?"semitone":"note",l=r.value||"",c=u3e(l,o);let u=`${e}${t}`;if(c==="n"){const m=l3e(e,t,a,i);if(!Number.isFinite(m))return console.warn(`⚠️ Unable to map ${e}${t} to scale degrees (key=${a}, scale=${i})`),!1;u=String(m)}const h=c3e(l,u,c);return h?(r.value=h,r.dispatchEvent(new Event("input",{bubbles:!0})),!0):!1}async function d3e(n,e,t,s){if(!n)return;if(!le.isAudioReady()&&!await le.initialize()){console.warn("⚠️ Unable to initialize audio for piano keyboard");return}if(le.audioContext&&le.audioContext.state==="suspended")try{await le.audioContext.resume(),await new Promise(i=>setTimeout(i,30))}catch(i){console.warn("⚠️ Failed to resume audio context for piano keyboard:",i)}if(!le.isAudioReady()){console.warn("⚠️ Audio context not ready for piano playback");return}const a=`note("${`${n}${e}`}").s("piano")`;try{await le.playStrudelPattern(t,a),s&&(s.classList.add("active"),setTimeout(()=>s.classList.remove("active"),150))}catch(i){console.warn("⚠️ Unable to play piano note:",i)}}function p3e(n){if(!n||n.dataset.pianoInitialized==="true")return;const e=n.querySelector("[data-piano-keys]");if(!e)return;n.dataset.pianoInitialized="true";const t=n.getAttribute("data-piano-element-id")||"piano-keys",s=n.getAttribute("data-piano-context")||"modal",r=n.querySelectorAll(".piano-octave-btn"),a=n.querySelector(".piano-octave-btn.active");let i=a?parseInt(a.dataset.pianoOctave||`${A0}`,10):A0;if(Number.isNaN(i)&&(i=A0),!a&&r.length>0){const c=r[0];c.classList.add("active");const u=parseInt(c.dataset.pianoOctave||`${A0}`,10);Number.isNaN(u)||(i=u)}const o=(c,u)=>{i=c,r.forEach(h=>h.classList.remove("active")),u&&u.classList.add("active")};r.forEach(c=>{c.addEventListener("click",()=>{const u=parseInt(c.dataset.pianoOctave,10);Number.isNaN(u)||o(u,c)})}),e.querySelectorAll(".piano-key").forEach(c=>{const u=c.dataset.note;if(!u)return;const h=d=>{d&&d.preventDefault(),h3e(s,u,i),d3e(u,i,t,c)};c.addEventListener("mousedown",h),c.addEventListener("touchstart",h,{passive:!1})})}function LG(n=document){if(!n)return;n.querySelectorAll("[data-piano-section]").forEach(p3e)}const nn={info:"info",success:"success",error:"error"},E0=[{key:"bd",label:"Kick",sample:"bd"},{key:"sd",label:"Snare",sample:"sd"},{key:"hh",label:"Hi-hat",sample:"hh"},{key:"oh",label:"Open hat",sample:"oh"},{key:"cp",label:"Clap",sample:"cp"},{key:"perc",label:"Perc",sample:"perc"}],em={"2/4":8,"3/4":12,"4/4":16,"5/4":20,"6/8":12,"7/4":28,"7/8":14,"9/8":18,"12/8":24,"2/2":16,"3/8":6,"5/8":10},M0="4/4",m3e=[{id:"i-iv-v",label:"I · IV · V",noteSnippet:'note("c4 e4 g4").slow(2) ++ note("f4 a4 c5").slow(2) ++ note("g4 b4 d5").slow(2)',semitoneSnippet:'n("0 4 7").slow(2) ++ n("5 9 12").slow(2) ++ n("7 11 14").slow(2)'},{id:"ii-v-i",label:"ii · V · I",noteSnippet:'note("d4 f4 a4").slow(2) ++ note("g3 b3 d4").slow(2) ++ note("c4 e4 g4").slow(2)',semitoneSnippet:'n("2 5 9").slow(2) ++ n("7 11 14").slow(2) ++ n("0 4 7").slow(2)'},{id:"lofi-walk",label:"Lo-fi walk",noteSnippet:'note("c4 e4 g4").stack(note("b3 d4 g4")).slow(2)',semitoneSnippet:'n("0 4 7").stack(n("11 2 7")).slow(2)'}],Nh={NOTE:"note",SEMITONE:"semitone"},E7=new Set(["live","published"]),M7=[{bg:"#fff1f2",border:"#fda4af"},{bg:"#fefce8",border:"#fcd34d"},{bg:"#ecfccb",border:"#bef264"},{bg:"#cffafe",border:"#67e8f9"},{bg:"#e0e7ff",border:"#a5b4fc"},{bg:"#fdf2f8",border:"#f9a8d4"},{bg:"#fffbeb",border:"#fcd34d"}],Px="// @meta";class f3e{constructor(e=lC){this.root=null,this.overlay=null,this.closeBtn=null,this.socketClient=e,this.currentSnapshot=null,this.currentUser=null,this.statusTimer=null,this.boundHandlers=[],this.isOpen=!1,this.pendingInvites=[],this.recentSessions=[],this.inviteSearchResults=[],this.selectedInvitees=[],this.inviteSearchTimeout=null,this.channelEditorState=this.createDefaultEditorState(),this.channelTitleAuto=!0,this.channelLastChordLabel=null,this.lineNumberElement=null,this.modeToggleSwitch=null,this.userColorAssignments=new Map,this.userColorIndex=0,this.masterPlaybackActive=!1}createDefaultEditorState(){const e=em[M0];return{mode:"code",timeSignature:M0,stepsPerBar:e,gridSelections:this.createEmptyGridSelections(e),noteMode:Nh.NOTE,bankValue:"",key:"",scale:"chromatic"}}createEmptyGridSelections(e){const t={};return E0.forEach(s=>{t[s.key]=new Array(e).fill(!1)}),t}init(){this.ensureModal(),this.root&&(this.render(),this.attachEvents(),this.bindSocketEvents(),this.updateAuthState())}ensureModal(){var e,t;this.overlay&&this.root||(document.getElementById("collab-modal-overlay")||document.body.insertAdjacentHTML("beforeend",`
        <div class="collab-modal-overlay" id="collab-modal-overlay" style="display: none;">
          <div class="collab-modal">
            <button type="button" class="collab-modal-close" id="collab-modal-close" aria-label="Close collaboration panel">&times;</button>
            <div class="collab-panel-wrapper">
              <div id="collab-panel-root"></div>
            </div>
          </div>
        </div>
      `),this.overlay=document.getElementById("collab-modal-overlay"),this.root=((e=this.overlay)==null?void 0:e.querySelector("#collab-panel-root"))||null,this.closeBtn=((t=this.overlay)==null?void 0:t.querySelector("#collab-modal-close"))||null)}show(){if(!this.currentUser){this.setStatus("Login to access live collaboration.",nn.error,2e3);return}this.ensureModal(),this.overlay&&(this.overlay.style.display="flex",uo("collab-modal"),this.isOpen=!0,this.refreshUserInvites(),this.refreshRecentSessions())}hide(){this.overlay&&(this.overlay.style.display="none",Bi("collab-modal"),this.isOpen=!1)}destroy(){this.boundHandlers.forEach(e=>e()),this.boundHandlers=[],this.overlay&&(this.overlay.remove(),this.overlay=null,this.root=null,this.closeBtn=null)}setCurrentUser(e){this.currentUser=e,this.updateAuthState(),e?(this.refreshUserInvites(),this.refreshRecentSessions(),this.renderInviteSearchResults(),this.renderSelectedInvitees()):(this.pendingInvites=[],this.recentSessions=[],this.inviteSearchResults=[],this.selectedInvitees=[],this.renderPendingInvites(),this.renderRecentSessions(),this.renderInviteSearchResults(),this.renderSelectedInvitees())}updateAuthState(){var r,a;const e=!this.currentUser,t=(r=this.root)==null?void 0:r.querySelector("[data-collab-auth-message]"),s=(a=this.root)==null?void 0:a.querySelectorAll("[data-collab-requires-auth]");s&&s.forEach(i=>{i.disabled=e}),t&&(t.style.display=e?"block":"none"),e&&this.isOpen&&this.hide()}render(){this.root.innerHTML=`
      <div class="collab-panel-header">
        <div>
          <h3>Live Collaboration</h3>
          <p id="collab-session-label">Not connected</p>
        </div>
        <div class="collab-connection-indicator" id="collab-connection-indicator" title="Socket status"></div>
      </div>
      <div class="collab-panel-body">
        <div class="collab-auth-gate" data-collab-auth-message>
          <p>Login to create or join a collaboration session.</p>
        </div>
        <div class="collab-form-row">
          <label for="collab-title-input">Session title</label>
          <div class="collab-form-controls">
            <input type="text" id="collab-title-input" placeholder="Friday night jam" data-collab-requires-auth />
            <button id="collab-create-btn" class="btn-primary" data-collab-requires-auth>Create session</button>
          </div>
        </div>
        <div class="collab-status-message" id="collab-status-message" role="status" aria-live="polite"></div>
        <section class="collab-recents-section">
          <div class="collab-list-header">
            <strong>Recent sessions</strong>
            <button id="collab-refresh-recents-btn" class="btn-link" type="button">Refresh</button>
          </div>
          <div id="collab-recents-list" class="collab-chip-list collab-empty-state">Log in to see your recent collaborations.</div>
        </section>
        <section class="collab-invites-section">
          <div class="collab-list-header">
            <strong>Invitations for you</strong>
            <button id="collab-refresh-invites-btn" class="btn-link" type="button">Refresh</button>
          </div>
          <div id="collab-my-invites" class="collab-invites-list collab-empty-state">No pending invites.</div>
        </section>
        <div class="collab-session-details" id="collab-session-details" hidden>
          <div class="collab-session-meta">
            <div><strong>Session reference:</strong> <span id="collab-share-code">—</span></div>
            <div><strong>Delay to apply:</strong>
              <input type="range" min="0" max="5000" step="50" id="collab-delay-slider" data-collab-requires-auth />
              <span id="collab-delay-value">0 ms</span>
            </div>
            <div class="collab-cpu-row">
              <span><strong>CPU avg:</strong> <span id="collab-cpu-load">n/a</span></span>
              <span><strong>Last server update:</strong> <span id="collab-cpu-updated">—</span></span>
              <span class="collab-cpu-warning" id="collab-cpu-warning"></span>
              <button id="collab-refresh-cpu-btn" class="btn-link" type="button">Refresh stats</button>
            </div>
          </div>
          <div class="collab-owner-tools" id="collab-owner-tools" hidden>
            <div class="collab-list-header">
              <strong>Invite collaborators (max 5 at a time)</strong>
            </div>
            <div class="collab-invite-search">
              <input type="text" id="collab-invite-search" placeholder="Search users by display name or email..." data-collab-requires-auth />
              <div id="collab-invite-results" class="collab-invite-results collab-empty-state">Start typing to search users.</div>
              <div id="collab-selected-invitees" class="collab-selected-invitees collab-empty-state">No users selected yet.</div>
              <small class="collab-helper-text" id="collab-selected-count">Selected 0 of 5 slots.</small>
              <div class="collab-channel-actions">
                <button id="collab-send-invite-btn" class="btn-primary" data-collab-requires-auth>Send invites</button>
              </div>
            </div>
            <small class="collab-helper-text">Selected users will receive an invite in their Live Collaboration panel.</small>
          </div>
          <div class="collab-participants">
            <div class="collab-list-header">
              <strong>Participants</strong>
              <button id="collab-leave-btn" class="btn-ghost danger" data-collab-requires-auth>Leave</button>
            </div>
            <ul id="collab-participants-list"></ul>
          </div>
          <div class="collab-channel-form">
            <div class="collab-list-header">
              <strong>Channel snippet</strong>
              <button id="collab-load-editor-btn" class="btn-link" type="button">Use master editor content</button>
            </div>
            <div class="collab-channel-config">
              <div class="collab-config-grid">
                <div class="form-group">
                  <label for="collab-pattern-bank">Sound Bank:</label>
                  <select id="collab-pattern-bank" class="control-select">
                  <optgroup label="Drums">
                    <option value="">Default</option>
                    <option value="RolandTR808">Roland TR-808</option>
                    <option value="RolandTR909">Roland TR-909</option>
                    <option value="RolandTR707">Roland TR-707</option>
                    <option value="RhythmAce">Rhythm Ace</option>
                    <option value="AkaiLinn">Akai Linn</option>
                    <option value="ViscoSpaceDrum">Visco Space Drum</option>
                    <option value="CasioRZ1">Casio RZ-1</option>
                  </optgroup>
                  <optgroup label="Basic Waveforms">
                    <option value="sine">Sine</option>
                    <option value="square">Square</option>
                    <option value="triangle">Triangle</option>
                    <option value="sawtooth">Sawtooth</option>
                  </optgroup>
                  <optgroup label="Sample-based Synths">
                    <option value="piano">Piano</option>
                    <option value="supersaw">Saw Synth</option>
                    <option value="casio">Casio</option>
                    <option value="jazz">Jazz</option>
                    <option value="metal">Metal</option>
                    <option value="folkharp">Folk Harp</option>
                  </optgroup>
                  </select>
                  <div class="pattern-help">
                    <small>Select a sound bank to load. Banks are loaded when selected.</small>
                  </div>
                </div>
                <div class="form-group">
                  <label for="collab-channel-title">Title:</label>
                  <input type="text" id="collab-channel-title" placeholder="e.g., My drum pattern" />
                </div>
              </div>
              <div id="collab-theory-block"></div>
            </div>
            <div class="collab-step-editor" id="collab-step-editor" hidden>
              <div class="collab-step-grid" id="collab-step-grid"></div>
              <p class="collab-step-hint">Click steps to toggle hits. Multi-hits create stacked samples.</p>
            </div>
            <div class="collab-channel-editor">
              <div class="pattern-label-row">
                <label for="collab-channel-code">Pattern</label>
              </div>
              <div class="collab-pattern-wrapper">
                <div class="collab-line-numbers" id="collab-line-numbers" aria-hidden="true"></div>
                <textarea id="collab-channel-code" class="collab-pattern-input" rows="6" placeholder="// Write the pattern you want to push"></textarea>
              </div>
              <div class="pattern-help">
                <small>
                  Drum sounds: https://strudel.cc/workshop/first-sounds/#drum-sounds ·
                  Synth sounds: https://strudel.cc/workshop/first-notes/#changing-the-sound
                </small>
              </div>
            </div>
            <div class="collab-channel-actions">
              <button id="collab-push-draft-btn" class="btn-secondary collab-action-button" data-collab-requires-auth>Save draft</button>
              <button id="collab-publish-btn" class="btn-primary collab-action-button" data-collab-requires-auth>Publish to master</button>
              <button
                id="collab-play-master-btn"
                class="play-master-button collab-play-master-button"
                type="button"
                title="Play master pattern"
                aria-label="Play master pattern"
                data-collab-requires-auth
              >▶</button>
            </div>
            <div class="collab-master-display">
              <div class="collab-list-header">
                <strong>Published Master Pattern</strong>
              </div>
              <div id="collab-master-pattern" class="collab-master-pattern-field" role="region" aria-live="polite"></div>
            </div>
          </div>
          <div class="collab-channels-list">
            <div class="collab-list-header">
              <strong>Recent submissions</strong>
              <button id="collab-refresh-session-btn" class="btn-link" type="button">Refresh snapshot</button>
            </div>
            <div id="collab-channels-container"></div>
          </div>
        </div>
      </div>
    `;const e=this.root.querySelector("#collab-theory-block");e&&(e.innerHTML=_G("collab"),LG(e)),this.renderPendingInvites(),this.renderRecentSessions(),this.renderInviteSearchResults(),this.renderSelectedInvitees(),this.initializeChannelFormControls(),this.renderMasterPattern(this.currentSnapshot)}initializeChannelFormControls(){var e,t,s,r,a,i,o,l;if(this.root&&(this.channelEditorState||(this.channelEditorState=this.createDefaultEditorState()),this.channelTextarea=this.root.querySelector("#collab-channel-code"),this.lineNumberElement=this.root.querySelector("#collab-line-numbers"),this.channelTitleInput=this.root.querySelector("#collab-channel-title"),this.bankSelect=this.root.querySelector("#collab-pattern-bank"),this.timeSignatureSelect=this.root.querySelector("#collab-channel-time-signature"),this.keySelect=this.root.querySelector("#collab-key-select"),this.scaleSelect=this.root.querySelector("#collab-scale-select"),this.chordSelect=this.root.querySelector("#collab-chord-select"),this.noteToggle=this.root.querySelector("#collab-note-mode-toggle"),this.noteModeLabel=this.root.querySelector("#collab-note-mode-label"),this.channelTitleAuto=!this.channelTitleInput||this.channelTitleInput.value.trim().length===0,!!this.channelTextarea)){if(this.channelTextarea.addEventListener("input",()=>{this.channelEditorState.mode==="code"&&(this.channelEditorState.customCode=this.channelTextarea.value),this.updatePatternLineNumbers()}),this.channelTextarea.addEventListener("scroll",()=>{this.lineNumberElement&&(this.lineNumberElement.scrollTop=this.channelTextarea.scrollTop)}),(e=this.channelTitleInput)==null||e.addEventListener("input",()=>{this.handleTitleInputChange()}),(t=this.bankSelect)==null||t.addEventListener("change",c=>{this.handleBankChange(c.target.value)}),this.bankSelect&&(this.channelEditorState.bankValue=((s=this.bankSelect.value)==null?void 0:s.trim())||""),(r=this.timeSignatureSelect)==null||r.addEventListener("change",c=>{this.handleTimeSignatureChange(c.target.value)}),this.timeSignatureSelect){const c=this.timeSignatureSelect.value||M0;this.channelEditorState.timeSignature=c,this.channelEditorState.stepsPerBar=em[c]||16}(a=this.keySelect)==null||a.addEventListener("change",c=>{this.handleKeyChange(c.target.value)}),(i=this.scaleSelect)==null||i.addEventListener("change",c=>{this.handleScaleChange(c.target.value)}),this.keySelect&&(this.channelEditorState.key=this.keySelect.value||""),this.scaleSelect&&(this.channelEditorState.scale=this.scaleSelect.value||"chromatic"),(o=this.chordSelect)==null||o.addEventListener("change",c=>{this.handleChordSelection(c.target.value)}),(l=this.noteToggle)==null||l.addEventListener("change",c=>{this.handleNoteModeToggle(c.target.checked)}),this.modeToggleSwitch=this.root.querySelector("#collab-editor-mode-toggle"),this.modeToggleSwitch&&!this.modeToggleSwitch.dataset.listenerAttached&&(this.modeToggleSwitch.addEventListener("change",c=>{const u=c.target.checked?"step":"code";this.setChannelEditorMode(u)}),this.modeToggleSwitch.dataset.listenerAttached="true"),this.buildStepEditorGrid(),this.autoFillTitleFromBank(),this.updateEditorModeButtons(),this.updateEditorModeVisibility(),this.channelEditorState.mode==="step"?(this.populateGridFromCode(this.channelTextarea.value),this.syncCodeFromGrid()):this.syncCodeAnnotationsFromState(),this.handleNoteModeToggle(this.channelEditorState.noteMode===Nh.SEMITONE,{silent:!0}),this.updateTheoryBlockVisibility(),this.updatePatternLineNumbers()}}updateTheoryBlockVisibility(){var i,o,l,c;const e=((i=this.channelEditorState)==null?void 0:i.bankValue)||"",t=!!e&&Mo.has(e),s=((o=this.channelEditorState)==null?void 0:o.mode)==="step",r=(l=this.root)==null?void 0:l.querySelector(".collab-mode-toggle-group");r&&(r.style.display=t?"":"none");const a=(c=this.root)==null?void 0:c.querySelector("#collab-step-editor");a&&(a.hidden=!t||this.channelEditorState.mode!=="step"),RG("collab",{showTimeSignature:t&&s,showKeyScale:!!e&&!t,showPiano:!!e&&!t})}updatePatternLineNumbers(){if(!this.lineNumberElement||!this.channelTextarea)return;const e=this.channelTextarea.value||"",t=Math.max(e.split(`
`).length,1),s=Math.max(String(t).length,2),r=Array.from({length:t},(a,i)=>`<span>${i+1}</span>`).join("");this.lineNumberElement.innerHTML=r,this.lineNumberElement.style.minWidth=`${s*8+16}px`,this.lineNumberElement.scrollTop=this.channelTextarea.scrollTop}updateMasterPlayButton(e=le==null?void 0:le.masterActive){var s;const t=(s=this.root)==null?void 0:s.querySelector("#collab-play-master-btn");t&&(e?(t.textContent="■",t.setAttribute("aria-label","Stop master playback"),t.setAttribute("title","Stop Master"),t.classList.add("active"),this.masterPlaybackActive=!0):(t.textContent="▶",t.setAttribute("aria-label","Play master pattern"),t.setAttribute("title","Play Master"),t.classList.remove("active"),this.masterPlaybackActive=!1))}async toggleMasterPlayback(){var e,t,s,r;if(!this.currentSnapshot){this.setStatus("Join a session before playing master.",nn.error,2500);return}try{if(le.masterActive){await le.stopMasterPattern(),this.updateMasterPlayButton(!1),this.setStatus("Master playback stopped.",nn.info,2e3);return}const a=((t=(e=this.currentSnapshot)==null?void 0:e.mergedStack)==null?void 0:t.trim())||((r=(s=this.currentSnapshot)==null?void 0:s.masterCode)==null?void 0:r.trim());if(!a){this.setStatus("Nothing has been published yet.",nn.error,2500);return}await le.setMasterPatternCode(a);const i=await le.playMasterPattern();if(!(i!=null&&i.success))throw new Error((i==null?void 0:i.error)||"Failed to start master playback");this.updateMasterPlayButton(!0),this.setStatus("Master playback started.",nn.success,2e3)}catch(a){console.error("toggleMasterPlayback failed:",a),this.updateMasterPlayButton(!1),this.setStatus(a.message||"Unable to toggle master playback",nn.error,3e3)}}getSelectedBankInfo(){var i;const e=((i=this.channelEditorState)==null?void 0:i.bankValue)||"";if(!e)return null;const s=nd(e).bankValue||"";if(!s)return null;const r=s.toLowerCase(),a=Og[r]||s;return{bankValue:s,synthName:a,isDrum:Mo.has(s)}}applySelectedInstrumentToPattern(){const e=this.getChannelTextarea();if(!e)return;let t=e.value||"";if(!t.trim())return;const s=this.getSelectedBankInfo();if(s){if(s.isDrum)t.includes(".bank(")?t=t.replace(/\.bank\s*\([^)]*\)/gi,`.bank("${s.bankValue}")`):t=`${t}.bank("${s.bankValue}")`;else{const r=/\.\s*(s|sound)\s*\(\s*["'][^"']*["']\s*\)/gi;r.test(t)?t=t.replace(r,`.s("${s.synthName}")`):t=`${t}.s("${s.synthName}")`}e.value=t,this.updatePatternLineNumbers()}}handleTitleInputChange(){if(!this.channelTitleInput)return;const e=this.channelTitleInput.value||"";this.channelTitleAuto=e.trim().length===0}handleBankChange(e){const t=nd(e),s=(t==null?void 0:t.bankValue)||"",r=!!s&&Mo.has(s);this.channelEditorState.bankValue=s,this.channelEditorState.bankSelectionRaw=(t==null?void 0:t.rawValue)||"",this.channelEditorState.vcslInstrument=t!=null&&t.isVcslInstrument?t.vcslInstrument:"",this.autoFillTitleFromBank(),!r&&this.channelEditorState.mode!=="code"?(this.setChannelEditorMode("code"),this.syncCodeAnnotationsFromState()):(this.channelEditorState.mode==="step"?this.syncCodeFromGrid():this.syncCodeAnnotationsFromState(),this.updateTheoryBlockVisibility())}autoFillTitleFromBank(){var t;if(!this.channelTitleAuto||!this.channelTitleInput||!this.bankSelect)return;const e=(t=this.bankSelect.selectedOptions)==null?void 0:t[0];e&&e.textContent&&(this.channelTitleInput.value=e.textContent.trim())}handleTimeSignatureChange(e){const t=em[e]?e:M0;this.channelEditorState.timeSignature=t,this.channelEditorState.stepsPerBar=em[t]||16,this.channelEditorState.gridSelections=this.createEmptyGridSelections(this.channelEditorState.stepsPerBar),this.buildStepEditorGrid(),this.channelEditorState.mode==="step"&&this.syncCodeFromGrid()}handleKeyChange(e){this.channelEditorState.key=e||"",this.syncCodeAnnotationsFromState(),this.applySelectedInstrumentToPattern()}handleScaleChange(e){this.channelEditorState.scale=e||"",this.syncCodeAnnotationsFromState(),this.applySelectedInstrumentToPattern()}handleChordSelection(e){if(!e)return;const t=m3e.find(r=>r.id===e);if(!t)return;const s=this.channelEditorState.noteMode===Nh.SEMITONE?t.semitoneSnippet:t.noteSnippet;s&&(this.channelEditorState.mode==="step"&&this.setChannelEditorMode("code"),this.insertSnippetIntoCode(s.trim()),this.channelLastChordLabel=t.label,this.chordSelect.value="",this.syncCodeAnnotationsFromState(),this.applySelectedInstrumentToPattern())}handleNoteModeToggle(e,t={}){this.channelEditorState.noteMode=e?Nh.SEMITONE:Nh.NOTE,!t.silent&&this.channelEditorState.mode==="code"&&this.syncCodeAnnotationsFromState(),this.noteModeLabel&&(this.noteModeLabel.textContent=e?"Semitone steps":"Note names"),this.noteToggle&&(this.noteToggle.checked=e)}insertSnippetIntoCode(e){const t=this.getChannelTextarea();if(!t||!e)return;const s=t.value.trimEnd();t.value=s?`${s}
${e}
`:`${e}
`,this.updatePatternLineNumbers(),t.focus()}getChannelTextarea(){var e;return this.channelTextarea&&this.channelTextarea.isConnected?this.channelTextarea:(this.channelTextarea=((e=this.root)==null?void 0:e.querySelector("#collab-channel-code"))||null,this.channelTextarea)}setChannelEditorMode(e="code"){var s;const t=e==="step"?"step":"code";if(this.channelEditorState.mode===t){this.updateEditorModeButtons(),this.updateEditorModeVisibility();return}this.channelEditorState.mode=t,t==="step"?(this.populateGridFromCode(((s=this.getChannelTextarea())==null?void 0:s.value)||""),this.syncCodeFromGrid()):this.syncCodeAnnotationsFromState(),this.updateEditorModeButtons(),this.updateEditorModeVisibility(),this.updateTheoryBlockVisibility()}updateEditorModeButtons(){var s,r;this.modeToggleSwitch&&(this.modeToggleSwitch.checked=this.channelEditorState.mode==="step");const e=(s=this.root)==null?void 0:s.querySelector(".collab-mode-label--code"),t=(r=this.root)==null?void 0:r.querySelector(".collab-mode-label--step");e&&e.classList.toggle("active",this.channelEditorState.mode==="code"),t&&t.classList.toggle("active",this.channelEditorState.mode==="step")}updateEditorModeVisibility(){var i,o,l;const e=(i=this.root)==null?void 0:i.querySelector("#collab-step-editor"),t=(o=this.root)==null?void 0:o.querySelector("#collab-time-signature-group"),s=(l=this.root)==null?void 0:l.querySelector(".collab-channel-editor"),r=this.getChannelTextarea(),a=this.channelEditorState.mode==="step";e&&(e.hidden=!a),t&&(t.hidden=!a),r&&(r.readOnly=a,r.classList.toggle("pattern-editor-readonly",a)),s&&s.classList.toggle("collab-code-readonly",a)}buildStepEditorGrid(){var r;const e=(r=this.root)==null?void 0:r.querySelector("#collab-step-grid");if(!e)return;const t=this.channelEditorState.stepsPerBar||16,s=this.channelEditorState.gridSelections&&Object.values(this.channelEditorState.gridSelections)[0]&&Object.values(this.channelEditorState.gridSelections)[0].length===t?this.channelEditorState.gridSelections:this.createEmptyGridSelections(t);this.channelEditorState.gridSelections=s,e.innerHTML="",E0.forEach(a=>{var c;const i=document.createElement("div");i.className="collab-step-row";const o=document.createElement("span");o.className="collab-step-label",o.textContent=a.label,i.appendChild(o);const l=document.createElement("div");l.className="collab-step-cells",l.style.gridTemplateColumns=`repeat(${t}, minmax(18px, 1fr))`;for(let u=0;u<t;u+=1){const h=document.createElement("label");h.className="collab-step-cell",u%4===0&&h.classList.add("beat");const d=document.createElement("input");d.type="checkbox",d.checked=!!((c=s[a.key])!=null&&c[u]),d.addEventListener("change",()=>{this.handleStepCheckboxChange(a.key,u,d.checked)}),h.appendChild(d),l.appendChild(h)}i.appendChild(l),e.appendChild(i)})}handleStepCheckboxChange(e,t,s){this.channelEditorState.gridSelections[e]||(this.channelEditorState.gridSelections[e]=new Array(this.channelEditorState.stepsPerBar).fill(!1)),this.channelEditorState.gridSelections[e][t]=s,this.syncCodeFromGrid()}syncCodeFromGrid(){if(this.channelEditorState.mode!=="step")return;const e=this.getChannelTextarea();if(!e)return;const t=this.generatePatternFromGrid(),s=this.applyCodeAnnotations(t);e.value=s,this.updatePatternLineNumbers()}syncCodeAnnotationsFromState(){const e=this.getChannelTextarea();if(!e)return;if(this.channelEditorState.mode==="step"){this.syncCodeFromGrid();return}const s=this.collectChannelAnnotations().map(({label:o,value:l})=>`${Px} ${o}: ${l}`),a=e.value.split(`
`).filter(o=>!o.startsWith(Px)).join(`
`).trim(),i=[s.length?s.join(`
`):"",a].filter(Boolean).join(`
`);e.value=i.trim(),this.updatePatternLineNumbers()}collectChannelAnnotations(){const e=[],t=this.getSelectedBankLabel();return t&&e.push({label:"Bank",value:t}),this.channelEditorState.timeSignature&&e.push({label:"Signature",value:this.channelEditorState.timeSignature}),this.channelEditorState.key&&e.push({label:"Key",value:this.channelEditorState.key}),this.channelEditorState.scale&&e.push({label:"Scale",value:this.channelEditorState.scale}),this.channelLastChordLabel&&e.push({label:"Chords",value:this.channelLastChordLabel}),this.channelEditorState.noteMode===Nh.SEMITONE&&e.push({label:"Note mode",value:"Semitone"}),e}getSelectedBankLabel(){var t,s;if(!this.bankSelect)return"";const e=(t=this.bankSelect.selectedOptions)==null?void 0:t[0];return((s=e==null?void 0:e.textContent)==null?void 0:s.trim())||""}generatePatternFromGrid(){const e=this.channelEditorState.stepsPerBar||16,t=[];for(let r=0;r<e;r+=1){const a=[];E0.forEach(i=>{var o;(o=this.channelEditorState.gridSelections[i.key])!=null&&o[r]&&a.push(i.sample)}),a.length===0?t.push("~"):a.length===1?t.push(a[0]):t.push(`[${a.join(" ")}]`)}let s=`s("${t.join(" ")}")`;return this.channelEditorState.bankValue&&(s+=`.bank("${this.channelEditorState.bankValue}")`),s}applyCodeAnnotations(e){const t=this.collectChannelAnnotations();return t.length?`${t.map(({label:r,value:a})=>`${Px} ${r}: ${a}`).join(`
`)}
${e}`.trim():e}populateGridFromCode(e){if(!e){this.channelEditorState.gridSelections=this.createEmptyGridSelections(this.channelEditorState.stepsPerBar),this.buildStepEditorGrid();return}const t=e.match(/s\("([^"]*)"\)/i);if(!t||!t[1]){this.channelEditorState.gridSelections=this.createEmptyGridSelections(this.channelEditorState.stepsPerBar),this.buildStepEditorGrid();return}const r=t[1].split(/\s+/).filter(Boolean),a=Object.entries(em).find(([,l])=>l===r.length);a&&(this.channelEditorState.timeSignature=a[0],this.channelEditorState.stepsPerBar=a[1],this.timeSignatureSelect&&(this.timeSignatureSelect.value=a[0]));const i=this.channelEditorState.stepsPerBar,o=this.createEmptyGridSelections(i);for(let l=0;l<i;l+=1){const c=r[l];if(!c)continue;const u=this.parseTokenSamples(c);E0.forEach(h=>{o[h.key][l]=u.includes(h.sample)})}this.channelEditorState.gridSelections=o,this.buildStepEditorGrid()}parseTokenSamples(e){if(!e)return[];let t=e.trim();return!t||t==="~"?[]:((t.startsWith("[")&&t.endsWith("]")||t.startsWith("{")&&t.endsWith("}"))&&(t=t.slice(1,-1)),t=t.replace(/[,]+/g," "),t.split(/\s+/).map(s=>s.trim()).filter(Boolean))}attachEvents(){var t,s,r,a,i,o,l,c,u,h,d,m,y,O,S,A,F,j,N,$,L,I,q,ce,ee,he,H,me,Oe,Pe,De,Se,ae,Ee,Qe,Ke,ge,Ye,yt;(t=this.closeBtn)==null||t.addEventListener("click",()=>{this.hide()}),(s=this.overlay)==null||s.addEventListener("click",Xe=>{Xe.target===this.overlay&&this.hide()}),(a=(r=this.root)==null?void 0:r.querySelector("#collab-create-btn"))==null||a.addEventListener("click",()=>{this.handleCreateSession()}),(o=(i=this.root)==null?void 0:i.querySelector("#collab-leave-btn"))==null||o.addEventListener("click",()=>{this.handleLeaveSession()}),(c=(l=this.root)==null?void 0:l.querySelector("#collab-load-editor-btn"))==null||c.addEventListener("click",()=>{this.populateFromEditor()}),(h=(u=this.root)==null?void 0:u.querySelector("#collab-push-draft-btn"))==null||h.addEventListener("click",()=>{this.handleChannelSubmit("draft")}),(m=(d=this.root)==null?void 0:d.querySelector("#collab-publish-btn"))==null||m.addEventListener("click",()=>{this.handleChannelSubmit("live")}),(O=(y=this.root)==null?void 0:y.querySelector("#collab-play-master-btn"))==null||O.addEventListener("click",()=>{this.toggleMasterPlayback()}),(A=(S=this.root)==null?void 0:S.querySelector("#collab-refresh-session-btn"))==null||A.addEventListener("click",()=>{var Xe;(Xe=this.currentSnapshot)!=null&&Xe.slug&&this.fetchSnapshot(this.currentSnapshot.slug)}),(j=(F=this.root)==null?void 0:F.querySelector("#collab-refresh-cpu-btn"))==null||j.addEventListener("click",()=>{var Xe;(Xe=this.currentSnapshot)!=null&&Xe.slug&&this.fetchCpuStats(this.currentSnapshot.id||this.currentSnapshot.slug)}),($=(N=this.root)==null?void 0:N.querySelector("#collab-refresh-invites-btn"))==null||$.addEventListener("click",()=>{this.refreshUserInvites()}),(I=(L=this.root)==null?void 0:L.querySelector("#collab-refresh-recents-btn"))==null||I.addEventListener("click",()=>{this.refreshRecentSessions()}),(ce=(q=this.root)==null?void 0:q.querySelector("#collab-invite-search"))==null||ce.addEventListener("input",Xe=>{const Ge=Xe.target.value.trim();this.scheduleInviteSearch(Ge)}),(he=(ee=this.root)==null?void 0:ee.querySelector("#collab-invite-results"))==null||he.addEventListener("click",Xe=>{const Ge=Xe.target.closest("[data-add-invitee]");if(!Ge)return;const Ct=Ge.getAttribute("data-add-invitee"),Et=this.inviteSearchResults.find(gn=>gn.id===Ct);Et&&this.addInvitee(Et)}),(me=(H=this.root)==null?void 0:H.querySelector("#collab-selected-invitees"))==null||me.addEventListener("click",Xe=>{const Ge=Xe.target.closest("[data-remove-invitee]");if(!Ge)return;const Ct=Ge.getAttribute("data-remove-invitee");this.removeInvitee(Ct)}),(Pe=(Oe=this.root)==null?void 0:Oe.querySelector("#collab-send-invite-btn"))==null||Pe.addEventListener("click",()=>{this.handleSendInvite()}),(Se=(De=this.root)==null?void 0:De.querySelector("#collab-master-pattern"))==null||Se.addEventListener("click",Xe=>{const Ge=Xe.target.closest("[data-remove-master-id]");if(!Ge)return;const Ct=Ge.getAttribute("data-remove-master-id");this.handleRemoveChannelFromMaster(Ct)}),(Ee=(ae=this.root)==null?void 0:ae.querySelector("#collab-my-invites"))==null||Ee.addEventListener("click",Xe=>{const Ge=Xe.target.closest("[data-accept-invite]");if(Ge){const Et=Ge.getAttribute("data-accept-invite");Et&&this.handleRespondInvite(Et,!0);return}const Ct=Xe.target.closest("[data-decline-invite]");if(Ct){const Et=Ct.getAttribute("data-decline-invite");Et&&this.handleRespondInvite(Et,!1)}});const e=(Qe=this.root)==null?void 0:Qe.querySelector("#collab-recents-list");e&&(e.addEventListener("click",Xe=>{const Ge=Xe.target.closest("[data-remove-session-id]");if(Ge){Xe.preventDefault(),Xe.stopPropagation();const gn=Ge.getAttribute("data-remove-session-id");gn&&this.handleRecentSessionRemoval(gn);return}const Ct=Xe.target.closest("[data-collab-session-id]");if(!Ct)return;const Et=Ct.getAttribute("data-collab-session-id");Et&&this.connectToSession(Et)}),e.addEventListener("keydown",Xe=>{const Ge=Xe.target.closest("[data-collab-session-id]");if(Ge&&(Xe.key==="Enter"||Xe.key===" ")){Xe.preventDefault();const Ct=Ge.getAttribute("data-collab-session-id");Ct&&this.connectToSession(Ct)}})),(ge=(Ke=this.root)==null?void 0:Ke.querySelector("#collab-delay-slider"))==null||ge.addEventListener("input",Xe=>{const Ge=Number(Xe.target.value),Ct=this.root.querySelector("#collab-delay-value");Ct&&(Ct.textContent=`${Ge} ms`)}),(yt=(Ye=this.root)==null?void 0:Ye.querySelector("#collab-delay-slider"))==null||yt.addEventListener("change",Xe=>{var Ct;const Ge=Number(Xe.target.value);(Ct=this.currentSnapshot)!=null&&Ct.id&&ea.updateDelay(this.currentSnapshot.id,Ge).catch(Et=>{console.error("Delay update failed",Et),this.setStatus(Et.message||"Failed to update delay",nn.error)})})}bindSocketEvents(){this.boundHandlers.push(this.socketClient.on("connect",()=>{this.updateConnectionIndicator(!0)})),this.boundHandlers.push(this.socketClient.on("disconnect",()=>{this.updateConnectionIndicator(!1)})),this.boundHandlers.push(this.socketClient.on("error",e=>{this.setStatus((e==null?void 0:e.message)||"Socket error",nn.error)})),this.boundHandlers.push(this.socketClient.on("auth:error",e=>{this.setStatus((e==null?void 0:e.error)||"Authentication required",nn.error)})),this.boundHandlers.push(this.socketClient.on("session:snapshot",e=>{this.updateSnapshot(e)})),this.boundHandlers.push(this.socketClient.on("master:updated",e=>{e!=null&&e.masterCode&&(this.setStatus("Master updated across collaborators",nn.info,2e3),this.currentSnapshot?(this.currentSnapshot.masterCode=e.masterCode,this.renderMasterPattern(this.currentSnapshot,e.masterCode)):this.renderMasterPattern(null,e.masterCode))}))}updateConnectionIndicator(e){var s;const t=(s=this.root)==null?void 0:s.querySelector("#collab-connection-indicator");t&&t.classList.toggle("connected",!!e)}async handleCreateSession(){var s,r;const e=(s=this.root)==null?void 0:s.querySelector("#collab-title-input"),t=(r=e==null?void 0:e.value)==null?void 0:r.trim();if(!t){this.setStatus("Enter a session title first.",nn.error);return}try{this.setStatus("Creating session…",nn.info);const a=await ea.createSession(t);this.updateSnapshot(a),await this.socketClient.joinSession(a.id),await this.refreshRecentSessions(),this.setStatus("Session created. Share the code with your friends!",nn.success,4e3)}catch(a){console.error("Create session failed",a),this.setStatus(a.message||"Failed to create session",nn.error)}}async handleLeaveSession(){var e;if((e=this.currentSnapshot)!=null&&e.id)try{await ea.leaveSession(this.currentSnapshot.id),await this.socketClient.leaveSession(this.currentSnapshot.id),await this.clearCurrentSessionState({notify:!1,skipSocketLeave:!0}),this.setStatus("You left the session.",nn.info,2e3),await this.refreshRecentSessions()}catch(t){console.error("Leave session failed",t),this.setStatus(t.message||"Failed to leave session",nn.error)}}async clearCurrentSessionState({notify:e=!0,skipSocketLeave:t=!1}={}){var r;const s=(r=this.currentSnapshot)==null?void 0:r.id;if(s&&!t)try{await this.socketClient.leaveSession(s)}catch(a){console.warn("⚠️ Unable to leave collaboration socket:",a)}this.currentSnapshot=null,this.channelEditorState=this.createDefaultEditorState(),this.channelTitleAuto=!0,this.channelTitleInput&&(this.channelTitleInput.value=""),this.channelTextarea&&(this.channelTextarea.value="",this.updatePatternLineNumbers()),this.bankSelect&&(this.bankSelect.value=""),this.keySelect&&(this.keySelect.value=""),this.scaleSelect&&(this.scaleSelect.value="chromatic"),this.noteToggle&&(this.noteToggle.checked=!1),this.noteModeLabel&&(this.noteModeLabel.textContent="Note names"),this.channelEditorState.gridSelections=this.createEmptyGridSelections(this.channelEditorState.stepsPerBar),this.buildStepEditorGrid(),this.setChannelEditorMode("code"),this.updateTheoryBlockVisibility(),this.renderParticipants([]),this.renderChannels([]),this.renderMasterPattern(null),this.renderEmptyState(),this.updateMasterPlayButton(!1);try{le!=null&&le.stopAllSounds&&await le.stopAllSounds(),Ln==null||Ln("master-pattern","")}catch(a){console.warn("⚠️ Unable to fully reset master playback:",a)}e&&this.setStatus("Session cleared. Start a new session to collaborate.",nn.info,2500)}async handleChannelSubmit(e="draft"){var s;if(!((s=this.currentSnapshot)!=null&&s.id)){this.setStatus("Join a session first.",nn.error);return}const t=this.collectChannelFormValues();if(!t.code){this.setStatus("Write a pattern before pushing.",nn.error);return}try{this.setStatus(e==="live"?"Publishing…":"Saving draft…",nn.info),await this.socketClient.pushChannelDraft({sessionId:this.currentSnapshot.id,code:t.code,name:t.name,metadata:t.metadata,status:e}),e==="live"?this.setStatus("Published to master.",nn.success,2500):this.setStatus("Draft saved.",nn.success,2500)}catch(r){console.error("Channel submit failed",r),this.setStatus(r.message||"Failed to push channel",nn.error)}}collectChannelFormValues(){var o,l,c,u,h,d,m,y,O,S,A,F;const e=(o=this.root)==null?void 0:o.querySelector("#collab-channel-code"),t=(l=this.root)==null?void 0:l.querySelector("#collab-channel-title");((c=this.channelEditorState)==null?void 0:c.mode)==="step"&&this.syncCodeFromGrid();const s=((u=t==null?void 0:t.value)==null?void 0:u.trim())||"",r={},a=(d=(h=this.channelEditorState)==null?void 0:h.bankValue)==null?void 0:d.trim(),i=this.getSelectedBankLabel();return a&&(r.soundBank=a),i&&(r.soundBankLabel=i),(m=this.channelEditorState)!=null&&m.timeSignature&&(r.timeSignature=this.channelEditorState.timeSignature),(y=this.channelEditorState)!=null&&y.key&&(r.key=this.channelEditorState.key),(O=this.channelEditorState)!=null&&O.scale&&this.channelEditorState.scale!=="chromatic"&&(r.scale=this.channelEditorState.scale),(S=this.channelEditorState)!=null&&S.mode&&(r.editorMode=this.channelEditorState.mode),(A=this.channelEditorState)!=null&&A.noteMode&&(r.noteMode=this.channelEditorState.noteMode),this.channelLastChordLabel&&(r.chords=this.channelLastChordLabel),s&&(r.title=s),{code:((F=e==null?void 0:e.value)==null?void 0:F.trim())||"",name:s||null,metadata:Object.keys(r).length?r:void 0}}populateFromEditor(){var e,t;try{const s=In("master-pattern");if(!s){this.setStatus("Master editor is empty.",nn.error,2e3);return}const r=(e=this.root)==null?void 0:e.querySelector("#collab-channel-code");r&&(r.value=s.trim(),this.updatePatternLineNumbers(),r.focus(),((t=this.channelEditorState)==null?void 0:t.mode)==="step"?(this.populateGridFromCode(r.value),this.syncCodeFromGrid()):this.syncCodeAnnotationsFromState()),this.setStatus("Copied master editor content into snippet box.",nn.info,2e3)}catch(s){console.warn("Unable to read master editor value",s),this.setStatus("Master editor is not ready yet.",nn.error)}}async fetchSnapshot(e,{silent:t=!1}={}){try{const s=await ea.getSession(e,{refresh:!0});this.updateSnapshot(s),t||this.setStatus("Snapshot refreshed.",nn.info,2e3)}catch(s){console.error("Fetch snapshot failed",s),this.setStatus(s.message||"Failed to refresh snapshot",nn.error)}}async fetchCpuStats(e){var t,s,r;try{const a=await ea.getCpuStats(e),i=(r=(s=(t=a==null?void 0:a.cpuStats)==null?void 0:t.recentServerSamples)==null?void 0:s.slice(-1))==null?void 0:r[0];i&&(this.updateCpuStats(i),this.setStatus("CPU stats refreshed.",nn.info,2e3))}catch(a){console.error("Fetch CPU failed",a),this.setStatus(a.message||"Failed to refresh CPU stats",nn.error)}}updateSnapshot(e){var c,u,h,d,m,y,O;if(!e)return;this.currentSnapshot=e;const t=(c=this.root)==null?void 0:c.querySelector("#collab-session-details");t&&(t.hidden=!1);const s=(u=this.root)==null?void 0:u.querySelector("#collab-session-label");s&&(s.textContent=`Session: ${e.title} (${e.slug})`);const r=(h=this.root)==null?void 0:h.querySelector("#collab-share-code");r&&(r.textContent=e.slug);const a=(d=this.root)==null?void 0:d.querySelector("#collab-delay-slider"),i=(m=this.root)==null?void 0:m.querySelector("#collab-delay-value");a&&(a.value=e.applyDelayMs??0),i&&(i.textContent=`${e.applyDelayMs??0} ms`),(e.applyDelayMs??0)>0&&this.setStatus(`Master updates apply after ${e.applyDelayMs} ms to protect playback.`,nn.info,3e3);const o=(y=this.root)==null?void 0:y.querySelector("#collab-owner-tools");o&&(o.hidden=!(this.currentUser&&e.owner&&this.currentUser.id===e.owner.id)),this.renderParticipants(e.participants||[]),this.renderChannels(e.channels||[]);const l=((O=e.cpuStats)==null?void 0:O.recentServerSamples)||[];l.length&&this.updateCpuStats(l[l.length-1]),this.renderMasterPattern(e)}renderParticipants(e){var s;const t=(s=this.root)==null?void 0:s.querySelector("#collab-participants-list");if(t){if(!e.length){t.innerHTML='<li class="empty">No collaborators yet.</li>';return}t.innerHTML=e.map(r=>{var i,o;return`<li>
        <span>${((i=r.user)==null?void 0:i.artistName)||((o=r.user)==null?void 0:o.name)||"Unknown"}</span>
        <span class="role">${r.role}</span>
      </li>`}).join("")}}renderChannels(e){var r;const t=(r=this.root)==null?void 0:r.querySelector("#collab-channels-container");if(!t)return;const s=(e||[]).filter(a=>E7.has(a.status));if(!s.length){t.innerHTML='<div class="empty">Publish a channel to see it here.</div>';return}t.innerHTML=s.slice(0,5).map(a=>{var l,c;const i=a.updatedAt?new Date(a.updatedAt).toLocaleString():"",o=((l=a.user)==null?void 0:l.artistName)||((c=a.user)==null?void 0:c.name)||"anonymous";return`
        <div class="collab-channel-card">
          <div class="collab-channel-card__header">
            <span>${a.name||"Untitled channel"}</span>
            <span class="badge ${a.status}">${a.status}</span>
          </div>
          <div class="collab-channel-card__meta">
            <span>By ${o}</span>
            <span>${i}</span>
          </div>
          <pre>${a.code.slice(0,220)}${a.code.length>220?"…":""}</pre>
        </div>
      `}).join("")}renderMasterPattern(e,t=""){var a;const s=(a=this.root)==null?void 0:a.querySelector("#collab-master-pattern");if(!s)return;const r=Array.isArray(e==null?void 0:e.channels)?e.channels.filter(i=>!i||!E7.has(i.status)?!1:!!(i.code&&i.code.trim().length)):[];if(!r.length){const i=(t||(e==null?void 0:e.masterCode)||"").trim();i?s.innerHTML=`<pre>${this.escapeHtml(i)}</pre>`:s.innerHTML='<div class="collab-master-empty">No published channels yet. Publish a channel to build the master.</div>',this.updateMasterPlayButton(!1);return}s.innerHTML=r.map(i=>this.renderMasterChannelBlock(i)).join(""),this.updateMasterPlayButton(le==null?void 0:le.masterActive)}renderMasterChannelBlock(e){var h,d,m,y,O;const t=e.name||e.elementId||"Untitled channel",s=((h=e.user)==null?void 0:h.artistName)||((d=e.user)==null?void 0:d.name)||"anonymous",r=(e.code||"").trim(),i=`${`// ${t} — ${s}`}
${r}`.trim(),o=this.getUserColor(e),l=this.escapeHtml(t),u=!!this.currentUser&&(this.currentUser.id===((m=e.user)==null?void 0:m.id)||this.currentUser.id===((O=(y=this.currentSnapshot)==null?void 0:y.owner)==null?void 0:O.id))?`<button type="button" class="collab-master-block__remove" data-remove-master-id="${e.id}" aria-label="Remove ${l}">&times;</button>`:"";return`
      <div class="collab-master-block" data-master-channel-id="${e.id}" style="--author-bg:${o.bg}; --author-border:${o.border};">
        ${u}
        <div class="collab-master-block__meta">
          <span>${l}</span>
          <span>${this.escapeHtml(s)}</span>
        </div>
        <pre>${this.escapeHtml(i)}</pre>
      </div>
    `}getUserColor(e){var s,r,a;const t=((s=e==null?void 0:e.user)==null?void 0:s.id)||((r=e==null?void 0:e.user)==null?void 0:r.artistName)||((a=e==null?void 0:e.user)==null?void 0:a.name)||(e==null?void 0:e.id)||(e==null?void 0:e.elementId)||`anonymous-${(e==null?void 0:e.status)||"unknown"}`;if(!this.userColorAssignments.has(t)){const i=M7[this.userColorIndex%M7.length];this.userColorAssignments.set(t,i),this.userColorIndex+=1}return this.userColorAssignments.get(t)}escapeHtml(e=""){const t=document.createElement("div");return t.textContent=e??"",t.innerHTML}updateCpuStats(e){var a,i,o;const t=(a=this.root)==null?void 0:a.querySelector("#collab-cpu-load"),s=(i=this.root)==null?void 0:i.querySelector("#collab-cpu-updated"),r=(o=this.root)==null?void 0:o.querySelector("#collab-cpu-warning");if(t){const l=Array.isArray(e.loadAvg)?e.loadAvg[0]:e.loadAvg;t.textContent=typeof l=="number"?`${l.toFixed(2)}`:"n/a"}s&&(s.textContent=e.timestamp?new Date(e.timestamp).toLocaleTimeString():"—"),r&&(r.textContent=e.warning||"",r.style.display=e.warning?"inline-flex":"none"),e.warning&&this.setStatus(e.warning,nn.error,4e3)}async refreshUserInvites(){if(!this.currentUser){this.pendingInvites=[],this.renderPendingInvites();return}try{this.pendingInvites=await ea.getPendingInvites(),this.renderPendingInvites()}catch(e){console.error("Failed to load invites:",e),this.setStatus(e.message||"Failed to load invites",nn.error,3e3)}}renderPendingInvites(){var t;const e=(t=this.root)==null?void 0:t.querySelector("#collab-my-invites");if(e){if(!this.currentUser){e.classList.add("collab-empty-state"),e.innerHTML="Login to see your invitations.";return}if(!this.pendingInvites.length){e.classList.add("collab-empty-state"),e.innerHTML="No pending invites.";return}e.classList.remove("collab-empty-state"),e.innerHTML=this.pendingInvites.map(s=>{var o,l;const r=((o=s.inviter)==null?void 0:o.name)||"Someone",a=((l=s.session)==null?void 0:l.title)||"Untitled session",i=s.createdAt?new Date(s.createdAt).toLocaleString():"";return`
          <div class="collab-invite-card">
            <div class="collab-invite-card__details">
              <strong>${a}</strong>
              <span>Invited by ${r}</span>
              <span class="collab-invite-card__meta">${i}</span>
            </div>
            <div class="collab-invite-card__actions">
              <button class="btn-primary btn-small" data-accept-invite="${s.id}">Accept</button>
              <button class="btn-ghost btn-small" data-decline-invite="${s.id}">Decline</button>
            </div>
          </div>
        `}).join("")}}async handleRespondInvite(e,t){if(e)try{this.setStatus(t?"Accepting invite…":"Declining invite…",nn.info);const s=t?await ea.acceptInvite(e):await ea.declineInvite(e);await this.refreshUserInvites(),t&&(s!=null&&s.session)?(this.updateSnapshot(s.session),await this.socketClient.joinSession(s.session.id),await this.refreshRecentSessions(),this.setStatus("Invite accepted. Connected to session.",nn.success,3e3)):t?this.setStatus("Invite accepted.",nn.success,2e3):this.setStatus("Invite declined.",nn.info,2e3)}catch(s){console.error("Failed to respond to invite:",s),this.setStatus(s.message||"Failed to respond to invite",nn.error,3e3)}}async handleSendInvite(){var e;if(!((e=this.currentSnapshot)!=null&&e.id)){this.setStatus("Start a session before inviting collaborators.",nn.error,3e3);return}if(!this.selectedInvitees.length){this.setStatus("Select up to five users to invite.",nn.error,2500);return}try{this.setStatus("Sending invites…",nn.info);const t=this.selectedInvitees.map(s=>s.id);await ea.sendInvites(this.currentSnapshot.id,t),this.selectedInvitees=[],this.renderSelectedInvitees(),this.setStatus(`Invitations sent to ${t.length} user${t.length>1?"s":""}.`,nn.success,2500),this.refreshUserInvites()}catch(t){console.error("Failed to send invite:",t),this.setStatus(t.message||"Failed to send invite",nn.error,3e3)}}async refreshRecentSessions(){if(!this.currentUser){this.recentSessions=[],this.renderRecentSessions();return}try{this.recentSessions=await ea.listRecentSessions(),this.renderRecentSessions()}catch(e){console.error("Failed to fetch recent sessions:",e),this.setStatus(e.message||"Failed to load recent sessions",nn.error,3e3)}}renderRecentSessions(){var t;const e=(t=this.root)==null?void 0:t.querySelector("#collab-recents-list");if(e){if(!this.currentUser){e.classList.add("collab-empty-state"),e.innerHTML="Login to see your recent collaborations.";return}if(!this.recentSessions.length){e.classList.add("collab-empty-state"),e.innerHTML="No recent sessions yet.";return}e.classList.remove("collab-empty-state"),e.innerHTML=this.recentSessions.map(s=>{var o,l;const r=s.updatedAt?new Date(s.updatedAt).toLocaleString():"—",a=((o=s.owner)==null?void 0:o.id)||"",i=a&&a===((l=this.currentUser)==null?void 0:l.id)?"Delete session":"Leave session";return`
          <div class="collab-chip" data-collab-session-id="${s.id}" role="button" tabindex="0">
            <div class="collab-chip__content">
              <span>${s.title}</span>
              <span class="collab-chip__meta">${r}</span>
            </div>
            <button type="button" class="collab-chip-remove" data-remove-session-id="${s.id}" aria-label="${i}">&times;</button>
          </div>
        `}).join("")}}async handleRecentSessionRemoval(e){var a,i;if(!e||!this.currentUser)return;const t=this.recentSessions.find(o=>o.id===e),s=((a=t==null?void 0:t.owner)==null?void 0:a.id)===this.currentUser.id,r=((i=this.currentSnapshot)==null?void 0:i.id)===e;try{this.setStatus(s?"Deleting session…":"Leaving session…",nn.info),s?await ea.deleteSession(e):await ea.leaveSession(e),r&&await this.clearCurrentSessionState({notify:!1}),await this.refreshRecentSessions();const o=r?"Session cleared. Start a new session to collaborate.":s?"Session deleted.":"Removed from session.";this.setStatus(o,nn.success,2200)}catch(o){console.error("Failed to update session membership:",o),this.setStatus(o.message||"Failed to update recent session",nn.error,3e3)}}async handleRemoveChannelFromMaster(e){var t;if(!(!e||!((t=this.currentSnapshot)!=null&&t.id)))try{this.setStatus("Removing channel from master…",nn.info),await ea.publishChannel(this.currentSnapshot.id,e,"draft");const s=this.currentSnapshot.slug||this.currentSnapshot.id;s&&await this.fetchSnapshot(s,{silent:!0}),this.setStatus("Channel removed from master.",nn.success,2200)}catch(s){console.error("Failed to remove master channel:",s),this.setStatus(s.message||"Failed to remove channel from master",nn.error,3e3)}}scheduleInviteSearch(e){if(this.inviteSearchTimeout&&clearTimeout(this.inviteSearchTimeout),!e){this.inviteSearchResults=[],this.renderInviteSearchResults();return}this.inviteSearchTimeout=setTimeout(()=>{this.performInviteSearch(e)},250)}async performInviteSearch(e){try{const t=await Qo.listUsers(e,10);this.inviteSearchResults=t.filter(s=>{var r;return s.id!==((r=this.currentUser)==null?void 0:r.id)}),this.renderInviteSearchResults()}catch(t){console.error("Invite search failed:",t),this.inviteSearchResults=[],this.renderInviteSearchResults("Failed to search users. Try again.")}}renderInviteSearchResults(e){var s;const t=(s=this.root)==null?void 0:s.querySelector("#collab-invite-results");if(t){if(e){t.classList.add("collab-empty-state"),t.innerHTML=e;return}if(!this.inviteSearchResults.length){t.classList.add("collab-empty-state"),t.innerHTML="Start typing to search users.";return}t.classList.remove("collab-empty-state"),t.innerHTML=this.inviteSearchResults.map(r=>{var o;const a=this.selectedInvitees.some(l=>l.id===r.id)||this.selectedInvitees.length>=5,i=((o=r.artistName)==null?void 0:o.trim())||r.name||r.email||"Unnamed";return`
          <button class="collab-invite-result${a?" disabled":""}" data-add-invitee="${r.id}" ${a?"disabled":""}>
            <span>${i}</span>
            <span class="collab-invite-result__meta">${r.email||""}</span>
          </button>
        `}).join("")}}addInvitee(e){if(this.selectedInvitees.length>=5){this.setStatus("You can invite up to five users at a time.",nn.error,2500);return}this.selectedInvitees.some(t=>t.id===e.id)||(this.selectedInvitees.push(e),this.renderSelectedInvitees(),this.renderInviteSearchResults())}removeInvitee(e){this.selectedInvitees=this.selectedInvitees.filter(t=>t.id!==e),this.renderSelectedInvitees(),this.renderInviteSearchResults()}renderSelectedInvitees(){var s,r;const e=(s=this.root)==null?void 0:s.querySelector("#collab-selected-invitees"),t=(r=this.root)==null?void 0:r.querySelector("#collab-selected-count");if(t&&(t.textContent=`Selected ${this.selectedInvitees.length} of 5 slots.`),!!e){if(!this.selectedInvitees.length){e.classList.add("collab-empty-state"),e.innerHTML="No users selected yet.";return}e.classList.remove("collab-empty-state"),e.innerHTML=this.selectedInvitees.map(a=>{var o;const i=((o=a.artistName)==null?void 0:o.trim())||a.name||a.email||"Unnamed";return`
          <span class="collab-selected-invitee">
            <span>${i}</span>
            <button type="button" data-remove-invitee="${a.id}" aria-label="Remove ${i}">&times;</button>
          </span>
        `}).join("")}}async connectToSession(e){if(e)try{this.setStatus("Connecting…",nn.info);const t=await ea.joinSession(e);t&&(this.updateSnapshot(t),await this.socketClient.joinSession(e),await this.refreshRecentSessions(),this.setStatus("Connected to session.",nn.success,2500))}catch(t){console.error("Failed to connect to session:",t),this.setStatus(t.message||"Failed to connect to session",nn.error,3e3)}}renderEmptyState(){var r,a,i;const e=(r=this.root)==null?void 0:r.querySelector("#collab-session-details");e&&(e.hidden=!0);const t=(a=this.root)==null?void 0:a.querySelector("#collab-owner-tools");t&&(t.hidden=!0);const s=(i=this.root)==null?void 0:i.querySelector("#collab-session-label");s&&(s.textContent="Not connected")}setStatus(e,t=nn.info,s=0){var a;const r=(a=this.root)==null?void 0:a.querySelector("#collab-status-message");r&&(r.textContent=e,r.className=`collab-status-message ${t}`,this.statusTimer&&clearTimeout(this.statusTimer),s>0&&(this.statusTimer=setTimeout(()=>{r.textContent="",r.className="collab-status-message"},s)))}}const QG={bd:"Bass drum, Kick drum",sd:"Snare drum",rim:"Rimshot",cp:"Clap",hh:"Closed hi-hat",oh:"Open hi-hat",cr:"Crash",rd:"Ride",ht:"High tom",mt:"Medium tom",lt:"Low tom",sh:"Shakers",cb:"Cowbell",tb:"Tambourine",perc:"Other percussions",misc:"Miscellaneous samples",fx:"Effects"},g3e="https://raw.githubusercontent.com/felixroos/dough-samples/main/vcsl.json";let sh=null,Uh=null;const D7="World Instruments",T7="VCSL Instruments",B7=["Chordophones","Aerophones","Membranophones","Electrophones","Idiophones"],_h=[{value:"github:tidalcycles/uzu-drumkit",label:"Uzu Drumkit (16)",samples:16},{value:"github:yaxu/clean-breaks/main",label:"Clean Breaks Main (32)",samples:32},{value:"github:yaxu/mrid",label:"Mrid (13)",samples:13},{value:"github:Bubobubobubobubo/Dough-Amiga",label:"Dough Amiga (116)",samples:116},{value:"github:Bubobubobubobubo/Dough-Fox",label:"Dough Fox (63)",samples:63},{value:"github:Bubobubobubobubo/Dough-Amen",label:"Dough Amen (3)",samples:3},{value:"github:Bubobubobubobubo/Dough-Juj",label:"Dough Juj (1)",samples:1},{value:"github:switchangel/pad",label:"Switchangel Pad",samples:0},{value:"github:mot4i/garden",label:"Garden (13)",samples:13},{value:"github:mot4i/loom",label:"Loom",samples:0},{value:"github:heavy-lifting/a-maze",label:"A-Maze (26)",samples:26},{value:"github:eddyflux/crate",label:"Eddyflux Crate (18)",samples:18},{value:"github:ibleedicare/strudel-bank",label:"Ibleedicare Strudel Bank (2)",samples:2},{value:"github:Prof12200/strudel_repo",label:"Prof12200 Strudel Repo (6)",samples:6},{value:"github:creativenucleus/strudel-m8-168-dnb-jungle",label:"Strudel M8 168 DNB Jungle (8)",samples:8},{value:"github:tidalcycles/dirt-samples",label:"Dirt Samples",samples:218}],b3e=[".wav",".wave",".mp3",".ogg",".oga",".flac",".aif",".aiff",".m4a",".mp4",".webm"],y3e={Accept:"application/vnd.github+json"},Ax=new Map,D0=new Map,F7="strudesk_gdpr_consent_v1",Lf=(n="")=>n.replace(/^\/+|\/+$/g,""),v3e=(n="")=>{const e=n.toLowerCase();return b3e.some(t=>e.endsWith(t))},O3e=(n="")=>{if(typeof n!="string"||!n.startsWith("github:"))return null;const t=n.slice(7).split("/").filter(Boolean);if(t.length<2)return null;const s=t.shift(),r=t.shift(),a=t.length>0?t.join("/"):"";return{owner:s,repo:r,subdir:Lf(a)}},w3e=({owner:n,repo:e,branch:t,path:s})=>`https://raw.githubusercontent.com/${n}/${e}/${t}/${s}`;async function $7(n){const e=await fetch(n,{headers:y3e});if(!e.ok){let t=e.statusText;try{const s=await e.json();s!=null&&s.message&&(t=s.message)}catch{}throw new Error(`GitHub API error (${e.status}): ${t}`)}return e.json()}async function x3e(n){if(Ax.has(n))return Ax.get(n);if(D0.has(n))return D0.get(n);const e=(async()=>{const t=O3e(n);if(!t)throw new Error("Invalid sample pack format.");const{owner:s,repo:r,subdir:a}=t,i=await $7(`https://api.github.com/repos/${s}/${r}`),o=(i==null?void 0:i.default_branch)||"main",l=await $7(`https://api.github.com/repos/${s}/${r}/git/trees/${encodeURIComponent(o)}?recursive=1`);if(!(l!=null&&l.tree))throw new Error("GitHub repository tree data is unavailable.");const c=Lf(a),u=c?`${c}/`:"",h=l.tree.filter(m=>m.type==="blob"&&v3e(m.path)).map(m=>{if(c&&m.path!==c){if(!m.path.startsWith(u))return null}const y=c?m.path===c?m.path.split("/").pop()||m.path:m.path.slice(u.length):m.path,O=Lf(y);if(!O)return null;const S=O.split("/").pop()||O,A=S.replace(/\.[^/.]+$/,"");return{id:`${n}:${m.path}`,name:A,path:m.path,relativePath:O,fileName:S,rawUrl:w3e({owner:s,repo:r,branch:o,path:m.path})}}).filter(Boolean).sort((m,y)=>m.relativePath.localeCompare(y.relativePath));if(h.length===0)throw new Error("No audio files were found in this sample pack.");const d={audioNodes:h,meta:{owner:s,repo:r,branch:o,rootPath:c}};return Ax.set(n,d),d})().finally(()=>{D0.delete(n)});return D0.set(n,e),e}const cC=[{value:"mridangam",label:"Mridangam Percussion Set"}],k3e=new Set(cC.map(n=>(n.value||"").toLowerCase()).filter(Boolean)),S3e=new Set(["localhost","127.0.0.1","0.0.0.0","::1"]);typeof window<"u"&&S3e.has(window.location.hostname);const C3e=typeof window<"u"&&typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame.bind(window):n=>setTimeout(n,16),Ex=new Map;let Mx=null;const T0=(n,e)=>{n&&(Ex.set(n,e),Mx===null&&(Mx=C3e(()=>{Ex.forEach((t,s)=>{s.textContent=t}),Ex.clear(),Mx=null})))},jG=n=>n?n.replace(/[_-]+/g," ").replace(/\s+/g," ").trim().replace(/\b\w/g,e=>e.toUpperCase()):"",P3e=n=>{if(!n)return"";if(typeof n=="string")return n;if(Array.isArray(n))return typeof n[0]=="string"?n[0]:"";if(typeof n=="object"){const e=Object.values(n)[0];if(typeof e=="string")return e;if(Array.isArray(e)&&typeof e[0]=="string")return e[0]}return""},A3e=(n,e)=>{const t=(n||e||"").toLowerCase();return/(membranophone|idiophone|drum|percussion|bongo|cajon|shaker|triangle|tambourine|clave|cowbell|snare|kick|timpani|gong|cymbal)/i.test(t)?"drums":"world"},E3e=(n,e)=>{if(!n||!e)return n;try{return new URL(n,e).toString()}catch{return n}},uC=(n,e)=>{if(typeof n=="string")return E3e(n,e);if(Array.isArray(n))return n.map(t=>uC(t,e));if(n&&typeof n=="object"){const t={};return Object.entries(n).forEach(([s,r])=>{t[s]=uC(r,e)}),t}return n},M3e=n=>{if(!n||typeof n!="object")return n;const e=n._base||"",t={};return Object.entries(n).forEach(([s,r])=>{s!=="_base"&&(t[s]=uC(r,e))}),t},D3e=n=>{if(!n||typeof n!="string")return"Other";const e=n.match(/^([^/]+)/);if(!e)return"Other";try{const t=decodeURIComponent(e[1]);return t.charAt(0).toUpperCase()+t.slice(1)}catch{return e[1]}},T3e=n=>{const e=B7.indexOf(n);return e===-1?B7.length+1:e},B3e=async()=>sh||Uh||(Uh=fetch(g3e).then(async n=>{if(!n.ok)throw new Error(`Failed to load VCSL instruments: ${n.status}`);const e=await n.json();M3e(e);const s=Object.entries(e||{}).filter(([r])=>r&&r!=="_base").map(([r,a])=>{const i=P3e(a),o=D3e(i),l=A3e(i,o);return{value:r,optionValue:`${E1}${r}`,label:`VCSL · ${jG(r)}`,category:l,samplePath:i,family:o,familyOrder:T3e(o)}}).sort((r,a)=>r.familyOrder!==a.familyOrder?r.familyOrder-a.familyOrder:r.label.localeCompare(a.label));return sh=s,s}).catch(n=>(console.warn("⚠️ Unable to load VCSL instrument list:",n),sh=[],[])).finally(()=>{Uh=null}),Uh),jm={RolandTR808:"Roland TR-808",RolandTR909:"Roland TR-909",RolandTR707:"Roland TR-707",RhythmAce:"Rhythm Ace",AkaiLinn:"Akai Linn",ViscoSpaceDrum:"Visco Space Drum",CasioRZ1:"Casio RZ-1"},N7=/\b(note|n)\s*\(/i,_7=/\bn\(\s*["'][^"']*["']\s*\)/i,xi=n=>!n||typeof n!="string"?!1:(N7.lastIndex=0,N7.test(n)),Co=n=>!n||typeof n!="string"?!1:(_7.lastIndex=0,_7.test(n)),Wu=n=>{if(!n)return"Channel";const e=n.match(/element-(\d+)/i);return e&&e[1]?`Channel ${e[1]}`:n},F3e=(n,e)=>{const t=Wu(n),s=e?e.trim():"";if(!s||/^element\s*\d+$/i.test(s))return t;if(/^channel\s*\d+$/i.test(s))return s;const r=s.replace(/^channel\s*\d+\s*(–|-)\s*/i,"");return`${t} – ${r}`},Vi=(n,e)=>{const t=document.querySelector(`[data-sound-id="${n}"]`);if(!t)return;const s=t.querySelector(".element-title");s&&(s.textContent=F3e(n,e));const r=t.querySelector(".config-button");r&&(r.textContent=e&&e.trim()?e.trim():"Configure Sound")},B0=n=>n?Object.prototype.hasOwnProperty.call(jm,n)?jm[n]:n.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Za-z])(\d+)/g,"$1 $2").trim():"",R7={RolandTR808:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"cp",label:"CP",sample:"cp"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"},{key:"cb",label:"CB",sample:"cb"},{key:"sh",label:"SH",sample:"sh"}],RolandTR909:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"cp",label:"CP",sample:"cp"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],RolandTR707:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],RhythmAce:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],AkaiLinn:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],ViscoSpaceDrum:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}],CasioRZ1:[{key:"bd",label:"BD",sample:"bd"},{key:"sd",label:"SD",sample:"sd"},{key:"hh",label:"HH",sample:"hh"},{key:"oh",label:"OH",sample:"oh"},{key:"cr",label:"CR",sample:"cr"},{key:"rd",label:"RD",sample:"rd"},{key:"lt",label:"LT",sample:"lt"},{key:"mt",label:"MT",sample:"mt"},{key:"ht",label:"HT",sample:"ht"}]},$3e=[{id:"roland808-simple-bd-hh",label:"Roland 808 – Kick & Hat",bank:"RolandTR808",description:"Simple BD/HH groove shown in the step editor",pattern:'s("bd ~ hh ~ bd ~ hh ~ bd ~ hh ~ bd ~ hh ~").bank("RolandTR808")',editorBadge:"Step editor"},{id:"drum-beat-generator",label:"Beat Generator",bank:"",description:"Opens in code editor for generative BD patterns",pattern:'s("bd").bank("RolandTR808").segment(16).degradeBy(.5).ribbon(16,1)',editorBadge:"Code"},{id:"random-modifiers",label:"Random Modifiers",bank:"",description:"chooseCycles randomizes BD / HH / SD each cycle",pattern:'s(chooseCycles("bd","hh","sd")).bank("RolandTR808").fast(8)',editorBadge:"Code"},{id:"mridangam-pulse",label:"Mridangam Percussion Set",bank:"",description:"Classical tha · dhi · thom · nam motif on the mridangam bank",pattern:`"tha dhi thom nam".drop("0 -1 -2 -3").sound().bank("mridangam")

/* Available sounds: tha · dhi · dhin · thom · nam · na · ta · ka · ki · gumki · dhum · chaapu · ardha */`,editorBadge:"Code"}],VG=[{id:"independent-params",label:"Note Names and Filter Pattern",bank:"",description:"note, cutoff, gain and sound controlled independently",pattern:'note("F3 A3 C3 E3").cutoff("<500 1000 2000 [4000 8000]>").gain(.8).s("sawtooth").log()'},{id:"semitones-scale-transpose",label:"Semitones, Scale & Transpose",bank:"",description:"Transposes notes inside the scale by the number of steps",pattern:`"[-8 [2,4,6]]*2".scale('c:ionian').scaleTranspose("<0 -1 -2 -3 -4 -5 -6 -4>*2").note().s("piano")`,useNoteNames:!1},{id:"simple-arpeggios",label:"Simple Arpeggios in Semitones & Chords",bank:"",description:"Combines numeric semitones with chord progressions",pattern:'n("0 1 2 3").chord("<C Am F G>").voicing()',useNoteNames:!1},{id:"simple-backing-track",label:"Simple Backing Track",bank:"",description:"Together with layer, struct and voicings, this can be used to create a basic backing track",pattern:`"<C^7 A7b13 Dm7 G7>*2".layer(
  x => x.voicings("lefthand").struct("[~ x]*2").note(),
  x => x.rootNotes(2).note().s("sawtooth").cutoff(800)
)`},{id:"vcsl-vocal-bed",label:"VCSL World Textures",bank:"",description:"Layered Ball Whistle + Bongo textures from the VCSL set",pattern:'sound("<ballwhistle ~ bongo ~>*2").bank("vcsl").slow(2).room(.35).shape(.2)'},{id:"jazz-blues-in-f",label:"Jazz Blues in F",bank:"",description:"Classic jazz-blues progression with layered voicings and struct patterns",pattern:`(() => {
  const chords = chord(\`<

F7 Bb7 F7 [Cm7 F7]

Bb7 Bo F7 [Am7 D7]

Gm7 C7 [F7 D7] [Gm7 C7]

>\`);

  return stack(
    n("7 8 [10 9] 8").set(chords).voicing().dec(.2),
    chords.struct("- x - x").voicing().room(.5),
    n("0 - 1 -").set(chords).mode("root:g2").voicing()
  );
})()`},{id:"mini-notation-example",label:"Mini-notation Example",bank:"",description:"Layered mini-notation demo showing melody + bass progressions",pattern:`note(\`<

[e5 [b4 c5] d5 [c5 b4]]

[a4 [a4 c5] e5 [d5 c5]]

[b4 [~ c5] d5 e5]

[c5 a4 a4 ~]

[[~ d5] [~ f5] a5 [g5 f5]]

[e5 [~ c5] e5 [d5 c5]]

[b4 [b4 c5] d5 e5]

[c5 a4 a4 ~]

,

[[e2 e3]*4]

[[a2 a3]*4]

[[g#2 g#3]*2 [e2 e3]*2]

[a2 a3 a2 a3 a2 a3 b1 c2]

[[d2 d3]*4]

[[c2 c3]*4]

[[b1 b2]*2 [e2 e3]*2]

[[a1 a2]*4]

>\`)`}],N3e=[{id:"sampler-begin",label:"begin",description:"Skip the first section of each triggered sample.",tooltip:"A 0–1 pattern that trims the start of each hit (0.25 removes the first quarter).",pattern:`samples({
  "rave": "rave/AREUREADY.wav"
}, "github:tidalcycles/dirt-samples")

s("rave")
  .begin("<0 0.25 0.5 0.75>")
  .fast(2)`},{id:"sampler-end",label:"end",description:"Cut the tail of the sample instead of the beginning.",tooltip:"Same as .begin but trims from the end (1 = full sample, 0.5 = half length).",pattern:`s("bd*2,oh*4").bank("RolandTR808")
  .end("<0.1 0.2 0.5 1>")
  .fast(2)`},{id:"sampler-loop",label:"loop",description:"Keep a sample looping regardless of the cycle length.",tooltip:"Enable sustained looping (1 = on) — tempo is free-running.",pattern:`s("casio")
  .loop(1)`},{id:"sampler-loopBegin",label:"loopBegin",description:"Set the point inside the sample where looping starts.",tooltip:"Choose the loop start within 0–1 of the file; must be before loopEnd.",pattern:`s("space").loop(1)
  .loopBegin("<0 0.125 0.25>")
  ._scope()`},{id:"sampler-loopEnd",label:"loopEnd",description:"Set the point inside the sample where looping ends.",tooltip:"Choose the loop end (0–1). Must be after loopBegin for a valid loop.",pattern:`s("space").loop(1)
  .loopEnd("<1 0.75 0.5 0.25>")
  ._scope()`},{id:"sampler-cut",label:"cut",description:"Use classic drum-machine style choke groups.",tooltip:"Samples in the same cut group (1 here) stop each other when they retrigger.",pattern:`s("[oh hh]*4").bank("RolandTR808")
  .cut(1)`},{id:"sampler-clip",label:"clip",description:"Shorten or lengthen the note duration without altering tempo.",tooltip:"Multiplies sustain by the factor; values <1 gate the sample early.",pattern:`note("c a f e")
  .s("piano")
  .clip("<0.5 1 2>")
  .legato(1)`},{id:"sampler-loopAt",label:"loopAt",description:"Time-stretch samples to a specific number of cycles.",tooltip:"Stretches/compresses playback so the loop fits exactly 2 cycles.",pattern:`samples({
  "rhodes": "https://cdn.freesound.org/previews/132/132051_316502-lq.mp3"
})

s("rhodes").loopAt(2)`},{id:"sampler-fit",label:"fit",description:"Resize a sample to the length of each event.",tooltip:"Fits every triggered slice to its event duration — great for breakbeats.",pattern:`samples({
  "rhodes": "https://cdn.freesound.org/previews/132/132051-lq.mp3"
})

s("rhodes/2")
  .fit()`},{id:"sampler-chop",label:"chop",description:"Split samples into equal slices for granular tricks.",tooltip:"Cuts each hit into 4 tiny grains, then reorders/repeats them in two cycles.",pattern:`samples({
  "rhodes": "https://cdn.freesound.org/previews/132/132051-lq.mp3"
})

s("rhodes")
  .chop(4)
  .rev()
  .loopAt(2)`},{id:"sampler-striate",label:"striate",description:"Sequentially scan through chunks of each sample.",tooltip:"Each trigger jumps forward through 6 slices of the source file.",pattern:`s("numbers:0 numbers:1 numbers:2")
  .striate(6)
  .slow(3)`},{id:"sampler-slice",label:"slice",description:"Address slices explicitly using indexes or fractional lists.",tooltip:"Divide the file into slices and trigger them via patterns or fractional lists.",pattern:`samples("github:tidalcycles/dirt-samples")

s("breaks165")
  .slice(8, "0 1 <2 2*2> 3 [4 0] 5 6 7")
  .slow(0.75)

s("breaks125")
  .fit()
  .slice([0, 0.25, 0.5, 0.75], "0 1 1 <2 3>")`},{id:"sampler-splice",label:"splice",description:"Slice like .slice but time-stretches to match step length.",tooltip:"Each slice is warped to fill its step, so rhythms stay tight.",pattern:`samples("github:tidalcycles/dirt-samples")

s("breaks165")
  .splice(8, "0 1 [2 3 0]@2 3 0@2 7")`},{id:"sampler-scrub",label:"scrub",description:"Manually scrub through audio (great for granular tape FX).",tooltip:"Supply 0–1 positions (optionally with :speed) to scrub through the waveform.",pattern:`samples("github:switchangel/pad")
s("swpad:0")
  .scrub("{0.1!2 0.25@3 0.7!2 <0.8:1.5>}%8")

samples("github:yaxu/clean-breaks/main")
s("amen/4")
  .fit()
  .scrub(pattern("{0@3 0@2 4@3}%8").div(16))`},{id:"sampler-speed",label:"speed",description:"Pitch-shift or reverse by changing playback speed.",tooltip:"Positive speeds raise the pitch; negatives play the sample backwards.",pattern:`s("bd*6")
  .speed("1 2 4 1 -2 -4")

speed("1 1.5*2 [2 1.1]")
  .s("piano")
  .clip(1)`}].map(n=>({...n,editorBadge:"Code"}));VG.forEach(n=>{n.editorBadge||(n.editorBadge="Code")});const Dx=[{id:"song-acidic-tooth",label:'Song · "acidic tooth" @by eddyflux',pattern:`// "acidic tooth" @by eddyflux
// @version 1.0

setcps(1)

stack(

  /* Channel 1 */
  stack(
    s("bd*2").mask("<0@4 1@16>"),
    s("hh*8").gain(saw.mul(saw.fast(2))).clip(sine)
    .mask("<0@8 1@16>")
  ).bank('RolandTR909')

  ,

  /* Channel 2 */
  note("[<g1 f1>/8](<3 5>,8)")
  .clip(perlin.range(.15,1.5))
  .release(.1)
  .s("sawtooth")
  .lpf(sine.range(400,800).slow(16))
  .lpq(cosine.range(6,14).slow(3))
  .lpenv(sine.mul(4).slow(4))
  .lpd(.2).lpa(.02)
  .ftype('24db')
  .rarely(add(note(12)))
  .room(.2).shape(.3).postgain(.5)
  .superimpose(x=>x.add(note(12)).delay(.5).bpf(1000))
  .gain("[.2 1@3]*2") // fake sidechain

)`.trim()}],Tx=ON("assets/samples/voice/Strudesk4000_de.mp3");let ys=null;const I7=25,L7=25,Q7="strudel_channel_history:",Bx="strudel_master_history",tm={get(n){try{return window.localStorage.getItem(n)}catch(e){return console.warn("Pattern history storage get failed:",e),null}},set(n,e){try{window.localStorage.setItem(n,e)}catch(t){console.warn("Pattern history storage set failed:",t)}}},La=(()=>{const n=new Map;let e=null;const t=u=>{if(!u)return[];try{const h=JSON.parse(u);return Array.isArray(h)?h:[]}catch{return[]}},s=(u,h)=>{tm.set(u,JSON.stringify(h))};return{saveChannelVersion:(u,h)=>{const d=(h||"").trim();if(!u||!d||n.get(u)===d)return;const m=`${Q7}${u}`;let y=t(tm.get(m));if(y.length&&y[0].pattern===d){n.set(u,d);return}const O={id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,pattern:d,createdAt:Date.now()};if(y.unshift(O),y.length>I7&&(y=y.slice(0,I7)),s(m,y),n.set(u,d),typeof window<"u"&&typeof window.dispatchEvent=="function")try{window.dispatchEvent(new CustomEvent("channel-history-updated",{detail:{elementId:u}}))}catch{}},getChannelVersions:u=>u?t(tm.get(`${Q7}${u}`)):[],markChannelSnapshot:(u,h)=>{u&&n.set(u,(h||"").trim())},saveMasterVersion:u=>{const h=(u||"").trim();if(!h||h===e){e=h;return}let d=t(tm.get(Bx));if(d.length&&d[0].pattern===h){e=h;return}const m={id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,pattern:h,createdAt:Date.now()};d.unshift(m),d.length>L7&&(d=d.slice(0,L7)),s(Bx,d),e=h},getMasterVersions:()=>t(tm.get(Bx)),markMasterSnapshot:u=>{e=(u||"").trim()}}})();window.__patternHistory=La;const _3e=()=>{const n=document.getElementById("pattern-history-modal");if(!n)return{openChannelHistory:()=>{},openMasterHistory:()=>{},close:()=>{}};const e=document.getElementById("pattern-history-title"),t=document.getElementById("pattern-history-list"),s=document.getElementById("pattern-history-tabs"),r=document.getElementById("pattern-history-close");let a=null,i=[],o="local";const l=A=>A.replace(/[&<>"']/g,F=>{switch(F){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";default:return F}}),c=A=>{try{return new Date(A).toLocaleString()}catch{return""}},u=()=>{n.classList.remove("is-open"),n.setAttribute("aria-hidden","true"),a=null,i=[],Bi("pattern-history-modal")},h=()=>{n.classList.add("is-open"),n.setAttribute("aria-hidden","false"),uo("pattern-history-modal")},d=(A,F={})=>{const{includeMasterSongs:j=!1,isCloudPatterns:N=!1}=F,$=document.createDocumentFragment();if(Array.isArray(A)&&A.length>0)A.forEach((I,q)=>{const ce=document.createElement("div");ce.className="pattern-history-entry";let ee=I.patternCode||I.pattern||"";const he=ee.length>240?`${ee.slice(0,240)}…`:ee,H=(q+1).toString().padStart(2,"0");let me=c(I.createdAt);if(N){const Oe=[];I.title&&Oe.push(`"${I.title}"`),I.artistName&&Oe.push(`by ${I.artistName}`),I.version&&Oe.push(`v${I.version}${I.versionName?` (${I.versionName})`:""}`),I.userCount>0&&Oe.push(`${I.userCount} user${I.userCount>1?"s":""}`),Oe.length>0&&(me=Oe.join(" • "))}ce.innerHTML=`
          <div class="pattern-history-meta">
            <span class="pattern-history-index">#${H}</span>
            <p class="pattern-history-date">${l(me)}</p>
          </div>
          <pre class="pattern-history-snippet">${l(he)}</pre>
          <div class="pattern-history-actions">
            <button type="button" class="pattern-history-load" data-version-id="${I.id}" data-is-cloud="${N}">Load</button>
          </div>
        `,$.appendChild(ce)});else{const I=document.createElement("p");I.className="pattern-history-empty",I.textContent="No saved versions yet.",$.appendChild(I)}if(j&&Dx.length&&o==="local"){const I=document.createElement("h4");I.className="pattern-history-section-title",I.textContent="Songs",$.appendChild(I),Dx.forEach((q,ce)=>{const ee=document.createElement("div");ee.className="pattern-history-entry pattern-history-entry--song";const he=q.pattern.length>400?`${q.pattern.slice(0,400)}…`:q.pattern,H=(ce+1).toString().padStart(2,"0");ee.innerHTML=`
          <div class="pattern-history-meta">
            <span class="pattern-history-index">#${H}</span>
            <p class="pattern-history-date">${l(q.label)}</p>
          </div>
          <pre class="pattern-history-snippet">${l(he)}</pre>
          <div class="pattern-history-actions">
            <button type="button" class="pattern-history-load" data-song-id="${q.id}">Load</button>
          </div>
        `,$.appendChild(ee)})}t.innerHTML="",t.appendChild($)};t.addEventListener("click",async A=>{const F=A.target.closest(".pattern-history-load");if(!F||!ys)return;const j=F.dataset.versionId,N=F.dataset.songId,$=F.dataset.isCloud==="true";if(N&&(a==null?void 0:a.type)==="master"){const q=Dx.find(ce=>ce.id===N);if(!q)return;ys.applyMasterHistoryEntry(q.pattern),u();return}let L=i.find(q=>q.id===j);if($&&L)try{const{patternsAPI:q,getCurrentUser:ce}=await ds(async()=>{const{patternsAPI:H,getCurrentUser:me}=await Promise.resolve().then(()=>dc);return{patternsAPI:H,getCurrentUser:me}},void 0);if(!await ce()){alert("Please log in to load patterns from cloud");return}L=await q.getPattern(j)}catch(q){console.error("Error loading cloud pattern:",q),alert("Failed to load pattern: "+(q.message||"Please check your login status"));return}if(!L)return;let I=L.patternCode||L.pattern;I&&(I=I.replace(/\.postgain\s*\([^)]*\)/gi,""),I=I.replace(/\.pan\s*\([^)]*\)/gi,""),I=I.replace(/\.fast\s*\([^)]*\)/gi,""),I=I.replace(/\.slow\s*\([^)]*\)/gi,""),I=I.replace(/\.cpm\s*\([^)]*\)/gi,""),I=I.replace(/\.\.+/g,".").trim(),I=I.replace(/\.+$/,"").trim(),(a==null?void 0:a.type)==="channel"?ys.applyChannelHistoryEntry(a.elementId,I):(a==null?void 0:a.type)==="master"&&ys.applyMasterHistoryEntry(I),u())}),r==null||r.addEventListener("click",u),n.addEventListener("click",A=>{A.target===n&&u()});const m=async(A,F=null)=>{try{const{patternsAPI:j,getCurrentUser:N}=await ds(async()=>{const{patternsAPI:q,getCurrentUser:ce}=await Promise.resolve().then(()=>dc);return{patternsAPI:q,getCurrentUser:ce}},void 0),$=await N();if(!$)return[];const L={type:A};let I=[];return o==="my-patterns"?(I=await j.getPatterns({type:A,isPublic:!1}),I=I.filter(q=>q.userId===$.id)):o==="public"?I=await j.getPatterns({type:A,isPublic:!0}):o==="shared"&&(I=await j.getPatterns({type:A,shared:!0})),I}catch(j){return console.error("Error loading cloud patterns:",j),[]}},y=async A=>{if(o=A,s&&s.querySelectorAll(".pattern-history-tab").forEach(F=>{F.classList.toggle("active",F.dataset.tab===A)}),t.innerHTML='<p class="pattern-history-empty">Loading…</p>',A==="local")(a==null?void 0:a.type)==="channel"?(i=La.getChannelVersions(a.elementId),d(i)):(a==null?void 0:a.type)==="master"&&(i=La.getMasterVersions(),d(i,{includeMasterSongs:!0}));else{const F=await m((a==null?void 0:a.type)||"master",a==null?void 0:a.elementId);i=F,d(F,{isCloudPatterns:!0})}},O=async A=>{if(!A)return;a={type:"channel",elementId:A},e.textContent=`${Wu(A)} history`,h();const{getCurrentUser:F}=await ds(async()=>{const{getCurrentUser:N}=await Promise.resolve().then(()=>dc);return{getCurrentUser:N}},void 0),j=await F();s&&(s.style.display=j?"flex":"none"),t.innerHTML='<p class="pattern-history-empty">Loading…</p>',o="local",i=La.getChannelVersions(A),d(i)},S=async()=>{a={type:"master"},e.textContent="Master history",h();const{getCurrentUser:A}=await ds(async()=>{const{getCurrentUser:j}=await Promise.resolve().then(()=>dc);return{getCurrentUser:j}},void 0),F=await A();s&&(s.style.display=F?"flex":"none"),t.innerHTML='<p class="pattern-history-empty">Loading…</p>',o="local",i=La.getMasterVersions(),d(i,{includeMasterSongs:!0})};return s&&s.addEventListener("click",A=>{const F=A.target.closest(".pattern-history-tab");F&&y(F.dataset.tab)}),{openChannelHistory:O,openMasterHistory:S,close:u}};let Cb=null;const R3e=n=>{var r,a;if(!Cb)return;const e=n.target.closest("[data-history-save]");if(e){n.preventDefault();const i=e.dataset.historySave;if(i==="channel"){const o=e.closest(".sound-element"),l=o==null?void 0:o.getAttribute("data-sound-id");l&&ys&&((r=ys.saveChannelWithMidi)==null||r.call(ys,l))}else i==="master"&&ys&&((a=ys.saveMasterHistoryEntry)==null||a.call(ys));return}const t=n.target.closest('[data-history-target="channel"]');if(t){n.preventDefault();const i=t.closest(".sound-element"),o=i==null?void 0:i.getAttribute("data-sound-id");o&&Cb.openChannelHistory(o);return}n.target.closest("#load-master-history-btn")&&(n.preventDefault(),Cb.openMasterHistory())},j7=()=>{Cb=_3e(),document.addEventListener("click",R3e)},Fx=[{key:"bd",label:"BD",sample:"bd"},{key:"sn",label:"SN",sample:"sd"},{key:"hh",label:"HH",sample:"hh"}],I3e=new Set([...Om,...zh,...bG]),L3e=["note()","n()","sound()","s()","bank()","beat()","vowel()","chord()","voicing()","addVoicings()","gain()","adsr()","scale()","pan()","speed()","slow()","fast()","early()","late()","legato()","euclid()","euclidRot()","euclidLegato()","rev()","palindrome()","iter()","iterBack()","ply()","range()","rangex()","range2()","lpf()","lpa()","lpd()","lps()","lpq()","lpattack()","lpdecay()","lpsustain()","lprelease()","orbit()","postgain()","irand()","seg()","hpf()","hpq()","bpf()","bpg()","bpq()","fancor()","lpenv()","ftype()","attack()","decay()","sustain()","release()","tremolo()","resonance()","cutoff()","noise()","tremolosync()","tremoloskew()","tremolodepth()","tremolophase()","tremoloshape()","sometimes()","stack()","clip()","sub()","mul()","div()","floor()","ceil()","ratio()","as()","saw()","sine()","cosine()","tri()","square()","rand()","saw2()","sine2()","cosine2()","tri2()","square2()","rand2()","perlin()","brand()","brandBy()","mouseX()","mouseY()","choose()","wchoose()","chooseCycles()","wchooseCycles()","degradeBy()","degrade()","undegradeBy()","undegrade()","sometimesBy()","sometimes()","someCyclesBy()","someCycles()","often()","rarely()","almostNever()","almostAlways()","never()","always()","lastOf()","firstOf()","when()","chunk()","chunkBack()","fastChunk()","arp()","arpWith()","struct()","mask()","reset()","restart()","hush()","invert()","pick()","pickmod()","pickF()","pickmodF()","pickRestart()","pickmodRestart()","pickReset()","pickmodReset()","inhabit()","inhabitmod()","squeeze()","superimpose()","layer()","off()","echo()","echoWith()","transpose()","scaleTranspose()","rootNotes()","pace()","stepcat()","stepalt()","expand()","contract()","extend()","take()","drop()","polymeter()","shrink()","grow()","tour()","zip()","vib()","vibmod()","add()","anchor()","dict()","penv()","segment()","compress()","zoom()","linger()","fastGap()","inside()","outside()","cpm()","ribbon()","swingBy()","swing()","patt()","dec()","mode()","set()","struct()","pick()","pattack()","pdecay()","prelease()","pcurve()","panchor()","velocity()","fm()","fmh()","fmattack()","fmdecay()","fmsustain()","fmenv()","zrand()","curve()","slide()","deltaSlide()","zmod()","zcrush()","zdelay()","pitchJump()","pitchJumpTime()","lfo()","compressor()","control()","ccn()","ccv()","midimap()","midimaps()","defaultmidimap()","midi()","midiport()","midicmd()","midibend()","miditouch()","progNum()","sysex()","sysexid()","sysexdata()","osc()","mqtt()","xfade()","jux()","juxBy()","coarse()","crush()","distort()","delay()","delaytime()","delayfeedback()","room()","roomsize()","roomfade()","roomlp()","roomdim()","iresponse()","phaser()","phaserdepth()","phasercenter()","phasersweep()","duckorbit()","duckattack()","duckdepth()"],Pb=["stack()","vowel()","beat()","bank()","sound()","chord()","note()"],Q3e=['sound("sawtooth")','sound("square")','sound("triangle")','sound("sine")','sound("white")','sound("pink")','sound("brown")'],j3e=["beat","chord","note","sound","stack"],V3e=new Map([['sound("brown")',"pattern-snippet-tag-sound-brown"],['sound("pink")',"pattern-snippet-tag-sound-pink"],['sound("white")',"pattern-snippet-tag-sound-white"]]),Z3e=new Set(["core"]),z3e=new Set(["filters-lp","filters-hp","filters-bp"]),q3e=new Set(["filters-lp","filters-hp","filters-bp"]),nm=new Map;function $x(n){return n<=20?0:n>=2e4?1:n<=100?(n-20)/80*.25:n<=500?.25+(n-100)/400*.25:n<=5e3?.5+(n-500)/4500*.3:.8+(n-5e3)/15e3*.2}function Nx(n){return n<=0?20:n>=1?2e4:n<=.25?20+n/.25*80:n<=.5?100+(n-.25)/.25*400:n<=.8?500+(n-.5)/.3*4500:5e3+(n-.8)/.2*15e3}const xm={lpf:{min:20,max:2e4,step:10,default:2e4,unit:"Hz"},hpf:{min:20,max:2e4,step:10,default:20,unit:"Hz"},bpf:{min:20,max:2e4,step:10,default:1e3,unit:"Hz"},lpq:{min:0,max:20,step:.1,default:0,unit:""},hpq:{min:0,max:20,step:.1,default:0,unit:""},bpq:{min:0,max:20,step:.1,default:0,unit:""},bpg:{min:-20,max:20,step:.1,default:0,unit:"dB"},attack:{min:0,max:2,step:.01,default:.01,unit:"s"},decay:{min:0,max:2,step:.01,default:.1,unit:"s"},sustain:{min:0,max:1,step:.01,default:.5,unit:""},release:{min:0,max:5,step:.01,default:.1,unit:"s"},lpattack:{min:0,max:2,step:.01,default:.01,unit:"s"},lpdecay:{min:0,max:2,step:.01,default:.1,unit:"s"},lpsustain:{min:0,max:1,step:.01,default:.5,unit:""},lprelease:{min:0,max:5,step:.01,default:.1,unit:"s"},hpattack:{min:0,max:2,step:.01,default:.01,unit:"s"},hpdecay:{min:0,max:2,step:.01,default:.1,unit:"s"},hpsustain:{min:0,max:1,step:.01,default:.5,unit:""},hprelease:{min:0,max:5,step:.01,default:.1,unit:"s"},bpattack:{min:0,max:2,step:.01,default:.01,unit:"s"},bpdecay:{min:0,max:2,step:.01,default:.1,unit:"s"},bpsustain:{min:0,max:1,step:.01,default:.5,unit:""},bprelease:{min:0,max:5,step:.01,default:.1,unit:"s"},bpenv:{min:0,max:1,step:.01,default:.5,unit:""},hpenv:{min:0,max:1,step:.01,default:.5,unit:""},pattack:{min:0,max:2,step:.01,default:.01,unit:"s"},pdecay:{min:0,max:2,step:.01,default:.1,unit:"s"},prelease:{min:0,max:5,step:.01,default:.1,unit:"s"},gain:{min:0,max:2,step:.01,default:.8,unit:""},postgain:{min:0,max:2,step:.01,default:1,unit:""},velocity:{min:0,max:1,step:.01,default:.5,unit:""},pan:{min:-1,max:1,step:.01,default:0,unit:""},slow:{min:.1,max:10,step:.1,default:2,unit:"x"},fast:{min:.1,max:10,step:.1,default:2,unit:"x"},early:{min:0,max:1,step:.01,default:.25,unit:""},late:{min:0,max:1,step:.01,default:.25,unit:""},delay:{min:0,max:1,step:.01,default:0,unit:""},delaytime:{min:0,max:1,step:.01,default:.25,unit:"s"},delayfeedback:{min:0,max:1,step:.01,default:.5,unit:""},room:{min:0,max:5,step:.01,default:0,unit:""},roomsize:{min:0,max:4,step:.01,default:.5,unit:""},roomfade:{min:0,max:1,step:.01,default:.5,unit:""},roomlp:{min:20,max:2e4,step:10,default:20,unit:"Hz"},roomdim:{min:0,max:1,step:.01,default:0,unit:""},iresponse:{min:0,max:1,step:.01,default:0,unit:""},phaser:{min:0,max:1,step:.01,default:0,unit:""},phaserdepth:{min:0,max:1,step:.01,default:.5,unit:""},phasercenter:{min:0,max:1,step:.01,default:.5,unit:""},phasersweep:{min:0,max:1,step:.01,default:.5,unit:""},duckattack:{min:0,max:2,step:.01,default:.01,unit:"s"},duckdepth:{min:0,max:1,step:.01,default:.5,unit:""},tremolo:{min:0,max:1,step:.01,default:0,unit:""},tremolodepth:{min:0,max:1,step:.01,default:.5,unit:""},tremoloskew:{min:0,max:1,step:.01,default:.5,unit:""},tremolophase:{min:0,max:1,step:.01,default:0,unit:""},resonance:{min:0,max:20,step:.1,default:0,unit:""},cutoff:{min:20,max:2e4,step:10,default:2e4,unit:"Hz"},speed:{min:.1,max:10,step:.1,default:1,unit:"x"},legato:{min:0,max:1,step:.01,default:0,unit:""},cpm:{min:60,max:300,step:1,default:120,unit:"BPM"}},Vm=[{id:"core",order:0,label:"Core",heading:"Core",matcher:n=>["stack","beat","bank","sound","s","note","n"].includes(n),className:"snippet-group-core"},{id:"amplitude-modulation",order:1,label:"Amplitude Modulation",heading:"Amplitude Modulation",matcher:n=>["tremolo","tremolosync","tremolodepth","tremoloskew","tremolophase","tremoloshape"].includes(n),className:"snippet-group-amplitude-modulation"},{id:"amplitude-envelope",order:2,label:"Amplitude Envelope",heading:"Amplitude Envelope",matcher:n=>["attack","decay","sustain","release","adsr"].includes(n),className:"snippet-group-amplitude-envelope"},{id:"filter-envelope",order:3,label:"Filter Envelope",heading:"Filter Envelope",matcher:n=>["lpattack","lpdecay","lpsustain","lprelease","lpenv"].includes(n),className:"snippet-group-filter-envelope"},{id:"pitch-envelope",order:4,label:"Pitch Envelope",heading:"Pitch Envelope",matcher:n=>["pattack","pdecay","prelease","penv","pcurve","panchor"].includes(n),className:"snippet-group-pitch-envelope"},{id:"dynamics",order:5,label:"Dynamics",heading:"Dynamics",matcher:n=>["gain","velocity","compressor","postgain","xfade"].includes(n),className:"snippet-group-dynamics"},{id:"panning",order:6,label:"Panning",heading:"Panning",matcher:n=>["jux","juxby","pan"].includes(n),className:"snippet-group-panning"},{id:"waveshaping",order:7,label:"Waveshaping",heading:"Waveshaping",matcher:n=>["coarse","crush","distort"].includes(n),className:"snippet-group-waveshaping"},{id:"global-effects",order:8,label:"Global Effects",heading:"Global Effects",matcher:n=>["orbit"].includes(n),className:"snippet-group-global-effects"},{id:"delay",order:9,label:"Delay",heading:"Delay",matcher:n=>["delay","delaytime","delayfeedback"].includes(n),className:"snippet-group-delay"},{id:"reverb",order:10,label:"Reverb",heading:"Reverb",matcher:n=>["room","roomsize","roomfade","roomlp","roomdim","iresponse"].includes(n),className:"snippet-group-reverb"},{id:"phaser",order:11,label:"Phaser",heading:"Phaser",matcher:n=>["phaser","phaserdepth","phasercenter","phasersweep"].includes(n),className:"snippet-group-phaser"},{id:"duck",order:12,label:"Duck",heading:"Duck",matcher:n=>["duckorbit","duckattack","duckdepth"].includes(n),className:"snippet-group-duck"},{id:"filters-hp",order:5,label:"Filters · High-pass",heading:"Filters · High-pass",matcher:n=>n.startsWith("hp"),className:"snippet-group-filters-hp"},{id:"filters-bp",order:6,label:"Filters · Band-pass",heading:"Filters · Band-pass",matcher:n=>n.startsWith("bp"),className:"snippet-group-filters-bp"},{id:"filters-lp",order:7,label:"Filters · Low-pass",heading:"Filters · Low-pass",matcher:n=>n.startsWith("lp")||n==="ftype"||n==="vowel"||n==="applygraduallowpass",className:"snippet-group-filters-lp"},{id:"time",order:8,label:"Time Modifiers",heading:"Time Modifiers",matcher:n=>["slow","fast","early","late","clip","legato","euclid","euclidrot","euclidlegato","rev","palindrome","iter","iterback","ply","segment","compress","zoom","linger","fastgap","inside","outside","cpm","ribbon","swingby","swing"].includes(n),className:"snippet-group-time"},{id:"control-operators",order:9,label:"Control · Operators",heading:"Control Parameters · Operators",matcher:n=>["add","sub","mul","div","floor","ceil","range","rangex","range2","ratio","as"].includes(n),className:"snippet-group-controls"},{id:"signals",order:10,label:"Signals",heading:"Signals",matcher:n=>["saw","sine","cosine","tri","square","rand","saw2","sine2","cosine2","tri2","square2","rand2","perlin","irand","brand","brandby"].includes(n),className:"snippet-group-signals"},{id:"visual-feedback",order:11,label:"Visual Feedback",heading:"Visual Feedback",matcher:(n,e)=>{if(n==="color"||n==="markcss"||["fscope","generategraph","pianoroll","pitchwheel","scope","spiral","wordfall"].includes(n))return!0;if(!e||typeof e!="string")return!1;const t=e.toLowerCase();return t.includes("_punchcard")||t.includes("_pianoroll")||t.includes("_scope")||t.includes("_spiral")||t.includes("_pitchwheel")||t.includes("_spectrum")},className:"snippet-group-visual-feedback"},{id:"synths",order:12,label:"Synths",heading:"Synths",matcher:(n,e)=>n==="sound"?typeof e=="string"&&e.includes('sound("'):["decay","sustain","attack","release","cutoff","noise","vib","vibmod","fm","fmh","fmattack","fmdecay","fmsustain","fmenv","fmwave","zrand","curve","slide","deltaslide","zmod","zcrush","zdelay","pitchjump","pitchjumptime","lfo","tremolo","octave","pw","pwrate","pwsweep","spread","unison","isaw","isaw2","itri","itri2"].includes(n),className:"snippet-group-synths"},{id:"tonal",order:13,label:"Tonal Functions",heading:"Tonal Functions",matcher:n=>["voicing","voicings","addvoicings","scale","transpose","scaletranspose","rootnotes","chord","dict","anchor","mode","below","duck","above","offset","n","note"].includes(n),className:"snippet-group-tonal"},{id:"stepwise",order:14,label:"Stepwise Patterning",heading:"Stepwise Patterning",matcher:n=>["pace","stepcat","stepalt","expand","contract","extend","take","drop","polymeter","shrink","grow","tour","zip"].includes(n),className:"snippet-group-stepwise"},{id:"random",order:15,label:"Random Modifiers",heading:"Random Modifiers",matcher:n=>["choose","wchoose","choosecycles","wchoosecycles","degradeby","degrade","undegradeby","undegrade","sometimesby","sometimes","somecyclesby","somecycles","often","rarely","almostnever","almostalways","never","always"].includes(n),className:"snippet-group-random"},{id:"conditional",order:16,label:"Conditional Modifiers",heading:"Conditional Modifiers",matcher:n=>["lastof","firstof","when","chunk","chunkback","fastchunk","arp","arpwith","struct","mask","reset","restart","hush","invert","pick","pickmod","pickf","pickmodf","pickrestart","pickmodrestart","pickreset","pickmodreset","inhabit","inhabitmod","squeeze"].includes(n),className:"snippet-group-conditional"},{id:"accumulation",order:17,label:"Accumulation Modifiers",heading:"Accumulation Modifiers",matcher:n=>["superimpose","layer","off","echo","echowith"].includes(n),className:"snippet-group-accumulation"},{id:"midi",order:18,label:"MIDI",heading:"MIDI",matcher:n=>n.includes("midi")||n.startsWith("ccn")||n.startsWith("ccv")||n==="prognum"||n==="sysex"||n==="sysexid"||n==="sysexdata"||n==="control",className:"snippet-group-midi",exclude:["pianoroll"]},{id:"device",order:19,label:"Device Motion",heading:"Device Motion",matcher:n=>["orientation","acceleration","accelerationx","accelerationy","accelerationz","rotationx","rotationy","rotationz","gravityx","gravityy","gravityz","mousex","mousey"].some(t=>n.includes(t)),className:"snippet-group-device"},{id:"external-communication",order:20,label:"External Communication",heading:"External Communication",matcher:n=>["osc","mqtt"].includes(n),className:"snippet-group-external-communication"},{id:"other",order:Number.MAX_SAFE_INTEGER,label:"Other",heading:"Other",matcher:()=>!0,className:"snippet-group-other"}],F0=Vm.reduce((n,e)=>(n.set(e.id,e),n),new Map),U3e={sound:["bank","note","chord","delay","room","phaser","gain","lpf","pan"],s:["bank","note","chord","delay","room","phaser","gain","lpf","pan"],note:["chord","scale","voicing","transpose","scaletranspose","rootnotes","attack","decay","release","lpf","gain","pan"],stack:["beat","sound","note","gain","pan"],beat:["sound","s","euclid","mask","slow","fast","rev","iter"],bank:["sound","s","gain","pan","slow","fast","euclid","mask","delay","room","crush","distort"],lpf:["lpenv","lpattack","lpdecay","lpsustain","lprelease","lpq","ftype","hpf","bpf","gain"],hpf:["hpattack","hpdecay","hpsustain","hprelease","hpq","lpf","bpf","gain"],bpf:["bpattack","bpdecay","bpsustain","bprelease","bpq","bpg","lpf","hpf","gain"],lpenv:["lpf","lpattack","lpdecay","lpsustain","lprelease","lpq"],lpattack:["lpf","lpenv","lpdecay","lpsustain","lprelease"],lpdecay:["lpf","lpenv","lpattack","lpsustain","lprelease"],lpsustain:["lpf","lpenv","lpattack","lpdecay","lprelease"],lprelease:["lpf","lpenv","lpattack","lpdecay","lpsustain"],lpq:["lpf","lpenv"],hpq:["hpf"],bpq:["bpf","bpg"],bpg:["bpf","bpq"],ftype:["lpf"],vowel:["lpf","ftype"],attack:["decay","sustain","release","adsr","gain","lpf"],decay:["attack","sustain","release","adsr","gain"],sustain:["attack","decay","release","adsr","gain"],release:["attack","decay","sustain","adsr","gain"],adsr:["attack","decay","sustain","release","gain"],pattack:["pdecay","prelease","penv","pcurve","panchor"],pdecay:["pattack","prelease","penv","pcurve"],prelease:["pattack","pdecay","penv","pcurve"],penv:["pattack","pdecay","prelease","pcurve","panchor"],pcurve:["penv","pattack","pdecay","prelease"],panchor:["penv","pattack"],delay:["delaytime","delayfeedback"],delaytime:["delay","delayfeedback"],delayfeedback:["delay","delaytime"],room:["roomsize","roomfade","roomlp","roomdim","iresponse"],roomsize:["room","roomfade","roomlp","roomdim"],roomfade:["room","roomsize","roomlp"],roomlp:["room","roomsize","roomfade"],roomdim:["room","roomsize"],iresponse:["room","roomsize"],phaser:["phaserdepth","phasercenter","phasersweep"],phaserdepth:["phaser","phasercenter","phasersweep"],phasercenter:["phaser","phaserdepth","phasersweep"],phasersweep:["phaser","phaserdepth","phasercenter"],duckorbit:["duckattack","duckdepth"],duckattack:["duckorbit","duckdepth"],duckdepth:["duckorbit","duckattack"],gain:["velocity","compressor","postgain","pan","delay","room"],velocity:["gain","attack","decay"],compressor:["gain","postgain"],postgain:["gain","compressor"],xfade:["gain"],pan:["jux","juxby","gain"],jux:["juxby","pan"],juxby:["jux","pan"],crush:["distort","coarse","gain"],distort:["crush","coarse","gain"],coarse:["crush","distort"],slow:["fast","early","late","clip","legato","swing"],fast:["slow","early","late","clip","legato"],early:["late","slow","fast","clip"],late:["early","slow","fast","clip"],clip:["slow","fast","legato","early","late"],legato:["clip","early","late","slow","fast"],euclid:["euclidrot","euclidlegato","mask","beat","slow","fast"],euclidrot:["euclid","euclidlegato","mask"],euclidlegato:["euclid","euclidrot","mask"],rev:["palindrome","iter","iterback"],palindrome:["rev","iter","iterback"],iter:["iterback","rev","palindrome"],iterback:["iter","rev","palindrome"],ply:["segment","compress","zoom"],segment:["ply","compress","zoom","ribbon"],compress:["ply","segment"],zoom:["linger","fastgap","ply","segment"],linger:["zoom","fastgap"],fastgap:["zoom","linger"],inside:["outside","clip"],outside:["inside","clip"],swing:["swingby","cpm","slow","fast"],swingby:["swing","cpm"],cpm:["swing","swingby"],ribbon:["segment","ply"],add:["sub","mul","div","range","rangex"],sub:["add","mul","div","range"],mul:["add","sub","div","range"],div:["add","sub","mul","range"],range:["rangex","range2","add","sub","mul"],rangex:["range","range2"],range2:["range","rangex"],floor:["ceil","ratio"],ceil:["floor","ratio"],ratio:["floor","ceil"],as:["range"],saw:["sine","tri","square","rand","range"],sine:["saw","cosine","tri","square","range"],cosine:["sine","saw","tri","square"],tri:["saw","sine","square","rand"],square:["saw","sine","tri","rand"],rand:["saw","sine","tri","square","irand","brand"],saw2:["sine2","tri2","square2","rand2"],sine2:["saw2","cosine2","tri2","square2"],cosine2:["sine2","saw2","tri2","square2"],tri2:["saw2","sine2","square2","rand2"],square2:["saw2","sine2","tri2","rand2"],rand2:["saw2","sine2","tri2","square2"],perlin:["rand","brand","range"],irand:["rand","brand"],brand:["rand","irand","brandby"],brandby:["brand"],chord:["voicing","addvoicings","scale","transpose","scaletranspose","rootnotes","dict","mode","note"],voicing:["chord","addvoicings","scale","transpose","note"],addvoicings:["voicing","chord"],scale:["chord","voicing","transpose","scaletranspose","rootnotes","dict","mode","note"],transpose:["scale","scaletranspose","chord","note","offset"],scaletranspose:["scale","transpose","chord"],rootnotes:["scale","chord","transpose"],dict:["chord","scale","note"],anchor:["penv","pcurve","panchor","scale"],mode:["scale","chord","note"],below:["above","note","chord"],above:["below","note","chord"],offset:["transpose","scale","note"],n:["note","chord","scale","voicing","transpose"],cutoff:["lpf","resonance","lpenv"],resonance:["cutoff","lpf","lpq"],noise:["sound","cutoff","lpf"],vib:["vibmod","tremolo"],vibmod:["vib"],fm:["fmh","fmattack","fmdecay","fmsustain","fmenv","fmwave"],fmh:["fm","fmattack","fmdecay"],fmattack:["fm","fmdecay","fmsustain","fmenv"],fmdecay:["fm","fmattack","fmsustain","fmenv"],fmsustain:["fm","fmattack","fmdecay","fmenv"],fmenv:["fm","fmattack","fmdecay","fmsustain"],fmwave:["fm"],zrand:["rand","brand"],curve:["slide","deltaslide"],slide:["curve","deltaslide"],deltaslide:["slide","curve"],zmod:["vib","vibmod"],zcrush:["crush","distort"],zdelay:["delay","delaytime"],pitchjump:["pitchjumptime","penv"],pitchjumptime:["pitchjump"],lfo:["tremolo","vib"],octave:["transpose","note"],pw:["pwrate","pwsweep"],pwrate:["pw","pwsweep"],pwsweep:["pw","pwrate"],spread:["unison","pan"],unison:["spread"],isaw:["isaw2","itri","itri2"],isaw2:["isaw","itri","itri2"],itri:["isaw","isaw2","itri2"],itri2:["isaw","isaw2","itri"],tremolo:["tremolosync","tremolodepth","tremoloskew","tremolophase","tremoloshape","lfo"],tremolosync:["tremolo","tremolodepth"],tremolodepth:["tremolo","tremolosync"],tremoloskew:["tremolo","tremolophase"],tremolophase:["tremolo","tremoloshape"],tremoloshape:["tremolo","tremolophase"],choose:["wchoose","sometimes","rarely"],wchoose:["choose","sometimes"],choosecycles:["wchoosecycles","somecycles"],wchoosecycles:["choosecycles","somecycles"],degradeby:["degrade","sometimes"],degrade:["degradeby","sometimes"],undegradeby:["undegrade"],undegrade:["undegradeby"],sometimesby:["sometimes","rarely","often"],sometimes:["sometimesby","rarely","often","choose"],somecyclesby:["somecycles","choosecycles"],somecycles:["somecyclesby","choosecycles"],often:["sometimes","rarely","almostalways"],rarely:["sometimes","often","almostnever"],almostnever:["rarely","never"],almostalways:["often","always"],never:["almostnever"],always:["almostalways"],lastof:["firstof","when","mask"],firstof:["lastof","when","mask"],when:["lastof","firstof","mask","struct"],chunk:["chunkback","fastchunk","mask","struct"],chunkback:["chunk","fastchunk","mask"],fastchunk:["chunk","chunkback","mask"],arp:["arpwith","chord","voicing","note"],arpwith:["arp","chord"],struct:["mask","pick","when","beat"],mask:["struct","when","euclid","beat","chunk"],reset:["restart","pickreset"],restart:["reset","pickrestart"],hush:["silence"],invert:["rev","palindrome"],pick:["pickmod","pickf","pickmodf","struct","mask"],pickmod:["pick","pickmodf","struct"],pickf:["pick","pickmodf","struct"],pickmodf:["pick","pickf","struct"],pickrestart:["pickmodrestart","restart"],pickmodrestart:["pickrestart"],pickreset:["pickmodreset","reset"],pickmodreset:["pickreset"],inhabit:["inhabitmod","mask","struct"],inhabitmod:["inhabit","mask"],squeeze:["compress","segment"],superimpose:["layer","off","echo"],layer:["superimpose","off"],off:["superimpose","layer"],echo:["echowith","delay","superimpose"],echowith:["echo"],pace:["stepcat","stepalt","polymeter","slow","fast"],stepcat:["pace","stepalt","polymeter"],stepalt:["pace","stepcat"],expand:["contract","extend","take","drop"],contract:["expand","extend","take","drop"],extend:["expand","contract","take","drop"],take:["drop","extend","expand","contract"],drop:["take","extend","expand","contract"],polymeter:["pace","stepcat","slow","fast"],shrink:["grow","compress"],grow:["shrink","expand"],tour:["zip","iter"],zip:["tour","iter"],orientation:["acceleration","rotationx","rotationy","rotationz"],acceleration:["accelerationx","accelerationy","accelerationz","gravityx","gravityy","gravityz"],accelerate:["acceleration"],accelerationx:["accelerationy","accelerationz","gravityx"],accelerationy:["accelerationx","accelerationz","gravityy"],accelerationz:["accelerationx","accelerationy","gravityz"],rotationx:["rotationy","rotationz","orientation"],rotationy:["rotationx","rotationz","orientation"],rotationz:["rotationx","rotationy","orientation"],gravityx:["gravityy","gravityz","accelerationx"],gravityy:["gravityx","gravityz","accelerationy"],gravityz:["gravityx","gravityy","accelerationz"],mousex:["mousey","pan","range"],mousey:["mousex","gain","range"],osc:["mqtt"],mqtt:["osc"],midi:["midiport","midicmd","midibend","miditouch"],midiport:["midi"],midicmd:["midi"],midibend:["midi","miditouch"],miditouch:["midi","midibend"],midimap:["midimaps","defaultmidimap"],midimaps:["midimap","defaultmidimap"],defaultmidimap:["midimap","midimaps"],ccn:["ccv","control"],ccv:["ccn","control"],control:["ccn","ccv"],prognum:["midi"],sysex:["sysexid","sysexdata"],sysexid:["sysex","sysexdata"],sysexdata:["sysex","sysexid"],orbit:["duckorbit","pan"],scope:["fscope","pianoroll","spiral"],fscope:["scope","pianoroll"],pianoroll:["scope","fscope"],spiral:["scope"],pitchwheel:["penv"],color:["markcss"],markcss:["color"],vowel:["ftype","lpf"],speed:["slow","fast"],seg:["segment"],fancor:["lpf"],patt:["struct"],dec:["decay"],set:["struct"],irand:["rand","brand"]};function Fo(n){if(!n||typeof n!="string")return"";const e=n.replace(/^[.]+/,""),t=e.match(/^([a-zA-Z0-9_]+)/);return(t?t[1]:e).toLowerCase()}function _x(n){if(!n||typeof n!="string")return!1;if(Pb.includes(n))return!0;const e=n.toLowerCase();return j3e.some(t=>{const s=`.${t}`,r=`${t}(`;return e.includes(s)||e.includes(r)})}function Rx(n){if(!n||typeof n!="string")return"";const e=n.replace(/^[.]+/,"").toLowerCase();for(const[t,s]of V3e.entries()){const r=t.toLowerCase();if(e===r||e.includes(r))return s}return""}function hC(n){const e=document.createElement("div");return e.innerHTML=n||"",(e.textContent||e.innerText||"").trim()}let Ix=null,$0=null;async function dC(){return $0||(Ix||(Ix=ds(()=>import("./index-Dk-1TfF7.js"),[]).then(n=>{var s;const e=((s=n==null?void 0:n.reference)==null?void 0:s.docs)||{},t=new Map;for(const r of Object.values(e)){if(!r||!r.name)continue;const a=r.name.trim().toLowerCase();if(!a||t.has(a))continue;const i=Array.isArray(r.params)?r.params.map(o=>{var l;return{name:(o==null?void 0:o.name)||"",types:Array.isArray((l=o==null?void 0:o.type)==null?void 0:l.names)?o.type.names.slice():[],description:hC((o==null?void 0:o.description)||"")}}):[];t.set(a,{name:r.name.trim(),descriptionHtml:r.description||"",descriptionText:hC(r.description||""),params:i})}return t}).catch(n=>(console.warn("⚠️ Unable to load Strudel reference docs:",n),new Map))),$0=await Ix,$0)}function Lx(n){return n?(typeof n.descriptionText=="string"||(n.descriptionText=hC(n.descriptionHtml||"")),n.descriptionText):""}function ZG(n){if(!n)return null;const e=n.toLowerCase(),t=e.match(/between\s+([-\d.]+)\s+and\s+([-\d.]+)/);if(t)return`${t[1]}-${t[2]}`;const s=e.match(/([-\d.]+)\s*-\s*([-\d.]+)/);return s?`${s[1]}-${s[2]}`:null}function W3e(n){if(!n)return"";const e=n.name||"value",t=n.types||[],s=n.description||"",r=ZG(s);return t.includes("number")?r?`${e}:${r}`:`${e}:number`:t.includes("string")?`${e}`:t.includes("Pattern")?`${e}:pattern`:e}function Qx(n){if(!n)return"";const e=n.name||"value",t=n.types||[],s=n.description||"",r=ZG(s);return t.includes("number")?r?`${e} (number ${r})`:`${e} (number)`:t.includes("string")?`${e} (string)`:t.includes("Pattern")?`${e} (pattern)`:s?`${e} (${s})`:e}function V7(n,e){if(!n||typeof n!="string"||!n.endsWith("()"))return n;const t=(e==null?void 0:e.params)||[];if(!t.length)return n;const s=t.map(W3e).filter(Boolean);return s.length?`${n.slice(0,-1)}${s.join(", ")})`:n}let ta=null,cc=null,Z7=!1;function G3e(){if(ta&&document.body.contains(ta))return ta;if(ta=document.createElement("div"),ta.id="pattern-snippet-tooltip",ta.className="pattern-snippet-tooltip",ta.setAttribute("role","tooltip"),ta.setAttribute("aria-hidden","true"),document.body.appendChild(ta),!Z7){Z7=!0;const n=()=>Ra();window.addEventListener("scroll",n,!0),window.addEventListener("resize",n,{passive:!0}),document.addEventListener("keydown",e=>{e.key==="Escape"&&Ra()},!0)}return ta}function Ra(n=cc){ta&&(ta.classList.remove("visible"),ta.style.display="none",ta.style.visibility="hidden",ta.innerHTML="",ta.setAttribute("aria-hidden","true"),n&&n instanceof HTMLElement&&n.removeAttribute("aria-describedby"),cc&&cc!==n&&cc.removeAttribute("aria-describedby"),cc=null)}function jx(n){if(!n||!(n instanceof HTMLElement)||!document.body.contains(n))return;const e=G3e();cc&&cc!==n&&Ra(cc);const t=n.dataset.tooltipTitle||n.textContent||"",s=n.dataset.tooltipDescription||"",r=n.dataset.tooltipParams||"";if(e.innerHTML="",t){const m=document.createElement("div");m.className="pattern-snippet-tooltip-title",m.textContent=t,e.appendChild(m)}if(s){const m=document.createElement("div");m.className="pattern-snippet-tooltip-body",s.split(`
`).forEach((y,O)=>{const S=y.trim();S&&(O>0&&m.appendChild(document.createElement("br")),m.appendChild(document.createTextNode(S)))}),m.childNodes.length>0&&e.appendChild(m)}if(r){const m=document.createElement("div");m.className="pattern-snippet-tooltip-params",r.split(`
`).forEach(y=>{const O=y.trim();if(!O)return;const S=document.createElement("div");S.textContent=O,m.appendChild(S)}),m.childElementCount>0&&e.appendChild(m)}e.style.display="block",e.style.visibility="hidden",e.classList.remove("visible");const a=n.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth||0,o=window.innerHeight||document.documentElement.clientHeight||0,l=e.getBoundingClientRect(),c=8;let u=a.bottom+c;if(u+l.height>o-12){const m=a.top-l.height-c;m>=12?u=m:u=Math.max(12,o-l.height-12)}let h=a.left+a.width/2-l.width/2;const d=i-l.width-12;h>d&&(h=d),h<12&&(h=12),e.style.left=`${Math.round(h)}px`,e.style.top=`${Math.round(u)}px`,e.style.visibility="visible",e.classList.add("visible"),e.setAttribute("aria-hidden","false"),e.id||(e.id="pattern-snippet-tooltip"),n.setAttribute("aria-describedby",e.id),cc=n}let Vx=null,Zx=null,z7="",zx=null;function zG(n){return!n||typeof n!="string"?"":n.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").trim()}function X3e(n,e){if(!e)return n;const t=zG(e),s=new Set((t.match(/\.[a-zA-Z_][a-zA-Z0-9_]*/g)||[]).map(r=>Fo(r)));return n.filter(r=>{const a=Fo(r);return xm[a]?!0:!s.has(a)})}async function q7(n=""){const e=zG(n);if(e===z7&&zx)return zx;Zx||(Vx||(Vx=(async()=>{const a=new Map;L3e.forEach(O=>{const S=Fo(O);!a.has(S)&&O&&a.set(S,O)});const i=await dC();i.forEach((O,S)=>{a.has(S)||/^[a-z][\w]*$/i.test(O.name)&&a.set(S,`${O.name}()`)});const o=Vm.reduce((O,S)=>(O.set(S.id,{snippets:[]}),O),new Map),l=new Set(Pb.map(O=>Fo(O))),c=new Map;Array.from(a.entries()).sort((O,S)=>O[0].localeCompare(S[0])).forEach(([O,S])=>{const A=i.get(O),F=Vm.find(N=>N.exclude&&N.exclude.includes(O)?!1:N.matcher(O,S,A))||F0.get("other"),j=o.get(F.id);j&&j.snippets.push({snippet:S,groupId:F.id,className:F.className,heading:F.heading}),l.has(O)&&c.set(O,{snippet:S,groupId:F.id,className:F.className,heading:F.heading})});const u=Pb.map(O=>{const S=Fo(O);return c.get(S)||{snippet:O,groupId:"core",className:F0.get("core").className,heading:F0.get("core").heading}}).filter(Boolean).sort((O,S)=>O.snippet.localeCompare(S.snippet)),h=[],d=new Set;u.forEach(O=>{const{snippet:S,groupId:A,className:F,heading:j}=O;h.push({snippet:S,groupId:A,className:F,heading:j})}),[...Vm].sort((O,S)=>O.heading.localeCompare(S.heading)).forEach(O=>{const S=o.get(O.id);!S||!S.snippets.length||(d.has(O.id)||d.add(O.id),S.snippets.slice().sort((A,F)=>A.snippet.localeCompare(F.snippet)).forEach(({snippet:A,className:F,heading:j})=>{Pb.includes(A)||h.push({snippet:A,groupId:O.id,className:F,heading:j})}))});const y=F0.get("synths");return y&&Q3e.forEach(O=>{h.some(S=>S.snippet===O)||h.push({snippet:O,groupId:y.id,className:y.className,heading:y.heading})}),Zx=h,h})()),await Vx);const t=Zx||[],s=X3e(t.map(a=>a.snippet),e),r=t.filter(a=>s.includes(a.snippet));return z7=e,zx=r,r}function N0(n){if(!n||typeof n!="string")return n;const e=n.trim();return Og[e.toLowerCase()]||e}function U7(n){if(!n||typeof n!="string")return n;let e=n;for(const[t,s]of Object.entries(Og)){const r=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=new RegExp(`(\\.s\\(["'])${r}(["']\\))`,"gi");e=e.replace(a,(o,l,c)=>`${l}${s}${c}`);const i=new RegExp(`(sound\\(["'])${r}(["']\\))`,"gi");e=e.replace(i,(o,l,c)=>`${l}${s}${c}`)}return e}function H3e(n){if(!n||typeof n!="string")return!1;for(const e of I3e){const t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(new RegExp(`\\.s\\(["']${t}["']\\)`,"i").test(n))return!0}return/\b(note|n)\s*\(/.test(n)}function Y3e(n){if(!n||typeof n!="string")return"";const e=n.trim();if(!e)return"";if(e.includes("sound(")||e.includes("s(")||xi(e))return e;const t=e.split(/\s+/).filter(i=>i.trim()),s=[],r=[];for(const i of t)if(i)if(i.startsWith("."))r.push(i);else{const o=i.split("(")[0].trim();o&&(QG.hasOwnProperty(o.toLowerCase())||o.length>0)&&s.push(o)}if(s.length===0)return e;let a=`sound("${s.join(" ")}")`;return r.length>0&&(a+=r.join("")),a}function Po(n){let e=4,t=4;if(typeof n=="string"&&n.includes("/")){const[i,o]=n.split("/"),l=parseInt(i,10),c=parseInt(o,10);Number.isFinite(l)&&l>0&&(e=l),Number.isFinite(c)&&c>0&&(t=c)}const s=16/t,r=Math.max(1,Math.round(s)),a=Math.max(e,1)*r;return{signature:`${e}/${t}`,numerator:e,denominator:t,stepsPerBeat:r,totalSteps:a}}const K3e=(n,e,t,s)=>{const r=(n-90)*Math.PI/180;return[t+Math.cos(r)*e,s+Math.sin(r)*e]},W7=(n,e,t,s,r=0)=>{const a=(n+r)*360;return K3e(a,e*n,t,s)};function G7(n,e){let{from:t=0,to:s=3,margin:r=40,cx:a=100,cy:i=100,rotate:o=0,thickness:l=r/2,color:c="#4c51bf",cap:u="round",stretch:h=1,fromOpacity:d=1,toOpacity:m=1}=e;t*=h,s*=h,o*=h,n.lineWidth=l,n.lineCap=u,n.strokeStyle=c,n.globalAlpha=d,n.beginPath();let[y,O]=W7(t,r,a,i,o);n.moveTo(y,O);const S=1/60;let A=t;for(;A<=s;){const[F,j]=W7(A,r,a,i,o);n.globalAlpha=(A-t)/(s-t)*m,n.lineTo(F,j),A+=S}n.stroke(),n.globalAlpha=1}const J3e=4,e5e=2;class X7{constructor(){ys=this,this.activeElements=new Set,this.initialized=!1,this.currentEditingElementId=null,this.mutedElements=new Set,this.soloedElements=new Set,this.isMobileView=typeof window<"u"?window.matchMedia("(max-width: 640px)").matches:!1,this.initialElementCount=this.isMobileView?e5e:J3e,this.elementCounter=this.initialElementCount,this.masterActive=!1,this.masterPatternField=null,this._applyingVisualizer=!1,this.elementMidiSettings=this.loadStoredMidiSettings(),this.currentTimeSignature="4/4",this.currentTimeSignatureMetrics=Po(this.currentTimeSignature),this.masterPunchcardContainer=null,this.masterPunchcardHeaderNote=null,this.masterPunchcardCanvas=null,this.masterPunchcardCtx=null,this.masterPunchcardPlaceholder=null,this.masterPunchcardIsRendering=!1,this.masterPunchcardPendingRefresh=!1,this.masterPunchcardResizeTimer=null,this.externalVisualizerCanvas=null,this.externalVisualizerObserver=null,this.externalVisualizerType=null,this.scopeAnimationFrame=null,this.barchartAnimationFrame=null,this.cameraBlendAnimationFrame=null,this.scopeDataArray=null,this.spectrumDataArray=null,this.activeVisualizerLoop=null,this.introSamplePlayed=!1,this._introSampleActivationHandler=null,this.nativeHighlightingEnabled=!1,this.nativeHighlightingDisabled=!1,this.nativeHighlightRetryCount=0,this.nativeHighlightRetryTimer=null,this.visualizerFullscreenBtn=null,this.handleVisualizerFullscreenChange=this.handleVisualizerFullscreenChange.bind(this),document.addEventListener("fullscreenchange",this.handleVisualizerFullscreenChange),document.addEventListener("webkitfullscreenchange",this.handleVisualizerFullscreenChange),document.addEventListener("mozfullscreenchange",this.handleVisualizerFullscreenChange),document.addEventListener("MSFullscreenChange",this.handleVisualizerFullscreenChange),this.chaospadEnabled=!1,this.currentCutoffValue=null,this.lastCutoffUpdate=null,this.currentResonanceValue=null,this.lastResonanceUpdate=null,this.currentVolumeValue=null,this.lastVolumeUpdate=null,this.currentPanValue=null,this.lastPanUpdate=null,this.currentDelayAmountValue=null,this.lastDelayAmountUpdate=null,this.currentDelayFeedbackValue=null,this.lastDelayFeedbackUpdate=null,this.currentReverbAmountValue=null,this.lastReverbAmountUpdate=null,this.currentReverbRoomSizeValue=null,this.lastReverbRoomSizeUpdate=null,this.chaospadSettings={minFrequency:le.masterFilterMinHz||80,maxFrequency:le.masterFilterMaxHz||8e3,minResonance:le.masterFilterMinQ||.1,maxResonance:le.masterFilterMaxQ||5,xAxis:{effect:"cutoff",min:le.masterFilterMinHz||80,max:le.masterFilterMaxHz||8e3},yAxis:{effect:"resonance",min:le.masterFilterMinQ||.1,max:le.masterFilterMaxQ||5}},this.chaospadDefaults={cutoff:Math.min(this.chaospadSettings.maxFrequency,Math.max(this.chaospadSettings.minFrequency,le.masterFilterFrequency||4040)),resonance:Math.min(this.chaospadSettings.maxResonance,Math.max(this.chaospadSettings.minResonance,le.masterFilterResonance||.7)),volume:le.masterVolume||.7,pan:le.masterPan||0,delayAmount:le.masterDelayAmount||0,delayFeedback:le.masterDelayFeedback||.5,reverbAmount:le.masterReverbAmount||0,reverbRoomSize:le.masterReverbRoomSize||.5},this.chaospadOrientationActive=!1,this.chaospadOrientationPermission="unknown",this.chaospadVirtualGravity={x:0,y:0},this.chaospadTiltAvailable=!1,typeof window<"u"&&(typeof window.gravityX>"u"&&(window.gravityX=0),typeof window.gravityY>"u"&&(window.gravityY=0)),this.handleChaospadOrientation=this.handleChaospadOrientation.bind(this),this.collabUnsubscribers=[],this.masterUpdateQueue=[],this.masterUpdateTimer=null,this.topTracks=[],this.visualizerTextInterval=null,this.hasGdprConsent=this.getStoredGdprConsent(),this.postConsentReady=!1,this.gdprOverlay=null,this.gdprAcceptButton=null,this.cameraEnabled=!1,this.cameraStream=null,this.cameraVideo=null,this.cameraBlendValue=.5,this.cameraAvailable=!1,this.cameraBlendSlider=null,this.cameraBlendSliderMobile=null,this.isMobileView&&this.limitInitialElementsForMobile()}limitInitialElementsForMobile(){const e=document.querySelector(".elements-container");e&&Array.from(e.querySelectorAll(".sound-element")).slice(this.initialElementCount).forEach(s=>s.remove()),Array.isArray(hs.elements)&&hs.elements.length>this.initialElementCount&&hs.elements.splice(this.initialElementCount)}updateMobileOrientationLock(){const e=screen==null?void 0:screen.orientation;!this.isMobileView||!e||typeof e.lock!="function"||(this.chaospadEnabled?e.lock("portrait").catch(()=>{}):typeof e.unlock=="function"&&e.unlock())}setChaospadTiltAvailability(e){this.chaospadTiltAvailable=!!e,this.refreshTiltControlsState(),this.syncTiltSlidersFromGravity()}refreshTiltControlsState(){const e=document.getElementById("chaospad-tilt-inline");if(!e)return;const t=this.chaospadEnabled&&this.chaospadTiltAvailable;e.classList.toggle("active",t),e.querySelectorAll('input[type="range"]').forEach(s=>{s.disabled=!t}),this.updateTiltValueLabels()}updateTiltValueLabels(){const e=document.getElementById("chaospad-tilt-x"),t=document.getElementById("chaospad-tilt-y"),s=document.getElementById("chaospad-tilt-x-value"),r=document.getElementById("chaospad-tilt-y-value");if(e&&s){const a=parseInt(e.value,10)||0;s.textContent=`${a}°`}if(t&&r){const a=parseInt(t.value,10)||0;r.textContent=`${a}°`}}applyTiltFromSliders(){if(!this.chaospadEnabled)return;const e=document.getElementById("chaospad-tilt-x"),t=document.getElementById("chaospad-tilt-y");if(!e||!t)return;const s=parseFloat(e.value)||0,r=parseFloat(t.value)||0,a=(s+45)/90,i=1-(r+45)/90;this.applyChaospadInputFromPercentages(a,i,"slider")}syncTiltSlidersFromGravity(e="mouse"){if(e==="slider")return;const t=document.getElementById("chaospad-tilt-x"),s=document.getElementById("chaospad-tilt-y");if(!t||!s||t.disabled)return;const r=this.chaospadVirtualGravity||{x:0,y:0},a=Math.max(-45,Math.min(45,Math.round((r.x||0)*45))),i=(r.y+1)/2,o=Math.max(-45,Math.min(45,Math.round((1-i)*90-45)));t.value=a,s.value=o,this.updateTiltValueLabels()}async loadTopTracks(e=5){const t=document.getElementById("top-tracks-list"),s=document.getElementById("top-tracks-empty");if(!(!t||!s)){s.style.display="block",s.textContent="Loading top tracks…",t.innerHTML="";try{const r=await gc.getTopTracks(e);if(this.topTracks=r,!r.length){s.textContent="No public tracks yet. Save a track to be featured.";return}s.style.display="none",t.innerHTML=r.map((a,i)=>this.renderTopTrackCard(a,i)).join(""),t.querySelectorAll("[data-track-index]").forEach(a=>{a.addEventListener("click",()=>{const i=Number(a.dataset.trackIndex),o=this.topTracks[i];o&&this.applyTopTrackToMaster(o)})})}catch(r){console.error("Failed to load top tracks:",r),s.style.display="block",s.textContent="Unable to load top tracks. Please try again later."}}}renderTopTrackCard(e,t){var O,S,A,F,j,N,$,L,I;const s=((O=e.title)==null?void 0:O.trim())||"Untitled Track",r=((S=e.artistName)==null?void 0:S.trim())||((A=e.user)==null?void 0:A.artistName)||((F=e.user)==null?void 0:F.name)||"Unknown Artist",a=((j=e.genre)==null?void 0:j.trim())||"Uncategorized",i=((N=e.analytics)==null?void 0:N.masterLoadCount)??0,o=((L=($=e.metadata)==null?void 0:$.imageUrl)==null?void 0:L.trim())||((I=e.user)==null?void 0:I.avatarUrl)||"",l=s.charAt(0).toUpperCase(),c=!!o,u=this.escapeHtml(s),h=this.escapeHtml(r),d=this.escapeHtml(a),m=this.escapeHtml(o),y=`${i} ${i===1?"add":"adds"}`;return`
      <button type="button" class="top-track-card" data-track-index="${t}" data-track-id="${e.id||""}">
        <div class="top-track-image ${c?"":"fallback"}">
          ${c?`<img src="${m}" alt="${u} cover art" loading="lazy" onerror="this.parentElement.classList.add('fallback'); this.remove();">`:""}
          <span class="top-track-placeholder">${this.escapeHtml(l)}</span>
        </div>
        <div class="top-track-info">
          <h4>${u}</h4>
          <p class="top-track-artist">${h}</p>
          <span class="top-track-genre">${d}</span>
          <span class="top-track-count">${y}</span>
        </div>
      </button>
    `}applyTopTrackToMaster(e){if(!(e!=null&&e.patternCode))return;const t=e.patternCode.trim();Ln("master-pattern",t),le.setMasterPatternCode(t),this.updateMasterPatternDisplay();const s=e.title||"Untitled Track";gs.updateStatus(`Loaded “${s}” into master`),e.id&&gc.recordMasterLoad(e.id).then(r=>{const a=(r==null?void 0:r.masterLoadCount)??null;a!==null&&this.updateTopTrackLoadCount(e.id,a)}).catch(r=>{console.warn("⚠️ Failed to record master load:",(r==null?void 0:r.message)||r)})}updateTopTrackLoadCount(e,t){if(!e||t===void 0||t===null)return;Array.isArray(this.topTracks)&&(this.topTracks=this.topTracks.map(r=>r.id===e?{...r,analytics:{...r.analytics||{},masterLoadCount:t}}:r));const s=document.querySelector(`.top-track-card[data-track-id="${e}"] .top-track-count`);s&&(s.textContent=`${t} ${t===1?"add":"adds"}`)}startVisualizerTitleLoop(){if(this.visualizerTextInterval)return;const e=document.querySelectorAll("[data-visualizer-label]");if(!e.length)return;const t=[{text:"STRUDESK 4000",className:"punchcard-logo--latin",lang:"en"},{text:"스트루데스크 4000",className:"punchcard-logo--korean",lang:"ko"}],s=Array.from(new Set(t.map(i=>i.className).filter(Boolean)));let r=0;const a=()=>{const i=t[r];e.forEach(o=>{s.forEach(l=>o.classList.remove(l)),i.className&&o.classList.add(i.className),i.lang?o.setAttribute("lang",i.lang):o.removeAttribute("lang"),o.textContent=i.text}),r=(r+1)%t.length};a(),this.visualizerTextInterval=window.setInterval(a,5e3)}escapeHtml(e=""){const t=document.createElement("div");return t.textContent=e??"",t.innerHTML}async init(){le.appInstance=this,this.startVisualizerTitleLoop(),this.setupGdprConsentFlow(),gs.onUpdate("tempo",h=>{le.setTempo(h)}),gs.onUpdate("key",h=>{le.setKey(h),console.log(`🎹 Key changed to: ${h}`)}),gs.onUpdate("scale",h=>{le.setScale(h),console.log(`🎼 Scale changed to: ${h||"(none)"}`)}),gs.onUpdate("timeSignature",h=>{if(this.currentTimeSignature=h||"4/4",this.currentTimeSignatureMetrics=Po(this.currentTimeSignature),le.setTimeSignature(h),console.log(`🎵 Time signature changed to: ${h}`),typeof this.applyTimeSignatureToDrumGrid=="function")try{this.applyTimeSignatureToDrumGrid(this.currentTimeSignature)}catch(d){console.warn("⚠️ Could not update drum grid for new time signature:",d)}this.refreshMasterPunchcard("time-signature-change").catch(d=>{console.warn("⚠️ Could not refresh punchcard after time signature change:",d)})}),gs.setSoundTrigger((h,d)=>{le.isAudioReady()&&(d.type==="synthesized"?le.playSynthesizedSound(h,d.pattern).catch(m=>{console.error(`Error triggering control sound for ${h}:`,m)}):d.type==="strudel"&&le.playStrudelPattern(h,d.pattern).catch(m=>{console.error(`Error triggering control sound for ${h}:`,m)}))}),this.registerElements(),this.setupElementControls(),le.onSoundsReady(()=>{console.log("🎉 Sounds are ready - activating green dots"),this.setAllElementsLoaded(),gs.updateStatus("Ready - Click elements to start/stop patterns (Press Escape to stop all)"),this.enableNativeStrudelHighlighting()}),le.onMasterPatternUpdate(async()=>{console.log("🔄 Master pattern updated - refreshing display"),this.updateMasterPatternDisplay(),this.updateActiveElementsDisplay(),this.refreshMasterPunchcard("master-update").catch(h=>{console.warn("⚠️ Could not refresh punchcard after master update:",h)})}),le.onMasterStateChange((h,d)=>{console.log(`🎚️ Master state changed: ${h?"playing":"stopped"}, elements: ${d.join(", ")}`),this.masterActive=h;const m=document.getElementById("play-master-btn"),y=document.querySelector(".master-active-dot");m&&(h?(m.textContent="❚❚",m.title="Pause Master",m.classList.add("active")):(m.textContent="▶",m.title="Play Master",m.classList.remove("active"))),y&&(h?y.classList.add("active"):y.classList.remove("active")),h?gs.updateStatus("Playing Master"):this.activeElements.size>0||gs.updateStatus("Ready - Click elements to start/stop patterns (Press Escape to stop all)");const O=document.getElementById("pattern-slots");O&&(O.style.display=h?"none":"block"),d.forEach(S=>{this.updateStatusDots(S,!0,h)}),h||document.querySelectorAll(".element-circle").forEach(S=>{S.classList.remove("playing")}),h?(this.selectedVisualizer==="off"?this.showMasterPunchcardPlaceholder():this.hideMasterPunchcardPlaceholder(),this.enableNativeStrudelHighlighting()):this.selectedVisualizer==="off"?this.showMasterPunchcardPlaceholder():this.hideMasterPunchcardPlaceholder()}),this.setupMasterChannel();const e=h=>{console.log("Key pressed:",h.key),(h.key==="Escape"||h.keyCode===27)&&(console.log("🛑 Emergency stop activated (Escape key pressed)"),h.preventDefault(),h.stopPropagation(),le.stopAllSounds(),gs.updateStatus("🛑 All sounds stopped"),this.activeElements.clear(),this.updateActiveElementsDisplay(),hs.elements.forEach(d=>{const m=this.elementHasPattern(d.id);this.updateStatusDots(d.id,m,!1)}))};document.addEventListener("keydown",e,!0),window.addEventListener("keydown",e,!0),console.log("✅ Escape key handler registered");let t=null;const s=h=>{(h.key==="s"||h.key==="S")&&h.shiftKey&&!h.ctrlKey&&!h.metaKey&&!h.altKey&&(h.preventDefault(),t||(t=new Audio(Tx),t.volume=.7),t.currentTime=0,t.play().catch(d=>{console.warn("⚠️ Could not play Shift+S sound:",d)}))};document.addEventListener("keydown",s,!0),window.addEventListener("keydown",s,!0),console.log("✅ Shift+S key sound handler registered");const r=new Set,a={c:"C",d:"D",e:"E",f:"F",g:"G",a:"A",b:"B"},i={C:"C#",D:"D#",F:"F#",G:"G#",A:"A#"},o={C:"Db",D:"Eb",F:"Gb",G:"Ab",A:"Bb"},l=async h=>{const d=h.key.toLowerCase(),m=a.hasOwnProperty(d),y=/^[0-9]$/.test(d);if((m||y||(d==="+"||d==="="))&&r.add(d),m&&!h.repeat){const S=h.shiftKey,A=h.ctrlKey||h.metaKey;let F=a[d];S&&i.hasOwnProperty(F)?F=i[F]:A&&o.hasOwnProperty(F)&&(F=o[F]);let j=3;for(const L of r)if(/^[0-9]$/.test(L)){j=parseInt(L,10);break}const N=document.activeElement,$=N&&(N.tagName==="INPUT"||N.tagName==="TEXTAREA"||N.isContentEditable);if(le.isAudioReady()&&!$){h.preventDefault();const L=`${F}${j}`,I="keyboard-piano",q=r.has("+")||r.has("=");if(le.trackedPatterns.has(I)){const ce=le.trackedPatterns.get(I);let ee=(ce==null?void 0:ce.rawPattern)||(ce==null?void 0:ce.pattern)||"";if(q&&ee){const he=ee.match(/note\s*\(\s*["']([^"']+)["']/);if(he){const me=`${he[1]} ${L}`;ee=ee.replace(/note\s*\(\s*["']([^"']+)["']/,`note("${me}"`)}else ee=`note("${L}").s("piano")`}else ee=`note("${L}").s("piano")`;await le.updatePatternInPlace(I,ee),this.updateMasterPatternDisplay&&this.updateMasterPatternDisplay()}else{const ce=`note("${L}").s("piano")`;await le.saveElementToMaster(I,ce,.8,0),this.updateMasterPatternDisplay&&this.updateMasterPatternDisplay()}}}},c=h=>{const d=h.key.toLowerCase();(a.hasOwnProperty(d)||/^[0-9]$/.test(d)||d==="+"||d==="=")&&r.delete(d)};document.addEventListener("keydown",l,!0),document.addEventListener("keyup",c,!0),window.addEventListener("keydown",l,!0),window.addEventListener("keyup",c,!0),console.log("✅ Keyboard piano handler registered");const u=document.getElementById("stop-all-btn");u?(u.addEventListener("click",()=>{console.log("🛑 Stop All button clicked"),le.stopAllSounds(),gs.updateStatus("🛑 All sounds stopped"),this.activeElements.clear(),this.updateActiveElementsDisplay(),hs.elements.forEach(h=>{const d=this.elementHasPattern(h.id);this.updateStatusDots(h.id,d,!1)})}),console.log("✅ Stop All button handler registered")):console.warn("⚠️ Stop All button not found in DOM"),this.initialized=!0,this.setAllElementsNotLoaded(),this.migrateLocalStorageQuotes(),this.loadAllElementConfigs(),this.setupModal(),this.setupAddElementButton(),gs.updateStatus("Ready - Click anywhere to enable audio (Press Escape to stop all sounds)"),setTimeout(()=>{try{Zpe(),this.enableNativeStrudelHighlighting()}catch(h){console.warn("⚠️ Strudel REPL editor initialization failed (non-critical):",h.message),console.log("💡 Pattern editing will use plain textareas instead")}},100),this.setupCollaborationBridge(),console.log("Interactive Sound App initialized"),console.log("💡 Tip: Press Escape key or click Stop All button to silence everything")}initializeElementVisualizations(e=null,t=null){(e?[e]:document.querySelectorAll(".sound-element")).forEach(r=>{const a=t||r.dataset.soundId;if(!a)return;r.querySelector(".config-button");const i=this.loadElementConfig(a);if(i&&i.pattern&&i.pattern.trim()!==""){const l=i.title&&i.title.trim()?i.title:i.bank?jm[i.bank]||i.bank:"";Vi(a,l)}else Vi(a,"")})}setupMasterChannel(){const e=document.getElementById("master-volume"),t=document.getElementById("master-pan"),s=document.getElementById("master-mute-btn"),r=document.getElementById("master-volume-value"),a=document.getElementById("master-pan-value");if(e){const i=parseFloat(e.value);le.masterVolume=i/100,r&&(r.textContent=Math.round(i)),console.log(`🎚️ Master volume slider initialized: ${i}% (${le.masterVolume})`),e.addEventListener("input",o=>{const l=parseFloat(o.target.value);console.log(`🎚️ Master volume slider changed: ${l}%`),le.setMasterVolume(l/100),r&&(r.textContent=Math.round(l)),le.updateMasterPattern(this.soloedElements,this.mutedElements)}),le.isAudioReady()&&le.masterGainNode?(console.log(`🎚️ Audio already ready, setting master volume to ${i}%`),le.setMasterVolume(i/100)):console.log("🎚️ Audio not ready yet, master volume will be set on initialization")}else console.warn("⚠️ Master volume slider not found in DOM");if(t){const i=parseFloat(t.value);le.masterPan=i,a&&(a.textContent=i.toFixed(2)),console.log(`🎚️ Master pan slider initialized: ${i}`),t.addEventListener("input",o=>{const l=parseFloat(o.target.value);console.log(`🎚️ Master pan slider changed: ${l}`),le.setMasterPan(l),a&&(a.textContent=l.toFixed(2)),le.updateMasterPattern(this.soloedElements,this.mutedElements)}),le.isAudioReady()&&le.masterPanNode?(console.log(`🎚️ Audio already ready, setting master pan to ${i}`),le.setMasterPan(i)):console.log("🎚️ Audio not ready yet, master pan will be set on initialization")}else console.warn("⚠️ Master pan slider not found in DOM");s&&s.addEventListener("click",()=>{console.log("🎚️ Master mute button clicked");const i=le.toggleMasterMute();s.textContent=i?"🔇":"🔊",s.title=i?"Unmute Master":"Mute Master",console.log(`🎚️ Master mute toggled: ${i?"MUTED":"UNMUTED"}`)}),this.setupMasterPatternControls(),this.setupMasterPunchcard(),console.log("✅ Master channel controls setup complete")}tryPlayIntroSample(){if(this.introSamplePlayed||!Tx||!le)return;const e=typeof le.getAudioContext=="function"?le.getAudioContext():null,t=le.isAudioReady()&&e,s=()=>{try{le.playAudioFile("intro-sample",Tx),this.introSamplePlayed=!0,this.detachIntroSampleActivationHandlers()}catch(r){console.warn("⚠️ Unable to play intro sample automatically:",r)}};t?e.state!=="running"?e.resume().then(()=>{s()}).catch(r=>{console.warn("⚠️ Unable to resume audio context for intro sample:",r),this.attachIntroSampleActivationHandlers()}):s():this.attachIntroSampleActivationHandlers()}attachIntroSampleActivationHandlers(){this._introSampleActivationHandler||this.introSamplePlayed||(this._introSampleActivationHandler=()=>{if(le!=null&&le.getAudioContext){const e=le.getAudioContext();e&&e.state==="suspended"&&e.resume().catch(()=>{})}this.tryPlayIntroSample()},document.addEventListener("pointerdown",this._introSampleActivationHandler,{passive:!0}),document.addEventListener("keydown",this._introSampleActivationHandler))}detachIntroSampleActivationHandlers(){this._introSampleActivationHandler&&(document.removeEventListener("pointerdown",this._introSampleActivationHandler),document.removeEventListener("keydown",this._introSampleActivationHandler),this._introSampleActivationHandler=null)}setupMasterPatternControls(){this.masterPatternField=document.getElementById("master-pattern");const e=document.getElementById("play-master-btn"),t=document.getElementById("update-master-btn"),s=document.querySelector(".master-active-dot");if(!this.masterPatternField){console.warn("⚠️ Master pattern field not found in DOM");return}if(e){const o=async l=>{var c,u,h,d,m,y,O;if(console.log(`▶️ [PLAY] Event: ${l.type}, masterActive: ${this.masterActive}`),console.log(`▶️ [PLAY] Audio ready: ${le.isAudioReady()}, context: ${!!le.audioContext}, state: ${((c=le.audioContext)==null?void 0:c.state)||"N/A"}`),console.log(`▶️ [PLAY] Strudel loaded: ${le.strudelLoaded}, scheduler: ${!!((u=window.strudel)!=null&&u.scheduler)}, started: ${((d=(h=window.strudel)==null?void 0:h.scheduler)==null?void 0:d.started)||!1}`),l.type==="touchstart"&&le.audioContext)if(l.preventDefault(),le.audioContext.state!=="running"){console.log("🎵 [PLAY] Touch: Resuming audio context immediately...");try{await le.audioContext.resume(),console.log(`🎵 [PLAY] Touch: Audio context resumed, state: ${le.audioContext.state}`)}catch(S){console.error("🎵 [PLAY] Touch: Could not resume in touch handler:",S)}}else console.log("🎵 [PLAY] Touch: Audio context already running");else l.type==="touchstart"&&(l.preventDefault(),console.log("🎵 [PLAY] Touch: No audio context yet, will initialize in playMasterPattern"));if(this.masterActive)console.log("⏸️ Pause Master button clicked"),(await le.stopMasterPattern()).success&&(this.masterActive=!1,le.masterActive=!1,e.textContent="▶",e.title="Play Master",e.classList.remove("active"),s&&s.classList.remove("active"),console.log("✅ Master playback paused"));else{console.log("▶️ Play Master button clicked");const S="modal-preview";if(le.isPlaying(S)){console.log("⏹️ Stopping modal preview before playing master"),le.stopSound(S);const j=document.getElementById("modal-preview-btn");j&&(j.textContent="▶ Preview Pattern",j.classList.remove("active"))}const A=In("master-pattern").trim();if(A&&A!==le.getMasterPatternCode()){if(le.masterPattern=le.formatMasterPatternWithTempoComment(A),typeof this.syncElementsFromMasterPattern=="function")try{this.syncElementsFromMasterPattern(le.masterPattern)}catch(j){console.warn("⚠️ Could not sync elements from master code before play:",j)}console.log("📝 Updated master pattern code directly before playing")}this.selectedVisualizer&&this.selectedVisualizer!=="punchcard"&&this.selectedVisualizer!=="off"?(console.log(`🎨 Preparing canvas for visualizer "${this.selectedVisualizer}"`),await this.prepareCanvasForExternalVisualizer()):this.showMasterPunchcardPlaceholder(),console.log(`🎨 Applying visualizer "${this.selectedVisualizer||"off"}" before playing`);try{await this.applyVisualizerToMaster()}catch(j){console.warn("⚠️ Error applying visualizer, continuing with playback:",j)}console.log("▶️ [PLAY] Calling playMasterPattern...");const F=await le.playMasterPattern();console.log("▶️ [PLAY] playMasterPattern result:",F),console.log(`▶️ [PLAY] After playMasterPattern - audioContext state: ${((m=le.audioContext)==null?void 0:m.state)||"N/A"}`),console.log(`▶️ [PLAY] After playMasterPattern - scheduler started: ${((O=(y=window.strudel)==null?void 0:y.scheduler)==null?void 0:O.started)||!1}`),F.success?(this.masterActive=!0,e.textContent="❚❚",e.title="Pause Master",e.classList.add("active"),s&&s.classList.add("active"),console.log("✅ [PLAY] Master playback started"),setTimeout(()=>{var j,N,$;console.log(`▶️ [PLAY] Post-start check - audioContext state: ${((j=le.audioContext)==null?void 0:j.state)||"N/A"}`),console.log(`▶️ [PLAY] Post-start check - scheduler started: ${(($=(N=window.strudel)==null?void 0:N.scheduler)==null?void 0:$.started)||!1}`),le.audioContext&&le.audioContext.state!=="running"&&console.error("❌ [PLAY] Audio context not running after start!")},500)):(console.error("❌ [PLAY] Failed to play master:",F.error),alert(`Failed to play master: ${F.error}`))}};e.addEventListener("click",o),e.addEventListener("touchstart",o,{passive:!1}),this._masterSpacebarHandlerAttached||(this._masterSpacebarHandlerAttached=!0,document.addEventListener("keydown",async l=>{var d;if(l.code!=="Space")return;const c=document.activeElement,u=(d=c==null?void 0:c.tagName)==null?void 0:d.toLowerCase();c!=null&&c.isContentEditable||u==="textarea"||u==="input"&&(c==null?void 0:c.type)!=="button"&&(c==null?void 0:c.type)!=="checkbox"&&(c==null?void 0:c.type)!=="range"||u==="select"||(l.preventDefault(),e.click())}))}const r=document.getElementById("export-audio-btn");r&&r.addEventListener("click",async()=>{if(console.log("🎵 Export Audio button clicked"),!le.getMasterPatternCode()||le.getMasterPatternCode().trim()===""){alert("No master pattern to export. Please create a pattern first.");return}const o=prompt("Enter export duration in seconds (default: 16):","16");if(o===null)return;const l=parseInt(o)||16;r.disabled=!0,r.textContent="⏳ Exporting...";try{const c=await le.exportAudioWAV(l);c.success?(c.warning?alert(`⚠️ Audio exported as ${c.format.toUpperCase()}!

${c.warning}`):alert(`✅ Audio exported successfully as ${c.format.toUpperCase()}!`),console.log("✅ Audio export complete")):(alert(`❌ Export failed: ${c.error}`),console.error("❌ Audio export failed:",c.error))}catch(c){alert(`❌ Export error: ${c.message}`),console.error("❌ Audio export error:",c)}finally{r.disabled=!1,r.textContent="🎵 Export Audio"}}),t&&t.addEventListener("click",async()=>{console.log("💾 Update Master button clicked");const o=In("master-pattern").trim();if(!o){alert("Master pattern is empty");return}const l=await le.setMasterPatternCode(o);l.success?(console.log("✅ Master pattern code updated"),alert("Master pattern updated successfully!")):(console.error("❌ Failed to update master:",l.error),alert(`Failed to update master: ${l.error}`))});const a=document.getElementById("copy-code-btn");a&&a.addEventListener("click",async()=>{const o=this.masterPatternField.value.trim();if(!o){alert("Master pattern is empty");return}try{const l="// Created with Strudesk 4000 by eKommissar",c=o.startsWith(l)?o:`${l}

${o}`;await navigator.clipboard.writeText(c);const u=a.textContent;a.textContent="✓ Copied!",a.title="Copied!",setTimeout(()=>{a.textContent=u,a.title="Copy"},2e3),console.log("✅ Master pattern code copied to clipboard")}catch(l){console.error("❌ Failed to copy code:",l),alert("Failed to copy code to clipboard")}});const i=document.getElementById("clear-all-btn");i&&i.addEventListener("click",()=>{confirm("Are you sure you want to clear all? This will clear the master pattern and all element configurations.")&&(console.log("🗑️ Clear All button clicked"),this.resetAll())}),console.log("✅ Master pattern controls setup complete")}setupMasterPunchcard(){if(this.masterPunchcardContainer=document.getElementById("master-punchcard"),this.masterPunchcardCanvas=document.getElementById("master-punchcard-canvas"),this.masterPunchcardPlaceholder=this.masterPunchcardContainer?this.masterPunchcardContainer.querySelector(".punchcard-placeholder"):null,!this.masterPunchcardContainer||!this.masterPunchcardCanvas){console.warn("⚠️ Master punchcard elements not found in DOM");return}const e=this.getMasterPunchcardContext();e&&(window.__strudelVisualizerCtx=e),this.selectedVisualizer="off";const t=document.getElementById("visualizer-select");this.visualizerSelect=t,t&&(t.value=this.selectedVisualizer,t.addEventListener("change",async l=>{this.selectedVisualizer=l.target.value,console.log(`🎨 Visualizer changed to: ${this.selectedVisualizer}`),this.selectedVisualizer!=="off"&&!this.cameraEnabled?await this.requestCameraAccess()&&(this.cameraEnabled=!0):this.selectedVisualizer!=="off"&&this.cameraEnabled&&this.cameraVideo?this.cameraVideo.paused&&this.cameraVideo.play().catch(c=>{console.warn("⚠️ Could not play camera video when enabling visualizer:",c)}):this.selectedVisualizer==="off"&&this.cameraEnabled&&this.stopCamera(),this.updateCameraControlsVisibility(),this.selectedVisualizer==="off"?this.showMasterPunchcardPlaceholder():this.selectedVisualizer!=="punchcard"?await this.prepareCanvasForExternalVisualizer():this.showMasterPunchcardPlaceholder(),await this.applyVisualizerToMaster(),this.refreshMasterPunchcard("visualizer-change").catch(c=>{console.warn("⚠️ Unable to refresh punchcard after visualizer change:",c)})})),this.visualizerFullscreenBtn=document.getElementById("visualizer-fullscreen-btn"),this.visualizerFullscreenBtn&&(this.visualizerFullscreenBtn.addEventListener("click",()=>{this.toggleVisualizerFullscreen()}),this.updateVisualizerFullscreenButton(!1)),this.cameraBlendSlider=document.getElementById("camera-blend-slider");const s=document.getElementById("camera-blend-value");document.getElementById("camera-blend-control"),this.cameraBlendSliderMobile=document.getElementById("camera-blend-slider-mobile");const r=document.getElementById("camera-blend-value-mobile");document.getElementById("camera-blend-control-mobile"),this.checkCameraAvailability(),this.updateCameraControlsVisibility(),this.cameraBlendSlider&&s&&(this.cameraBlendSlider.addEventListener("input",l=>{const c=parseInt(l.target.value,10);this.cameraBlendValue=c/100,s.textContent=`${c}%`,this.cameraBlendSliderMobile&&(this.cameraBlendSliderMobile.value=c),r&&(r.textContent=`${c}%`)}),s.textContent=`${parseInt(this.cameraBlendSlider.value,10)}%`),this.cameraBlendSliderMobile&&r&&(this.cameraBlendSliderMobile.addEventListener("input",l=>{const c=parseInt(l.target.value,10);this.cameraBlendValue=c/100,r.textContent=`${c}%`,this.cameraBlendSlider&&(this.cameraBlendSlider.value=c),s&&(s.textContent=`${c}%`)}),r.textContent=`${parseInt(this.cameraBlendSliderMobile.value,10)}%`),document.addEventListener("visibilitychange",()=>{document.hidden&&this.cameraEnabled&&this.cameraStream?this.cameraStream.getTracks().forEach(l=>{l.enabled=!1}):!document.hidden&&this.cameraEnabled&&this.cameraStream&&(this.cameraStream.getTracks().forEach(l=>{l.enabled=!0}),this.cameraVideo&&this.cameraVideo.paused&&this.cameraVideo.play().catch(l=>{console.warn("⚠️ Could not resume camera video playback:",l)}))});const a=document.getElementById("chaospad-checkbox");a&&a.addEventListener("change",async l=>{const c=this.chaospadEnabled;this.chaospadEnabled=l.target.checked,console.log(`🎛️ Chaospad ${this.chaospadEnabled?"enabled":"disabled"}`),this.updateMobileOrientationLock(),this.refreshTiltControlsState(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.cursor=this.chaospadEnabled?"pointer":""),this.chaospadEnabled?(console.log("🎛️ Chaospad: Enabled - activating master filter with defaults"),c||this.updateChaospadDefaultsFromCurrent(),le.enableMasterFilter(!0),this.resetChaospadToDefaults(!0),this.isMobileView&&this.showChaospadMobileNotification()):(console.log("🎛️ Chaospad: Disabled - restoring defaults"),this.restoreChaospadDefaults(),le.enableMasterFilter(!1)),await this.updateChaospadInputMode()});const i=document.getElementById("chaospad-tilt-x"),o=document.getElementById("chaospad-tilt-y");if(i&&i.addEventListener("input",()=>{this.updateTiltValueLabels(),this.chaospadEnabled&&this.chaospadTiltAvailable&&this.applyTiltFromSliders()}),o&&o.addEventListener("input",()=>{this.updateTiltValueLabels(),this.chaospadEnabled&&this.chaospadTiltAvailable&&this.applyTiltFromSliders()}),this.updateTiltValueLabels(),this.refreshTiltControlsState(),this.masterPunchcardCanvas){const l=()=>{this.chaospadEnabled?this.masterPunchcardCanvas.style.cursor="pointer":this.masterPunchcardCanvas.style.cursor=""};this.masterPunchcardCanvas.addEventListener("mousemove",c=>{this.chaospadEnabled&&this.handleChaospadMouseMove(c)}),this.masterPunchcardCanvas.addEventListener("mouseenter",c=>{this.chaospadEnabled&&this.handleChaospadMouseMove(c)}),this.masterPunchcardCanvas.addEventListener("mouseleave",()=>{this.chaospadEnabled&&this.restoreChaospadDefaults()}),l()}this.showMasterPunchcardPlaceholder(),this.handleChaospadMouseMove=this.handleChaospadMouseMove.bind(this),window.addEventListener("resize",()=>{this.masterPunchcardResizeTimer&&clearTimeout(this.masterPunchcardResizeTimer),this.masterPunchcardResizeTimer=setTimeout(()=>{this.refreshMasterPunchcard("resize").catch(l=>{console.warn("⚠️ Unable to refresh punchcard after resize:",l)})},150)}),this.refreshMasterPunchcard("initial").catch(l=>{console.warn("⚠️ Unable to render initial punchcard:",l)}),this.updateChaospadInputMode(),this.refreshTiltControlsState(),this.loadTopTracks().catch(l=>{console.warn("⚠️ Unable to load top tracks:",l)})}getCurrentFullscreenElement(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null}async toggleVisualizerFullscreen(){if(!this.masterPunchcardContainer)return;const e=this.getCurrentFullscreenElement(),t=this.masterPunchcardContainer.classList.contains("is-fullscreen")&&!e;if(e===this.masterPunchcardContainer||t){e===this.masterPunchcardContainer?document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen():(this.masterPunchcardContainer.classList.remove("is-fullscreen"),Bi("visualizer-fullscreen"),this.updateVisualizerFullscreenButton(!1),this.removeMobileFullscreenCloseButton());return}try{if(this.masterPunchcardContainer.requestFullscreen){await this.masterPunchcardContainer.requestFullscreen();return}if(this.masterPunchcardContainer.webkitRequestFullscreen)try{const s=typeof Element<"u"&&Element.ALLOW_KEYBOARD_INPUT!==void 0?Element.ALLOW_KEYBOARD_INPUT:void 0;s!==void 0?await this.masterPunchcardContainer.webkitRequestFullscreen(s):await this.masterPunchcardContainer.webkitRequestFullscreen();return}catch(s){console.warn("⚠️ Webkit fullscreen failed, trying fallback:",s)}if(this.masterPunchcardContainer.mozRequestFullScreen){await this.masterPunchcardContainer.mozRequestFullScreen();return}if(this.masterPunchcardContainer.msRequestFullscreen){await this.masterPunchcardContainer.msRequestFullscreen();return}if(this.isMobileDevice()){this.masterPunchcardContainer.classList.add("is-fullscreen"),uo("visualizer-fullscreen"),this.updateVisualizerFullscreenButton(!0),this.addMobileFullscreenCloseButton(),setTimeout(()=>{this.refreshMasterPunchcard("css-fullscreen").catch(s=>{console.warn("⚠️ Unable to refresh punchcard after CSS fullscreen:",s)})},100);return}console.warn("⚠️ Fullscreen API not supported on this device")}catch(s){console.warn("⚠️ Unable to enter visualizer fullscreen:",s),this.isMobileDevice()&&(this.masterPunchcardContainer.classList.add("is-fullscreen"),uo("visualizer-fullscreen"),this.updateVisualizerFullscreenButton(!0),this.addMobileFullscreenCloseButton(),setTimeout(()=>{this.refreshMasterPunchcard("css-fullscreen-fallback").catch(r=>{console.warn("⚠️ Unable to refresh punchcard after CSS fullscreen fallback:",r)})},100))}}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768&&"ontouchstart"in window}addMobileFullscreenCloseButton(){if(this.removeMobileFullscreenCloseButton(),!this.masterPunchcardContainer)return;const e=document.createElement("button");e.id="mobile-fullscreen-close",e.className="mobile-fullscreen-close-btn",e.innerHTML="✕",e.setAttribute("aria-label","Close fullscreen"),e.addEventListener("click",()=>{this.toggleVisualizerFullscreen()}),this.masterPunchcardContainer.appendChild(e)}removeMobileFullscreenCloseButton(){const e=document.getElementById("mobile-fullscreen-close");e&&e.remove()}updateVisualizerFullscreenButton(e){this.visualizerFullscreenBtn&&(this.visualizerFullscreenBtn.classList.toggle("is-active",e),this.visualizerFullscreenBtn.setAttribute("aria-label",e?"Exit visualizer fullscreen":"Enter visualizer fullscreen"))}handleVisualizerFullscreenChange(){const t=this.getCurrentFullscreenElement()===this.masterPunchcardContainer;this.masterPunchcardContainer&&(this.masterPunchcardContainer.classList.toggle("is-fullscreen",t),!t&&this.isMobileDevice()?(Bi("visualizer-fullscreen"),this.removeMobileFullscreenCloseButton()):t&&this.isMobileDevice()&&setTimeout(()=>{this.addMobileFullscreenCloseButton()},100)),this.updateVisualizerFullscreenButton(t),this.refreshMasterPunchcard("fullscreen-change").catch(s=>{console.warn("⚠️ Unable to refresh punchcard after fullscreen change:",s)})}async applyVisualizerToMaster(){var a;console.log(`🎨 Applying visualizer "${this.selectedVisualizer}" to master pattern`);const e=typeof le.isMasterActive=="function"?le.isMasterActive():!!le.masterActive;this.scopeSpectrumObserver=null,this.scopeSpectrumCopyLoop=null,this.stopVisualizerAnimation(),this.teardownExternalVisualizerCanvas(),this.selectedVisualizer!=="pianoroll"&&document.querySelectorAll('canvas[data-processed="true"]').forEach(o=>{o.id!=="master-punchcard-canvas"&&o.remove()});const t=await this.getMasterPatternWithoutVisualizer();let s=t;const r="master-punchcard-canvas";if(this.selectedVisualizer!=="off"){if(await this.prepareCanvasForExternalVisualizer(),(this.selectedVisualizer==="spectrum"||this.selectedVisualizer==="pianoroll")&&await new Promise(l=>setTimeout(l,50)),this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"||this.selectedVisualizer==="spectrum"){le.setupVisualizerAnalyser(),await new Promise(u=>setTimeout(u,100));const l=r,c=((a=window.strudel)==null?void 0:a.getAnalyserById)||globalThis.getAnalyserById;if(c)try{const u=c(l);u&&u.context===le.audioContext?console.log(`✅ Verified analyser "${l}" is ready in correct audio context`):console.warn(`⚠️ Analyser "${l}" not ready or in wrong context`)}catch(u){console.warn("⚠️ Could not verify analyser:",u.message)}}const i=document.getElementById(r);if(i){i.style.position="relative",i.style.display="block",i.style.visibility="visible",i.style.opacity="1",i.style.left="0",i.style.top="0",i.style.width="100%",i.style.height="100%",i.id=r;const l=document.getElementById("master-punchcard");if(l&&i.parentNode!==l&&l.appendChild(i),l){const c=l.getBoundingClientRect(),u=window.devicePixelRatio||1,h=Math.max(c.width||320,320),d=Math.max(c.height||200,200);i.width=h*u,i.height=d*u,i.style.width=`${h}px`,i.style.height=`${d}px`,(this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"||this.selectedVisualizer==="spectrum")&&(i.offsetHeight,console.log(`✅ Canvas "${r}" ready for ${this.selectedVisualizer}`))}}else console.error(`❌ Canvas "${r}" not found!`);if((this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"||this.selectedVisualizer==="spectrum")&&(i&&i.id!==r&&(i.id=r),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block")),this.selectedVisualizer==="pianoroll"||this.selectedVisualizer==="spectrum")try{const{getDrawContext:l}=await ds(async()=>{const{getDrawContext:u}=await import("./strudel-web-Ddx65js9.js").then(h=>h.i);return{getDrawContext:u}},__vite__mapDeps([0,1])),c=l(r,{contextType:"2d"});window.__strudelVisualizerCtx=c,console.log(`✅ Registered canvas "${r}" with getDrawContext for ${this.selectedVisualizer}`)}catch(l){console.warn(`⚠️ Failed to register canvas with getDrawContext for ${this.selectedVisualizer}:`,l)}this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"||this.selectedVisualizer==="punchcard"?s=t:this.selectedVisualizer==="spectrum"?s=`${t}.spectrum({
        id: '${r}',
        thickness: 3,
        speed: 1,
        min: -80,
        max: 0
      })`:this.selectedVisualizer==="pianoroll"&&(s=`${t}.pianoroll({ 
          id: '${r}',
          ctx: (window.__strudelVisualizerCtx || (document.getElementById('master-punchcard-canvas') && document.getElementById('master-punchcard-canvas').getContext && document.getElementById('master-punchcard-canvas').getContext('2d'))),
          cycles: 4,
          playhead: 0.5,
          fill: true,
          fillActive: true,
          stroke: true,
          strokeActive: true,
          autorange: true,
          colorizeInactive: true,
          background: '#05060a'
        })`)}(!s||s.trim()==="")&&(console.warn("⚠️ Pattern with visualizer is empty, reverting to base pattern"),s=t||"silence"),this.selectedVisualizer!=="off"&&this.selectedVisualizer!=="punchcard"&&(this.selectedVisualizer==="scope"||this.selectedVisualizer==="barchart"?console.log(`✅ Using internal analyser visualizer for ${this.selectedVisualizer}`):new RegExp(`\\.\\s*_?${this.selectedVisualizer}\\s*\\(`).test(s)?console.log(`✅ Visualizer "${this.selectedVisualizer}" found in pattern`):console.error(`❌ Visualizer "${this.selectedVisualizer}" not found in pattern! Pattern:`,s)),await le.setMasterPatternCode(s),await this.ensureMasterPlaybackAfterVisualizerChange(e),this.selectedVisualizer==="off"?this.cameraEnabled?(this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.startCameraBlendLoop()):this.showMasterPunchcardPlaceholder():this.selectedVisualizer==="scope"?(this.startScopeVisualizerLoop(),this.cameraEnabled):this.selectedVisualizer==="barchart"?(this.startBarchartVisualizerLoop(),this.cameraEnabled):this.selectedVisualizer==="pianoroll"?(this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.hideMasterPunchcardPlaceholder(),this.cameraEnabled&&this.startCameraBlendLoop(),this.watchForExternalVisualizerCanvas("pianoroll")):this.selectedVisualizer==="spectrum"&&(this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.hideMasterPunchcardPlaceholder(),this.cameraEnabled&&this.startCameraBlendLoop(),this.watchForExternalVisualizerCanvas("spectrum")),this.refreshMasterPunchcard(this.selectedVisualizer==="off"?"visualizer-off":"visualizer-applied").catch(i=>{console.warn("⚠️ Unable to refresh punchcard after applying visualizer:",i)})}async ensureMasterPlaybackAfterVisualizerChange(e){var r,a,i,o;if(!e)return;const t=((a=(r=window.strudel)==null?void 0:r.scheduler)==null?void 0:a.started)||!1;if(t||(typeof le.isMasterActive=="function"?le.isMasterActive():!!le.masterActive)){!le.masterActive&&t&&(le.masterActive=!0,console.log("🔄 Restored masterActive flag after visualizer change"));return}if((i=window.strudel)!=null&&i.scheduler&&typeof window.strudel.scheduler.start=="function")try{if(console.log("🔄 Restarting scheduler after visualizer change..."),le.masterGainNode){const l=((o=le.audioContext)==null?void 0:o.currentTime)||0;le.masterGainNode.gain.setValueAtTime(le.masterVolume,l)}await window.strudel.scheduler.start(),le.masterActive=!0,console.log("✅ Scheduler restarted, playback resumed")}catch(l){if(console.warn("⚠️ Could not restart scheduler, falling back to playMasterPattern:",l),typeof le.playMasterPattern=="function")try{await le.playMasterPattern()}catch(c){console.warn("⚠️ Unable to resume master playback after visualizer change:",c)}}else if(typeof le.playMasterPattern=="function")try{await le.playMasterPattern()}catch(l){console.warn("⚠️ Unable to resume master playback after visualizer change:",l)}}showMasterPunchcardPlaceholder(){this.masterPunchcardContainer&&(this.masterPunchcardPlaceholder&&this.masterPunchcardPlaceholder.classList.remove("hidden"),this.masterPunchcardCanvas&&this.masterPunchcardCtx&&(this.masterPunchcardCtx.setTransform(1,0,0,1,0,0),this.masterPunchcardCtx.clearRect(0,0,this.masterPunchcardCanvas.width,this.masterPunchcardCanvas.height)))}async refreshMasterPunchcard(e="auto"){if(!this.masterPunchcardContainer)return;if(this.selectedVisualizer==="off"){this.stopVisualizerAnimation(),this.teardownExternalVisualizerCanvas(),this.cameraEnabled?(this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.startCameraBlendLoop()):(this.showMasterPunchcardPlaceholder(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block",this.masterPunchcardCtx&&(this.masterPunchcardCtx.setTransform(1,0,0,1,0,0),this.masterPunchcardCtx.clearRect(0,0,this.masterPunchcardCanvas.width,this.masterPunchcardCanvas.height))));return}const t=le.getMasterPatternCode();if(!t||t.trim()===""){this.showMasterPunchcardPlaceholder();return}const s=this.shouldUseSpiralVisualizer(t),r=!s&&this.shouldUseScopeVisualizer(t),a=!s&&!r&&this.shouldUseSpectrumVisualizer(t),i=!s&&!r&&!a&&this.shouldUsePitchwheelVisualizer(t),o=!s&&!r&&!a&&!i&&this.shouldUsePianorollVisualizer(t),l=!s&&!r&&!a&&!i&&!o&&this.shouldUseBarchartVisualizer(t);a&&this.selectedVisualizer!=="spectrum"&&(!this.selectedVisualizer||this.selectedVisualizer==="off"||["scope","punchcard","barchart"].includes(this.selectedVisualizer))&&(this.selectedVisualizer="spectrum",this.visualizerSelect&&(this.visualizerSelect.value="spectrum")),o&&this.selectedVisualizer!=="pianoroll"&&(!this.selectedVisualizer||["scope","punchcard","barchart","spectrum"].includes(this.selectedVisualizer))&&(this.selectedVisualizer="pianoroll",this.visualizerSelect&&(this.visualizerSelect.value="pianoroll"));const c=this.selectedVisualizer||"punchcard";if(c==="scope"){await this.prepareCanvasForExternalVisualizer(),this.startScopeVisualizerLoop(),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(c==="barchart"){await this.prepareCanvasForExternalVisualizer(),this.startBarchartVisualizerLoop(),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(c==="spectrum"){await this.prepareCanvasForExternalVisualizer(),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(c==="pianoroll"){await this.prepareCanvasForExternalVisualizer(),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block"),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(c!=="scope"&&c!=="barchart"&&this.stopVisualizerAnimation(),this.selectedVisualizer==="off"){this.stopVisualizerAnimation(),this.showMasterPunchcardPlaceholder();return}if(r||a||s||i||o||l){(this.selectedVisualizer||"punchcard")==="punchcard"&&r&&this.watchForExternalVisualizerCanvas("scope"),await this.prepareCanvasForExternalVisualizer(),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardIsRendering=!1;return}if(this.masterPunchcardIsRendering){this.masterPunchcardPendingRefresh=!0;return}this.masterPunchcardIsRendering=!0;try{const u=this.currentTimeSignatureMetrics||Po(this.currentTimeSignature||"4/4"),h=await this.computeMasterPunchcardData(t,u);if(!h||h.error){const m=h!=null&&h.error?`Unable to render punchcard: ${h.error}`:"Unable to render punchcard.";console.warn(m,{reason:e,data:h}),this.showMasterPunchcardPlaceholder();return}if(!h.counts||h.counts.length===0){this.showMasterPunchcardPlaceholder();return}if(Math.max(...h.counts)<=0){this.showMasterPunchcardPlaceholder();return}this.renderMasterPunchcard(u,h)}finally{this.masterPunchcardIsRendering=!1,this.masterPunchcardPendingRefresh&&(this.masterPunchcardPendingRefresh=!1,this.refreshMasterPunchcard("queued-refresh").catch(u=>{console.warn("⚠️ Queued punchcard refresh failed:",u)}))}}renderMasterPunchcard(e,t){!this.masterPunchcardContainer||!this.masterPunchcardCanvas||(this.hideMasterPunchcardPlaceholder(),this.drawMasterPunchcardCanvas(e,t))}async prepareCanvasForExternalVisualizer(){if(!this.masterPunchcardContainer||!this.masterPunchcardCanvas){console.warn("⚠️ Canvas elements not found for visualizer");return}const e=this.masterPunchcardCanvas.id;if(console.log(`🎨 Preparing canvas for external visualizer: ${e}`),!document.getElementById(e)){console.error(`❌ Canvas "${e}" not found via getElementById!`);return}console.log(`✅ Canvas "${e}" is accessible via getElementById`),this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas.style.position="relative",this.masterPunchcardCanvas.style.left="0",this.masterPunchcardCanvas.style.top="0",this.masterPunchcardCanvas.style.width="100%",this.masterPunchcardCanvas.style.height="100%",this.masterPunchcardCanvas.style.display="block";const s=["scope","barchart","spectrum"];this.masterPunchcardCanvas.style.background=s.includes(this.selectedVisualizer)?"#05060a":"rgba(255, 255, 255, 0.9)";let r;try{const{getDrawContext:a}=await ds(async()=>{const{getDrawContext:i}=await import("./strudel-web-Ddx65js9.js").then(o=>o.i);return{getDrawContext:i}},__vite__mapDeps([0,1]));r=a(e,{contextType:"2d"}),console.log(`✅ Got draw context via getDrawContext for ${e}`)}catch(a){console.warn("⚠️ getDrawContext failed, falling back to native:",a),r=this.masterPunchcardCanvas.getContext("2d")}if(r&&(this.sizeCanvasToContainer(this.masterPunchcardCanvas,r),window.__strudelVisualizerCtx=r,window.strudel&&window.strudel.controls))try{window.strudel.controls.setCanvas(e),console.log(`✅ Registered canvas "${e}" with Strudel controls`)}catch(a){console.log("ℹ️ Could not register with strudel.controls:",a.message)}}sizeCanvasToContainer(e,t){if(!e||!this.masterPunchcardContainer)return;const s=this.masterPunchcardContainer.getBoundingClientRect(),r=Math.max(s.width||this.masterPunchcardContainer.offsetWidth||320,240),a=Math.max(s.height||this.masterPunchcardContainer.offsetHeight||200,220),i=window.devicePixelRatio||1;e.width=r*i,e.height=a*i,e.style.width="100%",e.style.height="100%",e.style.display="block",e.style.opacity="1",t&&(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),t.setTransform(i,0,0,i,0,0))}ensureVisualizerAnalyser(){return le?(le.visualizerAnalyser||typeof le.setupVisualizerAnalyser=="function"&&le.setupVisualizerAnalyser(),le.visualizerAnalyser||null):null}stopVisualizerAnimation(){this.scopeAnimationFrame&&(cancelAnimationFrame(this.scopeAnimationFrame),this.scopeAnimationFrame=null),this.barchartAnimationFrame&&(cancelAnimationFrame(this.barchartAnimationFrame),this.barchartAnimationFrame=null),this.cameraBlendAnimationFrame&&(cancelAnimationFrame(this.cameraBlendAnimationFrame),this.cameraBlendAnimationFrame=null),this.activeVisualizerLoop=null}async requestCameraAccess(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return console.warn("⚠️ Camera API not available in this browser"),this.cameraAvailable=!1,!1;try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:1280},height:{ideal:720}}});this.cameraVideo||(this.cameraVideo=document.createElement("video"),this.cameraVideo.autoplay=!0,this.cameraVideo.playsInline=!0,this.cameraVideo.muted=!0,this.cameraVideo.style.display="none",this.cameraVideo.style.position="absolute",this.cameraVideo.style.visibility="hidden",document.body.appendChild(this.cameraVideo)),this.cameraVideo.srcObject=e,this.cameraStream=e,this.cameraAvailable=!0,this.cameraEnabled=!0,await new Promise(t=>{this.cameraVideo.readyState>=2?t():this.cameraVideo.addEventListener("loadedmetadata",t,{once:!0})});try{await this.cameraVideo.play()}catch(t){console.warn("⚠️ Could not play camera video automatically:",t),setTimeout(async()=>{try{await this.cameraVideo.play()}catch(s){console.warn("⚠️ Retry play() also failed:",s)}},100)}return console.log("✅ Camera access granted"),!0}catch(e){return console.warn("⚠️ Camera access denied or unavailable:",e),this.cameraAvailable=!1,this.cameraEnabled=!1,!1}}stopCamera(){this.cameraStream&&(this.cameraStream.getTracks().forEach(e=>{e.stop()}),this.cameraStream=null),this.cameraVideo&&(this.cameraVideo.srcObject=null,this.cameraVideo.parentNode&&this.cameraVideo.parentNode.removeChild(this.cameraVideo),this.cameraVideo=null),this.cameraEnabled=!1,console.log("📷 Camera stopped")}checkCameraAvailability(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?this.cameraAvailable=!0:(this.cameraAvailable=!1,console.warn("⚠️ Camera API not supported in this browser"))}updateCameraControlsVisibility(){const e=document.getElementById("camera-blend-control"),t=document.getElementById("camera-blend-control-mobile");e&&(this.selectedVisualizer!=="off"?e.style.display="flex":e.style.display="none"),t&&(this.selectedVisualizer!=="off"?t.style.display="block":t.style.display="none")}drawVisualizerMessage(e){const t=this.masterPunchcardCanvas;if(!t)return;let s=this.masterPunchcardCtx;if(!s||typeof s.setTransform!="function"){if(s=t.getContext("2d"),!s||typeof s.setTransform!="function"){console.warn("⚠️ drawVisualizerMessage: Cannot get valid 2D context");return}this.masterPunchcardCtx=s}this.sizeCanvasToContainer(t,s);const r=window.devicePixelRatio||1,a=t.width/r,i=t.height/r;s.fillStyle="rgba(5, 6, 10, 0.92)",s.fillRect(0,0,a,i),s.fillStyle="#94a3b8",s.font='14px "Fira Sans", "Inter", system-ui, sans-serif',s.textAlign="center",s.textBaseline="middle",s.fillText(e,a/2,i/2)}startScopeVisualizerLoop(){this.scopeAnimationFrame&&(cancelAnimationFrame(this.scopeAnimationFrame),this.scopeAnimationFrame=null);const e=this.masterPunchcardCanvas;if(!e){console.warn("⚠️ Scope visualizer: Canvas not available");return}const t=this.ensureVisualizerAnalyser();if(!t){console.warn("⚠️ Scope visualizer: Analyser not available"),this.drawVisualizerMessage("Scope analyser unavailable");return}const s=t.fftSize||2048;(!this.scopeDataArray||this.scopeDataArray.length!==s)&&(this.scopeDataArray=new Uint8Array(s)),this.activeVisualizerLoop="scope",console.log("🎨 Starting scope visualizer loop");const r=()=>{if(this.selectedVisualizer!=="scope"){console.log(`🎨 Scope loop stopping: selectedVisualizer is "${this.selectedVisualizer}", expected "scope"`),this.stopVisualizerAnimation();return}let a=this.masterPunchcardCtx;if(!a||typeof a.setTransform!="function"){if(a=this.masterPunchcardCanvas.getContext("2d"),!a||typeof a.setTransform!="function"){console.warn("⚠️ Scope visualizer: Cannot get valid 2D context"),this.stopVisualizerAnimation();return}this.masterPunchcardCtx=a}this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas.style.display="block",this.sizeCanvasToContainer(e,a),t.getByteTimeDomainData(this.scopeDataArray);const i=window.devicePixelRatio||1,o=e.width/i,l=e.height/i;a.fillStyle="rgba(5, 6, 10, 0.92)",a.fillRect(0,0,o,l);const c=l/2;a.strokeStyle="#38bdf8",a.lineWidth=2,a.beginPath();const u=o/this.scopeDataArray.length;let h=0;for(let d=0;d<this.scopeDataArray.length;d++){const y=this.scopeDataArray[d]/128*l/2;d===0?a.moveTo(h,y):a.lineTo(h,y),h+=u}if(a.lineTo(o,c),a.stroke(),a.strokeStyle="rgba(14, 165, 233, 0.4)",a.beginPath(),a.moveTo(0,c),a.lineTo(o,c),a.stroke(),this.cameraEnabled&&this.cameraVideo&&this.cameraVideo.readyState>=2&&this.cameraVideo.videoWidth>0&&this.cameraVideo.videoHeight>0){const d=a.globalAlpha;a.globalAlpha=this.cameraBlendValue;try{a.drawImage(this.cameraVideo,0,0,o,l)}catch(m){console.warn("⚠️ Error drawing camera frame:",m)}a.globalAlpha=d}this.scopeAnimationFrame=requestAnimationFrame(r)};r()}startBarchartVisualizerLoop(){var o;this.barchartAnimationFrame&&(cancelAnimationFrame(this.barchartAnimationFrame),this.barchartAnimationFrame=null);const e=this.masterPunchcardCanvas;if(!e){console.warn("⚠️ Bar chart visualizer: Canvas not available");return}const t=this.ensureVisualizerAnalyser();if(!t){console.warn("⚠️ Bar chart visualizer: Analyser not available"),this.drawVisualizerMessage("Spectrum analyser unavailable");return}const s=t.frequencyBinCount||1024;(!this.spectrumDataArray||this.spectrumDataArray.length!==s)&&(this.spectrumDataArray=new Uint8Array(s));const a=(((o=t.context)==null?void 0:o.sampleRate)||44100)/2;this.activeVisualizerLoop="barchart",console.log("🎨 Starting bar chart visualizer loop");const i=()=>{if(this.selectedVisualizer!=="barchart"){console.log(`🎨 Bar chart loop stopping: selectedVisualizer is "${this.selectedVisualizer}", expected "barchart"`),this.stopVisualizerAnimation();return}let l=this.masterPunchcardCtx;if(!l||typeof l.setTransform!="function"){if(l=this.masterPunchcardCanvas.getContext("2d"),!l||typeof l.setTransform!="function"){console.warn("⚠️ Bar chart visualizer: Cannot get valid 2D context"),this.stopVisualizerAnimation();return}this.masterPunchcardCtx=l}this.hideMasterPunchcardPlaceholder(),this.masterPunchcardCanvas.style.display="block",this.sizeCanvasToContainer(e,l),t.getByteFrequencyData(this.spectrumDataArray);const c=window.devicePixelRatio||1,u=e.width/c,h=e.height/c;l.fillStyle="rgba(5, 6, 10, 0.92)",l.fillRect(0,0,u,h);const d=Math.min(200,Math.floor(u/2)),m=[];for(let O=0;O<this.spectrumDataArray.length;O++){const S=O/this.spectrumDataArray.length*a;if(S>=20&&S<=2e4){const A=$x(S),F=this.spectrumDataArray[O]/255;m.push({position:A,value:F,frequency:S})}}m.sort((O,S)=>O.position-S.position);const y=u/d;for(let O=0;O<d;O++){const S=O/d,A=1/d,F=S<.3?A*4:S<.6?A*2:A,j=m.filter(ce=>Math.abs(ce.position-S)<F);let N=j.length>0?Math.max(...j.map(ce=>ce.value)):0;if(N===0&&m.length>0){let ce=0,ee=1/0;for(const he of m){const H=Math.abs(he.position-S);if(H<ee)ee=H,ce=he.value;else if(H>ee)break}N=ce}const $=Math.max(N*h,2),L=S*u,I=h-$,q=l.createLinearGradient(L,I,L,h);q.addColorStop(0,"rgba(56, 189, 248, 0.95)"),q.addColorStop(1,"rgba(14, 116, 144, 0.75)"),l.fillStyle=q,l.fillRect(L,I,y+1,$)}if(this.cameraEnabled&&this.cameraVideo&&this.cameraVideo.readyState>=2&&this.cameraVideo.videoWidth>0&&this.cameraVideo.videoHeight>0){const O=l.globalAlpha;l.globalAlpha=this.cameraBlendValue;try{l.drawImage(this.cameraVideo,0,0,u,h)}catch(S){console.warn("⚠️ Error drawing camera frame:",S)}l.globalAlpha=O}this.barchartAnimationFrame=requestAnimationFrame(i)};i()}startCameraBlendLoop(){this.cameraBlendAnimationFrame&&(cancelAnimationFrame(this.cameraBlendAnimationFrame),this.cameraBlendAnimationFrame=null);const e=this.masterPunchcardCanvas;if(!e)return;const t=()=>{if(!this.cameraEnabled){this.cameraBlendAnimationFrame=null;return}if(!(this.selectedVisualizer==="spectrum"||this.selectedVisualizer==="pianoroll"||this.selectedVisualizer==="off")){this.cameraBlendAnimationFrame=null;return}if(!this.cameraVideo||this.cameraVideo.readyState<2){this.cameraBlendAnimationFrame=requestAnimationFrame(t);return}let r=this.masterPunchcardCtx;if(!r||typeof r.setTransform!="function"){if(r=e.getContext("2d"),!r||typeof r.setTransform!="function"){console.warn("⚠️ Camera blend loop: Cannot get valid 2D context"),this.cameraBlendAnimationFrame=requestAnimationFrame(t);return}this.masterPunchcardCtx=r}try{this.sizeCanvasToContainer(e,r);const a=window.devicePixelRatio||1,i=e.width/a,o=e.height/a,l=this.selectedVisualizer==="off"?1:this.cameraBlendValue;if(this.selectedVisualizer==="off"&&(r.fillStyle="rgba(5, 6, 10, 0.92)",r.fillRect(0,0,i,o)),this.cameraVideo.videoWidth>0&&this.cameraVideo.videoHeight>0){const c=r.globalAlpha;r.globalAlpha=l,r.drawImage(this.cameraVideo,0,0,i,o),r.globalAlpha=c}}catch(a){console.warn("⚠️ Error drawing camera frame in blend loop:",a)}this.cameraBlendAnimationFrame=requestAnimationFrame(t)};t()}teardownExternalVisualizerCanvas(){this.externalVisualizerObserver&&(this.externalVisualizerObserver.disconnect(),this.externalVisualizerObserver=null),this.externalVisualizerCanvas&&this.externalVisualizerCanvas.parentNode&&this.externalVisualizerCanvas.remove(),this.externalVisualizerCanvas=null,this.externalVisualizerType=null,document.querySelectorAll("canvas").forEach(t=>{if(!(t===this.masterPunchcardCanvas||t.id==="master-punchcard-canvas")&&this.masterPunchcardContainer&&this.masterPunchcardContainer.contains(t)){const s=(t.id||"").toLowerCase(),r=(t.className||"").toLowerCase();(s.includes("spectrum")||s.includes("scope")||r.includes("spectrum")||r.includes("scope")||t.dataset.spectrum!==void 0||t.dataset.scope!==void 0)&&(console.log("🧹 Removing external visualizer canvas:",t.id||t.className),t.remove())}}),this.masterPunchcardCanvas&&(this.masterPunchcardCanvas.style.display="block")}attachExternalVisualizerCanvas(e){return!e||!this.masterPunchcardContainer?!1:(this.masterPunchcardCanvas.style.display="none",this.hideMasterPunchcardPlaceholder(),this.masterPunchcardContainer.style.position===""&&(this.masterPunchcardContainer.style.position="relative"),e.dataset.visualizerAttached="true",e.style.position="relative",e.style.left="0",e.style.top="0",e.style.pointerEvents="auto",this.sizeCanvasToContainer(e,e.getContext("2d")),this.masterPunchcardContainer.appendChild(e),this.externalVisualizerCanvas=e,!0)}watchForExternalVisualizerCanvas(e){const t=()=>{const s=this.findExternalVisualizerCanvasCandidate(e);return s?this.attachExternalVisualizerCanvas(s):!1};t()||(this.externalVisualizerObserver=new MutationObserver(()=>{t()&&this.externalVisualizerObserver&&(this.externalVisualizerObserver.disconnect(),this.externalVisualizerObserver=null)}),this.externalVisualizerObserver.observe(document.body,{childList:!0,subtree:!0}))}findExternalVisualizerCanvasCandidate(e){const t=Array.from(document.querySelectorAll("canvas"));for(const s of t)if(s!==this.masterPunchcardCanvas&&s.dataset.visualizerAttached!=="true"&&(e==="pianoroll"&&this.isPianorollCanvas(s)||e==="scope"&&this.isScopeCanvas(s)||e==="spectrum"&&this.isSpectrumCanvas(s)))return s;return null}isPianorollCanvas(e){if(!e)return!1;if(e.dataset.pianoroll!==void 0)return!0;const t=e.className||"";if(/pianoroll/i.test(t))return!0;const s=e.getBoundingClientRect();return s.width===0||s.height===0?!1:s.width>window.innerWidth*.6&&s.height>window.innerHeight*.4}isScopeCanvas(e){if(!e)return!1;const t=(e.id||"").toLowerCase(),s=(e.className||"").toLowerCase();if(t.includes("scope")||s.includes("scope")||e.dataset.scope!==void 0)return!0;const r=e.getBoundingClientRect();return r.width>window.innerWidth*.5&&r.height<260}isSpectrumCanvas(e){if(!e)return!1;const t=(e.id||"").toLowerCase(),s=(e.className||"").toLowerCase();if(t.includes("spectrum")||s.includes("spectrum")||e.dataset.spectrum!==void 0)return!0;const r=e.getBoundingClientRect();return r.width>window.innerWidth*.5&&r.height<400}hideMasterPunchcardPlaceholder(){this.masterPunchcardPlaceholder&&this.masterPunchcardPlaceholder.classList.add("hidden")}handleChaospadMouseMove(e){if(!this.masterPunchcardCanvas||!this.chaospadEnabled){console.log("🎛️ Chaospad: Skipping - canvas or enabled check failed",{hasCanvas:!!this.masterPunchcardCanvas,enabled:this.chaospadEnabled});return}if(this.chaospadOrientationActive&&this.isMobileDevice())return;const t=e.touches&&e.touches.length?e.touches[0]:e;if(typeof t.clientX!="number"||typeof t.clientY!="number")return;const s=this.masterPunchcardCanvas.getBoundingClientRect(),r=t.clientX-s.left,a=s.bottom-t.clientY,i=s.width,o=s.height;if(i===0||o===0){console.log("⚠️ Chaospad: Canvas not sized yet");return}const l=Math.max(0,Math.min(1,r/i)),c=Math.max(0,Math.min(1,a/o));this.applyChaospadInputFromPercentages(l,c,"mouse")}applyChaospadInputFromPercentages(e=0,t=0,s="mouse"){if(!this.chaospadEnabled)return;const r=Math.max(0,Math.min(1,Number.isFinite(e)?e:0)),a=Math.max(0,Math.min(1,Number.isFinite(t)?t:0)),i=this.chaospadSettings.xAxis||{effect:"cutoff",min:80,max:8e3},o=this.chaospadSettings.yAxis||{effect:"resonance",min:.1,max:5},l=i.min+(i.max-i.min)*r,c=Date.now();switch(i.effect){case"cutoff":{const h=Math.round(l);(this.currentCutoffValue===null||Math.abs(this.currentCutoffValue-h)>50||this.lastCutoffUpdate&&c-this.lastCutoffUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(r*100).toFixed(1)}% → ${h} Hz`),this.currentCutoffValue=h,this.lastCutoffUpdate=c,le.setMasterFilterFrequency(h));break}case"resonance":{const h=Math.round(l*10)/10;(this.currentResonanceValue===null||Math.abs(this.currentResonanceValue-h)>.2||this.lastResonanceUpdate&&c-this.lastResonanceUpdate>120)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(r*100).toFixed(1)}% → Q ${h}`),this.currentResonanceValue=h,this.lastResonanceUpdate=c,le.setMasterFilterResonance(h));break}case"volume":{const h=Math.max(0,Math.min(1,l));(this.currentVolumeValue===null||Math.abs(this.currentVolumeValue-h)>.02||this.lastVolumeUpdate&&c-this.lastVolumeUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(r*100).toFixed(1)}% → Volume ${(h*100).toFixed(1)}%`),this.currentVolumeValue=h,this.lastVolumeUpdate=c,le.masterVolume=h,le.masterGainNode&&(le.masterGainNode.gain.value=h));break}case"pan":{const h=Math.max(-1,Math.min(1,l));(this.currentPanValue===null||Math.abs(this.currentPanValue-h)>.05||this.lastPanUpdate&&c-this.lastPanUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(r*100).toFixed(1)}% → Pan ${h.toFixed(2)}`),this.currentPanValue=h,this.lastPanUpdate=c,le.masterPan=h,le.masterPanNode&&(le.masterPanNode.pan.value=h));break}case"delayAmount":{const h=Math.max(0,Math.min(1,l));(this.currentDelayAmountValue===null||Math.abs(this.currentDelayAmountValue-h)>.02||this.lastDelayAmountUpdate&&c-this.lastDelayAmountUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(r*100).toFixed(1)}% → Delay Amount ${(h*100).toFixed(1)}%`),this.currentDelayAmountValue=h,this.lastDelayAmountUpdate=c,le.setMasterDelayAmount(h));break}case"delayFeedback":{const h=Math.max(0,Math.min(1,l));(this.currentDelayFeedbackValue===null||Math.abs(this.currentDelayFeedbackValue-h)>.02||this.lastDelayFeedbackUpdate&&c-this.lastDelayFeedbackUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(r*100).toFixed(1)}% → Delay Feedback ${(h*100).toFixed(1)}%`),this.currentDelayFeedbackValue=h,this.lastDelayFeedbackUpdate=c,le.setMasterDelayFeedback(h));break}case"reverbAmount":{const h=Math.max(0,Math.min(5,l));(this.currentReverbAmountValue===null||Math.abs(this.currentReverbAmountValue-h)>.1||this.lastReverbAmountUpdate&&c-this.lastReverbAmountUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(r*100).toFixed(1)}% → Reverb Amount ${h.toFixed(2)}`),this.currentReverbAmountValue=h,this.lastReverbAmountUpdate=c,le.setMasterReverbAmount(h));break}case"reverbRoomSize":{const h=Math.max(0,Math.min(4,l));(this.currentReverbRoomSizeValue===null||Math.abs(this.currentReverbRoomSizeValue-h)>.1||this.lastReverbRoomSizeUpdate&&c-this.lastReverbRoomSizeUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Horizontal ${(r*100).toFixed(1)}% → Reverb Room Size ${h.toFixed(2)}`),this.currentReverbRoomSizeValue=h,this.lastReverbRoomSizeUpdate=c,le.setMasterReverbRoomSize(h));break}}const u=o.min+(o.max-o.min)*a;switch(o.effect){case"cutoff":{const h=Math.round(u);(this.currentCutoffValue===null||Math.abs(this.currentCutoffValue-h)>50||this.lastCutoffUpdate&&c-this.lastCutoffUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(a*100).toFixed(1)}% → ${h} Hz`),this.currentCutoffValue=h,this.lastCutoffUpdate=c,le.setMasterFilterFrequency(h));break}case"resonance":{let h=Math.round(u*10)/10;this.currentCutoffValue!==null&&this.currentCutoffValue<250&&(h=Math.min(h,2.5)),(this.currentResonanceValue===null||Math.abs(this.currentResonanceValue-h)>.2||this.lastResonanceUpdate&&c-this.lastResonanceUpdate>120)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(a*100).toFixed(1)}% → Q ${h}`),this.currentResonanceValue=h,this.lastResonanceUpdate=c,le.setMasterFilterResonance(h));break}case"volume":{const h=Math.max(0,Math.min(1,u));(this.currentVolumeValue===null||Math.abs(this.currentVolumeValue-h)>.02||this.lastVolumeUpdate&&c-this.lastVolumeUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(a*100).toFixed(1)}% → Volume ${(h*100).toFixed(1)}%`),this.currentVolumeValue=h,this.lastVolumeUpdate=c,le.masterVolume=h,le.masterGainNode&&(le.masterGainNode.gain.value=h));break}case"pan":{const h=Math.max(-1,Math.min(1,u));(this.currentPanValue===null||Math.abs(this.currentPanValue-h)>.05||this.lastPanUpdate&&c-this.lastPanUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(a*100).toFixed(1)}% → Pan ${h.toFixed(2)}`),this.currentPanValue=h,this.lastPanUpdate=c,le.masterPan=h,le.masterPanNode&&(le.masterPanNode.pan.value=h));break}case"delayAmount":{const h=Math.max(0,Math.min(1,u));(this.currentDelayAmountValue===null||Math.abs(this.currentDelayAmountValue-h)>.02||this.lastDelayAmountUpdate&&c-this.lastDelayAmountUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(a*100).toFixed(1)}% → Delay Amount ${(h*100).toFixed(1)}%`),this.currentDelayAmountValue=h,this.lastDelayAmountUpdate=c,le.setMasterDelayAmount(h));break}case"delayFeedback":{const h=Math.max(0,Math.min(1,u));(this.currentDelayFeedbackValue===null||Math.abs(this.currentDelayFeedbackValue-h)>.02||this.lastDelayFeedbackUpdate&&c-this.lastDelayFeedbackUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(a*100).toFixed(1)}% → Delay Feedback ${(h*100).toFixed(1)}%`),this.currentDelayFeedbackValue=h,this.lastDelayFeedbackUpdate=c,le.setMasterDelayFeedback(h));break}case"reverbAmount":{const h=Math.max(0,Math.min(5,u));(this.currentReverbAmountValue===null||Math.abs(this.currentReverbAmountValue-h)>.1||this.lastReverbAmountUpdate&&c-this.lastReverbAmountUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(a*100).toFixed(1)}% → Reverb Amount ${h.toFixed(2)}`),this.currentReverbAmountValue=h,this.lastReverbAmountUpdate=c,le.setMasterReverbAmount(h));break}case"reverbRoomSize":{const h=Math.max(0,Math.min(4,u));(this.currentReverbRoomSizeValue===null||Math.abs(this.currentReverbRoomSizeValue-h)>.1||this.lastReverbRoomSizeUpdate&&c-this.lastReverbRoomSizeUpdate>100)&&(console.log(`🎛️ Chaospad [${s}]: Vertical ${(a*100).toFixed(1)}% → Reverb Room Size ${h.toFixed(2)}`),this.currentReverbRoomSizeValue=h,this.lastReverbRoomSizeUpdate=c,le.setMasterReverbRoomSize(h));break}}this.updateChaospadVirtualGravity(r,a,s)}updateChaospadVirtualGravity(e=.5,t=.5,s="mouse"){const r=Math.max(0,Math.min(1,Number.isFinite(e)?e:.5)),a=Math.max(0,Math.min(1,Number.isFinite(t)?t:.5)),i=parseFloat((r*2-1).toFixed(4)),o=parseFloat((a*2-1).toFixed(4));this.chaospadVirtualGravity={x:i,y:o,source:s},typeof window<"u"&&(window.gravityX=i,window.gravityY=o,window.dispatchEvent(new CustomEvent("chaospad-gravitychange",{detail:{gravityX:i,gravityY:o,source:s}}))),this.syncTiltSlidersFromGravity(s)}supportsChaospadOrientation(){return typeof window<"u"&&typeof window.DeviceOrientationEvent<"u"}async updateChaospadInputMode(){if(!this.chaospadEnabled){this.disableChaospadOrientationControl();return}this.isMobileDevice()&&this.supportsChaospadOrientation()?await this.enableChaospadOrientationControl():this.disableChaospadOrientationControl()}async enableChaospadOrientationControl(){if(!(!this.supportsChaospadOrientation()||this.chaospadOrientationActive)){if(typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function"){if(this.chaospadOrientationPermission!=="granted")try{const e=await DeviceOrientationEvent.requestPermission();this.chaospadOrientationPermission=e}catch(e){this.chaospadOrientationPermission="denied",console.warn("⚠️ Chaospad: Device orientation permission request failed:",(e==null?void 0:e.message)||e);return}if(this.chaospadOrientationPermission!=="granted"){console.warn("⚠️ Chaospad: Device orientation permission not granted by the user");return}}window.addEventListener("deviceorientation",this.handleChaospadOrientation,{passive:!0}),this.chaospadOrientationActive=!0,console.log("🎛️ Chaospad: Device orientation control enabled")}}disableChaospadOrientationControl(){this.chaospadOrientationActive&&(window.removeEventListener("deviceorientation",this.handleChaospadOrientation),this.chaospadOrientationActive=!1,console.log("🎛️ Chaospad: Device orientation control disabled"))}handleChaospadOrientation(e){if(!this.chaospadEnabled||!e)return;const t=(l,c,u)=>Math.max(c,Math.min(u,l)),s=typeof e.gamma=="number"?t(e.gamma,-60,60):null,r=typeof e.beta=="number"?t(e.beta,-60,60):null;if(s===null&&r===null)return;const a=s===null?.5:(s+60)/120,o=1-(r===null?.5:(r+60)/120);this.applyChaospadInputFromPercentages(a,o,"orientation")}showChaospadMobileNotification(){const e=document.getElementById("chaospad-mobile-notification");e&&(e.hidden=!1,e.setAttribute("aria-hidden","false"),setTimeout(()=>{e.hidden=!0,e.setAttribute("aria-hidden","true")},3e3))}updateChaospadDefaultsFromCurrent(){this.chaospadDefaults.cutoff=le.masterFilterFrequency||this.chaospadDefaults.cutoff,this.chaospadDefaults.resonance=le.masterFilterResonance||this.chaospadDefaults.resonance,this.chaospadDefaults.volume=le.masterVolume||this.chaospadDefaults.volume,this.chaospadDefaults.pan=le.masterPan||this.chaospadDefaults.pan,this.chaospadDefaults.delayAmount=le.masterDelayAmount||this.chaospadDefaults.delayAmount,this.chaospadDefaults.delayFeedback=le.masterDelayFeedback||this.chaospadDefaults.delayFeedback,this.chaospadDefaults.reverbAmount=le.masterReverbAmount||this.chaospadDefaults.reverbAmount,this.chaospadDefaults.reverbRoomSize=le.masterReverbRoomSize||this.chaospadDefaults.reverbRoomSize}resetChaospadToDefaults(e=!1){if(!this.chaospadEnabled)return;this.currentCutoffValue=this.chaospadDefaults.cutoff,this.currentResonanceValue=this.chaospadDefaults.resonance,le.setMasterFilterFrequency(this.currentCutoffValue,e),le.setMasterFilterResonance(this.currentResonanceValue,e);const{minFrequency:t,maxFrequency:s,minResonance:r,maxResonance:a}=this.chaospadSettings,i=(this.currentCutoffValue-t)/(s-t||1),o=(this.currentResonanceValue-r)/(a-r||1);this.updateChaospadVirtualGravity(Math.max(0,Math.min(1,i)),Math.max(0,Math.min(1,o)),"reset")}restoreChaospadDefaults(){const e=this.chaospadSettings.xAxis||{effect:"cutoff"},t=this.chaospadSettings.yAxis||{effect:"resonance"};switch(e.effect){case"cutoff":le.setMasterFilterFrequency(this.chaospadDefaults.cutoff,!0),this.currentCutoffValue=this.chaospadDefaults.cutoff;break;case"resonance":le.setMasterFilterResonance(this.chaospadDefaults.resonance,!0),this.currentResonanceValue=this.chaospadDefaults.resonance;break;case"volume":le.masterVolume=this.chaospadDefaults.volume,le.masterGainNode&&(le.masterGainNode.gain.value=this.chaospadDefaults.volume),this.currentVolumeValue=this.chaospadDefaults.volume;break;case"pan":le.masterPan=this.chaospadDefaults.pan,le.masterPanNode&&(le.masterPanNode.pan.value=this.chaospadDefaults.pan),this.currentPanValue=this.chaospadDefaults.pan;break;case"delayAmount":le.setMasterDelayAmount(this.chaospadDefaults.delayAmount),this.currentDelayAmountValue=this.chaospadDefaults.delayAmount;break;case"delayFeedback":le.setMasterDelayFeedback(this.chaospadDefaults.delayFeedback),this.currentDelayFeedbackValue=this.chaospadDefaults.delayFeedback;break;case"reverbAmount":le.setMasterReverbAmount(this.chaospadDefaults.reverbAmount),this.currentReverbAmountValue=this.chaospadDefaults.reverbAmount;break;case"reverbRoomSize":le.setMasterReverbRoomSize(this.chaospadDefaults.reverbRoomSize),this.currentReverbRoomSizeValue=this.chaospadDefaults.reverbRoomSize;break}switch(t.effect){case"cutoff":le.setMasterFilterFrequency(this.chaospadDefaults.cutoff,!0),this.currentCutoffValue=this.chaospadDefaults.cutoff;break;case"resonance":le.setMasterFilterResonance(this.chaospadDefaults.resonance,!0),this.currentResonanceValue=this.chaospadDefaults.resonance;break;case"volume":le.masterVolume=this.chaospadDefaults.volume,le.masterGainNode&&(le.masterGainNode.gain.value=this.chaospadDefaults.volume),this.currentVolumeValue=this.chaospadDefaults.volume;break;case"pan":le.masterPan=this.chaospadDefaults.pan,le.masterPanNode&&(le.masterPanNode.pan.value=this.chaospadDefaults.pan),this.currentPanValue=this.chaospadDefaults.pan;break;case"delayAmount":le.setMasterDelayAmount(this.chaospadDefaults.delayAmount),this.currentDelayAmountValue=this.chaospadDefaults.delayAmount;break;case"delayFeedback":le.setMasterDelayFeedback(this.chaospadDefaults.delayFeedback),this.currentDelayFeedbackValue=this.chaospadDefaults.delayFeedback;break;case"reverbAmount":le.setMasterReverbAmount(this.chaospadDefaults.reverbAmount),this.currentReverbAmountValue=this.chaospadDefaults.reverbAmount;break;case"reverbRoomSize":le.setMasterReverbRoomSize(this.chaospadDefaults.reverbRoomSize),this.currentReverbRoomSizeValue=this.chaospadDefaults.reverbRoomSize;break}switch(t.effect){case"cutoff":le.setMasterFilterFrequency(this.chaospadDefaults.cutoff,!0),this.currentCutoffValue=this.chaospadDefaults.cutoff;break;case"resonance":le.setMasterFilterResonance(this.chaospadDefaults.resonance,!0),this.currentResonanceValue=this.chaospadDefaults.resonance;break;case"volume":le.masterVolume=this.chaospadDefaults.volume,le.masterGainNode&&(le.masterGainNode.gain.value=this.chaospadDefaults.volume),this.currentVolumeValue=this.chaospadDefaults.volume;break;case"pan":le.masterPan=this.chaospadDefaults.pan,le.masterPanNode&&(le.masterPanNode.pan.value=this.chaospadDefaults.pan),this.currentPanValue=this.chaospadDefaults.pan;break;case"delayAmount":le.setMasterDelayAmount(this.chaospadDefaults.delayAmount),this.currentDelayAmountValue=this.chaospadDefaults.delayAmount;break;case"delayFeedback":le.setMasterDelayFeedback(this.chaospadDefaults.delayFeedback),this.currentDelayFeedbackValue=this.chaospadDefaults.delayFeedback;break;case"reverbAmount":le.setMasterReverbAmount(this.chaospadDefaults.reverbAmount),this.currentReverbAmountValue=this.chaospadDefaults.reverbAmount;break;case"reverbRoomSize":le.setMasterReverbRoomSize(this.chaospadDefaults.reverbRoomSize),this.currentReverbRoomSizeValue=this.chaospadDefaults.reverbRoomSize;break}this.updateChaospadVirtualGravity(.5,.5,"restore"),console.log("🎛️ Chaospad: Restored defaults",this.chaospadDefaults)}async getMasterPatternWithoutVisualizer(){let e=le.getMasterPatternCode();if(!e||e.trim()===""){if(le.trackedPatterns&&le.trackedPatterns.size>0&&(console.log(`🔄 Master pattern empty; rebuilding from ${le.trackedPatterns.size} tracked pattern(s)`),le.updateMasterPattern(new Set,new Set),e=le.getMasterPatternCode()),!e||e.trim()===""){const t=In("master-pattern").trim();t&&(console.log("📝 Falling back to master editor contents"),e=t)}(!e||e.trim()==="")&&(console.warn("⚠️ No master pattern available; using silence"),e="silence")}return e=e.replace(/\/\/.*$/gm,""),e=e.replace(/\/\*[\s\S]*?\*\//g,t=>/\/\*\s*Channel\s+\d+\s*\*\//i.test(t)?t:""),e=e.replace(/\n\s*\n/g,`
`).trim(),this.stripVisualizerMethods(e)}stripVisualizerMethods(e){if(!e)return e;const t=(a,i)=>{let o=1;for(let l=i+1;l<a.length;l++)if(a[l]==="(")o++;else if(a[l]===")"&&(o--,o===0))return l;return-1},s=["scope","tscope","fscope","spectrum","visual","pianoroll","barchart"];let r=e;return s.forEach(a=>{const i=new RegExp(`\\.\\s*_?${a}\\s*\\(`,"gi");let o;for(;(o=i.exec(r))!==null;){const l=o.index,c=o.index+o[0].length-1,u=t(r,c);if(u!==-1)r=r.substring(0,l)+r.substring(u+1),i.lastIndex=0;else break}}),r.trim().replace(/\.\s*$/,"").replace(/\.\.+/g,".").trim()}shouldUseSpiralVisualizer(e){return e?/\.\s*_?spiral\s*\(/i.test(e):!1}shouldUseScopeVisualizer(e){return e?/\.\s*_?(?:t?scope)\s*\(/i.test(e):!1}shouldUseSpectrumVisualizer(e){return e?/\.\s*_?spectrum\s*\(/i.test(e):!1}shouldUsePitchwheelVisualizer(e){return e?/\.\s*_?pitchwheel\s*\(/i.test(e):!1}shouldUsePianorollVisualizer(e){return e?/\.\s*_?pianoroll\s*\(/i.test(e):!1}shouldUseBarchartVisualizer(e){return e?/\.\s*_?barchart\s*\(/i.test(e):!1}extractSpiralOptions(e){if(!e)return{};const t=e.match(/\.\s*_?spiral\s*\(\s*\{([^}]*)\}\s*\)/i);if(!t)return{};const s={};return t[1].split(",").forEach(a=>{const[i,o]=a.split(":");if(!i||!o)return;const l=i.trim(),c=o.trim(),u=Number(c.replace(/[^0-9.+-eE]/g,""));Number.isNaN(u)?/true|false/i.test(c)?s[l]=/^true$/i.test(c):s[l]=c.replace(/['"]/g,""):s[l]=u}),s}async getMasterPunchcardContext(){if(!this.masterPunchcardCanvas)return null;if(!this.masterPunchcardCtx)try{const{getDrawContext:e}=await ds(async()=>{const{getDrawContext:s}=await import("./strudel-web-Ddx65js9.js").then(r=>r.i);return{getDrawContext:s}},__vite__mapDeps([0,1])),t=e(this.masterPunchcardCanvas.id,{contextType:"2d"});t&&typeof t.setTransform=="function"?this.masterPunchcardCtx=t:t&&t.canvas?this.masterPunchcardCtx=t.canvas.getContext("2d"):this.masterPunchcardCtx=this.masterPunchcardCanvas.getContext("2d")}catch(e){console.warn("⚠️ Falling back to native canvas context:",e),this.masterPunchcardCtx=this.masterPunchcardCanvas.getContext("2d")}return this.masterPunchcardCtx&&typeof this.masterPunchcardCtx.setTransform!="function"&&(console.warn("⚠️ Context from getDrawContext does not have setTransform, using native context"),this.masterPunchcardCtx=this.masterPunchcardCanvas.getContext("2d")),this.masterPunchcardCtx}drawMasterPunchcardCanvas(e,t){const s=this.masterPunchcardCanvas,r=this.getMasterPunchcardContext();if(!s||!r)return;const a=this.masterPunchcardContainer.getBoundingClientRect(),i=Math.max(a.width||this.masterPunchcardContainer.offsetWidth||600,240),o=Math.max(a.height||this.masterPunchcardContainer.offsetHeight||200,200),l=window.devicePixelRatio||1;(s.width!==i*l||s.height!==o*l)&&(s.width=i*l,s.height=o*l,s.style.width=`${i}px`,s.style.height=`${o}px`),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,s.width,s.height),r.save(),r.setTransform(l,0,0,l,0,0);const c=16,u=i-c*2,h=o-c*3,d=c,m=o-c*1.5,y=r.createLinearGradient(0,0,i,o);y.addColorStop(0,"rgba(102, 126, 234, 0.06)"),y.addColorStop(1,"rgba(118, 75, 162, 0.08)"),r.fillStyle=y,r.fillRect(0,0,i,o);const{counts:O,hits:S}=t,{totalSteps:A,stepsPerBeat:F}=e;O.length!==A&&console.warn("⚠️ Punchcard data length mismatch",{expected:A,received:O.length});const j=Math.max(...O,1e-4),N=u/A;r.strokeStyle="rgba(102, 126, 234, 0.25)",r.lineWidth=1,r.beginPath();for(let $=0;$<=A;$+=F){const L=d+$*N;r.moveTo(L,m),r.lineTo(L,m-h)}r.stroke(),O.forEach(($,L)=>{const I=Math.max($/j,0),q=h*I,ce=d+L*N,ee=m-q;if(q<=2){r.fillStyle="rgba(148, 163, 184, 0.35)",r.fillRect(ce+N*.3,m-3,N*.4,3);return}const he=r.createLinearGradient(ce,ee,ce,m);he.addColorStop(0,"rgba(102, 126, 234, 0.9)"),he.addColorStop(1,"rgba(118, 75, 162, 0.85)"),r.fillStyle=he;const H=ce+N*.2,me=N*.6,Oe=Math.min(N*.3,8);typeof r.roundRect=="function"?(r.beginPath(),r.roundRect(H,ee,me,q,Oe),r.fill()):r.fillRect(H,ee,me,q);const Pe=S==null?void 0:S[L];if(Pe&&Pe.length){r.fillStyle="rgba(26, 32, 44, 0.75)",r.font='10px "Fira Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',r.textAlign="center",r.textBaseline="bottom";const De=Pe.slice(0,2).join(" • ");r.fillText(De,ce+N/2,ee-4)}}),r.strokeStyle="rgba(79, 70, 229, 0.55)",r.lineWidth=1.5,r.beginPath(),r.moveTo(d,m),r.lineTo(d+u,m),r.stroke(),r.restore()}renderMasterSpiral(e,t,s={}){if(!this.masterPunchcardContainer||!this.masterPunchcardCanvas)return;const r=t.events||[];if(!r.length){this.showMasterPunchcardPlaceholder();return}this.hideMasterPunchcardPlaceholder(),this.drawMasterSpiralCanvas(e,r,s)}drawMasterSpiralCanvas(e,t,s={}){const r=this.masterPunchcardCanvas,a=this.getMasterPunchcardContext();if(!r||!a)return;const i=this.masterPunchcardContainer.getBoundingClientRect(),o=Math.max(i.width||this.masterPunchcardContainer.offsetWidth||320,240),l=Math.max(i.height||this.masterPunchcardContainer.offsetHeight||240,220),c=window.devicePixelRatio||1;(r.width!==o*c||r.height!==l*c)&&(r.width=o*c,r.height=l*c,r.style.width=`${o}px`,r.style.height=`${l}px`),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,r.width,r.height),a.save(),a.setTransform(c,0,0,c,0,0);const u=Number.isFinite(s.padding)?s.padding:32,h=Number.isFinite(s.inset)?s.inset:3,d=Number.isFinite(s.stretch)?s.stretch:1,m=Number.isFinite(s.rotations)?s.rotations:Math.max(e.numerator??4,4),y=Number.isFinite(s.steady)?s.steady:.9,O=Number.isFinite(s.thickness)?s.thickness:6,S=typeof s.cap=="string"?s.cap:"round",A=a.createLinearGradient(0,0,o,l);A.addColorStop(0,"rgba(102, 126, 234, 0.08)"),A.addColorStop(1,"rgba(118, 75, 162, 0.12)"),a.fillStyle=A,a.fillRect(0,0,o,l);const F=o/2,j=l/2,$=Math.max(Math.min(o,l)/2-u,40)/Math.max(m+h+1,1),I=y*0,q={margin:$,cx:F,cy:j,stretch:d,cap:S,thickness:O},ce="rgba(76, 81, 191, 0.85)",ee="rgba(148, 163, 184, 0.35)",he=Math.max(...t.map(Oe=>Oe.weight??1),1),H=m;t.forEach(Oe=>{const Pe=Number.isFinite(Oe.begin)?Oe.begin:0,De=Number.isFinite(Oe.endClipped)?Oe.endClipped:Number.isFinite(Oe.end)?Oe.end:Pe,Se=Number.isFinite(Oe.weight)?Math.max(Oe.weight,.1):1,ae=Oe.color||ce,Ee=h+Pe*H,Qe=h+Math.max(De,Pe)*H;G7(a,{...q,from:Ee,to:Qe,rotate:I,thickness:q.thickness*(.6+Se/he*.8),color:ae})});const me=h+H+1;G7(a,{...q,from:h,to:me,rotate:I,color:ee,thickness:q.thickness*.6,fromOpacity:.35,toOpacity:.1}),a.restore()}async computeMasterPunchcardData(e,t){try{le.strudelLoaded||await le.initStrudel()}catch(F){return console.warn("⚠️ Unable to initialize Strudel for punchcard:",F),{error:"Strudel is not ready yet."}}if(!window.strudel||typeof window.strudel.evaluate!="function")return{error:"Strudel evaluate function is unavailable."};let s=e;console.log("═══════════════════════════════════════════════════════════"),console.log("🔍 PUNCHCARD EVALUATION - Original pattern:"),console.log("   Full pattern:",s),console.log("───────────────────────────────────────────────────────────"),s=s.replace(/\/\/.*$/gm,""),s=s.replace(/\/\*[\s\S]*?\*\//g,""),s=s.replace(/\n\s*\n/g,`
`).trim(),s=s.replace(/\)\s*\.\s*\((gain|pan)\s*\(/g,").$1("),/\)\s*\.\s*(gain|pan)\s*\(/.test(s)||(s=s.replace(/([a-zA-Z_$][a-zA-Z0-9_$]*\s*\([^()]*\)(?:\s*\.\s*[a-zA-Z_$][a-zA-Z0-9_$]*\s*\([^()]*\))*)\s*\.\s*(gain|pan)\s*\(/g,(F,j,N)=>j.trim().startsWith("(")?F:`(${j}).${N}(`)),console.log("🔍 PUNCHCARD EVALUATION - After removing comments and fixing modifiers:"),console.log("   Pattern:",s),console.log("───────────────────────────────────────────────────────────");const a=(F,j)=>{let N=1;for(let $=j+1;$<F.length;$++)if(F[$]==="(")N++;else if(F[$]===")"&&(N--,N===0))return $;return-1},i=["scope","tscope","fscope","spectrum","visual","spiral"];if(i.forEach(F=>{const j=new RegExp(`\\.\\s*_?${F}\\s*\\(`,"gi");let N,$=0;for(;(N=j.exec(s))!==null;){const L=N.index,I=N.index+N[0].length-1,q=a(s,I);if(q!==-1)s=s.substring(0,L)+s.substring(q+1),$++,console.log(`  Stripped .${F}(...) occurrence #${$}`),j.lastIndex=0;else{console.warn(`  Could not find matching ) for .${F}( at position ${I}`);break}}}),s=s.trim(),s=s.replace(/\.\s*$/,"").replace(/\.\.+/g,".").trim(),console.log("🔍 PUNCHCARD EVALUATION - After stripping:"),console.log("   Stripped pattern:",s),console.log("───────────────────────────────────────────────────────────"),!s||s.trim()==="")return console.warn("⚠️ Pattern is empty after stripping visualizers"),{error:"Pattern is empty after removing visualizers."};if(i.some(F=>new RegExp(`\\.\\s*_?${F}\\s*\\(`,"i").test(s)))return console.warn("═══════════════════════════════════════════════════════════"),console.warn("⚠️ PUNCHCARD EVALUATION - FAILED TO STRIP VISUALIZERS"),console.warn("   Pattern still contains visualizers after stripping:"),console.warn("   ",s),console.warn("   This will cause Mini parser errors. Skipping punchcard evaluation."),console.warn("═══════════════════════════════════════════════════════════"),{error:"Pattern contains visualizers that could not be stripped."};if(console.log("✅ PUNCHCARD EVALUATION - Ready to evaluate (no visualizers detected)"),console.log("═══════════════════════════════════════════════════════════"),!s||s.trim()==="")return console.warn("⚠️ Pattern is empty after stripping - cannot evaluate"),{error:"Pattern is empty after processing"};console.log("📝 Final pattern to evaluate:",s);try{await le.ensurePatternResourcesLoaded(s)}catch(F){console.warn("⚠️ Unable to preload resources for punchcard evaluation:",F)}const l=F=>{if(F==null)return 0;if(typeof F=="number")return F;if(typeof F.valueOf=="function"){const N=F.valueOf();if(typeof N=="number"&&!Number.isNaN(N))return N}if(typeof F=="object"&&F!==null&&"n"in F&&"d"in F){const N=Number(F.n??0),$=Number(F.d??1);return $!==0?N/$:0}const j=Number(F);return Number.isFinite(j)?j:0},c=F=>F?typeof F=="string"?F:F.label?F.label:F.sample?F.sample:F.s?F.s:F.note?F.note:F.n?F.n:F.sound?F.sound:F.instrument?F.instrument:null:null;let u;try{const{coreModule:F}=await nc(),j=F==null?void 0:F.evaluate,{transpiler:N}=await ds(async()=>{const{transpiler:L}=await Promise.resolve().then(()=>Ohe);return{transpiler:L}},void 0),$=await j(s,N,{wrapAsync:!1,addReturn:!1,emitMiniLocations:!1});u=$==null?void 0:$.pattern,console.log("🔍 Evaluated pattern object:",u)}catch(F){return console.error("❌ Failed to evaluate pattern for punchcard:",F),{error:(F==null?void 0:F.message)||"Pattern evaluation failed."}}if(!u&&window.strudel&&typeof window.strudel.evaluate=="function"){console.log("🔁 strudelCoreEvaluate returned no pattern - attempting fallback via window.strudel.evaluate");try{const F=`globalThis.__punchcard_pattern = ${s}`;console.log("🔍 Fallback evaluation code:",F.substring(0,200));const j=await window.strudel.evaluate(F);if(globalThis.__punchcard_pattern)u=globalThis.__punchcard_pattern,console.log("🔍 Fallback pattern object from globalThis:",u);else if(j&&typeof j.queryArc=="function")u=j,console.log("🔍 Fallback pattern object from eval result:",u);else if(j&&j._Pattern)u=j,console.log("🔍 Fallback pattern object (has _Pattern):",u);else{const N=await window.strudel.evaluate(s);N&&(typeof N.queryArc=="function"||N._Pattern)&&(u=N,console.log("🔍 Fallback pattern object from direct eval:",u))}}catch(F){console.warn("⚠️ Fallback evaluation failed:",F),console.warn("⚠️ Pattern that failed:",s.substring(0,200))}}if(!(u&&(typeof u.queryArc=="function"||typeof u.query=="function"||u._Pattern===!0))){if(console.warn("⚠️ Pattern did not return a valid Strudel pattern object"),console.warn("⚠️ Pattern object type:",typeof u),console.warn("⚠️ Pattern object:",u),console.warn("⚠️ Pattern that failed:",s.substring(0,300)),window.strudel&&typeof window.strudel.evaluate=="function")try{const j=`(${s})`,N=await window.strudel.evaluate(j);N&&(typeof N.queryArc=="function"||typeof N.query=="function"||N._Pattern===!0)&&(u=N,console.log("✅ Last attempt succeeded with wrapped pattern"))}catch(j){console.warn("⚠️ Last attempt also failed:",j)}if(!(u&&(typeof u.queryArc=="function"||typeof u.query=="function"||u._Pattern===!0)))return{error:"Pattern expression did not return a Strudel pattern."}}let d;try{if(typeof u.queryArc=="function")d=u.queryArc(0,1)||[];else if(typeof u.query=="function")d=u.query(0,1)||[];else if(u.__steps&&typeof u.__steps=="object")d=[],console.warn("⚠️ Pattern has _Pattern but no queryArc/query - attempting to extract haps from __steps");else throw new Error("Pattern object does not have queryArc, query, or __steps")}catch(F){return console.error("❌ Failed to query pattern arc for punchcard:",F),{error:(F==null?void 0:F.message)||"Pattern queryArc failed."}}try{delete globalThis.__punchcard_pattern}catch{globalThis.__punchcard_pattern=void 0}const m={events:d.map(F=>{const j=F==null?void 0:F.part,N=F==null?void 0:F.whole,$=l(j?j.begin??j.start??0:(N==null?void 0:N.begin)??0);let L=l(j?j.end??j.finish??j.begin??0:(N==null?void 0:N.end)??(N==null?void 0:N.begin)??0);(!Number.isFinite(L)||L<$)&&(L=$);const I=(F==null?void 0:F.value)??null,q=c(I),ce=I&&typeof I=="object"?I.note??I.n??null:null,ee=I&&typeof I=="object"?I.sound??I.s??null:null,he=I&&typeof I=="object"?I.sample??null:null,H=I&&typeof I=="object"?I.instrument??null:null,me=I&&typeof I=="object"?I.source??I.path??null:null,Oe=typeof I=="string"?I:null,Pe=I&&typeof I=="object"&&I.velocity!=null?Number(I.velocity):1,De=I&&typeof I=="object"&&I.gain!=null?Number(I.gain):1,Se=(Number.isFinite(Pe)?Pe:1)*(Number.isFinite(De)?De:1);return{begin:$,end:L,endClipped:l((F==null?void 0:F.endClipped)??L),wholeBegin:l((N==null?void 0:N.begin)??$),wholeEnd:l((N==null?void 0:N.end)??L),label:q,weight:Number.isFinite(Se)&&Se>0?Se:1,color:I&&typeof I=="object"&&I.color?I.color:null,tags:Array.isArray(F==null?void 0:F.tags)?F.tags:[],meta:{label:q,note:ce,sound:ee,sample:he,instrument:H,source:me,rawString:Oe}}})};if(!m||m.error)return console.warn("⚠️ Parsed result has error:",m==null?void 0:m.error),{error:(m==null?void 0:m.error)||"Unknown error from Strudel evaluation."};const{totalSteps:y}=t,O=new Array(y).fill(0),S=new Array(y).fill(null).map(()=>[]),A=m.events||[];return A.forEach(F=>{if(!F)return;const{begin:j,end:N,endClipped:$,label:L,weight:I}=F,q=(Number(j)%1+1)%1,ce=Number.isFinite($)?$:N;let ee=(Number(ce)%1+1)%1;(!Number.isFinite(ee)||ee<q)&&(ee=q);const he=Math.min(y-1,Math.max(0,Math.floor(q*y))),H=Math.min(y-1,Math.max(he,Math.ceil(ee*y)-1)),me=Number.isFinite(I)?Math.max(I,.1):1;for(let Oe=he;Oe<=H;Oe+=1)if(O[Oe]+=me,L){const Pe=S[Oe];Pe.includes(L)||Pe.push(L)}}),{counts:O,hits:S,events:A}}enableNativeStrudelHighlighting(){this.nativeHighlightingEnabled=!0,this.nativeHighlightingDisabled=!1,typeof(le==null?void 0:le.setEditorHighlightingEnabled)=="function"&&le.setEditorHighlightingEnabled(!0)}updateMasterPatternDisplay(){if(!this.masterPatternField)return;const e=le.getMasterPatternCode();e&&e.trim()!==""?(Ln("master-pattern",e),this.masterPatternField.placeholder="",console.log(`📝 Updated master pattern display: ${e.substring(0,100)}...`)):(Ln("master-pattern",""),this.masterPatternField.placeholder="Combined pattern will appear here...")}updateMasterIndicators(){hs.elements.forEach(e=>{const t=e.id,s=document.querySelector(`[data-sound-id="${t}"]`);if(s){const r=s.querySelector(".master-status-indicator");r&&(le.trackedPatterns.has(t)?r.classList.add("active"):r.classList.remove("active"))}})}registerElements(e=null){(e||hs.elements.map(s=>{const r=document.querySelector(s.selector);return r?{element:r,elementId:s.id}:null}).filter(s=>s!==null)).forEach(({element:s,elementId:r})=>{s&&(s.getAttribute("data-sound-id"),s.addEventListener("click",a=>{if(a.target.classList.contains("config-button")||a.target.classList.contains("pause-button")||a.target.classList.contains("solo-button")||a.target.classList.contains("mute-button")||a.target.classList.contains("gain-slider")||a.target.classList.contains("pan-slider")||a.target.classList.contains("collapsible-toggle")||a.target.classList.contains("collapsible-content")||a.target.classList.contains("effect-slider")||a.target.classList.contains("filter-slider")||a.target.closest(".collapsible-section"))return;const i=s.getAttribute("data-sound-id");console.log(`🖱️ Click triggered for ${i}`),this.activeElements.has(i)?this.deactivateElement(i,s,"click"):this.activateElement(i,s,"click")}))})}setupElementControls(){hs.elements.forEach(e=>{const t=document.querySelector(e.selector);if(!t)return;const s=e.id,r=t.querySelector(".gain-slider"),a=t.querySelector(".pan-slider");if(r){const c=parseFloat(r.value);le.setElementGain(s,c),r.addEventListener("input",u=>{u.stopPropagation();const h=parseFloat(u.target.value);le.setElementGain(s,h),le.updateTrackedElementGain(s,h),this.updateMasterPatternDisplay()})}if(a){const c=parseFloat(a.value);le.setElementPan(s,c),a.addEventListener("input",u=>{u.stopPropagation();const h=parseFloat(u.target.value);le.setElementPan(s,h),le.updateTrackedElementPan(s,h),this.updateMasterPatternDisplay()})}const i=t.querySelector(".pause-button");i&&i.addEventListener("click",async c=>{c.stopPropagation(),await this.handlePauseButton(s)});const o=t.querySelector(".solo-button");o&&o.addEventListener("click",c=>{c.stopPropagation(),this.handleSoloButton(s,o)});const l=t.querySelector(".mute-button");l&&l.addEventListener("click",c=>{c.stopPropagation(),this.handleMuteButton(s,l)}),this.initializeMidiControls(t,s)})}initializeMidiControls(e,t){if(!e||!t)return;const s=e.querySelector(".midi-enable-toggle"),r=e.querySelector(".midi-channel-select");(()=>{const i=this.getElementMidiSettings(t);s&&(s.checked=!!i.enabled),r&&(r.value=String(i.channel),r.disabled=!i.enabled)})(),s&&!s.dataset.hasListener&&(s.dataset.hasListener="true",s.addEventListener("change",i=>{const o=!!i.target.checked;r&&(r.disabled=!o),this.updateElementMidiSettings(t,{enabled:o})})),r&&!r.dataset.hasListener&&(r.dataset.hasListener="true",r.addEventListener("change",i=>{const o=parseInt(i.target.value,10)||1;this.updateElementMidiSettings(t,{channel:o})}))}getElementMidiSettings(e){var s;if(this.elementMidiSettings||(this.elementMidiSettings={}),this.elementMidiSettings[e]){const r=this.elementMidiSettings[e];return{enabled:!!r.enabled,channel:this.normalizeMidiChannel(r.channel)}}const t=this.deriveMidiSettingsFromPattern((s=hs.getElementConfig(e))==null?void 0:s.pattern)||{enabled:!1,channel:1};return this.elementMidiSettings[e]=t,t}normalizeMidiChannel(e){const t=Number(e);return Number.isFinite(t)?Math.min(16,Math.max(1,Math.round(t))):1}updateElementMidiSettings(e,t={}){if(!e)return;const s=this.getElementMidiSettings(e),r={enabled:t.enabled!==void 0?!!t.enabled:s.enabled,channel:this.normalizeMidiChannel(t.channel!==void 0?t.channel:s.channel)};this.elementMidiSettings[e]=r,this.persistMidiSettings(),this.applyMidiSettingsToPattern(e)}loadStoredMidiSettings(){try{const e=localStorage.getItem("element-midi-settings");if(!e)return{};const t=JSON.parse(e);if(!t||typeof t!="object")return{};const s={};return Object.entries(t).forEach(([r,a])=>{!a||typeof a!="object"||(s[r]={enabled:!!a.enabled,channel:this.normalizeMidiChannel(a.channel)})}),s}catch(e){return console.warn("⚠️ Unable to load MIDI settings:",e),{}}}persistMidiSettings(){try{localStorage.setItem("element-midi-settings",JSON.stringify(this.elementMidiSettings||{}))}catch(e){console.warn("⚠️ Unable to persist MIDI settings:",e)}}deriveMidiSettingsFromPattern(e){if(!e||!/\.midi\b/i.test(e))return null;const t=e.match(/\.midiport\s*\(\s*(\d+)\s*\)/i);return{enabled:!0,channel:t?this.normalizeMidiChannel(parseInt(t[1],10)+1):1}}stripMidiModifiers(e){if(!e)return e;let t=e;return t=t.replace(/\.midiport\s*\([^)]*\)/gi,""),t=t.replace(/\.midi\s*\([^)]*\)/gi,""),t=t.replace(/\.midi\b/gi,""),t=t.replace(/\.\.+/g,"."),t=t.replace(/\s+\./g,"."),t=t.replace(/\.\s*$/,""),t.trim()}getPatternWithMidi(e,t){if(!t)return t;const s=this.stripMidiModifiers(t),r=this.getElementMidiSettings(e);if(!r.enabled)return s;const i=`.midi().midiport(${Math.max(0,this.normalizeMidiChannel(r.channel)-1)})`;if(/\.postgain\s*\(/i.test(s)){const o=s.search(/\.postgain\s*\(/i);return s.slice(0,o)+i+s.slice(o)}return`${s}${i}`}async applyMidiSettingsToPattern(e,t={}){var h;if(!e)return;const{persistConfig:s=!0}=t,r=this.loadElementConfig(e),a=hs.getElementConfig(e),i=(h=le.trackedPatterns)==null?void 0:h.get(e);let o=(r==null?void 0:r.pattern)||(i==null?void 0:i.pattern)||(i==null?void 0:i.rawPattern)||(a==null?void 0:a.pattern)||"";if(!o||o.trim()==="")return;const l=this.getPatternWithMidi(e,o);if(!l||l===o)return;if(s){const d={...r||{},pattern:l};if(this.saveElementConfig(e,d,!0),this.currentEditingElementId===e&&typeof Ln=="function")try{Ln("modal-pattern",l)}catch(m){console.warn("⚠️ Unable to update modal pattern with MIDI changes:",m)}}const c=le.trackedPatterns&&le.trackedPatterns.has(e),u=le.isPlaying(e);try{c?(await le.updatePatternInPlace(e,l,!0),this.updateMasterPatternDisplay()):u?await le.updatePatternInPlace(e,l):await le.preEvaluatePattern(e,l)}catch(d){console.warn(`⚠️ Unable to apply MIDI settings to ${e}:`,d)}}async saveChannelWithMidi(e){var i,o,l,c;const{getCurrentUser:t}=await ds(async()=>{const{getCurrentUser:u}=await Promise.resolve().then(()=>dc);return{getCurrentUser:u}},void 0);if(!await t()){alert("Please log in to save patterns");return}const r=this.loadElementConfig(e);if(!r||!r.pattern){(o=(i=this.uiController)==null?void 0:i.updateStatus)==null||o.call(i,"Nothing to save for this channel.");return}const a=this.getPatternWithMidi(e,r.pattern);window.savePatternDialog?(await window.savePatternDialog.show(a,"channel",e),window.savePatternDialog.setOnSave(async()=>{var h,d;const u={...r,pattern:a};this.saveElementConfig(e,u,!1),La.markChannelSnapshot(e,a),(d=(h=this.uiController)==null?void 0:h.updateStatus)==null||d.call(h,`Saved channel ${e} to cloud.`)})):(c=(l=this.uiController)==null?void 0:l.updateStatus)==null||c.call(l,"Save dialog not available.")}applyChannelHistoryEntry(e,t){var a,i;if(!e||!t)return;const s=t.trim(),r=this.loadElementConfig(e)||{};La.markChannelSnapshot(e,s),this.saveElementConfig(e,{...r,pattern:s},!0),this.currentEditingElementId!==e&&(this.openConfigModal?this.openConfigModal(e):console.warn("⚠️ openConfigModal not available, modal may not open")),setTimeout(()=>{Ln("modal-pattern",s)},50),(i=(a=this.uiController)==null?void 0:a.updateStatus)==null||i.call(a,`Loaded history for ${e}. Save to apply.`)}applyMasterHistoryEntry(e){var s,r;if(!e)return;const t=e.trim();Ln("master-pattern",t),le.masterPattern=t,La.markMasterSnapshot(t),this.updateMasterPatternDisplay(),(r=(s=this.uiController)==null?void 0:s.updateStatus)==null||r.call(s,"Loaded master pattern history entry.")}async saveMasterHistoryEntry(){var i,o,l,c;const{getCurrentUser:e}=await ds(async()=>{const{getCurrentUser:u}=await Promise.resolve().then(()=>dc);return{getCurrentUser:u}},void 0);if(!await e()){alert("Please log in to save patterns");return}const s=document.getElementById("master-pattern"),a=((s?s.value:"")||"").trim();if(!a){(o=(i=this.uiController)==null?void 0:i.updateStatus)==null||o.call(i,"Master pattern is empty.");return}window.savePatternDialog?(await window.savePatternDialog.show(a,"master",null),window.savePatternDialog.setOnSave(async u=>{var h,d;La.saveMasterVersion(a),La.markMasterSnapshot(a),le.masterPattern=a,this.updateMasterPatternDisplay(),(d=(h=this.uiController)==null?void 0:h.updateStatus)==null||d.call(h,"Saved master pattern to cloud.")})):(c=(l=this.uiController)==null?void 0:l.updateStatus)==null||c.call(l,"Save dialog not available.")}async handlePauseButton(e){const t=document.querySelector(`[data-sound-id="${e}"]`);if(!t)return;const s=t.querySelector(".element-indicator"),r=t.querySelector(".pause-button");(r==null?void 0:r.classList.contains("paused"))?(r==null||r.classList.remove("paused"),s==null||s.classList.remove("paused"),this.elementHasPattern(e)&&await le.triggerSound(e),console.log(`▶️ Resumed ${e}`)):(r==null||r.classList.add("paused"),s==null||s.classList.add("paused"),s==null||s.classList.remove("looped"),le.pauseSound(e),console.log(`⏸️ Paused ${e}`))}handleSoloButton(e,t){this.soloedElements.has(e)?(this.soloedElements.delete(e),t.classList.remove("active"),console.log(`🎵 Unsolo: ${e}`)):(this.soloedElements.add(e),t.classList.add("active"),console.log(`🎵 Solo: ${e}`)),this.updateElementAudioStates()}handleMuteButton(e,t){this.mutedElements.has(e)?(this.mutedElements.delete(e),t.classList.remove("active"),console.log(`🔊 Unmute: ${e}`)):(this.mutedElements.add(e),t.classList.add("active"),console.log(`🔇 Mute: ${e}`)),this.updateElementAudioStates()}updateElementAudioStates(){const e=this.soloedElements.size>0;hs.elements.forEach(t=>{const s=t.id,r=this.mutedElements.has(s),a=this.soloedElements.has(s);let i;r?i=0:e?i=a?1:0:i=1;const o=document.querySelector(`[data-sound-id="${s}"]`);if(o){const l=o.querySelector(".gain-slider"),c=l?parseFloat(l.value):.8;le.setElementGain(s,c*i)}}),le.updateMasterPattern(this.soloedElements,this.mutedElements),this.updateMasterPatternDisplay()}activateElement(e,t,s){if(console.log(`🎵 Activating ${e} via ${s}`),this.masterActive&&le.trackedPatterns.has(e)){console.log(`   ⚠️ Master is playing and ${e} is tracked - ignoring individual activation`),gs.updateStatus(`Cannot play ${e} individually while master is active. Stop master first.`);return}gs.setElementState(t,"focus"),this.updateStatusDots(e,this.elementHasPattern(e),!1),gs.updateStatus("Ready")}deactivateElement(e,t,s){if(console.log(`🔇 Deactivating ${e} (was triggered by ${s})`),this.activeElements.has(e)){this.activeElements.delete(e),console.log(`   Stopping sound for ${e}`),le.stopSound(e);const r=this.elementHasPattern(e);this.updateStatusDots(e,r,!1),gs.setElementState(t,null),this.updateActiveElementsDisplay(),this.activeElements.size===0&&gs.updateStatus("Ready")}}updateActiveElementsDisplay(){const e=Array.from(this.activeElements).map(s=>{const r=hs.getElementConfig(s);return(r==null?void 0:r.description)||s});gs.updateActiveElements(e);const t=document.getElementById("slots-info");if(t){const s=le.trackedPatterns?Array.from(le.trackedPatterns.keys()):[],r=new Set([...this.activeElements,...s]);if(r.size===0)t.textContent="None active";else{const a=Array.from(r).map(i=>{let o="";const l=document.querySelector(`[data-sound-id="${i}"]`);if(l){const c=l.querySelector(".element-title");c&&(o=c.textContent.trim())}if(!o)try{const c=localStorage.getItem(`element-config-${i}`);if(c){const u=JSON.parse(c);o=u.title||u.description||""}}catch{}if(!o){const c=hs.getElementConfig(i);o=(c==null?void 0:c.description)||i}return o});t.textContent=a.join(" | ")}}}elementHasPattern(e){const t=hs.getElementConfig(e);if(t!=null&&t.pattern&&t.pattern.trim()!=="")return!0;try{const s=localStorage.getItem(`element-config-${e}`);if(s){const r=JSON.parse(s);if(r.pattern&&r.pattern.trim()!=="")return!0}}catch{}return!1}updateStatusDots(e,t,s){const r=document.querySelector(`[data-sound-id="${e}"]`);if(!r)return;const a=r.querySelector(".loaded-dot"),i=r.querySelector(".playing-dot"),o=r.querySelector(".element-circle");if(a&&(t?a.classList.remove("active"):a.classList.add("active")),i){const l=this.loadElementConfig(e);l&&l.pattern&&l.pattern.trim()!==""?(i.classList.add("active"),s?i.classList.add("is-playing"):i.classList.remove("is-playing")):(i.classList.remove("active"),i.classList.remove("is-playing"))}o&&(s?(o.classList.add("playing"),console.log(`🟢 Circle turned green for ${e} (playing)`)):o.classList.remove("playing"))}isDrumPattern(e){if(!e||typeof e!="string")return!1;const t=e.match(/sound\(["']([^"']+)["']\)|s\(["']([^"']+)["']\)/);if(!t)return!1;const s=t[1]||t[2];return s?s.split(/\s+/).filter(i=>i.trim()).some(i=>QG.hasOwnProperty(i.toLowerCase())):!1}convertNumericPatternToNoteNames(e,t,s){if(!e||!s)return e;const r=S=>typeof S=="string"&&/[b]/i.test(S),a=new Map([["Abb","G"],["Bbb","A"],["Cbb","Bb"],["Dbb","C"],["Ebb","D"],["Fbb","Eb"],["Gbb","F"],["A##","B"],["B##","C#"],["C##","D"],["D##","E"],["E##","F#"],["F##","G"],["G##","A"],["Fb","E"],["Cb","B"],["E#","F"],["B#","C"]]),i=new Map([["A#","Bb"],["C#","Db"],["D#","Eb"],["F#","Gb"],["G#","Ab"]]);function o(S,A){const F=S.match(/^([A-Ga-g])([#b]{0,2})(-?\d+)?$/);if(!F)return S;const j=F[1].toUpperCase(),N=F[2]||"",$=F[3]||"",L=`${j}${N}`;if(a.has(L))return`${a.get(L)}${$}`;if(A&&N==="#"){const I=i.get(`${j}#`);if(I)return`${I}${$}`}return`${j}${N}${$}`}const c={major:"major",minor:"minor",chromatic:"chromatic",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic",ionian:"major",aeolian:"minor","melodic minor":"melodic minor","dorian b2":"dorian b2","lydian augmented":"lydian augmented","lydian dominant":"lydian dominant","mixolydian b6":"mixolydian b6","locrian #2":"locrian #2",altered:"altered","harmonic minor":"harmonic minor","locrian #6":"locrian #6","ionian #5":"ionian #5","dorian #4":"dorian #4","phrygian dominant":"phrygian dominant","lydian #2":"lydian #2",ultralocrian:"ultralocrian","harmonic major":"harmonic major","dorian b5":"dorian b5","phrygian b4":"phrygian b4","lydian b3":"lydian b3","mixolydian b2":"mixolydian b2","lydian augmented #2":"lydian augmented #2","locrian bb7":"locrian bb7","major pentatonic":"major pentatonic","suspended pentatonic":"suspended pentatonic","man gong":"man gong",ritusen:"ritusen","minor pentatonic mode 5":"minor pentatonic","minor pentatonic":"minor pentatonic","blues minor pentatonic":"minor pentatonic","major pentatonic mode 3":"major pentatonic",egyptian:"egyptian","minor pentatonic mode 5":"minor pentatonic","whole tone":"whole tone","half-whole diminished":"dominant diminished","whole-half diminished":"diminished","minor blues":"blues"}[s]||s;let u="C";if(t){const S=t.trim().match(/^([a-gA-G])([#b]?)/);S?u=`${S[1].toUpperCase()}${S[2]||""}`:u=t.trim()}const h=`${u} ${c}`,d=_o.get(h);if(!d||!d.notes||d.notes.length===0)return console.warn(`⚠️ Could not get scale notes for "${h}"`),e;const m=r(u),y=d.notes.map(S=>o(`${S}`,m).replace(/-?\d+$/,""));console.log(`🎼 Scale "${h}" notes:`,y);const O=/\b(n|note)\s*\(\s*(["'])([^"']+)\2\s*\)/g;return e.replace(O,(S,A,F,j)=>{const N=/(\s+|[,;:<>()[\]{}|\\/]+|\*+)/g,$=[];let L=0,I;for(;(I=N.exec(j))!==null;)I.index>L&&$.push({type:"number",value:j.substring(L,I.index)}),$.push({type:"separator",value:I[0]}),L=I.index+I[0].length;L<j.length&&$.push({type:"number",value:j.substring(L)});const q=[];for(const ce of $)if(ce.type==="separator")q.push(ce.value);else{const ee=parseInt(ce.value.trim(),10);if(isNaN(ee))q.push(ce.value);else{const he=y.length||1,H=Math.floor(ee/he),me=(ee%he+he)%he,Oe=y[me],De=3+H,Se=o(`${Oe}${De}`,m);q.push(Se)}}return`note(${F}${q.join("")}${F})`})}getAllScaleNotesAsPattern(e,t){if(!t)return"";const r={major:"major",minor:"minor",chromatic:"chromatic",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic",ionian:"major",aeolian:"minor","dorian b2":"dorian b2","lydian augmented":"lydian augmented","lydian dominant":"lydian dominant","mixolydian b6":"mixolydian b6","locrian #2":"locrian #2",altered:"altered","harmonic minor":"harmonic minor","locrian #6":"locrian #6","ionian #5":"ionian #5","dorian #4":"dorian #4","phrygian dominant":"phrygian dominant","lydian #2":"lydian #2",ultralocrian:"ultralocrian","harmonic major":"harmonic major","dorian b5":"dorian b5","phrygian b4":"phrygian b4","lydian b3":"lydian b3","mixolydian b2":"mixolydian b2","lydian augmented #2":"lydian augmented #2","locrian bb7":"locrian bb7","major pentatonic":"major pentatonic","minor pentatonic":"minor pentatonic","suspended pentatonic":"suspended pentatonic","man gong":"man gong",ritusen:"ritusen","major pentatonic mode 3":"major pentatonic","minor pentatonic mode 5":"minor pentatonic","blues minor pentatonic":"minor pentatonic","whole tone":"whole tone","half-whole diminished":"dominant diminished","whole-half diminished":"diminished","minor blues":"blues"}[t]||t;let a="C";if(e){const u=e.trim().match(/^([a-gA-G])([#b]?)/);u?a=`${u[1].toUpperCase()}${u[2]||""}`:a=e.trim()}const i=`${a} ${r}`,o=_o.get(i);if(!o||!o.notes||o.notes.length===0)return console.warn(`⚠️ Could not get scale notes for "${i}"`),"";const l=o.notes;return console.log(`🎼 Scale "${i}" notes:`,l),`n("${Array.from({length:l.length},(u,h)=>h).join(" ")}")`}getAllScaleNotesAsNoteNames(e,t){if(!t)return"";const r={major:"major",minor:"minor",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic"}[t]||t;let a="C";if(e){const u=e.trim().match(/^([a-gA-G])([#b]?)/);u?a=`${u[1].toUpperCase()}${u[2]||""}`:a=e.trim()}const i=`${a} ${r}`,o=_o.get(i);if(!o||!o.notes||o.notes.length===0)return console.warn(`⚠️ Could not get scale notes for "${i}"`),"";const l=o.notes;return console.log(`🎼 Scale "${i}" notes:`,l),`note("${l.map(u=>`${u}4`).join(" ")}")`}resetAll(){console.log("🔄 Resetting all elements and master pattern..."),le.stopAllSounds(),document.querySelectorAll(".sound-element").forEach(r=>{const a=r.dataset.soundId;a&&parseInt(a.replace("element-",""))>this.initialElementCount&&(console.log(`🗑️ Removing dynamically created element: ${a}`),r.remove())}),this.elementCounter=this.initialElementCount,console.log("🗑️ Clearing all localStorage..."),localStorage.clear(),le.trackedPatterns.clear(),le.updateMasterPattern(),this.masterPatternField&&(Ln("master-pattern",""),this.masterPatternField.placeholder="Combined pattern will appear here..."),document.querySelectorAll(".sound-element").forEach(r=>{const a=r.dataset.soundId;if(a){const i=hs.getElementConfig(a);i&&(i.pattern="",i.description="No sound assigned",i.title="",i.sampleUrl="",i.bank=void 0,i.key=void 0,i.scale=void 0,i.keepNotesAsWritten=!1),le.removeElementFromMaster(a),Vi(a,""),this.updateStatusDots(a,!1,!1);const o=r.querySelector(".element-circle");o&&o.classList.remove("playing");const l=r.querySelector(".master-status-indicator");l&&l.classList.remove("active");const c=r.querySelector(".gain-slider"),u=r.querySelector(".pan-slider");c&&(c.value=.8),u&&(u.value=0);const h=r.querySelector(".midi-enable-toggle"),d=r.querySelector(".midi-channel-select");h&&(h.checked=!1),d&&(d.value="1",d.disabled=!0),this.elementMidiSettings&&delete this.elementMidiSettings[a]}}),this.activeElements.clear(),this.mutedElements.clear(),this.soloedElements.clear(),this.elementMidiSettings={},this.persistMidiSettings(),this.masterActive=!1,this.currentEditingElementId=null,this.selectedVisualizer="scope";const s=document.getElementById("visualizer-select");if(s&&(s.value="scope"),this.masterPunchcardCanvas){const r=this.masterPunchcardCanvas.getContext("2d");r&&r.clearRect(0,0,this.masterPunchcardCanvas.width,this.masterPunchcardCanvas.height)}this.updateActiveElementsDisplay(),this.updateMasterPatternDisplay(),this.updateMasterIndicators(),gs.updateStatus("✅ All cleared")}setAllElementsNotLoaded(){hs.elements.forEach(e=>{this.updateStatusDots(e.id,!1,!1)}),console.log("🔴 All element status dots marked as NOT loaded (red)")}setAllElementsLoaded(){hs.elements.forEach(e=>{let t=!1;if(e.pattern&&e.pattern.trim()!==""&&(t=!0),!t)try{const s=localStorage.getItem(`element-config-${e.id}`);if(s){const r=JSON.parse(s);r.pattern&&r.pattern.trim()!==""&&(t=!0)}}catch{}this.updateStatusDots(e.id,t,!1)}),console.log("✅ Element status dots updated based on configured patterns")}getStoredGdprConsent(){if(typeof localStorage>"u")return!1;try{return localStorage.getItem(F7)==="true"}catch{return!1}}setupGdprConsentFlow(){var e;if(this.gdprOverlay=document.getElementById("gdpr-consent-overlay"),this.gdprAcceptButton=document.getElementById("gdpr-accept-btn"),!this.gdprOverlay||!this.gdprAcceptButton){this.enablePostConsentFeatures();return}if(this.hasGdprConsent){this.hideGdprOverlay(),this.enablePostConsentFeatures();return}(e=document.body)==null||e.classList.add("gdpr-locked"),this.gdprOverlay.removeAttribute("hidden"),this.gdprOverlay.setAttribute("aria-hidden","false"),this.gdprAcceptButton.addEventListener("click",t=>{t.preventDefault(),this.handleGdprAccept()},{once:!0})}hideGdprOverlay(){var e;this.gdprOverlay&&(this.gdprOverlay.setAttribute("hidden","hidden"),this.gdprOverlay.setAttribute("aria-hidden","true")),(e=document.body)==null||e.classList.remove("gdpr-locked")}async handleGdprAccept(){if(this.hasGdprConsent){this.hideGdprOverlay(),this.enablePostConsentFeatures();return}this.hasGdprConsent=!0;try{typeof localStorage<"u"&&localStorage.setItem(F7,"true")}catch(e){console.warn("⚠️ Unable to persist GDPR consent:",e)}this.hideGdprOverlay(),this.enablePostConsentFeatures();try{le.isAudioReady()||await le.initialize()}catch(e){console.warn("⚠️ Audio initialization after consent failed:",e)}}enablePostConsentFeatures(){this.postConsentReady||(this.postConsentReady=!0,this.setupAudioInitialization())}setupAudioInitialization(){const e=async s=>{var r,a,i,o;if(console.log(`🎵 [AUDIO INIT] Event: ${s.type}, target: ${((r=s.target)==null?void 0:r.tagName)||"unknown"}`),console.log(`🎵 [AUDIO INIT] isAudioReady: ${le.isAudioReady()}, audioContext: ${!!le.audioContext}, state: ${((a=le.audioContext)==null?void 0:a.state)||"N/A"}`),le.isAudioReady())console.log(`🎵 [AUDIO INIT] Audio already ready, state: ${((o=le.audioContext)==null?void 0:o.state)||"N/A"}`),le.audioContext&&le.audioContext.state!=="running"&&(console.log(`🎵 [AUDIO INIT] Audio ready but context not running (${le.audioContext.state}), resuming...`),le.audioContext.resume().then(()=>{console.log(`🎵 [AUDIO INIT] Audio context resumed, state: ${le.audioContext.state}`)}).catch(l=>{console.error("🎵 [AUDIO INIT] Failed to resume:",l)}));else{console.log("🎵 [AUDIO INIT] Starting audio initialization...");const l=await le.initialize();console.log(`🎵 [AUDIO INIT] Initialize result: ${l}, audioContext state: ${((i=le.audioContext)==null?void 0:i.state)||"N/A"}`),l?(gs.updateStatus("Audio enabled - Loading sounds..."),t.forEach(({target:c,eventName:u,options:h})=>{c.removeEventListener(u,e,h)})):(console.error("🎵 [AUDIO INIT] Failed to initialize audio"),gs.updateStatus("Click to enable audio (required for sound playback)"))}},t=[{target:document,eventName:"click",options:!1},{target:document,eventName:"touchstart",options:{passive:!0}},{target:document,eventName:"touchend",options:{passive:!0}},{target:document,eventName:"pointerdown",options:{passive:!0}},{target:document,eventName:"keydown",options:!1},{target:document,eventName:"mousedown",options:!1},{target:window,eventName:"focus",options:!1}];t.forEach(({target:s,eventName:r,options:a})=>{s.addEventListener(r,e,a)})}loadAllElementConfigs(){hs.elements.forEach(e=>{const t=this.loadElementConfig(e.id);if(t){const s=t.title&&t.title.trim()?t.title:t.bank&&t.bank.trim()?jm[t.bank]||t.bank.replace("github:tidalcycles/",""):"";Vi(e.id,s),t.pattern!==void 0&&(e.pattern=t.pattern),t.title!==void 0&&(e.description=t.title)}else Vi(e.id,e.description||"")})}migrateLocalStorageQuotes(){try{console.log("🔧 Migrating localStorage to fix fancy quotes...");let e=0;for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);if(s&&s.startsWith("element-config-"))try{const r=localStorage.getItem(s);if(r){const a=JSON.parse(r);if(a&&a.pattern){const i=a.pattern,o=i.replace(/[""]/g,'"').replace(/['']/g,"'");i!==o&&(a.pattern=o,localStorage.setItem(s,JSON.stringify(a)),e++,console.log(`  ✅ Fixed quotes in ${s}`))}}}catch(r){console.warn(`  ⚠️ Could not migrate ${s}:`,r)}}e>0?console.log(`✅ Migrated ${e} patterns with fancy quotes`):console.log("✅ No patterns needed migration")}catch(e){console.error("Error during localStorage migration:",e)}}loadElementConfig(e){try{const t=localStorage.getItem(`element-config-${e}`);if(t){const s=JSON.parse(t);if(s&&s.pattern&&(s.pattern=s.pattern.replace(/[""]/g,'"').replace(/['']/g,"'"),s.pattern=U7(s.pattern)),s&&s.bank){const r=N0(s.bank);r!==s.bank&&console.log(`🔁 Normalized synth bank from "${s.bank}" to "${r}" for ${e}`),s.bank=r}if(s&&s.pattern&&(!this.elementMidiSettings||!this.elementMidiSettings[e])){const r=this.deriveMidiSettingsFromPattern(s.pattern);r&&(this.elementMidiSettings=this.elementMidiSettings||{},this.elementMidiSettings[e]=r,this.persistMidiSettings())}return s}}catch(t){console.error(`Error loading config for ${e}:`,t)}return null}saveElementConfig(e,t,s=!1){try{if(t.bank&&typeof t.bank=="string"){const u=N0(t.bank);u!==t.bank&&(console.log(`🔁 Normalized bank selection from "${t.bank}" to "${u}" before saving`),t.bank=u)}if(t.pattern&&typeof t.pattern=="string"){const u=U7(t.pattern);u!==t.pattern&&(console.log("🔁 Updated pattern to use canonical synth names before saving"),t.pattern=u),La.saveChannelVersion(e,t.pattern)}localStorage.setItem(`element-config-${e}`,JSON.stringify(t));const r=hs.getElementConfig(e);r&&(t.pattern!==void 0&&(r.pattern=t.pattern),t.title!==void 0&&(r.description=t.title),t.sampleUrl&&t.sampleUrl.trim()!==""?(r.audioFile=t.sampleUrl,r.type="audio"):(r.audioFile=void 0,r.type="strudel"));const a=t.title&&t.title.trim()?t.title:t.bank?jm[t.bank]||t.bank.replace("github:tidalcycles/",""):"";Vi(e,a);const i=document.querySelector(`[data-sound-id="${e}"]`);if(i){const u=t.pattern&&H3e(t.pattern),h=i.querySelector(".synthesis-section");h&&u&&(h.style.display="block",console.log(`✅ ${e}: Synthesis section shown for synth pattern`))}const o=t.pattern&&t.pattern.trim()!=="",l=this.activeElements.has(e);this.updateStatusDots(e,o,!1);const c=le.masterActive;if(t.pattern!==void 0&&(le.invalidatePatternCache(e),le.preEvaluatePattern(e,t.pattern).catch(u=>{console.log(`⚠️ Failed to pre-evaluate pattern for ${e}:`,u)})),!s&&t.pattern!==void 0&&t.pattern.trim()!==""){const u=document.querySelector(`[data-sound-id="${e}"]`);let h=.8,d=0;if(u){const y=u.querySelector(".gain-slider"),O=u.querySelector(".pan-slider");y&&(h=parseFloat(y.value)),O&&(d=parseFloat(O.value))}const m=le.saveElementToMaster(e,t.pattern,h,d);if(m.success){if(le.updateMasterPattern(this.soloedElements,this.mutedElements),!c&&le.masterActive){if(typeof le.stopMasterPattern=="function")try{le.stopMasterPattern()}catch(y){console.warn("⚠️ Could not stop master after save:",y)}le.masterActive=!1}if(!c&&window.strudel&&window.strudel.scheduler&&window.strudel.scheduler.started)try{window.strudel.scheduler.stop()}catch(y){console.warn("⚠️ Could not stop scheduler after save:",y)}this.updateMasterPatternDisplay(),this.updateMasterIndicators(),console.log(`✅ Pattern saved to master for ${e}`)}else console.error(`❌ Failed to save pattern to master for ${e}:`,m.error)}this.applyMidiSettingsToPattern(e),console.log(`✅ Saved config for ${e}:`,t)}catch(r){console.error(`Error saving config for ${e}:`,r)}}setupModal(){var pa;const e=document.getElementById("config-modal");if(!e)return;const t=this,s=e.querySelector("#modal-theory-block");s&&(s.innerHTML=_G("modal"),LG(s));const r=document.getElementById("modal-pattern-bank"),a=document.getElementById("modal-sample-url"),i=document.getElementById("modal-sample-name"),o=document.getElementById("modal-add-sample-btn"),l=document.getElementById("modal-sample-file");document.getElementById("modal-pattern");const u=(()=>{if(!r)return null;let K=document.getElementById("sample-pack-sounds-group");if(K){const Ae=K.querySelector(".sample-pack-path-container"),fe=K.querySelector("select"),Fe=K.querySelector(".sample-pack-sounds-status");return{wrapper:K,select:fe,status:Fe,pathContainer:Ae}}const J=r.closest(".form-group");if(!J)return null;K=document.createElement("div"),K.className="form-group sample-pack-sounds-group",K.id="sample-pack-sounds-group",K.style.display="none";const ne=document.createElement("label");ne.setAttribute("for","sample-pack-sound-select"),ne.textContent="Sample Pack Sounds:";const M=document.createElement("select");M.id="sample-pack-sound-select",M.className="control-select",M.disabled=!0;const ue=document.createElement("option");ue.value="",ue.textContent="Select a sample",M.appendChild(ue);const we=document.createElement("small");we.className="sample-pack-sounds-status",we.textContent="Select a sample pack to view its sounds.";const xe=document.createElement("div");return xe.className="sample-pack-path-container",xe.style.display="none",K.appendChild(ne),K.appendChild(xe),K.appendChild(M),K.appendChild(we),J.insertAdjacentElement("afterend",K),{wrapper:K,select:M,status:we,pathContainer:xe}})();let h="",d=0,m=null,y=[],O=[];const S=(K="Select a sample pack to view its sounds.")=>{if(!u)return;u.wrapper.style.display="none",u.select.disabled=!0,u.select.innerHTML="";const J=document.createElement("option");J.value="",J.textContent="Select a sample",u.select.appendChild(J),u.pathContainer&&(u.pathContainer.innerHTML="",u.pathContainer.style.display="none"),u.pathContainer&&(u.pathContainer.innerHTML="",u.pathContainer.style.display="none"),u.status.textContent=K,h="",m=null,y=[],O=[]},A=(K="this pack")=>{if(!u)return;u.wrapper.style.display="",u.select.disabled=!0,u.select.innerHTML="";const J=document.createElement("option");J.value="",J.textContent="Loading samples...",u.select.appendChild(J),u.pathContainer&&(u.pathContainer.innerHTML="",u.pathContainer.style.display="none"),u.status.textContent=`Loading samples from ${K}...`},F=K=>{if(!K||!m)return;const J=y.find(ot=>ot.id===K);if(!J){u!=null&&u.status&&(u.status.textContent="Unable to insert sample (not found in current view).");return}const ne=`https://raw.githubusercontent.com/${m.meta.owner}/${m.meta.repo}/${m.meta.branch}/`,M=J.relativePath||J.path||J.fileName||J.name,ue=J.name,xe=`(${["samples({",`  "${ue}": "${M}"`,`}, { baseUrl: "${ne}" })`].join(`
`)},
 sound("${ue}"))`,Ae=In("modal-pattern")||"",fe=Ae.trimEnd(),Ze=fe.length>0?`${fe}

${xe}`:xe,Te=Ae.includes(`"${ue}": "${M}"`);if(Ae.includes(`sound("${ue}")`)||Te){u!=null&&u.status&&(u.status.textContent=`sound("${ue}") already exists in the pattern.`),u.select.value="";return}Ln("modal-pattern",Ze),typeof un=="function"&&un(),u!=null&&u.status&&(u.status.textContent=`Added samples() block and sound("${ue}") to the pattern.`),u.select.value=""},j=(K=[])=>Lf(K.filter(Boolean).join("/")),N=(K,J="")=>{const ne=Lf(J),M=new Set,ue=[],we=ne?`${ne}/`:"";K.audioNodes.forEach(fe=>{const Fe=fe.relativePath;if(ne){if(Fe===ne){ue.push(fe);return}if(!Fe.startsWith(we))return;const Ze=Fe.slice(we.length);if(!Ze){ue.push(fe);return}const[Te,...Ne]=Ze.split("/");Ne.length===0?ue.push(fe):M.add(Te)}else Fe.includes("/")?M.add(Fe.split("/")[0]):ue.push(fe)});const xe=ue.map(fe=>({name:fe.name,relativePath:fe.relativePath,rawUrl:fe.rawUrl,id:fe.id,path:fe.path,fileName:fe.fileName})).filter((fe,Fe,Ze)=>Ze.findIndex(Te=>Te.relativePath===fe.relativePath)===Fe).sort((fe,Fe)=>fe.relativePath.localeCompare(Fe.relativePath));return{folders:Array.from(M).sort((fe,Fe)=>fe.localeCompare(Fe)),samples:xe}},$=()=>{if(!u)return;if(!!!m){u.select.disabled=!0,u.select.innerHTML="";const ue=document.createElement("option");ue.value="",ue.textContent="Select a sample",u.select.appendChild(ue);return}const J=j(O),{samples:ne}=N(m,J);if(!ne.length){u.select.disabled=!0,u.select.innerHTML="";const ue=document.createElement("option");ue.value="",ue.textContent="No audio files in this folder",u.select.appendChild(ue),u.status.textContent=O.length?"This folder has no audio files. Select another folder.":"No audio files found at the root. Browse folders to find samples.";return}u.select.disabled=!1,u.select.innerHTML="";const M=document.createElement("option");M.value="",M.textContent=`Select a sample (${ne.length})`,u.select.appendChild(M),y=ne,ne.forEach(ue=>{const we=document.createElement("option");we.value=ue.id,we.textContent=ue.relativePath,we.dataset.name=ue.name,we.dataset.path=ue.path,u.select.appendChild(we)}),u.status.textContent=J?`Showing samples in /${J}`:"Showing samples in root folder."},L=()=>{if(!u||!u.pathContainer)return;if(u.pathContainer.innerHTML="",!m){u.pathContainer.style.display="none";return}let K=!1;for(let J=0;;J++){const ne=O.slice(0,J),M=j(ne),{folders:ue}=N(m,M);if(!ue.length)break;K=!0;const we=document.createElement("select");we.className="sample-pack-path-select",we.dataset.level=String(J);const xe=document.createElement("option");xe.value="",xe.textContent=J===0?"Root folder":"Select subfolder",we.appendChild(xe),ue.forEach(fe=>{const Fe=document.createElement("option");Fe.value=fe,Fe.textContent=fe,we.appendChild(Fe)});const Ae=O[J]||"";if(we.value=Ae,we.addEventListener("change",()=>{O=O.slice(0,J),we.value&&(O[J]=we.value),I()}),u.pathContainer.appendChild(we),!Ae)break}u.pathContainer.style.display=K?"":"none"},I=()=>{L(),$()},q=async(K,J="")=>{var M;if(!u)return;d+=1;const ne=d;A(J);try{const ue=await x3e(K);if(ne!==d)return;h=K,m=ue,O=[],u.wrapper.style.display="",I()}catch(ue){if(ne!==d)return;u.select.disabled=!0,u.select.innerHTML="";const we=document.createElement("option");we.value="",we.textContent="Unable to load samples",u.select.appendChild(we);const xe=(M=ue.message)!=null&&M.includes("API rate limit")?"GitHub API rate limit reached. Please wait a few minutes and try again.":ue.message;u.status.textContent=`Unable to load samples: ${xe}`,u.pathContainer&&(u.pathContainer.innerHTML="",u.pathContainer.style.display="none")}};u!=null&&u.select&&!u.select.dataset.listenerAttached&&(u.select.addEventListener("change",()=>{const K=u.select.value;K&&F(K)}),u.select.dataset.listenerAttached="true"),S();const ce=K=>{const J={baseUrl:"./",samplePath:""};if(!K||typeof K!="string")return J;const ne=K.trim();if(!ne)return J;try{const M=new URL(ne),ue=M.pathname||"",we=ue.endsWith("/")&&ue.length>1?ue.slice(0,-1):ue,xe=we.lastIndexOf("/");if(xe!==-1){const Ae=we.slice(xe+1)||"",fe=we.slice(0,xe+1);return{baseUrl:`${M.origin}${fe}`,samplePath:Ae||ne}}return{baseUrl:`${M.origin}/`,samplePath:we||M.origin}}catch{const M=ne.replace(/\\/g,"/"),ue=M.lastIndexOf("/");return ue!==-1?{baseUrl:M.slice(0,ue+1),samplePath:M.slice(ue+1)||M}:{baseUrl:"./",samplePath:M||"sample.wav"}}},ee=(K="")=>K.replace(/[\r\n]+/g,"").trim(),he=(K="")=>JSON.stringify(K??""),H=(K,J,ne)=>{const M=he(K||"sample"),ue=ee(ne||K||""),we=he(ue),xe=ee(J||"./"),Ae=he(xe||"./"),fe=`samples({
  ${M}: ${we}
}, { baseUrl: ${Ae} })`,Fe=`sound(${M})`,Ze=`(${fe},
 ${Fe})`,Ne=(In("modal-pattern")||"").trim(),ot=Ne?`${Ne}

${Ze}`:Ze;Ln("modal-pattern",ot),typeof un=="function"&&un(),i.value="",a.value="",l&&(l.value=""),i.focus()};o&&o.addEventListener("click",()=>{if(!i||!a)return;const K=i.value.trim(),J=a.value.trim(),ne=l&&l.files&&l.files.length>0;if(!K||!J&&!ne){alert("Please provide a Sample Name and either a Sample URL or select a file.");return}if(J){const{baseUrl:M,samplePath:ue}=ce(J);H(K,M,ue||K)}else if(ne){const M=l.files[0],ue=new FileReader;ue.onload=we=>{const xe=we.target.result;typeof xe=="string"&&xe.length>0?H(K,"./",xe):alert("Unable to read the selected file. Please try again.")},ue.onerror=()=>{alert("Unable to read the selected file. Please try again.")},ue.readAsDataURL(M)}});const me=()=>{r&&r.querySelectorAll('option[data-source="specialty-vcsl"]').forEach(K=>K.remove())},Oe=(K=r?r.value:"")=>{if(!r)return;const J=r.value,ne=K??J;let M=Array.from(r.children).find(Te=>Te.tagName==="OPTGROUP"&&Te.label&&(Te.label||"").toLowerCase()==="drums"),ue=Array.from(r.children).find(Te=>Te.tagName==="OPTGROUP"&&Te.label&&(Te.label||"").toLowerCase().includes("waveform")),we=Array.from(r.children).find(Te=>Te.tagName==="OPTGROUP"&&Te.label&&(Te.label||"").toLowerCase().includes("synth")),xe=Array.from(r.children).find(Te=>Te.tagName==="OPTGROUP"&&Te.label===D7),Ae=Array.from(r.children).find(Te=>Te.tagName==="OPTGROUP"&&Te.label===T7),fe=Array.from(r.children).find(Te=>Te.tagName==="OPTGROUP"&&Te.label&&Te.label==="Sample Packs");M||(M=document.createElement("optgroup"),M.label="Drums",r.insertBefore(M,r.firstChild)),ue||(ue=document.createElement("optgroup"),ue.label="Basic Waveforms",M.nextSibling?r.insertBefore(ue,M.nextSibling):r.appendChild(ue)),we||(we=document.createElement("optgroup"),we.label="Sample-based Synths",ue.nextSibling?r.insertBefore(we,ue.nextSibling):r.appendChild(we)),xe||(xe=document.createElement("optgroup"),xe.label=D7,we.nextSibling?r.insertBefore(xe,we.nextSibling):r.appendChild(xe)),Ae||(Ae=document.createElement("optgroup"),Ae.label=T7,r.appendChild(Ae)),fe||(fe=document.createElement("optgroup"),fe.label="Sample Packs",r.appendChild(fe)),M.innerHTML="";const Fe=document.createElement("option");if(Fe.value="",Fe.textContent="Default",M.appendChild(Fe),Array.from(Mo).sort((Te,Ne)=>B0(Te).localeCompare(B0(Ne))).forEach(Te=>{if(!Ob(Te))return;const Ne=document.createElement("option");Ne.value=Te,Ne.textContent=B0(Te),M.appendChild(Ne)}),ue&&Array.from(ue.querySelectorAll("option")).forEach(Te=>{const Ne=Te.value;Ne&&!Ob(Ne)?(Te.style.display="none",Te.hidden=!0):Ne&&(Te.style.display="",Te.hidden=!1)}),we&&Array.from(we.querySelectorAll("option")).forEach(Te=>{const Ne=Te.value;Ne&&!Ob(Ne)?(Te.style.display="none",Te.hidden=!0):Ne&&(Te.style.display="",Te.hidden=!1)}),xe.innerHTML="",Ae.innerHTML="",cC.forEach(({value:Te,label:Ne})=>{const ot=document.createElement("option");ot.value=Te,ot.textContent=Ne,Te&&Te.toLowerCase()==="vcsl"?Ae.appendChild(ot):xe.appendChild(ot)}),me(),Array.isArray(sh)&&sh.length>0?sh.forEach(Te=>{const Ne=document.createElement("option");Ne.value=Te.optionValue,Ne.textContent=Te.label,Ne.dataset.source="specialty-vcsl",Ne.dataset.instrument=Te.value,Ae.appendChild(Ne)}):Uh||B3e().then(()=>{Oe(K)}).catch(()=>{}),fe||(console.error("❌ samplePacksGroup not found after creation, creating it again..."),fe=document.createElement("optgroup"),fe.label="Sample Packs",r.appendChild(fe)),fe.innerHTML="",typeof _h>"u")console.error("❌ SAMPLE_PACKS constant is not defined!");else if(!Array.isArray(_h))console.error("❌ SAMPLE_PACKS is not an array:",typeof _h);else if(_h.length===0)console.warn("⚠️ SAMPLE_PACKS array is empty");else{const Te=[..._h].sort((Ne,ot)=>ot.samples!==Ne.samples?ot.samples-Ne.samples:Ne.label.localeCompare(ot.label));console.log(`📦 Populating ${Te.length} sample packs in dropdown`),Te.forEach(Ne=>{if(!Ne||!Ne.value||!Ne.label){console.warn("⚠️ Invalid sample pack entry:",Ne);return}const ot=document.createElement("option");ot.value=Ne.value,ot.textContent=Ne.label,ot.dataset.source="sample-pack",fe.appendChild(ot)}),console.log(`✅ Added ${Te.length} sample pack options to dropdown`)}ne&&r.querySelector(`option[value="${ne}"]`)?r.value=ne:J&&r.querySelector(`option[value="${J}"]`)?r.value=J:r.value=""};window.refreshBankOptions=Oe,Oe();const Pe=document.getElementById("modal-drum-grid-section"),De=document.getElementById("modal-drum-grid-timesig"),Se=(()=>{if(typeof localStorage>"u")return null;try{return localStorage.getItem("drumGridEditorMode")}catch{return null}})(),ae={active:!1,totalSteps:0,built:!1,patternEditorEnabled:Se?Se==="code":!0,updatingFromPattern:!1,updatingFromGrid:!1,currentBankRows:null,checkboxes:{},numBars:1,currentBar:1,barTokens:[]},Ee=document.getElementById("modal-editor-mode-switch"),Qe=document.getElementById("modal-editor-mode-switch-wrapper"),Ke=e.querySelector(".pattern-label-row");let ge=((pa=e.querySelector("#modal-pattern-snippets-toggle"))==null?void 0:pa.closest(".modal-presets"))||null,Ye=ge?ge.querySelector(".pattern-snippet-list"):null,yt=ge?ge.querySelector(".pattern-snippet-search"):null;const Xe=document.getElementById("modal-presets-toggle"),Ge=document.getElementById("modal-presets-content"),Ct=document.getElementById("modal-drum-presets"),Et=document.getElementById("modal-tonal-presets"),gn=document.getElementById("modal-sampler-presets"),On=document.getElementById("modal-preview-btn"),qn=K=>{if(!Xe||!Ge)return;Xe.setAttribute("aria-expanded",K.toString()),Ge.classList.toggle("is-open",K),Ge.setAttribute("aria-hidden",(!K).toString());const J=Xe.closest(".modal-presets");J&&J.classList.toggle("collapsed",!K)},cn=()=>{Ge&&Ge.hasAttribute("hidden")&&Ge.removeAttribute("hidden"),qn(!1)},un=()=>{if(!On)return;const K=In("modal-pattern"),J=!!(K&&K.trim().length>0);On.disabled=!J};let Rt=null;const Kt=()=>{const K=document.getElementById("modal-my-channels");if(!K)return;const J=t==null?void 0:t.currentEditingElementId,ne=J?La.getChannelVersions(J):[];if(!ne.length){K.innerHTML='<div class="modal-presets-empty">No saved channels yet.</div>';return}K.innerHTML=ne.slice(0,12).map((we,xe)=>{const Ae=we.title&&we.title.trim()?we.title.trim():`Saved channel ${xe+1}`,fe=we.createdAt?new Date(we.createdAt).toLocaleString():"";return`
          <button type="button" class="modal-preset-button" data-my-channel-index="${xe}">
            <div class="modal-preset-heading-row">
              <strong>${Ae}</strong>
            </div>
            ${fe?`<span class="modal-preset-description">${fe}</span>`:""}
          </button>
        `}).join("");const M=document.querySelector('[data-target="modal-my-channels"]'),ue=M==null?void 0:M.closest(".modal-presets-group");M&&ue&&ne.length&&M.getAttribute("aria-expanded")!=="true"&&(M.setAttribute("aria-expanded","true"),K.classList.add("is-open"),K.classList.remove("collapsed"),ue.classList.remove("collapsed"))},Un=document.getElementById("modal-my-channels");Un&&!Un.dataset.listenerAttached&&(Un.addEventListener("click",K=>{const J=K.target.closest("[data-my-channel-index]");if(!J)return;const ne=Number(J.dataset.myChannelIndex);if(Number.isNaN(ne))return;const M=t==null?void 0:t.currentEditingElementId;if(!M)return;const we=(La.getChannelVersions(M)||[])[ne];we!=null&&we.pattern&&(Ln("modal-pattern",we.pattern),un(),Vt(),Ft())}),Un.dataset.listenerAttached="true"),window.__strudelChannelHistoryListenerAttached||(window.addEventListener("channel-history-updated",K=>{var ne;const J=(ne=K==null?void 0:K.detail)==null?void 0:ne.elementId;!J||J!==(t==null?void 0:t.currentEditingElementId)||(Kt(),typeof Rt=="function"&&Rt().catch(M=>console.warn("⚠️ Unable to refresh snippet tags:",M)))}),window.__strudelChannelHistoryListenerAttached=!0),(async()=>{var fe;Kt();const K=In("modal-pattern"),J=yt?yt.value.trim().toLowerCase():"",[ne,M]=await Promise.all([q7(K),dC()]),ue=()=>{const Fe=this.currentEditingElementId;if(!Fe)return[{groupId:"my-channels",heading:"My Channels",isPlaceholder:!0,placeholderText:"Save a channel to see it here."}];const Ze=La.getChannelVersions(Fe)||[];return Ze.length?Ze.slice(0,12).map((Te,Ne)=>({groupId:"my-channels",heading:"My Channels",snippet:Te.pattern,insertionSnippet:Te.pattern,className:"pattern-snippet-tag-my-channel",displayLabel:`Saved channel ${Ne+1}`,secondaryLabel:Te.createdAt?new Date(Te.createdAt).toLocaleString():""})):[{groupId:"my-channels",heading:"My Channels",isPlaceholder:!0,placeholderText:"No saved channels yet."}]},we=Fe=>[...ue(),...Fe];if(!ge){ge=document.createElement("div"),ge.className="modal-presets",ge.classList.add("modal-presets--beta"),ge.setAttribute("aria-disabled","false");const Fe=document.createElement("button");Fe.type="button",Fe.id="modal-pattern-snippets-toggle",Fe.className="modal-presets-toggle pattern-snippet-group-heading",Fe.setAttribute("aria-expanded","false");const Ze=document.createElement("span");Ze.textContent="Add to pattern (Advanced (beta))",Fe.appendChild(Ze),ge.appendChild(Fe);const Te=document.createElement("div");Te.id="modal-pattern-snippets-content",Te.className="modal-presets-content",Te.setAttribute("hidden",""),yt=document.createElement("input"),yt.type="search",yt.className="pattern-snippet-search",yt.setAttribute("placeholder","Search tags…"),yt.setAttribute("aria-label","Search snippet tags"),Te.appendChild(yt),Ye=document.createElement("div"),Ye.className="pattern-snippet-list",Te.appendChild(Ye),ge.appendChild(Te);const Ne=tt=>{Fe.setAttribute("aria-expanded",tt.toString()),Te.classList.toggle("is-open",tt),Te.setAttribute("aria-hidden",(!tt).toString()),ge.classList.toggle("collapsed",!tt)};Te.hasAttribute("hidden")&&Te.removeAttribute("hidden"),Ne(!1),Fe.dataset.listenerAttached||(Fe.addEventListener("click",()=>{const Ue=!(Fe.getAttribute("aria-expanded")==="true");Ne(Ue)}),Fe.dataset.listenerAttached="true"),(()=>{const tt=(Ke==null?void 0:Ke.parentElement)||e.querySelector(".modal-body")||e;if(!tt){e.appendChild(ge);return}const Ue=Array.from(tt.children).filter(Me=>{var He;return Me!==ge&&((He=Me.classList)==null?void 0:He.contains("modal-presets"))}),Je=Ue[Ue.length-1];Je?Je.insertAdjacentElement("afterend",ge):Ke?Ke.insertAdjacentElement("afterend",ge):tt.appendChild(ge)})();let at=(fe=e.querySelector("#modal-samples-toggle"))==null?void 0:fe.closest(".modal-presets");if(at){const tt=at.closest(".form-group"),Ue=ge.parentElement||(tt==null?void 0:tt.parentElement);if(tt&&Ue)Ue.insertBefore(tt,ge);else if(!tt){const Je=document.createElement("div");Je.className="form-group",at.parentElement.insertBefore(Je,at),Je.appendChild(at),(ge.parentElement||e).insertBefore(Je,ge)}}else{const tt=document.createElement("div");tt.className="form-group",at=document.createElement("div"),at.className="modal-presets";const Ue=document.createElement("button");Ue.type="button",Ue.id="modal-samples-toggle",Ue.className="modal-presets-toggle pattern-snippet-group-heading",Ue.setAttribute("aria-expanded","false");const Je=document.createElement("span");Je.textContent="Add samples",Ue.appendChild(Je),at.appendChild(Ue);const Me=document.createElement("div");Me.id="modal-samples-content",Me.className="modal-presets-content",Me.setAttribute("hidden","");const He=document.createElement("div");He.className="form-group";const zt=document.createElement("label");zt.setAttribute("for","modal-sample-url"),zt.textContent="Sample URL:";const Tt=document.createElement("input");Tt.type="text",Tt.id="modal-sample-url",Tt.placeholder="e.g., https://example.com/sample.wav (optional)",He.appendChild(zt),He.appendChild(Tt),Me.appendChild(He);const hn=document.createElement("div");hn.className="form-group";const Bn=document.createElement("label");Bn.setAttribute("for","modal-sample-file"),Bn.textContent="Or Select File:";const wn=document.createElement("input");wn.type="file",wn.id="modal-sample-file",wn.setAttribute("accept","audio/*"),hn.appendChild(Bn),hn.appendChild(wn),Me.appendChild(hn);const os=document.createElement("div");os.className="form-group",os.id="modal-sample-name-group";const Ps=document.createElement("label");Ps.setAttribute("for","modal-sample-name"),Ps.textContent="Sample Name:";const x=document.createElement("div");x.className="sample-add-row";const P=document.createElement("input");P.type="text",P.id="modal-sample-name",P.placeholder='e.g., "dream-pad"';const T=document.createElement("button");T.type="button",T.id="modal-add-sample-btn",T.className="sample-add-button",T.textContent="Add";const p=document.createElement("small");p.className="sample-add-hint",p.textContent='Adds a samples(...) block and sound("name") to the pattern.',x.appendChild(P),x.appendChild(T),os.appendChild(Ps),os.appendChild(x),os.appendChild(p),Me.appendChild(os),at.appendChild(Me),tt.appendChild(at);const f=ge.parentElement||(Ke==null?void 0:Ke.parentElement)||e;f?f.insertBefore(tt,ge):e.appendChild(tt);const v=C=>{Ue.setAttribute("aria-expanded",C.toString()),Me.classList.toggle("is-open",C),Me.setAttribute("aria-hidden",(!C).toString()),at.classList.toggle("collapsed",!C)};Me.hasAttribute("hidden")&&Me.removeAttribute("hidden"),v(!1),Ue.dataset.listenerAttached||(Ue.addEventListener("click",()=>{const E=!(Ue.getAttribute("aria-expanded")==="true");v(E)}),Ue.dataset.listenerAttached="true")}}if(!Ye){const Fe=ge.querySelector("#modal-pattern-snippets-content");Ye=Fe?Fe.querySelector(".pattern-snippet-list"):null}if(!yt){const Fe=ge.querySelector("#modal-pattern-snippets-content");yt=Fe?Fe.querySelector(".pattern-snippet-search"):null}this.selectedTagKey||(this.selectedTagKey=null);let xe=this.selectedTagKey;const Ae=(Fe,Ze,Te,Ne)=>{Ra(),Fe.innerHTML="";const ot=!!(Ne&&Ne.trim().length),at=Ne||"",tt=new Map,Ue=[];Ze.forEach(He=>{if(He&&typeof He=="object"&&He.isPlaceholder){const v=He.groupId||"other",C=He.heading||"Other";tt.has(v)||(tt.set(v,{id:v,heading:C,className:He.className||"",items:[]}),Ue.push(tt.get(v))),tt.get(v).items.push(He);return}const zt=typeof He=="string"?He:He.snippet,Tt=typeof He=="string"?"other":He.groupId||"other",hn=typeof He=="string"?"":He.className||"",Bn=(typeof He=="string"?"Other":He.heading)||"Other",wn=Fo(zt),os=Te.get(wn);let Ps=typeof He=="object"&&(He!=null&&He.insertionSnippet)?He.insertionSnippet:V7(zt,os);wn==="bank"&&Ps.includes("display bank(bank)")&&(Ps="bank()");const x=Ps.replace(/^[.]+/,"");let P=typeof He=="object"&&(He!=null&&He.displayLabel)?He.displayLabel:x;P.match(/^sound\s*\(\s*["']([^"']+)["']\s*\)/i)||(P=P.replace(/\([^)]*\)/g,"()"));const p=P.toLowerCase(),f=Bn.toLowerCase();at&&!p.includes(at)&&!wn.includes(at)&&!f.includes(at)||(tt.has(Tt)||(tt.set(Tt,{id:Tt,heading:Bn,className:hn,items:[]}),Ue.push(tt.get(Tt))),tt.get(Tt).items.push({snippet:zt,insertionSnippet:x,displayLabel:P,secondaryLabel:typeof He=="object"?He.secondaryLabel:"",key:wn,className:hn,heading:Bn,referenceEntry:os}))}),Ue.sort((He,zt)=>{if(He.id==="my-channels"&&zt.id!=="my-channels")return-1;if(zt.id==="my-channels"&&He.id!=="my-channels")return 1;const Tt=(He.heading||"").toLowerCase(),hn=(zt.heading||"").toLowerCase();return Tt.localeCompare(hn)});let Je=!1;const Me=new Map;if(Ze.forEach(He=>{const zt=typeof He=="string"?He:He.snippet,Tt=Fo(zt);Me.has(Tt)||Me.set(Tt,He)}),Ue.forEach(He=>{var x,P;if(!Array.isArray(He.items)||!He.items.length)return;He.items.sort((T,p)=>{const f=(T.displayLabel||"").toLowerCase(),v=(p.displayLabel||"").toLowerCase();return f<v?-1:f>v?1:0}),Je=!0;const zt=document.createElement("div");zt.className="pattern-snippet-group",zt.dataset.groupId=He.id;const Tt=z3e.has(He.id)?q3e:Z3e,hn=nm.has(He.id)?nm.get(He.id):Tt.has(He.id),Bn=ot?!0:hn;nm.has(He.id)||nm.set(He.id,hn);const wn=document.createElement("button");wn.type="button",wn.className="pattern-snippet-group-heading",wn.textContent=He.heading,(P=(x=sn==null?void 0:sn.container)==null?void 0:x.dataset)==null||P.forceOpen;const os=He.id==="chord-progressions"?!0:Bn;wn.setAttribute("aria-expanded",os?"true":"false");const Ps=document.createElement("div");Ps.className="pattern-snippet-group-items",os||zt.classList.add("collapsed"),wn.addEventListener("click",()=>{var v,C;Ra();const T=He.id==="chord-progressions",f=!(T&&((C=(v=sn==null?void 0:sn.container)==null?void 0:v.dataset)==null?void 0:C.forceOpen)==="true"?!1:zt.classList.toggle("collapsed"));wn.setAttribute("aria-expanded",f?"true":"false"),T||nm.set(He.id,f)}),He.items.forEach(T=>{var D,Q,z,W;if(T&&T.isPlaceholder){const G=document.createElement("div");G.className="pattern-snippet-placeholder",G.textContent=T.placeholderText||"No saved channels yet.",Ps.appendChild(G);return}const p=document.createElement("div");p.className="pattern-snippet-item",p.dataset.snippetKey=Fo(T.snippet);const f=Fo(T.snippet);let v=xm[f];if(!v&&T.snippet){const G=T.snippet.match(/\(([a-zA-Z_]+):number\)/),X=T.snippet.match(/\(([0-9.]+)\)/);if(G||X){let re=X?parseFloat(X[1]):null;if(G&&!re){const de=G[1];xm[f]?v=xm[f]:de.includes("attack")||de.includes("decay")||de.includes("release")?v={min:0,max:2,step:.01,default:.01,unit:"s"}:de.includes("sustain")||de.includes("modulation")||de.includes("env")?v={min:0,max:1,step:.01,default:.5,unit:""}:v={min:0,max:1,step:.01,default:.5,unit:""}}else if(X&&re!==null){let de=Math.max(0,re*.1),pe=re*10,ye=re<1?.01:re<10?.1:1;re>=20&&re<=2e4?(de=20,pe=2e4,ye=10):re>=0&&re<=1?(de=0,pe=1,ye=.01):re>=-1&&re<=1&&(de=-1,pe=1,ye=.01),v={min:de,max:pe,step:ye,default:re,unit:""}}}}if(!!v){const G=document.createElement("button");G.type="button";const X=Rx(T.snippet),re=!X&&T.groupId!=="core"&&_x(T.snippet),de=[T.className||"",X,re?"pattern-snippet-tag-core":""].filter(Boolean).join(" ");G.className=`pattern-snippet-tag ${de}`.trim(),G.dataset.snippet=T.snippet,G.dataset.insertion=T.insertionSnippet;let pe=T.displayLabel;const ye=pe.match(/\(([a-zA-Z_]+):number\)/);ye?pe=`${ye[1]}()`:pe.includes('sound("')&&pe.includes('")')?pe=T.displayLabel:pe=pe.replace(/\([^)]*\)/g,"()"),G.textContent=pe,G.setAttribute("aria-label",T.displayLabel);const Ce=document.createElement("div");Ce.className="slider-row snippet-slider-row",Ce.style.display="none",Ce.style.width="100%",Ce.style.marginTop="8px",Ce.style.padding="8px",Ce.style.backgroundColor="rgba(102, 126, 234, 0.05)",Ce.style.border="1px solid rgba(102, 126, 234, 0.2)",Ce.style.borderRadius="4px";const Be=document.createElement("label");Be.textContent=T.displayLabel.replace(/\(\)$/,""),Be.style.fontSize="0.75rem",Be.style.fontWeight="600",Be.style.color="#4c51bf",Be.style.marginBottom="4px";const je=document.createElement("div");je.style.display="flex",je.style.alignItems="center",je.style.gap="8px",je.style.width="100%";const Ie=document.createElement("input");Ie.type="range",Ie.className="snippet-slider",Ie.dataset.snippet=T.snippet,Ie.dataset.tagKey=f,Ie.style.flex="1";let nt;const Nt=f,ht=v.unit==="Hz"&&(f==="lpf"||f==="hpf"||f==="bpf"||f==="cutoff"||f==="roomlp");if(ht){Ie.min="0",Ie.max="1",Ie.step="0.001";const An=(()=>{const ur=In("modal-pattern")||"",rr=new RegExp(`\\.${Nt}\\(([^)]+)\\)`,"g").exec(ur);return rr?rr[1]:null})();let Rn=An?parseFloat(An):v.default;Rn=Math.max(v.min,Math.min(v.max,Rn));const er=$x(Rn);Ie.value=String(er),nt=document.createElement("span"),nt.className="slider-value",nt.style.minWidth="60px",nt.style.textAlign="right",nt.style.fontSize="0.75rem",nt.style.fontWeight="600",nt.textContent=Math.round(Rn)+" "+v.unit,Ie.addEventListener("input",ur=>{const sr=parseFloat(ur.target.value),rr=Nx(sr);T0(nt,Math.round(rr)+" "+v.unit)})}else{Ie.min=String(v.min),Ie.max=String(v.max),Ie.step=String(v.step);const An=(()=>{const Rn=In("modal-pattern")||"",ur=new RegExp(`\\.${Nt}\\(([^)]+)\\)`,"g").exec(Rn);return ur?ur[1]:null})();Ie.value=String(An||v.default),nt=document.createElement("span"),nt.className="slider-value",nt.style.minWidth="60px",nt.style.textAlign="right",nt.style.fontSize="0.75rem",nt.style.fontWeight="600",nt.textContent=Ie.value+(v.unit?" "+v.unit:""),Ie.addEventListener("input",Rn=>{const er=Rn.target.value;T0(nt,er+(v.unit?" "+v.unit:""))})}Ie.addEventListener("change",Gn=>{let An=Gn.target.value;if(ht){const rr=parseFloat(An),Jr=Nx(rr);An=Math.round(Jr),T0(nt,An+" "+v.unit)}else T0(nt,An+(v.unit?" "+v.unit:""));const Rn=In("modal-pattern")||"",er=`.${Nt}(${An})`,ur=new RegExp(`\\.${Nt}\\([^)]*\\)`,"g");if(ur.test(Rn)){const rr=Rn.replace(ur,er);Ln("modal-pattern",rr)}else{const rr=Rn.trim()+er;Ln("modal-pattern",rr)}}),G.addEventListener("click",Gn=>{if(Gn.stopPropagation(),Gn.preventDefault(),Ce.style.display==="none"||Ce.style.display===""){Ce.style.display="flex",Ce.style.flexDirection="column",Ce.style.gap="4px";const Rn=In("modal-pattern")||"",ur=new RegExp(`\\.${Nt}\\(([^)]+)\\)`,"g").exec(Rn);if(ur){let sr=ur[1];if(ht){const rr=parseFloat(sr),Jr=Math.max(v.min,Math.min(v.max,rr)),Xl=$x(Jr);Ie.value=String(Xl),nt.textContent=Math.round(Jr)+" "+v.unit}else Ie.value=sr,nt.textContent=sr+(v.unit?" "+v.unit:"")}else{let sr=Ie.value;if(ht){const Xl=parseFloat(Ie.value);sr=Math.round(Nx(Xl))}const rr=`.${Nt}(${sr})`,Jr=Rn.trim()+rr;Ln("modal-pattern",Jr)}}});const Ot=((D=T.referenceEntry)==null?void 0:D.name)||T.displayLabel.replace(/^[.]+/,"").trim(),Ut=Lx(T.referenceEntry),Ht=Array.isArray((Q=T.referenceEntry)==null?void 0:Q.params)?T.referenceEntry.params.map(Qx).filter(Boolean).join(`
`):"";G.dataset.tooltipTitle=Ot||T.displayLabel,G.dataset.tooltipDescription=Ut||"",G.dataset.tooltipParams=Ht||"";const ct=()=>jx(G),dn=()=>Ra(G);G.addEventListener("mouseenter",ct),G.addEventListener("mouseleave",dn),G.addEventListener("focus",ct),G.addEventListener("blur",dn),je.appendChild(Ie),je.appendChild(nt),Ce.appendChild(Be),Ce.appendChild(je),p.appendChild(G),p.appendChild(Ce)}else{const G=document.createElement("button");G.type="button";const X=Rx(T.snippet),re=!X&&T.groupId!=="core"&&_x(T.snippet),de=[T.className||"",X,re?"pattern-snippet-tag-core":""].filter(Boolean).join(" ");G.className=`pattern-snippet-tag ${de}`.trim(),G.dataset.snippet=T.snippet,G.dataset.insertion=T.insertionSnippet,G.textContent=T.displayLabel,G.setAttribute("aria-label",T.displayLabel);const pe=((z=T.referenceEntry)==null?void 0:z.name)||T.displayLabel.replace(/^[.]+/,"").trim(),ye=Lx(T.referenceEntry),Ce=Array.isArray((W=T.referenceEntry)==null?void 0:W.params)?T.referenceEntry.params.map(Qx).filter(Boolean).join(`
`):"";G.dataset.tooltipTitle=pe||T.displayLabel,G.dataset.tooltipDescription=ye||"",G.dataset.tooltipParams=Ce||"";const Be=()=>jx(G),je=()=>Ra(G);G.addEventListener("mouseenter",Be),G.addEventListener("mouseleave",je),G.addEventListener("focus",Be),G.addEventListener("blur",je),G.addEventListener("click",je),p.appendChild(G)}if(T.secondaryLabel){const G=document.createElement("span");G.className="pattern-snippet-meta",G.textContent=T.secondaryLabel,p.appendChild(G)}Ps.appendChild(p);const E=xe||t.selectedTagKey;if(E&&f===E){const G=U3e[f];if(G&&Array.isArray(G)&&G.length>0){const X=document.createElement("div");X.className="pattern-snippet-suggestions";const re=document.createElement("div");re.className="pattern-snippet-suggestions-label",re.textContent="Suggested:",X.appendChild(re);const de=document.createElement("div");de.className="pattern-snippet-suggestions-list";const ye=G.filter(Ce=>Me.has(Ce)).slice(0,8);ye.forEach(Ce=>{const Be=Me.get(Ce),je=typeof Be=="string"?Be:Be.snippet,Ie=Fo(je),nt=Te.get(Ie),ht=V7(je,nt).replace(/^[.]+/,"");let Ot=ht;Ot=Ot.replace(/\([^)]*\)/g,"()");let Ut="other",Ht="";for(const Jr of Vm)if(Jr.matcher(Ie,je)){Ut=Jr.id,Ht=Jr.className;break}const ct=document.createElement("button");ct.type="button";const dn=Rx(je),Gn=!dn&&Ut!=="core"&&_x(je),An=[Ht,dn,Gn?"pattern-snippet-tag-core":"","pattern-snippet-tag-suggested"].filter(Boolean).join(" ");ct.className=`pattern-snippet-tag ${An}`.trim(),ct.dataset.snippet=je,ct.dataset.insertion=ht,ct.textContent=Ot,ct.setAttribute("aria-label",Ot),ct.addEventListener("click",Jr=>{Jr.stopPropagation(),!ge.classList.contains("disabled")&&ae.patternEditorEnabled&&(xe=Ie,t.selectedTagKey=Ie,Ra(ct),dD("modal-pattern",ht),typeof Rt=="function"&&Rt().catch(Xl=>console.warn("⚠️ Unable to refresh snippet tags:",Xl)))});const Rn=(nt==null?void 0:nt.name)||Ot.replace(/^[.]+/,"").trim(),er=Lx(nt),ur=Array.isArray(nt==null?void 0:nt.params)?nt.params.map(Qx).filter(Boolean).join(`
`):"";ct.dataset.tooltipTitle=Rn||Ot,ct.dataset.tooltipDescription=er||"",ct.dataset.tooltipParams=ur||"";const sr=()=>jx(ct),rr=()=>Ra(ct);ct.addEventListener("mouseenter",sr),ct.addEventListener("mouseleave",rr),ct.addEventListener("focus",sr),ct.addEventListener("blur",rr),de.appendChild(ct)}),ye.length>0&&(X.appendChild(de),Ps.appendChild(X))}}}),zt.appendChild(wn),zt.appendChild(Ps),Fe.appendChild(zt)}),!Je){const He=document.createElement("div");He.className="pattern-snippet-empty",He.textContent="No tags match your search.",Fe.appendChild(He)}};Ye&&Ae(Ye,we(ne),M,J),Rt=async()=>{if(!Ye)return;const Fe=await q7(In("modal-pattern")),Ze=await dC(),Te=yt?yt.value.trim().toLowerCase():"";xe=t.selectedTagKey,Ae(Ye,we(Fe),Ze,Te)},t.refreshSnippetButtons=Rt,Ye&&!Ye.dataset.listenersAttached&&(Ye.addEventListener("click",Fe=>{const Ze=Fe.target.closest(".pattern-snippet-tag");if(!Ze||ge.classList.contains("disabled")||!ae.patternEditorEnabled)return;const Te=Ze.closest(".pattern-snippet-item");if(Te&&Te.dataset.snippetKey){const at=Te.dataset.snippetKey;if(xm[at])return}const Ne=Ze.dataset.insertion||Ze.dataset.snippet;if(!Ne)return;const ot=Fo(Ne);xe=ot,t.selectedTagKey=ot,Ra(Ze),dD("modal-pattern",Ne),typeof Rt=="function"&&Rt().catch(at=>console.warn("⚠️ Unable to refresh snippet tags:",at))}),Ye.addEventListener("mouseleave",()=>{Ra()}),Ye.addEventListener("scroll",()=>{Ra()}),Ye.dataset.listenersAttached="true"),yt&&!yt.dataset.listenerAttached&&(yt.addEventListener("input",()=>{Ra(),typeof Rt=="function"&&Rt().catch(Fe=>console.warn("⚠️ Unable to refresh snippet tags:",Fe))}),yt.dataset.listenerAttached="true")})().catch(K=>{console.warn("⚠️ Unable to prepare pattern snippet tags:",K)}),un();const bn=K=>{try{if(!e)return;this.currentEditingElementId=K,_n(!0),Ee&&(Ee.checked=!1);const J=document.getElementById("modal-element-id");J&&(J.textContent=K||"");const ne=this.loadElementConfig?this.loadElementConfig(K):null,M=(ne==null?void 0:ne.bank)||"",ue=(ne==null?void 0:ne.vcslInstrument)||"",we=M==="vcsl"&&ue?`${E1}${ue}`:M;Oe(we),r&&(r.value=we);const xe=(ne==null?void 0:ne.pattern)||"";Ln("modal-pattern",xe||"");const Ae=document.getElementById("modal-key-select"),fe=document.getElementById("modal-scale-select");Ae&&(ne!=null&&ne.key||(ne==null?void 0:ne.key)==="")&&(Ae.value=ne.key||""),fe&&(ne!=null&&ne.scale||(ne==null?void 0:ne.scale)==="")&&(fe.value=ne.scale||"chromatic"),hi(),Gr(),un(),Ft(),Kt(),w(),cn(),e.style.display="block"}catch(J){console.warn("⚠️ Failed to open modal:",J)}},rt=()=>{try{if(!e)return;e.style.display="none",le&&typeof le.stopSound=="function"&&le.stopSound("modal-preview")}catch(K){console.warn("⚠️ Failed to close modal:",K)}};if(On&&!On.dataset.listenerAttached){let K=!1;On.addEventListener("click",async()=>{var Ze,Te,Ne,ot,at,tt,Ue;const J="modal-preview";if(le.trackedPatterns&&le.trackedPatterns.has(J)){le.stopSound&&le.stopSound(J);try{const Je=le.trackedPatterns?le.trackedPatterns.size:0;K&&Je===0&&le.stopMasterPattern&&await le.stopMasterPattern()}catch{}K=!1,On.textContent="▶ Preview Pattern",On.classList.remove("active"),gs.updateStatus("⏹ Preview stopped");return}ae.active&&Vn();let M=In("modal-pattern");if(!M||!M.trim()){gs.updateStatus("⚠️ No pattern to preview");return}const we=(r?nd(r.value):{bankValue:""}).bankValue;console.log("🎵 Preview: Original pattern:",M),console.log("🎵 Preview: Bank value:",we);const xe=[...Om,...zh],Ae=we&&xe.includes(we.toLowerCase()),fe=we&&Mo.has(we);if(we&&we!=="")if(fe&&!Ae)if(M.includes(".bank("))M=M.replace(/\.bank\(["'][^"']*["']\)/g,`.bank("${we}")`);else if(M.includes(".gain(")||M.includes(".pan(")||M.includes(".fast(")||M.includes(".slow(")){const Je=M.match(/(\.(gain|pan|fast|slow)\([^)]*\))/);if(Je){const Me=Je.index;M=M.slice(0,Me)+`.bank("${we}")`+M.slice(Me)}else M=`${M}.bank("${we}")`}else M=`${M}.bank("${we}")`;else Ae&&(M=M.replace(/\.bank\(["'][^"']*["']\)/g,""),M=M.replace(/\.+$/,"").trim());else M=M.replace(/\.bank\(["'][^"']*["']\)/g,""),M=M.replace(/\.+$/,"").trim();console.log("🎵 Preview: Final pattern before preview:",M);const Fe=this.currentEditingElementId;if(Fe){const Je=le.elementGainValues.get(Fe)||.8,Me=le.elementPanValues.get(Fe)||0,He=Je*.501;le.elementGainValues.set(J,He),le.elementPanValues.set(J,Me),console.log(`🎵 Preview: Using gain=${He} (${Je} * 0.501 for -6dB), pan=${Me} from element ${Fe}`)}if(we&&we!==""){console.log(`🎵 Preview: Ensuring bank "${we}" is loaded...`);try{await le.loadBank(we),console.log(`✅ Preview: Bank "${we}" loaded successfully`)}catch(Je){console.warn(`⚠️ Preview: Could not load bank "${we}":`,Je)}}console.log(`🎵 [PREVIEW] Starting preview for ${J}`),console.log(`🎵 [PREVIEW] Audio ready: ${le.isAudioReady()}, context: ${!!le.audioContext}, state: ${((Ze=le.audioContext)==null?void 0:Ze.state)||"N/A"}`),console.log(`🎵 [PREVIEW] Strudel loaded: ${le.strudelLoaded}, scheduler: ${!!((Te=window.strudel)!=null&&Te.scheduler)}, started: ${((ot=(Ne=window.strudel)==null?void 0:Ne.scheduler)==null?void 0:ot.started)||!1}`),gs.updateStatus("▶ Previewing pattern…"),On.textContent="⏹ Stop Preview",On.classList.add("active");try{const Je=!!le.masterActive;console.log("🎵 [PREVIEW] Calling playStrudelPattern..."),await le.playStrudelPattern(J,M),console.log(`🎵 [PREVIEW] After playStrudelPattern - audioContext state: ${((at=le.audioContext)==null?void 0:at.state)||"N/A"}`),console.log(`🎵 [PREVIEW] After playStrudelPattern - scheduler started: ${((Ue=(tt=window.strudel)==null?void 0:tt.scheduler)==null?void 0:Ue.started)||!1}`),!le.masterActive&&le.playMasterPattern&&(console.log("🎵 [PREVIEW] Master not active, starting master..."),await le.playMasterPattern()),K=!Je&&!!le.masterActive,gs.updateStatus("✅ Preview playing"),setTimeout(()=>{var Me,He,zt;console.log(`🎵 [PREVIEW] Post-start check - audioContext state: ${((Me=le.audioContext)==null?void 0:Me.state)||"N/A"}`),console.log(`🎵 [PREVIEW] Post-start check - scheduler started: ${((zt=(He=window.strudel)==null?void 0:He.scheduler)==null?void 0:zt.started)||!1}`),le.audioContext&&le.audioContext.state!=="running"&&console.error("❌ [PREVIEW] Audio context not running after preview start!")},500)}catch(Je){console.error("❌ [PREVIEW] Preview failed:",Je),gs.updateStatus("⚠️ Preview failed – check console for details"),On.textContent="▶ Preview Pattern",On.classList.remove("active")}}),On.dataset.listenerAttached="true"}const Pn=K=>{Ra(),zpe("modal-pattern",K);const J=document.getElementById("modal-pattern");J&&J.classList.toggle("pattern-editor-readonly",!K),ge&&(ge.classList.toggle("disabled",!K),ge.setAttribute("aria-disabled",(!K).toString())),yt&&(yt.disabled=!K)},pt=()=>{var ne;Ee&&(Ee.checked=!ae.patternEditorEnabled),Pn(ae.patternEditorEnabled);const K=document.getElementById("modal-pattern-editor-wrapper");K&&(K.style.display=ae.patternEditorEnabled?"block":"none",Vt()),ge&&(ge.style.display=ae.patternEditorEnabled?"block":"none");const J=(ne=document.getElementById("modal-time-signature-select"))==null?void 0:ne.closest(".form-group");J&&(J.style.display=ae.patternEditorEnabled?"none":"block")},Vt=()=>{const K=document.getElementById("modal-note-conversion-control");if(!K)return;const J=In("modal-pattern"),ne=J&&xi(J);ne&&Co(J),ne?K.style.display="block":K.style.display="none"},Zt=document.getElementById("modal-pattern");if(Zt&&!Zt.dataset.previewListenerAttached){const K=J=>{if(!J||typeof J!="string"||!J.includes("(silence)")||!/\b(note|n)\s*\(/i.test(J))return J;const ne=J.trim().startsWith("(silence)"),M=J.trim().match(/^\(silence\)\.\s*([\s\S]+)$/);if(ne&&M){const we=M[1].trim().replace(/^\.+/,""),xe=J.search(/\b(note|n)\s*\(/i);if(xe>=0){let Ae=J.indexOf("(",xe),fe=0,Fe=-1;for(let Ze=Ae;Ze<J.length;Ze++){const Te=J[Ze];if(Te==="(")fe++;else if(Te===")"&&(fe--,fe===0)){Fe=Ze;break}}if(Fe>Ae){let Te=`${J.substring(xe,Fe+1).trim()}`;return we&&!/^\s*$/.test(we)&&(Te=`${Te}.${we}`.replace(/\.\.+/g,".").replace(/\.($|\s)/,"$1").trim()),Te}}}let ue=J.replace(/\(silence\)/g,"").replace(/\.\.+/g,".").trim();return ue=ue.replace(/^\./,"").trim(),ue};Zt.addEventListener("input",()=>{const J=In("modal-pattern"),ne=K(J);ne!==J&&Ln("modal-pattern",ne),un(),Vt(),ne&&Co(ne)&&(da=ne),Js=!1,Ir(In("modal-pattern"),!0);const M=document.getElementById("modal-key-scale-group"),ue=In("modal-pattern"),we=ue&&xi(ue),xe=r?r.value:"",Ae=xe&&zh.includes(xe.toLowerCase());M&&(M.style.display=we||Ae?"block":"none"),typeof Rt=="function"&&Rt().catch(fe=>console.warn("⚠️ Unable to refresh snippet tags:",fe))}),Zt.dataset.previewListenerAttached="true"}const _n=K=>{ae.patternEditorEnabled=!!K,Ee&&(Ee.checked=!ae.patternEditorEnabled),pt();try{typeof localStorage<"u"&&localStorage.setItem("drumGridEditorMode",ae.patternEditorEnabled?"code":"step")}catch{}Ft()},it=K=>{const J=nd(K);return J.bankValue&&Mo.has(J.bankValue)},Ft=()=>{const K=r?r.value:"",J=!!K,ne=it(K),M=ae.active&&!ae.patternEditorEnabled;RG("modal",{showTimeSignature:ne&&M,showKeyScale:J&&!ne,showPiano:J&&!ne})},_e=K=>{De&&(De.textContent=`${K.signature} · ${K.totalSteps} steps`)},Lt=()=>{const K=document.getElementById("modal-drum-grid-bar-count"),J=document.getElementById("modal-drum-grid-bar-arrow-left"),ne=document.getElementById("modal-drum-grid-bar-arrow-right");K&&(ae.numBars===1?K.textContent="1 bar":K.textContent=`Bar ${ae.currentBar} of ${ae.numBars}`),J&&(J.style.display=ae.numBars>1&&ae.currentBar>1?"flex":"none"),ne&&(ne.style.display=ae.numBars>1&&ae.currentBar<ae.numBars?"flex":"none")},et=K=>{if(K<1||K>ae.numBars)return;const J=document.getElementById("modal-time-signature-select"),ne=(J==null?void 0:J.value)||this.currentTimeSignature||"4/4",M=Po(ne);xn(M),ae.currentBar=K,Lt();const ue=r?r.value:"";if(ae.built=!1,Dn(M,ue),!ae.barTokens||!ae.barTokens.length){const we=In("modal-pattern"),xe=Cs(we);$t(M,xe||[])}else Pt(M);st(M)},is=()=>{const K=document.getElementById("modal-time-signature-select"),J=(K==null?void 0:K.value)||this.currentTimeSignature||"4/4",ne=Po(J);xn(ne),ae.numBars++,Pt(ne);const M=ne.totalSteps;ae.barTokens[ae.numBars-1]=new Array(M).fill("~"),Lt(),et(ae.numBars)},It=()=>{!ae.active||ae.updatingFromPattern||Vn()},Dn=(K,J)=>{if(!Pe)return;const ne=J&&R7[J]?R7[J]:Fx;if(!(!ae.built||ae.totalSteps!==K.totalSteps||JSON.stringify(ae.currentBankRows)!==JSON.stringify(ne)))return;const ue=document.getElementById("modal-drum-grid-container");if(!ue){console.error("❌ ensureDrumGridBuilt: Drum grid container not found!"),console.error("   Looking for: modal-drum-grid-container"),console.error("   Modal exists:",!!Pe),Pe&&console.error("   Drum grid section children:",Array.from(Pe.children).map(we=>we.id||we.className));return}console.log("🔨 Building drum grid with",ne.length,"rows,",K.totalSteps,"steps"),console.log("   Grid container found:",ue,"current children:",ue.children.length),ue.innerHTML="",ae.checkboxes={},ae.currentBankRows=ne,ne.forEach(({key:we,label:xe,sample:Ae})=>{const fe=document.createElement("div");fe.className="drum-grid-row",fe.setAttribute("data-row",we);const Fe=document.createElement("span");Fe.className="drum-grid-row-label",Fe.textContent=xe,fe.appendChild(Fe);const Ze=document.createElement("div");Ze.className="drum-grid-steps",Ze.id=`drum-grid-steps-${we}`,Ze.style.gridTemplateColumns=`repeat(${K.totalSteps}, minmax(18px, 1fr))`,ae.checkboxes[we]=[],K.totalSteps*ae.numBars;const Te=(ae.currentBar-1)*K.totalSteps,Ne=Te+K.totalSteps;for(let ot=Te;ot<Ne;ot+=1){const at=document.createElement("div");at.className="drum-grid-step";const tt=ot-Te;tt>0&&tt%4===0&&at.classList.add("quarter-boundary");const Ue=document.createElement("input");Ue.type="checkbox",Ue.dataset.row=we,Ue.dataset.step=String(ot),Ue.dataset.bar=String(ae.currentBar),Ue.addEventListener("change",It),at.appendChild(Ue),Ze.appendChild(at),ae.checkboxes[we].push(Ue)}fe.appendChild(Ze),ue.appendChild(fe)}),Pt(K),st(K),ae.totalSteps=K.totalSteps,ae.built=!0},Cs=K=>{if(!K||typeof K!="string")return null;const J=K.match(/(?:s|sound)\(\s*["'`]([^"'`]+)["'`]\s*\)/i);if(!J||!J[1])return null;const ne=J[1].trim();return ne?ne.split(/\s+/).filter(Boolean):null};function Wt(K){if(!K)return[];const J=K.trim();if(!J||J==="~")return[];let ne=J;return(ne.startsWith("[")&&ne.endsWith("]")||ne.startsWith("{")&&ne.endsWith("}"))&&(ne=ne.slice(1,-1)),ne=ne.replace(/[,]+/g," "),ne.split(/\s+/).map(M=>M.trim()).filter(Boolean)}function Pt(K){ae.barTokens||(ae.barTokens=[]);const J=K.totalSteps,ne=Math.max(1,ae.numBars);for(ae.barTokens.length>ne&&(ae.barTokens.length=ne);ae.barTokens.length<ne;)ae.barTokens.push(new Array(J).fill("~"));ae.barTokens=ae.barTokens.map(M=>{const ue=Array.isArray(M)?M.slice(0,J):[];for(;ue.length<J;)ue.push("~");return ue})}function $t(K,J){const ne=K.totalSteps,M=Math.max(1,ae.numBars),ue=ne*M;let we=Array.isArray(J)?J.slice(0,ue):[];we.length<ue&&(we=we.concat(new Array(ue-we.length).fill("~"))),ae.barTokens=[];for(let xe=0;xe<M;xe++){const Ae=xe*ne;ae.barTokens.push(we.slice(Ae,Ae+ne))}Pt(K)}function xn(K){if(!ae.active||ae.updatingFromPattern||!ae.checkboxes)return;const J=ae.currentBar-1;if(J<0)return;Pt(K);const ne=K.totalSteps,M=ae.currentBankRows||Fx,ue=new Array(ne).fill("~");for(let we=0;we<ne;we+=1){const xe=[];M.forEach(({key:Ae,sample:fe})=>{const Fe=ae.checkboxes[Ae],Ze=Fe?Fe[we]:null;Ze&&Ze.checked&&xe.push(fe)}),xe.length===1?ue[we]=xe[0]:xe.length>1&&(ue[we]=`[${xe.join(" ")}]`)}ae.barTokens[J]=ue}function st(K){if(!ae.checkboxes)return;Pt(K);const J=ae.currentBar-1,ne=ae.barTokens[J];if(!ne)return;(ae.currentBankRows||Fx).forEach(({key:ue,sample:we})=>{const xe=ae.checkboxes[ue];xe&&xe.forEach((Ae,fe)=>{if(!Ae)return;const Fe=Wt(ne[fe]);Ae.checked=Fe.includes(we)})})}function Gt(){return Array.isArray(ae.barTokens)?ae.barTokens.flat():[]}const an=(K,J)=>{if(!Pe||!ae.active)return;const ne=Cs(K),M=J.totalSteps;if(ne&&ne.length){const ue=Math.max(1,Math.ceil(ne.length/M));ae.numBars!==ue&&(ae.numBars=ue,ae.currentBar>ae.numBars&&(ae.currentBar=ae.numBars),Lt()),$t(J,ne)}else ae.barTokens.length?Pt(J):$t(J,[]);ae.updatingFromPattern=!0,st(J),ae.updatingFromPattern=!1},vs=K=>(Pt(K),Gt()),Vn=()=>{if(!Pe||!ae.active||!r)return;const K=document.getElementById("modal-time-signature-select"),J=(K==null?void 0:K.value)||this.currentTimeSignature||"4/4",ne=Po(J);xn(ne);const ue=vs(ne).join(" "),we=r.value,xe=we&&we!==""?`.bank("${we}")`:"",Ae=`s("${ue}")${xe}`;ae.updatingFromGrid=!0,Ln("modal-pattern",Ae),ae.updatingFromGrid=!1},Hs=(K,J)=>{if(!Pe){console.warn("⚠️ Drum grid section not found");return}const ne=r?r.value:"";console.log("🎹 Showing drum grid for bank:",ne,"metrics:",K);const M=document.getElementById("modal-drum-grid-container");if(!M){console.error("❌ Drum grid container not found!");return}console.log("✅ Grid container found:",M),Dn(K,ne),_e(K),Pe.style.display="block",ae.active=!0,an(J,K),Lt();const ue=M.querySelectorAll(".drum-grid-row");console.log("✅ Drum grid shown, active:",ae.active,"rows:",ue.length)},Ys=()=>{Pe&&(Pe.style.display="none",ae.active=!1,ae.built=!1,ae.numBars=1,ae.currentBar=1,Lt())};pt();const w=()=>{if(!r){console.log("⚠️ refreshDrumGridForCurrentState: bankSelect not found");return}const K=r.value,J=it(K);if(console.log("🔄 refreshDrumGridForCurrentState: bankValue=",K,"isDrum=",J,"patternEditorEnabled=",ae.patternEditorEnabled),Qe&&(Qe.style.display=J?"inline-flex":"none"),!J){console.log("📝 Not a drum bank, enabling pattern editor"),_n(!0),Ys(),pt();return}const ne=In("modal-pattern");if(ne&&ne.trim(),Cs(ne),ae.patternEditorEnabled){console.log("📝 Pattern editor enabled, hiding drum grid"),Ys(),pt();return}console.log("🎹 Showing drum grid for drum bank");const M=document.getElementById("modal-time-signature-select"),ue=(M==null?void 0:M.value)||this.currentTimeSignature||"4/4",we=Po(ue);console.log("🎹 Calling showDrumGrid with metrics:",we,"pattern:",ne),Hs(we,ne)},_=document.getElementById("modal-pattern");_&&_.addEventListener("input",()=>{if(!ae.active||ae.updatingFromGrid||!r||!it(r.value))return;const K=document.getElementById("modal-time-signature-select"),J=(K==null?void 0:K.value)||this.currentTimeSignature||"4/4",ne=Po(J),M=_.value?_.value.trim():"",ue=Cs(_.value);if(M&&(!ue||ue.length===0)){_n(!0),Ys();return}an(_.value,ne)});const B=K=>{var xe;if(!K)return;const J=this.currentEditingElementId;if(J){const Ae=document.getElementById("modal-title");Ae&&(Ae.value=K.label);const fe=document.getElementById("modal-element-id");if(fe&&(fe.textContent=Wu(J)),Vi(J,K.label),typeof this.saveElementConfig=="function"){const Ze={...((xe=this.loadElementConfig)==null?void 0:xe.call(this,J))||{},title:K.label};this.saveElementConfig(J,Ze,!0)}}const ne=typeof K.bank=="string"?K.bank:"",M=()=>{if(typeof K.useNoteNames=="boolean")return K.useNoteNames;const Ae=K.pattern||"";return Ae.includes("note(")||Ae.includes('note("')},ue=()=>{if(K.pattern){const Ae=document.getElementById("modal-keep-notes-as-written");Ae&&(Ae.checked=M()),Ln("modal-pattern",K.pattern.trim()),un()}ne&&it(ne)?(_n(!1),w()):(_n(!0),Ys(),pt()),_&&_.focus()},we=document.getElementById("modal-keep-notes-as-written");if(we&&(we.checked=M()),r){const Ae=ne||"";if(r.value!==Ae){r.value=Ae,r.dispatchEvent(new Event("change",{bubbles:!0})),setTimeout(ue,60);return}}ue()};cn();const R=K=>{if(!K||!K.classList.contains("has-tooltip"))return;const J=K.getBoundingClientRect();if(J.width===0&&J.height===0){requestAnimationFrame(()=>R(K));return}const ne=(e==null?void 0:e.querySelector(".modal-presets-content"))||e,M=ne?ne.getBoundingClientRect():{left:0,width:window.innerWidth},ue=M.left+M.width/2,xe=J.left+J.width/2>ue;K.classList.toggle("tooltip-align-right",xe),K.classList.toggle("tooltip-align-left",!xe)};let Z=null;const Y=()=>{Z||(Z=requestAnimationFrame(()=>{Z=null;const K=e==null?void 0:e.querySelectorAll(".modal-preset-button.has-tooltip");K==null||K.forEach(J=>R(J))}))};window.addEventListener("resize",Y);const se=(K,J)=>{!K||!Array.isArray(J)||(K.innerHTML="",J.forEach(ne=>{const M=document.createElement("button");M.type="button",M.className="modal-preset-button";const ue=ne.editorBadge?`<span class="modal-preset-badge${ne.editorBadge.toLowerCase().includes("code")?" is-code":ne.editorBadge.toLowerCase().includes("step")?" is-step":""}">${ne.editorBadge}</span>`:"",we=ne.secondaryLabel?`<div class="modal-preset-secondary-row">${ne.secondaryLabel}</div>`:"";M.innerHTML=`
          <div class="modal-preset-heading-row">
            <strong>${ne.label}</strong>
            ${ue}
          </div>
          ${we}
          ${ne.description?`<span class="modal-preset-description">${ne.description}</span>`:""}
        `,ne.tooltip&&(M.classList.add("has-tooltip"),M.setAttribute("data-tooltip",ne.tooltip),M.addEventListener("mouseenter",()=>R(M)),M.addEventListener("focus",()=>R(M)),requestAnimationFrame(()=>R(M))),M.addEventListener("click",()=>B(ne)),K.appendChild(M)}),Y())},te=()=>{e.querySelectorAll(".modal-presets-subtoggle").forEach(J=>{const ne=J.getAttribute("data-target"),M=ne?document.getElementById(ne):J.nextElementSibling;if(!M)return;const ue=xe=>{J.setAttribute("aria-expanded",String(xe)),M.classList.toggle("is-open",xe);const Ae=J.closest(".modal-presets-group");Ae&&Ae.classList.toggle("collapsed",!xe)},we=M.classList.contains("is-open");ue(we),J.addEventListener("click",()=>{const xe=J.getAttribute("aria-expanded")!=="true";ue(xe)})})};Xe&&Ge&&Xe.addEventListener("click",()=>{const J=!(Xe.getAttribute("aria-expanded")==="true");qn(J)}),se(Ct,$3e),se(Et,VG),se(gn,N3e),te(),Ee&&!Ee.dataset.listenerAttached&&(Ee.addEventListener("change",K=>{const J=K.target.checked?"step":"code";_n(J==="code"),w()}),Ee.dataset.listenerAttached="true");const be=document.getElementById("modal-time-signature-select");be&&be.addEventListener("change",K=>{const J=K.target.value;if(J&&(this.currentTimeSignature=J,ae.active)){const ne=Po(J),M=In("modal-pattern"),ue=r?r.value:"";Dn(ne,ue),_e(ne),Hs(ne,M)}});const $e=document.getElementById("modal-drum-grid-bar-count"),Re=document.getElementById("modal-drum-grid-add-bar"),ut=document.getElementById("modal-drum-grid-bar-arrow-left"),on=document.getElementById("modal-drum-grid-bar-arrow-right");$e&&($e.addEventListener("click",()=>{const K=ae.currentBar<ae.numBars?ae.currentBar+1:1;et(K)}),$e.style.cursor="pointer",$e.title="Click to switch between bars"),ut&&ut.addEventListener("click",K=>{K.stopPropagation(),ae.currentBar>1&&et(ae.currentBar-1)}),on&&on.addEventListener("click",K=>{K.stopPropagation(),ae.currentBar<ae.numBars&&et(ae.currentBar+1)}),Re&&Re.addEventListener("click",K=>{K.stopPropagation(),is()}),this.applyTimeSignatureToDrumGrid=K=>{if(!Pe||!ae.active)return;const J=Po(K||"4/4"),ne=In("modal-pattern"),M=r?r.value:"";Dn(J,M),_e(J),Hs(J,ne)};const Yn=e.querySelector(".modal-close");Yn&&Yn.addEventListener("click",rt);const Is=document.getElementById("modal-sample-file");Is&&Is.addEventListener("change",K=>{var we,xe;const J=K.target.files&&K.target.files.length>0?K.target.files[0]:null,ne=(we=document.getElementById("modal-pattern-bank"))==null?void 0:we.closest(".form-group"),M=(xe=document.getElementById("modal-time-signature-select"))==null?void 0:xe.closest(".form-group"),ue=document.getElementById("modal-title");if(J){if(ne&&(ne.style.display="none"),M&&(M.style.display="none"),ue){const fe=J.name.replace(/\.[^/.]+$/,"");ue.value=fe}}else ne&&(ne.style.display="block")});const mn=document.getElementById("modal-key-select"),Jt=document.getElementById("modal-scale-select"),sn={container:document.getElementById("modal-scale-chord-suggestions"),title:document.getElementById("modal-scale-chord-title"),characteristic:document.getElementById("modal-scale-characteristic"),dropdown:document.getElementById("modal-chord-progression-select")},ps=(K,J)=>{try{const ne=K.trim(),M=J.map(we=>we);return uB.fromRomanNumerals(ne,M).filter(Boolean).map((we,xe)=>!we||we===""?J[xe]:we)}catch(ne){return console.warn("Error converting Roman numerals to chords:",ne,"Romans:",J),J.map(M=>M.replace(/b/g,"♭").replace(/#/g,"♯"))}},cr={ionian:{displayName:"Ionian (Major)",colorTone:"7 (natural)",progressions:{"2-chord":[{label:"I – IV",romans:["I","IV"]},{label:"I – V",romans:["I","V"]},{label:"I – vi",romans:["I","vi"]},{label:"Imaj7 – IVmaj7",romans:["Imaj7","IVmaj7"]}],"3-chord":[{label:"I – IV – V",romans:["I","IV","V"]},{label:"I – V – vi",romans:["I","V","vi"]},{label:"I – iii – vi",romans:["I","iii","vi"]},{label:"Imaj7 – vi – ii",romans:["Imaj7","vi","ii"]}],"4-chord":[{label:"I – IV – V – I",romans:["I","IV","V","I"]},{label:"I – vi – IV – V",romans:["I","vi","IV","V"]},{label:"I – V – vi – IV (pop classic)",romans:["I","V","vi","IV"]},{label:"ii – V – I – vi (turnaround)",romans:["ii","V","I","vi"]}]}},dorian:{displayName:"Dorian",colorTone:"natural 6 in a minor scale",progressions:{"2-chord":[{label:"i – IV",romans:["i","IV"]},{label:"i – ii",romans:["i","ii"]},{label:"i – v",romans:["i","v"]}],"3-chord":[{label:"i – IV – v",romans:["i","IV","v"]},{label:"i – ii – IV",romans:["i","ii","IV"]},{label:"i – IV – VII",romans:["i","IV","VII"]},{label:"i – iv – ♭VII",romans:["i","iv","bVII"]}],"4-chord":[{label:"i – IV – i – v",romans:["i","IV","i","v"]},{label:"i – ii – IV – i",romans:["i","ii","IV","i"]},{label:"i – IV – vii° – i",romans:["i","IV","vii°","i"]},{label:"i – iv – i – ♭VII",romans:["i","iv","i","bVII"]}]}},phrygian:{displayName:"Phrygian",colorTone:"♭2 (very dark/tense)",progressions:{"2-chord":[{label:"i – ♭II",romans:["i","bII"]},{label:"i – v",romans:["i","v"]}],"3-chord":[{label:"i – ♭II – i",romans:["i","bII","i"]},{label:"i – v – ♭II",romans:["i","v","bII"]}],"4-chord":[{label:"i – ♭II – vii – i",romans:["i","bII","vii","i"]},{label:"i – v – ♭II – i",romans:["i","v","bII","i"]}]}},lydian:{displayName:"Lydian",colorTone:"♯4 (bright, dreamy, floaty)",progressions:{"2-chord":[{label:"I – II",romans:["I","II"]},{label:"I – Vmaj7",romans:["I","Vmaj7"]}],"3-chord":[{label:"I – II – I",romans:["I","II","I"]},{label:"I – V – II",romans:["I","V","II"]}],"4-chord":[{label:"I – II – V – I",romans:["I","II","V","I"]},{label:"I – vii – II – I",romans:["I","vii","II","I"]}]}},mixolydian:{displayName:"Mixolydian",colorTone:"♭7 (rock-dominant sound)",progressions:{"2-chord":[{label:"I – ♭VII",romans:["I","bVII"]},{label:"I – v",romans:["I","v"]}],"3-chord":[{label:"I – ♭VII – IV",romans:["I","bVII","IV"]},{label:"I – IV – ♭VII",romans:["I","IV","bVII"]}],"4-chord":[{label:"I – ♭VII – IV – I",romans:["I","bVII","IV","I"]},{label:"I – v – ♭VII – IV",romans:["I","v","bVII","IV"]}]}},aeolian:{displayName:"Aeolian (Natural Minor)",colorTone:"♭6",progressions:{"2-chord":[{label:"i – ♭VI",romans:["i","bVI"]},{label:"i – ♭VII",romans:["i","bVII"]},{label:"i – iv",romans:["i","iv"]}],"3-chord":[{label:"i – ♭VII – ♭VI",romans:["i","bVII","bVI"]},{label:"i – iv – ♭VI",romans:["i","iv","bVI"]},{label:"i – iv – v",romans:["i","iv","v"]}],"4-chord":[{label:"i – ♭VII – ♭VI – v",romans:["i","bVII","bVI","v"]},{label:"i – iv – ♭VII – ♭VI",romans:["i","iv","bVII","bVI"]},{label:"i – iv – V – i (minor cadence)",romans:["i","iv","V","i"]}]}},locrian:{displayName:"Locrian",colorTone:"♭2, ♭5 (very unstable)",progressions:{"2-chord":[{label:"iø – ♭II",romans:["iø","bII"]},{label:"iø – v",romans:["iø","v"]}],"3-chord":[{label:"iø – ♭II – iø",romans:["iø","bII","iø"]},{label:"iø – v – ♭II",romans:["iø","v","bII"]}],"4-chord":[{label:"iø – ♭II – v – iø",romans:["iø","bII","v","iø"]}]}},"melodic minor":{displayName:"Melodic Minor (Jazz Minor)",colorTone:"i−maj7",progressions:{"2-chord":[{label:"i−maj7 – IV7",romans:["imMaj7","IV7"]},{label:"i−maj7 – V7",romans:["imMaj7","V7"]}],"3-chord":[{label:"i−maj7 – IV7 – v",romans:["imMaj7","IV7","v"]},{label:"i−maj7 – IV7 – ♭VIImaj7",romans:["imMaj7","IV7","bVIImaj7"]}],"4-chord":[{label:"i−maj7 – ii – IV7 – i−maj7",romans:["imMaj7","ii","IV7","imMaj7"]},{label:"imMaj7 – V7 – i – iv",romans:["imMaj7","V7","i","iv"]}]}},"lydian dominant":{displayName:"Lydian Dominant",colorTone:"♯11",progressions:{"2-chord":[{label:"I7 – II",romans:["I7","II"]}],"3-chord":[{label:"I7 – ♭VII – II",romans:["I7","bVII","II"]}],"4-chord":[{label:"I7 – iiø – ♭VII – I7",romans:["I7","iiø","bVII","I7"]}]}},altered:{displayName:"Altered (Super-Locrian)",colorTone:"V7alt",progressions:{"2-chord":[{label:"V7alt → i",romans:["V7alt","i"]},{label:"V7alt → Imaj7",romans:["V7alt","Imaj7"]}],"3-chord":[{label:"iiø – V7alt – i",romans:["iiø","V7alt","i"]}]}},"harmonic minor":{displayName:"Harmonic Minor",colorTone:"i−maj7",progressions:{"2-chord":[{label:"i – V",romans:["i","V"]}],"3-chord":[{label:"i – iv – V",romans:["i","iv","V"]}],"4-chord":[{label:"i – iv – V – i",romans:["i","iv","V","i"]}]}},"phrygian dominant":{displayName:"Phrygian Dominant",colorTone:"Major chord on ♭II + dominant on V",progressions:{"2-chord":[{label:"i – ♭II",romans:["i","bII"]},{label:"V – i",romans:["V","i"]}],"3-chord":[{label:"V – ♭II – i",romans:["V","bII","i"]}],"4-chord":[{label:"i – ♭II – V – i",romans:["i","bII","V","i"]}]}},"dorian #4":{displayName:"Ukrainian Dorian (Dorian ♯4)",colorTone:"Dorian ♯4",progressions:{"2-chord":[{label:"i – IV",romans:["i","IV"]}],"3-chord":[{label:"i – ♭VII – IV",romans:["i","bVII","IV"]}],"4-chord":[{label:"i – iv – ♭VII – IV",romans:["i","iv","bVII","IV"]}]}},"whole tone":{displayName:"Whole Tone",colorTone:"V7♯5",progressions:{"2-chord":[{label:"V7♯5 – V7♯5",romans:["V7#5","V7#5"]},{label:"V7♯5 – I",romans:["V7#5","I"]}],"3-chord":[{label:"V7♯5 – ♭III+ – V7♯5",romans:["V7#5","bIII+","V7#5"]}]}},"half-whole diminished":{displayName:"Half–Whole Diminished",colorTone:"V7♭9♯11♭13",progressions:{"2-chord":[{label:"V7♭9 – V7♭9",romans:["V7b9","V7b9"]}],"3-chord":[{label:"iiø – V7♭9 – i",romans:["iiø","V7b9","i"]}]}},"whole-half diminished":{displayName:"Whole–Half Diminished",colorTone:"°7",progressions:{"2-chord":[{label:"°7 – °7",romans:["°7","°7"]}],"3-chord":[{label:"°7 – °7 – °7",romans:["°7","°7","°7"]}],"4-chord":[{label:"°7 – ♭III – vi – °7",romans:["°7","bIII","vi","°7"]}]}}},$i=K=>!K||typeof K!="string"?"":K.replace(/bb(?=\d)/gi,"♭♭").replace(/b(?=\d)/gi,"♭").replace(/#(?=\d)/g,"♯").split(/\s+/).filter(Boolean).map(ne=>ne.charAt(0).toUpperCase()+ne.slice(1)).join(" "),Gr=()=>{const K=document.getElementById("modal-scale-notes-display");if(!K)return;const J=mn?(mn.value||"").trim():"",ne=Jt?(Jt.value||"").trim():"";if(!ne||ne==="chromatic"){K.textContent="";return}try{const ue={major:"major",minor:"minor",chromatic:"chromatic",harmonicMinor:"harmonic minor",melodicMinor:"melodic minor",dorian:"dorian",phrygian:"phrygian",lydian:"lydian",mixolydian:"mixolydian",locrian:"locrian",blues:"blues",pentatonicMajor:"major pentatonic",pentatonicMinor:"minor pentatonic",ionian:"major",aeolian:"minor","melodic minor":"melodic minor","dorian b2":"dorian b2","lydian augmented":"lydian augmented","lydian dominant":"lydian dominant","mixolydian b6":"mixolydian b6","locrian #2":"locrian #2",altered:"altered","harmonic minor":"harmonic minor","locrian #6":"locrian #6","ionian #5":"ionian #5","dorian #4":"dorian #4","phrygian dominant":"phrygian dominant","lydian #2":"lydian #2",ultralocrian:"ultralocrian","harmonic major":"harmonic major","dorian b5":"dorian b5","phrygian b4":"phrygian b4","lydian b3":"lydian b3","mixolydian b2":"mixolydian b2","lydian augmented #2":"lydian augmented #2","locrian bb7":"locrian bb7","major pentatonic":"major pentatonic","suspended pentatonic":"suspended pentatonic","man gong":"man gong",ritusen:"ritusen","minor pentatonic":"minor pentatonic","blues minor pentatonic":"minor pentatonic","major pentatonic mode 3":"major pentatonic",egyptian:"egyptian","whole tone":"whole tone","half-whole diminished":"dominant diminished","whole-half diminished":"diminished","minor blues":"blues"}[ne.toLowerCase()]||ne.toLowerCase();let we="C";if(J){const Te=J.trim().match(/^([a-gA-G])([#b]?)/);Te?we=`${Te[1].toUpperCase()}${Te[2]||""}`:we=J.trim()}const xe=`${we} ${ue}`,Ae=_o.get(xe);if(!Ae||!Ae.notes||Ae.notes.length===0){K.textContent="";return}const Fe=Ae.notes.map((Te,Ne)=>`${Te.replace(/-?\d+$/,"")} = ${Ne}`),Ze=`<strong>${we.toLowerCase()}:${ue}</strong> ${Fe.join(", ")}`;K.innerHTML=Ze}catch(M){console.warn("Error displaying scale notes:",M),K.textContent=""}},hi=()=>{if(!sn.container||!sn.dropdown)return;const K=mn?(mn.value||"").trim():"",J=Jt?(Jt.value||"").trim():"";if(sn.dropdown.innerHTML='<option value="">Select a progression...</option>',!K||!J){sn.container.style.display="none",sn.container.dataset.state="idle",sn.container.dataset.forceOpen="false",sn.title&&(sn.title.textContent="Select a key and scale to view chord progressions."),sn.characteristic&&(sn.characteristic.textContent="");return}const ne=J.toLowerCase(),M=cr[ne],ue=(M==null?void 0:M.displayName)||$i(J);if(sn.container.style.display="block",sn.container.dataset.forceOpen="true",sn.title&&(sn.title.textContent=`${K} ${ue} Chord Progressions`),!M||!M.progressions){sn.container.dataset.state="placeholder",sn.characteristic&&(sn.characteristic.textContent="No chord progressions available for this scale yet.");return}sn.container.dataset.state="ready",sn.characteristic&&(sn.characteristic.textContent=`Color tone: ${M.colorTone||"N/A"}`),["2-chord","3-chord","4-chord"].forEach(xe=>{const Ae=M.progressions[xe];if(Ae&&Ae.length>0){const fe=document.createElement("optgroup");fe.label=xe.charAt(0).toUpperCase()+xe.slice(1).replace("-"," "),Ae.forEach(Fe=>{const Ze=document.createElement("option"),Te=ps(K,Fe.romans),Ne=Te.length>0?`${Fe.label} (${Te.join(" – ")})`:Fe.label;Ze.value=JSON.stringify({romans:Fe.romans,label:Fe.label}),Ze.textContent=Ne,fe.appendChild(Ze)}),sn.dropdown.appendChild(fe)}})};hi(),Gr(),sn.dropdown&&sn.dropdown.addEventListener("change",K=>{const J=K.target.value;if(!(!J||J===""))try{const ne=JSON.parse(J),M=mn?(mn.value||"").trim():"";if(!M){console.warn("No key selected for chord progression");return}const ue=ps(M,ne.romans);if(ue.length>0){const we=In("modal-pattern")||"";let xe=we;xe=xe.replace(/\bn\s*\([^)]*\)\s*\.\s*scale\s*\([^)]*\)(?:\s*\.\s*[a-zA-Z]+\s*\([^)]*\))*/gi,""),xe=xe.replace(/\bn\s*\(["'][^"']*["']\)\s*\.\s*scale\s*\(["'][^"']*["']\)(?:\s*\.\s*[a-zA-Z]+\s*\([^)]*\))*/gi,""),xe=xe.replace(/^\s*\.\s*/,"").replace(/\s*\.\s*$/,"").trim();const fe=`n().chord("<${ue.join(" ")}>").voicing()`,Fe=Ni(fe,we);Ln("modal-pattern",Fe)}}catch(ne){console.warn("Error parsing chord progression data:",ne)}});const di=K=>{if(typeof K!="string")return!1;let J=0,ne=!1,M="";for(let ue=0;ue<K.length;ue++){const we=K[ue];if(ne){if(we==="\\"){ue++;continue}we===M&&(ne=!1,M="");continue}if(we==='"'||we==="'"){ne=!0,M=we;continue}if(we==="("&&J++,we===")"&&J--,J<0)return!1}return!ne&&J===0},Ls=(K,J,ne=!1)=>{if(!K||!K.trim())return K;let M=K.trim();if(ne){const ue=/\.\s*bank\s*\(\s*["'][^"']*["']\s*\)/gi;ue.test(M)?M=M.replace(ue,`.bank("${J}")`):M=`${M}.bank("${J}")`}else{const ue=/\.\s*(s|sound)\s*\(\s*["'][^"']*["']\s*\)/gi;ue.test(M)?M=M.replace(ue,`.s("${J}")`):M=`${M}.s("${J}")`}return M},ql=K=>{if(!K||typeof K!="string")return null;const J=K.match(/\.bank\s*\(\s*["']([^"']+)["']\s*\)/i),ne=K.match(/\.s(?:ound)?\s*\(\s*["']([^"']+)["']\s*\)/i);if(J&&Mo.has(J[1]))return{type:"drum",value:J[1]};if(ne){const M=J&&J[1]&&J[1].toLowerCase()==="vcsl"?"vcsl":null;return{type:"synth",value:ne[1],extraBank:M}}return J&&J[1]&&J[1].toLowerCase()==="vcsl"?{type:"synth",value:null,extraBank:"vcsl"}:null},Dr=()=>{if(!r)return null;const K=nd(r.value||"");if(!K.bankValue)return null;if(Mo.has(K.bankValue))return{type:"drum",value:K.bankValue};const J=(K.bankValue||"").toLowerCase(),ne=Og[J]||K.bankValue,M=K.isVcslInstrument&&K.vcslInstrument||ne,ue=K.isVcslInstrument?"vcsl":null;return{type:"synth",value:M,extraBank:ue}},nl=(K,J)=>{if(!J||!K)return K;let ne=K;return J.type==="drum"&&J.value?ne=Ls(ne,J.value,!0):J.type==="synth"&&(J.value&&(ne=Ls(ne,J.value,!1)),J.extraBank==="vcsl"&&(/\.bank\s*\(\s*["']vcsl["']\s*\)/i.test(ne)||(ne=`${ne}.bank("vcsl")`))),ne},Ni=(K,J)=>{const ne=Dr()||ql(J||K);return nl(K,ne)},Xr=K=>{if(!K||!K.trim())return"";const J=K.trim();if(/(\.\s*(bank|s|sound)\s*\()|(\b(note|n|stack|sound)\s*\()/i.test(J))return J;const M=Y3e(J);return M?M.trim():""},Ul=(K,J,ne,M)=>{let we=(K||"").trim();const xe=/\.\s*(s|sound|scale)\s*\(/i.test(we);we?(!we.startsWith("(")||!we.endsWith(")"))&&(xe||(we=`(${we})`)):we="(silence)";const Ae=we.match(/\.\s*scale\s*\(\s*['"]([^'"]+)['"]\s*\)/i),fe=Ae?Ae[1]:null,Fe=we.match(/\.\s*(s|sound)\s*\(\s*["']([^"']+)["']\s*\)/i),Ze=Fe?Fe[2]:null;let Te=we.replace(/\.\s*scale\s*\([^)]*\)/gi,"").replace(/\.\s*(s|sound)\s*\([^)]*\)/gi,"");if(ne&&ne.trim()!==""||J&&J.trim()!==""){const ot=J&&J.trim()!==""?J.trim().toLowerCase():"c",at=ne&&ne.trim()!==""?ne.trim():"major";Te=`${Te}.scale('${ot}:${at}')`}else fe&&(Te=`${Te}.scale('${fe}')`);return Ze&&(Te=`${Te}.s("${Ze}")`),Te},_i=(K=!1)=>{hi(),Gr();const J=In("modal-pattern"),ne=mn&&mn.value||null,M=Jt&&Jt.value||null;if(console.log(`🎼 applyKeyScaleToPattern called: keyValue="${ne}", scaleValue="${M}"`),!ne&&!M){console.log("⚠️ No key/scale selected, skipping");return}const ue=document.getElementById("modal-keep-notes-as-written"),we=K||ue&&ue.checked,xe=ne&&ne.trim()!==""?ne:null,Ae=M&&M.trim()!==""?M:null;if(!J||J.trim()===""||!xi(J)){let tt=null;if(J&&J.trim()!==""){const Je=J.match(/\.\s*(s|sound)\s*\(\s*["']([^"']+)["']\s*\)/i);Je&&Je[2]&&(tt=Je[2])}if(!tt){const Je=document.getElementById("modal-pattern-bank");Je&&Je.value&&(tt=Je.value.toLowerCase())}let Ue="";if(we){if(typeof this.getAllScaleNotesAsNoteNames=="function"&&(Ue=this.getAllScaleNotesAsNoteNames(ne||"C",M||"chromatic")||""),!Ue){const Je=this.getAllScaleNotesAsPattern(ne||"C",M||"chromatic");Je&&(Ue=this.convertNumericPatternToNoteNames(Je,ne||"C",M||"chromatic"))}}else{const Je=this.getAllScaleNotesAsPattern(ne||"C",M||"chromatic");if(Je){const Me=Je.match(/(?:note|n)\s*\(\s*["']([^"']+)["']\s*\)/),He=Me?Me[1]:"0 1 2 3 4 5",zt=`${(ne||"C").toLowerCase()}:${M||"chromatic"}`;Ue=`n("${He}").scale('${zt}')`}}if(!Ue){console.warn("⚠️ Could not generate scale notes for empty/non-note pattern");return}tt&&(Ue=`${Ue}.s("${tt}")`),di(Ue)?(Ln("modal-pattern",Ue),console.log(`🎼 Inserted scale notes for empty/non-note pattern: ${Ue}`)):console.warn("⚠️ Generated scale-notes pattern failed quick syntax check; not applying");return}const fe=/\b(note|n)\s*\(/.test(J),Fe=/\b(note|n)\s*\(\s*["'][a-g][#b]?/.test(J),Ze=/\b(note|n)\s*\(\s*["'][a-g][#b]?[a-z0-9]*\s*[a-z]/.test(J)||/\b(note|n)\s*\(\s*["'][^"']*\b(maj|min|m|dim|aug|sus|add|7|9|11|13)\b/i.test(J),Te=/\.\s*chord\s*\(/i.test(J),Ne=/\b(note|n)\s*\(\s*["'][^"']*[a-g][#b]?\s/.test(J),ot=Fe||Ze||Ne||Te,at=fe&&!ot&&!Te;if(ot&&!at){console.log("ℹ️ Pattern uses explicit note names – skipping key/scale rewrite");return}if(fe&&Co(J)&&!ot&&!Te){const tt=Yr(xe,Ae);if(!tt){console.log("ℹ️ Numeric pattern: no scale selected, skipping rewrite");return}let Ue=J.replace(/\.\s*scale\s*\((['"])(?:(?=(\\?))\2.)*?\1\)/gi,"");Ue=Ue.replace(/\.\s*scale\s*\([^)]*\)/gi,""),Ue=Ue.replace(/\.+/g,".").replace(/\.\s*\./g,".").trim(),Ue=Ue.replace(/\.+$/,"").trim(),Ue=Or(Ue,tt),Ln("modal-pattern",Ue),Ir(Ue,!0),console.log(`ℹ️ Numeric pattern updated with scale modifier ${tt}`);return}if(we&&Fe&&!Te){const tt=le.convertNoteNamesToSemitones(J),Ue=xe||"C",Je=Ae||"chromatic";let Me=tt?this.convertNumericPatternToNoteNames(tt,Ue,Je):null;if((!Me||Me===J)&&(Me=this.convertNumericPatternToNoteNames(J,Ue,Je)),Me&&Me!==J){const He=Yr(xe,Ae);He&&(Da=He),Js=!0,Ir(Me,!0),Me=Ni(Me,J),Ln("modal-pattern",Me),xe&&(le.currentKey=xe),Ae&&(le.currentScale=Ae);const zt=document.getElementById("modal-pattern");if(zt){try{zt.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{zt.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}}console.log(`🎼 Converted note names to new key/scale: ${Me.substring(0,120)}...`);return}else console.log(`⚠️ Note names unchanged after conversion attempt (key=${Ue}, scale=${Je})`)}if(!Te&&at){console.log(`🎼 applyKeyScaleToPattern: keyValue="${ne}", scaleValue="${M}", pattern="${J.substring(0,50)}..."`);let tt=J;if(Ae&&(xe||Ae))if(we){const Je=/\b(note|n)\s*\(\s*["'][a-gA-G][#b]?\d/.test(J);if(/\b(n|note)\s*\(\s*["'][\d\s]+["']/.test(J)&&!Je)tt=this.convertNumericPatternToNoteNames(J,xe,Ae),console.log(`🎼 Converted numeric pattern to note names in ${Ae}: ${tt.substring(0,100)}...`);else if(Je){const He=le.convertNoteNamesToSemitones(J);He&&He!==J?(tt=this.convertNumericPatternToNoteNames(He,xe,Ae),console.log(`🎼 Converted note names to ${Ae} scale: ${tt.substring(0,100)}...`)):tt=this.convertNumericPatternToNoteNames(J,xe,Ae)}try{const He=this.getAllScaleNotesAsPattern(xe||"C",Ae||"chromatic");if(He){const Tt=this.convertNumericPatternToNoteNames(He,xe||"C",Ae||"chromatic").match(/\b(note|n)\s*\(\s*["']([^"']+)["']\s*\)/i),hn=tt.match(/\b(note|n)\s*\(\s*["']([^"']+)["']\s*\)/i);if(Tt&&hn){const Bn=Tt[2];tt=tt.replace(/\b(note|n)\s*\(\s*["'][^"']+["']\s*\)/i,(wn,os)=>`${os}("${Bn}")`),console.log(`🎼 Resized note names to match scale: ${Bn}`)}}}catch{}}else{const Je=Ul(J,xe,Ae);if(di(Je)){tt=Je;const Me=tt.match(/\b(n|note)\s*\(\s*["']([^"']+)["']\s*\)/i);if(Me&&Me[2]){const He=Me[2].trim().split(/\s+/).map(Tt=>parseInt(Tt,10)).filter(Tt=>!isNaN(Tt)),zt=this.getAllScaleNotesAsPattern(xe||"C",Ae||"chromatic");if(zt){const Tt=zt.match(/\b(n|note)\s*\(\s*["']([^"']+)["']\s*\)/i),hn=Tt?Tt[2]:null;if(hn){const Bn=hn.trim().split(/\s+/).length;He.length!==Bn&&(tt=tt.replace(/\b(n|note)\s*\(\s*["'][^"']+["']\s*\)/i,(wn,os)=>`${os}("${hn}")`),console.log(`🎼 Resized numeric degrees to match scale (${Bn} steps): ${hn}`))}}}}else tt=J;console.log(`🎼 Semitone mode: upserted scale=${Ae} key=${xe}`)}let Ue=tt;if(console.log(`🎼 applyKeyScaleToPattern: result="${Ue?Ue.substring(0,80):"null"}..."`),console.log(`🎼 Pattern comparison - original length: ${J.length}, new length: ${Ue?Ue.length:0}, same: ${Ue===J}`),!we&&Ue&&Co(Ue)){const Je=Tn(Ue,xe,Ae);Je&&Je!==Ue&&(Ue=Je,console.log(`🎼 Normalized numeric pattern to scale degrees (${Ae||"chromatic"})`))}if(!we&&Ue&&(xe||Ae))try{const Je=this.getAllScaleNotesAsPattern(xe||"C",Ae||"chromatic"),Me=Je&&Je.match(/\b(n|note)\s*\(\s*["']([^"']+)["']\s*\)/i),He=Me?Me[2]:null,zt=Ue.match(/\b(n|note)\s*\(\s*["']([^"']+)["']\s*\)/i);if(He&&zt&&zt[2]){const wn=zt[2].trim().split(/\s+/);wn.every(x=>/^-?\d+$/.test(x))&&wn.every((x,P)=>parseInt(x,10)===P)&&(Ue=Ue.replace(/\b(n|note)\s*\(\s*["'][^"']+["']\s*\)/i,(x,P)=>`${P}("${He}")`),console.log(`🎼 Resized numeric degrees to match scale (${Ae||"chromatic"}): ${He}`))}const Tt=xe||"C",hn=Ae||"chromatic",Bn=this.convertNumericPatternToNoteNames(Ue,Tt,hn);if(Bn){const wn=le.convertNoteNamesToScaleDegrees(Bn,Tt,hn);wn&&di(wn)&&(Ue=wn,console.log(`🎼 Normalized numeric degrees to scale length (${hn})`))}}catch(Je){console.warn("⚠️ Degree resize failed:",Je)}if(we&&(xe||Ae)){const Je=Yr(xe||null,Ae||null);Je&&(Da=Je)}if(Ue){!we&&Co(Ue)&&(Ue=Tn(Ue,xe,Ae),da=Ue),Js=!1,Ir(Ue,!0),Ln("modal-pattern",Ue),xe&&(le.currentKey=xe),Ae&&(le.currentScale=Ae);const Je=document.getElementById("modal-pattern");if(Je){try{Je.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{Je.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}}console.log(`✅ Applied key/scale to pattern immediately: ${Ue.substring(0,100)}...`)}else console.log("⚠️ Pattern unchanged - applyGlobalSettingsToPattern returned null or undefined")}else if(!Te&&ot&&!we){const tt=Ks(J);let Ue=xe||null,Je=Ae||null;tt&&(Ue=Ue||tt.key||null,Je=Je||tt.scale||null);const Me=Ue||"C",He=Je||"chromatic",zt=le.convertNoteNamesToScaleDegrees(J,Me,He),hn=(Tn(zt||J,xe,Ae)||J).replace(/\.\s*scale\s*\([^)]*\)/gi,""),Bn=Or(hn,Yr(xe,Ae));if(di(Bn)){Ln("modal-pattern",Bn),xe&&(le.currentKey=xe),Ae&&(le.currentScale=Ae);const wn=document.getElementById("modal-pattern");if(wn){try{wn.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{wn.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}}console.log(`✅ Converted note names to semitone degrees for scale: ${Bn.substring(0,120)}...`)}else console.log("⚠️ Conversion to semitones or upsert failed validation; leaving pattern unchanged")}else console.log(`⚠️ Cannot apply scale - hasChordModifier: ${Te}, isNumericPattern: ${at}, hasNoteFunction: ${fe}, hasExplicitNotes: ${ot}`)};mn&&!mn.dataset.listenerAttached&&(mn.addEventListener("change",()=>{Gr(),_i(!1)}),mn.dataset.listenerAttached="true"),Jt&&!Jt.dataset.listenerAttached&&(Jt.addEventListener("change",()=>{Gr(),_i(!1)}),Jt.dataset.listenerAttached="true"),Gr();const Ks=K=>{const J=K.match(/\.\s*scale\s*\(\s*['"]([^'"]+)['"]\s*\)/i);if(J&&J[1]){const ne=J[1];if(ne.includes(":")){const[M,ue]=ne.split(":");return{key:M.trim(),scale:ue.trim()}}else return{key:"C",scale:ne.trim()}}return null};let Da=null,Fs=null,Js=!1,da=null,Ta=null,Hr=null,Ba=null;const Yr=(K,J)=>{const ne=K&&K.trim()!=="",M=J&&J.trim()!=="";if(!ne&&!M)return null;const ue=ne?K.trim().toLowerCase():"c",we=M?J.trim():"major";return`.scale('${ue}:${we}')`},Wl=K=>{if(!K||typeof K!="string")return null;const J=K.match(/\bnote\s*\(\s*["']([^"']+)["']/i);if(!J||!J[1])return null;const M=J[1].match(/([a-gA-G])([#b]?)/);if(!M)return null;const ue=M[1].toUpperCase(),we=M[2]?M[2]:"";return`${ue}${we}`},Ir=(K,J=!1)=>{if(!K||!xi(K)){Fs=null,Js=!1;return}if(Js&&!J)return;if(Co(K)){Fs=K;return}const ne=le.convertNoteNamesToSemitones(K);ne&&Co(ne)&&(Fs=ne)},Or=(K,J)=>{if(!K||!J||/\.\s*scale\s*\(/i.test(K))return K;const ne=K.search(/\.(s|sound)\s*\(/i);if(ne!==-1){const ue=K.slice(0,ne),we=K.slice(ne);return`${ue}${J}${we}`}const M=K.trim();return M.startsWith("(")&&M.endsWith(")")?`${K}${J}`:`(${K})${J}`},Tn=(K,J,ne)=>{if(!K||!Co(K))return K;const M=!J||!J.trim()||!ne||!ne.trim()?Ks(K):null,ue=J&&J.trim()||(M==null?void 0:M.key)||"C",we=ne&&ne.trim()||(M==null?void 0:M.scale)||"chromatic",xe=this.convertNumericPatternToNoteNames(K,ue,we);if(!xe)return K;const Ae=le.convertNoteNamesToScaleDegrees(xe,ue,we);if(Ae&&Co(Ae)){const fe=le.getScaleSemitoneSteps(ue,we);if(!fe||fe.length===0)return Ae;const Fe=fe.length;return(Te=>{const Ne=/\b(n|note)\s*\(\s*(["'])([\s\S]*?)\2\s*\)/gi;return Te.replace(Ne,(ot,at,tt,Ue)=>{const Je=Ue.trim().split(/\s+/);if(Je.length<=Fe)return ot;const Me=Je.map(Tt=>{const hn=parseInt(Tt,10);return Number.isFinite(hn)?hn:null});if(Me.some(Tt=>Tt===null)||!Me.every((Tt,hn)=>Tt===hn))return ot;const zt=Array.from({length:Fe},(Tt,hn)=>String(hn)).join(" ");return`${at}(${tt}${zt}${tt})`})})(Ae)}return K},wr=(K,J,ne=!1)=>{if(!K||!xi(K))return K;const M=le.patternHasNoteNames&&le.patternHasNoteNames(K)||/\b(note|n)\s*\(\s*["'][^"']*[a-gA-G][#b]?\d/i.test(K),ue=le.patternHasNumericNotePattern&&le.patternHasNumericNotePattern(K)||/\b(note|n)\s*\(\s*["'][\d\s\-~<>[\]]+["']/i.test(K)&&!M;if(J){if(ue&&!M){Js||(Fs=K),Js=!0;const we=Ks(K),xe=document.getElementById("modal-key-select"),Ae=document.getElementById("modal-scale-select");let fe=xe&&xe.value||null,Fe=Ae&&Ae.value||null;return we&&(fe=we.key,Fe=we.scale,console.log(`🎼 Using scale from pattern .scale() modifier: ${fe}:${Fe}`)),fe||Fe?t.convertNumericPatternToNoteNames(K,fe,Fe||"major"):(console.log("⚠️ No key/scale selected, using C major for conversion"),t.convertNumericPatternToNoteNames(K,"C","major"))}return K}else{if(M&&!ue){if(Js=!1,Fs&&Co(Fs))return console.log("🔁 Restoring semitone snapshot for note-name toggle"),Fs;const we=Ks(K);let xe=null,Ae=null;if(we)xe=we.key,Ae=we.scale;else{const Fe=Wl(K);if(Fe)xe=Fe,Ae="chromatic";else{const Ze=document.getElementById("modal-key-select"),Te=document.getElementById("modal-scale-select");xe=Ze&&Ze.value||"C",Ae=Te&&Te.value||"chromatic"}}let fe=le.convertNoteNamesToScaleDegrees(K,xe||"C",Ae||"chromatic");if(fe&&fe!==K){const Fe=Yr(xe||"C",Ae||"chromatic");return Fe&&(fe=Or(fe,Fe)),console.log(`🔄 Converted note names to scale degrees: ${fe.substring(0,80)}...`),Ir(fe,!0),da=fe,fe}return K}return K}},fn=document.getElementById("modal-keep-notes-as-written");fn&&!fn.dataset.listenerAttached&&(fn.addEventListener("change",()=>{const K=In("modal-pattern"),J=fn.checked;let ne;J&&Hr&&Ba&&K===Ba?(ne=Hr,console.log("🔁 Restoring original note-name pattern from snapshot")):!J&&Ta&&K===Ta&&da?(ne=da,console.log("🔁 Restoring canonical numeric pattern from snapshot")):ne=wr(K,J,!0);const M=document.getElementById("modal-key-select"),ue=document.getElementById("modal-scale-select");if(J?Js=!0:Js=!1,J&&ne){const we=/\.\s*scale\s*\((['"])(?:(?=(\\?))\2.)*?\1\)/gi,xe=ne.match(we);if(xe&&xe.length>0)Da=xe[xe.length-1];else{const Ae=Yr(M==null?void 0:M.value,ue==null?void 0:ue.value);Ae&&(Da=Ae)}ne=ne.replace(we,""),ne=ne.replace(/\.\s*scale\s*\([^)]*\)/gi,""),ne=ne.replace(/\.+/g,".").replace(/\.\s*\./g,".").trim(),ne=ne.replace(/\.+$/,"").trim(),console.log("🗑️ Removed .scale() modifier when switching to note names")}else!J&&ne&&Da&&(ne=Or(ne,Da));ne!==K?(ne=Ni(ne,K),Ln("modal-pattern",ne),J?(da=K,Ta=ne,Js=!0,Hr=null,Ba=null):(Ta=null,Js=!1,K&&xi(K)?(Hr=K,Ba=ne):(Hr=null,Ba=null),Ir(ne,!0)),console.log(`🔄 Converted pattern ${J?"to note names":"to semitones"}: ${ne.substring(0,100)}...`)):J||(Ta=null,Js=!1,Hr=null,Ba=null,Ir(K,!0)),Ft()}),fn.dataset.listenerAttached="true"),Ir(In("modal-pattern"),!0);const Oo=K=>K.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Kr=(K,J)=>{if(!K||!J)return K;let ne=K.trim();const M=(we,xe,Ae)=>{if(!Ae)return we;const fe=new RegExp(`\\s*\\.\\s*${xe}\\s*\\(\\s*${Oo(Ae)}\\s*\\)\\s*$`,"i");let Fe=we;for(;fe.test(Fe);)Fe=Fe.replace(fe,"").trim();return Fe};return typeof J.gain=="number"&&Math.abs(J.gain-1)>1e-6&&(ne=M(ne,"gain",J.gain.toFixed(2))),typeof J.pan=="number"&&Math.abs(J.pan)>1e-6&&(ne=M(ne,"pan",J.pan.toFixed(2))),ne=(we=>{let xe=we;for(;xe.startsWith("(")&&xe.endsWith(")");){let Ae=0,fe=!0;for(let Fe=0;Fe<xe.length;Fe++){const Ze=xe[Fe];if(Ze==="("?Ae++:Ze===")"&&Ae--,Ae===0&&Fe<xe.length-1){fe=!1;break}}if(fe&&Ae===0)xe=xe.slice(1,-1).trim();else break}return xe})(ne.trim()),ne},Gl=K=>{if(!K||typeof K!="string")return[];let J=K.trim();if(!J)return[];J.startsWith("[")&&J.endsWith("]")&&(J=J.slice(1,-1).trim());const ne=[];let M="",ue=0,we=!1,xe=null,Ae=!1,fe=!1;for(let Fe=0;Fe<J.length;Fe++){const Ze=J[Fe],Te=J[Fe+1];if(Ae){Ze===`
`&&(Ae=!1,M+=Ze);continue}if(fe){Ze==="*"&&Te==="/"&&(fe=!1,Fe++);continue}if(!we&&Ze==="/"&&Te==="/"){Ae=!0,Fe++;continue}if(!we&&Ze==="/"&&Te==="*"){fe=!0,Fe++;continue}if(we){M+=Ze,Ze===xe&&J[Fe-1]!=="\\"&&(we=!1,xe=null);continue}if(Ze==='"'||Ze==="'"){we=!0,xe=Ze,M+=Ze;continue}if(Ze==="("||Ze==="["||Ze==="{"){ue++,M+=Ze;continue}if(Ze===")"||Ze==="]"||Ze==="}"){ue>0&&ue--,M+=Ze;continue}if(Ze===","&&ue===0){M.trim()&&ne.push(M.trim()),M="";continue}M+=Ze}return M.trim()&&ne.push(M.trim()),ne.filter(Boolean)};this.syncElementsFromMasterPattern=K=>{if(!K||typeof K!="string"){console.warn("⚠️ Cannot sync elements - master pattern missing or invalid");return}try{const J=/^\/\/\s*Controls Selected Tempo:[^\n]*\n?/im;let ne=K.replace(J,"").trim();if(!ne){console.warn("⚠️ Master pattern empty after sanitizing, skipping element sync");return}let M=ne;const ue=ne.indexOf("stack(");if(ue!==-1){const Fe=ne.indexOf("(",ue);if(Fe!==-1){let Ze=1,Te=Fe+1,Ne=!1,ot=null;for(;Te<ne.length&&Ze>0;){const at=ne[Te],tt=ne[Te-1];if(Ne)at===ot&&tt!=="\\"&&(Ne=!1,ot=null);else if(at==='"'||at==="'")Ne=!0,ot=at;else if(at==="(")Ze++;else if(at===")"&&(Ze--,Ze===0)){M=ne.slice(Fe+1,Te);break}Te++}}}const we=/\s*\/\*\s*Channel\s+(\d+)\s*\*\/([\s\S]*?)(?=(\s*\/\*\s*Channel\s+\d+\s*\*\/)|$)/g;let xe;const Ae=[],fe=(Fe,Ze)=>{var He;if(!Number.isFinite(Fe)||Fe<1)return;let Te=Ze;if(!Te||(Te=Te.trim(),!Te)||(Te=Te.replace(/^,+/,"").replace(/,+$/,"").trim(),!Te))return;const Ne=Te,ot=`element-${Fe}`,at=(He=le.trackedPatterns)==null?void 0:He.get(ot),Ue=Kr(Te,at)||Te,Me={...this.loadElementConfig(ot)||{},pattern:Ue};if(this.saveElementConfig(ot,Me,!0),le.trackedPatterns){const zt=(at==null?void 0:at.gain)??(typeof le.getElementGain=="function"?le.getElementGain(ot):.8),Tt=(at==null?void 0:at.pan)??(typeof le.getElementPan=="function"?le.getElementPan(ot):0),hn=(at==null?void 0:at.muted)??!1,Bn=(at==null?void 0:at.soloed)??!1;le.trackedPatterns.set(ot,{rawPattern:Ne,pattern:Ue,gain:zt,pan:Tt,muted:hn,soloed:Bn})}if(this.currentEditingElementId===ot){const zt=In("modal-pattern");if((zt==null?void 0:zt.trim())!==Te.trim()&&(Ln("modal-pattern",Te),console.log(`📝 Updated modal editor for ${ot} to match master pattern`)),ae.active&&r&&it(r.value)){console.log("🔁 Refreshing drum grid to match updated pattern"),ae.updatingFromPattern=!0;const hn=document.getElementById("modal-time-signature-select"),Bn=(hn==null?void 0:hn.value)||this.currentTimeSignature||"4/4",wn=Po(Bn);an(Te,wn),ae.updatingFromPattern=!1}}Ae.push(ot)};for(;(xe=we.exec(M))!==null;){const Fe=parseInt(xe[1],10);fe(Fe,xe[2])}Ae.length===0&&Gl(M).forEach((Ze,Te)=>{fe(Te+1,Ze)}),Ae.length>0?console.log(`🔄 Synced master pattern changes to elements: ${Ae.join(", ")}`):console.warn("ℹ️ No channel definitions found while syncing master pattern")}catch(J){console.warn("⚠️ Failed to sync master pattern to elements:",J)}},setTimeout(()=>{const K=In("modal-pattern"),J=mn&&mn.value||null,ne=Jt&&Jt.value||null;K&&xi(K)&&(J||ne)&&(console.log(`🎼 Applying initial key/scale on modal open: key="${J}", scale="${ne}"`),_i())},200),r&&!r.dataset.listenerAttached&&r.addEventListener("change",async K=>{var wn,os,Ps;const J=K.target.value,ne=nd(J),M=ne.bankValue;console.log("📦 Bank select changed to:",J),r.value!==J&&(r.value=J);const ue=this.currentEditingElementId,we=(x={},P=!0)=>{if(!ue)return;const p={...this.loadElementConfig(ue)||{},...x};ne.isVcslInstrument?p.vcslInstrument=ne.vcslInstrument:"vcslInstrument"in p&&delete p.vcslInstrument,this.saveElementConfig(ue,p,P)};if(M&&M!==""){Is&&(Is.value="");const x=(wn=document.getElementById("modal-pattern-bank"))==null?void 0:wn.closest(".form-group");x&&(x.style.display="block"),Ft(),this.selectedTagKey="bank",typeof this.refreshSnippetButtons=="function"&&setTimeout(()=>{this.refreshSnippetButtons().catch(P=>console.warn("⚠️ Unable to refresh snippet tags:",P))},100)}else Ft(),this.selectedTagKey=null,typeof this.refreshSnippetButtons=="function"&&setTimeout(()=>{this.refreshSnippetButtons().catch(x=>console.warn("⚠️ Unable to refresh snippet tags:",x))},100);if(!ue){console.warn("⚠️ No elementId when bank changed");return}const xe=document.getElementById("status-text"),Ae=document.getElementById("modal-pattern"),fe=!!(le!=null&&le.masterActive),Fe=In("modal-pattern");M&&M!==""&&(!Fe||Fe.trim()==="")&&Ae&&(Ae.placeholder='Drums and Percussion: s("bd sd rim cp hh oh cr rd ht mt lt sh cb tb perc misc fx"), Synths: note("c3 d3 [e3 f3]")');const Ze=(os=document.getElementById("modal-sample-url"))==null?void 0:os.closest(".form-group"),Te=(Ps=document.getElementById("modal-sample-file"))==null?void 0:Ps.closest(".form-group"),Ne=document.getElementById("modal-sample-name-group"),ot=M&&M!=="";if(Ze&&(Ze.style.display=ot?"none":"block"),Te&&(Te.style.display=ot?"none":"block"),Ne&&(Ne.style.display=ot?"none":"block"),!M||M===""){console.log("📦 Using Default (no bank)"),Ae.placeholder="",xe&&(xe.textContent="📦 Using Default samples");const x=document.getElementById("modal-title");x.value="Default";const P=document.getElementById("modal-element-id");P&&(P.textContent=Wu(ue)),Vi(ue,"Default"),we({title:"Default",bank:void 0},!1),console.log(`📝 Saved title "Default" for ${ue}`);let T=In("modal-pattern").trim(),p=Xr(T);p&&p.trim()!==""?(p=p.replace(/\.\s*bank\s*\(\s*["'][^"']*["']\s*\)/gi,""),p=p.replace(/\.+/g,".").replace(/\.\s*\./g,".").trim(),p=p.replace(/\.+$/,"").trim(),Ln("modal-pattern",p),Ae.placeholder="",console.log(`📝 Removed .bank() modifier only, preserving pattern: ${p.substring(0,80)}...`)):Ae.placeholder="",S()}else{const x=(f,v)=>{if(!f||f.trim()==="")return v;let C=f.trim();return!C.endsWith(".")&&!v.startsWith(".")&&(C+="."),C+=v,C.replace(/\.\.+/g,".").replace(/\.\s+\./g,".").trim()};if(ne.isVcslInstrument){const f=ne.vcslInstrument,v=jG(f),C=document.getElementById("modal-title");xe&&(xe.textContent=`🎙️ VCSL Instrument: ${v}`),C&&(C.value=v);const E=document.getElementById("modal-element-id");E&&(E.textContent=Wu(ue)),Vi(ue,v),we({title:v,bank:"vcsl"},!0);let D=In("modal-pattern").trim(),Q=Xr(D);const z=/sound\s*\(\s*["'][^"']*["']\s*\)/i,W=Q&&Q.trim()!==""?Q:"";W?z.test(W)?Q=W.replace(z,`sound("${f}")`):W.includes(".s(")?Q=W.replace(/\.s\s*\(\s*["'][^"']*["']\s*\)/i,`.sound("${f}")`):Q=x(W,`sound("${f}")`):Q=`sound("${f}")`,Q=Ls(Q,"vcsl",!0),Ln("modal-pattern",Q),Ae.placeholder="",setTimeout(()=>{Vt()},50);return}const P=N0(M);if([...Om,...zh].includes(P)||bG.includes(M)){const f=document.getElementById("modal-title"),v={piano:"Piano",supersaw:"Saw Synth",gtr:"Guitar",casio:"Casio",wood:"Jazz",jazz:"Jazz",metal:"Metal",folkharp:"Folk Harp",superpiano:"Piano"},C=v[P]||v[M]||P.charAt(0).toUpperCase()+P.slice(1);console.log(`🎹 Using synth sound: ${P}`),xe&&(xe.textContent=`🎹 Using ${C}`),f.value=C;const E=document.getElementById("modal-element-id");E&&(E.textContent=Wu(ue)),Vi(ue,C),we({title:C,bank:M}),console.log(`📝 Saved title "${C}" for ${ue}`);let D=In("modal-pattern").trim(),Q=Xr(D);Q&&Q.trim()!==""?(console.log(`🎹 BANK CHANGE: Updating .s() modifier only, preserving pattern: ${Q.substring(0,80)}...`),Q=Ls(Q,P,!1),console.log(`🎹 BANK CHANGE: Updated pattern: ${Q.substring(0,80)}...`)):(Q=`note("c3").s("${P}")`,console.log(`🎹 BANK CHANGE: Created minimal pattern with .s("${P}")`)),Ln("modal-pattern",Q),Ae.placeholder="";const z=document.getElementById("modal-keep-notes-as-written");z&&(z.checked=!0,console.log("🎹 Set note names toggle to ON for synth/waveform")),setTimeout(()=>{Vt()},50);const W=In("modal-pattern");console.log(`🎹 BANK CHANGE: Verified textarea contains: ${W}`)}else{console.log(`📦 Loading bank: ${M}`),xe&&(xe.textContent=`📦 Loading bank: ${M}...`);const f=["RolandTR808","RolandTR909","RolandTR707","RhythmAce","AkaiLinn","ViscoSpaceDrum","CasioRZ1"],v=[...Om,...zh,"insect","wind","east","crow","space","numbers","superpiano","jazz"],C=(M==null?void 0:M.toLowerCase())||"",E=k3e.has(C),D=f.includes(M)||v.includes(C);let Q=!1;if(E)try{Q=await le.loadBank(C),Q?(console.log(`✅ Specialty sample bank loaded: ${C}`),xe&&(xe.textContent=`✅ Bank loaded: ${C}`)):(console.log(`⚠️ Specialty sample bank "${C}" may not be fully loaded`),xe&&(xe.textContent=`⚠️ Bank "${C}" may not be available`))}catch(z){console.error(`Error loading specialty bank ${C}:`,z),Q=!1,xe&&(xe.textContent=`⚠️ Error loading bank: ${C}`)}else if(D)Q=!0,console.log(`✅ Built-in bank/waveform: ${M} (no loading required)`),xe&&(xe.textContent=`✅ Built-in: ${M}`);else try{Q=await le.loadBank(M),Q?(console.log(`✅ Bank loaded: ${M}`),xe&&(xe.textContent=`✅ Bank loaded: ${M}`)):(console.log(`⚠️ Bank "${M}" may not be fully loaded, but continuing...`),xe&&(xe.textContent=`⚠️ Bank "${M}" may not be available`))}catch(z){console.error(`Error loading bank ${M}:`,z),Q=!1,xe&&(xe.textContent=`⚠️ Error loading bank: ${M}`)}try{const z=document.getElementById("modal-title");let W;const G=cC.find(je=>je.value===C);if(M.startsWith("github:")){const je=_h.find(Ie=>Ie.value===M);if(je)W=je.label.replace(/\s*\(\d+\)$/,"");else{const Ie=M.match(/github:([^/]+\/[^/]+)/);W=Ie?Ie[1]:M.replace("github:","")}}else Mo.has(M)?W=B0(M):G?W=G.label:W=M;z.value=W;const X=document.getElementById("modal-element-id");if(X&&(X.textContent=Wu(ue)),Vi(ue,W),!fe&&this.activeElements.has(ue)){console.log(`🛑 Stopping sound for ${ue} (bank selected, not auto-playing)`),le.stopSound(ue),this.activeElements.delete(ue);const je=document.querySelector(`[data-sound-id="${ue}"]`);if(je){const Ie=je.querySelector(".element-circle");Ie&&Ie.classList.remove("playing"),this.updateStatusDots(ue,!0,!1)}}else fe&&console.log(`⏭️ Master running – skipping element stop for ${ue}`);const re=this.loadElementConfig(ue)||{};try{const je={...re,title:W,bank:M};localStorage.setItem(`elementConfig_${ue}`,JSON.stringify(je)),console.log(`📝 Saved title "${W}" and bank "${M}" for ${ue} (NOT saved to master)`)}catch(je){console.warn("⚠️ Could not save config:",je)}let de=In("modal-pattern").trim();console.log(`📝 Bank change: currentPattern="${de.substring(0,100)}..."`);let pe=Xr(de);console.log(`📝 Bank change: normalizedPattern="${pe.substring(0,100)}..."`);const ye=Mo.has(M),Ce=Om.includes(C)||zh.includes(C)||["sawtooth","square","triangle","sine"].includes(C),Be=M.startsWith("github:");if(console.log(`📝 Bank change: isDrumBank=${ye}, isSynthOrWaveform=${Ce}, isSpecialSampleBank=${E}, isSamplePack=${Be}, bankValue="${M}"`),Be)Ae.placeholder='Select a sample from "Sample Pack Sounds" to insert it into your pattern.',q(M,W),u!=null&&u.status&&(u.status.textContent="Choose a sample to insert. Each selection adds its own samples() block automatically.");else if(ye||E){const je=E?C:M;if(pe&&pe.trim()!==""){const Ie=pe;pe=Ls(pe,je,!0),console.log(`📝 Updated .bank("${je}") modifier`),console.log(`   Before: ${Ie.substring(0,80)}...`),console.log(`   After: ${pe.substring(0,80)}...`)}else E?pe=`${je==="mridangam"?'sound("tha dhi thom nam")':'sound("ahh ~ ohh")'}.bank("${je}")`:pe=`s("bd").bank("${je}")`,console.log(`📝 Created minimal pattern with .bank("${je}")`);Ln("modal-pattern",pe),Ae.placeholder="",S(),Ln("modal-pattern",pe),Ae.placeholder="",S(),S()}else if(Ce){const je=N0(M);if(pe&&pe.trim()!==""){const nt=pe;pe=Ls(pe,je,!1),console.log(`📝 Updated .s("${je}") modifier`),console.log(`   Before: ${nt.substring(0,80)}...`),console.log(`   After: ${pe.substring(0,80)}...`)}else pe=`note("c3").s("${je}")`,console.log(`📝 Created minimal pattern with .s("${je}")`);Ln("modal-pattern",pe),Ae.placeholder="";const Ie=document.getElementById("modal-keep-notes-as-written");Ie&&(Ie.checked=!0,console.log("📝 Set note names toggle to ON for synth/waveform"))}else Ae.placeholder='Add a pattern, e.g., sound("bd").bank("CustomBank")',S();console.log(`📝 Final pattern in editor: ${In("modal-pattern").substring(0,100)}...`),setTimeout(()=>{Vt()},50)}catch(z){console.error("Error loading bank:",z)}}}const at=document.getElementById("modal-title"),tt=at?at.value.trim():"",Ue=Ae?Ae.value.trim():"";let Je;Ue&&Ue.includes("(")&&Ue.includes(")")&&(Ue.match(/\([^)]+\)/g)||[]).some(x=>x.includes("drum")||x.includes("Kick")||x.includes("hi-hat"))?Je=Xr(Ue):Je=Ue;const Me=document.getElementById("modal-keep-notes-as-written"),He=Me&&Me.checked;if(Je&&xi(Je)&&!Co(Je)&&!He){const x=le.convertPatternForScale(Je);x&&x!==Je&&(Je=x,Ae&&Ln("modal-pattern",x))}if(!fe&&this.activeElements.has(ue)){console.log(`🛑 Stopping sound for ${ue} (bank changed, not auto-playing)`),le.stopSound(ue),this.activeElements.delete(ue);const x=document.querySelector(`[data-sound-id="${ue}"]`);if(x){const P=x.querySelector(".element-circle");P&&P.classList.remove("playing"),this.updateStatusDots(ue,!0,!1)}}else fe&&console.log(`⏭️ Master running – skipping element stop for ${ue}`);const zt=document.querySelector(`[data-sound-id="${ue}"]`);if(!fe&&zt){const x=zt.querySelector(".loop-button");x&&x.classList.contains("active")&&(console.log(`🛑 Stopping loop for ${ue} (bank changed)`),x.classList.remove("active"),le.stopSound(ue))}const Tt=document.getElementById("modal-keep-notes-as-written"),hn=Tt?Tt.checked:!1;this.saveElementConfig(ue,{title:tt||bankDisplayName,pattern:Je,bank:M||void 0,keepNotesAsWritten:hn},!0),console.log(`💾 Saved config with bank: ${M}`),le.invalidatePatternCache(ue),Je&&(await le.preEvaluatePattern(ue,Je),console.log(`📦 Pre-evaluated pattern for ${ue} (silent, ready for manual trigger)`));const Bn=M&&Mo.has(M);console.log("📦 Bank change: isDrum=",Bn,"bankValue=",M),Bn?(console.log("📦 Drum bank selected – preserving current editor mode"),ae.patternEditorEnabled?w():(ae.built=!1,setTimeout(()=>{w()},0))):(console.log("📦 Not a drum bank, using code editor"),_n(!0),w())});const Tr=e.querySelector(".btn-cancel");Tr&&Tr.addEventListener("click",()=>{rt()});const wo=e.querySelector(".btn-save");wo&&wo.addEventListener("click",()=>{if(!this.currentEditingElementId)return;ae.active&&Vn();let K=document.getElementById("modal-title").value.trim();K==="No sound assigned"&&(K="");const J=In("modal-pattern").trim();let ne;J.includes(".bank(")||J.includes(".s(")||J.includes(".synth(")||xi(J)||J.includes("sound(")||J.includes("s(")?ne=J:ne=Xr(J);const M=document.getElementById("modal-keep-notes-as-written"),ue=M?M.checked:!1;if(ne&&xi(ne)){const at=/\b(note|n)\s*\(\s*["'][a-gA-G][#b]?\d/.test(ne),tt=/\b(n|note)\s*\(\s*["'][\d\s\-]+["']/.test(ne)&&!/\b(note|n)\s*\(\s*["'][a-gA-G]/.test(ne);at&&!tt?console.log(`📝 Preserving note names format: ${ne.substring(0,50)}...`):tt&&!at&&console.log(`📝 Preserving semitones format: ${ne.substring(0,50)}...`)}const we=ue,xe=document.getElementById("modal-key-select"),Ae=document.getElementById("modal-scale-select"),fe=xe&&xe.value||null,Fe=Ae&&Ae.value||null;if(console.log(`🎼 Modal save: Reading key/scale from dropdowns - elementKey="${fe}", elementScale="${Fe}", modalKeySelect.value="${xe==null?void 0:xe.value}", modalScaleSelect.value="${Ae==null?void 0:Ae.value}"`),ne&&xi(ne)&&(fe||Fe)){const at=/\b(note|n)\s*\(/.test(ne),tt=/\b(note|n)\s*\(\s*["'][a-gA-G][#b]?\d/.test(ne),Ue=/\b(n|note)\s*\(\s*["'][\d\s\-]+["']/.test(ne)&&!/\b(note|n)\s*\(\s*["'][a-gA-G]/.test(ne),Je=/\.\s*chord\s*\(/i.test(ne),Me=at&&Ue&&!tt&&!Je;if(console.log(`🎼 Modal save: pattern="${ne.substring(0,50)}...", hasNoteFunction=${at}, hasNoteNames=${tt}, hasNumericNotes=${Ue}, isNumericPattern=${Me}, elementKey="${fe}", elementScale="${Fe}"`),!Je&&Me&&!tt){const He=le.applyGlobalSettingsToPattern(ne,!1,!1,fe||null,Fe||null);console.log(`🎼 Modal save: patternWithScale="${He?He.substring(0,80):"null"}..."`),He&&He!==ne?(ne=He,Ln("modal-pattern",ne),console.log(`✅ Applied key/scale to pattern: ${ne.substring(0,80)}...`)):console.log("⚠️ Scale not applied - pattern unchanged or applyGlobalSettingsToPattern returned same pattern")}else console.log(tt?"📝 Pattern uses note names - preserving format, not applying scale modifier":`⚠️ Scale not applied - hasChordModifier=${Je}, isNumericPattern=${Me}`)}else console.log(`⚠️ Key/Scale not applied - pattern: ${!!ne}, hasNoteCall: ${ne?xi(ne):!1}, elementKey: ${fe}, elementScale: ${Fe}`);if(ne){let at=ne,tt="";for(;tt!==at;)tt=at,at=at.replace(/\.postgain\s*\([^)]*\)/gi,"");at=at.replace(/\.pan\s*\([^)]*\)/gi,""),at=at.replace(/\.fast\s*\([^)]*\)/gi,""),at=at.replace(/\.slow\s*\([^)]*\)/gi,""),at=at.replace(/\.cpm\s*\([^)]*\)/gi,""),at=at.replace(/\.\.+/g,".").trim(),at=at.replace(/\.+$/,"").trim(),at=at.replace(/\s+\./g,"."),ne=at}const Ze=document.getElementById("modal-sample-url").value.trim(),Te=document.getElementById("modal-sample-file"),Ne=r?r.value:"";let ot=Ze;if(Te.files&&Te.files.length>0){const at=Te.files[0],tt=new FileReader;tt.onload=Ue=>{ot=Ue.target.result,this.saveElementConfig(this.currentEditingElementId,{title:K||this.currentEditingElementId,pattern:ne,sampleUrl:ot,fileName:at.name,bank:Ne||void 0,keepNotesAsWritten:we,key:fe,scale:Fe}),rt()},tt.readAsDataURL(at)}else this.saveElementConfig(this.currentEditingElementId,{title:K||this.currentEditingElementId,pattern:ne,sampleUrl:ot,bank:Ne||void 0,keepNotesAsWritten:we,key:fe,scale:Fe}),rt()}),e.addEventListener("click",K=>{K.target===e&&rt()}),document.addEventListener("keydown",K=>{K.key==="Escape"&&e.style.display!=="none"&&rt()}),document.querySelectorAll(".config-button").forEach(K=>{K.addEventListener("click",J=>{J.stopPropagation();const ne=K.closest(".sound-element");if(ne){const M=ne.getAttribute("data-sound-id");M&&bn(M)}})}),this.openConfigModal=bn}isOverlapping(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)}setupAddElementButton(){const e=document.getElementById("add-element-btn");e&&e.addEventListener("click",()=>{this.createNewElement()})}createNewElement(){this.elementCounter++;const e=`element-${this.elementCounter}`,t=this.elementCounter;console.log(`➕ Creating new element: ${e}`);const s=document.querySelector(".elements-container"),r=document.getElementById("add-element-btn");if(!s||!r)return;const a=`
      <div class="sound-element" data-sound-id="${e}">
        <input type="range" class="gain-slider" min="0" max="1" step="0.01" value="0.8" orient="vertical" />
        <div class="volume-label">Gain</div>
        <div class="channel-label">Channel ${t}</div>
        <input type="range" class="pan-slider" min="-1" max="1" step="0.01" value="0" orient="horizontal" />
        <div class="pan-label">Pan</div>
        <div class="status-dots">
          <div class="status-dot loaded-dot" title="Sound Loaded"></div>
          <div class="status-dot playing-dot" title="Playing"></div>
        </div>
        <div class="master-status-indicator" title="Pattern saved to Master">M</div>
        <div class="element-title">Element ${t}</div>
        <div class="element-indicator"></div>
        <div class="element-circle"></div>
        <div class="spiral-visualization-container" style="display: none;"></div>
        <div class="element-controls">
          <button class="solo-button" title="Solo">S</button>
          <button class="mute-button" title="Mute">M</button>
        </div>
        
        <div class="element-action-buttons">
        <button class="config-button">Configure Sound</button>
          <div class="history-button-row">
            <button class="history-button" type="button" data-history-target="channel">Load</button>
            <button class="history-button history-button--primary" type="button" data-history-save="channel">Save</button>
          </div>
        </div>
      </div>
    `;r.insertAdjacentHTML("beforebegin",a);const i=document.querySelector(`[data-sound-id="${e}"]`);if(i){hs.elements.push({id:e,selector:`[data-sound-id="${e}"]`,type:"strudel",pattern:"",description:"No sound assigned"}),this.registerElements([{element:i,elementId:e}]),this.setupElementControlsForElement(i,e);const o=i.querySelector(".config-button");o&&this.openConfigModal&&o.addEventListener("click",u=>{u.stopPropagation(),this.openConfigModal(e)});const l=i.querySelector(".config-button");if(l&&(l.textContent="Configure Sound"),Vi(e,""),this.initializeElementVisualizations(i,e),l){const u=this.loadElementConfig(e);(!u||!u.pattern||u.pattern.trim()==="")&&(l.textContent="Configure Sound")}const c=i.querySelector(".history-button-row");c&&(c.style.display=pl?"":"none"),console.log(`✅ Element ${e} created and fully initialized`)}}setupElementControlsForElement(e,t){if(!e||!t)return;const s=e.querySelector(".gain-slider"),r=e.querySelector(".pan-slider");if(s){const o=parseFloat(s.value);le.setElementGain(t,o),s.addEventListener("input",l=>{l.stopPropagation();const c=parseFloat(l.target.value);le.setElementGain(t,c),le.updateTrackedElementGain(t,c),this.updateMasterPatternDisplay()})}if(r){const o=parseFloat(r.value);le.setElementPan(t,o),r.addEventListener("input",l=>{l.stopPropagation();const c=parseFloat(l.target.value);le.setElementPan(t,c),le.updateTrackedElementPan(t,c),this.updateMasterPatternDisplay()})}const a=e.querySelector(".solo-button");a&&a.addEventListener("click",o=>{o.stopPropagation(),this.handleSoloButton(t,a)});const i=e.querySelector(".mute-button");i&&i.addEventListener("click",o=>{o.stopPropagation(),this.handleMuteButton(t,i)}),this.initializeMidiControls(e,t)}setupCollaborationBridge(){this.collabUnsubscribers.forEach(s=>{try{typeof s=="function"&&s()}catch{}}),this.collabUnsubscribers=[];const e=s=>{var a,i;const r=((a=s==null?void 0:s.mergedStack)==null?void 0:a.trim())||((i=s==null?void 0:s.masterCode)==null?void 0:i.trim());r&&this.queueCollaborativeMaster(r,"snapshot")},t=s=>{var a,i;const r=((a=s==null?void 0:s.mergedStack)==null?void 0:a.trim())||((i=s==null?void 0:s.masterCode)==null?void 0:i.trim());r&&this.queueCollaborativeMaster(r,"socket")};this.collabUnsubscribers.push(lC.on("session:snapshot",e)),this.collabUnsubscribers.push(lC.on("master:updated",t))}queueCollaborativeMaster(e,t="socket"){const s=(e||"").trim();s&&(this.masterUpdateQueue.push({code:s,source:t}),!this.masterUpdateTimer&&(this.masterUpdateTimer=setTimeout(()=>{const r=this.masterUpdateQueue[this.masterUpdateQueue.length-1];this.masterUpdateQueue=[],this.masterUpdateTimer=null,r&&this.applyCollaborativeMaster(r.code,r.source)},150)))}applyCollaborativeMaster(e,t="socket"){var a,i;const s=(e||"").trim();if(!s)return;let r="";try{r=((a=In("master-pattern"))==null?void 0:a.trim())||""}catch{const o=document.getElementById("master-pattern");r=((i=o==null?void 0:o.value)==null?void 0:i.trim())||""}if(r!==s){try{Ln("master-pattern",s)}catch{const o=document.getElementById("master-pattern");if(o){o.value=s;const l=new Event("input",{bubbles:!0});o.dispatchEvent(l)}}le.setMasterPatternCode(s),this.updateMasterPatternDisplay(),t==="socket"?gs.updateStatus("Master updated from collaborators"):t==="snapshot"&&gs.updateStatus("Synced latest master pattern")}}}let pl=null,Ci=null,sm=null,_0=null,R0=null,qx=null,Zm=null,I0=null,wa=null,L0=null;function H7(){return wa||(wa=new f3e,wa.init(),pl&&wa.setCurrentUser(pl),wa)}async function Y7(){Ci=new NEe,Ci.setOnLoginSuccess(c=>{Q0(c)}),Ci.init(),XE(!1);try{const c=await su();c?Q0(c):Rh(),Zm=new KEe,Zm.init(),Zm.setOnComplete(u=>{Bi("profile-onboarding-modal"),Q0(u)}),I0=new JEe,I0.init()}catch{Rh()}setTimeout(()=>{Rf()},100);const n=document.getElementById("header-login-btn");n&&n.addEventListener("click",()=>{Ci&&Ci.show()});const e=document.getElementById("user-menu-button"),t=document.getElementById("user-menu-dropdown");e&&t&&(e.addEventListener("click",c=>{c.stopPropagation(),t.classList.toggle("active")}),document.addEventListener("click",c=>{!e.contains(c.target)&&!t.contains(c.target)&&t.classList.remove("active")}));const s=document.getElementById("user-logout-btn");s&&s.addEventListener("click",async()=>{try{await Ei.logout(),pl=null,Rh(),t==null||t.classList.remove("active")}catch(c){console.error("Logout error:",c)}});const r=document.getElementById("user-profile-link");r&&r.addEventListener("click",async c=>{if(c.preventDefault(),!pl){alert("Please log in to view your profile."),Ci?Ci.show():Rh(),t==null||t.classList.remove("active");return}sm&&await sm.show(pl),t==null||t.classList.remove("active")});const a=document.getElementById("user-submissions-link");a&&a.addEventListener("click",async c=>{if(c.preventDefault(),!pl){alert("Please log in to view your submissions."),Ci?Ci.show():Rh(),t==null||t.classList.remove("active");return}R0&&await R0.show(pl),t==null||t.classList.remove("active")});const i=document.getElementById("user-collab-link");i&&i.addEventListener("click",c=>{if(c.preventDefault(),!pl){alert("Please log in to use live collaboration."),Ci?Ci.show():Rh(),t==null||t.classList.remove("active");return}wa==null||wa.show(),t==null||t.classList.remove("active")}),sm=new _Ee,sm.init(),sm.setOnUpdate(c=>{Q0(c)}),_0=new REe,_0.init(),R0=new IEe,R0.init();const o=document.getElementById("user-profiles-link");o&&o.addEventListener("click",async c=>{c.preventDefault(),_0&&await _0.show(),t==null||t.classList.remove("active")});const l=document.getElementById("user-admin-link");l&&l.addEventListener("click",async c=>{c.preventDefault(),I0&&await I0.show(),t==null||t.classList.remove("active")}),qx=new LEe,qx.init(),window.savePatternDialog=qx,L0||(L0=new YEe,L0.init(),window.settingsPanel=L0),Ux(),Wx(),xG(()=>{Ux(),Wx(),Gx()}),typeof window<"u"&&window.addEventListener("settings-apply-requested",()=>{Ux(),Wx(),Gx()}),Gx()}function Ux(){const n=GEe(),e=document.body,t=document.querySelector(".bubble-background"),s=document.documentElement;e.classList.remove("page-style-animated","page-style-solid","page-style-image"),n.backgroundType==="solid"?(e.classList.add("page-style-solid"),t&&t.setAttribute("data-hidden","true")):n.backgroundType==="image"?(e.classList.add("page-style-image"),t&&t.setAttribute("data-hidden","true")):(e.classList.add("page-style-animated"),t&&t.removeAttribute("data-hidden")),s.style.setProperty("--page-solid-color",n.backgroundColor||"#05060a"),n.backgroundImage?s.style.setProperty("--page-bg-image",`url(${n.backgroundImage})`):s.style.setProperty("--page-bg-image","none")}function Wx(){if(!ys||!ys.chaospadSettings)return;const n=WEe(),e=n.x,t=n.y;ys.chaospadSettings.xAxis={effect:e.effect,min:e.min,max:e.max},ys.chaospadSettings.yAxis={effect:t.effect,min:t.min,max:t.max},e.effect==="cutoff"&&(ys.chaospadSettings.minFrequency=e.min,ys.chaospadSettings.maxFrequency=e.max),t.effect==="resonance"&&(ys.chaospadSettings.minResonance=t.min,ys.chaospadSettings.maxResonance=t.max),console.log("🎛️ Chaospad settings applied:",{xAxis:e.effect,yAxis:t.effect,settings:ys.chaospadSettings})}function Gx(){const n=document.getElementById("modal-pattern-bank");if(!n)return;const e=n.value;window.refreshBankOptions&&typeof window.refreshBankOptions=="function"?window.refreshBankOptions(e):Array.from(n.querySelectorAll("optgroup")).forEach(t=>{Array.from(t.querySelectorAll("option")).forEach(s=>{const r=s.value;r&&Ob(r)?(s.style.display="",s.hidden=!1):r&&(s.style.display="none",s.hidden=!0),r||(s.style.display="",s.hidden=!1)})})}function qG(n){const e=document.getElementById("load-master-history-btn"),t=document.getElementById("save-master-history-btn");e&&(e.style.display=n?"":"none"),t&&(t.style.display=n?"":"none"),document.querySelectorAll(".sound-element .history-button-row").forEach(r=>{r.style.display=n?"":"none"})}function XE(n){const e=document.querySelector(".elements-container"),t=document.getElementById("add-element-btn"),s=!n;e&&(e.hidden=s,e.style.display=s?"none":"",e.setAttribute("aria-hidden",s?"true":"false")),t&&(t.hidden=s,t.style.display=s?"none":"",t.setAttribute("aria-hidden",s?"true":"false"))}function t5e(n){const e=document.getElementById("header-login-btn"),t=document.getElementById("user-menu"),s=document.getElementById("user-name"),r=document.getElementById("user-avatar"),a=document.getElementById("user-admin-link"),i=document.getElementById("user-collab-link"),o=document.getElementById("status-text");e&&(e.style.display="none"),t&&(t.style.display="block"),s&&(s.textContent=n.name||n.email),r&&n.avatarUrl?(r.src=n.avatarUrl,r.style.display="block"):r&&(r.style.display="none"),a&&(a.style.display=n.role==="admin"?"block":"none"),i&&(i.style.display=""),qG(!0),XE(!0),o&&o.textContent==="Login to unlock more features"&&(o.textContent="Ready")}function Rh(){const n=document.getElementById("header-login-btn"),e=document.getElementById("user-menu"),t=document.getElementById("user-admin-link"),s=document.getElementById("user-collab-link"),r=document.getElementById("status-text");n&&(n.style.display="block"),e&&(e.style.display="none"),t&&(t.style.display="none"),s&&(s.style.display="none"),wa==null||wa.setCurrentUser(null),ys==null||ys.setChaospadTiltAvailability(!1),qG(!1),XE(!1),r&&(r.textContent="Login to unlock more features")}function Q0(n){n&&(pl=n,wa==null||wa.setCurrentUser(n),ys==null||ys.setChaospadTiltAvailability(!0),Ci&&Ci.hide(),Rf(),t5e(n),!n.profileCompleted&&Zm?Zm.show(n):setTimeout(()=>{Rf()},50))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new X7().init(),j7(),H7(),Y7()}):(new X7().init(),j7(),H7(),Y7());window.addEventListener("load",()=>{setTimeout(()=>{var i,o,l,c,u,h;const n=((i=document.getElementById("login-modal-overlay"))==null?void 0:i.style.display)!=="none",e=((o=document.getElementById("profile-onboarding-overlay"))==null?void 0:o.style.display)!=="none",t=((l=document.getElementById("user-profile-modal-overlay"))==null?void 0:l.style.display)!=="none",s=((c=document.getElementById("save-pattern-dialog-overlay"))==null?void 0:c.style.display)!=="none",r=((u=document.getElementById("user-profiles-modal-overlay"))==null?void 0:u.style.display)!=="none",a=((h=document.getElementById("admin-user-manager-overlay"))==null?void 0:h.style.display)!=="none";!n&&!e&&!t&&!s&&!r&&!a&&Rf()},200)});export{ime as $,pV as A,yl as B,cme as C,kA as D,Xn as E,$2 as F,f5e as G,y5e as H,Ec as I,O5e as J,ED as K,ka as L,bl as M,Gu as N,gf as O,mV as P,mt as Q,ume as R,Ov as S,bf as T,Xbe as U,a5e as V,Gbe as W,Wbe as X,b5e as Y,uA as Z,u_ as _,Hbe as a,eye as b,v5e as c,ze as d,w5e as e,bv as f,Cr as g,xs as h,P5e as i,mc as j,Xs as k,ng as l,Mh as m,k5e as n,Hye as o,A5e as p,m5e as q,S5e as r,C5e as s,x5e as t,bt as u,lA as v,sQ as w,ac as x,HP as y,g5e as z};
